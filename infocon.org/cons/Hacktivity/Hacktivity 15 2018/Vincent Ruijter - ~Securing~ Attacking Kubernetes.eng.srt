1
00:00:00,030 --> 00:00:04,380
hello everyone<font color="#CCCCCC"> I will be talking</font><font color="#E5E5E5"> about</font>

2
00:00:02,340 --> 00:00:06,150
<font color="#E5E5E5">the securing and attacking Cuba needs</font>

3
00:00:04,380 --> 00:00:09,149
it's going to be a little<font color="#E5E5E5"> more attacking</font>

4
00:00:06,150 --> 00:00:11,790
and securing is like like afterwards<font color="#E5E5E5"> so</font>

5
00:00:09,150 --> 00:00:14,400
I am<font color="#CCCCCC"> Vincent I work at the KP answer</font>

6
00:00:11,790 --> 00:00:16,230
team which is the<font color="#CCCCCC"> cert team of a great</font>

7
00:00:14,400 --> 00:00:19,170
Dutch telco<font color="#E5E5E5"> is called Royal Dutch</font>

8
00:00:16,230 --> 00:00:21,300
telecom provider and I used to be

9
00:00:19,170 --> 00:00:23,430
working in a red team<font color="#E5E5E5"> and now I'm joined</font>

10
00:00:21,300 --> 00:00:26,010
the<font color="#E5E5E5"> suit team and I do a bit of yeah a</font>

11
00:00:23,430 --> 00:00:27,480
bit of both ways actually<font color="#CCCCCC"> and I really</font>

12
00:00:26,010 --> 00:00:29,699
like to<font color="#CCCCCC"> work by myself but occasionally</font>

13
00:00:27,480 --> 00:00:31,279
<font color="#E5E5E5">I get intrigued by some some web</font>

14
00:00:29,699 --> 00:00:34,370
application<font color="#CCCCCC"> technology as well with some</font>

15
00:00:31,279 --> 00:00:37,290
<font color="#E5E5E5">orchestration technology like this one</font>

16
00:00:34,370 --> 00:00:39,149
<font color="#E5E5E5">this will be my talk I will first talk</font>

17
00:00:37,290 --> 00:00:40,920
about what<font color="#CCCCCC"> Kuban is is whose</font><font color="#E5E5E5"> very</font>

18
00:00:39,149 --> 00:00:43,010
obscure needs<font color="#E5E5E5"> and I'll talk about how to</font>

19
00:00:40,920 --> 00:00:45,239
interact with<font color="#E5E5E5"> Cuba</font><font color="#CCCCCC"> knees and</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> QVC API</font>

20
00:00:43,010 --> 00:00:46,980
<font color="#E5E5E5">then</font><font color="#CCCCCC"> I will talk about</font><font color="#E5E5E5"> some common</font>

21
00:00:45,239 --> 00:00:48,480
pitfalls<font color="#CCCCCC"> you might</font><font color="#E5E5E5"> find when setting up</font>

22
00:00:46,980 --> 00:00:50,038
Cuba needs and some stuff you can

23
00:00:48,480 --> 00:00:51,959
<font color="#E5E5E5">exploit when you're attacking Cuba needs</font>

24
00:00:50,039 --> 00:00:53,850
<font color="#E5E5E5">and then in the end I</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> give some</font>

25
00:00:51,960 --> 00:00:56,579
<font color="#E5E5E5">advice on how</font><font color="#CCCCCC"> to harden</font><font color="#E5E5E5"> your cluster in</font>

26
00:00:53,850 --> 00:00:58,079
your notes and<font color="#E5E5E5"> maybe your</font><font color="#CCCCCC"> pods</font><font color="#E5E5E5"> and I</font>

27
00:00:56,579 --> 00:00:59,789
should say<font color="#E5E5E5"> that Cuba needs move</font><font color="#CCCCCC"> fight</font>

28
00:00:58,079 --> 00:01:01,230
quite fast with development like a

29
00:00:59,789 --> 00:01:03,239
couple versions<font color="#E5E5E5"> ago they didn't really</font>

30
00:01:01,230 --> 00:01:05,220
do a lot<font color="#CCCCCC"> of security by default and</font>

31
00:01:03,239 --> 00:01:06,750
nowadays<font color="#E5E5E5"> when you download a new</font><font color="#CCCCCC"> version</font>

32
00:01:05,220 --> 00:01:08,689
a lot<font color="#E5E5E5"> of these attacks they will not</font>

33
00:01:06,750 --> 00:01:10,590
<font color="#E5E5E5">work but still</font><font color="#CCCCCC"> you will</font><font color="#E5E5E5"> find them in</font>

34
00:01:08,689 --> 00:01:13,679
<font color="#E5E5E5">implementations because it's quite</font><font color="#CCCCCC"> hard</font>

35
00:01:10,590 --> 00:01:16,860
to upgrade your<font color="#CCCCCC"> cousin I'm not breaking</font>

36
00:01:13,680 --> 00:01:18,689
things so<font color="#E5E5E5"> Q needs is a container</font>

37
00:01:16,860 --> 00:01:20,509
orchestration tool it<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a made</font><font color="#E5E5E5"> by</font>

38
00:01:18,689 --> 00:01:23,639
<font color="#CCCCCC">Google and</font><font color="#E5E5E5"> it's mainly</font><font color="#CCCCCC"> written in go</font>

39
00:01:20,509 --> 00:01:26,159
<font color="#E5E5E5">Google released it in 2014 and since</font>

40
00:01:23,640 --> 00:01:28,590
<font color="#E5E5E5">2015 partnered with Linux Foundation</font>

41
00:01:26,159 --> 00:01:30,780
<font color="#E5E5E5">they created the cloud native computing</font>

42
00:01:28,590 --> 00:01:33,570
foundation and Cuba<font color="#E5E5E5"> needs is right there</font>

43
00:01:30,780 --> 00:01:35,700
now<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> it's the</font><font color="#E5E5E5"> most one</font><font color="#CCCCCC"> of the</font>

44
00:01:33,570 --> 00:01:37,470
<font color="#CCCCCC">most active git repositories and github</font>

45
00:01:35,700 --> 00:01:38,970
<font color="#CCCCCC">with the Linux kernel being number one</font>

46
00:01:37,470 --> 00:01:40,259
<font color="#E5E5E5">so it's quite a lot of development going</font>

47
00:01:38,970 --> 00:01:42,600
on there

48
00:01:40,259 --> 00:01:45,689
you can get<font color="#CCCCCC"> Cuban ease clusters</font><font color="#E5E5E5"> setting</font>

49
00:01:42,600 --> 00:01:47,520
up really easy with the aw as ec2<font color="#E5E5E5"> and</font>

50
00:01:45,689 --> 00:01:49,139
<font color="#E5E5E5">you can get them from</font><font color="#CCCCCC"> Google</font><font color="#E5E5E5"> cloud also</font>

51
00:01:47,520 --> 00:01:51,810
canonical offers their own Cuba<font color="#CCCCCC"> needs</font>

52
00:01:49,140 --> 00:01:52,890
flavor<font color="#CCCCCC"> and you also have mini</font><font color="#E5E5E5"> cube for</font>

53
00:01:51,810 --> 00:01:55,680
development so there's a lot of

54
00:01:52,890 --> 00:01:56,909
<font color="#E5E5E5">different flavors going around in case</font>

55
00:01:55,680 --> 00:01:58,350
<font color="#E5E5E5">you're wondering what Cuba needs means</font>

56
00:01:56,909 --> 00:02:00,719
I've been<font color="#E5E5E5"> wondering for a long time</font>

57
00:01:58,350 --> 00:02:02,490
until<font color="#CCCCCC"> I</font><font color="#E5E5E5"> found out it means</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> helmsman</font><font color="#CCCCCC"> or</font>

58
00:02:00,719 --> 00:02:04,469
pilot in<font color="#E5E5E5"> Greek so it's basically a</font>

59
00:02:02,490 --> 00:02:05,190
steering the wheel<font color="#E5E5E5"> of your your docker</font>

60
00:02:04,469 --> 00:02:07,740
there

61
00:02:05,190 --> 00:02:08,520
<font color="#CCCCCC">then the tool you</font><font color="#E5E5E5"> used to talk to the</font>

62
00:02:07,740 --> 00:02:11,009
<font color="#E5E5E5">API</font>

63
00:02:08,520 --> 00:02:13,860
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Cubans API is called cube with</font><font color="#E5E5E5"> a</font>

64
00:02:11,009 --> 00:02:15,480
cube CTL and a cube CTL is used to talk

65
00:02:13,860 --> 00:02:18,210
to<font color="#E5E5E5"> the restful api</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the master</font><font color="#CCCCCC"> and</font>

66
00:02:15,480 --> 00:02:20,010
<font color="#E5E5E5">then each each node</font><font color="#CCCCCC"> has a</font><font color="#E5E5E5"> cubed api that</font>

67
00:02:18,210 --> 00:02:22,380
<font color="#E5E5E5">communicates with the master and</font><font color="#CCCCCC"> gets</font>

68
00:02:20,010 --> 00:02:24,239
commands<font color="#CCCCCC"> this way you can also</font><font color="#E5E5E5"> use curl</font>

69
00:02:22,380 --> 00:02:26,660
if you want to talk to the<font color="#CCCCCC"> API but</font><font color="#E5E5E5"> using</font>

70
00:02:24,240 --> 00:02:29,550
cube CTL is of course much easier

71
00:02:26,660 --> 00:02:31,440
offensive<font color="#E5E5E5"> an advanced if advice is to</font>

72
00:02:29,550 --> 00:02:33,420
download the cube CTL binary<font color="#E5E5E5"> aesthetic</font>

73
00:02:31,440 --> 00:02:35,280
<font color="#E5E5E5">so you can if you're on a cluster and</font>

74
00:02:33,420 --> 00:02:37,230
you<font color="#CCCCCC"> pound a pot you can just double you</font>

75
00:02:35,280 --> 00:02:39,150
get from the<font color="#CCCCCC"> cuba news website the cube</font>

76
00:02:37,230 --> 00:02:41,519
CTL binary and it will just<font color="#CCCCCC"> magically</font>

77
00:02:39,150 --> 00:02:43,050
work so it's a great post exploitation<font color="#E5E5E5"> -</font>

78
00:02:41,520 --> 00:02:46,880
that is statically compiled and

79
00:02:43,050 --> 00:02:49,260
available so cube CTL has namespaces

80
00:02:46,880 --> 00:02:50,730
namespaces can determine scope<font color="#E5E5E5"> and they</font>

81
00:02:49,260 --> 00:02:53,190
can be<font color="#E5E5E5"> helpful when setting up</font>

82
00:02:50,730 --> 00:02:54,450
administrative boundaries<font color="#CCCCCC"> cue GTL has</font>

83
00:02:53,190 --> 00:02:57,240
something called<font color="#CCCCCC"> role based access</font>

84
00:02:54,450 --> 00:02:59,280
<font color="#E5E5E5">control and these security policies can</font>

85
00:02:57,240 --> 00:03:01,290
be fine great by using namespaces but

86
00:02:59,280 --> 00:03:04,320
also by using tiers and labels for<font color="#CCCCCC"> your</font>

87
00:03:01,290 --> 00:03:05,940
applications here you can see like<font color="#E5E5E5"> the</font>

88
00:03:04,320 --> 00:03:07,470
default namespace is in<font color="#E5E5E5"> a small cluster</font>

89
00:03:05,940 --> 00:03:10,560
<font color="#E5E5E5">I</font><font color="#CCCCCC"> setup you</font><font color="#E5E5E5"> have a default namespace</font>

90
00:03:07,470 --> 00:03:11,970
<font color="#E5E5E5">this is there by</font><font color="#CCCCCC"> default you have a safe</font>

91
00:03:10,560 --> 00:03:14,010
<font color="#CCCCCC">space I've setup and you have the cube</font>

92
00:03:11,970 --> 00:03:16,580
system one<font color="#E5E5E5"> in the cube system namespace</font>

93
00:03:14,010 --> 00:03:19,679
there will be a lot of CUNY system

94
00:03:16,580 --> 00:03:22,280
applications and pods<font color="#E5E5E5"> like at CD where</font>

95
00:03:19,680 --> 00:03:25,530
all your secrets are stored and etc<font color="#E5E5E5"> so</font>

96
00:03:22,280 --> 00:03:27,150
<font color="#E5E5E5">Cuba needs worked with pots and</font><font color="#CCCCCC"> apart is</font>

97
00:03:25,530 --> 00:03:29,820
a collection of containers<font color="#E5E5E5"> that serve</font>

98
00:03:27,150 --> 00:03:31,830
specific<font color="#E5E5E5"> purpose</font><font color="#CCCCCC"> so you can have a pot</font>

99
00:03:29,820 --> 00:03:33,269
for<font color="#CCCCCC"> analyze</font><font color="#E5E5E5"> a web server that will keep</font>

100
00:03:31,830 --> 00:03:35,400
running<font color="#E5E5E5"> but</font><font color="#CCCCCC"> you can also have pots from</font>

101
00:03:33,270 --> 00:03:36,769
micro services that are<font color="#E5E5E5"> expandable the</font>

102
00:03:35,400 --> 00:03:38,910
moment the job is finished

103
00:03:36,769 --> 00:03:41,280
<font color="#CCCCCC">images are</font><font color="#E5E5E5"> freely available and they can</font>

104
00:03:38,910 --> 00:03:43,160
<font color="#E5E5E5">be the same</font><font color="#CCCCCC"> as docker images and the</font>

105
00:03:41,280 --> 00:03:45,300
configuration<font color="#E5E5E5"> is mainly written in</font><font color="#CCCCCC"> llamo</font>

106
00:03:43,160 --> 00:03:47,430
<font color="#E5E5E5">here's an example of listing all the</font>

107
00:03:45,300 --> 00:03:49,019
pots in the cube name and the<font color="#CCCCCC"> name space</font>

108
00:03:47,430 --> 00:03:50,580
cube system you can see there's the

109
00:03:49,019 --> 00:03:53,070
dashboard there there's a controller

110
00:03:50,580 --> 00:03:54,900
there's<font color="#CCCCCC"> an @ CD where again the secrets</font>

111
00:03:53,070 --> 00:03:57,030
are stored as a hint<font color="#E5E5E5"> and there are some</font>

112
00:03:54,900 --> 00:04:01,650
<font color="#E5E5E5">network controllers and their secrets as</font>

113
00:03:57,030 --> 00:04:03,690
well<font color="#E5E5E5"> this is a demo llamó file it's very</font>

114
00:04:01,650 --> 00:04:05,820
simple<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> create a</font><font color="#CCCCCC"> namespace</font><font color="#E5E5E5"> and a</font>

115
00:04:03,690 --> 00:04:07,560
name<font color="#E5E5E5"> you can set</font><font color="#CCCCCC"> up a restart policy</font>

116
00:04:05,820 --> 00:04:10,410
what it needs to<font color="#E5E5E5"> do and when</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> keep</font>

117
00:04:07,560 --> 00:04:12,420
restored<font color="#E5E5E5"> you can set</font><font color="#CCCCCC"> up an image the</font>

118
00:04:10,410 --> 00:04:15,299
version that<font color="#E5E5E5"> will get it pulls from</font><font color="#CCCCCC"> the</font>

119
00:04:12,420 --> 00:04:17,940
<font color="#E5E5E5">human needs repository in this case</font>

120
00:04:15,300 --> 00:04:18,989
it'll be<font color="#E5E5E5"> a boon to version 1404 the name</font>

121
00:04:17,940 --> 00:04:22,410
will be container and it

122
00:04:18,988 --> 00:04:25,830
<font color="#CCCCCC">runnin</font><font color="#E5E5E5"> endless loop and so yeah it won't</font>

123
00:04:22,410 --> 00:04:28,620
<font color="#E5E5E5">end basically the moment you set up a</font>

124
00:04:25,830 --> 00:04:31,080
pot<font color="#CCCCCC"> you can use</font><font color="#E5E5E5"> the cube CTL exact</font>

125
00:04:28,620 --> 00:04:33,150
command<font color="#E5E5E5"> to</font><font color="#CCCCCC"> have to</font><font color="#E5E5E5"> interact with the pot</font>

126
00:04:31,080 --> 00:04:35,460
if you set the<font color="#E5E5E5"> I flag and the tty flag</font>

127
00:04:33,150 --> 00:04:38,068
you basically get a<font color="#CCCCCC"> bash shell</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> Bash</font>

128
00:04:35,460 --> 00:04:40,770
is available otherwise<font color="#E5E5E5"> you can get</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> sh</font>

129
00:04:38,069 --> 00:04:45,229
<font color="#E5E5E5">shell and if no shells available you can</font>

130
00:04:40,770 --> 00:04:47,639
<font color="#E5E5E5">maybe only execute some other commands</font>

131
00:04:45,229 --> 00:04:50,159
<font color="#E5E5E5">another abstraction layer that's used</font>

132
00:04:47,639 --> 00:04:52,080
for networking<font color="#E5E5E5"> is services you can</font>

133
00:04:50,160 --> 00:04:54,720
create<font color="#CCCCCC"> ports and with namespaces you can</font>

134
00:04:52,080 --> 00:04:56,789
set<font color="#E5E5E5"> up a service and a service is</font>

135
00:04:54,720 --> 00:04:57,539
<font color="#CCCCCC">actually yeah you</font><font color="#E5E5E5"> can automatically</font>

136
00:04:56,789 --> 00:04:59,610
<font color="#CCCCCC">load-balanced</font>

137
00:04:57,539 --> 00:05:04,460
talking to an application<font color="#CCCCCC"> or</font><font color="#E5E5E5"> a pod and</font>

138
00:04:59,610 --> 00:05:06,990
then when you you can use<font color="#E5E5E5"> it to expose</font>

139
00:05:04,460 --> 00:05:09,000
<font color="#E5E5E5">yeah expose your service externally if</font>

140
00:05:06,990 --> 00:05:11,520
you use<font color="#E5E5E5"> a cloud provider</font><font color="#CCCCCC"> like Google</font>

141
00:05:09,000 --> 00:05:13,470
cloud native<font color="#E5E5E5"> you can get external</font><font color="#CCCCCC"> peace</font>

142
00:05:11,520 --> 00:05:15,030
be provided<font color="#CCCCCC"> to load balancers that will</font>

143
00:05:13,470 --> 00:05:17,580
automatically communicate with your pod

144
00:05:15,030 --> 00:05:18,859
it's a pretty pretty nice<font color="#E5E5E5"> and skills</font>

145
00:05:17,580 --> 00:05:22,729
really really nicely

146
00:05:18,860 --> 00:05:25,050
another thing Kunis has<font color="#E5E5E5"> is secrets</font>

147
00:05:22,729 --> 00:05:27,900
secrets can be tokens user<font color="#E5E5E5"> account</font>

148
00:05:25,050 --> 00:05:30,539
tokens<font color="#E5E5E5"> but can also be SSH keys JWT</font>

149
00:05:27,900 --> 00:05:32,820
tokens<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> create your own secrets</font>

150
00:05:30,539 --> 00:05:33,960
<font color="#E5E5E5">and you can combine them really nice to</font>

151
00:05:32,820 --> 00:05:36,930
it of course the<font color="#E5E5E5"> role based access</font>

152
00:05:33,960 --> 00:05:40,799
control<font color="#E5E5E5"> and all these secrets are stored</font>

153
00:05:36,930 --> 00:05:43,949
in the<font color="#E5E5E5"> HDD pot and the</font><font color="#CCCCCC"> SCD</font><font color="#E5E5E5"> pod I think</font>

154
00:05:40,800 --> 00:05:46,590
still uses<font color="#CCCCCC"> non encrypted storage</font><font color="#E5E5E5"> so if</font>

155
00:05:43,949 --> 00:05:49,440
you<font color="#E5E5E5"> manage</font><font color="#CCCCCC"> to get access</font><font color="#E5E5E5"> to a Cuban</font><font color="#CCCCCC"> YZ</font>

156
00:05:46,590 --> 00:05:51,239
cluster and can<font color="#E5E5E5"> pone the</font><font color="#CCCCCC"> @cd</font><font color="#E5E5E5"> pod</font><font color="#CCCCCC"> and you</font>

157
00:05:49,440 --> 00:05:53,599
can pull all<font color="#E5E5E5"> these secrets from there</font>

158
00:05:51,240 --> 00:05:56,430
it's basically stored in plain text

159
00:05:53,599 --> 00:05:58,889
so what could<font color="#E5E5E5"> go wrong besides storing</font>

160
00:05:56,430 --> 00:06:00,509
secrets in<font color="#E5E5E5"> plain text</font><font color="#CCCCCC"> when you go on</font>

161
00:05:58,889 --> 00:06:02,250
<font color="#CCCCCC">showdown and</font><font color="#E5E5E5"> scan the internet you</font><font color="#CCCCCC"> can</font>

162
00:06:00,509 --> 00:06:04,259
of<font color="#CCCCCC"> course find many expose</font><font color="#E5E5E5"> endpoints</font><font color="#CCCCCC"> you</font>

163
00:06:02,250 --> 00:06:06,180
can even find<font color="#CCCCCC"> SED endpoints with other</font>

164
00:06:04,259 --> 00:06:09,150
authentication that<font color="#E5E5E5"> are exposed</font><font color="#CCCCCC"> you can</font>

165
00:06:06,180 --> 00:06:13,050
find the<font color="#E5E5E5"> internet-facing cube cube units</font>

166
00:06:09,150 --> 00:06:15,719
<font color="#E5E5E5">api which has an unauthenticated</font><font color="#CCCCCC"> remote</font>

167
00:06:13,050 --> 00:06:17,310
code execution<font color="#CCCCCC"> a feature that is</font><font color="#E5E5E5"> only</font>

168
00:06:15,719 --> 00:06:19,620
patched in newer version of<font color="#CCCCCC"> Cuban II</font><font color="#E5E5E5"> so</font>

169
00:06:17,310 --> 00:06:21,300
you<font color="#CCCCCC"> can find some of</font><font color="#E5E5E5"> them exposed you</font>

170
00:06:19,620 --> 00:06:23,789
can<font color="#E5E5E5"> get access</font><font color="#CCCCCC"> to privileged containers</font>

171
00:06:21,300 --> 00:06:26,099
<font color="#E5E5E5">to command injection or by regular web</font>

172
00:06:23,789 --> 00:06:28,020
attacks<font color="#E5E5E5"> and you can also find the</font><font color="#CCCCCC"> desk</font>

173
00:06:26,099 --> 00:06:31,229
<font color="#E5E5E5">works</font><font color="#CCCCCC"> online or any internal</font><font color="#E5E5E5"> API that is</font>

174
00:06:28,020 --> 00:06:32,789
exposed<font color="#CCCCCC"> how I got interested in Cuba</font>

175
00:06:31,229 --> 00:06:35,219
<font color="#E5E5E5">needs is when I first joined Katie</font>

176
00:06:32,790 --> 00:06:36,420
<font color="#E5E5E5">in the red team</font><font color="#CCCCCC"> two years ago I did an</font>

177
00:06:35,220 --> 00:06:37,680
assignment<font color="#E5E5E5"> for</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know scanning the</font>

178
00:06:36,420 --> 00:06:39,060
<font color="#CCCCCC">internet see if I could</font><font color="#E5E5E5"> find some</font>

179
00:06:37,680 --> 00:06:41,370
interesting systems that<font color="#CCCCCC"> belong to k</font>

180
00:06:39,060 --> 00:06:42,930
<font color="#E5E5E5">plan and at one point I found a Cuban</font>

181
00:06:41,370 --> 00:06:45,210
<font color="#CCCCCC">his end</font><font color="#E5E5E5"> point like two years ago</font>

182
00:06:42,930 --> 00:06:46,740
security was like<font color="#CCCCCC"> non-existence</font><font color="#E5E5E5"> for Cuba</font>

183
00:06:45,210 --> 00:06:48,719
<font color="#E5E5E5">needs at</font><font color="#CCCCCC"> least that's what I figured I</font>

184
00:06:46,740 --> 00:06:51,210
found out that<font color="#CCCCCC"> all the user accounts</font>

185
00:06:48,720 --> 00:06:53,070
<font color="#CCCCCC">were administrated by default so when I</font>

186
00:06:51,210 --> 00:06:55,620
talk<font color="#CCCCCC"> to the API</font><font color="#E5E5E5"> I could easily spawn a</font>

187
00:06:53,070 --> 00:06:57,900
pod<font color="#E5E5E5"> and scan the internal network of the</font>

188
00:06:55,620 --> 00:07:00,210
the company I<font color="#E5E5E5"> apparently breached</font>

189
00:06:57,900 --> 00:07:02,520
<font color="#E5E5E5">because it wasn't like a</font><font color="#CCCCCC"> paean</font><font color="#E5E5E5"> system</font>

190
00:07:00,210 --> 00:07:04,200
and yeah<font color="#E5E5E5"> when I found a Jenkins</font><font color="#CCCCCC"> bugs</font><font color="#E5E5E5"> I</font>

191
00:07:02,520 --> 00:07:06,960
got very excited<font color="#CCCCCC"> and I completely</font><font color="#E5E5E5"> forgot</font>

192
00:07:04,200 --> 00:07:08,430
about about human<font color="#CCCCCC"> ease for a while and</font>

193
00:07:06,960 --> 00:07:11,310
then I had an internal pen test and then

194
00:07:08,430 --> 00:07:13,110
the Cuban story came up again so if you

195
00:07:11,310 --> 00:07:14,490
<font color="#E5E5E5">scan like for the internet for the Cuban</font>

196
00:07:13,110 --> 00:07:17,820
<font color="#E5E5E5">ease - would would show then you can</font>

197
00:07:14,490 --> 00:07:20,130
find sixteen point four K showed a Cuban

198
00:07:17,820 --> 00:07:23,159
<font color="#CCCCCC">YZ instances available you can also find</font>

199
00:07:20,130 --> 00:07:25,530
at<font color="#E5E5E5"> CD I think</font><font color="#CCCCCC"> they're over</font><font color="#E5E5E5"> 250 K at CD</font>

200
00:07:23,160 --> 00:07:27,480
<font color="#CCCCCC">Services exposing the internet and of</font>

201
00:07:25,530 --> 00:07:29,340
course this is not an<font color="#CCCCCC"> accurate list this</font>

202
00:07:27,480 --> 00:07:32,190
<font color="#CCCCCC">is only what shodhan finds and</font><font color="#E5E5E5"> crawls</font>

203
00:07:29,340 --> 00:07:33,479
for and if you<font color="#E5E5E5"> really want to find</font>

204
00:07:32,190 --> 00:07:36,990
interesting ports<font color="#CCCCCC"> I recommend you to</font>

205
00:07:33,480 --> 00:07:41,370
scan the<font color="#E5E5E5"> internet</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> port 10250 that's</font>

206
00:07:36,990 --> 00:07:42,870
the<font color="#CCCCCC"> unauthenticated</font><font color="#E5E5E5"> Cuba needs API</font><font color="#CCCCCC"> this</font>

207
00:07:41,370 --> 00:07:45,740
<font color="#E5E5E5">is an example of a dashboard that was</font>

208
00:07:42,870 --> 00:07:48,330
found<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the internet</font><font color="#E5E5E5"> it was in China</font>

209
00:07:45,740 --> 00:07:51,450
yeah it's taken offline now it's a

210
00:07:48,330 --> 00:07:53,099
couple months<font color="#E5E5E5"> ago so yeah what do</font><font color="#CCCCCC"> you do</font>

211
00:07:51,450 --> 00:07:55,170
when you have<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to a port I have</font>

212
00:07:53,100 --> 00:07:56,340
some demos prepared and some examples

213
00:07:55,170 --> 00:07:58,860
from what you can do when<font color="#E5E5E5"> you have</font>

214
00:07:56,340 --> 00:08:00,630
<font color="#CCCCCC">access on a port and</font><font color="#E5E5E5"> again many of these</font>

215
00:07:58,860 --> 00:08:02,640
issues<font color="#CCCCCC"> I will</font><font color="#E5E5E5"> show they they might have</font>

216
00:08:00,630 --> 00:08:04,590
been<font color="#E5E5E5"> address</font><font color="#CCCCCC"> they have been</font><font color="#E5E5E5"> addressed in</font>

217
00:08:02,640 --> 00:08:06,870
new versions but<font color="#E5E5E5"> a lot of developers</font>

218
00:08:04,590 --> 00:08:08,340
they still apply the patches to make the

219
00:08:06,870 --> 00:08:10,290
<font color="#E5E5E5">Cuban YZ cluster go back to the old</font>

220
00:08:08,340 --> 00:08:11,760
state because it's much<font color="#E5E5E5"> easier</font><font color="#CCCCCC"> to</font>

221
00:08:10,290 --> 00:08:13,710
administer<font color="#CCCCCC"> then set up the</font><font color="#E5E5E5"> row</font><font color="#CCCCCC"> based</font>

222
00:08:11,760 --> 00:08:15,599
authentication<font color="#E5E5E5"> so you will still find</font>

223
00:08:13,710 --> 00:08:19,250
many clusters where these type of

224
00:08:15,600 --> 00:08:21,780
attacks might<font color="#E5E5E5"> still work</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is from</font>

225
00:08:19,250 --> 00:08:25,110
<font color="#CCCCCC">Penta sided they basically gave</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> a</font>

226
00:08:21,780 --> 00:08:27,479
<font color="#E5E5E5">port and yeah they gave me like a</font>

227
00:08:25,110 --> 00:08:30,750
command injection<font color="#E5E5E5"> so I could to command</font>

228
00:08:27,480 --> 00:08:32,970
inside yeah Jason<font color="#CCCCCC"> requests and I could</font>

229
00:08:30,750 --> 00:08:35,130
just<font color="#CCCCCC"> you know send commands and get</font>

230
00:08:32,970 --> 00:08:36,690
output<font color="#E5E5E5"> back I created</font><font color="#CCCCCC"> a small Python</font>

231
00:08:35,130 --> 00:08:39,270
shell and the first thing I always<font color="#E5E5E5"> do is</font>

232
00:08:36,690 --> 00:08:41,130
get a reverse shell back<font color="#E5E5E5"> so the moment</font><font color="#CCCCCC"> I</font>

233
00:08:39,270 --> 00:08:44,620
get my reverse shell you can<font color="#E5E5E5"> type printf</font>

234
00:08:41,130 --> 00:08:46,240
and<font color="#E5E5E5"> then you see your Cuban is main API</font>

235
00:08:44,620 --> 00:08:48,720
and of course if there's no print<font color="#CCCCCC"> end</font>

236
00:08:46,240 --> 00:08:51,760
for variable you can cut<font color="#CCCCCC"> token viral</font>

237
00:08:48,720 --> 00:08:53,380
<font color="#CCCCCC">also for Cuba needs</font><font color="#E5E5E5"> secrets service</font>

238
00:08:51,760 --> 00:08:53,980
accounts are usually<font color="#E5E5E5"> stored in far run</font>

239
00:08:53,380 --> 00:08:56,500
secrets

240
00:08:53,980 --> 00:08:59,440
by default<font color="#CCCCCC"> cuny's automatically mount</font>

241
00:08:56,500 --> 00:09:01,690
<font color="#E5E5E5">service accounts</font><font color="#CCCCCC"> I don't know any use</font>

242
00:08:59,440 --> 00:09:02,830
cases<font color="#E5E5E5"> where a web server for instance is</font>

243
00:09:01,690 --> 00:09:04,120
required to<font color="#E5E5E5"> have a service account</font>

244
00:09:02,830 --> 00:09:06,550
because the service account can be<font color="#CCCCCC"> used</font>

245
00:09:04,120 --> 00:09:08,740
<font color="#CCCCCC">to talk to the API but</font><font color="#E5E5E5"> you can also</font>

246
00:09:06,550 --> 00:09:10,029
choose<font color="#E5E5E5"> to not automatically mounties</font>

247
00:09:08,740 --> 00:09:11,710
because a lot<font color="#CCCCCC"> of times the service</font>

248
00:09:10,029 --> 00:09:14,589
account has some<font color="#CCCCCC"> privileges on the</font><font color="#E5E5E5"> API</font>

249
00:09:11,710 --> 00:09:16,900
<font color="#E5E5E5">so you could use the token</font><font color="#CCCCCC"> and the</font><font color="#E5E5E5"> CI</font>

250
00:09:14,589 --> 00:09:21,130
<font color="#E5E5E5">sir to talk to the API</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> maybe you</font>

251
00:09:16,900 --> 00:09:22,540
know try to<font color="#CCCCCC"> pretty escalate neither so</font>

252
00:09:21,130 --> 00:09:23,860
yeah if<font color="#E5E5E5"> I try to connect to the cubelet</font>

253
00:09:22,540 --> 00:09:25,540
<font color="#E5E5E5">API you can see that the port is</font>

254
00:09:23,860 --> 00:09:27,850
available and I can<font color="#CCCCCC"> talk</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so in</font>

255
00:09:25,540 --> 00:09:31,240
this case you can you know get couplet

256
00:09:27,850 --> 00:09:34,540
on there and see if you<font color="#E5E5E5"> can yeah run my</font>

257
00:09:31,240 --> 00:09:42,760
demo<font color="#CCCCCC"> I run another demo inside my demo</font>

258
00:09:34,540 --> 00:09:44,529
<font color="#CCCCCC">ah</font><font color="#E5E5E5"> this looks anyway there are some</font>

259
00:09:42,760 --> 00:09:46,180
dashboards available here<font color="#E5E5E5"> these are the</font>

260
00:09:44,529 --> 00:09:47,830
<font color="#E5E5E5">posts that are</font><font color="#CCCCCC"> running inside</font><font color="#E5E5E5"> my my name</font>

261
00:09:46,180 --> 00:09:50,469
space<font color="#E5E5E5"> there is a pod running in</font>

262
00:09:47,830 --> 00:09:52,900
<font color="#CCCCCC">countries</font><font color="#E5E5E5"> it's called Nepal and there's</font>

263
00:09:50,470 --> 00:09:55,240
another pod running in countries<font color="#E5E5E5"> it's</font>

264
00:09:52,900 --> 00:09:56,800
called the unsafe space so now<font color="#CCCCCC"> I will</font>

265
00:09:55,240 --> 00:09:58,000
list all<font color="#CCCCCC"> the services</font><font color="#E5E5E5"> are available in</font>

266
00:09:56,800 --> 00:10:00,279
<font color="#E5E5E5">the</font><font color="#CCCCCC"> namespace</font><font color="#E5E5E5"> and you can see there are</font>

267
00:09:58,000 --> 00:10:02,020
some<font color="#E5E5E5"> exposed and what I will do now is</font><font color="#CCCCCC"> I</font>

268
00:10:00,279 --> 00:10:04,060
<font color="#E5E5E5">will create a new Yama file with the</font>

269
00:10:02,020 --> 00:10:06,010
security context of privilege<font color="#CCCCCC"> and I will</font>

270
00:10:04,060 --> 00:10:08,500
try<font color="#CCCCCC"> to communicate to two-qubit</font><font color="#E5E5E5"> API that</font>

271
00:10:06,010 --> 00:10:10,000
<font color="#CCCCCC">I want to create this new new pod so</font>

272
00:10:08,500 --> 00:10:13,270
this new pot is<font color="#E5E5E5"> called escape with llamo</font>

273
00:10:10,000 --> 00:10:16,510
<font color="#E5E5E5">I just I just created it and I will</font>

274
00:10:13,270 --> 00:10:19,360
execute<font color="#E5E5E5"> and in SH and you</font><font color="#CCCCCC"> know try to</font>

275
00:10:16,510 --> 00:10:21,010
<font color="#E5E5E5">previous on the</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> so what I wanna now</font>

276
00:10:19,360 --> 00:10:22,330
do in<font color="#E5E5E5"> privilege mode you can see all the</font>

277
00:10:21,010 --> 00:10:24,400
blocking character devices<font color="#CCCCCC"> that are</font>

278
00:10:22,330 --> 00:10:25,839
belonging to the<font color="#E5E5E5"> host so I'll try and</font>

279
00:10:24,400 --> 00:10:27,220
<font color="#CCCCCC">see if I can</font><font color="#E5E5E5"> find out the hard drive</font>

280
00:10:25,839 --> 00:10:30,010
<font color="#E5E5E5">that is actually for a root filesystem</font>

281
00:10:27,220 --> 00:10:34,029
<font color="#CCCCCC">right and I try</font><font color="#E5E5E5"> to mount it inside my</font>

282
00:10:30,010 --> 00:10:35,980
mouth directory and as you can<font color="#E5E5E5"> see the</font>

283
00:10:34,029 --> 00:10:38,560
<font color="#E5E5E5">host file system is actually mounted</font>

284
00:10:35,980 --> 00:10:40,480
<font color="#E5E5E5">inside my mount folder so now when I cut</font>

285
00:10:38,560 --> 00:10:44,229
<font color="#CCCCCC">past IVD I'm actually in the</font><font color="#E5E5E5"> passivity</font>

286
00:10:40,480 --> 00:10:46,630
file of the house so it's a pretty

287
00:10:44,230 --> 00:10:50,050
pretty<font color="#E5E5E5"> easy thing</font><font color="#CCCCCC"> to do so</font><font color="#E5E5E5"> yeah what</font>

288
00:10:46,630 --> 00:10:52,450
just happened apparently<font color="#E5E5E5"> if you have a</font>

289
00:10:50,050 --> 00:10:53,859
<font color="#CCCCCC">privilege</font><font color="#E5E5E5"> mode in Cuba</font><font color="#CCCCCC"> knees which you</font>

290
00:10:52,450 --> 00:10:54,640
can check in<font color="#E5E5E5"> your settings file over</font>

291
00:10:53,860 --> 00:10:58,990
<font color="#CCCCCC">here</font>

292
00:10:54,640 --> 00:11:00,610
it's allowed<font color="#CCCCCC"> for you to run</font><font color="#E5E5E5"> yeah to</font>

293
00:10:58,990 --> 00:11:02,350
basically see all the<font color="#E5E5E5"> same things and</font>

294
00:11:00,610 --> 00:11:05,019
perform a lot<font color="#E5E5E5"> of actions on both devices</font>

295
00:11:02,350 --> 00:11:06,519
that that the node also<font color="#E5E5E5"> can do so if you</font>

296
00:11:05,019 --> 00:11:09,250
<font color="#E5E5E5">find a container that is</font><font color="#CCCCCC"> in privileged</font>

297
00:11:06,519 --> 00:11:10,779
mode<font color="#E5E5E5"> you can just</font><font color="#CCCCCC"> list all the</font><font color="#E5E5E5"> character</font>

298
00:11:09,250 --> 00:11:12,490
devices<font color="#E5E5E5"> in there</font><font color="#CCCCCC"> and the book devices</font>

299
00:11:10,779 --> 00:11:15,820
you can<font color="#CCCCCC"> actually mount a house</font>

300
00:11:12,490 --> 00:11:19,089
<font color="#CCCCCC">filesystem inside your Kiran</font><font color="#E5E5E5"> ethos which</font>

301
00:11:15,820 --> 00:11:20,649
is quite<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> sometimes this</font>

302
00:11:19,089 --> 00:11:22,329
might not<font color="#E5E5E5"> be</font><font color="#CCCCCC"> possible but then you can</font>

303
00:11:20,649 --> 00:11:24,329
scan the ranges of<font color="#E5E5E5"> Cuba needs and maybe</font>

304
00:11:22,329 --> 00:11:27,279
you'll find<font color="#E5E5E5"> something like a dashboard</font>

305
00:11:24,329 --> 00:11:29,229
<font color="#CCCCCC">before version</font><font color="#E5E5E5"> 1.7 of Cuba needs the</font>

306
00:11:27,279 --> 00:11:31,630
dashboard was cluster administrator by

307
00:11:29,230 --> 00:11:34,480
default<font color="#E5E5E5"> so if you</font><font color="#CCCCCC"> manage to</font><font color="#E5E5E5"> connect to</font>

308
00:11:31,630 --> 00:11:35,860
the dashboard<font color="#E5E5E5"> without authentication</font><font color="#CCCCCC"> you</font>

309
00:11:34,480 --> 00:11:38,890
could you<font color="#CCCCCC"> could administer the entire</font>

310
00:11:35,860 --> 00:11:42,220
<font color="#E5E5E5">cluster and since version 1.7 and beyond</font>

311
00:11:38,890 --> 00:11:45,610
they they granted<font color="#E5E5E5"> the dashboard minimal</font>

312
00:11:42,220 --> 00:11:46,750
privileges and you can still yeah you

313
00:11:45,610 --> 00:11:47,769
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> log in</font><font color="#E5E5E5"> where the serves the</font>

314
00:11:46,750 --> 00:11:50,019
counter<font color="#CCCCCC"> which your cube needs</font>

315
00:11:47,769 --> 00:11:52,180
configuration file<font color="#E5E5E5"> and the Cuba needs</font>

316
00:11:50,019 --> 00:11:54,640
website still tells you that you can

317
00:11:52,180 --> 00:11:55,810
with one command<font color="#E5E5E5"> actually give all the</font>

318
00:11:54,640 --> 00:11:59,230
privileges<font color="#E5E5E5"> back to your Cuba nice</font>

319
00:11:55,810 --> 00:12:01,750
<font color="#CCCCCC">dashboard so yeah let's say you're in a</font>

320
00:11:59,230 --> 00:12:05,079
pod and<font color="#CCCCCC"> you cannot</font><font color="#E5E5E5"> create a new pod in</font>

321
00:12:01,750 --> 00:12:06,820
privileged mode<font color="#E5E5E5"> you can always try to to</font>

322
00:12:05,079 --> 00:12:08,319
list for services<font color="#E5E5E5"> and maybe you can see</font>

323
00:12:06,820 --> 00:12:11,320
a<font color="#E5E5E5"> cube in this</font><font color="#CCCCCC"> dashboard or you can scan</font>

324
00:12:08,320 --> 00:12:13,360
the<font color="#E5E5E5"> network of your units cluster for a</font>

325
00:12:11,320 --> 00:12:13,829
<font color="#CCCCCC">dashboard</font><font color="#E5E5E5"> and see if you can connect to</font>

326
00:12:13,360 --> 00:12:19,930
it

327
00:12:13,829 --> 00:12:21,969
so my second demo will be just<font color="#E5E5E5"> that so</font>

328
00:12:19,930 --> 00:12:23,890
we're doing the same<font color="#CCCCCC"> thing which</font><font color="#E5E5E5"> will</font>

329
00:12:21,970 --> 00:12:25,750
<font color="#E5E5E5">try to spawn a new port again with</font>

330
00:12:23,890 --> 00:12:27,339
<font color="#CCCCCC">privileged mode and listing</font><font color="#E5E5E5"> the</font>

331
00:12:25,750 --> 00:12:30,329
namespaces we can immediately see there

332
00:12:27,339 --> 00:12:33,760
is a queue nice dashboard available here

333
00:12:30,329 --> 00:12:35,770
and of course<font color="#E5E5E5"> the</font><font color="#CCCCCC"> countries</font><font color="#E5E5E5"> Nepal button</font>

334
00:12:33,760 --> 00:12:37,329
<font color="#E5E5E5">on there as well</font><font color="#CCCCCC"> and I try to</font><font color="#E5E5E5"> spawn a</font>

335
00:12:35,770 --> 00:12:38,680
new container indeed with<font color="#CCCCCC"> the security</font>

336
00:12:37,329 --> 00:12:40,630
context<font color="#E5E5E5"> privileged and I get the error</font>

337
00:12:38,680 --> 00:12:42,670
message<font color="#CCCCCC"> that my service account is</font><font color="#E5E5E5"> not</font>

338
00:12:40,630 --> 00:12:45,010
allowed<font color="#E5E5E5"> to spawn a pod inside my own</font>

339
00:12:42,670 --> 00:12:46,089
<font color="#CCCCCC">namespace which is how it should be</font>

340
00:12:45,010 --> 00:12:47,860
because<font color="#E5E5E5"> you need to be not mean to do</font>

341
00:12:46,089 --> 00:12:51,279
that<font color="#E5E5E5"> but the cube is -</font><font color="#CCCCCC"> which is</font>

342
00:12:47,860 --> 00:12:53,350
available<font color="#E5E5E5"> and I can connect to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so</font>

343
00:12:51,279 --> 00:12:54,790
what will happen<font color="#CCCCCC"> now is I will interact</font>

344
00:12:53,350 --> 00:12:57,610
with the<font color="#CCCCCC"> Kiwis dashboard and show you</font>

345
00:12:54,790 --> 00:13:00,730
how easily you can<font color="#CCCCCC"> actually get shell</font>

346
00:12:57,610 --> 00:13:02,890
execution there as well<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> I will</font>

347
00:13:00,730 --> 00:13:06,160
do now<font color="#E5E5E5"> I will browse</font><font color="#CCCCCC"> through the the</font>

348
00:13:02,890 --> 00:13:07,689
namespaces<font color="#CCCCCC"> and you can basically click</font>

349
00:13:06,160 --> 00:13:08,529
on<font color="#E5E5E5"> some secrets because your app mean</font>

350
00:13:07,690 --> 00:13:11,110
you can read all those

351
00:13:08,529 --> 00:13:12,759
secrets<font color="#E5E5E5"> you can download CA files you</font>

352
00:13:11,110 --> 00:13:14,439
can<font color="#CCCCCC"> download tokens</font><font color="#E5E5E5"> and you can use</font>

353
00:13:12,759 --> 00:13:17,529
those<font color="#E5E5E5"> tokens to communicate further with</font>

354
00:13:14,439 --> 00:13:20,019
the API<font color="#CCCCCC"> on the Left you</font><font color="#E5E5E5"> don't see but I</font>

355
00:13:17,529 --> 00:13:22,089
will just<font color="#E5E5E5"> go to the pods</font><font color="#CCCCCC"> I will select</font>

356
00:13:20,019 --> 00:13:24,069
the<font color="#CCCCCC"> namespace default</font><font color="#E5E5E5"> as you can see I</font>

357
00:13:22,089 --> 00:13:26,589
have full access to the<font color="#CCCCCC"> entire cluster</font>

358
00:13:24,069 --> 00:13:28,120
and a lot<font color="#E5E5E5"> of times when you don't do a</font>

359
00:13:26,589 --> 00:13:29,920
pen test on the cluster<font color="#CCCCCC"> you will still</font>

360
00:13:28,120 --> 00:13:31,870
find<font color="#E5E5E5"> that the Cuban is dashboard has</font>

361
00:13:29,920 --> 00:13:34,449
these privileges because<font color="#E5E5E5"> it's very easy</font>

362
00:13:31,870 --> 00:13:36,459
for for<font color="#E5E5E5"> administrators to administer the</font>

363
00:13:34,449 --> 00:13:39,430
cluster<font color="#CCCCCC"> through this</font><font color="#E5E5E5"> interface so</font><font color="#CCCCCC"> now I</font>

364
00:13:36,459 --> 00:13:42,878
try<font color="#CCCCCC"> to open</font><font color="#E5E5E5"> some CSS but this empty now</font>

365
00:13:39,430 --> 00:13:46,449
try and<font color="#E5E5E5"> access some more and the next</font>

366
00:13:42,879 --> 00:13:49,230
step from you to go to spawn a pod<font color="#E5E5E5"> in my</font>

367
00:13:46,449 --> 00:13:52,899
own<font color="#CCCCCC"> namespace or any</font><font color="#E5E5E5"> arbitrary namespace</font>

368
00:13:49,230 --> 00:13:57,939
so what I will<font color="#E5E5E5"> do I will yeah go to my</font>

369
00:13:52,899 --> 00:13:59,259
<font color="#CCCCCC">namespace</font><font color="#E5E5E5"> and there's a there's</font><font color="#CCCCCC"> a nice</font>

370
00:13:57,939 --> 00:14:01,209
<font color="#CCCCCC">create</font><font color="#E5E5E5"> button in the upper right corner</font>

371
00:13:59,259 --> 00:14:02,620
where you can<font color="#CCCCCC"> place your</font><font color="#E5E5E5"> MOU file where</font>

372
00:14:01,209 --> 00:14:05,410
you<font color="#E5E5E5"> can upload a</font><font color="#CCCCCC"> llamo file and that way</font>

373
00:14:02,620 --> 00:14:08,259
you can<font color="#E5E5E5"> create a new a new pod what I</font>

374
00:14:05,410 --> 00:14:09,550
will do I will<font color="#CCCCCC"> yeah one name would</font><font color="#E5E5E5"> host</font>

375
00:14:08,259 --> 00:14:11,110
<font color="#E5E5E5">escape I will run an engine</font><font color="#CCCCCC"> ex</font><font color="#E5E5E5"> web</font>

376
00:14:09,550 --> 00:14:13,378
<font color="#E5E5E5">server because that's a job that never</font>

377
00:14:11,110 --> 00:14:16,149
completes I'll give it the<font color="#E5E5E5"> privileged</font>

378
00:14:13,379 --> 00:14:18,490
security context and I will try to<font color="#CCCCCC"> mount</font>

379
00:14:16,149 --> 00:14:19,720
the<font color="#CCCCCC"> host file system</font><font color="#E5E5E5"> inside my root</font>

380
00:14:18,490 --> 00:14:21,009
directory<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I will name it loot</font>

381
00:14:19,720 --> 00:14:24,819
<font color="#E5E5E5">because there's of course a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> loot</font>

382
00:14:21,009 --> 00:14:27,490
there and yeah I'll upload<font color="#E5E5E5"> it and then</font>

383
00:14:24,819 --> 00:14:29,559
<font color="#E5E5E5">it says</font><font color="#CCCCCC"> ok well done</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> hosts escape</font>

384
00:14:27,490 --> 00:14:31,689
is now waiting for creation<font color="#E5E5E5"> and then</font>

385
00:14:29,559 --> 00:14:34,750
there's a nice<font color="#CCCCCC"> exec feature inside</font><font color="#E5E5E5"> Cuba</font>

386
00:14:31,689 --> 00:14:37,509
needs<font color="#E5E5E5"> you can just click</font><font color="#CCCCCC"> it and it</font><font color="#E5E5E5"> gives</font>

387
00:14:34,750 --> 00:14:40,449
you a<font color="#E5E5E5"> very nice show which i think is</font>

388
00:14:37,509 --> 00:14:42,100
pretty<font color="#E5E5E5"> cool so yeah let's see all the</font>

389
00:14:40,449 --> 00:14:45,128
blog devices are there<font color="#E5E5E5"> indicating that I</font>

390
00:14:42,100 --> 00:14:46,720
am<font color="#CCCCCC"> indeed running in privilege mode but</font>

391
00:14:45,129 --> 00:14:49,509
since I<font color="#CCCCCC"> already mounted everything I can</font>

392
00:14:46,720 --> 00:14:51,550
go to<font color="#CCCCCC"> route there you go I can cut the</font>

393
00:14:49,509 --> 00:14:54,399
shadow file so basically I'm<font color="#E5E5E5"> route on</font>

394
00:14:51,550 --> 00:14:56,019
the node<font color="#E5E5E5"> using this issue and I can list</font>

395
00:14:54,399 --> 00:14:59,649
all<font color="#CCCCCC"> filesystem all files in</font><font color="#E5E5E5"> any</font>

396
00:14:56,019 --> 00:15:01,569
<font color="#CCCCCC">arbitrary home directory also to this</font>

397
00:14:59,649 --> 00:15:06,279
issue<font color="#E5E5E5"> you can immediately</font><font color="#CCCCCC"> pierce</font>

398
00:15:01,569 --> 00:15:09,429
escalation<font color="#E5E5E5"> to the host node that is</font>

399
00:15:06,279 --> 00:15:14,649
because<font color="#E5E5E5"> yeah again</font><font color="#CCCCCC"> the administrative</font>

400
00:15:09,429 --> 00:15:18,779
boundaries<font color="#CCCCCC"> will not set up that well so</font>

401
00:15:14,649 --> 00:15:21,160
yeah<font color="#CCCCCC"> now what there is</font><font color="#E5E5E5"> another example</font>

402
00:15:18,779 --> 00:15:22,300
<font color="#CCCCCC">this was what I was talking about the</font>

403
00:15:21,160 --> 00:15:24,310
<font color="#CCCCCC">cubelet API being</font>

404
00:15:22,300 --> 00:15:26,979
close to the<font color="#CCCCCC"> internet a lot of people</font>

405
00:15:24,310 --> 00:15:29,530
have<font color="#CCCCCC"> poor 10250 expose on the</font><font color="#E5E5E5"> internet</font>

406
00:15:26,980 --> 00:15:31,780
or<font color="#E5E5E5"> expose on the network and until the</font>

407
00:15:29,530 --> 00:15:33,310
9th of<font color="#CCCCCC"> February this year</font><font color="#E5E5E5"> it was</font>

408
00:15:31,780 --> 00:15:35,319
actually<font color="#CCCCCC"> an unattended code execution</font>

409
00:15:33,310 --> 00:15:37,540
<font color="#CCCCCC">basically as the administrator on</font><font color="#E5E5E5"> the</font>

410
00:15:35,320 --> 00:15:38,830
cubelet<font color="#CCCCCC"> API</font><font color="#E5E5E5"> so if you would find this</font>

411
00:15:37,540 --> 00:15:40,930
port on the<font color="#CCCCCC"> Internet you can</font><font color="#E5E5E5"> send a</font>

412
00:15:38,830 --> 00:15:42,460
<font color="#CCCCCC">request like this</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the file will be</font>

413
00:15:40,930 --> 00:15:44,979
<font color="#CCCCCC">created on any</font><font color="#E5E5E5"> arbitrary container</font>

414
00:15:42,460 --> 00:15:47,230
inside your network<font color="#E5E5E5"> there's a nice</font>

415
00:15:44,980 --> 00:15:49,570
write-up<font color="#E5E5E5"> about how a guy found I think a</font>

416
00:15:47,230 --> 00:15:51,460
minor on<font color="#E5E5E5"> this Cuba needs closer because</font>

417
00:15:49,570 --> 00:15:54,280
<font color="#E5E5E5">yeah the cubit API was being being</font>

418
00:15:51,460 --> 00:15:56,230
exposed<font color="#E5E5E5"> on the Internet and now it's</font>

419
00:15:54,280 --> 00:15:58,270
<font color="#E5E5E5">authenticated by default but on for ten</font>

420
00:15:56,230 --> 00:16:00,250
<font color="#E5E5E5">thousand two hundred</font><font color="#CCCCCC"> fifty-five there is</font>

421
00:15:58,270 --> 00:16:01,689
still an unauthenticated<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> I think</font>

422
00:16:00,250 --> 00:16:03,970
<font color="#E5E5E5">it's an information leakage in my</font>

423
00:16:01,690 --> 00:16:05,890
opinion we can<font color="#CCCCCC"> still get namespaces</font>

424
00:16:03,970 --> 00:16:08,080
secret names<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you can also get</font>

425
00:16:05,890 --> 00:16:11,350
<font color="#CCCCCC">blocked device names or other</font>

426
00:16:08,080 --> 00:16:14,560
information<font color="#E5E5E5"> from the from the node and</font>

427
00:16:11,350 --> 00:16:18,940
<font color="#E5E5E5">also on a hacker one I believe there was</font>

428
00:16:14,560 --> 00:16:21,130
<font color="#CCCCCC">a very nice bug</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> SS RF on Shopify</font><font color="#E5E5E5"> they</font>

429
00:16:18,940 --> 00:16:22,450
had<font color="#E5E5E5"> there they're using a Cuba</font><font color="#CCCCCC"> needs for</font>

430
00:16:21,130 --> 00:16:26,260
people<font color="#CCCCCC"> to set up their own stores and</font>

431
00:16:22,450 --> 00:16:27,820
there was a there<font color="#CCCCCC"> was a tool inside</font>

432
00:16:26,260 --> 00:16:30,189
Shopify that allowed you to<font color="#E5E5E5"> take a</font>

433
00:16:27,820 --> 00:16:32,260
snapshot of<font color="#E5E5E5"> how your how your web shop</font>

434
00:16:30,190 --> 00:16:33,580
was looking like so one guy decided<font color="#E5E5E5"> that</font>

435
00:16:32,260 --> 00:16:35,800
he would like to<font color="#E5E5E5"> have</font><font color="#CCCCCC"> a look</font><font color="#E5E5E5"> at the</font>

436
00:16:33,580 --> 00:16:37,240
tokens that<font color="#E5E5E5"> are on the cluster and so he</font>

437
00:16:35,800 --> 00:16:40,810
managed to<font color="#E5E5E5"> get his own service account</font>

438
00:16:37,240 --> 00:16:43,150
<font color="#CCCCCC">and using</font><font color="#E5E5E5"> that token he managed</font><font color="#CCCCCC"> to query</font>

439
00:16:40,810 --> 00:16:44,589
the the<font color="#E5E5E5"> cube environment variables as</font>

440
00:16:43,150 --> 00:16:46,480
you can see in the<font color="#CCCCCC"> authorization bear</font>

441
00:16:44,590 --> 00:16:50,020
that would be where your<font color="#CCCCCC"> JWT token would</font>

442
00:16:46,480 --> 00:16:51,280
go right here and he<font color="#E5E5E5"> disclosed the</font>

443
00:16:50,020 --> 00:16:52,810
private keys inside his environment

444
00:16:51,280 --> 00:16:55,120
<font color="#E5E5E5">variable and then downloaded the cube</font>

445
00:16:52,810 --> 00:16:58,209
CTL inside his foot and he could easily

446
00:16:55,120 --> 00:17:00,490
yeah he was rude on all on all possible

447
00:16:58,210 --> 00:17:03,100
ports from Shopify<font color="#E5E5E5"> also other namespaces</font>

448
00:17:00,490 --> 00:17:05,170
everything was compromised<font color="#E5E5E5"> and yeah he</font>

449
00:17:03,100 --> 00:17:07,660
got a twenty four thousand five<font color="#CCCCCC"> hundred</font>

450
00:17:05,170 --> 00:17:09,640
dollar bounty<font color="#E5E5E5"> for that it's a yeah it's</font>

451
00:17:07,660 --> 00:17:11,980
a<font color="#E5E5E5"> very nice feature</font><font color="#CCCCCC"> for you to have in</font>

452
00:17:09,640 --> 00:17:13,360
the queue in his classroom<font color="#E5E5E5"> so yeah what</font>

453
00:17:11,980 --> 00:17:15,130
can you do about<font color="#CCCCCC"> it how can you protect</font>

454
00:17:13,359 --> 00:17:17,589
your cluster against<font color="#E5E5E5"> these</font><font color="#CCCCCC"> five footpegs</font>

455
00:17:15,130 --> 00:17:19,750
so it's very important<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> to define</font>

456
00:17:17,589 --> 00:17:21,339
tiers and labels for for instance<font color="#CCCCCC"> front</font>

457
00:17:19,750 --> 00:17:23,650
<font color="#E5E5E5">end and back end</font><font color="#CCCCCC"> set up egress and</font>

458
00:17:21,339 --> 00:17:25,869
ingress rules not all<font color="#CCCCCC"> servers</font><font color="#E5E5E5"> need to</font>

459
00:17:23,650 --> 00:17:27,430
talk to<font color="#E5E5E5"> things on the internet they</font>

460
00:17:25,869 --> 00:17:28,810
<font color="#CCCCCC">don't need to</font><font color="#E5E5E5"> talk to each other so</font><font color="#CCCCCC"> you</font>

461
00:17:27,430 --> 00:17:30,640
<font color="#E5E5E5">can use these labels to set up</font>

462
00:17:28,810 --> 00:17:32,330
administrative interfaces and

463
00:17:30,640 --> 00:17:34,040
<font color="#E5E5E5">segmentation</font>

464
00:17:32,330 --> 00:17:35,689
yeah you should<font color="#CCCCCC"> also filter the</font>

465
00:17:34,040 --> 00:17:39,050
<font color="#E5E5E5">following service ports if you decide to</font>

466
00:17:35,690 --> 00:17:40,400
<font color="#E5E5E5">you have your pot</font><font color="#CCCCCC"> exposed on your the</font>

467
00:17:39,050 --> 00:17:42,680
cluster<font color="#CCCCCC"> exposed on the internet so the</font>

468
00:17:40,400 --> 00:17:43,940
<font color="#CCCCCC">cubit</font><font color="#E5E5E5"> API should</font><font color="#CCCCCC"> not be reachable</font><font color="#E5E5E5"> the</font>

469
00:17:42,680 --> 00:17:45,800
<font color="#CCCCCC">node controller port should</font><font color="#E5E5E5"> not be</font>

470
00:17:43,940 --> 00:17:47,390
reachable at CD and even<font color="#CCCCCC"> Calico they</font>

471
00:17:45,800 --> 00:17:49,100
should<font color="#E5E5E5"> not be exposed on</font><font color="#CCCCCC"> the Internet</font>

472
00:17:47,390 --> 00:17:51,050
but yeah better not<font color="#E5E5E5"> do not expose</font>

473
00:17:49,100 --> 00:17:53,449
anything on your<font color="#CCCCCC"> cube nice closet to</font><font color="#E5E5E5"> the</font>

474
00:17:51,050 --> 00:17:55,370
<font color="#CCCCCC">Internet maybe your your your</font><font color="#E5E5E5"> websites</font>

475
00:17:53,450 --> 00:17:57,620
but anything that's critical for<font color="#E5E5E5"> your</font>

476
00:17:55,370 --> 00:18:00,020
cluster<font color="#E5E5E5"> it's better to keep it</font><font color="#CCCCCC"> inside</font>

477
00:17:57,620 --> 00:18:03,320
your internal network<font color="#E5E5E5"> this is an example</font>

478
00:18:00,020 --> 00:18:04,970
<font color="#E5E5E5">of how to set</font><font color="#CCCCCC"> up an egress rule so you</font>

479
00:18:03,320 --> 00:18:07,070
can basically say like<font color="#CCCCCC"> application foo</font>

480
00:18:04,970 --> 00:18:10,280
<font color="#CCCCCC">or application engine X</font><font color="#E5E5E5"> you're only</font>

481
00:18:07,070 --> 00:18:12,530
allowed<font color="#CCCCCC"> to talk</font><font color="#E5E5E5"> outbound to port 53 of</font>

482
00:18:10,280 --> 00:18:14,899
course this won't really<font color="#CCCCCC"> protect against</font>

483
00:18:12,530 --> 00:18:17,090
<font color="#E5E5E5">the data exfiltration but this is an</font>

484
00:18:14,900 --> 00:18:19,010
<font color="#E5E5E5">example of what you can set</font><font color="#CCCCCC"> up and there</font>

485
00:18:17,090 --> 00:18:20,419
are<font color="#E5E5E5"> very nice recipes on the on the link</font>

486
00:18:19,010 --> 00:18:22,340
<font color="#E5E5E5">that's below in the slide where you can</font>

487
00:18:20,420 --> 00:18:24,350
easily<font color="#E5E5E5"> configure your network policies</font>

488
00:18:22,340 --> 00:18:26,179
because it's quite<font color="#CCCCCC"> hard</font><font color="#E5E5E5"> and you have a</font>

489
00:18:24,350 --> 00:18:28,459
lot of<font color="#CCCCCC"> llamó that you can set up</font><font color="#E5E5E5"> in</font>

490
00:18:26,180 --> 00:18:31,700
<font color="#CCCCCC">order to yeah</font><font color="#E5E5E5"> to get it up and running</font>

491
00:18:28,460 --> 00:18:34,040
<font color="#E5E5E5">so another advice is to</font><font color="#CCCCCC"> use a</font><font color="#E5E5E5"> SSH</font>

492
00:18:31,700 --> 00:18:36,620
<font color="#CCCCCC">Bastion</font><font color="#E5E5E5"> host for your notes only use</font>

493
00:18:34,040 --> 00:18:39,110
<font color="#E5E5E5">maybe whitelist and</font><font color="#CCCCCC"> SSH IP for you to</font>

494
00:18:36,620 --> 00:18:41,209
administrator the node<font color="#CCCCCC"> with and you can</font>

495
00:18:39,110 --> 00:18:43,550
limit your user access by just this one

496
00:18:41,210 --> 00:18:45,350
<font color="#E5E5E5">Bastion host and if possible it's</font>

497
00:18:43,550 --> 00:18:47,240
recommended to<font color="#E5E5E5"> disable</font><font color="#CCCCCC"> privilege mode</font>

498
00:18:45,350 --> 00:18:48,679
because<font color="#E5E5E5"> privilege mode again gives you a</font>

499
00:18:47,240 --> 00:18:50,960
lot of privileges on the<font color="#E5E5E5"> host that's I</font>

500
00:18:48,680 --> 00:18:52,640
guess why it's called privilege mode and

501
00:18:50,960 --> 00:18:54,740
you can<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to set a proper logging and</font>

502
00:18:52,640 --> 00:18:58,070
maybe do not automatically mount service

503
00:18:54,740 --> 00:18:59,990
accounts where it's not necessary<font color="#E5E5E5"> and</font>

504
00:18:58,070 --> 00:19:01,550
yeah use<font color="#E5E5E5"> the latest version</font><font color="#CCCCCC"> of cuny's</font><font color="#E5E5E5"> so</font>

505
00:18:59,990 --> 00:19:03,290
<font color="#CCCCCC">scuba news moves fast I think</font><font color="#E5E5E5"> we're now</font>

506
00:19:01,550 --> 00:19:06,040
up<font color="#CCCCCC"> into version 12 and when I was doing</font>

507
00:19:03,290 --> 00:19:08,240
my testing it was mainly on<font color="#E5E5E5"> 1.8 and</font>

508
00:19:06,040 --> 00:19:11,330
<font color="#CCCCCC">under</font><font color="#E5E5E5"> are some tools available now</font>

509
00:19:08,240 --> 00:19:14,420
like a<font color="#CCCCCC"> cube bench and cube Seck which is</font>

510
00:19:11,330 --> 00:19:16,639
automated<font color="#CCCCCC"> benchmarking for you some I</font>

511
00:19:14,420 --> 00:19:19,940
<font color="#E5E5E5">think you benched runs against the CIS</font>

512
00:19:16,640 --> 00:19:22,100
standards<font color="#CCCCCC"> another one but you can also</font>

513
00:19:19,940 --> 00:19:24,650
do you cannot run<font color="#CCCCCC"> your</font><font color="#E5E5E5"> spots as route by</font>

514
00:19:22,100 --> 00:19:27,260
default currently that's the setting<font color="#E5E5E5"> and</font>

515
00:19:24,650 --> 00:19:29,120
when<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> rude</font><font color="#E5E5E5"> on a pod you're also</font>

516
00:19:27,260 --> 00:19:30,830
<font color="#E5E5E5">rude on the node and as you could see</font>

517
00:19:29,120 --> 00:19:32,659
when I was<font color="#E5E5E5"> doing the escape to</font>

518
00:19:30,830 --> 00:19:34,340
<font color="#CCCCCC">privileged mode I could</font><font color="#E5E5E5"> actually cut all</font>

519
00:19:32,660 --> 00:19:36,830
the files on a node so root on the<font color="#E5E5E5"> pod</font>

520
00:19:34,340 --> 00:19:38,870
is<font color="#CCCCCC"> rude on the</font><font color="#E5E5E5"> house so if you set a</font>

521
00:19:36,830 --> 00:19:41,899
strong<font color="#E5E5E5"> security context you can say like</font>

522
00:19:38,870 --> 00:19:42,290
<font color="#E5E5E5">okay I can only use UID</font><font color="#CCCCCC"> 1,000 instead of</font>

523
00:19:41,900 --> 00:19:43,770
UID

524
00:19:42,290 --> 00:19:45,540
<font color="#CCCCCC">from</font><font color="#E5E5E5"> root</font>

525
00:19:43,770 --> 00:19:47,100
and there's also an option inside Cuba

526
00:19:45,540 --> 00:19:48,899
<font color="#E5E5E5">needs that is called disabled</font><font color="#CCCCCC"> Prive</font>

527
00:19:47,100 --> 00:19:51,060
<font color="#CCCCCC">esque</font><font color="#E5E5E5"> which is really</font><font color="#CCCCCC"> interesting I</font>

528
00:19:48,900 --> 00:19:53,010
<font color="#CCCCCC">think you should enable it</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's also</font>

529
00:19:51,060 --> 00:19:54,929
a one that's called set deny escalating

530
00:19:53,010 --> 00:19:57,450
<font color="#CCCCCC">exec</font><font color="#E5E5E5"> which means that if your pot is</font>

531
00:19:54,930 --> 00:19:59,310
<font color="#E5E5E5">running a privileged mode you cannot do</font>

532
00:19:57,450 --> 00:20:01,290
the<font color="#E5E5E5"> exact command on</font><font color="#CCCCCC"> it to get</font><font color="#E5E5E5"> a shell</font>

533
00:19:59,310 --> 00:20:03,300
and when you settle out previous

534
00:20:01,290 --> 00:20:05,340
escalation to false<font color="#E5E5E5"> it will break set</font>

535
00:20:03,300 --> 00:20:07,950
<font color="#CCCCCC">UID binaries but it also means</font><font color="#E5E5E5"> that</font>

536
00:20:05,340 --> 00:20:10,560
<font color="#E5E5E5">you're not rude on the note anymore</font><font color="#CCCCCC"> and</font>

537
00:20:07,950 --> 00:20:11,880
just<font color="#CCCCCC"> like any other</font><font color="#E5E5E5"> operating system or</font>

538
00:20:10,560 --> 00:20:15,149
machine you<font color="#E5E5E5"> should always check your</font>

539
00:20:11,880 --> 00:20:18,540
containers for vulnerable software this

540
00:20:15,150 --> 00:20:20,280
<font color="#E5E5E5">is an example of network policy this</font><font color="#CCCCCC"> is</font>

541
00:20:18,540 --> 00:20:22,980
<font color="#CCCCCC">security context example I can say Low</font>

542
00:20:20,280 --> 00:20:25,889
<font color="#CCCCCC">Ki run as user of 1000</font><font color="#E5E5E5"> I have a nice</font>

543
00:20:22,980 --> 00:20:27,660
<font color="#CCCCCC">volume</font><font color="#E5E5E5"> set up and in my security context</font>

544
00:20:25,890 --> 00:20:30,150
I say<font color="#E5E5E5"> previous escalation is not allowed</font>

545
00:20:27,660 --> 00:20:31,650
<font color="#E5E5E5">the file system is read-only because</font>

546
00:20:30,150 --> 00:20:33,480
yeah it would be weird<font color="#E5E5E5"> if you would pawn</font>

547
00:20:31,650 --> 00:20:36,060
a pot<font color="#E5E5E5"> and then go up to the house</font><font color="#CCCCCC"> and</font>

548
00:20:33,480 --> 00:20:38,130
you have<font color="#E5E5E5"> full red</font><font color="#CCCCCC"> X's and I say everyone</font>

549
00:20:36,060 --> 00:20:41,100
as<font color="#E5E5E5"> non-root is true and you</font><font color="#CCCCCC"> can even in</font>

550
00:20:38,130 --> 00:20:43,200
the capabilities you<font color="#CCCCCC"> can block certain</font>

551
00:20:41,100 --> 00:20:44,820
<font color="#CCCCCC">sis calls</font><font color="#E5E5E5"> so you can say you're not</font>

552
00:20:43,200 --> 00:20:46,080
<font color="#CCCCCC">allowed to set up raw sockets so for</font>

553
00:20:44,820 --> 00:20:47,939
instance yeah you wouldn't<font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to</font>

554
00:20:46,080 --> 00:20:49,560
run ping or you cannot change the

555
00:20:47,940 --> 00:20:52,260
ownership of any files so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can</font>

556
00:20:49,560 --> 00:20:53,580
really find<font color="#E5E5E5"> wait the user control and if</font>

557
00:20:52,260 --> 00:20:55,650
you like<font color="#E5E5E5"> your mole of course then I</font>

558
00:20:53,580 --> 00:20:59,310
think Cuba<font color="#E5E5E5"> needs is the</font><font color="#CCCCCC"> platform you</font>

559
00:20:55,650 --> 00:21:01,410
<font color="#CCCCCC">should go to yeah</font><font color="#E5E5E5"> and of course harden</font>

560
00:20:59,310 --> 00:21:03,090
the user accounts<font color="#E5E5E5"> service account should</font>

561
00:21:01,410 --> 00:21:04,620
<font color="#CCCCCC">be limited and</font><font color="#E5E5E5"> I think you should not</font>

562
00:21:03,090 --> 00:21:06,510
automatically mount your user accounts

563
00:21:04,620 --> 00:21:08,010
you can whitelist your accounts per port

564
00:21:06,510 --> 00:21:10,620
and per<font color="#E5E5E5"> namespace have separate accounts</font>

565
00:21:08,010 --> 00:21:13,530
<font color="#CCCCCC">for each namespace and try to limit</font><font color="#E5E5E5"> your</font>

566
00:21:10,620 --> 00:21:15,330
admin as much as possible<font color="#CCCCCC"> for</font><font color="#E5E5E5"> instance</font>

567
00:21:13,530 --> 00:21:17,760
<font color="#CCCCCC">don't run your Cuba needs - borders up</font>

568
00:21:15,330 --> 00:21:19,740
mean by default and yeah just apply the

569
00:21:17,760 --> 00:21:22,260
principle<font color="#E5E5E5"> of least privilege where as</font>

570
00:21:19,740 --> 00:21:25,860
possible this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> an example of</font><font color="#E5E5E5"> a very</font>

571
00:21:22,260 --> 00:21:27,840
simple cluster<font color="#CCCCCC"> rule you can say like ok</font>

572
00:21:25,860 --> 00:21:31,560
<font color="#E5E5E5">for the resources</font><font color="#CCCCCC"> posting services</font>

573
00:21:27,840 --> 00:21:33,959
you're only allowed to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> list get</font>

574
00:21:31,560 --> 00:21:35,550
our list<font color="#CCCCCC"> yeah you can get or list</font>

575
00:21:33,960 --> 00:21:37,920
<font color="#E5E5E5">anything that's imports or services you</font>

576
00:21:35,550 --> 00:21:39,750
<font color="#E5E5E5">cannot write anything there and luckily</font>

577
00:21:37,920 --> 00:21:41,700
<font color="#E5E5E5">by default I think</font><font color="#CCCCCC"> this is the setting</font>

578
00:21:39,750 --> 00:21:45,600
for service accounts so Cuba<font color="#CCCCCC"> nice is</font>

579
00:21:41,700 --> 00:21:47,400
really really<font color="#E5E5E5"> improving over there yeah</font>

580
00:21:45,600 --> 00:21:49,169
we have a lot of time less<font color="#E5E5E5"> maybe if you</font>

581
00:21:47,400 --> 00:21:52,080
guys have some questions<font color="#E5E5E5"> this was a</font>

582
00:21:49,170 --> 00:21:53,520
majority of my talk<font color="#E5E5E5"> yeah Cuba needs by</font>

583
00:21:52,080 --> 00:21:55,080
default had these bad configuration

584
00:21:53,520 --> 00:21:56,910
issues I didn't check<font color="#E5E5E5"> a lot in the in</font>

585
00:21:55,080 --> 00:21:59,370
the cloud<font color="#E5E5E5"> but as you could</font>

586
00:21:56,910 --> 00:22:00,660
<font color="#CCCCCC">-</font><font color="#E5E5E5"> Shopify</font><font color="#CCCCCC"> xsrf</font><font color="#E5E5E5"> for instance</font><font color="#CCCCCC"> it's just a</font>

587
00:21:59,370 --> 00:22:02,969
configuration<font color="#CCCCCC"> that is really difficult</font>

588
00:22:00,660 --> 00:22:04,800
to<font color="#E5E5E5"> achieve in</font><font color="#CCCCCC"> this cluster</font><font color="#E5E5E5"> so when you</font>

589
00:22:02,970 --> 00:22:07,290
install<font color="#CCCCCC"> Kunis or get your deployment</font>

590
00:22:04,800 --> 00:22:09,030
Cuba<font color="#E5E5E5"> needs it used to be a very open by</font>

591
00:22:07,290 --> 00:22:12,240
default<font color="#CCCCCC"> everything</font><font color="#E5E5E5"> most admin everything</font>

592
00:22:09,030 --> 00:22:14,639
was privileged but now what we found is

593
00:22:12,240 --> 00:22:16,290
that they're starting<font color="#CCCCCC"> to be secured by</font>

594
00:22:14,640 --> 00:22:18,960
<font color="#CCCCCC">default which makes it a lot easier for</font>

595
00:22:16,290 --> 00:22:20,730
<font color="#E5E5E5">you</font><font color="#CCCCCC"> to have a</font><font color="#E5E5E5"> secure setup but the thing</font>

596
00:22:18,960 --> 00:22:22,500
was that<font color="#CCCCCC"> I was just open and if you look</font>

597
00:22:20,730 --> 00:22:24,210
at the the<font color="#CCCCCC"> Cubans github</font><font color="#E5E5E5"> you'll see a</font>

598
00:22:22,500 --> 00:22:26,160
lot<font color="#CCCCCC"> of issues and milestones where they</font>

599
00:22:24,210 --> 00:22:28,410
basically<font color="#E5E5E5"> said</font><font color="#CCCCCC"> ok now we're moving to a</font>

600
00:22:26,160 --> 00:22:30,480
more<font color="#E5E5E5"> secure by default because I think</font>

601
00:22:28,410 --> 00:22:32,400
<font color="#E5E5E5">there was</font><font color="#CCCCCC"> even a CTF from from besides</font>

602
00:22:30,480 --> 00:22:34,140
in the<font color="#E5E5E5"> US it what house was on a</font><font color="#CCCCCC"> Cuban</font>

603
00:22:32,400 --> 00:22:36,240
<font color="#CCCCCC">YZ</font><font color="#E5E5E5"> platform and you think the CTF guys</font>

604
00:22:34,140 --> 00:22:38,400
would secure their platform and<font color="#E5E5E5"> their</font>

605
00:22:36,240 --> 00:22:40,470
pots were like<font color="#CCCCCC"> like harder</font><font color="#E5E5E5"> to exploit</font>

606
00:22:38,400 --> 00:22:42,150
but they<font color="#E5E5E5"> found out that</font><font color="#CCCCCC"> even though CTF</font>

607
00:22:40,470 --> 00:22:44,160
guys they fail to<font color="#E5E5E5"> properly secure</font><font color="#CCCCCC"> the</font>

608
00:22:42,150 --> 00:22:46,980
<font color="#CCCCCC">Cuban YZ and one guy got the service</font>

609
00:22:44,160 --> 00:22:48,240
<font color="#E5E5E5">account and put all the pots at once so</font>

610
00:22:46,980 --> 00:22:51,260
yeah just just<font color="#E5E5E5"> to secure by default</font>

611
00:22:48,240 --> 00:22:57,000
<font color="#CCCCCC">that's the issue it</font><font color="#E5E5E5"> should be like that</font>

612
00:22:51,260 --> 00:22:59,910
<font color="#E5E5E5">one question in the back yes hi</font><font color="#CCCCCC"> so you</font>

613
00:22:57,000 --> 00:23:03,090
were<font color="#E5E5E5"> talking about owning</font><font color="#CCCCCC"> the host</font>

614
00:22:59,910 --> 00:23:07,500
system<font color="#CCCCCC"> yeah on the container</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> on the</font>

615
00:23:03,090 --> 00:23:10,590
polling<font color="#E5E5E5"> route so docker can map root</font>

616
00:23:07,500 --> 00:23:13,370
user<font color="#CCCCCC"> 2 to an employer juice around</font><font color="#E5E5E5"> the</font>

617
00:23:10,590 --> 00:23:17,550
host<font color="#E5E5E5"> yes can you use that to mitigate</font>

618
00:23:13,370 --> 00:23:19,139
<font color="#E5E5E5">these kind of attacks yes yeah it would</font>

619
00:23:17,550 --> 00:23:21,450
because you you need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> route in</font>

620
00:23:19,140 --> 00:23:23,310
order<font color="#E5E5E5"> to mount the block device so that</font>

621
00:23:21,450 --> 00:23:26,690
we'd indeed mitigate against this attack

622
00:23:23,310 --> 00:23:32,520
<font color="#CCCCCC">yeah okay thank you</font>

623
00:23:26,690 --> 00:23:38,340
any more<font color="#E5E5E5"> questions no</font><font color="#CCCCCC"> okay I guess</font>

624
00:23:32,520 --> 00:23:40,310
<font color="#E5E5E5">anybody else okay then that's it Vincent</font>

625
00:23:38,340 --> 00:23:48,899
<font color="#CCCCCC">thanks</font><font color="#E5E5E5"> very much</font>

626
00:23:40,310 --> 00:23:48,899
[Applause]

