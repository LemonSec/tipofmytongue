1
00:00:01,140 --> 00:00:04,620
now I'll hand over to Henrik

2
00:00:04,620 --> 00:00:06,839
thank you very much

3
00:00:06,839 --> 00:00:11,000
good morning everyone my name is

4
00:00:12,000 --> 00:00:14,759
Budapest and CEO of the city and I'm

5
00:00:14,759 --> 00:00:16,440
very happy to be at this conference for

6
00:00:16,440 --> 00:00:17,820
the first time

7
00:00:17,820 --> 00:00:19,920
my presentation is available as a PDF

8
00:00:19,920 --> 00:00:21,960
and it's already on GitHub so if you go

9
00:00:21,960 --> 00:00:24,720
to GitHub and use my nickname kamsa then

10
00:00:24,720 --> 00:00:27,300
you can find it using activity as a

11
00:00:27,300 --> 00:00:29,220
search term so it should be possible to

12
00:00:29,220 --> 00:00:30,599
get this presentation

13
00:00:30,599 --> 00:00:33,360
immediately if you like the presentation

14
00:00:33,360 --> 00:00:35,520
also has some contact information for me

15
00:00:35,520 --> 00:00:37,739
I'm just a network and security

16
00:00:37,739 --> 00:00:39,780
consultant I have been working with

17
00:00:39,780 --> 00:00:42,480
networks and security for our since the

18
00:00:42,480 --> 00:00:45,840
early 90s I'm a huge fan of firewalls

19
00:00:45,840 --> 00:00:46,980
and I would like to state that

20
00:00:46,980 --> 00:00:48,660
immediately because I will be making

21
00:00:48,660 --> 00:00:50,700
some comments about firewalls later on

22
00:00:50,700 --> 00:00:53,940
but I'm a huge fan of firewalls I run a

23
00:00:53,940 --> 00:00:57,960
small Network as 57 860 where I try to

24
00:00:57,960 --> 00:00:59,699
implement some of this stuff and I

25
00:00:59,699 --> 00:01:01,620
usually work from Denmark but I also

26
00:01:01,620 --> 00:01:03,239
travel a lot and I have been around the

27
00:01:03,239 --> 00:01:05,760
world in different places to do testing

28
00:01:05,760 --> 00:01:08,880
and pin testing and building networks I

29
00:01:08,880 --> 00:01:11,040
also like to enjoy the ripe conferences

30
00:01:11,040 --> 00:01:14,100
and be part of the community like we do

31
00:01:14,100 --> 00:01:16,020
at this event

32
00:01:16,020 --> 00:01:18,540
and I will be around both today and

33
00:01:18,540 --> 00:01:20,280
tomorrow so if you have any questions

34
00:01:20,280 --> 00:01:24,000
later please approach me and ask them

35
00:01:24,000 --> 00:01:26,700
so this presentation is about Security

36
00:01:26,700 --> 00:01:29,759
on the internet and as you may know that

37
00:01:29,759 --> 00:01:30,900
when you're connecting to the internet

38
00:01:30,900 --> 00:01:33,479
we immediately receive traffic from

39
00:01:33,479 --> 00:01:35,880
unknown sources we are immediately

40
00:01:35,880 --> 00:01:37,860
getting scanned we are seeing the noise

41
00:01:37,860 --> 00:01:40,200
on the internet the Internet teenages

42
00:01:40,200 --> 00:01:42,060
it's kind of like a background noise

43
00:01:42,060 --> 00:01:44,280
whenever we connect to the internet

44
00:01:44,280 --> 00:01:47,340
and we should of course try to be

45
00:01:47,340 --> 00:01:49,740
proactive and test our networks using

46
00:01:49,740 --> 00:01:53,040
active penetration testing methods so

47
00:01:53,040 --> 00:01:55,320
hopefully most of you will know that it

48
00:01:55,320 --> 00:01:58,140
is very useful to do Port scanning it is

49
00:01:58,140 --> 00:01:59,880
very useful to try to look at your

50
00:01:59,880 --> 00:02:02,340
attack surface from the outside and that

51
00:02:02,340 --> 00:02:04,460
is what this presentation is also about

52
00:02:04,460 --> 00:02:07,680
so this talk will be about DDOS testing

53
00:02:07,680 --> 00:02:10,380
your infrastructures on the internet I

54
00:02:10,380 --> 00:02:12,480
will have an ultra short firewall

55
00:02:12,480 --> 00:02:15,180
description what is a firewall because

56
00:02:15,180 --> 00:02:17,700
that creates some problems for us when

57
00:02:17,700 --> 00:02:19,440
we do the DDOS testing but it also

58
00:02:19,440 --> 00:02:20,940
creates a problem for you when you are

59
00:02:20,940 --> 00:02:24,300
under attack from DDOS sources so I will

60
00:02:24,300 --> 00:02:25,739
be talking a little bit about doing Port

61
00:02:25,739 --> 00:02:27,599
scans for discovery of infrastructures

62
00:02:27,599 --> 00:02:29,640
because those will be the weak points

63
00:02:29,640 --> 00:02:31,680
that we will be attacking then I will

64
00:02:31,680 --> 00:02:34,379
follow up by some detailed advice how to

65
00:02:34,379 --> 00:02:37,200
perform an active detail simulation so I

66
00:02:37,200 --> 00:02:39,599
call it a simulation I do it I call it

67
00:02:39,599 --> 00:02:42,480
Adidas test but I'm trying to mimic what

68
00:02:42,480 --> 00:02:44,700
the attackers do to our Networks but

69
00:02:44,700 --> 00:02:47,040
instead of having this chaotic attack on

70
00:02:47,040 --> 00:02:48,840
your network where you don't really know

71
00:02:48,840 --> 00:02:50,580
what's going on you don't know what kind

72
00:02:50,580 --> 00:02:52,920
of traffic you're receiving we try to do

73
00:02:52,920 --> 00:02:55,080
it in a more structured way so we can

74
00:02:55,080 --> 00:02:57,599
see how the devices react and then what

75
00:02:57,599 --> 00:03:00,780
kind of logs they lock how they actually

76
00:03:00,780 --> 00:03:03,060
behave during an attack

77
00:03:03,060 --> 00:03:06,599
so we try to do more structured DDOS

78
00:03:06,599 --> 00:03:08,459
testing so that will involve running

79
00:03:08,459 --> 00:03:11,220
various Tools in various circumstances

80
00:03:11,220 --> 00:03:13,680
and with various options and I'm trying

81
00:03:13,680 --> 00:03:16,140
to be very specific because a lot of a

82
00:03:16,140 --> 00:03:18,000
lot of these tools have many many

83
00:03:18,000 --> 00:03:20,340
options so I'm trying to lay out a

84
00:03:20,340 --> 00:03:22,680
structure and how to actually perform a

85
00:03:22,680 --> 00:03:24,720
minimal DDOS test and then you can get

86
00:03:24,720 --> 00:03:27,239
creative afterwards and being evenly

87
00:03:27,239 --> 00:03:29,459
creative sometimes is quite nice because

88
00:03:29,459 --> 00:03:32,459
then you can try to protect your network

89
00:03:32,459 --> 00:03:34,860
from these evil attacks afterwards and

90
00:03:34,860 --> 00:03:36,959
when these evil attacks come and

91
00:03:36,959 --> 00:03:39,000
unfortunately as we have seen in Denmark

92
00:03:39,000 --> 00:03:41,099
and other places internationally we are

93
00:03:41,099 --> 00:03:42,900
getting attacked we are getting attacked

94
00:03:42,900 --> 00:03:44,099
all the time

95
00:03:44,099 --> 00:03:46,620
so at the end of the presentation I will

96
00:03:46,620 --> 00:03:48,720
have some advice for protection and

97
00:03:48,720 --> 00:03:51,540
after the question slide my last slide I

98
00:03:51,540 --> 00:03:53,400
will be presenting there's also going to

99
00:03:53,400 --> 00:03:55,260
be some slides which have some pointers

100
00:03:55,260 --> 00:03:57,720
to other references and other tools and

101
00:03:57,720 --> 00:03:59,879
other methods for protecting so some of

102
00:03:59,879 --> 00:04:02,459
the protection part is left out because

103
00:04:02,459 --> 00:04:03,840
of time

104
00:04:03,840 --> 00:04:05,700
these attack tools that I will be

105
00:04:05,700 --> 00:04:07,920
talking about is mostly some that are

106
00:04:07,920 --> 00:04:09,540
already developed some of them have been

107
00:04:09,540 --> 00:04:11,599
around for many years

108
00:04:11,599 --> 00:04:14,700
maybe you know them already but I have

109
00:04:14,700 --> 00:04:17,279
added a few things of my own and I have

110
00:04:17,279 --> 00:04:19,320
tried to update this presentation to be

111
00:04:19,320 --> 00:04:21,358
kind of state of the art how we can do

112
00:04:21,358 --> 00:04:24,000
DDOS testing ourselves with a low budget

113
00:04:24,000 --> 00:04:25,800
so you don't need a lot of money to do

114
00:04:25,800 --> 00:04:28,259
perform this but you can do it with

115
00:04:28,259 --> 00:04:29,639
probably some of your existing

116
00:04:29,639 --> 00:04:31,979
environment and you can also protect a

117
00:04:31,979 --> 00:04:33,840
lot with your existing environment so

118
00:04:33,840 --> 00:04:35,880
that's kind of the goal of today to get

119
00:04:35,880 --> 00:04:37,560
you started on stuff that you can go

120
00:04:37,560 --> 00:04:40,199
home and try out and you can improve the

121
00:04:40,199 --> 00:04:41,940
security of your Networks

122
00:04:41,940 --> 00:04:44,160
I also have some opinions about some of

123
00:04:44,160 --> 00:04:46,320
these things and I don't mind telling

124
00:04:46,320 --> 00:04:48,900
you about my opinions if it is my

125
00:04:48,900 --> 00:04:50,940
opinion then you are free to disregard

126
00:04:50,940 --> 00:04:53,280
it you may agree with me you may not

127
00:04:53,280 --> 00:04:55,380
agree with me and I'm very very happy to

128
00:04:55,380 --> 00:04:57,180
discuss and talk about networks and

129
00:04:57,180 --> 00:04:59,400
package afterwards so approach me please

130
00:04:59,400 --> 00:05:02,160
that would be fun

131
00:05:02,160 --> 00:05:04,620
talking about the internet and details

132
00:05:04,620 --> 00:05:06,900
we know that it is trouble I have taken

133
00:05:06,900 --> 00:05:08,580
some of the statistics from some of

134
00:05:08,580 --> 00:05:10,560
these reports we see these reports

135
00:05:10,560 --> 00:05:12,660
quarterly yearly from different

136
00:05:12,660 --> 00:05:14,940
companies in this case it's the one

137
00:05:14,940 --> 00:05:17,040
called netscout where they say that we

138
00:05:17,040 --> 00:05:19,440
have these large attacks we have these

139
00:05:19,440 --> 00:05:22,259
decreases and increases sometimes it

140
00:05:22,259 --> 00:05:24,840
goes up sometimes it goes down some of

141
00:05:24,840 --> 00:05:27,660
these attacks are really really big when

142
00:05:27,660 --> 00:05:29,340
we see these numbers when I see a number

143
00:05:29,340 --> 00:05:32,340
like 612 gigabits per second

144
00:05:32,340 --> 00:05:34,680
that's more than I have into my network

145
00:05:34,680 --> 00:05:38,900
in Copenhagen if I see the number

146
00:05:38,900 --> 00:05:43,500
453 million packets per second mpps is

147
00:05:43,500 --> 00:05:46,080
millions of packets per second that's

148
00:05:46,080 --> 00:05:48,479
more than my network can handle when we

149
00:05:48,479 --> 00:05:51,060
see this we may think that oh no I

150
00:05:51,060 --> 00:05:52,680
cannot protect from DDOS I'm going to

151
00:05:52,680 --> 00:05:54,780
give up I cannot protect from the

152
00:05:54,780 --> 00:05:56,400
largest attack so I'm not going to do

153
00:05:56,400 --> 00:05:59,100
anything but actually I think that most

154
00:05:59,100 --> 00:06:01,440
companies could actually do a lot with

155
00:06:01,440 --> 00:06:03,479
the existing environment you already

156
00:06:03,479 --> 00:06:05,820
have there are some things that we can

157
00:06:05,820 --> 00:06:08,820
do to at least handle some of the low

158
00:06:08,820 --> 00:06:11,039
level attacks we can see what kinds of

159
00:06:11,039 --> 00:06:13,139
attacks we are receiving and then we can

160
00:06:13,139 --> 00:06:15,539
perhaps ask our Network providers our

161
00:06:15,539 --> 00:06:17,880
isps and some of them actually have

162
00:06:17,880 --> 00:06:21,780
methods for us to use and

163
00:06:21,780 --> 00:06:24,479
improve our network security by asking

164
00:06:24,479 --> 00:06:27,180
them to turn away traffic for a certain

165
00:06:27,180 --> 00:06:29,759
protocol turn away traffic for a certain

166
00:06:29,759 --> 00:06:33,120
IP address so in some cases you may ask

167
00:06:33,120 --> 00:06:34,280
them to

168
00:06:34,280 --> 00:06:37,199
disregard a specific IP black hole route

169
00:06:37,199 --> 00:06:40,020
a specific IP to help your existing

170
00:06:40,020 --> 00:06:42,180
Network and the rest of the addresses to

171
00:06:42,180 --> 00:06:44,160
keep them alive and keep their other

172
00:06:44,160 --> 00:06:46,560
services alive so there are a lot we can

173
00:06:46,560 --> 00:06:49,319
do even if these attacks are very very

174
00:06:49,319 --> 00:06:51,620
large

175
00:06:52,139 --> 00:06:54,300
for the purpose of security and network

176
00:06:54,300 --> 00:06:57,060
security we usually use firewalls and I

177
00:06:57,060 --> 00:06:58,500
guess that all of you in your

178
00:06:58,500 --> 00:07:00,180
professional context will have a

179
00:07:00,180 --> 00:07:01,800
firewall you will have a device that you

180
00:07:01,800 --> 00:07:03,900
call a fireball you may have a cluster

181
00:07:03,900 --> 00:07:06,600
you may have multiple firewalls but it

182
00:07:06,600 --> 00:07:09,660
is some kind of collection of components

183
00:07:09,660 --> 00:07:14,039
and I really love to point to different

184
00:07:14,039 --> 00:07:16,440
references that it's not just a single

185
00:07:16,440 --> 00:07:19,080
device it is some kind of device that

186
00:07:19,080 --> 00:07:21,840
can fill the traffic it can pass through

187
00:07:21,840 --> 00:07:24,120
the firewall if the base some kind of

188
00:07:24,120 --> 00:07:26,880
local security policy but if it does not

189
00:07:26,880 --> 00:07:29,460
match what is allowed in the firewall it

190
00:07:29,460 --> 00:07:31,560
will get turned away or it may get

191
00:07:31,560 --> 00:07:34,259
discarded thrown on the floor so when we

192
00:07:34,259 --> 00:07:36,479
have a packet coming in we match it

193
00:07:36,479 --> 00:07:39,000
towards a local policy if it matches and

194
00:07:39,000 --> 00:07:41,340
we allow it we will pass it on but if we

195
00:07:41,340 --> 00:07:43,620
do not allow it we will throw it away so

196
00:07:43,620 --> 00:07:45,419
that's what a firewall basically does

197
00:07:45,419 --> 00:07:47,880
and the most important parts is actually

198
00:07:47,880 --> 00:07:50,400
the parts that it is allowing so what is

199
00:07:50,400 --> 00:07:52,319
the firewall allowing that is the thing

200
00:07:52,319 --> 00:07:55,080
that I would suggest that you focus on

201
00:07:55,080 --> 00:07:57,720
also we would like to stress and we have

202
00:07:57,720 --> 00:07:59,759
all of these zero trust networks and

203
00:07:59,759 --> 00:08:02,699
stuff going around in the industry uh

204
00:08:02,699 --> 00:08:05,639
using the terms inside and outside may

205
00:08:05,639 --> 00:08:08,039
be a bit old and we cannot trust the

206
00:08:08,039 --> 00:08:09,960
inside we cannot trust the outside we

207
00:08:09,960 --> 00:08:12,599
cannot really trust anything today so we

208
00:08:12,599 --> 00:08:15,120
have to consider attacks from all

209
00:08:15,120 --> 00:08:18,539
sources inside and outside

210
00:08:18,539 --> 00:08:20,639
if we go to Wikipedia they have a very

211
00:08:20,639 --> 00:08:22,620
nice description saying it's a network

212
00:08:22,620 --> 00:08:25,080
security system so it's not a network

213
00:08:25,080 --> 00:08:27,419
security device that monitors and

214
00:08:27,419 --> 00:08:29,280
controls incoming and outgoing Network

215
00:08:29,280 --> 00:08:31,319
traffic based on predetermined security

216
00:08:31,319 --> 00:08:34,559
rules so that is a firewall and to me a

217
00:08:34,559 --> 00:08:36,839
firewall is definitely not a single

218
00:08:36,839 --> 00:08:39,000
device it's not a single pump in The

219
00:08:39,000 --> 00:08:42,899
Wire it's multiple devices

220
00:08:42,899 --> 00:08:45,600
looking at a firewall from a vendor they

221
00:08:45,600 --> 00:08:47,519
will have a device on the test which is

222
00:08:47,519 --> 00:08:49,740
in the middle up here it is a place

223
00:08:49,740 --> 00:08:51,600
where they can do stateful filtering

224
00:08:51,600 --> 00:08:53,700
they can do screening they can do IDs

225
00:08:53,700 --> 00:08:56,700
IDP IDP they can do various Security

226
00:08:56,700 --> 00:08:58,920
Services antivirus TLS inspection

227
00:08:58,920 --> 00:09:01,620
everything antivirus everything they can

228
00:09:01,620 --> 00:09:03,779
do it in a single device and they will

229
00:09:03,779 --> 00:09:05,580
optimize their device using a testing

230
00:09:05,580 --> 00:09:07,080
device some kind of traffic generator

231
00:09:07,080 --> 00:09:09,660
they will optimize the device for the

232
00:09:09,660 --> 00:09:11,399
common use case

233
00:09:11,399 --> 00:09:14,640
the common use case being TCP UDP stuff

234
00:09:14,640 --> 00:09:15,959
like that is allowed through the

235
00:09:15,959 --> 00:09:18,300
firewall they would like it to run full

236
00:09:18,300 --> 00:09:20,279
wire speed so if it's a 10 gigabit

237
00:09:20,279 --> 00:09:22,680
network card in the firewall it should

238
00:09:22,680 --> 00:09:24,540
be able to pass 10 gigabits of network

239
00:09:24,540 --> 00:09:27,899
traffic but can you really do all of

240
00:09:27,899 --> 00:09:29,760
this in a single box

241
00:09:29,760 --> 00:09:31,980
does it make sense to do all of this in

242
00:09:31,980 --> 00:09:34,620
a single box it will become more complex

243
00:09:34,620 --> 00:09:37,380
it will require more resources and I

244
00:09:37,380 --> 00:09:39,240
really don't enjoy putting too much

245
00:09:39,240 --> 00:09:41,940
stress on the firewalls especially since

246
00:09:41,940 --> 00:09:45,180
they are sometimes using older CPUs

247
00:09:45,180 --> 00:09:47,700
they're using older software they have

248
00:09:47,700 --> 00:09:49,680
firmware which is updated as a single

249
00:09:49,680 --> 00:09:52,740
file so if there's a bug in one part and

250
00:09:52,740 --> 00:09:56,220
you need to update you wish you may

251
00:09:56,220 --> 00:09:58,140
experience that you have problems in

252
00:09:58,140 --> 00:09:59,700
another part another feature in the

253
00:09:59,700 --> 00:10:01,380
firewall that starts to act in another

254
00:10:01,380 --> 00:10:03,000
way needs to be configured in another

255
00:10:03,000 --> 00:10:05,519
way or maybe some features going away in

256
00:10:05,519 --> 00:10:07,260
the new firmware so there's a lot of

257
00:10:07,260 --> 00:10:09,120
problems by having a single device

258
00:10:09,120 --> 00:10:11,760
firewall

259
00:10:11,760 --> 00:10:14,580
foreign looking at a firewall in the

260
00:10:14,580 --> 00:10:16,980
Enterprise mindset we usually have a

261
00:10:16,980 --> 00:10:18,540
firewall connecting us to the Internet

262
00:10:18,540 --> 00:10:20,820
so we will have the internet being our

263
00:10:20,820 --> 00:10:23,519
traffic generator it's not everything

264
00:10:23,519 --> 00:10:25,680
that we want to have generated that is

265
00:10:25,680 --> 00:10:27,420
coming to our network but we see a lot

266
00:10:27,420 --> 00:10:29,880
of traffic coming we also have a secure

267
00:10:29,880 --> 00:10:31,860
land some people may consider their

268
00:10:31,860 --> 00:10:34,500
inside a secure Lane but it may be a

269
00:10:34,500 --> 00:10:37,380
huge network with lots of devices and

270
00:10:37,380 --> 00:10:38,880
usually you don't even know what you

271
00:10:38,880 --> 00:10:41,100
have on the inside and then you may have

272
00:10:41,100 --> 00:10:43,680
some monitoring on your devices and I

273
00:10:43,680 --> 00:10:44,940
highly suggest that you do more

274
00:10:44,940 --> 00:10:47,519
monitoring in your networks because then

275
00:10:47,519 --> 00:10:48,839
you will know more about the traffic

276
00:10:48,839 --> 00:10:51,060
flows that you should allow the traffic

277
00:10:51,060 --> 00:10:53,880
flows that earn you money that are being

278
00:10:53,880 --> 00:10:56,160
used for services in production so your

279
00:10:56,160 --> 00:10:58,140
infrastructure is based on multiple

280
00:10:58,140 --> 00:11:00,720
components and devices in front of the

281
00:11:00,720 --> 00:11:02,760
firewall we have something behind the

282
00:11:02,760 --> 00:11:05,220
firewall we have something and that is

283
00:11:05,220 --> 00:11:07,560
something we need to secure and we use

284
00:11:07,560 --> 00:11:09,600
the term defense in depth and I really

285
00:11:09,600 --> 00:11:12,060
enjoy looking at all the devices looking

286
00:11:12,060 --> 00:11:14,040
at all the components and you should try

287
00:11:14,040 --> 00:11:16,800
to secure everything so looking at a

288
00:11:16,800 --> 00:11:19,079
Network drawing like this one it's not

289
00:11:19,079 --> 00:11:22,200
the as a specific customer it's intended

290
00:11:22,200 --> 00:11:24,600
as a generic Network drawing of all the

291
00:11:24,600 --> 00:11:26,579
devices that we have from the internet

292
00:11:26,579 --> 00:11:28,800
going all the way to the servers at the

293
00:11:28,800 --> 00:11:30,540
bottom so we have lots of different

294
00:11:30,540 --> 00:11:33,660
devices on the traffic flow way on the

295
00:11:33,660 --> 00:11:36,000
route from the internet and then we have

296
00:11:36,000 --> 00:11:37,920
all of these attacks from the internet

297
00:11:37,920 --> 00:11:40,260
we have low level attacks we have high

298
00:11:40,260 --> 00:11:42,300
level attacks and we want to protect

299
00:11:42,300 --> 00:11:44,579
everything without losing functionality

300
00:11:44,579 --> 00:11:46,200
and we don't want to have an

301
00:11:46,200 --> 00:11:48,480
administrative nightmare so that's the

302
00:11:48,480 --> 00:11:50,880
next part we also must consider when we

303
00:11:50,880 --> 00:11:53,839
start going into this later on

304
00:11:53,839 --> 00:11:57,180
what I am talking about when I say DDOS

305
00:11:57,180 --> 00:11:59,160
and especially for this presentation I'm

306
00:11:59,160 --> 00:12:02,459
talking about various attacks that use

307
00:12:02,459 --> 00:12:05,579
up some resource so it's using up some

308
00:12:05,579 --> 00:12:09,000
memory space interrupt processing CPU

309
00:12:09,000 --> 00:12:13,140
processing bandwidth TCP State firewall

310
00:12:13,140 --> 00:12:14,940
state number of concurrent sessions

311
00:12:14,940 --> 00:12:18,000
anything that can use up a resource is a

312
00:12:18,000 --> 00:12:19,980
denial of service when we talk about a

313
00:12:19,980 --> 00:12:21,899
distributed denial of services or

314
00:12:21,899 --> 00:12:24,480
multiple sources on the internet but in

315
00:12:24,480 --> 00:12:26,640
this case in our structure testing we

316
00:12:26,640 --> 00:12:29,279
use a single device usually to produce

317
00:12:29,279 --> 00:12:31,320
this traffic and of course we can start

318
00:12:31,320 --> 00:12:33,240
spoofing lots of sources so it would

319
00:12:33,240 --> 00:12:35,579
look like a real distributed denial of

320
00:12:35,579 --> 00:12:37,440
service but a denial of service is

321
00:12:37,440 --> 00:12:39,839
anything that uses of resource and

322
00:12:39,839 --> 00:12:42,839
resources are limited they are always

323
00:12:42,839 --> 00:12:45,300
limited there will be bottlenecks in

324
00:12:45,300 --> 00:12:48,060
your network and the goal is to

325
00:12:48,060 --> 00:12:50,279
configure your systems so you have as

326
00:12:50,279 --> 00:12:52,680
few bottlenecks and they are as high as

327
00:12:52,680 --> 00:12:55,139
possible so or you can produce a lot of

328
00:12:55,139 --> 00:12:57,060
production traffic looking at the

329
00:12:57,060 --> 00:12:58,800
firewalls just quickly

330
00:12:58,800 --> 00:13:01,200
this is the traffic processing on an SRX

331
00:13:01,200 --> 00:13:03,420
series from junipa it's just an example

332
00:13:03,420 --> 00:13:06,420
of a network device that you can buy it

333
00:13:06,420 --> 00:13:08,760
has this per package stuff that happens

334
00:13:08,760 --> 00:13:11,040
on the left then it matches the session

335
00:13:11,040 --> 00:13:13,380
usually we do stateful filtering then it

336
00:13:13,380 --> 00:13:16,139
goes to the small the flow on the right

337
00:13:16,139 --> 00:13:19,019
bottom or it goes through the long one

338
00:13:19,019 --> 00:13:21,360
at the top where it goes through a lot

339
00:13:21,360 --> 00:13:23,700
of different steps so this is what

340
00:13:23,700 --> 00:13:26,880
happens for each packet received on an

341
00:13:26,880 --> 00:13:29,220
SRX firewall and as you can see there's

342
00:13:29,220 --> 00:13:30,899
lots of different parts and I'm not

343
00:13:30,899 --> 00:13:33,420
going to go into details but this is

344
00:13:33,420 --> 00:13:36,240
what must happen for each packet going

345
00:13:36,240 --> 00:13:39,240
in going through going out of this type

346
00:13:39,240 --> 00:13:41,459
of firewall and you could find similar

347
00:13:41,459 --> 00:13:43,560
ones from the other firewall vendors

348
00:13:43,560 --> 00:13:45,720
this is just what I happen to use you

349
00:13:45,720 --> 00:13:49,079
usually so I know this one better

350
00:13:49,079 --> 00:13:51,899
looking at these firewalls we also know

351
00:13:51,899 --> 00:13:53,399
that they usually have a control plane

352
00:13:53,399 --> 00:13:55,620
and a data plane they will typically in

353
00:13:55,620 --> 00:13:57,420
the higher speed versions have some

354
00:13:57,420 --> 00:14:00,000
Hardware supporting the usual and the

355
00:14:00,000 --> 00:14:02,639
common case so the data plane will be

356
00:14:02,639 --> 00:14:04,980
Hardware which is designed and optimized

357
00:14:04,980 --> 00:14:06,720
for some use case

358
00:14:06,720 --> 00:14:09,540
then we will have a control plane which

359
00:14:09,540 --> 00:14:11,519
will be the configuration stuff you will

360
00:14:11,519 --> 00:14:13,320
log into the control plane you will

361
00:14:13,320 --> 00:14:14,820
change the configuration you will push

362
00:14:14,820 --> 00:14:17,760
these changes into the fpgas into the

363
00:14:17,760 --> 00:14:19,500
networking chips the routing chips

364
00:14:19,500 --> 00:14:21,420
everything that goes on in the data

365
00:14:21,420 --> 00:14:24,060
plane if something happens to go all the

366
00:14:24,060 --> 00:14:26,940
way up to the control plane it will be

367
00:14:26,940 --> 00:14:29,760
handled by a CPU process so that will be

368
00:14:29,760 --> 00:14:32,820
limited in what the CPU can do whereas

369
00:14:32,820 --> 00:14:35,399
the data plane usually will do things in

370
00:14:35,399 --> 00:14:37,260
hardware and actually can perform a lot

371
00:14:37,260 --> 00:14:39,420
of stuff in Hardware in modern devices

372
00:14:39,420 --> 00:14:41,579
even the ones that I buy for my company

373
00:14:41,579 --> 00:14:43,860
which are the smallest devices mostly

374
00:14:43,860 --> 00:14:47,220
for 10 gigabit gigabit routing typically

375
00:14:47,220 --> 00:14:49,260
also when we have a network we will have

376
00:14:49,260 --> 00:14:50,579
what is called a link in it and a

377
00:14:50,579 --> 00:14:53,160
hosting Network so we will have the

378
00:14:53,160 --> 00:14:55,500
services that you published to the

379
00:14:55,500 --> 00:14:57,120
internet on the production Network the

380
00:14:57,120 --> 00:14:59,699
hosting Network in my case and then it

381
00:14:59,699 --> 00:15:01,260
will have a link net connecting the

382
00:15:01,260 --> 00:15:04,019
devices this linknet could also get

383
00:15:04,019 --> 00:15:06,060
attacked so I

384
00:15:06,060 --> 00:15:08,339
recommend that you do Port scanning and

385
00:15:08,339 --> 00:15:10,260
Discovery and testing on these devices

386
00:15:10,260 --> 00:15:12,779
too typically they would be a very small

387
00:15:12,779 --> 00:15:16,320
Network like a slash 28 26 and then the

388
00:15:16,320 --> 00:15:17,760
hosting Network where you have your

389
00:15:17,760 --> 00:15:20,820
services will be as less 24 or slash 22

390
00:15:20,820 --> 00:15:22,800
000 addresses if you have them and then

391
00:15:22,800 --> 00:15:25,860
we have the similar ones in IPv6 and it

392
00:15:25,860 --> 00:15:27,300
is recommended to have a small link

393
00:15:27,300 --> 00:15:29,100
Network and then you would probably have

394
00:15:29,100 --> 00:15:31,980
a slash 48 for IPv6 for the hosting

395
00:15:31,980 --> 00:15:34,260
parts and you can get that from Ripe you

396
00:15:34,260 --> 00:15:35,880
can get provider independent addresses

397
00:15:35,880 --> 00:15:38,880
so you can move them between isps and

398
00:15:38,880 --> 00:15:40,980
you can have multiple isps and I

399
00:15:40,980 --> 00:15:43,800
recommend that you get IPv6 provider

400
00:15:43,800 --> 00:15:46,019
independent Pi addresses immediately

401
00:15:46,019 --> 00:15:49,139
start applying for that through a li

402
00:15:49,139 --> 00:15:51,779
local internet registry

403
00:15:51,779 --> 00:15:53,760
since you are security people at this

404
00:15:53,760 --> 00:15:56,040
conference I guess you know in map the

405
00:15:56,040 --> 00:15:58,320
port scanner so I'm going to go through

406
00:15:58,320 --> 00:16:00,480
very quickly the parts that I recommend

407
00:16:00,480 --> 00:16:03,240
you do before the testing you will use a

408
00:16:03,240 --> 00:16:05,160
port scanner and that will show which

409
00:16:05,160 --> 00:16:07,139
ports are open the ports that are open

410
00:16:07,139 --> 00:16:08,940
are of course the ones that we want to

411
00:16:08,940 --> 00:16:11,399
check these are the

412
00:16:11,399 --> 00:16:13,560
ones that will create state in the

413
00:16:13,560 --> 00:16:16,519
devices all the way to the servers

414
00:16:16,519 --> 00:16:18,959
you would in the best case have

415
00:16:18,959 --> 00:16:20,820
something that you can ping and then you

416
00:16:20,820 --> 00:16:22,920
would have a CCP port and then a UDP

417
00:16:22,920 --> 00:16:24,959
Port some kind of service that runs on

418
00:16:24,959 --> 00:16:27,360
TCP some kind of service that runs on

419
00:16:27,360 --> 00:16:29,940
UDP so that would be the Baseline for

420
00:16:29,940 --> 00:16:32,220
doing this testing and then I would

421
00:16:32,220 --> 00:16:34,560
recommend doing some monitoring make

422
00:16:34,560 --> 00:16:36,420
sure that you have nice green graphs

423
00:16:36,420 --> 00:16:38,519
showing that there are no service

424
00:16:38,519 --> 00:16:39,779
problems

425
00:16:39,779 --> 00:16:42,300
everything is green everything is ready

426
00:16:42,300 --> 00:16:44,339
for the testing if you have an unstable

427
00:16:44,339 --> 00:16:47,160
service it's not nice to test but if you

428
00:16:47,160 --> 00:16:50,040
have a green all the way 100 uptime for

429
00:16:50,040 --> 00:16:52,079
the last week and you start attacking

430
00:16:52,079 --> 00:16:54,300
and you see that this breaks then you

431
00:16:54,300 --> 00:16:56,519
know that it was the testing that made

432
00:16:56,519 --> 00:16:58,320
it break

433
00:16:58,320 --> 00:17:01,139
I usually use nmap to do the port scan

434
00:17:01,139 --> 00:17:02,880
and then afterwards when I have found

435
00:17:02,880 --> 00:17:04,740
these services to attack I will use the

436
00:17:04,740 --> 00:17:07,740
tools like hping 3 and t50 in penguin

437
00:17:07,740 --> 00:17:10,439
ping and penguin ping is my own script

438
00:17:10,439 --> 00:17:12,900
which is a small add-on which I have

439
00:17:12,900 --> 00:17:14,819
released for this conference because I

440
00:17:14,819 --> 00:17:16,859
was going here I put it public on my

441
00:17:16,859 --> 00:17:19,380
GitHub I put the web page up with some

442
00:17:19,380 --> 00:17:23,339
text and descriptions and hp3 to 50 are

443
00:17:23,339 --> 00:17:25,380
on clearly already and you can very

444
00:17:25,380 --> 00:17:29,520
quickly and easily install DP DK data

445
00:17:29,520 --> 00:17:31,140
plane development kit from insole

446
00:17:31,140 --> 00:17:33,240
originally but it's now open source and

447
00:17:33,240 --> 00:17:34,919
then you could run penguin Ping On Top

448
00:17:34,919 --> 00:17:38,580
of a Kaylee or a Debian

449
00:17:38,580 --> 00:17:41,100
then using these tools I would go

450
00:17:41,100 --> 00:17:43,020
through all the scenarios that I usually

451
00:17:43,020 --> 00:17:45,660
see on the internet being DDOS attacks

452
00:17:45,660 --> 00:17:48,000
so that would be sun floating it would

453
00:17:48,000 --> 00:17:50,400
be UDP flooding icmp flooding all of

454
00:17:50,400 --> 00:17:51,960
these flooding attacks I would go

455
00:17:51,960 --> 00:17:53,700
through all the scenarios I would

456
00:17:53,700 --> 00:17:55,940
register all the changes to the devices

457
00:17:55,940 --> 00:17:59,160
in the network and I would expect things

458
00:17:59,160 --> 00:18:01,320
to break and usually when we do this

459
00:18:01,320 --> 00:18:03,539
breakage it will be different scenarios

460
00:18:03,539 --> 00:18:05,460
breaking in different networks depending

461
00:18:05,460 --> 00:18:07,380
on the devices and their configuration

462
00:18:07,380 --> 00:18:10,740
but afterwards we will investigate and

463
00:18:10,740 --> 00:18:11,880
that's not part of the presentation

464
00:18:11,880 --> 00:18:14,580
today but you should investigate is this

465
00:18:14,580 --> 00:18:16,260
scenario something that could hurt our

466
00:18:16,260 --> 00:18:18,299
network is it something we can turn away

467
00:18:18,299 --> 00:18:20,880
so it doesn't affect our network if

468
00:18:20,880 --> 00:18:23,400
somebody tried to attack it and usually

469
00:18:23,400 --> 00:18:27,120
you will be able to remove at least some

470
00:18:27,120 --> 00:18:29,460
of these use cases without losing

471
00:18:29,460 --> 00:18:31,320
functionality

472
00:18:31,320 --> 00:18:33,419
the problem with all these tools the

473
00:18:33,419 --> 00:18:36,299
nmap hping t50 is that they have a lot

474
00:18:36,299 --> 00:18:38,880
of options so which options should you

475
00:18:38,880 --> 00:18:42,360
use for these testing structure testing

476
00:18:42,360 --> 00:18:45,419
a small hint I usually save the IP

477
00:18:45,419 --> 00:18:47,760
addresses in a variable on the shell so

478
00:18:47,760 --> 00:18:50,100
if I'm on a command line I usually do

479
00:18:50,100 --> 00:18:51,960
this from the command line I will save

480
00:18:51,960 --> 00:18:54,059
the IP addresses in a variable because

481
00:18:54,059 --> 00:18:56,340
then if I mistype the variable nothing

482
00:18:56,340 --> 00:18:58,799
bad happens if you type the IP address

483
00:18:58,799 --> 00:19:00,419
in the middle of the night and you

484
00:19:00,419 --> 00:19:02,760
mistype an IP address you are performing

485
00:19:02,760 --> 00:19:06,059
a DDOS on somebody else so better save

486
00:19:06,059 --> 00:19:08,280
the IP addresses as a variable and then

487
00:19:08,280 --> 00:19:10,620
you can use this in your nmap command

488
00:19:10,620 --> 00:19:13,140
and you can use it later on in the hping

489
00:19:13,140 --> 00:19:16,799
3 and t50 and so on so a small hint to

490
00:19:16,799 --> 00:19:18,240
avoid attacking other people on the

491
00:19:18,240 --> 00:19:20,039
internet we don't want to do this I want

492
00:19:20,039 --> 00:19:22,260
you to use this for good stuff

493
00:19:22,260 --> 00:19:24,419
then I also have a small other hint

494
00:19:24,419 --> 00:19:27,960
which is to add the last line where we

495
00:19:27,960 --> 00:19:30,960
have the date so having a date separated

496
00:19:30,960 --> 00:19:33,559
with

497
00:19:35,700 --> 00:19:38,100
the H ping command and then using the

498
00:19:38,100 --> 00:19:40,440
time in front of the H ping that will

499
00:19:40,440 --> 00:19:42,900
make sure that if you do a lock of all

500
00:19:42,900 --> 00:19:44,820
the commands during the night you will

501
00:19:44,820 --> 00:19:47,640
have ping3 with a Ctrl C it will see how

502
00:19:47,640 --> 00:19:50,100
many minutes how many seconds you ran

503
00:19:50,100 --> 00:19:53,280
the command so doing a complete log of

504
00:19:53,280 --> 00:19:55,559
your command line and have date time

505
00:19:55,559 --> 00:19:57,900
stamped when you started an attack and

506
00:19:57,900 --> 00:20:00,120
for how long you ran an attack and you

507
00:20:00,120 --> 00:20:01,740
can match that up with your locks

508
00:20:01,740 --> 00:20:03,780
afterwards making sure that your locks

509
00:20:03,780 --> 00:20:05,880
are of course timestamped two with the

510
00:20:05,880 --> 00:20:08,480
correct time

511
00:20:08,700 --> 00:20:11,280
my goal when I do this nmap is to

512
00:20:11,280 --> 00:20:12,960
enumerate all the ports that are allowed

513
00:20:12,960 --> 00:20:14,700
through the network I will save all

514
00:20:14,700 --> 00:20:16,799
these files I will output it into an

515
00:20:16,799 --> 00:20:20,580
ipv4 IPv6 I will making sure that I can

516
00:20:20,580 --> 00:20:22,679
find something to attack doing the port

517
00:20:22,679 --> 00:20:25,559
scan part should not break anything if

518
00:20:25,559 --> 00:20:27,179
you have stopped that stuff that breaks

519
00:20:27,179 --> 00:20:29,820
and dies then it is vulnerable to normal

520
00:20:29,820 --> 00:20:31,620
traffic so that would be something to

521
00:20:31,620 --> 00:20:34,140
fix first that's really bad if something

522
00:20:34,140 --> 00:20:37,320
breaks because of an end map

523
00:20:37,320 --> 00:20:41,100
also to some operating system detection

524
00:20:41,100 --> 00:20:43,620
I would also like to do service scanning

525
00:20:43,620 --> 00:20:45,720
and one of the services that I usually

526
00:20:45,720 --> 00:20:47,820
find on the customer routers the ones

527
00:20:47,820 --> 00:20:51,780
from the isps is the SNMP protocol which

528
00:20:51,780 --> 00:20:54,179
allows me sometimes to see that a router

529
00:20:54,179 --> 00:20:56,580
in a customer network has been up for

530
00:20:56,580 --> 00:20:58,919
more than 700 days

531
00:20:58,919 --> 00:21:01,440
so if a device has been up for more than

532
00:21:01,440 --> 00:21:04,500
700 days what is the firmware is that a

533
00:21:04,500 --> 00:21:07,140
recent firmware on that device or is it

534
00:21:07,140 --> 00:21:09,480
definitely going to have some bugs and

535
00:21:09,480 --> 00:21:12,179
definitely there is some box in this

536
00:21:12,179 --> 00:21:14,220
case it's a Cisco device and a Cisco

537
00:21:14,220 --> 00:21:16,020
device that hasn't been updated for two

538
00:21:16,020 --> 00:21:18,419
years or more is definitely vulnerable

539
00:21:18,419 --> 00:21:21,299
to something so that's also things that

540
00:21:21,299 --> 00:21:23,640
come out of this testing when you start

541
00:21:23,640 --> 00:21:25,679
to investigate your network you will see

542
00:21:25,679 --> 00:21:28,220
different things that you can also fix

543
00:21:28,220 --> 00:21:31,200
before doing the DDOS testing and before

544
00:21:31,200 --> 00:21:33,780
somebody attacks your network

545
00:21:33,780 --> 00:21:35,940
then moving on to these packet

546
00:21:35,940 --> 00:21:38,880
generators this hping 3 is very flexible

547
00:21:38,880 --> 00:21:42,720
it's very nice it can increase and

548
00:21:42,720 --> 00:21:44,640
decrease the speed which is very

549
00:21:44,640 --> 00:21:46,440
important when you start to see things

550
00:21:46,440 --> 00:21:48,419
breaking because you want to know what

551
00:21:48,419 --> 00:21:51,299
broke which device broke so you don't

552
00:21:51,299 --> 00:21:52,919
want to run it with full 10 gigabit

553
00:21:52,919 --> 00:21:54,960
network speed you want to run it perhaps

554
00:21:54,960 --> 00:21:58,200
with one gigabit 2 gigabit see where it

555
00:21:58,200 --> 00:22:00,720
breaks Run 1 million of package per

556
00:22:00,720 --> 00:22:02,940
second run two millions of packets per

557
00:22:02,940 --> 00:22:05,039
second and see when stuff starts to

558
00:22:05,039 --> 00:22:07,620
break and sometimes when we run these we

559
00:22:07,620 --> 00:22:09,780
also monitor the devices and see if the

560
00:22:09,780 --> 00:22:13,440
CPU load goes to 50 if we load it with 1

561
00:22:13,440 --> 00:22:15,480
million packets per second then would it

562
00:22:15,480 --> 00:22:17,159
break if we put it down to 2 million

563
00:22:17,159 --> 00:22:19,320
probably and when we put it on 2 million

564
00:22:19,320 --> 00:22:22,020
we see go close to 100 and then we know

565
00:22:22,020 --> 00:22:25,260
kind of the rate of attack which will

566
00:22:25,260 --> 00:22:27,600
break this network these devices these

567
00:22:27,600 --> 00:22:30,419
specific devices so hp3 is a very nice

568
00:22:30,419 --> 00:22:33,059
tool and usually you can produce a

569
00:22:33,059 --> 00:22:35,039
million package second from a single

570
00:22:35,039 --> 00:22:36,659
process and you can run multiple process

571
00:22:36,659 --> 00:22:38,940
on your Kaylee Linux usually our

572
00:22:38,940 --> 00:22:40,980
machines today have multiple CPU cores

573
00:22:40,980 --> 00:22:44,220
so hp3 is a nice tool has a lot of

574
00:22:44,220 --> 00:22:46,919
different options the one called t50 has

575
00:22:46,919 --> 00:22:48,480
the same options and can produce the

576
00:22:48,480 --> 00:22:50,580
same attacks but it also have a

577
00:22:50,580 --> 00:22:54,179
specialized protocol t50 option which is

578
00:22:54,179 --> 00:22:56,400
very nasty because it then it starts to

579
00:22:56,400 --> 00:23:00,179
send all protocols sequentially so a

580
00:23:00,179 --> 00:23:03,240
firewall that is optimized for TCP UDP

581
00:23:03,240 --> 00:23:06,179
icmp receiving all sorts of protocols

582
00:23:06,179 --> 00:23:08,580
all sorts of traffic makes it go into

583
00:23:08,580 --> 00:23:10,679
all of these cases and special cases

584
00:23:10,679 --> 00:23:13,679
putting some of the load into the CPU is

585
00:23:13,679 --> 00:23:15,840
really really bad I can tell you that

586
00:23:15,840 --> 00:23:18,240
when I start using this command usually

587
00:23:18,240 --> 00:23:20,159
the firewall will start to break and

588
00:23:20,159 --> 00:23:22,380
will get overloaded especially if you do

589
00:23:22,380 --> 00:23:24,539
it at a high speed in millions of

590
00:23:24,539 --> 00:23:26,460
packets per second

591
00:23:26,460 --> 00:23:28,679
then we have the penguin pink packet

592
00:23:28,679 --> 00:23:31,380
generator I found a library called lip

593
00:23:31,380 --> 00:23:33,179
Moon which is part of moon gen which is

594
00:23:33,179 --> 00:23:35,880
a packet generator based on the dpdk

595
00:23:35,880 --> 00:23:38,220
from Intel originally it's now open

596
00:23:38,220 --> 00:23:42,000
source using this tool I can write Lewis

597
00:23:42,000 --> 00:23:44,940
scripts and these Lewis scripts allow me

598
00:23:44,940 --> 00:23:49,080
to re-implement in about 230 lines of

599
00:23:49,080 --> 00:23:53,700
lure code the same options s h ping3 the

600
00:23:53,700 --> 00:23:56,159
difference is where a single process

601
00:23:56,159 --> 00:23:57,780
could run like a million packets per

602
00:23:57,780 --> 00:24:01,320
second a single CPU core with this tool

603
00:24:01,320 --> 00:24:03,799
using Moon gen can produce

604
00:24:03,799 --> 00:24:06,840
14.8 million package per second which is

605
00:24:06,840 --> 00:24:09,659
the full 10 G wire speed from a single

606
00:24:09,659 --> 00:24:12,299
CPU core on a small device with a cheap

607
00:24:12,299 --> 00:24:14,340
network card so that's really really

608
00:24:14,340 --> 00:24:16,860
fast and it also has a nice option minus

609
00:24:16,860 --> 00:24:21,240
r so we can ask how much to generate

610
00:24:21,240 --> 00:24:24,120
so the process using these tools would

611
00:24:24,120 --> 00:24:26,880
be to monitor the network attack break

612
00:24:26,880 --> 00:24:29,580
and repeat so we would start out small

613
00:24:29,580 --> 00:24:32,280
with small attacks see how the network

614
00:24:32,280 --> 00:24:35,220
reacts see how far the packets get into

615
00:24:35,220 --> 00:24:37,740
the network they pass the first router

616
00:24:37,740 --> 00:24:40,740
from the ISP they hit the firewall the

617
00:24:40,740 --> 00:24:43,080
firewall will get loaded a bit we will

618
00:24:43,080 --> 00:24:45,299
see how it handles different kinds of

619
00:24:45,299 --> 00:24:47,400
traffic and then usually it will start

620
00:24:47,400 --> 00:24:50,039
to break at some point and I advise you

621
00:24:50,039 --> 00:24:52,140
to go through all of these scenarios

622
00:24:52,140 --> 00:24:55,260
first do not make changes during the

623
00:24:55,260 --> 00:24:57,480
testing because you may optimize for one

624
00:24:57,480 --> 00:24:59,220
use case and then later on for another

625
00:24:59,220 --> 00:25:01,260
use case which may affect the previous

626
00:25:01,260 --> 00:25:04,200
use cases so better to go through all of

627
00:25:04,200 --> 00:25:06,419
the scenarios mark down the ones that

628
00:25:06,419 --> 00:25:09,120
failed try to fix those and then do a

629
00:25:09,120 --> 00:25:11,400
retest on another night and usually I do

630
00:25:11,400 --> 00:25:13,500
it during night to avoid production

631
00:25:13,500 --> 00:25:15,659
issues

632
00:25:15,659 --> 00:25:18,419
this is the command to run the hping 3

633
00:25:18,419 --> 00:25:21,059
as you can see I have exported the

634
00:25:21,059 --> 00:25:23,640
custom IP as a variable so I can use it

635
00:25:23,640 --> 00:25:26,220
further down in the tools I am using the

636
00:25:26,220 --> 00:25:28,980
date command to get the nice timestamp I

637
00:25:28,980 --> 00:25:31,320
have the time command which summarizes

638
00:25:31,320 --> 00:25:33,960
the time I only ran this attack for one

639
00:25:33,960 --> 00:25:35,640
minute and seven seconds I was very

640
00:25:35,640 --> 00:25:37,559
impatient that day just trying to

641
00:25:37,559 --> 00:25:39,120
produce some output for this

642
00:25:39,120 --> 00:25:41,460
presentation and this is the way that I

643
00:25:41,460 --> 00:25:43,679
start out by doing a soon attack soon

644
00:25:43,679 --> 00:25:46,500
floating attack on Port 80 which is of

645
00:25:46,500 --> 00:25:48,480
course one of the common ports so Port

646
00:25:48,480 --> 00:25:52,500
80 HTTP would be a common CCP port to

647
00:25:52,500 --> 00:25:54,960
attack and this is very nice because you

648
00:25:54,960 --> 00:25:57,360
can run this multiple times at the end

649
00:25:57,360 --> 00:25:59,100
of this command up here we have the

650
00:25:59,100 --> 00:26:01,140
Ampersand which means this runs in the

651
00:26:01,140 --> 00:26:03,779
background so I can just use my arrow up

652
00:26:03,779 --> 00:26:06,059
and enter Arrow up and enter Arrow up

653
00:26:06,059 --> 00:26:09,240
and enter and start perhaps five or four

654
00:26:09,240 --> 00:26:12,179
six seven even perhaps eight if I have a

655
00:26:12,179 --> 00:26:15,240
new CPU so I can put a lot of load on

656
00:26:15,240 --> 00:26:17,039
the network work and it's very flexible

657
00:26:17,039 --> 00:26:19,440
it can do just about anything you can

658
00:26:19,440 --> 00:26:22,080
control any part of the packet using the

659
00:26:22,080 --> 00:26:24,779
HP 3 tool

660
00:26:24,779 --> 00:26:27,240
my recommendation is to run each test

661
00:26:27,240 --> 00:26:29,159
for at least five minutes or even 15

662
00:26:29,159 --> 00:26:31,919
minutes A lot of these attacks require

663
00:26:31,919 --> 00:26:34,620
some build up if you have a timeout in a

664
00:26:34,620 --> 00:26:37,260
firewall for instance a juniper SRX at

665
00:26:37,260 --> 00:26:38,539
one point at

666
00:26:38,539 --> 00:26:42,600
1800 seconds timeout for UDP sessions so

667
00:26:42,600 --> 00:26:44,760
if you creating a UDP session it would

668
00:26:44,760 --> 00:26:47,159
take 1800 seconds without any traffic

669
00:26:47,159 --> 00:26:50,100
for it to time out so if we ran a short

670
00:26:50,100 --> 00:26:51,960
attack it might be able to handle the

671
00:26:51,960 --> 00:26:54,179
burst but if we wait for some more time

672
00:26:54,179 --> 00:26:57,419
it may be that this table of UDP

673
00:26:57,419 --> 00:26:59,640
sessions ran out of space and then it

674
00:26:59,640 --> 00:27:01,980
would not be able to accept any more UDP

675
00:27:01,980 --> 00:27:05,279
sessions on that device so this is why I

676
00:27:05,279 --> 00:27:07,919
run this for up to 15 minutes if we

677
00:27:07,919 --> 00:27:09,779
don't have any change that's nice then

678
00:27:09,779 --> 00:27:13,620
it's a pass but any changing response is

679
00:27:13,620 --> 00:27:15,840
a result so if you have a higher latency

680
00:27:15,840 --> 00:27:19,679
stuff answers slower if you have probes

681
00:27:19,679 --> 00:27:22,500
that are lost that's a result if you

682
00:27:22,500 --> 00:27:24,840
have lots of connectivity to the device

683
00:27:24,840 --> 00:27:27,179
that's a result and sometimes you have

684
00:27:27,179 --> 00:27:29,340
to monitor all the devices to see if

685
00:27:29,340 --> 00:27:31,320
there's a change if there's a change

686
00:27:31,320 --> 00:27:33,659
then I recommend that you stop the

687
00:27:33,659 --> 00:27:35,820
attack see everything go green and then

688
00:27:35,820 --> 00:27:38,460
retest using the same parameters to see

689
00:27:38,460 --> 00:27:40,679
if it really is this attack that breaks

690
00:27:40,679 --> 00:27:42,320
it and then you can confirm

691
00:27:42,320 --> 00:27:44,700
approximately the level where it breaks

692
00:27:44,700 --> 00:27:46,679
and you can try to turn it up a bit turn

693
00:27:46,679 --> 00:27:49,020
it down a bit see where the approximate

694
00:27:49,020 --> 00:27:51,360
level is and that becomes important

695
00:27:51,360 --> 00:27:53,039
because after you have tried to make

696
00:27:53,039 --> 00:27:55,919
changes then you can perhaps run with a

697
00:27:55,919 --> 00:27:58,140
much higher level so we have seen in

698
00:27:58,140 --> 00:28:00,419
some use cases and some scenarios that

699
00:28:00,419 --> 00:28:03,720
we have improved the the level several

700
00:28:03,720 --> 00:28:05,880
hundred percent at one point I had a

701
00:28:05,880 --> 00:28:07,919
firewall at a customer it was vulnerable

702
00:28:07,919 --> 00:28:11,760
to 50 000 packets per second 50 000

703
00:28:11,760 --> 00:28:13,380
packets per second is something that I

704
00:28:13,380 --> 00:28:15,659
could probably produce on my phone using

705
00:28:15,659 --> 00:28:18,299
14 networks so it's a very small attack

706
00:28:18,299 --> 00:28:20,820
size and afterwards they could handle

707
00:28:20,820 --> 00:28:22,980
millions of packets per second with the

708
00:28:22,980 --> 00:28:24,779
same scenario so it becomes important

709
00:28:24,779 --> 00:28:26,460
important when you want to demonstrate

710
00:28:26,460 --> 00:28:30,260
that you have improved your environment

711
00:28:31,700 --> 00:28:34,220
yes I think I have said everything here

712
00:28:34,220 --> 00:28:36,720
these are the basic tests that I

713
00:28:36,720 --> 00:28:38,820
recommend that you do they are

714
00:28:38,820 --> 00:28:40,919
implemented in all the tools this would

715
00:28:40,919 --> 00:28:43,860
be a basic test so that would actually

716
00:28:43,860 --> 00:28:45,720
go through a lot of different variants

717
00:28:45,720 --> 00:28:47,400
of the attacks that we see on the

718
00:28:47,400 --> 00:28:49,679
internet we do it structured so we do it

719
00:28:49,679 --> 00:28:52,200
one by one but an attacker would

720
00:28:52,200 --> 00:28:54,480
probably mix up these they would send a

721
00:28:54,480 --> 00:28:55,860
burst of this and a burst of that or

722
00:28:55,860 --> 00:28:58,140
even mix it at the same time and of

723
00:28:58,140 --> 00:29:00,840
course after doing these sequentially it

724
00:29:00,840 --> 00:29:02,640
would make sense to try to do the mixed

725
00:29:02,640 --> 00:29:04,740
and if you can mix it all up in a random

726
00:29:04,740 --> 00:29:06,840
fashion and your network still survives

727
00:29:06,840 --> 00:29:09,539
that's a good thing

728
00:29:09,539 --> 00:29:13,679
so using me my tools hp3 or the penguin

729
00:29:13,679 --> 00:29:16,320
ping with these options then you would

730
00:29:16,320 --> 00:29:20,159
be able to do these soon sunak icmp UDP

731
00:29:20,159 --> 00:29:22,500
flooding and it is quite easy to perform

732
00:29:22,500 --> 00:29:23,760
this

733
00:29:23,760 --> 00:29:26,279
use the usually when I run these tests I

734
00:29:26,279 --> 00:29:28,620
use the tool if PPS to show the

735
00:29:28,620 --> 00:29:31,500
interface package per second on my

736
00:29:31,500 --> 00:29:33,840
device as I'm sending the traffic so I

737
00:29:33,840 --> 00:29:36,240
can see how much am I sending but you

738
00:29:36,240 --> 00:29:38,760
can also monitor your local switch your

739
00:29:38,760 --> 00:29:41,760
local router all of these routing

740
00:29:41,760 --> 00:29:43,919
devices switching devices have methods

741
00:29:43,919 --> 00:29:45,899
for monitoring a port seeing how much

742
00:29:45,899 --> 00:29:47,940
traffic you are sending and how much

743
00:29:47,940 --> 00:29:50,100
traffic you're receiving

744
00:29:50,100 --> 00:29:53,240
usually I would also tune this test

745
00:29:53,240 --> 00:29:56,340
making sure that I not always run with

746
00:29:56,340 --> 00:29:58,260
the full speed because we want to find

747
00:29:58,260 --> 00:30:01,140
out which devices break and then we can

748
00:30:01,140 --> 00:30:04,140
turn it up to floating at the end so

749
00:30:04,140 --> 00:30:06,179
don't start out by floating everything

750
00:30:06,179 --> 00:30:08,640
because then it will just break

751
00:30:08,640 --> 00:30:10,679
it's more interesting to see when it

752
00:30:10,679 --> 00:30:13,919
breaks and see what kind of thing in the

753
00:30:13,919 --> 00:30:15,720
device breaks is it because of the

754
00:30:15,720 --> 00:30:17,820
interrupt handling is it because of

755
00:30:17,820 --> 00:30:20,039
these State tables is it something that

756
00:30:20,039 --> 00:30:22,559
we can actually fix or improve by the

757
00:30:22,559 --> 00:30:24,899
configuration so don't just turn it up

758
00:30:24,899 --> 00:30:26,760
to flooding even though it's quite fun

759
00:30:26,760 --> 00:30:28,500
to plot stuff

760
00:30:28,500 --> 00:30:31,559
using the hp3 and the DDOS testing tools

761
00:30:31,559 --> 00:30:33,419
I would also advise that you try to

762
00:30:33,419 --> 00:30:35,820
attack some of the network devices the

763
00:30:35,820 --> 00:30:37,679
router usually a router could have

764
00:30:37,679 --> 00:30:39,240
something like the secure shell running

765
00:30:39,240 --> 00:30:41,520
should not be open to the whole internet

766
00:30:41,520 --> 00:30:44,159
so by demonstrating that you can make it

767
00:30:44,159 --> 00:30:46,980
break or make it high load High CPU load

768
00:30:46,980 --> 00:30:49,140
then you can ask people to turn it off

769
00:30:49,140 --> 00:30:51,659
afterwards using something like a router

770
00:30:51,659 --> 00:30:53,760
protection filters it's something that

771
00:30:53,760 --> 00:30:55,860
should be implemented on all routers

772
00:30:55,860 --> 00:30:58,559
servicing your network so only the ISP

773
00:30:58,559 --> 00:31:01,559
can log into that router using SSH and

774
00:31:01,559 --> 00:31:03,419
if it's running pgp the routing protocol

775
00:31:03,419 --> 00:31:05,820
that's actually a TCP service running on

776
00:31:05,820 --> 00:31:09,360
179 and you can also try to attack that

777
00:31:09,360 --> 00:31:11,700
one and we have seen networks becoming

778
00:31:11,700 --> 00:31:13,860
coming offline because we attack the

779
00:31:13,860 --> 00:31:15,840
router in front of the network so it's

780
00:31:15,840 --> 00:31:17,940
not only your part the part that you

781
00:31:17,940 --> 00:31:20,580
control but you must ask your ISP to

782
00:31:20,580 --> 00:31:22,620
also improve their Network a bit and it

783
00:31:22,620 --> 00:31:26,360
is called router protection filters

784
00:31:26,600 --> 00:31:29,760
I told in the in the title for this that

785
00:31:29,760 --> 00:31:33,240
IPv6 testing is also part of this and my

786
00:31:33,240 --> 00:31:35,399
favorite tools have not supported IPv6

787
00:31:35,399 --> 00:31:37,740
and I'm a very fond of IP version 6 I

788
00:31:37,740 --> 00:31:40,679
did my thesis in Copenhagen 20 years ago

789
00:31:40,679 --> 00:31:44,039
about IPv6 nobody uses ipd6 in Denmark

790
00:31:44,039 --> 00:31:48,000
but I would like to test using IPv6

791
00:31:48,000 --> 00:31:51,059
and since these tools did not support

792
00:31:51,059 --> 00:31:54,179
IPv6 but these tools were open source I

793
00:31:54,179 --> 00:31:56,700
could actually take the hp3 tool then I

794
00:31:56,700 --> 00:31:58,799
could put it on GitHub I could replace

795
00:31:58,799 --> 00:32:01,260
all the references to ipvision 4 with IP

796
00:32:01,260 --> 00:32:03,720
version 6 and I actually even though I'm

797
00:32:03,720 --> 00:32:06,299
a bad programmer I could actually do a

798
00:32:06,299 --> 00:32:09,600
version that supported IPv6 but even

799
00:32:09,600 --> 00:32:12,600
better the new tool that I have created

800
00:32:12,600 --> 00:32:14,640
the script that I created on top of this

801
00:32:14,640 --> 00:32:17,580
Moon gen uses Lua and it already

802
00:32:17,580 --> 00:32:21,179
implements IPv6 so now I can use a small

803
00:32:21,179 --> 00:32:23,880
script in Lua I can modify and customize

804
00:32:23,880 --> 00:32:26,039
this script and that is my preferred way

805
00:32:26,039 --> 00:32:29,700
of doing IPv6 testing and basically the

806
00:32:29,700 --> 00:32:32,880
testing process is the same the main

807
00:32:32,880 --> 00:32:34,860
difference is that we cannot do an nmap

808
00:32:34,860 --> 00:32:37,320
full scan of a network because subnets

809
00:32:37,320 --> 00:32:40,140
in IPv6 are quite large so it is

810
00:32:40,140 --> 00:32:42,480
required to look into the firewall

811
00:32:42,480 --> 00:32:44,460
configuration the server configuration

812
00:32:44,460 --> 00:32:46,500
and see which ports are open to find the

813
00:32:46,500 --> 00:32:49,260
open ports Maybe it's within the first

814
00:32:49,260 --> 00:32:52,919
100 IPS if it's statically allocated but

815
00:32:52,919 --> 00:32:55,260
when you have the the services and the

816
00:32:55,260 --> 00:32:56,340
ports available

817
00:32:56,340 --> 00:32:58,620
then you can definitely use these tools

818
00:32:58,620 --> 00:33:02,279
either the old hping from 2018 that I

819
00:33:02,279 --> 00:33:04,200
created which is kind of a bad just

820
00:33:04,200 --> 00:33:05,840
replaced all the

821
00:33:05,840 --> 00:33:08,340
all the references to IP version 4 with

822
00:33:08,340 --> 00:33:11,039
IPv6 but it's much better to use this

823
00:33:11,039 --> 00:33:14,880
Moon gen from this person Emory P from

824
00:33:14,880 --> 00:33:17,340
GitHub

825
00:33:17,340 --> 00:33:20,159
and there's also some other test cases

826
00:33:20,159 --> 00:33:23,220
usually I don't spoof my source usually

827
00:33:23,220 --> 00:33:26,100
it's very nice to see in the logs that

828
00:33:26,100 --> 00:33:28,440
we have a specific IP address scanning

829
00:33:28,440 --> 00:33:31,559
us testing us dosing us we can look into

830
00:33:31,559 --> 00:33:34,080
the logs find my IP and see what goes on

831
00:33:34,080 --> 00:33:36,659
but definitely you want to try spoofing

832
00:33:36,659 --> 00:33:38,880
and it is implemented in all these tools

833
00:33:38,880 --> 00:33:40,440
that I have told you about

834
00:33:40,440 --> 00:33:43,860
there's also nice evil features like

835
00:33:43,860 --> 00:33:46,440
this one with which is about fragmenting

836
00:33:46,440 --> 00:33:49,019
packets so if you have a fragment of a

837
00:33:49,019 --> 00:33:51,179
packet then the firewall device the

838
00:33:51,179 --> 00:33:53,460
secure devices they have to wait for the

839
00:33:53,460 --> 00:33:55,260
rest of the fragments and guess what

840
00:33:55,260 --> 00:33:57,419
these tools do not send the rest of the

841
00:33:57,419 --> 00:33:59,519
fragments so the firewall will spend

842
00:33:59,519 --> 00:34:02,220
time keeping and storing these fragments

843
00:34:02,220 --> 00:34:04,919
until they time out so again some of

844
00:34:04,919 --> 00:34:07,200
these features built into the tools are

845
00:34:07,200 --> 00:34:10,379
very nice for breaking the devices

846
00:34:10,379 --> 00:34:13,500
if we start to attack a network and have

847
00:34:13,500 --> 00:34:15,300
the monitoring running we can see

848
00:34:15,300 --> 00:34:18,359
there's a large green line at the start

849
00:34:18,359 --> 00:34:20,760
and then it starts to break this is from

850
00:34:20,760 --> 00:34:22,918
a tool called smoking which I really

851
00:34:22,918 --> 00:34:25,679
enjoy because it does multiple probes

852
00:34:25,679 --> 00:34:29,040
and then it records the results in color

853
00:34:29,040 --> 00:34:32,280
so the color blue on the first one here

854
00:34:32,280 --> 00:34:35,639
says that it's losing some probes one

855
00:34:35,639 --> 00:34:38,159
two three probes and then it gets even

856
00:34:38,159 --> 00:34:40,800
worse because the color changes so it

857
00:34:40,800 --> 00:34:43,199
loses more probes and usually you would

858
00:34:43,199 --> 00:34:45,839
be sending 20 probes per minute and

859
00:34:45,839 --> 00:34:48,359
seeing which ones that are not responded

860
00:34:48,359 --> 00:34:51,300
to when we go further on in this case in

861
00:34:51,300 --> 00:34:53,520
this test we see that it goes into red

862
00:34:53,520 --> 00:34:55,859
being red means that the service is

863
00:34:55,859 --> 00:34:58,920
definitely offline it has 19 to 20

864
00:34:58,920 --> 00:35:01,680
probes lost so there's no service on

865
00:35:01,680 --> 00:35:03,660
this service that is being tested and

866
00:35:03,660 --> 00:35:05,940
that is what the customers of this web

867
00:35:05,940 --> 00:35:07,740
shop or production site Production

868
00:35:07,740 --> 00:35:09,660
Service would see

869
00:35:09,660 --> 00:35:13,020
we can go on and retry the test so we

870
00:35:13,020 --> 00:35:16,619
see a small green part after 11 and then

871
00:35:16,619 --> 00:35:18,960
we retest and see that it really indeed

872
00:35:18,960 --> 00:35:21,660
goes bad with this scenario so in this

873
00:35:21,660 --> 00:35:23,520
case it was a spoofing attack and it

874
00:35:23,520 --> 00:35:26,520
also worked and I as I remember I

875
00:35:26,520 --> 00:35:28,440
spoofed the IP addresses of the network

876
00:35:28,440 --> 00:35:31,020
itself which should not come from the

877
00:35:31,020 --> 00:35:33,359
internet so maybe look into the

878
00:35:33,359 --> 00:35:36,359
configuration and do not allow your IPS

879
00:35:36,359 --> 00:35:39,119
to be the source of traffic from the

880
00:35:39,119 --> 00:35:41,640
internet that's kind of that seems bad

881
00:35:41,640 --> 00:35:45,500
so turn that traffic away

882
00:35:45,900 --> 00:35:48,839
using the tools that I have mentioned

883
00:35:48,839 --> 00:35:52,500
already we can do a maximum speed test

884
00:35:52,500 --> 00:35:56,280
we can do the full 10 gigabit and 14.8

885
00:35:56,280 --> 00:35:58,740
mil 8 million packets per second that is

886
00:35:58,740 --> 00:36:01,380
actually the maximum number of packets

887
00:36:01,380 --> 00:36:03,960
with the minimal size on a 10 gigabit

888
00:36:03,960 --> 00:36:06,599
connection so it's not as much about the

889
00:36:06,599 --> 00:36:09,119
bandwidth handling because usually these

890
00:36:09,119 --> 00:36:11,820
firewalls can handle large packets data

891
00:36:11,820 --> 00:36:13,920
transfers but if you try to send the

892
00:36:13,920 --> 00:36:16,260
smallest packets it goes bad because

893
00:36:16,260 --> 00:36:19,200
every packet must go through this long

894
00:36:19,200 --> 00:36:22,140
flow of traffic all the package steps

895
00:36:22,140 --> 00:36:26,220
within the devices so handling 14 15

896
00:36:26,220 --> 00:36:28,380
million packets per second is really

897
00:36:28,380 --> 00:36:30,839
really hard in the device so usually

898
00:36:30,839 --> 00:36:33,000
they will sell you a device that cannot

899
00:36:33,000 --> 00:36:34,859
handle this but they will handle some

900
00:36:34,859 --> 00:36:37,560
kind of imix some kind of mixed traffic

901
00:36:37,560 --> 00:36:41,460
with large packets foreign these modern

902
00:36:41,460 --> 00:36:43,560
CPUs that we have for many years support

903
00:36:43,560 --> 00:36:45,480
methods for sending and receiving high

904
00:36:45,480 --> 00:36:48,480
speed using this lure it is using Lua

905
00:36:48,480 --> 00:36:50,400
jit which is just in time compiled

906
00:36:50,400 --> 00:36:53,700
making it a small Loop which can run

907
00:36:53,700 --> 00:36:56,579
very efficiently in our modern CPUs the

908
00:36:56,579 --> 00:36:58,920
modern CPUs are connected with the

909
00:36:58,920 --> 00:37:01,380
network cards using for instance this

910
00:37:01,380 --> 00:37:03,240
data plane development kit it was

911
00:37:03,240 --> 00:37:05,160
originally from Intel so most of the

912
00:37:05,160 --> 00:37:07,800
cards supported are from Intel but there

913
00:37:07,800 --> 00:37:09,720
are also other vendors and other cards

914
00:37:09,720 --> 00:37:11,940
supported by this and it is open source

915
00:37:11,940 --> 00:37:15,180
so you can buy one gig cards 10 gig

916
00:37:15,180 --> 00:37:17,640
cards 40 gig cards and you probably

917
00:37:17,640 --> 00:37:21,000
shouldn't try to buy 100 G cards and

918
00:37:21,000 --> 00:37:24,780
produce a packet DDOS testing traffic I

919
00:37:24,780 --> 00:37:27,359
would rather have a number of smaller

920
00:37:27,359 --> 00:37:30,180
cards and maybe a switch to aggregate so

921
00:37:30,180 --> 00:37:33,240
if you wanted to produce say 100

922
00:37:33,240 --> 00:37:35,940
gigabits full capacity then you would

923
00:37:35,940 --> 00:37:39,300
have a switch with 100 Gig and then 10g

924
00:37:39,300 --> 00:37:41,700
or 40G and then set into traffic and

925
00:37:41,700 --> 00:37:43,440
then allow the switch to aggregate it

926
00:37:43,440 --> 00:37:45,839
into a full 100 gigabit and that would

927
00:37:45,839 --> 00:37:47,400
certainly be possible by just having

928
00:37:47,400 --> 00:37:51,119
perhaps 10 machines or fewer

929
00:37:51,119 --> 00:37:53,280
I'm using a very small device and this

930
00:37:53,280 --> 00:37:55,020
is not a recommendation of Dell it just

931
00:37:55,020 --> 00:37:57,000
happens to be the device that I could

932
00:37:57,000 --> 00:37:59,280
get for pretty cheap it's not very big I

933
00:37:59,280 --> 00:38:00,839
can travel with it I have it in my hotel

934
00:38:00,839 --> 00:38:02,880
room I set up this small testing

935
00:38:02,880 --> 00:38:05,400
environment with a small 10g switch and

936
00:38:05,400 --> 00:38:08,400
it's just any modern new CPU would

937
00:38:08,400 --> 00:38:10,500
probably work then you would look into

938
00:38:10,500 --> 00:38:13,859
having a PCI times eight a slot and then

939
00:38:13,859 --> 00:38:16,500
I use an old Intel card which is

940
00:38:16,500 --> 00:38:18,300
something you can find on eBay pretty

941
00:38:18,300 --> 00:38:20,780
cheaply

942
00:38:20,880 --> 00:38:24,000
using the tool that I have used on top

943
00:38:24,000 --> 00:38:26,400
of this Moon gen allows me to produce as

944
00:38:26,400 --> 00:38:28,800
we can see in this case 14.8 million

945
00:38:28,800 --> 00:38:31,079
packets per second which is not full 10

946
00:38:31,079 --> 00:38:34,440
G so it's only 7.6 so looking at a graph

947
00:38:34,440 --> 00:38:36,720
you may think that oh my device can

948
00:38:36,720 --> 00:38:39,960
handle 10g but it is actually not 10g in

949
00:38:39,960 --> 00:38:42,300
bandwidth but it's 10t in packets per

950
00:38:42,300 --> 00:38:43,740
second

951
00:38:43,740 --> 00:38:47,760
this tool can be used for UDP icmp it

952
00:38:47,760 --> 00:38:49,619
can be used for just about any protocol

953
00:38:49,619 --> 00:38:51,599
you wish because it's written in Lua

954
00:38:51,599 --> 00:38:52,980
there's a lot of Lua scripting

955
00:38:52,980 --> 00:38:55,140
implemented already you could add your

956
00:38:55,140 --> 00:38:57,780
own protocol I have messed with this and

957
00:38:57,780 --> 00:39:00,119
again I'm not a great programmer but

958
00:39:00,119 --> 00:39:02,160
very very quickly you can start to

959
00:39:02,160 --> 00:39:04,079
generate whatever kind of traffic you

960
00:39:04,079 --> 00:39:06,540
want and you can actually create it in

961
00:39:06,540 --> 00:39:09,180
full wire speed mode

962
00:39:09,180 --> 00:39:11,220
I'm just going to go a little bit

963
00:39:11,220 --> 00:39:13,079
quicker just saying that this is

964
00:39:13,079 --> 00:39:15,619
comparable to real DDOS it's very very

965
00:39:15,619 --> 00:39:18,420
approximate to what I have seen in real

966
00:39:18,420 --> 00:39:20,240
life networks that I have been running

967
00:39:20,240 --> 00:39:23,940
and I see a lot of different uh

968
00:39:23,940 --> 00:39:26,640
results from this and the results is

969
00:39:26,640 --> 00:39:29,099
that we should do more packet filtering

970
00:39:29,099 --> 00:39:31,859
so my recommendation is to look at all

971
00:39:31,859 --> 00:39:34,500
your devices from the internet all the

972
00:39:34,500 --> 00:39:37,020
way to your servers looking at these

973
00:39:37,020 --> 00:39:39,900
devices we can actually do specific

974
00:39:39,900 --> 00:39:42,660
stuff at specific points and a lot of it

975
00:39:42,660 --> 00:39:45,240
can happen in Hardware so looking at a

976
00:39:45,240 --> 00:39:47,820
router it can do stateless filtering of

977
00:39:47,820 --> 00:39:49,980
individual packets so if you know that

978
00:39:49,980 --> 00:39:51,480
there are some protocols that you're not

979
00:39:51,480 --> 00:39:54,359
using you can turn it away by the router

980
00:39:54,359 --> 00:39:56,579
if you want to shape and do some

981
00:39:56,579 --> 00:39:58,560
distribution you want to allocate a

982
00:39:58,560 --> 00:40:01,079
specific bandwidth number for a specific

983
00:40:01,079 --> 00:40:03,300
protocol you can do that in your routers

984
00:40:03,300 --> 00:40:06,000
and switches then we can see the

985
00:40:06,000 --> 00:40:09,119
security services security devices what

986
00:40:09,119 --> 00:40:11,099
you usually would call a firewall would

987
00:40:11,099 --> 00:40:14,040
handle less traffic and that is actually

988
00:40:14,040 --> 00:40:15,780
the goal of the projection that I'm

989
00:40:15,780 --> 00:40:18,119
advising start to use the features

990
00:40:18,119 --> 00:40:20,579
already available and I can see my time

991
00:40:20,579 --> 00:40:24,420
has run out now but I'm just going to to

992
00:40:24,420 --> 00:40:27,000
quickly point you to these slides where

993
00:40:27,000 --> 00:40:30,000
I have taken a design approach saying

994
00:40:30,000 --> 00:40:32,520
that for some protocols we may need full

995
00:40:32,520 --> 00:40:35,099
changing but for some other protocols we

996
00:40:35,099 --> 00:40:38,880
will need less so if we need less why do

997
00:40:38,880 --> 00:40:42,180
we allow more into the network and by

998
00:40:42,180 --> 00:40:43,980
going further we can look into the

999
00:40:43,980 --> 00:40:46,260
specific ports that are available we can

1000
00:40:46,260 --> 00:40:48,359
look into the configuration statements

1001
00:40:48,359 --> 00:40:50,640
this is from junos where I have limited

1002
00:40:50,640 --> 00:40:53,640
icmp to 100 megabit because nobody wants

1003
00:40:53,640 --> 00:40:56,280
10g of icmp traffic into their Network

1004
00:40:56,280 --> 00:40:59,040
so better turn it away before it reaches

1005
00:40:59,040 --> 00:41:00,839
the firewall device which needs to

1006
00:41:00,839 --> 00:41:03,300
handle it in all of these steps that we

1007
00:41:03,300 --> 00:41:05,760
already have seen and UDP one gigabit

1008
00:41:05,760 --> 00:41:07,500
because usually we don't have more than

1009
00:41:07,500 --> 00:41:10,320
a few hundred megabits depending on your

1010
00:41:10,320 --> 00:41:12,960
use case and your network some networks

1011
00:41:12,960 --> 00:41:14,880
use file transfer using UDP and they

1012
00:41:14,880 --> 00:41:16,980
will definitely need more but in a

1013
00:41:16,980 --> 00:41:19,020
common Network you can use configuration

1014
00:41:19,020 --> 00:41:21,240
statements like these and you can find

1015
00:41:21,240 --> 00:41:23,460
them for your own devices in your own

1016
00:41:23,460 --> 00:41:26,339
network and if we do this we can see

1017
00:41:26,339 --> 00:41:28,800
that kind of like in this case a 3.5

1018
00:41:28,800 --> 00:41:31,740
gigabit network attack and it resulted

1019
00:41:31,740 --> 00:41:35,820
in only 350 megabits being sent on to a

1020
00:41:35,820 --> 00:41:38,060
one gigabit firewall

1021
00:41:38,060 --> 00:41:40,560
I will

1022
00:41:40,560 --> 00:41:43,440
unfortunately have to stop now time has

1023
00:41:43,440 --> 00:41:46,380
run out so before I get the dragged off

1024
00:41:46,380 --> 00:41:48,420
I will be here for today and tomorrow

1025
00:41:48,420 --> 00:41:51,000
very happy to answer questions go to

1026
00:41:51,000 --> 00:41:52,859
GitHub find the presentation if you like

1027
00:41:52,859 --> 00:41:55,440
and thank you very much for allowing me

1028
00:41:55,440 --> 00:41:58,079
to talk about this subject

1029
00:41:58,079 --> 00:42:01,079
foreign

1030
00:42:05,119 --> 00:42:09,740
thank you very much

