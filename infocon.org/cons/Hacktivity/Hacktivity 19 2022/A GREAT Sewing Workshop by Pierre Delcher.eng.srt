1
00:00:00,060 --> 00:00:03,540
okay over to Pierre

2
00:00:03,540 --> 00:00:07,259
one two okay so hi everyone uh thanks

3
00:00:07,259 --> 00:00:11,099
for attending I guess I'm Pierre

4
00:00:11,099 --> 00:00:13,080
um this is my first time both in

5
00:00:13,080 --> 00:00:16,260
activity and in Hungary I have worked

6
00:00:16,260 --> 00:00:18,600
for eight years uh within the French

7
00:00:18,600 --> 00:00:21,900
national cyber security agency and the

8
00:00:21,900 --> 00:00:24,240
French Ministry of Defense I also spent

9
00:00:24,240 --> 00:00:26,220
two years as a sizer for international

10
00:00:26,220 --> 00:00:30,060
company and now I'm working as a cyber

11
00:00:30,060 --> 00:00:32,759
security researcher within Kaspersky is

12
00:00:32,759 --> 00:00:33,420
great

13
00:00:33,420 --> 00:00:36,120
I'm a full-time remote worker from my

14
00:00:36,120 --> 00:00:39,059
hometown in rural France as you may earn

15
00:00:39,059 --> 00:00:42,320
from my accent during this difficult

16
00:00:42,320 --> 00:00:46,079
pandemic and War times I found myself a

17
00:00:46,079 --> 00:00:50,059
new patient to relax and

18
00:00:50,059 --> 00:00:53,399
suing and I believe you'll have a fun

19
00:00:53,399 --> 00:00:57,420
time while I'm sharing it with you

20
00:00:57,420 --> 00:01:00,360
I'm really sure we'll have a lot of fun

21
00:01:00,360 --> 00:01:03,359
as can be seen in this picture where by

22
00:01:03,359 --> 00:01:04,979
the way the guy is suing on a machine

23
00:01:04,979 --> 00:01:06,900
which is literally called the cowboy

24
00:01:06,900 --> 00:01:09,799
sewing machine

25
00:01:10,020 --> 00:01:12,900
uh of course I'm kidding I'll talk about

26
00:01:12,900 --> 00:01:15,780
ViaSat and specifically tell you the

27
00:01:15,780 --> 00:01:18,299
story of the work we did on the event

28
00:01:18,299 --> 00:01:21,000
they faced eight months ago now that

29
00:01:21,000 --> 00:01:23,520
they called a cyber event in their own

30
00:01:23,520 --> 00:01:25,020
terms

31
00:01:25,020 --> 00:01:27,960
on the 24th of February the day that the

32
00:01:27,960 --> 00:01:29,700
Kremlin is announcing the invasion of

33
00:01:29,700 --> 00:01:32,159
Ukraine everything suddenly starts to

34
00:01:32,159 --> 00:01:35,100
get a bit wild for all users at which

35
00:01:35,100 --> 00:01:38,460
internet through the wires that owned Ka

36
00:01:38,460 --> 00:01:41,299
sat satellites connection

37
00:01:41,299 --> 00:01:44,479
KSAT users and access providers

38
00:01:44,479 --> 00:01:47,400
massively reports lots of internet

39
00:01:47,400 --> 00:01:49,740
connection until they discover it is

40
00:01:49,740 --> 00:01:52,500
actually their access modems that seem

41
00:01:52,500 --> 00:01:54,840
totally dead on the displayed capture

42
00:01:54,840 --> 00:01:57,780
from a specialized Forum in March a user

43
00:01:57,780 --> 00:01:59,880
accesses its modern firmware might be

44
00:01:59,880 --> 00:02:02,640
co-opted from the states of the LED

45
00:02:02,640 --> 00:02:04,740
lights in the modem various public

46
00:02:04,740 --> 00:02:07,439
sources including major Medias will

47
00:02:07,439 --> 00:02:11,220
report tens of thousands of users as

48
00:02:11,220 --> 00:02:14,280
affected including the modems that were

49
00:02:14,280 --> 00:02:17,099
used by enercon German energy provider

50
00:02:17,099 --> 00:02:19,980
they use such model to provide access to

51
00:02:19,980 --> 00:02:23,160
their wine turbines control system guess

52
00:02:23,160 --> 00:02:25,200
it's starting to get quite a big of a

53
00:02:25,200 --> 00:02:27,840
siber event now

54
00:02:27,840 --> 00:02:31,200
but is this the result of a sabotage or

55
00:02:31,200 --> 00:02:33,959
an accident why would someone or

56
00:02:33,959 --> 00:02:36,060
somebody disrupt the case at service on

57
00:02:36,060 --> 00:02:37,860
the exact day Russia is starting to

58
00:02:37,860 --> 00:02:40,500
invade Ukraine he is the answer Eden in

59
00:02:40,500 --> 00:02:42,239
the question many questions that

60
00:02:42,239 --> 00:02:45,599
everybody asked or not actually but well

61
00:02:45,599 --> 00:02:47,940
they have been mostly left unanswered

62
00:02:47,940 --> 00:02:50,340
because you know a secret investigation

63
00:02:50,340 --> 00:02:53,040
first and there's a war to deal with so

64
00:02:53,040 --> 00:02:55,680
priorities let's try to get part of

65
00:02:55,680 --> 00:02:58,140
those answers first from the Ukrainian

66
00:02:58,140 --> 00:03:01,500
government website which lists all their

67
00:03:01,500 --> 00:03:04,019
requests for proposals also known as

68
00:03:04,019 --> 00:03:07,080
call for bids well we can discover that

69
00:03:07,080 --> 00:03:09,800
the Ukrainian military Security Services

70
00:03:09,800 --> 00:03:12,180
and a whole lot of government bodies

71
00:03:12,180 --> 00:03:15,180
actually are actually relying on ksr

72
00:03:15,180 --> 00:03:17,819
Internet services a lot we can find a

73
00:03:17,819 --> 00:03:20,220
ton of requests for proposal mentioning

74
00:03:20,220 --> 00:03:23,519
the purchase or the operation of KSAT

75
00:03:23,519 --> 00:03:27,959
modems between 2016 and 2021 well at

76
00:03:27,959 --> 00:03:30,780
least we could before the incident the

77
00:03:30,780 --> 00:03:32,819
displayed screenshot actually come from

78
00:03:32,819 --> 00:03:36,060
an archived version of the call for

79
00:03:36,060 --> 00:03:38,580
proposal website here is what you can

80
00:03:38,580 --> 00:03:41,120
find now

81
00:03:41,120 --> 00:03:43,500
uh so you might not be able to read it

82
00:03:43,500 --> 00:03:45,659
let me translate it for you this page

83
00:03:45,659 --> 00:03:48,299
has been temporarily censored to in the

84
00:03:48,299 --> 00:03:50,580
Russian spice and that might have been a

85
00:03:50,580 --> 00:03:53,040
clue already but then if you looked for

86
00:03:53,040 --> 00:03:54,900
something more explicit then European

87
00:03:54,900 --> 00:03:57,000
Union came to the rescue on May 10

88
00:03:57,000 --> 00:03:59,879
directly appointing at Russia

89
00:03:59,879 --> 00:04:02,700
then how did that happen right from the

90
00:04:02,700 --> 00:04:05,340
start in early March a lot of more or

91
00:04:05,340 --> 00:04:07,620
less off-the-wall theories emerged

92
00:04:07,620 --> 00:04:09,480
including some which considered

93
00:04:09,480 --> 00:04:12,299
satellites battles and hijacking space

94
00:04:12,299 --> 00:04:14,519
force style at the very edge of a Star

95
00:04:14,519 --> 00:04:16,680
Wars Episode well we'll leave it with

96
00:04:16,680 --> 00:04:19,139
Disney to think about how they would

97
00:04:19,139 --> 00:04:20,639
like to produce such an episode but

98
00:04:20,639 --> 00:04:22,620
luckily the first wires that statement

99
00:04:22,620 --> 00:04:26,280
reported by rotors on March 12th came to

100
00:04:26,280 --> 00:04:29,940
the rescue March 12 17 days after the

101
00:04:29,940 --> 00:04:31,440
incident while the responsive

102
00:04:31,440 --> 00:04:34,680
communication viasad stated that occurs

103
00:04:34,680 --> 00:04:37,380
got in a management Network

104
00:04:37,380 --> 00:04:40,020
which enabled modem control

105
00:04:40,020 --> 00:04:41,280
that's all

106
00:04:41,280 --> 00:04:44,280
on March 14 I just came back from

107
00:04:44,280 --> 00:04:46,259
vacation and I'm pretty sure there's no

108
00:04:46,259 --> 00:04:49,199
turning back from such effects and I

109
00:04:49,199 --> 00:04:50,699
discovered this news

110
00:04:50,699 --> 00:04:52,620
I thought it deserved a bit of

111
00:04:52,620 --> 00:04:55,080
Investigation so that I also started to

112
00:04:55,080 --> 00:04:57,660
work on it to come up with my own Star

113
00:04:57,660 --> 00:04:59,639
Wars theories

114
00:04:59,639 --> 00:05:01,979
so what's a management Network in via's

115
00:05:01,979 --> 00:05:04,380
attempts according to a ViaSat modems

116
00:05:04,380 --> 00:05:07,500
data sheets as they could be found on a

117
00:05:07,500 --> 00:05:09,479
publicly available website that are

118
00:05:09,479 --> 00:05:13,380
aimed at Via technicians It could only

119
00:05:13,380 --> 00:05:17,280
be either tier 69 or SNMP you probably

120
00:05:17,280 --> 00:05:19,500
know about SNMP a simple Network

121
00:05:19,500 --> 00:05:22,500
management protocol as for cr69 if you

122
00:05:22,500 --> 00:05:25,500
don't it is also called customer premise

123
00:05:25,500 --> 00:05:28,680
equipment one management protocol so

124
00:05:28,680 --> 00:05:31,139
it's an HTTP soap based protocol usually

125
00:05:31,139 --> 00:05:33,900
aimed at remote controlling supervising

126
00:05:33,900 --> 00:05:36,360
and updating modems

127
00:05:36,360 --> 00:05:39,600
by the way we can find that via sat

128
00:05:39,600 --> 00:05:43,199
selected the German provider axiros as a

129
00:05:43,199 --> 00:05:45,660
provider for their ts-69 infrastructure

130
00:05:45,660 --> 00:05:49,380
starting in 2013. we can guess our girls

131
00:05:49,380 --> 00:05:52,139
might have reached a tier 69 control

132
00:05:52,139 --> 00:05:55,680
server also known as an ACS and ASO

133
00:05:55,680 --> 00:05:58,080
could deploy a malicious update to

134
00:05:58,080 --> 00:06:01,139
ViaSat modems and it turns out the ACs

135
00:06:01,139 --> 00:06:04,919
system for axiros called access was for

136
00:06:04,919 --> 00:06:07,800
instance vulnerable to lock for Shell so

137
00:06:07,800 --> 00:06:10,560
that's not totally unrealistic if we dig

138
00:06:10,560 --> 00:06:12,960
a bit more we can find some buyers that

139
00:06:12,960 --> 00:06:15,539
provided firmware's designed for one of

140
00:06:15,539 --> 00:06:17,280
their systems that they called Community

141
00:06:17,280 --> 00:06:19,800
internet so the system is aimed at

142
00:06:19,800 --> 00:06:22,319
providing internet and satellite-based

143
00:06:22,319 --> 00:06:26,340
internet access to isolated communities

144
00:06:26,340 --> 00:06:28,979
analyzing those firmware's enough enable

145
00:06:28,979 --> 00:06:32,280
confirming ViaSat indeed relies on ts-69

146
00:06:32,280 --> 00:06:34,500
for at least some of their devices

147
00:06:34,500 --> 00:06:37,880
what's more tier 69

148
00:06:37,880 --> 00:06:40,919
the tr69 management networks is Rich

149
00:06:40,919 --> 00:06:44,580
through a fortunate compliance ipsec VPN

150
00:06:44,580 --> 00:06:46,979
rather than directly exposed to the

151
00:06:46,979 --> 00:06:48,780
Internet so then aqueous would have

152
00:06:48,780 --> 00:06:51,660
needed to pass the VPN boundary to get

153
00:06:51,660 --> 00:06:53,580
in the management Network sure there's a

154
00:06:53,580 --> 00:06:55,560
lot of now well-known critical

155
00:06:55,560 --> 00:06:57,240
vulnerabilities on most commercial

156
00:06:57,240 --> 00:07:01,759
off-the-shelf VPN gateways but

157
00:07:01,759 --> 00:07:04,080
secrets that are required to connect to

158
00:07:04,080 --> 00:07:06,120
the VPN management Network are of course

159
00:07:06,120 --> 00:07:08,639
stored clear text in those firmware I

160
00:07:08,639 --> 00:07:10,860
just found on the internet so I needed a

161
00:07:10,860 --> 00:07:13,319
few hours from the end of my vacation to

162
00:07:13,319 --> 00:07:15,180
these findings including the VPN access

163
00:07:15,180 --> 00:07:17,160
so I figure it would not have been hard

164
00:07:17,160 --> 00:07:19,560
at all for a state actor to get in a

165
00:07:19,560 --> 00:07:21,599
so-called management networks four days

166
00:07:21,599 --> 00:07:25,500
later on March 18 a source points us at

167
00:07:25,500 --> 00:07:27,900
an executable binary that has been

168
00:07:27,900 --> 00:07:30,080
submitted to a public online

169
00:07:30,080 --> 00:07:32,819
multi-scanner service from an IP address

170
00:07:32,819 --> 00:07:37,139
in Italy Mark that for later

171
00:07:37,139 --> 00:07:39,780
a few reverse engineering hours later my

172
00:07:39,780 --> 00:07:40,919
colleagues and I determined the

173
00:07:40,919 --> 00:07:43,319
executable binary is a wiper compiled

174
00:07:43,319 --> 00:07:45,060
for the mips architecture aimed at

175
00:07:45,060 --> 00:07:47,520
erasing files and Flash memories in the

176
00:07:47,520 --> 00:07:49,919
Linux platform the white perform flow is

177
00:07:49,919 --> 00:07:52,259
very simple code starts by printing a

178
00:07:52,259 --> 00:07:54,960
lookout message to the console delete

179
00:07:54,960 --> 00:07:57,120
files on the file system by overwriting

180
00:07:57,120 --> 00:07:59,639
the first bytes and erase existing

181
00:07:59,639 --> 00:08:02,639
storage memories and write new data over

182
00:08:02,639 --> 00:08:03,840
them

183
00:08:03,840 --> 00:08:05,759
the wiper used the content of a

184
00:08:05,759 --> 00:08:08,639
pre-filled buffer to override data this

185
00:08:08,639 --> 00:08:11,039
buffer is stuffed with bytes from

186
00:08:11,039 --> 00:08:13,500
integer values that are decremented in a

187
00:08:13,500 --> 00:08:16,259
loop as a result the contents of a white

188
00:08:16,259 --> 00:08:19,319
memory which is erased by this wiper is

189
00:08:19,319 --> 00:08:21,300
filled with such pattern and is very

190
00:08:21,300 --> 00:08:22,800
specific

191
00:08:22,800 --> 00:08:25,979
the wiper pay close attention to flash

192
00:08:25,979 --> 00:08:29,220
memory erasing because it tries to use

193
00:08:29,220 --> 00:08:31,199
driver provided and Hardware backed

194
00:08:31,199 --> 00:08:34,020
erase function but then on top of that

195
00:08:34,020 --> 00:08:37,620
he overwrites the content of the memory

196
00:08:37,620 --> 00:08:40,679
on March 18 we had a plausible interest

197
00:08:40,679 --> 00:08:43,919
in paths a realistic operation overview

198
00:08:43,919 --> 00:08:46,080
and a man issue swiper which could be

199
00:08:46,080 --> 00:08:48,300
the main cause of the modem troubled

200
00:08:48,300 --> 00:08:51,420
that we by the way dubbed Cosmic wiper

201
00:08:51,420 --> 00:08:53,940
considering an already negative opinion

202
00:08:53,940 --> 00:08:55,740
from several organizations against

203
00:08:55,740 --> 00:08:58,440
Kaspersky back then as well as in most

204
00:08:58,440 --> 00:09:00,959
of all some confidentiality requirement

205
00:09:00,959 --> 00:09:02,820
from the source that pointed us to the

206
00:09:02,820 --> 00:09:05,459
wiper we did not write or talk about

207
00:09:05,459 --> 00:09:07,680
these findings at all

208
00:09:07,680 --> 00:09:12,000
whatever on March 30 uh 12 days after

209
00:09:12,000 --> 00:09:14,220
our findings and one month after the

210
00:09:14,220 --> 00:09:16,260
event via set finally published an

211
00:09:16,260 --> 00:09:19,200
official statement on their own website

212
00:09:19,200 --> 00:09:22,200
via set confirms hackers get in a

213
00:09:22,200 --> 00:09:23,760
management network but also explained

214
00:09:23,760 --> 00:09:26,399
they did so by bypassing a fortunate VPN

215
00:09:26,399 --> 00:09:29,339
which match our findings ViaSat also

216
00:09:29,339 --> 00:09:31,019
tells remote control capabilities have

217
00:09:31,019 --> 00:09:32,760
been leveraged by a girls to deploy

218
00:09:32,760 --> 00:09:35,160
destructive tools on Modern which also

219
00:09:35,160 --> 00:09:39,899
match our findings and um by the way VIA

220
00:09:39,899 --> 00:09:42,540
soft blames skylogic one of their

221
00:09:42,540 --> 00:09:44,820
operating partner in Italia which may

222
00:09:44,820 --> 00:09:47,279
match the Italian origin of the wiper

223
00:09:47,279 --> 00:09:50,220
submission on a multiscanner service one

224
00:09:50,220 --> 00:09:53,100
day later on the 31 a U.S cyber security

225
00:09:53,100 --> 00:09:55,440
company will publicly describe Cosmic

226
00:09:55,440 --> 00:09:59,300
wiper under the name acid rain

227
00:09:59,399 --> 00:10:01,800
anyway before such public statements and

228
00:10:01,800 --> 00:10:03,600
details even if we are the good of a

229
00:10:03,600 --> 00:10:05,220
view of the incident and some strong

230
00:10:05,220 --> 00:10:07,560
hypothesis we wanted to check real

231
00:10:07,560 --> 00:10:10,320
modems like those which were wiped and

232
00:10:10,320 --> 00:10:12,959
in order to confirm they used dr69 or

233
00:10:12,959 --> 00:10:15,180
that Cosmic wiper worked on such

234
00:10:15,180 --> 00:10:17,700
platforms and tried to learn a bit more

235
00:10:17,700 --> 00:10:19,260
of course to do so we needed real

236
00:10:19,260 --> 00:10:21,540
devices production firmware's

237
00:10:21,540 --> 00:10:24,720
and we just did not found any of them

238
00:10:24,720 --> 00:10:26,459
um they are not publicly distributed

239
00:10:26,459 --> 00:10:29,160
most likely nobody tried to get such a

240
00:10:29,160 --> 00:10:31,320
device and firmware as before the

241
00:10:31,320 --> 00:10:33,300
incident except maybe for the attackers

242
00:10:33,300 --> 00:10:36,000
and the war story was under intelligence

243
00:10:36,000 --> 00:10:39,000
SMC investigation vaccine

244
00:10:39,000 --> 00:10:42,120
so we needed to get or end on some real

245
00:10:42,120 --> 00:10:44,220
devices and try to extract the firmware

246
00:10:44,220 --> 00:10:45,360
out of it

247
00:10:45,360 --> 00:10:47,700
as often when we need to get around on

248
00:10:47,700 --> 00:10:50,640
some specific devices it all starts in

249
00:10:50,640 --> 00:10:53,399
the darkest of the dark web

250
00:10:53,399 --> 00:10:54,899
Craigslist

251
00:10:54,899 --> 00:10:57,540
well I went to a French equal but still

252
00:10:57,540 --> 00:10:59,880
a bit of shopping later I get one of

253
00:10:59,880 --> 00:11:02,339
those working ksr modems and well now

254
00:11:02,339 --> 00:11:06,120
I'll try to make spit in a firmware

255
00:11:06,120 --> 00:11:08,519
first we had a quick look at the user

256
00:11:08,519 --> 00:11:10,860
exposed Network Services and noted the

257
00:11:10,860 --> 00:11:13,019
vulnerability scope is quite limited

258
00:11:13,019 --> 00:11:16,500
only HTTP and DHCP services are Exposed

259
00:11:16,500 --> 00:11:19,260
on the land by default and are based on

260
00:11:19,260 --> 00:11:21,660
a lightweight software of no

261
00:11:21,660 --> 00:11:24,420
non-vulnerability or HTTP service also

262
00:11:24,420 --> 00:11:27,720
did not accept any direct user input we

263
00:11:27,720 --> 00:11:29,459
then quickly jumped to The Next Step

264
00:11:29,459 --> 00:11:31,620
also admittedly because we wanted to

265
00:11:31,620 --> 00:11:34,200
which is steering the device apart

266
00:11:34,200 --> 00:11:36,360
so you might see there's an fpga and a

267
00:11:36,360 --> 00:11:38,640
bridge type chip first is aimed at

268
00:11:38,640 --> 00:11:40,500
demodulating the signal from the

269
00:11:40,500 --> 00:11:43,320
supposedly attached antenna second is

270
00:11:43,320 --> 00:11:45,360
likely orchestrating communication

271
00:11:45,360 --> 00:11:47,940
between the CPU and the other chips

272
00:11:47,940 --> 00:11:51,120
then comes mips 64 CPU which already

273
00:11:51,120 --> 00:11:53,279
confirms the cosmic wiper would match

274
00:11:53,279 --> 00:11:55,920
the modem architecture

275
00:11:55,920 --> 00:11:58,079
then almost wanted chip the one which

276
00:11:58,079 --> 00:11:59,579
probably stores the firmware we are

277
00:11:59,579 --> 00:12:01,500
looking for a flash memory of Android

278
00:12:01,500 --> 00:12:04,980
max only persistent and permanently

279
00:12:04,980 --> 00:12:07,440
attached to wage in the device

280
00:12:07,440 --> 00:12:10,500
last but not least prepared pins that

281
00:12:10,500 --> 00:12:12,540
are just waiting us to show them some

282
00:12:12,540 --> 00:12:13,680
love

283
00:12:13,680 --> 00:12:16,200
we can expect copying a flash memory

284
00:12:16,200 --> 00:12:18,480
content in its own bed using protocols

285
00:12:18,480 --> 00:12:21,240
such as SPI motherboard JTAG or any

286
00:12:21,240 --> 00:12:23,640
system that can access it and that is

287
00:12:23,640 --> 00:12:25,740
exposed through communication interface

288
00:12:25,740 --> 00:12:28,140
on the device starting by the operating

289
00:12:28,140 --> 00:12:31,560
system itself exploring starts with the

290
00:12:31,560 --> 00:12:34,740
the multi the most obvious tool I have

291
00:12:34,740 --> 00:12:37,560
I'm a mere Enthusiast so a multitester

292
00:12:37,560 --> 00:12:39,300
for some continuity testing a

293
00:12:39,300 --> 00:12:40,920
multi-purpose Hardware diagnostic

294
00:12:40,920 --> 00:12:44,040
interface in that case a buspirat and

295
00:12:44,040 --> 00:12:47,040
cables there are no SPI on the flash so

296
00:12:47,040 --> 00:12:50,399
that's a dead end some urit pins a

297
00:12:50,399 --> 00:12:52,440
Serial interface in other words can

298
00:12:52,440 --> 00:12:55,260
quickly be spotted on the device using

299
00:12:55,260 --> 00:12:58,260
content continuity testing from the CPU

300
00:12:58,260 --> 00:13:00,420
surrounding to the prepared pin on the

301
00:13:00,420 --> 00:13:03,300
motherboards thanks to the CPU data

302
00:13:03,300 --> 00:13:04,920
sheet that is available on the internet

303
00:13:04,920 --> 00:13:07,440
as for JTAG we still have 15

304
00:13:07,440 --> 00:13:09,920
unidentified pins on the motherboard

305
00:13:09,920 --> 00:13:13,380
which don't match any known JTAG

306
00:13:13,380 --> 00:13:15,600
standard that some specialized device

307
00:13:15,600 --> 00:13:17,959
can brute force her JTAG pinning it's

308
00:13:17,959 --> 00:13:20,820
rather expensive and coming from a rural

309
00:13:20,820 --> 00:13:23,880
area where every cent is a lot I prefer

310
00:13:23,880 --> 00:13:25,800
the cheaper alternative which relies on

311
00:13:25,800 --> 00:13:28,500
gpio pins from a Raspberry Pi and an

312
00:13:28,500 --> 00:13:30,000
open source software which is called

313
00:13:30,000 --> 00:13:33,779
gojtagenum unfortunately gtag layout

314
00:13:33,779 --> 00:13:37,680
could not be identified and I'll test I

315
00:13:37,680 --> 00:13:39,660
learned later that the JTAG is actually

316
00:13:39,660 --> 00:13:41,639
not connected and not prepared on this

317
00:13:41,639 --> 00:13:44,760
board as an exploration summary we could

318
00:13:44,760 --> 00:13:47,339
only identify a Serial interface and can

319
00:13:47,339 --> 00:13:50,540
only continue from there

320
00:13:50,820 --> 00:13:53,459
and here is what the cellular interface

321
00:13:53,459 --> 00:13:56,279
is going to show us if we connect any

322
00:13:56,279 --> 00:13:58,800
terminal to it

323
00:13:58,800 --> 00:14:03,000
a few boot logs bootlock lines from a

324
00:14:03,000 --> 00:14:05,399
likely bootloader early stage and that's

325
00:14:05,399 --> 00:14:07,860
all no way to interrupt the boot process

326
00:14:07,860 --> 00:14:11,519
no way to feed the terminal with any

327
00:14:11,519 --> 00:14:13,920
input actually the input is just not

328
00:14:13,920 --> 00:14:15,060
accepted

329
00:14:15,060 --> 00:14:17,459
so at this point it also seems like it

330
00:14:17,459 --> 00:14:20,160
is a dead end then we can switch to a

331
00:14:20,160 --> 00:14:23,040
more drastic approach to try dumping the

332
00:14:23,040 --> 00:14:26,579
flash namely unsoldering the memory feed

333
00:14:26,579 --> 00:14:29,339
it to an expensive programmer and read

334
00:14:29,339 --> 00:14:32,940
all its bytes but the chip could be

335
00:14:32,940 --> 00:14:35,160
broken during and soldering and being

336
00:14:35,160 --> 00:14:37,260
able to put the chip back on the board

337
00:14:37,260 --> 00:14:40,339
is in no way guaranteed notably because

338
00:14:40,339 --> 00:14:43,199
I'm not that composed and assertively

339
00:14:43,199 --> 00:14:45,899
not experienced to do such

340
00:14:45,899 --> 00:14:48,360
also I didn't want to

341
00:14:48,360 --> 00:14:50,579
so at this point just like a police

342
00:14:50,579 --> 00:14:54,120
officer during an investigation I have a

343
00:14:54,120 --> 00:14:57,660
Moment of clarity maybe if I eat hard

344
00:14:57,660 --> 00:14:59,519
enough on the motherboard with an EV

345
00:14:59,519 --> 00:15:01,440
object of course he will finally confess

346
00:15:01,440 --> 00:15:02,699
to something

347
00:15:02,699 --> 00:15:04,920
of course I'm kidding yet we could see

348
00:15:04,920 --> 00:15:07,800
from the terminal messages earlier that

349
00:15:07,800 --> 00:15:09,540
the modem is likely leveraging a

350
00:15:09,540 --> 00:15:12,060
bootloader what if we could trouble such

351
00:15:12,060 --> 00:15:15,180
a bootloader when it checks for Ram for

352
00:15:15,180 --> 00:15:18,060
instance or anything else maybe we can

353
00:15:18,060 --> 00:15:21,240
trigger additional useful messages at

354
00:15:21,240 --> 00:15:23,300
least but how to

355
00:15:23,300 --> 00:15:26,880
remember when I tried to trick you into

356
00:15:26,880 --> 00:15:30,779
thinking this would be a suing Workshop

357
00:15:30,779 --> 00:15:32,639
I did not

358
00:15:32,639 --> 00:15:34,800
uh here is what I literally stumbled

359
00:15:34,800 --> 00:15:37,620
upon at this point a portable sewing kit

360
00:15:37,620 --> 00:15:39,660
left over from my girlfriend on the

361
00:15:39,660 --> 00:15:41,639
table I was walking on

362
00:15:41,639 --> 00:15:44,459
turns out sewing needles might be the

363
00:15:44,459 --> 00:15:46,500
most powerful Hardware diagnostic tool

364
00:15:46,500 --> 00:15:48,720
ever pick one start suing that

365
00:15:48,720 --> 00:15:51,600
motherboard in concrete terms I just

366
00:15:51,600 --> 00:15:53,820
tried to connect some chip pins with my

367
00:15:53,820 --> 00:15:56,820
needle while the device is running and

368
00:15:56,820 --> 00:15:58,620
triggers some short circuits expecting

369
00:15:58,620 --> 00:16:01,459
fun things to happen

370
00:16:01,620 --> 00:16:04,740
let it be known that still considered

371
00:16:04,740 --> 00:16:07,980
science first I tried to randomly Stitch

372
00:16:07,980 --> 00:16:10,500
Ram chip pins to make the ram else check

373
00:16:10,500 --> 00:16:13,620
fail it only made the power on fail and

374
00:16:13,620 --> 00:16:16,019
and nothing interesting happened

375
00:16:16,019 --> 00:16:19,320
then I uh switched to suing the flash

376
00:16:19,320 --> 00:16:21,240
tip because it's where we want to go

377
00:16:21,240 --> 00:16:24,540
anyway and the OS image is likely stored

378
00:16:24,540 --> 00:16:27,480
in such ship where One does not simply

379
00:16:27,480 --> 00:16:29,579
mess with such ship you don't want to

380
00:16:29,579 --> 00:16:33,000
accidentally trigger a memory clear pin

381
00:16:33,000 --> 00:16:35,519
from the chip so you want to carefully

382
00:16:35,519 --> 00:16:37,440
look at the data sheet from the chip

383
00:16:37,440 --> 00:16:39,360
which was also available on the internet

384
00:16:39,360 --> 00:16:42,300
and I tried at two locations on pin that

385
00:16:42,300 --> 00:16:44,940
are used to define addresses bytes in

386
00:16:44,940 --> 00:16:47,100
the memory while it is read or written

387
00:16:47,100 --> 00:16:49,199
to and I expected to prevent the

388
00:16:49,199 --> 00:16:51,660
bootloader from being able to load the

389
00:16:51,660 --> 00:16:54,540
operating system and it worked so well

390
00:16:54,540 --> 00:16:57,240
actually bootloader attempts to load the

391
00:16:57,240 --> 00:17:00,019
OS image from the Stitch flash memory

392
00:17:00,019 --> 00:17:03,180
twice fails twice and goes straight to

393
00:17:03,180 --> 00:17:05,640
the recovery position waiting for the

394
00:17:05,640 --> 00:17:09,419
911. in concrete terms it opens an

395
00:17:09,419 --> 00:17:12,000
interactive shell in the bootloader

396
00:17:12,000 --> 00:17:15,179
which is made available on the serial

397
00:17:15,179 --> 00:17:16,500
interface

398
00:17:16,500 --> 00:17:19,020
so browsing this new power we can find

399
00:17:19,020 --> 00:17:21,359
the bootloader is actually a variant of

400
00:17:21,359 --> 00:17:24,480
u-boot and apparently very common one in

401
00:17:24,480 --> 00:17:27,119
embedded devices the bootloader can

402
00:17:27,119 --> 00:17:29,220
access the flash memory because it's

403
00:17:29,220 --> 00:17:32,580
well debuted OS image is namely a Linux

404
00:17:32,580 --> 00:17:36,179
one the bootloader shell is correctly

405
00:17:36,179 --> 00:17:38,100
I'm a securely limited by the

406
00:17:38,100 --> 00:17:40,679
manufacturer and a very few commands are

407
00:17:40,679 --> 00:17:43,380
available but it is possible to read and

408
00:17:43,380 --> 00:17:45,960
display bytes from an arbitrary map with

409
00:17:45,960 --> 00:17:49,260
memory Zone which is enough to fully

410
00:17:49,260 --> 00:17:51,720
dump the flash memory

411
00:17:51,720 --> 00:17:52,980
um were actually sort of because

412
00:17:52,980 --> 00:17:55,740
additional scripting is required to

413
00:17:55,740 --> 00:17:58,200
build a memory image from packs of

414
00:17:58,200 --> 00:18:00,059
x-string data that are displayed on the

415
00:18:00,059 --> 00:18:03,120
terminal and it took four hours to read

416
00:18:03,120 --> 00:18:04,919
all the memory from the low bandwidth

417
00:18:04,919 --> 00:18:06,600
serial interface

418
00:18:06,600 --> 00:18:09,780
flash memory content is not encrypted

419
00:18:09,780 --> 00:18:12,000
and the Linux system image can be

420
00:18:12,000 --> 00:18:14,280
extracted from it we can then explore

421
00:18:14,280 --> 00:18:17,820
the modem file system offline

422
00:18:17,820 --> 00:18:20,820
starting to to dig in the Linux file

423
00:18:20,820 --> 00:18:23,340
system we can quickly find some more

424
00:18:23,340 --> 00:18:25,799
room first we can set a bootloader

425
00:18:25,799 --> 00:18:28,380
Interruption delay so we can get back to

426
00:18:28,380 --> 00:18:31,620
the bootloader by typing any K during

427
00:18:31,620 --> 00:18:34,380
the boot without any sewing

428
00:18:34,380 --> 00:18:38,520
then we can enable Linux boot blocks on

429
00:18:38,520 --> 00:18:40,500
the serial terminal so we can get

430
00:18:40,500 --> 00:18:42,600
interesting additional information about

431
00:18:42,600 --> 00:18:45,660
the memory layout while the system is

432
00:18:45,660 --> 00:18:48,900
booting last but not least digging a bit

433
00:18:48,900 --> 00:18:51,480
deeper and using the offline image we

434
00:18:51,480 --> 00:18:53,940
already have it turns out some magic

435
00:18:53,940 --> 00:18:56,520
flags from the bootloader are actually

436
00:18:56,520 --> 00:19:00,179
leverage as a configuration file in the

437
00:19:00,179 --> 00:19:04,260
final Linux system so this means by

438
00:19:04,260 --> 00:19:07,980
enabling feature or setting Flags in the

439
00:19:07,980 --> 00:19:10,679
bootloader environment we can change the

440
00:19:10,679 --> 00:19:14,580
behavior of the final Linux system

441
00:19:14,580 --> 00:19:16,980
to make that a bit more concrete as an

442
00:19:16,980 --> 00:19:19,320
arbitrary example simply setting a

443
00:19:19,320 --> 00:19:23,400
bootloader flag to an arbitrary value

444
00:19:23,400 --> 00:19:25,160
will enable

445
00:19:25,160 --> 00:19:29,280
telnet access on the land side with root

446
00:19:29,280 --> 00:19:33,120
privileges so now we can start directly

447
00:19:33,120 --> 00:19:35,520
exploring the live system while it is

448
00:19:35,520 --> 00:19:36,299
running

449
00:19:36,299 --> 00:19:39,559
with the root privilege

450
00:19:39,720 --> 00:19:42,179
and I guess that will be all for today

451
00:19:42,179 --> 00:19:44,460
at the last described modem access

452
00:19:44,460 --> 00:19:46,980
enabled of course further exploration on

453
00:19:46,980 --> 00:19:49,039
a way larger scale for instance

454
00:19:49,039 --> 00:19:52,440
proprietary binary analysis and firmware

455
00:19:52,440 --> 00:19:56,460
deployment system analysis but let's get

456
00:19:56,460 --> 00:19:59,280
realistic now even with such an access

457
00:19:59,280 --> 00:20:03,960
such hypothesis in in such backed option

458
00:20:03,960 --> 00:20:06,720
that we explored another thing just

459
00:20:06,720 --> 00:20:10,940
can't be discovered or even confirmed

460
00:20:10,940 --> 00:20:14,400
without access to proprietary data and

461
00:20:14,400 --> 00:20:17,100
logs from the network side of such

462
00:20:17,100 --> 00:20:20,400
systems which of course we don't have we

463
00:20:20,400 --> 00:20:22,679
still have a lot to find and confirm

464
00:20:22,679 --> 00:20:24,539
about the historicals we only have all

465
00:20:24,539 --> 00:20:27,480
perspective from this analysis and I

466
00:20:27,480 --> 00:20:29,640
hope we will but meanwhile try to

467
00:20:29,640 --> 00:20:31,620
demonstrate how dedicated we can be

468
00:20:31,620 --> 00:20:33,660
together knowledge on a presumably

469
00:20:33,660 --> 00:20:35,760
complex Cyber attack scenario in a short

470
00:20:35,760 --> 00:20:38,580
time and how much I can be to explore in

471
00:20:38,580 --> 00:20:39,660
such a case

472
00:20:39,660 --> 00:20:43,220
thank you again for your attention

473
00:20:43,320 --> 00:20:44,900
yeah

474
00:20:44,900 --> 00:20:49,520
but I will be happy to answer questions

475
00:20:51,840 --> 00:20:54,720
we will have time for uh one or two

476
00:20:54,720 --> 00:20:57,539
questions while we set up uh

477
00:20:57,539 --> 00:21:01,080
some kit for the next presentation does

478
00:21:01,080 --> 00:21:04,860
anybody have a question at this time

479
00:21:04,860 --> 00:21:07,580
up here

480
00:21:08,880 --> 00:21:11,340
okay it appears not then

481
00:21:11,340 --> 00:21:15,320
this time Pierre thank you very much

482
00:21:16,080 --> 00:21:20,260
[Applause]

