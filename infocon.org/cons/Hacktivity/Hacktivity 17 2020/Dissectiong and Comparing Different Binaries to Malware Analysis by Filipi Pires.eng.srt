1
00:00:01,040 --> 00:00:04,319
hello guys i'm so glad to be here

2
00:00:04,319 --> 00:00:06,720
and today we're gonna talk about the

3
00:00:06,720 --> 00:00:08,400
second and comparing

4
00:00:08,400 --> 00:00:11,759
binaries to analysis when do we

5
00:00:11,759 --> 00:00:14,400
talking about the modernizes right my

6
00:00:14,400 --> 00:00:16,720
name is felipe pierce and this is my

7
00:00:16,720 --> 00:00:18,240
contact in the twitter

8
00:00:18,240 --> 00:00:21,119
github and a medium i use a lot the

9
00:00:21,119 --> 00:00:23,600
linkaging profile

10
00:00:23,600 --> 00:00:26,400
not profile actually in social medias if

11
00:00:26,400 --> 00:00:27,519
you have

12
00:00:27,519 --> 00:00:30,880
any doubts or any questions please

13
00:00:30,880 --> 00:00:33,520
this is my contact and i am available to

14
00:00:33,520 --> 00:00:34,800
talk to you right

15
00:00:34,800 --> 00:00:38,320
so uh some information about me i have

16
00:00:38,320 --> 00:00:40,559
been working in a hacker security

17
00:00:40,559 --> 00:00:43,440
as a global research manager right this

18
00:00:43,440 --> 00:00:44,160
is the

19
00:00:44,160 --> 00:00:46,800
brazilian company i am a founder this

20
00:00:46,800 --> 00:00:47,680
course is about

21
00:00:47,680 --> 00:00:50,719
amar analysis fundamentals and

22
00:00:50,719 --> 00:00:54,160
now not actually not now i started to

23
00:00:54,160 --> 00:00:54,640
work in

24
00:00:54,640 --> 00:00:56,960
in this company zoop innovation i am

25
00:00:56,960 --> 00:00:58,800
responsible to

26
00:00:58,800 --> 00:01:02,320
zap zup security labs i am a

27
00:01:02,320 --> 00:01:05,199
research and security manager as well uh

28
00:01:05,199 --> 00:01:07,760
i'm responsible to provide many research

29
00:01:07,760 --> 00:01:11,360
in antivirals and many different sensors

30
00:01:11,360 --> 00:01:14,720
of security products right and this is a

31
00:01:14,720 --> 00:01:15,920
brazilian company

32
00:01:15,920 --> 00:01:19,119
as well and this is a

33
00:01:19,119 --> 00:01:22,240
like a software house responsible to

34
00:01:22,240 --> 00:01:25,119
create a software's apps and

35
00:01:25,119 --> 00:01:26,159
applications

36
00:01:26,159 --> 00:01:29,600
and as you can imagine the

37
00:01:29,600 --> 00:01:32,159
kind of softwares and apps right so

38
00:01:32,159 --> 00:01:33,280
here's some uh

39
00:01:33,280 --> 00:01:36,000
papers or not papers in this case it's

40
00:01:36,000 --> 00:01:37,680
article that i was

41
00:01:37,680 --> 00:01:41,200
uh wrote yeah i put publish it

42
00:01:41,200 --> 00:01:43,119
in a fantasy magazine a forensic

43
00:01:43,119 --> 00:01:44,399
magazine and

44
00:01:44,399 --> 00:01:46,960
the cyber security hub as well this is

45
00:01:46,960 --> 00:01:49,759
not um you know my idea here is not

46
00:01:49,759 --> 00:01:53,360
to hack the nscr nsa or fbi

47
00:01:53,360 --> 00:01:56,719
or you know microsoft uh my idea when i

48
00:01:56,719 --> 00:01:58,880
and i publish it this kind of articles

49
00:01:58,880 --> 00:02:00,880
is to provide some basis

50
00:02:00,880 --> 00:02:03,439
you know so my idea is to talk about the

51
00:02:03,439 --> 00:02:05,600
basis what the fundamentals

52
00:02:05,600 --> 00:02:08,560
uh is important when you talk about the

53
00:02:08,560 --> 00:02:10,318
security products or

54
00:02:10,318 --> 00:02:12,319
or more analysis or maybe trading

55
00:02:12,319 --> 00:02:13,599
hunting or maybe

56
00:02:13,599 --> 00:02:16,160
up and testing so we need to know about

57
00:02:16,160 --> 00:02:16,879
the buses

58
00:02:16,879 --> 00:02:18,879
during this our conversation now i will

59
00:02:18,879 --> 00:02:20,319
explain more about this

60
00:02:20,319 --> 00:02:23,599
right so here are not uh another papers

61
00:02:23,599 --> 00:02:24,640
that i was

62
00:02:24,640 --> 00:02:27,760
uh wrote right and you can read

63
00:02:27,760 --> 00:02:30,800
uh in my social medias or this uh

64
00:02:30,800 --> 00:02:31,840
magazine as well

65
00:02:31,840 --> 00:02:34,400
right so the first step that we need to

66
00:02:34,400 --> 00:02:36,400
do when you talk about the mara analysis

67
00:02:36,400 --> 00:02:37,519
to identify

68
00:02:37,519 --> 00:02:40,160
right uh this is that is called

69
00:02:40,160 --> 00:02:42,319
identification right because we have the

70
00:02:42,319 --> 00:02:44,000
artifact we don't know

71
00:02:44,000 --> 00:02:46,879
if the artifact is malicious not or not

72
00:02:46,879 --> 00:02:48,720
we need to understand if

73
00:02:48,720 --> 00:02:51,040
if this if this malicious or this

74
00:02:51,040 --> 00:02:52,160
artifact

75
00:02:52,160 --> 00:02:54,720
actually is malware software malicious

76
00:02:54,720 --> 00:02:56,800
or maldoc document malicious right

77
00:02:56,800 --> 00:02:59,840
this is the first and very important

78
00:02:59,840 --> 00:03:02,800
uh part right after that you can chose

79
00:03:02,800 --> 00:03:03,440
what the

80
00:03:03,440 --> 00:03:05,920
kind of analysis would you chose if you

81
00:03:05,920 --> 00:03:08,159
use static analysis or dynamical as

82
00:03:08,159 --> 00:03:10,640
analysis right after that have to

83
00:03:10,640 --> 00:03:13,200
realize or you

84
00:03:13,200 --> 00:03:16,080
executed it you can prepare a report

85
00:03:16,080 --> 00:03:17,440
right

86
00:03:17,440 --> 00:03:19,360
actually this kind of step it's very

87
00:03:19,360 --> 00:03:21,040
important because you need to present it

88
00:03:21,040 --> 00:03:21,680
to the

89
00:03:21,680 --> 00:03:23,840
your manager your tech lead your

90
00:03:23,840 --> 00:03:25,360
coordinator maybe

91
00:03:25,360 --> 00:03:27,599
and you can prepare prepare many of

92
00:03:27,599 --> 00:03:28,400
these

93
00:03:28,400 --> 00:03:30,959
informations that you analyze it before

94
00:03:30,959 --> 00:03:31,599
right

95
00:03:31,599 --> 00:03:34,319
after that you can improve your security

96
00:03:34,319 --> 00:03:35,040
defenses

97
00:03:35,040 --> 00:03:37,120
mechanism right this is the main point

98
00:03:37,120 --> 00:03:39,760
here because for example if you

99
00:03:39,760 --> 00:03:43,920
try to explore any antivirus in your

100
00:03:43,920 --> 00:03:45,280
environment right

101
00:03:45,280 --> 00:03:48,319
you maybe you can try explore

102
00:03:48,319 --> 00:03:50,959
explore many you know daily daily

103
00:03:50,959 --> 00:03:53,040
injections you can try using

104
00:03:53,040 --> 00:03:56,239
another different mower or try or maybe

105
00:03:56,239 --> 00:03:58,080
using some exploits to try

106
00:03:58,080 --> 00:04:02,000
explore your antivirus solutions

107
00:04:02,000 --> 00:04:03,920
this is a very interesting point you can

108
00:04:03,920 --> 00:04:05,439
present this to the

109
00:04:05,439 --> 00:04:08,480
our or not our your manager or

110
00:04:08,480 --> 00:04:12,879
your tech lead and when you find

111
00:04:12,879 --> 00:04:16,478
any uh for example vulnerability maybe

112
00:04:16,478 --> 00:04:20,399
bags maybe maybe uh i don't know

113
00:04:20,399 --> 00:04:22,479
filers in your softwares in your

114
00:04:22,479 --> 00:04:24,080
security software for example you can

115
00:04:24,080 --> 00:04:25,199
improve you can

116
00:04:25,199 --> 00:04:28,560
uh adjust many settings

117
00:04:28,560 --> 00:04:31,520
inside your platform right and after

118
00:04:31,520 --> 00:04:34,320
that you can prepare the beautiful world

119
00:04:34,320 --> 00:04:37,680
has no like a cyber threat intelligence

120
00:04:37,680 --> 00:04:37,919
or

121
00:04:37,919 --> 00:04:41,199
cti right you can build it you can

122
00:04:41,199 --> 00:04:43,440
build this kind of intelligence in your

123
00:04:43,440 --> 00:04:44,400
company i know

124
00:04:44,400 --> 00:04:46,400
maybe you don't have a big company you

125
00:04:46,400 --> 00:04:47,680
have a small company

126
00:04:47,680 --> 00:04:51,280
but you can work uh with for example

127
00:04:51,280 --> 00:04:55,280
iocs uh indicator of compromise or maybe

128
00:04:55,280 --> 00:04:56,960
you can works with uh

129
00:04:56,960 --> 00:05:00,720
maybe uh eor or eoa it's like a

130
00:05:00,720 --> 00:05:03,520
indicator of attack and you can build it

131
00:05:03,520 --> 00:05:06,080
right this is the main point when the

132
00:05:06,080 --> 00:05:08,800
we talk about the moronitis because you

133
00:05:08,800 --> 00:05:10,000
know when you mention

134
00:05:10,000 --> 00:05:13,039
our analysis maybe the people

135
00:05:13,039 --> 00:05:15,520
that was watching me now maybe are

136
00:05:15,520 --> 00:05:17,120
thinking for example

137
00:05:17,120 --> 00:05:20,080
okay if i have this kind of

138
00:05:20,080 --> 00:05:20,880
knowledgement

139
00:05:20,880 --> 00:05:23,039
maybe i can work as in a sock or maybe

140
00:05:23,039 --> 00:05:24,320
on a support

141
00:05:24,320 --> 00:05:27,120
but you can receive this kind of

142
00:05:27,120 --> 00:05:28,800
acknowledgement and you can improve it

143
00:05:28,800 --> 00:05:29,199
it

144
00:05:29,199 --> 00:05:30,720
you can work for example athletic

145
00:05:30,720 --> 00:05:33,120
hunting or for the hunter or the person

146
00:05:33,120 --> 00:05:33,919
that

147
00:05:33,919 --> 00:05:35,680
realizes or is equal to this kind of

148
00:05:35,680 --> 00:05:38,080
work right or you can maybe

149
00:05:38,080 --> 00:05:41,600
uh do this research has has me for

150
00:05:41,600 --> 00:05:42,320
example

151
00:05:42,320 --> 00:05:45,360
because i am creating this in my uh

152
00:05:45,360 --> 00:05:48,400
my company now and in hakasaki and

153
00:05:48,400 --> 00:05:51,120
uh zoop innovation as well and my idea

154
00:05:51,120 --> 00:05:51,520
to put

155
00:05:51,520 --> 00:05:54,479
this kind of uh professional guy this is

156
00:05:54,479 --> 00:05:57,039
the mower hunter in a top of the tower

157
00:05:57,039 --> 00:05:57,520
right

158
00:05:57,520 --> 00:06:00,160
the idea is to put in the research guy

159
00:06:00,160 --> 00:06:01,440
in the top of the tower

160
00:06:01,440 --> 00:06:03,600
this is my idea you know because when

161
00:06:03,600 --> 00:06:04,560
you talk

162
00:06:04,560 --> 00:06:06,400
uh for example with many companies in

163
00:06:06,400 --> 00:06:07,919
the world for example

164
00:06:07,919 --> 00:06:11,360
uh the the this kind of person or this

165
00:06:11,360 --> 00:06:13,520
this you know this is a skill is it's

166
00:06:13,520 --> 00:06:14,479
not clear

167
00:06:14,479 --> 00:06:16,720
if this guy's working with a sock with a

168
00:06:16,720 --> 00:06:17,680
sazad uh

169
00:06:17,680 --> 00:06:20,880
in a you know for example in in cesare

170
00:06:20,880 --> 00:06:24,000
or maybe in a support team

171
00:06:24,000 --> 00:06:27,199
or maybe in a red team or or blue team

172
00:06:27,199 --> 00:06:29,199
you know it's it's maybe a confusion

173
00:06:29,199 --> 00:06:31,120
it's many companies so this is my idea

174
00:06:31,120 --> 00:06:32,880
to put in the top of tower because this

175
00:06:32,880 --> 00:06:33,520
guy

176
00:06:33,520 --> 00:06:36,880
have a defensive you know essentially

177
00:06:36,880 --> 00:06:37,440
but

178
00:06:37,440 --> 00:06:39,680
they think the mind it's totally

179
00:06:39,680 --> 00:06:41,600
offensive that's my idea right

180
00:06:41,600 --> 00:06:45,360
and after that you can create the uh uh

181
00:06:45,360 --> 00:06:48,319
the strengthening yes that your cyber

182
00:06:48,319 --> 00:06:50,479
resilience because the threats

183
00:06:50,479 --> 00:06:53,599
are changing all the time right this is

184
00:06:53,599 --> 00:06:57,360
maybe a not a life cycle of the

185
00:06:57,360 --> 00:07:00,880
morales but it's a suggestion

186
00:07:00,880 --> 00:07:05,039
right it's one idea you know that's my

187
00:07:05,039 --> 00:07:06,880
suggestion for you right so the first

188
00:07:06,880 --> 00:07:09,120
step is static analysis it's very

189
00:07:09,120 --> 00:07:11,599
simple usually this is the first step

190
00:07:11,599 --> 00:07:12,720
use it by

191
00:07:12,720 --> 00:07:15,919
uh mar analysts yes because this is

192
00:07:15,919 --> 00:07:16,639
usually

193
00:07:16,639 --> 00:07:19,919
it's described of the process of the the

194
00:07:19,919 --> 00:07:20,560
the

195
00:07:20,560 --> 00:07:23,280
some programs maybe the structure or

196
00:07:23,280 --> 00:07:24,720
maybe what the

197
00:07:24,720 --> 00:07:27,919
function function it is called by

198
00:07:27,919 --> 00:07:31,520
any dll or maybe call it by any

199
00:07:31,520 --> 00:07:34,240
a library for example if you are

200
00:07:34,240 --> 00:07:36,000
analysing

201
00:07:36,000 --> 00:07:39,120
for example a unix platform right

202
00:07:39,120 --> 00:07:42,000
and usually this program itself it

203
00:07:42,000 --> 00:07:42,560
doesn't

204
00:07:42,560 --> 00:07:44,879
run at this time right because of course

205
00:07:44,879 --> 00:07:46,720
it's the painting of the program

206
00:07:46,720 --> 00:07:49,280
that you can for example using your

207
00:07:49,280 --> 00:07:50,400
analysis but

208
00:07:50,400 --> 00:07:53,199
usually it's more safe right because

209
00:07:53,199 --> 00:07:53,919
it's not

210
00:07:53,919 --> 00:07:56,639
100 safe but usually it's more safe

211
00:07:56,639 --> 00:07:57,280
because

212
00:07:57,280 --> 00:08:01,360
you not put in in real time right the

213
00:08:01,360 --> 00:08:03,599
analysis it's not in real time that's a

214
00:08:03,599 --> 00:08:05,440
a simple point here

215
00:08:05,440 --> 00:08:07,120
when you talk about the statistic

216
00:08:07,120 --> 00:08:09,199
analysis right the second step

217
00:08:09,199 --> 00:08:12,319
is dynamic analysis just to explain for

218
00:08:12,319 --> 00:08:14,080
everyone that was watching now

219
00:08:14,080 --> 00:08:17,039
right the dynamic the dynamic analysis

220
00:08:17,039 --> 00:08:18,080
it's based

221
00:08:18,080 --> 00:08:20,720
as just in in behavior right uh

222
00:08:20,720 --> 00:08:22,400
basically the interactions that the

223
00:08:22,400 --> 00:08:23,039
mower

224
00:08:23,039 --> 00:08:26,080
uh has with them the

225
00:08:26,080 --> 00:08:28,800
the files inside the the the systems

226
00:08:28,800 --> 00:08:29,599
operation

227
00:08:29,599 --> 00:08:33,200
or maybe what the um the document maybe

228
00:08:33,200 --> 00:08:36,559
uh this file can call it

229
00:08:36,559 --> 00:08:38,958
but usually you put in the sample inside

230
00:08:38,958 --> 00:08:40,080
of the virtual

231
00:08:40,080 --> 00:08:43,360
machine one environment controller right

232
00:08:43,360 --> 00:08:45,120
you run this sample inside this

233
00:08:45,120 --> 00:08:47,760
environment and you can analyze this

234
00:08:47,760 --> 00:08:51,200
behavior right so usually you can auto

235
00:08:51,200 --> 00:08:54,640
you can automatizate that many this

236
00:08:54,640 --> 00:08:57,440
kind of uh analysis right because you

237
00:08:57,440 --> 00:08:58,080
can

238
00:08:58,080 --> 00:09:01,040
today you have a many websites with uh

239
00:09:01,040 --> 00:09:02,240
antivirus

240
00:09:02,240 --> 00:09:05,440
engine engines to try execute your

241
00:09:05,440 --> 00:09:07,920
suspicious files right and you or you

242
00:09:07,920 --> 00:09:10,000
can create you can use it as well

243
00:09:10,000 --> 00:09:13,279
the another concept called sandbox this

244
00:09:13,279 --> 00:09:13,839
is the

245
00:09:13,839 --> 00:09:15,279
basically it's a controlled environment

246
00:09:15,279 --> 00:09:18,080
that you can put your your sample inside

247
00:09:18,080 --> 00:09:21,040
this product for example you can run and

248
00:09:21,040 --> 00:09:22,320
you can look in the

249
00:09:22,320 --> 00:09:26,480
all uh dlls and many informations

250
00:09:26,480 --> 00:09:29,200
are called but the big point the very

251
00:09:29,200 --> 00:09:30,480
important thing here

252
00:09:30,480 --> 00:09:33,839
is okay i put my sample inside this

253
00:09:33,839 --> 00:09:34,800
sandbox

254
00:09:34,800 --> 00:09:38,480
but what the response what the answer

255
00:09:38,480 --> 00:09:41,920
are receiving report i can't

256
00:09:41,920 --> 00:09:44,959
i can't understand what the the dll are

257
00:09:44,959 --> 00:09:46,959
called because i understand very well

258
00:09:46,959 --> 00:09:49,440
in low level in the kernel level or the

259
00:09:49,440 --> 00:09:50,560
user level

260
00:09:50,560 --> 00:09:52,640
uh you know i can understand this

261
00:09:52,640 --> 00:09:53,760
because you know i have the

262
00:09:53,760 --> 00:09:55,440
automatization tool but

263
00:09:55,440 --> 00:09:57,360
i need to interpreter i need to turn

264
00:09:57,360 --> 00:09:59,120
like a translate not translate but you

265
00:09:59,120 --> 00:10:00,800
need to understand what this

266
00:10:00,800 --> 00:10:03,600
report is talking you know that's very

267
00:10:03,600 --> 00:10:04,079
important

268
00:10:04,079 --> 00:10:06,560
thing because of this that's my mission

269
00:10:06,560 --> 00:10:07,440
now here

270
00:10:07,440 --> 00:10:10,800
to try explain some basis for you right

271
00:10:10,800 --> 00:10:13,120
so okay so here i have a demo are you

272
00:10:13,120 --> 00:10:15,120
showing my machine by the way

273
00:10:15,120 --> 00:10:18,079
okay so i will try put here i will call

274
00:10:18,079 --> 00:10:19,120
i will pray

275
00:10:19,120 --> 00:10:22,640
to the you know to the the the lords of

276
00:10:22,640 --> 00:10:25,519
demo to try let me check here i have

277
00:10:25,519 --> 00:10:25,920
here

278
00:10:25,920 --> 00:10:28,240
some samples right i have by the way

279
00:10:28,240 --> 00:10:30,880
here file linux

280
00:10:30,880 --> 00:10:34,480
32 yes this is that a simple

281
00:10:34,480 --> 00:10:38,000
uh executable file right so if i check

282
00:10:38,000 --> 00:10:41,680
here another in a wheel machine machine

283
00:10:41,680 --> 00:10:43,920
let me check here what i have here a

284
00:10:43,920 --> 00:10:46,399
simple file okay let me check here

285
00:10:46,399 --> 00:10:49,519
if i use file command i can find here

286
00:10:49,519 --> 00:10:52,480
the the in this case it's a portable

287
00:10:52,480 --> 00:10:53,680
executable

288
00:10:53,680 --> 00:10:56,320
from uh windows from microsoft right so

289
00:10:56,320 --> 00:10:58,000
you have different

290
00:10:58,000 --> 00:11:00,560
files here's to understand if it's

291
00:11:00,560 --> 00:11:02,880
malicious or not let me check

292
00:11:02,880 --> 00:11:05,839
here i have another different here um

293
00:11:05,839 --> 00:11:06,480
let me check

294
00:11:06,480 --> 00:11:09,760
here i have a view let me check here

295
00:11:09,760 --> 00:11:11,200
bill

296
00:11:11,200 --> 00:11:14,240
bill file build

297
00:11:14,240 --> 00:11:16,880
this is a pdf file right it's a pdf file

298
00:11:16,880 --> 00:11:17,440
okay

299
00:11:17,440 --> 00:11:20,160
so but here i would like to try uh

300
00:11:20,160 --> 00:11:21,600
explain about the basis

301
00:11:21,600 --> 00:11:24,959
right because we're gonna talk about

302
00:11:24,959 --> 00:11:27,519
file command right i don't know if you

303
00:11:27,519 --> 00:11:28,240
uh

304
00:11:28,240 --> 00:11:31,360
read something about this but what means

305
00:11:31,360 --> 00:11:34,240
what that's what means fire in this case

306
00:11:34,240 --> 00:11:36,240
fire determine fire type yeah i know

307
00:11:36,240 --> 00:11:39,360
philip but how this

308
00:11:39,360 --> 00:11:42,399
kind of tools or this tool in that case

309
00:11:42,399 --> 00:11:43,200
in this case

310
00:11:43,200 --> 00:11:46,000
works that's a a simple and very

311
00:11:46,000 --> 00:11:47,600
important point right

312
00:11:47,600 --> 00:11:50,000
because when you when you put this

313
00:11:50,000 --> 00:11:52,079
command inside your machine

314
00:11:52,079 --> 00:11:56,240
this a file or this tool actually

315
00:11:56,240 --> 00:11:59,040
you run or are running your environment

316
00:11:59,040 --> 00:12:00,399
and you show

317
00:12:00,399 --> 00:12:03,200
some answered right in that you know in

318
00:12:03,200 --> 00:12:04,720
the in the screen

319
00:12:04,720 --> 00:12:07,920
but how this tools works that's

320
00:12:07,920 --> 00:12:09,680
that's important because if you read

321
00:12:09,680 --> 00:12:11,200
here if you read

322
00:12:11,200 --> 00:12:13,200
here you can can read here the message

323
00:12:13,200 --> 00:12:14,800
tests are used to check

324
00:12:14,800 --> 00:12:18,000
for files each data in particular fixed

325
00:12:18,000 --> 00:12:19,200
format

326
00:12:19,200 --> 00:12:22,480
maybe you can maybe you are thinking now

327
00:12:22,480 --> 00:12:25,920
and and maybe uh i don't know i know

328
00:12:25,920 --> 00:12:29,040
philippis show me about the men of files

329
00:12:29,040 --> 00:12:31,120
but here you can understand something

330
00:12:31,120 --> 00:12:33,680
because here you can understand

331
00:12:33,680 --> 00:12:37,120
those format is defined in elf doc h

332
00:12:37,120 --> 00:12:38,800
so maybe here we have interesting

333
00:12:38,800 --> 00:12:40,560
information if you

334
00:12:40,560 --> 00:12:44,399
let me for example if you check here

335
00:12:44,399 --> 00:12:47,839
for example if i put here for example

336
00:12:47,839 --> 00:12:52,000
no no

337
00:12:52,000 --> 00:12:54,880
you know let me

338
00:12:55,680 --> 00:12:59,440
oh yes i will open okay so here you can

339
00:12:59,440 --> 00:13:02,079
if you see here this information right

340
00:13:02,079 --> 00:13:02,959
that i was

341
00:13:02,959 --> 00:13:06,480
receiving here in demo from file

342
00:13:06,480 --> 00:13:09,200
you can read here this file defines the

343
00:13:09,200 --> 00:13:09,920
standard

344
00:13:09,920 --> 00:13:13,279
elf types structure in macros

345
00:13:13,279 --> 00:13:16,320
right and here below you can

346
00:13:16,320 --> 00:13:18,399
read another informations about the

347
00:13:18,399 --> 00:13:19,680
structure because

348
00:13:19,680 --> 00:13:22,079
here in the beginning you can read here

349
00:13:22,079 --> 00:13:24,079
the elf files header

350
00:13:24,079 --> 00:13:27,680
this appears at the start of every elf

351
00:13:27,680 --> 00:13:31,600
file right you have here 16 bytes

352
00:13:31,600 --> 00:13:34,560
the first array of the name e identity

353
00:13:34,560 --> 00:13:36,560
and you have the magic number and

354
00:13:36,560 --> 00:13:39,920
others information so we have here

355
00:13:39,920 --> 00:13:42,959
for example the magic number so what are

356
00:13:42,959 --> 00:13:45,760
what means this in this case uh magic

357
00:13:45,760 --> 00:13:46,639
number here

358
00:13:46,639 --> 00:13:49,920
you have the key right so these files

359
00:13:49,920 --> 00:13:50,399
have

360
00:13:50,399 --> 00:13:53,440
a magic number is stored in particular

361
00:13:53,440 --> 00:13:54,639
place near

362
00:13:54,639 --> 00:13:57,680
the beginning of the file that tells the

363
00:13:57,680 --> 00:13:58,240
unix

364
00:13:58,240 --> 00:14:02,240
operation systems right so what's

365
00:14:02,240 --> 00:14:05,440
what this means in this case it's very

366
00:14:05,440 --> 00:14:06,240
simple

367
00:14:06,240 --> 00:14:08,880
the file command has a database

368
00:14:08,880 --> 00:14:10,399
responsible to provide

369
00:14:10,399 --> 00:14:13,600
all this information to find all these

370
00:14:13,600 --> 00:14:16,399
all those magic number in the beginning

371
00:14:16,399 --> 00:14:17,920
of the fire right

372
00:14:17,920 --> 00:14:21,199
so here if you i will show you now here

373
00:14:21,199 --> 00:14:22,160
for example

374
00:14:22,160 --> 00:14:25,360
i have here the i i downloaded this

375
00:14:25,360 --> 00:14:28,959
this uh this file this

376
00:14:28,959 --> 00:14:32,560
file a code to to look inside this to

377
00:14:32,560 --> 00:14:33,199
show you

378
00:14:33,199 --> 00:14:36,000
this information right so here we can

379
00:14:36,000 --> 00:14:38,079
read you can read many informations

380
00:14:38,079 --> 00:14:38,560
here's

381
00:14:38,560 --> 00:14:40,720
of many information of this kind of

382
00:14:40,720 --> 00:14:42,240
database for example

383
00:14:42,240 --> 00:14:45,600
if you for example read the information

384
00:14:45,600 --> 00:14:45,839
of

385
00:14:45,839 --> 00:14:49,040
javascript in this case here okay so

386
00:14:49,040 --> 00:14:52,000
javascript let me show you for you here

387
00:14:52,000 --> 00:14:53,680
javascript we have here many

388
00:14:53,680 --> 00:14:55,440
informations in the beginning of the

389
00:14:55,440 --> 00:14:56,079
file

390
00:14:56,079 --> 00:14:58,320
in this case is the magic number of the

391
00:14:58,320 --> 00:14:59,279
fire having

392
00:14:59,279 --> 00:15:02,480
many rules here that you could use

393
00:15:02,480 --> 00:15:05,839
you that basically this file command

394
00:15:05,839 --> 00:15:08,880
used to identify the fi they are defined

395
00:15:08,880 --> 00:15:09,839
in this case

396
00:15:09,839 --> 00:15:13,199
if is executable or not right

397
00:15:13,199 --> 00:15:16,480
so let me show you some example now here

398
00:15:16,480 --> 00:15:20,560
you create this file the name our doctex

399
00:15:20,560 --> 00:15:24,319
that's just a text right

400
00:15:25,279 --> 00:15:26,730
is it malicious

401
00:15:26,730 --> 00:15:29,789
[Music]

402
00:15:30,240 --> 00:15:33,600
let me right here okay this is a simple

403
00:15:33,600 --> 00:15:35,839
question

404
00:15:35,839 --> 00:15:38,959
have you read this information in this

405
00:15:38,959 --> 00:15:40,720
case

406
00:15:40,720 --> 00:15:44,000
perfect let me use file command here

407
00:15:44,000 --> 00:15:46,399
it's really really text file right

408
00:15:46,399 --> 00:15:47,120
perfect

409
00:15:47,120 --> 00:15:50,160
so for example if i manipulate the

410
00:15:50,160 --> 00:15:52,560
magic number information here let me

411
00:15:52,560 --> 00:15:54,880
manipulate here i will put some string

412
00:15:54,880 --> 00:15:55,759
here

413
00:15:55,759 --> 00:15:58,800
that i know what this information means

414
00:15:58,800 --> 00:16:01,199
i will change here and i use the file

415
00:16:01,199 --> 00:16:02,720
again

416
00:16:02,720 --> 00:16:06,320
context dot text and let me check here

417
00:16:06,320 --> 00:16:08,000
and here

418
00:16:08,000 --> 00:16:11,199
looking this incredible information now

419
00:16:11,199 --> 00:16:14,000
we have a python script in this case is

420
00:16:14,000 --> 00:16:14,399
as it

421
00:16:14,399 --> 00:16:17,519
is a creatable file right so if is

422
00:16:17,519 --> 00:16:19,360
executable i can

423
00:16:19,360 --> 00:16:22,480
call it i can call me python

424
00:16:22,480 --> 00:16:24,720
after you think about it so i can call

425
00:16:24,720 --> 00:16:26,880
on not python python text

426
00:16:26,880 --> 00:16:29,680
in this case

427
00:16:30,639 --> 00:16:33,759
text because it's python right

428
00:16:33,759 --> 00:16:37,680
show you let me read again this file

429
00:16:37,680 --> 00:16:41,519
yes but we have a problem maybe you can

430
00:16:41,519 --> 00:16:43,600
think about it some but the station here

431
00:16:43,600 --> 00:16:45,440
is different right let's let me

432
00:16:45,440 --> 00:16:48,399
uh because i have another python here in

433
00:16:48,399 --> 00:16:51,120
the other representations i will

434
00:16:51,120 --> 00:16:55,680
okay so i have a key i have here

435
00:16:55,680 --> 00:17:00,800
yes okay so let me change now here mower

436
00:17:00,959 --> 00:17:04,959
let me move from our text to the malware

437
00:17:04,959 --> 00:17:08,000
dot pi right so here

438
00:17:08,000 --> 00:17:12,000
we gonna buy so in this case we can run

439
00:17:12,000 --> 00:17:12,799
now

440
00:17:12,799 --> 00:17:17,280
just buy maybe you need to have you need

441
00:17:17,280 --> 00:17:19,839
to have

442
00:17:19,839 --> 00:17:22,559
the authorization that the privilege to

443
00:17:22,559 --> 00:17:24,000
to execute this kind of information

444
00:17:24,000 --> 00:17:24,720
maybe

445
00:17:24,720 --> 00:17:28,880
let me change here okay so now let's

446
00:17:28,880 --> 00:17:32,720
python again and let's check is the same

447
00:17:32,720 --> 00:17:34,799
error why did this happen because it's

448
00:17:34,799 --> 00:17:36,480
not a script python right

449
00:17:36,480 --> 00:17:38,000
if you for example you can manipulate

450
00:17:38,000 --> 00:17:41,120
again uh this information here

451
00:17:41,120 --> 00:17:43,600
it's very interesting point another

452
00:17:43,600 --> 00:17:44,320
again

453
00:17:44,320 --> 00:17:47,360
let me move again and pour send pdf

454
00:17:47,360 --> 00:17:50,799
truss maybe slash oh oh dash

455
00:17:50,799 --> 00:17:53,919
actually 1.9

456
00:17:53,919 --> 00:17:57,760
and i will save here and i you clean

457
00:17:57,760 --> 00:18:00,960
and let me check here mower pointer pi

458
00:18:00,960 --> 00:18:03,440
dock by it's a pdf document take a look

459
00:18:03,440 --> 00:18:05,200
at the very interesting you know

460
00:18:05,200 --> 00:18:07,919
that's a big point here uh maybe you can

461
00:18:07,919 --> 00:18:08,640
ask

462
00:18:08,640 --> 00:18:11,280
so philip now the file commander is not

463
00:18:11,280 --> 00:18:11,840
confident

464
00:18:11,840 --> 00:18:15,039
it's not uh you know it's not a

465
00:18:15,039 --> 00:18:16,000
confidence con

466
00:18:16,000 --> 00:18:18,240
comment i can use this kind of comment

467
00:18:18,240 --> 00:18:19,600
no you need to use

468
00:18:19,600 --> 00:18:22,080
right but you need to understand all

469
00:18:22,080 --> 00:18:22,720
those days

470
00:18:22,720 --> 00:18:24,080
right this is the very important thing

471
00:18:24,080 --> 00:18:25,760
you never need you never

472
00:18:25,760 --> 00:18:29,120
can believe in the extension uh because

473
00:18:29,120 --> 00:18:31,200
of course you it's the same case when

474
00:18:31,200 --> 00:18:33,200
you talk about the strings for example

475
00:18:33,200 --> 00:18:35,120
if you see here the strings demand of

476
00:18:35,120 --> 00:18:38,160
the strings for example here

477
00:18:38,160 --> 00:18:41,120
the strings comment right so let me

478
00:18:41,120 --> 00:18:41,440
check

479
00:18:41,440 --> 00:18:44,640
here is strings

480
00:18:44,640 --> 00:18:48,320
command string printed the sequence of

481
00:18:48,320 --> 00:18:49,919
printable characters in

482
00:18:49,919 --> 00:18:53,280
file right so here's the the simple key

483
00:18:53,280 --> 00:18:56,960
the many many people never think

484
00:18:56,960 --> 00:18:58,720
maybe because in the beginning of the

485
00:18:58,720 --> 00:19:00,000
description uh

486
00:19:00,000 --> 00:19:02,799
says for example for each file given you

487
00:19:02,799 --> 00:19:03,120
know

488
00:19:03,120 --> 00:19:05,280
strings print the printable character

489
00:19:05,280 --> 00:19:06,240
sequence that

490
00:19:06,240 --> 00:19:09,679
are at least four characteristics

491
00:19:09,679 --> 00:19:12,559
long because of this you when do you as

492
00:19:12,559 --> 00:19:14,400
i could for example here

493
00:19:14,400 --> 00:19:18,000
um a string in strings

494
00:19:18,000 --> 00:19:21,760
that they may be you is it for example

495
00:19:21,760 --> 00:19:24,480
in the beginning of this the many

496
00:19:24,480 --> 00:19:26,160
comments for example you

497
00:19:26,160 --> 00:19:29,280
you don't you you don't find for example

498
00:19:29,280 --> 00:19:32,000
the elf information or mz information on

499
00:19:32,000 --> 00:19:32,720
the pe

500
00:19:32,720 --> 00:19:35,280
information right for example here if

501
00:19:35,280 --> 00:19:36,480
you

502
00:19:36,480 --> 00:19:39,840
read here the x damp any let me check

503
00:19:39,840 --> 00:19:41,840
here any 32

504
00:19:41,840 --> 00:19:47,200
um the linux 32

505
00:19:47,200 --> 00:19:50,000
but less okay in the beginning you can

506
00:19:50,000 --> 00:19:51,520
you can read here the elf

507
00:19:51,520 --> 00:19:54,320
right so but here you have a just three

508
00:19:54,320 --> 00:19:54,640
la

509
00:19:54,640 --> 00:19:57,280
three characters not four in this case

510
00:19:57,280 --> 00:19:57,919
right

511
00:19:57,919 --> 00:20:01,760
so if you try here for example

512
00:20:01,760 --> 00:20:04,240
let me change here if you train if you

513
00:20:04,240 --> 00:20:05,200
change it should

514
00:20:05,200 --> 00:20:08,720
if you try for example run the strings

515
00:20:08,720 --> 00:20:12,000
uh dash a putting in the

516
00:20:12,000 --> 00:20:15,919
linux let me put pipe here

517
00:20:15,919 --> 00:20:19,039
but like last sec here

518
00:20:19,039 --> 00:20:22,000
and you put pipelines here and you if

519
00:20:22,000 --> 00:20:22,720
you try

520
00:20:22,720 --> 00:20:25,840
oops maybe s3's receive some red horse

521
00:20:25,840 --> 00:20:26,799
here

522
00:20:26,799 --> 00:20:29,840
oh of course i need to put the

523
00:20:29,840 --> 00:20:34,240
fire correct yes so here if you put here

524
00:20:34,240 --> 00:20:37,440
in the beginning take a look here you

525
00:20:37,440 --> 00:20:40,080
you don't find here the beginning the

526
00:20:40,080 --> 00:20:42,000
elf information because alfie just said

527
00:20:42,000 --> 00:20:43,200
three characters not

528
00:20:43,200 --> 00:20:46,400
four characters that is important thing

529
00:20:46,400 --> 00:20:49,520
right this is all those bases right

530
00:20:49,520 --> 00:20:51,200
that's very important when you mention

531
00:20:51,200 --> 00:20:52,159
here right

532
00:20:52,159 --> 00:20:55,600
so we explain more than uh elf

533
00:20:55,600 --> 00:20:57,919
now so basically when you talk about the

534
00:20:57,919 --> 00:20:58,799
structure

535
00:20:58,799 --> 00:21:01,919
about the elf or maybe pe portable is

536
00:21:01,919 --> 00:21:02,880
equitable

537
00:21:02,880 --> 00:21:05,280
you can see in the pictures it's the

538
00:21:05,280 --> 00:21:07,280
similar

539
00:21:07,280 --> 00:21:10,480
form not exactly the same but very very

540
00:21:10,480 --> 00:21:11,280
similar

541
00:21:11,280 --> 00:21:13,919
because you have the same header you

542
00:21:13,919 --> 00:21:15,679
have the sessions here

543
00:21:15,679 --> 00:21:18,880
in the txt or uh and

544
00:21:18,880 --> 00:21:21,919
doc or dot dot dot

545
00:21:21,919 --> 00:21:24,480
oh my goodness you have the text you

546
00:21:24,480 --> 00:21:24,960
have

547
00:21:24,960 --> 00:21:28,559
uh a or data you have the data in you

548
00:21:28,559 --> 00:21:31,360
and you have uh many sessions heather in

549
00:21:31,360 --> 00:21:32,480
the pa

550
00:21:32,480 --> 00:21:35,840
portable we have for example the the two

551
00:21:35,840 --> 00:21:38,960
uh parts first right the header in the

552
00:21:38,960 --> 00:21:39,760
sessions

553
00:21:39,760 --> 00:21:42,080
of course it's dividing you on other

554
00:21:42,080 --> 00:21:42,799
parts

555
00:21:42,799 --> 00:21:45,760
and you have for example in in inside

556
00:21:45,760 --> 00:21:46,880
the header you have

557
00:21:46,880 --> 00:21:50,000
the dos header when you can see the mz

558
00:21:50,000 --> 00:21:52,320
information the signature mz

559
00:21:52,320 --> 00:21:54,559
right when basically it's responsible to

560
00:21:54,559 --> 00:21:56,240
the creator of this

561
00:21:56,240 --> 00:21:59,520
kind of binary and you have here

562
00:21:59,520 --> 00:22:02,880
the pe header when you can find

563
00:22:02,880 --> 00:22:06,400
the pe signature this information

564
00:22:06,400 --> 00:22:09,760
and below you can see the sessions here

565
00:22:09,760 --> 00:22:11,840
is the informations where they usually

566
00:22:11,840 --> 00:22:14,400
the attacker can put your malicious code

567
00:22:14,400 --> 00:22:17,520
usually inside this session docs text

568
00:22:17,520 --> 00:22:21,919
right and when you

569
00:22:21,919 --> 00:22:25,039
try to analyze any artifacts for example

570
00:22:25,039 --> 00:22:28,559
you can find the upx compressed or maybe

571
00:22:28,559 --> 00:22:30,240
a packer

572
00:22:30,240 --> 00:22:32,400
tools this is a technique maybe many

573
00:22:32,400 --> 00:22:34,320
times the attackers can be using

574
00:22:34,320 --> 00:22:37,840
us many different attackers usually

575
00:22:37,840 --> 00:22:40,480
the packer can he absolute all those in

576
00:22:40,480 --> 00:22:41,600
the sessions inside

577
00:22:41,600 --> 00:22:43,840
in one of those uh packer basic

578
00:22:43,840 --> 00:22:45,600
basically and you can

579
00:22:45,600 --> 00:22:48,720
when you use some tools to try and

580
00:22:48,720 --> 00:22:51,840
find some information you will find

581
00:22:51,840 --> 00:22:55,440
for example the packer information right

582
00:22:55,440 --> 00:22:59,200
do you you don't you can't see

583
00:22:59,200 --> 00:23:02,400
this information in the session right so

584
00:23:02,400 --> 00:23:03,120
okay

585
00:23:03,120 --> 00:23:06,480
so we talk about the pe and alpha

586
00:23:06,480 --> 00:23:08,000
structure of course it's very

587
00:23:08,000 --> 00:23:11,440
very simple uh we i can't uh i don't

588
00:23:11,440 --> 00:23:14,000
have a time actually to explain all this

589
00:23:14,000 --> 00:23:16,799
uh binaries because you know uh if you

590
00:23:16,799 --> 00:23:18,880
talk about the for example just a pe

591
00:23:18,880 --> 00:23:21,919
portable executable from microsoft man

592
00:23:21,919 --> 00:23:23,280
we have a many

593
00:23:23,280 --> 00:23:26,960
many hours to try explaining and to try

594
00:23:26,960 --> 00:23:29,520
uh goes to inside this all this

595
00:23:29,520 --> 00:23:31,120
information right so i will try to

596
00:23:31,120 --> 00:23:32,159
explain more

597
00:23:32,159 --> 00:23:34,880
than pdf structure because basically

598
00:23:34,880 --> 00:23:35,200
it's

599
00:23:35,200 --> 00:23:38,400
it's in four main parts the header it's

600
00:23:38,400 --> 00:23:38,799
made

601
00:23:38,799 --> 00:23:41,200
baby it's basic basically it's the same

602
00:23:41,200 --> 00:23:43,039
when you talk about another binaries we

603
00:23:43,039 --> 00:23:43,440
have

604
00:23:43,440 --> 00:23:45,600
always you have the header right you

605
00:23:45,600 --> 00:23:46,480
have the boring

606
00:23:46,480 --> 00:23:48,480
you have the cross reference table and

607
00:23:48,480 --> 00:23:50,080
you have the trailer right

608
00:23:50,080 --> 00:23:52,720
so here we have the all those structure

609
00:23:52,720 --> 00:23:54,480
in the beginning of the file you have

610
00:23:54,480 --> 00:23:55,360
the version

611
00:23:55,360 --> 00:23:57,679
number it's the same information

612
00:23:57,679 --> 00:23:59,120
collected by

613
00:23:59,120 --> 00:24:01,120
file command do you remember when you

614
00:24:01,120 --> 00:24:04,559
execute the file command you can read

615
00:24:04,559 --> 00:24:08,000
you can read actually the magical number

616
00:24:08,000 --> 00:24:09,840
of this information you can find this

617
00:24:09,840 --> 00:24:10,720
information

618
00:24:10,720 --> 00:24:12,880
you have the body and inside this kind

619
00:24:12,880 --> 00:24:13,919
of body

620
00:24:13,919 --> 00:24:16,720
you know you have many reference inside

621
00:24:16,720 --> 00:24:17,360
of this

622
00:24:17,360 --> 00:24:19,279
body you have the cross reference table

623
00:24:19,279 --> 00:24:22,240
here and you can read here it's locate

624
00:24:22,240 --> 00:24:25,919
location of object ethernet the file

625
00:24:25,919 --> 00:24:29,520
or a random access what else

626
00:24:29,520 --> 00:24:33,039
what as what this the things means

627
00:24:33,039 --> 00:24:36,400
in this case is basically one structure

628
00:24:36,400 --> 00:24:39,760
referring another instructor or another

629
00:24:39,760 --> 00:24:43,200
object inside this bar in this case

630
00:24:43,200 --> 00:24:43,760
right

631
00:24:43,760 --> 00:24:46,799
in the trailer it's the same thing

632
00:24:46,799 --> 00:24:49,600
you have here uh location of the certain

633
00:24:49,600 --> 00:24:50,240
objects

634
00:24:50,240 --> 00:24:53,919
inside the body that is

635
00:24:53,919 --> 00:24:57,039
you have many connections of this parts

636
00:24:57,039 --> 00:25:00,080
of this structure right so here

637
00:25:00,080 --> 00:25:03,279
i will show you one of mine's

638
00:25:03,279 --> 00:25:06,159
my analysis in a pdf file right to try

639
00:25:06,159 --> 00:25:06,880
and understand

640
00:25:06,880 --> 00:25:09,600
how you use basically here i used the

641
00:25:09,600 --> 00:25:10,880
pdf id

642
00:25:10,880 --> 00:25:14,159
it's very tools it's very known tools uh

643
00:25:14,159 --> 00:25:18,000
provided by dda stevens right this is

644
00:25:18,000 --> 00:25:20,559
basically i think it's in being

645
00:25:20,559 --> 00:25:23,039
installed in many unix platform

646
00:25:23,039 --> 00:25:24,799
but you can download this information in

647
00:25:24,799 --> 00:25:26,640
the blog website from

648
00:25:26,640 --> 00:25:29,919
dj stevens as you can use this in

649
00:25:29,919 --> 00:25:33,520
windows in windows machines

650
00:25:33,520 --> 00:25:36,320
sorry we have problem here with my demo

651
00:25:36,320 --> 00:25:37,200
let me

652
00:25:37,200 --> 00:25:40,159
try here okay i will pause actually this

653
00:25:40,159 --> 00:25:40,960
this demo

654
00:25:40,960 --> 00:25:42,240
because here we have all those

655
00:25:42,240 --> 00:25:44,240
informations you have the header

656
00:25:44,240 --> 00:25:47,760
you have 15 objects here and you have

657
00:25:47,760 --> 00:25:48,320
this

658
00:25:48,320 --> 00:25:51,440
two extreme you have the one trailer one

659
00:25:51,440 --> 00:25:53,360
cross reference table here

660
00:25:53,360 --> 00:25:56,640
and you have one trailer right

661
00:25:56,640 --> 00:25:59,760
so below this tool we

662
00:25:59,760 --> 00:26:02,960
we can find this uh

663
00:26:02,960 --> 00:26:05,360
informations this is lash writing this

664
00:26:05,360 --> 00:26:06,240
information

665
00:26:06,240 --> 00:26:08,320
all those information all those these

666
00:26:08,320 --> 00:26:09,440
lashes are

667
00:26:09,440 --> 00:26:12,720
inside of this object that's a very

668
00:26:12,720 --> 00:26:13,760
interesting point

669
00:26:13,760 --> 00:26:16,400
because if you uh see in the manner of

670
00:26:16,400 --> 00:26:17,840
the pdf id

671
00:26:17,840 --> 00:26:19,520
you can note you can see this

672
00:26:19,520 --> 00:26:21,840
information that's basically it's

673
00:26:21,840 --> 00:26:24,960
uh is it's too is responsible to print

674
00:26:24,960 --> 00:26:28,720
many strings inside of the pdf right

675
00:26:28,720 --> 00:26:30,240
so here we have another interesting

676
00:26:30,240 --> 00:26:32,480
point we have the encryption file

677
00:26:32,480 --> 00:26:35,760
and you have here five java

678
00:26:35,760 --> 00:26:38,720
script inside this pdf you know so you

679
00:26:38,720 --> 00:26:39,200
can

680
00:26:39,200 --> 00:26:42,400
think about it what do you think you

681
00:26:42,400 --> 00:26:43,039
have a

682
00:26:43,039 --> 00:26:45,600
javascript inside of the pdf file maybe

683
00:26:45,600 --> 00:26:46,320
it's uh

684
00:26:46,320 --> 00:26:49,200
it's a safer or malicious you know i

685
00:26:49,200 --> 00:26:50,960
don't talk about the reverse engineer

686
00:26:50,960 --> 00:26:51,279
here

687
00:26:51,279 --> 00:26:54,400
just to try to interpret or to

688
00:26:54,400 --> 00:26:56,880
try understand of this file right and

689
00:26:56,880 --> 00:26:58,000
here you can

690
00:26:58,000 --> 00:27:01,120
see another information open action it's

691
00:27:01,120 --> 00:27:04,159
one what's this means in this case open

692
00:27:04,159 --> 00:27:04,720
actions

693
00:27:04,720 --> 00:27:07,039
refer basically when the user received

694
00:27:07,039 --> 00:27:08,000
the file

695
00:27:08,000 --> 00:27:11,360
and user click in a file in this case is

696
00:27:11,360 --> 00:27:12,400
pdf file

697
00:27:12,400 --> 00:27:15,440
and after that and after that

698
00:27:15,440 --> 00:27:18,880
the file can execute something

699
00:27:18,880 --> 00:27:21,120
in this case we can see here we have

700
00:27:21,120 --> 00:27:22,480
five javascript

701
00:27:22,480 --> 00:27:24,960
we just need to understand what this uh

702
00:27:24,960 --> 00:27:26,559
or what this command

703
00:27:26,559 --> 00:27:29,039
represent in this case right so i will

704
00:27:29,039 --> 00:27:29,600
put

705
00:27:29,600 --> 00:27:32,799
uh mars let me check here okay so here i

706
00:27:32,799 --> 00:27:34,000
will use another

707
00:27:34,000 --> 00:27:37,279
uh platform in this case it's a

708
00:27:37,279 --> 00:27:40,720
pdf run right did some another platform

709
00:27:40,720 --> 00:27:42,559
created by dj steven

710
00:27:42,559 --> 00:27:46,080
pdf parser right oh my goodness we

711
00:27:46,080 --> 00:27:46,720
haven't

712
00:27:46,720 --> 00:27:49,919
i do have many problems here with my

713
00:27:49,919 --> 00:27:51,840
in this case my finger you know because

714
00:27:51,840 --> 00:27:54,320
i am clicking in a mouse

715
00:27:54,320 --> 00:27:57,039
but no but but now i have you try to

716
00:27:57,039 --> 00:27:57,360
show

717
00:27:57,360 --> 00:27:59,679
you the the all those information in

718
00:27:59,679 --> 00:28:00,399
this case

719
00:28:00,399 --> 00:28:02,720
right because i will pause the video to

720
00:28:02,720 --> 00:28:04,000
to explain

721
00:28:04,000 --> 00:28:06,159
as you can see here this information in

722
00:28:06,159 --> 00:28:07,279
the beginning we can

723
00:28:07,279 --> 00:28:10,720
see the header right and here you can

724
00:28:10,720 --> 00:28:11,919
reach the object

725
00:28:11,919 --> 00:28:14,960
one if you remember when i explain about

726
00:28:14,960 --> 00:28:15,760
the body

727
00:28:15,760 --> 00:28:17,679
about the cross reference table all

728
00:28:17,679 --> 00:28:18,960
those in for all those

729
00:28:18,960 --> 00:28:22,000
these parts of this pdf are connected

730
00:28:22,000 --> 00:28:25,200
one both another right right

731
00:28:25,200 --> 00:28:27,840
so here for example you have the object

732
00:28:27,840 --> 00:28:28,480
one

733
00:28:28,480 --> 00:28:31,760
referring object to object three four

734
00:28:31,760 --> 00:28:35,520
five six and seven but you know

735
00:28:35,520 --> 00:28:39,440
and i know that we have fifteens object

736
00:28:39,440 --> 00:28:42,880
inside this file right so let's continue

737
00:28:42,880 --> 00:28:43,600
to

738
00:28:43,600 --> 00:28:48,399
try understand here we can see the

739
00:28:48,399 --> 00:28:51,679
my goodness here we can see

740
00:28:51,679 --> 00:28:55,039
the javascript but here we we can

741
00:28:55,039 --> 00:28:56,480
we can't understand what this

742
00:28:56,480 --> 00:28:58,080
information means right

743
00:28:58,080 --> 00:29:01,360
so we need to try understand more here

744
00:29:01,360 --> 00:29:04,159
as you can see we have the option open

745
00:29:04,159 --> 00:29:04,720
action

746
00:29:04,720 --> 00:29:07,840
as you explained before to you right the

747
00:29:07,840 --> 00:29:08,799
open action

748
00:29:08,799 --> 00:29:12,240
when the user click in this file this

749
00:29:12,240 --> 00:29:13,039
file

750
00:29:13,039 --> 00:29:16,320
uh will run

751
00:29:16,320 --> 00:29:19,760
someone or or or any javascript but

752
00:29:19,760 --> 00:29:22,960
we don't know right uh what

753
00:29:22,960 --> 00:29:26,000
this javascript maybe

754
00:29:26,000 --> 00:29:28,960
call it or maybe can call it right so

755
00:29:28,960 --> 00:29:31,120
let's continue to understand

756
00:29:31,120 --> 00:29:34,320
we have object one and here

757
00:29:34,320 --> 00:29:37,520
i will put okay

758
00:29:37,520 --> 00:29:40,240
above here object four we have another

759
00:29:40,240 --> 00:29:41,200
reference here

760
00:29:41,200 --> 00:29:43,919
we have a reference eight and reference

761
00:29:43,919 --> 00:29:46,640
nine and we have a two more referencing

762
00:29:46,640 --> 00:29:50,159
right so uh you can

763
00:29:50,159 --> 00:29:53,679
see here more connectivity in the many

764
00:29:53,679 --> 00:29:55,440
objects inside the pdf

765
00:29:55,440 --> 00:29:58,240
right so here another interesting thing

766
00:29:58,240 --> 00:29:59,120
we have the

767
00:29:59,120 --> 00:30:03,760
object 7 connected or referencing by

768
00:30:03,760 --> 00:30:07,440
object 10 you know we are

769
00:30:07,440 --> 00:30:10,720
growing up of this pdf file right

770
00:30:10,720 --> 00:30:13,600
in here the object nine we have the same

771
00:30:13,600 --> 00:30:14,159
case

772
00:30:14,159 --> 00:30:16,000
we have the referencing the four because

773
00:30:16,000 --> 00:30:17,360
the four connected

774
00:30:17,360 --> 00:30:20,880
to the nine nt8 and the eleven

775
00:30:20,880 --> 00:30:23,919
right so we can see

776
00:30:23,919 --> 00:30:27,279
many connections of the object inside

777
00:30:27,279 --> 00:30:28,000
this

778
00:30:28,000 --> 00:30:31,679
name of body right so here we have the

779
00:30:31,679 --> 00:30:34,960
the object 10 connected to

780
00:30:34,960 --> 00:30:38,000
12 and here we have one

781
00:30:38,000 --> 00:30:41,039
first interesting uh information

782
00:30:41,039 --> 00:30:44,720
object 11 we have the contain

783
00:30:44,720 --> 00:30:48,240
extreme in this case uh when this

784
00:30:48,240 --> 00:30:50,559
object has some strings maybe you have a

785
00:30:50,559 --> 00:30:51,760
javascript inside

786
00:30:51,760 --> 00:30:54,640
this or maybe you can have some exploit

787
00:30:54,640 --> 00:30:55,279
inside

788
00:30:55,279 --> 00:30:57,279
this and you have this information

789
00:30:57,279 --> 00:30:58,640
flakes decoded

790
00:30:58,640 --> 00:31:02,120
it means uh these are streaming are

791
00:31:02,120 --> 00:31:05,360
obfuscated i are closed inside

792
00:31:05,360 --> 00:31:08,000
this uh flash decode you need to decode

793
00:31:08,000 --> 00:31:09,039
this information

794
00:31:09,039 --> 00:31:11,919
uh by the way so here another

795
00:31:11,919 --> 00:31:14,320
information is you have object 12

796
00:31:14,320 --> 00:31:18,399
it's connected to 13 and if you compare

797
00:31:18,399 --> 00:31:22,000
here this is streaming it's much

798
00:31:22,000 --> 00:31:25,120
uh bigger than

799
00:31:25,120 --> 00:31:28,640
uh than than another that we see that we

800
00:31:28,640 --> 00:31:32,159
saw uh later right if you compare this

801
00:31:32,159 --> 00:31:35,440
stream it's very very high

802
00:31:35,440 --> 00:31:37,679
the the size it's very high right when

803
00:31:37,679 --> 00:31:38,880
you compare here

804
00:31:38,880 --> 00:31:42,480
so maybe the idea is to try to looking

805
00:31:42,480 --> 00:31:45,360
all those informations inside this

806
00:31:45,360 --> 00:31:47,919
object right we have here the object

807
00:31:47,919 --> 00:31:51,200
14 and here the 15 and finish

808
00:31:51,200 --> 00:31:54,799
the file right so the next step

809
00:31:54,799 --> 00:31:58,320
is to try to look inside the

810
00:31:58,320 --> 00:32:01,519
object 13 right so in this case i will

811
00:32:01,519 --> 00:32:03,679
use another two pdf tica

812
00:32:03,679 --> 00:32:06,159
in this case these two it's not from dda

813
00:32:06,159 --> 00:32:06,880
steven

814
00:32:06,880 --> 00:32:10,240
by the way so i will run

815
00:32:10,240 --> 00:32:12,880
the dump of this information and this uh

816
00:32:12,880 --> 00:32:14,000
a key information

817
00:32:14,000 --> 00:32:17,120
uncompressed because of you uncompress

818
00:32:17,120 --> 00:32:20,720
all those information inside these pdfs

819
00:32:20,720 --> 00:32:23,760
right because you remember i run the pdf

820
00:32:23,760 --> 00:32:24,320
person

821
00:32:24,320 --> 00:32:27,519
and i i can read all those

822
00:32:27,519 --> 00:32:30,159
run information and here we i can

823
00:32:30,159 --> 00:32:32,080
uncompress because i know

824
00:32:32,080 --> 00:32:35,360
inside of this streaming we have a flat

825
00:32:35,360 --> 00:32:38,799
the code information so now i am

826
00:32:38,799 --> 00:32:42,880
seeing here the javascript obfuscated

827
00:32:42,880 --> 00:32:45,120
in this case the attacker used the first

828
00:32:45,120 --> 00:32:46,159
technique the

829
00:32:46,159 --> 00:32:49,120
obfuscation technique right because i

830
00:32:49,120 --> 00:32:49,840
can

831
00:32:49,840 --> 00:32:52,960
see the evil parameters

832
00:32:52,960 --> 00:32:56,000
and i can try to find

833
00:32:56,000 --> 00:32:59,440
any information inside this obfuscated

834
00:32:59,440 --> 00:32:59,919
code

835
00:32:59,919 --> 00:33:03,200
right so here i will use uh the nano you

836
00:33:03,200 --> 00:33:03,840
know i could

837
00:33:03,840 --> 00:33:07,120
i can use vi maybe or another tools to

838
00:33:07,120 --> 00:33:07,519
edit

839
00:33:07,519 --> 00:33:11,279
all those informations and i will just

840
00:33:11,279 --> 00:33:13,600
change any information here you can see

841
00:33:13,600 --> 00:33:15,440
many informations in javascript

842
00:33:15,440 --> 00:33:20,240
so here we can find or you can

843
00:33:20,240 --> 00:33:22,320
try to read any information because you

844
00:33:22,320 --> 00:33:24,080
can if you imagine for example

845
00:33:24,080 --> 00:33:27,039
we're gonna talk about the javascript

846
00:33:27,039 --> 00:33:28,799
javascript javascript to use

847
00:33:28,799 --> 00:33:32,640
usually uh that you know the following

848
00:33:32,640 --> 00:33:35,120
it's uh application your web application

849
00:33:35,120 --> 00:33:36,159
page maybe

850
00:33:36,159 --> 00:33:38,559
so because of this i will try to uh

851
00:33:38,559 --> 00:33:40,559
there's a fuscate this kind of

852
00:33:40,559 --> 00:33:43,360
code so because i have the here the

853
00:33:43,360 --> 00:33:44,080
parameter

854
00:33:44,080 --> 00:33:47,279
i use in the script html

855
00:33:47,279 --> 00:33:50,159
i will using the document right to try

856
00:33:50,159 --> 00:33:50,960
read

857
00:33:50,960 --> 00:33:54,159
any information inside of this

858
00:33:54,159 --> 00:33:57,480
code right so i generate the

859
00:33:57,480 --> 00:33:58,880
payload.html

860
00:33:58,880 --> 00:34:02,720
and i will try to read if i find for

861
00:34:02,720 --> 00:34:03,519
example

862
00:34:03,519 --> 00:34:06,559
uh any information inside of this java

863
00:34:06,559 --> 00:34:08,079
script obfuscated

864
00:34:08,079 --> 00:34:11,280
right so basically i will run now

865
00:34:11,280 --> 00:34:14,960
this code in a html page and

866
00:34:14,960 --> 00:34:20,079
i'll take a look all the what's the if

867
00:34:20,079 --> 00:34:23,199
the in the interesting information that

868
00:34:23,199 --> 00:34:24,480
we find here

869
00:34:24,480 --> 00:34:28,800
the variable payload do you know what

870
00:34:28,800 --> 00:34:31,918
this means it's basically the packer

871
00:34:31,918 --> 00:34:34,000
or not the packer the package

872
00:34:34,000 --> 00:34:35,040
responsible

873
00:34:35,040 --> 00:34:38,879
to download uh in the vitmen machine

874
00:34:38,879 --> 00:34:42,320
and this package is responsible to

875
00:34:42,320 --> 00:34:45,599
response this information to the

876
00:34:45,599 --> 00:34:49,440
attacker server right the it's known

877
00:34:49,440 --> 00:34:52,719
uh the name it's a cac or command and

878
00:34:52,719 --> 00:34:54,000
controller right

879
00:34:54,000 --> 00:34:57,200
so take a look in the first step we find

880
00:34:57,200 --> 00:34:58,960
that the pdf file

881
00:34:58,960 --> 00:35:01,119
and this pdf file we have a five

882
00:35:01,119 --> 00:35:02,400
javascript

883
00:35:02,400 --> 00:35:05,680
but we have a one of this java it's the

884
00:35:05,680 --> 00:35:07,040
bigger javascript

885
00:35:07,040 --> 00:35:10,079
in this javascript have received

886
00:35:10,079 --> 00:35:13,200
the obfuscated technique right

887
00:35:13,200 --> 00:35:17,200
and after after that i will i i needed

888
00:35:17,200 --> 00:35:19,440
to change all those information i need

889
00:35:19,440 --> 00:35:21,920
to do sophisticated of this code

890
00:35:21,920 --> 00:35:24,640
and when i execute the information in a

891
00:35:24,640 --> 00:35:26,079
html page

892
00:35:26,079 --> 00:35:29,200
i can find the payload responsible to

893
00:35:29,200 --> 00:35:30,240
download

894
00:35:30,240 --> 00:35:32,160
in the vitamin machine so if you

895
00:35:32,160 --> 00:35:33,680
remember in the beginning of this

896
00:35:33,680 --> 00:35:34,480
analysis when

897
00:35:34,480 --> 00:35:37,280
the user maybe the vitamin this case

898
00:35:37,280 --> 00:35:38,160
click

899
00:35:38,160 --> 00:35:39,839
in the file do you remember the open

900
00:35:39,839 --> 00:35:42,640
action the next action of this file is

901
00:35:42,640 --> 00:35:43,040
to

902
00:35:43,040 --> 00:35:45,200
execute this javascript in this case

903
00:35:45,200 --> 00:35:47,680
it's you know it's obfuscated

904
00:35:47,680 --> 00:35:50,160
so when the the user or the vitamin

905
00:35:50,160 --> 00:35:52,000
clicking this file

906
00:35:52,000 --> 00:35:54,960
this is scripted the javascript uh will

907
00:35:54,960 --> 00:35:56,160
run

908
00:35:56,160 --> 00:35:59,200
in the victim and will download this

909
00:35:59,200 --> 00:36:00,800
payload that you can see in the

910
00:36:00,800 --> 00:36:03,599
in the screen inside the whitman machine

911
00:36:03,599 --> 00:36:04,000
right

912
00:36:04,000 --> 00:36:06,880
so in this case i i was i was thinking

913
00:36:06,880 --> 00:36:08,240
when i was

914
00:36:08,240 --> 00:36:11,280
uh doing this analysis so if i have the

915
00:36:11,280 --> 00:36:14,160
payload maybe i can try to find the cac

916
00:36:14,160 --> 00:36:15,119
from the attacker

917
00:36:15,119 --> 00:36:17,280
right so i will continue to do my

918
00:36:17,280 --> 00:36:18,800
analysis in this case

919
00:36:18,800 --> 00:36:22,560
so i have here some informations inside

920
00:36:22,560 --> 00:36:22,960
this

921
00:36:22,960 --> 00:36:25,839
payload right so here are you use again

922
00:36:25,839 --> 00:36:27,040
my big friend

923
00:36:27,040 --> 00:36:29,599
nano maybe many people don't like this

924
00:36:29,599 --> 00:36:30,640
friend but

925
00:36:30,640 --> 00:36:33,520
you know it's in my case it's simple oh

926
00:36:33,520 --> 00:36:35,119
i could use again

927
00:36:35,119 --> 00:36:38,480
vino vi or another uh edit test so if

928
00:36:38,480 --> 00:36:41,440
if you see here we have a very percent

929
00:36:41,440 --> 00:36:42,800
inside of this

930
00:36:42,800 --> 00:36:45,760
information here when when i look at

931
00:36:45,760 --> 00:36:46,480
when i look at

932
00:36:46,480 --> 00:36:49,520
all those percent all those information

933
00:36:49,520 --> 00:36:50,480
i can notes

934
00:36:50,480 --> 00:36:54,000
i can see here no notes i can see here

935
00:36:54,000 --> 00:36:56,560
the interesting information in this case

936
00:36:56,560 --> 00:36:57,119
here

937
00:36:57,119 --> 00:36:59,920
we have a you see two based on a unique

938
00:36:59,920 --> 00:37:01,040
code

939
00:37:01,040 --> 00:37:03,760
you know uh information it's it's almost

940
00:37:03,760 --> 00:37:05,680
different when you talk about the ascii

941
00:37:05,680 --> 00:37:09,520
or ascii as key it means a two by

942
00:37:09,520 --> 00:37:11,119
one bytes when you talk about the

943
00:37:11,119 --> 00:37:13,599
unicode you used in two bytes right

944
00:37:13,599 --> 00:37:17,040
so here i have the the the the pure

945
00:37:17,040 --> 00:37:20,079
not pure but the the run data of this

946
00:37:20,079 --> 00:37:22,960
unicode right so now i need to translate

947
00:37:22,960 --> 00:37:24,240
all this information

948
00:37:24,240 --> 00:37:27,440
so i had the payload package

949
00:37:27,440 --> 00:37:30,960
but when i see i i see another technique

950
00:37:30,960 --> 00:37:34,320
the encode technique right so this the

951
00:37:34,320 --> 00:37:35,599
this payload

952
00:37:35,599 --> 00:37:39,760
is used with uh unique um

953
00:37:39,760 --> 00:37:44,000
sorry it's used a unicode

954
00:37:44,000 --> 00:37:46,560
encoding right i know it's very it may

955
00:37:46,560 --> 00:37:48,079
be confusing but

956
00:37:48,079 --> 00:37:50,160
take a look at this i have a payload

957
00:37:50,160 --> 00:37:51,359
package

958
00:37:51,359 --> 00:37:53,119
i have an information all those

959
00:37:53,119 --> 00:37:54,960
information receive

960
00:37:54,960 --> 00:37:58,400
a encode technique this encode technique

961
00:37:58,400 --> 00:37:58,800
is

962
00:37:58,800 --> 00:38:02,640
pasted in unicode right so basically

963
00:38:02,640 --> 00:38:04,480
as you can see here i just using the

964
00:38:04,480 --> 00:38:05,920
unix platform

965
00:38:05,920 --> 00:38:09,280
but maybe you can ask uh or you can

966
00:38:09,280 --> 00:38:12,400
asking felipe but i use just windows but

967
00:38:12,400 --> 00:38:13,599
not a problem you don't

968
00:38:13,599 --> 00:38:16,240
you however you you don't need to have a

969
00:38:16,240 --> 00:38:18,079
consonant in this case right

970
00:38:18,079 --> 00:38:21,359
so here i use another platform in

971
00:38:21,359 --> 00:38:23,040
mozilla by bobby it's

972
00:38:23,040 --> 00:38:26,400
it's a similar platform i have here the

973
00:38:26,400 --> 00:38:27,760
same code

974
00:38:27,760 --> 00:38:29,920
i need to cut you remember i need to cut

975
00:38:29,920 --> 00:38:31,440
this percent

976
00:38:31,440 --> 00:38:35,200
because i need to have the run unicode

977
00:38:35,200 --> 00:38:39,119
information right the unicode code

978
00:38:39,119 --> 00:38:41,200
right so here i have the unicode

979
00:38:41,200 --> 00:38:42,240
information

980
00:38:42,240 --> 00:38:45,359
and i can generate here the exa file

981
00:38:45,359 --> 00:38:46,160
binary

982
00:38:46,160 --> 00:38:47,839
this these two it's responsible to

983
00:38:47,839 --> 00:38:49,920
generate this kind of information

984
00:38:49,920 --> 00:38:53,440
after that i use it another information

985
00:38:53,440 --> 00:38:56,240
uh another tools created by dda steven

986
00:38:56,240 --> 00:38:57,280
sure

987
00:38:57,280 --> 00:39:00,400
search executable to try and find any

988
00:39:00,400 --> 00:39:03,119
http information because remember if i

989
00:39:03,119 --> 00:39:04,880
have the payload package

990
00:39:04,880 --> 00:39:08,079
probably this um

991
00:39:08,079 --> 00:39:10,560
package went after two downloaded in the

992
00:39:10,560 --> 00:39:11,839
vitamin machine

993
00:39:11,839 --> 00:39:15,040
probably this package will make

994
00:39:15,040 --> 00:39:16,960
some requests into the commanding

995
00:39:16,960 --> 00:39:18,880
controller from attacker right

996
00:39:18,880 --> 00:39:21,280
so that's my idea when i to continue to

997
00:39:21,280 --> 00:39:22,079
do this

998
00:39:22,079 --> 00:39:24,480
investigation so when you as you can see

999
00:39:24,480 --> 00:39:26,400
here i found

1000
00:39:26,400 --> 00:39:30,240
the ip from the attacker in this case

1001
00:39:30,240 --> 00:39:31,280
the ip

1002
00:39:31,280 --> 00:39:34,800
is based in estonia europe

1003
00:39:34,800 --> 00:39:38,160
writes all this information from the cac

1004
00:39:38,160 --> 00:39:40,960
the attacker i i don't use it basically

1005
00:39:40,960 --> 00:39:41,520
here

1006
00:39:41,520 --> 00:39:44,240
the reverse engineer but we find the

1007
00:39:44,240 --> 00:39:45,440
javascript

1008
00:39:45,440 --> 00:39:48,480
obfuscated we find the encode

1009
00:39:48,480 --> 00:39:51,599
technique based in in

1010
00:39:51,599 --> 00:39:55,359
in unicode right

1011
00:39:55,520 --> 00:39:58,320
we've we can learn about the for example

1012
00:39:58,320 --> 00:40:00,880
open action inside the pdf files

1013
00:40:00,880 --> 00:40:04,720
so we can learn about many informations

1014
00:40:04,720 --> 00:40:08,160
right so if you have any question i

1015
00:40:08,160 --> 00:40:10,720
i am available to you this is my contact

1016
00:40:10,720 --> 00:40:11,359
again

1017
00:40:11,359 --> 00:40:14,160
and one more time thank you thank you

1018
00:40:14,160 --> 00:40:15,440
for this opportunity

1019
00:40:15,440 --> 00:40:18,920
if you have any question please let me

1020
00:40:18,920 --> 00:40:21,920
know

