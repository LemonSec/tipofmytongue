1
00:00:02,639 --> 00:00:04,160
hello fellow humans

2
00:00:04,160 --> 00:00:06,480
today we're gonna talk about the danger

3
00:00:06,480 --> 00:00:08,480
of uh

4
00:00:08,480 --> 00:00:11,759
buying cheap products from china

5
00:00:11,759 --> 00:00:15,280
um but first uh let's go into

6
00:00:15,280 --> 00:00:18,080
a bit more detail about me so you get my

7
00:00:18,080 --> 00:00:20,000
background and

8
00:00:20,000 --> 00:00:23,920
what you're gonna learn today uh i'm

9
00:00:23,920 --> 00:00:26,960
gabby i have

10
00:00:26,960 --> 00:00:30,320
a fairly short

11
00:00:30,320 --> 00:00:32,079
history with the cyber security

12
00:00:32,079 --> 00:00:33,680
background i joined this field a couple

13
00:00:33,680 --> 00:00:36,000
of years ago with my first stunt which

14
00:00:36,000 --> 00:00:36,320
is

15
00:00:36,320 --> 00:00:38,399
hacking the public transportation system

16
00:00:38,399 --> 00:00:40,399
in romania

17
00:00:40,399 --> 00:00:43,600
then after my

18
00:00:43,600 --> 00:00:46,640
unlimited cards didn't work i decided to

19
00:00:46,640 --> 00:00:47,440
step it

20
00:00:47,440 --> 00:00:51,120
up a notch so i had my car

21
00:00:51,120 --> 00:00:54,079
and i discovered that it knew

22
00:00:54,079 --> 00:00:56,559
frighteningly more

23
00:00:56,559 --> 00:01:00,320
stuff about me than i knew about myself

24
00:01:00,320 --> 00:01:05,280
um and uh in the last year i've

25
00:01:05,280 --> 00:01:08,400
started chilling a bit more and

26
00:01:08,400 --> 00:01:11,600
hunting uh bots

27
00:01:11,600 --> 00:01:15,200
for white ops but the research that i'm

28
00:01:15,200 --> 00:01:16,640
gonna show today is completely

29
00:01:16,640 --> 00:01:17,600
independent

30
00:01:17,600 --> 00:01:21,200
and uh it's a product of

31
00:01:21,200 --> 00:01:24,240
love and free time and

32
00:01:24,240 --> 00:01:28,240
a very very very very

33
00:01:28,240 --> 00:01:32,640
very supportive girlfriend

34
00:01:33,119 --> 00:01:36,720
now let's talk about our uh the object

35
00:01:36,720 --> 00:01:38,400
of our study which is

36
00:01:38,400 --> 00:01:42,079
xiaomi xiaomi is a very big corporation

37
00:01:42,079 --> 00:01:43,920
they've grown more and more and more and

38
00:01:43,920 --> 00:01:45,200
more and more

39
00:01:45,200 --> 00:01:48,399
in the last year they're one of the

40
00:01:48,399 --> 00:01:52,840
biggest producers of smartphones in the

41
00:01:52,840 --> 00:01:55,360
world and as we're gonna see

42
00:01:55,360 --> 00:01:57,280
it's not only smartphones that they

43
00:01:57,280 --> 00:01:58,479
build

44
00:01:58,479 --> 00:02:01,759
they have mice

45
00:02:01,759 --> 00:02:04,560
air purifiers electric kettles home

46
00:02:04,560 --> 00:02:05,920
security cameras

47
00:02:05,920 --> 00:02:09,360
smart bulbs routers glass crispers

48
00:02:09,360 --> 00:02:13,599
whatever that is toys routers

49
00:02:13,599 --> 00:02:16,959
and even t-shirts and shoes so

50
00:02:16,959 --> 00:02:19,760
you might be going to the xiaomi store

51
00:02:19,760 --> 00:02:20,239
pulling

52
00:02:20,239 --> 00:02:23,760
money out of your xiaomi wallet and

53
00:02:23,760 --> 00:02:27,040
getting a xiaomi

54
00:02:27,040 --> 00:02:28,959
fridge that connects to your xiaomi

55
00:02:28,959 --> 00:02:30,080
router

56
00:02:30,080 --> 00:02:31,840
that is controlled via your xiaomi

57
00:02:31,840 --> 00:02:34,080
smartphone so it's completely

58
00:02:34,080 --> 00:02:37,200
possible to live entirely the entirety

59
00:02:37,200 --> 00:02:38,239
of your life

60
00:02:38,239 --> 00:02:42,400
into the xiaomi ecosystem and

61
00:02:42,400 --> 00:02:45,599
this kind of

62
00:02:46,239 --> 00:02:48,560
implies some philosophical questions

63
00:02:48,560 --> 00:02:49,280
about

64
00:02:49,280 --> 00:02:52,560
who watches the watchdog because this is

65
00:02:52,560 --> 00:02:54,000
what xiaomi is

66
00:02:54,000 --> 00:02:56,160
it's basically a watchdog for your data

67
00:02:56,160 --> 00:02:57,680
and not even

68
00:02:57,680 --> 00:03:00,560
a dog it just watches over your data and

69
00:03:00,560 --> 00:03:02,879
who knows what they're gonna do with it

70
00:03:02,879 --> 00:03:06,560
spoiler alert they collect a lot so

71
00:03:06,560 --> 00:03:09,120
um after digging a bit more about them

72
00:03:09,120 --> 00:03:11,280
it turns out they are

73
00:03:11,280 --> 00:03:14,879
the biggest producer in the world just

74
00:03:14,879 --> 00:03:18,640
look at this in india sorry look at this

75
00:03:18,640 --> 00:03:22,000
black bar over here they're producing a

76
00:03:22,000 --> 00:03:25,760
lot right now they just

77
00:03:25,760 --> 00:03:29,360
overthrow over through samsung and

78
00:03:29,360 --> 00:03:32,480
they are the de facto leaders in india

79
00:03:32,480 --> 00:03:32,720
and

80
00:03:32,720 --> 00:03:35,920
in eastern europe from my knowledge

81
00:03:35,920 --> 00:03:38,959
so yeah i don't know

82
00:03:38,959 --> 00:03:41,599
like what i'm going to show you that

83
00:03:41,599 --> 00:03:42,080
they

84
00:03:42,080 --> 00:03:45,120
just gobble update all the time so i

85
00:03:45,120 --> 00:03:47,200
bought a xiaomi smartphone because

86
00:03:47,200 --> 00:03:50,000
it was cheap it was really powerful a

87
00:03:50,000 --> 00:03:52,640
snapdragon 665

88
00:03:52,640 --> 00:03:55,280
oh it has a really really cool camera

89
00:03:55,280 --> 00:03:57,120
nfc support that

90
00:03:57,120 --> 00:03:59,360
you think that you don't no longer see

91
00:03:59,360 --> 00:04:01,200
you on budget devices

92
00:04:01,200 --> 00:04:03,599
a very bright display and yeah i

93
00:04:03,599 --> 00:04:05,120
couldn't

94
00:04:05,120 --> 00:04:08,400
i couldn't have any find any issue with

95
00:04:08,400 --> 00:04:09,040
it

96
00:04:09,040 --> 00:04:10,799
i mean there has to be a trick my

97
00:04:10,799 --> 00:04:13,040
eastern european

98
00:04:13,040 --> 00:04:15,920
school taught me that you there's always

99
00:04:15,920 --> 00:04:17,519
a trick when something is too

100
00:04:17,519 --> 00:04:21,440
cheap to be real it's not real and

101
00:04:21,440 --> 00:04:24,960
i started my usual

102
00:04:24,960 --> 00:04:28,639
routine of picking and

103
00:04:28,639 --> 00:04:31,919
trying to dismantle my devices and

104
00:04:31,919 --> 00:04:35,120
see what they do and how they do it so i

105
00:04:35,120 --> 00:04:36,639
got a brand new phone

106
00:04:36,639 --> 00:04:40,320
a xiaomi note 8 pro i think

107
00:04:40,320 --> 00:04:43,040
i rooted it i which is quite a

108
00:04:43,040 --> 00:04:45,280
cumbersome process you have to wait like

109
00:04:45,280 --> 00:04:46,240
one week

110
00:04:46,240 --> 00:04:48,000
they have to make sure that you're a

111
00:04:48,000 --> 00:04:50,639
real person and not somebody who

112
00:04:50,639 --> 00:04:54,080
buys their phone in books who roots them

113
00:04:54,080 --> 00:04:57,199
and tries to rebrand them so yeah

114
00:04:57,199 --> 00:04:59,520
but i had the patience i installed the

115
00:04:59,520 --> 00:05:01,680
custom ssl certificate

116
00:05:01,680 --> 00:05:04,240
and i started looking at the data that

117
00:05:04,240 --> 00:05:05,520
was sending that

118
00:05:05,520 --> 00:05:10,000
oh my that was a lot

119
00:05:10,000 --> 00:05:13,199
uh if i were a cat and i was eating data

120
00:05:13,199 --> 00:05:16,479
i would surely look at as that one it's

121
00:05:16,479 --> 00:05:19,039
it's bad uh it's really bad and we're

122
00:05:19,039 --> 00:05:20,400
gonna look at that

123
00:05:20,400 --> 00:05:24,479
a bit later in the meantime

124
00:05:24,479 --> 00:05:28,000
as i'm streaming you can

125
00:05:28,000 --> 00:05:31,759
take a look at this youtube video

126
00:05:31,759 --> 00:05:35,680
you can also go on twitter

127
00:05:35,680 --> 00:05:39,360
and i posted it over there already

128
00:05:39,360 --> 00:05:42,160
it's a side-by-side comparison of xiaomi

129
00:05:42,160 --> 00:05:42,960
and

130
00:05:42,960 --> 00:05:45,440
of the of the xiaomi's browser and the

131
00:05:45,440 --> 00:05:47,120
request that it's doing

132
00:05:47,120 --> 00:05:49,919
side by side while i'm browsing around

133
00:05:49,919 --> 00:05:50,320
in

134
00:05:50,320 --> 00:05:54,320
incognito mode unfortunately

135
00:05:54,320 --> 00:05:56,800
i can't present it over here because it

136
00:05:56,800 --> 00:05:58,400
would be on youtube stream inside the

137
00:05:58,400 --> 00:05:59,280
youtube stream

138
00:05:59,280 --> 00:06:02,800
inside the youtube stream and i think it

139
00:06:02,800 --> 00:06:04,960
be it could be higher quality if you

140
00:06:04,960 --> 00:06:06,479
just

141
00:06:06,479 --> 00:06:10,400
watch it in its original form

142
00:06:10,400 --> 00:06:14,880
so go on youtube screenshot this

143
00:06:14,880 --> 00:06:18,840
and go to that url that that you're

144
00:06:18,840 --> 00:06:20,720
seeing

145
00:06:20,720 --> 00:06:24,639
and now we're gonna do a bit of a side

146
00:06:24,639 --> 00:06:26,800
by side the comparison and

147
00:06:26,800 --> 00:06:29,280
look at what i was doing there and

148
00:06:29,280 --> 00:06:30,479
what's going on

149
00:06:30,479 --> 00:06:35,759
so if you go to let's say that your

150
00:06:35,759 --> 00:06:38,240
you try to visit something sensitive

151
00:06:38,240 --> 00:06:41,280
like privacy advocates or whatever

152
00:06:41,280 --> 00:06:45,280
and when you visit that website

153
00:06:45,280 --> 00:06:48,400
from xiaomi's pre-built browser and

154
00:06:48,400 --> 00:06:50,319
the me browser that you can find on the

155
00:06:50,319 --> 00:06:52,880
play store

156
00:06:52,960 --> 00:06:56,318
they're going to generate a request

157
00:06:56,720 --> 00:07:02,240
it's a base 64. um

158
00:07:02,240 --> 00:07:05,280
and it's you can't unpack it

159
00:07:05,280 --> 00:07:07,280
right from the get-go it's very easy

160
00:07:07,280 --> 00:07:09,520
don't worry i'll show you how

161
00:07:09,520 --> 00:07:12,639
um but every time you visit a website

162
00:07:12,639 --> 00:07:14,560
the another request gets done you visit

163
00:07:14,560 --> 00:07:16,000
another website another request

164
00:07:16,000 --> 00:07:19,840
webster and this is something inside the

165
00:07:19,840 --> 00:07:23,520
alibaba's cloud uh the registrar for the

166
00:07:23,520 --> 00:07:25,919
domain is in china

167
00:07:25,919 --> 00:07:28,840
while the ips are in the us russia and

168
00:07:28,840 --> 00:07:31,840
singapore

169
00:07:32,000 --> 00:07:35,280
depending on your geolocation data is

170
00:07:35,280 --> 00:07:37,599
being sent in different places

171
00:07:37,599 --> 00:07:39,520
if you're russian i guess it gets to

172
00:07:39,520 --> 00:07:40,960
mother russia

173
00:07:40,960 --> 00:07:43,840
if you're from china to singapore china

174
00:07:43,840 --> 00:07:46,159
slash

175
00:07:46,639 --> 00:07:51,039
europe and u.s data goes to u.s

176
00:07:51,039 --> 00:07:53,280
but don't take my word for it this is

177
00:07:53,280 --> 00:07:54,160
just

178
00:07:54,160 --> 00:07:57,199
inference so

179
00:07:57,199 --> 00:08:00,319
up until now we had a new phone with no

180
00:08:00,319 --> 00:08:02,639
apps

181
00:08:02,639 --> 00:08:07,039
it did 24 calls to that

182
00:08:07,039 --> 00:08:10,400
shady web server in three hours

183
00:08:10,400 --> 00:08:13,599
to some chinese infrastructure

184
00:08:13,599 --> 00:08:16,720
and yeah this this is not looking good

185
00:08:16,720 --> 00:08:20,080
it's gonna get way worse just wait and

186
00:08:20,080 --> 00:08:21,199
see

187
00:08:21,199 --> 00:08:27,199
so remember this slide

188
00:08:27,199 --> 00:08:30,319
when we start tearing down at

189
00:08:30,319 --> 00:08:34,320
xiaomi's browser apk we're gonna see

190
00:08:34,320 --> 00:08:37,839
the same endpoints that

191
00:08:37,839 --> 00:08:40,958
i mentioned over there

192
00:08:40,958 --> 00:08:44,399
so here's the data list

193
00:08:44,399 --> 00:08:45,839
this is the field that we're going to

194
00:08:45,839 --> 00:08:48,160
hunt for inside the apk

195
00:08:48,160 --> 00:08:50,959
and lo and behold inside the send http

196
00:08:50,959 --> 00:08:53,120
request function

197
00:08:53,120 --> 00:08:55,519
there's uh the parameter that's being

198
00:08:55,519 --> 00:08:56,160
sent

199
00:08:56,160 --> 00:08:58,959
data list right because we need i mean

200
00:08:58,959 --> 00:08:59,760
we need to

201
00:08:59,760 --> 00:09:03,839
crack the apk open in order to get away

202
00:09:03,839 --> 00:09:06,560
find a way into which the data was

203
00:09:06,560 --> 00:09:07,680
compressed

204
00:09:07,680 --> 00:09:10,959
so we can take a peek at the data hiding

205
00:09:10,959 --> 00:09:12,399
behind

206
00:09:12,399 --> 00:09:15,760
and that

207
00:09:15,760 --> 00:09:19,360
send http request function is

208
00:09:19,360 --> 00:09:22,959
called from somewhere up

209
00:09:22,959 --> 00:09:26,800
from uh a package

210
00:09:26,800 --> 00:09:31,200
called sensorsdata.analytics.android.sdk

211
00:09:31,200 --> 00:09:35,040
remember sensors data it's uh

212
00:09:35,040 --> 00:09:36,320
it's going to be something that we're

213
00:09:36,320 --> 00:09:38,959
going to touch at a later point

214
00:09:38,959 --> 00:09:42,080
uh sin there's a company called sensors

215
00:09:42,080 --> 00:09:43,680
analytics

216
00:09:43,680 --> 00:09:48,080
and they're pretty close in it with

217
00:09:48,080 --> 00:09:51,200
miui xiaomi and all that stuff but

218
00:09:51,200 --> 00:09:55,920
a bit on that later and we can see that

219
00:09:55,920 --> 00:09:59,040
this function before calling

220
00:09:59,040 --> 00:10:01,680
send http request there's also a call to

221
00:10:01,680 --> 00:10:03,920
encode data and if we look at encode

222
00:10:03,920 --> 00:10:05,680
data you can see that

223
00:10:05,680 --> 00:10:08,079
the by so the the string that's being

224
00:10:08,079 --> 00:10:09,279
sent

225
00:10:09,279 --> 00:10:13,200
is just uh

226
00:10:13,200 --> 00:10:17,040
put into a base64 it's just gzipped put

227
00:10:17,040 --> 00:10:18,000
into base64

228
00:10:18,000 --> 00:10:22,000
and sent over the wire and as soon as we

229
00:10:22,000 --> 00:10:26,079
on gzip that

230
00:10:26,079 --> 00:10:29,600
that request we can find the original

231
00:10:29,600 --> 00:10:31,279
json that's being sent

232
00:10:31,279 --> 00:10:33,680
and that includes the url that we

233
00:10:33,680 --> 00:10:34,560
visited

234
00:10:34,560 --> 00:10:36,720
the type of the network to which we

235
00:10:36,720 --> 00:10:37,600
connected

236
00:10:37,600 --> 00:10:40,640
a lot of device info that would easily

237
00:10:40,640 --> 00:10:42,240
leak metadata but

238
00:10:42,240 --> 00:10:44,079
metadata is not a problem we have

239
00:10:44,079 --> 00:10:45,760
another problem

240
00:10:45,760 --> 00:10:49,600
our main concern right here

241
00:10:49,600 --> 00:10:54,880
is the fact that there's a new uid

242
00:10:54,880 --> 00:10:56,959
that should be anonymous it's right in

243
00:10:56,959 --> 00:10:58,640
the center of the screen

244
00:10:58,640 --> 00:11:01,760
and that's not it's being sent alongside

245
00:11:01,760 --> 00:11:05,600
uh your email address and a lot of other

246
00:11:05,600 --> 00:11:07,839
information that can be tied to the real

247
00:11:07,839 --> 00:11:08,720
you

248
00:11:08,720 --> 00:11:10,959
so

249
00:11:11,839 --> 00:11:14,800
the app their browser even tracks if you

250
00:11:14,800 --> 00:11:16,640
are in e-cognito mode

251
00:11:16,640 --> 00:11:19,279
if you enable incognito mode it doesn't

252
00:11:19,279 --> 00:11:20,560
change anything

253
00:11:20,560 --> 00:11:25,120
at all i tried to

254
00:11:25,120 --> 00:11:27,760
after i announced that to xiaomi they

255
00:11:27,760 --> 00:11:29,440
initially denied that

256
00:11:29,440 --> 00:11:31,440
anything is going on i had to like

257
00:11:31,440 --> 00:11:33,200
really pummel it through together with

258
00:11:33,200 --> 00:11:34,720
cyber gibbons

259
00:11:34,720 --> 00:11:38,079
strong hat did to him for uh

260
00:11:38,079 --> 00:11:41,440
helping me out on this um

261
00:11:41,440 --> 00:11:44,000
after that they also added a checkbox

262
00:11:44,000 --> 00:11:45,839
called enhanced incognito mode

263
00:11:45,839 --> 00:11:48,800
which is enabled by default you have to

264
00:11:48,800 --> 00:11:50,880
disable enhanced incognito mode

265
00:11:50,880 --> 00:11:53,200
and turn on incognito mode if you don't

266
00:11:53,200 --> 00:11:54,320
want any kind of

267
00:11:54,320 --> 00:11:57,839
of data to be sent

268
00:12:01,279 --> 00:12:04,480
another the problem with this request is

269
00:12:04,480 --> 00:12:05,760
the account id

270
00:12:05,760 --> 00:12:08,320
that you can see right here so they're

271
00:12:08,320 --> 00:12:09,120
sending the

272
00:12:09,120 --> 00:12:11,440
language which is not a problem and the

273
00:12:11,440 --> 00:12:12,480
miui id

274
00:12:12,480 --> 00:12:14,399
this is the account id that we're seeing

275
00:12:14,399 --> 00:12:15,920
here this account id

276
00:12:15,920 --> 00:12:18,240
is sent together with the uuid that i

277
00:12:18,240 --> 00:12:20,639
was mentioning before

278
00:12:20,639 --> 00:12:24,399
and after you catch

279
00:12:24,399 --> 00:12:27,600
a request that contains both the

280
00:12:27,600 --> 00:12:30,720
miui id and the uuid

281
00:12:30,720 --> 00:12:34,240
you can then track a user like

282
00:12:34,240 --> 00:12:37,360
infer the miui id which you can create

283
00:12:37,360 --> 00:12:41,760
only using uh your phone number

284
00:12:41,760 --> 00:12:43,920
or your facebook account or your google

285
00:12:43,920 --> 00:12:45,120
account

286
00:12:45,120 --> 00:12:47,519
you can infer it from that uuid very

287
00:12:47,519 --> 00:12:48,240
easily

288
00:12:48,240 --> 00:12:52,480
and this happens in incognito mode

289
00:12:52,480 --> 00:12:56,079
that's it's a

290
00:12:56,079 --> 00:12:59,200
huge breach of privacy

291
00:12:59,200 --> 00:13:02,079
the distinct id that we're seeing here

292
00:13:02,079 --> 00:13:03,519
that's being sent

293
00:13:03,519 --> 00:13:06,639
all over the place

294
00:13:06,639 --> 00:13:09,440
is present everywhere in all of the

295
00:13:09,440 --> 00:13:10,079
headers

296
00:13:10,079 --> 00:13:12,240
it's it's kind of hard not to see and

297
00:13:12,240 --> 00:13:13,360
it's always tied

298
00:13:13,360 --> 00:13:15,680
with that uid so even when you are

299
00:13:15,680 --> 00:13:17,040
basically trying to

300
00:13:17,040 --> 00:13:20,160
to be anonymous in the requests that

301
00:13:20,160 --> 00:13:23,680
are do not contain the uid the

302
00:13:23,680 --> 00:13:26,959
this the umeo id sorry they can still

303
00:13:26,959 --> 00:13:27,680
track you

304
00:13:27,680 --> 00:13:29,839
because the two accounts have already

305
00:13:29,839 --> 00:13:32,320
already been tied together

306
00:13:32,320 --> 00:13:34,399
you can again you cannot create a new id

307
00:13:34,399 --> 00:13:36,160
without your phone number email or

308
00:13:36,160 --> 00:13:37,600
social media account

309
00:13:37,600 --> 00:13:39,760
they won't allow you you have to use a

310
00:13:39,760 --> 00:13:41,440
burner

311
00:13:41,440 --> 00:13:43,199
which kind of tells you something about

312
00:13:43,199 --> 00:13:45,199
this company

313
00:13:45,199 --> 00:13:48,880
so uh a bit of a recap

314
00:13:48,880 --> 00:13:51,920
we found that xiaomi's

315
00:13:51,920 --> 00:13:54,959
default browser

316
00:13:54,959 --> 00:13:58,079
that comes pre-installed on all of the

317
00:13:58,079 --> 00:14:01,920
miui enabled phones aggregate visited

318
00:14:01,920 --> 00:14:03,040
urls

319
00:14:03,040 --> 00:14:06,079
your browsing history your search engine

320
00:14:06,079 --> 00:14:07,760
history

321
00:14:07,760 --> 00:14:11,040
your browsing behavior including like

322
00:14:11,040 --> 00:14:12,959
when you swipe

323
00:14:12,959 --> 00:14:16,399
pages around where when you tap

324
00:14:16,399 --> 00:14:18,880
that cannot be correlated to the real

325
00:14:18,880 --> 00:14:21,519
you and this happens

326
00:14:21,519 --> 00:14:24,560
every time even in incognito mode and

327
00:14:24,560 --> 00:14:25,199
it's

328
00:14:25,199 --> 00:14:28,000
i mean recently they added a checkbox

329
00:14:28,000 --> 00:14:30,399
called enhanced incognito mode which has

330
00:14:30,399 --> 00:14:31,279
to be turned

331
00:14:31,279 --> 00:14:35,680
off uh that mitigates this

332
00:14:35,680 --> 00:14:39,120
but there's a lot more that hasn't even

333
00:14:39,120 --> 00:14:40,720
been addressed and we're gonna get to

334
00:14:40,720 --> 00:14:41,440
this

335
00:14:41,440 --> 00:14:44,639
right now

336
00:14:44,639 --> 00:14:48,320
let's say that you don't install a third

337
00:14:48,320 --> 00:14:50,880
party launcher

338
00:14:50,880 --> 00:14:52,880
on your xiaomi phone and use the default

339
00:14:52,880 --> 00:14:55,519
news app you go into the news app

340
00:14:55,519 --> 00:14:57,600
and you start scrolling around and you

341
00:14:57,600 --> 00:14:59,440
click this

342
00:14:59,440 --> 00:15:01,399
news that says that the uk is

343
00:15:01,399 --> 00:15:03,360
hypocritical

344
00:15:03,360 --> 00:15:06,480
and lo and behold

345
00:15:06,880 --> 00:15:10,079
the sensors analytics that

346
00:15:10,079 --> 00:15:13,199
are pre-baked on your phone will send

347
00:15:13,199 --> 00:15:16,320
the title of the

348
00:15:16,320 --> 00:15:19,760
article that you just clicked

349
00:15:19,760 --> 00:15:23,360
to xiaomi they could have hashed it they

350
00:15:23,360 --> 00:15:25,760
could have found so many ways in which

351
00:15:25,760 --> 00:15:28,720
they could have analyzed this they don't

352
00:15:28,720 --> 00:15:29,839
even send the url

353
00:15:29,839 --> 00:15:33,519
they send what you're browsing

354
00:15:33,519 --> 00:15:36,399
so the intent is to monitor over you not

355
00:15:36,399 --> 00:15:37,920
to aggregate the

356
00:15:37,920 --> 00:15:41,519
metadata as they try to

357
00:15:41,519 --> 00:15:45,600
whitewash it and it gets even more fun

358
00:15:45,600 --> 00:15:49,839
if you listen music inside their app

359
00:15:49,839 --> 00:15:52,959
the app will then listen to you

360
00:15:52,959 --> 00:15:56,160
and send the name

361
00:15:56,160 --> 00:15:59,120
of the song that you're playing back to

362
00:15:59,120 --> 00:16:01,600
their servers

363
00:16:01,600 --> 00:16:04,480
every time it's you're not being sampled

364
00:16:04,480 --> 00:16:05,759
or anything like that

365
00:16:05,759 --> 00:16:08,639
it's just the default behavior that is

366
00:16:08,639 --> 00:16:09,519
happening

367
00:16:09,519 --> 00:16:12,639
and one more recap and i said

368
00:16:12,639 --> 00:16:15,759
this is the final one

369
00:16:16,160 --> 00:16:18,959
xiaomi sense what news you watch what

370
00:16:18,959 --> 00:16:20,079
music you play

371
00:16:20,079 --> 00:16:25,120
offline so this was offline it was a

372
00:16:26,320 --> 00:16:28,399
song that i downloaded and i wanted to

373
00:16:28,399 --> 00:16:30,320
listen offline

374
00:16:30,320 --> 00:16:33,759
what your home screen folders are named

375
00:16:33,759 --> 00:16:37,600
and a lot of other data that

376
00:16:37,600 --> 00:16:39,600
i i mean i couldn't find the encryption

377
00:16:39,600 --> 00:16:41,680
schemes and keys because this uses a

378
00:16:41,680 --> 00:16:42,880
different encryption key

379
00:16:42,880 --> 00:16:46,399
scheme than before

380
00:16:46,399 --> 00:16:48,959
before we had just gzip compression and

381
00:16:48,959 --> 00:16:51,120
basically for encoding

382
00:16:51,120 --> 00:16:54,320
uh these information are more

383
00:16:54,320 --> 00:16:57,839
sensible and they use some kind of

384
00:16:57,839 --> 00:17:00,160
aes encryption with a rolling key and i

385
00:17:00,160 --> 00:17:01,199
haven't been able to

386
00:17:01,199 --> 00:17:05,599
i've only been able to crack it in a

387
00:17:05,599 --> 00:17:09,199
only in certain places and

388
00:17:09,199 --> 00:17:10,880
the worrying part is that it doesn't

389
00:17:10,880 --> 00:17:12,959
happen like

390
00:17:12,959 --> 00:17:16,880
on only my device i pull down

391
00:17:16,880 --> 00:17:21,119
the rom for a lot of xiaomi devices for

392
00:17:21,119 --> 00:17:23,359
five xiaomi device device i think or six

393
00:17:23,359 --> 00:17:24,959
i can recall

394
00:17:24,959 --> 00:17:28,880
it was a k30

395
00:17:29,440 --> 00:17:34,559
um a redmi

396
00:17:34,559 --> 00:17:37,760
8a i think it was a me

397
00:17:37,760 --> 00:17:40,880
10 and something else and

398
00:17:40,880 --> 00:17:44,559
i found the same behavior in all

399
00:17:44,559 --> 00:17:47,760
of the other miui roms

400
00:17:47,760 --> 00:17:51,039
so the problem is not even

401
00:17:51,039 --> 00:17:54,000
limited to a xiaomi basis this happens

402
00:17:54,000 --> 00:17:54,400
in

403
00:17:54,400 --> 00:17:58,160
every miui distribution

404
00:17:58,160 --> 00:18:00,400
that you find if you install miui on a

405
00:18:00,400 --> 00:18:01,440
third party one

406
00:18:01,440 --> 00:18:04,400
on an unsupported device because

407
00:18:04,400 --> 00:18:05,440
whatever you like

408
00:18:05,440 --> 00:18:09,200
iphone clones so you install it and

409
00:18:09,200 --> 00:18:12,240
it will start sending data

410
00:18:12,240 --> 00:18:16,320
to to china

411
00:18:16,480 --> 00:18:19,039
um but remember that what i was telling

412
00:18:19,039 --> 00:18:19,600
you

413
00:18:19,600 --> 00:18:22,799
that they make smart bands and

414
00:18:22,799 --> 00:18:26,640
whatever so i bought a xiaomi smart band

415
00:18:26,640 --> 00:18:30,080
and i paired it with a xiaomi phone

416
00:18:30,080 --> 00:18:33,840
and that is running miui and all that it

417
00:18:33,840 --> 00:18:35,600
wasn't an android one

418
00:18:35,600 --> 00:18:37,280
or anything like that and we have

419
00:18:37,280 --> 00:18:38,880
captain spyware

420
00:18:38,880 --> 00:18:42,480
for the rescue um

421
00:18:42,480 --> 00:18:47,240
basically combining the powers of

422
00:18:47,240 --> 00:18:50,240
state-sponsored

423
00:18:52,640 --> 00:18:56,799
spyware and yeah

424
00:18:56,799 --> 00:19:00,000
this is so

425
00:19:00,000 --> 00:19:03,120
the request started at 11 and

426
00:19:03,120 --> 00:19:07,679
nine minutes and like the capture ended

427
00:19:07,679 --> 00:19:09,760
not because it ended but because i ended

428
00:19:09,760 --> 00:19:10,799
it at 11

429
00:19:10,799 --> 00:19:14,720
and 12 minutes so in four minutes

430
00:19:14,720 --> 00:19:17,440
i have one

431
00:19:21,840 --> 00:19:25,440
we have four requests fun right

432
00:19:25,440 --> 00:19:29,360
40 requests in four minutes

433
00:19:29,360 --> 00:19:34,320
in three minutes to china

434
00:19:34,880 --> 00:19:38,720
why because it doesn't

435
00:19:38,720 --> 00:19:42,320
this doesn't happen like only uh

436
00:19:42,320 --> 00:19:44,640
on on all of the chinese phones there

437
00:19:44,640 --> 00:19:46,400
are other examples

438
00:19:46,400 --> 00:19:48,880
i have an opel phone that doesn't do

439
00:19:48,880 --> 00:19:50,240
anything they just

440
00:19:50,240 --> 00:19:52,160
communicate from now and then with their

441
00:19:52,160 --> 00:19:54,720
server saying hey do i have an update

442
00:19:54,720 --> 00:19:56,240
yes you have an update give me the

443
00:19:56,240 --> 00:19:58,080
update and that's it

444
00:19:58,080 --> 00:20:00,960
that's like three megabytes of data that

445
00:20:00,960 --> 00:20:04,080
are being transferred every month

446
00:20:04,080 --> 00:20:06,080
they don't send anything that's personal

447
00:20:06,080 --> 00:20:07,600
to me

448
00:20:07,600 --> 00:20:10,880
um and the explanation comes from the

449
00:20:10,880 --> 00:20:12,559
sensor analytics that i was mentioning

450
00:20:12,559 --> 00:20:13,360
you

451
00:20:13,360 --> 00:20:16,720
earlier sensor analytics you can find

452
00:20:16,720 --> 00:20:19,760
a lot more about them about them in an

453
00:20:19,760 --> 00:20:21,760
article by thomas brewster

454
00:20:21,760 --> 00:20:25,120
who wrote an investigation on this

455
00:20:25,120 --> 00:20:28,240
um are pretty closely tied

456
00:20:28,240 --> 00:20:31,679
with xiaomi and they are

457
00:20:31,679 --> 00:20:35,760
basically sending selling your data

458
00:20:35,760 --> 00:20:37,919
through sensor analytics sensor

459
00:20:37,919 --> 00:20:40,400
analytics boasting that they can offer

460
00:20:40,400 --> 00:20:43,200
huge insights into user behavior just

461
00:20:43,200 --> 00:20:44,799
look it up

462
00:20:44,799 --> 00:20:49,679
it's uh it's something that every

463
00:20:49,679 --> 00:20:53,120
researcher should know what are the

464
00:20:53,120 --> 00:20:55,039
malicious not malicious but let's say

465
00:20:55,039 --> 00:20:56,799
them call the sdks that

466
00:20:56,799 --> 00:21:02,400
shady sdks that aggregate your data

467
00:21:03,280 --> 00:21:05,520
so

468
00:21:07,440 --> 00:21:10,000
this is what my watch was sending about

469
00:21:10,000 --> 00:21:11,919
me

470
00:21:11,919 --> 00:21:15,679
it was sending the name of the apps

471
00:21:15,679 --> 00:21:18,559
that i'm using

472
00:21:18,720 --> 00:21:22,159
to china because why not they

473
00:21:22,159 --> 00:21:23,600
they could have hashed it they could

474
00:21:23,600 --> 00:21:25,760
have done so many things they're saying

475
00:21:25,760 --> 00:21:26,400
that

476
00:21:26,400 --> 00:21:29,840
they are sending this data just

477
00:21:29,840 --> 00:21:33,600
in order to save the apps for which i

478
00:21:33,600 --> 00:21:35,120
want notifications

479
00:21:35,120 --> 00:21:38,159
but they can just hash those apps

480
00:21:38,159 --> 00:21:41,039
and send the hashes and save the hashes

481
00:21:41,039 --> 00:21:41,360
and

482
00:21:41,360 --> 00:21:44,720
that's it but no uh they're sending the

483
00:21:44,720 --> 00:21:45,840
apps in clear text

484
00:21:45,840 --> 00:21:48,320
who knows need to check if they have any

485
00:21:48,320 --> 00:21:49,840
zero days on you

486
00:21:49,840 --> 00:21:52,158
um

487
00:21:52,960 --> 00:21:56,720
and what can i say

488
00:21:56,720 --> 00:22:00,640
uh i notified them they only changed the

489
00:22:00,640 --> 00:22:03,360
incognito mode

490
00:22:03,360 --> 00:22:06,720
of it is an

491
00:22:06,720 --> 00:22:10,159
endless battle they did not address this

492
00:22:10,159 --> 00:22:14,240
issue or the fact that they're saving

493
00:22:14,240 --> 00:22:17,440
uh they're sending the name of your

494
00:22:17,440 --> 00:22:19,360
apps and folders from on your home

495
00:22:19,360 --> 00:22:20,480
screen or the

496
00:22:20,480 --> 00:22:22,080
songs that you listen to or the news

497
00:22:22,080 --> 00:22:24,960
that you watch they only made that small

498
00:22:24,960 --> 00:22:27,200
change with the privacy mode after a lot

499
00:22:27,200 --> 00:22:28,400
of

500
00:22:28,400 --> 00:22:31,760
denying beforehand there are also good

501
00:22:31,760 --> 00:22:33,520
news

502
00:22:33,520 --> 00:22:36,799
this is the captured screen

503
00:22:36,799 --> 00:22:41,360
from one of my phone from china

504
00:22:41,360 --> 00:22:44,080
it's an oppo it didn't send anything

505
00:22:44,080 --> 00:22:44,960
it's amazing

506
00:22:44,960 --> 00:22:46,559
i don't know how they do it maybe they

507
00:22:46,559 --> 00:22:48,799
have some kind of uh

508
00:22:48,799 --> 00:22:51,360
covert communication channel that i

509
00:22:51,360 --> 00:22:52,000
haven't

510
00:22:52,000 --> 00:22:54,799
discovered yet but no seriously there's

511
00:22:54,799 --> 00:22:55,360
also

512
00:22:55,360 --> 00:22:58,159
a lot of good stuff coming out of there

513
00:22:58,159 --> 00:22:58,640
but

514
00:22:58,640 --> 00:23:02,080
it's our job as researchers to know

515
00:23:02,080 --> 00:23:04,240
what's good and what's bad and to inform

516
00:23:04,240 --> 00:23:06,559
the people and most importantly

517
00:23:06,559 --> 00:23:11,120
to do the right thing

518
00:23:11,760 --> 00:23:15,280
i've been gabby and thank you for

519
00:23:15,280 --> 00:23:18,480
listening to me you can always find me

520
00:23:18,480 --> 00:23:20,080
on twitter

521
00:23:20,080 --> 00:23:23,600
and just if you're interested in

522
00:23:23,600 --> 00:23:26,400
some of my memes and my projects i'll

523
00:23:26,400 --> 00:23:28,480
always be available on uh

524
00:23:28,480 --> 00:23:31,600
on on github i always put them on github

525
00:23:31,600 --> 00:23:35,439
thank you and

526
00:23:35,840 --> 00:23:41,678
see you next year

