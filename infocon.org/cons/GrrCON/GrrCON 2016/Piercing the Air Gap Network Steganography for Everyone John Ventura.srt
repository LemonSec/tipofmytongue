1
00:00:00,000 --> 00:00:07,500
hello welcome to piercing the<font color="#CCCCCC"> air-gap</font>

2
00:00:05,759 --> 00:00:09,389
<font color="#CCCCCC">network steganography for everyone</font><font color="#E5E5E5"> i am</font>

3
00:00:07,500 --> 00:00:11,969
<font color="#CCCCCC">john Ventura i am part of the applied</font>

4
00:00:09,389 --> 00:00:14,009
research team<font color="#E5E5E5"> at optiv</font><font color="#CCCCCC"> and I want to</font>

5
00:00:11,969 --> 00:00:16,500
<font color="#E5E5E5">talk to you today about using</font>

6
00:00:14,009 --> 00:00:21,090
steganographic<font color="#E5E5E5"> techniques to</font><font color="#CCCCCC"> hide data</font>

7
00:00:16,500 --> 00:00:22,680
within<font color="#CCCCCC"> network based communications in</font>

8
00:00:21,090 --> 00:00:26,939
$YEAR as part<font color="#CCCCCC"> of the research for this</font>

9
00:00:22,680 --> 00:00:29,880
talk<font color="#CCCCCC"> i developed a tool the tool is</font>

10
00:00:26,939 --> 00:00:32,369
called<font color="#CCCCCC"> net needle and it provides a</font>

11
00:00:29,880 --> 00:00:34,620
network-based<font color="#E5E5E5"> a graphic channel of</font>

12
00:00:32,369 --> 00:00:36,090
<font color="#E5E5E5">communication between two hosts</font><font color="#CCCCCC"> you can</font>

13
00:00:34,620 --> 00:00:37,468
use<font color="#CCCCCC"> it for a variety of things depending</font>

14
00:00:36,090 --> 00:00:39,780
on what you want to communicate across

15
00:00:37,469 --> 00:00:42,660
<font color="#E5E5E5">that</font><font color="#CCCCCC"> channel</font><font color="#E5E5E5"> and there were a lot of</font>

16
00:00:39,780 --> 00:00:45,210
lessons learned<font color="#E5E5E5"> and in that development</font>

17
00:00:42,660 --> 00:00:48,419
and like to share those with you before

18
00:00:45,210 --> 00:00:50,399
we get to that<font color="#CCCCCC"> like to</font><font color="#E5E5E5"> talk about maybe</font>

19
00:00:48,420 --> 00:00:52,829
give you a brief history of<font color="#CCCCCC"> second</font>

20
00:00:50,399 --> 00:00:56,730
ography<font color="#E5E5E5"> and the tools and techniques</font>

21
00:00:52,829 --> 00:00:57,329
that have come before me before I do

22
00:00:56,730 --> 00:00:58,739
that though

23
00:00:57,329 --> 00:01:02,160
steganography in case anybody doesn't

24
00:00:58,739 --> 00:01:04,378
know this is the craft of creating

25
00:01:02,160 --> 00:01:06,869
<font color="#E5E5E5">hidden messages in this case we are</font>

26
00:01:04,379 --> 00:01:07,710
hiding those messages within network

27
00:01:06,869 --> 00:01:10,049
protocols

28
00:01:07,710 --> 00:01:13,080
specifically we are hiding those

29
00:01:10,049 --> 00:01:14,909
messages in the packet headers<font color="#CCCCCC"> other</font>

30
00:01:13,080 --> 00:01:18,240
people have done a lot of similar work

31
00:01:14,909 --> 00:01:20,549
in the past and the first<font color="#CCCCCC"> word that</font>

32
00:01:18,240 --> 00:01:24,960
comes<font color="#E5E5E5"> to mind in that in that vein is</font>

33
00:01:20,549 --> 00:01:27,570
<font color="#CCCCCC">project Loki</font><font color="#E5E5E5"> where they took</font><font color="#CCCCCC"> icmp pic</font>

34
00:01:24,960 --> 00:01:29,820
<font color="#CCCCCC">messages echo request</font><font color="#E5E5E5"> second replies and</font>

35
00:01:27,570 --> 00:01:32,669
<font color="#CCCCCC">hid the year their actual messages</font>

36
00:01:29,820 --> 00:01:35,339
within the payload<font color="#E5E5E5"> that</font><font color="#CCCCCC"> approach is</font>

37
00:01:32,670 --> 00:01:37,799
great<font color="#CCCCCC"> however</font><font color="#E5E5E5"> that payload sort of</font>

38
00:01:35,340 --> 00:01:41,490
sticks out if you want to you want to do

39
00:01:37,799 --> 00:01:44,280
analysis<font color="#CCCCCC"> if you want to find find that</font>

40
00:01:41,490 --> 00:01:45,689
channel of communication the the<font color="#E5E5E5"> payload</font>

41
00:01:44,280 --> 00:01:47,640
<font color="#E5E5E5">the data that's being transmitted looks</font>

42
00:01:45,689 --> 00:01:49,470
pretty odd<font color="#CCCCCC"> other people when they want</font>

43
00:01:47,640 --> 00:01:50,909
to use technology<font color="#E5E5E5"> fee in a network-based</font>

44
00:01:49,470 --> 00:01:53,250
<font color="#E5E5E5">way</font>

45
00:01:50,909 --> 00:01:55,259
typically they use<font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> tunneling</font><font color="#CCCCCC"> this is</font>

46
00:01:53,250 --> 00:01:58,680
probably the most common at the moment

47
00:01:55,259 --> 00:02:02,549
<font color="#CCCCCC">way to do it where they</font><font color="#E5E5E5"> they try to</font>

48
00:01:58,680 --> 00:02:05,729
resolve a lot of<font color="#E5E5E5"> easy DNS names and</font>

49
00:02:02,549 --> 00:02:07,049
<font color="#CCCCCC">there are advantages</font><font color="#E5E5E5"> to that but we</font>

50
00:02:05,729 --> 00:02:10,228
didn't go that route

51
00:02:07,049 --> 00:02:12,060
partially because that data is again

52
00:02:10,229 --> 00:02:13,290
hidden in the payload and if your

53
00:02:12,060 --> 00:02:15,750
network analyst

54
00:02:13,290 --> 00:02:18,689
wants to do some protocol analysis again

55
00:02:15,750 --> 00:02:20,159
that might stand out because this is

56
00:02:18,689 --> 00:02:21,719
tagging graffiti<font color="#CCCCCC"> we're trying to make</font>

57
00:02:20,159 --> 00:02:25,230
<font color="#E5E5E5">our communications as discreet as</font>

58
00:02:21,719 --> 00:02:28,500
possible<font color="#CCCCCC"> discreet as possible</font><font color="#E5E5E5"> so again</font>

59
00:02:25,230 --> 00:02:33,298
<font color="#E5E5E5">we decided to use the packet headers the</font>

60
00:02:28,500 --> 00:02:36,150
payloads are used for<font color="#E5E5E5"> decoy data</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> in</font>

61
00:02:33,299 --> 00:02:38,819
<font color="#CCCCCC">actually impede mode</font><font color="#E5E5E5"> it just looks like</font>

62
00:02:36,150 --> 00:02:43,290
<font color="#CCCCCC">King</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> TCP mode it looks like HTTP GET</font>

63
00:02:38,819 --> 00:02:44,608
<font color="#E5E5E5">and uh hopefully</font><font color="#CCCCCC"> network analysts who</font>

64
00:02:43,290 --> 00:02:48,599
are going to try to find your

65
00:02:44,609 --> 00:02:53,069
communication channel<font color="#E5E5E5"> little people</font>

66
00:02:48,599 --> 00:02:56,429
so there are<font color="#CCCCCC"> some benefits here and</font>

67
00:02:53,069 --> 00:02:59,700
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> anyone here</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> pentester</font><font color="#CCCCCC"> alright</font>

68
00:02:56,430 --> 00:03:01,049
<font color="#E5E5E5">so if your pen tester</font><font color="#CCCCCC"> you can use these</font>

69
00:02:59,700 --> 00:03:02,458
techniques you can use the<font color="#E5E5E5"> tool that we</font>

70
00:03:01,049 --> 00:03:07,530
developed or maybe even develop your own

71
00:03:02,459 --> 00:03:09,599
<font color="#E5E5E5">and uh it will help you avoid detection</font>

72
00:03:07,530 --> 00:03:10,980
so if you don't want to be<font color="#CCCCCC"> detected if</font>

73
00:03:09,599 --> 00:03:13,409
you want to communicate in such a way

74
00:03:10,980 --> 00:03:15,450
that whoever is responsible for

75
00:03:13,409 --> 00:03:16,108
monitoring network traffic doesn't see

76
00:03:15,450 --> 00:03:20,310
you

77
00:03:16,109 --> 00:03:22,079
this will help you if you are<font color="#E5E5E5"> if you</font>

78
00:03:20,310 --> 00:03:23,669
assume that<font color="#CCCCCC"> an adversary exist</font><font color="#E5E5E5"> the</font>

79
00:03:22,079 --> 00:03:25,560
person<font color="#CCCCCC"> is</font><font color="#E5E5E5"> actually responsible</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> is</font>

80
00:03:23,669 --> 00:03:27,750
monitoring network traffic<font color="#E5E5E5"> you can</font>

81
00:03:25,560 --> 00:03:29,159
imagine a software that they're using

82
00:03:27,750 --> 00:03:32,669
they probably are just doing TCP dump

83
00:03:29,159 --> 00:03:34,228
and<font color="#E5E5E5"> and</font><font color="#CCCCCC"> notepad and final</font><font color="#E5E5E5"> piece together</font>

84
00:03:32,669 --> 00:03:36,000
all of this data manually<font color="#E5E5E5"> there's</font>

85
00:03:34,229 --> 00:03:40,680
probably some sort of automated process

86
00:03:36,000 --> 00:03:42,659
of an<font color="#CCCCCC"> IDs or IPS or even wireshark that</font>

87
00:03:40,680 --> 00:03:44,760
that<font color="#E5E5E5"> interprets these protocols for them</font>

88
00:03:42,659 --> 00:03:46,138
<font color="#E5E5E5">part of the advantage of what we're</font>

89
00:03:44,760 --> 00:03:49,048
doing is that we are making it more

90
00:03:46,139 --> 00:03:54,030
computationally intensive to find you<font color="#CCCCCC"> so</font>

91
00:03:49,049 --> 00:03:56,250
if for example if they want to try to if

92
00:03:54,030 --> 00:04:00,269
you hide your data<font color="#CCCCCC"> into</font><font color="#E5E5E5"> random fields</font>

93
00:03:56,250 --> 00:04:04,109
<font color="#CCCCCC">pseudo random data and cryptographic</font>

94
00:04:00,269 --> 00:04:06,479
data<font color="#E5E5E5"> look really similar and this</font>

95
00:04:04,109 --> 00:04:08,489
technique will require a lot more

96
00:04:06,479 --> 00:04:10,470
computational resources<font color="#CCCCCC"> and maybe they</font>

97
00:04:08,489 --> 00:04:11,879
don't have those resources or maybe they

98
00:04:10,470 --> 00:04:13,769
will spend that<font color="#E5E5E5"> resources</font><font color="#CCCCCC"> and that's a</font>

99
00:04:11,879 --> 00:04:17,668
lot of<font color="#E5E5E5"> other things</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you're making</font>

100
00:04:13,769 --> 00:04:20,340
<font color="#E5E5E5">yourself more difficult to find in in</font>

101
00:04:17,668 --> 00:04:23,690
maybe even some unexpected ways<font color="#CCCCCC"> and</font>

102
00:04:20,339 --> 00:04:26,690
finally a really useful

103
00:04:23,690 --> 00:04:29,090
really useful application of this

104
00:04:26,690 --> 00:04:31,070
technology<font color="#CCCCCC"> here</font><font color="#E5E5E5"> at pentester would be</font>

105
00:04:29,090 --> 00:04:33,469
the establishment of control channel in

106
00:04:31,070 --> 00:04:36,349
every environment where<font color="#CCCCCC"> network</font>

107
00:04:33,470 --> 00:04:41,090
filtering is restrictive<font color="#CCCCCC"> so if you can</font>

108
00:04:36,350 --> 00:04:43,010
imagine a network where the admin has

109
00:04:41,090 --> 00:04:45,799
done<font color="#CCCCCC"> network filtering in a responsible</font>

110
00:04:43,010 --> 00:04:47,960
way<font color="#E5E5E5"> and by that</font><font color="#CCCCCC"> i mean they have an</font>

111
00:04:45,800 --> 00:04:49,850
access<font color="#E5E5E5"> list that actually does apply the</font>

112
00:04:47,960 --> 00:04:53,599
principle of least privilege so for

113
00:04:49,850 --> 00:04:57,650
example if there is a web server on

114
00:04:53,600 --> 00:05:00,950
<font color="#E5E5E5">within</font><font color="#CCCCCC"> the network the access list will</font>

115
00:04:57,650 --> 00:05:05,599
only allow incoming traffic<font color="#CCCCCC"> report to</font>

116
00:05:00,950 --> 00:05:07,280
<font color="#CCCCCC">tcp port 80 or and/or the tcp port 443</font>

117
00:05:05,600 --> 00:05:10,160
<font color="#E5E5E5">they're using</font><font color="#CCCCCC"> ssl which hopefully they</font>

118
00:05:07,280 --> 00:05:11,359
are now in the past if you<font color="#CCCCCC"> wanted</font><font color="#E5E5E5"> to set</font>

119
00:05:10,160 --> 00:05:14,810
<font color="#E5E5E5">up a listener if you wanted to establish</font>

120
00:05:11,360 --> 00:05:16,970
communication channel<font color="#CCCCCC"> this</font><font color="#E5E5E5"> this is a</font>

121
00:05:14,810 --> 00:05:19,160
little complicated because the only way

122
00:05:16,970 --> 00:05:21,680
you could talk to that server was

123
00:05:19,160 --> 00:05:25,160
<font color="#E5E5E5">through</font><font color="#CCCCCC"> that access-list through that</font>

124
00:05:21,680 --> 00:05:27,140
restrictive firewall or or<font color="#E5E5E5"> whatever they</font>

125
00:05:25,160 --> 00:05:29,090
have blocking those<font color="#CCCCCC"> blocking those</font><font color="#E5E5E5"> ports</font>

126
00:05:27,140 --> 00:05:31,520
and if they didn't have a<font color="#CCCCCC"> they didn't</font>

127
00:05:29,090 --> 00:05:32,900
have a hole in that you<font color="#E5E5E5"> you couldn't you</font>

128
00:05:31,520 --> 00:05:34,280
couldn't listen on<font color="#E5E5E5"> a service that was</font>

129
00:05:32,900 --> 00:05:36,560
being used for something

130
00:05:34,280 --> 00:05:39,349
fortunately these<font color="#CCCCCC"> technocratic</font>

131
00:05:36,560 --> 00:05:41,030
<font color="#CCCCCC">techniques allow you to do that and let</font>

132
00:05:39,350 --> 00:05:43,640
me<font color="#E5E5E5"> be clear about this you really can</font>

133
00:05:41,030 --> 00:05:46,219
<font color="#CCCCCC">set up a listener on a port</font><font color="#E5E5E5"> that's in</font>

134
00:05:43,640 --> 00:05:47,630
<font color="#CCCCCC">use for something else and hopefully</font>

135
00:05:46,220 --> 00:05:49,730
that doesn't even get noticed

136
00:05:47,630 --> 00:05:53,960
so if you're using<font color="#CCCCCC"> TCP mode by default</font>

137
00:05:49,730 --> 00:05:58,400
you will communicate on port 80<font color="#E5E5E5"> over</font>

138
00:05:53,960 --> 00:06:00,590
<font color="#E5E5E5">HTTP Apache will will respond to</font><font color="#CCCCCC"> two</font>

139
00:05:58,400 --> 00:06:03,469
that ACP get that you're sending<font color="#E5E5E5"> and</font>

140
00:06:00,590 --> 00:06:06,320
hopefully the server that you<font color="#E5E5E5"> that you</font>

141
00:06:03,470 --> 00:06:09,110
<font color="#CCCCCC">setup will</font><font color="#E5E5E5"> deconstruct will</font><font color="#CCCCCC"> deconstruct</font>

142
00:06:06,320 --> 00:06:11,480
<font color="#CCCCCC">and</font><font color="#E5E5E5"> handle your data</font><font color="#CCCCCC"> grams appropriately</font>

143
00:06:09,110 --> 00:06:13,550
<font color="#E5E5E5">so in case you want to</font><font color="#CCCCCC"> set up a</font>

144
00:06:11,480 --> 00:06:15,800
difficult to find communication channel

145
00:06:13,550 --> 00:06:20,120
this is there's definitely some benefits

146
00:06:15,800 --> 00:06:23,180
<font color="#E5E5E5">there so when we talk about of using the</font>

147
00:06:20,120 --> 00:06:26,240
out-of-band<font color="#E5E5E5"> headers or data transmission</font>

148
00:06:23,180 --> 00:06:29,510
<font color="#E5E5E5">specifically</font><font color="#CCCCCC"> i am talking</font><font color="#E5E5E5"> about IP</font>

149
00:06:26,240 --> 00:06:31,850
<font color="#CCCCCC">headers tcp HTTP headers icmp headers</font>

150
00:06:29,510 --> 00:06:35,270
<font color="#E5E5E5">there are is a lot of data within those</font>

151
00:06:31,850 --> 00:06:39,440
headers that is a

152
00:06:35,270 --> 00:06:42,200
random<font color="#E5E5E5"> or arbitrary and you can you can</font>

153
00:06:39,440 --> 00:06:45,140
shove your data in there and it works

154
00:06:42,200 --> 00:06:46,640
<font color="#CCCCCC">I've done</font><font color="#E5E5E5"> it it's real if you're</font>

155
00:06:45,140 --> 00:06:47,960
choosing those<font color="#CCCCCC"> what field you want</font><font color="#E5E5E5"> to</font>

156
00:06:46,640 --> 00:06:50,030
<font color="#CCCCCC">hide</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> data in there are some</font>

157
00:06:47,960 --> 00:06:52,820
precautions you should take obviously

158
00:06:50,030 --> 00:06:55,609
you want<font color="#E5E5E5"> want</font><font color="#CCCCCC"> the resulting needed</font><font color="#E5E5E5"> your</font>

159
00:06:52,820 --> 00:06:58,130
<font color="#E5E5E5">resulting data traffic to seem natural</font>

160
00:06:55,610 --> 00:07:00,140
you don't want to look weird<font color="#E5E5E5"> if it looks</font>

161
00:06:58,130 --> 00:07:03,080
weird that obviously gives people a<font color="#CCCCCC"> UH a</font>

162
00:07:00,140 --> 00:07:10,580
way to<font color="#CCCCCC"> detect you</font><font color="#E5E5E5"> so sort of like</font>

163
00:07:03,080 --> 00:07:13,099
Chewbacca<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> like casual</font><font color="#CCCCCC"> so in the</font>

164
00:07:10,580 --> 00:07:15,530
past people have done this sort of thing

165
00:07:13,100 --> 00:07:16,850
there<font color="#CCCCCC"> are</font><font color="#E5E5E5"> some common areas that have</font>

166
00:07:15,530 --> 00:07:19,489
been used before

167
00:07:16,850 --> 00:07:22,580
what we used<font color="#E5E5E5"> we use the ipid field which</font>

168
00:07:19,490 --> 00:07:23,900
is a<font color="#E5E5E5"> 16</font><font color="#CCCCCC"> x field</font><font color="#E5E5E5"> within the IP header and</font>

169
00:07:22,580 --> 00:07:26,450
there are some precautions<font color="#CCCCCC"> there</font><font color="#E5E5E5"> it's</font>

170
00:07:23,900 --> 00:07:27,710
not<font color="#CCCCCC"> as simple as it sounds</font><font color="#E5E5E5"> but it gives</font>

171
00:07:26,450 --> 00:07:30,740
<font color="#E5E5E5">you some flexibility it's a</font>

172
00:07:27,710 --> 00:07:32,030
<font color="#CCCCCC">pseudo-random</font><font color="#E5E5E5"> field so you can put</font>

173
00:07:30,740 --> 00:07:34,010
whatever you want in there<font color="#E5E5E5"> and your</font>

174
00:07:32,030 --> 00:07:35,179
traffic<font color="#E5E5E5"> will still go through other</font>

175
00:07:34,010 --> 00:07:37,550
people<font color="#E5E5E5"> have done this</font>

176
00:07:35,180 --> 00:07:41,240
um there's a doctoral<font color="#CCCCCC"> thesis out there</font>

177
00:07:37,550 --> 00:07:43,730
if you want to<font color="#E5E5E5"> google for it</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> used</font>

178
00:07:41,240 --> 00:07:45,470
<font color="#E5E5E5">our</font><font color="#CCCCCC"> st's</font><font color="#E5E5E5"> so they establish a legitimate</font>

179
00:07:43,730 --> 00:07:49,610
<font color="#CCCCCC">tcp connection between point</font><font color="#E5E5E5"> A and point</font>

180
00:07:45,470 --> 00:07:51,830
<font color="#E5E5E5">B and within that</font><font color="#CCCCCC"> TCP connection they</font>

181
00:07:49,610 --> 00:07:54,230
<font color="#CCCCCC">sent</font><font color="#E5E5E5"> a lot of run resets</font><font color="#CCCCCC"> so they reset</font>

182
00:07:51,830 --> 00:07:56,630
the sequence<font color="#E5E5E5"> numbers and those new</font>

183
00:07:54,230 --> 00:08:00,320
sequence numbers have<font color="#CCCCCC"> have the data</font>

184
00:07:56,630 --> 00:08:03,469
<font color="#E5E5E5">stuffed into it that that can give you</font>

185
00:08:00,320 --> 00:08:05,420
up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> eight bytes of eight bytes</font>

186
00:08:03,470 --> 00:08:06,680
throughput per packet which is which

187
00:08:05,420 --> 00:08:10,100
for what we're doing is actually pretty

188
00:08:06,680 --> 00:08:12,500
good throughput<font color="#CCCCCC"> um in practice they</font>

189
00:08:10,100 --> 00:08:18,440
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> think artis</font><font color="#E5E5E5"> are all that common so</font>

190
00:08:12,500 --> 00:08:20,300
<font color="#E5E5E5">of its a maybe it's not ideal but</font><font color="#CCCCCC"> um</font>

191
00:08:18,440 --> 00:08:22,160
<font color="#E5E5E5">unfortunately none of these protocols</font>

192
00:08:20,300 --> 00:08:24,110
were designed for<font color="#E5E5E5"> for these purposes so</font>

193
00:08:22,160 --> 00:08:27,260
<font color="#CCCCCC">I don't really know ideal exists but</font>

194
00:08:24,110 --> 00:08:30,200
it's definitely workable way<font color="#E5E5E5"> also in</font>

195
00:08:27,260 --> 00:08:33,200
terms of sequence numbers<font color="#CCCCCC"> / tcp</font><font color="#E5E5E5"> you can</font>

196
00:08:30,200 --> 00:08:34,640
<font color="#CCCCCC">and people</font><font color="#E5E5E5"> have done this you can send a</font>

197
00:08:33,200 --> 00:08:36,860
bunch of sins a bunch of connection

198
00:08:34,640 --> 00:08:41,480
requests from from one end to the other

199
00:08:36,860 --> 00:08:45,800
<font color="#E5E5E5">and again you can have 48 depending</font><font color="#CCCCCC"> on</font>

200
00:08:41,480 --> 00:08:47,600
how you're doing it packets<font color="#CCCCCC"> for</font>

201
00:08:45,800 --> 00:08:49,339
like<font color="#CCCCCC"> super PAC if you want to do it that</font>

202
00:08:47,600 --> 00:08:51,830
way another way that's pretty common

203
00:08:49,339 --> 00:08:53,180
<font color="#E5E5E5">source ports so again you fire off a</font>

204
00:08:51,830 --> 00:08:57,470
bunch of data grams and you get two

205
00:08:53,180 --> 00:09:00,949
<font color="#CCCCCC">bites</font><font color="#E5E5E5"> nearly $MONEY per packet and it's</font>

206
00:08:57,470 --> 00:09:02,690
a little noisy but it<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it works so if</font>

207
00:09:00,950 --> 00:09:04,339
you're going to<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to choose</font><font color="#CCCCCC"> what</font>

208
00:09:02,690 --> 00:09:05,810
<font color="#CCCCCC">fields to use</font><font color="#E5E5E5"> and again we're talking</font>

209
00:09:04,339 --> 00:09:08,000
<font color="#E5E5E5">about lessons learned in the design of</font>

210
00:09:05,810 --> 00:09:11,119
one of these communication channels

211
00:09:08,000 --> 00:09:13,850
<font color="#E5E5E5">there are some great fields there are</font>

212
00:09:11,120 --> 00:09:16,760
some horrible<font color="#E5E5E5"> fields and there are some</font>

213
00:09:13,850 --> 00:09:20,390
<font color="#CCCCCC">field</font><font color="#E5E5E5"> that definitely come with some</font>

214
00:09:16,760 --> 00:09:23,540
precautions and<font color="#E5E5E5"> like I'd like to go over</font>

215
00:09:20,390 --> 00:09:27,290
that now<font color="#CCCCCC"> in ipv4 and we really didn't</font>

216
00:09:23,540 --> 00:09:29,689
touch on ipv6<font color="#CCCCCC"> so if there are i PB six</font>

217
00:09:27,290 --> 00:09:33,380
enthusiasts out there<font color="#CCCCCC"> and I'm with you</font>

218
00:09:29,690 --> 00:09:37,279
<font color="#E5E5E5">sorry perhaps the next next version of</font>

219
00:09:33,380 --> 00:09:41,450
this talk<font color="#CCCCCC"> so we took these diagrams from</font>

220
00:09:37,279 --> 00:09:44,959
the RFC's<font color="#CCCCCC"> you can see RFC 791</font><font color="#E5E5E5"> which may</font>

221
00:09:41,450 --> 00:09:48,680
be familiar with<font color="#E5E5E5"> defines ipv4 and we</font>

222
00:09:44,959 --> 00:09:51,229
have the<font color="#E5E5E5"> 20 bytes</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> the black field</font>

223
00:09:48,680 --> 00:09:52,489
<font color="#E5E5E5">and we'll start with version of you</font>

224
00:09:51,230 --> 00:09:56,390
don't want to modify that you don't want

225
00:09:52,490 --> 00:09:58,459
to modify type of service<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> do that</font>

226
00:09:56,390 --> 00:09:59,959
<font color="#CCCCCC">i really don't think</font><font color="#E5E5E5"> your packets are</font>

227
00:09:58,459 --> 00:10:02,149
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> get routed</font><font color="#CCCCCC"> if you change the</font>

228
00:09:59,959 --> 00:10:04,430
version

229
00:10:02,149 --> 00:10:06,589
<font color="#E5E5E5">yeah I don't think the</font><font color="#CCCCCC"> writers are gonna</font>

230
00:10:04,430 --> 00:10:12,979
<font color="#CCCCCC">know</font><font color="#E5E5E5"> not know how to handle it</font><font color="#CCCCCC"> maybe</font>

231
00:10:06,589 --> 00:10:15,079
<font color="#CCCCCC">they will but good luck the redfield</font><font color="#E5E5E5"> and</font>

232
00:10:12,980 --> 00:10:16,550
<font color="#E5E5E5">we'll start with total length</font><font color="#CCCCCC"> another</font>

233
00:10:15,079 --> 00:10:18,439
way and<font color="#CCCCCC"> I didn't cover this in the</font>

234
00:10:16,550 --> 00:10:21,260
previous slide<font color="#E5E5E5"> you could vary the length</font>

235
00:10:18,440 --> 00:10:24,560
of your data grams and<font color="#CCCCCC"> hydia hide the</font>

236
00:10:21,260 --> 00:10:26,510
data that way again that's not entirely

237
00:10:24,560 --> 00:10:31,310
<font color="#CCCCCC">you're not really flying casual if you</font>

238
00:10:26,510 --> 00:10:34,610
do that but<font color="#E5E5E5"> but it would work</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> on</font>

239
00:10:31,310 --> 00:10:35,689
<font color="#CCCCCC">a</font><font color="#E5E5E5"> pointer</font><font color="#CCCCCC"> a hundred checked into another</font>

240
00:10:34,610 --> 00:10:37,699
place to go where

241
00:10:35,690 --> 00:10:39,020
and the problem<font color="#CCCCCC"> header checksum is that</font>

242
00:10:37,699 --> 00:10:42,290
some networking equipment won't

243
00:10:39,020 --> 00:10:47,120
necessarily<font color="#E5E5E5"> a</font><font color="#CCCCCC"> route your</font>

244
00:10:42,290 --> 00:10:49,069
<font color="#CCCCCC">from your traffic if you do that um you</font>

245
00:10:47,120 --> 00:10:51,440
are also the<font color="#CCCCCC"> an advantage here is that</font>

246
00:10:49,070 --> 00:10:53,300
you were<font color="#CCCCCC"> you're costing your adversary</font>

247
00:10:51,440 --> 00:10:54,500
the person<font color="#E5E5E5"> monitoring you</font><font color="#CCCCCC"> you are</font>

248
00:10:53,300 --> 00:10:56,750
costing them computational overhead

249
00:10:54,500 --> 00:10:58,160
because you are forcing them to

250
00:10:56,750 --> 00:10:59,870
calculate<font color="#E5E5E5"> that</font><font color="#CCCCCC"> checksum</font><font color="#E5E5E5"> for each and</font>

251
00:10:58,160 --> 00:11:03,230
every packet in order to find your

252
00:10:59,870 --> 00:11:06,290
broken check sums<font color="#CCCCCC"> it's um it's difficult</font>

253
00:11:03,230 --> 00:11:08,750
time to live is an interesting place of

254
00:11:06,290 --> 00:11:10,819
<font color="#E5E5E5">if you do if you do a lot of network</font>

255
00:11:08,750 --> 00:11:14,029
<font color="#E5E5E5">significant</font><font color="#CCCCCC"> you will not commonly see</font>

256
00:11:10,819 --> 00:11:16,009
the TTL a packet<font color="#E5E5E5"> jump</font>

257
00:11:14,029 --> 00:11:20,839
however it<font color="#E5E5E5"> happens actually can happen</font>

258
00:11:16,009 --> 00:11:22,670
within a data screen<font color="#E5E5E5"> you'll see that and</font>

259
00:11:20,839 --> 00:11:24,410
you<font color="#E5E5E5"> can have a little bit you do have a</font>

260
00:11:22,670 --> 00:11:27,229
little bit of space to<font color="#E5E5E5"> bury</font><font color="#CCCCCC"> data in</font>

261
00:11:24,410 --> 00:11:29,930
there<font color="#CCCCCC"> and finally what we chose to do</font>

262
00:11:27,230 --> 00:11:34,610
was to use the IP identification field

263
00:11:29,930 --> 00:11:36,199
<font color="#E5E5E5">and you can see part of part of the ipid</font>

264
00:11:34,610 --> 00:11:39,350
field is in the red part<font color="#E5E5E5"> of</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> in the</font>

265
00:11:36,199 --> 00:11:42,529
<font color="#E5E5E5">green</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you are using</font><font color="#CCCCCC"> Microsoft Windows</font>

266
00:11:39,350 --> 00:11:46,130
those<font color="#E5E5E5"> red bits those red bits are zeros</font>

267
00:11:42,529 --> 00:11:47,959
<font color="#CCCCCC">if you are using linux</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> PSD</font><font color="#E5E5E5"> or most</font>

268
00:11:46,130 --> 00:11:52,100
other operating systems<font color="#CCCCCC"> the whole field</font>

269
00:11:47,959 --> 00:11:54,589
is used<font color="#E5E5E5"> we use the lower</font><font color="#CCCCCC"> eight bits of</font>

270
00:11:52,100 --> 00:11:56,870
<font color="#CCCCCC">the field to hide our data because it</font>

271
00:11:54,589 --> 00:11:58,339
because every<font color="#CCCCCC"> us</font><font color="#E5E5E5"> use it if you should</font>

272
00:11:56,870 --> 00:12:01,610
decide to pretend to be<font color="#CCCCCC"> windows you can</font>

273
00:11:58,339 --> 00:12:05,720
<font color="#CCCCCC">handle</font><font color="#E5E5E5"> out those red</font><font color="#CCCCCC"> boots there and and</font>

274
00:12:01,610 --> 00:12:06,920
still<font color="#CCCCCC"> seem</font><font color="#E5E5E5"> natural the copy</font><font color="#CCCCCC"> that they're</font>

275
00:12:05,720 --> 00:12:09,649
really important thing to know if you

276
00:12:06,920 --> 00:12:14,569
are going to use the<font color="#E5E5E5"> ipid field is that</font>

277
00:12:09,649 --> 00:12:17,449
<font color="#CCCCCC">and this has caused a lot of headaches</font>

278
00:12:14,569 --> 00:12:22,160
it can't be<font color="#CCCCCC"> 0 there's actually RFC about</font>

279
00:12:17,449 --> 00:12:24,380
that<font color="#E5E5E5"> of apparently ipsec</font><font color="#CCCCCC"> breaks in 40</font>

280
00:12:22,160 --> 00:12:26,959
<font color="#E5E5E5">and if you try to do pack of</font><font color="#CCCCCC"> spoofing</font><font color="#E5E5E5"> on</font>

281
00:12:24,380 --> 00:12:31,069
<font color="#E5E5E5">linux and you</font><font color="#CCCCCC"> set</font><font color="#E5E5E5"> your ipid to feel 20</font>

282
00:12:26,959 --> 00:12:36,260
of<font color="#CCCCCC"> linux will</font><font color="#E5E5E5"> fix that for you</font>

283
00:12:31,069 --> 00:12:37,699
<font color="#E5E5E5">yeah yeah which also by the way if</font>

284
00:12:36,260 --> 00:12:40,100
anybody ever tried to do packets moving

285
00:12:37,699 --> 00:12:42,680
from<font color="#E5E5E5"> windows windows does a lot of that</font>

286
00:12:40,100 --> 00:12:44,720
kind of fixing for you<font color="#CCCCCC"> of yeah these</font>

287
00:12:42,680 --> 00:12:46,910
techniques are they don't do windows

288
00:12:44,720 --> 00:12:49,130
very well

289
00:12:46,910 --> 00:12:52,250
<font color="#CCCCCC">ok tcp</font><font color="#E5E5E5"> again we talked about the source</font>

290
00:12:49,130 --> 00:12:55,010
ports and the sequence numbers<font color="#E5E5E5"> there are</font>

291
00:12:52,250 --> 00:12:56,990
some reserved fields for<font color="#E5E5E5"> within within</font>

292
00:12:55,010 --> 00:13:00,770
all these protocols<font color="#CCCCCC"> the reserve fields i</font>

293
00:12:56,990 --> 00:13:02,270
would kind of<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of caution against on</font>

294
00:13:00,770 --> 00:13:03,740
the one hand for the reserved and<font color="#CCCCCC"> who</font>

295
00:13:02,270 --> 00:13:06,350
<font color="#CCCCCC">are they reserved for reserved for</font>

296
00:13:03,740 --> 00:13:09,770
everybody<font color="#CCCCCC"> okay for all of us</font><font color="#E5E5E5"> but</font>

297
00:13:06,350 --> 00:13:11,060
<font color="#E5E5E5">typically there's</font><font color="#CCCCCC"> zero so you're kind of</font>

298
00:13:09,770 --> 00:13:12,020
create a signature for people<font color="#E5E5E5"> who are</font>

299
00:13:11,060 --> 00:13:14,930
using them

300
00:13:12,020 --> 00:13:18,170
similarly the window it shouldn't have

301
00:13:14,930 --> 00:13:20,449
that much variability but the<font color="#CCCCCC"> you know</font>

302
00:13:18,170 --> 00:13:22,790
<font color="#E5E5E5">there's going to be some</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> padding is</font>

303
00:13:20,450 --> 00:13:25,910
just like the<font color="#E5E5E5"> reserve fields in that</font>

304
00:13:22,790 --> 00:13:28,490
typically<font color="#E5E5E5"> it's going to be 0 but if you</font>

305
00:13:25,910 --> 00:13:30,439
want to you want to defy expectations

306
00:13:28,490 --> 00:13:33,560
<font color="#E5E5E5">there maybe they won't see it</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> again</font>

307
00:13:30,440 --> 00:13:34,670
<font color="#E5E5E5">the check sums of again maybe he's</font>

308
00:13:33,560 --> 00:13:36,739
<font color="#E5E5E5">networking equipment is going to give</font>

309
00:13:34,670 --> 00:13:38,630
you<font color="#CCCCCC"> were</font><font color="#E5E5E5"> some problems</font><font color="#CCCCCC"> if you have a</font>

310
00:13:36,740 --> 00:13:39,980
broken<font color="#E5E5E5"> checksum</font><font color="#CCCCCC"> maybe some operating</font>

311
00:13:38,630 --> 00:13:41,960
systems might even try to fix that<font color="#E5E5E5"> check</font>

312
00:13:39,980 --> 00:13:45,110
<font color="#CCCCCC">them for you</font><font color="#E5E5E5"> but again it is</font>

313
00:13:41,960 --> 00:13:48,230
computationally intensive<font color="#CCCCCC"> ish especially</font>

314
00:13:45,110 --> 00:13:52,700
if you are monitoring<font color="#E5E5E5"> thousands or tens</font>

315
00:13:48,230 --> 00:13:54,830
of thousands<font color="#E5E5E5"> are</font><font color="#CCCCCC"> a whole country beauty</font>

316
00:13:52,700 --> 00:13:56,150
<font color="#E5E5E5">has similar issues again</font><font color="#CCCCCC"> the length</font>

317
00:13:54,830 --> 00:13:57,860
field we talked we talked about

318
00:13:56,150 --> 00:13:59,480
modifying the length of the data grams

319
00:13:57,860 --> 00:14:02,870
and you absolutely can

320
00:13:59,480 --> 00:14:04,730
<font color="#E5E5E5">hi data</font><font color="#CCCCCC"> they're the source address which</font>

321
00:14:02,870 --> 00:14:08,870
<font color="#CCCCCC">in heat this is really strange because</font>

322
00:14:04,730 --> 00:14:11,840
we<font color="#E5E5E5"> we actually</font><font color="#CCCCCC"> i copied</font><font color="#E5E5E5"> a that chart</font>

323
00:14:08,870 --> 00:14:13,910
from the RFC<font color="#E5E5E5"> it's a source address but I</font>

324
00:14:11,840 --> 00:14:15,410
think all of us would probably more<font color="#CCCCCC"> more</font>

325
00:14:13,910 --> 00:14:17,209
commonly referred to as<font color="#CCCCCC"> a source port</font>

326
00:14:15,410 --> 00:14:19,130
but again if you want to fire off a

327
00:14:17,210 --> 00:14:21,710
bunch of data<font color="#E5E5E5"> grams between point A and</font>

328
00:14:19,130 --> 00:14:24,680
point B and change<font color="#CCCCCC"> those sorts of the</font>

329
00:14:21,710 --> 00:14:26,230
source ports<font color="#CCCCCC"> it would be</font><font color="#E5E5E5"> difficult to</font>

330
00:14:24,680 --> 00:14:29,290
detect

331
00:14:26,230 --> 00:14:30,970
and finally<font color="#CCCCCC"> icmp</font><font color="#E5E5E5"> and the tool that we</font>

332
00:14:29,290 --> 00:14:33,520
<font color="#CCCCCC">developed does have an ICMP mode as well</font>

333
00:14:30,970 --> 00:14:35,920
as a<font color="#CCCCCC"> tcp mode</font><font color="#E5E5E5"> in both of those modes</font>

334
00:14:33,520 --> 00:14:38,410
however we are choosing the IP<font color="#CCCCCC"> headers</font>

335
00:14:35,920 --> 00:14:40,209
to hide our data<font color="#E5E5E5"> if you want to go a</font>

336
00:14:38,410 --> 00:14:43,480
different route<font color="#E5E5E5"> you have some</font>

337
00:14:40,210 --> 00:14:45,550
variability<font color="#CCCCCC"> within icmp</font><font color="#E5E5E5"> and specifically</font>

338
00:14:43,480 --> 00:14:51,520
<font color="#E5E5E5">again the checksum is there there are</font>

339
00:14:45,550 --> 00:14:54,400
<font color="#CCCCCC">icmp it's assume that that the packets</font>

340
00:14:51,520 --> 00:14:55,720
<font color="#CCCCCC">are gonna</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> in a</font><font color="#E5E5E5"> sequence</font><font color="#CCCCCC"> so you've got</font>

341
00:14:54,400 --> 00:14:57,850
some sequence<font color="#E5E5E5"> numbers there if the</font>

342
00:14:55,720 --> 00:15:00,130
package arrived<font color="#E5E5E5"> out of sequence that</font>

343
00:14:57,850 --> 00:15:03,100
feels a little<font color="#E5E5E5"> detectable to</font><font color="#CCCCCC"> meet but</font>

344
00:15:00,130 --> 00:15:04,000
again it's a new signature something

345
00:15:03,100 --> 00:15:07,330
that they would have to check for<font color="#CCCCCC"> $MONEY</font>

346
00:15:04,000 --> 00:15:09,490
and<font color="#CCCCCC"> i'd</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> to talk a little bit about</font>

347
00:15:07,330 --> 00:15:12,370
the data<font color="#CCCCCC"> field with an ICMP because</font>

348
00:15:09,490 --> 00:15:13,960
there are<font color="#E5E5E5"> ICP</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just about</font><font color="#CCCCCC"> echo request</font>

349
00:15:12,370 --> 00:15:16,660
<font color="#E5E5E5">it's not just about</font><font color="#CCCCCC"> paying it's bigger</font>

350
00:15:13,960 --> 00:15:19,360
than that<font color="#E5E5E5"> and you can do timestamps</font>

351
00:15:16,660 --> 00:15:21,730
<font color="#CCCCCC">although we talked about not putting</font>

352
00:15:19,360 --> 00:15:23,680
that data in the in the payload section

353
00:15:21,730 --> 00:15:24,850
<font color="#CCCCCC">i think it's a little bit arguable</font><font color="#E5E5E5"> in</font>

354
00:15:23,680 --> 00:15:28,510
terms of where<font color="#CCCCCC"> that payload</font><font color="#E5E5E5"> section</font>

355
00:15:24,850 --> 00:15:30,310
stops and starts with an<font color="#CCCCCC"> ICMP so if you</font>

356
00:15:28,510 --> 00:15:32,319
are going to do<font color="#CCCCCC"> timestamp requests</font>

357
00:15:30,310 --> 00:15:35,650
there are<font color="#CCCCCC"> microseconds</font><font color="#E5E5E5"> within that</font>

358
00:15:32,320 --> 00:15:37,480
within that time Stanfield and<font color="#E5E5E5"> I have</font>

359
00:15:35,650 --> 00:15:39,069
serious doubts as to whether anyone

360
00:15:37,480 --> 00:15:43,960
really does have the computational

361
00:15:39,070 --> 00:15:45,280
wherewithal to check that<font color="#E5E5E5"> field</font><font color="#CCCCCC"> 212</font>

362
00:15:43,960 --> 00:15:46,480
check your<font color="#CCCCCC"> microseconds I think</font><font color="#E5E5E5"> that</font>

363
00:15:45,280 --> 00:15:48,939
would be<font color="#E5E5E5"> really hard</font>

364
00:15:46,480 --> 00:15:51,400
mind you<font color="#CCCCCC"> I haven't done the research on</font>

365
00:15:48,940 --> 00:15:53,470
that if if<font color="#E5E5E5"> timestamps follow really</font>

366
00:15:51,400 --> 00:15:55,569
great<font color="#E5E5E5"> predictable patterns without</font>

367
00:15:53,470 --> 00:15:57,640
variability that<font color="#E5E5E5"> would be interesting to</font>

368
00:15:55,570 --> 00:16:00,610
find out but<font color="#CCCCCC"> i kinda doubt it</font>

369
00:15:57,640 --> 00:16:04,210
there are also fields that are<font color="#E5E5E5"> marked</font>

370
00:16:00,610 --> 00:16:05,830
with in there are<font color="#CCCCCC"> icmp filled in some of</font>

371
00:16:04,210 --> 00:16:10,090
the ICP protocols that are marked as

372
00:16:05,830 --> 00:16:11,860
<font color="#E5E5E5">unused and specifically those include</font>

373
00:16:10,090 --> 00:16:14,230
<font color="#E5E5E5">fields within the time exceeded and</font>

374
00:16:11,860 --> 00:16:19,270
destination unreachable<font color="#CCCCCC"> icmp met</font>

375
00:16:14,230 --> 00:16:24,490
messages<font color="#E5E5E5"> though</font><font color="#CCCCCC"> um</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> unused so</font>

376
00:16:19,270 --> 00:16:25,850
typically<font color="#CCCCCC"> on use</font><font color="#E5E5E5"> fields</font><font color="#CCCCCC"> rr0 but maybe we</font>

377
00:16:24,490 --> 00:16:29,600
can use them

378
00:16:25,850 --> 00:16:33,259
and it in the development of the tool

379
00:16:29,600 --> 00:16:37,100
that we created for this talk<font color="#E5E5E5"> we face</font>

380
00:16:33,259 --> 00:16:40,610
<font color="#CCCCCC">them we face</font><font color="#E5E5E5"> some problems and their</font>

381
00:16:37,100 --> 00:16:42,649
solutions to those problems and<font color="#CCCCCC"> I</font><font color="#E5E5E5"> want</font>

382
00:16:40,610 --> 00:16:43,610
to<font color="#E5E5E5"> represent a theoretical framework for</font>

383
00:16:42,649 --> 00:16:45,529
how you can develop your own

384
00:16:43,610 --> 00:16:47,269
<font color="#CCCCCC">network-based</font><font color="#E5E5E5"> second</font><font color="#CCCCCC"> graphics solutions</font>

385
00:16:45,529 --> 00:16:48,889
and maybe you<font color="#CCCCCC"> don't hit your head</font>

386
00:16:47,269 --> 00:16:53,300
against that wall as much as<font color="#E5E5E5"> I did</font>

387
00:16:48,889 --> 00:16:54,500
<font color="#E5E5E5">and here's an anatomy of us</font><font color="#CCCCCC"> to connect</font>

388
00:16:53,300 --> 00:16:56,359
<font color="#CCCCCC">graphics system if you follow this</font>

389
00:16:54,500 --> 00:16:58,730
pattern<font color="#CCCCCC"> i think you can you can devise a</font>

390
00:16:56,360 --> 00:17:00,470
workable solution for yourself and

391
00:16:58,730 --> 00:17:04,189
<font color="#CCCCCC">you'll avoid</font><font color="#E5E5E5"> some of the problems</font><font color="#CCCCCC"> i did</font>

392
00:17:00,470 --> 00:17:05,419
not get<font color="#E5E5E5"> to avoid so um</font>

393
00:17:04,189 --> 00:17:09,260
specifically<font color="#E5E5E5"> let's talk about the</font>

394
00:17:05,419 --> 00:17:12,079
initiator<font color="#E5E5E5"> you have two nodes for this</font>

395
00:17:09,260 --> 00:17:13,849
for this data<font color="#E5E5E5"> channel</font><font color="#CCCCCC"> you have the</font>

396
00:17:12,079 --> 00:17:17,000
<font color="#E5E5E5">sender and the receiver and if it's</font>

397
00:17:13,849 --> 00:17:19,819
<font color="#E5E5E5">two-way communication</font><font color="#CCCCCC"> the sender and the</font>

398
00:17:17,000 --> 00:17:23,630
receiver will reverse depending<font color="#E5E5E5"> on which</font>

399
00:17:19,819 --> 00:17:27,770
way which way<font color="#E5E5E5"> we're going the initiator</font>

400
00:17:23,630 --> 00:17:30,650
<font color="#E5E5E5">simply tells the other end when to when</font>

401
00:17:27,770 --> 00:17:31,908
the data<font color="#E5E5E5"> communication</font><font color="#CCCCCC"> is started</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font>

402
00:17:30,650 --> 00:17:34,610
think you really ought to choose

403
00:17:31,909 --> 00:17:38,929
something that happens naturally<font color="#E5E5E5"> and in</font>

404
00:17:34,610 --> 00:17:43,039
<font color="#CCCCCC">icmp mode the choice that we made was an</font>

405
00:17:38,929 --> 00:17:46,940
<font color="#CCCCCC">ICMP echo</font><font color="#E5E5E5"> request packet</font><font color="#CCCCCC"> whose</font><font color="#E5E5E5"> sequence</font>

406
00:17:43,039 --> 00:17:51,289
number was<font color="#E5E5E5"> one and if you use a mac OS</font>

407
00:17:46,940 --> 00:17:53,270
or<font color="#CCCCCC"> linux know if</font><font color="#E5E5E5"> he's</font><font color="#CCCCCC"> linux than the</font>

408
00:17:51,289 --> 00:17:55,850
initial sequence number is<font color="#CCCCCC"> one if you</font>

409
00:17:53,270 --> 00:17:58,340
use<font color="#CCCCCC"> mac OS four</font><font color="#E5E5E5"> BS most of the BS</font><font color="#CCCCCC"> DS</font><font color="#E5E5E5"> the</font>

410
00:17:55,850 --> 00:17:59,719
sequence number is going to be<font color="#CCCCCC"> 0 of</font><font color="#E5E5E5"> the</font>

411
00:17:58,340 --> 00:18:01,309
payload fields are roughly equivalent

412
00:17:59,720 --> 00:18:03,230
<font color="#CCCCCC">i'm not really sure</font>

413
00:18:01,309 --> 00:18:06,620
not really sure that difference there

414
00:18:03,230 --> 00:18:08,780
interestingly enough<font color="#CCCCCC"> um</font><font color="#E5E5E5"> the initial</font><font color="#CCCCCC"> laws</font>

415
00:18:06,620 --> 00:18:11,870
<font color="#CCCCCC">sequence number</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> windows that</font>

416
00:18:08,780 --> 00:18:14,270
actually<font color="#E5E5E5"> save state between pings</font><font color="#CCCCCC"> so if</font>

417
00:18:11,870 --> 00:18:16,639
you<font color="#CCCCCC"> send</font><font color="#E5E5E5"> five packets</font><font color="#CCCCCC"> your first time</font>

418
00:18:14,270 --> 00:18:18,230
it's<font color="#E5E5E5"> going to go 0 through 4 and then</font>

419
00:18:16,640 --> 00:18:19,700
the next time you<font color="#CCCCCC"> pick</font><font color="#E5E5E5"> somebody your</font>

420
00:18:18,230 --> 00:18:21,440
initial sequence number is going to be<font color="#CCCCCC"> 5</font>

421
00:18:19,700 --> 00:18:23,120
<font color="#CCCCCC">I don't know where that data gets stored</font>

422
00:18:21,440 --> 00:18:26,600
<font color="#CCCCCC">i</font><font color="#E5E5E5"> thought that was kinda interesting in</font>

423
00:18:23,120 --> 00:18:28,189
<font color="#E5E5E5">it</font><font color="#CCCCCC"> an interesting anomaly there you can</font>

424
00:18:26,600 --> 00:18:29,360
<font color="#E5E5E5">choose a different sequence number if</font>

425
00:18:28,190 --> 00:18:33,710
you want to start from<font color="#CCCCCC"> zero if you want</font>

426
00:18:29,360 --> 00:18:36,049
to start from 87<font color="#CCCCCC"> but either way of i</font>

427
00:18:33,710 --> 00:18:36,590
really recommend using<font color="#CCCCCC"> is an initiator</font>

428
00:18:36,049 --> 00:18:39,529
that

429
00:18:36,590 --> 00:18:42,408
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is prone to false positives that</font>

430
00:18:39,529 --> 00:18:45,020
way you are more difficult to detect<font color="#E5E5E5"> so</font>

431
00:18:42,409 --> 00:18:46,010
the initiator that we use for<font color="#CCCCCC"> tcp modus</font>

432
00:18:45,020 --> 00:18:48,889
<font color="#E5E5E5">that simple</font>

433
00:18:46,010 --> 00:18:50,179
<font color="#CCCCCC">TG tcp</font><font color="#E5E5E5"> syn the receiver</font><font color="#CCCCCC"> every time you</font>

434
00:18:48,890 --> 00:18:53,690
<font color="#E5E5E5">see the</font><font color="#CCCCCC"> tcp syn with an</font><font color="#E5E5E5"> unknown</font>

435
00:18:50,179 --> 00:18:55,700
destination<font color="#E5E5E5"> address it decides that that</font>

436
00:18:53,690 --> 00:18:58,190
is going to reconstruct that data<font color="#CCCCCC"> Graham</font>

437
00:18:55,700 --> 00:19:00,320
and it's wrong a lot but that's<font color="#CCCCCC"> okay</font>

438
00:18:58,190 --> 00:19:02,690
because again<font color="#E5E5E5"> that makes</font><font color="#CCCCCC"> you more</font>

439
00:19:00,320 --> 00:19:06,649
<font color="#CCCCCC">difficult to detect if that initiate or</font>

440
00:19:02,690 --> 00:19:09,200
event happens over and over again<font color="#CCCCCC"> you</font>

441
00:19:06,650 --> 00:19:10,730
<font color="#E5E5E5">will also need a sequencer</font><font color="#CCCCCC"> so if</font><font color="#E5E5E5"> you are</font>

442
00:19:09,200 --> 00:19:13,070
designing any kind of<font color="#CCCCCC"> a network protocol</font>

443
00:19:10,730 --> 00:19:16,309
anything that ever<font color="#E5E5E5"> transmits data from</font>

444
00:19:13,070 --> 00:19:18,080
point<font color="#CCCCCC"> A to point B you should not assume</font>

445
00:19:16,309 --> 00:19:22,158
that your data will get from point<font color="#CCCCCC"> A to</font>

446
00:19:18,080 --> 00:19:24,529
point<font color="#CCCCCC"> B</font><font color="#E5E5E5"> in order so you need something</font>

447
00:19:22,159 --> 00:19:28,159
that has predictable numbers that either

448
00:19:24,529 --> 00:19:30,140
are sequentially naturally or<font color="#E5E5E5"> they</font>

449
00:19:28,159 --> 00:19:34,580
follow a sequence that that you control

450
00:19:30,140 --> 00:19:36,140
or can predict and again for<font color="#CCCCCC"> tcp mode we</font>

451
00:19:34,580 --> 00:19:38,809
actually use the same sequence<font color="#E5E5E5"> numbers</font>

452
00:19:36,140 --> 00:19:41,990
that<font color="#CCCCCC"> there we all know and love for tcp</font>

453
00:19:38,809 --> 00:19:43,279
and pricing<font color="#CCCCCC"> p mode again</font><font color="#E5E5E5"> it's the</font>

454
00:19:41,990 --> 00:19:45,080
sequence number because if you do<font color="#CCCCCC"> pick</font>

455
00:19:43,279 --> 00:19:47,210
somebody<font color="#CCCCCC"> the</font><font color="#E5E5E5"> sequence numbers are going</font>

456
00:19:45,080 --> 00:19:50,720
to increment by 1 each and every time

457
00:19:47,210 --> 00:19:54,320
<font color="#E5E5E5">there's also the next part of it is a</font>

458
00:19:50,720 --> 00:19:55,789
data data received verification and in

459
00:19:54,320 --> 00:19:58,668
short questionnaire answering<font color="#CCCCCC"> there is</font>

460
00:19:55,789 --> 00:20:01,760
how do we know that our data actually

461
00:19:58,669 --> 00:20:03,409
got through<font color="#CCCCCC"> now the reason</font><font color="#E5E5E5"> why even</font>

462
00:20:01,760 --> 00:20:07,520
bring this up at all is because once you

463
00:20:03,409 --> 00:20:10,070
lose that layer<font color="#CCCCCC"> for</font><font color="#E5E5E5"> of the protocol</font><font color="#CCCCCC"> man</font>

464
00:20:07,520 --> 00:20:12,080
<font color="#E5E5E5">you got a lot of problems</font><font color="#CCCCCC"> tcp does a lot</font>

465
00:20:10,070 --> 00:20:13,279
of really nice work for you and

466
00:20:12,080 --> 00:20:16,908
unfortunately<font color="#E5E5E5"> you're doing</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> second</font>

467
00:20:13,279 --> 00:20:18,799
<font color="#E5E5E5">graphic system</font><font color="#CCCCCC"> you've</font><font color="#E5E5E5"> given all that up</font>

468
00:20:16,909 --> 00:20:22,429
and you really do have to reinvent the

469
00:20:18,799 --> 00:20:25,490
wheel a bit<font color="#E5E5E5"> and in both these cases of</font>

470
00:20:22,429 --> 00:20:29,539
the solutions that we chose<font color="#CCCCCC"> more or less</font>

471
00:20:25,490 --> 00:20:32,390
<font color="#E5E5E5">piggybacked on what was already there so</font>

472
00:20:29,539 --> 00:20:34,640
the data received verification for icmp

473
00:20:32,390 --> 00:20:37,070
with simple<font color="#E5E5E5"> echo</font><font color="#CCCCCC"> Rico response</font><font color="#E5E5E5"> once we</font>

474
00:20:34,640 --> 00:20:39,110
get<font color="#CCCCCC"> that</font><font color="#E5E5E5"> response we know that the pack</font>

475
00:20:37,070 --> 00:20:42,049
<font color="#E5E5E5">the data that we</font><font color="#CCCCCC"> descent was received</font>

476
00:20:39,110 --> 00:20:45,770
successfully and we use the the<font color="#E5E5E5"> acts</font>

477
00:20:42,049 --> 00:20:47,450
within a within a<font color="#CCCCCC"> tcp data stream as a</font>

478
00:20:45,770 --> 00:20:49,309
<font color="#E5E5E5">as</font><font color="#CCCCCC"> acknowledgement packets they're</font>

479
00:20:47,450 --> 00:20:49,870
actually doing what<font color="#E5E5E5"> they're supposed to</font>

480
00:20:49,309 --> 00:20:52,240
do

481
00:20:49,870 --> 00:20:54,550
not necessarily in the way that<font color="#E5E5E5"> they're</font>

482
00:20:52,240 --> 00:20:56,050
designers intended<font color="#CCCCCC"> there are probably</font>

483
00:20:54,550 --> 00:20:57,610
other ways to do it<font color="#E5E5E5"> if somebody wants to</font>

484
00:20:56,050 --> 00:21:00,520
do that research<font color="#CCCCCC"> i would</font><font color="#E5E5E5"> love to see it</font>

485
00:20:57,610 --> 00:21:03,219
and the final problem that<font color="#CCCCCC"> we've</font>

486
00:21:00,520 --> 00:21:04,270
<font color="#E5E5E5">identified that that anybody else who</font>

487
00:21:03,220 --> 00:21:07,120
tries to come up with<font color="#E5E5E5"> her own</font>

488
00:21:04,270 --> 00:21:09,730
<font color="#CCCCCC">stenographic</font><font color="#E5E5E5"> system will have</font><font color="#CCCCCC"> two will</font>

489
00:21:07,120 --> 00:21:12,879
have<font color="#E5E5E5"> to solve</font><font color="#CCCCCC"> is a termination</font>

490
00:21:09,730 --> 00:21:15,309
reassembly<font color="#CCCCCC"> how does the receiver of that</font>

491
00:21:12,880 --> 00:21:16,510
data<font color="#CCCCCC"> Graham know that the datagram</font><font color="#E5E5E5"> is</font>

492
00:21:15,309 --> 00:21:17,290
complete how does he know that he has

493
00:21:16,510 --> 00:21:21,430
all the data

494
00:21:17,290 --> 00:21:23,350
well we we took<font color="#CCCCCC"> we took it actually</font>

495
00:21:21,430 --> 00:21:26,020
streaming<font color="#CCCCCC"> cipher</font><font color="#E5E5E5"> and we</font><font color="#CCCCCC"> turned</font><font color="#E5E5E5"> into a</font>

496
00:21:23,350 --> 00:21:27,699
block cipher so we<font color="#CCCCCC"> count that we come in</font>

497
00:21:26,020 --> 00:21:29,470
both modes we count the data packets

498
00:21:27,700 --> 00:21:32,860
<font color="#CCCCCC">once we get a full block which by</font>

499
00:21:29,470 --> 00:21:34,960
default is 256<font color="#E5E5E5"> plates we know to start</font>

500
00:21:32,860 --> 00:21:37,899
decrypting that you can set<font color="#CCCCCC"> pandey</font>

501
00:21:34,960 --> 00:21:40,330
<font color="#E5E5E5">padded consent padding</font><font color="#CCCCCC"> lights after</font><font color="#E5E5E5"> that</font>

502
00:21:37,900 --> 00:21:45,070
<font color="#E5E5E5">if you want to obscure yourself a little</font>

503
00:21:40,330 --> 00:21:50,050
bit more but<font color="#E5E5E5"> but right now I just do</font>

504
00:21:45,070 --> 00:21:52,240
<font color="#CCCCCC">what I</font><font color="#E5E5E5"> just by counting</font><font color="#CCCCCC"> so Anna</font>

505
00:21:50,050 --> 00:21:54,370
important<font color="#E5E5E5"> to think</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> will keep in</font>

506
00:21:52,240 --> 00:21:56,800
mind here is that like all data

507
00:21:54,370 --> 00:21:59,800
transmissions<font color="#CCCCCC"> you really</font><font color="#E5E5E5"> ought to use</font>

508
00:21:56,800 --> 00:22:01,510
cryptography and unfortunately you do

509
00:21:59,800 --> 00:22:06,100
have a few concerns<font color="#E5E5E5"> here that normally</font>

510
00:22:01,510 --> 00:22:10,420
you will not you will not encounter<font color="#CCCCCC"> if</font>

511
00:22:06,100 --> 00:22:13,090
you're doing it you're doing a new

512
00:22:10,420 --> 00:22:14,559
communication system and you want to use

513
00:22:13,090 --> 00:22:16,689
photography within<font color="#CCCCCC"> that communication</font>

514
00:22:14,559 --> 00:22:19,420
system<font color="#E5E5E5"> you would be well advised to use</font>

515
00:22:16,690 --> 00:22:20,920
something like<font color="#E5E5E5"> openssl something that</font>

516
00:22:19,420 --> 00:22:22,870
that exists something that's a little

517
00:22:20,920 --> 00:22:27,490
<font color="#CCCCCC">bit</font><font color="#E5E5E5"> more proven anything you can you're</font>

518
00:22:22,870 --> 00:22:28,899
likely to design<font color="#CCCCCC"> um unfortunately</font><font color="#E5E5E5"> of</font>

519
00:22:27,490 --> 00:22:31,690
what we're doing<font color="#CCCCCC"> network</font><font color="#E5E5E5"> wise</font><font color="#CCCCCC"> is a</font>

520
00:22:28,900 --> 00:22:34,720
little weird<font color="#E5E5E5"> and</font><font color="#CCCCCC"> SL does not necessarily</font>

521
00:22:31,690 --> 00:22:36,429
support that and<font color="#CCCCCC"> what we chose to use</font>

522
00:22:34,720 --> 00:22:37,870
instead was a<font color="#CCCCCC"> and i'll give this a</font>

523
00:22:36,429 --> 00:22:40,420
shadow<font color="#E5E5E5"> pieces</font><font color="#CCCCCC"> it's pretty</font><font color="#E5E5E5"> good</font>

524
00:22:37,870 --> 00:22:42,760
technology<font color="#E5E5E5"> we</font><font color="#CCCCCC"> used a crypto box which</font>

525
00:22:40,420 --> 00:22:46,030
initially was a<font color="#E5E5E5"> product started by dan</font>

526
00:22:42,760 --> 00:22:47,470
bernstein and it it takes care of a lot

527
00:22:46,030 --> 00:22:52,059
of these problems for you

528
00:22:47,470 --> 00:22:54,850
so again<font color="#CCCCCC"> photography</font><font color="#E5E5E5"> is a good thing</font>

529
00:22:52,059 --> 00:22:57,820
<font color="#CCCCCC">it's helpful we all we all</font><font color="#E5E5E5"> know we all</font>

530
00:22:54,850 --> 00:23:00,320
<font color="#E5E5E5">love it but</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> for a second graphic</font>

531
00:22:57,820 --> 00:23:03,080
<font color="#E5E5E5">system it also provides an added benefit</font>

532
00:23:00,320 --> 00:23:06,529
that it makes your<font color="#E5E5E5"> day look random</font><font color="#CCCCCC"> so if</font>

533
00:23:03,080 --> 00:23:09,830
<font color="#E5E5E5">you are hiding in a field like the ipid</font>

534
00:23:06,529 --> 00:23:11,840
<font color="#E5E5E5">field or within</font><font color="#CCCCCC"> tcp sequence numbers</font><font color="#E5E5E5"> if</font>

535
00:23:09,830 --> 00:23:13,668
you're hiding in a field that is already

536
00:23:11,840 --> 00:23:15,408
populated by<font color="#CCCCCC"> pseudo random data</font><font color="#E5E5E5"> then you</font>

537
00:23:13,669 --> 00:23:19,639
want your data to look<font color="#CCCCCC"> at pseudo-random</font>

538
00:23:15,409 --> 00:23:20,990
<font color="#CCCCCC">as possible</font><font color="#E5E5E5"> so if you encrypt it chances</font>

539
00:23:19,639 --> 00:23:21,590
<font color="#CCCCCC">are</font><font color="#E5E5E5"> your data is</font><font color="#CCCCCC"> gonna look pretty</font>

540
00:23:20,990 --> 00:23:23,269
random

541
00:23:21,590 --> 00:23:27,500
maybe<font color="#CCCCCC"> it looks super random maybe it</font>

542
00:23:23,269 --> 00:23:29,659
just looks random but if your adversary

543
00:23:27,500 --> 00:23:31,429
has to tell the difference that is<font color="#E5E5E5"> that</font>

544
00:23:29,659 --> 00:23:33,230
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> not computationally</font><font color="#CCCCCC"> nothing</font><font color="#E5E5E5"> that</font>

545
00:23:31,429 --> 00:23:34,970
actually<font color="#CCCCCC"> takes some effort</font><font color="#E5E5E5"> and if</font>

546
00:23:33,230 --> 00:23:36,830
<font color="#CCCCCC">there's a crypto guy in the audience if</font>

547
00:23:34,970 --> 00:23:38,509
you're great at that<font color="#CCCCCC"> or</font><font color="#E5E5E5"> great statistics</font>

548
00:23:36,830 --> 00:23:42,019
<font color="#CCCCCC">feel</font><font color="#E5E5E5"> free to call me out on this but I</font>

549
00:23:38,509 --> 00:23:44,450
think you need about<font color="#E5E5E5"> the system that we</font>

550
00:23:42,019 --> 00:23:46,700
have<font color="#E5E5E5"> you need about</font><font color="#CCCCCC"> 1,800 packets we</font>

551
00:23:44,450 --> 00:23:48,470
give or take<font color="#CCCCCC"> before you</font><font color="#E5E5E5"> can do that with</font>

552
00:23:46,700 --> 00:23:49,730
any kind of reliability and even then

553
00:23:48,470 --> 00:23:53,629
you're still<font color="#CCCCCC"> going to make some mistakes</font>

554
00:23:49,730 --> 00:23:55,820
so again cryptography in addition to all

555
00:23:53,629 --> 00:23:57,230
its conventional benefits<font color="#CCCCCC"> if you want</font>

556
00:23:55,820 --> 00:24:01,428
your<font color="#E5E5E5"> data</font><font color="#CCCCCC"> look random it's definitely</font>

557
00:23:57,230 --> 00:24:04,070
something to use<font color="#CCCCCC"> um now there</font><font color="#E5E5E5"> are other</font>

558
00:24:01,429 --> 00:24:08,809
cryptographic concerns that you should

559
00:24:04,070 --> 00:24:10,279
keep in mind specifically<font color="#E5E5E5"> of any kind of</font>

560
00:24:08,809 --> 00:24:13,789
system that uses a<font color="#CCCCCC"> you should really</font>

561
00:24:10,279 --> 00:24:16,070
include<font color="#CCCCCC"> announced the reason for that is</font>

562
00:24:13,789 --> 00:24:19,250
if you don't then your data grams are

563
00:24:16,070 --> 00:24:22,070
going to be repetitive<font color="#E5E5E5"> your sequence</font>

564
00:24:19,250 --> 00:24:24,080
numbers<font color="#E5E5E5"> your</font><font color="#CCCCCC"> ipid</font><font color="#E5E5E5"> fields all the data</font>

565
00:24:22,070 --> 00:24:25,668
that that before

566
00:24:24,080 --> 00:24:28,009
maybe would've<font color="#E5E5E5"> looked pseudo-random is</font>

567
00:24:25,669 --> 00:24:31,370
<font color="#E5E5E5">going to repeat over and over again and</font>

568
00:24:28,009 --> 00:24:34,820
<font color="#E5E5E5">not only that detectable but if someone</font>

569
00:24:31,370 --> 00:24:36,649
does detect you<font color="#CCCCCC"> he or she will be able</font>

570
00:24:34,820 --> 00:24:40,039
to do a replay attack and take control

571
00:24:36,649 --> 00:24:41,750
of whatever<font color="#E5E5E5"> a nice server you fought to</font>

572
00:24:40,039 --> 00:24:43,429
gain control of<font color="#CCCCCC"> their just going to take</font>

573
00:24:41,750 --> 00:24:46,309
it from it

574
00:24:43,429 --> 00:24:50,000
in addition<font color="#E5E5E5"> to that I think</font><font color="#CCCCCC"> public-key</font>

575
00:24:46,309 --> 00:24:51,678
cryptography is pretty crucial here with

576
00:24:50,000 --> 00:24:54,470
any kind of cryptographic system you

577
00:24:51,679 --> 00:24:56,340
need some kind of symmetric or

578
00:24:54,470 --> 00:25:00,840
asymmetric secrets

579
00:24:56,340 --> 00:25:05,100
on both sides<font color="#E5E5E5"> and you either need some</font>

580
00:25:00,840 --> 00:25:08,549
kind of<font color="#CCCCCC"> pre-shared key</font><font color="#E5E5E5"> or something and</font>

581
00:25:05,100 --> 00:25:11,760
<font color="#E5E5E5">your choices I</font><font color="#CCCCCC"> i would</font><font color="#E5E5E5"> i would imagine</font>

582
00:25:08,549 --> 00:25:12,809
if the<font color="#CCCCCC"> they're probably</font><font color="#E5E5E5"> someone to</font>

583
00:25:11,760 --> 00:25:15,120
<font color="#CCCCCC">protect either might even be better</font>

584
00:25:12,809 --> 00:25:17,070
ideas<font color="#CCCCCC"> in this but you big choices that</font>

585
00:25:15,120 --> 00:25:19,320
you have here either of<font color="#CCCCCC"> a</font><font color="#E5E5E5"> predefined</font>

586
00:25:17,070 --> 00:25:21,240
<font color="#E5E5E5">public heat private key system or</font><font color="#CCCCCC"> Diddy</font>

587
00:25:19,320 --> 00:25:23,370
<font color="#E5E5E5">helmet and we didn't go</font><font color="#CCCCCC"> through the</font>

588
00:25:21,240 --> 00:25:27,150
<font color="#CCCCCC">Helmand</font><font color="#E5E5E5"> for two reasons the first of</font>

589
00:25:23,370 --> 00:25:30,178
<font color="#E5E5E5">which is a</font><font color="#CCCCCC"> diff</font><font color="#E5E5E5"> helmet is often by</font>

590
00:25:27,150 --> 00:25:32,760
itself<font color="#E5E5E5"> susceptible to a</font>

591
00:25:30,179 --> 00:25:33,690
man-in-the-middle attacks<font color="#E5E5E5"> if someone</font>

592
00:25:32,760 --> 00:25:34,679
wants to pretend to be one of your

593
00:25:33,690 --> 00:25:36,149
<font color="#CCCCCC">EndNote</font><font color="#E5E5E5"> and they want to do the</font>

594
00:25:34,679 --> 00:25:37,440
diffie-hellman handshake

595
00:25:36,149 --> 00:25:40,590
there's not really a lot stopping<font color="#E5E5E5"> them</font>

596
00:25:37,440 --> 00:25:42,360
from the<font color="#CCCCCC"> public/private key system if</font>

597
00:25:40,590 --> 00:25:45,629
you<font color="#CCCCCC"> share that information initially</font>

598
00:25:42,360 --> 00:25:48,600
<font color="#E5E5E5">then you don't have that you don't have</font>

599
00:25:45,630 --> 00:25:50,309
that problem as much<font color="#CCCCCC"> you</font><font color="#E5E5E5"> do have some</font>

600
00:25:48,600 --> 00:25:53,969
cryptographic<font color="#E5E5E5"> verification on both sides</font>

601
00:25:50,309 --> 00:25:58,260
<font color="#E5E5E5">and</font><font color="#CCCCCC"> it also allows you to do a symmetric</font>

602
00:25:53,970 --> 00:26:00,179
communications<font color="#E5E5E5"> so uh</font><font color="#CCCCCC"> and here's a good</font>

603
00:25:58,260 --> 00:26:03,720
<font color="#E5E5E5">trip you up if you want to use a system</font>

604
00:26:00,179 --> 00:26:05,760
like this<font color="#CCCCCC"> an ICMP mode</font><font color="#E5E5E5"> if you use</font>

605
00:26:03,720 --> 00:26:08,190
<font color="#E5E5E5">packets</font><font color="#CCCCCC"> spoofing and you</font><font color="#E5E5E5"> change your</font>

606
00:26:05,760 --> 00:26:09,330
source address to be the address of the

607
00:26:08,190 --> 00:26:11,789
<font color="#E5E5E5">machine with which</font><font color="#CCCCCC"> you are communicating</font>

608
00:26:09,330 --> 00:26:14,399
<font color="#CCCCCC">then you can bounce those datagrams off</font>

609
00:26:11,789 --> 00:26:15,658
of a third party and make it look like

610
00:26:14,399 --> 00:26:18,059
those<font color="#CCCCCC"> datagrams are coming off that</font>

611
00:26:15,659 --> 00:26:19,679
<font color="#CCCCCC">third-party so basically you make it</font>

612
00:26:18,059 --> 00:26:22,049
look<font color="#E5E5E5"> like</font><font color="#CCCCCC"> machine they're communicating</font>

613
00:26:19,679 --> 00:26:23,460
with<font color="#CCCCCC"> his pain that</font><font color="#E5E5E5"> that third party and</font>

614
00:26:22,049 --> 00:26:26,370
the third party does what it's supposed

615
00:26:23,460 --> 00:26:30,840
to do and responds with<font color="#CCCCCC"> echo responses</font>

616
00:26:26,370 --> 00:26:33,239
which will be interpreted as<font color="#E5E5E5"> at as data</font>

617
00:26:30,840 --> 00:26:34,620
<font color="#E5E5E5">so it will make you even harder to</font>

618
00:26:33,240 --> 00:26:35,880
detect because they<font color="#E5E5E5"> will know for sure</font>

619
00:26:34,620 --> 00:26:39,870
where you're coming from

620
00:26:35,880 --> 00:26:44,070
especially if you<font color="#E5E5E5"> teachings that if you</font>

621
00:26:39,870 --> 00:26:45,149
change that<font color="#E5E5E5"> reflector periodically and</font><font color="#CCCCCC"> i</font>

622
00:26:44,070 --> 00:26:47,039
say this<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I know there's some</font>

623
00:26:45,149 --> 00:26:49,620
<font color="#CCCCCC">testers</font><font color="#E5E5E5"> in the audience and avoiding</font>

624
00:26:47,039 --> 00:26:52,529
detection is<font color="#CCCCCC"> it's a big deal on a lot of</font>

625
00:26:49,620 --> 00:26:55,500
<font color="#CCCCCC">pen test so here's a new technique</font>

626
00:26:52,529 --> 00:26:58,710
go ahead<font color="#E5E5E5"> also data validation is</font><font color="#CCCCCC"> an</font>

627
00:26:55,500 --> 00:27:00,360
important important feature and crypto

628
00:26:58,710 --> 00:27:02,730
box again takes care of that for you the

629
00:27:00,360 --> 00:27:03,870
first<font color="#E5E5E5"> 16 bytes of that you will send are</font>

630
00:27:02,730 --> 00:27:06,659
actually going to be a digital signature

631
00:27:03,870 --> 00:27:07,949
<font color="#E5E5E5">and if you don't do data validation some</font>

632
00:27:06,659 --> 00:27:11,970
<font color="#E5E5E5">Joker is going to</font>

633
00:27:07,950 --> 00:27:16,139
you were gonna<font color="#CCCCCC"> store</font><font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> now</font>

634
00:27:11,970 --> 00:27:18,510
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> like the results</font><font color="#CCCCCC"> so if you</font>

635
00:27:16,139 --> 00:27:21,990
want to see this tool<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> available on</font>

636
00:27:18,510 --> 00:27:25,620
github<font color="#E5E5E5"> and you can see the URL there and</font>

637
00:27:21,990 --> 00:27:27,840
it it is<font color="#E5E5E5"> currently</font><font color="#CCCCCC"> little licks tool</font><font color="#E5E5E5"> if</font>

638
00:27:25,620 --> 00:27:29,549
<font color="#E5E5E5">you want to put it to</font><font color="#CCCCCC"> PSD or mac OS</font>

639
00:27:27,840 --> 00:27:34,559
that's actually not that difficult

640
00:27:29,549 --> 00:27:36,658
<font color="#E5E5E5">um uh</font><font color="#CCCCCC"> and contrast the the</font><font color="#E5E5E5"> windows port</font>

641
00:27:34,559 --> 00:27:38,789
is a<font color="#CCCCCC"> sword extraordinarily difficult</font>

642
00:27:36,659 --> 00:27:41,370
<font color="#CCCCCC">anybody's trying to do packets</font><font color="#E5E5E5"> moving on</font>

643
00:27:38,789 --> 00:27:42,899
<font color="#CCCCCC">Windows that's really</font><font color="#E5E5E5"> hard and a lot of</font>

644
00:27:41,370 --> 00:27:45,090
people<font color="#E5E5E5"> going to tell you to use the TCAP</font>

645
00:27:42,899 --> 00:27:47,370
however one of the design goals for this

646
00:27:45,090 --> 00:27:49,559
whole project was to not require the

647
00:27:47,370 --> 00:27:53,489
addition of it of any drivers or kernel

648
00:27:49,559 --> 00:27:55,559
modules for you for either node of the

649
00:27:53,490 --> 00:27:57,000
way that we have a<font color="#E5E5E5"> right now you can do</font>

650
00:27:55,559 --> 00:28:01,590
<font color="#E5E5E5">a static build and then just upload your</font>

651
00:27:57,000 --> 00:28:03,450
binary<font color="#CCCCCC"> I think kernel modules or</font><font color="#E5E5E5"> drivers</font>

652
00:28:01,590 --> 00:28:06,658
additional ones are relatively easy to

653
00:28:03,450 --> 00:28:09,570
detect<font color="#CCCCCC"> so that was something that we</font>

654
00:28:06,659 --> 00:28:11,130
wanted to avoid<font color="#CCCCCC"> and</font><font color="#E5E5E5"> made a promise to</font>

655
00:28:09,570 --> 00:28:13,049
acknowledge<font color="#E5E5E5"> of nowhere but down here</font>

656
00:28:11,130 --> 00:28:17,010
<font color="#E5E5E5">because the whole project started with</font>

657
00:28:13,049 --> 00:28:19,200
the<font color="#CCCCCC"> late-night conversation with know</font>

658
00:28:17,010 --> 00:28:23,250
<font color="#E5E5E5">where we talked about data exfiltration</font>

659
00:28:19,200 --> 00:28:25,200
and control channels and so thanks no uh

660
00:28:23,250 --> 00:28:27,120
<font color="#E5E5E5">if anybody wants to see the</font><font color="#CCCCCC"> two one</font>

661
00:28:25,200 --> 00:28:30,179
action<font color="#CCCCCC"> i've</font><font color="#E5E5E5"> got a demo setup right now</font>

662
00:28:27,120 --> 00:28:40,709
<font color="#E5E5E5">so</font><font color="#CCCCCC"> there's interest let's do it all</font>

663
00:28:30,179 --> 00:28:45,899
<font color="#CCCCCC">right there is interest that visible</font>

664
00:28:40,710 --> 00:28:47,909
<font color="#CCCCCC">alright so the the program itself is</font>

665
00:28:45,899 --> 00:28:51,330
<font color="#CCCCCC">like</font><font color="#E5E5E5"> to call it a servant and</font><font color="#CCCCCC"> i took</font>

666
00:28:47,909 --> 00:28:54,299
that<font color="#E5E5E5"> term from the the PDP community</font>

667
00:28:51,330 --> 00:28:56,760
where<font color="#E5E5E5"> it's a sort of a concatenation of</font>

668
00:28:54,299 --> 00:28:59,129
server and client<font color="#E5E5E5"> so it is the same</font>

669
00:28:56,760 --> 00:29:01,559
binary that does both ends<font color="#CCCCCC"> i tend to</font>

670
00:28:59,130 --> 00:29:02,730
think in terms of<font color="#CCCCCC"> client server so what</font>

671
00:29:01,559 --> 00:29:04,710
<font color="#CCCCCC">you're looking at right here is going to</font>

672
00:29:02,730 --> 00:29:06,750
be the client and so if<font color="#CCCCCC"> you are</font>

673
00:29:04,710 --> 00:29:15,750
controlling<font color="#E5E5E5"> another machine this is what</font>

674
00:29:06,750 --> 00:29:17,250
you'll be doing<font color="#CCCCCC"> that's actually the</font>

675
00:29:15,750 --> 00:29:20,340
commands<font color="#E5E5E5"> are scriptable you can write a</font>

676
00:29:17,250 --> 00:29:22,529
script that that does things

677
00:29:20,340 --> 00:29:24,990
automatically so if you have a function

678
00:29:22,529 --> 00:29:26,730
that you want to do well<font color="#E5E5E5"> and you want to</font>

679
00:29:24,990 --> 00:29:28,710
do<font color="#CCCCCC"> a</font><font color="#E5E5E5"> regularly and</font><font color="#CCCCCC"> I can</font><font color="#E5E5E5"> detect it does</font>

680
00:29:26,730 --> 00:29:32,640
help with that<font color="#CCCCCC"> some of those commands</font>

681
00:29:28,710 --> 00:29:35,039
include<font color="#E5E5E5"> you can see get input so just</font>

682
00:29:32,640 --> 00:29:36,990
like with<font color="#E5E5E5"> HTTP</font><font color="#CCCCCC"> GET input commands will</font>

683
00:29:35,039 --> 00:29:39,299
allow you to upload and download files

684
00:29:36,990 --> 00:29:41,279
from the other machine<font color="#CCCCCC"> there is a</font>

685
00:29:39,299 --> 00:29:43,860
<font color="#E5E5E5">there's an</font><font color="#CCCCCC"> exact command which allows</font>

686
00:29:41,279 --> 00:29:45,929
you to do remote command execution<font color="#E5E5E5"> and</font>

687
00:29:43,860 --> 00:29:47,370
if you have<font color="#E5E5E5"> two-way communication</font><font color="#CCCCCC"> you</font>

688
00:29:45,929 --> 00:29:48,179
can see the output<font color="#CCCCCC"> modes will see that</font>

689
00:29:47,370 --> 00:29:50,699
shortly

690
00:29:48,179 --> 00:29:52,559
there is a chat client<font color="#CCCCCC"> so if you don't</font>

691
00:29:50,700 --> 00:29:53,940
want to do<font color="#CCCCCC"> command and control you just</font>

692
00:29:52,559 --> 00:29:56,789
<font color="#CCCCCC">want to talk to your</font><font color="#E5E5E5"> buddy and have no</font>

693
00:29:53,940 --> 00:29:58,860
<font color="#E5E5E5">nobody</font><font color="#CCCCCC"> had</font><font color="#E5E5E5"> any idea</font><font color="#CCCCCC"> that you're actually</font>

694
00:29:56,789 --> 00:30:00,629
chatting<font color="#E5E5E5"> we provide you with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> a</font>

695
00:29:58,860 --> 00:30:04,080
way<font color="#CCCCCC"> to do that</font><font color="#E5E5E5"> i will give you a warning</font>

696
00:30:00,630 --> 00:30:05,340
however in that<font color="#E5E5E5"> if you happen to live in</font>

697
00:30:04,080 --> 00:30:08,639
an oppressive regime and if you're a

698
00:30:05,340 --> 00:30:10,350
dissident<font color="#E5E5E5"> good for you keep it up but um</font>

699
00:30:08,640 --> 00:30:13,950
<font color="#CCCCCC">this technology</font><font color="#E5E5E5"> is pretty untested so</font>

700
00:30:10,350 --> 00:30:16,469
<font color="#CCCCCC">don't don't risk your life on it yet but</font>

701
00:30:13,950 --> 00:30:28,050
<font color="#E5E5E5">it's there if if if you want to be the</font>

702
00:30:16,470 --> 00:30:29,940
test case<font color="#CCCCCC"> so here are the</font>

703
00:30:28,050 --> 00:30:32,430
<font color="#CCCCCC">we're gonna run on the</font><font color="#E5E5E5"> client side just</font>

704
00:30:29,940 --> 00:30:34,440
to set<font color="#E5E5E5"> up communication and again we are</font>

705
00:30:32,430 --> 00:30:36,930
using<font color="#CCCCCC"> public</font><font color="#E5E5E5"> key cryptography so you can</font>

706
00:30:34,440 --> 00:30:39,720
see there is a public<font color="#E5E5E5"> and</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> private key</font>

707
00:30:36,930 --> 00:30:42,480
and a<font color="#E5E5E5"> client</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> clanky is simply the</font>

708
00:30:39,720 --> 00:30:45,360
other<font color="#CCCCCC"> side's</font><font color="#E5E5E5"> the other</font><font color="#CCCCCC"> side's public key</font>

709
00:30:42,480 --> 00:30:48,210
and the<font color="#CCCCCC"> kinect</font><font color="#E5E5E5"> command defines the IP</font>

710
00:30:45,360 --> 00:30:50,129
address for the other<font color="#E5E5E5"> know that you're</font>

711
00:30:48,210 --> 00:30:52,170
talking to the other<font color="#CCCCCC"> know doesn't</font>

712
00:30:50,130 --> 00:30:55,170
doesn't mean IP address only the only

713
00:30:52,170 --> 00:30:56,910
client<font color="#CCCCCC"> is</font><font color="#E5E5E5"> it unless you're doing chat in</font>

714
00:30:55,170 --> 00:31:07,590
which case<font color="#CCCCCC"> you're both the client and</font>

715
00:30:56,910 --> 00:31:09,210
<font color="#E5E5E5">here's the client and he and you can see</font>

716
00:31:07,590 --> 00:31:12,570
this commanded that looks a little bit

717
00:31:09,210 --> 00:31:13,710
crazy but it's this way for a reason<font color="#E5E5E5"> and</font>

718
00:31:12,570 --> 00:31:15,419
<font color="#E5E5E5">you don't have to do</font><font color="#CCCCCC"> it this way again</font>

719
00:31:13,710 --> 00:31:18,300
the commands are the commands are

720
00:31:15,420 --> 00:31:20,670
<font color="#E5E5E5">scriptable but</font><font color="#CCCCCC"> i like the speaker so</font>

721
00:31:18,300 --> 00:31:22,740
<font color="#CCCCCC">Minister i'm</font><font color="#E5E5E5"> gonna show right now</font><font color="#CCCCCC"> the</font>

722
00:31:20,670 --> 00:31:26,070
first<font color="#CCCCCC"> of $MONTH first third of this big</font>

723
00:31:22,740 --> 00:31:27,660
<font color="#CCCCCC">big blob here is the local public key</font>

724
00:31:26,070 --> 00:31:30,480
and then we have a local private key and

725
00:31:27,660 --> 00:31:32,790
then finally<font color="#E5E5E5"> it the the other end the</font>

726
00:31:30,480 --> 00:31:36,270
<font color="#E5E5E5">clients</font><font color="#CCCCCC"> public-key all defined</font><font color="#E5E5E5"> therein</font>

727
00:31:32,790 --> 00:31:39,860
<font color="#E5E5E5">one big blob and right there</font>

728
00:31:36,270 --> 00:31:44,510
it's running in the background

729
00:31:39,860 --> 00:31:46,699
<font color="#CCCCCC">all right</font><font color="#E5E5E5"> you can see in the process</font>

730
00:31:44,510 --> 00:31:47,840
list<font color="#E5E5E5"> you the the key that we just had in</font>

731
00:31:46,700 --> 00:31:51,799
the command line is<font color="#E5E5E5"> natural</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

732
00:31:47,840 --> 00:31:54,470
process list<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> do this in the world</font>

733
00:31:51,799 --> 00:31:55,490
<font color="#CCCCCC">Ida I'd strongly recommend</font><font color="#E5E5E5"> that you get</font>

734
00:31:54,470 --> 00:31:59,900
<font color="#CCCCCC">rid</font><font color="#E5E5E5"> of your command history at this</font>

735
00:31:55,490 --> 00:32:04,910
point<font color="#E5E5E5"> but</font><font color="#CCCCCC"> assuming</font><font color="#E5E5E5"> that you do that if</font>

736
00:31:59,900 --> 00:32:08,120
<font color="#E5E5E5">if your client or a adversarial regime</font>

737
00:32:04,910 --> 00:32:09,290
or someone to find your control channel

738
00:32:08,120 --> 00:32:12,830
they will have to pick that out<font color="#E5E5E5"> of</font>

739
00:32:09,290 --> 00:32:15,168
process memory<font color="#E5E5E5"> as soon as soon as they</font>

740
00:32:12,830 --> 00:32:18,290
<font color="#E5E5E5">said that machine offer terminate your</font>

741
00:32:15,169 --> 00:32:20,179
process that that<font color="#E5E5E5"> whole task of</font>

742
00:32:18,290 --> 00:32:23,809
recovering those<font color="#E5E5E5"> keys becomes a lot more</font>

743
00:32:20,179 --> 00:32:26,780
difficult<font color="#E5E5E5"> so nobody asked for that</font>

744
00:32:23,809 --> 00:32:29,120
feature but there it is

745
00:32:26,780 --> 00:32:31,910
<font color="#CCCCCC">alright so I'm</font><font color="#E5E5E5"> going to execute</font><font color="#CCCCCC"> command</font>

746
00:32:29,120 --> 00:32:38,840
just to show<font color="#CCCCCC"> us doing it</font>

747
00:32:31,910 --> 00:32:41,570
and we did a simple<font color="#E5E5E5"> LS</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> you can</font>

748
00:32:38,840 --> 00:32:45,020
see the<font color="#E5E5E5"> the contents of the directory</font>

749
00:32:41,570 --> 00:32:47,450
that we used for the build<font color="#E5E5E5"> we can do</font>

750
00:32:45,020 --> 00:32:49,220
pretty much any command you want<font color="#E5E5E5"> uh</font><font color="#CCCCCC"> I</font>

751
00:32:47,450 --> 00:32:52,430
did this on purpose<font color="#CCCCCC"> of the exact command</font>

752
00:32:49,220 --> 00:32:54,110
<font color="#CCCCCC">so you don't have to mess with regular</font>

753
00:32:52,430 --> 00:32:56,210
expressions<font color="#E5E5E5"> everything that comes after</font>

754
00:32:54,110 --> 00:32:58,429
that<font color="#CCCCCC"> expands just everything that comes</font>

755
00:32:56,210 --> 00:33:00,560
after that initial space is<font color="#CCCCCC"> taken</font>

756
00:32:58,430 --> 00:33:04,880
<font color="#CCCCCC">literally so space is the space of .</font><font color="#E5E5E5"> as</font>

757
00:33:00,560 --> 00:33:11,540
a .<font color="#CCCCCC"> a star</font><font color="#E5E5E5"> is a star</font><font color="#CCCCCC"> to me that's more</font>

758
00:33:04,880 --> 00:33:12,090
usable but other people<font color="#CCCCCC"> are oh</font><font color="#E5E5E5"> now on</font>

759
00:33:11,540 --> 00:33:14,879
the other

760
00:33:12,090 --> 00:33:16,709
<font color="#CCCCCC">want to show off a little bit about the</font>

761
00:33:14,880 --> 00:33:20,460
design and how we did it

762
00:33:16,710 --> 00:33:21,600
now there's also a<font color="#CCCCCC"> tcp mode but uh I</font>

763
00:33:20,460 --> 00:33:24,179
think<font color="#E5E5E5"> you're gonna get the point once I</font>

764
00:33:21,600 --> 00:33:27,209
show you the<font color="#CCCCCC"> ICMP</font><font color="#E5E5E5"> mode</font><font color="#CCCCCC"> some of the</font>

765
00:33:24,179 --> 00:33:30,330
packets in this wireshark capture<font color="#E5E5E5"> are</font>

766
00:33:27,210 --> 00:33:34,770
legitimate normal<font color="#CCCCCC"> icmp</font><font color="#E5E5E5"> echo</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> and</font>

767
00:33:30,330 --> 00:33:36,870
some of them are not so<font color="#CCCCCC"> I think it would</font>

768
00:33:34,770 --> 00:33:38,549
be<font color="#E5E5E5"> a little bit difficult to tell the</font>

769
00:33:36,870 --> 00:33:42,899
difference without some more meaningful

770
00:33:38,549 --> 00:33:46,168
examination<font color="#E5E5E5"> and</font>

771
00:33:42,899 --> 00:33:48,928
<font color="#CCCCCC">ok yeah so difficult that it's actually</font>

772
00:33:46,169 --> 00:33:50,909
I made the<font color="#E5E5E5"> demo</font><font color="#CCCCCC"> at forget</font><font color="#E5E5E5"> which ones</font>

773
00:33:48,929 --> 00:33:53,489
which but the ones at the end of the

774
00:33:50,909 --> 00:33:56,339
legitimate<font color="#CCCCCC"> ping</font><font color="#E5E5E5"> and you can see the the</font>

775
00:33:53,489 --> 00:34:01,259
<font color="#CCCCCC">datagram here at the end</font><font color="#E5E5E5"> with these</font><font color="#CCCCCC"> nice</font>

776
00:33:56,339 --> 00:34:03,269
<font color="#CCCCCC">azure 1234567</font><font color="#E5E5E5"> everything is everything</font>

777
00:34:01,259 --> 00:34:04,979
is real<font color="#E5E5E5"> time stamps there</font><font color="#CCCCCC"> everything is</font>

778
00:34:03,269 --> 00:34:06,450
there<font color="#E5E5E5"> and this is legitimate thing and</font>

779
00:34:04,979 --> 00:34:09,990
<font color="#E5E5E5">let's show you some of the</font><font color="#CCCCCC"> packets from</font>

780
00:34:06,450 --> 00:34:11,129
<font color="#CCCCCC">our legitimate thing</font><font color="#E5E5E5"> to do i'm gonna ask</font>

781
00:34:09,989 --> 00:34:12,569
<font color="#E5E5E5">in the end the</font><font color="#CCCCCC"> payload section did</font>

782
00:34:11,129 --> 00:34:16,469
anybody see any significant changes in

783
00:34:12,569 --> 00:34:19,500
the payload<font color="#CCCCCC"> no</font><font color="#E5E5E5"> because there are none of</font>

784
00:34:16,469 --> 00:34:21,899
the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> new pink lines</font><font color="#E5E5E5"> though the one</font>

785
00:34:19,500 --> 00:34:24,359
that is going to be installed on most

786
00:34:21,899 --> 00:34:26,520
<font color="#CCCCCC">linux distributions or</font><font color="#E5E5E5"> in most mac OS</font>

787
00:34:24,359 --> 00:34:27,808
<font color="#CCCCCC">well it's either installed on your</font>

788
00:34:26,520 --> 00:34:30,809
machine or something that you have is

789
00:34:27,809 --> 00:34:33,210
derived from it<font color="#E5E5E5"> we</font><font color="#CCCCCC"> copied that</font><font color="#E5E5E5"> we are</font>

790
00:34:30,809 --> 00:34:36,599
<font color="#CCCCCC">Code more or less matches that</font><font color="#E5E5E5"> and again</font>

791
00:34:33,210 --> 00:34:38,609
with<font color="#CCCCCC"> TCP mode</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> people reconstruct the</font>

792
00:34:36,599 --> 00:34:41,730
data Granderson with<font color="#CCCCCC"> PCP they're</font><font color="#E5E5E5"> going</font>

793
00:34:38,609 --> 00:34:43,859
<font color="#E5E5E5">to see a</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> going to see an</font><font color="#CCCCCC"> HD get</font>

794
00:34:41,730 --> 00:34:45,990
which is going to be<font color="#E5E5E5"> RFC compliant</font><font color="#CCCCCC"> in</font>

795
00:34:43,859 --> 00:34:47,940
<font color="#E5E5E5">fact if you hit a patch machine this way</font>

796
00:34:45,989 --> 00:34:49,888
that<font color="#CCCCCC"> Apache machine</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> gonna dump but</font>

797
00:34:47,940 --> 00:34:51,750
<font color="#E5E5E5">it's gonna dump / on you</font>

798
00:34:49,889 --> 00:34:53,849
<font color="#E5E5E5">index dot HTML or whatever is that</font>

799
00:34:51,750 --> 00:34:58,230
default documents /<font color="#CCCCCC"> it's going to</font><font color="#E5E5E5"> come</font>

800
00:34:53,849 --> 00:35:01,079
<font color="#CCCCCC">back and</font><font color="#E5E5E5"> hopefully</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> hopefully</font><font color="#CCCCCC"> the</font>

801
00:34:58,230 --> 00:35:04,980
listener does its job and respond

802
00:35:01,079 --> 00:35:08,069
accordingly<font color="#E5E5E5"> and that's what we have</font><font color="#CCCCCC"> so</font>

803
00:35:04,980 --> 00:35:09,569
in this talk<font color="#E5E5E5"> not only</font><font color="#CCCCCC"> do you have</font><font color="#E5E5E5"> a new</font>

804
00:35:08,069 --> 00:35:10,650
<font color="#CCCCCC">tool</font><font color="#E5E5E5"> so if your pen tester and you</font>

805
00:35:09,569 --> 00:35:13,140
<font color="#CCCCCC">wanted will</font><font color="#E5E5E5"> you want to avoid detection</font>

806
00:35:10,650 --> 00:35:15,359
or establish a<font color="#CCCCCC"> command-and-control</font>

807
00:35:13,140 --> 00:35:17,578
<font color="#E5E5E5">channel on a server that</font><font color="#CCCCCC"> is already open</font>

808
00:35:15,359 --> 00:35:19,558
<font color="#CCCCCC">authority listening</font>

809
00:35:17,579 --> 00:35:21,990
<font color="#E5E5E5">we-we-we give that to you but what I</font>

810
00:35:19,559 --> 00:35:23,130
think is possibly more valuable<font color="#CCCCCC"> than</font>

811
00:35:21,990 --> 00:35:24,959
what<font color="#CCCCCC"> I</font><font color="#E5E5E5"> tried to present here are the</font>

812
00:35:23,130 --> 00:35:27,630
principles behind it so if somebody

813
00:35:24,960 --> 00:35:28,829
wants to make something better<font color="#E5E5E5"> already</font>

814
00:35:27,630 --> 00:35:29,520
done at least some of the theoretical

815
00:35:28,829 --> 00:35:34,799
work for you

816
00:35:29,520 --> 00:35:36,000
so<font color="#CCCCCC"> um that</font><font color="#E5E5E5"> is roughly it in terms of my</font>

817
00:35:34,799 --> 00:35:46,130
presentation do we have questions or

818
00:35:36,000 --> 00:35:52,580
someone<font color="#CCCCCC"> yell at</font><font color="#E5E5E5"> me or mr.</font>

819
00:35:46,130 --> 00:35:56,090
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> um</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> answer</font><font color="#CCCCCC"> is yes and</font><font color="#E5E5E5"> no</font>

820
00:35:52,580 --> 00:35:57,410
so in practice<font color="#CCCCCC"> uh if you want to</font>

821
00:35:56,090 --> 00:36:00,620
completely from the process table

822
00:35:57,410 --> 00:36:02,779
<font color="#CCCCCC">there's not</font><font color="#E5E5E5"> really a</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> good way to</font>

823
00:36:00,620 --> 00:36:05,509
do that without jumping into<font color="#CCCCCC"> colonel</font><font color="#E5E5E5"> and</font>

824
00:36:02,780 --> 00:36:08,480
which<font color="#E5E5E5"> was our goal we</font><font color="#CCCCCC"> designed for</font><font color="#E5E5E5"> not</font>

825
00:36:05,510 --> 00:36:10,460
jumping<font color="#CCCCCC"> into curl and i say that because</font>

826
00:36:08,480 --> 00:36:11,570
<font color="#CCCCCC">i'm a lot of smart people in the</font>

827
00:36:10,460 --> 00:36:15,710
audience<font color="#E5E5E5"> somebody was gonna do that</font>

828
00:36:11,570 --> 00:36:18,560
purely<font color="#CCCCCC"> unusual and let me know now what</font>

829
00:36:15,710 --> 00:36:20,870
you can do what you can do purely<font color="#CCCCCC"> new</font>

830
00:36:18,560 --> 00:36:23,299
<font color="#CCCCCC">zealand however is change the change the</font>

831
00:36:20,870 --> 00:36:26,240
content of those fields<font color="#CCCCCC"> so are the</font>

832
00:36:23,300 --> 00:36:28,190
arguments 0<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> 2 3 4 however</font><font color="#CCCCCC"> argument and</font>

833
00:36:26,240 --> 00:36:31,939
<font color="#E5E5E5">the argument</font><font color="#CCCCCC"> you have those are at least</font>

834
00:36:28,190 --> 00:36:33,980
<font color="#E5E5E5">in</font><font color="#CCCCCC"> linux those are</font><font color="#E5E5E5"> those are filled that</font>

835
00:36:31,940 --> 00:36:36,830
programmatically you can change and what

836
00:36:33,980 --> 00:36:40,610
we did is we took<font color="#CCCCCC"> our</font><font color="#E5E5E5"> you won an</font>

837
00:36:36,830 --> 00:36:43,430
argument to the so the everything that

838
00:36:40,610 --> 00:36:44,990
came came after the<font color="#CCCCCC"> program itself and</font>

839
00:36:43,430 --> 00:36:50,299
we just<font color="#E5E5E5"> spaced them out we just replace</font>

840
00:36:44,990 --> 00:36:51,410
them with<font color="#CCCCCC"> faces on the have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> look at</font>

841
00:36:50,300 --> 00:36:53,990
the<font color="#E5E5E5"> coaches it's possible that i just</font>

842
00:36:51,410 --> 00:36:54,649
put the terminating<font color="#E5E5E5"> null at the four at</font>

843
00:36:53,990 --> 00:36:55,790
the first light

844
00:36:54,650 --> 00:36:56,690
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> sorry</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> remember which</font><font color="#CCCCCC"> i did</font>

845
00:36:55,790 --> 00:36:57,680
but either one of those<font color="#CCCCCC"> would have</font>

846
00:36:56,690 --> 00:36:59,930
<font color="#E5E5E5">worked</font>

847
00:36:57,680 --> 00:37:01,790
<font color="#E5E5E5">unfortunately if you want to extend</font>

848
00:36:59,930 --> 00:37:04,009
those strings that actually doesn't work

849
00:37:01,790 --> 00:37:06,259
out that well for you<font color="#E5E5E5"> there might be</font>

850
00:37:04,010 --> 00:37:08,000
some people are better<font color="#E5E5E5"> programs than me</font>

851
00:37:06,260 --> 00:37:10,460
in the audience and that's great but

852
00:37:08,000 --> 00:37:13,250
what you could do<font color="#CCCCCC"> on we'll go back to</font>

853
00:37:10,460 --> 00:37:14,870
that process<font color="#E5E5E5"> list you can see . / needle</font>

854
00:37:13,250 --> 00:37:16,340
is your first argument there<font color="#CCCCCC"> you can</font>

855
00:37:14,870 --> 00:37:20,900
replace that with anything you want

856
00:37:16,340 --> 00:37:26,060
<font color="#E5E5E5">easily as long as the as long as you use</font>

857
00:37:20,900 --> 00:37:27,440
the that many or fewer characters<font color="#E5E5E5"> so</font>

858
00:37:26,060 --> 00:37:30,920
yeah<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> there are other options you</font>

859
00:37:27,440 --> 00:37:34,280
can make to hide it better<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I</font>

860
00:37:30,920 --> 00:37:35,660
honestly don't<font color="#CCCCCC"> think you can easily</font><font color="#E5E5E5"> just</font>

861
00:37:34,280 --> 00:37:38,450
remove it completely from the process

862
00:37:35,660 --> 00:37:41,750
table without without having some fun in

863
00:37:38,450 --> 00:37:43,040
the<font color="#E5E5E5"> colonel</font><font color="#CCCCCC"> if you want</font><font color="#E5E5E5"> to tell me how</font><font color="#CCCCCC"> I</font>

864
00:37:41,750 --> 00:37:45,350
can do it without without messing with

865
00:37:43,040 --> 00:37:54,170
the<font color="#E5E5E5"> colonel then do it otherwise we</font><font color="#CCCCCC"> re</font>

866
00:37:45,350 --> 00:37:55,130
<font color="#CCCCCC">okay I'm gonna</font><font color="#E5E5E5"> move to yes yes</font>

867
00:37:54,170 --> 00:37:57,290
you can do that from the command line

868
00:37:55,130 --> 00:37:58,910
also if you wanna<font color="#CCCCCC"> yeah if you want to</font>

869
00:37:57,290 --> 00:38:01,490
call your<font color="#CCCCCC"> your your armies you know</font>

870
00:37:58,910 --> 00:38:05,600
<font color="#CCCCCC">you're 20 if you want to call it PS or</font>

871
00:38:01,490 --> 00:38:07,520
<font color="#E5E5E5">shd or something in that that works</font><font color="#CCCCCC"> too</font>

872
00:38:05,600 --> 00:38:09,560
um there are<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are simple</font><font color="#E5E5E5"> ways to do</font>

873
00:38:07,520 --> 00:38:12,080
that but yeah<font color="#E5E5E5"> I like that is a feature</font>

874
00:38:09,560 --> 00:38:13,580
<font color="#E5E5E5">request</font><font color="#CCCCCC"> I like that idea gentleman</font><font color="#E5E5E5"> in</font>

875
00:38:12,080 --> 00:38:17,840
<font color="#E5E5E5">the</font><font color="#CCCCCC"> planet</font>

876
00:38:13,580 --> 00:38:24,590
oh wow

877
00:38:17,840 --> 00:38:25,790
uh<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> have real data on that</font><font color="#CCCCCC"> if you</font>

878
00:38:24,590 --> 00:38:28,190
want me to guess<font color="#CCCCCC"> I honestly don't</font><font color="#E5E5E5"> think</font>

879
00:38:25,790 --> 00:38:28,880
it's happening that much for a couple

880
00:38:28,190 --> 00:38:32,210
<font color="#E5E5E5">reasons</font>

881
00:38:28,880 --> 00:38:35,360
<font color="#E5E5E5">um</font><font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> hard work photographers who</font>

882
00:38:32,210 --> 00:38:38,270
look at this will note<font color="#E5E5E5"> and</font><font color="#CCCCCC"> i would</font><font color="#E5E5E5"> take</font>

883
00:38:35,360 --> 00:38:40,310
correctly<font color="#E5E5E5"> of that to some extent we are</font>

884
00:38:38,270 --> 00:38:43,190
relying<font color="#CCCCCC"> in obscurity here the whole</font><font color="#E5E5E5"> idea</font>

885
00:38:40,310 --> 00:38:47,270
<font color="#CCCCCC">of</font><font color="#E5E5E5"> technology however is about obscurity</font>

886
00:38:43,190 --> 00:38:51,710
um<font color="#E5E5E5"> it is this is just another method to</font>

887
00:38:47,270 --> 00:38:53,540
help you hide<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> um the</font><font color="#CCCCCC"> hard work</font>

888
00:38:51,710 --> 00:38:55,100
<font color="#CCCCCC">of targets don't like</font><font color="#E5E5E5"> it</font>

889
00:38:53,540 --> 00:38:58,250
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> for other reasons as well</font>

890
00:38:55,100 --> 00:38:59,839
but uh<font color="#E5E5E5"> ultimately</font><font color="#CCCCCC"> i think a lot of</font>

891
00:38:58,250 --> 00:39:02,930
people prefer control channels that are

892
00:38:59,840 --> 00:39:04,400
you<font color="#E5E5E5"> got a mathematical proof that this</font>

893
00:39:02,930 --> 00:39:05,390
is absolutely undetectable

894
00:39:04,400 --> 00:39:09,140
<font color="#CCCCCC">I don't think you can I don't think that</font>

895
00:39:05,390 --> 00:39:13,819
proof exists you know<font color="#CCCCCC"> arm so yeah I mean</font>

896
00:39:09,140 --> 00:39:15,410
<font color="#CCCCCC">but</font><font color="#E5E5E5"> uh again work</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't think</font>

897
00:39:13,820 --> 00:39:18,140
undetectable<font color="#CCCCCC"> exists i</font><font color="#E5E5E5"> think we just made</font>

898
00:39:15,410 --> 00:39:20,180
it really difficult but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean the</font><font color="#CCCCCC"> same</font>

899
00:39:18,140 --> 00:39:23,629
thing with<font color="#E5E5E5"> pgps that</font><font color="#CCCCCC"> unbreakable</font><font color="#E5E5E5"> it's</font>

900
00:39:20,180 --> 00:39:26,120
just it's pretty<font color="#E5E5E5"> good</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> had</font>

901
00:39:23,630 --> 00:39:28,370
<font color="#E5E5E5">achieved</font><font color="#CCCCCC"> pgp level of brake light be so</font>

902
00:39:26,120 --> 00:39:30,470
proud of myself

903
00:39:28,370 --> 00:39:32,299
<font color="#E5E5E5">yeah but in terms of how often</font><font color="#CCCCCC"> it's</font>

904
00:39:30,470 --> 00:39:34,520
happening<font color="#CCCCCC"> it's happening in the wild</font>

905
00:39:32,300 --> 00:39:36,170
<font color="#E5E5E5">um</font><font color="#CCCCCC"> i have not</font><font color="#E5E5E5"> heard a lot of malware</font>

906
00:39:34,520 --> 00:39:39,560
researchers<font color="#E5E5E5"> tell me that they're seeing</font>

907
00:39:36,170 --> 00:39:40,850
this<font color="#E5E5E5"> but if</font><font color="#CCCCCC"> somebody in</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> guy in the</font>

908
00:39:39,560 --> 00:39:42,080
audience right now if somebody seeing

909
00:39:40,850 --> 00:39:43,700
this in the wild

910
00:39:42,080 --> 00:39:46,130
feel free to volunteer<font color="#CCCCCC"> there right now</font>

911
00:39:43,700 --> 00:39:48,859
<font color="#CCCCCC">shown me otherwise</font>

912
00:39:46,130 --> 00:39:50,300
my guess is not that much<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> after</font>

913
00:39:48,860 --> 00:39:59,180
this talk maybe this will be normal in

914
00:39:50,300 --> 00:40:08,540
<font color="#E5E5E5">here</font>

915
00:39:59,180 --> 00:40:09,049
oh I like that idea<font color="#CCCCCC"> okay I like that</font>

916
00:40:08,540 --> 00:40:10,190
<font color="#E5E5E5">idea</font>

917
00:40:09,050 --> 00:40:12,980
yeah<font color="#E5E5E5"> like right now if you do the</font>

918
00:40:10,190 --> 00:40:15,109
process<font color="#CCCCCC"> to still click worked from</font><font color="#E5E5E5"> here</font>

919
00:40:12,980 --> 00:40:17,930
from the<font color="#E5E5E5"> curler</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> that's a good feature</font>

920
00:40:15,109 --> 00:40:21,770
<font color="#CCCCCC">request thank you</font>

921
00:40:17,930 --> 00:40:23,779
<font color="#CCCCCC">Oh MIT report yourself</font><font color="#E5E5E5"> from another from</font>

922
00:40:21,770 --> 00:40:27,440
another<font color="#CCCCCC"> processor</font><font color="#E5E5E5"> but also</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> if you</font>

923
00:40:23,780 --> 00:40:29,210
<font color="#E5E5E5">think about it if you figure out a way</font>

924
00:40:27,440 --> 00:40:32,510
to upload this to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> in a real-world</font>

925
00:40:29,210 --> 00:40:36,200
scenario<font color="#CCCCCC"> uh if you do this in a</font>

926
00:40:32,510 --> 00:40:38,359
<font color="#E5E5E5">real-world scenario and somehow you got</font>

927
00:40:36,200 --> 00:40:39,710
this you<font color="#E5E5E5"> got the process to run from say</font>

928
00:40:38,359 --> 00:40:43,069
<font color="#CCCCCC">apache or</font><font color="#E5E5E5"> something if you put</font><font color="#CCCCCC"> in like a</font>

929
00:40:39,710 --> 00:40:45,829
<font color="#CCCCCC">CD is pinned</font><font color="#E5E5E5"> directory of it probably</font>

930
00:40:43,069 --> 00:40:47,960
would look that way<font color="#CCCCCC"> unless you</font><font color="#E5E5E5"> did the</font>

931
00:40:45,829 --> 00:40:51,050
dash<font color="#E5E5E5"> K in which case it does it does</font>

932
00:40:47,960 --> 00:40:54,890
this<font color="#E5E5E5"> what i would call</font><font color="#CCCCCC"> demanding</font><font color="#E5E5E5"> a by</font>

933
00:40:51,050 --> 00:40:57,230
itself<font color="#E5E5E5"> for Damon sorry but yeah</font><font color="#CCCCCC"> I like</font>

934
00:40:54,890 --> 00:41:03,200
that<font color="#E5E5E5"> idea</font>

935
00:40:57,230 --> 00:41:05,660
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> anybody else</font>

936
00:41:03,200 --> 00:41:07,609
<font color="#CCCCCC">alright uh</font><font color="#E5E5E5"> thank you for coming to my</font>

937
00:41:05,660 --> 00:41:12,170
talk thank you for letting me speak on

938
00:41:07,609 --> 00:41:16,819
this topic<font color="#CCCCCC"> i am a i'm</font><font color="#E5E5E5"> jonathan turtle</font>

939
00:41:12,170 --> 00:41:25,330
Jonathan<font color="#CCCCCC"> Trott twitter so feel free to</font>

940
00:41:16,820 --> 00:41:25,330
talk to me or otherwise a<font color="#E5E5E5"> again thanks</font>

