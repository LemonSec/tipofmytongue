1
00:00:00,000 --> 00:00:12,420
<font color="#CCCCCC">right</font>

2
00:00:09,780 --> 00:00:14,370
good morning everyone<font color="#CCCCCC"> so hopefully in</font>

3
00:00:12,420 --> 00:00:17,400
the right place this is a talk on the

4
00:00:14,370 --> 00:00:20,698
<font color="#CCCCCC">virus total intelligence and</font><font color="#E5E5E5"> I with a</font>

5
00:00:17,400 --> 00:00:24,390
use case of tracking<font color="#E5E5E5"> malicious actors</font>

6
00:00:20,699 --> 00:00:28,680
from al.com<font color="#CCCCCC"> male</font><font color="#E5E5E5"> doc campaigns</font>

7
00:00:24,390 --> 00:00:30,570
my name is<font color="#E5E5E5"> wyatt drama and for those of</font>

8
00:00:28,680 --> 00:00:32,519
<font color="#CCCCCC">that of you that don't know me</font><font color="#E5E5E5"> my</font>

9
00:00:30,570 --> 00:00:35,309
research for fun and also do it for a

10
00:00:32,520 --> 00:00:37,739
job<font color="#CCCCCC"> happen to be</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> to do</font>

11
00:00:35,309 --> 00:00:39,629
both there and I'm<font color="#E5E5E5"> well known for my</font>

12
00:00:37,739 --> 00:00:41,160
work with volatility<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> not familiar</font>

13
00:00:39,629 --> 00:00:45,480
<font color="#E5E5E5">with volatility is just a memory</font>

14
00:00:41,160 --> 00:00:48,328
forensics framework<font color="#E5E5E5"> my most popular</font>

15
00:00:45,480 --> 00:00:51,089
research in volatility was the research

16
00:00:48,329 --> 00:00:53,010
and hyper-v memory forensics and have

17
00:00:51,090 --> 00:00:54,930
also been responsible for the last

18
00:00:53,010 --> 00:00:57,750
couple years of the<font color="#E5E5E5"> jerk on digital</font>

19
00:00:54,930 --> 00:01:01,890
forensics<font color="#E5E5E5"> challenge</font><font color="#CCCCCC"> box number of other</font>

20
00:00:57,750 --> 00:01:04,170
things<font color="#CCCCCC"> i also work at Target and I do</font>

21
00:01:01,890 --> 00:01:07,200
some other random things on the side<font color="#CCCCCC"> fun</font>

22
00:01:04,170 --> 00:01:10,320
so first question is why am I here why

23
00:01:07,200 --> 00:01:12,180
am<font color="#E5E5E5"> I talking why should you care so</font>

24
00:01:10,320 --> 00:01:14,039
basically there is a you know an

25
00:01:12,180 --> 00:01:15,570
internal need for us to developer<font color="#CCCCCC"> an</font>

26
00:01:14,040 --> 00:01:17,520
<font color="#E5E5E5">intelligence-gathering whether it be</font>

27
00:01:15,570 --> 00:01:21,720
within our company or your company as

28
00:01:17,520 --> 00:01:24,360
well and bigger small<font color="#CCCCCC"> are huge waves of</font>

29
00:01:21,720 --> 00:01:28,259
fishing campaign so<font color="#E5E5E5"> been very common</font>

30
00:01:24,360 --> 00:01:30,630
throughout the years and have been<font color="#E5E5E5"> and</font>

31
00:01:28,259 --> 00:01:32,549
at least a topic of highlight for us

32
00:01:30,630 --> 00:01:34,320
recently<font color="#CCCCCC"> i just kind of tracking those</font>

33
00:01:32,549 --> 00:01:36,869
in and<font color="#E5E5E5"> trying to learn how to deal with</font>

34
00:01:34,320 --> 00:01:39,508
that so we're gonna go from<font color="#CCCCCC"> how do we</font>

35
00:01:36,869 --> 00:01:40,799
detect them and how do we go and<font color="#E5E5E5"> pivot</font>

36
00:01:39,509 --> 00:01:43,229
on<font color="#E5E5E5"> that information to find other</font>

37
00:01:40,799 --> 00:01:45,240
related campaigns or maybe something you

38
00:01:43,229 --> 00:01:47,369
might be missing and deploying that into

39
00:01:45,240 --> 00:01:49,560
like detection and potentially blocking

40
00:01:47,369 --> 00:01:53,310
things or<font color="#CCCCCC"> learning on it depending on</font>

41
00:01:49,560 --> 00:01:54,149
<font color="#E5E5E5">what capabilities you have so and then</font>

42
00:01:53,310 --> 00:01:55,920
you<font color="#E5E5E5"> know I want to make</font><font color="#CCCCCC"> it until</font>

43
00:01:54,149 --> 00:01:59,430
valuable<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't want to just make it</font>

44
00:01:55,920 --> 00:02:01,920
valuable in a sense of like I<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you</font>

45
00:01:59,430 --> 00:02:03,570
know like<font color="#E5E5E5"> resale but like for a small</font>

46
00:02:01,920 --> 00:02:07,320
company that doesn't have the money to

47
00:02:03,570 --> 00:02:08,788
go and buy very expensive<font color="#E5E5E5"> Intel from the</font>

48
00:02:07,320 --> 00:02:10,228
various<font color="#CCCCCC"> Intel vendors because if you</font>

49
00:02:08,788 --> 00:02:11,760
want good until it's<font color="#CCCCCC"> going to cost</font><font color="#E5E5E5"> you a</font>

50
00:02:10,229 --> 00:02:12,569
lot of money<font color="#CCCCCC"> in most places</font><font color="#E5E5E5"> really don't</font>

51
00:02:11,760 --> 00:02:16,709
have a kind<font color="#E5E5E5"> of</font>

52
00:02:12,569 --> 00:02:18,719
so anyways<font color="#E5E5E5"> like</font><font color="#CCCCCC"> I said first time I talk</font>

53
00:02:16,709 --> 00:02:21,090
about<font color="#CCCCCC"> virustotal</font><font color="#E5E5E5"> offer those that you</font>

54
00:02:18,719 --> 00:02:23,010
<font color="#E5E5E5">know but first of all can get account</font>

55
00:02:21,090 --> 00:02:27,389
raise your hand if<font color="#E5E5E5"> you know a virus</font>

56
00:02:23,010 --> 00:02:28,798
total is<font color="#CCCCCC"> think</font><font color="#E5E5E5"> that on anyways</font><font color="#CCCCCC"> try</font><font color="#E5E5E5"> to</font>

57
00:02:27,389 --> 00:02:30,719
lighten up a little bit<font color="#CCCCCC"> i was hoping</font>

58
00:02:28,799 --> 00:02:32,459
that was the case<font color="#CCCCCC"> now how many of you</font>

59
00:02:30,719 --> 00:02:35,638
know what<font color="#CCCCCC"> virustotal intelligences</font>

60
00:02:32,459 --> 00:02:38,669
<font color="#E5E5E5">awesome</font>

61
00:02:35,639 --> 00:02:42,540
<font color="#CCCCCC">yarra</font><font color="#E5E5E5"> more alright so we're very</font>

62
00:02:38,669 --> 00:02:44,639
familiar this stuff<font color="#CCCCCC"> I</font><font color="#E5E5E5"> and to basically</font>

63
00:02:42,540 --> 00:02:46,349
<font color="#CCCCCC">cover</font><font color="#E5E5E5"> a lot of that stuff</font><font color="#CCCCCC"> i'm finding</font>

64
00:02:44,639 --> 00:02:48,150
value<font color="#E5E5E5"> and hunting rules and how you can</font>

65
00:02:46,349 --> 00:02:51,418
take that data and make it more valuable

66
00:02:48,150 --> 00:02:56,969
to you with a<font color="#CCCCCC"> plastic surgeon</font><font color="#E5E5E5"> kind of</font>

67
00:02:51,419 --> 00:02:58,739
feeding<font color="#CCCCCC"> virustotal uh</font><font color="#E5E5E5"> notification from</font>

68
00:02:56,969 --> 00:03:02,459
the<font color="#CCCCCC"> garden</font><font color="#E5E5E5"> virustotal notification API</font>

69
00:02:58,739 --> 00:03:04,709
<font color="#E5E5E5">into elasticsearch</font><font color="#CCCCCC"> to be able to store</font>

70
00:03:02,459 --> 00:03:06,389
the information and have it go somewhere

71
00:03:04,709 --> 00:03:08,219
else other than just<font color="#CCCCCC"> into your email</font>

72
00:03:06,389 --> 00:03:10,409
<font color="#CCCCCC">inbox which isn't really the best for</font>

73
00:03:08,219 --> 00:03:12,329
<font color="#E5E5E5">analyzing big data when you're looking</font>

74
00:03:10,409 --> 00:03:14,159
at maybe a few hundred thousand

75
00:03:12,329 --> 00:03:16,319
notifications how do you put that data

76
00:03:14,159 --> 00:03:18,060
and start to build automation on top of

77
00:03:16,319 --> 00:03:20,280
that and things of that nature

78
00:03:18,060 --> 00:03:22,439
I mean we're<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> go through</font><font color="#CCCCCC"> maybe</font>

79
00:03:20,280 --> 00:03:24,569
<font color="#CCCCCC">when you find alibi</font><font color="#E5E5E5"> new tactic whether</font>

80
00:03:22,439 --> 00:03:27,000
it be through a new fishing<font color="#CCCCCC"> waiver you</font>

81
00:03:24,569 --> 00:03:28,918
see a new blog post or you see something

82
00:03:27,000 --> 00:03:31,470
on you know<font color="#E5E5E5"> some Intel for more on</font>

83
00:03:28,919 --> 00:03:33,120
<font color="#CCCCCC">Twitter I maybe</font><font color="#E5E5E5"> they're using a new</font>

84
00:03:31,470 --> 00:03:34,319
tactic that you haven't seen before so

85
00:03:33,120 --> 00:03:37,259
you can go into virustotal into a

86
00:03:34,319 --> 00:03:39,060
restaurant and go<font color="#CCCCCC"> obtained</font><font color="#E5E5E5"> you know</font>

87
00:03:37,259 --> 00:03:41,518
maybe some stuff you might have missed

88
00:03:39,060 --> 00:03:43,409
<font color="#E5E5E5">prior to deploying those hunting</font><font color="#CCCCCC"> yo</font>

89
00:03:41,519 --> 00:03:45,120
rules<font color="#E5E5E5"> for those of you that don't know</font>

90
00:03:43,409 --> 00:03:46,530
<font color="#CCCCCC">our</font><font color="#E5E5E5"> school</font><font color="#CCCCCC"> is obviously a place where</font>

91
00:03:45,120 --> 00:03:49,620
you can upload<font color="#E5E5E5"> our and get</font><font color="#CCCCCC"> it scanned</font>

92
00:03:46,530 --> 00:03:52,199
<font color="#CCCCCC">all I</font><font color="#E5E5E5"> don't recommend it</font><font color="#CCCCCC"> of personally</font>

93
00:03:49,620 --> 00:03:53,220
<font color="#CCCCCC">there's an example i'm gonna blow</font>

94
00:03:52,199 --> 00:03:54,479
through some of this because i didn't

95
00:03:53,220 --> 00:03:55,949
really exactly know what the audience

96
00:03:54,479 --> 00:03:58,379
would be like so<font color="#CCCCCC"> I have some</font><font color="#E5E5E5"> very basic</font>

97
00:03:55,949 --> 00:03:59,790
stuff and<font color="#CCCCCC"> i'll try</font><font color="#E5E5E5"> to go through that as</font>

98
00:03:58,379 --> 00:04:01,439
quickly as possible and still<font color="#CCCCCC"> try to</font>

99
00:03:59,790 --> 00:04:03,179
<font color="#E5E5E5">touch on a little bit for those that</font>

100
00:04:01,439 --> 00:04:05,129
might not know<font color="#E5E5E5"> for those of you that</font>

101
00:04:03,180 --> 00:04:07,500
don't know<font color="#E5E5E5"> of</font><font color="#CCCCCC"> hours</font><font color="#E5E5E5"> total intelligence</font>

102
00:04:05,129 --> 00:04:10,228
is a paid<font color="#E5E5E5"> intelligence</font><font color="#CCCCCC"> feed you</font><font color="#E5E5E5"> can get</font>

103
00:04:07,500 --> 00:04:15,479
from them<font color="#CCCCCC"> quite</font><font color="#E5E5E5"> expensive but allows you</font>

104
00:04:10,229 --> 00:04:17,579
to like<font color="#E5E5E5"> download</font><font color="#CCCCCC"> I you know samples</font><font color="#E5E5E5"> any</font>

105
00:04:15,479 --> 00:04:19,919
samples of<font color="#CCCCCC"> uploaded a virus total</font><font color="#E5E5E5"> and</font>

106
00:04:17,579 --> 00:04:22,990
also<font color="#CCCCCC"> allows</font><font color="#E5E5E5"> you deploy hunting rules</font>

107
00:04:19,918 --> 00:04:25,150
which we'll get to in just a moment

108
00:04:22,990 --> 00:04:29,020
<font color="#E5E5E5">on this is just an example of interface</font>

109
00:04:25,150 --> 00:04:30,669
you can you search for<font color="#CCCCCC"> a hash and it</font>

110
00:04:29,020 --> 00:04:32,349
will show you the file and actually has

111
00:04:30,669 --> 00:04:34,150
a little bit more<font color="#CCCCCC"> in-depth analysis then</font>

112
00:04:32,349 --> 00:04:36,550
what the public virustotal<font color="#E5E5E5"> will show you</font>

113
00:04:34,150 --> 00:04:37,960
<font color="#CCCCCC">i'm allowing</font><font color="#E5E5E5"> like said to download it or</font>

114
00:04:36,550 --> 00:04:40,599
even look at the strings of the file

115
00:04:37,960 --> 00:04:44,380
some of the features that are in the

116
00:04:40,599 --> 00:04:46,630
public version<font color="#CCCCCC"> just a</font><font color="#E5E5E5"> few examples like</font>

117
00:04:44,380 --> 00:04:48,610
what you can see a little bit more

118
00:04:46,630 --> 00:04:50,740
information<font color="#E5E5E5"> like like said the strings</font>

119
00:04:48,610 --> 00:04:52,930
that you can see inside of it<font color="#CCCCCC"> i just</font>

120
00:04:50,740 --> 00:04:54,370
<font color="#E5E5E5">some really simple stuff that</font><font color="#CCCCCC"> versatile</font>

121
00:04:52,930 --> 00:04:58,750
intelligence allows you to see that

122
00:04:54,370 --> 00:05:00,550
likes<font color="#CCCCCC"> and the basic barstool doesn't so</font>

123
00:04:58,750 --> 00:05:03,699
what<font color="#E5E5E5"> is your for that those you don't</font>

124
00:05:00,550 --> 00:05:06,669
know is just really a tool aimed at

125
00:05:03,699 --> 00:05:09,280
helping our researchers or even<font color="#CCCCCC"> is small</font>

126
00:05:06,669 --> 00:05:11,948
<font color="#E5E5E5">people small company in my mind</font><font color="#CCCCCC"> develop</font>

127
00:05:09,280 --> 00:05:15,130
their own kind of<font color="#CCCCCC"> av signature it</font>

128
00:05:11,949 --> 00:05:16,599
essentially<font color="#E5E5E5"> right so you can you what</font>

129
00:05:15,130 --> 00:05:18,699
can you do with it you can track now<font color="#E5E5E5"> our</font>

130
00:05:16,599 --> 00:05:22,539
<font color="#E5E5E5">families you know different</font><font color="#CCCCCC"> packers</font>

131
00:05:18,699 --> 00:05:24,310
<font color="#E5E5E5">different imports are you can you base</font>

132
00:05:22,539 --> 00:05:26,349
your rules on specific strings maybe

133
00:05:24,310 --> 00:05:30,009
<font color="#CCCCCC">they are hard-coded into binaries or</font>

134
00:05:26,349 --> 00:05:33,400
static indicators<font color="#E5E5E5"> potentially opcodes</font><font color="#CCCCCC"> I</font>

135
00:05:30,009 --> 00:05:36,250
you know different<font color="#E5E5E5"> permit different</font>

136
00:05:33,400 --> 00:05:37,239
types of functions and<font color="#E5E5E5"> and so on so</font>

137
00:05:36,250 --> 00:05:39,520
forth

138
00:05:37,240 --> 00:05:41,500
this is<font color="#E5E5E5"> a basic power rule basically you</font>

139
00:05:39,520 --> 00:05:44,500
can see is the<font color="#E5E5E5"> metal like it just</font><font color="#CCCCCC"> the</font>

140
00:05:41,500 --> 00:05:46,389
description<font color="#CCCCCC"> i know you can buy</font><font color="#E5E5E5"> some</font>

141
00:05:44,500 --> 00:05:50,020
other stuff like maybe you have a hash

142
00:05:46,389 --> 00:05:51,729
reference or you know the author<font color="#E5E5E5"> you can</font>

143
00:05:50,020 --> 00:05:53,080
put in the meta and then the strings<font color="#E5E5E5"> are</font>

144
00:05:51,729 --> 00:05:56,560
actual conditions that you can write

145
00:05:53,080 --> 00:05:59,469
with some<font color="#CCCCCC"> lean logic can specify like in</font>

146
00:05:56,560 --> 00:06:01,630
this case a or b or c so if either<font color="#E5E5E5"> any</font>

147
00:05:59,469 --> 00:06:02,349
of those are seeing<font color="#CCCCCC"> the file it will be</font>

148
00:06:01,630 --> 00:06:05,110
detected

149
00:06:02,349 --> 00:06:08,710
not all of them just any of them at

150
00:06:05,110 --> 00:06:10,990
least based on<font color="#CCCCCC"> logic</font><font color="#E5E5E5"> anyways so why is</font>

151
00:06:08,710 --> 00:06:13,359
that important to<font color="#CCCCCC"> virulence is because</font>

152
00:06:10,990 --> 00:06:17,050
they have a feature that allows you to

153
00:06:13,360 --> 00:06:19,090
<font color="#CCCCCC">deploy hunting rules on which is a your</font>

154
00:06:17,050 --> 00:06:21,610
rule that deploys<font color="#CCCCCC"> everytime filed its</font>

155
00:06:19,090 --> 00:06:23,948
<font color="#CCCCCC">uploading the virus total it will scan</font>

156
00:06:21,610 --> 00:06:26,560
it with<font color="#CCCCCC"> these hunting rules and send you</font>

157
00:06:23,949 --> 00:06:29,680
a notification<font color="#E5E5E5"> if it matches your yard</font>

158
00:06:26,560 --> 00:06:32,800
rules which can be incredibly powerful<font color="#CCCCCC"> I</font>

159
00:06:29,680 --> 00:06:35,380
just based on<font color="#E5E5E5"> very simple indicators or</font>

160
00:06:32,800 --> 00:06:36,370
<font color="#CCCCCC">me</font><font color="#E5E5E5"> you know one of the things</font><font color="#CCCCCC"> i'll get</font>

161
00:06:35,380 --> 00:06:38,680
to is how you can

162
00:06:36,370 --> 00:06:41,020
take maybe two different signatures and

163
00:06:38,680 --> 00:06:43,840
put the data together in<font color="#E5E5E5"> cabana and be</font>

164
00:06:41,020 --> 00:06:46,240
able to<font color="#CCCCCC"> you like visually see like maybe</font>

165
00:06:43,840 --> 00:06:49,448
you have a more strict signature and<font color="#CCCCCC"> you</font>

166
00:06:46,240 --> 00:06:50,710
<font color="#CCCCCC">compared to a very</font><font color="#E5E5E5"> strict signature</font><font color="#CCCCCC"> and</font>

167
00:06:49,449 --> 00:06:53,020
you can see maybe what you might be

168
00:06:50,710 --> 00:06:54,489
missing<font color="#CCCCCC"> based</font><font color="#E5E5E5"> on those are different</font>

169
00:06:53,020 --> 00:06:55,690
types of artifacts

170
00:06:54,490 --> 00:06:58,120
I'll get<font color="#CCCCCC"> into that like I said just a</font>

171
00:06:55,690 --> 00:06:59,949
second well<font color="#CCCCCC"> I'm so basically can give</font>

172
00:06:58,120 --> 00:07:01,510
you kind of an overview<font color="#CCCCCC"> you know we</font>

173
00:06:59,949 --> 00:07:03,669
talked about the<font color="#CCCCCC"> yard rules there's two</font>

174
00:07:01,510 --> 00:07:06,880
different ways you can get essentially

175
00:07:03,669 --> 00:07:08,680
hashes from virustotal<font color="#CCCCCC"> I</font><font color="#E5E5E5"> based on these</font>

176
00:07:06,880 --> 00:07:11,020
are rules<font color="#CCCCCC"> one way i just talked about</font>

177
00:07:08,680 --> 00:07:13,240
<font color="#E5E5E5">the notification feet which every file</font>

178
00:07:11,020 --> 00:07:14,710
on upload will get scammed<font color="#CCCCCC"> but there's</font>

179
00:07:13,240 --> 00:07:16,419
also another feature called restaurant

180
00:07:14,710 --> 00:07:21,370
that allows you to scan back

181
00:07:16,419 --> 00:07:23,169
<font color="#E5E5E5">approximately 30 days</font><font color="#CCCCCC"> not really quite I</font>

182
00:07:21,370 --> 00:07:25,270
<font color="#CCCCCC">don't a hard date but it's normally</font>

183
00:07:23,169 --> 00:07:29,650
around like<font color="#CCCCCC"> think 75 terrible</font><font color="#E5E5E5"> slightly</font>

184
00:07:25,270 --> 00:07:32,320
<font color="#E5E5E5">seem accurate they obviously just don't</font>

185
00:07:29,650 --> 00:07:34,330
have the<font color="#E5E5E5"> capacity to allow you to scan</font>

186
00:07:32,320 --> 00:07:36,010
back years because<font color="#CCCCCC"> that would be</font><font color="#E5E5E5"> really</font>

187
00:07:34,330 --> 00:07:37,750
neat you know insane amount of data for

188
00:07:36,010 --> 00:07:41,469
hundreds of companies to be clearing

189
00:07:37,750 --> 00:07:43,150
that you know per second<font color="#CCCCCC"> you is insane</font>

190
00:07:41,470 --> 00:07:44,800
and<font color="#E5E5E5"> I'm sure it's very taxing luckily</font>

191
00:07:43,150 --> 00:07:46,210
for us it's pretty quick actually

192
00:07:44,800 --> 00:07:47,560
<font color="#E5E5E5">so there's two ways you can get the</font>

193
00:07:46,210 --> 00:07:49,989
notification that you know the<font color="#CCCCCC"> md5 is</font>

194
00:07:47,560 --> 00:07:52,840
essentially<font color="#E5E5E5"> defeat into your</font><font color="#CCCCCC"> elstak with</font>

195
00:07:49,990 --> 00:07:54,250
the data and<font color="#E5E5E5"> you can like</font><font color="#CCCCCC"> say</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the</font>

196
00:07:52,840 --> 00:07:56,530
restaurant you go back<font color="#E5E5E5"> to you you know</font>

197
00:07:54,250 --> 00:07:59,349
you see a new blog<font color="#E5E5E5"> post</font><font color="#CCCCCC"> using</font><font color="#E5E5E5"> a new</font><font color="#CCCCCC"> BB a</font>

198
00:07:56,530 --> 00:08:01,419
function and you maybe have not been

199
00:07:59,349 --> 00:08:03,460
tracking that so you can go in there and

200
00:08:01,419 --> 00:08:05,380
<font color="#CCCCCC">launch a</font><font color="#E5E5E5"> retro hunt to find the ones</font><font color="#CCCCCC"> you</font>

201
00:08:03,460 --> 00:08:07,630
<font color="#CCCCCC">missed last</font><font color="#E5E5E5"> 30 days and take those</font>

202
00:08:05,380 --> 00:08:10,750
hashes and use the<font color="#CCCCCC"> virus total API and</font>

203
00:08:07,630 --> 00:08:13,510
<font color="#E5E5E5">pull down all the full file reports for</font>

204
00:08:10,750 --> 00:08:15,160
those uh<font color="#E5E5E5"> hashes and feed them into</font>

205
00:08:13,510 --> 00:08:16,479
<font color="#E5E5E5">virustotal for additional</font><font color="#CCCCCC"> context</font><font color="#E5E5E5"> on</font>

206
00:08:15,160 --> 00:08:18,550
data that you missed<font color="#E5E5E5"> and obviously</font>

207
00:08:16,479 --> 00:08:25,030
deploy the<font color="#E5E5E5"> yard hunting rule to allow</font>

208
00:08:18,550 --> 00:08:29,500
you to<font color="#CCCCCC"> become</font><font color="#E5E5E5"> matched those things</font>

209
00:08:25,030 --> 00:08:31,059
<font color="#CCCCCC">thought</font><font color="#E5E5E5"> anyways so</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> I said some of</font>

210
00:08:29,500 --> 00:08:34,208
you are<font color="#CCCCCC"> a hundred rules</font><font color="#E5E5E5"> so yeah</font><font color="#CCCCCC"> it's</font>

211
00:08:31,060 --> 00:08:36,610
<font color="#E5E5E5">pretty close look</font><font color="#CCCCCC"> at the 76</font><font color="#E5E5E5"> terabytes</font>

212
00:08:34,208 --> 00:08:40,598
was the<font color="#E5E5E5"> one</font><font color="#CCCCCC"> I ran</font><font color="#E5E5E5"> so this was based on</font>

213
00:08:36,610 --> 00:08:42,969
one of the new<font color="#E5E5E5"> like underscore painted</font>

214
00:08:40,599 --> 00:08:43,870
<font color="#E5E5E5">vba macros they forget actually which</font>

215
00:08:42,969 --> 00:08:45,490
one it was

216
00:08:43,870 --> 00:08:47,550
but basically you can see right here

217
00:08:45,490 --> 00:08:51,209
that I matched like<font color="#CCCCCC"> 3000</font>

218
00:08:47,550 --> 00:08:54,660
977 documents<font color="#E5E5E5"> just based on this one</font>

219
00:08:51,209 --> 00:08:56,489
restaurant which<font color="#E5E5E5"> on to give you context</font>

220
00:08:54,660 --> 00:08:57,870
you if you don't like maybe do a lot of

221
00:08:56,490 --> 00:09:00,330
reverse engineering<font color="#E5E5E5"> you're not doing a</font>

222
00:08:57,870 --> 00:09:01,800
lot of like looking at you know what's

223
00:09:00,330 --> 00:09:03,630
going on<font color="#E5E5E5"> in these malicious documents</font>

224
00:09:01,800 --> 00:09:05,790
<font color="#CCCCCC">this can</font><font color="#E5E5E5"> be really interesting to tell</font>

225
00:09:03,630 --> 00:09:07,410
you like hey this execution method that

226
00:09:05,790 --> 00:09:10,170
you see is<font color="#E5E5E5"> it something that's being</font>

227
00:09:07,410 --> 00:09:12,120
seen in the wild<font color="#CCCCCC"> at what degree</font><font color="#E5E5E5"> right</font>

228
00:09:10,170 --> 00:09:14,579
like if<font color="#CCCCCC"> you</font><font color="#E5E5E5"> got like one or two hashes</font>

229
00:09:12,120 --> 00:09:17,519
back<font color="#CCCCCC"> I'd be like much more concerned</font>

230
00:09:14,579 --> 00:09:19,529
with a method right like maybe you know

231
00:09:17,519 --> 00:09:20,760
maybe that tells you that the campaign

232
00:09:19,529 --> 00:09:22,709
is just starting

233
00:09:20,760 --> 00:09:26,430
or that it's more of a targeted attack

234
00:09:22,709 --> 00:09:28,529
<font color="#CCCCCC">when you see 3900 you know it's like</font>

235
00:09:26,430 --> 00:09:30,870
<font color="#CCCCCC">okay this is obviously a bigger wave i</font>

236
00:09:28,529 --> 00:09:32,160
<font color="#E5E5E5">can</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> you a context of how you</font>

237
00:09:30,870 --> 00:09:34,260
I you know<font color="#E5E5E5"> treat that from an</font>

238
00:09:32,160 --> 00:09:35,579
<font color="#CCCCCC">intelligent standpoint is you know on</font>

239
00:09:34,260 --> 00:09:37,170
how you should<font color="#CCCCCC"> move forward is</font><font color="#E5E5E5"> this just</font>

240
00:09:35,579 --> 00:09:39,209
a<font color="#E5E5E5"> massive</font><font color="#CCCCCC"> attack or is it something that</font>

241
00:09:37,170 --> 00:09:41,370
someone specifically targeting us<font color="#CCCCCC"> and</font>

242
00:09:39,209 --> 00:09:44,699
using something of that level<font color="#E5E5E5"> just</font><font color="#CCCCCC"> a</font>

243
00:09:41,370 --> 00:09:46,560
<font color="#E5E5E5">straight</font><font color="#CCCCCC"> anyways so</font><font color="#E5E5E5"> give you some</font>

244
00:09:44,700 --> 00:09:50,100
examples of like how you<font color="#E5E5E5"> could compare</font>

245
00:09:46,560 --> 00:09:52,979
these things<font color="#E5E5E5"> so those</font><font color="#CCCCCC"> vb</font><font color="#E5E5E5"> macro cause</font><font color="#CCCCCC"> i</font>

246
00:09:50,100 --> 00:09:55,020
<font color="#E5E5E5">was talking about from documents like I</font>

247
00:09:52,980 --> 00:09:57,630
<font color="#E5E5E5">if</font><font color="#CCCCCC"> anyone's</font><font color="#E5E5E5"> familiar</font><font color="#CCCCCC"> how many of the</font>

248
00:09:55,020 --> 00:10:02,490
<font color="#CCCCCC">scene</font><font color="#E5E5E5"> like the ink</font><font color="#CCCCCC"> picture1</font><font color="#E5E5E5"> underscore</font>

249
00:09:57,630 --> 00:10:05,790
painted<font color="#CCCCCC"> vba I'm</font><font color="#E5E5E5"> a call</font><font color="#CCCCCC"> word docs lately</font>

250
00:10:02,490 --> 00:10:09,750
<font color="#E5E5E5">and can give it just a anything</font><font color="#CCCCCC"> no one</font>

251
00:10:05,790 --> 00:10:11,819
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> anyways so basically there's</font>

252
00:10:09,750 --> 00:10:14,610
some<font color="#CCCCCC"> of the execution methods they were</font>

253
00:10:11,820 --> 00:10:17,190
using so you would take like this rule

254
00:10:14,610 --> 00:10:19,980
where you see the ink<font color="#E5E5E5"> one there in</font>

255
00:10:17,190 --> 00:10:22,079
<font color="#CCCCCC">picture 1 underscore painted and the</font>

256
00:10:19,980 --> 00:10:23,790
gift painted and you know<font color="#CCCCCC"> you</font><font color="#E5E5E5"> first you</font>

257
00:10:22,079 --> 00:10:30,479
identify that the files a document by

258
00:10:23,790 --> 00:10:32,550
the<font color="#E5E5E5"> the file header g0 CF and so on and</font>

259
00:10:30,480 --> 00:10:35,279
then<font color="#CCCCCC"> you'd also</font><font color="#E5E5E5"> see if there is a you</font>

260
00:10:32,550 --> 00:10:39,209
know<font color="#CCCCCC"> and ask e</font><font color="#E5E5E5"> string with either gift</font>

261
00:10:35,279 --> 00:10:42,630
<font color="#E5E5E5">underscore .</font><font color="#CCCCCC"> 481</font><font color="#E5E5E5"> underscore painted and</font>

262
00:10:39,209 --> 00:10:44,459
<font color="#E5E5E5">document and so what</font><font color="#CCCCCC"> i would do is you</font>

263
00:10:42,630 --> 00:10:47,070
know you play this rule for example<font color="#E5E5E5"> as a</font>

264
00:10:44,459 --> 00:10:49,018
more specific rule<font color="#E5E5E5"> that are you</font>

265
00:10:47,070 --> 00:10:50,519
definitely know is malicious and then

266
00:10:49,019 --> 00:10:52,800
you could take it alongside this next

267
00:10:50,519 --> 00:10:55,589
rule where it's actually just underscore

268
00:10:52,800 --> 00:10:57,300
painted by itself and then you could see

269
00:10:55,589 --> 00:10:59,100
maybe potential ones that<font color="#CCCCCC"> you're missing</font>

270
00:10:57,300 --> 00:11:01,020
<font color="#E5E5E5">and the reason I</font><font color="#CCCCCC"> pull this distinction</font>

271
00:10:59,100 --> 00:11:03,360
out is because<font color="#E5E5E5"> I</font><font color="#CCCCCC"> up</font>

272
00:11:01,020 --> 00:11:05,850
company like us we have the ability to

273
00:11:03,360 --> 00:11:08,910
use your rules to block<font color="#E5E5E5"> inbound</font>

274
00:11:05,850 --> 00:11:11,940
<font color="#E5E5E5">attachments through email</font><font color="#CCCCCC"> so everytime</font>

275
00:11:08,910 --> 00:11:15,329
<font color="#CCCCCC">email comes in our engine will scan it</font>

276
00:11:11,940 --> 00:11:17,070
with your signature and if it matches

277
00:11:15,330 --> 00:11:19,440
<font color="#E5E5E5">and</font><font color="#CCCCCC"> it will block</font><font color="#E5E5E5"> in remove that</font>

278
00:11:17,070 --> 00:11:22,320
attachment from the users from ever

279
00:11:19,440 --> 00:11:25,920
getting that attachment<font color="#CCCCCC"> so obviously you</font>

280
00:11:22,320 --> 00:11:27,600
have to be a little bit more<font color="#E5E5E5"> on strict</font>

281
00:11:25,920 --> 00:11:29,610
on those rules that you deploy because

282
00:11:27,600 --> 00:11:31,380
you don't want to start blocking all

283
00:11:29,610 --> 00:11:33,060
<font color="#E5E5E5">your company's email some people are you</font>

284
00:11:31,380 --> 00:11:36,600
get fired and<font color="#CCCCCC"> there's a good resume</font>

285
00:11:33,060 --> 00:11:40,650
generating experience as a<font color="#E5E5E5"> one of my</font>

286
00:11:36,600 --> 00:11:43,080
upper management people would say<font color="#E5E5E5"> so</font>

287
00:11:40,650 --> 00:11:45,390
what what you would do is you would have

288
00:11:43,080 --> 00:11:47,070
a rule like this<font color="#CCCCCC"> that's much more</font>

289
00:11:45,390 --> 00:11:49,620
specific and that you know you've seen

290
00:11:47,070 --> 00:11:51,600
<font color="#E5E5E5">and you</font><font color="#CCCCCC"> use like restaurants to verify</font>

291
00:11:49,620 --> 00:11:55,170
that there is not a huge<font color="#E5E5E5"> false positive</font>

292
00:11:51,600 --> 00:11:57,810
ratio with this<font color="#CCCCCC"> uh</font><font color="#E5E5E5"> you know rule or</font>

293
00:11:55,170 --> 00:11:59,969
ideally<font color="#CCCCCC"> a</font><font color="#E5E5E5"> no false positives if you do</font>

294
00:11:57,810 --> 00:12:02,189
have false positives like you can<font color="#E5E5E5"> you</font>

295
00:11:59,970 --> 00:12:04,170
should probably go and look at<font color="#CCCCCC"> my maybe</font>

296
00:12:02,190 --> 00:12:05,580
you need to make your rule little bit

297
00:12:04,170 --> 00:12:08,130
stricter so you don't have to run that

298
00:12:05,580 --> 00:12:09,690
risk of you know people being mad<font color="#CCCCCC"> at</font><font color="#E5E5E5"> you</font>

299
00:12:08,130 --> 00:12:11,910
<font color="#CCCCCC">tripped their emails</font>

300
00:12:09,690 --> 00:12:13,680
<font color="#CCCCCC">I'm so you</font><font color="#E5E5E5"> would compare it with hits</font>

301
00:12:11,910 --> 00:12:15,660
with like maybe a more generic<font color="#CCCCCC"> rule</font>

302
00:12:13,680 --> 00:12:17,550
<font color="#E5E5E5">virustotal and then you can compare the</font>

303
00:12:15,660 --> 00:12:19,770
hashes and see<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> hitting</font><font color="#E5E5E5"> what's not</font>

304
00:12:17,550 --> 00:12:22,829
<font color="#E5E5E5">and then maybe go look at see what's not</font>

305
00:12:19,770 --> 00:12:24,510
hitting<font color="#E5E5E5"> in virustotal and see what you</font>

306
00:12:22,830 --> 00:12:27,300
might be missing to make your rule<font color="#E5E5E5"> catch</font>

307
00:12:24,510 --> 00:12:29,040
the stuff that you're missing<font color="#E5E5E5"> and then</font>

308
00:12:27,300 --> 00:12:32,189
you can even open up even more<font color="#CCCCCC"> we're</font>

309
00:12:29,040 --> 00:12:35,099
like I<font color="#CCCCCC"> you basically write a very wide</font>

310
00:12:32,190 --> 00:12:38,910
open rule<font color="#E5E5E5"> that's that not necessarily is</font>

311
00:12:35,100 --> 00:12:42,300
<font color="#E5E5E5">gonna</font><font color="#CCCCCC"> January</font><font color="#E5E5E5"> are almost documents on</font><font color="#CCCCCC"> it</font>

312
00:12:38,910 --> 00:12:44,280
soon<font color="#CCCCCC"> but you can just detect a VA file</font>

313
00:12:42,300 --> 00:12:46,979
in a<font color="#E5E5E5"> word document for example and</font>

314
00:12:44,280 --> 00:12:49,560
compare that against your<font color="#E5E5E5"> you know each</font>

315
00:12:46,980 --> 00:12:52,380
<font color="#E5E5E5">data set up and see you know maybe I</font>

316
00:12:49,560 --> 00:12:55,500
have a few thousand hits with these and

317
00:12:52,380 --> 00:12:57,150
then<font color="#E5E5E5"> I</font><font color="#CCCCCC"> have you know I double that with</font>

318
00:12:55,500 --> 00:12:59,040
the underscore painted and then with

319
00:12:57,150 --> 00:13:01,319
like just<font color="#E5E5E5"> macro calls in general with</font>

320
00:12:59,040 --> 00:13:02,910
<font color="#CCCCCC">you no</font><font color="#E5E5E5"> additional rules obviously you</font>

321
00:13:01,320 --> 00:13:04,500
can see that<font color="#CCCCCC"> oh there's you know a</font>

322
00:13:02,910 --> 00:13:07,319
hundred thousand files that have been

323
00:13:04,500 --> 00:13:09,180
uploaded that are<font color="#E5E5E5"> you have macros in</font>

324
00:13:07,320 --> 00:13:11,820
them and<font color="#CCCCCC"> i'm only detecting</font><font color="#E5E5E5"> you know</font>

325
00:13:09,180 --> 00:13:14,640
10,000<font color="#E5E5E5"> that</font><font color="#CCCCCC"> could give you a really good</font>

326
00:13:11,820 --> 00:13:16,890
representation of like how well

327
00:13:14,640 --> 00:13:20,160
you're more specific rules are doing

328
00:13:16,890 --> 00:13:22,080
based on<font color="#E5E5E5"> uh you know that context and if</font>

329
00:13:20,160 --> 00:13:25,230
you don't<font color="#CCCCCC"> I</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> you have the</font>

330
00:13:22,080 --> 00:13:27,120
additional<font color="#CCCCCC"> I</font><font color="#E5E5E5"> indicators to specifically</font>

331
00:13:25,230 --> 00:13:29,130
track the other ones<font color="#E5E5E5"> you're missing</font><font color="#CCCCCC"> you</font>

332
00:13:27,120 --> 00:13:30,810
can<font color="#CCCCCC"> then pull down</font><font color="#E5E5E5"> virustotal and</font>

333
00:13:29,130 --> 00:13:33,900
potentially develop<font color="#E5E5E5"> you know even more</font>

334
00:13:30,810 --> 00:13:35,849
rules to help you there<font color="#CCCCCC"> is an example</font>

335
00:13:33,900 --> 00:13:38,069
anyways<font color="#E5E5E5"> so back to this like collection</font>

336
00:13:35,850 --> 00:13:40,290
thing<font color="#CCCCCC"> I'm so now we've got to look more</font>

337
00:13:38,070 --> 00:13:42,780
<font color="#E5E5E5">at like the actual rules in</font><font color="#CCCCCC"> maybe how</font>

338
00:13:40,290 --> 00:13:44,670
you can feed that into<font color="#CCCCCC"> elasticsearch so</font>

339
00:13:42,780 --> 00:13:47,939
when you pull the<font color="#E5E5E5"> those notifications</font>

340
00:13:44,670 --> 00:13:49,890
from the<font color="#E5E5E5"> API</font><font color="#CCCCCC"> I just didn't</font><font color="#E5E5E5"> elasticsearch</font>

341
00:13:47,940 --> 00:13:51,150
<font color="#E5E5E5">and allows you to you know right</font>

342
00:13:49,890 --> 00:13:53,010
additional<font color="#E5E5E5"> scripts</font><font color="#CCCCCC"> that could compare</font>

343
00:13:51,150 --> 00:13:54,900
all the stuff automatically for you

344
00:13:53,010 --> 00:13:57,060
so literally just have a script running

345
00:13:54,900 --> 00:13:59,520
<font color="#E5E5E5">everyday that's like okay I'm gonna go</font>

346
00:13:57,060 --> 00:14:03,449
into the forest<font color="#E5E5E5"> total notification index</font>

347
00:13:59,520 --> 00:14:06,120
and I'm gonna pull all of my TV call

348
00:14:03,450 --> 00:14:08,760
hits and then<font color="#CCCCCC"> I'll pull all my bit more</font>

349
00:14:06,120 --> 00:14:11,520
specific hits into a comparison and then

350
00:14:08,760 --> 00:14:13,830
maybe run an additional tool to spit out

351
00:14:11,520 --> 00:14:15,960
the functions that you might not be

352
00:14:13,830 --> 00:14:17,430
getting<font color="#E5E5E5"> and maybe</font><font color="#CCCCCC"> some new</font><font color="#E5E5E5"> email about</font>

353
00:14:15,960 --> 00:14:19,920
it that you can then go and do some

354
00:14:17,430 --> 00:14:24,989
manual analysis to you<font color="#E5E5E5"> know increase</font>

355
00:14:19,920 --> 00:14:27,839
your<font color="#CCCCCC"> eye detection</font><font color="#E5E5E5"> you know anyways</font><font color="#CCCCCC"> I</font>

356
00:14:24,990 --> 00:14:30,150
<font color="#CCCCCC">soon but</font><font color="#E5E5E5"> back to elasticsearch so</font>

357
00:14:27,840 --> 00:14:32,160
basically<font color="#E5E5E5"> elasticsearch</font><font color="#CCCCCC"> and command will</font>

358
00:14:30,150 --> 00:14:34,260
allow you to visualize<font color="#E5E5E5"> notification</font>

359
00:14:32,160 --> 00:14:35,850
patterns<font color="#CCCCCC"> i will tell you what is</font>

360
00:14:34,260 --> 00:14:39,450
potentially a rule is dropped off like

361
00:14:35,850 --> 00:14:44,430
we've seen this in the past<font color="#CCCCCC"> a big</font><font color="#E5E5E5"> wave</font>

362
00:14:39,450 --> 00:14:46,860
<font color="#E5E5E5">will hit and then you'll see that</font><font color="#CCCCCC"> yard</font>

363
00:14:44,430 --> 00:14:48,810
that<font color="#CCCCCC"> you're hunting</font><font color="#E5E5E5"> rules stopping or</font>

364
00:14:46,860 --> 00:14:50,970
<font color="#CCCCCC">we'll hit</font><font color="#E5E5E5"> less frequently you know go</font>

365
00:14:48,810 --> 00:14:52,800
from<font color="#E5E5E5"> hitting a few hundred hits a day</font><font color="#CCCCCC"> to</font>

366
00:14:50,970 --> 00:14:54,810
<font color="#E5E5E5">one or two that today</font><font color="#CCCCCC"> and you know</font><font color="#E5E5E5"> it</font>

367
00:14:52,800 --> 00:14:56,550
tells you<font color="#E5E5E5"> like it you know how I active</font>

368
00:14:54,810 --> 00:14:59,189
<font color="#E5E5E5">that one is and it gives you a good</font>

369
00:14:56,550 --> 00:15:01,380
representation<font color="#CCCCCC"> overtime when something</font>

370
00:14:59,190 --> 00:15:02,430
drops off maybe you should be looking

371
00:15:01,380 --> 00:15:06,090
into what

372
00:15:02,430 --> 00:15:08,219
there's<font color="#CCCCCC"> no pivoting to use or you know</font>

373
00:15:06,090 --> 00:15:10,290
what<font color="#CCCCCC"> you're not detecting now that that</font>

374
00:15:08,220 --> 00:15:12,180
gap is there because obviously if you go

375
00:15:10,290 --> 00:15:14,219
from honored<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> there's</font><font color="#CCCCCC"> 10,000</font>

376
00:15:12,180 --> 00:15:16,170
notifications a month or whatever on you

377
00:15:14,220 --> 00:15:18,960
<font color="#CCCCCC">know documents with macros in them in</font>

378
00:15:16,170 --> 00:15:20,699
<font color="#E5E5E5">all</font><font color="#CCCCCC"> senior you're</font><font color="#E5E5E5"> taking 10,000 you're</font>

379
00:15:18,960 --> 00:15:21,960
<font color="#E5E5E5">texting</font><font color="#CCCCCC"> 5,000 they're still going to be</font>

380
00:15:20,700 --> 00:15:24,540
a hundred thousand you know like it's

381
00:15:21,960 --> 00:15:26,430
not like they just went away and<font color="#E5E5E5"> it's</font>

382
00:15:24,540 --> 00:15:27,750
gone like obviously they pivoted you

383
00:15:26,430 --> 00:15:29,579
need to<font color="#E5E5E5"> pivot with them</font>

384
00:15:27,750 --> 00:15:32,220
<font color="#CCCCCC">I know try to keep ahead of them just</font>

385
00:15:29,580 --> 00:15:33,870
for example to show you like<font color="#CCCCCC"> over</font><font color="#E5E5E5"> time</font>

386
00:15:32,220 --> 00:15:35,850
you can<font color="#E5E5E5"> see that you know maybe some</font>

387
00:15:33,870 --> 00:15:37,950
days<font color="#E5E5E5"> or more specific and then you can</font>

388
00:15:35,850 --> 00:15:40,170
kind of maybe<font color="#E5E5E5"> potentially build a</font>

389
00:15:37,950 --> 00:15:42,690
pattern on that<font color="#E5E5E5"> but not typically</font>

390
00:15:40,170 --> 00:15:44,910
normally it's just a<font color="#CCCCCC"> I</font><font color="#E5E5E5"> based on your</font>

391
00:15:42,690 --> 00:15:46,980
rules like when you can obviously see

392
00:15:44,910 --> 00:15:49,740
this peak in the middle<font color="#E5E5E5"> we probably just</font>

393
00:15:46,980 --> 00:15:51,270
deployed a new rule<font color="#E5E5E5"> and you know started</font>

394
00:15:49,740 --> 00:15:53,370
to pick up more things and then you can

395
00:15:51,270 --> 00:15:54,990
see it gradually goes down afterwards

396
00:15:53,370 --> 00:15:56,550
and then you know maybe<font color="#E5E5E5"> we're deploying</font>

397
00:15:54,990 --> 00:15:58,200
more rules to bring that back up

398
00:15:56,550 --> 00:16:00,209
normally if you don't manage your

399
00:15:58,200 --> 00:16:02,640
<font color="#CCCCCC">ruleset you're not gonna</font><font color="#E5E5E5"> be continually</font>

400
00:16:00,210 --> 00:16:04,140
see that increasing your hips<font color="#E5E5E5"> you're</font>

401
00:16:02,640 --> 00:16:06,090
<font color="#E5E5E5">going to actually see a decrease in your</font>

402
00:16:04,140 --> 00:16:07,770
your actual more specific hits and

403
00:16:06,090 --> 00:16:09,330
obviously if you're just looking<font color="#CCCCCC"> outward</font>

404
00:16:07,770 --> 00:16:13,980
macros it's going to stay pretty<font color="#CCCCCC"> sick</font>

405
00:16:09,330 --> 00:16:15,390
<font color="#CCCCCC">pretty much the same anyways</font><font color="#E5E5E5"> so just</font>

406
00:16:13,980 --> 00:16:18,000
<font color="#E5E5E5">give you example you can quickly just</font>

407
00:16:15,390 --> 00:16:20,160
look in your dashboard<font color="#CCCCCC"> and be like</font><font color="#E5E5E5"> based</font>

408
00:16:18,000 --> 00:16:23,010
on<font color="#E5E5E5"> all of these rules i'm seeing</font>

409
00:16:20,160 --> 00:16:25,110
<font color="#E5E5E5">basically all these different</font><font color="#CCCCCC"> you know</font>

410
00:16:23,010 --> 00:16:28,020
you can see the bigger half is like the

411
00:16:25,110 --> 00:16:34,020
more<font color="#CCCCCC"> wide open rule and then the</font><font color="#E5E5E5"> in this</font>

412
00:16:28,020 --> 00:16:39,720
<font color="#CCCCCC">right-hand</font><font color="#E5E5E5"> see that</font>

413
00:16:34,020 --> 00:16:44,189
<font color="#E5E5E5">nope so yeah like the</font><font color="#CCCCCC"> pie tree basically</font>

414
00:16:39,720 --> 00:16:46,800
<font color="#E5E5E5">the</font><font color="#CCCCCC"> microsoft just basic</font><font color="#E5E5E5"> macro call is</font>

415
00:16:44,190 --> 00:16:49,770
this like yellow side of the pie and

416
00:16:46,800 --> 00:16:51,599
then the<font color="#CCCCCC"> there's a BB</font><font color="#E5E5E5"> call-by-name</font><font color="#CCCCCC"> a</font>

417
00:16:49,770 --> 00:16:54,360
function that you<font color="#CCCCCC"> can see this</font><font color="#E5E5E5"> light</font>

418
00:16:51,600 --> 00:16:56,670
<font color="#E5E5E5">blue slice and then you can see as it</font>

419
00:16:54,360 --> 00:17:00,330
goes down<font color="#CCCCCC"> to</font><font color="#E5E5E5"> like that blue basically</font>

420
00:16:56,670 --> 00:17:04,050
represents probably most of your overall

421
00:17:00,330 --> 00:17:06,030
macro<font color="#E5E5E5"> scripts because obviously</font><font color="#CCCCCC"> it's are</font>

422
00:17:04,050 --> 00:17:07,740
representing about half of the overall

423
00:17:06,030 --> 00:17:09,540
<font color="#E5E5E5">macros</font><font color="#CCCCCC"> you're seeing just based on this</font>

424
00:17:07,740 --> 00:17:11,130
picture<font color="#CCCCCC"> does</font><font color="#E5E5E5"> that make sense</font>

425
00:17:09,540 --> 00:17:15,449
you see that representation<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> not</font>

426
00:17:11,130 --> 00:17:17,370
<font color="#CCCCCC">there</font><font color="#E5E5E5"> so anyways so what you can do</font>

427
00:17:15,449 --> 00:17:20,040
after this<font color="#E5E5E5"> right like so you have all</font>

428
00:17:17,369 --> 00:17:22,050
<font color="#E5E5E5">this stuff hitting your indexing all</font>

429
00:17:20,040 --> 00:17:24,240
these basically<font color="#CCCCCC"> json</font><font color="#E5E5E5"> reports that you</font>

430
00:17:22,050 --> 00:17:26,159
can pull from the<font color="#E5E5E5"> API from virustotal</font>

431
00:17:24,240 --> 00:17:28,680
<font color="#CCCCCC">and you're putting into</font><font color="#E5E5E5"> elasticsearch</font>

432
00:17:26,160 --> 00:17:30,600
into an index<font color="#CCCCCC"> so what can you do after</font>

433
00:17:28,680 --> 00:17:31,740
you know you've had these rules it you

434
00:17:30,600 --> 00:17:33,870
have the rules that are<font color="#CCCCCC"> detected more</font>

435
00:17:31,740 --> 00:17:35,490
specifically<font color="#CCCCCC"> the</font><font color="#E5E5E5"> ones that are detecting</font>

436
00:17:33,870 --> 00:17:37,439
<font color="#E5E5E5">less specifically</font><font color="#CCCCCC"> and how do you</font>

437
00:17:35,490 --> 00:17:39,630
automate that you don't have to do too

438
00:17:37,440 --> 00:17:41,330
much manual work<font color="#E5E5E5"> casino</font><font color="#CCCCCC"> who wants to</font>

439
00:17:39,630 --> 00:17:44,240
work we all want<font color="#E5E5E5"> to like</font><font color="#CCCCCC"> going to have</font>

440
00:17:41,330 --> 00:17:46,939
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> a good time we want to stop the</font>

441
00:17:44,240 --> 00:17:48,890
bad guys there so we can<font color="#CCCCCC"> fit</font><font color="#E5E5E5"> it into</font>

442
00:17:46,940 --> 00:17:53,299
like<font color="#E5E5E5"> a you know a coup or a different</font>

443
00:17:48,890 --> 00:17:54,919
<font color="#CCCCCC">paid</font><font color="#E5E5E5"> commercial sandbox</font><font color="#CCCCCC"> alright uh and</font>

444
00:17:53,299 --> 00:17:57,440
then<font color="#E5E5E5"> you can automate maybe</font><font color="#CCCCCC"> I'll see</font>

445
00:17:54,919 --> 00:18:00,440
collection from the<font color="#CCCCCC"> Kuwaiti</font><font color="#E5E5E5"> I and deploy</font>

446
00:17:57,440 --> 00:18:02,269
it to like a<font color="#E5E5E5"> in our case tab or and</font>

447
00:18:00,440 --> 00:18:05,600
someone<font color="#E5E5E5"> else's case you know whatever</font>

448
00:18:02,269 --> 00:18:07,460
<font color="#E5E5E5">your IDs rules that you have or you know</font>

449
00:18:05,600 --> 00:18:09,529
however<font color="#E5E5E5"> you're detecting like domains</font>

450
00:18:07,460 --> 00:18:11,210
<font color="#CCCCCC">eye peas or anything else that can show</font>

451
00:18:09,529 --> 00:18:14,330
up in a you know<font color="#CCCCCC"> cuckoo reports that you</font>

452
00:18:11,210 --> 00:18:16,159
could use<font color="#E5E5E5"> deployment and then you can</font>

453
00:18:14,330 --> 00:18:18,168
automate notifications as well so like

454
00:18:16,159 --> 00:18:20,870
like<font color="#CCCCCC"> I was talking about earlier</font><font color="#E5E5E5"> you can</font>

455
00:18:18,169 --> 00:18:23,120
automate<font color="#E5E5E5"> a notification to show you all</font>

456
00:18:20,870 --> 00:18:25,070
the<font color="#CCCCCC"> BBA functions in the documents that</font>

457
00:18:23,120 --> 00:18:26,479
you're not hitting on with<font color="#CCCCCC"> the more</font>

458
00:18:25,070 --> 00:18:28,789
specific rules<font color="#E5E5E5"> but you're heading down</font>

459
00:18:26,480 --> 00:18:30,169
with the more like<font color="#CCCCCC"> generic macro rules</font>

460
00:18:28,789 --> 00:18:32,960
and obviously some of those<font color="#E5E5E5"> will just be</font>

461
00:18:30,169 --> 00:18:35,029
straight like<font color="#CCCCCC"> nine on</font><font color="#E5E5E5"> there is cases</font>

462
00:18:32,960 --> 00:18:39,080
where that does happen but not as

463
00:18:35,029 --> 00:18:40,610
frequent<font color="#E5E5E5"> so when you automate the use of</font>

464
00:18:39,080 --> 00:18:42,830
these<font color="#CCCCCC"> collection</font><font color="#E5E5E5"> scripts</font>

465
00:18:40,610 --> 00:18:48,110
<font color="#E5E5E5">I you know you you can greatly increase</font>

466
00:18:42,830 --> 00:18:51,439
your<font color="#E5E5E5"> on detection</font><font color="#CCCCCC"> i kinda like</font><font color="#E5E5E5"> net and</font>

467
00:18:48,110 --> 00:18:53,149
then have to automate this stuff and not

468
00:18:51,440 --> 00:18:55,010
have to like do all the stuff manually

469
00:18:53,149 --> 00:18:57,590
and<font color="#CCCCCC"> kind of like essentially create your</font>

470
00:18:55,010 --> 00:19:00,049
own<font color="#CCCCCC"> into instead of relying on another</font>

471
00:18:57,590 --> 00:19:01,730
vendor to generate<font color="#E5E5E5"> the stuff for you</font><font color="#CCCCCC"> so</font>

472
00:19:00,049 --> 00:19:05,029
you can<font color="#E5E5E5"> do it all yourself for a</font>

473
00:19:01,730 --> 00:19:06,950
relatively like I<font color="#CCCCCC"> you know easy</font><font color="#E5E5E5"> cost you</font>

474
00:19:05,029 --> 00:19:07,519
$MONEY<font color="#CCCCCC"> for those are you don't know I</font>

475
00:19:06,950 --> 00:19:09,980
<font color="#CCCCCC">can</font>

476
00:19:07,519 --> 00:19:11,870
there is a rule<font color="#CCCCCC"> list</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> the our</font>

477
00:19:09,980 --> 00:19:15,440
signature exchange<font color="#E5E5E5"> you can get on it i</font>

478
00:19:11,870 --> 00:19:18,439
would recommend it<font color="#E5E5E5"> it's a basically a</font>

479
00:19:15,440 --> 00:19:21,110
community<font color="#CCCCCC"> list that provides your</font>

480
00:19:18,440 --> 00:19:23,419
signatures and<font color="#E5E5E5"> people collaboratively</font>

481
00:19:21,110 --> 00:19:25,039
work on them so you can<font color="#E5E5E5"> maybe</font><font color="#CCCCCC"> learn from</font>

482
00:19:23,419 --> 00:19:27,080
some other<font color="#CCCCCC"> people deploy their rules and</font>

483
00:19:25,039 --> 00:19:30,799
also<font color="#E5E5E5"> track the</font><font color="#CCCCCC"> campaign's they're</font>

484
00:19:27,080 --> 00:19:34,668
tracking as well<font color="#E5E5E5"> and with that you can</font>

485
00:19:30,799 --> 00:19:35,539
actually get a free into virustotal<font color="#E5E5E5"> of</font>

486
00:19:34,669 --> 00:19:37,519
intelligence

487
00:19:35,539 --> 00:19:41,480
however it's a little bit<font color="#E5E5E5"> limited</font><font color="#CCCCCC"> on</font>

488
00:19:37,519 --> 00:19:44,779
what<font color="#E5E5E5"> you can do with it anyways</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> kind</font>

489
00:19:41,480 --> 00:19:45,590
<font color="#E5E5E5">of like bring</font><font color="#CCCCCC"> us around in like so</font><font color="#E5E5E5"> what</font>

490
00:19:44,779 --> 00:19:46,880
can we do

491
00:19:45,590 --> 00:19:49,039
what is<font color="#E5E5E5"> the script that</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> have to</font>

492
00:19:46,880 --> 00:19:51,500
<font color="#E5E5E5">write to automate you know the</font>

493
00:19:49,039 --> 00:19:53,030
collection of some of these<font color="#CCCCCC"> IOC's i'm</font>

494
00:19:51,500 --> 00:19:55,310
<font color="#E5E5E5">not talking just about</font><font color="#CCCCCC"> one</font>

495
00:19:53,030 --> 00:19:56,899
it's called Viper monkey<font color="#CCCCCC"> on</font><font color="#E5E5E5"> how many</font>

496
00:19:55,310 --> 00:19:59,780
<font color="#E5E5E5">people have heard of</font><font color="#CCCCCC"> vipre</font><font color="#E5E5E5"> monkey it</font>

497
00:19:56,900 --> 00:20:03,230
came out a little bit recently<font color="#E5E5E5"> so it's</font>

498
00:19:59,780 --> 00:20:05,149
just basically like a vba macro parser

499
00:20:03,230 --> 00:20:08,360
<font color="#E5E5E5">you can run against malicious</font><font color="#CCCCCC"> word</font>

500
00:20:05,150 --> 00:20:12,830
documents and we'll try to<font color="#CCCCCC"> drv</font><font color="#E5E5E5"> skate</font><font color="#CCCCCC"> the</font>

501
00:20:08,360 --> 00:20:15,530
<font color="#CCCCCC">code that is being confiscated</font><font color="#E5E5E5"> on so for</font>

502
00:20:12,830 --> 00:20:17,659
an example<font color="#E5E5E5"> that he has on</font><font color="#CCCCCC"> its a</font><font color="#E5E5E5"> website</font>

503
00:20:15,530 --> 00:20:22,280
as an example for using<font color="#E5E5E5"> a script this</font>

504
00:20:17,660 --> 00:20:25,580
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> the monkey</font><font color="#CCCCCC"> pie</font><font color="#E5E5E5"> against this old</font>

505
00:20:22,280 --> 00:20:27,770
2009<font color="#E5E5E5"> word document and you can see in</font>

506
00:20:25,580 --> 00:20:29,780
this first picture that<font color="#E5E5E5"> I down here the</font>

507
00:20:27,770 --> 00:20:31,910
private declare function<font color="#E5E5E5"> you're all</font>

508
00:20:29,780 --> 00:20:33,710
<font color="#E5E5E5">download a like and then</font><font color="#CCCCCC"> there's no just</font>

509
00:20:31,910 --> 00:20:40,700
a<font color="#E5E5E5"> bunch of like gibberish after that and</font>

510
00:20:33,710 --> 00:20:42,140
some of those calls and what it would do

511
00:20:40,700 --> 00:20:45,500
is it goes through<font color="#E5E5E5"> and it starts to</font>

512
00:20:42,140 --> 00:20:47,630
detect some of the code and then it will

513
00:20:45,500 --> 00:20:50,600
<font color="#E5E5E5">are basically record some of the actions</font>

514
00:20:47,630 --> 00:20:53,060
that<font color="#CCCCCC"> is detecting like the download URL</font>

515
00:20:50,600 --> 00:20:55,040
what follows being out you know written

516
00:20:53,060 --> 00:20:56,600
out and you know what commands might<font color="#E5E5E5"> be</font>

517
00:20:55,040 --> 00:20:59,600
<font color="#E5E5E5">potentially being executed after it</font>

518
00:20:56,600 --> 00:21:01,310
tries to<font color="#CCCCCC"> drv skate</font><font color="#E5E5E5"> the malicious word</font>

519
00:20:59,600 --> 00:21:04,429
document<font color="#CCCCCC"> now this isn't</font><font color="#E5E5E5"> a perfect script</font>

520
00:21:01,310 --> 00:21:06,649
but it definitely can work on<font color="#CCCCCC"> I know a</font>

521
00:21:04,430 --> 00:21:09,530
good decent ratio of these<font color="#E5E5E5"> malicious</font>

522
00:21:06,650 --> 00:21:16,370
<font color="#CCCCCC">word documents we've been seen</font>

523
00:21:09,530 --> 00:21:17,960
so<font color="#E5E5E5"> yeah it basically you</font><font color="#CCCCCC"> could</font><font color="#E5E5E5"> just you</font>

524
00:21:16,370 --> 00:21:20,060
know have this<font color="#E5E5E5"> run against all the stuff</font>

525
00:21:17,960 --> 00:21:22,550
<font color="#CCCCCC">you're you're not seen</font><font color="#E5E5E5"> and maybe spit</font>

526
00:21:20,060 --> 00:21:24,620
into another<font color="#E5E5E5"> elastic search index and</font>

527
00:21:22,550 --> 00:21:26,840
then be able to look at that information

528
00:21:24,620 --> 00:21:28,219
and see<font color="#E5E5E5"> like said maybe some of the</font>

529
00:21:26,840 --> 00:21:30,439
stuff that you're not seen or even

530
00:21:28,220 --> 00:21:33,170
deploy<font color="#CCCCCC"> urls and IPS that</font><font color="#E5E5E5"> you're seeing</font>

531
00:21:30,440 --> 00:21:34,640
these<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> your documents</font><font color="#E5E5E5"> is just</font>

532
00:21:33,170 --> 00:21:36,530
one of the many examples<font color="#CCCCCC"> i could</font>

533
00:21:34,640 --> 00:21:37,760
probably talk for like eight hours up

534
00:21:36,530 --> 00:21:39,440
here about all the different

535
00:21:37,760 --> 00:21:42,950
possibilities what you could do with

536
00:21:39,440 --> 00:21:45,650
this but<font color="#CCCCCC"> I'm so i would</font><font color="#E5E5E5"> have a demo</font>

537
00:21:42,950 --> 00:21:47,900
<font color="#CCCCCC">bobsleigh I'm out of time to it's not</font>

538
00:21:45,650 --> 00:21:50,510
really too bad because the most kind can

539
00:21:47,900 --> 00:21:52,880
go terribly<font color="#E5E5E5"> basically just to recap was</font>

540
00:21:50,510 --> 00:21:54,470
just a basic overview of how to just one

541
00:21:52,880 --> 00:21:56,930
use case of many that you can use

542
00:21:54,470 --> 00:21:58,970
<font color="#E5E5E5">virustotal intelligence</font><font color="#CCCCCC"> malicious word</font>

543
00:21:56,930 --> 00:22:01,430
documents is just the<font color="#E5E5E5"> 1i use</font><font color="#CCCCCC"> there are</font>

544
00:21:58,970 --> 00:22:02,810
plenty more use cases<font color="#CCCCCC"> and</font><font color="#E5E5E5"> and don't be</font>

545
00:22:01,430 --> 00:22:04,670
afraid to go in there and start writing

546
00:22:02,810 --> 00:22:07,250
very open rules there's nothing wrong

547
00:22:04,670 --> 00:22:10,220
with<font color="#CCCCCC"> flag in virustotal with a very open</font>

548
00:22:07,250 --> 00:22:11,600
rule<font color="#CCCCCC"> it's just a learning mechanism</font>

549
00:22:10,220 --> 00:22:13,040
now obviously<font color="#CCCCCC"> there is something</font><font color="#E5E5E5"> wrong</font>

550
00:22:11,600 --> 00:22:14,449
when you start<font color="#E5E5E5"> flagging</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of word</font>

551
00:22:13,040 --> 00:22:16,399
documents coming in and you're blocking

552
00:22:14,450 --> 00:22:18,800
that but you know maybe<font color="#CCCCCC"> have</font><font color="#E5E5E5"> the ability</font>

553
00:22:16,400 --> 00:22:21,290
alert on documents coming in and you can

554
00:22:18,800 --> 00:22:23,120
build a detection ratio based on what

555
00:22:21,290 --> 00:22:26,030
kind of<font color="#CCCCCC"> days in the wild</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> know</font>

556
00:22:23,120 --> 00:22:27,860
<font color="#E5E5E5">virustotal is a little bit more but</font><font color="#CCCCCC"> are</font>

557
00:22:26,030 --> 00:22:29,720
you know kind of more of a<font color="#CCCCCC"> biased of</font>

558
00:22:27,860 --> 00:22:32,090
data because people<font color="#CCCCCC"> so many</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> the</font>

559
00:22:29,720 --> 00:22:33,530
virus<font color="#CCCCCC"> cool on tend to have the intention</font>

560
00:22:32,090 --> 00:22:35,000
that it's already<font color="#E5E5E5"> malicious it's</font><font color="#CCCCCC"> going</font>

561
00:22:33,530 --> 00:22:37,639
<font color="#CCCCCC">to be a little bit more</font>

562
00:22:35,000 --> 00:22:39,350
<font color="#E5E5E5">it's obviously way more malicious and</font>

563
00:22:37,640 --> 00:22:44,030
what you'll see in just<font color="#E5E5E5"> two generic will</font>

564
00:22:39,350 --> 00:22:47,179
help anyways<font color="#CCCCCC"> i'm at a time so we will</font>

565
00:22:44,030 --> 00:23:01,490
<font color="#CCCCCC">end their does anyone have any questions</font>

566
00:22:47,180 --> 00:23:03,920
<font color="#CCCCCC">I'm so we use it to detect</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> you said</font>

567
00:23:01,490 --> 00:23:09,350
those pivots in those were campaigns and

568
00:23:03,920 --> 00:23:13,460
<font color="#E5E5E5">automated r io</font><font color="#CCCCCC"> sees two</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> alerting</font>

569
00:23:09,350 --> 00:23:15,139
systems<font color="#CCCCCC"> so like if we're seeing you know</font>

570
00:23:13,460 --> 00:23:17,450
<font color="#CCCCCC">a new word</font><font color="#E5E5E5"> campaign we haven't seen</font>

571
00:23:15,140 --> 00:23:21,050
before<font color="#CCCCCC"> I</font><font color="#E5E5E5"> will see like how we can</font>

572
00:23:17,450 --> 00:23:22,880
automate the collection<font color="#E5E5E5"> automate the the</font>

573
00:23:21,050 --> 00:23:24,470
collection of those indicators from it

574
00:23:22,880 --> 00:23:26,690
so if they're using like a static value

575
00:23:24,470 --> 00:23:29,090
<font color="#E5E5E5">or something we can</font><font color="#CCCCCC"> basic pattern we go</font>

576
00:23:26,690 --> 00:23:31,970
through<font color="#CCCCCC"> and extract out like the ip's in</font>

577
00:23:29,090 --> 00:23:34,669
the domains or maybe a value that the

578
00:23:31,970 --> 00:23:37,340
word document is using to execute<font color="#CCCCCC"> we</font>

579
00:23:34,670 --> 00:23:39,530
will<font color="#E5E5E5"> then deploy that you know to block</font>

580
00:23:37,340 --> 00:23:43,100
those incoming<font color="#CCCCCC"> word documents before</font>

581
00:23:39,530 --> 00:23:44,660
they get to you know the<font color="#E5E5E5"> then user or to</font>

582
00:23:43,100 --> 00:23:46,310
deploy<font color="#E5E5E5"> you know if you don't have that</font>

583
00:23:44,660 --> 00:23:48,110
capability maybe there's not something

584
00:23:46,310 --> 00:23:49,520
you can trigger on in the document<font color="#E5E5E5"> you</font>

585
00:23:48,110 --> 00:23:51,260
could write another script that just

586
00:23:49,520 --> 00:23:53,480
goes<font color="#E5E5E5"> through in like pulls out those</font>

587
00:23:51,260 --> 00:23:55,070
indicators<font color="#CCCCCC"> those ip's and then gives you</font>

588
00:23:53,480 --> 00:23:56,450
alerts if you see those<font color="#E5E5E5"> ip's or</font>

589
00:23:55,070 --> 00:23:57,500
indicators get hit

590
00:23:56,450 --> 00:24:02,919
obviously it takes a little bit more

591
00:23:57,500 --> 00:24:06,669
<font color="#E5E5E5">fine-tuning and stuff but</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> more</font>

592
00:24:02,919 --> 00:24:08,679
<font color="#CCCCCC">yeah alright thanks</font><font color="#E5E5E5"> for coming</font>

593
00:24:06,669 --> 00:24:10,059
hopefully that was<font color="#E5E5E5"> hope enjoyable for</font>

594
00:24:08,679 --> 00:24:16,679
you guys and you learn something that

595
00:24:10,059 --> 00:24:16,678
wasn't<font color="#CCCCCC"> I are gonna</font><font color="#E5E5E5"> waste</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> time</font>

