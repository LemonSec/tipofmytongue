1
00:00:00,000 --> 00:00:13,980
you good afternoon<font color="#CCCCCC"> thanks for coming for</font>

2
00:00:12,240 --> 00:00:17,220
one of the last<font color="#E5E5E5"> talks</font><font color="#CCCCCC"> in the first day</font>

3
00:00:13,980 --> 00:00:21,270
<font color="#E5E5E5">so I just want to talk a little bit</font>

4
00:00:17,220 --> 00:00:23,160
about how you can make<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> timelines</font>

5
00:00:21,270 --> 00:00:26,880
<font color="#E5E5E5">which is something</font><font color="#CCCCCC"> that's very commonly</font>

6
00:00:23,160 --> 00:00:31,769
done in<font color="#E5E5E5"> incident response and how you</font>

7
00:00:26,880 --> 00:00:35,219
can do it quickly and easily<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> is</font>

8
00:00:31,769 --> 00:00:39,390
this talk about<font color="#E5E5E5"> it's about how do you</font>

9
00:00:35,219 --> 00:00:41,700
create<font color="#E5E5E5"> timelines for</font><font color="#CCCCCC"> windows system and</font>

10
00:00:39,390 --> 00:00:44,910
this is something<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can do in minutes</font>

11
00:00:41,700 --> 00:00:48,090
not hours<font color="#CCCCCC"> if you've ever used other</font>

12
00:00:44,910 --> 00:00:50,788
tools like autopsy<font color="#CCCCCC"> you know that it</font>

13
00:00:48,090 --> 00:00:53,730
takes<font color="#CCCCCC"> awhile</font><font color="#E5E5E5"> right now here's a good</font>

14
00:00:50,789 --> 00:00:56,879
example two weeks ago I was in<font color="#CCCCCC"> Norway</font>

15
00:00:53,730 --> 00:00:58,589
doing a training class and they had

16
00:00:56,879 --> 00:01:00,989
asked<font color="#E5E5E5"> hey could we do some stuff with</font>

17
00:00:58,590 --> 00:01:04,799
autopsy<font color="#CCCCCC"> and I said sure</font><font color="#E5E5E5"> we'll do a</font>

18
00:01:00,989 --> 00:01:07,080
little bit of autopsy<font color="#E5E5E5"> so at nine o'clock</font>

19
00:01:04,799 --> 00:01:09,630
<font color="#CCCCCC">we</font><font color="#E5E5E5"> kicked off for the day I said</font><font color="#CCCCCC"> alright</font>

20
00:01:07,080 --> 00:01:11,400
everybody<font color="#CCCCCC"> here's a 26 gigabyte image</font>

21
00:01:09,630 --> 00:01:15,000
<font color="#CCCCCC">it's not very</font><font color="#E5E5E5"> large</font>

22
00:01:11,400 --> 00:01:17,430
why don't you go and start ingesting

23
00:01:15,000 --> 00:01:19,439
that into autopsy now because around two

24
00:01:17,430 --> 00:01:21,689
o'clock<font color="#CCCCCC"> you know five hours from now</font>

25
00:01:19,439 --> 00:01:25,439
<font color="#E5E5E5">we're going to be using it</font>

26
00:01:21,689 --> 00:01:28,919
everyone did<font color="#E5E5E5"> five hours later</font>

27
00:01:25,439 --> 00:01:31,380
most of them weren't done<font color="#CCCCCC"> autopsy was</font>

28
00:01:28,920 --> 00:01:33,630
still chewing away on that little<font color="#CCCCCC"> teeny</font>

29
00:01:31,380 --> 00:01:37,439
<font color="#CCCCCC">tiny 26 gigabyte image</font>

30
00:01:33,630 --> 00:01:39,479
the other thing that's nice about what

31
00:01:37,439 --> 00:01:41,758
<font color="#CCCCCC">I'm going to talk about today is it's</font>

32
00:01:39,479 --> 00:01:42,689
very flexible<font color="#CCCCCC"> if you use a tool like</font>

33
00:01:41,759 --> 00:01:44,490
autopsy

34
00:01:42,689 --> 00:01:46,648
<font color="#E5E5E5">I'm not beating up on autopsy by the way</font>

35
00:01:44,490 --> 00:01:52,399
you know it's the best value out there

36
00:01:46,649 --> 00:01:55,490
<font color="#E5E5E5">but if you have a view</font>

37
00:01:52,400 --> 00:01:59,300
in autopsy that's not exactly<font color="#E5E5E5"> what you</font>

38
00:01:55,490 --> 00:02:01,550
want<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> what that right</font><font color="#E5E5E5"> so this is</font>

39
00:01:59,300 --> 00:02:03,770
something that you can do<font color="#CCCCCC"> for you have a</font>

40
00:02:01,550 --> 00:02:05,360
lot more flexibility

41
00:02:03,770 --> 00:02:07,070
<font color="#E5E5E5">it's going to be backed up to a database</font>

42
00:02:05,360 --> 00:02:11,090
you can do all the queries you would

43
00:02:07,070 --> 00:02:14,329
ever want<font color="#E5E5E5"> also doesn't cost anything</font>

44
00:02:11,090 --> 00:02:18,410
<font color="#E5E5E5">it's using</font><font color="#CCCCCC"> Python</font><font color="#E5E5E5"> some shell scripting</font>

45
00:02:14,330 --> 00:02:20,660
and<font color="#E5E5E5"> mysql as a</font><font color="#CCCCCC"> back-end now some</font><font color="#E5E5E5"> of you</font>

46
00:02:18,410 --> 00:02:23,150
might prefer different database

47
00:02:20,660 --> 00:02:25,880
well whatever if you like<font color="#E5E5E5"> post grass</font><font color="#CCCCCC"> go</font>

48
00:02:23,150 --> 00:02:28,640
ahead<font color="#CCCCCC"> use</font><font color="#E5E5E5"> that instead</font><font color="#CCCCCC"> and you can also</font>

49
00:02:25,880 --> 00:02:31,790
easily create<font color="#E5E5E5"> timelines either</font>

50
00:02:28,640 --> 00:02:35,239
<font color="#E5E5E5">chronologically or</font><font color="#CCCCCC"> the file by file</font>

51
00:02:31,790 --> 00:02:38,720
<font color="#E5E5E5">basis so why should you care about this</font>

52
00:02:35,240 --> 00:02:41,959
<font color="#E5E5E5">anyway</font><font color="#CCCCCC"> having a timeline can be really</font>

53
00:02:38,720 --> 00:02:43,609
helpful determining what happened you

54
00:02:41,959 --> 00:02:45,290
know you're looking at a system<font color="#CCCCCC"> you</font>

55
00:02:43,610 --> 00:02:48,170
think there was a breach of some sort

56
00:02:45,290 --> 00:02:50,269
<font color="#E5E5E5">and you're trying to get a better</font>

57
00:02:48,170 --> 00:02:52,670
picture and normally in an investigation

58
00:02:50,270 --> 00:02:55,010
like this<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> kind of an iterative</font>

59
00:02:52,670 --> 00:02:57,920
process<font color="#CCCCCC"> you</font><font color="#E5E5E5"> learn a little bit</font><font color="#CCCCCC"> you learn</font>

60
00:02:55,010 --> 00:03:00,890
<font color="#E5E5E5">a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> more and you get a little</font>

61
00:02:57,920 --> 00:03:03,559
bit more of the puzzle<font color="#E5E5E5"> and you can start</font>

62
00:03:00,890 --> 00:03:06,170
zooming in certain time periods so

63
00:03:03,560 --> 00:03:09,019
having a timeline is great when you can

64
00:03:06,170 --> 00:03:12,920
look at what files were changed access

65
00:03:09,019 --> 00:03:16,550
etc<font color="#E5E5E5"> during a certain time now</font>

66
00:03:12,920 --> 00:03:19,518
<font color="#E5E5E5">ntfs which is the new default file</font>

67
00:03:16,550 --> 00:03:21,680
system for<font color="#E5E5E5"> windows</font><font color="#CCCCCC"> in fact if you have a</font>

68
00:03:19,519 --> 00:03:24,290
modern version of<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

69
00:03:21,680 --> 00:03:26,930
<font color="#CCCCCC">install it</font><font color="#E5E5E5"> on anything else you</font><font color="#CCCCCC"> can</font>

70
00:03:24,290 --> 00:03:29,540
<font color="#E5E5E5">install it on fat anymore</font><font color="#CCCCCC"> it just</font>

71
00:03:26,930 --> 00:03:32,930
<font color="#E5E5E5">doesn't work because some of the</font>

72
00:03:29,540 --> 00:03:39,620
features<font color="#CCCCCC"> in ntfs</font><font color="#E5E5E5"> are required in order</font>

73
00:03:32,930 --> 00:03:42,019
to run<font color="#E5E5E5"> windows so ntfs stores</font><font color="#CCCCCC"> time</font>

74
00:03:39,620 --> 00:03:45,170
<font color="#CCCCCC">stamps</font><font color="#E5E5E5"> for all of your files and</font>

75
00:03:42,019 --> 00:03:50,600
directories and<font color="#E5E5E5"> it stores them in a very</font>

76
00:03:45,170 --> 00:03:53,450
redundant way<font color="#E5E5E5"> so there are more than one</font>

77
00:03:50,600 --> 00:03:56,060
place where you're going to find these

78
00:03:53,450 --> 00:04:00,079
<font color="#CCCCCC">time stamps</font><font color="#E5E5E5"> which is not a good thing</font>

79
00:03:56,060 --> 00:04:03,410
for consistency<font color="#E5E5E5"> also</font>

80
00:04:00,080 --> 00:04:05,330
there are some pretty complicated rules

81
00:04:03,410 --> 00:04:08,180
that do tend to change from time to time

82
00:04:05,330 --> 00:04:12,230
on how these<font color="#CCCCCC"> timestamps should be</font>

83
00:04:08,180 --> 00:04:15,710
updated<font color="#E5E5E5"> so as a result you can have</font>

84
00:04:12,230 --> 00:04:18,230
attackers manually modifying<font color="#E5E5E5"> timestamps</font>

85
00:04:15,710 --> 00:04:21,950
and it's kind of easy to detect that

86
00:04:18,230 --> 00:04:26,240
they've done<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so I'm going to give</font>

87
00:04:21,950 --> 00:04:28,400
<font color="#E5E5E5">you a</font><font color="#CCCCCC"> five-minute tutorial on ntfs</font><font color="#E5E5E5"> so my</font>

88
00:04:26,240 --> 00:04:30,260
students who might be here are really

89
00:04:28,400 --> 00:04:33,859
disappointed by this because they get an

90
00:04:30,260 --> 00:04:36,590
entire semester on ntfs<font color="#CCCCCC"> but i'm going to</font>

91
00:04:33,860 --> 00:04:37,910
try<font color="#E5E5E5"> to teach you in five minutes</font>

92
00:04:36,590 --> 00:04:42,109
what you need to know at least to

93
00:04:37,910 --> 00:04:45,380
understand timelines<font color="#E5E5E5"> so in</font><font color="#CCCCCC"> ntfs</font><font color="#E5E5E5"> every</font>

94
00:04:42,110 --> 00:04:49,190
file is a collection of attributes<font color="#E5E5E5"> so</font>

95
00:04:45,380 --> 00:04:51,560
these attributes include things like

96
00:04:49,190 --> 00:04:54,170
standard information<font color="#E5E5E5"> and standard</font>

97
00:04:51,560 --> 00:04:57,500
information has what we call<font color="#CCCCCC"> Macker</font>

98
00:04:54,170 --> 00:05:01,160
<font color="#CCCCCC">times modified access created or</font><font color="#E5E5E5"> record</font>

99
00:04:57,500 --> 00:05:04,220
change times and every file has at least

100
00:05:01,160 --> 00:05:05,750
one<font color="#CCCCCC"> file name and that's in a different</font>

101
00:05:04,220 --> 00:05:10,040
attribute<font color="#E5E5E5"> and guess what</font>

102
00:05:05,750 --> 00:05:12,740
it has those exact same time stamps<font color="#E5E5E5"> it</font>

103
00:05:10,040 --> 00:05:15,380
<font color="#E5E5E5">also will contain at least one data</font>

104
00:05:12,740 --> 00:05:18,380
attribute<font color="#E5E5E5"> so the data the actual</font>

105
00:05:15,380 --> 00:05:21,169
contents of the file and<font color="#E5E5E5"> ntfs are an</font>

106
00:05:18,380 --> 00:05:23,360
attribute as well and these attributes

107
00:05:21,169 --> 00:05:26,270
are stored in something called a master

108
00:05:23,360 --> 00:05:28,340
file table<font color="#E5E5E5"> so master file table is this</font>

109
00:05:26,270 --> 00:05:31,640
massive thing that's usually about in

110
00:05:28,340 --> 00:05:34,969
the middle of your partition and it

111
00:05:31,640 --> 00:05:41,180
contains entries that<font color="#CCCCCC"> describe every</font>

112
00:05:34,970 --> 00:05:43,250
file and directory on that system so

113
00:05:41,180 --> 00:05:44,960
directories are also collection of

114
00:05:43,250 --> 00:05:46,910
attributes

115
00:05:44,960 --> 00:05:50,719
it's kind<font color="#CCCCCC"> of like linux where everything</font>

116
00:05:46,910 --> 00:05:53,390
is a file<font color="#E5E5E5"> everything's</font><font color="#CCCCCC"> an mft entry and</font>

117
00:05:50,720 --> 00:05:55,160
these attributes are the same they have

118
00:05:53,390 --> 00:05:58,580
standard information they have<font color="#CCCCCC"> file</font>

119
00:05:55,160 --> 00:06:00,410
<font color="#CCCCCC">names they also have an interesting way</font>

120
00:05:58,580 --> 00:06:03,620
of storing the<font color="#CCCCCC"> directories themselves</font>

121
00:06:00,410 --> 00:06:06,080
they have this tree structure<font color="#CCCCCC"> have</font>

122
00:06:03,620 --> 00:06:08,720
something called an index<font color="#CCCCCC"> route</font><font color="#E5E5E5"> and if</font>

123
00:06:06,080 --> 00:06:11,810
they grow a little bit beyond<font color="#E5E5E5"> like</font><font color="#CCCCCC"> three</font>

124
00:06:08,720 --> 00:06:13,490
<font color="#CCCCCC">to five entries they have things called</font>

125
00:06:11,810 --> 00:06:16,490
<font color="#E5E5E5">index allocation</font>

126
00:06:13,490 --> 00:06:19,669
so index allocations are at this tree

127
00:06:16,490 --> 00:06:23,000
structure<font color="#E5E5E5"> stored out in clusters on the</font>

128
00:06:19,669 --> 00:06:26,539
desk<font color="#CCCCCC"> so these attributes are all stored</font>

129
00:06:23,000 --> 00:06:29,449
in the<font color="#CCCCCC"> mft</font><font color="#E5E5E5"> and guess what those</font>

130
00:06:26,539 --> 00:06:32,270
directory entries that are stored out in

131
00:06:29,449 --> 00:06:37,130
these index buffers and index

132
00:06:32,270 --> 00:06:39,380
allocations<font color="#E5E5E5"> also contain</font><font color="#CCCCCC"> macro times so</font>

133
00:06:37,130 --> 00:06:41,930
now you've got at least three different

134
00:06:39,380 --> 00:06:45,740
places that<font color="#E5E5E5"> you will have all these time</font>

135
00:06:41,930 --> 00:06:49,130
stands<font color="#CCCCCC"> so here's just a little</font>

136
00:06:45,740 --> 00:06:52,280
<font color="#E5E5E5">screenshot that shows you part of an</font><font color="#CCCCCC"> mft</font>

137
00:06:49,130 --> 00:06:56,539
entry<font color="#CCCCCC"> it's showing a dollar sign 90</font>

138
00:06:52,280 --> 00:07:00,080
attribute that is an index<font color="#CCCCCC"> route this is</font>

139
00:06:56,539 --> 00:07:02,389
actually for a root directory<font color="#E5E5E5"> and you</font>

140
00:07:00,080 --> 00:07:06,318
can see<font color="#E5E5E5"> there's a dollar sign a</font><font color="#CCCCCC"> zero</font>

141
00:07:02,389 --> 00:07:08,900
<font color="#E5E5E5">attribute which talks about some of</font>

142
00:07:06,319 --> 00:07:11,120
these index allocations those clusters

143
00:07:08,900 --> 00:07:14,448
that also<font color="#CCCCCC"> contained directory</font>

144
00:07:11,120 --> 00:07:17,690
information<font color="#CCCCCC"> by the way</font><font color="#E5E5E5"> this tool is</font>

145
00:07:14,449 --> 00:07:21,320
called<font color="#E5E5E5"> activate</font><font color="#CCCCCC"> disc editor it's a free</font>

146
00:07:17,690 --> 00:07:24,169
tool<font color="#CCCCCC"> if you go to disk dash</font><font color="#E5E5E5"> editor</font><font color="#CCCCCC"> .</font>

147
00:07:21,320 --> 00:07:28,280
<font color="#CCCCCC">ordered</font><font color="#E5E5E5"> you can download it for</font><font color="#CCCCCC"> windows</font>

148
00:07:24,169 --> 00:07:30,830
or<font color="#CCCCCC"> from linux</font><font color="#E5E5E5"> and like autopsy it's a</font>

149
00:07:28,280 --> 00:07:32,809
great value<font color="#E5E5E5"> right</font><font color="#CCCCCC"> free it does</font><font color="#E5E5E5"> have a</font>

150
00:07:30,830 --> 00:07:37,130
couple little quirks but overall it's

151
00:07:32,810 --> 00:07:39,469
pretty decent tool a little bit more

152
00:07:37,130 --> 00:07:43,159
about these<font color="#CCCCCC"> timestamps</font><font color="#E5E5E5"> so these</font>

153
00:07:39,469 --> 00:07:47,330
<font color="#E5E5E5">timestamps have a pretty good resolution</font>

154
00:07:43,159 --> 00:07:52,460
<font color="#CCCCCC">they are in hundreds of nanoseconds or .</font>

155
00:07:47,330 --> 00:07:56,210
<font color="#CCCCCC">won millions</font><font color="#E5E5E5"> of seconds and they store</font>

156
00:07:52,460 --> 00:07:59,299
the offset<font color="#E5E5E5"> since</font><font color="#CCCCCC"> january</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> 1600</font>

157
00:07:56,210 --> 00:08:02,180
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> kinda crazy you know if you</font>

158
00:07:59,300 --> 00:08:05,060
look at<font color="#CCCCCC"> linux timestamps</font><font color="#E5E5E5"> they have the</font>

159
00:08:02,180 --> 00:08:08,210
epoch of<font color="#CCCCCC"> january first nineteen seventy</font>

160
00:08:05,060 --> 00:08:11,210
<font color="#CCCCCC">if you</font><font color="#E5E5E5"> look at fat file systems they</font>

161
00:08:08,210 --> 00:08:14,150
have an epoch of<font color="#CCCCCC"> january first nineteen</font>

162
00:08:11,210 --> 00:08:16,909
<font color="#CCCCCC">eighty</font><font color="#E5E5E5"> so for ntfs they said hey let's</font>

163
00:08:14,150 --> 00:08:19,849
go back to<font color="#CCCCCC"> 1600 because we need file</font>

164
00:08:16,909 --> 00:08:22,190
<font color="#CCCCCC">timestamps they go back to 1600</font><font color="#E5E5E5"> right</font>

165
00:08:19,849 --> 00:08:22,979
because they had a lot of computers back

166
00:08:22,190 --> 00:08:26,280
then

167
00:08:22,980 --> 00:08:30,660
so<font color="#CCCCCC"> I don't know why they did it that way</font>

168
00:08:26,280 --> 00:08:35,459
but they did<font color="#CCCCCC"> 64 bit unsigned integers</font>

169
00:08:30,660 --> 00:08:38,430
and it's a lot better than the fact

170
00:08:35,460 --> 00:08:40,890
<font color="#E5E5E5">timestamps fat timestamps only had two</font>

171
00:08:38,429 --> 00:08:44,939
seconds of resolution<font color="#E5E5E5"> so we've gone from</font>

172
00:08:40,890 --> 00:08:48,480
two seconds to a tenth of a millionth of

173
00:08:44,940 --> 00:08:49,110
a second<font color="#CCCCCC"> of</font><font color="#E5E5E5"> course</font><font color="#CCCCCC"> linux by the way is</font>

174
00:08:48,480 --> 00:08:52,470
better

175
00:08:49,110 --> 00:08:54,030
<font color="#E5E5E5">linux goes to</font><font color="#CCCCCC"> 1 nanosecond</font><font color="#E5E5E5"> not hundreds</font>

176
00:08:52,470 --> 00:08:56,130
of<font color="#E5E5E5"> nanoseconds but you already knew</font>

177
00:08:54,030 --> 00:08:58,230
<font color="#CCCCCC">linux was better</font>

178
00:08:56,130 --> 00:09:01,170
the<font color="#E5E5E5"> other thing that's different with</font>

179
00:08:58,230 --> 00:09:04,050
fat for the access times it's not

180
00:09:01,170 --> 00:09:07,740
actually an access time it's a date

181
00:09:04,050 --> 00:09:11,010
there is no time for that field and

182
00:09:07,740 --> 00:09:13,650
there was no record<font color="#E5E5E5"> update time for fat</font>

183
00:09:11,010 --> 00:09:17,220
<font color="#CCCCCC">so that's something else that's new with</font>

184
00:09:13,650 --> 00:09:20,520
<font color="#CCCCCC">ntfs all</font><font color="#E5E5E5"> right so enough about ntfs</font>

185
00:09:17,220 --> 00:09:22,650
<font color="#E5E5E5">think that was about five minutes and</font>

186
00:09:20,520 --> 00:09:23,880
<font color="#E5E5E5">you know at least enough to get</font>

187
00:09:22,650 --> 00:09:29,250
something out<font color="#E5E5E5"> of the rest of this talk</font>

188
00:09:23,880 --> 00:09:30,570
<font color="#CCCCCC">so how can I build a timeline</font><font color="#E5E5E5"> very</font>

189
00:09:29,250 --> 00:09:32,640
easily

190
00:09:30,570 --> 00:09:34,980
the first thing<font color="#CCCCCC"> I want to do is</font><font color="#E5E5E5"> I want</font>

191
00:09:32,640 --> 00:09:39,540
to extract some time system information

192
00:09:34,980 --> 00:09:42,660
from a file system image<font color="#CCCCCC"> so if you any</font>

193
00:09:39,540 --> 00:09:44,819
forensics on a system<font color="#CCCCCC"> the first thing</font>

194
00:09:42,660 --> 00:09:47,850
you're going to do is make some sort of

195
00:09:44,820 --> 00:09:51,810
<font color="#CCCCCC">file system image using the</font><font color="#E5E5E5"> tool like DD</font>

196
00:09:47,850 --> 00:09:56,430
or something similar<font color="#E5E5E5"> and then you want</font>

197
00:09:51,810 --> 00:10:01,859
to analyze that<font color="#E5E5E5"> so to analyze this you</font>

198
00:09:56,430 --> 00:10:06,120
want to first extract that<font color="#CCCCCC"> mft</font><font color="#E5E5E5"> itself so</font>

199
00:10:01,860 --> 00:10:08,610
you can extract it as a file<font color="#E5E5E5"> and now you</font>

200
00:10:06,120 --> 00:10:12,780
have this file that you can<font color="#E5E5E5"> analyze and</font>

201
00:10:08,610 --> 00:10:14,610
this makes things a lot faster<font color="#E5E5E5"> so the</font>

202
00:10:12,780 --> 00:10:18,600
stuff<font color="#CCCCCC"> i'm going to discuss today is</font>

203
00:10:14,610 --> 00:10:22,230
actually some scripts from this book

204
00:10:18,600 --> 00:10:25,050
<font color="#E5E5E5">this</font><font color="#CCCCCC"> teeny-tiny three-pound 554 page</font>

205
00:10:22,230 --> 00:10:27,180
book now

206
00:10:25,050 --> 00:10:29,219
you don't have to buy the book<font color="#E5E5E5"> although</font>

207
00:10:27,180 --> 00:10:33,540
<font color="#E5E5E5">you're certainly welcome to buy the book</font>

208
00:10:29,220 --> 00:10:35,970
<font color="#CCCCCC">but all of the scripts that are in that</font>

209
00:10:33,540 --> 00:10:38,310
book and I believe it's something like

210
00:10:35,970 --> 00:10:42,180
nine thousand lines of<font color="#E5E5E5"> Python or maybe</font>

211
00:10:38,310 --> 00:10:45,000
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> 11 I</font><font color="#E5E5E5"> don't it's a lot</font><font color="#CCCCCC"> you can go to</font>

212
00:10:42,180 --> 00:10:47,609
<font color="#CCCCCC">Windows forensics book calm</font><font color="#E5E5E5"> and you can</font>

213
00:10:45,000 --> 00:10:49,050
download every bit of it for free<font color="#CCCCCC"> right</font>

214
00:10:47,610 --> 00:10:53,459
<font color="#E5E5E5">so you don't have to buy anything if you</font>

215
00:10:49,050 --> 00:10:55,890
don't want but you can use some of the

216
00:10:53,459 --> 00:10:58,829
scripts<font color="#CCCCCC"> i have their</font><font color="#E5E5E5"> that allow you to</font>

217
00:10:55,890 --> 00:11:02,459
extract any file based on its<font color="#CCCCCC"> mft</font><font color="#E5E5E5"> entry</font>

218
00:10:58,829 --> 00:11:07,199
number so you can use that to extract

219
00:11:02,459 --> 00:11:10,739
the<font color="#CCCCCC"> mft itself as a file which hopefully</font>

220
00:11:07,200 --> 00:11:15,000
some of you<font color="#CCCCCC"> AKA my students</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> past</font>

221
00:11:10,740 --> 00:11:17,190
students know is<font color="#E5E5E5"> empty entry</font><font color="#CCCCCC"> 0 right</font><font color="#E5E5E5"> so</font>

222
00:11:15,000 --> 00:11:20,430
this is helpful for speeding up some

223
00:11:17,190 --> 00:11:23,160
analysis also occasionally<font color="#E5E5E5"> that</font><font color="#CCCCCC"> mft</font>

224
00:11:20,430 --> 00:11:25,829
thing<font color="#E5E5E5"> they they try really hard not to</font>

225
00:11:23,160 --> 00:11:27,899
have it fragmented but it can happen and

226
00:11:25,829 --> 00:11:34,709
that makes your life easier to extract

227
00:11:27,899 --> 00:11:37,200
this and then you can also supply to the

228
00:11:34,709 --> 00:11:40,829
script<font color="#CCCCCC"> i'm going to talk about today</font><font color="#E5E5E5"> a</font>

229
00:11:37,200 --> 00:11:46,589
image file and the way that that works

230
00:11:40,829 --> 00:11:49,020
is if you give it an<font color="#CCCCCC"> mft file it will go</font>

231
00:11:46,589 --> 00:11:51,720
through every<font color="#E5E5E5"> mft entry and it's going</font>

232
00:11:49,020 --> 00:11:54,270
to pull out those time stamps from the

233
00:11:51,720 --> 00:11:57,540
standard<font color="#CCCCCC"> intro</font><font color="#E5E5E5"> attribute and from the</font>

234
00:11:54,270 --> 00:12:00,270
<font color="#E5E5E5">filename attributes</font><font color="#CCCCCC"> if you give me an</font>

235
00:11:57,540 --> 00:12:03,270
image file<font color="#E5E5E5"> i'm also go out</font><font color="#CCCCCC"> those data</font>

236
00:12:00,270 --> 00:12:05,160
clusters to those index allocations and

237
00:12:03,270 --> 00:12:08,670
<font color="#CCCCCC">i'm going to pull all those timestamps</font>

238
00:12:05,160 --> 00:12:11,490
<font color="#E5E5E5">out of the directories as well so now i</font>

239
00:12:08,670 --> 00:12:13,170
have three sources of information for

240
00:12:11,490 --> 00:12:19,630
every single file

241
00:12:13,170 --> 00:12:22,089
so how does<font color="#CCCCCC"> the script work</font>

242
00:12:19,630 --> 00:12:22,840
kind of a overview it's going to go

243
00:12:22,090 --> 00:12:26,920
through that

244
00:12:22,840 --> 00:12:28,930
<font color="#E5E5E5">mft</font><font color="#CCCCCC"> extract information and then it's</font>

245
00:12:26,920 --> 00:12:32,829
going to get those index allocations as

246
00:12:28,930 --> 00:12:36,699
well<font color="#CCCCCC"> so just to give</font><font color="#E5E5E5"> you an idea what it</font>

247
00:12:32,830 --> 00:12:39,220
looks like it's pretty basic

248
00:12:36,700 --> 00:12:44,680
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> this work great when</font><font color="#CCCCCC"> I tested</font><font color="#E5E5E5"> it</font>

249
00:12:39,220 --> 00:12:46,060
later<font color="#CCCCCC"> right you can get those later i'm</font>

250
00:12:44,680 --> 00:12:50,560
not<font color="#E5E5E5"> going to go through that script but</font>

251
00:12:46,060 --> 00:12:53,709
it's it's a pretty simple script

252
00:12:50,560 --> 00:12:56,650
actually mostly because<font color="#CCCCCC"> I also developed</font>

253
00:12:53,710 --> 00:13:01,780
<font color="#CCCCCC">python classes for all of the different</font>

254
00:12:56,650 --> 00:13:03,430
entities that are involved with<font color="#CCCCCC"> ntfs so</font>

255
00:13:01,780 --> 00:13:06,939
if<font color="#CCCCCC"> i run</font><font color="#E5E5E5"> this script</font>

256
00:13:03,430 --> 00:13:09,280
<font color="#CCCCCC">okay now okay like</font><font color="#E5E5E5"> five minutes later</font>

257
00:13:06,940 --> 00:13:13,030
<font color="#E5E5E5">suddenly this came up on my other screen</font>

258
00:13:09,280 --> 00:13:16,990
over here

259
00:13:13,030 --> 00:13:20,740
really

260
00:13:16,990 --> 00:13:23,470
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> it's a little</font><font color="#E5E5E5"> flaky</font><font color="#CCCCCC"> I</font>

261
00:13:20,740 --> 00:13:27,790
guess when you go to the<font color="#CCCCCC"> two schools</font><font color="#E5E5E5"> but</font>

262
00:13:23,470 --> 00:13:29,560
anyway so here<font color="#CCCCCC"> I'm just running on the</font>

263
00:13:27,790 --> 00:13:31,360
first line<font color="#CCCCCC"> i'm running this extract</font>

264
00:13:29,560 --> 00:13:35,349
script and the nice thing about<font color="#E5E5E5"> this</font>

265
00:13:31,360 --> 00:13:41,140
script<font color="#E5E5E5"> in</font><font color="#CCCCCC"> NT f as one of their advantage</font>

266
00:13:35,350 --> 00:13:44,230
<font color="#E5E5E5">forensically</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> fat is that</font><font color="#CCCCCC"> NT f as if</font>

267
00:13:41,140 --> 00:13:47,949
you delete a file<font color="#CCCCCC"> all it</font><font color="#E5E5E5"> does is change</font>

268
00:13:44,230 --> 00:13:51,460
one bit in the<font color="#CCCCCC"> mft entry there's a bit</font>

269
00:13:47,950 --> 00:13:53,830
that says this<font color="#E5E5E5"> entries in use and that</font>

270
00:13:51,460 --> 00:13:57,010
also goes to a bitmap and says hey these

271
00:13:53,830 --> 00:13:59,890
clusters are available now so<font color="#CCCCCC"> undulating</font>

272
00:13:57,010 --> 00:14:03,490
<font color="#E5E5E5">the file is super easy and so</font><font color="#CCCCCC"> I have a</font>

273
00:13:59,890 --> 00:14:06,340
script that lets me extract any file by

274
00:14:03,490 --> 00:14:08,320
<font color="#E5E5E5">its mft entry number and it doesn't</font>

275
00:14:06,340 --> 00:14:10,390
matter if that follows deleted or not

276
00:14:08,320 --> 00:14:14,680
<font color="#E5E5E5">you just pull it right out</font>

277
00:14:10,390 --> 00:14:22,270
so<font color="#CCCCCC"> I run that script and they get my mft</font>

278
00:14:14,680 --> 00:14:24,520
<font color="#E5E5E5">itself now normally that</font><font color="#CCCCCC"> mft</font><font color="#E5E5E5"> table the</font>

279
00:14:22,270 --> 00:14:28,990
whole thing is stored in a file called

280
00:14:24,520 --> 00:14:31,300
<font color="#CCCCCC">dollar sign mft in that course</font><font color="#E5E5E5"> wreaks</font>

281
00:14:28,990 --> 00:14:32,980
havoc on some of your<font color="#E5E5E5"> linux systems and</font>

282
00:14:31,300 --> 00:14:35,229
it just<font color="#E5E5E5"> makes your life difficult when</font>

283
00:14:32,980 --> 00:14:38,620
you have dollar signs<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your file name</font>

284
00:14:35,230 --> 00:14:43,360
so<font color="#CCCCCC"> i automatically rename it to dollar M</font>

285
00:14:38,620 --> 00:14:47,680
of<font color="#CCCCCC"> T so i</font><font color="#E5E5E5"> extracted</font><font color="#CCCCCC"> I give it an offset</font>

286
00:14:43,360 --> 00:14:51,220
to the start of my file system and say<font color="#CCCCCC"> I</font>

287
00:14:47,680 --> 00:14:53,620
<font color="#E5E5E5">want entry</font><font color="#CCCCCC"> 0 please</font><font color="#E5E5E5"> and you can see it</font>

288
00:14:51,220 --> 00:14:56,500
took<font color="#E5E5E5"> 1.3 seconds</font>

289
00:14:53,620 --> 00:14:59,350
<font color="#CCCCCC">alright so so</font><font color="#E5E5E5"> far I'm 1.3 seconds is</font>

290
00:14:56,500 --> 00:15:04,150
<font color="#CCCCCC">taking me so let's let's light</font><font color="#E5E5E5"> this up</font>

291
00:14:59,350 --> 00:15:08,440
<font color="#E5E5E5">later and then</font><font color="#CCCCCC"> I will call my script</font>

292
00:15:04,150 --> 00:15:11,800
<font color="#CCCCCC">that's going to get that mac</font><font color="#E5E5E5"> timestamps</font>

293
00:15:08,440 --> 00:15:16,360
<font color="#E5E5E5">get all that information and that took a</font>

294
00:15:11,800 --> 00:15:20,140
whopping<font color="#CCCCCC"> 10.8 seconds</font><font color="#E5E5E5"> so so far</font><font color="#CCCCCC"> i'm up</font>

295
00:15:16,360 --> 00:15:23,770
to like around<font color="#E5E5E5"> 12 seconds or so that it</font>

296
00:15:20,140 --> 00:15:27,760
took me to do this and I did<font color="#E5E5E5"> a quick WC</font>

297
00:15:23,770 --> 00:15:33,850
dash<font color="#CCCCCC"> L on that file and that file was</font>

298
00:15:27,760 --> 00:15:40,030
280 2364 entries and<font color="#CCCCCC"> i generate that in</font>

299
00:15:33,850 --> 00:15:45,250
a couple of seconds<font color="#E5E5E5"> so step</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> for this</font>

300
00:15:40,030 --> 00:15:50,079
process<font color="#CCCCCC"> I need to create a database so</font>

301
00:15:45,250 --> 00:15:52,270
if<font color="#CCCCCC"> I need</font><font color="#E5E5E5"> to install MS my sequel</font><font color="#CCCCCC"> it's</font>

302
00:15:50,080 --> 00:15:56,110
pretty easy on most<font color="#CCCCCC"> linux systems you</font>

303
00:15:52,270 --> 00:15:58,480
just say to<font color="#CCCCCC"> the app</font><font color="#E5E5E5"> kept my SQL</font><font color="#CCCCCC"> dash</font>

304
00:15:56,110 --> 00:15:59,540
server<font color="#CCCCCC"> and we'll install the</font><font color="#E5E5E5"> clients as</font>

305
00:15:58,480 --> 00:16:01,550
well

306
00:15:59,540 --> 00:16:05,360
and then<font color="#CCCCCC"> I need</font><font color="#E5E5E5"> to create a new database</font>

307
00:16:01,550 --> 00:16:08,089
<font color="#E5E5E5">and for that you can use my sequel admin</font>

308
00:16:05,360 --> 00:16:11,509
<font color="#E5E5E5">dash you and then you give it your</font>

309
00:16:08,089 --> 00:16:13,790
username<font color="#CCCCCC"> Dash</font><font color="#E5E5E5"> P which means please ask</font>

310
00:16:11,509 --> 00:16:17,269
me for a password and then the name of

311
00:16:13,790 --> 00:16:18,620
the database<font color="#E5E5E5"> you want to create and the</font>

312
00:16:17,269 --> 00:16:21,199
<font color="#E5E5E5">create table</font>

313
00:16:18,620 --> 00:16:24,470
I apologize that this is a little bit

314
00:16:21,199 --> 00:16:27,380
messy because it's all on one line in my

315
00:16:24,470 --> 00:16:32,540
slide again<font color="#E5E5E5"> all this stuff you can</font>

316
00:16:27,380 --> 00:16:36,110
download<font color="#E5E5E5"> off the website and you go</font>

317
00:16:32,540 --> 00:16:37,790
ahead and you do it<font color="#E5E5E5"> so here</font><font color="#CCCCCC"> I'm creating</font>

318
00:16:36,110 --> 00:16:40,279
my database

319
00:16:37,790 --> 00:16:46,459
<font color="#CCCCCC">ok another</font><font color="#E5E5E5"> three-second</font><font color="#CCCCCC"> some up</font><font color="#E5E5E5"> to like</font>

320
00:16:40,279 --> 00:16:49,040
what<font color="#E5E5E5"> 15 seconds</font><font color="#CCCCCC"> or so and</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> i'm</font>

321
00:16:46,459 --> 00:16:53,300
entering that sequel statement to create

322
00:16:49,040 --> 00:16:56,480
my table and it was .<font color="#E5E5E5"> 33 seconds so will</font>

323
00:16:53,300 --> 00:16:59,089
round out<font color="#E5E5E5"> 16 seconds so far so it's</font>

324
00:16:56,480 --> 00:17:02,600
<font color="#CCCCCC">taken forever just like autopsy right</font>

325
00:16:59,089 --> 00:17:06,620
<font color="#CCCCCC">all right so now let's do something</font>

326
00:17:02,600 --> 00:17:09,860
let's take this data so that the data is

327
00:17:06,619 --> 00:17:14,000
in a<font color="#E5E5E5"> CSV format</font><font color="#CCCCCC"> comma-separated value</font>

328
00:17:09,859 --> 00:17:20,899
<font color="#CCCCCC">format and that is very easily</font><font color="#E5E5E5"> loaded</font>

329
00:17:14,000 --> 00:17:22,490
into<font color="#E5E5E5"> mysql so I run this little query</font>

330
00:17:20,900 --> 00:17:24,890
here and<font color="#CCCCCC"> run the command</font><font color="#E5E5E5"> load data</font>

331
00:17:22,490 --> 00:17:27,890
<font color="#E5E5E5">infile and then</font><font color="#CCCCCC"> I give</font><font color="#E5E5E5"> it a file</font>

332
00:17:24,890 --> 00:17:32,780
location<font color="#CCCCCC"> now</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> I should warn you</font>

333
00:17:27,890 --> 00:17:37,549
about with the file location<font color="#E5E5E5"> by default</font>

334
00:17:32,780 --> 00:17:40,158
in most<font color="#CCCCCC"> linux systems there's a setting</font>

335
00:17:37,549 --> 00:17:44,418
that's enabled<font color="#CCCCCC"> that's a security</font><font color="#E5E5E5"> setting</font>

336
00:17:40,159 --> 00:17:48,440
that says hey you can't load files from

337
00:17:44,419 --> 00:17:50,900
any old place<font color="#E5E5E5"> into this database and</font>

338
00:17:48,440 --> 00:17:53,690
<font color="#E5E5E5">does that sound like a good idea like</font>

339
00:17:50,900 --> 00:17:56,960
someone compromises your<font color="#CCCCCC"> web server they</font>

340
00:17:53,690 --> 00:17:59,150
upload some files to your<font color="#E5E5E5"> web server</font>

341
00:17:56,960 --> 00:18:00,919
directories and then they suddenly

342
00:17:59,150 --> 00:18:02,570
import stuff into your database that's

343
00:18:00,919 --> 00:18:03,779
kind of a bad thing

344
00:18:02,570 --> 00:18:08,070
so

345
00:18:03,779 --> 00:18:11,009
the standard place<font color="#CCCCCC"> than in most</font><font color="#E5E5E5"> cases</font>

346
00:18:08,070 --> 00:18:14,549
you can install stuff from<font color="#CCCCCC"> his</font><font color="#E5E5E5"> VAR lib</font>

347
00:18:11,009 --> 00:18:17,039
mysql<font color="#E5E5E5"> dash files so you want to take</font>

348
00:18:14,549 --> 00:18:18,119
that<font color="#E5E5E5"> CSV file that you created</font><font color="#CCCCCC"> copied</font>

349
00:18:17,039 --> 00:18:22,169
<font color="#E5E5E5">over there</font>

350
00:18:18,119 --> 00:18:24,718
import it and all this does<font color="#E5E5E5"> it looks</font>

351
00:18:22,169 --> 00:18:32,129
kind of complicated<font color="#CCCCCC"> the real</font>

352
00:18:24,719 --> 00:18:34,950
complication comes in because of this

353
00:18:32,129 --> 00:18:37,949
<font color="#E5E5E5">here</font><font color="#CCCCCC"> the fact that</font><font color="#E5E5E5"> I have all these</font>

354
00:18:34,950 --> 00:18:40,649
dates and times is why I have these

355
00:18:37,950 --> 00:18:44,129
funny things where<font color="#CCCCCC"> I have at modified a</font>

356
00:18:40,649 --> 00:18:47,248
<font color="#E5E5E5">at</font><font color="#CCCCCC"> createdate</font><font color="#E5E5E5"> and then down here you can</font>

357
00:18:44,129 --> 00:18:50,549
see I'm using stir<font color="#E5E5E5"> to date and I'm</font>

358
00:18:47,249 --> 00:18:53,789
saying this is my date<font color="#CCCCCC"> and here's the</font>

359
00:18:50,549 --> 00:18:56,369
format i'm using because as you well

360
00:18:53,789 --> 00:18:58,469
know<font color="#E5E5E5"> there are many different date</font>

361
00:18:56,369 --> 00:19:01,830
formats here in the US we tend to do

362
00:18:58,469 --> 00:19:07,409
things like month day<font color="#E5E5E5"> your other people</font>

363
00:19:01,830 --> 00:19:11,668
tend to do<font color="#CCCCCC"> day month year and IT people</font>

364
00:19:07,409 --> 00:19:14,099
often like<font color="#E5E5E5"> year month day and it's a</font>

365
00:19:11,669 --> 00:19:15,659
little bit cleaner<font color="#E5E5E5"> when you do it like</font>

366
00:19:14,099 --> 00:19:18,869
that

367
00:19:15,659 --> 00:19:19,979
so this is<font color="#CCCCCC"> 6.4</font><font color="#E5E5E5"> just two seconds will</font>

368
00:19:18,869 --> 00:19:23,428
<font color="#E5E5E5">surround up</font>

369
00:19:19,979 --> 00:19:30,570
<font color="#CCCCCC">ok so we're like 23 seconds or so so far</font>

370
00:19:23,429 --> 00:19:36,929
<font color="#E5E5E5">so now we've loaded those 284,000</font>

371
00:19:30,570 --> 00:19:40,439
<font color="#E5E5E5">something</font><font color="#CCCCCC"> rose into this table and we</font>

372
00:19:36,929 --> 00:19:45,509
want to populate a table called<font color="#CCCCCC"> timeline</font>

373
00:19:40,440 --> 00:19:47,849
<font color="#E5E5E5">so the timeline table is basically a</font>

374
00:19:45,509 --> 00:19:51,960
<font color="#CCCCCC">cross-reference</font><font color="#E5E5E5"> table so if i go back</font>

375
00:19:47,849 --> 00:19:56,428
here a second<font color="#E5E5E5"> and I say well what is the</font>

376
00:19:51,960 --> 00:19:58,859
file table look like it has all that

377
00:19:56,429 --> 00:20:01,200
metadata<font color="#CCCCCC"> it has all my time stamps it</font>

378
00:19:58,859 --> 00:20:05,369
has things like file size<font color="#E5E5E5"> and filename</font>

379
00:20:01,200 --> 00:20:07,830
and<font color="#E5E5E5"> that's a nice proper table</font>

380
00:20:05,369 --> 00:20:10,550
it's even<font color="#CCCCCC"> got</font><font color="#E5E5E5"> a key</font><font color="#CCCCCC"> notice at the</font><font color="#E5E5E5"> bottom</font>

381
00:20:07,830 --> 00:20:16,760
<font color="#CCCCCC">it says primary key erect know</font>

382
00:20:10,550 --> 00:20:19,399
so it's got this integer<font color="#E5E5E5"> key and so</font><font color="#CCCCCC"> I</font>

383
00:20:16,760 --> 00:20:20,870
<font color="#E5E5E5">create another table</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> pretty</font>

384
00:20:19,400 --> 00:20:24,290
simple but this is what we call a

385
00:20:20,870 --> 00:20:28,820
<font color="#CCCCCC">cross-reference</font><font color="#E5E5E5"> table so it has some</font>

386
00:20:24,290 --> 00:20:30,920
values from the other table<font color="#E5E5E5"> but notice</font>

387
00:20:28,820 --> 00:20:33,290
it doesn't have any primary keys or

388
00:20:30,920 --> 00:20:36,050
anything<font color="#E5E5E5"> so it just says</font><font color="#CCCCCC"> all right what</font>

389
00:20:33,290 --> 00:20:39,260
was the operation was it modify access

390
00:20:36,050 --> 00:20:42,320
<font color="#E5E5E5">create a record change what was the</font>

391
00:20:39,260 --> 00:20:44,870
source to<font color="#E5E5E5"> come from standard info</font><font color="#CCCCCC"> did</font><font color="#E5E5E5"> it</font>

392
00:20:42,320 --> 00:20:50,030
<font color="#E5E5E5">come from a</font><font color="#CCCCCC"> file name or did</font><font color="#E5E5E5"> it come</font>

393
00:20:44,870 --> 00:20:53,419
from an index allocation<font color="#CCCCCC"> what's the date</font>

394
00:20:50,030 --> 00:20:55,460
what's<font color="#E5E5E5"> the time and what record in the</font>

395
00:20:53,420 --> 00:20:59,300
file table<font color="#CCCCCC"> does it refer to</font>

396
00:20:55,460 --> 00:21:03,350
so then<font color="#CCCCCC"> I run for queries one for each</font>

397
00:20:59,300 --> 00:21:06,740
of the matter<font color="#E5E5E5"> times that will insert</font>

398
00:21:03,350 --> 00:21:10,399
into this table based on the other table

399
00:21:06,740 --> 00:21:14,690
<font color="#E5E5E5">and each of these queries took</font><font color="#CCCCCC"> one of</font>

400
00:21:10,400 --> 00:21:19,220
<font color="#CCCCCC">them took</font><font color="#E5E5E5"> 4.6 seconds and the others</font>

401
00:21:14,690 --> 00:21:22,640
took three ish<font color="#E5E5E5"> ourselves seconds so</font><font color="#CCCCCC"> I'm</font>

402
00:21:19,220 --> 00:21:23,600
still under a minute here<font color="#E5E5E5"> and guess what</font>

403
00:21:22,640 --> 00:21:27,440
<font color="#E5E5E5">I'm done</font>

404
00:21:23,600 --> 00:21:30,649
alright so in terms of execution time in

405
00:21:27,440 --> 00:21:34,280
under three minutes<font color="#CCCCCC"> i</font><font color="#E5E5E5"> managed to do this</font>

406
00:21:30,650 --> 00:21:36,890
right<font color="#CCCCCC"> which i</font><font color="#E5E5E5"> think is pretty good so</font>

407
00:21:34,280 --> 00:21:40,190
now<font color="#CCCCCC"> i'm on to the fun part</font>

408
00:21:36,890 --> 00:21:42,500
what do<font color="#E5E5E5"> i do want to do now now</font><font color="#CCCCCC"> I want</font>

409
00:21:40,190 --> 00:21:44,810
to actually run queries<font color="#CCCCCC"> with queries</font>

410
00:21:42,500 --> 00:21:47,330
<font color="#CCCCCC">whatever you</font><font color="#E5E5E5"> want</font>

411
00:21:44,810 --> 00:21:49,490
so there are a couple of standard

412
00:21:47,330 --> 00:21:53,030
queries that you might want to do

413
00:21:49,490 --> 00:21:56,630
<font color="#E5E5E5">a standard query would be to look at</font>

414
00:21:53,030 --> 00:21:59,120
things sorted chronologically<font color="#E5E5E5"> another</font>

415
00:21:56,630 --> 00:22:02,059
standard thing would be to say<font color="#CCCCCC"> all right</font>

416
00:21:59,120 --> 00:22:05,000
let's look at a particular file<font color="#E5E5E5"> so this</font>

417
00:22:02,059 --> 00:22:08,120
file has<font color="#CCCCCC"> mft entry number</font>

418
00:22:05,000 --> 00:22:10,910
what<font color="#E5E5E5"> are all the references to that file</font>

419
00:22:08,120 --> 00:22:13,969
you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> are there multiple index</font>

420
00:22:10,910 --> 00:22:17,510
<font color="#E5E5E5">allocation references do they agree or</font>

421
00:22:13,970 --> 00:22:22,250
disagree you know what's the story with

422
00:22:17,510 --> 00:22:27,860
this thing<font color="#CCCCCC"> so if you have a large</font>

423
00:22:22,250 --> 00:22:30,830
<font color="#CCCCCC">resultset you can save it to a CSV file</font>

424
00:22:27,860 --> 00:22:32,990
and<font color="#E5E5E5"> then imported into LibreOffice calc</font>

425
00:22:30,830 --> 00:22:34,939
or something similar<font color="#CCCCCC"> some spreadsheet</font>

426
00:22:32,990 --> 00:22:40,730
program<font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> little bit easier to view</font>

427
00:22:34,940 --> 00:22:43,520
<font color="#E5E5E5">so let's make this a little easier</font>

428
00:22:40,730 --> 00:22:47,000
so here<font color="#CCCCCC"> i have a pretty simple script</font>

429
00:22:43,520 --> 00:22:49,910
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is a shell script now one thing I</font>

430
00:22:47,000 --> 00:22:53,420
will say about<font color="#E5E5E5"> scripts that I tend to</font>

431
00:22:49,910 --> 00:22:57,230
write<font color="#E5E5E5"> you might say Phil you know</font>

432
00:22:53,420 --> 00:23:00,830
yourself shell scripting sucks and<font color="#CCCCCC"> I</font>

433
00:22:57,230 --> 00:23:02,809
would<font color="#E5E5E5"> accept that ok but</font><font color="#CCCCCC"> i like</font><font color="#E5E5E5"> to write</font>

434
00:23:00,830 --> 00:23:05,809
<font color="#CCCCCC">shell scripts that are very</font>

435
00:23:02,809 --> 00:23:08,270
straightforward and easy to understand

436
00:23:05,809 --> 00:23:12,020
so it is<font color="#E5E5E5"> true that</font><font color="#CCCCCC"> I could make this</font>

437
00:23:08,270 --> 00:23:14,420
<font color="#E5E5E5">trip shorter but</font><font color="#CCCCCC"> I don't want to write</font>

438
00:23:12,020 --> 00:23:18,020
<font color="#E5E5E5">so on the left side</font>

439
00:23:14,420 --> 00:23:20,690
<font color="#CCCCCC">I've</font><font color="#E5E5E5"> got your standard shebang bin bash</font>

440
00:23:18,020 --> 00:23:23,120
<font color="#CCCCCC">that just says hey this is a bash script</font>

441
00:23:20,690 --> 00:23:28,250
<font color="#E5E5E5">please pass it to the bash shell</font>

442
00:23:23,120 --> 00:23:30,020
interpreter and here's a usage<font color="#E5E5E5"> function</font>

443
00:23:28,250 --> 00:23:31,880
<font color="#CCCCCC">that i define so if you don't give me</font>

444
00:23:30,020 --> 00:23:35,570
enough parameters<font color="#CCCCCC"> I yell at you and I</font>

445
00:23:31,880 --> 00:23:37,370
say I wanted a database name and<font color="#E5E5E5"> the</font>

446
00:23:35,570 --> 00:23:42,530
starting date and an ending date

447
00:23:37,370 --> 00:23:44,929
which is optional and the bottom part

448
00:23:42,530 --> 00:23:47,030
says did you give me not enough things

449
00:23:44,930 --> 00:23:50,150
<font color="#E5E5E5">if you didn't then</font><font color="#CCCCCC"> i'm going</font><font color="#E5E5E5"> to call the</font>

450
00:23:47,030 --> 00:23:52,250
usage<font color="#CCCCCC"> otherwise you go to the right</font>

451
00:23:50,150 --> 00:23:55,550
column this is the real deal<font color="#E5E5E5"> where</font>

452
00:23:52,250 --> 00:23:59,090
actual things happen<font color="#CCCCCC"> so the</font><font color="#E5E5E5"> first part</font>

453
00:23:55,550 --> 00:24:03,500
<font color="#E5E5E5">says if you gave me less than three</font>

454
00:23:59,090 --> 00:24:07,610
things then run this<font color="#CCCCCC"> now all i'm doing</font>

455
00:24:03,500 --> 00:24:12,320
here is i'm going to pipe<font color="#CCCCCC"> this part</font>

456
00:24:07,610 --> 00:24:17,959
where it says select<font color="#E5E5E5"> operation etc</font><font color="#CCCCCC"> I'm</font>

457
00:24:12,320 --> 00:24:20,689
<font color="#CCCCCC">gonna pipe that to</font><font color="#E5E5E5"> mysql so</font><font color="#CCCCCC"> i don't know</font>

458
00:24:17,960 --> 00:24:23,720
how<font color="#CCCCCC"> many of you do any linux shell</font>

459
00:24:20,690 --> 00:24:26,450
scripting<font color="#E5E5E5"> couple of you</font>

460
00:24:23,720 --> 00:24:29,000
so this is a little trick that you can

461
00:24:26,450 --> 00:24:31,070
do you can use cat and then less than

462
00:24:29,000 --> 00:24:34,580
less than<font color="#CCCCCC"> and then some sort of token</font>

463
00:24:31,070 --> 00:24:36,678
<font color="#E5E5E5">and basically what happens is it will</font>

464
00:24:34,580 --> 00:24:39,439
take all<font color="#E5E5E5"> the text that follows on the</font>

465
00:24:36,679 --> 00:24:41,540
following lines until it hits that token

466
00:24:39,440 --> 00:24:44,270
which typically people use things like

467
00:24:41,540 --> 00:24:47,450
<font color="#CCCCCC">cof</font><font color="#E5E5E5"> which you can see down there after a</font>

468
00:24:44,270 --> 00:24:51,500
couple lines and then that command is

469
00:24:47,450 --> 00:24:54,830
run<font color="#E5E5E5"> all that stuff is sent to mysql so</font>

470
00:24:51,500 --> 00:25:01,070
this is just a standard query that says

471
00:24:54,830 --> 00:25:03,080
<font color="#CCCCCC">okay I</font><font color="#E5E5E5"> want to look at this</font><font color="#CCCCCC"> timeline</font><font color="#E5E5E5"> and</font>

472
00:25:01,070 --> 00:25:07,100
<font color="#E5E5E5">I want to look for dates after a certain</font>

473
00:25:03,080 --> 00:25:11,240
date and then there's an<font color="#CCCCCC"> else clause and</font>

474
00:25:07,100 --> 00:25:14,659
<font color="#E5E5E5">it says alright if I got to the else</font>

475
00:25:11,240 --> 00:25:17,390
<font color="#E5E5E5">clause</font><font color="#CCCCCC"> it's because you gave me</font><font color="#E5E5E5"> an</font>

476
00:25:14,660 --> 00:25:19,520
ending date as well<font color="#E5E5E5"> so it's a very</font>

477
00:25:17,390 --> 00:25:21,950
similar query but if you look at the

478
00:25:19,520 --> 00:25:26,240
where<font color="#CCCCCC"> clause you'll notice that there's</font>

479
00:25:21,950 --> 00:25:29,210
another criteria it says<font color="#E5E5E5"> and time like</font>

480
00:25:26,240 --> 00:25:33,410
date started a dollar sign<font color="#CCCCCC"> three the</font>

481
00:25:29,210 --> 00:25:36,440
last thing you passed in<font color="#E5E5E5"> is less than</font>

482
00:25:33,410 --> 00:25:38,600
this date<font color="#E5E5E5"> right so that's all that's</font>

483
00:25:36,440 --> 00:25:41,170
going on here<font color="#CCCCCC"> it's nothing</font><font color="#E5E5E5"> terribly</font>

484
00:25:38,600 --> 00:25:45,159
spectacular

485
00:25:41,170 --> 00:25:48,340
so now<font color="#CCCCCC"> i can run this i just did an</font>

486
00:25:45,160 --> 00:25:55,540
example on the same 26 gigabyte image

487
00:25:48,340 --> 00:26:00,340
<font color="#E5E5E5">and</font><font color="#CCCCCC"> I said okay what happened</font><font color="#E5E5E5"> from 2015</font>

488
00:25:55,540 --> 00:26:05,920
12 12 12<font color="#CCCCCC"> for and it gave me result</font><font color="#E5E5E5"> 2.6</font>

489
00:26:00,340 --> 00:26:07,990
seconds<font color="#E5E5E5"> right now let's go back to</font>

490
00:26:05,920 --> 00:26:12,370
autopsy for a second let's just say i

491
00:26:07,990 --> 00:26:14,260
was using autopsy<font color="#CCCCCC"> I'd still be running</font>

492
00:26:12,370 --> 00:26:16,719
this a long time right

493
00:26:14,260 --> 00:26:19,180
<font color="#CCCCCC">where were well under</font><font color="#E5E5E5"> two minutes here</font>

494
00:26:16,720 --> 00:26:21,310
<font color="#E5E5E5">of total execution time he might say</font>

495
00:26:19,180 --> 00:26:24,580
yeah but<font color="#CCCCCC"> that's execution time</font>

496
00:26:21,310 --> 00:26:30,460
<font color="#CCCCCC">ok you</font><font color="#E5E5E5"> could like listen to this talk</font>

497
00:26:24,580 --> 00:26:32,740
even<font color="#E5E5E5"> and download all these scripts and</font>

498
00:26:30,460 --> 00:26:33,880
run them and you still come out ahead

499
00:26:32,740 --> 00:26:37,090
autopsy

500
00:26:33,880 --> 00:26:39,970
remember<font color="#CCCCCC"> I said</font><font color="#E5E5E5"> five hours later autopsy</font>

501
00:26:37,090 --> 00:26:48,850
<font color="#E5E5E5">still wasn't done with the you know</font>

502
00:26:39,970 --> 00:26:52,960
<font color="#E5E5E5">initial</font><font color="#CCCCCC"> in just</font><font color="#E5E5E5"> of this image</font><font color="#CCCCCC"> to from</font>

503
00:26:48,850 --> 00:26:56,199
<font color="#E5E5E5">here you could optionally import this</font>

504
00:26:52,960 --> 00:26:58,540
information into calc or something

505
00:26:56,200 --> 00:27:01,330
similar<font color="#E5E5E5"> and</font><font color="#CCCCCC"> i just</font><font color="#E5E5E5"> wanted to point out</font>

506
00:26:58,540 --> 00:27:04,030
one thing that's really important when

507
00:27:01,330 --> 00:27:08,770
you import a<font color="#CCCCCC"> csv file and by the way</font>

508
00:27:04,030 --> 00:27:12,940
<font color="#E5E5E5">when you do a query in</font><font color="#CCCCCC"> mysql</font><font color="#E5E5E5"> by default</font>

509
00:27:08,770 --> 00:27:15,820
it's going<font color="#E5E5E5"> to tab separate your data</font>

510
00:27:12,940 --> 00:27:17,920
<font color="#E5E5E5">that's output</font><font color="#CCCCCC"> so make sure that</font><font color="#E5E5E5"> you've</font>

511
00:27:15,820 --> 00:27:20,560
checked the little box that says

512
00:27:17,920 --> 00:27:24,670
separator tab<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> one of your options</font>

513
00:27:20,560 --> 00:27:28,240
that's number one and number two for

514
00:27:24,670 --> 00:27:31,780
most fields<font color="#CCCCCC"> it's going to figure it out</font>

515
00:27:28,240 --> 00:27:33,790
but<font color="#E5E5E5"> for dates it can't because again</font>

516
00:27:31,780 --> 00:27:36,790
there are so many different formats that

517
00:27:33,790 --> 00:27:40,270
people use for dates<font color="#E5E5E5"> so for each of</font>

518
00:27:36,790 --> 00:27:41,830
those columns<font color="#CCCCCC"> you should go</font><font color="#E5E5E5"> and down at</font>

519
00:27:40,270 --> 00:27:44,980
the bottom where it says fields column

520
00:27:41,830 --> 00:27:48,399
type instead of standard<font color="#CCCCCC"> you need to say</font>

521
00:27:44,980 --> 00:27:51,100
<font color="#CCCCCC">date and then</font><font color="#E5E5E5"> give it the format for the</font>

522
00:27:48,400 --> 00:27:52,110
dates that you use when you ran the

523
00:27:51,100 --> 00:27:57,090
script

524
00:27:52,110 --> 00:27:59,159
and then it will show up<font color="#CCCCCC"> and</font><font color="#E5E5E5"> well this</font>

525
00:27:57,090 --> 00:28:00,899
<font color="#E5E5E5">looks better in my screen then</font><font color="#CCCCCC"> it does</font>

526
00:27:59,160 --> 00:28:03,090
<font color="#E5E5E5">projected because their resolution</font>

527
00:28:00,900 --> 00:28:07,530
changes but you'll see something<font color="#CCCCCC"> kinda</font>

528
00:28:03,090 --> 00:28:09,299
like<font color="#E5E5E5"> this</font><font color="#CCCCCC"> so that's one common way of</font>

529
00:28:07,530 --> 00:28:12,600
looking at this data

530
00:28:09,299 --> 00:28:16,080
another common<font color="#E5E5E5"> way is to look at it on a</font>

531
00:28:12,600 --> 00:28:19,830
file by file<font color="#E5E5E5"> basis</font><font color="#CCCCCC"> so here i have</font>

532
00:28:16,080 --> 00:28:22,678
another script<font color="#E5E5E5"> very similar on the</font><font color="#CCCCCC"> Left</font>

533
00:28:19,830 --> 00:28:25,918
<font color="#E5E5E5">that's just setting it up giving you a</font>

534
00:28:22,679 --> 00:28:28,110
usage statement in a<font color="#E5E5E5"> min right</font><font color="#CCCCCC"> i have a</font>

535
00:28:25,919 --> 00:28:30,210
slightly different query where<font color="#E5E5E5"> it's</font>

536
00:28:28,110 --> 00:28:39,209
going to sort things in order it by the

537
00:28:30,210 --> 00:28:41,549
<font color="#CCCCCC">mft entry</font><font color="#E5E5E5"> instead of dates and this is</font>

538
00:28:39,210 --> 00:28:45,900
what that looks like<font color="#CCCCCC"> so you can run it</font>

539
00:28:41,549 --> 00:28:48,059
for all of the entries or you can run it

540
00:28:45,900 --> 00:28:51,960
for<font color="#E5E5E5"> particular entry in this case</font><font color="#CCCCCC"> I just</font>

541
00:28:48,059 --> 00:28:54,418
ran it for particular<font color="#CCCCCC"> her entry mostly</font>

542
00:28:51,960 --> 00:28:56,580
<font color="#E5E5E5">because it all fit on one screen so</font><font color="#CCCCCC"> i</font>

543
00:28:54,419 --> 00:28:59,370
<font color="#E5E5E5">could do a screenshot and it was a</font>

544
00:28:56,580 --> 00:29:02,460
whopping four and a half seconds to get

545
00:28:59,370 --> 00:29:05,189
that information so here<font color="#CCCCCC"> now you</font><font color="#E5E5E5"> can see</font>

546
00:29:02,460 --> 00:29:09,540
<font color="#CCCCCC">i have a bunch of modification</font>

547
00:29:05,190 --> 00:29:12,270
operations for<font color="#E5E5E5"> index buffers</font><font color="#CCCCCC"> index</font>

548
00:29:09,540 --> 00:29:15,540
buffers<font color="#CCCCCC"> standard info file name</font><font color="#E5E5E5"> filename</font>

549
00:29:12,270 --> 00:29:20,340
and then<font color="#CCCCCC"> i have</font><font color="#E5E5E5"> a bunch of access</font>

550
00:29:15,540 --> 00:29:25,168
<font color="#E5E5E5">updates and</font><font color="#CCCCCC"> a couple index buffers there</font>

551
00:29:20,340 --> 00:29:28,620
<font color="#E5E5E5">to file names and standard info right</font>

552
00:29:25,169 --> 00:29:32,549
<font color="#E5E5E5">and some of these dates don't line up</font>

553
00:29:28,620 --> 00:29:35,489
<font color="#CCCCCC">some of them are slightly different</font><font color="#E5E5E5"> so</font>

554
00:29:32,549 --> 00:29:36,929
that brings you<font color="#CCCCCC"> to the question is is</font>

555
00:29:35,490 --> 00:29:40,140
this right or not

556
00:29:36,929 --> 00:29:42,630
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so since all these dates aren't</font>

557
00:29:40,140 --> 00:29:43,710
the same<font color="#CCCCCC"> you might think that there's a</font>

558
00:29:42,630 --> 00:29:46,290
problem

559
00:29:43,710 --> 00:29:48,960
so the next<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> talk about a</font>

560
00:29:46,290 --> 00:29:52,649
little bit is trying to understand these

561
00:29:48,960 --> 00:29:55,919
<font color="#CCCCCC">timestamps</font><font color="#E5E5E5"> so first a disclaimer</font>

562
00:29:52,650 --> 00:29:59,460
<font color="#CCCCCC">microsoft can't seem to decide what to</font>

563
00:29:55,919 --> 00:30:02,240
do with timestamps<font color="#CCCCCC"> this is true not just</font>

564
00:29:59,460 --> 00:30:05,420
with<font color="#CCCCCC"> ntfs</font><font color="#E5E5E5"> but also with fat</font>

565
00:30:02,240 --> 00:30:07,820
and it seems like the rules<font color="#CCCCCC"> change</font><font color="#E5E5E5"> a</font>

566
00:30:05,420 --> 00:30:10,580
little bit<font color="#E5E5E5"> from one version of</font><font color="#CCCCCC"> windows</font>

567
00:30:07,820 --> 00:30:13,820
to another<font color="#E5E5E5"> and this is likely to</font>

568
00:30:10,580 --> 00:30:18,770
continue happening<font color="#CCCCCC"> so what I'm going to</font>

569
00:30:13,820 --> 00:30:21,290
say right now is true today<font color="#CCCCCC"> right four</font>

570
00:30:18,770 --> 00:30:24,470
versions<font color="#CCCCCC"> of windows</font><font color="#E5E5E5"> today</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is how</font>

571
00:30:21,290 --> 00:30:26,659
they were<font color="#CCCCCC"> now if you go to microsoft's</font>

572
00:30:24,470 --> 00:30:29,900
website<font color="#E5E5E5"> and if you start asking</font>

573
00:30:26,660 --> 00:30:32,030
questions like what happens if i take

574
00:30:29,900 --> 00:30:34,640
something from<font color="#E5E5E5"> a fat file system and</font><font color="#CCCCCC"> I</font>

575
00:30:32,030 --> 00:30:36,350
move it<font color="#E5E5E5"> to an empty</font><font color="#CCCCCC"> FS file system or</font>

576
00:30:34,640 --> 00:30:40,340
the other way around

577
00:30:36,350 --> 00:30:41,330
that's even more complicated<font color="#CCCCCC"> so you can</font>

578
00:30:40,340 --> 00:30:42,830
google it

579
00:30:41,330 --> 00:30:46,428
<font color="#E5E5E5">they have a really nice</font><font color="#CCCCCC"> knowledgebase</font>

580
00:30:42,830 --> 00:30:48,620
article on this very thing that would

581
00:30:46,429 --> 00:30:51,620
encourage you to look at but for today

582
00:30:48,620 --> 00:30:54,139
we're going to keep it simple<font color="#E5E5E5"> and we're</font>

583
00:30:51,620 --> 00:30:56,629
<font color="#E5E5E5">going to talk about what happens to</font>

584
00:30:54,140 --> 00:30:59,510
these different fields<font color="#E5E5E5"> when you do</font>

585
00:30:56,630 --> 00:31:03,440
things like<font color="#E5E5E5"> copy a file</font><font color="#CCCCCC"> so when you copy</font>

586
00:30:59,510 --> 00:31:08,330
<font color="#E5E5E5">a file everything gets changed except</font>

587
00:31:03,440 --> 00:31:11,179
for in the standard<font color="#E5E5E5"> info attribute the</font>

588
00:31:08,330 --> 00:31:15,139
modification<font color="#E5E5E5"> timestamp does not change</font>

589
00:31:11,179 --> 00:31:19,010
everything else changes<font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is on</font>

590
00:31:15,140 --> 00:31:25,040
ntfs<font color="#E5E5E5"> modern windows when you copy</font><font color="#CCCCCC"> of</font>

591
00:31:19,010 --> 00:31:30,140
<font color="#CCCCCC">vile what</font><font color="#E5E5E5"> about when you access</font><font color="#CCCCCC"> a file</font>

592
00:31:25,040 --> 00:31:36,350
nothing changes<font color="#E5E5E5"> except for the access</font>

593
00:31:30,140 --> 00:31:38,900
time in standard info<font color="#E5E5E5"> but that's only</font>

594
00:31:36,350 --> 00:31:41,030
true if you're running an old version of

595
00:31:38,900 --> 00:31:45,230
<font color="#CCCCCC">windows</font><font color="#E5E5E5"> something that's older than</font>

596
00:31:41,030 --> 00:31:48,980
vista<font color="#E5E5E5"> so many do any kind of forensics</font>

597
00:31:45,230 --> 00:31:52,490
in<font color="#CCCCCC"> Windows what you find is that there's</font>

598
00:31:48,980 --> 00:31:55,220
like new windows new<font color="#E5E5E5"> windows is vista</font><font color="#CCCCCC"> in</font>

599
00:31:52,490 --> 00:31:59,720
newer and then there's old windows<font color="#E5E5E5"> like</font>

600
00:31:55,220 --> 00:32:02,540
XP and older<font color="#E5E5E5"> sometimes you get like a</font>

601
00:31:59,720 --> 00:32:05,929
really old stuff<font color="#E5E5E5"> where occasionally</font><font color="#CCCCCC"> like</font>

602
00:32:02,540 --> 00:32:08,000
<font color="#E5E5E5">hey</font><font color="#CCCCCC"> its windows 95 I'll</font><font color="#E5E5E5"> imagine that</font>

603
00:32:05,929 --> 00:32:11,570
<font color="#E5E5E5">somebody still running that stuff but</font>

604
00:32:08,000 --> 00:32:15,679
something that<font color="#E5E5E5"> I get asked quite a bit</font>

605
00:32:11,570 --> 00:32:17,389
is<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so you know talk about</font>

606
00:32:15,679 --> 00:32:22,400
<font color="#E5E5E5">filesystem forensics and some of this</font>

607
00:32:17,390 --> 00:32:24,500
stuff<font color="#E5E5E5"> does that cover</font><font color="#CCCCCC"> Windows 10 now</font><font color="#E5E5E5"> it</font>

608
00:32:22,400 --> 00:32:29,000
looks<font color="#E5E5E5"> really different</font><font color="#CCCCCC"> if you look</font><font color="#E5E5E5"> at</font>

609
00:32:24,500 --> 00:32:32,270
<font color="#E5E5E5">Windows 10</font><font color="#CCCCCC"> vs</font><font color="#E5E5E5"> windows</font><font color="#CCCCCC"> seven it looks</font>

610
00:32:29,000 --> 00:32:34,520
rather different when you look at it

611
00:32:32,270 --> 00:32:36,500
forensic<font color="#E5E5E5"> Lee</font><font color="#CCCCCC"> there's almost no</font>

612
00:32:34,520 --> 00:32:39,110
difference<font color="#E5E5E5"> right</font>

613
00:32:36,500 --> 00:32:41,059
<font color="#CCCCCC">Windows 10 from a forensics perspective</font>

614
00:32:39,110 --> 00:32:44,209
is almost the same thing as<font color="#CCCCCC"> windows</font>

615
00:32:41,059 --> 00:32:47,600
<font color="#CCCCCC">seven it's just the external the user</font>

616
00:32:44,210 --> 00:32:50,570
interface<font color="#CCCCCC"> that changed a lot</font><font color="#E5E5E5"> between</font><font color="#CCCCCC"> his</font>

617
00:32:47,600 --> 00:32:51,860
two different versions of<font color="#E5E5E5"> Windows you</font>

618
00:32:50,570 --> 00:32:54,350
know if you look at things like the

619
00:32:51,860 --> 00:32:58,040
registry and what's in the registry<font color="#CCCCCC"> it's</font>

620
00:32:54,350 --> 00:33:03,770
all pretty much the same between seven

621
00:32:58,040 --> 00:33:08,570
and<font color="#E5E5E5"> ten so interestingly enough you</font>

622
00:33:03,770 --> 00:33:11,179
access<font color="#E5E5E5"> a file and it doesn't change the</font>

623
00:33:08,570 --> 00:33:13,820
access times it doesn't that seem kind

624
00:33:11,179 --> 00:33:15,530
of counterintuitive<font color="#CCCCCC"> I access the file</font>

625
00:33:13,820 --> 00:33:18,139
<font color="#CCCCCC">why didn't you change my access times</font>

626
00:33:15,530 --> 00:33:20,240
<font color="#CCCCCC">damn well it turns out that the only</font>

627
00:33:18,140 --> 00:33:22,580
place that changes<font color="#E5E5E5"> in the directory</font>

628
00:33:20,240 --> 00:33:30,770
entry<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is what happens in the</font>

629
00:33:22,580 --> 00:33:38,178
empty<font color="#CCCCCC"> nester I didn't quite hear that</font>

630
00:33:30,770 --> 00:33:40,040
yes<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to get to that</font>

631
00:33:38,179 --> 00:33:41,780
so the question<font color="#CCCCCC"> is is there a setting</font>

632
00:33:40,040 --> 00:33:46,340
that you can use to force it to update

633
00:33:41,780 --> 00:33:49,850
the access time<font color="#CCCCCC"> so it</font><font color="#E5E5E5"> turns out in</font>

634
00:33:46,340 --> 00:33:51,470
<font color="#CCCCCC">windows if you have an NTFS file system</font>

635
00:33:49,850 --> 00:33:52,280
which is what we're talking about today

636
00:33:51,470 --> 00:33:53,990
<font color="#CCCCCC">or did</font>

637
00:33:52,280 --> 00:33:56,780
<font color="#CCCCCC">we're not</font><font color="#E5E5E5"> talking about fat at all and</font>

638
00:33:53,990 --> 00:33:59,929
the reason for that again<font color="#CCCCCC"> you can't use</font>

639
00:33:56,780 --> 00:34:02,720
fat for your primary<font color="#E5E5E5"> file system on a</font>

640
00:33:59,929 --> 00:34:05,600
modern version<font color="#E5E5E5"> windows there is a</font>

641
00:34:02,720 --> 00:34:11,418
registry setting called<font color="#CCCCCC"> ntfs disabled</font>

642
00:34:05,600 --> 00:34:13,279
last access<font color="#E5E5E5"> update</font><font color="#CCCCCC"> right so flash</font><font color="#E5E5E5"> back</font>

643
00:34:11,418 --> 00:34:16,609
for<font color="#CCCCCC"> a second couple minutes ago we were</font>

644
00:34:13,280 --> 00:34:19,700
talking about<font color="#CCCCCC"> time stamps we said</font><font color="#E5E5E5"> for</font>

645
00:34:16,609 --> 00:34:21,600
<font color="#E5E5E5">ntfs you have hundreds of nanoseconds</font>

646
00:34:19,699 --> 00:34:26,609
and

647
00:34:21,600 --> 00:34:33,299
a<font color="#E5E5E5"> fat you had an access date and no time</font>

648
00:34:26,610 --> 00:34:36,390
<font color="#E5E5E5">and you had to second resolution so it's</font>

649
00:34:33,300 --> 00:34:36,960
kind of like<font color="#CCCCCC"> Microsoft</font><font color="#E5E5E5"> give us all a</font>

650
00:34:36,389 --> 00:34:40,109
sudden

651
00:34:36,960 --> 00:34:44,550
hey let's give you<font color="#CCCCCC"> an access time and</font>

652
00:34:40,110 --> 00:34:45,660
then<font color="#E5E5E5"> who performance</font><font color="#CCCCCC"> socks and they took</font>

653
00:34:44,550 --> 00:34:46,980
it away

654
00:34:45,659 --> 00:34:49,920
<font color="#CCCCCC">alright so they came up with this</font>

655
00:34:46,980 --> 00:34:52,199
registry key<font color="#CCCCCC"> ntfs to save the last</font>

656
00:34:49,920 --> 00:34:54,120
<font color="#E5E5E5">access update is what it is</font>

657
00:34:52,199 --> 00:34:58,859
<font color="#E5E5E5">so if you create this key</font><font color="#CCCCCC"> you set the</font>

658
00:34:54,120 --> 00:35:02,250
value to 1 it will disable<font color="#E5E5E5"> updating of</font>

659
00:34:58,860 --> 00:35:05,130
those<font color="#CCCCCC"> access</font><font color="#E5E5E5"> timestamps in certain</font>

660
00:35:02,250 --> 00:35:07,950
conditions such as if<font color="#CCCCCC"> i go to a</font>

661
00:35:05,130 --> 00:35:10,080
directory<font color="#E5E5E5"> either with my file browser</font><font color="#CCCCCC"> on</font>

662
00:35:07,950 --> 00:35:12,600
<font color="#E5E5E5">the command line</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not going to</font>

663
00:35:10,080 --> 00:35:17,160
update the access<font color="#CCCCCC"> times so I don't</font><font color="#E5E5E5"> have</font>

664
00:35:12,600 --> 00:35:20,520
an easy way of saying hey somebody some

665
00:35:17,160 --> 00:35:23,339
hacker or somebody else<font color="#CCCCCC"> went into this</font>

666
00:35:20,520 --> 00:35:26,310
<font color="#CCCCCC">directory and did stop unless they</font>

667
00:35:23,340 --> 00:35:27,330
actually modify things with the files in

668
00:35:26,310 --> 00:35:31,650
that directory

669
00:35:27,330 --> 00:35:34,230
<font color="#CCCCCC">I won't be</font><font color="#E5E5E5"> able to tell where now if you</font>

670
00:35:31,650 --> 00:35:39,630
go to<font color="#CCCCCC"> microsoft's website they will</font>

671
00:35:34,230 --> 00:35:43,110
recommend that you disable those updates

672
00:35:39,630 --> 00:35:45,330
<font color="#E5E5E5">if your performance is poor</font>

673
00:35:43,110 --> 00:35:49,800
have you ever seen a well running

674
00:35:45,330 --> 00:35:52,680
<font color="#CCCCCC">optimized window system</font><font color="#E5E5E5"> have you've seen</font>

675
00:35:49,800 --> 00:35:56,910
anybody<font color="#E5E5E5"> anyone in here ever thought my</font>

676
00:35:52,680 --> 00:35:59,069
window system is so freaking fast that I

677
00:35:56,910 --> 00:36:01,410
couldn't possibly do better

678
00:35:59,070 --> 00:36:06,210
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> that doesn't happen</font><font color="#CCCCCC"> so by default</font>

679
00:36:01,410 --> 00:36:08,910
<font color="#CCCCCC">today that thing is enabled so</font><font color="#E5E5E5"> ntfs</font>

680
00:36:06,210 --> 00:36:12,090
<font color="#E5E5E5">disabled access update if you look in</font>

681
00:36:08,910 --> 00:36:15,899
your registry<font color="#CCCCCC"> you will</font><font color="#E5E5E5"> find that key is</font>

682
00:36:12,090 --> 00:36:19,320
enabled<font color="#E5E5E5"> set to one almost all the time</font>

683
00:36:15,900 --> 00:36:24,780
today<font color="#CCCCCC"> it's good</font><font color="#E5E5E5"> question</font>

684
00:36:19,320 --> 00:36:26,280
so<font color="#CCCCCC"> that's accessing the file so what if</font>

685
00:36:24,780 --> 00:36:30,390
you modify a file

686
00:36:26,280 --> 00:36:33,339
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> modify</font><font color="#E5E5E5"> file the standard</font>

687
00:36:30,390 --> 00:36:36,129
information<font color="#E5E5E5"> attribute will change</font>

688
00:36:33,339 --> 00:36:41,259
the modification time interestingly

689
00:36:36,130 --> 00:36:45,489
enough the file name attribute will not

690
00:36:41,259 --> 00:36:47,469
change the modification time so it<font color="#CCCCCC"> if</font>

691
00:36:45,489 --> 00:36:49,779
you're new to this you might look at an

692
00:36:47,469 --> 00:36:51,880
<font color="#CCCCCC">mft entry you might say hey these differ</font>

693
00:36:49,779 --> 00:36:53,440
<font color="#CCCCCC">and that's</font><font color="#E5E5E5"> bad right</font>

694
00:36:51,880 --> 00:37:01,450
you<font color="#E5E5E5"> might suspect something was wrong</font>

695
00:36:53,440 --> 00:37:04,509
<font color="#CCCCCC">but it's not it's actually ok so that's</font>

696
00:37:01,450 --> 00:37:05,348
modifying<font color="#CCCCCC"> the file if you deleted file</font>

697
00:37:04,509 --> 00:37:08,019
guess what

698
00:37:05,349 --> 00:37:09,489
absolutely nothing changes now<font color="#E5E5E5"> these</font>

699
00:37:08,019 --> 00:37:12,549
<font color="#CCCCCC">timestamps change</font>

700
00:37:09,489 --> 00:37:15,460
<font color="#E5E5E5">it's great though because it just flips</font>

701
00:37:12,549 --> 00:37:17,469
one bit<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you're like</font><font color="#CCCCCC"> alright the</font>

702
00:37:15,460 --> 00:37:20,109
following away<font color="#CCCCCC"> so if you look at the</font>

703
00:37:17,469 --> 00:37:23,440
<font color="#E5E5E5">directories themselves</font><font color="#CCCCCC"> that's going to</font>

704
00:37:20,109 --> 00:37:26,469
be updated<font color="#E5E5E5"> but everything else it's</font>

705
00:37:23,440 --> 00:37:29,619
still there so you can very easily

706
00:37:26,469 --> 00:37:32,469
<font color="#E5E5E5">undelete</font><font color="#CCCCCC"> files you might have bought</font>

707
00:37:29,619 --> 00:37:36,009
utilities to undelete files on<font color="#E5E5E5"> windows</font>

708
00:37:32,469 --> 00:37:38,319
systems<font color="#E5E5E5"> and for it turns out in some</font>

709
00:37:36,009 --> 00:37:40,180
cases for fat file systems it can be

710
00:37:38,319 --> 00:37:42,190
rather complicated and sometimes you

711
00:37:40,180 --> 00:37:46,118
just honestly have to guess<font color="#E5E5E5"> especially</font>

712
00:37:42,190 --> 00:37:46,569
<font color="#CCCCCC">when its</font><font color="#E5E5E5"> fat32 part of the reason for</font>

713
00:37:46,119 --> 00:37:50,349
that

714
00:37:46,569 --> 00:37:52,569
<font color="#CCCCCC">fat32 you have the cluster number</font><font color="#E5E5E5"> for</font>

715
00:37:50,349 --> 00:37:55,599
your file where it starts and<font color="#CCCCCC"> it's</font>

716
00:37:52,569 --> 00:37:58,569
<font color="#E5E5E5">broken up into</font><font color="#CCCCCC"> a high</font><font color="#E5E5E5"> word and</font><font color="#CCCCCC"> aloe word</font>

717
00:37:55,599 --> 00:38:00,700
<font color="#E5E5E5">and depending on what version of windows</font>

718
00:37:58,569 --> 00:38:04,420
<font color="#E5E5E5">you're running and how you deleted the</font>

719
00:38:00,700 --> 00:38:08,229
file for one<font color="#E5E5E5"> read unknown reasons</font>

720
00:38:04,420 --> 00:38:12,789
<font color="#CCCCCC">microsoft will zero out the high word of</font>

721
00:38:08,229 --> 00:38:15,160
that cluster number<font color="#CCCCCC"> for</font><font color="#E5E5E5"> fat32 so it can</font>

722
00:38:12,789 --> 00:38:19,630
be almost impossible to recover a file

723
00:38:15,160 --> 00:38:21,848
sometimes in<font color="#E5E5E5"> fat but</font><font color="#CCCCCC"> we're ntfs</font><font color="#E5E5E5"> it's</font>

724
00:38:19,630 --> 00:38:25,210
just like<font color="#E5E5E5"> okay just</font><font color="#CCCCCC"> put a bit</font>

725
00:38:21,849 --> 00:38:27,940
<font color="#E5E5E5">mark the clusters is being used and it's</font>

726
00:38:25,210 --> 00:38:35,740
all good<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> extremely easy to undelete</font>

727
00:38:27,940 --> 00:38:43,390
<font color="#E5E5E5">in</font><font color="#CCCCCC"> ntfs yes sir</font>

728
00:38:35,740 --> 00:38:47,560
so the question was how long do you have

729
00:38:43,390 --> 00:38:50,350
to get the file back when what is

730
00:38:47,560 --> 00:38:54,850
enabled

731
00:38:50,350 --> 00:38:59,350
<font color="#CCCCCC">ok so how long do you have to get the</font>

732
00:38:54,850 --> 00:39:01,150
file<font color="#E5E5E5"> box</font><font color="#CCCCCC"> i would say in most cases is as</font>

733
00:38:59,350 --> 00:39:03,730
long as you<font color="#CCCCCC"> you know like if you just</font>

734
00:39:01,150 --> 00:39:06,850
deleted it and you're like oh crap<font color="#CCCCCC"> right</font>

735
00:39:03,730 --> 00:39:09,790
<font color="#CCCCCC">you can probably get it back but if it's</font>

736
00:39:06,850 --> 00:39:12,940
been a long time

737
00:39:09,790 --> 00:39:15,400
it depends on how full your<font color="#E5E5E5"> file system</font>

738
00:39:12,940 --> 00:39:16,810
is<font color="#CCCCCC"> right so if your file system is</font>

739
00:39:15,400 --> 00:39:21,040
really full

740
00:39:16,810 --> 00:39:24,610
what happens typically is that it will

741
00:39:21,040 --> 00:39:26,590
allocate<font color="#E5E5E5"> clusters and it just kept keeps</font>

742
00:39:24,610 --> 00:39:30,130
on glowing to higher number of clusters

743
00:39:26,590 --> 00:39:33,220
as it allocates space on the drive and

744
00:39:30,130 --> 00:39:35,320
it only goes back<font color="#E5E5E5"> when it starts running</font>

745
00:39:33,220 --> 00:39:36,879
out of space<font color="#CCCCCC"> that's kind of the default</font>

746
00:39:35,320 --> 00:39:38,980
behavior there's some subtle differences

747
00:39:36,880 --> 00:39:43,300
depending<font color="#CCCCCC"> on the exact versions of</font>

748
00:39:38,980 --> 00:39:46,450
<font color="#CCCCCC">Windows that you're running</font><font color="#E5E5E5"> but if you</font>

749
00:39:43,300 --> 00:39:48,130
have a really full hard drive and you've

750
00:39:46,450 --> 00:39:50,560
been messing with the system and some

751
00:39:48,130 --> 00:39:52,359
time has gone on the chances of<font color="#CCCCCC"> you're</font>

752
00:39:50,560 --> 00:40:15,520
getting your file back<font color="#E5E5E5"> start to go down</font>

753
00:39:52,359 --> 00:40:17,950
a lot<font color="#E5E5E5"> but then</font><font color="#CCCCCC"> answer</font><font color="#E5E5E5"> your question yeah</font>

754
00:40:15,520 --> 00:40:21,550
it is actually in this case the question

755
00:40:17,950 --> 00:40:25,118
is you know what about<font color="#E5E5E5"> SSD vs not SSD</font>

756
00:40:21,550 --> 00:40:26,980
<font color="#E5E5E5">and</font><font color="#CCCCCC"> it's really not</font><font color="#E5E5E5"> all that different</font>

757
00:40:25,119 --> 00:40:30,369
<font color="#E5E5E5">because we're kind of at the higher</font>

758
00:40:26,980 --> 00:40:33,850
level you know<font color="#CCCCCC"> we're at that file system</font>

759
00:40:30,369 --> 00:40:37,330
operating system level so at that level

760
00:40:33,850 --> 00:40:39,580
<font color="#E5E5E5">when you mark</font><font color="#CCCCCC"> when we say we're marking</font>

761
00:40:37,330 --> 00:40:41,950
clusters is available<font color="#CCCCCC"> there being marked</font>

762
00:40:39,580 --> 00:40:46,359
<font color="#CCCCCC">as available by the operating system</font>

763
00:40:41,950 --> 00:40:48,250
<font color="#E5E5E5">right so it's not that this part this</font>

764
00:40:46,359 --> 00:40:49,420
part of flash<font color="#E5E5E5"> memory is being marked</font>

765
00:40:48,250 --> 00:40:51,880
<font color="#E5E5E5">enabled at all</font>

766
00:40:49,420 --> 00:40:53,710
it's just<font color="#E5E5E5"> just like a hard drive it's</font>

767
00:40:51,880 --> 00:40:55,990
really not any different between those

768
00:40:53,710 --> 00:41:01,390
two

769
00:40:55,990 --> 00:41:05,709
so if we move a file to the same volume

770
00:41:01,390 --> 00:41:12,430
<font color="#CCCCCC">here's what happens we change the time</font>

771
00:41:05,710 --> 00:41:16,930
in the<font color="#CCCCCC"> filename and now it's changed to</font>

772
00:41:12,430 --> 00:41:19,598
the time in the standard info which is

773
00:41:16,930 --> 00:41:26,078
<font color="#CCCCCC">kinda weird and the same thing is true</font>

774
00:41:19,599 --> 00:41:29,440
with the record change time<font color="#E5E5E5"> if you move</font>

775
00:41:26,079 --> 00:41:32,589
it to a new volume then all the<font color="#CCCCCC"> filename</font>

776
00:41:29,440 --> 00:41:36,700
stuff gets changed and the access and

777
00:41:32,589 --> 00:41:38,078
record change time gets changed on the

778
00:41:36,700 --> 00:41:40,149
other system

779
00:41:38,079 --> 00:41:45,549
<font color="#CCCCCC">alright alright is to say in the</font>

780
00:41:40,150 --> 00:41:48,309
standard info<font color="#E5E5E5"> so looking at the</font><font color="#CCCCCC"> time</font>

781
00:41:45,549 --> 00:41:50,770
<font color="#CCCCCC">stamps</font><font color="#E5E5E5"> just to sum it up a little bit</font>

782
00:41:48,309 --> 00:41:53,200
<font color="#E5E5E5">that the rules are a little complicated</font>

783
00:41:50,770 --> 00:41:57,520
<font color="#CCCCCC">i think he can kind of get a picture of</font>

784
00:41:53,200 --> 00:42:01,058
that they do<font color="#CCCCCC"> tend to change</font><font color="#E5E5E5"> over time</font>

785
00:41:57,520 --> 00:42:01,569
and attackers<font color="#E5E5E5"> might screws it something</font>

786
00:42:01,059 --> 00:42:03,910
up

787
00:42:01,569 --> 00:42:06,759
they might accidentally change things in

788
00:42:03,910 --> 00:42:09,250
one place and<font color="#E5E5E5"> not another place or they</font>

789
00:42:06,760 --> 00:42:12,849
might change all the time stamps<font color="#E5E5E5"> so that</font>

790
00:42:09,250 --> 00:42:16,270
the same when they shouldn't be some

791
00:42:12,849 --> 00:42:19,000
standard tools are somewhat limited<font color="#CCCCCC"> and</font>

792
00:42:16,270 --> 00:42:22,960
<font color="#E5E5E5">a little bit slow</font><font color="#CCCCCC"> it can take hours to</font>

793
00:42:19,000 --> 00:42:26,319
import your data and you only get the

794
00:42:22,960 --> 00:42:30,520
views and the queries that they provide

795
00:42:26,319 --> 00:42:33,460
<font color="#CCCCCC">so a great example look at autopsy will</font>

796
00:42:30,520 --> 00:42:36,250
let you view files by their size<font color="#CCCCCC"> will</font>

797
00:42:33,460 --> 00:42:38,049
let you be your files based on how long

798
00:42:36,250 --> 00:42:40,599
ago they were modified<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> can</font>

799
00:42:38,049 --> 00:42:42,849
<font color="#CCCCCC">easily combine those two things right</font>

800
00:42:40,599 --> 00:42:46,359
it's one or the other<font color="#E5E5E5"> but since you have</font>

801
00:42:42,849 --> 00:42:48,730
it backed up into a database<font color="#E5E5E5"> you can do</font>

802
00:42:46,359 --> 00:42:51,520
it<font color="#CCCCCC"> and you can do whatever kind of</font><font color="#E5E5E5"> query</font>

803
00:42:48,730 --> 00:42:54,190
you want<font color="#E5E5E5"> i can say</font><font color="#CCCCCC"> i want</font><font color="#E5E5E5"> to file</font><font color="#CCCCCC"> that's</font>

804
00:42:51,520 --> 00:42:55,720
at least<font color="#E5E5E5"> two gigabytes in size and it</font>

805
00:42:54,190 --> 00:42:58,630
was touched

806
00:42:55,720 --> 00:43:01,180
and this date range<font color="#CCCCCC"> right so maybe I'm</font>

807
00:42:58,630 --> 00:43:03,700
looking for video files for example<font color="#E5E5E5"> and</font>

808
00:43:01,180 --> 00:43:06,819
that can help me to<font color="#E5E5E5"> whittle things down</font>

809
00:43:03,700 --> 00:43:08,890
now<font color="#CCCCCC"> of</font><font color="#E5E5E5"> course these timelines and these</font>

810
00:43:06,820 --> 00:43:12,040
<font color="#CCCCCC">timestamps can always be spoofed</font>

811
00:43:08,890 --> 00:43:16,598
<font color="#E5E5E5">everything can be spoof</font><font color="#CCCCCC"> but guess</font><font color="#E5E5E5"> what</font>

812
00:43:12,040 --> 00:43:18,430
most people don't bother<font color="#E5E5E5"> right</font><font color="#CCCCCC"> it's true</font>

813
00:43:16,599 --> 00:43:20,440
occasionally you'll have an<font color="#E5E5E5"> advanced</font>

814
00:43:18,430 --> 00:43:22,810
<font color="#CCCCCC">attacker</font><font color="#E5E5E5"> that's actually going to change</font>

815
00:43:20,440 --> 00:43:25,300
these things but most of the time they

816
00:43:22,810 --> 00:43:26,560
don't<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> kind of like you know earlier</font>

817
00:43:25,300 --> 00:43:29,470
<font color="#CCCCCC">I don't know how many</font><font color="#E5E5E5"> of you saw</font>

818
00:43:26,560 --> 00:43:32,230
<font color="#CCCCCC">Phoenix's talk this morning is talking</font>

819
00:43:29,470 --> 00:43:34,569
about privacy and it was all about

820
00:43:32,230 --> 00:43:38,140
hey you know you don't have anything to

821
00:43:34,570 --> 00:43:38,740
hide<font color="#CCCCCC"> right</font><font color="#E5E5E5"> and you have</font><font color="#CCCCCC"> governments</font>

822
00:43:38,140 --> 00:43:40,598
<font color="#CCCCCC">telling you</font>

823
00:43:38,740 --> 00:43:43,419
encryption<font color="#E5E5E5"> is bad encryption is only</font>

824
00:43:40,599 --> 00:43:48,849
used by bad people<font color="#CCCCCC"> write</font><font color="#E5E5E5"> only bad people</font>

825
00:43:43,420 --> 00:43:51,070
like privacy and things like that so you

826
00:43:48,849 --> 00:43:53,590
know you have people saying oh<font color="#CCCCCC"> yeah you</font>

827
00:43:51,070 --> 00:43:56,530
should just be able to like see that or

828
00:43:53,590 --> 00:44:00,400
not<font color="#E5E5E5"> see that but anyway that's a little</font>

829
00:43:56,530 --> 00:44:02,740
bit of a tangent but so<font color="#E5E5E5"> and the only</font>

830
00:44:00,400 --> 00:44:06,940
thing about this is just a little bit of

831
00:44:02,740 --> 00:44:08,890
scripting and some database stuff you

832
00:44:06,940 --> 00:44:12,940
know it can be fun and it can be pretty

833
00:44:08,890 --> 00:44:16,000
fast<font color="#CCCCCC"> so with that we have a couple more</font>

834
00:44:12,940 --> 00:44:17,950
minutes<font color="#E5E5E5"> because any other questions or</font>

835
00:44:16,000 --> 00:44:20,230
if you want to live dangerously

836
00:44:17,950 --> 00:44:23,080
<font color="#CCCCCC">I might even go see if we can actually</font>

837
00:44:20,230 --> 00:44:33,190
<font color="#E5E5E5">repeat this in a</font><font color="#CCCCCC"> three-minute Lydell yes</font>

838
00:44:23,080 --> 00:44:35,290
sir<font color="#E5E5E5"> I do</font>

839
00:44:33,190 --> 00:44:39,010
<font color="#E5E5E5">unfortunately don't have anything at</font>

840
00:44:35,290 --> 00:44:41,680
this exact moment<font color="#CCCCCC"> where</font><font color="#E5E5E5"> it's done</font><font color="#CCCCCC"> where</font>

841
00:44:39,010 --> 00:44:44,470
you can just access it for free

842
00:44:41,680 --> 00:44:47,410
I do have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> you know not to advertise</font>

843
00:44:44,470 --> 00:44:49,330
for pentester academy but<font color="#E5E5E5"> pentester</font>

844
00:44:47,410 --> 00:44:51,700
academy<font color="#CCCCCC"> i do have</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> 18-hour course and</font>

845
00:44:49,330 --> 00:44:53,590
<font color="#CCCCCC">windows forensics</font><font color="#E5E5E5"> that includes this and</font>

846
00:44:51,700 --> 00:44:56,859
a lot more stuff

847
00:44:53,590 --> 00:44:58,660
but if you guys want if depending if

848
00:44:56,860 --> 00:45:00,310
<font color="#E5E5E5">there's any other questions if you want</font>

849
00:44:58,660 --> 00:45:04,210
<font color="#CCCCCC">i can</font><font color="#E5E5E5"> actually try to do a</font><font color="#CCCCCC"> three minute</font>

850
00:45:00,310 --> 00:45:19,180
<font color="#E5E5E5">live demo which is dangerous</font><font color="#CCCCCC"> i know</font><font color="#E5E5E5"> what</font>

851
00:45:04,210 --> 00:45:20,650
yes sir<font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> great question the</font>

852
00:45:19,180 --> 00:45:23,830
question was what's the difference

853
00:45:20,650 --> 00:45:25,960
between my script<font color="#CCCCCC"> and</font><font color="#E5E5E5"> autopsy</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> why is</font>

854
00:45:23,830 --> 00:45:28,900
that there's such a huge time difference

855
00:45:25,960 --> 00:45:32,380
<font color="#E5E5E5">and honestly the biggest thing is that</font>

856
00:45:28,900 --> 00:45:36,820
autopsy is going to read in all of that

857
00:45:32,380 --> 00:45:39,340
data and<font color="#E5E5E5"> it's not going to back it up to</font>

858
00:45:36,820 --> 00:45:41,350
a proper database right<font color="#E5E5E5"> and it's doing</font>

859
00:45:39,340 --> 00:45:44,350
some other things<font color="#CCCCCC"> while</font><font color="#E5E5E5"> it's doing that</font>

860
00:45:41,350 --> 00:45:48,640
ingestion<font color="#CCCCCC"> but if I only just wanted a</font>

861
00:45:44,350 --> 00:45:51,279
<font color="#E5E5E5">timeline then the script</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> faster</font>

862
00:45:48,640 --> 00:45:54,370
and you know again<font color="#E5E5E5"> a big part of that is</font>

863
00:45:51,280 --> 00:45:56,890
<font color="#E5E5E5">I have some</font><font color="#CCCCCC"> python scripts that</font>

864
00:45:54,370 --> 00:46:00,130
interpret all the different structures

865
00:45:56,890 --> 00:46:03,940
and<font color="#E5E5E5"> ntfs and it'll rip through that</font>

866
00:46:00,130 --> 00:46:06,850
pretty quickly as we saw and then take

867
00:46:03,940 --> 00:46:08,770
that and put it into a database which is

868
00:46:06,850 --> 00:46:11,529
a lot faster because you start looking

869
00:46:08,770 --> 00:46:14,020
at all the rows so you know this kind of

870
00:46:11,530 --> 00:46:18,250
leads to another thing so you could take

871
00:46:14,020 --> 00:46:22,450
that<font color="#E5E5E5"> CSV file and import it directly</font>

872
00:46:18,250 --> 00:46:26,800
into a spreadsheet and then you could

873
00:46:22,450 --> 00:46:28,629
sort it in your spreadsheet program<font color="#E5E5E5"> if</font>

874
00:46:26,800 --> 00:46:31,900
you do<font color="#E5E5E5"> that and you have a couple</font>

875
00:46:28,630 --> 00:46:34,750
million rows in that spreadsheet program

876
00:46:31,900 --> 00:46:36,790
you might lock up your computer<font color="#E5E5E5"> right</font>

877
00:46:34,750 --> 00:46:39,160
your computer<font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to be like what</font>

878
00:46:36,790 --> 00:46:41,290
are you doing to me<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> going</font>

879
00:46:39,160 --> 00:46:45,009
<font color="#CCCCCC">to be very unhappy with you if you try</font>

880
00:46:41,290 --> 00:46:48,580
to do that<font color="#CCCCCC"> so the difference is that</font>

881
00:46:45,010 --> 00:46:49,990
with something like autopsy it's very

882
00:46:48,580 --> 00:46:53,200
similar to<font color="#E5E5E5"> running that spreadsheet</font>

883
00:46:49,990 --> 00:46:56,589
program it<font color="#E5E5E5"> it's got so much overhead is</font>

884
00:46:53,200 --> 00:46:58,509
trying to<font color="#E5E5E5"> short it in part because it</font>

885
00:46:56,590 --> 00:47:00,910
doesn't have a nice database that's

886
00:46:58,510 --> 00:47:02,330
<font color="#E5E5E5">backing this stuff up like a proper</font>

887
00:47:00,910 --> 00:47:05,120
database

888
00:47:02,330 --> 00:47:07,250
and that's really the biggest difference

889
00:47:05,120 --> 00:47:09,380
<font color="#CCCCCC">i would say you know they're going to</font>

890
00:47:07,250 --> 00:47:12,140
have to pull everything<font color="#E5E5E5"> into memory and</font>

891
00:47:09,380 --> 00:47:15,230
try to do some sorting<font color="#E5E5E5"> where is I just</font>

892
00:47:12,140 --> 00:47:17,540
dumped everything raw<font color="#E5E5E5"> into the database</font>

893
00:47:15,230 --> 00:47:28,790
and then ran a sequel query and it was

894
00:47:17,540 --> 00:47:36,770
supervised<font color="#E5E5E5"> yes sir</font>

895
00:47:28,790 --> 00:47:41,270
<font color="#E5E5E5">alright so the question was can we</font>

896
00:47:36,770 --> 00:47:47,390
interpret this slide

897
00:47:41,270 --> 00:47:51,710
<font color="#CCCCCC">ok so this is telling us for whatever it</font>

898
00:47:47,390 --> 00:47:56,029
is<font color="#E5E5E5"> that stored stored in</font><font color="#CCCCCC"> mft</font><font color="#E5E5E5"> entry</font>

899
00:47:51,710 --> 00:47:59,420
<font color="#CCCCCC">65,000 261 what are all the references</font>

900
00:47:56,030 --> 00:48:03,200
found in this file system that point to

901
00:47:59,420 --> 00:48:06,920
that file<font color="#CCCCCC"> right and this is sorted by</font>

902
00:48:03,200 --> 00:48:11,930
date and time<font color="#E5E5E5"> so you'll notice that at</font>

903
00:48:06,920 --> 00:48:19,700
the top I have<font color="#E5E5E5"> 2015 23 so</font><font color="#CCCCCC"> february's</font>

904
00:48:11,930 --> 00:48:22,730
<font color="#E5E5E5">third at</font><font color="#CCCCCC"> 70</font><font color="#E5E5E5"> 9pm the file and the I</font>

905
00:48:19,700 --> 00:48:24,529
indicates that this was gotten out of

906
00:48:22,730 --> 00:48:29,060
the index buffer out of a directory

907
00:48:24,530 --> 00:48:34,010
entry<font color="#CCCCCC"> i have a modification time of that</font>

908
00:48:29,060 --> 00:48:37,250
time for one file called main HTML<font color="#E5E5E5"> and</font>

909
00:48:34,010 --> 00:48:42,170
then another file at the exact same time

910
00:48:37,250 --> 00:48:45,320
<font color="#CCCCCC">main till the one that HTM so it's got a</font>

911
00:48:42,170 --> 00:48:48,980
long<font color="#E5E5E5"> filename and a short filename and</font>

912
00:48:45,320 --> 00:48:52,250
those<font color="#E5E5E5"> two directory entries agree i also</font>

913
00:48:48,980 --> 00:48:54,470
have file size information<font color="#CCCCCC"> i didn't</font>

914
00:48:52,250 --> 00:48:57,620
mention<font color="#E5E5E5"> it but each of these things in</font>

915
00:48:54,470 --> 00:48:58,910
the<font color="#CCCCCC"> mft they have a number for the entry</font>

916
00:48:57,620 --> 00:49:01,130
and then have something called a

917
00:48:58,910 --> 00:49:02,120
sequence number<font color="#E5E5E5"> that's used as a double</font>

918
00:49:01,130 --> 00:49:04,610
check

919
00:49:02,120 --> 00:49:06,650
so this is the first time<font color="#E5E5E5"> this</font><font color="#CCCCCC"> entry was</font>

920
00:49:04,610 --> 00:49:09,020
used sequence number one<font color="#E5E5E5"> that's what</font>

921
00:49:06,650 --> 00:49:12,470
that means<font color="#CCCCCC"> so that</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> i have a reference</font>

922
00:49:09,020 --> 00:49:13,570
to something that says<font color="#E5E5E5"> sequence number</font>

923
00:49:12,470 --> 00:49:15,759
<font color="#E5E5E5">one</font>

924
00:49:13,570 --> 00:49:18,640
and<font color="#CCCCCC"> I go in and look in that entry and</font>

925
00:49:15,760 --> 00:49:21,010
it says this is version<font color="#CCCCCC"> 2 of this entry</font>

926
00:49:18,640 --> 00:49:23,200
<font color="#CCCCCC">i know i'm looking at</font><font color="#E5E5E5"> the wrong thing</font>

927
00:49:21,010 --> 00:49:28,000
<font color="#CCCCCC">i'm looking at</font><font color="#E5E5E5"> outdated information but</font>

928
00:49:23,200 --> 00:49:30,879
<font color="#E5E5E5">so then the next line has that same</font><font color="#CCCCCC"> time</font>

929
00:49:28,000 --> 00:49:38,140
<font color="#CCCCCC">stamp</font><font color="#E5E5E5"> and it says from the standard info</font>

930
00:49:30,880 --> 00:49:42,190
<font color="#E5E5E5">i have four main</font><font color="#CCCCCC"> tilde</font><font color="#E5E5E5"> 1.htm</font><font color="#CCCCCC"> i have</font><font color="#E5E5E5"> that</font>

931
00:49:38,140 --> 00:49:47,620
same<font color="#CCCCCC"> time stamp right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> i can look</font><font color="#E5E5E5"> back</font>

932
00:49:42,190 --> 00:49:53,140
at my rules and say is that right

933
00:49:47,620 --> 00:50:04,990
so if<font color="#E5E5E5"> i look at</font><font color="#CCCCCC"> a file that I changed</font>

934
00:49:53,140 --> 00:50:08,080
<font color="#CCCCCC">ok went the wrong way sorry</font>

935
00:50:04,990 --> 00:50:11,859
so this file was modified and according

936
00:50:08,080 --> 00:50:20,590
to this the standard<font color="#E5E5E5"> info should change</font>

937
00:50:11,860 --> 00:50:24,010
<font color="#CCCCCC">alright so if we go back here we can see</font>

938
00:50:20,590 --> 00:50:26,710
that the standard<font color="#CCCCCC"> info change and those</font>

939
00:50:24,010 --> 00:50:28,570
index buffers change<font color="#E5E5E5"> so that tells me</font>

940
00:50:26,710 --> 00:50:33,040
this is actually correct

941
00:50:28,570 --> 00:50:37,090
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> I looked at</font><font color="#E5E5E5"> the file name</font>

942
00:50:33,040 --> 00:50:39,759
attributes and those had also changed

943
00:50:37,090 --> 00:50:42,100
based on my little table<font color="#E5E5E5"> that would be</font>

944
00:50:39,760 --> 00:50:45,490
incorrect<font color="#CCCCCC"> so that would indicate to me</font>

945
00:50:42,100 --> 00:50:49,060
that someone manually manipulated this

946
00:50:45,490 --> 00:50:52,270
information<font color="#E5E5E5"> right but this is it a</font>

947
00:50:49,060 --> 00:50:54,340
useful view<font color="#CCCCCC"> not</font><font color="#E5E5E5"> just for detecting that</font>

948
00:50:52,270 --> 00:50:57,340
manual manipulation because honestly

949
00:50:54,340 --> 00:50:59,080
<font color="#E5E5E5">people don't do that very often</font><font color="#CCCCCC"> and most</font>

950
00:50:57,340 --> 00:51:01,660
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> time people aren't that</font>

951
00:50:59,080 --> 00:51:03,190
sophisticated and they don't realize

952
00:51:01,660 --> 00:51:04,810
that this is happening

953
00:51:03,190 --> 00:51:07,540
I mean you do occasionally get the more

954
00:51:04,810 --> 00:51:10,600
sophisticated attacker that will<font color="#E5E5E5"> but</font>

955
00:51:07,540 --> 00:51:13,870
this<font color="#E5E5E5"> just gives you kind of a history of</font>

956
00:51:10,600 --> 00:51:16,360
that file and it says<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> here's the</font>

957
00:51:13,870 --> 00:51:18,618
first reference to that file and it was

958
00:51:16,360 --> 00:51:22,819
a modification time reference

959
00:51:18,619 --> 00:51:27,140
and then I see some later references<font color="#E5E5E5"> and</font>

960
00:51:22,819 --> 00:51:30,950
those were accessed those were<font color="#E5E5E5"> record</font>

961
00:51:27,140 --> 00:51:32,749
changes and also creation

962
00:51:30,950 --> 00:51:35,598
<font color="#CCCCCC">alright so creation could be it was</font>

963
00:51:32,749 --> 00:51:38,029
copied<font color="#CCCCCC"> right and that's where you have</font>

964
00:51:35,599 --> 00:51:40,460
to look at those rules<font color="#E5E5E5"> but this just</font>

965
00:51:38,029 --> 00:51:43,220
gives me a view so maybe this is an

966
00:51:40,460 --> 00:51:47,390
interesting<font color="#CCCCCC"> files</font><font color="#E5E5E5"> so let's just say I</font>

967
00:51:43,220 --> 00:51:50,450
looked at my overall timeline<font color="#CCCCCC"> my</font>

968
00:51:47,390 --> 00:51:52,940
chronological<font color="#E5E5E5"> timeline and</font><font color="#CCCCCC"> I saw all</font>

969
00:51:50,450 --> 00:51:55,399
<font color="#CCCCCC">right i looked at my registry i looked</font>

970
00:51:52,940 --> 00:52:01,400
at my event logs and such and<font color="#CCCCCC"> I saw</font>

971
00:51:55,400 --> 00:52:04,549
around<font color="#CCCCCC"> December third</font><font color="#E5E5E5"> something strange</font>

972
00:52:01,400 --> 00:52:07,069
happened that<font color="#CCCCCC"> I suspect might been an</font>

973
00:52:04,549 --> 00:52:10,430
attacker in my system<font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'm going to</font>

974
00:52:07,069 --> 00:52:12,980
start looking<font color="#E5E5E5"> at all those files in that</font>

975
00:52:10,430 --> 00:52:15,529
<font color="#CCCCCC">timeframe and I might want to look at</font>

976
00:52:12,980 --> 00:52:18,680
them individually and then say let me

977
00:52:15,529 --> 00:52:20,269
pull that out of that context where I

978
00:52:18,680 --> 00:52:23,509
said<font color="#CCCCCC"> alright I've identified this</font>

979
00:52:20,269 --> 00:52:26,569
particular file at 65,000 261<font color="#E5E5E5"> as an</font>

980
00:52:23,509 --> 00:52:29,150
interesting file potentially<font color="#E5E5E5"> now let me</font>

981
00:52:26,569 --> 00:52:31,940
just look at that file and all

982
00:52:29,150 --> 00:52:34,369
references to that file that<font color="#CCCCCC"> i found</font><font color="#E5E5E5"> in</font>

983
00:52:31,940 --> 00:52:37,400
this file system and this will even pick

984
00:52:34,369 --> 00:52:40,039
out things from<font color="#E5E5E5"> like if i delete a</font>

985
00:52:37,400 --> 00:52:41,480
directory<font color="#CCCCCC"> by delete the whole thing</font><font color="#E5E5E5"> all</font>

986
00:52:40,039 --> 00:52:44,150
<font color="#E5E5E5">this</font><font color="#CCCCCC"> date is still</font><font color="#E5E5E5"> there</font>

987
00:52:41,480 --> 00:52:46,700
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so this is another way that</font><font color="#CCCCCC"> I</font>

988
00:52:44,150 --> 00:52:48,650
can see<font color="#CCCCCC"> all right I I thought it</font><font color="#E5E5E5"> was</font>

989
00:52:46,700 --> 00:52:52,220
around this time that something happened

990
00:52:48,650 --> 00:52:55,190
with<font color="#CCCCCC"> this file</font><font color="#E5E5E5"> but maybe it was actually</font>

991
00:52:52,220 --> 00:52:57,890
a different time based on data<font color="#CCCCCC"> they got</font>

992
00:52:55,190 --> 00:53:00,920
left on the<font color="#E5E5E5"> file system</font><font color="#CCCCCC"> so that's kind</font>

993
00:52:57,890 --> 00:53:03,769
of how you can interpret this<font color="#E5E5E5"> now this</font>

994
00:53:00,920 --> 00:53:05,960
<font color="#E5E5E5">is not a probably not an interesting</font>

995
00:53:03,769 --> 00:53:09,558
file<font color="#E5E5E5"> is just like a random number i just</font>

996
00:53:05,960 --> 00:53:11,809
picked to make this demo because it fit

997
00:53:09,559 --> 00:53:14,480
on one screen<font color="#CCCCCC"> that was my criteria</font><font color="#E5E5E5"> if</font>

998
00:53:11,809 --> 00:53:16,609
<font color="#CCCCCC">anyone screen so that you could see</font><font color="#E5E5E5"> the</font>

999
00:53:14,480 --> 00:53:20,779
whole command and how long it took to

1000
00:53:16,609 --> 00:53:23,569
run<font color="#CCCCCC"> all right I think</font><font color="#E5E5E5"> we're about out of</font>

1001
00:53:20,779 --> 00:53:30,789
time so<font color="#CCCCCC"> I</font><font color="#E5E5E5"> thank you very much for coming</font>

1002
00:53:23,569 --> 00:53:30,788
and enjoy the rest of your conference

