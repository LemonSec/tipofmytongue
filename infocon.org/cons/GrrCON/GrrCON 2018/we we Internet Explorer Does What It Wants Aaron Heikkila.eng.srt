1
00:00:00,079 --> 00:00:05,548
<font color="#E5E5E5">hey welcome</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> my talk it's whatever</font>

2
00:00:03,449 --> 00:00:07,649
whatever<font color="#E5E5E5"> Internet Explorer</font><font color="#CCCCCC"> does what it</font>

3
00:00:05,549 --> 00:00:09,059
wants<font color="#CCCCCC"> after seeing some of the</font>

4
00:00:07,649 --> 00:00:11,040
presentations<font color="#E5E5E5"> here this week</font>

5
00:00:09,059 --> 00:00:14,309
I think I could have changed it<font color="#E5E5E5"> to just</font>

6
00:00:11,040 --> 00:00:17,698
another<font color="#E5E5E5"> HD a talk but uh you'll see that</font>

7
00:00:14,309 --> 00:00:19,560
coming<font color="#CCCCCC"> out my name is</font><font color="#E5E5E5"> Aaron hi</font><font color="#CCCCCC"> kleh I've</font>

8
00:00:17,699 --> 00:00:22,170
been an IT professional about<font color="#CCCCCC"> ten</font><font color="#E5E5E5"> years</font>

9
00:00:19,560 --> 00:00:23,759
or so<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been with targeted for three</font>

10
00:00:22,170 --> 00:00:25,460
years there's an incident handler<font color="#E5E5E5"> I</font>

11
00:00:23,760 --> 00:00:27,900
worked on the response team there<font color="#E5E5E5"> I</font>

12
00:00:25,460 --> 00:00:30,330
investigated cases and alerts and see

13
00:00:27,900 --> 00:00:32,369
what's going on<font color="#CCCCCC"> I</font><font color="#E5E5E5"> really like PowerShell</font>

14
00:00:30,330 --> 00:00:35,280
as anywhere<font color="#E5E5E5"> that knows me probably knows</font>

15
00:00:32,369 --> 00:00:39,030
that<font color="#E5E5E5"> I like forensics and Microsoft</font>

16
00:00:35,280 --> 00:00:40,559
products<font color="#E5E5E5"> I specialize in those a little</font>

17
00:00:39,030 --> 00:00:41,969
bit of a<font color="#E5E5E5"> disclaimer if you use any of</font>

18
00:00:40,559 --> 00:00:44,070
the<font color="#E5E5E5"> information from this talk I'm not</font>

19
00:00:41,969 --> 00:00:45,210
<font color="#CCCCCC">responsible for you</font><font color="#E5E5E5"> breaking your</font>

20
00:00:44,070 --> 00:00:46,559
environment

21
00:00:45,210 --> 00:00:48,180
hopefully I give you some<font color="#E5E5E5"> good</font>

22
00:00:46,559 --> 00:00:51,449
comprehensive info so that you can

23
00:00:48,180 --> 00:00:55,890
actually do something<font color="#E5E5E5"> useful with</font><font color="#CCCCCC"> it and</font>

24
00:00:51,449 --> 00:00:58,050
I represent<font color="#CCCCCC"> myself so this is</font><font color="#E5E5E5"> just a</font>

25
00:00:55,890 --> 00:01:00,480
quick<font color="#CCCCCC"> summary of kind of what</font><font color="#E5E5E5"> led me to</font>

26
00:00:58,050 --> 00:01:04,768
<font color="#CCCCCC">this talk we were</font><font color="#E5E5E5"> encountering some</font>

27
00:01:00,480 --> 00:01:06,420
issues at<font color="#CCCCCC"> Target with HDA Docs</font><font color="#E5E5E5"> and even</font>

28
00:01:04,769 --> 00:01:10,020
though we had put some defense<font color="#CCCCCC"> in depth</font>

29
00:01:06,420 --> 00:01:12,210
<font color="#E5E5E5">with the with our blocking we were still</font>

30
00:01:10,020 --> 00:01:14,670
seeing alerts coming<font color="#E5E5E5"> in and so I</font>

31
00:01:12,210 --> 00:01:18,479
investigated to figure out why we were

32
00:01:14,670 --> 00:01:22,530
<font color="#E5E5E5">still getting alerts so that's pretty</font>

33
00:01:18,479 --> 00:01:25,110
<font color="#E5E5E5">quick and simple so I'll cover</font><font color="#CCCCCC"> what an</font>

34
00:01:22,530 --> 00:01:27,659
HT a document is why we<font color="#CCCCCC"> actually care</font>

35
00:01:25,110 --> 00:01:30,240
about<font color="#CCCCCC"> HJ documents a little bit on how</font>

36
00:01:27,659 --> 00:01:33,320
you might hunt for HTA's<font color="#E5E5E5"> and how you'll</font>

37
00:01:30,240 --> 00:01:35,970
want<font color="#E5E5E5"> to block them because they're bad</font>

38
00:01:33,320 --> 00:01:39,240
so first<font color="#E5E5E5"> an</font><font color="#CCCCCC"> eight how many of you know</font>

39
00:01:35,970 --> 00:01:42,570
what an<font color="#CCCCCC"> HT</font><font color="#E5E5E5"> a document is all right it's</font>

40
00:01:39,240 --> 00:01:45,030
a decent number<font color="#CCCCCC"> of people an HJ is an</font>

41
00:01:42,570 --> 00:01:47,520
HTML application that's what the HJ

42
00:01:45,030 --> 00:01:51,420
stands for<font color="#E5E5E5"> it runs with a binary called</font>

43
00:01:47,520 --> 00:01:55,439
MSHDA that's<font color="#E5E5E5"> Microsoft HTML application</font>

44
00:01:51,420 --> 00:01:58,500
the normally HTML only<font color="#E5E5E5"> runs in the</font>

45
00:01:55,439 --> 00:02:00,508
context<font color="#E5E5E5"> of a browser so it doesn't have</font>

46
00:01:58,500 --> 00:02:03,000
access<font color="#E5E5E5"> to system resources it can't run</font>

47
00:02:00,509 --> 00:02:05,759
PowerShell or<font color="#CCCCCC"> vbscript</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> anything on</font>

48
00:02:03,000 --> 00:02:07,259
<font color="#E5E5E5">the host and</font><font color="#CCCCCC"> that's important because</font><font color="#E5E5E5"> if</font>

49
00:02:05,759 --> 00:02:08,340
you're browsing the<font color="#E5E5E5"> web and all of a</font>

50
00:02:07,259 --> 00:02:09,989
<font color="#CCCCCC">sudden they could start detonating</font>

51
00:02:08,340 --> 00:02:12,690
<font color="#E5E5E5">PowerShell on your</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> it's a little</font>

52
00:02:09,989 --> 00:02:13,500
bit of a<font color="#E5E5E5"> security concern so the</font><font color="#CCCCCC"> MSHA</font>

53
00:02:12,690 --> 00:02:16,859
<font color="#E5E5E5">app</font>

54
00:02:13,500 --> 00:02:19,620
allows the<font color="#CCCCCC"> fusion of an HTML GUI</font><font color="#E5E5E5"> with</font>

55
00:02:16,860 --> 00:02:22,680
the underlying system<font color="#E5E5E5"> resources on a</font>

56
00:02:19,620 --> 00:02:26,120
host<font color="#E5E5E5"> and so MSHDA is a fully trusted</font>

57
00:02:22,680 --> 00:02:28,860
application that<font color="#E5E5E5"> provides the access</font><font color="#CCCCCC"> and</font>

58
00:02:26,120 --> 00:02:31,140
like I<font color="#E5E5E5"> said it's vbscript jscript</font>

59
00:02:28,860 --> 00:02:32,880
<font color="#CCCCCC">powershell and javascript and really</font>

60
00:02:31,140 --> 00:02:35,100
<font color="#E5E5E5">anything on the host is accessible for</font>

61
00:02:32,880 --> 00:02:37,380
these applications<font color="#CCCCCC"> a lot of people use</font>

62
00:02:35,100 --> 00:02:43,769
<font color="#CCCCCC">HTA's to make like dashboards and</font><font color="#E5E5E5"> other</font>

63
00:02:37,380 --> 00:02:45,480
things or<font color="#CCCCCC"> sis admin tools so why do we</font>

64
00:02:43,770 --> 00:02:47,850
care<font color="#E5E5E5"> about</font><font color="#CCCCCC"> HJ Docs</font>

65
00:02:45,480 --> 00:02:51,359
well<font color="#CCCCCC"> HKS</font><font color="#E5E5E5"> are standard on all windows</font>

66
00:02:47,850 --> 00:02:53,190
systems<font color="#E5E5E5"> the MSHA</font><font color="#CCCCCC"> is there and if you</font>

67
00:02:51,360 --> 00:02:55,920
<font color="#CCCCCC">double-click</font><font color="#E5E5E5"> an HG doc it will</font>

68
00:02:53,190 --> 00:02:59,130
automatically launch with<font color="#CCCCCC"> MSHDA that's</font>

69
00:02:55,920 --> 00:03:01,559
way more attack surface than even like a

70
00:02:59,130 --> 00:03:04,350
word doc or something like<font color="#E5E5E5"> that because</font>

71
00:03:01,560 --> 00:03:07,080
<font color="#E5E5E5">it is on every system</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of users are</font>

72
00:03:04,350 --> 00:03:09,720
<font color="#E5E5E5">unfamiliar with what an</font><font color="#CCCCCC"> HG a doc is so</font>

73
00:03:07,080 --> 00:03:11,610
if they see this<font color="#E5E5E5"> HJ presented to them as</font>

74
00:03:09,720 --> 00:03:13,680
a malicious lure or something like<font color="#E5E5E5"> that</font>

75
00:03:11,610 --> 00:03:15,209
<font color="#E5E5E5">there they might click it just because</font>

76
00:03:13,680 --> 00:03:16,590
they don't<font color="#E5E5E5"> know what it is and they</font>

77
00:03:15,209 --> 00:03:19,350
might not be<font color="#CCCCCC"> afraid of</font><font color="#E5E5E5"> it because they</font>

78
00:03:16,590 --> 00:03:21,209
<font color="#CCCCCC">just don't</font><font color="#E5E5E5"> know HDS are extremely</font>

79
00:03:19,350 --> 00:03:23,030
<font color="#E5E5E5">powerful as I've been saying they have</font>

80
00:03:21,209 --> 00:03:26,250
access to<font color="#CCCCCC"> all the system resources</font>

81
00:03:23,030 --> 00:03:27,630
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> very sneaky</font><font color="#CCCCCC"> who thought</font><font color="#E5E5E5"> it was</font><font color="#CCCCCC"> a</font>

82
00:03:26,250 --> 00:03:30,330
good<font color="#CCCCCC"> idea</font><font color="#E5E5E5"> for you to be able to launch</font>

83
00:03:27,630 --> 00:03:33,390
an<font color="#CCCCCC"> HT a document</font><font color="#E5E5E5"> without a taskbar icon</font>

84
00:03:30,330 --> 00:03:36,420
or a window but they made<font color="#CCCCCC"> it that</font><font color="#E5E5E5"> way</font>

85
00:03:33,390 --> 00:03:40,170
<font color="#CCCCCC">as you'll</font><font color="#E5E5E5"> see an example</font><font color="#CCCCCC"> coming up and</font>

86
00:03:36,420 --> 00:03:42,510
then the<font color="#E5E5E5"> MS</font><font color="#CCCCCC"> HD binary itself you can</font>

87
00:03:40,170 --> 00:03:44,309
feed it<font color="#CCCCCC"> a remote URL</font><font color="#E5E5E5"> so it'll actually</font>

88
00:03:42,510 --> 00:03:47,399
<font color="#E5E5E5">reach out to the cloud and detonate the</font>

89
00:03:44,310 --> 00:03:49,470
<font color="#CCCCCC">HD a document</font><font color="#E5E5E5"> and that's just even</font>

90
00:03:47,400 --> 00:03:51,690
crazier<font color="#E5E5E5"> and then due to the trusted</font>

91
00:03:49,470 --> 00:03:53,670
nature of the binary<font color="#E5E5E5"> it bypasses</font>

92
00:03:51,690 --> 00:03:55,470
<font color="#E5E5E5">AppLocker most of the time so a lot</font><font color="#CCCCCC"> of</font>

93
00:03:53,670 --> 00:03:59,640
pen testers and bad guys use it because

94
00:03:55,470 --> 00:04:02,329
it'll<font color="#E5E5E5"> always work here's an example of</font>

95
00:03:59,640 --> 00:04:04,980
an HT a document<font color="#E5E5E5"> I use for some testing</font>

96
00:04:02,329 --> 00:04:07,829
<font color="#E5E5E5">highlighted I have the start with</font>

97
00:04:04,980 --> 00:04:10,980
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> minimized and without a taskbar</font>

98
00:04:07,829 --> 00:04:12,450
icon<font color="#E5E5E5"> so if you ran this it would just it</font>

99
00:04:10,980 --> 00:04:13,768
<font color="#E5E5E5">be in task manager and that'd be</font><font color="#CCCCCC"> the</font>

100
00:04:12,450 --> 00:04:16,079
<font color="#E5E5E5">only way you could actually see this</font><font color="#CCCCCC"> as</font>

101
00:04:13,769 --> 00:04:18,180
running<font color="#E5E5E5"> on the system so if a user</font>

102
00:04:16,079 --> 00:04:19,320
accidentally runs it<font color="#CCCCCC"> they're never even</font>

103
00:04:18,180 --> 00:04:21,450
<font color="#E5E5E5">going to shut it</font><font color="#CCCCCC"> off because they don't</font>

104
00:04:19,320 --> 00:04:23,400
even<font color="#E5E5E5"> know</font><font color="#CCCCCC"> what happened with it</font><font color="#E5E5E5"> the</font>

105
00:04:21,450 --> 00:04:25,770
example<font color="#E5E5E5"> here is just downloading a page</font>

106
00:04:23,400 --> 00:04:26,349
from<font color="#E5E5E5"> Google and then it's saving it to</font>

107
00:04:25,770 --> 00:04:28,750
disk

108
00:04:26,350 --> 00:04:32,230
<font color="#CCCCCC">to fancy but if you combine it</font><font color="#E5E5E5"> with the</font>

109
00:04:28,750 --> 00:04:35,410
<font color="#E5E5E5">second example</font><font color="#CCCCCC"> here I'm doing a</font><font color="#E5E5E5"> similar</font>

110
00:04:32,230 --> 00:04:37,960
<font color="#CCCCCC">thing I'm actually not hiding</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> not</font>

111
00:04:35,410 --> 00:04:40,810
hiding<font color="#E5E5E5"> in this one but uh this is using</font>

112
00:04:37,960 --> 00:04:42,400
<font color="#CCCCCC">WMI to detonate calc on the machine</font><font color="#E5E5E5"> so</font>

113
00:04:40,810 --> 00:04:44,770
with the<font color="#CCCCCC"> two you could</font><font color="#E5E5E5"> download a file</font>

114
00:04:42,400 --> 00:04:47,370
and down detonate the malware<font color="#CCCCCC"> and</font><font color="#E5E5E5"> they'd</font>

115
00:04:44,770 --> 00:04:47,370
be completely hidden

116
00:04:47,760 --> 00:04:54,460
so<font color="#CCCCCC"> ETA documents are really versatile</font>

117
00:04:50,890 --> 00:04:56,289
for attack lures<font color="#CCCCCC"> the bad guys can send</font>

118
00:04:54,460 --> 00:04:59,409
them as email attachments<font color="#CCCCCC"> that's a</font>

119
00:04:56,290 --> 00:05:00,940
common method that's been seen they can

120
00:04:59,410 --> 00:05:03,400
<font color="#CCCCCC">be used as drive-by downloads</font>

121
00:05:00,940 --> 00:05:05,920
that's like malvert izing or exploit

122
00:05:03,400 --> 00:05:09,400
kits can be<font color="#E5E5E5"> used to download the HD a</font>

123
00:05:05,920 --> 00:05:10,990
document and then sometimes<font color="#E5E5E5"> on a rare</font>

124
00:05:09,400 --> 00:05:13,210
occasion<font color="#E5E5E5"> you'll see it embedded in like</font>

125
00:05:10,990 --> 00:05:15,910
a word doc macro or something so the

126
00:05:13,210 --> 00:05:18,669
initial malware might use the<font color="#CCCCCC"> MSHDA</font><font color="#E5E5E5"> to</font>

127
00:05:15,910 --> 00:05:22,750
download an additional<font color="#CCCCCC"> HD</font><font color="#E5E5E5"> a document and</font>

128
00:05:18,670 --> 00:05:25,750
gain further functionality<font color="#CCCCCC"> have you guys</font>

129
00:05:22,750 --> 00:05:28,000
<font color="#CCCCCC">seen</font><font color="#E5E5E5"> the attack matrix</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of people</font>

130
00:05:25,750 --> 00:05:30,130
know<font color="#CCCCCC"> what it is</font><font color="#E5E5E5"> I think more more people</font>

131
00:05:28,000 --> 00:05:32,050
<font color="#E5E5E5">are</font><font color="#CCCCCC"> familiar with it now</font><font color="#E5E5E5"> a lot of talks</font>

132
00:05:30,130 --> 00:05:33,219
and stuff are bringing it up if you're

133
00:05:32,050 --> 00:05:34,540
<font color="#E5E5E5">not really familiar</font><font color="#CCCCCC"> I don't know if you</font>

134
00:05:33,220 --> 00:05:37,690
can see it<font color="#E5E5E5"> very</font><font color="#CCCCCC"> well because it's small</font>

135
00:05:34,540 --> 00:05:38,290
but<font color="#E5E5E5"> uh</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> attacker techniques and</font>

136
00:05:37,690 --> 00:05:40,570
they're all mapped to different

137
00:05:38,290 --> 00:05:44,890
<font color="#E5E5E5">categories or phases of the attacker</font>

138
00:05:40,570 --> 00:05:46,719
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> lifecycle</font><font color="#E5E5E5"> and so each J's are so</font>

139
00:05:44,890 --> 00:05:50,229
prevalent they earn their own<font color="#E5E5E5"> spot on</font>

140
00:05:46,720 --> 00:05:52,150
this matrix<font color="#CCCCCC"> if you ever are curious</font>

141
00:05:50,230 --> 00:05:54,610
about figuring<font color="#E5E5E5"> out what bad guys do just</font>

142
00:05:52,150 --> 00:05:57,669
go to the<font color="#CCCCCC"> tag matrix and start clicking</font>

143
00:05:54,610 --> 00:05:59,560
<font color="#E5E5E5">through the different items if you</font><font color="#CCCCCC"> go in</font>

144
00:05:57,670 --> 00:06:01,810
they'll give you examples of<font color="#E5E5E5"> how it's</font>

145
00:05:59,560 --> 00:06:03,400
used<font color="#E5E5E5"> how to</font><font color="#CCCCCC"> mitigate it how to detect</font>

146
00:06:01,810 --> 00:06:04,930
and hunt for<font color="#E5E5E5"> it and then they also</font>

147
00:06:03,400 --> 00:06:06,580
provide<font color="#CCCCCC"> real-world examples and</font>

148
00:06:04,930 --> 00:06:07,750
<font color="#CCCCCC">whitepapers at the bottom it's kind of</font>

149
00:06:06,580 --> 00:06:09,640
like Wikipedia<font color="#CCCCCC"> you know go</font><font color="#E5E5E5"> to the</font>

150
00:06:07,750 --> 00:06:14,170
<font color="#CCCCCC">sources and start reading what they're</font>

151
00:06:09,640 --> 00:06:16,120
talking about<font color="#E5E5E5"> so in the real world</font><font color="#CCCCCC"> a lot</font>

152
00:06:14,170 --> 00:06:19,480
<font color="#CCCCCC">of people have been</font><font color="#E5E5E5"> seeing using the MS</font>

153
00:06:16,120 --> 00:06:21,040
<font color="#E5E5E5">HTA or</font><font color="#CCCCCC"> hga documents as an exploit</font><font color="#E5E5E5"> fin 7</font>

154
00:06:19,480 --> 00:06:24,130
is a financially motivated threat group

155
00:06:21,040 --> 00:06:26,050
they they've been<font color="#E5E5E5"> seeing utilizing it</font>

156
00:06:24,130 --> 00:06:27,969
<font color="#CCCCCC">latent bot is a really sneaky</font><font color="#E5E5E5"> malware</font>

157
00:06:26,050 --> 00:06:29,980
it's been<font color="#E5E5E5"> around for a while not</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot</font>

158
00:06:27,970 --> 00:06:32,200
of<font color="#E5E5E5"> people know what's up</font><font color="#CCCCCC"> with that</font><font color="#E5E5E5"> but</font>

159
00:06:29,980 --> 00:06:34,120
that's been seen<font color="#E5E5E5"> using MSHDA muddy</font>

160
00:06:32,200 --> 00:06:36,760
waters an Iranian group and they use it

161
00:06:34,120 --> 00:06:38,410
<font color="#E5E5E5">and then pen testers love it if you went</font>

162
00:06:36,760 --> 00:06:39,840
<font color="#E5E5E5">to Dave Kennedy's keynote talk he</font>

163
00:06:38,410 --> 00:06:42,750
mentioned how

164
00:06:39,840 --> 00:06:45,030
he<font color="#E5E5E5"> uses MSHDA in his unicorn framework</font>

165
00:06:42,750 --> 00:06:49,110
he's got the<font color="#CCCCCC"> ability to generate random</font>

166
00:06:45,030 --> 00:06:53,010
<font color="#E5E5E5">HTA documents and lures and then there's</font>

167
00:06:49,110 --> 00:06:57,210
culture<font color="#E5E5E5"> the</font><font color="#CCCCCC"> msi sack that's a</font>

168
00:06:53,010 --> 00:06:59,729
multi-state<font color="#E5E5E5"> information sharing analysis</font>

169
00:06:57,210 --> 00:07:01,260
Center<font color="#CCCCCC"> claims</font><font color="#E5E5E5"> that over</font><font color="#CCCCCC"> 50 percent</font><font color="#E5E5E5"> of</font>

170
00:06:59,729 --> 00:07:02,699
the<font color="#E5E5E5"> malware they've seen this year from</font>

171
00:07:01,260 --> 00:07:05,310
<font color="#E5E5E5">all the organizations they've gathered</font>

172
00:07:02,699 --> 00:07:07,650
from<font color="#E5E5E5"> over</font><font color="#CCCCCC"> fifty percent</font><font color="#E5E5E5"> have been Kufner</font>

173
00:07:05,310 --> 00:07:10,560
infections<font color="#E5E5E5"> so this is a really prevalent</font>

174
00:07:07,650 --> 00:07:13,080
malware<font color="#CCCCCC"> it's all over the place it might</font>

175
00:07:10,560 --> 00:07:14,910
<font color="#E5E5E5">be in your organization or</font><font color="#CCCCCC"> in somebody</font>

176
00:07:13,080 --> 00:07:19,830
who knows organization or on their home

177
00:07:14,910 --> 00:07:22,470
computers<font color="#CCCCCC"> and so Kufner utilizes the HTA</font>

178
00:07:19,830 --> 00:07:25,979
document<font color="#E5E5E5"> Kufner has been seen doing</font>

179
00:07:22,470 --> 00:07:28,290
fishing<font color="#E5E5E5"> and malvert izing malvert icings</font>

180
00:07:25,979 --> 00:07:31,590
when they might go<font color="#CCCCCC"> and watch a like a</font>

181
00:07:28,290 --> 00:07:35,400
pirate sports stream or something<font color="#CCCCCC"> kind</font>

182
00:07:31,590 --> 00:07:37,710
<font color="#E5E5E5">of nefarious and the an ad will pop</font>

183
00:07:35,400 --> 00:07:39,239
<font color="#CCCCCC">before the stream saying oh you need</font><font color="#E5E5E5"> to</font>

184
00:07:37,710 --> 00:07:41,909
update<font color="#E5E5E5"> your Flash Player to watch this</font>

185
00:07:39,240 --> 00:07:44,820
<font color="#CCCCCC">and so it presents</font><font color="#E5E5E5"> a screen</font><font color="#CCCCCC"> just like</font>

186
00:07:41,910 --> 00:07:47,550
that it's a<font color="#E5E5E5"> very real looking</font><font color="#CCCCCC"> Adobe</font>

187
00:07:44,820 --> 00:07:48,930
update screen<font color="#E5E5E5"> and so a lot of people</font>

188
00:07:47,550 --> 00:07:50,760
<font color="#CCCCCC">will go oh yeah I</font><font color="#E5E5E5"> need to update my</font>

189
00:07:48,930 --> 00:07:52,860
Flash Player so I can watch<font color="#E5E5E5"> this illegal</font>

190
00:07:50,760 --> 00:07:56,190
stream I want to watch and as you can

191
00:07:52,860 --> 00:07:58,289
<font color="#E5E5E5">see it has Flash Player HTA most users</font>

192
00:07:56,190 --> 00:08:01,680
<font color="#E5E5E5">don't know what that is and</font><font color="#CCCCCC"> just want</font><font color="#E5E5E5"> to</font>

193
00:07:58,289 --> 00:08:03,919
<font color="#E5E5E5">update and watch the stream so other</font>

194
00:08:01,680 --> 00:08:08,430
popular sites<font color="#E5E5E5"> also had the malvert izing</font>

195
00:08:03,919 --> 00:08:10,469
Forbes Facebook Skype<font color="#CCCCCC"> Spotify all kinds</font>

196
00:08:08,430 --> 00:08:15,000
<font color="#CCCCCC">of</font><font color="#E5E5E5"> these popular sites all serve up the</font>

197
00:08:10,470 --> 00:08:17,460
comforter malware and so it's also a

198
00:08:15,000 --> 00:08:19,770
file<font color="#CCCCCC"> of malware and once it infects the</font>

199
00:08:17,460 --> 00:08:21,770
computer it resides in the registry<font color="#E5E5E5"> so</font>

200
00:08:19,770 --> 00:08:24,330
antivirus<font color="#E5E5E5"> has a really hard time</font>

201
00:08:21,770 --> 00:08:25,830
detecting and cleaning it<font color="#E5E5E5"> I've seen a</font>

202
00:08:24,330 --> 00:08:28,200
lot of<font color="#E5E5E5"> coveter infections where the</font>

203
00:08:25,830 --> 00:08:30,060
<font color="#E5E5E5">machine will be infected</font><font color="#CCCCCC"> for months</font><font color="#E5E5E5"> and</font>

204
00:08:28,200 --> 00:08:32,880
it'll be a<font color="#E5E5E5"> really old</font><font color="#CCCCCC"> Kufner</font><font color="#E5E5E5"> campaign</font>

205
00:08:30,060 --> 00:08:34,830
and maybe six months<font color="#E5E5E5"> later finally the</font>

206
00:08:32,880 --> 00:08:37,260
antivirus will be like oh I guess that's

207
00:08:34,830 --> 00:08:39,029
a bad file<font color="#E5E5E5"> and so it detects the dropper</font>

208
00:08:37,260 --> 00:08:43,229
but the<font color="#CCCCCC"> computers</font><font color="#E5E5E5"> still infected and has</font>

209
00:08:39,029 --> 00:08:44,580
been<font color="#E5E5E5"> infected for a long time</font><font color="#CCCCCC"> so a lot</font>

210
00:08:43,229 --> 00:08:46,230
<font color="#CCCCCC">of</font><font color="#E5E5E5"> people might not really</font><font color="#CCCCCC"> think that</font>

211
00:08:44,580 --> 00:08:48,480
Kufner is a really threatening malware

212
00:08:46,230 --> 00:08:51,000
because<font color="#E5E5E5"> its primary role is to perform</font>

213
00:08:48,480 --> 00:08:52,920
<font color="#E5E5E5">click fraud</font><font color="#CCCCCC"> and click frauds where it'll</font>

214
00:08:51,000 --> 00:08:53,670
download<font color="#E5E5E5"> advertisements and then click</font>

215
00:08:52,920 --> 00:08:57,630
and generate

216
00:08:53,670 --> 00:09:00,089
Avenue for<font color="#E5E5E5"> the attacker and so people</font>

217
00:08:57,630 --> 00:09:02,250
<font color="#E5E5E5">don't really</font><font color="#CCCCCC"> consider it a mainstream</font>

218
00:09:00,090 --> 00:09:04,860
threat<font color="#E5E5E5"> even though it is</font><font color="#CCCCCC"> very prolific</font>

219
00:09:02,250 --> 00:09:08,880
and infecting you know over<font color="#CCCCCC"> 50%</font><font color="#E5E5E5"> of the</font>

220
00:09:04,860 --> 00:09:11,160
malware cases so it has full<font color="#E5E5E5"> rack</font>

221
00:09:08,880 --> 00:09:14,870
capability though<font color="#E5E5E5"> so it can download</font>

222
00:09:11,160 --> 00:09:17,699
additional<font color="#E5E5E5"> modules and get additional</font>

223
00:09:14,870 --> 00:09:19,110
functionality on the<font color="#E5E5E5"> fly</font><font color="#CCCCCC"> and this would</font>

224
00:09:17,700 --> 00:09:22,620
happen potentially<font color="#CCCCCC"> if an attacker</font>

225
00:09:19,110 --> 00:09:24,450
realizes that the rat has landed on like

226
00:09:22,620 --> 00:09:27,240
<font color="#E5E5E5">a important organization or government</font>

227
00:09:24,450 --> 00:09:28,710
<font color="#E5E5E5">computer and I</font><font color="#CCCCCC"> don't want that to be</font><font color="#E5E5E5"> my</font>

228
00:09:27,240 --> 00:09:31,500
<font color="#E5E5E5">organization and I don't want it to be</font>

229
00:09:28,710 --> 00:09:35,790
your organization either<font color="#E5E5E5"> so I think it's</font>

230
00:09:31,500 --> 00:09:39,870
kind<font color="#CCCCCC"> of important</font><font color="#E5E5E5"> the there's a few ways</font>

231
00:09:35,790 --> 00:09:41,819
<font color="#CCCCCC">we can hump for HTA's we can look for</font>

232
00:09:39,870 --> 00:09:44,670
inbound attachments in our email systems

233
00:09:41,820 --> 00:09:47,430
<font color="#E5E5E5">you could see if people</font><font color="#CCCCCC"> have received a</font>

234
00:09:44,670 --> 00:09:52,620
<font color="#CCCCCC">chaise recently you can watch for HTS to</font>

235
00:09:47,430 --> 00:09:55,640
be downloaded in the proxy logs and then

236
00:09:52,620 --> 00:09:57,960
you can also stack the MSHDA processes

237
00:09:55,640 --> 00:09:59,310
<font color="#E5E5E5">if you're not doing this this is one of</font>

238
00:09:57,960 --> 00:10:02,070
the<font color="#E5E5E5"> most effective ways</font><font color="#CCCCCC"> to hunt</font><font color="#E5E5E5"> for</font>

239
00:09:59,310 --> 00:10:03,300
things<font color="#E5E5E5"> you stack the event execution</font>

240
00:10:02,070 --> 00:10:06,000
processes from<font color="#E5E5E5"> the entire environment</font>

241
00:10:03,300 --> 00:10:08,579
<font color="#E5E5E5">you forward them</font><font color="#CCCCCC"> to some kind of like</font>

242
00:10:06,000 --> 00:10:10,560
<font color="#CCCCCC">elk stack or Splunk</font><font color="#E5E5E5"> and then you're able</font>

243
00:10:08,580 --> 00:10:13,020
<font color="#E5E5E5">to observe things like the</font><font color="#CCCCCC"> parent-child</font>

244
00:10:10,560 --> 00:10:16,020
associations<font color="#CCCCCC"> specifically in this case</font>

245
00:10:13,020 --> 00:10:18,360
<font color="#E5E5E5">Kufner would detonate PowerShell from</font>

246
00:10:16,020 --> 00:10:19,800
the MS<font color="#E5E5E5"> HTA process and so you can very</font>

247
00:10:18,360 --> 00:10:23,310
clearly see<font color="#CCCCCC"> that</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> process</font>

248
00:10:19,800 --> 00:10:25,229
execution logs<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that would be a very</font>

249
00:10:23,310 --> 00:10:26,969
big indication<font color="#E5E5E5"> that either Kufner or</font>

250
00:10:25,230 --> 00:10:29,850
some other<font color="#CCCCCC"> malware was executing on its</font>

251
00:10:26,970 --> 00:10:34,350
system<font color="#CCCCCC"> you could also look at</font><font color="#E5E5E5"> the file</font>

252
00:10:29,850 --> 00:10:37,080
<font color="#E5E5E5">names for the execution the file names</font>

253
00:10:34,350 --> 00:10:39,180
could<font color="#E5E5E5"> be like</font><font color="#CCCCCC"> Flash Player</font><font color="#E5E5E5"> HTA or</font><font color="#CCCCCC"> a</font>

254
00:10:37,080 --> 00:10:40,080
really<font color="#CCCCCC"> random string if you saw in Dave</font>

255
00:10:39,180 --> 00:10:42,599
Kennedy<font color="#CCCCCC"> sock</font>

256
00:10:40,080 --> 00:10:46,020
he was generating<font color="#E5E5E5"> random strings for his</font>

257
00:10:42,600 --> 00:10:47,790
names and<font color="#E5E5E5"> you could also look for it to</font>

258
00:10:46,020 --> 00:10:54,120
be<font color="#CCCCCC"> reaching out to</font><font color="#E5E5E5"> remote URLs to</font>

259
00:10:47,790 --> 00:10:56,550
<font color="#E5E5E5">detonate the</font><font color="#CCCCCC"> HTA files so there's some</font>

260
00:10:54,120 --> 00:10:58,680
<font color="#E5E5E5">very basic blocks that people will</font><font color="#CCCCCC"> often</font>

261
00:10:56,550 --> 00:11:01,650
put<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the first one is to set the file</font>

262
00:10:58,680 --> 00:11:03,030
<font color="#CCCCCC">Association for the HT a</font><font color="#E5E5E5"> doc they'll set</font>

263
00:11:01,650 --> 00:11:06,449
<font color="#CCCCCC">it to</font><font color="#E5E5E5"> open with something like notepad</font>

264
00:11:03,030 --> 00:11:09,000
instead of the default<font color="#E5E5E5"> MSHDA program</font>

265
00:11:06,450 --> 00:11:13,050
and you would want<font color="#CCCCCC"> to also</font><font color="#E5E5E5"> filter</font>

266
00:11:09,000 --> 00:11:16,200
inbound emails and make sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> HJs</font>

267
00:11:13,050 --> 00:11:17,939
aren't just being<font color="#E5E5E5"> sent to your users and</font>

268
00:11:16,200 --> 00:11:19,589
then blocking at the<font color="#CCCCCC"> proxy is also a</font>

269
00:11:17,940 --> 00:11:22,310
really<font color="#CCCCCC"> effective way to</font><font color="#E5E5E5"> mitigate the</font>

270
00:11:19,589 --> 00:11:26,490
HTA's because like<font color="#E5E5E5"> I said</font><font color="#CCCCCC"> some malware</font>

271
00:11:22,310 --> 00:11:28,500
could use the remote URL feature<font color="#E5E5E5"> to</font>

272
00:11:26,490 --> 00:11:30,269
<font color="#E5E5E5">download additional payloads to</font><font color="#CCCCCC"> the</font>

273
00:11:28,500 --> 00:11:32,730
system<font color="#E5E5E5"> and so if you block</font><font color="#CCCCCC"> it at the</font>

274
00:11:30,269 --> 00:11:35,519
proxy it'll also<font color="#CCCCCC"> mitigate those kinds of</font>

275
00:11:32,730 --> 00:11:36,690
<font color="#E5E5E5">activities because</font><font color="#CCCCCC"> the under command</font>

276
00:11:35,519 --> 00:11:38,880
line with<font color="#CCCCCC"> MSHDA</font>

277
00:11:36,690 --> 00:11:41,699
if you feed it<font color="#CCCCCC"> the</font><font color="#E5E5E5"> URL and you</font>

278
00:11:38,880 --> 00:11:45,439
<font color="#E5E5E5">explicitly call MSHDA</font><font color="#CCCCCC"> that will bypass</font>

279
00:11:41,699 --> 00:11:47,790
<font color="#E5E5E5">the</font><font color="#CCCCCC"> file association</font><font color="#E5E5E5"> that's occurring</font>

280
00:11:45,440 --> 00:11:49,980
<font color="#CCCCCC">and you</font><font color="#E5E5E5"> want to push out these changes</font>

281
00:11:47,790 --> 00:11:51,480
via<font color="#E5E5E5"> SCCM most of you if you're</font><font color="#CCCCCC"> running</font>

282
00:11:49,980 --> 00:11:53,670
<font color="#CCCCCC">Windows will have the configuration</font>

283
00:11:51,480 --> 00:11:55,440
<font color="#E5E5E5">manager to deploy the</font><font color="#CCCCCC"> configurations</font><font color="#E5E5E5"> to</font>

284
00:11:53,670 --> 00:11:58,469
the environment there's a default

285
00:11:55,440 --> 00:11:59,910
<font color="#E5E5E5">setting in GPO that you can use to set</font>

286
00:11:58,470 --> 00:12:08,579
the file associations on all the

287
00:11:59,910 --> 00:12:12,480
computers so defense-in-depth is really

288
00:12:08,579 --> 00:12:14,219
important<font color="#E5E5E5"> the issue that I saw was we</font>

289
00:12:12,480 --> 00:12:16,380
had it configured so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> no pad would</font>

290
00:12:14,220 --> 00:12:18,269
open the<font color="#CCCCCC"> HDA documents but</font><font color="#E5E5E5"> I was still</font>

291
00:12:16,380 --> 00:12:20,820
seeing<font color="#E5E5E5"> Kufner infections and things</font>

292
00:12:18,269 --> 00:12:22,649
coming<font color="#CCCCCC"> into the network and we didn't</font>

293
00:12:20,820 --> 00:12:24,930
understand I I knew those shouldn't be

294
00:12:22,649 --> 00:12:27,089
happening<font color="#CCCCCC"> because if the user opens the</font>

295
00:12:24,930 --> 00:12:29,849
<font color="#CCCCCC">hga document it should just pop in</font>

296
00:12:27,089 --> 00:12:33,860
notepad and nothing should happen<font color="#E5E5E5"> so the</font>

297
00:12:29,850 --> 00:12:36,600
question was why<font color="#E5E5E5"> why were we seeing</font><font color="#CCCCCC"> an</font>

298
00:12:33,860 --> 00:12:38,459
alert for further down in the<font color="#E5E5E5"> kill chain</font>

299
00:12:36,600 --> 00:12:43,050
that<font color="#E5E5E5"> should have been mitigated</font><font color="#CCCCCC"> higher</font>

300
00:12:38,459 --> 00:12:46,199
up<font color="#E5E5E5"> and so I as a good analyst I went and</font>

301
00:12:43,050 --> 00:12:49,140
performed<font color="#E5E5E5"> remote</font><font color="#CCCCCC"> root cause analysis</font><font color="#E5E5E5"> and</font>

302
00:12:46,199 --> 00:12:51,540
I could see<font color="#E5E5E5"> that the files that were</font>

303
00:12:49,140 --> 00:12:53,550
being detonated<font color="#E5E5E5"> were downloading to a</font>

304
00:12:51,540 --> 00:12:55,110
temporary<font color="#E5E5E5"> internet cache and then</font>

305
00:12:53,550 --> 00:12:56,819
executing from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> temporary internet</font>

306
00:12:55,110 --> 00:12:59,399
cache<font color="#E5E5E5"> so I was</font><font color="#CCCCCC"> able to come up</font><font color="#E5E5E5"> with the</font>

307
00:12:56,819 --> 00:13:01,560
assumption that the open instead<font color="#E5E5E5"> of save</font>

308
00:12:59,399 --> 00:13:10,260
<font color="#E5E5E5">function and Internet Explorer was being</font>

309
00:13:01,560 --> 00:13:12,479
used to<font color="#CCCCCC"> execute the files</font><font color="#E5E5E5"> so the that</font>

310
00:13:10,260 --> 00:13:14,550
allowed me to then replicate the

311
00:13:12,480 --> 00:13:16,170
activity<font color="#E5E5E5"> I went and found</font><font color="#CCCCCC"> an HT a that</font>

312
00:13:14,550 --> 00:13:18,000
was sitting<font color="#E5E5E5"> on the internet that I knew</font>

313
00:13:16,170 --> 00:13:19,020
was benign<font color="#E5E5E5"> and I actually went and</font>

314
00:13:18,000 --> 00:13:21,660
detonated it

315
00:13:19,020 --> 00:13:23,640
<font color="#E5E5E5">Leon a machine I clicked</font><font color="#CCCCCC"> open and it</font>

316
00:13:21,660 --> 00:13:26,569
worked and<font color="#E5E5E5"> I was like oh so that's</font>

317
00:13:23,640 --> 00:13:28,890
definitely<font color="#E5E5E5"> what's happening in this case</font>

318
00:13:26,570 --> 00:13:30,990
but I didn't really understand why<font color="#CCCCCC"> for a</font>

319
00:13:28,890 --> 00:13:33,050
long time<font color="#CCCCCC"> I had to look around quite a</font>

320
00:13:30,990 --> 00:13:35,610
bit<font color="#CCCCCC"> and</font><font color="#E5E5E5"> do a lot of research</font><font color="#CCCCCC"> and</font>

321
00:13:33,050 --> 00:13:37,829
<font color="#E5E5E5">eventually I came across what's called</font>

322
00:13:35,610 --> 00:13:41,520
the<font color="#CCCCCC"> mime type database or many of you</font>

323
00:13:37,830 --> 00:13:42,360
familiar<font color="#E5E5E5"> with mime types let's do some</font>

324
00:13:41,520 --> 00:13:44,939
<font color="#E5E5E5">Oh</font>

325
00:13:42,360 --> 00:13:47,400
so the mime type<font color="#E5E5E5"> is the multi-purpose</font>

326
00:13:44,940 --> 00:13:50,430
<font color="#E5E5E5">internet mail extension program yeah</font>

327
00:13:47,400 --> 00:13:54,390
yeah yeah<font color="#CCCCCC"> multi-purpose internet mail</font>

328
00:13:50,430 --> 00:13:55,920
extensions<font color="#E5E5E5"> the the mime type is</font>

329
00:13:54,390 --> 00:14:00,449
typically thought<font color="#CCCCCC"> of being used with</font>

330
00:13:55,920 --> 00:14:02,760
<font color="#CCCCCC">SMTP standards but really HTTP or any</font>

331
00:14:00,450 --> 00:14:06,750
<font color="#E5E5E5">network communication protocol will</font>

332
00:14:02,760 --> 00:14:09,630
follow like the mime<font color="#CCCCCC"> type RFC s</font><font color="#E5E5E5"> and in</font>

333
00:14:06,750 --> 00:14:11,760
this case<font color="#E5E5E5"> Internet Explorer</font><font color="#CCCCCC"> respect to</font>

334
00:14:09,630 --> 00:14:15,360
<font color="#E5E5E5">this mime type database in registry</font>

335
00:14:11,760 --> 00:14:18,660
<font color="#E5E5E5">there you can see what the registry key</font>

336
00:14:15,360 --> 00:14:24,900
structure looks like<font color="#E5E5E5"> this is under the H</font>

337
00:14:18,660 --> 00:14:26,880
key<font color="#CCCCCC"> classes root</font><font color="#E5E5E5"> hive and so normally</font>

338
00:14:24,900 --> 00:14:29,550
<font color="#E5E5E5">you would think it would save the file</font>

339
00:14:26,880 --> 00:14:31,920
to<font color="#CCCCCC"> disk for HTA's and then use the file</font>

340
00:14:29,550 --> 00:14:33,780
<font color="#CCCCCC">Association</font><font color="#E5E5E5"> that's said in registry but</font>

341
00:14:31,920 --> 00:14:37,530
in when you click<font color="#CCCCCC"> open it treats it like</font>

342
00:14:33,780 --> 00:14:40,040
a live web document and so it chooses

343
00:14:37,530 --> 00:14:45,540
<font color="#E5E5E5">the application based on a different</font>

344
00:14:40,040 --> 00:14:49,469
registry so here's a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> what it</font>

345
00:14:45,540 --> 00:14:52,620
looks like I queried<font color="#E5E5E5"> the application HT</font>

346
00:14:49,470 --> 00:14:56,160
a and that points you to a class ID and

347
00:14:52,620 --> 00:14:58,740
that<font color="#CCCCCC"> class ID is a gooood</font><font color="#E5E5E5"> that then you</font>

348
00:14:56,160 --> 00:15:01,670
can query<font color="#E5E5E5"> and you can see how it's still</font>

349
00:14:58,740 --> 00:15:04,050
configured to<font color="#E5E5E5"> detonate MSHDA</font>

350
00:15:01,670 --> 00:15:07,319
<font color="#CCCCCC">and you think it'd be</font><font color="#E5E5E5"> this simple right</font>

351
00:15:04,050 --> 00:15:09,030
<font color="#E5E5E5">but there's actually more to kind of</font>

352
00:15:07,320 --> 00:15:11,220
like because we could<font color="#E5E5E5"> change this key</font>

353
00:15:09,030 --> 00:15:12,810
now<font color="#E5E5E5"> in addition</font><font color="#CCCCCC"> to setting the file</font>

354
00:15:11,220 --> 00:15:15,600
<font color="#E5E5E5">Association and that would block the</font>

355
00:15:12,810 --> 00:15:18,510
additional behavior<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> also need to</font>

356
00:15:15,600 --> 00:15:20,760
<font color="#E5E5E5">be</font><font color="#CCCCCC"> sure to block it in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> 64-bit</font><font color="#E5E5E5"> or</font>

357
00:15:18,510 --> 00:15:24,270
this is actually<font color="#CCCCCC"> the 32 bit hive within</font>

358
00:15:20,760 --> 00:15:26,720
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> make sure you</font>

359
00:15:24,270 --> 00:15:26,720
change both

360
00:15:30,650 --> 00:15:39,350
<font color="#E5E5E5">about it so ultimately if you can if</font>

361
00:15:37,040 --> 00:15:41,150
your organization<font color="#E5E5E5"> isn't using MSHDA for</font>

362
00:15:39,350 --> 00:15:43,520
anything legitimate<font color="#E5E5E5"> you'd want to lock</font>

363
00:15:41,150 --> 00:15:46,160
it<font color="#CCCCCC"> down using</font><font color="#E5E5E5"> app Locker or the software</font>

364
00:15:43,520 --> 00:15:47,329
restriction policies<font color="#CCCCCC"> you have to be</font><font color="#E5E5E5"> kind</font>

365
00:15:46,160 --> 00:15:49,130
of careful with this<font color="#CCCCCC"> because there are</font>

366
00:15:47,330 --> 00:15:52,550
<font color="#E5E5E5">some underlying systems that might be</font>

367
00:15:49,130 --> 00:15:54,590
<font color="#CCCCCC">using the MSHDA</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> I'm Windows 10</font>

368
00:15:52,550 --> 00:15:56,120
there's some weird<font color="#CCCCCC"> subsystems so you'd</font>

369
00:15:54,590 --> 00:15:58,640
<font color="#E5E5E5">want to be really careful</font><font color="#CCCCCC"> when deploying</font>

370
00:15:56,120 --> 00:15:59,930
those configurations but<font color="#E5E5E5"> this is by far</font>

371
00:15:58,640 --> 00:16:01,970
the best method if<font color="#CCCCCC"> you can really</font>

372
00:15:59,930 --> 00:16:15,829
restrict and prevent<font color="#CCCCCC"> anything that's not</font>

373
00:16:01,970 --> 00:16:17,690
supposed<font color="#E5E5E5"> to be using MSHDA</font><font color="#CCCCCC"> so you know</font>

374
00:16:15,830 --> 00:16:20,450
make sure<font color="#CCCCCC"> that nobody in your company is</font>

375
00:16:17,690 --> 00:16:23,770
using<font color="#E5E5E5"> it in large organizations that</font>

376
00:16:20,450 --> 00:16:33,740
often be somebody somewhere<font color="#E5E5E5"> using it</font>

377
00:16:23,770 --> 00:16:37,490
that's it questions that's the Microsoft

378
00:16:33,740 --> 00:16:40,280
HTML<font color="#E5E5E5"> application so MSHDA is a native</font>

379
00:16:37,490 --> 00:16:44,060
binary within system<font color="#CCCCCC"> 32 that</font><font color="#E5E5E5"> is used to</font>

380
00:16:40,280 --> 00:16:45,740
execute right you can see the<font color="#CCCCCC"> path there</font>

381
00:16:44,060 --> 00:16:48,859
it's actually<font color="#CCCCCC"> in two</font><font color="#E5E5E5"> locations there</font><font color="#CCCCCC"> too</font>

382
00:16:45,740 --> 00:16:52,250
because<font color="#CCCCCC"> a 32-bit application will run</font>

383
00:16:48,860 --> 00:16:55,100
under<font color="#E5E5E5"> the SIS</font><font color="#CCCCCC"> while 64 and then on a</font>

384
00:16:52,250 --> 00:17:09,740
<font color="#E5E5E5">64-bit system</font><font color="#CCCCCC"> the system 32 MSHDA will</font>

385
00:16:55,100 --> 00:17:12,620
be used say it<font color="#E5E5E5"> again the that HTA</font><font color="#CCCCCC"> oh so</font>

386
00:17:09,740 --> 00:17:17,390
<font color="#CCCCCC">H key classes</font><font color="#E5E5E5"> Roo is a set of all the</font>

387
00:17:12,619 --> 00:17:20,929
classes on a system<font color="#E5E5E5"> that are defined</font><font color="#CCCCCC"> so</font>

388
00:17:17,390 --> 00:17:23,690
I don't<font color="#E5E5E5"> have an example of right now but</font>

389
00:17:20,930 --> 00:17:25,820
<font color="#E5E5E5">so there's many types of classes on a</font>

390
00:17:23,690 --> 00:17:29,560
system that they're all different<font color="#E5E5E5"> types</font>

391
00:17:25,819 --> 00:17:33,580
in programming that are defined and so

392
00:17:29,560 --> 00:17:33,580
<font color="#CCCCCC">HTA is both a</font>

393
00:17:39,570 --> 00:17:45,310
yes<font color="#CCCCCC"> so within the classes</font><font color="#E5E5E5"> route</font><font color="#CCCCCC"> drive</font>

394
00:17:43,540 --> 00:17:47,950
which has a general set of<font color="#E5E5E5"> classes</font>

395
00:17:45,310 --> 00:17:50,550
<font color="#E5E5E5">there's actually the subset of the mime</font>

396
00:17:47,950 --> 00:17:53,310
type<font color="#CCCCCC"> and so this mind</font><font color="#E5E5E5"> database is</font>

397
00:17:50,550 --> 00:17:57,250
special set<font color="#CCCCCC"> of information</font><font color="#E5E5E5"> within the</font>

398
00:17:53,310 --> 00:17:59,050
<font color="#CCCCCC">general class definitions</font><font color="#E5E5E5"> yeah well and</font>

399
00:17:57,250 --> 00:18:03,400
and so this is an association<font color="#E5E5E5"> so when</font>

400
00:17:59,050 --> 00:18:05,860
the application identifies<font color="#E5E5E5"> oh it's this</font>

401
00:18:03,400 --> 00:18:08,050
type of<font color="#CCCCCC"> mind I need</font><font color="#E5E5E5"> to use these types</font>

402
00:18:05,860 --> 00:18:09,639
<font color="#E5E5E5">of</font><font color="#CCCCCC"> applications</font><font color="#E5E5E5"> to open it and it</font>

403
00:18:08,050 --> 00:18:11,649
creates that<font color="#CCCCCC"> Association so it knows</font>

404
00:18:09,640 --> 00:18:15,430
where to go<font color="#CCCCCC"> on disk to launch the</font>

405
00:18:11,650 --> 00:18:19,120
application<font color="#E5E5E5"> yeah and there's several if</font>

406
00:18:15,430 --> 00:18:20,860
you look within<font color="#E5E5E5"> this this path</font><font color="#CCCCCC"> there's</font>

407
00:18:19,120 --> 00:18:23,830
actually a ton of applications<font color="#CCCCCC"> therefore</font>

408
00:18:20,860 --> 00:18:25,270
<font color="#CCCCCC">like if it was a Windows Media File</font><font color="#E5E5E5"> it</font>

409
00:18:23,830 --> 00:18:26,980
would<font color="#CCCCCC"> download it and</font><font color="#E5E5E5"> go oh I should</font>

410
00:18:25,270 --> 00:18:30,970
open<font color="#CCCCCC"> with Windows Media Player</font><font color="#E5E5E5"> or</font>

411
00:18:26,980 --> 00:18:33,070
something like<font color="#E5E5E5"> that yes or well</font>

412
00:18:30,970 --> 00:18:35,950
technically with mime it would be a mime

413
00:18:33,070 --> 00:18:38,679
type it doesn't respect<font color="#E5E5E5"> the extension so</font>

414
00:18:35,950 --> 00:18:40,540
if the HTTP connection when you download

415
00:18:38,680 --> 00:18:42,760
it the<font color="#E5E5E5"> connection will actually have a</font>

416
00:18:40,540 --> 00:18:44,620
mime type defined within<font color="#E5E5E5"> it and so you</font>

417
00:18:42,760 --> 00:18:47,230
could<font color="#E5E5E5"> have different you could have a</font>

418
00:18:44,620 --> 00:18:49,300
dot txt<font color="#E5E5E5"> but still provided with a mime</font>

419
00:18:47,230 --> 00:18:59,620
type<font color="#E5E5E5"> and so it would respect the mime</font>

420
00:18:49,300 --> 00:19:02,379
type over the<font color="#E5E5E5"> file Association yeah yeah</font>

421
00:18:59,620 --> 00:19:03,760
the file extensions can<font color="#E5E5E5"> be yeah</font>

422
00:19:02,380 --> 00:19:07,900
depending on the<font color="#CCCCCC"> situation they're</font>

423
00:19:03,760 --> 00:19:20,590
pretty ignored or useless<font color="#E5E5E5"> cool any other</font>

424
00:19:07,900 --> 00:19:22,660
questions there's a lot of<font color="#CCCCCC"> ways you</font>

425
00:19:20,590 --> 00:19:24,280
<font color="#E5E5E5">could do that you</font><font color="#CCCCCC"> could train them to</font>

426
00:19:22,660 --> 00:19:26,380
launch it on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> command line it's kind</font>

427
00:19:24,280 --> 00:19:28,450
<font color="#CCCCCC">of iffy you could create batch files</font>

428
00:19:26,380 --> 00:19:30,160
<font color="#CCCCCC">that would automatically</font><font color="#E5E5E5"> type the</font>

429
00:19:28,450 --> 00:19:32,050
command line so they just<font color="#CCCCCC"> double-click a</font>

430
00:19:30,160 --> 00:19:34,170
batch file instead<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the document</font>

431
00:19:32,050 --> 00:19:34,169
itself

432
00:19:34,780 --> 00:19:39,370
you could also<font color="#E5E5E5"> depending on the scenario</font>

433
00:19:36,820 --> 00:19:41,679
provide entitlements where they could a

434
00:19:39,370 --> 00:19:43,840
lot be allowed unrestricted access to

435
00:19:41,680 --> 00:19:45,220
MSHDA<font color="#E5E5E5"> so there's a lot of different ways</font>

436
00:19:43,840 --> 00:19:48,850
depending<font color="#CCCCCC"> on your business processes</font>

437
00:19:45,220 --> 00:19:50,150
<font color="#CCCCCC">that you could configure it any other</font>

438
00:19:48,850 --> 00:20:00,620
<font color="#E5E5E5">questions</font>

439
00:19:50,150 --> 00:20:04,630
oh<font color="#E5E5E5"> it depends whether or not you're</font>

440
00:20:00,620 --> 00:20:04,629
<font color="#CCCCCC">doing SSL intercept with your proxy</font>

441
00:20:05,020 --> 00:20:10,790
would highly recommend<font color="#CCCCCC"> performing that</font><font color="#E5E5E5"> a</font>

442
00:20:07,700 --> 00:20:12,740
lot of<font color="#E5E5E5"> main proxies will do that like</font>

443
00:20:10,790 --> 00:20:22,010
<font color="#CCCCCC">Bluecoat will perform different</font>

444
00:20:12,740 --> 00:20:39,860
inspection like that for you you<font color="#CCCCCC"> first</font>

445
00:20:22,010 --> 00:20:41,600
<font color="#E5E5E5">Nick I have not done</font><font color="#CCCCCC"> that kind</font><font color="#E5E5E5"> of</font>

446
00:20:39,860 --> 00:20:43,790
research yet<font color="#E5E5E5"> but I would think that</font>

447
00:20:41,600 --> 00:20:47,209
<font color="#E5E5E5">maybe edge would do something like this</font>

448
00:20:43,790 --> 00:20:49,220
I think<font color="#E5E5E5"> Skype or maybe Spotify because</font>

449
00:20:47,210 --> 00:20:51,800
the apps I think are<font color="#CCCCCC"> seeing watching</font>

450
00:20:49,220 --> 00:20:54,380
those kinds of<font color="#E5E5E5"> things as</font><font color="#CCCCCC"> well and so</font><font color="#E5E5E5"> I</font>

451
00:20:51,800 --> 00:20:56,180
setting the<font color="#CCCCCC"> configuration here would</font>

452
00:20:54,380 --> 00:20:58,070
definitely mitigate those additional

453
00:20:56,180 --> 00:21:00,200
applications<font color="#E5E5E5"> because they'll do the same</font>

454
00:20:58,070 --> 00:21:02,780
mime type<font color="#CCCCCC"> lookup in the registry and</font>

455
00:21:00,200 --> 00:21:04,250
then you already<font color="#CCCCCC"> have it mitigated when</font>

456
00:21:02,780 --> 00:21:06,050
it goes oh I'm<font color="#CCCCCC"> gonna resolve and still</font>

457
00:21:04,250 --> 00:21:08,170
open with no pad<font color="#E5E5E5"> instead of something</font>

458
00:21:06,050 --> 00:21:08,169
else

459
00:21:21,940 --> 00:21:26,120
so there's a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> sis admin tools</font>

460
00:21:24,260 --> 00:21:28,370
sometimes<font color="#E5E5E5"> developers will just make</font>

461
00:21:26,120 --> 00:21:30,469
something<font color="#E5E5E5"> custom where oh it's really</font>

462
00:21:28,370 --> 00:21:32,810
<font color="#CCCCCC">easy I know HTML so I'm</font><font color="#E5E5E5"> gonna write an</font>

463
00:21:30,470 --> 00:21:34,580
HTML front-end for<font color="#E5E5E5"> this tool instead of</font>

464
00:21:32,810 --> 00:21:36,290
doing something<font color="#CCCCCC"> that's more</font><font color="#E5E5E5"> complex or</font>

465
00:21:34,580 --> 00:21:39,080
using like a different library<font color="#E5E5E5"> to</font>

466
00:21:36,290 --> 00:21:40,760
generate their forms<font color="#E5E5E5"> um and then</font>

467
00:21:39,080 --> 00:21:42,770
sometimes developers will facilitate

468
00:21:40,760 --> 00:21:44,180
like a normal business process where

469
00:21:42,770 --> 00:21:45,530
they make a<font color="#CCCCCC"> dashboard or something that</font>

470
00:21:44,180 --> 00:21:47,360
automatically queries a whole bunch of

471
00:21:45,530 --> 00:22:05,420
<font color="#E5E5E5">information</font><font color="#CCCCCC"> from the network and then</font>

472
00:21:47,360 --> 00:22:12,080
presents it on the screen any other

473
00:22:05,420 --> 00:22:18,119
questions<font color="#CCCCCC"> all right thank you</font>

474
00:22:12,080 --> 00:22:18,119
[Applause]

