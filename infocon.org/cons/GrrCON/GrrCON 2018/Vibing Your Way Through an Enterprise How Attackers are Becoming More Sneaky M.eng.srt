1
00:00:05,029 --> 00:00:11,250
<font color="#E5E5E5">okay so this is</font><font color="#CCCCCC"> my talk</font><font color="#E5E5E5"> vibing your way</font>

2
00:00:08,130 --> 00:00:13,769
through the enterprise<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bit about</font>

3
00:00:11,250 --> 00:00:15,389
myself<font color="#E5E5E5"> before we get started</font><font color="#CCCCCC"> my name is</font>

4
00:00:13,769 --> 00:00:18,119
<font color="#E5E5E5">matthew Adelberg</font><font color="#CCCCCC"> I'm a</font><font color="#E5E5E5"> senior security</font>

5
00:00:15,389 --> 00:00:20,970
<font color="#E5E5E5">consultant for Optive in their attack</font>

6
00:00:18,119 --> 00:00:23,910
and penetration team<font color="#CCCCCC"> my goal my</font><font color="#E5E5E5"> role</font>

7
00:00:20,970 --> 00:00:26,580
<font color="#E5E5E5">primarily red teaming enemy threat</font>

8
00:00:23,910 --> 00:00:29,550
replication internal external<font color="#E5E5E5"> threats</font>

9
00:00:26,580 --> 00:00:31,229
<font color="#CCCCCC">spearfishing that type of</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> and</font>

10
00:00:29,550 --> 00:00:33,750
<font color="#E5E5E5">that's kind of where a lot</font><font color="#CCCCCC"> of this talk</font>

11
00:00:31,230 --> 00:00:38,760
kind<font color="#E5E5E5"> of was created from the experiences</font>

12
00:00:33,750 --> 00:00:41,040
that we see so to begin<font color="#CCCCCC"> I like to use</font>

13
00:00:38,760 --> 00:00:43,260
this diagram<font color="#CCCCCC"> as a great way to explain</font>

14
00:00:41,040 --> 00:00:45,839
like<font color="#CCCCCC"> the current trends that we see as</font>

15
00:00:43,260 --> 00:00:47,940
threat replicators<font color="#CCCCCC"> you can see at the</font>

16
00:00:45,840 --> 00:00:52,020
bottom<font color="#CCCCCC"> the attackers who are successful</font>

17
00:00:47,940 --> 00:00:53,670
<font color="#E5E5E5">as well as the ones that</font><font color="#CCCCCC"> are caught when</font>

18
00:00:52,020 --> 00:00:55,610
I try<font color="#E5E5E5"> to try to use this analogy it's</font>

19
00:00:53,670 --> 00:00:58,079
more so to illustrate the<font color="#CCCCCC"> fact is that</font>

20
00:00:55,610 --> 00:01:01,140
<font color="#E5E5E5">network defenses are great they</font><font color="#CCCCCC"> are</font>

21
00:00:58,079 --> 00:01:02,699
catching<font color="#CCCCCC"> a lot of important attacks</font><font color="#E5E5E5"> but</font>

22
00:01:01,140 --> 00:01:05,939
there's<font color="#E5E5E5"> still many that get through and</font>

23
00:01:02,699 --> 00:01:07,679
companies are<font color="#E5E5E5"> unaware of it and because</font>

24
00:01:05,939 --> 00:01:10,289
<font color="#CCCCCC">of this this trend is becoming more</font><font color="#E5E5E5"> and</font>

25
00:01:07,680 --> 00:01:12,750
more common<font color="#E5E5E5"> that companies are being</font>

26
00:01:10,290 --> 00:01:15,150
popped or compromised without<font color="#E5E5E5"> being</font>

27
00:01:12,750 --> 00:01:17,220
aware<font color="#E5E5E5"> of it until information kind of</font>

28
00:01:15,150 --> 00:01:21,840
gets leaked out<font color="#E5E5E5"> may be sensitive stuff</font>

29
00:01:17,220 --> 00:01:24,119
is showing up on public sources<font color="#E5E5E5"> and it</font>

30
00:01:21,840 --> 00:01:25,590
kind of has<font color="#CCCCCC"> changed how people kind of</font>

31
00:01:24,119 --> 00:01:27,869
accept the fact that it's<font color="#CCCCCC"> not a</font><font color="#E5E5E5"> matter</font>

32
00:01:25,590 --> 00:01:29,100
of if their companies<font color="#CCCCCC"> and organization</font>

33
00:01:27,869 --> 00:01:32,490
is<font color="#E5E5E5"> going to get compromised it's a</font>

34
00:01:29,100 --> 00:01:35,189
matter<font color="#CCCCCC"> of when and</font><font color="#E5E5E5"> the simple</font><font color="#CCCCCC"> fact is</font>

35
00:01:32,490 --> 00:01:38,070
attackers will always find a way<font color="#E5E5E5"> in</font>

36
00:01:35,189 --> 00:01:41,639
<font color="#CCCCCC">spear phishing</font><font color="#E5E5E5"> campaigns have always</font>

37
00:01:38,070 --> 00:01:43,710
been successful<font color="#CCCCCC"> they always will be</font><font color="#E5E5E5"> what</font>

38
00:01:41,640 --> 00:01:47,880
<font color="#E5E5E5">all it takes is one</font><font color="#CCCCCC"> user to click</font><font color="#E5E5E5"> on a</font>

39
00:01:43,710 --> 00:01:49,919
<font color="#E5E5E5">link and someone's in we still see weak</font>

40
00:01:47,880 --> 00:01:53,399
passwords<font color="#E5E5E5"> prevalent still in the year</font>

41
00:01:49,920 --> 00:01:55,890
2018 like pass you know<font color="#E5E5E5"> using the season</font>

42
00:01:53,399 --> 00:01:59,490
in the year as a password structure<font color="#E5E5E5"> that</font>

43
00:01:55,890 --> 00:02:02,399
is quite easy<font color="#CCCCCC"> to figure out</font><font color="#E5E5E5"> and we still</font>

44
00:01:59,490 --> 00:02:04,380
have high success as well<font color="#CCCCCC"> as we all know</font>

45
00:02:02,399 --> 00:02:06,930
that there are constant security flaws

46
00:02:04,380 --> 00:02:09,359
<font color="#CCCCCC">zero</font><font color="#E5E5E5"> days miss configurations that are</font>

47
00:02:06,930 --> 00:02:11,280
<font color="#CCCCCC">always going to exist as products change</font>

48
00:02:09,360 --> 00:02:13,970
new features get added they don't get

49
00:02:11,280 --> 00:02:13,970
<font color="#E5E5E5">properly vetted</font>

50
00:02:13,990 --> 00:02:19,180
so lateral movement

51
00:02:16,960 --> 00:02:21,250
once the an attacker or a dresser<font color="#CCCCCC"> has</font>

52
00:02:19,180 --> 00:02:22,420
gone in they need to figure out where

53
00:02:21,250 --> 00:02:23,590
they're<font color="#E5E5E5"> gonna go what how do they</font>

54
00:02:22,420 --> 00:02:26,829
achieve<font color="#E5E5E5"> their goal is it</font>

55
00:02:23,590 --> 00:02:30,130
acquiring<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know business related data</font>

56
00:02:26,830 --> 00:02:31,630
<font color="#CCCCCC">trade secrets credit card data</font><font color="#E5E5E5"> they need</font>

57
00:02:30,130 --> 00:02:34,120
to know how to<font color="#E5E5E5"> get there they need</font><font color="#CCCCCC"> to</font>

58
00:02:31,630 --> 00:02:35,680
<font color="#E5E5E5">kind of know how to get from point A to</font>

59
00:02:34,120 --> 00:02:37,750
point B and<font color="#E5E5E5"> it's usually typically</font>

60
00:02:35,680 --> 00:02:39,820
through moving from one machine<font color="#CCCCCC"> or</font>

61
00:02:37,750 --> 00:02:43,900
<font color="#CCCCCC">system to</font><font color="#E5E5E5"> another and this is primarily</font>

62
00:02:39,820 --> 00:02:46,870
using credentials<font color="#CCCCCC"> and these credentials</font>

63
00:02:43,900 --> 00:02:50,050
are often used you know<font color="#E5E5E5"> SMB login RDP</font>

64
00:02:46,870 --> 00:02:52,000
features that are built<font color="#CCCCCC"> into Windows</font>

65
00:02:50,050 --> 00:02:54,070
environments that<font color="#CCCCCC"> are used for</font><font color="#E5E5E5"> system</font>

66
00:02:52,000 --> 00:02:57,730
administration business functions and

67
00:02:54,070 --> 00:02:59,769
there really are not bugs<font color="#CCCCCC"> their</font><font color="#E5E5E5"> features</font>

68
00:02:57,730 --> 00:03:01,480
and<font color="#E5E5E5"> that's what makes it hard to kind of</font>

69
00:02:59,770 --> 00:03:03,670
lock them down<font color="#E5E5E5"> and prevent this type of</font>

70
00:03:01,480 --> 00:03:08,019
movement<font color="#E5E5E5"> because they're really needed</font>

71
00:03:03,670 --> 00:03:10,179
<font color="#CCCCCC">for business operations so I like to</font>

72
00:03:08,020 --> 00:03:12,340
<font color="#CCCCCC">think of lateral movement as</font><font color="#E5E5E5"> a three</font>

73
00:03:10,180 --> 00:03:14,650
<font color="#E5E5E5">phase kind of technique</font><font color="#CCCCCC"> your first phase</font>

74
00:03:12,340 --> 00:03:19,800
is your domain reconnaissance this is

75
00:03:14,650 --> 00:03:19,800
trying<font color="#E5E5E5"> to figure</font><font color="#CCCCCC"> out where what's</font>

76
00:03:42,070 --> 00:03:46,280
there's been cases<font color="#CCCCCC"> of Ebola going around</font>

77
00:03:44,780 --> 00:03:49,630
if you<font color="#E5E5E5"> have a mild fever sore throat</font>

78
00:03:46,280 --> 00:04:09,220
<font color="#CCCCCC">other</font><font color="#E5E5E5"> symptoms come and get some Lysol</font>

79
00:03:49,630 --> 00:04:12,680
or Febreze thank you okay moving<font color="#E5E5E5"> on</font>

80
00:04:09,220 --> 00:04:14,210
so three phases<font color="#E5E5E5"> of lateral</font><font color="#CCCCCC"> movement what</font>

81
00:04:12,680 --> 00:04:16,700
I like to call<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first one is domain</font>

82
00:04:14,210 --> 00:04:18,710
reconnaissance<font color="#E5E5E5"> that is looking</font><font color="#CCCCCC"> to</font>

83
00:04:16,700 --> 00:04:21,200
<font color="#E5E5E5">understand what is in the</font><font color="#CCCCCC"> environment</font>

84
00:04:18,709 --> 00:04:22,609
and what you know permissions and

85
00:04:21,200 --> 00:04:25,099
objects are in there we see<font color="#CCCCCC"> that with</font>

86
00:04:22,610 --> 00:04:27,830
like<font color="#CCCCCC"> windows core commands net commands</font>

87
00:04:25,100 --> 00:04:31,220
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> even like the</font><font color="#CCCCCC"> in packet tool</font>

88
00:04:27,830 --> 00:04:32,870
<font color="#CCCCCC">sweet net view and then the</font><font color="#E5E5E5"> actual act</font>

89
00:04:31,220 --> 00:04:35,090
of compromising system so that we

90
00:04:32,870 --> 00:04:36,290
there's a lot of talk<font color="#CCCCCC"> and research</font>

91
00:04:35,090 --> 00:04:38,659
that's always<font color="#E5E5E5"> been around</font><font color="#CCCCCC"> about</font>

92
00:04:36,290 --> 00:04:40,330
compromise you know<font color="#CCCCCC"> Spectre offices just</font>

93
00:04:38,660 --> 00:04:43,850
released a bunch of new tools<font color="#E5E5E5"> for</font>

94
00:04:40,330 --> 00:04:47,930
<font color="#E5E5E5">c-sharp</font><font color="#CCCCCC"> based WMI execution of pouch</font>

95
00:04:43,850 --> 00:04:49,400
payloads<font color="#E5E5E5"> and then acquiring credentials</font>

96
00:04:47,930 --> 00:04:52,730
that<font color="#E5E5E5"> could be</font><font color="#CCCCCC"> Mimi cats or any other</font>

97
00:04:49,400 --> 00:04:54,919
tools<font color="#E5E5E5"> so compromising and credential</font>

98
00:04:52,730 --> 00:04:59,990
fact<font color="#E5E5E5"> really been the focus</font><font color="#CCCCCC"> of a lot of</font>

99
00:04:54,920 --> 00:05:01,130
<font color="#CCCCCC">research and innovation but this talk is</font>

100
00:04:59,990 --> 00:05:03,680
<font color="#CCCCCC">really going</font><font color="#E5E5E5"> to be focusing on the first</font>

101
00:05:01,130 --> 00:05:05,780
<font color="#E5E5E5">phase</font><font color="#CCCCCC"> and I like to say it's a</font><font color="#E5E5E5"> really</font>

102
00:05:03,680 --> 00:05:08,330
important phase because without it<font color="#E5E5E5"> an</font>

103
00:05:05,780 --> 00:05:10,010
adversary is just flying blind<font color="#CCCCCC"> they</font>

104
00:05:08,330 --> 00:05:11,570
don't really know where to<font color="#CCCCCC"> go or</font><font color="#E5E5E5"> how to</font>

105
00:05:10,010 --> 00:05:13,670
get<font color="#CCCCCC"> there and each time they do</font>

106
00:05:11,570 --> 00:05:15,260
something<font color="#CCCCCC"> whether it be a query maybe</font>

107
00:05:13,670 --> 00:05:17,090
they access something<font color="#E5E5E5"> that's generating</font>

108
00:05:15,260 --> 00:05:20,349
more nominalist

109
00:05:17,090 --> 00:05:23,119
traffic<font color="#CCCCCC"> that can be detected and caught</font>

110
00:05:20,350 --> 00:05:24,710
so<font color="#E5E5E5"> I mentioned a little bit before</font><font color="#CCCCCC"> so</font>

111
00:05:23,120 --> 00:05:27,560
domain reconnaissance it's really<font color="#E5E5E5"> just</font>

112
00:05:24,710 --> 00:05:29,659
knowing what users exist<font color="#E5E5E5"> what groups</font>

113
00:05:27,560 --> 00:05:31,100
exist<font color="#E5E5E5"> what permissions</font><font color="#CCCCCC"> these users that</font>

114
00:05:29,660 --> 00:05:33,920
are part of<font color="#E5E5E5"> this group what is their</font>

115
00:05:31,100 --> 00:05:35,450
function<font color="#E5E5E5"> what systems are running in the</font>

116
00:05:33,920 --> 00:05:37,100
environment and<font color="#E5E5E5"> what is their purpose</font><font color="#CCCCCC"> do</font>

117
00:05:35,450 --> 00:05:38,570
<font color="#CCCCCC">they store</font><font color="#E5E5E5"> credit card data are they a</font>

118
00:05:37,100 --> 00:05:42,440
jump<font color="#E5E5E5"> box</font><font color="#CCCCCC"> are they just a simple</font>

119
00:05:38,570 --> 00:05:44,599
workstation<font color="#CCCCCC"> and looking at you know</font><font color="#E5E5E5"> the</font>

120
00:05:42,440 --> 00:05:47,240
privileges<font color="#E5E5E5"> readwrite access on shares</font>

121
00:05:44,600 --> 00:05:49,130
computers<font color="#E5E5E5"> of each individual user as</font>

122
00:05:47,240 --> 00:05:51,229
<font color="#E5E5E5">well as who's logged in because as I</font>

123
00:05:49,130 --> 00:05:53,790
mentioned<font color="#CCCCCC"> before</font><font color="#E5E5E5"> one of the major things</font>

124
00:05:51,229 --> 00:05:56,610
is figuring out what could

125
00:05:53,790 --> 00:05:57,960
you need to get so way you can move

126
00:05:56,610 --> 00:05:59,730
<font color="#E5E5E5">laterally</font><font color="#CCCCCC"> through maybe</font><font color="#E5E5E5"> if you need to</font>

127
00:05:57,960 --> 00:06:01,380
get<font color="#E5E5E5"> more credentials that have higher</font>

128
00:05:59,730 --> 00:06:02,520
level of privileges<font color="#CCCCCC"> you need to know</font>

129
00:06:01,380 --> 00:06:05,640
where they're<font color="#E5E5E5"> logged in in order to</font>

130
00:06:02,520 --> 00:06:07,560
steal them so this<font color="#CCCCCC"> is what it kind</font><font color="#E5E5E5"> of</font>

131
00:06:05,640 --> 00:06:09,060
<font color="#E5E5E5">looks</font><font color="#CCCCCC"> like you have your compromised box</font>

132
00:06:07,560 --> 00:06:11,190
maybe<font color="#CCCCCC"> it's the speeder fish maybe it's</font>

133
00:06:09,060 --> 00:06:13,800
something<font color="#E5E5E5"> and from there you start doing</font>

134
00:06:11,190 --> 00:06:17,310
<font color="#E5E5E5">some queries some enumeration trying to</font>

135
00:06:13,800 --> 00:06:19,020
figure<font color="#CCCCCC"> out who's logged in what</font>

136
00:06:17,310 --> 00:06:21,980
permissions<font color="#E5E5E5"> you have as that current</font>

137
00:06:19,020 --> 00:06:25,620
user<font color="#CCCCCC"> and where you need</font><font color="#E5E5E5"> to go and</font>

138
00:06:21,980 --> 00:06:28,560
because of this type of<font color="#E5E5E5"> frequency</font><font color="#CCCCCC"> of</font>

139
00:06:25,620 --> 00:06:30,270
these<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> the philosophy of</font><font color="#E5E5E5"> assume</font>

140
00:06:28,560 --> 00:06:34,170
breach<font color="#E5E5E5"> has becoming more and more</font>

141
00:06:30,270 --> 00:06:36,840
adopted and this philosophy is that<font color="#CCCCCC"> your</font>

142
00:06:34,170 --> 00:06:38,970
company<font color="#CCCCCC"> is</font><font color="#E5E5E5"> always being breached at some</font>

143
00:06:36,840 --> 00:06:40,890
point<font color="#E5E5E5"> you're never not under attack and</font>

144
00:06:38,970 --> 00:06:42,900
<font color="#CCCCCC">that helps kind of change the</font><font color="#E5E5E5"> landscape</font>

145
00:06:40,890 --> 00:06:44,460
from a hardened<font color="#E5E5E5"> shell with a gooey</font>

146
00:06:42,900 --> 00:06:46,789
<font color="#CCCCCC">Center where you just focus</font><font color="#E5E5E5"> on your</font>

147
00:06:44,460 --> 00:06:49,200
perimeter assets but start looking at

148
00:06:46,790 --> 00:06:52,020
<font color="#E5E5E5">focusing on your defenses and improving</font>

149
00:06:49,200 --> 00:06:55,289
your your metrics so that<font color="#CCCCCC"> way you can</font>

150
00:06:52,020 --> 00:06:57,120
<font color="#CCCCCC">prevent threats once they're inside</font><font color="#E5E5E5"> so</font>

151
00:06:55,290 --> 00:06:58,620
and identify it really<font color="#E5E5E5"> focuses on</font>

152
00:06:57,120 --> 00:07:02,280
<font color="#E5E5E5">building up at an organization's ability</font>

153
00:06:58,620 --> 00:07:04,470
to rapidly detect threats<font color="#E5E5E5"> react to them</font>

154
00:07:02,280 --> 00:07:05,789
to close them off and figure<font color="#E5E5E5"> out what</font>

155
00:07:04,470 --> 00:07:08,130
data has maybe been<font color="#E5E5E5"> tampered with</font>

156
00:07:05,790 --> 00:07:09,810
compromised<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> way you can then</font>

157
00:07:08,130 --> 00:07:10,380
prevent this from<font color="#CCCCCC"> happening in the</font>

158
00:07:09,810 --> 00:07:14,970
future

159
00:07:10,380 --> 00:07:17,550
<font color="#E5E5E5">and a lot of this comes from</font><font color="#CCCCCC"> Network</font>

160
00:07:14,970 --> 00:07:19,440
behavioral tools or commonly known as

161
00:07:17,550 --> 00:07:21,030
threat analytics<font color="#E5E5E5"> these tools and stuff</font>

162
00:07:19,440 --> 00:07:22,890
have slowly<font color="#CCCCCC"> becoming</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> and more</font>

163
00:07:21,030 --> 00:07:24,719
popular<font color="#CCCCCC"> and</font><font color="#E5E5E5"> becoming very commonplace</font>

164
00:07:22,890 --> 00:07:28,890
and<font color="#E5E5E5"> a lot of environments we've seen on</font>

165
00:07:24,720 --> 00:07:29,790
red teaming gigs<font color="#CCCCCC"> they are different</font><font color="#E5E5E5"> than</font>

166
00:07:28,890 --> 00:07:32,070
like an endpoint

167
00:07:29,790 --> 00:07:33,600
<font color="#E5E5E5">virus or antivirus protection system</font>

168
00:07:32,070 --> 00:07:36,000
because they're<font color="#E5E5E5"> not just looking at like</font>

169
00:07:33,600 --> 00:07:37,620
<font color="#CCCCCC">a signature base of a pad</font><font color="#E5E5E5"> of like a</font>

170
00:07:36,000 --> 00:07:40,680
payload or<font color="#E5E5E5"> characters they're looking at</font>

171
00:07:37,620 --> 00:07:42,480
the you<font color="#E5E5E5"> know behavior does was there</font>

172
00:07:40,680 --> 00:07:44,400
something where this kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> looks</font>

173
00:07:42,480 --> 00:07:46,020
suspicious or all the sudden this user

174
00:07:44,400 --> 00:07:48,479
who is<font color="#E5E5E5"> never logged</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> any of these</font>

175
00:07:46,020 --> 00:07:50,130
<font color="#CCCCCC">systems or anything like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> or had</font>

176
00:07:48,480 --> 00:07:52,710
made doesn't<font color="#E5E5E5"> log in on the weekends or</font>

177
00:07:50,130 --> 00:07:54,719
doesn't never put in extra hours<font color="#E5E5E5"> works</font>

178
00:07:52,710 --> 00:07:56,669
<font color="#E5E5E5">9:00 to 5:00</font><font color="#CCCCCC"> all of a sudden they're</font>

179
00:07:54,720 --> 00:07:58,080
starting to<font color="#E5E5E5"> use a lot of work outside</font>

180
00:07:56,670 --> 00:07:59,610
<font color="#CCCCCC">the normal hours they're doing things</font>

181
00:07:58,080 --> 00:08:02,849
<font color="#E5E5E5">that are</font><font color="#CCCCCC"> kind of outside</font><font color="#E5E5E5"> their normal</font>

182
00:07:59,610 --> 00:08:04,500
behavioral profile and that way<font color="#E5E5E5"> blue</font>

183
00:08:02,850 --> 00:08:06,180
<font color="#E5E5E5">teams and defense can kind of target and</font>

184
00:08:04,500 --> 00:08:07,590
be like well they're accessing<font color="#CCCCCC"> or</font>

185
00:08:06,180 --> 00:08:09,840
looking<font color="#CCCCCC"> for things that</font><font color="#E5E5E5"> are</font>

186
00:08:07,590 --> 00:08:11,789
have no business<font color="#CCCCCC"> to maybe Sally from HR</font>

187
00:08:09,840 --> 00:08:14,820
all of a sudden<font color="#E5E5E5"> is looking at IT stuff</font>

188
00:08:11,790 --> 00:08:20,100
and you know<font color="#E5E5E5"> credit cards that's</font><font color="#CCCCCC"> weird</font>

189
00:08:14,820 --> 00:08:23,700
<font color="#CCCCCC">so some</font><font color="#E5E5E5"> examples so you know net</font>

190
00:08:20,100 --> 00:08:25,740
<font color="#E5E5E5">commands commonly being</font><font color="#CCCCCC"> detected we</font><font color="#E5E5E5"> get</font>

191
00:08:23,700 --> 00:08:28,110
able to figure<font color="#E5E5E5"> out you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> what user</font>

192
00:08:25,740 --> 00:08:29,370
was running under<font color="#E5E5E5"> the system and what</font>

193
00:08:28,110 --> 00:08:31,380
commands<font color="#CCCCCC"> are actually executed and</font>

194
00:08:29,370 --> 00:08:32,850
that's a great<font color="#CCCCCC"> way for blue teens to</font>

195
00:08:31,380 --> 00:08:36,990
kind<font color="#CCCCCC"> of work</font><font color="#E5E5E5"> backwards and create a</font>

196
00:08:32,850 --> 00:08:39,900
<font color="#E5E5E5">timeline of where what and how so a few</font>

197
00:08:36,990 --> 00:08:43,080
<font color="#E5E5E5">more examples of other tools and systems</font>

198
00:08:39,900 --> 00:08:45,120
you can see even common ones like

199
00:08:43,080 --> 00:08:46,740
<font color="#CCCCCC">PowerShell is like all those</font><font color="#E5E5E5"> PowerShell</font>

200
00:08:45,120 --> 00:08:48,540
powersploit all these things<font color="#E5E5E5"> that are</font>

201
00:08:46,740 --> 00:08:51,810
<font color="#CCCCCC">they're slowly being caught more and</font>

202
00:08:48,540 --> 00:08:53,939
more with more<font color="#E5E5E5"> in frequency and as well</font>

203
00:08:51,810 --> 00:09:00,079
as metrics to build<font color="#CCCCCC"> profiles on users to</font>

204
00:08:53,940 --> 00:09:03,750
kind of figure<font color="#CCCCCC"> out what they're doing so</font>

205
00:09:00,080 --> 00:09:04,980
with this paradigm<font color="#CCCCCC"> shift</font><font color="#E5E5E5"> we have you</font>

206
00:09:03,750 --> 00:09:06,750
know adversaries are becoming more

207
00:09:04,980 --> 00:09:08,640
sneaky being more creative<font color="#E5E5E5"> they're</font>

208
00:09:06,750 --> 00:09:12,450
moving away from<font color="#E5E5E5"> just using raw</font>

209
00:09:08,640 --> 00:09:14,490
command-line tools<font color="#E5E5E5"> PowerShell anything</font>

210
00:09:12,450 --> 00:09:16,050
like that<font color="#E5E5E5"> because that's what a lot</font><font color="#CCCCCC"> of</font>

211
00:09:14,490 --> 00:09:19,350
signatures<font color="#E5E5E5"> are based off that's what a</font>

212
00:09:16,050 --> 00:09:20,849
lot of anomalous things look for instead

213
00:09:19,350 --> 00:09:24,510
they're going<font color="#E5E5E5"> to this</font><font color="#CCCCCC"> philosophy of</font>

214
00:09:20,850 --> 00:09:27,930
living<font color="#E5E5E5"> off the land</font><font color="#CCCCCC"> using the example of</font>

215
00:09:24,510 --> 00:09:30,210
net queries to you know gather users you

216
00:09:27,930 --> 00:09:35,130
know permissions<font color="#E5E5E5"> who's a domain admin</font>

217
00:09:30,210 --> 00:09:37,110
who's<font color="#E5E5E5"> a X group so one</font><font color="#CCCCCC"> example is</font>

218
00:09:35,130 --> 00:09:40,200
looking<font color="#E5E5E5"> at LDAP instead of using these</font>

219
00:09:37,110 --> 00:09:42,930
<font color="#E5E5E5">commands one of</font><font color="#CCCCCC"> the reasons why LDAP is</font>

220
00:09:40,200 --> 00:09:43,890
so good<font color="#CCCCCC"> so why</font><font color="#E5E5E5"> they use it</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> much</font>

221
00:09:42,930 --> 00:09:46,319
<font color="#CCCCCC">like these commands</font>

222
00:09:43,890 --> 00:09:49,260
<font color="#E5E5E5">anyone who has domain level potentials</font>

223
00:09:46,320 --> 00:09:53,130
<font color="#CCCCCC">if an adversary compromises them can use</font>

224
00:09:49,260 --> 00:09:55,200
these to run up these queries<font color="#CCCCCC"> same type</font>

225
00:09:53,130 --> 00:09:58,800
of<font color="#E5E5E5"> way same type of function as the</font>

226
00:09:55,200 --> 00:10:01,380
<font color="#CCCCCC">powershell or command line but it's just</font>

227
00:09:58,800 --> 00:10:04,199
<font color="#E5E5E5">hard</font><font color="#CCCCCC"> to detect and the problem with that</font>

228
00:10:01,380 --> 00:10:05,700
is after<font color="#E5E5E5"> the initial authentication</font>

229
00:10:04,200 --> 00:10:08,790
request<font color="#CCCCCC"> whether it be</font><font color="#E5E5E5"> successful or not</font>

230
00:10:05,700 --> 00:10:10,980
<font color="#CCCCCC">no further alerts</font><font color="#E5E5E5"> are triggered so</font>

231
00:10:08,790 --> 00:10:14,459
there's very little monitoring or event

232
00:10:10,980 --> 00:10:16,140
<font color="#E5E5E5">tracking after this fact so queries can</font>

233
00:10:14,460 --> 00:10:17,820
pass<font color="#E5E5E5"> through that we're normally being</font>

234
00:10:16,140 --> 00:10:21,640
<font color="#CCCCCC">detected through</font><font color="#E5E5E5"> command line or</font>

235
00:10:17,820 --> 00:10:24,190
<font color="#E5E5E5">powershell but through LDAP</font>

236
00:10:21,640 --> 00:10:25,810
<font color="#CCCCCC">and unfortunately the</font><font color="#E5E5E5"> only way with</font>

237
00:10:24,190 --> 00:10:28,680
these type of<font color="#E5E5E5"> queries is you can if you</font>

238
00:10:25,810 --> 00:10:31,839
are<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> monitor the traffic and see</font>

239
00:10:28,680 --> 00:10:34,150
the clear<font color="#E5E5E5"> text packets because it's all</font>

240
00:10:31,840 --> 00:10:36,220
sent over unencrypted<font color="#E5E5E5"> and over no</font>

241
00:10:34,150 --> 00:10:37,930
encryption<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to see these</font>

242
00:10:36,220 --> 00:10:40,750
<font color="#E5E5E5">types of queries but by simply</font><font color="#CCCCCC"> adding a</font>

243
00:10:37,930 --> 00:10:42,160
<font color="#CCCCCC">level layer of encryption</font><font color="#E5E5E5"> it office</font>

244
00:10:40,750 --> 00:10:46,660
gates all this information making<font color="#E5E5E5"> it</font>

245
00:10:42,160 --> 00:10:48,310
impossible for defense<font color="#E5E5E5"> to detect so to</font>

246
00:10:46,660 --> 00:10:50,020
give you<font color="#E5E5E5"> an example kind of comparison</font>

247
00:10:48,310 --> 00:10:52,089
what it would kind of look<font color="#CCCCCC"> like is an</font>

248
00:10:50,020 --> 00:10:53,980
adversary would get in they start

249
00:10:52,090 --> 00:10:55,810
running<font color="#E5E5E5"> these queries but it looks</font>

250
00:10:53,980 --> 00:10:57,670
<font color="#CCCCCC">suspicious so these logs then get</font>

251
00:10:55,810 --> 00:11:00,099
forwarded to a security<font color="#CCCCCC"> center or an</font>

252
00:10:57,670 --> 00:11:02,439
agent and it generates an alert that<font color="#E5E5E5"> is</font>

253
00:11:00,100 --> 00:11:04,750
then sent<font color="#E5E5E5"> to defense and they are able</font>

254
00:11:02,440 --> 00:11:07,900
<font color="#CCCCCC">to</font><font color="#E5E5E5"> investigate and shut it</font><font color="#CCCCCC"> down before a</font>

255
00:11:04,750 --> 00:11:10,480
compromise has more time<font color="#CCCCCC"> to move</font><font color="#E5E5E5"> versus</font>

256
00:11:07,900 --> 00:11:13,420
doing a bulk query over<font color="#E5E5E5"> TLS encryption</font>

257
00:11:10,480 --> 00:11:16,090
<font color="#E5E5E5">and then reviewing the data locally</font>

258
00:11:13,420 --> 00:11:17,430
<font color="#CCCCCC">never generating any further requests or</font>

259
00:11:16,090 --> 00:11:19,510
anything like<font color="#CCCCCC"> that on the environment</font>

260
00:11:17,430 --> 00:11:21,160
<font color="#E5E5E5">those logs are transferred over but</font>

261
00:11:19,510 --> 00:11:21,819
because all it was is a simple LDAP

262
00:11:21,160 --> 00:11:24,370
request

263
00:11:21,820 --> 00:11:27,910
no signature<font color="#E5E5E5"> alert is ever generated so</font>

264
00:11:24,370 --> 00:11:31,270
defense is never aware of it another

265
00:11:27,910 --> 00:11:33,730
technique that<font color="#E5E5E5"> is being more and more</font>

266
00:11:31,270 --> 00:11:37,300
used is going<font color="#CCCCCC"> back</font><font color="#E5E5E5"> to using</font><font color="#CCCCCC"> low-level</font>

267
00:11:33,730 --> 00:11:40,570
api's when<font color="#E5E5E5"> Windows ap is and the reason</font>

268
00:11:37,300 --> 00:11:41,650
<font color="#CCCCCC">for</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> that these api's are all</font>

269
00:11:40,570 --> 00:11:44,440
designed<font color="#E5E5E5"> to interact with specific</font>

270
00:11:41,650 --> 00:11:46,840
<font color="#CCCCCC">functions in a Windows environment and</font>

271
00:11:44,440 --> 00:11:49,800
they're all on all systems<font color="#E5E5E5"> whether it be</font>

272
00:11:46,840 --> 00:11:51,820
XP 2003 they all come<font color="#E5E5E5"> defaults so</font>

273
00:11:49,800 --> 00:11:55,359
adversaries know that they exist<font color="#E5E5E5"> and</font>

274
00:11:51,820 --> 00:11:57,220
<font color="#E5E5E5">that they are there and these api's</font><font color="#CCCCCC"> are</font>

275
00:11:55,360 --> 00:11:58,810
already frequently used for normal

276
00:11:57,220 --> 00:12:01,840
operations and<font color="#CCCCCC"> well business</font><font color="#E5E5E5"> functions</font>

277
00:11:58,810 --> 00:12:03,670
so it allows<font color="#E5E5E5"> for their traffic to blend</font>

278
00:12:01,840 --> 00:12:06,640
in<font color="#E5E5E5"> with normal operations making it</font><font color="#CCCCCC"> even</font>

279
00:12:03,670 --> 00:12:10,599
<font color="#CCCCCC">harder for blue</font><font color="#E5E5E5"> teams to detect and kind</font>

280
00:12:06,640 --> 00:12:12,400
of narrow<font color="#E5E5E5"> in so one example of this</font><font color="#CCCCCC"> of</font>

281
00:12:10,600 --> 00:12:16,330
the<font color="#CCCCCC"> api's that are commonly used</font><font color="#E5E5E5"> is the</font>

282
00:12:12,400 --> 00:12:18,850
net share<font color="#E5E5E5"> API so this API allows to</font>

283
00:12:16,330 --> 00:12:21,010
query<font color="#E5E5E5"> and pull down and</font><font color="#CCCCCC"> trennis</font><font color="#E5E5E5"> a</font>

284
00:12:18,850 --> 00:12:23,230
tremendous<font color="#E5E5E5"> amount of</font><font color="#CCCCCC"> information about</font>

285
00:12:21,010 --> 00:12:25,870
<font color="#E5E5E5">the remote shares running and this can</font>

286
00:12:23,230 --> 00:12:29,290
be from just<font color="#E5E5E5"> a simple name to the</font>

287
00:12:25,870 --> 00:12:30,910
description to the privileges now<font color="#E5E5E5"> a lot</font>

288
00:12:29,290 --> 00:12:35,020
<font color="#CCCCCC">of times adversaries will only focus</font><font color="#E5E5E5"> on</font>

289
00:12:30,910 --> 00:12:36,400
level 1 or level<font color="#E5E5E5"> 2 because the</font>

290
00:12:35,020 --> 00:12:38,170
all the sequential levels require

291
00:12:36,400 --> 00:12:40,780
further access like permissions<font color="#E5E5E5"> like</font>

292
00:12:38,170 --> 00:12:43,479
power level user or admin administrative

293
00:12:40,780 --> 00:12:47,680
rights but they can deduce the name as

294
00:12:43,480 --> 00:12:49,930
well<font color="#CCCCCC"> as the</font><font color="#E5E5E5"> information and then to</font>

295
00:12:47,680 --> 00:12:53,020
<font color="#E5E5E5">figure out the permissions they simply</font>

296
00:12:49,930 --> 00:12:54,370
can just use a technique where they

297
00:12:53,020 --> 00:12:57,990
would connect and see if they can read

298
00:12:54,370 --> 00:13:00,670
<font color="#E5E5E5">anything off the share and if they can</font>

299
00:12:57,990 --> 00:13:02,260
if they can they then move into another

300
00:13:00,670 --> 00:13:04,900
<font color="#E5E5E5">face where</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> go to test to see</font><font color="#CCCCCC"> about</font>

301
00:13:02,260 --> 00:13:06,970
<font color="#E5E5E5">right access so with right access it</font>

302
00:13:04,900 --> 00:13:10,150
<font color="#E5E5E5">always</font><font color="#CCCCCC"> involves trying to write</font>

303
00:13:06,970 --> 00:13:11,200
<font color="#E5E5E5">something to</font><font color="#CCCCCC"> disk and with</font><font color="#E5E5E5"> endpoint</font>

304
00:13:10,150 --> 00:13:13,329
<font color="#E5E5E5">solutions becoming more and</font><font color="#CCCCCC"> more</font>

305
00:13:11,200 --> 00:13:15,730
advanced it's harder<font color="#CCCCCC"> and harder for to</font>

306
00:13:13,330 --> 00:13:17,830
drop a binary drop a file<font color="#CCCCCC"> without being</font>

307
00:13:15,730 --> 00:13:20,050
detected<font color="#CCCCCC"> so one of</font><font color="#E5E5E5"> the ways to go</font><font color="#CCCCCC"> around</font>

308
00:13:17,830 --> 00:13:21,760
this is to drop<font color="#E5E5E5"> a folder a folder still</font>

309
00:13:20,050 --> 00:13:24,370
requires<font color="#E5E5E5"> the same level of permissions</font>

310
00:13:21,760 --> 00:13:28,510
to write however they don't carry any

311
00:13:24,370 --> 00:13:30,420
data<font color="#E5E5E5"> so with that in</font><font color="#CCCCCC"> mind you can drop a</font>

312
00:13:28,510 --> 00:13:33,069
<font color="#CCCCCC">folder to test the</font><font color="#E5E5E5"> right access however</font>

313
00:13:30,420 --> 00:13:34,870
you don't<font color="#E5E5E5"> actually there's no like</font>

314
00:13:33,070 --> 00:13:35,970
binary there's no signature related to a

315
00:13:34,870 --> 00:13:38,290
<font color="#E5E5E5">folder so it makes it harder for</font>

316
00:13:35,970 --> 00:13:41,740
endpoint solutions to detect that this

317
00:13:38,290 --> 00:13:45,430
folder was being<font color="#E5E5E5"> created another API</font>

318
00:13:41,740 --> 00:13:46,930
call this one<font color="#E5E5E5"> net it's actually this is</font>

319
00:13:45,430 --> 00:13:49,979
the abbreviation term but it's<font color="#CCCCCC"> network</font>

320
00:13:46,930 --> 00:13:52,719
<font color="#E5E5E5">station user numeration this API is</font>

321
00:13:49,980 --> 00:13:54,610
focuses on looking<font color="#E5E5E5"> and basically</font>

322
00:13:52,720 --> 00:13:56,830
displaying<font color="#CCCCCC"> all information related to</font>

323
00:13:54,610 --> 00:13:58,810
<font color="#E5E5E5">active sessions and does this by looking</font>

324
00:13:56,830 --> 00:14:00,940
<font color="#E5E5E5">at all active tokens which are created</font>

325
00:13:58,810 --> 00:14:03,160
when I user logs in and<font color="#CCCCCC"> be a service</font>

326
00:14:00,940 --> 00:14:06,700
starts up or a remote session connects

327
00:14:03,160 --> 00:14:08,709
<font color="#E5E5E5">like through RDP the one caveat with</font>

328
00:14:06,700 --> 00:14:10,300
this API<font color="#CCCCCC"> call is the require elevated</font>

329
00:14:08,710 --> 00:14:13,200
privileges on the<font color="#CCCCCC"> embark</font><font color="#E5E5E5"> on the system</font>

330
00:14:10,300 --> 00:14:15,790
to<font color="#CCCCCC"> actually see</font><font color="#E5E5E5"> this type of information</font>

331
00:14:13,200 --> 00:14:19,030
<font color="#E5E5E5">which brings us</font><font color="#CCCCCC"> to the most commonly</font>

332
00:14:15,790 --> 00:14:20,980
used<font color="#E5E5E5"> one net session enumeration so this</font>

333
00:14:19,030 --> 00:14:22,660
is similar<font color="#E5E5E5"> to the API call we</font><font color="#CCCCCC"> just</font>

334
00:14:20,980 --> 00:14:25,060
talked about however<font color="#E5E5E5"> it doesn't require</font>

335
00:14:22,660 --> 00:14:26,680
domain administrator<font color="#E5E5E5"> any</font><font color="#CCCCCC"> administrative</font>

336
00:14:25,060 --> 00:14:30,790
rights<font color="#CCCCCC"> you just have</font><font color="#E5E5E5"> to be a domain user</font>

337
00:14:26,680 --> 00:14:32,140
in<font color="#E5E5E5"> order to query this information so so</font>

338
00:14:30,790 --> 00:14:34,000
<font color="#E5E5E5">long as you have valid credentials for</font>

339
00:14:32,140 --> 00:14:36,730
<font color="#E5E5E5">the environment you can see whoever is</font>

340
00:14:34,000 --> 00:14:39,130
logged in however there are some

341
00:14:36,730 --> 00:14:42,450
<font color="#E5E5E5">concerns and issues with this API</font><font color="#CCCCCC"> call</font>

342
00:14:39,130 --> 00:14:44,439
<font color="#E5E5E5">it's becoming very very popular</font><font color="#CCCCCC"> to use</font>

343
00:14:42,450 --> 00:14:47,500
<font color="#E5E5E5">numerous tools out there that are</font>

344
00:14:44,440 --> 00:14:48,670
publicly released<font color="#E5E5E5"> are constantly using</font>

345
00:14:47,500 --> 00:14:50,230
<font color="#E5E5E5">this so it's really</font>

346
00:14:48,670 --> 00:14:53,050
easy for vendors to<font color="#E5E5E5"> kind of write</font>

347
00:14:50,230 --> 00:14:55,810
signatures and detect this<font color="#E5E5E5"> so what does</font>

348
00:14:53,050 --> 00:14:58,329
that mean for adversaries<font color="#E5E5E5"> they hardly</font>

349
00:14:55,810 --> 00:15:00,010
<font color="#E5E5E5">used that net session API call instead</font>

350
00:14:58,330 --> 00:15:01,870
they<font color="#E5E5E5"> use a combination of looking at the</font>

351
00:15:00,010 --> 00:15:04,569
share permissions<font color="#E5E5E5"> as well as the</font>

352
00:15:01,870 --> 00:15:07,060
<font color="#CCCCCC">workstation enumeration API call</font><font color="#E5E5E5"> and</font>

353
00:15:04,570 --> 00:15:09,970
just sparingly ever<font color="#E5E5E5"> and have to call</font>

354
00:15:07,060 --> 00:15:12,069
<font color="#E5E5E5">that net session enumeration API because</font>

355
00:15:09,970 --> 00:15:14,230
<font color="#E5E5E5">while they might write signature for it</font>

356
00:15:12,070 --> 00:15:16,420
signatures for it it is<font color="#E5E5E5"> still a basic</font>

357
00:15:14,230 --> 00:15:21,820
function in a Windows<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> that</font>

358
00:15:16,420 --> 00:15:24,010
has a business<font color="#E5E5E5"> need</font><font color="#CCCCCC"> so by performing at</font>

359
00:15:21,820 --> 00:15:25,090
this by using<font color="#E5E5E5"> these steps adversaries</font>

360
00:15:24,010 --> 00:15:30,550
are making it harder and<font color="#CCCCCC"> harder for</font>

361
00:15:25,090 --> 00:15:32,170
defense to detect their actions<font color="#E5E5E5"> so</font><font color="#CCCCCC"> vibe</font>

362
00:15:30,550 --> 00:15:33,699
<font color="#E5E5E5">I've mentioned that that's</font><font color="#CCCCCC"> thought</font><font color="#E5E5E5"> at</font>

363
00:15:32,170 --> 00:15:35,530
the beginning<font color="#E5E5E5"> of the talk that this talk</font>

364
00:15:33,700 --> 00:15:38,650
was called vibing your way through so<font color="#E5E5E5"> I</font>

365
00:15:35,530 --> 00:15:40,089
developed a framework that<font color="#E5E5E5"> takes all</font>

366
00:15:38,650 --> 00:15:43,120
those<font color="#E5E5E5"> components and steps that</font><font color="#CCCCCC"> we I</font>

367
00:15:40,090 --> 00:15:44,770
<font color="#E5E5E5">just discussed and allows you to kind of</font>

368
00:15:43,120 --> 00:15:46,900
carry<font color="#E5E5E5"> this out this is a tool that's</font>

369
00:15:44,770 --> 00:15:50,740
mainly<font color="#E5E5E5"> designed for not only red teamers</font>

370
00:15:46,900 --> 00:15:54,010
but also<font color="#E5E5E5"> blue teamers</font><font color="#CCCCCC"> it pulls</font><font color="#E5E5E5"> down all</font>

371
00:15:50,740 --> 00:15:56,140
the entire domain<font color="#E5E5E5"> that's users groups</font>

372
00:15:54,010 --> 00:15:58,510
and systems<font color="#E5E5E5"> pulls down all the</font>

373
00:15:56,140 --> 00:16:01,360
information<font color="#CCCCCC"> about each object through</font>

374
00:15:58,510 --> 00:16:03,670
LDAP<font color="#CCCCCC"> it allows you to</font><font color="#E5E5E5"> do queries and</font>

375
00:16:01,360 --> 00:16:05,710
connections<font color="#CCCCCC"> between data sets</font><font color="#E5E5E5"> so it</font>

376
00:16:03,670 --> 00:16:08,260
allows you<font color="#E5E5E5"> to kind of understand why</font>

377
00:16:05,710 --> 00:16:11,620
user X<font color="#E5E5E5"> is part of this group and what</font>

378
00:16:08,260 --> 00:16:13,810
does that<font color="#E5E5E5"> group do in an environment it</font>

379
00:16:11,620 --> 00:16:24,220
allows<font color="#CCCCCC"> you to scan for privileges you</font>

380
00:16:13,810 --> 00:16:26,199
know<font color="#CCCCCC"> readwrite as well</font><font color="#E5E5E5"> as look to see if</font>

381
00:16:24,220 --> 00:16:27,970
<font color="#E5E5E5">you have administrator</font><font color="#CCCCCC"> privileges you</font>

382
00:16:26,200 --> 00:16:31,240
can<font color="#E5E5E5"> you know using</font><font color="#CCCCCC"> that user</font><font color="#E5E5E5"> you can</font>

383
00:16:27,970 --> 00:16:33,280
<font color="#CCCCCC">actually then</font><font color="#E5E5E5"> see who's logged in</font><font color="#CCCCCC"> we've</font>

384
00:16:31,240 --> 00:16:35,560
tested this against numerous vendor

385
00:16:33,280 --> 00:16:37,900
products and have to validate<font color="#CCCCCC"> the</font>

386
00:16:35,560 --> 00:16:41,589
<font color="#E5E5E5">effectiveness this tool does</font><font color="#CCCCCC"> not use any</font>

387
00:16:37,900 --> 00:16:44,530
<font color="#CCCCCC">powershell it</font><font color="#E5E5E5"> uses primarily</font><font color="#CCCCCC"> python to</font>

388
00:16:41,590 --> 00:16:46,030
<font color="#E5E5E5">interact</font><font color="#CCCCCC"> with the windows api s so i</font>

389
00:16:44,530 --> 00:16:49,050
have<font color="#E5E5E5"> a demo here to kind of show you an</font>

390
00:16:46,030 --> 00:16:49,050
<font color="#CCCCCC">example</font><font color="#E5E5E5"> of how it would work</font>

391
00:16:54,209 --> 00:16:58,329
so right now it's pulled down the whole

392
00:16:56,740 --> 00:17:00,339
<font color="#E5E5E5">domain</font><font color="#CCCCCC"> information so you can use</font>

393
00:16:58,329 --> 00:17:01,149
similar commands<font color="#E5E5E5"> like net user or</font>

394
00:17:00,339 --> 00:17:03,310
anything like<font color="#E5E5E5"> that</font>

395
00:17:01,149 --> 00:17:05,589
to display<font color="#E5E5E5"> the list of groups the</font>

396
00:17:03,310 --> 00:17:08,039
information that that are normally

397
00:17:05,589 --> 00:17:10,089
queried and pulled down<font color="#E5E5E5"> so you can see</font>

398
00:17:08,039 --> 00:17:11,859
<font color="#E5E5E5">every</font><font color="#CCCCCC"> single group who</font><font color="#E5E5E5"> they're</font>

399
00:17:10,089 --> 00:17:16,780
<font color="#CCCCCC">affiliated with like the SID</font>

400
00:17:11,859 --> 00:17:35,949
all this<font color="#E5E5E5"> information and you</font><font color="#CCCCCC"> can do this</font>

401
00:17:16,780 --> 00:17:37,480
through users groups computers you can

402
00:17:35,950 --> 00:17:39,070
see also<font color="#E5E5E5"> the affiliated members</font><font color="#CCCCCC"> like the</font>

403
00:17:37,480 --> 00:17:41,110
<font color="#E5E5E5">permissions that each computer for</font>

404
00:17:39,070 --> 00:17:42,158
computer is assigned a group as<font color="#E5E5E5"> part of</font>

405
00:17:41,110 --> 00:17:45,309
a group you can<font color="#E5E5E5"> pull</font><font color="#CCCCCC"> that information</font>

406
00:17:42,159 --> 00:17:47,650
<font color="#E5E5E5">down you also can see</font><font color="#CCCCCC"> the list of</font><font color="#E5E5E5"> files</font>

407
00:17:45,309 --> 00:17:49,120
shares<font color="#CCCCCC"> that's kind of enumerated based</font>

408
00:17:47,650 --> 00:17:51,250
on the information<font color="#E5E5E5"> that's pulled down</font>

409
00:17:49,120 --> 00:17:53,949
through group and user profiles<font color="#E5E5E5"> we also</font>

410
00:17:51,250 --> 00:17:56,590
can pull down<font color="#E5E5E5"> the password policy</font><font color="#CCCCCC"> so we</font>

411
00:17:53,950 --> 00:17:58,360
<font color="#E5E5E5">can understand you know how what's their</font>

412
00:17:56,590 --> 00:18:01,360
lockout threshold how many times how

413
00:17:58,360 --> 00:18:02,620
often<font color="#E5E5E5"> or passwords changed as I</font>

414
00:18:01,360 --> 00:18:04,178
mentioned<font color="#E5E5E5"> before you can use net</font>

415
00:18:02,620 --> 00:18:05,530
commands<font color="#E5E5E5"> like you know net user and</font>

416
00:18:04,179 --> 00:18:06,850
display the same<font color="#CCCCCC"> information you would</font>

417
00:18:05,530 --> 00:18:09,240
if<font color="#E5E5E5"> you're through a Windows command</font>

418
00:18:06,850 --> 00:18:09,240
prompt

419
00:18:26,600 --> 00:18:30,289
you can add multiple<font color="#E5E5E5"> credentials so that</font>

420
00:18:28,580 --> 00:18:32,750
<font color="#E5E5E5">way you can use as you get and pillage</font>

421
00:18:30,289 --> 00:18:34,370
more credentials<font color="#CCCCCC"> you can actually switch</font>

422
00:18:32,750 --> 00:18:36,350
<font color="#CCCCCC">between to see what privileges and</font>

423
00:18:34,370 --> 00:18:38,449
shares you have<font color="#E5E5E5"> access to so in this</font>

424
00:18:36,350 --> 00:18:40,549
example we<font color="#CCCCCC"> didn't lis have one set of</font>

425
00:18:38,450 --> 00:18:44,960
credentials<font color="#E5E5E5"> so we're gonna scan this</font>

426
00:18:40,549 --> 00:18:46,309
range<font color="#CCCCCC"> looking to see what shares</font><font color="#E5E5E5"> exist</font>

427
00:18:44,960 --> 00:18:48,590
<font color="#E5E5E5">as well as the permissions that</font><font color="#CCCCCC"> are</font>

428
00:18:46,309 --> 00:18:51,020
associated so this has a function<font color="#E5E5E5"> to</font>

429
00:18:48,590 --> 00:18:52,699
randomize<font color="#E5E5E5"> each requests so that way it's</font>

430
00:18:51,020 --> 00:18:54,260
<font color="#E5E5E5">not</font><font color="#CCCCCC"> going in sequential as well as you</font>

431
00:18:52,700 --> 00:18:57,980
can<font color="#E5E5E5"> add a jitter time to kind of delay</font>

432
00:18:54,260 --> 00:19:00,530
and<font color="#E5E5E5"> stagger the requests so that</font><font color="#CCCCCC"> way</font>

433
00:18:57,980 --> 00:19:02,840
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> like at this second that you</font>

434
00:19:00,530 --> 00:19:06,559
know<font color="#CCCCCC"> 91</font><font color="#E5E5E5"> you know one was hit and two was</font>

435
00:19:02,840 --> 00:19:07,850
hit then got three once once<font color="#E5E5E5"> you have</font>

436
00:19:06,559 --> 00:19:09,740
this information<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can then also as I</font>

437
00:19:07,850 --> 00:19:12,770
<font color="#CCCCCC">mentioned before use the session command</font>

438
00:19:09,740 --> 00:19:15,650
to see who's currently<font color="#CCCCCC"> logged in so in</font>

439
00:19:12,770 --> 00:19:18,080
the previous<font color="#E5E5E5"> case</font><font color="#CCCCCC"> we know that</font><font color="#E5E5E5"> 1760 41</font>

440
00:19:15,650 --> 00:19:21,289
190 we had<font color="#E5E5E5"> right permissions too so we</font>

441
00:19:18,080 --> 00:19:23,658
can<font color="#E5E5E5"> see who's logged in</font><font color="#CCCCCC"> let's</font><font color="#E5E5E5"> say now</font>

442
00:19:21,289 --> 00:19:25,970
we've compromised the box so<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> now</font>

443
00:19:23,659 --> 00:19:28,789
add those<font color="#E5E5E5"> credentials so we can add the</font>

444
00:19:25,970 --> 00:19:31,070
<font color="#CCCCCC">domain the username</font><font color="#E5E5E5"> you can add the</font>

445
00:19:28,789 --> 00:19:33,408
password<font color="#E5E5E5"> or you can specify a hash if</font>

446
00:19:31,070 --> 00:19:35,120
you weren't able to get the clear text

447
00:19:33,409 --> 00:19:38,750
password you can still use<font color="#CCCCCC"> a</font><font color="#E5E5E5"> password</font>

448
00:19:35,120 --> 00:19:42,320
hash instead now with that<font color="#E5E5E5"> one added</font>

449
00:19:38,750 --> 00:19:44,480
<font color="#E5E5E5">into the database we can then see what</font>

450
00:19:42,320 --> 00:19:45,889
new privileges<font color="#E5E5E5"> this user has but first</font>

451
00:19:44,480 --> 00:19:48,289
let's take<font color="#E5E5E5"> a look and see we can see</font>

452
00:19:45,890 --> 00:19:50,780
that<font color="#E5E5E5"> they're part of the server</font><font color="#CCCCCC"> zero one</font>

453
00:19:48,289 --> 00:19:52,010
admin so as I<font color="#E5E5E5"> mention before you can do</font>

454
00:19:50,780 --> 00:19:54,470
<font color="#E5E5E5">these kind of queries to connect</font>

455
00:19:52,010 --> 00:19:57,190
<font color="#E5E5E5">different data sets so we're going to</font>

456
00:19:54,470 --> 00:20:00,740
search for<font color="#CCCCCC"> SSL server and we can see</font>

457
00:19:57,190 --> 00:20:02,659
<font color="#E5E5E5">that there's an admin group and a work</font>

458
00:20:00,740 --> 00:20:04,640
<font color="#E5E5E5">and a server that's called suit and</font>

459
00:20:02,659 --> 00:20:06,620
<font color="#CCCCCC">Cyril</font><font color="#E5E5E5"> the server</font><font color="#CCCCCC"> 0 1</font>

460
00:20:04,640 --> 00:20:12,200
so using these<font color="#E5E5E5"> credentials we're going</font>

461
00:20:06,620 --> 00:20:15,428
to see who's logged in and<font color="#E5E5E5"> then from</font>

462
00:20:12,200 --> 00:20:15,429
<font color="#CCCCCC">that point we can just</font><font color="#E5E5E5"> move forward</font>

463
00:20:20,950 --> 00:20:25,960
so how can you come how can<font color="#CCCCCC"> we combat</font>

464
00:20:24,010 --> 00:20:30,670
<font color="#CCCCCC">this how can blue</font><font color="#E5E5E5"> team's combat against</font>

465
00:20:25,960 --> 00:20:32,170
this<font color="#E5E5E5"> simply with we're pulling down LDAP</font>

466
00:20:30,670 --> 00:20:34,660
traffic it's kind of<font color="#E5E5E5"> hard to monitor and</font>

467
00:20:32,170 --> 00:20:36,550
you can't really disable it<font color="#CCCCCC"> you should</font>

468
00:20:34,660 --> 00:20:39,430
be able to what we recommend is the

469
00:20:36,550 --> 00:20:41,500
monitor for<font color="#E5E5E5"> a large anomalous request</font>

470
00:20:39,430 --> 00:20:43,540
<font color="#E5E5E5">may be large queries are frequent</font>

471
00:20:41,500 --> 00:20:44,950
queries as well as if<font color="#E5E5E5"> you have the</font>

472
00:20:43,540 --> 00:20:47,500
ability<font color="#CCCCCC"> to segment</font><font color="#E5E5E5"> off your domain</font>

473
00:20:44,950 --> 00:20:51,100
<font color="#CCCCCC">controllers and only allow access to</font>

474
00:20:47,500 --> 00:20:54,160
certain<font color="#CCCCCC"> resources through</font><font color="#E5E5E5"> to LDAP for</font>

475
00:20:51,100 --> 00:20:56,439
net share<font color="#CCCCCC"> that one's kind of hard</font>

476
00:20:54,160 --> 00:20:59,920
because of<font color="#CCCCCC"> the fact that how core and</font>

477
00:20:56,440 --> 00:21:01,630
how key it is to an<font color="#E5E5E5"> environment I like</font>

478
00:20:59,920 --> 00:21:03,970
to<font color="#E5E5E5"> recommend to defense and blue team's</font>

479
00:21:01,630 --> 00:21:07,150
<font color="#CCCCCC">to instead of</font><font color="#E5E5E5"> looking at everything</font>

480
00:21:03,970 --> 00:21:09,070
<font color="#E5E5E5">focused</font><font color="#CCCCCC"> down on the important ones</font><font color="#E5E5E5"> admin</font>

481
00:21:07,150 --> 00:21:11,830
<font color="#E5E5E5">dollar</font><font color="#CCCCCC"> sign</font><font color="#E5E5E5"> see dollar sign and any ones</font>

482
00:21:09,070 --> 00:21:13,810
that<font color="#E5E5E5"> store</font><font color="#CCCCCC"> business data as admin and</font>

483
00:21:11,830 --> 00:21:16,929
see are used for code execution

484
00:21:13,810 --> 00:21:18,520
<font color="#E5E5E5">primarily remotely so that way you can</font>

485
00:21:16,930 --> 00:21:21,040
kind of focus<font color="#E5E5E5"> in and look to see</font><font color="#CCCCCC"> if any</font>

486
00:21:18,520 --> 00:21:23,020
requests have been<font color="#E5E5E5"> triggered against</font>

487
00:21:21,040 --> 00:21:27,700
them<font color="#E5E5E5"> as well as implementing host-based</font>

488
00:21:23,020 --> 00:21:29,650
firewalls net session<font color="#CCCCCC"> it's actually</font>

489
00:21:27,700 --> 00:21:31,480
<font color="#CCCCCC">really easy to prevent</font><font color="#E5E5E5"> I'm actually</font>

490
00:21:29,650 --> 00:21:32,830
surprised myself has actually<font color="#E5E5E5"> released a</font>

491
00:21:31,480 --> 00:21:35,050
lot of<font color="#E5E5E5"> information</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> this but we</font>

492
00:21:32,830 --> 00:21:37,270
still see<font color="#CCCCCC"> it prevalent just by</font><font color="#E5E5E5"> changing</font>

493
00:21:35,050 --> 00:21:39,340
this registry key here<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> change it</font>

494
00:21:37,270 --> 00:21:41,680
to administrator server or power users

495
00:21:39,340 --> 00:21:46,540
and that prevents anyone from being<font color="#E5E5E5"> able</font>

496
00:21:41,680 --> 00:21:49,720
to<font color="#E5E5E5"> query to see who's logged in so to</font>

497
00:21:46,540 --> 00:21:51,730
recap<font color="#E5E5E5"> you know as the landscape has</font>

498
00:21:49,720 --> 00:21:55,200
changed<font color="#E5E5E5"> adversaries are going they're</font>

499
00:21:51,730 --> 00:21:57,970
coming up<font color="#CCCCCC"> with</font><font color="#E5E5E5"> new ideas and blue</font><font color="#CCCCCC"> teens</font>

500
00:21:55,200 --> 00:21:59,800
need<font color="#E5E5E5"> to continue focusing on stopping</font>

501
00:21:57,970 --> 00:22:03,610
<font color="#CCCCCC">them at the domain reconnaissance point</font>

502
00:21:59,800 --> 00:22:06,100
to prevent further<font color="#E5E5E5"> compromised vibe</font>

503
00:22:03,610 --> 00:22:07,959
which is the<font color="#E5E5E5"> framework</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> be used by</font>

504
00:22:06,100 --> 00:22:11,139
<font color="#CCCCCC">both blue team's and red team's red</font>

505
00:22:07,960 --> 00:22:12,490
<font color="#E5E5E5">team's to help show risk and impact and</font>

506
00:22:11,140 --> 00:22:14,170
blue<font color="#CCCCCC"> team's can</font><font color="#E5E5E5"> be used it against their</font>

507
00:22:12,490 --> 00:22:18,010
own appliances<font color="#CCCCCC"> to help tune up and</font><font color="#E5E5E5"> find</font>

508
00:22:14,170 --> 00:22:19,570
where their<font color="#CCCCCC"> shortcomings vibe is</font>

509
00:22:18,010 --> 00:22:22,510
publicly<font color="#E5E5E5"> available now it's just been</font>

510
00:22:19,570 --> 00:22:25,419
released<font color="#CCCCCC"> today here at gherkin</font>

511
00:22:22,510 --> 00:22:26,680
the link is<font color="#E5E5E5"> up there I'll be constantly</font>

512
00:22:25,420 --> 00:22:27,790
developing<font color="#E5E5E5"> and adding it so if you have</font>

513
00:22:26,680 --> 00:22:29,230
any questions<font color="#E5E5E5"> or anything like you can</font>

514
00:22:27,790 --> 00:22:31,570
follow me<font color="#CCCCCC"> on</font><font color="#E5E5E5"> Twitter or</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> put a</font>

515
00:22:29,230 --> 00:22:33,990
complaint or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> on the github</font><font color="#E5E5E5"> are</font>

516
00:22:31,570 --> 00:22:33,990
there any questions

517
00:22:36,809 --> 00:22:46,749
yes<font color="#CCCCCC"> I write now you can add both</font><font color="#E5E5E5"> but</font>

518
00:22:45,190 --> 00:22:48,669
some of the functionality so we<font color="#E5E5E5"> would</font>

519
00:22:46,749 --> 00:22:50,320
have to first initiate the framework

520
00:22:48,669 --> 00:22:51,970
with domain credentials but once you get

521
00:22:50,320 --> 00:22:53,109
<font color="#E5E5E5">in</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> like once you get into that</font>

522
00:22:51,970 --> 00:22:57,820
command prompt where you saw a little

523
00:22:53,109 --> 00:22:59,728
<font color="#E5E5E5">triangles</font><font color="#CCCCCC"> you can use any credentials</font>

524
00:22:57,820 --> 00:23:02,559
<font color="#E5E5E5">sorry his question was this can you use</font>

525
00:22:59,729 --> 00:23:03,879
local credentials and domain credentials

526
00:23:02,559 --> 00:23:09,690
or is only restricted<font color="#E5E5E5"> to domain</font>

527
00:23:03,879 --> 00:23:09,689
credentials yes

528
00:23:10,349 --> 00:23:17,320
pardon<font color="#E5E5E5"> sorry I'm not at liberty to</font>

529
00:23:15,129 --> 00:23:18,668
really talk<font color="#E5E5E5"> about that that's something</font>

530
00:23:17,320 --> 00:23:20,109
<font color="#CCCCCC">where I'm</font><font color="#E5E5E5"> just not comfortable saying</font>

531
00:23:18,669 --> 00:23:32,559
I'm not going to get into one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those</font>

532
00:23:20,109 --> 00:23:33,730
matches no other questions<font color="#CCCCCC"> okay thank</font>

533
00:23:32,559 --> 00:23:41,379
you

534
00:23:33,730 --> 00:23:41,380
[Applause]

