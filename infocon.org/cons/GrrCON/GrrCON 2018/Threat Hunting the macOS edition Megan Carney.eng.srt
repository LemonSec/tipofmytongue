1
00:00:00,000 --> 00:00:05,640
little late<font color="#CCCCCC"> and I</font><font color="#E5E5E5"> still see people</font>

2
00:00:01,439 --> 00:00:08,580
<font color="#E5E5E5">trickling in</font><font color="#CCCCCC"> I'm just gonna go ahead my</font>

3
00:00:05,640 --> 00:00:12,030
name<font color="#E5E5E5"> is Megan</font><font color="#CCCCCC"> Kearney</font><font color="#E5E5E5"> for people who I</font>

4
00:00:08,580 --> 00:00:14,969
haven't<font color="#E5E5E5"> met before most of you I've been</font>

5
00:00:12,030 --> 00:00:17,599
<font color="#CCCCCC">doing this info sex stuff for 10 years</font>

6
00:00:14,969 --> 00:00:17,599
or so<font color="#CCCCCC"> now</font>

7
00:00:33,870 --> 00:00:42,099
<font color="#E5E5E5">um I left my Twitter handle up here</font>

8
00:00:38,440 --> 00:00:43,660
<font color="#E5E5E5">because if you want to</font><font color="#CCCCCC"> run the queries</font>

9
00:00:42,100 --> 00:00:45,850
in these slides and<font color="#E5E5E5"> you don't want to</font>

10
00:00:43,660 --> 00:00:49,929
type them<font color="#E5E5E5"> out by</font><font color="#CCCCCC"> hand I'm going to post</font>

11
00:00:45,850 --> 00:00:51,010
<font color="#E5E5E5">them on my Twitter feed later all right</font>

12
00:00:49,930 --> 00:00:54,489
so let's get started

13
00:00:51,010 --> 00:00:56,440
<font color="#CCCCCC">thread</font><font color="#E5E5E5"> hunting</font><font color="#CCCCCC"> um the</font><font color="#E5E5E5"> Macintosh Edition</font>

14
00:00:54,489 --> 00:00:58,029
<font color="#E5E5E5">I've seen a lot of threat hunting stuff</font>

15
00:00:56,440 --> 00:01:00,280
for<font color="#E5E5E5"> Windows I haven't seen a lot for</font>

16
00:00:58,030 --> 00:01:04,030
Macintosh<font color="#CCCCCC"> I think it's something we need</font>

17
00:01:00,280 --> 00:01:06,370
<font color="#CCCCCC">to do more of and</font><font color="#E5E5E5"> but before</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> talk</font>

18
00:01:04,030 --> 00:01:08,409
about the Macintosh<font color="#E5E5E5"> angle</font><font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to talk</font>

19
00:01:06,370 --> 00:01:10,210
a little<font color="#CCCCCC"> bit about why you would</font><font color="#E5E5E5"> do</font>

20
00:01:08,409 --> 00:01:12,610
threat hunting at all<font color="#E5E5E5"> and I think the</font>

21
00:01:10,210 --> 00:01:14,559
last presentation<font color="#E5E5E5"> in that room red team</font>

22
00:01:12,610 --> 00:01:17,470
<font color="#CCCCCC">vs. blue team was a really good</font>

23
00:01:14,560 --> 00:01:19,510
<font color="#CCCCCC">demonstration</font><font color="#E5E5E5"> of this because even if</font>

24
00:01:17,470 --> 00:01:22,470
you<font color="#E5E5E5"> have good</font><font color="#CCCCCC"> antivirus even if you have</font>

25
00:01:19,510 --> 00:01:24,909
a really<font color="#CCCCCC"> good idea even if you've got</font><font color="#E5E5E5"> um</font>

26
00:01:22,470 --> 00:01:26,890
<font color="#CCCCCC">Network sensors running all over they're</font>

27
00:01:24,909 --> 00:01:29,680
still gonna<font color="#E5E5E5"> be stuff that</font><font color="#CCCCCC"> doesn't match</font>

28
00:01:26,890 --> 00:01:32,049
signatures<font color="#E5E5E5"> that's bad and that's stuff</font>

29
00:01:29,680 --> 00:01:34,690
you<font color="#E5E5E5"> find by hunting</font><font color="#CCCCCC"> and the thing with</font>

30
00:01:32,049 --> 00:01:36,760
hunting is it's very<font color="#E5E5E5"> environment</font>

31
00:01:34,690 --> 00:01:37,990
<font color="#E5E5E5">dependent so I'm gonna go over a bunch</font>

32
00:01:36,760 --> 00:01:40,240
of queries<font color="#E5E5E5"> today I'm going to talk about</font>

33
00:01:37,990 --> 00:01:41,679
<font color="#CCCCCC">a bunch of stuff</font><font color="#E5E5E5"> you're gonna need to</font>

34
00:01:40,240 --> 00:01:44,649
look at your<font color="#E5E5E5"> own environment and figure</font>

35
00:01:41,680 --> 00:01:46,330
out what's normal because that's why a

36
00:01:44,650 --> 00:01:48,580
lot<font color="#CCCCCC"> of these things sneak</font><font color="#E5E5E5"> through we</font>

37
00:01:46,330 --> 00:01:50,560
look at our tools and<font color="#E5E5E5"> we think they must</font>

38
00:01:48,580 --> 00:01:52,450
be covering everything<font color="#E5E5E5"> they're not</font>

39
00:01:50,560 --> 00:01:55,810
covering everything<font color="#E5E5E5"> they're covering</font>

40
00:01:52,450 --> 00:01:57,340
<font color="#E5E5E5">what they know to</font><font color="#CCCCCC"> be bad because they</font>

41
00:01:55,810 --> 00:01:59,410
don't want their customers<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get a lot</font>

42
00:01:57,340 --> 00:02:01,360
of<font color="#E5E5E5"> false</font><font color="#CCCCCC"> positives right</font><font color="#E5E5E5"> if you want to</font>

43
00:01:59,410 --> 00:02:03,280
define normal for<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> and</font>

44
00:02:01,360 --> 00:02:07,960
look for what's abnormal<font color="#E5E5E5"> that's all</font>

45
00:02:03,280 --> 00:02:11,410
hunting is specifically<font color="#E5E5E5"> this</font>

46
00:02:07,960 --> 00:02:13,060
presentation<font color="#E5E5E5"> this is a</font><font color="#CCCCCC"> screenshot I</font>

47
00:02:11,410 --> 00:02:15,549
think it's a few months<font color="#CCCCCC"> old from threat</font>

48
00:02:13,060 --> 00:02:17,920
hunting net I've highlighted all<font color="#CCCCCC"> of</font>

49
00:02:15,550 --> 00:02:22,030
those<font color="#E5E5E5"> resources there are artifacts that</font>

50
00:02:17,920 --> 00:02:23,440
<font color="#E5E5E5">exist only on</font><font color="#CCCCCC"> Windows so there's a lot</font>

51
00:02:22,030 --> 00:02:25,690
of<font color="#E5E5E5"> threat hunting resources out there</font>

52
00:02:23,440 --> 00:02:27,640
<font color="#E5E5E5">that</font><font color="#CCCCCC"> are not</font><font color="#E5E5E5"> examining what artifacts on</font>

53
00:02:25,690 --> 00:02:30,370
<font color="#CCCCCC">Macs look like and I think this is a</font>

54
00:02:27,640 --> 00:02:33,518
real<font color="#CCCCCC"> weakness for us</font><font color="#E5E5E5"> because everybody</font>

55
00:02:30,370 --> 00:02:35,769
jokes that max don't get malware even

56
00:02:33,519 --> 00:02:37,060
though we know they do right<font color="#E5E5E5"> but how</font>

57
00:02:35,769 --> 00:02:38,680
often<font color="#E5E5E5"> are we actually</font><font color="#CCCCCC"> looking on it</font>

58
00:02:37,060 --> 00:02:40,540
looking for<font color="#E5E5E5"> it and how much</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the Mac</font>

59
00:02:38,680 --> 00:02:42,200
malware are we finding<font color="#E5E5E5"> I would bet</font>

60
00:02:40,540 --> 00:02:46,700
there's a<font color="#E5E5E5"> lot of it we're not finding</font>

61
00:02:42,200 --> 00:02:48,140
<font color="#CCCCCC">because we're</font><font color="#E5E5E5"> not looking</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> happy so</font>

62
00:02:46,700 --> 00:02:50,599
I will be<font color="#E5E5E5"> the first to admit that</font><font color="#CCCCCC"> this</font>

63
00:02:48,140 --> 00:02:52,250
presentation<font color="#E5E5E5"> is just</font><font color="#CCCCCC"> the beginning of</font>

64
00:02:50,599 --> 00:02:54,140
<font color="#E5E5E5">the work we</font><font color="#CCCCCC"> need to do as a community I</font>

65
00:02:52,250 --> 00:02:56,000
know Patrick wordles been doing some

66
00:02:54,140 --> 00:02:58,069
work<font color="#E5E5E5"> I've seen</font><font color="#CCCCCC"> a few other presentations</font>

67
00:02:56,000 --> 00:03:01,280
there's actually a cool conference

68
00:02:58,069 --> 00:03:02,750
<font color="#E5E5E5">that's in Hawaii objective by the sea I</font>

69
00:03:01,280 --> 00:03:05,380
think that's gonna come up<font color="#E5E5E5"> in a</font><font color="#CCCCCC"> few</font>

70
00:03:02,750 --> 00:03:07,550
months<font color="#E5E5E5"> if you happen to be able to go</font>

71
00:03:05,380 --> 00:03:09,049
<font color="#E5E5E5">and we need to do some more work for</font>

72
00:03:07,550 --> 00:03:10,940
<font color="#E5E5E5">this I think we're at the</font><font color="#CCCCCC"> beginning of</font>

73
00:03:09,049 --> 00:03:14,599
<font color="#E5E5E5">this work and I</font><font color="#CCCCCC"> just want to</font><font color="#E5E5E5"> acknowledge</font>

74
00:03:10,940 --> 00:03:17,329
that<font color="#E5E5E5"> that this is</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> the end of</font><font color="#CCCCCC"> what we</font>

75
00:03:14,599 --> 00:03:19,190
need<font color="#E5E5E5"> to accomplish</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so that's</font>

76
00:03:17,330 --> 00:03:21,470
<font color="#CCCCCC">my pep talk does</font><font color="#E5E5E5"> that count as a pep</font>

77
00:03:19,190 --> 00:03:23,569
<font color="#CCCCCC">talk I want to talk about my experiment</font>

78
00:03:21,470 --> 00:03:26,359
so I come from<font color="#E5E5E5"> an academic</font><font color="#CCCCCC"> background</font>

79
00:03:23,569 --> 00:03:32,899
and<font color="#E5E5E5"> I believe in showing your work what</font>

80
00:03:26,360 --> 00:03:36,650
we have here is yeah sort of an emoji<font color="#E5E5E5"> an</font>

81
00:03:32,900 --> 00:03:38,720
emoji explanation of the work I did<font color="#E5E5E5"> so</font>

82
00:03:36,650 --> 00:03:40,579
what I<font color="#CCCCCC"> did was I took this Mac Mini I</font>

83
00:03:38,720 --> 00:03:42,950
ran a bunch<font color="#E5E5E5"> of malware samples through</font>

84
00:03:40,579 --> 00:03:45,590
it<font color="#E5E5E5"> but before I did that I altered it</font>

85
00:03:42,950 --> 00:03:48,048
and I removed<font color="#E5E5E5"> the Wi-Fi card this was so</font>

86
00:03:45,590 --> 00:03:50,030
I knew exactly<font color="#E5E5E5"> where</font><font color="#CCCCCC"> it could</font><font color="#E5E5E5"> talk out</font>

87
00:03:48,049 --> 00:03:51,560
<font color="#E5E5E5">so if it didn't have an Ethernet</font><font color="#CCCCCC"> cable</font>

88
00:03:50,030 --> 00:03:53,540
plugged in and it didn't have<font color="#E5E5E5"> the</font>

89
00:03:51,560 --> 00:03:56,239
<font color="#CCCCCC">cellphone modem plugged in I knew it</font>

90
00:03:53,540 --> 00:04:00,380
wasn't talking to<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> I had a</font>

91
00:03:56,239 --> 00:04:02,569
process<font color="#E5E5E5"> monitoring solution installed if</font>

92
00:04:00,380 --> 00:04:04,069
you are<font color="#CCCCCC"> familiar with it you will</font>

93
00:04:02,569 --> 00:04:06,260
recognize the screenshots as I go

94
00:04:04,069 --> 00:04:07,940
through<font color="#CCCCCC"> this presentation I don't want</font>

95
00:04:06,260 --> 00:04:09,470
you to get<font color="#E5E5E5"> too hung up on</font><font color="#CCCCCC"> exactly what</font>

96
00:04:07,940 --> 00:04:12,290
<font color="#E5E5E5">that</font><font color="#CCCCCC"> process monitoring solution is</font>

97
00:04:09,470 --> 00:04:14,600
because<font color="#CCCCCC"> it</font><font color="#E5E5E5"> doesn't matter if you have</font>

98
00:04:12,290 --> 00:04:17,029
any sort<font color="#CCCCCC"> of process monitoring solution</font>

99
00:04:14,600 --> 00:04:19,339
that's going to record what's executing

100
00:04:17,029 --> 00:04:22,369
on your hosts<font color="#E5E5E5"> you can use</font><font color="#CCCCCC"> this research</font>

101
00:04:19,339 --> 00:04:25,638
<font color="#CCCCCC">I use time machine</font><font color="#E5E5E5"> to reset between</font>

102
00:04:22,370 --> 00:04:30,020
experiments<font color="#CCCCCC"> just because it was built in</font>

103
00:04:25,639 --> 00:04:32,030
and it was easy<font color="#E5E5E5"> this you'll notice his</font>

104
00:04:30,020 --> 00:04:33,500
separate<font color="#E5E5E5"> hardware so there are no</font>

105
00:04:32,030 --> 00:04:35,020
virtual<font color="#E5E5E5"> machines involved here which</font>

106
00:04:33,500 --> 00:04:39,349
<font color="#CCCCCC">means I didn't have to worry about</font>

107
00:04:35,020 --> 00:04:41,810
<font color="#E5E5E5">virtual machine evasion techniques there</font>

108
00:04:39,349 --> 00:04:43,820
are<font color="#E5E5E5"> some good</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> about it the way</font>

109
00:04:41,810 --> 00:04:46,039
this experiment is<font color="#E5E5E5"> set up there are some</font>

110
00:04:43,820 --> 00:04:47,810
bad things<font color="#E5E5E5"> I'm going to talk</font><font color="#CCCCCC"> about that</font>

111
00:04:46,039 --> 00:04:50,360
more<font color="#E5E5E5"> towards the end of the presentation</font>

112
00:04:47,810 --> 00:04:52,780
but<font color="#CCCCCC"> this is the environment I was</font>

113
00:04:50,360 --> 00:04:52,780
working in

114
00:04:53,039 --> 00:04:58,740
the malware<font color="#CCCCCC"> samples</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> are going</font><font color="#E5E5E5"> to</font>

115
00:04:56,699 --> 00:05:00,809
<font color="#CCCCCC">do research on</font><font color="#E5E5E5"> Mac malware</font><font color="#CCCCCC"> I recommend</font>

116
00:04:58,740 --> 00:05:03,689
you start<font color="#E5E5E5"> with Patrick wordles very</font>

117
00:05:00,809 --> 00:05:05,819
<font color="#E5E5E5">excellent collection on his site because</font>

118
00:05:03,689 --> 00:05:08,939
he has a lot of samples<font color="#E5E5E5"> that are really</font>

119
00:05:05,819 --> 00:05:11,159
easy to<font color="#E5E5E5"> run you can search for</font><font color="#CCCCCC"> mono</font>

120
00:05:08,939 --> 00:05:14,789
samples on<font color="#CCCCCC"> virustotal and there are a</font>

121
00:05:11,159 --> 00:05:18,149
lot of them<font color="#E5E5E5"> however some of them require</font>

122
00:05:14,789 --> 00:05:19,889
I don't want to get too<font color="#E5E5E5"> much in the</font>

123
00:05:18,149 --> 00:05:21,990
weeds<font color="#CCCCCC"> here</font><font color="#E5E5E5"> some of</font><font color="#CCCCCC"> them require being</font>

124
00:05:19,889 --> 00:05:23,249
<font color="#E5E5E5">part of an app bundle to run and unless</font>

125
00:05:21,990 --> 00:05:24,779
you know<font color="#E5E5E5"> how to build that app bundle</font>

126
00:05:23,249 --> 00:05:27,629
<font color="#CCCCCC">you may have some trouble getting</font>

127
00:05:24,779 --> 00:05:30,089
<font color="#E5E5E5">started</font><font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> want to mess</font><font color="#CCCCCC"> with it so</font>

128
00:05:27,629 --> 00:05:33,149
I use<font color="#E5E5E5"> Patrick whorls collection and it's</font>

129
00:05:30,089 --> 00:05:36,779
a very good<font color="#E5E5E5"> place to</font><font color="#CCCCCC"> start</font><font color="#E5E5E5"> um before I</font>

130
00:05:33,149 --> 00:05:38,399
move on if you<font color="#CCCCCC"> haven't played with</font>

131
00:05:36,779 --> 00:05:40,710
malware before and you're going to<font color="#E5E5E5"> start</font>

132
00:05:38,399 --> 00:05:43,710
<font color="#CCCCCC">doing this research please do your</font>

133
00:05:40,710 --> 00:05:46,229
homework<font color="#E5E5E5"> unfortunately there aren't a</font>

134
00:05:43,710 --> 00:05:49,289
<font color="#CCCCCC">lot of</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> even know of a book</font>

135
00:05:46,229 --> 00:05:50,818
<font color="#CCCCCC">that focuses</font><font color="#E5E5E5"> on Mac malware research</font><font color="#CCCCCC"> but</font>

136
00:05:49,289 --> 00:05:53,490
there is a book called practical<font color="#E5E5E5"> malware</font>

137
00:05:50,819 --> 00:05:56,219
analysis which is<font color="#E5E5E5"> sort of the</font><font color="#CCCCCC"> current</font>

138
00:05:53,490 --> 00:05:57,779
Bible for malware<font color="#E5E5E5"> analysis it's got a</font>

139
00:05:56,219 --> 00:06:00,479
good<font color="#E5E5E5"> overview</font><font color="#CCCCCC"> on how</font><font color="#E5E5E5"> to set</font><font color="#CCCCCC"> up an</font>

140
00:05:57,779 --> 00:06:01,620
environment<font color="#CCCCCC"> to safely</font><font color="#E5E5E5"> detonate malware</font>

141
00:06:00,479 --> 00:06:03,748
and the things you need<font color="#CCCCCC"> to worry about</font>

142
00:06:01,620 --> 00:06:06,509
<font color="#E5E5E5">so if you're interested</font><font color="#CCCCCC"> in starting this</font>

143
00:06:03,749 --> 00:06:08,909
<font color="#E5E5E5">work that's where I'd start but</font><font color="#CCCCCC"> do do</font>

144
00:06:06,509 --> 00:06:13,860
your homework<font color="#CCCCCC"> or else bad things will</font>

145
00:06:08,909 --> 00:06:15,449
happen so I talked about<font color="#E5E5E5"> threat hunting</font>

146
00:06:13,860 --> 00:06:17,669
a little<font color="#CCCCCC"> bit I talked about normal</font>

147
00:06:15,449 --> 00:06:20,939
versus abnormal<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I want to talk a</font>

148
00:06:17,669 --> 00:06:22,469
little<font color="#CCCCCC"> bit more</font><font color="#E5E5E5"> about what this</font>

149
00:06:20,939 --> 00:06:24,629
<font color="#CCCCCC">experiment is actually trying to achieve</font>

150
00:06:22,469 --> 00:06:26,330
<font color="#E5E5E5">I wasn't trying to find</font><font color="#CCCCCC"> specific</font>

151
00:06:24,629 --> 00:06:28,499
indicators<font color="#E5E5E5"> if you want specific</font>

152
00:06:26,330 --> 00:06:30,628
<font color="#E5E5E5">indicators you can</font><font color="#CCCCCC"> get a hash of a file</font>

153
00:06:28,499 --> 00:06:32,969
you can<font color="#CCCCCC"> search for specific strings in</font>

154
00:06:30,629 --> 00:06:35,279
the file you<font color="#E5E5E5"> can search</font><font color="#CCCCCC"> for network</font>

155
00:06:32,969 --> 00:06:36,870
indicators where does it call out to<font color="#E5E5E5"> all</font>

156
00:06:35,279 --> 00:06:39,749
<font color="#E5E5E5">these things are</font><font color="#CCCCCC"> useful for</font><font color="#E5E5E5"> identifying</font>

157
00:06:36,870 --> 00:06:41,519
specific strains of malware<font color="#E5E5E5"> that</font><font color="#CCCCCC"> was not</font>

158
00:06:39,749 --> 00:06:43,409
the<font color="#E5E5E5"> goal</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> experiment the goal of</font>

159
00:06:41,519 --> 00:06:47,870
this experiment<font color="#E5E5E5"> was</font><font color="#CCCCCC"> to find the</font><font color="#E5E5E5"> general</font>

160
00:06:43,409 --> 00:06:47,870
behavior<font color="#CCCCCC"> patterns that indicate badness</font>

161
00:06:48,259 --> 00:06:54,300
specifically what does<font color="#CCCCCC"> a malicious word</font>

162
00:06:51,719 --> 00:06:57,569
process look like<font color="#CCCCCC"> on a Mac there are</font>

163
00:06:54,300 --> 00:06:59,669
word macros for<font color="#E5E5E5"> a Macintosh they exist</font>

164
00:06:57,569 --> 00:07:01,979
there's just not<font color="#E5E5E5"> many publicly known</font>

165
00:06:59,669 --> 00:07:03,849
samples

166
00:07:01,979 --> 00:07:06,250
what does now where do to maintain

167
00:07:03,850 --> 00:07:07,660
persistence on a Mac you know we know a

168
00:07:06,250 --> 00:07:12,070
lot<font color="#CCCCCC"> about what it does on</font><font color="#E5E5E5"> Windows</font>

169
00:07:07,660 --> 00:07:13,539
scheduled tasks<font color="#E5E5E5"> installing in the users</font>

170
00:07:12,070 --> 00:07:14,500
home<font color="#E5E5E5"> directory what does that look like</font>

171
00:07:13,539 --> 00:07:17,020
<font color="#E5E5E5">on a Mac</font>

172
00:07:14,500 --> 00:07:19,539
what does malware want to hide so what

173
00:07:17,020 --> 00:07:21,580
are what<font color="#CCCCCC"> are</font><font color="#E5E5E5"> the signs that it tries to</font>

174
00:07:19,539 --> 00:07:23,500
<font color="#E5E5E5">erase once it's gaining a foothold</font><font color="#CCCCCC"> and</font>

175
00:07:21,580 --> 00:07:25,479
<font color="#E5E5E5">what is getting a foothold look like</font>

176
00:07:23,500 --> 00:07:26,979
what are they<font color="#CCCCCC"> trying to do on</font><font color="#E5E5E5"> the system</font>

177
00:07:25,479 --> 00:07:27,400
what<font color="#CCCCCC"> are</font><font color="#E5E5E5"> the system commands they try to</font>

178
00:07:26,979 --> 00:07:30,400
run

179
00:07:27,400 --> 00:07:33,789
what do where do malware processes and

180
00:07:30,400 --> 00:07:35,710
their artifacts<font color="#E5E5E5"> live so a common place</font>

181
00:07:33,789 --> 00:07:37,630
<font color="#CCCCCC">to see malware on Windows is in the</font>

182
00:07:35,710 --> 00:07:39,609
<font color="#E5E5E5">users documents in settings directory</font>

183
00:07:37,630 --> 00:07:41,710
nothing typically runs out of<font color="#E5E5E5"> the</font>

184
00:07:39,610 --> 00:07:43,960
documents and<font color="#E5E5E5"> settings directory but</font>

185
00:07:41,710 --> 00:07:45,729
users<font color="#E5E5E5"> have rights</font><font color="#CCCCCC"> so you don't need to</font>

186
00:07:43,960 --> 00:07:50,320
<font color="#E5E5E5">install</font><font color="#CCCCCC"> your malware there</font><font color="#E5E5E5"> what does</font>

187
00:07:45,729 --> 00:07:52,930
that look<font color="#CCCCCC"> like on a Mac</font><font color="#E5E5E5"> since we're</font>

188
00:07:50,320 --> 00:07:54,070
running<font color="#CCCCCC"> a little bit low on time</font>

189
00:07:52,930 --> 00:07:57,009
I'm<font color="#E5E5E5"> going to go</font><font color="#CCCCCC"> over the rest of these</font>

190
00:07:54,070 --> 00:07:59,219
<font color="#E5E5E5">questions later this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> basically the</font>

191
00:07:57,009 --> 00:08:01,960
<font color="#E5E5E5">outline for</font><font color="#CCCCCC"> my entire presentation</font>

192
00:07:59,220 --> 00:08:03,880
<font color="#CCCCCC">you're gonna see a bunch</font><font color="#E5E5E5"> of queries and</font>

193
00:08:01,960 --> 00:08:08,349
I promise I will<font color="#E5E5E5"> give you the full index</font>

194
00:08:03,880 --> 00:08:10,090
of<font color="#E5E5E5"> all the queries at the end and yeah</font>

195
00:08:08,349 --> 00:08:13,990
<font color="#E5E5E5">we'll talk about some</font><font color="#CCCCCC"> more stuff</font><font color="#E5E5E5"> with</font>

196
00:08:10,090 --> 00:08:16,000
our later<font color="#E5E5E5"> so this is a word macro on a</font>

197
00:08:13,990 --> 00:08:18,159
Macintosh<font color="#E5E5E5"> you can get the sample</font><font color="#CCCCCC"> from</font>

198
00:08:16,000 --> 00:08:21,099
<font color="#E5E5E5">Patrick Wardle site it's actually kind</font>

199
00:08:18,159 --> 00:08:25,210
of fascinating<font color="#E5E5E5"> in</font><font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> very similar</font>

200
00:08:21,099 --> 00:08:27,550
<font color="#E5E5E5">to</font><font color="#CCCCCC"> a macro</font><font color="#E5E5E5"> on the windows side right so</font>

201
00:08:25,210 --> 00:08:30,460
we have Microsoft Word<font color="#E5E5E5"> launching a show</font>

202
00:08:27,550 --> 00:08:32,500
which launches<font color="#E5E5E5"> Python which launches</font>

203
00:08:30,460 --> 00:08:35,468
that<font color="#E5E5E5"> PS command</font>

204
00:08:32,500 --> 00:08:38,080
for those of you not familiar with<font color="#E5E5E5"> UNIX</font>

205
00:08:35,469 --> 00:08:39,700
<font color="#E5E5E5">stuff that lists processes and then to</font>

206
00:08:38,080 --> 00:08:42,490
grep commands we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> find out more</font>

207
00:08:39,700 --> 00:08:45,670
about what they do<font color="#CCCCCC"> later so this isn't</font>

208
00:08:42,490 --> 00:08:48,160
<font color="#E5E5E5">PowerShell right but where it doesn't</font>

209
00:08:45,670 --> 00:08:49,569
<font color="#CCCCCC">launch Python very often</font><font color="#E5E5E5"> so these are</font>

210
00:08:48,160 --> 00:08:51,939
<font color="#CCCCCC">women this is one of the things you can</font>

211
00:08:49,570 --> 00:08:54,610
<font color="#E5E5E5">look for how would you find this in</font><font color="#CCCCCC"> your</font>

212
00:08:51,940 --> 00:08:58,149
environment<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to look at</font>

213
00:08:54,610 --> 00:08:59,800
parent-child relationships so again this

214
00:08:58,149 --> 00:09:02,079
is a<font color="#E5E5E5"> specific</font><font color="#CCCCCC"> process monitoring</font>

215
00:08:59,800 --> 00:09:04,449
solution<font color="#E5E5E5"> don't get too hung up on that</font>

216
00:09:02,079 --> 00:09:07,599
what I want you<font color="#CCCCCC"> to recognize is that</font>

217
00:09:04,450 --> 00:09:09,640
<font color="#CCCCCC">this solution</font><font color="#E5E5E5"> has IDs that tie parent</font>

218
00:09:07,600 --> 00:09:11,740
processes to children so it all starts

219
00:09:09,640 --> 00:09:13,000
with<font color="#CCCCCC"> that Microsoft Word and</font><font color="#E5E5E5"> then</font>

220
00:09:11,740 --> 00:09:14,370
trickles down to<font color="#CCCCCC"> all these other</font>

221
00:09:13,000 --> 00:09:17,209
<font color="#CCCCCC">processes</font>

222
00:09:14,370 --> 00:09:20,069
and you can see that<font color="#CCCCCC"> grip process</font><font color="#E5E5E5"> there</font>

223
00:09:17,209 --> 00:09:21,479
<font color="#E5E5E5">grep for Little Snitch</font><font color="#CCCCCC"> if you are</font>

224
00:09:20,069 --> 00:09:23,610
<font color="#CCCCCC">familiar</font><font color="#E5E5E5"> with Little Snitch it's a</font>

225
00:09:21,480 --> 00:09:25,470
personal firewall<font color="#CCCCCC"> so what this malware</font>

226
00:09:23,610 --> 00:09:28,399
sample is doing is saying<font color="#E5E5E5"> if</font><font color="#CCCCCC"> Little</font>

227
00:09:25,470 --> 00:09:31,649
<font color="#CCCCCC">Snitch is present</font><font color="#E5E5E5"> it's gonna find me so</font>

228
00:09:28,399 --> 00:09:35,639
exit<font color="#E5E5E5"> but otherwise we're gonna continue</font>

229
00:09:31,649 --> 00:09:38,160
<font color="#CCCCCC">oh and you can see they're using base64</font>

230
00:09:35,639 --> 00:09:40,079
<font color="#E5E5E5">which is another thing</font><font color="#CCCCCC"> that also</font><font color="#E5E5E5"> happens</font>

231
00:09:38,160 --> 00:09:41,279
on<font color="#E5E5E5"> the windows side of the world except</font>

232
00:09:40,079 --> 00:09:45,839
<font color="#E5E5E5">this time they're passing it</font><font color="#CCCCCC"> to Python</font>

233
00:09:41,279 --> 00:09:48,870
because<font color="#E5E5E5"> PowerShell is not on Macs well</font>

234
00:09:45,839 --> 00:09:52,319
not natively<font color="#CCCCCC"> alright so how can we</font>

235
00:09:48,870 --> 00:09:54,269
detect word macros on a Mac this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

236
00:09:52,319 --> 00:09:56,219
really simple<font color="#E5E5E5"> question</font><font color="#CCCCCC"> I don't want you</font>

237
00:09:54,269 --> 00:09:59,459
to get too wrapped up<font color="#E5E5E5"> in the specifics</font>

238
00:09:56,220 --> 00:10:02,160
<font color="#E5E5E5">here this is actually a</font><font color="#CCCCCC"> spunk query for</font>

239
00:09:59,459 --> 00:10:04,378
those of you who<font color="#CCCCCC"> knows longer but</font>

240
00:10:02,160 --> 00:10:06,480
basically what we're asking<font color="#E5E5E5"> is what</font>

241
00:10:04,379 --> 00:10:09,209
processes does word typically launch<font color="#E5E5E5"> and</font>

242
00:10:06,480 --> 00:10:12,300
how many of them just<font color="#CCCCCC"> to set a baseline</font>

243
00:10:09,209 --> 00:10:14,839
<font color="#E5E5E5">for your environment</font><font color="#CCCCCC"> if you have an</font>

244
00:10:12,300 --> 00:10:17,040
accounting department that runs a lot of

245
00:10:14,839 --> 00:10:19,379
specialized Word documents or

246
00:10:17,040 --> 00:10:23,069
spreadsheets<font color="#CCCCCC"> maybe this is gonna look</font>

247
00:10:19,379 --> 00:10:25,499
<font color="#CCCCCC">different</font><font color="#E5E5E5"> for you but it will</font><font color="#CCCCCC"> answer it</font>

248
00:10:23,069 --> 00:10:28,439
will answer the<font color="#CCCCCC"> basic question</font><font color="#E5E5E5"> and what</font>

249
00:10:25,499 --> 00:10:29,790
do<font color="#E5E5E5"> we see</font><font color="#CCCCCC"> I love it when you</font><font color="#E5E5E5"> find</font>

250
00:10:28,439 --> 00:10:31,709
indicators like this because a lot<font color="#CCCCCC"> of</font>

251
00:10:29,790 --> 00:10:33,329
<font color="#E5E5E5">times you</font><font color="#CCCCCC"> start with a hypothesis and</font>

252
00:10:31,709 --> 00:10:35,219
you<font color="#CCCCCC"> look at the</font><font color="#E5E5E5"> data and it's really</font>

253
00:10:33,329 --> 00:10:37,258
messy and<font color="#E5E5E5"> complicated and hard to pick</font>

254
00:10:35,220 --> 00:10:39,629
out<font color="#E5E5E5"> the signal but this one's pretty</font>

255
00:10:37,259 --> 00:10:42,360
simple<font color="#E5E5E5"> right there is a normal</font>

256
00:10:39,629 --> 00:10:44,339
<font color="#E5E5E5">collection of word processes at most</font>

257
00:10:42,360 --> 00:10:47,579
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> launching two processes in the</font>

258
00:10:44,339 --> 00:10:49,259
tree at most and then we look<font color="#E5E5E5"> down</font><font color="#CCCCCC"> here</font>

259
00:10:47,579 --> 00:10:51,870
and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what abnormal looks like</font>

260
00:10:49,259 --> 00:10:56,699
there's our macro in the center<font color="#E5E5E5"> it's</font>

261
00:10:51,870 --> 00:10:57,839
launched what<font color="#E5E5E5"> six processes</font><font color="#CCCCCC"> and it</font>

262
00:10:56,699 --> 00:11:00,120
includes command<font color="#E5E5E5"> line that</font><font color="#CCCCCC"> includes</font>

263
00:10:57,839 --> 00:11:01,519
<font color="#CCCCCC">Python and if you'll notice in the</font>

264
00:11:00,120 --> 00:11:06,600
normal situation

265
00:11:01,519 --> 00:11:08,100
all of those<font color="#CCCCCC"> are office binaries so this</font>

266
00:11:06,600 --> 00:11:10,800
is a really simple signal in<font color="#CCCCCC"> your</font>

267
00:11:08,100 --> 00:11:13,819
environment<font color="#CCCCCC"> if you're looking just look</font>

268
00:11:10,800 --> 00:11:18,389
at what word normally launches<font color="#E5E5E5"> and then</font>

269
00:11:13,819 --> 00:11:19,620
look<font color="#E5E5E5"> for variations from that but you</font>

270
00:11:18,389 --> 00:11:22,290
might want<font color="#CCCCCC"> to approach this</font><font color="#E5E5E5"> from the</font>

271
00:11:19,620 --> 00:11:23,970
opposite<font color="#CCCCCC"> direction right maybe instead</font>

272
00:11:22,290 --> 00:11:25,620
of<font color="#E5E5E5"> investigating an entire fleet of</font>

273
00:11:23,970 --> 00:11:27,170
machines<font color="#CCCCCC"> you're investigating one</font>

274
00:11:25,620 --> 00:11:28,760
specific machine and you

275
00:11:27,170 --> 00:11:31,790
want to say<font color="#E5E5E5"> I know they</font><font color="#CCCCCC"> opened</font><font color="#E5E5E5"> this</font>

276
00:11:28,760 --> 00:11:34,880
weird document<font color="#E5E5E5"> but what did word run on</font>

277
00:11:31,790 --> 00:11:38,209
that machine<font color="#CCCCCC"> that</font><font color="#E5E5E5"> wasn't from word</font><font color="#CCCCCC"> and</font>

278
00:11:34,880 --> 00:11:40,339
that's what this<font color="#E5E5E5"> query does uh so again</font>

279
00:11:38,209 --> 00:11:41,989
<font color="#E5E5E5">don't get too caught in the weeds</font>

280
00:11:40,339 --> 00:11:45,170
basically what it's doing<font color="#CCCCCC"> is it's saying</font>

281
00:11:41,990 --> 00:11:46,430
<font color="#E5E5E5">look for all the word processes</font><font color="#CCCCCC"> and then</font>

282
00:11:45,170 --> 00:11:49,099
show me<font color="#CCCCCC"> everything</font><font color="#E5E5E5"> that's associated</font>

283
00:11:46,430 --> 00:11:52,790
with<font color="#CCCCCC"> those</font><font color="#E5E5E5"> processes it's not actually</font>

284
00:11:49,100 --> 00:11:54,279
word<font color="#E5E5E5"> if you are using spunk</font><font color="#CCCCCC"> I want to</font>

285
00:11:52,790 --> 00:11:57,170
make you aware<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> gotcha</font>

286
00:11:54,279 --> 00:12:00,560
<font color="#CCCCCC">this lunk has a number</font><font color="#E5E5E5"> of settings</font><font color="#CCCCCC"> that</font>

287
00:11:57,170 --> 00:12:02,149
<font color="#CCCCCC">have to do with</font><font color="#E5E5E5"> making</font><font color="#CCCCCC"> sure one query is</font>

288
00:12:00,560 --> 00:12:03,199
not<font color="#E5E5E5"> going to kill the cluster for</font>

289
00:12:02,149 --> 00:12:05,000
<font color="#E5E5E5">everyone</font>

290
00:12:03,199 --> 00:12:07,579
basically it limits the amount<font color="#CCCCCC"> of memory</font>

291
00:12:05,000 --> 00:12:09,800
<font color="#E5E5E5">that</font><font color="#CCCCCC"> a particular query can use by</font>

292
00:12:07,579 --> 00:12:13,339
<font color="#CCCCCC">default</font><font color="#E5E5E5"> when you're doing sub searches</font>

293
00:12:09,800 --> 00:12:15,170
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> get 10,000</font><font color="#CCCCCC"> items</font><font color="#E5E5E5"> so if for</font>

294
00:12:13,339 --> 00:12:18,980
some reason you<font color="#E5E5E5"> have a machine</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> ran</font>

295
00:12:15,170 --> 00:12:20,599
more<font color="#CCCCCC"> than</font><font color="#E5E5E5"> 10,000</font><font color="#CCCCCC"> instances of Microsoft</font>

296
00:12:18,980 --> 00:12:22,730
Word over<font color="#E5E5E5"> the</font><font color="#CCCCCC"> timeframe you're searching</font>

297
00:12:20,600 --> 00:12:26,600
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> have some false negatives</font>

298
00:12:22,730 --> 00:12:29,870
so just watch<font color="#E5E5E5"> your time frames</font><font color="#CCCCCC"> and keep</font>

299
00:12:26,600 --> 00:12:32,120
an eye<font color="#CCCCCC"> on that but</font><font color="#E5E5E5"> this is what we get</font>

300
00:12:29,870 --> 00:12:33,500
and<font color="#E5E5E5"> it's pretty clear right here are the</font>

301
00:12:32,120 --> 00:12:35,660
things<font color="#E5E5E5"> that were launched that aren't</font>

302
00:12:33,500 --> 00:12:42,560
word<font color="#E5E5E5"> and you can immediately see</font><font color="#CCCCCC"> that</font>

303
00:12:35,660 --> 00:12:46,380
this probably is not<font color="#CCCCCC"> a good thing all</font>

304
00:12:42,560 --> 00:12:47,469
right<font color="#E5E5E5"> so we're moving on</font><font color="#CCCCCC"> to persistence</font>

305
00:12:46,380 --> 00:12:51,980
[Music]

306
00:12:47,470 --> 00:12:53,600
<font color="#CCCCCC">this is the most common or one of the</font>

307
00:12:51,980 --> 00:12:56,300
most<font color="#CCCCCC"> common ways to</font><font color="#E5E5E5"> maintain persistence</font>

308
00:12:53,600 --> 00:12:58,610
on a Mac it's sort of<font color="#CCCCCC"> equivalent to</font>

309
00:12:56,300 --> 00:13:02,569
<font color="#CCCCCC">scheduled tasks</font><font color="#E5E5E5"> they're called launch</font>

310
00:12:58,610 --> 00:13:04,550
agents<font color="#E5E5E5"> they run on</font><font color="#CCCCCC"> boots they can run</font>

311
00:13:02,570 --> 00:13:07,459
<font color="#E5E5E5">you</font><font color="#CCCCCC"> they can be</font><font color="#E5E5E5"> installed from the</font>

312
00:13:04,550 --> 00:13:09,050
system<font color="#CCCCCC"> vitamin</font><font color="#E5E5E5"> system in the system</font>

313
00:13:07,459 --> 00:13:13,609
directory or they can be<font color="#E5E5E5"> installed on</font><font color="#CCCCCC"> a</font>

314
00:13:09,050 --> 00:13:16,010
per<font color="#E5E5E5"> user basis all this command does</font><font color="#CCCCCC"> is</font>

315
00:13:13,610 --> 00:13:17,870
it looking<font color="#E5E5E5"> for all the processes that</font>

316
00:13:16,010 --> 00:13:20,269
contain launch agents in the past and

317
00:13:17,870 --> 00:13:21,610
then it's<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to count them and you'll</font>

318
00:13:20,269 --> 00:13:25,430
notice<font color="#E5E5E5"> there's a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of fancy</font>

319
00:13:21,610 --> 00:13:27,110
<font color="#E5E5E5">regex there because</font><font color="#CCCCCC"> Google Chrome is</font>

320
00:13:25,430 --> 00:13:30,709
<font color="#CCCCCC">often</font><font color="#E5E5E5"> installed in the user's home</font>

321
00:13:27,110 --> 00:13:33,410
directory<font color="#CCCCCC"> and so if you don't strip</font><font color="#E5E5E5"> out</font>

322
00:13:30,709 --> 00:13:34,939
the<font color="#CCCCCC"> user's home directory</font><font color="#E5E5E5"> from the past</font>

323
00:13:33,410 --> 00:13:37,069
<font color="#E5E5E5">what you get is a</font><font color="#CCCCCC"> bunch of things that</font>

324
00:13:34,940 --> 00:13:39,110
<font color="#E5E5E5">look unique but aren't because it's</font>

325
00:13:37,069 --> 00:13:40,959
basically<font color="#E5E5E5"> Chrome but for each</font><font color="#CCCCCC"> one of</font>

326
00:13:39,110 --> 00:13:43,540
your users

327
00:13:40,960 --> 00:13:45,399
so this is something<font color="#CCCCCC"> I didn't get to do</font>

328
00:13:43,540 --> 00:13:47,050
because<font color="#E5E5E5"> of the experiment setup I had</font>

329
00:13:45,399 --> 00:13:49,720
but if you want to<font color="#E5E5E5"> run this query</font>

330
00:13:47,050 --> 00:13:51,729
regularly<font color="#E5E5E5"> look at using summary indexing</font>

331
00:13:49,720 --> 00:13:53,890
or whatever the equivalent<font color="#E5E5E5"> is for your</font>

332
00:13:51,730 --> 00:13:56,470
sim<font color="#E5E5E5"> because it will make it much more</font>

333
00:13:53,890 --> 00:13:59,529
efficient there are hundreds of launch

334
00:13:56,470 --> 00:14:02,050
agents on a Mac before<font color="#E5E5E5"> you even install</font>

335
00:13:59,529 --> 00:14:03,939
anything<font color="#CCCCCC"> so this is going to return a</font>

336
00:14:02,050 --> 00:14:06,729
lot<font color="#E5E5E5"> of data and if you're going to run</font>

337
00:14:03,940 --> 00:14:08,649
<font color="#E5E5E5">it over large periods of time your sim</font>

338
00:14:06,730 --> 00:14:09,370
is probably<font color="#E5E5E5"> not going to like</font><font color="#CCCCCC"> you very</font>

339
00:14:08,649 --> 00:14:11,860
<font color="#CCCCCC">much</font>

340
00:14:09,370 --> 00:14:15,010
so summary indexing or something<font color="#E5E5E5"> similar</font>

341
00:14:11,860 --> 00:14:18,610
will help but all of those cautions

342
00:14:15,010 --> 00:14:20,470
being said what do we find<font color="#E5E5E5"> it's really</font>

343
00:14:18,610 --> 00:14:24,180
<font color="#CCCCCC">neat how things like</font><font color="#E5E5E5"> this pop out right</font>

344
00:14:20,470 --> 00:14:26,980
<font color="#E5E5E5">away</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is Sam loader which is more</font>

345
00:14:24,180 --> 00:14:28,029
<font color="#CCCCCC">crapware than malware</font><font color="#E5E5E5"> but you probably</font>

346
00:14:26,980 --> 00:14:31,480
<font color="#E5E5E5">still want to know if it's on your</font>

347
00:14:28,029 --> 00:14:33,279
<font color="#E5E5E5">system if you are not familiar with Mac</font>

348
00:14:31,480 --> 00:14:34,959
<font color="#E5E5E5">keeper those names aren't going to jump</font>

349
00:14:33,279 --> 00:14:37,300
out<font color="#E5E5E5"> at you but you'll notice the</font>

350
00:14:34,959 --> 00:14:39,160
frequency there it is the only machine

351
00:14:37,300 --> 00:14:41,829
in the fleet<font color="#CCCCCC"> that has</font><font color="#E5E5E5"> this installed</font>

352
00:14:39,160 --> 00:14:46,209
<font color="#E5E5E5">which is always a red flag</font><font color="#CCCCCC"> and something</font>

353
00:14:41,830 --> 00:14:48,580
<font color="#E5E5E5">you want to look</font><font color="#CCCCCC"> out for where does</font>

354
00:14:46,209 --> 00:14:53,229
malware<font color="#E5E5E5"> what does malware want to hide</font>

355
00:14:48,580 --> 00:14:54,910
<font color="#E5E5E5">this was a really cool</font><font color="#CCCCCC"> result that I was</font>

356
00:14:53,230 --> 00:14:57,130
totally<font color="#CCCCCC"> not</font><font color="#E5E5E5"> expecting when I started</font>

357
00:14:54,910 --> 00:14:58,300
this experiment<font color="#CCCCCC"> and before I talk to you</font>

358
00:14:57,130 --> 00:15:00,730
about what<font color="#CCCCCC"> the result is I need to</font>

359
00:14:58,300 --> 00:15:02,620
<font color="#CCCCCC">explain something about Apple's internal</font>

360
00:15:00,730 --> 00:15:06,220
systems they<font color="#E5E5E5"> have something called a</font>

361
00:15:02,620 --> 00:15:08,020
quarantine attribute it is<font color="#E5E5E5"> opt in but</font>

362
00:15:06,220 --> 00:15:11,500
most<font color="#E5E5E5"> well behaved browsers follow it</font>

363
00:15:08,020 --> 00:15:14,020
which means when you download a file the

364
00:15:11,500 --> 00:15:15,880
file<font color="#E5E5E5"> is labeled by the browser as having</font>

365
00:15:14,020 --> 00:15:18,040
been downloaded from the internet<font color="#CCCCCC"> where</font>

366
00:15:15,880 --> 00:15:21,279
it was<font color="#CCCCCC"> downloaded from</font><font color="#E5E5E5"> what time it</font><font color="#CCCCCC"> was</font>

367
00:15:18,040 --> 00:15:24,279
downloaded and which<font color="#E5E5E5"> a program</font>

368
00:15:21,279 --> 00:15:27,160
<font color="#E5E5E5">downloaded it this</font><font color="#CCCCCC"> quarantine attribute</font>

369
00:15:24,279 --> 00:15:28,959
is of course<font color="#CCCCCC"> useful for flagging things</font>

370
00:15:27,160 --> 00:15:31,029
that<font color="#CCCCCC"> you're going to execute</font><font color="#E5E5E5"> that are</font>

371
00:15:28,959 --> 00:15:33,640
downloaded from the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> which is</font>

372
00:15:31,029 --> 00:15:37,560
why if<font color="#CCCCCC"> your malware you might want to</font>

373
00:15:33,640 --> 00:15:39,760
remove it<font color="#E5E5E5"> this is ocean Lotus a</font>

374
00:15:37,560 --> 00:15:42,790
nation-state malware I don't remember

375
00:15:39,760 --> 00:15:45,670
which nation state but<font color="#CCCCCC"> that</font><font color="#E5E5E5"> command that</font>

376
00:15:42,790 --> 00:15:50,020
I've highlighted there<font color="#E5E5E5"> that X adder - D</font>

377
00:15:45,670 --> 00:15:54,310
<font color="#CCCCCC">- R is saying delete</font><font color="#E5E5E5"> the comdata</font><font color="#CCCCCC"> Lauren</font>

378
00:15:50,020 --> 00:15:57,579
teen from this really weird<font color="#E5E5E5"> file</font>

379
00:15:54,310 --> 00:16:00,489
right<font color="#E5E5E5"> that starts with a dot it's in my</font>

380
00:15:57,580 --> 00:16:01,750
home directory<font color="#CCCCCC"> and</font><font color="#E5E5E5"> but really weird</font>

381
00:16:00,490 --> 00:16:03,550
executable right so what<font color="#E5E5E5"> are they doing</font>

382
00:16:01,750 --> 00:16:05,470
<font color="#E5E5E5">they're deleting the quarantine</font>

383
00:16:03,550 --> 00:16:08,740
attribute<font color="#E5E5E5"> so it's not flagged by</font>

384
00:16:05,470 --> 00:16:11,100
forensics<font color="#CCCCCC"> and so the operating system</font>

385
00:16:08,740 --> 00:16:14,890
doesn't flag it when you open it

386
00:16:11,100 --> 00:16:16,480
this command is relatively rare<font color="#CCCCCC"> there</font>

387
00:16:14,890 --> 00:16:19,089
are some installers<font color="#CCCCCC"> that do it</font>

388
00:16:16,480 --> 00:16:22,000
<font color="#E5E5E5">Chrome updates do it again your</font><font color="#CCCCCC"> mileage</font>

389
00:16:19,089 --> 00:16:23,380
may<font color="#CCCCCC"> vary in your environment</font><font color="#E5E5E5"> but the</font>

390
00:16:22,000 --> 00:16:25,180
best part<font color="#CCCCCC"> of this one is it's really</font>

391
00:16:23,380 --> 00:16:26,980
<font color="#CCCCCC">simple to search for there are</font><font color="#E5E5E5"> no</font>

392
00:16:25,180 --> 00:16:29,020
parent-child relationships there's no

393
00:16:26,980 --> 00:16:32,800
frequency counting here it's just<font color="#CCCCCC"> a</font>

394
00:16:29,020 --> 00:16:34,720
regex<font color="#E5E5E5"> on the command of course you</font><font color="#CCCCCC"> might</font>

395
00:16:32,800 --> 00:16:37,390
have to account for some difference in

396
00:16:34,720 --> 00:16:42,490
the order<font color="#CCCCCC"> of those commands but</font><font color="#E5E5E5"> that's</font>

397
00:16:37,390 --> 00:16:46,720
<font color="#E5E5E5">pretty simple what does getting a</font>

398
00:16:42,490 --> 00:16:49,060
foothold look like uh so I noticed<font color="#E5E5E5"> with</font>

399
00:16:46,720 --> 00:16:52,210
the Mac malware in particular<font color="#E5E5E5"> it seems</font>

400
00:16:49,060 --> 00:16:54,699
<font color="#E5E5E5">to be very busy right when it first got</font>

401
00:16:52,210 --> 00:16:56,710
<font color="#E5E5E5">on</font><font color="#CCCCCC"> the system</font><font color="#E5E5E5"> and so I thought well</font>

402
00:16:54,700 --> 00:16:59,470
let's<font color="#E5E5E5"> look at process trees</font><font color="#CCCCCC"> how many</font>

403
00:16:56,710 --> 00:17:02,110
process trees<font color="#E5E5E5"> have a large number of</font>

404
00:16:59,470 --> 00:17:05,800
processes<font color="#CCCCCC"> in them</font><font color="#E5E5E5"> and it turns out not</font>

405
00:17:02,110 --> 00:17:07,900
<font color="#E5E5E5">many I set my threshold at</font><font color="#CCCCCC"> 50</font><font color="#E5E5E5"> the</font>

406
00:17:05,800 --> 00:17:10,959
redacted<font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> you see at the bottom</font>

407
00:17:07,900 --> 00:17:12,550
there<font color="#E5E5E5"> is because when you start doing</font>

408
00:17:10,959 --> 00:17:15,130
this<font color="#CCCCCC"> research you will</font><font color="#E5E5E5"> figure out that</font>

409
00:17:12,550 --> 00:17:17,800
<font color="#CCCCCC">your internal inventory</font><font color="#E5E5E5"> control system</font>

410
00:17:15,130 --> 00:17:21,069
<font color="#CCCCCC">slash</font><font color="#E5E5E5"> software deployment system looks a</font>

411
00:17:17,800 --> 00:17:25,060
lot like a<font color="#E5E5E5"> c2 because</font><font color="#CCCCCC"> it is it's just</font>

412
00:17:21,069 --> 00:17:28,089
<font color="#E5E5E5">yours so you will probably</font><font color="#CCCCCC"> need to us</font>

413
00:17:25,060 --> 00:17:31,980
<font color="#E5E5E5">filter some of that out but this was</font>

414
00:17:28,089 --> 00:17:34,570
<font color="#E5E5E5">fairly reliable at finding things like</font>

415
00:17:31,980 --> 00:17:36,700
<font color="#E5E5E5">ransomware right because what does</font>

416
00:17:34,570 --> 00:17:38,230
ransomware do it finds a bunch<font color="#E5E5E5"> of files</font>

417
00:17:36,700 --> 00:17:40,510
<font color="#E5E5E5">and then it kicks off a process</font><font color="#CCCCCC"> to</font>

418
00:17:38,230 --> 00:17:42,970
encrypt every single<font color="#E5E5E5"> one of them and</font>

419
00:17:40,510 --> 00:17:45,400
you'll notice<font color="#E5E5E5"> this</font><font color="#CCCCCC"> one was really cute</font>

420
00:17:42,970 --> 00:17:47,650
<font color="#E5E5E5">it's using zip internally which means</font>

421
00:17:45,400 --> 00:17:53,440
the encryption key is<font color="#CCCCCC"> actually like</font>

422
00:17:47,650 --> 00:17:55,810
right there doc a is nation-state stuff

423
00:17:53,440 --> 00:17:58,480
but it's showing<font color="#E5E5E5"> up here because doc a</font>

424
00:17:55,810 --> 00:17:59,950
<font color="#CCCCCC">phones home via tor if you do not</font>

425
00:17:58,480 --> 00:18:02,290
already<font color="#E5E5E5"> have tor installed on your</font>

426
00:17:59,950 --> 00:18:04,450
system<font color="#E5E5E5"> doc</font><font color="#CCCCCC"> a helpfully installs it</font><font color="#E5E5E5"> for</font>

427
00:18:02,290 --> 00:18:05,790
you using homebrew<font color="#CCCCCC"> which of course kicks</font>

428
00:18:04,450 --> 00:18:06,990
off a bunch<font color="#E5E5E5"> of processes</font>

429
00:18:05,790 --> 00:18:09,060
because it has to download a bunch<font color="#CCCCCC"> of</font>

430
00:18:06,990 --> 00:18:13,560
packages<font color="#CCCCCC"> and it creates a</font><font color="#E5E5E5"> very busy</font>

431
00:18:09,060 --> 00:18:15,210
process tree um I should clarify what

432
00:18:13,560 --> 00:18:20,850
you're seeing<font color="#E5E5E5"> here on the command line</font>

433
00:18:15,210 --> 00:18:22,710
<font color="#E5E5E5">is the parent process sort of it's like</font>

434
00:18:20,850 --> 00:18:24,840
the overall process that kicked off all

435
00:18:22,710 --> 00:18:26,100
the child<font color="#E5E5E5"> processes so it's</font><font color="#CCCCCC"> not a whole</font>

436
00:18:24,840 --> 00:18:27,870
list of<font color="#E5E5E5"> everything</font>

437
00:18:26,100 --> 00:18:31,770
um and especially<font color="#E5E5E5"> with that ransomware</font>

438
00:18:27,870 --> 00:18:35,250
<font color="#E5E5E5">you see that the find command somewhere</font>

439
00:18:31,770 --> 00:18:38,970
in there um she lists all the<font color="#E5E5E5"> list all</font>

440
00:18:35,250 --> 00:18:41,130
<font color="#E5E5E5">the files that it's going to a crypt all</font>

441
00:18:38,970 --> 00:18:42,900
right where do malware processes live

442
00:18:41,130 --> 00:18:44,370
this<font color="#E5E5E5"> is one of</font><font color="#CCCCCC"> the things I was really</font>

443
00:18:42,900 --> 00:18:46,680
interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> because if you can write a</font>

444
00:18:44,370 --> 00:18:49,469
query that<font color="#E5E5E5"> says something executing from</font>

445
00:18:46,680 --> 00:18:53,280
<font color="#E5E5E5">this directory is bad it's a really good</font>

446
00:18:49,470 --> 00:18:55,230
place<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find malware so the first is</font>

447
00:18:53,280 --> 00:18:57,510
process is running from tempters<font color="#E5E5E5"> which</font>

448
00:18:55,230 --> 00:18:59,880
is<font color="#E5E5E5"> very similar</font><font color="#CCCCCC"> to the windows side of</font>

449
00:18:57,510 --> 00:19:01,770
the world<font color="#CCCCCC"> and this one was actually</font>

450
00:18:59,880 --> 00:19:05,310
<font color="#E5E5E5">really</font><font color="#CCCCCC"> cool because I</font><font color="#E5E5E5"> was testing</font><font color="#CCCCCC"> my</font>

451
00:19:01,770 --> 00:19:07,560
queries<font color="#E5E5E5"> and this is not my victim</font>

452
00:19:05,310 --> 00:19:10,020
machine<font color="#E5E5E5"> this is another machine</font><font color="#CCCCCC"> that I</font>

453
00:19:07,560 --> 00:19:17,970
found<font color="#E5E5E5"> during the course of my</font><font color="#CCCCCC"> research</font>

454
00:19:10,020 --> 00:19:21,240
<font color="#E5E5E5">and it was fun floor and so you can see</font>

455
00:19:17,970 --> 00:19:23,370
that underscore update<font color="#E5E5E5"> does he open</font>

456
00:19:21,240 --> 00:19:26,430
<font color="#E5E5E5">commands and then it installs this</font>

457
00:19:23,370 --> 00:19:29,370
really weird<font color="#E5E5E5"> like randomly named binary</font>

458
00:19:26,430 --> 00:19:31,770
<font color="#E5E5E5">and temp and runs it so this is</font>

459
00:19:29,370 --> 00:19:33,780
<font color="#E5E5E5">something I actually found by</font><font color="#CCCCCC"> accident</font>

460
00:19:31,770 --> 00:19:38,940
while<font color="#E5E5E5"> I was testing</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> queries which is</font>

461
00:19:33,780 --> 00:19:41,690
<font color="#CCCCCC">always a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> result another</font><font color="#E5E5E5"> place that</font>

462
00:19:38,940 --> 00:19:45,270
<font color="#CCCCCC">I found malware likes to put itself is</font>

463
00:19:41,690 --> 00:19:47,460
library<font color="#E5E5E5"> scripts there's actually not a</font>

464
00:19:45,270 --> 00:19:49,470
<font color="#E5E5E5">lot of legitimate stuff that runs out of</font>

465
00:19:47,460 --> 00:19:52,220
library<font color="#E5E5E5"> scripts so this is another good</font>

466
00:19:49,470 --> 00:19:52,220
<font color="#CCCCCC">place to start</font>

467
00:19:53,330 --> 00:19:57,389
yeah<font color="#CCCCCC"> I think if I remember correctly</font>

468
00:19:55,950 --> 00:20:02,310
<font color="#E5E5E5">there was some filtering you had to do</font>

469
00:19:57,390 --> 00:20:04,860
with this one but this is you can see in

470
00:20:02,310 --> 00:20:08,040
<font color="#CCCCCC">that window</font><font color="#E5E5E5"> down bottom that snake and</font>

471
00:20:04,860 --> 00:20:13,879
it's a fake Adobe Flash Player<font color="#CCCCCC"> and it's</font>

472
00:20:08,040 --> 00:20:13,879
<font color="#CCCCCC">setup that install DP</font><font color="#E5E5E5"> in library scripts</font>

473
00:20:14,870 --> 00:20:20,189
another thing I<font color="#CCCCCC"> noticed that</font><font color="#E5E5E5"> Mac malware</font>

474
00:20:17,490 --> 00:20:24,480
tends<font color="#E5E5E5"> to do is it sets up a staging area</font>

475
00:20:20,190 --> 00:20:27,299
<font color="#CCCCCC">in temp</font><font color="#E5E5E5"> and then it copies things over</font>

476
00:20:24,480 --> 00:20:29,519
to the<font color="#CCCCCC"> user's home directory so if you</font>

477
00:20:27,299 --> 00:20:30,720
look for<font color="#E5E5E5"> copies that go from temp to the</font>

478
00:20:29,519 --> 00:20:34,200
<font color="#E5E5E5">user's home directory</font>

479
00:20:30,720 --> 00:20:36,149
you can find some<font color="#E5E5E5"> of this there's a</font>

480
00:20:34,200 --> 00:20:39,269
<font color="#E5E5E5">little bit</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> noise there but not a lot</font>

481
00:20:36,149 --> 00:20:42,899
<font color="#E5E5E5">and it's actually a</font><font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> good method</font>

482
00:20:39,269 --> 00:20:44,399
<font color="#E5E5E5">so what you see</font><font color="#CCCCCC"> here is the malware</font>

483
00:20:42,899 --> 00:20:47,100
created<font color="#E5E5E5"> this underscore underscore</font>

484
00:20:44,399 --> 00:20:48,959
system directory which looks super

485
00:20:47,100 --> 00:20:53,009
legitimate right and then copies it<font color="#CCCCCC"> to</font>

486
00:20:48,960 --> 00:20:54,720
launch agents<font color="#E5E5E5"> so this is remember</font>

487
00:20:53,009 --> 00:20:56,940
earlier I talked about launch agents and

488
00:20:54,720 --> 00:20:59,220
how they can be installed<font color="#E5E5E5"> on behalf of</font>

489
00:20:56,940 --> 00:21:01,289
the system or<font color="#E5E5E5"> a per user</font><font color="#CCCCCC"> it's installing</font>

490
00:20:59,220 --> 00:21:04,139
<font color="#E5E5E5">it in</font><font color="#CCCCCC"> the users directory in</font><font color="#E5E5E5"> this case</font>

491
00:21:01,289 --> 00:21:05,850
because<font color="#CCCCCC"> that doesn't</font><font color="#E5E5E5"> require</font><font color="#CCCCCC"> Rudd and</font>

492
00:21:04,139 --> 00:21:07,860
<font color="#E5E5E5">it's a launch agent called system which</font>

493
00:21:05,850 --> 00:21:14,039
is now going<font color="#E5E5E5"> to run every single</font><font color="#CCCCCC"> time</font>

494
00:21:07,860 --> 00:21:16,229
the user logs<font color="#E5E5E5"> in</font><font color="#CCCCCC"> ah</font><font color="#E5E5E5"> another thing I</font>

495
00:21:14,039 --> 00:21:19,769
<font color="#CCCCCC">noticed that malware likes to do is</font>

496
00:21:16,230 --> 00:21:22,080
change own commands and I'm not sure

497
00:21:19,769 --> 00:21:24,210
exactly why<font color="#CCCCCC"> this comes up so much</font><font color="#E5E5E5"> but it</font>

498
00:21:22,080 --> 00:21:26,428
did and if it happens<font color="#E5E5E5"> on user</font>

499
00:21:24,210 --> 00:21:31,110
directories that<font color="#E5E5E5"> start</font><font color="#CCCCCC"> with dots</font><font color="#E5E5E5"> it's</font>

500
00:21:26,429 --> 00:21:33,149
particularly suspicious<font color="#CCCCCC"> this one does</font>

501
00:21:31,110 --> 00:21:36,139
have<font color="#E5E5E5"> some noise</font><font color="#CCCCCC"> associated with it</font>

502
00:21:33,149 --> 00:21:38,549
because<font color="#E5E5E5"> there are some like it has a</font>

503
00:21:36,139 --> 00:21:41,369
preferences directory there are a few<font color="#E5E5E5"> of</font>

504
00:21:38,549 --> 00:21:43,470
those things<font color="#E5E5E5"> but it's still relatively</font>

505
00:21:41,369 --> 00:21:46,740
good that's what you see there's that

506
00:21:43,470 --> 00:21:49,200
<font color="#E5E5E5">filtering there and when you see</font><font color="#CCCCCC"> things</font>

507
00:21:46,740 --> 00:21:51,119
pop up<font color="#E5E5E5"> that are really malicious they</font>

508
00:21:49,200 --> 00:21:55,820
pop out right away<font color="#CCCCCC"> right because that is</font>

509
00:21:51,119 --> 00:21:55,820
<font color="#CCCCCC">not user generated activity right there</font>

510
00:21:58,369 --> 00:22:08,549
so this is me filtering<font color="#CCCCCC"> Oh changin</font><font color="#E5E5E5"> um</font>

511
00:22:04,429 --> 00:22:11,940
<font color="#E5E5E5">change mod commands are along a similar</font>

512
00:22:08,549 --> 00:22:13,830
line though this one<font color="#E5E5E5"> requires more</font>

513
00:22:11,940 --> 00:22:16,889
<font color="#E5E5E5">filtering for some reason and again</font>

514
00:22:13,830 --> 00:22:21,539
<font color="#E5E5E5">you'll notice you're gonna want to</font>

515
00:22:16,889 --> 00:22:22,860
filter out<font color="#E5E5E5"> the</font><font color="#CCCCCC"> user's home directory at</font>

516
00:22:21,539 --> 00:22:25,420
the beginning of<font color="#E5E5E5"> it when you're doing</font>

517
00:22:22,860 --> 00:22:27,709
<font color="#E5E5E5">your results</font>

518
00:22:25,420 --> 00:22:29,930
one thing I didn't look<font color="#CCCCCC"> for but I</font>

519
00:22:27,710 --> 00:22:31,970
thought would be<font color="#CCCCCC"> interesting to look at</font>

520
00:22:29,930 --> 00:22:34,820
<font color="#E5E5E5">next time is to look at how</font><font color="#CCCCCC"> many</font>

521
00:22:31,970 --> 00:22:38,480
legitimate processes actually<font color="#CCCCCC"> do 777</font>

522
00:22:34,820 --> 00:22:41,260
perms<font color="#CCCCCC"> I have a feeling it's not many</font><font color="#E5E5E5"> but</font>

523
00:22:38,480 --> 00:22:47,410
<font color="#E5E5E5">it would be a question worth looking at</font>

524
00:22:41,260 --> 00:22:50,840
all right so what does<font color="#E5E5E5"> c2 look like um</font>

525
00:22:47,410 --> 00:22:52,490
obviously<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> have a network IDs or</font>

526
00:22:50,840 --> 00:22:55,939
something like<font color="#CCCCCC"> that or if you're</font>

527
00:22:52,490 --> 00:22:58,520
counting<font color="#CCCCCC"> bandwidth</font><font color="#E5E5E5"> you might be able</font><font color="#CCCCCC"> to</font>

528
00:22:55,940 --> 00:23:00,470
<font color="#E5E5E5">find really busy c2 that's really noisy</font>

529
00:22:58,520 --> 00:23:06,190
<font color="#E5E5E5">that's not what this command is designed</font>

530
00:23:00,470 --> 00:23:09,410
to find<font color="#E5E5E5"> I apologize it's a lot of text</font>

531
00:23:06,190 --> 00:23:12,710
<font color="#CCCCCC">but all you need to</font><font color="#E5E5E5"> really know here is</font>

532
00:23:09,410 --> 00:23:14,690
<font color="#CCCCCC">it's counting the length of the time the</font>

533
00:23:12,710 --> 00:23:17,390
process is running<font color="#E5E5E5"> versus how many</font>

534
00:23:14,690 --> 00:23:19,820
network connections<font color="#E5E5E5"> it's made so the</font>

535
00:23:17,390 --> 00:23:22,340
hypothesis here is<font color="#E5E5E5"> if is if a process is</font>

536
00:23:19,820 --> 00:23:24,350
<font color="#CCCCCC">running for</font><font color="#E5E5E5"> a long time</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> probably</font>

537
00:23:22,340 --> 00:23:27,230
<font color="#E5E5E5">should</font><font color="#CCCCCC"> be making network connections</font><font color="#E5E5E5"> on</font>

538
00:23:24,350 --> 00:23:28,639
a regular basis otherwise<font color="#E5E5E5"> it's kind of</font>

539
00:23:27,230 --> 00:23:30,590
<font color="#CCCCCC">lurking in the background</font>

540
00:23:28,640 --> 00:23:35,000
the reason this query<font color="#E5E5E5"> looks complicated</font>

541
00:23:30,590 --> 00:23:37,730
<font color="#E5E5E5">is because on this specific platform the</font>

542
00:23:35,000 --> 00:23:40,400
process creation<font color="#E5E5E5"> entry and the process</font>

543
00:23:37,730 --> 00:23:41,990
ended entry are two different records so

544
00:23:40,400 --> 00:23:46,280
you have to join them<font color="#E5E5E5"> to figure</font><font color="#CCCCCC"> out the</font>

545
00:23:41,990 --> 00:23:48,530
process<font color="#E5E5E5"> time</font><font color="#CCCCCC"> which is another</font><font color="#E5E5E5"> good note</font>

546
00:23:46,280 --> 00:23:50,300
to<font color="#E5E5E5"> make if for some reason</font><font color="#CCCCCC"> that end of</font>

547
00:23:48,530 --> 00:23:52,040
process record doesn't<font color="#E5E5E5"> exist</font>

548
00:23:50,300 --> 00:23:55,190
this query might give you false

549
00:23:52,040 --> 00:23:57,320
positives<font color="#E5E5E5"> um if you shut down a</font><font color="#CCCCCC"> Miss</font>

550
00:23:55,190 --> 00:24:02,390
<font color="#E5E5E5">machine unexpectedly it might not get</font>

551
00:23:57,320 --> 00:24:04,990
generated<font color="#E5E5E5"> for instance but this is the</font>

552
00:24:02,390 --> 00:24:07,850
<font color="#E5E5E5">result from that query which is</font><font color="#CCCCCC"> carido</font>

553
00:24:04,990 --> 00:24:10,550
so here we have a process that's<font color="#E5E5E5"> been</font>

554
00:24:07,850 --> 00:24:12,199
<font color="#E5E5E5">running for a very long time</font><font color="#CCCCCC"> and has</font>

555
00:24:10,550 --> 00:24:14,899
only made one network connection and

556
00:24:12,200 --> 00:24:17,600
hasn't<font color="#E5E5E5"> done anything else of note so</font>

557
00:24:14,900 --> 00:24:21,740
there's one<font color="#E5E5E5"> way you can find command and</font>

558
00:24:17,600 --> 00:24:25,370
control this<font color="#E5E5E5"> one's a little bit more</font>

559
00:24:21,740 --> 00:24:28,460
complex<font color="#CCCCCC"> uh that bit I've highlighted</font>

560
00:24:25,370 --> 00:24:31,909
there is just a way for<font color="#CCCCCC"> you to</font><font color="#E5E5E5"> filter</font>

561
00:24:28,460 --> 00:24:33,860
out your internal systems<font color="#E5E5E5"> whatever that</font>

562
00:24:31,910 --> 00:24:35,180
means to you because<font color="#E5E5E5"> as I said a lot</font><font color="#CCCCCC"> of</font>

563
00:24:33,860 --> 00:24:37,520
your internal<font color="#E5E5E5"> systems are going to look</font>

564
00:24:35,180 --> 00:24:38,590
<font color="#E5E5E5">like command and control and trigger</font>

565
00:24:37,520 --> 00:24:46,750
false positives on

566
00:24:38,590 --> 00:24:50,049
<font color="#E5E5E5">worries what operating systems features</font>

567
00:24:46,750 --> 00:24:51,970
does malware use<font color="#E5E5E5"> so a lot</font><font color="#CCCCCC"> of just to</font>

568
00:24:50,049 --> 00:24:54,299
take a step back here<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> the stuff</font>

569
00:24:51,970 --> 00:24:56,890
we're looking<font color="#CCCCCC"> at with Mac malware is not</font>

570
00:24:54,299 --> 00:24:58,330
in a broad sense<font color="#E5E5E5"> different than what you</font>

571
00:24:56,890 --> 00:25:00,340
see<font color="#E5E5E5"> on the windows side of the world</font>

572
00:24:58,330 --> 00:25:01,990
<font color="#CCCCCC">it's just going</font><font color="#E5E5E5"> to be implemented</font>

573
00:25:00,340 --> 00:25:03,820
<font color="#E5E5E5">differently but those implementations</font>

574
00:25:01,990 --> 00:25:06,580
are different when it comes<font color="#E5E5E5"> to making</font>

575
00:25:03,820 --> 00:25:09,158
detection so the operating systems

576
00:25:06,580 --> 00:25:11,230
features<font color="#E5E5E5"> that malware uses</font><font color="#CCCCCC"> are going to</font>

577
00:25:09,159 --> 00:25:14,470
be different because<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> way it</font>

578
00:25:11,230 --> 00:25:16,330
installs persistence<font color="#E5E5E5"> so we talked about</font>

579
00:25:14,470 --> 00:25:18,340
launch agents a little bit<font color="#E5E5E5"> after you've</font>

580
00:25:16,330 --> 00:25:20,770
<font color="#E5E5E5">installed the launch agent launch</font>

581
00:25:18,340 --> 00:25:23,770
control<font color="#CCCCCC"> is what launches it and one</font>

582
00:25:20,770 --> 00:25:26,230
thing I<font color="#E5E5E5"> noticed specifically with</font>

583
00:25:23,770 --> 00:25:29,610
malware is that if<font color="#E5E5E5"> something contains</font>

584
00:25:26,230 --> 00:25:32,200
both a shell process<font color="#CCCCCC"> and launch control</font>

585
00:25:29,610 --> 00:25:35,770
<font color="#CCCCCC">it's a little</font><font color="#E5E5E5"> suspicious because what</font>

586
00:25:32,200 --> 00:25:38,110
that<font color="#E5E5E5"> essentially means</font><font color="#CCCCCC"> is a shell</font><font color="#E5E5E5"> ran</font>

587
00:25:35,770 --> 00:25:41,049
launch control<font color="#E5E5E5"> which doesn't happen very</font>

588
00:25:38,110 --> 00:25:43,178
often<font color="#CCCCCC"> it's not something users tend to</font>

589
00:25:41,049 --> 00:25:45,220
do and it's not<font color="#E5E5E5"> how things happen on</font>

590
00:25:43,179 --> 00:25:48,820
boot as a launch agent<font color="#E5E5E5"> that comes up</font>

591
00:25:45,220 --> 00:25:51,520
<font color="#CCCCCC">every time the user</font><font color="#E5E5E5"> logs</font><font color="#CCCCCC"> it which one</font>

592
00:25:48,820 --> 00:25:53,320
was this trying to remember<font color="#E5E5E5"> which piece</font>

593
00:25:51,520 --> 00:25:53,770
<font color="#CCCCCC">of malware this was</font><font color="#E5E5E5"> oh it's right in</font>

594
00:25:53,320 --> 00:25:57,340
there

595
00:25:53,770 --> 00:26:02,200
I'll call me<font color="#CCCCCC"> I think this is a contact</font>

596
00:25:57,340 --> 00:26:05,350
information stealer<font color="#CCCCCC"> I remember right the</font>

597
00:26:02,200 --> 00:26:07,929
other<font color="#E5E5E5"> thing that malware tends to do</font>

598
00:26:05,350 --> 00:26:10,500
when it has a<font color="#CCCCCC"> shell</font><font color="#E5E5E5"> is run lots of those</font>

599
00:26:07,929 --> 00:26:13,539
shells to do lots of<font color="#CCCCCC"> things so</font><font color="#E5E5E5"> you can</font>

600
00:26:10,500 --> 00:26:15,520
<font color="#E5E5E5">count a count the number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> shells</font>

601
00:26:13,539 --> 00:26:18,820
within a process tree and that can give

602
00:26:15,520 --> 00:26:21,399
you some<font color="#CCCCCC"> useful results this particular</font>

603
00:26:18,820 --> 00:26:24,549
query<font color="#CCCCCC"> at least on the platform</font><font color="#E5E5E5"> I was</font>

604
00:26:21,399 --> 00:26:27,279
using<font color="#E5E5E5"> tends to fall over if you try and</font>

605
00:26:24,549 --> 00:26:30,820
run it for more<font color="#CCCCCC"> than a small set of</font>

606
00:26:27,279 --> 00:26:33,039
hosts<font color="#E5E5E5"> um but you could probably play</font>

607
00:26:30,820 --> 00:26:35,620
with<font color="#E5E5E5"> it and improve that a bit I've set</font>

608
00:26:33,039 --> 00:26:37,960
<font color="#E5E5E5">my threshold at 20 but again your</font>

609
00:26:35,620 --> 00:26:39,699
mileage<font color="#CCCCCC"> may vary in your environment um</font>

610
00:26:37,960 --> 00:26:44,020
<font color="#E5E5E5">you just need to test and figure out</font>

611
00:26:39,700 --> 00:26:47,740
what looks like<font color="#E5E5E5"> normal so here we have</font>

612
00:26:44,020 --> 00:26:49,210
<font color="#E5E5E5">another way to find ransomware</font><font color="#CCCCCC"> and you</font>

613
00:26:47,740 --> 00:26:52,820
can see the<font color="#E5E5E5"> message it pops up on</font><font color="#CCCCCC"> the</font>

614
00:26:49,210 --> 00:26:55,039
<font color="#CCCCCC">screen</font><font color="#E5E5E5"> and then we have been</font><font color="#CCCCCC"> tier</font>

615
00:26:52,820 --> 00:26:58,039
is something that<font color="#CCCCCC"> runs a lot</font><font color="#E5E5E5"> of shells</font>

616
00:26:55,039 --> 00:27:00,379
to set up its persistence<font color="#E5E5E5"> what you can</font>

617
00:26:58,039 --> 00:27:03,500
see there is that that local directory

618
00:27:00,380 --> 00:27:05,750
inside the<font color="#E5E5E5"> users home directory hides a</font>

619
00:27:03,500 --> 00:27:09,259
bunch of its art<font color="#CCCCCC"> artifact</font><font color="#E5E5E5"> and it also</font>

620
00:27:05,750 --> 00:27:13,789
installs a large agent<font color="#E5E5E5"> which is one of</font>

621
00:27:09,259 --> 00:27:15,649
<font color="#CCCCCC">those shell</font><font color="#E5E5E5"> commands oh yeah</font><font color="#CCCCCC"> and then it</font>

622
00:27:13,789 --> 00:27:22,100
deletes itself<font color="#CCCCCC"> that's that very last</font>

623
00:27:15,649 --> 00:27:23,059
shell command for event here all<font color="#E5E5E5"> right</font>

624
00:27:22,100 --> 00:27:26,809
cool

625
00:27:23,059 --> 00:27:29,960
<font color="#CCCCCC">think we're making good</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> um what</font>

626
00:27:26,809 --> 00:27:32,090
does recon look like<font color="#CCCCCC"> uh just to take a</font>

627
00:27:29,960 --> 00:27:34,970
step back if you have not studied

628
00:27:32,090 --> 00:27:36,590
malware before<font color="#E5E5E5"> a lot of malware comes in</font>

629
00:27:34,970 --> 00:27:38,090
to do recon<font color="#E5E5E5"> they want to know where the</font>

630
00:27:36,590 --> 00:27:38,750
machine is they want to<font color="#E5E5E5"> know who it</font>

631
00:27:38,090 --> 00:27:40,519
belongs to

632
00:27:38,750 --> 00:27:44,570
<font color="#E5E5E5">they want to know what the time zone in</font>

633
00:27:40,519 --> 00:27:48,230
is and all<font color="#E5E5E5"> of that is to figure</font><font color="#CCCCCC"> out how</font>

634
00:27:44,570 --> 00:27:51,529
valuable the<font color="#E5E5E5"> machine is uh I think I</font>

635
00:27:48,230 --> 00:27:55,759
<font color="#E5E5E5">have time for a quick detour so um there</font>

636
00:27:51,529 --> 00:27:58,009
<font color="#E5E5E5">are lots of places</font><font color="#CCCCCC"> on I'll call</font><font color="#E5E5E5"> it the</font>

637
00:27:55,759 --> 00:28:00,500
dark web<font color="#E5E5E5"> for lack of a</font><font color="#CCCCCC"> better term where</font>

638
00:27:58,009 --> 00:28:02,120
you can buy time<font color="#CCCCCC"> on computers so these</font>

639
00:28:00,500 --> 00:28:04,490
are computers that<font color="#E5E5E5"> somebody else has</font>

640
00:28:02,120 --> 00:28:08,018
compromised that you can pay<font color="#E5E5E5"> to take</font>

641
00:28:04,490 --> 00:28:10,250
<font color="#CCCCCC">over and there are actually cases where</font>

642
00:28:08,019 --> 00:28:12,440
<font color="#E5E5E5">criminals have gotten into a group of</font>

643
00:28:10,250 --> 00:28:13,909
machines<font color="#CCCCCC"> at a specific</font><font color="#E5E5E5"> company and it'll</font>

644
00:28:12,440 --> 00:28:17,360
be<font color="#E5E5E5"> like</font><font color="#CCCCCC"> a deal at the supermarket like</font>

645
00:28:13,909 --> 00:28:19,730
<font color="#CCCCCC">we have a bonus</font><font color="#E5E5E5"> today here are</font><font color="#CCCCCC"> ten</font>

646
00:28:17,360 --> 00:28:21,469
computers<font color="#CCCCCC"> at Acme corporation</font><font color="#E5E5E5"> and you</font>

647
00:28:19,730 --> 00:28:24,379
can gain<font color="#CCCCCC"> a foothold on their network and</font>

648
00:28:21,470 --> 00:28:26,750
<font color="#CCCCCC">own their company</font><font color="#E5E5E5"> right so that's why</font>

649
00:28:24,379 --> 00:28:31,879
malware does<font color="#E5E5E5"> recon of course it</font><font color="#CCCCCC"> looks a</font>

650
00:28:26,750 --> 00:28:35,149
little<font color="#E5E5E5"> differently on the Mac um these</font>

651
00:28:31,879 --> 00:28:38,449
commands here<font color="#E5E5E5"> uh just</font><font color="#CCCCCC"> look at the first</font>

652
00:28:35,149 --> 00:28:40,070
<font color="#E5E5E5">line</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> that query network</font><font color="#CCCCCC"> setup tells</font>

653
00:28:38,450 --> 00:28:44,289
you about the network configuration of

654
00:28:40,070 --> 00:28:47,299
course<font color="#E5E5E5"> who and</font><font color="#CCCCCC"> who</font><font color="#E5E5E5"> am I will tell you</font><font color="#CCCCCC"> uh</font>

655
00:28:44,289 --> 00:28:51,200
the name of the user the program is

656
00:28:47,299 --> 00:28:52,668
running<font color="#E5E5E5"> ass and sis control will dump a</font>

657
00:28:51,200 --> 00:28:53,600
bunch of<font color="#E5E5E5"> hardware information about the</font>

658
00:28:52,669 --> 00:28:57,379
<font color="#E5E5E5">machine</font>

659
00:28:53,600 --> 00:28:59,209
including some OS information<font color="#CCCCCC"> and so</font>

660
00:28:57,379 --> 00:29:01,820
that's super<font color="#E5E5E5"> useful information for</font>

661
00:28:59,210 --> 00:29:03,110
attackers<font color="#CCCCCC"> of course your inventory</font>

662
00:29:01,820 --> 00:29:04,490
system is<font color="#E5E5E5"> going to be looking at these</font>

663
00:29:03,110 --> 00:29:06,139
<font color="#E5E5E5">things</font><font color="#CCCCCC"> too which is why you have to</font>

664
00:29:04,490 --> 00:29:08,570
<font color="#E5E5E5">filter it out</font>

665
00:29:06,140 --> 00:29:11,480
<font color="#E5E5E5">but if you start by looking for</font>

666
00:29:08,570 --> 00:29:14,090
<font color="#CCCCCC">processed trees</font><font color="#E5E5E5"> that run more</font><font color="#CCCCCC"> than say</font>

667
00:29:11,480 --> 00:29:16,130
<font color="#CCCCCC">one or two</font><font color="#E5E5E5"> of these commands it's a</font>

668
00:29:14,090 --> 00:29:18,500
fairly reliable<font color="#E5E5E5"> reliable way to find</font>

669
00:29:16,130 --> 00:29:20,750
malware you as a<font color="#CCCCCC"> user on the system</font>

670
00:29:18,500 --> 00:29:22,880
<font color="#E5E5E5">might type who am i every once in a</font>

671
00:29:20,750 --> 00:29:24,740
<font color="#CCCCCC">while</font><font color="#E5E5E5"> but you're probably not</font><font color="#CCCCCC"> going to</font>

672
00:29:22,880 --> 00:29:26,480
type<font color="#E5E5E5"> who am i and then list all the</font>

673
00:29:24,740 --> 00:29:27,950
hardware on<font color="#CCCCCC"> your</font><font color="#E5E5E5"> machine and</font><font color="#CCCCCC"> then list</font>

674
00:29:26,480 --> 00:29:32,120
all<font color="#E5E5E5"> the network interfaces to find out</font>

675
00:29:27,950 --> 00:29:33,290
what your<font color="#E5E5E5"> IP addresses so here's our</font>

676
00:29:32,120 --> 00:29:38,679
results

677
00:29:33,290 --> 00:29:41,570
this is<font color="#CCCCCC"> vac a and duct a is</font><font color="#E5E5E5"> looking for</font>

678
00:29:38,680 --> 00:29:43,790
the proxy<font color="#CCCCCC"> on the machine so it can</font>

679
00:29:41,570 --> 00:29:46,820
configure the proxy to get<font color="#E5E5E5"> out and</font><font color="#CCCCCC"> that</font>

680
00:29:43,790 --> 00:29:48,649
<font color="#E5E5E5">top hit is max by which is basically</font>

681
00:29:46,820 --> 00:29:50,780
<font color="#E5E5E5">doing a bunch of hardware reconnaissance</font>

682
00:29:48,650 --> 00:29:52,960
to figure out what kind of machine<font color="#E5E5E5"> it's</font>

683
00:29:50,780 --> 00:29:52,960
on

684
00:29:54,220 --> 00:30:01,670
how does malware try to avoid detection

685
00:29:56,810 --> 00:30:04,550
<font color="#CCCCCC">on a Mac this</font><font color="#E5E5E5"> is where we need to take</font>

686
00:30:01,670 --> 00:30:06,950
another<font color="#E5E5E5"> little detour um so there's a</font>

687
00:30:04,550 --> 00:30:09,770
something<font color="#CCCCCC"> on the Mac called security</font><font color="#E5E5E5"> off</font>

688
00:30:06,950 --> 00:30:12,170
trampolines<font color="#CCCCCC"> and this is</font><font color="#E5E5E5"> basically when</font>

689
00:30:09,770 --> 00:30:14,600
you<font color="#CCCCCC"> come in as an</font><font color="#E5E5E5"> installer and you want</font>

690
00:30:12,170 --> 00:30:16,760
to run with<font color="#CCCCCC"> root privileges but you</font>

691
00:30:14,600 --> 00:30:19,399
don't have them this<font color="#E5E5E5"> is how you get them</font>

692
00:30:16,760 --> 00:30:21,470
in most cases<font color="#CCCCCC"> at props it pops up this</font>

693
00:30:19,400 --> 00:30:25,640
little<font color="#E5E5E5"> dialog box that you have to enter</font>

694
00:30:21,470 --> 00:30:27,320
<font color="#CCCCCC">your password in and this is</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> to be</font>

695
00:30:25,640 --> 00:30:28,760
<font color="#E5E5E5">clear here security off trampoline at</font>

696
00:30:27,320 --> 00:30:30,860
the legitimate tool that's used<font color="#CCCCCC"> by</font>

697
00:30:28,760 --> 00:30:33,470
legitimate installers and<font color="#CCCCCC"> illegitimate</font>

698
00:30:30,860 --> 00:30:36,290
installers but I thought it<font color="#E5E5E5"> might be</font>

699
00:30:33,470 --> 00:30:39,350
<font color="#CCCCCC">interesting to look for rare processes</font>

700
00:30:36,290 --> 00:30:42,920
that use it but<font color="#CCCCCC"> before we get</font><font color="#E5E5E5"> there I'm</font>

701
00:30:39,350 --> 00:30:44,480
going<font color="#E5E5E5"> to take</font><font color="#CCCCCC"> another little detour so I</font>

702
00:30:42,920 --> 00:30:47,240
talked about<font color="#CCCCCC"> malware</font><font color="#E5E5E5"> and how you have to</font>

703
00:30:44,480 --> 00:30:50,900
be careful with it this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what doc a</font>

704
00:30:47,240 --> 00:30:53,720
shows you when it works so when you're

705
00:30:50,900 --> 00:30:55,940
playing<font color="#E5E5E5"> with malware don't trust</font>

706
00:30:53,720 --> 00:30:57,890
anything the malware<font color="#E5E5E5"> it tells you make</font>

707
00:30:55,940 --> 00:30:59,420
sure you're<font color="#E5E5E5"> looking your artifacts make</font>

708
00:30:57,890 --> 00:31:01,220
sure you're checking what your system

709
00:30:59,420 --> 00:31:03,590
<font color="#E5E5E5">what your monitoring systems are telling</font>

710
00:31:01,220 --> 00:31:06,410
you um<font color="#E5E5E5"> to be sure you know what's</font><font color="#CCCCCC"> going</font>

711
00:31:03,590 --> 00:31:09,770
<font color="#E5E5E5">on also I thought this was</font><font color="#CCCCCC"> really cute I</font>

712
00:31:06,410 --> 00:31:12,460
should share it<font color="#CCCCCC"> because this is the only</font>

713
00:31:09,770 --> 00:31:16,160
malware sample that<font color="#E5E5E5"> I've seen do this</font>

714
00:31:12,460 --> 00:31:20,630
<font color="#E5E5E5">all</font><font color="#CCCCCC"> right so my hypothesis</font>

715
00:31:16,160 --> 00:31:22,670
if you have a rare process um if you

716
00:31:20,630 --> 00:31:25,220
have a<font color="#CCCCCC"> process that's</font><font color="#E5E5E5"> used security</font><font color="#CCCCCC"> off</font>

717
00:31:22,670 --> 00:31:26,840
trampoline<font color="#E5E5E5"> and there's only say one</font>

718
00:31:25,220 --> 00:31:29,150
process<font color="#CCCCCC"> in your environment that's de</font>

719
00:31:26,840 --> 00:31:29,840
let's use it<font color="#E5E5E5"> then maybe that's something</font>

720
00:31:29,150 --> 00:31:32,150
<font color="#E5E5E5">to</font><font color="#CCCCCC"> look at</font>

721
00:31:29,840 --> 00:31:34,929
so I specifically looked<font color="#CCCCCC"> for the</font><font color="#E5E5E5"> da</font><font color="#CCCCCC"> k</font>

722
00:31:32,150 --> 00:31:39,440
processes to see how<font color="#CCCCCC"> many</font><font color="#E5E5E5"> times they</font>

723
00:31:34,930 --> 00:31:42,020
appeared because<font color="#E5E5E5"> some of these are</font>

724
00:31:39,440 --> 00:31:44,690
<font color="#CCCCCC">actually system utilities that</font><font color="#E5E5E5"> Daka is</font>

725
00:31:42,020 --> 00:31:46,190
using um that are<font color="#E5E5E5"> also</font><font color="#CCCCCC"> using security</font>

726
00:31:44,690 --> 00:31:49,220
<font color="#CCCCCC">trampolines so they're not</font><font color="#E5E5E5"> actually</font>

727
00:31:46,190 --> 00:31:51,080
<font color="#E5E5E5">those aren't all malicious hashes but</font>

728
00:31:49,220 --> 00:31:56,120
anyway<font color="#E5E5E5"> it looked good from</font><font color="#CCCCCC"> this point of</font>

729
00:31:51,080 --> 00:31:59,720
view but when I ran the<font color="#CCCCCC"> numbers what I</font>

730
00:31:56,120 --> 00:32:02,419
found was lots of hashes<font color="#E5E5E5"> are unique over</font>

731
00:31:59,720 --> 00:32:04,430
shorter periods<font color="#CCCCCC"> of</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> so you have as</font>

732
00:32:02,420 --> 00:32:06,200
this<font color="#E5E5E5"> conflict like the more you</font><font color="#CCCCCC"> reduce</font>

733
00:32:04,430 --> 00:32:08,840
<font color="#E5E5E5">your window the easier it is to count</font>

734
00:32:06,200 --> 00:32:10,970
<font color="#CCCCCC">but</font><font color="#E5E5E5"> the more things that look rare that</font>

735
00:32:08,840 --> 00:32:13,220
<font color="#E5E5E5">aren't actually rare the more you</font>

736
00:32:10,970 --> 00:32:15,650
increase your window<font color="#E5E5E5"> the better data you</font>

737
00:32:13,220 --> 00:32:19,370
get and the more<font color="#CCCCCC"> your sim tends to fall</font>

738
00:32:15,650 --> 00:32:25,670
over on<font color="#E5E5E5"> you so how can we deal with this</font>

739
00:32:19,370 --> 00:32:27,229
problem<font color="#E5E5E5"> um what well I'll get to</font><font color="#CCCCCC"> the</font>

740
00:32:25,670 --> 00:32:30,140
deal with part in a moment this<font color="#CCCCCC"> is just</font>

741
00:32:27,230 --> 00:32:35,090
<font color="#E5E5E5">some more data to hammer home the point</font>

742
00:32:30,140 --> 00:32:37,160
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the if a</font><font color="#E5E5E5"> hash was involved in an</font><font color="#CCCCCC"> OP</font>

743
00:32:35,090 --> 00:32:39,530
trampoline event<font color="#E5E5E5"> it was</font><font color="#CCCCCC"> owned it</font><font color="#E5E5E5"> was</font>

744
00:32:37,160 --> 00:32:43,330
probably<font color="#E5E5E5"> only recorded once by one agent</font>

745
00:32:39,530 --> 00:32:45,530
so<font color="#CCCCCC"> B rarity</font><font color="#E5E5E5"> just based on off trampoline</font>

746
00:32:43,330 --> 00:32:47,210
<font color="#E5E5E5">wasn't good enough what you have to</font>

747
00:32:45,530 --> 00:32:49,700
filter<font color="#E5E5E5"> on is the rarity in off</font>

748
00:32:47,210 --> 00:32:52,730
trampoline and the rarity<font color="#E5E5E5"> in the general</font>

749
00:32:49,700 --> 00:32:58,220
population<font color="#E5E5E5"> which led to this unholy</font>

750
00:32:52,730 --> 00:33:00,740
query<font color="#CCCCCC"> huh which again</font><font color="#E5E5E5"> try not</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

751
00:32:58,220 --> 00:33:02,420
<font color="#E5E5E5">lost in it basically all we're doing is</font>

752
00:33:00,740 --> 00:33:03,200
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the processes that use das</font>

753
00:33:02,420 --> 00:33:05,390
trampoline

754
00:33:03,200 --> 00:33:09,200
count the number<font color="#CCCCCC"> of time it's used and</font>

755
00:33:05,390 --> 00:33:10,400
then add to<font color="#E5E5E5"> that information how common</font>

756
00:33:09,200 --> 00:33:15,890
is<font color="#CCCCCC"> this</font><font color="#E5E5E5"> process in the general</font>

757
00:33:10,400 --> 00:33:16,510
<font color="#E5E5E5">population</font><font color="#CCCCCC"> and then once we have that</font>

758
00:33:15,890 --> 00:33:19,510
<font color="#E5E5E5">data</font>

759
00:33:16,510 --> 00:33:21,580
we can filter on<font color="#CCCCCC"> it</font><font color="#E5E5E5"> so that part folded</font>

760
00:33:19,510 --> 00:33:24,430
at the<font color="#E5E5E5"> bottom we're searching for things</font>

761
00:33:21,580 --> 00:33:26,560
that are uncommon<font color="#CCCCCC"> and we're searching</font>

762
00:33:24,430 --> 00:33:27,700
for<font color="#E5E5E5"> yeah</font>

763
00:33:26,560 --> 00:33:30,850
we're<font color="#E5E5E5"> searching for things that are</font>

764
00:33:27,700 --> 00:33:36,400
<font color="#E5E5E5">uncommon and we're filtering out things</font>

765
00:33:30,850 --> 00:33:40,600
we know that trigger false positives<font color="#E5E5E5"> so</font>

766
00:33:36,400 --> 00:33:42,850
it turns out<font color="#E5E5E5"> this sort of works right so</font>

767
00:33:40,600 --> 00:33:45,219
I've highlighted the things that should

768
00:33:42,850 --> 00:33:49,330
<font color="#CCCCCC">be</font><font color="#E5E5E5"> rare those are those doc a hits in</font>

769
00:33:45,220 --> 00:33:53,710
the red box but<font color="#CCCCCC"> adobe isn't rare</font><font color="#E5E5E5"> why is</font>

770
00:33:49,330 --> 00:34:03,399
<font color="#CCCCCC">that showing</font><font color="#E5E5E5"> up if you are if you</font>

771
00:33:53,710 --> 00:34:06,010
noticed<font color="#E5E5E5"> when I click past so if we delve</font>

772
00:34:03,400 --> 00:34:08,530
<font color="#E5E5E5">into this a little bit more what we find</font>

773
00:34:06,010 --> 00:34:10,540
is that some<font color="#CCCCCC"> of these are rare for this</font>

774
00:34:08,530 --> 00:34:14,350
<font color="#E5E5E5">query but not actually rare in the</font>

775
00:34:10,540 --> 00:34:20,110
general<font color="#CCCCCC"> population and</font><font color="#E5E5E5"> the reason</font><font color="#CCCCCC"> for</font>

776
00:34:14,350 --> 00:34:22,600
this<font color="#E5E5E5"> is I have used a terrible hack</font><font color="#CCCCCC"> I</font>

777
00:34:20,110 --> 00:34:24,370
had to do this<font color="#E5E5E5"> because of the platform</font><font color="#CCCCCC"> I</font>

778
00:34:22,600 --> 00:34:28,029
was on because<font color="#CCCCCC"> I didn't have summary</font>

779
00:34:24,370 --> 00:34:30,790
indexing available to me<font color="#E5E5E5"> but in this</font>

780
00:34:28,030 --> 00:34:32,230
<font color="#CCCCCC">bunker</font><font color="#E5E5E5"> in this</font><font color="#CCCCCC"> Splunk instance what</font><font color="#E5E5E5"> I</font>

781
00:34:30,790 --> 00:34:35,199
could do is<font color="#E5E5E5"> I could find the rarest</font>

782
00:34:32,230 --> 00:34:38,020
<font color="#E5E5E5">10,000 hashes</font><font color="#CCCCCC"> and the most common</font><font color="#E5E5E5"> 10,000</font>

783
00:34:35,199 --> 00:34:39,909
hashes but<font color="#E5E5E5"> that left this big chunk in</font>

784
00:34:38,020 --> 00:34:43,780
the<font color="#CCCCCC"> middle that wasn't categorized</font><font color="#E5E5E5"> at</font>

785
00:34:39,909 --> 00:34:47,739
all so a lot of stuff<font color="#E5E5E5"> comes up that's</font>

786
00:34:43,780 --> 00:34:50,260
not<font color="#E5E5E5"> actually rare I couldn't solve this</font>

787
00:34:47,739 --> 00:34:51,459
problem on<font color="#CCCCCC"> the infrastructure</font><font color="#E5E5E5"> I had but</font>

788
00:34:50,260 --> 00:34:54,160
I think you could do<font color="#CCCCCC"> this really well</font>

789
00:34:51,460 --> 00:34:56,260
<font color="#E5E5E5">with summary indexing or if you have</font>

790
00:34:54,159 --> 00:34:58,600
some sort<font color="#E5E5E5"> of known good list</font><font color="#CCCCCC"> that would</font>

791
00:34:56,260 --> 00:35:00,720
also be<font color="#E5E5E5"> an awesome way to throw out</font>

792
00:34:58,600 --> 00:35:05,080
stuff<font color="#CCCCCC"> that you know</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> false positives</font>

793
00:35:00,720 --> 00:35:07,540
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> thing malware does to</font>

794
00:35:05,080 --> 00:35:10,270
hide<font color="#E5E5E5"> itself is</font><font color="#CCCCCC"> self deleting processes I</font>

795
00:35:07,540 --> 00:35:17,050
know this happens on<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> too</font><font color="#CCCCCC"> at some</font>

796
00:35:10,270 --> 00:35:19,509
benign installers do this but so we're

797
00:35:17,050 --> 00:35:21,400
<font color="#CCCCCC">gonna filter</font><font color="#E5E5E5"> out on common hashes again</font>

798
00:35:19,510 --> 00:35:23,710
<font color="#E5E5E5">and I'm going to use that terrible hack</font>

799
00:35:21,400 --> 00:35:27,820
<font color="#E5E5E5">because it's all I have but it's</font>

800
00:35:23,710 --> 00:35:31,250
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> not a bad</font><font color="#E5E5E5"> query um one of</font><font color="#CCCCCC"> the</font>

801
00:35:27,820 --> 00:35:33,630
<font color="#E5E5E5">other things you can filter</font><font color="#CCCCCC"> on it</font>

802
00:35:31,250 --> 00:35:34,950
so this is not<font color="#CCCCCC"> a commercial but I'm just</font>

803
00:35:33,630 --> 00:35:37,260
<font color="#E5E5E5">gonna say it</font><font color="#CCCCCC"> because I'm sure some of</font>

804
00:35:34,950 --> 00:35:40,680
<font color="#E5E5E5">you</font><font color="#CCCCCC"> have recognized it now</font><font color="#E5E5E5"> CrowdStrike</font>

805
00:35:37,260 --> 00:35:43,490
<font color="#CCCCCC">in their data will actually label the</font>

806
00:35:40,680 --> 00:35:46,080
<font color="#CCCCCC">virus total detection counts for a hash</font>

807
00:35:43,490 --> 00:35:48,180
they will only<font color="#CCCCCC"> alert you if it hits a</font>

808
00:35:46,080 --> 00:35:50,520
certain<font color="#CCCCCC"> threshold</font><font color="#E5E5E5"> this makes sense</font>

809
00:35:48,180 --> 00:35:53,220
<font color="#CCCCCC">because some stuff you know if it hits</font>

810
00:35:50,520 --> 00:35:54,740
one probably isn't you probably don't

811
00:35:53,220 --> 00:35:57,810
want that to fire to glass all the<font color="#E5E5E5"> time</font>

812
00:35:54,740 --> 00:35:59,368
<font color="#E5E5E5">but particularly if you're doing hunting</font>

813
00:35:57,810 --> 00:36:03,270
maybe that's something<font color="#E5E5E5"> you want to look</font>

814
00:35:59,369 --> 00:36:06,780
<font color="#E5E5E5">at so you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> add a filter for the</font><font color="#CCCCCC"> virus</font>

815
00:36:03,270 --> 00:36:08,460
<font color="#E5E5E5">total</font><font color="#CCCCCC"> account</font><font color="#E5E5E5"> using this query or</font>

816
00:36:06,780 --> 00:36:11,130
whatever you have<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your environment</font>

817
00:36:08,460 --> 00:36:13,290
<font color="#CCCCCC">you could</font><font color="#E5E5E5"> you know query against</font>

818
00:36:11,130 --> 00:36:15,390
<font color="#CCCCCC">virustotal and then use that as an</font>

819
00:36:13,290 --> 00:36:18,890
optional filter<font color="#E5E5E5"> to help get rid</font><font color="#CCCCCC"> of some</font>

820
00:36:15,390 --> 00:36:21,359
<font color="#E5E5E5">false positives one of the other things</font>

821
00:36:18,890 --> 00:36:22,890
<font color="#CCCCCC">that malware</font><font color="#E5E5E5"> does to hide</font><font color="#CCCCCC"> itself and</font>

822
00:36:21,359 --> 00:36:26,190
this<font color="#E5E5E5"> is true in Windows as well</font><font color="#CCCCCC"> is</font>

823
00:36:22,890 --> 00:36:29,879
orphan orphaned processes this<font color="#E5E5E5"> is super</font>

824
00:36:26,190 --> 00:36:32,810
cool<font color="#CCCCCC"> um this is crowd strikes process</font>

825
00:36:29,880 --> 00:36:37,290
tree thing and you can tell that<font color="#CCCCCC"> these</font>

826
00:36:32,810 --> 00:36:39,180
look well when I looked<font color="#E5E5E5"> at them I could</font>

827
00:36:37,290 --> 00:36:40,859
tell<font color="#CCCCCC"> that they looked abnormal because</font>

828
00:36:39,180 --> 00:36:43,290
<font color="#CCCCCC">this is not the</font><font color="#E5E5E5"> first process on the</font>

829
00:36:40,859 --> 00:36:45,210
system<font color="#E5E5E5"> launch D is the first</font><font color="#CCCCCC"> process on</font>

830
00:36:43,290 --> 00:36:46,740
the system everything<font color="#CCCCCC"> that happens on</font>

831
00:36:45,210 --> 00:36:50,010
the<font color="#E5E5E5"> Mac should come down from there</font>

832
00:36:46,740 --> 00:36:51,959
these sort<font color="#E5E5E5"> of floating out in the middle</font>

833
00:36:50,010 --> 00:36:54,359
of nowhere<font color="#CCCCCC"> that's not how a legitimate</font>

834
00:36:51,960 --> 00:36:56,910
<font color="#E5E5E5">process should look unless you have data</font>

835
00:36:54,359 --> 00:37:01,830
missing<font color="#E5E5E5"> but this is not how legitimate</font>

836
00:36:56,910 --> 00:37:04,098
<font color="#CCCCCC">processes look so can we find that</font><font color="#E5E5E5"> using</font>

837
00:37:01,830 --> 00:37:08,098
our<font color="#E5E5E5"> data and it turns out you can</font>

838
00:37:04,099 --> 00:37:09,720
<font color="#CCCCCC">basically what you do is again</font><font color="#E5E5E5"> this</font>

839
00:37:08,099 --> 00:37:11,820
query<font color="#E5E5E5"> looks complicated but it's not</font>

840
00:37:09,720 --> 00:37:14,368
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> all that</font><font color="#E5E5E5"> complicated all we're</font>

841
00:37:11,820 --> 00:37:16,619
doing is<font color="#CCCCCC"> looking at</font><font color="#E5E5E5"> parent records and</font>

842
00:37:14,369 --> 00:37:18,900
joining<font color="#E5E5E5"> them to child records and if the</font>

843
00:37:16,619 --> 00:37:23,609
parent<font color="#CCCCCC"> doesn't exist call yourself an</font>

844
00:37:18,900 --> 00:37:26,160
orphan and here we go<font color="#CCCCCC"> this is double</font>

845
00:37:23,609 --> 00:37:27,990
<font color="#CCCCCC">Rober and you see that</font><font color="#E5E5E5"> on the bottom</font><font color="#CCCCCC"> I</font>

846
00:37:26,160 --> 00:37:33,299
am an orphan

847
00:37:27,990 --> 00:37:36,810
the tag I gave it in this query<font color="#CCCCCC"> here now</font>

848
00:37:33,300 --> 00:37:38,520
to be precise<font color="#CCCCCC"> what</font><font color="#E5E5E5"> this query does is it</font>

849
00:37:36,810 --> 00:37:41,759
looks for parent records in the same

850
00:37:38,520 --> 00:37:43,920
<font color="#E5E5E5">timeframe</font><font color="#CCCCCC"> as the</font><font color="#E5E5E5"> child record right if</font>

851
00:37:41,760 --> 00:37:46,050
you have a long-running process<font color="#CCCCCC"> like say</font>

852
00:37:43,920 --> 00:37:48,900
an inventory control system that has

853
00:37:46,050 --> 00:37:50,609
kicked something<font color="#E5E5E5"> off and it started 10</font>

854
00:37:48,900 --> 00:37:52,740
hours ago<font color="#E5E5E5"> and your query is only</font>

855
00:37:50,609 --> 00:37:54,960
covering<font color="#E5E5E5"> 10 minutes you're gonna get</font>

856
00:37:52,740 --> 00:37:57,598
false<font color="#CCCCCC"> positives here and that's why you</font>

857
00:37:54,960 --> 00:37:59,310
might<font color="#CCCCCC"> need to</font><font color="#E5E5E5"> filter some stuff out</font><font color="#CCCCCC"> but</font>

858
00:37:57,599 --> 00:38:00,660
this<font color="#CCCCCC"> is a pretty cool</font><font color="#E5E5E5"> thing to be</font><font color="#CCCCCC"> able</font>

859
00:37:59,310 --> 00:38:07,349
<font color="#CCCCCC">to</font><font color="#E5E5E5"> look for your through your process</font>

860
00:38:00,660 --> 00:38:10,319
<font color="#E5E5E5">data for all right um if you want to</font>

861
00:38:07,349 --> 00:38:12,480
find orphan processes for one host<font color="#E5E5E5"> yeah</font>

862
00:38:10,320 --> 00:38:14,160
I know this one's kind of<font color="#E5E5E5"> unholy</font><font color="#CCCCCC"> - and</font>

863
00:38:12,480 --> 00:38:17,460
I'm gonna skip over some<font color="#CCCCCC"> of the details</font>

864
00:38:14,160 --> 00:38:19,589
<font color="#CCCCCC">because I'm running low on time uh but</font>

865
00:38:17,460 --> 00:38:21,540
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> you can find</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> for one</font>

866
00:38:19,589 --> 00:38:24,420
host and these are some of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> things I</font>

867
00:38:21,540 --> 00:38:28,550
had<font color="#CCCCCC"> to filter out so like</font><font color="#E5E5E5"> application</font>

868
00:38:24,420 --> 00:38:32,070
<font color="#E5E5E5">support the redacted stuff is internal</font>

869
00:38:28,550 --> 00:38:36,420
yeah and I<font color="#CCCCCC"> promise these will be</font>

870
00:38:32,070 --> 00:38:39,330
released<font color="#E5E5E5"> so you do not need to take all</font>

871
00:38:36,420 --> 00:38:41,160
this down in your<font color="#E5E5E5"> notes</font><font color="#CCCCCC"> so this was</font>

872
00:38:39,330 --> 00:38:45,680
actually<font color="#E5E5E5"> pretty good right here</font><font color="#CCCCCC"> our</font>

873
00:38:41,160 --> 00:38:49,319
orphan<font color="#E5E5E5"> um yeah here our orphan processes</font>

874
00:38:45,680 --> 00:38:53,040
that we found there were some false

875
00:38:49,320 --> 00:38:54,330
<font color="#E5E5E5">positives but it's not bad you know with</font>

876
00:38:53,040 --> 00:38:58,890
some research you<font color="#E5E5E5"> could make this a lot</font>

877
00:38:54,330 --> 00:39:01,259
<font color="#E5E5E5">better if we add duration</font><font color="#CCCCCC"> and that's the</font>

878
00:38:58,890 --> 00:39:04,160
duration of the<font color="#CCCCCC"> process</font><font color="#E5E5E5"> and look at</font>

879
00:39:01,260 --> 00:39:07,859
<font color="#CCCCCC">virustotal account</font><font color="#E5E5E5"> it gets a lot better</font>

880
00:39:04,160 --> 00:39:09,990
<font color="#E5E5E5">so this is the this is the query running</font>

881
00:39:07,859 --> 00:39:12,900
and on one host<font color="#E5E5E5"> looking for orphan</font>

882
00:39:09,990 --> 00:39:17,819
processes<font color="#E5E5E5"> and here's what we came up</font>

883
00:39:12,900 --> 00:39:21,560
<font color="#CCCCCC">with all right</font><font color="#E5E5E5"> so that's the end of my</font>

884
00:39:17,820 --> 00:39:23,609
queries<font color="#E5E5E5"> I hope I didn't overwhelm</font>

885
00:39:21,560 --> 00:39:27,150
<font color="#E5E5E5">everyone too much I will be releasing</font>

886
00:39:23,609 --> 00:39:29,880
all that<font color="#E5E5E5"> text</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> um so now let's talk</font>

887
00:39:27,150 --> 00:39:31,820
about<font color="#E5E5E5"> just some experiment wrap up this</font>

888
00:39:29,880 --> 00:39:34,619
is what was good about<font color="#E5E5E5"> this experiment</font>

889
00:39:31,820 --> 00:39:36,180
<font color="#E5E5E5">the network setup was isolated which</font>

890
00:39:34,619 --> 00:39:38,760
means I didn't have to<font color="#E5E5E5"> have a big lab it</font>

891
00:39:36,180 --> 00:39:41,799
<font color="#E5E5E5">talked out on this cell phone connection</font>

892
00:39:38,760 --> 00:39:44,140
the way<font color="#E5E5E5"> this particular process</font>

893
00:39:41,800 --> 00:39:46,090
<font color="#E5E5E5">monitoring solution works</font><font color="#CCCCCC"> the fact that</font>

894
00:39:44,140 --> 00:39:47,620
<font color="#E5E5E5">I was sending data out to the central</font>

895
00:39:46,090 --> 00:39:50,080
<font color="#E5E5E5">monitoring server did not name a</font>

896
00:39:47,620 --> 00:39:52,049
<font color="#CCCCCC">specific company or person because lots</font>

897
00:39:50,080 --> 00:39:54,790
of companies use that monitoring<font color="#E5E5E5"> server</font>

898
00:39:52,050 --> 00:39:56,740
<font color="#E5E5E5">there were no</font><font color="#CCCCCC"> VMS</font><font color="#E5E5E5"> to detect because</font>

899
00:39:54,790 --> 00:39:59,830
there was no virtualized virtualization

900
00:39:56,740 --> 00:40:01,600
involved and the process monitoring

901
00:39:59,830 --> 00:40:06,040
<font color="#E5E5E5">solution made things easy</font>

902
00:40:01,600 --> 00:40:08,200
mostly what was<font color="#E5E5E5"> not great about this</font>

903
00:40:06,040 --> 00:40:10,300
experiment<font color="#CCCCCC"> um</font>

904
00:40:08,200 --> 00:40:12,220
malware<font color="#CCCCCC"> has been known to change its</font>

905
00:40:10,300 --> 00:40:12,730
behavior but based on sensing

906
00:40:12,220 --> 00:40:15,100
CrowdStrike

907
00:40:12,730 --> 00:40:17,080
so any of the malware<font color="#E5E5E5"> samples</font><font color="#CCCCCC"> Iran was</font>

908
00:40:15,100 --> 00:40:20,980
looking for that<font color="#E5E5E5"> they would have changed</font>

909
00:40:17,080 --> 00:40:22,960
their behavior using<font color="#CCCCCC"> hardware</font><font color="#E5E5E5"> does make</font>

910
00:40:20,980 --> 00:40:26,080
experiments<font color="#E5E5E5"> longer because your reset</font>

911
00:40:22,960 --> 00:40:27,580
time takes longer because of that<font color="#E5E5E5"> I had</font>

912
00:40:26,080 --> 00:40:30,790
<font color="#E5E5E5">to run multiple samples per experiment</font>

913
00:40:27,580 --> 00:40:32,590
<font color="#E5E5E5">which</font><font color="#CCCCCC"> wasn't</font><font color="#E5E5E5"> great but</font><font color="#CCCCCC"> you could mostly</font>

914
00:40:30,790 --> 00:40:35,500
sort things out<font color="#CCCCCC"> because of the process</font>

915
00:40:32,590 --> 00:40:37,630
trees<font color="#E5E5E5"> some of these samples failed to</font>

916
00:40:35,500 --> 00:40:39,850
run now keep in mind<font color="#E5E5E5"> I had one piece</font><font color="#CCCCCC"> of</font>

917
00:40:37,630 --> 00:40:42,550
hardware<font color="#E5E5E5"> running one version of the</font><font color="#CCCCCC"> OS</font>

918
00:40:39,850 --> 00:40:45,400
with one configuration<font color="#CCCCCC"> right some</font><font color="#E5E5E5"> of</font>

919
00:40:42,550 --> 00:40:46,780
this code only infects Firefox<font color="#E5E5E5"> some of</font>

920
00:40:45,400 --> 00:40:48,430
it was meant to<font color="#E5E5E5"> run on a different</font>

921
00:40:46,780 --> 00:40:52,600
<font color="#CCCCCC">architecture or a different version</font><font color="#E5E5E5"> of</font>

922
00:40:48,430 --> 00:40:54,819
the OS<font color="#E5E5E5"> none of those are going to run so</font>

923
00:40:52,600 --> 00:40:58,750
here are some<font color="#CCCCCC"> improvements</font><font color="#E5E5E5"> that I</font>

924
00:40:54,820 --> 00:41:00,730
thought would<font color="#CCCCCC"> be fun</font><font color="#E5E5E5"> to investigate</font><font color="#CCCCCC"> you</font>

925
00:40:58,750 --> 00:41:02,800
could configure a slug cluster

926
00:41:00,730 --> 00:41:05,260
especially for<font color="#E5E5E5"> this so you don't</font><font color="#CCCCCC"> run</font>

927
00:41:02,800 --> 00:41:07,570
<font color="#E5E5E5">into so many memory constraints using</font>

928
00:41:05,260 --> 00:41:10,810
look lookup tables instead of joins

929
00:41:07,570 --> 00:41:12,250
would be more efficient<font color="#E5E5E5"> if you have some</font>

930
00:41:10,810 --> 00:41:14,140
<font color="#E5E5E5">filtering steps that you can't build</font>

931
00:41:12,250 --> 00:41:17,320
<font color="#E5E5E5">into the queries there is an API for</font>

932
00:41:14,140 --> 00:41:19,180
spunk<font color="#E5E5E5"> or elk or whatever sim</font><font color="#CCCCCC"> I'm sure</font>

933
00:41:17,320 --> 00:41:22,480
you're using so<font color="#E5E5E5"> you could automate</font><font color="#CCCCCC"> those</font>

934
00:41:19,180 --> 00:41:25,060
steps you<font color="#E5E5E5"> can use</font><font color="#CCCCCC"> math I talked a little</font>

935
00:41:22,480 --> 00:41:26,410
bit<font color="#E5E5E5"> about</font><font color="#CCCCCC"> summary</font><font color="#E5E5E5"> searches and this last</font>

936
00:41:25,060 --> 00:41:28,170
<font color="#E5E5E5">one I haven't looked at</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> all but I</font>

937
00:41:26,410 --> 00:41:30,640
think<font color="#E5E5E5"> would</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> really fun to</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> at</font>

938
00:41:28,170 --> 00:41:33,370
<font color="#CCCCCC">it's the equivalent of permissions on</font>

939
00:41:30,640 --> 00:41:35,529
<font color="#CCCCCC">your phone but</font><font color="#E5E5E5"> they exist in the</font>

940
00:41:33,370 --> 00:41:37,509
operating<font color="#CCCCCC"> system as well on the</font>

941
00:41:35,530 --> 00:41:39,280
<font color="#E5E5E5">Macintosh laptops there's an</font>

942
00:41:37,510 --> 00:41:41,440
<font color="#E5E5E5">entitlements database</font><font color="#CCCCCC"> it's basically the</font>

943
00:41:39,280 --> 00:41:43,600
<font color="#E5E5E5">apps saying these are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> things I ought</font>

944
00:41:41,440 --> 00:41:45,160
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do and if you were to do a</font>

945
00:41:43,600 --> 00:41:47,259
<font color="#E5E5E5">survey of all</font><font color="#CCCCCC"> the apps in your</font>

946
00:41:45,160 --> 00:41:48,819
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> and what they say they ought</font>

947
00:41:47,260 --> 00:41:52,840
to<font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do it</font>

948
00:41:48,820 --> 00:41:55,090
might yield some interesting results<font color="#CCCCCC"> all</font>

949
00:41:52,840 --> 00:41:57,550
<font color="#E5E5E5">right so this is the full index of all</font>

950
00:41:55,090 --> 00:41:59,620
<font color="#E5E5E5">the queries and I don't have much time</font>

951
00:41:57,550 --> 00:42:04,420
<font color="#CCCCCC">left but</font><font color="#E5E5E5"> I just want to wrap</font><font color="#CCCCCC"> up by</font>

952
00:41:59,620 --> 00:42:06,339
saying<font color="#E5E5E5"> I really want somebody</font><font color="#CCCCCC"> in this</font>

953
00:42:04,420 --> 00:42:08,590
audience<font color="#E5E5E5"> or somebody watching this</font>

954
00:42:06,340 --> 00:42:11,230
<font color="#CCCCCC">recording</font><font color="#E5E5E5"> eventually to do more research</font>

955
00:42:08,590 --> 00:42:14,140
<font color="#E5E5E5">and to make me look bad and then to tell</font>

956
00:42:11,230 --> 00:42:16,000
me about it<font color="#E5E5E5"> because I would love to see</font>

957
00:42:14,140 --> 00:42:18,160
<font color="#E5E5E5">more done</font><font color="#CCCCCC"> on this</font><font color="#E5E5E5"> topic and if you're</font>

958
00:42:16,000 --> 00:42:23,350
doing<font color="#E5E5E5"> interesting things</font><font color="#CCCCCC"> please</font><font color="#E5E5E5"> let me</font>

959
00:42:18,160 --> 00:42:25,390
<font color="#E5E5E5">know um yeah</font><font color="#CCCCCC"> also I was not here to talk</font>

960
00:42:23,350 --> 00:42:33,040
to<font color="#CCCCCC"> myself for 45 minutes</font><font color="#E5E5E5"> so that anyone</font>

961
00:42:25,390 --> 00:42:37,000
has questions<font color="#CCCCCC"> I will take them now all</font>

962
00:42:33,040 --> 00:42:39,940
right cool um you can<font color="#E5E5E5"> also find me later</font>

963
00:42:37,000 --> 00:42:43,200
<font color="#CCCCCC">it</font><font color="#E5E5E5"> asking questions in large public</font>

964
00:42:39,940 --> 00:42:43,200
forums is intimidating

965
00:42:44,580 --> 00:42:47,719
[Applause]

