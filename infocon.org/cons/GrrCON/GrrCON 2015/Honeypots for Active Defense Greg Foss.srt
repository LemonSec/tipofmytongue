1
00:00:00,000 --> 00:00:24,810
all right go ahead and get started here
but some folks come in so if you were

2
00:00:24,810 --> 00:00:30,250
here for the critical infrastructures
weakest link talk unfortunately they

3
00:00:30,250 --> 00:00:35,050
didn't show up so you have to deal with
me for about an hour let the mass exodus

4
00:00:35,050 --> 00:00:41,989
began so instead we are talking about is
actually honey pot so completely

5
00:00:41,989 --> 00:00:47,649
different topic then why you're probably
expecting so I apologize but let's get

6
00:00:47,649 --> 00:00:56,100
started and messed up my democratic
right so little bit about me

7
00:00:56,100 --> 00:01:02,309
my name's Greg poss ya head of security
operations for larger them also part of

8
00:01:02,309 --> 00:01:07,770
the lab security research team and so
one of the main things I work on there

9
00:01:07,770 --> 00:01:11,909
is actually honey pots and acted defense
and essentially run our internal

10
00:01:11,909 --> 00:01:14,820
security and so a lot of what I'm gonna
talk about some of the things that

11
00:01:14,820 --> 00:01:18,130
people you know any great with our
customers and their deployments with our

12
00:01:18,130 --> 00:01:22,000
products and stuff like that and also
what we do on our internet where to both

13
00:01:22,000 --> 00:01:29,470
defend and attack back against attackers
so to start let's go over some

14
00:01:29,470 --> 00:01:35,990
traditional defensive concepts rape
organizations you can actually do a lot

15
00:01:35,990 --> 00:01:38,270
of things try and protect your
organizations are some of the things

16
00:01:38,270 --> 00:01:43,149
people do you are you know obviously
maintain a tough perimeter and then

17
00:01:43,149 --> 00:01:47,500
implement layered security controls you
want to try and make it hard for the

18
00:01:47,500 --> 00:01:52,320
attackers to get in and out here
environment firewalls IDS IPS rap you

19
00:01:52,320 --> 00:01:56,890
know spam filters all those good things
and then brought all the stuff we know

20
00:01:56,890 --> 00:01:57,520
about

21
00:01:57,520 --> 00:02:01,770
the bad I P is all the malicious actors
all the known attack vectors all the

22
00:02:01,770 --> 00:02:05,759
known exploits stuff like that we can
actually defend their signatures were

23
00:02:05,759 --> 00:02:10,450
those things and I'm gonna create and
enforce policy to discourage the misuse

24
00:02:10,450 --> 00:02:15,010
of our computer systems by our employees
the folks who actually work for us and

25
00:02:15,010 --> 00:02:19,940
then we just sit there and pretend that
this all actually works right now

26
00:02:19,940 --> 00:02:28,569
doesn't work no seeds so there's quite a
few realities when it comes to

27
00:02:28,569 --> 00:02:34,130
information security there's no real one
security products can actually protect

28
00:02:34,130 --> 00:02:38,380
your environment actually keep the
attackers out hundred-percent time I

29
00:02:38,380 --> 00:02:41,450
were true then either so that the
singing something great

30
00:02:41,450 --> 00:02:45,340
you have to actually have people and
processes and tools in place that are

31
00:02:45,340 --> 00:02:49,840
all commingle you have to have a very
well defined process for handling

32
00:02:49,840 --> 00:02:52,260
intrusions

33
00:02:52,260 --> 00:02:56,910
that's when you know there's always some
David like this is just clicking on

34
00:02:56,910 --> 00:02:57,720
stuff

35
00:02:57,720 --> 00:03:03,000
open the door to your network
essentially the only thing to this not

36
00:03:03,000 --> 00:03:07,959
just a PT's not just these advanced
adversaries the run script kiddie pools

37
00:03:07,959 --> 00:03:12,319
and break into us anywhere I'm actually
here employees people that were cream

38
00:03:12,319 --> 00:03:17,690
that can already be you know by that can
be coerced into divulging secrets about

39
00:03:17,690 --> 00:03:22,340
your company years or selling your own
software whatever your most precious

40
00:03:22,340 --> 00:03:25,630
assets are essentially where you can
have systems they're just already

41
00:03:25,630 --> 00:03:30,690
compromised on your network due to the
guy on the left side that's why I like

42
00:03:30,690 --> 00:03:36,450
he acted defense approach this is kind
of take it back to the attackers for for

43
00:03:36,450 --> 00:03:41,130
many years we just kind of SAT back and
let attackers coming to our network

44
00:03:41,130 --> 00:03:46,030
you know steal our stuff and all we do
is say oh we found them out where it is

45
00:03:46,030 --> 00:03:49,030
at the white only mess with them right
now is some of their same tactics

46
00:03:49,030 --> 00:03:50,250
against them

47
00:03:50,250 --> 00:03:55,330
that's what this whole talks about so
what is active defense

48
00:03:55,330 --> 00:04:02,490
tell you exactly what it is actually
already talking about here is just

49
00:04:02,490 --> 00:04:05,420
simply tipping the odds in our favor as
defenders

50
00:04:05,420 --> 00:04:08,880
essentially turned the tables on the
attacker and use some of their own

51
00:04:08,880 --> 00:04:13,950
tricks against that why not right and
it's fun to do so we do this by first

52
00:04:13,950 --> 00:04:17,019
and foremost annoying them we want to
bother that we gonna make it very

53
00:04:17,019 --> 00:04:20,780
difficult and giant pain in the ass for
them to break into our organization and

54
00:04:20,780 --> 00:04:21,850
get anywhere

55
00:04:21,850 --> 00:04:26,040
of significance we also want to trap
them and just waste their time if we can

56
00:04:26,040 --> 00:04:29,290
have them messing with systems that like
are real and don't we don't actually

57
00:04:29,290 --> 00:04:32,940
care about or you know stuff like that
then they're not attacking the real

58
00:04:32,940 --> 00:04:37,320
stuff not go in and stealing real data
says it's fine we get to you know put

59
00:04:37,320 --> 00:04:41,210
them in an environmentally control
essentially and then from there we can

60
00:04:41,210 --> 00:04:45,790
get a lot of intelligence on an attempt
to actually get attribution on then once

61
00:04:45,790 --> 00:04:50,500
we find out enough about these people
and then begin the real fun stuff

62
00:04:50,500 --> 00:04:53,890
tacking back and I'm not talking about
like launching shells on people or stuff

63
00:04:53,890 --> 00:04:57,840
like that when talking about attacking
back within reason and within your legal

64
00:04:57,840 --> 00:05:01,350
limitations and we'll talk about that in
a minute here essentially the main goal

65
00:05:01,350 --> 00:05:05,270
is simply reducing the meantime
detective mean time to respond to

66
00:05:05,270 --> 00:05:10,970
intruders in your network so I really
like this Tweet here we're just talking

67
00:05:10,970 --> 00:05:14,760
about the goal of security engineering
isn't essential to keep people out a lot

68
00:05:14,760 --> 00:05:18,650
of people can't get this misconstrued
what it is you want to make this very

69
00:05:18,650 --> 00:05:24,060
you are in a compromise very expensive
or make it very noisy and difficult are

70
00:05:24,060 --> 00:05:27,160
you wanna make them trigger a bunch of
alarms and they're trying to penetrate

71
00:05:27,160 --> 00:05:34,060
your network so I internal honey pots
this kind of talk senator out one of

72
00:05:34,060 --> 00:05:37,169
things I like about honey pots is
there's lots of different types of honey

73
00:05:37,169 --> 00:05:40,729
pots out there they're very easy to
deploy and easy to maintain they're not

74
00:05:40,729 --> 00:05:44,530
real systems and you can intermingle
them with your legitimate systems on

75
00:05:44,530 --> 00:05:49,169
your network so they look meshed in with
your real environment century but these

76
00:05:49,169 --> 00:05:53,849
are just fly traps for anomalous
activity which is great cuz they

77
00:05:53,849 --> 00:05:56,889
you want to know about when these
systems are probed are you wanna see

78
00:05:56,889 --> 00:06:01,249
when people are trying to access things
they they obviously shouldn't be a nice

79
00:06:01,249 --> 00:06:05,149
thing about internal honey pots as both
external honey pots on the internet is

80
00:06:05,149 --> 00:06:07,550
these things don't actually need to look
very legit

81
00:06:07,550 --> 00:06:11,409
use need that have them be legitimate
enough to raise a flag when they're

82
00:06:11,409 --> 00:06:15,969
breached the nice thing about this 20 to
learn a ton about the people they're

83
00:06:15,969 --> 00:06:20,229
attacking you and this is very important
because you want to see not only how

84
00:06:20,229 --> 00:06:23,830
they got in how they're getting out
other avenues they have been in your

85
00:06:23,830 --> 00:06:27,519
environment has never wanted just you
know take this one system iNOS

86
00:06:27,519 --> 00:06:30,229
compromise take it off the network and
call it good

87
00:06:30,229 --> 00:06:34,089
is guaranteed they have at least four
other way is back in your network so

88
00:06:34,089 --> 00:06:39,839
keep that in mind and one key thing
about this whole talk though is this is

89
00:06:39,839 --> 00:06:43,559
something to focus on after you have you
know standard security controls in place

90
00:06:43,559 --> 00:06:47,319
this you want to have the foundation
laid first before you can take the next

91
00:06:47,319 --> 00:06:54,110
step by morning honey pots so order some
use cases for many parts traditionally

92
00:06:54,110 --> 00:06:59,839
research in a lot of security companies
out there as included put honey pots out

93
00:06:59,839 --> 00:07:03,490
on the internet just to see what's going
on wanna gathered data we want to

94
00:07:03,490 --> 00:07:07,639
interact with the attackers and we want
to just see what's happening on the

95
00:07:07,639 --> 00:07:12,399
general internet and you know help that
god help our products and improve our

96
00:07:12,399 --> 00:07:17,319
product offerings and then defense this
kind of the meat of the whole topic is

97
00:07:17,319 --> 00:07:22,519
we want to actually use honey pots as an
actual defensive tool in our environment

98
00:07:22,519 --> 00:07:29,559
that's what we're going to focus on our
this is actually quite a few virtual

99
00:07:29,559 --> 00:07:33,479
machines they can go and download and
start playing with honey pots to better

100
00:07:33,479 --> 00:07:39,839
figure them out the first ones honey
drive 30 really cool project essentially

101
00:07:39,839 --> 00:07:44,610
what this does it has a compilation of
tons of different honeypot technologies

102
00:07:44,610 --> 00:07:50,240
already pre-installed reconfigure their
dashboard set up I'll let that stop the

103
00:07:50,240 --> 00:07:53,479
problem though is this is an enterprise
ready this isn't something you can just

104
00:07:53,479 --> 00:07:56,249
take and stand up in your enterprise and

105
00:07:56,249 --> 00:08:00,049
had actually be something that's a
friend like you know believable two

106
00:08:00,049 --> 00:08:03,619
attackers this is something that you
know it's more of a learning tool

107
00:08:03,619 --> 00:08:06,889
something you can play with and say like
oh these are great scripts should take

108
00:08:06,889 --> 00:08:11,269
these and put them on like a Linux box
on my network so there is another

109
00:08:11,269 --> 00:08:17,289
project that I really like that is more
enterprise ready that's ADHD so awesome

110
00:08:17,289 --> 00:08:22,299
name rate the active defense harbinger
distribution so essentially this does

111
00:08:22,299 --> 00:08:27,899
that has a bunch of pre-built our pre
configured honeypot sorry built-in also

112
00:08:27,899 --> 00:08:33,039
has a bunch of active defense to already
built it's a very cool project to do you

113
00:08:33,039 --> 00:08:36,729
want to do some tweaks to it before you
use this in a real sense of scenario but

114
00:08:36,729 --> 00:08:41,699
it's an awesome tool highly recommend
you check it out now this is probably

115
00:08:41,699 --> 00:08:45,589
one of the most important aspects were
gonna cover and the stock before you

116
00:08:45,589 --> 00:08:49,980
wanna do any of actually know the exact
a defensive techniques and you know

117
00:08:49,980 --> 00:08:52,769
actually start a mess with attackers and
stuff like that

118
00:08:52,769 --> 00:08:56,110
warning banners are something that is
often overlooked in organizations but

119
00:08:56,110 --> 00:09:00,610
very important from a legal standpoint
because you can't go and like you know

120
00:09:00,610 --> 00:09:05,709
start watching client-side code on
attacker system without actually being

121
00:09:05,709 --> 00:09:10,259
implicated legally yourself but if you
know when they're picking through your

122
00:09:10,259 --> 00:09:13,990
network and their login stuff and they
start agreeing to all of your terms and

123
00:09:13,990 --> 00:09:17,959
conditions that are laid out running
banners then it opens up the door for

124
00:09:17,959 --> 00:09:21,529
you can actually do a lot more once
they've agreed to your terms this is

125
00:09:21,529 --> 00:09:25,279
something that's very important to
implement if you are gonna do any active

126
00:09:25,279 --> 00:09:30,649
defense kind of techniques for some
types of honey pots where's my

127
00:09:30,649 --> 00:09:33,620
interpretation there's a lot of
different interpretations out there this

128
00:09:33,620 --> 00:09:38,970
is kinda how I broke down so first is no
interaction interaction is essentially

129
00:09:38,970 --> 00:09:43,079
honey pots that are honey quartz they
just wait for a TCP connection and they

130
00:09:43,079 --> 00:09:47,089
like it or drop the traffic or whatnot
so not a whole lot their little

131
00:09:47,089 --> 00:09:50,910
interaction is more like static web
pages and stuff like that you know look

132
00:09:50,910 --> 00:09:55,000
like something else than what they
really are and then medium interaction

133
00:09:55,000 --> 00:09:59,569
mean reaction is essentially honey pots
these are like the most common type of

134
00:09:59,569 --> 00:10:03,350
honey pot where they actually stimulate
like a real service a real system or

135
00:10:03,350 --> 00:10:04,190
something like that

136
00:10:04,190 --> 00:10:08,950
and then I interaction these are
essentially real systems or honey pots

137
00:10:08,950 --> 00:10:13,750
highly instrumented to simulate every
aspect of a real operating system and my

138
00:10:13,750 --> 00:10:20,310
favorite many tokens is Kirby Dr strains
can be four days these can be documents

139
00:10:20,310 --> 00:10:27,590
all sorts of stuff so first let's take a
look at no interaction honey pots so no

140
00:10:27,590 --> 00:10:34,110
interaction honey pots or any ports are
actually very easy to configure this one

141
00:10:34,110 --> 00:10:38,450
example here this is just a Linux honey
Porter and all it really is just neck at

142
00:10:38,450 --> 00:10:42,270
might be tables just couple lines abash
you can actually download the script

143
00:10:42,270 --> 00:10:46,780
from the part about the defense
countermeasures

144
00:10:46,780 --> 00:10:52,960
book by John strand impossible Orion
seven in the book is also in the ADHD CD

145
00:10:52,960 --> 00:10:57,720
so couple places you can get that but
essentially it's just a very simple

146
00:10:57,720 --> 00:11:02,130
script that all it does weight strip or
TCP connection logs the traffic and then

147
00:11:02,130 --> 00:11:07,180
bans them from that post just using
iptables -a simple you can also do the

148
00:11:07,180 --> 00:11:11,550
same thing on Windows just using netcat
as they age you know about the same

149
00:11:11,550 --> 00:11:16,160
complexity here as well so a lot of very
easy ways to do this as something easy

150
00:11:16,160 --> 00:11:20,770
to push out onto a bunch of systems it
if you wanna do any courts but they're

151
00:11:20,770 --> 00:11:24,340
also Python and PowerShell options as
well to get a lot more verbose have a

152
00:11:24,340 --> 00:11:29,580
lot more functionality so first we are
talking about is this Windows PowerShell

153
00:11:29,580 --> 00:11:35,700
honey ports this is really cool project
it's just a very simple script by John

154
00:11:35,700 --> 00:11:40,880
Holt and carlos perez essentially all it
does is run any prescription define the

155
00:11:40,880 --> 00:11:44,880
ports that you want to imitate as long
as you don't have those used already can

156
00:11:44,880 --> 00:11:50,460
spend up on a port on the box on reports
so we're showing here is essentially

157
00:11:50,460 --> 00:11:55,330
hard to read about that but this is
they're just basically doing a neck a

158
00:11:55,330 --> 00:11:59,880
connection to this host has a high port
running on port 21 and so soon as they

159
00:11:59,880 --> 00:12:01,500
connect they get a

160
00:12:01,500 --> 00:12:04,990
success and it looks normal rate but
then they try and connect again another

161
00:12:04,990 --> 00:12:09,710
band from this post so very easy way to
just stop people r Pocono your hosts

162
00:12:09,710 --> 00:12:15,880
from actually accessing them and then
whenever these are actually access you

163
00:12:15,880 --> 00:12:19,460
you get essentially we're both log
messages that you can and Justin year

164
00:12:19,460 --> 00:12:23,000
Sam rear light management system or
whatever and use that to correlate back

165
00:12:23,000 --> 00:12:26,250
against the real environment and see
like what else this person's been up to

166
00:12:26,250 --> 00:12:31,550
over the past couple days or something
like that so essentially once you get a

167
00:12:31,550 --> 00:12:35,920
lot of these hits you end up with a
bunch of IP is just within your windows

168
00:12:35,920 --> 00:12:39,010
firewall to say hey these people crowd
the honey port now they're banned from

169
00:12:39,010 --> 00:12:44,420
this hurts so in Lenox there's an
awesome project called artillery anyone

170
00:12:44,420 --> 00:12:51,690
here massive artillery things awesome
gotta check it out so artillery it's

171
00:12:51,690 --> 00:12:54,920
it's a very cool project essentially
what it does

172
00:12:54,920 --> 00:12:59,660
same same sort of thing just honey port
but when the when they connect to get a

173
00:12:59,660 --> 00:13:03,300
bunch of this junk back just kinda cool
is sometimes so confused people are

174
00:13:03,300 --> 00:13:08,080
trying to figure out what it is but the
real thing about this is as very verbose

175
00:13:08,080 --> 00:13:13,750
logging built into it so essentially by
default till just dumb plugs into your

176
00:13:13,750 --> 00:13:18,230
Linux syslog so very easy to you know
and just about every person rocks with

177
00:13:18,230 --> 00:13:23,230
as it is you can also push to local
stocks again just push directly from

178
00:13:23,230 --> 00:13:27,710
that box to a syslog server or you can
just set up your own flat files as

179
00:13:27,710 --> 00:13:33,720
dumped into another just artillery
logfile essentially and same sort of

180
00:13:33,720 --> 00:13:39,160
thing I could use added the ban list and
Brock locally VIP tables now bonus with

181
00:13:39,160 --> 00:13:43,510
artillery this one of the other really
neat things about it it actually does

182
00:13:43,510 --> 00:13:47,150
for security configuration checks once
you launch it so go through your web

183
00:13:47,150 --> 00:13:51,339
directory and I'll say like oh you have
too many permissions on this directory

184
00:13:51,339 --> 00:13:56,960
stuff like that I'm so does it for like
security review of your server the first

185
00:13:56,960 --> 00:14:00,930
time you run it as well which is really
great but also it includes file

186
00:14:00,930 --> 00:14:05,450
integrity monitoring built in which is
really nice cuz down here and this

187
00:14:05,450 --> 00:14:06,400
bottom

188
00:14:06,400 --> 00:14:09,510
window here we're just simulating
essentially someone uploading a red

189
00:14:09,510 --> 00:14:13,820
shell that the server and so once they
do that we can see a new file is added

190
00:14:13,820 --> 00:14:17,740
the server and we get a very verbose
message saying like a there's a new file

191
00:14:17,740 --> 00:14:21,790
added this is weird here's the hash of a
here's the contents of that stuff so

192
00:14:21,790 --> 00:14:27,840
it's just that really easy way to figure
out to essentially monitor for you or

193
00:14:27,840 --> 00:14:34,460
for any additions or subtractions Armada
hey sorry the file system for 30 here

194
00:14:34,460 --> 00:14:43,460
ever run any pots open to the internet
so I like showing this because I'm doing

195
00:14:43,460 --> 00:14:47,990
is just gonna head out the ban list from
a artillery honey Porter we had running

196
00:14:47,990 --> 00:14:52,570
for less than a day opening Internet I
just like showing how many people are

197
00:14:52,570 --> 00:14:55,580
actively probing at things on the
internet but you're running your

198
00:14:55,580 --> 00:14:59,210
external fire walls and stuff like that
you probably don't realize how often

199
00:14:59,210 --> 00:15:02,980
you're getting hits from everything on
the internet and will talk about how you

200
00:15:02,980 --> 00:15:06,310
can actually learn from this and carve
out exploits and stuff like that from

201
00:15:06,310 --> 00:15:10,930
some of the more verbose honey pots but
it's like showing this cuz you get poked

202
00:15:10,930 --> 00:15:17,270
out all the time so small on the low
interaction honey pots slow interaction

203
00:15:17,270 --> 00:15:21,570
honey pots I tend to put the web app
honey pots and often their flat files

204
00:15:21,570 --> 00:15:26,670
air-to-air activists simulate the basic
aspects of certain that UPS has four

205
00:15:26,670 --> 00:15:30,860
storms caused word this was actually
kind of our old this is still a great

206
00:15:30,860 --> 00:15:35,510
tour PES wordPress is one of the most
commonly attack content management

207
00:15:35,510 --> 00:15:39,120
systems out there is very popular lot of
people can figure this they don't

208
00:15:39,120 --> 00:15:42,600
actually know how WordPress setup and
they don't do all that additional

209
00:15:42,600 --> 00:15:46,800
security configuration stuff like that
so the great one to set up as a honey

210
00:15:46,800 --> 00:15:51,820
pot thing about this is you can simulate
wherever you are you can actually load

211
00:15:51,820 --> 00:15:56,760
real WordPress themes into it you can
make it look about as legit as a real

212
00:15:56,760 --> 00:16:01,670
WordPress site is just a Python script
that you run and essentially just as

213
00:16:01,670 --> 00:16:05,130
soon as he running you just type in
whatever seems you want stuff like that

214
00:16:05,130 --> 00:16:07,500
if you are in a run this

215
00:16:07,500 --> 00:16:11,720
would highly suggest customizing it a
bit because the version is very old says

216
00:16:11,720 --> 00:16:16,020
I change the version looks like it's a
more recent version of Word

217
00:16:16,020 --> 00:16:20,850
have to be careful there but this one
also just output logs to a flat files

218
00:16:20,850 --> 00:16:24,390
that makes it very easy to go through
and it just seemed to whatever your loss

219
00:16:24,390 --> 00:16:30,390
estimates now he felt the same topping
one of the things I like doing is just

220
00:16:30,390 --> 00:16:34,550
cloning legitimate web applications and
then standing about his honey pots just

221
00:16:34,550 --> 00:16:39,330
by modifying form processors and stuff
like that so right here were faking a

222
00:16:39,330 --> 00:16:43,730
PHP my ad which is great because this
thing it's attacked almost as much as

223
00:16:43,730 --> 00:16:48,270
WordPress because it's so common this is
very commonly misconfigured as well a

224
00:16:48,270 --> 00:16:52,140
lot of people do you leave default
credentials on these things like that so

225
00:16:52,140 --> 00:16:56,040
why don't we stand up our own fake
version of this that's flat files they

226
00:16:56,040 --> 00:16:58,850
can actually do seek rejection they
can't do command injection stuff like

227
00:16:58,850 --> 00:17:04,449
that but it looks just like a PHP my
admin instance insisting the roads here

228
00:17:04,449 --> 00:17:09,220
are some essentially just set up so that
it will both see log any type of

229
00:17:09,220 --> 00:17:13,589
interaction with with the weather up
patients oh so like someone just visit

230
00:17:13,589 --> 00:17:17,610
the page and also logged they tried
credentials that failed and I'll

231
00:17:17,610 --> 00:17:22,339
probably actually gain access and then
like if you have like a late night yes

232
00:17:22,339 --> 00:17:25,910
you have some for packet capture
capabilities in place we can do is

233
00:17:25,910 --> 00:17:29,700
actually grabbed the peak a popular
attacking these things and carville

234
00:17:29,700 --> 00:17:34,010
exploits across a large and you can
actually find brand new attacks against

235
00:17:34,010 --> 00:17:41,220
phpMyAdmin despite running running parts
so it's pretty fun solo singing just

236
00:17:41,220 --> 00:17:45,630
cloning web applications and using me as
an end scenarios where they looked

237
00:17:45,630 --> 00:17:51,090
legitimate but they really aren't this
one right here this is a a cell bpm

238
00:17:51,090 --> 00:17:54,000
service so we decided Klein

239
00:17:54,000 --> 00:18:02,060
it would take a guess that why we
decided to SSL VPN service yes yeah

240
00:18:02,060 --> 00:18:05,290
exactly so harvesting compromise
credentials as one of the great things

241
00:18:05,290 --> 00:18:08,680
you can do this with us then we can
determine whether or not people have

242
00:18:08,680 --> 00:18:12,250
real credentials the third just guessing
if you know if they've actually

243
00:18:12,250 --> 00:18:16,790
compromise something already you want to
know how do you they've got but the real

244
00:18:16,790 --> 00:18:22,490
main reason I like using a so VPN is
because it looks completely normal trend

245
00:18:22,490 --> 00:18:28,140
job on their system so is anyone using
VPN they're like Oh course I do need to

246
00:18:28,140 --> 00:18:32,640
allow this so I can gain access to more
fun stuff is great for like reverse

247
00:18:32,640 --> 00:18:36,340
fishing and stuff and he see someone's
already compromised the box and you send

248
00:18:36,340 --> 00:18:40,260
them an email and he know the attackers
right chain Laco here's this news site

249
00:18:40,260 --> 00:18:44,300
with all the secret stuff or whatever is
a great way to do this and get actual

250
00:18:44,300 --> 00:18:49,280
client side code execution on their
system so this job of payload that we

251
00:18:49,280 --> 00:18:51,780
sent them sexually honey badger

252
00:18:51,780 --> 00:18:58,800
played with honey badger badger is
amazing thank you Tim towns this thing

253
00:18:58,800 --> 00:19:03,740
is awesome so what it does is actually
goes out and it scans over wireless

254
00:19:03,740 --> 00:19:08,330
networks around the area just using your
actual system was ranked owed on the on

255
00:19:08,330 --> 00:19:12,760
the end point and that uses the Google
Location API to find out your exact

256
00:19:12,760 --> 00:19:16,040
location by measuring the distance
between these know and access points

257
00:19:16,040 --> 00:19:20,690
sorry sleepover stuff so they know
exactly where you are and it's pretty

258
00:19:20,690 --> 00:19:24,880
accurately here and this is my house and
it pinpointed like me and my office at

259
00:19:24,880 --> 00:19:29,470
my house like it it's pretty good so
he's just kind of a breakdown of money

260
00:19:29,470 --> 00:19:32,760
better visit actors are gonna take you
directly to this is done they haven't

261
00:19:32,760 --> 00:19:36,100
done that for ten years right they're
gonna go through proxies are going to be

262
00:19:36,100 --> 00:19:39,900
P S is there gonna use other compromised
systems to attack you isn't it doesn't

263
00:19:39,900 --> 00:19:45,510
give them away as an entity so right
here I'm just going through a proxy here

264
00:19:45,510 --> 00:19:50,330
so it's like in Switzerland but really
running the honey badger payload

265
00:19:50,330 --> 00:19:55,510
allowing it to myself you can see I was
actually in Westminster Colorado so it's

266
00:19:55,510 --> 00:19:59,170
pretty cool how well you can do to
actually find out where some people

267
00:19:59,170 --> 00:20:00,190
might actually be

268
00:20:00,190 --> 00:20:07,879
this move on to medium interaction you
know there are tons and tons and tons of

269
00:20:07,879 --> 00:20:10,950
media reaction I possibly could actually
talk here or there about all the

270
00:20:10,950 --> 00:20:14,259
different medium interaction honey pot
so instead what I want to do is talk

271
00:20:14,259 --> 00:20:17,450
about one of my favorite ones that Skip
Bo

272
00:20:17,450 --> 00:20:26,919
ever play Skip Bo so kickass breaks what
this does is simulates a SSH service so

273
00:20:26,919 --> 00:20:29,990
you can make this look like any of your
other Linux systems within your

274
00:20:29,990 --> 00:20:35,690
environment it's a very cool tour to
play it's very easy to place is just a

275
00:20:35,690 --> 00:20:39,539
small Python scripts and essentially
with a few other configuration

276
00:20:39,539 --> 00:20:45,080
directories like that was just very
customizable extremely portable like

277
00:20:45,080 --> 00:20:48,389
once you have configured you can push
this out to multiple system of any

278
00:20:48,389 --> 00:20:53,549
environment and same sort of lying to
it's very easy to capture those logs and

279
00:20:53,549 --> 00:20:58,279
pull them off into a central repository
is just flat style flat files centrally

280
00:20:58,279 --> 00:21:03,059
but they're really neat part of typical
args is actually stores the pool ttyl

281
00:21:03,059 --> 00:21:08,600
session as well so the nice thing about
ttyl the ttyl such as you can replay the

282
00:21:08,600 --> 00:21:12,600
entire session the attacker saucy can
see like what they saw what commands

283
00:21:12,600 --> 00:21:16,899
they ran with it had typos like if a
backspace and stuff like that you can

284
00:21:16,899 --> 00:21:21,269
see real-time exactly what they're doing
on your box as they're doing it so

285
00:21:21,269 --> 00:21:26,259
pretty fun to watch if you if you ever
been some of these are the problem

286
00:21:26,259 --> 00:21:30,559
though so so there's quite a few issues
with hippo and that it's very popular

287
00:21:30,559 --> 00:21:36,120
lot of people are using capo it's out
there all over the internet and so a lot

288
00:21:36,120 --> 00:21:40,279
of people found ways to bypass it and
and essentially find out that it's a

289
00:21:40,279 --> 00:21:44,059
honeypot right away if you login to keep
her and hit her three times it'll break

290
00:21:44,059 --> 00:21:48,129
and that's like a dead giveaway this
honey pot we see a lot of botnets doing

291
00:21:48,129 --> 00:21:51,899
that stuff that's why I don't recommend
this one for external use I recommend

292
00:21:51,899 --> 00:21:54,809
this one for internal use we're looking
for like employees doing stuff for

293
00:21:54,809 --> 00:21:58,389
someone pivoting and stuff like that in
the environment when they're poking

294
00:21:58,389 --> 00:22:00,900
around looking for stuff

295
00:22:00,900 --> 00:22:05,510
is another thing when you deploy these
externally a lot of control servers but

296
00:22:05,510 --> 00:22:09,190
thats cool essentially gain access is
honey pots and just sit there though

297
00:22:09,190 --> 00:22:12,580
just keep using up and we're still feel
like ec2 instance or something like that

298
00:22:12,580 --> 00:22:19,270
you can end up with an expensive bill
says something to you be aware of the

299
00:22:19,270 --> 00:22:24,470
other thing with capo you can use this
on Pinterest well so great favourite

300
00:22:24,470 --> 00:22:28,940
things like internal pen test a lot of
these environments have my configuration

301
00:22:28,940 --> 00:22:32,040
management tools going around scanning
all the stuff in the environment

302
00:22:32,040 --> 00:22:36,230
a lot of security teams they seem like a
new host pop up there was running

303
00:22:36,230 --> 00:22:39,900
credentials and against that box which
is funny because all you have to do

304
00:22:39,900 --> 00:22:44,660
stand-up hippo and then just wait for
some legitimate service login dealer

305
00:22:44,660 --> 00:22:48,970
codes there's all sorts of different
products that this works I so it's just

306
00:22:48,970 --> 00:22:52,790
another trick if you're ever do an
internal pen test stand up honey pot on

307
00:22:52,790 --> 00:22:56,110
your little shared server that you guys
are all sharing notes and stuff are just

308
00:22:56,110 --> 00:23:00,130
leave it overnight and see what rise
login you like responder and stuff too

309
00:23:00,130 --> 00:23:07,250
so she had a messed with Kip oh I just
wanted to show could download like how

310
00:23:07,250 --> 00:23:12,090
it works and what the law actually look
like and you know what the ttyl session

311
00:23:12,090 --> 00:23:16,700
looks like and how you can dynamically
alert on the stuff so right here we just

312
00:23:16,700 --> 00:23:21,920
ran iptables script apologize pretty
hard to read but we're doing here is

313
00:23:21,920 --> 00:23:26,100
we're just forwarding any requests
destined for 422 to port 2222 which is

314
00:23:26,100 --> 00:23:28,020
we're running the honeypot

315
00:23:28,020 --> 00:23:33,250
default hippo honey court court
essentially the reason we do this is

316
00:23:33,250 --> 00:23:36,960
because we don't actually run cable
directly import 22 that requires they'll

317
00:23:36,960 --> 00:23:40,910
get permissions to someone does actually
exploit this or break out of it or

318
00:23:40,910 --> 00:23:44,690
whatever we don't want them to actually
have root permissions that's why we do

319
00:23:44,690 --> 00:23:50,340
that so now we're just gonna tell the
laws have kept you up and running yet to

320
00:23:50,340 --> 00:23:54,960
arrive now reason I like showing the
Royal I mean this is one of the reasons

321
00:23:54,960 --> 00:23:58,730
why people don't run honey pots because
it's a lot to go through that's why if

322
00:23:58,730 --> 00:24:02,410
you gonna run this honey pots you want
to ingest them into some sort of central

323
00:24:02,410 --> 00:24:09,110
management system for a here we're just
doing some plugins are attempting to log

324
00:24:09,110 --> 00:24:15,710
into this box we did some invalid
attempts there and see there's the user

325
00:24:15,710 --> 00:24:21,790
and pass free trade and down here had
gained access sarah is gonna run some

326
00:24:21,790 --> 00:24:25,800
commanders can figure out like what her
sister Ariana you know just do some

327
00:24:25,800 --> 00:24:31,500
quick stuff attacker would normally do
it right here they're actually pulling

328
00:24:31,500 --> 00:24:35,890
down some now where a lot of times and
they gain access to a host as funny as

329
00:24:35,890 --> 00:24:39,860
you can tell when it's a bot to the
login with root but then no download a

330
00:24:39,860 --> 00:24:44,040
local privilege escalation exploit and
run it like it's funny it's just so

331
00:24:44,040 --> 00:24:48,370
ingrained in their scripts but this is
just a little example are some of the

332
00:24:48,370 --> 00:24:52,840
things you might see the cool thing with
Kip 017 anyone ever poles down files to

333
00:24:52,840 --> 00:24:57,270
the host actually stores them in a
separate downloads directory season

334
00:24:57,270 --> 00:24:59,710
actually go through and hash those and
then check those against your

335
00:24:59,710 --> 00:25:02,020
environment and stuff like that

336
00:25:02,020 --> 00:25:08,260
here I just had a basic email rating so
whenever we whenever we are breached

337
00:25:08,260 --> 00:25:13,050
where honey pots breach notification now
what it contains brief message like this

338
00:25:13,050 --> 00:25:17,670
honey powers popped at this time bottom
drawer and so this fire is actually in

339
00:25:17,670 --> 00:25:22,060
the airport ttyl session just replayed
the funny part when I recorded this

340
00:25:22,060 --> 00:25:26,610
initially this is a real attack so so
someone actually broken like as I was

341
00:25:26,610 --> 00:25:31,389
doing the stamina and I just too lazy to
record again so

342
00:25:31,389 --> 00:25:37,159
so here we have essentially the output
from a command and as too lazy to form a

343
00:25:37,159 --> 00:25:43,659
decorated the time to do so I'm really
very here is essentially everything we

344
00:25:43,659 --> 00:25:47,820
just saw as the attacker on our end just
sent directly to us and the security

345
00:25:47,820 --> 00:25:51,700
operations team the sea like oh this is
what they did here's how they got on

346
00:25:51,700 --> 00:25:55,879
stuff like that now if you actually use
the play loud script directly it's

347
00:25:55,879 --> 00:26:01,789
really cool to see them like backspace
and until it's a person by person like

348
00:26:01,789 --> 00:26:07,409
that so can define if you want a message
that spirits up on my webpage and he

349
00:26:07,409 --> 00:26:12,859
slides will be up later so don't worry
about taking notes or anything else

350
00:26:12,859 --> 00:26:19,779
around a higher action shots no I
interaction honey pots are super far he

351
00:26:19,779 --> 00:26:25,389
is essentially we actually uses a lot of
them to figure out a lot of new rules

352
00:26:25,389 --> 00:26:29,849
and things that we baked into our
products essentially what these are as

353
00:26:29,849 --> 00:26:33,419
these are highly instrumented legitimate
systems that we have dedicated

354
00:26:33,419 --> 00:26:38,589
monitoring I'm also just a couple of the
tools that we use a lot of open source

355
00:26:38,589 --> 00:26:45,489
tools in our analysis are detection
stuff like that but this one as it isn't

356
00:26:45,489 --> 00:26:50,820
so but there s more so so is our
products we tie everything and we highly

357
00:26:50,820 --> 00:26:54,989
instrumental we do very verbose logging
on everything having on these hosts we

358
00:26:54,989 --> 00:27:00,559
also tired now sorry is not tied in the
same way like the you might think we

359
00:27:00,559 --> 00:27:03,839
don't have it like as an inline aight
yes and said what we do is like when we

360
00:27:03,839 --> 00:27:07,639
capture samples and we explode then
we're looking to analyze them out where

361
00:27:07,639 --> 00:27:12,339
we actually set up a sinkhole that
everything goes to search cada which is

362
00:27:12,339 --> 00:27:15,609
really cool to serve how to contain a
monthly interact or some forms of

363
00:27:15,609 --> 00:27:18,580
malware which is very fun but

364
00:27:18,580 --> 00:27:27,000
we also use bro so grill is very
powerful and his bro yes you are right I

365
00:27:27,000 --> 00:27:31,750
highly suggest you check out essentially
that's the one we do use in line

366
00:27:31,750 --> 00:27:35,769
together our data saying what's actually
happening in the network and stuff like

367
00:27:35,769 --> 00:27:39,100
that and you don't do a whole lot
blocking because these are honey

368
00:27:39,100 --> 00:27:43,610
populist we just want to see the data
then cuckoo that's essentially what we

369
00:27:43,610 --> 00:27:48,649
use to explode the power and tested see
you know how it works so it's not just

370
00:27:48,649 --> 00:27:54,710
actual systems that you can imitate for
any part centrally so this is a project

371
00:27:54,710 --> 00:28:00,309
called a Roman hunter or aka the router
Manhunter this is a essentially a higher

372
00:28:00,309 --> 00:28:05,100
action honey pot but it is actually a
real access point that whenever people

373
00:28:05,100 --> 00:28:10,490
actually gain access to it it just log
their MAC address and simple right there

374
00:28:10,490 --> 00:28:13,809
nice thing about that is you can take
that Mac and compare it back to real

375
00:28:13,809 --> 00:28:18,320
environments like hey is this an
employee is not an employee like what

376
00:28:18,320 --> 00:28:22,130
you know where does the smack sure his
lot of times attackers don't change the

377
00:28:22,130 --> 00:28:26,260
MAC address during Wireless tax or just
any attacks or just kind of funny

378
00:28:26,260 --> 00:28:31,409
because like a basic thing you should be
doing you know to keep your up sexy but

379
00:28:31,409 --> 00:28:37,059
that's why this this works very well now
you can set this up as like depending on

380
00:28:37,059 --> 00:28:41,360
how you engage the attackers you can say
it with a web key and just like ok some

381
00:28:41,360 --> 00:28:45,299
script kiddie broken or something like
that but you do like wpa2 with a decent

382
00:28:45,299 --> 00:28:46,429
password

383
00:28:46,429 --> 00:28:49,580
that's something he deftly wanna noe
valley someone reaches that when you're

384
00:28:49,580 --> 00:28:54,409
dealing with someone who actually knows
what theyre doing so lots of warnings

385
00:28:54,409 --> 00:28:58,100
with high interaction honey pots though
because you're running real systems

386
00:28:58,100 --> 00:29:02,200
you're putting real services out there
so it can be dangerous that's what you

387
00:29:02,200 --> 00:29:06,830
want to have someone dedicated to
actually monitoring these boxes there

388
00:29:06,830 --> 00:29:11,649
any compromises you'd risk their people
can use these systems to attack other

389
00:29:11,649 --> 00:29:15,190
systems they could download things
that'll get you thrown in prison on

390
00:29:15,190 --> 00:29:19,559
those boxes see you have to be very
careful now

391
00:29:19,559 --> 00:29:23,279
one of the things I like stressing here
is never used organizations gold

392
00:29:23,279 --> 00:29:29,220
standard image if you're going to deploy
higher action there's a case where

393
00:29:29,220 --> 00:29:34,980
someone did this and essentially what
what happens is they they deploy to hire

394
00:29:34,980 --> 00:29:39,169
action honey pot just windows box out in
the DMZ on their network

395
00:29:39,169 --> 00:29:43,580
RDP open the internet with a stupid
password and so of course like I think

396
00:29:43,580 --> 00:29:46,960
it was that they got breached
essentially what happened is they got in

397
00:29:46,960 --> 00:29:51,909
got on the host but they don't local
hashes from that box and then use those

398
00:29:51,909 --> 00:29:58,139
hashes to pivot into the real network
and it yet is bad so don't do that use a

399
00:29:58,139 --> 00:30:01,710
brand new image make sure you know what
you're doing if you're gonna play these

400
00:30:01,710 --> 00:30:04,570
things and that someone watching them to
make sure some right that doesn't really

401
00:30:04,570 --> 00:30:09,519
happen and then segment this would have
also helped protect them if they segment

402
00:30:09,519 --> 00:30:13,100
to this post properly is DMZ is still
has a direct training to the

403
00:30:13,100 --> 00:30:17,779
organization most the time see you on a
segment is properly

404
00:30:17,779 --> 00:30:22,869
honey took him to talk about document
bug tracking files and stuff like that

405
00:30:22,869 --> 00:30:28,090
so file integrity monitoring is actually
very easy to configure

406
00:30:28,090 --> 00:30:32,149
essentially you can do this just within
Windows itself all you have to do is go

407
00:30:32,149 --> 00:30:36,169
to the advanced properties and configure
file integrity monitoring his host what

408
00:30:36,169 --> 00:30:40,340
this does it generates both locks on
these files are interacting with them

409
00:30:40,340 --> 00:30:44,980
this is a very cheap easy way to do this
there's also a lot of tours that are out

410
00:30:44,980 --> 00:30:50,830
there that if this functionality as well
so he tokens are sent you are talking

411
00:30:50,830 --> 00:30:55,379
about your trading either using
legitimate documents and bugging them or

412
00:30:55,379 --> 00:30:58,899
creating fake documents they will be
high-value targets for you know red

413
00:30:58,899 --> 00:31:03,519
team's attackers those types of folks
that are going to be gone after your

414
00:31:03,519 --> 00:31:08,200
network about this we're not just
talking about just files these could be

415
00:31:08,200 --> 00:31:12,470
strings this could be database entries
these could be you know whatever here

416
00:31:12,470 --> 00:31:16,490
whatever you can imagine really as long
as it's something that you have

417
00:31:16,490 --> 00:31:19,290
redefined in your detection capabilities

418
00:31:19,290 --> 00:31:24,920
then you know when it's being interacted
with him whereas you know other systems

419
00:31:24,920 --> 00:31:28,010
that you know you're actually watching
this closely you might not so this will

420
00:31:28,010 --> 00:31:32,200
help to highlight some of these issues
some people accessing things they

421
00:31:32,200 --> 00:31:38,380
shouldn't be so let's talk about
document but you know there is actually

422
00:31:38,380 --> 00:31:45,000
a whole talk document bugging earlier
this year really cool talk this bug

423
00:31:45,000 --> 00:31:47,110
files as you document telling on you

424
00:31:47,110 --> 00:31:51,150
highly recommend checking that out of
fear that you are rare in more about all

425
00:31:51,150 --> 00:31:56,770
the different ways you can bug files and
stuff like that and then web bug how to

426
00:31:56,770 --> 00:32:01,560
this first rank this just shows you like
what web bugs are why they were how they

427
00:32:01,560 --> 00:32:06,390
were kind of the basic high-level
details a web bug czar and web server is

428
00:32:06,390 --> 00:32:12,660
essentially some software used to detect
drugs so by default you can put them out

429
00:32:12,660 --> 00:32:17,890
of your your you know your web server
history and stuff like that but if he is

430
00:32:17,890 --> 00:32:22,260
what books are actually stores them in a
database and keeps them essentially

431
00:32:22,260 --> 00:32:26,860
makes it easier for you to go through
and actually figure out you know what's

432
00:32:26,860 --> 00:32:31,760
a web and what wasn't a web bug so any
help segment that so funny thing about

433
00:32:31,760 --> 00:32:35,500
this stuff is document tracking is
essentially it's all just the same

434
00:32:35,500 --> 00:32:40,510
tricks that marketing and sales have
used for decades right essentially

435
00:32:40,510 --> 00:32:44,840
whatever you load images and emails ur
like in a document or something like

436
00:32:44,840 --> 00:32:50,570
that there's chances that it can call
out essentially all red bugs are three

437
00:32:50,570 --> 00:32:54,790
here as Apple's site lets you know like
when people read your Gmail and stuff

438
00:32:54,790 --> 00:33:01,160
like that but down here in the bottom
left that's actually just a web but all

439
00:33:01,160 --> 00:33:05,660
it is is an image tag the calls back to
the server has specific traits like it

440
00:33:05,660 --> 00:33:09,460
shows what the idea of the page you
really can't was what your ideas like

441
00:33:09,460 --> 00:33:12,810
all these other unique indicators that
when they received this communication

442
00:33:12,810 --> 00:33:18,030
they know exactly what it was that's all
we're really talking about here is a

443
00:33:18,030 --> 00:33:20,650
cool thing about documents

444
00:33:20,650 --> 00:33:24,420
bugging you know where documents and
stuff like that specifically is the fact

445
00:33:24,420 --> 00:33:27,890
that these were documents are
essentially just glorified web browsers

446
00:33:27,890 --> 00:33:34,110
really is you can load HTML content with
inward so we do here there are it and

447
00:33:34,110 --> 00:33:38,970
this little picture here is just a
simple document it's just a web page

448
00:33:38,970 --> 00:33:42,860
that we've labeled as a document and
that's all you really have to do to

449
00:33:42,860 --> 00:33:47,410
create about web and what are the
problems with what bugs as it takes a

450
00:33:47,410 --> 00:33:51,000
little bit of time to create these
inject these especially into existing

451
00:33:51,000 --> 00:33:54,450
documents because you have to change the
formatting of the documents PDF

452
00:33:54,450 --> 00:34:02,700
documents aren't saved in HTML format so
we decided to do to get his script to go

453
00:34:02,700 --> 00:34:07,620
through and take like a whole list of
files to see you like 500 systems they

454
00:34:07,620 --> 00:34:11,690
want to put web bugs are you go through
and load them into this fire and a no go

455
00:34:11,690 --> 00:34:15,040
through and if the files existed a bug
those files and if they don't exist

456
00:34:15,040 --> 00:34:20,669
those create a new file with a web bug
in it so you wanna message this get that

457
00:34:20,669 --> 00:34:25,980
time I get out of there but before you
do any of this stuff just be aware there

458
00:34:25,980 --> 00:34:30,179
are lots of the issues in terms of
document because these guys decide to

459
00:34:30,179 --> 00:34:33,570
open this up our client they're gonna
see their documents trying to call back

460
00:34:33,570 --> 00:34:37,310
somewhere and it's a dead giveaway that
you're probably tracking them are you

461
00:34:37,310 --> 00:34:42,710
trying to lease so just have to be aware
that like dole leaves like web server in

462
00:34:42,710 --> 00:34:46,730
the euro and stuff like that was back
when the other things we do to make this

463
00:34:46,730 --> 00:34:51,440
look more legit as we use the company
logo as I'm just glad it's like when it

464
00:34:51,440 --> 00:34:56,750
loads and actually see an image pop up
there like okay you knows maybe whereas

465
00:34:56,750 --> 00:35:00,650
like it's just a white square they don't
see anything pop up then they'll get

466
00:35:00,650 --> 00:35:06,880
suspicious of attackers know these
tactics well that's kinda bring all this

467
00:35:06,880 --> 00:35:13,640
together and go through a formal case
study in here read the recent stories

468
00:35:13,640 --> 00:35:17,690
around the CEO CFO phishing scam and
stuff that's going around

469
00:35:17,690 --> 00:35:21,890
yes hitting probably everyone where
they're doing just basic wire fraud

470
00:35:21,890 --> 00:35:27,080
transfer attempts so this is one of
those and we decided to mess with them

471
00:35:27,080 --> 00:35:27,840
because

472
00:35:27,840 --> 00:35:32,630
we getting tired of our finance team was
getting very tired of getting bugged

473
00:35:32,630 --> 00:35:39,220
about this all the time so we decided to
comply with our CEO so what we did is we

474
00:35:39,220 --> 00:35:44,030
just set up a fake admin assistant and
we just all start murdering my inbox and

475
00:35:44,030 --> 00:35:49,740
so what happened was here is essentially
the reply back to the scammer where is

476
00:35:49,740 --> 00:35:55,630
asking if he's asking CFO to prime Wire
Transfer and CFO's busy guy right so he

477
00:35:55,630 --> 00:35:57,180
has admin assistant do this

478
00:35:57,180 --> 00:36:05,640
aka so soon as he sends us reply back to
work with a proper his admin assistant

479
00:36:05,640 --> 00:36:11,640
we actually get email directly to do
that an assistant and so from here these

480
00:36:11,640 --> 00:36:16,010
are just the nature of the headers from
his email here who can tell a lot about

481
00:36:16,010 --> 00:36:21,390
this dude just from his headers so first
we can see the reply to goes to CEO desk

482
00:36:21,390 --> 00:36:28,160
wine.com and is it super believe or
eight and then the high-rated portion is

483
00:36:28,160 --> 00:36:32,480
actually is really about diseases real
email account actually send these these

484
00:36:32,480 --> 00:36:38,740
scams campaigns out so using that we
found a LinkedIn profile pretty legit

485
00:36:38,740 --> 00:36:45,390
and so I as far as found some other
stuff too but it's not as funny as

486
00:36:45,390 --> 00:36:51,460
LinkedIn but we decided to do is make a
wire transfer form this is our super

487
00:36:51,460 --> 00:36:56,130
crappy wire transfer form that we sent
them back as funny as I never even done

488
00:36:56,130 --> 00:37:02,320
a wire transfer for us we had to figure
this out real quick but sensually we put

489
00:37:02,320 --> 00:37:06,250
some like ridiculous numbers in there
make it look like an official documents

490
00:37:06,250 --> 00:37:10,120
and stuff like that but the key part if
you see down at the bottom here is too

491
00:37:10,120 --> 00:37:14,170
hard to read the back we actually said
click here to digitally sign and submit

492
00:37:14,170 --> 00:37:15,640
this document

493
00:37:15,640 --> 00:37:21,200
nicholas's that was about this
ridiculous gets even more ridiculous so

494
00:37:21,200 --> 00:37:26,760
I mean that's like not leave her at all
but we've got like 20 minutes there this

495
00:37:26,760 --> 00:37:32,570
together said his back so essentially
one sees signs document we have the

496
00:37:32,570 --> 00:37:35,390
message out there please enable Java

497
00:37:35,390 --> 00:37:41,700
because you need job at a sign documents
right course made sense so he sent an

498
00:37:41,700 --> 00:37:47,299
email back would be super friendly
Khazar CEO beer and ice storm so we sent

499
00:37:47,299 --> 00:37:53,180
an email back and yes we'd be glad to
get that process for you here if you

500
00:37:53,180 --> 00:37:57,680
fill out the form yet if not we attach
one pre convenience so we sent him a

501
00:37:57,680 --> 00:38:02,799
farm back and we will see if this works
as soon as we sent it was like literally

502
00:38:02,799 --> 00:38:06,670
minutes after he sent this he actually
open the document we get a web bug car

503
00:38:06,670 --> 00:38:12,539
back just three years so it's funny like
you can actually tell just from the web

504
00:38:12,539 --> 00:38:16,619
but call back so of course we get IP
address which is good you know unless

505
00:38:16,619 --> 00:38:20,400
these proxies and stuff like that but
one of the one of the most interesting

506
00:38:20,400 --> 00:38:24,599
aspects i think is actually his user
agent string who can tell what type of

507
00:38:24,599 --> 00:38:30,510
system his arm we can see is on a little
aziz tablet PCs and Windows which is

508
00:38:30,510 --> 00:38:34,470
good for us as if we wanted to further
attack the sky or you know trying to

509
00:38:34,470 --> 00:38:39,410
some other stuff to arm then we know
what platforms arm so we can tailor our

510
00:38:39,410 --> 00:38:41,440
code to work with his system

511
00:38:41,440 --> 00:38:50,980
tracing his IP course is Nigeria where
to go and what if anything is actually

512
00:38:50,980 --> 00:38:55,569
not all Nigeria and other stuff I can't
show here but essentially one of the key

513
00:38:55,569 --> 00:39:00,809
things is this did go back to a person
within the us- and it went to a bank

514
00:39:00,809 --> 00:39:06,559
within the USA as well actually I'm
California which you know is is kind of

515
00:39:06,559 --> 00:39:11,460
interesting right just trying to kind of
message these guys and this is how you

516
00:39:11,460 --> 00:39:15,700
actually gained more intelligence on
these people as opposed to just owed you

517
00:39:15,700 --> 00:39:20,329
report the email you know actually
stopped and stuff like that

518
00:39:20,329 --> 00:39:24,920
another thing they did is essentially
put physical processes in place for the

519
00:39:24,920 --> 00:39:28,430
finance team as well so any of these
things that come through that physical

520
00:39:28,430 --> 00:39:31,720
verification the Rolling Rock over and
talk to the person before they do any of

521
00:39:31,720 --> 00:39:36,410
these things you have to add these these
controls and as well along with just

522
00:39:36,410 --> 00:39:37,940
messing with these guys

523
00:39:37,940 --> 00:39:42,569
so speaking of messing with attackers
there's a lot of other fun tricks again

524
00:39:42,569 --> 00:39:47,839
did his piss people off one of my
favorites is it bombs near anyone here

525
00:39:47,839 --> 00:39:55,970
ever messes it bombs yes they are so far
there is this one right here to get

526
00:39:55,970 --> 00:40:00,980
unforgettable that you need a dot idk
there's a smiley can download called 42

527
00:40:00,980 --> 00:40:06,280
does it and what this does is it is
essentially is like 16 are 30 or

528
00:40:06,280 --> 00:40:10,260
something like compressed zip files
compressed with another zip files right

529
00:40:10,260 --> 00:40:14,900
I guess this crazy amount animation of
zip files and so once they expand this

530
00:40:14,900 --> 00:40:21,010
thing it expands to 4.2 petabytes like
that all trash is super computer so I

531
00:40:21,010 --> 00:40:24,420
guess this fundraiser

532
00:40:24,420 --> 00:40:29,839
the other fun trick is the browser
exploitation framework so beef and the

533
00:40:29,839 --> 00:40:33,260
cool thing here is we're not talking
about like using an art pen test where

534
00:40:33,260 --> 00:40:37,099
we have to find a cross-site scripting
bug and exploit and stuff like that you

535
00:40:37,099 --> 00:40:40,790
own the environment you know where the
attackers looking why not just had a

536
00:40:40,790 --> 00:40:44,530
beef and one of these pages then you can
like dynamically rick roll on even like

537
00:40:44,530 --> 00:40:49,480
do whatever you can pop shells on a beef
is a for enteral highly recommended this

538
00:40:49,480 --> 00:40:53,109
year we haven't played with it before
but this one I actually haven't done

539
00:40:53,109 --> 00:40:57,700
this because I'm afraid to build one of
the is but USB killer is an awesome

540
00:40:57,700 --> 00:41:02,880
projects essentially what it does it
turns a USB into basically battery so

541
00:41:02,880 --> 00:41:07,530
when you plug it in at Pfizer CPU so we
find someone physically you know you're

542
00:41:07,530 --> 00:41:10,589
worried about someone physically
stealing something whatever mostly I

543
00:41:10,589 --> 00:41:16,170
just wanted included in here today think
it's also one of my favorites is mister

544
00:41:16,170 --> 00:41:22,880
clipe know this you can actually use any
image rights and she's just a PHP IDs

545
00:41:22,880 --> 00:41:27,410
plugin that shows images when it detects
known attacks on her trafficker will

546
00:41:27,410 --> 00:41:31,829
help you decide to configure it taught
people with this kind of it's kind of

547
00:41:31,829 --> 00:41:40,069
far for the most Lake surprisingly this
is like one of the most useful or honey

548
00:41:40,069 --> 00:41:42,359
pot kinda things i've seen

549
00:41:42,359 --> 00:41:45,950
because it just confuses the shit out of
people and just sit there and massive

550
00:41:45,950 --> 00:41:50,180
this for a long time so far so what
we're doing is we're scouting debt

551
00:41:50,180 --> 00:41:55,849
random out to deck at all it is like
takes two seconds to set up and he can

552
00:41:55,849 --> 00:41:59,960
mess with attackers four hours of this
thing so funny to say they're trying to

553
00:41:59,960 --> 00:42:05,660
figure out what always joke is it's it's
hilarious they get the good thing is

554
00:42:05,660 --> 00:42:08,280
when they're trying to figure this stuff
out there not going after your real

555
00:42:08,280 --> 00:42:12,030
systems now you can take it a step
further if you just want them to

556
00:42:12,030 --> 00:42:17,310
definitely know you're you're trolling
or by sending a little a scary movies

557
00:42:17,310 --> 00:42:24,980
when they when they connect your box 48
here we're gonna play a little video so

558
00:42:24,980 --> 00:42:28,910
just gonna tell that in here you can
download the code for this that they're

559
00:42:28,910 --> 00:42:37,400
the link below their 2007 they connect
in the record to ask you mess with

560
00:42:37,400 --> 00:42:45,710
attackers Wednesday so the key to all of
this though is actually tying everything

561
00:42:45,710 --> 00:42:50,690
and you know you have some central team
that's monitoring all the stuff that you

562
00:42:50,690 --> 00:42:54,280
know as far as this is you do need to
gather actionable intelligence from this

563
00:42:54,280 --> 00:42:58,920
from us if your gonna you know have
business by and to send me the stuff you

564
00:42:58,920 --> 00:43:02,770
wanna have you know you're dedicated
monitoring team ready to respond to

565
00:43:02,770 --> 00:43:08,440
these threats ready to actively defender
network essentially so we want to tie in

566
00:43:08,440 --> 00:43:13,440
you know all of our our security tools
what have you know least one view of the

567
00:43:13,440 --> 00:43:17,670
whole network we can actually see like
the honey pots being interact with and

568
00:43:17,670 --> 00:43:21,339
the real network run as high those
together and see how they are rewrite

569
00:43:21,339 --> 00:43:26,760
and so once we do this once we actually
have the basics in place we have our

570
00:43:26,760 --> 00:43:31,109
monitoring system up we have honey pot
some places sensors you can actually

571
00:43:31,109 --> 00:43:35,630
start to gather enterprise threat
intelligence I like to call it context

572
00:43:35,630 --> 00:43:38,800
aware threaten tell because this is the
stuff that's affecting you

573
00:43:38,800 --> 00:43:42,020
you directly and probably a similar
folks in here in your right

574
00:43:42,020 --> 00:43:45,360
industries because say you know your
your retail

575
00:43:45,360 --> 00:43:49,430
gonna be attacked completely differently
than say a hospital where are your bank

576
00:43:49,430 --> 00:43:53,470
or governments you know all these
different groups a lot of you have

577
00:43:53,470 --> 00:43:55,090
threatened tell Sharon rings

578
00:43:55,090 --> 00:43:58,900
problem don't this is something to be
great for people start doing you know

579
00:43:58,900 --> 00:44:03,040
set up like a trips database and
actually pull in some of the data that

580
00:44:03,040 --> 00:44:07,020
you're seeing and then share this with
the similar industries with folks in

581
00:44:07,020 --> 00:44:13,080
here your like industry essentially what
it all comes down to the bank relation

582
00:44:13,080 --> 00:44:22,230
so now once you know about this stuff
part of it is actively responding to it

583
00:44:22,230 --> 00:44:27,820
so one of the things we like doing we
call it dynamic honeypot essentially

584
00:44:27,820 --> 00:44:28,520
what this is

585
00:44:28,520 --> 00:44:31,980
we take the system that we see is you
know probably compromise I saw some

586
00:44:31,980 --> 00:44:35,630
weird stuff on it but is like a legit
systems probably someone's desktop or so

587
00:44:35,630 --> 00:44:41,160
great that we want to do is dynamically
turn this into a honeypot there's little

588
00:44:41,160 --> 00:44:45,230
trick that we do this aside from like
actually time this and tourists and

589
00:44:45,230 --> 00:44:50,480
pulling the gulags everything like that
we want to enable command line and

590
00:44:50,480 --> 00:44:54,620
PowerShell logging sales actually it
really i dont wanna go through all the

591
00:44:54,620 --> 00:45:00,380
details of this is a really good post by
a hacker hurricane Michael go get ever

592
00:45:00,380 --> 00:45:04,410
read his stuff but he's done some great
overview of how to do this he also has

593
00:45:04,410 --> 00:45:08,420
like the windows lighting chichi you
implement those dynamically you can

594
00:45:08,420 --> 00:45:12,120
dynamically turn a system into very
purpose honey pot and just see what's

595
00:45:12,120 --> 00:45:16,300
going on there watching the command-line
activity is how we catch a rather weird

596
00:45:16,300 --> 00:45:22,240
stuff our network so the terms of
automated response there's a bunch of

597
00:45:22,240 --> 00:45:27,450
tools out there that do this for us
essentially who Rapid Response Network

598
00:45:27,450 --> 00:45:34,580
spite 0 comments by Dave whore and that
power forensics by Garrett Atkins run a

599
00:45:34,580 --> 00:45:38,990
really cool projects out there that
allow you to automate incident response

600
00:45:38,990 --> 00:45:43,320
and automate the intelligence-gathering
automate you know actually contributing

601
00:45:43,320 --> 00:45:46,960
factor in service parts team and setting
up those processes

602
00:45:46,960 --> 00:45:50,210
things like that there's tons of free
resources out there so highly

603
00:45:50,210 --> 00:45:55,450
recommending you check something out I'm
so I wanted to play in the space too so

604
00:45:55,450 --> 00:45:59,910
i i suck at PowerShell so wanted to
learn how to do it a little better so I

605
00:45:59,910 --> 00:46:05,510
decided to create a ps3 her for
PowerShell regard it really is dynamic

606
00:46:05,510 --> 00:46:09,790
powershell script that remotely pulls
data from a host and you can do other

607
00:46:09,790 --> 00:46:13,609
things like disable users in Active
Directory locked the host down

608
00:46:13,609 --> 00:46:17,440
essentially disabled rail network
connections and a few other things

609
00:46:17,440 --> 00:46:22,099
dynamically report to the Security
Operations Team stuff like that and so

610
00:46:22,099 --> 00:46:25,820
the reason I built this is we tied in
with our weather Sam essentially the

611
00:46:25,820 --> 00:46:30,050
same with whatever your processes are
whenever specific fencer observed in the

612
00:46:30,050 --> 00:46:34,170
environment we're essentially fired we
go pour some friends excited from the

613
00:46:34,170 --> 00:46:37,730
solace and just see what's going on
there see if there's anything else that

614
00:46:37,730 --> 00:46:41,650
we need to dig into further with this
gives us a good quick snapshot of some

615
00:46:41,650 --> 00:46:46,680
high-level information on the hearst now
whenever you run this can have it set to

616
00:46:46,680 --> 00:46:52,430
send emails out so it creates HTML
report basically breaks down you know a

617
00:46:52,430 --> 00:46:57,290
bunch of the details are sewn together
these details inspires this report to

618
00:46:57,290 --> 00:47:01,950
the Security Operations teams they have
this information now they can start

619
00:47:01,950 --> 00:47:07,170
going through and you have more purple
eyes on the system of a sudden you know

620
00:47:07,170 --> 00:47:10,619
within a matter of seconds as opposed to
like ours was somewhere some of the

621
00:47:10,619 --> 00:47:14,440
other tools that are out there that's
all it is you want to check it out

622
00:47:14,440 --> 00:47:19,810
the ranking in West lights essentially
now we've talked about you know honey

623
00:47:19,810 --> 00:47:24,750
pots response and solar arrays UMass
attackers actually bring all this

624
00:47:24,750 --> 00:47:30,160
together one of the main things very
important aspects as a dashboard on

625
00:47:30,160 --> 00:47:34,010
something where you can see you know the
whole environment wanna see all your

626
00:47:34,010 --> 00:47:37,710
honey pots and you can see how they
relate to the real environment so many

627
00:47:37,710 --> 00:47:40,660
great three actually comes with tons of
different

628
00:47:40,660 --> 00:47:42,320
dashboard still 10

629
00:47:42,320 --> 00:47:45,670
the court thing there is you can choose
like which dashboards one actually is

630
00:47:45,670 --> 00:47:48,400
and then when you set them up in a real
environment you wanna have them

631
00:47:48,400 --> 00:47:52,030
segregate segment is there like you know
no one's actually get access the

632
00:47:52,030 --> 00:47:55,550
dashboard and find out the hosts they
were just poking out the honey pot stuff

633
00:47:55,550 --> 00:47:57,620
like that

634
00:47:57,620 --> 00:48:01,180
graphs one of them so since we talked
about kept include

635
00:48:01,180 --> 00:48:04,840
program in there and the modern honey
network now this is a really cool

636
00:48:04,840 --> 00:48:08,670
project there's actually talk at bsides
Las Vegas on this and I think they did

637
00:48:08,670 --> 00:48:13,610
workshop as well essentially what this
is an awesome project that it's not only

638
00:48:13,610 --> 00:48:15,840
a dashboard we can monitor honey pots

639
00:48:15,840 --> 00:48:20,310
actually dynamically deploy honey pots
and these are more medium interaction

640
00:48:20,310 --> 00:48:24,470
honey pots to resemble real systems and
you need dedicated IP is for each of

641
00:48:24,470 --> 00:48:27,660
these has heightened focus on here
because more I'm talking about

642
00:48:27,660 --> 00:48:32,130
intermixing honey pots real systems but
this one is a great if you want to just

643
00:48:32,130 --> 00:48:36,260
put out any possibly for throwing them
out on the internet and then of course

644
00:48:36,260 --> 00:48:44,240
best one of our a so this is the
honeypot I decided put together for

645
00:48:44,240 --> 00:48:49,330
within our soccer so essentially what I
go through some of the key pieces of

646
00:48:49,330 --> 00:48:53,150
data that you should be capturing within
within whatever towards Rooney is so

647
00:48:53,150 --> 00:48:57,880
first and foremost you might gather the
IP address Swansea who has broken loose

648
00:48:57,880 --> 00:49:02,430
his attacking our system and then
trending you look at the trending they

649
00:49:02,430 --> 00:49:06,140
are seeing within the honey pots as it
relates to the rest of the environments

650
00:49:06,140 --> 00:49:12,300
then stop using names of people have
really is real estate is intense alright

651
00:49:12,300 --> 00:49:19,640
good stuff then passwords same sort of
thing then honey took and file so if

652
00:49:19,640 --> 00:49:22,750
anyone actually poke around in these
directories really shouldn't be gathered

653
00:49:22,750 --> 00:49:28,190
files stuff like that we want to know
about it then user agent strings like

654
00:49:28,190 --> 00:49:31,460
drinking this out that shows what two
rows attackers are using in your

655
00:49:31,460 --> 00:49:35,220
environment as long as they're hitting
you like your web interfaces like that

656
00:49:35,220 --> 00:49:39,090
is a funny thing is people don't often
bothered to change the user agent

657
00:49:39,090 --> 00:49:46,290
strings payloads so many files that are
pulled down 10 year honey pots we're

658
00:49:46,290 --> 00:49:51,000
gonna gather the URLs is report downtown
is a great deal poke out by the way

659
00:49:51,000 --> 00:49:57,090
there's a tiger com last year actually
by Elliot brinkman and it's pretty cool

660
00:49:57,090 --> 00:50:00,570
he actually walked into some of these
boxes you like when poked back at them

661
00:50:00,570 --> 00:50:04,000
and make sure to write a really cool
details on their hosts assessor

662
00:50:04,000 --> 00:50:09,040
definitely check that out it's it's a
fun topic and then directionality went

663
00:50:09,040 --> 00:50:12,080
to see where these attacks are coming
from where they're coming from external

664
00:50:12,080 --> 00:50:17,280
internal or authority on one of our
horse like we're gonna see that and once

665
00:50:17,280 --> 00:50:21,090
we have that you know we have a very
high level dashboard of all the events

666
00:50:21,090 --> 00:50:27,840
that we're seeing on our network so is
that were almost at a time so I go

667
00:50:27,840 --> 00:50:32,800
through a quick list of some recommended
reading these are some of the sources

668
00:50:32,800 --> 00:50:36,160
that I is putting the stock together and
some of the research together and stuff

669
00:50:36,160 --> 00:50:41,860
like that so I highly recommend argues
resources up here the first on offensive

670
00:50:41,860 --> 00:50:46,580
countermeasures by John C an imposter in
an incredible book it's it's not too

671
00:50:46,580 --> 00:50:50,810
long you there but it's like four or
eight ways to actively defend your

672
00:50:50,810 --> 00:50:55,480
network on the next one blue team
handbook this is just a great overall

673
00:50:55,480 --> 00:51:00,280
book for in-service parts it's a really
good but just have on hand for when you

674
00:51:00,280 --> 00:51:04,640
have to actually initiated in service
parts and then logging and log

675
00:51:04,640 --> 00:51:09,090
management I know this is way up
everyone's out here but it's actually a

676
00:51:09,090 --> 00:51:12,720
very good book if you want to implement
logging in you want to do this the right

677
00:51:12,720 --> 00:51:16,940
way this is a excellent research to do
that now this last book reverse

678
00:51:16,940 --> 00:51:20,920
deception this one's a little different
than these other was actually a

679
00:51:20,920 --> 00:51:24,800
counterintelligence book this one finds
it talks about some of the tricks select

680
00:51:24,800 --> 00:51:29,710
government users and stuff like that
let's see I groups used to actually do

681
00:51:29,710 --> 00:51:36,590
Rivers the section so it's kind of hard
so that thinking my couple minutes for

682
00:51:36,590 --> 00:51:42,270
questions thanks so much guys

