1
00:00:00,000 --> 00:00:06,930
everyone thanks for coming to talk to
talk about some social engineering today

2
00:00:06,930 --> 00:00:13,660
but attention to go to social
engineering talks we hear clips that

3
00:00:13,660 --> 00:00:20,340
sound like this

4
00:00:20,340 --> 00:00:34,510
yeah yeah

5
00:00:34,510 --> 00:00:43,410
putting together a consolidated 0 site
since variety is there a few people to

6
00:00:43,410 --> 00:00:47,790
go to site and login and in some key
back on its feet

7
00:00:47,790 --> 00:00:53,160
why I have a couple months I'm actually
having to leave in a couple months for a

8
00:00:53,160 --> 00:01:02,000
doctor's appointment so it should be
pretty traffic I should be ok ok so he

9
00:01:02,000 --> 00:01:10,979
shouldn't have asked for a better like
it is whether it's just so you know

10
00:01:10,979 --> 00:01:34,610
browser and go to www.google.com / voice
/ that's 30 yes but US companies and you

11
00:01:34,610 --> 00:01:40,090
have the herald little in the middle of
fuckin

12
00:01:40,090 --> 00:01:56,970
yes perfect let's hope you don't need to
tell you when you call Julie and you may

13
00:01:56,970 --> 00:02:04,310
ask you to infectious and your your
regular user and password so that should

14
00:02:04,310 --> 00:02:16,750
work just like sources and login
available which mark in hand

15
00:02:16,750 --> 00:02:18,660
seriously

16
00:02:18,660 --> 00:02:40,910
ok I just tried to let me try again now
no I mean yeah okay so this is what we

17
00:02:40,910 --> 00:02:45,750
have the login page eight years ago and
talked to my developer

18
00:02:45,750 --> 00:02:49,720
today so I do the same thing so I know
right where you sitting

19
00:02:49,720 --> 00:03:03,690
ok here's your time ok ok thanks so how
many people who thought that sounded

20
00:03:03,690 --> 00:03:10,790
like that was awfully easy right and so
a lot of talks that we go to have clips

21
00:03:10,790 --> 00:03:16,340
that sounds like this and in sometimes
it is I mean that I only edited for

22
00:03:16,340 --> 00:03:23,270
extra phone rings and i mean this one
really was this straightforward but we

23
00:03:23,270 --> 00:03:28,780
don't talk about all the work that goes
into calls ending up like this

24
00:03:28,780 --> 00:03:33,400
this wasn't the first thing that I did
for this engagement so today we're going

25
00:03:33,400 --> 00:03:39,190
to talk about case study of an
engagement that I did this was one of

26
00:03:39,190 --> 00:03:44,890
the calls from that and how all the
things that happened on the way to a

27
00:03:44,890 --> 00:03:52,020
call that that works like that so who am
i i'm john fox I'm a senior security

28
00:03:52,020 --> 00:03:57,000
consultant with my appoint an AUX port
nerd the blindfolded lockpicking

29
00:03:57,000 --> 00:04:00,580
competitions are my favorite if you want
to learn how to pick locks please go

30
00:04:00,580 --> 00:04:05,940
visit that let the lockpick village it's
really good and they love to teach also

31
00:04:05,940 --> 00:04:13,580
this year at DEFCON I want black badge
for the acct a competition

32
00:04:13,580 --> 00:04:18,709
and so now we don't talk about a case
study how many people in the room do

33
00:04:18,709 --> 00:04:26,500
testing of some sort so few people
alright so we'll talk about some of the

34
00:04:26,500 --> 00:04:33,060
elements of that first thing is that you
have an objective of some sort and for

35
00:04:33,060 --> 00:04:37,810
this engagement the objective was to try
to obtain network credentials and or

36
00:04:37,810 --> 00:04:42,080
sensitive information through the use of
social engineering techniques

37
00:04:42,080 --> 00:04:47,630
specifically phone calls and emails and
of course providing value for the client

38
00:04:47,630 --> 00:04:53,920
anytime we do an engagement like this
it's you know we're trying to either let

39
00:04:53,920 --> 00:04:57,970
the client know things that they're not
aware of and their environment to help

40
00:04:57,970 --> 00:05:04,140
them fix it so that isn't a bad guy
making that phone call the scope for

41
00:05:04,140 --> 00:05:09,740
this engagement was that the client
provided all of the the names emails and

42
00:05:09,740 --> 00:05:14,860
phone numbers that we were allowed to
contact so on the one hand it might

43
00:05:14,860 --> 00:05:20,450
sound like sweet that was really that
that's that's pretty easy that and a lot

44
00:05:20,450 --> 00:05:25,560
of times when we do social engineering
contests it's more of a black box type

45
00:05:25,560 --> 00:05:30,760
scenario where we have to go and find
our own employee names phone numbers

46
00:05:30,760 --> 00:05:38,780
emails and kind of figured out for
herself and that means two things one is

47
00:05:38,780 --> 00:05:45,510
that it's a little more work up front
that way but also we get to pick and

48
00:05:45,510 --> 00:05:53,590
choose so I can cherry pick then either
areas to focus on our areas to avoid and

49
00:05:53,590 --> 00:05:59,120
in this case the problem is presented
for me was that I don't get to pick and

50
00:05:59,120 --> 00:06:05,160
choose and this list that was given to
people who are scattered all through the

51
00:06:05,160 --> 00:06:09,660
company so they're in different
departments different locations

52
00:06:09,660 --> 00:06:15,770
different levels so there were no
obvious groups and I didn't have an

53
00:06:15,770 --> 00:06:18,900
infinite number of pretext I could I
could do

54
00:06:18,900 --> 00:06:25,070
we had to figure something out and be
able to do a good test and we need

55
00:06:25,070 --> 00:06:30,320
something always for social engineering
you want something that credible in

56
00:06:30,320 --> 00:06:34,680
order for it to be effective and we
always have limited time we only have

57
00:06:34,680 --> 00:06:42,139
you know a few days or what have you to
actually execute the test so where do

58
00:06:42,139 --> 00:06:47,660
you start you want to you want to
accomplish thanks so if there's a

59
00:06:47,660 --> 00:06:52,030
process so if you're a good guy social
engineer or a bad guy social engineer we

60
00:06:52,030 --> 00:06:57,260
all use some version of this process
already talked about the goals

61
00:06:57,260 --> 00:07:04,910
requirements network credentials and
phone phone or fish and particular group

62
00:07:04,910 --> 00:07:10,760
people from there we do research find
out what we can find out about the

63
00:07:10,760 --> 00:07:18,470
company and gather gather data once
we've gathered information than we do

64
00:07:18,470 --> 00:07:21,910
analysis figure out well what does that
mean I've gathered a bunch of data

65
00:07:21,910 --> 00:07:28,190
points what does it mean and where do I
see opportunities for social engineering

66
00:07:28,190 --> 00:07:34,449
exploit in what am I actually gonna do
what protects life is from air attack

67
00:07:34,449 --> 00:07:38,400
phone you know phone up send an email

68
00:07:38,400 --> 00:07:44,330
show up whatever it is you're doing and
then it works or it doesn't work so if

69
00:07:44,330 --> 00:07:50,680
it doesn't work then you can't figure
out what you learned because even in

70
00:07:50,680 --> 00:07:53,060
failing

71
00:07:53,060 --> 00:07:57,449
getting busted on a call or an in person
thing you for what you've learned

72
00:07:57,449 --> 00:08:02,940
something else about the environment and
maybe you can use for a subsequent try

73
00:08:02,940 --> 00:08:10,409
and coerce if you succeed then you know
if he if you got network credentials for

74
00:08:10,409 --> 00:08:17,430
example perhaps you go on to try to move
through the environment with others so

75
00:08:17,430 --> 00:08:21,550
research we are together goals
objectives next step is to do some

76
00:08:21,550 --> 00:08:26,979
research and there are plenty of tools
that will help you gather gather data

77
00:08:26,979 --> 00:08:29,849
alter ego is one example

78
00:08:29,849 --> 00:08:34,120
it's not a requirement though you
there's a lot of things that are readily

79
00:08:34,120 --> 00:08:38,969
available that will help you find all
kinds of information about a company

80
00:08:38,969 --> 00:08:43,349
Google is way up top

81
00:08:43,349 --> 00:08:50,300
LinkedIn that was one I used extensively
for this engagement never fails to

82
00:08:50,300 --> 00:08:55,649
provide us good information about the
technology in an environment that's what

83
00:08:55,649 --> 00:09:01,970
I T people do it's how I teach you will
get their next job is by letting other

84
00:09:01,970 --> 00:09:05,949
people know what technologies they've
done what kinds of implementations and

85
00:09:05,949 --> 00:09:12,800
upgrades they worked with you also find
out more information about people what

86
00:09:12,800 --> 00:09:15,930
kind of projects have they done while
they've been at that at their company

87
00:09:15,930 --> 00:09:23,920
glass door good source of job postings
as well as you may find interview

88
00:09:23,920 --> 00:09:27,720
questions you may also find employee
reviews and get some insight into the

89
00:09:27,720 --> 00:09:33,870
environment how people feel about
working their iconic square I didn't use

90
00:09:33,870 --> 00:09:37,500
this for this specific engagement but I
kinda square if you're not familiar with

91
00:09:37,500 --> 00:09:39,029
it is

92
00:09:39,029 --> 00:09:47,410
Instagram aggregating site and want to
see what kinds of things people and

93
00:09:47,410 --> 00:09:52,180
their environment are our Instagram
being really check out iconic square for

94
00:09:52,180 --> 00:10:01,630
is a tangent for the DEFCON CTF and the
research phase I found 21 percent of my

95
00:10:01,630 --> 00:10:09,189
flag evidence the iconic square that it
had all been on photo-sharing sites it

96
00:10:09,189 --> 00:10:13,589
was all kinds of information I found
about the environment so it's important

97
00:10:13,589 --> 00:10:18,189
to check that out especially if you're
responsible for an environment people I

98
00:10:18,189 --> 00:10:18,759
found it

99
00:10:18,759 --> 00:10:24,630
countless badge photos as well that's a
thing people do so it's important to

100
00:10:24,630 --> 00:10:26,019
educate them

101
00:10:26,019 --> 00:10:28,579
Facebook Twitter

102
00:10:28,579 --> 00:10:33,110
other social media that's always good to
look at a company Facebook site can show

103
00:10:33,110 --> 00:10:39,670
you pictures of baby company different
company events or parties you can see

104
00:10:39,670 --> 00:10:44,759
how people dress in the environment what
kind of gives you something that if it's

105
00:10:44,759 --> 00:10:52,819
timely something you can reference call
company website is always always good

106
00:10:52,819 --> 00:10:58,860
you learn about the principles of the
company leaders leadership you can find

107
00:10:58,860 --> 00:11:03,759
out different things that are going on
you can find usually company logos which

108
00:11:03,759 --> 00:11:09,989
are great to use for e-mails or web
sites are things you want to do look

109
00:11:09,989 --> 00:11:16,220
credible inappropriately exposed
documents so using some google searching

110
00:11:16,220 --> 00:11:22,649
to look at look for documents that may
be inappropriately exposed the client's

111
00:11:22,649 --> 00:11:28,889
company site then there might be called
list available there might be org charts

112
00:11:28,889 --> 00:11:35,419
and that stuff that is gold the social
engineer vendor case studies this figure

113
00:11:35,419 --> 00:11:42,249
into almost every social engineering
engagement I do there's all is a vendor

114
00:11:42,249 --> 00:11:45,290
thats proud of their work and wants to
showcase it and they give a lot of

115
00:11:45,290 --> 00:11:52,269
details about the old now all the credit
system that they helped upgrade and

116
00:11:52,269 --> 00:11:57,209
replace and help make everything more
efficient so you can learn a lot through

117
00:11:57,209 --> 00:12:02,819
case studies and of course the news
either on the company website or local

118
00:12:02,819 --> 00:12:09,769
bar sometimes national or international
news depending hopefully not but thanks

119
00:12:09,769 --> 00:12:16,629
to see what's going on with the company
so do research after gathering a whole

120
00:12:16,629 --> 00:12:19,249
bunch of data that's really all it is

121
00:12:19,249 --> 00:12:26,369
data and you have to look through it and
decide for yourself what it means so in

122
00:12:26,369 --> 00:12:31,079
this case I saw that the the company
this company had grown through merger

123
00:12:31,079 --> 00:12:33,490
and acquisition which is not unusual

124
00:12:33,490 --> 00:12:40,209
at all and I knew that because the
company website had news about that and

125
00:12:40,209 --> 00:12:47,470
also local media from that that
companies area had information about

126
00:12:47,470 --> 00:12:53,950
that as well and so that was that was
one thing that I decided was an

127
00:12:53,950 --> 00:13:01,060
interesting point and the other thing
that i inferred from my information was

128
00:13:01,060 --> 00:13:05,709
that there would be a lack of
integration of the backend system so one

129
00:13:05,709 --> 00:13:10,750
because I've been given all of the
information contact information i had

130
00:13:10,750 --> 00:13:16,520
the email addresses I could see that the
demands for the email addresses were

131
00:13:16,520 --> 00:13:20,779
different there were several different
ones mapping to the original companies

132
00:13:20,779 --> 00:13:27,510
also through research noted that there
were multiple service providers

133
00:13:27,510 --> 00:13:34,740
sometimes for the same function so that
was a clue and then finally twenty years

134
00:13:34,740 --> 00:13:44,120
of time and I T cells may have even
though in I T and info sack we think

135
00:13:44,120 --> 00:13:47,520
that it's really important that it from
a company and I by another company of

136
00:13:47,520 --> 00:13:53,380
course I want to bring all of their
information and systems into the fold of

137
00:13:53,380 --> 00:13:59,540
stuff that I already you know understand
and and hopefully protect well and it's

138
00:13:59,540 --> 00:14:04,750
it's a straightforward idea but often
very complicated in execution and that

139
00:14:04,750 --> 00:14:08,579
it's hard for a lot of companies to do
that so I figured odds were really in my

140
00:14:08,579 --> 00:14:18,750
favor that a bunch of stuff on the back
end was I did not hang together so given

141
00:14:18,750 --> 00:14:24,320
that and going back to I still don't
have an obvious grouping of people

142
00:14:24,320 --> 00:14:28,709
accept the fact they all work the same
company they're kind of their scattered

143
00:14:28,709 --> 00:14:35,200
all over the place so now what am i what
am I going to do but there's one thing

144
00:14:35,200 --> 00:14:41,089
all of us care about it no matter how we
feel about our jobs or something that

145
00:14:41,089 --> 00:14:50,589
we all expect to be there and happened
consistently lack of integration the

146
00:14:50,589 --> 00:14:55,189
backend systems and I figured payroll
payroll is the way to go that's

147
00:14:55,189 --> 00:15:00,160
something everybody on that list was
gonna care about and I were in my favor

148
00:15:00,160 --> 00:15:06,839
that they would not have an integrated
so that's that's the direction that

149
00:15:06,839 --> 00:15:16,240
chose to go with this exploit so far
this we found a website for one of the

150
00:15:16,240 --> 00:15:20,769
service providers one of the several
service providers for this company and

151
00:15:20,769 --> 00:15:28,319
move to the web site and most payroll
service providers have some sort of a

152
00:15:28,319 --> 00:15:35,029
portal portal login a lot of you use or
have used sites like this log your time

153
00:15:35,029 --> 00:15:44,809
and so we stopped it but then there are
certain things that we left intact so

154
00:15:44,809 --> 00:15:53,839
first we had the company logo you've got
the service logo you've got a contact us

155
00:15:53,839 --> 00:16:01,079
stuff down at the bottom and come talk
to us on social media and all of those

156
00:16:01,079 --> 00:16:08,439
on the spoofed site that that was all
left intact and it was left intact so if

157
00:16:08,439 --> 00:16:15,769
you clicked the payroll Co logo you'd go
to their their site and we did this for

158
00:16:15,769 --> 00:16:24,769
two reasons one its easier to something
that I know embargo social engineers

159
00:16:24,769 --> 00:16:32,009
know is that we teach people that if we
cover over something we could we should

160
00:16:32,009 --> 00:16:37,949
look at the URL to see what it's
connected to and so by leaving house

161
00:16:37,949 --> 00:16:44,620
intact it lends more credibility to the
website so if people are checking to see

162
00:16:44,620 --> 00:16:49,660
is this legit and this helps it look
legit

163
00:16:49,660 --> 00:16:56,180
the middle part was the part that we
altered so I added the the company logo

164
00:16:56,180 --> 00:17:04,000
the company logo which was helpfully
provided it on the company website and

165
00:17:04,000 --> 00:17:08,520
that helps it look legitimate this is
the right place so that helps it check

166
00:17:08,520 --> 00:17:16,530
out and in people's mind there's a
request to please enter your corporate

167
00:17:16,530 --> 00:17:23,690
username and password and login so when
somebody actually enters their

168
00:17:23,690 --> 00:17:30,250
information and click Login it goes to a
little database that that we had instead

169
00:17:30,250 --> 00:17:33,930
of actually living amid and it would
present an error message saying that

170
00:17:33,930 --> 00:17:36,920
something's not working with the site
right now

171
00:17:36,920 --> 00:17:41,330
try please try again later what's more
credible than a website not working

172
00:17:41,330 --> 00:17:51,890
unfortunately so so this so we had this
all set up next there is a general fish

173
00:17:51,890 --> 00:18:00,480
that we sent out and it is we say that
it's from the benefits from the intern

174
00:18:00,480 --> 00:18:06,090
benefits team and again we've got the
company logo to make it look look

175
00:18:06,090 --> 00:18:13,420
credible we have a link to the website
we want them to go to and and then the

176
00:18:13,420 --> 00:18:18,990
important part is that we offered with
the intention of the $50 Visa gift card

177
00:18:18,990 --> 00:18:23,690
because who doesn't like everyone's busy
we don't we all know everybody's busy

178
00:18:23,690 --> 00:18:29,510
and we're asking them to do an extra
thing but now they get the carrot of a

179
00:18:29,510 --> 00:18:33,310
few provide feedback on our website you
can be entered to get a $50 Visa gift

180
00:18:33,310 --> 00:18:39,360
card and we really we had people who
attended living in multiple times with

181
00:18:39,360 --> 00:18:43,250
multiple configurations

182
00:18:43,250 --> 00:18:49,620
this version of my I didn't work I
better try this one is they want the

183
00:18:49,620 --> 00:18:51,650
gift card

184
00:18:51,650 --> 00:18:59,480
so we sent out we did campaign of the
general finish we also did so

185
00:18:59,480 --> 00:19:06,020
targeted fishes with this and say you
know from the attorney benefits teams

186
00:19:06,020 --> 00:19:11,420
got the company logo so that's all that
the same thing but then because I had

187
00:19:11,420 --> 00:19:16,870
the list of specific individuals who
were were targeted for this the one

188
00:19:16,870 --> 00:19:22,040
advantage that gave me as it made sense
to spend some time on LinkedIn and find

189
00:19:22,040 --> 00:19:28,630
out about them so in this case here's
somebody that we we know is a longtime

190
00:19:28,630 --> 00:19:33,850
associate of the company has since been
there a long time so I can I can

191
00:19:33,850 --> 00:19:39,330
reference that and also I know what
department this person has worked in for

192
00:19:39,330 --> 00:19:45,120
a long time so I can reference that and
it makes it again just look more more

193
00:19:45,120 --> 00:19:56,520
convincing so that was the second
element so then the third thing we do so

194
00:19:56,520 --> 00:20:02,130
we collected a bunch of credentials with
the emails and we did the phone call so

195
00:20:02,130 --> 00:20:07,250
we heard one earlier and now knowing
what you know let's listen to another

196
00:20:07,250 --> 00:20:12,860
one

197
00:20:12,860 --> 00:20:27,299
and chilly out it isn't France Gelinas
from smoking and working with best to

198
00:20:27,299 --> 00:20:32,049
put it together consolidated 0 site and
so nourished

199
00:20:32,049 --> 00:20:37,770
yep yep so value different locations

200
00:20:37,770 --> 00:20:43,260
six there's a little variety of
locations right now so we're putting

201
00:20:43,260 --> 00:20:49,419
together a control of their 1 repin a
few people to go to this site and login

202
00:20:49,419 --> 00:20:55,600
and take a look and let us know what you
doing so do you have a few minutes to go

203
00:20:55,600 --> 00:21:04,140
to the site and check it out for me
what's what is payroll that's all one

204
00:21:04,140 --> 00:21:17,540
word hero dotnet / okay and you should
see oil prices which are taking too long

205
00:21:17,540 --> 00:21:33,690
yes this blog in 3 reporter perfect for
this point so now use your regular user

206
00:21:33,690 --> 00:21:34,929
name and password

207
00:21:34,929 --> 00:21:42,380
normally normally use and it should take
you to our new sites we have it hooked

208
00:21:42,380 --> 00:21:46,460
up temporarily unavailable please try
again later

209
00:21:46,460 --> 00:21:53,799
ok so I guess it's just you know the end
of the week so I'm sorry that's

210
00:21:53,799 --> 00:21:58,169
obviously going to have to call a
developer and find out what's going on

211
00:21:58,169 --> 00:22:06,059
with the website so was it at 6:38 I
call you back like to know more txt me

212
00:22:06,059 --> 00:22:14,240
to try to 4:45 today and then of course
the back anytime ok thank you so much

213
00:22:14,240 --> 00:22:21,510
thank you have a great week

214
00:22:21,510 --> 00:22:25,090
this one actually had to edit quite a
bit because it took a ton of

215
00:22:25,090 --> 00:22:29,750
troubleshooting to get him to the right
page which is why I said I'm sorry this

216
00:22:29,750 --> 00:22:43,570
is taking so long but he really hung in
which was worked for me so so let's talk

217
00:22:43,570 --> 00:22:48,060
about the pretext a little bit I say
that I'm from a certain consulting

218
00:22:48,060 --> 00:22:54,490
company that was right out of a vendor
case study I found so I was using the

219
00:22:54,490 --> 00:23:00,390
name of a real company that had really
done work for this client and they had

220
00:23:00,390 --> 00:23:06,100
done work that kind of fell in line with
the thing that I was I was putting forth

221
00:23:06,100 --> 00:23:12,730
so that was one element of it the other
was that in both cause I dropped the

222
00:23:12,730 --> 00:23:21,090
name of somebody and that was this
person is the head of a jar and I and

223
00:23:21,090 --> 00:23:27,880
she was thank you too thanks a lot to
LinkedIn and a really great summary a

224
00:23:27,880 --> 00:23:33,740
LinkedIn profile and that she was well
known for doing efficiency projects in

225
00:23:33,740 --> 00:23:37,930
what would be more efficient than just
getting everybody on one payroll say so

226
00:23:37,930 --> 00:23:45,200
it's very plausible for what what she
was known for and her position and when

227
00:23:45,200 --> 00:23:54,090
I chose who to call with this pretext it
was called people who were not hurt here

228
00:23:54,090 --> 00:23:58,210
but people who I I could reasonably
expect would know who she was

229
00:23:58,210 --> 00:24:02,720
people who work in the same facility or
maybe a similar function but not in that

230
00:24:02,720 --> 00:24:06,560
facility so people who would not
necessarily be there when we hanging out

231
00:24:06,560 --> 00:24:15,880
with her having lunch at times almost up
so what we heard where we had goals and

232
00:24:15,880 --> 00:24:20,520
requirements we did research and
recounted it found a bunch of

233
00:24:20,520 --> 00:24:25,590
information did analysis to figure out
what that meant and where the where

234
00:24:25,590 --> 00:24:34,360
there might be a toehold for information
or exploit we figured something out and

235
00:24:34,360 --> 00:24:42,440
executed and in this case it we did meet
our objectives and in this case we did

236
00:24:42,440 --> 00:24:47,840
not have it but we did meet our
objectives and helped provide the client

237
00:24:47,840 --> 00:24:51,940
with good feedback about some changes
that could be made the environment to

238
00:24:51,940 --> 00:24:59,580
help them with this and and that's
pretty much it will be around today and

239
00:24:59,580 --> 00:25:06,060
if you have any questions you can send
an email or hit me up on Twitter and

240
00:25:06,060 --> 00:25:10,310
that's about it and anybody who is
already here if you want to understand

241
00:25:10,310 --> 00:25:18,790
more deeply the research and analysis
part of the of this process I encourage

242
00:25:18,790 --> 00:25:23,590
you to stay for the next talk by ninja
slot where he goes into a lot of detail

243
00:25:23,590 --> 00:25:27,530
about how that works thanks a lot

244
00:25:27,530 --> 00:25:28,020
thank you for your

