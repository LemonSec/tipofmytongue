1
00:00:00,000 --> 00:00:10,019
it felt good afternoon everybody my name
is Carl Andress talk a little bit about

2
00:00:10,019 --> 00:00:16,970
you huntin just quick disclaimer course
content expressed the presentation to

3
00:00:16,970 --> 00:00:24,580
spy on please don't sue me company in
general I've been working and I T for

4
00:00:24,580 --> 00:00:29,810
about 10 years last two years though
I've been working strictly and security

5
00:00:29,810 --> 00:00:35,559
in particular and thats all of the work
that I do is chasing down by something

6
00:00:35,559 --> 00:00:40,050
executed you are looking into a
malicious document attachment and it's

7
00:00:40,050 --> 00:00:44,120
kind of pulling out what's in there and
trying to find some indicators are

8
00:00:44,120 --> 00:00:50,190
usually just IP address is she going to
any other machines I really like your

9
00:00:50,190 --> 00:00:52,899
computer problems I got started

10
00:00:52,899 --> 00:00:58,170
I'd start off in the company faces at
their level support person so I dealt

11
00:00:58,170 --> 00:01:02,399
with a lot of weird problems we'd
software software that people of either

12
00:01:02,399 --> 00:01:06,400
wrote and then disappeared in the
company of the person who wrote it so

13
00:01:06,400 --> 00:01:10,439
you personalize trying to back to
reverse engineer but they did have

14
00:01:10,439 --> 00:01:14,530
always been like really interested in
when things break it's basically like me

15
00:01:14,530 --> 00:01:19,650
to forensics and why i like it so much
she gets back to the roots are trying to

16
00:01:19,650 --> 00:01:24,200
figure out exactly why something
executed or wise ran into why something

17
00:01:24,200 --> 00:01:31,490
happened which basically leads you to a
lot of spreadsheets fortunately

18
00:01:31,490 --> 00:01:35,720
forensics you tend to make a lot of time
outs this is your

19
00:01:35,720 --> 00:01:42,439
artifacts and Parsons and looking for to
put every all the events in order to get

20
00:01:42,439 --> 00:01:46,650
put into the spreadsheet in just four
days

21
00:01:46,650 --> 00:01:51,400
Genda gonna look over a little bit when
something crashes kind of what you think

22
00:01:51,400 --> 00:01:57,280
about Justin memory artifacts of
interests will be a process that begins

23
00:01:57,280 --> 00:02:06,440
distance from tools that help prime you
so usually we're talking about something

24
00:02:06,440 --> 00:02:10,350
terrible happens here to browse in
crashes or if you're at like a

25
00:02:10,350 --> 00:02:17,230
corporation virus that goes up or
fireballer are you get report from using

26
00:02:17,230 --> 00:02:21,860
that says something bad happened or you
leave your computer on like saying your

27
00:02:21,860 --> 00:02:32,650
co-workers take us like that guy so
every time that happens in the back your

28
00:02:32,650 --> 00:02:35,620
head that's like what

29
00:02:35,620 --> 00:02:41,280
footsteps and in the end you you start
to record everything that you know he'll

30
00:02:41,280 --> 00:02:46,470
grab any process any process that you
know the names out especially the time

31
00:02:46,470 --> 00:02:50,000
date probably the most important to you
can use that later in narrow down your

32
00:02:50,000 --> 00:02:53,480
search for evidence

33
00:02:53,480 --> 00:03:00,230
so first I was just kind of a choir all
things so I'll talk about Justin memory

34
00:03:00,230 --> 00:03:08,870
acquisition of people here actually have
required disk and memory is a bunch of

35
00:03:08,870 --> 00:03:11,989
tools and some ideas kind of behind it

36
00:03:11,989 --> 00:03:22,360
first if we're talking about disk full
disk or targeted or sniper and they did

37
00:03:22,360 --> 00:03:27,519
it normally during investigation you
might grab a hard drive you plug it in

38
00:03:27,519 --> 00:03:33,290
and you as the entire drive takes a lot
of time usually if you're dealing with

39
00:03:33,290 --> 00:03:37,599
malware or something that likes you can
get a fast answer and so you're going to

40
00:03:37,599 --> 00:03:42,260
target just friends car defects you know
we're going to give you a big thanks to

41
00:03:42,260 --> 00:03:48,359
you by Kraft the NTFS file system you
might grab it and FTP file and then you

42
00:03:48,359 --> 00:03:53,329
might have the hyper sis file and then
you might grab event logs and kind of go

43
00:03:53,329 --> 00:03:56,959
down that path that would be kinda like
more of us that her friend extend

44
00:03:56,959 --> 00:04:00,799
there's an art there's actually an
article written by Chris prague talks

45
00:04:00,799 --> 00:04:05,590
about that but if you are taking like a
full disk image one thing to keep in

46
00:04:05,590 --> 00:04:09,980
mind is easy to use the right blacker as
soon as you plug that drive in your

47
00:04:09,980 --> 00:04:14,139
computer if you have any antivirus or
other software it'll start writing or

48
00:04:14,139 --> 00:04:18,690
reading to it and I just can't mess up
your evidence so the right placards

49
00:04:18,690 --> 00:04:22,950
physical device a plugin between your
computer and the hard drive it prevents

50
00:04:22,950 --> 00:04:26,460
you from doing any rights to it

51
00:04:26,460 --> 00:04:32,580
braids if you have time to rate for some
reason you terrible is approaching and

52
00:04:32,580 --> 00:04:34,260
would take forever

53
00:04:34,260 --> 00:04:38,420
but usually you do the logical because
if you try to get physical drives one by

54
00:04:38,420 --> 00:04:41,440
one and I can really put all that
together and if you do you have

55
00:04:41,440 --> 00:04:47,400
specialized software encryption can be a
problem too and can slow down your

56
00:04:47,400 --> 00:04:51,860
investigation or when you require an
acquired very easily so when you go to

57
00:04:51,860 --> 00:04:53,070
use your friends

58
00:04:53,070 --> 00:04:58,160
tools and grab two pieces that you're
not going to read it is it is so then

59
00:04:58,160 --> 00:05:00,800
you have to take the extra step of
actually going through and decrypting

60
00:05:00,800 --> 00:05:04,840
that has some tools out there that I
help you with this case for example

61
00:05:04,840 --> 00:05:10,760
actually allows you to decrypt so you
actually give the DPP too in case and

62
00:05:10,760 --> 00:05:20,070
processes that data collection and then
go through so in doing this exhibition

63
00:05:20,070 --> 00:05:24,470
there's a couple of tools they have just
run across that used his lot out there

64
00:05:24,470 --> 00:05:25,930
in general

65
00:05:25,930 --> 00:05:32,400
FTK imager and my opinion it's a very
simple tool especially their work or

66
00:05:32,400 --> 00:05:39,180
there's Linux variety of didi which
ported over to Windows Windows eating

67
00:05:39,180 --> 00:05:48,360
and then a couple of free he said their
efforts Ponce well actually deploy out a

68
00:05:48,360 --> 00:05:51,510
client to an end point and you'll have a
nice cozy

69
00:05:51,510 --> 00:05:56,120
created back so it looks like the local
disk on your machine and then you can

70
00:05:56,120 --> 00:06:01,210
use something like FTK imager another
copy and you can just create a lot of

71
00:06:01,210 --> 00:06:11,750
network traffic and then FTK in case
also can acquire this so

72
00:06:11,750 --> 00:06:17,280
so let's just look real quick like FTK
imager and see what it looks like real

73
00:06:17,280 --> 00:06:35,940
quick and see how smoothly this goes to
the course that could do that so many

74
00:06:35,940 --> 00:06:48,510
painful this is a major and what kinda
nice about it is if you want to you can

75
00:06:48,510 --> 00:07:01,100
mount your own car driver in it and when
you do that I'd like to see that so for

76
00:07:01,100 --> 00:07:08,320
example I have my 500 gigabyte SSD Drive
like that one when I'm out

77
00:07:08,320 --> 00:07:12,710
ecstasy at a pretty good about my
partition

78
00:07:12,710 --> 00:07:19,860
that are bad for the root of the drive

79
00:07:19,860 --> 00:07:23,860
entered a like if we're doing like a
cyber forensics hype we would actually

80
00:07:23,860 --> 00:07:29,210
use this tool after mounting the drive
and we could just like for example

81
00:07:29,210 --> 00:07:37,360
acquired the MSG file is right here just
export that file to location or

82
00:07:37,360 --> 00:07:47,930
fossilized system you pop it open he
could create a disk image again

83
00:07:47,930 --> 00:07:53,180
selecting that image to drive you want
and then your damaged image destination

84
00:07:53,180 --> 00:07:58,860
so you can choose different formats
those times you just need to use the

85
00:07:58,860 --> 00:08:04,520
wrong because a lot of tools out there
can do with robberies another common one

86
00:08:04,520 --> 00:08:09,599
day you'll see is this

87
00:08:09,599 --> 00:08:14,659
0 on which is used by in case it
actually does a lot more metadata and

88
00:08:14,659 --> 00:08:17,889
also does compression so your images a
little smaller but other tools sometimes

89
00:08:17,889 --> 00:08:20,560
don't know how to deal with that if
you're using like open source told the

90
00:08:20,560 --> 00:08:22,740
night

91
00:08:22,740 --> 00:08:32,010
that basically you can also add that to
the image which case number is just take

92
00:08:32,010 --> 00:08:59,480
the imaging taking a full license to
drive can take a couple hours and then

93
00:08:59,480 --> 00:09:03,490
we get over to memory acquisition you
can have another idea where you can get

94
00:09:03,490 --> 00:09:07,170
there will usually just can't take a
full never done which usually isn't a

95
00:09:07,170 --> 00:09:11,050
problem but what's happenin courses
memory in it or not a member you have on

96
00:09:11,050 --> 00:09:14,890
your system is getting bigger and bigger
so before like four gigs memory opposed

97
00:09:14,890 --> 00:09:24,370
peace k to 8 thats bet 16 he doing 6402
820 830 become a problem so another

98
00:09:24,370 --> 00:09:27,870
option they could have on your point
memories you can do live in a house you

99
00:09:27,870 --> 00:09:33,329
have a client on the endpoint and so
eager for example is Google's rapid

100
00:09:33,329 --> 00:09:39,250
response which exit to play out talking
points and you can actually create it's

101
00:09:39,250 --> 00:09:43,220
a pretty useful tool open source has
also tied in

102
00:09:43,220 --> 00:09:49,800
recall which is a another memory
analysis tool that was split off of

103
00:09:49,800 --> 00:09:55,290
hostility you could also use red line
collector red line is the tool made by

104
00:09:55,290 --> 00:10:01,390
mandiant it very easily you can parse
and then have it analyzed your memory

105
00:10:01,390 --> 00:10:05,560
image and can give you some results for
a quick back they can also make a red

106
00:10:05,560 --> 00:10:09,329
line collector which is pretty
interesting as you can collect from the

107
00:10:09,329 --> 00:10:19,680
machine now laid in memory artifacts
that you want to do this and so it

108
00:10:19,680 --> 00:10:23,610
there's a lot to live up there is a dump
it being one of them FTK imager again we

109
00:10:23,610 --> 00:10:29,320
can actually use the same one to take it
mentions red line using a collector and

110
00:10:29,320 --> 00:10:34,500
volatility and recall can both use in
the win P man is a very common tool to

111
00:10:34,500 --> 00:10:38,459
Michael call it so you have a lot of
options in your arsenal

112
00:10:38,459 --> 00:10:42,270
one problem with like dump it though
it's very common one but you can't using

113
00:10:42,270 --> 00:10:46,050
scripting because it actually asked for
a prophetess you run it so very

114
00:10:46,050 --> 00:10:50,649
simplistic tool lets you run it just
dump them in the same directory but its

115
00:10:50,649 --> 00:10:59,790
can expect you to run it and then click
Yes to take a little look at those tools

116
00:10:59,790 --> 00:11:10,240
after to do more shenanigans

117
00:11:10,240 --> 00:11:34,529
back in the jury in either just to file
and capture memory and dump it very

118
00:11:34,529 --> 00:11:40,790
simple yes I'm starts require usually
acquired memories pretty quick to fix a

119
00:11:40,790 --> 00:11:52,000
couple of minutes however the red line
everything's going around I'm hoping I

120
00:11:52,000 --> 00:12:00,970
can see how to stop these collectors
that you can make so if we go into one

121
00:12:00,970 --> 00:12:05,370
of these students standard so far

122
00:12:05,370 --> 00:12:10,570
off the bat you can just click this
option to acquire full memory image and

123
00:12:10,570 --> 00:12:16,610
also grass and other artifacts but few
actually click the script you gonna have

124
00:12:16,610 --> 00:12:21,440
a whole bunch of options that you can go
after by default the strings there's

125
00:12:21,440 --> 00:12:25,450
always going to be left unchecked so
it's a good thing to grab but it will

126
00:12:25,450 --> 00:12:31,240
slow down when he do acquisition but
pretty useful after the fact and then

127
00:12:31,240 --> 00:12:36,190
you'll also see in the same collector we
can to disk system network a few other

128
00:12:36,190 --> 00:12:44,790
things so we could add these if he
wanted to and to our collector

129
00:12:44,790 --> 00:12:54,480
made when you get done you basically get
this directory of scripts you and all

130
00:12:54,480 --> 00:12:59,520
you have to do is run the red line on a
bat and then it'll kick off and do

131
00:12:59,520 --> 00:13:03,540
everything that you put in the collector
so pretty useful if you just want can

132
00:13:03,540 --> 00:13:08,070
somebody a thumb drive in town to play
in the machine run the script and choir

133
00:13:08,070 --> 00:13:32,590
everything that you need to do your best
hunting

134
00:13:32,590 --> 00:13:39,880
structure structure I'm sorry
corporations here assets are going to

135
00:13:39,880 --> 00:13:43,200
get our own place probably not gonna
have physical access to go into it and

136
00:13:43,200 --> 00:13:49,210
get it so one poor man's tool you can
use the TPS exact in Windows share and

137
00:13:49,210 --> 00:13:56,930
be here from vs exact really useful tool
allows you to basically either run a

138
00:13:56,930 --> 00:14:01,300
remote command on a windows box or you
could log into it with like a command

139
00:14:01,300 --> 00:14:09,330
shell and so one option you can do is
using admin propped on your system you

140
00:14:09,330 --> 00:14:14,900
can run pas exact and then I'm going to
copy copy of the script of the machine

141
00:14:14,900 --> 00:14:19,550
then you could run his exact for like
the red line collector no collective

142
00:14:19,550 --> 00:14:23,970
memory everything else do you need and
then you can text copied off their you

143
00:14:23,970 --> 00:14:27,660
are going to make a little bit of noise
on the host machine but for you to be

144
00:14:27,660 --> 00:14:31,200
worth at least you get instantly copy a
number that you can start working with

145
00:14:31,200 --> 00:14:36,610
you can also use didi and that cat they
both imported when does your more

146
00:14:36,610 --> 00:14:40,960
familiar with that you can do that as
well and then if you have bags of money

147
00:14:40,960 --> 00:14:46,050
you can go with that response which is
you can also acquire memory has actually

148
00:14:46,050 --> 00:14:51,900
kinda neat because when you connect to a
machine with never stops when you texted

149
00:14:51,900 --> 00:14:56,650
the memory actually map to your computer
and I'll have a little like you go to

150
00:14:56,650 --> 00:15:02,320
the G Drive pop it open in right there's
remember if I just copy paste it makes

151
00:15:02,320 --> 00:15:03,700
it really easy to use

152
00:15:03,700 --> 00:15:08,260
also nice thing about after spots is got
a giant API that you can run around with

153
00:15:08,260 --> 00:15:16,180
a lot of your collection and anger rapid
response as well you can actually use it

154
00:15:16,180 --> 00:15:17,060
if you're gonna do

155
00:15:17,060 --> 00:15:21,140
member analysis or if you're just going
to pull copy and then were you can do

156
00:15:21,140 --> 00:15:27,250
that so we got an image

157
00:15:27,250 --> 00:15:29,320
ask a player he will begin

158
00:15:29,320 --> 00:15:37,830
so around for evil orson indications of
something that's not good look at a

159
00:15:37,830 --> 00:15:39,570
couple artifacts of interests

160
00:15:39,570 --> 00:15:49,000
process shenanigans and so the first one
that we can kind of look at is gonna be

161
00:15:49,000 --> 00:15:55,260
users user assist is going to be within
the context of the user that was logged

162
00:15:55,260 --> 00:16:00,390
in at the time and what's nice about it
is windows keeps track of all the

163
00:16:00,390 --> 00:16:04,680
programs that you run and how many times
you ran it it does this can populate

164
00:16:04,680 --> 00:16:09,580
things like frequently used applications
are you start clicks darkness as you

165
00:16:09,580 --> 00:16:14,830
know it's doing that out of this
registry hybrids keeping that social

166
00:16:14,830 --> 00:16:20,550
program is executed from the context
then it'll be recorded there is actually

167
00:16:20,550 --> 00:16:24,790
in rap 13 encoded can't just open up to
register early register it and take a

168
00:16:24,790 --> 00:16:29,800
look at it but I'll give you the name is
Jason the runtime a number times

169
00:16:29,800 --> 00:16:35,560
executed so we can hear it on the top
easy just the registry agency accounts

170
00:16:35,560 --> 00:16:40,840
like gobbledygook in the red and then
they're soft has a talk called users

171
00:16:40,840 --> 00:16:45,940
list which you can jump into and we'll
show you kinda for example the command

172
00:16:45,940 --> 00:16:49,880
prompt was around three times their
power shows ran seven times and if

173
00:16:49,880 --> 00:16:53,060
you're working environment where most
users don't use PowerShell or the

174
00:16:53,060 --> 00:16:55,850
command prompt that could be an
indication that's the weird you might

175
00:16:55,850 --> 00:17:00,140
wanna actually jump in there and get a
copy of memory and then dumped out

176
00:17:00,140 --> 00:17:14,040
another good one is the cat or a compact
cash and other registry hive this one is

177
00:17:14,040 --> 00:17:18,439
for the application compatibility shame
cash stored in the Windows registry of

178
00:17:18,439 --> 00:17:24,390
course I had it for the system

179
00:17:24,390 --> 00:17:30,660
it's going to contain you know you'll
ask usual time for path filename one bad

180
00:17:30,660 --> 00:17:35,420
thing about it is is that it doesn't
write to disk until a full shutdown but

181
00:17:35,420 --> 00:17:39,870
it's another place where you're going to
have at least one execution every time

182
00:17:39,870 --> 00:17:44,220
you run something because Windows is
going to see if it needs to a playa

183
00:17:44,220 --> 00:17:49,110
shims to an application so it's time
it's run it's added into this registry

184
00:17:49,110 --> 00:17:55,290
really good one piece and you can parse
that out using the same cash plugin by

185
00:17:55,290 --> 00:17:58,080
Red River CNC

186
00:17:58,080 --> 00:18:04,080
like Python for example is Ron and
Snagit and I know it's negative how many

187
00:18:04,080 --> 00:18:14,950
documents too many another spot that's
out this part of Microsoft application

188
00:18:14,950 --> 00:18:19,840
experience and compatibility service is
the recent spike Ash Wednesday to get

189
00:18:19,840 --> 00:18:26,590
changed to the cash these two are also
now if it sees his reside on dis they're

190
00:18:26,590 --> 00:18:32,180
useful to snag that you're doing this
type of forensics and the reason why is

191
00:18:32,180 --> 00:18:37,940
it's a temporary spot for as a process
is being created so kinda like the app

192
00:18:37,940 --> 00:18:42,440
compatibility cash little briefly
touched down and I'll have information

193
00:18:42,440 --> 00:18:49,980
as to what was wrong on the modified
times of a file and what's really

194
00:18:49,980 --> 00:18:55,150
interesting is in the ATM cash which is
recent when you actually get a shower

195
00:18:55,150 --> 00:19:05,070
one hash these are temporary and they
tend to be run in there for a couple of

196
00:19:05,070 --> 00:19:11,779
weeks but there are some parcels out
there for it

197
00:19:11,779 --> 00:19:19,309
first one actually hardly in Carver has
RCA that exceed which comprises out for

198
00:19:19,309 --> 00:19:25,179
Windows seven boxes piled cash and then
Yogesh actually has a lot of research

199
00:19:25,179 --> 00:19:30,749
about this topic and some talks on line
he blows away that's amazing things with

200
00:19:30,749 --> 00:19:36,389
them but another location look for
applications that ran so when something

201
00:19:36,389 --> 00:19:40,239
crash sensor system or something is
going on here gonna try you're gonna

202
00:19:40,239 --> 00:19:46,489
want to try and find any executable that
ran at the time of course prefetch is

203
00:19:46,489 --> 00:19:51,349
very common region is used to speed up
application launching when you start up

204
00:19:51,349 --> 00:19:58,549
the machine one bad thing is I went 27
for example is automatically disabled by

205
00:19:58,549 --> 00:20:03,799
default but it will show you like the
last execution time and the name of the

206
00:20:03,799 --> 00:20:12,909
path with Windows 8 actually prenatal

207
00:20:12,909 --> 00:20:16,379
example that if you go into the sea when
does professor directory

208
00:20:16,379 --> 00:20:24,109
you can see all that you can parse out
and get the text like the execution by

209
00:20:24,109 --> 00:20:31,239
that time and another spot that
overlooks company if you have a a

210
00:20:31,239 --> 00:20:37,149
critical machine or server somewhere you
probably have the option finding out how

211
00:20:37,149 --> 00:20:40,749
much space heavy machinery how many logs
you wanna keep the audit process

212
00:20:40,749 --> 00:20:47,059
creation termination by default this is
turned off and windows but if you do

213
00:20:47,059 --> 00:20:50,539
turn it on it will show you every time
that process is created and terminated

214
00:20:50,539 --> 00:20:56,369
and just to give you an idea you can go
into your Local Group Policy Editor if

215
00:20:56,369 --> 00:21:03,149
you going to Windows settings settings
advanced auto policy figuration and

216
00:21:03,149 --> 00:21:09,339
within the system audit policies you can
enable these so the good thing is you

217
00:21:09,339 --> 00:21:13,989
can see process creation the bad thing
is you see it on a process creation

218
00:21:13,989 --> 00:21:20,070
terminations so this can very easily
fill up your loss source if you have a

219
00:21:20,070 --> 00:21:23,850
sense for example and you have entire
infrastructure

220
00:21:23,850 --> 00:21:29,789
work stations here since can cry time
stands right there and this is just for

221
00:21:29,789 --> 00:21:36,789
a second and you got it happen within a
minute multiple but it can be useful

222
00:21:36,789 --> 00:21:48,160
because now I got that shitty Banda Aceh
3 was executed so let's look into an

223
00:21:48,160 --> 00:21:55,039
arrogance so it was kinda way mel r my
height on the system is actually just by

224
00:21:55,039 --> 00:22:01,390
hiding in plain sight so this is man you
really need to know like your Windows

225
00:22:01,390 --> 00:22:04,890
environment and what applications should
be run it what processes should be

226
00:22:04,890 --> 00:22:12,690
running what parent process should be
common is gonna be a misspelling else s

227
00:22:12,690 --> 00:22:20,669
process than last but you might miss it
when you're going through an output and

228
00:22:20,669 --> 00:22:24,950
then having the same process name but
it's actually a different directory so

229
00:22:24,950 --> 00:22:30,390
it's launching out of the program 32
directory and set of it being somewhere

230
00:22:30,390 --> 00:22:35,179
else but should be and then of course
that an easy one spot is whenever you

231
00:22:35,179 --> 00:22:44,640
see applications running out of a user's
Internet or temp directory so so it's

232
00:22:44,640 --> 00:22:45,230
looking

233
00:22:45,230 --> 00:22:51,080
quick example so Stuxnet was very common
memory example it's free on the internet

234
00:22:51,080 --> 00:22:56,150
and the Alsace France son actually gets
duplicated

235
00:22:56,150 --> 00:23:01,230
actually a little bit of how they're
going to get to work but also as process

236
00:23:01,230 --> 00:23:04,640
your local security authentication
subsystem that's responsible for

237
00:23:04,640 --> 00:23:10,160
overseeing security policies I'm system
and it should be started by the win it

238
00:23:10,160 --> 00:23:47,370
process you should only see one else
that process which has a variety of

239
00:23:47,370 --> 00:24:01,040
tools especially for forensics

240
00:24:01,040 --> 00:24:17,280
demo so we're gonna kill it and we're
going to ps3 so we're looking at the

241
00:24:17,280 --> 00:24:22,850
marine engine and the first thing that
we're gonna do here after running a look

242
00:24:22,850 --> 00:24:42,330
at it and trying to spot some things
that are you already know that if we

243
00:24:42,330 --> 00:24:52,300
look for yeltsin has process we're gonna
see that there's three executions and if

244
00:24:52,300 --> 00:25:01,520
we look at this week notice that on the
left ear I got so this is gonna be the

245
00:25:01,520 --> 00:25:07,210
actual process did this is going to be
the parent idea that we had an Elsass

246
00:25:07,210 --> 00:25:12,050
process to be next to you by one parent
and another one being processed another

247
00:25:12,050 --> 00:25:24,150
if we take a look at this

248
00:25:24,150 --> 00:25:33,840
see that process 64 is actually the
Wenlock what's in it and I expression

249
00:25:33,840 --> 00:25:36,630
when login

250
00:25:36,630 --> 00:25:40,500
that we can see that they'll says
process legitimate was launched by

251
00:25:40,500 --> 00:26:03,740
parents about the other ones 102 now
looking at this output we can see that

252
00:26:03,740 --> 00:26:10,330
it was launched by the services that he
services some reason is now launching

253
00:26:10,330 --> 00:26:16,720
Elsass a good indication so one would
probably pull these processes on a

254
00:26:16,720 --> 00:26:22,120
memory using volatility and we can
submit those for further analysis to

255
00:26:22,120 --> 00:27:04,179
confirm their evil

256
00:27:04,179 --> 00:27:13,119
another thing that can happen is course
cooking cooking is an evil by its nature

257
00:27:13,119 --> 00:27:20,419
but it can be used for looking for a lot
of times when using like a Windows

258
00:27:20,419 --> 00:27:25,830
debugger its gonna hook into certain
function calls messages events within

259
00:27:25,830 --> 00:27:30,299
the operating system but so do she
loggers and rootkits like do the same

260
00:27:30,299 --> 00:27:34,480
thing and so using volatility have a
memory image you can actually go through

261
00:27:34,480 --> 00:27:39,450
using like a few hopes event hopes
message votes you can parse through them

262
00:27:39,450 --> 00:27:43,999
looking for things that might be
abnormal and then you can dig deeper

263
00:27:43,999 --> 00:27:51,389
into the processes that are calling
those in Jackson is a very common one is

264
00:27:51,389 --> 00:28:00,029
an injection is a little more easier to
fines when you're hunting for its use in

265
00:28:00,029 --> 00:28:03,889
about silly plugin against smell final
go through and find injector pieces of

266
00:28:03,889 --> 00:28:09,429
code and I'll find a way that it works
as it searches through memory looking

267
00:28:09,429 --> 00:28:15,860
for executable code that's not backfire
file so you have a process that launches

268
00:28:15,860 --> 00:28:19,649
and libraries that are loaded the
libraries are gonna be back to disk

269
00:28:19,649 --> 00:28:26,009
somewhere when you don't have that
that's not always bad but it can be an

270
00:28:26,009 --> 00:28:32,279
indication of bed and it also will be
marked as execute and it's not gonna be

271
00:28:32,279 --> 00:28:50,850
all zeros

272
00:28:50,850 --> 00:29:05,510
volatility in this one but I need some
help finance identifying those

273
00:29:05,510 --> 00:29:11,840
properties i talked about where their
it's not map to do not

274
00:29:11,840 --> 00:29:16,080
zeros and so there's a lot of processing
if you're familiar with the cease-fires

275
00:29:16,080 --> 00:29:22,860
actually inject itself into of riot like
a ton of legitimate processes so we're

276
00:29:22,860 --> 00:29:23,770
gonna look at it

277
00:29:23,770 --> 00:29:29,940
ALG for example and if you use now find
you can actually dumped all these

278
00:29:29,940 --> 00:29:34,620
sections of memory that it finds be
potentially and so if we go in that

279
00:29:34,620 --> 00:29:35,410
directory

280
00:29:35,410 --> 00:30:06,070
this down for example which we
identified

281
00:30:06,070 --> 00:30:11,800
to sex and the memory the first of all
we know right off the bat is more likely

282
00:30:11,800 --> 00:30:15,930
or worth our attention because there's
an easy header which is usually a

283
00:30:15,930 --> 00:30:22,670
portable execution so if we pull this
out of memory we can actually put that

284
00:30:22,670 --> 00:30:31,350
up to like an hour analyzer very common
one for examples like virustotal so if

285
00:30:31,350 --> 00:30:35,770
you upload to virustotal it'll do a
dynamic analysis of the code is smitten

286
00:30:35,770 --> 00:30:42,440
also look for any antivirus hits so when
I uploaded this section of memory and

287
00:30:42,440 --> 00:30:49,040
actually I say this but it actually got
hit with 3,750 to entice buyers picked

288
00:30:49,040 --> 00:30:54,850
it up so definitely and then to get a
little more detail that's just the

289
00:30:54,850 --> 00:31:00,200
cross-section you can also go into
relationships and we can find other

290
00:31:00,200 --> 00:31:06,970
hashes that this has also seen with
actors and so we can see here that was

291
00:31:06,970 --> 00:31:11,380
Zeus that's it so we now have an
indication reviews

292
00:31:11,380 --> 00:31:30,040
then

293
00:31:30,040 --> 00:31:35,120
which is what we actually seen Stuxnet
as when you launch actually legitimate

294
00:31:35,120 --> 00:31:39,040
process and then you put it in a
suspended state so delicious process

295
00:31:39,040 --> 00:31:46,210
will actually take out code of that
normally healthy process and it's going

296
00:31:46,210 --> 00:31:51,830
to insert its own delicious covered this
this is an easy one to find he's gonna

297
00:31:51,830 --> 00:31:57,340
find it there is no files back to
discount it but normally if you look at

298
00:31:57,340 --> 00:32:01,170
your normal tools the process is gonna
look legitimate like it'll be signed

299
00:32:01,170 --> 00:32:09,700
look so happy but is that so little time
our persistence anyone's Mallory is not

300
00:32:09,700 --> 00:32:14,210
a system has to be in certain locations
for it to keep me here about an hour

301
00:32:14,210 --> 00:32:20,410
that's only memory only that's great but
if you do reboot the machine that is

302
00:32:20,410 --> 00:32:23,010
going to be gone unless there's another
command-and-control server on the

303
00:32:23,010 --> 00:32:27,090
network that's going to reflect it when
it's done rebooting if not then you have

304
00:32:27,090 --> 00:32:29,639
to place in a location where it's going

305
00:32:29,639 --> 00:32:37,450
comment on a course at the autorads
locations can be a common file and

306
00:32:37,450 --> 00:32:42,749
registry locations are part of your sis
and then you're very familiar these and

307
00:32:42,749 --> 00:32:47,729
Swiss internal tools if you're on an
actual lie box you can run auto runs and

308
00:32:47,729 --> 00:32:52,169
you can actually see those or if you
have a copy of memory you can pull out

309
00:32:52,169 --> 00:32:57,349
all the locations that were loaded into
memory so it'll pull the registry in the

310
00:32:57,349 --> 00:33:03,490
file and a few other locations so for
example

311
00:33:03,490 --> 00:33:08,700
this is using the Sysinternals rounds to
all and you can see the registry entries

312
00:33:08,700 --> 00:33:20,590
and also the file location for some
comments targets this one looks all ok

313
00:33:20,590 --> 00:33:27,250
high-end services using the same tool
you can actually the same thing he

314
00:33:27,250 --> 00:33:31,080
volatility autorads plugin will pull us
as well

315
00:33:31,080 --> 00:33:42,700
and if using auto runs this internal
tool is running as well as the Service

316
00:33:42,700 --> 00:33:51,730
Canada and possibly a little actually
for Scheduled Tasks it's a common way to

317
00:33:51,730 --> 00:33:54,580
continuously run a program in Windows

318
00:33:54,580 --> 00:34:02,440
location but ileana rumbles and it's
also picked up the W my as one of the

319
00:34:02,440 --> 00:34:11,149
more scarier if you see in the talk by
William matter cloudy it's a great talk

320
00:34:11,149 --> 00:34:16,800
to give it to her because it really that
they did that you're gonna create your

321
00:34:16,800 --> 00:34:21,720
own class and WMI and if you have to
realize that you might sit great

322
00:34:21,720 --> 00:34:28,639
management or you can query system
information he did computer networking

323
00:34:28,639 --> 00:34:33,550
information and other tools and
applications can easily add their own

324
00:34:33,550 --> 00:34:38,339
classes to that a great example would be
down for example they have a provider

325
00:34:38,339 --> 00:34:42,879
that you can add at their classes and
then using that my provider you can

326
00:34:42,879 --> 00:34:50,349
actually changes Apple BIOS settings and
so one location is when you create a

327
00:34:50,349 --> 00:34:56,820
file from a job while you're having a
filter which essentially it's kinda like

328
00:34:56,820 --> 00:35:01,820
what's going to trigger this that could
be time that could be a listen there for

329
00:35:01,820 --> 00:35:06,440
some other than to happen clicking the
key and in the event consumers going to

330
00:35:06,440 --> 00:35:11,910
piece it actually has the payload it
usually it's Bibi script or power show

331
00:35:11,910 --> 00:35:16,910
that usually also skated so they're hard
to just scan around to try and find the

332
00:35:16,910 --> 00:35:20,960
music and then the filter to consumers
banner basically just put the two

333
00:35:20,960 --> 00:35:24,580
together and so on

334
00:35:24,580 --> 00:35:31,250
added if the system is rebooted or stay
restart W W my then that matters but

335
00:35:31,250 --> 00:35:37,940
next time and one way to look for it is
if you go into W my route subscription

336
00:35:37,940 --> 00:35:47,350
so here's Windows W my tool and and this
example I searched for the roots

337
00:35:47,350 --> 00:35:55,340
description and I actually only have one
legitimate have been here but if you see

338
00:35:55,340 --> 00:35:58,670
other ones that were not there worth the
time to research and would potentially

339
00:35:58,670 --> 00:36:07,160
leading to higher and then deal
hijacking is like the art of loading

340
00:36:07,160 --> 00:36:13,170
malicious liar is an application there's
a lot of ways that is done but the first

341
00:36:13,170 --> 00:36:16,770
thing it's gonna do when you launch a
process for example it's gonna check in

342
00:36:16,770 --> 00:36:21,610
memory to see if there it's not there
then it might look in the known details

343
00:36:21,610 --> 00:36:26,640
list and then it's going to start
looking in its own app directory so if

344
00:36:26,640 --> 00:36:34,030
you're in C program files cool app too
and you run it from there if you put a

345
00:36:34,030 --> 00:36:38,440
deal on it that applications it will
potentially if it's written poorly

346
00:36:38,440 --> 00:36:42,430
little sense that load that deal how i
met director insists on routes where

347
00:36:42,430 --> 00:36:46,500
they belong in the system and other
things you can look forward looking for

348
00:36:46,500 --> 00:36:54,030
road deal hours and we're directories so
some tools

349
00:36:54,030 --> 00:37:00,810
help automate your job and look around
for an hour and private need is to grab

350
00:37:00,810 --> 00:37:05,370
out there is a lot to Timeline if you
take a full disk image it'll actually

351
00:37:05,370 --> 00:37:13,720
parse using all the artifacts thinker
and Mark but it'll put them all into a

352
00:37:13,720 --> 00:37:18,500
nice timeline for you can export as like
a CSV and then you can add it into Excel

353
00:37:18,500 --> 00:37:23,220
for example you have to be careful
though because we do a full dis then

354
00:37:23,220 --> 00:37:30,060
you're gonna have probably a million two
million lines if you're running Excel 32

355
00:37:30,060 --> 00:37:36,730
bit you're probably going to run out of
memory it actually bad and so it won't

356
00:37:36,730 --> 00:37:41,330
be able to completely loading file so
you definitely have to get the 600 640

357
00:37:41,330 --> 00:37:48,750
it it is really a neat thing to watch I
use a lot when we're trying to hunt down

358
00:37:48,750 --> 00:37:54,050
if a user did something and then the
actions after that because for example

359
00:37:54,050 --> 00:37:59,260
they clicked a bad link so they open up
Outlook you'll see outlook being opened

360
00:37:59,260 --> 00:38:02,560
up in the timeline and that if they
click to document you access the

361
00:38:02,560 --> 00:38:10,530
document either hit disc or if it was
launched you'll see it and then you can

362
00:38:10,530 --> 00:38:15,660
see it just as you're going to the
timeline the disc from the empty file is

363
00:38:15,660 --> 00:38:20,830
parsed will show you where different
piece of malware may have dropped it

364
00:38:20,830 --> 00:38:26,740
gives you can for example on this one

365
00:38:26,740 --> 00:38:32,100
deleted registry entries the user SYSKEY
it also passed out the Flash cookies and

366
00:38:32,100 --> 00:38:43,560
the cabinet realizes it's a really cool
to play with both extractors another one

367
00:38:43,560 --> 00:38:49,340
it's very fast and quick to use one of
things that makes it fast as a

368
00:38:49,340 --> 00:38:52,200
multi-core where if you have more
quarters in your system

369
00:38:52,200 --> 00:38:58,869
don't parson image file faster but it'll
scan looking for your hours a piece

370
00:38:58,869 --> 00:39:00,580
demands credit cards

371
00:39:00,580 --> 00:39:06,950
the piles of them using it does as
histograms like if you're looking for a

372
00:39:06,950 --> 00:39:10,260
piece this would be a great place
because you can send his friends like

373
00:39:10,260 --> 00:39:15,550
morning going to hear you can see a
whole bunch going hits for using the

374
00:39:15,550 --> 00:39:21,029
host IP and then usually it's like a
domain is to make sure I P

375
00:39:21,029 --> 00:39:27,089
other useful like artifacts here is the
demand histograms show you all the means

376
00:39:27,089 --> 00:39:36,189
that it warms and also year ago actually
pull out Faceboook conversation just got

377
00:39:36,189 --> 00:39:41,150
a ton of players another useful pieces
that are actually pull out network

378
00:39:41,150 --> 00:39:50,750
packets and it'll build the pcap so you
can open up the pcap file on doing now

379
00:39:50,750 --> 00:39:52,670
thought

380
00:39:52,670 --> 00:39:59,440
are priced at times it's a free tool
from the volatility foundation that

381
00:39:59,440 --> 00:40:04,730
they're constantly adding new plugins
new parsers for as the operating systems

382
00:40:04,730 --> 00:40:08,539
Windows 10 is already got some

383
00:40:08,539 --> 00:40:15,099
incredible pride and also used pieces of
it as when I'm jumping like a deal out

384
00:40:15,099 --> 00:40:21,009
as a plugin called don't care deal
there's one for like crackdown dump

385
00:40:21,009 --> 00:40:28,130
files really useful especially like a
file that was something that was opened

386
00:40:28,130 --> 00:40:32,380
it might still be in memory but the
debate up you could actually do file

387
00:40:32,380 --> 00:40:38,529
scan using volatility and then you could
producers export that file to disk and

388
00:40:38,529 --> 00:40:45,739
analyzes the SIFT workstation extremely
powerful it's basically like Cali Linux

389
00:40:45,739 --> 00:40:51,479
blue team morale it's just jam packed
with every two parcels anything

390
00:40:51,479 --> 00:41:01,599
a lot of stand-alone parsers and also
tools by like a time and bulk extractor

391
00:41:01,599 --> 00:41:08,039
virustotal are common in our services if
you don't have something in house if

392
00:41:08,039 --> 00:41:12,219
your larger corporation you might be
using wildfire and now they have any

393
00:41:12,219 --> 00:41:18,369
practical autofocus just got any
favorable New Year dynamic analysis of

394
00:41:18,369 --> 00:41:21,439
any sense he tried check is this evil

395
00:41:21,439 --> 00:41:27,049
handed over to announce comeback but
also has a piece called autofocus which

396
00:41:27,049 --> 00:41:31,909
is kind of like how also selling back
all the customers data that they're

397
00:41:31,909 --> 00:41:35,759
sending to our prior and then you pay
subscription about 30,000 there's some

398
00:41:35,759 --> 00:41:40,059
ridiculous my money to get access to it
but they're really neat part is that

399
00:41:40,059 --> 00:41:45,539
it'll do analysis across the board so if
you're in like a utility industry that

400
00:41:45,539 --> 00:41:48,329
it will show you all the other utilities
and things that are hitting the network

401
00:41:48,329 --> 00:41:52,089
and so in the related like oh you got to
solve this malware that you sent to us

402
00:41:52,089 --> 00:41:56,600
that's actually part of this campaign
that's going on in this industry

403
00:41:56,600 --> 00:42:02,450
so it's a really cool tool to use and
fire I for many it also does some more

404
00:42:02,450 --> 00:42:10,960
functionality one thing I like about
Mourdock com is it gives you a nice to

405
00:42:10,960 --> 00:42:15,880
you and actually like screenshots of an
hour so it'll have a sandbox for XP and

406
00:42:15,880 --> 00:42:20,220
Windows seven so it runs an hour for
anything pops up and show it to you

407
00:42:20,220 --> 00:42:30,480
and then I was seized indications of
compromise if you find something that is

408
00:42:30,480 --> 00:42:35,400
evil and you can confirm it you can
actually use manuals open IOC frameworks

409
00:42:35,400 --> 00:42:42,000
basically X amount and you can define
exactly how to find this file again so

410
00:42:42,000 --> 00:42:49,670
if it's Andy 5 hashes they are looking
for he name of bad executable or other

411
00:42:49,670 --> 00:42:53,290
indications of it like it loads these
DLLs you can actually write that into a

412
00:42:53,290 --> 00:42:58,660
format and can use it to be scanned so
when you create an IRC need something

413
00:42:58,660 --> 00:43:03,310
like red line of volatility to scan your
environment also bigger tools

414
00:43:03,310 --> 00:43:06,260
corporations

415
00:43:06,260 --> 00:43:17,490
and northern outskirts make conversion
besides a conference in Detroit that's

416
00:43:17,490 --> 00:43:22,740
coming up it should be July

417
00:43:22,740 --> 00:43:30,860
around 14 15 and 16 that's a pretty fun
conference it's kind of we're trying to

418
00:43:30,860 --> 00:43:35,119
make it a blues centre the more the
defense analysis but bringing in both

419
00:43:35,119 --> 00:43:45,930
sides this guy over here by the yellow
blue that's right yeah it's a great

420
00:43:45,930 --> 00:43:49,110
conference if you're interested in
volunteering let me know we always need

421
00:43:49,110 --> 00:43:54,030
people to help and we have people that
do either are capture the flag program

422
00:43:54,030 --> 00:43:56,970
for helping with speakers

423
00:43:56,970 --> 00:43:58,960
thank you

