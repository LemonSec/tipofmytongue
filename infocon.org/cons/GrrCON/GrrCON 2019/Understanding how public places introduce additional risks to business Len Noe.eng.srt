1
00:00:00,030 --> 00:00:08,490
all right gherkin it's after lunch did

2
00:00:03,659 --> 00:00:11,490
you all eat you're all still awake no

3
00:00:08,490 --> 00:00:12,660
already we're falling asleep yeah well

4
00:00:11,490 --> 00:00:14,370
you got your work cut out for you man

5
00:00:12,660 --> 00:00:16,948
all right so here we go

6
00:00:14,370 --> 00:00:19,169
housekeeping first you are in ballroom

7
00:00:16,949 --> 00:00:21,689
see this is the anything track if that's

8
00:00:19,170 --> 00:00:23,880
not where you wanted to be how are you

9
00:00:21,689 --> 00:00:27,750
this confused a day and a half in Agora

10
00:00:23,880 --> 00:00:28,680
con I don't understand there was a lot

11
00:00:27,750 --> 00:00:31,230
of drinking lesson but they've had

12
00:00:28,680 --> 00:00:33,300
energy all day long I'm like I'm burned

13
00:00:31,230 --> 00:00:33,899
out and they're still going so that's

14
00:00:33,300 --> 00:00:36,360
all right

15
00:00:33,899 --> 00:00:39,120
very good you guys are impressive second

16
00:00:36,360 --> 00:00:41,670
do not block my fire exits

17
00:00:39,120 --> 00:00:43,709
I have very large people who will smelly

18
00:00:41,670 --> 00:00:45,809
remove you from that location if you

19
00:00:43,710 --> 00:00:47,760
stand in the doorways keep them clear

20
00:00:45,809 --> 00:00:50,489
it's that simple we got plenty of chairs

21
00:00:47,760 --> 00:00:52,829
for everybody come on in sit on down or

22
00:00:50,489 --> 00:00:55,739
don't just don't stand in my doorways

23
00:00:52,829 --> 00:00:58,020
last the cellphones I hate that I have

24
00:00:55,739 --> 00:00:59,968
to say this but I have to say it mute

25
00:00:58,020 --> 00:01:02,070
turn them off do something with them so

26
00:00:59,969 --> 00:01:05,070
that they do not make noise if you're

27
00:01:02,070 --> 00:01:06,540
gonna browse Facebook Twitter and you're

28
00:01:05,069 --> 00:01:08,548
looking at videos be aware they're gonna

29
00:01:06,540 --> 00:01:09,600
make noise so don't do it you should be

30
00:01:08,549 --> 00:01:11,780
paying attention because this is gonna

31
00:01:09,600 --> 00:01:15,000
be a killer presentation all right

32
00:01:11,780 --> 00:01:17,009
you're all with me all right there wait

33
00:01:15,000 --> 00:01:18,900
that's good all right so our next

34
00:01:17,009 --> 00:01:21,090
speaker is gonna talk to you all about

35
00:01:18,900 --> 00:01:25,430
those threats that we all face how many

36
00:01:21,090 --> 00:01:27,689
you travel for a living awesome

37
00:01:25,430 --> 00:01:29,400
ever think about all those public places

38
00:01:27,689 --> 00:01:31,500
we end up in and all the threats from a

39
00:01:29,400 --> 00:01:32,850
security perspective well our next

40
00:01:31,500 --> 00:01:37,009
speakers gonna talk to you all about it

41
00:01:32,850 --> 00:01:37,009
here you guys go it's Len

42
00:01:39,060 --> 00:01:44,470
what is up gherkin first of all just a

43
00:01:42,160 --> 00:01:46,600
quick thank you to the organizers and

44
00:01:44,470 --> 00:01:48,130
everything this is kind of like coming

45
00:01:46,600 --> 00:01:49,750
home but I wish y'all would have

46
00:01:48,130 --> 00:01:52,839
scheduled this when it was a little bit

47
00:01:49,750 --> 00:01:54,310
warmer see I originally I'm from West

48
00:01:52,840 --> 00:01:55,660
Side Detroit but I was one of the smart

49
00:01:54,310 --> 00:01:57,160
ones I moved out of here about six years

50
00:01:55,660 --> 00:01:59,950
ago and I live in Texas now

51
00:01:57,160 --> 00:02:01,960
so getting off the plane to 40 degrees

52
00:01:59,950 --> 00:02:03,220
y'all I'm sure still think this is like

53
00:02:01,960 --> 00:02:05,619
spring I kind of remember what it used

54
00:02:03,220 --> 00:02:08,228
to be like but it's a little cold once

55
00:02:05,620 --> 00:02:11,050
your blood thins so thank you very much

56
00:02:08,229 --> 00:02:12,520
for coming to today's session I am one

57
00:02:11,050 --> 00:02:15,730
of those people that travel very very

58
00:02:12,520 --> 00:02:17,080
extensively and what today's talk is all

59
00:02:15,730 --> 00:02:19,480
about is for the people that actually

60
00:02:17,080 --> 00:02:21,310
maybe like me maybe you're not an

61
00:02:19,480 --> 00:02:23,019
extensive traveler maybe you're a

62
00:02:21,310 --> 00:02:25,090
business traveler but you wind up in

63
00:02:23,020 --> 00:02:27,880
hotels conference centers even things

64
00:02:25,090 --> 00:02:28,810
like this you know I've got a couple of

65
00:02:27,880 --> 00:02:30,640
things that we're going to talk about

66
00:02:28,810 --> 00:02:32,140
but basically are you dealing with an

67
00:02:30,640 --> 00:02:35,859
air B&B or are you dealing with an air

68
00:02:32,140 --> 00:02:38,619
ciency so a little bit there's some

69
00:02:35,860 --> 00:02:39,910
information about me if you want to get

70
00:02:38,620 --> 00:02:41,980
with me after the fact go ahead

71
00:02:39,910 --> 00:02:43,959
I also for the in case you hadn't

72
00:02:41,980 --> 00:02:46,030
figured it out from my email I am one of

73
00:02:43,959 --> 00:02:47,830
the white hats that works for cyber-ark

74
00:02:46,030 --> 00:02:50,050
security software so if you want to have

75
00:02:47,830 --> 00:02:53,410
have any questions you can meet me over

76
00:02:50,050 --> 00:02:55,510
at the booth after the fact I'm a firm

77
00:02:53,410 --> 00:02:57,190
believer in the fact that why should you

78
00:02:55,510 --> 00:02:59,530
say something if somebody else has

79
00:02:57,190 --> 00:03:01,570
already said it better and I'm a very

80
00:02:59,530 --> 00:03:03,190
very firm believer in sunsoo in the art

81
00:03:01,570 --> 00:03:05,170
of war and the fact that most of the

82
00:03:03,190 --> 00:03:07,959
things that you read in that book are

83
00:03:05,170 --> 00:03:11,049
just as applicable to cyber warfare as

84
00:03:07,959 --> 00:03:12,850
it is to physical warfare and this line

85
00:03:11,050 --> 00:03:14,709
right here if the enemy leaves the door

86
00:03:12,850 --> 00:03:17,950
open you must Rush in that's pretty much

87
00:03:14,709 --> 00:03:19,890
every hackers basic mantra I mean

88
00:03:17,950 --> 00:03:23,380
realistically we are a bunch of really

89
00:03:19,890 --> 00:03:25,779
opportunistic people so as long as you

90
00:03:23,380 --> 00:03:27,970
keep that in mind it's a great starting

91
00:03:25,780 --> 00:03:32,470
point for any type of security and/or

92
00:03:27,970 --> 00:03:34,150
attack methodology so today these are

93
00:03:32,470 --> 00:03:35,500
basically the attacks we're going to

94
00:03:34,150 --> 00:03:37,870
look at and some of these you may have

95
00:03:35,500 --> 00:03:39,910
seen before but the whole point behind

96
00:03:37,870 --> 00:03:41,820
this talk is the fact that most of us

97
00:03:39,910 --> 00:03:44,769
are in some type of a corporate or

98
00:03:41,820 --> 00:03:46,540
environmental in our environment where

99
00:03:44,769 --> 00:03:49,209
we have a lot of additional security

100
00:03:46,540 --> 00:03:50,290
protocols in place we've got AI we've

101
00:03:49,209 --> 00:03:53,209
got

102
00:03:50,290 --> 00:03:54,590
IDs systems we have all this stuff that

103
00:03:53,209 --> 00:03:56,209
we have within our corporate

104
00:03:54,590 --> 00:03:58,069
environments that we all take for

105
00:03:56,209 --> 00:04:00,260
granted that the minute we step out of

106
00:03:58,069 --> 00:04:02,510
those doors and we go out into the wild

107
00:04:00,260 --> 00:04:05,750
we're in that wild that we always talk

108
00:04:02,510 --> 00:04:08,540
about you know we always hear about code

109
00:04:05,750 --> 00:04:10,880
being released to the wild you know and

110
00:04:08,540 --> 00:04:13,459
it's very some you know metaphoric but

111
00:04:10,880 --> 00:04:17,798
for the travelin user we're living in

112
00:04:13,459 --> 00:04:21,918
that environment between airports hotels

113
00:04:17,798 --> 00:04:23,659
coffee shops conference centers you know

114
00:04:21,918 --> 00:04:25,490
how many times are we looking into

115
00:04:23,660 --> 00:04:28,130
utilizing some type of a wheat-free

116
00:04:25,490 --> 00:04:31,160
Wi-Fi does everybody here have their own

117
00:04:28,130 --> 00:04:33,650
Wi-Fi access point do you have a hotspot

118
00:04:31,160 --> 00:04:36,800
if you're using those free Wi-Fi

119
00:04:33,650 --> 00:04:39,080
are you using a VPN with them you know

120
00:04:36,800 --> 00:04:41,600
or at some point do you get off the

121
00:04:39,080 --> 00:04:43,669
plane at 11:30 at night after being on a

122
00:04:41,600 --> 00:04:45,530
12-hour flight you just need to check

123
00:04:43,669 --> 00:04:49,219
your email and you just go you know what

124
00:04:45,530 --> 00:04:51,200
I'll be ok just this one time so we're

125
00:04:49,220 --> 00:04:53,450
gonna show how Mouse jacking this is a

126
00:04:51,200 --> 00:04:55,490
very old vulnerability but I see it more

127
00:04:53,450 --> 00:04:58,340
times than not where if I'm sitting in

128
00:04:55,490 --> 00:04:59,900
these hotels how many times have you

129
00:04:58,340 --> 00:05:01,520
walked out of your house if you have one

130
00:04:59,900 --> 00:05:02,810
of those vulnerable mice toggles that

131
00:05:01,520 --> 00:05:04,280
you just leave the mouse but it's

132
00:05:02,810 --> 00:05:06,979
plugged into the back of your laptop and

133
00:05:04,280 --> 00:05:08,570
you just forget that it's even there the

134
00:05:06,979 --> 00:05:13,430
mouse isn't the vulnerable piece of

135
00:05:08,570 --> 00:05:16,490
hardware the dongle is hotel keys are fi

136
00:05:13,430 --> 00:05:18,200
these I'm going to we're gonna sit and

137
00:05:16,490 --> 00:05:21,169
I'm gonna show you how we're gonna get

138
00:05:18,200 --> 00:05:23,030
is to clone an RFID card and that opens

139
00:05:21,169 --> 00:05:24,289
up the door for an evil made attack and

140
00:05:23,030 --> 00:05:26,960
if you're not familiar with that that's

141
00:05:24,289 --> 00:05:29,150
your physical hands-on if you got a

142
00:05:26,960 --> 00:05:30,950
Linux host or if you got a Windows or a

143
00:05:29,150 --> 00:05:32,599
Macintosh computer if I can get my hands

144
00:05:30,950 --> 00:05:36,039
physically on the box it's a simple key

145
00:05:32,600 --> 00:05:39,200
combination to boot it into a recovery

146
00:05:36,039 --> 00:05:42,380
QR jacking we haven't seen this much

147
00:05:39,200 --> 00:05:43,940
here in this states yet but I do a lot

148
00:05:42,380 --> 00:05:47,810
of international travel I mean I just

149
00:05:43,940 --> 00:05:50,539
got back from Chile last week but I'm

150
00:05:47,810 --> 00:05:53,419
seeing a lot more over in Europe where

151
00:05:50,539 --> 00:05:55,729
we're not seeing come the captive

152
00:05:53,419 --> 00:05:57,770
portals for hotels as much anymore on

153
00:05:55,729 --> 00:05:59,390
the little envelope where you get your

154
00:05:57,770 --> 00:06:01,820
key card they're giving you a QR code

155
00:05:59,390 --> 00:06:03,039
that's actually setting up the Wi-Fi for

156
00:06:01,820 --> 00:06:05,240
you

157
00:06:03,039 --> 00:06:06,740
trust me I have my own hotspot I'm not

158
00:06:05,240 --> 00:06:09,770
using it but this is the methodology

159
00:06:06,740 --> 00:06:11,599
that they're going to so that led me to

160
00:06:09,770 --> 00:06:14,539
start thinking about what happens if I

161
00:06:11,599 --> 00:06:15,860
decide to put out my own cards and to be

162
00:06:14,539 --> 00:06:18,289
honest I've actually dropped a few

163
00:06:15,860 --> 00:06:19,639
things and I'm wondering if anybody here

164
00:06:18,289 --> 00:06:24,229
at this conference is actually falling

165
00:06:19,639 --> 00:06:25,699
victim to me yeah what you're gonna see

166
00:06:24,229 --> 00:06:27,349
what I dropped around the con here and

167
00:06:25,699 --> 00:06:30,229
if when we get down into that attack but

168
00:06:27,349 --> 00:06:35,030
I've dropped QR codes that say Kirk on

169
00:06:30,229 --> 00:06:36,979
2019 Wi-Fi access I'm not doing anything

170
00:06:35,030 --> 00:06:39,679
bad all it does is just basically hit a

171
00:06:36,979 --> 00:06:41,479
hit counter but the realistic question

172
00:06:39,680 --> 00:06:43,130
is this is a security conference and I'm

173
00:06:41,479 --> 00:06:44,570
willing to bet I dropped 25 of these

174
00:06:43,130 --> 00:06:50,509
cards I'd be willing to bet I got two or

175
00:06:44,570 --> 00:06:52,849
three guaranteed pi our DP is a rather

176
00:06:50,509 --> 00:06:55,009
new script that's actually been I've

177
00:06:52,849 --> 00:06:57,979
discovered that works really really well

178
00:06:55,009 --> 00:07:00,740
especially if we combine that with that

179
00:06:57,979 --> 00:07:02,030
QR jacking and the Zed proxy because at

180
00:07:00,740 --> 00:07:03,770
that point I have the ability I can

181
00:07:02,030 --> 00:07:05,059
start modifying with your DNS

182
00:07:03,770 --> 00:07:06,979
information I can start playing with

183
00:07:05,060 --> 00:07:09,560
your ARP information and I can basically

184
00:07:06,979 --> 00:07:12,710
set up an RDP man-in-the-middle that I

185
00:07:09,560 --> 00:07:13,970
can stream record take over your RDP

186
00:07:12,710 --> 00:07:17,570
sessions and set up a full keyboard

187
00:07:13,970 --> 00:07:19,340
trapper I know this doesn't really seem

188
00:07:17,570 --> 00:07:21,650
like it would be much of a mobile style

189
00:07:19,340 --> 00:07:22,960
attack but when you like I said when you

190
00:07:21,650 --> 00:07:25,940
combine that to the fact that

191
00:07:22,960 --> 00:07:27,469
realistically in this room I would

192
00:07:25,940 --> 00:07:31,099
probably be willing to bet that at least

193
00:07:27,469 --> 00:07:32,449
somebody has had a call from work about

194
00:07:31,099 --> 00:07:34,070
some kind of a problem that they've had

195
00:07:32,449 --> 00:07:37,909
to log into work and address an issue

196
00:07:34,070 --> 00:07:39,590
from this conference all I have to be is

197
00:07:37,909 --> 00:07:41,389
in the right place at the right time and

198
00:07:39,590 --> 00:07:43,669
have you filtering through my equipment

199
00:07:41,389 --> 00:07:45,940
and I can actually steal every single

200
00:07:43,669 --> 00:07:50,990
thing within your RDP sessions and

201
00:07:45,940 --> 00:07:53,030
finally WH ID cactus I've already talked

202
00:07:50,990 --> 00:07:55,759
to something one person here at the show

203
00:07:53,030 --> 00:07:57,169
this this last couple of days who's

204
00:07:55,759 --> 00:07:59,180
heard of this but this is something

205
00:07:57,169 --> 00:08:00,500
that's still relatively new as far as an

206
00:07:59,180 --> 00:08:02,719
attack piece of attack hardware it's

207
00:08:00,500 --> 00:08:05,659
only with two and a half three years old

208
00:08:02,719 --> 00:08:08,120
total it's the same concept as your USB

209
00:08:05,659 --> 00:08:10,099
rubber Ducky's your bad USBs any type of

210
00:08:08,120 --> 00:08:11,240
command injection but the difference is

211
00:08:10,099 --> 00:08:13,610
is it's not going to deliver that

212
00:08:11,240 --> 00:08:16,160
payload the minute I plug it in it's

213
00:08:13,610 --> 00:08:18,050
gotten a built-in esp8266 web the

214
00:08:16,160 --> 00:08:22,640
element board with its own AP and its

215
00:08:18,050 --> 00:08:25,430
own web driven attack framework so now

216
00:08:22,640 --> 00:08:26,870
if I'm sitting somewhere I actually have

217
00:08:25,430 --> 00:08:29,090
the ability to plug something this

218
00:08:26,870 --> 00:08:31,490
device into the back of a kiosk system I

219
00:08:29,090 --> 00:08:34,579
can go sit over on the other side of the

220
00:08:31,490 --> 00:08:37,340
bar and I can access pretty much the

221
00:08:34,580 --> 00:08:38,630
whole hotel's network because they don't

222
00:08:37,340 --> 00:08:40,250
understand how these things are working

223
00:08:38,630 --> 00:08:41,659
and they're plugging them directly into

224
00:08:40,250 --> 00:08:43,610
the same internet that they're using for

225
00:08:41,659 --> 00:08:48,079
their point-of-sale service and the rest

226
00:08:43,610 --> 00:08:49,370
of their their network so let's go ahead

227
00:08:48,080 --> 00:08:51,980
and let's start taking a look at it

228
00:08:49,370 --> 00:08:54,710
mouth checking if you're not familiar

229
00:08:51,980 --> 00:08:57,410
with this particular term this is a

230
00:08:54,710 --> 00:09:01,550
series of attacks that's centered around

231
00:08:57,410 --> 00:09:06,290
though the Wi-Fi wireless mice keyboards

232
00:09:01,550 --> 00:09:08,599
and trackballs these are vulnerable at a

233
00:09:06,290 --> 00:09:11,180
hardware level the little wireless

234
00:09:08,600 --> 00:09:13,040
dongle that gets plugged in I want to

235
00:09:11,180 --> 00:09:15,500
say it's over 82 percent of those

236
00:09:13,040 --> 00:09:19,040
dongles are will transmit and receive in

237
00:09:15,500 --> 00:09:21,560
both secure and insecure modes out of

238
00:09:19,040 --> 00:09:23,060
the factory there's a secure channel

239
00:09:21,560 --> 00:09:25,310
between the device that comes paired

240
00:09:23,060 --> 00:09:27,319
with it but all you need is something

241
00:09:25,310 --> 00:09:30,530
like this down here in the corner this

242
00:09:27,320 --> 00:09:33,380
little guy down here yeah I know pretty

243
00:09:30,530 --> 00:09:36,589
cool presenter and smiles hidden it only

244
00:09:33,380 --> 00:09:39,590
the geeks have the cool toys but this is

245
00:09:36,590 --> 00:09:41,780
a $35 antenna that you can purchase off

246
00:09:39,590 --> 00:09:43,640
of Amazon that is originally intended

247
00:09:41,780 --> 00:09:46,850
for use with do-it-yourself drones and

248
00:09:43,640 --> 00:09:48,710
quad copters but the chip on it is able

249
00:09:46,850 --> 00:09:50,690
to be flashed so it will listen on the

250
00:09:48,710 --> 00:09:55,760
same frequency as those wireless mice

251
00:09:50,690 --> 00:09:58,430
and and trackballs and keyboards so what

252
00:09:55,760 --> 00:10:03,050
do these types of devices interface to

253
00:09:58,430 --> 00:10:03,969
the computer as HID so it's not going to

254
00:10:03,050 --> 00:10:07,069
stop it

255
00:10:03,970 --> 00:10:09,200
all I have to do at that point is skin

256
00:10:07,070 --> 00:10:10,790
for any of those vulnerable pieces of

257
00:10:09,200 --> 00:10:13,520
hardware and I can use a secondary

258
00:10:10,790 --> 00:10:15,349
script called jacket which allows me to

259
00:10:13,520 --> 00:10:19,400
take any existing USB rubber ducky

260
00:10:15,350 --> 00:10:21,980
script and weaponize that connection so

261
00:10:19,400 --> 00:10:23,750
this is the basic background on what the

262
00:10:21,980 --> 00:10:26,810
mouse hacking attack is but let's take

263
00:10:23,750 --> 00:10:29,550
it into the mobile threat

264
00:10:26,810 --> 00:10:31,380
excuse me like I said it's cold here

265
00:10:29,550 --> 00:10:32,520
I've been in Michigan for two days and

266
00:10:31,380 --> 00:10:35,610
I'm getting enough getting a cold

267
00:10:32,520 --> 00:10:36,930
already so let's take a look at the

268
00:10:35,610 --> 00:10:39,900
different scenario

269
00:10:36,930 --> 00:10:41,550
so we've already basically asked how

270
00:10:39,900 --> 00:10:43,770
many people here are actually out

271
00:10:41,550 --> 00:10:47,520
traveling and doing a lot of mobile type

272
00:10:43,770 --> 00:10:49,199
work so we're all smart in here we're

273
00:10:47,520 --> 00:10:51,930
all here at gaarkhan we're all security

274
00:10:49,200 --> 00:10:54,240
oriented so that means we're all going

275
00:10:51,930 --> 00:10:56,160
to be connecting back into our corporate

276
00:10:54,240 --> 00:11:01,200
environments through some type of a VPN

277
00:10:56,160 --> 00:11:03,449
right right yeah yeah well what about

278
00:11:01,200 --> 00:11:05,730
the fact that since I'm basically taking

279
00:11:03,450 --> 00:11:08,130
advantage of a human interface device if

280
00:11:05,730 --> 00:11:11,160
you're connected to your VPN sitting in

281
00:11:08,130 --> 00:11:13,950
the hotel lobby and you have one of

282
00:11:11,160 --> 00:11:16,260
these vulnerable devices I am VPN into

283
00:11:13,950 --> 00:11:17,940
your network I have the ability to take

284
00:11:16,260 --> 00:11:21,660
advantage of any of the current existing

285
00:11:17,940 --> 00:11:25,830
connections that you have so we're gonna

286
00:11:21,660 --> 00:11:28,650
walk through this now let's go back I

287
00:11:25,830 --> 00:11:31,200
like to set this up real quick I am a

288
00:11:28,650 --> 00:11:32,310
completely transparent presenter if you

289
00:11:31,200 --> 00:11:33,780
guys think I'm pulling the wool over

290
00:11:32,310 --> 00:11:35,189
your eyes or you're trying to think I'm

291
00:11:33,780 --> 00:11:39,199
trying to blow some sunshine up your

292
00:11:35,190 --> 00:11:41,940
butt call me out straight-up call me out

293
00:11:39,200 --> 00:11:44,880
all I want to point out here is you'll

294
00:11:41,940 --> 00:11:47,280
see I'm using a piece of software called

295
00:11:44,880 --> 00:11:49,920
virtual here it's just a USB share

296
00:11:47,280 --> 00:11:52,380
program because anybody here wants to

297
00:11:49,920 --> 00:11:54,150
tell me that USB pass-through for VMware

298
00:11:52,380 --> 00:11:55,140
is great we can take that offline and

299
00:11:54,150 --> 00:11:56,339
I'll have we can have the longest

300
00:11:55,140 --> 00:11:59,490
discussion you want as soon as this is

301
00:11:56,339 --> 00:12:01,320
over so all I'm doing is just pointing

302
00:11:59,490 --> 00:12:03,150
out and proving the fact that my

303
00:12:01,320 --> 00:12:05,550
vulnerable mouse you can see is actually

304
00:12:03,150 --> 00:12:07,770
the mouse Jack antenna is connected to

305
00:12:05,550 --> 00:12:09,479
my Kali host and if we look over here

306
00:12:07,770 --> 00:12:12,510
we'll see that my vulnerable mouse is

307
00:12:09,480 --> 00:12:14,520
actually in use by the Windows system so

308
00:12:12,510 --> 00:12:15,870
let's go ahead and let me let it run so

309
00:12:14,520 --> 00:12:17,250
the first thing we're going to do is I'm

310
00:12:15,870 --> 00:12:19,170
going to use a script that's actually

311
00:12:17,250 --> 00:12:21,390
going to launch a Mimi cat's attack

312
00:12:19,170 --> 00:12:23,040
based on a process hollowing

313
00:12:21,390 --> 00:12:24,510
so the first thing we're going to do is

314
00:12:23,040 --> 00:12:26,699
we're going to create some noise over

315
00:12:24,510 --> 00:12:29,730
there on the windows box and we're going

316
00:12:26,700 --> 00:12:31,500
to fire off the listener antenna so he's

317
00:12:29,730 --> 00:12:34,140
just over there working around doing his

318
00:12:31,500 --> 00:12:35,940
normal daily life and very quickly we're

319
00:12:34,140 --> 00:12:37,270
going to see the hardware address of

320
00:12:35,940 --> 00:12:39,720
that vulnerable transmitter

321
00:12:37,270 --> 00:12:43,060
up over on the callee side there it is

322
00:12:39,720 --> 00:12:46,120
so at this point all I'm gonna do is I'm

323
00:12:43,060 --> 00:12:47,770
going to use existing USB rubber ducky

324
00:12:46,120 --> 00:12:50,170
scripts and ones that I've created

325
00:12:47,770 --> 00:12:52,180
myself and we're gonna send the payload

326
00:12:50,170 --> 00:12:53,740
over through that Mouse port now

327
00:12:52,180 --> 00:12:55,989
normally the these windows would be

328
00:12:53,740 --> 00:12:57,940
completely obfuscated but I want you

329
00:12:55,990 --> 00:12:59,650
guys to see what the hell is going on so

330
00:12:57,940 --> 00:13:01,330
the first thing it does is it elevates

331
00:12:59,650 --> 00:13:03,189
itself into an administrative powershell

332
00:13:01,330 --> 00:13:05,980
and we're going to be doing a process

333
00:13:03,190 --> 00:13:08,500
hollowing attack so i'm gonna download

334
00:13:05,980 --> 00:13:10,240
some files and before anybody wants to

335
00:13:08,500 --> 00:13:11,650
go there yes this is another reason why

336
00:13:10,240 --> 00:13:14,560
you don't want to have administrative

337
00:13:11,650 --> 00:13:16,689
rights on your local endpoints because

338
00:13:14,560 --> 00:13:18,790
if you do it allows me to download a

339
00:13:16,690 --> 00:13:21,130
nice little tool called start suspended

340
00:13:18,790 --> 00:13:24,010
at which point i can start a calculator

341
00:13:21,130 --> 00:13:25,960
process in a suspended state then I

342
00:13:24,010 --> 00:13:29,110
download a DLL that I've compiled that

343
00:13:25,960 --> 00:13:31,810
has me me cats in it attach my DLL to

344
00:13:29,110 --> 00:13:34,000
the suspended calculator process and

345
00:13:31,810 --> 00:13:36,069
then release the entire thread to the

346
00:13:34,000 --> 00:13:38,140
processor the only thing your system

347
00:13:36,070 --> 00:13:41,560
your antivirus or inter anything is

348
00:13:38,140 --> 00:13:43,780
going to see is that Cal process and in

349
00:13:41,560 --> 00:13:45,310
return it's going to email all of the

350
00:13:43,780 --> 00:13:49,089
contents back to me and there's the

351
00:13:45,310 --> 00:13:50,979
complete me me cat's log dump this is

352
00:13:49,090 --> 00:13:52,480
just one example of something that can

353
00:13:50,980 --> 00:13:55,330
be done through the mouse jacking based

354
00:13:52,480 --> 00:13:57,910
attack think about what could happen if

355
00:13:55,330 --> 00:14:01,090
I decided that to do some type of an a

356
00:13:57,910 --> 00:14:04,839
full UDP scan against your entire

357
00:14:01,090 --> 00:14:07,270
network if you're remotely VPN din I can

358
00:14:04,840 --> 00:14:09,070
actually effectively target and map your

359
00:14:07,270 --> 00:14:11,910
entire corporate environment even though

360
00:14:09,070 --> 00:14:14,530
I'm sitting across the room from you I

361
00:14:11,910 --> 00:14:17,140
like to - I'm not gonna talk a lot about

362
00:14:14,530 --> 00:14:18,640
mitigations and remediations but the one

363
00:14:17,140 --> 00:14:21,160
thing I will say in regards to Mouse

364
00:14:18,640 --> 00:14:24,580
jacking attacks don't use vulnerable

365
00:14:21,160 --> 00:14:26,920
hardware you know and the truth is if

366
00:14:24,580 --> 00:14:29,050
you want to talk about Bluetooth this is

367
00:14:26,920 --> 00:14:30,699
a hacking con bluetooth has its own

368
00:14:29,050 --> 00:14:33,729
inherent issues they're not as

369
00:14:30,700 --> 00:14:35,200
necessarily as easy to weaponize but

370
00:14:33,730 --> 00:14:37,330
they have their issues - if you really

371
00:14:35,200 --> 00:14:38,920
want to be safe I'm not gonna say be

372
00:14:37,330 --> 00:14:41,730
like Mike but you could be like Len I

373
00:14:38,920 --> 00:14:43,839
use wired mice I use a wired keyboard

374
00:14:41,730 --> 00:14:45,670
there's no way you're gonna get to that

375
00:14:43,840 --> 00:14:48,310
unless you get an inline piece of

376
00:14:45,670 --> 00:14:49,759
hardware into my system don't make it

377
00:14:48,310 --> 00:14:52,669
easy for the bad guys

378
00:14:49,759 --> 00:14:54,499
like I said with my original quote if

379
00:14:52,669 --> 00:14:58,009
the enemy is gonna leave a door open and

380
00:14:54,499 --> 00:15:00,799
an attacker will rush through procs

381
00:14:58,009 --> 00:15:03,649
marks these are one of the most fun toys

382
00:15:00,799 --> 00:15:06,139
you can actually get so let's talk about

383
00:15:03,649 --> 00:15:09,410
what the scenario for the mobile attack

384
00:15:06,139 --> 00:15:10,910
is you've got something like this

385
00:15:09,410 --> 00:15:13,730
there's a probably a lot of very

386
00:15:10,910 --> 00:15:16,850
intelligent important people after all

387
00:15:13,730 --> 00:15:18,559
individual companies here nobody wants

388
00:15:16,850 --> 00:15:19,910
to carry their in their laptops and all

389
00:15:18,559 --> 00:15:22,309
of their stuff around all day if they

390
00:15:19,910 --> 00:15:23,779
don't have to all I have to do is a

391
00:15:22,309 --> 00:15:26,299
little quick social engineering to

392
00:15:23,779 --> 00:15:29,449
follow you with my proxmark in my pocket

393
00:15:26,299 --> 00:15:32,239
I can actually clone York potential

394
00:15:29,449 --> 00:15:34,339
potentially clone as long as it's RFID I

395
00:15:32,239 --> 00:15:36,769
can clone your key card for your hotel

396
00:15:34,339 --> 00:15:39,049
room wait for you to go in there drop

397
00:15:36,769 --> 00:15:39,829
off your computer so you can head out to

398
00:15:39,049 --> 00:15:41,989
go have drinks

399
00:15:39,829 --> 00:15:43,699
tear it up last night maybe you went to

400
00:15:41,989 --> 00:15:46,069
the hacker newlywed game you never know

401
00:15:43,699 --> 00:15:48,769
but you're leaving that information your

402
00:15:46,069 --> 00:15:51,738
data unguarded in your room with the

403
00:15:48,769 --> 00:15:53,149
thought that it's safe there's a lot of

404
00:15:51,739 --> 00:15:55,759
been a lot of talk about evil made

405
00:15:53,149 --> 00:15:58,579
attacks evil made attacks are the

406
00:15:55,759 --> 00:16:01,249
attacks that of physical access to your

407
00:15:58,579 --> 00:16:04,309
device without your knowledge happens in

408
00:16:01,249 --> 00:16:09,399
hotels all the time and it's this easy

409
00:16:04,309 --> 00:16:12,980
to do so I turn on my proxmark connect

410
00:16:09,399 --> 00:16:15,709
turn on the antenna and we're just gonna

411
00:16:12,980 --> 00:16:17,720
start looking around for anything that

412
00:16:15,709 --> 00:16:19,429
happens to be in range keep in mind I

413
00:16:17,720 --> 00:16:21,859
can't do this in real life because I'm

414
00:16:19,429 --> 00:16:23,869
not really down for the state run long

415
00:16:21,859 --> 00:16:26,389
term vacations anymore I'm getting a

416
00:16:23,869 --> 00:16:28,789
little bit old and it's just not really

417
00:16:26,389 --> 00:16:32,629
my thing but as you can see if we do a

418
00:16:28,789 --> 00:16:37,129
simple scan we see that we found one

419
00:16:32,629 --> 00:16:40,009
tag right here so with a very simple

420
00:16:37,129 --> 00:16:41,629
execution we can say give me start

421
00:16:40,009 --> 00:16:46,029
giving me the the publicly available

422
00:16:41,629 --> 00:16:50,480
access information so if I do a

423
00:16:46,029 --> 00:16:51,079
high-frequency scan turn around let it

424
00:16:50,480 --> 00:16:52,279
play out

425
00:16:51,079 --> 00:16:54,049
it's going to take it a couple of

426
00:16:52,279 --> 00:16:58,160
seconds but it's going to return all of

427
00:16:54,049 --> 00:17:00,410
this the the superfluous superfluous

428
00:16:58,160 --> 00:17:06,649
random data that is contained within

429
00:17:00,410 --> 00:17:09,230
those tags boom so right off the bat you

430
00:17:06,650 --> 00:17:11,300
notice that we have on each channel we

431
00:17:09,230 --> 00:17:14,000
are missing two key pieces of

432
00:17:11,300 --> 00:17:17,329
information without these I can't copy

433
00:17:14,000 --> 00:17:19,880
this I can't clone this so at this point

434
00:17:17,329 --> 00:17:23,180
all we have to do is change the query

435
00:17:19,880 --> 00:17:24,800
and go more of a targeted attack on both

436
00:17:23,180 --> 00:17:30,590
channels looking for those two specific

437
00:17:24,800 --> 00:17:32,899
keys on both bank a and B and it'll very

438
00:17:30,590 --> 00:17:35,149
quickly return those to me I just have

439
00:17:32,900 --> 00:17:38,810
to impersonate the receiver that would

440
00:17:35,150 --> 00:17:43,940
actually be requesting those so just

441
00:17:38,810 --> 00:17:53,750
like that its enumerated each one of the

442
00:17:43,940 --> 00:18:00,650
segment's gives it just a second and one

443
00:17:53,750 --> 00:18:03,260
more moment guys there it is so now

444
00:18:00,650 --> 00:18:05,720
we're able to gain the the two missing

445
00:18:03,260 --> 00:18:07,550
pieces of data at this point all we have

446
00:18:05,720 --> 00:18:10,610
to do is go back to the original scan

447
00:18:07,550 --> 00:18:13,669
and request for the you got the UUID of

448
00:18:10,610 --> 00:18:16,280
the actual transmission once we get that

449
00:18:13,670 --> 00:18:18,320
we can come over here sorry it's moving

450
00:18:16,280 --> 00:18:19,760
a little bit too fast and it'll actually

451
00:18:18,320 --> 00:18:22,040
turn around and take all of that

452
00:18:19,760 --> 00:18:24,020
information and rewrite it back down to

453
00:18:22,040 --> 00:18:28,430
any blank RFID card that I have

454
00:18:24,020 --> 00:18:30,290
available this one's a little bit hard

455
00:18:28,430 --> 00:18:32,150
to show but the moral behind trying to

456
00:18:30,290 --> 00:18:37,840
show this to you guys is the entire

457
00:18:32,150 --> 00:18:41,420
process takes less than four minutes sir

458
00:18:37,840 --> 00:18:43,429
the range is dependent upon the power of

459
00:18:41,420 --> 00:18:45,440
the antenna that you're using because I

460
00:18:43,430 --> 00:18:47,570
actually have a secondary pack with

461
00:18:45,440 --> 00:18:54,410
additional battery which will allow me

462
00:18:47,570 --> 00:18:57,139
to push a much higher DB antenna you can

463
00:18:54,410 --> 00:19:01,660
get away I've had no problems with 6

464
00:18:57,140 --> 00:19:01,660
feet 8 feet no problems

465
00:19:05,730 --> 00:19:16,389
wit by default without the higher

466
00:19:08,379 --> 00:19:17,610
powered antennas yeah you do have to

467
00:19:16,389 --> 00:19:20,769
maintain

468
00:19:17,610 --> 00:19:23,320
proximity depending on how long and how

469
00:19:20,769 --> 00:19:25,629
many bytes and how how many keys are in

470
00:19:23,320 --> 00:19:27,999
the cards you do have to be there for

471
00:19:25,629 --> 00:19:37,090
like this one here was approximately 15

472
00:19:27,999 --> 00:19:43,559
to 25 seconds yeah crowd long running

473
00:19:37,090 --> 00:19:43,559
crowded elevator very very easy so sir

474
00:19:46,830 --> 00:19:51,879
you would probably need to find some

475
00:19:49,330 --> 00:19:54,369
additional tool you could probably use a

476
00:19:51,879 --> 00:19:56,350
Raspberry Pi a tinker board something

477
00:19:54,369 --> 00:19:57,820
along those lines that you can run off

478
00:19:56,350 --> 00:19:59,230
of a battery pack but you would need

479
00:19:57,820 --> 00:20:03,360
something that you could try and set up

480
00:19:59,230 --> 00:20:03,360
some type of automation software with

481
00:20:03,539 --> 00:20:12,249
I'm sorry say that first party guy yeah

482
00:20:08,590 --> 00:20:13,990
essentially yeah you know if you it does

483
00:20:12,249 --> 00:20:15,820
become a little bit more difficult and

484
00:20:13,990 --> 00:20:18,610
that's why even with the scenario that I

485
00:20:15,820 --> 00:20:20,678
was explaining trying to find that one

486
00:20:18,610 --> 00:20:22,570
person that you can potentially social

487
00:20:20,679 --> 00:20:24,490
engineer to be standing close to them

488
00:20:22,570 --> 00:20:27,490
long enough to be able to read the data

489
00:20:24,490 --> 00:20:29,080
and get what you need it does take a

490
00:20:27,490 --> 00:20:30,789
little bit of social engineering it's

491
00:20:29,080 --> 00:20:32,350
not as simple as just walking by

492
00:20:30,789 --> 00:20:35,950
somebody in standing there for two

493
00:20:32,350 --> 00:20:38,379
minutes so this is definitely something

494
00:20:35,950 --> 00:20:40,690
to be concerned about there if you check

495
00:20:38,379 --> 00:20:42,639
out the hacker news and a lot of the

496
00:20:40,690 --> 00:20:44,200
security blogs you will see that evil

497
00:20:42,639 --> 00:20:46,269
made attacks have been on the rise

498
00:20:44,200 --> 00:20:47,590
especially in Europe and we're starting

499
00:20:46,269 --> 00:20:50,610
to see them more in some of the major

500
00:20:47,590 --> 00:20:50,610
cities here in the US

501
00:20:59,650 --> 00:21:08,120
yeah oh yeah you know I personally find

502
00:21:06,200 --> 00:21:10,100
conferences like this to be one of the

503
00:21:08,120 --> 00:21:13,250
greatest social engineering attack zones

504
00:21:10,100 --> 00:21:16,189
because everybody here wants to learn so

505
00:21:13,250 --> 00:21:18,950
if you're if you know that it's not hard

506
00:21:16,190 --> 00:21:20,840
to turn around and take that same desire

507
00:21:18,950 --> 00:21:23,030
to try and gain knowledge and use it as

508
00:21:20,840 --> 00:21:50,510
a manipulation tool to gain knowledge in

509
00:21:23,030 --> 00:21:52,700
an adverse way sure no it does not it

510
00:21:50,510 --> 00:21:55,460
RFID will not go through aluminum foil

511
00:21:52,700 --> 00:21:57,500
or lead or anything else the truth of

512
00:21:55,460 --> 00:22:00,890
the matter is is we are vulnerable every

513
00:21:57,500 --> 00:22:05,900
time we walk out of our house did did

514
00:22:00,890 --> 00:22:09,380
you have a question sir no okay so this

515
00:22:05,900 --> 00:22:12,410
is something that is a little bit on the

516
00:22:09,380 --> 00:22:14,210
new side like I said I do a lot of

517
00:22:12,410 --> 00:22:16,010
traveling in Eastern Europe I've

518
00:22:14,210 --> 00:22:18,740
traveled in the Middle East I've

519
00:22:16,010 --> 00:22:21,080
traveled to South America and we're

520
00:22:18,740 --> 00:22:23,570
seeing I've seen more and more in some

521
00:22:21,080 --> 00:22:26,000
of the European countries where they're

522
00:22:23,570 --> 00:22:28,220
no longer using captive portals they're

523
00:22:26,000 --> 00:22:30,500
basically handing you a QR code that

524
00:22:28,220 --> 00:22:32,060
will configure the Wi-Fi access putting

525
00:22:30,500 --> 00:22:34,190
the password for you and give you access

526
00:22:32,060 --> 00:22:37,070
to their systems they're printing them

527
00:22:34,190 --> 00:22:39,080
directly on the little piece of you know

528
00:22:37,070 --> 00:22:43,730
cardboard that they put your little

529
00:22:39,080 --> 00:22:47,000
plastic card key in well this to me is

530
00:22:43,730 --> 00:22:49,040
just bad idea waiting to happen because

531
00:22:47,000 --> 00:22:52,850
what happens if you're somebody like me

532
00:22:49,040 --> 00:22:57,230
and you drop 25 of these around the

533
00:22:52,850 --> 00:22:59,300
conference I've dropped 25 business

534
00:22:57,230 --> 00:23:01,130
cards that look like that around this

535
00:22:59,300 --> 00:23:04,129
conference over the course of the last

536
00:23:01,130 --> 00:23:06,400
day and a half this is not going to do

537
00:23:04,130 --> 00:23:08,860
anything but if you actually say yeah

538
00:23:06,400 --> 00:23:11,020
it's gonna hit one of my web servers and

539
00:23:08,860 --> 00:23:12,399
it's gonna just put a little hit counter

540
00:23:11,020 --> 00:23:14,379
out there that says you know somebody

541
00:23:12,400 --> 00:23:16,480
connected I'm not doing anything to you

542
00:23:14,380 --> 00:23:19,750
excited from just seeing whether or not

543
00:23:16,480 --> 00:23:23,230
you were smart enough not to click that

544
00:23:19,750 --> 00:23:25,210
link and to be honest I've been on calls

545
00:23:23,230 --> 00:23:26,590
all morning so I don't have the results

546
00:23:25,210 --> 00:23:28,090
but if you want to check back at the

547
00:23:26,590 --> 00:23:30,000
cyber-ark booth I will be checking the

548
00:23:28,090 --> 00:23:33,220
results as soon as I get off stage here

549
00:23:30,000 --> 00:23:35,400
but this is the same kind of thing so

550
00:23:33,220 --> 00:23:39,270
let's talk about our attack scenario

551
00:23:35,400 --> 00:23:42,010
what happens if we're somewhere hotel

552
00:23:39,270 --> 00:23:42,429
conference it's not hard take a look

553
00:23:42,010 --> 00:23:44,830
here

554
00:23:42,429 --> 00:23:47,590
anybody think does that look like the

555
00:23:44,830 --> 00:23:53,110
official logo kind of fits the same

556
00:23:47,590 --> 00:23:54,490
fonts same everything so I'd like to

557
00:23:53,110 --> 00:23:56,649
think that nobody clicked on these but

558
00:23:54,490 --> 00:23:58,659
like I said out of 25 I'm I'm betting on

559
00:23:56,650 --> 00:24:01,570
two or three I'm betting on two or three

560
00:23:58,659 --> 00:24:03,419
we'll see afterwards but what happens if

561
00:24:01,570 --> 00:24:06,399
you're in a situation where like

562
00:24:03,419 --> 00:24:08,110
hypothetically what if I instead of

563
00:24:06,400 --> 00:24:09,669
pointing you at just a standard access

564
00:24:08,110 --> 00:24:13,178
point what if I pointed you at an access

565
00:24:09,669 --> 00:24:14,830
point that was actually a zap proxy at

566
00:24:13,179 --> 00:24:16,270
that point I have the ability to filter

567
00:24:14,830 --> 00:24:20,260
it pretty much every single thing that's

568
00:24:16,270 --> 00:24:22,270
going through so just to give you a

569
00:24:20,260 --> 00:24:24,220
quick overview so we're gonna set it up

570
00:24:22,270 --> 00:24:26,980
here this is basically how you would set

571
00:24:24,220 --> 00:24:28,210
up the QRF portion of the setup I

572
00:24:26,980 --> 00:24:30,280
actually had to go look this up because

573
00:24:28,210 --> 00:24:33,390
I'm like first of all why would anybody

574
00:24:30,280 --> 00:24:36,730
want to set up Wi-Fi through a QR and

575
00:24:33,390 --> 00:24:40,870
then why would anybody be stupid enough

576
00:24:36,730 --> 00:24:42,700
to actually scan it so as we go through

577
00:24:40,870 --> 00:24:46,090
we're just gonna create a little access

578
00:24:42,700 --> 00:24:48,490
point and once you get this is just a

579
00:24:46,090 --> 00:24:49,928
straight-up JavaScript QR generator that

580
00:24:48,490 --> 00:24:51,130
is embedding all of the standard

581
00:24:49,929 --> 00:24:52,809
information that we would normally

582
00:24:51,130 --> 00:24:58,390
expect to be putting in to some type of

583
00:24:52,809 --> 00:25:01,389
an SSID base what Wi-Fi connection we

584
00:24:58,390 --> 00:25:10,299
can set it to W ap a to none give it a

585
00:25:01,390 --> 00:25:18,250
nice little password just show that we

586
00:25:10,299 --> 00:25:19,990
are connected get the properties make

587
00:25:18,250 --> 00:25:22,030
sure everything lines up I like I said I

588
00:25:19,990 --> 00:25:25,570
try to be as transparent with everything

589
00:25:22,030 --> 00:25:28,240
that I'm doing is possible anybody in

590
00:25:25,570 --> 00:25:29,408
the can do this most people are not

591
00:25:28,240 --> 00:25:31,720
going to show you what goes on behind

592
00:25:29,409 --> 00:25:33,400
under the hood my point is that I want

593
00:25:31,720 --> 00:25:36,280
you to leave here more educated than you

594
00:25:33,400 --> 00:25:39,010
were when you came in so at this point

595
00:25:36,280 --> 00:25:41,559
all we have to do is say generate and we

596
00:25:39,010 --> 00:25:46,629
have a QR code that when properly

597
00:25:41,559 --> 00:25:49,389
scanned will actually configure the

598
00:25:46,630 --> 00:25:52,210
entire Wi-Fi setup on a cell phone or a

599
00:25:49,390 --> 00:25:55,990
tablet for you and this is what we are

600
00:25:52,210 --> 00:26:00,370
seeing more and more as a preferred

601
00:25:55,990 --> 00:26:02,950
methodology coming out of Europe forgive

602
00:26:00,370 --> 00:26:05,469
me I didn't get it the best chance to

603
00:26:02,950 --> 00:26:06,880
edit my video so that did take it in

604
00:26:05,470 --> 00:26:09,970
just a second but you see it was that

605
00:26:06,880 --> 00:26:12,250
fast all they had to do was say yes and

606
00:26:09,970 --> 00:26:14,320
if you take for granted that whatever

607
00:26:12,250 --> 00:26:16,330
you're scanning and the same thing could

608
00:26:14,320 --> 00:26:19,120
be said in terms of captive portals as

609
00:26:16,330 --> 00:26:22,178
well utilizing things like the social

610
00:26:19,120 --> 00:26:23,918
engineering toolkit black eye you know a

611
00:26:22,179 --> 00:26:27,040
lot of the different social engineering

612
00:26:23,919 --> 00:26:29,919
scripts just because it looks like the

613
00:26:27,040 --> 00:26:31,090
Hilton or Marriott's captive portal are

614
00:26:29,919 --> 00:26:32,620
you sure that that's actually what

615
00:26:31,090 --> 00:26:34,480
you're logging into because once you

616
00:26:32,620 --> 00:26:37,330
connect to that you're potentially

617
00:26:34,480 --> 00:26:39,730
passing all of your data through it just

618
00:26:37,330 --> 00:26:43,149
keep that in mind so let's see what

619
00:26:39,730 --> 00:26:45,159
happens if in a bad situation you're now

620
00:26:43,149 --> 00:26:46,689
connected through somebody like me or

621
00:26:45,159 --> 00:26:49,899
you're connected through somebody with

622
00:26:46,690 --> 00:26:52,419
nefarious opportunities and means so at

623
00:26:49,899 --> 00:26:55,449
this point all we have to do is load up

624
00:26:52,419 --> 00:26:58,240
the OS app proxy and we can actually

625
00:26:55,450 --> 00:26:59,770
start digging in to every bit of

626
00:26:58,240 --> 00:27:03,070
transmission that goes through that

627
00:26:59,770 --> 00:27:05,139
connection take it a few minutes just to

628
00:27:03,070 --> 00:27:07,389
configure everything if you've never

629
00:27:05,140 --> 00:27:10,179
dealt with the zap proxy I highly

630
00:27:07,390 --> 00:27:13,330
recommend it it is very powerful and

631
00:27:10,179 --> 00:27:14,770
very very well documented and if you're

632
00:27:13,330 --> 00:27:16,439
trying to actually get a better

633
00:27:14,770 --> 00:27:18,879
understanding of the type of traffic

634
00:27:16,440 --> 00:27:20,320
vulnerabilities and types of things that

635
00:27:18,880 --> 00:27:22,090
are going through your network

636
00:27:20,320 --> 00:27:24,309
and what your users are potentially

637
00:27:22,090 --> 00:27:26,529
doing this is one of the most well

638
00:27:24,309 --> 00:27:29,918
documented and biggest communities out

639
00:27:26,529 --> 00:27:31,720
there so at this point we've gone ahead

640
00:27:29,919 --> 00:27:34,750
we've configured everything we've set it

641
00:27:31,720 --> 00:27:37,240
up in terms of our thresholds output

642
00:27:34,750 --> 00:27:38,649
directories I will be making all the

643
00:27:37,240 --> 00:27:40,630
slide decks available there's a link for

644
00:27:38,649 --> 00:27:41,949
download so if you it is running a

645
00:27:40,630 --> 00:27:44,529
little fast and you'd like to slow it

646
00:27:41,950 --> 00:27:46,259
down you will get the opportunity so at

647
00:27:44,529 --> 00:27:49,269
this point now we can come over here and

648
00:27:46,259 --> 00:27:51,820
actually connect as if we were the

649
00:27:49,269 --> 00:27:53,350
target user again I don't have a hotel

650
00:27:51,820 --> 00:27:55,960
or anything so I have to try and

651
00:27:53,350 --> 00:27:57,279
simulate a lot of this but if you guys

652
00:27:55,960 --> 00:27:59,620
would like to give me a hotel I'd be

653
00:27:57,279 --> 00:28:01,179
happy to take it from you so at this

654
00:27:59,620 --> 00:28:03,689
point once we start making the initial

655
00:28:01,179 --> 00:28:07,000
connections we can start tearing those

656
00:28:03,690 --> 00:28:09,549
transmissions completely apart we can

657
00:28:07,000 --> 00:28:12,629
see all of the active data active

658
00:28:09,549 --> 00:28:16,330
threads we can actually see any type of

659
00:28:12,629 --> 00:28:18,490
ActiveX controls and basically wire this

660
00:28:16,330 --> 00:28:22,120
thing down all the way into individual

661
00:28:18,490 --> 00:28:27,759
threads that are being utilized and hit

662
00:28:22,120 --> 00:28:29,739
from anywhere within the app so if you

663
00:28:27,759 --> 00:28:32,320
think about it from that aspect at this

664
00:28:29,740 --> 00:28:34,029
point we can then spider we can do

665
00:28:32,320 --> 00:28:38,460
additional recon and we can actually

666
00:28:34,029 --> 00:28:38,460
tunnel back in the opposite direction so

667
00:28:39,269 --> 00:28:45,610
be aware of what you're connecting to if

668
00:28:43,629 --> 00:28:49,149
you are in a situation where you do have

669
00:28:45,610 --> 00:28:52,629
to use Hotel provided Wi-Fi if you have

670
00:28:49,149 --> 00:28:54,070
to use conference based Wi-Fi make sure

671
00:28:52,629 --> 00:28:58,269
that you get yourself some type of a

672
00:28:54,070 --> 00:29:00,370
secondary VPN / I'm not trying to save

673
00:28:58,269 --> 00:29:01,990
one's better than the other I personally

674
00:29:00,370 --> 00:29:04,689
use private Internet access I've used

675
00:29:01,990 --> 00:29:06,220
shadow Sox in the past and if you really

676
00:29:04,690 --> 00:29:07,779
are in a position where you don't feel

677
00:29:06,220 --> 00:29:09,970
like you have the ability to set up a

678
00:29:07,779 --> 00:29:12,190
VPN there's a really really great tool

679
00:29:09,970 --> 00:29:13,649
out there if you go to github it's

680
00:29:12,190 --> 00:29:16,179
called Streisand

681
00:29:13,649 --> 00:29:18,908
yeah just like Barbra Streisand I didn't

682
00:29:16,179 --> 00:29:21,250
name the thing but it basically will set

683
00:29:18,909 --> 00:29:23,860
up a shadow Sox VPN for you within

684
00:29:21,250 --> 00:29:26,549
AWS that will run on the free tier so

685
00:29:23,860 --> 00:29:26,549
yeah

686
00:29:29,370 --> 00:29:34,629
it's gonna make it better than not I'm

687
00:29:32,440 --> 00:29:36,160
not if you can do it get your own

688
00:29:34,630 --> 00:29:40,540
connections but in those situations

689
00:29:36,160 --> 00:29:44,380
where you are stuck do everything that

690
00:29:40,540 --> 00:29:46,030
you can avoid if possible you know I'm

691
00:29:44,380 --> 00:29:47,620
not we all understand that if you're on

692
00:29:46,030 --> 00:29:49,420
a jobsite and you have something to do

693
00:29:47,620 --> 00:29:51,219
you may be in a position where you can't

694
00:29:49,420 --> 00:29:53,830
always do the safest most

695
00:29:51,220 --> 00:29:55,240
security-conscious processes just

696
00:29:53,830 --> 00:29:57,730
because you have to get your job done

697
00:29:55,240 --> 00:30:01,300
and you have deliverables don't make it

698
00:29:57,730 --> 00:30:03,010
easy be as be aware and conscious the

699
00:30:01,300 --> 00:30:05,200
fact that you are not necessarily in

700
00:30:03,010 --> 00:30:07,030
your environment this could be what's

701
00:30:05,200 --> 00:30:10,330
sitting on the other end of that you

702
00:30:07,030 --> 00:30:11,889
don't know just be aware and try and

703
00:30:10,330 --> 00:30:15,429
keep yourselves as safe as humanly

704
00:30:11,890 --> 00:30:17,530
possible I am NOT I'm the first person

705
00:30:15,430 --> 00:30:20,170
to admit it they send me all over the

706
00:30:17,530 --> 00:30:21,639
world I am put in situations where I am

707
00:30:20,170 --> 00:30:25,600
doing things that I would normally never

708
00:30:21,640 --> 00:30:28,270
do but in order to maintain me the

709
00:30:25,600 --> 00:30:30,129
completion of my deliverables on time we

710
00:30:28,270 --> 00:30:32,110
just have to be as conscious security

711
00:30:30,130 --> 00:30:33,640
conscious as possible and always be

712
00:30:32,110 --> 00:30:35,830
aware of the landscape and the fact that

713
00:30:33,640 --> 00:30:37,870
like I said in the beginning everybody

714
00:30:35,830 --> 00:30:39,429
talks about code being released to the

715
00:30:37,870 --> 00:30:42,699
wild the attacks are happening in the

716
00:30:39,430 --> 00:30:44,400
wild as mobile users we live in the wild

717
00:30:42,700 --> 00:30:52,090
never forget that

718
00:30:44,400 --> 00:30:53,980
so any questions on that one okay I know

719
00:30:52,090 --> 00:30:57,909
this one has people may have seen this

720
00:30:53,980 --> 00:31:01,120
but again this is one of my favorite

721
00:30:57,910 --> 00:31:02,590
attacks anybody who hasn't everybody

722
00:31:01,120 --> 00:31:07,689
here familiar with the responder based

723
00:31:02,590 --> 00:31:10,149
attack yes cool this is basically

724
00:31:07,690 --> 00:31:11,950
responder that when it's running on the

725
00:31:10,150 --> 00:31:14,890
actual bash Bunny itself this will

726
00:31:11,950 --> 00:31:18,520
actually take hashes out of locked

727
00:31:14,890 --> 00:31:21,100
windows systems the time to pull this

728
00:31:18,520 --> 00:31:23,530
off varies I've seen it take as long as

729
00:31:21,100 --> 00:31:25,810
about three or four minutes and I didn't

730
00:31:23,530 --> 00:31:28,450
even modify with the timestamps on this

731
00:31:25,810 --> 00:31:30,310
one for me to actually pull off this one

732
00:31:28,450 --> 00:31:32,560
I think it took less than 60 seconds

733
00:31:30,310 --> 00:31:35,280
granted it was a brand-new load of

734
00:31:32,560 --> 00:31:37,320
Windows it can vary

735
00:31:35,280 --> 00:31:40,950
but the concepts behind it are the same

736
00:31:37,320 --> 00:31:42,899
so again mobile attack scenario what

737
00:31:40,950 --> 00:31:44,610
happens when you are sitting there

738
00:31:42,900 --> 00:31:46,860
you're at the bar

739
00:31:44,610 --> 00:31:50,070
maybe you're with your buddies just got

740
00:31:46,860 --> 00:31:54,419
done with your conference how long would

741
00:31:50,070 --> 00:31:57,480
how reallya where are we when we're just

742
00:31:54,420 --> 00:31:58,980
sitting there with our people I've

743
00:31:57,480 --> 00:32:01,380
actually done this before

744
00:31:58,980 --> 00:32:03,300
granted it was to a friend of mine but

745
00:32:01,380 --> 00:32:04,560
I've pulled out a little dizzy spark and

746
00:32:03,300 --> 00:32:07,320
when we were actually sitting at a

747
00:32:04,560 --> 00:32:10,530
coffee shoot like a Starbucks waiting

748
00:32:07,320 --> 00:32:12,060
for our planes and I just slipped it

749
00:32:10,530 --> 00:32:14,940
over plugged in in a little dizzy spark

750
00:32:12,060 --> 00:32:17,370
that ran a little a little bit of a

751
00:32:14,940 --> 00:32:19,050
malicious code just randomly switched

752
00:32:17,370 --> 00:32:21,989
his left and my right mouse buttons

753
00:32:19,050 --> 00:32:23,760
according to some arbitrary algorithm

754
00:32:21,990 --> 00:32:26,160
just know just something to drive him

755
00:32:23,760 --> 00:32:27,480
crazy but what happens if you're not

756
00:32:26,160 --> 00:32:28,830
paying attention and somebody can

757
00:32:27,480 --> 00:32:32,820
actually slip one of these things into

758
00:32:28,830 --> 00:32:34,379
your system so again I'm not trying to

759
00:32:32,820 --> 00:32:37,470
pull the wool over anybody's eyes I'm

760
00:32:34,380 --> 00:32:40,530
not hiding anything again we have our

761
00:32:37,470 --> 00:32:42,330
attack box here we have a lock box here

762
00:32:40,530 --> 00:32:43,800
and because of the fact that this is a

763
00:32:42,330 --> 00:32:45,899
physical based attack I actually

764
00:32:43,800 --> 00:32:50,340
recorded the big ugly guy with the beard

765
00:32:45,900 --> 00:32:52,350
so as we can see we go in here we'll

766
00:32:50,340 --> 00:32:54,240
we'll open up the virtual here you'll

767
00:32:52,350 --> 00:32:57,209
see that the virtual mouse isn't still

768
00:32:54,240 --> 00:32:59,910
in use by the windows box I'm going to

769
00:32:57,210 --> 00:33:02,550
set my bash Bunny to the attack position

770
00:32:59,910 --> 00:33:04,290
one and I'm going to plug it in just

771
00:33:02,550 --> 00:33:06,840
like any other piece of hardware

772
00:33:04,290 --> 00:33:09,870
computer it does take a couple of

773
00:33:06,840 --> 00:33:14,070
seconds to post up and in the amount of

774
00:33:09,870 --> 00:33:17,850
time that it takes to go from green to

775
00:33:14,070 --> 00:33:20,939
yellow purple is post it's actually a

776
00:33:17,850 --> 00:33:26,219
running its own version of Debian Green

777
00:33:20,940 --> 00:33:30,420
Green gold solid hit I have the hashes

778
00:33:26,220 --> 00:33:33,690
that's all it took so what happened is

779
00:33:30,420 --> 00:33:35,370
that device actually interfaced to the

780
00:33:33,690 --> 00:33:39,000
windows host as a network interface

781
00:33:35,370 --> 00:33:42,270
device it's not coming in as a human HID

782
00:33:39,000 --> 00:33:44,700
it's also not coming in as an SMB as

783
00:33:42,270 --> 00:33:46,590
such it created a network bridge that

784
00:33:44,700 --> 00:33:48,280
was then able to run responder on the

785
00:33:46,590 --> 00:33:49,540
device itself

786
00:33:48,280 --> 00:33:52,060
and then wait for the system to actually

787
00:33:49,540 --> 00:33:55,090
reach out just as the part of its normal

788
00:33:52,060 --> 00:33:56,919
processes if I look on in the device

789
00:33:55,090 --> 00:33:59,560
itself we'll see that we have a wind

790
00:33:56,920 --> 00:34:03,430
victim here and if we open this up there

791
00:33:59,560 --> 00:34:06,100
is going to be all that's everything all

792
00:34:03,430 --> 00:34:08,800
the hashes that were pulled out just by

793
00:34:06,100 --> 00:34:12,880
the system running applications on it as

794
00:34:08,800 --> 00:34:14,470
system once we take that yes I am using

795
00:34:12,880 --> 00:34:15,970
a word list that I have done it without

796
00:34:14,469 --> 00:34:17,259
the word list if you'd like I have a

797
00:34:15,969 --> 00:34:20,678
video it took it about four and a half

798
00:34:17,260 --> 00:34:23,380
hours but using the word list I'm able

799
00:34:20,679 --> 00:34:26,860
to actually run a short script here just

800
00:34:23,380 --> 00:34:28,990
for the purposes of the presentation we

801
00:34:26,860 --> 00:34:32,140
come back with the actual password of

802
00:34:28,989 --> 00:34:35,889
cyber-ark one which we can then turn

803
00:34:32,139 --> 00:34:38,199
around open up this type in the password

804
00:34:35,889 --> 00:34:40,750
we were just able to crack cyber-ark one

805
00:34:38,199 --> 00:34:42,520
and we can actually gain access to the

806
00:34:40,750 --> 00:34:44,020
system so even locking your computer's

807
00:34:42,520 --> 00:34:52,840
doesn't necessarily keep you safe any

808
00:34:44,020 --> 00:34:54,699
more any questions so this is the kind

809
00:34:52,840 --> 00:34:57,190
of stuff that I've been trying to really

810
00:34:54,699 --> 00:34:59,049
focus on the fact these are all types of

811
00:34:57,190 --> 00:35:00,790
attacks that if we were inside of our

812
00:34:59,050 --> 00:35:03,340
corporate networks and we had all of our

813
00:35:00,790 --> 00:35:04,830
corporate security in play these things

814
00:35:03,340 --> 00:35:08,260
are not a problem anymore

815
00:35:04,830 --> 00:35:10,240
we've got enough mitigation strategies

816
00:35:08,260 --> 00:35:12,090
we have enough artificial intelligence

817
00:35:10,240 --> 00:35:15,180
we have enough anti-spyware anti-malware

818
00:35:12,090 --> 00:35:17,800
that we've shut this stuff down and

819
00:35:15,180 --> 00:35:21,160
finally we have two more attacks ago

820
00:35:17,800 --> 00:35:23,950
this one is new this one is a script

821
00:35:21,160 --> 00:35:26,170
called PI RDP now what this allows me to

822
00:35:23,950 --> 00:35:27,609
do especially if we build on the earlier

823
00:35:26,170 --> 00:35:29,650
attacks of being able to get you to

824
00:35:27,610 --> 00:35:32,740
start going through something that I

825
00:35:29,650 --> 00:35:36,280
control all of the accesses to DNS

826
00:35:32,740 --> 00:35:38,919
gateway everything else I can do sit

827
00:35:36,280 --> 00:35:41,140
there and listen for connections to an

828
00:35:38,920 --> 00:35:44,710
RDP host all I have to do at that point

829
00:35:41,140 --> 00:35:47,589
is just redo some simple redirects so

830
00:35:44,710 --> 00:35:49,390
let's take the canoe the scenario I gave

831
00:35:47,590 --> 00:35:53,890
you guys a few minutes ago I've dropped

832
00:35:49,390 --> 00:35:56,170
those little gherkin 20:19 Wi-Fi access

833
00:35:53,890 --> 00:35:58,029
cards what happens you sign up through

834
00:35:56,170 --> 00:36:00,100
one of these things and then you get the

835
00:35:58,030 --> 00:36:01,720
phone call from work that says hey we

836
00:36:00,100 --> 00:36:05,259
need you to log in

837
00:36:01,720 --> 00:36:09,259
all I have to do is get between you and

838
00:36:05,260 --> 00:36:12,740
the RDP host I can sit there and listen

839
00:36:09,260 --> 00:36:14,390
for port requests on 3389 if I run the

840
00:36:12,740 --> 00:36:17,598
Gateway it's not hard for me to find him

841
00:36:14,390 --> 00:36:19,970
at that point I do a DNS spoof modify

842
00:36:17,599 --> 00:36:22,309
the host name redirect you to one of my

843
00:36:19,970 --> 00:36:26,689
boxes and this is the kind of thing that

844
00:36:22,309 --> 00:36:28,880
can actually happen now this keep in

845
00:36:26,690 --> 00:36:32,839
mind the quick resolution to this run

846
00:36:28,880 --> 00:36:34,789
TLS if you're not running TLS over RDP

847
00:36:32,839 --> 00:36:39,140
you will be potentially susceptible to

848
00:36:34,789 --> 00:36:41,000
these kinds of attacks we go in I point

849
00:36:39,140 --> 00:36:42,288
this thing directly at my box even

850
00:36:41,000 --> 00:36:42,950
though you think you're pointing at

851
00:36:42,289 --> 00:36:45,710
yours

852
00:36:42,950 --> 00:36:48,109
and you see what's gonna happen over on

853
00:36:45,710 --> 00:36:49,940
my host the first thing it's going to do

854
00:36:48,109 --> 00:36:54,170
is we're going to actually modify and

855
00:36:49,940 --> 00:36:57,140
downgrade the the RDP version then we're

856
00:36:54,170 --> 00:37:00,589
going to clone the x11 511 certificate

857
00:36:57,140 --> 00:37:04,180
and I have a complete recordable

858
00:37:00,589 --> 00:37:07,210
and recorded copy of your entire session

859
00:37:04,180 --> 00:37:10,399
you go you go ahead and you log in I

860
00:37:07,210 --> 00:37:11,990
have a complete keyboard trap I have the

861
00:37:10,400 --> 00:37:15,230
ability to steal everything out of your

862
00:37:11,990 --> 00:37:17,029
clipboard I can even suspend your

863
00:37:15,230 --> 00:37:20,269
ability to control the session and I can

864
00:37:17,029 --> 00:37:27,200
take it over so as we can see here's

865
00:37:20,269 --> 00:37:30,470
every single keystroke now let's make it

866
00:37:27,200 --> 00:37:31,939
a little bit scarier so let's say you

867
00:37:30,470 --> 00:37:33,288
have this object here and we're just

868
00:37:31,940 --> 00:37:35,839
going to copy that and put it into

869
00:37:33,289 --> 00:37:42,829
clipboard I can steal all your clipboard

870
00:37:35,839 --> 00:37:47,569
data you know let's see even that's not

871
00:37:42,829 --> 00:37:50,990
really enough let's say I want an actual

872
00:37:47,569 --> 00:37:53,210
file off of your system he's going to go

873
00:37:50,990 --> 00:37:56,950
we're going to show that if we navigate

874
00:37:53,210 --> 00:38:00,710
down into the users pictures directory

875
00:37:56,950 --> 00:38:04,549
photos see I see pictures oh gosh yes

876
00:38:00,710 --> 00:38:06,710
I'm a Mac guy so all we have to do is

877
00:38:04,549 --> 00:38:08,869
pull this up here and you see we have

878
00:38:06,710 --> 00:38:11,390
the psycho looking cat why does

879
00:38:08,869 --> 00:38:14,000
everybody love psycho cats over here on

880
00:38:11,390 --> 00:38:15,080
my my attack box I now have access to

881
00:38:14,000 --> 00:38:17,180
your entire

882
00:38:15,080 --> 00:38:19,340
see drive or any mapdrives that you are

883
00:38:17,180 --> 00:38:21,109
currently connected to if you have

884
00:38:19,340 --> 00:38:23,510
mapdrives into your network I have

885
00:38:21,110 --> 00:38:25,640
access to those too all I have to do is

886
00:38:23,510 --> 00:38:27,800
right-click and I say download and save

887
00:38:25,640 --> 00:38:31,520
I can extricate data right off of your

888
00:38:27,800 --> 00:38:33,610
system just like that all the while

889
00:38:31,520 --> 00:38:38,870
you're not even aware of what I'm doing

890
00:38:33,610 --> 00:38:40,250
but let's take it one step more evil see

891
00:38:38,870 --> 00:38:45,049
that button right there that says take

892
00:38:40,250 --> 00:38:47,930
control so what happens if I decide I

893
00:38:45,050 --> 00:38:50,360
want to actually do something to you if

894
00:38:47,930 --> 00:38:52,279
I click this take control button I now

895
00:38:50,360 --> 00:38:54,380
I'm actually in control of your complete

896
00:38:52,280 --> 00:38:57,650
RDP session you just look like you're

897
00:38:54,380 --> 00:38:59,900
froze up and how and we all know what

898
00:38:57,650 --> 00:39:04,850
happened what to do when RDP freezes up

899
00:38:59,900 --> 00:39:06,980
right wait wait see if it's actually

900
00:39:04,850 --> 00:39:08,960
going to terminate the session and if it

901
00:39:06,980 --> 00:39:10,820
does we reconnect if it doesn't we wait

902
00:39:08,960 --> 00:39:13,370
once it gives us back control we

903
00:39:10,820 --> 00:39:16,430
continue with our job so at this point

904
00:39:13,370 --> 00:39:17,600
I've already done what I want to do so

905
00:39:16,430 --> 00:39:22,850
what happens when I decided to

906
00:39:17,600 --> 00:39:24,950
relinquish control so we're gonna go

907
00:39:22,850 --> 00:39:28,520
over here first and I'm actually gonna

908
00:39:24,950 --> 00:39:32,060
pump up and drop a calculator just

909
00:39:28,520 --> 00:39:35,270
something non-volatile 10 minutes 10

910
00:39:32,060 --> 00:39:38,810
seconds start on a calculator process

911
00:39:35,270 --> 00:39:41,240
nothing major but see what happens in my

912
00:39:38,810 --> 00:39:45,890
screen and see what happens in your

913
00:39:41,240 --> 00:39:47,899
screen so nothing happens in the minute

914
00:39:45,890 --> 00:39:50,950
I relinquish control everything will

915
00:39:47,900 --> 00:39:55,640
turn around and quickly catch back up

916
00:39:50,950 --> 00:39:57,620
then you're still none the wiser all the

917
00:39:55,640 --> 00:39:59,810
entire session is actually recorded in

918
00:39:57,620 --> 00:40:01,790
almost a pcap fashion that i can then

919
00:39:59,810 --> 00:40:04,070
turn around and replay at a later later

920
00:40:01,790 --> 00:40:07,900
time as well so anything I missed the

921
00:40:04,070 --> 00:40:12,000
first time I can come back for later and

922
00:40:07,900 --> 00:40:28,250
finally any questions on that

923
00:40:12,000 --> 00:40:31,740
sir anybody else okay

924
00:40:28,250 --> 00:40:33,300
this little device here is honestly like

925
00:40:31,740 --> 00:40:35,399
I said it's been around for about a year

926
00:40:33,300 --> 00:40:37,470
and a half two years this in my opinion

927
00:40:35,400 --> 00:40:39,840
is one of the most nasty little attack

928
00:40:37,470 --> 00:40:42,209
tools that you will ever play with they

929
00:40:39,840 --> 00:40:43,550
are extremely inexpensive there are only

930
00:40:42,210 --> 00:40:46,619
about 15 bucks

931
00:40:43,550 --> 00:40:50,550
these things are have the ability to do

932
00:40:46,619 --> 00:40:52,950
complete keystroke injection but like I

933
00:40:50,550 --> 00:40:57,330
said originally these come equipped with

934
00:40:52,950 --> 00:41:00,029
a complete esp8266 web development board

935
00:40:57,330 --> 00:41:01,560
on the back of it and there are multiple

936
00:41:00,030 --> 00:41:03,390
different attack frameworks that you can

937
00:41:01,560 --> 00:41:05,940
use with this one of them is called whi

938
00:41:03,390 --> 00:41:07,799
d-- ninja i'm a fir i actually and

939
00:41:05,940 --> 00:41:10,950
preferential to one called east blight

940
00:41:07,800 --> 00:41:12,599
and i've got the a lot of the

941
00:41:10,950 --> 00:41:13,890
third-party software compatible with it

942
00:41:12,599 --> 00:41:15,390
down there at the bottom you can check

943
00:41:13,890 --> 00:41:19,759
those out if you decide to download the

944
00:41:15,390 --> 00:41:21,740
slide deck so here's the difference

945
00:41:19,760 --> 00:41:23,990
everybody's seen a bash bunny

946
00:41:21,740 --> 00:41:27,868
everybody's seen a USB rubber ducky

947
00:41:23,990 --> 00:41:30,209
everybody's seen possibly a bad USB they

948
00:41:27,869 --> 00:41:32,730
all are basically around the exact same

949
00:41:30,210 --> 00:41:34,440
concept it's a command injection we're

950
00:41:32,730 --> 00:41:36,359
taking advantage of the fact that we're

951
00:41:34,440 --> 00:41:37,980
plugging into this computer the computer

952
00:41:36,359 --> 00:41:41,098
is interfacing as a human interface

953
00:41:37,980 --> 00:41:42,960
device but at the same time the issue

954
00:41:41,099 --> 00:41:46,140
and the drawback to a lot of these

955
00:41:42,960 --> 00:41:49,500
devices is the fact that once you plug

956
00:41:46,140 --> 00:41:52,770
them in the payload is an ish instantly

957
00:41:49,500 --> 00:41:56,040
delivered what if we're in a situation

958
00:41:52,770 --> 00:41:57,830
where I have a long-running exfiltration

959
00:41:56,040 --> 00:42:00,359
job what if I want to try and do an

960
00:41:57,830 --> 00:42:03,980
export of a sequel database table that's

961
00:42:00,359 --> 00:42:07,470
gonna take hours to complete well

962
00:42:03,980 --> 00:42:10,140
anybody here deal with anybody on the

963
00:42:07,470 --> 00:42:13,618
sea levels you know your seaso is your

964
00:42:10,140 --> 00:42:18,990
CFOs your CIF OS where do they typically

965
00:42:13,619 --> 00:42:22,589
want their offices app high or on the

966
00:42:18,990 --> 00:42:26,310
outside walls they want those corner

967
00:42:22,589 --> 00:42:29,520
offices they want to have the views of

968
00:42:26,310 --> 00:42:32,609
the parking lots what's another thing

969
00:42:29,520 --> 00:42:34,920
about executives typically do they they

970
00:42:32,609 --> 00:42:38,970
have a laptop but what else do they also

971
00:42:34,920 --> 00:42:42,450
have large screens and a desktop sitting

972
00:42:38,970 --> 00:42:45,390
underneath their desk all you need is

973
00:42:42,450 --> 00:42:48,359
the ability to get into that office long

974
00:42:45,390 --> 00:42:51,060
enough plug this thing in the back of

975
00:42:48,359 --> 00:42:57,210
the computer works also really well well

976
00:42:51,060 --> 00:43:00,230
is that what I heard son but once you

977
00:42:57,210 --> 00:43:03,359
plug this thing in then it's not about

978
00:43:00,230 --> 00:43:05,310
that short period of time where oh my

979
00:43:03,359 --> 00:43:07,049
god he's getting up he's going to he's

980
00:43:05,310 --> 00:43:08,609
got I got three minutes he's running to

981
00:43:07,050 --> 00:43:10,589
the bathroom let me plug this in and

982
00:43:08,609 --> 00:43:13,200
pray that my script finishes before he

983
00:43:10,589 --> 00:43:16,109
comes back so I can unplug it you plug

984
00:43:13,200 --> 00:43:18,509
this in you wait until after hours you

985
00:43:16,109 --> 00:43:21,210
drive up into the parking lot you

986
00:43:18,510 --> 00:43:23,250
connect to that hidden SSID and you have

987
00:43:21,210 --> 00:43:26,070
all the time in the world between the

988
00:43:23,250 --> 00:43:28,349
closing time and the next day that you

989
00:43:26,070 --> 00:43:30,510
can do whatever you want and nobody's

990
00:43:28,349 --> 00:43:33,270
even gonna know you're there this

991
00:43:30,510 --> 00:43:35,849
particular device also has the ability

992
00:43:33,270 --> 00:43:44,720
to do full screen captures mouse control

993
00:43:35,849 --> 00:43:46,859
and it's really inexpensive 15 bucks

994
00:43:44,720 --> 00:43:48,899
I've bought some of these things and

995
00:43:46,859 --> 00:43:51,869
gave them away as gifts before at some

996
00:43:48,900 --> 00:43:55,260
of my talks if you're not familiar with

997
00:43:51,869 --> 00:43:58,619
a site called tindy com great place to

998
00:43:55,260 --> 00:44:00,510
find really cool toys so this is

999
00:43:58,619 --> 00:44:01,440
basically the last attack I'm gonna be

1000
00:44:00,510 --> 00:44:05,490
showing you guys today

1001
00:44:01,440 --> 00:44:08,339
so again physical access needed have to

1002
00:44:05,490 --> 00:44:11,459
plug it in so again you get the ugly guy

1003
00:44:08,339 --> 00:44:13,680
in the beard up in the corner we plug it

1004
00:44:11,460 --> 00:44:15,470
in and basically it's hands off from

1005
00:44:13,680 --> 00:44:18,720
that point on you'll see according to my

1006
00:44:15,470 --> 00:44:21,029
USB share program the cactus is actually

1007
00:44:18,720 --> 00:44:23,669
in use by the target at this point

1008
00:44:21,030 --> 00:44:26,400
you'll see we have an SSID called

1009
00:44:23,670 --> 00:44:28,770
exploit once I connect to that this can

1010
00:44:26,400 --> 00:44:31,630
be connected to from a cell phone tablet

1011
00:44:28,770 --> 00:44:36,570
computer doesn't

1012
00:44:31,630 --> 00:44:39,510
we go ahead we type in 192 168 1.1 and

1013
00:44:36,570 --> 00:44:42,490
we actually have a complete framework

1014
00:44:39,510 --> 00:44:45,910
the ability to upload code

1015
00:44:42,490 --> 00:44:48,910
download code makes no difference at

1016
00:44:45,910 --> 00:44:51,129
this point it's up to me when that

1017
00:44:48,910 --> 00:44:54,490
attack happens it's not a matter of I

1018
00:44:51,130 --> 00:44:55,720
have a very sportive opportunity that I

1019
00:44:54,490 --> 00:44:57,368
have to do this and pray that it

1020
00:44:55,720 --> 00:45:00,009
finishes before somebody gets back and I

1021
00:44:57,369 --> 00:45:02,580
get caught so in this case we can use

1022
00:45:00,010 --> 00:45:04,690
the WHI d cactus to use the existing

1023
00:45:02,580 --> 00:45:08,040
connections to the Internet to reach out

1024
00:45:04,690 --> 00:45:11,800
to a to a payload server download

1025
00:45:08,040 --> 00:45:13,180
whatever payloads I want again this is

1026
00:45:11,800 --> 00:45:15,609
also why you would need endpoint

1027
00:45:13,180 --> 00:45:16,930
protection do not be an administrator on

1028
00:45:15,609 --> 00:45:20,020
your endpoints and definitely don't

1029
00:45:16,930 --> 00:45:22,839
leave them logged in because if you do

1030
00:45:20,020 --> 00:45:29,650
then I guarantee it's not hard for me to

1031
00:45:22,839 --> 00:45:31,390
find things like this so be aware be

1032
00:45:29,650 --> 00:45:33,700
aware of the fact that yes we are

1033
00:45:31,390 --> 00:45:35,830
traveling individuals we do wind up in

1034
00:45:33,700 --> 00:45:39,240
situations that we are probably going to

1035
00:45:35,830 --> 00:45:44,470
be a lot more vulnerable than our

1036
00:45:39,240 --> 00:45:46,569
in-house counterparts sir ah I've

1037
00:45:44,470 --> 00:45:53,348
actually gotten to know about 15 feet

1038
00:45:46,570 --> 00:45:57,430
through a wall to be honest I I don't

1039
00:45:53,349 --> 00:45:59,080
know I haven't tried but to keep it

1040
00:45:57,430 --> 00:46:01,390
within the small form-factor I mean the

1041
00:45:59,080 --> 00:46:06,310
thing is honestly the size of a standard

1042
00:46:01,390 --> 00:46:08,080
small USB dongle SMB if you I have one

1043
00:46:06,310 --> 00:46:09,670
of them actually go back over it in my

1044
00:46:08,080 --> 00:46:10,869
bag over at the cyber-ark booth if you'd

1045
00:46:09,670 --> 00:46:18,099
like you can stop by I'll be happy to

1046
00:46:10,869 --> 00:46:19,510
show it to you sir I've transmitted it

1047
00:46:18,099 --> 00:46:20,980
through glass I've transmitted it

1048
00:46:19,510 --> 00:46:23,349
through drywall and I've transmitted it

1049
00:46:20,980 --> 00:46:25,359
through brick brick actually is the one

1050
00:46:23,349 --> 00:46:27,640
that's actually caused me to lose the

1051
00:46:25,359 --> 00:46:29,259
most Decorah Dacian a signal but I was

1052
00:46:27,640 --> 00:46:31,410
still able to get it on the outside of a

1053
00:46:29,260 --> 00:46:31,410
building

1054
00:46:35,900 --> 00:46:41,130
that's one way you could put it yeah you

1055
00:46:39,270 --> 00:46:42,450
know it's not I think I think the

1056
00:46:41,130 --> 00:46:45,240
ability for it to be a remote access

1057
00:46:42,450 --> 00:46:47,700
Trojan is an after fact of the fact that

1058
00:46:45,240 --> 00:46:49,919
it was originally intended for command

1059
00:46:47,700 --> 00:46:51,210
and keystroke injection they just

1060
00:46:49,920 --> 00:46:52,560
basically started with that

1061
00:46:51,210 --> 00:46:54,450
functionality and they figured since

1062
00:46:52,560 --> 00:46:55,650
we're already there I really don't

1063
00:46:54,450 --> 00:46:57,779
consider it to be a very good wrap

1064
00:46:55,650 --> 00:47:00,390
because you don't have an actual by

1065
00:46:57,780 --> 00:47:03,900
streaming ability to see the screen you

1066
00:47:00,390 --> 00:47:06,600
can have it pop your screenshots and you

1067
00:47:03,900 --> 00:47:08,520
can maneuver that way but it is very

1068
00:47:06,600 --> 00:47:12,720
cumbersome to try and navigate in a live

1069
00:47:08,520 --> 00:47:16,980
mode a lot easier to just use it as your

1070
00:47:12,720 --> 00:47:19,109
gateway to be able to push a reverse TCP

1071
00:47:16,980 --> 00:47:20,700
shell or something along those lines

1072
00:47:19,110 --> 00:47:22,590
that would give you the available yeah

1073
00:47:20,700 --> 00:47:31,020
the ability to have a bi-directional

1074
00:47:22,590 --> 00:47:33,330
communication with the target we I do

1075
00:47:31,020 --> 00:47:36,390
have the ability you can send it wake up

1076
00:47:33,330 --> 00:47:40,470
signals yes as long as the it's set to

1077
00:47:36,390 --> 00:47:42,120
wake-on-lan yes if not there's some

1078
00:47:40,470 --> 00:47:45,779
things you can try but it's gonna be a

1079
00:47:42,120 --> 00:47:48,230
50/50 if it'll be successful any other

1080
00:47:45,780 --> 00:47:48,230
questions

1081
00:47:49,370 --> 00:47:59,160
well I the slides are available at that

1082
00:47:54,780 --> 00:48:01,470
URL with that particular password please

1083
00:47:59,160 --> 00:48:04,200
keep in mind those are tiny if you have

1084
00:48:01,470 --> 00:48:08,009
never used tiny dot CC it is a case

1085
00:48:04,200 --> 00:48:10,640
sensitive URL so the G and the C are

1086
00:48:08,010 --> 00:48:13,050
capitalized or else you will not find it

1087
00:48:10,640 --> 00:48:16,920
that's basically my presentation for

1088
00:48:13,050 --> 00:48:20,400
today there any other last questions yes

1089
00:48:16,920 --> 00:48:22,350
it okay this is let me finish it by

1090
00:48:20,400 --> 00:48:25,320
saying this if that was not a legitimate

1091
00:48:22,350 --> 00:48:25,920
URL I we are one of the sponsors here at

1092
00:48:25,320 --> 00:48:27,810
cyber-ark

1093
00:48:25,920 --> 00:48:29,790
and this would definitely be a very

1094
00:48:27,810 --> 00:48:32,460
career limiting move for me to try and

1095
00:48:29,790 --> 00:48:37,440
go after you guys here and I love my job

1096
00:48:32,460 --> 00:48:40,140
so anything else sir

1097
00:48:37,440 --> 00:48:44,849
this thing this is actually a logitech

1098
00:48:40,140 --> 00:48:46,499
spotlight and our new CFO used this at

1099
00:48:44,849 --> 00:48:48,779
our one of our sales conferences about

1100
00:48:46,499 --> 00:48:50,069
six months ago and as soon as he was

1101
00:48:48,779 --> 00:48:51,239
done talking it was like what is it

1102
00:48:50,069 --> 00:48:53,970
where do I buy it you can get him on

1103
00:48:51,239 --> 00:48:57,749
Amazon there are about 80 bucks anything

1104
00:48:53,970 --> 00:48:59,220
else it's Bluetooth so yes it's

1105
00:48:57,749 --> 00:49:02,700
inherently vulnerable but I haven't

1106
00:48:59,220 --> 00:49:04,589
bothered trying to break it yet all

1107
00:49:02,700 --> 00:49:07,649
right well I thank you guys very much I

1108
00:49:04,589 --> 00:49:09,950
really appreciate it and enjoy the rest

1109
00:49:07,650 --> 00:49:09,950
of the con

