1
00:00:00,000 --> 00:00:06,600
ready welcome to almost the final

2
00:00:02,639 --> 00:00:08,820
session of gherkin 2019 so I'm very

3
00:00:06,600 --> 00:00:11,790
happy to have you guys all here and you

4
00:00:08,820 --> 00:00:14,099
get to watch and listen to cat for just

5
00:00:11,790 --> 00:00:16,288
a little bit she's gonna tell you about

6
00:00:14,099 --> 00:00:17,220
the GRU for a little while I think

7
00:00:16,289 --> 00:00:21,359
that's who it is right

8
00:00:17,220 --> 00:00:22,740
GRU in chance like I was making a joke

9
00:00:21,359 --> 00:00:24,660
killer cuz I'm just kind of somebody

10
00:00:22,740 --> 00:00:27,778
nerdy I'm like it's not your real name

11
00:00:24,660 --> 00:00:30,269
I was thinking concatenate like cat self

12
00:00:27,779 --> 00:00:32,790
something another but that's nerve jaws

13
00:00:30,269 --> 00:00:36,199
so everybody please give a very warm

14
00:00:32,790 --> 00:00:36,200
welcome to castle

15
00:00:42,079 --> 00:00:48,780
okay yep so thank you all so much for

16
00:00:46,350 --> 00:00:51,300
coming I'm just that's kind of a call

17
00:00:48,780 --> 00:00:54,090
out this presentation happened because

18
00:00:51,300 --> 00:00:57,419
of several key individuals who know who

19
00:00:54,090 --> 00:01:00,230
they are and thank you thank you very

20
00:00:57,420 --> 00:01:03,120
much so whenever a person is presenting

21
00:01:00,230 --> 00:01:04,920
there is a ton of work that goes on on

22
00:01:03,120 --> 00:01:06,149
the backgrounds whether it is the dry

23
00:01:04,920 --> 00:01:09,659
runs where you making people suffer

24
00:01:06,150 --> 00:01:11,490
through your constant monologue or if

25
00:01:09,659 --> 00:01:13,020
it's through the actual like environment

26
00:01:11,490 --> 00:01:17,390
setup or just getting the code working

27
00:01:13,020 --> 00:01:20,340
in general so just we shall begin my

28
00:01:17,390 --> 00:01:24,450
name is Kat self I work at Target I'm a

29
00:01:20,340 --> 00:01:26,850
lead thread hunter formerly I was a red

30
00:01:24,450 --> 00:01:29,189
teamer and then I also my previous

31
00:01:26,850 --> 00:01:31,259
career prior to getting in InfoSec as as

32
00:01:29,189 --> 00:01:33,720
we discussed early on the keynotes we

33
00:01:31,259 --> 00:01:37,950
all have Smee enduring paths I was in

34
00:01:33,720 --> 00:01:39,780
military intelligence for a while the

35
00:01:37,950 --> 00:01:41,520
reason why I'm going to give this or why

36
00:01:39,780 --> 00:01:45,630
I wanted to give this talk so bad was I

37
00:01:41,520 --> 00:01:48,829
was actually at gherkin last year and I

38
00:01:45,630 --> 00:01:51,509
listened to a talk and the talk was

39
00:01:48,829 --> 00:01:54,750
basically by two people that were doing

40
00:01:51,509 --> 00:01:56,820
a red team and blue team and the blue

41
00:01:54,750 --> 00:01:59,100
team er was someone that was just

42
00:01:56,820 --> 00:02:02,520
genuinely wanting to get to know like

43
00:01:59,100 --> 00:02:04,020
how does this work like how does this

44
00:02:02,520 --> 00:02:05,640
look in our environment right like that

45
00:02:04,020 --> 00:02:07,048
was one reason why they wanted to go

46
00:02:05,640 --> 00:02:09,149
after and this blue and red is because

47
00:02:07,049 --> 00:02:12,720
what does this look from the other side

48
00:02:09,149 --> 00:02:13,800
and and I love that like and I realized

49
00:02:12,720 --> 00:02:15,600
when I started looking around at

50
00:02:13,800 --> 00:02:17,880
that I work with all of the defenders

51
00:02:15,600 --> 00:02:19,680
that I work with have that same Drive

52
00:02:17,880 --> 00:02:22,200
right we have that curiosity like how

53
00:02:19,680 --> 00:02:25,080
does this work what am I missing

54
00:02:22,200 --> 00:02:26,700
how can I capture everything and I

55
00:02:25,080 --> 00:02:30,500
wanted to be able to provide a

56
00:02:26,700 --> 00:02:33,299
repeatable process on how to do that

57
00:02:30,500 --> 00:02:34,170
another thing I came across was when I

58
00:02:33,300 --> 00:02:36,570
was going to a lot of Red Team

59
00:02:34,170 --> 00:02:38,160
conferences I would talk to different

60
00:02:36,570 --> 00:02:40,290
red teamers and they would discuss like

61
00:02:38,160 --> 00:02:42,299
I did this and this I know like that's

62
00:02:40,290 --> 00:02:43,859
really cool like how do you do emulate

63
00:02:42,300 --> 00:02:45,780
these threat actors like what does that

64
00:02:43,860 --> 00:02:48,720
look like I don't even know what the

65
00:02:45,780 --> 00:02:52,440
threat actor that cares about you in

66
00:02:48,720 --> 00:02:55,440
particular and they were like well I

67
00:02:52,440 --> 00:02:57,030
mean we just did we just do this right

68
00:02:55,440 --> 00:03:00,800
like it's all the threats like that's

69
00:02:57,030 --> 00:03:03,120
what we're doing and and I realized that

70
00:03:00,800 --> 00:03:04,980
this is kind of when my background came

71
00:03:03,120 --> 00:03:06,720
to play right like not all of us have a

72
00:03:04,980 --> 00:03:08,489
former career in military intelligence

73
00:03:06,720 --> 00:03:10,980
so the way I look at things is very

74
00:03:08,490 --> 00:03:12,870
different than the way other people look

75
00:03:10,980 --> 00:03:14,310
at things and and it realized the

76
00:03:12,870 --> 00:03:15,720
significance of that really until I

77
00:03:14,310 --> 00:03:16,560
started having these conversations I was

78
00:03:15,720 --> 00:03:18,630
like well where'd you get this

79
00:03:16,560 --> 00:03:19,950
information how do you back this up when

80
00:03:18,630 --> 00:03:21,630
you're talking about this threat how do

81
00:03:19,950 --> 00:03:22,980
you like when you're talking to

82
00:03:21,630 --> 00:03:24,329
leadership about this threat like how do

83
00:03:22,980 --> 00:03:26,130
you be like yeah this is why this is

84
00:03:24,330 --> 00:03:28,709
significant like here's the context

85
00:03:26,130 --> 00:03:29,700
around this behavior right um I didn't I

86
00:03:28,709 --> 00:03:31,530
didn't realize that that wasn't just

87
00:03:29,700 --> 00:03:34,170
something that we all did and so I

88
00:03:31,530 --> 00:03:35,640
wanted to also be able to go over what

89
00:03:34,170 --> 00:03:37,380
does it look like when you don't have a

90
00:03:35,640 --> 00:03:39,089
cyber threat intelligence team are you

91
00:03:37,380 --> 00:03:41,250
like how does that collection process

92
00:03:39,090 --> 00:03:43,530
for what this is threat how is it even

93
00:03:41,250 --> 00:03:45,420
relevant um how do I collect data to

94
00:03:43,530 --> 00:03:47,670
actually back up what I'm doing

95
00:03:45,420 --> 00:03:50,130
technically I wanted to go over what

96
00:03:47,670 --> 00:03:54,238
that process looked like and to do this

97
00:03:50,130 --> 00:03:55,079
I basically did a case study and that is

98
00:03:54,239 --> 00:03:57,390
essentially what we're going to be

99
00:03:55,080 --> 00:03:59,640
walking through during this talk I also

100
00:03:57,390 --> 00:04:03,480
was a former artist in a previous life

101
00:03:59,640 --> 00:04:04,890
some of you will find my artwork out on

102
00:04:03,480 --> 00:04:07,049
the Internet

103
00:04:04,890 --> 00:04:08,429
it was successful for a very short

104
00:04:07,050 --> 00:04:13,470
period of time there's a reason why I am

105
00:04:08,430 --> 00:04:15,690
in this field now so but I love the

106
00:04:13,470 --> 00:04:18,000
parallels because the parallels with art

107
00:04:15,690 --> 00:04:19,410
is that what you're doing is you're

108
00:04:18,000 --> 00:04:21,959
constantly trying to make yourself

109
00:04:19,410 --> 00:04:24,780
better you're constantly trying to

110
00:04:21,959 --> 00:04:27,630
perfect a technique right and there's a

111
00:04:24,780 --> 00:04:31,320
lot of parallels between art forgery

112
00:04:27,630 --> 00:04:34,050
and art so a long time ago back in the

113
00:04:31,320 --> 00:04:36,990
Renaissance age there was an artist now

114
00:04:34,050 --> 00:04:39,570
back in those days the way that you got

115
00:04:36,990 --> 00:04:41,340
better at art was you found a mentor and

116
00:04:39,570 --> 00:04:42,420
then you became their apprentice and

117
00:04:41,340 --> 00:04:44,190
then what you did was you took one

118
00:04:42,420 --> 00:04:45,570
specific technique of that mentors and

119
00:04:44,190 --> 00:04:47,100
you would emulate it and you would

120
00:04:45,570 --> 00:04:48,090
emulate it again and you do it until the

121
00:04:47,100 --> 00:04:49,800
fact you couldn't tell the difference

122
00:04:48,090 --> 00:04:52,500
between that masters work in your own

123
00:04:49,800 --> 00:04:56,220
well this particular artist took this

124
00:04:52,500 --> 00:04:58,350
sleeping eros and he recreated it to the

125
00:04:56,220 --> 00:05:02,670
point where he actually took T to give

126
00:04:58,350 --> 00:05:04,110
it that antique look so well he didn't

127
00:05:02,670 --> 00:05:05,490
know what to do with it afterwards so he

128
00:05:04,110 --> 00:05:06,990
gave to his friend right because that's

129
00:05:05,490 --> 00:05:12,300
what we did we give our rejects to our

130
00:05:06,990 --> 00:05:13,680
friends and so true and well his friends

131
00:05:12,300 --> 00:05:16,740
sold it which by the way this also

132
00:05:13,680 --> 00:05:19,470
happened to me same thing not to this

133
00:05:16,740 --> 00:05:22,230
degree obviously so his friends sold the

134
00:05:19,470 --> 00:05:24,300
piece of artwork to a cardinal so a

135
00:05:22,230 --> 00:05:25,980
couple of years passed this Cardinal has

136
00:05:24,300 --> 00:05:27,510
this what he thought was an original

137
00:05:25,980 --> 00:05:29,280
sleeping Earl's right like this was a

138
00:05:27,510 --> 00:05:32,190
statute that was 200 years old at the

139
00:05:29,280 --> 00:05:33,960
time and he realized oh wait it's

140
00:05:32,190 --> 00:05:35,760
actually over here and this is the

141
00:05:33,960 --> 00:05:37,500
original and I know this guy so it's got

142
00:05:35,760 --> 00:05:40,710
better credibility so mine must be a

143
00:05:37,500 --> 00:05:42,180
fake so here's pissed so we went back to

144
00:05:40,710 --> 00:05:46,739
the guy that sold the artwork and I was

145
00:05:42,180 --> 00:05:47,910
like um so we're like where did you get

146
00:05:46,740 --> 00:05:50,790
this from who do I need to basically

147
00:05:47,910 --> 00:05:52,560
kill right and he was like oh well that

148
00:05:50,790 --> 00:05:55,770
was Michelangelo's and he's a big artist

149
00:05:52,560 --> 00:05:58,290
now and he was a call his response was

150
00:05:55,770 --> 00:05:59,219
well I guess he must be a master even I

151
00:05:58,290 --> 00:06:03,870
couldn't tell the difference between

152
00:05:59,220 --> 00:06:05,400
that so the idea is that you kind of

153
00:06:03,870 --> 00:06:08,520
know you're the master when you're able

154
00:06:05,400 --> 00:06:12,080
to replicate it so well that you can't

155
00:06:08,520 --> 00:06:12,080
even tell the difference between the two

156
00:06:13,010 --> 00:06:19,980
when I started off this it was super

157
00:06:15,870 --> 00:06:21,210
overwhelming because I honestly had no

158
00:06:19,980 --> 00:06:22,820
idea where to start I was like okay I

159
00:06:21,210 --> 00:06:25,500
know I want to do a threat emulation I

160
00:06:22,820 --> 00:06:28,760
know I want to do a super good technical

161
00:06:25,500 --> 00:06:30,630
job on it but where do I begin right

162
00:06:28,760 --> 00:06:31,710
there's a lot of different talks out

163
00:06:30,630 --> 00:06:33,480
there that cover a lot of different

164
00:06:31,710 --> 00:06:35,669
areas but not a lot of them actually

165
00:06:33,480 --> 00:06:39,180
cover the whole lifecycle and what this

166
00:06:35,669 --> 00:06:41,159
looks like from start to finish so what

167
00:06:39,180 --> 00:06:43,020
I started with was I took two

168
00:06:41,160 --> 00:06:45,180
works that I that I knew that I knew

169
00:06:43,020 --> 00:06:46,770
really well one of them was software

170
00:06:45,180 --> 00:06:48,420
development lifecycle I took that

171
00:06:46,770 --> 00:06:50,250
framework because and the reality is

172
00:06:48,420 --> 00:06:52,110
when we're emulating threat actors we're

173
00:06:50,250 --> 00:06:53,820
really emulate ingush malware right like

174
00:06:52,110 --> 00:06:55,860
if we want to build a tection on this I

175
00:06:53,820 --> 00:06:58,290
need to really understand the malware

176
00:06:55,860 --> 00:06:59,850
the signatures and more so the behavior

177
00:06:58,290 --> 00:07:01,530
like how does it run why is it running

178
00:06:59,850 --> 00:07:03,780
that way how is it installing persistent

179
00:07:01,530 --> 00:07:06,750
and stuff like that the other framework

180
00:07:03,780 --> 00:07:08,659
that I used or wanted to use was the

181
00:07:06,750 --> 00:07:11,400
intelligence lifecycle my former career

182
00:07:08,660 --> 00:07:13,410
I was an intelligence collector so

183
00:07:11,400 --> 00:07:14,760
there's a whole lot of things that go

184
00:07:13,410 --> 00:07:17,550
along with that right but with the way

185
00:07:14,760 --> 00:07:19,740
we go about finding information then we

186
00:07:17,550 --> 00:07:21,390
take that information we parse it we

187
00:07:19,740 --> 00:07:23,100
analyze that we process it then we dig

188
00:07:21,390 --> 00:07:24,930
deeper we figure out what's missing

189
00:07:23,100 --> 00:07:27,450
okay this information is coming from

190
00:07:24,930 --> 00:07:29,220
this source how can I collaborate that

191
00:07:27,450 --> 00:07:31,110
information with this information from

192
00:07:29,220 --> 00:07:33,150
this source like what's the similarities

193
00:07:31,110 --> 00:07:35,820
right so I took those two life cycles

194
00:07:33,150 --> 00:07:37,380
and then I combine them into one so this

195
00:07:35,820 --> 00:07:40,290
is essentially for those of you that are

196
00:07:37,380 --> 00:07:43,230
familiar with this the agile lifecycle I

197
00:07:40,290 --> 00:07:48,470
know we're agile open here and thread

198
00:07:43,230 --> 00:07:50,520
emulation so the way this starts is

199
00:07:48,470 --> 00:07:51,990
essentially we choose a thread actor

200
00:07:50,520 --> 00:07:54,090
right and the intelligence lifecycle we

201
00:07:51,990 --> 00:07:55,590
want to pick a direction so that's

202
00:07:54,090 --> 00:07:57,000
usually where everything goes you kind

203
00:07:55,590 --> 00:08:00,810
of can't go anywhere until you have a

204
00:07:57,000 --> 00:08:02,850
focus so picked an actor gather the info

205
00:08:00,810 --> 00:08:04,050
this is essentially where I'm going to

206
00:08:02,850 --> 00:08:05,820
be doing it all the massive data

207
00:08:04,050 --> 00:08:07,260
question right the next phase is the

208
00:08:05,820 --> 00:08:09,000
software development which for me it was

209
00:08:07,260 --> 00:08:12,090
fun because we're literally creating

210
00:08:09,000 --> 00:08:13,590
malware which is always awesome and then

211
00:08:12,090 --> 00:08:14,549
there's the test and the iterate right

212
00:08:13,590 --> 00:08:16,229
like this is where we're going to go

213
00:08:14,550 --> 00:08:19,260
through and make sure like okay does

214
00:08:16,230 --> 00:08:21,240
this match up to what I'm also like when

215
00:08:19,260 --> 00:08:22,950
I'm detecting this malware the real

216
00:08:21,240 --> 00:08:25,560
stuff and then I'm when I'm repeating

217
00:08:22,950 --> 00:08:26,940
this with my stuff similarities where

218
00:08:25,560 --> 00:08:29,040
rather than the differences where do

219
00:08:26,940 --> 00:08:31,050
those meet and collide and then finally

220
00:08:29,040 --> 00:08:34,110
which is the fun like also fun for all

221
00:08:31,050 --> 00:08:35,729
of its fun the last one part right which

222
00:08:34,110 --> 00:08:38,190
is where we get to play with the kill

223
00:08:35,729 --> 00:08:39,750
chain which is the Lockheed Martin kill

224
00:08:38,190 --> 00:08:42,870
chain for a better reference right the

225
00:08:39,750 --> 00:08:44,880
initial infection the the persistence in

226
00:08:42,870 --> 00:08:46,050
the collection and so on and so on

227
00:08:44,880 --> 00:08:49,589
which will have will have pretty

228
00:08:46,050 --> 00:08:51,599
diagrams later to go over so picking a

229
00:08:49,589 --> 00:08:53,339
direction I specifically chose fancy

230
00:08:51,600 --> 00:08:54,310
Bayer the reason why I chose fancy

231
00:08:53,339 --> 00:08:56,410
Barrett was because they

232
00:08:54,310 --> 00:08:57,819
have a wonderful selection of reports

233
00:08:56,410 --> 00:08:59,890
there's a lot of really great people in

234
00:08:57,820 --> 00:09:01,630
this field that have done a ton of work

235
00:08:59,890 --> 00:09:03,819
a lot of reverse engineers that have

236
00:09:01,630 --> 00:09:06,520
gone super deep and literally written

237
00:09:03,820 --> 00:09:09,160
out the source code for some of this

238
00:09:06,520 --> 00:09:13,120
malware so I wanted to be able to

239
00:09:09,160 --> 00:09:14,709
showcase a specific malware from a

240
00:09:13,120 --> 00:09:17,860
threat actor that was also known to

241
00:09:14,710 --> 00:09:20,860
target Mac OS so that was also a key

242
00:09:17,860 --> 00:09:22,390
element Mac OS is actually not very well

243
00:09:20,860 --> 00:09:23,560
represented in threat actors I would

244
00:09:22,390 --> 00:09:24,850
talk to our cyber threat intelligence

245
00:09:23,560 --> 00:09:26,829
team because we are very fortunate

246
00:09:24,850 --> 00:09:29,980
target to have one and they were like

247
00:09:26,830 --> 00:09:31,750
well max kind of aren't on the radar for

248
00:09:29,980 --> 00:09:33,730
a lot of these specific groups I was

249
00:09:31,750 --> 00:09:36,640
like but they're on the radar like we

250
00:09:33,730 --> 00:09:39,430
just don't know so I wanted to pick this

251
00:09:36,640 --> 00:09:41,620
guy because there's a lot of stories

252
00:09:39,430 --> 00:09:43,870
about how something will get uploaded

253
00:09:41,620 --> 00:09:45,279
and then download it in the real world

254
00:09:43,870 --> 00:09:47,470
environment and then uploaded back to

255
00:09:45,279 --> 00:09:49,900
virustotal or a proof-of-concept will

256
00:09:47,470 --> 00:09:51,790
get uploaded or disseminated to the

257
00:09:49,900 --> 00:09:54,310
community then that same proof of

258
00:09:51,790 --> 00:09:55,689
concept will be manipulated that proved

259
00:09:54,310 --> 00:09:57,989
a concept will then be uploaded into

260
00:09:55,690 --> 00:09:57,990
virustotal

261
00:09:58,980 --> 00:10:05,890
from a real world company and then then

262
00:10:04,570 --> 00:10:07,300
you've just gotten to see the fact that

263
00:10:05,890 --> 00:10:08,860
we just don't know who that is and

264
00:10:07,300 --> 00:10:12,250
that's it so it's happening we just

265
00:10:08,860 --> 00:10:14,400
don't know who as we go deeper the last

266
00:10:12,250 --> 00:10:16,780
thing that I wanted to also pick for

267
00:10:14,400 --> 00:10:20,860
fancy bear was just like the name

268
00:10:16,780 --> 00:10:22,240
thought the name was awesome so I would

269
00:10:20,860 --> 00:10:24,550
be remiss if I did not go over this part

270
00:10:22,240 --> 00:10:26,620
right so thread profiling is a huge deal

271
00:10:24,550 --> 00:10:29,199
I like to think of this in two parts

272
00:10:26,620 --> 00:10:33,700
right one is are these but these guys

273
00:10:29,200 --> 00:10:34,810
target me it's almost kind of like I've

274
00:10:33,700 --> 00:10:36,010
been diagram you have to look at it from

275
00:10:34,810 --> 00:10:37,959
a couple of different perspectives right

276
00:10:36,010 --> 00:10:39,939
like should I care about these guys and

277
00:10:37,959 --> 00:10:41,949
should these guys care about me it's

278
00:10:39,940 --> 00:10:44,290
kind of a two-fold perspective there's

279
00:10:41,950 --> 00:10:45,550
also an easy way to kind of simplify

280
00:10:44,290 --> 00:10:46,959
this there's a lot of people that do

281
00:10:45,550 --> 00:10:49,660
some really great talks on threat

282
00:10:46,959 --> 00:10:51,189
profiling my eyesight of the paper from

283
00:10:49,660 --> 00:10:52,689
the SANS Institute they go over that

284
00:10:51,190 --> 00:10:53,980
stuff much better you'll notice I

285
00:10:52,690 --> 00:10:55,870
actually cite a lot of different things

286
00:10:53,980 --> 00:10:57,250
in these slides so just in case you

287
00:10:55,870 --> 00:10:58,600
won't want to take pictures you can dig

288
00:10:57,250 --> 00:11:00,610
deeper into some of the research there's

289
00:10:58,600 --> 00:11:03,459
tons of research on all of these areas

290
00:11:00,610 --> 00:11:06,760
it's a lot of broad topics in this

291
00:11:03,459 --> 00:11:07,699
specific case one way that I've gone

292
00:11:06,760 --> 00:11:10,009
about this to be a

293
00:11:07,699 --> 00:11:12,559
do it simplified is I'll take activist

294
00:11:10,009 --> 00:11:14,119
what activists are in the geographic

295
00:11:12,559 --> 00:11:17,569
location that is relevant to my company

296
00:11:14,119 --> 00:11:19,429
I partnerships what companies do I

297
00:11:17,569 --> 00:11:21,439
actually actively have partnerships with

298
00:11:19,429 --> 00:11:23,629
that this threat actor would care about

299
00:11:21,439 --> 00:11:26,569
or this hacktivists or the cybercriminal

300
00:11:23,629 --> 00:11:28,489
fancy bear is extremely well known to do

301
00:11:26,569 --> 00:11:31,368
a lot of misattribution they love

302
00:11:28,489 --> 00:11:33,230
playing on cybercrime domains or over

303
00:11:31,369 --> 00:11:36,139
I'll play over this one like this Apple

304
00:11:33,230 --> 00:11:38,239
auto-update that looks legit so they do

305
00:11:36,139 --> 00:11:39,919
a lot of this misattribution to be able

306
00:11:38,239 --> 00:11:41,509
to play both in the cyber crime world

307
00:11:39,919 --> 00:11:44,449
and then also the nation state after

308
00:11:41,509 --> 00:11:45,589
world so this is kind of where that

309
00:11:44,449 --> 00:11:48,618
threat profiling comes in right like

310
00:11:45,589 --> 00:11:50,929
what falls in that scope so I know what

311
00:11:48,619 --> 00:11:54,529
lens to put on when I'm looking at these

312
00:11:50,929 --> 00:11:55,809
different specific threat actors just to

313
00:11:54,529 --> 00:11:58,069
kind of go over a few more things

314
00:11:55,809 --> 00:12:00,319
intellectual assets do I have anything

315
00:11:58,069 --> 00:12:03,009
that they actually care about whether

316
00:12:00,319 --> 00:12:05,179
that is schematics or whether that is

317
00:12:03,009 --> 00:12:07,249
the ability to collect different

318
00:12:05,179 --> 00:12:09,379
information do I have any communication

319
00:12:07,249 --> 00:12:11,449
equipment but that might be significant

320
00:12:09,379 --> 00:12:13,639
that they can then leverage like do I

321
00:12:11,449 --> 00:12:17,238
offer security services or do I offer

322
00:12:13,639 --> 00:12:19,249
actual services like Dropbox right where

323
00:12:17,239 --> 00:12:21,379
I would have access to tons of systems

324
00:12:19,249 --> 00:12:23,779
like that's kind of what falls into this

325
00:12:21,379 --> 00:12:25,519
scope like what again what partnerships

326
00:12:23,779 --> 00:12:27,499
just because I might not be the target

327
00:12:25,519 --> 00:12:31,549
doesn't mean I won't be leveraged to get

328
00:12:27,499 --> 00:12:35,149
to somebody else the next thing is the

329
00:12:31,549 --> 00:12:37,309
gathering the info so the big thing

330
00:12:35,149 --> 00:12:39,939
about gathering info is that it is not a

331
00:12:37,309 --> 00:12:42,439
okay I did all the things I'm done

332
00:12:39,939 --> 00:12:44,959
that's not the way that works it's

333
00:12:42,439 --> 00:12:47,929
usually the way it works is you start

334
00:12:44,959 --> 00:12:49,878
one area you find a ton of gaps and then

335
00:12:47,929 --> 00:12:51,470
you dig down like 17 or out of the holes

336
00:12:49,879 --> 00:12:53,480
and you come back up you're like well

337
00:12:51,470 --> 00:12:55,309
that was a waste of time and then you go

338
00:12:53,480 --> 00:12:56,569
down 17 more in another area and then

339
00:12:55,309 --> 00:12:58,488
you're like you find this one little

340
00:12:56,569 --> 00:13:00,799
nugget of information and it correlates

341
00:12:58,489 --> 00:13:02,629
to this one other nugget information and

342
00:13:00,799 --> 00:13:05,539
they're like oh my god that's how

343
00:13:02,629 --> 00:13:08,379
they're doing it and it's like I spent

344
00:13:05,539 --> 00:13:12,769
20 hours on these many reports for that

345
00:13:08,379 --> 00:13:14,660
so it's not a great payoff but it it is

346
00:13:12,769 --> 00:13:16,279
significant because there is something

347
00:13:14,660 --> 00:13:18,439
magical about the way the human brain

348
00:13:16,279 --> 00:13:20,720
analyzes information so I definitely

349
00:13:18,439 --> 00:13:21,560
want to call that out because as much

350
00:13:20,720 --> 00:13:23,810
automation as week

351
00:13:21,560 --> 00:13:25,310
do-nothing will pass the ability for us

352
00:13:23,810 --> 00:13:28,550
to be able to put together patterns that

353
00:13:25,310 --> 00:13:29,779
don't make sense one of the areas so

354
00:13:28,550 --> 00:13:31,010
what I'm going to do for a couple of

355
00:13:29,779 --> 00:13:33,320
these because I'm walking you all

356
00:13:31,010 --> 00:13:35,439
through a case study that I did I'm

357
00:13:33,320 --> 00:13:38,720
going to be releasing to opml file so

358
00:13:35,440 --> 00:13:40,490
feedly is a resource that was suggested

359
00:13:38,720 --> 00:13:42,980
to me and basically you can take

360
00:13:40,490 --> 00:13:45,260
someone's OPML file drop it in and what

361
00:13:42,980 --> 00:13:46,670
that does is it gives you the events the

362
00:13:45,260 --> 00:13:48,860
current events you can have different

363
00:13:46,670 --> 00:13:50,569
RSS feeds and I'll have that on my

364
00:13:48,860 --> 00:13:53,360
LinkedIn or I'll provide that via keye

365
00:13:50,570 --> 00:13:55,490
base or something like that but for me

366
00:13:53,360 --> 00:13:57,680
that was the start right I find out the

367
00:13:55,490 --> 00:14:00,020
current events and then I also continue

368
00:13:57,680 --> 00:14:03,319
to dig deeper as I'll go on another

369
00:14:00,020 --> 00:14:05,600
thing right a great place to start not

370
00:14:03,320 --> 00:14:08,120
finish is the attack framework they do

371
00:14:05,600 --> 00:14:10,040
have a lot of sites referenced that you

372
00:14:08,120 --> 00:14:11,720
can kind of begin threat minor is a data

373
00:14:10,040 --> 00:14:13,459
repository I didn't find out about

374
00:14:11,720 --> 00:14:17,000
threat monitor until after this and I

375
00:14:13,460 --> 00:14:20,089
was pissed so you're welcome just so you

376
00:14:17,000 --> 00:14:22,730
know enjoy um another thing is the

377
00:14:20,089 --> 00:14:24,740
diagrams for so because I want to

378
00:14:22,730 --> 00:14:26,720
recreate malware right like that is my

379
00:14:24,740 --> 00:14:29,660
one of my huge objectives in this

380
00:14:26,720 --> 00:14:31,610
project I need technical reports I need

381
00:14:29,660 --> 00:14:33,050
to be able to drill down to the basics

382
00:14:31,610 --> 00:14:35,030
what has source code what has actually

383
00:14:33,050 --> 00:14:36,920
gone over the malware like what actually

384
00:14:35,030 --> 00:14:38,420
gives me a really good idea indicator of

385
00:14:36,920 --> 00:14:40,490
what this malware is gonna do so if I

386
00:14:38,420 --> 00:14:44,599
run into my environment I am prepared

387
00:14:40,490 --> 00:14:46,339
for whatever it's gonna throw out me so

388
00:14:44,600 --> 00:14:48,140
the way I do this is I break it down via

389
00:14:46,339 --> 00:14:49,880
kill chain so since I want to be able to

390
00:14:48,140 --> 00:14:52,370
implement this in the software

391
00:14:49,880 --> 00:14:53,900
development lifecycle um I'm going to do

392
00:14:52,370 --> 00:14:56,750
assume breach scenario for me that's

393
00:14:53,900 --> 00:14:58,490
just that makes more sense we know

394
00:14:56,750 --> 00:14:59,660
they're gonna click the link we don't

395
00:14:58,490 --> 00:15:01,280
want to say that they can click the link

396
00:14:59,660 --> 00:15:02,329
I'm gonna tell all of our leaders though

397
00:15:01,280 --> 00:15:04,520
they're not gonna click the link but

398
00:15:02,330 --> 00:15:06,800
they're gonna click the link so moving

399
00:15:04,520 --> 00:15:08,510
beyond clicking link I want to be able

400
00:15:06,800 --> 00:15:10,040
to focus on what can I actually build a

401
00:15:08,510 --> 00:15:12,890
text like what behaviors can I build a

402
00:15:10,040 --> 00:15:14,469
tection around so this kind of actually

403
00:15:12,890 --> 00:15:18,020
bleeds into a lot of the other processes

404
00:15:14,470 --> 00:15:19,940
but this report is actually they were

405
00:15:18,020 --> 00:15:22,430
announced in this amazing little pointer

406
00:15:19,940 --> 00:15:24,740
um this is actually the report that I

407
00:15:22,430 --> 00:15:26,300
used for almost the entire thing so what

408
00:15:24,740 --> 00:15:28,190
I'll do is I'll take this specific

409
00:15:26,300 --> 00:15:29,479
report that I find right I'll go through

410
00:15:28,190 --> 00:15:32,150
and I'll highlight behaviors I'll

411
00:15:29,480 --> 00:15:34,190
highlight what exactly does it do what

412
00:15:32,150 --> 00:15:34,620
folders does it drop it into what kind

413
00:15:34,190 --> 00:15:37,440
of

414
00:15:34,620 --> 00:15:39,360
binary is it using in this case it takes

415
00:15:37,440 --> 00:15:41,790
a mock Oh file right and it drops that

416
00:15:39,360 --> 00:15:43,380
drops two of them so and then it also

417
00:15:41,790 --> 00:15:45,420
has a whole bunch of other stuff that it

418
00:15:43,380 --> 00:15:47,790
does with it which we'll go through so I

419
00:15:45,420 --> 00:15:49,410
take this I also break it down so these

420
00:15:47,790 --> 00:15:50,969
are my radicals essentially now within

421
00:15:49,410 --> 00:15:53,130
each one of these branches you'll also

422
00:15:50,970 --> 00:15:55,290
find it kind of scattering for me what I

423
00:15:53,130 --> 00:15:57,720
chose to do was I had to eventually pick

424
00:15:55,290 --> 00:16:00,000
a malware what I chose to pick was

425
00:15:57,720 --> 00:16:02,850
complex and that was the initial

426
00:16:00,000 --> 00:16:04,410
infection that I chose to emulate and

427
00:16:02,850 --> 00:16:06,510
again so as I walked through it

428
00:16:04,410 --> 00:16:09,030
I had my initial infection or my

429
00:16:06,510 --> 00:16:13,290
exploitation that same malware because

430
00:16:09,030 --> 00:16:15,780
the red actors are lazy also installs

431
00:16:13,290 --> 00:16:16,620
persistence so I had my installation the

432
00:16:15,780 --> 00:16:19,890
command and control

433
00:16:16,620 --> 00:16:22,530
I actually was super grateful I did not

434
00:16:19,890 --> 00:16:25,110
have to create a panel to be able to

435
00:16:22,530 --> 00:16:26,910
interact with their c2 agent so what I

436
00:16:25,110 --> 00:16:28,800
did and also because this talk is

437
00:16:26,910 --> 00:16:30,390
specifically for defenders like I wanted

438
00:16:28,800 --> 00:16:34,229
to be able to provide defenders

439
00:16:30,390 --> 00:16:35,430
something that is super loud I want to

440
00:16:34,230 --> 00:16:36,900
be able to probably or something that

441
00:16:35,430 --> 00:16:39,540
was flexible so that way if you all

442
00:16:36,900 --> 00:16:42,540
wanted to be able to test out Empire or

443
00:16:39,540 --> 00:16:44,099
app fells new c2 you could just take

444
00:16:42,540 --> 00:16:45,510
your mock Oh drop it in and then it

445
00:16:44,100 --> 00:16:47,970
would compile it to be able to recreate

446
00:16:45,510 --> 00:16:49,530
it so we you could use it and then you

447
00:16:47,970 --> 00:16:52,320
could see if your environment could

448
00:16:49,530 --> 00:16:55,050
detect what this is which is as close as

449
00:16:52,320 --> 00:16:56,430
I could get to fancy dress and then the

450
00:16:55,050 --> 00:16:59,130
last is the actions on the objective

451
00:16:56,430 --> 00:17:01,260
right Twitter it's been mentioned a ton

452
00:16:59,130 --> 00:17:03,060
of times our community does thrive off

453
00:17:01,260 --> 00:17:06,030
of it on the malware that I actually got

454
00:17:03,060 --> 00:17:08,429
was from Patrick Portal he has a great

455
00:17:06,030 --> 00:17:10,260
malware repository for Mac OS and he

456
00:17:08,430 --> 00:17:15,510
also does a great job of linking the

457
00:17:10,260 --> 00:17:17,099
actual technical reports so fancy bearer

458
00:17:15,510 --> 00:17:18,690
likes to live in the gray as I mentioned

459
00:17:17,099 --> 00:17:21,359
before they do a lot of playing on the

460
00:17:18,690 --> 00:17:24,680
cyber network and then they also play on

461
00:17:21,359 --> 00:17:27,659
you know normal nation-state collection

462
00:17:24,680 --> 00:17:33,240
back to the art forgery there was an

463
00:17:27,660 --> 00:17:35,190
artist called Erik Hepburn Erik he was a

464
00:17:33,240 --> 00:17:36,420
rejected artist actually so they didn't

465
00:17:35,190 --> 00:17:37,980
think his artwork was that good so what

466
00:17:36,420 --> 00:17:39,570
he decided to do was just go and emulate

467
00:17:37,980 --> 00:17:43,110
everybody else's artwork that was old

468
00:17:39,570 --> 00:17:45,510
masters ironically enough so what he

469
00:17:43,110 --> 00:17:48,449
would do actually is he would at night

470
00:17:45,510 --> 00:17:51,658
go get drunk right sure every

471
00:17:48,450 --> 00:17:53,970
why gherkin on Friday is definitely has

472
00:17:51,659 --> 00:17:55,230
cement that they towards that so you'd

473
00:17:53,970 --> 00:17:56,519
go get drunk and the reason why I would

474
00:17:55,230 --> 00:17:58,620
get drunk is because he wanted to make

475
00:17:56,519 --> 00:18:01,529
sure his hand was fluid and relaxed and

476
00:17:58,620 --> 00:18:03,330
what he would do is he would take these

477
00:18:01,529 --> 00:18:05,610
artists that he would emulate these

478
00:18:03,330 --> 00:18:07,470
masters and then he would mimic their

479
00:18:05,610 --> 00:18:09,899
sketches but he wasn't trying to do the

480
00:18:07,470 --> 00:18:11,490
exact sketch he would actually do his

481
00:18:09,899 --> 00:18:12,979
own work but he would make sure it was

482
00:18:11,490 --> 00:18:15,600
fluid it wasn't mimicking their same

483
00:18:12,980 --> 00:18:17,549
manners their same style the way that

484
00:18:15,600 --> 00:18:19,889
they would have that brushstroke on the

485
00:18:17,549 --> 00:18:22,408
paper and the reason why he did he

486
00:18:19,889 --> 00:18:24,090
actually had 300 pieces of work that

487
00:18:22,409 --> 00:18:25,710
were actually original pieces of work

488
00:18:24,090 --> 00:18:27,840
but that were mistaken as forgeries

489
00:18:25,710 --> 00:18:30,330
because they were so similar to these

490
00:18:27,840 --> 00:18:32,519
artists work so the reason for this is

491
00:18:30,330 --> 00:18:34,529
because emulation like we can get them

492
00:18:32,519 --> 00:18:36,179
our pretty close right like we have that

493
00:18:34,529 --> 00:18:39,389
we have the technical reports we've got

494
00:18:36,179 --> 00:18:41,820
this data the actual emulation of it it

495
00:18:39,389 --> 00:18:43,320
is an art one like it's all but the

496
00:18:41,820 --> 00:18:45,120
motivations like what are the patterns

497
00:18:43,320 --> 00:18:47,490
of the fed actor where do they go after

498
00:18:45,120 --> 00:18:49,649
when they first land on the post what do

499
00:18:47,490 --> 00:18:50,940
they need to know because like if I'm a

500
00:18:49,649 --> 00:18:52,500
red team and I know my environment

501
00:18:50,940 --> 00:18:54,120
really well I don't need to do all these

502
00:18:52,500 --> 00:18:55,350
scans and everything right like I don't

503
00:18:54,120 --> 00:18:57,689
need to do a lot of these things because

504
00:18:55,350 --> 00:18:59,100
I already know so emulating the thread

505
00:18:57,690 --> 00:19:01,440
of they're not going to have a lot of it

506
00:18:59,100 --> 00:19:04,439
like innate knowledge that I have so

507
00:19:01,440 --> 00:19:06,539
what would I do like fancy bear loves

508
00:19:04,440 --> 00:19:08,460
going after credentials they're super

509
00:19:06,539 --> 00:19:09,870
hard on it so all of the different ways

510
00:19:08,460 --> 00:19:12,120
you can do credentials they're gonna do

511
00:19:09,870 --> 00:19:13,979
they're also super lazy they would

512
00:19:12,120 --> 00:19:15,899
rather get your backup files than they

513
00:19:13,980 --> 00:19:18,179
would anything else so they're gonna

514
00:19:15,899 --> 00:19:19,379
pull all of your iOS backup files if you

515
00:19:18,179 --> 00:19:21,389
have your phone backed up on your

516
00:19:19,380 --> 00:19:23,279
computer and that way they can deal with

517
00:19:21,389 --> 00:19:25,350
all the decryption later and and have it

518
00:19:23,279 --> 00:19:27,110
offline right so those are the things

519
00:19:25,350 --> 00:19:29,879
that when I'm searching in these reports

520
00:19:27,110 --> 00:19:31,769
that's what I'm looking for and that's

521
00:19:29,880 --> 00:19:33,809
where the human component comes in right

522
00:19:31,769 --> 00:19:35,760
because those are the patterns they're

523
00:19:33,809 --> 00:19:38,760
not gonna be and then they did this and

524
00:19:35,760 --> 00:19:41,190
this and this we're done like no it's

525
00:19:38,760 --> 00:19:43,559
gonna be a really general way and it's

526
00:19:41,190 --> 00:19:45,480
gonna change because again that threat

527
00:19:43,559 --> 00:19:48,658
model is significant right what are you

528
00:19:45,480 --> 00:19:52,289
going after now so they're very very

529
00:19:48,659 --> 00:19:56,399
gray as you're going through this

530
00:19:52,289 --> 00:19:59,399
research you'll find there is a cone of

531
00:19:56,399 --> 00:20:02,370
silence it is frustrating and it is

532
00:19:59,399 --> 00:20:05,789
annoying yes you have not

533
00:20:02,370 --> 00:20:07,350
I I completely understand the way this

534
00:20:05,789 --> 00:20:09,750
works is as you're on the outside of the

535
00:20:07,350 --> 00:20:11,549
cone it's actually pretty easy to get

536
00:20:09,750 --> 00:20:14,039
some misinformation if I want to know

537
00:20:11,549 --> 00:20:16,230
the signatures if I want to know the

538
00:20:14,039 --> 00:20:18,960
domains they use we are really good as a

539
00:20:16,230 --> 00:20:21,570
community to disseminate that out as you

540
00:20:18,960 --> 00:20:23,970
go in you have the malware and the tools

541
00:20:21,570 --> 00:20:25,379
right gets a little tricky because a lot

542
00:20:23,970 --> 00:20:27,419
of threat actors like to look like pen

543
00:20:25,380 --> 00:20:29,070
testers so you got to figure out where

544
00:20:27,419 --> 00:20:30,750
that crosses right and fancy bears

545
00:20:29,070 --> 00:20:34,289
really bad at that they love to do

546
00:20:30,750 --> 00:20:36,779
misattribution so it gets a little

547
00:20:34,289 --> 00:20:39,539
trickier but still you can figure it out

548
00:20:36,779 --> 00:20:43,919
right like we have the panel whore or I

549
00:20:39,539 --> 00:20:46,140
have the c2 agent inside of the the

550
00:20:43,919 --> 00:20:48,320
malware that I have I have like I can

551
00:20:46,140 --> 00:20:51,240
have X agent so I can have that malware

552
00:20:48,320 --> 00:20:54,600
so I can be able to fully read or

553
00:20:51,240 --> 00:20:57,390
emulate that as you go further in the

554
00:20:54,600 --> 00:20:59,100
cone that's when you have to have little

555
00:20:57,390 --> 00:21:01,860
patience right so might our tech

556
00:20:59,100 --> 00:21:03,120
framework is great the downside of the

557
00:21:01,860 --> 00:21:05,370
mire track framework is that you have to

558
00:21:03,120 --> 00:21:08,549
wait for a report to be published so

559
00:21:05,370 --> 00:21:12,090
there is that but again that information

560
00:21:08,549 --> 00:21:15,450
is available and then it turns in to be

561
00:21:12,090 --> 00:21:19,158
super super quiet and the reason why it

562
00:21:15,450 --> 00:21:21,480
gets that quiet is because that's when

563
00:21:19,159 --> 00:21:23,520
you have to have a lot of trust with the

564
00:21:21,480 --> 00:21:26,850
people you're talking to that's when

565
00:21:23,520 --> 00:21:29,129
you're talking about real cases where

566
00:21:26,850 --> 00:21:30,990
someone infiltrated their environments

567
00:21:29,130 --> 00:21:33,240
and they don't want to talk about that

568
00:21:30,990 --> 00:21:35,010
alright then we get into disclosures I'm

569
00:21:33,240 --> 00:21:39,570
again all of these other topics that are

570
00:21:35,010 --> 00:21:41,250
super tricky and sticky so in the

571
00:21:39,570 --> 00:21:42,689
actions on the victim take a little

572
00:21:41,250 --> 00:21:44,010
longer to come out a lot of times like

573
00:21:42,690 --> 00:21:45,690
when we talk about networking especially

574
00:21:44,010 --> 00:21:48,179
with cyber threat intelligence even our

575
00:21:45,690 --> 00:21:50,220
team that we have a target a ton of it

576
00:21:48,179 --> 00:21:52,080
is through people that you know who

577
00:21:50,220 --> 00:21:53,970
trusted conversations and relationships

578
00:21:52,080 --> 00:21:55,470
and then when we get down all the way to

579
00:21:53,970 --> 00:21:59,100
the bottom where it's the victims and

580
00:21:55,470 --> 00:22:01,020
objectives like I only reason why I know

581
00:21:59,100 --> 00:22:02,549
about some of fancy bears victims and

582
00:22:01,020 --> 00:22:05,279
objectives is because of those trusted

583
00:22:02,549 --> 00:22:06,450
relationships where they told me what

584
00:22:05,279 --> 00:22:07,440
they were going after which they didn't

585
00:22:06,450 --> 00:22:12,240
even know what they were going after

586
00:22:07,440 --> 00:22:13,679
until months into the campaign and they

587
00:22:12,240 --> 00:22:16,140
were so established in that environment

588
00:22:13,679 --> 00:22:18,430
that

589
00:22:16,140 --> 00:22:22,360
it was a huge embarrassment for the

590
00:22:18,430 --> 00:22:25,540
entire company so again

591
00:22:22,360 --> 00:22:28,479
cone of silence right so it sucks it's

592
00:22:25,540 --> 00:22:31,659
very frustrating it is a thing however

593
00:22:28,480 --> 00:22:34,660
there's also a purpose to it so as we

594
00:22:31,660 --> 00:22:38,080
get down there right one example of this

595
00:22:34,660 --> 00:22:42,250
is actually I'll say the example for

596
00:22:38,080 --> 00:22:45,149
later but when we go through and we talk

597
00:22:42,250 --> 00:22:47,560
about things publicly like for example

598
00:22:45,150 --> 00:22:52,930
Patrick Worrell did this great Mako's or

599
00:22:47,560 --> 00:22:56,830
this I lost the word because I'm saying

600
00:22:52,930 --> 00:22:59,830
it in public there is this word document

601
00:22:56,830 --> 00:23:01,659
with macros and he published on his blog

602
00:22:59,830 --> 00:23:04,540
like how to how to go through it and

603
00:23:01,660 --> 00:23:05,800
then like a month later early night not

604
00:23:04,540 --> 00:23:07,930
even actually a month later someone else

605
00:23:05,800 --> 00:23:09,940
uploaded it and like and it was another

606
00:23:07,930 --> 00:23:11,920
company and it's like once that

607
00:23:09,940 --> 00:23:14,560
information is out there it can be used

608
00:23:11,920 --> 00:23:17,590
right once those those domains are out

609
00:23:14,560 --> 00:23:18,940
there like a PT 28 or fancy Barrett is

610
00:23:17,590 --> 00:23:21,580
gonna change them like once they know

611
00:23:18,940 --> 00:23:25,180
that you're tracking like app update iOS

612
00:23:21,580 --> 00:23:27,159
like they're gonna change it so the idea

613
00:23:25,180 --> 00:23:29,020
behind this is it is frustrating but

614
00:23:27,160 --> 00:23:30,220
there is also a need for it so when

615
00:23:29,020 --> 00:23:32,650
we're going through and doing this

616
00:23:30,220 --> 00:23:34,390
information dissemination there's a

617
00:23:32,650 --> 00:23:36,130
little bit of discernment that we have

618
00:23:34,390 --> 00:23:38,490
to have as professionals to make sure

619
00:23:36,130 --> 00:23:42,040
that if I'm disclosing this information

620
00:23:38,490 --> 00:23:45,670
like what is how far does that go and

621
00:23:42,040 --> 00:23:47,290
what is the scope of that so now I get

622
00:23:45,670 --> 00:23:51,700
to the software development part which I

623
00:23:47,290 --> 00:23:53,230
had a blast in so the scoping of the

624
00:23:51,700 --> 00:23:56,440
design I wanted to make sure that I

625
00:23:53,230 --> 00:23:58,480
could keep flexible so again because

626
00:23:56,440 --> 00:24:02,290
this is how I dug down a might into my

627
00:23:58,480 --> 00:24:04,120
reports I'm ignoring the delivery I am

628
00:24:02,290 --> 00:24:05,649
picking the exploitation which I already

629
00:24:04,120 --> 00:24:07,030
have the source code for right because

630
00:24:05,650 --> 00:24:08,920
that comes from that technical document

631
00:24:07,030 --> 00:24:10,899
on the installation which is going to be

632
00:24:08,920 --> 00:24:12,790
a plist file which again I have in the

633
00:24:10,900 --> 00:24:15,250
document command control I'm going to

634
00:24:12,790 --> 00:24:17,800
use pipe art I'm going to use PowerShell

635
00:24:15,250 --> 00:24:19,270
Empire because fancy bearer is known to

636
00:24:17,800 --> 00:24:21,639
use PowerShell Empire going throughout

637
00:24:19,270 --> 00:24:24,070
all of their campaign or a lot of their

638
00:24:21,640 --> 00:24:25,810
campaigns other than ex-agent and also

639
00:24:24,070 --> 00:24:28,060
what complex can sometimes be called

640
00:24:25,810 --> 00:24:29,909
since count the complex c2 is actually

641
00:24:28,060 --> 00:24:32,520
different from the X agent and then

642
00:24:29,910 --> 00:24:34,050
actions on the objective that's where

643
00:24:32,520 --> 00:24:35,250
that's all in this attribution right

644
00:24:34,050 --> 00:24:38,159
that's going after the credentials the

645
00:24:35,250 --> 00:24:39,870
i/os again all of this I haven't even

646
00:24:38,160 --> 00:24:42,030
coded yet and I have all of this

647
00:24:39,870 --> 00:24:45,389
information parsed out per for the kill

648
00:24:42,030 --> 00:24:47,550
chain so this is the technical report I

649
00:24:45,390 --> 00:24:49,530
use just an example of a code that they

650
00:24:47,550 --> 00:24:53,310
provided from the report so there's

651
00:24:49,530 --> 00:24:55,260
already a ton of it done one reason just

652
00:24:53,310 --> 00:24:56,730
so you all know I chose very

653
00:24:55,260 --> 00:24:58,650
intentionally to do no reverse

654
00:24:56,730 --> 00:25:00,540
engineering in this entire thing I

655
00:24:58,650 --> 00:25:02,070
wanted to make sure that the only thing

656
00:25:00,540 --> 00:25:07,770
you needed to have as far as skill sets

657
00:25:02,070 --> 00:25:09,870
go was time stubbornness and and the

658
00:25:07,770 --> 00:25:12,770
ability to learn like I didn't even know

659
00:25:09,870 --> 00:25:15,389
objective-c before I started this so

660
00:25:12,770 --> 00:25:17,280
everything that I'm doing is taken

661
00:25:15,390 --> 00:25:19,020
directly from the this malware that I

662
00:25:17,280 --> 00:25:21,570
got it's taken directly from open-source

663
00:25:19,020 --> 00:25:23,940
tools it should be fully recreate able

664
00:25:21,570 --> 00:25:26,159
there's no binary patching there's no

665
00:25:23,940 --> 00:25:28,980
digging deep reverse engineering it's

666
00:25:26,160 --> 00:25:30,600
just pulling it straight out so I find

667
00:25:28,980 --> 00:25:32,280
like this is the type of report that I'm

668
00:25:30,600 --> 00:25:34,320
looking for where it has all of these

669
00:25:32,280 --> 00:25:35,970
objective-c methods laid out right but I

670
00:25:34,320 --> 00:25:37,439
can't just compile this code and run it

671
00:25:35,970 --> 00:25:38,610
like I actually had to look at every

672
00:25:37,440 --> 00:25:40,860
single line and actually dig a little

673
00:25:38,610 --> 00:25:42,090
deeper like what is this doing can I

674
00:25:40,860 --> 00:25:43,409
actually run this on my production

675
00:25:42,090 --> 00:25:46,230
environment and not freak everybody out

676
00:25:43,410 --> 00:25:47,970
you know and filtrate my own work you

677
00:25:46,230 --> 00:25:53,010
know place environment or a fancy

678
00:25:47,970 --> 00:25:55,130
barrier so the complex Maur here's what

679
00:25:53,010 --> 00:25:55,129
it does

680
00:26:06,780 --> 00:26:13,410
so the very first dropper is binder so

681
00:26:11,250 --> 00:26:15,300
when you're when the email comes in

682
00:26:13,410 --> 00:26:18,600
binders what's attached to the email

683
00:26:15,300 --> 00:26:21,389
okay so in binder lands and it runs then

684
00:26:18,600 --> 00:26:22,980
it creates two other files and actually

685
00:26:21,390 --> 00:26:25,560
a content actually gets dropped as a

686
00:26:22,980 --> 00:26:27,870
document file and then it also drops a

687
00:26:25,560 --> 00:26:30,870
PDF file right now the key to remember

688
00:26:27,870 --> 00:26:33,949
is the PDF file is actually a decoy file

689
00:26:30,870 --> 00:26:36,840
right so but this is the name of it

690
00:26:33,950 --> 00:26:38,580
rasca mos I'm sure mispronouncing

691
00:26:36,840 --> 00:26:40,409
because it's Russian the entire document

692
00:26:38,580 --> 00:26:42,810
is in Russian just so you guys know it's

693
00:26:40,410 --> 00:26:44,730
about the space program but it drops

694
00:26:42,810 --> 00:26:48,480
this file leaves it there it actually

695
00:26:44,730 --> 00:26:50,400
takes off the PDF extension which from

696
00:26:48,480 --> 00:26:55,020
what are my friends can tell um the CGI

697
00:26:50,400 --> 00:26:57,900
team that's for EDR evasion but content

698
00:26:55,020 --> 00:27:00,120
file all inside of binder it actually

699
00:26:57,900 --> 00:27:02,760
changes the permissions on content to

700
00:27:00,120 --> 00:27:04,260
then turn it into an executable file so

701
00:27:02,760 --> 00:27:06,330
leaves the PDF there it doesn't do

702
00:27:04,260 --> 00:27:08,310
anything with it going from the content

703
00:27:06,330 --> 00:27:09,840
file then it runs it right so all of

704
00:27:08,310 --> 00:27:11,340
this is still within binder binder is

705
00:27:09,840 --> 00:27:14,220
the initial process and then it's

706
00:27:11,340 --> 00:27:16,139
creating these guys so inside a binder

707
00:27:14,220 --> 00:27:19,430
it changes the permissions of content

708
00:27:16,140 --> 00:27:22,110
then launches content content in turn

709
00:27:19,430 --> 00:27:25,800
drops these three files it drops a plist

710
00:27:22,110 --> 00:27:29,280
file it drops a script and it also drops

711
00:27:25,800 --> 00:27:30,750
catch TD right ax TD is actually also a

712
00:27:29,280 --> 00:27:33,780
document file that then changes the

713
00:27:30,750 --> 00:27:36,380
permissions on and then that is actually

714
00:27:33,780 --> 00:27:40,980
the c2 agent for their complex smeller

715
00:27:36,380 --> 00:27:42,900
or their Amoco file then it takes this

716
00:27:40,980 --> 00:27:45,060
guy this plist file right which is just

717
00:27:42,900 --> 00:27:46,470
configuration file for a pro and then it

718
00:27:45,060 --> 00:27:49,919
takes this file and then it drops it

719
00:27:46,470 --> 00:27:51,780
inside of the users launch launch agents

720
00:27:49,920 --> 00:27:54,120
which is a normal autorun feature for

721
00:27:51,780 --> 00:27:57,480
apple and so every time that user logs

722
00:27:54,120 --> 00:28:01,590
in that's going to run all of this plist

723
00:27:57,480 --> 00:28:03,420
file does is literally takes this guy

724
00:28:01,590 --> 00:28:05,850
and run it and that's it it's not an

725
00:28:03,420 --> 00:28:08,760
executable in there it just takes catch

726
00:28:05,850 --> 00:28:11,480
TD and runs it and then this script

727
00:28:08,760 --> 00:28:15,960
actually loads this plist file as a

728
00:28:11,480 --> 00:28:19,200
service and then once all of this is

729
00:28:15,960 --> 00:28:20,429
done which it actually creates a

730
00:28:19,200 --> 00:28:23,309
directory inside of the you

731
00:28:20,429 --> 00:28:24,960
shareholder to drop all of these in once

732
00:28:23,309 --> 00:28:27,720
this is done it actually goes back to

733
00:28:24,960 --> 00:28:30,480
binder binder then takes that same PDF

734
00:28:27,720 --> 00:28:32,159
and then opens it up in preview so all

735
00:28:30,480 --> 00:28:34,529
this happens in like a matter of a

736
00:28:32,159 --> 00:28:38,090
second so you don't even realize that

737
00:28:34,529 --> 00:28:40,379
this binder executable you downloaded

738
00:28:38,090 --> 00:28:42,539
created a directory instead of your user

739
00:28:40,379 --> 00:28:45,840
shared folder drops these three files

740
00:28:42,539 --> 00:28:49,860
launches this plist file to then run

741
00:28:45,840 --> 00:28:52,619
this executable and then opens your PDF

742
00:28:49,860 --> 00:28:53,668
file for you so that's the process and

743
00:28:52,619 --> 00:28:55,199
the behaviors that we're going to

744
00:28:53,669 --> 00:28:57,269
emulate in the malware that we're

745
00:28:55,200 --> 00:29:00,210
creating right so in all of this what I

746
00:28:57,269 --> 00:29:02,519
did was I took a again high level right

747
00:29:00,210 --> 00:29:04,409
super-high level as I just ran it

748
00:29:02,519 --> 00:29:08,090
through a debugger I had a very specific

749
00:29:04,409 --> 00:29:10,049
safe environments I ran a Mac OS VM

750
00:29:08,090 --> 00:29:11,639
isolated it and then just ran this

751
00:29:10,049 --> 00:29:13,200
through a very like step by step

752
00:29:11,639 --> 00:29:15,360
debugger and then as the scripts were

753
00:29:13,200 --> 00:29:17,009
popped out I copied them over so that

754
00:29:15,360 --> 00:29:18,600
way I could actually look at the scripts

755
00:29:17,009 --> 00:29:19,919
see what was in them and then that way

756
00:29:18,600 --> 00:29:22,678
then I could read em you late them or

757
00:29:19,919 --> 00:29:24,529
even just use the same file which was

758
00:29:22,679 --> 00:29:27,360
kind of the point

759
00:29:24,529 --> 00:29:28,590
so recreating the work right so again

760
00:29:27,360 --> 00:29:30,928
we're trying to do this at a high level

761
00:29:28,590 --> 00:29:33,509
with minimal amounts of reverse

762
00:29:30,929 --> 00:29:37,499
engineering so the way I went about this

763
00:29:33,509 --> 00:29:40,860
was I took that same report which is

764
00:29:37,499 --> 00:29:44,159
this guy and then I just copied it over

765
00:29:40,860 --> 00:29:47,039
my code so fancy bear is really well

766
00:29:44,159 --> 00:29:49,710
known for taking public methods and then

767
00:29:47,039 --> 00:29:53,129
I'm like putting into their code which

768
00:29:49,710 --> 00:29:56,759
quite frankly we all do Stack Overflow

769
00:29:53,129 --> 00:29:59,879
is like half of my code and everything I

770
00:29:56,759 --> 00:30:04,080
do thank you for any contributors to

771
00:29:59,879 --> 00:30:05,820
Stack Overflow just saying so they're

772
00:30:04,080 --> 00:30:07,529
also not above this right there is a

773
00:30:05,820 --> 00:30:09,509
specific method even that one of the

774
00:30:07,529 --> 00:30:11,519
intelligence reports call out where

775
00:30:09,509 --> 00:30:13,830
they're like am I being debugged and on

776
00:30:11,519 --> 00:30:16,049
Apple's like developer website that is

777
00:30:13,830 --> 00:30:17,820
the function that you use if you want to

778
00:30:16,049 --> 00:30:20,789
properly find out if your program is

779
00:30:17,820 --> 00:30:22,439
being debugged or not so that's a

780
00:30:20,789 --> 00:30:23,460
pattern of behavior right like that was

781
00:30:22,440 --> 00:30:24,960
one of those things that we gathered

782
00:30:23,460 --> 00:30:26,850
from the collection part what are the

783
00:30:24,960 --> 00:30:28,559
patterns fancy bear has a great pattern

784
00:30:26,850 --> 00:30:30,899
of taking public code and then just

785
00:30:28,559 --> 00:30:32,399
copying and pasting so that's exactly

786
00:30:30,899 --> 00:30:34,139
what I did right because it's all about

787
00:30:32,399 --> 00:30:36,090
the fluidity of those motion

788
00:30:34,140 --> 00:30:37,980
right it's not about the exact science

789
00:30:36,090 --> 00:30:41,250
it's that's where the art form the

790
00:30:37,980 --> 00:30:45,150
emulation comes in so again I copied it

791
00:30:41,250 --> 00:30:46,860
to the code other things is the methods

792
00:30:45,150 --> 00:30:48,330
Objective C is actually really easy to

793
00:30:46,860 --> 00:30:50,250
find the methods by just doing a header

794
00:30:48,330 --> 00:30:52,320
file check so you can actually figure

795
00:30:50,250 --> 00:30:54,990
out all the methods or better yet just

796
00:30:52,320 --> 00:30:56,610
run strings on the executable and you'll

797
00:30:54,990 --> 00:30:58,860
be able to pull out all of that

798
00:30:56,610 --> 00:31:00,479
information which I will show you how I

799
00:30:58,860 --> 00:31:04,020
leverage that information for all the

800
00:31:00,480 --> 00:31:05,430
stuff I did not know the naming

801
00:31:04,020 --> 00:31:07,080
convention is another thing you'll be

802
00:31:05,430 --> 00:31:08,220
able to find a lot of those strings for

803
00:31:07,080 --> 00:31:10,699
the way that they named a lot of the

804
00:31:08,220 --> 00:31:15,180
executables inside of the strings file

805
00:31:10,700 --> 00:31:17,640
also there was a situation or mass

806
00:31:15,180 --> 00:31:19,080
situation there was when I was doing a

807
00:31:17,640 --> 00:31:20,850
lot of the research for this I reached

808
00:31:19,080 --> 00:31:23,010
out to a lot of my colleagues because

809
00:31:20,850 --> 00:31:25,679
this is again one of those things that I

810
00:31:23,010 --> 00:31:27,990
don't think I know anyone I mean ok

811
00:31:25,680 --> 00:31:29,820
there's a couple of like key leaders but

812
00:31:27,990 --> 00:31:32,280
almost every single person that I know

813
00:31:29,820 --> 00:31:34,320
like they didn't get to where they are

814
00:31:32,280 --> 00:31:36,090
by themselves like we all stand on the

815
00:31:34,320 --> 00:31:38,550
shoulders people that we work with and

816
00:31:36,090 --> 00:31:39,959
we surround ourselves with right which

817
00:31:38,550 --> 00:31:43,050
is which is what it's all about which is

818
00:31:39,960 --> 00:31:44,910
why this is a community and one of the

819
00:31:43,050 --> 00:31:46,530
things that he found was that there was

820
00:31:44,910 --> 00:31:50,130
and there was when we were talking about

821
00:31:46,530 --> 00:31:54,300
and this emulation and his his little

822
00:31:50,130 --> 00:31:57,150
malware analysis tool found a ac2 agent

823
00:31:54,300 --> 00:31:59,520
ands and it couldn't figure out if it

824
00:31:57,150 --> 00:32:02,370
was cobalt strike or if it was X agent

825
00:31:59,520 --> 00:32:04,230
and the reason why it was because a red

826
00:32:02,370 --> 00:32:07,020
sheep most likely a red team I'd taken

827
00:32:04,230 --> 00:32:09,600
this cobalt strike agent and then taken

828
00:32:07,020 --> 00:32:10,350
all the strings from X agent and then

829
00:32:09,600 --> 00:32:12,719
put it in there

830
00:32:10,350 --> 00:32:15,570
to make it look like it was fancy back

831
00:32:12,720 --> 00:32:17,490
right so little things like that will

832
00:32:15,570 --> 00:32:19,710
actually throw off a lot of other things

833
00:32:17,490 --> 00:32:21,720
that should be detecting right and it's

834
00:32:19,710 --> 00:32:23,910
just like another use case for like how

835
00:32:21,720 --> 00:32:24,380
you make it look like it's something

836
00:32:23,910 --> 00:32:28,080
else

837
00:32:24,380 --> 00:32:30,570
so network traffic we're not gonna have

838
00:32:28,080 --> 00:32:32,399
because again we're choosing to make

839
00:32:30,570 --> 00:32:33,870
like we're not creating a panel right

840
00:32:32,400 --> 00:32:36,900
like that's a whole another level

841
00:32:33,870 --> 00:32:41,340
that's like the right emulation 102 or

842
00:32:36,900 --> 00:32:44,880
202 so this is basically how I cheated

843
00:32:41,340 --> 00:32:46,789
so for those of you I could code and it

844
00:32:44,880 --> 00:32:50,570
would be amazing code and I can say that

845
00:32:46,789 --> 00:32:54,199
stage because I'm not gonna prove it but

846
00:32:50,570 --> 00:32:55,968
essentially all I did was I took this

847
00:32:54,199 --> 00:32:58,429
technical report sample right this is

848
00:32:55,969 --> 00:33:00,199
just screenshots from the the literally

849
00:32:58,429 --> 00:33:02,539
the stuff that I produced with fancy

850
00:33:00,199 --> 00:33:05,479
shadow boxes so it's not as a friend

851
00:33:02,539 --> 00:33:07,940
said earlier stock art I took the

852
00:33:05,479 --> 00:33:10,129
technical report and then I would do a

853
00:33:07,940 --> 00:33:11,959
strings analysis and then from the

854
00:33:10,129 --> 00:33:15,799
strings analysis I would then use my

855
00:33:11,959 --> 00:33:17,479
Google super power and then I would copy

856
00:33:15,799 --> 00:33:19,309
that into my code so that was literally

857
00:33:17,479 --> 00:33:21,499
the process for everything like one

858
00:33:19,309 --> 00:33:23,359
example of this is I could not and I

859
00:33:21,499 --> 00:33:25,429
haven't quite figured it out yet so

860
00:33:23,359 --> 00:33:27,349
you'll actually see this like there is a

861
00:33:25,429 --> 00:33:30,469
thing it's called done is better than

862
00:33:27,349 --> 00:33:32,779
perfect I'm a firm believer in it cuz

863
00:33:30,469 --> 00:33:34,519
like this is one of those things where

864
00:33:32,779 --> 00:33:36,949
that test and iterate part right in the

865
00:33:34,519 --> 00:33:38,389
agile lifecycle like you just get it

866
00:33:36,949 --> 00:33:39,859
done and get it working and then you can

867
00:33:38,389 --> 00:33:41,779
iterate on it and make it look better

868
00:33:39,859 --> 00:33:44,749
like that's what version control is all

869
00:33:41,779 --> 00:33:46,039
about so and this is basically how I've

870
00:33:44,749 --> 00:33:46,909
approached this problem right I'm not

871
00:33:46,039 --> 00:33:48,408
going to be able to do everything

872
00:33:46,909 --> 00:33:50,869
perfect on this and do it the exact same

873
00:33:48,409 --> 00:33:53,479
way but as I figure it out as I learn

874
00:33:50,869 --> 00:33:55,428
more I can emulate better and which is

875
00:33:53,479 --> 00:33:58,369
again the part why I love the whole art

876
00:33:55,429 --> 00:33:59,329
parallel to this so in this case I

877
00:33:58,369 --> 00:34:00,889
couldn't figure out how they were

878
00:33:59,329 --> 00:34:02,569
getting the data in I have a couple

879
00:34:00,889 --> 00:34:03,708
suspicions still working on it with my

880
00:34:02,569 --> 00:34:06,379
colleagues trying to figure that out

881
00:34:03,709 --> 00:34:08,450
perfectly has something to do with like

882
00:34:06,379 --> 00:34:12,589
nsdictionary but I haven't gotten it

883
00:34:08,449 --> 00:34:15,078
working yet but a workaround is like

884
00:34:12,589 --> 00:34:17,418
okay I don't know how to use this really

885
00:34:15,079 --> 00:34:19,519
stupid function so if anyone wants like

886
00:34:17,418 --> 00:34:22,668
to tweet me on like how to we can get

887
00:34:19,518 --> 00:34:24,709
that working I am open to it so a

888
00:34:22,668 --> 00:34:26,868
workaround of that was how do I read

889
00:34:24,710 --> 00:34:28,759
this these files write these executables

890
00:34:26,869 --> 00:34:29,990
into my program so that way I can

891
00:34:28,759 --> 00:34:31,969
emulate all the other behaviors because

892
00:34:29,989 --> 00:34:34,609
I have all the code now I just need to

893
00:34:31,969 --> 00:34:37,219
be able to have it do it so especially

894
00:34:34,609 --> 00:34:38,869
make it flexible to where I can just run

895
00:34:37,219 --> 00:34:40,308
this in xcode compile it and then be

896
00:34:38,869 --> 00:34:42,829
done and have my own executable that

897
00:34:40,309 --> 00:34:44,720
does the exact same thing so i use the

898
00:34:42,829 --> 00:34:47,299
strings analysis and there's this data

899
00:34:44,719 --> 00:34:49,609
with contents of URL so I took this

900
00:34:47,299 --> 00:34:52,009
function specifically looked it up on

901
00:34:49,609 --> 00:34:54,409
this lovely blog that gives me a perfect

902
00:34:52,009 --> 00:34:56,029
code example and then that is now my

903
00:34:54,409 --> 00:34:57,589
code and then I just changed the strings

904
00:34:56,029 --> 00:34:59,509
to match what they already provided in

905
00:34:57,589 --> 00:35:00,799
the technical report so this is

906
00:34:59,509 --> 00:35:03,110
essentially

907
00:35:00,800 --> 00:35:04,790
kind of how I iterated through every

908
00:35:03,110 --> 00:35:06,080
single problem so because there's a lot

909
00:35:04,790 --> 00:35:07,460
of them right like all the code they

910
00:35:06,080 --> 00:35:09,529
released they intentionally don't

911
00:35:07,460 --> 00:35:10,490
release all of the source code so

912
00:35:09,530 --> 00:35:12,470
there's going to be things that I'm

913
00:35:10,490 --> 00:35:14,779
gonna have to figure out but that is

914
00:35:12,470 --> 00:35:16,939
essentially like the process and how I

915
00:35:14,780 --> 00:35:19,160
figured it out like step by step right

916
00:35:16,940 --> 00:35:20,540
like I started with content and then I

917
00:35:19,160 --> 00:35:22,100
worked through content like how can I

918
00:35:20,540 --> 00:35:24,400
get this running on my host like I

919
00:35:22,100 --> 00:35:26,509
loaded up an Xcode project because

920
00:35:24,400 --> 00:35:27,560
because it's a code and apparently

921
00:35:26,510 --> 00:35:29,870
that's not like that works with Apple

922
00:35:27,560 --> 00:35:31,520
the most part so I loaded up my Xcode

923
00:35:29,870 --> 00:35:33,470
project and I dropped everything in and

924
00:35:31,520 --> 00:35:36,170
then I literally went line by line okay

925
00:35:33,470 --> 00:35:38,209
how to declare string in objective-c

926
00:35:36,170 --> 00:35:39,710
then how do you declare this type of

927
00:35:38,210 --> 00:35:42,320
object and then I'll work through that

928
00:35:39,710 --> 00:35:44,420
process there's a couple of things to

929
00:35:42,320 --> 00:35:46,310
note I will be releasing a technical

930
00:35:44,420 --> 00:35:47,930
walkthrough like line by line on how I

931
00:35:46,310 --> 00:35:49,520
did this like to include like these are

932
00:35:47,930 --> 00:35:51,680
the compiler flags that you need to add

933
00:35:49,520 --> 00:35:53,810
to your Xcode project right to make sure

934
00:35:51,680 --> 00:35:56,240
a RC is not running so that way you can

935
00:35:53,810 --> 00:35:58,580
actually compile this there's a lot of

936
00:35:56,240 --> 00:36:00,169
little tricky things that I found going

937
00:35:58,580 --> 00:36:03,500
through this process so I will release

938
00:36:00,170 --> 00:36:04,820
that um it's just it takes time to write

939
00:36:03,500 --> 00:36:11,180
those things up and write them up well

940
00:36:04,820 --> 00:36:13,880
so the test in there a part is fun again

941
00:36:11,180 --> 00:36:15,950
as I was going through this process like

942
00:36:13,880 --> 00:36:18,050
it's not this streamlined simple thing

943
00:36:15,950 --> 00:36:20,600
um the framework was really important to

944
00:36:18,050 --> 00:36:23,630
me because I get lost super easy in code

945
00:36:20,600 --> 00:36:25,279
and that's good like I want to get lost

946
00:36:23,630 --> 00:36:27,500
in code right like that means that I'm

947
00:36:25,280 --> 00:36:30,050
super into it I'm following on those

948
00:36:27,500 --> 00:36:33,680
rabbit holes and I'm I'm doing all the

949
00:36:30,050 --> 00:36:34,880
things but when I come back up for air I

950
00:36:33,680 --> 00:36:36,560
always need to be able to figure out

951
00:36:34,880 --> 00:36:38,720
like okay what's next it's a lot of

952
00:36:36,560 --> 00:36:40,220
times I'll forget that so the test and

953
00:36:38,720 --> 00:36:43,009
iterate is a part of that process right

954
00:36:40,220 --> 00:36:44,450
that is that lifecycle of agile so as I

955
00:36:43,010 --> 00:36:46,370
was going through this it'd be like okay

956
00:36:44,450 --> 00:36:47,990
what are the methods that I miss and

957
00:36:46,370 --> 00:36:49,759
then I had run strings and then I

958
00:36:47,990 --> 00:36:51,799
compared both of the executables like

959
00:36:49,760 --> 00:36:53,330
all right I've got content working how

960
00:36:51,800 --> 00:36:55,220
what is content doing different is it

961
00:36:53,330 --> 00:36:58,480
loading a file in a different order like

962
00:36:55,220 --> 00:37:01,520
like how do I compare these similarities

963
00:36:58,480 --> 00:37:04,370
so for me this is that was the process a

964
00:37:01,520 --> 00:37:07,400
neat thing and a parallel with art is

965
00:37:04,370 --> 00:37:10,640
that there is no known detection for art

966
00:37:07,400 --> 00:37:14,270
forgery to guarantee something is not a

967
00:37:10,640 --> 00:37:15,980
fake so that also kind of goes like

968
00:37:14,270 --> 00:37:18,940
I don't know anyone that said like it's

969
00:37:15,980 --> 00:37:18,940
there it's literally

970
00:37:23,980 --> 00:37:29,040
and joke in our community it's

971
00:37:26,380 --> 00:37:31,750
unhackable it's literally a joke and

972
00:37:29,040 --> 00:37:34,569
there are pen test groups that go after

973
00:37:31,750 --> 00:37:35,619
everything that is unhackable so I

974
00:37:34,569 --> 00:37:39,369
always thought that was a really cool

975
00:37:35,619 --> 00:37:43,119
cool parallel but to drive this point

976
00:37:39,369 --> 00:37:44,290
home is that even as we get better at

977
00:37:43,119 --> 00:37:45,970
threat emulation so there's otter

978
00:37:44,290 --> 00:37:46,509
detection right so what does that mean

979
00:37:45,970 --> 00:37:49,569
for us

980
00:37:46,510 --> 00:37:51,579
well usually that means we get better

981
00:37:49,569 --> 00:37:52,990
too and then we do this attendant we

982
00:37:51,579 --> 00:37:55,869
have this game right the blood blue team

983
00:37:52,990 --> 00:37:57,640
game what's neat about Eric Hebburn

984
00:37:55,869 --> 00:38:03,700
which is this is the art forger I was

985
00:37:57,640 --> 00:38:05,828
talking about earlier was he sold his

986
00:38:03,700 --> 00:38:07,299
sketches his sketches then got sold to a

987
00:38:05,829 --> 00:38:09,010
museum actually he didn't sell his

988
00:38:07,299 --> 00:38:10,750
sketches he gave it to his friend his

989
00:38:09,010 --> 00:38:13,359
friends sold his sketches to a gallery

990
00:38:10,750 --> 00:38:16,480
the gallery sold his sketches to a

991
00:38:13,359 --> 00:38:19,690
museum the museum curator was like this

992
00:38:16,480 --> 00:38:22,450
is not real and I know it's not real cuz

993
00:38:19,690 --> 00:38:26,049
I tested the paper so then the curator

994
00:38:22,450 --> 00:38:27,819
is like you know what I'm amazing I need

995
00:38:26,049 --> 00:38:29,740
to tell the world about this so he went

996
00:38:27,819 --> 00:38:32,319
on national television was like I found

997
00:38:29,740 --> 00:38:35,348
a forger you know how I did it the paper

998
00:38:32,319 --> 00:38:38,650
the paper was up to date so it couldn't

999
00:38:35,349 --> 00:38:40,770
be this artist it must be a forgery so

1000
00:38:38,650 --> 00:38:44,049
guess what happened next

1001
00:38:40,770 --> 00:38:45,759
Eric went out found all the dictionaries

1002
00:38:44,049 --> 00:38:47,470
from that time period that he was

1003
00:38:45,760 --> 00:38:51,880
emulating and then did all of his

1004
00:38:47,470 --> 00:38:54,399
drawings on the paper so again that cone

1005
00:38:51,880 --> 00:38:56,440
of silence right like there like as we

1006
00:38:54,400 --> 00:38:59,890
disclose this information on how we do

1007
00:38:56,440 --> 00:39:02,950
detection we do it publicly like that

1008
00:38:59,890 --> 00:39:06,910
also allows our adversaries then also

1009
00:39:02,950 --> 00:39:08,799
get better so and then there's the red

1010
00:39:06,910 --> 00:39:10,420
team operation right this is again

1011
00:39:08,799 --> 00:39:11,619
another fun part like don't think there

1012
00:39:10,420 --> 00:39:15,339
really is anything not fun about this

1013
00:39:11,619 --> 00:39:17,140
entire process but this is so again the

1014
00:39:15,339 --> 00:39:19,420
idea this talk was for that defender

1015
00:39:17,140 --> 00:39:21,520
that's like super like wow how does this

1016
00:39:19,420 --> 00:39:23,140
work like how what does this look like

1017
00:39:21,520 --> 00:39:24,309
on the other end like I know it looks

1018
00:39:23,140 --> 00:39:25,930
like I'm this in but am i catching

1019
00:39:24,309 --> 00:39:28,089
everything like what am I missing

1020
00:39:25,930 --> 00:39:29,919
so this is the part where I don't care

1021
00:39:28,089 --> 00:39:33,640
whether it's a rubber ducky or a fash

1022
00:39:29,920 --> 00:39:35,230
bunny or a email whatever vector you

1023
00:39:33,640 --> 00:39:37,720
want to pick whatever vector makes sense

1024
00:39:35,230 --> 00:39:40,570
for your environment right this is where

1025
00:39:37,720 --> 00:39:42,669
right that that defender can go and then

1026
00:39:40,570 --> 00:39:45,280
actually emulate like drop this

1027
00:39:42,670 --> 00:39:48,520
executable this binder executable that's

1028
00:39:45,280 --> 00:39:50,609
got our Empire payload or situ agent in

1029
00:39:48,520 --> 00:39:53,470
it and then drop it on the host in

1030
00:39:50,609 --> 00:39:55,330
production environments knows what it

1031
00:39:53,470 --> 00:39:56,770
does knows every single ounce of that

1032
00:39:55,330 --> 00:39:58,480
code right because we've already gone

1033
00:39:56,770 --> 00:40:00,640
through this process and then be able to

1034
00:39:58,480 --> 00:40:03,220
see what did my host catch what did my

1035
00:40:00,640 --> 00:40:05,470
sim catch what did my my EDR detection

1036
00:40:03,220 --> 00:40:08,490
catch watching the logs and then being

1037
00:40:05,470 --> 00:40:10,810
able to iterate through that process and

1038
00:40:08,490 --> 00:40:13,089
again then we go back to the right team

1039
00:40:10,810 --> 00:40:14,410
side where it's the living in the gray

1040
00:40:13,090 --> 00:40:17,380
right like these are the actions that

1041
00:40:14,410 --> 00:40:19,868
we're doing on the host looking at the

1042
00:40:17,380 --> 00:40:22,450
chrome all the the cookies and the

1043
00:40:19,869 --> 00:40:25,690
chrome files and the backup databases

1044
00:40:22,450 --> 00:40:27,609
like looking for the key chain that all

1045
00:40:25,690 --> 00:40:31,480
of the different methods that we've

1046
00:40:27,609 --> 00:40:33,580
discussed briefly um as the actions on

1047
00:40:31,480 --> 00:40:34,930
the objectives which as you do this

1048
00:40:33,580 --> 00:40:36,790
process and you find these patterns

1049
00:40:34,930 --> 00:40:37,810
you'll find that a lot of things you'll

1050
00:40:36,790 --> 00:40:39,250
emulate will be based off of

1051
00:40:37,810 --> 00:40:40,270
conversations they'll be based off of

1052
00:40:39,250 --> 00:40:42,310
generalities

1053
00:40:40,270 --> 00:40:44,410
but they'll all be to the point because

1054
00:40:42,310 --> 00:40:45,460
the reality is what's the goal in the

1055
00:40:44,410 --> 00:40:47,440
environment right what are you trying to

1056
00:40:45,460 --> 00:40:50,880
get after so and then there's your

1057
00:40:47,440 --> 00:40:54,310
detection stand up to the test of that

1058
00:40:50,880 --> 00:40:56,400
so when I was traveling around to a lot

1059
00:40:54,310 --> 00:40:58,570
of these these different conferences

1060
00:40:56,400 --> 00:41:03,760
there's some brilliant people on our

1061
00:40:58,570 --> 00:41:06,250
fields and and I loved that there was so

1062
00:41:03,760 --> 00:41:07,990
much talent that there was always

1063
00:41:06,250 --> 00:41:10,660
something new to play with it is awesome

1064
00:41:07,990 --> 00:41:14,529
but for me that can't be the definition

1065
00:41:10,660 --> 00:41:15,940
of success I'm not that good yet there's

1066
00:41:14,530 --> 00:41:18,790
a lot of people out there that I like to

1067
00:41:15,940 --> 00:41:20,290
compare myself to hmm not there yet I am

1068
00:41:18,790 --> 00:41:22,390
still new in this field I still got a

1069
00:41:20,290 --> 00:41:24,990
lot to learn so for me I needed to

1070
00:41:22,390 --> 00:41:27,279
define a different definition of success

1071
00:41:24,990 --> 00:41:30,069
which is again why I like the art and

1072
00:41:27,280 --> 00:41:32,410
that definition for me was getting good

1073
00:41:30,070 --> 00:41:35,109
enough to be able to emulate a

1074
00:41:32,410 --> 00:41:37,180
nation-state or a different actor of my

1075
00:41:35,109 --> 00:41:38,890
choosing and could you tell the

1076
00:41:37,180 --> 00:41:40,450
difference between me and them and then

1077
00:41:38,890 --> 00:41:42,009
when I got really good at that actor

1078
00:41:40,450 --> 00:41:44,950
doing a false-flag

1079
00:41:42,010 --> 00:41:46,900
ok I'm done with Russia now what do I

1080
00:41:44,950 --> 00:41:49,899
look like if I'm Korea now that I'm

1081
00:41:46,900 --> 00:41:51,400
Korea what do I look like if I'm China

1082
00:41:49,900 --> 00:41:52,480
right and then war

1083
00:41:51,400 --> 00:41:53,200
you through the different countries

1084
00:41:52,480 --> 00:41:55,510
because they all use different

1085
00:41:53,200 --> 00:41:59,680
techniques and that kind of allows my

1086
00:41:55,510 --> 00:42:01,270
own knowledge in my own depth of ability

1087
00:41:59,680 --> 00:42:03,250
and technical skill to be able to expand

1088
00:42:01,270 --> 00:42:04,720
as well so for me that's kind of how

1089
00:42:03,250 --> 00:42:08,440
I've defined my own version of success

1090
00:42:04,720 --> 00:42:09,939
versus I found three of the latest

1091
00:42:08,440 --> 00:42:13,180
exploits that are released out now like

1092
00:42:09,940 --> 00:42:15,579
I'm not there but I can make sure that

1093
00:42:13,180 --> 00:42:17,470
my skill set is up there where I can do

1094
00:42:15,579 --> 00:42:19,900
a like so which which country I'm going

1095
00:42:17,470 --> 00:42:22,140
to be from on what day and can you tell

1096
00:42:19,900 --> 00:42:22,140
the difference

1097
00:42:22,319 --> 00:42:27,099
cost is a huge thing especially with

1098
00:42:24,940 --> 00:42:28,450
small things so I did want to go over

1099
00:42:27,099 --> 00:42:31,990
this because again starving artists

1100
00:42:28,450 --> 00:42:34,569
budget this cost so they this cost me

1101
00:42:31,990 --> 00:42:36,549
personally a lot of money cuz I was

1102
00:42:34,569 --> 00:42:39,490
trying to like figure out how much to do

1103
00:42:36,549 --> 00:42:42,369
with it um the environment set up in and

1104
00:42:39,490 --> 00:42:46,720
of itself was a pain because there's not

1105
00:42:42,369 --> 00:42:50,140
many iOS images for a Mac so what I will

1106
00:42:46,720 --> 00:42:53,259
be doing is I will be releasing in iOS

1107
00:42:50,140 --> 00:42:54,910
image probably next week for a Mac on my

1108
00:42:53,260 --> 00:42:56,020
key day so I'll be like an OVA file so

1109
00:42:54,910 --> 00:42:57,190
that way you all can download it because

1110
00:42:56,020 --> 00:42:59,859
I was one of the biggest issues and

1111
00:42:57,190 --> 00:43:01,569
trying to run this in VirtualBox so I

1112
00:42:59,859 --> 00:43:05,049
needed to have an OVA file so I had to

1113
00:43:01,569 --> 00:43:06,970
get vmware so the full price of how much

1114
00:43:05,049 --> 00:43:10,750
this cost me was essentially the bottom

1115
00:43:06,970 --> 00:43:12,459
one to be able to run Mac OS mac OS

1116
00:43:10,750 --> 00:43:15,160
doesn't actually support the guest VMs

1117
00:43:12,460 --> 00:43:17,349
so you have to have it is under the

1118
00:43:15,160 --> 00:43:20,680
license agreement that you should use a

1119
00:43:17,349 --> 00:43:24,579
Mac computer or an Apple computer so

1120
00:43:20,680 --> 00:43:29,500
with that said another thing that I will

1121
00:43:24,579 --> 00:43:31,180
also point out is friends like this

1122
00:43:29,500 --> 00:43:33,039
again this couldn't be done without all

1123
00:43:31,180 --> 00:43:34,509
of the people that are here like I can't

1124
00:43:33,039 --> 00:43:37,329
tell you how many slack channels I'll

1125
00:43:34,510 --> 00:43:40,839
just be like what is this and then like

1126
00:43:37,329 --> 00:43:42,309
five people reply and because we're all

1127
00:43:40,839 --> 00:43:43,720
curious right that's one of the coolest

1128
00:43:42,309 --> 00:43:46,660
things about this community like we're

1129
00:43:43,720 --> 00:43:48,669
all like hmm what is that like hold on

1130
00:43:46,660 --> 00:43:50,200
let me see if I can get that to work

1131
00:43:48,670 --> 00:43:52,029
like at dinner last night I was trying

1132
00:43:50,200 --> 00:43:54,788
to get figure out this file on like two

1133
00:43:52,029 --> 00:43:56,349
three people were like hmm I think I can

1134
00:43:54,789 --> 00:43:58,210
fix this and like we have our computer

1135
00:43:56,349 --> 00:44:00,010
like why are we doing this at dinner you

1136
00:43:58,210 --> 00:44:02,140
know like but that's the way we work and

1137
00:44:00,010 --> 00:44:04,420
it's awesome it makes me feel so

1138
00:44:02,140 --> 00:44:05,109
connected to this community so but

1139
00:44:04,420 --> 00:44:06,700
essentially

1140
00:44:05,110 --> 00:44:09,520
this is pretty reasonable for a small

1141
00:44:06,700 --> 00:44:11,770
small company I will be released an ISO

1142
00:44:09,520 --> 00:44:13,240
image Monday same with all of the code

1143
00:44:11,770 --> 00:44:15,610
because I actually created it's actually

1144
00:44:13,240 --> 00:44:18,220
two separate Xcode projects that then

1145
00:44:15,610 --> 00:44:21,340
get compiled into one for the binder so

1146
00:44:18,220 --> 00:44:22,990
I'll really set next week also I would

1147
00:44:21,340 --> 00:44:28,510
be doing the technical walkthrough just

1148
00:44:22,990 --> 00:44:31,330
a lot of a lot of a lot of words words

1149
00:44:28,510 --> 00:44:33,460
are hard so I'll be releasing that

1150
00:44:31,330 --> 00:44:37,140
probably November issue when I finally

1151
00:44:33,460 --> 00:44:37,140
have get on around a time so

