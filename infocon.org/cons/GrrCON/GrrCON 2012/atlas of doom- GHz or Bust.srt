1
00:00:00,099 --> 00:00:05,080
I

2
00:00:05,080 --> 00:00:10,480
welcome

3
00:00:10,480 --> 00:00:17,480
alice is doom first

4
00:00:18,050 --> 00:00:21,109
very for sites concise introduction

5
00:00:21,109 --> 00:00:24,970
alright we have had

6
00:00:24,970 --> 00:00:31,970
technical breakthrough so I see the term
I crowd is significantly less than Kevin

7
00:00:35,620 --> 00:00:36,579
Johnson's crown

8
00:00:36,579 --> 00:00:40,530
that's okay lot of people don't don't
overlap much interest

9
00:00:40,530 --> 00:00:43,219
a

10
00:00:43,219 --> 00:00:48,179
us to kinda

11
00:00:48,179 --> 00:00:53,510
putting on my Atlas happy again this is
jarring trying to be Kevin first

12
00:00:53,510 --> 00:00:58,050
oh yeah that's right we're gonna talk
about

13
00:00:58,050 --> 00:01:01,789
sub-crater hurts Wireless New Years ever
use

14
00:01:01,789 --> 00:01:05,239
some radio thing that lives in the sub
bigger trench

15
00:01:05,239 --> 00:01:08,939
those are you were informed

16
00:01:08,939 --> 00:01:15,440
everybody else should have their hands
up your volume no not being a jerk

17
00:01:15,440 --> 00:01:18,789
just is true wat you'll see it's fun

18
00:01:18,789 --> 00:01:22,619
so this started out

19
00:01:22,619 --> 00:01:26,080
back its Yukon with the talk about

20
00:01:26,080 --> 00:01:30,110
some beers radio how it works and how to
play with it

21
00:01:30,110 --> 00:01:33,500
it became a project

22
00:01:33,500 --> 00:01:36,729
that is extensible for your own magic
but is

23
00:01:36,729 --> 00:01:39,929
pretty magical in and of itself thanks
due to

24
00:01:39,929 --> 00:01:44,200
a lot of help from some amazing people
if you

25
00:01:44,200 --> 00:01:47,859
you wanna put a tag line on my grave it
is that I'm very good surrounding myself

26
00:01:47,859 --> 00:01:48,960
with growing folk

27
00:01:48,960 --> 00:01:55,079
um

28
00:01:55,079 --> 00:01:58,810
here's the trick the magical today's
talk

29
00:01:58,810 --> 00:02:02,539
is that we get fast-forward a given

30
00:02:02,539 --> 00:02:06,170
just talkin 3 other venues in different
formats

31
00:02:06,170 --> 00:02:09,450
with different information as the
project's grown as the information's

32
00:02:09,450 --> 00:02:09,899
grown

33
00:02:09,899 --> 00:02:14,370
and I've yet to complete it it really is
about a two-and-a-half-hour talker if

34
00:02:14,370 --> 00:02:15,850
you want to work in exercises

35
00:02:15,850 --> 00:02:19,459
%uh it's a one- or two-day class and I'm
actually putting

36
00:02:19,459 --> 00:02:23,660
putting together a class for black next
year for their proposal

37
00:02:23,660 --> 00:02:28,000
so what we're gonna do is we're going to
fast forward

38
00:02:28,000 --> 00:02:33,750
and I i scan this last night and I
thought I can actually kept

39
00:02:33,750 --> 00:02:37,890
cut this talk in half and give the
second half and not actually lose

40
00:02:37,890 --> 00:02:41,209
anything it's a level of capabilities
difference

41
00:02:41,209 --> 00:02:45,310
the first half is about radio it's about
how it works

42
00:02:45,310 --> 00:02:50,840
how to do things with RF cat by
extending it doing code development

43
00:02:50,840 --> 00:02:54,349
there are slides and videos have that
given three times already

44
00:02:54,349 --> 00:02:58,750
for the first time is really sucky in in
the video cut off is that

45
00:02:58,750 --> 00:03:02,349
so but def Khan and black had both have

46
00:03:02,349 --> 00:03:06,440
that talk we're going to get to complete
the talk

47
00:03:06,440 --> 00:03:09,670
and talk about how to actually play with

48
00:03:09,670 --> 00:03:14,180
RF cat the slides will be available on
going to have

49
00:03:14,180 --> 00:03:17,629
all love the slides available so if you
want to go back and look through the

50
00:03:17,629 --> 00:03:18,230
slides

51
00:03:18,230 --> 00:03:22,430
they're all there too there's value what
place in the sub ita hurts range this is

52
00:03:22,430 --> 00:03:23,650
a slight do not want to skip

53
00:03:23,650 --> 00:03:26,950
everything your cell phones

54
00:03:26,950 --> 00:03:30,450
very likely live in the suburbs hurts
range or

55
00:03:30,450 --> 00:03:33,549
split between 800 900 megahertz

56
00:03:33,549 --> 00:03:38,590
and 1.8 1.9 gigahertz your

57
00:03:38,590 --> 00:03:43,930
cordless phones you probably don't have
a 900 megahertz phone anymore but they

58
00:03:43,930 --> 00:03:45,299
have been a huge

59
00:03:45,299 --> 00:03:49,799
and I like a better because they don't
interfere with WiFi car remotes

60
00:03:49,799 --> 00:03:52,980
you've got a 433

61
00:03:52,980 --> 00:03:56,430
315 they they love these Rangers depends
on where you're at the world

62
00:03:56,430 --> 00:04:01,180
pic I am ease Atta girl texting Tor

63
00:04:01,180 --> 00:04:04,659
that we like to hack I got a firmware
for that that

64
00:04:04,659 --> 00:04:07,689
we're gonna talk about labor medical
devices

65
00:04:07,689 --> 00:04:11,629
medical devices have their own range set
aside for them but they live everywhere

66
00:04:11,629 --> 00:04:15,030
power meters

67
00:04:15,030 --> 00:04:18,349
whoever wanna know about that

68
00:04:18,349 --> 00:04:23,169
all TV broadcast lives under severe
hurts range and much much more

69
00:04:23,169 --> 00:04:27,010
this is the Wild West we all know about
wifi we all know about

70
00:04:27,010 --> 00:04:30,510
I WiMAX somewhat these are standards

71
00:04:30,510 --> 00:04:33,580
that use a particular band for a whole
buncha stuff

72
00:04:33,580 --> 00:04:37,110
some bigger hurts us to have a whole lot
of

73
00:04:37,110 --> 00:04:41,260
standardized communications over there
are standards

74
00:04:41,260 --> 00:04:44,890
and some people claim to adhere to them
but they're wild wild west the

75
00:04:44,890 --> 00:04:50,680
they don't implement anything in
particular so how do we play with that

76
00:04:50,680 --> 00:04:54,570
I my solution is called Orica

77
00:04:54,570 --> 00:04:58,330
it started a few years back I get into
the history just a few slides

78
00:04:58,330 --> 00:05:01,950
bytes

79
00:05:01,950 --> 00:05:08,000
we will be talking largely about RF cat
today to cut 1111 or the 1101 radio

80
00:05:08,000 --> 00:05:15,000
is the generic way of saying RF cat only
without the software peace

81
00:05:17,060 --> 00:05:21,390
why do we care well because I think that
there's probably enough energy can this

82
00:05:21,390 --> 00:05:22,060
ring to

83
00:05:22,060 --> 00:05:26,089
fill an entire classroom love

84
00:05:26,089 --> 00:05:33,089
rocket science geniuses and still win

85
00:05:34,110 --> 00:05:38,360
and now

86
00:05:38,360 --> 00:05:45,360
to the fun part

87
00:05:46,240 --> 00:05:50,949
so are a kak it stands for the radio
frequency

88
00:05:50,949 --> 00:05:54,570
chip conn.-based attack tool I just like
the name

89
00:05:54,570 --> 00:05:58,280
been a net cafe in for years you might
think of this as a

90
00:05:58,280 --> 00:06:03,830
secure its radio redirector if you will
talk a little bit about the background

91
00:06:03,830 --> 00:06:06,360
the goals plans and some other stuff
that we've done

92
00:06:06,360 --> 00:06:09,750
I was

93
00:06:09,750 --> 00:06:14,380
working for some powerful people in the
power industry for about three years

94
00:06:14,380 --> 00:06:20,789
and a the said to me that my task was to
a

95
00:06:20,789 --> 00:06:25,419
hacked the snot out of power equipment
before we stick in the field so that

96
00:06:25,419 --> 00:06:31,030
were not causing what amounts to
basically a compromise the change the

97
00:06:31,030 --> 00:06:32,210
face the Western world

98
00:06:32,210 --> 00:06:37,270
and be scare the shit outta the vendor
so that they get proactive about it

99
00:06:37,270 --> 00:06:37,960
because they were

100
00:06:37,960 --> 00:06:41,120
of so

101
00:06:41,120 --> 00:06:45,130
in my early times with the power work I
went to

102
00:06:45,130 --> 00:06:48,669
power industry a conference called
distributor very common

103
00:06:48,669 --> 00:06:52,220
I I got to speak with some other vendors
that

104
00:06:52,220 --> 00:06:55,240
summer which I was going to be testing
in some which didn't make the cut

105
00:06:55,240 --> 00:06:59,550
even to try testing and some other
vendors I won't tell you which camp they

106
00:06:59,550 --> 00:07:00,340
ended up in

107
00:07:00,340 --> 00:07:04,270
but one of the vendors had a
conversation with me where they said

108
00:07:04,270 --> 00:07:07,620
our frequency hopping spread spectrum
radio

109
00:07:07,620 --> 00:07:14,240
is too fast for hackers to hack I still
stew

110
00:07:14,240 --> 00:07:18,930
on the levels and quantity of stupid in
that statement

111
00:07:18,930 --> 00:07:22,190
2010 that were stupid thing is is

112
00:07:22,190 --> 00:07:26,370
you're right

113
00:07:26,370 --> 00:07:30,360
let's put a challenge out there and then
leave it and

114
00:07:30,360 --> 00:07:33,770
the second stupid is hacking has nothing
to do

115
00:07:33,770 --> 00:07:37,370
well the larger hacking has little to do
with

116
00:07:37,370 --> 00:07:42,110
just taking over your communication but
if you're gonna make it very easy

117
00:07:42,110 --> 00:07:48,259
will rise to that bar problem was

118
00:07:48,259 --> 00:07:51,919
the really wasn't any attack tools at
the time

119
00:07:51,919 --> 00:07:56,130
that made this easy so in my team
actually the

120
00:07:56,130 --> 00:07:59,460
we worked really hard with some various

121
00:07:59,460 --> 00:08:03,550
tools to get to the level where we could
prove their stupidity

122
00:08:03,550 --> 00:08:10,279
just a start the assessment and so when
I put together are afk at the intention

123
00:08:10,279 --> 00:08:10,849
was

124
00:08:10,849 --> 00:08:16,000
something that does not have power
meters out the gate

125
00:08:16,000 --> 00:08:19,969
but certainly can and the idea is

126
00:08:19,969 --> 00:08:23,289
for the people who were in the industry
doing good work

127
00:08:23,289 --> 00:08:26,820
to have a base where they have to
stretch just a little bit

128
00:08:26,820 --> 00:08:30,659
to get something that will allow them to
test the security

129
00:08:30,659 --> 00:08:34,159
I don't wanna lose power I'm very
dependent upon it

130
00:08:34,159 --> 00:08:37,199
but therein lies the rub

131
00:08:37,199 --> 00:08:40,669
so there's a bit over

132
00:08:40,669 --> 00:08:44,520
there how does this work that went into
building RF cat

133
00:08:44,520 --> 00:08:48,410
I'm very interesting radio I've loved it
since I was 5 years old I learned about

134
00:08:48,410 --> 00:08:48,810
it

135
00:08:48,810 --> 00:08:53,079
I but I really didn't do a whole lot
with we did some wifi stuff we did

136
00:08:53,079 --> 00:08:57,420
you know kismet and all that stuff in
the day and you know we've had some

137
00:08:57,420 --> 00:09:01,250
I've had some fun with some radio things
but they're it's always been a

138
00:09:01,250 --> 00:09:06,240
you know if I could do this more a
better could find some stuff to

139
00:09:06,240 --> 00:09:11,070
to break that also

140
00:09:11,070 --> 00:09:14,709
security analysis tools

141
00:09:14,709 --> 00:09:18,380
to let's let's break into it and show to
make better

142
00:09:18,380 --> 00:09:22,620
right you know I love breaking things
and I'm not always the white hat let's

143
00:09:22,620 --> 00:09:26,490
let's publish everything that's that's
working everything but in this regard

144
00:09:26,490 --> 00:09:30,250
the better we can make up our system the
better my life

145
00:09:30,250 --> 00:09:35,640
will be also just satiate my general
love radio frequency

146
00:09:35,640 --> 00:09:38,640
I'm there was a

147
00:09:38,640 --> 00:09:42,440
when the earliest hacking stories

148
00:09:42,440 --> 00:09:45,600
comes from but 1903

149
00:09:45,600 --> 00:09:49,070
when marconi

150
00:09:49,070 --> 00:09:53,060
guys probably heard that name before
still a business today very big in the

151
00:09:53,060 --> 00:09:54,110
in the radio

152
00:09:54,110 --> 00:09:58,000
world but Guiliano

153
00:09:58,000 --> 00:10:03,030
honey marconi was giving a demonstration
of his

154
00:10:03,030 --> 00:10:06,550
we might call a virtual private radio
cuz he was

155
00:10:06,550 --> 00:10:09,839
selling the fact that he could tune
radios

156
00:10:09,839 --> 00:10:16,310
to a certain frequency and only other
radios tuned at that frequency

157
00:10:16,310 --> 00:10:21,790
could be listen or take part in a
conversation

158
00:10:21,790 --> 00:10:25,280
there was a big deal in 1903 the ability
to radios has

159
00:10:25,280 --> 00:10:29,970
jumped huge amount since then but he was
sitting

160
00:10:29,970 --> 00:10:33,930
at the top of a mountain with his
transmitter

161
00:10:33,930 --> 00:10:37,530
and his assistant were sitting in a
crowd not unlike this one

162
00:10:37,530 --> 00:10:41,780
with very intelligent people waiting to
see

163
00:10:41,780 --> 00:10:48,240
Marconi's radio magic five minutes
before the demonstration

164
00:10:48,240 --> 00:10:52,040
a little ticking noise started becoming
quite irritating

165
00:10:52,040 --> 00:10:57,199
and it turned out to be coming from
Marconi's device

166
00:10:57,199 --> 00:11:00,310
some in the audience

167
00:11:00,310 --> 00:11:03,319
here knows Morse code art

168
00:11:03,319 --> 00:11:09,839
this through the audience starts
thinking rate that sounds like marceca

169
00:11:09,839 --> 00:11:14,300
Inc soon it was very apparent that it
was Morse code it was actually Morse

170
00:11:14,300 --> 00:11:15,170
code

171
00:11:15,170 --> 00:11:19,650
saying the most derogatory things about
Marconi and his tool

172
00:11:19,650 --> 00:11:22,810
because this person

173
00:11:22,810 --> 00:11:27,680
was able to break into the
communications and take it over

174
00:11:27,680 --> 00:11:31,699
well the system was in pureed and
publicly outlast

175
00:11:31,699 --> 00:11:36,130
at whoever it was in the newspaper it
within three days

176
00:11:36,130 --> 00:11:40,209
never mass killing a guy whose family
was in the circus

177
00:11:40,209 --> 00:11:43,470
and his interest in radio had to do with
well

178
00:11:43,470 --> 00:11:48,000
circa see things the magic love being
able to guess who people are for example

179
00:11:48,000 --> 00:11:50,050
or information about them

180
00:11:50,050 --> 00:11:53,480
if you're may be in your piece that has
a that has a radio in it you can talk

181
00:11:53,480 --> 00:11:56,170
over

182
00:11:56,170 --> 00:11:59,829
and mescaline took mark on his promise
and said

183
00:11:59,829 --> 00:12:04,850
that's wrong and built a huge
transmitter

184
00:12:04,850 --> 00:12:09,030
that broke into the system he came up
came forward is very happy to

185
00:12:09,030 --> 00:12:12,890
since I get that was me and the
assistant

186
00:12:12,890 --> 00:12:17,430
flames him mercilessly I mean we we're
talkin making the UNIX

187
00:12:17,430 --> 00:12:21,670
list days look really kinda tame

188
00:12:21,670 --> 00:12:24,689
and Devils answer was

189
00:12:24,689 --> 00:12:29,339
abuse is no argument

190
00:12:29,339 --> 00:12:33,360
marconi was far more research says

191
00:12:33,360 --> 00:12:36,550
I refuse to debate with some

192
00:12:36,550 --> 00:12:40,459
with one who would shine cast doubt upon

193
00:12:40,459 --> 00:12:43,610
the technology or something along those
lines

194
00:12:43,610 --> 00:12:47,089
something equally stupid we know that
now

195
00:12:47,089 --> 00:12:50,500
are here this even rodin I will not
demonstrate when a man who throws doubt

196
00:12:50,500 --> 00:12:52,310
upon the system

197
00:12:52,310 --> 00:12:56,199
you what

198
00:12:56,199 --> 00:12:59,230
those of you who saw this you can talk a
couple years ago this is not heavy

199
00:12:59,230 --> 00:12:59,860
attack

200
00:12:59,860 --> 00:13:03,360
but the work in the in the learning that
we did in heavy attack

201
00:13:03,360 --> 00:13:08,390
played into rfk greatly my thought was
so heavy attack helps us determine

202
00:13:08,390 --> 00:13:12,770
hopping frequency frequency hopping
patterns

203
00:13:12,770 --> 00:13:17,060
so then what and my goal was to make a
tool that I could then take those

204
00:13:17,060 --> 00:13:18,350
shopping patterns

205
00:13:18,350 --> 00:13:22,439
put them into and take over in actually
have a network adapter

206
00:13:22,439 --> 00:13:26,160
not just some hacky toy

207
00:13:26,160 --> 00:13:29,449
after it has several different

208
00:13:29,449 --> 00:13:33,040
different faces if your own one is a
interactive tool

209
00:13:33,040 --> 00:13:39,380
I I like to think of it as a Python
interface to the sub your trading

210
00:13:39,380 --> 00:13:45,050
another is that are of cat server if you
guys have ever done anything with

211
00:13:45,050 --> 00:13:49,490
say the Ravens for example there there's
a is a tool called the RZ Raven

212
00:13:49,490 --> 00:13:53,110
and allows you to talk to

213
00:13:53,110 --> 00:13:56,490
ZigBee radios from your Windows machine
well

214
00:13:56,490 --> 00:14:00,079
it's very common and the Raven was no
exception

215
00:14:00,079 --> 00:14:03,730
to plug in the device run a device
driver that

216
00:14:03,730 --> 00:14:07,199
listens on a port and then your
application software just talk so that

217
00:14:07,199 --> 00:14:08,620
network port

218
00:14:08,620 --> 00:14:13,010
to access to hardware so our cat server
attempt to do that

219
00:14:13,010 --> 00:14:16,360
because not everybody wants that don't
wants to rate their toys in Python

220
00:14:16,360 --> 00:14:19,600
I can accept that I and

221
00:14:19,600 --> 00:14:26,600
sometimes standard in is not the
greatest way to type in binary

222
00:14:29,660 --> 00:14:35,850
alright yes

223
00:14:35,850 --> 00:14:40,730
RF cat leverages

224
00:14:40,730 --> 00:14:44,120
the trick on 1101 I already mention that
TI

225
00:14:44,120 --> 00:14:48,019
basically said pretty much everything
you want to do in the sub your trains

226
00:14:48,019 --> 00:14:51,089
let's throw into one configurable radio
instead offering

227
00:14:51,089 --> 00:14:54,649
10 and for the most part

228
00:14:54,649 --> 00:14:57,930
this was the way the new this is the
result

229
00:14:57,930 --> 00:15:02,240
I've almost everything that they wanted
to do there are two exceptions

230
00:15:02,240 --> 00:15:06,720
and one is a sum up the

231
00:15:06,720 --> 00:15:10,209
ZigBee work and some the lower frequency
Bluetooth work

232
00:15:10,209 --> 00:15:14,800
they require a different physical layer
and so they were able to brought that in

233
00:15:14,800 --> 00:15:18,610
but they wrapped in amplitude shift key

234
00:15:18,610 --> 00:15:21,709
thats better known as digital a.m.

235
00:15:21,709 --> 00:15:25,180
thereafter in frequency shift keying FSK

236
00:15:25,180 --> 00:15:28,519
also known as digital FM and

237
00:15:28,519 --> 00:15:32,329
several variations of these things that
we know and love only in the digital

238
00:15:32,329 --> 00:15:32,769
world

239
00:15:32,769 --> 00:15:36,569
and thereafter any frequency range have

240
00:15:36,569 --> 00:15:41,759
upper 900 megahertz down to 300
megahertz for the couple gaps in the

241
00:15:41,759 --> 00:15:42,079
middle

242
00:15:42,079 --> 00:15:45,120
really good stuff a

243
00:15:45,120 --> 00:15:49,720
when I made our of cat the goal was to
make

244
00:15:49,720 --> 00:15:55,220
all of that available in as easy a
fashion as possibly can so

245
00:15:55,220 --> 00:15:58,230
I'm a lover I love I pie from

246
00:15:58,230 --> 00:16:01,639
interactive Python it's my favorite
shell and

247
00:16:01,639 --> 00:16:05,920
I love the fact that I can't debug
processes with that I can disassemble

248
00:16:05,920 --> 00:16:10,000
program so that I I can do everything on
from my little I Python command line

249
00:16:10,000 --> 00:16:10,399
shell

250
00:16:10,399 --> 00:16:14,329
and so the research motive RF cat

251
00:16:14,329 --> 00:16:18,309
which is the most used in most tested
and most stable

252
00:16:18,309 --> 00:16:21,439
drops you to an iPod iPhone shelling
creates

253
00:16:21,439 --> 00:16:24,500
and object for you to interact with your
US

254
00:16:24,500 --> 00:16:29,430
with the USB dongles called the so
you'll see a lot of commands in here

255
00:16:29,430 --> 00:16:33,759
that start with the dot and that just
means in the iPod iPhone environment

256
00:16:33,759 --> 00:16:36,839
that's my object that I used to interact
with that stuff

257
00:16:36,839 --> 00:16:40,500
microphones great by the way if you
never use it it includes

258
00:16:40,500 --> 00:16:45,279
up some nice pretty representation of
information if you want to display it

259
00:16:45,279 --> 00:16:48,420
and it includes for my favorite parts
tab completion

260
00:16:48,420 --> 00:16:51,639
very intelligent way so that

261
00:16:51,639 --> 00:16:55,250
and have to remember the API completely
I just take d dot tab tab

262
00:16:55,250 --> 00:17:02,250
I get the list to the API and you'll see
down here

263
00:17:02,880 --> 00:17:07,089
I've listed several very interesting
things to do with the rfk dont you gotta

264
00:17:07,089 --> 00:17:13,740
set up

265
00:17:13,740 --> 00:17:17,199
archive server can't really see that
very well

266
00:17:17,199 --> 00:17:21,569
basically you start our archive server
and the you connect to it on port

267
00:17:21,569 --> 00:17:25,069
1900 to get interface

268
00:17:25,069 --> 00:17:30,330
to the wireless network you then connect
to our 1899

269
00:17:30,330 --> 00:17:34,440
and you get a command line interface
where you get to configure the radio

270
00:17:34,440 --> 00:17:38,570
outer bands so if you want to tune it to

271
00:17:38,570 --> 00:17:43,090
certain frequency setup embassy
amplitude shift keying modulation

272
00:17:43,090 --> 00:17:46,760
and set the baud rate to thirty eight
for

273
00:17:46,760 --> 00:17:51,450
killer bod 3.4 collide you do that from
1899

274
00:17:51,450 --> 00:17:55,289
that will take effect in the other
window and you will have a connection

275
00:17:55,289 --> 00:17:56,000
with

276
00:17:56,000 --> 00:18:03,000
the network on that configuration were
my favorite parts

277
00:18:06,590 --> 00:18:10,419
love the project actually is in the IM
me firmware that we build

278
00:18:10,419 --> 00:18:15,409
I is called arson F now there are
significant also be used for the don't

279
00:18:15,409 --> 00:18:16,559
know but are Stefan

280
00:18:16,559 --> 00:18:20,419
on IM me is special be cuz

281
00:18:20,419 --> 00:18:24,490
jamie has a keyboard and with a keyboard

282
00:18:24,490 --> 00:18:28,230
were able to set up all the radio
frequency

283
00:18:28,230 --> 00:18:31,340
configuration parameters and change them
at will

284
00:18:31,340 --> 00:18:34,409
and then we can set up

285
00:18:34,409 --> 00:18:39,690
to either just send every packet her
every bit of information that your sense

286
00:18:39,690 --> 00:18:45,059
on the network to the screen at least
the first 30 characters ovett or

287
00:18:45,059 --> 00:18:48,320
filter based on some

288
00:18:48,320 --> 00:18:55,030
think I D which is very common for every
different typeof radio solution every

289
00:18:55,030 --> 00:18:59,210
every product that uses some bigger
hurts they typically will start off with

290
00:18:59,210 --> 00:19:02,620
some 16 or 24 bit sequence

291
00:19:02,620 --> 00:19:06,330
of bits that are just unique to that
device

292
00:19:06,330 --> 00:19:10,650
that way the radio doesn't just send all
sorts of solar noises

293
00:19:10,650 --> 00:19:14,320
and everybody's garage door opener and
whatever

294
00:19:14,320 --> 00:19:17,659
to your insulin pump

295
00:19:17,659 --> 00:19:22,230
the insulin pump sits there is coming to
Mac address it says

296
00:19:22,230 --> 00:19:26,870
okay this this is not meant for me
discard this is not meant for me discard

297
00:19:26,870 --> 00:19:29,290
it sold in hardware very fast and it
doesn't

298
00:19:29,290 --> 00:19:33,150
bygone the system

299
00:19:33,150 --> 00:19:37,299
were able to set up a sink I D in the r
us now from the IM me as well

300
00:19:37,299 --> 00:19:40,740
so that we only focus in on one thing

301
00:19:40,740 --> 00:19:45,070
for example I've got a power meter home
that I'm able to

302
00:19:45,070 --> 00:19:49,200
I know what the sink ideas for it and
I'm able to tune in and catch

303
00:19:49,200 --> 00:19:53,679
every with our with RSF able to catch

304
00:19:53,679 --> 00:19:57,640
every packet on on the particular
channel I'm on it doesn't support

305
00:19:57,640 --> 00:19:59,440
hopping at the moment but

306
00:19:59,440 --> 00:20:04,290
but I'm able to catch a report that I'm
listening and they're certainly 5253

307
00:20:04,290 --> 00:20:07,890
to 82 different channels

308
00:20:07,890 --> 00:20:14,890
in any given shopping system I was the
key bindings here for a

309
00:20:15,580 --> 00:20:21,299
for the RCF ok you wanna take this off
line and go play with it it's also in

310
00:20:21,299 --> 00:20:22,750
every file in the project

311
00:20:22,750 --> 00:20:29,750
but i wanna make it simple and an easily
remember below where at just wrapped in

312
00:20:32,750 --> 00:20:34,169
in the last couple months

313
00:20:34,169 --> 00:20:38,049
I I put in a spectrum analyzer so

314
00:20:38,049 --> 00:20:43,299
we set base frequency and then we set a
channel which

315
00:20:43,299 --> 00:20:47,750
we set the number of channels up to two
and 55 channels

316
00:20:47,750 --> 00:20:52,260
recommending about a hundred and it
scans through the channels very very

317
00:20:52,260 --> 00:20:52,909
fast

318
00:20:52,909 --> 00:20:56,419
and it displays the power output

319
00:20:56,419 --> 00:21:00,840
and each one so

320
00:21:00,840 --> 00:21:06,409
at the top I'm using Python's use a
floating numbers with the you simple but

321
00:21:06,409 --> 00:21:07,780
I could just as easily written

322
00:21:07,780 --> 00:21:10,789
90 1 000 000

323
00:21:10,789 --> 00:21:14,720
comma 5 0.00% 0 0.00%

324
00:21:14,720 --> 00:21:17,899
comma 51 no b51 channels

325
00:21:17,899 --> 00:21:21,190
50 kilohertz

326
00:21:21,190 --> 00:21:25,500
in spacing starting at 901

327
00:21:25,500 --> 00:21:29,429
as you can see I pick something up here

328
00:21:29,429 --> 00:21:36,429
about 90 to

329
00:21:36,980 --> 00:21:41,580
too little limited it's not too it up
production qualities such as you might

330
00:21:41,580 --> 00:21:44,220
find in a two hundred thousand dollar
device

331
00:21:44,220 --> 00:21:47,780
still stop at

332
00:21:47,780 --> 00:21:52,040
I used to have to go I Mike Osman
anybody heard like Mike Awesome

333
00:21:52,040 --> 00:21:55,640
mazing I'm very very cool knowledgeable
and friendly

334
00:21:55,640 --> 00:22:00,190
and I he wrote firmware for the IM me
that does spectrum analysis

335
00:22:00,190 --> 00:22:05,190
and so I used to always have one others
I am you sitting around I said you know

336
00:22:05,190 --> 00:22:06,429
this is silly

337
00:22:06,429 --> 00:22:12,040
I'm gonna probably give a talk and some
and some

338
00:22:12,040 --> 00:22:15,570
and some courses on this is probably
wrap that in just make it happen since I

339
00:22:15,570 --> 00:22:21,399
got the radio

340
00:22:21,399 --> 00:22:25,429
throughout the slide you'll find that
I've got exercises

341
00:22:25,429 --> 00:22:30,179
you leave those to you if you have an RF
can and you're interested please

342
00:22:30,179 --> 00:22:34,130
go use the exercises my email addresses
on the first slide

343
00:22:34,130 --> 00:22:40,659
you have troubles with the exercises let
me know let me know

344
00:22:40,659 --> 00:22:44,340
but this thing these exercises drive
home some

345
00:22:44,340 --> 00:22:47,929
love the keep our components

346
00:22:47,929 --> 00:22:51,750
a far-off cat including what I call the
Obama Road

347
00:22:51,750 --> 00:22:55,639
global mod is where you take you remove
in the configuration your move

348
00:22:55,639 --> 00:22:58,659
all things that would not allow

349
00:22:58,659 --> 00:23:03,620
data to be transmitted to the screen or
to your to your buffer

350
00:23:03,620 --> 00:23:08,190
what this does is effectively puts your
your RF cat into

351
00:23:08,190 --> 00:23:13,639
cause I monitor mode if you will if you
remember the other days have

352
00:23:13,639 --> 00:23:19,000
Jasmine actually the day's still taken
are awesome Christmas stuff

353
00:23:19,000 --> 00:23:22,520
I'm if you wanna print

354
00:23:22,520 --> 00:23:26,370
the client state the state of the

355
00:23:26,370 --> 00:23:31,809
the rfk client print rapper client state

356
00:23:31,809 --> 00:23:34,909
once you have entered low-ball mode

357
00:23:34,909 --> 00:23:38,940
it stores the original configuration in
your Python fine

358
00:23:38,940 --> 00:23:41,679
and then when you want to get out of a
la mode and go back to something more

359
00:23:41,679 --> 00:23:42,990
sane

360
00:23:42,990 --> 00:23:47,880
use low-ball restore and it copies the
old config back into the radio and

361
00:23:47,880 --> 00:23:53,340
everything takes off

362
00:23:53,340 --> 00:23:56,649
and then you end up with be able to do

363
00:23:56,649 --> 00:23:59,669
RF receive everything that you get

364
00:23:59,669 --> 00:24:03,290
that comes in as a packet get stored in
your Python buffer

365
00:24:03,290 --> 00:24:06,649
see a radio isn't really even depend on
at this point or dependency at this

366
00:24:06,649 --> 00:24:07,399
point

367
00:24:07,399 --> 00:24:11,110
your Python buffer stores it for you or
for your application if you're writing

368
00:24:11,110 --> 00:24:13,510
something on top of our Afghan

369
00:24:13,510 --> 00:24:18,460
and you use our for seve to get out that
data

370
00:24:18,460 --> 00:24:23,490
is an exercise would actually cover the
stuff in a few

371
00:24:23,490 --> 00:24:29,649
discover mood or get to that are

372
00:24:29,649 --> 00:24:36,649
better so some other we could call this
a far-off category talk a little bit

373
00:24:36,899 --> 00:24:37,340
about it

374
00:24:37,340 --> 00:24:40,419
we have we have a team are

375
00:24:40,419 --> 00:24:44,059
a debug mode you wanna see what the
client is doing

376
00:24:44,059 --> 00:24:49,120
talking to the radio the Python client
will actually offer up its goods

377
00:24:49,120 --> 00:24:53,409
if you set de tout underscored debug
equal to or greater than 0

378
00:24:53,409 --> 00:24:58,149
shuts up when you said it is zero one
gives you some same messages

379
00:24:58,149 --> 00:25:02,230
like I've sent these bikes to the radio
I perceive these bites the radio use

380
00:25:02,230 --> 00:25:02,519
this

381
00:25:02,519 --> 00:25:06,450
a lot because it's really nice just

382
00:25:06,450 --> 00:25:10,179
when I'm troubleshooting you're working
on something all set debug Eagle One

383
00:25:10,179 --> 00:25:13,590
I will see exactly when i receive data
from the radio

384
00:25:13,590 --> 00:25:18,120
without having to go do RF receive and
printed out

385
00:25:18,120 --> 00:25:22,220
the debug function

386
00:25:22,220 --> 00:25:25,899
sits and spins printing out

387
00:25:25,899 --> 00:25:30,519
client information and the state to the
radio at that point so

388
00:25:30,519 --> 00:25:34,679
if you're if you're running debug for
example it will say

389
00:25:34,679 --> 00:25:38,659
ever see this many packets for this for
this application

390
00:25:38,659 --> 00:25:44,289
be Dongo is still responding units in
the idle motorists in receive mode

391
00:25:44,289 --> 00:25:50,740
things like that discover

392
00:25:50,740 --> 00:25:55,820
discover allows us to set a low ball
mode

393
00:25:55,820 --> 00:26:01,679
default is one 0 mean send everything

394
00:26:01,679 --> 00:26:06,590
even if you don't see any rise in power
in the radio one is the more saying hey

395
00:26:06,590 --> 00:26:08,649
as soon as I see a carrier to send data

396
00:26:08,649 --> 00:26:12,149
I think that's the most helpful which
twice that of all

397
00:26:12,149 --> 00:26:17,019
but it then just sits and prints data as
it is

398
00:26:17,019 --> 00:26:20,990
as it appears in a nicely packaged
format that can make sense to you

399
00:26:20,990 --> 00:26:26,279
in hexadecimal mobile mode is used

400
00:26:26,279 --> 00:26:30,179
by discover and we are to talk about a
little bit and no more store

401
00:26:30,179 --> 00:26:35,840
RF listen is a step above discover

402
00:26:35,840 --> 00:26:41,200
any basically says using this
configuration

403
00:26:41,200 --> 00:26:46,490
if our see packets is printable to the
screen it may seem like a small step up

404
00:26:46,490 --> 00:26:47,490
in maybe I should

405
00:26:47,490 --> 00:26:51,270
it seems confusing but actually when you
get into playing with it

406
00:26:51,270 --> 00:26:56,990
you'll find that they both have their
purposes RF captures basically of listen

407
00:26:56,990 --> 00:27:00,149
but its stores every packet so there

408
00:27:00,149 --> 00:27:04,200
at the end when you hit enter and you
get out of RF listen mode

409
00:27:04,200 --> 00:27:07,620
it will return to you a list up the
packets

410
00:27:07,620 --> 00:27:14,620
so that your program can 21 scanning
mode

411
00:27:15,350 --> 00:27:19,870
allows us to set a particular

412
00:27:19,870 --> 00:27:23,630
base frequency a channel size

413
00:27:23,630 --> 00:27:28,110
and a timeout and it just sits in hops
through all the channels looking for

414
00:27:28,110 --> 00:27:28,539
data

415
00:27:28,539 --> 00:27:31,549
spits out on the screen up to a certain
amount

416
00:27:31,549 --> 00:27:36,159
and then moves on I found this could be
very fun

417
00:27:36,159 --> 00:27:39,880
driving through town a crack what's that

418
00:27:39,880 --> 00:27:43,500
I found that at 9:12 924 megahertz

419
00:27:43,500 --> 00:27:47,110
at my house which is basically an RF
cage I

420
00:27:47,110 --> 00:27:52,120
I still have constant stream of data no
idea why it but

421
00:27:52,120 --> 00:27:55,220
I would have found it if I hadn't earned
standard

422
00:27:55,220 --> 00:27:59,899
spec and notice how you turn on Rd
outspokenness how you turn on the

423
00:27:59,899 --> 00:28:00,789
spectrum analyzer

424
00:28:00,789 --> 00:28:04,679
possible do we so it's a different
window

425
00:28:04,679 --> 00:28:10,620
know when you close the girl you get
your the kremlin-backed Andy dot print

426
00:28:10,620 --> 00:28:14,250
radio configure print out all the
information that You

427
00:28:14,250 --> 00:28:18,700
could possibly want okay most the
information that would be very good to

428
00:28:18,700 --> 00:28:20,639
know about how to reduce configured

429
00:28:20,639 --> 00:28:24,580
modulation with speed were intermediate
frequency you can change the

430
00:28:24,580 --> 00:28:27,029
intermediate frequency for those if you
read your books out there

431
00:28:27,029 --> 00:28:34,029
and I went over this in the exercise
already sorry

432
00:28:36,639 --> 00:28:39,740
oh one thing to note about discover mode

433
00:28:39,740 --> 00:28:42,990
it doesn't just drop you want to lowball
mode the

434
00:28:42,990 --> 00:28:48,169
idea behind the creation discover mode
was identifying

435
00:28:48,169 --> 00:28:52,700
sink words in the area so this is shared
spectrum right

436
00:28:52,700 --> 00:28:55,960
if if you want

437
00:28:55,960 --> 00:28:59,750
if you're in a rare relatively populated
area you'll probably

438
00:28:59,750 --> 00:29:03,010
always have no less than three devices
hitting at once

439
00:29:03,010 --> 00:29:08,100
for a lot of the channels so the idea
here is

440
00:29:08,100 --> 00:29:11,120
kinda like kismet would show

441
00:29:11,120 --> 00:29:15,299
what networks were listening by
listening for traffic and making some

442
00:29:15,299 --> 00:29:16,480
salad and

443
00:29:16,480 --> 00:29:19,669
discover mode

444
00:29:19,669 --> 00:29:23,139
as a primary can turn on called I don't
think word

445
00:29:23,139 --> 00:29:26,149
and it will assume

446
00:29:26,149 --> 00:29:31,309
that all this raw data coming through
has a sink word on the front

447
00:29:31,309 --> 00:29:34,649
and then a carrier will

448
00:29:34,649 --> 00:29:41,059
will carrier will come in which is in
alternating 10 bit up to a certain like

449
00:29:41,059 --> 00:29:44,360
that's how the radio knows that there's
a carrier by the way

450
00:29:44,360 --> 00:29:47,610
this is called a preamble and when the
preamble is done

451
00:29:47,610 --> 00:29:51,980
the sink word normally starts and that's
how it knows that the star the frame is

452
00:29:51,980 --> 00:29:54,669
about to occur

453
00:29:54,669 --> 00:29:58,740
discover mode takes that information
that comes in

454
00:29:58,740 --> 00:30:01,760
does some math shifting around have the
bits

455
00:30:01,760 --> 00:30:04,879
incomes up with possible Cinque Ports

456
00:30:04,879 --> 00:30:08,320
so this this work I use this actually on

457
00:30:08,320 --> 00:30:11,549
discovering my at my power meter sink
word

458
00:30:11,549 --> 00:30:15,940
and actually had some interesting stuff
they're all talk about a minute

459
00:30:15,940 --> 00:30:19,879
but does that make sense everybody

460
00:30:19,879 --> 00:30:25,419
to get 10 10 10 10 that standard
preamble

461
00:30:25,419 --> 00:30:29,200
then your sink word starts after that
but who's to say that you're seeing for

462
00:30:29,200 --> 00:30:31,460
doesn't start with a one or a0

463
00:30:31,460 --> 00:30:35,350
in the same sequences the preamble

464
00:30:35,350 --> 00:30:40,669
so discover mode says this is something
that I'm pretty sure

465
00:30:40,669 --> 00:30:44,129
could be and that it shipped up and it
includes up to

466
00:30:44,129 --> 00:30:47,510
most the preamble and spits out the %ah
the options for

467
00:30:47,510 --> 00:30:51,700
each network that advice

468
00:30:51,700 --> 00:30:55,220
if i'm looking for a list of sync words

469
00:30:55,220 --> 00:30:59,669
i turn on sink word match list hand in a
list a python worst

470
00:30:59,669 --> 00:31:03,440
above the sink words that i'm looking
for. and it looks for

471
00:31:03,440 --> 00:31:10,440
and discovers and prints out when it
when it finds one

472
00:31:10,840 --> 00:31:17,840
not require totally optional %uh power
meter that I was hacking has

473
00:31:17,970 --> 00:31:21,270
16 15 possible

474
00:31:21,270 --> 00:31:24,440
sink word spaced so that they can easily
say

475
00:31:24,440 --> 00:31:28,149
hey this utility is using our stuff in
this utility adjacent to it is using our

476
00:31:28,149 --> 00:31:29,350
stuff it's tweak it

477
00:31:29,350 --> 00:31:34,909
so they don't get each others messages

478
00:31:34,909 --> 00:31:38,710
want to rule them all which that's the
goal

479
00:31:38,710 --> 00:31:43,350
I'm unfortunately it's not totally

480
00:31:43,350 --> 00:31:47,299
the case yet but it ruins the title the
slides and just gonna say

481
00:31:47,299 --> 00:31:51,649
want to rule them all and then throw in
there

482
00:31:51,649 --> 00:31:56,799
maybe a softer defined radio if you're
doing discovery work

483
00:31:56,799 --> 00:32:00,049
but for radio for the attacks I dove
radio

484
00:32:00,049 --> 00:32:03,549
RF cat should do almost all that you
need to do

485
00:32:03,549 --> 00:32:07,139
for leveraging against a bigger trader

486
00:32:07,139 --> 00:32:11,010
so I will have read dogle called Gina
running our of cat

487
00:32:11,010 --> 00:32:14,510
spec an the spectrum analyzer yes any
mcdonnell's

488
00:32:14,510 --> 00:32:18,610
it's a great services it's called it
dawned on naming service

489
00:32:18,610 --> 00:32:22,210
I dogle Paul actually somebody stole
polish mcconnell

490
00:32:22,210 --> 00:32:26,020
missing him right now but Paul will be
running are of cat

491
00:32:26,020 --> 00:32:30,279
proper so that I can tweak everything
right away and and go

492
00:32:30,279 --> 00:32:33,289
finding sniff

493
00:32:33,289 --> 00:32:36,429
I like and I am hearing or a sniff I'm

494
00:32:36,429 --> 00:32:39,889
especially when I'm developing because
there's nothing

495
00:32:39,889 --> 00:32:43,899
worse than making a change and not
knowing okay something brokers at the

496
00:32:43,899 --> 00:32:50,899
transmitter the receiver and having just
a known good sitting around

497
00:32:51,210 --> 00:32:54,760
from the non RF cat part

498
00:32:54,760 --> 00:32:58,600
a salir logic analyzer for my best
friends

499
00:32:58,600 --> 00:33:02,500
and it allows me to tap into bus lines
in communication between

500
00:33:02,500 --> 00:33:06,559
different ships on our afford or on any
better system

501
00:33:06,559 --> 00:33:13,240
and track the the 1's and 0's on the
bits

502
00:33:13,240 --> 00:33:16,379
I just say the ones and zeros on the
bits yes on the wires

503
00:33:16,379 --> 00:33:20,240
the bits on the wire and a fun Q donde
or

504
00:33:20,240 --> 00:33:23,629
for some other STR they're really cheap
a funky dongles like

505
00:33:23,629 --> 00:33:27,099
100 reeboks ok it's not nearly as cheap
as RF cat

506
00:33:27,099 --> 00:33:31,010
I'm if you're only interested in
sniffing which actually I am

507
00:33:31,010 --> 00:33:36,500
I found that summer the high-performance
video USB plug ins

508
00:33:36,500 --> 00:33:40,840
have been turn into St arse and they're
like 20 bucks

509
00:33:40,840 --> 00:33:45,119
so what this allows you to do is get any
better

510
00:33:45,119 --> 00:33:49,109
picture at the lower levels I've what a
waveform

511
00:33:49,109 --> 00:33:52,559
actually looks like in from that it's
easier

512
00:33:52,559 --> 00:33:55,970
to determine modulation scheme

513
00:33:55,970 --> 00:34:00,879
and boundary and it's kind of just a
basic troubleshooting tool

514
00:34:00,879 --> 00:34:04,470
I'm pushing RF cat to be more and more
and more

515
00:34:04,470 --> 00:34:07,520
but it'll never be an STR Justin

516
00:34:07,520 --> 00:34:14,190
so on occasion cranking up in st. are
can make your research that much better

517
00:34:14,190 --> 00:34:17,909
put together an RF attack for so

518
00:34:17,909 --> 00:34:21,560
for example every device that I have all
sit down with the form and I've got a

519
00:34:21,560 --> 00:34:24,149
downloadable from the website this is
just a slight showing some the

520
00:34:24,149 --> 00:34:25,230
information

521
00:34:25,230 --> 00:34:28,790
I'm and of Ilion the

522
00:34:28,790 --> 00:34:32,190
just to make sure I'm answering all the
questions that I have to before i sat

523
00:34:32,190 --> 00:34:33,609
down with the device

524
00:34:33,609 --> 00:34:37,129
and start to play with it base frequency
modulation

525
00:34:37,129 --> 00:34:43,619
broadband with is your modem stuff you
guys remember the modems

526
00:34:43,619 --> 00:34:48,940
you deviation how do I know a a
deviation in the frequency that's a one

527
00:34:48,940 --> 00:34:50,669
or a0

528
00:34:50,669 --> 00:34:54,020
channel hopping how many channels
pattern

529
00:34:54,020 --> 00:34:58,049
an effective sick method because it's
one thing to know a pattern of a system

530
00:34:58,049 --> 00:35:02,290
it's another to figure out how they
discover each other

531
00:35:02,290 --> 00:35:06,890
channel spacing well period this is how
long it stays on every channel

532
00:35:06,890 --> 00:35:09,930
and is it fixed or variable length

533
00:35:09,930 --> 00:35:15,359
very polite packet is well known the
first byte sets the link to the pack

534
00:35:15,359 --> 00:35:18,670
um

535
00:35:18,670 --> 00:35:19,860
does have an address

536
00:35:19,860 --> 00:35:23,160
was just some device that treats every
other buddy is

537
00:35:23,160 --> 00:35:28,550
as able to transmit to it what's the
sink word or sink words if applicable

538
00:35:28,550 --> 00:35:32,440
to use any encoding nurse CRC

539
00:35:32,440 --> 00:35:35,810
Manchester these are all things that the
radio handles for you

540
00:35:35,810 --> 00:35:38,910
very handy to know that right out of the
gate

541
00:35:38,910 --> 00:35:42,810
we've recently added and here's the

542
00:35:42,810 --> 00:35:48,410
the rekon form on the website we've
recently added the ability to

543
00:35:48,410 --> 00:35:51,460
turning use the hardware a yes

544
00:35:51,460 --> 00:35:54,460
in the chip he's always been available

545
00:35:54,460 --> 00:35:57,720
but we've recently made it very easy to
set up

546
00:35:57,720 --> 00:36:03,720
in to use it anybody heard a major
malfunction major malfunction

547
00:36:03,720 --> 00:36:08,400
maze in Guyana the UK I he is well known
for his Bluetooth

548
00:36:08,400 --> 00:36:12,930
and ZigBee hacking he works at a place
called the bunker

549
00:36:12,930 --> 00:36:17,550
its kinda scary a but he's also been
contributing to the rfk project

550
00:36:17,550 --> 00:36:20,670
and he needed recently the yes

551
00:36:20,670 --> 00:36:24,420
compatibility capability and so he's
like

552
00:36:24,420 --> 00:36:31,420
I know you're going to get this is on
your to do list here handed it to me

553
00:36:34,930 --> 00:36:38,550
another exercise so little bit of the
application how we doing on time

554
00:36:38,550 --> 00:36:43,700
Stenton are good morning

555
00:36:43,700 --> 00:36:47,170
mucking around with medical devices
particularly insulin pumps

556
00:36:47,170 --> 00:36:52,110
can be deadly I personally have the
ability to

557
00:36:52,110 --> 00:36:55,440
to push insulin through a

558
00:36:55,440 --> 00:36:59,450
well not push yet but to definitely set
up a pump

559
00:36:59,450 --> 00:37:03,410
to push a lethal injection have against
one

560
00:37:03,410 --> 00:37:06,930
and so be warned wanna my

561
00:37:06,930 --> 00:37:11,700
on my closest friends is a diabetic and
he let me use his pomp

562
00:37:11,700 --> 00:37:15,540
so as I say be careful

563
00:37:15,540 --> 00:37:19,120
we found the PDF

564
00:37:19,120 --> 00:37:23,410
have the manual told us

565
00:37:23,410 --> 00:37:26,730
what frequency the thing operated at and
it's not a standard frequency is not

566
00:37:26,730 --> 00:37:27,660
even in the year

567
00:37:27,660 --> 00:37:33,120
the reins for medical devices with
diabetic cares what frequency the device

568
00:37:33,120 --> 00:37:33,690
runs on

569
00:37:33,690 --> 00:37:38,110
unless of course they're upset because
they can't no

570
00:37:38,110 --> 00:37:41,520
but I thought it was interesting um

571
00:37:41,520 --> 00:37:46,710
the modulation is easily gas just by the
way for my used a spectrum analyzer and

572
00:37:46,710 --> 00:37:47,010
Mike

573
00:37:47,010 --> 00:37:51,290
yeah that's definitely block in on my
god

574
00:37:51,290 --> 00:37:55,630
we use to %uh several other

575
00:37:55,630 --> 00:37:59,040
techniques and tools including US RP

576
00:37:59,040 --> 00:38:02,210
I was working on this last

577
00:38:02,210 --> 00:38:07,220
last January I believe and Mike Osman

578
00:38:07,220 --> 00:38:10,430
was straining give me a hand and he said
wait a minute

579
00:38:10,430 --> 00:38:15,400
you don't have your Sharpie woody while
so he sent me a US are created to help

580
00:38:15,400 --> 00:38:16,320
him help me

581
00:38:16,320 --> 00:38:20,540
the discovery process

582
00:38:20,540 --> 00:38:27,110
probably some of the most fun for
pictures at least we first started out

583
00:38:27,110 --> 00:38:29,350
with a spectrum analyzer between the
radio

584
00:38:29,350 --> 00:38:34,490
module and the mainboard and

585
00:38:34,490 --> 00:38:39,540
a and we hit with the spectrum analyzer
dresses sorry

586
00:38:39,540 --> 00:38:43,520
we hit with a spectrum analyzer first
watch the stuff

587
00:38:43,520 --> 00:38:47,680
and figured out what we could buy by
using a spectrum analyzer

588
00:38:47,680 --> 00:38:50,920
we then moved on to logic analyzer
watching

589
00:38:50,920 --> 00:38:54,080
the day to go over the the data bus

590
00:38:54,080 --> 00:39:00,250
the wires on the board then we captured

591
00:39:00,250 --> 00:39:04,240
basically audio data from the US RP

592
00:39:04,240 --> 00:39:08,480
got a picture of what this way for looks
like an from it

593
00:39:08,480 --> 00:39:12,130
we were able to tell bond rate and

594
00:39:12,130 --> 00:39:16,790
secret given the bond rate the sink word
actually turned out to be pretty easy

595
00:39:16,790 --> 00:39:23,560
I'm we took a packet capture out of the
US RP

596
00:39:23,560 --> 00:39:26,660
cuz the of cat was in a much earlier
statement wasn't able to

597
00:39:26,660 --> 00:39:33,660
to do as much with it I'm and we turn we
put it into a tool called bob line

598
00:39:34,490 --> 00:39:38,830
bloodline did analysis and allowed us to

599
00:39:38,830 --> 00:39:42,300
figure out baud rate and

600
00:39:42,300 --> 00:39:49,300
visually look for data next Mike Osman

601
00:39:51,110 --> 00:39:54,400
in were floundering here just a little
bit we we went in several different

602
00:39:54,400 --> 00:39:56,870
directions I'm telling you the I suck
story

603
00:39:56,870 --> 00:39:59,880
just just so that you know

604
00:39:59,880 --> 00:40:03,540
that when we're when you're doing
research in you go down a road

605
00:40:03,540 --> 00:40:07,300
and you're not sure if you should go
down the road in to try different road

606
00:40:07,300 --> 00:40:10,420
and it turns out that you were able to
cora

607
00:40:10,420 --> 00:40:14,590
triangulate the what you're after out of
all these different things

608
00:40:14,590 --> 00:40:19,240
such as you it happens every researcher
has to do with this

609
00:40:19,240 --> 00:40:22,540
and do with the failure that you have to
run into before success

610
00:40:22,540 --> 00:40:26,460
so my costume then took the

611
00:40:26,460 --> 00:40:30,580
the capture and ran through the new
radio companion you guys heard a radio

612
00:40:30,580 --> 00:40:34,690
K new radio comes with a graphical

613
00:40:34,690 --> 00:40:38,020
tool that allows you to process

614
00:40:38,020 --> 00:40:41,280
maybe D marshall et Tampa 5 whatever

615
00:40:41,280 --> 00:40:44,580
process Rawal radio in turn it into bits

616
00:40:44,580 --> 00:40:51,580
and from that we were able to determine

617
00:40:52,490 --> 00:40:57,750
a all the information we needed we pump
in the framers into our of cat

618
00:40:57,750 --> 00:41:01,720
and we were able to receive directly
from

619
00:41:01,720 --> 00:41:04,770
the center

620
00:41:04,770 --> 00:41:07,780
this is just a little bit of collage
work to show that I'm not

621
00:41:07,780 --> 00:41:11,220
visual artist appears what

622
00:41:11,220 --> 00:41:16,350
the data looks like a bad line just so
that if you ever do it

623
00:41:16,350 --> 00:41:20,080
got something to compare against

624
00:41:20,080 --> 00:41:23,700
this is all the junk that Mike had to go
through to

625
00:41:23,700 --> 00:41:28,140
to work through going to radio companion
2d modulate and get

626
00:41:28,140 --> 00:41:31,540
out the data from

627
00:41:31,540 --> 00:41:36,210
this thing now you're starting to see
the answer

628
00:41:36,210 --> 00:41:39,780
the question why don't you just use a
nasty are for this

629
00:41:39,780 --> 00:41:44,530
cuz that's tough hard in your writing
for more from scratch is hard to you

630
00:41:44,530 --> 00:41:49,010
but I do wants and if I make it flexible
enough

631
00:41:49,010 --> 00:41:52,410
I'm not only got something with it
allows me to do analysis

632
00:41:52,410 --> 00:41:58,140
but also got the attack to when I'm done
and right here you can see

633
00:41:58,140 --> 00:42:03,300
the scope with the preamble right here

634
00:42:03,300 --> 00:42:10,300
the sink worry here and then the data

635
00:42:13,390 --> 00:42:16,940
2013 a hit the configuration into your
our Afghan

636
00:42:16,940 --> 00:42:22,299
we started seeing this is discover mode

637
00:42:22,299 --> 00:42:25,650
we started seeing various forms

638
00:42:25,650 --> 00:42:29,559
don't forget and discover mode you are

639
00:42:29,559 --> 00:42:32,729
either one but a liner to better align
which means that

640
00:42:32,729 --> 00:42:37,839
debates could be all shipped all over
and we

641
00:42:37,839 --> 00:42:44,839
came up with possible sink words that
are not very visible on the slide we

642
00:42:45,309 --> 00:42:46,140
just turn it on

643
00:42:46,140 --> 00:42:51,299
into normal Nick Mon and here's our
packet

644
00:42:51,299 --> 00:42:54,719
turns out medical devices

645
00:42:54,719 --> 00:42:58,229
as well as many the simpler

646
00:42:58,229 --> 00:43:03,299
radio devices they don't have simple
send

647
00:43:03,299 --> 00:43:08,479
and receive a lot of them including your
garage door openers and your

648
00:43:08,479 --> 00:43:11,989
car key fobs and apparently insulin
pumps

649
00:43:11,989 --> 00:43:16,619
you run and they do 100 or 200

650
00:43:16,619 --> 00:43:22,039
attempts and sense now you may think
this is because the transmitters

651
00:43:22,039 --> 00:43:25,049
weaker problematic but it turns out

652
00:43:25,049 --> 00:43:28,809
if you don't even if you have a pristine
packet that you're sure of

653
00:43:28,809 --> 00:43:33,749
the pump doesn't do anything until it
sees like

654
00:43:33,749 --> 00:43:38,660
a hundred so the firmer probably does
some statistical analysis saying

655
00:43:38,660 --> 00:43:43,759
okay river just receive like a hundred
packets errors occur

656
00:43:43,759 --> 00:43:47,269
a lot more than you think from our
normal wireless experience

657
00:43:47,269 --> 00:43:51,690
and so they throw out these aberrations
you know we had five that are

658
00:43:51,690 --> 00:43:54,739
different and you know 195 that are

659
00:43:54,739 --> 00:44:00,789
the same need to reverse the palm

660
00:44:00,789 --> 00:44:04,529
for for actual by directional protocol a

661
00:44:04,529 --> 00:44:08,769
or actually just how to get around it I
know that there's actually a way that

662
00:44:08,769 --> 00:44:12,430
I should be able to issue a command to
the pomp

663
00:44:12,430 --> 00:44:16,690
and just have it drop insulin into

664
00:44:16,690 --> 00:44:20,549
the channel I'm not sure that I actually
wanna publicly present that I'm

665
00:44:20,549 --> 00:44:26,650
I do know of a path to get there and I
haven't had time but I can register

666
00:44:26,650 --> 00:44:28,670
glucose levels a 475

667
00:44:28,670 --> 00:44:32,200
if anybody news glucose levels at

668
00:44:32,200 --> 00:44:39,200
pretty scary

669
00:44:41,599 --> 00:44:44,529
mucking with a power meter is illegal

670
00:44:44,529 --> 00:44:47,799
without permission from the utility
company

671
00:44:47,799 --> 00:44:53,099
and probably their vendor even if it's
on the side of your house

672
00:44:53,099 --> 00:44:57,130
yes you give them the right to manage
this thing as a part of your property

673
00:44:57,130 --> 00:44:57,969
even though you know

674
00:44:57,969 --> 00:45:03,849
now

675
00:45:03,849 --> 00:45:08,019
power meters are just one component be
very large power system

676
00:45:08,019 --> 00:45:11,569
the end the last mile if you will

677
00:45:11,569 --> 00:45:16,319
is called the distribution there's
transmission

678
00:45:16,319 --> 00:45:20,630
on the outside it is the distribution
bubble in this generation the answer

679
00:45:20,630 --> 00:45:24,109
that there's a lot more complexity to it
but think about those stages

680
00:45:24,109 --> 00:45:27,309
meters makeup a large component

681
00:45:27,309 --> 00:45:31,669
love distribution in the modern but also
in distribution

682
00:45:31,669 --> 00:45:36,769
all those meters have wired cables that
connect back to a distribution

683
00:45:36,769 --> 00:45:41,599
substation and distribution substations

684
00:45:41,599 --> 00:45:45,359
have skated equipment and cap banks

685
00:45:45,359 --> 00:45:48,439
and other things that help make your
stuff more reliable

686
00:45:48,439 --> 00:45:53,619
and make their monitoring more accurate
why do I say that

687
00:45:53,619 --> 00:45:58,249
because when i sat down with the guy
originally talking about power meters

688
00:45:58,249 --> 00:46:01,529
I said okay I got these ideas

689
00:46:01,529 --> 00:46:05,749
and he says don't even bother with them
your word about stealing energy

690
00:46:05,749 --> 00:46:09,269
I'm not okay

691
00:46:09,269 --> 00:46:13,009
what bothers you he says

692
00:46:13,009 --> 00:46:16,109
we're working with the system

693
00:46:16,109 --> 00:46:20,519
that is antiquated and

694
00:46:20,519 --> 00:46:24,929
the influence have enough power which
power meters

695
00:46:24,929 --> 00:46:29,869
with the disconnect switch have control
over to literally

696
00:46:29,869 --> 00:46:32,929
change the face the Western world I
stole that phrase from

697
00:46:32,929 --> 00:46:36,179
any went on to detail to me

698
00:46:36,179 --> 00:46:39,309
how controlling enough

699
00:46:39,309 --> 00:46:43,219
have the power through disconnect
switches on power meters

700
00:46:43,219 --> 00:46:47,380
is enough to break things

701
00:46:47,380 --> 00:46:50,749
in the power in the bigger more
expensive side love

702
00:46:50,749 --> 00:46:53,999
transmission and distribution that

703
00:46:53,999 --> 00:46:58,609
can have up to eighteen month lead time
to get a replacement can cost

704
00:46:58,609 --> 00:47:04,269
well over a million dollars he says

705
00:47:04,269 --> 00:47:09,199
I don't want people to gain control
these things shot me neither thanks

706
00:47:09,199 --> 00:47:13,909
many of the existing power meters

707
00:47:13,909 --> 00:47:16,959
use their own proprietary neighborhood

708
00:47:16,959 --> 00:47:21,169
area network man as this call and that
is basically

709
00:47:21,169 --> 00:47:25,219
their meters all mashing together and
talking to some

710
00:47:25,219 --> 00:47:28,309
access point which then has some sorta
back all

711
00:47:28,309 --> 00:47:32,549
sprint may be leased line whatever back
to the utility for control

712
00:47:32,549 --> 00:47:36,029
there been two phases have smart meters

713
00:47:36,029 --> 00:47:40,949
well there in two phases have special
meters if you will

714
00:47:40,949 --> 00:47:44,699
what is called a Mr an early interest in
mr. there's no control there it's just

715
00:47:44,699 --> 00:47:46,639
basically meters broadcasting

716
00:47:46,639 --> 00:47:50,169
their usage so that people can drive
down the road and get the usage

717
00:47:50,169 --> 00:47:54,479
instead of going up in checking a
premier the second type is called

718
00:47:54,479 --> 00:47:55,939
advanced metering infrastructure

719
00:47:55,939 --> 00:48:01,079
and it is intelligent bi directional
communication with power meters that

720
00:48:01,079 --> 00:48:01,799
have some

721
00:48:01,799 --> 00:48:08,799
microcontrollers that do you education
so the check on 11/11

722
00:48:11,429 --> 00:48:16,319
has the same Japan 1101 core that said I
would say 75 percent above the power

723
00:48:16,319 --> 00:48:19,839
meters available today

724
00:48:19,839 --> 00:48:26,169
that's why I'm here as I said before

725
00:48:26,169 --> 00:48:29,569
at the stuff was doo-doo Hurtado

726
00:48:29,569 --> 00:48:33,789
sorry and unavailable to security
researchers other power people or fear

727
00:48:33,789 --> 00:48:34,859
security research

728
00:48:34,859 --> 00:48:38,329
sure typically historically

729
00:48:38,329 --> 00:48:41,479
some people are out there trying to make
it better I'm

730
00:48:41,479 --> 00:48:45,979
but its

731
00:48:45,979 --> 00:48:50,759
become very plain in the last three
years that there are some power vendors

732
00:48:50,759 --> 00:48:55,259
who want to take a proactive approach
engage the people smart enough to break

733
00:48:55,259 --> 00:48:56,959
their stuff

734
00:48:56,959 --> 00:49:02,349
pay them not threaten them and then fix
the problems and push out

735
00:49:02,349 --> 00:49:07,359
get it going to supply chain that
actually can handle security updates

736
00:49:07,359 --> 00:49:10,929
some vendors do not however drink this
kuwait

737
00:49:10,929 --> 00:49:14,859
but rather consider for sticking your
head in the sand

738
00:49:14,859 --> 00:49:17,929
the better way I

739
00:49:17,929 --> 00:49:22,559
typically I have several power meters
and I like to display them

740
00:49:22,559 --> 00:49:27,219
anonymously I cover the face paint stuff
from a vendor who has been very good to

741
00:49:27,219 --> 00:49:28,059
me

742
00:49:28,059 --> 00:49:31,719
and to my Cole scary researchers

743
00:49:31,719 --> 00:49:35,259
and they're only their only request is
that

744
00:49:35,259 --> 00:49:39,039
we respect them to share the
vulnerabilities with them in respect

745
00:49:39,039 --> 00:49:39,689
others

746
00:49:39,689 --> 00:49:43,589
not too sure publicly these guys get

747
00:49:43,589 --> 00:49:47,159
they want to know how the babies are
ugly

748
00:49:47,159 --> 00:49:50,409
I'm II

749
00:49:50,409 --> 00:49:57,409
really gotten a bad attitude about
certain vendors

750
00:49:58,299 --> 00:50:01,959
power meters are in a simple is good
commerce the

751
00:50:01,959 --> 00:50:05,539
typically are covering much larger
distances in the

752
00:50:05,539 --> 00:50:08,989
industrial scientific and medical the
ice ambiance

753
00:50:08,989 --> 00:50:13,939
there are restrictions on how much power
you can use

754
00:50:13,939 --> 00:50:17,269
for anyone given device there's an
exception to the

755
00:50:17,269 --> 00:50:22,119
to the limitation however that allows a
significantly greater in our power to be

756
00:50:22,119 --> 00:50:23,009
used

757
00:50:23,009 --> 00:50:26,059
if the devices hop

758
00:50:26,059 --> 00:50:30,279
over more than fifty channels and not
spend more than a certain amount of time

759
00:50:30,279 --> 00:50:31,529
on any one channel

760
00:50:31,529 --> 00:50:35,139
in a 20 second period these are the FCC
Rules

761
00:50:35,139 --> 00:50:38,459
I to you has rules the cover a lot over

762
00:50:38,459 --> 00:50:41,849
you know the world but the FCC applies
this to us

763
00:50:41,849 --> 00:50:46,349
so what we're finding out is that
instead of just

764
00:50:46,349 --> 00:50:49,639
or what we found out was in center just
grabbing packets

765
00:50:49,639 --> 00:50:53,959
we have to hop along with which means we
have to identify

766
00:50:53,959 --> 00:50:57,059
a frequency hopping patter and

767
00:50:57,059 --> 00:51:00,729
we have to identify a discover mode

768
00:51:00,729 --> 00:51:04,229
not just for one meter vendor but we
have to do it for every meter vendor

769
00:51:04,229 --> 00:51:05,179
because they're all

770
00:51:05,179 --> 00:51:08,249
different there some standardization
that that

771
00:51:08,249 --> 00:51:12,229
looks like it could make this easier
because via at least publicize

772
00:51:12,229 --> 00:51:13,179
everything

773
00:51:13,179 --> 00:51:16,630
but I've actually found that a lot of
the guys

774
00:51:16,630 --> 00:51:20,959
doing cutting-edge work a patented their
stuff

775
00:51:20,959 --> 00:51:24,479
and so their Mac if I is publicly
available in fact the vendor that I

776
00:51:24,479 --> 00:51:27,919
was talking about who still wish to
remain anonymous sadly

777
00:51:27,919 --> 00:51:31,209
has said we've decided

778
00:51:31,209 --> 00:51:35,069
overtly to publish to publish or Mac and
final airs because

779
00:51:35,069 --> 00:51:40,029
we can't allow them to be seen as our
security

780
00:51:40,029 --> 00:51:45,409
got a bad idea so as time permits I
certainly

781
00:51:45,409 --> 00:51:48,630
ok to knock down several more vendors

782
00:51:48,630 --> 00:51:52,419
to you have our cat talking with them
but I will publish

783
00:51:52,419 --> 00:51:58,019
sums are but if you're in the industry I
will talk to you

784
00:51:58,019 --> 00:52:01,819
we won't be sinking with the meter today
the I didn't bring it

785
00:52:01,819 --> 00:52:07,709
but also because I don't want that
Parliament talk

786
00:52:07,709 --> 00:52:12,959
so we start off for the year SPI bus
sniffing using that logic analyzer

787
00:52:12,959 --> 00:52:18,109
as you can see the logic on certain pins

788
00:52:18,109 --> 00:52:21,839
bounces a up and down periodically

789
00:52:21,839 --> 00:52:27,389
on SPI bus we have a clock and that is
this guy down here

790
00:52:27,389 --> 00:52:31,239
and then we get the data in these other
these other wires

791
00:52:31,239 --> 00:52:34,489
SPI has a to and from where

792
00:52:34,489 --> 00:52:38,279
so that instead of just a back-and-forth

793
00:52:38,279 --> 00:52:42,489
we know that this is data coming to the
device in this is

794
00:52:42,489 --> 00:52:45,939
data coming from the device

795
00:52:45,939 --> 00:52:49,569
yes this is actually just video for for
photographic

796
00:52:49,569 --> 00:52:53,359
digital porn because I'm not really
showing you

797
00:52:53,359 --> 00:53:00,359
data

798
00:53:01,400 --> 00:53:03,090
here we go

799
00:53:03,090 --> 00:53:06,940
to retake that day today with 7 through
some II some Python parsing goodness

800
00:53:06,940 --> 00:53:10,369
we end up being able to read what the
data is

801
00:53:10,369 --> 00:53:13,720
sent to the radio including

802
00:53:13,720 --> 00:53:17,300
configuration settings channel hopping
parameters

803
00:53:17,300 --> 00:53:20,380
had to write a special client for this

804
00:53:20,380 --> 00:53:23,630
but it turns out that this particular
900 megahertz radio

805
00:53:23,630 --> 00:53:27,010
the radio set to work at four hundred
megahertz

806
00:53:27,010 --> 00:53:34,010
and it doesn't up

807
00:53:34,580 --> 00:53:39,460
you can understand my confusion turns
out their heterodyne ing their four

808
00:53:39,460 --> 00:53:40,430
hundred megahertz

809
00:53:40,430 --> 00:53:44,640
radio signal to here knows heterodyne K

810
00:53:44,640 --> 00:53:49,440
you guys all have a super heterodyne in
radio very likely or have in the past

811
00:53:49,440 --> 00:53:53,220
had a rating means that you

812
00:53:53,220 --> 00:53:56,740
mixed two singles and you get

813
00:53:56,740 --> 00:54:01,290
to output signals with one base signal

814
00:54:01,290 --> 00:54:06,200
and then plus or minus the other signal
on either side

815
00:54:06,200 --> 00:54:09,650
so what we were seeing was we had a
former mayors radio

816
00:54:09,650 --> 00:54:12,940
and then they were doing their hopping
on a secondary device

817
00:54:12,940 --> 00:54:17,920
which the change channels secondary
device

818
00:54:17,920 --> 00:54:24,170
operates at one point three gir hurts
which Landis right in the 900 megahertz

819
00:54:24,170 --> 00:54:24,750
range

820
00:54:24,750 --> 00:54:29,800
so just reversing this hardware was
rather

821
00:54:29,800 --> 00:54:34,410
odd but you notice the types of things
you can see an embedded space

822
00:54:34,410 --> 00:54:38,350
we hit discover mode

823
00:54:38,350 --> 00:54:41,600
and

824
00:54:41,600 --> 00:54:48,600
we didn't see anything of interest until
I realized

825
00:54:49,200 --> 00:54:53,960
in the process

826
00:54:53,960 --> 00:54:57,230
love the mixing they're flipping the
bits

827
00:54:57,230 --> 00:55:00,260
so that everyone is as your own every 0
is a1

828
00:55:00,260 --> 00:55:03,430
and so as I'm looking for a safe word

829
00:55:03,430 --> 00:55:07,119
10 10 10 10 which is actually a

830
00:55:07,119 --> 00:55:12,770
in the by exodus more a but then

831
00:55:12,770 --> 00:55:17,790
at the end of 5555

832
00:55:17,790 --> 00:55:21,380
which is 0101 0101

833
00:55:21,380 --> 00:55:25,980
the reverse I have this weird thing

834
00:55:25,980 --> 00:55:30,880
that when I invert those bits happens to
be one of the

835
00:55:30,880 --> 00:55:34,230
one of the sink words that i'm looking
for.

836
00:55:34,230 --> 00:55:38,160
the discovery process is painful

837
00:55:38,160 --> 00:55:41,960
sometimes but that's why I'm sharing so
that

838
00:55:41,960 --> 00:55:48,960
if you play you can know you can have a
less painful recently

839
00:55:50,500 --> 00:55:54,210
as I said several vendors have filed
numerous patents

840
00:55:54,210 --> 00:55:57,350
or their FCC filings

841
00:55:57,350 --> 00:56:01,300
are not private there's nothing you can
do when you submit your system to the

842
00:56:01,300 --> 00:56:04,270
FCC we can request that certain parts of
it is confidential

843
00:56:04,270 --> 00:56:09,270
and they won't share publicly I'm one of
the vendors has done this very well

844
00:56:09,270 --> 00:56:11,920
except for one thing that gives away the
american pie still

845
00:56:11,920 --> 00:56:16,010
I'm here are some patents

846
00:56:16,010 --> 00:56:23,010
to Mac and final air that need some
attention if you're interested abuse is

847
00:56:24,000 --> 00:56:24,609
no argument

848
00:56:24,609 --> 00:56:28,619
we r responsible

849
00:56:28,619 --> 00:56:33,560
for ensuring that our world

850
00:56:33,560 --> 00:56:36,690
is secure particularly the stuff that we
depend on

851
00:56:36,690 --> 00:56:40,410
your friend may be the first

852
00:56:40,410 --> 00:56:45,359
insulin related pack to your

853
00:56:45,359 --> 00:56:49,600
power may get turned off by someone

854
00:56:49,600 --> 00:56:56,390
who's played around with the power
equipment it is our job to ensure

855
00:56:56,390 --> 00:57:03,390
that vendor claims are proven true

856
00:57:05,070 --> 00:57:05,440
you very much

