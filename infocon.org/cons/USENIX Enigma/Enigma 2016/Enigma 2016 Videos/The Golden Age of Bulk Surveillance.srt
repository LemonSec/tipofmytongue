1
00:00:00,033 --> 00:00:06,594


2
00:00:06,594 --> 00:00:09,264
[ Applause ]

3
00:00:09,264 --> 00:00:11,726
-Thank you very much.

4
00:00:11,726 --> 00:00:15,495
I'm going to be talking
about not my current research

5
00:00:15,495 --> 00:00:17,660
but more my hobby because,

6
00:00:17,660 --> 00:00:19,924
well, the other thing is,

7
00:00:19,924 --> 00:00:22,066
is if you look
at what I've studied

8
00:00:22,066 --> 00:00:24,396
and you look at
what the NSA does

9
00:00:24,396 --> 00:00:26,825
and you discount
my civil libertarian leanings,

10
00:00:26,825 --> 00:00:29,759
you discount my horrible
management skills,

11
00:00:29,759 --> 00:00:32,066
and you discount my refusal
to get a security clearance,

12
00:00:32,066 --> 00:00:34,363
I'd make a great
technical lead.

13
00:00:34,363 --> 00:00:36,495
Also, during this talk,

14
00:00:36,495 --> 00:00:39,957
I will do a favor
to anybody in government.

15
00:00:39,957 --> 00:00:44,132
There will be
no top-secret Snowden slides,

16
00:00:44,132 --> 00:00:47,792
so you don't have to worry
about classified spillage.

17
00:00:47,792 --> 00:00:51,627
But my hobby is surveillance --

18
00:00:51,627 --> 00:00:54,330
understanding, building,
countering --

19
00:00:54,330 --> 00:00:56,693
because it's fun.

20
00:00:56,693 --> 00:00:59,230
So, first of all,
the intelligence community

21
00:00:59,231 --> 00:01:03,198
has this concept called
NOBUS -- nobody but us.

22
00:01:03,198 --> 00:01:04,363
This is NOBUS.

23
00:01:04,363 --> 00:01:05,924
Because nobody but us

24
00:01:05,924 --> 00:01:08,660
would spend a trillion dollars
on this flying brick

25
00:01:08,660 --> 00:01:13,000
when we're about to overwhelmed
by thousand-dollar drones.

26
00:01:13,000 --> 00:01:15,594
Surveillance tech
is the exact opposite.

27
00:01:15,594 --> 00:01:17,890
It is hardly NOBUS.

28
00:01:17,891 --> 00:01:21,396
It's also not about
finding needles in a haystack

29
00:01:21,396 --> 00:01:24,726
because the problem is,
is they have too many needles.

30
00:01:24,726 --> 00:01:28,924
If you have 5,000 known radicals
in Paris,

31
00:01:28,924 --> 00:01:32,429
of which 4,990 are just people

32
00:01:32,429 --> 00:01:35,330
suffering from rectal-cranial
inversion syndrome,

33
00:01:35,330 --> 00:01:38,000
how do you know
who are the two poison needles

34
00:01:38,000 --> 00:01:39,825
in the needle stack?

35
00:01:39,825 --> 00:01:42,198
It's not about connecting
the dots,

36
00:01:42,198 --> 00:01:44,527
because whenever
something happens,

37
00:01:44,528 --> 00:01:46,792
afterwards, you have this.

38
00:01:46,792 --> 00:01:48,594
Yes, you had
all the dots already,

39
00:01:48,594 --> 00:01:50,461
and you can make
whatever constellation

40
00:01:50,462 --> 00:01:52,429
you want out of it.

41
00:01:52,429 --> 00:01:55,132
Really, it's
about two processes --

42
00:01:55,132 --> 00:01:59,363
drift nets and pulling threats.

43
00:01:59,363 --> 00:02:01,066
So, the idea
on a drift net

44
00:02:01,066 --> 00:02:05,000
is you just cast your net wide
over the entire Internet,

45
00:02:05,000 --> 00:02:08,594
every flow you can get,
on any sensor you can get,

46
00:02:08,594 --> 00:02:12,891
and the goal is to extract
content-derived metadata.

47
00:02:12,891 --> 00:02:14,396
And some
of it's just interesting

48
00:02:14,396 --> 00:02:16,660
like, this is a URL request.

49
00:02:16,660 --> 00:02:18,396
This is an iPhone.

50
00:02:18,396 --> 00:02:21,626
This is an onion URL.

51
00:02:21,627 --> 00:02:24,759
This is a PGP message
signed by this person.

52
00:02:24,759 --> 00:02:28,165
To be honest,
the spooks love PGP.

53
00:02:28,165 --> 00:02:31,132
It's really chatty,
gives you a lot of metadata,

54
00:02:31,132 --> 00:02:33,363
gives you the entire
communication record.

55
00:02:33,363 --> 00:02:36,462
PGP is the NSA's friend.

56
00:02:36,462 --> 00:02:38,660
Doc files --
This is a document.

57
00:02:38,660 --> 00:02:39,957
This is who the author is.

58
00:02:39,957 --> 00:02:41,924
Now if you want to find

59
00:02:41,924 --> 00:02:44,891
all documents written
by Nicholas Weaver,

60
00:02:44,891 --> 00:02:48,197
you then have a very easy way
of finding that.

61
00:02:48,198 --> 00:02:51,528
And then, of course,
this is Mujahideen Secrets.

62
00:02:51,528 --> 00:02:54,957
How many of have heard
of Mujahideen Secrets?

63
00:02:54,957 --> 00:02:56,626
It's jihadi-encrypto.

64
00:02:56,627 --> 00:02:59,396
It is even less
usable than PGP.

65
00:02:59,396 --> 00:03:03,263
And because the brand
is jihadi-encrypto,

66
00:03:03,264 --> 00:03:06,099
this tells you every jihobbyist
on the planet.

67
00:03:06,099 --> 00:03:07,197
It's brilliant.

68
00:03:07,198 --> 00:03:09,792
Whoever at the NSA or GCHQ
invented it,

69
00:03:09,792 --> 00:03:14,297
give them a big Christmas bonus.

70
00:03:14,297 --> 00:03:17,891
But the other part is the notion
of pulling threads.

71
00:03:17,891 --> 00:03:20,165
You've gathered
all this huge amount

72
00:03:20,165 --> 00:03:21,560
of information,

73
00:03:21,561 --> 00:03:23,660
and you want to follow it
along to see

74
00:03:23,660 --> 00:03:24,957
where it leads

75
00:03:24,957 --> 00:03:28,462
because you start with
some little piece of data --

76
00:03:28,462 --> 00:03:32,494
a URL visit, a name,
a keyword --

77
00:03:32,495 --> 00:03:35,132
and you follow
where that goes along.

78
00:03:35,132 --> 00:03:37,825
And this is very interesting
because it means there's kind

79
00:03:37,825 --> 00:03:40,462
of this scale gap
in these systems.

80
00:03:40,462 --> 00:03:43,263
They're really good
once you have a single target

81
00:03:43,264 --> 00:03:44,759
and are following along.

82
00:03:44,759 --> 00:03:46,000
They're really good

83
00:03:46,000 --> 00:03:48,627
for casting drift nets
over the entire Internet

84
00:03:48,627 --> 00:03:52,660
and finding any record
of this type.

85
00:03:52,660 --> 00:03:56,198
They really don't work well
when you have your needle stack

86
00:03:56,198 --> 00:04:00,924
of 5,000
rectal-cranial inversion cases.

87
00:04:00,924 --> 00:04:03,726
So, let's actually
put this in action.

88
00:04:03,726 --> 00:04:09,726
And this is a hypothetical case
merged from actual cases.

89
00:04:09,726 --> 00:04:12,825
So, some analyst is watching
an IRC chat room,

90
00:04:12,825 --> 00:04:15,329
and Mr. AnonDude,
they want to know

91
00:04:15,330 --> 00:04:19,858
who it is because he's
a small-script kiddie suffering

92
00:04:19,858 --> 00:04:22,693
from rectal-cranial
inversion syndrome.

93
00:04:22,693 --> 00:04:26,264
And so all you know is that,
at this time,

94
00:04:26,264 --> 00:04:31,132
AnonDude visited this URL.

95
00:04:31,132 --> 00:04:33,033
That's not
very much information,

96
00:04:33,033 --> 00:04:35,198
but, thanks
to the bulk surveillance systems

97
00:04:35,198 --> 00:04:36,429
you've built,

98
00:04:36,429 --> 00:04:38,659
you can find out
who he is.

99
00:04:38,660 --> 00:04:40,627
And this, depending
on your term,

100
00:04:40,627 --> 00:04:43,528
is either the digital networks
intelligence flow

101
00:04:43,528 --> 00:04:45,594
or the signals
intelligence flow.

102
00:04:45,594 --> 00:04:48,198
And this allows you to identify
who he is,

103
00:04:48,198 --> 00:04:49,527
get all his network traffic,

104
00:04:49,528 --> 00:04:53,264
get his pattern in life,
know his taste in porn.

105
00:04:53,264 --> 00:04:57,165
And then step two is
computer-network exploitation.

106
00:04:57,165 --> 00:05:00,957
Basically, the flow
is capture all,

107
00:05:00,957 --> 00:05:02,495
identify all,

108
00:05:02,495 --> 00:05:05,099
and, once you find somebody
you actually want to target,

109
00:05:05,099 --> 00:05:07,296
exploit by name.

110
00:05:07,297 --> 00:05:11,330
So, it starts with
your network of wiretaps.

111
00:05:11,330 --> 00:05:14,164
And if you're
an intelligence agency,

112
00:05:14,165 --> 00:05:16,000
you have friends.

113
00:05:16,000 --> 00:05:18,891
Well, if you're a U.S.
intelligence agency,

114
00:05:18,891 --> 00:05:20,132
you have friends.

115
00:05:20,132 --> 00:05:21,462
And they've installed a series

116
00:05:21,462 --> 00:05:26,000
of wiretaps running
software you've provided,

117
00:05:26,000 --> 00:05:28,033
and they're all over the planet.

118
00:05:28,033 --> 00:05:29,792
In fact, I made a mistake.

119
00:05:29,792 --> 00:05:35,659
About the only place these taps
aren't is on U.S. soil.

120
00:05:35,660 --> 00:05:38,759
But how does
an Internet wiretap work?

121
00:05:38,759 --> 00:05:41,033
Well, it's
just a network-intrusion

122
00:05:41,033 --> 00:05:43,099
detection system.

123
00:05:43,099 --> 00:05:44,627
Network-intrusion detection,

124
00:05:44,627 --> 00:05:48,528
bulk-surveillance monitoring
are the same thing.

125
00:05:48,528 --> 00:05:52,132
You have a tap on the wire,
a high-volume filter

126
00:05:52,132 --> 00:05:55,627
to ignore stuff,
a load-balancer,

127
00:05:55,627 --> 00:05:57,858
and then a bunch
of processing nodes.

128
00:05:57,858 --> 00:06:00,495
And if you have
multi-core systems, basically,

129
00:06:00,495 --> 00:06:03,660
your multi-core systems
are clusters of clusters.

130
00:06:03,660 --> 00:06:05,264
So, a packet comes in.

131
00:06:05,264 --> 00:06:08,462
It gets examined
by this high-volume filter.

132
00:06:08,462 --> 00:06:09,957
Is this BitTorrent?

133
00:06:09,957 --> 00:06:11,363
If it's BitTorrent,
we ignore it.

134
00:06:11,363 --> 00:06:13,495
So a few simple rules
of all the crud

135
00:06:13,495 --> 00:06:14,792
you don't want to care about --

136
00:06:14,792 --> 00:06:16,924
BitTorrent, Netflix video,

137
00:06:16,924 --> 00:06:20,792
YouTube videos -- eh.

138
00:06:20,792 --> 00:06:22,263
Then you have the load balancer,

139
00:06:22,264 --> 00:06:23,759
and what the load balancer does

140
00:06:23,759 --> 00:06:25,660
is it looks at
the packet headers

141
00:06:25,660 --> 00:06:29,264
and it just hashes the source
and destination I.P.

142
00:06:29,264 --> 00:06:32,330
And everybody who builds
a scalable network-intrusion

143
00:06:32,330 --> 00:06:33,627
detection system

144
00:06:33,627 --> 00:06:35,660
does this because it's
how you load balance.

145
00:06:35,660 --> 00:06:38,066
China does this for
the Great Firewall.

146
00:06:38,066 --> 00:06:40,296
We do this
when we're building NIDS

147
00:06:40,297 --> 00:06:43,264
for 100-gig links.

148
00:06:43,264 --> 00:06:46,297
And then that just routes
to a processing node,

149
00:06:46,297 --> 00:06:49,429
and this is old, known tech.

150
00:06:49,429 --> 00:06:50,693
This high-volume filter

151
00:06:50,693 --> 00:06:52,495
and load-balancer stuff
these days,

152
00:06:52,495 --> 00:06:54,891
buy an OpenFlow switch.

153
00:06:54,891 --> 00:06:56,495
Lawrence Berkeley
National Labs

154
00:06:56,495 --> 00:06:59,957
is building
a 100-gigabit Bro system

155
00:06:59,957 --> 00:07:01,693
using an OpenFlow switch

156
00:07:01,693 --> 00:07:06,330
to handle this load-balancing,
high-volume garbage reject.

157
00:07:06,330 --> 00:07:09,099
And once you have
your load balancer,

158
00:07:09,099 --> 00:07:11,164
you have this linear scaling.

159
00:07:11,165 --> 00:07:15,000
You can scale up, throw
10 times the machines at it.

160
00:07:15,000 --> 00:07:17,198
You have 10 times the bandwidth.

161
00:07:17,198 --> 00:07:18,594
And 1u system

162
00:07:18,594 --> 00:07:20,792
gives you about 1 to 5 gigabits
a second,

163
00:07:20,792 --> 00:07:22,726
depending on how good
your code is.

164
00:07:22,726 --> 00:07:24,099
And you can also scale down.

165
00:07:24,099 --> 00:07:27,396
You can scale down
to 100-megabit or 10-megabit

166
00:07:27,396 --> 00:07:31,792
by buying cheap, little systems.

167
00:07:31,792 --> 00:07:34,131
So, how do these systems work?

168
00:07:34,132 --> 00:07:36,957
Well, it's
very conventional NIDS.

169
00:07:36,957 --> 00:07:38,198
You reassemble the traffic.

170
00:07:38,198 --> 00:07:39,924
So all the packets
are coming in pieces,

171
00:07:39,924 --> 00:07:44,659
and the pieces get put together
into coherent flows.

172
00:07:44,660 --> 00:07:47,000
And now,
once they're in coherent flows,

173
00:07:47,000 --> 00:07:48,924
then you parse the traffic.

174
00:07:48,924 --> 00:07:51,462
So you go,
this is a web request,

175
00:07:51,462 --> 00:07:52,561
this is the URL,

176
00:07:52,561 --> 00:07:54,296
this is the host header
and all of that,

177
00:07:54,297 --> 00:07:58,231
and this is all your
content-derived metadata.

178
00:07:58,231 --> 00:08:01,693
This is a URL request
that has an identifier in it.

179
00:08:01,693 --> 00:08:07,132
This is a mail message
with some guy to another guy.

180
00:08:07,132 --> 00:08:08,660
One thing that's important --

181
00:08:08,660 --> 00:08:11,264
These guys don't have to worry
as much about evasion.

182
00:08:11,264 --> 00:08:13,363
So when we're building
network-intrusion

183
00:08:13,363 --> 00:08:14,858
detection systems,

184
00:08:14,858 --> 00:08:17,495
we worry about bad guys
sending messages

185
00:08:17,495 --> 00:08:19,660
that the NIDS
will interpret one way

186
00:08:19,660 --> 00:08:22,198
and the end system
will interpret the other.

187
00:08:22,198 --> 00:08:25,363
These guys,
the evasion is you use Tor.

188
00:08:25,363 --> 00:08:29,561
So these guys actually
have an easier problem.

189
00:08:29,561 --> 00:08:31,890
So, if you want
to build this yourself, well,

190
00:08:31,891 --> 00:08:33,627
I said NIDS are a commodity.

191
00:08:33,626 --> 00:08:34,957
Download them.

192
00:08:34,957 --> 00:08:38,726
The one I like is the Bro
Network Security Monitor.

193
00:08:38,726 --> 00:08:41,462
I use that in my demo.

194
00:08:41,462 --> 00:08:43,297
It includes protocol parsers.

195
00:08:43,297 --> 00:08:45,264
It's real-time operation.

196
00:08:45,264 --> 00:08:48,066
The disadvantage is it requires
seeing both sides of traffic,

197
00:08:48,066 --> 00:08:49,495
so you aren't going to be able

198
00:08:49,495 --> 00:08:53,693
to put this
on a network backbone.

199
00:08:53,693 --> 00:08:55,891
You can
Lockheed Martin's Vortex,

200
00:08:55,891 --> 00:08:58,858
which is a near-real-time
reassembly engine.

201
00:08:58,858 --> 00:09:03,000
So it takes the streams,
turns them into files,

202
00:09:03,000 --> 00:09:05,924
and then, when you receive
the whole communication flow,

203
00:09:05,924 --> 00:09:10,132
it then invokes programs on it.

204
00:09:10,132 --> 00:09:12,924
It's GPL.
You can download it from GitHub,

205
00:09:12,924 --> 00:09:16,329
and a outstanding bet
that our friends in Fort Meade

206
00:09:16,330 --> 00:09:21,264
started their big systems
based on this.

207
00:09:21,264 --> 00:09:22,726
You can always
just write a check.

208
00:09:22,726 --> 00:09:26,792
There's this company called
Nexa, used to be called Amesys.

209
00:09:26,792 --> 00:09:29,297
They sell commercial
intelligence

210
00:09:29,297 --> 00:09:32,792
interception packets
designed for network backbones.

211
00:09:32,792 --> 00:09:34,462
They call it GLINT

212
00:09:34,462 --> 00:09:37,165
because it's
global intelligence.

213
00:09:37,165 --> 00:09:40,000
And they advertise it
right at the start --

214
00:09:40,000 --> 00:09:43,627
It looks at all the traffic.

215
00:09:43,627 --> 00:09:45,429
Now, when you're doing
intelligence

216
00:09:45,429 --> 00:09:48,891
rather than intrusion detection,

217
00:09:48,891 --> 00:09:50,924
there is one real
important difference.

218
00:09:50,924 --> 00:09:52,363
You care about people.

219
00:09:52,363 --> 00:09:55,165
So you've captured all.
You want to identify them.

220
00:09:55,165 --> 00:09:58,660
So, in this web page, well,
you know who the username is.

221
00:09:58,660 --> 00:10:01,396
And if you look at the content
on that site,

222
00:10:01,396 --> 00:10:05,396
you see this is
how the username is structured,

223
00:10:05,396 --> 00:10:07,264
this is how the cookies
are structured,

224
00:10:07,264 --> 00:10:09,330
and so you basically just
write an IDS rule

225
00:10:09,330 --> 00:10:12,396
that, when you see this website,
you grab the username,

226
00:10:12,396 --> 00:10:14,495
you grab the cookie,
match them together --

227
00:10:14,495 --> 00:10:16,627
You know who it is.

228
00:10:16,627 --> 00:10:19,858
Likewise, all those anonymous
tracking cookies

229
00:10:19,858 --> 00:10:22,065
for targeted advertisement,

230
00:10:22,066 --> 00:10:24,924
they don't call it targeting
for no reason at all.

231
00:10:24,924 --> 00:10:27,000
You can de-anonymize those.

232
00:10:27,000 --> 00:10:29,528
So if we have a request,

233
00:10:29,528 --> 00:10:31,330
two separate requests

234
00:10:31,330 --> 00:10:33,528
with the same referer
from the same user

235
00:10:33,528 --> 00:10:36,693
at the same time for
two different tracking domains

236
00:10:36,693 --> 00:10:38,297
and tracking cookies,

237
00:10:38,297 --> 00:10:40,561
now you can bind them together

238
00:10:40,561 --> 00:10:43,825
so that you can go
from identify the user

239
00:10:43,825 --> 00:10:45,825
with the user-tracking cookie,

240
00:10:45,825 --> 00:10:48,396
identify the common cookies,

241
00:10:48,396 --> 00:10:50,396
and then the other thing
you do is bulk record.

242
00:10:50,396 --> 00:10:53,296
Santa, please give me one
of these things.

243
00:10:53,297 --> 00:10:56,594
Network people
love big amounts of disks.

244
00:10:56,594 --> 00:10:58,264
When it doubt,
record it all,

245
00:10:58,264 --> 00:11:00,363
and then you just
search through it.

246
00:11:00,363 --> 00:11:02,165
So if you need to search
through something,

247
00:11:02,165 --> 00:11:04,329
there are tricks you can do
to make it efficient,

248
00:11:04,330 --> 00:11:06,033
or you just grind
through all the data.

249
00:11:06,033 --> 00:11:08,429
Hey, it's just data.

250
00:11:08,429 --> 00:11:11,429
Now, the key in building
an intelligence system

251
00:11:11,429 --> 00:11:14,462
out of this
is also adding federated search.

252
00:11:14,462 --> 00:11:17,825
So you're gathering
this huge amount of information,

253
00:11:17,825 --> 00:11:19,594
and shipping it back to HQ,

254
00:11:19,594 --> 00:11:21,297
for the most part,
you don't want to do.

255
00:11:21,297 --> 00:11:24,825
Instead, you ship the query
to the taps.

256
00:11:24,825 --> 00:11:26,495
So you do a single query.

257
00:11:26,495 --> 00:11:28,759
It runs on
some or all of the taps.

258
00:11:28,759 --> 00:11:30,231
You have a setting

259
00:11:30,231 --> 00:11:34,297
of run on these allies taps
and not those allies taps

260
00:11:34,297 --> 00:11:38,627
because we don't wan this ally
to know we're spying on them.

261
00:11:38,627 --> 00:11:39,858
And then the other thing is,

262
00:11:39,858 --> 00:11:41,891
is you do have
some centralized data.

263
00:11:41,891 --> 00:11:44,726
So the bulk
of the metadata is too big,

264
00:11:44,726 --> 00:11:47,627
but certain things
like this is a page view

265
00:11:47,627 --> 00:11:49,957
for this user
with this cookie from this I.P.

266
00:11:49,957 --> 00:11:52,330
at this time,
that's useful data

267
00:11:52,330 --> 00:11:54,561
that you actually might want
to keep around for months

268
00:11:54,561 --> 00:11:56,429
and search centrally.

269
00:11:56,429 --> 00:11:59,264
And so that's
what Hadoop is for.

270
00:11:59,264 --> 00:12:00,825
And the easiest way
to do this

271
00:12:00,825 --> 00:12:03,627
is create
query-focused data sets.

272
00:12:03,627 --> 00:12:06,957
So you take this data
into your central location,

273
00:12:06,957 --> 00:12:08,957
and you put it in buckets.

274
00:12:08,957 --> 00:12:11,165
So if you want to search
by I.P.,

275
00:12:11,165 --> 00:12:12,858
you look in the I.P. bucket.

276
00:12:12,858 --> 00:12:14,693
If you look in the --
want username,

277
00:12:14,693 --> 00:12:16,792
you do it the username bucket.

278
00:12:16,792 --> 00:12:18,792
And you don't fully sort.

279
00:12:18,792 --> 00:12:20,198
You kind of quasi-sort,

280
00:12:20,198 --> 00:12:22,363
so these are basically
hash buckets.

281
00:12:22,363 --> 00:12:25,000
Because one
of the little things on Hadoop

282
00:12:25,000 --> 00:12:27,363
is accessing one byte on disk

283
00:12:27,363 --> 00:12:30,099
is the same
as accessing 64 megabytes,

284
00:12:30,099 --> 00:12:32,396
so why bother sorting too much?

285
00:12:32,396 --> 00:12:35,891
And so if you need to look
up somebody's username,

286
00:12:35,891 --> 00:12:37,296
you know who the username is.

287
00:12:37,297 --> 00:12:40,231
You just look in that bucket,
and you know his history.

288
00:12:40,231 --> 00:12:42,825
You want to know
who's been at that I.P.,

289
00:12:42,825 --> 00:12:44,561
you look in the I.P. bucket.

290
00:12:44,561 --> 00:12:46,297
And this is all easy.

291
00:12:46,297 --> 00:12:48,429
And this is
how the magic works.

292
00:12:48,429 --> 00:12:51,593
So, you start with
that BBC page view.

293
00:12:51,594 --> 00:12:54,528
You query for
the associated double-click ad.

294
00:12:54,528 --> 00:12:58,000
I love double-click!
It's great!

295
00:12:58,000 --> 00:13:00,858
Then you look at
that double-click cookie,

296
00:13:00,858 --> 00:13:04,693
and you query the database
for the linked user I.D.s

297
00:13:04,693 --> 00:13:06,198
because that's metadata

298
00:13:06,198 --> 00:13:08,132
that's small enough
that you put back

299
00:13:08,132 --> 00:13:09,593
in your central repository.

300
00:13:09,594 --> 00:13:12,363
So now you know
his Yahoo cookie,

301
00:13:12,363 --> 00:13:14,759
his this cookie,
his that cookie.

302
00:13:14,759 --> 00:13:17,825
So all the cookies that
are tracking, you know those.

303
00:13:17,825 --> 00:13:19,825
You also know who he is.

304
00:13:19,825 --> 00:13:22,693
Cool!

305
00:13:22,693 --> 00:13:28,000
Now you use those cookies
to get the I.P. history.

306
00:13:28,000 --> 00:13:31,066
If he didn't log
in from his VPN once

307
00:13:31,066 --> 00:13:33,957
and didn't clear his cookies
all the time, well,

308
00:13:33,957 --> 00:13:36,593
now you know his home address.

309
00:13:36,594 --> 00:13:37,759
And now you toss that

310
00:13:37,759 --> 00:13:39,726
in your I.P.
intelligence database.

311
00:13:39,726 --> 00:13:42,396
This is basically geo I.P.
on steroids.

312
00:13:42,396 --> 00:13:45,132
So all those lovely Android ads

313
00:13:45,132 --> 00:13:48,791
that broadcast
your GPS location, well,

314
00:13:48,792 --> 00:13:50,858
those get thrown
into a central database

315
00:13:50,858 --> 00:13:54,000
so they know
what every address is.

316
00:13:54,000 --> 00:13:56,660
And this is the I.P.
intelligence database.

317
00:13:56,660 --> 00:13:58,098
And now you know
where his house is.

318
00:13:58,099 --> 00:14:00,825
And if he's in Syria,
you drop a drone on him.

319
00:14:00,825 --> 00:14:04,528
If he's in Sweden,
you do nothing.

320
00:14:04,528 --> 00:14:06,297
But in either case, let's say

321
00:14:06,297 --> 00:14:08,495
you want to take over
his computer.

322
00:14:08,495 --> 00:14:11,396
Well, that's easy.

323
00:14:11,396 --> 00:14:13,858
And you can do this
quite easily.

324
00:14:13,858 --> 00:14:16,593
So, his computer
does a web request.

325
00:14:16,594 --> 00:14:19,330
It passes another wiretap
you have,

326
00:14:19,330 --> 00:14:22,858
and the wiretap sees, "Oh, this
is for a bit of JavaScript

327
00:14:22,858 --> 00:14:25,263
for a domain
I understand and a cookie

328
00:14:25,264 --> 00:14:29,858
that identifies this person
as somebody I want to attack."

329
00:14:29,858 --> 00:14:31,263
And all I do

330
00:14:31,264 --> 00:14:34,660
is craft an injected packet
and send it back.

331
00:14:34,660 --> 00:14:38,098
And as long as my packet
arrives before his does,

332
00:14:38,099 --> 00:14:41,660
well, his computer
starts running this.

333
00:14:41,660 --> 00:14:44,132
Superduper top-secret stuff.

334
00:14:44,132 --> 00:14:46,527
It's called
Airpwn without the goatse.

335
00:14:46,528 --> 00:14:49,033
This is the stuff
used to pull pranks

336
00:14:49,033 --> 00:14:50,891
on Wi-Fi networks.

337
00:14:50,891 --> 00:14:53,824
You just remove the goatse,
put it on the backbone,

338
00:14:53,825 --> 00:14:55,363
and, hey, call it good.

339
00:14:55,363 --> 00:14:57,000
Or if you want to buy it,
there's a company

340
00:14:57,000 --> 00:14:59,693
called Hacking Team
that will sell this to you.

341
00:14:59,693 --> 00:15:01,528
They will charge
a million bucks for it

342
00:15:01,528 --> 00:15:05,858
because they're basically
a defense contractor.

343
00:15:05,858 --> 00:15:08,165
And once the user's computer

344
00:15:08,165 --> 00:15:11,528
is now processing
that injected packet, well,

345
00:15:11,528 --> 00:15:14,462
it then goes off and fetches
this bit of JavaScript

346
00:15:14,462 --> 00:15:16,363
from your server.

347
00:15:16,363 --> 00:15:20,594
Your server goes, "Okay,
who is it in this request?"

348
00:15:20,594 --> 00:15:22,198
You encode who
I want to target

349
00:15:22,198 --> 00:15:24,363
and how aggressively I
want to target.

350
00:15:24,363 --> 00:15:30,132
And you basically send back
a bit of exploit.

351
00:15:30,132 --> 00:15:34,296
Again, some superduper
top-secret tool.

352
00:15:34,297 --> 00:15:35,858
It's called Metasploit.

353
00:15:35,858 --> 00:15:37,693
You can download it.

354
00:15:37,693 --> 00:15:41,132
Okay, or you can pay
Hacking Team or FinFisher

355
00:15:41,132 --> 00:15:43,065
a huge amount of money.

356
00:15:43,066 --> 00:15:45,363
And the big thing is,
is the zero days

357
00:15:45,363 --> 00:15:47,561
that you're using
for the exploit,

358
00:15:47,561 --> 00:15:50,627
and, well, there's
a thriving market for that, too.

359
00:15:50,627 --> 00:15:52,924
Go out and buy it.

360
00:15:52,924 --> 00:15:55,033
Now, once his computer
is exploited,

361
00:15:55,033 --> 00:15:56,891
he then goes and says,

362
00:15:56,891 --> 00:16:02,296
"I want what the intelligence
community calls an implant."

363
00:16:02,297 --> 00:16:04,759
And it's now kind
of what the A.V. community

364
00:16:04,759 --> 00:16:06,198
starts to call an implant.

365
00:16:06,198 --> 00:16:07,627
But to be honest,

366
00:16:07,627 --> 00:16:09,495
all it is is
what we'd call a RAT,

367
00:16:09,495 --> 00:16:12,825
a remote-accessed toolkit.

368
00:16:12,825 --> 00:16:14,825
You can download
these for 50 bucks.

369
00:16:14,825 --> 00:16:17,000
You can download
more expensive ones.

370
00:16:17,000 --> 00:16:20,330
You can buy them, again,
from Hacking Team and FinFisher.

371
00:16:20,330 --> 00:16:21,891
There's all sorts of vendors.

372
00:16:21,891 --> 00:16:23,296
If you're
an intelligence agency,

373
00:16:23,297 --> 00:16:25,132
you can do them in-house.

374
00:16:25,132 --> 00:16:26,693
Although, to be honest,

375
00:16:26,693 --> 00:16:28,924
the best is probably
the black-market stuff

376
00:16:28,924 --> 00:16:30,924
because it's nicely deniable.

377
00:16:30,924 --> 00:16:34,396
Because, well,
you just got owned by a RAT.

378
00:16:34,396 --> 00:16:36,660
Was it the Chinese, the French,

379
00:16:36,660 --> 00:16:39,462
or some script kiddie
in Germany?

380
00:16:39,462 --> 00:16:42,660
You don't know.
And that's it.

381
00:16:42,660 --> 00:16:45,858
That's the entire basis
of the flow.

382
00:16:45,858 --> 00:16:47,957
And I've ranted that it's easy,

383
00:16:47,957 --> 00:16:51,759
but, well...

384
00:16:51,759 --> 00:16:54,231
I built it myself.

385
00:16:54,231 --> 00:16:57,033
Unfortunately, my demo
decided to eat its hard drive,

386
00:16:57,033 --> 00:16:58,924
so you get the canned version,

387
00:16:58,924 --> 00:17:01,891
which consists on an Intel NUC

388
00:17:01,891 --> 00:17:04,858
and a dual-comm tap.

389
00:17:04,858 --> 00:17:06,528
Amazon Prime's
a wonderful thing.

390
00:17:06,528 --> 00:17:09,528
It's even cheaper these days.

391
00:17:09,528 --> 00:17:11,396
U.I. is down.

392
00:17:11,396 --> 00:17:12,659
Really good
for hotel wiring closets.

393
00:17:12,660 --> 00:17:15,528
This is the Mayflower Hotel
in Washington, D.C.,

394
00:17:15,528 --> 00:17:17,693
for a DHS P.I. meeting.

395
00:17:17,693 --> 00:17:19,660
I freaked out
and locked the door,

396
00:17:19,660 --> 00:17:23,231
but the Telco cabinet was open
across from my room.

397
00:17:23,231 --> 00:17:26,560
So I provide
a nice web interface.

398
00:17:26,560 --> 00:17:28,197
You can do a raw search.

399
00:17:28,198 --> 00:17:31,099
So search for anything
with that article.

400
00:17:31,099 --> 00:17:33,561
Check to see that,
"Oh, yes, this is the article,

401
00:17:33,561 --> 00:17:36,033
so this is the guy
I'm looking for."

402
00:17:36,033 --> 00:17:37,759
So now, at that I.P.,

403
00:17:37,759 --> 00:17:40,264
well, we know what the cookies
are that are seen.

404
00:17:40,264 --> 00:17:43,099
And now we look at
the double-click cookie.

405
00:17:43,099 --> 00:17:44,297
Double-click cookie's great

406
00:17:44,297 --> 00:17:45,792
because it gets
the other address

407
00:17:45,792 --> 00:17:47,330
that he was active at.

408
00:17:47,330 --> 00:17:49,428
And the associated
Yahoo cookie --

409
00:17:49,429 --> 00:17:51,759
Now you know who he is.

410
00:17:51,759 --> 00:17:53,561
Now you know
everything about him.

411
00:17:53,561 --> 00:17:54,659
That's easy.

412
00:17:54,660 --> 00:17:57,396
It's a very simple,
standard flow,

413
00:17:57,396 --> 00:18:00,132
and unfortunately,
some disgruntled sysadmin

414
00:18:00,132 --> 00:18:04,231
told the rest of the world
this was how to do it.

415
00:18:04,231 --> 00:18:06,891
And then, well, you can task it.

416
00:18:06,891 --> 00:18:09,660
So tasking means,
well, look for it

417
00:18:09,660 --> 00:18:12,429
and send an implant.

418
00:18:12,429 --> 00:18:13,957
And this is hobby-level stuff.

419
00:18:13,957 --> 00:18:15,627
This is literally my hobby --

420
00:18:15,627 --> 00:18:17,858
Okay, fairly extensive hobby,

421
00:18:17,858 --> 00:18:19,594
but it's hobby.

422
00:18:19,594 --> 00:18:22,495
So, an important question --
Who are your friends?

423
00:18:22,495 --> 00:18:26,264
Well, if you're in the countries
in blue -- good news --

424
00:18:26,264 --> 00:18:28,296
all the countries
in blue are your friends.

425
00:18:28,297 --> 00:18:30,363
And these
are the intelligence agencies

426
00:18:30,363 --> 00:18:32,825
you don't have to worry about.

427
00:18:32,825 --> 00:18:34,198
I really like not having

428
00:18:34,198 --> 00:18:35,891
to worry about those guys
in Fort Meade.

429
00:18:35,891 --> 00:18:37,726
They're my friends.

430
00:18:37,726 --> 00:18:39,660
If you're in the county
in blue, however,

431
00:18:39,660 --> 00:18:42,528
on this one, well, this
is the only intelligence agency

432
00:18:42,528 --> 00:18:43,924
you don't have to worry about,

433
00:18:43,924 --> 00:18:45,561
which is actually
really good news

434
00:18:45,561 --> 00:18:47,396
because the French
intelligence agency

435
00:18:47,396 --> 00:18:50,231
is really good
and really notorious.

436
00:18:50,231 --> 00:18:52,726
If you're in, say,
Russia or China, however,

437
00:18:52,726 --> 00:18:54,891
the countries in blue
are the ones

438
00:18:54,891 --> 00:18:56,891
you don't have
to worry about.

439
00:18:56,891 --> 00:19:00,495
So, what do we need to do now?

440
00:19:00,495 --> 00:19:01,758
Go dark.

441
00:19:01,759 --> 00:19:05,297
We are in a world
where, if your adversary

442
00:19:05,297 --> 00:19:07,858
can see your traffic,

443
00:19:07,858 --> 00:19:11,462
sufficient to identify you
as a valid target --

444
00:19:11,462 --> 00:19:13,693
and this could be
just your I.P. addresses,

445
00:19:13,693 --> 00:19:16,627
you belong
to the State Department --

446
00:19:16,627 --> 00:19:19,000
and your traffic is unencrypted,

447
00:19:19,000 --> 00:19:21,396
that is a attack vector,

448
00:19:21,396 --> 00:19:23,792
not an information link.

449
00:19:23,792 --> 00:19:25,824
This is key.

450
00:19:25,825 --> 00:19:29,264
Unencrypted traffic
is a vulnerability.

451
00:19:29,264 --> 00:19:34,000
Because in the end, what's
the opposite of nobody but us?

452
00:19:34,000 --> 00:19:35,693
Undergraduate
homework assignments.

453
00:19:42,132 --> 00:19:44,198
Questions?

454
00:19:44,198 --> 00:19:47,132
[ Applause ]

455
00:19:47,132 --> 00:19:46,132


