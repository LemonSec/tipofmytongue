1
00:00:08,320 --> 00:00:08,639
hi

2
00:00:08,639 --> 00:00:10,400
my name is cooper clinton and today

3
00:00:10,400 --> 00:00:12,400
we're going to talk about detecting 4g

4
00:00:12,400 --> 00:00:15,759
base stations in real time

5
00:00:15,759 --> 00:00:18,880
i am a a little bit about myself i am a

6
00:00:18,880 --> 00:00:20,400
senior security researcher with the

7
00:00:20,400 --> 00:00:22,240
electronic frontier foundation

8
00:00:22,240 --> 00:00:24,640
i have a toddler and a newborn uh so

9
00:00:24,640 --> 00:00:26,320
you'll have to forgive the dad jokes and

10
00:00:26,320 --> 00:00:27,920
the bags under my eyes

11
00:00:27,920 --> 00:00:29,599
and i'm a former teenage phone freak

12
00:00:29,599 --> 00:00:31,359
which might explain why i got into the

13
00:00:31,359 --> 00:00:32,719
work that i'm doing

14
00:00:32,719 --> 00:00:34,800
if you're not familiar with eff we are a

15
00:00:34,800 --> 00:00:36,320
member supported non-profit

16
00:00:36,320 --> 00:00:38,559
we defend civil liberties as they

17
00:00:38,559 --> 00:00:39,760
intersect with technology

18
00:00:39,760 --> 00:00:42,320
so we think that your rights to freedom

19
00:00:42,320 --> 00:00:44,399
of expression and your right to privacy

20
00:00:44,399 --> 00:00:46,160
come with you online and come with you

21
00:00:46,160 --> 00:00:47,760
when you're working with technology as

22
00:00:47,760 --> 00:00:48,320
well as

23
00:00:48,320 --> 00:00:50,640
in the so-called real world and we've

24
00:00:50,640 --> 00:00:52,800
been doing this work for 30 years

25
00:00:52,800 --> 00:00:54,559
and specifically i work in the threat

26
00:00:54,559 --> 00:00:57,039
lab at eff and i'll talk a little bit

27
00:00:57,039 --> 00:00:59,120
more about that in a second but first i

28
00:00:59,120 --> 00:01:00,559
want to take a second to thank my

29
00:01:00,559 --> 00:01:01,760
colleague yamana

30
00:01:01,760 --> 00:01:04,319
this is as much her work as mine and

31
00:01:04,319 --> 00:01:06,159
although she can't be here to present

32
00:01:06,159 --> 00:01:07,760
this with me

33
00:01:07,760 --> 00:01:09,840
this is really her project too and i

34
00:01:09,840 --> 00:01:11,520
want to thank her a lot and if you liked

35
00:01:11,520 --> 00:01:12,320
the work

36
00:01:12,320 --> 00:01:14,240
that we did check her out on twitter at

37
00:01:14,240 --> 00:01:16,960
rival elf

38
00:01:17,520 --> 00:01:20,080
so what is threat lab threat lab is the

39
00:01:20,080 --> 00:01:21,280
division of eff

40
00:01:21,280 --> 00:01:22,799
that looks at technology that

41
00:01:22,799 --> 00:01:25,600
specifically targets at-risk people

42
00:01:25,600 --> 00:01:28,080
by irish people i mean activists human

43
00:01:28,080 --> 00:01:29,119
rights defenders

44
00:01:29,119 --> 00:01:31,840
journalists domestic abuse victims

45
00:01:31,840 --> 00:01:32,479
immigrants

46
00:01:32,479 --> 00:01:34,720
sex workers minority groups political

47
00:01:34,720 --> 00:01:36,320
dissidents etc

48
00:01:36,320 --> 00:01:38,400
and the goals of this technology are

49
00:01:38,400 --> 00:01:41,040
often to gather intelligence on

50
00:01:41,040 --> 00:01:44,240
opposition or on decision groups to spy

51
00:01:44,240 --> 00:01:46,000
extra territorially when people have

52
00:01:46,000 --> 00:01:46,399
left

53
00:01:46,399 --> 00:01:47,840
your country and you can no longer spy

54
00:01:47,840 --> 00:01:49,759
on them through traditional means to

55
00:01:49,759 --> 00:01:52,079
locate and capture people to harass them

56
00:01:52,079 --> 00:01:54,880
and overall generally to stifle people's

57
00:01:54,880 --> 00:01:56,079
freedom of expression

58
00:01:56,079 --> 00:01:57,759
and prevent them from doing the work

59
00:01:57,759 --> 00:02:00,399
that they do

60
00:02:00,880 --> 00:02:03,680
so typically at threat lab we look at

61
00:02:03,680 --> 00:02:05,920
things like state-sponsored malware

62
00:02:05,920 --> 00:02:08,639
or or applications that spy on people

63
00:02:08,639 --> 00:02:09,280
and we have

64
00:02:09,280 --> 00:02:11,680
a couple of reports out about that that

65
00:02:11,680 --> 00:02:14,080
you can check out on the eff website

66
00:02:14,080 --> 00:02:15,920
but today i'm going to talk about a

67
00:02:15,920 --> 00:02:17,280
different project that we worked on

68
00:02:17,280 --> 00:02:19,280
around cell site simulators

69
00:02:19,280 --> 00:02:20,959
and first let's talk about what is a

70
00:02:20,959 --> 00:02:22,319
cell site simulator

71
00:02:22,319 --> 00:02:24,720
a cell science emitter is generally a

72
00:02:24,720 --> 00:02:26,720
transmitter and or receiver

73
00:02:26,720 --> 00:02:28,800
that intercepts metadata from cellular

74
00:02:28,800 --> 00:02:30,640
phones often by masquerading as a

75
00:02:30,640 --> 00:02:32,640
legitimate cell tower

76
00:02:32,640 --> 00:02:34,879
it also goes by the name mc catchers

77
00:02:34,879 --> 00:02:36,640
stingray hail storm

78
00:02:36,640 --> 00:02:38,319
or fake base station and for the

79
00:02:38,319 --> 00:02:39,920
purposes of this talk

80
00:02:39,920 --> 00:02:41,920
we will use all of those terms

81
00:02:41,920 --> 00:02:43,599
interchangeably and they can all be

82
00:02:43,599 --> 00:02:44,480
considered to mean

83
00:02:44,480 --> 00:02:47,679
basically the same thing

84
00:02:48,480 --> 00:02:51,519
so we first got interested in detecting

85
00:02:51,519 --> 00:02:53,599
cell site simulators around

86
00:02:53,599 --> 00:02:57,280
november of 2018. um

87
00:02:57,280 --> 00:03:00,080
when we started getting messages from

88
00:03:00,080 --> 00:03:00,480
people

89
00:03:00,480 --> 00:03:04,159
out of the standing rack protests uh the

90
00:03:04,159 --> 00:03:06,560
against the dakota access pipeline in

91
00:03:06,560 --> 00:03:07,440
north dakota

92
00:03:07,440 --> 00:03:09,040
this was an oil pipeline that was being

93
00:03:09,040 --> 00:03:10,800
built through indian land

94
00:03:10,800 --> 00:03:13,519
and there was a movement to stop the

95
00:03:13,519 --> 00:03:15,200
pipeline from being built

96
00:03:15,200 --> 00:03:16,720
some of the activists out there had

97
00:03:16,720 --> 00:03:18,800
begun noticing strange things going on

98
00:03:18,800 --> 00:03:20,480
with their cellular connections

99
00:03:20,480 --> 00:03:22,239
and had downloaded some apps which

100
00:03:22,239 --> 00:03:24,480
purported to be able to detect cell site

101
00:03:24,480 --> 00:03:25,680
simulators

102
00:03:25,680 --> 00:03:27,760
they got some readings from those apps

103
00:03:27,760 --> 00:03:29,280
and sent them to us

104
00:03:29,280 --> 00:03:31,280
at eff and we thought that they were

105
00:03:31,280 --> 00:03:32,560
interesting enough

106
00:03:32,560 --> 00:03:34,720
that we might as well go out and take a

107
00:03:34,720 --> 00:03:36,400
look and see what we could find

108
00:03:36,400 --> 00:03:39,200
if we could find evidence of police

109
00:03:39,200 --> 00:03:41,920
using cell side simulators against

110
00:03:41,920 --> 00:03:44,159
standing rock protesters that would be a

111
00:03:44,159 --> 00:03:46,159
pretty big deal

112
00:03:46,159 --> 00:03:49,440
so uh i packed a

113
00:03:49,440 --> 00:03:51,840
packed a bag and downloaded some of

114
00:03:51,840 --> 00:03:52,720
these uh

115
00:03:52,720 --> 00:03:54,480
cell site simulator detector apps onto

116
00:03:54,480 --> 00:03:56,239
my phone and brought a couple of cheap

117
00:03:56,239 --> 00:03:57,519
software-defined radios

118
00:03:57,519 --> 00:04:00,560
and away i went and when i got to

119
00:04:00,560 --> 00:04:02,239
standing rock i started looking around i

120
00:04:02,239 --> 00:04:04,239
fired up the apps

121
00:04:04,239 --> 00:04:07,120
and fired up the software defined radios

122
00:04:07,120 --> 00:04:08,000
and

123
00:04:08,000 --> 00:04:10,879
what i pretty quickly figured out was

124
00:04:10,879 --> 00:04:11,519
that

125
00:04:11,519 --> 00:04:14,640
i have no idea what i'm doing

126
00:04:14,640 --> 00:04:18,079
um it turns out that a lot of the apps

127
00:04:18,079 --> 00:04:18,959
have a problem

128
00:04:18,959 --> 00:04:21,120
with false positives i was getting a lot

129
00:04:21,120 --> 00:04:22,079
of readings

130
00:04:22,079 --> 00:04:24,080
but i couldn't be sure if those readings

131
00:04:24,080 --> 00:04:25,520
meant there was actually a cell site

132
00:04:25,520 --> 00:04:26,720
simulator around

133
00:04:26,720 --> 00:04:29,600
or if it was just the cell network doing

134
00:04:29,600 --> 00:04:31,440
strange the strange things that happen

135
00:04:31,440 --> 00:04:33,919
when it fails or gets overloaded

136
00:04:33,919 --> 00:04:35,759
because we were in a pretty remote area

137
00:04:35,759 --> 00:04:37,120
those were certainly with

138
00:04:37,120 --> 00:04:38,800
suddenly a lot of people in it those

139
00:04:38,800 --> 00:04:41,520
were certainly possibilities

140
00:04:41,520 --> 00:04:43,360
and i had no idea what i was doing with

141
00:04:43,360 --> 00:04:44,720
the software to find radios i was

142
00:04:44,720 --> 00:04:46,240
recording spectrum but i really didn't

143
00:04:46,240 --> 00:04:49,520
know what to do with those recordings

144
00:04:49,520 --> 00:04:52,160
after consulting with some friends from

145
00:04:52,160 --> 00:04:54,320
the university of washington

146
00:04:54,320 --> 00:04:56,240
what we figured out was that there

147
00:04:56,240 --> 00:04:57,440
wasn't actually

148
00:04:57,440 --> 00:05:01,600
any 2g gsm signal

149
00:05:01,600 --> 00:05:04,800
anywhere in the area at all now this was

150
00:05:04,800 --> 00:05:07,039
an interesting find and pretty important

151
00:05:07,039 --> 00:05:09,759
why was it important it's important

152
00:05:09,759 --> 00:05:12,560
because of something called the stingray

153
00:05:12,560 --> 00:05:16,080
the stingray is the probably the most

154
00:05:16,080 --> 00:05:18,639
well-known example of an mc catcher or

155
00:05:18,639 --> 00:05:20,240
cell site simulator

156
00:05:20,240 --> 00:05:23,440
the stingray operates natively on 2g

157
00:05:23,440 --> 00:05:26,400
and has the capability of tracking

158
00:05:26,400 --> 00:05:27,840
people's locations

159
00:05:27,840 --> 00:05:29,919
figuring out who's in an area and

160
00:05:29,919 --> 00:05:32,000
purportedly can also

161
00:05:32,000 --> 00:05:36,080
get metadata about who's calling who

162
00:05:36,080 --> 00:05:38,000
but we know that the stingray operates

163
00:05:38,000 --> 00:05:39,440
by impersonating

164
00:05:39,440 --> 00:05:42,560
legitimate 2g towers in the area

165
00:05:42,560 --> 00:05:45,520
since there was no 2g signal at all

166
00:05:45,520 --> 00:05:46,880
anywhere in the area

167
00:05:46,880 --> 00:05:48,479
we know that a stingray couldn't have

168
00:05:48,479 --> 00:05:50,560
been involved because there were no 2g

169
00:05:50,560 --> 00:05:53,919
signal legitimate or illegitimate

170
00:05:53,919 --> 00:05:56,560
this also meant that the apps that i was

171
00:05:56,560 --> 00:05:57,520
using which are

172
00:05:57,520 --> 00:06:00,960
designed to detect the

173
00:06:00,960 --> 00:06:04,319
heuristics that a stingray gives off

174
00:06:04,319 --> 00:06:05,919
they're designed to detect the things

175
00:06:05,919 --> 00:06:07,280
the stingray does

176
00:06:07,280 --> 00:06:10,240
probably wouldn't work because if a cell

177
00:06:10,240 --> 00:06:12,720
site simulator was being used out there

178
00:06:12,720 --> 00:06:14,720
it would have to be a next generation

179
00:06:14,720 --> 00:06:16,479
cell site simulator which was operating

180
00:06:16,479 --> 00:06:18,000
natively on 4g

181
00:06:18,000 --> 00:06:20,319
and at this point we had no idea how

182
00:06:20,319 --> 00:06:22,960
those worked

183
00:06:23,199 --> 00:06:26,319
so i came back to eff with a goal in

184
00:06:26,319 --> 00:06:27,039
mind

185
00:06:27,039 --> 00:06:29,919
i wanted to figure out exactly how a 4g

186
00:06:29,919 --> 00:06:30,400
lc

187
00:06:30,400 --> 00:06:33,120
lte cell site simulator could work we

188
00:06:33,120 --> 00:06:33,680
knew

189
00:06:33,680 --> 00:06:37,120
that the nearby city of oakland had just

190
00:06:37,120 --> 00:06:38,960
bought one called the hailstorm

191
00:06:38,960 --> 00:06:41,120
that purported to work natively on 4g

192
00:06:41,120 --> 00:06:42,319
lte

193
00:06:42,319 --> 00:06:44,960
and this is interesting because as much

194
00:06:44,960 --> 00:06:46,400
as we knew about the

195
00:06:46,400 --> 00:06:48,800
how the previous generation of cell side

196
00:06:48,800 --> 00:06:51,599
simulators worked such as the stingray

197
00:06:51,599 --> 00:06:53,199
as far as we knew all of those

198
00:06:53,199 --> 00:06:55,680
vulnerabilities had been fixed by 4g

199
00:06:55,680 --> 00:06:57,599
so how could a 4g cell size simulator

200
00:06:57,599 --> 00:06:59,440
possibly work

201
00:06:59,440 --> 00:07:01,440
we decided to take a look at the

202
00:07:01,440 --> 00:07:02,720
academia and

203
00:07:02,720 --> 00:07:05,280
ended up doing a deep dive into all of

204
00:07:05,280 --> 00:07:07,520
the available literature on 4g cells on

205
00:07:07,520 --> 00:07:08,000
4g

206
00:07:08,000 --> 00:07:10,720
vulnerabilities for the next year or so

207
00:07:10,720 --> 00:07:11,599
and out of that

208
00:07:11,599 --> 00:07:13,759
came in really excellent paper that yama

209
00:07:13,759 --> 00:07:15,520
wrote called gotta catch a all

210
00:07:15,520 --> 00:07:17,199
which summarizes all of the

211
00:07:17,199 --> 00:07:19,680
vulnerabilities that next gen css could

212
00:07:19,680 --> 00:07:21,599
be taking advantage of

213
00:07:21,599 --> 00:07:23,840
in a very readable and understandable

214
00:07:23,840 --> 00:07:24,639
way

215
00:07:24,639 --> 00:07:26,800
and i'm not going to dive into that here

216
00:07:26,800 --> 00:07:28,240
because yamana already did an

217
00:07:28,240 --> 00:07:30,240
excellent job and gave a talking enigma

218
00:07:30,240 --> 00:07:31,919
last year about her work

219
00:07:31,919 --> 00:07:33,440
and if you're interested you should go

220
00:07:33,440 --> 00:07:36,080
read the paper

221
00:07:36,080 --> 00:07:38,720
um but as a high level all of the

222
00:07:38,720 --> 00:07:39,840
vulnerabilities

223
00:07:39,840 --> 00:07:42,880
happen when the phone first connects to

224
00:07:42,880 --> 00:07:44,720
the tower before it authenticates that

225
00:07:44,720 --> 00:07:46,560
the tower is a legitimate tower owned by

226
00:07:46,560 --> 00:07:48,000
the phone company

227
00:07:48,000 --> 00:07:51,360
and that's where all of the attacks that

228
00:07:51,360 --> 00:07:53,599
a 4g cell site simulator can do

229
00:07:53,599 --> 00:07:56,720
might happen luckily for us that's an

230
00:07:56,720 --> 00:07:57,520
area that can

231
00:07:57,520 --> 00:08:01,440
also be easily replicated in software

232
00:08:01,440 --> 00:08:04,479
which we'll get to later

233
00:08:05,199 --> 00:08:08,720
so now that we had a good idea of how 4g

234
00:08:08,720 --> 00:08:11,280
cell size simulators work the next thing

235
00:08:11,280 --> 00:08:12,479
we wanted to know is

236
00:08:12,479 --> 00:08:15,919
how often are they being used well

237
00:08:15,919 --> 00:08:17,680
we know that law enforcement uses

238
00:08:17,680 --> 00:08:19,360
self-slicing motors quite a lot

239
00:08:19,360 --> 00:08:21,199
and we can find out how often they use

240
00:08:21,199 --> 00:08:22,400
them from

241
00:08:22,400 --> 00:08:25,440
freedom of information requests luckily

242
00:08:25,440 --> 00:08:27,919
there's been several requests filed by

243
00:08:27,919 --> 00:08:29,840
the aclu and other folks which give us a

244
00:08:29,840 --> 00:08:32,080
pretty good picture

245
00:08:32,080 --> 00:08:35,760
uh from a aclu foia

246
00:08:35,760 --> 00:08:38,479
request which was published earlier this

247
00:08:38,479 --> 00:08:39,679
year

248
00:08:39,679 --> 00:08:42,320
we found out that ice and dhs use their

249
00:08:42,320 --> 00:08:44,480
cell site simulators hundreds of times

250
00:08:44,480 --> 00:08:45,440
per year

251
00:08:45,440 --> 00:08:47,040
somewhere on the order of two to three

252
00:08:47,040 --> 00:08:48,959
hundred times per year

253
00:08:48,959 --> 00:08:51,600
uh not to be outdone though local law

254
00:08:51,600 --> 00:08:53,120
enforcement

255
00:08:53,120 --> 00:08:54,800
also uses their cell size and motors

256
00:08:54,800 --> 00:08:56,880
quite a bit the santa barbara police

257
00:08:56,880 --> 00:08:57,440
department

258
00:08:57,440 --> 00:09:00,480
used their suspect simulator 231 times

259
00:09:00,480 --> 00:09:02,480
in 2017 alone

260
00:09:02,480 --> 00:09:04,640
but in contrast to that the oakland

261
00:09:04,640 --> 00:09:05,600
police department

262
00:09:05,600 --> 00:09:07,680
only used their cell site simulator

263
00:09:07,680 --> 00:09:09,760
between one and three times over the

264
00:09:09,760 --> 00:09:11,200
course of 2017

265
00:09:11,200 --> 00:09:14,320
2018 and 2019. so

266
00:09:14,320 --> 00:09:17,279
what accounts for this discrepancy well

267
00:09:17,279 --> 00:09:18,560
we think that because

268
00:09:18,560 --> 00:09:21,120
oakland has strong privacy laws and

269
00:09:21,120 --> 00:09:21,760
strong

270
00:09:21,760 --> 00:09:24,080
community control of police or c-cops

271
00:09:24,080 --> 00:09:25,920
ordinances

272
00:09:25,920 --> 00:09:28,399
we think that for that reason oakland

273
00:09:28,399 --> 00:09:31,279
has been much more restrained

274
00:09:31,279 --> 00:09:33,519
about their use of cell site simulators

275
00:09:33,519 --> 00:09:35,040
whereas santa barbara pd

276
00:09:35,040 --> 00:09:38,800
has not had that issue

277
00:09:39,200 --> 00:09:41,040
so this shows to us that c cos

278
00:09:41,040 --> 00:09:42,480
ordinances actually work

279
00:09:42,480 --> 00:09:45,040
quite well

280
00:09:45,920 --> 00:09:48,080
but unfortunately not everybody responds

281
00:09:48,080 --> 00:09:49,760
to failure requests

282
00:09:49,760 --> 00:09:52,160
foreign spies for example are using amc

283
00:09:52,160 --> 00:09:54,240
catchers in and around washington dc and

284
00:09:54,240 --> 00:09:56,080
presumably in other places in the us and

285
00:09:56,080 --> 00:09:57,120
around the world

286
00:09:57,120 --> 00:09:59,920
we know this from a report put out by

287
00:09:59,920 --> 00:10:01,839
the department of homeland security

288
00:10:01,839 --> 00:10:03,839
we also know that cyber mercenaries like

289
00:10:03,839 --> 00:10:05,839
to use mc catchers thanks to a report

290
00:10:05,839 --> 00:10:07,120
from nso group

291
00:10:07,120 --> 00:10:09,200
about earth they're sorry thanks to a

292
00:10:09,200 --> 00:10:11,440
report from amnesty international

293
00:10:11,440 --> 00:10:13,360
about how nso group had been using them

294
00:10:13,360 --> 00:10:15,920
to spy on a moroccan journalist

295
00:10:15,920 --> 00:10:19,440
we also suspect that criminals are using

296
00:10:19,440 --> 00:10:21,360
catchers such as cartels in mexico

297
00:10:21,360 --> 00:10:23,360
and it makes sense empty catchers or

298
00:10:23,360 --> 00:10:25,120
salsa assume leaders can be built

299
00:10:25,120 --> 00:10:28,079
for as little as a few hundred or a

300
00:10:28,079 --> 00:10:29,839
thousand or two thousand dollars

301
00:10:29,839 --> 00:10:31,760
and this is certainly within the budget

302
00:10:31,760 --> 00:10:33,600
of any well-funded or even

303
00:10:33,600 --> 00:10:37,120
meagerly funded criminal group

304
00:10:38,240 --> 00:10:41,279
so since not everybody can be

305
00:10:41,279 --> 00:10:43,279
foia to find out how widespread of a

306
00:10:43,279 --> 00:10:45,200
problem cell succeeded are we also need

307
00:10:45,200 --> 00:10:46,959
to work on detection

308
00:10:46,959 --> 00:10:49,040
there are two schools of thought of

309
00:10:49,040 --> 00:10:50,079
people working

310
00:10:50,079 --> 00:10:52,320
on detection of subsidized signatures

311
00:10:52,320 --> 00:10:54,000
the first is at base such as

312
00:10:54,000 --> 00:10:56,560
android m c capture detector or m6d and

313
00:10:56,560 --> 00:10:57,680
snoop's niche

314
00:10:57,680 --> 00:10:59,360
the advantages of these are that they're

315
00:10:59,360 --> 00:11:01,360
cheap and easy to use

316
00:11:01,360 --> 00:11:02,720
you just have to have a phone and

317
00:11:02,720 --> 00:11:04,240
download a free app and then you're good

318
00:11:04,240 --> 00:11:05,040
to go

319
00:11:05,040 --> 00:11:06,800
the disadvantages are that you get a

320
00:11:06,800 --> 00:11:08,240
limited amount of data

321
00:11:08,240 --> 00:11:10,320
you can only get information about what

322
00:11:10,320 --> 00:11:11,760
the phone

323
00:11:11,760 --> 00:11:13,839
what towers the phone is connected to

324
00:11:13,839 --> 00:11:16,000
and you can only get information

325
00:11:16,000 --> 00:11:18,160
the information that the phones and

326
00:11:18,160 --> 00:11:20,640
operating systems api will give you

327
00:11:20,640 --> 00:11:22,160
so because of this you get a lot of

328
00:11:22,160 --> 00:11:23,680
false positives and a lot of false

329
00:11:23,680 --> 00:11:25,360
negatives a lot of the things

330
00:11:25,360 --> 00:11:28,160
that the phone system does when it fails

331
00:11:28,160 --> 00:11:28,880
or

332
00:11:28,880 --> 00:11:31,839
when uh somebody makes a mistake look

333
00:11:31,839 --> 00:11:33,519
very similar to the things that a cell

334
00:11:33,519 --> 00:11:35,200
site simulator does

335
00:11:35,200 --> 00:11:37,200
the other school of thought on this is

336
00:11:37,200 --> 00:11:39,040
radio based this is things like

337
00:11:39,040 --> 00:11:40,399
sea glass from the university of

338
00:11:40,399 --> 00:11:42,160
washington or sich

339
00:11:42,160 --> 00:11:44,800
from ash wilson the advantages of these

340
00:11:44,800 --> 00:11:45,519
are that you get

341
00:11:45,519 --> 00:11:48,640
better data and lower level information

342
00:11:48,640 --> 00:11:50,720
um you can get information about all of

343
00:11:50,720 --> 00:11:52,000
the towers in an area

344
00:11:52,000 --> 00:11:54,320
by using a software defined radio not

345
00:11:54,320 --> 00:11:55,279
just the ones that your phone is

346
00:11:55,279 --> 00:11:56,160
connected to

347
00:11:56,160 --> 00:11:57,680
and you don't have to worry about the

348
00:11:57,680 --> 00:11:59,680
api of the phone and what data it will

349
00:11:59,680 --> 00:12:00,480
give you

350
00:12:00,480 --> 00:12:02,399
the disadvantages of these are that they

351
00:12:02,399 --> 00:12:04,240
can be harder to set up and use

352
00:12:04,240 --> 00:12:06,880
and the data can be harder to interpret

353
00:12:06,880 --> 00:12:08,079
you have to have some programming

354
00:12:08,079 --> 00:12:10,000
knowledge and some database knowledge

355
00:12:10,000 --> 00:12:11,680
and you have to buy hardware usually a

356
00:12:11,680 --> 00:12:13,360
software defined radio and a raspberry

357
00:12:13,360 --> 00:12:16,000
pi and such

358
00:12:16,720 --> 00:12:19,040
so we wanted to answer the question can

359
00:12:19,040 --> 00:12:20,320
we detect 4g

360
00:12:20,320 --> 00:12:24,480
using cell side simulators using similar

361
00:12:24,480 --> 00:12:27,440
efforts well we like the radio efforts

362
00:12:27,440 --> 00:12:28,720
because we can get low

363
00:12:28,720 --> 00:12:31,839
lower level data we can see all of the

364
00:12:31,839 --> 00:12:33,279
transmitters not just the ones that

365
00:12:33,279 --> 00:12:34,880
we're connecting to we can compare that

366
00:12:34,880 --> 00:12:36,160
data over time

367
00:12:36,160 --> 00:12:37,760
but all the previous efforts have one

368
00:12:37,760 --> 00:12:39,600
big weakness they're looking at

369
00:12:39,600 --> 00:12:41,040
stingrays they're looking at

370
00:12:41,040 --> 00:12:44,800
2g and the and the heuristics that we

371
00:12:44,800 --> 00:12:45,440
know

372
00:12:45,440 --> 00:12:48,160
to be viable for a stingray but we

373
00:12:48,160 --> 00:12:49,760
wanted to look specifically

374
00:12:49,760 --> 00:12:52,880
at 4g transmitters and we wanted

375
00:12:52,880 --> 00:12:55,360
to look specifically for heuristics that

376
00:12:55,360 --> 00:12:56,320
we think 4g

377
00:12:56,320 --> 00:12:59,680
cell site simulators might be using and

378
00:12:59,680 --> 00:13:01,440
furthermore we want to verify the

379
00:13:01,440 --> 00:13:03,360
results we want to be able to actually

380
00:13:03,360 --> 00:13:04,720
track something down

381
00:13:04,720 --> 00:13:06,959
and see if it's a cell size simulator or

382
00:13:06,959 --> 00:13:08,720
just an antenna behaving

383
00:13:08,720 --> 00:13:12,399
poorly so

384
00:13:12,399 --> 00:13:14,639
we built a thing we call crocodile

385
00:13:14,639 --> 00:13:16,560
hunter

386
00:13:16,560 --> 00:13:18,720
crocodile hunter is a software and

387
00:13:18,720 --> 00:13:20,399
hardware stack all of the software is

388
00:13:20,399 --> 00:13:21,680
open source

389
00:13:21,680 --> 00:13:24,160
its back end is based on srs lte which

390
00:13:24,160 --> 00:13:25,040
is an open source

391
00:13:25,040 --> 00:13:26,880
lte software stack which emulates

392
00:13:26,880 --> 00:13:28,800
everything from the base station to the

393
00:13:28,800 --> 00:13:30,320
mobile phone

394
00:13:30,320 --> 00:13:32,000
it communicates with the front end over

395
00:13:32,000 --> 00:13:34,000
a local socket the front end is written

396
00:13:34,000 --> 00:13:34,800
in python

397
00:13:34,800 --> 00:13:37,519
and handles the heuristics deciding

398
00:13:37,519 --> 00:13:39,519
whether something is suspicious or not

399
00:13:39,519 --> 00:13:42,480
the database and the user interface it

400
00:13:42,480 --> 00:13:43,600
gets data from

401
00:13:43,600 --> 00:13:46,880
srslv adds it to the database runs some

402
00:13:46,880 --> 00:13:47,760
calculations

403
00:13:47,760 --> 00:13:49,839
and displace tower locations we also

404
00:13:49,839 --> 00:13:50,959
have an api

405
00:13:50,959 --> 00:13:53,600
for researchers to be able to share data

406
00:13:53,600 --> 00:13:54,959
this is the hardware setup

407
00:13:54,959 --> 00:13:56,639
as you can see it's pretty compact we

408
00:13:56,639 --> 00:13:58,399
have a software defined radio

409
00:13:58,399 --> 00:14:01,600
a couple of antennas a gps antenna and

410
00:14:01,600 --> 00:14:03,920
of course a laptop or raspberry pi so it

411
00:14:03,920 --> 00:14:04,639
can all fit

412
00:14:04,639 --> 00:14:08,800
easily into a backpack or a car to sleep

413
00:14:09,199 --> 00:14:12,399
this is a test run that we did in

414
00:14:12,399 --> 00:14:14,079
downtown san francisco during

415
00:14:14,079 --> 00:14:16,480
the dreamforce conference in january of

416
00:14:16,480 --> 00:14:17,920
2019.

417
00:14:17,920 --> 00:14:22,639
um this was or sorry january of 2020

418
00:14:22,639 --> 00:14:26,079
um this was a

419
00:14:26,079 --> 00:14:30,079
uh so each of these

420
00:14:30,079 --> 00:14:34,079
each of these points on the map is a

421
00:14:34,079 --> 00:14:36,480
cellular base station that is

422
00:14:36,480 --> 00:14:37,199
transmitting

423
00:14:37,199 --> 00:14:40,480
and probably many of these points are

424
00:14:40,480 --> 00:14:42,880
multiple antennas connect on one base

425
00:14:42,880 --> 00:14:43,600
station

426
00:14:43,600 --> 00:14:45,279
each of the skulls are also base

427
00:14:45,279 --> 00:14:46,800
stations but they are ones that we find

428
00:14:46,800 --> 00:14:47,839
suspicious

429
00:14:47,839 --> 00:14:49,519
clearly not each of these is going to be

430
00:14:49,519 --> 00:14:51,360
an emc catcher which is why we need to

431
00:14:51,360 --> 00:14:53,120
track them down and see what they are in

432
00:14:53,120 --> 00:14:55,040
person

433
00:14:55,040 --> 00:14:57,199
um so that's the front end and then the

434
00:14:57,199 --> 00:14:59,839
back end we can see that srslt scans a

435
00:14:59,839 --> 00:15:01,199
list of frequencies

436
00:15:01,199 --> 00:15:02,880
for the information blocks which are

437
00:15:02,880 --> 00:15:05,680
transmitted by the cell tower

438
00:15:05,680 --> 00:15:07,360
and then decodes those information

439
00:15:07,360 --> 00:15:08,959
blocks which contains things like

440
00:15:08,959 --> 00:15:12,240
cell id and the um and and

441
00:15:12,240 --> 00:15:15,040
other important identifying features and

442
00:15:15,040 --> 00:15:16,000
sends them

443
00:15:16,000 --> 00:15:19,680
over the socket to the front end

444
00:15:19,680 --> 00:15:21,199
and then we use a method called

445
00:15:21,199 --> 00:15:23,440
trilateration and some radiophysics we

446
00:15:23,440 --> 00:15:24,399
can map out

447
00:15:24,399 --> 00:15:26,000
where all of the base stations are

448
00:15:26,000 --> 00:15:27,519
located in real time

449
00:15:27,519 --> 00:15:28,880
this is a rough estimate and it's

450
00:15:28,880 --> 00:15:31,199
usually off by a couple of meters

451
00:15:31,199 --> 00:15:32,560
but it's close enough that we can

452
00:15:32,560 --> 00:15:34,320
compare it to a public open source

453
00:15:34,320 --> 00:15:35,759
database of cell

454
00:15:35,759 --> 00:15:37,839
cell tower locations such as wiggle or

455
00:15:37,839 --> 00:15:38,959
open cell id

456
00:15:38,959 --> 00:15:40,800
to see if this transmitter has a history

457
00:15:40,800 --> 00:15:42,320
of transmitting in that area if it's

458
00:15:42,320 --> 00:15:43,360
what we expect

459
00:15:43,360 --> 00:15:44,959
or if it's something new that has just

460
00:15:44,959 --> 00:15:47,120
come up in the last

461
00:15:47,120 --> 00:15:50,560
few days and then finally we look for

462
00:15:50,560 --> 00:15:52,399
anomalies and this is things like base

463
00:15:52,399 --> 00:15:53,839
stations that are moving or base

464
00:15:53,839 --> 00:15:55,759
stations that change signal strength

465
00:15:55,759 --> 00:15:57,040
base stations that aren't where they

466
00:15:57,040 --> 00:15:58,320
should be or base stations that have

467
00:15:58,320 --> 00:15:59,279
just shown up

468
00:15:59,279 --> 00:16:00,800
base stations that are missing

469
00:16:00,800 --> 00:16:02,399
parameters

470
00:16:02,399 --> 00:16:05,839
or new base stations and just because we

471
00:16:05,839 --> 00:16:07,680
found an anomaly doesn't mean a cell

472
00:16:07,680 --> 00:16:09,440
side simulator that's why we have to

473
00:16:09,440 --> 00:16:11,680
verify it in person

474
00:16:11,680 --> 00:16:13,680
using the location that we have we can

475
00:16:13,680 --> 00:16:14,959
actually track it down

476
00:16:14,959 --> 00:16:17,040
if it's on top of an existing cell tower

477
00:16:17,040 --> 00:16:18,399
great it's probably legit

478
00:16:18,399 --> 00:16:20,320
it's in the back of an unmarked van well

479
00:16:20,320 --> 00:16:23,040
that would be very suspicious

480
00:16:23,040 --> 00:16:25,279
so what have we found so far one of the

481
00:16:25,279 --> 00:16:27,040
first things we found during a test in

482
00:16:27,040 --> 00:16:28,560
washington dc

483
00:16:28,560 --> 00:16:30,959
was a couple of very suspicious base

484
00:16:30,959 --> 00:16:32,399
stations

485
00:16:32,399 --> 00:16:34,720
we had two base stations which were both

486
00:16:34,720 --> 00:16:36,399
transmitting a country-coded network

487
00:16:36,399 --> 00:16:37,519
code shown here

488
00:16:37,519 --> 00:16:39,920
of 310 and 401.0 this is the

489
00:16:39,920 --> 00:16:41,600
country-coded network code respectively

490
00:16:41,600 --> 00:16:42,720
for the usa

491
00:16:42,720 --> 00:16:45,759
and acnt this is what we would expect to

492
00:16:45,759 --> 00:16:46,480
see

493
00:16:46,480 --> 00:16:48,800
but suddenly that base station started

494
00:16:48,800 --> 00:16:50,000
transmitting with the same

495
00:16:50,000 --> 00:16:53,680
base station id of 654794

496
00:16:53,680 --> 00:16:54,959
indicating that it's the same base

497
00:16:54,959 --> 00:16:56,959
station suddenly started transmitting a

498
00:16:56,959 --> 00:16:59,040
country code and network code of 308 and

499
00:16:59,040 --> 00:17:00,399
451

500
00:17:00,399 --> 00:17:03,839
which do not belong to the any

501
00:17:03,839 --> 00:17:06,480
308 does not belong in the us and 451

502
00:17:06,480 --> 00:17:07,439
doesn't belong to

503
00:17:07,439 --> 00:17:10,640
any network in the us

504
00:17:10,640 --> 00:17:13,520
or anywhere in the world for that matter

505
00:17:13,520 --> 00:17:14,799
a different base station

506
00:17:14,799 --> 00:17:16,559
suddenly started with the same base

507
00:17:16,559 --> 00:17:18,319
asian id again of six five

508
00:17:18,319 --> 00:17:20,880
three six and one broadcasting a country

509
00:17:20,880 --> 00:17:22,640
code and network code of three five oh

510
00:17:22,640 --> 00:17:23,839
and four nano

511
00:17:23,839 --> 00:17:25,760
which corresponds to the island of saint

512
00:17:25,760 --> 00:17:27,520
pierre and mikalan in the country code

513
00:17:27,520 --> 00:17:28,000
which is

514
00:17:28,000 --> 00:17:30,160
just off the coast of nova scotia and

515
00:17:30,160 --> 00:17:32,000
490 which isn't used by

516
00:17:32,000 --> 00:17:34,799
any network again any network anywhere

517
00:17:34,799 --> 00:17:37,039
in the us

518
00:17:37,039 --> 00:17:38,799
so we found this very suspicious this

519
00:17:38,799 --> 00:17:40,160
actually isn't something that we

520
00:17:40,160 --> 00:17:42,160
expected to find this is the heuristic

521
00:17:42,160 --> 00:17:43,440
we expected to see

522
00:17:43,440 --> 00:17:44,720
so we weren't really sure what to make

523
00:17:44,720 --> 00:17:46,400
of it and unfortunately we didn't get to

524
00:17:46,400 --> 00:17:49,679
track it down at that point

525
00:17:49,679 --> 00:17:52,799
i would have chalked it up to just a

526
00:17:52,799 --> 00:17:55,840
malfunction but later a few months later

527
00:17:55,840 --> 00:17:57,280
i was in oakland california

528
00:17:57,280 --> 00:17:59,520
running some scans again during a large

529
00:17:59,520 --> 00:18:02,080
protest on june 19th or the juneteenth

530
00:18:02,080 --> 00:18:05,760
celebration which was

531
00:18:05,760 --> 00:18:07,520
taking place in the form of a march from

532
00:18:07,520 --> 00:18:10,160
the port of oakland to downtown oakland

533
00:18:10,160 --> 00:18:12,880
and what we saw that time was again some

534
00:18:12,880 --> 00:18:14,960
very suspicious base stations

535
00:18:14,960 --> 00:18:17,200
broadcasting once again country codes

536
00:18:17,200 --> 00:18:18,160
and network codes

537
00:18:18,160 --> 00:18:21,280
seen here under the plmn category that

538
00:18:21,280 --> 00:18:23,520
don't belong in the us

539
00:18:23,520 --> 00:18:25,440
we saw one broadcasting a country code

540
00:18:25,440 --> 00:18:26,880
of 21368

541
00:18:26,880 --> 00:18:30,039
another one 31959 and another one of

542
00:18:30,039 --> 00:18:31,440
710738

543
00:18:31,440 --> 00:18:33,600
which don't correspond to any country

544
00:18:33,600 --> 00:18:34,559
codes in the us

545
00:18:34,559 --> 00:18:37,280
or any network codes in the countries

546
00:18:37,280 --> 00:18:39,679
that they do belong to

547
00:18:39,679 --> 00:18:42,880
so this is again very suspicious

548
00:18:42,880 --> 00:18:44,799
we don't quite know what to make of it

549
00:18:44,799 --> 00:18:46,240
but it certainly indicates that

550
00:18:46,240 --> 00:18:47,440
something weird is going on

551
00:18:47,440 --> 00:18:49,120
this is not something that we normally

552
00:18:49,120 --> 00:18:51,280
see in our many tests

553
00:18:51,280 --> 00:18:53,200
but it is something that seems to crop

554
00:18:53,200 --> 00:18:54,640
up at certain times

555
00:18:54,640 --> 00:18:57,039
when other things are happening we're

556
00:18:57,039 --> 00:18:58,240
not sure what to make of this and

557
00:18:58,240 --> 00:19:00,559
further studies are needed

558
00:19:00,559 --> 00:19:03,200
finally what's with the name well like i

559
00:19:03,200 --> 00:19:03,679
said

560
00:19:03,679 --> 00:19:05,679
the sting ray is the most widely known

561
00:19:05,679 --> 00:19:07,760
form of a cell site signature

562
00:19:07,760 --> 00:19:10,320
and a stingray is also what killed the

563
00:19:10,320 --> 00:19:11,360
great naturalist

564
00:19:11,360 --> 00:19:14,559
steve irwin so we named also known as

565
00:19:14,559 --> 00:19:15,840
the crocodile hunter

566
00:19:15,840 --> 00:19:17,840
so we named this prac project crocodile

567
00:19:17,840 --> 00:19:21,120
hunter to pay our respects to steve

568
00:19:21,120 --> 00:19:23,280
finally future work we have ongoing

569
00:19:23,280 --> 00:19:25,120
tests in latin america with the fade

570
00:19:25,120 --> 00:19:25,679
project

571
00:19:25,679 --> 00:19:27,919
in washington dc in new york city and

572
00:19:27,919 --> 00:19:29,280
hopefully seen in your town

573
00:19:29,280 --> 00:19:30,799
because this project is open source and

574
00:19:30,799 --> 00:19:32,640
we want you to set it up too

575
00:19:32,640 --> 00:19:34,000
we want to get more data so we can

576
00:19:34,000 --> 00:19:35,520
better understand how empty catchers

577
00:19:35,520 --> 00:19:37,039
work and we want to make improvements to

578
00:19:37,039 --> 00:19:39,120
our heuristics

579
00:19:39,120 --> 00:19:40,720
finally how can we stop cell size

580
00:19:40,720 --> 00:19:42,640
simulators there's unfortunately not

581
00:19:42,640 --> 00:19:44,080
much we can do to protect ourselves

582
00:19:44,080 --> 00:19:46,320
individually and 5g doesn't solve the

583
00:19:46,320 --> 00:19:47,200
problem

584
00:19:47,200 --> 00:19:49,600
we would like to see 2g support be

585
00:19:49,600 --> 00:19:51,360
dropped on ios and android

586
00:19:51,360 --> 00:19:53,280
we would like to make some changes to

587
00:19:53,280 --> 00:19:55,160
the protocol such as eliminating the

588
00:19:55,160 --> 00:19:56,960
pre-authentication messages

589
00:19:56,960 --> 00:19:58,400
and there's some great papers out about

590
00:19:58,400 --> 00:20:00,960
how we can do that we need more data we

591
00:20:00,960 --> 00:20:03,039
need stronger privacy regulations and

592
00:20:03,039 --> 00:20:04,400
most importantly we need

593
00:20:04,400 --> 00:20:06,080
the companies and standards

594
00:20:06,080 --> 00:20:07,600
organizations to actually care about

595
00:20:07,600 --> 00:20:10,880
this problem and take it seriously

596
00:20:10,880 --> 00:20:12,720
the key takeaways here we have a pretty

597
00:20:12,720 --> 00:20:13,679
good understanding of the

598
00:20:13,679 --> 00:20:15,520
vulnerabilities in 4g which commercial

599
00:20:15,520 --> 00:20:17,840
cell site simulators might exploit

600
00:20:17,840 --> 00:20:19,280
none of the previous zimzi catcher

601
00:20:19,280 --> 00:20:21,679
detector apps really do the job anymore

602
00:20:21,679 --> 00:20:23,120
but we've proven that the same

603
00:20:23,120 --> 00:20:25,679
principles which worked on those

604
00:20:25,679 --> 00:20:27,440
should work on next generation cell site

605
00:20:27,440 --> 00:20:28,960
simulators as well

606
00:20:28,960 --> 00:20:32,240
and finally the problems of css abuse

607
00:20:32,240 --> 00:20:34,320
can be solved but it's going to take a

608
00:20:34,320 --> 00:20:35,919
lot of political work

609
00:20:35,919 --> 00:20:39,200
and a little bit of engineering

610
00:20:40,960 --> 00:20:42,559
thank you for your time again my name is

611
00:20:42,559 --> 00:20:44,159
cooper clinton i'm a senior security

612
00:20:44,159 --> 00:20:44,799
researcher

613
00:20:44,799 --> 00:20:47,120
and you can reach me at cooper q at

614
00:20:47,120 --> 00:20:49,120
eff.org or on twitter

615
00:20:49,120 --> 00:21:02,719
q enjoy the conference

