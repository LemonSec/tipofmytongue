1
00:00:05,279 --> 00:00:07,359
so

2
00:00:05,839 --> 00:00:09,040
really really exciting next top coming

3
00:00:07,359 --> 00:00:10,559
up here uh we've got a

4
00:00:09,040 --> 00:00:12,479
a couple of speakers who are going to be

5
00:00:10,559 --> 00:00:13,678
teaming up to talk to us about external

6
00:00:12,480 --> 00:00:16,560
threat hunters are

7
00:00:13,679 --> 00:00:17,600
red teamers now as someone who

8
00:00:16,560 --> 00:00:20,720
constantly

9
00:00:17,600 --> 00:00:22,480
constantly loves observes and

10
00:00:20,720 --> 00:00:24,320
is really just interested in the overlap

11
00:00:22,480 --> 00:00:25,680
between red and blue teams to keep it in

12
00:00:24,320 --> 00:00:27,439
a very simple manner here

13
00:00:25,680 --> 00:00:28,960
uh this talk title really kind of caught

14
00:00:27,439 --> 00:00:30,400
my interest if you will because

15
00:00:28,960 --> 00:00:31,599
um i don't know it seems like a really

16
00:00:30,400 --> 00:00:32,719
true statement one that i could kind of

17
00:00:31,599 --> 00:00:36,079
get behind here

18
00:00:32,719 --> 00:00:37,520
um so without too much delay because

19
00:00:36,079 --> 00:00:38,320
they've got something really cool lined

20
00:00:37,520 --> 00:00:39,760
up for us here

21
00:00:38,320 --> 00:00:41,040
i want to introduce our next two

22
00:00:39,760 --> 00:00:42,480
speakers i'm going to try and pronounce

23
00:00:41,040 --> 00:00:44,399
these names correctly here but i'll be

24
00:00:42,480 --> 00:00:45,919
very honest with you all uh these are

25
00:00:44,399 --> 00:00:48,320
tough names so we have dave

26
00:00:45,920 --> 00:00:50,079
maynard i think dave let me know if i

27
00:00:48,320 --> 00:00:51,520
pronounce the r correctly in your name

28
00:00:50,079 --> 00:00:53,360
for those of you you got it you nailed

29
00:00:51,520 --> 00:00:56,480
it i got it all right good stuff

30
00:00:53,360 --> 00:00:57,600
and we've also got george ortiz joining

31
00:00:56,480 --> 00:00:58,398
as well and i think george you're going

32
00:00:57,600 --> 00:00:59,920
to be starting

33
00:00:58,399 --> 00:01:01,680
first if i'm not mistaken so i'm going

34
00:00:59,920 --> 00:01:02,800
to hand over to you sir but uh

35
00:01:01,680 --> 00:01:04,479
gentlemen thank you both for joining us

36
00:01:02,800 --> 00:01:05,600
today we're very excited to have you at

37
00:01:04,479 --> 00:01:07,600
the threat hunting summit

38
00:01:05,600 --> 00:01:09,919
looking forward to the talk george over

39
00:01:07,600 --> 00:01:12,640
to you thank you so much

40
00:01:09,920 --> 00:01:14,320
everyone and thank you for that intro

41
00:01:12,640 --> 00:01:18,240
nice to see you there dave

42
00:01:14,320 --> 00:01:21,119
and welcome everyone we are so excited

43
00:01:18,240 --> 00:01:22,240
we are going to try to contain ourselves

44
00:01:21,119 --> 00:01:24,720
but

45
00:01:22,240 --> 00:01:26,000
we have an awesome talk i know everyone

46
00:01:24,720 --> 00:01:28,960
says about their talk but

47
00:01:26,000 --> 00:01:31,280
this one we created just for you this is

48
00:01:28,960 --> 00:01:34,399
the first release of that talk

49
00:01:31,280 --> 00:01:38,159
and yeah it has a pretty cool name

50
00:01:34,400 --> 00:01:40,159
but let's do a little tldr just to set

51
00:01:38,159 --> 00:01:41,600
expectations dave you you want to do a

52
00:01:40,159 --> 00:01:42,799
quick tldr on what we're going to talk

53
00:01:41,600 --> 00:01:44,798
about

54
00:01:42,799 --> 00:01:47,119
i i really do i can't wait and just to

55
00:01:44,799 --> 00:01:49,920
be clear george is containing himself

56
00:01:47,119 --> 00:01:51,520
i am making no such claims i'm putting

57
00:01:49,920 --> 00:01:55,600
it all out there

58
00:01:51,520 --> 00:01:57,280
uh just to start with uh the the title

59
00:01:55,600 --> 00:01:59,039
in virtual conferences and whatnot you

60
00:01:57,280 --> 00:02:02,000
can kind of see titles sometimes and

61
00:01:59,040 --> 00:02:02,640
and go oh is that that sounds cool i

62
00:02:02,000 --> 00:02:05,360
once

63
00:02:02,640 --> 00:02:06,159
watched the title uh called how to do

64
00:02:05,360 --> 00:02:08,000
security

65
00:02:06,159 --> 00:02:09,440
uh on top of mount everest and i was

66
00:02:08,000 --> 00:02:11,360
like well i

67
00:02:09,440 --> 00:02:12,879
didn't know there were computers there i

68
00:02:11,360 --> 00:02:14,080
can't wait to see that talk

69
00:02:12,879 --> 00:02:15,920
it turned out it was more of a

70
00:02:14,080 --> 00:02:18,319
metaphorical on top of

71
00:02:15,920 --> 00:02:19,359
mount everest so i wanted we wanted to

72
00:02:18,319 --> 00:02:22,160
assure everybody

73
00:02:19,360 --> 00:02:22,959
uh this isn't uh while the talk is

74
00:02:22,160 --> 00:02:26,480
sensational

75
00:02:22,959 --> 00:02:29,599
the topic actually is why red teamers

76
00:02:26,480 --> 00:02:32,238
uh and internal fret hunters

77
00:02:29,599 --> 00:02:32,640
really are cut from the same cloth uh

78
00:02:32,239 --> 00:02:35,760
and

79
00:02:32,640 --> 00:02:37,440
tooling is similar uh there's a lot of

80
00:02:35,760 --> 00:02:39,280
ability to repurpose

81
00:02:37,440 --> 00:02:40,720
uh tool settings and procedures between

82
00:02:39,280 --> 00:02:43,040
your red team and uh

83
00:02:40,720 --> 00:02:44,000
external threat hunting team and really

84
00:02:43,040 --> 00:02:45,920
what we're trying to do

85
00:02:44,000 --> 00:02:47,440
and this is the point of this

86
00:02:45,920 --> 00:02:49,200
presentation isn't so much this is what

87
00:02:47,440 --> 00:02:52,400
everybody's doing right now

88
00:02:49,200 --> 00:02:54,000
we view this as where people will be

89
00:02:52,400 --> 00:02:55,760
uh when they evolve their purple team

90
00:02:54,000 --> 00:02:57,920
practices in a good

91
00:02:55,760 --> 00:02:59,760
two to three years so we wanted to give

92
00:02:57,920 --> 00:03:05,839
this audience a sneak peek of it

93
00:02:59,760 --> 00:03:05,840
uh first and foremost

94
00:03:06,560 --> 00:03:14,480
exactly so um quick who am i dave

95
00:03:11,519 --> 00:03:15,360
well uh i'm david maynard uh the r is

96
00:03:14,480 --> 00:03:19,119
kind of hard but

97
00:03:15,360 --> 00:03:21,840
maynard i previously have worked

98
00:03:19,120 --> 00:03:22,159
for organizations like cisco talos where

99
00:03:21,840 --> 00:03:23,840
i

100
00:03:22,159 --> 00:03:25,359
led the threat hunting team for uh

101
00:03:23,840 --> 00:03:27,920
europe and the middle east

102
00:03:25,360 --> 00:03:28,720
in which we uh were the first to respond

103
00:03:27,920 --> 00:03:31,679
to

104
00:03:28,720 --> 00:03:32,239
uh not petro on behalf of the ukrainian

105
00:03:31,680 --> 00:03:36,080
government

106
00:03:32,239 --> 00:03:39,440
uh we also uh have found and published

107
00:03:36,080 --> 00:03:42,560
several uh different apt activity uh

108
00:03:39,440 --> 00:03:42,560
like vpn filter

109
00:03:45,200 --> 00:03:48,238
uh actually just too many to actually

110
00:03:47,760 --> 00:03:50,399
name

111
00:03:48,239 --> 00:03:52,480
but i worked on uh threat hunting for a

112
00:03:50,400 --> 00:03:54,640
long time and before that

113
00:03:52,480 --> 00:03:55,599
my my skill base my skill set really was

114
00:03:54,640 --> 00:03:57,279
just red teaming

115
00:03:55,599 --> 00:03:59,040
i i like to be a very creative red

116
00:03:57,280 --> 00:04:01,439
teamer i did uh

117
00:03:59,040 --> 00:04:02,720
so i was a red teamer before i became a

118
00:04:01,439 --> 00:04:04,959
threat hunter

119
00:04:02,720 --> 00:04:07,439
and i'm occasionally an entrepreneur but

120
00:04:04,959 --> 00:04:10,720
i like to be a threat hunter first

121
00:04:07,439 --> 00:04:13,519
yeah and and of course very humble uh

122
00:04:10,720 --> 00:04:13,760
speaking with you here dave uh dave is

123
00:04:13,519 --> 00:04:17,120
an

124
00:04:13,760 --> 00:04:18,798
industry rock star so uh when i was

125
00:04:17,120 --> 00:04:20,239
introduced to him through

126
00:04:18,798 --> 00:04:22,239
his wife actually that i work with

127
00:04:20,238 --> 00:04:24,080
lawyer liz on twitter

128
00:04:22,240 --> 00:04:25,360
i'm like wow this is an awesome

129
00:04:24,080 --> 00:04:28,560
opportunity

130
00:04:25,360 --> 00:04:30,720
um so here we are and i'm george ortiz

131
00:04:28,560 --> 00:04:32,960
real quick um chief technology officer

132
00:04:30,720 --> 00:04:34,560
at site prior to that was 10 years

133
00:04:32,960 --> 00:04:38,320
leading the offensive team

134
00:04:34,560 --> 00:04:40,080
at citigroup before that i started as a

135
00:04:38,320 --> 00:04:42,800
sys admin i saw some people

136
00:04:40,080 --> 00:04:43,758
uh saying hey who started as cis admin

137
00:04:42,800 --> 00:04:47,120
that's me

138
00:04:43,759 --> 00:04:48,400
um then i got into security operations

139
00:04:47,120 --> 00:04:51,520
center for one year

140
00:04:48,400 --> 00:04:53,599
at a company called teramark uh which uh

141
00:04:51,520 --> 00:04:55,840
centurylink and level three are pretty

142
00:04:53,600 --> 00:04:58,240
found off and then i got into

143
00:04:55,840 --> 00:05:00,799
vulnerability assessment at city

144
00:04:58,240 --> 00:05:02,560
created the pen test team which are

145
00:05:00,800 --> 00:05:04,400
really the function which meant we

146
00:05:02,560 --> 00:05:05,919
exploited production systems

147
00:05:04,400 --> 00:05:08,159
and a company that does trillions of

148
00:05:05,919 --> 00:05:10,799
dollars of transactions in a day

149
00:05:08,160 --> 00:05:12,160
was scary but we showed the value then

150
00:05:10,800 --> 00:05:14,960
built the red team

151
00:05:12,160 --> 00:05:16,080
and then figured out that doing yearly

152
00:05:14,960 --> 00:05:18,159
or bi-annual

153
00:05:16,080 --> 00:05:20,240
red team engagements uh really left our

154
00:05:18,160 --> 00:05:22,880
red team kind of not doing much

155
00:05:20,240 --> 00:05:25,199
and we figured out that purple teaming

156
00:05:22,880 --> 00:05:28,479
was a great way of doing that so

157
00:05:25,199 --> 00:05:31,039
that's us but enough about us

158
00:05:28,479 --> 00:05:32,080
what are we gonna talk about today so we

159
00:05:31,039 --> 00:05:35,120
are going to

160
00:05:32,080 --> 00:05:37,440
level set what is red teaming because

161
00:05:35,120 --> 00:05:39,120
every red team talk we have to debate

162
00:05:37,440 --> 00:05:40,719
what red teaming is right

163
00:05:39,120 --> 00:05:42,800
then we're going to cover what external

164
00:05:40,720 --> 00:05:44,720
threat hunting is and we're going to do

165
00:05:42,800 --> 00:05:45,360
a lot of comparison so if you're new to

166
00:05:44,720 --> 00:05:47,039
red team

167
00:05:45,360 --> 00:05:48,720
we hope you learn a lot if you're new to

168
00:05:47,039 --> 00:05:49,599
external threat hunting we hope you

169
00:05:48,720 --> 00:05:51,759
learn a lot

170
00:05:49,600 --> 00:05:52,720
and if you know about both but aren't

171
00:05:51,759 --> 00:05:56,000
using similar

172
00:05:52,720 --> 00:05:57,039
uh tools and tradecraft i think we will

173
00:05:56,000 --> 00:05:59,120
give you a uh

174
00:05:57,039 --> 00:06:00,719
good reason to do that so we'll cover

175
00:05:59,120 --> 00:06:02,400
things like attack infrastructure

176
00:06:00,720 --> 00:06:05,120
acquiring infrastructure

177
00:06:02,400 --> 00:06:06,479
both from red teaming and from uh

178
00:06:05,120 --> 00:06:08,560
external threat hunting

179
00:06:06,479 --> 00:06:11,440
we're obviously going to cover c2 right

180
00:06:08,560 --> 00:06:14,720
uh command and control on c2 matrix

181
00:06:11,440 --> 00:06:18,560
and then circling out that with analysis

182
00:06:14,720 --> 00:06:22,400
and refinement analysis and response so

183
00:06:18,560 --> 00:06:24,720
we're very excited um so i'll go first

184
00:06:22,400 --> 00:06:26,318
what is red team and i got this from the

185
00:06:24,720 --> 00:06:28,160
red team journal

186
00:06:26,319 --> 00:06:29,600
it's the practice of looking at a

187
00:06:28,160 --> 00:06:31,919
problem or situation

188
00:06:29,600 --> 00:06:34,160
from the perspective of an adversary and

189
00:06:31,919 --> 00:06:34,960
us in infosec we obviously stole this

190
00:06:34,160 --> 00:06:37,440
term from

191
00:06:34,960 --> 00:06:38,880
somewhere else right um we can go back

192
00:06:37,440 --> 00:06:42,160
to military terms

193
00:06:38,880 --> 00:06:44,479
they do red teaming um first

194
00:06:42,160 --> 00:06:46,240
exercises were after the vietnam war

195
00:06:44,479 --> 00:06:47,919
where they didn't do so well

196
00:06:46,240 --> 00:06:49,759
and decided they should probably

197
00:06:47,919 --> 00:06:52,719
exercise and test each other

198
00:06:49,759 --> 00:06:53,280
from the adversary perspective and our

199
00:06:52,720 --> 00:06:56,400
goal

200
00:06:53,280 --> 00:06:57,198
in red teaming is to make the blue team

201
00:06:56,400 --> 00:07:00,000
better

202
00:06:57,199 --> 00:07:01,199
really to work together and not only

203
00:07:00,000 --> 00:07:03,120
test technology

204
00:07:01,199 --> 00:07:05,120
like you normally do on a pen test

205
00:07:03,120 --> 00:07:08,160
focusing on preventive controls

206
00:07:05,120 --> 00:07:10,800
but testing and measuring people

207
00:07:08,160 --> 00:07:12,960
process and technology and really

208
00:07:10,800 --> 00:07:13,360
focusing on those detective controls

209
00:07:12,960 --> 00:07:16,159
that

210
00:07:13,360 --> 00:07:17,120
you might not be able to patch now the

211
00:07:16,160 --> 00:07:19,280
effort for this

212
00:07:17,120 --> 00:07:21,039
is pretty manual yes there's a bunch of

213
00:07:19,280 --> 00:07:23,599
command and control tools

214
00:07:21,039 --> 00:07:25,199
yes there's ways of creating automated

215
00:07:23,599 --> 00:07:27,039
attack infrastructure and

216
00:07:25,199 --> 00:07:28,639
there's even ways to automate some of

217
00:07:27,039 --> 00:07:30,639
the ttps that you do

218
00:07:28,639 --> 00:07:33,039
but at the end of the day you can't

219
00:07:30,639 --> 00:07:35,120
replace that person right so in no way

220
00:07:33,039 --> 00:07:36,159
do we talk about replacing the entire

221
00:07:35,120 --> 00:07:39,000
red team here

222
00:07:36,160 --> 00:07:40,319
we need the people and the frequency is

223
00:07:39,000 --> 00:07:42,160
intelligence-led

224
00:07:40,319 --> 00:07:44,000
right when we go to blackout when we go

225
00:07:42,160 --> 00:07:46,400
to defcon when we see

226
00:07:44,000 --> 00:07:47,360
a talk some new techniques a new tool a

227
00:07:46,400 --> 00:07:49,758
new exploit

228
00:07:47,360 --> 00:07:51,680
and oh day right we can test all of

229
00:07:49,759 --> 00:07:54,000
those and make our defense

230
00:07:51,680 --> 00:07:54,879
uh better and then we are seeing some

231
00:07:54,000 --> 00:07:56,560
regulators

232
00:07:54,879 --> 00:07:58,319
uh particularly international not so

233
00:07:56,560 --> 00:07:59,919
much in the u.s but bank of england

234
00:07:58,319 --> 00:08:02,160
european central bank

235
00:07:59,919 --> 00:08:04,159
uh hong kong monetary authority

236
00:08:02,160 --> 00:08:04,960
singapore monetary uh monetary authority

237
00:08:04,160 --> 00:08:06,639
of singapore

238
00:08:04,960 --> 00:08:08,799
have regulations i'm sure you've heard

239
00:08:06,639 --> 00:08:11,120
of seabester tiber eu

240
00:08:08,800 --> 00:08:12,879
and they are coming to the us so uh if

241
00:08:11,120 --> 00:08:14,560
you're here you'll probably get some

242
00:08:12,879 --> 00:08:16,720
through the occ generally through the

243
00:08:14,560 --> 00:08:19,280
financial area first and then

244
00:08:16,720 --> 00:08:20,240
um through others and really the most

245
00:08:19,280 --> 00:08:23,520
important thing

246
00:08:20,240 --> 00:08:25,280
of red teaming is the customer the

247
00:08:23,520 --> 00:08:27,520
customer is the blue team it's not your

248
00:08:25,280 --> 00:08:29,679
operations team it's not your developers

249
00:08:27,520 --> 00:08:30,719
it's generally the blue team everyone

250
00:08:29,680 --> 00:08:32,799
that does

251
00:08:30,720 --> 00:08:34,159
defense right your security operation

252
00:08:32,799 --> 00:08:36,799
center your hunt teams your

253
00:08:34,159 --> 00:08:38,000
instant response teams your threat

254
00:08:36,799 --> 00:08:40,159
hunting teams

255
00:08:38,000 --> 00:08:41,120
and uh pretty much everyone in our

256
00:08:40,159 --> 00:08:43,679
organization

257
00:08:41,120 --> 00:08:45,519
so lots of definitions are a reference

258
00:08:43,679 --> 00:08:47,040
here and at the end there is a slide

259
00:08:45,519 --> 00:08:50,240
with all our references right

260
00:08:47,040 --> 00:08:53,519
we didn't make all this up um we stand

261
00:08:50,240 --> 00:08:56,560
on uh shoulders of giants here and call

262
00:08:53,519 --> 00:09:00,080
out uh all the references at the end

263
00:08:56,560 --> 00:09:01,680
so what is external threat hunting dave

264
00:09:00,080 --> 00:09:03,279
well before i go into that i just wanted

265
00:09:01,680 --> 00:09:04,719
to give you the opportunity george

266
00:09:03,279 --> 00:09:07,120
would you like to start the presentation

267
00:09:04,720 --> 00:09:08,800
and uh boil down into a pedantic

268
00:09:07,120 --> 00:09:09,839
discussion about whether offensive tools

269
00:09:08,800 --> 00:09:12,240
are useful in the

270
00:09:09,839 --> 00:09:12,880
to security or not i've certainly seen

271
00:09:12,240 --> 00:09:15,040
that a lot

272
00:09:12,880 --> 00:09:17,200
i think we should skip that debate for

273
00:09:15,040 --> 00:09:20,640
now or we will run out of time

274
00:09:17,200 --> 00:09:22,560
indeed uh so keeping with that theme

275
00:09:20,640 --> 00:09:24,640
uh while some people will say why are

276
00:09:22,560 --> 00:09:26,640
you using offensive tools

277
00:09:24,640 --> 00:09:28,720
they actually do have a great point and

278
00:09:26,640 --> 00:09:30,240
this is a another example for it

279
00:09:28,720 --> 00:09:32,560
uh and that leads directly into external

280
00:09:30,240 --> 00:09:36,080
threat hunting basically if you're doing

281
00:09:32,560 --> 00:09:38,239
uh normal threat hunting or uh

282
00:09:36,080 --> 00:09:40,399
internal threat hunting you're you have

283
00:09:38,240 --> 00:09:41,279
a team that is using uh forensics

284
00:09:40,399 --> 00:09:43,200
information

285
00:09:41,279 --> 00:09:44,880
or uh from both your company and then

286
00:09:43,200 --> 00:09:46,959
ttps from the bad guy

287
00:09:44,880 --> 00:09:48,880
to determine if the opera if the actor

288
00:09:46,959 --> 00:09:51,839
is currently operating your environment

289
00:09:48,880 --> 00:09:52,880
or if they have uh ever operated in your

290
00:09:51,839 --> 00:09:54,480
environment

291
00:09:52,880 --> 00:09:56,240
external threat hunting is really

292
00:09:54,480 --> 00:09:58,000
focused around whether

293
00:09:56,240 --> 00:09:59,279
uh not so much for the reactor is

294
00:09:58,000 --> 00:10:02,640
currently operating

295
00:09:59,279 --> 00:10:04,880
but tracking the tpps for actors that

296
00:10:02,640 --> 00:10:06,720
may be operating an environment in the

297
00:10:04,880 --> 00:10:08,160
future that may have an interest in

298
00:10:06,720 --> 00:10:10,959
attacking you in the future

299
00:10:08,160 --> 00:10:12,560
uh in addition to that uh you're also

300
00:10:10,959 --> 00:10:15,680
searching for techniques

301
00:10:12,560 --> 00:10:17,599
techniques that are are being widely

302
00:10:15,680 --> 00:10:20,399
used by attackers now that might not

303
00:10:17,600 --> 00:10:21,760
be in use uh by attackers that are

304
00:10:20,399 --> 00:10:23,519
targeting your environment

305
00:10:21,760 --> 00:10:25,279
but could manifest themselves in the

306
00:10:23,519 --> 00:10:27,600
future and you want to

307
00:10:25,279 --> 00:10:28,560
be aware of how that manifestation uh

308
00:10:27,600 --> 00:10:31,120
can look

309
00:10:28,560 --> 00:10:32,000
uh and why do you want all this well all

310
00:10:31,120 --> 00:10:34,079
of this really

311
00:10:32,000 --> 00:10:36,240
has the same goal as red team we're

312
00:10:34,079 --> 00:10:37,359
doing this to make our blue team better

313
00:10:36,240 --> 00:10:39,519
to make our blue team

314
00:10:37,360 --> 00:10:41,920
our red team our purple team more

315
00:10:39,519 --> 00:10:44,839
informed uh and able to execute

316
00:10:41,920 --> 00:10:47,519
uh on their missions better but most

317
00:10:44,839 --> 00:10:48,880
importantly as i'm sure everybody

318
00:10:47,519 --> 00:10:50,640
has done this at some point you've sat

319
00:10:48,880 --> 00:10:51,519
around had a theoretical discussion with

320
00:10:50,640 --> 00:10:53,439
somebody

321
00:10:51,519 --> 00:10:55,120
about what uh what an actor could be

322
00:10:53,440 --> 00:10:57,440
doing or what it would look like

323
00:10:55,120 --> 00:10:59,279
uh and theory's great but firsthand

324
00:10:57,440 --> 00:11:02,079
knowledge is greater

325
00:10:59,279 --> 00:11:03,360
and i i always stress people to get

326
00:11:02,079 --> 00:11:04,560
firsthand knowledge of these kind of

327
00:11:03,360 --> 00:11:06,959
things

328
00:11:04,560 --> 00:11:08,479
so the the last real value of external

329
00:11:06,959 --> 00:11:10,160
threat hunting is the ability to test

330
00:11:08,480 --> 00:11:12,160
your assumptions

331
00:11:10,160 --> 00:11:13,360
now this is a very manual process

332
00:11:12,160 --> 00:11:15,839
currently

333
00:11:13,360 --> 00:11:18,240
i do this uh at a company called

334
00:11:15,839 --> 00:11:20,480
centurylink in their black lotus labs

335
00:11:18,240 --> 00:11:22,079
uh i do external threat hunting like

336
00:11:20,480 --> 00:11:24,880
this uh

337
00:11:22,079 --> 00:11:26,160
and it's very manual driven but i say i

338
00:11:24,880 --> 00:11:28,959
tell people it's

339
00:11:26,160 --> 00:11:29,600
more uh an art than a science and i

340
00:11:28,959 --> 00:11:32,160
cringe

341
00:11:29,600 --> 00:11:33,040
every time i say that because it's kind

342
00:11:32,160 --> 00:11:35,519
of admitting that

343
00:11:33,040 --> 00:11:36,959
we don't have a good process uh and

344
00:11:35,519 --> 00:11:39,200
that's exactly what that means

345
00:11:36,959 --> 00:11:40,079
so this is this is one of the attempts

346
00:11:39,200 --> 00:11:43,360
to

347
00:11:40,079 --> 00:11:48,160
uh refine that process add a rigor to it

348
00:11:43,360 --> 00:11:48,160
and add requirements that we can meet uh

349
00:11:48,480 --> 00:11:52,880
so while it's a manual process we use uh

350
00:11:51,040 --> 00:11:54,880
we use information like the c2 matrix to

351
00:11:52,880 --> 00:11:56,000
kind of power what tool sets what we can

352
00:11:54,880 --> 00:11:58,320
use

353
00:11:56,000 --> 00:12:00,160
and how to use them and this is a free

354
00:11:58,320 --> 00:12:00,800
like this is a process that never really

355
00:12:00,160 --> 00:12:03,120
stops

356
00:12:00,800 --> 00:12:04,160
we are always hunting for attackers any

357
00:12:03,120 --> 00:12:07,440
given day

358
00:12:04,160 --> 00:12:08,079
of my week i am in a different phase of

359
00:12:07,440 --> 00:12:12,079
hunting

360
00:12:08,079 --> 00:12:13,760
different uh actors i never stop uh

361
00:12:12,079 --> 00:12:15,279
in addition to informing the blue red

362
00:12:13,760 --> 00:12:18,000
and purple teams

363
00:12:15,279 --> 00:12:18,800
uh of what we find uh making their

364
00:12:18,000 --> 00:12:21,760
process better

365
00:12:18,800 --> 00:12:22,959
we've also found success uh in informing

366
00:12:21,760 --> 00:12:25,439
company officers

367
00:12:22,959 --> 00:12:26,479
especially uh risk risk and compliance

368
00:12:25,440 --> 00:12:30,320
type officers

369
00:12:26,480 --> 00:12:31,600
as to what actors are capable of in kind

370
00:12:30,320 --> 00:12:33,279
of helping them understand

371
00:12:31,600 --> 00:12:35,519
not something that's currently happening

372
00:12:33,279 --> 00:12:39,839
but how to understand something that

373
00:12:35,519 --> 00:12:39,839
may happen in the future

374
00:12:45,839 --> 00:12:49,279
why external threat hunting we just went

375
00:12:48,399 --> 00:12:50,720
through the

376
00:12:49,279 --> 00:12:52,480
you know this presentation is about

377
00:12:50,720 --> 00:12:53,279
giving the who the what the why when and

378
00:12:52,480 --> 00:12:55,120
the how of

379
00:12:53,279 --> 00:12:57,120
central freight hunting so we've now hit

380
00:12:55,120 --> 00:12:59,360
the y of external threat hunting

381
00:12:57,120 --> 00:13:00,639
and now let me be clear right up front

382
00:12:59,360 --> 00:13:02,880
that this is not

383
00:13:00,639 --> 00:13:04,079
a solution for every company i can't

384
00:13:02,880 --> 00:13:04,959
tell you how many times i've seen

385
00:13:04,079 --> 00:13:07,120
somebody present

386
00:13:04,959 --> 00:13:08,560
a really good idea or a really cool idea

387
00:13:07,120 --> 00:13:09,040
of a different way to handle a security

388
00:13:08,560 --> 00:13:10,959
problem

389
00:13:09,040 --> 00:13:12,560
and the first thing uh people rush to

390
00:13:10,959 --> 00:13:15,040
social media talk about is how

391
00:13:12,560 --> 00:13:16,000
this is a dumb solution it wouldn't work

392
00:13:15,040 --> 00:13:17,839
for my company

393
00:13:16,000 --> 00:13:19,760
or it wouldn't work for company x

394
00:13:17,839 --> 00:13:21,600
because uh you know we're still trying

395
00:13:19,760 --> 00:13:23,600
to get like a blue team program in place

396
00:13:21,600 --> 00:13:24,959
so why would we be doing this

397
00:13:23,600 --> 00:13:26,959
instead of building our blue team

398
00:13:24,959 --> 00:13:29,199
practice you shouldn't be

399
00:13:26,959 --> 00:13:31,599
this this is not a technique for uh

400
00:13:29,200 --> 00:13:33,079
every company it's not a a

401
00:13:31,600 --> 00:13:35,760
technique for a low maturity

402
00:13:33,079 --> 00:13:36,880
organization but for organizations that

403
00:13:35,760 --> 00:13:40,319
have maturity

404
00:13:36,880 --> 00:13:41,439
the head count and division uh this is a

405
00:13:40,320 --> 00:13:45,360
great solution

406
00:13:41,440 --> 00:13:46,800
to bridge the the gap between

407
00:13:45,360 --> 00:13:48,720
public information that's being made

408
00:13:46,800 --> 00:13:51,359
about actors and your own

409
00:13:48,720 --> 00:13:53,760
need for information uh about actors to

410
00:13:51,360 --> 00:13:55,440
protect your environment

411
00:13:53,760 --> 00:13:56,720
and like i said the workflow for this is

412
00:13:55,440 --> 00:13:57,360
really hard to develop without a certain

413
00:13:56,720 --> 00:14:00,959
amount of gut

414
00:13:57,360 --> 00:14:01,680
instinct and hopefully this presentation

415
00:14:00,959 --> 00:14:04,079
starts

416
00:14:01,680 --> 00:14:05,199
the renaissance of this uh planning

417
00:14:04,079 --> 00:14:07,920
where

418
00:14:05,199 --> 00:14:09,120
we're moving away from gut planning to a

419
00:14:07,920 --> 00:14:10,959
more rigorous planning

420
00:14:09,120 --> 00:14:12,160
that's part of the reason why what

421
00:14:10,959 --> 00:14:12,800
george and i are working together

422
00:14:12,160 --> 00:14:14,319
because

423
00:14:12,800 --> 00:14:16,560
while i've done red teaming and threat

424
00:14:14,320 --> 00:14:17,279
hunting he's really got a lot of

425
00:14:16,560 --> 00:14:20,399
experience

426
00:14:17,279 --> 00:14:22,639
in the the planning and operations the

427
00:14:20,399 --> 00:14:23,440
writ like uh making the processes more

428
00:14:22,639 --> 00:14:25,440
rigorous

429
00:14:23,440 --> 00:14:27,040
for red team environments and he's

430
00:14:25,440 --> 00:14:29,360
helping uh he's

431
00:14:27,040 --> 00:14:30,959
driving the effort on our part to make

432
00:14:29,360 --> 00:14:32,959
uh these types of testing

433
00:14:30,959 --> 00:14:34,160
more rigorous and fit into the purple tv

434
00:14:32,959 --> 00:14:38,560
framework

435
00:14:34,160 --> 00:14:40,800
uh yeah and this does

436
00:14:38,560 --> 00:14:41,839
yeah on that value proposition that you

437
00:14:40,800 --> 00:14:44,160
mentioned right like

438
00:14:41,839 --> 00:14:45,760
both teams the red team and your

439
00:14:44,160 --> 00:14:49,199
external hunting right is

440
00:14:45,760 --> 00:14:49,920
all about providing that value right and

441
00:14:49,199 --> 00:14:53,199
i think you're

442
00:14:49,920 --> 00:14:56,839
gonna touch on that right now right uh

443
00:14:53,199 --> 00:15:00,560
you gotta be you gotta be aware uh i i

444
00:14:56,839 --> 00:15:01,519
i uh i myself have fallen into many a

445
00:15:00,560 --> 00:15:02,880
boondoggle in

446
00:15:01,519 --> 00:15:05,120
in the pursuit of this type of

447
00:15:02,880 --> 00:15:07,360
information or a

448
00:15:05,120 --> 00:15:08,639
sick death disease kind of thing like i

449
00:15:07,360 --> 00:15:11,440
uh

450
00:15:08,639 --> 00:15:12,079
i have you know gotten an idea and

451
00:15:11,440 --> 00:15:14,240
followed it

452
00:15:12,079 --> 00:15:15,839
and it turned out not the basis of the

453
00:15:14,240 --> 00:15:17,440
idea probably wasn't all that useful

454
00:15:15,839 --> 00:15:19,199
uh what i found probably wasn't all that

455
00:15:17,440 --> 00:15:20,000
useful but the intellectual curiosity

456
00:15:19,199 --> 00:15:21,519
kept me going

457
00:15:20,000 --> 00:15:23,600
and while that was fun it actually

458
00:15:21,519 --> 00:15:25,120
didn't provide really any value for the

459
00:15:23,600 --> 00:15:26,399
company

460
00:15:25,120 --> 00:15:28,480
and the value is kind of hard to

461
00:15:26,399 --> 00:15:29,519
quantify at first because what you

462
00:15:28,480 --> 00:15:32,560
really need to be doing

463
00:15:29,519 --> 00:15:34,000
is uh informing other teams

464
00:15:32,560 --> 00:15:35,758
of things that may or may not have

465
00:15:34,000 --> 00:15:36,800
happened yet and so it's hard when

466
00:15:35,759 --> 00:15:38,079
something

467
00:15:36,800 --> 00:15:40,160
we have a good idea for something that

468
00:15:38,079 --> 00:15:41,680
hasn't happened yet or

469
00:15:40,160 --> 00:15:43,680
you know you have a theory that you're

470
00:15:41,680 --> 00:15:47,279
testing until it does happen

471
00:15:43,680 --> 00:15:49,439
people are like well that may not have

472
00:15:47,279 --> 00:15:51,040
been all that useful but then you know

473
00:15:49,440 --> 00:15:51,440
right after it happens or an attempt

474
00:15:51,040 --> 00:15:52,719
that

475
00:15:51,440 --> 00:15:54,399
hopefully you're now able to stop

476
00:15:52,720 --> 00:15:56,000
they'll be like well that was great you

477
00:15:54,399 --> 00:15:56,720
got to be able to bridge that divide

478
00:15:56,000 --> 00:15:59,920
between

479
00:15:56,720 --> 00:16:01,120
those two states uh i remember a time

480
00:15:59,920 --> 00:16:02,880
not long ago where

481
00:16:01,120 --> 00:16:04,560
this type that the type of debate about

482
00:16:02,880 --> 00:16:06,160
the value uh

483
00:16:04,560 --> 00:16:08,160
these types of tests would bring to an

484
00:16:06,160 --> 00:16:08,560
organization were actually all about red

485
00:16:08,160 --> 00:16:09,759
genie

486
00:16:08,560 --> 00:16:11,599
like a lot of people didn't think that

487
00:16:09,759 --> 00:16:15,120
red team had any value

488
00:16:11,600 --> 00:16:18,240
and that had to be uh uh discussed a lot

489
00:16:15,120 --> 00:16:20,720
but this the value here

490
00:16:18,240 --> 00:16:22,320
is being the clear concise value here is

491
00:16:20,720 --> 00:16:24,399
being able to use

492
00:16:22,320 --> 00:16:26,240
tools techniques and procedures that you

493
00:16:24,399 --> 00:16:28,800
develop for your red team

494
00:16:26,240 --> 00:16:29,759
uh to to enable your external threat

495
00:16:28,800 --> 00:16:33,040
hunting

496
00:16:29,759 --> 00:16:34,560
to better inform your own security

497
00:16:33,040 --> 00:16:35,759
practices

498
00:16:34,560 --> 00:16:37,920
there's a lot of different ways to

499
00:16:35,759 --> 00:16:38,720
measure it uh most of it won't be a

500
00:16:37,920 --> 00:16:39,920
smoking gun

501
00:16:38,720 --> 00:16:42,639
most of it will be incremental

502
00:16:39,920 --> 00:16:45,040
improvements but doing

503
00:16:42,639 --> 00:16:48,560
anything at this point to improve your

504
00:16:45,040 --> 00:16:48,560
security process is better than doing

505
00:16:48,839 --> 00:16:55,360
nothing

506
00:16:51,839 --> 00:16:58,399
yeah so when we talk about um the needs

507
00:16:55,360 --> 00:17:00,240
of our teams right from you know

508
00:16:58,399 --> 00:17:02,480
discussing with dave we

509
00:17:00,240 --> 00:17:03,600
we said you know these are the needs of

510
00:17:02,480 --> 00:17:06,720
the red team

511
00:17:03,600 --> 00:17:08,480
and then he was sharing the needs of the

512
00:17:06,720 --> 00:17:10,799
external threat hunting team and we

513
00:17:08,480 --> 00:17:11,679
realized they're all very very similar

514
00:17:10,799 --> 00:17:13,918
right

515
00:17:11,679 --> 00:17:14,799
from a basic perspective right the red

516
00:17:13,919 --> 00:17:17,039
team gets in

517
00:17:14,799 --> 00:17:18,799
they get into an infrastructure and they

518
00:17:17,039 --> 00:17:22,240
pivot through that infrastructure

519
00:17:18,799 --> 00:17:23,760
but more importantly we need logs right

520
00:17:22,240 --> 00:17:26,160
we're doing a zero

521
00:17:23,760 --> 00:17:28,319
knowledge red team engagement and i'm

522
00:17:26,160 --> 00:17:30,400
managing a team of three people

523
00:17:28,319 --> 00:17:32,399
i need to know what they're doing

524
00:17:30,400 --> 00:17:33,760
exactly what time they did it what was

525
00:17:32,400 --> 00:17:36,960
the result what was the

526
00:17:33,760 --> 00:17:40,080
impact and make sure it was all locked

527
00:17:36,960 --> 00:17:42,400
especially as you scale up right running

528
00:17:40,080 --> 00:17:44,639
this as a two-person red team

529
00:17:42,400 --> 00:17:45,679
is easy right because you can just talk

530
00:17:44,640 --> 00:17:48,160
to the other person

531
00:17:45,679 --> 00:17:50,080
share information but in my last

532
00:17:48,160 --> 00:17:50,799
organization we got up to a 12 person

533
00:17:50,080 --> 00:17:53,280
red team

534
00:17:50,799 --> 00:17:54,480
and that scaling was so important to

535
00:17:53,280 --> 00:17:56,080
have these logs

536
00:17:54,480 --> 00:17:57,840
because you have things like the

537
00:17:56,080 --> 00:17:59,678
confliction what happens if you're

538
00:17:57,840 --> 00:18:03,039
running a red team engagement

539
00:17:59,679 --> 00:18:05,520
and that um the sock or the blue team

540
00:18:03,039 --> 00:18:06,240
catches an active attack first thing

541
00:18:05,520 --> 00:18:08,559
they're gonna do

542
00:18:06,240 --> 00:18:09,679
is deconflict with you you need to prove

543
00:18:08,559 --> 00:18:11,918
that it wasn't you

544
00:18:09,679 --> 00:18:13,280
and then make the right decisions or you

545
00:18:11,919 --> 00:18:15,679
can say yep that was us

546
00:18:13,280 --> 00:18:17,440
at exactly this time from this host we

547
00:18:15,679 --> 00:18:20,480
executed that on this host

548
00:18:17,440 --> 00:18:22,240
and this was uh the result

549
00:18:20,480 --> 00:18:23,760
i think that's exactly what you're

550
00:18:22,240 --> 00:18:24,960
looking for on your team as well right

551
00:18:23,760 --> 00:18:27,200
dave

552
00:18:24,960 --> 00:18:28,559
yeah strangely uh uh the channel threat

553
00:18:27,200 --> 00:18:29,039
intelligence or the channel threat

554
00:18:28,559 --> 00:18:31,280
hunting

555
00:18:29,039 --> 00:18:32,480
we're uh we're also doing a zero

556
00:18:31,280 --> 00:18:34,160
knowledge assessment

557
00:18:32,480 --> 00:18:38,000
uh instead of our own company though

558
00:18:34,160 --> 00:18:38,000
we're doing it off of an actor

559
00:18:38,080 --> 00:18:42,960
just just so i'm clear there's no

560
00:18:40,320 --> 00:18:44,559
advocacy here to do anything illegal uh

561
00:18:42,960 --> 00:18:46,160
we'll show you what we mean but we are

562
00:18:44,559 --> 00:18:49,280
doing a zero uh

563
00:18:46,160 --> 00:18:51,039
knowledge assessment of an actor uh we

564
00:18:49,280 --> 00:18:52,879
we're trying to deal with actor

565
00:18:51,039 --> 00:18:54,960
evolution at this point where

566
00:18:52,880 --> 00:18:56,559
new techniques that bad guys are using

567
00:18:54,960 --> 00:18:58,000
like uh filtering

568
00:18:56,559 --> 00:18:59,678
you know techniques have shown up in the

569
00:18:58,000 --> 00:19:00,559
last couple years they're new of like

570
00:18:59,679 --> 00:19:03,039
filtering

571
00:19:00,559 --> 00:19:04,320
or uh making sure that there's like a

572
00:19:03,039 --> 00:19:08,320
multi-stage

573
00:19:04,320 --> 00:19:11,520
uh compromise and um promotion process

574
00:19:08,320 --> 00:19:13,120
so only like verified vetted uh

575
00:19:11,520 --> 00:19:15,520
victims will get your payload so they

576
00:19:13,120 --> 00:19:19,120
don't end up on like virus solo

577
00:19:15,520 --> 00:19:19,520
like this is uh uh our uh answer to how

578
00:19:19,120 --> 00:19:22,159
the

579
00:19:19,520 --> 00:19:23,360
how will we get around uh those actor

580
00:19:22,160 --> 00:19:24,960
activities

581
00:19:23,360 --> 00:19:26,639
uh so the ability to pivot through the

582
00:19:24,960 --> 00:19:28,080
infrastructure the ability to have your

583
00:19:26,640 --> 00:19:29,520
red team or i'm sorry your central

584
00:19:28,080 --> 00:19:31,520
threat hunting team no matter

585
00:19:29,520 --> 00:19:33,039
where they're based in the world being

586
00:19:31,520 --> 00:19:36,320
able to look like uh

587
00:19:33,039 --> 00:19:38,080
to an attacker that they're inside or

588
00:19:36,320 --> 00:19:40,080
the type of target that they're

589
00:19:38,080 --> 00:19:42,879
targeting so they can get to payloads

590
00:19:40,080 --> 00:19:46,559
for then further analysis right that is

591
00:19:42,880 --> 00:19:46,559
one of the core tenets of this idea

592
00:19:50,000 --> 00:19:56,160
so when we talk and uh do and

593
00:19:53,120 --> 00:19:58,159
really plan for red team engagements a

594
00:19:56,160 --> 00:19:58,720
lot of time is found planning i feel

595
00:19:58,160 --> 00:20:00,559
like

596
00:19:58,720 --> 00:20:02,480
people that are new to red team think

597
00:20:00,559 --> 00:20:04,080
it's all just you know getting shelves

598
00:20:02,480 --> 00:20:07,120
and moving laterally and

599
00:20:04,080 --> 00:20:08,240
owning stuff right but um just to put in

600
00:20:07,120 --> 00:20:11,199
perspective

601
00:20:08,240 --> 00:20:11,760
my two day red team course has half a

602
00:20:11,200 --> 00:20:14,400
day

603
00:20:11,760 --> 00:20:15,440
of planning uh the other half of the

604
00:20:14,400 --> 00:20:16,720
class is on

605
00:20:15,440 --> 00:20:19,520
on the hands-on because that's what

606
00:20:16,720 --> 00:20:21,840
students want but it's that important

607
00:20:19,520 --> 00:20:23,440
and here you know just to put a lot in

608
00:20:21,840 --> 00:20:26,799
one slide for you to

609
00:20:23,440 --> 00:20:28,400
uh digest very quick we have a number of

610
00:20:26,799 --> 00:20:30,400
items that we think about when we plan

611
00:20:28,400 --> 00:20:32,559
both the red team and the external

612
00:20:30,400 --> 00:20:34,000
threat hunting team and we're gonna dive

613
00:20:32,559 --> 00:20:36,320
deeper into some of these some

614
00:20:34,000 --> 00:20:37,280
we're going to skip over just because of

615
00:20:36,320 --> 00:20:39,439
time but

616
00:20:37,280 --> 00:20:40,559
goals and objectives the red team has

617
00:20:39,440 --> 00:20:42,080
goals and objectives

618
00:20:40,559 --> 00:20:43,678
those are generally similar to the

619
00:20:42,080 --> 00:20:46,080
objective of the adversary

620
00:20:43,679 --> 00:20:47,679
but this is coming from the senior

621
00:20:46,080 --> 00:20:49,280
management what do they want to test

622
00:20:47,679 --> 00:20:50,880
what do they want to verify

623
00:20:49,280 --> 00:20:53,039
they want to see if a particular threat

624
00:20:50,880 --> 00:20:55,760
actor would be able to

625
00:20:53,039 --> 00:20:56,400
uh cause the same thing that happened at

626
00:20:55,760 --> 00:20:59,039
garmin

627
00:20:56,400 --> 00:20:59,520
in our organization and external threat

628
00:20:59,039 --> 00:21:02,158
hunting

629
00:20:59,520 --> 00:21:04,120
also have goals and objectives right

630
00:21:02,159 --> 00:21:05,520
cyber threat intelligence here we have

631
00:21:04,120 --> 00:21:07,760
differentiators

632
00:21:05,520 --> 00:21:09,679
in red teaming you want cyber threat

633
00:21:07,760 --> 00:21:11,840
intelligence to give you an adversary

634
00:21:09,679 --> 00:21:12,799
that has the opportunity capability and

635
00:21:11,840 --> 00:21:14,879
intent

636
00:21:12,799 --> 00:21:16,879
to target that target organization right

637
00:21:14,880 --> 00:21:18,799
you don't want to uh do a

638
00:21:16,880 --> 00:21:19,919
deep panda attack or an orange worm

639
00:21:18,799 --> 00:21:20,639
attack that's normally against

640
00:21:19,919 --> 00:21:22,880
healthcare

641
00:21:20,640 --> 00:21:24,240
if you're a financial right like you can

642
00:21:22,880 --> 00:21:25,760
do it but

643
00:21:24,240 --> 00:21:28,400
probably not not not the best use of

644
00:21:25,760 --> 00:21:31,360
your time then you want to emulate those

645
00:21:28,400 --> 00:21:33,440
ttps and that adversary behavior

646
00:21:31,360 --> 00:21:35,280
is what you're emulating from the

647
00:21:33,440 --> 00:21:37,440
external threat hunting perspective and

648
00:21:35,280 --> 00:21:38,399
dave will go into an entire slide on

649
00:21:37,440 --> 00:21:40,240
this is

650
00:21:38,400 --> 00:21:43,039
they need to pick a target list and

651
00:21:40,240 --> 00:21:45,600
figure out who they're going to go hunt

652
00:21:43,039 --> 00:21:47,120
we both will have scopes we'll both have

653
00:21:45,600 --> 00:21:48,320
exercise coordinators and project

654
00:21:47,120 --> 00:21:50,479
management and this

655
00:21:48,320 --> 00:21:51,439
we can talk about for a long time right

656
00:21:50,480 --> 00:21:53,679
we want

657
00:21:51,440 --> 00:21:55,280
this exercise to be valuable and it's

658
00:21:53,679 --> 00:21:56,080
great to have a project manager or

659
00:21:55,280 --> 00:21:59,120
coordinator

660
00:21:56,080 --> 00:22:01,120
going through that making sure everyone

661
00:21:59,120 --> 00:22:03,120
is in sync as you go through

662
00:22:01,120 --> 00:22:05,520
then you have rules of engagement here

663
00:22:03,120 --> 00:22:08,639
we have similarities as well

664
00:22:05,520 --> 00:22:10,480
for example both uh the red team and the

665
00:22:08,640 --> 00:22:11,280
external threat hunting should not break

666
00:22:10,480 --> 00:22:13,120
laws right

667
00:22:11,280 --> 00:22:14,399
don't get arrested and don't forget the

668
00:22:13,120 --> 00:22:17,199
purpose of the exercise

669
00:22:14,400 --> 00:22:18,799
there is always an objective and a goal

670
00:22:17,200 --> 00:22:20,320
and that is your focus

671
00:22:18,799 --> 00:22:21,840
on the red team side we don't want to

672
00:22:20,320 --> 00:22:23,280
bring down infrastructure affect

673
00:22:21,840 --> 00:22:25,039
business processes

674
00:22:23,280 --> 00:22:26,879
and on the external threat hunting side

675
00:22:25,039 --> 00:22:29,200
you don't want to get into a knife fight

676
00:22:26,880 --> 00:22:32,720
with a threat actor

677
00:22:29,200 --> 00:22:35,280
and then attack infrastructure yeah

678
00:22:32,720 --> 00:22:36,000
just to to make this theory absolutely

679
00:22:35,280 --> 00:22:39,280
clear

680
00:22:36,000 --> 00:22:41,360
uh external freight hunting for actors

681
00:22:39,280 --> 00:22:44,080
is designed to give you more information

682
00:22:41,360 --> 00:22:44,639
uh to help you understand how an actor

683
00:22:44,080 --> 00:22:46,399
works

684
00:22:44,640 --> 00:22:47,919
you should not chew anything that makes

685
00:22:46,400 --> 00:22:49,360
an actor who is previously not

686
00:22:47,919 --> 00:22:52,320
interested in you

687
00:22:49,360 --> 00:22:53,600
interested in you uh so you shouldn't

688
00:22:52,320 --> 00:22:54,879
visualize this like you're knife

689
00:22:53,600 --> 00:22:57,199
fighting in an alley

690
00:22:54,880 --> 00:22:57,919
with a with an actor it really is more

691
00:22:57,200 --> 00:23:00,320
like

692
00:22:57,919 --> 00:23:02,320
you know uh you're doing advanced recon

693
00:23:00,320 --> 00:23:04,559
on an actor and

694
00:23:02,320 --> 00:23:05,678
snipping the little bits of information

695
00:23:04,559 --> 00:23:08,480
that can be

696
00:23:05,679 --> 00:23:10,720
uh used to inform your your security

697
00:23:08,480 --> 00:23:10,720
team

698
00:23:10,880 --> 00:23:15,919
exactly and attack infrastructure

699
00:23:14,080 --> 00:23:17,678
we both need to set up attack

700
00:23:15,919 --> 00:23:20,000
infrastructure that's going to be

701
00:23:17,679 --> 00:23:22,159
the main focus of our talk uh moving

702
00:23:20,000 --> 00:23:23,760
forward along with lessons one

703
00:23:22,159 --> 00:23:25,679
in the red team we do analysis on

704
00:23:23,760 --> 00:23:26,559
response where we want to see how the

705
00:23:25,679 --> 00:23:28,240
blue team

706
00:23:26,559 --> 00:23:30,879
reacted how they detected how they

707
00:23:28,240 --> 00:23:31,280
responded on the external threat hunting

708
00:23:30,880 --> 00:23:32,880
side

709
00:23:31,280 --> 00:23:34,320
we have a slide on this as well that

710
00:23:32,880 --> 00:23:38,559
we'll dive deeper into

711
00:23:34,320 --> 00:23:40,799
is about analysis and refinement

712
00:23:38,559 --> 00:23:42,480
so how do you formulate a target list

713
00:23:40,799 --> 00:23:45,200
when uh you're doing planning

714
00:23:42,480 --> 00:23:47,520
dave well once again i want to say this

715
00:23:45,200 --> 00:23:48,960
is more art than science which

716
00:23:47,520 --> 00:23:50,960
as i said earlier it makes me cringe

717
00:23:48,960 --> 00:23:54,400
every time i see it uh

718
00:23:50,960 --> 00:23:55,360
say it but in reality this is a a moment

719
00:23:54,400 --> 00:23:57,520
where you need to be

720
00:23:55,360 --> 00:23:59,360
extremely intellectually honest with

721
00:23:57,520 --> 00:24:01,120
yourself right i've

722
00:23:59,360 --> 00:24:03,439
i can't tell you how many people i've

723
00:24:01,120 --> 00:24:04,879
i've come across they're like oh yeah

724
00:24:03,440 --> 00:24:06,159
you know i'm probably getting hit by

725
00:24:04,880 --> 00:24:08,080
this apt

726
00:24:06,159 --> 00:24:09,200
and you look at your organization and

727
00:24:08,080 --> 00:24:12,240
you look at what they do

728
00:24:09,200 --> 00:24:15,360
and they don't have any uh pii

729
00:24:12,240 --> 00:24:19,360
or useful data they're not in in any

730
00:24:15,360 --> 00:24:21,439
uh chain of events that would

731
00:24:19,360 --> 00:24:23,760
drive an apt to be interested in them

732
00:24:21,440 --> 00:24:26,480
and you didn't have to kind of go no

733
00:24:23,760 --> 00:24:27,840
no maybe not uh they probably won't

734
00:24:26,480 --> 00:24:29,919
aren't focusing on you

735
00:24:27,840 --> 00:24:31,678
then you get the ego push back off well

736
00:24:29,919 --> 00:24:33,679
yeah but you know who i am i'm

737
00:24:31,679 --> 00:24:35,200
i'm the largest snowmobile dealer in

738
00:24:33,679 --> 00:24:37,120
south dakota

739
00:24:35,200 --> 00:24:38,400
uh that's not a that's just a funny

740
00:24:37,120 --> 00:24:40,000
example that's not a real

741
00:24:38,400 --> 00:24:41,360
real thing somebody's ever said to me

742
00:24:40,000 --> 00:24:42,960
but you know somebody said that you'd be

743
00:24:41,360 --> 00:24:43,760
like well yeah that probably doesn't

744
00:24:42,960 --> 00:24:45,360
interest

745
00:24:43,760 --> 00:24:46,879
a lot of apts right so you have to be

746
00:24:45,360 --> 00:24:47,600
intellectually honest you got to take

747
00:24:46,880 --> 00:24:49,360
off your

748
00:24:47,600 --> 00:24:51,520
your security hunting cap for a moment

749
00:24:49,360 --> 00:24:52,559
you got to put on your business analysis

750
00:24:51,520 --> 00:24:54,799
gap and actually

751
00:24:52,559 --> 00:24:55,760
take a look at what the company you're

752
00:24:54,799 --> 00:24:57,360
you're

753
00:24:55,760 --> 00:24:58,960
protecting it's what what kind of

754
00:24:57,360 --> 00:25:01,039
resources they have

755
00:24:58,960 --> 00:25:02,960
uh what kind of information they store

756
00:25:01,039 --> 00:25:05,679
or like whether they're in a

757
00:25:02,960 --> 00:25:07,039
chain of events for something like covid

758
00:25:05,679 --> 00:25:10,480
vaccine research

759
00:25:07,039 --> 00:25:14,480
or national defense organizations and

760
00:25:10,480 --> 00:25:16,559
uh then match what your organization's

761
00:25:14,480 --> 00:25:18,000
uh threat model really is to an actor

762
00:25:16,559 --> 00:25:20,559
that would be interested in

763
00:25:18,000 --> 00:25:21,600
targeting them uh and that's the most

764
00:25:20,559 --> 00:25:22,639
important part of the intellectual

765
00:25:21,600 --> 00:25:24,719
honesty

766
00:25:22,640 --> 00:25:26,640
uh and then you have to be informed

767
00:25:24,720 --> 00:25:29,200
enough about adversarial

768
00:25:26,640 --> 00:25:30,320
uh posture to understand their

769
00:25:29,200 --> 00:25:31,120
opportunity their intent and their

770
00:25:30,320 --> 00:25:34,000
capability

771
00:25:31,120 --> 00:25:34,559
to actually attack your organization uh

772
00:25:34,000 --> 00:25:37,200
and

773
00:25:34,559 --> 00:25:39,039
when you've done those two steps the

774
00:25:37,200 --> 00:25:42,080
list of actors that

775
00:25:39,039 --> 00:25:43,760
you compile is the

776
00:25:42,080 --> 00:25:46,639
list that you would use for external

777
00:25:43,760 --> 00:25:46,640
threat hunting purposes

778
00:25:49,360 --> 00:25:52,799
so once we get the list of who we're

779
00:25:51,600 --> 00:25:55,678
gonna go after or

780
00:25:52,799 --> 00:25:56,240
on the red team side we have the plan

781
00:25:55,679 --> 00:25:58,400
down

782
00:25:56,240 --> 00:26:00,000
then we talk about attack infrastructure

783
00:25:58,400 --> 00:26:02,320
and yes this is one slide

784
00:26:00,000 --> 00:26:04,320
with a ton of things that we do both on

785
00:26:02,320 --> 00:26:06,320
red team and external threat hunting

786
00:26:04,320 --> 00:26:07,600
so take a screenshot or look at the

787
00:26:06,320 --> 00:26:09,120
slide but

788
00:26:07,600 --> 00:26:10,719
i'm gonna hit on the main things on the

789
00:26:09,120 --> 00:26:13,360
red team side we want

790
00:26:10,720 --> 00:26:14,159
to choose and procure external service

791
00:26:13,360 --> 00:26:15,760
providers

792
00:26:14,159 --> 00:26:17,600
a lot of the time we use cloud

793
00:26:15,760 --> 00:26:19,440
environments right because most of the

794
00:26:17,600 --> 00:26:23,678
targets are not going to block

795
00:26:19,440 --> 00:26:26,720
aws or gcp or azure or digital ocean etc

796
00:26:23,679 --> 00:26:29,520
right because then other processes break

797
00:26:26,720 --> 00:26:30,159
um but we do want to procure this in a

798
00:26:29,520 --> 00:26:32,559
way

799
00:26:30,159 --> 00:26:34,320
that is not attributable back to the red

800
00:26:32,559 --> 00:26:37,120
team because then the blue team sees it

801
00:26:34,320 --> 00:26:38,080
they're like oh this domain or this ip

802
00:26:37,120 --> 00:26:40,158
was purchased by

803
00:26:38,080 --> 00:26:41,360
george and george is on the red team so

804
00:26:40,159 --> 00:26:43,279
this red team where

805
00:26:41,360 --> 00:26:45,120
we don't have to worry about that right

806
00:26:43,279 --> 00:26:47,520
and it's going to be very similar

807
00:26:45,120 --> 00:26:48,639
for external threat hunters as well you

808
00:26:47,520 --> 00:26:51,120
don't want to buy

809
00:26:48,640 --> 00:26:52,880
anything or spend your loan with your

810
00:26:51,120 --> 00:26:55,439
personal credit card that attributes

811
00:26:52,880 --> 00:26:56,640
back to you we then want to purchase

812
00:26:55,440 --> 00:26:58,799
domain names

813
00:26:56,640 --> 00:27:00,880
we want to generate domain certificates

814
00:26:58,799 --> 00:27:01,918
whether you purchase tls search or use

815
00:27:00,880 --> 00:27:03,279
let's encrypt

816
00:27:01,919 --> 00:27:05,360
if you're going to do phishing you have

817
00:27:03,279 --> 00:27:07,440
to set up mail servers you're going to

818
00:27:05,360 --> 00:27:10,559
do phishing to steal credentials

819
00:27:07,440 --> 00:27:12,720
or get them to a site and then download

820
00:27:10,559 --> 00:27:14,320
something you have to set up those sites

821
00:27:12,720 --> 00:27:15,919
and then for all of these you need

822
00:27:14,320 --> 00:27:17,600
reputation right because

823
00:27:15,919 --> 00:27:19,600
most mature organizations are going to

824
00:27:17,600 --> 00:27:21,840
have some sort of categorization

825
00:27:19,600 --> 00:27:22,719
of what domains you can access right

826
00:27:21,840 --> 00:27:24,559
rarely do

827
00:27:22,720 --> 00:27:26,399
enterprise organizations just allow you

828
00:27:24,559 --> 00:27:28,080
to connect out to an ip address

829
00:27:26,399 --> 00:27:30,080
so you have domains but then those

830
00:27:28,080 --> 00:27:32,639
domains have to be classified

831
00:27:30,080 --> 00:27:33,279
with things that will be allowed out

832
00:27:32,640 --> 00:27:35,360
right like

833
00:27:33,279 --> 00:27:36,880
perfect example is pornography most

834
00:27:35,360 --> 00:27:39,360
organizations block that

835
00:27:36,880 --> 00:27:40,880
how they do it because that domain is

836
00:27:39,360 --> 00:27:43,120
categorized as such

837
00:27:40,880 --> 00:27:44,480
so what do you do you need to categorize

838
00:27:43,120 --> 00:27:47,760
your domains

839
00:27:44,480 --> 00:27:49,679
as things that won't get blocked

840
00:27:47,760 --> 00:27:51,840
and maybe you won't even get decrypted

841
00:27:49,679 --> 00:27:54,320
like finance and health but

842
00:27:51,840 --> 00:27:55,120
don't tell anyone i said that then you

843
00:27:54,320 --> 00:27:56,720
actually set

844
00:27:55,120 --> 00:27:58,559
up george how can you tell what

845
00:27:56,720 --> 00:28:00,080
pornography is

846
00:27:58,559 --> 00:28:02,639
i'm sorry how can you tell what

847
00:28:00,080 --> 00:28:04,559
pornography is it's generally based on

848
00:28:02,640 --> 00:28:06,559
the reputation that that domain

849
00:28:04,559 --> 00:28:07,840
is given um there's various different

850
00:28:06,559 --> 00:28:10,799
service providers

851
00:28:07,840 --> 00:28:12,240
um so they categorize them it's

852
00:28:10,799 --> 00:28:14,799
different processes per

853
00:28:12,240 --> 00:28:15,679
each one i'm familiar with how palo alto

854
00:28:14,799 --> 00:28:18,158
and uh

855
00:28:15,679 --> 00:28:19,679
blue coat which is now semantic do it

856
00:28:18,159 --> 00:28:22,640
but yeah it's very little

857
00:28:19,679 --> 00:28:23,840
people based it's um it's it's pretty

858
00:28:22,640 --> 00:28:26,399
easy to uh

859
00:28:23,840 --> 00:28:26,879
to gain reputation another thing you can

860
00:28:26,399 --> 00:28:29,439
do

861
00:28:26,880 --> 00:28:30,080
is buy a domain that already had

862
00:28:29,440 --> 00:28:33,200
reputation

863
00:28:30,080 --> 00:28:35,039
but has expired and used that one and

864
00:28:33,200 --> 00:28:37,440
the reason why

865
00:28:35,039 --> 00:28:39,360
yeah the reason you do all this is to

866
00:28:37,440 --> 00:28:40,640
then set up your infrastructure right

867
00:28:39,360 --> 00:28:42,559
so we're going to talk about command and

868
00:28:40,640 --> 00:28:44,080
control shortly but you have to set up

869
00:28:42,559 --> 00:28:45,360
all your tooling pick a command and

870
00:28:44,080 --> 00:28:47,439
control server

871
00:28:45,360 --> 00:28:48,879
and then get those servers and all that

872
00:28:47,440 --> 00:28:50,720
information sent

873
00:28:48,880 --> 00:28:52,640
somewhere so that you can view it

874
00:28:50,720 --> 00:28:54,240
centrally and red oak is what we're

875
00:28:52,640 --> 00:28:56,840
going to talk about shortly

876
00:28:54,240 --> 00:28:58,080
red oak was originally created for

877
00:28:56,840 --> 00:29:01,360
logging

878
00:28:58,080 --> 00:29:04,320
if the blue team was detecting you now

879
00:29:01,360 --> 00:29:05,678
as we do all of this we need to have

880
00:29:04,320 --> 00:29:07,200
operational security

881
00:29:05,679 --> 00:29:08,880
did you have any other comments on

882
00:29:07,200 --> 00:29:11,039
attack infrastructure before we head to

883
00:29:08,880 --> 00:29:14,799
opsec

884
00:29:11,039 --> 00:29:15,200
no sir cool so in operational security

885
00:29:14,799 --> 00:29:17,440
from

886
00:29:15,200 --> 00:29:19,360
the red team perspective you want to

887
00:29:17,440 --> 00:29:20,159
ensure that all your systems are locked

888
00:29:19,360 --> 00:29:22,399
down right

889
00:29:20,159 --> 00:29:24,320
that only your red team members can

890
00:29:22,399 --> 00:29:24,799
access the administrative interfaces

891
00:29:24,320 --> 00:29:27,678
such as

892
00:29:24,799 --> 00:29:28,480
ssh right no one else should be ssh into

893
00:29:27,679 --> 00:29:30,640
your servers

894
00:29:28,480 --> 00:29:31,520
kind of like practice what we preach we

895
00:29:30,640 --> 00:29:34,000
give these

896
00:29:31,520 --> 00:29:35,200
uh recommendations all the time you need

897
00:29:34,000 --> 00:29:37,120
to do them too

898
00:29:35,200 --> 00:29:38,559
then when you create your payloads you

899
00:29:37,120 --> 00:29:40,000
want to make sure that they only run in

900
00:29:38,559 --> 00:29:42,480
the target environment it's called

901
00:29:40,000 --> 00:29:44,559
keyed payloads or execution guard rails

902
00:29:42,480 --> 00:29:46,159
if you uh speak miter attack

903
00:29:44,559 --> 00:29:48,399
um then you want to make sure that the

904
00:29:46,159 --> 00:29:50,880
web properties aren't attributable

905
00:29:48,399 --> 00:29:52,320
to another threat actor maybe you're

906
00:29:50,880 --> 00:29:53,200
attributed to a threat actor you're

907
00:29:52,320 --> 00:29:55,360
emulating

908
00:29:53,200 --> 00:29:56,240
but you can actually look through all

909
00:29:55,360 --> 00:29:58,559
that

910
00:29:56,240 --> 00:29:59,279
and then store all your information

911
00:29:58,559 --> 00:30:02,158
wherever you

912
00:29:59,279 --> 00:30:03,600
host all your logs encrypt that right

913
00:30:02,159 --> 00:30:06,000
vet your payloads

914
00:30:03,600 --> 00:30:08,240
get iocs for all your payloads and

915
00:30:06,000 --> 00:30:09,840
everything you're going to do really

916
00:30:08,240 --> 00:30:12,000
makes the confliction better

917
00:30:09,840 --> 00:30:12,879
and then lastly you want to detect if

918
00:30:12,000 --> 00:30:16,080
the blue team

919
00:30:12,880 --> 00:30:17,840
is investigating you or not um

920
00:30:16,080 --> 00:30:19,918
any other comments here because i know

921
00:30:17,840 --> 00:30:22,240
you have some opsec stuff to talk about

922
00:30:19,919 --> 00:30:23,039
during acquiring infrastructure right

923
00:30:22,240 --> 00:30:25,200
well the the

924
00:30:23,039 --> 00:30:27,520
biggest thing to keep in mind here is

925
00:30:25,200 --> 00:30:30,159
that the same techniques you use

926
00:30:27,520 --> 00:30:31,279
to find bad guys bad guys can use to

927
00:30:30,159 --> 00:30:33,520
find you

928
00:30:31,279 --> 00:30:34,640
so if you're uh if you're actually

929
00:30:33,520 --> 00:30:36,080
dealing with an attacker that's

930
00:30:34,640 --> 00:30:40,080
sophisticated enough

931
00:30:36,080 --> 00:30:42,158
to have uh filtering or like gating

932
00:30:40,080 --> 00:30:43,760
set up where only you know certain uh

933
00:30:42,159 --> 00:30:47,120
people in a certain geological

934
00:30:43,760 --> 00:30:48,720
uh geolocation will uh will get payloads

935
00:30:47,120 --> 00:30:50,639
or you know even from a different

936
00:30:48,720 --> 00:30:51,520
company or they have a manual promotion

937
00:30:50,640 --> 00:30:53,120
process

938
00:30:51,520 --> 00:30:54,960
from like a first stage to a second

939
00:30:53,120 --> 00:30:56,399
stage right if they're

940
00:30:54,960 --> 00:30:58,159
if they're that sophisticated they're

941
00:30:56,399 --> 00:31:00,080
also sophisticated enough to know

942
00:30:58,159 --> 00:31:01,679
well in some ways like to have the same

943
00:31:00,080 --> 00:31:03,519
kind of tripwire set up

944
00:31:01,679 --> 00:31:05,279
uh to know when someone's hunting them

945
00:31:03,519 --> 00:31:06,799
so when you are hunting them in an

946
00:31:05,279 --> 00:31:09,039
external capacity

947
00:31:06,799 --> 00:31:11,600
always keep in mind as you sneak onto

948
00:31:09,039 --> 00:31:13,840
them they can sneak onto you

949
00:31:11,600 --> 00:31:15,678
that was actually a quote from hackers

950
00:31:13,840 --> 00:31:17,360
in 1995

951
00:31:15,679 --> 00:31:19,760
this is kind of a joke for people that

952
00:31:17,360 --> 00:31:22,399
don't think that movie has any relevancy

953
00:31:19,760 --> 00:31:23,919
but seriously he can find you exactly

954
00:31:22,399 --> 00:31:24,239
and i'm just looking at the time we've

955
00:31:23,919 --> 00:31:25,760
got

956
00:31:24,240 --> 00:31:27,919
about eight minutes to go through five

957
00:31:25,760 --> 00:31:31,519
slides so i'm gonna speed this up

958
00:31:27,919 --> 00:31:33,039
red elk red elk is a tool created by the

959
00:31:31,519 --> 00:31:35,840
folks at outflank and

960
00:31:33,039 --> 00:31:37,760
shout out to mark um from outflank

961
00:31:35,840 --> 00:31:39,600
because when we posted that we were

962
00:31:37,760 --> 00:31:42,640
doing this talk

963
00:31:39,600 --> 00:31:43,439
he actually wrote that they're planning

964
00:31:42,640 --> 00:31:46,799
to add

965
00:31:43,440 --> 00:31:48,720
in version 2 hunting capabilities for

966
00:31:46,799 --> 00:31:50,080
red elk so you don't know what red elk

967
00:31:48,720 --> 00:31:52,399
is red oak is

968
00:31:50,080 --> 00:31:53,439
an elk stack that was originally made

969
00:31:52,399 --> 00:31:56,000
for the red team

970
00:31:53,440 --> 00:31:57,919
and it was to aggregate all the logs so

971
00:31:56,000 --> 00:32:00,799
again i'm running a red team engagement

972
00:31:57,919 --> 00:32:02,480
i have four or five operators i want to

973
00:32:00,799 --> 00:32:03,840
know what they're all doing so i want

974
00:32:02,480 --> 00:32:06,320
the c2 server

975
00:32:03,840 --> 00:32:08,399
communicating to me i want the

976
00:32:06,320 --> 00:32:09,039
redirectors communicating to me i want

977
00:32:08,399 --> 00:32:10,879
to see

978
00:32:09,039 --> 00:32:12,080
and maybe even give access to a white

979
00:32:10,880 --> 00:32:14,480
sub so

980
00:32:12,080 --> 00:32:15,678
originally i started kind of like a red

981
00:32:14,480 --> 00:32:17,840
team sim

982
00:32:15,679 --> 00:32:18,880
and now and this is the first time any

983
00:32:17,840 --> 00:32:21,439
of you see this

984
00:32:18,880 --> 00:32:22,640
version two and thanks again to mark for

985
00:32:21,440 --> 00:32:24,880
providing these bullets

986
00:32:22,640 --> 00:32:26,720
will have a lot of really cool features

987
00:32:24,880 --> 00:32:28,399
so another example of

988
00:32:26,720 --> 00:32:29,919
posting something on twitter someone

989
00:32:28,399 --> 00:32:31,518
else seeing it being like oh we had

990
00:32:29,919 --> 00:32:32,960
similar ideas

991
00:32:31,519 --> 00:32:34,559
this is what we have planned and now

992
00:32:32,960 --> 00:32:35,200
we're going to meet in in a couple of

993
00:32:34,559 --> 00:32:38,480
weeks and

994
00:32:35,200 --> 00:32:41,200
and get this going uh even further so

995
00:32:38,480 --> 00:32:41,679
pretty cool stuff real quick before we

996
00:32:41,200 --> 00:32:43,600
go on

997
00:32:41,679 --> 00:32:44,799
this whole idea actually came from red

998
00:32:43,600 --> 00:32:46,719
out as

999
00:32:44,799 --> 00:32:48,559
uh it started maybe a year ago when i

1000
00:32:46,720 --> 00:32:50,240
was doing a lot of stuff on hack the box

1001
00:32:48,559 --> 00:32:52,799
and i wanted to record everything i was

1002
00:32:50,240 --> 00:32:55,600
doing uh to be able to refine

1003
00:32:52,799 --> 00:32:57,440
my hack to box skills and red elk was

1004
00:32:55,600 --> 00:32:59,678
what i was using to capture it all

1005
00:32:57,440 --> 00:33:01,039
uh so it was really just it's been there

1006
00:32:59,679 --> 00:33:03,279
from the start of this idea

1007
00:33:01,039 --> 00:33:04,799
i just want to throw that out there yeah

1008
00:33:03,279 --> 00:33:05,679
i know and it's an awesome awesome

1009
00:33:04,799 --> 00:33:08,559
project so

1010
00:33:05,679 --> 00:33:09,120
um to visualize this right this is kind

1011
00:33:08,559 --> 00:33:11,519
of like

1012
00:33:09,120 --> 00:33:12,399
what red team infrastructure looks like

1013
00:33:11,519 --> 00:33:14,960
and

1014
00:33:12,399 --> 00:33:16,559
what your external threat hunting uh

1015
00:33:14,960 --> 00:33:18,240
infrastructure probably looks like too

1016
00:33:16,559 --> 00:33:18,799
right on the top right you have your c2

1017
00:33:18,240 --> 00:33:20,159
servers

1018
00:33:18,799 --> 00:33:22,399
we'll talk about command and control on

1019
00:33:20,159 --> 00:33:23,840
the next slide then you have redirectors

1020
00:33:22,399 --> 00:33:25,678
over on the left side

1021
00:33:23,840 --> 00:33:27,199
this is to make sure that someone's

1022
00:33:25,679 --> 00:33:29,120
coming to your uh

1023
00:33:27,200 --> 00:33:30,399
red team site and they're coming from

1024
00:33:29,120 --> 00:33:32,399
the targo organization

1025
00:33:30,399 --> 00:33:34,959
then send it over to your c2s and if

1026
00:33:32,399 --> 00:33:37,199
it's not maybe for them somewhere else

1027
00:33:34,960 --> 00:33:38,080
and all of this is going into red elk

1028
00:33:37,200 --> 00:33:39,760
red elk is

1029
00:33:38,080 --> 00:33:42,158
red and in the middle right it's an elk

1030
00:33:39,760 --> 00:33:44,640
stack that you send a bunch of data

1031
00:33:42,159 --> 00:33:46,880
and what's important here is the logging

1032
00:33:44,640 --> 00:33:47,440
right the logging from those c2 servers

1033
00:33:46,880 --> 00:33:49,760
the

1034
00:33:47,440 --> 00:33:51,760
logging from those redirectors are all

1035
00:33:49,760 --> 00:33:54,000
normalized and put into

1036
00:33:51,760 --> 00:33:54,879
data that we can now view and who can

1037
00:33:54,000 --> 00:33:56,960
view this well

1038
00:33:54,880 --> 00:33:57,919
the red team manager can view this which

1039
00:33:56,960 --> 00:34:00,080
is great

1040
00:33:57,919 --> 00:34:02,080
really how we're using it now but you

1041
00:34:00,080 --> 00:34:04,240
can also give access to a white cell

1042
00:34:02,080 --> 00:34:06,000
if they want to see what's going on

1043
00:34:04,240 --> 00:34:07,360
without actually having access to your

1044
00:34:06,000 --> 00:34:10,719
c2 servers

1045
00:34:07,360 --> 00:34:12,719
and then you can query other security

1046
00:34:10,719 --> 00:34:15,199
service providers external ones

1047
00:34:12,719 --> 00:34:17,040
to see if any of your iocs that you have

1048
00:34:15,199 --> 00:34:20,399
triggered in the red team engagement

1049
00:34:17,040 --> 00:34:20,960
are being shown on any of these services

1050
00:34:20,399 --> 00:34:24,319
so it's

1051
00:34:20,960 --> 00:34:26,560
it's a really cool cool tool

1052
00:34:24,320 --> 00:34:28,879
and like we said where that version too

1053
00:34:26,560 --> 00:34:30,719
will will have some hunting capabilities

1054
00:34:28,879 --> 00:34:32,879
although dave has been using this for

1055
00:34:30,719 --> 00:34:35,439
about a year

1056
00:34:32,879 --> 00:34:36,799
so the next one is command and control

1057
00:34:35,440 --> 00:34:37,599
and i could probably talk about this for

1058
00:34:36,800 --> 00:34:39,839
a long time

1059
00:34:37,599 --> 00:34:40,879
but at high level it's the influence an

1060
00:34:39,839 --> 00:34:42,719
attacker has

1061
00:34:40,879 --> 00:34:44,799
over a system that they have control

1062
00:34:42,719 --> 00:34:45,439
over you generally have a communication

1063
00:34:44,800 --> 00:34:48,560
channel

1064
00:34:45,440 --> 00:34:51,280
which means http most of the time

1065
00:34:48,560 --> 00:34:52,639
or other communication channels on such

1066
00:34:51,280 --> 00:34:54,320
as dns

1067
00:34:52,639 --> 00:34:55,679
and when we take over a system when we

1068
00:34:54,320 --> 00:34:58,240
compromise a system

1069
00:34:55,679 --> 00:34:59,200
we want to blend it and we do that with

1070
00:34:58,240 --> 00:35:01,598
heartbeats or

1071
00:34:59,200 --> 00:35:02,480
beacons or callbacks however you want to

1072
00:35:01,599 --> 00:35:04,640
call it

1073
00:35:02,480 --> 00:35:06,560
and what that does is that every so

1074
00:35:04,640 --> 00:35:09,680
often that system you have com

1075
00:35:06,560 --> 00:35:12,799
uh compromise will call out to

1076
00:35:09,680 --> 00:35:14,879
our c2 server and you don't want to look

1077
00:35:12,800 --> 00:35:16,480
like a pattern do you because you know

1078
00:35:14,880 --> 00:35:17,599
something calling out every 30 seconds

1079
00:35:16,480 --> 00:35:20,000
is going to stick out

1080
00:35:17,599 --> 00:35:21,680
so you can add jitter which is a

1081
00:35:20,000 --> 00:35:23,520
percentage of that pattern

1082
00:35:21,680 --> 00:35:25,440
so those are kind of like the main

1083
00:35:23,520 --> 00:35:28,079
capabilities but the

1084
00:35:25,440 --> 00:35:28,720
real cool thing about using a c2 is that

1085
00:35:28,079 --> 00:35:31,760
you have

1086
00:35:28,720 --> 00:35:34,160
agents or implants that you can deploy

1087
00:35:31,760 --> 00:35:35,920
on different operating systems and you

1088
00:35:34,160 --> 00:35:37,680
get the same consistent

1089
00:35:35,920 --> 00:35:39,760
shell so if you're going out and

1090
00:35:37,680 --> 00:35:42,160
acquiring infrastructure

1091
00:35:39,760 --> 00:35:43,760
in other locations you only have to

1092
00:35:42,160 --> 00:35:46,399
learn one shell if you're

1093
00:35:43,760 --> 00:35:47,280
getting other operating systems you only

1094
00:35:46,400 --> 00:35:50,320
need this one

1095
00:35:47,280 --> 00:35:51,599
shell and if the c2 is logging

1096
00:35:50,320 --> 00:35:54,640
everything you're doing

1097
00:35:51,599 --> 00:35:57,440
and you can send that data to

1098
00:35:54,640 --> 00:35:58,000
somewhere else then that is where you

1099
00:35:57,440 --> 00:36:00,560
have

1100
00:35:58,000 --> 00:36:02,560
um those benefits now uh on the right

1101
00:36:00,560 --> 00:36:04,759
you see the c2 matrix

1102
00:36:02,560 --> 00:36:06,520
uh two seconds on that uh the

1103
00:36:04,760 --> 00:36:10,160
c2matrix.com there's

1104
00:36:06,520 --> 00:36:13,280
55. i just added another one yesterday

1105
00:36:10,160 --> 00:36:15,520
55 c2s that you can choose

1106
00:36:13,280 --> 00:36:16,880
and and look into it has a number of

1107
00:36:15,520 --> 00:36:19,040
different capabilities

1108
00:36:16,880 --> 00:36:20,880
as well as which ones do the logging

1109
00:36:19,040 --> 00:36:22,079
it's uh not on the screenshot but if you

1110
00:36:20,880 --> 00:36:24,960
scroll over to the right

1111
00:36:22,079 --> 00:36:26,000
you will see that as well so um any

1112
00:36:24,960 --> 00:36:29,760
comments on this before

1113
00:36:26,000 --> 00:36:31,599
we get to acquiring infra yes sir

1114
00:36:29,760 --> 00:36:34,079
all right and we've got three minutes to

1115
00:36:31,599 --> 00:36:37,200
do two slides so godspeed sir

1116
00:36:34,079 --> 00:36:39,359
all right uh just to be clear uh

1117
00:36:37,200 --> 00:36:40,240
this topic alone i could i could teach a

1118
00:36:39,359 --> 00:36:43,598
week class on

1119
00:36:40,240 --> 00:36:44,879
a week of works of class on uh

1120
00:36:43,599 --> 00:36:46,880
and to keep in mind we're not saying do

1121
00:36:44,880 --> 00:36:48,160
anything legal don't don't use an iot

1122
00:36:46,880 --> 00:36:49,119
botnet or something like that to hunt an

1123
00:36:48,160 --> 00:36:50,960
attacker

1124
00:36:49,119 --> 00:36:52,160
it's not a good look if your external

1125
00:36:50,960 --> 00:36:54,800
freight hunting team

1126
00:36:52,160 --> 00:36:56,078
uh is then uh the the center of an

1127
00:36:54,800 --> 00:36:59,280
investigation

1128
00:36:56,079 --> 00:37:01,599
uh for for illegal hacking um so

1129
00:36:59,280 --> 00:37:03,359
don't do that uh but you can't purchase

1130
00:37:01,599 --> 00:37:06,480
as george mentioned before

1131
00:37:03,359 --> 00:37:07,839
uh purchasing is one of the ways that we

1132
00:37:06,480 --> 00:37:09,680
do it now

1133
00:37:07,839 --> 00:37:11,359
the only thing is that we're very very

1134
00:37:09,680 --> 00:37:12,879
clean about how we purchase

1135
00:37:11,359 --> 00:37:14,560
uh and information we leave behind

1136
00:37:12,880 --> 00:37:16,160
because our goal here is to actually

1137
00:37:14,560 --> 00:37:17,440
interact with bad guys who may be able

1138
00:37:16,160 --> 00:37:19,759
to do research and

1139
00:37:17,440 --> 00:37:20,720
figure out who we are uh the most

1140
00:37:19,760 --> 00:37:22,880
interesting idea here

1141
00:37:20,720 --> 00:37:24,879
is what i call resource sharing so with

1142
00:37:22,880 --> 00:37:26,560
threat intelligence partnerships i have

1143
00:37:24,880 --> 00:37:27,920
if somebody comes and says hey we're

1144
00:37:26,560 --> 00:37:30,480
we're getting like we're getting

1145
00:37:27,920 --> 00:37:32,000
uh targeted by this attacker we don't

1146
00:37:30,480 --> 00:37:34,240
have the threat hunting capabilities

1147
00:37:32,000 --> 00:37:35,440
i can say literally spin up a docker in

1148
00:37:34,240 --> 00:37:36,879
your dmz

1149
00:37:35,440 --> 00:37:38,240
and my team will be able to pivot

1150
00:37:36,880 --> 00:37:39,200
through that into the attacker they'll

1151
00:37:38,240 --> 00:37:40,000
look like they're coming from your

1152
00:37:39,200 --> 00:37:42,480
infrastructure

1153
00:37:40,000 --> 00:37:44,400
which gives them the ability to do uh to

1154
00:37:42,480 --> 00:37:45,119
get things that may be blocked uh

1155
00:37:44,400 --> 00:37:47,119
payloads

1156
00:37:45,119 --> 00:37:48,240
that are only being like extremely

1157
00:37:47,119 --> 00:37:50,240
targeted

1158
00:37:48,240 --> 00:37:51,359
and that really is one of the the

1159
00:37:50,240 --> 00:37:54,399
benefits of this

1160
00:37:51,359 --> 00:37:56,319
right so if you can't do uh uh

1161
00:37:54,400 --> 00:37:58,079
if an organization uh doesn't want to do

1162
00:37:56,320 --> 00:38:00,320
a docker or some other way

1163
00:37:58,079 --> 00:38:02,240
to let you pivot uh and look like them

1164
00:38:00,320 --> 00:38:05,359
even putting a dns record

1165
00:38:02,240 --> 00:38:07,919
at your uh hunting host is useful

1166
00:38:05,359 --> 00:38:09,598
as you can imagine an actor grinding

1167
00:38:07,920 --> 00:38:12,800
through a dns list

1168
00:38:09,599 --> 00:38:13,680
or new additions to a dns list of a

1169
00:38:12,800 --> 00:38:15,520
target company

1170
00:38:13,680 --> 00:38:17,118
it's only this new one pops up you know

1171
00:38:15,520 --> 00:38:19,040
although it's only a c name

1172
00:38:17,119 --> 00:38:20,720
you know it's got this ip address they

1173
00:38:19,040 --> 00:38:22,880
may go to it and find port 25

1174
00:38:20,720 --> 00:38:24,640
and send email to it and they're

1175
00:38:22,880 --> 00:38:27,839
actually interacting with

1176
00:38:24,640 --> 00:38:27,839
with our hunting infrastructure

1177
00:38:28,160 --> 00:38:31,598
so let's hit the next slide because

1178
00:38:29,920 --> 00:38:32,800
refinement is really what we need to

1179
00:38:31,599 --> 00:38:35,280
talk about

1180
00:38:32,800 --> 00:38:37,359
uh all this stuff is fun but if we're

1181
00:38:35,280 --> 00:38:39,680
not putting a rigorous process in place

1182
00:38:37,359 --> 00:38:41,520
and we're not able to uh dispassionately

1183
00:38:39,680 --> 00:38:43,040
evaluate our own performance we're not

1184
00:38:41,520 --> 00:38:45,520
doing anything that well

1185
00:38:43,040 --> 00:38:47,119
so uh we're gonna do dope data on

1186
00:38:45,520 --> 00:38:48,400
previous engagement if you know anything

1187
00:38:47,119 --> 00:38:50,000
about precision shooting

1188
00:38:48,400 --> 00:38:52,640
you know what a dope book is and it's

1189
00:38:50,000 --> 00:38:53,760
basically how you can uh record all your

1190
00:38:52,640 --> 00:38:56,560
information about

1191
00:38:53,760 --> 00:38:58,400
uh about your activity so you can then

1192
00:38:56,560 --> 00:39:01,359
later go back and evaluate it

1193
00:38:58,400 --> 00:39:02,800
and and use that to uh understand your

1194
00:39:01,359 --> 00:39:04,960
future performance right

1195
00:39:02,800 --> 00:39:06,240
so these are the questions that i ask

1196
00:39:04,960 --> 00:39:07,839
myself and you should ask

1197
00:39:06,240 --> 00:39:10,000
if if this type of behavior is helping

1198
00:39:07,839 --> 00:39:11,359
you right can you clearly define what

1199
00:39:10,000 --> 00:39:14,480
you hunt it

1200
00:39:11,359 --> 00:39:15,200
uh did you catch like a wide net and

1201
00:39:14,480 --> 00:39:17,680
tried to uh

1202
00:39:15,200 --> 00:39:19,040
hunt every bad guy ever or were you able

1203
00:39:17,680 --> 00:39:21,520
to come up with a

1204
00:39:19,040 --> 00:39:23,200
list that actually uh has attackers that

1205
00:39:21,520 --> 00:39:26,240
will target your organization

1206
00:39:23,200 --> 00:39:28,799
um were you able to find uh

1207
00:39:26,240 --> 00:39:29,919
actors that were acting behaving

1208
00:39:28,800 --> 00:39:32,880
similarly

1209
00:39:29,920 --> 00:39:33,599
uh but have different techniques that's

1210
00:39:32,880 --> 00:39:35,760
a win too

1211
00:39:33,599 --> 00:39:36,640
that that that is something that what

1212
00:39:35,760 --> 00:39:39,280
could inform

1213
00:39:36,640 --> 00:39:40,400
your internal security team uh as to

1214
00:39:39,280 --> 00:39:42,800
additional actors

1215
00:39:40,400 --> 00:39:44,640
that could be targeting you right have

1216
00:39:42,800 --> 00:39:46,320
we collected enough data on their

1217
00:39:44,640 --> 00:39:47,200
activity their activity being the actor

1218
00:39:46,320 --> 00:39:49,040
activity

1219
00:39:47,200 --> 00:39:50,799
to map a trajectory of their activity

1220
00:39:49,040 --> 00:39:53,040
this is once again

1221
00:39:50,800 --> 00:39:54,400
can we tell the the internal security

1222
00:39:53,040 --> 00:39:56,160
teams anything useful

1223
00:39:54,400 --> 00:39:58,560
about the actual activities we've been

1224
00:39:56,160 --> 00:40:01,920
tracking so they can

1225
00:39:58,560 --> 00:40:03,680
uh map out the trajectory very well

1226
00:40:01,920 --> 00:40:05,280
this is important as well did you

1227
00:40:03,680 --> 00:40:07,520
collect enough activity on your

1228
00:40:05,280 --> 00:40:08,319
on your own hunt to tell what kind of

1229
00:40:07,520 --> 00:40:10,400
fingerprints

1230
00:40:08,319 --> 00:40:12,319
you left behind on the actor

1231
00:40:10,400 --> 00:40:14,480
infrastructure so once again

1232
00:40:12,319 --> 00:40:16,079
if an actor is not interested in you a

1233
00:40:14,480 --> 00:40:17,200
good outcome of external threat hunting

1234
00:40:16,079 --> 00:40:18,640
like this is not

1235
00:40:17,200 --> 00:40:22,480
to get an actor interested in your

1236
00:40:18,640 --> 00:40:23,920
organization that previously wasn't

1237
00:40:22,480 --> 00:40:25,599
in the last one the most important

1238
00:40:23,920 --> 00:40:28,720
question here did you

1239
00:40:25,599 --> 00:40:30,240
did what you do provide uh provide any

1240
00:40:28,720 --> 00:40:33,359
definable actions

1241
00:40:30,240 --> 00:40:34,240
for your blue purple red team because

1242
00:40:33,359 --> 00:40:36,160
once again

1243
00:40:34,240 --> 00:40:39,598
in this day and age right now with the

1244
00:40:36,160 --> 00:40:42,960
the security problems we're having

1245
00:40:39,599 --> 00:40:44,319
issues with training just

1246
00:40:42,960 --> 00:40:46,800
all the information security issues

1247
00:40:44,319 --> 00:40:48,800
combined right now you should

1248
00:40:46,800 --> 00:40:51,440
be taking an opportunity to do anything

1249
00:40:48,800 --> 00:40:53,839
to enhance your security posture

1250
00:40:51,440 --> 00:40:55,599
rather than doing nothing thank you very

1251
00:40:53,839 --> 00:40:58,640
much for listening

1252
00:40:55,599 --> 00:41:01,680
and thank you uh this was awesome

1253
00:40:58,640 --> 00:41:02,799
um these are the reference slides that

1254
00:41:01,680 --> 00:41:05,040
we mentioned

1255
00:41:02,800 --> 00:41:06,560
and we are one minute over so i

1256
00:41:05,040 --> 00:41:09,279
apologize to everyone

1257
00:41:06,560 --> 00:41:09,599
i do want to just give a quick shout out

1258
00:41:09,280 --> 00:41:12,880
to

1259
00:41:09,599 --> 00:41:14,000
kat who helped us dry run this and

1260
00:41:12,880 --> 00:41:16,880
really make these

1261
00:41:14,000 --> 00:41:18,880
uh slides what they are um so really

1262
00:41:16,880 --> 00:41:20,000
thank you so much and thank you dave for

1263
00:41:18,880 --> 00:41:23,440
your time and thank you

1264
00:41:20,000 --> 00:41:25,599
all for for being here um really really

1265
00:41:23,440 --> 00:41:27,680
really appreciate it and and we're on

1266
00:41:25,599 --> 00:41:35,200
the slack channel if you have questions

1267
00:41:27,680 --> 00:41:35,200
we'll take them there

