1
00:00:14,420 --> 00:00:19,410
all right everybody first off I'd like

2
00:00:16,890 --> 00:00:21,600
to thank sands and Rob Lee for putting

3
00:00:19,410 --> 00:00:23,670
together this great summit it's really

4
00:00:21,600 --> 00:00:25,109
amazing and it gives us a nice outlet to

5
00:00:23,670 --> 00:00:27,390
talk about threat hunting which is our

6
00:00:25,109 --> 00:00:29,939
favorite favorite way of finding the

7
00:00:27,390 --> 00:00:32,360
enemy in our talk today we're talking

8
00:00:29,939 --> 00:00:37,920
about casting a big net hunting at scale

9
00:00:32,360 --> 00:00:40,050
and we believe that in terms of taking

10
00:00:37,920 --> 00:00:42,210
your introducing detection and response

11
00:00:40,050 --> 00:00:43,620
capabilities to the next level you

12
00:00:42,210 --> 00:00:45,390
really have to be able to do this you

13
00:00:43,620 --> 00:00:47,190
have to have the capability to reach out

14
00:00:45,390 --> 00:00:50,309
collect from all of your hosts and

15
00:00:47,190 --> 00:00:52,289
analyze that data very quickly and by

16
00:00:50,309 --> 00:00:54,750
that we mean you know within eight hours

17
00:00:52,289 --> 00:00:56,610
so a lot of people are able to collect

18
00:00:54,750 --> 00:00:58,199
that data and pull back RAM and pull

19
00:00:56,610 --> 00:01:01,199
back registry and all those forensics

20
00:00:58,199 --> 00:01:02,519
artifacts but it becomes very difficult

21
00:01:01,199 --> 00:01:04,739
to analyze that and then you have to

22
00:01:02,520 --> 00:01:06,060
store all those things so that's what

23
00:01:04,739 --> 00:01:09,390
we're gonna touch on with our talk today

24
00:01:06,060 --> 00:01:12,210
a little bit about myself

25
00:01:09,390 --> 00:01:14,280
I'm Paul haar Meo you can catch me

26
00:01:12,210 --> 00:01:16,020
ranting on Twitter and giving my

27
00:01:14,280 --> 00:01:18,810
obnoxious opinions quite frequently as

28
00:01:16,020 --> 00:01:21,539
dfi are janitor I'm a principal

29
00:01:18,810 --> 00:01:24,689
consultant with CrowdStrike and I've

30
00:01:21,540 --> 00:01:27,630
spent about 15 years defending targeted

31
00:01:24,689 --> 00:01:29,520
industries targeted companies I'm also a

32
00:01:27,630 --> 00:01:31,229
father of two small children so I'm not

33
00:01:29,520 --> 00:01:33,539
ashamed to admit that I'd like to sleep

34
00:01:31,229 --> 00:01:36,990
it's kind of my favorite thing these

35
00:01:33,540 --> 00:01:38,780
days I'm also a big sports ball fan for

36
00:01:36,990 --> 00:01:41,789
those of you that hate sports

37
00:01:38,780 --> 00:01:43,079
everybody in Reebok Rijn some was Cephas

38
00:01:41,790 --> 00:01:45,540
Alton - CrowdStrike been there for about

39
00:01:43,079 --> 00:01:47,130
a year and a half so previously I was

40
00:01:45,540 --> 00:01:48,479
with Ernst and Young which we're gonna

41
00:01:47,130 --> 00:01:50,119
hear some of our great guys from that

42
00:01:48,479 --> 00:01:52,470
organization talk about this afternoon

43
00:01:50,119 --> 00:01:54,030
also I confessed the opportunity to tell

44
00:01:52,470 --> 00:01:57,929
300 people at the same time that I

45
00:01:54,030 --> 00:02:03,990
CrossFit and also my free time I dabble

46
00:01:57,930 --> 00:02:05,189
with some PC gaming okay so what you'll

47
00:02:03,990 --> 00:02:06,750
see it with our presentation there's a

48
00:02:05,189 --> 00:02:08,699
little bit of overlap and that's great

49
00:02:06,750 --> 00:02:11,370
to see because a lot of us have similar

50
00:02:08,699 --> 00:02:12,720
beliefs on what Brett Tontine is so

51
00:02:11,370 --> 00:02:13,680
we're gonna go over the essentials and

52
00:02:12,720 --> 00:02:15,900
what our approach is

53
00:02:13,680 --> 00:02:17,670
and then for the practitioners in the

54
00:02:15,900 --> 00:02:19,439
room we're definitely gonna go over how

55
00:02:17,670 --> 00:02:21,000
how to do this and walk you through an

56
00:02:19,439 --> 00:02:25,379
example hunt so I think you guys are

57
00:02:21,000 --> 00:02:29,040
gonna enjoy that so to kick things off

58
00:02:25,379 --> 00:02:31,409
the obligatory what hunting is not so

59
00:02:29,040 --> 00:02:34,679
hunting is not new and I love that BAM

60
00:02:31,409 --> 00:02:36,870
talked about this I also believe like

61
00:02:34,680 --> 00:02:38,760
BAM that hunting is existed for quite a

62
00:02:36,870 --> 00:02:40,859
while at least since the 90s but

63
00:02:38,760 --> 00:02:42,780
probably further back than that ever

64
00:02:40,859 --> 00:02:44,790
since there's been a rich data set so

65
00:02:42,780 --> 00:02:48,030
maybe that data set was your NSM sensor

66
00:02:44,790 --> 00:02:50,790
full pcap net flow or really verbose

67
00:02:48,030 --> 00:02:52,530
logging that kind of gave you the data

68
00:02:50,790 --> 00:02:57,150
set to go ahead and hunt beyond just an

69
00:02:52,530 --> 00:02:59,700
alert and of course it's not alert

70
00:02:57,150 --> 00:03:02,430
driven so that's where the intrusion

71
00:02:59,700 --> 00:03:04,319
detection and now analysts in the late

72
00:03:02,430 --> 00:03:06,659
90s failed because he was just clearing

73
00:03:04,319 --> 00:03:08,790
alerts and not really digging into it

74
00:03:06,659 --> 00:03:10,560
and and I kind of view threat hunting as

75
00:03:08,790 --> 00:03:13,019
you're just doing your job that's what

76
00:03:10,560 --> 00:03:15,420
you should be doing eyes on glass and

77
00:03:13,019 --> 00:03:17,400
just clearing alerts serves a function

78
00:03:15,420 --> 00:03:20,510
but you're not going to find anything

79
00:03:17,400 --> 00:03:23,750
new that way typically and of course

80
00:03:20,510 --> 00:03:27,000
threat hunting is not a tool or product

81
00:03:23,750 --> 00:03:30,859
obviously sales thinks that it's a

82
00:03:27,000 --> 00:03:34,829
product that they can push onto you and

83
00:03:30,859 --> 00:03:37,530
it's really what hunting is is it's a

84
00:03:34,829 --> 00:03:40,049
person applying a process using their

85
00:03:37,530 --> 00:03:41,760
brain the tool is really secondary

86
00:03:40,049 --> 00:03:44,849
that's just helping you handle the large

87
00:03:41,760 --> 00:03:47,220
data sets in regards to the

88
00:03:44,849 --> 00:03:49,589
standardization obviously from all the

89
00:03:47,220 --> 00:03:51,930
talks here there's no standard in terms

90
00:03:49,590 --> 00:03:54,180
of what hunting is but I happen to think

91
00:03:51,930 --> 00:03:56,489
that that's a good thing if we all

92
00:03:54,180 --> 00:03:58,190
standardize the way that we hunted what

93
00:03:56,489 --> 00:04:00,510
does that do in terms of the adversary

94
00:03:58,190 --> 00:04:02,310
it makes it so much easier for him to

95
00:04:00,510 --> 00:04:05,340
avoid you if everybody's doing things

96
00:04:02,310 --> 00:04:07,500
the same way it's also not a several

97
00:04:05,340 --> 00:04:10,139
silver bullet so and everybody should be

98
00:04:07,500 --> 00:04:12,870
on the same page here when talking with

99
00:04:10,139 --> 00:04:14,549
your c-level senior executives that none

100
00:04:12,870 --> 00:04:17,608
of these new things like threat Intel

101
00:04:14,549 --> 00:04:19,889
and threat hunting and the new buzzwords

102
00:04:17,608 --> 00:04:22,409
they're not silver bullets and you

103
00:04:19,889 --> 00:04:24,420
definitely don't want to sacrifice other

104
00:04:22,409 --> 00:04:26,610
parts of your security program

105
00:04:24,420 --> 00:04:30,500
to pursue a new shiny object you still

106
00:04:26,610 --> 00:04:33,270
need to do old school patches and

107
00:04:30,500 --> 00:04:34,500
logging and build a defensible Network

108
00:04:33,270 --> 00:04:36,599
you still have to do that it's very

109
00:04:34,500 --> 00:04:41,250
critical so this is something on top of

110
00:04:36,600 --> 00:04:45,090
what you're already doing so what is

111
00:04:41,250 --> 00:04:47,730
hunting so I can tell you that CISOs and

112
00:04:45,090 --> 00:04:50,219
this kind of goes along with what been

113
00:04:47,730 --> 00:04:52,230
put up your earlier CISOs might think

114
00:04:50,220 --> 00:04:54,720
that hunting is this over militaristic

115
00:04:52,230 --> 00:04:59,160
fantasy where you're a digital were

116
00:04:54,720 --> 00:05:01,170
warrior with matrix camouflage so we all

117
00:04:59,160 --> 00:05:03,540
know that's not what it is but what it

118
00:05:01,170 --> 00:05:08,760
is is answering that ultimate dfi our

119
00:05:03,540 --> 00:05:11,970
question so am i compromised today it

120
00:05:08,760 --> 00:05:15,030
has to be proactive and then in terms of

121
00:05:11,970 --> 00:05:18,240
how it fits into models I thought Rob

122
00:05:15,030 --> 00:05:21,119
Rob Emily or Rob 2.0 as we'd like to

123
00:05:18,240 --> 00:05:22,380
call him did a great presentation with

124
00:05:21,120 --> 00:05:24,810
sands that you guys should check out

125
00:05:22,380 --> 00:05:26,730
it's in their archive about his active

126
00:05:24,810 --> 00:05:28,500
defense life cycle and we're hunting

127
00:05:26,730 --> 00:05:31,530
fits in there with how you're building

128
00:05:28,500 --> 00:05:34,100
your security program and of course we

129
00:05:31,530 --> 00:05:36,809
have the obligatory assumption of breach

130
00:05:34,100 --> 00:05:38,190
everybody should be doing this I don't

131
00:05:36,810 --> 00:05:39,690
think anybody in here is gonna say a

132
00:05:38,190 --> 00:05:43,010
hundred percent my network has not

133
00:05:39,690 --> 00:05:45,480
breached today and bet their job on it

134
00:05:43,010 --> 00:05:47,880
and then finally one concept that I

135
00:05:45,480 --> 00:05:49,770
really really like and I'm not sure if

136
00:05:47,880 --> 00:05:52,440
he originated this but I picked up this

137
00:05:49,770 --> 00:05:54,690
term from Hank Crumpton sort of

138
00:05:52,440 --> 00:05:56,219
intelligence I highly recommend that

139
00:05:54,690 --> 00:05:59,490
book it's it's a great thing it's not

140
00:05:56,220 --> 00:06:02,190
cyber per se but it has a lot of good

141
00:05:59,490 --> 00:06:04,050
things in there and he used this term

142
00:06:02,190 --> 00:06:08,969
exploring your ignorant as a way to

143
00:06:04,050 --> 00:06:11,250
describe how to recruit a successful

144
00:06:08,970 --> 00:06:13,020
intelligence officer so the ones that

145
00:06:11,250 --> 00:06:14,640
were successful were the ones that knew

146
00:06:13,020 --> 00:06:16,280
that they didn't know things and spent

147
00:06:14,640 --> 00:06:18,500
time trying to explore their ignorance

148
00:06:16,280 --> 00:06:20,880
so what does that mean for hunting

149
00:06:18,500 --> 00:06:22,920
really high-level will get more into the

150
00:06:20,880 --> 00:06:25,500
weeds on this later but you're going to

151
00:06:22,920 --> 00:06:26,820
look for your data sources where can you

152
00:06:25,500 --> 00:06:28,940
find things so you have to identify

153
00:06:26,820 --> 00:06:31,260
where that data is gonna come from

154
00:06:28,940 --> 00:06:33,300
baseline the behaviors and everybody

155
00:06:31,260 --> 00:06:35,909
tells you to do this it's not easy it

156
00:06:33,300 --> 00:06:38,770
just takes time this is a long effort to

157
00:06:35,910 --> 00:06:41,740
baseline what's happening on your

158
00:06:38,770 --> 00:06:44,140
look for anomalies and then you have to

159
00:06:41,740 --> 00:06:45,610
turn that into a detection and I think

160
00:06:44,140 --> 00:06:47,919
that was something that Heather talked

161
00:06:45,610 --> 00:06:49,600
about in her talk the output of your

162
00:06:47,920 --> 00:06:51,670
hunts if they're successful should be a

163
00:06:49,600 --> 00:06:55,060
new detection going forward so you don't

164
00:06:51,670 --> 00:06:57,030
have to do this over and over again so

165
00:06:55,060 --> 00:06:59,290
then we get to what hunting really is

166
00:06:57,030 --> 00:07:00,789
and it's sitting at a computer for a

167
00:06:59,290 --> 00:07:04,990
long time bleeding your eyes out

168
00:07:00,790 --> 00:07:06,580
drinking coffee or Red Bull in terms of

169
00:07:04,990 --> 00:07:09,370
approaches we have a couple different

170
00:07:06,580 --> 00:07:11,409
ways that we're bucketing this so the

171
00:07:09,370 --> 00:07:14,710
classic one is objective driven where

172
00:07:11,410 --> 00:07:18,310
you set up a specific objective that

173
00:07:14,710 --> 00:07:20,859
might be to assess all of your domain

174
00:07:18,310 --> 00:07:22,180
controllers so maybe a hunt is I'm gonna

175
00:07:20,860 --> 00:07:24,040
pull RAM from all of my domain

176
00:07:22,180 --> 00:07:25,680
controllers and analyze that and make

177
00:07:24,040 --> 00:07:28,930
sure that they're clean and they're all

178
00:07:25,680 --> 00:07:31,240
given a clean bill of health the next

179
00:07:28,930 --> 00:07:33,130
approach and I think so another speaker

180
00:07:31,240 --> 00:07:36,490
mentioned this earlier was intelligence

181
00:07:33,130 --> 00:07:38,200
driven so as new intelligence comes into

182
00:07:36,490 --> 00:07:41,530
your organization whether it's open

183
00:07:38,200 --> 00:07:43,120
source a blog a threat something that

184
00:07:41,530 --> 00:07:45,609
you've learned by monitoring the

185
00:07:43,120 --> 00:07:47,560
adversary there's gonna be new

186
00:07:45,610 --> 00:07:49,300
indicators or new data that you can use

187
00:07:47,560 --> 00:07:50,830
to go ahead and apply to start hunting

188
00:07:49,300 --> 00:07:53,170
within your organization and I think

189
00:07:50,830 --> 00:07:57,159
most companies aren't doing this today

190
00:07:53,170 --> 00:07:59,230
in some somewhat of a fashion finally

191
00:07:57,160 --> 00:08:00,850
anomaly driven is kind of the purest

192
00:07:59,230 --> 00:08:02,560
form of hunting that means you don't

193
00:08:00,850 --> 00:08:04,450
really have an objective or anything to

194
00:08:02,560 --> 00:08:08,140
start off of you're just going out there

195
00:08:04,450 --> 00:08:10,450
looking for what isn't normal frequency

196
00:08:08,140 --> 00:08:13,900
of how you do hunting is largely a

197
00:08:10,450 --> 00:08:15,610
reflection of your resources so I think

198
00:08:13,900 --> 00:08:18,940
it's really really common for people to

199
00:08:15,610 --> 00:08:20,890
do ad-hoc hunting as a cert guy or a

200
00:08:18,940 --> 00:08:22,600
sock guy you might spend a few hours a

201
00:08:20,890 --> 00:08:24,820
day just looking through logs and

202
00:08:22,600 --> 00:08:27,900
looking for random stuff and that's

203
00:08:24,820 --> 00:08:30,340
great that's what you should be doing

204
00:08:27,900 --> 00:08:32,709
but it's not going to be the best

205
00:08:30,340 --> 00:08:34,419
approach in the long term that may be

206
00:08:32,710 --> 00:08:35,700
the only approach you can do if you just

207
00:08:34,419 --> 00:08:38,979
don't have the resources to do it

208
00:08:35,700 --> 00:08:41,350
project based is another great way to

209
00:08:38,980 --> 00:08:43,000
tackle this and that might be throughout

210
00:08:41,350 --> 00:08:44,440
the year you may have three or four

211
00:08:43,000 --> 00:08:45,940
different hunting projects that you do

212
00:08:44,440 --> 00:08:48,790
and you're able to dedicate real

213
00:08:45,940 --> 00:08:50,410
resources have a project manager and a

214
00:08:48,790 --> 00:08:51,339
great example of this is maybe a new

215
00:08:50,410 --> 00:08:53,620
mergers and

216
00:08:51,340 --> 00:08:55,420
so you're bringing in a new company a

217
00:08:53,620 --> 00:08:57,130
project maybe hey let's go hunt that

218
00:08:55,420 --> 00:09:00,160
environment before we connect them up to

219
00:08:57,130 --> 00:09:03,040
our network great example there and then

220
00:09:00,160 --> 00:09:06,279
lastly the continuous dedicated hunt

221
00:09:03,040 --> 00:09:07,510
threat hunting team so with that you

222
00:09:06,279 --> 00:09:10,570
know that's gonna be a well staffed

223
00:09:07,510 --> 00:09:13,240
organization that can afford to task a

224
00:09:10,570 --> 00:09:15,580
couple people to do this which you know

225
00:09:13,240 --> 00:09:17,620
that's kind of the top 20% of maturity

226
00:09:15,580 --> 00:09:19,330
of companies that might be in that space

227
00:09:17,620 --> 00:09:21,370
and hopefully we can grow that over time

228
00:09:19,330 --> 00:09:25,600
as companies realize that threat hunting

229
00:09:21,370 --> 00:09:27,070
is very important to detection a quick

230
00:09:25,600 --> 00:09:30,010
word on the different types of

231
00:09:27,070 --> 00:09:31,810
techniques so I think everybody's seen

232
00:09:30,010 --> 00:09:33,490
these before and your brain really

233
00:09:31,810 --> 00:09:36,040
operates this way but you just don't

234
00:09:33,490 --> 00:09:37,450
categorize it in these terms so when you

235
00:09:36,040 --> 00:09:39,219
look for things obviously lease

236
00:09:37,450 --> 00:09:43,120
frequency of occurrence so the things

237
00:09:39,220 --> 00:09:45,910
that are rare so startup items that

238
00:09:43,120 --> 00:09:47,260
maybe are on those few hosts but are

239
00:09:45,910 --> 00:09:48,699
different than the ones that are on all

240
00:09:47,260 --> 00:09:49,660
of your hosts and I think somebody

241
00:09:48,700 --> 00:09:52,690
touched on that and one of their

242
00:09:49,660 --> 00:09:54,339
presentations earlier variance so

243
00:09:52,690 --> 00:09:55,839
standard deviation so it's not just

244
00:09:54,339 --> 00:09:57,010
stuff that's rare but things that are

245
00:09:55,839 --> 00:10:01,180
outside of the normal and not

246
00:09:57,010 --> 00:10:03,610
necessarily low or a count a good

247
00:10:01,180 --> 00:10:06,040
example of that would be network flowing

248
00:10:03,610 --> 00:10:08,620
out of your data how many times have you

249
00:10:06,040 --> 00:10:11,380
seen seeing that read about a breach and

250
00:10:08,620 --> 00:10:15,100
thought to yourself why did that company

251
00:10:11,380 --> 00:10:17,470
not detect 30 gig of data leaving their

252
00:10:15,100 --> 00:10:20,080
network so variance is a good way to do

253
00:10:17,470 --> 00:10:21,760
that if you're sampling how much data is

254
00:10:20,080 --> 00:10:24,520
going out of your network and you see a

255
00:10:21,760 --> 00:10:26,530
spike that would be a variance first

256
00:10:24,520 --> 00:10:28,750
seen on network and host is always great

257
00:10:26,530 --> 00:10:30,069
I think I had a conversation here

258
00:10:28,750 --> 00:10:32,200
actually with somebody about just

259
00:10:30,070 --> 00:10:34,120
hunting new stuff so every day if you

260
00:10:32,200 --> 00:10:36,160
get a report and you look at what's new

261
00:10:34,120 --> 00:10:38,370
and then dive into that that's a great

262
00:10:36,160 --> 00:10:42,130
way to find people in your network

263
00:10:38,370 --> 00:10:43,600
sampling is a technique that you just

264
00:10:42,130 --> 00:10:45,700
look for data that you normally collect

265
00:10:43,600 --> 00:10:48,339
so I think a lot of people in their

266
00:10:45,700 --> 00:10:50,470
corporate networks have an area of their

267
00:10:48,339 --> 00:10:53,320
business that's kind of off limits maybe

268
00:10:50,470 --> 00:10:55,380
that's your ERP system or something

269
00:10:53,320 --> 00:10:58,270
critical for your manufacturing process

270
00:10:55,380 --> 00:10:59,920
financial something maybe where they

271
00:10:58,270 --> 00:11:02,140
don't let the security team put their

272
00:10:59,920 --> 00:11:03,490
agent on so sampling would be going out

273
00:11:02,140 --> 00:11:04,649
there and doing like a one-time

274
00:11:03,490 --> 00:11:07,199
collection and pulling in

275
00:11:04,649 --> 00:11:09,149
new data set just to hunt that area and

276
00:11:07,199 --> 00:11:11,089
raise your assurance that that area is

277
00:11:09,149 --> 00:11:15,209
not compromised

278
00:11:11,089 --> 00:11:16,829
and lastly temporal or timing once

279
00:11:15,209 --> 00:11:18,300
you've been able to baseline your

280
00:11:16,829 --> 00:11:20,758
environment just think of this is that

281
00:11:18,300 --> 00:11:24,179
spark line so you're looking at things

282
00:11:20,759 --> 00:11:26,399
over time and things that deviate from

283
00:11:24,179 --> 00:11:28,470
that normal timing so maybe at midnight

284
00:11:26,399 --> 00:11:31,110
you're expecting to see backups run and

285
00:11:28,470 --> 00:11:32,850
it spikes up so something that doesn't

286
00:11:31,110 --> 00:11:34,319
match that pattern but you really have

287
00:11:32,850 --> 00:11:39,329
to baseline before you can get into

288
00:11:34,319 --> 00:11:41,128
timing so anybody that's a fan of

289
00:11:39,329 --> 00:11:44,998
Silicon Valley will recognize original

290
00:11:41,129 --> 00:11:48,600
Jared I'm gonna use this his awesome

291
00:11:44,999 --> 00:11:51,779
SWAT diagram here so who should be

292
00:11:48,600 --> 00:11:53,879
hunting if you're not strong in these

293
00:11:51,779 --> 00:11:56,339
four areas I don't recommend you get in

294
00:11:53,879 --> 00:11:57,749
hunting you really need to go back to go

295
00:11:56,339 --> 00:12:00,809
back to home base and knock these out

296
00:11:57,749 --> 00:12:03,139
first so you need to have an IR process

297
00:12:00,809 --> 00:12:05,579
with at least one person dedicated to IR

298
00:12:03,139 --> 00:12:08,610
network visibility and host visibility

299
00:12:05,579 --> 00:12:10,378
and logging you really need that that's

300
00:12:08,610 --> 00:12:13,290
critical so definitely get that knocked

301
00:12:10,379 --> 00:12:15,929
out first in terms of weaknesses like

302
00:12:13,290 --> 00:12:17,490
why why would you be hunting that's to

303
00:12:15,929 --> 00:12:19,499
compensate for weaknesses so if you're

304
00:12:17,490 --> 00:12:21,449
weak on prevention or detecting things

305
00:12:19,499 --> 00:12:23,100
early if you're dwell time is pretty

306
00:12:21,449 --> 00:12:26,819
long hunting can help you get there and

307
00:12:23,100 --> 00:12:29,389
close that gap in terms of experience it

308
00:12:26,819 --> 00:12:31,529
can also help your socks dirt guys

309
00:12:29,389 --> 00:12:33,569
getting more experience running through

310
00:12:31,529 --> 00:12:35,610
the process of analyzing data and

311
00:12:33,569 --> 00:12:38,329
looking for compromise so it's

312
00:12:35,610 --> 00:12:40,920
definitely there to help grow them and

313
00:12:38,329 --> 00:12:42,748
budget is kind of twofold hunting

314
00:12:40,920 --> 00:12:44,160
doesn't have to cost any money it can

315
00:12:42,749 --> 00:12:45,899
just be time and you have to get

316
00:12:44,160 --> 00:12:47,519
approval for that time but it's not like

317
00:12:45,899 --> 00:12:50,100
you have to buy an expensive tool to go

318
00:12:47,519 --> 00:12:51,660
hunting and also if you happen to find

319
00:12:50,100 --> 00:12:54,240
something if you find a big compromise

320
00:12:51,660 --> 00:12:57,959
that tends to open up the budget the

321
00:12:54,240 --> 00:13:00,449
purse strings a little bit so threats in

322
00:12:57,959 --> 00:13:01,949
terms of what why why we're doing this

323
00:13:00,449 --> 00:13:05,339
is because we have these threats against

324
00:13:01,949 --> 00:13:06,899
our network these are the standard four

325
00:13:05,339 --> 00:13:10,049
buckets that we tend to put things in

326
00:13:06,899 --> 00:13:11,519
I'm just curious if anybody has

327
00:13:10,049 --> 00:13:13,170
something else that's threatening their

328
00:13:11,519 --> 00:13:14,819
network that's not in these four buckets

329
00:13:13,170 --> 00:13:17,160
there's anybody dealing with something

330
00:13:14,819 --> 00:13:19,459
on a daily basis that's not one of those

331
00:13:17,160 --> 00:13:19,459
four

332
00:13:19,610 --> 00:13:26,250
okay so the the what's that oh yeah so

333
00:13:25,530 --> 00:13:28,530
that's a great one

334
00:13:26,250 --> 00:13:30,360
so she said non-malicious insider so the

335
00:13:28,530 --> 00:13:31,949
people that actually don't know what

336
00:13:30,360 --> 00:13:34,140
they're doing and just accidentally

337
00:13:31,950 --> 00:13:37,710
email all your financial results out to

338
00:13:34,140 --> 00:13:39,120
their personal gmail account another one

339
00:13:37,710 --> 00:13:40,950
that I've seen that doesn't fall into

340
00:13:39,120 --> 00:13:43,410
these buckets is just kind of the random

341
00:13:40,950 --> 00:13:45,420
target of opportunity hacker so he's not

342
00:13:43,410 --> 00:13:47,699
really associated with organized crime

343
00:13:45,420 --> 00:13:49,979
he's just out there trolling around and

344
00:13:47,700 --> 00:13:52,710
says oh you put out WordPress unpatched

345
00:13:49,980 --> 00:13:54,630
I'm gonna own you guys and that can

346
00:13:52,710 --> 00:13:56,340
actually be just as bad because those

347
00:13:54,630 --> 00:13:58,439
people don't have anything to lose they

348
00:13:56,340 --> 00:14:02,370
don't think anything of just destroying

349
00:13:58,440 --> 00:14:04,050
your data similar to the hacktivists um

350
00:14:02,370 --> 00:14:06,030
in terms of opportunities these are all

351
00:14:04,050 --> 00:14:09,839
the things that you're going for your

352
00:14:06,030 --> 00:14:12,030
your outputs essentially from hunting so

353
00:14:09,840 --> 00:14:15,500
for the business you want to avoid loss

354
00:14:12,030 --> 00:14:18,180
clearly risk assurance by hunting

355
00:14:15,500 --> 00:14:20,310
overtime regularly you're raising your

356
00:14:18,180 --> 00:14:22,109
assurance level that you're more secure

357
00:14:20,310 --> 00:14:24,780
it's definitely something that's

358
00:14:22,110 --> 00:14:26,640
concrete that you can show the c-suite

359
00:14:24,780 --> 00:14:29,520
that we're doing things and we're being

360
00:14:26,640 --> 00:14:30,750
proactive about it and of course it's

361
00:14:29,520 --> 00:14:33,900
improving your detection and response

362
00:14:30,750 --> 00:14:36,510
skills along the lines of experience for

363
00:14:33,900 --> 00:14:38,220
your socks dirt and enrichment for those

364
00:14:36,510 --> 00:14:40,080
guys so if their eyes on glass all day

365
00:14:38,220 --> 00:14:41,700
it's nice to take them off of that to

366
00:14:40,080 --> 00:14:43,770
let them do some hunting and break up

367
00:14:41,700 --> 00:14:50,580
the monotony of just watching watching

368
00:14:43,770 --> 00:14:52,410
the sim so outputs as security

369
00:14:50,580 --> 00:14:55,350
professionals a lot of the times we get

370
00:14:52,410 --> 00:14:59,160
knocked for not giving the business or

371
00:14:55,350 --> 00:15:00,300
leadership concrete tangible outputs so

372
00:14:59,160 --> 00:15:04,920
that's something that needs to come out

373
00:15:00,300 --> 00:15:07,050
of your hunt a report a debrief and

374
00:15:04,920 --> 00:15:10,740
really building new detections that's

375
00:15:07,050 --> 00:15:12,599
that's key and then another thing that I

376
00:15:10,740 --> 00:15:15,750
think Pam touched on as well as

377
00:15:12,600 --> 00:15:17,400
increasing my business intelligence it's

378
00:15:15,750 --> 00:15:18,870
not just about the threat the but the

379
00:15:17,400 --> 00:15:20,010
more you know about your business the

380
00:15:18,870 --> 00:15:23,070
better you are and the better you can

381
00:15:20,010 --> 00:15:24,930
defend it so at this point we're going

382
00:15:23,070 --> 00:15:26,790
to I'm going to transition to Reed and

383
00:15:24,930 --> 00:15:30,390
he's going to be talking a little bit

384
00:15:26,790 --> 00:15:33,060
about the threat detection framework

385
00:15:30,390 --> 00:15:34,290
so over the course of the last few days

386
00:15:33,060 --> 00:15:37,079
we've talked about underwear different

387
00:15:34,290 --> 00:15:38,760
frameworks of what is hunting but one

388
00:15:37,079 --> 00:15:40,859
thing we wanted to touch on was how this

389
00:15:38,760 --> 00:15:43,350
actually fits in your regular operations

390
00:15:40,860 --> 00:15:45,450
how do you actually do this so for our

391
00:15:43,350 --> 00:15:47,490
top row we have our unknowns where you

392
00:15:45,450 --> 00:15:48,600
have our use case library these are our

393
00:15:47,490 --> 00:15:50,490
alerts this is the stuff that we're

394
00:15:48,600 --> 00:15:53,100
detecting that we already have feeding

395
00:15:50,490 --> 00:15:55,170
into our process in the hunt lifecycle

396
00:15:53,100 --> 00:15:56,940
we're attempting to tackle our unknown

397
00:15:55,170 --> 00:15:59,250
so the stuff that we might not have a

398
00:15:56,940 --> 00:16:00,450
detection existing for so as far as

399
00:15:59,250 --> 00:16:03,810
hunting so we're gonna start out with

400
00:16:00,450 --> 00:16:04,950
our goal or our mission creation then

401
00:16:03,810 --> 00:16:06,930
we're going to plan how are we going to

402
00:16:04,950 --> 00:16:08,370
accomplish that then we're gonna go

403
00:16:06,930 --> 00:16:09,930
about collecting data we're gonna

404
00:16:08,370 --> 00:16:12,180
analyze that data and then ultimately

405
00:16:09,930 --> 00:16:13,859
debrief on the results if we find

406
00:16:12,180 --> 00:16:17,040
something during analysis then we're

407
00:16:13,860 --> 00:16:20,100
gonna keep up our IR process and really

408
00:16:17,040 --> 00:16:22,740
dive deeper into what we found also

409
00:16:20,100 --> 00:16:24,420
during our debrief as you go through

410
00:16:22,740 --> 00:16:27,390
multiple hunts and you get better at

411
00:16:24,420 --> 00:16:29,610
conducting operations you want that to

412
00:16:27,390 --> 00:16:31,709
feed and improve your use case library

413
00:16:29,610 --> 00:16:34,649
can your hunt be turned into a detection

414
00:16:31,709 --> 00:16:37,739
or an alert can you improve the fidelity

415
00:16:34,649 --> 00:16:38,760
of your current detections so those are

416
00:16:37,740 --> 00:16:41,910
some of the outcomes that we'd like to

417
00:16:38,760 --> 00:16:44,750
see from as you mature in your hunting

418
00:16:41,910 --> 00:16:47,250
operations and as you get better at it

419
00:16:44,750 --> 00:16:49,230
it would hopefully turn from something

420
00:16:47,250 --> 00:16:51,690
that you do once or twice in an ad hoc

421
00:16:49,230 --> 00:16:55,170
manner to an actual alert that you can

422
00:16:51,690 --> 00:17:00,060
take action on without the individual

423
00:16:55,170 --> 00:17:02,610
collection so apologize for unreadable

424
00:17:00,060 --> 00:17:03,630
text but so what does this look like

425
00:17:02,610 --> 00:17:04,980
what are some of the questions you

426
00:17:03,630 --> 00:17:06,959
should be asking yourself as you go

427
00:17:04,980 --> 00:17:08,699
through this process so for goal

428
00:17:06,959 --> 00:17:12,689
creation so what are you currently

429
00:17:08,699 --> 00:17:13,980
collecting what can you collect how much

430
00:17:12,689 --> 00:17:16,199
data would be manageable for you to

431
00:17:13,980 --> 00:17:19,140
analyze in what you've defined is your

432
00:17:16,199 --> 00:17:20,250
hunt for mission planning how are you

433
00:17:19,140 --> 00:17:22,559
going to collect that data do you need

434
00:17:20,250 --> 00:17:24,419
some different tool sets and how long do

435
00:17:22,559 --> 00:17:25,918
you expect this collection to take do

436
00:17:24,419 --> 00:17:28,530
you regularly have people drop off your

437
00:17:25,919 --> 00:17:30,620
network for months at a time need to

438
00:17:28,530 --> 00:17:32,428
plan that into your data collection

439
00:17:30,620 --> 00:17:33,989
collection that's ultimately where you

440
00:17:32,429 --> 00:17:37,500
the rubber meets the road and you use

441
00:17:33,990 --> 00:17:40,500
your tools to collect your data from an

442
00:17:37,500 --> 00:17:42,870
analysis environment what is my analysis

443
00:17:40,500 --> 00:17:44,130
environment is the data that I'm

444
00:17:42,870 --> 00:17:45,840
collecting is in a format

445
00:17:44,130 --> 00:17:48,060
that can analyze from my infrastructure

446
00:17:45,840 --> 00:17:49,560
and then during my debrief I want to

447
00:17:48,060 --> 00:17:51,240
look at it's okay do I have any findings

448
00:17:49,560 --> 00:17:52,800
do I have any lessons learned do I need

449
00:17:51,240 --> 00:17:55,290
to switch my tool set are there better

450
00:17:52,800 --> 00:17:58,290
ways I can go about doing my next set of

451
00:17:55,290 --> 00:18:00,840
operations and then ultimately can this

452
00:17:58,290 --> 00:18:03,600
be turned into an alert later on so one

453
00:18:00,840 --> 00:18:05,730
example of a hunt might be I want to

454
00:18:03,600 --> 00:18:06,719
understand what programs have

455
00:18:05,730 --> 00:18:09,810
established persistence in my

456
00:18:06,720 --> 00:18:11,790
environment so for my planning I'm going

457
00:18:09,810 --> 00:18:14,220
to use PS exec crowd response and an

458
00:18:11,790 --> 00:18:15,720
open share to collect data for my

459
00:18:14,220 --> 00:18:17,760
collection I'm going to have cabinet XML

460
00:18:15,720 --> 00:18:19,530
outputs from crowd response and I'm

461
00:18:17,760 --> 00:18:23,970
planning to ingest that into a spunk to

462
00:18:19,530 --> 00:18:26,340
Splunk as a post processed CSV from

463
00:18:23,970 --> 00:18:28,770
analysis I've got some pretty big spunk

464
00:18:26,340 --> 00:18:30,480
queries to look at least frequency and

465
00:18:28,770 --> 00:18:32,760
some other suspicious items as well as I

466
00:18:30,480 --> 00:18:33,870
have my analyst knowledge from knowing

467
00:18:32,760 --> 00:18:36,570
my environment to look for other

468
00:18:33,870 --> 00:18:39,149
indicators of strange during my debrief

469
00:18:36,570 --> 00:18:41,040
I might find 10 new binaries to do some

470
00:18:39,150 --> 00:18:43,410
additional analysis on maybe I do some

471
00:18:41,040 --> 00:18:45,330
more triage on and maybe depending on

472
00:18:43,410 --> 00:18:50,040
how big your environment is 200 plus

473
00:18:45,330 --> 00:18:52,139
machines with some commodity malware so

474
00:18:50,040 --> 00:18:53,730
as I mentioned we have a tool that we

475
00:18:52,140 --> 00:18:56,280
publish for free called the crowd

476
00:18:53,730 --> 00:18:57,960
response so this is written by Robin

477
00:18:56,280 --> 00:18:59,910
Kier on our team and it comes with two

478
00:18:57,960 --> 00:19:01,980
components the first is crowd responds

479
00:18:59,910 --> 00:19:04,620
at exe so this is our windows only

480
00:19:01,980 --> 00:19:06,720
console application and we also package

481
00:19:04,620 --> 00:19:10,320
it up with CR convert so in case you

482
00:19:06,720 --> 00:19:12,240
don't like XML I don't think anybody

483
00:19:10,320 --> 00:19:14,460
likes XML from a human readable

484
00:19:12,240 --> 00:19:16,740
perspective you can convert that into a

485
00:19:14,460 --> 00:19:18,510
comma separated tab separated or even

486
00:19:16,740 --> 00:19:21,330
just a HTML file when you're looking at

487
00:19:18,510 --> 00:19:23,520
a machine for deployment you have a few

488
00:19:21,330 --> 00:19:25,169
different options so if you want to you

489
00:19:23,520 --> 00:19:27,090
can do a targeted command line entry

490
00:19:25,170 --> 00:19:29,190
where you just grab one module or one

491
00:19:27,090 --> 00:19:31,139
very specific piece of information or

492
00:19:29,190 --> 00:19:33,120
you can also feed an external

493
00:19:31,140 --> 00:19:34,110
configuration into crowd response so if

494
00:19:33,120 --> 00:19:38,489
you want to collect enough data to

495
00:19:34,110 --> 00:19:40,050
triage a single machine you can do so as

496
00:19:38,490 --> 00:19:42,270
far as deployment goes so a few

497
00:19:40,050 --> 00:19:44,730
different options now we do not want to

498
00:19:42,270 --> 00:19:46,370
have a fair warning here there's no one

499
00:19:44,730 --> 00:19:49,110
solution that fits every organization

500
00:19:46,370 --> 00:19:51,570
sometimes you might have different tools

501
00:19:49,110 --> 00:19:53,550
for your pest management software

502
00:19:51,570 --> 00:19:54,929
deployment these are a few things that

503
00:19:53,550 --> 00:19:57,419
we've seen some of our clients do when

504
00:19:54,930 --> 00:19:57,700
to playing the official crowd response

505
00:19:57,420 --> 00:20:00,429
to

506
00:19:57,700 --> 00:20:01,929
said so one option is PS exec if you're

507
00:20:00,429 --> 00:20:04,720
gonna go down this route individually we

508
00:20:01,929 --> 00:20:07,149
strongly recommend you check out like

509
00:20:04,720 --> 00:20:09,490
poking tunes post on the sans blog about

510
00:20:07,149 --> 00:20:10,959
protecting your admin credentials when

511
00:20:09,490 --> 00:20:12,960
using PS exactly

512
00:20:10,960 --> 00:20:15,460
long story short basically you need to

513
00:20:12,960 --> 00:20:18,669
authenticate to the IP C dollar share

514
00:20:15,460 --> 00:20:20,250
first before you actually use PS exec we

515
00:20:18,669 --> 00:20:23,470
also found out from a friend of a friend

516
00:20:20,250 --> 00:20:24,990
somebody that put together a PowerShell

517
00:20:23,470 --> 00:20:27,880
tool that will deploy a crowd response

518
00:20:24,990 --> 00:20:29,559
run it collect the data and then bring

519
00:20:27,880 --> 00:20:31,029
it back to your local machine these

520
00:20:29,559 --> 00:20:32,649
slides will be made available after the

521
00:20:31,029 --> 00:20:35,080
con so if you want to check that out

522
00:20:32,649 --> 00:20:37,840
strongly strongly recommend you check it

523
00:20:35,080 --> 00:20:39,908
out you can also if you want to do a

524
00:20:37,840 --> 00:20:43,980
larger breadth of information you can

525
00:20:39,909 --> 00:20:46,659
also deploy with group policy or SCCM

526
00:20:43,980 --> 00:20:48,880
also we want to touch on from a planning

527
00:20:46,659 --> 00:20:53,320
perspective our collection analysis

528
00:20:48,880 --> 00:20:56,139
platform so we prefer Splunk whatever

529
00:20:53,320 --> 00:20:59,309
you want to whatever fits your needs you

530
00:20:56,139 --> 00:21:01,719
can use so if that's a setup grab unique

531
00:20:59,309 --> 00:21:04,480
that works just as well if your data is

532
00:21:01,720 --> 00:21:06,039
in the right format but since we might

533
00:21:04,480 --> 00:21:07,809
be dealing with collections from

534
00:21:06,039 --> 00:21:10,480
hundreds of thousands of hosts we prefer

535
00:21:07,809 --> 00:21:16,779
a larger environment that can scale as

536
00:21:10,480 --> 00:21:19,120
needed some think we want to touch on

537
00:21:16,779 --> 00:21:22,120
was not just saying oh yeah go go hunt

538
00:21:19,120 --> 00:21:22,928
your net or go do all the things we want

539
00:21:22,120 --> 00:21:25,389
to share some of our lessons learned

540
00:21:22,929 --> 00:21:27,580
from us doing this on a regular basis so

541
00:21:25,389 --> 00:21:29,469
the first is a frictionless deployment

542
00:21:27,580 --> 00:21:31,120
so you have to be flexible for how

543
00:21:29,470 --> 00:21:33,240
you're gonna collect do you need to ship

544
00:21:31,120 --> 00:21:35,699
data through a Content filter or a proxy

545
00:21:33,240 --> 00:21:38,649
do you have to write it to an open share

546
00:21:35,700 --> 00:21:40,990
if you want to do a targeted or a broad

547
00:21:38,649 --> 00:21:42,239
collection does your toolset have the

548
00:21:40,990 --> 00:21:45,070
flexibility to do that

549
00:21:42,240 --> 00:21:47,320
we also want to look at a persistence

550
00:21:45,070 --> 00:21:48,879
versus self cleaning so do you have some

551
00:21:47,320 --> 00:21:51,309
nosy users that look and see oh that's

552
00:21:48,880 --> 00:21:54,070
that's a strange binary I'm gonna I'm

553
00:21:51,309 --> 00:21:55,360
gonna delete it or I suddenly saw my CPU

554
00:21:54,070 --> 00:21:59,529
spiked up so therefore I'm gonna kill

555
00:21:55,360 --> 00:22:01,299
our collection tools we also recommend

556
00:21:59,529 --> 00:22:06,700
establishing a centralized intake server

557
00:22:01,299 --> 00:22:09,010
so rather than one off like remote

558
00:22:06,700 --> 00:22:10,299
desktop into a machine running your tool

559
00:22:09,010 --> 00:22:11,550
set waiting for it finish then

560
00:22:10,299 --> 00:22:13,080
collecting it back

561
00:22:11,550 --> 00:22:14,310
you want to be able to kick this off on

562
00:22:13,080 --> 00:22:16,290
hundreds or maybe thousands of machines

563
00:22:14,310 --> 00:22:18,330
at once and collected into your analysis

564
00:22:16,290 --> 00:22:22,620
environment without without much

565
00:22:18,330 --> 00:22:24,480
involvement as a forewarning for having

566
00:22:22,620 --> 00:22:26,219
that centralized environment large

567
00:22:24,480 --> 00:22:28,350
collections can create absolute havoc

568
00:22:26,220 --> 00:22:30,030
from your analysis environment so just

569
00:22:28,350 --> 00:22:33,149
be prepared to adjust if needed so if

570
00:22:30,030 --> 00:22:35,430
you if you collect from your main gnash

571
00:22:33,150 --> 00:22:38,820
here and you've got a directory listing

572
00:22:35,430 --> 00:22:40,470
of a few million files just be

573
00:22:38,820 --> 00:22:41,850
forewarned that it's gonna take time for

574
00:22:40,470 --> 00:22:43,230
your analysis environment to catch up

575
00:22:41,850 --> 00:22:47,100
and actually process all that

576
00:22:43,230 --> 00:22:49,920
information for us so we create separate

577
00:22:47,100 --> 00:22:51,360
indexes or as logical separators for

578
00:22:49,920 --> 00:22:53,430
each of our engagements or our clients

579
00:22:51,360 --> 00:22:56,790
but you can use this as two separate

580
00:22:53,430 --> 00:22:59,220
your hunts ultimately I ops reigned

581
00:22:56,790 --> 00:23:00,480
supreme so we're going to show you in

582
00:22:59,220 --> 00:23:03,060
our demo video where we actually process

583
00:23:00,480 --> 00:23:04,920
the full results from about five

584
00:23:03,060 --> 00:23:09,540
different hosts it only takes about 20

585
00:23:04,920 --> 00:23:11,010
seconds on a VM on my laptop but when

586
00:23:09,540 --> 00:23:12,180
you're dealing with large numbers of

587
00:23:11,010 --> 00:23:13,920
collections

588
00:23:12,180 --> 00:23:16,230
it's the disk read rights that are

589
00:23:13,920 --> 00:23:19,170
ultimately gonna speed up your

590
00:23:16,230 --> 00:23:20,280
processing and then for if you want to

591
00:23:19,170 --> 00:23:23,790
do this by yourselves with our free

592
00:23:20,280 --> 00:23:26,820
tools we recommend looking at opening up

593
00:23:23,790 --> 00:23:29,700
some shares to write out the results

594
00:23:26,820 --> 00:23:35,760
from your collections or even a larger

595
00:23:29,700 --> 00:23:37,350
deployment so while this talk isn't

596
00:23:35,760 --> 00:23:39,270
meant to talk about the artifacts that

597
00:23:37,350 --> 00:23:41,340
we're going to be looking at we do need

598
00:23:39,270 --> 00:23:42,780
to set some background for what crowd

599
00:23:41,340 --> 00:23:45,240
response can collect and how we're going

600
00:23:42,780 --> 00:23:46,590
to use this data to hunt so the first

601
00:23:45,240 --> 00:23:49,920
module we're going to talk about is the

602
00:23:46,590 --> 00:23:52,830
files so this is very basic file system

603
00:23:49,920 --> 00:23:54,810
metadata this comes from your MFT or

604
00:23:52,830 --> 00:23:57,270
Master File table or your fat table and

605
00:23:54,810 --> 00:23:59,310
you can kind of expect to see

606
00:23:57,270 --> 00:24:01,190
mase or Mac be timestamps so this is

607
00:23:59,310 --> 00:24:02,460
going to be your modified access

608
00:24:01,190 --> 00:24:05,250
god-created

609
00:24:02,460 --> 00:24:07,710
or entry changed dependent like which

610
00:24:05,250 --> 00:24:09,300
language you prefer so one example that

611
00:24:07,710 --> 00:24:10,800
we can use that we actually include in

612
00:24:09,300 --> 00:24:13,200
our pre-baked configuration when you

613
00:24:10,800 --> 00:24:15,360
download crowd response is I want to

614
00:24:13,200 --> 00:24:17,190
look at all excuse sitting in the

615
00:24:15,360 --> 00:24:19,889
windows directory and recursively go

616
00:24:17,190 --> 00:24:22,110
through that so that's just the example

617
00:24:19,890 --> 00:24:24,800
of the command line that you would use

618
00:24:22,110 --> 00:24:26,419
in your config or if you wanted to

619
00:24:24,800 --> 00:24:32,180
run crowd response from the command line

620
00:24:26,420 --> 00:24:33,590
and collect that the registry so these

621
00:24:32,180 --> 00:24:34,790
are data fact data files on Windows

622
00:24:33,590 --> 00:24:37,250
systems called hives

623
00:24:34,790 --> 00:24:38,990
they contain key value pairs and you

624
00:24:37,250 --> 00:24:42,080
have multiple hives for your system or

625
00:24:38,990 --> 00:24:45,320
your users these are a treasure trove of

626
00:24:42,080 --> 00:24:47,750
data from user assists who most recently

627
00:24:45,320 --> 00:24:50,030
use to shim cache to your services this

628
00:24:47,750 --> 00:24:52,100
is a ton of data that you can be used

629
00:24:50,030 --> 00:24:54,740
that you can use to hunt and ultimately

630
00:24:52,100 --> 00:24:56,510
gain some insight into your machines we

631
00:24:54,740 --> 00:24:58,640
provide two functions within crowd

632
00:24:56,510 --> 00:25:00,590
response to address this the first is

633
00:24:58,640 --> 00:25:02,000
reg dump so this is going to dump out

634
00:25:00,590 --> 00:25:04,490
the key value pair so it just give you

635
00:25:02,000 --> 00:25:05,750
some very basic information the second

636
00:25:04,490 --> 00:25:10,640
tool that we package with crowd response

637
00:25:05,750 --> 00:25:13,130
is reg file so when we see a full path

638
00:25:10,640 --> 00:25:14,570
to a file in the registry we're actually

639
00:25:13,130 --> 00:25:17,030
gonna go and look at the file system

640
00:25:14,570 --> 00:25:19,250
data for that entry so not just that

641
00:25:17,030 --> 00:25:21,290
okay is this still sitting on disk or do

642
00:25:19,250 --> 00:25:22,280
I need to really worry about this reg

643
00:25:21,290 --> 00:25:27,710
file is going to go through and do that

644
00:25:22,280 --> 00:25:29,870
for you also we'd like to introduce

645
00:25:27,710 --> 00:25:32,840
tasks so while unfortunately we didn't

646
00:25:29,870 --> 00:25:34,189
drop the update prior to conference we

647
00:25:32,840 --> 00:25:36,560
are going to be releasing a new version

648
00:25:34,190 --> 00:25:39,320
of crowd response so we are introducing

649
00:25:36,560 --> 00:25:42,560
with that a new module so this is the

650
00:25:39,320 --> 00:25:48,350
Windows tasks while this isn't a new

651
00:25:42,560 --> 00:25:49,940
artifact or super-fancy we did want to

652
00:25:48,350 --> 00:25:52,990
touch on this and how it is a new piece

653
00:25:49,940 --> 00:25:55,070
of functionality for our free toolset so

654
00:25:52,990 --> 00:25:58,310
this new module is going to parse out

655
00:25:55,070 --> 00:26:01,370
both the the test scheduler one dodo and

656
00:25:58,310 --> 00:26:04,070
one dot two so both on your XP and Vista

657
00:26:01,370 --> 00:26:06,409
and above collections when we parse this

658
00:26:04,070 --> 00:26:07,820
data we're gonna grab the task name the

659
00:26:06,410 --> 00:26:09,950
application that it's executing the

660
00:26:07,820 --> 00:26:10,970
command line parameters and just the

661
00:26:09,950 --> 00:26:12,980
working directory that that would

662
00:26:10,970 --> 00:26:17,030
execute in addition to some some more

663
00:26:12,980 --> 00:26:18,890
information so as a refresh this is yet

664
00:26:17,030 --> 00:26:21,950
another persistence method that somebody

665
00:26:18,890 --> 00:26:24,140
could use to maintain access to a system

666
00:26:21,950 --> 00:26:25,310
if you're talking about older systems

667
00:26:24,140 --> 00:26:27,980
this also be used for privilege

668
00:26:25,310 --> 00:26:30,200
escalations so if you're on server 2003

669
00:26:27,980 --> 00:26:33,800
you can actually elevate to system level

670
00:26:30,200 --> 00:26:36,400
privileges via scheduled tasks Souza's

671
00:26:33,800 --> 00:26:38,240
are found in a few locations and

672
00:26:36,400 --> 00:26:40,610
ultimately you can invoke this

673
00:26:38,240 --> 00:26:44,900
normally via scheduled tasks or the add

674
00:26:40,610 --> 00:26:46,639
command as far as running this from a

675
00:26:44,900 --> 00:26:49,730
collection perspective all you have to

676
00:26:46,640 --> 00:26:53,140
do is include at tasks in your command

677
00:26:49,730 --> 00:26:53,140
lines so it's pretty straightforward

678
00:26:53,440 --> 00:26:57,110
with this update we do want to talk on

679
00:26:55,970 --> 00:26:58,520
some of the new changes for crowd

680
00:26:57,110 --> 00:27:00,199
response to some of your old paper

681
00:26:58,520 --> 00:27:03,680
module since I know everyone here is use

682
00:27:00,200 --> 00:27:08,810
the tool right you guys are supposed to

683
00:27:03,680 --> 00:27:11,180
laughs so the first piece is the Malheur

684
00:27:08,810 --> 00:27:12,860
module so previously this was limited to

685
00:27:11,180 --> 00:27:14,060
a sticky keys detection which we're

686
00:27:12,860 --> 00:27:16,340
going to touch on that in a little bit

687
00:27:14,060 --> 00:27:20,629
about now it's also going to include an

688
00:27:16,340 --> 00:27:23,389
option to detect DL hijacking so for

689
00:27:20,630 --> 00:27:24,890
this we're going to look for dealer name

690
00:27:23,390 --> 00:27:27,110
conflicts found in your path variable

691
00:27:24,890 --> 00:27:29,150
we're gonna look for a name complex not

692
00:27:27,110 --> 00:27:31,340
found in the path variable and we're

693
00:27:29,150 --> 00:27:33,380
also going to check service or currently

694
00:27:31,340 --> 00:27:37,070
running services processes for any name

695
00:27:33,380 --> 00:27:38,630
conflicts on most systems this is a lot

696
00:27:37,070 --> 00:27:40,220
of data to deal with because if you're

697
00:27:38,630 --> 00:27:43,790
on a 64-bit system you might actually

698
00:27:40,220 --> 00:27:45,950
have dll sitting in both system 32 and

699
00:27:43,790 --> 00:27:47,330
sis while so just be aware that when you

700
00:27:45,950 --> 00:27:49,580
do start looking this environment in

701
00:27:47,330 --> 00:27:52,250
your environment but it can be a good

702
00:27:49,580 --> 00:27:55,250
set of ways to look at what might be

703
00:27:52,250 --> 00:27:58,430
doing some very stealthy runs in your

704
00:27:55,250 --> 00:28:00,620
environment we also have a number of bug

705
00:27:58,430 --> 00:28:04,070
fixes and improve processing with CR

706
00:28:00,620 --> 00:28:06,350
concurrent now as a warning if you do

707
00:28:04,070 --> 00:28:08,750
use the previous toolset

708
00:28:06,350 --> 00:28:11,389
you do need to match the current CR

709
00:28:08,750 --> 00:28:14,650
converts with your new collections so

710
00:28:11,390 --> 00:28:17,690
unfortunately we don't include

711
00:28:14,650 --> 00:28:19,220
backwards references for our toolset so

712
00:28:17,690 --> 00:28:20,840
if you do update and you do new

713
00:28:19,220 --> 00:28:24,550
collections you do have to use the new

714
00:28:20,840 --> 00:28:24,550
parser unless you want to deal with XML

715
00:28:29,050 --> 00:28:34,010
so

716
00:28:30,440 --> 00:28:35,480
when looking at this problem we feel

717
00:28:34,010 --> 00:28:37,730
pretty strongly that the collections

718
00:28:35,480 --> 00:28:40,670
issue is mostly solved I think there's a

719
00:28:37,730 --> 00:28:42,890
ton of tools free tools out there for

720
00:28:40,670 --> 00:28:44,900
you guys to do collections you can

721
00:28:42,890 --> 00:28:47,390
easily find I would say at least 20

722
00:28:44,900 --> 00:28:50,230
tools that are great at doing this and

723
00:28:47,390 --> 00:28:53,090
crowd response is just one of them but

724
00:28:50,230 --> 00:28:55,730
there are some problems that can come up

725
00:28:53,090 --> 00:28:57,590
with collections a lot of them are

726
00:28:55,730 --> 00:28:59,480
really like niche issues in terms of

727
00:28:57,590 --> 00:29:02,000
operating systems so maybe you don't

728
00:28:59,480 --> 00:29:04,640
have a way to collect on some really

729
00:29:02,000 --> 00:29:06,520
really old version of Solaris or ax that

730
00:29:04,640 --> 00:29:10,250
could be a problem

731
00:29:06,520 --> 00:29:13,270
OS X there's a great tool called OS X

732
00:29:10,250 --> 00:29:15,200
collector which can help out with that

733
00:29:13,270 --> 00:29:16,850
but they're still going to be these

734
00:29:15,200 --> 00:29:19,880
little fringe cases where you

735
00:29:16,850 --> 00:29:21,439
necessarily can't solve that so for

736
00:29:19,880 --> 00:29:24,770
instance if you wanted to do OS X

737
00:29:21,440 --> 00:29:26,210
collector do you actually have Kasper

738
00:29:24,770 --> 00:29:28,670
running on all of your Macs

739
00:29:26,210 --> 00:29:30,380
how would you get it there so a lot of

740
00:29:28,670 --> 00:29:32,720
times in a predominantly Windows

741
00:29:30,380 --> 00:29:35,960
environment the Macs are kind of one

742
00:29:32,720 --> 00:29:37,970
offs that nobody manages so definitely

743
00:29:35,960 --> 00:29:39,890
some challenges there and then there's a

744
00:29:37,970 --> 00:29:43,430
few things that just you will never

745
00:29:39,890 --> 00:29:45,590
solve so hosts that go offline director

746
00:29:43,430 --> 00:29:47,330
gets his laptop compromised packs up and

747
00:29:45,590 --> 00:29:48,919
goes off to a conference and you won't

748
00:29:47,330 --> 00:29:50,419
be able to image that or do anything for

749
00:29:48,920 --> 00:29:52,370
a while

750
00:29:50,420 --> 00:29:53,780
bandwidth is always a concern especially

751
00:29:52,370 --> 00:29:55,219
if you're pulling bat instead of pulling

752
00:29:53,780 --> 00:30:00,170
back metadata if you're pulling back

753
00:29:55,220 --> 00:30:01,400
entire images and memory network

754
00:30:00,170 --> 00:30:04,850
bandwidth is something you need to worry

755
00:30:01,400 --> 00:30:06,320
about and then also legal you know

756
00:30:04,850 --> 00:30:07,250
there's always these issues here where

757
00:30:06,320 --> 00:30:10,370
you need to make sure you have

758
00:30:07,250 --> 00:30:12,410
permission to do that collection but

759
00:30:10,370 --> 00:30:16,100
where we want to focus is really on the

760
00:30:12,410 --> 00:30:19,160
analysis being able to do that really

761
00:30:16,100 --> 00:30:21,919
really fast and at scale so we are we're

762
00:30:19,160 --> 00:30:24,410
routinely able to collect on 50,000

763
00:30:21,920 --> 00:30:25,940
hosts 60,000 hosts for multiple

764
00:30:24,410 --> 00:30:28,310
customers at the same time so it's

765
00:30:25,940 --> 00:30:30,080
definitely something that scales and we

766
00:30:28,310 --> 00:30:31,669
think that this is the direction that

767
00:30:30,080 --> 00:30:34,129
the industry is heading being able to

768
00:30:31,670 --> 00:30:37,040
triage really really fast into Rob's

769
00:30:34,130 --> 00:30:38,690
point deep dive forensics is definitely

770
00:30:37,040 --> 00:30:40,879
not dead but you want to pick and choose

771
00:30:38,690 --> 00:30:41,930
which ones you do the deep dive if

772
00:30:40,880 --> 00:30:43,220
you're going to do a deep dive and

773
00:30:41,930 --> 00:30:45,470
dedicate a

774
00:30:43,220 --> 00:30:47,480
full day or multiple days I'm doing

775
00:30:45,470 --> 00:30:49,280
forensics you should already have a

776
00:30:47,480 --> 00:30:52,640
pretty solid idea that that system has

777
00:30:49,280 --> 00:30:54,408
something malicious on it and some of

778
00:30:52,640 --> 00:30:56,870
our goals we're just making it scale

779
00:30:54,409 --> 00:30:58,580
fast being able to just have that

780
00:30:56,870 --> 00:31:02,928
ingestion and parsing happen

781
00:30:58,580 --> 00:31:04,158
automatically easy data manipulation so

782
00:31:02,929 --> 00:31:05,780
if you're a command-line guy you'd love

783
00:31:04,159 --> 00:31:08,179
to be able to slice and dice that data

784
00:31:05,780 --> 00:31:10,129
and then time lining so that's one of

785
00:31:08,179 --> 00:31:11,539
the things that you don't it's a little

786
00:31:10,130 --> 00:31:13,549
bit harder to do from the command line

787
00:31:11,539 --> 00:31:16,190
but with Splunk are similar applications

788
00:31:13,549 --> 00:31:19,100
it gives you a nice flash timeline at

789
00:31:16,190 --> 00:31:22,450
the top to be able to adjust your time

790
00:31:19,100 --> 00:31:22,449
line of the data that you're looking at

791
00:31:23,140 --> 00:31:27,820
so our application we ended up doing

792
00:31:26,330 --> 00:31:30,799
that in Splunk to give us the speed

793
00:31:27,820 --> 00:31:34,158
we've also looked at elk as well because

794
00:31:30,799 --> 00:31:35,840
that's even totally free you can do this

795
00:31:34,159 --> 00:31:37,760
analysis with this application and the

796
00:31:35,840 --> 00:31:39,918
free version of Splunk but I would

797
00:31:37,760 --> 00:31:42,679
definitely recommend you guys purchase

798
00:31:39,919 --> 00:31:44,720
it because it's a great tool but the

799
00:31:42,679 --> 00:31:47,270
output of as Reid said the output comes

800
00:31:44,720 --> 00:31:49,400
in CSV so really any one of your SEM

801
00:31:47,270 --> 00:31:50,900
products should be able in just CSV so

802
00:31:49,400 --> 00:31:53,419
it's not like you're locked into using

803
00:31:50,900 --> 00:31:57,350
Splunk or any particular product you

804
00:31:53,419 --> 00:32:00,440
could even use Excel so the thing that

805
00:31:57,350 --> 00:32:02,689
the thing to factor in when you're doing

806
00:32:00,440 --> 00:32:04,159
this though when you're collecting from

807
00:32:02,690 --> 00:32:06,620
all of your endpoints is this isn't a

808
00:32:04,159 --> 00:32:08,270
traditional SEM like collection where

809
00:32:06,620 --> 00:32:10,340
the data is just streaming in over time

810
00:32:08,270 --> 00:32:12,440
this is going to be a very very large

811
00:32:10,340 --> 00:32:16,189
burst of data and you need to plan

812
00:32:12,440 --> 00:32:18,950
appropriately for that and the app that

813
00:32:16,190 --> 00:32:21,980
we've put out here for free is very much

814
00:32:18,950 --> 00:32:23,210
LR centric host hunting so when you're

815
00:32:21,980 --> 00:32:26,000
during hunts obviously you're going to

816
00:32:23,210 --> 00:32:28,159
incorporate network and other system

817
00:32:26,000 --> 00:32:31,039
logs but for right now this one is just

818
00:32:28,159 --> 00:32:33,230
focused on the endpoint it's fairly easy

819
00:32:31,039 --> 00:32:35,450
to do within Splunk to create your own

820
00:32:33,230 --> 00:32:36,860
application so people may look at this

821
00:32:35,450 --> 00:32:38,390
and just use it as a reference if

822
00:32:36,860 --> 00:32:41,149
especially if you're already a customer

823
00:32:38,390 --> 00:32:43,010
and just pull out all of our queries and

824
00:32:41,150 --> 00:32:44,330
build a dashboard like ours and that's

825
00:32:43,010 --> 00:32:48,500
great that's what we would want you guys

826
00:32:44,330 --> 00:32:50,629
to do in terms of creating it it's super

827
00:32:48,500 --> 00:32:54,200
easy so you can you do it in an XML or

828
00:32:50,630 --> 00:32:55,620
just raw HTML and those are our goals at

829
00:32:54,200 --> 00:32:57,960
the at the bottom that we kind of

830
00:32:55,620 --> 00:32:59,459
solved with doing this application and

831
00:32:57,960 --> 00:33:01,620
mainly for us we already knew we could

832
00:32:59,460 --> 00:33:03,360
do it fast and we could pivot but for us

833
00:33:01,620 --> 00:33:04,590
it was making it a repeatable workflow

834
00:33:03,360 --> 00:33:06,330
so when you're bringing on a lot of

835
00:33:04,590 --> 00:33:08,010
junior people having a repeatable

836
00:33:06,330 --> 00:33:12,780
workflow that somebody can just execute

837
00:33:08,010 --> 00:33:15,240
over time makes you that much faster a

838
00:33:12,780 --> 00:33:16,740
quick little insight into the

839
00:33:15,240 --> 00:33:18,150
application so the primary thing that

840
00:33:16,740 --> 00:33:21,030
you're going to be hunting within here

841
00:33:18,150 --> 00:33:23,130
is module based hunting so each one of

842
00:33:21,030 --> 00:33:25,710
these modules corresponds to something

843
00:33:23,130 --> 00:33:28,490
within crowd response so you may hunt

844
00:33:25,710 --> 00:33:31,320
across directories and looking at hashes

845
00:33:28,490 --> 00:33:33,179
prefetch for evidence of execution all

846
00:33:31,320 --> 00:33:34,500
these modules are here and this would be

847
00:33:33,179 --> 00:33:36,750
the first place that you would go to

848
00:33:34,500 --> 00:33:40,140
start hunting because it's very very

849
00:33:36,750 --> 00:33:41,820
targeted it gives you that sniper

850
00:33:40,140 --> 00:33:43,470
forensics approach where you dial in

851
00:33:41,820 --> 00:33:48,450
really quickly and you try to get quick

852
00:33:43,470 --> 00:33:50,250
wins as opposed to the methodology based

853
00:33:48,450 --> 00:33:52,170
hunting which we've kind of based off of

854
00:33:50,250 --> 00:33:54,090
the kill chain to group to group and

855
00:33:52,170 --> 00:33:56,130
buckets our searches this is going to be

856
00:33:54,090 --> 00:33:57,389
broader so after you've done your module

857
00:33:56,130 --> 00:33:59,730
hunting which is a little more narrow

858
00:33:57,390 --> 00:34:01,830
scoped the methodology hunting is going

859
00:33:59,730 --> 00:34:03,750
to be broader and thus require more work

860
00:34:01,830 --> 00:34:05,399
you're gonna have to spend more time

861
00:34:03,750 --> 00:34:11,850
looking through that data to find the

862
00:34:05,400 --> 00:34:13,980
anomalies we did include something that

863
00:34:11,850 --> 00:34:15,449
we it's in under the Intel tab on the

864
00:34:13,980 --> 00:34:17,040
application but it's really just

865
00:34:15,449 --> 00:34:20,638
indicator management light I know

866
00:34:17,040 --> 00:34:22,199
everybody has the problem of trying to

867
00:34:20,639 --> 00:34:24,629
organize the millions and millions of

868
00:34:22,199 --> 00:34:26,040
indicators and I'm not really sold on

869
00:34:24,629 --> 00:34:28,168
that approach but you definitely want to

870
00:34:26,040 --> 00:34:30,750
get your indicators as close to your

871
00:34:28,168 --> 00:34:35,100
analysis as possible so we added this in

872
00:34:30,750 --> 00:34:37,770
here the there's several look-up tables

873
00:34:35,100 --> 00:34:42,290
in here that are gonna look for MD fives

874
00:34:37,770 --> 00:34:45,270
and look for stuff related to actors and

875
00:34:42,290 --> 00:34:47,279
known file names stuff like that and you

876
00:34:45,270 --> 00:34:48,780
can build upon this if you want and then

877
00:34:47,280 --> 00:34:50,820
if you go bigger if you want to get the

878
00:34:48,780 --> 00:34:52,590
million indicators look-up tables I

879
00:34:50,820 --> 00:34:54,600
believe right now max out at ten

880
00:34:52,590 --> 00:34:58,290
thousand entries so you'd want to go

881
00:34:54,600 --> 00:34:59,910
with a database and Reedus is one that

882
00:34:58,290 --> 00:35:01,800
Splunk integrates well with but there's

883
00:34:59,910 --> 00:35:04,890
plenty of others to choose if you want

884
00:35:01,800 --> 00:35:07,380
to scale your indicators past this I I

885
00:35:04,890 --> 00:35:09,390
personally like the approach of hunting

886
00:35:07,380 --> 00:35:10,700
with very targeted indicators

887
00:35:09,390 --> 00:35:13,019
instead of here at the kitchen sink

888
00:35:10,700 --> 00:35:19,769
because you may end up wasting time that

889
00:35:13,019 --> 00:35:21,089
way so now so we're gonna switch over to

890
00:35:19,769 --> 00:35:24,058
a demo video yep

891
00:35:21,089 --> 00:35:26,038
sorry about that all right so before we

892
00:35:24,059 --> 00:35:27,480
get too far into this video so you want

893
00:35:26,039 --> 00:35:30,990
to pause it for a second

894
00:35:27,480 --> 00:35:32,880
and so we've skipped over an important

895
00:35:30,990 --> 00:35:34,529
step for this case so we actually

896
00:35:32,880 --> 00:35:36,539
skipped over collection so as I

897
00:35:34,529 --> 00:35:38,640
mentioned before there's no one solution

898
00:35:36,539 --> 00:35:40,740
that works best for you but we're gonna

899
00:35:38,640 --> 00:35:42,598
cover all the steps after we've already

900
00:35:40,740 --> 00:35:43,308
had our collection we have our data to

901
00:35:42,599 --> 00:35:55,349
work with

902
00:35:43,309 --> 00:35:58,109
so but mostly let's go so we've got our

903
00:35:55,349 --> 00:35:59,579
seer convert tool so we've got five or

904
00:35:58,109 --> 00:36:01,200
our xml's collected from a few different

905
00:35:59,579 --> 00:36:03,150
machines and we're actually gonna go

906
00:36:01,200 --> 00:36:05,368
about converting that into a CSV format

907
00:36:03,150 --> 00:36:08,099
that we can actually work with on a

908
00:36:05,369 --> 00:36:10,859
regular basis so you can see me messing

909
00:36:08,099 --> 00:36:13,019
up the command line parameters so in

910
00:36:10,859 --> 00:36:16,740
this case I'm going to look at start at

911
00:36:13,019 --> 00:36:19,339
XML I'm gonna put it into CSV and I'm

912
00:36:16,740 --> 00:36:22,109
going to output into an ouch directory

913
00:36:19,339 --> 00:36:23,369
so now I check it out I've got my CSV s

914
00:36:22,109 --> 00:36:25,828
I'm ready to roll and start doing

915
00:36:23,369 --> 00:36:30,930
analysis so next were going to jump into

916
00:36:25,829 --> 00:36:33,029
the app itself so as I mentioned before

917
00:36:30,930 --> 00:36:37,618
we do have the indicator management

918
00:36:33,029 --> 00:36:40,740
functionality of just some for creating

919
00:36:37,619 --> 00:36:43,319
CSVs of your less than 10,000 indicator

920
00:36:40,740 --> 00:36:45,299
sets at a time to automatically search

921
00:36:43,319 --> 00:36:52,349
that data when we are creating our

922
00:36:45,299 --> 00:36:53,788
tables so next we're going to go back to

923
00:36:52,349 --> 00:36:58,049
the overview table because I did not cut

924
00:36:53,789 --> 00:36:59,549
the video properly you might ask

925
00:36:58,049 --> 00:37:01,829
yourself okay what machines have I

926
00:36:59,549 --> 00:37:03,180
collected from so we included a host tab

927
00:37:01,829 --> 00:37:05,789
just to get some very basic information

928
00:37:03,180 --> 00:37:08,038
about our separate hunts or our indexes

929
00:37:05,789 --> 00:37:09,450
and what machines are included us this

930
00:37:08,039 --> 00:37:12,990
includes like host name information

931
00:37:09,450 --> 00:37:15,210
version the time we collected the IP

932
00:37:12,990 --> 00:37:17,189
address that the machine had when we

933
00:37:15,210 --> 00:37:18,210
perform the collection and maybe the MAC

934
00:37:17,190 --> 00:37:21,960
address if you're looking at some

935
00:37:18,210 --> 00:37:24,359
network layer stuff so

936
00:37:21,960 --> 00:37:28,680
we're gonna dive into the modules so the

937
00:37:24,359 --> 00:37:29,848
first one the easy one is filed so for

938
00:37:28,680 --> 00:37:31,589
each of our modules we put together some

939
00:37:29,849 --> 00:37:34,250
pre-canned queries to look at your data

940
00:37:31,589 --> 00:37:37,380
now bear in mind this is not hunting

941
00:37:34,250 --> 00:37:39,150
these are some ideas - or these are

942
00:37:37,380 --> 00:37:41,130
things to give you some ideas on how to

943
00:37:39,150 --> 00:37:53,820
hunt your environment these are

944
00:37:41,130 --> 00:37:55,530
composite back go back to the zoom in so

945
00:37:53,820 --> 00:37:58,650
I've got a few hits for some file names

946
00:37:55,530 --> 00:38:01,650
in here so hmm I'm kind of new this ir

947
00:37:58,650 --> 00:38:09,780
game so do you guys know what m60 for

948
00:38:01,650 --> 00:38:13,170
dot exe is anybody shout it out so it's

949
00:38:09,780 --> 00:38:14,700
somewhere nothing yeah so Mimi cats a

950
00:38:13,170 --> 00:38:15,839
wait a second isn't there a second

951
00:38:14,700 --> 00:38:19,819
component that I can use to validate

952
00:38:15,839 --> 00:38:21,990
Mimi cats it's uh I don't know I

953
00:38:19,820 --> 00:38:23,730
what's that file that I can look for to

954
00:38:21,990 --> 00:38:29,910
validate that this actually is Mimi cats

955
00:38:23,730 --> 00:38:33,810
running in my environment nobody Sakura

956
00:38:29,910 --> 00:38:35,970
saw that DLL so for me me cats many cats

957
00:38:33,810 --> 00:38:37,560
Justin just doesn't run by itself so it

958
00:38:35,970 --> 00:38:40,439
actually needs the sacral saw to inject

959
00:38:37,560 --> 00:38:41,430
into LSS and to run its code granted

960
00:38:40,440 --> 00:38:42,690
that doesn't count when you're talking

961
00:38:41,430 --> 00:38:44,339
about PowerShell and some of the new

962
00:38:42,690 --> 00:38:47,580
versions of Muni cats but we're looking

963
00:38:44,339 --> 00:38:49,140
at the file sitting on disk here we also

964
00:38:47,580 --> 00:38:51,330
have some other file name indicators for

965
00:38:49,140 --> 00:38:57,569
some you see mm ocx but we'll have to

966
00:38:51,330 --> 00:38:59,250
look in that in a little bit so for our

967
00:38:57,570 --> 00:39:01,170
first set of tables we're looking at

968
00:38:59,250 --> 00:39:03,630
some node bad file names and known bad

969
00:39:01,170 --> 00:39:06,300
hashes so okay so I've got a hash match

970
00:39:03,630 --> 00:39:08,520
on the machines that collected from we

971
00:39:06,300 --> 00:39:10,260
also might want to look at some very

972
00:39:08,520 --> 00:39:11,820
large files in case these hackers are

973
00:39:10,260 --> 00:39:14,010
getting ready for exfil but nothing

974
00:39:11,820 --> 00:39:15,839
really pops out there we go some I want

975
00:39:14,010 --> 00:39:18,599
to look at an on job files written in

976
00:39:15,839 --> 00:39:22,020
our tasks folder but nothing too

977
00:39:18,599 --> 00:39:24,000
interesting there so as I come down to

978
00:39:22,020 --> 00:39:27,180
Exe ease and DLL sitting in a temp

979
00:39:24,000 --> 00:39:30,540
directory so I've got a media soft-eyed

980
00:39:27,180 --> 00:39:34,649
Exe and I've also got an MSI dot DLL so

981
00:39:30,540 --> 00:39:35,520
pretty suspicious doing my homework so

982
00:39:34,650 --> 00:39:37,380
this is actually a

983
00:39:35,520 --> 00:39:39,930
de panda indicator of them using the

984
00:39:37,380 --> 00:39:40,980
secure Elsa malware we have a blog post

985
00:39:39,930 --> 00:39:45,540
if you want to check it out and get some

986
00:39:40,980 --> 00:39:46,860
more information but fortunately we at

987
00:39:45,540 --> 00:39:49,230
least stumbled on this on our five

988
00:39:46,860 --> 00:39:52,140
machines and now we are much the wiser

989
00:39:49,230 --> 00:39:56,790
for being able to take action on those

990
00:39:52,140 --> 00:40:00,000
indicator hits so next we're going to

991
00:39:56,790 --> 00:40:02,790
hit up the registry so again this is our

992
00:40:00,000 --> 00:40:04,860
our deep information that has tons of

993
00:40:02,790 --> 00:40:08,009
different indicators that we can look

994
00:40:04,860 --> 00:40:12,090
for across our machines when we collect

995
00:40:08,010 --> 00:40:13,920
from this one this one data source so

996
00:40:12,090 --> 00:40:15,930
for our first item we're going to look

997
00:40:13,920 --> 00:40:17,550
at the current version run key so things

998
00:40:15,930 --> 00:40:19,440
set of a set those persistence and

999
00:40:17,550 --> 00:40:27,360
probably the most well known way to do

1000
00:40:19,440 --> 00:40:30,300
so pause so wait a second so so I see

1001
00:40:27,360 --> 00:40:32,460
service host but I thought it was

1002
00:40:30,300 --> 00:40:34,410
supposed to run with a dash K and I

1003
00:40:32,460 --> 00:40:37,410
don't know that looks a little strange

1004
00:40:34,410 --> 00:40:40,940
to me can does anybody recognize those

1005
00:40:37,410 --> 00:40:45,120
flags and what what that maybe is doing

1006
00:40:40,940 --> 00:40:47,310
there we go so we got the but but it but

1007
00:40:45,120 --> 00:40:51,330
it's service host how do I know it's

1008
00:40:47,310 --> 00:40:53,610
maybe netcat or what I don't know I'll

1009
00:40:51,330 --> 00:40:55,920
to dive into it later and validate that

1010
00:40:53,610 --> 00:40:59,780
that's the real service host or if

1011
00:40:55,920 --> 00:40:59,780
that's just some admin messing with me

1012
00:41:03,140 --> 00:41:09,390
so we also go about looking at the

1013
00:41:07,410 --> 00:41:10,830
binaries perspective so we also get the

1014
00:41:09,390 --> 00:41:13,170
hash for that value so we can check and

1015
00:41:10,830 --> 00:41:14,310
see if that's the real service host or

1016
00:41:13,170 --> 00:41:17,400
somebody else's replaced it with

1017
00:41:14,310 --> 00:41:19,140
something else we also do least

1018
00:41:17,400 --> 00:41:23,610
frequency on both that as well as

1019
00:41:19,140 --> 00:41:26,279
service dll's so yet another persistence

1020
00:41:23,610 --> 00:41:28,980
method where if you have a dll you can

1021
00:41:26,280 --> 00:41:31,890
establish persistence for that we also

1022
00:41:28,980 --> 00:41:33,960
look at which one of those files are

1023
00:41:31,890 --> 00:41:36,690
rare on a system so next we're going to

1024
00:41:33,960 --> 00:41:40,350
go into the new tasks module so picking

1025
00:41:36,690 --> 00:41:42,330
out my index and my machines so for this

1026
00:41:40,350 --> 00:41:47,750
we have a few different big queries

1027
00:41:42,330 --> 00:41:54,009
while looking at add jobs so

1028
00:41:47,750 --> 00:41:54,010
we've got to add jobs for a seat hmm

1029
00:41:54,640 --> 00:42:01,370
when we get back to the video so we had

1030
00:41:56,930 --> 00:42:05,000
to add jobs for D dot bat sitting in C

1031
00:42:01,370 --> 00:42:09,279
temp so I don't know I do you guys think

1032
00:42:05,000 --> 00:42:11,780
that's bad or kind of kind of normal

1033
00:42:09,280 --> 00:42:18,650
totally legit let's just roll on with it

1034
00:42:11,780 --> 00:42:21,530
okay so if you're on an older

1035
00:42:18,650 --> 00:42:23,420
architecture you can just replace a few

1036
00:42:21,530 --> 00:42:25,460
of those files with command ithc and get

1037
00:42:23,420 --> 00:42:29,060
the same functionality so whether it's

1038
00:42:25,460 --> 00:42:31,370
the on-screen keyboard or set HC for the

1039
00:42:29,060 --> 00:42:32,509
original sticky keys when you're dealing

1040
00:42:31,370 --> 00:42:34,160
with newer systems that have been

1041
00:42:32,510 --> 00:42:35,360
patched you have to take a few

1042
00:42:34,160 --> 00:42:36,980
additional steps to get the same

1043
00:42:35,360 --> 00:42:39,050
functionality so in this case we look

1044
00:42:36,980 --> 00:42:40,670
for bolt we look for when the debugger

1045
00:42:39,050 --> 00:42:43,640
value is set to something other than

1046
00:42:40,670 --> 00:42:44,990
what it should be as well as if the

1047
00:42:43,640 --> 00:42:47,410
original files have been replaced with

1048
00:42:44,990 --> 00:42:52,729
something that shouldn't be there

1049
00:42:47,410 --> 00:42:54,080
hit play so from that I do see some

1050
00:42:52,730 --> 00:42:57,530
replacement and probably want to look

1051
00:42:54,080 --> 00:43:01,910
into that we also have a module for

1052
00:42:57,530 --> 00:43:04,910
shrim cache so for this one we have some

1053
00:43:01,910 --> 00:43:06,529
pretty big queries to look at is their

1054
00:43:04,910 --> 00:43:10,250
execution in places that we shouldn't

1055
00:43:06,530 --> 00:43:11,420
see execution so is there things

1056
00:43:10,250 --> 00:43:13,310
executing from the recycle bin or

1057
00:43:11,420 --> 00:43:16,640
recycler so again I get my credentials

1058
00:43:13,310 --> 00:43:21,049
lemak tools and also our dot exe hmm a

1059
00:43:16,640 --> 00:43:23,690
little suspicious we also look at the

1060
00:43:21,050 --> 00:43:25,400
files from system 32 and temp so in this

1061
00:43:23,690 --> 00:43:27,410
case I've got some net commands and and

1062
00:43:25,400 --> 00:43:30,860
possibly some reconnaissance I'm going

1063
00:43:27,410 --> 00:43:34,160
to want to look into one thing we did

1064
00:43:30,860 --> 00:43:35,750
want to highlight with this is the 14

1065
00:43:34,160 --> 00:43:37,790
seconds that I killed of your time or

1066
00:43:35,750 --> 00:43:40,970
selecting our index and our data results

1067
00:43:37,790 --> 00:43:43,009
you can look forward through one or many

1068
00:43:40,970 --> 00:43:44,419
or a subset of the hosts that you

1069
00:43:43,010 --> 00:43:47,390
collect at any given time with our app

1070
00:43:44,420 --> 00:43:48,650
and it's really up to you to choose how

1071
00:43:47,390 --> 00:43:50,690
you want to go about looking at your

1072
00:43:48,650 --> 00:43:55,360
data but we do have the functionality to

1073
00:43:50,690 --> 00:43:55,360
look at one or many devices at one point

1074
00:43:56,020 --> 00:44:00,130
so if that that's the end of our demo

1075
00:44:04,690 --> 00:44:09,769
so let's have a quick recap so we have

1076
00:44:07,970 --> 00:44:11,629
some indicator hits for a deep panda

1077
00:44:09,769 --> 00:44:13,279
schoola malware if you want more

1078
00:44:11,630 --> 00:44:14,660
information on deep panda and their

1079
00:44:13,279 --> 00:44:17,660
information we've got some great

1080
00:44:14,660 --> 00:44:19,759
articles on the CrowdStrike blog we also

1081
00:44:17,660 --> 00:44:21,828
seen a credentials upper MCATs in this

1082
00:44:19,759 --> 00:44:24,200
case we've got persistence for a neck

1083
00:44:21,829 --> 00:44:26,539
hat listener we've also got the sticky

1084
00:44:24,200 --> 00:44:28,848
keys debugger set for command exe for

1085
00:44:26,539 --> 00:44:30,440
the on-screen keyboard we also have some

1086
00:44:28,849 --> 00:44:32,000
shim cache evidence of some possible

1087
00:44:30,440 --> 00:44:35,450
reconnaissance and maybe somebody

1088
00:44:32,000 --> 00:44:36,619
getting ready for exfiltration so these

1089
00:44:35,450 --> 00:44:39,259
are just some of the pre-canned queries

1090
00:44:36,619 --> 00:44:41,210
that we had before actually generating

1091
00:44:39,259 --> 00:44:43,009
this data so there's much much more in

1092
00:44:41,210 --> 00:44:44,450
it if you want to take a look feel free

1093
00:44:43,009 --> 00:44:46,670
to hit us up after the presentation and

1094
00:44:44,450 --> 00:44:52,220
we might be able to share what else we

1095
00:44:46,670 --> 00:44:53,799
have in our data set so that we like to

1096
00:44:52,220 --> 00:44:56,240
close out so again we've talked about

1097
00:44:53,799 --> 00:44:58,038
how we define hunting and what that

1098
00:44:56,240 --> 00:44:59,328
looks like from your operations we've

1099
00:44:58,039 --> 00:45:01,369
talked about doing collections with

1100
00:44:59,329 --> 00:45:03,500
crowd response our tool set as well as

1101
00:45:01,369 --> 00:45:05,809
getting ready to do some analysis with

1102
00:45:03,500 --> 00:45:11,599
it so that we like to open up to any

1103
00:45:05,809 --> 00:45:13,910
questions you guys might have yes so

1104
00:45:11,599 --> 00:45:17,509
this one can be published on our github

1105
00:45:13,910 --> 00:45:24,769
page at the conference and the question

1106
00:45:17,509 --> 00:45:26,000
was is this free or is it paid for when

1107
00:45:24,769 --> 00:45:27,680
you're doing something like frequency

1108
00:45:26,000 --> 00:45:29,240
analysis especially like auto runs like

1109
00:45:27,680 --> 00:45:30,950
you showed do you have a good way to

1110
00:45:29,240 --> 00:45:32,419
further refine that data to turn it into

1111
00:45:30,950 --> 00:45:35,058
alerts or is that something you prefer

1112
00:45:32,420 --> 00:45:36,380
to look at a dashboard for so that's

1113
00:45:35,059 --> 00:45:40,640
something we prefer to look at

1114
00:45:36,380 --> 00:45:42,349
dashboards for so for us this was meant

1115
00:45:40,640 --> 00:45:43,640
to be the intro to hunting so how do you

1116
00:45:42,349 --> 00:45:46,250
start the operations but are some stuff

1117
00:45:43,640 --> 00:45:47,779
you can look for as you get more mature

1118
00:45:46,250 --> 00:45:49,609
and you actually start collecting

1119
00:45:47,779 --> 00:45:51,319
autoruns information on a regular basis

1120
00:45:49,609 --> 00:45:53,660
that's when it could be refined into

1121
00:45:51,319 --> 00:45:55,190
your alerts so if you establish your

1122
00:45:53,660 --> 00:45:56,538
your known good and your whitelist and

1123
00:45:55,190 --> 00:45:59,599
you say okay anything that deviates from

1124
00:45:56,539 --> 00:46:01,460
this for new additions I'm gonna bash it

1125
00:45:59,599 --> 00:46:03,529
up against some other sources and then

1126
00:46:01,460 --> 00:46:07,430
alert if it stands out or if it doesn't

1127
00:46:03,529 --> 00:46:10,250
match on one of my other assets so as of

1128
00:46:07,430 --> 00:46:11,629
right now as the intro we just want to

1129
00:46:10,250 --> 00:46:13,099
look at some tables and get the very

1130
00:46:11,630 --> 00:46:14,480
basics for data but as you get more

1131
00:46:13,099 --> 00:46:15,050
mature and you get used to seeing the

1132
00:46:14,480 --> 00:46:17,060
same things

1133
00:46:15,050 --> 00:46:26,120
you can then automate that out and turn

1134
00:46:17,060 --> 00:46:28,900
it into alerts all right big round of

1135
00:46:26,120 --> 00:46:28,900
applause for these guys

