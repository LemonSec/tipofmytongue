1
00:00:00,600 --> 00:00:03,203
(dramatic music)

2
00:00:10,243 --> 00:00:14,047
(audience applause)

3
00:00:14,047 --> 00:00:16,082
- How many of you by
the way have ever read

4
00:00:16,082 --> 00:00:17,751
the little Bobby comic?
How many of you do that?

5
00:00:17,751 --> 00:00:19,152
A couple of you? Good.

6
00:00:19,152 --> 00:00:20,086
Remember though,

7
00:00:20,086 --> 00:00:21,955
I am the writer of the comic,

8
00:00:21,955 --> 00:00:23,456
I am not the illustrator.

9
00:00:23,456 --> 00:00:26,326
So I'm going to draw but
just keep that in balance.

10
00:00:27,727 --> 00:00:29,429
It's really, it seems
impressive I think to draw

11
00:00:29,429 --> 00:00:31,663
but what it really boils down
to is I suck at making slides,

12
00:00:31,664 --> 00:00:33,133
and I always forget
to make slides

13
00:00:33,133 --> 00:00:34,667
so it's just easier to
jump on stage and do this.

14
00:00:34,667 --> 00:00:35,935
But anyways,

15
00:00:35,935 --> 00:00:37,370
the talk today is really
about this discussion

16
00:00:37,370 --> 00:00:40,473
between hunting and
threat automation,

17
00:00:40,473 --> 00:00:42,308
and obviously threat
forming is sort of

18
00:00:42,308 --> 00:00:44,711
the piece we're
putting for that.

19
00:00:44,711 --> 00:00:47,981
And this debate extended
a couple years ago,

20
00:00:47,981 --> 00:00:51,017
and Alex and I actually
had kind of a dueling

21
00:00:51,017 --> 00:00:53,586
conference talk
at the CTI summit

22
00:00:53,586 --> 00:00:56,289
where he made the pitch for
automating threat hunting

23
00:00:56,289 --> 00:00:58,024
and I made the counter pitch of

24
00:00:58,024 --> 00:00:58,992
I'm sorry you can't,

25
00:00:58,992 --> 00:01:00,492
it's around the human driven,

26
00:01:00,493 --> 00:01:02,929
hypothesis driven
kind of approach.

27
00:01:02,929 --> 00:01:04,597
And then of course
here we are today

28
00:01:04,596 --> 00:01:08,268
coming together to try and
have a better approach,

29
00:01:08,268 --> 00:01:10,437
which is a nice little
blend for everybody.

30
00:01:11,571 --> 00:01:14,140
So starting off I
want to list a couple

31
00:01:14,140 --> 00:01:17,277
important concepts and
make the pitch on what

32
00:01:17,277 --> 00:01:20,980
exactly is that definitively
human kind of approach.

33
00:01:20,980 --> 00:01:23,249
And this is very
much an idea talk,

34
00:01:23,249 --> 00:01:24,250
this is not one
where we're going to

35
00:01:24,250 --> 00:01:25,718
throw a bunch of
command prompts,

36
00:01:25,718 --> 00:01:28,555
but it's a talk that I
think is good considering

37
00:01:28,555 --> 00:01:29,756
you're own security operations,

38
00:01:29,756 --> 00:01:31,224
you're own instant response,

39
00:01:31,224 --> 00:01:34,127
the only ways that you go
forward and do this next year.

40
00:01:34,127 --> 00:01:35,829
- [Alex] Yeah I think we
should just flip the slides

41
00:01:35,829 --> 00:01:38,431
to where you actually
start talking I guess.

42
00:01:38,431 --> 00:01:39,432
- Do you wanna do that?

43
00:01:39,432 --> 00:01:40,400
- [Alex] Yeah sure.

44
00:01:40,400 --> 00:01:41,367
- Alright go for it Alex,

45
00:01:41,367 --> 00:01:42,902
always making things difficult.

46
00:01:42,902 --> 00:01:43,803
- [Alex] It's like this is
too much going on right now.

47
00:01:43,803 --> 00:01:45,105
Just got papers,

48
00:01:45,105 --> 00:01:46,372
we got these slides,

49
00:01:46,372 --> 00:01:49,809
we got the camera so I
just want to make sure,

50
00:01:49,809 --> 00:01:51,211
I mean that's the title right?

51
00:01:51,211 --> 00:01:52,178
This is who we are.

52
00:01:52,178 --> 00:01:53,646
This is actually who we are.

53
00:01:53,646 --> 00:01:56,683
This is our actual day
jobs right there right.

54
00:01:56,683 --> 00:02:00,086
And I just want
to make sure that,

55
00:02:00,086 --> 00:02:02,722
and I mean I think Rob
did a great introduction.

56
00:02:02,722 --> 00:02:04,223
This has been about
a struggle right?

57
00:02:04,224 --> 00:02:06,526
We have been arm
wrestling about this

58
00:02:06,526 --> 00:02:08,394
for a very, very
long time right?

59
00:02:08,394 --> 00:02:10,196
And my belief is that,

60
00:02:10,196 --> 00:02:13,366
and this is usually where we
come down to most of the time

61
00:02:13,366 --> 00:02:15,668
is around terminology right?

62
00:02:15,668 --> 00:02:17,203
When I use some words

63
00:02:17,203 --> 00:02:18,905
and then Rob gets
pissed off with me

64
00:02:18,905 --> 00:02:20,640
because that's not
how you use that word,

65
00:02:20,640 --> 00:02:22,041
that's not what that word means,

66
00:02:22,041 --> 00:02:23,309
but we're just coming from

67
00:02:23,309 --> 00:02:24,911
completely different
perspectives right?

68
00:02:24,911 --> 00:02:25,979
- [Rob] He's wrong, I'm right.

69
00:02:25,979 --> 00:02:27,113
- Yeah.

70
00:02:27,113 --> 00:02:28,381
- [Rob] That's
usually what happens.

71
00:02:28,381 --> 00:02:31,251
- So one thing that I
specifically remember

72
00:02:31,251 --> 00:02:32,485
from our discussions,

73
00:02:32,485 --> 00:02:37,390
was that I always told
him that his definition

74
00:02:38,591 --> 00:02:40,059
of threat hunting was
always very cyclical.

75
00:02:40,059 --> 00:02:43,930
As in threat hunting
is actually the act

76
00:02:43,930 --> 00:02:48,134
of humans finding what
automation missed.

77
00:02:48,134 --> 00:02:49,768
And I'm like hold on a second,

78
00:02:49,769 --> 00:02:52,872
what if I find something
and then I automate it,

79
00:02:52,872 --> 00:02:54,707
but it's like it's
super complicated

80
00:02:54,707 --> 00:02:57,577
threat huntingish
kind of thing right?

81
00:02:57,577 --> 00:02:59,212
Suddenly it's not
threat hunting anymore,

82
00:02:59,212 --> 00:03:03,048
suddenly it's just automation
and it's not hunting.

83
00:03:03,049 --> 00:03:05,618
So this is where we usually had

84
00:03:05,618 --> 00:03:06,719
most of our disagreements.

85
00:03:06,719 --> 00:03:08,188
- And neither,

86
00:03:08,188 --> 00:03:09,422
nobody should actually
listen to either one of us

87
00:03:09,422 --> 00:03:13,393
on words because English
is a second language,

88
00:03:13,393 --> 00:03:14,327
I'm from Alabama,

89
00:03:14,327 --> 00:03:15,828
English is a second language.

90
00:03:15,828 --> 00:03:19,699
Words are difficult folks
but I think it matters.

91
00:03:19,699 --> 00:03:20,833
So yeah perfect.

92
00:03:20,833 --> 00:03:22,702
Do you wanna jump into it then?

93
00:03:22,702 --> 00:03:23,970
- Yeah, I just-

94
00:03:23,970 --> 00:03:24,637
- We're like Bert and
Ernie up here I think.

95
00:03:24,637 --> 00:03:25,872
- I guess.

96
00:03:25,872 --> 00:03:28,641
So I guess the main
point that we had,

97
00:03:28,641 --> 00:03:30,643
and as we were talking
through this is that

98
00:03:30,643 --> 00:03:33,213
I guess the main part
was for us trying

99
00:03:33,213 --> 00:03:35,215
to found this boundary right?

100
00:03:35,215 --> 00:03:37,617
And we came across an
interesting concept

101
00:03:37,617 --> 00:03:41,019
that I want Rob to expand
a little bit about,

102
00:03:41,020 --> 00:03:43,289
about the difference
between actual

103
00:03:43,289 --> 00:03:45,357
strategic threat hunting

104
00:03:46,759 --> 00:03:48,393
and something that's a
little bit more technical.

105
00:03:48,394 --> 00:03:50,730
So Rob because of
his background,

106
00:03:50,730 --> 00:03:52,798
usually thinks of things
a more strategically.

107
00:03:52,799 --> 00:03:55,768
He has a lot of intelligence
background as well.

108
00:03:55,768 --> 00:03:57,103
And I'm a data guy.

109
00:03:57,103 --> 00:03:58,738
I like to get my
hands dirty on data.

110
00:03:58,738 --> 00:04:01,074
I'm always concerned
like how can I extract

111
00:04:01,074 --> 00:04:02,308
value from these things.

112
00:04:02,308 --> 00:04:05,078
So I always have this
kind of a bottom up

113
00:04:05,078 --> 00:04:06,913
on his coming from the top down.

114
00:04:06,913 --> 00:04:08,248
So this is where,

115
00:04:08,248 --> 00:04:10,149
this is the slide
where Rob talks about

116
00:04:10,149 --> 00:04:12,151
all the strategy
that he- (Rob laughs)

117
00:04:12,151 --> 00:04:14,487
- [Rob] Right adnd then Viv
hasn't started the clock yet,

118
00:04:14,487 --> 00:04:15,722
which tells me that
we get to speak

119
00:04:15,722 --> 00:04:16,990
for a couple hours.

120
00:04:16,990 --> 00:04:17,857
- [Alex] Yes. - [Rob]
So we're gonna be here

121
00:04:17,857 --> 00:04:19,025
for a little bit.

122
00:04:19,024 --> 00:04:22,361
Anyway so let's
explore this concept.

123
00:04:22,362 --> 00:04:24,797
To do justice by this
discussion of threat hunting.

124
00:04:24,797 --> 00:04:26,733
I want to introduce a
couple other concepts.

125
00:04:26,733 --> 00:04:28,801
You might have seen
me give presentations

126
00:04:28,801 --> 00:04:30,003
on them before,

127
00:04:30,003 --> 00:04:31,738
if you haven't they're
available online.

128
00:04:31,738 --> 00:04:33,973
But generally speaking when
I think of threat hunting

129
00:04:33,973 --> 00:04:35,375
and we'll get to that
kind of discussion

130
00:04:35,375 --> 00:04:36,876
on threat hinting in a second,

131
00:04:38,044 --> 00:04:40,113
I put it into this context of

132
00:04:40,113 --> 00:04:42,815
three different ways to
generate these hypothesis

133
00:04:42,815 --> 00:04:45,618
and Bianco and I
had nice sands paper

134
00:04:45,618 --> 00:04:47,553
about those three types,

135
00:04:47,553 --> 00:04:49,922
which was effectively
domain expertise,

136
00:04:49,922 --> 00:04:53,126
it was situation awareness
and it was intelligence.

137
00:04:53,126 --> 00:04:56,596
The three different forms
of hypothesis generation.

138
00:04:56,596 --> 00:04:57,830
In other words,

139
00:04:57,830 --> 00:04:59,399
I might have done this
so many times before

140
00:04:59,399 --> 00:05:01,100
that I'm good at doing this,

141
00:05:01,100 --> 00:05:02,969
but just saying like oh,

142
00:05:02,969 --> 00:05:06,372
it just came to me in a dream
is not any bit scientific

143
00:05:06,372 --> 00:05:08,941
it's this discussion of
I've seen this before

144
00:05:08,941 --> 00:05:10,476
therefore I now know

145
00:05:10,476 --> 00:05:12,178
that I should go hunting for it.

146
00:05:12,178 --> 00:05:14,914
Situation awareness
can be anything outside

147
00:05:14,914 --> 00:05:17,417
the discussions of just
purely technical components.

148
00:05:17,417 --> 00:05:20,686
It might be this idea that
I have a power company

149
00:05:20,687 --> 00:05:23,256
that are acquiring a
gas pipeline company

150
00:05:23,256 --> 00:05:25,792
and my hypothesis is
because of that acquisition

151
00:05:25,792 --> 00:05:27,292
they're already compromised.

152
00:05:27,293 --> 00:05:29,329
I'm going to see lateral
movement through a VPN

153
00:05:29,329 --> 00:05:30,563
getting connected in.

154
00:05:30,563 --> 00:05:33,265
Some of you will go hunt
what I perceive to be

155
00:05:33,266 --> 00:05:35,601
adversary activity moving
into my environment

156
00:05:35,601 --> 00:05:37,603
based on the
situation around us.

157
00:05:37,603 --> 00:05:38,905
And then intelligence driven

158
00:05:38,905 --> 00:05:40,840
can be both friendly
and threat intelligence.

159
00:05:40,840 --> 00:05:42,207
But this is actually
where a lot of us

160
00:05:42,208 --> 00:05:43,309
put our focus.

161
00:05:43,309 --> 00:05:44,344
So even though I come from

162
00:05:44,344 --> 00:05:45,844
a more intelligence background

163
00:05:45,845 --> 00:05:48,247
and like that component
of hypothesis generation,

164
00:05:48,247 --> 00:05:49,949
just know your own gaps.

165
00:05:49,949 --> 00:05:52,018
If you're constantly
coming up with intelligence

166
00:05:52,018 --> 00:05:53,285
based hunting,

167
00:05:53,286 --> 00:05:54,821
you should then try to
flush out your skills

168
00:05:54,821 --> 00:05:57,223
to go more towards
situation awareness

169
00:05:57,223 --> 00:05:58,658
also look for things
that I've heard before

170
00:05:58,658 --> 00:05:59,926
from demand expertise.

171
00:05:59,926 --> 00:06:01,094
But the other thing that
I think is important,

172
00:06:01,094 --> 00:06:02,895
is this concept of CMF's,

173
00:06:02,895 --> 00:06:05,465
activity groups,
analytical coverage

174
00:06:05,465 --> 00:06:06,732
and environmental coverage.

175
00:06:06,733 --> 00:06:08,768
So let's go through
those really quick.

176
00:06:10,203 --> 00:06:13,039
One of the things that it
think a lot of companies

177
00:06:13,039 --> 00:06:14,741
and organizations
should start doing

178
00:06:14,741 --> 00:06:16,976
a little bit better if
they're going to go forward

179
00:06:16,976 --> 00:06:18,211
and do hunting,

180
00:06:18,211 --> 00:06:19,979
is having a pretty
decent understanding

181
00:06:19,979 --> 00:06:21,381
of their environment.

182
00:06:21,381 --> 00:06:22,849
That's kind of table
stakes and we all say that,

183
00:06:22,849 --> 00:06:23,783
we say oh,

184
00:06:23,783 --> 00:06:25,017
critical control number one,

185
00:06:25,017 --> 00:06:26,586
have an asset inventory.

186
00:06:26,586 --> 00:06:27,954
But I find is I got to companies

187
00:06:27,954 --> 00:06:28,788
and I ask them what's
in their asset inventory

188
00:06:28,788 --> 00:06:30,123
and they're like oh,

189
00:06:30,123 --> 00:06:32,158
the firmware level
of our devices.

190
00:06:32,158 --> 00:06:34,260
Like cool what are
you using that for?

191
00:06:34,260 --> 00:06:35,228
I don't know,

192
00:06:35,228 --> 00:06:36,195
it's in our asset inventory.

193
00:06:36,195 --> 00:06:37,363
We're supposed to have that.

194
00:06:37,363 --> 00:06:39,899
But how are you actually
making that useful

195
00:06:39,899 --> 00:06:40,733
to security?

196
00:06:41,634 --> 00:06:42,869
Rob stop it,

197
00:06:42,869 --> 00:06:43,669
it says right here
on the checklist

198
00:06:43,669 --> 00:06:45,204
I need to have firmware.

199
00:06:45,204 --> 00:06:47,039
Okay man. So what I prefer
you to get in the habit of

200
00:06:47,039 --> 00:06:49,609
is kind of an asset
inventory with a purpose

201
00:06:49,609 --> 00:06:51,978
towards security operations
and instant response.

202
00:06:51,978 --> 00:06:53,813
A lot of asset inventory's
that have previously

203
00:06:53,813 --> 00:06:56,783
existed had more of
a product security of

204
00:06:56,783 --> 00:06:59,719
let me go path vulnerabilities
in my inventory.

205
00:06:59,719 --> 00:07:00,986
So if we're going
to be doing hunting,

206
00:07:00,987 --> 00:07:02,789
we want to go a little
bit further than that.

207
00:07:02,789 --> 00:07:04,524
And what I would request
and kind of put forward,

208
00:07:04,524 --> 00:07:06,659
is I should not only have,

209
00:07:06,659 --> 00:07:08,995
I told you I'm not the artist,

210
00:07:08,995 --> 00:07:11,230
what I prefer you to have,

211
00:07:11,230 --> 00:07:15,635
is almost a matrix
of what do I have?

212
00:07:15,635 --> 00:07:17,236
Sort of where is it?

213
00:07:17,236 --> 00:07:19,070
So I might say that this is a,

214
00:07:19,071 --> 00:07:20,239
and I'm a ICS guy,

215
00:07:20,239 --> 00:07:23,109
so I might have a
human-machine interface

216
00:07:23,109 --> 00:07:26,479
outside of a distribution
level substation.

217
00:07:27,480 --> 00:07:28,981
And so you'll go through

218
00:07:28,981 --> 00:07:31,350
and say where are these
devices actually located.

219
00:07:31,350 --> 00:07:33,319
What am I actually
talking about?

220
00:07:33,319 --> 00:07:36,088
You'll go through and then
you'll say okay well what is it?

221
00:07:36,088 --> 00:07:37,490
Like I said it's an HMI.

222
00:07:37,490 --> 00:07:39,792
Like alright well
what type of data

223
00:07:39,792 --> 00:07:41,027
can I get off of it?

224
00:07:41,027 --> 00:07:42,794
Well it comes with
the Windows logs

225
00:07:42,795 --> 00:07:44,397
that are actually on the HMI.

226
00:07:44,397 --> 00:07:45,897
Well how long am I storing it?

227
00:07:45,898 --> 00:07:47,733
Well I have 30
days of those logs.

228
00:07:47,733 --> 00:07:50,470
And cool where can I go to next?

229
00:07:50,470 --> 00:07:51,904
Where can I pivot?

230
00:07:51,904 --> 00:07:53,806
Oh if I really needed I could
also do a memory sample.

231
00:07:53,806 --> 00:07:56,575
Like okay and then because
I didn't draw enough blocks,

232
00:07:56,576 --> 00:07:58,211
I might also say well great,

233
00:07:58,211 --> 00:08:00,646
what type of questions
can I ask of that data?

234
00:08:00,646 --> 00:08:02,648
And I might even just break
it down and like kill chain,

235
00:08:02,648 --> 00:08:03,850
you can use tack,

236
00:08:03,850 --> 00:08:06,018
or whatever else on
what types of questions

237
00:08:06,018 --> 00:08:08,020
am I gonna ask of this data

238
00:08:08,020 --> 00:08:10,121
and later on I might even
be able to hot link those

239
00:08:10,122 --> 00:08:11,724
in the playbooks that I make

240
00:08:11,724 --> 00:08:13,359
as a result of my hunting

241
00:08:13,359 --> 00:08:15,895
for other analysts
to then follow along.

242
00:08:15,895 --> 00:08:17,996
And in doing this I go through

243
00:08:17,997 --> 00:08:19,732
my overall environment
and see like

244
00:08:19,732 --> 00:08:21,868
RTU's are basically
you're field devices

245
00:08:21,868 --> 00:08:23,536
at that same substation.

246
00:08:23,536 --> 00:08:25,538
I see that I have
the main controllers

247
00:08:25,538 --> 00:08:27,039
at the control center.

248
00:08:27,039 --> 00:08:29,241
I start going through and
filling out everything.

249
00:08:29,242 --> 00:08:31,177
What I really want to get to

250
00:08:31,177 --> 00:08:34,847
is an ability to then start
hunting across this data.

251
00:08:34,847 --> 00:08:36,249
And so I might take
an activity group,

252
00:08:36,249 --> 00:08:37,683
which are different
than the threat actors.

253
00:08:37,683 --> 00:08:39,818
That's another
presentation out there.

254
00:08:39,818 --> 00:08:43,188
But effectively the basic
way to think about that

255
00:08:43,188 --> 00:08:44,423
is threat actors,

256
00:08:44,423 --> 00:08:47,326
like APT29 is a
discussion of who.

257
00:08:47,326 --> 00:08:48,628
It's an attribution discussion.

258
00:08:48,628 --> 00:08:49,996
Not necessarily rush
or whatever else,

259
00:08:49,996 --> 00:08:51,130
but it's an attribution like

260
00:08:51,130 --> 00:08:52,598
this is ABT29,

261
00:08:52,598 --> 00:08:55,101
and as things
change there's value

262
00:08:55,101 --> 00:08:56,536
and there's different
indulgence requirements

263
00:08:56,536 --> 00:08:59,805
and constantly tracking
APT29 over the years

264
00:08:59,805 --> 00:09:01,239
and seeing all the
things they do.

265
00:09:01,240 --> 00:09:03,776
Activity groups are
a discussion of how.

266
00:09:03,776 --> 00:09:06,545
And so they're purposely
bound to the diamond model,

267
00:09:06,546 --> 00:09:09,248
which is effectively just
what's the trade craft,

268
00:09:09,248 --> 00:09:10,182
what's the infrastructure,

269
00:09:10,182 --> 00:09:11,117
and what's the victimology?

270
00:09:11,117 --> 00:09:12,919
And as those things change,

271
00:09:12,919 --> 00:09:14,287
I'll actually do a
new activity group

272
00:09:14,287 --> 00:09:16,589
Because I want to have a
bounding that I can then

273
00:09:16,589 --> 00:09:19,992
tell somebody I want you
to protect against Electrum

274
00:09:19,992 --> 00:09:21,459
and that means something to you

275
00:09:21,460 --> 00:09:23,763
instead of having
follow on questions on

276
00:09:23,763 --> 00:09:24,664
well what year,

277
00:09:24,664 --> 00:09:25,464
what malware,

278
00:09:25,464 --> 00:09:26,632
what victim,

279
00:09:26,632 --> 00:09:28,501
what other things about
that threat actor?

280
00:09:28,501 --> 00:09:29,468
In other words threat actors

281
00:09:29,468 --> 00:09:30,636
from a defense standpoint,

282
00:09:30,636 --> 00:09:31,971
have too many
follow on questions

283
00:09:31,971 --> 00:09:34,073
to be useful in my
opinion to defenders

284
00:09:34,073 --> 00:09:36,375
and activity groups will kind
of clump that a little better.

285
00:09:36,375 --> 00:09:39,145
So I'll take an activity
group and look for

286
00:09:39,145 --> 00:09:41,646
a trade craft that
they're accomplishing

287
00:09:41,647 --> 00:09:43,883
and I will end up
turning that into

288
00:09:43,883 --> 00:09:45,184
an intelligence driven hunt.

289
00:09:45,184 --> 00:09:48,853
I'll say okay well
if my activity group

290
00:09:48,854 --> 00:09:50,623
were going to compromise us,

291
00:09:52,758 --> 00:09:54,827
and I were to go
hunting for them

292
00:09:54,827 --> 00:09:56,762
would I be successful or not?

293
00:09:56,762 --> 00:09:58,964
And so before you ever
do the threat hunt,

294
00:09:58,965 --> 00:10:02,969
which is human driven
and very intensive.

295
00:10:02,969 --> 00:10:04,971
It is a time
consuming component.

296
00:10:04,971 --> 00:10:06,339
Before I ever go do that,

297
00:10:06,339 --> 00:10:08,174
I can look at my collection
manager framework

298
00:10:08,174 --> 00:10:09,875
and go well if they were
going to compromise us,

299
00:10:09,875 --> 00:10:11,377
here's where they
would compromise us.

300
00:10:11,377 --> 00:10:13,613
Here's the trade craft
we've seen before

301
00:10:13,613 --> 00:10:15,114
and I can got through
and bounce around

302
00:10:15,114 --> 00:10:17,917
and go well actually,
we don't have the data

303
00:10:17,917 --> 00:10:20,853
to actually validate that hunt.

304
00:10:20,853 --> 00:10:22,488
We'll never be successful

305
00:10:22,488 --> 00:10:24,357
based on the data
we're collecting today.

306
00:10:24,357 --> 00:10:26,125
So I can avoid hunting.

307
00:10:26,125 --> 00:10:27,660
Which is one of my big pitches

308
00:10:27,660 --> 00:10:29,028
around threat hunting in general

309
00:10:29,028 --> 00:10:31,631
is make sure you
avoid it at all costs.

310
00:10:31,631 --> 00:10:33,733
If it's going to waste a lot
of your time and resources.

311
00:10:33,733 --> 00:10:36,301
Don't go on a hunt that
you couldn't ever return

312
00:10:36,302 --> 00:10:38,337
any value to the organization
in the first place.

313
00:10:38,337 --> 00:10:39,872
And just looking at
this I can go oh,

314
00:10:39,872 --> 00:10:42,174
well we need to increase
or logging here.

315
00:10:42,174 --> 00:10:43,442
We need to have,

316
00:10:43,442 --> 00:10:44,744
go from thirty days
or seven days here

317
00:10:44,744 --> 00:10:47,013
to maybe thirty to
match it across.

318
00:10:47,013 --> 00:10:49,348
I'm going to start getting
an understanding of that

319
00:10:49,348 --> 00:10:52,251
environment and that
ability to hunt.

320
00:10:52,251 --> 00:10:54,185
But then I also want you
to consider analytical

321
00:10:54,186 --> 00:10:56,856
coverage and
environmental coverage.

322
00:10:56,856 --> 00:10:58,124
Environmental coverage,

323
00:10:58,124 --> 00:10:59,458
the easiest way to
think about that

324
00:10:59,458 --> 00:11:02,060
is when somebody hands
you an indicator,

325
00:11:02,061 --> 00:11:04,930
and then you put into the
SEM and you hit search

326
00:11:04,930 --> 00:11:06,265
and nothing comes
back and you go,

327
00:11:06,265 --> 00:11:08,100
turns out I'm not compromised.

328
00:11:08,100 --> 00:11:09,702
We all know there's
a problem there.

329
00:11:09,702 --> 00:11:12,104
The problem is may not have
been collecting the data

330
00:11:12,104 --> 00:11:13,506
from the portions
of your environment

331
00:11:13,506 --> 00:11:14,906
that could've ever
returned a positive answer

332
00:11:14,907 --> 00:11:16,976
in the first place so
that indicator sweep

333
00:11:16,976 --> 00:11:19,445
means nothing in the
organization because you

334
00:11:19,445 --> 00:11:22,148
don't understand your
environmental coverage.

335
00:11:22,148 --> 00:11:23,916
You should have good
understanding that well,

336
00:11:23,916 --> 00:11:27,720
across all of my
security architecture

337
00:11:27,720 --> 00:11:30,489
I have these devices that
give me this coverage,

338
00:11:30,489 --> 00:11:31,657
this device has this coverage,

339
00:11:31,657 --> 00:11:32,992
here's my gap.

340
00:11:32,992 --> 00:11:36,228
Which means only
65% of my collection

341
00:11:36,228 --> 00:11:38,497
could even return a
positive answer on

342
00:11:38,497 --> 00:11:40,266
the question that I'm asking.

343
00:11:40,266 --> 00:11:42,801
And then you'll get to
an analytical coverage

344
00:11:42,802 --> 00:11:44,336
which goes and says alright,

345
00:11:44,336 --> 00:11:46,272
well I'm looking for
a specific threat

346
00:11:46,272 --> 00:11:47,773
in my environment,

347
00:11:47,773 --> 00:11:50,609
but I'm looking for one
aspect of their trade craft.

348
00:11:50,609 --> 00:11:52,411
And this is where I think
the machine learning AI,

349
00:11:52,411 --> 00:11:53,679
kind of discussion,

350
00:11:53,679 --> 00:11:55,247
obviously learned
interchangeably

351
00:11:55,247 --> 00:11:56,382
because machine learning and
AI is the exact same thing.

352
00:11:56,382 --> 00:11:57,315
(Alex growls) I know okay.

353
00:11:58,517 --> 00:12:00,286
This is where I think
there's a little bit

354
00:12:00,286 --> 00:12:02,287
of mis-characterization
when someone will go well,

355
00:12:02,288 --> 00:12:05,658
how are you going to detect
the unknown-known-knowns

356
00:12:05,658 --> 00:12:10,196
with trade craft
because unknown-unknowns

357
00:12:10,196 --> 00:12:11,697
haven't occurred yet.

358
00:12:11,697 --> 00:12:13,165
You're like yeah, and I
don't know how many of you

359
00:12:13,165 --> 00:12:14,366
have been in these
product pitches,

360
00:12:14,366 --> 00:12:16,401
but it gets quite
religious with folks.

361
00:12:16,402 --> 00:12:18,637
Where like only machine
learning can detect this

362
00:12:18,637 --> 00:12:20,539
because you haven't
observed it before.

363
00:12:20,539 --> 00:12:23,275
And that's actually a
misunderstanding of analytics

364
00:12:23,275 --> 00:12:24,910
and kind of the
trade craft focus,

365
00:12:24,910 --> 00:12:27,445
which is as I have an
adversary's kill chain,

366
00:12:27,446 --> 00:12:28,914
there you go that
magic word again.

367
00:12:28,914 --> 00:12:30,449
As I have an
adversary's kill chain

368
00:12:30,449 --> 00:12:32,617
I don't really care about
protecting every component

369
00:12:32,618 --> 00:12:33,886
of everything they do,

370
00:12:33,886 --> 00:12:35,554
I care about having
analytical coverage,

371
00:12:35,554 --> 00:12:36,789
or trade craft coverage

372
00:12:36,789 --> 00:12:38,723
to say if they do
this step I got it,

373
00:12:38,724 --> 00:12:39,725
if they do this step I got it.

374
00:12:39,725 --> 00:12:40,960
if they do this step I got it.

375
00:12:40,960 --> 00:12:44,864
They might be novel
in one or two or three

376
00:12:44,864 --> 00:12:46,699
aspects of their attack,

377
00:12:46,699 --> 00:12:49,635
but they're not going to be
novel in every single step.

378
00:12:49,635 --> 00:12:51,804
So it's not like I have
to have machine learning

379
00:12:51,804 --> 00:12:54,006
to then go and detect anything.

380
00:12:54,006 --> 00:12:57,510
I've gotta be reliable in
my detection in one location

381
00:12:57,510 --> 00:12:59,879
and then I pivot
the investigation

382
00:12:59,879 --> 00:13:01,113
and see everything else.

383
00:13:01,113 --> 00:13:02,047
- [Alex] And look
for the other stuff.

384
00:13:02,047 --> 00:13:03,182
- [Rob] It's this discussion

385
00:13:03,182 --> 00:13:04,383
that through
analytical coverage,

386
00:13:04,383 --> 00:13:06,285
defenders actually
have that upper hand.

387
00:13:06,285 --> 00:13:08,219
This old adage of well
adversary's only have to

388
00:13:08,220 --> 00:13:10,222
get it right one time
and defenders have to

389
00:13:10,222 --> 00:13:12,691
get it right every
time is stupid

390
00:13:12,691 --> 00:13:15,127
and is a product pitch and
you must move backwards

391
00:13:15,127 --> 00:13:17,463
from that and realize
that you just have

392
00:13:17,463 --> 00:13:19,832
to detect one thing
reliably and you'll be fine.

393
00:13:19,832 --> 00:13:21,033
So how does that
relate to hunting

394
00:13:21,033 --> 00:13:22,201
and kind of what
we're talking about.

395
00:13:22,201 --> 00:13:23,369
So let's so an example,

396
00:13:23,369 --> 00:13:24,970
and then he's
going to go through

397
00:13:24,970 --> 00:13:26,839
kind of where the machine
learning piece is.

398
00:13:26,839 --> 00:13:29,408
I would put forth the evaluation

399
00:13:29,408 --> 00:13:30,810
of my environmental coverage,

400
00:13:30,810 --> 00:13:32,277
my analytical coverage,

401
00:13:32,278 --> 00:13:35,514
the development of the trade
craft hypothesis itself

402
00:13:35,514 --> 00:13:38,217
is distinctly human.

403
00:13:38,217 --> 00:13:39,451
I'm going to use automation.

404
00:13:39,451 --> 00:13:41,020
I'm going to use a lot
of things that help

405
00:13:41,020 --> 00:13:42,555
me scale that out.

406
00:13:42,555 --> 00:13:44,622
But the I'm sitting
down identifying

407
00:13:44,623 --> 00:13:45,558
what's going on,

408
00:13:45,558 --> 00:13:47,159
doing intelligence analysis

409
00:13:47,159 --> 00:13:49,295
and then creating that
hypothesis after the fact

410
00:13:49,295 --> 00:13:51,229
is the human component.

411
00:13:51,230 --> 00:13:54,099
So let's take
tangible case study

412
00:13:54,099 --> 00:13:56,001
that happened this past year.

413
00:13:56,001 --> 00:13:58,771
In 2017 there was an attack

414
00:13:58,771 --> 00:14:01,906
in a petrochemical
facility in Saudi Arabia.

415
00:14:01,907 --> 00:14:03,676
That attack was,

416
00:14:03,676 --> 00:14:05,511
used a piece of malware.

417
00:14:05,511 --> 00:14:06,911
Firite called it Triton,

418
00:14:06,912 --> 00:14:09,181
my firm Dragos called it TRISUS.

419
00:14:09,181 --> 00:14:10,583
We actually didn't coordinate,

420
00:14:10,583 --> 00:14:11,516
yeah I'll bring it down.

421
00:14:11,517 --> 00:14:13,686
We didn't coordinate (mumbles)

422
00:14:13,686 --> 00:14:15,221
It wasn't just being
competitive on names

423
00:14:15,221 --> 00:14:17,623
it's just we didn't know each
other were tracking the case.

424
00:14:17,623 --> 00:14:20,025
Either way I'm going to
refer to it as TRISIS

425
00:14:20,025 --> 00:14:21,459
from here on but you
might have seen that.

426
00:14:21,460 --> 00:14:23,229
For some reason DHS
then got involved

427
00:14:23,229 --> 00:14:24,330
and said we're going
to call it Hatman,

428
00:14:24,330 --> 00:14:25,698
which I don't understand why,

429
00:14:25,698 --> 00:14:27,466
and we're going to
do away with that,

430
00:14:27,466 --> 00:14:28,901
good job DHS.

431
00:14:28,901 --> 00:14:33,271
Anyway so TRISIS effectively
had a very simple MO.

432
00:14:33,272 --> 00:14:35,841
Very, very simple way of
the adversary use this.

433
00:14:36,976 --> 00:14:38,477
In a petrochemical environment,

434
00:14:38,477 --> 00:14:40,913
you might have your
enterprise IT environment.

435
00:14:42,381 --> 00:14:43,482
And we're just going
to say that that's

436
00:14:43,482 --> 00:14:45,818
a big abstraction of filth

437
00:14:45,818 --> 00:14:47,819
that I don't want
to touch my ICS.

438
00:14:47,820 --> 00:14:49,922
Because obviously the
IT stuff is worse.

439
00:14:49,922 --> 00:14:53,359
Anyways but going into
my operations technology

440
00:14:53,359 --> 00:14:55,794
or ICS networks,

441
00:14:56,962 --> 00:14:58,764
I then might have
VPN from enterprise

442
00:14:58,764 --> 00:15:01,066
in the IT or into OT,

443
00:15:01,066 --> 00:15:02,835
and then once I hit that VPN,

444
00:15:02,835 --> 00:15:05,437
the adversary
effectively popped over,

445
00:15:05,437 --> 00:15:07,439
if there wasn't a main
controller they went after it.

446
00:15:07,439 --> 00:15:08,741
Then they did lateral movement

447
00:15:08,741 --> 00:15:10,009
over to the engineering
work station,

448
00:15:10,009 --> 00:15:12,144
which is where I would
program the equipment.

449
00:15:12,144 --> 00:15:14,013
Actually introduce new logic.

450
00:15:14,013 --> 00:15:15,915
And off of the
engineer work station,

451
00:15:15,915 --> 00:15:18,317
they'd look for a safety
instrumented system.

452
00:15:18,317 --> 00:15:19,652
A safety instrumented system,

453
00:15:19,652 --> 00:15:20,953
easiest way to think about this,

454
00:15:20,953 --> 00:15:22,588
is that a piece of equipment

455
00:15:22,588 --> 00:15:25,424
in an industrial
environment that only exists

456
00:15:25,424 --> 00:15:27,126
to protect human life.

457
00:15:27,126 --> 00:15:28,127
That's it.

458
00:15:28,127 --> 00:15:29,093
Doesn't protect equipment,

459
00:15:29,094 --> 00:15:30,663
doesn't prevent outages,

460
00:15:30,663 --> 00:15:31,897
doesn't do any of that.

461
00:15:31,897 --> 00:15:34,300
It's just there in
a dangerous process

462
00:15:34,300 --> 00:15:35,668
so that people don't get killed.

463
00:15:35,668 --> 00:15:36,902
So something goes wrong,

464
00:15:36,902 --> 00:15:39,138
even a cyber attack
goes and takes place,

465
00:15:39,138 --> 00:15:40,572
the safety system kicks in

466
00:15:40,572 --> 00:15:43,108
and maintains the
quality of human life.

467
00:15:43,108 --> 00:15:45,611
The adversary specifically
went after that.

468
00:15:45,611 --> 00:15:46,812
The only purpose
to go after that

469
00:15:46,812 --> 00:15:48,047
is you're intending
to kill people.

470
00:15:48,047 --> 00:15:49,214
This is the first
time in history

471
00:15:49,214 --> 00:15:50,582
that an attack was
intentionally designed,

472
00:15:50,582 --> 00:15:51,417
that we know of,

473
00:15:51,417 --> 00:15:52,651
to try to kill people.

474
00:15:52,651 --> 00:15:53,786
Luckily they made a mistake,

475
00:15:53,786 --> 00:15:54,786
but either way,

476
00:15:55,988 --> 00:15:58,590
the trade craft of
this is pretty simple.

477
00:15:58,590 --> 00:16:00,059
I don't need indicators.

478
00:16:00,059 --> 00:16:01,794
I don't need any sort of
understanding of the malware

479
00:16:01,794 --> 00:16:03,062
at this point.

480
00:16:03,062 --> 00:16:04,463
I just need to know
that anytime anybody

481
00:16:04,463 --> 00:16:06,298
VPN's into my OT environment

482
00:16:06,298 --> 00:16:08,267
and does lateral movement
over to engineer work station

483
00:16:08,267 --> 00:16:09,802
and then lateral movement
down to safety system

484
00:16:09,802 --> 00:16:12,271
and then pulling off
logic of a safety system,

485
00:16:12,271 --> 00:16:14,339
that's a behavior that
I can now look for

486
00:16:14,340 --> 00:16:16,175
and understand that
has been associated

487
00:16:16,175 --> 00:16:17,843
with these type
of attacks before.

488
00:16:17,843 --> 00:16:19,678
Anyway so that's
exactly what we did

489
00:16:19,678 --> 00:16:21,046
is came up with
this understanding

490
00:16:21,046 --> 00:16:22,514
of trade craft around this.

491
00:16:22,514 --> 00:16:25,751
And we said look this
is our intelligence

492
00:16:25,751 --> 00:16:28,754
generated hypothesis,

493
00:16:28,754 --> 00:16:31,924
this is the piece that
automation and machine learning

494
00:16:31,924 --> 00:16:33,592
is not going to
come up with to say

495
00:16:33,592 --> 00:16:36,028
this is what I want to
track for this purpose

496
00:16:36,028 --> 00:16:38,364
as it's been associated
with previous activity,

497
00:16:38,364 --> 00:16:39,898
and here's why you should care.

498
00:16:41,400 --> 00:16:43,702
After this though,

499
00:16:43,702 --> 00:16:45,938
we ended up taking
that trade craft

500
00:16:45,938 --> 00:16:48,640
and looking at other
places around the world.

501
00:16:48,640 --> 00:16:50,042
And if you would
do indicator checks

502
00:16:50,042 --> 00:16:51,343
and all that other
stuff like many did,

503
00:16:51,343 --> 00:16:52,411
you would get nothing.

504
00:16:52,411 --> 00:16:53,612
Why?

505
00:16:53,612 --> 00:16:55,414
Because the malware will
always be different.

506
00:16:55,414 --> 00:16:58,384
Each safety intermitted
system is uniquely

507
00:16:58,384 --> 00:17:00,819
developed and
configured at that site

508
00:17:00,819 --> 00:17:03,454
because it's for the physical
process that's there.

509
00:17:03,455 --> 00:17:05,057
So everything about
it's different

510
00:17:05,057 --> 00:17:07,291
at every single
site in the world,

511
00:17:07,291 --> 00:17:08,694
even if the vendor name,

512
00:17:08,694 --> 00:17:11,062
you know like Snyder or
whatever is the same,

513
00:17:11,063 --> 00:17:12,765
it's a different safety system.

514
00:17:12,765 --> 00:17:16,001
The same malware would never
work on each one of those.

515
00:17:16,001 --> 00:17:18,170
I have to develop
new capabilities

516
00:17:18,170 --> 00:17:20,906
even if they're similar in
nature for each one of these.

517
00:17:20,906 --> 00:17:22,473
So a lot of people did
the indicator sweeps.

518
00:17:22,473 --> 00:17:24,175
Found nothing. We even saw
vendors come out and say,

519
00:17:24,175 --> 00:17:27,346
here's a tool to check
your safety system.

520
00:17:27,346 --> 00:17:30,149
And if you run this
and check it your good.

521
00:17:30,149 --> 00:17:32,717
Except for it literally
would never work anywhere.

522
00:17:32,718 --> 00:17:35,988
And I have a little
bit of problem

523
00:17:35,988 --> 00:17:36,822
with people doing that.

524
00:17:36,822 --> 00:17:38,056
But anyways,

525
00:17:38,057 --> 00:17:39,691
so we went and tested
for this trade craft

526
00:17:39,691 --> 00:17:40,893
at other sites around the world

527
00:17:40,893 --> 00:17:43,662
and we found the
same activity group

528
00:17:43,662 --> 00:17:46,665
at multiple locations
throughout the world,

529
00:17:46,665 --> 00:17:47,832
not just the Middle East,

530
00:17:47,833 --> 00:17:49,001
including one that
ended up getting leaked

531
00:17:49,001 --> 00:17:50,436
here in the United States.

532
00:17:50,436 --> 00:17:52,037
The problem with that
is it also introduces

533
00:17:52,037 --> 00:17:53,605
the whole political
discussion of

534
00:17:53,605 --> 00:17:54,706
what happens if we have,

535
00:17:54,706 --> 00:17:56,507
not mass casualties,

536
00:17:56,508 --> 00:18:00,212
but 20 people die in the
U.S. to a cyber attack.

537
00:18:00,212 --> 00:18:03,415
How does the government deal
with a small isolated event?

538
00:18:03,415 --> 00:18:04,983
Unfortunately there's
not a clear answer.

539
00:18:04,983 --> 00:18:06,885
But the idea was,

540
00:18:06,885 --> 00:18:09,621
I'm going to more strategically
more operationally

541
00:18:09,621 --> 00:18:12,825
think about that trade
craft and then create that.

542
00:18:12,825 --> 00:18:14,026
Outside of that,

543
00:18:14,026 --> 00:18:15,861
there's no reason
that machine learning

544
00:18:15,861 --> 00:18:17,830
or something else couldn't
have then procedurely

545
00:18:17,830 --> 00:18:19,764
generated those tests,

546
00:18:19,765 --> 00:18:21,667
those hunts as you will,

547
00:18:21,667 --> 00:18:23,001
throughout all these
other environments.

548
00:18:23,001 --> 00:18:25,237
I would still not
call them hunting,

549
00:18:25,237 --> 00:18:26,839
but this is where the transition

550
00:18:26,839 --> 00:18:27,840
of the talk is
going to take place.

551
00:18:27,840 --> 00:18:29,274
I wouldn't call in hunting,

552
00:18:29,274 --> 00:18:33,011
but the procedural generation
and scaling of that hunt

553
00:18:33,011 --> 00:18:36,380
after the first time,
is then going to be core

554
00:18:36,381 --> 00:18:37,983
to making it accessible
to everybody.

555
00:18:37,983 --> 00:18:38,917
Because I can't have people

556
00:18:38,917 --> 00:18:40,385
and you can't have people,

557
00:18:40,385 --> 00:18:41,854
flying around every site in
the world testing those things.

558
00:18:41,854 --> 00:18:44,923
But we've exhausted any
discussion around indicators

559
00:18:44,923 --> 00:18:46,158
with certain types of attacks.

560
00:18:46,158 --> 00:18:48,060
So as we go forward
and think about well,

561
00:18:48,060 --> 00:18:52,063
how would you procedurely
generate those hunts-ish.

562
00:18:52,064 --> 00:18:53,298
- [Alex] Ish.

563
00:18:53,298 --> 00:18:55,134
- Now we'll kick it over to Alex

564
00:18:55,134 --> 00:18:56,702
to talk about how
he would do that.

565
00:18:56,702 --> 00:18:58,370
- [Alex] I will win
you over eventually.

566
00:18:58,370 --> 00:18:59,604
- One day you might.

567
00:18:59,605 --> 00:19:01,507
- Can we flip the
slides again please.

568
00:19:01,507 --> 00:19:04,710
And I think this is the
important point here,

569
00:19:04,710 --> 00:19:08,313
and I think Rob touching a
lot of very important points

570
00:19:08,313 --> 00:19:10,349
around setting up
the scene right?

571
00:19:10,349 --> 00:19:12,016
So this is what we want to do,

572
00:19:12,017 --> 00:19:13,752
but actually making operational

573
00:19:13,752 --> 00:19:16,288
is usually a heavy lift.

574
00:19:16,288 --> 00:19:17,956
And there are two
things he touched on

575
00:19:17,956 --> 00:19:19,190
which I think are
very very important

576
00:19:19,191 --> 00:19:20,959
that I do want to
reference here,

577
00:19:20,959 --> 00:19:22,761
is both the
environmental coverage

578
00:19:22,761 --> 00:19:24,263
and the analytical
coverage right?

579
00:19:24,263 --> 00:19:25,630
These are the two main pieces

580
00:19:25,631 --> 00:19:27,166
that we all need to work on

581
00:19:27,166 --> 00:19:29,568
in order to be able to automate.

582
00:19:29,568 --> 00:19:33,672
Environmental coverage
is very hard to automate.

583
00:19:33,672 --> 00:19:36,275
Someone has to go there
and collect the logs right?

584
00:19:36,275 --> 00:19:38,277
You can not teach the
machine to just give you-

585
00:19:38,277 --> 00:19:41,380
I mean, you can, I don't
know configure the GPO.

586
00:19:41,380 --> 00:19:43,215
I mean there's all sorts
of ways for you to try

587
00:19:43,215 --> 00:19:44,382
to configure that.

588
00:19:44,383 --> 00:19:45,617
But someone has to
take that action right?

589
00:19:45,617 --> 00:19:46,784
The machines are
not going to just

590
00:19:46,785 --> 00:19:48,554
volunteer your logs for you.

591
00:19:48,554 --> 00:19:50,889
And there's absolutely nothing
you have to do about that.

592
00:19:50,889 --> 00:19:53,391
Even something as simple
as patch management.

593
00:19:54,793 --> 00:19:57,161
One we start at automating
it a little but more,

594
00:19:57,162 --> 00:19:58,964
I remember the turning
point for me as a

595
00:19:58,964 --> 00:20:03,969
consultant analyst when WSIS
came together from Windows

596
00:20:05,103 --> 00:20:06,271
and suddenly it
was way way easier.

597
00:20:06,271 --> 00:20:07,839
Even though it didn't
help everything

598
00:20:07,839 --> 00:20:10,042
it was already something
that we started automating.

599
00:20:10,042 --> 00:20:12,511
So what does this
technical part of

600
00:20:12,511 --> 00:20:14,812
operational part of
threat hunting looks like?

601
00:20:14,813 --> 00:20:18,951
So first of all a
magic thing appears

602
00:20:18,951 --> 00:20:21,220
which is our normalized
telemetry repository,

603
00:20:21,220 --> 00:20:23,188
and that's where
we're talking about

604
00:20:23,188 --> 00:20:26,625
the specific
environmental coverage

605
00:20:26,625 --> 00:20:29,194
that Rob was saying.

606
00:20:29,194 --> 00:20:33,232
On the other point we
have the TTP repository,

607
00:20:33,232 --> 00:20:36,401
that's where we store
our technical hypothesis

608
00:20:36,401 --> 00:20:38,070
if you will allow
me to call them that

609
00:20:38,070 --> 00:20:40,239
around the activity groups
that he was talking.

610
00:20:40,239 --> 00:20:42,975
That is where we're
hoping to have some

611
00:20:42,975 --> 00:20:44,543
interesting analytical coverage.

612
00:20:47,879 --> 00:20:52,384
I know enough based
out of this diagram,

613
00:20:52,384 --> 00:20:53,952
I know enough of
these things that

614
00:20:53,952 --> 00:20:56,488
I am not completely lost if
one of those things happen.

615
00:20:56,488 --> 00:20:59,758
And then I'm just
trying stuff out.

616
00:20:59,758 --> 00:21:02,894
Let's see if this analytical
coverage that we have

617
00:21:03,962 --> 00:21:06,265
is going to find things there.

618
00:21:06,265 --> 00:21:08,734
Then again a lot of
work has to happen

619
00:21:08,734 --> 00:21:10,101
on the analytical coverage,

620
00:21:10,102 --> 00:21:12,871
on the environmental
coverage for us to be able to

621
00:21:12,871 --> 00:21:13,805
move this forward.

622
00:21:13,805 --> 00:21:16,341
But then the question becomes

623
00:21:16,341 --> 00:21:18,709
can we make some
magic appear here?

624
00:21:18,710 --> 00:21:22,681
If we understand what is the

625
00:21:22,681 --> 00:21:24,683
I know I'm going
the searching on

626
00:21:26,451 --> 00:21:28,687
direct and indirect matches
on threat intelligence.

627
00:21:28,687 --> 00:21:31,622
I have identified information
on threat intelligence

628
00:21:31,623 --> 00:21:33,959
from that specific
activity group,

629
00:21:33,959 --> 00:21:35,360
things that have done
in the recent past

630
00:21:35,360 --> 00:21:37,562
maybe I can start
searching for those.

631
00:21:37,562 --> 00:21:41,433
Maybe I can start searching
for if something is rare

632
00:21:41,433 --> 00:21:43,001
or if something is very frequent

633
00:21:43,001 --> 00:21:44,269
inside my environment.

634
00:21:44,269 --> 00:21:46,738
These are all levers I
can use to write a role.

635
00:21:47,606 --> 00:21:50,075
Or is this oh,

636
00:21:50,075 --> 00:21:53,812
I really really hate
this data center.

637
00:21:53,812 --> 00:21:56,148
This is a bulletproof
hosting place.

638
00:21:56,148 --> 00:21:58,716
No one can get anything
taken down there

639
00:21:58,717 --> 00:22:00,185
so anytime someone goes there,

640
00:22:00,185 --> 00:22:02,120
maybe it's little bit
more interesting right.

641
00:22:02,120 --> 00:22:04,790
These are all things that
are easily describable

642
00:22:05,991 --> 00:22:07,859
as analytical actions,

643
00:22:07,859 --> 00:22:10,562
are things that you
can write DTP's off

644
00:22:10,562 --> 00:22:13,899
and that should be
present on your telemetry

645
00:22:13,899 --> 00:22:15,333
depository or
things that you can

646
00:22:15,334 --> 00:22:17,102
potentially search on.

647
00:22:17,102 --> 00:22:19,938
And the hard part,

648
00:22:19,938 --> 00:22:21,406
and again anybody,

649
00:22:21,406 --> 00:22:23,341
anybody could be able
to write those right?

650
00:22:23,342 --> 00:22:26,645
But the challenge becomes
what does good look like?

651
00:22:27,813 --> 00:22:30,315
You want to try to have
something that always

652
00:22:30,315 --> 00:22:35,320
has a low false positive and
a low false negative rate.

653
00:22:36,321 --> 00:22:38,622
And those things are always

654
00:22:38,623 --> 00:22:40,359
fighting against each other.

655
00:22:40,359 --> 00:22:41,827
So I'm going to,

656
00:22:41,827 --> 00:22:45,797
one of my most favorite
things is anomaly detection.

657
00:22:45,797 --> 00:22:49,201
Anybody who has ever seen
a talk that I've done,

658
00:22:49,201 --> 00:22:50,969
I think anomaly detection
is the worst idea

659
00:22:50,969 --> 00:22:52,804
that ever happened for
information security.

660
00:22:52,804 --> 00:22:55,807
But we're still trying
to rehash that idea,

661
00:22:55,807 --> 00:22:57,943
every five or so years
it comes back again,

662
00:22:57,943 --> 00:23:01,446
and it has been for the
past thirty years right?

663
00:23:01,446 --> 00:23:03,881
And idea that has
refused to die.

664
00:23:03,882 --> 00:23:06,585
So normally it's
textures or technique

665
00:23:06,585 --> 00:23:11,590
that it's very, very,
very false positive prone

666
00:23:12,457 --> 00:23:13,725
because it's very sensitive.

667
00:23:13,725 --> 00:23:16,160
But on the other hand
it becomes super good

668
00:23:17,195 --> 00:23:18,597
on the false,

669
00:23:18,597 --> 00:23:20,399
it's not a lot of
false negatives.

670
00:23:20,399 --> 00:23:23,435
I mean it's going to be
chirping all over the place.

671
00:23:23,435 --> 00:23:27,072
It's going to catch things
more often than not,

672
00:23:27,072 --> 00:23:28,340
but on the other hand,

673
00:23:28,340 --> 00:23:31,342
if you have a very well
curated threat feed,

674
00:23:31,343 --> 00:23:33,712
you have the Rob threat
feed whatever that's called.

675
00:23:33,712 --> 00:23:34,946
He handled it,

676
00:23:34,946 --> 00:23:36,982
he like weaved himself
from his beard hair

677
00:23:36,982 --> 00:23:39,918
the best threat
intelligence there is

678
00:23:39,918 --> 00:23:42,787
and you're matching
against that.

679
00:23:42,788 --> 00:23:44,956
That's something that's
going to have a very very

680
00:23:44,956 --> 00:23:46,891
small false positive ratio

681
00:23:48,260 --> 00:23:51,363
but there will be an
immense false negative gap

682
00:23:51,363 --> 00:23:53,331
because you can not
hold pre-enumerate evil.

683
00:23:53,331 --> 00:23:55,000
That's the biggest problem with

684
00:23:55,000 --> 00:23:56,435
what you have on
threat intelligence.

685
00:23:56,435 --> 00:23:59,204
So there's aways competing
strategies right?

686
00:23:59,204 --> 00:24:01,139
The work that I have
done in the past

687
00:24:01,139 --> 00:24:02,974
is to try to,

688
00:24:02,974 --> 00:24:06,244
I mean if you only care
about false positives

689
00:24:06,244 --> 00:24:08,746
we could just write a
function like that for you.

690
00:24:08,747 --> 00:24:10,816
You're never going to
get a false positive ever

691
00:24:10,816 --> 00:24:12,083
from your thing.

692
00:24:12,083 --> 00:24:14,286
So the work that I've
been doing in the past

693
00:24:14,286 --> 00:24:15,720
has been to try and
balance those things

694
00:24:15,720 --> 00:24:18,490
and help to recreate
analytical techniques

695
00:24:18,490 --> 00:24:19,724
and machine learning techniques.

696
00:24:19,724 --> 00:24:24,428
I will not say AI in
order to minimize that.

697
00:24:24,429 --> 00:24:26,765
So if you want to have a look

698
00:24:26,765 --> 00:24:28,567
I'm not going to talk
about this again,

699
00:24:28,567 --> 00:24:31,470
but last year I was
specifically pain stakingly

700
00:24:31,470 --> 00:24:35,207
explaining how you try to
put all those things together

701
00:24:37,809 --> 00:24:40,612
and come across with something

702
00:24:40,612 --> 00:24:43,915
that could be mostly automated
to do this kind of work.

703
00:24:43,915 --> 00:24:47,452
But again where this
thing breaks down is

704
00:24:47,452 --> 00:24:49,621
if you don't have the data,

705
00:24:49,621 --> 00:24:52,424
if you don't have the
environmental coverage,

706
00:24:52,424 --> 00:24:55,494
if you don't have the
specific analytical coverage

707
00:24:55,494 --> 00:24:57,495
that's interesting for you,

708
00:24:57,496 --> 00:25:01,900
or what would be relevant
for your specific environment

709
00:25:01,900 --> 00:25:03,268
you're just struggling there.

710
00:25:03,268 --> 00:25:05,003
You're grasping for straws.

711
00:25:05,003 --> 00:25:07,872
You're not really gonna
be finding anything

712
00:25:07,873 --> 00:25:09,875
because you didn't do
the prep work before

713
00:25:09,875 --> 00:25:13,979
to strategically define what
should be the priorities

714
00:25:13,979 --> 00:25:15,881
of what you're going after.

715
00:25:18,316 --> 00:25:20,685
On the other hand
the cool thing about

716
00:25:20,685 --> 00:25:22,721
that strategy that
I was talking about

717
00:25:22,721 --> 00:25:26,258
on applying machine
learning to this idea

718
00:25:26,258 --> 00:25:28,660
of hypothesis testing,

719
00:25:28,660 --> 00:25:31,096
is that you're
literally brute forcing

720
00:25:31,096 --> 00:25:33,331
the hypothesis space.

721
00:25:33,331 --> 00:25:35,900
For all different combinations
of does this match

722
00:25:35,901 --> 00:25:37,202
threaten intelligence or not?

723
00:25:37,202 --> 00:25:38,503
Is this rare or not?

724
00:25:38,503 --> 00:25:40,572
Is this frequent or not?

725
00:25:40,572 --> 00:25:43,041
What about if it's in this
corner or that corner?

726
00:25:43,041 --> 00:25:45,710
You're literally throwing
everything against the wall

727
00:25:45,710 --> 00:25:47,345
and having a very efficient way

728
00:25:47,345 --> 00:25:49,314
to finding out what sticks.

729
00:25:49,314 --> 00:25:51,883
What's going to stay on the wall

730
00:25:51,883 --> 00:25:55,287
and then suddenly you
have a North Star,

731
00:25:55,287 --> 00:25:56,521
you found something,

732
00:25:56,521 --> 00:25:58,023
maybe you found a hunting lead,

733
00:25:58,023 --> 00:26:01,927
that then you're good
analytical people

734
00:26:01,927 --> 00:26:04,029
they can follow up on that thing

735
00:26:04,029 --> 00:26:07,365
and hopefully uncover
something that

736
00:26:07,365 --> 00:26:11,202
hasn't yet gotten
your crown jewels.

737
00:26:11,202 --> 00:26:12,571
You're just in the
nick of time there,

738
00:26:12,571 --> 00:26:14,572
so it's not
necessarily a disaster.

739
00:26:14,573 --> 00:26:15,774
It's very hard,

740
00:26:15,774 --> 00:26:17,007
I don't know how you guys feel,

741
00:26:17,008 --> 00:26:18,910
but it's very hard to
be a threat hunting,

742
00:26:18,910 --> 00:26:20,579
work in threat
hunting space because

743
00:26:20,579 --> 00:26:23,048
you get most excited when
things are the worst,

744
00:26:23,048 --> 00:26:24,549
when you really find oh my God,

745
00:26:24,549 --> 00:26:25,917
look what I found here but no,

746
00:26:25,917 --> 00:26:27,785
it's actually
terrible that you did.

747
00:26:27,786 --> 00:26:30,789
But it's hard to take
away the excitement.

748
00:26:30,789 --> 00:26:33,258
But anyway as Rob would say,

749
00:26:33,258 --> 00:26:34,392
these things fail all the time.

750
00:26:34,392 --> 00:26:35,360
- [Rob] Yeah.

751
00:26:35,360 --> 00:26:38,196
(audience laughs)

752
00:26:39,764 --> 00:26:41,733
- [Alex] I mean do you
have any good stories

753
00:26:41,733 --> 00:26:44,569
for us about good or
bad analytic searches?

754
00:26:44,569 --> 00:26:45,803
- [Rob] Absolutely.

755
00:26:45,804 --> 00:26:47,973
So even from a scene
learning perspective,

756
00:26:47,973 --> 00:26:50,008
I'll give you a good
example tied back to

757
00:26:50,008 --> 00:26:52,010
the safety system one

758
00:26:52,010 --> 00:26:55,981
and I'm going to dime
out product pitching

759
00:26:55,981 --> 00:26:58,216
because I think that's a good
example where it goes wrong.

760
00:26:58,216 --> 00:27:02,353
Where there was a vendor
in our space in industrial

761
00:27:02,354 --> 00:27:03,588
that was going
around telling people

762
00:27:03,588 --> 00:27:05,757
we detected TRISIS
out of the box.

763
00:27:07,559 --> 00:27:08,793
No anything needed.

764
00:27:08,793 --> 00:27:10,562
We have a machine running model,

765
00:27:10,562 --> 00:27:11,795
and it runs,

766
00:27:11,796 --> 00:27:14,566
and we detected TRISIS
attacks out of the box,

767
00:27:14,566 --> 00:27:16,568
no tuning we would of got it.

768
00:27:16,568 --> 00:27:17,969
And I talked to
them and followed up

769
00:27:17,969 --> 00:27:19,938
and said that's silly to me

770
00:27:19,938 --> 00:27:21,306
because it didn't exist yet,

771
00:27:21,306 --> 00:27:23,108
so you didn't know what
you were detecting.

772
00:27:23,108 --> 00:27:26,878
Are you just classifying
an alert as detection

773
00:27:26,878 --> 00:27:28,413
because that's not realistic.

774
00:27:28,413 --> 00:27:29,681
Like an analyst isn't
going to be able

775
00:27:29,681 --> 00:27:30,615
to pick that up and
do anything with it,

776
00:27:30,615 --> 00:27:32,050
it's just a contextless alert.

777
00:27:32,050 --> 00:27:33,752
And they're like well yeah sure,

778
00:27:33,752 --> 00:27:34,985
but we detected it.

779
00:27:34,986 --> 00:27:36,588
I'm like okay well let
me ask the negative

780
00:27:36,588 --> 00:27:37,889
aspect of this,

781
00:27:37,889 --> 00:27:40,125
in a case where somebody
was on the engineering

782
00:27:40,125 --> 00:27:43,361
work station and interacting
with the safety system,

783
00:27:43,361 --> 00:27:47,065
when would you have not
generated an anomaly.

784
00:27:47,065 --> 00:27:48,333
They're like well anytime.

785
00:27:48,333 --> 00:27:50,769
I'm like okay so your
detection is SIS log.

786
00:27:50,769 --> 00:27:52,804
Like anytime somebody
accesses that system

787
00:27:52,804 --> 00:27:55,373
you're calling SIS
log a detection.

788
00:27:55,373 --> 00:27:56,741
And this is what I
see what a lot of

789
00:27:56,741 --> 00:27:58,276
machine learning
driven approaches,

790
00:27:58,276 --> 00:28:01,046
is because people are
marrying up good analysts

791
00:28:01,046 --> 00:28:02,480
with machine learning,

792
00:28:02,480 --> 00:28:04,449
what ends up happening
is it sits in the corner

793
00:28:04,449 --> 00:28:06,351
and generates
alerts on everything

794
00:28:06,351 --> 00:28:07,986
and then you drown in the alerts

795
00:28:07,986 --> 00:28:09,954
and even worse,

796
00:28:09,954 --> 00:28:13,692
and I haven't seen this be
a board level topic yet,

797
00:28:13,692 --> 00:28:15,126
but one day somebody's
going to have to sit

798
00:28:15,126 --> 00:28:16,194
in front of the board and go,

799
00:28:16,194 --> 00:28:17,462
did you get the alert,

800
00:28:17,462 --> 00:28:19,297
and we're like yes
we got the alert.

801
00:28:19,297 --> 00:28:21,299
Well why didn't you
do anything about it?

802
00:28:21,299 --> 00:28:22,834
Well you see the machine
learning is generated

803
00:28:22,834 --> 00:28:24,269
in live anomaly and
that's going to fail

804
00:28:24,269 --> 00:28:25,070
at that level.

805
00:28:25,070 --> 00:28:25,904
They're like no, no, no,

806
00:28:25,904 --> 00:28:26,738
you got the alert,

807
00:28:26,738 --> 00:28:27,572
you did nothing with it,

808
00:28:27,572 --> 00:28:29,073
you're fired.

809
00:28:29,074 --> 00:28:31,643
These are the things that
companies have to deal with

810
00:28:31,643 --> 00:28:33,578
in terms of not just tuning,

811
00:28:33,578 --> 00:28:37,348
but what are the
outputs of having alerts

812
00:28:37,348 --> 00:28:39,751
that you're not using today
inside of your environment.

813
00:28:39,751 --> 00:28:41,920
The other piece where I've seen

814
00:28:41,920 --> 00:28:45,056
machine learning
effectively highly abused,

815
00:28:45,056 --> 00:28:48,626
is this idea that when we
start talking about predictive

816
00:28:48,626 --> 00:28:50,128
like I'm going to start
looking for attacks

817
00:28:50,128 --> 00:28:51,495
that haven't happened yet

818
00:28:51,496 --> 00:28:53,898
and from those attacks
I'm going to be able to

819
00:28:53,898 --> 00:28:56,033
curate all these data from ocent

820
00:28:56,034 --> 00:28:57,736
and everything else and tell you

821
00:28:57,736 --> 00:28:59,904
that this activity group
is going to target you

822
00:28:59,904 --> 00:29:02,073
and what they're
effectively trying to get to

823
00:29:02,073 --> 00:29:04,309
is what intelligence
analysts do all the time.

824
00:29:04,309 --> 00:29:05,744
Indicators are not intelligence.

825
00:29:05,744 --> 00:29:07,312
Let's just throw that out.

826
00:29:07,312 --> 00:29:09,514
Indicators are the
byproduct exhaust fumes

827
00:29:09,514 --> 00:29:10,982
of good intelligence work.

828
00:29:10,982 --> 00:29:14,418
But intelligence is I'm
going to make an assessment

829
00:29:14,419 --> 00:29:15,587
about the adversary.

830
00:29:15,587 --> 00:29:16,287
Usually their
intent, opportunity,

831
00:29:16,287 --> 00:29:17,489
and capability,

832
00:29:17,489 --> 00:29:18,723
and deliver you
some new knowledge.

833
00:29:18,723 --> 00:29:20,524
Operationally that
would be trade craft.

834
00:29:20,525 --> 00:29:21,960
The methods of the adversary,

835
00:29:21,960 --> 00:29:23,595
but strategically,

836
00:29:23,595 --> 00:29:25,363
I might have an
understanding that certain

837
00:29:25,363 --> 00:29:28,266
activity groups operate
in a way that they might

838
00:29:28,266 --> 00:29:29,534
target me eventually.

839
00:29:29,534 --> 00:29:31,603
I'm going to put them
into my threat model.

840
00:29:31,603 --> 00:29:34,472
But this fails when we
start trying to look

841
00:29:34,472 --> 00:29:37,175
for characteristics
and then inherently

842
00:29:38,810 --> 00:29:41,212
predict intent of an adversary.

843
00:29:41,212 --> 00:29:42,947
So in other words I might
take a machine learning model,

844
00:29:42,947 --> 00:29:45,149
run it across all the attributes
related to my environment

845
00:29:45,150 --> 00:29:47,218
run it across all the
attributes of known

846
00:29:47,218 --> 00:29:49,387
threat actors and
activity groups,

847
00:29:49,387 --> 00:29:51,456
and be able to come
up with an idea that

848
00:29:51,456 --> 00:29:53,792
my threat model now is
these five activity groups

849
00:29:53,792 --> 00:29:55,526
based off of what I have.

850
00:29:55,527 --> 00:29:57,128
I've seen some
companies and some teams

851
00:29:57,128 --> 00:29:58,062
start to do that,

852
00:29:58,062 --> 00:29:59,330
and the problem is again,

853
00:29:59,330 --> 00:30:01,966
it's also assuming
perfect collection

854
00:30:01,966 --> 00:30:04,702
on behalf of you as the
analyst and the system.

855
00:30:04,702 --> 00:30:07,505
A good example of
where human analysis

856
00:30:07,505 --> 00:30:09,808
went wrong with that
is a couple year ago

857
00:30:09,808 --> 00:30:11,442
there was campaign
called Dragonfly.

858
00:30:11,442 --> 00:30:13,978
Some antech did a ton
of amazing work on it

859
00:30:13,978 --> 00:30:15,914
and said this is a
campaign that's targeting

860
00:30:15,914 --> 00:30:17,916
the electric sector
and they highlighted,

861
00:30:17,916 --> 00:30:19,450
it's targeting the
electric sector.

862
00:30:19,450 --> 00:30:21,753
It went around and all
the media picked up on it

863
00:30:21,753 --> 00:30:22,821
and said if you're in
the electric sector

864
00:30:22,821 --> 00:30:24,522
you should watch for this.

865
00:30:24,522 --> 00:30:27,091
But what semantic had
is in their collection,

866
00:30:27,091 --> 00:30:29,593
they had a lot of
electric customers

867
00:30:29,594 --> 00:30:31,329
so the targeting of
electric customers

868
00:30:31,329 --> 00:30:34,732
looked like it was
targeted towards electric.

869
00:30:34,732 --> 00:30:35,934
They didn't have a lot of mining

870
00:30:35,934 --> 00:30:37,535
and petrochemical customers

871
00:30:37,535 --> 00:30:39,604
and it turns out it was
always hitting majorly

872
00:30:39,604 --> 00:30:41,272
in mining and petrochemical.

873
00:30:41,272 --> 00:30:42,874
So based off the
intelligence analysis

874
00:30:42,874 --> 00:30:44,909
of the misconception
of our own collection,

875
00:30:44,909 --> 00:30:46,878
the assessment was
completely wrong.

876
00:30:46,878 --> 00:30:49,414
It was a pretty
wide long campaign.

877
00:30:49,414 --> 00:30:51,182
Swirl this back to
this discussion,

878
00:30:51,182 --> 00:30:53,551
you're collection is
always gonna be a problem.

879
00:30:53,551 --> 00:30:55,687
Everybody's collection
sucks in comparison

880
00:30:55,687 --> 00:30:57,288
to what they think that have.

881
00:30:57,288 --> 00:30:59,390
Hell I mean I thin
even the NSA is like,

882
00:30:59,390 --> 00:31:00,658
oh you have all this collection.

883
00:31:00,658 --> 00:31:02,694
Nope like 98% of it
is Netflix and porn.

884
00:31:02,694 --> 00:31:03,895
You know what I mean,

885
00:31:03,895 --> 00:31:06,129
it's just a ton of crap
collection usually.

886
00:31:06,130 --> 00:31:08,833
So this idea that you think
you have enough collection

887
00:31:08,833 --> 00:31:10,101
to then script it out or

888
00:31:10,101 --> 00:31:11,836
using machine learning
model off of it,

889
00:31:11,836 --> 00:31:15,006
is always going to be misleading
and you're going to need

890
00:31:15,006 --> 00:31:17,809
good analysts to then
understand those gaps

891
00:31:17,809 --> 00:31:19,878
and to me that's the
value of hunting,

892
00:31:19,878 --> 00:31:22,679
is finding the gaps in
your environment today.

893
00:31:22,680 --> 00:31:24,148
To Alex's point,

894
00:31:24,148 --> 00:31:26,149
I don't want to go to a board
or go to executive and go,

895
00:31:26,150 --> 00:31:28,152
I'm gonna go hunting,

896
00:31:28,152 --> 00:31:29,687
and if I'm successful,

897
00:31:29,687 --> 00:31:31,322
we're going to have
a major incident.

898
00:31:31,322 --> 00:31:32,756
That's not an output

899
00:31:32,757 --> 00:31:33,691
(audience laughs)

900
00:31:33,691 --> 00:31:34,592
that I want to talk about.

901
00:31:34,592 --> 00:31:35,560
Instead I'm gonna say,

902
00:31:35,560 --> 00:31:36,961
I'm going to do hunting,

903
00:31:36,961 --> 00:31:39,530
which is effectively
instant response in reverse,

904
00:31:39,530 --> 00:31:41,733
and I'm going to make
sure that we can reliably

905
00:31:41,733 --> 00:31:44,903
detect and respond
to these cases.

906
00:31:44,903 --> 00:31:46,804
Then I can show a
return on investment

907
00:31:46,804 --> 00:31:48,373
at an executive level when I go

908
00:31:48,373 --> 00:31:52,176
here are the five scenarios
that we're covered with today

909
00:31:52,176 --> 00:31:54,544
based on our investment
against the type of scenarios

910
00:31:54,545 --> 00:31:55,780
you're actually concerned with.

911
00:31:55,780 --> 00:31:57,615
And with this
additional investment,

912
00:31:57,615 --> 00:32:00,018
we can extend our
automation footprint

913
00:32:00,018 --> 00:32:01,953
to cover six, seven and eight

914
00:32:01,953 --> 00:32:03,388
and then there's
an economy of scale

915
00:32:03,388 --> 00:32:05,290
and we'll actually get
nine and ten as well.

916
00:32:05,290 --> 00:32:06,624
Like this is more
of the story that we

917
00:32:06,624 --> 00:32:08,893
want to start telling
to get security

918
00:32:08,893 --> 00:32:10,962
being more impactful
in organizations

919
00:32:10,962 --> 00:32:13,064
but it's going to
require you to understand

920
00:32:13,064 --> 00:32:15,533
your environmental and
analytical coverage,

921
00:32:15,533 --> 00:32:18,569
and it will always require
the human driven approach

922
00:32:18,569 --> 00:32:19,803
to that hypothesis generation

923
00:32:19,804 --> 00:32:21,172
and understanding at large.

924
00:32:21,172 --> 00:32:22,707
Sorry.

925
00:32:22,707 --> 00:32:25,410
- But I think it touched on
a very very important point,

926
00:32:25,410 --> 00:32:29,647
which is the human in
the loop kind of idea.

927
00:32:29,647 --> 00:32:32,183
And the idea that
you have touch points

928
00:32:32,183 --> 00:32:34,152
where you can
engage with a human

929
00:32:34,152 --> 00:32:37,522
and the human can
help you actually,

930
00:32:37,522 --> 00:32:39,490
not only validate what
the machine learning

931
00:32:39,490 --> 00:32:40,925
model has been able to do,

932
00:32:40,925 --> 00:32:42,694
but also take it a
little bit further.

933
00:32:42,694 --> 00:32:46,798
So one of the biggest
sins I believe

934
00:32:46,798 --> 00:32:48,232
that anyone who's
trying to build

935
00:32:48,232 --> 00:32:51,636
any sort of machine
learning base model does,

936
00:32:51,636 --> 00:32:53,303
and this is not
just at security,

937
00:32:53,304 --> 00:32:54,639
this is everywhere,

938
00:32:54,639 --> 00:32:58,275
is trying to do too
much at the same time.

939
00:32:58,276 --> 00:33:00,111
Sometimes you have
to learn how to crawl

940
00:33:00,111 --> 00:33:01,412
and then you learn how to walk

941
00:33:01,412 --> 00:33:03,915
and then you learn
how to run hopefully.

942
00:33:03,915 --> 00:33:07,485
And the idea that you
can skip those steps

943
00:33:07,485 --> 00:33:09,721
and just do anything
at any order,

944
00:33:09,721 --> 00:33:11,723
oh I'm just going to throw
this data on a thought

945
00:33:11,723 --> 00:33:13,390
and something magical
is going to appear,

946
00:33:13,391 --> 00:33:16,094
it's usually a bad idea right?

947
00:33:16,094 --> 00:33:17,662
And I brought this example,

948
00:33:17,662 --> 00:33:20,264
this is a very
interesting work that

949
00:33:20,264 --> 00:33:24,369
Dr. Dawn Song from Berkeley
did recently was about,

950
00:33:24,369 --> 00:33:25,870
I mean guys,

951
00:33:25,870 --> 00:33:27,804
if you see a self driving
car just run away right?

952
00:33:27,805 --> 00:33:29,774
It's like those
things are terrible

953
00:33:29,774 --> 00:33:32,243
and it's how they were,

954
00:33:32,243 --> 00:33:36,214
if you just put a few
stickers on the stop sign,

955
00:33:36,214 --> 00:33:40,018
then it suddenly thinks
it's a speed limit thing.

956
00:33:40,018 --> 00:33:43,621
But I mean you guys
all understand why

957
00:33:43,621 --> 00:33:45,223
we are not fooled by that right?

958
00:33:47,191 --> 00:33:49,761
If I'm in any
country in the world

959
00:33:49,761 --> 00:33:51,529
with any language that doesn't,

960
00:33:51,529 --> 00:33:53,431
that's not English,

961
00:33:53,431 --> 00:33:56,200
and I see a sign
that's a red hexagon,

962
00:33:56,200 --> 00:33:58,903
oh that's probably stop.

963
00:33:58,903 --> 00:34:00,204
I should stop.

964
00:34:00,204 --> 00:34:04,075
So instead of searching
for whatever weird thing

965
00:34:04,075 --> 00:34:06,210
that's happening on that
leap learning algorithm there

966
00:34:06,210 --> 00:34:09,047
to think about that
is a stop sign,

967
00:34:09,047 --> 00:34:11,182
why am I not just
looking for the hexagon?

968
00:34:11,181 --> 00:34:13,683
Why am I not doing
hierarchy code.

969
00:34:13,684 --> 00:34:15,620
Categorization hierarchy
code detection.

970
00:34:15,620 --> 00:34:19,991
Why am I not finding a small
unit of information first

971
00:34:19,991 --> 00:34:22,527
which then it's easier for
me to understand what it is

972
00:34:22,527 --> 00:34:24,328
and then I can build on that.

973
00:34:24,328 --> 00:34:27,931
When I get that's validated
I can build on that.

974
00:34:27,931 --> 00:34:30,134
If I tell this that I
told you to the people

975
00:34:30,134 --> 00:34:31,402
who actually build those things

976
00:34:31,402 --> 00:34:33,538
they think I'm crazy
but this just makes

977
00:34:33,538 --> 00:34:35,005
perfect sense to me.

978
00:34:35,005 --> 00:34:37,040
If I know that it's
always going to be an

979
00:34:37,041 --> 00:34:39,343
examinal square I'm not
gonna be fooled by it.

980
00:34:40,545 --> 00:34:44,782
And this is really where
I believe we can improve

981
00:34:44,782 --> 00:34:46,751
the work that we were doing.

982
00:34:46,751 --> 00:34:48,019
If we have,

983
00:34:48,018 --> 00:34:50,921
again we have our TTP
repository's there.

984
00:34:50,922 --> 00:34:54,192
We have the analytical
coverage that I have currently.

985
00:34:56,027 --> 00:34:57,261
But what if,

986
00:34:57,261 --> 00:34:59,697
and this is very aspirational,

987
00:34:59,697 --> 00:35:00,998
I mean someone actually,

988
00:35:00,998 --> 00:35:02,200
we had alerts,

989
00:35:02,200 --> 00:35:04,067
we have incidents
that we had validated,

990
00:35:04,068 --> 00:35:05,736
and they were spot on.

991
00:35:05,736 --> 00:35:08,372
They were bullseyes and
I offered the bullseyes

992
00:35:08,372 --> 00:35:10,107
for my friend David Bianco here.

993
00:35:10,108 --> 00:35:12,610
He's wearing his
target red shirt,

994
00:35:13,744 --> 00:35:18,149
and if I have enough
accurate date on alerts

995
00:35:18,149 --> 00:35:19,984
that were handled,

996
00:35:21,052 --> 00:35:24,555
I tell you I
believe we can infer

997
00:35:24,555 --> 00:35:26,790
the analytical coverage
that we would need

998
00:35:26,791 --> 00:35:28,292
in order to find those things.

999
00:35:30,361 --> 00:35:33,531
And the hard part is getting
that data on the left there.

1000
00:35:33,531 --> 00:35:36,801
To actually get people
to validate the alerts.

1001
00:35:36,801 --> 00:35:39,303
Even if those alerts are
being handcraftededly

1002
00:35:39,303 --> 00:35:41,005
generated or they're
being generated

1003
00:35:41,005 --> 00:35:42,406
by a machine learning model.

1004
00:35:43,274 --> 00:35:45,643
This is a three hat problem,

1005
00:35:45,643 --> 00:35:47,078
three magic hat problem.

1006
00:35:47,078 --> 00:35:48,913
This is not a one
magic hat problem

1007
00:35:48,913 --> 00:35:50,815
that we were talking
about just before.

1008
00:35:50,815 --> 00:35:52,517
But I believe if you have

1009
00:35:52,517 --> 00:35:55,185
enough environmental coverage

1010
00:35:55,186 --> 00:35:58,022
and you can do enough work
in actually validating

1011
00:35:58,022 --> 00:36:00,525
you can go back and generate

1012
00:36:00,525 --> 00:36:02,460
the analytical
coverage that you have.

1013
00:36:03,494 --> 00:36:04,762
Actually going there,

1014
00:36:04,762 --> 00:36:06,531
I mean if anybody ever
comes across a system

1015
00:36:06,531 --> 00:36:08,966
that I made please
give us feedback.

1016
00:36:08,966 --> 00:36:11,169
We are starving data scientists.

1017
00:36:11,169 --> 00:36:14,305
We really need your feedback
in order to improve.

1018
00:36:14,305 --> 00:36:16,741
But if we had enough data,

1019
00:36:16,741 --> 00:36:20,845
it's really about just
pruning the decision tree.

1020
00:36:20,845 --> 00:36:24,048
Where the things seem
to aggregate the most.

1021
00:36:24,048 --> 00:36:26,484
So yeah I really care
about finding grapefruits

1022
00:36:26,484 --> 00:36:28,719
and lemons on my garden so yeah,

1023
00:36:28,719 --> 00:36:31,789
I will just hunt for
yellow round fruits,

1024
00:36:31,789 --> 00:36:33,724
that should be fine.

1025
00:36:33,724 --> 00:36:35,426
I don't actually have
to hunt for lemons,

1026
00:36:35,426 --> 00:36:39,130
I don't actually have to
hunt for grapefruits right?

1027
00:36:39,130 --> 00:36:40,398
So it just congregates.

1028
00:36:40,398 --> 00:36:42,600
Everybody uses this
kinds of algorithms.

1029
00:36:42,600 --> 00:36:44,569
This is how Spotify
suggests stuff for you.

1030
00:36:44,569 --> 00:36:46,537
This is how Amazon
suggests stuff for you.

1031
00:36:46,537 --> 00:36:48,406
It's called
collaborative filtering,

1032
00:36:48,406 --> 00:36:51,241
but we still don't have
enough data I feel,

1033
00:36:51,242 --> 00:36:53,144
which is being
categorized properly

1034
00:36:53,144 --> 00:36:54,377
and this is one of my,

1035
00:36:54,378 --> 00:36:56,314
every talk that I
give I'm like guys,

1036
00:36:56,314 --> 00:36:57,615
of course crawl, walk, run,

1037
00:36:57,615 --> 00:37:00,051
if we can get the data orderly,

1038
00:37:00,051 --> 00:37:04,255
then we can start doing some
very interesting stuff here.

1039
00:37:04,255 --> 00:37:05,556
Yes you see,

1040
00:37:05,556 --> 00:37:06,457
that didn't happen,

1041
00:37:06,457 --> 00:37:07,558
nobody heard the word.

1042
00:37:10,161 --> 00:37:12,463
Become of course
increasingly better

1043
00:37:12,463 --> 00:37:14,232
and again feed this feed loop.

1044
00:37:14,232 --> 00:37:16,400
But again the human
needs to validate.

1045
00:37:16,400 --> 00:37:17,868
You don't want a
machine learning model

1046
00:37:17,868 --> 00:37:19,503
talking to another
machine learning model,

1047
00:37:19,503 --> 00:37:21,072
they will go insane together.

1048
00:37:21,072 --> 00:37:23,274
It's just a nightmare.

1049
00:37:23,274 --> 00:37:25,609
But I think we reached
kind of an agreement right?

1050
00:37:25,610 --> 00:37:28,579
- [Rob] So here's where I
would balance the talk out

1051
00:37:28,579 --> 00:37:32,917
and say more so then just
you must do one or the other,

1052
00:37:32,917 --> 00:37:35,886
if you are using a machine
learning driven approach

1053
00:37:35,886 --> 00:37:37,488
with detection strategy,

1054
00:37:37,488 --> 00:37:39,957
in my opinion you then
must compliment it

1055
00:37:39,957 --> 00:37:42,792
with threat hunting so that
it doesn't go off the rails.

1056
00:37:42,793 --> 00:37:45,429
You must compliment
it with a lead analyst

1057
00:37:45,429 --> 00:37:47,999
that understand your analytical
environmental coverage.

1058
00:37:47,999 --> 00:37:51,334
You can not have a single
layered detection strategy

1059
00:37:51,335 --> 00:37:52,203
for your organization.

1060
00:37:52,203 --> 00:37:53,437
It's not going to work.

1061
00:37:53,437 --> 00:37:55,205
In addition to that
I would put forth

1062
00:37:55,206 --> 00:37:57,475
that also as much as
I'd like to say that

1063
00:37:57,475 --> 00:37:59,610
sure we can do better
than machine learning

1064
00:37:59,610 --> 00:38:02,079
and I really don't have
a high bar for success

1065
00:38:02,079 --> 00:38:03,881
for machine learning
on this stuff,

1066
00:38:03,881 --> 00:38:06,484
I will also counter
with I visited

1067
00:38:06,484 --> 00:38:07,551
many of your socks,

1068
00:38:07,551 --> 00:38:09,153
I've met many of the analysts.

1069
00:38:09,153 --> 00:38:11,055
There are some that
should really depend more

1070
00:38:11,055 --> 00:38:12,656
on a machine learning model

1071
00:38:12,657 --> 00:38:13,958
(audience laughs)

1072
00:38:13,958 --> 00:38:15,593
because with no
offense to anybody,

1073
00:38:15,593 --> 00:38:17,861
when I got in and say what
do you do for your job,

1074
00:38:17,862 --> 00:38:19,964
like oh the system
detects something,

1075
00:38:19,964 --> 00:38:21,365
it opens a jira ticket,

1076
00:38:21,365 --> 00:38:22,667
I look at the jira ticket,

1077
00:38:22,667 --> 00:38:24,302
if it doesn't
immediately stand out

1078
00:38:24,302 --> 00:38:25,770
I close the jira ticket.

1079
00:38:25,770 --> 00:38:27,305
That's not machine learning.

1080
00:38:27,305 --> 00:38:29,573
That's a batch file that
you could be automated with.

1081
00:38:29,573 --> 00:38:31,042
That's not a difficult
challenge so-

1082
00:38:31,042 --> 00:38:34,211
- You know what if we
just close the jira ticket

1083
00:38:34,211 --> 00:38:35,145
that guides job would be gone.

1084
00:38:35,146 --> 00:38:37,181
- Yeah so to Alex's point,

1085
00:38:37,181 --> 00:38:39,116
the best machine
learning model out there

1086
00:38:39,116 --> 00:38:41,986
is not going to be better
than the best driver out there

1087
00:38:41,986 --> 00:38:43,554
for that car discussion.

1088
00:38:43,554 --> 00:38:45,523
But it will be better
than the sixteen year old

1089
00:38:45,523 --> 00:38:46,891
texting on their phone.

1090
00:38:46,891 --> 00:38:48,392
That's where we gotta
find the balance

1091
00:38:48,392 --> 00:38:50,394
in terms of how we use
automation and hunting

1092
00:38:50,394 --> 00:38:53,196
and I would still say
it's definitively human

1093
00:38:53,197 --> 00:38:55,333
but the gap is closing
on what machine learning

1094
00:38:55,333 --> 00:38:56,667
can actually
accomplish for that.

1095
00:38:56,667 --> 00:38:57,902
Anyways.

1096
00:38:57,902 --> 00:38:58,703
- [Alex] Yeah I
guess that was it.

1097
00:38:58,703 --> 00:38:59,670
- [Rob] And yeah.

1098
00:38:59,670 --> 00:39:00,871
- Yeah that's it.

1099
00:39:00,871 --> 00:39:01,672
- So I guess we're
friends again. Maybe.

1100
00:39:01,672 --> 00:39:02,440
- I guess we are yeah.

1101
00:39:02,440 --> 00:39:03,708
- We'll see.

1102
00:39:03,708 --> 00:39:04,709
- I mean we'll see next
year what happens right?

1103
00:39:04,709 --> 00:39:05,810
- Yeah alright perfect.

1104
00:39:05,810 --> 00:39:06,744
- Yeah.

1105
00:39:06,744 --> 00:39:07,945
- We have no time for questions,

1106
00:39:07,945 --> 00:39:08,879
or do we have time
for questions?

1107
00:39:08,879 --> 00:39:09,814
We have no time for questions.

1108
00:39:09,814 --> 00:39:10,481
We purposely do that by the way.

1109
00:39:10,481 --> 00:39:11,716
- Of course.

1110
00:39:11,716 --> 00:39:12,650
- If somebody's going to
ask some good question

1111
00:39:12,650 --> 00:39:13,451
I'm going to look like an idiot.

1112
00:39:13,451 --> 00:39:14,618
I don't want to do that.

1113
00:39:14,618 --> 00:39:15,886
- Yeah they're
gonna make a point,

1114
00:39:15,886 --> 00:39:17,421
they're not going
to ask a question.

1115
00:39:17,421 --> 00:39:18,622
Actually I think - Oh yeah
I just wanted to tell you

1116
00:39:18,622 --> 00:39:19,757
that my opinion on
this is actually this.

1117
00:39:19,757 --> 00:39:20,991
Well that's adorable.

1118
00:39:20,991 --> 00:39:22,927
Alright so you can
find me at the bar.

1119
00:39:22,927 --> 00:39:23,761
Thanks everybody.

1120
00:39:23,761 --> 00:39:25,096
- See everyone.

