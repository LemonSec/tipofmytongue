1
00:00:00,867 --> 00:00:04,270
(uptempo orchestral music)

2
00:00:07,941 --> 00:00:11,111
(audience applauding)

3
00:00:12,312 --> 00:00:14,381
- So as Rob mentioned,
I'm Heather Adkins,

4
00:00:14,381 --> 00:00:17,250
Director of Information
Security Privacy at Google.

5
00:00:17,250 --> 00:00:20,854
And I help along with
a fairly sizable team

6
00:00:22,055 --> 00:00:24,290
run the detection and
response organization.

7
00:00:24,290 --> 00:00:26,960
In other words, we find bad
guys and we make them cry,

8
00:00:26,960 --> 00:00:29,963
and that's the thing that
we love to do day-to-day.

9
00:00:29,963 --> 00:00:31,731
A little bit about me
before we get started,

10
00:00:31,731 --> 00:00:35,068
so that you understand
the method to my madness.

11
00:00:35,068 --> 00:00:37,870
I grew up in a small,
little town in the desert,

12
00:00:37,871 --> 00:00:40,373
where there wasn't much to do
but learn computers and read,

13
00:00:40,373 --> 00:00:41,775
and that's what I did.

14
00:00:41,775 --> 00:00:44,577
I fell in love with
technology at a very early age

15
00:00:44,577 --> 00:00:46,111
but when I went to college.

16
00:00:46,112 --> 00:00:48,681
I decided I wanted to be
somewhere where it rained

17
00:00:48,681 --> 00:00:52,786
and where there was green
stuff, so I study marine biology

18
00:00:52,786 --> 00:00:54,854
up in the northern
coast of California.

19
00:00:54,854 --> 00:00:57,791
And there I fell in love
with the idea of ecosystems

20
00:00:57,791 --> 00:01:01,494
and understanding how
organisms work inside of them.

21
00:01:01,494 --> 00:01:03,396
And then at some
point in my career,

22
00:01:03,396 --> 00:01:05,265
and I still didn't
understand why I did this.

23
00:01:05,265 --> 00:01:08,068
I started studying
medieval history

24
00:01:08,068 --> 00:01:09,335
and if you know anything

25
00:01:09,335 --> 00:01:11,003
about the study of
medieval history,

26
00:01:11,004 --> 00:01:14,507
you know it is the
identification of
the arcane artifacts

27
00:01:15,442 --> 00:01:16,910
and building stories.

28
00:01:16,910 --> 00:01:19,145
And it turns out that
when you combine all three

29
00:01:19,145 --> 00:01:23,316
of my great loves, technology,
ecosystems, arcane artifacts,

30
00:01:24,484 --> 00:01:27,654
it looks a little bit
like digital forensics.

31
00:01:27,654 --> 00:01:29,655
And that's actually what I more

32
00:01:29,656 --> 00:01:31,591
or less love doing even today.

33
00:01:31,591 --> 00:01:33,326
And I have been at
Google long enough,

34
00:01:33,326 --> 00:01:37,130
15 years now, to see us do
everything from launching Gmail

35
00:01:37,130 --> 00:01:39,999
to putting balloons
into almost outer space

36
00:01:39,999 --> 00:01:42,235
to provide Wi-Fi
for the whole world.

37
00:01:42,235 --> 00:01:45,705
And so I have gotten to see
the whole lot of things,

38
00:01:45,705 --> 00:01:48,074
but it also means
that in my old age.

39
00:01:48,074 --> 00:01:52,645
I have become somewhat
whimsical and philosophical.

40
00:01:52,645 --> 00:01:56,381
So we are going to start
in a somewhat unusual place

41
00:01:56,382 --> 00:01:59,385
with this question,
why are we here?

42
00:02:01,187 --> 00:02:02,622
There's a literal
answer to this.

43
00:02:02,622 --> 00:02:03,890
All of you are here because

44
00:02:03,890 --> 00:02:05,959
you're interested
in threat hunting.

45
00:02:05,959 --> 00:02:07,527
Perhaps you've been doing
it for a little while,

46
00:02:07,527 --> 00:02:10,797
and you love the community
or perhaps you're new

47
00:02:10,797 --> 00:02:12,232
and you don't know what it is.

48
00:02:12,232 --> 00:02:14,734
Or perhaps you heard that
threat hunting was something you

49
00:02:14,734 --> 00:02:18,371
needed to have them and
you're here to get you one.

50
00:02:18,371 --> 00:02:19,672
And you're hoping
Rob is gonna hand it

51
00:02:19,672 --> 00:02:21,741
to you on the way out.

52
00:02:21,741 --> 00:02:25,778
That is the literal
reason why you are here,

53
00:02:25,778 --> 00:02:29,382
but that is not really
the reason you are here.

54
00:02:29,382 --> 00:02:31,584
You are here in your
field, in this specialty

55
00:02:31,584 --> 00:02:35,989
and in your career because of
the events that have unfolded

56
00:02:35,989 --> 00:02:37,891
over the last 45 years.

57
00:02:40,293 --> 00:02:42,829
Beginning in the 1960s,
the US government realized

58
00:02:42,829 --> 00:02:45,231
they had a problem
on their hand.

59
00:02:45,231 --> 00:02:47,900
Systems were no
longer single user.

60
00:02:47,901 --> 00:02:52,205
You suddenly had multiple users
and we had resource sharing,

61
00:02:52,205 --> 00:02:54,240
and they realized
pretty early on

62
00:02:54,240 --> 00:02:55,742
that they had a problem.

63
00:02:55,742 --> 00:03:00,046
And that if two users were using
the system at the same time

64
00:03:00,046 --> 00:03:02,916
they might be able to
see each other stuff.

65
00:03:02,916 --> 00:03:04,851
And they studied
this pretty deeply,

66
00:03:04,851 --> 00:03:07,887
and by 1972, James
Anderson had written,

67
00:03:07,887 --> 00:03:12,058
what I believe is the
seminal paper on this topic.

68
00:03:13,359 --> 00:03:15,895
He posited quite
correctly that the things

69
00:03:15,895 --> 00:03:20,400
we were building could
not defend themselves.

70
00:03:20,400 --> 00:03:23,002
You realize this in 1972.

71
00:03:23,002 --> 00:03:26,072
This is an incredible paper
if you haven't read it.

72
00:03:26,072 --> 00:03:29,375
There's a source here on
the bottom of the slides.

73
00:03:29,375 --> 00:03:31,644
He was a meteorologist.

74
00:03:31,644 --> 00:03:33,746
He understood how
systems worked.

75
00:03:33,746 --> 00:03:35,882
He understood the
push and the pull

76
00:03:35,882 --> 00:03:39,652
and he could see the future
as things became connected.

77
00:03:39,652 --> 00:03:41,154
This is a great paper.

78
00:03:41,154 --> 00:03:44,023
He talks about the
fact that CPU registers

79
00:03:44,023 --> 00:03:46,192
aren't private from one another.

80
00:03:46,192 --> 00:03:49,329
He predicted the
buffer overflow.

81
00:03:49,329 --> 00:03:53,733
We knew everything we
needed to know in 1972.

82
00:03:53,733 --> 00:03:56,236
And the government did
start to work on this

83
00:03:56,236 --> 00:04:00,373
and by 1980, he had further
posited that we needed to start

84
00:04:01,541 --> 00:04:05,011
auditing what users
did on their systems.

85
00:04:05,011 --> 00:04:06,980
He wrote a paper about it
called computer security, threat

86
00:04:06,980 --> 00:04:08,881
monitoring and surveillance.

87
00:04:08,881 --> 00:04:12,285
It's also a seminal
paper in our field.

88
00:04:12,285 --> 00:04:15,454
It is the paper that
started the careers

89
00:04:15,455 --> 00:04:17,690
that all of you have today,

90
00:04:19,091 --> 00:04:22,695
and again he predicted
everything we were going to do.

91
00:04:22,695 --> 00:04:24,931
He knew that we needed
auditing records.

92
00:04:24,931 --> 00:04:27,800
He knew that we needed
people looking at them.

93
00:04:27,800 --> 00:04:29,535
He knew we needed
to centralize them.

94
00:04:29,535 --> 00:04:32,405
He knew that log loss
would be a problem

95
00:04:32,405 --> 00:04:34,407
and mind you, he's
working on systems

96
00:04:34,407 --> 00:04:36,174
that are just
barely multi users.

97
00:04:36,175 --> 00:04:38,945
We just barely had
units at this point.

98
00:04:38,945 --> 00:04:42,048
There is no Mac,
there is no Windows.

99
00:04:44,450 --> 00:04:46,853
And they start talking
about the kinds of auditing

100
00:04:46,853 --> 00:04:48,554
that needed to be done.

101
00:04:48,554 --> 00:04:50,722
Each box here roughly
represents a topic

102
00:04:50,723 --> 00:04:53,726
that turns up in the
academic literature

103
00:04:53,726 --> 00:04:56,529
or in products that are
being commercially made.

104
00:04:56,529 --> 00:04:58,631
And the very first
technique that they suggest

105
00:04:58,631 --> 00:05:00,767
we try is manual analysis.

106
00:05:00,767 --> 00:05:04,971
Just literally humans
finding stuff and logs.

107
00:05:04,971 --> 00:05:08,675
Very shortly after that,
Dorothy Denning out of SRI

108
00:05:08,675 --> 00:05:12,679
starts talking about
behavioral anomalies early.

109
00:05:14,347 --> 00:05:16,149
What does normal look like?

110
00:05:16,149 --> 00:05:18,451
How do we determine
what abnormal is?

111
00:05:18,451 --> 00:05:21,120
Can we use statistics for that?

112
00:05:21,120 --> 00:05:23,389
Can we use self learning?

113
00:05:23,389 --> 00:05:25,024
Can we use experts systems?

114
00:05:25,024 --> 00:05:28,027
All of this comes
very early in the 80s.

115
00:05:28,027 --> 00:05:30,530
And by the 90s, we've moved on

116
00:05:31,931 --> 00:05:36,068
to what we think of
today as the big stuff.

117
00:05:36,069 --> 00:05:40,640
Neural networks, genetic
algorithms, AI, data mining.

118
00:05:40,640 --> 00:05:42,974
We give people analysis GUIs

119
00:05:42,975 --> 00:05:44,410
so that they can
click through things

120
00:05:44,410 --> 00:05:46,312
very easily to sort and find.

121
00:05:46,312 --> 00:05:48,381
Does this sounds familiar?

122
00:05:48,381 --> 00:05:51,784
Have we've been talking about
this for the last two days?

123
00:05:51,784 --> 00:05:55,955
Conceptually our ancestors
thought of this already,

124
00:05:57,323 --> 00:06:00,560
and then buy the 2002 we
start to combine it all.

125
00:06:00,560 --> 00:06:04,030
We talked deeply about
machine learning,

126
00:06:04,030 --> 00:06:08,633
and it's very interesting to
see how all of this progressed.

127
00:06:08,634 --> 00:06:10,036
And there's one thing that all

128
00:06:10,036 --> 00:06:12,772
of these technologies
have in common.

129
00:06:12,772 --> 00:06:17,210
All of these technologies
were meant to be assistance.

130
00:06:17,210 --> 00:06:21,114
They were meant to point
a human in a direction

131
00:06:22,281 --> 00:06:25,318
and I call this the
Elmer Fudd theory.

132
00:06:25,318 --> 00:06:28,554
We are humans, we are
out there hunting.

133
00:06:28,554 --> 00:06:30,423
We are looking for things

134
00:06:30,423 --> 00:06:34,927
and that is always
been conceptually
what we had in mind.

135
00:06:34,927 --> 00:06:37,430
Machine learning, these kinds
of concepts really meant

136
00:06:37,430 --> 00:06:40,099
to assist the human, and indeed,

137
00:06:41,534 --> 00:06:44,504
for any of you have
ever started sock.

138
00:06:44,504 --> 00:06:45,772
You're sock probably starts out

139
00:06:45,772 --> 00:06:47,306
looking a little bit like.

140
00:06:47,306 --> 00:06:49,207
This is actually
something we made

141
00:06:49,208 --> 00:06:51,310
when we started the Google sock.

142
00:06:51,310 --> 00:06:54,647
We literally just hired
analysts to start logs

143
00:06:54,647 --> 00:06:57,582
until we knew what
to do with them.

144
00:06:57,583 --> 00:07:01,421
And that is actually what
the original intent was,

145
00:07:01,421 --> 00:07:05,158
behind our careers so
it's not surprising

146
00:07:05,158 --> 00:07:07,927
that when we read
that literature.

147
00:07:07,927 --> 00:07:11,197
Just look at this timeline
in a different way.

148
00:07:11,197 --> 00:07:15,101
When we look at the literature,
we've been classified.

149
00:07:15,101 --> 00:07:17,236
We've been given names.

150
00:07:17,236 --> 00:07:19,539
James Anderson called this
the activity security officer,

151
00:07:19,539 --> 00:07:21,808
which sounds pretty cool.

152
00:07:21,808 --> 00:07:24,977
I wanna be an
officer, get a badge.

153
00:07:24,977 --> 00:07:27,246
I'm a little bit like a cop.

154
00:07:27,246 --> 00:07:30,049
And interestingly enough, a
lot of the people who went

155
00:07:30,049 --> 00:07:34,953
into this field at this
time are computer operators.

156
00:07:34,954 --> 00:07:39,325
Many of them women, not so
many women in this room today,

157
00:07:39,325 --> 00:07:40,259
which I think is an interesting

158
00:07:40,259 --> 00:07:42,662
observation for another talk.

159
00:07:44,363 --> 00:07:47,300
We start to see
words like auditor,

160
00:07:48,868 --> 00:07:52,171
security analyst
was born in the 80s.

161
00:07:52,171 --> 00:07:56,342
I found a job with a company
that shall not be named,

162
00:07:58,010 --> 00:08:00,445
hiring security analysts.

163
00:08:00,446 --> 00:08:02,148
This job has been
around for a long time.

164
00:08:02,148 --> 00:08:05,351
Fast forward and we start to
see security administrator,

165
00:08:05,351 --> 00:08:08,120
which is a twist on
IT administrator.

166
00:08:08,120 --> 00:08:12,124
And in the 2000s, late
1990s we invent the sock.

167
00:08:13,326 --> 00:08:16,796
A collection of these
folks to do this work,

168
00:08:16,796 --> 00:08:18,865
and then for some reason,

169
00:08:19,999 --> 00:08:23,069
we invented the
term threat hunter.

170
00:08:23,069 --> 00:08:27,240
The work is relatively the
same, assisted by technology,

171
00:08:29,775 --> 00:08:33,946
humans find bad stuff and
that is relatively speaking

172
00:08:36,148 --> 00:08:38,551
what threat hunting is today.

173
00:08:40,453 --> 00:08:43,155
And why do we keep
re-inventing this?

174
00:08:43,155 --> 00:08:45,757
I have a bit of a hypothesis,

175
00:08:45,758 --> 00:08:47,326
it's a poorly constructed one,

176
00:08:47,326 --> 00:08:48,861
probably won't hold
a lot of weight.

177
00:08:48,861 --> 00:08:52,398
But I have this feeling
that over the years,

178
00:08:52,398 --> 00:08:54,667
about every four to five years,

179
00:08:54,667 --> 00:08:57,236
something is not working right.

180
00:08:58,638 --> 00:09:02,575
We're not detecting what
we think we should be,

181
00:09:02,575 --> 00:09:05,645
and so we start anew,
and we start with humans.

182
00:09:05,645 --> 00:09:08,714
We always start with analyst,
but analyst need data.

183
00:09:08,714 --> 00:09:11,717
And once you've give them
data, they've got too much.

184
00:09:11,717 --> 00:09:13,986
So naturally, we
build them tools.

185
00:09:13,986 --> 00:09:17,523
We build them assistants,
then it turns out that

186
00:09:17,523 --> 00:09:19,725
that doesn't work either.

187
00:09:19,725 --> 00:09:21,661
And we know that
humans can do it better

188
00:09:21,661 --> 00:09:24,497
and we start up
in the same place.

189
00:09:26,265 --> 00:09:29,035
But when we look
at this over time,

190
00:09:29,035 --> 00:09:32,238
we look at the kinds
of technology that
have been available.

191
00:09:32,238 --> 00:09:35,207
The intelligent assistants
that we've been giving people.

192
00:09:35,207 --> 00:09:38,611
It begins with
something very simple.

193
00:09:38,611 --> 00:09:42,782
Have you read Cliff Stoll's
book on The Cuckoo's Egg?

194
00:09:44,617 --> 00:09:47,652
If you haven't, this is
part of your homework

195
00:09:47,653 --> 00:09:50,957
between now and
when you get home.

196
00:09:50,957 --> 00:09:55,127
He had literally nothing and
what he did to chase the hacker

197
00:09:56,562 --> 00:09:59,865
in the story, and I won't
spoil the story for you.

198
00:09:59,865 --> 00:10:03,803
He set up a trigger and every
time the hacker logged in,

199
00:10:03,803 --> 00:10:06,205
he printed the
audit records out.

200
00:10:06,205 --> 00:10:08,174
And I don't mean to the screen,

201
00:10:08,174 --> 00:10:12,144
I mean to a printer and not a
laser printer that goes fast

202
00:10:12,144 --> 00:10:15,781
but a line printer that
prints it out very slowly.

203
00:10:15,781 --> 00:10:17,116
Everything that the attacker did

204
00:10:17,116 --> 00:10:19,418
and everything the attacker saw.

205
00:10:19,418 --> 00:10:23,623
This is also James
Anderson's original advice.

206
00:10:23,623 --> 00:10:26,626
Print out the audit
records, create a case file,

207
00:10:26,626 --> 00:10:29,795
hand it to an officer
to read and to review.

208
00:10:29,795 --> 00:10:32,430
But you can imagine that
the people doing this work

209
00:10:32,431 --> 00:10:35,935
don't find that very
rewarding and it doesn't work.

210
00:10:35,935 --> 00:10:38,871
And so we invent new
technology for them.

211
00:10:38,871 --> 00:10:41,374
We invented database backed GUIs

212
00:10:41,374 --> 00:10:44,543
with the sequel interface
that went to a pager,

213
00:10:44,543 --> 00:10:46,445
when rows were fired.

214
00:10:46,445 --> 00:10:48,781
We invented that in the 80s.

215
00:10:49,982 --> 00:10:51,416
We got a little
more sophisticated

216
00:10:51,417 --> 00:10:53,686
by the time we got
into the 2000s,

217
00:10:53,686 --> 00:10:56,355
where we were doing
signatures in the sun.

218
00:10:56,355 --> 00:11:00,960
And we put a sock in
place to look at it 24/7.

219
00:11:00,960 --> 00:11:03,896
And now we have
threat hunting tools.

220
00:11:03,896 --> 00:11:06,232
We also have some
with data science

221
00:11:06,232 --> 00:11:09,068
and gosh goodness
knows what else.

222
00:11:11,704 --> 00:11:16,108
Every five years or so, we
go through this revolution

223
00:11:16,108 --> 00:11:20,545
of trying to improve the
intelligent assistant.

224
00:11:20,546 --> 00:11:22,548
There's a recent
study out from Rand,

225
00:11:22,548 --> 00:11:25,017
and this is gonna sound
a little bit strange.

226
00:11:25,017 --> 00:11:27,119
But there is a recent
study out from Rand

227
00:11:27,119 --> 00:11:31,290
on the estimated length of
career for exploit developers.

228
00:11:32,658 --> 00:11:35,995
And these are people who
routinely and repeatedly do it

229
00:11:35,995 --> 00:11:38,197
and are successful at it.

230
00:11:38,197 --> 00:11:41,600
And they posit that
the average career time

231
00:11:41,600 --> 00:11:45,271
doing that kind of work
is about four years.

232
00:11:47,206 --> 00:11:49,475
There are a few
reasons for that.

233
00:11:49,475 --> 00:11:52,545
One, they use up their
skill set entirely

234
00:11:52,545 --> 00:11:54,346
during that four year time,

235
00:11:54,346 --> 00:11:56,415
and they find all
the low hanging fruit

236
00:11:56,415 --> 00:11:58,751
and the next one is
that much harder.

237
00:11:58,751 --> 00:12:01,187
It's also very intensive work.

238
00:12:03,422 --> 00:12:05,791
I think looking at cognizant
science in this field

239
00:12:05,791 --> 00:12:07,993
is really important
because the work is intense

240
00:12:07,993 --> 00:12:09,829
if you're doing it all the time,

241
00:12:09,829 --> 00:12:12,897
and that's another reason
why people fall out of it.

242
00:12:12,898 --> 00:12:15,601
And I think the same
is probably true

243
00:12:15,601 --> 00:12:18,270
for our threat hunters.

244
00:12:18,270 --> 00:12:22,441
At Google, I don't know anyone
who has been in my team,

245
00:12:24,477 --> 00:12:28,547
who hasn't asked for a job
change after four years.

246
00:12:28,547 --> 00:12:31,183
They love Google, they love
the kind of work we do.

247
00:12:31,183 --> 00:12:32,985
They wanna stay in the team

248
00:12:32,985 --> 00:12:35,755
but they wanna do
threat intelligence.

249
00:12:35,755 --> 00:12:37,723
They wanna do forensics.

250
00:12:37,723 --> 00:12:40,693
They don't wanna
just find bad guys.

251
00:12:40,693 --> 00:12:42,828
The work gets repetitive,
it gets boring.

252
00:12:42,828 --> 00:12:46,866
The assistance are not helpful
enough and this is a problem.

253
00:12:46,866 --> 00:12:50,669
If you're a manager and
you're building your sock,

254
00:12:50,669 --> 00:12:52,271
you gotta know that your people

255
00:12:52,271 --> 00:12:54,939
aren't going to stay
here for very long.

256
00:12:54,940 --> 00:12:59,111
Four years is probably the
amount of time that you have,

257
00:13:00,880 --> 00:13:04,216
that's pretty depressing
and I'm sorry.

258
00:13:04,216 --> 00:13:08,387
But let's look at the future
because I think that the future

259
00:13:09,822 --> 00:13:12,424
really holds something
quite valuable

260
00:13:12,424 --> 00:13:16,060
and I'm gonna be somewhat
controversial with this.

261
00:13:16,061 --> 00:13:18,831
I think ultimately
by 2050 or so,

262
00:13:20,132 --> 00:13:23,669
you will have put in
place something to solve

263
00:13:23,669 --> 00:13:26,505
James Anderson's
original problem.

264
00:13:28,174 --> 00:13:31,477
We will have systems that
can defend themselves.

265
00:13:31,477 --> 00:13:33,045
They'll either be
better constructed

266
00:13:33,045 --> 00:13:35,647
and or they'll be self healing.

267
00:13:37,516 --> 00:13:40,019
Which means that the
system we have today,

268
00:13:40,019 --> 00:13:43,756
where the machines are reliant
on the humans to defend them,

269
00:13:43,756 --> 00:13:46,391
will be less and less relevant.

270
00:13:46,392 --> 00:13:50,062
And that's ultimately the
solution, the fix if you will,

271
00:13:50,062 --> 00:13:51,964
to the security problem,

272
00:13:51,964 --> 00:13:54,200
but it's gonna take a
little while to get there.

273
00:13:54,200 --> 00:13:58,537
I'm actually quite hopeful
that we will make it in 2016,

274
00:13:58,537 --> 00:14:01,407
August 2016 at
Black Hat, DefCon.

275
00:14:01,407 --> 00:14:05,277
Team Mayhem won the DARPHA
cyber ground challenge

276
00:14:05,277 --> 00:14:07,780
and this challenge
put these teams

277
00:14:07,780 --> 00:14:09,415
over a period of two years,

278
00:14:09,415 --> 00:14:12,450
was to build the
cyber reasoning system

279
00:14:12,451 --> 00:14:16,722
that could detect
vulnerabilities and patch them.

280
00:14:16,722 --> 00:14:20,992
In other words, the system
that can heal itself.

281
00:14:20,993 --> 00:14:22,895
And they did have a winner,

282
00:14:22,895 --> 00:14:24,463
unfortunately it
didn't do very well

283
00:14:24,463 --> 00:14:26,998
when it played against
the humans in CTF.

284
00:14:26,999 --> 00:14:30,236
But it was also installing
the Smithsonian this week,

285
00:14:30,236 --> 00:14:32,304
which is quite exciting.

286
00:14:32,304 --> 00:14:33,606
But I think this is the future

287
00:14:33,606 --> 00:14:36,942
and we will figure
it out at some point.

288
00:14:36,942 --> 00:14:39,612
The question is what's
the role of the human

289
00:14:39,612 --> 00:14:41,213
in this life cycle?

290
00:14:43,115 --> 00:14:44,984
The real reason you are here,

291
00:14:44,984 --> 00:14:48,954
the real meaning behind your
work is that once we've built

292
00:14:48,954 --> 00:14:51,556
a system that can learn.

293
00:14:51,557 --> 00:14:55,594
We are going to have to
teach it everything we know.

294
00:14:55,594 --> 00:14:59,265
All of the work that you do to
understand how threats work.

295
00:14:59,265 --> 00:15:00,366
How to defend systems?

296
00:15:00,366 --> 00:15:01,766
What attacks look like?

297
00:15:01,767 --> 00:15:03,502
How attackers work?

298
00:15:03,502 --> 00:15:06,204
How governments build teams
to attack of their systems?

299
00:15:06,205 --> 00:15:09,341
All of that will play
into how we teach

300
00:15:09,341 --> 00:15:12,278
the computers to
defend themselves.

301
00:15:13,512 --> 00:15:16,781
And that's the real
reason why we are here.

302
00:15:16,782 --> 00:15:21,353
And in the mean time, get to
defend and chase bad guys too.

303
00:15:21,353 --> 00:15:24,489
And I will point out that
this terminator magical future

304
00:15:24,490 --> 00:15:28,594
will be able to spell for
itself, better than me.

305
00:15:32,932 --> 00:15:36,936
My CEO is very fond of
saying this kind of thing

306
00:15:38,070 --> 00:15:40,706
that we will have
intelligent assistant

307
00:15:40,706 --> 00:15:44,143
that will be able to help
us as we move forward.

308
00:15:44,143 --> 00:15:49,081
Turns out you've actually
been building them all along,

309
00:15:49,081 --> 00:15:52,451
they will start to get
more, more intelligent.

310
00:15:52,451 --> 00:15:56,655
Right now if you say OK
Google what is Burger King?

311
00:15:56,655 --> 00:15:59,725
May not read out
what you expected to

312
00:15:59,725 --> 00:16:01,994
but it will become
more intelligent

313
00:16:01,994 --> 00:16:04,530
and they will be more helpful.

314
00:16:04,530 --> 00:16:07,699
Imagine being able
to say okay Splunk.

315
00:16:09,568 --> 00:16:12,404
It might compromise APT28
then while you're in there,

316
00:16:12,404 --> 00:16:16,508
look for APT29 too
and it replying back.

317
00:16:16,508 --> 00:16:18,877
"No you're not compromised

318
00:16:18,877 --> 00:16:21,045
"and I've downloaded all
the threat intelligence.

319
00:16:21,046 --> 00:16:23,015
"I've incorporated
into the defense

320
00:16:23,015 --> 00:16:25,951
"and I'll let you know
if I see anything."

321
00:16:25,951 --> 00:16:27,653
You probably won't speak to it

322
00:16:27,653 --> 00:16:31,390
but you can get the idea
of what these intelligent

323
00:16:31,390 --> 00:16:34,860
assistance will
do in the future.

324
00:16:34,860 --> 00:16:37,529
Let's talk a little
bit about Google.

325
00:16:37,529 --> 00:16:39,665
I'll spend the rest
of the time talking

326
00:16:39,665 --> 00:16:41,400
about threat hunting in Google.

327
00:16:41,400 --> 00:16:45,237
Our detection pipeline probably
doesn't look that remarkable

328
00:16:45,237 --> 00:16:46,637
relative to what you're used to.

329
00:16:46,638 --> 00:16:51,510
We invest hundreds and
hundreds of gigabytes every day

330
00:16:51,510 --> 00:16:52,811
and we store it for long periods

331
00:16:52,811 --> 00:16:55,481
of time in a large data store.

332
00:16:55,481 --> 00:16:58,417
And I think between the
threat intelligence data

333
00:16:58,417 --> 00:17:01,520
and our logs daily, we
probably got petabyte bite,

334
00:17:01,520 --> 00:17:03,756
at least, maybe two.

335
00:17:03,756 --> 00:17:06,692
And over that, we run a
number of engine systems

336
00:17:06,692 --> 00:17:08,293
on a regular basis.

337
00:17:09,694 --> 00:17:12,097
Static rules, advance models,

338
00:17:13,699 --> 00:17:15,200
a little bit of machine
learning in there,

339
00:17:15,200 --> 00:17:19,171
some statistical analysis
and we test everything too.

340
00:17:19,171 --> 00:17:21,106
I'll get to that in a second.

341
00:17:21,106 --> 00:17:24,009
And out pop events that
the humans do look up

342
00:17:24,009 --> 00:17:26,645
and we enrich them with data.

343
00:17:26,645 --> 00:17:29,415
About 80% of all of the
events that do manage

344
00:17:29,415 --> 00:17:32,518
to get to a human
are already enriched

345
00:17:32,518 --> 00:17:34,486
with everything
you'd want to know,

346
00:17:34,486 --> 00:17:37,022
in order to determine as a human

347
00:17:37,022 --> 00:17:39,390
whether or not this is bad.

348
00:17:39,391 --> 00:17:43,562
So I guess imagine you have
a binary execute on the fleet

349
00:17:45,364 --> 00:17:47,699
and AV triggers that it did.

350
00:17:49,568 --> 00:17:53,238
We obviously get the AV alert,
we know that it executed.

351
00:17:53,238 --> 00:17:55,774
We will go grab a
copy of that binary.

352
00:17:55,774 --> 00:17:57,976
We will run it through the
binary pipeline systems

353
00:17:57,976 --> 00:18:00,012
such as virus tool.

354
00:18:00,012 --> 00:18:01,547
You will know everything
about the user,

355
00:18:01,547 --> 00:18:04,716
where the user was, how long
the machine has been there,

356
00:18:04,716 --> 00:18:05,984
whether the machine is patched.

357
00:18:05,984 --> 00:18:08,986
All of this data ends up
in front of the analyst,

358
00:18:08,987 --> 00:18:11,657
so that they spend a
minimal amount of time

359
00:18:11,657 --> 00:18:14,927
during the toil of
the uncreative work,

360
00:18:16,395 --> 00:18:20,199
determining whether or not
the system is compromised.

361
00:18:21,333 --> 00:18:23,569
And because of that
these enrichment systems

362
00:18:23,569 --> 00:18:26,772
that do detection
based on those raw data

363
00:18:26,772 --> 00:18:29,108
are actually the
intelligent assistant

364
00:18:29,108 --> 00:18:31,110
that are being built today.

365
00:18:31,110 --> 00:18:34,580
When we talk about
machine learning,

366
00:18:34,580 --> 00:18:38,884
this is where we want the
machines to help today.

367
00:18:38,884 --> 00:18:41,587
We want them to be able assist
us in making determinations

368
00:18:41,587 --> 00:18:44,857
and pointing us in
the right direction.

369
00:18:46,492 --> 00:18:49,128
From a team perspective,
here's how we're laid out.

370
00:18:49,128 --> 00:18:51,295
We have a team that
does threat analysis.

371
00:18:51,296 --> 00:18:54,199
We have a team that does
security monitoring tools.

372
00:18:54,199 --> 00:18:56,068
These are big
infrastructure projects

373
00:18:56,068 --> 00:18:58,837
that can store
petabytes of data.

374
00:18:58,837 --> 00:19:02,808
And we have a security
surveillance team.

375
00:19:02,808 --> 00:19:06,712
This is not a sock but it
is probably what you would

376
00:19:06,712 --> 00:19:08,847
think of as a sock.

377
00:19:08,847 --> 00:19:12,751
And we have borrowed this
language from James Anderson.

378
00:19:12,751 --> 00:19:16,488
The idea of surveillance,
not just detection.

379
00:19:16,488 --> 00:19:19,224
And this is the team that hunts.

380
00:19:19,224 --> 00:19:23,162
This is also the team that
triages the event coming out

381
00:19:23,162 --> 00:19:25,697
of the detection pipeline.

382
00:19:25,697 --> 00:19:26,831
We have a digital forensics team

383
00:19:26,832 --> 00:19:29,168
and we have an incident
management team.

384
00:19:29,168 --> 00:19:31,669
And we make clear lines
about responsibility

385
00:19:31,670 --> 00:19:34,173
so that we understand
how many people we need,

386
00:19:34,173 --> 00:19:36,575
but in reality a
lot of the actions

387
00:19:36,575 --> 00:19:39,244
that we do are cross functional.

388
00:19:40,445 --> 00:19:42,347
This is probably the
most important thing

389
00:19:42,347 --> 00:19:44,183
that we have realized,

390
00:19:46,185 --> 00:19:50,121
is that you should only
ever have to hunt once.

391
00:19:51,823 --> 00:19:55,060
Our analyst when they
dive into do hunting,

392
00:19:55,060 --> 00:19:56,628
think about it this way.

393
00:19:56,628 --> 00:19:58,062
They're doing research.

394
00:19:58,063 --> 00:20:00,165
They're trying to
understand something new.

395
00:20:00,165 --> 00:20:03,601
Maybe it's getting an
idea of what new Windows

396
00:20:03,602 --> 00:20:06,638
persistence mechanisms
exist on Windows 10

397
00:20:06,638 --> 00:20:09,073
verses Windows 8 and Windows 7.

398
00:20:09,074 --> 00:20:11,810
They'll build a hypothesis.

399
00:20:11,810 --> 00:20:13,212
They will hunt,
they will iteration

400
00:20:13,212 --> 00:20:15,480
until the hunts work properly

401
00:20:15,480 --> 00:20:17,282
and until we have
cleared the backlog,

402
00:20:17,282 --> 00:20:20,953
and we understand whether or
not the feat is compromised

403
00:20:20,953 --> 00:20:24,556
and then they will
write a true detector

404
00:20:24,556 --> 00:20:27,125
that can run all the time.

405
00:20:27,125 --> 00:20:30,362
And they will also
write a test for it.

406
00:20:32,364 --> 00:20:36,401
The idea here being that you
should never have signal drop.

407
00:20:36,401 --> 00:20:39,004
You should always know whether
or not your detection works

408
00:20:39,004 --> 00:20:41,173
the way that you expected it to.

409
00:20:41,173 --> 00:20:44,142
And the cycles upon itself
but it means that we're never

410
00:20:44,142 --> 00:20:47,279
doing the hunting
more than once.

411
00:20:47,279 --> 00:20:50,082
With the exception of when
we have to do it again,

412
00:20:50,082 --> 00:20:52,284
so in new environments.

413
00:20:52,284 --> 00:20:53,885
So for those of you
who have companies

414
00:20:53,885 --> 00:20:56,822
where you acquire
another company,

415
00:20:56,822 --> 00:20:59,725
and they keep a little bit of
their legacy infrastructure.

416
00:20:59,725 --> 00:21:03,962
Redoing your hunts is actually
a really good thing to do

417
00:21:03,962 --> 00:21:07,899
to either understand
that it was pre-owned.

418
00:21:07,899 --> 00:21:11,669
Or if clean, otherwise
will use the detection

419
00:21:14,373 --> 00:21:17,342
in this new detection
kind of development cycle,

420
00:21:17,342 --> 00:21:19,311
and then also spot checks,

421
00:21:19,311 --> 00:21:22,147
and sometimes as
training as well.

422
00:21:24,283 --> 00:21:25,684
We have started three kinds of

423
00:21:25,684 --> 00:21:28,687
hunting grounds
because I call them.

424
00:21:30,088 --> 00:21:34,226
We have of course the big
repository of stored raw data

425
00:21:35,427 --> 00:21:38,463
which we will hunt with
a sequel like interface,

426
00:21:38,463 --> 00:21:40,866
and it will process
it and another tools.

427
00:21:40,866 --> 00:21:42,434
You've heard about
some of these tools,

428
00:21:42,434 --> 00:21:44,603
DNS logs, file monitoring,

429
00:21:45,804 --> 00:21:47,973
these are behaviors,
all these things stand

430
00:21:47,973 --> 00:21:52,144
in the historical record are
very good for manual hunting.

431
00:21:53,345 --> 00:21:55,480
But because in the
second category,

432
00:21:55,480 --> 00:21:58,283
because the detection
system generates

433
00:21:58,283 --> 00:22:00,819
so many alerts, so many things.

434
00:22:01,987 --> 00:22:03,288
You actually make
a clear delineation

435
00:22:03,288 --> 00:22:05,891
between what we have
have confidence in

436
00:22:05,891 --> 00:22:08,393
and absolutely put in
front of an analyst,

437
00:22:08,393 --> 00:22:10,495
and what we think
is low confidence.

438
00:22:10,495 --> 00:22:14,866
And so that the surveillance
team will actually spend

439
00:22:14,866 --> 00:22:18,303
a lot of time looking
in this noisy mess.

440
00:22:20,339 --> 00:22:22,139
And here's where we
really see the creativity

441
00:22:22,140 --> 00:22:24,209
of their specific field.

442
00:22:24,209 --> 00:22:27,045
People who love net flow
will gravitate there.

443
00:22:27,045 --> 00:22:29,481
People who love Windows
will gravitate there,

444
00:22:29,481 --> 00:22:32,684
and they usually have a
few tricks up their sleeve

445
00:22:32,684 --> 00:22:34,286
that they're really good at

446
00:22:34,286 --> 00:22:36,822
in looking at this noisy data.

447
00:22:36,822 --> 00:22:38,657
And once you can find
stuff in the noisy data,

448
00:22:38,657 --> 00:22:42,828
you can interface on making
the detectors even better.

449
00:22:44,229 --> 00:22:49,101
And finally, we have GRR
and it was mentioned earlier

450
00:22:49,101 --> 00:22:53,238
in the context of memory
hunting in the fleet,

451
00:22:53,238 --> 00:22:56,808
but we look at GRR really
as one of the most powerful

452
00:22:56,808 --> 00:22:58,744
weapons on our network.

453
00:22:59,678 --> 00:23:01,980
It is an agent-based system.

454
00:23:01,980 --> 00:23:05,584
Originally designed so that
we can do live forensics.

455
00:23:05,584 --> 00:23:09,254
We too had problems needing
to do forensic on machines

456
00:23:09,254 --> 00:23:11,790
in Brazil and not being
able to get shipping,

457
00:23:11,790 --> 00:23:13,558
so we could get the hard drive.

458
00:23:13,558 --> 00:23:16,862
And this is been on the
fleet for seven years.

459
00:23:16,862 --> 00:23:20,365
It's relatively stable, runs
on Linux, Mac and Windows

460
00:23:20,365 --> 00:23:23,635
and we use it for all
kinds of hunting as well,

461
00:23:23,635 --> 00:23:26,405
and it has a hunting interface.

462
00:23:26,405 --> 00:23:28,139
And I'm not going to go
into the interface here

463
00:23:28,140 --> 00:23:31,810
although I did last year if you
want to check out that talk.

464
00:23:31,810 --> 00:23:34,413
But we can do almost
any kind of hunting

465
00:23:34,413 --> 00:23:36,748
with GRR in the fleet,

466
00:23:36,748 --> 00:23:41,019
and I'll talk about a few
of them in a slide or two.

467
00:23:41,019 --> 00:23:44,356
So I mentioned the
security surveillance team.

468
00:23:44,356 --> 00:23:46,691
This is effectively our attempt

469
00:23:46,691 --> 00:23:49,494
at making a fully
automated sock.

470
00:23:49,494 --> 00:23:53,165
I mentioned that almost 80%
of everything that ends up

471
00:23:53,165 --> 00:23:56,534
in front of an analyst has
been enriched with data.

472
00:23:56,535 --> 00:23:59,738
We also have a large
proportion of incidents

473
00:23:59,738 --> 00:24:03,942
that are automatically
resolved by machines today.

474
00:24:03,942 --> 00:24:07,479
If you have something
very mundane and routine

475
00:24:07,479 --> 00:24:10,315
that we wouldn't
be concerned about.

476
00:24:10,315 --> 00:24:13,518
And so the security surveillance
team splits its time

477
00:24:13,518 --> 00:24:15,120
between two sets of activities.

478
00:24:15,120 --> 00:24:17,022
40% of its time on
what I like to call

479
00:24:17,022 --> 00:24:20,958
tactical surveillance
and this is Ops.

480
00:24:20,959 --> 00:24:23,462
These are things
that are task driven.

481
00:24:23,462 --> 00:24:26,298
Things that can be
completed in one shift.

482
00:24:26,298 --> 00:24:30,469
Event triage, hunting in
this pre-processed data set

483
00:24:33,705 --> 00:24:38,143
or even doing intel
driven checks of the fleet

484
00:24:38,143 --> 00:24:39,511
to understand whether or not

485
00:24:39,511 --> 00:24:42,147
we're compromised by
something specific.

486
00:24:42,147 --> 00:24:45,951
And the other 40%,
they will spend looking

487
00:24:45,951 --> 00:24:48,453
at technology specific projects.

488
00:24:48,453 --> 00:24:50,021
We will have lots of technology.

489
00:24:50,021 --> 00:24:51,990
We have Windows, we have Linux,

490
00:24:51,990 --> 00:24:54,493
we have Mac, we have mobile,

491
00:24:54,493 --> 00:24:56,428
and we're doing this
thing called Cloud.

492
00:24:56,428 --> 00:25:00,565
We have a very large Linux
fleet and so what we do is

493
00:25:01,733 --> 00:25:03,467
we actually divide
the responsibilities

494
00:25:03,468 --> 00:25:08,273
for this 40% time amongst
those different platforms.

495
00:25:08,273 --> 00:25:11,576
And it allows the analyst
to become specialized

496
00:25:11,576 --> 00:25:14,546
in that field and they will
know everything there is to know

497
00:25:14,546 --> 00:25:16,648
about the next persistent

498
00:25:16,648 --> 00:25:19,650
or everything there is to
know about Mac persistence.

499
00:25:19,651 --> 00:25:21,186
Because we are not situation

500
00:25:21,186 --> 00:25:23,788
where all of these
platforms are more or less

501
00:25:23,788 --> 00:25:26,124
managed and treated equally,

502
00:25:27,526 --> 00:25:31,263
and as we know from experience,
our adversaries do the same.

503
00:25:32,430 --> 00:25:35,600
They will focus
thus on adjusting

504
00:25:35,600 --> 00:25:38,703
all the threat intelligence
that comes out, that's specific.

505
00:25:38,703 --> 00:25:42,706
They will do detector
development based on that data

506
00:25:42,707 --> 00:25:46,278
and they will do this
hypothesis driven hunting,

507
00:25:46,278 --> 00:25:48,980
usually on a month
to a quarterly basis

508
00:25:48,980 --> 00:25:52,083
and not all the time
because it is quite intense

509
00:25:52,083 --> 00:25:54,319
as we've heard some
previous speakers.

510
00:25:54,319 --> 00:25:56,388
And they will also
work significantly

511
00:25:56,388 --> 00:26:00,391
on automation and testing
within their field.

512
00:26:00,392 --> 00:26:03,695
And by doing this understanding
how many platforms we have.

513
00:26:03,695 --> 00:26:06,564
We can understand how
many people we need

514
00:26:06,565 --> 00:26:09,668
and we can understand how much
time they need to set aside

515
00:26:09,668 --> 00:26:11,770
in order to do this
creative hunting

516
00:26:11,770 --> 00:26:14,205
and to keep us moving forward.

517
00:26:14,205 --> 00:26:18,610
You'll notice this does
not add up to 100%.

518
00:26:18,610 --> 00:26:20,645
Google has a mythical 20%

519
00:26:20,645 --> 00:26:23,315
that you can spend any
of your time doing,

520
00:26:23,315 --> 00:26:24,816
and there are three
of them in the room,

521
00:26:24,816 --> 00:26:28,887
and I'm not going to tell
them that it doesn't exist.

522
00:26:30,922 --> 00:26:33,825
Alright, I did wanna talk
about some of the kinds

523
00:26:33,825 --> 00:26:36,261
of hunting activities
we might do.

524
00:26:36,261 --> 00:26:37,596
Some of this will
overlap with things

525
00:26:37,596 --> 00:26:39,931
that you've heard in
the last two days.

526
00:26:39,931 --> 00:26:41,132
Let's just take some examples

527
00:26:41,132 --> 00:26:44,536
of what we might do with
our stored raw data.

528
00:26:44,536 --> 00:26:46,271
And again the
interface to this data

529
00:26:46,271 --> 00:26:48,173
is a sequel like interface.

530
00:26:48,173 --> 00:26:49,708
If you've ever use
Google products,

531
00:26:49,708 --> 00:26:53,878
there's one called BigQuery
and it most resembles that.

532
00:26:55,380 --> 00:26:57,749
Typically what we'll do is
we'll build a hypothesis,

533
00:26:57,749 --> 00:26:59,351
and I love DNS data
so I'm gonna pick

534
00:26:59,351 --> 00:27:01,553
on these for a little bit.

535
00:27:01,553 --> 00:27:03,521
Strangely enough
attackers are still using

536
00:27:03,521 --> 00:27:06,758
dying DNS host
names for their C2,

537
00:27:06,758 --> 00:27:09,394
which they do so that
they can easily move

538
00:27:09,394 --> 00:27:13,398
where it points to if their
infrastructure has to be moved.

539
00:27:13,398 --> 00:27:15,433
The method we would
use here is of course

540
00:27:15,433 --> 00:27:17,535
to compare the DNS
queries that are happening

541
00:27:17,535 --> 00:27:21,606
on the corporate network, for
which we have all of them.

542
00:27:21,606 --> 00:27:24,609
Every DNS query that has
ever been issued on Google

543
00:27:24,609 --> 00:27:27,946
since September of
2009, we keep it all.

544
00:27:29,814 --> 00:27:32,751
And in this particular
hunt, what you could do is

545
00:27:32,751 --> 00:27:36,354
take the list, this
list here at the bottom

546
00:27:37,822 --> 00:27:38,989
which is a public list.

547
00:27:38,990 --> 00:27:41,192
Filter out those
dying DNS host names.

548
00:27:41,192 --> 00:27:43,628
You figure out why
anybody on your network

549
00:27:43,628 --> 00:27:45,964
would ever be using them.

550
00:27:45,964 --> 00:27:48,700
This is the kind of
hunt that we might do.

551
00:27:48,700 --> 00:27:51,536
Similarly and we've
had pretty good success

552
00:27:51,536 --> 00:27:54,839
with this in the past is to
take a big chunk of data,

553
00:27:54,839 --> 00:27:58,009
maybe 60 days worth
of DNS query logs.

554
00:27:59,144 --> 00:28:02,914
Sort to find the things
that are first seen

555
00:28:02,914 --> 00:28:05,950
as in they don't happen often.

556
00:28:05,950 --> 00:28:09,254
Facebook happens often,
Google happens often

557
00:28:09,254 --> 00:28:12,524
but something like
bananatomatokiwi.com

558
00:28:13,925 --> 00:28:18,129
is probably seen for the
first time in this 60 days.

559
00:28:18,129 --> 00:28:20,965
Probably something
interesting to look at

560
00:28:20,965 --> 00:28:22,434
and we have actually
found secondary

561
00:28:22,434 --> 00:28:26,604
and tertiary persistence
implants using this method.

562
00:28:28,573 --> 00:28:30,508
It's quite interesting.

563
00:28:31,710 --> 00:28:35,180
Moving onto GRR and how
we might hunt the fleet.

564
00:28:35,180 --> 00:28:37,849
Here are a few things that
I like to do especially

565
00:28:37,849 --> 00:28:40,150
for going to a new environment,

566
00:28:40,151 --> 00:28:42,387
should as a company
that we just bought.

567
00:28:42,387 --> 00:28:46,558
We will deploy GRR and we'll
just have a basic hypothesis.

568
00:28:48,159 --> 00:28:51,730
Maybe they've left really
common artifacts behind,

569
00:28:51,730 --> 00:28:54,332
lateral movement
such as out jobs.

570
00:28:54,332 --> 00:28:57,035
Maybe we'll find evidence of
the execution of their tools

571
00:28:57,035 --> 00:28:59,771
by collecting all
the pre-fetch files.

572
00:28:59,771 --> 00:29:01,773
These files are
actually pretty small,

573
00:29:01,773 --> 00:29:04,476
you can collect them
for a whole fleet,

574
00:29:04,476 --> 00:29:08,513
process them with bash
script pretty much,

575
00:29:08,513 --> 00:29:10,348
understand what is
executed on your fleet,

576
00:29:10,348 --> 00:29:12,082
and find outliers.

577
00:29:12,083 --> 00:29:15,086
It's a really basic technique
and 9 times out of 10,

578
00:29:15,086 --> 00:29:16,387
unfortunately I founded to be

579
00:29:16,387 --> 00:29:18,990
pretty, pretty straightforward.

580
00:29:20,158 --> 00:29:23,026
You can do a similar
thing with RunKeys

581
00:29:23,027 --> 00:29:25,764
and on the Mac, the
equivalent to launch agents.

582
00:29:25,764 --> 00:29:30,334
And on well-maintained
fleets that are small such as

583
00:29:30,335 --> 00:29:31,870
just your server environment.

584
00:29:31,870 --> 00:29:34,805
This can actually
work really well.

585
00:29:34,806 --> 00:29:39,778
Once you get to desktops and
laptops, it's a nightmare.

586
00:29:39,778 --> 00:29:42,347
People have all kinds
of things installed.

587
00:29:42,347 --> 00:29:44,349
Another nightmare scenario is

588
00:29:44,349 --> 00:29:46,317
we have this great
hypothesis once

589
00:29:46,317 --> 00:29:49,320
and I think it was based
on it an intel report.

590
00:29:49,320 --> 00:29:52,924
That adversaries were
storing their binary blogs

591
00:29:52,924 --> 00:29:57,529
in registry keys, making the
registry keys really big.

592
00:29:57,529 --> 00:29:59,597
So we thought well what
if we just went through

593
00:29:59,597 --> 00:30:01,466
and found all the
big registry keys

594
00:30:01,466 --> 00:30:03,400
that had binary data in them,

595
00:30:03,401 --> 00:30:06,371
download them to figure
out how bad they were.

596
00:30:06,371 --> 00:30:08,273
And I remember thinking,
we're probably not gonna find

597
00:30:08,273 --> 00:30:12,776
more than 10 or 20, and it
turns out that almost every

598
00:30:12,777 --> 00:30:17,348
camera software for some reason,
stores their binary blogs

599
00:30:17,348 --> 00:30:19,783
in the registry, and it
was a complete disaster.

600
00:30:19,784 --> 00:30:22,520
So this is an example of a hunt,

601
00:30:22,520 --> 00:30:24,389
we would choose not to automate.

602
00:30:24,389 --> 00:30:25,622
Choose not to use again,

603
00:30:25,623 --> 00:30:28,693
but it was a good
test to do one time

604
00:30:28,693 --> 00:30:30,360
just to see whether or not

605
00:30:30,361 --> 00:30:33,631
we could find what
we were looking for.

606
00:30:35,133 --> 00:30:38,336
And finally, actually I've
got two more examples.

607
00:30:38,336 --> 00:30:40,271
So here's a great
example of something

608
00:30:40,271 --> 00:30:44,108
that we did and we automated
and it worked really well.

609
00:30:44,108 --> 00:30:48,279
Any binary executed on the
fleet is collected centrally.

610
00:30:50,014 --> 00:30:52,684
And the way that we do this
is we understand deeply

611
00:30:52,684 --> 00:30:56,855
from our detection pipeline,
the things that have executed.

612
00:30:58,089 --> 00:31:01,292
And we will use GRR to
fetch a copy the file

613
00:31:01,292 --> 00:31:04,395
if we have never seen it before.

614
00:31:04,395 --> 00:31:08,399
We will then put it through
the binary pipelines.

615
00:31:08,399 --> 00:31:11,268
Virus total is a binary
pipeline that we own

616
00:31:11,269 --> 00:31:15,006
but we have others and we
will try to get an idea

617
00:31:15,006 --> 00:31:17,809
of whether or not
it's good or bad.

618
00:31:17,809 --> 00:31:19,476
And if it's bad, we'll
put it in front of

619
00:31:19,477 --> 00:31:21,946
an analyst to triage.

620
00:31:21,946 --> 00:31:25,382
And we do this for
all the platforms,

621
00:31:25,383 --> 00:31:26,784
Linus, Mac and Windows.

622
00:31:26,784 --> 00:31:30,488
And I should mention
that GRR is open source.

623
00:31:30,488 --> 00:31:33,558
If you just do a
Bing search for GRR,

624
00:31:38,696 --> 00:31:40,164
you'll find it, I
actually don't know

625
00:31:40,164 --> 00:31:41,666
where it sits in their rankings,

626
00:31:41,666 --> 00:31:44,702
but presumably it's
on the first page.

627
00:31:44,702 --> 00:31:46,671
And the team that works on this

628
00:31:46,671 --> 00:31:48,239
actually does a lot
of public talks,

629
00:31:48,239 --> 00:31:51,876
and there are other
teams who publicly

630
00:31:51,876 --> 00:31:53,645
give talks on their
use of GRR as while.

631
00:31:53,645 --> 00:31:54,746
So if you're interested in that,

632
00:31:54,746 --> 00:31:57,382
that is certainly available

633
00:31:57,382 --> 00:32:00,551
but this is actually been
a really good example

634
00:32:00,551 --> 00:32:01,785
of something that
is easy to automate

635
00:32:01,786 --> 00:32:04,889
where the results are
fairly high fidelity

636
00:32:04,889 --> 00:32:08,825
so the analyst is not
exhausted looking at it.

637
00:32:08,826 --> 00:32:11,562
And finally here's an
example of a hunt that

638
00:32:11,562 --> 00:32:12,830
when the team proposed it,

639
00:32:12,830 --> 00:32:14,365
I thought it was a
really dumb idea.

640
00:32:14,365 --> 00:32:15,600
Because I thought there's no way

641
00:32:15,600 --> 00:32:17,135
you're ever gonna pull this off.

642
00:32:17,135 --> 00:32:18,636
So what they do
is they integrated

643
00:32:18,636 --> 00:32:20,138
something called Chipsec.

644
00:32:20,138 --> 00:32:24,074
This is an open source project
that essentially enables you

645
00:32:25,443 --> 00:32:28,279
to get a copy of
the BIOS or UEFI,

646
00:32:30,448 --> 00:32:32,684
that's running on the machine.

647
00:32:32,684 --> 00:32:35,820
And after toiling at
this for quite some time,

648
00:32:35,820 --> 00:32:39,357
they got it to work
and interesting,

649
00:32:39,357 --> 00:32:42,694
all of our hypotheses
were proven wrong.

650
00:32:43,795 --> 00:32:46,297
I had thought perhaps
that a Mac fleet

651
00:32:46,297 --> 00:32:50,301
that's well maintained
might just have one copy

652
00:32:50,301 --> 00:32:53,037
or one version of the firmware,

653
00:32:53,037 --> 00:32:57,208
because Apple is so completely
meticulous about making sure

654
00:32:58,409 --> 00:33:00,044
that there aren't
very many out there.

655
00:33:00,044 --> 00:33:03,047
But actually there were a lot
but they did cluster nicely

656
00:33:03,047 --> 00:33:05,550
until like eight
or nine clusters.

657
00:33:05,550 --> 00:33:07,719
And so you can see
that that clearly

658
00:33:07,719 --> 00:33:11,556
wasn't one outlier
that looked unusual.

659
00:33:11,556 --> 00:33:14,993
In PC environments,
an absolute disaster.

660
00:33:16,394 --> 00:33:20,565
Firmware on PCs, there's
just no way to get uniformity

661
00:33:21,933 --> 00:33:23,668
and there's actually
there's no way to verify

662
00:33:23,668 --> 00:33:27,104
that what you're looking
at is legitimate.

663
00:33:27,105 --> 00:33:30,408
The people who make this
hardware are not actively

664
00:33:30,408 --> 00:33:34,178
participating in making sure
that we could verify it,

665
00:33:34,178 --> 00:33:37,982
and that it's safe and this
is a really difficult problem.

666
00:33:37,982 --> 00:33:40,018
If you're interested,
the team that

667
00:33:40,018 --> 00:33:44,188
executed this particular hunt
led by Thiebaud Weksteen.

668
00:33:45,623 --> 00:33:49,460
Spoke at Ruxcon last fall and
that's available up online.

669
00:33:50,728 --> 00:33:52,163
And all the software
that they used

670
00:33:52,163 --> 00:33:53,531
is has been open source.

671
00:33:53,531 --> 00:33:56,100
So that's available,
if you're interested.

672
00:33:56,100 --> 00:33:58,636
I think for most teams,

673
00:33:58,636 --> 00:34:02,940
this is not a hunt that
is worth your time.

674
00:34:02,940 --> 00:34:04,542
But if you are consultant

675
00:34:04,542 --> 00:34:06,077
and you can figure
out how to do this.

676
00:34:06,077 --> 00:34:07,612
You could probably
charge a billion dollars

677
00:34:07,612 --> 00:34:09,647
to every organization
to just come in

678
00:34:09,647 --> 00:34:12,315
and verify their fleet for them.

679
00:34:15,887 --> 00:34:18,456
A few other things that
make me really happy,

680
00:34:18,456 --> 00:34:22,794
hunting for, not that I ever
get to do anything real,

681
00:34:22,793 --> 00:34:25,730
unless I take vacation
and then work during it.

682
00:34:25,730 --> 00:34:28,933
But last year I spoke
on hunting memory

683
00:34:28,933 --> 00:34:33,103
and using GRR and Yara and
that was mentioned earlier.

684
00:34:35,973 --> 00:34:40,445
So if you checked last year's
summit, you'll see that,

685
00:34:40,445 --> 00:34:42,547
and we've had good
success with that.

686
00:34:42,547 --> 00:34:46,284
We can run Yara
signatures at scale

687
00:34:46,284 --> 00:34:49,454
across the entire
fleet and we do that

688
00:34:51,188 --> 00:34:53,123
with minimal interaction
with the user.

689
00:34:53,123 --> 00:34:56,660
In fact, the only user who's
ever noticed we're doing it

690
00:34:56,661 --> 00:34:58,763
happens to be a
Chrome developer,

691
00:34:58,763 --> 00:35:00,264
and it happens to my husband.

692
00:35:00,264 --> 00:35:01,899
And I think he was
doing it to annoy me

693
00:35:01,899 --> 00:35:05,837
so it actually, the
team worked really hard

694
00:35:05,837 --> 00:35:09,674
on performance aspect of this,
which was quite a challenge.

695
00:35:09,674 --> 00:35:13,244
We also do a fair
amount of memory hunting

696
00:35:13,244 --> 00:35:16,614
or can do a fair amount of
memory hunting using recall.

697
00:35:16,614 --> 00:35:19,050
Which allows us to get to some

698
00:35:19,050 --> 00:35:21,519
of the more
pertinent structures,

699
00:35:21,519 --> 00:35:25,689
not just kind of spring
matching across the fleet.

700
00:35:26,858 --> 00:35:29,527
So my advice to you
is study your history

701
00:35:29,527 --> 00:35:32,296
because our ancestors
actually have figured out

702
00:35:32,296 --> 00:35:34,464
a lot of very interesting things

703
00:35:34,465 --> 00:35:36,167
and if you read the literature,

704
00:35:36,167 --> 00:35:39,569
especially from the
1980s coming out of SRI

705
00:35:39,570 --> 00:35:41,539
and the government.

706
00:35:41,539 --> 00:35:43,007
You're gonna find some pretty

707
00:35:43,007 --> 00:35:46,144
interesting stuff in there,
maybe some useful gems.

708
00:35:46,144 --> 00:35:49,046
I would also say,
prepare for your future.

709
00:35:49,046 --> 00:35:52,183
Managers, remember this
four to five year cycle.

710
00:35:52,183 --> 00:35:54,785
I am in my job now for 15 years

711
00:35:55,853 --> 00:35:57,722
and I'm pretty committed
to where I'm at.

712
00:35:57,722 --> 00:35:59,157
If you're building a sock

713
00:35:59,157 --> 00:36:00,758
and you know you're gonna
be out in two years,

714
00:36:00,758 --> 00:36:02,426
maybe you're not gonna
think about this,

715
00:36:02,426 --> 00:36:05,363
but somebody will have to.

716
00:36:05,363 --> 00:36:06,797
Alright so think about
the talent cycle.

717
00:36:06,797 --> 00:36:10,234
If we're gonna grow
people like we grow crops,

718
00:36:10,234 --> 00:36:13,571
remember that you also
have to help them transform

719
00:36:13,571 --> 00:36:16,073
at some point in their career.

720
00:36:16,073 --> 00:36:19,442
Think about how you do time
allocation in your sock,

721
00:36:19,443 --> 00:36:21,712
in your surveillance team.

722
00:36:21,712 --> 00:36:24,715
We like the 40, the
ethical 20 rule.

723
00:36:26,484 --> 00:36:27,652
Hunt once then automate

724
00:36:27,652 --> 00:36:30,488
and choose your
tools very carefully,

725
00:36:30,488 --> 00:36:34,792
and the cases that you used
to use them very carefully.

726
00:36:34,792 --> 00:36:38,196
(uptempo drumming music)

