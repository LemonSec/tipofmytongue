1
00:00:07,073 --> 00:00:09,242
(audience clapping)

2
00:00:10,543 --> 00:00:13,645
- All right, good
morning everyone.

3
00:00:13,646 --> 00:00:17,450
Welcome to the Second
Annual Threat Hunting Summit

4
00:00:17,450 --> 00:00:19,886
here in New Orleans.

5
00:00:19,886 --> 00:00:22,255
My name is Rob Lee and
along with Phil Hagan.

6
00:00:22,255 --> 00:00:23,890
Phil, where'd you disappear to?

7
00:00:23,890 --> 00:00:26,226
You were just up here
three seconds ago.

8
00:00:26,226 --> 00:00:28,828
Phil, come on up, I just want
everyone to recognize you,

9
00:00:28,828 --> 00:00:30,964
just to introduce
both of us real quick.

10
00:00:30,964 --> 00:00:34,333
Phil and I are your masters
of ceremony, if you will,

11
00:00:35,668 --> 00:00:37,637
for the next few days.

12
00:00:37,637 --> 00:00:39,072
I'm not gonna do a formal
introduction right now

13
00:00:39,072 --> 00:00:40,807
but I just want everyone
to see your face.

14
00:00:40,807 --> 00:00:43,710
It's like, Rob has more
hair suddenly and skinnier

15
00:00:44,878 --> 00:00:47,113
(laughing)

16
00:00:47,113 --> 00:00:48,681
and better-looking somehow.

17
00:00:48,681 --> 00:00:51,351
But welcome to the summit,
really appreciate everyone

18
00:00:51,351 --> 00:00:54,921
who's able to travel in
here and not get removed

19
00:00:54,921 --> 00:00:58,291
from a flight on the way
down here as far as we know.

20
00:00:58,291 --> 00:01:00,626
Maybe that jokes a little
too soon still, right?

21
00:01:00,627 --> 00:01:03,063
Maybe, I don't know.

22
00:01:03,063 --> 00:01:06,232
Phil and I are really
happy to be here,

23
00:01:06,232 --> 00:01:09,436
especially since I'm the author
of the Hosts Analysis Class

24
00:01:09,436 --> 00:01:11,905
for threat hunting at
the SANS Institute,

25
00:01:11,905 --> 00:01:14,507
which is advanced digital
forensics, threat hunting

26
00:01:14,507 --> 00:01:16,476
and incident response.

27
00:01:16,476 --> 00:01:18,178
And Phil does the
network side of it.

28
00:01:18,178 --> 00:01:20,012
And we're gonna be
hearing from a lot

29
00:01:20,013 --> 00:01:22,882
of really interesting
case study speakers,

30
00:01:22,882 --> 00:01:27,220
technical summaries, strategic
approaches to threat hunting

31
00:01:28,354 --> 00:01:30,657
over the next week.

32
00:01:30,657 --> 00:01:32,158
Thanks, Phil.

33
00:01:32,158 --> 00:01:34,394
He's gonna do the next intro,
and so he'll do a (mumbles)

34
00:01:34,394 --> 00:01:37,063
I just wanted you to be able
to see who this individual was,

35
00:01:37,063 --> 00:01:38,398
who had been up here
planning this with me

36
00:01:38,398 --> 00:01:39,899
throughout the entire week.

37
00:01:39,899 --> 00:01:41,434
All right.

38
00:01:41,434 --> 00:01:43,603
So officially I'm kicking
things off this morning.

39
00:01:43,603 --> 00:01:47,273
Jennifer Santiago and
the summit team asked me

40
00:01:48,808 --> 00:01:51,377
about three months ago, said
how about you keynote this?

41
00:01:51,377 --> 00:01:54,080
And I say, oh great,
I'm like oh my goodness.

42
00:01:55,348 --> 00:01:56,583
I said yeah, it'll
be a great idea,

43
00:01:56,583 --> 00:01:59,686
and I had this wondrous thought.

44
00:01:59,686 --> 00:02:03,323
And it's funny, for anyone
who has seen Westworld,

45
00:02:03,323 --> 00:02:06,726
and I'm just gonna do
a quick question here,

46
00:02:06,726 --> 00:02:10,395
how many of you have
seen Westworld on HBO?

47
00:02:10,395 --> 00:02:12,065
All right, how many have no idea

48
00:02:12,065 --> 00:02:14,834
of what Westworld is
on HBO, including,

49
00:02:14,834 --> 00:02:16,136
Jennifer, you should
be raising your hand.

50
00:02:16,136 --> 00:02:17,403
(laughs)

51
00:02:17,403 --> 00:02:19,037
because I sit my
initial (mumbles),

52
00:02:19,038 --> 00:02:22,041
and she said I have no
idea what this is about.

53
00:02:22,041 --> 00:02:23,877
(laughs)

54
00:02:23,877 --> 00:02:26,079
But when I was
watching the show,

55
00:02:26,079 --> 00:02:28,515
if anyone who's
familiar with the show,

56
00:02:28,515 --> 00:02:30,916
and I'll just give you kind
of the basics of the show,

57
00:02:30,917 --> 00:02:34,921
is that it's based on the
movie from Michael Crichton

58
00:02:34,921 --> 00:02:38,057
that came out in the 70s.

59
00:02:38,057 --> 00:02:40,125
I actually think it came
out like the year I was born

60
00:02:40,126 --> 00:02:41,628
or something like that.

61
00:02:41,628 --> 00:02:42,862
I've actually watched it since

62
00:02:42,862 --> 00:02:45,398
because I became a
big HBO Westworld fan,

63
00:02:45,398 --> 00:02:47,600
but it's based off
of that human beings,

64
00:02:47,600 --> 00:02:50,136
you and I, go into this park

65
00:02:50,136 --> 00:02:53,373
to basically act
out our fantasies

66
00:02:53,373 --> 00:02:56,009
of being in the Wild West.

67
00:02:56,009 --> 00:02:58,043
And I was watching the show,

68
00:02:58,044 --> 00:03:00,146
is that the show goes
through a repetitive loop

69
00:03:00,146 --> 00:03:03,215
with slight variations that
occur on a daily basis.

70
00:03:05,151 --> 00:03:08,721
The park inhabitants are robots.

71
00:03:08,721 --> 00:03:12,659
And again, everyone, that's
done in the first 15 minutes

72
00:03:12,659 --> 00:03:14,560
of the first episode,
so I hope I'm not

73
00:03:14,561 --> 00:03:15,895
spoiling too much here.

74
00:03:15,895 --> 00:03:19,032
But the park
inhabitants are robots.

75
00:03:19,032 --> 00:03:22,769
And the robots are kind
of living their day to day

76
00:03:24,637 --> 00:03:28,374
and they end up on a very
interesting loop that occurs

77
00:03:29,776 --> 00:03:32,045
from every single
day they wake up,

78
00:03:32,045 --> 00:03:34,613
and they kind of live
this same pattern.

79
00:03:34,614 --> 00:03:36,883
And then we as human
beings come in there

80
00:03:36,883 --> 00:03:38,785
and we interact with them
and it kind of changes

81
00:03:38,785 --> 00:03:41,654
their storyline
on a daily basis.

82
00:03:41,654 --> 00:03:45,391
Now I was watching this,
and I leaned over to my wife

83
00:03:45,391 --> 00:03:48,595
because she really
got into the show too,

84
00:03:48,595 --> 00:03:52,131
and I said this is
what my job feels like.

85
00:03:52,131 --> 00:03:55,902
I said, I wake up and I do
the same thing day in day out,

86
00:03:55,902 --> 00:03:57,936
when we're doing instant
response and threat hunting

87
00:03:57,937 --> 00:04:01,808
because our threats and
what we're encountering

88
00:04:01,808 --> 00:04:04,744
over the years that
we've been doing this,

89
00:04:04,744 --> 00:04:07,614
they come back, first of all,
you know this is not a shock

90
00:04:07,614 --> 00:04:09,515
for everyone in here, you're
in here because we're having

91
00:04:09,515 --> 00:04:12,084
trouble identifying
them, but they come back

92
00:04:12,085 --> 00:04:13,987
and they slightly
vary their techniques

93
00:04:13,987 --> 00:04:17,824
and change the storyline
in just a very small way.

94
00:04:19,524 --> 00:04:22,027
And so this analogy
I initially bring in,

95
00:04:22,028 --> 00:04:23,529
and I thought I was
like really smart,

96
00:04:23,529 --> 00:04:25,031
it's like oh my
goodness, look how,

97
00:04:25,031 --> 00:04:27,066
like puffing my chest
here a little bit

98
00:04:27,066 --> 00:04:29,068
and saying, wow look how
smart I am in this analogy;

99
00:04:29,068 --> 00:04:31,404
and then I pass my initial
description over to Jennifer

100
00:04:31,404 --> 00:04:33,706
and she writes me an email
back and says, I don't get it.

101
00:04:33,706 --> 00:04:36,109
Then I pass it to my
team and Phil read it,

102
00:04:36,109 --> 00:04:38,510
and he's response back,
I don't watch Westworld.

103
00:04:38,511 --> 00:04:41,447
Then it dawned on me that it's
actually a smaller community

104
00:04:41,447 --> 00:04:43,616
out there that actually watched
this show yet at this point,

105
00:04:43,616 --> 00:04:47,654
so I decided to ditch the
in-depth very sneaky analogies

106
00:04:47,654 --> 00:04:50,657
while going through
this, but I still,

107
00:04:50,657 --> 00:04:53,126
you're gonna see where
this theme of we live

108
00:04:53,126 --> 00:04:56,529
currently in hunt world where
we're living on this cycle

109
00:04:56,529 --> 00:04:58,765
on a daily basis.

110
00:04:58,765 --> 00:05:00,800
Now the thing about
threat hunting,

111
00:05:00,800 --> 00:05:04,604
when we try and pull
it down to its core,

112
00:05:06,105 --> 00:05:09,208
and this is where,
as everyone in here

113
00:05:09,208 --> 00:05:11,744
in the information
security community,

114
00:05:11,744 --> 00:05:14,147
kind of are at a disadvantage
because currently,

115
00:05:14,147 --> 00:05:17,650
depending on how you
read vendor reports

116
00:05:17,650 --> 00:05:19,152
and how you listen to your peers

117
00:05:19,152 --> 00:05:21,320
and currently how you engage
on these different lists

118
00:05:21,321 --> 00:05:23,790
that are out there,
hunting is probably

119
00:05:23,790 --> 00:05:27,760
the most debated definition
that currently exists.

120
00:05:27,760 --> 00:05:31,097
I thought APT was
bad as a buzz word,

121
00:05:31,097 --> 00:05:34,534
but man, hunting really
gets people riled up.

122
00:05:34,534 --> 00:05:36,936
I've actually seen
full-scale arguments

123
00:05:36,936 --> 00:05:40,106
over what hunting is
officially defined as.

124
00:05:40,106 --> 00:05:42,175
So when you end up taking
a look at this definition,

125
00:05:42,175 --> 00:05:45,712
where hunting was born
out of, it really became

126
00:05:45,712 --> 00:05:49,215
an advanced and continuous
instant response cycle,

127
00:05:49,215 --> 00:05:50,683
because the instant
response team,

128
00:05:50,683 --> 00:05:51,950
guess what they were doing?

129
00:05:51,951 --> 00:05:55,355
They were living in hunt
world on a daily basis,

130
00:05:55,355 --> 00:05:58,958
waking up, responding and
trying to identify threats,

131
00:05:58,958 --> 00:06:01,894
going to bed at night, waking
up and living the same day

132
00:06:01,894 --> 00:06:04,731
again and again and again.

133
00:06:05,832 --> 00:06:09,202
And the way we're trying
to break this loop

134
00:06:09,202 --> 00:06:12,572
is by trying to
be more proactive

135
00:06:12,572 --> 00:06:15,808
about how we're
engaging our adversary.

136
00:06:15,808 --> 00:06:17,409
Instead of simply
reacting to them

137
00:06:17,410 --> 00:06:19,412
from an instant response cycle,

138
00:06:19,412 --> 00:06:21,614
we're trying to
engage them sooner,

139
00:06:21,614 --> 00:06:24,450
because our adversaries,
as we all know,

140
00:06:24,450 --> 00:06:26,885
are living in our environments,

141
00:06:26,886 --> 00:06:29,856
unfettered access
to our environments,

142
00:06:29,856 --> 00:06:32,892
going on for months,
which is incredible

143
00:06:32,892 --> 00:06:36,195
that they could do
this for a long time.

144
00:06:36,195 --> 00:06:37,997
Now the other thing you
have to look at here

145
00:06:37,997 --> 00:06:41,601
is the definition, from
the way I define it,

146
00:06:41,601 --> 00:06:43,936
it really is, it's changing
instead just reacting

147
00:06:43,936 --> 00:06:45,705
to a single alert but
becoming more proactive.

148
00:06:45,705 --> 00:06:49,675
But secondly, it is also a lot
more than just doing the hey,

149
00:06:49,675 --> 00:06:53,980
you're now my threat
hunting team, go find evil

150
00:06:53,980 --> 00:06:56,549
wherever it might exist.

151
00:06:56,549 --> 00:06:59,051
Because when you end up
trying to define it like that,

152
00:06:59,051 --> 00:07:02,555
what really has changed
over the past 20 years?

153
00:07:02,555 --> 00:07:05,358
So it leads us into the maze.

154
00:07:06,793 --> 00:07:08,694
And everyone who's in here,
a Westworld fan, is like ooh,

155
00:07:08,694 --> 00:07:10,830
I understand where
he's going with this

156
00:07:10,830 --> 00:07:12,732
and everyone else is
like I have no idea

157
00:07:12,732 --> 00:07:14,367
what you're talking
about right now.

158
00:07:14,367 --> 00:07:17,069
This is the only analogy
I still have left in here

159
00:07:17,069 --> 00:07:20,640
because I need to
go back 20 years.

160
00:07:20,640 --> 00:07:22,308
And just like in Westworld,

161
00:07:22,308 --> 00:07:25,010
a major incident
happened 20 years ago.

162
00:07:25,011 --> 00:07:28,114
And that incident
was precipitated by
another incident,

163
00:07:29,882 --> 00:07:32,118
and this is where you almost
need to take a step back

164
00:07:32,118 --> 00:07:35,121
in history here and understand
what we've been doing

165
00:07:35,121 --> 00:07:37,457
on a daily basis is nothing new.

166
00:07:38,658 --> 00:07:42,161
We've actually been
doing hunting activities

167
00:07:42,161 --> 00:07:43,896
since the late '90s.

168
00:07:43,896 --> 00:07:48,334
So there's an incident
that many of you

169
00:07:48,334 --> 00:07:51,003
may have never heard of or have
heard the term in the past,

170
00:07:51,003 --> 00:07:54,640
but how many people
have ever heard

171
00:07:54,640 --> 00:07:57,643
of the operation Solar Sunrise?

172
00:07:57,643 --> 00:08:00,179
All right, just keep
your hands up, up here.

173
00:08:00,179 --> 00:08:01,914
So look at the entire room
in here, like all right.

174
00:08:01,914 --> 00:08:05,685
By the way, there's an
amazingly bad YouTube video

175
00:08:05,685 --> 00:08:08,454
if you Google Solar Sunrise

176
00:08:08,454 --> 00:08:11,290
that literally
was, it's horrible.

177
00:08:11,290 --> 00:08:14,827
It basically discusses
what Solar Sunrise is.

178
00:08:14,827 --> 00:08:18,798
But the reason I bring this up
is Solar Sunrise was followed

179
00:08:18,798 --> 00:08:20,066
by another incident.

180
00:08:20,066 --> 00:08:22,034
Now Solar Sunrise was a
bunch of teenage hackers

181
00:08:22,034 --> 00:08:24,670
led by an Israeli
that compromised

182
00:08:24,670 --> 00:08:26,172
a couple of Pentagon servers

183
00:08:26,172 --> 00:08:29,308
and everyone went nutso over
what this ended up being.

184
00:08:30,743 --> 00:08:34,380
Around this time, for those
in DoD cyber warfare history,

185
00:08:34,380 --> 00:08:36,816
there was another
not true incident,

186
00:08:36,816 --> 00:08:39,552
but something else
occurred is an exercise

187
00:08:39,552 --> 00:08:42,221
that was named Eligible Receiver

188
00:08:42,221 --> 00:08:44,924
that basically
showed how vulnerable

189
00:08:44,924 --> 00:08:48,593
military computer networks
were to Internet-based attack.

190
00:08:48,594 --> 00:08:52,098
That followed Solar Sunrise,
the sun rises and it sets,

191
00:08:55,101 --> 00:08:57,970
and we have in the sky the moon.

192
00:08:57,970 --> 00:08:59,705
Moonlight Maze.

193
00:08:59,705 --> 00:09:02,008
It was followed by an incident
called Moonlight Maze.

194
00:09:02,008 --> 00:09:04,944
Now when I was
initially starting out
as a junior officer,

195
00:09:04,944 --> 00:09:06,913
and this is again just a
quick case study on this,

196
00:09:06,913 --> 00:09:09,482
I was a junior officer,
first lieutenant

197
00:09:09,482 --> 00:09:11,449
leaving my first
operational assignment

198
00:09:11,450 --> 00:09:13,986
at the sixth and ninth
Information Warfare Squadron,

199
00:09:13,986 --> 00:09:17,490
which is out of South
Carolina, Shaw Air Force Base.

200
00:09:17,490 --> 00:09:19,292
And I was brought
up and I was working

201
00:09:19,292 --> 00:09:22,461
with Henri van Goethem, he
looks exactly the way he did

202
00:09:22,461 --> 00:09:24,797
back in 1998 when
I first met him.

203
00:09:24,797 --> 00:09:26,599
Everyone look at this man,
you could tell right there,

204
00:09:26,599 --> 00:09:28,200
he's not aged a day.

205
00:09:28,200 --> 00:09:32,371
He's still wondering when
he's gonna start shaving.

206
00:09:32,371 --> 00:09:35,174
But I met Henri, and
I met multiple others,

207
00:09:35,174 --> 00:09:38,276
CJ Moses, Dan Russell,
Chad Tilbury and others

208
00:09:38,277 --> 00:09:42,515
that I worked with, and we
were all engaging in AFOSI

209
00:09:42,515 --> 00:09:47,319
around a time on an operation
called Moonlight Maze.

210
00:09:47,320 --> 00:09:50,122
Now Moonlight Maze,
for anyone in here

211
00:09:50,122 --> 00:09:51,824
who has never heard of it,

212
00:09:51,824 --> 00:09:53,593
can be probably
officially defined

213
00:09:53,593 --> 00:09:56,395
as the first nation-state
detected attack

214
00:09:56,395 --> 00:10:00,132
that compromised sites
across the United States.

215
00:10:00,132 --> 00:10:01,901
The year, 1998.

216
00:10:01,901 --> 00:10:05,972
In some states, that it
goes back even back to 1996,

217
00:10:05,972 --> 00:10:07,740
I've not actually
seen those details

218
00:10:07,740 --> 00:10:09,875
or where that comes from
but we first started

219
00:10:09,875 --> 00:10:11,544
seeing things in 1998.

220
00:10:11,544 --> 00:10:14,680
Now the AFOSI were
engaging on the Russians,

221
00:10:14,680 --> 00:10:18,016
and the Russians were
using a ICMP backdoor

222
00:10:18,017 --> 00:10:21,887
that was released in frack,
if you go back that far,

223
00:10:21,887 --> 00:10:23,356
and ICMP tunneling.

224
00:10:23,356 --> 00:10:26,459
Anyone know what that tunnel
was named as a trivia?

225
00:10:26,459 --> 00:10:27,560
Someone just said, who said it?

226
00:10:27,560 --> 00:10:28,794
Loki!

227
00:10:28,794 --> 00:10:29,862
Yeah, you know it.

228
00:10:29,862 --> 00:10:32,131
Okay Chris, unfair advantage.

229
00:10:33,633 --> 00:10:36,002
Chris Crowley's the author
of our security operations

230
00:10:36,002 --> 00:10:38,838
and our management courses
incident response stuff in SANS,

231
00:10:38,838 --> 00:10:40,740
so he's definitely
well learned in this.

232
00:10:40,740 --> 00:10:42,274
But Loki.

233
00:10:42,274 --> 00:10:45,011
Anyone know what recently
has come out in the news

234
00:10:45,011 --> 00:10:47,747
about Loki and the Russians
attack going way back

235
00:10:47,747 --> 00:10:49,115
to Moonlight Maze?

236
00:10:49,115 --> 00:10:51,917
Just not more than a week ago.

237
00:10:51,917 --> 00:10:53,819
Anyone hear about this?

238
00:10:53,819 --> 00:10:56,555
Kaspersky released a
report of course, right?

239
00:10:56,555 --> 00:10:59,358
And they found an
active Loki tunnel.

240
00:11:00,760 --> 00:11:03,029
And they actually
not only found that,

241
00:11:03,029 --> 00:11:05,898
they tied the Moonlight
Maze intrusions,

242
00:11:07,366 --> 00:11:11,002
because they actually found
one of the servers in the UK

243
00:11:11,003 --> 00:11:14,173
that was actively
using as a hop point,

244
00:11:14,173 --> 00:11:16,275
and it was still active.

245
00:11:16,275 --> 00:11:17,776
That server was still on.

246
00:11:17,777 --> 00:11:19,412
I don't know what the uptime
was but you could imagine.

247
00:11:19,412 --> 00:11:22,381
The server is still on and
they ended up collecting

248
00:11:22,381 --> 00:11:23,882
all of the data
off of that server.

249
00:11:23,883 --> 00:11:25,317
Kaspersky did.

250
00:11:25,317 --> 00:11:27,820
And they did the analysis
on the code samples

251
00:11:27,820 --> 00:11:31,090
from that system that was
online for nearly 20 years now.

252
00:11:32,525 --> 00:11:34,293
You can imagine like how
long this stuff goes back.

253
00:11:34,293 --> 00:11:36,629
It's almost, the way
Kaspersky described it,

254
00:11:36,629 --> 00:11:40,099
it was like unearthing a
time capsule of malware.

255
00:11:40,099 --> 00:11:43,035
Now the crazy thing
that they did with this

256
00:11:43,035 --> 00:11:45,170
is that they actually
associated it

257
00:11:45,171 --> 00:11:49,175
with a current known
Russian APT group,

258
00:11:49,175 --> 00:11:51,977
and they were able to
draw that connection,

259
00:11:51,977 --> 00:11:53,478
which is kind of
amazing when you go back

260
00:11:53,479 --> 00:11:55,481
and look at what the Moonlight
Means actors are doing,

261
00:11:55,481 --> 00:11:57,883
they are compromising
research facilities,

262
00:11:57,883 --> 00:12:00,853
they're compromising
air force bases,

263
00:12:00,853 --> 00:12:03,756
they're compromising
DoE facilities,

264
00:12:03,756 --> 00:12:05,190
and they were
really sophisticated

265
00:12:05,191 --> 00:12:06,859
because they were
using hop points.

266
00:12:06,859 --> 00:12:08,694
Now the way that
we engaged on this,

267
00:12:08,694 --> 00:12:10,128
and this is where my job was,

268
00:12:10,129 --> 00:12:13,532
I was not the agent, I didn't
have my badge on my hip,

269
00:12:13,532 --> 00:12:16,669
but I definitely was not
allowed to carry a weapon.

270
00:12:16,669 --> 00:12:19,605
I was a comm officer.

271
00:12:19,605 --> 00:12:23,809
I was communications, and we
were the geeks of the unit.

272
00:12:23,809 --> 00:12:27,113
And the unit basically
was to deploy

273
00:12:27,113 --> 00:12:31,183
Internet-based sensors, bridging
firewall was a technology

274
00:12:31,183 --> 00:12:33,185
that we used back then,

275
00:12:33,185 --> 00:12:36,255
to monitor adversary behavior.

276
00:12:36,255 --> 00:12:39,692
Now the adversaries were using
the ICMP tunnel at this point

277
00:12:39,692 --> 00:12:42,194
and we're able to
literally intercept

278
00:12:42,194 --> 00:12:43,628
through bridging firewall,

279
00:12:43,629 --> 00:12:44,864
and the reason why
bridging firewall

280
00:12:44,864 --> 00:12:46,398
is there's no TTL documentation

281
00:12:46,398 --> 00:12:48,934
so that the adversary
who is actively watching

282
00:12:48,934 --> 00:12:51,170
what we're doing would
notice the uptime,

283
00:12:51,170 --> 00:12:52,738
they checked the uptime
every single time

284
00:12:52,738 --> 00:12:54,006
if the system went down,

285
00:12:54,006 --> 00:12:57,009
they would say hey
let's get off the ship.

286
00:12:57,009 --> 00:12:59,779
They knew our
response mechanisms,

287
00:12:59,779 --> 00:13:01,280
they knew we'd pull the power
out of the back of the system,

288
00:13:01,280 --> 00:13:02,548
so we stopped doing that.

289
00:13:02,548 --> 00:13:04,884
They knew that if all of
a sudden they saw a TTL

290
00:13:04,884 --> 00:13:07,653
added on to the path that
they're reaching their servers,

291
00:13:07,653 --> 00:13:10,289
that they would get the
hell out of dodge too.

292
00:13:10,289 --> 00:13:13,759
Mistakes were made in as
much as we had other units

293
00:13:13,759 --> 00:13:15,361
who are also doing
investigations

294
00:13:15,361 --> 00:13:18,264
connecting to the
Loki ICMP backdoor,

295
00:13:18,264 --> 00:13:20,166
and they had a counter

296
00:13:20,166 --> 00:13:22,268
that they would reset
like a tripwire,

297
00:13:22,268 --> 00:13:24,703
like a tape over the
door that no one else

298
00:13:24,703 --> 00:13:26,805
should be going through
this door except me.

299
00:13:26,806 --> 00:13:28,007
So I go in the door,

300
00:13:28,007 --> 00:13:29,308
the counter should
increment one, right?

301
00:13:29,308 --> 00:13:30,776
Well guess what happens.

302
00:13:30,776 --> 00:13:32,044
When they were doing a demo
or something like that,

303
00:13:32,044 --> 00:13:33,279
it's like let me connect
to this again and again

304
00:13:33,279 --> 00:13:35,414
and again and again and again,

305
00:13:35,414 --> 00:13:37,850
counter up, two,
three, four, five, six.

306
00:13:37,850 --> 00:13:39,385
It kept on going up.

307
00:13:39,385 --> 00:13:41,854
And of course we're
monitoring this,

308
00:13:41,854 --> 00:13:44,356
we're calling on the
phone saying hey,

309
00:13:44,356 --> 00:13:45,858
stop connecting to the system;

310
00:13:45,858 --> 00:13:47,560
and of course the adversaries,
the Russians at that point,

311
00:13:47,560 --> 00:13:49,994
came in, logged in, did
their look at the counter

312
00:13:49,995 --> 00:13:53,098
and said oh, we're
discovered, and that wasn't us

313
00:13:53,098 --> 00:13:55,233
because we're the only ones
connecting to the system.

314
00:13:55,234 --> 00:13:57,469
Boom, they're off the box.

315
00:13:57,469 --> 00:13:59,171
And you sit there, look at this,

316
00:13:59,171 --> 00:14:02,041
and it's like obviously
they were aware

317
00:14:02,041 --> 00:14:03,475
of what we were doing.

318
00:14:03,475 --> 00:14:05,377
We were having to go
back because we're AFOSI,

319
00:14:05,377 --> 00:14:08,046
we're law enforcement in
conjunction with the FBI,

320
00:14:08,047 --> 00:14:10,449
IG from DoE and other locations,

321
00:14:10,449 --> 00:14:13,252
we're able to start hopping
back to different hop points

322
00:14:13,252 --> 00:14:15,787
and put up additional monitors,

323
00:14:15,788 --> 00:14:17,223
looking for how
they're breaking in.

324
00:14:17,223 --> 00:14:20,125
And this is one of the
ways that eventually,

325
00:14:20,125 --> 00:14:22,862
through a series of
correlated events,

326
00:14:22,862 --> 00:14:24,129
through threat intelligence,

327
00:14:24,129 --> 00:14:25,631
if you actually, it's
the first gestation

328
00:14:25,631 --> 00:14:27,833
where they did this, there are
multiple different entities

329
00:14:27,833 --> 00:14:30,102
that made the conclusion
that it was the Russians

330
00:14:30,102 --> 00:14:31,837
who were behind this.

331
00:14:31,837 --> 00:14:33,639
Kevin Mandia actually
made his name,

332
00:14:33,639 --> 00:14:35,841
along with the intrusion
squad where I worked,

333
00:14:35,841 --> 00:14:39,044
at decoding in detecting
Cyrillic keystrokes

334
00:14:39,044 --> 00:14:42,548
inside the tunnel
that they were using.

335
00:14:43,816 --> 00:14:45,818
The other thing that's
kind of fascinating here

336
00:14:45,818 --> 00:14:49,420
is the Russians,
because they know

337
00:14:49,421 --> 00:14:50,823
they were being monitored,

338
00:14:50,823 --> 00:14:53,292
started to increase
their capabilities.

339
00:14:53,292 --> 00:14:55,861
They started to be more sneaky.

340
00:14:55,861 --> 00:14:58,297
They would go on a
system and they would

341
00:14:59,832 --> 00:15:01,266
drop all their malware on it,

342
00:15:01,267 --> 00:15:03,836
not by using a
normal tar command.

343
00:15:03,836 --> 00:15:06,205
They would put it in
the root level directory

344
00:15:06,205 --> 00:15:09,174
and tar instead of xdf, like
we're all used to doing,

345
00:15:09,174 --> 00:15:13,178
that v there, they
would do the tar xf.

346
00:15:13,178 --> 00:15:17,683
And they would then
wipe that file.

347
00:15:17,683 --> 00:15:20,920
And the thing about it was
we'd be looking at time stamps

348
00:15:20,920 --> 00:15:22,320
and all the time
stamps to match,

349
00:15:22,321 --> 00:15:25,090
they were actually creating
on their own systems

350
00:15:25,090 --> 00:15:28,694
a tree of the entire environment
that they're installing

351
00:15:28,694 --> 00:15:31,930
their tools on, back dating
each subsequent directory

352
00:15:31,931 --> 00:15:34,466
like raking up a sand trap

353
00:15:34,466 --> 00:15:37,002
as they put their malware down
in a lower level directory

354
00:15:37,002 --> 00:15:39,003
and then they'd time
stop every single

355
00:15:39,004 --> 00:15:41,206
upper level directory,
getting to the root directory,

356
00:15:41,206 --> 00:15:42,608
and then extracting everything

357
00:15:42,608 --> 00:15:44,175
and the modification
times would all matter.

358
00:15:44,176 --> 00:15:46,912
Remember on UNIX systems,
because do they have

359
00:15:46,912 --> 00:15:49,648
back in the late
90s creation time?

360
00:15:49,648 --> 00:15:51,050
No they just had
modification time

361
00:15:51,050 --> 00:15:53,484
and the inode change time,

362
00:15:53,485 --> 00:15:54,586
but it's the modification
time that most of us

363
00:15:54,586 --> 00:15:56,055
we're looking at that point.

364
00:15:56,055 --> 00:15:58,824
I mean, forensics back in
1998 if you're looking at it.

365
00:15:58,824 --> 00:16:01,226
So we had to get more
sophisticated as well.

366
00:16:01,226 --> 00:16:04,797
So we, even back to
almost 20 years ago,

367
00:16:04,797 --> 00:16:06,532
when you take a look
at this incident,

368
00:16:06,532 --> 00:16:09,635
we started to hack
our own systems.

369
00:16:09,635 --> 00:16:12,004
Why can't we do that?

370
00:16:12,004 --> 00:16:14,406
And hacking is kind of an
extreme term for basically

371
00:16:14,406 --> 00:16:16,608
we started putting our own
implants on our own systems

372
00:16:16,608 --> 00:16:19,044
because we couldn't watch them
through their own backdoors,

373
00:16:19,044 --> 00:16:20,980
they started to encrypt it.

374
00:16:20,980 --> 00:16:23,615
We started to implant our
own stuff on those systems

375
00:16:23,615 --> 00:16:26,652
through rootkit technology,
keystroke monitoring and more.

376
00:16:26,652 --> 00:16:28,487
And again, they detected that.

377
00:16:28,487 --> 00:16:30,488
And the other thing that
was really fascinating

378
00:16:30,489 --> 00:16:32,124
about the Russians during
this point in time,

379
00:16:32,124 --> 00:16:35,327
they actually knew
that too much activity

380
00:16:35,327 --> 00:16:36,862
would lead to
additional monitoring.

381
00:16:36,862 --> 00:16:39,897
So they were extremely patient

382
00:16:39,898 --> 00:16:41,834
from an adversary perspective.

383
00:16:41,834 --> 00:16:45,003
And so they would actually
wait a full 60 days

384
00:16:45,004 --> 00:16:46,405
before hitting a target again,

385
00:16:46,405 --> 00:16:48,339
which is fascinating because

386
00:16:48,340 --> 00:16:51,143
we were only allowed to
monitors as law enforcement

387
00:16:51,143 --> 00:16:54,980
a system for
approximately 60 days.

388
00:16:54,980 --> 00:16:56,915
And this is kind of one of
those mind-blowing things

389
00:16:56,915 --> 00:16:58,349
when you end up seeing
and thinking about it,

390
00:16:58,350 --> 00:17:02,254
is that they were so patient
even back 20 years ago

391
00:17:02,254 --> 00:17:05,991
at this point that the echoes
of what those teams are doing

392
00:17:07,393 --> 00:17:10,996
feel like what a lot of you
are investigating today,

393
00:17:10,996 --> 00:17:13,198
is that they're slowly
upping the ante,

394
00:17:13,198 --> 00:17:15,868
that they know how you're
responding to them.

395
00:17:15,867 --> 00:17:19,905
There are cases out there
now from FireEye, Kaspersky,

396
00:17:19,905 --> 00:17:21,473
Carbon Black and other,

397
00:17:21,473 --> 00:17:23,274
everyone is producing all these
threat intelligence reports

398
00:17:23,275 --> 00:17:26,445
that are out there, and one
of the fascinating things is

399
00:17:26,444 --> 00:17:29,181
in almost all situations,
adversaries are becoming

400
00:17:29,181 --> 00:17:32,818
more and more aware of what
the instant response teams

401
00:17:32,818 --> 00:17:35,521
are doing on your networks.

402
00:17:35,521 --> 00:17:37,022
And that's not new.

403
00:17:37,022 --> 00:17:38,490
Some of the reports act like,
well this is the first time

404
00:17:38,490 --> 00:17:40,459
we've seen this, I'm like,
yeah we saw that 20 years ago.

405
00:17:40,459 --> 00:17:42,161
But I hate being
that old guy now

406
00:17:42,161 --> 00:17:44,997
and saying (mumbles) we
didn't have Carbon Black

407
00:17:44,997 --> 00:17:47,366
and all this other cool stuff
that you can now deploy,

408
00:17:47,366 --> 00:17:48,867
and it's true.

409
00:17:48,867 --> 00:17:52,738
We had a monitor system that
Dan Russell nicknamed Sniffy,

410
00:17:52,738 --> 00:17:56,642
thank God by the way,
because the Carnivore system,

411
00:17:56,642 --> 00:17:58,811
if anyone remembers
Carnivore being in the news,

412
00:17:58,811 --> 00:18:00,745
was the threatening
system that's gonna break

413
00:18:00,746 --> 00:18:02,114
all privacy on the Internet.

414
00:18:02,114 --> 00:18:04,016
And that was a big
deal back then.

415
00:18:04,016 --> 00:18:07,286
You can imagine Sniffy
challenges privacy.

416
00:18:08,487 --> 00:18:10,823
Long story short, Dan
Russell and CJ Moses,

417
00:18:10,823 --> 00:18:14,326
FBI agents and others
ended up at one point

418
00:18:14,326 --> 00:18:16,495
flying over to Russia
because at that point,

419
00:18:16,495 --> 00:18:19,731
it was we're all nice
friends with each other.

420
00:18:19,731 --> 00:18:23,235
But Dan Russell, my boss; and
CJ Moses, who now works at,

421
00:18:23,235 --> 00:18:25,070
he's an Amazon, right?

422
00:18:25,070 --> 00:18:27,139
Yeah, he's at Amazon.

423
00:18:27,139 --> 00:18:30,375
They flew over there
as a part of a team

424
00:18:30,375 --> 00:18:33,612
to do criminal
investigations on it.

425
00:18:33,612 --> 00:18:35,647
It's kind of a fascinating
if you guys like go

426
00:18:35,647 --> 00:18:37,549
through the full story
how it all ended up being,

427
00:18:37,549 --> 00:18:40,385
but the main point I'm trying
to take a look at here is that

428
00:18:40,385 --> 00:18:42,588
this stuff is not new.

429
00:18:42,588 --> 00:18:46,024
And the thing about it is,
is like all these people

430
00:18:46,024 --> 00:18:49,460
that are in here are
not creating something

431
00:18:49,461 --> 00:18:52,030
that this is, you're the
first one that's seen this.

432
00:18:52,030 --> 00:18:55,300
We've been under attack and
dealing with adversaries

433
00:18:55,300 --> 00:18:58,971
basically since we plugged in
our first Windows NT system

434
00:18:58,971 --> 00:19:00,639
and going even
further back than that

435
00:19:00,639 --> 00:19:02,241
when we start talking
about Solaris.

436
00:19:02,241 --> 00:19:03,675
I mean, we had Cliff Stoll

437
00:19:03,675 --> 00:19:06,043
at the Cyber Threat
Intelligence Summit

438
00:19:06,044 --> 00:19:09,081
give his keynote
about how he set up

439
00:19:09,081 --> 00:19:12,083
one of the first honeypot
systems as a technology.

440
00:19:12,951 --> 00:19:15,053
Hunting has evolved.

441
00:19:15,053 --> 00:19:18,557
But at the same point, our
threats are the same threats,

442
00:19:18,557 --> 00:19:20,425
just using different
tricks and techniques.

443
00:19:20,425 --> 00:19:22,094
But if you listen to
the news and go read

444
00:19:22,094 --> 00:19:25,497
the Kaspersky report, yeah,
same threat they identified

445
00:19:25,497 --> 00:19:28,133
through a correlation
of malware analysis

446
00:19:28,133 --> 00:19:30,068
through to an APT today.

447
00:19:30,068 --> 00:19:33,772
So this leads us
to, let's talk about

448
00:19:33,772 --> 00:19:36,207
where we currently stand in
the threat hunting community.

449
00:19:36,208 --> 00:19:39,578
So over the past
three, four months,

450
00:19:39,578 --> 00:19:42,080
we sent out a survey,
how many people responded

451
00:19:42,080 --> 00:19:43,581
to the Threat Hunting Survey?

452
00:19:43,582 --> 00:19:45,584
I think it was sent out to a
lot of the attendees in here.

453
00:19:45,584 --> 00:19:49,054
A lot of, okay, maybe not
as much as I had hoped.

454
00:19:49,054 --> 00:19:50,422
Let me do the not question.

455
00:19:50,422 --> 00:19:53,158
How many, (laughs)

456
00:19:53,158 --> 00:19:56,395
the band idea here is
that threat hunting,

457
00:19:57,763 --> 00:19:59,865
we pulled you and we pulled
a lot of organizations

458
00:19:59,865 --> 00:20:02,134
that apparently engage
in threat hunting.

459
00:20:02,134 --> 00:20:04,336
And I wanna talk about
the results of this

460
00:20:04,336 --> 00:20:06,271
because I think it has
drastic implications

461
00:20:06,271 --> 00:20:09,474
the way people are defining
and why they're defining

462
00:20:09,474 --> 00:20:12,910
threat hunting the way
that they are today.

463
00:20:12,911 --> 00:20:16,281
This survey, by the way, is
going to be officially released

464
00:20:16,281 --> 00:20:19,150
at the end of the
month, April 26, 27th.

465
00:20:19,151 --> 00:20:22,454
Robert Emily, is Robert in here?

466
00:20:22,454 --> 00:20:24,255
He may not be here yet.

467
00:20:24,256 --> 00:20:26,091
Robert Emily and I
wrote the reports.

468
00:20:26,091 --> 00:20:28,260
We call it, It was
Written by the Robs.

469
00:20:28,260 --> 00:20:31,029
People are expecting to see me,

470
00:20:31,029 --> 00:20:33,165
teaching at the threat
intelligence class this week,

471
00:20:33,165 --> 00:20:34,633
are gonna be sorely
disappointed,

472
00:20:34,633 --> 00:20:36,235
it's another Rob Lee
that works at SANS,

473
00:20:36,235 --> 00:20:38,337
former cyber warfare
officer in the Air Force

474
00:20:38,337 --> 00:20:39,771
and also Air Force,
Kevin McGrath.

475
00:20:39,771 --> 00:20:41,306
You can see where this goes.

476
00:20:41,306 --> 00:20:43,642
But we decided to write this
report together based on this.

477
00:20:43,642 --> 00:20:47,813
So one of the things that
came out of this report

478
00:20:47,813 --> 00:20:49,615
directly when we started
taking a look at it

479
00:20:49,615 --> 00:20:53,085
is most of the
respondents, when we asked

480
00:20:53,085 --> 00:20:56,588
what kicks off a hunt,
where do you start?

481
00:20:58,357 --> 00:21:01,960
And another way to
form this question is,

482
00:21:01,960 --> 00:21:04,296
and this is where, I was
talking to the survey writers,

483
00:21:04,296 --> 00:21:07,232
I said we basically
just ask them, hey,

484
00:21:07,232 --> 00:21:09,701
if you're in a dark
alley in a big city

485
00:21:09,701 --> 00:21:11,770
and you're walking to your car,

486
00:21:11,770 --> 00:21:14,206
are you looking
out for bad guys?

487
00:21:14,206 --> 00:21:15,873
And how are you doing that?

488
00:21:15,874 --> 00:21:17,342
Because everyone's
gonna answer this

489
00:21:17,342 --> 00:21:19,278
yes we are looking for bad guys

490
00:21:19,278 --> 00:21:21,380
because this is one of the
harder definitions in hunting.

491
00:21:21,380 --> 00:21:23,715
Is hunting intrusion detection?

492
00:21:23,715 --> 00:21:26,251
Or is it looking for bad guys?

493
00:21:26,251 --> 00:21:28,553
Or is it what?

494
00:21:28,553 --> 00:21:30,922
The output of this survey here,

495
00:21:30,922 --> 00:21:32,824
when you end up taking a look
at some of the answers here, it

496
00:21:32,824 --> 00:21:36,295
kind of gives us a mentality
that a lot of respondents

497
00:21:36,295 --> 00:21:38,797
are taking a look at threat
hunting and saying well,

498
00:21:38,797 --> 00:21:40,866
it's kind of like
intrusion detection,

499
00:21:40,866 --> 00:21:42,968
so we'll just answer
yes to that question

500
00:21:42,968 --> 00:21:47,039
because I am actively,
proactively deploying signatures

501
00:21:47,039 --> 00:21:49,508
in my environment so
therefore I'm hunting, right?

502
00:21:49,508 --> 00:21:50,776
And I'm looking
for these things.

503
00:21:50,776 --> 00:21:52,778
So taking a look at
some of the data here

504
00:21:52,778 --> 00:21:56,548
is that majority of the
hunting that is going on

505
00:21:56,548 --> 00:21:58,183
in most organizations right now,

506
00:21:58,183 --> 00:21:59,651
if you look at
the survey output,

507
00:21:59,651 --> 00:22:01,186
are based on
reactionary signatures.

508
00:22:01,186 --> 00:22:04,022
The old-school technologies
that have driven

509
00:22:04,022 --> 00:22:06,291
information security
for the past 20 years.

510
00:22:06,291 --> 00:22:08,493
This is not exactly a bad thing.

511
00:22:08,493 --> 00:22:10,395
It's definitely needed as
we're gonna talk about here

512
00:22:10,395 --> 00:22:12,698
in just a little bit, but
when you end up taking a look

513
00:22:12,698 --> 00:22:15,133
at it from holistically,
for these indicators,

514
00:22:15,133 --> 00:22:19,671
that 86% basically say hey,
thrunting began, thrunting,

515
00:22:19,671 --> 00:22:22,240
I just did it (laughs),

516
00:22:22,240 --> 00:22:25,944
I just took the keyword away
from someone else in here.

517
00:22:25,944 --> 00:22:27,779
They were gonna say
the official word,

518
00:22:27,779 --> 00:22:31,316
because they coined the term
thrunting, threat hunting

519
00:22:31,316 --> 00:22:35,420
is actually initiated
by a IDS alert.

520
00:22:35,420 --> 00:22:36,988
That's where we start.

521
00:22:36,988 --> 00:22:39,858
We're doing IDS and
therefore we're hunting.

522
00:22:39,858 --> 00:22:43,962
Anomaly detection is the
next one on the list.

523
00:22:43,962 --> 00:22:46,031
The majority of you
are hunting by hey,

524
00:22:46,031 --> 00:22:48,033
there's a weird
thing on my network.

525
00:22:48,033 --> 00:22:49,801
That's okay, I'm
not scolding you,

526
00:22:49,801 --> 00:22:53,304
but I'm basically trying to,
in our report that we wrote,

527
00:22:53,305 --> 00:22:55,874
it basically shows
that most organizations

528
00:22:55,874 --> 00:22:59,478
are not doing active pro hunting

529
00:22:59,478 --> 00:23:02,047
with threat intelligence
as the basis.

530
00:23:03,415 --> 00:23:07,185
Only half responded that they're
using threat intelligence.

531
00:23:07,185 --> 00:23:08,787
And this is the thing
that I was like hmm,

532
00:23:08,787 --> 00:23:10,489
when I saw this one.

533
00:23:10,489 --> 00:23:13,959
But, but, those using
threat intelligence

534
00:23:13,959 --> 00:23:17,562
are primarily using it
from third party sources,

535
00:23:17,562 --> 00:23:20,098
not self-created, and
this is kind of an issue.

536
00:23:20,098 --> 00:23:24,034
Third party is like receiving
antivirus signatures

537
00:23:24,035 --> 00:23:27,939
from your vendor, McAfee,
Kaspersky, or someone else.

538
00:23:27,939 --> 00:23:30,308
That is effectively,
if you wanna go through

539
00:23:30,308 --> 00:23:34,379
a generic definition, is
defined as a signature, an IOC.

540
00:23:34,379 --> 00:23:37,248
So a feed that basically
says here's a threat

541
00:23:37,249 --> 00:23:39,184
that's out there, here's
something else you could do,

542
00:23:39,184 --> 00:23:40,918
there's obviously more advanced
ones that are out there.

543
00:23:40,919 --> 00:23:42,287
There's a lot of
vendors out there,

544
00:23:42,287 --> 00:23:43,622
they're even in the hallway,

545
00:23:43,622 --> 00:23:46,425
they do very specific
intelligence feeds

546
00:23:46,425 --> 00:23:48,326
that say your
industry and so forth,

547
00:23:48,326 --> 00:23:49,861
they'd be more targeted.

548
00:23:49,861 --> 00:23:52,931
But the best intelligence you
could derive is self-created.

549
00:23:54,199 --> 00:23:57,068
And how do you come
up with that stuff?

550
00:23:57,068 --> 00:23:59,504
So myself, Chris Crowley,
a lot of the folks

551
00:23:59,504 --> 00:24:02,340
in the cyber defense
side, Phil and others,

552
00:24:02,340 --> 00:24:04,676
we had a discussion at
SANS, it's like well,

553
00:24:04,676 --> 00:24:07,745
how would we describe
threat hunting as a process?

554
00:24:07,746 --> 00:24:09,948
What are we actually
doing with this?

555
00:24:09,948 --> 00:24:11,917
And because the DFIR folks,

556
00:24:11,917 --> 00:24:14,052
Digital Forensics
Incident Response folks
say we do hunting,

557
00:24:14,052 --> 00:24:17,022
the SOC folks say we do hunting,

558
00:24:17,022 --> 00:24:20,158
and the threat intelligence
folks say hey, we are hunting.

559
00:24:20,158 --> 00:24:23,227
And everyone's caught
in this middle ground.

560
00:24:23,228 --> 00:24:25,096
And the thing about this is that

561
00:24:25,096 --> 00:24:27,199
everyone is actually, it's
just like incident response,

562
00:24:27,199 --> 00:24:29,468
it's part of a cycle,
it is not a noun.

563
00:24:29,468 --> 00:24:31,603
It's a cycle, it's a verb.

564
00:24:31,603 --> 00:24:35,574
Threat hunting is everyone
working together as a team.

565
00:24:35,574 --> 00:24:37,242
Now whether the
incident response team

566
00:24:37,242 --> 00:24:39,478
sitting in the socket,
beside the point.

567
00:24:39,478 --> 00:24:42,547
The idea here is if you
look at that middle area

568
00:24:42,547 --> 00:24:47,285
of this slide, what is driving
threat hunting activity

569
00:24:47,285 --> 00:24:51,189
in most organizations, is some
basis of threat intelligence.

570
00:24:52,624 --> 00:24:54,493
Now the best threat
intelligence is actually derived

571
00:24:54,493 --> 00:24:56,928
from observing
adversary behavior,

572
00:24:56,928 --> 00:24:59,631
and that's where third-party
feeds and others are useful

573
00:24:59,631 --> 00:25:02,000
because they potentially
have a wider scale

574
00:25:02,000 --> 00:25:03,602
of adversary behavior.

575
00:25:03,602 --> 00:25:05,170
But the likelihood
of the adversary

576
00:25:05,170 --> 00:25:06,905
that's currently
hitting you right now

577
00:25:06,905 --> 00:25:10,075
that they will come
back is extremely high.

578
00:25:10,075 --> 00:25:13,445
So the more that you're
able, the more that right now

579
00:25:13,445 --> 00:25:15,647
that you're able to
extract out proper

580
00:25:15,647 --> 00:25:17,515
threat hunting
intelligence signatures

581
00:25:17,516 --> 00:25:20,352
and feed that back
into your SOC,

582
00:25:20,352 --> 00:25:22,754
and have your SOC start
saying we're likely

583
00:25:22,754 --> 00:25:26,024
going to be smacked again
by the same adversary,

584
00:25:26,024 --> 00:25:30,128
how will we defeat that,
and how will we detect that?

585
00:25:30,128 --> 00:25:32,129
The SOC now needs to tune itself

586
00:25:32,130 --> 00:25:35,233
looking for those threats
that have been created

587
00:25:35,233 --> 00:25:38,937
out of the DFIR teams, and
then the cycle begins again.

588
00:25:38,937 --> 00:25:40,572
Thus we're back in hunt world.

589
00:25:40,572 --> 00:25:42,841
You will detect the
adversary a second time,

590
00:25:42,841 --> 00:25:46,244
they will have evolved,
they will have new tricks,

591
00:25:46,244 --> 00:25:49,981
they will elevate in their
malware via TTPs as well.

592
00:25:51,550 --> 00:25:55,253
You observe it and you feed
that back over to the SOC.

593
00:25:55,253 --> 00:25:57,422
They signaturize on it,
and then they deploy

594
00:25:57,422 --> 00:25:59,658
and then they start doing
continuous monitoring,

595
00:25:59,658 --> 00:26:01,059
analytics and everything
else they're doing.

596
00:26:01,059 --> 00:26:02,627
This process, so
I'm trying to think

597
00:26:02,627 --> 00:26:04,062
we just need a very basic one.

598
00:26:04,062 --> 00:26:05,597
So when people look at
this and saying yeah,

599
00:26:05,597 --> 00:26:07,532
that pretty much is it, but
even though everyone's like,

600
00:26:07,532 --> 00:26:08,733
well threat intelligence
is kind of like

601
00:26:08,733 --> 00:26:10,335
the sticking point
here, it's like yeah,

602
00:26:10,335 --> 00:26:11,836
to a certain extent it is.

603
00:26:11,836 --> 00:26:13,138
Where I'm trying to
get people away from

604
00:26:13,138 --> 00:26:14,906
is just using a find
evil, but I don't know

605
00:26:14,906 --> 00:26:16,374
what I'm looking for.

606
00:26:16,374 --> 00:26:18,310
And we'll talk about a
little bit David Bianco's

607
00:26:18,310 --> 00:26:21,245
Pyramid of Pain, even if
you're doing hash lookups,

608
00:26:21,246 --> 00:26:22,581
it's a start.

609
00:26:22,581 --> 00:26:25,449
Even if you're taking a
class with Phil and I,

610
00:26:25,450 --> 00:26:28,620
they're not gonna say
hey if you see PowerShell

611
00:26:28,620 --> 00:26:31,255
being executed on a
human resource system

612
00:26:32,390 --> 00:26:35,927
on Jill's box connecting
to a remote system

613
00:26:35,927 --> 00:26:39,097
using PowerShell remoting
to someone in finance,

614
00:26:39,097 --> 00:26:41,132
what is the likelihood
Jill's really doing

615
00:26:41,132 --> 00:26:42,801
a PowerShell command?

616
00:26:42,801 --> 00:26:44,202
It's like near zero,

617
00:26:44,202 --> 00:26:47,238
which leads us to your
threat intelligence

618
00:26:47,238 --> 00:26:48,506
that you're gonna
be taking a look at

619
00:26:48,506 --> 00:26:52,143
is truly derived from
your adversary tactics.

620
00:26:52,143 --> 00:26:54,012
And it's not holistically.

621
00:26:54,012 --> 00:26:56,214
You need to look at them
and spread them apart.

622
00:26:56,214 --> 00:26:58,683
And this is goes back to the
threat intelligence mindset,

623
00:26:58,683 --> 00:27:00,719
is that in order to
do proper hunting,

624
00:27:00,719 --> 00:27:04,022
you need to not just focus
on let's hunt for a threat.

625
00:27:04,022 --> 00:27:06,957
It's what the threat is doing.

626
00:27:08,393 --> 00:27:10,595
Your intelligence signatures
are going to be effective

627
00:27:10,595 --> 00:27:12,430
if you focus on
what they're doing.

628
00:27:12,430 --> 00:27:15,600
This, the DFIR observation
cycle that they're going through

629
00:27:15,600 --> 00:27:17,901
and doing the scoping,
containing the threat,

630
00:27:17,902 --> 00:27:21,339
but they're also observing
and creating new indicators,

631
00:27:21,339 --> 00:27:22,841
that is then fed
over to the SOC.

632
00:27:22,841 --> 00:27:24,775
But they're observing
it from hey,

633
00:27:24,776 --> 00:27:25,977
they just did lateral movement.

634
00:27:25,977 --> 00:27:27,846
Hey, they just did exfil.

635
00:27:27,846 --> 00:27:30,782
Hey, they just accomplished
credential theft.

636
00:27:30,782 --> 00:27:32,684
How did they do that?

637
00:27:32,684 --> 00:27:34,686
And for anyone
looking for a start,

638
00:27:34,686 --> 00:27:36,187
say, I don't know
where to begin, Rob.

639
00:27:36,187 --> 00:27:38,122
You suck, you're telling me
that all this wonderful stuff

640
00:27:38,123 --> 00:27:39,557
exists that are out there,

641
00:27:39,557 --> 00:27:41,926
here's where you could consider.

642
00:27:41,926 --> 00:27:43,428
One of the things
I take a look at,

643
00:27:43,428 --> 00:27:45,063
and Phil and I have had
some discussions on this,

644
00:27:45,063 --> 00:27:46,498
if you're just
starting out saying

645
00:27:46,498 --> 00:27:47,999
I've nowhere else to begin,

646
00:27:47,999 --> 00:27:50,168
is you should take a look
at the MITRE-generated,

647
00:27:50,168 --> 00:27:54,438
the ATT&CK, the attackers
tools techniques

648
00:27:55,640 --> 00:27:57,942
capability knowledge
base, ATT is attack

649
00:27:57,942 --> 00:27:59,444
is what it's short for.

650
00:27:59,444 --> 00:28:02,080
MITRE just recently updated
this by the way the past week.

651
00:28:02,080 --> 00:28:05,050
It's on a wiki that's online,

652
00:28:05,050 --> 00:28:07,452
and you could go and look
at that underneath that

653
00:28:07,452 --> 00:28:10,488
for any number of
ways that attackers

654
00:28:10,488 --> 00:28:12,624
are focusing on (mumbles)
last three parts

655
00:28:12,624 --> 00:28:15,093
of the kill chain
there, the control,

656
00:28:16,628 --> 00:28:19,129
the execution and
the maintenance phase
of the kill chain

657
00:28:19,130 --> 00:28:20,865
that they're taking a look at.

658
00:28:20,865 --> 00:28:22,600
Now here's an example,
this and is my favorite one

659
00:28:22,600 --> 00:28:26,137
to initially point people down,
which is lateral movement.

660
00:28:26,137 --> 00:28:29,741
Phil also has debates
with me on this too.

661
00:28:29,741 --> 00:28:31,643
And usually, it's an
agreement because we start

662
00:28:31,643 --> 00:28:34,713
talking about it, but lateral
movement is one of the areas

663
00:28:34,713 --> 00:28:36,181
that a lot of our organizations,

664
00:28:36,181 --> 00:28:37,215
if you're going to
start somewhere,

665
00:28:37,215 --> 00:28:38,515
this is a good one to start.

666
00:28:38,516 --> 00:28:41,419
The adversaries are
living off your land.

667
00:28:41,419 --> 00:28:43,054
They're gonna be moving
from system to system

668
00:28:43,054 --> 00:28:46,091
using a finite
number of techniques.

669
00:28:47,225 --> 00:28:48,592
It really is finite.

670
00:28:48,593 --> 00:28:50,662
They have to use
Windows credentials,

671
00:28:50,662 --> 00:28:53,498
they have to use Windows
lateral movement capabilities.

672
00:28:53,498 --> 00:28:55,133
Otherwise, unless they
just happen to use

673
00:28:55,133 --> 00:28:57,502
the shadow brokers dump
they used this past weekend,

674
00:28:57,502 --> 00:28:59,738
well I guess then they'd be
able to spike every system

675
00:28:59,738 --> 00:29:01,639
on your network and
do 0 days against it.

676
00:29:01,639 --> 00:29:03,942
But more likely than
not, why risk it?

677
00:29:03,942 --> 00:29:05,443
They would go back in

678
00:29:05,443 --> 00:29:07,946
and just use the
native credentials,

679
00:29:07,946 --> 00:29:09,848
the native techniques
that individuals

680
00:29:09,848 --> 00:29:11,515
in your network
right now are using

681
00:29:11,516 --> 00:29:13,384
for moving system to system.

682
00:29:13,384 --> 00:29:15,153
Lateral movement
is a choke point.

683
00:29:15,153 --> 00:29:18,556
You could head them
off at the pass

684
00:29:18,556 --> 00:29:20,358
if you focus on
lateral movement.

685
00:29:20,358 --> 00:29:21,525
Probably next one off the chain

686
00:29:21,526 --> 00:29:22,961
would be exfil detection,

687
00:29:22,961 --> 00:29:24,596
but the one you wanna
stay away from is,

688
00:29:24,596 --> 00:29:26,798
and what of course
executives love to hear,

689
00:29:26,798 --> 00:29:29,667
which is hey, stop the malware,

690
00:29:29,667 --> 00:29:31,136
which is really hard to do.

691
00:29:31,136 --> 00:29:33,605
And Cylance and others
are really trying to take

692
00:29:33,605 --> 00:29:36,407
a good stab at that, arguably
depending on who you talk to,

693
00:29:37,509 --> 00:29:40,912
John Strand and others,
but the idea here

694
00:29:40,912 --> 00:29:44,616
is that malware is
millions of iterations.

695
00:29:44,616 --> 00:29:46,451
Lateral movement
is finite number

696
00:29:46,451 --> 00:29:47,752
of ways you could track that.

697
00:29:47,752 --> 00:29:49,220
So start there.

698
00:29:49,220 --> 00:29:50,755
And even if you don't
have any other signatures

699
00:29:50,755 --> 00:29:52,023
of what the threats are doing,

700
00:29:52,023 --> 00:29:53,190
then look internally
on your network

701
00:29:53,191 --> 00:29:54,626
using signatures
that MITRE's produce.

702
00:29:54,626 --> 00:29:55,860
And you could produce your own

703
00:29:55,860 --> 00:29:57,762
based on what they're
talking about here.

704
00:29:57,762 --> 00:29:59,264
The other thing
that I'd point out

705
00:29:59,264 --> 00:30:02,399
is when we start talking about
and trying to move away from

706
00:30:03,735 --> 00:30:05,637
this concept, is intrusion
detection hunting?

707
00:30:05,637 --> 00:30:08,239
And you know, kind of
slide is a misnomer here,

708
00:30:08,239 --> 00:30:11,109
is that intrusion detection
can be augmented by hunting.

709
00:30:13,077 --> 00:30:15,346
Intrusion detection and
all of our SOC capabilities

710
00:30:15,346 --> 00:30:17,549
that are currently there,
they're not horrible.

711
00:30:17,549 --> 00:30:19,417
We're not saying
that don't use them.

712
00:30:19,417 --> 00:30:22,419
It's that they are different
than what hunting is.

713
00:30:22,420 --> 00:30:24,823
Is that if you're
feeding proper hunting,

714
00:30:24,823 --> 00:30:26,324
going back through the cycle,

715
00:30:26,324 --> 00:30:29,294
hunting is a verb, hunting is
producing better signatures

716
00:30:30,562 --> 00:30:33,298
for your intrusion
detection teams to use

717
00:30:33,298 --> 00:30:34,666
to be able to identify
additional threats

718
00:30:34,666 --> 00:30:36,267
in your environment.

719
00:30:36,267 --> 00:30:37,735
Hunting augments that.

720
00:30:37,735 --> 00:30:39,270
And kind of the key point there

721
00:30:39,270 --> 00:30:41,573
is that it's still that
threat intelligence piece

722
00:30:41,573 --> 00:30:43,575
even at a basic level,

723
00:30:43,575 --> 00:30:44,776
saying I'm looking
for something,

724
00:30:44,776 --> 00:30:47,579
stupid like an SMB connection

725
00:30:47,579 --> 00:30:50,849
over four or five from
finance systems to HR.

726
00:30:52,617 --> 00:30:54,085
It's like why would
those two systems

727
00:30:54,085 --> 00:30:55,687
doing network mounts
to each other?

728
00:30:55,687 --> 00:30:57,222
Yeah, it's not gonna happen.

729
00:30:57,222 --> 00:30:59,190
They are always, do that
baselining of your network

730
00:30:59,190 --> 00:31:00,959
that you're gonna
be taking a look at.

731
00:31:00,959 --> 00:31:02,660
The other thing we take
a look at in the survey,

732
00:31:02,660 --> 00:31:04,195
and this is actually
only the second thing

733
00:31:04,195 --> 00:31:06,331
I decided to put up here,

734
00:31:06,331 --> 00:31:09,167
I wanted focus on the initial
one for a little bit of time,

735
00:31:09,167 --> 00:31:12,870
is that how many teams
out there are dedicated

736
00:31:12,871 --> 00:31:14,472
to hunting at this point?

737
00:31:14,472 --> 00:31:16,541
And we're still a small number.

738
00:31:16,541 --> 00:31:18,408
And I actually think this
number is slightly inflated

739
00:31:18,409 --> 00:31:20,144
because they could say
I'm a full time hunter,

740
00:31:20,144 --> 00:31:21,613
but also incident responder,

741
00:31:21,613 --> 00:31:23,314
and it depends on
how you define it.

742
00:31:23,314 --> 00:31:25,016
But the other ones
that are down there

743
00:31:25,016 --> 00:31:26,718
that basically if
you look at this

744
00:31:26,718 --> 00:31:28,253
it doesn't add up to 100%,

745
00:31:28,253 --> 00:31:30,889
but you say, how many of you
are actually doing hunting?

746
00:31:30,889 --> 00:31:33,925
It's like, yeah, we do it ad
hoc based or we outsource it,

747
00:31:34,926 --> 00:31:36,895
we pull it from other staff.

748
00:31:36,895 --> 00:31:38,429
But when you end up
taking a look at hunting,

749
00:31:38,429 --> 00:31:40,031
(mumbles) a very small
percentage of you

750
00:31:40,031 --> 00:31:42,332
are actually dedicated to doing
hunting in an environment.

751
00:31:42,333 --> 00:31:43,835
Now this might change
over the years,

752
00:31:43,835 --> 00:31:47,071
especially how hunting
is changing the way

753
00:31:47,071 --> 00:31:49,274
technology is working
and the operations

754
00:31:49,274 --> 00:31:51,141
working in your environment.

755
00:31:51,142 --> 00:31:53,878
What tools are you using?

756
00:31:53,878 --> 00:31:55,914
Now the thing about the tools,

757
00:31:55,914 --> 00:31:58,383
and this off is gonna lead
into a different debate

758
00:31:58,383 --> 00:32:01,185
that we'll be touching
on in a few slides,

759
00:32:01,185 --> 00:32:04,289
the tools for a hunter, you
just can't constantly saying

760
00:32:04,289 --> 00:32:07,458
I'm gonna do a single TCP
dump analysis using Wireshark.

761
00:32:08,693 --> 00:32:10,595
That is not going to work.

762
00:32:10,595 --> 00:32:13,865
You need something such
as what Phil's developed

763
00:32:13,865 --> 00:32:18,870
with the SOF-ELK in order
to ingest tons of data

764
00:32:20,271 --> 00:32:21,572
into the system to give you
more horizon perspective

765
00:32:21,572 --> 00:32:23,107
of what's going on
in your network.

766
00:32:23,107 --> 00:32:26,411
School, I mean tools, schools,

767
00:32:26,411 --> 00:32:29,080
tools increase efficiency
and scalability

768
00:32:29,080 --> 00:32:31,182
across your environment.

769
00:32:31,182 --> 00:32:33,217
Tools increase
scalability and efficiency

770
00:32:33,217 --> 00:32:34,652
across your environment.

771
00:32:34,652 --> 00:32:36,421
So that goes back to
all the SIEM analytics

772
00:32:36,421 --> 00:32:38,189
that's out there, log
file analysis (mumbles)

773
00:32:38,189 --> 00:32:39,657
all these other things
that are already there,

774
00:32:39,657 --> 00:32:41,359
they're fairly automated.

775
00:32:41,359 --> 00:32:43,226
They're gonna help
increase your efficiencies

776
00:32:43,227 --> 00:32:44,862
across the environment,

777
00:32:44,862 --> 00:32:46,631
and we'll come back
to the automation
here in just a second.

778
00:32:46,631 --> 00:32:48,599
But when you pad that
with threat intelligence,

779
00:32:48,599 --> 00:32:50,902
they become even more accurate.

780
00:32:50,902 --> 00:32:52,870
Don't just rely on third
party vendor signatures

781
00:32:52,870 --> 00:32:56,073
to drive your operational tools.

782
00:32:56,074 --> 00:32:58,743
Do not just rely on
third party vendors,

783
00:32:58,743 --> 00:33:00,778
antivirus, anyone else.

784
00:33:00,778 --> 00:33:02,513
You need to start
creating your own

785
00:33:02,513 --> 00:33:05,416
to be able to take a look for
hunting in your environment.

786
00:33:05,416 --> 00:33:06,818
Now it becomes a second debate.

787
00:33:06,818 --> 00:33:08,920
Beyond the definition
debate that's out there,

788
00:33:08,920 --> 00:33:12,690
what is hunting, now becomes
is hunting automated debate.

789
00:33:12,690 --> 00:33:14,926
And this one is kind of,

790
00:33:16,094 --> 00:33:18,262
people get angry
about this one too.

791
00:33:18,262 --> 00:33:20,298
It's like no, it sounds
like tastes great,

792
00:33:20,298 --> 00:33:21,833
less filling argument
that goes on.

793
00:33:21,833 --> 00:33:24,168
No, it's automated; no, it's
not automated that goes on.

794
00:33:24,168 --> 00:33:27,437
My perspective is
that automated hunting

795
00:33:27,438 --> 00:33:30,241
and its totality, the where
it's fire-and-forget missile,

796
00:33:30,241 --> 00:33:31,809
you just close your eyes
and walk away, go home,

797
00:33:31,809 --> 00:33:34,579
wait for an alert to come back
up to you, does not exist.

798
00:33:34,579 --> 00:33:37,682
Hunting is still human-driven,
looking for human behavior.

799
00:33:39,117 --> 00:33:41,886
Because it's way too easy for
that human side to do this.

800
00:33:41,886 --> 00:33:44,155
Now having said,
do you need tools

801
00:33:44,155 --> 00:33:46,290
to help automate your hunt?

802
00:33:46,290 --> 00:33:47,457
Yes.

803
00:33:47,458 --> 00:33:49,327
When we end up taking
a look at that.

804
00:33:49,327 --> 00:33:50,928
Take a look at the
respondents here,

805
00:33:50,928 --> 00:33:53,031
how many are actually
doing what they claim

806
00:33:53,031 --> 00:33:54,499
is full automated hunting,

807
00:33:54,499 --> 00:33:56,634
which could be defined
depending on how they read

808
00:33:56,634 --> 00:33:58,536
the question, hey,
we have an intrusion

809
00:33:58,536 --> 00:34:00,071
detection system in sim,

810
00:34:00,071 --> 00:34:03,174
and we plug signatures
into it to look for things.

811
00:34:03,174 --> 00:34:05,076
Therefore, we are
hunting, right?

812
00:34:05,076 --> 00:34:07,779
So they said we're fully
automated at that point.

813
00:34:07,779 --> 00:34:09,746
And I kind of say, well
we're not really sure

814
00:34:09,746 --> 00:34:12,216
how they responded, but
the other respondents,

815
00:34:12,216 --> 00:34:14,284
everyone else said no
we're not automated,

816
00:34:14,284 --> 00:34:15,920
or were semi-automated.

817
00:34:15,920 --> 00:34:18,222
And semi automated is
likely where you're going

818
00:34:18,222 --> 00:34:20,992
to end up being here, which
leads us to spending priorities.

819
00:34:22,159 --> 00:34:24,127
Everyone's like well,
this one was kind of

820
00:34:24,128 --> 00:34:25,530
an interesting one.

821
00:34:25,530 --> 00:34:27,565
They talked about automation
and then they start

822
00:34:27,565 --> 00:34:30,768
talking about where they're
actually spending their money.

823
00:34:32,335 --> 00:34:34,738
Almost all the organizations
out there are investing

824
00:34:34,739 --> 00:34:37,308
more money into
technology and tools

825
00:34:37,308 --> 00:34:39,677
than they are into people,

826
00:34:39,677 --> 00:34:41,479
which I find a critical error.

827
00:34:41,478 --> 00:34:44,714
And which is funny because
after this question,

828
00:34:44,715 --> 00:34:48,152
they come back and said that
the most important thing is,

829
00:34:48,152 --> 00:34:50,221
we need trained people.

830
00:34:50,221 --> 00:34:52,489
And here are the skills
that they need to do this.

831
00:34:53,690 --> 00:34:54,991
The other thing you
have to take a look at

832
00:34:54,992 --> 00:34:56,627
when you're talking about tools,

833
00:34:56,627 --> 00:35:00,198
tools still have to be driven
by a skilled individual.

834
00:35:00,198 --> 00:35:03,935
How many of you in here
would write a paper,

835
00:35:03,935 --> 00:35:06,770
20 pages long that you're
gonna turn in for a term paper,

836
00:35:06,771 --> 00:35:08,773
hit automated spell checker,

837
00:35:08,773 --> 00:35:11,843
which means you don't look
at what it's correcting

838
00:35:11,843 --> 00:35:15,011
and you close and submit
that paper to be graded?

839
00:35:17,081 --> 00:35:18,349
Chris Crowley.

840
00:35:18,349 --> 00:35:19,717
You would do that.

841
00:35:19,717 --> 00:35:21,219
I appreciate that.

842
00:35:21,219 --> 00:35:22,787
No one in their right
mind would do that,

843
00:35:22,787 --> 00:35:24,522
but what do spell
checkers now in here do?

844
00:35:24,522 --> 00:35:25,790
And by the way, I use Grammarly.

845
00:35:25,790 --> 00:35:28,125
I mean, talk about, that
thing is amazing, right?

846
00:35:28,126 --> 00:35:30,895
How many people ARE like, your
eyes are open to how many,

847
00:35:30,895 --> 00:35:33,631
if you use Grammarly,
I highly recommend it.

848
00:35:33,631 --> 00:35:36,567
I cannot exist without
Grammarly right now.

849
00:35:36,567 --> 00:35:40,037
It catches so many of my
foibles and kryptonite words

850
00:35:40,037 --> 00:35:43,006
that I constantly get
wrong in the way I'm doing

851
00:35:43,007 --> 00:35:44,909
passive voice and everywhere,

852
00:35:44,909 --> 00:35:46,744
but it still needs to
inform me, it says hey,

853
00:35:46,744 --> 00:35:49,580
we could detect it, but you
still need to react to it.

854
00:35:49,580 --> 00:35:51,382
You still need to be
involved in this process.

855
00:35:51,382 --> 00:35:53,985
There's no such thing as a
fully automated spell checker.

856
00:35:53,985 --> 00:35:56,821
So how can we claim
that something as simple

857
00:35:56,821 --> 00:35:59,891
as spell checking cannot
be fully automated?

858
00:36:01,225 --> 00:36:03,327
If you cannot fully
automate spell checking,

859
00:36:03,327 --> 00:36:04,829
you cannot fully
automate hunting.

860
00:36:04,829 --> 00:36:06,297
Period.

861
00:36:06,297 --> 00:36:07,932
And that's one of the
things that when we start

862
00:36:07,932 --> 00:36:11,134
taking a look at this is
that tools augment people.

863
00:36:12,470 --> 00:36:14,971
So the first priority should be,

864
00:36:14,972 --> 00:36:17,241
and this is kind of the advice
that we had in the paper,

865
00:36:17,241 --> 00:36:19,277
is that staffing and
training needs to be

866
00:36:19,277 --> 00:36:22,346
higher prioritization
for organizations

867
00:36:22,346 --> 00:36:24,949
that are looking at
getting into hunting.

868
00:36:24,949 --> 00:36:27,285
The people will then
create the tools

869
00:36:27,285 --> 00:36:29,420
that technologies needed.

870
00:36:29,420 --> 00:36:32,256
If you don't have a budget
now for buying anything

871
00:36:32,256 --> 00:36:34,558
out there, I guarantee
someone will do that,

872
00:36:34,559 --> 00:36:38,196
learn PowerShell in a week,
a month of lunches book

873
00:36:38,196 --> 00:36:40,431
that I know a lot of
you (mumbles) read.

874
00:36:40,431 --> 00:36:43,034
Someone is gonna say
fine, I'll do it.

875
00:36:43,034 --> 00:36:47,471
Or as Phil said, I'm gonna
create my own analytics platform

876
00:36:47,471 --> 00:36:49,674
because I can.

877
00:36:49,674 --> 00:36:51,342
And by the way,
Phil's tool is free.

878
00:36:51,342 --> 00:36:53,311
For example SOF-ELK.

879
00:36:53,311 --> 00:36:55,279
He'll give you the link later,

880
00:36:55,279 --> 00:36:57,081
or we'll send it
out to you guys.

881
00:36:57,081 --> 00:36:59,617
But you got to say it with me,
and I'm not gonna force you

882
00:36:59,617 --> 00:37:03,354
to say it with me, but fully
automated fire-and-forget

883
00:37:03,354 --> 00:37:06,857
threat hunting does not exist.

884
00:37:06,857 --> 00:37:08,092
And I know I'm not the only one

885
00:37:08,092 --> 00:37:09,293
that's gonna be
talking about it.

886
00:37:09,293 --> 00:37:10,228
I read the reports,
I'm not trying to take,

887
00:37:10,228 --> 00:37:11,562
steal thunder away from them.

888
00:37:11,562 --> 00:37:13,764
They're gonna have their
own 40-minute discussion

889
00:37:13,764 --> 00:37:15,333
on some of these things in here,

890
00:37:15,333 --> 00:37:18,436
but you cannot fully
automate it, period.

891
00:37:18,436 --> 00:37:19,637
I go back to my spell.

892
00:37:19,637 --> 00:37:21,105
If you cannot fully
automate spell checking,

893
00:37:21,105 --> 00:37:22,673
which is something super simple,

894
00:37:22,673 --> 00:37:24,674
you cannot automate
something as complex

895
00:37:24,675 --> 00:37:27,111
as detecting threats
in your environment.

896
00:37:27,111 --> 00:37:30,748
All right, what skills are
required for those staff

897
00:37:30,748 --> 00:37:31,749
that you're gonna have?

898
00:37:31,749 --> 00:37:33,551
Now the cool thing here,

899
00:37:33,551 --> 00:37:35,786
the survey
respondents nailed it.

900
00:37:35,786 --> 00:37:37,521
If you're gonna hire people,

901
00:37:37,521 --> 00:37:39,590
the first things you
need to prioritize

902
00:37:39,590 --> 00:37:42,693
are not DFIR skills of like
how to analyze systems,

903
00:37:42,693 --> 00:37:44,362
but if you look at the
first common there,

904
00:37:44,362 --> 00:37:48,165
the tier one rankings,
it's standard SOC skills.

905
00:37:48,165 --> 00:37:51,869
Log analysis, analytics,
baseline network activity,

906
00:37:51,869 --> 00:37:53,437
baseline threat analysis,

907
00:37:53,437 --> 00:37:55,306
understanding a
baseline endpoint apps.

908
00:37:55,306 --> 00:37:58,643
All that stuff is the core
knowledge that you need to have

909
00:37:58,643 --> 00:37:59,910
in your environment.

910
00:37:59,910 --> 00:38:01,879
Those people that
have those skills

911
00:38:01,879 --> 00:38:03,481
would be able to
know how to do that

912
00:38:03,481 --> 00:38:06,284
are gonna be critical
to creating proper
threatened hunting

913
00:38:06,284 --> 00:38:08,419
in your environments.

914
00:38:08,419 --> 00:38:10,221
The second set of skills,
your tier two skills,

915
00:38:10,221 --> 00:38:11,722
again when you see them rank,

916
00:38:11,722 --> 00:38:13,691
there's more than
this by the way,

917
00:38:13,691 --> 00:38:16,426
just all happened
to be grouped into,

918
00:38:16,427 --> 00:38:17,895
and you can see
the rankings there,

919
00:38:17,895 --> 00:38:21,165
your DFIR skills: memory
analysis, network forensics,

920
00:38:21,165 --> 00:38:23,968
host forensics and more,
all this stuff, nicely,

921
00:38:23,968 --> 00:38:25,502
both tier one, tier two.

922
00:38:25,503 --> 00:38:27,972
That could have been overlapped,

923
00:38:27,972 --> 00:38:30,174
but this is literally the way
the respondents came back in.

924
00:38:30,174 --> 00:38:31,742
I was saying, this
is kind of amazing

925
00:38:31,742 --> 00:38:34,245
because exactly what I would
say you got to focus in on

926
00:38:34,245 --> 00:38:35,746
if you're creating
a hunting team,

927
00:38:35,746 --> 00:38:38,683
which goes back to if you
don't have a proper SOC,

928
00:38:38,683 --> 00:38:41,285
you can't suddenly just
jump your way over to

929
00:38:41,285 --> 00:38:43,120
let's do threat hunting.

930
00:38:43,120 --> 00:38:46,290
SOC is that tier one
skill you need to have.

931
00:38:46,290 --> 00:38:48,726
Threat intelligence
incident response

932
00:38:48,726 --> 00:38:50,928
kind of waterfalls
down from there.

933
00:38:50,928 --> 00:38:53,263
The other thing that ended
up being interesting here

934
00:38:53,264 --> 00:38:55,099
is endpoints.

935
00:38:56,300 --> 00:38:59,303
All the respondents
in the survey stated

936
00:38:59,303 --> 00:39:01,939
that the best source of
telemetry data for hunting

937
00:39:01,939 --> 00:39:04,442
actually originated
from endpoints.

938
00:39:04,442 --> 00:39:06,911
But you end up
taking a look at it,

939
00:39:06,911 --> 00:39:10,281
it's like a really useful
identification endpoint,

940
00:39:10,281 --> 00:39:13,651
log files and more, but while
endpoint data was rated high,

941
00:39:15,453 --> 00:39:18,622
it was not collected
across the environment.

942
00:39:20,024 --> 00:39:21,726
And I actually think there's
several causes to this.

943
00:39:21,726 --> 00:39:24,829
Number one is that endpoint
data is less mature capability

944
00:39:27,998 --> 00:39:31,869
across the board for
data collection at scale.

945
00:39:31,869 --> 00:39:35,039
There's not enough vendors out
there that are in this space

946
00:39:35,039 --> 00:39:37,274
that allow you to pull
this data independently,

947
00:39:37,274 --> 00:39:40,544
or be even in log files that
are being forwarded back,

948
00:39:40,544 --> 00:39:42,379
you're not collecting
enough of them,

949
00:39:42,380 --> 00:39:44,215
and you don't have
enough being ingested.

950
00:39:44,215 --> 00:39:45,449
You're only taking
care of the servers.

951
00:39:45,449 --> 00:39:47,351
You're not taking care
of where the threats

952
00:39:47,351 --> 00:39:50,654
might actually hit
inside your environment.

953
00:39:50,654 --> 00:39:54,125
So they know how valuable
endpoint analysis is.

954
00:39:54,125 --> 00:39:55,860
But you may have
networks covered,

955
00:39:55,860 --> 00:39:58,162
which several years ago
to a SOC summit, someone

956
00:39:58,162 --> 00:40:01,298
asked me the question
where should you begin

957
00:40:01,298 --> 00:40:03,868
when you're doing
threat hunting?

958
00:40:03,868 --> 00:40:06,237
And I basically answered,
start with network.

959
00:40:06,237 --> 00:40:08,372
Easier to find people
that are trained,

960
00:40:08,372 --> 00:40:10,574
easier to find mature tools.

961
00:40:10,574 --> 00:40:14,178
On the second side of that
fence, endpoint follows second.

962
00:40:14,178 --> 00:40:16,946
Endpoint, well, as valuable,
if not more valuable

963
00:40:16,947 --> 00:40:18,549
as a survey respondent said,

964
00:40:18,549 --> 00:40:21,452
but the problem is there's not
enough capability out there,

965
00:40:21,452 --> 00:40:24,188
and using PowerShell scripts
that you hack together

966
00:40:24,188 --> 00:40:26,323
to get something to
work in the first place.

967
00:40:26,323 --> 00:40:27,825
So it's kind of frustrating
the teams out there,

968
00:40:27,825 --> 00:40:29,058
it's like you know what's there,

969
00:40:29,059 --> 00:40:30,795
you want to reach
out and grab it,

970
00:40:30,795 --> 00:40:33,464
but unfortunately you
have no capabilities.

971
00:40:33,464 --> 00:40:35,666
And that's really difficult
and it's very frustrating

972
00:40:35,666 --> 00:40:37,835
to a lot of SOCs that are
out there trying to do this.

973
00:40:37,835 --> 00:40:39,103
The other thing that's in there,

974
00:40:39,103 --> 00:40:40,871
which was really
surprising to me,

975
00:40:40,871 --> 00:40:42,840
is it kind of ranked where
a threat intelligence stood

976
00:40:42,840 --> 00:40:44,241
how valuable is
threat intelligence,

977
00:40:44,241 --> 00:40:46,110
and it ranked in the middle.

978
00:40:46,110 --> 00:40:47,545
And I was like ugh,

979
00:40:47,545 --> 00:40:49,313
and I kind of felt
deflated when I saw this.

980
00:40:49,313 --> 00:40:52,483
And it basically told me
that most organizations

981
00:40:52,483 --> 00:40:54,018
are doing more generic hunts,

982
00:40:54,018 --> 00:40:56,053
which is like I'm just
looking for random stuff,

983
00:40:56,053 --> 00:40:58,055
I got a list from a
third party vendor,

984
00:40:58,055 --> 00:41:00,124
but they're not
using targeted hunts

985
00:41:00,124 --> 00:41:02,593
in the environments
looking for bad guys.

986
00:41:02,593 --> 00:41:04,028
So you end up, it's
like I'm trying to base

987
00:41:04,028 --> 00:41:05,495
a lot of the discussion
that's gonna happen over

988
00:41:05,496 --> 00:41:07,064
the next couple days
based on some of this data

989
00:41:07,064 --> 00:41:08,899
that's out there, you
take a look at this,

990
00:41:08,899 --> 00:41:10,100
it's like look at this.

991
00:41:10,100 --> 00:41:13,604
I mean, look at
this, look at this.

992
00:41:13,604 --> 00:41:16,573
Threat intelligence should be
higher on the priority list,

993
00:41:16,574 --> 00:41:19,844
but a lot of organizations
barely are able to create

994
00:41:19,844 --> 00:41:22,213
a really well functioning SOC,

995
00:41:22,213 --> 00:41:24,915
much less let's get into the
threat intelligence pool,

996
00:41:24,915 --> 00:41:27,718
much less let's dive into
the threat hunting pool.

997
00:41:27,718 --> 00:41:29,587
And one would literally
waterfalls in the other.

998
00:41:29,587 --> 00:41:31,088
But a basic SOC level,

999
00:41:31,088 --> 00:41:33,891
could you have people looking
up generic signatures, yes.

1000
00:41:33,891 --> 00:41:36,126
And again, going back to

1001
00:41:36,126 --> 00:41:37,895
the what we call
the pyramids of pain

1002
00:41:37,895 --> 00:41:39,763
that we'll cover
in the next slide,

1003
00:41:39,763 --> 00:41:42,967
the thing about it is, is
that even at a generic basis,

1004
00:41:42,967 --> 00:41:44,802
SOCs that are out there
engaging in threat hunting,

1005
00:41:44,802 --> 00:41:47,304
yeah you can find things

1006
00:41:47,304 --> 00:41:49,340
at a very basic (mumbles) level,

1007
00:41:49,340 --> 00:41:52,710
but you're going to be more
effective at targeted hunts

1008
00:41:52,710 --> 00:41:55,613
and reducing dwell time
across your entire enterprise

1009
00:41:55,613 --> 00:41:58,816
the more you're able
to ingest and culture

1010
00:41:58,816 --> 00:42:00,084
your own threat intelligence,

1011
00:42:00,084 --> 00:42:02,152
not just relying third
party sources for that.

1012
00:42:02,152 --> 00:42:05,222
So speaking of pyramids,
where's David in here,

1013
00:42:05,222 --> 00:42:06,457
David Bianco?

1014
00:42:06,457 --> 00:42:07,924
Ah there you go, right
in the front of the row.

1015
00:42:07,925 --> 00:42:08,893
Do you have your stickers
with you, by the way?

1016
00:42:08,893 --> 00:42:10,094
(distant indistinct muttering)

1017
00:42:10,094 --> 00:42:11,395
Yeah, he has pyramids
of pain stickers.

1018
00:42:11,395 --> 00:42:13,297
Are you a Westworld fan?

1019
00:42:13,297 --> 00:42:15,366
Okay, so you saw the picture?

1020
00:42:15,366 --> 00:42:16,834
So I'm like oh, I thought I was,

1021
00:42:16,834 --> 00:42:19,569
this made it from the
original presentation.

1022
00:42:19,570 --> 00:42:21,205
Something like I did
it just for David.

1023
00:42:21,205 --> 00:42:24,542
Speaking of pain, you go
back to what David espouses,

1024
00:42:26,043 --> 00:42:29,013
it's like listen, you could
start at a very easy level.

1025
00:42:29,013 --> 00:42:30,981
And what I'm talking about
most of surveys out there

1026
00:42:30,981 --> 00:42:33,918
in management goes through
these things and says hey,

1027
00:42:33,918 --> 00:42:36,854
we're gonna start using
tools, TTPs, IOCs,

1028
00:42:36,854 --> 00:42:38,955
we're gonna do all
this wonderment stuff
that's out there,

1029
00:42:38,956 --> 00:42:40,324
and you're starting to
shake in your boots,

1030
00:42:40,324 --> 00:42:41,892
like we don't know
how to do any of that.

1031
00:42:41,892 --> 00:42:45,495
David's perception on this
is like hey, start simple.

1032
00:42:45,496 --> 00:42:48,132
Start at the lowest rung here.

1033
00:42:48,132 --> 00:42:49,667
You could do hash lookups.

1034
00:42:49,667 --> 00:42:52,303
You could do very basic stuff
without a lot of capability,

1035
00:42:52,303 --> 00:42:53,537
and that's true.

1036
00:42:53,537 --> 00:42:55,906
But if you're really
doing targeted analysis,

1037
00:42:55,906 --> 00:42:58,776
targeted hunting, you're
gonna have to up the game

1038
00:42:58,776 --> 00:43:00,877
in order to truly
reduce that dwell time,

1039
00:43:00,878 --> 00:43:02,680
what most of us want to
actually achieve in here,

1040
00:43:02,680 --> 00:43:04,181
you're gonna have
to accomplish that.

1041
00:43:04,181 --> 00:43:06,850
Now one of the things that
definitely comes up here

1042
00:43:06,850 --> 00:43:09,653
is how many times have
you been able to say

1043
00:43:09,653 --> 00:43:12,089
what is the output
of threat hunting?

1044
00:43:12,089 --> 00:43:13,924
And this is another indicator
that threat intelligence

1045
00:43:13,924 --> 00:43:15,960
is definitely not being
cultivated enough,

1046
00:43:15,960 --> 00:43:19,096
is that how many
times have you been,

1047
00:43:19,096 --> 00:43:22,399
have you seen the same adversary

1048
00:43:22,399 --> 00:43:23,968
across your environment?

1049
00:43:23,968 --> 00:43:26,270
And what was interesting here

1050
00:43:26,270 --> 00:43:27,738
is you take a look
at this is that

1051
00:43:27,738 --> 00:43:29,406
most of the
individuals in there,

1052
00:43:29,406 --> 00:43:30,841
that they detect
another intrusion

1053
00:43:30,841 --> 00:43:33,911
we're not able to
independently verify

1054
00:43:33,911 --> 00:43:37,581
if the threat was a new
threat, an evolved threats,

1055
00:43:37,581 --> 00:43:39,216
or hey we don't know.

1056
00:43:39,216 --> 00:43:41,418
And that's pretty stark
to me because again,

1057
00:43:41,418 --> 00:43:43,520
it basically shows
that there's not

1058
00:43:43,520 --> 00:43:45,556
a threat intelligence
team in your organization

1059
00:43:45,556 --> 00:43:47,257
that is centered on
looking at the threats

1060
00:43:47,257 --> 00:43:49,093
that are targeting you,
and see if it's just

1061
00:43:49,093 --> 00:43:51,528
an evolved threat from someone
who's hit you in the past

1062
00:43:51,528 --> 00:43:53,497
because they got more
sneaky, that they decided

1063
00:43:53,497 --> 00:43:54,964
to get better at
what they were doing

1064
00:43:54,965 --> 00:43:57,468
because you also got better
at what you were doing,

1065
00:43:57,468 --> 00:44:00,236
just like what we were doing
back in Moonlight Maze days.

1066
00:44:00,237 --> 00:44:03,340
This slide is also an
indicator that says

1067
00:44:03,340 --> 00:44:04,908
that threat intelligence
middle ground,

1068
00:44:04,908 --> 00:44:08,879
that soft chewy middle, is
really a necessity for this,

1069
00:44:08,879 --> 00:44:10,413
which we have our own summit

1070
00:44:10,414 --> 00:44:12,316
just in cyber
threat intelligence.

1071
00:44:12,316 --> 00:44:14,250
We actually just said
underlines the fact

1072
00:44:14,251 --> 00:44:15,986
that most teams do
not have a formal

1073
00:44:15,986 --> 00:44:17,020
threat intelligence capability,

1074
00:44:17,021 --> 00:44:18,522
you're relying on third party,

1075
00:44:18,522 --> 00:44:20,357
which basically
means you're hoping

1076
00:44:20,357 --> 00:44:23,192
that they've seen your threat
before for your signatures.

1077
00:44:23,193 --> 00:44:26,263
The other thing though,
which is amazing here,

1078
00:44:26,263 --> 00:44:29,266
and this is actually the
light at the end of the tunnel

1079
00:44:29,266 --> 00:44:33,170
saying that there's a shining
beacon of hope out there

1080
00:44:33,170 --> 00:44:34,838
when it comes to threat hunting,

1081
00:44:34,838 --> 00:44:36,340
this question is
the actual question

1082
00:44:36,340 --> 00:44:37,541
that was on the survey.

1083
00:44:37,541 --> 00:44:38,709
On average, how long
does it take you

1084
00:44:38,709 --> 00:44:41,078
to proactively uncover
a serious threat

1085
00:44:41,078 --> 00:44:43,147
from the time you start?

1086
00:44:44,682 --> 00:44:47,618
And it's bolded, not
in the original survey

1087
00:44:47,618 --> 00:44:50,688
but I did it here on
purpose, start to pursue it?

1088
00:44:50,688 --> 00:44:53,023
And this is, again, they could
have been in an environment

1089
00:44:53,023 --> 00:44:55,592
for years, months, who knows?

1090
00:44:55,592 --> 00:44:57,094
But teams then
actually said hey,

1091
00:44:57,094 --> 00:44:59,263
I'm gonna go start
hunting right now,

1092
00:44:59,263 --> 00:45:02,165
they were able, 50% actually
started to find threats

1093
00:45:02,166 --> 00:45:05,335
within 24 hours, which is,
even with all the capabilities

1094
00:45:05,335 --> 00:45:07,738
that are out there, basically
shows how effective hunting,

1095
00:45:07,738 --> 00:45:10,841
even at a basic level,
is able to accomplish,

1096
00:45:10,841 --> 00:45:14,078
which leads to David was
right in your pyramid of pain.

1097
00:45:14,078 --> 00:45:17,614
Start with the basics even
at a very freshman level,

1098
00:45:20,651 --> 00:45:22,152
you don't have to be at the top,

1099
00:45:22,152 --> 00:45:24,588
like some of the contractor
teams that you see out there.

1100
00:45:24,588 --> 00:45:26,390
You could still accomplish this.

1101
00:45:26,390 --> 00:45:29,859
The other thing is
this question does show

1102
00:45:31,328 --> 00:45:35,099
that even one person
threat hunting team

1103
00:45:35,099 --> 00:45:37,101
could make a difference
in the organization

1104
00:45:37,101 --> 00:45:41,271
and help reduce the threat
or reduce the dwell time

1105
00:45:41,271 --> 00:45:44,241
that most of our threats
have across our environment.

1106
00:45:44,241 --> 00:45:46,643
So I kind of went back
across the board here

1107
00:45:46,643 --> 00:45:48,011
and say if there
are three points

1108
00:45:48,011 --> 00:45:49,846
that I'm gonna have you
walk away with in here

1109
00:45:49,847 --> 00:45:53,150
that I got out of looking at
this, looking at the history

1110
00:45:53,150 --> 00:45:56,587
across what we've done
over the past 20 years

1111
00:45:56,587 --> 00:45:58,922
and where we stand today
when we're talking about

1112
00:45:58,922 --> 00:46:01,225
threat hunting, threat
taunting is still new,

1113
00:46:01,225 --> 00:46:04,862
number one is that you need
to really take a hard look

1114
00:46:04,862 --> 00:46:06,864
before you say
we're doing hunting,

1115
00:46:06,864 --> 00:46:08,098
you need to first
ask the question,

1116
00:46:08,098 --> 00:46:09,600
what are we doing for
threat intelligence?

1117
00:46:09,600 --> 00:46:11,935
The two should potentially
be working hand-in-hand.

1118
00:46:11,935 --> 00:46:14,938
How are you cultivating it,
how are you creating your own?

1119
00:46:14,938 --> 00:46:17,441
How are you ingesting
feeds from others?

1120
00:46:17,441 --> 00:46:19,776
Does your SOC even have a feed

1121
00:46:19,777 --> 00:46:21,678
that it could take a
signature created by

1122
00:46:21,678 --> 00:46:23,981
a threat intelligence
capability that could even then

1123
00:46:23,981 --> 00:46:26,483
deploy across your environment?

1124
00:46:26,483 --> 00:46:28,385
We're gonna be talking about
that over the next few days.

1125
00:46:28,385 --> 00:46:31,021
Two, people before technology.

1126
00:46:31,021 --> 00:46:32,956
And of course, everyone in here,

1127
00:46:32,956 --> 00:46:35,092
most of you are like yeah
that's our mantra already,

1128
00:46:35,092 --> 00:46:36,794
but you have to fight
management on that.

1129
00:46:36,794 --> 00:46:38,529
Management knows
people could leave.

1130
00:46:38,529 --> 00:46:41,865
They're hard to keep
motivated, they're problems.

1131
00:46:43,834 --> 00:46:47,370
It's hard, management is hard.

1132
00:46:47,371 --> 00:46:49,540
Technology, all I have to
do is go yell at a vendor

1133
00:46:49,540 --> 00:46:51,308
and saying, hey,
your tool sucks.

1134
00:46:51,308 --> 00:46:52,910
And the vendors are also
kind of a problem here

1135
00:46:52,910 --> 00:46:56,212
because their tools say
we're better than people.

1136
00:46:56,213 --> 00:46:57,981
If you fall into that trap,

1137
00:46:57,981 --> 00:46:59,883
you need to talk across
your peers in the community

1138
00:46:59,883 --> 00:47:03,520
and say how many
people use a tool X?

1139
00:47:03,520 --> 00:47:04,755
Is it effective?

1140
00:47:04,755 --> 00:47:06,657
What will it mean to me?

1141
00:47:06,657 --> 00:47:09,193
Talk to the peer level
stuff that's out there

1142
00:47:09,193 --> 00:47:11,094
when you're
evaluating your tools.

1143
00:47:11,094 --> 00:47:12,496
Don't just believe
what the vendors

1144
00:47:12,496 --> 00:47:14,331
write on their pamphlets
that say this thing

1145
00:47:14,331 --> 00:47:15,966
is an automated threat
hunting capability

1146
00:47:15,966 --> 00:47:17,835
that will stop the cyber.

1147
00:47:17,835 --> 00:47:19,570
You know, whatever that
they end up putting,

1148
00:47:19,570 --> 00:47:21,371
marketing people end up doing.

1149
00:47:21,371 --> 00:47:22,706
No offense to my
marketing people

1150
00:47:22,706 --> 00:47:24,208
that are here in
front of the room.

1151
00:47:24,208 --> 00:47:27,244
The last one is we need
to figure out better ways

1152
00:47:27,244 --> 00:47:28,512
to do endpoint data.

1153
00:47:28,512 --> 00:47:30,581
So all the technologies
and programmers in here,

1154
00:47:30,581 --> 00:47:32,449
we need to figure out
more effective ways.

1155
00:47:32,449 --> 00:47:33,851
PowerShell is a huge way.

1156
00:47:33,851 --> 00:47:35,219
We have several frameworks
that are out there

1157
00:47:35,219 --> 00:47:37,221
existing already, but in the end

1158
00:47:37,221 --> 00:47:39,423
it's very important for us

1159
00:47:39,423 --> 00:47:41,457
to figure out new
creative solutions.

1160
00:47:41,458 --> 00:47:43,327
And if you're in this space,

1161
00:47:43,327 --> 00:47:44,394
and Carbon Black's sitting there

1162
00:47:44,394 --> 00:47:46,129
saying yay, I love this point;

1163
00:47:46,129 --> 00:47:47,931
and it's not the
fact that they are

1164
00:47:47,931 --> 00:47:49,633
an endpoint vendor, they are.

1165
00:47:49,633 --> 00:47:51,301
I mean, they're a
sponsor of this event

1166
00:47:51,301 --> 00:47:53,636
but the same time I'm not
saying endorsing them,

1167
00:47:53,637 --> 00:47:55,806
I'm saying we need
more of them out there

1168
00:47:55,806 --> 00:47:57,941
because endpoints is
the huge gaping hole

1169
00:47:57,941 --> 00:48:00,209
of our capability
most of our SOCs.

1170
00:48:00,210 --> 00:48:02,713
So I really appreciate
the opportunity

1171
00:48:02,713 --> 00:48:04,781
to kick off the summit.

1172
00:48:04,781 --> 00:48:06,283
Now I put the slide up there

1173
00:48:06,283 --> 00:48:09,786
because Phil said that I
need to start dressing up

1174
00:48:09,786 --> 00:48:12,389
as Darth Vader without
the helmet and a scar.

1175
00:48:12,389 --> 00:48:14,191
(laughs)

1176
00:48:14,191 --> 00:48:16,959
So we were just down in
Orlando, Star Wars Celebration

1177
00:48:16,960 --> 00:48:20,364
just happened to
coincide with SANS 2017,

1178
00:48:20,364 --> 00:48:23,567
and Phil texted me
from a half mile away,

1179
00:48:23,567 --> 00:48:24,968
you need to get over to me now

1180
00:48:24,968 --> 00:48:26,370
and he took this picture of me

1181
00:48:26,370 --> 00:48:28,372
so I put it up just
because I would please him.

1182
00:48:28,372 --> 00:48:31,107
Anyways, questions
before we go to break,

1183
00:48:31,108 --> 00:48:33,343
and then we're gonna kick off
with our official first talk.

1184
00:48:33,343 --> 00:48:35,345
After mine, Chris Crowley.

1185
00:48:35,345 --> 00:48:38,214
Questions that people have.

1186
00:48:38,215 --> 00:48:39,449
Yes?

1187
00:48:39,449 --> 00:48:42,085
(distant indistinct muttering)

1188
00:48:42,085 --> 00:48:44,221
Yeah, there's a season
two of Westworld.

1189
00:48:44,221 --> 00:48:46,723
Yeah, it's coming out
like in two years.

1190
00:48:46,723 --> 00:48:49,526
It seems like
they're producing it.

1191
00:48:49,526 --> 00:48:51,028
It's like Game of Thrones.

1192
00:48:51,028 --> 00:48:53,430
It's like July cannot get
here soon enough for me.

1193
00:48:53,430 --> 00:48:56,033
Okay, any questions based
on the presentation beyond

1194
00:48:56,033 --> 00:48:57,534
(laughs)

1195
00:48:57,534 --> 00:48:59,336
I like the question,
let's talk during break.

1196
00:48:59,336 --> 00:49:00,504
Yes?

1197
00:49:01,972 --> 00:49:04,308
- [Man] What would be your
argument toward management

1198
00:49:04,308 --> 00:49:06,476
to get them to
increase that spending

1199
00:49:06,476 --> 00:49:09,046
on people and training?

1200
00:49:10,747 --> 00:49:13,283
- It's hard because
management, yeah.

1201
00:49:13,283 --> 00:49:15,419
There's no silver
bullet, period.

1202
00:49:15,419 --> 00:49:18,388
You really need a
good team lead first.

1203
00:49:18,388 --> 00:49:20,324
It's like if you're
gonna invest somewhere,

1204
00:49:20,324 --> 00:49:22,626
the first person you
should invest into

1205
00:49:22,626 --> 00:49:25,696
is probably executive-level
compensation

1206
00:49:25,696 --> 00:49:27,197
for a team lead,
not only in the SOC

1207
00:49:27,197 --> 00:49:30,067
but potentially inside the
incident response team.

1208
00:49:30,067 --> 00:49:31,535
I've seen multiple times

1209
00:49:31,535 --> 00:49:33,403
that some of the most
talented people out there

1210
00:49:33,403 --> 00:49:35,638
have just stated a
team and they bring

1211
00:49:35,639 --> 00:49:37,441
the troops in with them because
they're motivating leaders

1212
00:49:37,441 --> 00:49:38,674
and so forth.

1213
00:49:38,675 --> 00:49:40,243
Richard Batelook
is a good example.

1214
00:49:40,243 --> 00:49:42,346
Lead of the GEI cert
team and so forth.

1215
00:49:42,346 --> 00:49:44,581
Richard was able to you know,

1216
00:49:44,581 --> 00:49:47,551
they hired the right guy, he
brought his team with him.

1217
00:49:47,551 --> 00:49:49,286
And all the people
that are on that team,

1218
00:49:49,286 --> 00:49:52,155
you look at where they're at
now, they're all superstars.

1219
00:49:52,155 --> 00:49:55,859
And so you need that
cultivation of that first lead,

1220
00:49:55,859 --> 00:49:57,427
and then let the
waterfall happen.

1221
00:49:57,427 --> 00:49:59,463
And you need to empower that
individual to be able to do it.

1222
00:49:59,463 --> 00:50:01,531
That's my argument, just
like you hire someone,

1223
00:50:01,531 --> 00:50:02,866
let them do their jobs.

1224
00:50:02,866 --> 00:50:04,301
But most people look
at technologists,

1225
00:50:04,301 --> 00:50:06,703
saying hey, these guys
don't know how to talk

1226
00:50:06,703 --> 00:50:08,872
to one another, they sit
in closets all day long,

1227
00:50:08,872 --> 00:50:12,241
they ingest pizza and not
know how to interact with them

1228
00:50:12,242 --> 00:50:14,277
without going Star Trek

1229
00:50:14,277 --> 00:50:16,380
and flux capacitor
language with them.

1230
00:50:16,380 --> 00:50:19,649
And so they look at you
like you're an anomaly.

1231
00:50:19,649 --> 00:50:22,285
But again, you get the
right lead in there,

1232
00:50:22,285 --> 00:50:24,587
and there's a lot of you
in here who fit that scale

1233
00:50:24,588 --> 00:50:27,290
that given the right
team, and given saying

1234
00:50:27,290 --> 00:50:28,925
I could hire two to three
talented individuals

1235
00:50:28,925 --> 00:50:30,927
that will start that process,

1236
00:50:30,927 --> 00:50:32,596
they will create
the tools for you.

1237
00:50:32,596 --> 00:50:34,531
They will say, well it
doesn't exist, we'll write it.

1238
00:50:34,531 --> 00:50:35,766
But I would start
with the team lead.

1239
00:50:35,766 --> 00:50:37,167
That's where I
make the argument,

1240
00:50:37,167 --> 00:50:40,370
it's like we need the
strongest team we could afford.

1241
00:50:40,370 --> 00:50:42,205
Stop thinking 120k salaries,

1242
00:50:42,205 --> 00:50:44,540
start thinking
executive-level salaries

1243
00:50:44,541 --> 00:50:45,876
for a proper team lead.

1244
00:50:45,876 --> 00:50:48,178
By the way, if you're
an organization

1245
00:50:48,178 --> 00:50:51,147
and everyone in Mandiant
and all the other FireEye

1246
00:50:51,148 --> 00:50:53,383
CrowdStrike consultants
do earmuffs real quick,

1247
00:50:53,383 --> 00:50:56,218
if you are wanting to
get the right person,

1248
00:50:56,219 --> 00:50:58,321
what you end up doing is
taking these individuals

1249
00:50:58,321 --> 00:51:00,257
that are flying around
the world right now

1250
00:51:00,257 --> 00:51:03,894
and not seeing their kids,
not seeing their families

1251
00:51:03,894 --> 00:51:05,928
or working like mad people,

1252
00:51:05,929 --> 00:51:08,165
sit there and saying would
you like to work from home,

1253
00:51:08,165 --> 00:51:10,734
responding to threats
and running a team?

1254
00:51:11,635 --> 00:51:13,937
And we'll pay you just as much.

1255
00:51:13,937 --> 00:51:15,672
And they're like, yes I would.

1256
00:51:15,672 --> 00:51:17,874
And a lot of these
individuals will eventually,

1257
00:51:17,874 --> 00:51:20,377
they got all these skills
at these contractor firms,

1258
00:51:20,377 --> 00:51:23,447
and they'll be more than happy
to sit under the umbrella

1259
00:51:23,447 --> 00:51:26,283
of a permanent position at a
Staples or a Bank of America,

1260
00:51:30,120 --> 00:51:32,154
anywhere out there, just
because they don't have

1261
00:51:32,155 --> 00:51:34,257
to get on a plane
every other week,

1262
00:51:34,257 --> 00:51:36,393
or actually every other
weekend, let's just be honest

1263
00:51:36,393 --> 00:51:40,130
because incidents
occur on Fridays.

1264
00:51:41,164 --> 00:51:43,100
Other questions?

1265
00:51:43,100 --> 00:51:44,067
Yes.

1266
00:51:44,067 --> 00:51:46,703
(distant indistinct muttering)

1267
00:51:52,409 --> 00:51:54,144
How do you measure
effectiveness at threat hunting

1268
00:51:54,144 --> 00:51:55,611
in an environment?

1269
00:51:55,612 --> 00:51:56,880
Oh geez.

1270
00:51:56,880 --> 00:51:58,615
It's hard to because
it's basically saying

1271
00:51:58,615 --> 00:52:01,785
how do you measure
the effectiveness
of cold prevention?

1272
00:52:01,785 --> 00:52:02,986
You wash your hands every day,

1273
00:52:02,986 --> 00:52:04,187
well I guess I
don't have a cold.

1274
00:52:04,187 --> 00:52:05,989
But how do you're
not carrying a virus?

1275
00:52:05,989 --> 00:52:08,992
And that's what they, you
don't know what you don't know.

1276
00:52:08,992 --> 00:52:11,161
Metrics, I usually take a
look at, I might recommend,

1277
00:52:11,161 --> 00:52:13,363
and Chris Crowley probably
has some in his talk too

1278
00:52:13,363 --> 00:52:15,131
so I'm teeing you up
there a little bit.

1279
00:52:15,132 --> 00:52:16,566
He's gonna be
talking about this,

1280
00:52:16,566 --> 00:52:19,202
is that deployment of
ingesting of signatures

1281
00:52:21,471 --> 00:52:23,406
and how fast you could deploy
them across your environment,

1282
00:52:23,406 --> 00:52:26,509
because during an
incident or during a hunt,

1283
00:52:26,510 --> 00:52:28,645
you may actually get a
nugget and you need to say

1284
00:52:28,645 --> 00:52:31,114
we need to figure out how many
nodes have this thing on it?

1285
00:52:31,114 --> 00:52:33,283
And you can measure
how long it takes you

1286
00:52:33,283 --> 00:52:34,884
to sweep an environment.

1287
00:52:34,885 --> 00:52:37,020
If you have the capability of
looking up a single reg key,

1288
00:52:37,020 --> 00:52:38,522
how long does that take?

1289
00:52:38,522 --> 00:52:40,190
Do you have the capability
to throw a stored signature

1290
00:52:40,190 --> 00:52:42,492
out across multiple
egress points?

1291
00:52:42,492 --> 00:52:43,960
Do you know where you
egress points are?

1292
00:52:43,960 --> 00:52:46,096
These are the types of things
you could actually measure

1293
00:52:46,096 --> 00:52:49,132
and become effective and saying
how fast can we react to it?

1294
00:52:50,367 --> 00:52:52,402
And so because of that,
you could measure this,

1295
00:52:52,402 --> 00:52:54,671
how fast you can
incorporate that cycle.

1296
00:52:54,671 --> 00:52:56,439
So if you're very lethargic,

1297
00:52:56,439 --> 00:52:57,973
and the cycle is a slow process,

1298
00:52:57,974 --> 00:53:00,911
it takes weeks to do a single
sweep for one registry key,

1299
00:53:00,911 --> 00:53:03,013
that's probably we
need to improve that.

1300
00:53:03,013 --> 00:53:05,315
So just like anyone else
in here does training

1301
00:53:05,315 --> 00:53:07,284
for triathlons or anything else,

1302
00:53:07,284 --> 00:53:10,086
is you measure yourself how
fast did it take me to do 10k.

1303
00:53:10,086 --> 00:53:13,455
Well, in two months, how fast
did it take me to do 10k?

1304
00:53:13,456 --> 00:53:16,426
You should be able to
improve the more you train.

1305
00:53:16,426 --> 00:53:17,761
All right, other questions?

1306
00:53:17,761 --> 00:53:20,964
Last question and we
have to go to break.

1307
00:53:22,265 --> 00:53:23,533
- [Man] Hi, thanks.

1308
00:53:23,533 --> 00:53:26,169
I was hoping to get
your thoughts about

1309
00:53:26,169 --> 00:53:29,573
opportunistic malware
versus targeted malware,

1310
00:53:29,573 --> 00:53:31,074
if we should be responding
to it differently

1311
00:53:31,074 --> 00:53:34,177
or should we assume
that it can turn into

1312
00:53:34,177 --> 00:53:36,613
a targeted malware?

1313
00:53:37,981 --> 00:53:40,350
- Well targeted malware
versus opportunistic malware,

1314
00:53:40,350 --> 00:53:43,420
you're defining that as like
just a random email comes in

1315
00:53:43,420 --> 00:53:45,655
versus someone who's
actually targeting it with,

1316
00:53:45,655 --> 00:53:47,891
okay, all right.

1317
00:53:47,891 --> 00:53:50,527
That's a hard question because
initially you may not know,

1318
00:53:51,394 --> 00:53:53,662
and that's where you end up,

1319
00:53:55,065 --> 00:53:57,267
you find that out as you're
doing the investigation

1320
00:53:57,267 --> 00:53:59,134
in the first place, that this
is actually a targeted attack

1321
00:53:59,135 --> 00:54:01,404
versus something random
that happened to us.

1322
00:54:01,404 --> 00:54:03,340
And that actually will
then be the gestation

1323
00:54:03,340 --> 00:54:05,342
in driving of what you know
about that current threat actor

1324
00:54:05,342 --> 00:54:06,710
and then you learn as you go.

1325
00:54:06,710 --> 00:54:09,512
Then you'll be able to
predictably do it in the future.

1326
00:54:09,512 --> 00:54:12,415
Initially you may not know
hey, is this just a random

1327
00:54:13,783 --> 00:54:16,752
person who just got spiked
with a silly email from Nigeria

1328
00:54:16,753 --> 00:54:19,456
or Russia, or I get
a lot ones USA on it,

1329
00:54:19,456 --> 00:54:21,258
it's like hey,
click on this link.

1330
00:54:21,258 --> 00:54:24,794
But if it's a targeted
email, a targeted spike,

1331
00:54:24,794 --> 00:54:28,298
then you're gonna start to
see a lot more indicators

1332
00:54:28,298 --> 00:54:30,299
that are saying this
is a specific target

1333
00:54:30,300 --> 00:54:32,736
for this individual,
and you're gonna be able

1334
00:54:32,736 --> 00:54:34,537
to trace that back
even through OSINT.

1335
00:54:34,537 --> 00:54:37,540
Be able to say okay, why did
this person get targeted?

1336
00:54:37,540 --> 00:54:38,975
What was public about him?

1337
00:54:38,975 --> 00:54:40,910
Did he go give a
presentation somewhere?

1338
00:54:40,910 --> 00:54:42,245
How did they know to hit him?

1339
00:54:42,245 --> 00:54:43,846
How did they get
his email address?

1340
00:54:43,847 --> 00:54:45,915
SANS is actually
developing an OSINT course

1341
00:54:45,915 --> 00:54:48,652
just to be able to do some
of these questions alone,

1342
00:54:48,652 --> 00:54:50,020
which would be quite exciting.

1343
00:54:50,020 --> 00:54:51,454
It's a hard question.

1344
00:54:51,454 --> 00:54:52,689
But the bottom line, threat
intelligence is again

1345
00:54:52,689 --> 00:54:53,957
gotta be able to
help answer that.

1346
00:54:53,957 --> 00:54:54,958
All right, thanks everyone.

1347
00:54:54,958 --> 00:54:56,126
(upbeat percussion music)

