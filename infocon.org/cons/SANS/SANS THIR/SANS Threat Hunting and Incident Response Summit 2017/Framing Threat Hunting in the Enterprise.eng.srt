1
00:00:00,600 --> 00:00:02,669
(ambient music)

2
00:00:06,773 --> 00:00:10,376
(audience clapping)

3
00:00:10,377 --> 00:00:11,611
- Good afternoon.

4
00:00:11,611 --> 00:00:12,679
So

5
00:00:12,679 --> 00:00:14,247
I am Joe Ten Eyck.

6
00:00:14,247 --> 00:00:15,081
I did

7
00:00:16,181 --> 00:00:18,817
15 years in the Army as a vet.

8
00:00:18,818 --> 00:00:20,053
Last eight years,

9
00:00:20,053 --> 00:00:21,721
I've been working in
information security,

10
00:00:21,721 --> 00:00:23,023
both red and blue,

11
00:00:23,023 --> 00:00:24,924
last two years at Target.

12
00:00:24,924 --> 00:00:27,894
So I started out at
Target as an attacker.

13
00:00:27,894 --> 00:00:28,828
About a year ago,

14
00:00:28,828 --> 00:00:32,098
I transitioned over to defense.

15
00:00:32,098 --> 00:00:34,400
As I did, my boss said to me,

16
00:00:34,401 --> 00:00:35,235
"Hey.

17
00:00:35,235 --> 00:00:36,870
"Your goal this year is

18
00:00:36,870 --> 00:00:39,906
"to significantly improve
our hunting program."

19
00:00:39,906 --> 00:00:40,740
All right.

20
00:00:42,208 --> 00:00:44,443
So I, because I'm a veteran,

21
00:00:44,444 --> 00:00:46,046
said, "Yes, sir,"

22
00:00:46,046 --> 00:00:47,247
and then I went back to my desk,

23
00:00:47,247 --> 00:00:48,715
and because I'm an IT guy,

24
00:00:48,715 --> 00:00:51,451
I hit Google and said,
what's threat hunting?

25
00:00:51,451 --> 00:00:54,120
(audience laughing)

26
00:00:54,120 --> 00:00:57,424
I hit exactly the problem
that Rob describes.

27
00:00:57,424 --> 00:01:01,728
There is a million
definitions of threat hunting.

28
00:01:01,728 --> 00:01:03,630
Everybody does it differently.

29
00:01:03,630 --> 00:01:06,232
None of them are
incredibly helpful

30
00:01:06,232 --> 00:01:07,534
and it's just people saying,

31
00:01:07,534 --> 00:01:10,236
"I do this, I do
this, I do this."

32
00:01:10,236 --> 00:01:12,505
So I backed up from the
problem a little bit.

33
00:01:12,505 --> 00:01:14,039
I said,

34
00:01:14,040 --> 00:01:16,443
"Okay, what does Target need
threat hunting need to be?"

35
00:01:16,443 --> 00:01:19,112
We had been hunting
at this point.

36
00:01:19,112 --> 00:01:20,613
At this point,

37
00:01:20,613 --> 00:01:22,148
we already have guys going
into a room every week.

38
00:01:22,148 --> 00:01:24,517
We have level one,
level two, level three.

39
00:01:24,517 --> 00:01:25,785
They're going into a room.

40
00:01:25,785 --> 00:01:26,886
They're working
together all week.

41
00:01:26,886 --> 00:01:28,088
They're hunting.

42
00:01:28,088 --> 00:01:30,589
We have a program that's
generating results.

43
00:01:30,590 --> 00:01:32,292
So it's not like I'm
taking a pile of crap

44
00:01:32,292 --> 00:01:33,226
and trying to make it better.

45
00:01:33,226 --> 00:01:34,727
I'm taking something that's good

46
00:01:34,727 --> 00:01:36,696
and trying to make it better.

47
00:01:36,696 --> 00:01:37,530
So I go,

48
00:01:38,932 --> 00:01:41,234
I started saying
what does Target

49
00:01:41,234 --> 00:01:43,103
need threat hunting to be?

50
00:01:43,103 --> 00:01:44,270
We have good detection.

51
00:01:44,270 --> 00:01:45,538
We have good IR.

52
00:01:45,538 --> 00:01:47,539
So I don't need it
to be those things.

53
00:01:47,540 --> 00:01:48,741
That leaves me with unknowns.

54
00:01:48,741 --> 00:01:51,111
I need to look for unknowns.

55
00:01:51,111 --> 00:01:52,078
We need it to be something that

56
00:01:52,078 --> 00:01:53,913
we can iterate through rapidly.

57
00:01:53,913 --> 00:01:55,747
We have a huge network.

58
00:01:55,748 --> 00:01:57,951
So being this thing, oh I
can hunt 10,000 machines,

59
00:01:57,951 --> 00:01:59,219
isn't enough.

60
00:01:59,219 --> 00:02:02,122
I have to be able to
hunt 200,000 machines.

61
00:02:02,122 --> 00:02:03,456
It's something that we need.

62
00:02:03,456 --> 00:02:05,358
Everybody needs threat hunting

63
00:02:05,358 --> 00:02:06,759
because it gives
us that back check

64
00:02:06,759 --> 00:02:09,262
if we miss it anywhere else.

65
00:02:09,262 --> 00:02:10,196
Ultimately,

66
00:02:11,564 --> 00:02:13,900
I came to the conclusion
that it needs to be big data.

67
00:02:13,900 --> 00:02:17,203
I need to look as
much data as I can

68
00:02:17,203 --> 00:02:20,607
and process that as
iteratively as I can.

69
00:02:22,609 --> 00:02:26,346
What it's not is
traditional IR or detection.

70
00:02:27,714 --> 00:02:29,115
So when you talk
about traditional IR,

71
00:02:29,115 --> 00:02:31,417
you're talking about something
that's artifact based.

72
00:02:31,417 --> 00:02:32,252
You take something.

73
00:02:32,252 --> 00:02:33,119
It fires to glass.

74
00:02:33,119 --> 00:02:33,953
You grab it.

75
00:02:33,953 --> 00:02:34,888
You look at it.

76
00:02:34,888 --> 00:02:36,022
You move back and forth in time.

77
00:02:36,022 --> 00:02:37,257
You say this is what happened.

78
00:02:37,257 --> 00:02:39,225
You tell a story.

79
00:02:39,225 --> 00:02:41,161
It's really good

80
00:02:41,161 --> 00:02:42,762
at being IR.

81
00:02:42,762 --> 00:02:44,197
It's not so good when you don't

82
00:02:44,197 --> 00:02:45,431
have that alert on the glass.

83
00:02:45,431 --> 00:02:47,667
It's not so good
with the unknown.

84
00:02:47,667 --> 00:02:50,937
I don't need it to be detection.

85
00:02:50,937 --> 00:02:52,939
Detection are good, ooh,

86
00:02:54,174 --> 00:02:57,510
detection, again,
is artifact based,

87
00:02:57,510 --> 00:02:59,946
but now we're
comparing artifacts

88
00:02:59,946 --> 00:03:02,949
against known values
or signatures.

89
00:03:02,949 --> 00:03:05,418
For the bad guy to beat that

90
00:03:05,418 --> 00:03:07,520
just takes a little
bit of change,

91
00:03:07,520 --> 00:03:09,656
and again, I'm
looking for unknowns.

92
00:03:09,656 --> 00:03:11,391
So it's neither of those.

93
00:03:11,391 --> 00:03:14,027
It's not to say either
one of those is wrong.

94
00:03:14,027 --> 00:03:16,161
They're both good and necessary

95
00:03:16,162 --> 00:03:17,997
and do what they're
intended to do,

96
00:03:17,997 --> 00:03:19,732
but you slap a
mustache on a deer,

97
00:03:19,732 --> 00:03:22,135
and suddenly they don't work.

98
00:03:23,570 --> 00:03:24,870
They can't find unknown.

99
00:03:24,871 --> 00:03:27,907
Definition-ally, they
can't find unknown.

100
00:03:27,907 --> 00:03:30,276
You need something else.

101
00:03:30,276 --> 00:03:31,911
Hunting is different.

102
00:03:31,911 --> 00:03:33,913
It's still artifacts.

103
00:03:33,913 --> 00:03:36,649
I still need a computer
to hunt against,

104
00:03:36,649 --> 00:03:41,054
but now I need 1,000
computers or I need NetFlow.

105
00:03:41,054 --> 00:03:44,657
I need to place those
artifacts in time or space.

106
00:03:44,657 --> 00:03:48,328
When I talk about time, I'm
talking about network traffic.

107
00:03:48,328 --> 00:03:51,698
How does it look on
average over time:

108
00:03:51,698 --> 00:03:52,999
what's different,
what's not different,

109
00:03:52,999 --> 00:03:55,268
what's expected,
what's unexpected,

110
00:03:55,268 --> 00:03:57,837
and space, I'm
talking about my host.

111
00:03:57,837 --> 00:03:59,304
I have X amount of processes.

112
00:03:59,305 --> 00:04:03,209
Why does this computer
only have this process?

113
00:04:03,209 --> 00:04:06,646
Nowhere else in my 100,000
machines does it exist,

114
00:04:06,646 --> 00:04:07,480
only here.

115
00:04:09,015 --> 00:04:11,718
We rely on the fact
that attackers have

116
00:04:11,718 --> 00:04:14,786
behaviors that are
different than users.

117
00:04:14,787 --> 00:04:16,555
Users act as if a certain
way 'cause they have

118
00:04:16,555 --> 00:04:19,091
objectives they have to
accomplish all day long.

119
00:04:19,091 --> 00:04:20,459
Attackers act a
different way because

120
00:04:20,459 --> 00:04:22,328
their objectives are different.

121
00:04:22,328 --> 00:04:26,498
So I wanna see where those
differ in time and space.

122
00:04:27,867 --> 00:04:29,669
So I went through all that

123
00:04:29,669 --> 00:04:32,671
and I came up with this
pretty mission statement.

124
00:04:32,672 --> 00:04:35,541
Hunt team activities will use
intelligence driven use cases

125
00:04:35,541 --> 00:04:37,410
to iteratively search
the enterprise forest

126
00:04:37,410 --> 00:04:38,845
for advanced indicators
of compromise

127
00:04:38,845 --> 00:04:42,382
missed by conventional
detection methods.

128
00:04:42,382 --> 00:04:45,018
Our goal is to terminate
ongoing malicious activity

129
00:04:45,018 --> 00:04:46,419
and produce actionable
intelligence

130
00:04:46,419 --> 00:04:48,820
to improve Target's
security postures.

131
00:04:48,821 --> 00:04:50,089
Use cases will be
generated using

132
00:04:50,089 --> 00:04:52,625
internal and open
source intelligence,

133
00:04:52,625 --> 00:04:55,828
situational awareness of the
state of the enterprise network

134
00:04:55,828 --> 00:04:57,830
and findings will be
utilized to create cases

135
00:04:57,830 --> 00:04:59,732
for isolation and investigation,

136
00:04:59,732 --> 00:05:04,137
close detection gaps, and
create actionable alerting,

137
00:05:04,137 --> 00:05:07,774
which is really
pretty and it gave me

138
00:05:07,774 --> 00:05:11,911
a what I was doing or
what we were doing,

139
00:05:11,911 --> 00:05:14,180
but it didn't really
give me a how.

140
00:05:14,180 --> 00:05:15,982
Nothing I've talked
about yet says,

141
00:05:15,982 --> 00:05:18,418
"You should do it like this."

142
00:05:21,721 --> 00:05:24,691
So the question now is how do
I take that mission statement

143
00:05:24,691 --> 00:05:27,659
and turn it into something
that I can give a level three,

144
00:05:27,660 --> 00:05:30,363
a level two, and a level
one each week, and say,

145
00:05:30,363 --> 00:05:35,101
"Do it this way and we'll get
better as an organization."

146
00:05:35,101 --> 00:05:36,769
The thought did occur to me that

147
00:05:36,769 --> 00:05:39,105
what we were basically doing was

148
00:05:39,105 --> 00:05:41,307
asking evidence-based questions,

149
00:05:41,307 --> 00:05:42,508
questions where we're
gonna take evidence

150
00:05:42,508 --> 00:05:44,977
and try to answer it that way.

151
00:05:44,977 --> 00:05:47,847
I came up with this
high-level process.

152
00:05:47,847 --> 00:05:50,849
Again, I'm an army guy, so
I like simple processes.

153
00:05:50,850 --> 00:05:54,654
We prepare, we find,
and we communicate,

154
00:05:54,654 --> 00:05:56,189
not quite in depth enough 'cause

155
00:05:56,189 --> 00:05:58,524
nothing tells you what
it's actually doing.

156
00:05:58,524 --> 00:06:00,993
So I broke it down a little bit.

157
00:06:00,993 --> 00:06:05,231
And we start, in our
preparation, we ask questions.

158
00:06:05,231 --> 00:06:06,466
We do research.

159
00:06:07,467 --> 00:06:09,801
We form a hypothesis.

160
00:06:09,802 --> 00:06:14,540
Once we have that hypothesis,
we develop experimentation.

161
00:06:14,540 --> 00:06:17,377
We test whether or not that
experimentation is working.

162
00:06:17,377 --> 00:06:18,845
We troubleshoot it.

163
00:06:18,845 --> 00:06:21,180
Is this looking familiar yet?

164
00:06:21,180 --> 00:06:22,548
After that,

165
00:06:22,548 --> 00:06:24,884
once we have it working,

166
00:06:24,884 --> 00:06:27,653
we analyze and draw
our conclusions:

167
00:06:27,653 --> 00:06:29,589
Is our hypothesis correct?

168
00:06:29,589 --> 00:06:31,657
Is it incorrect?

169
00:06:31,657 --> 00:06:34,026
Then we communicate all results,

170
00:06:34,026 --> 00:06:35,628
and I shoulda underlined all,

171
00:06:35,628 --> 00:06:38,197
communicate all results.

172
00:06:38,197 --> 00:06:40,700
And then I re-factor
it and we go back

173
00:06:40,700 --> 00:06:43,736
and we include it
in future hunts.

174
00:06:43,736 --> 00:06:47,340
So I was really
excited about this,

175
00:06:47,340 --> 00:06:49,609
until I realized I learned
it in the eighth grade

176
00:06:49,609 --> 00:06:51,144
'cause it's just the
scientific method.

177
00:06:51,144 --> 00:06:52,879
(chuckles)
(audience laughing)

178
00:06:52,879 --> 00:06:53,713
It is.

179
00:06:54,847 --> 00:06:58,650
So, I'm thinking,
"Yeah, this is good."

180
00:06:58,651 --> 00:07:01,120
It's somewhat of a relief.

181
00:07:01,120 --> 00:07:03,723
Because if you look
around this room,

182
00:07:03,723 --> 00:07:06,626
everything here till
suh-muh-sen-er-in method.

183
00:07:06,626 --> 00:07:09,828
Another was brau-kee-buh
the scientific method.

184
00:07:09,829 --> 00:07:12,565
The light bulbs, the
computers, all this stuff.

185
00:07:12,565 --> 00:07:17,469
What that means is that I have
a proven method for hunting.

186
00:07:17,470 --> 00:07:20,039
It gave us all this other stuff.

187
00:07:20,039 --> 00:07:21,640
I can trust it.

188
00:07:21,641 --> 00:07:25,445
If I follow it, it will
give me results hunting too,

189
00:07:25,445 --> 00:07:28,815
and it leaves me just to
communicate those results.

190
00:07:28,815 --> 00:07:33,419
Communication I think
is incredibly important.

191
00:07:33,419 --> 00:07:35,988
At Target, we break
it down three ways:

192
00:07:35,988 --> 00:07:38,691
we break it down into
the cases we generate,

193
00:07:38,691 --> 00:07:40,460
the detection gaps we find,

194
00:07:40,460 --> 00:07:43,962
and then the informational
request we have.

195
00:07:43,963 --> 00:07:46,132
Each one of those has very

196
00:07:47,033 --> 00:07:49,302
deliberate intentions behind it.

197
00:07:49,302 --> 00:07:51,804
Cases show us current state.

198
00:07:51,804 --> 00:07:55,808
What am I doing today
to improve Target?

199
00:07:55,808 --> 00:07:57,376
How did we help

200
00:07:57,376 --> 00:07:59,712
Target be more secure today?

201
00:08:00,646 --> 00:08:02,882
We found X infections.

202
00:08:02,882 --> 00:08:04,851
We found this data.

203
00:08:04,851 --> 00:08:06,352
It's really the
hunters time to say,

204
00:08:06,352 --> 00:08:07,385
"Look how cool I am.

205
00:08:07,386 --> 00:08:09,889
"I found all this cool stuff."

206
00:08:10,923 --> 00:08:12,825
Future state.

207
00:08:12,825 --> 00:08:16,529
Our incident response is
bigger, faster, stronger.

208
00:08:16,529 --> 00:08:18,364
We now know this.

209
00:08:18,364 --> 00:08:20,233
We now can find that.

210
00:08:20,233 --> 00:08:23,636
So in the future,
Target's more secure.

211
00:08:23,636 --> 00:08:27,473
The last one is building
the team, informational.

212
00:08:27,473 --> 00:08:28,975
Who did we talk to?

213
00:08:28,975 --> 00:08:30,776
What do we communicate?

214
00:08:30,776 --> 00:08:31,611
That way,

215
00:08:33,044 --> 00:08:35,914
maybe we can affect more
than just our security org

216
00:08:35,914 --> 00:08:37,250
by our hunting activities.

217
00:08:37,250 --> 00:08:38,851
We can bring 'em outside.

218
00:08:38,851 --> 00:08:42,255
Information's great 'cause I am

219
00:08:42,255 --> 00:08:44,757
pretty good at security,

220
00:08:44,757 --> 00:08:48,361
but maybe I'm not
so good at stocks.

221
00:08:48,361 --> 00:08:50,795
Maybe there's somebody
that knows more.

222
00:08:50,796 --> 00:08:52,765
Maybe there somebody
that knows for about how

223
00:08:52,765 --> 00:08:55,434
active directory is
configured in our environment.

224
00:08:55,434 --> 00:08:56,502
Maybe there someone that knows

225
00:08:56,502 --> 00:08:59,037
more about a whole lot of stuff

226
00:08:59,038 --> 00:09:01,807
that you just can't be
the expert in everything.

227
00:09:01,807 --> 00:09:03,809
So bring in those
outside sources

228
00:09:03,809 --> 00:09:05,877
and communicate
that so that we can

229
00:09:05,878 --> 00:09:09,982
make Target overall better,
not just at security.

230
00:09:11,651 --> 00:09:14,053
The practical
application of this,

231
00:09:14,053 --> 00:09:15,354
very early on,

232
00:09:15,354 --> 00:09:16,989
was about the time that

233
00:09:16,989 --> 00:09:20,059
David released this
threathunting.net.

234
00:09:20,059 --> 00:09:21,294
I'm sorry, David.

235
00:09:21,294 --> 00:09:22,093
I just realized
I left the T out.

236
00:09:22,094 --> 00:09:23,663
Threathunting.net

237
00:09:23,663 --> 00:09:25,398
(man speaking off microphone)

238
00:09:25,398 --> 00:09:27,033
(audience laughing)

239
00:09:27,033 --> 00:09:27,934
What is it?

240
00:09:27,934 --> 00:09:28,968
Did I get it wrong?

241
00:09:28,968 --> 00:09:30,303
- [David] No no, it's nothing.

242
00:09:30,303 --> 00:09:31,137
- Yeah.

243
00:09:34,674 --> 00:09:36,309
Right, he released these.

244
00:09:36,309 --> 00:09:37,242
I looked at them, and said,

245
00:09:37,243 --> 00:09:39,111
"Hey, these are brilliant.

246
00:09:39,111 --> 00:09:41,646
"I'm gonna take
him off his GitHub,

247
00:09:41,647 --> 00:09:42,949
"put him on our GitHub,

248
00:09:42,949 --> 00:09:44,784
"and we're gonna
start tracking him

249
00:09:44,784 --> 00:09:46,485
"within our organization."

250
00:09:46,485 --> 00:09:48,921
So we now use these playbooks
within our organization,

251
00:09:48,921 --> 00:09:50,923
not just what's on the website,

252
00:09:50,923 --> 00:09:52,725
but some that we
generate ourselves.

253
00:09:52,725 --> 00:09:54,360
We made a couple modifications.

254
00:09:54,360 --> 00:09:57,063
I don't wanna call out why
we're looking at these.

255
00:09:57,063 --> 00:10:00,600
But what they allow us to do
is track historical knowledge.

256
00:10:00,600 --> 00:10:03,369
They gave me an
easy to edit page

257
00:10:03,369 --> 00:10:05,071
that I can give to
the inset handler

258
00:10:05,071 --> 00:10:06,772
leading the hunt each week

259
00:10:06,772 --> 00:10:09,609
and say, "Tell me the key
things that you find."

260
00:10:09,609 --> 00:10:10,443
We have

261
00:10:11,677 --> 00:10:14,246
what data is required
to do that hunt.

262
00:10:14,246 --> 00:10:17,350
We have what problems we may

263
00:10:17,350 --> 00:10:19,885
come up against
getting that data.

264
00:10:19,885 --> 00:10:22,154
We have what analysis
techniques have

265
00:10:22,154 --> 00:10:24,724
been successful
and unsuccessful.

266
00:10:24,724 --> 00:10:26,359
We have a general description
so that someone can

267
00:10:26,359 --> 00:10:28,794
read it and understand
what we're hunting on

268
00:10:28,794 --> 00:10:30,529
and we have more info

269
00:10:31,998 --> 00:10:35,368
which is just links to
past documentations,

270
00:10:35,368 --> 00:10:36,902
to outside articles,

271
00:10:36,902 --> 00:10:40,706
to all the great stuff that
people are doing in the world.

272
00:10:40,706 --> 00:10:41,707
We have that

273
00:10:43,643 --> 00:10:47,079
field right above the
top that says HMLO.

274
00:10:48,280 --> 00:10:50,182
We'll talk more
about that later,

275
00:10:50,182 --> 00:10:52,618
but that's how we
track it internally

276
00:10:52,618 --> 00:10:56,489
to sort of make sure we're
always moving forward.

277
00:10:56,489 --> 00:11:00,059
That's done every week and
we do it under peer review,

278
00:11:00,059 --> 00:11:02,093
meaning I don't get to
decide how cool I am.

279
00:11:02,094 --> 00:11:05,031
Everybody else gets to
decide how cool I am.

280
00:11:05,031 --> 00:11:06,632
And then we have a
read on and a read off

281
00:11:06,632 --> 00:11:08,401
every week to communicate
all these things.

282
00:11:08,401 --> 00:11:09,635
So we read on.

283
00:11:09,635 --> 00:11:11,370
We say, "Well, what are
we doing this week?,"

284
00:11:11,370 --> 00:11:12,271
and when we read off, we say,

285
00:11:12,271 --> 00:11:13,439
"What did we do?

286
00:11:13,439 --> 00:11:14,540
"How did it work?

287
00:11:14,540 --> 00:11:16,141
"What didn't work?"

288
00:11:17,410 --> 00:11:19,211
Again, I'm just a
simple army guy.

289
00:11:19,211 --> 00:11:22,048
So I literally took an Army AAR

290
00:11:22,048 --> 00:11:23,949
and just put it on a
PowerPoint and said,

291
00:11:23,949 --> 00:11:26,385
"Let's do this every week."

292
00:11:26,385 --> 00:11:30,556
What works, what doesn't
work, how can we improve?

293
00:11:32,625 --> 00:11:34,126
Ultimately what we wanna
do is take all this

294
00:11:34,126 --> 00:11:36,395
and map it to the
attacker lifecycle.

295
00:11:36,395 --> 00:11:37,963
So we can say,

296
00:11:37,963 --> 00:11:39,699
"By using this hunt,

297
00:11:39,699 --> 00:11:42,501
"we can look for these types
of attacks in these areas,

298
00:11:42,501 --> 00:11:45,304
"and this is how
we break it down."

299
00:11:45,304 --> 00:11:47,006
But, again,

300
00:11:47,006 --> 00:11:49,208
I got through all
that, and said,

301
00:11:49,208 --> 00:11:51,711
"Crap, I still have a problem.

302
00:11:52,878 --> 00:11:54,346
"'Cause it's just the
scientific method.

303
00:11:54,346 --> 00:11:56,382
"I'm just applying it.

304
00:11:56,382 --> 00:11:58,217
"So did these two people."

305
00:11:58,217 --> 00:12:00,119
Einstein, that's what he did,

306
00:12:00,119 --> 00:12:02,321
but so did my high
school science teacher.

307
00:12:02,321 --> 00:12:04,256
So the problem is,

308
00:12:04,256 --> 00:12:06,459
how do I create Einstein,

309
00:12:06,459 --> 00:12:09,161
and not a bunch of crappy
high school science teachers?

310
00:12:09,161 --> 00:12:11,363
(audience laughing)

311
00:12:11,363 --> 00:12:13,532
It's exactly the problem

312
00:12:13,532 --> 00:12:16,402
that's the hardest to solve.

313
00:12:16,402 --> 00:12:19,405
'Cause I can put three
people in a room,

314
00:12:19,405 --> 00:12:20,573
but how do I make
sure that they're

315
00:12:20,573 --> 00:12:24,776
actually doing something
that's productive?

316
00:12:24,777 --> 00:12:26,212
So I'm thinking
about this problem

317
00:12:26,212 --> 00:12:27,480
and I'm pondering this problem.

318
00:12:27,480 --> 00:12:30,349
I was listening to
a podcast one day.

319
00:12:30,349 --> 00:12:33,085
It's the Stuff You
Should Know podcast,

320
00:12:33,085 --> 00:12:35,154
and they did an episode
on the scientific method.

321
00:12:35,154 --> 00:12:36,388
I said, "Ah, this is cool.

322
00:12:36,388 --> 00:12:39,191
"This is lucky timing for me."

323
00:12:39,191 --> 00:12:41,694
In there, they had
this quote that said,

324
00:12:41,694 --> 00:12:44,764
"The scientific process,
any scientific process,

325
00:12:44,764 --> 00:12:46,599
"relies on two legs:

326
00:12:46,599 --> 00:12:48,334
"It relies on

327
00:12:48,334 --> 00:12:49,568
"the quality of the data that

328
00:12:49,568 --> 00:12:51,569
"you're feeding into the process

329
00:12:51,570 --> 00:12:55,741
"and the quality of the analyst
who is analyzing that data."

330
00:12:59,478 --> 00:13:00,945
Cool.

331
00:13:00,946 --> 00:13:04,283
I get to rip off somebody else's
stuff yet again (chuckles).

332
00:13:04,283 --> 00:13:06,852
I took that and because, again,

333
00:13:06,852 --> 00:13:08,587
I'm a simple army guy,

334
00:13:08,587 --> 00:13:10,422
any army out there will
recognize I just built

335
00:13:10,422 --> 00:13:14,193
a risk matrix and called
it something else.

336
00:13:14,193 --> 00:13:15,627
It gives me two legs.

337
00:13:15,628 --> 00:13:16,529
It gives me

338
00:13:17,963 --> 00:13:22,201
a way to quantify how the
analyst are doing each week

339
00:13:22,201 --> 00:13:25,704
and a way to quantify how
the data is each week.

340
00:13:25,704 --> 00:13:27,705
I can cross-reference those

341
00:13:27,706 --> 00:13:31,210
and see how a given
hunt went each week.

342
00:13:31,210 --> 00:13:32,044
So

343
00:13:33,579 --> 00:13:37,348
I'm a fan of matrixes
because it's nonlinear.

344
00:13:38,517 --> 00:13:41,020
It's not you do
A, then B, then C.

345
00:13:41,020 --> 00:13:44,156
It accounts for a little
bit more variance.

346
00:13:44,156 --> 00:13:47,693
Multi variables are always
better than single variable,

347
00:13:47,693 --> 00:13:51,564
the data being what
are we looking at

348
00:13:51,564 --> 00:13:55,700
and then the analyst being
who and how are we looking.

349
00:13:55,701 --> 00:13:59,205
Those are both equally
important questions.

350
00:13:59,205 --> 00:14:00,039
I can give

351
00:14:03,742 --> 00:14:06,579
a less competent guy the
best data in the world

352
00:14:06,579 --> 00:14:08,479
and not get anything out of it,

353
00:14:08,480 --> 00:14:10,249
but I can give the
most competent guy

354
00:14:10,249 --> 00:14:13,619
crappy data and I'm still not
gonna get anything happening.

355
00:14:13,619 --> 00:14:18,190
So in order to get anything,
we need both of those to grow.

356
00:14:18,190 --> 00:14:20,192
Three stages each way.

357
00:14:20,192 --> 00:14:24,163
That's just to reflect the
growth in two dimensions.

358
00:14:24,163 --> 00:14:25,931
One's the growth of our people

359
00:14:25,931 --> 00:14:28,934
and one's the growth
of our technology.

360
00:14:28,934 --> 00:14:31,637
So the growth of
our people goes from

361
00:14:31,637 --> 00:14:33,705
uninformed to highly
knowledgeable.

362
00:14:33,706 --> 00:14:38,644
That guy that
can't differentiate
Base64 from shot one

363
00:14:38,644 --> 00:14:42,181
to a guy that just whips
up the Phython on the fly

364
00:14:42,181 --> 00:14:45,784
and knows it all to a
day even beyond them.

365
00:14:47,820 --> 00:14:51,991
The data is from standard
to very use-specific data.

366
00:14:53,525 --> 00:14:55,361
So the data stage one,

367
00:14:56,795 --> 00:14:59,164
we kind of think of it as
data that's just byproducts

368
00:14:59,164 --> 00:15:02,268
of things that already
exist in our environment.

369
00:15:02,268 --> 00:15:05,404
Like firewall data isn't
really useful to hunting,

370
00:15:05,404 --> 00:15:07,506
but it already exists
in our environment.

371
00:15:07,506 --> 00:15:08,807
So why not use it?

372
00:15:08,807 --> 00:15:10,576
It's functional data.

373
00:15:11,977 --> 00:15:13,946
Data stage two is
data that we collect

374
00:15:13,946 --> 00:15:16,115
for the sake of collecting data.

375
00:15:16,115 --> 00:15:19,718
It's stuff that
allows us to correlate

376
00:15:19,718 --> 00:15:21,487
between two sources.

377
00:15:21,487 --> 00:15:24,323
It allows us to start
doing those pivots.

378
00:15:24,323 --> 00:15:26,492
It's data for data's sake.

379
00:15:27,626 --> 00:15:30,629
This three data it's
data that's for hunting.

380
00:15:30,629 --> 00:15:33,499
It's the stuff that's generally
very expensive to collect.

381
00:15:33,499 --> 00:15:35,901
It's not very
useful for learning,

382
00:15:35,901 --> 00:15:39,238
but it gives us this
incredible ability

383
00:15:39,238 --> 00:15:40,940
to create big pictures of what's

384
00:15:40,940 --> 00:15:43,275
going on in our environment.

385
00:15:44,743 --> 00:15:48,514
The analyst, this kind
of mirrors the data.

386
00:15:48,514 --> 00:15:51,083
So the analyst when they
start out, stage one,

387
00:15:51,083 --> 00:15:54,019
is someone that's grabbing
scripts off of GitHub

388
00:15:54,019 --> 00:15:56,021
and just running those scripts.

389
00:15:56,021 --> 00:15:57,723
It's very entry-level.

390
00:15:57,723 --> 00:16:00,592
It's often will be tied
to vendor-based solutions.

391
00:16:00,592 --> 00:16:02,194
Somebody else puts it
in your lap and says,

392
00:16:02,194 --> 00:16:03,762
"Do this every week

393
00:16:03,762 --> 00:16:05,897
"and you'll find bad stuff."

394
00:16:05,898 --> 00:16:09,635
Analyst stage two
is research-based.

395
00:16:09,635 --> 00:16:10,736
What do we know?

396
00:16:10,736 --> 00:16:12,004
How do we identify it?

397
00:16:12,004 --> 00:16:14,139
What is it in my environment?

398
00:16:14,139 --> 00:16:16,375
So it's not that they're taking
somebody else's knowledge

399
00:16:16,375 --> 00:16:19,144
and just saying, "All right,
I trust it and I'll run it."

400
00:16:19,144 --> 00:16:21,347
They're actually building
their own knowledge.

401
00:16:21,347 --> 00:16:24,550
To get here, you need to start
investing in your analysts.

402
00:16:24,550 --> 00:16:26,218
So we talk about

403
00:16:26,218 --> 00:16:28,020
how we put three analysts,

404
00:16:28,020 --> 00:16:30,589
our most experienced, our
sort of middle ground,

405
00:16:30,589 --> 00:16:32,858
and our least experienced
guy in a room all week.

406
00:16:32,858 --> 00:16:34,226
Part of that is so that
we can start investing

407
00:16:34,226 --> 00:16:36,528
in that least
experienced guy, and say,

408
00:16:36,528 --> 00:16:38,797
"Hey, what do you
think of this problem?

409
00:16:38,797 --> 00:16:40,466
"What do you think
of this problem?

410
00:16:40,466 --> 00:16:42,167
"How do we solve 'em?,"

411
00:16:42,167 --> 00:16:43,969
and we work with that person.

412
00:16:43,969 --> 00:16:44,803
And

413
00:16:46,438 --> 00:16:47,271
arguably,

414
00:16:48,707 --> 00:16:51,477
it's better to take the time
to invest in that analyst

415
00:16:51,477 --> 00:16:54,146
then it is to take
the time to invest

416
00:16:54,146 --> 00:16:56,482
in rapid solutions
at this point.

417
00:16:56,482 --> 00:16:59,385
So I'm better off growing
a guy that's gonna

418
00:16:59,385 --> 00:17:01,319
be a rock star for
the next five years

419
00:17:01,320 --> 00:17:04,490
than I am knocking out a
couple cases this week.

420
00:17:04,490 --> 00:17:08,127
So take the time to
invest in these guys.

421
00:17:08,127 --> 00:17:10,495
This stage three
which has required

422
00:17:10,496 --> 00:17:12,998
this heavy investment
in the analyst,

423
00:17:12,998 --> 00:17:14,266
suddenly we're at
the point where

424
00:17:14,266 --> 00:17:16,335
we're doing
self-made automation.

425
00:17:16,335 --> 00:17:19,405
We're doing rapid iteration and

426
00:17:19,405 --> 00:17:21,973
it starts and ends
with automation,

427
00:17:21,973 --> 00:17:23,141
but where it comes from is

428
00:17:23,142 --> 00:17:25,978
a very important distinguish-er.

429
00:17:25,978 --> 00:17:28,447
So if I have a guy
that's doing it himself,

430
00:17:28,446 --> 00:17:31,883
then that means that automation
is custom for my environment

431
00:17:31,884 --> 00:17:33,185
that accounts for the variables

432
00:17:33,185 --> 00:17:35,788
and the problems that we
have in our environment

433
00:17:35,788 --> 00:17:37,923
and it allows us to very quickly

434
00:17:37,923 --> 00:17:40,025
run it through our environment

435
00:17:40,025 --> 00:17:42,628
to find the bad
that exists there,

436
00:17:42,628 --> 00:17:45,630
not what somebody
proved in the lab.

437
00:17:47,466 --> 00:17:48,801
So an example of this,

438
00:17:48,801 --> 00:17:51,570
we were hunting a
couple months ago,

439
00:17:51,570 --> 00:17:55,607
we were hunting
producer-consumer ratio
in our environment.

440
00:17:55,607 --> 00:17:59,878
So for each of these, we kinda
have some quick examples.

441
00:17:59,878 --> 00:18:00,678
So

442
00:18:01,747 --> 00:18:04,683
we were looking
basically at proxy logs

443
00:18:04,683 --> 00:18:07,019
'cause that's where you get
producer versus consumer.

444
00:18:07,019 --> 00:18:08,253
If you don't know what that is,

445
00:18:08,253 --> 00:18:10,155
it's how much my
computer takes in

446
00:18:10,155 --> 00:18:14,026
versus how much it puts
out at any given period.

447
00:18:14,026 --> 00:18:16,895
The first stage for
the data is just

448
00:18:16,895 --> 00:18:19,498
kinda looking at single events,

449
00:18:19,498 --> 00:18:21,800
bytes in versus bytes out.

450
00:18:21,800 --> 00:18:24,303
Oh, we had a really large
packet go out there,

451
00:18:24,303 --> 00:18:26,138
but there's no
sorta understanding

452
00:18:26,138 --> 00:18:28,639
of that in the context of time.

453
00:18:28,640 --> 00:18:30,976
Maybe that user always sends out

454
00:18:30,976 --> 00:18:32,811
large streams of data.

455
00:18:35,514 --> 00:18:38,050
Then we move that up and we
start examining it by groups.

456
00:18:38,050 --> 00:18:39,651
We group it by user.

457
00:18:39,651 --> 00:18:43,088
We can do bytes in versus bytes
out over a period of time.

458
00:18:43,088 --> 00:18:45,691
We look at maybe an
hour or 24 hours.

459
00:18:45,691 --> 00:18:48,827
Then we use sources like
virus total and Alexa

460
00:18:48,827 --> 00:18:51,697
to get rid of data
that we know is good.

461
00:18:51,697 --> 00:18:53,431
So maybe we eliminate

462
00:18:54,433 --> 00:18:56,301
size that we know are good,

463
00:18:56,301 --> 00:18:57,235
and hopefully we're not finding

464
00:18:57,236 --> 00:18:58,804
the sites that we know are bad,

465
00:18:58,804 --> 00:19:02,908
but we're just concentrating
that data to the unknowns.

466
00:19:04,276 --> 00:19:07,412
Then the final stage is we
weigh that data against itself.

467
00:19:07,412 --> 00:19:09,915
So what we did in
this particular case

468
00:19:09,915 --> 00:19:12,351
is we looked at each user and
we gained a 30-day average

469
00:19:12,351 --> 00:19:14,486
of their
producer-consumer ratio,

470
00:19:14,486 --> 00:19:16,054
and then we weighed
24-hour periods

471
00:19:16,054 --> 00:19:17,589
against that 30-day average

472
00:19:17,589 --> 00:19:20,091
to see how their
behavior changes when

473
00:19:20,092 --> 00:19:23,028
weighed against
their own behavior.

474
00:19:25,063 --> 00:19:26,298
So the analyst,

475
00:19:29,168 --> 00:19:30,968
stage one, we had to
work with what we have.

476
00:19:30,969 --> 00:19:33,805
We're just evaluating
individual connections.

477
00:19:33,805 --> 00:19:38,644
For stage two, it requires
that analyst to get in there,

478
00:19:38,644 --> 00:19:41,547
and understand what's really
contained in those data.

479
00:19:41,547 --> 00:19:43,148
What is it really
can telling us?

480
00:19:43,148 --> 00:19:47,386
How do we process larger
and larger data sets?

481
00:19:47,386 --> 00:19:48,754
For this stage three,

482
00:19:48,754 --> 00:19:50,889
what it requires is the analyst

483
00:19:50,889 --> 00:19:54,426
to develop a plan to look
at very large data sets.

484
00:19:54,426 --> 00:19:58,330
We're not talking
100,000 log entries.

485
00:19:58,330 --> 00:20:00,866
We're talking 100
million log entries.

486
00:20:00,866 --> 00:20:04,203
So how do you really
do large data sets?

487
00:20:06,305 --> 00:20:09,308
That's sorta how it works,

488
00:20:09,308 --> 00:20:10,709
not in theory, but in practice,

489
00:20:10,709 --> 00:20:13,812
how we move it up
on a specific hunt.

490
00:20:14,980 --> 00:20:17,382
That particular hunt
left us with this,

491
00:20:17,382 --> 00:20:18,884
which is just a heat map,

492
00:20:18,884 --> 00:20:22,754
which is one of my favorite
data visualization tools,

493
00:20:22,754 --> 00:20:26,625
even though David didn't
(chuckles) talk about it.

494
00:20:26,625 --> 00:20:30,329
But this, I eliminated the
indexes just for reasons,

495
00:20:30,329 --> 00:20:32,630
well, really, so I can zoom in,

496
00:20:32,631 --> 00:20:35,133
and I just did
horrible at zooming in.

497
00:20:35,133 --> 00:20:35,968
But along the left,

498
00:20:35,968 --> 00:20:37,603
you see our

499
00:20:37,603 --> 00:20:40,372
baseline column which gives us

500
00:20:40,372 --> 00:20:42,107
sort of the baseline
for every user,

501
00:20:42,107 --> 00:20:44,610
which is why it's
a consistent color.

502
00:20:44,610 --> 00:20:47,612
As colors get more
red, they're bad,

503
00:20:47,613 --> 00:20:50,015
more blue, they're good,

504
00:20:50,015 --> 00:20:52,184
or, that's not true.

505
00:20:52,184 --> 00:20:54,553
As it get more red,
they're more of a producer.

506
00:20:54,553 --> 00:20:56,722
More blue means
more of a consumer,

507
00:20:56,722 --> 00:20:59,324
and that's a shift
against their own average.

508
00:20:59,324 --> 00:21:03,395
So if you look at this, you
can see a couple red spots.

509
00:21:03,395 --> 00:21:04,229
It turns out,

510
00:21:04,229 --> 00:21:05,764
you need to filter out

511
00:21:05,764 --> 00:21:06,998
advertising sites that just send

512
00:21:06,999 --> 00:21:08,967
data to themselves all
(chuckles) day long.

513
00:21:08,967 --> 00:21:09,801
But,

514
00:21:10,969 --> 00:21:13,205
we took it, we moved
it, we moved it along,

515
00:21:13,205 --> 00:21:15,374
and then we could
take that information,

516
00:21:15,374 --> 00:21:16,308
we pivot around with it,

517
00:21:16,308 --> 00:21:18,644
and then we continue to grow.

518
00:21:21,113 --> 00:21:23,248
And then, just to reiterate,

519
00:21:23,248 --> 00:21:27,019
this is how we take
it week by week.

520
00:21:27,019 --> 00:21:29,888
We say, "All right,
analysis this week,

521
00:21:29,888 --> 00:21:31,723
"what stages does it have?

522
00:21:31,723 --> 00:21:34,526
"Our data this week,
what stages are that?"

523
00:21:34,526 --> 00:21:36,395
Then we use that

524
00:21:36,395 --> 00:21:37,763
combined score to say,

525
00:21:37,763 --> 00:21:41,500
"How's our hunt on this
topic doing overall?"

526
00:21:43,802 --> 00:21:45,904
And we take that, we say,

527
00:21:47,172 --> 00:21:49,608
at our hunt readout
each week, we say,

528
00:21:49,608 --> 00:21:51,543
"Here's where I
think my maturity is.

529
00:21:51,543 --> 00:21:53,044
"Here's what we
did that we think

530
00:21:53,045 --> 00:21:55,247
"justifies these
maturity scores,"

531
00:21:55,247 --> 00:21:56,481
and then we submit
it to our peers,

532
00:21:56,481 --> 00:21:58,684
and our peers
review it, and say,

533
00:21:58,684 --> 00:22:00,018
"Yeah, that looks good,"

534
00:22:00,018 --> 00:22:01,953
or, "No, it doesn't look good,"

535
00:22:01,953 --> 00:22:03,722
or, "Maybe you're being
too hard on yourself.

536
00:22:03,722 --> 00:22:05,357
"Maybe you're not really

537
00:22:05,357 --> 00:22:07,591
"understanding the
awesomeness that you did,"

538
00:22:07,592 --> 00:22:10,228
or, "Maybe we could do
it better next time."

539
00:22:10,228 --> 00:22:12,597
That's how we at Target

540
00:22:12,597 --> 00:22:17,168
take our program and sorta
encapsulate it in this model

541
00:22:17,169 --> 00:22:19,237
so that we can
continually be growing

542
00:22:19,237 --> 00:22:20,906
and continually be
driving it forward

543
00:22:20,906 --> 00:22:23,108
and everybody grows from it.

544
00:22:23,108 --> 00:22:24,209
(metallic screeching)
(resonant thudding)

545
00:22:24,209 --> 00:22:27,879
(upbeat instrumental music)

