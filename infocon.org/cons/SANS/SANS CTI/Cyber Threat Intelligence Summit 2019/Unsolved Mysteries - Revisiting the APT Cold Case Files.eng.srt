1
00:00:00,967 --> 00:00:03,737
(ethereal music)

2
00:00:10,477 --> 00:00:12,712
(applause)

3
00:00:14,748 --> 00:00:17,117
- Like Rick said, I
was here two years ago

4
00:00:17,117 --> 00:00:21,454
with Brian Bartholomew, my
partner in crime at the time,

5
00:00:21,454 --> 00:00:26,459
now solo, but hopefully next
time I can drag him out here

6
00:00:27,794 --> 00:00:29,329
'cause I've never seen
somebody get as uncomfortable

7
00:00:29,329 --> 00:00:31,398
with my slide-making
style as him,

8
00:00:31,398 --> 00:00:34,400
so he makes for a
very good partner.

9
00:00:34,401 --> 00:00:36,803
So my name is Juan
Guerrero-Saade,

10
00:00:36,803 --> 00:00:40,205
I'm now doing research
over at Chronicle,

11
00:00:40,206 --> 00:00:41,674
I hope that you'll
get to see a lot more

12
00:00:41,674 --> 00:00:43,410
of the work that we're doing,

13
00:00:43,410 --> 00:00:45,211
but in any case, I
wanted to have kind of

14
00:00:45,211 --> 00:00:46,846
a different kind of conversation

15
00:00:46,846 --> 00:00:48,480
maybe land a little
more practically,

16
00:00:48,481 --> 00:00:50,850
maybe give you guys
a bit of a guide

17
00:00:50,850 --> 00:00:53,720
of how some of the
more accessible

18
00:00:53,720 --> 00:00:55,922
advanced research can be done,

19
00:00:55,922 --> 00:00:58,525
but also do a bit of a call
to arms for researchers

20
00:00:58,525 --> 00:01:00,794
so I hope that that can be
interesting to all of you.

21
00:01:00,794 --> 00:01:03,763
So, like I said, let's talk
about research methodology,

22
00:01:05,799 --> 00:01:07,734
OK, I'm not gonna bore,
everybody in the room,

23
00:01:07,734 --> 00:01:10,970
I made Rick a promise
that despite the fact

24
00:01:10,970 --> 00:01:13,206
that I would be able to
talk about methodology

25
00:01:13,206 --> 00:01:14,741
and technical
abstraction all day,

26
00:01:14,741 --> 00:01:19,579
and pop out some 30, 40 page
paper that nobody wants to read

27
00:01:19,579 --> 00:01:21,848
I'm not gonna bore
all of you to sleep

28
00:01:21,848 --> 00:01:24,783
especially after
lunch, so instead,

29
00:01:24,784 --> 00:01:26,052
for those of you
looking to be bored,

30
00:01:26,052 --> 00:01:28,621
you can find the last
paper I wrote on this,

31
00:01:28,621 --> 00:01:30,789
apparently the
caps are important,

32
00:01:30,790 --> 00:01:33,393
so you really have to
scream the three cybers

33
00:01:33,393 --> 00:01:34,828
and then you can
find the paper there,

34
00:01:34,828 --> 00:01:37,730
but instead, let's
discuss the problem

35
00:01:37,730 --> 00:01:40,733
with APT research cycles which
is really what I wanna get to

36
00:01:42,235 --> 00:01:45,238
So research does a lot to
improve collective defense

37
00:01:45,238 --> 00:01:46,739
I think there's very good reason

38
00:01:46,739 --> 00:01:48,041
for having research
teams out there,

39
00:01:48,041 --> 00:01:49,175
there's very good
reasons for having

40
00:01:49,175 --> 00:01:50,610
research publications out there,

41
00:01:50,610 --> 00:01:55,448
it might not become immediately
accessible why it's good

42
00:01:56,683 --> 00:01:57,917
but in the end you
end up doing a lot

43
00:01:57,917 --> 00:01:59,319
to protect the
general ecosystem.

44
00:01:59,319 --> 00:02:01,488
The thing is, new
discoveries end up expanding

45
00:02:01,488 --> 00:02:04,791
the horizon of what we
consider possible or probable,

46
00:02:04,791 --> 00:02:06,226
and that's
particularly important

47
00:02:06,226 --> 00:02:08,794
when it comes to
having threat models

48
00:02:08,794 --> 00:02:11,798
that are responsive
to the actual threats
that are out there

49
00:02:11,798 --> 00:02:13,800
If we don't actually think
that something is possible

50
00:02:13,800 --> 00:02:15,168
or if we don't actually
think that something

51
00:02:15,168 --> 00:02:18,238
is being exploited
and used in the wild,

52
00:02:18,238 --> 00:02:19,672
we're a lot less
likely to think that

53
00:02:19,672 --> 00:02:21,774
that is in any way relevant
to our organization

54
00:02:21,774 --> 00:02:23,476
or enterprise, or concerns.

55
00:02:24,777 --> 00:02:28,180
The thing is, well
let me point this out,

56
00:02:28,181 --> 00:02:31,251
it also does a lot to point
out the right experts for you,

57
00:02:31,251 --> 00:02:32,919
Joe was just here on
stage, the truth is

58
00:02:32,919 --> 00:02:35,021
that if you have
an ICS intrusion,

59
00:02:35,021 --> 00:02:37,756
as much as I would
love to know about it,

60
00:02:37,757 --> 00:02:39,325
chances are Joe and Rob can do

61
00:02:39,325 --> 00:02:41,126
a lot more for you
in that moment.

62
00:02:41,127 --> 00:02:43,530
So of course, send
us some hashes

63
00:02:43,530 --> 00:02:45,932
but those guys know a lot better

64
00:02:45,932 --> 00:02:47,167
what to do with
your environment,

65
00:02:47,167 --> 00:02:49,002
so it's good to have
points of reference for,

66
00:02:49,002 --> 00:02:50,570
who are the people
that are interested

67
00:02:50,570 --> 00:02:53,006
in that kind of research, who
can competently deal with it.

68
00:02:53,006 --> 00:02:54,574
Chances are maybe
a lot of us can

69
00:02:54,574 --> 00:02:56,743
but some folks are
already involved in that.

70
00:02:56,743 --> 00:02:58,644
So it does a lot to
flag that for you.

71
00:02:59,779 --> 00:03:01,847
However, while
research discoveries

72
00:03:01,848 --> 00:03:04,884
do a lot for defining and
scoping or threat modeling,

73
00:03:06,352 --> 00:03:09,889
it's actually threat tracking
that fuels long-term defense.

74
00:03:09,889 --> 00:03:12,959
So what's the problem with that?

75
00:03:12,959 --> 00:03:15,628
The problem is
hit-and-run research,

76
00:03:15,628 --> 00:03:17,564
this is something that I've
been bitching about recently,

77
00:03:17,564 --> 00:03:20,333
you may have already heard
me bitch about this on stage,

78
00:03:20,333 --> 00:03:24,237
but essentially, the incentives
are kind of problematic

79
00:03:24,237 --> 00:03:28,575
when it comes to the type of
research that we're publishing,

80
00:03:28,575 --> 00:03:30,410
how we're publishing it,
when we're publishing

81
00:03:30,410 --> 00:03:35,415
and when we keep doing it, if
the research value is PR value

82
00:03:38,518 --> 00:03:40,687
then essentially
tracking something old,

83
00:03:40,687 --> 00:03:42,088
something that is
already known about,

84
00:03:42,088 --> 00:03:43,623
something that's
already been a story

85
00:03:43,623 --> 00:03:46,692
and had it's 15 minutes, it's
no longer worth anything.

86
00:03:46,693 --> 00:03:49,229
So there are some cases where

87
00:03:49,229 --> 00:03:50,930
very competent research was done

88
00:03:50,930 --> 00:03:53,499
and it burned the tooling
to such an extent that

89
00:03:53,499 --> 00:03:56,135
that actor just sort of dropped
off the face of the earth

90
00:03:56,135 --> 00:03:59,105
and there's no point, OK,
fine I'll give you that,

91
00:03:59,105 --> 00:04:00,974
but in most cases,
what ends up happening

92
00:04:00,974 --> 00:04:04,177
isn't that the actor becomes
less active after publication,

93
00:04:04,177 --> 00:04:07,079
it's just that all the
researchers have moved on.

94
00:04:07,080 --> 00:04:11,251
Said, OK, it's out there,
APT 10 got Kris McConkey,

95
00:04:11,251 --> 00:04:14,187
the handsome man that
was up here earlier,

96
00:04:14,187 --> 00:04:16,289
he did some great
work on Cloud Hopper

97
00:04:16,289 --> 00:04:21,127
that became the year of Cloud
Hopper 2016 if I'm correct,

98
00:04:21,127 --> 00:04:24,430
everybody published on Cloud
Hopper following PWCs lead

99
00:04:24,430 --> 00:04:25,898
and then it turns out everybody

100
00:04:25,898 --> 00:04:28,501
stops looking at Cloud
Hopper for at least a year

101
00:04:28,501 --> 00:04:31,270
or two years because
that story is burned.

102
00:04:31,271 --> 00:04:33,039
But that doesn't mean
that the enterprises

103
00:04:33,039 --> 00:04:35,241
that are concerned with
Cloud Hopper or APT 10

104
00:04:35,241 --> 00:04:36,943
have to be any less concerned.

105
00:04:38,544 --> 00:04:40,513
So to be fair, those
misaligned incentives

106
00:04:40,513 --> 00:04:42,681
don't apply to
everybody, the truth is

107
00:04:42,682 --> 00:04:46,252
that if you have six
figures that you can use

108
00:04:46,252 --> 00:04:48,921
to pay for private reporting
then you can always

109
00:04:48,921 --> 00:04:51,057
ask for a certain
amount of coverage,

110
00:04:51,057 --> 00:04:54,460
that said, if you
can't afford that,

111
00:04:54,460 --> 00:04:56,662
you're kind of on your
own and that's not,

112
00:04:56,663 --> 00:04:58,398
that doesn't really
sound right to me,

113
00:04:58,398 --> 00:05:01,934
that's not really how we should
go about some of this stuff.

114
00:05:01,934 --> 00:05:03,870
But it's not enough
to complain about it,

115
00:05:03,870 --> 00:05:06,172
so what's a better
approach that we can take

116
00:05:06,172 --> 00:05:07,307
for this sort of thing?

117
00:05:08,675 --> 00:05:10,276
I think that it's important
for us as researchers

118
00:05:10,276 --> 00:05:13,346
and for all of you as consumers

119
00:05:13,346 --> 00:05:15,848
to start demanding
the proliferation

120
00:05:15,848 --> 00:05:18,685
of the means for
sustained tracking.

121
00:05:19,819 --> 00:05:21,954
By that, I actually
mean that it's important

122
00:05:21,954 --> 00:05:24,991
to have the adequate tools,
to have the adequate methods

123
00:05:24,991 --> 00:05:26,592
which I think a lot
of the conversations

124
00:05:26,592 --> 00:05:28,394
up on this stage
today have focused on,

125
00:05:28,394 --> 00:05:29,896
having the right
kind of methodology

126
00:05:29,896 --> 00:05:32,498
to go about this
research, and I also think

127
00:05:32,498 --> 00:05:34,267
it's important to have
the right insights.

128
00:05:34,267 --> 00:05:37,437
And insights is kinda where
we're failing a lot right now,

129
00:05:37,437 --> 00:05:39,105
there's a lot of great
tooling out there,

130
00:05:39,105 --> 00:05:41,074
especially a lot of
things that people

131
00:05:41,074 --> 00:05:42,842
already have access to,
things like domain tools,

132
00:05:42,842 --> 00:05:44,477
Passive Total, Virus
Total, et cetera,

133
00:05:44,477 --> 00:05:47,145
that you can go
and get great data

134
00:05:47,146 --> 00:05:49,515
that is actually what
researchers are using

135
00:05:49,515 --> 00:05:52,852
to base themselves
off, most of the time

136
00:05:52,852 --> 00:05:55,121
as long as it's not their
proprietary data as well,

137
00:05:55,121 --> 00:05:56,756
but you don't necessarily
have the insights

138
00:05:56,756 --> 00:05:58,890
that connect the pieces
of that operation

139
00:05:58,891 --> 00:06:01,260
with their conclusion, the
pieces of that operation

140
00:06:01,260 --> 00:06:02,929
with each other,
how did you jump

141
00:06:02,929 --> 00:06:04,162
from this thing to the other,

142
00:06:04,163 --> 00:06:05,698
or how did you find
this other thing,

143
00:06:05,698 --> 00:06:09,335
how does that allow you to
track these people further

144
00:06:09,335 --> 00:06:11,404
even when their tooling
changes slightly.

145
00:06:12,572 --> 00:06:14,073
So that's some of
what's missing,

146
00:06:14,073 --> 00:06:15,842
that said, there's
a caveat in there

147
00:06:15,842 --> 00:06:17,409
which is you wanna publish this

148
00:06:17,410 --> 00:06:20,413
without disproportionately
benefiting the enemy

149
00:06:20,413 --> 00:06:22,915
which is something
that also happens.

150
00:06:22,915 --> 00:06:24,317
But we can talk about
that at the bar,

151
00:06:24,317 --> 00:06:26,052
I'm not gonna name
anybody or name and shame

152
00:06:26,052 --> 00:06:29,989
or anything of the sort, but
there is a complex calculus

153
00:06:29,989 --> 00:06:31,590
that has to happen in saying,

154
00:06:31,591 --> 00:06:34,894
it's better to provide
this to people to track

155
00:06:34,894 --> 00:06:37,530
versus, if I do this,
then the one piece

156
00:06:37,530 --> 00:06:39,698
we have to track this
actor will be changed

157
00:06:39,699 --> 00:06:41,334
and then we're all screwed.

158
00:06:42,535 --> 00:06:45,505
So there is a certain
need to provide access

159
00:06:45,505 --> 00:06:49,041
to expand the metadata queries,
for better tracking tools,

160
00:06:49,041 --> 00:06:51,010
and means of correlating
diverse signals,

161
00:06:51,010 --> 00:06:52,645
and I hope that as
the year goes by

162
00:06:52,645 --> 00:06:54,447
and a lot of tooling comes out,

163
00:06:54,447 --> 00:06:56,182
that we'll be able
to provide that,

164
00:06:56,182 --> 00:06:57,517
that others will be
able to provide that,

165
00:06:57,517 --> 00:06:59,018
you can go talk to
folks at the booth,

166
00:06:59,018 --> 00:07:01,154
I'm not here to sell anything.

167
00:07:01,154 --> 00:07:05,024
Instead, what I wanna do is
focus on motivating researchers

168
00:07:05,024 --> 00:07:07,360
to change their focus,
to get away from

169
00:07:07,360 --> 00:07:08,895
that notion of
hit-and-run research

170
00:07:08,895 --> 00:07:12,330
and a lot of the people that
can motivate that to happen

171
00:07:12,331 --> 00:07:14,267
are in this room and
are in this industry

172
00:07:14,267 --> 00:07:16,235
more on the consumer side.

173
00:07:16,235 --> 00:07:18,971
Right now, our main
consumer as researchers

174
00:07:18,971 --> 00:07:21,808
tends to be folks in PR,
it tends to be reporters,

175
00:07:21,808 --> 00:07:24,610
it's Kim Setter, and
Sanger and the rest of them

176
00:07:24,610 --> 00:07:26,979
and you want 'em to, for
their eyes to fly open

177
00:07:26,979 --> 00:07:28,448
when you say, oh
we found this thing

178
00:07:28,448 --> 00:07:30,416
so the only thing
worth writing about

179
00:07:30,416 --> 00:07:33,886
is something that's
gonna interest the media,

180
00:07:33,886 --> 00:07:35,321
and sadly what
interests the media

181
00:07:35,321 --> 00:07:37,824
isn't necessarily what's
gonna do anything for anybody

182
00:07:37,824 --> 00:07:40,660
that's actually supposed to
be defending an enterprise.

183
00:07:40,660 --> 00:07:43,763
I also want to kind of
lift some of the mystery

184
00:07:43,763 --> 00:07:45,765
around some of this
research in the hopes

185
00:07:45,765 --> 00:07:47,733
that some of you
will feel motivated

186
00:07:47,733 --> 00:07:50,102
to also take it on to
not feel as intimidated

187
00:07:50,102 --> 00:07:52,304
by some of the big boys,
not feel so intimidated

188
00:07:52,305 --> 00:07:53,773
by doing some of the research,

189
00:07:53,773 --> 00:07:57,643
and for that, I hope to get
into some of the granular bits,

190
00:07:57,643 --> 00:07:59,212
I can't really
get into all of it

191
00:07:59,212 --> 00:08:01,414
as it is, I have 120
slides for 30 minutes

192
00:08:01,414 --> 00:08:05,151
which is ridiculous,
but I just wanna,

193
00:08:05,151 --> 00:08:07,854
that's not a joke, I told
you, you're my mentor,

194
00:08:07,854 --> 00:08:11,224
you were supposed to sign
off on these slides Rick,

195
00:08:11,224 --> 00:08:12,859
(laughs)

196
00:08:12,859 --> 00:08:15,394
Fair enough, I didn't
send it to him,

197
00:08:15,394 --> 00:08:16,863
I had a feeling he
wouldn't like that.

198
00:08:16,863 --> 00:08:20,600
So part of the motivation
is the newest, latest,

199
00:08:20,600 --> 00:08:22,802
hottest, newsworthiest
thing shouldn't be

200
00:08:22,802 --> 00:08:25,571
the only research worth
chasing and it really isn't,

201
00:08:25,571 --> 00:08:28,774
not if we're trying
to collect a defense.

202
00:08:28,774 --> 00:08:30,309
I have to admit that I'm biased,

203
00:08:30,309 --> 00:08:34,013
I am actually a big fan of the
school of Cyber-Paleontology

204
00:08:34,013 --> 00:08:35,715
something that
Costin Raiu coined

205
00:08:35,715 --> 00:08:37,250
and that I've tried
to work on with him,

206
00:08:37,250 --> 00:08:41,087
we worked on Moonlight Maze
which was a 21 year old

207
00:08:41,087 --> 00:08:43,923
intrusion set, we like
going back all the time

208
00:08:43,923 --> 00:08:45,157
and looking at different things

209
00:08:45,157 --> 00:08:46,459
that Equation did
back in the day,

210
00:08:46,459 --> 00:08:49,094
that the different
parts of Flame, DuQu

211
00:08:49,095 --> 00:08:50,897
and all these different people
have done back in the day,

212
00:08:50,897 --> 00:08:52,532
it's always really fascinating,

213
00:08:52,532 --> 00:08:55,234
sometimes it's hard to
explain the value of it,

214
00:08:55,234 --> 00:08:56,636
but I think that
if we look at this

215
00:08:56,636 --> 00:08:59,305
as more of a history
of humankind's

216
00:08:59,305 --> 00:09:01,741
going into the fifth
domain, there's a reason

217
00:09:01,741 --> 00:09:03,141
why you wanna
document these things

218
00:09:03,142 --> 00:09:06,712
even if they're not immediately
apparent in their value.

219
00:09:06,712 --> 00:09:09,314
So it turns out that
no matter how hard

220
00:09:09,315 --> 00:09:12,618
our best and brightest
may try to cover something

221
00:09:12,618 --> 00:09:16,088
there's always more to be
discovered in hindsight,

222
00:09:16,088 --> 00:09:17,656
and that's really
important to understand,

223
00:09:17,657 --> 00:09:19,191
there's really
impressive research

224
00:09:19,191 --> 00:09:21,360
done by people far
smarter than I,

225
00:09:21,360 --> 00:09:24,497
but if you go back,
you can always find

226
00:09:24,497 --> 00:09:28,099
a little something more and
that's not just out of luck,

227
00:09:28,100 --> 00:09:31,370
you have to remember that
time is a fickle thing.

228
00:09:32,738 --> 00:09:35,174
It greatly benefits
attackers in the short-run,

229
00:09:35,174 --> 00:09:36,742
we don't know what we're
gonna get hit with,

230
00:09:36,742 --> 00:09:38,209
we don't know if
we're being targeted,

231
00:09:38,210 --> 00:09:41,581
we don't know what we're
being targeted with or when,

232
00:09:41,581 --> 00:09:44,617
but in the long-run, it
actually benefits researchers,

233
00:09:44,617 --> 00:09:45,785
you have to remember
that there is

234
00:09:45,785 --> 00:09:48,254
this sort of anthropic
process to it,

235
00:09:48,254 --> 00:09:50,890
I did probably steal
that saying from grugq

236
00:09:50,890 --> 00:09:53,526
and kind of bastardized
it a little bit,

237
00:09:53,526 --> 00:09:56,896
but think about it,
attackers can't go backwards

238
00:09:56,896 --> 00:09:59,131
and expunge whatever
signals and artifacts

239
00:09:59,131 --> 00:10:00,665
were collected in our telemetry,

240
00:10:00,666 --> 00:10:04,236
they can't go backwards
into AV collections

241
00:10:04,236 --> 00:10:05,972
and remove the malware
that was picked up,

242
00:10:05,972 --> 00:10:07,807
they can't go
backwards and remove

243
00:10:07,807 --> 00:10:09,241
whatever telemetry
was picked up,

244
00:10:09,241 --> 00:10:12,377
whether it's honeypots,
EDR, or whatever it is,

245
00:10:12,378 --> 00:10:14,914
that's stuck in some
collection somewhere.

246
00:10:14,914 --> 00:10:16,983
So while they may
have gotten away

247
00:10:16,983 --> 00:10:18,917
with an attack in
the very beginning,

248
00:10:18,918 --> 00:10:21,921
whatever happens
in the aftermath,

249
00:10:21,921 --> 00:10:24,457
once they've moved on,
that is sealed there

250
00:10:24,457 --> 00:10:27,860
like bones, fossils, somewhere

251
00:10:27,860 --> 00:10:30,696
and that's where we get to
do some of our best work.

252
00:10:30,696 --> 00:10:33,265
They also can't stop the
progress of technology

253
00:10:33,265 --> 00:10:35,635
which is particularly
important to our industry,

254
00:10:35,635 --> 00:10:38,137
they can't stop our
tooling, our sifting methods

255
00:10:38,137 --> 00:10:40,138
and the general
computing prowess

256
00:10:40,139 --> 00:10:42,575
that gets put into the
threat intel industry

257
00:10:42,575 --> 00:10:44,744
from drastically
improving over time.

258
00:10:44,744 --> 00:10:47,747
And I do mean drastically, I
think it's really hard for us

259
00:10:47,747 --> 00:10:49,582
to keep perspective
in threat intelligence

260
00:10:49,582 --> 00:10:52,351
because so much
happens so quickly

261
00:10:52,351 --> 00:10:55,721
and so much of it has kind
of gravitas and weight

262
00:10:55,721 --> 00:10:57,790
and we think that
this is so significant

263
00:10:57,790 --> 00:10:59,290
that it's been happening
for a long time,

264
00:10:59,291 --> 00:11:01,661
but the truth is that
the threat intel industry

265
00:11:01,661 --> 00:11:04,195
in the private sector has
only really been going on

266
00:11:04,196 --> 00:11:05,931
for something like eight years,

267
00:11:07,133 --> 00:11:09,635
kicked off by a lot of
the work on Stuxnet,

268
00:11:09,635 --> 00:11:12,304
a lot of the work in
Mandiant with APT 1

269
00:11:12,304 --> 00:11:15,641
Symantec and
Kaspersky with Stuxnet

270
00:11:15,641 --> 00:11:17,309
and a lot of interesting
things that happened

271
00:11:17,309 --> 00:11:19,512
only happened seven
or eight years ago

272
00:11:19,512 --> 00:11:21,914
and that's not a very
long time for an industry,

273
00:11:21,914 --> 00:11:23,348
especially an industry that's

274
00:11:23,349 --> 00:11:25,217
a sub-section of
computer-science.

275
00:11:26,318 --> 00:11:29,288
So I want you to think back,

276
00:11:29,288 --> 00:11:32,124
to something that I call the
embarrassment of riches period

277
00:11:32,124 --> 00:11:34,527
in APT research and I think that

278
00:11:34,527 --> 00:11:35,728
it's a particularly
important one

279
00:11:35,728 --> 00:11:38,363
because if we
remember the context,

280
00:11:38,364 --> 00:11:40,166
malware analysts
back in the day,

281
00:11:40,166 --> 00:11:41,934
our malware analysts
forefathers,

282
00:11:41,934 --> 00:11:44,603
all they cared
about was crimeware,

283
00:11:44,603 --> 00:11:47,339
and it's not because it was
the only interesting thing,

284
00:11:47,339 --> 00:11:49,141
but it's because it
was the only thing

285
00:11:49,141 --> 00:11:51,544
they thought was actually
happening at the time.

286
00:11:51,544 --> 00:11:55,548
Remember we talk about with
threat modeling, right?

287
00:11:55,548 --> 00:11:58,784
At the time we said,
it is very possible

288
00:11:58,784 --> 00:12:01,120
for somebody to
use malware to spy,

289
00:12:01,120 --> 00:12:03,289
but it is not an
actuality at this time,

290
00:12:03,289 --> 00:12:05,124
it really isn't happening,
we've yet to see

291
00:12:05,124 --> 00:12:07,593
governments go into this sector,

292
00:12:07,593 --> 00:12:11,930
so all we're focusing
on is bank intrusions

293
00:12:11,931 --> 00:12:15,267
and then came Stuxnet, right,
the bigshot across the ballot

294
00:12:15,267 --> 00:12:16,402
and everybody lost
their minds about

295
00:12:16,402 --> 00:12:18,437
what was happening with Stuxnet,

296
00:12:18,437 --> 00:12:22,074
but then came DuQu,
and then came Flame,

297
00:12:22,074 --> 00:12:24,810
and then came miniFlame,
and then came Gauss,

298
00:12:24,810 --> 00:12:27,345
and then, and then, and
then, and then, and then,

299
00:12:27,346 --> 00:12:29,348
and now it turns out that
we have a different APT

300
00:12:29,348 --> 00:12:31,950
every other week and
they're everywhere.

301
00:12:31,951 --> 00:12:35,654
And that's something that
we have to keep in mind,

302
00:12:35,654 --> 00:12:38,557
it's not that these
operations exploded

303
00:12:38,557 --> 00:12:41,127
and that more of them
started to happen,

304
00:12:41,127 --> 00:12:43,561
they were already
there, what changed

305
00:12:43,562 --> 00:12:45,798
is we became aware of something,

306
00:12:45,798 --> 00:12:47,767
we became aware of
the shape and form

307
00:12:47,767 --> 00:12:49,835
of something that had
already been happening,

308
00:12:49,835 --> 00:12:51,537
and then we proceeded
to hone our tooling

309
00:12:51,537 --> 00:12:54,039
and our concepts to
unearth its likeness.

310
00:12:54,039 --> 00:12:57,175
We essentially caught
the scent of this thing

311
00:12:57,176 --> 00:13:00,045
and started to chase it down
and find more and more of it

312
00:13:00,045 --> 00:13:02,314
that had been happening
for five, six, 10 years,

313
00:13:02,314 --> 00:13:04,250
already inside of
our collections,

314
00:13:04,250 --> 00:13:05,751
already inside of our telemetry,

315
00:13:05,751 --> 00:13:09,054
we just didn't know what we
were looking for at the time.

316
00:13:09,054 --> 00:13:11,290
So keep that in mind
and keep in mind

317
00:13:11,290 --> 00:13:13,092
the context of
what was happening

318
00:13:15,094 --> 00:13:16,829
in technology at the
time, what was happening

319
00:13:16,829 --> 00:13:19,198
in tooling at the time,
they didn't have YARA

320
00:13:19,198 --> 00:13:21,000
which is, how many
of you are using YARA

321
00:13:21,000 --> 00:13:22,601
right now just to track malware?

322
00:13:24,937 --> 00:13:28,407
They didn't have YARA,
essentially there are no

323
00:13:28,407 --> 00:13:31,210
public YARA rules for
Stuxnet, Flame, miniFlame,

324
00:13:31,210 --> 00:13:32,611
Gauss, DuQu, any of that stuff

325
00:13:32,611 --> 00:13:34,413
because nobody was
writing them at the time.

326
00:13:34,413 --> 00:13:36,315
There were no retro-hunts,
we weren't going into

327
00:13:36,315 --> 00:13:37,716
Virus Total and
essentially saying,

328
00:13:37,716 --> 00:13:39,218
hey, search this
repository for me

329
00:13:39,218 --> 00:13:41,687
for X amounts of
time with this rule,

330
00:13:41,687 --> 00:13:44,957
there was no cloud processing
of petabytes of metadata,

331
00:13:44,957 --> 00:13:47,326
nobody was going and saying,
you know you didn't have access

332
00:13:47,326 --> 00:13:49,595
to these thousands of servers
that we're gonna be able

333
00:13:49,595 --> 00:13:51,497
to sift through
information for you.

334
00:13:51,497 --> 00:13:53,399
It was essentially
just the AVs using

335
00:13:53,399 --> 00:13:55,868
decades-old technology that
they'd clumped together

336
00:13:55,868 --> 00:13:58,470
into these franken-monsters
on your endpoint

337
00:13:58,470 --> 00:14:02,641
and still managing to
do cutting-edge research

338
00:14:02,641 --> 00:14:05,578
and tussling with these
beasts in different ways

339
00:14:05,578 --> 00:14:09,081
and that came out with this
amazing research that we found.

340
00:14:10,950 --> 00:14:12,985
That said, I think
that with all the stuff

341
00:14:12,985 --> 00:14:15,421
that we have now, with all the
perspective that we have now,

342
00:14:15,421 --> 00:14:17,356
with all of the understanding
of other operations

343
00:14:17,356 --> 00:14:19,191
that we have now, with
all the capabilities

344
00:14:19,191 --> 00:14:21,961
that we can use from our
very own personal computers

345
00:14:21,961 --> 00:14:23,729
at this time and all of
the information sharing

346
00:14:23,729 --> 00:14:26,198
that is happening, we can
actually get better results

347
00:14:26,198 --> 00:14:29,235
when it comes to even the
exact same pieces of research.

348
00:14:29,235 --> 00:14:30,803
It's just a matter of
having the motivation

349
00:14:30,803 --> 00:14:32,771
to go back in a lot of ways.

350
00:14:32,771 --> 00:14:34,973
So instead of chasing
the hottest, newest,

351
00:14:34,974 --> 00:14:38,944
most newsworthiest bullshit
that you can get your hands on,

352
00:14:38,944 --> 00:14:42,747
whatever latest run
of Cobalt Strike

353
00:14:42,748 --> 00:14:45,417
being used for
financial whatever,

354
00:14:46,719 --> 00:14:48,821
let's instead take that
cutting-edge tooling

355
00:14:48,821 --> 00:14:50,789
and revisit some of
the old mysteries.

356
00:14:52,725 --> 00:14:55,327
And the truth is that there
are unanswered questions

357
00:14:55,327 --> 00:14:56,795
when it comes to all this stuff

358
00:14:56,795 --> 00:14:58,897
and if you read really closely,
like Katie was talking about

359
00:14:58,898 --> 00:15:00,432
like processing
through old reports

360
00:15:00,432 --> 00:15:02,234
and taking it for
the attack framework

361
00:15:02,234 --> 00:15:04,003
and it takes a lot of
time just to be able to

362
00:15:04,003 --> 00:15:07,172
do that kind of granular
understanding of a report,

363
00:15:07,172 --> 00:15:09,375
but if you get familiar
with how researchers

364
00:15:09,375 --> 00:15:12,878
are writing these reports,
you'll actually start to notice

365
00:15:12,878 --> 00:15:14,847
when they're skirting
around open questions

366
00:15:14,847 --> 00:15:16,348
that they don't wanna answer,

367
00:15:16,348 --> 00:15:17,849
and it's not that, sometimes
they don't wanna answer it

368
00:15:17,850 --> 00:15:20,052
'cause it's political stuff
that you don't wanna talk about,

369
00:15:20,052 --> 00:15:21,520
but sometimes you
just don't wanna admit

370
00:15:21,520 --> 00:15:23,889
that you don't know the answer.

371
00:15:23,889 --> 00:15:28,160
I don't know, it's really,
it's fairly unacceptable

372
00:15:28,160 --> 00:15:29,762
in a publication these
days to just say,

373
00:15:29,762 --> 00:15:33,165
I have no idea why they
did this, this way,

374
00:15:33,165 --> 00:15:34,500
but a lot of times we don't know

375
00:15:34,500 --> 00:15:35,901
and those are
unanswered questions

376
00:15:35,901 --> 00:15:37,969
that I wish were
documented more clearly.

377
00:15:37,970 --> 00:15:39,305
There are many
unanswered questions

378
00:15:39,305 --> 00:15:40,973
when it comes to a lot
of different operations

379
00:15:40,973 --> 00:15:42,641
and those are exactly
the points at which

380
00:15:42,641 --> 00:15:44,443
we should go back a year later,

381
00:15:44,443 --> 00:15:46,812
six months, a year, two
years later and say,

382
00:15:46,812 --> 00:15:48,314
you know what, with
this new telemetry,

383
00:15:48,314 --> 00:15:49,848
with this new capability
let's figure out

384
00:15:49,848 --> 00:15:51,449
what the hell is going on there.

385
00:15:52,651 --> 00:15:53,986
So I also promised
Rick that I would

386
00:15:53,986 --> 00:15:55,920
not overwhelm the
crowd with examples,

387
00:15:55,921 --> 00:15:58,090
I think being a
pit-master, he told me

388
00:15:58,090 --> 00:16:00,859
that there was too much
meat in our last talk

389
00:16:00,859 --> 00:16:04,830
so this is more of
a salad if you will.

390
00:16:07,866 --> 00:16:10,536
It's just one slab of
meat, and we're gonna focus

391
00:16:10,536 --> 00:16:13,604
on one, hopefully good example.

392
00:16:13,605 --> 00:16:16,041
And part of that is, I wanna
take a little more time

393
00:16:16,041 --> 00:16:17,977
to illustrate some of the
process that went into it,

394
00:16:17,977 --> 00:16:19,545
not all of it, but
some of the process

395
00:16:19,545 --> 00:16:21,479
so that hopefully we can
get some of the folks

396
00:16:21,480 --> 00:16:23,082
that are feeling shy
about approaching

397
00:16:23,082 --> 00:16:24,683
some of the more
complex operations

398
00:16:24,683 --> 00:16:26,919
to feel like they can
definitely take them on

399
00:16:26,919 --> 00:16:29,420
or take on pieces of
it, so let's lift up

400
00:16:29,421 --> 00:16:32,291
some of the mysterious
fog from some of it.

401
00:16:32,291 --> 00:16:35,661
So being in D.C., is anybody
familiar with the Lamberts,

402
00:16:35,661 --> 00:16:40,665
there we go, I see, thank you,
I got a friend in the crowd,

403
00:16:42,101 --> 00:16:43,969
so the Lamberts for those
of you that don't know,

404
00:16:43,969 --> 00:16:45,471
this is kind of
what it looked like

405
00:16:45,471 --> 00:16:47,339
when we first published
something publicly
on the Lamberts,

406
00:16:47,339 --> 00:16:51,110
Lamberts has been something
that I worked on for years

407
00:16:51,110 --> 00:16:55,748
and it takes a very long time
to get on top of the iceberg

408
00:16:55,748 --> 00:16:59,318
that is the Lamberts
toolkit, 'cause in reality

409
00:16:59,318 --> 00:17:00,886
what we're talking
about is about

410
00:17:03,222 --> 00:17:06,458
probably a dozen different
custom modular frameworks

411
00:17:06,458 --> 00:17:08,327
worth the malware,
all of them advanced,

412
00:17:08,327 --> 00:17:12,097
all of them very well-made,
very carefully distributed,

413
00:17:12,097 --> 00:17:14,800
it is a very difficult
APT to track,

414
00:17:14,800 --> 00:17:17,403
I would say it's one of the
most difficult APTs to track,

415
00:17:17,403 --> 00:17:19,505
not the most, but
definitely up there.

416
00:17:21,807 --> 00:17:24,175
Part of it, and this
is where the sort of

417
00:17:24,175 --> 00:17:26,979
big unknowns come in,
the known unknowns.

418
00:17:28,747 --> 00:17:29,882
For the most part, we don't know

419
00:17:29,882 --> 00:17:31,350
what their infection
vectors are,

420
00:17:31,350 --> 00:17:33,118
which for something
that has been active

421
00:17:33,118 --> 00:17:35,287
for something like 10
years, that's a very

422
00:17:35,287 --> 00:17:37,990
daunting thing to think of,
we don't know a whole lot

423
00:17:37,990 --> 00:17:39,458
of their infection
vectors, we've identified

424
00:17:39,458 --> 00:17:41,160
maybe two or three
out of all the malware

425
00:17:41,160 --> 00:17:42,895
anybody's ever seen
for these guys,

426
00:17:42,895 --> 00:17:44,696
we also had very
little understanding

427
00:17:44,696 --> 00:17:47,800
of how they orchestrate
victim box operations,

428
00:17:47,800 --> 00:17:49,668
which is to say, what happens

429
00:17:49,668 --> 00:17:51,035
once they're already
on your network?

430
00:17:51,036 --> 00:17:54,540
Sure, we see this really
complex, sophisticated

431
00:17:54,540 --> 00:17:56,207
piece of malware that's there,

432
00:17:56,208 --> 00:18:00,512
but how, is it operated
once it's in there?

433
00:18:00,512 --> 00:18:03,381
A lot of them don't have
C and C communications

434
00:18:03,382 --> 00:18:06,218
so how are they patching
them, fixing them,

435
00:18:06,218 --> 00:18:09,421
updating them,
moving them around,

436
00:18:09,421 --> 00:18:11,657
deleting them when they need to?

437
00:18:11,657 --> 00:18:13,958
It leaves these very big
open questions, right,

438
00:18:13,959 --> 00:18:16,728
so those are two that
we're gonna try to address

439
00:18:16,728 --> 00:18:20,132
in a sort of simple,
quick manner, right?

440
00:18:20,132 --> 00:18:21,867
So how do these implants
get on the victim boxes

441
00:18:21,867 --> 00:18:22,835
in the first place?

442
00:18:24,136 --> 00:18:25,803
And how are the
artifacts orchestrated,

443
00:18:25,804 --> 00:18:27,439
patched, updated,
and controlled?

444
00:18:28,640 --> 00:18:31,743
So a brief rundown of
two Lambert frameworks

445
00:18:31,743 --> 00:18:33,779
just so that you know what
we're gonna be working with,

446
00:18:33,779 --> 00:18:36,348
there are a lot more, a lot
of them are privately reported

447
00:18:36,348 --> 00:18:38,984
so you might not find as much
reporting on them right away

448
00:18:38,984 --> 00:18:40,785
but you can at least find
a couple of blog posts

449
00:18:40,786 --> 00:18:43,489
under the Lamberts
toolkit or Longhorn

450
00:18:43,489 --> 00:18:44,790
which is what
Symantec called them

451
00:18:44,790 --> 00:18:47,793
when one of the
relevant leaks came out.

452
00:18:48,994 --> 00:18:50,795
So the first one is BlackLambert

453
00:18:50,796 --> 00:18:52,197
'cause this is actually
the first Lambert

454
00:18:52,197 --> 00:18:54,265
that was ever discovered,
credit to FireEye

455
00:18:54,266 --> 00:18:57,469
for finding the first one,
they reported the zero day

456
00:18:57,469 --> 00:18:59,505
but never reported the payload,

457
00:18:59,505 --> 00:19:02,941
so they actually found
the very first Lambert

458
00:19:02,941 --> 00:19:04,209
and what's interesting about it,

459
00:19:04,209 --> 00:19:06,712
is this is one of the
two infection vectors

460
00:19:06,712 --> 00:19:08,647
that we ever discovered which is

461
00:19:08,647 --> 00:19:11,884
an ODTFF zero day
exploit which is to say

462
00:19:11,884 --> 00:19:14,019
a font parsing vulnerability.

463
00:19:14,019 --> 00:19:15,754
Those are fascinating
because it means

464
00:19:15,754 --> 00:19:18,490
that something in the
kernel isn't processing

465
00:19:18,490 --> 00:19:22,060
the fonts correctly so
you just open a PDF,

466
00:19:22,060 --> 00:19:24,229
you open a Word file,
you open whatever it is

467
00:19:24,229 --> 00:19:27,099
and it's straight to kernel
or arbitrary execution,

468
00:19:27,099 --> 00:19:28,833
it's fascinating
that they can do that

469
00:19:28,834 --> 00:19:31,036
and these exploits
are particularly rare

470
00:19:31,036 --> 00:19:33,739
to the point where before that,

471
00:19:33,739 --> 00:19:36,808
that style of exploit had
only been seen with DuQu

472
00:19:36,808 --> 00:19:38,844
so when they first
discovered this,

473
00:19:38,844 --> 00:19:40,946
people thought that it was
another DuQu and it wasn't,

474
00:19:40,946 --> 00:19:43,581
it was in fact the very
first Lambert that we saw,

475
00:19:43,582 --> 00:19:45,751
it was a modular framework
designed for espionage

476
00:19:45,751 --> 00:19:47,653
and the payload was
entirely in memory,

477
00:19:47,653 --> 00:19:49,421
so it was particularly
hard to catch,

478
00:19:49,421 --> 00:19:50,722
it also had all
these funny quirks

479
00:19:50,722 --> 00:19:54,026
like it was hard-coded
for a server

480
00:19:54,026 --> 00:19:56,528
within the perimeter
of the intended victims

481
00:19:56,528 --> 00:19:58,830
so they were doing all kinds
of sophisticated movement

482
00:19:58,830 --> 00:20:02,701
inside of that environment,
fun stories around it

483
00:20:02,701 --> 00:20:04,503
but that's not a
story for today.

484
00:20:04,503 --> 00:20:07,406
Another framework that we're
gonna look at is WhiteLambert,

485
00:20:07,406 --> 00:20:10,309
this gives us our
other question right,

486
00:20:10,309 --> 00:20:13,145
so WhiteLambert is a
kernel-mode passive implant,

487
00:20:13,145 --> 00:20:15,480
that's to say that it
is not beaconing out,

488
00:20:15,480 --> 00:20:19,218
it is not giving you any
signals that it is there

489
00:20:19,218 --> 00:20:20,919
and those are particularly
fascinating right,

490
00:20:20,919 --> 00:20:23,188
like if you hone in on
beaconing within your logs

491
00:20:23,188 --> 00:20:25,557
then you go, oh well I'm
gonna know any malware

492
00:20:25,557 --> 00:20:27,292
that's there 'cause why
is this thing calling out

493
00:20:27,292 --> 00:20:29,761
every five minutes from
somewhere that it shouldn't?

494
00:20:29,761 --> 00:20:31,296
Well in this particular case,

495
00:20:31,296 --> 00:20:33,131
it's not gonna call out to
anything, it's gonna wait

496
00:20:33,131 --> 00:20:35,567
for the right thing to
come along and trigger it.

497
00:20:36,768 --> 00:20:38,237
The whole point of
WhiteLambert is that

498
00:20:38,237 --> 00:20:40,739
it's this kernel-mode implant
that's supposed to help

499
00:20:40,739 --> 00:20:43,542
orchestrate a series
of infections.

500
00:20:43,542 --> 00:20:45,209
And that's quite
fascinating, you say,

501
00:20:45,210 --> 00:20:47,446
well they're only gonna
connect to one machine,

502
00:20:47,446 --> 00:20:50,349
that one machine is gonna
send a signal to one place

503
00:20:50,349 --> 00:20:52,317
and that one place
is gonna orchestrate

504
00:20:52,317 --> 00:20:56,088
20, 30, 300 infections
on a network

505
00:20:56,088 --> 00:20:58,223
and they're gonna have
this sort of uni-cast,

506
00:20:58,223 --> 00:21:00,459
multi-cast system to
manage themselves around.

507
00:21:02,027 --> 00:21:05,497
Nobody knows what the delivery
mechanism is for WhiteLambert

508
00:21:05,497 --> 00:21:07,466
and it was later on
replaced by GrayLambert

509
00:21:07,466 --> 00:21:11,102
which is user land because
64-bit code signing

510
00:21:11,103 --> 00:21:12,904
made it quite
complicated to have

511
00:21:12,904 --> 00:21:14,706
these sort of
kernel-mode components

512
00:21:14,706 --> 00:21:19,043
after, I wanna say,
Vista or Windows7,

513
00:21:19,044 --> 00:21:20,479
somebody can correct me on when

514
00:21:20,479 --> 00:21:22,914
64-bit code signing in
Windows was introduced.

515
00:21:23,949 --> 00:21:26,018
So keep that in mind, right?

516
00:21:26,018 --> 00:21:28,287
I got bored on a Friday
night and I don't really like

517
00:21:28,287 --> 00:21:31,390
stepping out or seeing light
or people, human beings,

518
00:21:31,390 --> 00:21:34,259
interacting or anything,
I'd rather just track

519
00:21:34,259 --> 00:21:36,695
some of my favorite threat
actors at that time,

520
00:21:36,695 --> 00:21:38,196
so I was like, well,
let's go look at

521
00:21:38,196 --> 00:21:40,165
some of these old
samples, right?

522
00:21:40,165 --> 00:21:43,268
So I put up some of these
WhiteLambert samples

523
00:21:43,268 --> 00:21:45,337
on a new system that at the time

524
00:21:45,337 --> 00:21:47,973
was experimental for us,
it's now been proliferated

525
00:21:47,973 --> 00:21:49,474
to a lot of people
at Virus Total,

526
00:21:49,474 --> 00:21:50,809
you can go and play with graph

527
00:21:50,809 --> 00:21:52,444
and play with some
new similarity engines

528
00:21:52,444 --> 00:21:54,546
and I hope that if you
haven't done it already,

529
00:21:54,546 --> 00:21:58,450
go bug the dudes at the
booth, and sound important

530
00:21:58,450 --> 00:22:00,152
and say that you need
access to everything,

531
00:22:00,152 --> 00:22:02,821
hopefully that'll
work, I don't know.

532
00:22:02,821 --> 00:22:04,289
So I stumbled upon
something odd,

533
00:22:04,289 --> 00:22:06,491
I put in some of these
old samples we knew about

534
00:22:06,491 --> 00:22:08,860
and the similarity engine
immediately spit up

535
00:22:08,860 --> 00:22:11,530
two other samples that
were entirely undetected,

536
00:22:11,530 --> 00:22:15,867
so right there, simplest,
cheapest, pay-dirt ever,

537
00:22:15,867 --> 00:22:18,337
I did nothing, I put in a hash,

538
00:22:18,337 --> 00:22:21,807
I double-clicked on a thing,
and all this machinery,

539
00:22:21,807 --> 00:22:24,876
expensive machinery told me,
hey, there's two other samples,

540
00:22:24,876 --> 00:22:26,178
and what was
interesting about them,

541
00:22:26,178 --> 00:22:29,014
it's not that there
are more samples,

542
00:22:29,014 --> 00:22:31,750
it's that they were fully
undetected by the AVs

543
00:22:31,750 --> 00:22:34,052
which means that those
generic detections aren't,

544
00:22:34,052 --> 00:22:36,053
there's a similarity
engine that's telling you

545
00:22:36,054 --> 00:22:38,890
that they're similar enough,
but the generic AV detections

546
00:22:38,890 --> 00:22:40,559
aren't picking it up so
this is the kind of thing

547
00:22:40,559 --> 00:22:42,494
where you go,
let's take a minute

548
00:22:42,494 --> 00:22:45,363
and figure out what the hell
is happening in there, right?

549
00:22:45,364 --> 00:22:48,300
So one of these samples,
one of the new samples

550
00:22:48,300 --> 00:22:49,601
was particularly interesting,

551
00:22:49,601 --> 00:22:53,505
was actually the parent,
the compress parent

552
00:22:53,505 --> 00:22:56,742
of where that sample came
from was a RAR archive

553
00:22:56,742 --> 00:22:58,677
that I've now figured
out was actually

554
00:22:58,677 --> 00:23:00,278
from an incident
response engagement

555
00:23:00,278 --> 00:23:02,180
where it looks like the IR guys

556
00:23:02,180 --> 00:23:05,317
just had no idea what was
in, what they were finding

557
00:23:05,317 --> 00:23:08,720
and they just uploaded the
full archives to Virus Total,

558
00:23:08,720 --> 00:23:10,188
and I'm hoping that
help them at the time

559
00:23:10,188 --> 00:23:13,291
that at least help me give
you this presentation, right?

560
00:23:13,291 --> 00:23:16,094
So if you look at the name,

561
00:23:17,362 --> 00:23:19,297
there's something
that should stand out,

562
00:23:19,297 --> 00:23:22,968
let's all be sleuthy and
kinda play around with this,

563
00:23:22,968 --> 00:23:26,238
you go, well, one two three,
part zero zero three of a RAR

564
00:23:29,975 --> 00:23:32,377
well, it can't be
that simple, right?

565
00:23:32,377 --> 00:23:34,613
You go, I don't know,
there's a fourth

566
00:23:34,613 --> 00:23:37,716
but there's at least
gotta be a one and a two

567
00:23:37,716 --> 00:23:40,118
so then, you know,
this sparks joy.

568
00:23:41,553 --> 00:23:45,090
You just start subtracting
and file name searching

569
00:23:45,090 --> 00:23:47,158
and it turns out that
that's a fairly unique thing

570
00:23:47,159 --> 00:23:50,061
and even though these are
archives are encrypted

571
00:23:50,061 --> 00:23:54,331
you have all the pieces,
you can actually rebuild,

572
00:23:54,332 --> 00:23:56,835
so in there, we find
something entirely different,

573
00:23:56,835 --> 00:23:59,771
it's something that calls
itself like a sub-straight

574
00:23:59,771 --> 00:24:02,139
piece of malware, what I'm
missing from this picture

575
00:24:02,140 --> 00:24:04,509
is actually, the
similarity engine,

576
00:24:04,509 --> 00:24:06,845
once you point that out
actually connects that back

577
00:24:06,845 --> 00:24:08,046
to some of the earlier samples

578
00:24:08,046 --> 00:24:09,281
who were right there
and you're like,

579
00:24:09,281 --> 00:24:11,616
OK, we're pay-dirt,
even though there were

580
00:24:11,616 --> 00:24:14,186
about 20 or 30 different
binaries of these things

581
00:24:14,186 --> 00:24:16,588
they just pulled everything
out of system 32, right?

582
00:24:16,588 --> 00:24:18,490
Let me speed up a little bit,

583
00:24:18,490 --> 00:24:21,393
so this thing calls
itself msdllfix

584
00:24:21,393 --> 00:24:23,061
which right there and
then for those of you

585
00:24:23,061 --> 00:24:24,830
that know what
spear-phishing is like,

586
00:24:24,830 --> 00:24:27,131
what it's like to get these
attachments and things,

587
00:24:27,132 --> 00:24:30,168
it should start to spark
some concerns, right?

588
00:24:30,168 --> 00:24:31,937
This is actually one
of the other types

589
00:24:31,937 --> 00:24:33,905
of infection vectors that we
discovered for the Lamberts,

590
00:24:33,905 --> 00:24:37,509
they'll find you on a, just
off the top of my head,

591
00:24:37,509 --> 00:24:42,514
a forum for research on
building the kind of tunnels

592
00:24:44,249 --> 00:24:46,184
that nuclear plants underground

593
00:24:46,184 --> 00:24:50,622
might be interested in
building asking for software

594
00:24:50,622 --> 00:24:52,824
that is currently under
embargo in certain countries

595
00:24:52,824 --> 00:24:54,392
and then somebody
shows up and says,

596
00:24:54,392 --> 00:24:56,094
oh don't worry buddy,
I've got it for you

597
00:24:56,094 --> 00:24:57,562
and they just kick over a binary

598
00:24:57,562 --> 00:25:00,064
that doesn't actually have
the thing inside of it

599
00:25:00,065 --> 00:25:02,968
but it does have something
called BlueLambert.

600
00:25:02,968 --> 00:25:04,936
So what we found, something that

601
00:25:04,936 --> 00:25:07,072
I like to call Tuxedo
Lambert, it's entirely new,

602
00:25:07,072 --> 00:25:08,305
nobody's heard about it before,

603
00:25:08,306 --> 00:25:09,774
I just bring it to
you guys so that

604
00:25:09,774 --> 00:25:12,010
we can have some fun today,
I call it Tuxedo Lambert

605
00:25:12,010 --> 00:25:14,312
because it actually
has similar encryption

606
00:25:14,312 --> 00:25:16,881
and export styles
to BlackLambert

607
00:25:16,882 --> 00:25:19,851
and if you remember
that ODTFF exploit,

608
00:25:19,851 --> 00:25:23,622
sorry, ODTTF exploit
that BlackLambert
was discovered with,

609
00:25:23,622 --> 00:25:27,292
what Tuxedo Lambert does
is it sets up a service,

610
00:25:27,292 --> 00:25:30,695
it drops its own font
which is not vulnerable

611
00:25:30,695 --> 00:25:33,398
when you first see
it, it alters the font

612
00:25:33,398 --> 00:25:36,333
into a vulnerable
state, it exploits

613
00:25:36,334 --> 00:25:38,436
what at the time
were two zero days

614
00:25:39,638 --> 00:25:42,741
in the Windows kernel in
order to load something

615
00:25:42,741 --> 00:25:45,477
directly into kernel
memory, and when you look at

616
00:25:45,477 --> 00:25:48,313
what that is, it
was WhiteLambert.

617
00:25:48,313 --> 00:25:50,382
So that's our second
question there,

618
00:25:50,382 --> 00:25:53,084
once you figure out this
is what they're doing

619
00:25:53,084 --> 00:25:56,922
as far as loading up
their sensitive implants,

620
00:25:56,922 --> 00:25:59,591
so this particular, WhiteLambert
was particularly sensitive,

621
00:25:59,591 --> 00:26:00,524
it's this orchestrator thing,

622
00:26:00,525 --> 00:26:01,760
we never knew how it got there,

623
00:26:01,760 --> 00:26:03,728
it turns out they
rely on another

624
00:26:03,728 --> 00:26:06,164
entirely sophisticated dropper

625
00:26:06,164 --> 00:26:07,632
that all it's supposed to do is

626
00:26:07,632 --> 00:26:10,168
create something
exploitable within itself

627
00:26:10,168 --> 00:26:11,735
in order to load this thing up.

628
00:26:14,039 --> 00:26:15,874
So, like I said, WhiteLambert,

629
00:26:15,874 --> 00:26:18,476
we now have an answer
that's more of a question

630
00:26:18,476 --> 00:26:20,145
in and of itself
but essentially,

631
00:26:20,145 --> 00:26:24,081
Tuxedo Lambert is the infection
vector for WhiteLambert,

632
00:26:24,082 --> 00:26:26,484
what the infection vector
for Tuxedo Lambert is,

633
00:26:26,484 --> 00:26:30,054
is an answer for a different
thought presumably.

634
00:26:30,055 --> 00:26:32,190
So what happens to the
other question, right?

635
00:26:32,190 --> 00:26:33,792
Victim box orchestration,
how the hell

636
00:26:33,792 --> 00:26:36,226
are they doing
these other things?

637
00:26:36,227 --> 00:26:37,963
Well it turns out
that once you hone in

638
00:26:37,963 --> 00:26:41,099
on something like seven
or eight Tuxedo Lambert

639
00:26:41,099 --> 00:26:42,667
infections that we found,

640
00:26:44,102 --> 00:26:46,605
there's a tiny file
that keeps showing up

641
00:26:46,605 --> 00:26:48,506
whenever these things show up.

642
00:26:48,506 --> 00:26:51,676
And that tiny file is
actually a custom webshell,

643
00:26:51,676 --> 00:26:54,012
so if you think back
to old-school hacking,

644
00:26:54,012 --> 00:26:55,312
the way that people
used to do it

645
00:26:55,313 --> 00:26:57,115
before they relied
on all this automated

646
00:26:57,115 --> 00:27:01,319
command and control nonsense,
the good old hardened hackers,

647
00:27:01,319 --> 00:27:03,855
a webshell and
some command line,

648
00:27:03,855 --> 00:27:07,125
hands-on keyboard way
of managing infections.

649
00:27:08,293 --> 00:27:09,894
So interesting things
about this webshell

650
00:27:09,894 --> 00:27:14,866
is it's a no-nonsense, very
interesting, tiny piece ASP,

651
00:27:16,301 --> 00:27:18,168
what's interesting to me
is it actually requires

652
00:27:18,169 --> 00:27:19,571
authentication to issue commands

653
00:27:19,571 --> 00:27:20,839
which is something
that I promised

654
00:27:20,839 --> 00:27:22,240
to write a paper
about but haven't,

655
00:27:22,240 --> 00:27:24,943
it's a NOBUS style of backdoor,

656
00:27:24,943 --> 00:27:27,579
NOBUS is a term that got
popular around the Snowden era

657
00:27:27,579 --> 00:27:29,214
and like most things
in the Snowden era

658
00:27:29,214 --> 00:27:31,750
got unpopular about
a month after that.

659
00:27:31,750 --> 00:27:33,718
So it means nobody but us,

660
00:27:33,718 --> 00:27:35,820
it's what responsible
threat actors do,

661
00:27:35,820 --> 00:27:38,056
they pop your machine and
just because they're there

662
00:27:38,056 --> 00:27:39,290
it doesn't mean
that everybody else

663
00:27:39,290 --> 00:27:40,892
should have access
to your machine.

664
00:27:42,260 --> 00:27:43,495
And what's interesting
about this webshell as well

665
00:27:43,495 --> 00:27:44,928
is that it actually
monitors for attempts

666
00:27:44,929 --> 00:27:47,499
to be researched or
abused, so again,

667
00:27:48,667 --> 00:27:50,401
they're watching
to see what we do

668
00:27:50,402 --> 00:27:51,770
but also they're
trying to make sure

669
00:27:51,770 --> 00:27:53,705
that nobody else is exploiting
their own technology

670
00:27:53,705 --> 00:27:55,706
to enter your box.

671
00:27:55,707 --> 00:27:57,242
And as is often the
case, and this is

672
00:27:57,242 --> 00:27:58,777
particularly important
to understand,

673
00:27:58,777 --> 00:28:02,147
once we discover one thing,
we discover many things,

674
00:28:02,147 --> 00:28:05,149
so that's, yet again,
going back to something

675
00:28:05,150 --> 00:28:07,419
that seemed uninteresting,
that seemed beaten to death,

676
00:28:07,419 --> 00:28:10,622
finding a few pieces,
finding a few answers,

677
00:28:10,622 --> 00:28:12,624
and finding a few new questions

678
00:28:12,624 --> 00:28:14,693
and that's the beauty of
doing this sort of research,

679
00:28:14,693 --> 00:28:17,562
of going back, understanding
something more fully,

680
00:28:17,562 --> 00:28:19,229
using tools that
were not available

681
00:28:19,230 --> 00:28:21,466
when we first discovered
BlackLambert and WhiteLambert

682
00:28:21,466 --> 00:28:23,101
and are now proliferated
to just about

683
00:28:23,101 --> 00:28:27,105
everybody in this room and
finding a lot more things.

684
00:28:27,105 --> 00:28:30,175
So that's kinda my pitch,
trying to get all of you

685
00:28:30,175 --> 00:28:32,377
into this
cyber-paleontology train

686
00:28:32,377 --> 00:28:34,779
of trying to get all of
you to feel less daunted

687
00:28:34,779 --> 00:28:37,048
about taking an old report
like the Stuxnet report,

688
00:28:37,048 --> 00:28:38,850
like the APT 1 report,
like whatever it is

689
00:28:38,850 --> 00:28:41,086
that you're into that
you find fascinating,

690
00:28:41,086 --> 00:28:43,188
taking those IOCs and
start beating them,

691
00:28:43,188 --> 00:28:46,791
beat that dead horse again
and you'll find something,

692
00:28:46,791 --> 00:28:50,328
I promise, and just in case
you need some research leads

693
00:28:50,328 --> 00:28:53,098
and some fun stuff to do,
you can always help us find

694
00:28:53,098 --> 00:28:55,667
the milk-carton APTs
as I like to call them,

695
00:28:55,667 --> 00:28:58,503
things like Flame which
was never seen again

696
00:28:58,503 --> 00:29:01,172
after its original discovery,
Careto, still missing,

697
00:29:01,172 --> 00:29:03,074
its family asks about
it all the time,

698
00:29:03,074 --> 00:29:08,079
Babar, the SNOWGLOBE APT,
lots of interesting stuff,

699
00:29:09,080 --> 00:29:10,782
all of them
fascinating, all of them

700
00:29:10,782 --> 00:29:13,518
with plenty of open questions
and where there's that,

701
00:29:13,518 --> 00:29:16,054
there's a lot more to look for.

702
00:29:16,054 --> 00:29:19,591
So somehow, 45 seconds to spare,

703
00:29:19,591 --> 00:29:21,959
I should've added
another 50 slides,

704
00:29:21,960 --> 00:29:25,497
but that's my piece.

705
00:29:25,497 --> 00:29:27,732
(applause)

706
00:29:30,301 --> 00:29:32,870
(eerie music)

