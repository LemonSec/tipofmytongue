1
00:00:00,867 --> 00:00:03,670
(gentle electronic music)

2
00:00:06,339 --> 00:00:10,210
(electronic thudding)

3
00:00:10,210 --> 00:00:13,380
(audience applauding)

4
00:00:14,714 --> 00:00:17,217
- Good afternoon, thanks
for sticking around.

5
00:00:17,217 --> 00:00:20,453
As Katie said, my
name is David Bianco

6
00:00:22,322 --> 00:00:23,857
I work for Target.

7
00:00:23,857 --> 00:00:25,724
So if you don't know,

8
00:00:25,725 --> 00:00:27,827
if you're not from the
United States maybe,

9
00:00:27,827 --> 00:00:30,997
Target is a major retail outlet
here in the United States.

10
00:00:30,997 --> 00:00:35,235
And so we have this thing
called the peak retail season,

11
00:00:35,235 --> 00:00:36,536
which we just went through.

12
00:00:38,571 --> 00:00:41,608
It's basically the day after
Thanksgiving here in the US,

13
00:00:41,608 --> 00:00:43,142
so at the end of November,

14
00:00:43,143 --> 00:00:46,112
all the way up through and
including Christmas Eve,

15
00:00:46,112 --> 00:00:47,013
peak retail season.

16
00:00:48,081 --> 00:00:49,516
And I tell you this because

17
00:00:52,152 --> 00:00:56,389
last year, my boss likes
to get ahead of things.

18
00:00:56,389 --> 00:01:00,293
So around in May, he
comes to me and he says,

19
00:01:00,293 --> 00:01:04,164
"David, it's time to get
started getting ready for peak."

20
00:01:05,565 --> 00:01:08,001
I have not been in the
retail industry that long.

21
00:01:08,001 --> 00:01:10,036
But I know usually in May,

22
00:01:10,036 --> 00:01:13,807
you do not start preparing
for things in November.

23
00:01:13,807 --> 00:01:15,975
But he had a really good reason.

24
00:01:15,975 --> 00:01:18,178
He said, "specifically,

25
00:01:18,178 --> 00:01:21,981
"I would like to
know more about our

26
00:01:21,981 --> 00:01:24,217
"CTI information
that we've collected.

27
00:01:25,418 --> 00:01:28,154
"I want to know if
the intel products

28
00:01:28,154 --> 00:01:30,056
"that we're putting out

29
00:01:30,056 --> 00:01:34,393
"are appropriate to
support our detection

30
00:01:34,394 --> 00:01:37,897
"and incident
response requirements

31
00:01:37,897 --> 00:01:40,934
"for our major
identified threat actors

32
00:01:41,835 --> 00:01:43,803
"in next peak season."

33
00:01:46,306 --> 00:01:49,576
So the idea is he
asked me early,

34
00:01:49,576 --> 00:01:52,277
so I would have a few months
to work on the project

35
00:01:52,278 --> 00:01:53,813
and do the evaluation,

36
00:01:53,813 --> 00:01:56,416
they could have some
time to kind of digest

37
00:01:56,416 --> 00:01:58,750
the results of the analysis,

38
00:01:58,751 --> 00:02:01,788
and then still some time to

39
00:02:01,788 --> 00:02:03,590
help put things back on track

40
00:02:03,590 --> 00:02:05,792
if something needed to
be corrected, right?

41
00:02:05,792 --> 00:02:08,461
So it was good that he
gave me all this extra time

42
00:02:08,461 --> 00:02:10,196
because I kind of needed it.

43
00:02:11,364 --> 00:02:14,634
So, getting ready
for peak, yeah.

44
00:02:14,634 --> 00:02:16,835
I'm there for that.

45
00:02:16,836 --> 00:02:18,071
I want that too.

46
00:02:19,339 --> 00:02:22,909
But I didn't really
know what that meant.

47
00:02:22,909 --> 00:02:24,144
And neither did he,

48
00:02:24,144 --> 00:02:26,279
and it turns out, that's
why he gave it to me,

49
00:02:26,279 --> 00:02:27,113
because

50
00:02:29,782 --> 00:02:31,518
he didn't know how
to do it either.

51
00:02:33,486 --> 00:02:37,823
So I guess the first thing
that I thought of is,

52
00:02:37,824 --> 00:02:40,493
okay, I don't really know
how to approach this problem,

53
00:02:40,493 --> 00:02:41,793
so I'm gonna break it down,

54
00:02:41,794 --> 00:02:43,396
like typical computer science

55
00:02:43,396 --> 00:02:45,398
and problem solving
kind of strategy,

56
00:02:45,398 --> 00:02:46,833
I'm gonna break it
down into problems

57
00:02:46,833 --> 00:02:49,102
and maybe I'll get
some ideas, right.

58
00:02:49,102 --> 00:02:51,337
So the action items
that I came up with.

59
00:02:51,337 --> 00:02:53,640
First one was, first
of all obviously,

60
00:02:55,108 --> 00:02:59,078
he wants to know about our
priority threat actors,

61
00:02:59,078 --> 00:03:01,080
I have to figure out what our
priority threat actors are.

62
00:03:01,080 --> 00:03:03,683
Fortunately, we have a CTI
team that does this for me,

63
00:03:03,683 --> 00:03:05,685
so this was the dead easy,

64
00:03:05,685 --> 00:03:07,620
I just kind of went
over then asked them,

65
00:03:07,620 --> 00:03:10,023
they said, I have this list,

66
00:03:10,023 --> 00:03:11,891
let me do a review and see

67
00:03:11,891 --> 00:03:14,761
what we think that our
priority threat actor list

68
00:03:14,761 --> 00:03:17,162
is gonna change maybe
by the time of peak.

69
00:03:17,163 --> 00:03:19,299
So they they kind of
reviewed that for me

70
00:03:19,299 --> 00:03:20,667
and provided me a list.

71
00:03:20,667 --> 00:03:21,901
So great.

72
00:03:21,901 --> 00:03:24,270
I'm like, I'm a part
of the way there.

73
00:03:26,005 --> 00:03:27,740
The next part, though,
is figuring out

74
00:03:27,740 --> 00:03:30,743
what we know about each
of those threat actors.

75
00:03:30,743 --> 00:03:34,814
And when I'm talking in this
presentation, by the way,

76
00:03:34,814 --> 00:03:39,219
I'm gonna talk about the
outputs of our intel process.

77
00:03:39,219 --> 00:03:41,186
So not raw data,

78
00:03:41,187 --> 00:03:45,758
but the various different
types of intel outputs,

79
00:03:45,758 --> 00:03:49,729
the IOCs that have gone
through the entire process,

80
00:03:49,729 --> 00:03:51,464
we heard people talking,

81
00:03:51,464 --> 00:03:54,667
basically pooping on
IOCs earlier this morning

82
00:03:54,667 --> 00:03:56,035
and this afternoon, right?

83
00:03:56,035 --> 00:03:57,470
But we're talking about the ones

84
00:03:57,470 --> 00:03:58,905
that have gone through
the whole process,

85
00:03:58,905 --> 00:04:00,139
and these are the
ones that we actually

86
00:04:00,139 --> 00:04:02,108
consider valuable
for whatever reasons.

87
00:04:03,843 --> 00:04:06,813
And also our extracted analysis

88
00:04:06,813 --> 00:04:10,716
and summaries of adversary
behaviors and things like that.

89
00:04:10,717 --> 00:04:12,085
So these are things
that have already

90
00:04:12,085 --> 00:04:14,020
gone through the intel process.

91
00:04:14,020 --> 00:04:18,358
So not raw data, but processed
intelligence products.

92
00:04:19,524 --> 00:04:22,128
So I had to figure out
what was available.

93
00:04:22,128 --> 00:04:24,229
And then I had to figure out

94
00:04:24,230 --> 00:04:26,332
what was really the
meat of this is,

95
00:04:26,332 --> 00:04:28,901
now that I know my targets,

96
00:04:28,901 --> 00:04:33,606
I have the data about
those threat actors.

97
00:04:33,606 --> 00:04:37,010
How do I come up
with an evaluation

98
00:04:37,010 --> 00:04:39,879
that can tell us the
answer to the question,

99
00:04:39,879 --> 00:04:41,347
are we prepared?

100
00:04:44,217 --> 00:04:46,519
And then I actually
have to do that.

101
00:04:46,519 --> 00:04:50,189
Well, okay, three of these
things were not too bad.

102
00:04:50,189 --> 00:04:52,492
Item number two was
a little bit tricky,

103
00:04:52,492 --> 00:04:53,726
and we'll talk about that.

104
00:04:53,726 --> 00:04:55,261
But the first one
was done for me,

105
00:04:55,261 --> 00:04:58,097
basically by another team,
all I had to do was ask.

106
00:04:58,097 --> 00:05:01,768
And I figured by the time
I got to the fourth bullet,

107
00:05:01,768 --> 00:05:03,268
doing the analysis,

108
00:05:03,269 --> 00:05:05,104
once I figured out what I
wanted to do, would be easy,

109
00:05:05,104 --> 00:05:08,041
I was a little bit wrong
and a little bit right.

110
00:05:08,041 --> 00:05:10,943
Remember I told you all these
things were already processed.

111
00:05:10,943 --> 00:05:13,979
The inputs to mine were
processed intelligence reports

112
00:05:13,980 --> 00:05:16,349
and other products, right?

113
00:05:16,349 --> 00:05:19,319
So you would think that
if we'd already done it,

114
00:05:19,319 --> 00:05:20,720
everything would be so easy.

115
00:05:22,121 --> 00:05:25,325
This was the kind
of the first phase

116
00:05:25,325 --> 00:05:27,260
where I had to do some thinking.

117
00:05:27,260 --> 00:05:32,265
And I will, like to give a
shout out to my teammate here,

118
00:05:33,132 --> 00:05:34,567
Jason Lynch, also at Target,

119
00:05:34,567 --> 00:05:39,005
who helped me with the
data collection part a lot.

120
00:05:39,872 --> 00:05:41,040
Because I'm not typically,

121
00:05:41,040 --> 00:05:43,576
I'm actually not
on the CTI team.

122
00:05:43,576 --> 00:05:46,312
So their processes about
where they store things

123
00:05:46,312 --> 00:05:49,315
and how they, you know, what
databases they put 'em in,

124
00:05:49,315 --> 00:05:52,051
or how to find the
reports and things

125
00:05:52,051 --> 00:05:54,187
were a little bit
opaque to me at first.

126
00:05:54,187 --> 00:05:55,922
And I'm not on the
detection team,

127
00:05:55,922 --> 00:05:59,459
the consumer of most
of these reports.

128
00:05:59,459 --> 00:06:03,663
So where the detection team
goes to get their information,

129
00:06:03,663 --> 00:06:05,665
also a little bit opaque to me.

130
00:06:05,665 --> 00:06:09,369
But Jason does a little
bit of both of those,

131
00:06:09,369 --> 00:06:11,404
it's his job to know
where that stuff is

132
00:06:11,404 --> 00:06:13,740
so they can create the
detection engineering

133
00:06:13,740 --> 00:06:15,675
around the intel
that we provided.

134
00:06:15,675 --> 00:06:18,277
And he helped me a lot

135
00:06:18,277 --> 00:06:21,681
understand how to
get all this data.

136
00:06:21,681 --> 00:06:23,549
So big shout out to him,

137
00:06:23,549 --> 00:06:26,551
if this ever hits YouTube,
he'll be really surprised.

138
00:06:28,688 --> 00:06:30,957
Data collection, I looked at it

139
00:06:30,957 --> 00:06:34,293
as two big buckets of
different types of data.

140
00:06:34,293 --> 00:06:38,531
So first, we have the
kind of traditional IOCs,

141
00:06:38,531 --> 00:06:41,267
the facts that we know, right?

142
00:06:42,335 --> 00:06:45,405
Hashes, IPs,
domains, tool marks,

143
00:06:45,405 --> 00:06:47,172
anything like that.

144
00:06:48,875 --> 00:06:53,780
Our process, first of all
was to find where those were,

145
00:06:53,780 --> 00:06:57,150
'cause we actually
had multiple databases

146
00:06:57,150 --> 00:06:59,251
for different intel pieces,

147
00:06:59,252 --> 00:07:02,288
depending on what the
actual use of it was.

148
00:07:02,288 --> 00:07:04,357
And depending on
which part of the

149
00:07:04,357 --> 00:07:08,461
detection engineering team's
process it meshed with.

150
00:07:08,461 --> 00:07:12,432
So I had to find out where
all those things were

151
00:07:12,432 --> 00:07:14,967
and basically do
a big data dump.

152
00:07:16,068 --> 00:07:17,770
Which sounds easy,

153
00:07:19,505 --> 00:07:21,974
it was easy for me
'cause Jason did it.

154
00:07:24,744 --> 00:07:27,346
But I mean, he had to
figure out where that was,

155
00:07:27,346 --> 00:07:29,015
but also, he also
had to figure out,

156
00:07:29,015 --> 00:07:30,782
we had a kind of tagging scheme

157
00:07:30,783 --> 00:07:32,185
that was a little
bit inconsistent,

158
00:07:32,185 --> 00:07:34,387
where we tagged some
things with malware actors,

159
00:07:34,387 --> 00:07:37,256
or excuse me, malware
names of the families,

160
00:07:37,256 --> 00:07:39,258
and some things with
the threat actors.

161
00:07:39,258 --> 00:07:42,594
And if you knew that the
malware was the threat actor,

162
00:07:42,595 --> 00:07:45,398
because you dealt with
this all the time,

163
00:07:45,398 --> 00:07:47,400
you would know that this
was one of their tools

164
00:07:47,400 --> 00:07:49,402
that they used that was
probably associated with them,

165
00:07:49,402 --> 00:07:50,603
okay, you could do that.

166
00:07:50,603 --> 00:07:52,205
But if you just
come to it and say,

167
00:07:52,205 --> 00:07:53,705
I have threat actor X,

168
00:07:53,706 --> 00:07:55,775
and I wanna dump everything
you know about threat actor X,

169
00:07:55,775 --> 00:07:57,909
our tooling actually
did not support that.

170
00:07:57,910 --> 00:08:01,514
So we had some gyrations
to jump through there.

171
00:08:02,915 --> 00:08:05,451
But we were able to eventually
dump out all the IOC data

172
00:08:05,451 --> 00:08:08,221
from our various tips
and databases and stuff.

173
00:08:09,522 --> 00:08:13,058
And then we had to
clean up this data.

174
00:08:13,059 --> 00:08:14,260
It was very dirty.

175
00:08:14,260 --> 00:08:16,429
Different places that
recorded the data

176
00:08:17,597 --> 00:08:19,732
recorded different
pieces of different

177
00:08:19,732 --> 00:08:21,200
attributes for that data.

178
00:08:22,502 --> 00:08:24,504
And in some cases
where it looked like

179
00:08:24,504 --> 00:08:26,405
they had recorded
the same attribute,

180
00:08:26,405 --> 00:08:28,006
it wasn't the same attribute.

181
00:08:28,007 --> 00:08:30,109
For example, almost
everything had a timestamp

182
00:08:30,109 --> 00:08:31,577
associated with it.

183
00:08:31,577 --> 00:08:33,679
I'll show you an example later
on where that wasn't true,

184
00:08:33,679 --> 00:08:35,581
but almost everything
had a timestamp.

185
00:08:35,581 --> 00:08:36,782
But in some cases,

186
00:08:36,782 --> 00:08:38,451
the database was
showing the timestamp

187
00:08:38,451 --> 00:08:39,852
that was added to the database,

188
00:08:39,852 --> 00:08:42,688
and sometimes it was
showing the last update time

189
00:08:42,688 --> 00:08:45,790
or the time it was last
known to be current intel.

190
00:08:45,791 --> 00:08:48,094
And it wasn't always
kind of obvious

191
00:08:48,094 --> 00:08:49,629
just by looking at
the column names.

192
00:08:49,629 --> 00:08:53,432
So we had to really put
some work into understand

193
00:08:53,432 --> 00:08:57,336
what it is those
databases were telling us

194
00:08:57,336 --> 00:09:01,874
and clean all that up and
put it in consistent formats.

195
00:09:01,874 --> 00:09:05,278
Because if one database
stores things by,

196
00:09:05,278 --> 00:09:07,813
you know, seconds
since the Unix epoch,

197
00:09:07,813 --> 00:09:09,515
and the other stores it as a

198
00:09:11,350 --> 00:09:15,755
YYYY MM DD kind of format,

199
00:09:15,755 --> 00:09:18,591
we need to make
them be the same,

200
00:09:18,591 --> 00:09:22,728
so that we can look at them
and compare them correctly.

201
00:09:22,728 --> 00:09:23,930
So there's a lot of cleaning

202
00:09:23,930 --> 00:09:26,665
and data normalization going on.

203
00:09:26,666 --> 00:09:29,035
I was pretty much
prepared for this though,

204
00:09:29,035 --> 00:09:32,905
'cause I do a lot of
data analysis tasks.

205
00:09:32,905 --> 00:09:35,374
And most data analysis tasks,

206
00:09:35,374 --> 00:09:38,411
the first 80% of
the work is this.

207
00:09:38,411 --> 00:09:40,946
Finding the data, cleaning it up

208
00:09:40,947 --> 00:09:45,184
and normalizing it,
getting it prepared

209
00:09:45,184 --> 00:09:47,553
to do the actual analysis.

210
00:09:48,487 --> 00:09:50,021
So that's one type.

211
00:09:50,022 --> 00:09:52,625
The other type is we had all
these behaviors of the TTPs.

212
00:09:53,993 --> 00:09:56,662
Where the IOCs were
usually in databases,

213
00:09:56,662 --> 00:09:58,130
we can search for them,

214
00:09:58,130 --> 00:10:01,601
our behaviors were usually
in ASCII documents in a wiki.

215
00:10:02,768 --> 00:10:06,038
So when Jason says,
I can dump all these,

216
00:10:06,038 --> 00:10:09,208
I'll figure out how to deal
with the tagging and whatever

217
00:10:09,208 --> 00:10:10,876
and we'll just
dump them all out,

218
00:10:10,876 --> 00:10:12,377
I was like, great,

219
00:10:12,378 --> 00:10:15,681
I'm gonna read these
100 or so documents,

220
00:10:16,782 --> 00:10:19,018
and just manually
extract everything into

221
00:10:20,353 --> 00:10:23,356
our favorite intel
tracking tool, Excel.

222
00:10:26,125 --> 00:10:29,195
On the other hand, you
know, it's a lot of work.

223
00:10:29,195 --> 00:10:32,164
And I had to spend some
time actually figuring out

224
00:10:32,164 --> 00:10:34,634
that I had all the documents
and then read them all

225
00:10:34,634 --> 00:10:36,869
and do kind of
like what Katie was

226
00:10:36,869 --> 00:10:38,604
talking about earlier today,

227
00:10:38,604 --> 00:10:40,272
where she showed
you how she mapped

228
00:10:40,272 --> 00:10:43,609
English text into
attack behaviors.

229
00:10:43,609 --> 00:10:44,877
That's exactly what I did.

230
00:10:44,877 --> 00:10:47,680
In fact, we mapped them
into attack behaviors.

231
00:10:47,680 --> 00:10:50,348
But I also took some of
the other pieces as well.

232
00:10:52,351 --> 00:10:53,953
And then I had these two buckets

233
00:10:53,953 --> 00:10:56,288
of cleaned and normalized data.

234
00:10:56,288 --> 00:10:59,325
And I had to merge them
into one big bucket

235
00:10:59,325 --> 00:11:02,995
and decide if there
were any duplicates.

236
00:11:02,995 --> 00:11:04,830
And if there were,
which one to keep,

237
00:11:04,830 --> 00:11:07,166
or how to merge them, the
two duplicates into one,

238
00:11:07,166 --> 00:11:09,201
and deduplicate all that data.

239
00:11:09,201 --> 00:11:11,070
And now, but finally now

240
00:11:11,070 --> 00:11:12,972
was able to do some
visualizations,

241
00:11:12,972 --> 00:11:16,007
which we'll talk about
in this presentation.

242
00:11:16,008 --> 00:11:19,779
But this was my process here.

243
00:11:19,779 --> 00:11:21,380
Find all the data,

244
00:11:21,380 --> 00:11:24,150
spend most of my time
writing Python code

245
00:11:24,150 --> 00:11:27,218
to make it so that I could
do the one box at the end.

246
00:11:31,123 --> 00:11:32,892
So thinking back
to my action items,

247
00:11:32,892 --> 00:11:34,927
okay, I've got the data.

248
00:11:34,927 --> 00:11:36,595
Now I have to figure out

249
00:11:38,030 --> 00:11:41,100
what I'm really interested
in doing with that data.

250
00:11:41,100 --> 00:11:42,368
How do I evaluate it?

251
00:11:43,769 --> 00:11:46,739
Well, we had a number of
things that we wanted to know.

252
00:11:48,174 --> 00:11:52,578
I kind of extrapolated
from my original request,

253
00:11:52,578 --> 00:11:54,213
and I made up my own
list of questions,

254
00:11:54,213 --> 00:11:56,281
like, do we know
what the adversary's

255
00:11:56,282 --> 00:11:58,117
repeated behaviors are?

256
00:11:58,117 --> 00:12:01,353
For our IOCs, or really
even for our behaviors,

257
00:12:01,353 --> 00:12:03,589
how volatile is
that information?

258
00:12:03,589 --> 00:12:06,225
Is it something that is
likely to change next week,

259
00:12:06,225 --> 00:12:08,761
or is it something that
we're likely to be good on

260
00:12:08,761 --> 00:12:11,497
by peak retail season?

261
00:12:11,497 --> 00:12:14,099
We mapped everything
to an attack lifecycle.

262
00:12:14,100 --> 00:12:16,335
So if you think of
the attack lifecycle,

263
00:12:16,335 --> 00:12:17,536
like the cyber kill chain,

264
00:12:17,536 --> 00:12:21,207
or the MITRE ATT&CK framework,

265
00:12:21,207 --> 00:12:23,641
where Katie keeps telling
me I'm doing it wrong.

266
00:12:26,512 --> 00:12:28,680
She's just like, "True."

267
00:12:28,681 --> 00:12:30,249
In which lifecycle phases

268
00:12:30,249 --> 00:12:32,985
do we know a lot
about the adversary's

269
00:12:32,985 --> 00:12:35,888
potential behaviors and IOCs,

270
00:12:35,888 --> 00:12:37,923
and which don't
we know very much?

271
00:12:37,923 --> 00:12:39,558
Those are the places
that they could

272
00:12:39,558 --> 00:12:41,994
potentially operate
in our environment

273
00:12:41,994 --> 00:12:44,096
without us finding them easily.

274
00:12:44,096 --> 00:12:47,333
Is our intel fresh,
but not too fresh,

275
00:12:47,333 --> 00:12:49,568
because we would
like to not only know

276
00:12:49,568 --> 00:12:51,103
what they did last week,

277
00:12:51,103 --> 00:12:52,637
but we would like
to be able to track

278
00:12:52,638 --> 00:12:55,307
patterns of behavior over time

279
00:12:55,307 --> 00:12:59,512
for tendencies and tracking
changes in behavior

280
00:12:59,512 --> 00:13:02,948
that might allow us to project
farther into the future,

281
00:13:02,948 --> 00:13:06,886
how their tendencies
might change or adapt.

282
00:13:06,886 --> 00:13:09,789
So do we have not only
just enough intel,

283
00:13:09,789 --> 00:13:12,191
but what is the
timing of this intel?

284
00:13:12,191 --> 00:13:13,692
Is it good, is it fresh,

285
00:13:13,692 --> 00:13:16,462
is it old, is it a good mixture?

286
00:13:16,462 --> 00:13:18,898
And finally, with all these,

287
00:13:18,898 --> 00:13:23,803
how do we concentrate or
improve our detection?

288
00:13:23,803 --> 00:13:25,704
Or excuse me, our collection,

289
00:13:25,704 --> 00:13:28,574
so that we could properly
support the detection efforts?

290
00:13:29,742 --> 00:13:31,610
Notice nowhere in
here did I say,

291
00:13:31,610 --> 00:13:32,845
are we detecting these things,

292
00:13:32,845 --> 00:13:35,648
it's all, the CTI piece,

293
00:13:35,648 --> 00:13:37,550
is it able to support detection,

294
00:13:37,550 --> 00:13:40,286
detection being, you know,
a different question.

295
00:13:41,720 --> 00:13:42,888
Looking at all these,

296
00:13:42,888 --> 00:13:44,123
I decided that I
wanted to take a look

297
00:13:44,123 --> 00:13:45,858
at the data that
we had collected

298
00:13:45,858 --> 00:13:47,760
through the lens of
two different models.

299
00:13:47,760 --> 00:13:50,462
And so the first one is
the attack lifecycle.

300
00:13:50,462 --> 00:13:52,298
So again,

301
00:13:52,298 --> 00:13:54,366
Katie made the point in her

302
00:13:54,366 --> 00:13:56,202
and Brian's
presentation earlier,

303
00:13:56,202 --> 00:13:58,971
that the behaviors in
the attack lifecycle

304
00:13:58,971 --> 00:14:01,273
are not ordered,

305
00:14:01,273 --> 00:14:02,675
but then they have this graph,

306
00:14:02,675 --> 00:14:05,077
which is a kind of extension,

307
00:14:05,077 --> 00:14:08,547
I think of the Lockheed
Martin cyber kill chain.

308
00:14:08,547 --> 00:14:12,818
And it seems to have an
inherent order, right?

309
00:14:12,818 --> 00:14:14,420
So we were pretty much

310
00:14:16,222 --> 00:14:18,991
integrating as much as we can
with the ATT&CK framework.

311
00:14:18,991 --> 00:14:22,061
So I chose the ATT&CK
framework's lifecycle model,

312
00:14:22,061 --> 00:14:24,096
but you could easily,

313
00:14:24,096 --> 00:14:27,099
without changing the
analysis really at all,

314
00:14:27,099 --> 00:14:28,734
integrate your own favorite.

315
00:14:28,734 --> 00:14:31,704
So if you want to use
the Lockheed Martin
cyber kill chain,

316
00:14:31,704 --> 00:14:33,171
you could.

317
00:14:33,172 --> 00:14:34,406
If you had a different
one that you've developed

318
00:14:34,406 --> 00:14:35,840
or someone else's
that you liked,

319
00:14:35,841 --> 00:14:38,544
you could too use
that as easily.

320
00:14:39,745 --> 00:14:42,348
The idea, though,
is that it has a,

321
00:14:42,348 --> 00:14:45,950
the key criteria is
it has a progression,

322
00:14:45,951 --> 00:14:47,820
where typically, not always,

323
00:14:47,820 --> 00:14:51,190
but typically the things on
the left side of the model,

324
00:14:51,190 --> 00:14:53,859
starting with recon,

325
00:14:53,859 --> 00:14:57,129
are earlier in the phase

326
00:14:57,129 --> 00:14:58,664
than the things to the right.

327
00:14:59,698 --> 00:15:01,967
And typically also,

328
00:15:01,967 --> 00:15:04,703
that would mean that
the things to the right

329
00:15:04,703 --> 00:15:07,673
are more critical if
they happen to you,

330
00:15:07,673 --> 00:15:10,609
'cause the attacker's farther
along in this lifecycle.

331
00:15:13,646 --> 00:15:17,415
So the first thing I did
was I just kind of said,

332
00:15:17,416 --> 00:15:21,353
I would like to know
how much we have

333
00:15:21,353 --> 00:15:23,589
about a specific adversary,

334
00:15:23,589 --> 00:15:25,124
not all adversaries together,

335
00:15:25,124 --> 00:15:26,992
but a specific adversary

336
00:15:27,893 --> 00:15:31,897
in each of the lifecycle phases.

337
00:15:32,798 --> 00:15:34,934
So I just did a simple heat map.

338
00:15:34,934 --> 00:15:38,137
Now really, I hate when
somebody comes up to me

339
00:15:38,137 --> 00:15:40,539
and says, we've got
a million indicators,

340
00:15:40,539 --> 00:15:43,208
buddy, we're good.

341
00:15:43,208 --> 00:15:47,079
Because just that number of
what you have in your tip,

342
00:15:47,079 --> 00:15:49,515
or your Excel or
whatever you're using,

343
00:15:49,515 --> 00:15:51,216
is useless.

344
00:15:52,418 --> 00:15:56,522
But when you pair a
number of indicators

345
00:15:56,522 --> 00:15:59,558
with some extra
pieces of context,

346
00:15:59,558 --> 00:16:01,827
in this case, a
specific threat actor,

347
00:16:01,827 --> 00:16:06,031
and map it to a phase in an
attack lifecycle or something,

348
00:16:06,031 --> 00:16:08,934
you could conceivably
start to get some value

349
00:16:08,934 --> 00:16:10,803
out of simple counting,

350
00:16:10,803 --> 00:16:13,238
which is pretty much
what a heat map is.

351
00:16:13,238 --> 00:16:15,341
I can look at this
heat map and tell you

352
00:16:15,341 --> 00:16:18,744
that most of our CTI collection

353
00:16:18,744 --> 00:16:22,915
has been around the
delivery, the exploit,

354
00:16:22,915 --> 00:16:26,785
and the command and control
phases of this adversary.

355
00:16:26,785 --> 00:16:29,387
Remember, this is only one
specific adversary's data

356
00:16:29,388 --> 00:16:30,489
that we're looking at.

357
00:16:32,458 --> 00:16:34,693
And we don't really
know that much about

358
00:16:34,693 --> 00:16:36,627
how they do recon
or weaponization

359
00:16:36,628 --> 00:16:38,397
to deliver those things to us.

360
00:16:38,397 --> 00:16:39,832
And once they've delivered

361
00:16:39,832 --> 00:16:41,200
and established
command and control,

362
00:16:41,200 --> 00:16:42,901
we don't really
know that much about

363
00:16:42,901 --> 00:16:44,969
what they do later
on in the cycle.

364
00:16:46,038 --> 00:16:47,940
Which is important,

365
00:16:47,940 --> 00:16:50,142
because specifically
for these three,

366
00:16:50,142 --> 00:16:52,811
delivery, exploit and
command and control,

367
00:16:52,811 --> 00:16:56,382
they often happen
within seconds,

368
00:16:56,382 --> 00:16:57,882
or even less time.

369
00:16:57,883 --> 00:16:58,751
So,

370
00:17:00,185 --> 00:17:03,354
it would not be, it may
be technically incorrect,

371
00:17:03,355 --> 00:17:05,891
but it would be
defensible to say,

372
00:17:05,891 --> 00:17:07,059
this is all one event.

373
00:17:08,426 --> 00:17:10,561
From the time we
get the exploit,

374
00:17:10,561 --> 00:17:12,296
and it executes
and calls back out

375
00:17:12,297 --> 00:17:14,199
to its command and
control server,

376
00:17:14,199 --> 00:17:17,002
and the adversary's actually
able to do something with it.

377
00:17:17,002 --> 00:17:19,303
If it's like a
five second window,

378
00:17:19,304 --> 00:17:21,306
you might as well
consider it one event.

379
00:17:22,473 --> 00:17:23,708
And if you didn't
detect it then,

380
00:17:23,709 --> 00:17:25,844
you probably lost
your chance, right?

381
00:17:25,844 --> 00:17:28,047
So we have some gaps here.

382
00:17:28,047 --> 00:17:31,917
The other model that I wanted
to look at all this data with

383
00:17:31,917 --> 00:17:35,120
was something that I
put out a few years ago

384
00:17:35,120 --> 00:17:37,156
called the pyramid
of pain, right?

385
00:17:38,557 --> 00:17:40,893
If you're not familiar
with the pyramid of pain,

386
00:17:40,893 --> 00:17:43,028
it basically says,

387
00:17:43,028 --> 00:17:45,998
these are some common,
I think the most common,

388
00:17:45,998 --> 00:17:50,102
types of threat intel data
that you might encounter

389
00:17:50,102 --> 00:17:53,105
for detection and incident
response purposes,

390
00:17:53,105 --> 00:17:55,741
not including things
like campaign attribution

391
00:17:55,741 --> 00:17:57,009
or anything like that,

392
00:17:57,009 --> 00:17:58,944
for detection and
response purposes.

393
00:17:58,944 --> 00:18:02,648
So you can have a hash
value of IP addresses,

394
00:18:02,648 --> 00:18:06,452
domain names, network
or host artifacts,

395
00:18:06,452 --> 00:18:08,754
tool marks or tools,

396
00:18:08,754 --> 00:18:10,755
and then you can have
the behaviors at the top.

397
00:18:10,756 --> 00:18:13,992
And the farther
you go up the top,

398
00:18:13,992 --> 00:18:15,761
the harder it is
for the adversaries

399
00:18:15,761 --> 00:18:17,830
to change that indicator

400
00:18:17,830 --> 00:18:19,598
and swap it out
for something else.

401
00:18:20,732 --> 00:18:24,336
Like if you can
detect and respond to

402
00:18:24,336 --> 00:18:25,804
that thing that you know,

403
00:18:25,804 --> 00:18:29,174
quickly enough to negate
its value to the adversary,

404
00:18:31,009 --> 00:18:33,779
they have to replace
it with something else.

405
00:18:33,779 --> 00:18:35,747
And some things
are super simple.

406
00:18:35,747 --> 00:18:38,951
A hash value on one extreme
that can just add a null byte

407
00:18:38,951 --> 00:18:40,819
or something to the end of,

408
00:18:40,819 --> 00:18:42,855
they don't even really have
to recompile their malware,

409
00:18:42,855 --> 00:18:45,624
they can just edit a
string with a hex editor.

410
00:18:45,624 --> 00:18:47,259
And it's still the same malware,

411
00:18:47,259 --> 00:18:50,762
but you just changed the
hash value entirely, right?

412
00:18:50,762 --> 00:18:53,599
At mid level, the
network or host artifacts

413
00:18:53,599 --> 00:18:56,635
are the tool marks
of running the tools.

414
00:18:56,635 --> 00:19:01,173
They may be a registry
key or a file name

415
00:19:01,173 --> 00:19:04,543
or a way that they
construct their URLs.

416
00:19:04,543 --> 00:19:09,414
Many times they have to
just change a format string

417
00:19:09,414 --> 00:19:11,650
or something like
that in their code,

418
00:19:11,650 --> 00:19:13,252
but at least they
have to recompile it

419
00:19:13,252 --> 00:19:14,353
and maybe retest it

420
00:19:14,353 --> 00:19:17,890
and redistribute
it to change it.

421
00:19:17,890 --> 00:19:20,659
And then if you go to the
top, that's their behaviors,

422
00:19:20,659 --> 00:19:22,427
it's the way that they've
learned to operate,

423
00:19:22,427 --> 00:19:24,129
and changing that
is really hard.

424
00:19:26,431 --> 00:19:30,269
So what we did is similar
to the previous example,

425
00:19:30,269 --> 00:19:31,970
I kind of looked at,

426
00:19:31,970 --> 00:19:35,774
how many we have, how many
indicators that we have

427
00:19:35,774 --> 00:19:38,142
at each of the pyramid levels.

428
00:19:38,143 --> 00:19:40,579
And I say, well, you know, we're
actually doing pretty good,

429
00:19:40,579 --> 00:19:42,813
we have a large
amount of hashes,

430
00:19:42,814 --> 00:19:45,617
we have some IPs and
domains and artifacts,

431
00:19:45,617 --> 00:19:48,620
we even have a fair
amount of TTPs,

432
00:19:48,620 --> 00:19:51,756
we don't know that much about
their exact tool set, though.

433
00:19:51,757 --> 00:19:54,092
Which is unusual, 'cause
we have a lot of hashes,

434
00:19:54,092 --> 00:19:56,261
presumably hashes
of their tools.

435
00:19:56,261 --> 00:19:58,330
So it may indicate
that there's some more

436
00:19:58,330 --> 00:20:00,365
digging we could
do in their tools

437
00:20:00,365 --> 00:20:02,467
to find out more
information about them,

438
00:20:02,467 --> 00:20:04,736
like jar rules, or you know,

439
00:20:04,736 --> 00:20:07,706
something else that we could
do to detect the tool itself,

440
00:20:07,706 --> 00:20:09,741
rather than just
the use of the tool.

441
00:20:12,477 --> 00:20:16,448
But I wasn't too
exactly happy with that,

442
00:20:17,616 --> 00:20:19,084
those previous two
visualizations,

443
00:20:19,084 --> 00:20:20,552
so I decided to combine them.

444
00:20:21,887 --> 00:20:23,554
If I have a heat map here

445
00:20:23,555 --> 00:20:26,091
that basically has both
of those at the same time,

446
00:20:26,091 --> 00:20:29,328
and you have the attack
lifecycle on the bottom,

447
00:20:29,328 --> 00:20:31,930
and the pyramid of
pain on the left.

448
00:20:33,765 --> 00:20:36,735
And both of these models
are inherently ordered,

449
00:20:36,735 --> 00:20:38,003
which is important,

450
00:20:38,003 --> 00:20:39,972
because it lets you
know things like,

451
00:20:39,972 --> 00:20:41,406
this is a good section

452
00:20:41,406 --> 00:20:44,976
because it's at the top
of the pyramid of pain,

453
00:20:44,977 --> 00:20:47,346
you would like to
have more artifacts,

454
00:20:47,346 --> 00:20:48,847
tools and TTPs.

455
00:20:49,748 --> 00:20:51,283
This is a good section,

456
00:20:51,283 --> 00:20:53,885
because it's near the end
of the attack lifecycle,

457
00:20:53,885 --> 00:20:55,153
or the kill chain,

458
00:20:55,153 --> 00:20:58,023
so your information

459
00:20:58,023 --> 00:21:00,024
is inherently more
valuable to you,

460
00:21:00,025 --> 00:21:01,760
because the things that
you're going to be able

461
00:21:01,760 --> 00:21:03,595
to detect and respond to

462
00:21:03,595 --> 00:21:06,098
are inherently more damaging
to you at that level.

463
00:21:07,266 --> 00:21:08,500
And then this right
here is the best,

464
00:21:08,500 --> 00:21:10,135
because it's the
overlap of those.

465
00:21:10,135 --> 00:21:13,138
But compare where we are

466
00:21:14,273 --> 00:21:16,675
with the good and the
good and the best,

467
00:21:16,675 --> 00:21:18,510
we have some in each of those,

468
00:21:18,510 --> 00:21:20,712
so that's great, but the
majority of our stuff

469
00:21:20,712 --> 00:21:23,949
is here on the bottom
and the middle, right?

470
00:21:23,949 --> 00:21:27,919
It's hashes for delivery
and exploitation.

471
00:21:27,919 --> 00:21:30,055
And by the way, that's a,

472
00:21:30,055 --> 00:21:33,859
combining these two gives
you a lot better visibility

473
00:21:33,859 --> 00:21:36,194
into what you're
actually collecting

474
00:21:36,194 --> 00:21:40,532
than even looking at the two
heat maps individually did,

475
00:21:40,532 --> 00:21:41,800
because it jumps out,

476
00:21:41,800 --> 00:21:45,704
like it's hashes in
delivery and exploit.

477
00:21:45,704 --> 00:21:48,974
We also have some artifacts
in the delivery section,

478
00:21:48,974 --> 00:21:50,742
that's our strengths.

479
00:21:50,742 --> 00:21:55,180
We have a few, and some
TTPs, even in the best area,

480
00:21:55,180 --> 00:21:57,983
but we could do a
little bit better there.

481
00:21:57,983 --> 00:22:00,217
But remember, I also want
to answer some questions

482
00:22:00,218 --> 00:22:03,588
about the age of
our intelligence.

483
00:22:03,588 --> 00:22:06,858
So what I did was I took
all of the collected data,

484
00:22:06,858 --> 00:22:10,062
it says IOCs, but it's
also IOCs plus TTPs.

485
00:22:11,129 --> 00:22:13,298
And I put him into a plot,

486
00:22:13,298 --> 00:22:15,267
just to see how
old that data was.

487
00:22:15,267 --> 00:22:18,670
I basically subtracted
the dates, the day's date,

488
00:22:18,670 --> 00:22:23,008
and I said, you know, this
thing is now 200 days old,

489
00:22:23,008 --> 00:22:25,377
rather than the
actual date, right?

490
00:22:25,377 --> 00:22:27,713
And then I made this box plot,

491
00:22:27,713 --> 00:22:30,514
and if you're not familiar
with reading box plots,

492
00:22:30,515 --> 00:22:32,050
the critical things to know are,

493
00:22:32,050 --> 00:22:35,419
this is the location
of the oldest data.

494
00:22:36,355 --> 00:22:39,658
So I don't know, 500 days,

495
00:22:39,658 --> 00:22:40,926
something like that.

496
00:22:40,926 --> 00:22:42,327
This is the location
of the newest data,

497
00:22:42,327 --> 00:22:43,929
which was pretty close to zero,

498
00:22:43,929 --> 00:22:47,366
so we must have just
collected it when we exported.

499
00:22:47,366 --> 00:22:49,267
And this is the median,

500
00:22:49,267 --> 00:22:51,970
so exactly half of your data
points would be above it

501
00:22:51,970 --> 00:22:52,938
and half below it.

502
00:22:55,107 --> 00:22:57,142
And that whole shaded
area in the middle

503
00:22:57,142 --> 00:22:59,378
is basically the middle
half of your data.

504
00:22:59,378 --> 00:23:02,581
So looking at this, I
can tell for example,

505
00:23:02,581 --> 00:23:06,351
that the median is about 150,

506
00:23:06,351 --> 00:23:10,122
or 180 days old, so
roughly three months.

507
00:23:10,122 --> 00:23:12,724
So we have pretty current data.

508
00:23:12,724 --> 00:23:15,961
But we do have data going
back over a year and a half.

509
00:23:17,162 --> 00:23:19,965
So we also do have
some historic data

510
00:23:19,965 --> 00:23:22,701
to be able to compare that to.

511
00:23:22,701 --> 00:23:25,203
So this is actually
pretty decent.

512
00:23:25,203 --> 00:23:28,907
It's not the only way
that this graph would look

513
00:23:28,907 --> 00:23:30,207
to be a pretty decent graph,

514
00:23:30,208 --> 00:23:31,777
but this graph is pretty decent.

515
00:23:31,777 --> 00:23:33,645
I also, just for fun,

516
00:23:33,645 --> 00:23:35,480
to see if it would show
me anything useful,

517
00:23:35,480 --> 00:23:39,384
is I took a random sample
of the IOCs that we had,

518
00:23:39,384 --> 00:23:41,186
and it's important that
it needs to be random.

519
00:23:41,186 --> 00:23:44,289
And I plotted the actual dates,

520
00:23:44,289 --> 00:23:47,058
sorry, the days old on the left,

521
00:23:50,028 --> 00:23:52,397
just to see if it would
show me interesting things.

522
00:23:52,397 --> 00:23:56,735
And it does, it actually shows
me the pattern of collection.

523
00:23:56,735 --> 00:23:58,035
It doesn't necessarily mean

524
00:23:58,036 --> 00:24:00,705
the amount of work
we were spending,

525
00:24:00,705 --> 00:24:03,675
maybe IOCs were not available,

526
00:24:03,675 --> 00:24:06,978
new IOCs were not available
in the white areas.

527
00:24:06,978 --> 00:24:09,681
But maybe we didn't collect

528
00:24:09,681 --> 00:24:10,949
because we didn't feel like it,

529
00:24:10,949 --> 00:24:13,652
or we forgot or
something, I don't know.

530
00:24:13,652 --> 00:24:16,054
But we had some big
gap here at the top,

531
00:24:16,054 --> 00:24:19,491
but we had a pretty relatively

532
00:24:19,491 --> 00:24:21,993
good pattern of
repeated collection

533
00:24:21,993 --> 00:24:23,528
starting at like a year ago,

534
00:24:23,528 --> 00:24:25,063
and you can see the banding,

535
00:24:25,063 --> 00:24:27,699
so you can actually kind of
like see when the CTI team

536
00:24:27,699 --> 00:24:30,268
was able to collect more
and when they were not.

537
00:24:30,268 --> 00:24:35,207
But as a repeatable pattern,

538
00:24:35,207 --> 00:24:36,908
you can see that
they've basically been

539
00:24:36,908 --> 00:24:39,343
collecting on this
adversary for a while now.

540
00:24:40,445 --> 00:24:42,714
And I did the same thing,

541
00:24:42,714 --> 00:24:45,317
broken down by the
attack lifecycle,

542
00:24:45,317 --> 00:24:47,085
just to see what
it would tell me.

543
00:24:49,154 --> 00:24:50,822
I think in general,

544
00:24:52,924 --> 00:24:55,760
this graph is okay.

545
00:24:55,760 --> 00:24:59,397
You can see like a lot
of our exploit stuff

546
00:24:59,397 --> 00:25:03,368
trends older, the median
is way, way higher.

547
00:25:03,368 --> 00:25:06,771
But we do have a lot
more recent stuff,

548
00:25:06,771 --> 00:25:08,540
most of our stuff is recent.

549
00:25:08,540 --> 00:25:11,543
So we have, I mean, we have
a lot of recent things,

550
00:25:11,543 --> 00:25:15,514
but we also have a
pretty good history there

551
00:25:15,514 --> 00:25:17,415
for how they do
the exploit step.

552
00:25:18,517 --> 00:25:20,986
I think our control,
mana control,

553
00:25:20,986 --> 00:25:23,188
is probably darn near perfect.

554
00:25:24,189 --> 00:25:25,991
Because we have,

555
00:25:29,060 --> 00:25:31,263
not quite a year of
continual information

556
00:25:31,263 --> 00:25:33,098
about their command and control.

557
00:25:33,098 --> 00:25:35,600
But we have probably
like nine months

558
00:25:35,600 --> 00:25:37,168
or something like that.

559
00:25:37,168 --> 00:25:38,969
But a lot of it is very recent.

560
00:25:40,105 --> 00:25:42,107
It turns out a lot of the things

561
00:25:42,107 --> 00:25:44,042
that we had in
the execute phase,

562
00:25:44,042 --> 00:25:45,776
like everything we had
in the execute phase

563
00:25:45,777 --> 00:25:48,547
was a undated behavior.

564
00:25:48,547 --> 00:25:50,615
So we had entries,

565
00:25:50,615 --> 00:25:52,284
but I couldn't plot
them on the graph

566
00:25:52,284 --> 00:25:53,518
because there was no date,

567
00:25:53,518 --> 00:25:55,020
so I didn't know
how old they were.

568
00:25:55,020 --> 00:25:56,521
So there's a gap there, right?

569
00:25:56,521 --> 00:25:58,790
And we did the same thing by
the pyramid of pain level.

570
00:25:58,790 --> 00:26:00,325
The pyramid of pain level,

571
00:26:00,325 --> 00:26:03,361
I think is a little bit even
more important to do this with

572
00:26:03,361 --> 00:26:07,132
because the volatility
implied by each of the layers

573
00:26:07,132 --> 00:26:10,569
shows you how important that is

574
00:26:10,569 --> 00:26:12,303
for that layer to be fresh.

575
00:26:12,304 --> 00:26:14,339
So like we have a
lot of old hashes,

576
00:26:14,339 --> 00:26:17,708
an old hash is like the
saddest thing in CTI.

577
00:26:17,709 --> 00:26:19,411
(audience laughing)

578
00:26:19,411 --> 00:26:22,447
It is not useful for anybody,

579
00:26:22,447 --> 00:26:24,882
except if you're gonna
go digging through

580
00:26:24,883 --> 00:26:28,153
the cyber paleo
archeology stuff.

581
00:26:28,153 --> 00:26:29,888
But for detection and
response purposes,

582
00:26:29,888 --> 00:26:31,656
it's not useful at all.

583
00:26:31,656 --> 00:26:35,092
But then again, we do have
some fairly fresh data

584
00:26:35,093 --> 00:26:38,063
in like the domain
names and stuff.

585
00:26:38,063 --> 00:26:41,032
And we even have this
untracked category of other,

586
00:26:41,032 --> 00:26:42,434
where it was something
that we were tracking,

587
00:26:42,434 --> 00:26:44,703
and it didn't fall
directly into the pyramid.

588
00:26:46,204 --> 00:26:47,504
So the lower the level,

589
00:26:47,505 --> 00:26:50,508
the closer you are on
the left to this graph,

590
00:26:50,508 --> 00:26:54,212
the more new you would want
your indicators to skew.

591
00:26:56,548 --> 00:26:59,484
And finally, this is actually
a slide that I don't like.

592
00:26:59,484 --> 00:27:01,151
But I wanted to
visualize all the things,

593
00:27:01,152 --> 00:27:03,221
and so the behaviors
were all the things,

594
00:27:03,221 --> 00:27:06,124
I kind, I almost
didn't show this one.

595
00:27:06,124 --> 00:27:08,893
But this is a extract
from the attack navigator

596
00:27:08,893 --> 00:27:11,129
that the attack team puts out,

597
00:27:11,129 --> 00:27:14,264
where I took all of the
TTPs that I had extracted,

598
00:27:14,265 --> 00:27:16,267
all the behaviors,
and I mapped them.

599
00:27:16,267 --> 00:27:19,738
And I made a visualization.

600
00:27:20,905 --> 00:27:22,774
I don't know if you can extract

601
00:27:22,774 --> 00:27:27,779
very much good info out
of this visualization,

602
00:27:28,947 --> 00:27:30,649
because there's a
couple things, one,

603
00:27:30,649 --> 00:27:33,385
and this part in the matrix,
Katie is absolutely right,

604
00:27:33,385 --> 00:27:35,787
when she tells me,
nothing is more important

605
00:27:35,787 --> 00:27:37,422
than any other column, right?

606
00:27:37,422 --> 00:27:39,190
They're not ordered.

607
00:27:39,190 --> 00:27:41,893
So you can't say things
on the right are better

608
00:27:41,893 --> 00:27:43,662
or things on the
left are better,

609
00:27:43,662 --> 00:27:46,097
and you can't say
things on the bottom

610
00:27:46,097 --> 00:27:49,200
or things on the top are
better, they just are.

611
00:27:49,200 --> 00:27:51,603
Also, when you have, you know,

612
00:27:51,603 --> 00:27:53,438
colored things that you know,

613
00:27:53,438 --> 00:27:56,675
then you naturally have a
lot of uncolored white things

614
00:27:56,675 --> 00:27:57,942
that you don't know.

615
00:27:57,942 --> 00:28:02,280
And you might be tempted
to consider those gaps.

616
00:28:02,280 --> 00:28:03,782
But they're not,

617
00:28:03,782 --> 00:28:05,817
because this is a category
of every possible thing

618
00:28:05,817 --> 00:28:08,286
that could happen
or could be done.

619
00:28:08,286 --> 00:28:10,655
And we don't know
that the threat actor

620
00:28:10,655 --> 00:28:13,425
does any of those white things.

621
00:28:13,425 --> 00:28:16,728
So they're not known unknowns,

622
00:28:16,728 --> 00:28:18,229
they're unknown unknowns.

623
00:28:19,631 --> 00:28:22,867
And you cannot really
get too much out of this,

624
00:28:22,867 --> 00:28:25,336
except for, if you
look closely here,

625
00:28:25,336 --> 00:28:27,272
you'll see there's one column.

626
00:28:27,272 --> 00:28:28,773
I know you can't read it,

627
00:28:28,773 --> 00:28:30,774
there's one column that I
don't have anything for.

628
00:28:30,775 --> 00:28:33,044
Turns out that column
is exfiltration.

629
00:28:35,080 --> 00:28:38,116
My threat actor probably wants
the fruits of their labor.

630
00:28:38,116 --> 00:28:42,020
I'm pretty sure they know
some way to do exfiltration,

631
00:28:42,020 --> 00:28:43,555
we just don't apparently
know what it is.

632
00:28:43,555 --> 00:28:48,493
So we did find a, you
know, an insight from here.

633
00:28:48,493 --> 00:28:50,227
I don't really
personally like this way,

634
00:28:50,228 --> 00:28:51,930
I don't know of
a better way yet,

635
00:28:51,930 --> 00:28:53,164
but my CISO loved it.

636
00:28:54,499 --> 00:28:55,700
Some of the key challenges

637
00:28:55,700 --> 00:28:57,302
I wanted to talk about
when we did this,

638
00:28:57,302 --> 00:29:00,105
I said the CTI data was
in multiple repositories.

639
00:29:00,105 --> 00:29:02,173
So we ended up doing a lot of

640
00:29:02,173 --> 00:29:05,543
custom Python code
to extract it.

641
00:29:05,543 --> 00:29:08,045
Each repository
had its own module.

642
00:29:08,046 --> 00:29:12,050
And then we, I
read a lot of data

643
00:29:12,050 --> 00:29:15,687
in English text and
extracted it into Excel.

644
00:29:15,687 --> 00:29:19,823
We also had the
inconsistencies in the data

645
00:29:19,824 --> 00:29:21,960
that was tracked
by each repository,

646
00:29:21,960 --> 00:29:23,228
especially the ones that

647
00:29:23,228 --> 00:29:25,430
looked like they were
the same but weren't.

648
00:29:25,430 --> 00:29:28,733
And because a lot of these
were in house developed tools,

649
00:29:30,135 --> 00:29:31,736
we didn't really
have documentation

650
00:29:31,736 --> 00:29:33,171
on what all these things were,

651
00:29:33,171 --> 00:29:35,440
so it wasn't always obvious
that I had a mismatch,

652
00:29:35,440 --> 00:29:37,842
and we kind of had to find
some of these by accident

653
00:29:37,842 --> 00:29:40,612
before we could
identify them all.

654
00:29:40,612 --> 00:29:43,548
But again, a lot of custom code,

655
00:29:43,548 --> 00:29:44,549
a lot of

656
00:29:46,284 --> 00:29:50,655
estimates and guessing
were involved here

657
00:29:50,655 --> 00:29:54,826
to kind of convert this,
but educated guessing, so.

658
00:29:54,826 --> 00:29:59,397
And then converting
our one time analysis

659
00:29:59,397 --> 00:30:02,600
to something that we could
do on a regular basis

660
00:30:02,600 --> 00:30:04,135
is something that we
still have ongoing,

661
00:30:04,135 --> 00:30:05,937
we haven't totally solved.

662
00:30:05,937 --> 00:30:09,573
We did all those
things in a Python,

663
00:30:09,574 --> 00:30:12,043
not Python, a Jupyter Notebook,

664
00:30:12,043 --> 00:30:15,213
specifically so that we could
do them again in the future.

665
00:30:15,213 --> 00:30:18,616
But because of the

666
00:30:18,616 --> 00:30:21,452
extreme manualness of
a lot of the phases

667
00:30:21,452 --> 00:30:22,587
that we went through,

668
00:30:22,587 --> 00:30:25,523
we are not quite
able to do that.

669
00:30:25,523 --> 00:30:27,391
It's something that
we really want to do

670
00:30:27,392 --> 00:30:29,160
and something that right now,

671
00:30:30,562 --> 00:30:32,597
the intel teams are digesting

672
00:30:32,597 --> 00:30:35,466
and kind of considering
how they can

673
00:30:35,466 --> 00:30:38,101
make some changes
to support this,

674
00:30:38,102 --> 00:30:40,004
because I think we realized that

675
00:30:40,004 --> 00:30:42,841
this is an important
way that we can know

676
00:30:42,841 --> 00:30:45,976
if we're doing a good job
that we couldn't know before.

677
00:30:45,977 --> 00:30:49,314
And we would like to do
this on some regular basis,

678
00:30:49,314 --> 00:30:51,482
monthly, quarterly or whatever,

679
00:30:51,482 --> 00:30:53,818
for our priority threat actors.

680
00:30:53,818 --> 00:30:55,987
Just to give us a
snapshot of where we are,

681
00:30:55,987 --> 00:30:57,355
we can compare that snapshot

682
00:30:57,355 --> 00:30:59,390
to the past to see
if we've improved,

683
00:30:59,390 --> 00:31:00,692
and we can look at that snapshot

684
00:31:00,692 --> 00:31:03,228
to see what we need
to do in the future.

685
00:31:03,228 --> 00:31:05,897
So real quick, since I'm
actually out of time,

686
00:31:05,897 --> 00:31:07,564
I'll go through
my takeaways here.

687
00:31:07,565 --> 00:31:10,235
Start with identifying
your key threat actors.

688
00:31:10,235 --> 00:31:11,735
This is CTI Summit,

689
00:31:11,736 --> 00:31:15,039
so maybe most of you probably
know your key threat actors.

690
00:31:16,641 --> 00:31:18,743
Where is all that data stored,

691
00:31:18,743 --> 00:31:22,780
and make sure you know what
data stored, what it means.

692
00:31:22,780 --> 00:31:25,383
How to interpret that
timestamp, for example, right?

693
00:31:27,252 --> 00:31:30,021
Expect to spend most of
your time extracting,

694
00:31:30,021 --> 00:31:32,624
cleaning up and
deduplicating that data,

695
00:31:32,624 --> 00:31:35,860
unless you are in the fortunate,

696
00:31:35,860 --> 00:31:38,795
fortunate spot of having
everything all in one tip.

697
00:31:38,796 --> 00:31:41,432
And even then, you're
gonna have to clean,

698
00:31:41,432 --> 00:31:44,269
merge and deduplicate, you just
haven't figured it out yet.

699
00:31:45,870 --> 00:31:49,741
And pick your favorite
attack lifecycle,

700
00:31:49,741 --> 00:31:52,277
and pick the pyramid of pain.

701
00:31:52,277 --> 00:31:55,613
(audience laughing)

702
00:31:55,613 --> 00:31:58,616
And map your IOCs and
your TTPs to those.

703
00:31:58,616 --> 00:32:00,151
We didn't do those individually,

704
00:32:00,151 --> 00:32:02,720
we had data about
classification,

705
00:32:02,720 --> 00:32:04,255
basically of each one of those,

706
00:32:04,255 --> 00:32:06,891
so we map the classification
of the IOCs to the pyramid,

707
00:32:06,891 --> 00:32:10,828
and therefore we're able to
do it pretty easily en masse.

708
00:32:11,963 --> 00:32:14,599
And then visualize
to identify the gaps.

709
00:32:16,034 --> 00:32:19,170
Because that is in fact
the point of this process.

710
00:32:19,170 --> 00:32:21,606
I will say we also
extracted some numbers

711
00:32:21,606 --> 00:32:23,241
and tables of things,

712
00:32:24,542 --> 00:32:28,679
but really the visualizations
were the key for us.

713
00:32:28,680 --> 00:32:31,316
And then automate it
so that you can do it

714
00:32:31,316 --> 00:32:33,518
on a schedule and ad hoc,

715
00:32:33,518 --> 00:32:35,553
so that you can
do this quarterly,

716
00:32:35,553 --> 00:32:37,689
roll up of how you're doing
with all your threat actors

717
00:32:37,689 --> 00:32:39,223
that you care about the most.

718
00:32:39,223 --> 00:32:42,293
And anytime your CISO or
anybody comes and says,

719
00:32:42,293 --> 00:32:44,928
I need to know how we're doing
against this threat actor,

720
00:32:44,929 --> 00:32:47,732
you can tell them
in five minutes

721
00:32:47,732 --> 00:32:50,568
rather than five weeks.

722
00:32:50,568 --> 00:32:52,203
And that's it.

723
00:32:52,203 --> 00:32:55,340
(audience applauding)

724
00:32:58,076 --> 00:33:01,079
(gentle piano music)

725
00:33:10,755 --> 00:33:13,925
(electronic thudding)

