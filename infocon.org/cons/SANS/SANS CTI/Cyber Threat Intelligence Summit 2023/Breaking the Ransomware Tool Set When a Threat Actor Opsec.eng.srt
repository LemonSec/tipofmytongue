1
00:00:00,659 --> 00:00:02,900
foreign

2
00:00:11,000 --> 00:00:13,620
based in Stockholm Sweden

3
00:00:13,620 --> 00:00:16,580
where I do malware analysis

4
00:00:16,580 --> 00:00:19,260
and this sort of you know being a member

5
00:00:19,260 --> 00:00:21,480
analysis I take part in a bunch of

6
00:00:21,480 --> 00:00:23,580
Internet response cases and this is

7
00:00:23,580 --> 00:00:25,500
actually going to be a case study from

8
00:00:25,500 --> 00:00:28,199
one of the instant response we did where

9
00:00:28,199 --> 00:00:30,599
the threat actor did a major opsec

10
00:00:30,599 --> 00:00:33,840
failure and sort of this

11
00:00:33,840 --> 00:00:36,660
uh how sort of I'll try to show how how

12
00:00:36,660 --> 00:00:38,940
malware analysis led to threat

13
00:00:38,940 --> 00:00:42,180
intelligence and how we buy threat

14
00:00:42,180 --> 00:00:44,160
intelligence discover their backup door

15
00:00:44,160 --> 00:00:46,440
into the system and so we can throw them

16
00:00:46,440 --> 00:00:48,539
out so if you stick with me till the end

17
00:00:48,539 --> 00:00:50,520
I will sort of reveal that sort of the

18
00:00:50,520 --> 00:00:53,280
sort of how we found our backup stuff

19
00:00:53,280 --> 00:00:54,719
and

20
00:00:54,719 --> 00:00:56,180
and how we did

21
00:00:56,180 --> 00:01:00,180
uh so yeah let's let's kick it off uh if

22
00:01:00,180 --> 00:01:02,879
we can get this rolling and

23
00:01:02,879 --> 00:01:06,659
and uh yeah this is the introduction

24
00:01:06,659 --> 00:01:10,380
slide uh I'm a Marvel analysis this is

25
00:01:10,380 --> 00:01:14,100
the only slide I will show you with with

26
00:01:14,100 --> 00:01:16,920
assembly I promise even though I like

27
00:01:16,920 --> 00:01:19,560
this stuff but sort of uh I will keep it

28
00:01:19,560 --> 00:01:22,439
light but sort of I had this I was sort

29
00:01:22,439 --> 00:01:25,340
of I was engaged in this uh attack

30
00:01:25,340 --> 00:01:28,740
uh with uh this rat that I was trying to

31
00:01:28,740 --> 00:01:30,540
unpack it was a devil it was packed with

32
00:01:30,540 --> 00:01:31,619
Delphi

33
00:01:31,619 --> 00:01:33,780
uh I was actually struggling a little

34
00:01:33,780 --> 00:01:36,840
bit to be honest uh while unpacking it I

35
00:01:36,840 --> 00:01:40,439
found this fantastic string it says http

36
00:01:40,439 --> 00:01:43,500
F and then it was an IP address test

37
00:01:43,500 --> 00:01:47,880
slash list Dot txt and I was like hmm

38
00:01:47,880 --> 00:01:50,579
this sounds very interesting now this is

39
00:01:50,579 --> 00:01:53,100
is it too obvious like

40
00:01:53,100 --> 00:01:55,439
is it a trap I don't know you know it's

41
00:01:55,439 --> 00:01:58,020
how do I deal with this it's like what

42
00:01:58,020 --> 00:02:00,960
could it be uh sort of you know I'm not

43
00:02:00,960 --> 00:02:02,100
sort of

44
00:02:02,100 --> 00:02:05,460
I try to keep my upset so and also you

45
00:02:05,460 --> 00:02:07,380
know not try to impact myself as well

46
00:02:07,380 --> 00:02:09,479
you know dealing with with the threat

47
00:02:09,479 --> 00:02:12,540
actors actors I sort of

48
00:02:12,540 --> 00:02:14,459
go through command line and list yes

49
00:02:14,459 --> 00:02:16,819
download this and see okay what was it

50
00:02:16,819 --> 00:02:21,120
and uh behold it was like oh it is a big

51
00:02:21,120 --> 00:02:24,720
bunch of stuff that looks interesting

52
00:02:24,720 --> 00:02:29,520
hmm let's take a deeper look at this and

53
00:02:29,520 --> 00:02:33,060
it was an open directory with the

54
00:02:33,060 --> 00:02:35,760
tracked actors tooling and I was like

55
00:02:35,760 --> 00:02:38,879
this is amazing this is amazing let's

56
00:02:38,879 --> 00:02:41,459
you know let's download everything and

57
00:02:41,459 --> 00:02:42,720
this was roughly

58
00:02:42,720 --> 00:02:46,379
five gigabytes of different stuff like

59
00:02:46,379 --> 00:02:49,739
ordered uh in a sort of a

60
00:02:49,739 --> 00:02:53,519
fairly structural way and what I did is

61
00:02:53,519 --> 00:02:55,680
that I started to looking through these

62
00:02:55,680 --> 00:02:58,319
tools and see okay can we get any sort

63
00:02:58,319 --> 00:03:01,860
of insights to the the attack that was

64
00:03:01,860 --> 00:03:03,920
going on

65
00:03:03,920 --> 00:03:08,340
and uh yeah a gold mine a gold mine like

66
00:03:08,340 --> 00:03:10,260
they had left their open directory

67
00:03:10,260 --> 00:03:12,959
within the rat so I could download it so

68
00:03:12,959 --> 00:03:17,519
I would say that's a major epic epic uh

69
00:03:17,519 --> 00:03:19,860
optic fail and you will see in the end

70
00:03:19,860 --> 00:03:22,379
why this Optics fail for us Defenders

71
00:03:22,379 --> 00:03:24,420
blue teamers watch such a good good

72
00:03:24,420 --> 00:03:26,220
thingy and also for this this how we

73
00:03:26,220 --> 00:03:28,080
kind of crack this whole case within

74
00:03:28,080 --> 00:03:31,440
within the ire and uh

75
00:03:31,440 --> 00:03:33,360
I have blipped some of the stuff you

76
00:03:33,360 --> 00:03:35,459
know threat actors might not be so so

77
00:03:35,459 --> 00:03:39,480
you know well spoken so they had this uh

78
00:03:39,480 --> 00:03:43,200
folder called AV F something and within

79
00:03:43,200 --> 00:03:44,940
that they had this kind of a bat file

80
00:03:44,940 --> 00:03:47,879
and a reg file and a vve file so yeah

81
00:03:47,879 --> 00:03:52,260
yes yes that digging into this and the

82
00:03:52,260 --> 00:03:54,420
first bat file it had this content to it

83
00:03:54,420 --> 00:03:56,700
and it was actually deleting Shadow

84
00:03:56,700 --> 00:03:58,620
copies and if you have looked at

85
00:03:58,620 --> 00:04:00,120
transfer they always shoot this stuff

86
00:04:00,120 --> 00:04:03,060
away uh this chat actor didn't like when

87
00:04:03,060 --> 00:04:05,400
we actually came into this instant they

88
00:04:05,400 --> 00:04:06,840
hadn't ran somewhere they were like on

89
00:04:06,840 --> 00:04:08,640
the verge of doing it but we kind of

90
00:04:08,640 --> 00:04:11,340
stopped them in doing this and they

91
00:04:11,340 --> 00:04:12,780
didn't we didn't find it around so but

92
00:04:12,780 --> 00:04:14,819
had this kind of uh crypto Locker like

93
00:04:14,819 --> 00:04:16,940
this kind of BitLocker

94
00:04:16,940 --> 00:04:19,380
knockoffs that they had in in there as

95
00:04:19,380 --> 00:04:22,320
well so they had all these kind of

96
00:04:22,320 --> 00:04:25,080
commands uh inscriptions that sort of

97
00:04:25,080 --> 00:04:26,699
which gave us an interesting insight to

98
00:04:26,699 --> 00:04:28,979
this as well so this was like you know

99
00:04:28,979 --> 00:04:32,940
uh Delete shadowing you know uh

100
00:04:32,940 --> 00:04:35,720
close the Explorer and put it up again

101
00:04:35,720 --> 00:04:38,940
uh and then delete things just sort of

102
00:04:38,940 --> 00:04:41,060
you know try try to it would be

103
00:04:41,060 --> 00:04:43,979
semi-stealthy uh some of the more

104
00:04:43,979 --> 00:04:46,440
scripts they had is to disable

105
00:04:46,440 --> 00:04:49,560
uh Defender and they had like

106
00:04:49,560 --> 00:04:52,199
a bunch of them so

107
00:04:52,199 --> 00:04:53,759
like when you do when you look at

108
00:04:53,759 --> 00:04:55,199
ransomware you always see this kind of

109
00:04:55,199 --> 00:04:56,820
commands shooting out then this you know

110
00:04:56,820 --> 00:04:58,440
we got them all gathered now which kind

111
00:04:58,440 --> 00:05:00,540
of it was interesting yeah I think you

112
00:05:00,540 --> 00:05:02,040
will have this live softwares if you

113
00:05:02,040 --> 00:05:03,300
want to have a look and it's and this

114
00:05:03,300 --> 00:05:05,520
will also say like from harmonic

115
00:05:05,520 --> 00:05:07,800
monitoring Precision like if you see any

116
00:05:07,800 --> 00:05:09,780
of these commands commands firing off

117
00:05:09,780 --> 00:05:12,060
and it's sort of not expected

118
00:05:12,060 --> 00:05:13,680
you know that you should probably go

119
00:05:13,680 --> 00:05:16,560
straight into instrument response

120
00:05:16,560 --> 00:05:19,740
uh we also had this vbe script and sort

121
00:05:19,740 --> 00:05:22,500
of when you look at it just you know

122
00:05:22,500 --> 00:05:24,720
straight to it it has sort of it looks

123
00:05:24,720 --> 00:05:26,960
like it's like encoded

124
00:05:26,960 --> 00:05:30,780
but if if you don't know the the this

125
00:05:30,780 --> 00:05:32,820
great Belgian

126
00:05:32,820 --> 00:05:35,300
researcher called DDR Stefan

127
00:05:35,300 --> 00:05:39,419
edius Stevens he like if if something is

128
00:05:39,419 --> 00:05:41,699
encoded or encrypted in some kind of way

129
00:05:41,699 --> 00:05:45,120
Google ddsd events and Tool because he

130
00:05:45,120 --> 00:05:47,039
has like 100 different tools and of

131
00:05:47,039 --> 00:05:49,400
course he had a VB

132
00:05:49,400 --> 00:05:53,280
the coder as well and this is um

133
00:05:53,280 --> 00:05:56,820
another way to try to with sort of by

134
00:05:56,820 --> 00:05:58,380
starting vscript and then starting

135
00:05:58,380 --> 00:06:01,800
Powershell and then to disable uh

136
00:06:01,800 --> 00:06:04,320
AV as well so there was another another

137
00:06:04,320 --> 00:06:08,360
variation of disabling the AV

138
00:06:08,360 --> 00:06:11,340
uh they also had this kind of uh bath

139
00:06:11,340 --> 00:06:15,060
thingy uh another another folder so I

140
00:06:15,060 --> 00:06:16,500
had this kind of stopping different

141
00:06:16,500 --> 00:06:19,680
Services uh this we usually see when we

142
00:06:19,680 --> 00:06:21,240
stopping you know step into to

143
00:06:21,240 --> 00:06:23,699
ransomware cases that they

144
00:06:23,699 --> 00:06:25,560
they like to stop some Services before

145
00:06:25,560 --> 00:06:28,380
they encrypt so uh so they don't destroy

146
00:06:28,380 --> 00:06:30,660
them so like in SQL Server if you know

147
00:06:30,660 --> 00:06:32,880
just encrypt it straight away it sort of

148
00:06:32,880 --> 00:06:35,460
is like putting in the rear gear uh at

149
00:06:35,460 --> 00:06:37,440
the highway uh so they want to stop it

150
00:06:37,440 --> 00:06:40,440
before but sort of uh here like they

151
00:06:40,440 --> 00:06:42,180
left the scripts behind so you know for

152
00:06:42,180 --> 00:06:43,979
us to see all this like the same with

153
00:06:43,979 --> 00:06:45,860
like from from a

154
00:06:45,860 --> 00:06:48,180
defender's point of view

155
00:06:48,180 --> 00:06:50,220
if you ever see this stuff running in

156
00:06:50,220 --> 00:06:52,199
your environment there's also like this

157
00:06:52,199 --> 00:06:54,300
would I want to say go straight to IR

158
00:06:54,300 --> 00:06:56,100
but you know definitely look into them

159
00:06:56,100 --> 00:06:57,660
so you know you can have all these

160
00:06:57,660 --> 00:06:59,160
slides and like all this if you see

161
00:06:59,160 --> 00:07:00,960
these commands firing off I mean that's

162
00:07:00,960 --> 00:07:04,259
that's something to to investigate

163
00:07:04,259 --> 00:07:06,900
um oops let's see uh we'll speak too

164
00:07:06,900 --> 00:07:09,000
quickly sorry and also

165
00:07:09,000 --> 00:07:11,580
threat actors they love to delete

166
00:07:11,580 --> 00:07:13,800
startup copies

167
00:07:13,800 --> 00:07:15,240
um so they had a bunch of different

168
00:07:15,240 --> 00:07:18,060
scripts how how they sort of

169
00:07:18,060 --> 00:07:21,479
utilize this then uh I like the middle

170
00:07:21,479 --> 00:07:23,160
one because like they really want to

171
00:07:23,160 --> 00:07:24,780
delete Shadow copies

172
00:07:24,780 --> 00:07:26,400
and uh

173
00:07:26,400 --> 00:07:28,319
yeah this is also used like when you see

174
00:07:28,319 --> 00:07:30,300
ransomware this kind of commands is

175
00:07:30,300 --> 00:07:32,280
built in but now they were not using

176
00:07:32,280 --> 00:07:33,360
ransomware they wouldn't want like

177
00:07:33,360 --> 00:07:36,060
encryption or file system that all this

178
00:07:36,060 --> 00:07:40,199
this uh scripts as well so uh as well if

179
00:07:40,199 --> 00:07:41,400
you see the stuff running you know

180
00:07:41,400 --> 00:07:43,199
that's probably something bad is going

181
00:07:43,199 --> 00:07:44,699
on so

182
00:07:44,699 --> 00:07:47,460
but so moving on to more of the tools

183
00:07:47,460 --> 00:07:49,560
they had they had this kind of thingy

184
00:07:49,560 --> 00:07:52,199
called clear Ed the first one that was

185
00:07:52,199 --> 00:07:54,060
actually a script as well

186
00:07:54,060 --> 00:07:55,919
um of course there was more a lot of

187
00:07:55,919 --> 00:07:58,160
copy deleting but it was also this

188
00:07:58,160 --> 00:08:02,400
tooling to delete event logs so I mean

189
00:08:02,400 --> 00:08:04,080
all of this stuff I think is good to

190
00:08:04,080 --> 00:08:06,180
keep track on if if this if you know in

191
00:08:06,180 --> 00:08:07,680
your inner sock if this thought

192
00:08:07,680 --> 00:08:10,560
monitoring it's bad thing happening but

193
00:08:10,560 --> 00:08:13,500
uh if we'll start looking at the tools

194
00:08:13,500 --> 00:08:18,060
I found this tool called clear lock

195
00:08:18,060 --> 00:08:20,039
um okay what's clear look for me I've

196
00:08:20,039 --> 00:08:21,419
never heard of this

197
00:08:21,419 --> 00:08:25,080
and clear lock is actually it's sort of

198
00:08:25,080 --> 00:08:28,139
it is a screen Locker

199
00:08:28,139 --> 00:08:30,900
and it has a config file and you can

200
00:08:30,900 --> 00:08:33,779
give it a password so so if I open this

201
00:08:33,779 --> 00:08:36,179
kind of config file and then sort of it

202
00:08:36,179 --> 00:08:37,919
gives me password so then I need to put

203
00:08:37,919 --> 00:08:39,659
in what it does now is sort of it locks

204
00:08:39,659 --> 00:08:42,000
the screen but it's still active in the

205
00:08:42,000 --> 00:08:44,820
background and actually the Dharma runs

206
00:08:44,820 --> 00:08:46,560
we're going they have used this one so

207
00:08:46,560 --> 00:08:49,800
so by sort of locking out the user they

208
00:08:49,800 --> 00:08:52,080
can still do their activity in the

209
00:08:52,080 --> 00:08:55,500
background uh but as a user you need the

210
00:08:55,500 --> 00:08:57,120
password

211
00:08:57,120 --> 00:09:00,839
so uh this because it's sort of if you

212
00:09:00,839 --> 00:09:03,660
go backward to slides here uh you see

213
00:09:03,660 --> 00:09:06,120
here they have this kind of ini file and

214
00:09:06,120 --> 00:09:09,240
you can actually edit this in a file and

215
00:09:09,240 --> 00:09:11,339
which I did and I just put on the

216
00:09:11,339 --> 00:09:13,620
display message Niklas was here so it is

217
00:09:13,620 --> 00:09:15,600
like there's something interacting with

218
00:09:15,600 --> 00:09:17,220
this sort of lock screen

219
00:09:17,220 --> 00:09:21,420
and if you look up up at the top it says

220
00:09:21,420 --> 00:09:23,760
password and then as a looks like

221
00:09:23,760 --> 00:09:26,580
something hexy uh

222
00:09:26,580 --> 00:09:28,860
um okay what's this let's let's have a

223
00:09:28,860 --> 00:09:29,880
look

224
00:09:29,880 --> 00:09:34,980
um this tool was actually written in

225
00:09:34,980 --> 00:09:39,660
in Auto it and if someone wants to know

226
00:09:39,660 --> 00:09:43,140
go into reversing there's a really neat

227
00:09:43,140 --> 00:09:46,740
tool called my output dot my auto to exe

228
00:09:46,740 --> 00:09:51,180
which sort of it takes out the ID binary

229
00:09:51,180 --> 00:09:54,600
and sort of converts it into what looks

230
00:09:54,600 --> 00:09:55,800
like

231
00:09:55,800 --> 00:09:58,320
a proper code or more or less readable

232
00:09:58,320 --> 00:10:02,220
code and within that code we found this

233
00:10:02,220 --> 00:10:05,700
I found this string called Crypt key

234
00:10:05,700 --> 00:10:08,940
with the password I am

235
00:10:08,940 --> 00:10:12,839
Mr dot add exclamation mark and if you

236
00:10:12,839 --> 00:10:15,800
look on on the on the uh

237
00:10:15,800 --> 00:10:18,800
documentation about uh

238
00:10:18,800 --> 00:10:22,080
Auto I.T this is uh the Crypt key is

239
00:10:22,080 --> 00:10:24,180
actually an rc4

240
00:10:24,180 --> 00:10:27,420
uh uh encryption so

241
00:10:27,420 --> 00:10:30,120
if you ever end up with a ransomware

242
00:10:30,120 --> 00:10:33,420
gang that has has

243
00:10:33,420 --> 00:10:36,000
lock this one and if you get get hold of

244
00:10:36,000 --> 00:10:39,720
this config file you can see the the the

245
00:10:39,720 --> 00:10:42,600
password and I am Mr Ed that's the

246
00:10:42,600 --> 00:10:45,240
password so then you can sort of decrypt

247
00:10:45,240 --> 00:10:46,680
this sort of because this is has been

248
00:10:46,680 --> 00:10:49,620
used by by ransomware actors

249
00:10:49,620 --> 00:10:52,680
if we move on sort of also within this

250
00:10:52,680 --> 00:10:54,660
clear lock they had this kind of Easter

251
00:10:54,660 --> 00:10:56,880
egg within it it says like this a

252
00:10:56,880 --> 00:11:00,000
function egg and it has this binary

253
00:11:00,000 --> 00:11:03,480
string uh called uh yeah just a lot of

254
00:11:03,480 --> 00:11:05,040
hex stuff and then sort of course

255
00:11:05,040 --> 00:11:07,560
another hex thingy and and what is this

256
00:11:07,560 --> 00:11:09,180
and then

257
00:11:09,180 --> 00:11:12,959
I put this into cyber chefs uh sort of I

258
00:11:12,959 --> 00:11:15,120
got asked of some of you younger

259
00:11:15,120 --> 00:11:17,160
colleagues like what should you do if

260
00:11:17,160 --> 00:11:19,200
you want to become a reverser or marital

261
00:11:19,200 --> 00:11:21,480
analyst and I would say like cyber chef

262
00:11:21,480 --> 00:11:24,180
and regex that's like super good start

263
00:11:24,180 --> 00:11:26,100
they will be surprised because it's for

264
00:11:26,100 --> 00:11:27,300
something else but

265
00:11:27,300 --> 00:11:29,519
if sort of if I sort of start digging

266
00:11:29,519 --> 00:11:31,260
for this uh

267
00:11:31,260 --> 00:11:33,060
Easter egg and say okay let's convert

268
00:11:33,060 --> 00:11:35,640
this hex stuff to come so actually if

269
00:11:35,640 --> 00:11:38,940
you put in Michelangelo it into this uh

270
00:11:38,940 --> 00:11:41,040
clear lock instead of a password it will

271
00:11:41,040 --> 00:11:43,860
give you back comeback cold cuts that if

272
00:11:43,860 --> 00:11:45,779
you would put in Raphael it would give

273
00:11:45,779 --> 00:11:47,760
you back come back here I'm not finished

274
00:11:47,760 --> 00:11:49,860
with you damn and if you put in Splinter

275
00:11:49,860 --> 00:11:54,480
it will give you kawabanga and uh

276
00:11:54,480 --> 00:11:57,060
some might recognize okay what Easter

277
00:11:57,060 --> 00:12:00,540
egg do this lock screen thingy works it

278
00:12:00,540 --> 00:12:03,480
is actually stuff from Turtles like that

279
00:12:03,480 --> 00:12:07,100
Creator really likes turtles

280
00:12:07,100 --> 00:12:10,200
uh some of the other tools uh this one

281
00:12:10,200 --> 00:12:13,560
was called clearlog by X Ecker and and

282
00:12:13,560 --> 00:12:17,100
it was actually called lsos.exe

283
00:12:17,100 --> 00:12:17,880
um

284
00:12:17,880 --> 00:12:19,920
I have never seen an Alphas looking like

285
00:12:19,920 --> 00:12:21,360
this especially not with Russia and

286
00:12:21,360 --> 00:12:24,740
saying clear log and doing some Googling

287
00:12:24,740 --> 00:12:28,920
uh I actually found the creator of this

288
00:12:28,920 --> 00:12:31,079
called Garden service he was actually

289
00:12:31,079 --> 00:12:33,720
selling this on one of those black the

290
00:12:33,720 --> 00:12:35,399
darknet uh

291
00:12:35,399 --> 00:12:41,360
forums and it actually it is a

292
00:12:42,060 --> 00:12:44,880
sort of a tool a graphical tool to clear

293
00:12:44,880 --> 00:12:48,660
event logs as well uh um sort of by

294
00:12:48,660 --> 00:12:51,120
running it uh

295
00:12:51,120 --> 00:12:54,420
it was actually pumping up a VBS script

296
00:12:54,420 --> 00:12:58,019
and that VBS script goes into to VMI

297
00:12:58,019 --> 00:13:00,180
commands clear in the logs it was like a

298
00:13:00,180 --> 00:13:03,480
GUI click kind of click clear log

299
00:13:03,480 --> 00:13:05,760
tooling for for for

300
00:13:05,760 --> 00:13:08,040
bad active surgery for selling on the

301
00:13:08,040 --> 00:13:10,639
market as well

302
00:13:11,459 --> 00:13:13,920
one of the things I ran into that

303
00:13:13,920 --> 00:13:17,399
actually a bunch of these tooling they

304
00:13:17,399 --> 00:13:20,399
were protected uh by a sip there was

305
00:13:20,399 --> 00:13:22,320
there were zip files that was protected

306
00:13:22,320 --> 00:13:25,920
with a password that I didn't know and I

307
00:13:25,920 --> 00:13:28,800
I couldn't crack it either

308
00:13:28,800 --> 00:13:30,420
so let's like

309
00:13:30,420 --> 00:13:33,660
if I have a flip file that is

310
00:13:33,660 --> 00:13:35,579
protected by password is there another

311
00:13:35,579 --> 00:13:39,360
way I could sort of figure out what kind

312
00:13:39,360 --> 00:13:42,060
of stuff is in it and

313
00:13:42,060 --> 00:13:45,899
you actually kind of you can

314
00:13:45,899 --> 00:13:49,079
the thing is if you look into 7-Zip

315
00:13:49,079 --> 00:13:53,339
uh it has this uh hash thing called

316
00:13:53,339 --> 00:13:54,899
crc32

317
00:13:54,899 --> 00:13:57,839
and that's and that is actually used for

318
00:13:57,839 --> 00:14:00,240
more for the file Integrity let's say

319
00:14:00,240 --> 00:14:03,180
like so make sure that that uh when you

320
00:14:03,180 --> 00:14:05,339
unpack it it's it's the same file as you

321
00:14:05,339 --> 00:14:06,360
packed it

322
00:14:06,360 --> 00:14:11,160
but it is kind of a md5 light

323
00:14:11,160 --> 00:14:13,079
I mean it would be like academically

324
00:14:13,079 --> 00:14:15,420
correct to say it is it is the same file

325
00:14:15,420 --> 00:14:18,300
because that's the same crc32

326
00:14:18,300 --> 00:14:20,760
but if I start looking at the name

327
00:14:20,760 --> 00:14:23,279
because the file name is sort of I can

328
00:14:23,279 --> 00:14:25,940
see the file name and I can see the

329
00:14:25,940 --> 00:14:30,420
crc32 hash and I can see this this size

330
00:14:30,420 --> 00:14:34,800
as well if all these three line up I see

331
00:14:34,800 --> 00:14:37,260
you know I I would say it is the same

332
00:14:37,260 --> 00:14:39,480
file I mean it's with the 99 point

333
00:14:39,480 --> 00:14:41,639
something I mean if it doesn't have this

334
00:14:41,639 --> 00:14:43,320
you know if something if a unique

335
00:14:43,320 --> 00:14:45,300
tooling it doesn't help but sort of if

336
00:14:45,300 --> 00:14:47,519
it is something that's sort of known I

337
00:14:47,519 --> 00:14:49,440
can still figure it out so in this case

338
00:14:49,440 --> 00:14:53,339
it was this HDD llf or something and it

339
00:14:53,339 --> 00:14:55,560
had this sort of I just Googled it and

340
00:14:55,560 --> 00:14:59,220
it was this tooling called hddl llf low

341
00:14:59,220 --> 00:15:01,680
level format tool with this kind of a

342
00:15:01,680 --> 00:15:03,899
competitor to CC Cleaner but it's sort

343
00:15:03,899 --> 00:15:07,620
of it erases data uh like more on a

344
00:15:07,620 --> 00:15:09,360
lower level on the on the on the disk

345
00:15:09,360 --> 00:15:10,440
level

346
00:15:10,440 --> 00:15:13,079
you know they the extract act didn't

347
00:15:13,079 --> 00:15:15,360
utilize this one in the in this uh

348
00:15:15,360 --> 00:15:17,519
incident but probably something they

349
00:15:17,519 --> 00:15:21,240
will do uh like wiping stuff

350
00:15:21,240 --> 00:15:23,880
after they had stolen data but I don't

351
00:15:23,880 --> 00:15:26,760
know it was within their tooling

352
00:15:26,760 --> 00:15:29,279
though I mean uh

353
00:15:29,279 --> 00:15:31,139
since I thought it was you know there

354
00:15:31,139 --> 00:15:33,720
was a little bit uh I like this trick uh

355
00:15:33,720 --> 00:15:37,440
to to yeah this is two uh

356
00:15:37,440 --> 00:15:38,699
um sort of

357
00:15:38,699 --> 00:15:41,339
you can actually script this one so if I

358
00:15:41,339 --> 00:15:44,160
make a little for Loop and and I go over

359
00:15:44,160 --> 00:15:46,440
all the zip files

360
00:15:46,440 --> 00:15:48,959
then with some some regex then some some

361
00:15:48,959 --> 00:15:51,480
some you know pulling out the correct

362
00:15:51,480 --> 00:15:52,560
fields

363
00:15:52,560 --> 00:15:55,019
I could actually take out the path the

364
00:15:55,019 --> 00:15:57,240
size and the CRC too and then you know

365
00:15:57,240 --> 00:15:59,399
doing so I could actually search for all

366
00:15:59,399 --> 00:16:03,000
this tooling and then find out all the

367
00:16:03,000 --> 00:16:04,980
tools even though I couldn't sort of

368
00:16:04,980 --> 00:16:08,600
open the zip file

369
00:16:09,440 --> 00:16:12,240
a way to work around this and also like

370
00:16:12,240 --> 00:16:16,100
a little trick I want to share with you

371
00:16:16,500 --> 00:16:19,740
so if we move into the the

372
00:16:19,740 --> 00:16:23,880
incident itself as I was telling like

373
00:16:23,880 --> 00:16:27,500
um I was working uh with this

374
00:16:27,500 --> 00:16:30,480
uh uh we had this sort of rap that I was

375
00:16:30,480 --> 00:16:36,120
working with and I knew that the the rat

376
00:16:36,120 --> 00:16:38,100
was coming from this thingy called

377
00:16:38,100 --> 00:16:40,500
installer.exe

378
00:16:40,500 --> 00:16:43,019
and it was sort of placed in this folder

379
00:16:43,019 --> 00:16:44,880
called agents

380
00:16:44,880 --> 00:16:47,940
so what is an agent

381
00:16:47,940 --> 00:16:49,920
is it like this

382
00:16:49,920 --> 00:16:53,220
I apologize uh I am a dad so I I needed

383
00:16:53,220 --> 00:16:55,139
to put in at least one bad joke you know

384
00:16:55,139 --> 00:16:56,880
I apologize I hope you hope you can bear

385
00:16:56,880 --> 00:17:00,420
with me anyway uh the thing is the agent

386
00:17:00,420 --> 00:17:02,639
the installer the file that actually I

387
00:17:02,639 --> 00:17:04,079
was looking at was this one called

388
00:17:04,079 --> 00:17:07,079
svcsf.exe

389
00:17:08,220 --> 00:17:10,919
and that was actually like came from

390
00:17:10,919 --> 00:17:15,199
this installer file and this installer

391
00:17:15,199 --> 00:17:18,660
was placed in this folder so I had a

392
00:17:18,660 --> 00:17:21,000
look at it and

393
00:17:21,000 --> 00:17:24,000
it is actually this kind of rat back

394
00:17:24,000 --> 00:17:27,900
door that is you you give it an IP and

395
00:17:27,900 --> 00:17:30,480
it it stores itself as a service

396
00:17:30,480 --> 00:17:34,260
and as a scheduled task and by getting

397
00:17:34,260 --> 00:17:36,360
hold of the installer

398
00:17:36,360 --> 00:17:39,960
and I know which IP was commuting again

399
00:17:39,960 --> 00:17:43,080
you can tell uh with I could just run it

400
00:17:43,080 --> 00:17:45,120
and then say okay what stuff did it

401
00:17:45,120 --> 00:17:48,360
change on my system and then okay we

402
00:17:48,360 --> 00:17:50,160
could actually clean out uh the

403
00:17:50,160 --> 00:17:51,660
infection because they had just used the

404
00:17:51,660 --> 00:17:54,500
default which made my job as a reverser

405
00:17:54,500 --> 00:17:57,240
much much easier so it's like you know

406
00:17:57,240 --> 00:18:01,020
thank you opsec fail uh uh you just made

407
00:18:01,020 --> 00:18:04,860
my life much much more simpler

408
00:18:04,860 --> 00:18:08,760
though there was another one agent uh

409
00:18:08,760 --> 00:18:12,660
which was called AI dot EXE

410
00:18:12,660 --> 00:18:16,559
and I looked that one up on virus total

411
00:18:16,559 --> 00:18:21,299
and it had four uh alerts saying it was

412
00:18:21,299 --> 00:18:24,660
malware and but they were all four minor

413
00:18:24,660 --> 00:18:29,520
ones this is kind of okay why why

414
00:18:29,520 --> 00:18:31,860
if I was looking at this I would say

415
00:18:31,860 --> 00:18:34,940
it's probably not malware but what is it

416
00:18:34,940 --> 00:18:38,340
why because the rap house the the

417
00:18:38,340 --> 00:18:40,559
rappers get started with

418
00:18:40,559 --> 00:18:43,740
that was the one called installer and

419
00:18:43,740 --> 00:18:44,520
this

420
00:18:44,520 --> 00:18:47,400
file was placed next to it in the same

421
00:18:47,400 --> 00:18:49,919
folder so like this needs to be

422
00:18:49,919 --> 00:18:51,600
something that's that's why I had a look

423
00:18:51,600 --> 00:18:53,820
into this even though it was not part of

424
00:18:53,820 --> 00:18:56,039
the incident

425
00:18:56,039 --> 00:18:59,340
having a look at this uh I'd install it

426
00:18:59,340 --> 00:19:03,059
and it became like this it had this

427
00:19:03,059 --> 00:19:06,179
thing called Agent 32 I I love it when

428
00:19:06,179 --> 00:19:07,860
they sort of name stuff like this

429
00:19:07,860 --> 00:19:10,260
because it makes the the our life as

430
00:19:10,260 --> 00:19:12,299
insurance responder a bit easier like

431
00:19:12,299 --> 00:19:14,580
the lsos.ship that Lena was talking

432
00:19:14,580 --> 00:19:16,260
about as well like this stuff you know

433
00:19:16,260 --> 00:19:17,460
helps with it

434
00:19:17,460 --> 00:19:19,919
and and start looking at this it is

435
00:19:19,919 --> 00:19:21,179
actually

436
00:19:21,179 --> 00:19:25,700
a legitimate tool called intelli admin

437
00:19:25,700 --> 00:19:28,140
uh and this kind of this remote

438
00:19:28,140 --> 00:19:31,679
Administration tools that that I had

439
00:19:31,679 --> 00:19:32,880
never heard about this before this

440
00:19:32,880 --> 00:19:34,799
incident but there is a remote assistant

441
00:19:34,799 --> 00:19:36,900
solution as I said there

442
00:19:36,900 --> 00:19:40,080
though it is one of those tools that

443
00:19:40,080 --> 00:19:42,539
sort of has been

444
00:19:42,539 --> 00:19:45,179
uh laying around on the internet because

445
00:19:45,179 --> 00:19:47,400
actually the the the

446
00:19:47,400 --> 00:19:50,280
creator of this tool it passed away six

447
00:19:50,280 --> 00:19:51,780
years ago

448
00:19:51,780 --> 00:19:54,419
so this kind of tool has just sort of

449
00:19:54,419 --> 00:19:57,539
just surviving uh on the internet

450
00:19:57,539 --> 00:20:01,020
and it's not maintained anymore but

451
00:20:01,020 --> 00:20:03,900
it is used by threat actors sort of or

452
00:20:03,900 --> 00:20:06,480
abused I would say I mean the intention

453
00:20:06,480 --> 00:20:10,260
for the developer who's not this so and

454
00:20:10,260 --> 00:20:12,539
it has actually been like a look into

455
00:20:12,539 --> 00:20:15,179
this actually uh Turlock

456
00:20:15,179 --> 00:20:19,080
has used this one as well uh as a backup

457
00:20:19,080 --> 00:20:22,080
thingy and uh

458
00:20:22,080 --> 00:20:24,179
what you could do here I install it and

459
00:20:24,179 --> 00:20:26,340
I look at it and

460
00:20:26,340 --> 00:20:30,780
it looks like this and even though

461
00:20:30,780 --> 00:20:34,080
uh in the incident we hadn't found the

462
00:20:34,080 --> 00:20:36,840
use this was not where we started I took

463
00:20:36,840 --> 00:20:39,299
out all the iocs from this tool saying

464
00:20:39,299 --> 00:20:42,720
okay this hasn't been used uh but I

465
00:20:42,720 --> 00:20:44,280
think we should look for it because you

466
00:20:44,280 --> 00:20:46,020
know it was placed in the same folder as

467
00:20:46,020 --> 00:20:47,179
the other one

468
00:20:47,179 --> 00:20:51,360
and actually this was installed on one

469
00:20:51,360 --> 00:20:53,160
server by the threat actor that they

470
00:20:53,160 --> 00:20:55,860
never logged into so this was actually

471
00:20:55,860 --> 00:20:59,400
their backup door in uh so we could you

472
00:20:59,400 --> 00:21:01,020
know throw them out as well completely

473
00:21:01,020 --> 00:21:03,480
from their wires because yeah this is

474
00:21:03,480 --> 00:21:05,520
I guess how they were you know gonna

475
00:21:05,520 --> 00:21:10,020
come back in without the IRT noticing

476
00:21:10,020 --> 00:21:11,280
and

477
00:21:11,280 --> 00:21:12,660
this kind of made me a little bit

478
00:21:12,660 --> 00:21:15,120
interested in this kind of abuse because

479
00:21:15,120 --> 00:21:18,480
I've seen it before but other tools that

480
00:21:18,480 --> 00:21:21,059
I know about TeamViewer and Screen

481
00:21:21,059 --> 00:21:23,460
connect and Splashtop those ones I've

482
00:21:23,460 --> 00:21:27,299
seen so this is my kind of 15 seconds of

483
00:21:27,299 --> 00:21:29,880
Twitter Fame uh I saw that someone had

484
00:21:29,880 --> 00:21:34,020
talked about the Swift before uh and

485
00:21:34,020 --> 00:21:36,419
so I made this kind of blog post uh not

486
00:21:36,419 --> 00:21:39,120
blog post uh Twitter post about remote

487
00:21:39,120 --> 00:21:41,880
admin tools that are abused by threat

488
00:21:41,880 --> 00:21:45,000
actors and you know start just looking

489
00:21:45,000 --> 00:21:46,620
into this I actually discovered this

490
00:21:46,620 --> 00:21:49,500
much much more and in play admin is one

491
00:21:49,500 --> 00:21:51,659
of them so I mean this is a list for you

492
00:21:51,659 --> 00:21:53,460
to keep track on

493
00:21:53,460 --> 00:21:55,140
and

494
00:21:55,140 --> 00:21:58,980
actually uh this company called synactiv

495
00:21:58,980 --> 00:22:01,919
they did a like a proper mine was just a

496
00:22:01,919 --> 00:22:03,600
you know just a bunch of tools on a

497
00:22:03,600 --> 00:22:05,520
Twitter thread they looked into this

498
00:22:05,520 --> 00:22:07,140
they got inspired actually by my Twitter

499
00:22:07,140 --> 00:22:08,460
thread and thought looked me into this

500
00:22:08,460 --> 00:22:10,620
and they did this kind of forensic

501
00:22:10,620 --> 00:22:13,799
analysis of different remote remote

502
00:22:13,799 --> 00:22:16,860
Administration tools that are are abused

503
00:22:16,860 --> 00:22:19,740
by threat actors and there's loads of

504
00:22:19,740 --> 00:22:22,200
good good iocs in there so I highly

505
00:22:22,200 --> 00:22:24,360
recommend this one to you know if you're

506
00:22:24,360 --> 00:22:27,480
a part of a sock stuff to look for uh

507
00:22:27,480 --> 00:22:30,240
sort of if I mean if there's if let's

508
00:22:30,240 --> 00:22:32,100
say you have an environment and you you

509
00:22:32,100 --> 00:22:33,780
use one of these tools you use team

510
00:22:33,780 --> 00:22:35,820
TeamViewer but all of a sudden you know

511
00:22:35,820 --> 00:22:38,100
Intel admin pops up that's something you

512
00:22:38,100 --> 00:22:40,200
should look into so this is a I would

513
00:22:40,200 --> 00:22:42,000
say a good list for for the white

514
00:22:42,000 --> 00:22:44,580
listening if if someone refused to keep

515
00:22:44,580 --> 00:22:46,740
in track up

516
00:22:46,740 --> 00:22:48,240
uh

517
00:22:48,240 --> 00:22:50,700
so if we go back to the like let's say

518
00:22:50,700 --> 00:22:53,760
because this is a strapped into Summit I

519
00:22:53,760 --> 00:22:55,919
so I was like wondering like okay is

520
00:22:55,919 --> 00:22:59,220
there a way to figure out you know I I

521
00:22:59,220 --> 00:23:01,919
know they use this tooling uh can I

522
00:23:01,919 --> 00:23:03,179
figure out

523
00:23:03,179 --> 00:23:05,159
what are they there sort of what's their

524
00:23:05,159 --> 00:23:08,520
Commander control uh domains and uh

525
00:23:08,520 --> 00:23:11,340
so this is how it looks if you go to the

526
00:23:11,340 --> 00:23:14,039
IP where this uh this uh Intel admin

527
00:23:14,039 --> 00:23:15,900
thing is is located

528
00:23:15,900 --> 00:23:18,120
and I guess

529
00:23:18,120 --> 00:23:20,820
many of you use Showdown

530
00:23:20,820 --> 00:23:24,720
and though there's this stupid neat

531
00:23:24,720 --> 00:23:26,760
feature it's not that sort of it's not

532
00:23:26,760 --> 00:23:28,440
hidden but I I know many people doesn't

533
00:23:28,440 --> 00:23:30,960
know about it it's called raw data so

534
00:23:30,960 --> 00:23:32,640
you can click here on on Showdown and

535
00:23:32,640 --> 00:23:35,520
you know it gives you like access to a

536
00:23:35,520 --> 00:23:38,039
nice Json blob and this is actually one

537
00:23:38,039 --> 00:23:39,480
of the things I usually do when I'm

538
00:23:39,480 --> 00:23:42,179
involved in cases I I go I go to you

539
00:23:42,179 --> 00:23:44,580
know if I know a C2 that's used I go to

540
00:23:44,580 --> 00:23:47,520
The Showdown and see okay what stuff can

541
00:23:47,520 --> 00:23:51,480
I look at is IP is anything unique

542
00:23:51,480 --> 00:23:53,460
and in this case if you look on this

543
00:23:53,460 --> 00:23:55,400
data field we see this

544
00:23:55,400 --> 00:24:00,419
uh set cookie I.E session ID an ie

545
00:24:00,419 --> 00:24:03,240
session that actually stands for intelli

546
00:24:03,240 --> 00:24:05,220
admin and all of a sudden we have

547
00:24:05,220 --> 00:24:07,020
something that we can search on on

548
00:24:07,020 --> 00:24:09,659
children so let's search for that set

549
00:24:09,659 --> 00:24:13,140
cookie is session ID and all of a sudden

550
00:24:13,140 --> 00:24:15,720
we have all the intelli admin servers

551
00:24:15,720 --> 00:24:19,260
that sort of Showdown has enumerated

552
00:24:19,260 --> 00:24:21,720
I mean there is a legitimate too but it

553
00:24:21,720 --> 00:24:22,919
has been

554
00:24:22,919 --> 00:24:25,380
this sort of is not been used for for

555
00:24:25,380 --> 00:24:26,640
many many years

556
00:24:26,640 --> 00:24:28,500
there are some false positives in here

557
00:24:28,500 --> 00:24:30,780
but I would say that if you see yourself

558
00:24:30,780 --> 00:24:32,580
connecting to one of these IPS and you

559
00:24:32,580 --> 00:24:34,740
know what it is definitely something to

560
00:24:34,740 --> 00:24:36,840
look into but I just want to more show

561
00:24:36,840 --> 00:24:39,240
the sort of this way of

562
00:24:39,240 --> 00:24:42,840
using this sort of this raw data section

563
00:24:42,840 --> 00:24:45,539
in Showdown how to leverage to look for

564
00:24:45,539 --> 00:24:48,780
other sort of c2s and

565
00:24:48,780 --> 00:24:51,240
for the other one the one I started that

566
00:24:51,240 --> 00:24:53,460
one looked like this it's a beautiful

567
00:24:53,460 --> 00:24:56,940
web programming isn't it uh

568
00:24:56,940 --> 00:24:59,760
then also children has this other nice

569
00:24:59,760 --> 00:25:02,880
super nice feature it's called HTML hash

570
00:25:02,880 --> 00:25:05,580
which sort of if it's it's kind of a

571
00:25:05,580 --> 00:25:07,919
hash sort of how this web page look like

572
00:25:07,919 --> 00:25:09,720
and then you can search for other web

573
00:25:09,720 --> 00:25:12,480
pages that have the exact same look like

574
00:25:12,480 --> 00:25:14,700
this and

575
00:25:14,700 --> 00:25:17,940
I put it in in insurance as well and we

576
00:25:17,940 --> 00:25:19,860
had eight and I would dare to say like

577
00:25:19,860 --> 00:25:21,840
that's a hundred percent true positives

578
00:25:21,840 --> 00:25:24,659
here and also like one of the things

579
00:25:24,659 --> 00:25:26,940
this is sort of the mythology here is

580
00:25:26,940 --> 00:25:29,340
that if you think about threat actors

581
00:25:29,340 --> 00:25:32,159
they need to be agile they need speed

582
00:25:32,159 --> 00:25:34,679
they need sort of to be

583
00:25:34,679 --> 00:25:36,840
uh to put up their infrastructure

584
00:25:36,840 --> 00:25:38,820
quickly they probably have some scripts

585
00:25:38,820 --> 00:25:40,860
or some you know stuff like that which

586
00:25:40,860 --> 00:25:43,020
make them you can see stuff if you can

587
00:25:43,020 --> 00:25:45,299
find something unique about how this is

588
00:25:45,299 --> 00:25:47,039
set up stuff you can probably track

589
00:25:47,039 --> 00:25:49,140
their infrastructure with this kind of

590
00:25:49,140 --> 00:25:51,299
Methodist thinking like what's unique

591
00:25:51,299 --> 00:25:52,919
for their stuff try to figure it out

592
00:25:52,919 --> 00:25:55,020
using this kind of this kind of

593
00:25:55,020 --> 00:25:56,900
techniques

594
00:25:56,900 --> 00:26:00,659
uh though like I we tried I tried to

595
00:26:00,659 --> 00:26:02,340
think like who could this be I'll try to

596
00:26:02,340 --> 00:26:04,559
attribute it uh one of the things like

597
00:26:04,559 --> 00:26:05,520
is

598
00:26:05,520 --> 00:26:08,760
I I because we never had ransomware and

599
00:26:08,760 --> 00:26:10,559
we couldn't attribute it to this one

600
00:26:10,559 --> 00:26:13,679
though we we thought this is probably

601
00:26:13,679 --> 00:26:15,659
not like the the top tier of the

602
00:26:15,659 --> 00:26:18,120
ransomware actors it's some you know

603
00:26:18,120 --> 00:26:22,500
it's not is you know it's like Place 78

604
00:26:22,500 --> 00:26:24,539
or something I don't know the top 200.

605
00:26:24,539 --> 00:26:27,179
I'm just guessing but sort of looking at

606
00:26:27,179 --> 00:26:28,919
this kind of tooling we could see like

607
00:26:28,919 --> 00:26:30,120
the the

608
00:26:30,120 --> 00:26:32,159
one of them has dorm has used it then I

609
00:26:32,159 --> 00:26:33,539
want to show you the the clear lock

610
00:26:33,539 --> 00:26:35,580
where the the

611
00:26:35,580 --> 00:26:38,580
price around somewhere we had Locust

612
00:26:38,580 --> 00:26:40,200
ransomware had used these kind of some

613
00:26:40,200 --> 00:26:42,740
of the the the

614
00:26:42,740 --> 00:26:45,960
scripts we had mimikats which is kind of

615
00:26:45,960 --> 00:26:49,559
everyone uh all the ransomware and then

616
00:26:49,559 --> 00:26:52,500
for for the the Intel admin stuff that

617
00:26:52,500 --> 00:26:54,539
so that was actually there was apt stuff

618
00:26:54,539 --> 00:26:57,720
that was taller so uh just showing like

619
00:26:57,720 --> 00:27:00,059
okay even the minor league stuff they're

620
00:27:00,059 --> 00:27:02,159
picking up all this tooling as well

621
00:27:02,159 --> 00:27:05,520
which makes our our job a little bit

622
00:27:05,520 --> 00:27:08,940
harder but still we can't track them and

623
00:27:08,940 --> 00:27:10,799
they they fail with obsequence so it's

624
00:27:10,799 --> 00:27:13,440
another win for the for the blue team so

625
00:27:13,440 --> 00:27:16,620
so thank you very much

626
00:27:16,620 --> 00:27:19,620
foreign

