1
00:00:00,659 --> 00:00:02,900
foreign

2
00:00:13,460 --> 00:00:17,760
and we researched it and it was involved

3
00:00:17,760 --> 00:00:19,080
with a

4
00:00:19,080 --> 00:00:21,180
um more or less 30 million US dollar

5
00:00:21,180 --> 00:00:23,820
high so uh that was quite interesting

6
00:00:23,820 --> 00:00:26,160
and we decided to to investigate more

7
00:00:26,160 --> 00:00:28,199
Linux threads what was happening in the

8
00:00:28,199 --> 00:00:30,480
wild so we're looking forward to you

9
00:00:30,480 --> 00:00:32,579
know show you a summary of those threats

10
00:00:32,579 --> 00:00:35,520
uh and and more importantly like how can

11
00:00:35,520 --> 00:00:37,739
we have visibility on those like how

12
00:00:37,739 --> 00:00:39,300
what are the detection that we can make

13
00:00:39,300 --> 00:00:42,300
on those so that's the goal for for the

14
00:00:42,300 --> 00:00:43,440
presentation

15
00:00:43,440 --> 00:00:46,200
uh my name is Peter Dremel I'm a

16
00:00:46,200 --> 00:00:48,180
researcher at blackberry and the first

17
00:00:48,180 --> 00:00:50,760
time I flew in the US was in 2009 for a

18
00:00:50,760 --> 00:00:53,160
sales conference I got the I took these

19
00:00:53,160 --> 00:00:55,860
intrusion detection uh training a lot of

20
00:00:55,860 --> 00:00:58,199
TCP dump and all that so it's uh you

21
00:00:58,199 --> 00:01:00,239
know quite nice like 13 years after

22
00:01:00,239 --> 00:01:03,180
being a sense event again uh as a

23
00:01:03,180 --> 00:01:04,860
speaker so thank you so much for that

24
00:01:04,860 --> 00:01:06,780
I'll pass over to my friend Jose Villa

25
00:01:06,780 --> 00:01:09,360
okay thank you so much Pedro my name is

26
00:01:09,360 --> 00:01:11,180
Jose Luis

27
00:01:11,180 --> 00:01:15,000
coming from the south of Spain

28
00:01:15,000 --> 00:01:17,040
um it's better said before we are going

29
00:01:17,040 --> 00:01:19,020
to talk about Lane of threats what we

30
00:01:19,020 --> 00:01:21,240
were researching during Infinity 2. so

31
00:01:21,240 --> 00:01:23,340
starting with the presentation we have

32
00:01:23,340 --> 00:01:25,920
this attendable for today

33
00:01:25,920 --> 00:01:28,799
first we are going to talk about a small

34
00:01:28,799 --> 00:01:31,439
introduction about some Concepts that we

35
00:01:31,439 --> 00:01:32,840
think that are necessary for

36
00:01:32,840 --> 00:01:34,799
understanding all the all the

37
00:01:34,799 --> 00:01:35,820
presentations

38
00:01:35,820 --> 00:01:37,979
after that we have the Linux in the

39
00:01:37,979 --> 00:01:39,780
world threads where Pedro is going to

40
00:01:39,780 --> 00:01:42,000
talk about some families that we were

41
00:01:42,000 --> 00:01:44,100
tracking last year

42
00:01:44,100 --> 00:01:46,920
is following that point we have the

43
00:01:46,920 --> 00:01:48,840
similar similarity design detection some

44
00:01:48,840 --> 00:01:50,700
processes that we did in order to get

45
00:01:50,700 --> 00:01:53,460
some correlations and say simulated

46
00:01:53,460 --> 00:01:55,320
similarities during the difference

47
00:01:55,320 --> 00:01:57,659
infection of the linear threads and

48
00:01:57,659 --> 00:01:59,100
finally we have the conclusion and

49
00:01:59,100 --> 00:02:01,920
different outcomes that we have

50
00:02:01,920 --> 00:02:04,140
generated also for the for the audience

51
00:02:04,140 --> 00:02:05,100
so

52
00:02:05,100 --> 00:02:08,818
the first Slide the introduction is

53
00:02:08,818 --> 00:02:11,099
let's say that first of all we want to

54
00:02:11,099 --> 00:02:13,980
talk about these two concepts because

55
00:02:13,980 --> 00:02:16,620
during the entire presentation we are

56
00:02:16,620 --> 00:02:18,959
going to mention uh probably many times

57
00:02:18,959 --> 00:02:22,560
the the concept of DTF opens which which

58
00:02:22,560 --> 00:02:25,200
is a let's say a list of binaries

59
00:02:25,200 --> 00:02:27,480
sometimes for installing the operating

60
00:02:27,480 --> 00:02:29,760
system sometimes are not pre-installed

61
00:02:29,760 --> 00:02:32,940
but are widely used by producters and

62
00:02:32,940 --> 00:02:35,700
also by ID admin for example or ID

63
00:02:35,700 --> 00:02:38,760
security analysts that are used for

64
00:02:38,760 --> 00:02:41,220
let's say or try to avoid some detection

65
00:02:41,220 --> 00:02:43,800
in the operating system it's the same

66
00:02:43,800 --> 00:02:46,800
concept that probably all of us know

67
00:02:46,800 --> 00:02:49,620
which is the other one lol bus it's the

68
00:02:49,620 --> 00:02:52,260
same concept quite similar but in this

69
00:02:52,260 --> 00:02:55,280
case for Windows where we have

70
00:02:55,280 --> 00:02:58,800
libraries binaries and scripts that are

71
00:02:58,800 --> 00:03:02,400
also used by by many traductor during

72
00:03:02,400 --> 00:03:06,680
the operations and both both

73
00:03:06,680 --> 00:03:09,360
concepts are going to be used during the

74
00:03:09,360 --> 00:03:11,700
the presentation so

75
00:03:11,700 --> 00:03:14,280
first of all a common behavior let's say

76
00:03:14,280 --> 00:03:17,040
this is not always the same but the key

77
00:03:17,040 --> 00:03:19,680
points from this slide is that I want to

78
00:03:19,680 --> 00:03:21,780
show you let's say

79
00:03:21,780 --> 00:03:25,379
that in the the windows campaigns where

80
00:03:25,379 --> 00:03:28,739
when you are reading some report

81
00:03:28,739 --> 00:03:31,980
from some vendor there are also there

82
00:03:31,980 --> 00:03:34,080
are let's say many different States

83
00:03:34,080 --> 00:03:37,200
during the infection so if we go to the

84
00:03:37,200 --> 00:03:39,959
specific detail of all the steps made by

85
00:03:39,959 --> 00:03:42,540
the threat actors we are seeing several

86
00:03:42,540 --> 00:03:44,840
payloads like downloaders we are seeing

87
00:03:44,840 --> 00:03:47,519
Trojans we are saying we are seeing the

88
00:03:47,519 --> 00:03:50,519
final payloads the the final family that

89
00:03:50,519 --> 00:03:53,159
the strata actors are trying to deploy

90
00:03:53,159 --> 00:03:55,860
and also if we go to the specific detail

91
00:03:55,860 --> 00:03:59,099
of each step made by the third actor we

92
00:03:59,099 --> 00:04:01,140
are going to see many logos use which is

93
00:04:01,140 --> 00:04:03,360
quite interesting because sometimes we

94
00:04:03,360 --> 00:04:06,420
are not let's say having focus in the

95
00:04:06,420 --> 00:04:08,819
attacks some of those lolvas we are just

96
00:04:08,819 --> 00:04:11,580
selling Isis related to some specific

97
00:04:11,580 --> 00:04:13,220
family

98
00:04:13,220 --> 00:04:17,160
using in Windows so another key point on

99
00:04:17,160 --> 00:04:19,620
this slide is that sometimes not always

100
00:04:19,620 --> 00:04:22,560
but there are some CB explanation during

101
00:04:22,560 --> 00:04:25,860
the entire intrusion in this kind of

102
00:04:25,860 --> 00:04:29,520
operation it's just a come let's say

103
00:04:29,520 --> 00:04:32,040
behavior that we are seeing obviously

104
00:04:32,040 --> 00:04:34,320
and all the reports made by the

105
00:04:34,320 --> 00:04:36,840
different vendors and in Linux we have

106
00:04:36,840 --> 00:04:39,120
something quite similar at the end in

107
00:04:39,120 --> 00:04:41,460
multiple States and they are let's say

108
00:04:41,460 --> 00:04:44,040
deploying downloaders deploying troians

109
00:04:44,040 --> 00:04:47,040
and finally getting some let's say the

110
00:04:47,040 --> 00:04:49,440
end some ransomware encrypting all the

111
00:04:49,440 --> 00:04:52,740
data in operating system but it's quite

112
00:04:52,740 --> 00:04:56,220
similar because they are also using dtfo

113
00:04:56,220 --> 00:04:57,300
beams

114
00:04:57,300 --> 00:04:59,940
we are going to talk about some of them

115
00:04:59,940 --> 00:05:03,060
during this presentation and the

116
00:05:03,060 --> 00:05:05,100
difference here is also that the initial

117
00:05:05,100 --> 00:05:06,720
directory is not let's say an email

118
00:05:06,720 --> 00:05:10,320
because you know probably Linux is not

119
00:05:10,320 --> 00:05:13,080
the best option or the best in the

120
00:05:13,080 --> 00:05:15,419
organization to to have us an endpoint

121
00:05:15,419 --> 00:05:18,600
for the end user our model like related

122
00:05:18,600 --> 00:05:21,240
to a Linux servers so the initial

123
00:05:21,240 --> 00:05:24,000
platforms usually is maybe a CV

124
00:05:24,000 --> 00:05:25,919
exploitation maybe a letter of moving

125
00:05:25,919 --> 00:05:28,820
from another previous infected machines

126
00:05:28,820 --> 00:05:31,919
or some cases also we we're seeing

127
00:05:31,919 --> 00:05:34,680
somebody credentials from the dark web

128
00:05:34,680 --> 00:05:37,740
used to login into the this kind of

129
00:05:37,740 --> 00:05:40,680
service so same here if we go to the

130
00:05:40,680 --> 00:05:42,479
detail we are going to see some dpfo

131
00:05:42,479 --> 00:05:44,460
beans used during the infection

132
00:05:44,460 --> 00:05:46,320
finally some of the

133
00:05:46,320 --> 00:05:49,440
LOL versus beauty of beans that we have

134
00:05:49,440 --> 00:05:52,979
serving are these obviously we are

135
00:05:52,979 --> 00:05:54,780
missing something like power cell is

136
00:05:54,780 --> 00:05:57,780
also one of the most used levels in

137
00:05:57,780 --> 00:06:00,360
Windows operation there's an example

138
00:06:00,360 --> 00:06:03,180
here some of the most used that we are

139
00:06:03,180 --> 00:06:05,039
serving track in Linux threads they are

140
00:06:05,039 --> 00:06:07,500
in the during the the last year uh

141
00:06:07,500 --> 00:06:10,080
cellular for example is quite similar in

142
00:06:10,080 --> 00:06:13,740
terms of Behavior Uh as we have in Linux

143
00:06:13,740 --> 00:06:16,139
let's say w get our core we can download

144
00:06:16,139 --> 00:06:19,080
file using those banners so it's just an

145
00:06:19,080 --> 00:06:21,360
example and some of the uh two different

146
00:06:21,360 --> 00:06:24,360
lists that we have created so now a

147
00:06:24,360 --> 00:06:27,240
better place talked us about the linu

148
00:06:27,240 --> 00:06:28,979
thread that we were tracking thank you

149
00:06:28,979 --> 00:06:30,419
so

150
00:06:30,419 --> 00:06:33,600
um those are the uh the families that we

151
00:06:33,600 --> 00:06:35,759
we have listed um I'm not going to go

152
00:06:35,759 --> 00:06:37,259
through all of them only some of them

153
00:06:37,259 --> 00:06:38,220
but

154
00:06:38,220 --> 00:06:41,000
um this list is just

155
00:06:43,620 --> 00:06:46,319
um so I'm gonna go to some of them but

156
00:06:46,319 --> 00:06:48,960
the uh the research itself and the data

157
00:06:48,960 --> 00:06:51,060
that the uh the rules and all that that

158
00:06:51,060 --> 00:06:53,100
we're gonna provide at the end uh that

159
00:06:53,100 --> 00:06:55,259
are going to be in our GitHub page that

160
00:06:55,259 --> 00:06:58,319
involves all of them so uh

161
00:06:58,319 --> 00:06:59,280
um first

162
00:06:59,280 --> 00:07:01,740
um talking about symbiote um it is a

163
00:07:01,740 --> 00:07:04,620
basically a backdoor keylogger we

164
00:07:04,620 --> 00:07:06,900
publish the research last year with with

165
00:07:06,900 --> 00:07:09,780
infoser and uh the interesting part is

166
00:07:09,780 --> 00:07:12,240
the expectation capability it has

167
00:07:12,240 --> 00:07:15,780
um and it it has also a very stealthy

168
00:07:15,780 --> 00:07:17,520
userline rootkit

169
00:07:17,520 --> 00:07:19,680
um so if you lease directors you won't

170
00:07:19,680 --> 00:07:21,240
see it if you check process you won't

171
00:07:21,240 --> 00:07:23,400
see it if you check the network traffic

172
00:07:23,400 --> 00:07:25,860
locally you won't see it as well

173
00:07:25,860 --> 00:07:27,300
um maybe you know in my opinion at least

174
00:07:27,300 --> 00:07:29,280
the most interesting part is so

175
00:07:29,280 --> 00:07:32,520
basically it hooks vbc and lipicab but

176
00:07:32,520 --> 00:07:34,199
um it even removed the stats so if

177
00:07:34,199 --> 00:07:35,940
you're locally you know doing your CP

178
00:07:35,940 --> 00:07:37,020
dump

179
00:07:37,020 --> 00:07:40,139
um and it filters all the domains the

180
00:07:40,139 --> 00:07:42,060
IPS and ports that it doesn't want to

181
00:07:42,060 --> 00:07:44,699
show up and it also removed that from

182
00:07:44,699 --> 00:07:46,740
the stats so like you see exactly the

183
00:07:46,740 --> 00:07:47,880
number of effects you're seeing the

184
00:07:47,880 --> 00:07:48,840
screen

185
00:07:48,840 --> 00:07:51,120
um I like that one and

186
00:07:51,120 --> 00:07:53,940
um it is DNS for communication so

187
00:07:53,940 --> 00:07:56,819
um of course we've seen many other uh

188
00:07:56,819 --> 00:07:59,280
threads using DNS but for for Linux this

189
00:07:59,280 --> 00:08:02,340
was was quite interesting to see uh and

190
00:08:02,340 --> 00:08:04,860
they also uh you know use uh public key

191
00:08:04,860 --> 00:08:07,259
uh create and private key schema as well

192
00:08:07,259 --> 00:08:08,639
to

193
00:08:08,639 --> 00:08:10,500
um check if the command received it from

194
00:08:10,500 --> 00:08:12,780
from the command and control is really

195
00:08:12,780 --> 00:08:15,060
uh provided by attacker itself so that

196
00:08:15,060 --> 00:08:17,580
that's that was quite quite unique and

197
00:08:17,580 --> 00:08:20,099
the usage of DNS DNS CAD for filtration

198
00:08:20,099 --> 00:08:22,259
so um you know if you're monetary

199
00:08:22,259 --> 00:08:24,479
Network you see some unusual DNS traffic

200
00:08:24,479 --> 00:08:27,120
for a Linux box uh make sure to check it

201
00:08:27,120 --> 00:08:28,080
out

202
00:08:28,080 --> 00:08:29,759
um and why is it relevant right all

203
00:08:29,759 --> 00:08:31,620
right just you know piece of code

204
00:08:31,620 --> 00:08:34,740
running Linux on Linux system

205
00:08:34,740 --> 00:08:36,839
um it was actually more victims

206
00:08:36,839 --> 00:08:40,020
confirmed uh they were in Brazil and one

207
00:08:40,020 --> 00:08:43,860
one of them is related to a frauding in

208
00:08:43,860 --> 00:08:46,200
more or less 30 million dollars so that

209
00:08:46,200 --> 00:08:48,779
that's quite relevant it may maybe kind

210
00:08:48,779 --> 00:08:50,940
of helps a little bit when we as a

211
00:08:50,940 --> 00:08:52,560
community kind of think oh why do the

212
00:08:52,560 --> 00:08:55,200
you know Latin America thread uh trade

213
00:08:55,200 --> 00:08:57,240
actors destroying fraud and not all

214
00:08:57,240 --> 00:09:00,060
all-in ransomware maybe you know some of

215
00:09:00,060 --> 00:09:03,360
them might you have some success so of

216
00:09:03,360 --> 00:09:05,399
course it seem that was not the only two

217
00:09:05,399 --> 00:09:07,680
used links was not the only system

218
00:09:07,680 --> 00:09:10,140
attack but it was a relevant part on

219
00:09:10,140 --> 00:09:12,660
this on this attack uh basically you

220
00:09:12,660 --> 00:09:16,019
know uses of value credentials um that's

221
00:09:16,019 --> 00:09:19,820
coming as maybe a normal thing right now

222
00:09:19,820 --> 00:09:23,399
and it was a very old local previous

223
00:09:23,399 --> 00:09:25,440
escalation uh so we're going to see

224
00:09:25,440 --> 00:09:28,260
later as well on others uh basically for

225
00:09:28,260 --> 00:09:30,420
Linux tries to be successful you do need

226
00:09:30,420 --> 00:09:33,660
or it's also required to use some uh

227
00:09:33,660 --> 00:09:37,140
some time some type of uh uh local

228
00:09:37,140 --> 00:09:39,959
previous installation exploits and it

229
00:09:39,959 --> 00:09:43,680
was uh the the code was compiled locally

230
00:09:43,680 --> 00:09:45,839
um which you know so you can just you

231
00:09:45,839 --> 00:09:49,920
wget and then compile locally you're not

232
00:09:49,920 --> 00:09:51,240
going to see that on the Windows

233
00:09:51,240 --> 00:09:52,920
environment where trade actor Will you

234
00:09:52,920 --> 00:09:54,779
know like fire up your visual studio and

235
00:09:54,779 --> 00:09:57,720
compile the code locally but that was

236
00:09:57,720 --> 00:09:59,220
the case

237
00:09:59,220 --> 00:10:01,200
um the tool itself it's not clear if

238
00:10:01,200 --> 00:10:02,640
it's like a local traductor it doesn't

239
00:10:02,640 --> 00:10:05,100
think so so that that's why that was

240
00:10:05,100 --> 00:10:06,839
quite interesting

241
00:10:06,839 --> 00:10:09,240
um but um the the attacker with the

242
00:10:09,240 --> 00:10:11,700
domains they use it kind of we believe

243
00:10:11,700 --> 00:10:14,880
it was a local trade actor

244
00:10:14,880 --> 00:10:17,399
um moving on on orbit another uh this

245
00:10:17,399 --> 00:10:19,459
was published by by

246
00:10:19,459 --> 00:10:23,519
integer and it's it's basically it has

247
00:10:23,519 --> 00:10:26,160
the rootkit stealthy capabilities for

248
00:10:26,160 --> 00:10:29,339
the same as symbiot or very similar at

249
00:10:29,339 --> 00:10:32,040
least so here like we can see uh the

250
00:10:32,040 --> 00:10:34,260
directory is listening but I can easily

251
00:10:34,260 --> 00:10:35,940
see my you know the strong password for

252
00:10:35,940 --> 00:10:37,920
my friend how's the video here

253
00:10:37,920 --> 00:10:40,140
um and but it also has an interesting

254
00:10:40,140 --> 00:10:43,200
aspect of using dropper and payload that

255
00:10:43,200 --> 00:10:45,720
that was not very common from from from

256
00:10:45,720 --> 00:10:47,760
the Linux side and you can even install

257
00:10:47,760 --> 00:10:49,980
it and execute it on shared memory so

258
00:10:49,980 --> 00:10:51,720
it's non-consistent on the system at all

259
00:10:51,720 --> 00:10:53,459
or you can choose a directory you want

260
00:10:53,459 --> 00:10:56,700
to install it on a given directory and

261
00:10:56,700 --> 00:10:59,579
another interesting aspect of orbit is

262
00:10:59,579 --> 00:11:02,579
that uses it tries to patch the the

263
00:11:02,579 --> 00:11:06,839
system loader binary so whenever a new

264
00:11:06,839 --> 00:11:09,360
process is spawns in the system it will

265
00:11:09,360 --> 00:11:10,920
execute orbit

266
00:11:10,920 --> 00:11:14,220
um so that's a way or to avoid so for

267
00:11:14,220 --> 00:11:16,440
example if the admin finds out that it's

268
00:11:16,440 --> 00:11:19,320
patching the LDS or preload it also

269
00:11:19,320 --> 00:11:21,720
tries to uh you know use this second

270
00:11:21,720 --> 00:11:25,740
technique and it also relies on python

271
00:11:25,740 --> 00:11:28,200
which is one of the GTO fobs that we've

272
00:11:28,200 --> 00:11:30,500
seen uh for

273
00:11:30,500 --> 00:11:33,180
escalation basically so they create a

274
00:11:33,180 --> 00:11:35,339
user fix it user ID on the system

275
00:11:35,339 --> 00:11:37,860
announce that user logs in it will

276
00:11:37,860 --> 00:11:41,660
execute bash through python

277
00:11:41,660 --> 00:11:44,820
lockbid of course you know we we should

278
00:11:44,820 --> 00:11:48,480
there's always some some restore uh info

279
00:11:48,480 --> 00:11:51,540
um and um and it targets you know VMware

280
00:11:51,540 --> 00:11:55,200
esxi uh we've seen like P2 log P3 as

281
00:11:55,200 --> 00:11:56,459
well

282
00:11:56,459 --> 00:11:58,380
um it's common to say yeah it's

283
00:11:58,380 --> 00:12:00,899
targeting Linux but in a sense most of

284
00:12:00,899 --> 00:12:03,000
these big ransomware players we've seen

285
00:12:03,000 --> 00:12:05,940
uh they are tied primarily esxi doesn't

286
00:12:05,940 --> 00:12:07,260
mean that if you have a Linux

287
00:12:07,260 --> 00:12:09,600
environment or which in your data you

288
00:12:09,600 --> 00:12:12,180
shouldn't care but if it's esxi you

289
00:12:12,180 --> 00:12:14,339
should care much more about that and why

290
00:12:14,339 --> 00:12:15,540
is it relevant

291
00:12:15,540 --> 00:12:17,760
um so this week I could we could not

292
00:12:17,760 --> 00:12:19,860
confirm in terms of the sample itself if

293
00:12:19,860 --> 00:12:23,220
they really fixed this but there was a

294
00:12:23,220 --> 00:12:26,640
bug body of you know 50k US dollars for

295
00:12:26,640 --> 00:12:29,640
someone who found a bug in the

296
00:12:29,640 --> 00:12:31,740
encryption algorithm for their Linux

297
00:12:31,740 --> 00:12:33,660
encrypter so we know if they're willing

298
00:12:33,660 --> 00:12:35,100
to pay that amount of money means

299
00:12:35,100 --> 00:12:37,079
they're really serious about that which

300
00:12:37,079 --> 00:12:39,240
is uh you know seeing criminals playing

301
00:12:39,240 --> 00:12:44,040
back Bounty is a bit scary but yeah

302
00:12:44,040 --> 00:12:44,940
um

303
00:12:44,940 --> 00:12:46,320
also some generic instruction

304
00:12:46,320 --> 00:12:49,860
downloaders there are many of them

305
00:12:49,860 --> 00:12:53,160
um this this one is uh so using lots of

306
00:12:53,160 --> 00:12:55,800
GTFO being so they use

307
00:12:55,800 --> 00:12:57,240
um like courage to download something

308
00:12:57,240 --> 00:13:00,720
we've seen lots of uh

309
00:13:00,720 --> 00:13:03,959
um XM Rigs and and generic coin miners

310
00:13:03,959 --> 00:13:06,300
as well so just download something

311
00:13:06,300 --> 00:13:09,420
executed there's nothing fancy but but

312
00:13:09,420 --> 00:13:11,639
it does a job we've seen uh for example

313
00:13:11,639 --> 00:13:13,920
exploiting the Confluence uh remote

314
00:13:13,920 --> 00:13:16,200
exploit from from last year as well and

315
00:13:16,200 --> 00:13:18,779
just using coin miners I believe you

316
00:13:18,779 --> 00:13:21,240
know on the Windows side if there's like

317
00:13:21,240 --> 00:13:23,100
remote exploit they didn't just install

318
00:13:23,100 --> 00:13:25,680
Point minus but on the Linux phone they

319
00:13:25,680 --> 00:13:27,600
do that a lot this is a fully feature

320
00:13:27,600 --> 00:13:29,940
run software also using just gtf opens

321
00:13:29,940 --> 00:13:33,060
so the usage opens a cell basically uh

322
00:13:33,060 --> 00:13:35,220
to encrypt the uh to encrypt the the

323
00:13:35,220 --> 00:13:36,959
whole directory that's just an example

324
00:13:36,959 --> 00:13:42,260
and again using uh that you get a lot

325
00:13:42,360 --> 00:13:44,579
um this is an interesting sample which

326
00:13:44,579 --> 00:13:47,579
is uh basically a fake Zoom Stellar um

327
00:13:47,579 --> 00:13:49,260
we thought would be nice to share this

328
00:13:49,260 --> 00:13:51,300
because it's really well written so it

329
00:13:51,300 --> 00:13:54,000
pretends to be installing uh you know a

330
00:13:54,000 --> 00:13:57,000
zoom binary while under the hood it

331
00:13:57,000 --> 00:13:59,399
tries to uh exploit verified

332
00:13:59,399 --> 00:14:01,139
vulnerability

333
00:14:01,139 --> 00:14:03,300
um and it uses

334
00:14:03,300 --> 00:14:06,360
um the uh the code that is available on

335
00:14:06,360 --> 00:14:09,480
the public exploit so even the the uh

336
00:14:09,480 --> 00:14:11,279
the user it creates with the same

337
00:14:11,279 --> 00:14:15,240
password so it's not a modified exploit

338
00:14:15,240 --> 00:14:18,660
and then again more GTFO being so like

339
00:14:18,660 --> 00:14:22,380
it tries to execute a reverse shell

340
00:14:22,380 --> 00:14:25,380
using bash pretty much and exfiltrate

341
00:14:25,380 --> 00:14:27,720
the data using core so

342
00:14:27,720 --> 00:14:29,820
um getting all the files from the the

343
00:14:29,820 --> 00:14:32,700
home directory and sending to to the

344
00:14:32,700 --> 00:14:36,300
remote IP and here you see by using Echo

345
00:14:36,300 --> 00:14:39,420
to create a file and of course use the

346
00:14:39,420 --> 00:14:41,160
connection getting timeout but it was

347
00:14:41,160 --> 00:14:43,500
the the the reverse shows running that

348
00:14:43,500 --> 00:14:47,940
would be executed so these are the

349
00:14:47,940 --> 00:14:49,620
summary for for those those threads and

350
00:14:49,620 --> 00:14:51,660
placing opportunity now

351
00:14:51,660 --> 00:14:54,480
okay so we have seen some insights

352
00:14:54,480 --> 00:14:56,459
related to some of the threads that we

353
00:14:56,459 --> 00:14:59,459
were tracking last year and something

354
00:14:59,459 --> 00:15:01,820
that we did in that case was

355
00:15:01,820 --> 00:15:04,560
multiple different processes and for

356
00:15:04,560 --> 00:15:06,899
example this one was in order to get

357
00:15:06,899 --> 00:15:09,360
some let's say detections in the

358
00:15:09,360 --> 00:15:11,279
operating system after Execute some of

359
00:15:11,279 --> 00:15:13,980
the linear threads that we were seeing

360
00:15:13,980 --> 00:15:17,279
with Pedro before so cyclide is a no

361
00:15:17,279 --> 00:15:19,019
personal project that you can download

362
00:15:19,019 --> 00:15:22,860
from GitHub is used to get detection

363
00:15:22,860 --> 00:15:25,019
related to see my rules and you can

364
00:15:25,019 --> 00:15:27,540
execute for example any malware in your

365
00:15:27,540 --> 00:15:30,480
system after that execute cyclide and

366
00:15:30,480 --> 00:15:33,180
let's see if you have any public Sigma

367
00:15:33,180 --> 00:15:35,459
rule in the in the official repository

368
00:15:35,459 --> 00:15:37,560
I'm detecting some specific behavior

369
00:15:37,560 --> 00:15:40,560
used by that specific piece of malware

370
00:15:40,560 --> 00:15:42,660
that you have execute so in this case in

371
00:15:42,660 --> 00:15:45,480
this case you can see the red box and

372
00:15:45,480 --> 00:15:48,120
several detections were found during the

373
00:15:48,120 --> 00:15:50,940
execution of this texture installed and

374
00:15:50,940 --> 00:15:52,320
we have also created three different

375
00:15:52,320 --> 00:15:54,240
Sigma rules that we are starting in a

376
00:15:54,240 --> 00:15:56,639
public GitHub at the end of the

377
00:15:56,639 --> 00:15:58,139
presentation we are going to show you

378
00:15:58,139 --> 00:16:00,480
some others similar that we have created

379
00:16:00,480 --> 00:16:02,760
for some of the threads that we were

380
00:16:02,760 --> 00:16:04,800
researching because the behaviors that

381
00:16:04,800 --> 00:16:07,079
we are detecting the in those specific

382
00:16:07,079 --> 00:16:09,720
scene marrows that we have created are

383
00:16:09,720 --> 00:16:12,180
genetic behaviors are not related stock

384
00:16:12,180 --> 00:16:14,339
to some specific piece of malware so

385
00:16:14,339 --> 00:16:16,560
with it is within this into together

386
00:16:16,560 --> 00:16:18,600
your infrastructure

387
00:16:18,600 --> 00:16:22,380
another thing that we usually do and for

388
00:16:22,380 --> 00:16:25,260
this specific research and made by made

389
00:16:25,260 --> 00:16:28,740
by all the different trusts that we were

390
00:16:28,740 --> 00:16:31,079
tracking was created let's say attack

391
00:16:31,079 --> 00:16:33,899
Flows In order to get all the

392
00:16:33,899 --> 00:16:36,240
understanding the all the knowledge

393
00:16:36,240 --> 00:16:38,880
about how it works when it is executed

394
00:16:38,880 --> 00:16:42,300
why is this useful for us is useful

395
00:16:42,300 --> 00:16:44,579
because we can see all the different

396
00:16:44,579 --> 00:16:47,040
ETF all been executed and also the

397
00:16:47,040 --> 00:16:48,779
different steps made by the thread

398
00:16:48,779 --> 00:16:51,120
actors but I am not going to comment

399
00:16:51,120 --> 00:16:53,279
everything from this slide just I

400
00:16:53,279 --> 00:16:56,339
recommend briefly that you can see in

401
00:16:56,339 --> 00:16:58,680
the screen different colors and the

402
00:16:58,680 --> 00:17:00,779
meaning of the colors are the severity

403
00:17:00,779 --> 00:17:02,579
of the sigma rules that are triggering

404
00:17:02,579 --> 00:17:04,679
some specific behavior in the system so

405
00:17:04,679 --> 00:17:06,660
for example if we go to the red color

406
00:17:06,660 --> 00:17:09,119
the red box is related to a process

407
00:17:09,119 --> 00:17:11,699
create event which means that as a

408
00:17:11,699 --> 00:17:14,520
similar with high severity detecting

409
00:17:14,520 --> 00:17:17,160
that specific behavior and the cool

410
00:17:17,160 --> 00:17:19,980
thing here is that if you click on the

411
00:17:19,980 --> 00:17:21,720
specific Vault you are going to be

412
00:17:21,720 --> 00:17:23,760
related to the sigma rule in order to

413
00:17:23,760 --> 00:17:28,319
get it easy and simple so as you you can

414
00:17:28,319 --> 00:17:30,600
now probably after the summit you are

415
00:17:30,600 --> 00:17:32,280
going to get the presentation and you

416
00:17:32,280 --> 00:17:34,380
can click and get those different

417
00:17:34,380 --> 00:17:36,539
behaviors that we are beginning during

418
00:17:36,539 --> 00:17:39,120
the execution

419
00:17:39,120 --> 00:17:42,480
okay so finally the section relative

420
00:17:42,480 --> 00:17:45,539
similar simulators and and detections is

421
00:17:45,539 --> 00:17:48,480
more let's say similar to the flow that

422
00:17:48,480 --> 00:17:50,880
we saw before but first of all we have

423
00:17:50,880 --> 00:17:53,700
created also a tree map with all the

424
00:17:53,700 --> 00:17:56,700
techniques used by this Sprite Linux

425
00:17:56,700 --> 00:17:58,980
that we were researching something cool

426
00:17:58,980 --> 00:18:02,400
and we have done the same with all the

427
00:18:02,400 --> 00:18:04,799
rest of the families that we that better

428
00:18:04,799 --> 00:18:06,720
was talking before and for time

429
00:18:06,720 --> 00:18:09,780
obviously we we can comment every three

430
00:18:09,780 --> 00:18:12,900
Mark with every family but in the end of

431
00:18:12,900 --> 00:18:14,760
the percentage you have all the slides

432
00:18:14,760 --> 00:18:17,100
and all the three Maps donated for for

433
00:18:17,100 --> 00:18:19,320
the Linux threads and another cool thing

434
00:18:19,320 --> 00:18:22,260
that we did similar to this one the

435
00:18:22,260 --> 00:18:24,539
three months is create Navigator layers

436
00:18:24,539 --> 00:18:27,660
of miter attack with all the ddbs by

437
00:18:27,660 --> 00:18:30,240
every thread that we were searching in

438
00:18:30,240 --> 00:18:32,760
this presentation so you have certainly

439
00:18:32,760 --> 00:18:34,559
the same information but in a Json

440
00:18:34,559 --> 00:18:38,100
format just to use it and for your own

441
00:18:38,100 --> 00:18:40,679
purposes and see if you want to let's

442
00:18:40,679 --> 00:18:42,960
say start your strategy in Linux

443
00:18:42,960 --> 00:18:45,679
environments

444
00:18:45,679 --> 00:18:48,179
okay so really

445
00:18:48,179 --> 00:18:52,380
quite related to to the miter three

446
00:18:52,380 --> 00:18:54,780
method we saw in the last slide and we

447
00:18:54,780 --> 00:18:58,260
have also generated this Matrix we which

448
00:18:58,260 --> 00:18:59,880
has the let's say the different

449
00:18:59,880 --> 00:19:01,799
technique used across the different

450
00:19:01,799 --> 00:19:04,559
families that we were traveling so it

451
00:19:04,559 --> 00:19:06,960
can help you also to get your strategy

452
00:19:06,960 --> 00:19:10,980
in Linux environments and focus or start

453
00:19:10,980 --> 00:19:13,380
doing this in two different way the

454
00:19:13,380 --> 00:19:15,000
first one is fraud Centric and the

455
00:19:15,000 --> 00:19:17,760
second was is Technic Centric

456
00:19:17,760 --> 00:19:20,100
if you want to do it in a in a threat

457
00:19:20,100 --> 00:19:22,320
Centric format probably you want to

458
00:19:22,320 --> 00:19:24,480
focus on those red families that are

459
00:19:24,480 --> 00:19:26,580
using most techniques during the entire

460
00:19:26,580 --> 00:19:29,220
campaigns that we were researching last

461
00:19:29,220 --> 00:19:31,200
year in the other hand if you want to

462
00:19:31,200 --> 00:19:33,840
focus your strategy in in the techniques

463
00:19:33,840 --> 00:19:34,799
entry

464
00:19:34,799 --> 00:19:37,500
probably you want to focus on those that

465
00:19:37,500 --> 00:19:40,080
are with the value of seven or six

466
00:19:40,080 --> 00:19:42,600
because that means that that

467
00:19:42,600 --> 00:19:46,380
specifically was used seven or six times

468
00:19:46,380 --> 00:19:48,900
during the difference in fixing so it's

469
00:19:48,900 --> 00:19:51,360
another cool thing that you can use in

470
00:19:51,360 --> 00:19:53,700
order to let's say prioritize your

471
00:19:53,700 --> 00:19:57,600
security reports in your organization

472
00:19:57,600 --> 00:20:01,559
similar to the flowchart that we saw

473
00:20:01,559 --> 00:20:04,919
before related with the with the entire

474
00:20:04,919 --> 00:20:06,799
intrusion

475
00:20:06,799 --> 00:20:09,799
with the different steps by made by the

476
00:20:09,799 --> 00:20:13,320
productors we have also uh done

477
00:20:13,320 --> 00:20:15,720
something called activity threats which

478
00:20:15,720 --> 00:20:18,360
is a concept of the diode model for

479
00:20:18,360 --> 00:20:22,020
intrusion analysis paper and the goal of

480
00:20:22,020 --> 00:20:24,780
these activity threads is let's say

481
00:20:24,780 --> 00:20:27,720
split all the different steps by thread

482
00:20:27,720 --> 00:20:30,419
actors in different let's say let's say

483
00:20:30,419 --> 00:20:32,840
buckets the buckets are the different

484
00:20:32,840 --> 00:20:36,539
Guild chain faces so we have done this

485
00:20:36,539 --> 00:20:38,160
with all the families that we were

486
00:20:38,160 --> 00:20:40,320
tracking last year in this case you can

487
00:20:40,320 --> 00:20:42,120
see for example the identify intrusion

488
00:20:42,120 --> 00:20:45,780
which was splitted in different field

489
00:20:45,780 --> 00:20:47,940
same phrases so

490
00:20:47,940 --> 00:20:50,640
with that what we are going to try to

491
00:20:50,640 --> 00:20:53,760
achieve is let's say get patterns in

492
00:20:53,760 --> 00:20:56,760
some specific a phases of the guild

493
00:20:56,760 --> 00:20:59,640
chain helping us to in the future who

494
00:20:59,640 --> 00:21:02,100
knows get some attribution based on

495
00:21:02,100 --> 00:21:05,000
patterns or behavior similar behaviors

496
00:21:05,000 --> 00:21:07,380
started by some thread actors in

497
00:21:07,380 --> 00:21:10,200
different intrusion for example in the

498
00:21:10,200 --> 00:21:12,360
table of the right you can see the

499
00:21:12,360 --> 00:21:15,120
different events with a specific action

500
00:21:15,120 --> 00:21:17,640
made by the thread actor and number five

501
00:21:17,640 --> 00:21:20,280
is just an installation of a service in

502
00:21:20,280 --> 00:21:22,500
the system as you can see but we made

503
00:21:22,500 --> 00:21:24,360
the same with all the entire linear

504
00:21:24,360 --> 00:21:27,000
threads but not only focusing on on the

505
00:21:27,000 --> 00:21:29,880
on the malware execution for itself and

506
00:21:29,880 --> 00:21:32,580
focusing on the entire intrusion the

507
00:21:32,580 --> 00:21:36,360
malware was just in a piece of of a step

508
00:21:36,360 --> 00:21:38,700
made by the thread actor but they were

509
00:21:38,700 --> 00:21:41,220
also seeing other pieces of malware

510
00:21:41,220 --> 00:21:44,120
during the infection so as I said before

511
00:21:44,120 --> 00:21:46,980
what we are trying to do here is get the

512
00:21:46,980 --> 00:21:50,340
data into buckets in order to focus on

513
00:21:50,340 --> 00:21:51,840
some specific

514
00:21:51,840 --> 00:21:54,120
guilts in face and get the information

515
00:21:54,120 --> 00:21:56,340
that the thread actor were doing in that

516
00:21:56,340 --> 00:21:59,520
specific pace and also this can help us

517
00:21:59,520 --> 00:22:01,679
to clustering and attributing in the

518
00:22:01,679 --> 00:22:05,220
future in our CTI processes

519
00:22:05,220 --> 00:22:07,559
and with the same information of the

520
00:22:07,559 --> 00:22:11,039
thread activity with the outcome of that

521
00:22:11,039 --> 00:22:13,559
productivity we have created also a Dion

522
00:22:13,559 --> 00:22:16,679
model High Diane model with the patents

523
00:22:16,679 --> 00:22:18,960
that we have served in all the intrusion

524
00:22:18,960 --> 00:22:21,780
during the 2020 tooling threats that we

525
00:22:21,780 --> 00:22:24,240
were researching pattern itself so this

526
00:22:24,240 --> 00:22:27,360
is also let's say a good approach to a

527
00:22:27,360 --> 00:22:29,580
start focusing or start doing some

528
00:22:29,580 --> 00:22:31,500
strategy in your organization related to

529
00:22:31,500 --> 00:22:33,960
link thread because here we have some of

530
00:22:33,960 --> 00:22:36,179
the patterns that we were observing

531
00:22:36,179 --> 00:22:39,000
during the last year and can be useful

532
00:22:39,000 --> 00:22:41,360
in order to prioritize

533
00:22:41,360 --> 00:22:44,400
those security efforts in your in your

534
00:22:44,400 --> 00:22:46,799
organization so you have there all the

535
00:22:46,799 --> 00:22:48,480
capabilities that we have observed in

536
00:22:48,480 --> 00:22:50,640
the last year also the infrastructure

537
00:22:50,640 --> 00:22:51,679
the

538
00:22:51,679 --> 00:22:53,760
infrastructure or the different steps

539
00:22:53,760 --> 00:22:56,580
made in that specific part of the ion

540
00:22:56,580 --> 00:22:58,200
model

541
00:22:58,200 --> 00:22:59,880
um yeah I think that

542
00:22:59,880 --> 00:23:02,039
will be will be nice enough to just

543
00:23:02,039 --> 00:23:04,679
start doing some stuff related to link

544
00:23:04,679 --> 00:23:08,220
thread so better please

545
00:23:08,220 --> 00:23:10,020
um wrapping up here some some

546
00:23:10,020 --> 00:23:11,940
conclusions and just few recommendations

547
00:23:11,940 --> 00:23:15,000
of course to have way more but

548
00:23:15,000 --> 00:23:16,919
um I believe you know previously

549
00:23:16,919 --> 00:23:18,600
escalations from all the attacks you see

550
00:23:18,600 --> 00:23:20,400
is always needed

551
00:23:20,400 --> 00:23:22,740
um there were at least 16 uh local

552
00:23:22,740 --> 00:23:24,360
previous installations from last year so

553
00:23:24,360 --> 00:23:26,400
that that comes down to you know first

554
00:23:26,400 --> 00:23:28,140
recommendation you know system patch

555
00:23:28,140 --> 00:23:30,720
nothing novel to here but

556
00:23:30,720 --> 00:23:32,880
um and we've seen like I mentioned some

557
00:23:32,880 --> 00:23:34,740
remote exploitation not necessarily

558
00:23:34,740 --> 00:23:37,080
leads to defense attacks like you know

559
00:23:37,080 --> 00:23:39,900
calling minor being installed on system

560
00:23:39,900 --> 00:23:42,480
um on Linux we've seen also lots of Open

561
00:23:42,480 --> 00:23:45,900
Source uh usage like uh time shell very

562
00:23:45,900 --> 00:23:49,320
old piece of gold Charles red as well

563
00:23:49,320 --> 00:23:51,900
um even single downloaded like from

564
00:23:51,900 --> 00:23:54,659
using the the source code so they do not

565
00:23:54,659 --> 00:23:58,260
really uh care about protecting it of

566
00:23:58,260 --> 00:24:00,120
course if we compare with the Linux or

567
00:24:00,120 --> 00:24:02,520
the windows Ward there were lots of

568
00:24:02,520 --> 00:24:04,860
leaks on the cyber crime scene from you

569
00:24:04,860 --> 00:24:09,780
know early 2012 13 and until 2015 so for

570
00:24:09,780 --> 00:24:13,260
example Carver or Zeus Lee but those are

571
00:24:13,260 --> 00:24:15,059
all were all leaks right here they're

572
00:24:15,059 --> 00:24:17,039
just you know giving out source code

573
00:24:17,039 --> 00:24:18,600
someone else

574
00:24:18,600 --> 00:24:20,520
um that was quite a difference that we

575
00:24:20,520 --> 00:24:23,880
found and it has lots of

576
00:24:23,880 --> 00:24:27,600
um simple stuff like those XM rig and

577
00:24:27,600 --> 00:24:30,419
other coal miners but it can turns into

578
00:24:30,419 --> 00:24:32,640
advanced back doors as we've seen with

579
00:24:32,640 --> 00:24:35,220
scene build and orbit as well

580
00:24:35,220 --> 00:24:37,799
um and just using like opens itself and

581
00:24:37,799 --> 00:24:40,020
a few other tools GTFO beans can turn

582
00:24:40,020 --> 00:24:43,919
into a fully feature a resource and

583
00:24:43,919 --> 00:24:46,620
or recommendations like I mentioned you

584
00:24:46,620 --> 00:24:49,080
know system patch being being one

585
00:24:49,080 --> 00:24:51,840
interesting one on the network side do

586
00:24:51,840 --> 00:24:54,960
not unders made and Linux traffic as

587
00:24:54,960 --> 00:24:56,880
we've seen uh so like enes traffic

588
00:24:56,880 --> 00:24:59,760
coming from them and yeah sweet bits is

589
00:24:59,760 --> 00:25:01,740
still relevant most of the tanks we've

590
00:25:01,740 --> 00:25:04,320
seen uh these two use you know sweet

591
00:25:04,320 --> 00:25:06,780
bits or for for escalation so that's

592
00:25:06,780 --> 00:25:08,400
something to check in the system of

593
00:25:08,400 --> 00:25:10,200
course

594
00:25:10,200 --> 00:25:13,500
um okay and finally as I said before we

595
00:25:13,500 --> 00:25:16,080
have generated different outcomes based

596
00:25:16,080 --> 00:25:17,940
on this presentation so you have in our

597
00:25:17,940 --> 00:25:20,460
public GitHub and five Sigma rules that

598
00:25:20,460 --> 00:25:23,480
we have created foreign

599
00:25:23,480 --> 00:25:26,580
families that we were tracking and also

600
00:25:26,580 --> 00:25:29,100
you have the attached Navigator layers

601
00:25:29,100 --> 00:25:31,500
for those red families that you are

602
00:25:31,500 --> 00:25:34,799
seeing there so or it will help you to

603
00:25:34,799 --> 00:25:37,860
start doing stuff in in Linux and I

604
00:25:37,860 --> 00:25:39,960
think that's all from our side so thank

605
00:25:39,960 --> 00:25:41,820
you so much for your time and there you

606
00:25:41,820 --> 00:25:43,910
have our social media

607
00:25:43,910 --> 00:25:44,260
[Applause]

608
00:25:44,260 --> 00:25:48,210
[Music]

