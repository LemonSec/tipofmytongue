1
00:00:00,659 --> 00:00:02,900
foreign

2
00:00:06,859 --> 00:00:09,240
thank you so much for being here my name

3
00:00:09,240 --> 00:00:10,860
is Lena and today we're going to be

4
00:00:10,860 --> 00:00:13,740
talking about Cobalt Mirage what I hope

5
00:00:13,740 --> 00:00:15,660
you get out of this presentation is

6
00:00:15,660 --> 00:00:18,240
firstly an understanding of Iran's cyber

7
00:00:18,240 --> 00:00:20,820
operation and how it makes attribution

8
00:00:20,820 --> 00:00:22,920
and grouping extremely difficult for

9
00:00:22,920 --> 00:00:25,500
threat Intel I'm also going to talk a

10
00:00:25,500 --> 00:00:27,480
lot about the role of contractors in

11
00:00:27,480 --> 00:00:30,000
Iran and especially about how the

12
00:00:30,000 --> 00:00:31,560
Iranian government works with these

13
00:00:31,560 --> 00:00:34,500
contractor organizations how they work

14
00:00:34,500 --> 00:00:36,840
across various apt groups and how

15
00:00:36,840 --> 00:00:39,059
they're leveraged and then we're also

16
00:00:39,059 --> 00:00:41,700
going to touch on opsec mistakes which

17
00:00:41,700 --> 00:00:43,680
is I guess a really common topic when it

18
00:00:43,680 --> 00:00:46,320
comes to Iranian apt groups but in this

19
00:00:46,320 --> 00:00:48,180
instance I'm going to cover how it

20
00:00:48,180 --> 00:00:51,180
helped us identify the CEO of a

21
00:00:51,180 --> 00:00:53,039
contractor organization that was

22
00:00:53,039 --> 00:00:55,920
involved with Cobalt Mirage

23
00:00:55,920 --> 00:00:58,199
quick disclaimer this is not a

24
00:00:58,199 --> 00:00:59,940
reflection of my personal political

25
00:00:59,940 --> 00:01:02,399
views nor does this reflect my

26
00:01:02,399 --> 00:01:04,799
employer's political views

27
00:01:04,799 --> 00:01:08,040
so Iranian cyber governance is really

28
00:01:08,040 --> 00:01:11,100
complex and when you talk about it it's

29
00:01:11,100 --> 00:01:13,920
very hard for Outsiders to grasp and

30
00:01:13,920 --> 00:01:16,020
this is primarily due to the fact that

31
00:01:16,020 --> 00:01:18,060
there are several different units

32
00:01:18,060 --> 00:01:20,820
several Ministries with overlapping

33
00:01:20,820 --> 00:01:22,799
mandates efforts and responsibilities

34
00:01:22,799 --> 00:01:25,619
but if we approach it generally there

35
00:01:25,619 --> 00:01:28,259
are two core structures the moas which

36
00:01:28,259 --> 00:01:30,240
stands for the ministry of intelligence

37
00:01:30,240 --> 00:01:33,299
and security and irgc that stands for

38
00:01:33,299 --> 00:01:34,979
the Islamic revolutionary governance

39
00:01:34,979 --> 00:01:40,200
court now back in 2012 the moas was the

40
00:01:40,200 --> 00:01:42,840
main cyberpower but over the last decade

41
00:01:42,840 --> 00:01:46,020
irgc has steadily gained more control

42
00:01:46,020 --> 00:01:48,540
and influence and the reason why there

43
00:01:48,540 --> 00:01:50,700
are two units in Iran is so that there's

44
00:01:50,700 --> 00:01:53,340
no single organization has a monopoly

45
00:01:53,340 --> 00:01:56,520
over the intelligence and how even

46
00:01:56,520 --> 00:01:58,619
though these two units kind of compete

47
00:01:58,619 --> 00:02:01,320
for political power and influence they

48
00:02:01,320 --> 00:02:03,299
share the joint goal in preserving

49
00:02:03,299 --> 00:02:06,180
Iran's Islamic regime and so they do

50
00:02:06,180 --> 00:02:07,920
actually cross over and share

51
00:02:07,920 --> 00:02:09,840
intelligence

52
00:02:09,840 --> 00:02:12,000
this is a loose diagram of what the

53
00:02:12,000 --> 00:02:14,340
Cyber structure appears to be like now

54
00:02:14,340 --> 00:02:16,739
just a quick caveat this is my personal

55
00:02:16,739 --> 00:02:18,900
interpretation that I built from a

56
00:02:18,900 --> 00:02:21,060
collection of documents I took from the

57
00:02:21,060 --> 00:02:23,520
USA Library of Congress they had white

58
00:02:23,520 --> 00:02:25,879
papers on Iran's military structure

59
00:02:25,879 --> 00:02:28,980
several research papers Wikipedia

60
00:02:28,980 --> 00:02:30,900
articles and I kind of coupled this

61
00:02:30,900 --> 00:02:33,239
together now the reason why I say this

62
00:02:33,239 --> 00:02:35,580
is because there is no formal document

63
00:02:35,580 --> 00:02:37,440
that the Iranian government has released

64
00:02:37,440 --> 00:02:39,360
about what their cyber structure looks

65
00:02:39,360 --> 00:02:41,879
like and so you know there's no like

66
00:02:41,879 --> 00:02:44,700
formal definition of what it appears to

67
00:02:44,700 --> 00:02:48,000
be like so at the very top you have

68
00:02:48,000 --> 00:02:50,280
Iran's supreme leader now the black

69
00:02:50,280 --> 00:02:52,620
lines represent a direct connection and

70
00:02:52,620 --> 00:02:54,480
the dotted lines represent an indirect

71
00:02:54,480 --> 00:02:56,700
connection the two that I really want

72
00:02:56,700 --> 00:02:58,920
you to focus on are what I've put in

73
00:02:58,920 --> 00:03:02,760
pink so the irgc and also mowers

74
00:03:02,760 --> 00:03:05,459
now you'll see irgc sits under the

75
00:03:05,459 --> 00:03:08,040
Supreme Council of cyberspace and it has

76
00:03:08,040 --> 00:03:09,840
several different units sitting

77
00:03:09,840 --> 00:03:11,760
underneath it including its own

78
00:03:11,760 --> 00:03:13,920
intelligence organization

79
00:03:13,920 --> 00:03:16,680
under the president we've got mois and

80
00:03:16,680 --> 00:03:18,900
mois has an indirect link to the cod's

81
00:03:18,900 --> 00:03:22,200
force but mois itself has around 16

82
00:03:22,200 --> 00:03:25,680
different intelligence units as well

83
00:03:25,680 --> 00:03:28,560
so what's really interesting and what

84
00:03:28,560 --> 00:03:30,540
generates complexity when it comes to

85
00:03:30,540 --> 00:03:33,720
attribution with Iran is that although

86
00:03:33,720 --> 00:03:35,220
there are two different structures

87
00:03:35,220 --> 00:03:38,220
competing for power specific individuals

88
00:03:38,220 --> 00:03:41,040
have been linked to working for both so

89
00:03:41,040 --> 00:03:42,540
when it comes to performing threat

90
00:03:42,540 --> 00:03:45,720
attribution you can't uh but you can't

91
00:03:45,720 --> 00:03:47,640
basically isolate a specific individual

92
00:03:47,640 --> 00:03:49,440
and use that to perform your attribution

93
00:03:49,440 --> 00:03:52,920
so in 2016 Flashpoint highlighted the

94
00:03:52,920 --> 00:03:55,860
individual named Medi fahadi and he was

95
00:03:55,860 --> 00:03:58,379
doxed by a whistleblower that linked him

96
00:03:58,379 --> 00:04:01,799
to operations pertaining to the irgc

97
00:04:01,799 --> 00:04:04,920
however in 2019 labductigen actually

98
00:04:04,920 --> 00:04:07,620
linked the same person to working with a

99
00:04:07,620 --> 00:04:09,840
threat group that we call Cobalt Hickman

100
00:04:09,840 --> 00:04:12,360
at secureworks or you might you may have

101
00:04:12,360 --> 00:04:15,079
seen this referred to as oil rig or

102
00:04:15,079 --> 00:04:17,579
apt-34 which is directly linked to

103
00:04:17,579 --> 00:04:19,380
mowers

104
00:04:19,380 --> 00:04:21,540
it gets even more complex because it's

105
00:04:21,540 --> 00:04:24,120
not just individuals may work between

106
00:04:24,120 --> 00:04:27,660
irgc and mowers or or specific apt

107
00:04:27,660 --> 00:04:29,639
groups underneath them but also

108
00:04:29,639 --> 00:04:32,639
organizations shift allegiances or

109
00:04:32,639 --> 00:04:36,180
alliances or work across both structures

110
00:04:36,180 --> 00:04:38,699
there is a very Infamous contractor

111
00:04:38,699 --> 00:04:41,520
organization known as Eminem passagard

112
00:04:41,520 --> 00:04:43,440
that has been linked by the U.S

113
00:04:43,440 --> 00:04:45,780
government back in 2020 for having

114
00:04:45,780 --> 00:04:48,120
attempted to tamper with the U.S

115
00:04:48,120 --> 00:04:50,520
elections and the U.S government

116
00:04:50,520 --> 00:04:52,620
actually released a treasury a

117
00:04:52,620 --> 00:04:55,919
publication with a 10 million bounty on

118
00:04:55,919 --> 00:04:57,840
this organization

119
00:04:57,840 --> 00:05:00,960
the way of how they performed electoral

120
00:05:00,960 --> 00:05:03,180
tampering was through obtaining voter

121
00:05:03,180 --> 00:05:05,639
information they threatened voters they

122
00:05:05,639 --> 00:05:07,680
released its information they tried to

123
00:05:07,680 --> 00:05:09,900
access voting websites and they even

124
00:05:09,900 --> 00:05:12,960
infiltrated a media company

125
00:05:12,960 --> 00:05:14,940
this this organization has actually

126
00:05:14,940 --> 00:05:16,500
changed their name several times to

127
00:05:16,500 --> 00:05:18,660
different variations of eminent pasigad

128
00:05:18,660 --> 00:05:21,780
probably as a means of trying to I guess

129
00:05:21,780 --> 00:05:24,000
obfuscate themselves but during this

130
00:05:24,000 --> 00:05:25,620
period when they were tampering with the

131
00:05:25,620 --> 00:05:28,380
elections they were linked to moa's

132
00:05:28,380 --> 00:05:32,039
however in 2021 the next year the same

133
00:05:32,039 --> 00:05:35,400
organization was linked to irgc and this

134
00:05:35,400 --> 00:05:37,380
was discovered because laptop Tegan

135
00:05:37,380 --> 00:05:39,479
leaked a whole bunch of documents which

136
00:05:39,479 --> 00:05:43,259
they tend to do seemingly frequently and

137
00:05:43,259 --> 00:05:46,020
these documents basically uh

138
00:05:46,020 --> 00:05:48,060
demonstrated there was a project under

139
00:05:48,060 --> 00:05:49,860
the Iranian government called project

140
00:05:49,860 --> 00:05:51,000
signal

141
00:05:51,000 --> 00:05:54,060
and this project signal campaign was

142
00:05:54,060 --> 00:05:56,340
about the release of a ransomware called

143
00:05:56,340 --> 00:05:58,440
the pay to key ransomware and Eminem

144
00:05:58,440 --> 00:06:00,120
passegard was the organization

145
00:06:00,120 --> 00:06:02,940
affiliated with it

146
00:06:02,940 --> 00:06:05,880
if we take a look at irgc and what we

147
00:06:05,880 --> 00:06:07,620
know in terms of contract or

148
00:06:07,620 --> 00:06:10,800
organizations and units linked to this

149
00:06:10,800 --> 00:06:13,259
particular structure

150
00:06:13,259 --> 00:06:16,139
you will see gets even murkier the first

151
00:06:16,139 --> 00:06:19,380
three are units within the irgc the

152
00:06:19,380 --> 00:06:21,960
first one being Shahid kave and actually

153
00:06:21,960 --> 00:06:24,660
Sky News did a really great expose on

154
00:06:24,660 --> 00:06:27,120
this particular military unit and they

155
00:06:27,120 --> 00:06:28,979
highlighted how they had a secret group

156
00:06:28,979 --> 00:06:30,720
within this structure called

157
00:06:30,720 --> 00:06:32,940
intelligence team 13.

158
00:06:32,940 --> 00:06:34,740
and this particular unit you know

159
00:06:34,740 --> 00:06:36,900
documents were leaked and it talked

160
00:06:36,900 --> 00:06:39,539
about how they were interested in how to

161
00:06:39,539 --> 00:06:42,479
perform cyber attacks to sync cargo

162
00:06:42,479 --> 00:06:44,880
ships blow up fuel tanks at Petrol

163
00:06:44,880 --> 00:06:47,100
Station or you know intercept

164
00:06:47,100 --> 00:06:49,560
communication devices used by the global

165
00:06:49,560 --> 00:06:50,880
shipping industry

166
00:06:50,880 --> 00:06:52,620
then there's the cuts Force which

167
00:06:52,620 --> 00:06:55,199
eminent passer guard is a part of and

168
00:06:55,199 --> 00:06:58,380
their actual military name was leaked by

169
00:06:58,380 --> 00:07:01,199
laptop Teigen called Shahid srushtari

170
00:07:01,199 --> 00:07:03,419
please don't put uh I know I feel I'm

171
00:07:03,419 --> 00:07:05,660
butchering all these names so

172
00:07:05,660 --> 00:07:08,639
uh uh then there's Cobalt Dickens

173
00:07:08,639 --> 00:07:10,620
Fireside and Mirage which are the

174
00:07:10,620 --> 00:07:12,240
various threat groups that we track at

175
00:07:12,240 --> 00:07:15,419
secureworks I put Mirage in bright pink

176
00:07:15,419 --> 00:07:16,800
because that's what we're going to be

177
00:07:16,800 --> 00:07:19,020
talking about today specifically in this

178
00:07:19,020 --> 00:07:21,599
presentation I'm gonna demonstrate how

179
00:07:21,599 --> 00:07:24,599
we linked Naji technology and offcast

180
00:07:24,599 --> 00:07:26,460
systems both of these contractor

181
00:07:26,460 --> 00:07:28,979
organizations to Mirage that sits under

182
00:07:28,979 --> 00:07:30,660
irgc

183
00:07:30,660 --> 00:07:32,819
then you'll see there's a whole Suite of

184
00:07:32,819 --> 00:07:36,060
other contractor organizations that are

185
00:07:36,060 --> 00:07:38,759
affiliated with irgc however we haven't

186
00:07:38,759 --> 00:07:41,340
specifically grouped them under threat

187
00:07:41,340 --> 00:07:44,039
group and this is due to not having

188
00:07:44,039 --> 00:07:45,720
enough observables or not having enough

189
00:07:45,720 --> 00:07:48,360
Telemetry for us at secureworks to be

190
00:07:48,360 --> 00:07:51,539
able to properly perform the grouping

191
00:07:51,539 --> 00:07:54,060
your next logical question might be okay

192
00:07:54,060 --> 00:07:56,340
so the Iranian government uses contract

193
00:07:56,340 --> 00:07:58,800
units but how do you actually identify

194
00:07:58,800 --> 00:08:01,560
them and the answer to this is multiple

195
00:08:01,560 --> 00:08:04,680
ways primarily the best source the more

196
00:08:04,680 --> 00:08:06,180
definitive source for this would be

197
00:08:06,180 --> 00:08:09,180
through U.S warrants where they confirm

198
00:08:09,180 --> 00:08:12,240
suspicions or ideas that we may see

199
00:08:12,240 --> 00:08:14,460
through incident response engagements

200
00:08:14,460 --> 00:08:16,979
the second way is through a lot of our

201
00:08:16,979 --> 00:08:19,020
research and through incident response

202
00:08:19,020 --> 00:08:20,819
engagements so the way that we perform

203
00:08:20,819 --> 00:08:23,520
the linkage between Cobalt Mirage and

204
00:08:23,520 --> 00:08:26,400
Naji and also to Afghan systems these

205
00:08:26,400 --> 00:08:28,740
two companies was through things that we

206
00:08:28,740 --> 00:08:30,599
observed during incident responsing

207
00:08:30,599 --> 00:08:34,020
agents and then lastly uh confirming

208
00:08:34,020 --> 00:08:36,419
some of the things we see against what

209
00:08:36,419 --> 00:08:38,520
whistleblowers release so what laptop

210
00:08:38,520 --> 00:08:42,059
Tegan comes out and talks about so that

211
00:08:42,059 --> 00:08:44,720
that we kind of use this as the main

212
00:08:44,720 --> 00:08:46,620
method of identifying contact

213
00:08:46,620 --> 00:08:49,019
organizations

214
00:08:49,019 --> 00:08:52,920
in terms of how we linked Mirage to Naji

215
00:08:52,920 --> 00:08:56,760
and afghar uh basically we figured out

216
00:08:56,760 --> 00:08:58,800
that Naji and afghar were both working

217
00:08:58,800 --> 00:09:01,820
under Cobalt Mirage controlled by irgc

218
00:09:01,820 --> 00:09:04,620
you'll see this this beautiful poster

219
00:09:04,620 --> 00:09:06,959
that laptop Tegan made which I guess is

220
00:09:06,959 --> 00:09:09,899
their version of the FBI wanted poster

221
00:09:09,899 --> 00:09:13,260
you've got the photo of Ahmed khatibi

222
00:09:13,260 --> 00:09:16,200
which is the CEO of afka and then the

223
00:09:16,200 --> 00:09:18,899
CEO of Naji which is manso Ahmadi and

224
00:09:18,899 --> 00:09:20,399
then you've got all their employees

225
00:09:20,399 --> 00:09:22,080
under them

226
00:09:22,080 --> 00:09:25,080
so we knew from IR engagements that

227
00:09:25,080 --> 00:09:27,420
these two organizations and specifically

228
00:09:27,420 --> 00:09:30,360
we identified these two CEOs to be

229
00:09:30,360 --> 00:09:32,399
linked to Mirage but this was actually

230
00:09:32,399 --> 00:09:34,920
confirmed uh towards the end of last

231
00:09:34,920 --> 00:09:37,740
year also by FBI warrants for members of

232
00:09:37,740 --> 00:09:39,660
both of these organizations linking them

233
00:09:39,660 --> 00:09:42,540
to the Iranian government

234
00:09:42,540 --> 00:09:44,820
specifically how we managed to link

235
00:09:44,820 --> 00:09:47,700
Mirage to Naji technology was during an

236
00:09:47,700 --> 00:09:50,459
IR engagement we identified two known

237
00:09:50,459 --> 00:09:53,940
Cobalt Mirage domains new desktop and

238
00:09:53,940 --> 00:09:58,440
Symantec server and basically these were

239
00:09:58,440 --> 00:10:01,560
hosted on a specific IP That Was Then

240
00:10:01,560 --> 00:10:05,279
linked to two git repositories secner.ir

241
00:10:05,279 --> 00:10:09,839
and naji.ir and surprisingly naji.ir was

242
00:10:09,839 --> 00:10:12,360
this was the official website for naiji

243
00:10:12,360 --> 00:10:15,959
technology and a specific handle on that

244
00:10:15,959 --> 00:10:19,560
git was unknown with 19 that is actually

245
00:10:19,560 --> 00:10:22,860
the handle that Mansa Ahmadi uses and he

246
00:10:22,860 --> 00:10:25,860
is the CEO of Naji technology

247
00:10:25,860 --> 00:10:27,360
if you want to read more about the story

248
00:10:27,360 --> 00:10:28,860
I've actually got the link under the

249
00:10:28,860 --> 00:10:30,720
photo so you can read a little more

250
00:10:30,720 --> 00:10:32,160
comprehensively about how we perform

251
00:10:32,160 --> 00:10:34,500
this attribution

252
00:10:34,500 --> 00:10:37,260
in terms of how organization or how

253
00:10:37,260 --> 00:10:40,200
contractor organizations are hired the

254
00:10:40,200 --> 00:10:42,360
balance between of contractor

255
00:10:42,360 --> 00:10:44,339
organizations and the Iranian government

256
00:10:44,339 --> 00:10:47,040
seems to be that contractors tend to

257
00:10:47,040 --> 00:10:49,980
need to be ideologically aligned with

258
00:10:49,980 --> 00:10:53,220
irgcm mowers and they work specifically

259
00:10:53,220 --> 00:10:57,120
with an assigned irgcmos middle manager

260
00:10:57,120 --> 00:11:00,720
now this hasn't been proven per se but

261
00:11:00,720 --> 00:11:03,600
lots of Tegan theorized that the two

262
00:11:03,600 --> 00:11:06,899
irgc middle managers that manage afka

263
00:11:06,899 --> 00:11:10,380
and Naji Tech are harmed visa and Ahmed

264
00:11:10,380 --> 00:11:13,160
asfandi and both of these are commanders

265
00:11:13,160 --> 00:11:15,839
one for the intelligence organization

266
00:11:15,839 --> 00:11:19,140
under the irgc and the other that runs

267
00:11:19,140 --> 00:11:21,720
the hacking Center

268
00:11:21,720 --> 00:11:24,060
what the picture looks like in terms of

269
00:11:24,060 --> 00:11:26,459
mowers uh this is just a high level

270
00:11:26,459 --> 00:11:27,899
picture of what we know and what this

271
00:11:27,899 --> 00:11:30,360
seems to be we have various third groups

272
00:11:30,360 --> 00:11:33,300
that we track relating to Mummers some

273
00:11:33,300 --> 00:11:36,360
are hard linked to Mars by the US

274
00:11:36,360 --> 00:11:40,560
government I think in January 2022 the

275
00:11:40,560 --> 00:11:42,959
US government came out and linked Cobalt

276
00:11:42,959 --> 00:11:44,700
Ulster which is also known as muddy

277
00:11:44,700 --> 00:11:48,360
water to MOA specifically under Iran

278
00:11:48,360 --> 00:11:51,240
we also track Trinity Hickman and Gypsy

279
00:11:51,240 --> 00:11:53,279
as well eminent passegard obviously

280
00:11:53,279 --> 00:11:55,260
linked to moas through the Electoral

281
00:11:55,260 --> 00:11:57,540
tampering Revenge cyber Tech was

282
00:11:57,540 --> 00:11:59,519
identified by a Flashpoint where they

283
00:11:59,519 --> 00:12:01,740
found that this they basically host

284
00:12:01,740 --> 00:12:03,360
websites and they hosted a suite of

285
00:12:03,360 --> 00:12:05,820
websites that were linked to moa's

286
00:12:05,820 --> 00:12:06,899
operations

287
00:12:06,899 --> 00:12:08,940
Trinity we haven't seen too much

288
00:12:08,940 --> 00:12:11,579
operation recently in terms of that

289
00:12:11,579 --> 00:12:14,160
specific threat group but uh just a

290
00:12:14,160 --> 00:12:16,560
little bit of background ashiyan is a

291
00:12:16,560 --> 00:12:19,800
Iranian hacking forum and there was a

292
00:12:19,800 --> 00:12:22,160
specific specific user called

293
00:12:22,160 --> 00:12:25,200
x-man1365 that mandian identified as the

294
00:12:25,200 --> 00:12:27,779
creator of a amalware called the turned

295
00:12:27,779 --> 00:12:29,459
up back door which was then linked to

296
00:12:29,459 --> 00:12:31,260
Nazar Institute

297
00:12:31,260 --> 00:12:34,560
now mowers actually also has a series of

298
00:12:34,560 --> 00:12:38,399
affiliations with these universities and

299
00:12:38,399 --> 00:12:41,040
this is through not only how they

300
00:12:41,040 --> 00:12:43,500
perform hiring but also through

301
00:12:43,500 --> 00:12:45,300
operations where some of these

302
00:12:45,300 --> 00:12:46,800
universities have actually been linked

303
00:12:46,800 --> 00:12:49,500
to specific compromises

304
00:12:49,500 --> 00:12:52,200
now there is a U.S Congress white paper

305
00:12:52,200 --> 00:12:54,899
about Morris and how the recruitment

306
00:12:54,899 --> 00:12:57,600
occurs now of course although this was

307
00:12:57,600 --> 00:12:59,639
released by the US Congress doesn't

308
00:12:59,639 --> 00:13:02,100
necessarily indicate this is 100 the

309
00:13:02,100 --> 00:13:05,459
case it may be don't know you know at

310
00:13:05,459 --> 00:13:07,740
this point but over the last few years

311
00:13:07,740 --> 00:13:11,100
although the US Congress said most hires

312
00:13:11,100 --> 00:13:12,959
people specifically through Emma

313
00:13:12,959 --> 00:13:15,540
Mohammed bhaga University over the last

314
00:13:15,540 --> 00:13:17,940
few years Morris has also been

315
00:13:17,940 --> 00:13:20,040
affiliated with hakani school which came

316
00:13:20,040 --> 00:13:21,959
out in the Washington Times Shahid

317
00:13:21,959 --> 00:13:24,300
bahashti and also Imam Hussein

318
00:13:24,300 --> 00:13:26,599
University

319
00:13:26,820 --> 00:13:28,980
in terms of what they look for in

320
00:13:28,980 --> 00:13:31,980
applicants the most important aspect is

321
00:13:31,980 --> 00:13:35,940
having an ideological alignment so these

322
00:13:35,940 --> 00:13:37,920
applicants need to have a belief in

323
00:13:37,920 --> 00:13:40,800
Islam they need to have citizenship and

324
00:13:40,800 --> 00:13:42,899
they need to be mentally and healthily

325
00:13:42,899 --> 00:13:45,779
uh I guess mentally mentally sound and

326
00:13:45,779 --> 00:13:49,680
physically sound which I feel are pretty

327
00:13:49,680 --> 00:13:51,899
General worldwide I guess minus the

328
00:13:51,899 --> 00:13:54,180
faith aspect

329
00:13:54,180 --> 00:13:58,680
from 2020 until now several apt groups

330
00:13:58,680 --> 00:14:00,660
from Iran have been linked to ransomware

331
00:14:00,660 --> 00:14:03,060
attacks and I think this is really what

332
00:14:03,060 --> 00:14:05,700
shows the difference in Cobalt mirages

333
00:14:05,700 --> 00:14:08,579
operations I took this diagram from a

334
00:14:08,579 --> 00:14:11,160
Microsoft blog so it doesn't include all

335
00:14:11,160 --> 00:14:14,040
the 2022 links so I'll fill that in

336
00:14:14,040 --> 00:14:15,779
what's interesting is if you look at

337
00:14:15,779 --> 00:14:18,360
this timeline Iran's been affiliated

338
00:14:18,360 --> 00:14:19,940
with Thanos

339
00:14:19,940 --> 00:14:23,100
agrius you know pay to key which I

340
00:14:23,100 --> 00:14:26,880
mentioned earlier Moses stuff and these

341
00:14:26,880 --> 00:14:29,820
ransomware operations are linked to

342
00:14:29,820 --> 00:14:32,100
disruption operations that are actually

343
00:14:32,100 --> 00:14:34,680
dressed up as ransomware so what that

344
00:14:34,680 --> 00:14:36,839
means is most of these targets were just

345
00:14:36,839 --> 00:14:39,660
Israeli Israel companies with the

346
00:14:39,660 --> 00:14:41,540
primary goal of generating media noise

347
00:14:41,540 --> 00:14:44,699
damaging Israel's country image they

348
00:14:44,699 --> 00:14:46,339
were demanding money from Israel

349
00:14:46,339 --> 00:14:48,600
conducting like lengthy public

350
00:14:48,600 --> 00:14:52,260
negotiations Moses staff ransomware the

351
00:14:52,260 --> 00:14:54,060
motivation was actually leaking data

352
00:14:54,060 --> 00:14:56,339
that they stole from Israeli companies

353
00:14:56,339 --> 00:15:00,120
and there was no real Ransom tied to it

354
00:15:00,120 --> 00:15:04,800
towards 2021 and through 2022 we saw a

355
00:15:04,800 --> 00:15:06,839
massive rise in Cobalt Mirage especially

356
00:15:06,839 --> 00:15:09,300
in terms of incident response cases we

357
00:15:09,300 --> 00:15:11,519
worked at secureworks and they were

358
00:15:11,519 --> 00:15:13,740
performing ransomware manually honestly

359
00:15:13,740 --> 00:15:15,180
they're doing it manually through

360
00:15:15,180 --> 00:15:18,120
BitLocker and descriptor and what was

361
00:15:18,120 --> 00:15:20,699
interesting was these attacks ran at a

362
00:15:20,699 --> 00:15:23,220
global scale it was not targeted just at

363
00:15:23,220 --> 00:15:25,860
Israel and it was for the purpose of

364
00:15:25,860 --> 00:15:27,480
financial gain and that's really what

365
00:15:27,480 --> 00:15:29,459
makes copper Mirage very different and

366
00:15:29,459 --> 00:15:31,440
stand out in terms of how they use

367
00:15:31,440 --> 00:15:33,019
ransomware

368
00:15:33,019 --> 00:15:35,699
when uh just in terms of what we saw at

369
00:15:35,699 --> 00:15:37,920
securex we saw them targeting a lot of

370
00:15:37,920 --> 00:15:40,320
organizations in the US specifically

371
00:15:40,320 --> 00:15:43,139
because I work in the aapak region I

372
00:15:43,139 --> 00:15:44,699
worked a case where they were targeting

373
00:15:44,699 --> 00:15:47,760
a Japanese client and they focus on

374
00:15:47,760 --> 00:15:49,740
ransomware in terms of post compromise

375
00:15:49,740 --> 00:15:52,079
and they actually don't ransomware the

376
00:15:52,079 --> 00:15:54,120
entire environment as per traditional

377
00:15:54,120 --> 00:15:56,399
ransomware operators they only touch a

378
00:15:56,399 --> 00:15:59,160
handful of workstations no servers and

379
00:15:59,160 --> 00:16:01,980
if they do it manually well seemingly

380
00:16:01,980 --> 00:16:04,260
manually they have a manually created uh

381
00:16:04,260 --> 00:16:06,420
Ransom note

382
00:16:06,420 --> 00:16:09,120
so naturally this begs the question of

383
00:16:09,120 --> 00:16:11,160
when do these contractor organizations

384
00:16:11,160 --> 00:16:13,320
choose to Ransom versus perform

385
00:16:13,320 --> 00:16:16,620
Espionage or information theft and I

386
00:16:16,620 --> 00:16:18,600
think generally from our observations it

387
00:16:18,600 --> 00:16:21,300
depends on motive firstly is this a

388
00:16:21,300 --> 00:16:23,639
disruptive operation or is this about

389
00:16:23,639 --> 00:16:25,920
Espionage is the target holding

390
00:16:25,920 --> 00:16:28,440
interesting information is it conducive

391
00:16:28,440 --> 00:16:31,199
to Iran cyber operations like is the

392
00:16:31,199 --> 00:16:32,959
target an Israeli company

393
00:16:32,959 --> 00:16:36,180
are they a media client a defense unit

394
00:16:36,180 --> 00:16:37,380
Etc

395
00:16:37,380 --> 00:16:39,899
most of these groups especially Mirage

396
00:16:39,899 --> 00:16:43,199
since they are affiliated or mostly

397
00:16:43,199 --> 00:16:46,079
constructed of contractor units they

398
00:16:46,079 --> 00:16:47,519
tend to scan the internet for

399
00:16:47,519 --> 00:16:49,980
opportunistic targets hence why they

400
00:16:49,980 --> 00:16:52,199
rely on known exploitation Parts like

401
00:16:52,199 --> 00:16:55,079
proxy shell lock 4J

402
00:16:55,079 --> 00:16:57,120
once these contractor units have

403
00:16:57,120 --> 00:16:59,160
compromised targets they seem to then

404
00:16:59,160 --> 00:17:01,019
make the determination of whether this

405
00:17:01,019 --> 00:17:04,020
target is of use or useful to the

406
00:17:04,020 --> 00:17:06,240
Iranian government and their contracts

407
00:17:06,240 --> 00:17:08,520
and if so they will conduct Espionage

408
00:17:08,520 --> 00:17:10,619
and perform Expo if not they might

409
00:17:10,619 --> 00:17:14,160
perform ransomware at the end

410
00:17:14,160 --> 00:17:16,679
since Mirage is different in the sense

411
00:17:16,679 --> 00:17:18,540
that they deploy ransomware for money

412
00:17:18,540 --> 00:17:21,839
then that I feel that well personally I

413
00:17:21,839 --> 00:17:23,760
feel this begs the question of do they

414
00:17:23,760 --> 00:17:25,380
share these profits with the Iranian

415
00:17:25,380 --> 00:17:26,640
government

416
00:17:26,640 --> 00:17:28,980
the Rumor Mill says that perhaps the

417
00:17:28,980 --> 00:17:30,780
Iranian government doesn't pay as well

418
00:17:30,780 --> 00:17:33,720
so organizations might be incentivized

419
00:17:33,720 --> 00:17:35,820
to glean some extra profit but the

420
00:17:35,820 --> 00:17:37,679
answer to this question is we don't know

421
00:17:37,679 --> 00:17:39,840
there is no hard evidence and it's not

422
00:17:39,840 --> 00:17:41,100
like the Iranian government's going to

423
00:17:41,100 --> 00:17:43,980
come out and say oh yes we we take money

424
00:17:43,980 --> 00:17:47,900
from our contracted units

425
00:17:48,480 --> 00:17:50,400
at secureworks we track around 16

426
00:17:50,400 --> 00:17:52,679
different groups that are affiliated

427
00:17:52,679 --> 00:17:55,440
with the Iranian government other other

428
00:17:55,440 --> 00:17:57,539
organizations might track more or less

429
00:17:57,539 --> 00:18:00,419
this is very normal in the field because

430
00:18:00,419 --> 00:18:02,580
you know generally organizations track

431
00:18:02,580 --> 00:18:03,960
these subgroups with some degree

432
00:18:03,960 --> 00:18:07,140
variance now due to the complex nature

433
00:18:07,140 --> 00:18:09,780
of Iran cyber governance it makes it

434
00:18:09,780 --> 00:18:11,100
really hard to know

435
00:18:11,100 --> 00:18:13,980
all those 16 groups are there more are

436
00:18:13,980 --> 00:18:16,860
there less over time sometimes these

437
00:18:16,860 --> 00:18:19,640
groups merge other times subgroups exist

438
00:18:19,640 --> 00:18:22,740
with different ttps develop and this can

439
00:18:22,740 --> 00:18:24,179
be due to swapping out contractor

440
00:18:24,179 --> 00:18:27,600
organizations changes in the irgc or

441
00:18:27,600 --> 00:18:29,880
moas middle manager that manages them or

442
00:18:29,880 --> 00:18:32,280
changes in responsibilities or cyber

443
00:18:32,280 --> 00:18:34,980
units that evolve I know specifically at

444
00:18:34,980 --> 00:18:36,660
secureworks where we are now in the

445
00:18:36,660 --> 00:18:38,220
process of contemplating whether we

446
00:18:38,220 --> 00:18:40,200
break Cobalt Mirage into two separate

447
00:18:40,200 --> 00:18:42,299
groups because two different clusters of

448
00:18:42,299 --> 00:18:44,039
activity have actually emerged from what

449
00:18:44,039 --> 00:18:47,039
we see in our engagements

450
00:18:47,039 --> 00:18:49,820
the case I led was a very large Japanese

451
00:18:49,820 --> 00:18:53,039
multinational corporation with multiple

452
00:18:53,039 --> 00:18:55,559
Global subsidiaries now one of these

453
00:18:55,559 --> 00:18:58,200
subsidiaries was compromised and this

454
00:18:58,200 --> 00:19:00,720
specific client oh it's so hard to like

455
00:19:00,720 --> 00:19:02,640
uh the vertical is hard to kind of

456
00:19:02,640 --> 00:19:04,860
capture but I guess they work in the

457
00:19:04,860 --> 00:19:07,260
film and print industry

458
00:19:07,260 --> 00:19:09,059
but basically the entire incident

459
00:19:09,059 --> 00:19:11,520
started because they received an alert

460
00:19:11,520 --> 00:19:14,340
from a trusted third party that said

461
00:19:14,340 --> 00:19:16,799
we've seen your infrastructure

462
00:19:16,799 --> 00:19:19,620
interacting with a known Cobalt Mirage

463
00:19:19,620 --> 00:19:22,260
eyepiece

464
00:19:22,260 --> 00:19:24,960
once I started performing the engagement

465
00:19:24,960 --> 00:19:27,120
we quickly realized that the initial

466
00:19:27,120 --> 00:19:29,880
access was via proxy shell and they were

467
00:19:29,880 --> 00:19:32,100
exploiting an internet-facing exchange

468
00:19:32,100 --> 00:19:34,260
server essentially by chaining these

469
00:19:34,260 --> 00:19:36,059
three CVS

470
00:19:36,059 --> 00:19:39,059
this is an example of the string from

471
00:19:39,059 --> 00:19:41,460
their active exploitation by chaining uh

472
00:19:41,460 --> 00:19:43,260
their CVS this one was specifically

473
00:19:43,260 --> 00:19:46,919
relating to 34523 and this is this is

474
00:19:46,919 --> 00:19:48,900
obviously not the actual attack this is

475
00:19:48,900 --> 00:19:52,140
me in cyber Chef decoding the base64

476
00:19:52,140 --> 00:19:55,080
encoded string

477
00:19:55,080 --> 00:19:58,620
once they performed this exploitation I

478
00:19:58,620 --> 00:19:59,940
guess the threat actors wanted to test

479
00:19:59,940 --> 00:20:03,179
out that it worked so they uploaded an

480
00:20:03,179 --> 00:20:07,080
aspx file which was actually secretly a

481
00:20:07,080 --> 00:20:10,620
PSD file so secretly an email file and

482
00:20:10,620 --> 00:20:13,559
it was an email that they sent to

483
00:20:13,559 --> 00:20:16,559
basically they hijacked our one of the

484
00:20:16,559 --> 00:20:18,720
email accounts in this organization and

485
00:20:18,720 --> 00:20:21,059
then they sent the same email and email

486
00:20:21,059 --> 00:20:24,120
with a gibberish title that you can see

487
00:20:24,120 --> 00:20:27,179
on the screen GSG caves just looks like

488
00:20:27,179 --> 00:20:29,820
they smashed the keyboard and in the

489
00:20:29,820 --> 00:20:31,620
email they just wrote the poetic

490
00:20:31,620 --> 00:20:34,140
sentence of hello darkness my old friend

491
00:20:34,140 --> 00:20:36,299
and they send themselves a text

492
00:20:36,299 --> 00:20:38,220
attachment which was just the same

493
00:20:38,220 --> 00:20:39,960
sentence

494
00:20:39,960 --> 00:20:43,140
very interesting they then abused

495
00:20:43,140 --> 00:20:45,240
several Powershell commandlets including

496
00:20:45,240 --> 00:20:47,700
new mailbox export requests so they were

497
00:20:47,700 --> 00:20:49,559
exporting things from the mailbox and

498
00:20:49,559 --> 00:20:51,120
but they were using this to install web

499
00:20:51,120 --> 00:20:52,340
shells actually

500
00:20:52,340 --> 00:20:54,960
they also used New Management role

501
00:20:54,960 --> 00:20:57,299
assignment to Grant the ability to

502
00:20:57,299 --> 00:20:59,820
Import and Export data from mailbox they

503
00:20:59,820 --> 00:21:01,679
then tried to hide their steps by

504
00:21:01,679 --> 00:21:03,600
calling the remove mailbox export

505
00:21:03,600 --> 00:21:05,820
requests but to be honest all of these

506
00:21:05,820 --> 00:21:07,559
things are logged so not really sure why

507
00:21:07,559 --> 00:21:10,559
they even bothered they called new

508
00:21:10,559 --> 00:21:13,500
exchange certificate commandlet which

509
00:21:13,500 --> 00:21:15,720
they used to actually install two active

510
00:21:15,720 --> 00:21:18,179
web shells in that specific directory

511
00:21:18,179 --> 00:21:21,059
they used the search mailbox commandlet

512
00:21:21,059 --> 00:21:23,160
as well to run searches through the

513
00:21:23,160 --> 00:21:25,260
mailbox but what was interesting was

514
00:21:25,260 --> 00:21:28,140
they were basically they they granted

515
00:21:28,140 --> 00:21:30,000
themselves permission to search the

516
00:21:30,000 --> 00:21:31,140
mailbox

517
00:21:31,140 --> 00:21:32,760
then they ran the search mailbox

518
00:21:32,760 --> 00:21:34,740
commandlet to look for their hello

519
00:21:34,740 --> 00:21:36,900
darkness my old friend email I guess to

520
00:21:36,900 --> 00:21:40,140
check that their exploitation worked

521
00:21:40,140 --> 00:21:42,179
this is an example of them running the

522
00:21:42,179 --> 00:21:44,820
get commandlet uh could get mailbox

523
00:21:44,820 --> 00:21:47,460
commandlet and then there's the example

524
00:21:47,460 --> 00:21:49,500
of them running the mailbox export

525
00:21:49,500 --> 00:21:52,140
request and they ran this to export

526
00:21:52,140 --> 00:21:54,720
their hello darkness my old friend email

527
00:21:54,720 --> 00:21:56,700
and then right after they ran this they

528
00:21:56,700 --> 00:21:59,400
ran the remove mailbox export request to

529
00:21:59,400 --> 00:22:00,900
then hide the fact that they had called

530
00:22:00,900 --> 00:22:03,140
this

531
00:22:03,659 --> 00:22:05,520
um the attackers then tried to perform

532
00:22:05,520 --> 00:22:07,740
several file export activities and they

533
00:22:07,740 --> 00:22:10,200
did this by trying to x-fill PSD files

534
00:22:10,200 --> 00:22:12,960
it files raw files OST files these files

535
00:22:12,960 --> 00:22:14,460
didn't actually exist on the host which

536
00:22:14,460 --> 00:22:16,440
was really interesting to note but in

537
00:22:16,440 --> 00:22:18,000
terms of were these attempts successful

538
00:22:18,000 --> 00:22:20,159
the answer is no these files didn't

539
00:22:20,159 --> 00:22:22,559
exist and you might then ask was this

540
00:22:22,559 --> 00:22:24,900
was this automated activity I would say

541
00:22:24,900 --> 00:22:26,940
half half some looked automated some

542
00:22:26,940 --> 00:22:30,120
just looked manual uh why they did this

543
00:22:30,120 --> 00:22:32,280
we're not sure

544
00:22:32,280 --> 00:22:34,799
then came 20 or so different web shells

545
00:22:34,799 --> 00:22:36,539
that they decided to upload some were

546
00:22:36,539 --> 00:22:38,460
old webshots from previous exploitation

547
00:22:38,460 --> 00:22:40,679
attempts then there were two active web

548
00:22:40,679 --> 00:22:42,659
shells that were being utilized the

549
00:22:42,659 --> 00:22:44,220
screenshot on the left shows you what

550
00:22:44,220 --> 00:22:46,380
the active web shell looks like now for

551
00:22:46,380 --> 00:22:49,080
the IR people every time an aspx web

552
00:22:49,080 --> 00:22:51,840
shells uploaded there is a correlating

553
00:22:51,840 --> 00:22:55,320
DOT compiled file that's also stored so

554
00:22:55,320 --> 00:22:57,299
the reason I say this is because this

555
00:22:57,299 --> 00:22:58,860
threat group went and deleted every

556
00:22:58,860 --> 00:23:00,960
single web shell uh

557
00:23:00,960 --> 00:23:03,780
hard deleted it from the disk but they

558
00:23:03,780 --> 00:23:06,840
left all the dot compiled versions of it

559
00:23:06,840 --> 00:23:08,460
the webshot that they uploaded was

560
00:23:08,460 --> 00:23:09,900
through the exploitation of the new

561
00:23:09,900 --> 00:23:12,539
exchange certificate command and this is

562
00:23:12,539 --> 00:23:14,460
what the certificate looks like the the

563
00:23:14,460 --> 00:23:17,280
fake certificate and this is the

564
00:23:17,280 --> 00:23:18,840
Powershell command that they use to

565
00:23:18,840 --> 00:23:21,179
install the web Shell through abusing

566
00:23:21,179 --> 00:23:22,980
this commandlet

567
00:23:22,980 --> 00:23:25,080
in terms of credential dumping they did

568
00:23:25,080 --> 00:23:27,020
this two ways one was through secret

569
00:23:27,020 --> 00:23:29,280
stump.xc and the other way was through

570
00:23:29,280 --> 00:23:32,220
direct dumping and manipulation of Elsas

571
00:23:32,220 --> 00:23:34,260
and they did this through a beautifully

572
00:23:34,260 --> 00:23:37,380
named file called elsas.zip which leaves

573
00:23:37,380 --> 00:23:40,140
little to the imagination uh in terms of

574
00:23:40,140 --> 00:23:43,020
Interest here they use two different

575
00:23:43,020 --> 00:23:45,179
credential dumping methods on the same

576
00:23:45,179 --> 00:23:48,059
host at different times it looked like

577
00:23:48,059 --> 00:23:49,740
two different people were following two

578
00:23:49,740 --> 00:23:52,080
different playbooks on the same host at

579
00:23:52,080 --> 00:23:53,700
two different times and forgot to

580
00:23:53,700 --> 00:23:56,340
communicate that they had already dealt

581
00:23:56,340 --> 00:23:58,679
with that server and so they doubled up

582
00:23:58,679 --> 00:24:00,419
on doing the same thing on the same

583
00:24:00,419 --> 00:24:03,960
servers at different times and for both

584
00:24:03,960 --> 00:24:06,240
of them you know deleted the tools and

585
00:24:06,240 --> 00:24:08,039
performed cleanup but it was just really

586
00:24:08,039 --> 00:24:10,200
interesting that it just looked like two

587
00:24:10,200 --> 00:24:11,760
different methodologies being followed

588
00:24:11,760 --> 00:24:13,860
on the same host

589
00:24:13,860 --> 00:24:15,600
in terms of persistence a lot of

590
00:24:15,600 --> 00:24:17,940
interesting things mainly the use of bat

591
00:24:17,940 --> 00:24:19,860
files which were subsequently deleted by

592
00:24:19,860 --> 00:24:21,960
the threat actors the client didn't have

593
00:24:21,960 --> 00:24:23,880
EDR rolled out on any host which was

594
00:24:23,880 --> 00:24:25,080
unfortunate and did make the

595
00:24:25,080 --> 00:24:27,120
investigation a little bit harder but

596
00:24:27,120 --> 00:24:29,039
they used a batch script which was used

597
00:24:29,039 --> 00:24:30,840
to create a new user called default

598
00:24:30,840 --> 00:24:33,059
account which they then added to the

599
00:24:33,059 --> 00:24:35,159
administrators group remote desktop

600
00:24:35,159 --> 00:24:37,140
users group and they set the password to

601
00:24:37,140 --> 00:24:40,080
never expire and the password was just a

602
00:24:40,080 --> 00:24:41,340
password one two three four one two

603
00:24:41,340 --> 00:24:43,799
three four and they use this account to

604
00:24:43,799 --> 00:24:45,720
perform lateral movement and log into

605
00:24:45,720 --> 00:24:48,240
several hosts the attack has also had a

606
00:24:48,240 --> 00:24:49,860
bunch of custom coded tools like they

607
00:24:49,860 --> 00:24:52,020
had several axes that they used that

608
00:24:52,020 --> 00:24:53,880
were used to install malicious scheduled

609
00:24:53,880 --> 00:24:55,440
tasks

610
00:24:55,440 --> 00:24:57,960
in terms of C2 and how they dealt with

611
00:24:57,960 --> 00:25:00,480
communication and access they leveraged

612
00:25:00,480 --> 00:25:02,159
their Infamous tunnel fish back door

613
00:25:02,159 --> 00:25:05,159
which is a tool that for in this

614
00:25:05,159 --> 00:25:08,100
instance they named it dll host.exe and

615
00:25:08,100 --> 00:25:11,280
it's based on Fast reverse proxy the way

616
00:25:11,280 --> 00:25:12,960
that they ran this tool was through a

617
00:25:12,960 --> 00:25:15,840
scheduled task called Cash task and this

618
00:25:15,840 --> 00:25:17,820
ran a bat file which you can see in that

619
00:25:17,820 --> 00:25:19,940
screenshot and that that file just

620
00:25:19,940 --> 00:25:22,340
literally just runs the

621
00:25:22,340 --> 00:25:24,779
dllhost.exe but what was interesting was

622
00:25:24,779 --> 00:25:27,960
I guess I know that blue team is go oh

623
00:25:27,960 --> 00:25:29,640
cool we have the harsh let's go block

624
00:25:29,640 --> 00:25:32,220
this everywhere they actually had a

625
00:25:32,220 --> 00:25:34,260
different tunnel fish back door on every

626
00:25:34,260 --> 00:25:37,260
single host so not a single hash matched

627
00:25:37,260 --> 00:25:39,779
it was just a completely different uh a

628
00:25:39,779 --> 00:25:41,039
tunnel fish back door on every single

629
00:25:41,039 --> 00:25:43,320
host that they deployed it on

630
00:25:43,320 --> 00:25:45,600
in terms of Defense evasion this is

631
00:25:45,600 --> 00:25:47,159
where things have fun they were doing

632
00:25:47,159 --> 00:25:49,440
the most but with zero structure and

633
00:25:49,440 --> 00:25:51,360
I'll give you some some examples they

634
00:25:51,360 --> 00:25:53,820
removed hundreds of log files containing

635
00:25:53,820 --> 00:25:56,039
data around the same time they basically

636
00:25:56,039 --> 00:25:58,080
deleted every log file that was around

637
00:25:58,080 --> 00:26:00,120
the attack time specifically it made it

638
00:26:00,120 --> 00:26:01,320
very obvious that they were trying to

639
00:26:01,320 --> 00:26:03,720
hide that specific uh action they

640
00:26:03,720 --> 00:26:06,179
deleted almost every single event log on

641
00:26:06,179 --> 00:26:08,279
every host but remember when I said that

642
00:26:08,279 --> 00:26:10,080
the attack was really disorganized how

643
00:26:10,080 --> 00:26:11,820
it seemed like two different people were

644
00:26:11,820 --> 00:26:13,980
doing things with no communication so

645
00:26:13,980 --> 00:26:15,539
this showed up in how they proceeded

646
00:26:15,539 --> 00:26:17,880
with defensivision one person would

647
00:26:17,880 --> 00:26:20,039
clean up one server and delete all the

648
00:26:20,039 --> 00:26:23,039
logs except maybe 10 useful ones and

649
00:26:23,039 --> 00:26:24,960
then the second person would do

650
00:26:24,960 --> 00:26:26,940
something on another server with their

651
00:26:26,940 --> 00:26:28,740
completely different techniques and then

652
00:26:28,740 --> 00:26:30,600
they would accidentally leave one or two

653
00:26:30,600 --> 00:26:32,580
logs that would basically make what

654
00:26:32,580 --> 00:26:35,640
person a did completely useless and what

655
00:26:35,640 --> 00:26:37,740
was worse was how they deleted staging

656
00:26:37,740 --> 00:26:40,679
folders on some of the hosts I'm going

657
00:26:40,679 --> 00:26:42,900
to call person a a person a because they

658
00:26:42,900 --> 00:26:45,059
were cleaner than person be but person a

659
00:26:45,059 --> 00:26:46,860
would clean up everything delete every

660
00:26:46,860 --> 00:26:48,120
single staging folder delete every

661
00:26:48,120 --> 00:26:49,559
single attack tool that was loaded on

662
00:26:49,559 --> 00:26:51,779
the host the person B would forget to

663
00:26:51,779 --> 00:26:54,179
delete one or two files or folders which

664
00:26:54,179 --> 00:26:56,159
basically rendered what person a did

665
00:26:56,159 --> 00:26:59,159
useless and things like this are so hard

666
00:26:59,159 --> 00:27:01,020
to put inside an incident report because

667
00:27:01,020 --> 00:27:02,580
if you think about it it just comes down

668
00:27:02,580 --> 00:27:04,620
to oh the other operations was

669
00:27:04,620 --> 00:27:06,360
disorganized but that doesn't really

670
00:27:06,360 --> 00:27:09,419
capture the full uh the full detail of

671
00:27:09,419 --> 00:27:11,520
what it was like to kind of see it

672
00:27:11,520 --> 00:27:13,320
firsthand

673
00:27:13,320 --> 00:27:15,419
aside from discrepancies between person

674
00:27:15,419 --> 00:27:17,940
A and B they also made opsec mistakes

675
00:27:17,940 --> 00:27:20,340
one of this was leaking the names of one

676
00:27:20,340 --> 00:27:21,900
of their attack machines during their

677
00:27:21,900 --> 00:27:23,880
access to hosts that they were doing so

678
00:27:23,880 --> 00:27:25,799
this was them accessing hosts via tunnel

679
00:27:25,799 --> 00:27:28,320
fish and them leaking one of their

680
00:27:28,320 --> 00:27:32,220
attack names an attacker PC names

681
00:27:32,220 --> 00:27:34,320
when they were deploying ransomware they

682
00:27:34,320 --> 00:27:36,960
did this in a very weird way they

683
00:27:36,960 --> 00:27:38,940
created a folder on a host that had a

684
00:27:38,940 --> 00:27:39,900
PDF

685
00:27:39,900 --> 00:27:42,120
person B was supposed to delete this

686
00:27:42,120 --> 00:27:44,159
folder I I guarantee you they were

687
00:27:44,159 --> 00:27:45,779
supposed to delete this folder because

688
00:27:45,779 --> 00:27:48,179
they catted out the contents of the PDF

689
00:27:48,179 --> 00:27:50,460
file into several text files which they

690
00:27:50,460 --> 00:27:52,740
laterally pushed onto several hosts

691
00:27:52,740 --> 00:27:54,720
the original PDF and folder were not

692
00:27:54,720 --> 00:27:57,960
removed and the issue with that was text

693
00:27:57,960 --> 00:28:00,000
files that They carried out the actual

694
00:28:00,000 --> 00:28:02,400
Ransom note itself had no metadata in it

695
00:28:02,400 --> 00:28:04,980
but the PDF did and this was our Smoking

696
00:28:04,980 --> 00:28:07,679
Gun the PDF was created by Ahmed katibi

697
00:28:07,679 --> 00:28:11,640
the CEO of offcast systems and the time

698
00:28:11,640 --> 00:28:13,860
zone correlated with Iran which helped

699
00:28:13,860 --> 00:28:15,659
us identify as you could see here his

700
00:28:15,659 --> 00:28:17,100
LinkedIn profile

701
00:28:17,100 --> 00:28:18,720
I'm going to be honest with you I was

702
00:28:18,720 --> 00:28:21,179
pretty shocked to see this I think the

703
00:28:21,179 --> 00:28:22,799
threat actors intended to delete the

704
00:28:22,799 --> 00:28:24,419
staging folder because they deleted

705
00:28:24,419 --> 00:28:26,400
every other staging folder but because I

706
00:28:26,400 --> 00:28:28,919
think person B was the one responsible

707
00:28:28,919 --> 00:28:31,400
for this they forgot to remove it

708
00:28:31,400 --> 00:28:34,500
after the case a few months later I was

709
00:28:34,500 --> 00:28:35,820
actually on holiday when this came out

710
00:28:35,820 --> 00:28:38,400
the US came out with a bounty on Ahmed

711
00:28:38,400 --> 00:28:40,860
khatibi for 10 million dollars and this

712
00:28:40,860 --> 00:28:42,720
indictment directly linked him to

713
00:28:42,720 --> 00:28:45,539
offcast systems and Cobalt Mirage and

714
00:28:45,539 --> 00:28:47,520
the document actually also linked him to

715
00:28:47,520 --> 00:28:50,159
manso Ahmadi who we knew was the CEO of

716
00:28:50,159 --> 00:28:52,679
Naji Tech from our Research into our

717
00:28:52,679 --> 00:28:54,240
domains and things that we saw from

718
00:28:54,240 --> 00:28:56,520
engagements but in terms of opsec

719
00:28:56,520 --> 00:28:58,440
mistakes this is not a new thing when it

720
00:28:58,440 --> 00:29:00,600
comes to Iranian threat groups and I

721
00:29:00,600 --> 00:29:02,039
suspect that this naturally has to do

722
00:29:02,039 --> 00:29:03,659
with the large amount of Outsourcing

723
00:29:03,659 --> 00:29:05,520
activity that they do with various

724
00:29:05,520 --> 00:29:07,559
contractor firms and these contractor

725
00:29:07,559 --> 00:29:09,240
companies have different methodologies

726
00:29:09,240 --> 00:29:11,279
you know different skill levels it's a

727
00:29:11,279 --> 00:29:13,440
it's a it's its own company so when they

728
00:29:13,440 --> 00:29:15,539
put in a position to work together and

729
00:29:15,539 --> 00:29:17,520
in a business sense it's very hard to

730
00:29:17,520 --> 00:29:19,140
kind of merge methodologies and break

731
00:29:19,140 --> 00:29:21,240
down silos

732
00:29:21,240 --> 00:29:23,100
and so this is what I want to impart

733
00:29:23,100 --> 00:29:25,320
with you attribution is really difficult

734
00:29:25,320 --> 00:29:27,779
when it comes to Iran for example one

735
00:29:27,779 --> 00:29:29,880
contractor might work across two

736
00:29:29,880 --> 00:29:33,120
different apt groups within irgc on Moss

737
00:29:33,120 --> 00:29:35,820
for example Eminem passagard contractor

738
00:29:35,820 --> 00:29:38,520
organizations also change some get

739
00:29:38,520 --> 00:29:41,039
indicted for example Naji and afka and

740
00:29:41,039 --> 00:29:42,899
then new ones get introduced or new ones

741
00:29:42,899 --> 00:29:44,100
get hired

742
00:29:44,100 --> 00:29:46,679
also contractors work together in really

743
00:29:46,679 --> 00:29:49,559
unclear ways some are just initial

744
00:29:49,559 --> 00:29:51,480
access Brokers and then they hand it off

745
00:29:51,480 --> 00:29:54,720
some are malware devs and other times

746
00:29:54,720 --> 00:29:56,760
When contractors work together during an

747
00:29:56,760 --> 00:29:58,440
attack it results in completely

748
00:29:58,440 --> 00:30:01,860
different ttps occurring in one incident

749
00:30:01,860 --> 00:30:03,960
the second takeaway is that attribution

750
00:30:03,960 --> 00:30:05,940
when it comes to nation states really

751
00:30:05,940 --> 00:30:07,980
depend on political structure and

752
00:30:07,980 --> 00:30:10,679
motivations Iran is very interesting in

753
00:30:10,679 --> 00:30:12,299
the sense that they have two competing

754
00:30:12,299 --> 00:30:14,520
structures for influence and they've got

755
00:30:14,520 --> 00:30:16,980
mowers and various apt groups and that

756
00:30:16,980 --> 00:30:19,380
leads me to my final point that threat

757
00:30:19,380 --> 00:30:21,179
Intel really needs to be fluid and

758
00:30:21,179 --> 00:30:23,039
adaptive changes that occur when it's

759
00:30:23,039 --> 00:30:25,380
Intel about apt changes in political

760
00:30:25,380 --> 00:30:26,820
structures have a massive role

761
00:30:26,820 --> 00:30:29,059
especially when it comes to

762
00:30:29,059 --> 00:30:32,279
irgc gaining a lot of influence over MOS

763
00:30:32,279 --> 00:30:34,020
and so we need to make sure we reflect

764
00:30:34,020 --> 00:30:35,700
that and constantly update how we

765
00:30:35,700 --> 00:30:37,140
perform our grouping

766
00:30:37,140 --> 00:30:39,299
so with that thank you so much if you

767
00:30:39,299 --> 00:30:40,620
want to get in touch you can hit me up

768
00:30:40,620 --> 00:30:42,720
on Twitter and there's been a massive

769
00:30:42,720 --> 00:30:44,520
shift and increase in apt groups

770
00:30:44,520 --> 00:30:47,159
attacking Azure nm365 so I've just

771
00:30:47,159 --> 00:30:48,419
released a course that covers how to

772
00:30:48,419 --> 00:30:49,919
attack and mitigate these threats and

773
00:30:49,919 --> 00:30:51,299
the full link is on this slide if you're

774
00:30:51,299 --> 00:30:53,600
interested

