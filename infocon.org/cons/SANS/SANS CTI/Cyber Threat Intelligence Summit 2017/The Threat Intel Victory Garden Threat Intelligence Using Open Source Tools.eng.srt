1
00:00:00,360 --> 00:00:07,820
[Music]

2
00:00:04,220 --> 00:00:07,820
[Applause]

3
00:00:09,469 --> 00:00:16,049
thank you very much Scott okay so today

4
00:00:13,070 --> 00:00:18,330
with a very interesting bottom logo to

5
00:00:16,049 --> 00:00:20,670
our presentation we are going to kick

6
00:00:18,330 --> 00:00:22,409
off how to grow your own threat

7
00:00:20,670 --> 00:00:23,310
intelligence at Victory Garden little

8
00:00:22,410 --> 00:00:25,439
known fact

9
00:00:23,310 --> 00:00:27,448
the CFP had in white text all

10
00:00:25,439 --> 00:00:30,060
presentations must have a World War 2

11
00:00:27,449 --> 00:00:31,529
theme not sure how was put in but I

12
00:00:30,060 --> 00:00:34,440
think Rick flips it in them

13
00:00:31,529 --> 00:00:37,260
let's rock okay before I go any further

14
00:00:34,440 --> 00:00:39,420
I have some legal things rule of thumb

15
00:00:37,260 --> 00:00:41,040
no longer allowed to do safe harbor

16
00:00:39,420 --> 00:00:42,899
since it kind of got mixed so we still

17
00:00:41,040 --> 00:00:45,660
could say don't buy stock and maybe the

18
00:00:42,899 --> 00:00:46,410
craft we're about to tell you Dave is a

19
00:00:45,660 --> 00:00:48,360
habitual liar

20
00:00:46,410 --> 00:00:49,980
I can't get it out of them so just go

21
00:00:48,360 --> 00:00:51,329
forward with that but take ideas that

22
00:00:49,980 --> 00:00:53,010
we're coming from this and go do it

23
00:00:51,329 --> 00:00:55,110
we're not professional developers we're

24
00:00:53,010 --> 00:00:56,879
not even professional anything but we do

25
00:00:55,110 --> 00:01:01,379
have a lot of fun hope you guys do too

26
00:00:56,879 --> 00:01:02,849
so Ryan Kovar I've been in the DoD kind

27
00:01:01,379 --> 00:01:05,039
of world doing cyber for a pretty long

28
00:01:02,850 --> 00:01:06,750
time I've also worked in the UK I've

29
00:01:05,040 --> 00:01:08,520
worked in Japan various other places

30
00:01:06,750 --> 00:01:09,990
currently at Splunk for the last two and

31
00:01:08,520 --> 00:01:11,429
a half years on the security practice

32
00:01:09,990 --> 00:01:12,899
team where I get to build cool things

33
00:01:11,430 --> 00:01:16,530
and then talk about it in the security

34
00:01:12,900 --> 00:01:18,390
sphere hey guys I'm I'm Dave Harold

35
00:01:16,530 --> 00:01:20,100
worked with Ryan at Splunk I've been

36
00:01:18,390 --> 00:01:21,960
there a couple years we work on the

37
00:01:20,100 --> 00:01:24,479
security practice team

38
00:01:21,960 --> 00:01:27,270
I've been around in IT and security for

39
00:01:24,479 --> 00:01:29,220
about twenty years I'm pretty stoked to

40
00:01:27,270 --> 00:01:31,170
be here because I owe pretty much

41
00:01:29,220 --> 00:01:35,280
everything I've ever done in security to

42
00:01:31,170 --> 00:01:37,259
sans I'm a GSE have been through tons of

43
00:01:35,280 --> 00:01:39,810
classes and we're we actually got to

44
00:01:37,259 --> 00:01:40,710
take the 578 class this last week which

45
00:01:39,810 --> 00:01:43,770
was fantastic

46
00:01:40,710 --> 00:01:44,610
oh come on some of you were in there

47
00:01:43,770 --> 00:01:46,829
yeah there we go

48
00:01:44,610 --> 00:01:50,280
everybody in this room should be taking

49
00:01:46,829 --> 00:01:51,929
that class if you haven't and I'm kind

50
00:01:50,280 --> 00:01:53,759
of the plumber and Ryan's kind of the

51
00:01:51,930 --> 00:01:56,700
rock star so if you need to just put us

52
00:01:53,759 --> 00:01:59,700
in buckets for security personas so

53
00:01:56,700 --> 00:02:04,259
that's a lot it's Aria more of like a

54
00:01:59,700 --> 00:02:06,180
Ringo Starr yeah but yeah anywho so Dave

55
00:02:04,259 --> 00:02:09,300
and I have been around for a pretty long

56
00:02:06,180 --> 00:02:11,569
time we've done a lot of things we're

57
00:02:09,300 --> 00:02:13,159
not subject matter experts in very many

58
00:02:11,569 --> 00:02:15,530
so what this means is we like to get

59
00:02:13,159 --> 00:02:17,090
 done right we want to go out there

60
00:02:15,530 --> 00:02:18,230
we got to find stuff we want to write

61
00:02:17,090 --> 00:02:20,450
stuff we want to put it in production

62
00:02:18,230 --> 00:02:22,310
where C and D guys who dabble in the

63
00:02:20,450 --> 00:02:23,689
world of threat intelligence we take the

64
00:02:22,310 --> 00:02:26,000
things that many of you people in this

65
00:02:23,689 --> 00:02:28,700
room have created and built and then try

66
00:02:26,000 --> 00:02:29,780
to implement it right so as we go

67
00:02:28,700 --> 00:02:31,640
through this you're going to see a lot

68
00:02:29,780 --> 00:02:33,170
this is not rocket science but it's all

69
00:02:31,640 --> 00:02:35,059
based on stuff that we've seen over the

70
00:02:33,170 --> 00:02:37,040
last 10 15 years that everyone's talking

71
00:02:35,060 --> 00:02:41,359
about but no one's put into kind of a

72
00:02:37,040 --> 00:02:42,650
cohesive narrative so let's do an agenda

73
00:02:41,359 --> 00:02:45,439
and first off I'd like to call attention

74
00:02:42,650 --> 00:02:47,540
to the world's best agenda which was

75
00:02:45,439 --> 00:02:48,888
with Richard Nixon and Elvis Presley I

76
00:02:47,540 --> 00:02:49,730
don't think anyone is ever going to get

77
00:02:48,889 --> 00:02:52,280
better than that

78
00:02:49,730 --> 00:02:53,720
single agenda where the guy who dies of

79
00:02:52,280 --> 00:02:55,370
a drug overdose tries to become a

80
00:02:53,720 --> 00:02:58,310
federal law enforcement officer to

81
00:02:55,370 --> 00:03:01,340
prevent drug abuse so after that was to

82
00:02:58,310 --> 00:03:03,019
set expectations lower we're going to

83
00:03:01,340 --> 00:03:04,639
talk about the things that you should be

84
00:03:03,019 --> 00:03:06,409
doing because really it's just you

85
00:03:04,639 --> 00:03:08,299
should get done right we're going to

86
00:03:06,409 --> 00:03:09,319
tell you how we think you can do it and

87
00:03:08,299 --> 00:03:11,329
we're going to give you some code

88
00:03:09,319 --> 00:03:12,500
examples but not too in-depth just kind

89
00:03:11,329 --> 00:03:14,239
of high-level stuff because we're not

90
00:03:12,500 --> 00:03:16,069
that smart and then we're going to give

91
00:03:14,239 --> 00:03:18,229
you a couple other things to take away I

92
00:03:16,069 --> 00:03:19,458
think personally my belief is anything

93
00:03:18,229 --> 00:03:20,449
you get from a talk you should have

94
00:03:19,459 --> 00:03:23,299
something to take away and do

95
00:03:20,449 --> 00:03:26,180
immediately with so let's go into a

96
00:03:23,299 --> 00:03:28,639
quick overview all right so yeah the I

97
00:03:26,180 --> 00:03:30,500
mean the concept of the talk right is is

98
00:03:28,639 --> 00:03:33,949
that the old Victory Gardens from World

99
00:03:30,500 --> 00:03:36,739
War two where citizens were encouraged

100
00:03:33,949 --> 00:03:37,940
right to grow food grow their own if you

101
00:03:36,739 --> 00:03:42,709
will I'm from Colorado

102
00:03:37,940 --> 00:03:44,359
so it has special meaning but but

103
00:03:42,709 --> 00:03:46,069
there's actually a lot of data in your

104
00:03:44,359 --> 00:03:48,769
environment that you can take advantage

105
00:03:46,069 --> 00:03:51,310
of and it's definitely not to discount

106
00:03:48,769 --> 00:03:54,709
the value you can get from all the great

107
00:03:51,310 --> 00:03:56,060
pay for thread Intel providers here it's

108
00:03:54,709 --> 00:03:57,799
not a substitute for that it's just

109
00:03:56,060 --> 00:03:59,659
saying hey you're actually leaving a lot

110
00:03:57,799 --> 00:04:01,659
of things on the table as Ryan says if

111
00:03:59,659 --> 00:04:05,569
you don't take advantage of these things

112
00:04:01,659 --> 00:04:07,970
and you know obviously this whole talk

113
00:04:05,569 --> 00:04:09,948
is more about doing things and the

114
00:04:07,970 --> 00:04:11,509
things that we're suggesting are not new

115
00:04:09,949 --> 00:04:13,849
right these are things that are

116
00:04:11,509 --> 00:04:17,139
suggested by folks like Rebecca and Rick

117
00:04:13,849 --> 00:04:19,548
in previous talks Rebecca had a

118
00:04:17,139 --> 00:04:21,680
presentation where she talked about 99

119
00:04:19,548 --> 00:04:23,448
problems and budgets one of them right

120
00:04:21,680 --> 00:04:25,820
and this is a screenshot from that but

121
00:04:23,449 --> 00:04:28,160
it talks about how do you how do you

122
00:04:25,820 --> 00:04:30,440
actually take a lot of internal data and

123
00:04:28,160 --> 00:04:32,630
make it useful I think this is from

124
00:04:30,440 --> 00:04:34,100
Rick's last year presentation a previous

125
00:04:32,630 --> 00:04:37,250
presentation where he said hey look at

126
00:04:34,100 --> 00:04:39,919
internal enrichment sources and so we

127
00:04:37,250 --> 00:04:46,570
are somebody yeah we're gonna kick them

128
00:04:39,919 --> 00:04:48,919
out later games don't work right yep so

129
00:04:46,570 --> 00:04:52,280
so standing on the shoulders of giants

130
00:04:48,919 --> 00:04:53,870
and here's the thing Dave and I had 248

131
00:04:52,280 --> 00:04:56,000
nights on the road last year Dave hit

132
00:04:53,870 --> 00:04:58,070
well over 100 we travel a lot and we

133
00:04:56,000 --> 00:05:02,660
travel everywhere we're in Hong Kong

134
00:04:58,070 --> 00:05:04,639
we're in Moscow and that's it also all

135
00:05:02,660 --> 00:05:06,380
over the US right all over Europe we

136
00:05:04,639 --> 00:05:07,820
deal with South America we do everything

137
00:05:06,380 --> 00:05:11,090
but Antarctica and I'm still waiting for

138
00:05:07,820 --> 00:05:14,210
that expense report to clear and what we

139
00:05:11,090 --> 00:05:16,669
see dealing with from tier 1 all the way

140
00:05:14,210 --> 00:05:18,039
to tier 3 the people who are literally

141
00:05:16,669 --> 00:05:21,169
writing the books and the coursework

142
00:05:18,039 --> 00:05:23,270
right we find that people are having the

143
00:05:21,169 --> 00:05:24,770
same problem they're still not actually

144
00:05:23,270 --> 00:05:27,940
leveraging internal threat intelligence

145
00:05:24,770 --> 00:05:31,310
sources so what do we find

146
00:05:27,940 --> 00:05:33,020
sadness a lot of staff pandas right

147
00:05:31,310 --> 00:05:35,660
which will give them to that later I'm

148
00:05:33,020 --> 00:05:40,010
sure within the week but let's talk

149
00:05:35,660 --> 00:05:41,180
about why we need to do this we need to

150
00:05:40,010 --> 00:05:43,250
do this talk because we want to

151
00:05:41,180 --> 00:05:43,700
evangelize and seduce you term but let's

152
00:05:43,250 --> 00:05:45,770
go with it

153
00:05:43,700 --> 00:05:48,139
this idea of internal threat

154
00:05:45,770 --> 00:05:50,299
intelligence right dig your own dig deep

155
00:05:48,139 --> 00:05:51,260
into the data sources you have we want

156
00:05:50,300 --> 00:05:54,020
you to stop after this presentation

157
00:05:51,260 --> 00:05:56,240
really think about what you can get out

158
00:05:54,020 --> 00:05:59,030
of your own organization without paying

159
00:05:56,240 --> 00:06:00,199
a dime for an intelligence is awesome I

160
00:05:59,030 --> 00:06:02,030
bought a lot of it I give the

161
00:06:00,199 --> 00:06:03,500
recommendations all the time to people

162
00:06:02,030 --> 00:06:07,330
about what they should buy depending on

163
00:06:03,500 --> 00:06:09,440
their vertical right but imagine a world

164
00:06:07,330 --> 00:06:12,198
where you can get your own threat

165
00:06:09,440 --> 00:06:16,279
intelligence for free just blisters on

166
00:06:12,199 --> 00:06:19,339
your hands all right

167
00:06:16,279 --> 00:06:20,869
on you this all right so let's let's

168
00:06:19,339 --> 00:06:23,539
actually talk about something real um

169
00:06:20,869 --> 00:06:25,339
first of all so we work for slugs but

170
00:06:23,539 --> 00:06:26,688
we're not here to sell spunk in any way

171
00:06:25,339 --> 00:06:29,659
everything that we're going to talk

172
00:06:26,689 --> 00:06:31,729
about is it can be done in a variety of

173
00:06:29,659 --> 00:06:33,229
different tools whatever you have at

174
00:06:31,729 --> 00:06:34,849
your disposal some of the examples you

175
00:06:33,229 --> 00:06:38,119
Splunk because that's just what we have

176
00:06:34,849 --> 00:06:39,969
available to us and we're good at but so

177
00:06:38,119 --> 00:06:43,819
we're not we're definitely not here to

178
00:06:39,969 --> 00:06:47,058
push funk but we will buy beers for

179
00:06:43,819 --> 00:06:48,679
anybody you know on the expense account

180
00:06:47,059 --> 00:06:53,749
you just have to prove that you know you

181
00:06:48,679 --> 00:06:56,599
want to buy spunk all right so let's

182
00:06:53,749 --> 00:06:58,579
talk about security awareness data so

183
00:06:56,599 --> 00:07:01,058
this is an idea that Ryan had which is

184
00:06:58,579 --> 00:07:03,499
basically like look can we take

185
00:07:01,059 --> 00:07:06,019
information about our users and how

186
00:07:03,499 --> 00:07:08,239
they're faring in our user awareness

187
00:07:06,019 --> 00:07:10,579
training and maybe our fishing test and

188
00:07:08,239 --> 00:07:12,229
use those results not only for the

189
00:07:10,579 --> 00:07:15,949
normal things you use that for but also

190
00:07:12,229 --> 00:07:17,209
to to enrich the events that we're

191
00:07:15,949 --> 00:07:18,889
seeing in the environment and get it

192
00:07:17,209 --> 00:07:21,589
sort of a secondary value out of that

193
00:07:18,889 --> 00:07:22,879
information so we got some security

194
00:07:21,589 --> 00:07:25,099
awareness data you're not supposed to be

195
00:07:22,879 --> 00:07:27,379
able to read that we got some security

196
00:07:25,099 --> 00:07:29,529
awareness data from fish me super good

197
00:07:27,379 --> 00:07:32,179
partner of swung highly recommend them

198
00:07:29,529 --> 00:07:35,479
they gave us some information some

199
00:07:32,179 --> 00:07:39,109
sample data and if we look a little

200
00:07:35,479 --> 00:07:40,399
closer it's it's got things like you

201
00:07:39,110 --> 00:07:42,229
know what was the user or what was the

202
00:07:40,399 --> 00:07:43,039
email address of the user in the last

203
00:07:42,229 --> 00:07:45,109
test today

204
00:07:43,039 --> 00:07:46,998
did they click on the link right did

205
00:07:45,110 --> 00:07:48,829
they enter their password did they

206
00:07:46,999 --> 00:07:50,689
submit the form right and when they went

207
00:07:48,829 --> 00:07:52,009
through this test and ultimately did

208
00:07:50,689 --> 00:07:53,719
they actually report it like they're

209
00:07:52,009 --> 00:07:55,789
supposed to that hey I think I just got

210
00:07:53,719 --> 00:07:58,039
fish and you know send it off to your

211
00:07:55,789 --> 00:08:00,529
email address or whatever you have set

212
00:07:58,039 --> 00:08:02,209
up for that and this is great

213
00:08:00,529 --> 00:08:03,829
information and obviously after these

214
00:08:02,209 --> 00:08:07,489
things run right you can do the normal

215
00:08:03,829 --> 00:08:09,319
stuff that you do right and go give them

216
00:08:07,489 --> 00:08:11,899
a whuppin make them go through more

217
00:08:09,319 --> 00:08:14,179
training or or what have you but you can

218
00:08:11,899 --> 00:08:17,239
also take that data and use it as an

219
00:08:14,179 --> 00:08:20,179
enrichment source so this is actually

220
00:08:17,239 --> 00:08:22,878
some data from system Microsoft system

221
00:08:20,179 --> 00:08:26,899
on we do a crap-ton with that I do in

222
00:08:22,879 --> 00:08:28,729
particular at spunk and this is just

223
00:08:26,899 --> 00:08:29,750
basically saying okay we've got a system

224
00:08:28,729 --> 00:08:32,330
on alert and this is

225
00:08:29,750 --> 00:08:35,090
telling us that on some system in our

226
00:08:32,330 --> 00:08:37,250
environment Microsoft Word just launched

227
00:08:35,090 --> 00:08:40,490
command dot exe right pretty standard

228
00:08:37,250 --> 00:08:42,320
kind of sim use case it's very

229
00:08:40,490 --> 00:08:45,470
interesting right because word an office

230
00:08:42,320 --> 00:08:47,060
shouldn't be launching command XE and

231
00:08:45,470 --> 00:08:50,570
certainly that's bad but we can take

232
00:08:47,060 --> 00:08:52,430
that data right from from the the from

233
00:08:50,570 --> 00:08:54,710
the awareness training and say hey we

234
00:08:52,430 --> 00:08:57,140
can actually add another small dimension

235
00:08:54,710 --> 00:08:59,390
to this data and say oh we actually saw

236
00:08:57,140 --> 00:09:01,580
that this user is susceptible to

237
00:08:59,390 --> 00:09:03,290
phishing right so we're seeing something

238
00:09:01,580 --> 00:09:06,110
looks like fishing and we know that this

239
00:09:03,290 --> 00:09:08,569
user has a history of clicking on on

240
00:09:06,110 --> 00:09:11,000
stuff that they ought not to and we can

241
00:09:08,570 --> 00:09:12,680
use that to help sort of enrich this

242
00:09:11,000 --> 00:09:15,850
data like move things up higher in a

243
00:09:12,680 --> 00:09:19,250
priority queue or what have you

244
00:09:15,850 --> 00:09:20,660
pretty simple and and there's a small

245
00:09:19,250 --> 00:09:22,640
spoiler alert but what we're going to

246
00:09:20,660 --> 00:09:27,439
get all this information to you in a

247
00:09:22,640 --> 00:09:29,300
very convenient way coming up here so so

248
00:09:27,440 --> 00:09:32,060
you know just summary on security

249
00:09:29,300 --> 00:09:33,849
awareness training right use it as you

250
00:09:32,060 --> 00:09:35,810
know use it use it as a source use it

251
00:09:33,850 --> 00:09:37,640
somewhat as you know canary in the

252
00:09:35,810 --> 00:09:40,699
coalmine for your users let their

253
00:09:37,640 --> 00:09:42,380
previous behavior tell you things that

254
00:09:40,700 --> 00:09:45,470
you didn't know maybe about your your

255
00:09:42,380 --> 00:09:47,360
operational security environment and you

256
00:09:45,470 --> 00:09:49,370
know education helps use the paddle but

257
00:09:47,360 --> 00:09:52,010
but also you know use that data for

258
00:09:49,370 --> 00:09:53,210
other things as well so this line was

259
00:09:52,010 --> 00:09:54,230
going to be a lot cooler than I thought

260
00:09:53,210 --> 00:09:55,670
I was going to bring a whole bunch of

261
00:09:54,230 --> 00:09:59,960
new things to this audience until the

262
00:09:55,670 --> 00:10:03,050
world's best keynote occurred decoy das

263
00:09:59,960 --> 00:10:05,660
right not a new idea this is something

264
00:10:03,050 --> 00:10:07,310
that we just had an incredibly who else

265
00:10:05,660 --> 00:10:08,360
looks super amped up after that right

266
00:10:07,310 --> 00:10:11,150
I've never actually had a keynote I

267
00:10:08,360 --> 00:10:12,650
liked and I was phenomenal and I came

268
00:10:11,150 --> 00:10:14,720
out I had a whole long fun story about

269
00:10:12,650 --> 00:10:16,160
decoy documents and then I found out

270
00:10:14,720 --> 00:10:20,240
that oh yeah by the way he did that in

271
00:10:16,160 --> 00:10:21,890
1986 and it was in a shower with a woman

272
00:10:20,240 --> 00:10:26,960
where mine was at an office with a beer

273
00:10:21,890 --> 00:10:28,819
so once again I lose so any hope this is

274
00:10:26,960 --> 00:10:31,150
a very long convoluted way to get my

275
00:10:28,820 --> 00:10:33,589
love of Battlestar Gallactica on screen

276
00:10:31,150 --> 00:10:35,959
so once again the idea of decoy

277
00:10:33,589 --> 00:10:37,460
documents is not original there is a

278
00:10:35,960 --> 00:10:39,410
method of doing it called embedded

279
00:10:37,460 --> 00:10:41,839
callbacks or web bug for those of you

280
00:10:39,410 --> 00:10:43,040
who are keyboard jockeys back in the

281
00:10:41,839 --> 00:10:45,350
2000 air time

282
00:10:43,040 --> 00:10:47,870
and it's still actually usable and

283
00:10:45,350 --> 00:10:50,720
workable today literally just injecting

284
00:10:47,870 --> 00:10:54,830
HTML into a document that says pay when

285
00:10:50,720 --> 00:10:56,780
you load up one 1x1 pixel callback to go

286
00:10:54,830 --> 00:10:59,540
find what's going on right and that's

287
00:10:56,780 --> 00:11:01,160
all it takes giving two examples of HTML

288
00:10:59,540 --> 00:11:02,870
here that you could inject into a Word

289
00:11:01,160 --> 00:11:05,180
document and I say inject like

290
00:11:02,870 --> 00:11:07,610
maliciously like literally it's just go

291
00:11:05,180 --> 00:11:09,829
up into the toolbar for Microsoft Word

292
00:11:07,610 --> 00:11:11,780
and put input and it will put in this

293
00:11:09,830 --> 00:11:15,620
document open it up and it's going to

294
00:11:11,780 --> 00:11:17,030
make HTML calls out to these web servers

295
00:11:15,620 --> 00:11:19,280
now in this case it's an open source

296
00:11:17,030 --> 00:11:23,000
project posted on SourceForge so you

297
00:11:19,280 --> 00:11:24,650
know it's recent of a web bug server and

298
00:11:23,000 --> 00:11:27,110
it'll actually recall back I do want to

299
00:11:24,650 --> 00:11:28,400
give a slight note of legality here if

300
00:11:27,110 --> 00:11:29,960
you do any of these methods for a

301
00:11:28,400 --> 00:11:32,329
callback which is kind of an active

302
00:11:29,960 --> 00:11:34,370
technique make sure that a is legal your

303
00:11:32,330 --> 00:11:35,990
environment and be I highly recommend

304
00:11:34,370 --> 00:11:37,700
not going into anything that's doing

305
00:11:35,990 --> 00:11:40,130
profiling on a host machine otherwise

306
00:11:37,700 --> 00:11:44,690
you might end up with the FBI and not in

307
00:11:40,130 --> 00:11:47,570
the fun way so the second method is more

308
00:11:44,690 --> 00:11:49,700
of a passive and the idea here is you're

309
00:11:47,570 --> 00:11:52,130
just going to set up enhance auditing up

310
00:11:49,700 --> 00:11:54,800
or object access on a word document or a

311
00:11:52,130 --> 00:11:56,420
directory now I would love for every

312
00:11:54,800 --> 00:11:58,160
single one of you to go out and turn on

313
00:11:56,420 --> 00:12:00,110
object access feed on every single one

314
00:11:58,160 --> 00:12:02,569
of your document cuz Papa needs a new

315
00:12:00,110 --> 00:12:05,000
Ferrari it's lunk right it may set it on

316
00:12:02,570 --> 00:12:06,500
a log so let's be honest you don't need

317
00:12:05,000 --> 00:12:08,420
to do all that just turn it on for a

318
00:12:06,500 --> 00:12:10,130
couple key things that you're looking at

319
00:12:08,420 --> 00:12:12,439
and these are similar what Dave just

320
00:12:10,130 --> 00:12:13,910
said Canaries in the coal mine right but

321
00:12:12,440 --> 00:12:15,560
I want you to be very careful to make

322
00:12:13,910 --> 00:12:17,390
sure that if you do this make sure you

323
00:12:15,560 --> 00:12:19,010
set up whitelist right you don't want

324
00:12:17,390 --> 00:12:21,560
your Veritas or your backup exact

325
00:12:19,010 --> 00:12:23,150
rigging every week just set this up run

326
00:12:21,560 --> 00:12:24,979
it for a day or two or a week see what's

327
00:12:23,150 --> 00:12:26,720
hitting and then slowly but surely make

328
00:12:24,980 --> 00:12:28,550
sure the next time that's happened it's

329
00:12:26,720 --> 00:12:31,460
some sort of crazy bear panda in your

330
00:12:28,550 --> 00:12:33,709
network that you're looking for so in

331
00:12:31,460 --> 00:12:35,420
summary these are really cool they're

332
00:12:33,710 --> 00:12:36,920
really fun you can even do a little bit

333
00:12:35,420 --> 00:12:39,199
more excitement here and put in honey

334
00:12:36,920 --> 00:12:41,209
users into your network in your document

335
00:12:39,200 --> 00:12:42,890
and have them recorded right there fake

336
00:12:41,210 --> 00:12:45,020
user fake passwords that you could have

337
00:12:42,890 --> 00:12:46,580
in these documents and as the adversary

338
00:12:45,020 --> 00:12:48,230
is moving laterally and finding this

339
00:12:46,580 --> 00:12:49,730
information you're going to be actually

340
00:12:48,230 --> 00:12:52,870
tracking them via the patterns that

341
00:12:49,730 --> 00:12:54,669
they're using for what they're finding

342
00:12:52,870 --> 00:12:57,559
yes

343
00:12:54,669 --> 00:12:59,959
so when we submitted the slides we were

344
00:12:57,559 --> 00:13:04,339
told oh man not another presentation

345
00:12:59,959 --> 00:13:06,978
with Hitler's slides in them we were all

346
00:13:04,339 --> 00:13:08,929
in the same wavelength so let's talk a

347
00:13:06,979 --> 00:13:11,209
little bit about passive DNS so a lot of

348
00:13:08,929 --> 00:13:14,108
you probably use passive DNS I imagine

349
00:13:11,209 --> 00:13:16,518
yeah everybody's probably lots of you

350
00:13:14,109 --> 00:13:18,679
typically the way you utilize passive

351
00:13:16,519 --> 00:13:20,779
DNS especially for a crowd like this is

352
00:13:18,679 --> 00:13:23,809
you're buying that from a service and

353
00:13:20,779 --> 00:13:25,279
you're getting a macro view of of what

354
00:13:23,809 --> 00:13:26,978
the Internet sees right or what

355
00:13:25,279 --> 00:13:30,199
different points around the internet see

356
00:13:26,979 --> 00:13:31,729
for for DNS or you know over over

357
00:13:30,199 --> 00:13:33,618
history right but you can actually

358
00:13:31,729 --> 00:13:37,759
collect this information in your own

359
00:13:33,619 --> 00:13:40,249
environment as well and actually so

360
00:13:37,759 --> 00:13:42,169
passive DNS is hard to visualize so we

361
00:13:40,249 --> 00:13:47,409
put up just a picture of Ryan's new papa

362
00:13:42,169 --> 00:13:49,579
me and I'm not sure why we did that but

363
00:13:47,409 --> 00:13:53,779
because I made the presentation that's

364
00:13:49,579 --> 00:13:56,118
why healthy um but you know what you're

365
00:13:53,779 --> 00:14:00,889
doing with passive DNS right is is your

366
00:13:56,119 --> 00:14:02,720
over time collecting the IP addresses

367
00:14:00,889 --> 00:14:04,639
and the domain names and how they map to

368
00:14:02,720 --> 00:14:06,259
one another right so what are your users

369
00:14:04,639 --> 00:14:09,439
singing and you buy this like I said

370
00:14:06,259 --> 00:14:11,059
from a vendor you get the macro view you

371
00:14:09,439 --> 00:14:13,699
can collect it in your own environment

372
00:14:11,059 --> 00:14:15,409
using things like Pro like you know full

373
00:14:13,699 --> 00:14:17,748
pack you know extracting it from full

374
00:14:15,409 --> 00:14:20,869
packet captures we have ways to collect

375
00:14:17,749 --> 00:14:22,489
it and slunk a lot of ways to do it and

376
00:14:20,869 --> 00:14:24,529
ultimately that this is actually an app

377
00:14:22,489 --> 00:14:26,720
that was written by a colleague of ours

378
00:14:24,529 --> 00:14:28,399
that will collect that data and do that

379
00:14:26,720 --> 00:14:30,889
mapping for you right so then you can go

380
00:14:28,399 --> 00:14:32,869
back in history and look hey what was

381
00:14:30,889 --> 00:14:36,559
this IP addressing or what was this IP

382
00:14:32,869 --> 00:14:38,479
address resolving to you know a year ago

383
00:14:36,559 --> 00:14:40,279
right or what was this domain you know

384
00:14:38,479 --> 00:14:42,079
resolving to a year ago or what where

385
00:14:40,279 --> 00:14:44,569
else did we see this IP address or this

386
00:14:42,079 --> 00:14:47,329
domain in our own environment you can

387
00:14:44,569 --> 00:14:48,498
actually do this mostly for free like if

388
00:14:47,329 --> 00:14:52,039
you did this and slunk you'd pay a

389
00:14:48,499 --> 00:14:54,079
little bit for the ingesting the data or

390
00:14:52,039 --> 00:14:56,659
whatever but the the bits as far as

391
00:14:54,079 --> 00:14:59,809
analyzing it or all free collection is

392
00:14:56,659 --> 00:15:02,269
just a matter of of hardware right and a

393
00:14:59,809 --> 00:15:04,899
little bit of elbow grease but but

394
00:15:02,269 --> 00:15:07,920
something is very very easy to do

395
00:15:04,899 --> 00:15:10,110
provides a ton of value to you

396
00:15:07,920 --> 00:15:14,550
you threaten tell analysts and gives you

397
00:15:10,110 --> 00:15:16,889
that that internal view yep so you know

398
00:15:14,550 --> 00:15:19,769
definitely you know kind of what I just

399
00:15:16,889 --> 00:15:21,389
said it's worth doing you can find out

400
00:15:19,769 --> 00:15:23,339
how adversaries are pivoting right

401
00:15:21,389 --> 00:15:25,470
through your environment and you can use

402
00:15:23,339 --> 00:15:30,389
it for hunting using your own data

403
00:15:25,470 --> 00:15:32,130
oh so Google Suey right everyone in this

404
00:15:30,389 --> 00:15:34,019
room probably can use some sort of

405
00:15:32,130 --> 00:15:36,959
Google foo obviously this has been well

406
00:15:34,019 --> 00:15:38,070
popularized with Johnny maybe you're

407
00:15:36,959 --> 00:15:39,630
using a sign the local Chinese

408
00:15:38,070 --> 00:15:42,360
restaurants or just go through and

409
00:15:39,630 --> 00:15:43,380
trying to find Folio who knows but I

410
00:15:42,360 --> 00:15:44,790
want to talk to you about a slightly

411
00:15:43,380 --> 00:15:47,850
different method that I personally had a

412
00:15:44,790 --> 00:15:49,740
lot of success with in my career every

413
00:15:47,850 --> 00:15:51,209
organization has a lot of different

414
00:15:49,740 --> 00:15:53,100
vendors a lot of different hardware a

415
00:15:51,209 --> 00:15:55,349
lot of different software seats and all

416
00:15:53,100 --> 00:15:57,089
these things and every single one of us

417
00:15:55,350 --> 00:15:59,070
who's a vendor or creates an appliance

418
00:15:57,089 --> 00:16:01,230
or crease an open-source project has

419
00:15:59,070 --> 00:16:02,310
vulnerabilities they have compromises

420
00:16:01,230 --> 00:16:04,920
they have all these sorts of things

421
00:16:02,310 --> 00:16:06,359
right and there's no damn way to keep up

422
00:16:04,920 --> 00:16:08,459
with them all you a lot of times you

423
00:16:06,360 --> 00:16:09,930
find out when it's on CNN and it's been

424
00:16:08,459 --> 00:16:11,250
out for a week or you're finding out

425
00:16:09,930 --> 00:16:13,260
three months later when you're patching

426
00:16:11,250 --> 00:16:15,329
team says oh yeah we finally patch that

427
00:16:13,260 --> 00:16:19,140
crit one vulnerability so how do you

428
00:16:15,329 --> 00:16:21,510
keep up Google Alert it's super simple

429
00:16:19,140 --> 00:16:25,740
really effective I want to go over this

430
00:16:21,510 --> 00:16:27,569
real fast you na if you're working a

431
00:16:25,740 --> 00:16:28,860
theory operation center or an effusion

432
00:16:27,570 --> 00:16:30,899
cell or something like that you're

433
00:16:28,860 --> 00:16:33,180
probably not on the pointy edge of the

434
00:16:30,899 --> 00:16:34,589
sphere for emails coming in about your

435
00:16:33,180 --> 00:16:37,229
recent Fisk oval 'nor ability or

436
00:16:34,589 --> 00:16:39,089
vulnerability you do need to know this

437
00:16:37,230 --> 00:16:40,230
though if you're in threat Intel as I

438
00:16:39,089 --> 00:16:41,399
learned this week maybe you're building

439
00:16:40,230 --> 00:16:42,779
out a threat model where you need to

440
00:16:41,399 --> 00:16:44,519
know where you're vulnerable assets are

441
00:16:42,779 --> 00:16:46,260
if you're a security operations center

442
00:16:44,519 --> 00:16:48,839
you need to find out why did I suddenly

443
00:16:46,260 --> 00:16:52,410
get a huge increase in attacks on this

444
00:16:48,839 --> 00:16:54,540
poor or this webpage is coming in using

445
00:16:52,410 --> 00:16:56,399
Google Alerts you can set up the very

446
00:16:54,540 --> 00:16:58,380
specific searches about your

447
00:16:56,399 --> 00:17:00,750
infrastructure in your critical assets

448
00:16:58,380 --> 00:17:02,899
and how they affect you so in this case

449
00:17:00,750 --> 00:17:06,030
if you never done it for superfast

450
00:17:02,899 --> 00:17:07,349
google.com slash alerts and you just put

451
00:17:06,030 --> 00:17:09,178
in now that's completely imaginary

452
00:17:07,349 --> 00:17:14,339
situation because we never have exploits

453
00:17:09,179 --> 00:17:18,209
or vulnerabilities for our software site

454
00:17:14,339 --> 00:17:19,829
: WWF uncom exploit I can get more

455
00:17:18,209 --> 00:17:21,569
specific I could say hey this is where

456
00:17:19,829 --> 00:17:23,158
we publish all these documents

457
00:17:21,569 --> 00:17:24,599
maybe you want to put this on half bebe

458
00:17:23,159 --> 00:17:26,639
maybe you want to go on to whatever your

459
00:17:24,599 --> 00:17:28,678
favorite hacker forum is and do a little

460
00:17:26,638 --> 00:17:30,269
bit more digging there but you set this

461
00:17:28,679 --> 00:17:32,100
up real fast and what you'll notice is I

462
00:17:30,269 --> 00:17:34,230
have it set up where how often add to

463
00:17:32,100 --> 00:17:36,539
happen so adds Google indexes these new

464
00:17:34,230 --> 00:17:38,909
log you're actually getting updated with

465
00:17:36,539 --> 00:17:40,559
it and you could either send email or

466
00:17:38,909 --> 00:17:44,309
what I think is a much more

467
00:17:40,559 --> 00:17:46,168
twentieth-century method RSS feed I love

468
00:17:44,309 --> 00:17:47,639
our sets it kind of went away but you

469
00:17:46,169 --> 00:17:49,529
can do a lot of great things with it so

470
00:17:47,639 --> 00:17:50,879
maybe you have that 50 inch monitor in

471
00:17:49,529 --> 00:17:54,179
your sauce that you never actually found

472
00:17:50,880 --> 00:17:57,000
any use for other than C spam or North

473
00:17:54,179 --> 00:17:59,159
nap we don't like to talk about that too

474
00:17:57,000 --> 00:18:01,409
few you could actually put in an RSS

475
00:17:59,159 --> 00:18:03,210
feed or maybe you have that there or you

476
00:18:01,409 --> 00:18:05,490
want to join the 21st century take that

477
00:18:03,210 --> 00:18:07,740
RSS feed and ingest it into your

478
00:18:05,490 --> 00:18:10,200
analytical tools or your sim or your

479
00:18:07,740 --> 00:18:12,870
whatever it be I highly recommend

480
00:18:10,200 --> 00:18:14,730
auditing or automating it it is XML

481
00:18:12,870 --> 00:18:15,870
structured data so this is super easy to

482
00:18:14,730 --> 00:18:19,169
parse or the variety of different

483
00:18:15,870 --> 00:18:20,489
methods right get out there be proactive

484
00:18:19,169 --> 00:18:22,259
find out what's happening on your

485
00:18:20,490 --> 00:18:24,299
network before you're waiting for Bob

486
00:18:22,259 --> 00:18:25,889
and Patch Tuesday to come back to you

487
00:18:24,299 --> 00:18:32,070
three weeks later and make your own

488
00:18:25,889 --> 00:18:35,610
decisions all right oh yeah so let's

489
00:18:32,070 --> 00:18:39,269
talk a little bit about LinkedIn it's an

490
00:18:35,610 --> 00:18:41,129
interesting one so LinkedIn actually

491
00:18:39,269 --> 00:18:43,590
super amazing source for understanding

492
00:18:41,129 --> 00:18:45,449
your own organization and understanding

493
00:18:43,590 --> 00:18:47,610
what adversaries know about your

494
00:18:45,450 --> 00:18:50,039
organization and we really wanted to

495
00:18:47,610 --> 00:18:52,500
include it in this talk so we started

496
00:18:50,039 --> 00:18:58,169
kind of digging in on it and what we

497
00:18:52,500 --> 00:18:59,909
learned was that at least at least for

498
00:18:58,169 --> 00:19:01,200
folks that are new to it maybe don't

499
00:18:59,909 --> 00:19:03,539
know all the secrets it's

500
00:19:01,200 --> 00:19:05,700
extraordinarily hard to get API access

501
00:19:03,539 --> 00:19:09,090
to LinkedIn to pull the kind of data

502
00:19:05,700 --> 00:19:10,740
that we wanted to we tried and failed

503
00:19:09,090 --> 00:19:12,750
actually but we came up with a way

504
00:19:10,740 --> 00:19:14,220
that's kind of do it in an ad hoc way

505
00:19:12,750 --> 00:19:18,480
anyway which we'll share with you right

506
00:19:14,220 --> 00:19:22,470
now so super simple right we created a

507
00:19:18,480 --> 00:19:25,590
we created a new LinkedIn persona right

508
00:19:22,470 --> 00:19:27,330
just some person not affiliated with me

509
00:19:25,590 --> 00:19:31,168
brand new email address brand new

510
00:19:27,330 --> 00:19:33,389
everything right and we log in and we

511
00:19:31,169 --> 00:19:34,780
just search for Splunk right and and it

512
00:19:33,389 --> 00:19:38,770
comes back and it shows a few

513
00:19:34,780 --> 00:19:40,379
okay here's some some like job titles

514
00:19:38,770 --> 00:19:42,670
but doesn't show name doesn't show

515
00:19:40,380 --> 00:19:45,370
location doesn't show the valuable stuff

516
00:19:42,670 --> 00:19:47,230
but if you actually just associate that

517
00:19:45,370 --> 00:19:49,360
user with LinkedIn where excuse me with

518
00:19:47,230 --> 00:19:51,730
squonk right say hey I work at spunk in

519
00:19:49,360 --> 00:19:54,580
which you can just do and then if you

520
00:19:51,730 --> 00:19:58,330
can trick a couple of people like say me

521
00:19:54,580 --> 00:20:00,699
and Ryan into linking in with that with

522
00:19:58,330 --> 00:20:02,830
that new persona all of a sudden you see

523
00:20:00,700 --> 00:20:06,100
like a crap ton of stuff right you see

524
00:20:02,830 --> 00:20:10,659
all kinds of information like you know

525
00:20:06,100 --> 00:20:12,610
some you know the user's name the you

526
00:20:10,660 --> 00:20:15,640
know where they're located and in this

527
00:20:12,610 --> 00:20:18,280
case super like that's when I realized

528
00:20:15,640 --> 00:20:21,160
how much you know LinkedIn is doing like

529
00:20:18,280 --> 00:20:22,840
geolocation stuff because this list that

530
00:20:21,160 --> 00:20:24,280
showed up at just after linking in with

531
00:20:22,840 --> 00:20:26,889
me and Ryan all of a sudden it shows

532
00:20:24,280 --> 00:20:28,540
James it shows Steve Steve's the guy

533
00:20:26,890 --> 00:20:31,000
that wrote the passive DNS app we showed

534
00:20:28,540 --> 00:20:32,710
earlier these are not only security guys

535
00:20:31,000 --> 00:20:34,000
that we work with every single day but

536
00:20:32,710 --> 00:20:36,310
they're guys that live in Denver which

537
00:20:34,000 --> 00:20:38,830
is where I was sitting when when we did

538
00:20:36,310 --> 00:20:40,360
this so you can actually get that you

539
00:20:38,830 --> 00:20:44,560
can get a ton of information very very

540
00:20:40,360 --> 00:20:46,300
quickly by by just creating a persona

541
00:20:44,560 --> 00:20:48,370
like this but you still have the problem

542
00:20:46,300 --> 00:20:50,470
of like yeah that's all in LinkedIn and

543
00:20:48,370 --> 00:20:52,389
we want to pull it out and use it in our

544
00:20:50,470 --> 00:20:54,790
in whatever you know whatever tool we

545
00:20:52,390 --> 00:20:57,700
have right and we couldn't get API

546
00:20:54,790 --> 00:20:59,350
access and actually we're talking last

547
00:20:57,700 --> 00:21:01,450
night with some of the thread Intel

548
00:20:59,350 --> 00:21:03,189
providers that do this every day and

549
00:21:01,450 --> 00:21:05,950
they're like yeah it's hard and they

550
00:21:03,190 --> 00:21:07,570
have their ways of doing it but really

551
00:21:05,950 --> 00:21:10,960
we're talking to one a year guys talking

552
00:21:07,570 --> 00:21:12,310
about how difficult it was but we're

553
00:21:10,960 --> 00:21:13,900
like hey we got it we got to do this

554
00:21:12,310 --> 00:21:16,419
talk and we want to include LinkedIn so

555
00:21:13,900 --> 00:21:20,290
we figured out an interesting way to do

556
00:21:16,420 --> 00:21:23,170
this so you guys know recon ng yeah so

557
00:21:20,290 --> 00:21:24,610
recon ng great hacker tool great for

558
00:21:23,170 --> 00:21:27,220
reconnaissance if you've ever done pen

559
00:21:24,610 --> 00:21:29,760
testing or whatever great to learn about

560
00:21:27,220 --> 00:21:32,200
organizations there's actually a this is

561
00:21:29,760 --> 00:21:34,270
hang with me here but there's a there's

562
00:21:32,200 --> 00:21:36,280
a there's a plugin for recon ng that's

563
00:21:34,270 --> 00:21:38,980
not actually in recon ng it's a pull

564
00:21:36,280 --> 00:21:40,750
request into that project but what it

565
00:21:38,980 --> 00:21:42,730
allows you to do is actually do screen

566
00:21:40,750 --> 00:21:45,429
scraping on LinkedIn so you can actually

567
00:21:42,730 --> 00:21:47,580
pull that down then goes one or two

568
00:21:45,429 --> 00:21:50,190
little Python things that we tweaked

569
00:21:47,580 --> 00:21:52,050
- smidge and then we're able to do

570
00:21:50,190 --> 00:21:53,730
screen scraping and pull all that rich

571
00:21:52,050 --> 00:21:56,159
data that we were just looking at from

572
00:21:53,730 --> 00:21:58,260
that from that new fake account pull it

573
00:21:56,160 --> 00:21:59,910
down and the results at the bottom

574
00:21:58,260 --> 00:22:02,820
they're showing as is that's actually

575
00:21:59,910 --> 00:22:05,160
you know coming across from LinkedIn so

576
00:22:02,820 --> 00:22:07,679
you know this gives you a ton of

577
00:22:05,160 --> 00:22:09,900
opportunity right to figure out you know

578
00:22:07,680 --> 00:22:13,050
who's joining my organization on

579
00:22:09,900 --> 00:22:15,150
LinkedIn are they actual employees you

580
00:22:13,050 --> 00:22:16,409
know ultimately if you develop this a

581
00:22:15,150 --> 00:22:18,690
little bit more you'd be able to do

582
00:22:16,410 --> 00:22:21,720
analysis like hey when when an email

583
00:22:18,690 --> 00:22:23,790
comes in is that from somebody who just

584
00:22:21,720 --> 00:22:27,240
connected with ten to ten of our

585
00:22:23,790 --> 00:22:29,790
employees on on LinkedIn right starting

586
00:22:27,240 --> 00:22:32,250
to statistically look for hey is this

587
00:22:29,790 --> 00:22:35,670
something that looks maybe like some

588
00:22:32,250 --> 00:22:38,370
sort of adversary actually trying to you

589
00:22:35,670 --> 00:22:43,440
know get our get our users to click on

590
00:22:38,370 --> 00:22:45,899
something or or open the email so we'll

591
00:22:43,440 --> 00:22:47,730
go on to the next one here so incredibly

592
00:22:45,900 --> 00:22:52,100
hard to find World War two propaganda

593
00:22:47,730 --> 00:22:54,210
photos with the word squatting who knew

594
00:22:52,100 --> 00:22:55,830
however I did find these lovely

595
00:22:54,210 --> 00:22:58,080
squatting Japanese men on the battleship

596
00:22:55,830 --> 00:22:59,720
Yamamoto so I still think I get points

597
00:22:58,080 --> 00:23:03,179
Rick a couple two maybe

598
00:22:59,720 --> 00:23:04,620
so domain squatting this is also not new

599
00:23:03,180 --> 00:23:07,050
this has been around as long as people

600
00:23:04,620 --> 00:23:09,689
had no names right and the idea is to

601
00:23:07,050 --> 00:23:12,990
mimic a legitimate domain most recent

602
00:23:09,690 --> 00:23:14,520
case being a poor mr. pedesta receiving

603
00:23:12,990 --> 00:23:16,260
email that looks beautifully formatted

604
00:23:14,520 --> 00:23:18,900
with Google looks like a login when you

605
00:23:16,260 --> 00:23:21,450
actually dig into the domain it's this

606
00:23:18,900 --> 00:23:24,330
very exciting account my account Google

607
00:23:21,450 --> 00:23:28,740
calm cool everything's fine wait there's

608
00:23:24,330 --> 00:23:31,290
more typing security setting page TK

609
00:23:28,740 --> 00:23:33,630
right obviously your legitimate but at

610
00:23:31,290 --> 00:23:35,250
first glance a lot of users aren't going

611
00:23:33,630 --> 00:23:37,110
to see path to what looks like a pretty

612
00:23:35,250 --> 00:23:38,340
pretty reasonable thing when you look at

613
00:23:37,110 --> 00:23:39,510
everything else and realize that's all

614
00:23:38,340 --> 00:23:43,740
kind of stuff that you might see on a

615
00:23:39,510 --> 00:23:44,850
URL I like to use the tool DNS twist I

616
00:23:43,740 --> 00:23:46,110
don't think enough people are talking

617
00:23:44,850 --> 00:23:48,330
about this they had a little bit of bump

618
00:23:46,110 --> 00:23:50,100
recently I think this is one of the

619
00:23:48,330 --> 00:23:51,780
single coolest things that people can do

620
00:23:50,100 --> 00:23:54,990
that literally takes like five minutes

621
00:23:51,780 --> 00:23:58,960
of effort and you will get benefits they

622
00:23:54,990 --> 00:24:00,880
call a domain name permutation engine to

623
00:23:58,960 --> 00:24:02,470
like six or seven different methods

624
00:24:00,880 --> 00:24:04,660
everything type of squatting the bits

625
00:24:02,470 --> 00:24:08,620
waiting or bits quitting I don't know a

626
00:24:04,660 --> 00:24:10,630
little bit squatting changing words and

627
00:24:08,620 --> 00:24:12,370
letters and email or in a domain right

628
00:24:10,630 --> 00:24:15,190
and so what you do kind of takes on Sam

629
00:24:12,370 --> 00:24:16,719
and say a splint for one you run this

630
00:24:15,190 --> 00:24:18,790
command I'm going to go over this

631
00:24:16,720 --> 00:24:21,010
briefly to give you idea but it's going

632
00:24:18,790 --> 00:24:23,649
to do replacement of the word Sam sort

633
00:24:21,010 --> 00:24:25,330
or clump calm or cnn.com and it's going

634
00:24:23,650 --> 00:24:26,710
to find dozens if not hundreds of

635
00:24:25,330 --> 00:24:28,570
different domains that are very similar

636
00:24:26,710 --> 00:24:30,490
to this then it's going to do the grunt

637
00:24:28,570 --> 00:24:32,169
work for you and actually go out and see

638
00:24:30,490 --> 00:24:34,000
if that domain has been registered how

639
00:24:32,170 --> 00:24:36,160
recently has it been registered if

640
00:24:34,000 --> 00:24:36,580
you're an MX record associated with it

641
00:24:36,160 --> 00:24:39,220
right

642
00:24:36,580 --> 00:24:40,510
hugely valuable stuff and then it's

643
00:24:39,220 --> 00:24:42,760
going to pull it all and kick it into a

644
00:24:40,510 --> 00:24:44,500
CSV which is awesome because I hear

645
00:24:42,760 --> 00:24:48,129
lately that Excel is a single best tool

646
00:24:44,500 --> 00:24:50,190
ever made for an analyst I would like to

647
00:24:48,130 --> 00:24:52,660
argue once again Wahhabi R just saying

648
00:24:50,190 --> 00:24:55,870
you can add more to this right it's not

649
00:24:52,660 --> 00:24:58,150
just these permutations you can also add

650
00:24:55,870 --> 00:24:59,679
your own threat list right the amount of

651
00:24:58,150 --> 00:25:03,880
times I've seen spear phishing emails

652
00:24:59,680 --> 00:25:04,870
come in with WW company name com massive

653
00:25:03,880 --> 00:25:06,700
number right these are just examples

654
00:25:04,870 --> 00:25:08,949
that I've used and other people have

655
00:25:06,700 --> 00:25:10,510
I've also added in things like I'll pick

656
00:25:08,950 --> 00:25:12,730
on Albania they're probably not in the

657
00:25:10,510 --> 00:25:15,940
room but a lot of times you'll see

658
00:25:12,730 --> 00:25:17,710
things legitimate domain - Albania com

659
00:25:15,940 --> 00:25:19,570
right and these are actually like

660
00:25:17,710 --> 00:25:21,100
legitimate debate sometimes people stand

661
00:25:19,570 --> 00:25:22,960
things up for their regional presence

662
00:25:21,100 --> 00:25:25,480
with that also very easy for an

663
00:25:22,960 --> 00:25:27,550
adversary you can create your own custom

664
00:25:25,480 --> 00:25:31,630
dictionary and then have the DNS twist

665
00:25:27,550 --> 00:25:33,669
who will actually use that as well this

666
00:25:31,630 --> 00:25:35,860
is the output and I want you to think

667
00:25:33,670 --> 00:25:37,420
past just looking at this alerting this

668
00:25:35,860 --> 00:25:39,159
is a threat intelligence course also

669
00:25:37,420 --> 00:25:41,590
look at the ability to for not course

670
00:25:39,160 --> 00:25:43,330
talk look at the ability to add risk

671
00:25:41,590 --> 00:25:45,340
right look at the ability to increase

672
00:25:43,330 --> 00:25:48,790
your posture of who is being targeted

673
00:25:45,340 --> 00:25:50,260
and how and what just because you have

674
00:25:48,790 --> 00:25:51,399
all these different domains doesn't mean

675
00:25:50,260 --> 00:25:53,920
they'll ever be used but you should

676
00:25:51,400 --> 00:25:55,540
probably look at these in the future but

677
00:25:53,920 --> 00:25:57,190
once I have the DNS address or IP

678
00:25:55,540 --> 00:25:59,590
address associated that domain name

679
00:25:57,190 --> 00:26:01,900
that's a plus one right you want to look

680
00:25:59,590 --> 00:26:03,790
a little bit harder and by golly if I

681
00:26:01,900 --> 00:26:06,100
see there's an MS record associated with

682
00:26:03,790 --> 00:26:08,680
that IP address in domain two now we're

683
00:26:06,100 --> 00:26:10,899
really firm to talk and if the creation

684
00:26:08,680 --> 00:26:11,710
date is brand-new and suddenly I get 15

685
00:26:10,900 --> 00:26:13,210
emails before

686
00:26:11,710 --> 00:26:16,240
team people who are recently registered

687
00:26:13,210 --> 00:26:17,860
on life's lung comm LinkedIn profile

688
00:26:16,240 --> 00:26:19,809
you're damn right I want to look at that

689
00:26:17,860 --> 00:26:21,639
a little bit harder these are all higher

690
00:26:19,809 --> 00:26:23,620
threats so you need to be investigating

691
00:26:21,640 --> 00:26:25,779
and working on triaging right bring that

692
00:26:23,620 --> 00:26:31,239
Perl up from the sewage and try to find

693
00:26:25,779 --> 00:26:32,529
the things that are there what are some

694
00:26:31,240 --> 00:26:34,870
good euphemisms

695
00:26:32,529 --> 00:26:37,120
first backward don't just use this data

696
00:26:34,870 --> 00:26:38,799
as an alert thing for today I'll so go

697
00:26:37,120 --> 00:26:41,320
back in time for anything new that comes

698
00:26:38,799 --> 00:26:43,179
up and create variables for risk really

699
00:26:41,320 --> 00:26:45,279
look through and try to find fun stuff

700
00:26:43,179 --> 00:26:47,590
and look at this create your hypothesis

701
00:26:45,279 --> 00:26:55,830
this is occurring test it and then see

702
00:26:47,590 --> 00:26:59,470
what her all right nope not done uh-huh

703
00:26:55,830 --> 00:27:04,960
actually came to I'm not on Cal bonus

704
00:26:59,470 --> 00:27:06,309
round cool so you know all this stuff

705
00:27:04,960 --> 00:27:08,020
we're showing you obviously just

706
00:27:06,309 --> 00:27:09,309
screenshots and we didn't do demos or

707
00:27:08,020 --> 00:27:12,240
anything like that but we've captured

708
00:27:09,309 --> 00:27:14,020
really all of these techniques

709
00:27:12,240 --> 00:27:15,940
everything that we did to sort of

710
00:27:14,020 --> 00:27:18,668
generate those and and and that's

711
00:27:15,940 --> 00:27:20,679
actually working we captured those into

712
00:27:18,669 --> 00:27:23,919
a Splunk app that you can download from

713
00:27:20,679 --> 00:27:26,140
from our website again completely free

714
00:27:23,919 --> 00:27:29,799
just a just one possible way to show

715
00:27:26,140 --> 00:27:32,740
these things it's I don't github it's

716
00:27:29,799 --> 00:27:34,720
out on slunk base use the github one and

717
00:27:32,740 --> 00:27:36,419
at least for the next 10 to 15 minutes

718
00:27:34,720 --> 00:27:38,740
it needs an update on from slunk base

719
00:27:36,419 --> 00:27:40,539
but but this will allow you to download

720
00:27:38,740 --> 00:27:43,090
that at download the free version of

721
00:27:40,539 --> 00:27:44,559
squonk a free app there's sample data in

722
00:27:43,090 --> 00:27:46,418
there for kind of all the techniques we

723
00:27:44,559 --> 00:27:48,549
just use you can kind of see see how

724
00:27:46,419 --> 00:27:54,220
that works in your environment use it as

725
00:27:48,549 --> 00:27:56,379
a jumping-off point and with that oh yes

726
00:27:54,220 --> 00:27:58,390
so you know hopefully you know we're

727
00:27:56,380 --> 00:28:00,340
just giving you all some ideas about

728
00:27:58,390 --> 00:28:01,990
ways that you can just you know be

729
00:28:00,340 --> 00:28:04,149
creative right think about the data that

730
00:28:01,990 --> 00:28:07,659
you have in your environment take a tool

731
00:28:04,149 --> 00:28:09,279
simple tool like you know simple tool

732
00:28:07,659 --> 00:28:11,860
like Splunk org or like anything else

733
00:28:09,279 --> 00:28:14,919
right and you know even Excel so Ryan's

734
00:28:11,860 --> 00:28:16,059
point it starts leveraging the data that

735
00:28:14,919 --> 00:28:17,890
you already have in your environment

736
00:28:16,059 --> 00:28:20,408
there's many many other examples we

737
00:28:17,890 --> 00:28:22,029
didn't talk about today like trouble

738
00:28:20,409 --> 00:28:23,960
ticketing system incident response

739
00:28:22,029 --> 00:28:26,510
systems you name it

740
00:28:23,960 --> 00:28:28,580
um so so there's a tremendous amount of

741
00:28:26,510 --> 00:28:30,050
opportunity there to get more value out

742
00:28:28,580 --> 00:28:35,060
of what's already going on in your

743
00:28:30,050 --> 00:28:36,770
environment and the one piece of advice

744
00:28:35,060 --> 00:28:40,370
that Scott gave his mentor was you have

745
00:28:36,770 --> 00:28:42,889
to have a son Zoo quote so instead we

746
00:28:40,370 --> 00:28:45,290
found out in the 26th century there's

747
00:28:42,890 --> 00:28:48,830
actually some cyber zoo so much better

748
00:28:45,290 --> 00:28:50,899
guy check out a Twitter account the idea

749
00:28:48,830 --> 00:28:52,879
here once again if you take anything

750
00:28:50,900 --> 00:28:56,030
away from this I really hope you do it

751
00:28:52,880 --> 00:28:58,100
look local stay home see what you have

752
00:28:56,030 --> 00:29:00,139
first definitely get threat intelligence

753
00:28:58,100 --> 00:29:02,060
from expert vendors but first pull from

754
00:29:00,140 --> 00:29:05,060
your own resources and see what you have

755
00:29:02,060 --> 00:29:07,820
Tip O'Neill used to say all cyber

756
00:29:05,060 --> 00:29:09,290
intelligence is local and then he would

757
00:29:07,820 --> 00:29:10,610
say something about politics and Reagan

758
00:29:09,290 --> 00:29:14,090
would laugh and they do have a lot of

759
00:29:10,610 --> 00:29:15,919
Scotch but the important thing is stay

760
00:29:14,090 --> 00:29:18,949
home look in your own house you're

761
00:29:15,920 --> 00:29:22,640
leaving stuff on the table get it right

762
00:29:18,950 --> 00:29:23,900
so takeaways dig into your own data if

763
00:29:22,640 --> 00:29:25,340
you're not looking at LinkedIn you're

764
00:29:23,900 --> 00:29:27,890
failing I'm going to call that right now

765
00:29:25,340 --> 00:29:29,570
LinkedIn is a huge source of adversary

766
00:29:27,890 --> 00:29:30,680
data they're using it against you why

767
00:29:29,570 --> 00:29:31,970
aren't you at least figure out how

768
00:29:30,680 --> 00:29:34,640
they're using it against you

769
00:29:31,970 --> 00:29:36,260
Deana Swift is literally like three

770
00:29:34,640 --> 00:29:37,640
minutes to compile it get up and going

771
00:29:36,260 --> 00:29:41,000
and you're going to get results

772
00:29:37,640 --> 00:29:43,040
I like automation I was actually really

773
00:29:41,000 --> 00:29:45,050
inspired many years ago by presentation

774
00:29:43,040 --> 00:29:46,639
of Scott Robert Shaw gave on using

775
00:29:45,050 --> 00:29:48,770
robots to fight the bad guys it's a

776
00:29:46,640 --> 00:29:50,720
phenomenal presentation and it falls in

777
00:29:48,770 --> 00:29:52,430
that automate everything you can that we

778
00:29:50,720 --> 00:29:53,690
can lay off your tier one and get cool

779
00:29:52,430 --> 00:29:57,680
or threat intelligence from other

780
00:29:53,690 --> 00:29:59,540
vendors all right local passive DNS is

781
00:29:57,680 --> 00:30:00,890
awesome you're going to see a lot of

782
00:29:59,540 --> 00:30:02,300
stuff on your network that you're never

783
00:30:00,890 --> 00:30:03,680
going to be able to see otherwise and

784
00:30:02,300 --> 00:30:06,379
you'll be able to then dig in and find

785
00:30:03,680 --> 00:30:07,850
compromise post it if you're getting to

786
00:30:06,380 --> 00:30:10,460
where security awareness training data

787
00:30:07,850 --> 00:30:12,949
that is phenomenal stuff you're paying

788
00:30:10,460 --> 00:30:14,570
for it already get double-dipping in mac

789
00:30:12,950 --> 00:30:16,190
you've already got the data now you have

790
00:30:14,570 --> 00:30:18,080
this huge new data source to go back

791
00:30:16,190 --> 00:30:20,780
into and find out which users are most

792
00:30:18,080 --> 00:30:22,909
likely to click on stuff and then decoys

793
00:30:20,780 --> 00:30:23,720
we heard cliff think that was an

794
00:30:22,910 --> 00:30:25,900
incredible story

795
00:30:23,720 --> 00:30:28,010
decoy documents is a really cool example

796
00:30:25,900 --> 00:30:29,450
it's hard to actually find people have

797
00:30:28,010 --> 00:30:32,240
done it successfully so if you have any

798
00:30:29,450 --> 00:30:33,770
use cases or actual experiences of doing

799
00:30:32,240 --> 00:30:35,870
this and seeing results I'd love to hear

800
00:30:33,770 --> 00:30:38,350
them but the most famous is oh I don't

801
00:30:35,870 --> 00:30:38,350
know the truth

802
00:30:40,660 --> 00:30:44,269
[Music]

