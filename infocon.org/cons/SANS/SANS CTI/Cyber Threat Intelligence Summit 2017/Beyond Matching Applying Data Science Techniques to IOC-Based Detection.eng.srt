1
00:00:00,360 --> 00:00:07,820
[Music]

2
00:00:04,220 --> 00:00:07,820
[Applause]

3
00:00:09,710 --> 00:00:15,660
so thank you very much for being here

4
00:00:12,679 --> 00:00:17,130
I'm gonna get started because it's going

5
00:00:15,660 --> 00:00:18,480
to be a little bit of a whirlwind

6
00:00:17,130 --> 00:00:21,479
there's a lot of content to go through

7
00:00:18,480 --> 00:00:23,910
just a quick reminder of course use

8
00:00:21,480 --> 00:00:26,430
hashtag CDI come it if you really really

9
00:00:23,910 --> 00:00:28,680
want to like say a joke and not mention

10
00:00:26,430 --> 00:00:30,539
me on Twitter just use the hashtag for

11
00:00:28,680 --> 00:00:32,579
the talk which is beyond matching right

12
00:00:30,539 --> 00:00:35,160
before anyone says but that's a really

13
00:00:32,579 --> 00:00:37,350
long hashtag so actually secure because

14
00:00:35,160 --> 00:00:39,300
map was longer than that I counted the

15
00:00:37,350 --> 00:00:41,280
characters so it's not that bad

16
00:00:39,300 --> 00:00:43,349
so anyway through into the Twitter's if

17
00:00:41,280 --> 00:00:45,450
you liked our hashtags there you go so

18
00:00:43,350 --> 00:00:47,489
anyway who's this guy my name is Alex

19
00:00:45,450 --> 00:00:52,010
Pinto I'm a capybara enthusiast and on

20
00:00:47,489 --> 00:00:54,269
the side I do security data science and

21
00:00:52,010 --> 00:00:55,860
I've done a lot of my work this is

22
00:00:54,270 --> 00:00:59,489
actually this is me on Halloween this

23
00:00:55,860 --> 00:01:02,399
was my this was donut short capybara we

24
00:00:59,489 --> 00:01:04,739
were I've been working for a while now

25
00:01:02,399 --> 00:01:07,530
as a chief data scientist at a complete

26
00:01:04,739 --> 00:01:09,409
all needle right and I've been

27
00:01:07,530 --> 00:01:11,729
publishing a lot of this work this

28
00:01:09,409 --> 00:01:13,979
threat intelligence slash machine

29
00:01:11,729 --> 00:01:16,320
learning work under the name and all

30
00:01:13,979 --> 00:01:17,939
stack project so this is technically

31
00:01:16,320 --> 00:01:20,460
animal stack projects presentation as

32
00:01:17,939 --> 00:01:22,169
well but I'd rather not give too many

33
00:01:20,460 --> 00:01:24,360
logos in too many names so you get to

34
00:01:22,170 --> 00:01:26,340
think about so let's stick with needle

35
00:01:24,360 --> 00:01:28,770
for a while and a needle what is a

36
00:01:26,340 --> 00:01:30,780
needle it's important a question right

37
00:01:28,770 --> 00:01:32,700
we're working with and this is one of

38
00:01:30,780 --> 00:01:36,900
the reasons why I picket rod all the

39
00:01:32,700 --> 00:01:38,790
time a way repeatable and confident way

40
00:01:36,900 --> 00:01:41,189
to do some autonomous rat hunting right

41
00:01:38,790 --> 00:01:42,540
which leverages a lot of what we've been

42
00:01:41,189 --> 00:01:45,240
talking here on practical juice

43
00:01:42,540 --> 00:01:47,790
consumption on a more automated way

44
00:01:45,240 --> 00:01:50,039
right so a lot of these results came

45
00:01:47,790 --> 00:01:51,720
from ongoing researchers for the past

46
00:01:50,040 --> 00:01:53,250
six to nine months what I've been doing

47
00:01:51,720 --> 00:01:56,130
at needle so I want to give you a

48
00:01:53,250 --> 00:01:58,590
glimpse of cool stuff we can do with IOT

49
00:01:56,130 --> 00:02:01,949
data and specifically natural coyote

50
00:01:58,590 --> 00:02:04,409
data I will clarify that while you are

51
00:02:01,950 --> 00:02:07,950
using again trying to improve your own

52
00:02:04,409 --> 00:02:09,959
consumption practices so anyway first of

53
00:02:07,950 --> 00:02:11,520
all we're going to go through a very

54
00:02:09,959 --> 00:02:13,500
brief introduction because you guys

55
00:02:11,520 --> 00:02:16,590
probably don't need any

56
00:02:13,500 --> 00:02:19,260
dropped a few spoilers there and about

57
00:02:16,590 --> 00:02:20,610
what IOC should be doing for you but you

58
00:02:19,260 --> 00:02:23,070
know it's not sometimes it's not that

59
00:02:20,610 --> 00:02:24,570
easy to get all of that from them we're

60
00:02:23,070 --> 00:02:27,510
going to talk about what actually makes

61
00:02:24,570 --> 00:02:29,989
analysts accept it and using LLC's right

62
00:02:27,510 --> 00:02:33,179
and how we can translate kind of this

63
00:02:29,990 --> 00:02:35,310
code of practice or these processes into

64
00:02:33,180 --> 00:02:36,840
something that we can actually codify as

65
00:02:35,310 --> 00:02:39,600
the science right and maybe get some

66
00:02:36,840 --> 00:02:42,320
interesting uses that we it weren't

67
00:02:39,600 --> 00:02:45,810
abuse right as we were getting the data

68
00:02:42,320 --> 00:02:49,950
in learning and expanding our knowledge

69
00:02:45,810 --> 00:02:51,480
on the IOC data so anyway if anyone of

70
00:02:49,950 --> 00:02:52,829
you here this is like oh this is my

71
00:02:51,480 --> 00:02:55,500
first CGI conference I'm actually

72
00:02:52,830 --> 00:02:56,730
looking into putting CGI into my

73
00:02:55,500 --> 00:02:58,830
organization putting out see

74
00:02:56,730 --> 00:03:01,560
consumptions right I'm sorry I will

75
00:02:58,830 --> 00:03:03,360
spoil you on this presentation I will

76
00:03:01,560 --> 00:03:05,880
tell you how it ends and it ends in

77
00:03:03,360 --> 00:03:07,410
tears right so if anyone doesn't want to

78
00:03:05,880 --> 00:03:09,090
be spoiled they're like oh no I'd rather

79
00:03:07,410 --> 00:03:11,340
watch the movie myself and spend a

80
00:03:09,090 --> 00:03:13,950
couple of million dollars in order to do

81
00:03:11,340 --> 00:03:15,630
that guys it's okay the next talks is

82
00:03:13,950 --> 00:03:19,829
going to be much better because it's

83
00:03:15,630 --> 00:03:21,180
surger right so anyway I just want to

84
00:03:19,830 --> 00:03:23,280
make sure we get the definitions right

85
00:03:21,180 --> 00:03:24,630
again this is a very noisy word

86
00:03:23,280 --> 00:03:26,400
everybody talks about threat

87
00:03:24,630 --> 00:03:27,540
intelligence so interchangeably here

88
00:03:26,400 --> 00:03:29,370
when I'm talking about threat

89
00:03:27,540 --> 00:03:31,380
intelligence I'm talking about IOC

90
00:03:29,370 --> 00:03:34,290
specifically right which are of course

91
00:03:31,380 --> 00:03:35,370
very tactical a tool that you use in

92
00:03:34,290 --> 00:03:38,549
order to identify these people

93
00:03:35,370 --> 00:03:40,890
potentially have a brief you or not

94
00:03:38,550 --> 00:03:43,290
whereas you try to relate them to maybe

95
00:03:40,890 --> 00:03:45,510
an actor or a malware family and all

96
00:03:43,290 --> 00:03:48,390
those different different things right

97
00:03:45,510 --> 00:03:49,679
and again specifically the concepts I'm

98
00:03:48,390 --> 00:03:53,630
going to be talking about they don't

99
00:03:49,680 --> 00:03:55,860
need to be about Network IOC right

100
00:03:53,630 --> 00:03:57,989
specifically on the endpoint side you'll

101
00:03:55,860 --> 00:04:00,360
see that some of a lot of the

102
00:03:57,989 --> 00:04:01,709
assumptions that I use hold but we're

103
00:04:00,360 --> 00:04:03,060
going to stick with one of them and this

104
00:04:01,709 --> 00:04:05,370
is one it's actually much easier to

105
00:04:03,060 --> 00:04:06,989
explain because otherwise all of you

106
00:04:05,370 --> 00:04:08,760
would need to have some sort of

107
00:04:06,989 --> 00:04:10,830
background tomorrow reversing which I

108
00:04:08,760 --> 00:04:14,730
don't so I probably would also make a

109
00:04:10,830 --> 00:04:16,980
fool of myself so it sounds great right

110
00:04:14,730 --> 00:04:19,500
the concept that we can actually have

111
00:04:16,980 --> 00:04:22,229
these identifiers that are going to be

112
00:04:19,500 --> 00:04:23,940
giving us the information on things that

113
00:04:22,229 --> 00:04:24,599
are potentially malicious or potentially

114
00:04:23,940 --> 00:04:26,820
in

115
00:04:24,600 --> 00:04:28,950
in our environment but there are two

116
00:04:26,820 --> 00:04:30,570
main challenges to IOT consumption and

117
00:04:28,950 --> 00:04:33,390
these are both challenges that I have

118
00:04:30,570 --> 00:04:35,700
addressed on past talks that I did right

119
00:04:33,390 --> 00:04:38,460
the first of all of them is the quality

120
00:04:35,700 --> 00:04:41,760
right and the curation and the idea that

121
00:04:38,460 --> 00:04:45,030
the feeds that I'm getting from my open

122
00:04:41,760 --> 00:04:48,030
or semi-private sources or the feeds

123
00:04:45,030 --> 00:04:50,099
that I'm paying for are they good and

124
00:04:48,030 --> 00:04:52,109
good it's a very loaded word again are

125
00:04:50,100 --> 00:04:54,210
they appropriate for what I'm trying to

126
00:04:52,110 --> 00:04:56,730
detect in my environment do they have

127
00:04:54,210 --> 00:04:59,310
enough overlap between themselves today

128
00:04:56,730 --> 00:05:01,290
do they are they being refreshed

129
00:04:59,310 --> 00:05:02,610
frequently enough right so there's a lot

130
00:05:01,290 --> 00:05:05,150
of different questions different ways

131
00:05:02,610 --> 00:05:08,340
you can look at those feeds right and

132
00:05:05,150 --> 00:05:10,469
the flipside of that is actually how do

133
00:05:08,340 --> 00:05:14,729
I get the the appropriate information

134
00:05:10,470 --> 00:05:17,280
how do I get the the the the data that I

135
00:05:14,730 --> 00:05:20,310
need in order to defend my company in a

136
00:05:17,280 --> 00:05:23,130
timely fashion right and I was looking

137
00:05:20,310 --> 00:05:25,770
at this and exploring this on the threat

138
00:05:23,130 --> 00:05:28,469
intelligence sharing presentations where

139
00:05:25,770 --> 00:05:32,190
well maybe we can get to a significant

140
00:05:28,470 --> 00:05:33,960
velocity where people are are actually

141
00:05:32,190 --> 00:05:37,230
giving them the information that they

142
00:05:33,960 --> 00:05:39,419
need to to do faster detection but the

143
00:05:37,230 --> 00:05:41,820
problem is right and again I'm citing

144
00:05:39,420 --> 00:05:44,490
surger who is going to be appear next

145
00:05:41,820 --> 00:05:46,560
right he was actually talking about how

146
00:05:44,490 --> 00:05:49,230
quality and velocity are most of the

147
00:05:46,560 --> 00:05:51,150
times at odds so some if you usually

148
00:05:49,230 --> 00:05:53,190
optimize from one of them for one of

149
00:05:51,150 --> 00:05:54,810
those right you have a problem with the

150
00:05:53,190 --> 00:05:58,140
other if you want to get your data as

151
00:05:54,810 --> 00:05:59,880
fast as possible out there right you're

152
00:05:58,140 --> 00:06:02,669
putting the burden of betting and

153
00:05:59,880 --> 00:06:04,800
observation on the actual analyst of the

154
00:06:02,670 --> 00:06:08,030
receiving organization and not so much

155
00:06:04,800 --> 00:06:10,680
the organization that generated the

156
00:06:08,030 --> 00:06:14,309
original Intel so I love when people

157
00:06:10,680 --> 00:06:16,280
talk about how people should be again

158
00:06:14,310 --> 00:06:18,330
revising the row incidence and

159
00:06:16,280 --> 00:06:20,400
generating their own press intelligence

160
00:06:18,330 --> 00:06:21,870
but to actually have this intelligence

161
00:06:20,400 --> 00:06:24,179
that you're generating internally for

162
00:06:21,870 --> 00:06:26,900
your detection purposes to be in the

163
00:06:24,180 --> 00:06:29,250
level of context and the level of

164
00:06:26,900 --> 00:06:30,780
quality that will actually make it

165
00:06:29,250 --> 00:06:33,120
helpful for other organizations is

166
00:06:30,780 --> 00:06:36,229
actually a much higher bar than most of

167
00:06:33,120 --> 00:06:37,700
us are used to or would be at

168
00:06:36,230 --> 00:06:40,640
are you willing to invest the time and

169
00:06:37,700 --> 00:06:42,200
the resources into doing so anyway I

170
00:06:40,640 --> 00:06:43,640
have absolutely nothing against our

171
00:06:42,200 --> 00:06:46,219
Intelligence Sharing I have absolutely

172
00:06:43,640 --> 00:06:48,349
nothing against the a is program I think

173
00:06:46,220 --> 00:06:50,600
they are a brilliant step in the right

174
00:06:48,350 --> 00:06:52,190
direction but this is one of the

175
00:06:50,600 --> 00:06:54,020
questions this is one of the challenges

176
00:06:52,190 --> 00:06:57,560
that we face one of the you know the

177
00:06:54,020 --> 00:06:59,990
seesaw right the balancing act that we

178
00:06:57,560 --> 00:07:03,080
must be aware of while we're working

179
00:06:59,990 --> 00:07:05,480
with the ILCs right so anyway enough

180
00:07:03,080 --> 00:07:09,169
about the it but let's try to get to the

181
00:07:05,480 --> 00:07:11,690
how right so basically this is what

182
00:07:09,170 --> 00:07:14,180
happens right that's the spoiler part so

183
00:07:11,690 --> 00:07:16,790
people will get the IOC data and they'll

184
00:07:14,180 --> 00:07:18,500
try to do detection with it because wow

185
00:07:16,790 --> 00:07:20,630
yeah this thing is telling me that

186
00:07:18,500 --> 00:07:22,310
there's a potential mauler because of

187
00:07:20,630 --> 00:07:26,960
this so let me try to use this to find

188
00:07:22,310 --> 00:07:29,210
things in my network where machines are

189
00:07:26,960 --> 00:07:31,460
potentially infected and people just get

190
00:07:29,210 --> 00:07:35,210
immediately blinded by the amount of

191
00:07:31,460 --> 00:07:37,190
hospitals and be about the amount of an

192
00:07:35,210 --> 00:07:38,780
interesting or unreasonable matches that

193
00:07:37,190 --> 00:07:41,630
come out of this right and this comes

194
00:07:38,780 --> 00:07:43,669
partially from aging indicators right

195
00:07:41,630 --> 00:07:45,920
things that are probably not more not

196
00:07:43,670 --> 00:07:48,410
reasonable anymore or not actionable

197
00:07:45,920 --> 00:07:51,190
anymore and partially from people making

198
00:07:48,410 --> 00:07:54,530
actual mistakes on inputting data on

199
00:07:51,190 --> 00:07:57,650
analysis I mean I have seen again half a

200
00:07:54,530 --> 00:08:00,799
million dollar trade seeds consistently

201
00:07:57,650 --> 00:08:02,870
sneaking Google DNS IP addresses in

202
00:08:00,800 --> 00:08:04,880
their feed rights and it's like it's not

203
00:08:02,870 --> 00:08:07,490
that they don't fix it quick but if you

204
00:08:04,880 --> 00:08:08,990
catch them on an offbeat right and when

205
00:08:07,490 --> 00:08:12,080
those things are active you might

206
00:08:08,990 --> 00:08:13,940
potentially be again if you are in this

207
00:08:12,080 --> 00:08:15,349
full automation mode and alerting on

208
00:08:13,940 --> 00:08:17,510
everything you might get tripped on that

209
00:08:15,350 --> 00:08:20,210
you know you generate a few thousand

210
00:08:17,510 --> 00:08:22,250
alerts and then the whole credibility of

211
00:08:20,210 --> 00:08:25,400
your process of your team just goes just

212
00:08:22,250 --> 00:08:27,980
thanks right what people end up doing

213
00:08:25,400 --> 00:08:32,030
which is I think a little bit sad it's a

214
00:08:27,980 --> 00:08:35,450
little bit of under use of the of the of

215
00:08:32,030 --> 00:08:37,459
the actual tool the actual data is okay

216
00:08:35,450 --> 00:08:39,710
let's use this for context so if I have

217
00:08:37,460 --> 00:08:41,990
something else alerting right if I had

218
00:08:39,710 --> 00:08:43,610
an IDs match I had an endpoint saying

219
00:08:41,990 --> 00:08:45,680
you come up that's reasonable enough for

220
00:08:43,610 --> 00:08:47,750
our investigations I'm going to dam

221
00:08:45,680 --> 00:08:50,209
query on the threat intelligence data to

222
00:08:47,750 --> 00:08:50,690
see if there's relation to what other

223
00:08:50,210 --> 00:08:52,580
people

224
00:08:50,690 --> 00:08:54,590
have done again there's absolutely

225
00:08:52,580 --> 00:08:57,910
nothing wrong with that it's a perfectly

226
00:08:54,590 --> 00:09:00,890
valid enrichment strategy for your

227
00:08:57,910 --> 00:09:03,980
infamous response but I still think

228
00:09:00,890 --> 00:09:05,870
we're under using it right and this is

229
00:09:03,980 --> 00:09:08,570
one of the problems that I kind of set

230
00:09:05,870 --> 00:09:12,410
out to solve and how can we try to have

231
00:09:08,570 --> 00:09:13,790
dependable alerting coming from IOC s

232
00:09:12,410 --> 00:09:16,819
and present all those kind of things so

233
00:09:13,790 --> 00:09:17,329
anyway it's not supposed to be that bad

234
00:09:16,820 --> 00:09:19,310
right

235
00:09:17,330 --> 00:09:21,050
let's try to work together let's start

236
00:09:19,310 --> 00:09:23,959
to reason some ideas and see if this is

237
00:09:21,050 --> 00:09:27,260
something that can actually come up

238
00:09:23,960 --> 00:09:30,200
because one of the points that I have

239
00:09:27,260 --> 00:09:31,819
and thanks for David for contributing is

240
00:09:30,200 --> 00:09:36,200
light so every single presentation on

241
00:09:31,820 --> 00:09:39,350
this on this summit the thing that makes

242
00:09:36,200 --> 00:09:41,600
analyst effective is actually learning

243
00:09:39,350 --> 00:09:44,570
from the examples right so you see that

244
00:09:41,600 --> 00:09:46,730
the most successful teams they will use

245
00:09:44,570 --> 00:09:50,000
the data that they have the IOC is that

246
00:09:46,730 --> 00:09:52,550
they have the network markers that they

247
00:09:50,000 --> 00:09:55,970
have as okay this is actually a sample

248
00:09:52,550 --> 00:09:58,099
of what this specific actor or this

249
00:09:55,970 --> 00:10:00,470
specific malware is capable of doing

250
00:09:58,100 --> 00:10:03,080
right and when I look at this right in

251
00:10:00,470 --> 00:10:07,070
context to maybe other data sources and

252
00:10:03,080 --> 00:10:09,800
other things that I collected then I can

253
00:10:07,070 --> 00:10:13,300
try to derive the higher level on the

254
00:10:09,800 --> 00:10:16,310
pyramid kind of indicators and kind of

255
00:10:13,300 --> 00:10:17,870
markers that I can use so then I can

256
00:10:16,310 --> 00:10:20,449
extrapolate I can try to figure out

257
00:10:17,870 --> 00:10:22,880
where are these people coming from right

258
00:10:20,450 --> 00:10:25,070
what is the underlying infrastructure

259
00:10:22,880 --> 00:10:27,290
right that these people are potentially

260
00:10:25,070 --> 00:10:30,170
leveling on a specific point in time

261
00:10:27,290 --> 00:10:32,120
right so because and I obviously don't

262
00:10:30,170 --> 00:10:34,339
have to tell you guys there's but in a

263
00:10:32,120 --> 00:10:37,220
way everything is connected right it can

264
00:10:34,339 --> 00:10:40,040
very easily if you dig into this find

265
00:10:37,220 --> 00:10:42,320
this pivoting point this relation points

266
00:10:40,040 --> 00:10:45,079
it's what we do or most of us should be

267
00:10:42,320 --> 00:10:46,730
doing on something like multigo or I

268
00:10:45,080 --> 00:10:48,740
don't know if you are on the higher pay

269
00:10:46,730 --> 00:10:51,860
end of the scale maybe Palantir but I

270
00:10:48,740 --> 00:10:54,950
don't know it's all it's all up to you

271
00:10:51,860 --> 00:10:57,080
and how much money you have so what

272
00:10:54,950 --> 00:10:59,930
actually happens in a way and this is a

273
00:10:57,080 --> 00:11:02,300
very very simple very simple

274
00:10:59,930 --> 00:11:03,410
bastardization of what the process is

275
00:11:02,300 --> 00:11:04,060
like right

276
00:11:03,410 --> 00:11:05,890
if you

277
00:11:04,060 --> 00:11:08,050
if you're tracking for Frosty penguin

278
00:11:05,890 --> 00:11:09,910
right and you want to build a report on

279
00:11:08,050 --> 00:11:11,319
frosty penguin right you're going to

280
00:11:09,910 --> 00:11:13,030
have a customer of yours you're going to

281
00:11:11,320 --> 00:11:14,950
have an organization your app that you

282
00:11:13,030 --> 00:11:17,230
use the spec that's related to that and

283
00:11:14,950 --> 00:11:19,900
you are finding a piece of malware

284
00:11:17,230 --> 00:11:21,190
you're reversing it or you're detonating

285
00:11:19,900 --> 00:11:23,230
it is figuring out what pieces of

286
00:11:21,190 --> 00:11:24,340
infrastructure is talking to then you

287
00:11:23,230 --> 00:11:25,900
learn from these pieces of

288
00:11:24,340 --> 00:11:27,610
infrastructure you try to expand your

289
00:11:25,900 --> 00:11:30,250
knowledge on that expanding indicators

290
00:11:27,610 --> 00:11:32,080
maybe the person who registered this may

291
00:11:30,250 --> 00:11:33,700
be the data center where these IP

292
00:11:32,080 --> 00:11:36,880
addresses are hosting and then you do

293
00:11:33,700 --> 00:11:38,920
some back and forth between okay let me

294
00:11:36,880 --> 00:11:40,810
try this new batch of indicators to see

295
00:11:38,920 --> 00:11:43,000
if I can find new matches on my

296
00:11:40,810 --> 00:11:44,619
environment then you end up finding new

297
00:11:43,000 --> 00:11:46,900
pieces of malware and you go back and

298
00:11:44,620 --> 00:11:48,850
forth until you know it's it's heritable

299
00:11:46,900 --> 00:11:50,740
till you have nothing else to look at

300
00:11:48,850 --> 00:11:53,170
and then hopefully you found everything

301
00:11:50,740 --> 00:11:55,060
you go into containments right you go

302
00:11:53,170 --> 00:11:56,860
into you should you try to shut down

303
00:11:55,060 --> 00:11:59,079
everything at once again this is not an

304
00:11:56,860 --> 00:12:01,780
IR talk you guys should know what to do

305
00:11:59,080 --> 00:12:03,460
but there's a rhythm to this discovery

306
00:12:01,780 --> 00:12:05,560
that is rhythm to this expansion right

307
00:12:03,460 --> 00:12:07,780
which again it's also codifying a little

308
00:12:05,560 --> 00:12:10,239
bit in the hunting practice right and

309
00:12:07,780 --> 00:12:11,589
then you catch all of them and you

310
00:12:10,240 --> 00:12:13,960
publish a report and you're famous

311
00:12:11,590 --> 00:12:14,710
forever and you get a lot of leads and

312
00:12:13,960 --> 00:12:20,310
things like that

313
00:12:14,710 --> 00:12:22,780
right so given that there is so much

314
00:12:20,310 --> 00:12:24,969
there's so much use right this is

315
00:12:22,780 --> 00:12:26,670
something that's so effective to try to

316
00:12:24,970 --> 00:12:28,810
figure out again the underlying

317
00:12:26,670 --> 00:12:31,510
infrastructure the underlying pivoting

318
00:12:28,810 --> 00:12:33,880
points right everybody will try to ok

319
00:12:31,510 --> 00:12:36,130
I've seen this ID I'm not really sure

320
00:12:33,880 --> 00:12:38,140
about it but let me see where this IT

321
00:12:36,130 --> 00:12:42,460
girls let me see what domains connect to

322
00:12:38,140 --> 00:12:44,380
it can't we try to code apply some sort

323
00:12:42,460 --> 00:12:48,490
of algorithm to it can we try to find

324
00:12:44,380 --> 00:12:50,230
some way to get away get so evolved from

325
00:12:48,490 --> 00:12:51,610
this like gut feeling this is what I

326
00:12:50,230 --> 00:12:52,780
think I should do too

327
00:12:51,610 --> 00:12:55,420
so I think there's a little bit more

328
00:12:52,780 --> 00:12:56,740
principle right so the experiment here

329
00:12:55,420 --> 00:12:59,560
that I'm going to run you guys through

330
00:12:56,740 --> 00:13:02,260
through an example right is basically

331
00:12:59,560 --> 00:13:04,180
get all the IOC's that you have or all

332
00:13:02,260 --> 00:13:07,439
the of a subset of the IOC that you want

333
00:13:04,180 --> 00:13:09,489
right enrich them with whatever

334
00:13:07,440 --> 00:13:11,740
enrichment data you have available right

335
00:13:09,490 --> 00:13:13,540
so I give some examples there of things

336
00:13:11,740 --> 00:13:14,870
you can do to IP addresses and some

337
00:13:13,540 --> 00:13:16,579
things you can do

338
00:13:14,870 --> 00:13:19,310
domain names again we're focusing on

339
00:13:16,580 --> 00:13:23,089
network indicators for the specific

340
00:13:19,310 --> 00:13:25,520
exercise but if you were talking about

341
00:13:23,089 --> 00:13:29,410
endpoints malware artifacts right you

342
00:13:25,520 --> 00:13:33,529
might be interested in what mutex is a

343
00:13:29,410 --> 00:13:36,350
specific acceptable general create for

344
00:13:33,529 --> 00:13:37,640
registry keys they write which directly

345
00:13:36,350 --> 00:13:39,170
on the registry the right you know you

346
00:13:37,640 --> 00:13:40,939
can you can start to go crazy a little

347
00:13:39,170 --> 00:13:42,650
bit on that but you're trying to again

348
00:13:40,940 --> 00:13:45,230
finding points of commonality there

349
00:13:42,650 --> 00:13:49,250
where these things might aggregate right

350
00:13:45,230 --> 00:13:51,800
so there's a tool here that I wrote a

351
00:13:49,250 --> 00:13:53,779
couple of years ago right and exactly

352
00:13:51,800 --> 00:13:55,459
can help you gather some of the entries

353
00:13:53,779 --> 00:13:58,760
and enrich them right you can actually

354
00:13:55,460 --> 00:14:01,000
also get the passive DNS data on that if

355
00:13:58,760 --> 00:14:05,689
you have if you're a four-star customer

356
00:14:01,000 --> 00:14:07,790
so let's go let's talk about rig exploit

357
00:14:05,690 --> 00:14:10,850
kit which I'm pretty sure most of you

358
00:14:07,790 --> 00:14:13,339
are familiar with watch exploit kit do

359
00:14:10,850 --> 00:14:16,420
and the rig is a family there right so

360
00:14:13,339 --> 00:14:21,589
specifically this is a window on October

361
00:14:16,420 --> 00:14:24,579
20 last year 2016 right and I'm sticking

362
00:14:21,589 --> 00:14:29,390
out to specific these are domain

363
00:14:24,580 --> 00:14:33,260
registrant emails right from a sample of

364
00:14:29,390 --> 00:14:34,819
these October 2016 rigs right and I'm

365
00:14:33,260 --> 00:14:36,260
sticking out to because they have two

366
00:14:34,820 --> 00:14:38,060
different characteristics but I want you

367
00:14:36,260 --> 00:14:39,890
to figure out there's a small bit of

368
00:14:38,060 --> 00:14:43,819
concentration on these i/o sees that I

369
00:14:39,890 --> 00:14:45,680
had on one specific guy from Yandex mr.

370
00:14:43,820 --> 00:14:47,810
a I'm not going to try to pronounce the

371
00:14:45,680 --> 00:14:52,180
last name right and we have a little bit

372
00:14:47,810 --> 00:14:54,319
of 33 there on mr. Rob straw right so

373
00:14:52,180 --> 00:14:56,510
that's interesting I see some

374
00:14:54,320 --> 00:14:58,010
concentration there right so let's let's

375
00:14:56,510 --> 00:15:03,170
have a look at what these guys are doing

376
00:14:58,010 --> 00:15:05,270
so for mr. Robert cross seems to have

377
00:15:03,170 --> 00:15:07,370
been fallen victim to a domain shadowing

378
00:15:05,270 --> 00:15:08,900
attack right which is something again if

379
00:15:07,370 --> 00:15:11,830
you're not familiar it's the idea that

380
00:15:08,900 --> 00:15:14,680
someone compromised his registrar

381
00:15:11,830 --> 00:15:17,330
account specifically on GoDaddy and

382
00:15:14,680 --> 00:15:20,810
started registering subdomains under the

383
00:15:17,330 --> 00:15:24,620
domain that he owned and and then using

384
00:15:20,810 --> 00:15:26,329
that to to again put on landing pages

385
00:15:24,620 --> 00:15:27,380
that will try to deliver malware to you

386
00:15:26,329 --> 00:15:29,719
and it's

387
00:15:27,380 --> 00:15:34,280
sad story because it looks like this guy

388
00:15:29,720 --> 00:15:36,590
works making wedding pages right it's so

389
00:15:34,280 --> 00:15:38,480
like two names you see it's like

390
00:15:36,590 --> 00:15:40,490
such-and-such right that someone is

391
00:15:38,480 --> 00:15:43,220
hijacking these guys these guys like

392
00:15:40,490 --> 00:15:45,560
wedding webpage business to serve

393
00:15:43,220 --> 00:15:48,110
malware it's a truly truly sad story

394
00:15:45,560 --> 00:15:51,800
he's probably not even aware of it right

395
00:15:48,110 --> 00:15:54,050
or at least wasn't on on October 16 but

396
00:15:51,800 --> 00:15:56,060
you can see that probably if you went to

397
00:15:54,050 --> 00:15:58,310
a webpage that was registered by rob

398
00:15:56,060 --> 00:16:02,930
cross especially if you don't have many

399
00:15:58,310 --> 00:16:05,150
many friends who are married right that

400
00:16:02,930 --> 00:16:06,170
my it looks like more likely to have

401
00:16:05,150 --> 00:16:07,520
been something that was serving

402
00:16:06,170 --> 00:16:09,380
self-immolations than actually something

403
00:16:07,520 --> 00:16:13,130
legitimate so this is something that we

404
00:16:09,380 --> 00:16:16,750
might want to keep track of right the

405
00:16:13,130 --> 00:16:20,480
other example that we had was

406
00:16:16,750 --> 00:16:23,150
specifically the endeth folks right the

407
00:16:20,480 --> 00:16:25,400
yellow guy and we're talking about this

408
00:16:23,150 --> 00:16:27,260
looks much more clearly like he was

409
00:16:25,400 --> 00:16:29,870
registering those domains for use right

410
00:16:27,260 --> 00:16:31,850
and then you could think about oh so

411
00:16:29,870 --> 00:16:34,100
maybe a good strategy would be oh I'm

412
00:16:31,850 --> 00:16:37,130
gonna get this domain I'm going to find

413
00:16:34,100 --> 00:16:38,990
all the other domains and that this guy

414
00:16:37,130 --> 00:16:41,240
has and I'm just going to block this

415
00:16:38,990 --> 00:16:43,880
right but again if you remember from

416
00:16:41,240 --> 00:16:47,450
from this example right you're probably

417
00:16:43,880 --> 00:16:50,750
killing Rob crosses legitimate business

418
00:16:47,450 --> 00:16:52,760
right there right so that might sound

419
00:16:50,750 --> 00:16:54,710
like a good strategy but it's not a good

420
00:16:52,760 --> 00:16:56,330
strategy on the long run and I'll give

421
00:16:54,710 --> 00:16:57,680
you some other examples or these what

422
00:16:56,330 --> 00:16:59,690
you can try to figure out these

423
00:16:57,680 --> 00:17:01,370
aggregations where maybe just figuring

424
00:16:59,690 --> 00:17:01,880
out although with something bad about

425
00:17:01,370 --> 00:17:03,320
this

426
00:17:01,880 --> 00:17:07,760
so I maybe I should block it it's not

427
00:17:03,320 --> 00:17:10,430
the best possible scenario right so just

428
00:17:07,760 --> 00:17:13,220
just to give you the the Associated

429
00:17:10,430 --> 00:17:14,840
example we can do the same thing for AP

430
00:17:13,220 --> 00:17:17,300
addresses right this is specifically

431
00:17:14,839 --> 00:17:19,099
autonomous systems right we see 80 grad

432
00:17:17,300 --> 00:17:21,079
with an interesting concentration there

433
00:17:19,099 --> 00:17:24,079
and this is again this is the same data

434
00:17:21,079 --> 00:17:26,720
source and of course Russia right and

435
00:17:24,079 --> 00:17:28,790
I'm not trying to pick on Russia or my

436
00:17:26,720 --> 00:17:29,330
kaspersky friends we are not here

437
00:17:28,790 --> 00:17:33,740
anymore

438
00:17:29,330 --> 00:17:37,429
so the point being that you see some

439
00:17:33,740 --> 00:17:40,270
concentration right you see that you're

440
00:17:37,430 --> 00:17:42,910
actually learning something about how

441
00:17:40,270 --> 00:17:45,250
many of these bad samples of data that I

442
00:17:42,910 --> 00:17:48,460
have are specifically positioned on on

443
00:17:45,250 --> 00:17:51,550
certain different places right so if we

444
00:17:48,460 --> 00:17:54,240
try to aggregate this data maybe we can

445
00:17:51,550 --> 00:17:58,300
try to get a score we can try to get a

446
00:17:54,240 --> 00:18:01,870
bigger view of which one of those places

447
00:17:58,300 --> 00:18:03,550
which one of those potential pivoting

448
00:18:01,870 --> 00:18:05,350
points are more risky for my

449
00:18:03,550 --> 00:18:08,050
organization or not right so

450
00:18:05,350 --> 00:18:13,540
specifically they're right when I'm just

451
00:18:08,050 --> 00:18:16,659
totaling the ones the rig the rig I will

452
00:18:13,540 --> 00:18:18,850
see that I have on the domain on the

453
00:18:16,660 --> 00:18:21,160
registrant emails right we're talking

454
00:18:18,850 --> 00:18:23,020
about this guy Steven Malone was very

455
00:18:21,160 --> 00:18:26,230
very prominent who have rig at the time

456
00:18:23,020 --> 00:18:28,210
these are so just quick fun note this

457
00:18:26,230 --> 00:18:30,490
same domain now it's actually being very

458
00:18:28,210 --> 00:18:32,950
active on registering sundown domains

459
00:18:30,490 --> 00:18:35,920
right they sometimes they use they

460
00:18:32,950 --> 00:18:37,660
change their their the actual tool kit

461
00:18:35,920 --> 00:18:41,440
they're using but this is actually the

462
00:18:37,660 --> 00:18:43,330
same probably the same actor right so

463
00:18:41,440 --> 00:18:45,700
you can start to think well if anything

464
00:18:43,330 --> 00:18:48,520
is above 40 there maybe I just want to

465
00:18:45,700 --> 00:18:51,850
to block it right or but you see our

466
00:18:48,520 --> 00:18:53,710
Yandex guys right there on on 15 so

467
00:18:51,850 --> 00:18:55,750
maybe just the numbers are not great

468
00:18:53,710 --> 00:18:57,850
right even though when you look at the

469
00:18:55,750 --> 00:19:02,770
eighth numbers right the first one is

470
00:18:57,850 --> 00:19:05,679
OVH again OVH is not the best because

471
00:19:02,770 --> 00:19:06,970
it's very easy to sign up for for an IP

472
00:19:05,680 --> 00:19:08,800
address there but there's a lot of

473
00:19:06,970 --> 00:19:10,480
legitimate stuff going on there right I

474
00:19:08,800 --> 00:19:11,800
don't care about I probably don't care

475
00:19:10,480 --> 00:19:14,140
about kinks servers which is a

476
00:19:11,800 --> 00:19:15,790
notoriously bulletproofing hosting a

477
00:19:14,140 --> 00:19:17,680
place I don't probably don't care about

478
00:19:15,790 --> 00:19:20,440
IT grad unless I have legitimate

479
00:19:17,680 --> 00:19:23,290
business in Russia but I can't really

480
00:19:20,440 --> 00:19:26,380
shut down OVH right it's it's a hard

481
00:19:23,290 --> 00:19:30,210
call right but maybe if I get enough

482
00:19:26,380 --> 00:19:32,920
signals from each one of those

483
00:19:30,210 --> 00:19:34,780
connectors right each one of those how

484
00:19:32,920 --> 00:19:36,670
many bad stuff continue on those from

485
00:19:34,780 --> 00:19:38,950
those things in aggregate maybe it can

486
00:19:36,670 --> 00:19:40,780
go further to make a decision right and

487
00:19:38,950 --> 00:19:44,560
this is of course the more extreme

488
00:19:40,780 --> 00:19:46,210
example from the from those rig things

489
00:19:44,560 --> 00:19:48,669
which is when you're talking about

490
00:19:46,210 --> 00:19:50,830
what's the top-level domain right you

491
00:19:48,670 --> 00:19:52,520
don't want to block comm you don't want

492
00:19:50,830 --> 00:19:54,889
to block or your career

493
00:19:52,520 --> 00:19:57,530
an instant responder or will be very

494
00:19:54,890 --> 00:20:00,080
very short if you just block calm on

495
00:19:57,530 --> 00:20:02,780
your organization but it's undoubtably

496
00:20:00,080 --> 00:20:05,449
the one that has the most rig right but

497
00:20:02,780 --> 00:20:07,428
why do we extraction years right and

498
00:20:05,450 --> 00:20:09,559
every one of the room you can't block

499
00:20:07,429 --> 00:20:11,690
calm why do we know that why is this

500
00:20:09,559 --> 00:20:14,149
something that's really encoded in our

501
00:20:11,690 --> 00:20:16,910
mind it's because we know that well

502
00:20:14,150 --> 00:20:19,790
there's some okay sing sing calm Doctore

503
00:20:16,910 --> 00:20:23,059
actually it's like overwhelmingly okay

504
00:20:19,790 --> 00:20:26,629
to do to calm and dark as opposed to

505
00:20:23,059 --> 00:20:29,860
going to dog gops or dot X Y Z's right

506
00:20:26,630 --> 00:20:32,840
so this is the first equation of the day

507
00:20:29,860 --> 00:20:34,070
which again guys don't be scared this is

508
00:20:32,840 --> 00:20:37,850
very simple right

509
00:20:34,070 --> 00:20:40,280
I'm just doing a vision there I'm just

510
00:20:37,850 --> 00:20:44,110
trying to figure out given my knowledge

511
00:20:40,280 --> 00:20:44,110
right and again this is very some

512
00:20:44,260 --> 00:20:49,670
analyst analyst organization

513
00:20:46,429 --> 00:20:52,490
organization right how much bad stuff I

514
00:20:49,670 --> 00:20:54,380
know about this specific pivoting point

515
00:20:52,490 --> 00:20:57,679
and when I say pivoting point you think

516
00:20:54,380 --> 00:20:59,840
I'm grouping on a s I'm grouping on who

517
00:20:57,679 --> 00:21:01,730
is registrant or register or or all the

518
00:20:59,840 --> 00:21:03,559
things imagine all those that we talked

519
00:21:01,730 --> 00:21:05,590
and on a feels like that so how much of

520
00:21:03,559 --> 00:21:08,210
it is that what's the percentage of bad

521
00:21:05,590 --> 00:21:10,639
versus the percentage of good that I

522
00:21:08,210 --> 00:21:15,530
know about right so you can try to

523
00:21:10,640 --> 00:21:17,600
create a good feeling of again what this

524
00:21:15,530 --> 00:21:19,100
good look like what does a good pivoting

525
00:21:17,600 --> 00:21:21,050
point what does a bad pivoting point

526
00:21:19,100 --> 00:21:23,360
look like and of course some people will

527
00:21:21,050 --> 00:21:25,700
wait good places whether I buy a seed

528
00:21:23,360 --> 00:21:27,379
from that you actually don't right I

529
00:21:25,700 --> 00:21:29,390
definitely don't recommend you getting

530
00:21:27,380 --> 00:21:33,260
elects or 1 million and treating that is

531
00:21:29,390 --> 00:21:34,580
good but there's actually a lot of data

532
00:21:33,260 --> 00:21:37,160
that you can gather from your own

533
00:21:34,580 --> 00:21:40,010
telemetry as a company to try to figure

534
00:21:37,160 --> 00:21:41,210
out things that are should probably be

535
00:21:40,010 --> 00:21:44,150
considered normal

536
00:21:41,210 --> 00:21:45,860
so people who know my machine learning

537
00:21:44,150 --> 00:21:49,130
work knows that I'm very very negative

538
00:21:45,860 --> 00:21:50,899
about anomaly detection and all these

539
00:21:49,130 --> 00:21:52,670
you be a kind of things because if

540
00:21:50,900 --> 00:21:55,550
something is rare it doesn't mean that

541
00:21:52,670 --> 00:21:58,420
it's bad right and we spend a lot of

542
00:21:55,550 --> 00:22:01,970
time looking for rare and when actually

543
00:21:58,420 --> 00:22:04,400
again it's most probably just a waste of

544
00:22:01,970 --> 00:22:05,669
time but the covert is usually true

545
00:22:04,400 --> 00:22:07,579
because the

546
00:22:05,669 --> 00:22:14,459
there's such an overwhelmingly

547
00:22:07,579 --> 00:22:16,619
overwhelmingly number of normal or they

548
00:22:14,459 --> 00:22:18,119
are not or benign communications in an

549
00:22:16,619 --> 00:22:20,309
Asterix versus things that are

550
00:22:18,119 --> 00:22:22,439
particularly bad so if something is very

551
00:22:20,309 --> 00:22:24,779
frequent the likelihood that it's

552
00:22:22,440 --> 00:22:27,509
actually not malicious is pretty

553
00:22:24,779 --> 00:22:29,759
reasonable right so we can try to work

554
00:22:27,509 --> 00:22:32,009
on those things again be careful you can

555
00:22:29,759 --> 00:22:34,619
get shallow scoops from whitelist right

556
00:22:32,009 --> 00:22:37,079
but it's again if you're sitting on the

557
00:22:34,619 --> 00:22:39,418
analysts chair right as a human being

558
00:22:37,079 --> 00:22:41,489
you usually know what's normal in your

559
00:22:39,419 --> 00:22:43,919
company or not and this is encoded on

560
00:22:41,489 --> 00:22:45,179
you having exposure to people doing

561
00:22:43,919 --> 00:22:47,519
things in your network so there's

562
00:22:45,179 --> 00:22:49,979
definitely some mix here that you can

563
00:22:47,519 --> 00:22:51,629
find that will will work for you and

564
00:22:49,979 --> 00:22:53,549
then you're going to be able to compare

565
00:22:51,629 --> 00:22:54,928
what's good and what's bad for your

566
00:22:53,549 --> 00:22:58,259
specific organization on a specific

567
00:22:54,929 --> 00:23:00,209
period of time so when we apply that

568
00:22:58,259 --> 00:23:02,299
formula to those examples that we're

569
00:23:00,209 --> 00:23:06,029
talking about we can start to see where

570
00:23:02,299 --> 00:23:09,959
the applications and these ideas they

571
00:23:06,029 --> 00:23:11,789
start to make sense so IT grab you're

572
00:23:09,959 --> 00:23:14,549
actually looking at and this again was a

573
00:23:11,789 --> 00:23:18,658
specific day on a specific group of

574
00:23:14,549 --> 00:23:20,489
customers that we have right only 87% of

575
00:23:18,659 --> 00:23:23,489
the data that we had coming from IT grad

576
00:23:20,489 --> 00:23:25,169
was recognizably bad as opposed to stuff

577
00:23:23,489 --> 00:23:27,329
that we had records naturally good and

578
00:23:25,169 --> 00:23:29,820
wow that's a pretty large number so yeah

579
00:23:27,329 --> 00:23:32,999
maybe I should consider blocking it but

580
00:23:29,820 --> 00:23:37,700
it looks even worse when you compare the

581
00:23:32,999 --> 00:23:40,589
87% to the 0.6 percent of maliciousness

582
00:23:37,700 --> 00:23:42,359
across all the different a SS that the

583
00:23:40,589 --> 00:23:45,839
these specific group of customers went

584
00:23:42,359 --> 00:23:47,968
to so the idea is on if they went to an

585
00:23:45,839 --> 00:23:51,418
average a SN and I know that sounds

586
00:23:47,969 --> 00:23:53,700
weird but if you just pick a a log a log

587
00:23:51,419 --> 00:23:55,709
entry at random and look at the IP

588
00:23:53,700 --> 00:23:58,979
address they went to it was only there's

589
00:23:55,709 --> 00:24:02,459
only like a 0.6 percentage of chance

590
00:23:58,979 --> 00:24:04,559
that that is that the the place that

591
00:24:02,459 --> 00:24:06,450
we're going to on that a s was bad right

592
00:24:04,559 --> 00:24:08,369
so when you compare those numbers it's

593
00:24:06,450 --> 00:24:11,190
very striking there's a huge difference

594
00:24:08,369 --> 00:24:13,079
between what is the expected

595
00:24:11,190 --> 00:24:17,879
maliciousness and I hope I'm not losing

596
00:24:13,079 --> 00:24:19,250
the audience here right against it what

597
00:24:17,879 --> 00:24:21,649
isn't normal

598
00:24:19,250 --> 00:24:24,980
right a s for them right when you go to

599
00:24:21,650 --> 00:24:27,320
country and you go to TLD right it

600
00:24:24,980 --> 00:24:30,050
becomes clear that actually this

601
00:24:27,320 --> 00:24:33,230
difference between what's usual in the

602
00:24:30,050 --> 00:24:36,740
environment and how bad the specific

603
00:24:33,230 --> 00:24:38,720
place I'm going to write to tell me if

604
00:24:36,740 --> 00:24:41,150
my gut feeling is going to is going to

605
00:24:38,720 --> 00:24:43,430
fire too I should be blocking this or

606
00:24:41,150 --> 00:24:46,160
not so you see that the dot or TLD is

607
00:24:43,430 --> 00:24:49,040
only two point nine percent bad stuff

608
00:24:46,160 --> 00:24:50,840
right but the average TLD is one point

609
00:24:49,040 --> 00:24:52,850
nine so it's pretty much even it's

610
00:24:50,840 --> 00:24:57,530
pretty much it's not much more than it's

611
00:24:52,850 --> 00:25:01,010
not even double right so one important

612
00:24:57,530 --> 00:25:03,379
thing here is if you have some very big

613
00:25:01,010 --> 00:25:05,390
outliers so something comes to you it's

614
00:25:03,380 --> 00:25:07,730
very very malicious right

615
00:25:05,390 --> 00:25:10,310
oh this like this has a confidence 100

616
00:25:07,730 --> 00:25:13,160
from my seed and then all the data that

617
00:25:10,310 --> 00:25:15,790
you look at as the AF is from who

618
00:25:13,160 --> 00:25:18,320
register there it all looks very low

619
00:25:15,790 --> 00:25:20,899
that's usually a very clear sign that

620
00:25:18,320 --> 00:25:24,169
that thing that you just ingested right

621
00:25:20,900 --> 00:25:28,310
there is a false positive okay from the

622
00:25:24,170 --> 00:25:30,920
scene so let me just get what we were

623
00:25:28,310 --> 00:25:34,429
talking here on this slide the idea that

624
00:25:30,920 --> 00:25:38,260
actually the ratio between how much this

625
00:25:34,430 --> 00:25:40,820
specific place and visiting under the

626
00:25:38,260 --> 00:25:42,740
overall ratio of all the things that's

627
00:25:40,820 --> 00:25:44,300
the number that matter right so I'm

628
00:25:42,740 --> 00:25:46,610
going to throw a slightly more

629
00:25:44,300 --> 00:25:48,800
complicated equation here right the only

630
00:25:46,610 --> 00:25:50,750
thing I'm talking about is that on the

631
00:25:48,800 --> 00:25:54,860
on the bottom there it's the sum of all

632
00:25:50,750 --> 00:25:56,240
DA asses or all the registrar's or all

633
00:25:54,860 --> 00:25:58,760
the different things so for each

634
00:25:56,240 --> 00:26:00,410
different PP which is a pivoting point

635
00:25:58,760 --> 00:26:02,870
everything that slide is telling you is

636
00:26:00,410 --> 00:26:04,580
what I was totally telling you on the

637
00:26:02,870 --> 00:26:07,250
when we were the others you had the

638
00:26:04,580 --> 00:26:08,929
other slide up with the example so no

639
00:26:07,250 --> 00:26:11,480
need to be afraid of this line I just

640
00:26:08,930 --> 00:26:13,790
want to have things written down because

641
00:26:11,480 --> 00:26:15,740
it people want to try to reproduce this

642
00:26:13,790 --> 00:26:17,570
is much more precise than me just

643
00:26:15,740 --> 00:26:22,790
blabbing about and and waving my arms

644
00:26:17,570 --> 00:26:25,010
right so what I so here are some

645
00:26:22,790 --> 00:26:28,810
interesting characteristics of these of

646
00:26:25,010 --> 00:26:30,700
these the idea of this rating right so

647
00:26:28,810 --> 00:26:35,240
this is

648
00:26:30,700 --> 00:26:40,400
actually a log graph this is a log 10

649
00:26:35,240 --> 00:26:43,970
graph right so this is me looking at for

650
00:26:40,400 --> 00:26:45,650
a specific a SN out of almost 9 million

651
00:26:43,970 --> 00:26:49,340
observations from different customers

652
00:26:45,650 --> 00:26:51,590
that we have how many a SN sigh how many

653
00:26:49,340 --> 00:26:54,379
communications I had which had an ASM

654
00:26:51,590 --> 00:27:00,020
with a malicious rating zero or very

655
00:26:54,380 --> 00:27:01,760
close to zero up to 200 150 ish which

656
00:27:00,020 --> 00:27:03,559
was the highest number we got for that

657
00:27:01,760 --> 00:27:06,379
period of time right when I'm telling

658
00:27:03,559 --> 00:27:08,450
you this is a log graph which means that

659
00:27:06,380 --> 00:27:11,120
this is actually you see it went from

660
00:27:08,450 --> 00:27:13,340
ten to a thousand to ten thousand to ten

661
00:27:11,120 --> 00:27:15,500
million right if I was to plot this on a

662
00:27:13,340 --> 00:27:18,678
normal scale you would only see one

663
00:27:15,500 --> 00:27:20,630
graph or one bar here and everything

664
00:27:18,679 --> 00:27:22,550
would be very very very close down right

665
00:27:20,630 --> 00:27:24,770
when you you have one of those graphs

666
00:27:22,550 --> 00:27:26,990
which is a log graph and it kind of

667
00:27:24,770 --> 00:27:30,139
looks like it wants to do a slope here

668
00:27:26,990 --> 00:27:33,020
it means that this is a very very long

669
00:27:30,140 --> 00:27:33,410
tail which is kind of what we're looking

670
00:27:33,020 --> 00:27:36,230
for

671
00:27:33,410 --> 00:27:38,780
right we know that the vast majority of

672
00:27:36,230 --> 00:27:41,480
places that people go to are benign or

673
00:27:38,780 --> 00:27:44,320
should be benign right so if we're

674
00:27:41,480 --> 00:27:48,200
creating some metrics to try to again a

675
00:27:44,320 --> 00:27:50,540
open our understanding of something as

676
00:27:48,200 --> 00:27:52,460
malicious or not it has to respect those

677
00:27:50,540 --> 00:27:55,280
characteristics of what actually happens

678
00:27:52,460 --> 00:27:58,340
in real life right we have a spike at

679
00:27:55,280 --> 00:28:00,290
the end there usually it's usually an

680
00:27:58,340 --> 00:28:02,270
artifact of those calculations is like

681
00:28:00,290 --> 00:28:05,000
it's a place we only heard about bad

682
00:28:02,270 --> 00:28:07,220
things so that usually a spike at the

683
00:28:05,000 --> 00:28:09,590
end right which accounts for sometimes

684
00:28:07,220 --> 00:28:12,620
are incomplete information I'm sure I'm

685
00:28:09,590 --> 00:28:14,928
sure there are a SS which are 100% bad

686
00:28:12,620 --> 00:28:16,610
but that number shouldn't be - large

687
00:28:14,929 --> 00:28:18,650
it's just that maybe because we're not

688
00:28:16,610 --> 00:28:20,059
we don't there's not enough coverage

689
00:28:18,650 --> 00:28:21,350
from the customer the customer has never

690
00:28:20,059 --> 00:28:24,200
gone to a legitimate place on the

691
00:28:21,350 --> 00:28:26,080
specific AF we can't really know if

692
00:28:24,200 --> 00:28:28,970
there are good things there there's no

693
00:28:26,080 --> 00:28:31,699
actual evidence of that right and the

694
00:28:28,970 --> 00:28:33,110
other example is TLD right so it's

695
00:28:31,700 --> 00:28:35,300
pretty much tell me the same story but

696
00:28:33,110 --> 00:28:37,760
from different perspective see this hole

697
00:28:35,300 --> 00:28:40,040
right from different kinds of pivoting

698
00:28:37,760 --> 00:28:41,960
points again I haven't solved a few

699
00:28:40,040 --> 00:28:42,830
problems here I've gave you some more

700
00:28:41,960 --> 00:28:44,960
things to measure

701
00:28:42,830 --> 00:28:48,439
that we're probably going to be more

702
00:28:44,960 --> 00:28:49,940
helpful to understand I mean what kind

703
00:28:48,440 --> 00:28:51,860
of knowledge or what kind of value

704
00:28:49,940 --> 00:28:54,409
potentially get it from getting those

705
00:28:51,860 --> 00:28:55,969
feeds in but what are the cutting scores

706
00:28:54,409 --> 00:28:59,149
should I have a cutting score if

707
00:28:55,970 --> 00:29:02,480
something is above act I should block it

708
00:28:59,149 --> 00:29:04,219
do I need should I get multiple pivoting

709
00:29:02,480 --> 00:29:05,779
points and look at multiple pivoting

710
00:29:04,220 --> 00:29:06,620
points and then have a combined score

711
00:29:05,779 --> 00:29:08,840
between them

712
00:29:06,620 --> 00:29:10,610
what's the way what are the ways that

713
00:29:08,840 --> 00:29:12,769
should be doing that and again this is a

714
00:29:10,610 --> 00:29:16,580
very very hard question to answer answer

715
00:29:12,769 --> 00:29:18,470
manually right as in there is probably

716
00:29:16,580 --> 00:29:21,110
for each organization there's a

717
00:29:18,470 --> 00:29:23,059
different sense of how much risk they

718
00:29:21,110 --> 00:29:24,559
want to have how much they'd rather have

719
00:29:23,059 --> 00:29:28,190
a false positive than a false negative

720
00:29:24,559 --> 00:29:30,678
right or how much I should feed the

721
00:29:28,190 --> 00:29:33,679
whitelist or not so there's a there are

722
00:29:30,679 --> 00:29:35,360
some challenges with again finding out

723
00:29:33,679 --> 00:29:39,380
what the right makes on the right ways

724
00:29:35,360 --> 00:29:41,539
are to actually implement this but it

725
00:29:39,380 --> 00:29:43,610
would still be an interesting visual way

726
00:29:41,539 --> 00:29:46,429
when you're trying to enrich when you

727
00:29:43,610 --> 00:29:48,168
are trying to understand from a specific

728
00:29:46,429 --> 00:29:51,080
IP address what those things are so

729
00:29:48,169 --> 00:29:53,330
let's imagine that we had something

730
00:29:51,080 --> 00:29:55,010
magical that was actually able to solve

731
00:29:53,330 --> 00:29:57,500
all these challenges of manually

732
00:29:55,010 --> 00:30:00,260
choosing ways and creating things that

733
00:29:57,500 --> 00:30:04,460
are very very yeah this is a dessert

734
00:30:00,260 --> 00:30:05,720
this is amazing that creates that would

735
00:30:04,460 --> 00:30:08,179
actually be able to create different

736
00:30:05,720 --> 00:30:12,740
ways and different things like I don't

737
00:30:08,179 --> 00:30:14,659
know machine learning right so you would

738
00:30:12,740 --> 00:30:16,730
probably get something like this this

739
00:30:14,659 --> 00:30:18,649
would be an actual example of things

740
00:30:16,730 --> 00:30:21,559
that you would be able to see right

741
00:30:18,649 --> 00:30:24,379
you're talking about a specific customer

742
00:30:21,559 --> 00:30:26,840
a specific environment where you know

743
00:30:24,380 --> 00:30:28,519
that one thing is bad you have actual

744
00:30:26,840 --> 00:30:30,559
information from one of the domains

745
00:30:28,519 --> 00:30:32,750
right and then the system is able to

746
00:30:30,559 --> 00:30:36,408
place that there are relationships from

747
00:30:32,750 --> 00:30:39,049
specific AFS or specific BGP prefixes on

748
00:30:36,409 --> 00:30:40,850
own specific name servers right and

749
00:30:39,049 --> 00:30:42,620
again expand this knowledge and find

750
00:30:40,850 --> 00:30:44,209
other things that are potentially

751
00:30:42,620 --> 00:30:47,418
related to the same campaign

752
00:30:44,210 --> 00:30:50,029
automatically right without actually

753
00:30:47,419 --> 00:30:52,190
having to have those entries there right

754
00:30:50,029 --> 00:30:54,470
on this specific example of course using

755
00:30:52,190 --> 00:30:55,650
the same IP address was determinant but

756
00:30:54,470 --> 00:30:58,770
was also determinant

757
00:30:55,650 --> 00:31:01,470
who is you see there who is nameservers

758
00:30:58,770 --> 00:31:03,150
have a very high kind of tag right

759
00:31:01,470 --> 00:31:05,220
because it was actually the same the guy

760
00:31:03,150 --> 00:31:07,350
was registering those domains right

761
00:31:05,220 --> 00:31:10,170
which again visually they kind of seem

762
00:31:07,350 --> 00:31:11,879
similar but that wasn't that really

763
00:31:10,170 --> 00:31:13,320
wasn't what what's cost and what caught

764
00:31:11,880 --> 00:31:15,810
them was the fact that they were using

765
00:31:13,320 --> 00:31:18,960
this right so several different layers

766
00:31:15,810 --> 00:31:21,330
several different places so China is

767
00:31:18,960 --> 00:31:24,030
very proud because he did this magic and

768
00:31:21,330 --> 00:31:26,040
we have something to show so I just want

769
00:31:24,030 --> 00:31:27,480
to leave you guys with another idea

770
00:31:26,040 --> 00:31:30,870
right it's one thing that I've been

771
00:31:27,480 --> 00:31:32,400
working on and I think it's almost there

772
00:31:30,870 --> 00:31:34,739
but it's something that I want to share

773
00:31:32,400 --> 00:31:37,230
with you because it ties into the the

774
00:31:34,740 --> 00:31:39,720
threat intelligence Reese research that

775
00:31:37,230 --> 00:31:40,950
I've been doing and I mean this is the

776
00:31:39,720 --> 00:31:43,580
perfect audience I would love to hear

777
00:31:40,950 --> 00:31:47,850
your feedback on this static ideas right

778
00:31:43,580 --> 00:31:50,429
so the biggest criticism that I had when

779
00:31:47,850 --> 00:31:52,320
I did the Chi IQ test research right

780
00:31:50,430 --> 00:31:53,700
which was again the idea that you could

781
00:31:52,320 --> 00:31:55,889
compare different feeds amongst each

782
00:31:53,700 --> 00:31:57,660
other and the figure out what's the

783
00:31:55,890 --> 00:31:59,520
overlap and all those pieces are like

784
00:31:57,660 --> 00:32:01,530
okay it's all fine and good I can

785
00:31:59,520 --> 00:32:04,889
compare it to another but what's the

786
00:32:01,530 --> 00:32:07,889
best feed right can I score feed can I

787
00:32:04,890 --> 00:32:10,200
put a number to it right which one you

788
00:32:07,890 --> 00:32:12,960
know which ones are the best right and

789
00:32:10,200 --> 00:32:14,490
again good best are very very loaded

790
00:32:12,960 --> 00:32:17,670
words I think the best we can

791
00:32:14,490 --> 00:32:19,980
potentially do right is to figure out if

792
00:32:17,670 --> 00:32:21,780
something is applicable for you right if

793
00:32:19,980 --> 00:32:24,210
you are on the camel side of the house

794
00:32:21,780 --> 00:32:25,920
it's probably some it's actionable Intel

795
00:32:24,210 --> 00:32:29,790
for you right

796
00:32:25,920 --> 00:32:32,520
but with Kalama tree which was something

797
00:32:29,790 --> 00:32:34,800
that I didn't have a lot of when I first

798
00:32:32,520 --> 00:32:37,440
got started on the ideas of objects you

799
00:32:34,800 --> 00:32:40,830
test you can try to approximate what

800
00:32:37,440 --> 00:32:42,690
actionable or what's good or fit for

801
00:32:40,830 --> 00:32:44,669
purpose it looks like in your

802
00:32:42,690 --> 00:32:47,820
environment so I'm going to show you a

803
00:32:44,670 --> 00:32:50,070
few concepts a few ideas don't read too

804
00:32:47,820 --> 00:32:52,470
much into them because they are again

805
00:32:50,070 --> 00:32:54,990
they are from a specific example so I'm

806
00:32:52,470 --> 00:32:58,200
not trying to bash any seeds but it's

807
00:32:54,990 --> 00:33:00,660
specifically here but one thing that I

808
00:32:58,200 --> 00:33:03,570
think it's super relevant if you're

809
00:33:00,660 --> 00:33:05,960
trying to measure what is the value of

810
00:33:03,570 --> 00:33:08,379
the specific feed in your organization

811
00:33:05,960 --> 00:33:10,570
what is the allure

812
00:33:08,380 --> 00:33:13,059
accounting that you have which i mean by

813
00:33:10,570 --> 00:33:15,820
that is let's assume you will learn all

814
00:33:13,059 --> 00:33:18,190
these IOC matches right you have if they

815
00:33:15,820 --> 00:33:21,220
went to somebody's trash holder

816
00:33:18,190 --> 00:33:23,259
somewhere right but which one of the

817
00:33:21,220 --> 00:33:27,340
alerts that came from specific thieves

818
00:33:23,259 --> 00:33:29,799
actually translated to to actual

819
00:33:27,340 --> 00:33:33,009
incidents or actual things that your

820
00:33:29,799 --> 00:33:35,980
team they deemed that they should

821
00:33:33,009 --> 00:33:37,840
investigate right so the reason why I

822
00:33:35,980 --> 00:33:39,940
can do this calculations very precisely

823
00:33:37,840 --> 00:33:43,029
is because I'm cheating in the sense

824
00:33:39,940 --> 00:33:46,259
that what I'm considering to be a right

825
00:33:43,029 --> 00:33:49,509
match what I'm considering to be a

826
00:33:46,259 --> 00:33:52,240
actual incident it's something that my

827
00:33:49,509 --> 00:33:53,860
research and the our tool actually

828
00:33:52,240 --> 00:33:56,200
flagged as an instant so it's a little

829
00:33:53,860 --> 00:33:58,629
bit self-serving right so I'm not saying

830
00:33:56,200 --> 00:34:00,909
that that's the measure you should

831
00:33:58,629 --> 00:34:03,519
necessarily be using but it's a good way

832
00:34:00,909 --> 00:34:06,789
for you to understand as in how much

833
00:34:03,519 --> 00:34:08,679
this specific feed is feeding me things

834
00:34:06,789 --> 00:34:10,629
that don't matter for me versus thing

835
00:34:08,679 --> 00:34:12,940
that actually makes sense

836
00:34:10,629 --> 00:34:15,098
it actually helped my investigation

837
00:34:12,940 --> 00:34:18,940
going forward and even more importantly

838
00:34:15,099 --> 00:34:22,149
what's the unique percentage of those so

839
00:34:18,940 --> 00:34:24,790
how many feeds how many how much data I

840
00:34:22,149 --> 00:34:27,399
got from that dis feed and all we did

841
00:34:24,790 --> 00:34:29,409
see that was determinants for me in

842
00:34:27,399 --> 00:34:31,598
uncovering a potential incident or

843
00:34:29,409 --> 00:34:34,149
uncovering a breach inside my network so

844
00:34:31,599 --> 00:34:35,800
specifically on that is on that one so

845
00:34:34,149 --> 00:34:38,199
you guys are probably familiar with the

846
00:34:35,800 --> 00:34:40,000
abuse eh series right they have a bunch

847
00:34:38,199 --> 00:34:41,589
of different trackers so on this

848
00:34:40,000 --> 00:34:43,449
specific example again put the slice of

849
00:34:41,589 --> 00:34:45,489
time over several different customers a

850
00:34:43,449 --> 00:34:47,918
hundred percent of the things that were

851
00:34:45,489 --> 00:34:52,000
uniquely contributed by the field Oh

852
00:34:47,918 --> 00:34:55,020
tracker which is usually dried ax or say

853
00:34:52,000 --> 00:34:57,730
dating double don't rake bought recently

854
00:34:55,020 --> 00:34:59,920
were actually only from them and what

855
00:34:57,730 --> 00:35:01,930
determinants were confirmed as a saying

856
00:34:59,920 --> 00:35:04,599
so these are some ideas for you guys to

857
00:35:01,930 --> 00:35:07,960
play with as far as the use and the

858
00:35:04,599 --> 00:35:10,960
utility and this is something um I am

859
00:35:07,960 --> 00:35:13,599
again attempting to codify to a score

860
00:35:10,960 --> 00:35:16,000
and it's simply that's probably later

861
00:35:13,599 --> 00:35:17,619
this year I should have a different

862
00:35:16,000 --> 00:35:19,060
presentation around this but this is

863
00:35:17,619 --> 00:35:20,960
something that I definitely want your

864
00:35:19,060 --> 00:35:23,180
input if you have tried to do this

865
00:35:20,960 --> 00:35:27,170
and it is if you think those techniques

866
00:35:23,180 --> 00:35:31,669
or are interesting so again the main

867
00:35:27,170 --> 00:35:32,150
problem here right is what is a valid

868
00:35:31,670 --> 00:35:34,220
alert

869
00:35:32,150 --> 00:35:35,690
what is the valid incident right and

870
00:35:34,220 --> 00:35:37,279
again this will come from your IR

871
00:35:35,690 --> 00:35:38,450
process more often than not this is

872
00:35:37,280 --> 00:35:41,839
definitely something that I cannot

873
00:35:38,450 --> 00:35:45,109
advise you advise you with right so

874
00:35:41,839 --> 00:35:46,910
again if you do the your IR you got some

875
00:35:45,109 --> 00:35:48,560
things you can search on if you do

876
00:35:46,910 --> 00:35:50,598
actual threat intelligence generator

877
00:35:48,560 --> 00:35:53,029
this generation this is also something

878
00:35:50,599 --> 00:35:54,950
that we can check on so and I have to

879
00:35:53,030 --> 00:35:56,330
mention Rick's work on my present

880
00:35:54,950 --> 00:35:59,450
telogen speeds your threat intelligence

881
00:35:56,330 --> 00:36:01,339
right the number is not the amount of

882
00:35:59,450 --> 00:36:03,980
stuff that you have is really how much

883
00:36:01,339 --> 00:36:06,140
of this was useful so and again there's

884
00:36:03,980 --> 00:36:08,150
a lot of challenges sadly there's no

885
00:36:06,140 --> 00:36:10,279
magic this time you actually have to

886
00:36:08,150 --> 00:36:14,060
improve your our processes in order to

887
00:36:10,280 --> 00:36:16,190
have this thing to compare but anyway

888
00:36:14,060 --> 00:36:17,869
it's an interesting idea that I want you

889
00:36:16,190 --> 00:36:21,740
guys to I'll be interested to see what

890
00:36:17,869 --> 00:36:23,540
your experiences with this are so anyway

891
00:36:21,740 --> 00:36:26,720
I just want to leave you with the idea

892
00:36:23,540 --> 00:36:29,540
that and I'm pretty sure this is the

893
00:36:26,720 --> 00:36:32,750
wrong room to say that this is something

894
00:36:29,540 --> 00:36:35,420
that you guys already know but the and I

895
00:36:32,750 --> 00:36:36,830
love the again the more Intel the more

896
00:36:35,420 --> 00:36:38,599
traditional intelligence focused guys

897
00:36:36,830 --> 00:36:41,569
using the term finished intelligence

898
00:36:38,599 --> 00:36:43,580
which is interesting in the concept that

899
00:36:41,570 --> 00:36:46,339
this is a report that has a story

900
00:36:43,580 --> 00:36:48,170
beginning to end but what I what I want

901
00:36:46,339 --> 00:36:51,170
to say to you is that yeah yeah yo seas

902
00:36:48,170 --> 00:36:53,390
are not actually finished tools for you

903
00:36:51,170 --> 00:36:54,890
to use right if you look at them as full

904
00:36:53,390 --> 00:36:57,140
the things that are finished for

905
00:36:54,890 --> 00:36:58,700
consumption right you're probably facing

906
00:36:57,140 --> 00:36:59,990
them in the wrong strategy right there

907
00:36:58,700 --> 00:37:02,689
are things that you should be learning

908
00:36:59,990 --> 00:37:04,640
from you should be exploring from them

909
00:37:02,690 --> 00:37:07,250
in order to have really efficient

910
00:37:04,640 --> 00:37:10,009
detection based on those specific

911
00:37:07,250 --> 00:37:11,990
signals and again what I'm trying to do

912
00:37:10,010 --> 00:37:15,140
here and I'll be trying to continue to

913
00:37:11,990 --> 00:37:17,540
try to do is how much automation really

914
00:37:15,140 --> 00:37:19,339
we can coax out of these things right to

915
00:37:17,540 --> 00:37:23,770
make our job just a little bit easier

916
00:37:19,339 --> 00:37:26,890
and with that and 20 minutes over I I

917
00:37:23,770 --> 00:37:26,890
thank you

918
00:37:27,109 --> 00:37:32,420
you

919
00:37:28,810 --> 00:37:32,420
[Music]

