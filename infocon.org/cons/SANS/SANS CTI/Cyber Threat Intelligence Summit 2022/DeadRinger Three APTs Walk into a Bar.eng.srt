1
00:00:06,000 --> 00:00:07,600
hi everyone thank you all for joining

2
00:00:07,600 --> 00:00:10,000
this session uh we are very excited and

3
00:00:10,000 --> 00:00:11,759
honored to be here today we've got a

4
00:00:11,759 --> 00:00:13,440
very packed session for you and very

5
00:00:13,440 --> 00:00:15,599
little time so without further ado let's

6
00:00:15,599 --> 00:00:16,480
get started

7
00:00:16,480 --> 00:00:18,480
so first let us quickly introduce

8
00:00:18,480 --> 00:00:20,640
ourselves so um

9
00:00:20,640 --> 00:00:22,560
well my name is assaf i'm the head of

10
00:00:22,560 --> 00:00:24,400
the nocturnalis threat research team at

11
00:00:24,400 --> 00:00:26,560
cybereason i've been in this industry

12
00:00:26,560 --> 00:00:27,519
for

13
00:00:27,519 --> 00:00:30,000
a little over 15 years 18 years now

14
00:00:30,000 --> 00:00:32,558
already jesus time flies uh i started my

15
00:00:32,558 --> 00:00:34,800
career in military intelligence and then

16
00:00:34,800 --> 00:00:36,320
as a civilian i've done pretty much

17
00:00:36,320 --> 00:00:38,000
anything from penetration testing to

18
00:00:38,000 --> 00:00:40,079
reverse engineering malware analysis and

19
00:00:40,079 --> 00:00:41,120
so on

20
00:00:41,120 --> 00:00:42,800
daniel you want to introduce yourself

21
00:00:42,800 --> 00:00:44,320
quickly

22
00:00:44,320 --> 00:00:46,320
sure uh hi everyone my name is daniel

23
00:00:46,320 --> 00:00:48,640
i'm a security researcher at the

24
00:00:48,640 --> 00:00:50,320
libraries electronics team previously at

25
00:00:50,320 --> 00:00:53,360
f5 networks and i started my career uh

26
00:00:53,360 --> 00:00:56,079
just a little over uh then 10 years ago

27
00:00:56,079 --> 00:00:58,559
with rsa security now i'm reversing

28
00:00:58,559 --> 00:01:00,960
malware and doing threat intel

29
00:01:00,960 --> 00:01:03,359
for cyber reason yeah tom

30
00:01:03,359 --> 00:01:06,080
okay hello everyone i'm tom i'm a start

31
00:01:06,080 --> 00:01:08,000
researcher with the cybersynchronous

32
00:01:08,000 --> 00:01:08,960
team

33
00:01:08,960 --> 00:01:10,880
and before that i started my philosophy

34
00:01:10,880 --> 00:01:13,119
career

35
00:01:14,159 --> 00:01:16,159
thank you tom and daniel

36
00:01:16,159 --> 00:01:18,159
so today we're going to cover what led

37
00:01:18,159 --> 00:01:20,640
us to the discovery of dead ringer

38
00:01:20,640 --> 00:01:22,880
the challenges that my team faced when

39
00:01:22,880 --> 00:01:24,880
we tried to analyze and attribute

40
00:01:24,880 --> 00:01:27,360
multiple intrusion sets and we'll try to

41
00:01:27,360 --> 00:01:29,439
wrap up the session leaving uh with some

42
00:01:29,439 --> 00:01:31,040
leaving you with some key takeaways and

43
00:01:31,040 --> 00:01:33,119
hopefully some food for thought so you

44
00:01:33,119 --> 00:01:35,200
guys ready

45
00:01:35,200 --> 00:01:36,720
um so

46
00:01:36,720 --> 00:01:38,720
maybe a good place to start our session

47
00:01:38,720 --> 00:01:40,880
is by telling you what dead ringer is

48
00:01:40,880 --> 00:01:42,799
and what it is not so despite the

49
00:01:42,799 --> 00:01:45,759
sinister name it has den ringer is not a

50
00:01:45,759 --> 00:01:48,560
malware nor a threat actor and without

51
00:01:48,560 --> 00:01:51,119
too many spoilers uh dead ringer is a

52
00:01:51,119 --> 00:01:52,479
name that we gave

53
00:01:52,479 --> 00:01:54,880
the investigation of multiple uh

54
00:01:54,880 --> 00:01:58,159
intrusions that we detected um in asia

55
00:01:58,159 --> 00:02:00,159
targeting telcos

56
00:02:00,159 --> 00:02:03,119
so uh to start this talk i want to i

57
00:02:03,119 --> 00:02:04,240
want you to

58
00:02:04,240 --> 00:02:06,799
come with me uh back in time to march

59
00:02:06,799 --> 00:02:09,598
2021 probably one of the most dramatic

60
00:02:09,598 --> 00:02:12,319
months of uh that our industry uh had

61
00:02:12,319 --> 00:02:15,280
known for the recent years and why is

62
00:02:15,280 --> 00:02:17,599
that well let me give you a quick hint

63
00:02:17,599 --> 00:02:20,400
it starts with uh microsoft and ends

64
00:02:20,400 --> 00:02:23,440
with exchange server vulnerabilities

65
00:02:23,440 --> 00:02:27,599
so um yeah and basically on march 2nd uh

66
00:02:27,599 --> 00:02:29,599
microsoft and i believe it was velocity

67
00:02:29,599 --> 00:02:32,080
as well released the discovery of four

68
00:02:32,080 --> 00:02:34,879
zero days impacting microsoft exchange

69
00:02:34,879 --> 00:02:37,920
servers microsoft also reported um that

70
00:02:37,920 --> 00:02:40,400
was there was a chinese threat actor

71
00:02:40,400 --> 00:02:42,959
named kathyum uh that was exploiting

72
00:02:42,959 --> 00:02:45,120
those vulnerabilities in the wild

73
00:02:45,120 --> 00:02:48,000
and now once the ward kind of got out

74
00:02:48,000 --> 00:02:50,239
there basically every threat actor on

75
00:02:50,239 --> 00:02:52,400
the planet uh tried to get their hands

76
00:02:52,400 --> 00:02:54,720
on you know a working exploit it kind of

77
00:02:54,720 --> 00:02:56,959
looked like this or felt like this

78
00:02:56,959 --> 00:02:59,200
and it took a couple of days and we

79
00:02:59,200 --> 00:03:00,959
started seeing a wide range of threat

80
00:03:00,959 --> 00:03:03,280
actors uh actively exploiting these

81
00:03:03,280 --> 00:03:05,360
vulnerabilities

82
00:03:05,360 --> 00:03:08,400
um as defenders we started obviously we

83
00:03:08,400 --> 00:03:10,080
immediately started building hunting

84
00:03:10,080 --> 00:03:13,200
queries to catch this ginormous tsunami

85
00:03:13,200 --> 00:03:16,080
of exploitation attempts and uh

86
00:03:16,080 --> 00:03:18,319
what do you know uh it wasn't too hard

87
00:03:18,319 --> 00:03:20,879
to find we had uh hundreds of uh true

88
00:03:20,879 --> 00:03:23,200
positive uh hits

89
00:03:23,200 --> 00:03:25,599
uh basically uh we started uh seeing a

90
00:03:25,599 --> 00:03:28,319
lot of uh web shells uh galore we had

91
00:03:28,319 --> 00:03:30,080
webshow's galore installing anything

92
00:03:30,080 --> 00:03:33,599
from apd backdoors to coin miners

93
00:03:33,599 --> 00:03:35,280
everyone was kind of like riding this

94
00:03:35,280 --> 00:03:38,000
crazy wave going all cowabunga on those

95
00:03:38,000 --> 00:03:40,159
four exchange servers

96
00:03:40,159 --> 00:03:41,760
and um

97
00:03:41,760 --> 00:03:43,680
when we started examining the data we

98
00:03:43,680 --> 00:03:45,840
noticed one intrusion that targeted an

99
00:03:45,840 --> 00:03:48,640
asian telco which had ttps that were

100
00:03:48,640 --> 00:03:51,280
very reminiscent of a chinese threat

101
00:03:51,280 --> 00:03:54,400
actor we discovered back in 2019 called

102
00:03:54,400 --> 00:03:56,480
soft cell

103
00:03:56,480 --> 00:03:58,720
together with our amazing ir team we

104
00:03:58,720 --> 00:04:00,879
started investigating it we

105
00:04:00,879 --> 00:04:03,599
we got in we pulled around six months of

106
00:04:03,599 --> 00:04:06,080
data um that we took from the

107
00:04:06,080 --> 00:04:09,120
environment and started looking at it

108
00:04:09,120 --> 00:04:11,439
now initially when we initially analyzed

109
00:04:11,439 --> 00:04:12,879
the data again we couldn't shake off

110
00:04:12,879 --> 00:04:15,599
this strong deja vu feeling that we've

111
00:04:15,599 --> 00:04:18,478
seen this before we thought it you know

112
00:04:18,478 --> 00:04:20,639
we probably found softel again like a

113
00:04:20,639 --> 00:04:22,880
version or like evolution of it but as

114
00:04:22,880 --> 00:04:25,440
time went by uh we discovered that there

115
00:04:25,440 --> 00:04:29,199
was uh more to the story spoiler alert

116
00:04:29,199 --> 00:04:30,960
so um

117
00:04:30,960 --> 00:04:32,880
let me first maybe uh

118
00:04:32,880 --> 00:04:34,320
show you what it looked like when we

119
00:04:34,320 --> 00:04:37,120
poured the data into multigo so you're

120
00:04:37,120 --> 00:04:39,199
looking at all the machines that we've

121
00:04:39,199 --> 00:04:41,440
identified as compromised

122
00:04:41,440 --> 00:04:44,160
uh now that's a serious pwnage going on

123
00:04:44,160 --> 00:04:46,240
here uh most of these machines were

124
00:04:46,240 --> 00:04:48,160
critical servers either like dc

125
00:04:48,160 --> 00:04:50,960
databases stuff like that uh and at the

126
00:04:50,960 --> 00:04:53,520
first glance we thought that it was all

127
00:04:53,520 --> 00:04:56,560
part of one giant attack but remember we

128
00:04:56,560 --> 00:04:59,520
had six months of data uh to analyze and

129
00:04:59,520 --> 00:05:01,759
as we began clustering the data we

130
00:05:01,759 --> 00:05:03,840
noticed that there was not one but

131
00:05:03,840 --> 00:05:06,880
actually three distinct clusters so that

132
00:05:06,880 --> 00:05:09,280
was cluster a b

133
00:05:09,280 --> 00:05:10,800
and c

134
00:05:10,800 --> 00:05:13,919
now each cluster had its own unique uh

135
00:05:13,919 --> 00:05:15,600
characteristics let's call it that way

136
00:05:15,600 --> 00:05:19,039
and if that was enough they also overlap

137
00:05:19,039 --> 00:05:22,400
uh multiple times which was uh

138
00:05:22,400 --> 00:05:24,240
once we realized that there's this

139
00:05:24,240 --> 00:05:26,880
overlap we you know uh a zillion

140
00:05:26,880 --> 00:05:28,880
questions started sizzling in our

141
00:05:28,880 --> 00:05:31,360
curious minds uh we started wondering

142
00:05:31,360 --> 00:05:33,919
are the clusters related is it the same

143
00:05:33,919 --> 00:05:36,560
threat actor is is it more than one or

144
00:05:36,560 --> 00:05:38,639
more than two threat actors are they're

145
00:05:38,639 --> 00:05:41,039
all working together are they aware of

146
00:05:41,039 --> 00:05:42,960
each other are they piggybacking each

147
00:05:42,960 --> 00:05:44,080
other maybe

148
00:05:44,080 --> 00:05:46,479
uh but at this point in time we didn't

149
00:05:46,479 --> 00:05:48,560
even know what these clusters were we

150
00:05:48,560 --> 00:05:49,840
just knew that they seemed very

151
00:05:49,840 --> 00:05:51,600
different from each other and it was

152
00:05:51,600 --> 00:05:53,840
really a time for us to dive into the

153
00:05:53,840 --> 00:05:57,199
data and start to figure out uh who who

154
00:05:57,199 --> 00:06:00,000
were dealing with basically so with that

155
00:06:00,000 --> 00:06:02,400
in mind that was like the introduction

156
00:06:02,400 --> 00:06:04,960
i'll hand over the mic to tom and daniel

157
00:06:04,960 --> 00:06:07,120
who walk us through what we actually

158
00:06:07,120 --> 00:06:10,319
found in each of these clusters so tom

159
00:06:10,319 --> 00:06:11,919
you can take it from here

160
00:06:11,919 --> 00:06:14,000
okay thank yourself

161
00:06:14,000 --> 00:06:16,560
so as usual said we observed the swedish

162
00:06:16,560 --> 00:06:18,479
steel customs activity

163
00:06:18,479 --> 00:06:20,319
so now in this part we are going to take

164
00:06:20,319 --> 00:06:21,840
you on your journey with us so you can

165
00:06:21,840 --> 00:06:24,000
see what we found in each cluster and

166
00:06:24,000 --> 00:06:26,240
how we were able to eventually attribute

167
00:06:26,240 --> 00:06:28,160
them

168
00:06:28,160 --> 00:06:29,840
so the first indications of mice's

169
00:06:29,840 --> 00:06:31,520
activity were multiple website

170
00:06:31,520 --> 00:06:34,400
executions on iis and exchange circles

171
00:06:34,400 --> 00:06:36,319
we saw the attack responding shares and

172
00:06:36,319 --> 00:06:38,479
reconnaissance commands even trying to

173
00:06:38,479 --> 00:06:39,759
move laterally

174
00:06:39,759 --> 00:06:41,440
they did a lot of things

175
00:06:41,440 --> 00:06:43,360
so let's try to break it down to the

176
00:06:43,360 --> 00:06:46,400
stages of natakia's life cycle

177
00:06:46,400 --> 00:06:47,759
the attacker executed different

178
00:06:47,759 --> 00:06:50,240
reconnaissance commands

179
00:06:50,240 --> 00:06:51,759
and as you can maybe see with the

180
00:06:51,759 --> 00:06:53,520
picture the commands have a unique

181
00:06:53,520 --> 00:06:54,880
structure to them

182
00:06:54,880 --> 00:06:56,560
this structure belongs to the famous

183
00:06:56,560 --> 00:06:58,479
china chopper website which is very

184
00:06:58,479 --> 00:07:00,960
popular with chinese hakka and it also

185
00:07:00,960 --> 00:07:03,520
publicly available so literally anyone

186
00:07:03,520 --> 00:07:04,720
can use it

187
00:07:04,720 --> 00:07:06,479
so because of that it doesn't

188
00:07:06,479 --> 00:07:07,919
automatically mean that the attackers

189
00:07:07,919 --> 00:07:09,919
were chinese

190
00:07:09,919 --> 00:07:11,599
next the attackers attempted to steal

191
00:07:11,599 --> 00:07:13,680
credentials i will give you a second to

192
00:07:13,680 --> 00:07:16,639
guess which tools you use for this

193
00:07:16,639 --> 00:07:19,680
of course our beloved mimikaze tool

194
00:07:19,680 --> 00:07:21,599
now the main tools attackers of cluster

195
00:07:21,599 --> 00:07:24,160
a used to create foothold is a malware

196
00:07:24,160 --> 00:07:27,199
named pc charbeck though this is a model

197
00:07:27,199 --> 00:07:28,720
that was developed also by chinese

198
00:07:28,720 --> 00:07:30,400
hackers and it's called is also

199
00:07:30,400 --> 00:07:33,039
available online so here again it still

200
00:07:33,039 --> 00:07:34,319
does not mean that attackers are

201
00:07:34,319 --> 00:07:36,319
necessarily chinese

202
00:07:36,319 --> 00:07:38,080
in an attempt to avoid detection the

203
00:07:38,080 --> 00:07:40,240
precision dll was siloed to legitimate

204
00:07:40,240 --> 00:07:42,479
nvidia forces it's a very popular

205
00:07:42,479 --> 00:07:45,199
technique used by many threat actors

206
00:07:45,199 --> 00:07:47,360
and on the investigation we found

207
00:07:47,360 --> 00:07:49,199
multiple pieces of evidence suggesting

208
00:07:49,199 --> 00:07:51,199
that the third actor was present

209
00:07:51,199 --> 00:07:53,520
from at least 2018

210
00:07:53,520 --> 00:07:55,039
and the scheduled task you see here is

211
00:07:55,039 --> 00:07:57,759
just one example of that

212
00:07:57,759 --> 00:07:59,599
now with the credentials the attackers

213
00:07:59,599 --> 00:08:02,240
stolen they tried they started to move

214
00:08:02,240 --> 00:08:04,160
later in the environment living off the

215
00:08:04,160 --> 00:08:06,879
land using tools like wmi

216
00:08:06,879 --> 00:08:09,120
and eventually also they were trying to

217
00:08:09,120 --> 00:08:11,840
exfiltrate incredible amounts of data

218
00:08:11,840 --> 00:08:13,680
the strong data was moved to a special

219
00:08:13,680 --> 00:08:16,240
folder archived using a guard and then

220
00:08:16,240 --> 00:08:18,319
exfiltrated using a work software vpn

221
00:08:18,319 --> 00:08:20,240
that they bought with them you can also

222
00:08:20,240 --> 00:08:22,000
see that the top the very tricky

223
00:08:22,000 --> 00:08:25,199
password was to archive the data

224
00:08:25,199 --> 00:08:27,440
so after we analyzed all the data we

225
00:08:27,440 --> 00:08:29,680
built a time and show that the attackers

226
00:08:29,680 --> 00:08:31,120
activity

227
00:08:31,120 --> 00:08:32,640
now when you look at the timeline there

228
00:08:32,640 --> 00:08:34,880
is something too important to consider

229
00:08:34,880 --> 00:08:36,719
we are dealing with a very persistent

230
00:08:36,719 --> 00:08:38,880
adaptive threat actor not only they have

231
00:08:38,880 --> 00:08:40,399
been there for at least two and a half

232
00:08:40,399 --> 00:08:42,399
years before we got there

233
00:08:42,399 --> 00:08:44,880
you can you can see that when we started

234
00:08:44,880 --> 00:08:47,519
we immediated them they kept coming back

235
00:08:47,519 --> 00:08:49,600
again and again again and each time they

236
00:08:49,600 --> 00:08:51,839
came back they modified their tools a

237
00:08:51,839 --> 00:08:53,600
little bit and tried to evade detection

238
00:08:53,600 --> 00:08:55,519
in more sophisticated ways

239
00:08:55,519 --> 00:08:56,800
and that really shows a great

240
00:08:56,800 --> 00:08:59,519
adaptiveness and resourcefulness

241
00:08:59,519 --> 00:09:01,920
now this behavior like us have said it

242
00:09:01,920 --> 00:09:03,600
was something that we also observed with

243
00:09:03,600 --> 00:09:06,800
a software activity group back in 2019

244
00:09:06,800 --> 00:09:08,880
now soft cell is a chinese activity

245
00:09:08,880 --> 00:09:10,080
group that many target the

246
00:09:10,080 --> 00:09:12,000
telecommunication industry for espionage

247
00:09:12,000 --> 00:09:13,600
purposes

248
00:09:13,600 --> 00:09:15,519
i'm sure you can only imagine why a

249
00:09:15,519 --> 00:09:17,760
nation state would want to hack a telco

250
00:09:17,760 --> 00:09:20,240
telcos hold so much information about us

251
00:09:20,240 --> 00:09:22,560
with whom we speak our location every

252
00:09:22,560 --> 00:09:24,560
minute of the day and so on

253
00:09:24,560 --> 00:09:26,480
then this is very valuable if you want

254
00:09:26,480 --> 00:09:28,720
to spy on people

255
00:09:28,720 --> 00:09:30,800
and furniture unfortunately we are not

256
00:09:30,800 --> 00:09:32,399
at liberty to disclose who the attackers

257
00:09:32,399 --> 00:09:34,640
were after but in case you're asking

258
00:09:34,640 --> 00:09:36,640
yourself what will china do with all the

259
00:09:36,640 --> 00:09:38,640
information they can get from telecos

260
00:09:38,640 --> 00:09:40,320
here's an example that was published by

261
00:09:40,320 --> 00:09:42,080
writers

262
00:09:42,080 --> 00:09:44,160
now let's go back to our story

263
00:09:44,160 --> 00:09:45,839
so we compared the data we had from

264
00:09:45,839 --> 00:09:48,240
operation software with our findings of

265
00:09:48,240 --> 00:09:49,760
cluster a and

266
00:09:49,760 --> 00:09:51,440
everlook

267
00:09:51,440 --> 00:09:52,959
when we started to compare all the

268
00:09:52,959 --> 00:09:55,519
activity of both operations we had a lot

269
00:09:55,519 --> 00:09:57,200
of data to deal with which might seem a

270
00:09:57,200 --> 00:09:59,279
little overwhelming at the beginning but

271
00:09:59,279 --> 00:10:01,519
when we started to cluster the data and

272
00:10:01,519 --> 00:10:03,839
classify the tools and techniques the

273
00:10:03,839 --> 00:10:05,760
connections between the two operations

274
00:10:05,760 --> 00:10:08,000
became more apparent to us

275
00:10:08,000 --> 00:10:11,120
and for people who prefer tables

276
00:10:11,120 --> 00:10:13,279
as you can see here we found quite a few

277
00:10:13,279 --> 00:10:14,720
overlaps and similarities in the

278
00:10:14,720 --> 00:10:17,360
different ttps naming conventions and

279
00:10:17,360 --> 00:10:20,399
targets of both intrusions

280
00:10:20,399 --> 00:10:22,560
now one of the things that helped us to

281
00:10:22,560 --> 00:10:25,279
cluster the data was using the diamond

282
00:10:25,279 --> 00:10:27,360
model of intrusion analysis

283
00:10:27,360 --> 00:10:29,519
this famous model can help us build a

284
00:10:29,519 --> 00:10:31,760
kind of an identity card for threatened

285
00:10:31,760 --> 00:10:33,600
threat actors

286
00:10:33,600 --> 00:10:35,440
the mother describes the relationships

287
00:10:35,440 --> 00:10:37,360
between between different components

288
00:10:37,360 --> 00:10:39,200
their adversary of course their

289
00:10:39,200 --> 00:10:40,959
capabilities which are the different

290
00:10:40,959 --> 00:10:42,720
tools and techniques used by the state

291
00:10:42,720 --> 00:10:44,000
actor

292
00:10:44,000 --> 00:10:46,000
the infrastructure which are the ip

293
00:10:46,000 --> 00:10:48,480
addresses domain names and such and the

294
00:10:48,480 --> 00:10:50,800
victims the industries the regions that

295
00:10:50,800 --> 00:10:52,800
are the target of the inclusion

296
00:10:52,800 --> 00:10:54,560
and this really helped us to stay

297
00:10:54,560 --> 00:10:56,800
focused on the actual data rather than

298
00:10:56,800 --> 00:10:58,560
our own hunches and show us well

299
00:10:58,560 --> 00:11:00,720
similarities really existed

300
00:11:00,720 --> 00:11:02,640
and eventually we understood that we are

301
00:11:02,640 --> 00:11:04,160
again dealing with a soft cellular

302
00:11:04,160 --> 00:11:06,000
activity

303
00:11:06,000 --> 00:11:07,600
and we currently classify software as an

304
00:11:07,600 --> 00:11:10,000
activity group rather than a threat

305
00:11:10,000 --> 00:11:11,519
we believe that they are actually a part

306
00:11:11,519 --> 00:11:14,079
of a larger group and doing our research

307
00:11:14,079 --> 00:11:15,519
we encountered some interesting

308
00:11:15,519 --> 00:11:17,519
connections between zen and the famous

309
00:11:17,519 --> 00:11:19,279
apd-41

310
00:11:19,279 --> 00:11:21,200
our united states the group origins in

311
00:11:21,200 --> 00:11:23,200
china and they operate on behalf of

312
00:11:23,200 --> 00:11:25,200
chinese state interests

313
00:11:25,200 --> 00:11:28,320
we rediscovered them back in 2018 but we

314
00:11:28,320 --> 00:11:29,839
actually found some evidence that

315
00:11:29,839 --> 00:11:31,279
suggesting that they are operating since

316
00:11:31,279 --> 00:11:33,200
at least 2012

317
00:11:33,200 --> 00:11:34,959
and we've seen the soft cell carrying

318
00:11:34,959 --> 00:11:36,640
out different cyber espionage missions

319
00:11:36,640 --> 00:11:38,640
in various parts of the world mostly

320
00:11:38,640 --> 00:11:40,079
targeting telecoms and cutting

321
00:11:40,079 --> 00:11:42,399
information about individuals that are

322
00:11:42,399 --> 00:11:44,079
considered to be people of interest to

323
00:11:44,079 --> 00:11:45,839
china one of their targets are

324
00:11:45,839 --> 00:11:48,079
politicians human rights activists

325
00:11:48,079 --> 00:11:51,199
journalists and so on

326
00:11:51,440 --> 00:11:53,760
so we found our first suspect the

327
00:11:53,760 --> 00:11:55,120
software

328
00:11:55,120 --> 00:11:56,880
now i'll pass the thoughts to daniel to

329
00:11:56,880 --> 00:11:58,880
talk about the total other clusters and

330
00:11:58,880 --> 00:12:01,519
what we found

331
00:12:01,600 --> 00:12:04,160
uh thank you tom so

332
00:12:04,160 --> 00:12:05,920
our story doesn't end with the fact of

333
00:12:05,920 --> 00:12:08,079
chapter so at first we did not suspect

334
00:12:08,079 --> 00:12:09,600
that another thread actor was actually

335
00:12:09,600 --> 00:12:12,000
in the environment uh however as we went

336
00:12:12,000 --> 00:12:14,000
deep into the investigation something

337
00:12:14,000 --> 00:12:16,320
just didn't up we could really sense

338
00:12:16,320 --> 00:12:18,160
that there was a different team working

339
00:12:18,160 --> 00:12:19,839
separately but we did not know who it

340
00:12:19,839 --> 00:12:22,079
was at the time

341
00:12:22,079 --> 00:12:23,839
this cluster had its own ttps and

342
00:12:23,839 --> 00:12:25,200
infrastructure that distinguished it

343
00:12:25,200 --> 00:12:27,519
from the software cluster uh in addition

344
00:12:27,519 --> 00:12:30,079
among uh the three clusters this one is

345
00:12:30,079 --> 00:12:31,440
the shortest one with the earliest

346
00:12:31,440 --> 00:12:33,680
indicators going back only to uh late

347
00:12:33,680 --> 00:12:36,000
2020. let's have a look at the timeline

348
00:12:36,000 --> 00:12:37,040
okay

349
00:12:37,040 --> 00:12:38,320
the first signs of the sculptures

350
00:12:38,320 --> 00:12:40,639
activity were uh when we detected a

351
00:12:40,639 --> 00:12:42,240
lateral movement and uh multiple

352
00:12:42,240 --> 00:12:43,839
attempts to dump credentials of various

353
00:12:43,839 --> 00:12:45,680
user accounts using the famous combo of

354
00:12:45,680 --> 00:12:48,240
system journals uh progdamp and our bit

355
00:12:48,240 --> 00:12:50,480
of mimikats um

356
00:12:50,480 --> 00:12:52,320
then we thought we got rid of them but

357
00:12:52,320 --> 00:12:55,200
um they came back after a few months

358
00:12:55,200 --> 00:12:56,079
so

359
00:12:56,079 --> 00:12:57,760
after a while these attempts became less

360
00:12:57,760 --> 00:12:59,839
frequent uh and then we detected a very

361
00:12:59,839 --> 00:13:02,079
interesting binary that was found on a

362
00:13:02,079 --> 00:13:03,920
few selected uh high-profile machines

363
00:13:03,920 --> 00:13:05,680
that turned out to be an unknown custom

364
00:13:05,680 --> 00:13:06,800
key log

365
00:13:06,800 --> 00:13:08,720
shortly after uh we detected another

366
00:13:08,720 --> 00:13:10,800
suspicious activity that originated from

367
00:13:10,800 --> 00:13:13,279
legitimate processes it turned out that

368
00:13:13,279 --> 00:13:15,839
the attackers used a dll side loading

369
00:13:15,839 --> 00:13:17,279
technique

370
00:13:17,279 --> 00:13:19,519
to hide a very rare backdoor called the

371
00:13:19,519 --> 00:13:22,480
nebula backdoor inside processes of

372
00:13:22,480 --> 00:13:24,399
reputable vendors such as google and

373
00:13:24,399 --> 00:13:25,760
symantec

374
00:13:25,760 --> 00:13:27,440
once they mapped out the network install

375
00:13:27,440 --> 00:13:30,240
credentials we've seen them on a crazy

376
00:13:30,240 --> 00:13:32,079
lateral movement spree just trying to

377
00:13:32,079 --> 00:13:34,320
get to as many machines as they uh could

378
00:13:34,320 --> 00:13:36,399
and specifically to critical

379
00:13:36,399 --> 00:13:37,839
assets

380
00:13:37,839 --> 00:13:39,440
let's talk about the tools that we

381
00:13:39,440 --> 00:13:41,040
discovered that were used in this

382
00:13:41,040 --> 00:13:43,199
cluster the first tool was the intro

383
00:13:43,199 --> 00:13:44,800
logger which is a custom keylogger with

384
00:13:44,800 --> 00:13:46,880
a very low detection at the time of the

385
00:13:46,880 --> 00:13:48,720
investigation all the three av vendors

386
00:13:48,720 --> 00:13:51,600
stuck this file um as a malicious

387
00:13:51,600 --> 00:13:52,800
another thing to notice is that the

388
00:13:52,800 --> 00:13:54,800
keylogger was actually loaded into a

389
00:13:54,800 --> 00:13:57,120
legitimate process as well uh this time

390
00:13:57,120 --> 00:14:00,079
being a potplayer which is a popular

391
00:14:00,079 --> 00:14:01,760
south korean media player and can be

392
00:14:01,760 --> 00:14:05,120
seen um in this process three

393
00:14:05,120 --> 00:14:07,839
um the nebula backdoor was the main tool

394
00:14:07,839 --> 00:14:09,600
that was uh used by the attacker in

395
00:14:09,600 --> 00:14:10,720
cluster b

396
00:14:10,720 --> 00:14:12,720
and uh so it happened that i was the one

397
00:14:12,720 --> 00:14:14,880
who got tasked with reversing it during

398
00:14:14,880 --> 00:14:17,199
our investigation so i remember looking

399
00:14:17,199 --> 00:14:19,120
at the code and thinking like wow this

400
00:14:19,120 --> 00:14:21,360
this looks quite unique um

401
00:14:21,360 --> 00:14:23,040
so of course i thought that i discovered

402
00:14:23,040 --> 00:14:25,920
the new malware yay you know um a little

403
00:14:25,920 --> 00:14:28,320
did i know that the defender also

404
00:14:28,320 --> 00:14:30,639
observed this around the same time and

405
00:14:30,639 --> 00:14:32,880
actually beat us to the publication but

406
00:14:32,880 --> 00:14:34,800
you know hey that's life and like really

407
00:14:34,800 --> 00:14:38,160
nice work with defender people

408
00:14:38,160 --> 00:14:40,959
as you um already know this uh this this

409
00:14:40,959 --> 00:14:43,199
trade actor loves the dll hijacking

410
00:14:43,199 --> 00:14:45,120
technique to hide its payloads uh in

411
00:14:45,120 --> 00:14:46,959
legitimate processes and you know what's

412
00:14:46,959 --> 00:14:48,720
more trusted than application than an

413
00:14:48,720 --> 00:14:50,639
application from google or symantec

414
00:14:50,639 --> 00:14:52,720
right wink wink

415
00:14:52,720 --> 00:14:54,959
um like every good backdoor it possesses

416
00:14:54,959 --> 00:14:56,480
all the cool features that can be used

417
00:14:56,480 --> 00:14:58,160
for our reconnaissance filing process

418
00:14:58,160 --> 00:15:00,480
manipulation command execution

419
00:15:00,480 --> 00:15:02,959
and uh privilege escalation the regular

420
00:15:02,959 --> 00:15:04,720
cool stuff

421
00:15:04,720 --> 00:15:06,000
in the interest of time i'll tell you

422
00:15:06,000 --> 00:15:07,279
that based on

423
00:15:07,279 --> 00:15:09,600
internal and external intelligent our

424
00:15:09,600 --> 00:15:12,320
prime suspect behind cluster b is the

425
00:15:12,320 --> 00:15:14,800
nikon apt group so for those of you who

426
00:15:14,800 --> 00:15:16,800
are um less familiar with the group it's

427
00:15:16,800 --> 00:15:18,959
a group that is it is um

428
00:15:18,959 --> 00:15:20,399
attributed to the chinese military

429
00:15:20,399 --> 00:15:22,000
intelligence they're one of the most

430
00:15:22,000 --> 00:15:24,000
elusive apt groups they've been first

431
00:15:24,000 --> 00:15:25,360
identified

432
00:15:25,360 --> 00:15:27,040
back in 2012

433
00:15:27,040 --> 00:15:29,680
but there's relatively little publicly

434
00:15:29,680 --> 00:15:31,600
available information about them

435
00:15:31,600 --> 00:15:34,320
the group's specialty is cyber espionage

436
00:15:34,320 --> 00:15:35,440
and gaining access to critical

437
00:15:35,440 --> 00:15:37,920
infrastructure their main playground is

438
00:15:37,920 --> 00:15:39,839
asia although they did targeted other

439
00:15:39,839 --> 00:15:42,160
regions of the path and also various uh

440
00:15:42,160 --> 00:15:43,920
sectors

441
00:15:43,920 --> 00:15:45,839
one thing i love about cti work is

442
00:15:45,839 --> 00:15:47,759
comparing notes with other researchers

443
00:15:47,759 --> 00:15:51,279
so their observations can be sometimes

444
00:15:51,279 --> 00:15:53,519
critical in understanding the broader

445
00:15:53,519 --> 00:15:55,600
context of an attack and what do you

446
00:15:55,600 --> 00:15:57,600
know just two days after a publication

447
00:15:57,600 --> 00:16:00,000
symantec um released a report that had

448
00:16:00,000 --> 00:16:02,000
the same ttps the ndiocs we observed in

449
00:16:02,000 --> 00:16:03,199
cluster b

450
00:16:03,199 --> 00:16:05,600
and while they did not attribute their

451
00:16:05,600 --> 00:16:07,440
findings to a specific actor they did

452
00:16:07,440 --> 00:16:09,120
mention that it was a chinese reduction

453
00:16:09,120 --> 00:16:11,199
but more importantly they provided

454
00:16:11,199 --> 00:16:12,399
additional context around the

455
00:16:12,399 --> 00:16:15,440
victimology reporting that um this group

456
00:16:15,440 --> 00:16:17,279
wasn't attacking just telcos but they

457
00:16:17,279 --> 00:16:19,040
were also attacking various critical

458
00:16:19,040 --> 00:16:21,839
infrastructure organizations

459
00:16:21,839 --> 00:16:23,360
here we can find the diamond model

460
00:16:23,360 --> 00:16:25,360
summary for our cluster b a storm

461
00:16:25,360 --> 00:16:27,360
detailed in cluster a uh we can see the

462
00:16:27,360 --> 00:16:28,560
diamond model representing the

463
00:16:28,560 --> 00:16:30,399
capabilities infrastructure and

464
00:16:30,399 --> 00:16:32,720
technology found um when analyzing what

465
00:16:32,720 --> 00:16:35,759
we believe to be the nikon be nikon's uh

466
00:16:35,759 --> 00:16:38,480
nikon apt is activity sorry

467
00:16:38,480 --> 00:16:39,600
um

468
00:16:39,600 --> 00:16:41,680
and here we can see the class the

469
00:16:41,680 --> 00:16:43,440
cluster be added to our venn diagram

470
00:16:43,440 --> 00:16:45,440
including the ttps found

471
00:16:45,440 --> 00:16:47,440
in that class

472
00:16:47,440 --> 00:16:48,320
okay

473
00:16:48,320 --> 00:16:50,560
so we have reached our last but not

474
00:16:50,560 --> 00:16:53,519
least cluster which is also um quite an

475
00:16:53,519 --> 00:16:54,720
interesting one

476
00:16:54,720 --> 00:16:57,199
so let's have a look the mini cluster uh

477
00:16:57,199 --> 00:16:59,519
features a very interesting and rare and

478
00:16:59,519 --> 00:17:01,360
again rare tool that the attackers used

479
00:17:01,360 --> 00:17:04,079
which is an um over back door

480
00:17:04,079 --> 00:17:05,839
we observed a rather massive deployment

481
00:17:05,839 --> 00:17:07,679
of this vector on microsoft exchange and

482
00:17:07,679 --> 00:17:10,240
ias servers um what's interesting here

483
00:17:10,240 --> 00:17:12,559
is that the same backdoor with slight um

484
00:17:12,559 --> 00:17:14,319
variations um here and there was

485
00:17:14,319 --> 00:17:16,319
deployed consistently on dozens of

486
00:17:16,319 --> 00:17:19,679
servers from 2017 all the way to 2021

487
00:17:19,679 --> 00:17:22,160
without being detected um this really

488
00:17:22,160 --> 00:17:24,480
shows us um how important it was for the

489
00:17:24,480 --> 00:17:26,480
thread uh for the

490
00:17:26,480 --> 00:17:28,480
attackers to maintain their access and

491
00:17:28,480 --> 00:17:30,080
foothold in the network for such a long

492
00:17:30,080 --> 00:17:31,440
period of time

493
00:17:31,440 --> 00:17:32,799
this vector has

494
00:17:32,799 --> 00:17:34,400
two main purposes

495
00:17:34,400 --> 00:17:36,240
um the first is to capture credentials

496
00:17:36,240 --> 00:17:38,480
of every user who logs into the server

497
00:17:38,480 --> 00:17:39,840
which means that each time someone

498
00:17:39,840 --> 00:17:41,200
checks their email using alpha the

499
00:17:41,200 --> 00:17:43,360
attackers receive their credentials

500
00:17:43,360 --> 00:17:45,039
crazy right that means the attackers

501
00:17:45,039 --> 00:17:46,480
probably were able to get the email

502
00:17:46,480 --> 00:17:48,240
credentials of anyone who worked at this

503
00:17:48,240 --> 00:17:50,640
company so whether it's the ceo head of

504
00:17:50,640 --> 00:17:52,480
idea engineering and

505
00:17:52,480 --> 00:17:54,799
etc right just imagine what an attacker

506
00:17:54,799 --> 00:17:57,440
can do with such information

507
00:17:57,440 --> 00:17:59,440
the second purpose is to function as a

508
00:17:59,440 --> 00:18:01,039
web shell serving as an access point to

509
00:18:01,039 --> 00:18:03,039
the enterprise

510
00:18:03,039 --> 00:18:04,480
and um

511
00:18:04,480 --> 00:18:06,640
when we started actually diving into the

512
00:18:06,640 --> 00:18:08,559
code of this backdoor we soon found

513
00:18:08,559 --> 00:18:10,720
strong similarities to another backdoor

514
00:18:10,720 --> 00:18:13,360
dll shell exc that appeared in a report

515
00:18:13,360 --> 00:18:16,160
by trend micro uh back in 2015 about an

516
00:18:16,160 --> 00:18:18,320
operation called iron tiger and

517
00:18:18,320 --> 00:18:20,320
attributed to a group called group three

518
00:18:20,320 --> 00:18:21,760
three nine zero

519
00:18:21,760 --> 00:18:23,840
aside from obvious code and style

520
00:18:23,840 --> 00:18:25,440
similarities we also observe very

521
00:18:25,440 --> 00:18:27,360
similar capabilities

522
00:18:27,360 --> 00:18:29,760
and if that's not enough uh even the log

523
00:18:29,760 --> 00:18:32,000
output convention uh of the collected

524
00:18:32,000 --> 00:18:34,640
credentials was almost identical we can

525
00:18:34,640 --> 00:18:36,160
see that um

526
00:18:36,160 --> 00:18:38,720
the top uh log structure of the of of

527
00:18:38,720 --> 00:18:40,960
this group group 390 tool

528
00:18:40,960 --> 00:18:42,960
is almost exactly the same as our newly

529
00:18:42,960 --> 00:18:46,080
found vector from cluster c

530
00:18:46,080 --> 00:18:47,600
and um

531
00:18:47,600 --> 00:18:49,120
when we

532
00:18:49,120 --> 00:18:51,200
take into account all of these variables

533
00:18:51,200 --> 00:18:53,520
actually the similar code structure and

534
00:18:53,520 --> 00:18:56,080
capabilities and similar log file we

535
00:18:56,080 --> 00:18:57,840
arrive at the conclusion that our newly

536
00:18:57,840 --> 00:19:00,480
found backdoor was most likely created

537
00:19:00,480 --> 00:19:02,080
by the same team who created the uh

538
00:19:02,080 --> 00:19:03,840
backdoor mansion and operation the iron

539
00:19:03,840 --> 00:19:07,120
tiger or at the very least created by um

540
00:19:07,120 --> 00:19:11,039
another who had access uh to the code

541
00:19:11,039 --> 00:19:13,120
as you might have already guessed by now

542
00:19:13,120 --> 00:19:15,679
our prime suspect um in this cluster is

543
00:19:15,679 --> 00:19:17,760
called group three three nine zero uh

544
00:19:17,760 --> 00:19:20,160
which is also tracked by stop vendors as

545
00:19:20,160 --> 00:19:22,640
then uh a little bit of an easier

546
00:19:22,640 --> 00:19:25,360
alliance it's called the apt-27

547
00:19:25,360 --> 00:19:28,880
um and for those uh that are not um

548
00:19:28,880 --> 00:19:30,400
entirely familiar with them it is yet

549
00:19:30,400 --> 00:19:32,240
another chinese apt group one of the

550
00:19:32,240 --> 00:19:34,240
most active and industrious groups that

551
00:19:34,240 --> 00:19:37,280
operating is since at least 2010 so long

552
00:19:37,280 --> 00:19:38,480
time

553
00:19:38,480 --> 00:19:40,880
um they're conducting mainly mainly um

554
00:19:40,880 --> 00:19:43,600
cyber espionage and

555
00:19:43,600 --> 00:19:45,840
the this group was reportedly um

556
00:19:45,840 --> 00:19:47,360
attacked various locations and

557
00:19:47,360 --> 00:19:49,600
industries

558
00:19:49,600 --> 00:19:51,760
and here's our final clusters diamond

559
00:19:51,760 --> 00:19:53,679
model which is again quite different

560
00:19:53,679 --> 00:19:56,799
than unique than the previous clusters

561
00:19:56,799 --> 00:19:58,320
so now

562
00:19:58,320 --> 00:20:00,480
we have identified taskbacks for all

563
00:20:00,480 --> 00:20:03,440
three clusters and this is time to give

564
00:20:03,440 --> 00:20:05,600
the mic back to us

565
00:20:05,600 --> 00:20:07,440
thank you daniel and tom that was an

566
00:20:07,440 --> 00:20:09,200
awesome summary of the clusters like

567
00:20:09,200 --> 00:20:11,760
cramming six months of of investigative

568
00:20:11,760 --> 00:20:13,440
work to a very short time it was

569
00:20:13,440 --> 00:20:16,240
challenging uh if you want to know more

570
00:20:16,240 --> 00:20:18,000
go check out our blog there it's much

571
00:20:18,000 --> 00:20:20,000
more detailed but i hope we did a good

572
00:20:20,000 --> 00:20:21,919
job at summarizing it

573
00:20:21,919 --> 00:20:24,240
now we took you today on this journey

574
00:20:24,240 --> 00:20:26,400
that started with the discovery of what

575
00:20:26,400 --> 00:20:29,440
initially seemed like one giant attack

576
00:20:29,440 --> 00:20:31,120
and showed you how we were able to

577
00:20:31,120 --> 00:20:33,760
identify three distinct clusters each

578
00:20:33,760 --> 00:20:35,919
cluster again as you've seen has its own

579
00:20:35,919 --> 00:20:39,840
unique ttps infrastructure and iocs

580
00:20:39,840 --> 00:20:42,000
one thing though that really bugged us

581
00:20:42,000 --> 00:20:44,640
was the question of the overlap i'm sure

582
00:20:44,640 --> 00:20:47,120
many of you will agree that this overlap

583
00:20:47,120 --> 00:20:48,480
is not something that you get to see

584
00:20:48,480 --> 00:20:50,400
every day i'm not saying it's unheard of

585
00:20:50,400 --> 00:20:52,240
or anything but it's just not very

586
00:20:52,240 --> 00:20:54,240
common to see three different chinese

587
00:20:54,240 --> 00:20:57,280
apt nation state actors all at once

588
00:20:57,280 --> 00:20:58,080
right

589
00:20:58,080 --> 00:20:58,799
so

590
00:20:58,799 --> 00:21:00,559
and we were starting to wonder if it

591
00:21:00,559 --> 00:21:03,520
meant anything if at all right

592
00:21:03,520 --> 00:21:06,000
so but in our research we avoided

593
00:21:06,000 --> 00:21:08,240
jumping into conclusion about what this

594
00:21:08,240 --> 00:21:09,919
overlap can mean

595
00:21:09,919 --> 00:21:12,799
um tempting as it might have been uh

596
00:21:12,799 --> 00:21:15,360
instead we decided to include various

597
00:21:15,360 --> 00:21:18,080
hypotheses and plausible explanations

598
00:21:18,080 --> 00:21:20,159
and left them as open questions for the

599
00:21:20,159 --> 00:21:22,640
community uh hoping that maybe one day

600
00:21:22,640 --> 00:21:24,240
another researcher

601
00:21:24,240 --> 00:21:26,080
will come and maybe be able to shed

602
00:21:26,080 --> 00:21:27,679
light on this

603
00:21:27,679 --> 00:21:29,360
conundrum

604
00:21:29,360 --> 00:21:31,280
now uh we're getting to the end of this

605
00:21:31,280 --> 00:21:33,039
session or to the last topic of the

606
00:21:33,039 --> 00:21:34,960
session and it's time to discuss the

607
00:21:34,960 --> 00:21:37,200
topic of attribution

608
00:21:37,200 --> 00:21:39,280
now i know that uh

609
00:21:39,280 --> 00:21:41,919
attribution it could be a very it can be

610
00:21:41,919 --> 00:21:44,720
a somewhat of a loaded topic so

611
00:21:44,720 --> 00:21:46,559
i mean everyone seems to have a very

612
00:21:46,559 --> 00:21:48,799
strong opinion about it and that's why

613
00:21:48,799 --> 00:21:50,640
we wanted to share with you the

614
00:21:50,640 --> 00:21:53,520
challenges that my team faced and how we

615
00:21:53,520 --> 00:21:56,240
eventually or ultimately

616
00:21:56,240 --> 00:21:59,280
were able to circumvent them or uh oh

617
00:21:59,280 --> 00:22:01,360
yeah or find creative solutions

618
00:22:01,360 --> 00:22:04,400
so let's unpack this topic a bit okay uh

619
00:22:04,400 --> 00:22:06,000
by first understanding the main

620
00:22:06,000 --> 00:22:08,720
challenges with attribution so

621
00:22:08,720 --> 00:22:10,720
perhaps one of the most important thing

622
00:22:10,720 --> 00:22:12,080
to keep in mind when dealing with

623
00:22:12,080 --> 00:22:14,559
attribution is that you have to you kind

624
00:22:14,559 --> 00:22:16,400
of have to make peace or accept the fact

625
00:22:16,400 --> 00:22:17,919
that you never get to see the full

626
00:22:17,919 --> 00:22:18,960
picture

627
00:22:18,960 --> 00:22:21,440
some pieces of the puzzle will always be

628
00:22:21,440 --> 00:22:23,679
missing and usually this is because of

629
00:22:23,679 --> 00:22:26,000
insufficient visibility or missing

630
00:22:26,000 --> 00:22:27,760
collection capabilities

631
00:22:27,760 --> 00:22:30,480
so that's one hurdle to to pass

632
00:22:30,480 --> 00:22:32,240
now let's say that you do have a good

633
00:22:32,240 --> 00:22:34,400
collection the next hurdle is what to do

634
00:22:34,400 --> 00:22:36,080
with all of this data

635
00:22:36,080 --> 00:22:37,760
once you've obtained it

636
00:22:37,760 --> 00:22:39,919
how do you begin to narrow the data down

637
00:22:39,919 --> 00:22:42,240
how do you determine the relevance and

638
00:22:42,240 --> 00:22:44,000
more importantly how do you assign

639
00:22:44,000 --> 00:22:46,640
meaningful context to the relationship

640
00:22:46,640 --> 00:22:50,159
between different data points

641
00:22:50,720 --> 00:22:52,559
next

642
00:22:52,559 --> 00:22:54,559
it's important to remember that at any

643
00:22:54,559 --> 00:22:56,640
given time there could be several threat

644
00:22:56,640 --> 00:22:58,960
actors operating simultaneously whether

645
00:22:58,960 --> 00:23:01,919
it's cyber crime nation state or

646
00:23:01,919 --> 00:23:04,080
basically anything in between could uh

647
00:23:04,080 --> 00:23:05,600
could operate there

648
00:23:05,600 --> 00:23:06,960
so that means that while you're

649
00:23:06,960 --> 00:23:08,799
investigating you are likely to look at

650
00:23:08,799 --> 00:23:12,240
a very messy data set with multiple kill

651
00:23:12,240 --> 00:23:14,799
chains and multiple threat actors of

652
00:23:14,799 --> 00:23:16,480
course so it's not like i don't know

653
00:23:16,480 --> 00:23:18,720
sans labs or any other training you'll

654
00:23:18,720 --> 00:23:21,360
see usually like real environments tend

655
00:23:21,360 --> 00:23:22,960
to get very messy

656
00:23:22,960 --> 00:23:25,440
now as an analyst you'll be faced with

657
00:23:25,440 --> 00:23:27,679
questions such as how do you distinguish

658
00:23:27,679 --> 00:23:30,640
between one kill chain to another

659
00:23:30,640 --> 00:23:32,400
where does one kill chain ends and

660
00:23:32,400 --> 00:23:35,200
another begins and so on and how do you

661
00:23:35,200 --> 00:23:37,200
kind of connect the dots so that was

662
00:23:37,200 --> 00:23:40,000
like another uh hurdle

663
00:23:40,000 --> 00:23:43,440
um another topic that i personally find

664
00:23:43,440 --> 00:23:46,720
extremely annoying is the insane amount

665
00:23:46,720 --> 00:23:49,360
of aliases that exists both for malware

666
00:23:49,360 --> 00:23:51,200
and threat actor names

667
00:23:51,200 --> 00:23:53,679
so uh you know how every vendor comes up

668
00:23:53,679 --> 00:23:56,080
with their own naming convention and

669
00:23:56,080 --> 00:23:58,480
maybe for internal purposes that's

670
00:23:58,480 --> 00:24:01,520
absolutely fine we even encourage that

671
00:24:01,520 --> 00:24:03,840
but externally it becomes very hard to

672
00:24:03,840 --> 00:24:04,880
track

673
00:24:04,880 --> 00:24:06,880
now i'm sure you know you all know what

674
00:24:06,880 --> 00:24:09,760
i'm talking about let's say apt-89 aka

675
00:24:09,760 --> 00:24:12,960
glowing panda aka uranium chloride or

676
00:24:12,960 --> 00:24:14,480
something like that right

677
00:24:14,480 --> 00:24:15,279
so

678
00:24:15,279 --> 00:24:17,120
and also you have to keep in mind that

679
00:24:17,120 --> 00:24:19,039
in many cases

680
00:24:19,039 --> 00:24:20,720
these names are not necessarily

681
00:24:20,720 --> 00:24:22,159
synonymous

682
00:24:22,159 --> 00:24:23,840
different teams will have different

683
00:24:23,840 --> 00:24:26,240
standards and rules for attribution and

684
00:24:26,240 --> 00:24:28,640
will also observe attacks through

685
00:24:28,640 --> 00:24:30,159
different lenses

686
00:24:30,159 --> 00:24:31,679
so

687
00:24:31,679 --> 00:24:34,400
you have to be uh also careful with that

688
00:24:34,400 --> 00:24:36,559
uh and in addition

689
00:24:36,559 --> 00:24:38,640
some researchers uh will just hand you

690
00:24:38,640 --> 00:24:40,880
their conclusion on a silver platter

691
00:24:40,880 --> 00:24:42,960
like a tldr version

692
00:24:42,960 --> 00:24:45,200
uh without explaining too much how they

693
00:24:45,200 --> 00:24:48,720
got there and that lack of transparency

694
00:24:48,720 --> 00:24:51,200
makes it very difficult to trust

695
00:24:51,200 --> 00:24:53,600
third party intelligence so that's also

696
00:24:53,600 --> 00:24:56,799
something we need to take into account

697
00:24:56,799 --> 00:24:58,000
and

698
00:24:58,000 --> 00:25:01,200
another group of hurdles is that um or

699
00:25:01,200 --> 00:25:03,360
something very important to uh remember

700
00:25:03,360 --> 00:25:05,919
about attribution is that

701
00:25:05,919 --> 00:25:09,120
it's also very prone prone to a wide

702
00:25:09,120 --> 00:25:11,600
range of biases unfortunately we don't

703
00:25:11,600 --> 00:25:13,200
have enough time to cover all the

704
00:25:13,200 --> 00:25:15,440
different types of biases but here's uh

705
00:25:15,440 --> 00:25:17,200
maybe i don't know a good example the

706
00:25:17,200 --> 00:25:20,159
hindsight bias uh and thank you taylor

707
00:25:20,159 --> 00:25:22,640
swift for this great song

708
00:25:22,640 --> 00:25:26,159
uh so be my be mindful and and get

709
00:25:26,159 --> 00:25:27,919
acquainted with the different

710
00:25:27,919 --> 00:25:29,760
biases

711
00:25:29,760 --> 00:25:32,080
another topic which i find fascinating

712
00:25:32,080 --> 00:25:34,320
and very close to heart is opsec or the

713
00:25:34,320 --> 00:25:36,480
operational security of of the threat

714
00:25:36,480 --> 00:25:39,120
actors sometimes um

715
00:25:39,120 --> 00:25:40,799
threat actors make still a mistake and

716
00:25:40,799 --> 00:25:42,720
leave traces of their identity kind of

717
00:25:42,720 --> 00:25:44,960
like expose who they are uh while

718
00:25:44,960 --> 00:25:47,360
they're doing doing it we're all humans

719
00:25:47,360 --> 00:25:49,360
right we all make mistakes

720
00:25:49,360 --> 00:25:50,400
but

721
00:25:50,400 --> 00:25:52,080
you might want to be careful with that

722
00:25:52,080 --> 00:25:54,400
as well and because not all mistakes

723
00:25:54,400 --> 00:25:56,400
quote unquote are innocent and sometimes

724
00:25:56,400 --> 00:25:58,559
we see what we call uh intentional

725
00:25:58,559 --> 00:25:59,840
sloppiness

726
00:25:59,840 --> 00:26:01,919
or in other words uh threat actors will

727
00:26:01,919 --> 00:26:04,400
plant false flags to get us sidetracked

728
00:26:04,400 --> 00:26:06,880
or send us on a wild goose chase so

729
00:26:06,880 --> 00:26:08,720
that's also an important it's an

730
00:26:08,720 --> 00:26:11,440
important thing to um to uh be mindful

731
00:26:11,440 --> 00:26:14,559
of when uh dealing with attribution

732
00:26:14,559 --> 00:26:16,720
and lastly you've got to remember that

733
00:26:16,720 --> 00:26:19,200
attribution is not an exact science but

734
00:26:19,200 --> 00:26:20,480
it's rather

735
00:26:20,480 --> 00:26:22,320
i guess a form of art

736
00:26:22,320 --> 00:26:24,400
attribution is really like at least for

737
00:26:24,400 --> 00:26:27,200
me it's about making solid assessments

738
00:26:27,200 --> 00:26:28,799
based on the information that is

739
00:26:28,799 --> 00:26:30,799
available to you at the time of the

740
00:26:30,799 --> 00:26:34,159
analysis so you gotta keep in mind that

741
00:26:34,159 --> 00:26:36,480
uh attribution can change over time

742
00:26:36,480 --> 00:26:38,320
we've seen many cases where it changed

743
00:26:38,320 --> 00:26:43,200
as you as new uh information emerged

744
00:26:43,520 --> 00:26:46,960
okay so uh for uh so far we've mentioned

745
00:26:46,960 --> 00:26:49,679
the pains of uh attribution work but we

746
00:26:49,679 --> 00:26:51,200
also want to go over the things that

747
00:26:51,200 --> 00:26:53,360
ultimately helped us

748
00:26:53,360 --> 00:26:54,080
with

749
00:26:54,080 --> 00:26:56,640
attribution over the years

750
00:26:56,640 --> 00:26:57,840
so

751
00:26:57,840 --> 00:27:00,960
uh the first thing uh is making sure

752
00:27:00,960 --> 00:27:03,919
that uh sorry yeah so the first thing

753
00:27:03,919 --> 00:27:05,440
you want to do is to make sure that you

754
00:27:05,440 --> 00:27:07,520
have the right visibility if you don't

755
00:27:07,520 --> 00:27:08,880
have the right visibility you're

756
00:27:08,880 --> 00:27:10,880
probably missing a lot of data important

757
00:27:10,880 --> 00:27:12,720
data and you should probably make your

758
00:27:12,720 --> 00:27:15,120
case to your it and security teams make

759
00:27:15,120 --> 00:27:17,520
sure that they get pri it gets

760
00:27:17,520 --> 00:27:20,240
prioritized and so you can get the

761
00:27:20,240 --> 00:27:22,480
visibility that you need

762
00:27:22,480 --> 00:27:24,640
the second thing which i think uh most

763
00:27:24,640 --> 00:27:27,919
uh blue teamers had to face is uh data

764
00:27:27,919 --> 00:27:30,320
retention i think it's the enemy of

765
00:27:30,320 --> 00:27:33,120
almost any investigator so if you do

766
00:27:33,120 --> 00:27:36,000
have the possibility to uh store and

767
00:27:36,000 --> 00:27:39,039
then replay all data that's a great time

768
00:27:39,039 --> 00:27:41,120
machine if you will and it can help you

769
00:27:41,120 --> 00:27:43,120
solve attacks that lasted for months and

770
00:27:43,120 --> 00:27:45,360
even years

771
00:27:45,360 --> 00:27:48,640
next uh anyone who ever had to go over

772
00:27:48,640 --> 00:27:51,600
thousands lines of logs uh will tell you

773
00:27:51,600 --> 00:27:54,559
how easy it gets to i don't know to lose

774
00:27:54,559 --> 00:27:57,200
sight of the bigger picture it can get

775
00:27:57,200 --> 00:27:59,360
really overwhelming so we found that

776
00:27:59,360 --> 00:28:01,919
database visualization really helps us

777
00:28:01,919 --> 00:28:05,520
to kind of like zoom out and um

778
00:28:05,520 --> 00:28:07,919
and and see the bigger picture so there

779
00:28:07,919 --> 00:28:09,679
are really great solutions and tools out

780
00:28:09,679 --> 00:28:11,840
there we named multigo but there's a lot

781
00:28:11,840 --> 00:28:15,520
of like free ones um so check check them

782
00:28:15,520 --> 00:28:18,320
out see what works for your team

783
00:28:18,320 --> 00:28:19,200
now

784
00:28:19,200 --> 00:28:21,200
the most important thing perhaps in cti

785
00:28:21,200 --> 00:28:23,440
work is context so you want to make sure

786
00:28:23,440 --> 00:28:26,399
that your team has an update file on the

787
00:28:26,399 --> 00:28:28,880
thread actors that are relevant to you

788
00:28:28,880 --> 00:28:31,120
right so when you go in and you

789
00:28:31,120 --> 00:28:33,600
investigate and you support the sock or

790
00:28:33,600 --> 00:28:35,039
the ir people

791
00:28:35,039 --> 00:28:37,200
this will help you to identify threat

792
00:28:37,200 --> 00:28:39,919
actors quickly and also distinguish evil

793
00:28:39,919 --> 00:28:42,159
from evil okay

794
00:28:42,159 --> 00:28:43,679
um

795
00:28:43,679 --> 00:28:46,080
another thing uh that i think we

796
00:28:46,080 --> 00:28:48,240
mentioned it a couple of slides ago was

797
00:28:48,240 --> 00:28:50,799
uh the trust issues that may arise from

798
00:28:50,799 --> 00:28:53,279
consuming third-party intelligence

799
00:28:53,279 --> 00:28:55,679
so a good way to

800
00:28:55,679 --> 00:28:58,640
both invoke and gain trust is by being

801
00:28:58,640 --> 00:29:01,120
transparent so don't just share your

802
00:29:01,120 --> 00:29:03,679
final conclusion instead try to show how

803
00:29:03,679 --> 00:29:06,080
you arrive there make sure that your

804
00:29:06,080 --> 00:29:08,640
reports are very rich in data and that

805
00:29:08,640 --> 00:29:11,120
you separate facts and evidence from

806
00:29:11,120 --> 00:29:13,279
assumptions and assessments

807
00:29:13,279 --> 00:29:15,600
use suggestive language as much as much

808
00:29:15,600 --> 00:29:17,279
as possible if you're not sure about

809
00:29:17,279 --> 00:29:19,279
something or you you want to leave some

810
00:29:19,279 --> 00:29:21,360
margin for errors right

811
00:29:21,360 --> 00:29:23,840
that way you can create room for your

812
00:29:23,840 --> 00:29:26,480
readership your readers to

813
00:29:26,480 --> 00:29:28,559
interpret the data on their own and

814
00:29:28,559 --> 00:29:30,240
maybe they would come up with their a

815
00:29:30,240 --> 00:29:32,080
different conclusion and that's really

816
00:29:32,080 --> 00:29:34,159
okay but as long as the data is there

817
00:29:34,159 --> 00:29:35,760
and it's solid

818
00:29:35,760 --> 00:29:37,360
different people can interpret it

819
00:29:37,360 --> 00:29:38,640
differently

820
00:29:38,640 --> 00:29:42,000
and lastly we highly recommend using the

821
00:29:42,000 --> 00:29:44,159
famous diamond model of attribution to

822
00:29:44,159 --> 00:29:46,399
cluster incidents intrusions and fat

823
00:29:46,399 --> 00:29:49,120
actors this really helps you to stay

824
00:29:49,120 --> 00:29:51,520
well grounded in the data and less prone

825
00:29:51,520 --> 00:29:54,960
to biases and other mistakes

826
00:29:54,960 --> 00:29:56,640
okay so

827
00:29:56,640 --> 00:29:59,200
now just before we end this session uh

828
00:29:59,200 --> 00:30:00,720
we'd like to leave you with some key

829
00:30:00,720 --> 00:30:02,880
takeaways okay so the first one may seem

830
00:30:02,880 --> 00:30:05,760
a bit obvious uh that threat actors can

831
00:30:05,760 --> 00:30:08,080
remain undetected for years but as we've

832
00:30:08,080 --> 00:30:10,880
shown you here earlier it's not a figure

833
00:30:10,880 --> 00:30:13,600
of speech or like a marketing uh like

834
00:30:13,600 --> 00:30:16,080
exaggerated marketing statement

835
00:30:16,080 --> 00:30:18,080
we literally uncovered activity that

836
00:30:18,080 --> 00:30:20,559
lasted for four years without being

837
00:30:20,559 --> 00:30:22,720
detected and if it can happen to a

838
00:30:22,720 --> 00:30:25,360
company that invests a lot in security

839
00:30:25,360 --> 00:30:27,440
it can happen almost anywhere so there's

840
00:30:27,440 --> 00:30:29,200
also like a teachable and humbling

841
00:30:29,200 --> 00:30:31,679
moment here so don't say no it can't

842
00:30:31,679 --> 00:30:33,600
happen on my environment it won't happen

843
00:30:33,600 --> 00:30:37,120
to my company because uh an advanced uh

844
00:30:37,120 --> 00:30:39,279
threat they'll find a way to get in and

845
00:30:39,279 --> 00:30:41,120
stay stealthy

846
00:30:41,120 --> 00:30:43,200
second uh second thing you should take

847
00:30:43,200 --> 00:30:44,080
into

848
00:30:44,080 --> 00:30:46,320
uh consideration or i want you to take

849
00:30:46,320 --> 00:30:49,200
from this talk is to learn not to trust

850
00:30:49,200 --> 00:30:52,080
circumstantial evidence so much so if

851
00:30:52,080 --> 00:30:53,919
you see malicious activity around the

852
00:30:53,919 --> 00:30:56,320
same time frame same end points it

853
00:30:56,320 --> 00:30:58,320
doesn't necessarily mean that it's the

854
00:30:58,320 --> 00:30:59,919
same thread actor

855
00:30:59,919 --> 00:31:01,679
as you've seen here before right it

856
00:31:01,679 --> 00:31:03,679
could be but it doesn't automatically

857
00:31:03,679 --> 00:31:05,200
say that

858
00:31:05,200 --> 00:31:06,399
thirdly

859
00:31:06,399 --> 00:31:08,640
we really recommend all blue teams out

860
00:31:08,640 --> 00:31:10,640
there to infuse your detection and

861
00:31:10,640 --> 00:31:12,799
respond methodologies with threat

862
00:31:12,799 --> 00:31:14,159
intelligence

863
00:31:14,159 --> 00:31:16,240
so you want to make sure that you know

864
00:31:16,240 --> 00:31:18,880
you know your enemy you have dossiers on

865
00:31:18,880 --> 00:31:20,720
each major threat actors that is

866
00:31:20,720 --> 00:31:23,760
relevant to you you want to focus on um

867
00:31:23,760 --> 00:31:27,519
behavioral uh information uh ttps of

868
00:31:27,519 --> 00:31:29,039
course complement whatever you can with

869
00:31:29,039 --> 00:31:34,320
iocs and uh make sure uh sure that um

870
00:31:34,320 --> 00:31:37,039
uh that you're um i guess ultimately

871
00:31:37,039 --> 00:31:40,080
that your um intelligence is actionable

872
00:31:40,080 --> 00:31:42,240
because if your intelligence is not

873
00:31:42,240 --> 00:31:44,080
actionable you're probably doing it

874
00:31:44,080 --> 00:31:45,360
wrong

875
00:31:45,360 --> 00:31:48,399
and lastly uh last but not least once

876
00:31:48,399 --> 00:31:50,640
you conclude a major investigation

877
00:31:50,640 --> 00:31:53,120
schedule some time off for your team uh

878
00:31:53,120 --> 00:31:55,679
for a post-mortem try to identify gaps

879
00:31:55,679 --> 00:31:58,000
that affected your investigation whether

880
00:31:58,000 --> 00:32:01,200
it's collection detection response

881
00:32:01,200 --> 00:32:03,440
and uh and then work with the relevant

882
00:32:03,440 --> 00:32:06,320
stakeholders to articulate the security

883
00:32:06,320 --> 00:32:08,240
requirements that need that are needed

884
00:32:08,240 --> 00:32:09,919
to breach

885
00:32:09,919 --> 00:32:11,600
these gaps

886
00:32:11,600 --> 00:32:14,159
so thank you all for honoring us today

887
00:32:14,159 --> 00:32:16,159
with your attendance we'd like to thank

888
00:32:16,159 --> 00:32:18,320
the organizers as well for doing such a

889
00:32:18,320 --> 00:32:20,399
wonderful job with this conference and

890
00:32:20,399 --> 00:32:24,918
for their uh immense support

