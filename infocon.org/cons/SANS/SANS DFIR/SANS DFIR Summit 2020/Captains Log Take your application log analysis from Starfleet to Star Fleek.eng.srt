1
00:00:01,040 --> 00:00:07,429
[Music]

2
00:00:12,400 --> 00:00:15,200
we have

3
00:00:12,960 --> 00:00:16,800
captain's log and we have david and ryan

4
00:00:15,200 --> 00:00:17,359
here to share all their knowledge with

5
00:00:16,800 --> 00:00:19,279
you

6
00:00:17,359 --> 00:00:20,400
um again as i've been doing i'll pin

7
00:00:19,279 --> 00:00:22,320
things in the

8
00:00:20,400 --> 00:00:23,840
your channel in track two and if there's

9
00:00:22,320 --> 00:00:25,680
time at the end i'll ask them but if not

10
00:00:23,840 --> 00:00:26,400
it'll make it very easy for you to go

11
00:00:25,680 --> 00:00:28,400
back

12
00:00:26,400 --> 00:00:30,640
so thank you both for joining and i'll

13
00:00:28,400 --> 00:00:33,280
turn it over to you

14
00:00:30,640 --> 00:00:36,079
all right thanks heather thanks everyone

15
00:00:33,280 --> 00:00:37,520
let's see it's our slide

16
00:00:36,079 --> 00:00:39,440
there we go awesome so thanks everyone

17
00:00:37,520 --> 00:00:42,160
for joining us virtually

18
00:00:39,440 --> 00:00:43,599
glad that we could still do this uh you

19
00:00:42,160 --> 00:00:45,360
know a little different than than usual

20
00:00:43,600 --> 00:00:46,000
when we're hanging out in texas in the

21
00:00:45,360 --> 00:00:47,519
heat

22
00:00:46,000 --> 00:00:49,200
so hopefully everyone is in the comfort

23
00:00:47,520 --> 00:00:50,960
of their air conditioning and uh good

24
00:00:49,200 --> 00:00:53,039
morning good afternoon good evening

25
00:00:50,960 --> 00:00:54,399
wherever you are super excited to be

26
00:00:53,039 --> 00:00:57,360
here as heather mentioned

27
00:00:54,399 --> 00:00:58,960
this is dave and ryan going to be going

28
00:00:57,360 --> 00:01:01,039
through a captain's log

29
00:00:58,960 --> 00:01:02,879
take your application log analysis from

30
00:01:01,039 --> 00:01:06,879
star fleet to star fleek

31
00:01:02,879 --> 00:01:06,878
at the sands dfir summit

32
00:01:07,119 --> 00:01:11,920
so ryan can go ahead and say hi everyone

33
00:01:10,240 --> 00:01:14,560
my name is ryan tomsick i'm

34
00:01:11,920 --> 00:01:15,520
a senior consultant on the mandaean ir

35
00:01:14,560 --> 00:01:18,080
team

36
00:01:15,520 --> 00:01:19,039
my background is as a sock analyst and

37
00:01:18,080 --> 00:01:21,360
threat hunter

38
00:01:19,040 --> 00:01:23,680
in different stock environments in the

39
00:01:21,360 --> 00:01:26,880
public and private sectors

40
00:01:23,680 --> 00:01:29,439
heavily leveraging splunk

41
00:01:26,880 --> 00:01:30,720
awesome thanks ryan my name is dave

42
00:01:29,439 --> 00:01:32,798
pannie i'm a manager

43
00:01:30,720 --> 00:01:34,079
at mandiant on the incident response and

44
00:01:32,799 --> 00:01:37,040
forensics team

45
00:01:34,079 --> 00:01:38,000
i have a background in doing for the

46
00:01:37,040 --> 00:01:40,079
purpose of this talk

47
00:01:38,000 --> 00:01:41,840
at least log analysis focusing a lot on

48
00:01:40,079 --> 00:01:42,639
excel and grep and python scripts and

49
00:01:41,840 --> 00:01:44,479
text and

50
00:01:42,640 --> 00:01:46,960
probably the the bad way to do log

51
00:01:44,479 --> 00:01:50,479
analysis but it's been a lot of fun

52
00:01:46,960 --> 00:01:53,520
um also more importantly ryan and i

53
00:01:50,479 --> 00:01:54,880
are co-creators of uh the organization

54
00:01:53,520 --> 00:01:57,360
defer

55
00:01:54,880 --> 00:01:59,439
so we'll talk about that this is a dog

56
00:01:57,360 --> 00:02:01,439
and feline urgent response

57
00:01:59,439 --> 00:02:03,119
we're probably the longest standing

58
00:02:01,439 --> 00:02:04,000
organization in the pet healthcare and

59
00:02:03,119 --> 00:02:05,840
wellness

60
00:02:04,000 --> 00:02:08,000
industry not only do we take care of

61
00:02:05,840 --> 00:02:09,840
dogs and felines we also take

62
00:02:08,000 --> 00:02:11,360
care of forensic gators and all kinds of

63
00:02:09,840 --> 00:02:12,640
other animals and wildlife that you may

64
00:02:11,360 --> 00:02:15,120
run into

65
00:02:12,640 --> 00:02:16,160
but we have an application that

66
00:02:15,120 --> 00:02:19,440
veterinarians

67
00:02:16,160 --> 00:02:20,959
use to process their records make

68
00:02:19,440 --> 00:02:22,800
appointments order care

69
00:02:20,959 --> 00:02:24,800
take care of their patients pets and

70
00:02:22,800 --> 00:02:26,160
wildlife use deferred to make

71
00:02:24,800 --> 00:02:28,720
appointments pay their bills

72
00:02:26,160 --> 00:02:29,280
see a labrador retriever test results

73
00:02:28,720 --> 00:02:32,319
all kinds of

74
00:02:29,280 --> 00:02:34,800
good labs insurance companies will use

75
00:02:32,319 --> 00:02:36,079
defer to receive and pay claims to

76
00:02:34,800 --> 00:02:37,840
veterinarians they'll reimburse

77
00:02:36,080 --> 00:02:40,560
patients for whatever they'll take care

78
00:02:37,840 --> 00:02:43,680
of all those costs on the d4 application

79
00:02:40,560 --> 00:02:46,560
and as of start 87405.8

80
00:02:43,680 --> 00:02:47,840
we are the official uh veterinary and

81
00:02:46,560 --> 00:02:49,680
pet wellness service

82
00:02:47,840 --> 00:02:50,879
of starfleet which we're pretty excited

83
00:02:49,680 --> 00:02:52,720
about

84
00:02:50,879 --> 00:02:54,399
and not only do ryan and i have this

85
00:02:52,720 --> 00:02:54,959
very important job of running and

86
00:02:54,400 --> 00:02:58,640
founding

87
00:02:54,959 --> 00:03:00,319
the the d for organization we also

88
00:02:58,640 --> 00:03:01,839
due to our day jobs we hang out on the

89
00:03:00,319 --> 00:03:03,839
security team and recently

90
00:03:01,840 --> 00:03:04,959
we took a look at the log sources that

91
00:03:03,840 --> 00:03:05,840
we were trying to use

92
00:03:04,959 --> 00:03:08,800
in case we needed them for

93
00:03:05,840 --> 00:03:10,720
investigations and wow we had a ton

94
00:03:08,800 --> 00:03:12,319
of problems identified so many problems

95
00:03:10,720 --> 00:03:13,440
we can't even talk about them but we'll

96
00:03:12,319 --> 00:03:15,760
focus in

97
00:03:13,440 --> 00:03:17,359
on the highest level ones that we want

98
00:03:15,760 --> 00:03:19,359
to take a look at

99
00:03:17,360 --> 00:03:21,680
up first we looked at some logs that had

100
00:03:19,360 --> 00:03:23,360
some incomplete data sources

101
00:03:21,680 --> 00:03:24,799
you would think that the log would be

102
00:03:23,360 --> 00:03:27,680
recording this activity or

103
00:03:24,799 --> 00:03:28,879
this field and the activity wrong wasn't

104
00:03:27,680 --> 00:03:31,040
there

105
00:03:28,879 --> 00:03:32,640
then we saw that certain logs were being

106
00:03:31,040 --> 00:03:33,359
ingested into our centralized log

107
00:03:32,640 --> 00:03:35,119
platform

108
00:03:33,360 --> 00:03:37,120
and they were being par strong there

109
00:03:35,120 --> 00:03:37,760
were json issues the field names were

110
00:03:37,120 --> 00:03:40,239
wrong

111
00:03:37,760 --> 00:03:41,679
all kinds of random issues that made

112
00:03:40,239 --> 00:03:42,720
looking at these aggregated logs which

113
00:03:41,680 --> 00:03:45,840
was supposed to be helpful

114
00:03:42,720 --> 00:03:47,519
made them actually quite

115
00:03:45,840 --> 00:03:49,840
the d4 application as mentioned has been

116
00:03:47,519 --> 00:03:51,440
around for quite some time

117
00:03:49,840 --> 00:03:53,280
and with that right the developers are

118
00:03:51,440 --> 00:03:54,159
making updates pushing new code changing

119
00:03:53,280 --> 00:03:56,080
things

120
00:03:54,159 --> 00:03:57,280
and sure enough there were a whole bunch

121
00:03:56,080 --> 00:03:58,640
of application updates

122
00:03:57,280 --> 00:04:00,799
they changed the way logging works we

123
00:03:58,640 --> 00:04:02,640
never never told us about it we never

124
00:04:00,799 --> 00:04:04,319
looked at them we never figured it out

125
00:04:02,640 --> 00:04:06,720
so the application updates broke some of

126
00:04:04,319 --> 00:04:07,920
our logs we took a look at some log

127
00:04:06,720 --> 00:04:10,480
sources

128
00:04:07,920 --> 00:04:11,839
that were coming from servers and

129
00:04:10,480 --> 00:04:14,079
systems around the world

130
00:04:11,840 --> 00:04:15,439
around the starfleet universe i guess

131
00:04:14,080 --> 00:04:17,840
and they were in all kinds of

132
00:04:15,439 --> 00:04:18,719
time zones some were utc some were

133
00:04:17,839 --> 00:04:20,238
eastern time

134
00:04:18,720 --> 00:04:22,000
some had no time zone and we have no

135
00:04:20,238 --> 00:04:24,880
idea what time zone they were in

136
00:04:22,000 --> 00:04:26,400
so that's another issue we ran into

137
00:04:24,880 --> 00:04:28,400
while we were doing these tests

138
00:04:26,400 --> 00:04:30,080
we tried to export for example an hour's

139
00:04:28,400 --> 00:04:31,758
worth of logs from a week ago

140
00:04:30,080 --> 00:04:33,359
took like two days to export just the

141
00:04:31,759 --> 00:04:34,160
log data that was really frustrating for

142
00:04:33,360 --> 00:04:37,199
us and

143
00:04:34,160 --> 00:04:37,520
something we wanted to fix and pretty

144
00:04:37,199 --> 00:04:39,280
much

145
00:04:37,520 --> 00:04:40,639
our worst defender was any time we tried

146
00:04:39,280 --> 00:04:41,919
to figure out

147
00:04:40,639 --> 00:04:44,000
where on the internet any of this

148
00:04:41,919 --> 00:04:46,880
activity came from all the source ip

149
00:04:44,000 --> 00:04:48,479
addresses were 10.10.10. whatever

150
00:04:46,880 --> 00:04:50,880
because we had a load balancer or a

151
00:04:48,479 --> 00:04:53,520
proxy masking all the traffic coming in

152
00:04:50,880 --> 00:04:55,120
that was really frustrating and you know

153
00:04:53,520 --> 00:04:57,280
there are some things that we we

154
00:04:55,120 --> 00:04:59,600
tried to focus on to be better going

155
00:04:57,280 --> 00:04:59,599
forward

156
00:04:59,840 --> 00:05:03,599
so in terms of you know our logs were

157
00:05:02,000 --> 00:05:06,479
pretty terrible but also

158
00:05:03,600 --> 00:05:07,520
we talked to the security team and the

159
00:05:06,479 --> 00:05:08,960
analysis was also

160
00:05:07,520 --> 00:05:11,039
not so great there was a lot of

161
00:05:08,960 --> 00:05:12,479
inconsistency everyone was doing

162
00:05:11,039 --> 00:05:14,639
analysis their own way

163
00:05:12,479 --> 00:05:16,159
some looked at the text logs parse them

164
00:05:14,639 --> 00:05:18,320
with the python script they made to use

165
00:05:16,160 --> 00:05:20,240
one time spent a bunch of time on

166
00:05:18,320 --> 00:05:21,680
others were ingesting logs into

167
00:05:20,240 --> 00:05:22,960
elasticsearch and trying to

168
00:05:21,680 --> 00:05:25,039
query them that way there was no

169
00:05:22,960 --> 00:05:26,239
consistency there was no repeatable

170
00:05:25,039 --> 00:05:29,840
process

171
00:05:26,240 --> 00:05:31,360
and it was just a recipe for failure

172
00:05:29,840 --> 00:05:33,919
with all those logs we mentioned all the

173
00:05:31,360 --> 00:05:35,759
updates there was also no documentation

174
00:05:33,919 --> 00:05:36,960
right so we would see a log field and we

175
00:05:35,759 --> 00:05:39,759
wouldn't know exactly

176
00:05:36,960 --> 00:05:40,638
what it meant was it a username was it a

177
00:05:39,759 --> 00:05:42,560
patient name

178
00:05:40,639 --> 00:05:44,880
was it a veterinarian's name we don't

179
00:05:42,560 --> 00:05:46,639
know what's going on here

180
00:05:44,880 --> 00:05:48,240
and we kind of boiled it down we figured

181
00:05:46,639 --> 00:05:50,080
out that

182
00:05:48,240 --> 00:05:51,280
a lot of this happened was because the

183
00:05:50,080 --> 00:05:53,359
application's

184
00:05:51,280 --> 00:05:55,280
logs were designed to troubleshoot the

185
00:05:53,360 --> 00:05:56,639
application by the developing

186
00:05:55,280 --> 00:05:58,318
team so they can make updates and make

187
00:05:56,639 --> 00:06:00,800
sure patients get good care but they

188
00:05:58,319 --> 00:06:03,039
weren't necessarily designed for

189
00:06:00,800 --> 00:06:04,479
investigating and our security team

190
00:06:03,039 --> 00:06:07,840
wasn't involved with that which led to

191
00:06:04,479 --> 00:06:07,840
these analysis problems

192
00:06:11,680 --> 00:06:18,319
oh no sorry about that

193
00:06:15,840 --> 00:06:19,919
so as a quick example i'm sure a lot of

194
00:06:18,319 --> 00:06:20,639
people in the audience have seen logs

195
00:06:19,919 --> 00:06:23,680
that look

196
00:06:20,639 --> 00:06:24,960
similar to this so on the left is an

197
00:06:23,680 --> 00:06:26,240
example of a tomcat

198
00:06:24,960 --> 00:06:28,479
error log right you're looking through

199
00:06:26,240 --> 00:06:30,639
web logs maybe someone's exploiting your

200
00:06:28,479 --> 00:06:33,919
stuff and this was the log we looked at

201
00:06:30,639 --> 00:06:35,919
and it's multi-line so you can't really

202
00:06:33,919 --> 00:06:36,960
grep and get the full context because

203
00:06:35,919 --> 00:06:38,240
you're gonna you know if you hit a

204
00:06:36,960 --> 00:06:39,840
search term in one of those exception

205
00:06:38,240 --> 00:06:41,440
blocks you're gonna miss the time stamp

206
00:06:39,840 --> 00:06:42,400
you're gonna miss the username etc like

207
00:06:41,440 --> 00:06:43,919
that

208
00:06:42,400 --> 00:06:45,758
uh and it's just it's ugly it's hard to

209
00:06:43,919 --> 00:06:46,240
look at it's hard to do much with other

210
00:06:45,759 --> 00:06:48,639
than

211
00:06:46,240 --> 00:06:49,680
tediously manually read them on the

212
00:06:48,639 --> 00:06:51,840
right side

213
00:06:49,680 --> 00:06:54,080
is what is pretty much just a super

214
00:06:51,840 --> 00:06:55,440
common export from a log analysis

215
00:06:54,080 --> 00:06:57,120
platform right

216
00:06:55,440 --> 00:06:58,639
there's probably everyone's probably run

217
00:06:57,120 --> 00:07:00,319
into this situation if they've exported

218
00:06:58,639 --> 00:07:02,240
logs from from their log platform we

219
00:07:00,319 --> 00:07:04,400
certainly did here at defer

220
00:07:02,240 --> 00:07:06,000
we said we need some log data from that

221
00:07:04,400 --> 00:07:06,560
week ago for an hour's worth of time

222
00:07:06,000 --> 00:07:10,000
frames

223
00:07:06,560 --> 00:07:11,599
and we got back an excel worksheet with

224
00:07:10,000 --> 00:07:13,599
hundreds of columns and they were all

225
00:07:11,599 --> 00:07:17,520
split out some were useful some were not

226
00:07:13,599 --> 00:07:20,080
we started with a went to bc to

227
00:07:17,520 --> 00:07:20,560
dz to fu and there were just all kinds

228
00:07:20,080 --> 00:07:22,159
of

229
00:07:20,560 --> 00:07:24,240
column numbers and letters and it was

230
00:07:22,160 --> 00:07:26,639
too much data how could anyone possibly

231
00:07:24,240 --> 00:07:28,080
deal with this and some of the other

232
00:07:26,639 --> 00:07:30,720
text logs we looked at

233
00:07:28,080 --> 00:07:32,080
have an example at the bottom these are

234
00:07:30,720 --> 00:07:34,160
some examples of the worst case

235
00:07:32,080 --> 00:07:35,120
offenders of timestamps that ryan and i

236
00:07:34,160 --> 00:07:38,560
have seen

237
00:07:35,120 --> 00:07:40,479
at our time at d4 right so

238
00:07:38,560 --> 00:07:41,840
how can you possibly sort these if you

239
00:07:40,479 --> 00:07:43,440
wanted to put them in excel

240
00:07:41,840 --> 00:07:45,679
they're not really alphabetic it's a

241
00:07:43,440 --> 00:07:47,520
pain to parse because there's not a

242
00:07:45,680 --> 00:07:47,759
consistent character length because of

243
00:07:47,520 --> 00:07:49,919
the

244
00:07:47,759 --> 00:07:51,280
the names of the days are in there the

245
00:07:49,919 --> 00:07:53,680
time stamps are in

246
00:07:51,280 --> 00:07:54,719
am and pm so if you want to convert from

247
00:07:53,680 --> 00:07:57,360
pm

248
00:07:54,720 --> 00:07:59,599
uh to you know the military time 24 hour

249
00:07:57,360 --> 00:08:01,840
time that can be a lot of a hassle

250
00:07:59,599 --> 00:08:03,360
and there's no time zones indicated in

251
00:08:01,840 --> 00:08:06,080
these logs

252
00:08:03,360 --> 00:08:07,599
so just some examples of frustrations

253
00:08:06,080 --> 00:08:12,080
that we ran into that you may have seen

254
00:08:07,599 --> 00:08:14,080
yourself when looking at your logs

255
00:08:12,080 --> 00:08:17,198
how in the world do we get these logs up

256
00:08:14,080 --> 00:08:18,800
to fleek standards

257
00:08:17,199 --> 00:08:20,080
there are some more straightforward i

258
00:08:18,800 --> 00:08:20,960
don't want to say quick wins but

259
00:08:20,080 --> 00:08:22,479
straightforward

260
00:08:20,960 --> 00:08:24,400
things right everything we talked about

261
00:08:22,479 --> 00:08:26,639
time zones parsing formatting

262
00:08:24,400 --> 00:08:28,318
those should be addressed for sure get

263
00:08:26,639 --> 00:08:31,360
everything into a nice uh

264
00:08:28,319 --> 00:08:32,800
time stamps into like yyyy mmdd hour

265
00:08:31,360 --> 00:08:34,640
hour minute minute second seconds you

266
00:08:32,799 --> 00:08:36,880
can sort them you can look at them

267
00:08:34,640 --> 00:08:38,559
time zones included clearly fix those

268
00:08:36,880 --> 00:08:41,760
json parsing errors and

269
00:08:38,559 --> 00:08:43,598
the log centralization platform

270
00:08:41,760 --> 00:08:45,040
for anything that's not centralized

271
00:08:43,599 --> 00:08:46,720
let's try and get a centralized so we

272
00:08:45,040 --> 00:08:47,839
can do some correlation and analytics

273
00:08:46,720 --> 00:08:50,320
and we'll talk about that

274
00:08:47,839 --> 00:08:51,839
in a bit um but those are some of the

275
00:08:50,320 --> 00:08:54,399
more straightforward yes we can

276
00:08:51,839 --> 00:08:56,240
or cannot do these types of approaches

277
00:08:54,399 --> 00:08:57,920
one thing that requires

278
00:08:56,240 --> 00:09:00,560
a little bit more effort and

279
00:08:57,920 --> 00:09:02,719
collaboration with the development team

280
00:09:00,560 --> 00:09:05,119
is trying to figure out what logs do we

281
00:09:02,720 --> 00:09:07,360
even want for an investigation

282
00:09:05,120 --> 00:09:09,360
in these application logs what's useful

283
00:09:07,360 --> 00:09:11,760
what's not and how does that relate to

284
00:09:09,360 --> 00:09:12,720
the security mission we have as part of

285
00:09:11,760 --> 00:09:16,640
the infosec team

286
00:09:12,720 --> 00:09:18,080
at defer so we're going to talk about

287
00:09:16,640 --> 00:09:21,120
this with the concept of

288
00:09:18,080 --> 00:09:22,720
threat modeling so at defer what types

289
00:09:21,120 --> 00:09:24,560
of threats do we face

290
00:09:22,720 --> 00:09:25,920
at our organization do our competitors

291
00:09:24,560 --> 00:09:29,040
and colleagues face

292
00:09:25,920 --> 00:09:30,399
and how might those attacks happen how

293
00:09:29,040 --> 00:09:31,839
would they work what would they do what

294
00:09:30,399 --> 00:09:35,200
would they go after

295
00:09:31,839 --> 00:09:38,240
what type of data would they access

296
00:09:35,200 --> 00:09:39,920
um and then if those threats and attacks

297
00:09:38,240 --> 00:09:42,000
did happen

298
00:09:39,920 --> 00:09:43,439
what kind of log data would you like to

299
00:09:42,000 --> 00:09:48,560
have what questions

300
00:09:43,440 --> 00:09:48,560
would we be required to answer due to

301
00:09:49,279 --> 00:09:53,920
regulations to tell our lawyers to tell

302
00:09:52,000 --> 00:09:54,640
our board members our shareholders the

303
00:09:53,920 --> 00:09:57,279
public

304
00:09:54,640 --> 00:09:58,880
right this information is going to be

305
00:09:57,279 --> 00:10:00,480
needed as part of an investigation

306
00:09:58,880 --> 00:10:02,000
it would be really hard to just say

307
00:10:00,480 --> 00:10:03,600
sorry our logs were trash

308
00:10:02,000 --> 00:10:05,440
we couldn't tell you these if even if we

309
00:10:03,600 --> 00:10:07,040
wanted to so that's kind of how we

310
00:10:05,440 --> 00:10:09,040
stepped back and figure out

311
00:10:07,040 --> 00:10:12,640
what's the point of even having logs for

312
00:10:09,040 --> 00:10:12,640
this application for an investigation

313
00:10:13,920 --> 00:10:17,839
so what we identified for our specific

314
00:10:16,399 --> 00:10:18,720
application is a couple different threat

315
00:10:17,839 --> 00:10:20,720
vectors

316
00:10:18,720 --> 00:10:22,480
that we wanted to try to simulate and

317
00:10:20,720 --> 00:10:24,240
model

318
00:10:22,480 --> 00:10:26,560
most of them were related to an account

319
00:10:24,240 --> 00:10:28,480
takeover so if

320
00:10:26,560 --> 00:10:30,239
you know a kitty or a puppy or a

321
00:10:28,480 --> 00:10:31,040
veterinarian or an insurance provider

322
00:10:30,240 --> 00:10:32,880
had their

323
00:10:31,040 --> 00:10:34,959
account taken over either as a result of

324
00:10:32,880 --> 00:10:36,560
a credential stuffing campaign which are

325
00:10:34,959 --> 00:10:37,119
all the rage these days i'm sure lots of

326
00:10:36,560 --> 00:10:39,119
people are

327
00:10:37,120 --> 00:10:40,959
running into those brute force attacks

328
00:10:39,120 --> 00:10:41,519
or one off they got fished and then

329
00:10:40,959 --> 00:10:44,640
someone

330
00:10:41,519 --> 00:10:46,160
logged on fish can also be treated at

331
00:10:44,640 --> 00:10:48,240
differ by the way so

332
00:10:46,160 --> 00:10:49,680
phishing attacks are very common bring

333
00:10:48,240 --> 00:10:51,440
your fish in to defer

334
00:10:49,680 --> 00:10:53,359
but anyway these account takeover

335
00:10:51,440 --> 00:10:56,800
attacks you can bring them in

336
00:10:53,360 --> 00:10:59,279
and and do a lot of damage

337
00:10:56,800 --> 00:11:00,560
if you have your account taken over for

338
00:10:59,279 --> 00:11:01,439
example you can have your bank account

339
00:11:00,560 --> 00:11:03,760
modified so

340
00:11:01,440 --> 00:11:05,440
a payment or a claim or reimbursement

341
00:11:03,760 --> 00:11:07,040
might go to the wrong place

342
00:11:05,440 --> 00:11:09,200
your pet health information your pet

343
00:11:07,040 --> 00:11:11,120
identifying information

344
00:11:09,200 --> 00:11:13,440
might get accessed that would be a major

345
00:11:11,120 --> 00:11:14,160
hippo violation so we don't want any of

346
00:11:13,440 --> 00:11:16,000
that

347
00:11:14,160 --> 00:11:17,920
because there'd be fines and regulations

348
00:11:16,000 --> 00:11:20,959
to deal with and worst case

349
00:11:17,920 --> 00:11:21,680
right someone could have their uh their

350
00:11:20,959 --> 00:11:23,839
health

351
00:11:21,680 --> 00:11:24,959
treatment modified or interrupted cancel

352
00:11:23,839 --> 00:11:26,959
someone's appointment

353
00:11:24,959 --> 00:11:29,439
a veterinarian could log on and change a

354
00:11:26,959 --> 00:11:30,800
dose of a prescription

355
00:11:29,440 --> 00:11:32,640
you don't want to apply too little or

356
00:11:30,800 --> 00:11:34,479
too much flea or tick prevention that

357
00:11:32,640 --> 00:11:37,199
would be really bad either way

358
00:11:34,480 --> 00:11:38,720
and back to the finance side rate

359
00:11:37,200 --> 00:11:41,360
reimbursement claims

360
00:11:38,720 --> 00:11:43,040
payments hsa accounts things like that

361
00:11:41,360 --> 00:11:46,160
and also

362
00:11:43,040 --> 00:11:48,959
probably the last threat modeling

363
00:11:46,160 --> 00:11:50,319
technique that we saw was um if a

364
00:11:48,959 --> 00:11:52,079
veterinarian would abuse the healthcare

365
00:11:50,320 --> 00:11:54,000
system and for example overprescribe

366
00:11:52,079 --> 00:11:56,000
narcotics such as catnip we don't want

367
00:11:54,000 --> 00:11:58,959
any of that being facilitated

368
00:11:56,000 --> 00:11:58,959
through defer

369
00:12:01,279 --> 00:12:05,839
i clicked there we go so how do we

370
00:12:04,240 --> 00:12:07,600
figure out what's lacking and what we

371
00:12:05,839 --> 00:12:10,000
need to improve on

372
00:12:07,600 --> 00:12:11,279
probably the best ways to review you

373
00:12:10,000 --> 00:12:11,839
know your current log setup and we did

374
00:12:11,279 --> 00:12:14,000
this we

375
00:12:11,839 --> 00:12:15,200
tried to export the logs we tried to

376
00:12:14,000 --> 00:12:16,240
search through them we tried to

377
00:12:15,200 --> 00:12:18,000
correlate in format

378
00:12:16,240 --> 00:12:19,920
and there were a lot of annoying steps

379
00:12:18,000 --> 00:12:21,680
that we identified along the way where

380
00:12:19,920 --> 00:12:23,920
it wasn't formatted properly

381
00:12:21,680 --> 00:12:26,560
we wish there was a session id to map a

382
00:12:23,920 --> 00:12:28,319
log on to a data access log for example

383
00:12:26,560 --> 00:12:29,680
and exporting took too long all these

384
00:12:28,320 --> 00:12:31,600
things we could only

385
00:12:29,680 --> 00:12:35,279
discover were real problems by

386
00:12:31,600 --> 00:12:35,279
simulating an investigation

387
00:12:35,360 --> 00:12:38,720
because the logs should have the answers

388
00:12:36,800 --> 00:12:40,880
to all the questions you would need to

389
00:12:38,720 --> 00:12:42,800
answer

390
00:12:40,880 --> 00:12:44,399
so let's say we do this exercise right

391
00:12:42,800 --> 00:12:45,760
because we simulate this investigation

392
00:12:44,399 --> 00:12:47,760
what's next for defer

393
00:12:45,760 --> 00:12:49,760
what do we want to do with our logs well

394
00:12:47,760 --> 00:12:51,680
first up is to make sure they're

395
00:12:49,760 --> 00:12:53,120
configured properly on the application

396
00:12:51,680 --> 00:12:54,719
they'll be stored locally

397
00:12:53,120 --> 00:12:56,720
and that will be a gold mine for

398
00:12:54,720 --> 00:12:58,000
investigators to have on the local

399
00:12:56,720 --> 00:13:00,480
application servers

400
00:12:58,000 --> 00:13:02,320
a couple limitations though are that the

401
00:13:00,480 --> 00:13:04,320
investigator has to know which system to

402
00:13:02,320 --> 00:13:05,680
log on to to get those local logs

403
00:13:04,320 --> 00:13:07,120
what accounts do they use are they

404
00:13:05,680 --> 00:13:08,079
protected do they have to check them out

405
00:13:07,120 --> 00:13:11,040
out of

406
00:13:08,079 --> 00:13:12,638
pam solution and how long are those logs

407
00:13:11,040 --> 00:13:14,800
going to be retained for

408
00:13:12,639 --> 00:13:16,560
kind of the best practice approach might

409
00:13:14,800 --> 00:13:19,519
be to centralize those logs

410
00:13:16,560 --> 00:13:20,000
and bring them to a log aggregation and

411
00:13:19,519 --> 00:13:21,440
analysis

412
00:13:20,000 --> 00:13:23,279
platform ryan's going to talk about that

413
00:13:21,440 --> 00:13:25,040
in a second uh

414
00:13:23,279 --> 00:13:26,639
because you can do a lot there's you can

415
00:13:25,040 --> 00:13:28,000
have detection functionality alerting

416
00:13:26,639 --> 00:13:29,920
monitoring

417
00:13:28,000 --> 00:13:31,120
but usually that the biggest reason i

418
00:13:29,920 --> 00:13:32,560
think that we are struggling with that

419
00:13:31,120 --> 00:13:34,240
at d4 is it's a lot of cost right

420
00:13:32,560 --> 00:13:37,839
everyone has to deal with costs

421
00:13:34,240 --> 00:13:37,839
and we want to be mindful of that

422
00:13:37,920 --> 00:13:41,599
but if you can get these logs into your

423
00:13:40,880 --> 00:13:44,000
analysis

424
00:13:41,600 --> 00:13:46,000
platform you can make your logs work for

425
00:13:44,000 --> 00:13:48,560
you you don't have to do the work

426
00:13:46,000 --> 00:13:50,079
and comb through your logs you can have

427
00:13:48,560 --> 00:13:51,040
your logs tell you what you want to know

428
00:13:50,079 --> 00:13:53,040
with a little bit of

429
00:13:51,040 --> 00:13:55,040
development effort up front so for

430
00:13:53,040 --> 00:13:56,560
example we mentioned alerting

431
00:13:55,040 --> 00:13:58,399
disalert anytime a law gets a certain

432
00:13:56,560 --> 00:14:01,439
piece of criteria hard to do that with

433
00:13:58,399 --> 00:14:02,880
with local logging

434
00:14:01,440 --> 00:14:04,639
some of the things we like to do are

435
00:14:02,880 --> 00:14:06,320
visualize any type of information

436
00:14:04,639 --> 00:14:08,160
you want to see you want to see red

437
00:14:06,320 --> 00:14:10,079
stuffing attacks make a visualization of

438
00:14:08,160 --> 00:14:12,000
log on attempts over time you'll clearly

439
00:14:10,079 --> 00:14:13,680
see when things are way off of their

440
00:14:12,000 --> 00:14:14,959
their baseline

441
00:14:13,680 --> 00:14:16,638
one of the neatest things that ryan's

442
00:14:14,959 --> 00:14:18,560
going to run through are creating easy

443
00:14:16,639 --> 00:14:19,199
to follow investigation workflows that

444
00:14:18,560 --> 00:14:21,599
you can

445
00:14:19,199 --> 00:14:22,719
document create playbooks for and then

446
00:14:21,600 --> 00:14:24,240
any analyst can say

447
00:14:22,720 --> 00:14:25,839
we have this account takeover scenario

448
00:14:24,240 --> 00:14:27,600
here are the steps i go to here's the

449
00:14:25,839 --> 00:14:29,519
dashboard i look at here the

450
00:14:27,600 --> 00:14:31,360
the correlations i want to check in on

451
00:14:29,519 --> 00:14:32,800
so you can do really a ton if you sink

452
00:14:31,360 --> 00:14:35,040
some dev time in up front and get these

453
00:14:32,800 --> 00:14:36,319
logs ingested properly

454
00:14:35,040 --> 00:14:38,800
some of the neat visualizations that

455
00:14:36,320 --> 00:14:41,600
we've we've seen and we've worked on

456
00:14:38,800 --> 00:14:42,560
maps graphs tables i love a good heat

457
00:14:41,600 --> 00:14:44,320
map

458
00:14:42,560 --> 00:14:46,000
and really they they kind of give you a

459
00:14:44,320 --> 00:14:46,480
sense for what's going on without having

460
00:14:46,000 --> 00:14:48,000
to

461
00:14:46,480 --> 00:14:50,880
scroll really fast and hope your eye

462
00:14:48,000 --> 00:14:52,240
catches something after 700 000 lines of

463
00:14:50,880 --> 00:14:54,079
log data

464
00:14:52,240 --> 00:14:55,279
so those are kind of things that that we

465
00:14:54,079 --> 00:14:59,839
work through

466
00:14:55,279 --> 00:14:59,839
at defer

467
00:14:59,920 --> 00:15:03,279
now ryan's going to take it away

468
00:15:05,199 --> 00:15:07,839
let's see do i have the ability to

469
00:15:06,730 --> 00:15:10,639
[Music]

470
00:15:07,839 --> 00:15:14,160
modify the slides

471
00:15:10,639 --> 00:15:16,160
or work the presentation ryan it says

472
00:15:14,160 --> 00:15:18,480
i'm still controlling the screen

473
00:15:16,160 --> 00:15:21,120
so i'm not sure if heather or corrigan

474
00:15:18,480 --> 00:15:21,120
can switch

475
00:15:24,639 --> 00:15:27,839
there you go give that a try

476
00:15:32,079 --> 00:15:39,120
you good ryan yeah let me get the timing

477
00:15:35,920 --> 00:15:40,959
okay cool great all right so for anyone

478
00:15:39,120 --> 00:15:43,519
who's not familiar with splunk

479
00:15:40,959 --> 00:15:45,439
it's a log aggregation analysis platform

480
00:15:43,519 --> 00:15:48,720
with pretty broad application across

481
00:15:45,440 --> 00:15:52,240
itunes security uh it's also like a

482
00:15:48,720 --> 00:15:53,600
kitchen where its usefulness is

483
00:15:52,240 --> 00:15:55,279
you know related to the amount of time

484
00:15:53,600 --> 00:15:57,680
and resources that you uh

485
00:15:55,279 --> 00:15:59,279
invest into it and sometimes you can

486
00:15:57,680 --> 00:16:02,000
still burn the turkey

487
00:15:59,279 --> 00:16:03,439
so when we're dropped into an active

488
00:16:02,000 --> 00:16:05,680
response scenario

489
00:16:03,440 --> 00:16:08,399
where splunk's deployed we're typically

490
00:16:05,680 --> 00:16:08,800
only given you know basic web access to

491
00:16:08,399 --> 00:16:10,720
a

492
00:16:08,800 --> 00:16:12,160
splunk search head and we really don't

493
00:16:10,720 --> 00:16:14,480
have the the time

494
00:16:12,160 --> 00:16:16,800
to create advanced visualizations and

495
00:16:14,480 --> 00:16:18,480
use fancy things like splunk js

496
00:16:16,800 --> 00:16:19,680
so everything that we create in all the

497
00:16:18,480 --> 00:16:20,959
dashboards that i'm going to be showing

498
00:16:19,680 --> 00:16:24,079
in the upcoming slides

499
00:16:20,959 --> 00:16:26,638
were created using simplexml

500
00:16:24,079 --> 00:16:28,399
leveraging dynamic tokens and also

501
00:16:26,639 --> 00:16:30,320
drilldown actions that

502
00:16:28,399 --> 00:16:33,519
automatically open up a new dashboard

503
00:16:30,320 --> 00:16:36,399
and then populate that that token data

504
00:16:33,519 --> 00:16:38,240
so the underlying data the demo is

505
00:16:36,399 --> 00:16:41,519
authentication login activity

506
00:16:38,240 --> 00:16:44,399
and also database transactions that are

507
00:16:41,519 --> 00:16:47,440
recorded based on the user actions

508
00:16:44,399 --> 00:16:49,440
within the d4 application and we also

509
00:16:47,440 --> 00:16:51,279
have database lookup type commands that

510
00:16:49,440 --> 00:16:52,480
provide linkages between different data

511
00:16:51,279 --> 00:16:54,880
elements

512
00:16:52,480 --> 00:16:56,160
such as the number of users or the users

513
00:16:54,880 --> 00:17:00,079
who are assigned to a particular

514
00:16:56,160 --> 00:17:00,079
organization so

515
00:17:01,120 --> 00:17:05,599
it's monday morning i'm a d4 analyst i

516
00:17:04,000 --> 00:17:07,839
make my pour over coffee

517
00:17:05,599 --> 00:17:10,159
and i grab my red bull chaser i'm

518
00:17:07,839 --> 00:17:11,918
logging into the splunk dashboard

519
00:17:10,160 --> 00:17:13,760
that shows all the modern analytics that

520
00:17:11,919 --> 00:17:15,600
were pre-built for me

521
00:17:13,760 --> 00:17:17,359
uh that provide those fancy you know

522
00:17:15,599 --> 00:17:20,159
configurations to allow me to open up

523
00:17:17,359 --> 00:17:22,559
new dashboards with the token values

524
00:17:20,160 --> 00:17:23,919
since all of our you know customer base

525
00:17:22,559 --> 00:17:24,959
on the provider side is based in the

526
00:17:23,919 --> 00:17:27,439
united states

527
00:17:24,959 --> 00:17:29,039
i may be interested in seeing which

528
00:17:27,439 --> 00:17:32,240
users are logging in from

529
00:17:29,039 --> 00:17:32,720
you know non-us based ip addresses i'm

530
00:17:32,240 --> 00:17:34,640
also

531
00:17:32,720 --> 00:17:36,799
interested in looking at users who are

532
00:17:34,640 --> 00:17:38,720
logging in from more than one state

533
00:17:36,799 --> 00:17:40,080
which might indicate the use of a vpn

534
00:17:38,720 --> 00:17:43,840
server or

535
00:17:40,080 --> 00:17:46,399
anonymizer service i'm also interested

536
00:17:43,840 --> 00:17:48,480
in any users that are requesting you

537
00:17:46,400 --> 00:17:50,160
know username reminders or password

538
00:17:48,480 --> 00:17:52,080
resets because that could kind of be the

539
00:17:50,160 --> 00:17:56,000
canary in the coal mine

540
00:17:52,080 --> 00:17:56,000
for a potential account takeover

541
00:17:57,440 --> 00:18:02,400
now all of our providers generally

542
00:17:59,440 --> 00:18:04,559
follow a nine to five work schedule

543
00:18:02,400 --> 00:18:05,840
so i may want to look for anyone who's

544
00:18:04,559 --> 00:18:08,480
logging in you know either

545
00:18:05,840 --> 00:18:10,879
very late at night or very early in the

546
00:18:08,480 --> 00:18:10,880
morning

547
00:18:13,039 --> 00:18:18,240
and as far as potential password attack

548
00:18:15,120 --> 00:18:21,039
activity i'm i'm interested in seeing

549
00:18:18,240 --> 00:18:21,600
um looking at it from a user specific

550
00:18:21,039 --> 00:18:23,679
point of view

551
00:18:21,600 --> 00:18:24,719
uh in case there's you know a botnet

552
00:18:23,679 --> 00:18:27,360
being leveraged that's

553
00:18:24,720 --> 00:18:28,000
attempting to brute force an account um

554
00:18:27,360 --> 00:18:31,039
you know from

555
00:18:28,000 --> 00:18:32,480
multiple ip addresses uh so this these

556
00:18:31,039 --> 00:18:33,520
two little fields up here give us the

557
00:18:32,480 --> 00:18:35,600
ability to establish

558
00:18:33,520 --> 00:18:37,200
thresholds for you know failed attempts

559
00:18:35,600 --> 00:18:39,439
or successful attempts

560
00:18:37,200 --> 00:18:41,360
and we can also focus on the portal

561
00:18:39,440 --> 00:18:43,840
whether it's the provider or the patient

562
00:18:41,360 --> 00:18:43,840
portal

563
00:18:45,280 --> 00:18:48,879
now taking a look at another angle of

564
00:18:47,280 --> 00:18:49,760
detecting potential password attack

565
00:18:48,880 --> 00:18:51,840
activity

566
00:18:49,760 --> 00:18:52,960
we're also looking at ip addresses per

567
00:18:51,840 --> 00:18:55,760
calendar day

568
00:18:52,960 --> 00:18:56,960
and we're enriching this table with you

569
00:18:55,760 --> 00:18:58,960
know the the

570
00:18:56,960 --> 00:19:00,720
geolocation information for the ip

571
00:18:58,960 --> 00:19:01,760
address and also the autonomous system

572
00:19:00,720 --> 00:19:03,520
information

573
00:19:01,760 --> 00:19:05,360
uh we're looking at the you know user

574
00:19:03,520 --> 00:19:08,639
agent and also including some

575
00:19:05,360 --> 00:19:10,320
different uh metrics on you know the the

576
00:19:08,640 --> 00:19:12,080
type of failure that occurred with the

577
00:19:10,320 --> 00:19:16,720
account whether it was related to

578
00:19:12,080 --> 00:19:16,720
invalid accounts or bad passwords

579
00:19:19,440 --> 00:19:22,880
and we're also leveraging the haverseen

580
00:19:21,039 --> 00:19:25,679
function to show

581
00:19:22,880 --> 00:19:27,200
any accounts that you know show

582
00:19:25,679 --> 00:19:30,000
anomalous activity

583
00:19:27,200 --> 00:19:31,840
between sequential logins based on the

584
00:19:30,000 --> 00:19:38,160
ip addresses the source of the addresses

585
00:19:31,840 --> 00:19:39,840
of the authentication

586
00:19:38,160 --> 00:19:41,360
and we're also looking at any users who

587
00:19:39,840 --> 00:19:42,159
are logging in from multiple autonomous

588
00:19:41,360 --> 00:19:45,120
system names

589
00:19:42,160 --> 00:19:46,880
most of our providers they use some type

590
00:19:45,120 --> 00:19:49,199
of isp that provides

591
00:19:46,880 --> 00:19:51,280
business level services or supports so

592
00:19:49,200 --> 00:19:56,400
to see someone logging in from a

593
00:19:51,280 --> 00:19:56,399
vpn would be a little anomalous for us

594
00:19:57,760 --> 00:20:01,280
as far as organization analytics what

595
00:20:00,240 --> 00:20:04,159
we're looking for

596
00:20:01,280 --> 00:20:05,760
is any user who's logging in from a

597
00:20:04,159 --> 00:20:08,320
source ip address that's

598
00:20:05,760 --> 00:20:10,400
inconsistent with the mailing address of

599
00:20:08,320 --> 00:20:12,799
the entity that they're assigned to

600
00:20:10,400 --> 00:20:14,080
and we're also doing a similar check for

601
00:20:12,799 --> 00:20:15,280
any organizations

602
00:20:14,080 --> 00:20:17,439
you know at the time that they're being

603
00:20:15,280 --> 00:20:19,360
registered we're performing the same

604
00:20:17,440 --> 00:20:20,799
check to determine if the mailing state

605
00:20:19,360 --> 00:20:21,760
that's provided when the organization is

606
00:20:20,799 --> 00:20:23,520
registered

607
00:20:21,760 --> 00:20:26,720
matches up with the source ip address of

608
00:20:23,520 --> 00:20:28,320
the user who's registering it

609
00:20:26,720 --> 00:20:30,480
and we also leverage custom python

610
00:20:28,320 --> 00:20:32,158
scripts to interact with

611
00:20:30,480 --> 00:20:34,799
public apis they perform external

612
00:20:32,159 --> 00:20:35,200
lookups so here at defer what we did was

613
00:20:34,799 --> 00:20:37,280
we

614
00:20:35,200 --> 00:20:39,120
created a custom python script that

615
00:20:37,280 --> 00:20:42,399
leverages an external lookup

616
00:20:39,120 --> 00:20:45,199
and it compares the npes data from the

617
00:20:42,400 --> 00:20:47,280
hhs database that's available publicly

618
00:20:45,200 --> 00:20:48,000
it pulls it down and compares it to the

619
00:20:47,280 --> 00:20:50,720
information

620
00:20:48,000 --> 00:20:51,840
that's provided for an organization at

621
00:20:50,720 --> 00:20:52,400
the time it's registered whether

622
00:20:51,840 --> 00:20:55,280
campaign

623
00:20:52,400 --> 00:20:56,720
compares the uh organization name the

624
00:20:55,280 --> 00:20:58,399
entity city the uh

625
00:20:56,720 --> 00:21:00,080
the state so on and so forth and this

626
00:20:58,400 --> 00:21:03,840
helps us detect any fraudulent

627
00:21:00,080 --> 00:21:03,840
organizations that are being registered

628
00:21:05,760 --> 00:21:10,559
we built some user analytics that help

629
00:21:07,679 --> 00:21:14,080
us detect some anonymous user activity

630
00:21:10,559 --> 00:21:16,879
for example we had an account takeover

631
00:21:14,080 --> 00:21:18,080
incident where you know the attack was

632
00:21:16,880 --> 00:21:19,840
performing this repeated

633
00:21:18,080 --> 00:21:21,360
these repeated actions you know over and

634
00:21:19,840 --> 00:21:22,639
over again where they would perform a

635
00:21:21,360 --> 00:21:24,559
username reminder

636
00:21:22,640 --> 00:21:26,240
and then a password reset and then they

637
00:21:24,559 --> 00:21:27,520
would add a bank account and register it

638
00:21:26,240 --> 00:21:29,919
with the insurance provider

639
00:21:27,520 --> 00:21:32,000
also in a very short period of time so

640
00:21:29,919 --> 00:21:34,320
we created this analytic that leverages

641
00:21:32,000 --> 00:21:36,400
a transaction command that helps us to

642
00:21:34,320 --> 00:21:38,480
cluster that activity together

643
00:21:36,400 --> 00:21:41,200
and see where you know may be occurring

644
00:21:38,480 --> 00:21:41,200
in our environment

645
00:21:43,120 --> 00:21:46,559
and then finally we have access to the

646
00:21:44,880 --> 00:21:48,640
american bankers association

647
00:21:46,559 --> 00:21:49,678
uh you know registration key for for

648
00:21:48,640 --> 00:21:52,000
banking account

649
00:21:49,679 --> 00:21:54,159
routing numbers so that helps us compare

650
00:21:52,000 --> 00:21:55,440
the state or the region associated with

651
00:21:54,159 --> 00:21:58,240
an account number

652
00:21:55,440 --> 00:21:59,120
uh to the provider state or location

653
00:21:58,240 --> 00:22:01,840
determine if they're

654
00:21:59,120 --> 00:22:01,840
inconsistent

655
00:22:03,440 --> 00:22:07,360
and then finally we have a tab for watch

656
00:22:05,679 --> 00:22:09,760
lists if we want to track or elevate the

657
00:22:07,360 --> 00:22:10,959
visibility of certain organizations or

658
00:22:09,760 --> 00:22:13,200
user accounts

659
00:22:10,960 --> 00:22:14,480
or ip addresses so we have a separate

660
00:22:13,200 --> 00:22:17,440
tab here for more

661
00:22:14,480 --> 00:22:17,440
focused monitoring

662
00:22:19,039 --> 00:22:22,320
all right so here we are it's later on

663
00:22:21,200 --> 00:22:24,159
on monday morning

664
00:22:22,320 --> 00:22:26,799
i'm going to be grinding up another 23

665
00:22:24,159 --> 00:22:29,039
grams of gucci ethiopia coffee beans

666
00:22:26,799 --> 00:22:30,720
and i get that notification from our

667
00:22:29,039 --> 00:22:32,158
customer service team they say that

668
00:22:30,720 --> 00:22:34,080
one of the providers hasn't been

669
00:22:32,159 --> 00:22:35,679
receiving claims payments

670
00:22:34,080 --> 00:22:37,760
and they logged into their account and

671
00:22:35,679 --> 00:22:39,280
they verified that banking information

672
00:22:37,760 --> 00:22:40,640
is just not correct and they just don't

673
00:22:39,280 --> 00:22:43,360
know what happened so they're asking us

674
00:22:40,640 --> 00:22:43,360
to look into it

675
00:22:43,679 --> 00:22:48,080
so open up a new dashboard and what i

676
00:22:46,640 --> 00:22:49,200
it's the user activity enrichment

677
00:22:48,080 --> 00:22:50,720
dashboard

678
00:22:49,200 --> 00:22:52,320
and what this does is it pulls in

679
00:22:50,720 --> 00:22:54,240
information from our user database it

680
00:22:52,320 --> 00:22:55,760
provides things like the email address

681
00:22:54,240 --> 00:22:57,440
some time stamps associated with the

682
00:22:55,760 --> 00:22:59,440
account metadata

683
00:22:57,440 --> 00:23:00,880
and also shows the entities that are

684
00:22:59,440 --> 00:23:02,320
associated with this particular user

685
00:23:00,880 --> 00:23:03,600
account so in this case we can see that

686
00:23:02,320 --> 00:23:05,760
it's assigned to

687
00:23:03,600 --> 00:23:07,120
an entity called archaeology associates

688
00:23:05,760 --> 00:23:10,320
which is a

689
00:23:07,120 --> 00:23:10,320
speech therapy provider

690
00:23:11,120 --> 00:23:14,399
so scrolling down we want to look at the

691
00:23:12,960 --> 00:23:16,000
remote access analytics

692
00:23:14,400 --> 00:23:17,679
of this particular user account over the

693
00:23:16,000 --> 00:23:19,760
past week or so

694
00:23:17,679 --> 00:23:22,240
and we can see that there was a username

695
00:23:19,760 --> 00:23:25,760
reminder and a password reset for

696
00:23:22,240 --> 00:23:28,559
this account uh happening on june 29th

697
00:23:25,760 --> 00:23:29,760
from a 103 ipip address based in

698
00:23:28,559 --> 00:23:33,760
indonesia

699
00:23:29,760 --> 00:23:36,080
and then shortly thereafter we saw

700
00:23:33,760 --> 00:23:36,960
the user login or the user account being

701
00:23:36,080 --> 00:23:39,760
used to log in

702
00:23:36,960 --> 00:23:41,039
from that ip address we also see a

703
00:23:39,760 --> 00:23:44,158
little hit on this

704
00:23:41,039 --> 00:23:46,080
harrison distance function but with what

705
00:23:44,159 --> 00:23:47,120
scotty tells me about beaming people i

706
00:23:46,080 --> 00:23:48,399
think that this

707
00:23:47,120 --> 00:23:51,840
haverseen function is going to become

708
00:23:48,400 --> 00:23:51,840
pretty useless

709
00:23:53,520 --> 00:23:58,960
so we're going to shift over to the

710
00:23:56,400 --> 00:24:01,600
another tab that shows the timeline

711
00:23:58,960 --> 00:24:03,679
of the user activity so i want to see

712
00:24:01,600 --> 00:24:04,799
any actions that were performed by the

713
00:24:03,679 --> 00:24:07,760
user while they were logged in from the

714
00:24:04,799 --> 00:24:09,360
103 so i'm going to click on it

715
00:24:07,760 --> 00:24:10,799
which is going to automatically filter

716
00:24:09,360 --> 00:24:12,719
our timeline table and we see a couple

717
00:24:10,799 --> 00:24:15,279
user actions being performed such as the

718
00:24:12,720 --> 00:24:17,120
user email company changed if we click

719
00:24:15,279 --> 00:24:19,039
on bank account

720
00:24:17,120 --> 00:24:21,360
this will set another token that'll help

721
00:24:19,039 --> 00:24:22,720
us focus on any bank account actions

722
00:24:21,360 --> 00:24:24,479
that were performed by the user while

723
00:24:22,720 --> 00:24:25,279
they were logged in from the 103 ipa

724
00:24:24,480 --> 00:24:27,120
address

725
00:24:25,279 --> 00:24:28,799
so we see that two bank accounts were

726
00:24:27,120 --> 00:24:30,840
added while the user was authenticated

727
00:24:28,799 --> 00:24:33,200
from that

728
00:24:30,840 --> 00:24:35,360
ip

729
00:24:33,200 --> 00:24:37,679
so shifting back over to the original

730
00:24:35,360 --> 00:24:39,039
tab looking at the user summary

731
00:24:37,679 --> 00:24:40,880
we want to look at the bank accounts

732
00:24:39,039 --> 00:24:43,440
that were added

733
00:24:40,880 --> 00:24:44,960
and we see that these two bank accounts

734
00:24:43,440 --> 00:24:45,679
were associated with this particular

735
00:24:44,960 --> 00:24:49,039
nadi id

736
00:24:45,679 --> 00:24:50,640
so we're going to click on the entity id

737
00:24:49,039 --> 00:24:52,960
and this is going to automatically open

738
00:24:50,640 --> 00:24:54,000
up a new dashboard for organization

739
00:24:52,960 --> 00:24:55,919
enrichment

740
00:24:54,000 --> 00:24:57,520
which provides the same type of lookup

741
00:24:55,919 --> 00:24:58,880
where it pulls in from the organization

742
00:24:57,520 --> 00:25:00,720
database

743
00:24:58,880 --> 00:25:01,919
gives us the users who are assigned to

744
00:25:00,720 --> 00:25:03,440
that organization

745
00:25:01,919 --> 00:25:05,760
and also shows us the assigned bank

746
00:25:03,440 --> 00:25:06,880
accounts that entity uh where there's a

747
00:25:05,760 --> 00:25:08,320
flag that looks for

748
00:25:06,880 --> 00:25:10,320
a state match based on the routing

749
00:25:08,320 --> 00:25:10,799
number that's provided so this looks

750
00:25:10,320 --> 00:25:12,639
like

751
00:25:10,799 --> 00:25:14,080
it's an account takeover where the

752
00:25:12,640 --> 00:25:18,480
attacker may have access

753
00:25:14,080 --> 00:25:18,480
to the user's primary email address

754
00:25:20,320 --> 00:25:23,760
all right it's later on in the afternoon

755
00:25:22,559 --> 00:25:26,320
we're reaching for our

756
00:25:23,760 --> 00:25:27,840
third diet coke and we get another

757
00:25:26,320 --> 00:25:30,320
notification

758
00:25:27,840 --> 00:25:32,158
there are provider and patient users who

759
00:25:30,320 --> 00:25:33,678
are reporting accounts being locked out

760
00:25:32,159 --> 00:25:34,320
they have no awareness of the activities

761
00:25:33,679 --> 00:25:36,720
so

762
00:25:34,320 --> 00:25:38,240
we need to look into some potential

763
00:25:36,720 --> 00:25:40,640
password attack activity for these

764
00:25:38,240 --> 00:25:40,640
accounts

765
00:25:41,279 --> 00:25:44,400
so we're going to go back to our main

766
00:25:42,480 --> 00:25:45,840
monitoring dashboard and

767
00:25:44,400 --> 00:25:47,679
we're going to look at some of the we

768
00:25:45,840 --> 00:25:49,279
see five ip addresses that are

769
00:25:47,679 --> 00:25:50,720
associated with potential password

770
00:25:49,279 --> 00:25:52,480
attack activity

771
00:25:50,720 --> 00:25:53,760
uh based on the user agents you know we

772
00:25:52,480 --> 00:25:56,240
see some looks like it could be a

773
00:25:53,760 --> 00:25:58,080
password spay toolkit

774
00:25:56,240 --> 00:25:59,840
something anomalous that's very short

775
00:25:58,080 --> 00:26:03,120
user agent mozilla

776
00:25:59,840 --> 00:26:04,799
5.0 and we see that these these attacks

777
00:26:03,120 --> 00:26:05,840
are having some level of success so a

778
00:26:04,799 --> 00:26:08,720
lot of them are failing

779
00:26:05,840 --> 00:26:11,120
but we see a couple successful

780
00:26:08,720 --> 00:26:12,320
authentications from these ip addresses

781
00:26:11,120 --> 00:26:16,239
so what we're going to do is we're going

782
00:26:12,320 --> 00:26:18,480
to click on this bottom ip address

783
00:26:16,240 --> 00:26:19,279
which is going to shift us over to a new

784
00:26:18,480 --> 00:26:20,559
dashboard

785
00:26:19,279 --> 00:26:22,480
so we're going to build enrichment

786
00:26:20,559 --> 00:26:24,879
around an ip address

787
00:26:22,480 --> 00:26:26,320
and in the top panels we see some you

788
00:26:24,880 --> 00:26:27,919
know metadata associated with the ip

789
00:26:26,320 --> 00:26:30,399
address some geolocation information

790
00:26:27,919 --> 00:26:31,039
autonomous system name uh over on the

791
00:26:30,400 --> 00:26:33,840
right if

792
00:26:31,039 --> 00:26:34,400
any users had logged in from this ip

793
00:26:33,840 --> 00:26:36,399
address

794
00:26:34,400 --> 00:26:37,840
and performed some type of action within

795
00:26:36,400 --> 00:26:39,760
the application associated with an

796
00:26:37,840 --> 00:26:41,678
entity that's where we would see it

797
00:26:39,760 --> 00:26:43,600
and then the timeline below we see as

798
00:26:41,679 --> 00:26:44,799
far as activity the activity timeline

799
00:26:43,600 --> 00:26:46,639
for the subp address

800
00:26:44,799 --> 00:26:48,158
we see a high number of failed uh

801
00:26:46,640 --> 00:26:50,960
authentication attempts so

802
00:26:48,159 --> 00:26:53,279
3 000 and then six successful

803
00:26:50,960 --> 00:26:56,720
authentication attempts

804
00:26:53,279 --> 00:26:56,720
all occurring on july 1st

805
00:26:57,679 --> 00:27:00,000
so we're going to scroll down and we're

806
00:26:58,960 --> 00:27:01,200
going to look at the remote access

807
00:27:00,000 --> 00:27:02,880
analytics

808
00:27:01,200 --> 00:27:04,960
and in the top two panels we have the

809
00:27:02,880 --> 00:27:06,480
ability to set tokens again whether it's

810
00:27:04,960 --> 00:27:09,840
based on the username

811
00:27:06,480 --> 00:27:12,240
or the user agent and we can also select

812
00:27:09,840 --> 00:27:13,760
uh the successful authentication so we

813
00:27:12,240 --> 00:27:14,640
can focus on the accounts that we need

814
00:27:13,760 --> 00:27:17,120
to

815
00:27:14,640 --> 00:27:18,000
reset so at this point you know we see

816
00:27:17,120 --> 00:27:19,439
three accounts that

817
00:27:18,000 --> 00:27:21,600
had been successfully authenticated from

818
00:27:19,440 --> 00:27:23,520
this ip address and we will want to

819
00:27:21,600 --> 00:27:26,000
reset those passwords

820
00:27:23,520 --> 00:27:26,720
look at our waff configuration and

821
00:27:26,000 --> 00:27:30,480
probably

822
00:27:26,720 --> 00:27:30,480
reconsider that mfa project

823
00:27:33,360 --> 00:27:38,080
all right we're home after a long day

824
00:27:35,360 --> 00:27:40,320
and uh we're reaching for the scotch

825
00:27:38,080 --> 00:27:42,000
and uh we hear that familiar email chime

826
00:27:40,320 --> 00:27:43,039
that tells us it's time to make it a

827
00:27:42,000 --> 00:27:45,120
double

828
00:27:43,039 --> 00:27:46,240
so we get a notification from an

829
00:27:45,120 --> 00:27:49,039
insurance provider

830
00:27:46,240 --> 00:27:51,520
who says that there's some suspicious

831
00:27:49,039 --> 00:27:52,879
activity associated with an organization

832
00:27:51,520 --> 00:27:54,639
the users associated with this

833
00:27:52,880 --> 00:27:56,480
organization are performing a high

834
00:27:54,640 --> 00:27:58,320
number of failed health record lookups

835
00:27:56,480 --> 00:28:02,000
of patient information that's

836
00:27:58,320 --> 00:28:03,200
retained by the insurance provider

837
00:28:02,000 --> 00:28:05,039
so we're going to ship back to our

838
00:28:03,200 --> 00:28:06,320
organization enrichment dashboard and

839
00:28:05,039 --> 00:28:07,919
we're going to search for that

840
00:28:06,320 --> 00:28:09,918
entity id that was provided by the

841
00:28:07,919 --> 00:28:10,960
insurance provider and we can see

842
00:28:09,919 --> 00:28:12,640
already it's

843
00:28:10,960 --> 00:28:14,399
it's it's pretty suspicious i mean the

844
00:28:12,640 --> 00:28:16,640
entity name is catitude

845
00:28:14,399 --> 00:28:18,158
uh there are three users that are

846
00:28:16,640 --> 00:28:20,559
assigned to this organization

847
00:28:18,159 --> 00:28:22,399
all with a gmail address and the npes

848
00:28:20,559 --> 00:28:23,440
information is inconsistent as far as

849
00:28:22,399 --> 00:28:24,399
what they provide at the time of

850
00:28:23,440 --> 00:28:25,679
registration

851
00:28:24,399 --> 00:28:27,039
and based on the data that we pulled

852
00:28:25,679 --> 00:28:31,440
back from the npes database with our

853
00:28:27,039 --> 00:28:33,360
external lookup

854
00:28:31,440 --> 00:28:34,960
so as i said they're all uh their

855
00:28:33,360 --> 00:28:36,158
primary email accounts are all

856
00:28:34,960 --> 00:28:38,080
gmail-based

857
00:28:36,159 --> 00:28:39,440
uh they're logging in from all across

858
00:28:38,080 --> 00:28:41,600
the world

859
00:28:39,440 --> 00:28:43,679
and we can see about a 50 success rate

860
00:28:41,600 --> 00:28:44,000
fail rate for the health record lookups

861
00:28:43,679 --> 00:28:46,640
that they're

862
00:28:44,000 --> 00:28:48,080
performing as far as the the heat map

863
00:28:46,640 --> 00:28:50,000
you can see that it kind of follows a

864
00:28:48,080 --> 00:28:52,960
pattern of a nine to five

865
00:28:50,000 --> 00:28:54,159
uh during the week so it could be an

866
00:28:52,960 --> 00:28:57,600
indication of

867
00:28:54,159 --> 00:28:58,799
some organized activity

868
00:28:57,600 --> 00:29:00,719
so what we're going to do is we're going

869
00:28:58,799 --> 00:29:02,158
to click on one of the user names and

870
00:29:00,720 --> 00:29:03,360
ship back to the user activity

871
00:29:02,159 --> 00:29:05,279
enrichment tab

872
00:29:03,360 --> 00:29:07,678
and we can see that this particular user

873
00:29:05,279 --> 00:29:11,039
that staff one is associated with

874
00:29:07,679 --> 00:29:12,320
two entity id so one is the

875
00:29:11,039 --> 00:29:14,000
suspicious entity that we were

876
00:29:12,320 --> 00:29:14,960
originally investigating and then the

877
00:29:14,000 --> 00:29:18,000
second one is this

878
00:29:14,960 --> 00:29:18,720
other legitimate looking entity which

879
00:29:18,000 --> 00:29:21,360
had the

880
00:29:18,720 --> 00:29:24,559
npes information that matched so i think

881
00:29:21,360 --> 00:29:24,559
that that's pretty interesting

882
00:29:24,640 --> 00:29:28,320
and scrolling down you know we see some

883
00:29:27,200 --> 00:29:30,159
notable application

884
00:29:28,320 --> 00:29:32,399
actions that were performed by this vet

885
00:29:30,159 --> 00:29:34,559
staff account where they had registered

886
00:29:32,399 --> 00:29:37,199
the organization and then added

887
00:29:34,559 --> 00:29:38,320
two additional accounts and assigned

888
00:29:37,200 --> 00:29:40,320
them to the entity

889
00:29:38,320 --> 00:29:41,918
so what this looks like is potentially

890
00:29:40,320 --> 00:29:44,559
the legitimate organization

891
00:29:41,919 --> 00:29:45,520
outsourced some function or services to

892
00:29:44,559 --> 00:29:47,440
a third party

893
00:29:45,520 --> 00:29:49,120
who then leveraged that previous

894
00:29:47,440 --> 00:29:51,360
organization's information to create a

895
00:29:49,120 --> 00:29:53,600
new account a new entity

896
00:29:51,360 --> 00:29:55,840
and then perform some fraudulent

897
00:29:53,600 --> 00:29:55,840
activity

898
00:29:57,840 --> 00:30:01,279
so just kind of a recap of all the

899
00:29:59,600 --> 00:30:03,039
different pivoting concepts that deeper

900
00:30:01,279 --> 00:30:05,039
uses

901
00:30:03,039 --> 00:30:06,720
this this shows that you want to be able

902
00:30:05,039 --> 00:30:08,240
to hook up your data elements so that

903
00:30:06,720 --> 00:30:09,760
you can pivot seamlessly and like a

904
00:30:08,240 --> 00:30:11,840
click button approach

905
00:30:09,760 --> 00:30:13,520
and anytime you investigate new activity

906
00:30:11,840 --> 00:30:14,879
you should backstop that with a new

907
00:30:13,520 --> 00:30:17,039
analytic in your detection and

908
00:30:14,880 --> 00:30:20,720
monitoring platform

909
00:30:17,039 --> 00:30:21,440
or dashboard so i know some of these

910
00:30:20,720 --> 00:30:24,640
scenarios

911
00:30:21,440 --> 00:30:28,000
may not be totally relevant to um

912
00:30:24,640 --> 00:30:29,600
your organization or industry

913
00:30:28,000 --> 00:30:31,200
um but hopefully it kind of gets you

914
00:30:29,600 --> 00:30:32,639
thinking about ways that your

915
00:30:31,200 --> 00:30:34,000
application could be targeted

916
00:30:32,640 --> 00:30:35,120
ways that you could leverage the logs

917
00:30:34,000 --> 00:30:38,399
whether or not you have any gap

918
00:30:35,120 --> 00:30:40,799
invisibility in your existing logging

919
00:30:38,399 --> 00:30:40,799
approach

920
00:30:42,399 --> 00:30:45,520
so just to leave you with some kind of

921
00:30:44,480 --> 00:30:48,880
top five

922
00:30:45,520 --> 00:30:49,520
login recommendations ensure that the x4

923
00:30:48,880 --> 00:30:50,880
to 4

924
00:30:49,520 --> 00:30:52,399
field is enabled so you can create

925
00:30:50,880 --> 00:30:54,320
useful detection analytics and

926
00:30:52,399 --> 00:30:55,760
investigative pivots

927
00:30:54,320 --> 00:30:57,840
also make sure everything is logged into

928
00:30:55,760 --> 00:30:59,600
the same time zone so that your

929
00:30:57,840 --> 00:31:01,120
timeline you know lines up nicely when

930
00:30:59,600 --> 00:31:03,678
you sort it

931
00:31:01,120 --> 00:31:05,279
record session ids for authenticated

932
00:31:03,679 --> 00:31:06,640
users so you can quickly scope the

933
00:31:05,279 --> 00:31:08,000
actions that they perform in an

934
00:31:06,640 --> 00:31:09,840
application

935
00:31:08,000 --> 00:31:11,279
and also make sure that you test your

936
00:31:09,840 --> 00:31:12,879
your data export and archive log

937
00:31:11,279 --> 00:31:14,880
restoration processes i mean

938
00:31:12,880 --> 00:31:16,240
the worst time to find out uh find a

939
00:31:14,880 --> 00:31:16,720
surprise bottleneck is when you're in

940
00:31:16,240 --> 00:31:19,200
the middle

941
00:31:16,720 --> 00:31:20,080
of an instant response and then also

942
00:31:19,200 --> 00:31:22,799
make sure that you're

943
00:31:20,080 --> 00:31:24,720
recording successful and failed events

944
00:31:22,799 --> 00:31:26,639
especially for logons

945
00:31:24,720 --> 00:31:28,720
some default configurations may only be

946
00:31:26,640 --> 00:31:30,080
recording failed events

947
00:31:28,720 --> 00:31:32,080
so if an attacker logs in with

948
00:31:30,080 --> 00:31:35,279
legitimate compromised credentials you'd

949
00:31:32,080 --> 00:31:35,279
have no immediate way of knowing

950
00:31:37,440 --> 00:31:42,240
and then just to round it out with a

951
00:31:39,919 --> 00:31:44,960
couple final thoughts right if you can

952
00:31:42,240 --> 00:31:47,120
leave this this chat this talk with

953
00:31:44,960 --> 00:31:47,679
anything right try to reflect on the log

954
00:31:47,120 --> 00:31:51,039
analysis

955
00:31:47,679 --> 00:31:52,320
you've done you might do in the future

956
00:31:51,039 --> 00:31:54,480
what do they look like what are the

957
00:31:52,320 --> 00:31:56,320
capabilities you have to improve

958
00:31:54,480 --> 00:31:58,000
and you know maybe use the the

959
00:31:56,320 --> 00:32:00,240
demonstration that ryan put on

960
00:31:58,000 --> 00:32:02,240
as an example of if if you have the time

961
00:32:00,240 --> 00:32:03,679
and the the capabilities to

962
00:32:02,240 --> 00:32:05,360
build out some of these this

963
00:32:03,679 --> 00:32:07,200
functionality maybe it's a good example

964
00:32:05,360 --> 00:32:08,559
of ways you can design it and click

965
00:32:07,200 --> 00:32:09,760
through so

966
00:32:08,559 --> 00:32:11,678
hopefully everyone sees a little bit of

967
00:32:09,760 --> 00:32:13,120
familiar familiarity and

968
00:32:11,679 --> 00:32:14,799
and what we showed or maybe not that'd

969
00:32:13,120 --> 00:32:17,360
be great too

970
00:32:14,799 --> 00:32:19,200
yeah and create workflows that ensure

971
00:32:17,360 --> 00:32:21,199
everyone uses a standard

972
00:32:19,200 --> 00:32:23,200
investigative methodology but don't make

973
00:32:21,200 --> 00:32:24,080
them so inflexible that they can't be

974
00:32:23,200 --> 00:32:27,120
updated with new

975
00:32:24,080 --> 00:32:29,678
log sources or analyst creativity

976
00:32:27,120 --> 00:32:31,039
and dashboards and click button pivoting

977
00:32:29,679 --> 00:32:33,360
really lowers the analytic

978
00:32:31,039 --> 00:32:34,320
overhead and the number of browser tabs

979
00:32:33,360 --> 00:32:36,479
that you have to have open

980
00:32:34,320 --> 00:32:38,240
simultaneously so you're gonna have to

981
00:32:36,480 --> 00:32:39,279
copy and paste a query over and over and

982
00:32:38,240 --> 00:32:41,919
over again

983
00:32:39,279 --> 00:32:42,559
and develop dashboards and documentation

984
00:32:41,919 --> 00:32:45,039
up front

985
00:32:42,559 --> 00:32:47,760
to lower the technical barrier for

986
00:32:45,039 --> 00:32:49,760
junior and newer analysts

987
00:32:47,760 --> 00:32:51,360
to cross when performing investigations

988
00:32:49,760 --> 00:32:53,519
especially when that in

989
00:32:51,360 --> 00:32:57,840
an experience might lead to incomplete

990
00:32:53,519 --> 00:32:57,840
data searching

991
00:32:58,880 --> 00:33:03,039
so i guess we'll open it up for

992
00:33:00,559 --> 00:33:03,039
questions

993
00:33:04,000 --> 00:33:08,640
there's one that just came into the

994
00:33:05,519 --> 00:33:10,960
discord and the person is asking if

995
00:33:08,640 --> 00:33:13,120
the speakers have any recommendations or

996
00:33:10,960 --> 00:33:15,840
guidelines for creating log outputs for

997
00:33:13,120 --> 00:33:15,840
your own tools

998
00:33:18,960 --> 00:33:22,880
uh yeah that's a good question so i'm

999
00:33:21,760 --> 00:33:26,158
definitely not not

1000
00:33:22,880 --> 00:33:28,320
well versed in logging standardizations

1001
00:33:26,159 --> 00:33:29,519
but if it were up to me you'd want it to

1002
00:33:28,320 --> 00:33:31,760
be

1003
00:33:29,519 --> 00:33:32,720
you know easy to delimit if you wanted

1004
00:33:31,760 --> 00:33:35,919
to open it in excel

1005
00:33:32,720 --> 00:33:37,360
or easy to parse so either pipe

1006
00:33:35,919 --> 00:33:39,440
delimited or

1007
00:33:37,360 --> 00:33:40,879
some type of delimiter or structure such

1008
00:33:39,440 --> 00:33:42,159
as json

1009
00:33:40,880 --> 00:33:44,000
depending on what you're going to use it

1010
00:33:42,159 --> 00:33:45,039
for um and then really you'd want to

1011
00:33:44,000 --> 00:33:46,640
make sure you have everything you need

1012
00:33:45,039 --> 00:33:47,120
that's relevant to your application such

1013
00:33:46,640 --> 00:33:49,360
as

1014
00:33:47,120 --> 00:33:50,799
timestamp in a format that you're going

1015
00:33:49,360 --> 00:33:54,320
to to be able to read

1016
00:33:50,799 --> 00:33:55,360
time zone username session id source ip

1017
00:33:54,320 --> 00:33:57,200
address

1018
00:33:55,360 --> 00:33:59,840
the type of activity performed whether

1019
00:33:57,200 --> 00:34:02,240
it was successful or failed

1020
00:33:59,840 --> 00:34:03,918
those are some of the the main things we

1021
00:34:02,240 --> 00:34:07,200
look for user agent for example what do

1022
00:34:03,919 --> 00:34:10,399
you think ryan

1023
00:34:07,200 --> 00:34:12,480
yeah i completely agree um definitely

1024
00:34:10,399 --> 00:34:14,960
ensuring that you are able to associate

1025
00:34:12,480 --> 00:34:18,159
you know ip addresses time stamps

1026
00:34:14,960 --> 00:34:18,639
and user accounts and session ids as

1027
00:34:18,159 --> 00:34:20,879
much

1028
00:34:18,639 --> 00:34:21,679
information and that you can include in

1029
00:34:20,879 --> 00:34:23,918
your logging

1030
00:34:21,679 --> 00:34:24,800
the better because that's ultimately the

1031
00:34:23,918 --> 00:34:27,918
engine

1032
00:34:24,800 --> 00:34:30,639
that helps you investigate and build

1033
00:34:27,918 --> 00:34:32,638
detection analytics that are useful and

1034
00:34:30,639 --> 00:34:34,800
powerful

1035
00:34:32,639 --> 00:34:36,560
great and we have about 20 seconds left

1036
00:34:34,800 --> 00:34:37,839
and someone asked if you would share

1037
00:34:36,560 --> 00:34:40,000
your xml files

1038
00:34:37,839 --> 00:34:41,199
you used to make the dashboards and if

1039
00:34:40,000 --> 00:34:41,599
you want to maybe you could even post

1040
00:34:41,199 --> 00:34:44,480
those

1041
00:34:41,599 --> 00:34:46,079
in your channel or your hallway if

1042
00:34:44,480 --> 00:34:48,240
that's a possibility

1043
00:34:46,079 --> 00:34:49,359
uh absolutely i'll look into sharing

1044
00:34:48,239 --> 00:34:52,399
them um

1045
00:34:49,359 --> 00:34:53,119
whether it's in discord or uh to to

1046
00:34:52,399 --> 00:34:56,159
github

1047
00:34:53,119 --> 00:34:57,760
uh through my uh github account

1048
00:34:56,159 --> 00:34:59,920
fantastic and thank you so much that was

1049
00:34:57,760 --> 00:35:02,240
hilarious you should read track two

1050
00:34:59,920 --> 00:35:03,440
and all the puns and comments it's a

1051
00:35:02,240 --> 00:35:06,160
good thing you turned off

1052
00:35:03,440 --> 00:35:17,839
your discord because it was blowing up

1053
00:35:06,160 --> 00:35:17,839
it was insane

1054
00:35:20,560 --> 00:35:22,640
you

