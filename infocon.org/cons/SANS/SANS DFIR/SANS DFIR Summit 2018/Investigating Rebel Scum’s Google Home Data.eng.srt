1
00:00:00,800 --> 00:00:03,536
(dramatic music)

2
00:00:10,010 --> 00:00:12,879
(audience clapping)

3
00:00:12,879 --> 00:00:15,347
- Hi, my name is Phill,
as they have mentioned.

4
00:00:15,348 --> 00:00:17,550
Thank you for the introduction.

5
00:00:17,550 --> 00:00:21,354
I'm here today to talk
to you about the recent

6
00:00:21,354 --> 00:00:24,823
terrorist incident that
has so terribly affected

7
00:00:24,824 --> 00:00:25,959
the Imperial Empire.

8
00:00:27,127 --> 00:00:29,195
And provide a little
bit of information

9
00:00:29,195 --> 00:00:30,830
about my insights
of the Google Home

10
00:00:30,830 --> 00:00:35,835
that was used in
their destruction

11
00:00:36,936 --> 00:00:38,705
of our orbital battle station.

12
00:00:40,373 --> 00:00:43,443
I've been working for
the Empire willingly

13
00:00:43,443 --> 00:00:45,477
for the last seven years.

14
00:00:45,478 --> 00:00:48,748
Well, I mean
willingly join or die,

15
00:00:48,748 --> 00:00:52,018
willingly for the last
seven years as an analyst.

16
00:00:54,421 --> 00:00:56,756
Also started a blog,
This Week In Forensics,

17
00:00:56,756 --> 00:00:58,792
where I read everything
that I can find

18
00:00:58,792 --> 00:01:01,161
about the digital
forensics community

19
00:01:01,161 --> 00:01:03,463
and also my personal
research blog, ThinkDFIR.

20
00:01:04,831 --> 00:01:08,101
But we're here to talk
about the recent destruction

21
00:01:08,101 --> 00:01:09,869
of the DS-1 Orbital
Battle Station.

22
00:01:12,005 --> 00:01:13,640
Since the destruction,
we've indentified

23
00:01:13,640 --> 00:01:16,609
the Rebel Base and we
sent our top forensic,

24
00:01:16,609 --> 00:01:18,777
well our available
forensicators were sent,

25
00:01:19,979 --> 00:01:22,949
to examine, to provide
investigative support.

26
00:01:24,117 --> 00:01:25,885
The investigators
gave us a number of,

27
00:01:25,885 --> 00:01:27,220
well they gave us one question,

28
00:01:27,220 --> 00:01:29,155
they just wanna know everything.

29
00:01:29,155 --> 00:01:31,491
And that wasn't
really helpful to me,

30
00:01:31,491 --> 00:01:34,060
so I wrote down a
series of questions

31
00:01:34,060 --> 00:01:36,930
that I would like to
have written down,

32
00:01:36,930 --> 00:01:38,031
I mean I guess provided.

33
00:01:38,031 --> 00:01:41,568
But I would like to determine

34
00:01:41,568 --> 00:01:43,837
so that I can assist
their investigation.

35
00:01:43,837 --> 00:01:45,138
So the first thing I wanna know

36
00:01:45,138 --> 00:01:47,340
is what access point
was it connected to?

37
00:01:47,340 --> 00:01:49,309
Were these device
connected to each other?

38
00:01:49,309 --> 00:01:51,077
Because of course,
just because the home

39
00:01:51,077 --> 00:01:53,213
and the phone were
in the same location,

40
00:01:53,213 --> 00:01:55,448
does not necessarily
mean that they were used

41
00:01:55,448 --> 00:01:57,050
to interact.

42
00:01:57,050 --> 00:01:59,319
What accounts were
they linked to?

43
00:01:59,319 --> 00:02:00,553
What has the device heard?

44
00:02:00,553 --> 00:02:03,256
Which is probably our
most important part.

45
00:02:03,256 --> 00:02:04,858
And then the Bluetooth devices

46
00:02:04,858 --> 00:02:07,193
and any location information
that can be found.

47
00:02:09,095 --> 00:02:11,231
So I was provided with
a Google Home Mini

48
00:02:12,332 --> 00:02:16,136
and an Android device
to investigate.

49
00:02:17,403 --> 00:02:20,440
And so I thought
where should I start,

50
00:02:20,440 --> 00:02:22,709
and I'm gonna start
with the phone.

51
00:02:22,709 --> 00:02:24,410
So the phone examination's
gonna be the easiest part

52
00:02:24,410 --> 00:02:26,713
because there's a lot
of research about that

53
00:02:26,713 --> 00:02:28,448
and I know what I'm doing.

54
00:02:28,448 --> 00:02:30,817
So I started by looking
at the Google Home app.

55
00:02:32,318 --> 00:02:34,554
This app is basically
the Chromecast app

56
00:02:34,554 --> 00:02:35,788
that's been renamed.

57
00:02:35,788 --> 00:02:38,258
It's now relating
to Google Homes.

58
00:02:38,258 --> 00:02:41,161
So that's why the app ID
is the chromecast.app,

59
00:02:41,161 --> 00:02:44,097
and it's mainly used for
the device interaction.

60
00:02:44,097 --> 00:02:47,367
You're gonna be able to
control the settings, setup

61
00:02:47,367 --> 00:02:48,935
the Google Home devices.

62
00:02:48,935 --> 00:02:51,204
And there's actually no web
interface that you can use

63
00:02:51,204 --> 00:02:53,773
to interact with
the devices as well.

64
00:02:55,341 --> 00:02:59,012
So the first thing I wanna
do is provide an extraction,

65
00:02:59,012 --> 00:03:01,414
well obtain an extraction,
so that I can examine

66
00:03:01,414 --> 00:03:02,347
this app data.

67
00:03:03,550 --> 00:03:06,319
The phone that I had to
examine was a Nexus five

68
00:03:06,319 --> 00:03:08,922
and is running the
Home app version,

69
00:03:08,922 --> 00:03:10,123
well a previous version.

70
00:03:11,291 --> 00:03:13,359
So of course I'm gonna
run an ADB backup first

71
00:03:13,359 --> 00:03:14,194
and see what there was.

72
00:03:14,194 --> 00:03:16,429
Unfortunately, not much.

73
00:03:16,429 --> 00:03:19,199
The Google Home app didn't
really backup very much

74
00:03:19,199 --> 00:03:21,467
using the native ADB process.

75
00:03:21,467 --> 00:03:24,737
As a result I was left with
only obtaining a physical.

76
00:03:24,737 --> 00:03:27,207
This was very helpful,
there was a lot of data,

77
00:03:27,207 --> 00:03:30,442
and so then I can direct
my investigation after that

78
00:03:30,443 --> 00:03:32,478
directly to the data
folder that had everything

79
00:03:32,478 --> 00:03:34,113
that I was looking for.

80
00:03:34,113 --> 00:03:36,216
I also tested the iOS section.

81
00:03:36,216 --> 00:03:39,686
I had a test iOS device,
just for interest.

82
00:03:39,686 --> 00:03:41,054
An iOS is a little bit easier.

83
00:03:41,054 --> 00:03:42,622
Everything you're
gonna get comes out

84
00:03:42,622 --> 00:03:45,058
of a regular backup and
it's all in Synchro Light

85
00:03:45,058 --> 00:03:47,859
and paylists and very
simple to analyze.

86
00:03:47,860 --> 00:03:49,128
So this is a bit hard to read,

87
00:03:49,128 --> 00:03:52,665
but we've got a few
screens from examining

88
00:03:52,665 --> 00:03:53,900
the physical device itself.

89
00:03:53,900 --> 00:03:57,670
Just looking at
the account drawer,

90
00:03:57,670 --> 00:03:59,872
I can say that there
is one user account,

91
00:03:59,872 --> 00:04:02,609
and from there I can also
query the actual Google Home

92
00:04:02,609 --> 00:04:04,110
that I'm on the network with.

93
00:04:04,110 --> 00:04:05,545
And I can say that
there is one account

94
00:04:05,545 --> 00:04:10,250
named Rebels Yavin,
rebelsonyavin@gmail.com

95
00:04:10,250 --> 00:04:11,117
with a photo.

96
00:04:13,519 --> 00:04:14,787
That's really useful.

97
00:04:14,787 --> 00:04:16,723
It means I know that
there's only one account

98
00:04:16,723 --> 00:04:18,291
that I need to look for
and only one account

99
00:04:18,291 --> 00:04:19,625
I need to download.

100
00:04:19,625 --> 00:04:21,393
It will also indicate
every other app

101
00:04:21,394 --> 00:04:24,964
that is used to interact
with this device.

102
00:04:26,232 --> 00:04:27,900
Every other email
address, sorry.

103
00:04:29,035 --> 00:04:30,937
If I take my own phone
and connect it up

104
00:04:30,937 --> 00:04:33,339
to the network, I can
obtain a little bit

105
00:04:33,339 --> 00:04:35,375
of information but
not as much as I need.

106
00:04:35,375 --> 00:04:38,711
I'll be able to tell the
user name and the picture,

107
00:04:38,711 --> 00:04:40,413
but I won't be able to
get the email address.

108
00:04:40,413 --> 00:04:42,115
And I can also get
the device name.

109
00:04:43,416 --> 00:04:45,885
Moving on we can look at
the target device again

110
00:04:45,885 --> 00:04:48,554
and we can see all of the
devices that that user account

111
00:04:48,554 --> 00:04:50,323
has at it's disposal.

112
00:04:50,323 --> 00:04:52,859
In this instance,
it was just the one,

113
00:04:52,859 --> 00:04:54,227
which was called Rebel Base.

114
00:04:55,662 --> 00:04:58,864
The device address is something
that's quite important.

115
00:04:58,865 --> 00:05:00,533
You can have a look if
you click in through

116
00:05:00,533 --> 00:05:04,404
the device menu and you can
see that the device address

117
00:05:04,404 --> 00:05:08,341
is in this instance Lucas
Valley Road in California.

118
00:05:08,341 --> 00:05:10,943
Important thing to
note about this is

119
00:05:10,943 --> 00:05:12,245
whilst you can
very easily see it,

120
00:05:12,245 --> 00:05:14,547
and you can very easily
read it in the XML file,

121
00:05:14,547 --> 00:05:17,050
it's set by the user not by GPS,

122
00:05:17,050 --> 00:05:20,486
because the Google Home device
was not found in California.

123
00:05:21,754 --> 00:05:23,456
This information
also shows up in all

124
00:05:23,456 --> 00:05:26,292
of the Cloud activity
under current location

125
00:05:26,292 --> 00:05:28,294
in my activity, so it's
very easy to get at.

126
00:05:28,294 --> 00:05:29,695
It's very easy to interpret.

127
00:05:31,431 --> 00:05:33,633
The Home Graph is the
most important file

128
00:05:33,633 --> 00:05:35,768
that you can find
in the app data.

129
00:05:35,768 --> 00:05:39,638
So, it's basically gonna
be called Home Graph

130
00:05:39,639 --> 00:05:42,842
and then a base 64 string
of the user's account email,

131
00:05:42,842 --> 00:05:46,712
and there will be one for
each user on the device

132
00:05:46,713 --> 00:05:50,083
that has interacted
with the Google Home,

133
00:05:50,083 --> 00:05:51,784
so much as they've
got a Google Home

134
00:05:51,784 --> 00:05:53,453
linked to their account.

135
00:05:53,453 --> 00:05:55,921
Now unfortunately,
this is encoded

136
00:05:55,922 --> 00:05:58,191
in Google's protobuf encoding,

137
00:05:58,191 --> 00:06:00,126
and I haven't been
able to figure out

138
00:06:00,126 --> 00:06:01,494
a good way of interpreting it

139
00:06:01,494 --> 00:06:03,696
and decoding it properly,
so we're kind of

140
00:06:03,696 --> 00:06:05,765
left with just
reading the strings.

141
00:06:05,765 --> 00:06:07,834
Thankfully, a lot of
the ones that we need

142
00:06:07,834 --> 00:06:08,835
pop up quite easily.

143
00:06:10,269 --> 00:06:12,472
So the first thing we wanna
look at is our Gmail address,

144
00:06:12,472 --> 00:06:13,373
that's fine.

145
00:06:13,373 --> 00:06:14,440
We already know that.

146
00:06:15,375 --> 00:06:17,777
We've got what looks like an ID

147
00:06:17,777 --> 00:06:20,712
and we'll talk about it
more as it's very important.

148
00:06:20,713 --> 00:06:21,948
It's the Cloud device ID.

149
00:06:23,383 --> 00:06:26,919
And we've also got another
ID about the Google account.

150
00:06:26,919 --> 00:06:31,924
And this account ID is setup
to every single user on Gmail.

151
00:06:33,359 --> 00:06:35,695
It's easier to decode if
you've got Google+ set up,

152
00:06:35,695 --> 00:06:37,997
but that's not necessarily
always the case.

153
00:06:39,732 --> 00:06:42,835
But, that's gonna be
useful for later as well.

154
00:06:42,835 --> 00:06:45,037
So, just to summarize what
we found on the phone,

155
00:06:45,037 --> 00:06:48,007
we've got our email,
we've got our account ID.

156
00:06:48,007 --> 00:06:49,409
We've also got the oAuth Token,

157
00:06:49,409 --> 00:06:50,643
which is gonna be
great when we need

158
00:06:50,643 --> 00:06:52,744
to download Cloud data.

159
00:06:52,745 --> 00:06:54,514
A device location,
a Cloud device ID

160
00:06:54,514 --> 00:06:56,048
and the Wifi password.

161
00:06:57,216 --> 00:06:59,552
So that's answered a
few questions already.

162
00:06:59,552 --> 00:07:01,554
Now we're gonna look
at the Google Home.

163
00:07:01,554 --> 00:07:03,155
This is an actual
product by the way.

164
00:07:03,156 --> 00:07:04,991
If you would like to
support all of those

165
00:07:04,991 --> 00:07:07,058
that were lost in the
recent destruction,

166
00:07:07,059 --> 00:07:08,461
please go to the link below.

167
00:07:10,029 --> 00:07:11,531
So there's two
things that we can do

168
00:07:11,531 --> 00:07:13,599
to examine the Google Home.

169
00:07:13,599 --> 00:07:15,735
There's querying
it while it's live

170
00:07:15,735 --> 00:07:17,503
or we can examine the internals.

171
00:07:17,503 --> 00:07:20,006
It depends on your use
case, I'm gonna go all out

172
00:07:20,006 --> 00:07:21,974
because this is for
a terrorist incident.

173
00:07:21,974 --> 00:07:23,276
So I need to make
sure that I'm getting

174
00:07:23,276 --> 00:07:25,077
as much information as possible.

175
00:07:25,077 --> 00:07:26,679
But in some instances
if you do not want

176
00:07:26,679 --> 00:07:29,147
to destroy the device,
examining the internals

177
00:07:29,148 --> 00:07:31,851
is going to not be
the right way to work.

178
00:07:33,686 --> 00:07:36,055
So first you want to
do is you wanna find

179
00:07:36,055 --> 00:07:38,090
the Home itself on the network.

180
00:07:38,090 --> 00:07:40,426
You can easily query the
device on the Home app

181
00:07:41,527 --> 00:07:42,895
or you can use
something like Fing,

182
00:07:42,895 --> 00:07:44,630
which is a network scanner.

183
00:07:44,630 --> 00:07:46,766
The caveat is that it
will scan the network,

184
00:07:46,766 --> 00:07:49,235
send that information
up and provide you

185
00:07:49,235 --> 00:07:53,272
with IPs, names, MAC
addresses and device types.

186
00:07:53,272 --> 00:07:56,375
That might not be suitable
to your situation.

187
00:07:56,375 --> 00:07:59,145
So in that case then you
can always use an Nmap

188
00:07:59,145 --> 00:08:01,514
to scan your network and
see what you will find.

189
00:08:03,382 --> 00:08:04,851
The Nmap command
down at the bottom

190
00:08:04,851 --> 00:08:06,986
will show you all the
Google Home devices

191
00:08:06,986 --> 00:08:09,688
and if you get rid of the 10001,

192
00:08:09,689 --> 00:08:11,691
which is the highlighted port,

193
00:08:11,691 --> 00:08:13,626
then that will show you the
Chromecast devices as well,

194
00:08:13,626 --> 00:08:15,193
'cause they're both
built off the same thing.

195
00:08:15,194 --> 00:08:16,929
You can query them the same way.

196
00:08:19,065 --> 00:08:21,601
So, we wanna find as
much information we can

197
00:08:21,601 --> 00:08:23,669
from the live device
and there's two methods

198
00:08:23,669 --> 00:08:24,837
of doing so.

199
00:08:24,837 --> 00:08:26,506
I know I said that
Google only let us know

200
00:08:26,506 --> 00:08:28,241
that there was one,
and that's the one

201
00:08:28,241 --> 00:08:30,643
they only want us to use,
which is the Home app.

202
00:08:30,643 --> 00:08:32,645
But unfortunately,
that won't give us all

203
00:08:32,645 --> 00:08:35,146
of the information that
we would like to find.

204
00:08:35,147 --> 00:08:37,316
So, I built a script
called Homespeak,

205
00:08:37,316 --> 00:08:39,118
which I'll be releasing shortly.

206
00:08:39,118 --> 00:08:42,221
It was based off some
work by a GitHub user

207
00:08:42,221 --> 00:08:44,824
named Rithvikvibhu who
found that you could send

208
00:08:44,824 --> 00:08:48,426
GET and POST requests to
the Google Home device

209
00:08:48,427 --> 00:08:50,296
as long as you're
on it's network,

210
00:08:50,296 --> 00:08:52,498
and you will receive
JSON data back.

211
00:08:54,166 --> 00:08:56,469
There are kind of two
methods of doing this,

212
00:08:56,469 --> 00:08:57,937
it depends on the situation.

213
00:08:57,937 --> 00:08:59,906
If you're at the scene, you
can jump on the network,

214
00:08:59,906 --> 00:09:01,940
you can send the queries
once you've got the IP

215
00:09:01,941 --> 00:09:04,744
but, if you you've
opened the exhibit bag

216
00:09:04,744 --> 00:09:06,479
and there's your Goggle
Home, you might not

217
00:09:06,479 --> 00:09:08,214
be able to do that.

218
00:09:08,214 --> 00:09:09,782
In that instance,
the great thing

219
00:09:09,782 --> 00:09:12,151
about Home devices is
when you plug them in,

220
00:09:12,151 --> 00:09:14,152
they shoot up their own network

221
00:09:14,153 --> 00:09:15,855
and you can connect to that.

222
00:09:15,855 --> 00:09:18,591
If you try to query
that with the Home app,

223
00:09:18,591 --> 00:09:20,426
you will not actually
be able to get any data.

224
00:09:20,426 --> 00:09:21,827
It will be thinking
that you're trying

225
00:09:21,827 --> 00:09:23,563
to set up a brand new device.

226
00:09:23,563 --> 00:09:24,931
I don't wanna set up
a brand new device,

227
00:09:24,931 --> 00:09:26,065
I want to find all
the information

228
00:09:26,065 --> 00:09:27,667
on the current one.

229
00:09:27,667 --> 00:09:29,835
So you can send a
couple of requests

230
00:09:29,835 --> 00:09:32,338
that are really gonna get
you as much information

231
00:09:32,338 --> 00:09:33,573
as you need.

232
00:09:33,573 --> 00:09:35,207
There's a lot of
information in there

233
00:09:35,207 --> 00:09:37,043
that's not really relevant.

234
00:09:37,043 --> 00:09:38,511
But the main stuff that I found

235
00:09:38,511 --> 00:09:40,478
was the Cloud device ID,
which we found earlier,

236
00:09:40,479 --> 00:09:42,048
and the Bluetooth devices.

237
00:09:43,215 --> 00:09:45,051
That Cloud device ID,
I just wanna point out,

238
00:09:45,051 --> 00:09:49,088
is set up as soon as you
initially set up that device.

239
00:09:49,088 --> 00:09:50,990
If you restart the
device it'll be fine,

240
00:09:50,990 --> 00:09:52,925
but if you reset
the device manually,

241
00:09:52,925 --> 00:09:55,227
you'll get a brand
new Cloud device ID.

242
00:09:57,063 --> 00:09:58,531
So we want to put
that all together.

243
00:09:58,531 --> 00:10:02,167
We've got our Cloud device
ID from the Home Graph

244
00:10:02,168 --> 00:10:05,338
as well as our account
and our Gmail address,

245
00:10:05,338 --> 00:10:07,406
and on the other side we've
got our Cloud device ID.

246
00:10:07,406 --> 00:10:09,709
Which is great, because now
we can put them both together

247
00:10:09,709 --> 00:10:12,545
they match, and we can use that
to download the Cloud data.

248
00:10:12,545 --> 00:10:15,781
Well, use that to confirm
that this is the account

249
00:10:15,781 --> 00:10:17,550
that we need to download,
because the last thing

250
00:10:17,550 --> 00:10:21,252
you wanna do is find a
Home device and a phone

251
00:10:21,253 --> 00:10:23,422
and download the wrong
person's account.

252
00:10:23,422 --> 00:10:25,224
There can be legislative
issues if you do that

253
00:10:25,224 --> 00:10:27,159
and so we just have
to make sure first.

254
00:10:29,362 --> 00:10:30,795
The other thing I
wanted to bring up

255
00:10:30,796 --> 00:10:32,031
was Bluetooth devices.

256
00:10:33,299 --> 00:10:35,367
Just a useful piece
of information,

257
00:10:35,368 --> 00:10:40,339
if you go and query the
device with the Home app,

258
00:10:41,741 --> 00:10:43,275
you will find all the
connected Bluetooth devices

259
00:10:43,275 --> 00:10:45,877
as well as the date that
they connected initially.

260
00:10:45,878 --> 00:10:48,581
This doesn't matter if
you're on the suspect device

261
00:10:48,581 --> 00:10:51,951
or in this case the
investigator's device.

262
00:10:51,951 --> 00:10:53,252
That will work just
fine and it'll give you

263
00:10:53,252 --> 00:10:54,719
that information.

264
00:10:54,720 --> 00:10:57,056
But unfortunately, it
doesn't give you much more.

265
00:10:58,290 --> 00:11:00,626
With Homespeak you're
able to send the query

266
00:11:00,626 --> 00:11:02,328
and get a bit more information,

267
00:11:02,328 --> 00:11:04,030
which I'll just
make a bit bigger.

268
00:11:05,164 --> 00:11:06,432
So we've got the
bond date, the date

269
00:11:06,432 --> 00:11:08,467
that it was initially connected.

270
00:11:08,467 --> 00:11:10,836
As well as the
last connect date.

271
00:11:10,836 --> 00:11:13,606
It's called last connect date
but it means last interaction,

272
00:11:13,606 --> 00:11:16,842
so if you connect or
disconnect, depending

273
00:11:16,842 --> 00:11:19,745
on the connected flag,
it will log the date.

274
00:11:19,745 --> 00:11:21,914
Which is great for
determining when maybe

275
00:11:21,914 --> 00:11:25,317
the rebels were last at
that base at that date.

276
00:11:25,317 --> 00:11:28,421
We've also got the MAC address
as well as the device name,

277
00:11:28,421 --> 00:11:30,956
which is just a bit
more to really confirm

278
00:11:30,956 --> 00:11:33,926
what we found on
the Home app itself.

279
00:11:36,095 --> 00:11:37,329
But that might not
be good enough.

280
00:11:37,329 --> 00:11:38,964
We might want to
go a bit further.

281
00:11:38,964 --> 00:11:41,534
We might want to pull
the device apart.

282
00:11:41,534 --> 00:11:43,269
So this is the inside
of the Google Home Mini.

283
00:11:43,269 --> 00:11:44,770
They're fairly
easy to pull apart

284
00:11:44,770 --> 00:11:47,139
and the Google Home
devices aren't much harder.

285
00:11:48,908 --> 00:11:51,844
Inside we'll find a
256 meg Toshiba chip.

286
00:11:53,045 --> 00:11:55,314
There's not a lot of
space for any data

287
00:11:55,314 --> 00:11:57,949
on there realistically,
compared to the Echo devices

288
00:11:57,950 --> 00:11:59,752
that have I think
four gig of data.

289
00:11:59,752 --> 00:12:01,620
We're just looking at 256 megs.

290
00:12:03,189 --> 00:12:06,759
So, I got one of
my fellow convicts,

291
00:12:06,759 --> 00:12:10,496
uh Imperial Officers to help
read the data back for me.

292
00:12:10,496 --> 00:12:13,466
He was able to use just
regular chip off methodology,

293
00:12:13,466 --> 00:12:14,734
in this case a Rework station,

294
00:12:14,734 --> 00:12:16,769
to remove the chip, clean it up

295
00:12:16,769 --> 00:12:18,971
and read it with something
like the Dataman.

296
00:12:20,106 --> 00:12:22,408
An associate, Scott
Lalass, was able to help

297
00:12:22,408 --> 00:12:25,044
by sending some of
the chips to Dataman

298
00:12:25,044 --> 00:12:26,712
and they built a profile.

299
00:12:26,712 --> 00:12:28,414
Which means that
everyone with a Dataman

300
00:12:28,414 --> 00:12:30,549
is able to read the
Nan chip pretty easily.

301
00:12:33,519 --> 00:12:38,023
So, after we've read the
data, this is what we can see.

302
00:12:38,023 --> 00:12:39,125
Don't worry if you're
sitting at the back,

303
00:12:39,125 --> 00:12:40,426
I can't read this either.

304
00:12:41,260 --> 00:12:43,194
Most of it is garbage.

305
00:12:43,195 --> 00:12:45,831
Unfortunately there isn't
a really good file system

306
00:12:45,831 --> 00:12:49,835
that we can parse out and
so we're kind of just left

307
00:12:49,835 --> 00:12:52,071
with looking at strings.

308
00:12:52,071 --> 00:12:54,406
It's unfortunate, if
anyone is able to help

309
00:12:54,406 --> 00:12:57,910
figure out what the file
system is, that would be great.

310
00:12:57,910 --> 00:13:00,713
But unfortunately, I wasn't
able to figure it out.

311
00:13:02,515 --> 00:13:04,083
Thankfully, strings comes up

312
00:13:04,083 --> 00:13:05,684
with a lot of great information.

313
00:13:07,119 --> 00:13:08,654
So from here, we're
just gonna look

314
00:13:08,654 --> 00:13:11,490
for the Bluetooth devices
that we found previously,

315
00:13:11,490 --> 00:13:13,592
and I can see there's actually
another Bluetooth device

316
00:13:13,592 --> 00:13:14,827
that I didn't know about.

317
00:13:14,827 --> 00:13:16,562
And it's called
Luke's iPod touch.

318
00:13:16,562 --> 00:13:18,631
We've got a MAC address
there, we haven't got dates,

319
00:13:18,631 --> 00:13:21,634
which is not great, and
I don't actually know

320
00:13:21,634 --> 00:13:24,503
if this is the deleted file
or this is an allocated file

321
00:13:24,503 --> 00:13:27,439
with a log that just hasn't
been cleared out yet.

322
00:13:27,439 --> 00:13:29,007
But hey, that just
means that I know

323
00:13:29,008 --> 00:13:30,843
that there was another
device that we didn't see

324
00:13:30,843 --> 00:13:32,511
that we weren't able to examine,

325
00:13:32,511 --> 00:13:34,814
and maybe the terrorists
took it with them.

326
00:13:37,082 --> 00:13:39,117
This can also be
really, really useful

327
00:13:39,118 --> 00:13:41,353
if someone says,
"I was never there,

328
00:13:41,353 --> 00:13:43,656
"I didn't know anything
about that person."

329
00:13:43,656 --> 00:13:45,657
You've now got another
record to look at.

330
00:13:47,126 --> 00:13:49,461
We can also find the
Google account ID,

331
00:13:49,461 --> 00:13:52,364
which can also be very useful
as we've found it before.

332
00:13:52,364 --> 00:13:53,933
If you're able to
take that to Google,

333
00:13:53,933 --> 00:13:56,268
they might be able to
reverse that for you

334
00:13:56,268 --> 00:13:57,937
and tell you what
the account was,

335
00:13:57,937 --> 00:13:59,538
give you the information.

336
00:13:59,538 --> 00:14:01,173
I wasn't able to ask
Google that question,

337
00:14:01,173 --> 00:14:02,875
but they might be able to help.

338
00:14:03,976 --> 00:14:06,278
This can be really
useful if all you've got

339
00:14:06,278 --> 00:14:08,781
is the Google Home and
you need to find out

340
00:14:08,781 --> 00:14:11,150
who's account do I need?

341
00:14:11,150 --> 00:14:13,018
There's also the Cloud
device ID on there,

342
00:14:13,018 --> 00:14:15,020
but obviously you've
got the device, so.

343
00:14:16,155 --> 00:14:17,689
We wanna put it all together.

344
00:14:17,690 --> 00:14:19,525
We've now got the
Cloud device ID

345
00:14:19,525 --> 00:14:21,760
and the account
information on the left.

346
00:14:21,760 --> 00:14:24,029
We've got the NAND
Read and the Homespeak

347
00:14:24,029 --> 00:14:27,733
will give us the account
ID and the Cloud device ID,

348
00:14:27,733 --> 00:14:29,267
which is great.

349
00:14:29,268 --> 00:14:31,470
Now we've just got the Cloud
data that we wanna look at.

350
00:14:33,205 --> 00:14:36,175
So, Cloud is basically
where we're gonna be looking

351
00:14:36,175 --> 00:14:39,144
for all of the interaction
that we really care about.

352
00:14:40,746 --> 00:14:44,817
There's not really much
found on the device itself

353
00:14:44,817 --> 00:14:47,653
or on the app with regards
to any of the queries,

354
00:14:47,653 --> 00:14:50,222
any of the audio,
anything really outside

355
00:14:50,222 --> 00:14:52,024
of the Bluetooth
device interaction.

356
00:14:54,660 --> 00:14:56,896
So, I'm gonna cover
a couple of ways

357
00:14:56,896 --> 00:14:58,731
to get this Cloud
data and examine it,

358
00:14:58,731 --> 00:15:01,233
and then we're gonna talk
about what data was found

359
00:15:01,233 --> 00:15:02,568
that was very useful to me.

360
00:15:03,669 --> 00:15:05,804
So you can go to
myactivity.google.com

361
00:15:05,804 --> 00:15:09,241
and that will show you
all of the interactions

362
00:15:09,241 --> 00:15:10,776
for that account.

363
00:15:10,776 --> 00:15:12,710
I'm only going to
focus on assistant

364
00:15:12,711 --> 00:15:16,282
and voice and audio, but
if you have a Google device

365
00:15:16,282 --> 00:15:18,751
and you haven't been
to that website,

366
00:15:18,751 --> 00:15:20,452
you will be scared at
how much information

367
00:15:20,452 --> 00:15:21,553
is tracked and logged.

368
00:15:22,988 --> 00:15:24,957
But the good thing is, if
you filter for assistant

369
00:15:24,957 --> 00:15:26,625
and voice and audio,
you'll see all

370
00:15:26,625 --> 00:15:29,428
of the interactions with
the Google Home device.

371
00:15:29,428 --> 00:15:32,531
It will identify that a
Google Home device was used,

372
00:15:32,531 --> 00:15:34,465
not which Google Home device.

373
00:15:34,466 --> 00:15:36,669
So if you've got
two Google Homes,

374
00:15:36,669 --> 00:15:38,069
it might not be able to tell you

375
00:15:38,070 --> 00:15:39,672
which one's which.

376
00:15:39,672 --> 00:15:41,407
And the good thing is,
it will also identify

377
00:15:41,407 --> 00:15:43,709
there is a known
user's voice used.

378
00:15:43,709 --> 00:15:46,811
If two accounts have been
set up on the same device,

379
00:15:46,812 --> 00:15:49,114
it will tell you who said what.

380
00:15:49,114 --> 00:15:51,617
You may also come into problems

381
00:15:51,617 --> 00:15:53,352
if there are two users
set up on the account,

382
00:15:53,352 --> 00:15:56,322
because you'll need to access
two different Cloud accounts.

383
00:15:57,856 --> 00:16:01,460
To download this data, you're
gonna be using Google Takeout,

384
00:16:01,460 --> 00:16:03,662
which will get you
all the spoken words,

385
00:16:03,662 --> 00:16:05,164
it'll get you all
of the responses,

386
00:16:05,164 --> 00:16:08,167
all of the audio and the
location data if it's set.

387
00:16:08,167 --> 00:16:11,370
As I said, that location
is set by the user.

388
00:16:12,571 --> 00:16:14,406
Even though location
services is required

389
00:16:14,406 --> 00:16:16,875
when you turn the app
on to set the device up

390
00:16:16,875 --> 00:16:17,676
to begin with.

391
00:16:18,844 --> 00:16:21,380
The only downside with
using Takeout is it

392
00:16:21,380 --> 00:16:24,116
A, notifies the individual
that you're performing

393
00:16:24,116 --> 00:16:28,587
a Takeout and it also
will download everything.

394
00:16:28,587 --> 00:16:30,389
So if time is of the
essence or you're required

395
00:16:30,389 --> 00:16:32,791
to only obtain a
small amount of data,

396
00:16:32,791 --> 00:16:36,528
then Google Takeout may
not be the way to go.

397
00:16:36,528 --> 00:16:39,698
Unfortunately, currently it
is one of the only ways that

398
00:16:39,698 --> 00:16:42,266
you're learning to
get the most complete

399
00:16:42,267 --> 00:16:43,302
piece of information.

400
00:16:44,803 --> 00:16:46,972
Alternatively, I tested
a number of Cloud data

401
00:16:46,972 --> 00:16:48,007
acquisition tools.

402
00:16:49,174 --> 00:16:50,809
These tools are
basically the only ones

403
00:16:50,809 --> 00:16:53,978
that were able to provide the
information that I needed,

404
00:16:53,979 --> 00:16:56,648
and filter it out
in the right way.

405
00:16:56,648 --> 00:16:58,384
Some of the tools
will provide you

406
00:16:58,384 --> 00:17:00,152
with the Google
search information,

407
00:17:00,152 --> 00:17:02,454
but not actually determine
which device was used.

408
00:17:02,454 --> 00:17:04,556
Was it the phone,
was it the app,

409
00:17:04,556 --> 00:17:05,991
sorry was it the Home device?

410
00:17:08,627 --> 00:17:10,596
In the last three days
Google changed the API

411
00:17:10,596 --> 00:17:13,732
and every tool is
broken with regards

412
00:17:13,732 --> 00:17:16,801
to Cloud data acquisition of
this specific information.

413
00:17:16,801 --> 00:17:19,303
So Takeout is going
to be your best bet.

414
00:17:19,304 --> 00:17:22,041
But, once that's fixed,
I'm sure all the vendors

415
00:17:22,040 --> 00:17:25,210
are on it, we'll be able to
get all that information again.

416
00:17:25,210 --> 00:17:28,079
These tools are really
good at helping you search,

417
00:17:28,079 --> 00:17:30,581
sort, report on
that information,

418
00:17:30,582 --> 00:17:34,253
and so it's a good
idea to, if you can,

419
00:17:34,253 --> 00:17:36,655
get the Takeout
information as well as do

420
00:17:36,655 --> 00:17:40,158
an API acquisition and
then just compare the two.

421
00:17:40,159 --> 00:17:42,561
I know that some of the
vendors are also working on

422
00:17:42,561 --> 00:17:46,165
ingesting that Takeout data,
because they don't necessarily

423
00:17:46,165 --> 00:17:48,100
incorporate it in
a really good way

424
00:17:48,100 --> 00:17:50,869
that allows you to
easily review it.

425
00:17:54,106 --> 00:17:57,843
Alright, so specifically
about our case,

426
00:17:57,843 --> 00:17:58,710
what did we find?

427
00:17:59,912 --> 00:18:01,447
We found that
someone was asking,

428
00:18:01,447 --> 00:18:03,081
do they have anything
on their calendar?

429
00:18:03,082 --> 00:18:04,817
Unfortunately, in this instance,

430
00:18:04,817 --> 00:18:07,586
Google didn't tell me
what they actually found.

431
00:18:07,586 --> 00:18:10,222
The Home would've
responded in some way,

432
00:18:10,222 --> 00:18:13,192
but it doesn't always
tell you what they said.

433
00:18:13,192 --> 00:18:16,161
So I downloaded the Cloud,
the calendar from the Cloud,

434
00:18:17,563 --> 00:18:20,365
and that's pretty
damning that they wanted

435
00:18:20,365 --> 00:18:22,301
to blow up the Death
Star the next day.

436
00:18:24,002 --> 00:18:25,637
I don't know why they
call it the Death Star,

437
00:18:25,637 --> 00:18:27,139
I think that's crass.

438
00:18:27,139 --> 00:18:29,140
It's always been the DS-1
Orbital Battle Station.

439
00:18:29,141 --> 00:18:30,442
But, anyway.

440
00:18:32,478 --> 00:18:35,481
They also were asking curiously
about the weather on Hoth.

441
00:18:36,348 --> 00:18:37,182
So,

442
00:18:39,418 --> 00:18:40,752
I mean that's a clue, isn't it?

443
00:18:40,752 --> 00:18:42,187
I feel like that's a clue.

444
00:18:42,187 --> 00:18:44,590
And interestingly,
Google responded

445
00:18:44,590 --> 00:18:47,426
and it said, "Hoth's
climate is cold."

446
00:18:47,426 --> 00:18:49,928
Well yeah, Hoth's
climate is cold,

447
00:18:49,928 --> 00:18:52,197
but why wold they be
asking if that's not

448
00:18:52,197 --> 00:18:53,631
where they wanted to go next?

449
00:18:55,300 --> 00:18:57,202
Just a hint though,
when Darth Vader says,

450
00:18:57,202 --> 00:18:58,403
"They're in the Hoth System,"

451
00:18:58,403 --> 00:19:00,272
just go along with
it, it's just a trick.

452
00:19:01,940 --> 00:19:04,376
Alright, so for a
generalized process,

453
00:19:04,376 --> 00:19:06,645
what should we do if we're faced

454
00:19:06,645 --> 00:19:09,414
with a Google Home and
a phone at the scene?

455
00:19:11,750 --> 00:19:12,684
The first thing we're gonna do

456
00:19:12,684 --> 00:19:14,786
is get a physical acquisition,

457
00:19:14,786 --> 00:19:16,021
it's gonna be the only way

458
00:19:16,021 --> 00:19:17,956
that we're gonna get the
home ref information,

459
00:19:19,124 --> 00:19:22,427
and from there we can
identify the account

460
00:19:22,427 --> 00:19:25,197
and the Cloud device
ID from the Home Graph.

461
00:19:25,197 --> 00:19:27,399
Potentially more
information as well.

462
00:19:27,399 --> 00:19:30,068
I know that there's also the
date that the Google Home

463
00:19:30,068 --> 00:19:32,104
was added to that account,
but haven't been able

464
00:19:32,104 --> 00:19:33,772
to pull that
information out yet.

465
00:19:34,873 --> 00:19:36,909
We're then gonna
query the Home device.

466
00:19:36,909 --> 00:19:38,710
We can get the Cloud
device ID from there,

467
00:19:38,710 --> 00:19:40,846
as well as other Bluetooth data,

468
00:19:40,846 --> 00:19:42,381
if that's of relevance.

469
00:19:42,381 --> 00:19:44,249
And from there we can put
those two things together

470
00:19:44,249 --> 00:19:45,884
to confirm that
that's what we need,

471
00:19:45,884 --> 00:19:47,986
with the password
or the oAuth Token,

472
00:19:47,986 --> 00:19:49,154
to pull the Cloud data.

473
00:19:52,457 --> 00:19:54,393
So overall findings.

474
00:19:54,393 --> 00:19:55,627
What did we find?

475
00:19:55,627 --> 00:19:57,229
What do we know
from all of this?

476
00:19:57,229 --> 00:20:00,866
We know that the room
was probably related

477
00:20:00,866 --> 00:20:01,967
to someone named Luke.

478
00:20:03,335 --> 00:20:05,771
We know he had a calendar entry
to destroy the Death Star,

479
00:20:07,206 --> 00:20:09,574
and his home location was
set to the Skywalker Ranch.

480
00:20:09,575 --> 00:20:11,043
Which could be a
previous location,

481
00:20:11,043 --> 00:20:13,812
because we didn't find any
Homes on the Skywalker Ranch,

482
00:20:13,812 --> 00:20:15,647
we found them on Yavin.

483
00:20:15,647 --> 00:20:18,884
We've got the last date
and time that the phone

484
00:20:18,884 --> 00:20:20,586
was at the base.

485
00:20:20,586 --> 00:20:24,223
Which could be the last time
they were at the base as well.

486
00:20:24,223 --> 00:20:25,857
And we also know that
he was asking about

487
00:20:25,857 --> 00:20:27,059
the weather on Hoth.

488
00:20:27,059 --> 00:20:28,527
So we've got a
pretty decent idea

489
00:20:28,527 --> 00:20:29,962
of where we should look next.

490
00:20:32,531 --> 00:20:36,568
Further work is really where
I would like to look next

491
00:20:36,568 --> 00:20:38,704
to try and build out
the research for this.

492
00:20:38,704 --> 00:20:42,107
I would like to look in to
parsing the Home file system

493
00:20:42,107 --> 00:20:45,244
and decode the proto
file, but at the moment

494
00:20:45,244 --> 00:20:47,012
I haven't been able
to figure that out.

495
00:20:47,012 --> 00:20:50,249
As well as looking further
in to the iOS app data,

496
00:20:50,249 --> 00:20:51,316
in case that comes up.

497
00:20:52,451 --> 00:20:53,485
There are a few other features

498
00:20:53,485 --> 00:20:54,919
and a few other devices planned

499
00:20:54,920 --> 00:20:57,089
in the future with
regards to communication.

500
00:20:57,089 --> 00:21:00,359
I wasn't able to test
that as it wasn't provided

501
00:21:00,359 --> 00:21:02,828
in this situation, but
it's going to be coming

502
00:21:02,828 --> 00:21:05,430
across many iOT devices,
so that's something

503
00:21:05,430 --> 00:21:06,398
to look forward to.

504
00:21:08,100 --> 00:21:09,900
Lastly, I'd like to
thank a number of people

505
00:21:09,901 --> 00:21:11,870
that provided me with
their tools to test.

506
00:21:11,870 --> 00:21:13,504
All of these companies
were very gracious

507
00:21:13,505 --> 00:21:14,806
in providing me with their tools

508
00:21:14,806 --> 00:21:16,575
and so I thought I'd
give them a shout out,

509
00:21:16,575 --> 00:21:18,410
and I know a lot of
them will be working

510
00:21:18,410 --> 00:21:20,912
on improving this data,
as it's only gonna get

511
00:21:20,912 --> 00:21:22,748
more and more as time goes on.

512
00:21:22,748 --> 00:21:23,949
As well as a number of people

513
00:21:23,949 --> 00:21:25,350
for helping me
with the research,

514
00:21:25,350 --> 00:21:26,952
and providing me with test data.

515
00:21:28,086 --> 00:21:28,987
Cool, thank you.

516
00:21:29,955 --> 00:21:32,390
(crowd claps)

517
00:21:32,391 --> 00:21:35,160
(dramatic music)

