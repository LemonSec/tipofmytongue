1
00:00:00,600 --> 00:00:02,736
(ethereal music)

2
00:00:09,109 --> 00:00:10,243
(clapping)

3
00:00:10,243 --> 00:00:11,778
- Thank you very much, Phil.

4
00:00:11,778 --> 00:00:13,947
So, the black eye actually
came from a hockey injury.

5
00:00:13,947 --> 00:00:17,717
It was not ransomware
related I'm happy to say.

6
00:00:17,717 --> 00:00:19,119
But here, if you want
to see what I look like

7
00:00:19,119 --> 00:00:21,387
without the black eye,
it's right here for you

8
00:00:21,388 --> 00:00:23,890
in full high definition.

9
00:00:23,890 --> 00:00:25,225
So, my name is Kevin Perlow,

10
00:00:25,225 --> 00:00:26,826
I currently work at
Booz Allen Hamilton,

11
00:00:26,826 --> 00:00:28,028
and I'm a malware analyst.

12
00:00:28,028 --> 00:00:30,262
I do cyber threat intelligence

13
00:00:30,263 --> 00:00:31,731
along with some threat hunting,

14
00:00:31,731 --> 00:00:34,534
some host forensics,
a nice mix of things.

15
00:00:34,534 --> 00:00:36,569
I went to school at
Georgetown University

16
00:00:36,569 --> 00:00:38,004
actually for business and

17
00:00:38,004 --> 00:00:40,105
just sort of worked my
way into this industry.

18
00:00:40,106 --> 00:00:41,808
Thought it was a little
bit more interesting.

19
00:00:41,808 --> 00:00:45,478
So, what we have here is
we're gonna be talking about

20
00:00:45,478 --> 00:00:47,047
transactions on the blockchain,

21
00:00:47,047 --> 00:00:48,080
but we're not just
gonna be talking

22
00:00:48,081 --> 00:00:49,449
about Bitcoin transactions.

23
00:00:49,449 --> 00:00:51,217
That's gonna be
our primary focus.

24
00:00:51,217 --> 00:00:53,153
A little later on
we're gonna talk about

25
00:00:53,153 --> 00:00:54,788
Namecoin transactions as well

26
00:00:54,788 --> 00:00:56,623
'cause that's something
you're gonna start to see

27
00:00:56,623 --> 00:00:58,525
a little more nowadays.

28
00:00:58,525 --> 00:01:00,593
So the first thing is,
well what is a blockchain?

29
00:01:00,593 --> 00:01:02,662
A lot of time people talk
about the blockchain,

30
00:01:02,662 --> 00:01:05,632
and when they do that mean
the Bitcoin blockchain.

31
00:01:05,632 --> 00:01:08,301
But a blockchain
itself, it's just

32
00:01:08,301 --> 00:01:11,471
a series of recorded
transactions on a public ledger

33
00:01:11,471 --> 00:01:13,039
that's decentralized.

34
00:01:13,039 --> 00:01:14,240
So, a way to think about this,

35
00:01:14,240 --> 00:01:16,142
and using Bitcoin as an example,

36
00:01:16,142 --> 00:01:18,110
if I wanted, so my brother's
here in the audience,

37
00:01:18,111 --> 00:01:20,480
if I wanted to pay him
a dollar right now,

38
00:01:20,480 --> 00:01:22,582
all of you would
watch me do that

39
00:01:22,582 --> 00:01:25,085
and so you would all
agree that it happened,

40
00:01:25,085 --> 00:01:27,020
we would record it to a database

41
00:01:27,020 --> 00:01:28,688
and that transaction,

42
00:01:28,688 --> 00:01:31,491
no one could ever dispute
that it took place.

43
00:01:31,491 --> 00:01:33,259
With a blockchain,
what you do is

44
00:01:33,259 --> 00:01:36,329
when you have enough of these
new transactions and new data,

45
00:01:36,329 --> 00:01:39,966
you put it on a
block and from there

46
00:01:39,966 --> 00:01:42,235
you take a hash of the
previous block of data,

47
00:01:42,235 --> 00:01:44,137
and you put it in this new
block and you store it.

48
00:01:44,137 --> 00:01:46,106
And that's how it
builds on itself.

49
00:01:46,106 --> 00:01:47,607
That's all a blockchain is.

50
00:01:47,607 --> 00:01:50,710
If you're interested in the
cryptography behind a blockchain

51
00:01:50,710 --> 00:01:51,945
go to the RSA conference,

52
00:01:51,945 --> 00:01:53,512
we're not gonna
talk about it here.

53
00:01:53,513 --> 00:01:57,117
But, if you wanna talk about
some other things you can do

54
00:01:57,117 --> 00:01:59,552
besides from monetary
transactions,

55
00:01:59,552 --> 00:02:00,987
we have medical records,

56
00:02:00,987 --> 00:02:03,622
you could potentially use
blockchain technology for this,

57
00:02:03,623 --> 00:02:05,091
although I think after
this presentation

58
00:02:05,091 --> 00:02:07,893
you'll agree that
that's a horrible idea.

59
00:02:07,894 --> 00:02:09,662
You can do currency,
which we mentioned,

60
00:02:09,662 --> 00:02:13,299
and you can do DNS,
domain name system,

61
00:02:13,299 --> 00:02:15,235
where you have a decentralized
domain name system

62
00:02:15,235 --> 00:02:19,005
and so you have some
resiliency behind your domain.

63
00:02:19,005 --> 00:02:23,076
So, Bitcoins have become
the defacto currency for

64
00:02:25,211 --> 00:02:27,680
really any sort of illegal
activity on the internet,

65
00:02:27,680 --> 00:02:30,583
but it was designed to
just be an anonymous,

66
00:02:30,583 --> 00:02:34,220
or pseudo anonymous, way
to conduct transactions.

67
00:02:34,220 --> 00:02:36,289
So, Bitcoins are built around

68
00:02:36,289 --> 00:02:38,825
something called Bitcoin
wallets and Bitcoin addresses.

69
00:02:38,825 --> 00:02:40,326
You can think of
a Bitcoin wallet

70
00:02:40,326 --> 00:02:42,962
as something that holds a
lot of prepaid debit cards,

71
00:02:42,962 --> 00:02:44,863
which would be the
Bitcoin addresses.

72
00:02:44,864 --> 00:02:46,866
And there is something
very interesting here.

73
00:02:46,866 --> 00:02:49,669
If you go to a store,
when you purchase

74
00:02:49,669 --> 00:02:51,771
a good or product
from that store

75
00:02:51,771 --> 00:02:53,839
you might only turn over,

76
00:02:53,840 --> 00:02:56,442
if you have $20 on one of
these prepaid debit cards,

77
00:02:56,442 --> 00:02:58,444
you might only turn over
15 of those dollars.

78
00:02:58,444 --> 00:03:02,649
But with Bitcoins, you
turn over the whole 20,

79
00:03:02,649 --> 00:03:05,051
and then it sends part of
it back to you as change.

80
00:03:05,051 --> 00:03:07,352
And so the way that it
goes back as change,

81
00:03:07,353 --> 00:03:08,688
it can either be
to the same address

82
00:03:08,688 --> 00:03:11,357
that sent it to the
recipient address,

83
00:03:11,357 --> 00:03:13,526
or it could go to a
different address.

84
00:03:13,526 --> 00:03:14,794
And that all just depends on how

85
00:03:14,794 --> 00:03:16,229
your Bitcoin wallet
is configured

86
00:03:16,229 --> 00:03:19,199
and which Bitcoin wallet
system you're using.

87
00:03:19,199 --> 00:03:22,335
That particular nuance
is gonna be important

88
00:03:22,335 --> 00:03:24,938
for tracking some of
these things down.

89
00:03:24,938 --> 00:03:26,673
And so I have that
captured here.

90
00:03:26,673 --> 00:03:28,675
Two different examples,
the one on the top,

91
00:03:28,675 --> 00:03:31,511
lets assume you're buying a
banned book for a Bitcoin.

92
00:03:31,511 --> 00:03:33,680
You might send 20 Bitcoins over,

93
00:03:33,680 --> 00:03:36,382
one would come back to
the same Bitcoin address.

94
00:03:36,382 --> 00:03:38,351
Alternatively, you have
the example on the bottom

95
00:03:38,351 --> 00:03:40,053
where you send 20 Bitcoins over,

96
00:03:40,053 --> 00:03:41,788
19 go back to the ...

97
00:03:42,989 --> 00:03:44,190
Sorry, I misspoke
on the first one,

98
00:03:44,190 --> 00:03:45,725
19 go back to the
first Bitcoin address.

99
00:03:45,725 --> 00:03:48,695
On the second one, 19 go back
to the second Bitcoin address,

100
00:03:48,695 --> 00:03:50,162
it's a totally
different address.

101
00:03:50,163 --> 00:03:51,931
And, you know, the
theory behind this

102
00:03:51,931 --> 00:03:54,000
is that it makes it a
little harder to tell

103
00:03:54,000 --> 00:03:58,171
who received verus who gave
the money in a transaction.

104
00:04:00,873 --> 00:04:03,176
So, that's what we're
gonna jump into here is

105
00:04:03,176 --> 00:04:04,911
how do we track
these transactions.

106
00:04:04,911 --> 00:04:06,546
There are really
only two resources

107
00:04:06,546 --> 00:04:07,947
that we're gonna need.

108
00:04:07,947 --> 00:04:09,816
The first is Blockchain.info.

109
00:04:09,816 --> 00:04:11,618
It has an API, it's very useful.

110
00:04:11,618 --> 00:04:13,886
It tracks all
Bitcoin transactions,

111
00:04:13,886 --> 00:04:16,089
and it records the
timestamps for them,

112
00:04:16,089 --> 00:04:18,091
it records the addresses
that were sending money,

113
00:04:18,091 --> 00:04:20,560
addresses receiving money.

114
00:04:20,560 --> 00:04:22,495
And what we can do with that is,

115
00:04:22,495 --> 00:04:24,564
anytime you have an address
from a ransom payment

116
00:04:24,564 --> 00:04:25,598
you can just throw it in there

117
00:04:25,598 --> 00:04:27,033
and see what you find.

118
00:04:27,033 --> 00:04:29,235
The other tool is going
to be Wallet Explorer.

119
00:04:29,235 --> 00:04:30,803
It does the same thing,

120
00:04:30,803 --> 00:04:32,505
but the purpose behind
Wallet Explorer,

121
00:04:32,505 --> 00:04:34,574
and the interface
behind Wallet Explorer,

122
00:04:34,574 --> 00:04:38,911
is instead to correlate the
addresses into certain wallets,

123
00:04:38,911 --> 00:04:40,713
and in some cases to
identify those wallets

124
00:04:40,713 --> 00:04:44,517
with Bitcoin exchanges, or
other major Bitcoin entities.

125
00:04:44,517 --> 00:04:46,219
So, they do two
different things,

126
00:04:46,219 --> 00:04:47,687
they work very well in tandem.

127
00:04:47,687 --> 00:04:49,389
The person that
made Wallet Explorer

128
00:04:49,389 --> 00:04:51,024
actually now works
for Chainanalysis,

129
00:04:51,024 --> 00:04:53,993
which you can think of as
the premium version of this.

130
00:04:53,993 --> 00:04:56,629
So we're gonna be using
both of those tools.

131
00:04:56,629 --> 00:04:58,131
So we're gonna start simple.

132
00:04:58,131 --> 00:04:59,431
We're gonna use something
called the Globe Ransomware.

133
00:04:59,432 --> 00:05:01,868
This is not a major
ransomware family,

134
00:05:01,868 --> 00:05:05,738
but it illustrates what
we're doing pretty well.

135
00:05:05,738 --> 00:05:07,240
So I did redact
the personal key,

136
00:05:07,240 --> 00:05:09,175
but you can imagine having
one of these messages

137
00:05:09,175 --> 00:05:10,376
show up on your screen,

138
00:05:10,376 --> 00:05:12,010
and I think most of
the people in this room

139
00:05:12,011 --> 00:05:13,546
have either handled an incident,

140
00:05:13,546 --> 00:05:16,449
or you do malware analysis,
you're familiar with these.

141
00:05:16,449 --> 00:05:18,251
There's also ...

142
00:05:18,251 --> 00:05:19,986
What this message says,

143
00:05:19,986 --> 00:05:23,423
it says to go email
frogobigens@india.com

144
00:05:24,857 --> 00:05:26,993
and if you email him and you
tell him you've been infected,

145
00:05:26,993 --> 00:05:29,729
and you give him your id,
which we redacted here.

146
00:05:29,729 --> 00:05:32,231
He'll go ahead and he'll
give you a Bitcoin address.

147
00:05:32,231 --> 00:05:34,233
And you can also see
that there's a price

148
00:05:34,233 --> 00:05:36,569
for point five Bitcoins that
you're gonna have to pay.

149
00:05:36,569 --> 00:05:38,504
The first thing if you're
handling one of these incidents,

150
00:05:38,504 --> 00:05:40,740
just to kind of, as
a bit of a side note,

151
00:05:40,740 --> 00:05:42,141
you wanna look up
that email address

152
00:05:42,141 --> 00:05:44,877
because you wanna see,
you wanna get a sense of

153
00:05:44,877 --> 00:05:46,979
has this guy been around
doing anything else.

154
00:05:46,979 --> 00:05:49,982
Has he used other ransomware
families - and he has.

155
00:05:49,982 --> 00:05:52,318
Do we know any other
TTP's associated with him

156
00:05:52,318 --> 00:05:54,820
because we ultimately don't
want to just decrypt our files,

157
00:05:54,821 --> 00:05:57,023
we want to prevent this
from happening again.

158
00:05:57,023 --> 00:06:00,226
This person, we suspect, is
primarily associated with

159
00:06:00,226 --> 00:06:02,762
RDP group force attacks,

160
00:06:02,762 --> 00:06:07,033
maybe even PS exact
remote, reports, attacks.

161
00:06:07,033 --> 00:06:09,469
So we got that address
from him, it's at the top,

162
00:06:09,469 --> 00:06:12,004
right under the title
here, the 1Hyas,

163
00:06:12,004 --> 00:06:13,506
and we throw it
in Blockchain.info

164
00:06:13,506 --> 00:06:15,875
and this is what you get,
and this isn't a full list,

165
00:06:15,875 --> 00:06:17,076
I snipped some
out of the middle.

166
00:06:17,076 --> 00:06:19,212
But you can see that
there were other people

167
00:06:19,212 --> 00:06:21,481
who paid 0.5 Bitcoins.

168
00:06:21,481 --> 00:06:23,783
So the good news is other
people are paying this person,

169
00:06:23,783 --> 00:06:25,752
you're probably gonna
get your files back

170
00:06:25,752 --> 00:06:28,654
if you were to make a
payment and get the decrypter

171
00:06:28,654 --> 00:06:30,089
it'll probably work.

172
00:06:30,089 --> 00:06:34,127
The bad news is other
people are paying this guy,

173
00:06:34,127 --> 00:06:35,528
I believe it's 1.5
Bitcoins sorry,

174
00:06:35,528 --> 00:06:39,098
other people are
paying this guy and,

175
00:06:39,098 --> 00:06:41,601
so you probably do
also need to pay him

176
00:06:41,601 --> 00:06:42,835
to get your files back,

177
00:06:42,835 --> 00:06:43,803
there probably isn't a
free decrypter out there

178
00:06:43,803 --> 00:06:45,671
otherwise who would bother.

179
00:06:45,671 --> 00:06:47,272
The next thing you wanna do is

180
00:06:47,273 --> 00:06:49,475
you wanna post this
on Wallet Explorer.

181
00:06:49,475 --> 00:06:52,111
So on this screen you can
see that total received,

182
00:06:52,111 --> 00:06:54,247
but on Wallet Explorer
you get a whole list

183
00:06:54,247 --> 00:06:56,349
of all the transactions
that this persons had,

184
00:06:56,349 --> 00:06:58,551
and so the output
from Wallet Explorer

185
00:06:58,551 --> 00:07:00,420
is on the left
part of the slide.

186
00:07:00,420 --> 00:07:01,687
You can dump it as a CSV,

187
00:07:01,687 --> 00:07:03,623
which shows up on the
right part of the slide.

188
00:07:03,623 --> 00:07:06,392
And what we can do here is take,

189
00:07:06,392 --> 00:07:08,461
take inventory of what
he's been receiving.

190
00:07:08,461 --> 00:07:12,398
So, we're interested in
probable ransom income,

191
00:07:12,398 --> 00:07:14,367
that's gonna be ransom, or
that's gonna be payments

192
00:07:14,367 --> 00:07:16,202
to this Bitcoin wallet

193
00:07:16,202 --> 00:07:18,838
where the amount was exactly
the same as in the ransom note,

194
00:07:18,838 --> 00:07:21,474
and we come up with 24 of those.

195
00:07:21,474 --> 00:07:22,707
Another metric I had,

196
00:07:22,708 --> 00:07:24,343
because we're really
just estimating here,

197
00:07:24,343 --> 00:07:26,879
is what about possible
ransom income?

198
00:07:26,879 --> 00:07:29,715
The possible ransom
income is the,

199
00:07:30,583 --> 00:07:31,851
the metric I came up with

200
00:07:31,851 --> 00:07:33,886
was anything that was
four digits or fewer.

201
00:07:33,886 --> 00:07:37,924
So, if someone paid 1.75 that
might be a ransom payment,

202
00:07:37,924 --> 00:07:39,459
that's a pretty specific amount.

203
00:07:39,459 --> 00:07:41,994
In the cyber
criminal underground,

204
00:07:41,994 --> 00:07:44,564
even though they use Bitcoins
for these transactions,

205
00:07:44,564 --> 00:07:46,332
they typically peg the Bitcoin

206
00:07:46,332 --> 00:07:49,469
to some sort of currency
value, often USD.

207
00:07:49,469 --> 00:07:50,969
And so what you're
gonna see instead

208
00:07:50,970 --> 00:07:52,905
for more of a business
like transaction

209
00:07:52,905 --> 00:07:55,241
that's not ransomware
transaction,

210
00:07:55,241 --> 00:07:57,676
you'll see something
like 1.7829,

211
00:07:57,677 --> 00:07:59,245
some longer number like that.

212
00:07:59,245 --> 00:08:01,380
So that's where we came
up with the other number.

213
00:08:01,380 --> 00:08:02,949
Now you might say this
is a pretty wide range,

214
00:08:02,949 --> 00:08:04,617
it's a factor of two,

215
00:08:04,617 --> 00:08:06,185
but what I find,
and what we'll see

216
00:08:06,185 --> 00:08:08,621
when we go into the Locky
example coming up in a second,

217
00:08:08,621 --> 00:08:10,722
is it's really an
order of magnitude

218
00:08:10,723 --> 00:08:12,225
that we're concerned about.

219
00:08:12,225 --> 00:08:14,594
So, this guy, we're talking in
the 10s of 1000s of dollars,

220
00:08:14,594 --> 00:08:17,063
maybe up to $50,000
is what he's received

221
00:08:17,063 --> 00:08:18,965
over the many months that
he's been doing this,

222
00:08:18,965 --> 00:08:21,700
about six months,
a year to date.

223
00:08:23,536 --> 00:08:25,104
So, so that's good.

224
00:08:25,104 --> 00:08:26,606
I mean this doesn't
tell us a whole lot,

225
00:08:26,606 --> 00:08:29,275
but it illustrates the point
in how to use these tools.

226
00:08:29,275 --> 00:08:31,277
What we're a little
more interested in

227
00:08:31,277 --> 00:08:34,246
is gonna be this Locky
ransomware example.

228
00:08:34,246 --> 00:08:36,248
This is one of my favorite ones.

229
00:08:36,249 --> 00:08:37,517
So, what's interesting here is

230
00:08:37,517 --> 00:08:39,218
we're gonna see
a sense of scale.

231
00:08:39,217 --> 00:08:42,755
So, Locky ransomware came out
in January, February 2016,

232
00:08:42,755 --> 00:08:44,891
it was famous for
hitting a hospital.

233
00:08:44,891 --> 00:08:46,791
And a hospital has to
stay in operations,

234
00:08:46,792 --> 00:08:49,996
so they had no choice
but to pay the ransom.

235
00:08:49,996 --> 00:08:53,466
And this Locky example,
what we're gonna find is

236
00:08:53,466 --> 00:08:55,968
they're not alone, a lot
of people have paid this.

237
00:08:55,968 --> 00:08:57,536
So on the bottom
right of this screen

238
00:08:57,537 --> 00:09:00,206
is gonna be the
Bitcoin address that

239
00:09:00,206 --> 00:09:02,608
you would have to pay for this
particular Locky instance.

240
00:09:02,608 --> 00:09:04,109
But what I have to point out

241
00:09:04,110 --> 00:09:05,945
is that for the
Locky ransomware,

242
00:09:05,945 --> 00:09:09,982
and for a lot of other
sophisticated cyber crime,

243
00:09:09,982 --> 00:09:12,617
or cyber crime group
affiliated ransomware,

244
00:09:12,618 --> 00:09:14,153
where it's not just one actor,

245
00:09:14,153 --> 00:09:15,655
these are generated server side

246
00:09:15,655 --> 00:09:18,524
and they're generated unique
to each instance of Locky.

247
00:09:18,524 --> 00:09:21,394
So, what that means is when
you first get this address

248
00:09:21,394 --> 00:09:23,429
it's gonna be blank.

249
00:09:23,429 --> 00:09:25,298
I should also say, this
was one provided by

250
00:09:25,298 --> 00:09:26,799
another security analyst,

251
00:09:26,799 --> 00:09:29,135
I do just wanna thank them
for contributing this.

252
00:09:29,135 --> 00:09:31,069
They didn't want me
to say who they were.

253
00:09:31,070 --> 00:09:32,972
But it is, we couldn't
do this type of analysis

254
00:09:32,972 --> 00:09:34,574
without having this happen.

255
00:09:34,574 --> 00:09:38,109
So, because it's a unique
Locky Bitcoin address,

256
00:09:38,110 --> 00:09:40,179
in order for us to get
any data out of this

257
00:09:40,179 --> 00:09:41,747
someone has to pay it.

258
00:09:41,747 --> 00:09:45,318
And, so that, once
someone pays it

259
00:09:45,318 --> 00:09:47,019
the criminal then
has to move the money

260
00:09:47,019 --> 00:09:48,688
because otherwise they
wouldn't be able to use it,

261
00:09:48,688 --> 00:09:50,089
they wouldn't be
able to cash it out,

262
00:09:50,089 --> 00:09:51,557
and it would be a totally
worthless exercise

263
00:09:51,557 --> 00:09:53,259
for everybody involved.

264
00:09:53,259 --> 00:09:54,860
And it happens here.

265
00:09:54,860 --> 00:09:56,462
On the bottom left
we have our victim,

266
00:09:56,462 --> 00:09:59,699
on the bottom right we
have that money being paid.

267
00:09:59,699 --> 00:10:01,633
Then it, this is just
the default interface

268
00:10:01,634 --> 00:10:02,868
for Blockchain.info,

269
00:10:02,868 --> 00:10:04,937
on the top left the
money moves again,

270
00:10:04,937 --> 00:10:06,806
and it moves as part
of a much larger,

271
00:10:06,806 --> 00:10:08,741
I think 80 Bitcoin transaction.

272
00:10:08,741 --> 00:10:10,276
And what that means

273
00:10:10,276 --> 00:10:12,243
is there were other Bitcoin
addresses involved in this.

274
00:10:12,244 --> 00:10:13,479
So our next step here

275
00:10:13,479 --> 00:10:15,114
is where things start
to get interesting.

276
00:10:15,114 --> 00:10:17,850
We wanna map out the blockchain.

277
00:10:17,850 --> 00:10:19,251
That might seem like
a daunting task,

278
00:10:19,251 --> 00:10:21,520
and it is, but here you go.

279
00:10:22,955 --> 00:10:24,924
So, on the left there's
a script that's on Github

280
00:10:24,924 --> 00:10:25,858
that you can use to do this,

281
00:10:25,858 --> 00:10:27,093
you plug in an address

282
00:10:27,093 --> 00:10:28,761
and it'll map this out
in graphviz format.

283
00:10:28,761 --> 00:10:30,930
But we some very interesting,
just looking at this,

284
00:10:30,930 --> 00:10:32,263
and I know you can't read them,

285
00:10:32,264 --> 00:10:34,567
we'll get to that in a
second, we'll zoom in.

286
00:10:34,567 --> 00:10:36,836
But, on the left, the
circles on the left,

287
00:10:36,836 --> 00:10:39,238
or the ovals on the left,
are gonna be people paying,

288
00:10:39,238 --> 00:10:40,706
those are gonna be the victims.

289
00:10:40,706 --> 00:10:42,441
In the middle those are
those intermediate addresses,

290
00:10:42,441 --> 00:10:46,012
and then on the right,
if we go back here,

291
00:10:46,012 --> 00:10:47,613
there we go, on the
right are gonna be

292
00:10:47,613 --> 00:10:49,949
those two addresses
that received the money,

293
00:10:49,949 --> 00:10:52,385
it turns out other
addresses are also funneling

294
00:10:52,385 --> 00:10:53,753
money into these two points.

295
00:10:53,753 --> 00:10:55,254
So, we're interested in those,

296
00:10:55,254 --> 00:10:57,056
and that's where we're
gonna do our exploration.

297
00:10:57,056 --> 00:10:59,825
But first, someone earlier
had an enhance button,

298
00:10:59,825 --> 00:11:03,129
so do I and mines
better, it has a red box.

299
00:11:03,129 --> 00:11:07,600
So we have, this is one of the
other sections on that graph,

300
00:11:07,600 --> 00:11:09,368
and we've identified just by

301
00:11:09,368 --> 00:11:11,837
throwing this into
Blockchain.info,

302
00:11:11,837 --> 00:11:13,706
we've identified another
possible ransom payment

303
00:11:13,706 --> 00:11:15,341
because we have two Bitcoins

304
00:11:15,341 --> 00:11:18,711
that's around the right
amount for, or three Bitcoins,

305
00:11:18,711 --> 00:11:20,680
whatever, it's around
the right amount

306
00:11:20,680 --> 00:11:22,982
for a ransomware payment.

307
00:11:22,982 --> 00:11:24,550
And if you go and you
look at the other ones

308
00:11:24,550 --> 00:11:26,952
you'll find the same thing
over and over and over again.

309
00:11:26,952 --> 00:11:29,488
So we do wanna dive into
where this money's going.

310
00:11:29,488 --> 00:11:31,257
So we throw it into
wallet explorer

311
00:11:31,257 --> 00:11:32,791
and what do we have?

312
00:11:32,792 --> 00:11:36,629
Well, we have that this, one
of these receiving addresses

313
00:11:36,629 --> 00:11:38,931
is part of a much larger list

314
00:11:38,931 --> 00:11:41,834
and it's received 81
pages on wallet explorer

315
00:11:41,834 --> 00:11:43,234
worth of transactions.

316
00:11:43,235 --> 00:11:44,704
This is a lot.

317
00:11:44,704 --> 00:11:47,039
In fact this is a very
very very very large number

318
00:11:47,039 --> 00:11:49,909
for a non Bitcoin exchange.

319
00:11:49,909 --> 00:11:52,444
You can also see, it's a
little hard to read the numbers

320
00:11:52,445 --> 00:11:54,847
on there, but you can see a
lot of single digit numbers,

321
00:11:54,847 --> 00:11:57,483
those are gonna be
three, four, two, five,

322
00:11:57,483 --> 00:12:01,554
those are about the right
amount for a ransomware payment.

323
00:12:01,554 --> 00:12:04,290
And so if you go through
all 80 pages of this,

324
00:12:04,290 --> 00:12:05,790
that's what you find
over and over again

325
00:12:05,791 --> 00:12:09,128
is that these guys
since January 2016,

326
00:12:09,128 --> 00:12:10,930
conveniently when
Locky came out,

327
00:12:10,930 --> 00:12:13,265
all the way through
October 2016,

328
00:12:13,265 --> 00:12:14,567
and then they took
a bit of a break,

329
00:12:14,567 --> 00:12:16,268
and then in January 2017,

330
00:12:16,268 --> 00:12:18,170
were receiving these
ransom payments.

331
00:12:18,170 --> 00:12:20,372
So our next question here is

332
00:12:20,372 --> 00:12:22,440
well what, you know,
what does this all mean?

333
00:12:22,441 --> 00:12:24,643
Like what can we do this data?

334
00:12:24,643 --> 00:12:25,911
The first thing I wanna do

335
00:12:25,911 --> 00:12:27,680
is come up with some
estimate, excuse me,

336
00:12:27,680 --> 00:12:30,315
some estimate of how
much money they've made.

337
00:12:30,316 --> 00:12:31,550
There are, there's a
couple different ways,

338
00:12:31,550 --> 00:12:32,785
there's a conservative one,

339
00:12:32,785 --> 00:12:35,187
so only transactions by .25,

340
00:12:35,187 --> 00:12:37,289
the one from before, the
four characters in length,

341
00:12:37,289 --> 00:12:39,358
and then one where we
just add them all up

342
00:12:39,358 --> 00:12:40,825
and we can do that.

343
00:12:40,826 --> 00:12:43,496
They've never even received
any increment over 10 Bitcoins.

344
00:12:43,496 --> 00:12:44,730
So it's entirely possible

345
00:12:44,730 --> 00:12:46,432
everything here was
a ransom payment.

346
00:12:46,432 --> 00:12:48,134
And so you can see
the numbers there,

347
00:12:48,134 --> 00:12:49,435
I tend to think we're talking

348
00:12:49,435 --> 00:12:52,170
somewhere between 13 and
14,000 Bitcoins on this.

349
00:12:52,171 --> 00:12:54,840
I'm sure other people have
paid them for other things,

350
00:12:54,840 --> 00:12:57,276
but the point stands,

351
00:12:57,276 --> 00:13:01,079
even back in 2016
Bitcoin currency value,

352
00:13:01,080 --> 00:13:03,182
we were looking at
over $10,000,000

353
00:13:03,182 --> 00:13:05,351
from January through October.

354
00:13:05,351 --> 00:13:08,254
That's crazy, and when
you do the victim count

355
00:13:08,254 --> 00:13:12,358
you're looking at 6,000,
8,000 victims that have paid.

356
00:13:12,358 --> 00:13:14,727
That's not even the people that
were just infected with it,

357
00:13:14,727 --> 00:13:16,161
and couldn't figure
out how to pay,

358
00:13:16,162 --> 00:13:18,063
or just said I'm not gonna pay.

359
00:13:18,063 --> 00:13:20,866
That number, they have
targets on the cyber criminal

360
00:13:20,866 --> 00:13:22,367
underground for these things,

361
00:13:22,368 --> 00:13:26,138
but that number could easily
be 5% of the total infections.

362
00:13:26,138 --> 00:13:27,239
It could be even less than that.

363
00:13:27,239 --> 00:13:29,141
We, that part we
just don't know.

364
00:13:29,141 --> 00:13:31,676
The point is this is
such a huge scale.

365
00:13:31,677 --> 00:13:33,813
So how does this help as
an incident responder?

366
00:13:33,813 --> 00:13:36,314
Well, the main thing for
an incident responder

367
00:13:36,315 --> 00:13:38,250
is to figure out, or
one of the main things,

368
00:13:38,250 --> 00:13:42,221
who targeted us, or was
this even a targeted attack?

369
00:13:42,221 --> 00:13:44,456
Probably not if you're getting
hit by something like this

370
00:13:44,456 --> 00:13:46,992
where there are 81 other
pages of ransom transactions.

371
00:13:46,992 --> 00:13:49,093
I mean maybe they targeted
your industry, maybe not,

372
00:13:49,094 --> 00:13:51,030
but when we think back
to the globe example

373
00:13:51,030 --> 00:13:52,631
where we thought, OK,
that was more of an

374
00:13:52,631 --> 00:13:54,300
RDP group force attack.

375
00:13:54,300 --> 00:13:56,301
The after, you know, you wanna,

376
00:13:56,302 --> 00:13:58,170
you wanna do a
complete investigation,

377
00:13:58,170 --> 00:14:00,506
but the priority you're gonna
take into certain actions

378
00:14:00,506 --> 00:14:01,940
after this are
gonna be different.

379
00:14:01,941 --> 00:14:04,844
You're not gonna be necessarily
worried about closing down

380
00:14:04,844 --> 00:14:07,880
an open RDP port that
shouldn't be there.

381
00:14:07,880 --> 00:14:09,148
Instead you're gonna
be worried about

382
00:14:09,148 --> 00:14:10,816
well we probably have to
fix our email filtering

383
00:14:10,816 --> 00:14:12,685
and upgrade some detection logic

384
00:14:12,685 --> 00:14:14,319
and stop this from happening.

385
00:14:14,320 --> 00:14:16,322
But they're two
different approaches,

386
00:14:16,322 --> 00:14:17,957
the main point being at
least you're not concerned

387
00:14:17,957 --> 00:14:19,725
that you were targeted,
everyone was targeted,

388
00:14:19,725 --> 00:14:23,362
you're just concerned
that you were infected.

389
00:14:23,362 --> 00:14:26,397
The last point I want to
take here is the cash outs.

390
00:14:26,398 --> 00:14:28,734
So, here you can see
them actually moving

391
00:14:28,734 --> 00:14:32,905
220, 100, 150 Bitcoins to
an exchange called BTC-e.

392
00:14:34,106 --> 00:14:36,175
They did use a couple
of other exchanges,

393
00:14:36,175 --> 00:14:37,376
you can see some
other cash outs here

394
00:14:37,376 --> 00:14:39,411
that weren't identified
by Wallet Explorer,

395
00:14:39,411 --> 00:14:40,912
but that's just what
these guys tend to do,

396
00:14:40,913 --> 00:14:44,683
the tend to put about 50 to
100 to 200 Bitcoins at a time

397
00:14:44,683 --> 00:14:45,951
and they cash it out.

398
00:14:45,951 --> 00:14:49,355
And because there's no
way to subpoena BTC-e,

399
00:14:49,355 --> 00:14:51,023
unless their database
ever gets leaked,

400
00:14:51,023 --> 00:14:52,458
or unless law
enforcement finds a way

401
00:14:52,458 --> 00:14:54,959
to compel them to
turn over that data,

402
00:14:54,960 --> 00:14:57,830
out the money goes and we
don't know who's getting it.

403
00:14:57,830 --> 00:14:59,231
If they ever do get that data,

404
00:14:59,231 --> 00:15:02,167
then we'll be able to find out.

405
00:15:02,167 --> 00:15:06,171
So, the third thing we wanna
talk about is attribution.

406
00:15:06,171 --> 00:15:07,973
There's sort of a
myth behind Bitcoins

407
00:15:07,973 --> 00:15:09,942
that you can never do
any sort of attribution.

408
00:15:09,942 --> 00:15:13,112
This is, not a totally
unique example,

409
00:15:13,112 --> 00:15:15,079
it's a little rarer,
but I did wanna show it

410
00:15:15,080 --> 00:15:16,815
because it's interesting.

411
00:15:16,815 --> 00:15:19,385
There is a way to do
some deductive reasoning

412
00:15:19,385 --> 00:15:21,620
and come up with an attribution,

413
00:15:21,620 --> 00:15:23,422
at least in this
particular instance.

414
00:15:23,422 --> 00:15:24,990
So this is a Shark
and Atom ransomware.

415
00:15:24,990 --> 00:15:26,926
It kind of hit the news in Oct,

416
00:15:26,926 --> 00:15:29,895
I wanna say around
October 2016 actually,

417
00:15:29,895 --> 00:15:31,196
around the same time frame as

418
00:15:31,196 --> 00:15:34,400
when that Locky
activity was happening

419
00:15:34,400 --> 00:15:36,869
when we started
focusing in on that.

420
00:15:36,869 --> 00:15:38,771
The idea behind the
Shark ransomware was

421
00:15:38,771 --> 00:15:40,939
hey we'll give you a portal,
or we'll give you a tool,

422
00:15:40,940 --> 00:15:43,442
and you can use that tool to
build your own ransomware.

423
00:15:43,442 --> 00:15:44,643
You put in your Bitcoin address,

424
00:15:44,643 --> 00:15:46,845
we're just gonna
take 20% of the cut.

425
00:15:46,845 --> 00:15:48,614
The source advertised
on a Russian website,

426
00:15:48,614 --> 00:15:51,250
so were these people Russian?

427
00:15:51,250 --> 00:15:52,751
It would be a reasonable guess,

428
00:15:52,751 --> 00:15:55,154
but we would like a
second data point on that.

429
00:15:55,154 --> 00:15:57,723
And so here on the bottom
you can see the panel.

430
00:15:57,723 --> 00:15:59,525
You can see the ransom note.

431
00:15:59,525 --> 00:16:01,627
But more interestingly,
you can watch

432
00:16:01,627 --> 00:16:03,829
on the blockchain, or you
could watch at the time

433
00:16:03,829 --> 00:16:06,364
when this was in service,

434
00:16:06,365 --> 00:16:09,101
the money go to
a payment address

435
00:16:09,101 --> 00:16:11,603
that was specified
by the attacker,

436
00:16:11,603 --> 00:16:15,373
and then at the top you can
see an 80 20 split happen

437
00:16:15,374 --> 00:16:18,310
for when it was making the
payment on the blockchain,

438
00:16:18,310 --> 00:16:20,179
going, the 20% going
to the authors,

439
00:16:20,179 --> 00:16:23,247
the 80% going to the attacker.

440
00:16:23,248 --> 00:16:24,550
As far as network forensics go

441
00:16:24,550 --> 00:16:26,084
it's kind of exciting
to watch this happen

442
00:16:26,085 --> 00:16:29,188
on the blockchain and then
watch it happen in a PCAP

443
00:16:29,188 --> 00:16:31,023
as it's coming back
to the infected host.

444
00:16:31,023 --> 00:16:32,524
It's kind of cool.

445
00:16:33,492 --> 00:16:35,294
But what's even more cool is

446
00:16:35,294 --> 00:16:37,196
they use that same address for,

447
00:16:37,196 --> 00:16:39,832
they didn't generate
a new 20% address,

448
00:16:39,832 --> 00:16:41,165
they used the same one for

449
00:16:41,166 --> 00:16:43,435
a host of other transactions
and at one point

450
00:16:43,435 --> 00:16:46,472
they might have
even paid themselves

451
00:16:46,472 --> 00:16:47,805
through a chain of events,

452
00:16:47,806 --> 00:16:49,641
possibly testing their
own infrastructure.

453
00:16:49,641 --> 00:16:51,577
It's not entirely clear if
they were running a test,

454
00:16:51,577 --> 00:16:54,246
or if they were just paying a
different address of theirs,

455
00:16:54,246 --> 00:16:55,714
or a different wallet of theirs.

456
00:16:55,714 --> 00:16:56,949
But you can see the graph here,

457
00:16:56,949 --> 00:16:58,383
it looks similar to
the other graphs.

458
00:16:58,384 --> 00:17:01,120
And in red is gonna
be this 1FzW Address,

459
00:17:01,120 --> 00:17:03,055
which is where they're
receiving these 20%s.

460
00:17:03,055 --> 00:17:04,757
And that's gonna be
the main pivot point

461
00:17:04,757 --> 00:17:07,493
for what we're gonna do next.

462
00:17:07,492 --> 00:17:09,028
So we throw it in
Wallet Explorer,

463
00:17:09,028 --> 00:17:12,698
we've got one other address
there, it starts with 16q3.

464
00:17:12,698 --> 00:17:16,735
And, the other way to
correlate these two

465
00:17:16,734 --> 00:17:19,003
is if we look at the
transactions on there

466
00:17:19,003 --> 00:17:22,840
we can also say well 1FzW
had an address put money,

467
00:17:22,840 --> 00:17:24,042
and I'm gonna graph these,

468
00:17:24,042 --> 00:17:26,277
so if it's just
rattling off numbers

469
00:17:26,278 --> 00:17:28,714
don't panic there's
a graph coming.

470
00:17:28,714 --> 00:17:32,117
But the 1FzW, the first
address to fund that,

471
00:17:32,117 --> 00:17:33,719
to fund this part
of the ransomware

472
00:17:33,719 --> 00:17:35,654
Bitcoin infrastructure,

473
00:17:35,654 --> 00:17:37,256
starts with 16qCm,

474
00:17:37,256 --> 00:17:40,692
and the first one to ever
fun that starts with 16q3

475
00:17:40,692 --> 00:17:43,062
And that was also paid by 1FzW.

476
00:17:43,062 --> 00:17:45,597
So the deductive logic
there creates this loop,

477
00:17:45,597 --> 00:17:48,267
and so you would at least
be able to determine that,

478
00:17:48,267 --> 00:17:50,035
if you didn't know
from Wallet Explorer,

479
00:17:50,035 --> 00:17:51,537
you could do some
deductive reasoning

480
00:17:51,537 --> 00:17:54,506
and say well these are
owned by the same person.

481
00:17:54,506 --> 00:17:56,308
Given the timeframe
of these transactions,

482
00:17:56,308 --> 00:17:57,543
given what was happening,

483
00:17:57,543 --> 00:17:59,645
you could say that
pretty comfortably.

484
00:17:59,645 --> 00:18:00,846
What we're gonna do then

485
00:18:00,846 --> 00:18:02,114
is we're gonna
use this graph and

486
00:18:02,114 --> 00:18:03,982
we're gonna pivot
off of this graph.

487
00:18:03,982 --> 00:18:06,118
We're gonna add to
it a little bit.

488
00:18:06,118 --> 00:18:08,320
So, what's the
first to fund 16q3?

489
00:18:08,320 --> 00:18:12,357
Well this address
starting with 17N4mi.

490
00:18:12,357 --> 00:18:15,260
That's therefore likely also
owned by the Atom author.

491
00:18:15,260 --> 00:18:17,763
And when we talk
about, you know,

492
00:18:17,763 --> 00:18:19,130
mapping these out we're curious

493
00:18:19,131 --> 00:18:20,899
well where else did
that one send money?

494
00:18:20,899 --> 00:18:24,002
So in the same transaction
that it funded this,

495
00:18:24,002 --> 00:18:28,607
it also sent money to another,
to another Bitcoin address.

496
00:18:28,607 --> 00:18:31,743
And when we talk about
change, from earlier on,

497
00:18:31,743 --> 00:18:32,878
that's what we meant.

498
00:18:32,878 --> 00:18:33,946
And this is an example where

499
00:18:33,946 --> 00:18:35,280
it becomes
particularly relevant.

500
00:18:35,280 --> 00:18:36,748
So here's our new graph.

501
00:18:36,748 --> 00:18:38,250
We've added a little
section at the bottom.

502
00:18:38,250 --> 00:18:40,152
We still have that
triangle relationship

503
00:18:40,152 --> 00:18:42,287
from the ones we found before.

504
00:18:42,287 --> 00:18:43,889
So lets keep going.

505
00:18:43,889 --> 00:18:45,424
So we've branched
off, in one spot

506
00:18:45,424 --> 00:18:48,193
we're funding part of our
ransomware infrastructure.

507
00:18:48,193 --> 00:18:49,895
What are we doing
in the other spot?

508
00:18:49,895 --> 00:18:52,297
Well we can follow
these a little bit more.

509
00:18:52,297 --> 00:18:53,765
It sends money to
another address,

510
00:18:53,765 --> 00:18:56,435
that address sends money
to two more addresses.

511
00:18:56,435 --> 00:18:59,138
Those last two addresses are
tagged on Wallet Explorer

512
00:18:59,138 --> 00:19:01,240
as something called matbea.com,

513
00:19:01,240 --> 00:19:03,008
and I'll show you
that momentarily,

514
00:19:03,008 --> 00:19:04,276
but here's the graph.

515
00:19:04,276 --> 00:19:06,712
We can see our overlap
from the infrastructure,

516
00:19:06,712 --> 00:19:08,280
what funded the infrastructure,

517
00:19:08,280 --> 00:19:10,249
what did the
simultaneous paying,

518
00:19:10,249 --> 00:19:13,552
and where the money all
goes on the bottom right.

519
00:19:13,552 --> 00:19:15,219
So I mentioned matbea.com.

520
00:19:15,220 --> 00:19:16,622
If you, if you map this all out

521
00:19:16,622 --> 00:19:17,723
using the script from before,

522
00:19:17,723 --> 00:19:18,991
it'll look something like this,

523
00:19:18,991 --> 00:19:20,993
it just depends on
which address you use

524
00:19:20,993 --> 00:19:23,662
as the baseline for the script.

525
00:19:23,662 --> 00:19:25,497
But we have a couple
others at the bottom right

526
00:19:25,497 --> 00:19:27,866
that are also matbea.com.

527
00:19:27,866 --> 00:19:32,237
Well here's matbea.com, you can
see the cyrillic text there.

528
00:19:32,237 --> 00:19:34,773
So we're looking at a
Russian Bitcoin exchange.

529
00:19:34,773 --> 00:19:36,507
So here's our second data
point that I mentioned

530
00:19:36,508 --> 00:19:38,577
earlier that we were
trying to get to.

531
00:19:38,577 --> 00:19:41,213
Originally we were talking just

532
00:19:41,213 --> 00:19:43,882
hey these guys posted on
a Russian language forum,

533
00:19:43,882 --> 00:19:45,117
a lot of people do
that and a lot of

534
00:19:45,117 --> 00:19:47,119
people do it in
really awful Russian,

535
00:19:47,119 --> 00:19:49,987
but these guys might
actually be Russian,

536
00:19:49,988 --> 00:19:52,090
and we have that nice
little extra data point.

537
00:19:52,090 --> 00:19:54,226
And so this was a cool
piece of attribution,

538
00:19:54,226 --> 00:19:55,861
now it's important
to point of course,

539
00:19:55,861 --> 00:19:57,262
it could be a false flag,

540
00:19:57,262 --> 00:19:59,231
but given that this was
pretty unsophisticated

541
00:19:59,231 --> 00:20:00,699
and given the other
things we know

542
00:20:00,699 --> 00:20:02,868
about ransomware and about
these guys in general,

543
00:20:02,868 --> 00:20:05,270
we're, we're pretty comfortable
with this assessment

544
00:20:05,270 --> 00:20:06,638
and with this data point.

545
00:20:06,638 --> 00:20:09,774
So, I do have a bonus
example on here.

546
00:20:09,775 --> 00:20:11,143
I don't have time to
go through it today,

547
00:20:11,143 --> 00:20:12,678
and I wasn't planning on
going through it today,

548
00:20:12,678 --> 00:20:13,812
but if you ever wanna
look at something

549
00:20:13,812 --> 00:20:15,613
with the spora ransomware,

550
00:20:15,614 --> 00:20:17,049
it's on Cyber4Sight's blog,

551
00:20:17,049 --> 00:20:20,118
which is the group I
work at, at Booz Allen.

552
00:20:20,118 --> 00:20:22,588
And you can, you
can go through this

553
00:20:22,588 --> 00:20:25,324
and see how spora is
an affiliate program,

554
00:20:25,324 --> 00:20:27,426
and how you can come
up with that deduction

555
00:20:27,426 --> 00:20:29,328
just based off of
blockchain analysis.

556
00:20:29,328 --> 00:20:32,331
And that's not a grand
proclamation at this point,

557
00:20:32,331 --> 00:20:36,168
but when this was new, and
when this was three days old,

558
00:20:36,168 --> 00:20:37,436
it was pretty interesting data

559
00:20:37,436 --> 00:20:40,839
to see the first spora
affiliates get paid.

560
00:20:40,839 --> 00:20:42,640
And so that's something you can,

561
00:20:42,641 --> 00:20:45,844
you can look at when the
slides are posted online later.

562
00:20:45,844 --> 00:20:47,312
So the last thing I
wanted to talk about

563
00:20:47,312 --> 00:20:49,348
is the Namecoin blockchain.

564
00:20:49,348 --> 00:20:50,949
The Namecoin blockchain
is pretty interesting,

565
00:20:50,949 --> 00:20:52,684
it's another use of
blockchain technology,

566
00:20:52,684 --> 00:20:54,253
and the idea behind it is

567
00:20:54,253 --> 00:20:56,788
to decentralize
domain name systems.

568
00:20:56,788 --> 00:20:59,424
Allegedly, for the purpose
of anti censorship,

569
00:20:59,424 --> 00:21:01,260
but you can use it
for your malware

570
00:21:01,260 --> 00:21:04,830
because no one can
take down your domain

571
00:21:04,830 --> 00:21:06,063
if it's sitting on a blockchain.

572
00:21:06,064 --> 00:21:08,100
Instead they have to
take down the actual,

573
00:21:08,100 --> 00:21:10,302
they have to retake
the actual IP address

574
00:21:10,302 --> 00:21:12,437
that your domain
would resolve to.

575
00:21:12,437 --> 00:21:15,407
So, a little bit
more about this.

576
00:21:15,407 --> 00:21:17,576
Namecoin domains are
gonna be .bit domains.

577
00:21:17,576 --> 00:21:21,747
They're not an official ICANN
domain, top level domain.

578
00:21:21,747 --> 00:21:23,215
So what you have to do

579
00:21:23,215 --> 00:21:25,516
is you have to do a DNS
query to an OpenNIC server,

580
00:21:25,517 --> 00:21:26,885
or you have to do a DNS query

581
00:21:26,885 --> 00:21:29,688
to a dedicated
Namecoin DNS server.

582
00:21:29,688 --> 00:21:30,956
That's two interesting
things to look at

583
00:21:30,956 --> 00:21:32,623
in your network logs.

584
00:21:32,624 --> 00:21:34,626
I've seen some misconfigurations
do those before,

585
00:21:34,626 --> 00:21:37,029
but I've also seen just straight
up malware do it before.

586
00:21:37,029 --> 00:21:40,365
There's really no good reason
this should ever happen.

587
00:21:40,365 --> 00:21:42,434
Now domain, this
blockchain can work

588
00:21:42,434 --> 00:21:45,103
as a regular
cryptocurrency blockchain.

589
00:21:45,103 --> 00:21:47,472
The currency isn't worth
a whole lot right now,

590
00:21:47,472 --> 00:21:48,940
but the other part of this is

591
00:21:48,940 --> 00:21:51,376
the domain names sit on special
coins on this blockchain,

592
00:21:51,376 --> 00:21:52,911
so that you can't
accidentally, you know,

593
00:21:52,911 --> 00:21:55,614
buy bread with
whatever website .bit.

594
00:21:55,614 --> 00:21:57,082
Like that would be weird,

595
00:21:57,082 --> 00:21:58,583
and so they don't want
that to happen by accident,

596
00:21:58,583 --> 00:22:02,187
and the, that special coin
has a special property

597
00:22:03,588 --> 00:22:05,824
in how these things get updated

598
00:22:05,824 --> 00:22:09,027
that it tends to flatten out
the blockchain for analysis.

599
00:22:09,027 --> 00:22:10,595
The consequence of that,
and I'll show what,

600
00:22:10,595 --> 00:22:12,497
I'll show what I mean
by that visually,

601
00:22:12,497 --> 00:22:14,466
but the consequence of
that is it's really easy

602
00:22:14,466 --> 00:22:17,968
to track and map out
Namecoin infrastructure.

603
00:22:17,969 --> 00:22:20,005
So that's what we're gonna do

604
00:22:20,005 --> 00:22:22,974
with this example of the
Shifu banking Trojan.

605
00:22:22,974 --> 00:22:26,712
On January 6th, 2017
Palo Alto's unit 42

606
00:22:26,712 --> 00:22:28,680
came out with a
really really good

607
00:22:28,680 --> 00:22:30,482
reverse engineering
report on this.

608
00:22:30,482 --> 00:22:31,683
And part of it was
they noted that

609
00:22:31,683 --> 00:22:33,652
hey this banking Trojan
started using these

610
00:22:33,652 --> 00:22:37,022
two .bit domains at
some point in 2016.

611
00:22:37,022 --> 00:22:40,024
The picture up here is
actually a newer version of it,

612
00:22:40,025 --> 00:22:43,595
a newer, an updated version
of this information,

613
00:22:43,595 --> 00:22:45,497
because at the time

614
00:22:45,497 --> 00:22:47,232
there were only a
couple IP's associated

615
00:22:47,232 --> 00:22:49,401
with each of these
two domains on there.

616
00:22:49,401 --> 00:22:51,103
And the question I had was

617
00:22:51,103 --> 00:22:53,538
well, what other infrastructure,

618
00:22:53,538 --> 00:22:55,240
there's no way these
actors were only using

619
00:22:55,240 --> 00:22:58,043
two domains and a
couple of IP addresses.

620
00:22:58,043 --> 00:22:59,378
And a few other
things happened too.

621
00:22:59,378 --> 00:23:00,579
A couple days after
that report came out

622
00:23:00,579 --> 00:23:02,047
I have it in a little box here,

623
00:23:02,047 --> 00:23:04,249
you can see that they
zeroed out the IP address.

624
00:23:04,249 --> 00:23:05,650
So by looking at
the Namecoin system

625
00:23:05,650 --> 00:23:07,252
you already know hey
these guys are reading

626
00:23:07,252 --> 00:23:08,787
open source
intelligence reports,

627
00:23:08,787 --> 00:23:10,222
just like we all are,

628
00:23:10,222 --> 00:23:13,258
and they zeroed out
their infrastructure,

629
00:23:13,258 --> 00:23:14,860
and we're gonna see that
happen in a couple other

630
00:23:14,860 --> 00:23:16,660
pieces of this as well.

631
00:23:16,661 --> 00:23:17,729
So what we wanna do,

632
00:23:17,729 --> 00:23:18,830
there's no API for this,

633
00:23:18,830 --> 00:23:19,764
so you're gonna be on your own

634
00:23:19,765 --> 00:23:21,166
for the script we go for later,

635
00:23:21,166 --> 00:23:23,769
but what you wanna do

636
00:23:23,769 --> 00:23:25,237
is you wanna take
the first transaction

637
00:23:25,237 --> 00:23:26,438
from one of these domains

638
00:23:26,438 --> 00:23:28,106
because that's when
it was created.

639
00:23:28,106 --> 00:23:29,408
So, here's the
first transaction.

640
00:23:29,408 --> 00:23:31,142
There's a lot on this
screen and I know that.

641
00:23:31,143 --> 00:23:33,545
I'm gonna talk
through all of it.

642
00:23:33,545 --> 00:23:38,150
But the first transaction
on the name chain website

643
00:23:38,150 --> 00:23:41,720
will show that, it'll show
when this was first created,

644
00:23:41,720 --> 00:23:43,855
so you can see the
operation is OP_NAME_NEW

645
00:23:43,855 --> 00:23:46,291
that means a new
domain being made.

646
00:23:46,291 --> 00:23:47,926
You can see a change
address happening,

647
00:23:47,926 --> 00:23:49,928
so a certain amount
of Namecoin currency

648
00:23:49,928 --> 00:23:52,798
was used to perform
this operation,

649
00:23:52,798 --> 00:23:55,066
but then another
amount went to change.

650
00:23:55,066 --> 00:23:58,069
That, like 23 or
24 Namecoin change,

651
00:23:59,571 --> 00:24:01,907
was later used to register the
second domain that was listed

652
00:24:01,907 --> 00:24:04,443
in the, in the Palo Alto report.

653
00:24:04,443 --> 00:24:06,244
So we already know those
two were associated

654
00:24:06,244 --> 00:24:08,312
just with a couple of clicks.

655
00:24:08,313 --> 00:24:10,916
Now the, the next thing here is

656
00:24:13,251 --> 00:24:15,554
that we wanna kind of go
backwards a little bit more.

657
00:24:15,554 --> 00:24:18,723
So we, so this, this
Namecoin address

658
00:24:18,723 --> 00:24:20,926
was generated somewhere,
so when we go to the first

659
00:24:20,926 --> 00:24:23,227
transaction involving it,

660
00:24:23,228 --> 00:24:24,863
like so,

661
00:24:24,863 --> 00:24:28,066
we'll see that it actually
was part of change from

662
00:24:28,066 --> 00:24:30,469
another Namecoin operation
from another domain

663
00:24:30,469 --> 00:24:32,537
called healthshop.bit.

664
00:24:32,537 --> 00:24:34,606
And this had a
different IP address,

665
00:24:34,606 --> 00:24:36,374
but what we can do is

666
00:24:38,043 --> 00:24:40,378
we can look at the
overlapping IP addresses

667
00:24:40,378 --> 00:24:41,679
for this infrastructure now.

668
00:24:41,680 --> 00:24:43,181
We can look at just
all of the data from

669
00:24:43,181 --> 00:24:45,016
the healthshop domain,
all of the data

670
00:24:45,016 --> 00:24:47,486
from the one we were looking
at, the slavaukraine domain,

671
00:24:47,486 --> 00:24:49,454
and we can say hey there
was a shared relationship

672
00:24:49,454 --> 00:24:50,655
on the blockchain,
but there was also

673
00:24:50,655 --> 00:24:52,290
a shared infrastructure
relationship.

674
00:24:52,290 --> 00:24:54,759
These things were resolving
to the same IP addresses

675
00:24:54,759 --> 00:24:56,661
at different points in time.

676
00:24:56,661 --> 00:24:58,630
And so that's what
we have right here.

677
00:24:58,630 --> 00:25:00,198
If you compare them side by side

678
00:25:00,198 --> 00:25:01,666
you'll see in the blue

679
00:25:01,666 --> 00:25:03,201
you'll see some of
the same IP addresses,

680
00:25:03,201 --> 00:25:05,036
you'll see that they were
zeroed out on the 11th

681
00:25:05,036 --> 00:25:06,671
at the same time.

682
00:25:06,671 --> 00:25:10,008
So, those are some
pretty good date points.

683
00:25:10,008 --> 00:25:12,010
We would say with
almost near certainty

684
00:25:12,010 --> 00:25:15,213
that the same people were
operating these domains.

685
00:25:15,213 --> 00:25:16,648
So, good, we found
an extra domain,

686
00:25:16,648 --> 00:25:18,350
that's good for out
incident responders,

687
00:25:18,350 --> 00:25:19,650
that's good for our stock.

688
00:25:19,651 --> 00:25:21,052
We also know when
these IP addresses

689
00:25:21,052 --> 00:25:23,487
were relevant because
when they switched

690
00:25:23,488 --> 00:25:25,824
the IP's they're no longer
true indicators of compromise.

691
00:25:25,824 --> 00:25:27,192
I mean they might still
own the infrastructure,

692
00:25:27,192 --> 00:25:28,393
but they might not.

693
00:25:28,393 --> 00:25:30,495
So what we wanna do next is

694
00:25:30,495 --> 00:25:31,763
what else can we find?

695
00:25:31,763 --> 00:25:33,732
And, and in going the
same way that we went

696
00:25:33,732 --> 00:25:36,167
with mapping out the
Bitcoin infrastructure,

697
00:25:36,167 --> 00:25:37,569
we can do the same thing here,

698
00:25:37,569 --> 00:25:39,771
we can go to each
transaction that happened,

699
00:25:39,771 --> 00:25:42,674
look at the addresses, go to
each transaction of those,

700
00:25:42,674 --> 00:25:44,743
and so on and so forth,

701
00:25:44,743 --> 00:25:47,145
and, and, and so what we do is

702
00:25:47,145 --> 00:25:49,581
we get a graph here and I
tried to zoom in as best I can,

703
00:25:49,581 --> 00:25:51,882
but it illustrates a
point I'm about to make.

704
00:25:51,883 --> 00:25:54,119
This is a much
flatter blockchain.

705
00:25:54,119 --> 00:25:55,887
And you can even see that
I included the scroll bar

706
00:25:55,887 --> 00:25:59,957
in the picture so you can
see how wide this goes.

707
00:26:01,393 --> 00:26:03,995
But in doing this, you get
a nice little visualization,

708
00:26:03,995 --> 00:26:06,531
you can see that these addresses

709
00:26:06,531 --> 00:26:07,698
that these domains,

710
00:26:07,699 --> 00:26:09,634
that these IP addresses
are truly related.

711
00:26:09,634 --> 00:26:11,536
It's just not enough
to have a graph though.

712
00:26:11,536 --> 00:26:12,771
You would never be
able to constantly

713
00:26:12,771 --> 00:26:13,872
be scrolling left and right,

714
00:26:13,872 --> 00:26:15,540
so the other thing you wanna do

715
00:26:15,540 --> 00:26:17,242
is if you, if you go to
do something like this

716
00:26:17,242 --> 00:26:19,844
you wanna dump a
nice little CSV file,

717
00:26:19,844 --> 00:26:21,947
which, or actually
two CSV files,

718
00:26:21,947 --> 00:26:23,881
one with just just
the infrastructure,

719
00:26:23,882 --> 00:26:26,217
and one with the days
that this happens.

720
00:26:26,217 --> 00:26:28,987
And I did my best to show
the relationship here.

721
00:26:28,987 --> 00:26:30,589
So you'll see that they have

722
00:26:30,589 --> 00:26:32,290
similar IP space in some cases,

723
00:26:32,290 --> 00:26:35,126
you'll see shared IP addresses.

724
00:26:35,126 --> 00:26:36,360
The next thing
you would wanna do

725
00:26:36,361 --> 00:26:38,897
is either in graphviz
or in analysts notebook,

726
00:26:38,897 --> 00:26:41,399
you wanna take, you wanna
take all these data points

727
00:26:41,399 --> 00:26:42,801
and you wanna
correlate them together

728
00:26:42,801 --> 00:26:46,004
and show that they
are truly all linked.

729
00:26:46,004 --> 00:26:48,206
Before I go to that
picture on the right,

730
00:26:48,206 --> 00:26:51,275
you can also see some
interesting TTP's
from these actors.

731
00:26:51,276 --> 00:26:52,510
You can see that
they tend to name

732
00:26:52,510 --> 00:26:54,913
their domains in
some similar ways.

733
00:26:54,913 --> 00:26:57,582
So you've got like
foreveryoung and foreverone.

734
00:26:57,582 --> 00:27:00,652
You have a couple that
have the term data in them,

735
00:27:00,652 --> 00:27:02,387
a few others like that.

736
00:27:02,387 --> 00:27:05,557
A couple with references
to Russia, Ukraine.

737
00:27:05,557 --> 00:27:08,226
So it's some other
interesting TTP's,

738
00:27:08,226 --> 00:27:09,594
and it gives you
even more confidence

739
00:27:09,594 --> 00:27:11,096
that these are related.

740
00:27:11,096 --> 00:27:13,732
And when you map it all out,
here's what you wind up with.

741
00:27:13,732 --> 00:27:16,101
And so remember, we started
with only two domains,

742
00:27:16,101 --> 00:27:18,903
and when we ended
this we wound up with

743
00:27:18,903 --> 00:27:22,107
over a dozen domains that
these guys were using

744
00:27:22,107 --> 00:27:23,808
as part of this campaign.

745
00:27:23,808 --> 00:27:26,811
We also, just to
go back real quick,

746
00:27:27,979 --> 00:27:29,180
it's a little cut
off at the top,

747
00:27:29,180 --> 00:27:31,650
but you can see that
they've been doing this

748
00:27:31,650 --> 00:27:34,119
since March of 2016.

749
00:27:34,119 --> 00:27:36,553
So we have a nice
firm start point

750
00:27:36,554 --> 00:27:38,523
for this activity as well.

751
00:27:38,523 --> 00:27:41,592
And that gives you some
really good actionable

752
00:27:41,593 --> 00:27:44,496
intelligence that
you can use for this.

753
00:27:44,496 --> 00:27:46,431
And it's just a nice
little example of,

754
00:27:46,431 --> 00:27:48,566
well the, well the
Namecoin watching

755
00:27:48,566 --> 00:27:50,535
is a little bit esoteric,

756
00:27:50,535 --> 00:27:51,603
and while it
provides some sort of

757
00:27:51,603 --> 00:27:52,871
resiliency for these actors,

758
00:27:52,871 --> 00:27:56,241
we can actually use
it against them.

759
00:27:56,241 --> 00:27:58,209
And so that's, that's
kind of where we are

760
00:27:58,209 --> 00:28:00,345
for doing some of this
blockchain analysis.

761
00:28:00,345 --> 00:28:02,047
So just a quick recap.

762
00:28:02,047 --> 00:28:04,582
The blockchain stores
an awful lot of data,

763
00:28:04,582 --> 00:28:07,686
and if you're good with just
some basic deductive logic,

764
00:28:07,686 --> 00:28:10,088
and maybe a little
bit of scripting,

765
00:28:10,088 --> 00:28:14,192
you can find out a whole host
of historical information

766
00:28:14,192 --> 00:28:17,328
just by navigating
through it properly.

767
00:28:17,328 --> 00:28:19,197
I do have two items in
here in question marks.

768
00:28:19,197 --> 00:28:20,899
They're things we
should think about.

769
00:28:20,899 --> 00:28:22,332
Given what I just showed you

770
00:28:22,333 --> 00:28:24,469
where we can map out
Namecoin domains,

771
00:28:24,469 --> 00:28:26,971
do we really want
to be in a situation

772
00:28:26,971 --> 00:28:29,407
where someones medical records
are stored on a blockchain,

773
00:28:29,407 --> 00:28:30,608
and that's one of
the common ones

774
00:28:30,608 --> 00:28:32,711
that's listed for
blockchain technology.

775
00:28:32,711 --> 00:28:34,279
My argument personally would be

776
00:28:34,279 --> 00:28:36,848
well probably not
because as soon as,

777
00:28:36,848 --> 00:28:39,818
if someone, if there's an
OPSEC failure of some form,

778
00:28:39,818 --> 00:28:41,286
or a database gets leaked,

779
00:28:41,286 --> 00:28:44,389
and someones personal
medical blockchain address

780
00:28:44,389 --> 00:28:46,957
were to be paired
with their name,

781
00:28:46,958 --> 00:28:48,460
you would have all
of their history.

782
00:28:48,460 --> 00:28:50,128
And so I think that's something

783
00:28:50,128 --> 00:28:51,562
we have to think about.

784
00:28:51,563 --> 00:28:55,400
With property titles it
would be a similar situation.

785
00:28:55,400 --> 00:28:57,302
On the other hand it
does provide resiliency

786
00:28:57,302 --> 00:28:59,270
and it does provide
nice data storage,

787
00:28:59,270 --> 00:29:00,705
and it can be used
to prevent fraud.

788
00:29:00,705 --> 00:29:02,540
So, we do have to consider
both sides of that.

789
00:29:02,540 --> 00:29:05,543
(tribal drum music)

