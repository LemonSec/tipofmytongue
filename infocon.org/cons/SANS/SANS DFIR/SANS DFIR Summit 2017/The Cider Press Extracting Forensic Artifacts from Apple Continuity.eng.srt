1
00:00:09,542 --> 00:00:11,044
(applause)

2
00:00:11,044 --> 00:00:13,913
- So welcome to The Cider
Press. This is our talk.

3
00:00:13,913 --> 00:00:15,482
We don't get to talk
together too much,

4
00:00:15,482 --> 00:00:17,317
but we decided to
do a talk this time.

5
00:00:17,317 --> 00:00:18,752
This is The Cider
Press, we're going

6
00:00:18,752 --> 00:00:22,855
to extract forensic artifacts
from Apple continuity.

7
00:00:22,856 --> 00:00:26,359
- I'm Heather, or
Arnold. Sarah's my twin.

8
00:00:27,560 --> 00:00:29,294
We like to compare
ourselves to twins here,

9
00:00:29,295 --> 00:00:31,264
so we thought this
would be interesting.

10
00:00:31,264 --> 00:00:32,899
Phil essentially introduced us,

11
00:00:32,899 --> 00:00:34,300
we're not going to
spend too much time.

12
00:00:34,300 --> 00:00:36,903
So, worked for SANS,
worked for ManTech,

13
00:00:36,903 --> 00:00:40,740
smartphone nerd, I like
bourbon, sip wine, horses.

14
00:00:40,740 --> 00:00:43,243
(cheering, applause)

15
00:00:43,243 --> 00:00:44,844
- I'm Sarah Edwards, of course.

16
00:00:44,844 --> 00:00:46,780
Again, another
author-instructor.

17
00:00:46,780 --> 00:00:48,982
I also have a day job, and
it's weird, cause we get

18
00:00:48,982 --> 00:00:52,152
to work together in our day
jobs, and our SANS lives, too.

19
00:00:52,152 --> 00:00:54,521
You can't pull us apart,
therefore we are the twins,

20
00:00:54,521 --> 00:00:57,090
and unfortunately,
I get Danny DeVito.

21
00:00:57,090 --> 00:00:59,559
I don't know who wins or loses

22
00:00:59,559 --> 00:01:02,394
on this one, to be
honest with you.

23
00:01:02,395 --> 00:01:04,297
So, what is continuity?

24
00:01:05,498 --> 00:01:08,234
Continuity is across
all Apple devices,

25
00:01:08,234 --> 00:01:11,571
whether it's your phone, your
iPads, your Mac, your watches.

26
00:01:11,571 --> 00:01:15,175
It's the seamless interaction
between all of these devices

27
00:01:15,175 --> 00:01:18,678
to do fun stuff, to help
you do certain things.

28
00:01:18,678 --> 00:01:20,780
There are certain
requirements, there's software,

29
00:01:20,780 --> 00:01:22,749
there's hardware requirements.

30
00:01:22,749 --> 00:01:24,250
It's on some of
the newer devices,

31
00:01:24,250 --> 00:01:25,885
so if you have a
really old phone,

32
00:01:25,885 --> 00:01:29,055
or a really old Mac,
it probably won't work.

33
00:01:29,055 --> 00:01:33,560
It needs specific wireless
and Bluetooth hardware

34
00:01:33,560 --> 00:01:36,296
to actually get this
functionality to work.

35
00:01:36,296 --> 00:01:38,598
There's a few other
requirements, as well.

36
00:01:38,598 --> 00:01:41,067
For most of the
interaction, you need wifi

37
00:01:41,067 --> 00:01:42,735
and Bluetooth turned
on, and you need

38
00:01:42,735 --> 00:01:45,605
Handoff to be selected, as well.

39
00:01:45,605 --> 00:01:46,940
So we'll go through
some of those things

40
00:01:46,940 --> 00:01:48,675
and the requirements
for each particular

41
00:01:48,675 --> 00:01:51,444
piece of Apple
continuity itself.

42
00:01:53,079 --> 00:01:54,714
- What we did for
our evidence sets,

43
00:01:54,714 --> 00:01:55,982
what you can see here...

44
00:01:55,982 --> 00:01:57,851
So we used my phone
and Sarah's phone.

45
00:01:57,851 --> 00:01:59,452
Sarah's the jailbroken one.

46
00:01:59,452 --> 00:02:00,987
The artifacts that
you're going to see today

47
00:02:00,987 --> 00:02:04,791
are from my actual device,
so no jailbreak included.

48
00:02:04,791 --> 00:02:06,459
We do have some
caveats built in.

49
00:02:06,459 --> 00:02:09,429
We both had our Macs, running
two different versions,

50
00:02:09,429 --> 00:02:13,733
which don't really play all
that much in differences here.

51
00:02:13,733 --> 00:02:15,201
Old watch, new watch.

52
00:02:15,201 --> 00:02:17,670
And then, what you don't
actually see at this point,

53
00:02:17,670 --> 00:02:19,805
and you will see in
the future, is Phil was

54
00:02:19,806 --> 00:02:21,107
sitting behind the
scenes and capturing

55
00:02:21,107 --> 00:02:23,610
network traffic
going back and forth.

56
00:02:23,610 --> 00:02:25,111
One thing that was difficult is,

57
00:02:25,111 --> 00:02:27,147
Sarah and I chose something
that you really need

58
00:02:27,147 --> 00:02:30,583
to be in proximity to
create data sets on,

59
00:02:30,583 --> 00:02:33,119
and we don't live
close to one another,

60
00:02:33,119 --> 00:02:35,822
so were trying to do
this from Philly and D.C.

61
00:02:35,822 --> 00:02:37,690
So on some of our evidence here,

62
00:02:37,690 --> 00:02:39,392
you will see where we
were talking to ourself,

63
00:02:39,392 --> 00:02:40,960
versus talking to one another.

64
00:02:40,960 --> 00:02:44,731
So we do commingle it, and
you'll see this in the slides.

65
00:02:44,731 --> 00:02:46,266
- So first, just as
a little start-off,

66
00:02:46,266 --> 00:02:48,201
I'm gonna be referencing
a lot of different GUIDs

67
00:02:48,201 --> 00:02:50,737
and hardware pieces
within the slides.

68
00:02:50,737 --> 00:02:52,505
So, where do you find these
things on your own devices

69
00:02:52,505 --> 00:02:54,674
when you're doing a
forensic analysis?

70
00:02:54,674 --> 00:02:56,910
Got a couple of
screenshots up here.

71
00:02:56,910 --> 00:02:59,712
These are my Bluetooth settings.

72
00:02:59,712 --> 00:03:01,648
So this is for my
phone and for my watch,

73
00:03:01,648 --> 00:03:04,551
so it's called "miWatch"
and "miPhone7,"

74
00:03:04,551 --> 00:03:07,619
just to put that into
perspective for you.

75
00:03:07,620 --> 00:03:10,757
So, you will see the GUIDs
here, the F7s and the C9s,

76
00:03:10,757 --> 00:03:15,128
throughout a lot of the
logs I'm going to show you.

77
00:03:15,128 --> 00:03:16,396
We'll also see a couple of

78
00:03:16,396 --> 00:03:18,096
different Bluetooth
addresses, as well.

79
00:03:18,097 --> 00:03:20,567
So these Mac addresses that
are actually shown to you here,

80
00:03:20,567 --> 00:03:22,936
we don't actually get to see
this in the logs too much.

81
00:03:22,936 --> 00:03:24,704
It's more or less
referencing those GUIDs

82
00:03:24,704 --> 00:03:26,873
that I showed you on
the previous slide.

83
00:03:26,873 --> 00:03:28,875
So when you're doing
keyword searching,

84
00:03:28,875 --> 00:03:30,643
you might wanna pull
out those GUIDs first,

85
00:03:30,643 --> 00:03:32,312
and then keyword
search those logs

86
00:03:32,312 --> 00:03:35,515
that I'll show you about
in just a little bit.

87
00:03:35,515 --> 00:03:37,716
And of course, on the
iOS side of the house,

88
00:03:37,717 --> 00:03:40,186
you still got those
UUIDs or those GUIDs

89
00:03:40,186 --> 00:03:42,589
that you can search on, as well.

90
00:03:42,589 --> 00:03:44,490
So the plists are pretty
much the same, this one just

91
00:03:44,490 --> 00:03:48,661
happens to be in the database
because that's how iOs works.

92
00:03:48,661 --> 00:03:52,632
So how this all works together,
there's a little thing

93
00:03:52,632 --> 00:03:56,536
called Bonjour, and this
is Apple's name for,

94
00:03:56,536 --> 00:03:58,805
basically, zero
configuration networking.

95
00:03:58,805 --> 00:04:00,740
You find zero configuration
networking on lots

96
00:04:00,740 --> 00:04:03,843
of other devices,
Windows has their own,

97
00:04:03,843 --> 00:04:05,578
other mobile devices
have their own, as well,

98
00:04:05,578 --> 00:04:08,915
but Bonjour is a
Mac-specific technology.

99
00:04:08,915 --> 00:04:11,718
But it's built upon, pretty
much, industry standards.

100
00:04:11,718 --> 00:04:14,353
So, just a little skit
that we have here for you,

101
00:04:14,354 --> 00:04:16,956
how it works in the
most simplest form.

102
00:04:16,956 --> 00:04:18,491
And there's plenty of
documentation out there

103
00:04:18,491 --> 00:04:20,926
to show you how it all
works in more detailed form,

104
00:04:20,927 --> 00:04:23,329
but this is generally
how it's going to go.

105
00:04:23,329 --> 00:04:25,331
So you get a device
here saying, "Hey.

106
00:04:25,331 --> 00:04:28,701
"I just turned on AirDrop,
what can I do with it?"

107
00:04:28,701 --> 00:04:31,771
So, hey y'all, I got AirDrop.

108
00:04:31,771 --> 00:04:35,875
- I'm over here by
myself. I have no friends.

109
00:04:35,875 --> 00:04:37,710
Who can I AirDrop with?

110
00:04:37,710 --> 00:04:40,880
- Oh, I can be your
friend. Let's AirDrop.

111
00:04:40,880 --> 00:04:42,982
- Excellent. I'm gonna
drop it like it's hot.

112
00:04:42,982 --> 00:04:44,384
- Yeah.

113
00:04:44,384 --> 00:04:46,386
So, there's that discovery,
and the publication,

114
00:04:46,386 --> 00:04:47,954
the resolution of
all those things.

115
00:04:47,954 --> 00:04:50,456
I mean, this is
extremely simplified,

116
00:04:50,456 --> 00:04:52,458
but there is that interaction.

117
00:04:52,458 --> 00:04:55,461
We'll see that in
the logs, as well.

118
00:04:57,196 --> 00:05:00,300
- So, with AirDrop, we have
different scenarios here.

119
00:05:00,300 --> 00:05:03,403
We spent a bulk of our
examination time in AirDrop.

120
00:05:03,403 --> 00:05:05,204
The log files are
really overwhelming,

121
00:05:05,204 --> 00:05:07,340
and we redacted a
lot, which you'll see.

122
00:05:07,340 --> 00:05:08,707
So we did different scenarios.

123
00:05:08,708 --> 00:05:10,777
You can see here some
screenshots from Sarah's device,

124
00:05:10,777 --> 00:05:13,712
from my devices,
from our computers.

125
00:05:13,713 --> 00:05:15,648
So what you will see,
each of the headers

126
00:05:15,648 --> 00:05:18,051
going forward, you're
going to see Mac to iPhone,

127
00:05:18,051 --> 00:05:20,053
iPhone to iPhone, iPhone to Mac.

128
00:05:20,053 --> 00:05:22,488
So, just make sure you're
reading the slide titles

129
00:05:22,488 --> 00:05:24,590
when you actually get
copies of these files,

130
00:05:24,590 --> 00:05:27,060
if you're trying to
replicate what we did.

131
00:05:27,060 --> 00:05:30,263
Important for you to know,
is you can AirDrop to anyone,

132
00:05:30,263 --> 00:05:33,799
so you'll see we broadcast to
everyone, which is shown here.

133
00:05:33,800 --> 00:05:35,435
You'll see we were
broadcasting yesterday

134
00:05:35,435 --> 00:05:37,403
in the restaurant
downstairs, and we could see

135
00:05:37,403 --> 00:05:39,439
other people's random devices.

136
00:05:39,439 --> 00:05:42,709
As long as you're in proximity,
a peer-to-peer connection

137
00:05:42,709 --> 00:05:45,778
will be established and you can
drop files from one another.

138
00:05:45,778 --> 00:05:48,281
So you will see
this in our slides.

139
00:05:48,281 --> 00:05:50,516
- So, AirDrop, first
off, is the technology

140
00:05:50,516 --> 00:05:53,586
that allows us to drop
different files back and forth.

141
00:05:53,586 --> 00:05:56,289
So we're gonna show you
a few examples of those.

142
00:05:56,289 --> 00:05:58,858
First thing I'd like to
show you are different IDs

143
00:05:58,858 --> 00:06:01,928
and identifiers that you
can search on in your logs.

144
00:06:01,928 --> 00:06:04,364
Mac and iOS pretty much
has the same thing.

145
00:06:04,364 --> 00:06:07,366
For the Mac, we got two
different plist files here.

146
00:06:07,367 --> 00:06:08,501
One's called
"SharingD," the other's

147
00:06:08,501 --> 00:06:10,837
got "SharingD" in it, as well.

148
00:06:10,837 --> 00:06:13,606
So if you're looking for
continuity-based stuff,

149
00:06:13,606 --> 00:06:16,109
look for that term
called "SharingD."

150
00:06:16,109 --> 00:06:17,744
That's the sharing
daemon associated

151
00:06:17,744 --> 00:06:21,514
with a lot of that sharing
continuity interaction.

152
00:06:21,514 --> 00:06:23,683
Same thing on iOS.

153
00:06:23,683 --> 00:06:25,450
For these two
examples, I wanna see

154
00:06:25,451 --> 00:06:27,053
what the
discoverability mode is,

155
00:06:27,053 --> 00:06:29,489
whether it's set to
everyone, or contacts only,

156
00:06:29,489 --> 00:06:31,424
or if it's turned
off altogether.

157
00:06:31,424 --> 00:06:34,426
But I also wanna take a
look at the AirDrop ID.

158
00:06:34,427 --> 00:06:36,729
I'm gonna reference that in
the logs that we're gonna see.

159
00:06:36,729 --> 00:06:38,830
So, that's how you
tie a certain device

160
00:06:38,831 --> 00:06:41,334
in the logs to other activity.

161
00:06:43,703 --> 00:06:45,671
So, we have this scenario here.

162
00:06:45,671 --> 00:06:48,608
The screenshot here shows you
that I'm on my Mac right now,

163
00:06:48,608 --> 00:06:50,576
and I see two different devices.

164
00:06:50,576 --> 00:06:52,078
These devices don't
have any icons,

165
00:06:52,078 --> 00:06:55,414
they're just the gray bubble
with the white head in there.

166
00:06:55,415 --> 00:06:57,150
One's called
"Dadephone," and the

167
00:06:57,150 --> 00:06:59,284
other is Heather
Mahalik's phone.

168
00:06:59,285 --> 00:07:00,553
So, I'm on my Mac right now,

169
00:07:00,553 --> 00:07:02,422
and I can see both
of these devices.

170
00:07:02,422 --> 00:07:03,823
What does that look like?

171
00:07:03,823 --> 00:07:06,659
And this is just a
discovery of the devices.

172
00:07:06,659 --> 00:07:09,829
There's absolutely no
file transfer just yet.

173
00:07:09,829 --> 00:07:12,198
In the Mac unified logs...

174
00:07:12,198 --> 00:07:15,067
Now, Mac unified logs are
a brand new logging system

175
00:07:15,067 --> 00:07:19,005
on all the newest Mac-based
devices, so Sierra,

176
00:07:20,206 --> 00:07:23,709
iOS 10, and all sorts
of good stuff like that.

177
00:07:23,709 --> 00:07:26,145
These are the newer
version of those logs.

178
00:07:26,145 --> 00:07:27,746
I have a whole other
presentation on how to read

179
00:07:27,747 --> 00:07:29,682
those unified logs
that you can find

180
00:07:29,682 --> 00:07:32,552
on my website, if
you're interested.

181
00:07:32,552 --> 00:07:34,520
So, this is just the discovery.

182
00:07:34,520 --> 00:07:37,789
So I open up finder, and
saw these two devices.

183
00:07:37,790 --> 00:07:39,592
What does that look like?

184
00:07:39,592 --> 00:07:42,027
In the logs themselves,
if I do searches for

185
00:07:42,028 --> 00:07:45,097
that SharingD term again,
and more specifically,

186
00:07:45,097 --> 00:07:49,268
the Com.Apple.Sharing.AirDrop,
specifically,

187
00:07:49,268 --> 00:07:51,470
it's gonna show you the
different categories

188
00:07:51,471 --> 00:07:54,774
of different continuity
items in here, as well.

189
00:07:54,774 --> 00:07:57,877
Just a few items that I have
bolded here, you can see

190
00:07:57,877 --> 00:08:01,647
the server's been initialized,
the Finder entered AirDrop,

191
00:08:01,647 --> 00:08:04,717
meaning I selected AirDrop
in my Finder window,

192
00:08:04,717 --> 00:08:07,652
you see some Bluetooth
scanning going on here.

193
00:08:07,653 --> 00:08:10,156
It uses Bluetooth LE scanning,

194
00:08:12,325 --> 00:08:14,227
so you'll see that all the time.

195
00:08:14,227 --> 00:08:17,195
These logs are
extremely verbose.

196
00:08:17,196 --> 00:08:19,198
There are hundreds,
perhaps thousands,

197
00:08:19,198 --> 00:08:21,133
of different log entries.

198
00:08:21,133 --> 00:08:23,102
We've only cut it down to a few,

199
00:08:23,102 --> 00:08:25,938
just to show you the different
type of activity here.

200
00:08:25,938 --> 00:08:27,473
So we get some
Bluetooth LE scanning,

201
00:08:27,473 --> 00:08:30,510
starting scanning mode,
so this particular one's

202
00:08:30,510 --> 00:08:33,612
doing contacts only,
versus everyone.

203
00:08:35,780 --> 00:08:38,751
You'll also see
some mDNSResponder.

204
00:08:38,751 --> 00:08:41,587
This is very much associated
with the Bonjour activity

205
00:08:41,587 --> 00:08:43,588
that we were talking
about before, so

206
00:08:43,589 --> 00:08:46,792
you'll see a lot of
these items in here.

207
00:08:46,792 --> 00:08:49,529
One below that,
you see the AWDL.

208
00:08:51,130 --> 00:08:53,165
This is that peer-to-peer
communication.

209
00:08:53,165 --> 00:08:55,700
This is the Apple
wireless direct link.

210
00:08:55,701 --> 00:08:59,038
It's another interface
on your Apple devices.

211
00:08:59,038 --> 00:09:02,475
It's not specific to en0,
it's not the en1 interface,

212
00:09:02,475 --> 00:09:06,112
it's specific only to that
direct link type of interface,

213
00:09:06,112 --> 00:09:07,413
so it's almost like an ad hoc or

214
00:09:07,413 --> 00:09:09,382
peer-to-peer kind of
thing, and that's how

215
00:09:09,382 --> 00:09:12,117
all the continuity stuff works.

216
00:09:12,118 --> 00:09:13,853
Then finally, we
see some other items

217
00:09:13,853 --> 00:09:15,721
in there with the
AirDrop terminology

218
00:09:15,721 --> 00:09:18,691
in there, Bonjour
discovery started.

219
00:09:18,691 --> 00:09:21,060
[Com.Apple.Sharing.Browser],
this means I'm actually

220
00:09:21,060 --> 00:09:26,064
browsing for different
people to communicate with.

221
00:09:26,065 --> 00:09:27,800
And then finally, at
the bottom, we have

222
00:09:27,800 --> 00:09:30,835
the Com.Apple.SharingD,
No AirDrop People

223
00:09:30,836 --> 00:09:32,538
Discovered After 8 Seconds.

224
00:09:32,538 --> 00:09:35,074
So it's constantly looking
for different people,

225
00:09:35,074 --> 00:09:37,742
and if you have AirDrop
open on your Macs right now,

226
00:09:37,743 --> 00:09:41,514
you can see people
popping up back and forth.

227
00:09:43,115 --> 00:09:46,085
Now, if I can continue
on, there's more stuff.

228
00:09:46,085 --> 00:09:48,154
So, this is now discovering
these two devices

229
00:09:48,154 --> 00:09:49,622
that I have here.

230
00:09:49,622 --> 00:09:52,724
So I got Bonjour discovered,
and I have this number,

231
00:09:52,725 --> 00:09:56,095
this ED2A number, I
have a couple of these.

232
00:09:56,095 --> 00:09:58,497
This is that AirDrop ID number

233
00:09:58,497 --> 00:10:01,099
that's associated with
a specific device.

234
00:10:01,100 --> 00:10:02,702
So if you need to tie
two things together,

235
00:10:02,702 --> 00:10:05,538
you're gonna need
that AirDrop ID.

236
00:10:07,006 --> 00:10:09,541
Finally, we get some more
Bonjour and mDNSResponder,

237
00:10:09,542 --> 00:10:11,644
and then we can also
see associations

238
00:10:11,644 --> 00:10:14,246
to the name, the host
name of the device.

239
00:10:14,246 --> 00:10:16,247
In this case, I'm seeing
Dadephone in here.

240
00:10:16,248 --> 00:10:18,117
If I keep going a
little bit further down,

241
00:10:18,117 --> 00:10:20,453
I'm discovering Heather
Mahalik's phone.

242
00:10:20,453 --> 00:10:21,654
Then finally, in the bottom,

243
00:10:21,654 --> 00:10:23,856
we have
[Com.Apple.Sharing.Browser].

244
00:10:23,856 --> 00:10:26,258
Now it sees those two
devices that I showed you

245
00:10:26,258 --> 00:10:30,029
in that original
screenshot, the Dadephone

246
00:10:30,029 --> 00:10:32,732
and Heather's iPhone, with both

247
00:10:32,732 --> 00:10:35,635
those Apple IDs
associated with it.

248
00:10:36,736 --> 00:10:38,337
- So then, we did a transfer.

249
00:10:38,337 --> 00:10:41,340
If anyone's not aware
of this, this is the Mac

250
00:10:41,340 --> 00:10:43,209
on the left-hand side,
this is actually a fire

251
00:10:43,209 --> 00:10:45,077
that happened in Rob's
mom's hometown, here,

252
00:10:45,077 --> 00:10:47,913
that you can see,
and it's terrifying.

253
00:10:47,913 --> 00:10:51,150
The end, oddly, of
the video gets gory.

254
00:10:51,150 --> 00:10:53,653
So, when Sarah dropped this
to me, instead of showing

255
00:10:53,653 --> 00:10:56,389
the beginning of the fire,
we found it very strange

256
00:10:56,389 --> 00:10:57,823
that it showed the
end, which is why

257
00:10:57,823 --> 00:10:59,792
it's blurred out,
it's a little gory.

258
00:10:59,792 --> 00:11:02,194
So what you're seeing
here is several things.

259
00:11:02,194 --> 00:11:04,497
On the left-hand side,
we see Sarah's Mac.

260
00:11:04,497 --> 00:11:06,665
She had it set to see everyone.

261
00:11:06,666 --> 00:11:07,967
So when we were sitting
there sharing files,

262
00:11:07,967 --> 00:11:09,502
we saw other people
who were around us

263
00:11:09,502 --> 00:11:11,036
that weren't even
a part of this.

264
00:11:11,037 --> 00:11:14,273
We considered sending them
the fire, but we didn't.

265
00:11:14,273 --> 00:11:16,308
On the right, you
can see my iPhone.

266
00:11:16,308 --> 00:11:19,111
Because Sarah and I are not
on the same iCloud account,

267
00:11:19,111 --> 00:11:21,580
it asks me do I wanna
decline or accept.

268
00:11:21,580 --> 00:11:23,983
And I'll cover this further
in my slides, but we're going

269
00:11:23,983 --> 00:11:26,285
to actually look at what
this transfer looked like

270
00:11:26,285 --> 00:11:30,622
on the Mac, and then we'll
cover it on the iPhone.

271
00:11:30,623 --> 00:11:32,391
- So, from the Mac itself.

272
00:11:32,391 --> 00:11:35,828
It says AirDrop server
enabled on 48770.

273
00:11:35,828 --> 00:11:37,896
You'll see that port number
used pretty often, so

274
00:11:37,897 --> 00:11:40,366
if you wanna search by that,
you can go ahead and do that.

275
00:11:40,366 --> 00:11:42,034
You can see TCP
connections being

276
00:11:42,034 --> 00:11:44,937
started up, it does
an SSL negotiation.

277
00:11:44,937 --> 00:11:46,906
And I have highlighted
and underscored here

278
00:11:46,906 --> 00:11:48,907
the received verb.

279
00:11:48,908 --> 00:11:50,676
So the verb, they're gonna
tell you which direction

280
00:11:50,676 --> 00:11:51,977
it's going into,
so I'm gonna point

281
00:11:51,977 --> 00:11:53,946
that out in a couple
of different places.

282
00:11:53,946 --> 00:11:56,549
In this case, it's doing a
received discovery request,

283
00:11:56,549 --> 00:12:01,053
it's receiving this, it's
receiving a video from miPhone7.

284
00:12:01,053 --> 00:12:05,357
That miPhone7 and that
informative text section there,

285
00:12:05,357 --> 00:12:07,860
that is actually on
my Mac, that little

286
00:12:07,860 --> 00:12:11,063
pop-up notification window
that comes up, saying,

287
00:12:11,063 --> 00:12:14,165
"Would you like to accept this
movie from Heather's iPhone?"

288
00:12:14,166 --> 00:12:16,435
or from my iPhone,
or from wherever

289
00:12:16,435 --> 00:12:19,438
it's coming from,
accept or decline.

290
00:12:20,740 --> 00:12:22,808
So, to get that
notification information.

291
00:12:22,808 --> 00:12:26,545
And finally, we get the
received upload request,

292
00:12:26,545 --> 00:12:29,582
adaptive compression, so it's
moving all this data back

293
00:12:29,582 --> 00:12:32,151
and forth, not necessarily
across the network,

294
00:12:32,151 --> 00:12:34,453
but potentially over
Bluetooth as well.

295
00:12:34,453 --> 00:12:36,255
And then finally,
the transaction end.

296
00:12:36,255 --> 00:12:40,326
So we see a server transaction
begin, and then end,

297
00:12:40,326 --> 00:12:42,928
so you know that that
transaction actually happened.

298
00:12:42,928 --> 00:12:45,197
Then finally, we can
see the AirDrop ID

299
00:12:45,197 --> 00:12:46,832
that's been
associated with that,

300
00:12:46,832 --> 00:12:49,668
and there's that
ED2A again there.

301
00:12:51,704 --> 00:12:53,939
A couple of items
that get transferred.

302
00:12:53,939 --> 00:12:56,342
It's not just about
logs on the Mac.

303
00:12:56,342 --> 00:12:57,977
On the Mac, actually,
AirDrop stuff

304
00:12:57,977 --> 00:13:00,146
is much easier to look for.

305
00:13:00,146 --> 00:13:03,048
So if I receive certain
files, movies, pictures,

306
00:13:03,048 --> 00:13:05,618
whatever it might be,
there's some other artifacts

307
00:13:05,618 --> 00:13:07,419
that I can take a
look at, as well.

308
00:13:07,419 --> 00:13:10,389
For this one, just in the
simple downloads directory.

309
00:13:10,389 --> 00:13:12,191
It's one of the
default locations.

310
00:13:12,191 --> 00:13:14,160
If somebody's gonna
AirDrop you something,

311
00:13:14,160 --> 00:13:16,295
you can accept it into
your default downloads.

312
00:13:16,295 --> 00:13:17,596
So that's a first quick look

313
00:13:17,596 --> 00:13:19,965
at where that
stuff might happen.

314
00:13:19,965 --> 00:13:22,535
Some of the timestamps
actually get saved.

315
00:13:22,535 --> 00:13:26,505
So this movie here was
actually taken on June 15th,

316
00:13:26,505 --> 00:13:29,742
while I received
it on June 18th.

317
00:13:29,742 --> 00:13:32,545
So you get some preservation
of timestamps here.

318
00:13:32,545 --> 00:13:36,314
In the yellow highlighted,
the permissions, sometimes,

319
00:13:36,315 --> 00:13:39,952
not always, you'll see
that access_bpf permission,

320
00:13:39,952 --> 00:13:42,421
the Berkeley Packet
Filter kind of thing going

321
00:13:42,421 --> 00:13:43,989
on there, so you know it somehow

322
00:13:43,989 --> 00:13:47,026
got moved across the
networks somehow.

323
00:13:47,026 --> 00:13:48,593
But I'll tell you right
now, it doesn't happen

324
00:13:48,594 --> 00:13:52,765
on all AirDropped stuff,
so just be aware of that.

325
00:13:54,166 --> 00:13:56,769
We also get extended
attribute information.

326
00:13:56,769 --> 00:13:58,237
If you take my class,
you know I love

327
00:13:58,237 --> 00:14:01,439
extended attributes,
love them to death.

328
00:14:01,440 --> 00:14:03,475
And we get some information
associated with that,

329
00:14:03,475 --> 00:14:05,511
specifically two that
I wanna talk about,

330
00:14:05,511 --> 00:14:09,147
the
Com.Apple.Metadata:KMDItemWhere,

331
00:14:09,148 --> 00:14:11,050
and the Com.Apple.Quarantine.

332
00:14:11,050 --> 00:14:13,084
KMDItemWhereFroms
basically says,

333
00:14:13,085 --> 00:14:14,820
where did this thing come from?

334
00:14:14,820 --> 00:14:16,488
Now, it's a binary
plist, but you can

335
00:14:16,488 --> 00:14:19,124
see the strings
in there that says

336
00:14:19,124 --> 00:14:22,628
Sarah Edward's iPhone,
miPhone7, in there.

337
00:14:24,029 --> 00:14:26,165
Now, in the quarantine
information, you'll see

338
00:14:26,165 --> 00:14:29,501
that it has that SharingD
process in there,

339
00:14:29,501 --> 00:14:32,137
and that hex value, that's
actually the timestamp

340
00:14:32,137 --> 00:14:34,640
that it was AirDropped
onto the system.

341
00:14:34,640 --> 00:14:37,910
And if I happen to open up
this movie in QuickTime player,

342
00:14:37,910 --> 00:14:41,480
that quarantine
attribute may change.

343
00:14:41,480 --> 00:14:44,450
So it's not always gonna be
the SharingD, if potentially

344
00:14:44,450 --> 00:14:47,753
it was opened up in a
different piece of software.

345
00:14:47,753 --> 00:14:50,189
So, something to
just be aware of.

346
00:14:50,189 --> 00:14:52,524
And of course, if it
does get opened up,

347
00:14:52,524 --> 00:14:55,160
we can still go back to
the quarantine database,

348
00:14:55,160 --> 00:14:57,829
where all the original
information is being stored,

349
00:14:57,830 --> 00:15:01,834
to get that original
timestamp and that SharingD,

350
00:15:03,002 --> 00:15:05,170
who did it come
from information.

351
00:15:05,170 --> 00:15:06,604
In this case it was AirDropping

352
00:15:06,605 --> 00:15:09,308
to myself, so it has
my name in there.

353
00:15:09,308 --> 00:15:10,542
A lot of different pieces here

354
00:15:10,542 --> 00:15:12,878
that we can start
to put together.

355
00:15:12,878 --> 00:15:15,848
There's also this purgatory,
as I like to call it.

356
00:15:15,848 --> 00:15:18,684
If somebody's sending me
something, and it's somebody

357
00:15:18,684 --> 00:15:20,653
I don't know, it goes into this

358
00:15:20,653 --> 00:15:23,956
purgatory area, this
Cleanup at Startup.

359
00:15:23,956 --> 00:15:25,858
It's gonna store it
in here temporarily

360
00:15:25,858 --> 00:15:30,061
until I view it or until I
see it, that kind of thing.

361
00:15:30,062 --> 00:15:31,964
Doesn't happen at all
AirDropped information,

362
00:15:31,964 --> 00:15:36,201
but it is a good place to
check, so take a look at that.

363
00:15:36,201 --> 00:15:38,170
And it does get
cleaned up at startup,

364
00:15:38,170 --> 00:15:41,707
so once I reboot that system,
that all gets flushed away.

365
00:15:41,707 --> 00:15:43,641
Something to be aware of.

366
00:15:43,642 --> 00:15:47,479
So, one more thing.
From Mac to phone.

367
00:15:47,479 --> 00:15:50,382
How do you know which
file it actually sent?

368
00:15:50,382 --> 00:15:52,483
So, it'll actually store that
information in there, too,

369
00:15:52,484 --> 00:15:53,953
and I have a couple of examples.

370
00:15:53,953 --> 00:15:57,488
If you just do a file://
search across all the logs,

371
00:15:57,489 --> 00:15:59,892
you'll see different examples.

372
00:15:59,892 --> 00:16:02,027
The top one here is
the catalog note ID

373
00:16:02,027 --> 00:16:03,762
for a particular file.

374
00:16:03,762 --> 00:16:06,632
But sometimes if I'm AirDropping
from within an application,

375
00:16:06,632 --> 00:16:10,102
if you look below that
Com.Apple.Sharing.AirDrop,

376
00:16:10,102 --> 00:16:12,704
starting to send
files, you'll see that

377
00:16:12,705 --> 00:16:15,274
in that bar folders
pack, you'll see the

378
00:16:15,274 --> 00:16:18,310
Com.Apple.Photos.BundleID
in there too.

379
00:16:18,310 --> 00:16:20,279
So this is me using
the Photos application

380
00:16:20,279 --> 00:16:22,314
to AirDrop those things out.

381
00:16:22,314 --> 00:16:23,748
So, kind of gives
you a better idea

382
00:16:23,749 --> 00:16:27,653
of where those files are
actually being stored on disc.

383
00:16:27,653 --> 00:16:28,620
- All right, this
is where I wanted

384
00:16:28,620 --> 00:16:30,956
some sound effects, wamp wamp.

385
00:16:30,956 --> 00:16:33,025
So, just to warn
you, if you strictly

386
00:16:33,025 --> 00:16:35,961
have a newer device,
we're using the iPhone 7

387
00:16:35,961 --> 00:16:37,863
on my device, it's
not jailbroken,

388
00:16:37,863 --> 00:16:40,766
so you're essentially
stuck with a backup file.

389
00:16:40,766 --> 00:16:43,301
The artifacts that I
got, you're going to have

390
00:16:43,302 --> 00:16:47,873
to get really, really crafty,
just to caution you here.

391
00:16:47,873 --> 00:16:49,441
With the phone here,
you can see I'm getting

392
00:16:49,441 --> 00:16:52,144
an AirDrop from my
husband's device,

393
00:16:52,144 --> 00:16:54,680
he's not on my same
iCloud account.

394
00:16:54,680 --> 00:16:57,449
You get an option, "Do you
want to accept or decline?"

395
00:16:57,449 --> 00:17:00,285
If you accept, and it's
a photo or a video,

396
00:17:00,285 --> 00:17:02,054
it's going to the
default DCIM directory,

397
00:17:02,054 --> 00:17:04,723
and we'll talk about what
this looks like in a second.

398
00:17:04,723 --> 00:17:06,558
If it's not, if it's a text file

399
00:17:06,558 --> 00:17:08,794
or a .pdf or something
else, you get

400
00:17:08,794 --> 00:17:10,796
an option on how
you wanna open it.

401
00:17:10,796 --> 00:17:13,832
The bad news is, if you
decline, at this point,

402
00:17:13,832 --> 00:17:16,335
I have not been able to
find any logs showing

403
00:17:16,335 --> 00:17:18,569
that it was even offered to me.

404
00:17:18,569 --> 00:17:20,304
So, you can see why you
would want to do this,

405
00:17:20,305 --> 00:17:23,108
but right now I
haven't been able to.

406
00:17:23,108 --> 00:17:24,742
For devices on the same
iCloud, so now I'm talking

407
00:17:24,742 --> 00:17:28,379
to myself here, it doesn't
even give you an option

408
00:17:28,380 --> 00:17:30,482
to decline, it's auto-accepting.

409
00:17:30,482 --> 00:17:33,485
Here we can see that it's
going straight to DCIM, or,

410
00:17:33,485 --> 00:17:36,120
I was sharing a text file
with myself, it's saying,

411
00:17:36,121 --> 00:17:38,424
"What do you want
to do with this?"

412
00:17:38,424 --> 00:17:40,526
In this scenario here, what
I did was, I sent myself

413
00:17:40,526 --> 00:17:43,929
a text file, and it was a
link, in that text file.

414
00:17:43,929 --> 00:17:46,799
I saved it to my Notes, and
then I opened it in Safari.

415
00:17:46,799 --> 00:17:48,934
Now, are the artifacts going
to speak to you that way?

416
00:17:48,934 --> 00:17:53,472
No. I know this happened
because I sent it to myself.

417
00:17:53,472 --> 00:17:55,206
Again, no option to decline.

418
00:17:55,207 --> 00:17:56,708
So now we're gonna look at what

419
00:17:56,708 --> 00:17:59,678
this actually looks
like in the artifacts.

420
00:17:59,678 --> 00:18:01,013
I will caution you here...

421
00:18:01,013 --> 00:18:03,682
And that line looks very weird.

422
00:18:03,682 --> 00:18:07,152
But I will caution you, I
knew something occurred.

423
00:18:07,152 --> 00:18:09,254
So at this point, you
knew from other evidence,

424
00:18:09,254 --> 00:18:11,356
maybe you had Sarah's
Mac, and you're like,

425
00:18:11,356 --> 00:18:13,425
"I know she AirDropped
Heather something,

426
00:18:13,425 --> 00:18:15,427
"or I know Heather received
an AirDropped file,

427
00:18:15,427 --> 00:18:18,062
"because someone was looking
over her shoulder and saw it."

428
00:18:18,063 --> 00:18:19,865
So, you know AirDrop occurred.

429
00:18:19,865 --> 00:18:21,700
What you could do is, the
very first thing you can do

430
00:18:21,700 --> 00:18:23,669
in that backup is, you
could go to the Push Store

431
00:18:23,669 --> 00:18:25,704
and see if AirDrop
is even enabled.

432
00:18:25,704 --> 00:18:27,940
Does the user have this
enabled, yes or no?

433
00:18:27,940 --> 00:18:30,342
You can look at the
data usage, SQLite file,

434
00:18:30,342 --> 00:18:32,277
which I have in a slide
coming up, and say,

435
00:18:32,277 --> 00:18:36,381
"Okay, are there artifacts
showing AirDrop at all?"

436
00:18:36,381 --> 00:18:38,884
At this point, you know
the AirDrop was used.

437
00:18:38,884 --> 00:18:41,120
So what you can attempt
to do is timeline,

438
00:18:41,120 --> 00:18:43,655
but I wish you the
best of luck, because

439
00:18:43,655 --> 00:18:47,192
things don't always fall into
order as you would expect.

440
00:18:47,192 --> 00:18:50,896
Sarah was seeing one way,
I was seeing another,

441
00:18:50,896 --> 00:18:52,364
so we were confused,
and then I was able

442
00:18:52,364 --> 00:18:55,801
to replicate what she was
seeing two out of three times.

443
00:18:55,801 --> 00:18:58,236
So what we have found is,
when an AirDrop picture

444
00:18:58,237 --> 00:19:00,405
or video came in, it
didn't necessarily fall

445
00:19:00,405 --> 00:19:03,675
in the correct order on where
it should be in that DCIM.

446
00:19:03,675 --> 00:19:06,678
It made no sense, sometimes
it did, sometimes it didn't.

447
00:19:06,678 --> 00:19:07,779
And it was the same...

448
00:19:07,779 --> 00:19:09,548
I did .png files several times,

449
00:19:09,548 --> 00:19:11,750
one time it worked,
one time it didn't.

450
00:19:11,750 --> 00:19:14,620
So be careful with
timelining on this.

451
00:19:14,620 --> 00:19:18,724
Other places you can
look. EXIF data? No.

452
00:19:18,724 --> 00:19:20,692
We were hoping that it
would say it was sent from

453
00:19:20,692 --> 00:19:23,228
or taken with Sarah's
iPhone, or captured

454
00:19:23,228 --> 00:19:25,330
with Sarah's Mac,
and then shared.

455
00:19:25,330 --> 00:19:27,765
Didn't get anything there.

456
00:19:27,766 --> 00:19:29,601
Pure desperation at this point,

457
00:19:29,601 --> 00:19:32,371
because you know, someone
told you Sarah sent

458
00:19:32,371 --> 00:19:34,573
a text file to Heather
through AirDrop.

459
00:19:34,573 --> 00:19:37,075
What you could then do is,
you would find it in My Notes.

460
00:19:37,075 --> 00:19:38,443
So if you were looking
at all the databases

461
00:19:38,443 --> 00:19:41,113
on my device, you would
see it was in Notes.

462
00:19:41,113 --> 00:19:43,882
You can see that I show it
in Safari on the far right.

463
00:19:43,882 --> 00:19:45,284
You can open it in
third-party apps.

464
00:19:45,284 --> 00:19:46,785
So at this point,
you are literally

465
00:19:46,785 --> 00:19:50,989
on a wild goose chase, and
do you have time for it?

466
00:19:50,989 --> 00:19:55,394
Your saving grace is this
datausage.sqlite file.

467
00:19:55,394 --> 00:19:57,362
Here, you're actually going
to see sharing SharingD,

468
00:19:57,362 --> 00:19:58,864
so you can do a
search for SharingD,

469
00:19:58,864 --> 00:20:01,600
Sarah already mentioned this,
and we can also see AirDrop,

470
00:20:01,600 --> 00:20:03,168
so you could do a
search for AirDrop.

471
00:20:03,168 --> 00:20:05,003
But that's really
all you're getting.

472
00:20:05,003 --> 00:20:07,371
You will see some of the
Bonjour activity, as well,

473
00:20:07,372 --> 00:20:10,342
but you're not getting the
file that was shared, the date,

474
00:20:10,342 --> 00:20:13,512
timestamps, all the good
stuff that Sarah showed you,

475
00:20:13,512 --> 00:20:16,215
not going to exist on
these backup files,

476
00:20:16,215 --> 00:20:19,518
from what we've been
able to find so far.

477
00:20:19,518 --> 00:20:22,988
If you get crafty, and you
then go for a live analysis

478
00:20:22,988 --> 00:20:26,225
and start doing
dynamic analysis, you
will get log files.

479
00:20:26,225 --> 00:20:29,261
Here, I connected my
iPhone to iBackupBot,

480
00:20:29,261 --> 00:20:32,097
which is free, and I started
doing dynamic analysis,

481
00:20:32,097 --> 00:20:34,066
and just copying
out the log files.

482
00:20:34,066 --> 00:20:36,401
You will see I get
some of what Sarah got,

483
00:20:36,401 --> 00:20:39,371
but not even close
with all the artifacts.

484
00:20:39,371 --> 00:20:42,608
So we can see that my
Bluetooth LE scanning started.

485
00:20:42,608 --> 00:20:44,775
You can see that the
mode was everyone,

486
00:20:44,776 --> 00:20:47,312
so I wanted to
connect with everyone.

487
00:20:47,312 --> 00:20:50,282
You can see scanning
started successfully.

488
00:20:50,282 --> 00:20:51,917
And what you will see is
that it will start scanning,

489
00:20:51,917 --> 00:20:53,619
and it will drop off if
it doesn't find anyone

490
00:20:53,619 --> 00:20:55,754
in that point of time.

491
00:20:55,754 --> 00:20:59,424
Continuing on, you can see that
AirDrop has been initiated,

492
00:20:59,424 --> 00:21:01,260
and it found me.

493
00:21:01,260 --> 00:21:04,062
Sarah mentioned the GUIDs and
the unique IDs for AirDrop.

494
00:21:04,062 --> 00:21:08,100
You can see my AirDrop ID
there, for my Mac, and then,

495
00:21:08,100 --> 00:21:11,637
new AirDrop connection, so a
connection was established.

496
00:21:11,637 --> 00:21:14,373
We can see the handshake and
the negotiation going on.

497
00:21:14,373 --> 00:21:15,807
We can see the request,

498
00:21:15,807 --> 00:21:17,843
and then it's parsing,
it's received.

499
00:21:17,843 --> 00:21:20,078
But it doesn't tell
you what is received,

500
00:21:20,078 --> 00:21:22,381
so you just know that
something was received,

501
00:21:22,381 --> 00:21:23,749
and something is
trying to be shared.

502
00:21:23,749 --> 00:21:25,584
So now, you're still guessing.

503
00:21:25,584 --> 00:21:27,119
What you can get from this,

504
00:21:27,119 --> 00:21:29,855
though, is the
settings on my device.

505
00:21:29,855 --> 00:21:31,456
If you look down
at the bottom here,

506
00:21:31,456 --> 00:21:35,026
where it says Notify
From, FaceUp -> Portrait,

507
00:21:35,027 --> 00:21:38,063
that's how my device is set,
that if my phone is face-up,

508
00:21:38,063 --> 00:21:39,564
I'm gonna get a portrait saying,

509
00:21:39,564 --> 00:21:42,367
"Sarah wants to AirDrop
this file to you."

510
00:21:42,367 --> 00:21:46,437
If you look at the alert
item, you can actually go

511
00:21:46,438 --> 00:21:48,006
into my log file, and it
will tell you what kind

512
00:21:48,006 --> 00:21:50,142
of tone plays, or how
I'm alerted, does it stay

513
00:21:50,142 --> 00:21:53,145
in my notifications, is
it persistent or not.

514
00:21:53,145 --> 00:21:54,346
So you can dive through

515
00:21:54,346 --> 00:21:56,515
and keep digging
into these artifacts.

516
00:21:56,515 --> 00:21:58,950
The final thing that you do get,

517
00:21:58,950 --> 00:22:02,587
you see accepting transfer,
and you see this GUID up here?

518
00:22:02,587 --> 00:22:04,856
What I recommend is
exactly what Sarah said.

519
00:22:04,856 --> 00:22:07,159
Take that GUID, and
search all your plists,

520
00:22:07,159 --> 00:22:09,594
all your databases, anything
you have on the iPhone,

521
00:22:09,594 --> 00:22:10,962
to see if you can associate it

522
00:22:10,962 --> 00:22:13,465
to any way one of our devices.

523
00:22:14,333 --> 00:22:15,600
It doesn't give you information

524
00:22:15,600 --> 00:22:18,503
that even a movie was
sent versus a picture.

525
00:22:18,503 --> 00:22:19,771
You don't get to see
it, so you don't know

526
00:22:19,771 --> 00:22:22,607
that this actual
picture was sent.

527
00:22:22,607 --> 00:22:25,543
The reason I have it there
is because I know I sent it.

528
00:22:25,544 --> 00:22:27,913
And then, you'll see the
server connection drops off.

529
00:22:27,913 --> 00:22:30,415
So it's better
than a backup file,

530
00:22:30,415 --> 00:22:33,985
but chances of you
actually getting the iPhone

531
00:22:33,985 --> 00:22:35,721
and doing live analysis
while an AirDrop

532
00:22:35,721 --> 00:22:38,156
is occurring is
probably slim to none.

533
00:22:38,156 --> 00:22:40,125
Especially if you're
doing forensic analysis

534
00:22:40,125 --> 00:22:43,128
and isolating from the network,
this shouldn't be occurring.

535
00:22:43,128 --> 00:22:45,797
But this is the major
difference on limitations

536
00:22:45,797 --> 00:22:49,801
with iOS on what you will
not get at this point.

537
00:22:50,969 --> 00:22:52,504
With Handoff...

538
00:22:52,504 --> 00:22:53,671
And I'll hand that to you
while I talk with this one.

539
00:22:53,672 --> 00:22:54,639
- You'll hand it off?

540
00:22:54,639 --> 00:22:56,140
- I'll hand that off to you.

541
00:22:56,141 --> 00:22:58,944
- So, that ends AirDrop. Now
we're gonna talk about Handoff.

542
00:22:58,944 --> 00:23:00,745
So, what does it look like
when you start an action

543
00:23:00,746 --> 00:23:04,316
on a Mac, and continue on a
phone, or add in your watch?

544
00:23:04,316 --> 00:23:06,585
Handoff allows us to be lazy.

545
00:23:06,585 --> 00:23:09,588
The lazier we get, sometimes,
the better the evidence is.

546
00:23:09,588 --> 00:23:10,822
Sometimes it makes it harder

547
00:23:10,822 --> 00:23:13,125
to ascertain where
something occurred.

548
00:23:13,125 --> 00:23:15,460
We are going to try
to do that, as well.

549
00:23:15,460 --> 00:23:19,064
But, Handoff allows you to copy
something from your iPhone,

550
00:23:19,064 --> 00:23:22,634
continue on your Mac,
and continue through.

551
00:23:22,634 --> 00:23:25,404
Some prerequisites here.

552
00:23:25,404 --> 00:23:27,806
Bluetooth and wifi
must be enabled.

553
00:23:27,806 --> 00:23:30,308
You must be on the same
network, so you have

554
00:23:30,308 --> 00:23:32,277
to be on the same wifi network.

555
00:23:32,277 --> 00:23:34,679
You have to have the
same iCloud account.

556
00:23:34,679 --> 00:23:37,783
So, it's not that Sarah can
continue onto my devices,

557
00:23:37,783 --> 00:23:39,851
it would be all
hers or all mine.

558
00:23:39,851 --> 00:23:41,253
And Handoff must be enabled.

559
00:23:41,253 --> 00:23:42,654
You'll see in the
slides here, we show you

560
00:23:42,654 --> 00:23:44,256
how to enable it on your phone,

561
00:23:44,256 --> 00:23:47,626
how to enable it
on your actual Mac.

562
00:23:47,626 --> 00:23:49,895
And you'll see on
the screenshots here,

563
00:23:49,895 --> 00:23:52,531
the little icons are
showing you that continuity

564
00:23:52,531 --> 00:23:54,533
and Handoff is actually
enabled, and this

565
00:23:54,533 --> 00:23:55,833
is where it's going to continue,

566
00:23:55,834 --> 00:23:59,104
and where you can pick
up where you left off.

567
00:23:59,104 --> 00:24:01,606
So as an example, going
back to those Mac logs,

568
00:24:01,606 --> 00:24:02,941
again, those Mac
logs are gonna be

569
00:24:02,941 --> 00:24:05,877
your key evidence
from this case.

570
00:24:05,877 --> 00:24:07,579
So we go again, SharingD.

571
00:24:07,579 --> 00:24:09,614
We're looking for
Com.Apple.Sharing

572
00:24:09,614 --> 00:24:11,249
instead of AirDrop,
like we saw before.

573
00:24:11,249 --> 00:24:13,752
We're gonna look for
Handoff specifically.

574
00:24:13,752 --> 00:24:15,287
And again, we have
those different GUIDs

575
00:24:15,287 --> 00:24:18,156
that are bolded in there to
show different transactions.

576
00:24:18,156 --> 00:24:20,358
So I might be interested in
this particular transaction,

577
00:24:20,358 --> 00:24:24,229
I'm gonna do a search for that
one string that starts 476ED,

578
00:24:24,229 --> 00:24:28,400
and look through that whole
list of different log events.

579
00:24:29,334 --> 00:24:30,569
And again, it could be hundreds,

580
00:24:30,569 --> 00:24:32,904
it could be thousands
of different events.

581
00:24:32,904 --> 00:24:36,808
Below that, we have SharingD:
Received A New Advertisement.

582
00:24:36,808 --> 00:24:41,680
So it sees that I have a
device-unique ID, it is F9B.

583
00:24:41,680 --> 00:24:44,182
There's that GUID
again, that I want

584
00:24:44,182 --> 00:24:46,184
to look across all my devices,

585
00:24:46,184 --> 00:24:48,620
perhaps look in my
Bluetooth plist, to try

586
00:24:48,620 --> 00:24:50,988
to match it up to
a specific device.

587
00:24:50,989 --> 00:24:53,325
In this case, it's very nice,
cause it actually shows me

588
00:24:53,325 --> 00:24:55,227
which device it's
associated with.

589
00:24:55,227 --> 00:24:56,962
Sometimes you get that,
sometimes you don't.

590
00:24:56,962 --> 00:24:59,297
Sometimes you have to
search within context.

591
00:24:59,297 --> 00:25:02,234
So if I keep going down
into that one log entry,

592
00:25:02,234 --> 00:25:06,237
I'll see device name
is miPhone7, and
the make and model,

593
00:25:06,238 --> 00:25:09,074
which is the iPhone 9,3, which,

594
00:25:09,074 --> 00:25:12,010
in human terms, is the iPhone 7.

595
00:25:12,010 --> 00:25:15,413
So we'll see a lot of those
items going back and forth,

596
00:25:15,413 --> 00:25:18,817
which can be very helpful
to tie to specific devices.

597
00:25:18,817 --> 00:25:21,586
Now again, we're gonna
look for that F9B.

598
00:25:21,586 --> 00:25:24,756
That is my miPhone7
unique identifier.

599
00:25:26,291 --> 00:25:28,360
You're not just gonna
wanna search and filter

600
00:25:28,360 --> 00:25:31,295
on those Handoff or
the SharingD stuff.

601
00:25:31,296 --> 00:25:33,698
You're gonna wanna look
within context, as well.

602
00:25:33,698 --> 00:25:35,200
Cause I'm showing
you another one here,

603
00:25:35,200 --> 00:25:39,938
it says Dock: (UserActivity)
[Com.Apple.UserActivity.Main].

604
00:25:39,938 --> 00:25:42,607
And this is gonna show you
certain information associated.

605
00:25:42,607 --> 00:25:46,144
So this is that little icon
that pops up if I'm working

606
00:25:46,144 --> 00:25:48,780
on a text document or
an email, that says,

607
00:25:48,780 --> 00:25:50,715
"Hey, would you like
to hand this off?"

608
00:25:50,715 --> 00:25:52,783
That shows up on the doc itself.

609
00:25:52,784 --> 00:25:54,586
Now, this one I
highlighted specifically,

610
00:25:54,586 --> 00:25:57,856
cause it says
UserActivityHasWebpageURL.

611
00:25:57,856 --> 00:25:59,891
Sometimes you get hints
of what type of data

612
00:25:59,891 --> 00:26:03,061
is being pushed back
and forth to devices.

613
00:26:03,061 --> 00:26:04,396
And I'll show you
another one here,

614
00:26:04,396 --> 00:26:07,264
with the Bird: or the
(CloudDocsDaemon).

615
00:26:07,265 --> 00:26:09,534
A lot of this stuff happens
over iCloud, as well,

616
00:26:09,534 --> 00:26:11,603
so you don't wanna
filter out of everything,

617
00:26:11,603 --> 00:26:13,672
you wanna look within context.

618
00:26:13,672 --> 00:26:14,806
And again, you're
gonna be looking

619
00:26:14,806 --> 00:26:17,042
at thousands of
different messages here.

620
00:26:17,042 --> 00:26:19,377
There's a lot of
things to look at.

621
00:26:19,377 --> 00:26:23,214
So just don't get
frustrated, and get used

622
00:26:23,214 --> 00:26:25,015
to seeing some of these things.

623
00:26:25,016 --> 00:26:26,618
I was actually worried
that these logs

624
00:26:26,618 --> 00:26:28,453
wouldn't be very verbose.

625
00:26:28,453 --> 00:26:29,721
Unfortunately,
they're more verbose

626
00:26:29,721 --> 00:26:31,690
than you even want them to be.

627
00:26:31,690 --> 00:26:33,091
But I say, more is
better than nothing,

628
00:26:33,091 --> 00:26:35,526
so I'm willing to take it.

629
00:26:35,527 --> 00:26:37,028
- With an example here.

630
00:26:37,028 --> 00:26:38,229
So, a little scenario.

631
00:26:38,229 --> 00:26:40,398
What you're actually
looking at, and you have

632
00:26:40,398 --> 00:26:43,101
to look up top, the
iPhone to the Mac.

633
00:26:43,101 --> 00:26:46,304
On this specific
scenario, Safari was

634
00:26:46,304 --> 00:26:48,940
opened and browsing
on the iPhone.

635
00:26:48,940 --> 00:26:52,243
The screenshot on the
far right is the iPhone.

636
00:26:52,243 --> 00:26:55,746
When going to the Mac, the
Mac was set that Chrome

637
00:26:55,747 --> 00:26:58,750
is the default
browser, not Safari.

638
00:26:58,750 --> 00:27:00,485
So the Mac is smart
enough to know

639
00:27:00,485 --> 00:27:02,954
that the user wants to
access what they are doing

640
00:27:02,954 --> 00:27:06,291
on their iPhone in
Safari, in Chrome.

641
00:27:06,291 --> 00:27:07,826
So you will have
artifacts from both here.

642
00:27:07,826 --> 00:27:12,631
What you see on the iPhone,
browsing Safari, one continuing

643
00:27:12,631 --> 00:27:16,001
on the Mac, you see the
little iPhone by Chrome.

644
00:27:16,001 --> 00:27:17,068
When you click on
that, it continues

645
00:27:17,068 --> 00:27:19,304
exactly where you left off.

646
00:27:20,472 --> 00:27:21,740
- What does that look like?

647
00:27:21,740 --> 00:27:23,842
If I actually click
that link on my Mac

648
00:27:23,842 --> 00:27:26,211
in Chrome, what
does that look like?

649
00:27:26,211 --> 00:27:28,847
So, UserActivityD is gonna say,

650
00:27:28,847 --> 00:27:31,783
Queuing Fetch For BestAppUUID.

651
00:27:31,783 --> 00:27:33,418
It's basically looking
for the best app

652
00:27:33,418 --> 00:27:35,553
associated with that
particular data.

653
00:27:35,553 --> 00:27:37,822
In this case, it's gonna
be my Chrome browser.

654
00:27:37,822 --> 00:27:40,125
I get a few other things,
like Fetching Payload,

655
00:27:40,125 --> 00:27:43,962
Requesting Payload, Request
To that specific UUID again,

656
00:27:43,962 --> 00:27:46,064
associated with a
specific device.

657
00:27:46,064 --> 00:27:48,333
And finally, Requesting
Handoff Payload,

658
00:27:48,333 --> 00:27:50,001
and so on, so forth.

659
00:27:53,738 --> 00:27:56,307
Next one we're gonna see is
that SharingD item again.

660
00:27:56,307 --> 00:27:59,344
But we have a
different item here,

661
00:27:59,344 --> 00:28:02,180
(Com.Apple.Transport.IDSConnect.

662
00:28:02,180 --> 00:28:04,249
It's using this
identity services stuff

663
00:28:04,249 --> 00:28:07,352
to show the different
interaction between the devices.

664
00:28:07,352 --> 00:28:09,721
And you can also do
searches for the continuity.

665
00:28:09,721 --> 00:28:11,589
Com.Apple.Private.Alloy.Continu,

666
00:28:11,589 --> 00:28:13,992
you'll see that in these
logs every once in a while.

667
00:28:13,992 --> 00:28:16,995
So you get certain hints
on this type of activity.

668
00:28:16,995 --> 00:28:19,363
You also see this
IdentityServices,

669
00:28:19,364 --> 00:28:22,200
Continuity Connect To Peer.

670
00:28:22,200 --> 00:28:25,003
So I can tie that one
GUID to a specific device,

671
00:28:25,003 --> 00:28:27,706
and, if I look
within context, I see

672
00:28:27,706 --> 00:28:29,974
some Google Chrome
activity happening here.

673
00:28:29,974 --> 00:28:33,078
(Com.Apple.CFPasteboard.Entry),
we'll talk about

674
00:28:33,078 --> 00:28:34,745
that one a little
bit further on,

675
00:28:34,746 --> 00:28:37,148
but that's basically
saying, "I got this URL

676
00:28:37,148 --> 00:28:40,885
"in my pasteboard, and I
wanna provide it to you."

677
00:28:40,885 --> 00:28:43,288
And I (mumbles) that
in the UTF plaintext.

678
00:28:43,288 --> 00:28:44,522
So you get an idea of what type

679
00:28:44,522 --> 00:28:47,058
of data storage it's
holding off here.

680
00:28:47,058 --> 00:28:49,494
Then finally, Received
Requested Handoff Payload

681
00:28:49,494 --> 00:28:52,030
From "miPhone7," and you can see

682
00:28:52,030 --> 00:28:55,266
that it's been shared
to my Mac itself.

683
00:28:57,068 --> 00:29:01,306
So, kind of figuring out where
application was being used,

684
00:29:01,306 --> 00:29:03,341
you have to look within context.

685
00:29:03,341 --> 00:29:05,610
These are all separate
events on here,

686
00:29:05,610 --> 00:29:07,212
I just wanna point that out.

687
00:29:07,212 --> 00:29:10,415
So, if I'm sharing a Notes,
look for the Notes application.

688
00:29:10,415 --> 00:29:14,284
Reminders, mail, maps, numbers,
all this can be handed off.

689
00:29:14,285 --> 00:29:16,121
There's many different
applications.

690
00:29:16,121 --> 00:29:17,889
You always have to
look within context

691
00:29:17,889 --> 00:29:21,391
of that Handoff log activity,
and try to figure out

692
00:29:21,392 --> 00:29:25,396
which application was
actually being handed off to.

693
00:29:25,396 --> 00:29:26,331
I usually just do a search for

694
00:29:26,331 --> 00:29:28,166
that copy data, and that seems

695
00:29:28,166 --> 00:29:32,337
to be a good standard key term
to look for, in this case.

696
00:29:33,204 --> 00:29:35,373
So, from the Mac to the phone,

697
00:29:35,373 --> 00:29:38,977
if I'm in the Maps
application on the Mac itself,

698
00:29:38,977 --> 00:29:42,580
on my laptop, and I wanna
send a certain location

699
00:29:42,580 --> 00:29:45,716
to my phone, maybe I'm gonna
go drive there or something,

700
00:29:45,717 --> 00:29:47,852
I can see that I have
the Maps: (CoreSpotlight)

701
00:29:47,852 --> 00:29:50,855
going on there, the
BundleID:Com.Apple.Maps.

702
00:29:50,855 --> 00:29:54,826
The SharingD Handoff log
activity is there, as well.

703
00:29:54,826 --> 00:29:57,328
You see it's connecting
to my iPhone 7,

704
00:29:57,328 --> 00:30:01,232
it's received items, so,
instead of sent, it's receiving.

705
00:30:01,232 --> 00:30:03,101
And then finally, you get
the model identification,

706
00:30:03,101 --> 00:30:06,538
the name, and the IDs
associated with that, as well.

707
00:30:06,538 --> 00:30:08,473
So you can correlate
this stuff back and forth

708
00:30:08,473 --> 00:30:11,276
pretty easily
using the Mac logs.

709
00:30:11,276 --> 00:30:14,445
Now, we also have Ready
To Respond To Handoff.

710
00:30:14,445 --> 00:30:16,281
These things are
extremely verbose.

711
00:30:16,281 --> 00:30:18,883
It almost seems
redundant at times.

712
00:30:18,883 --> 00:30:22,654
So, responding ready to Handoff,
Received Payload Request,

713
00:30:22,654 --> 00:30:24,589
and then finally,
you get the Bird:,

714
00:30:24,589 --> 00:30:27,559
the cloud docs information,
the iCloud information.

715
00:30:27,559 --> 00:30:28,927
And then finally, we have

716
00:30:28,927 --> 00:30:31,329
Requesting Handoff Encryption
Key From "MiPhone".

717
00:30:31,329 --> 00:30:34,365
So we saw it sets up SSL,
it sets up encryption keys.

718
00:30:34,365 --> 00:30:36,634
Honestly, from a
network standpoint,

719
00:30:36,634 --> 00:30:38,169
we've not looked at that yet.

720
00:30:38,169 --> 00:30:40,905
We told you we are going
to look at it, eventually.

721
00:30:40,905 --> 00:30:42,407
It's gonna be really
interesting to see

722
00:30:42,407 --> 00:30:46,444
if we can see anything, because
of that encryption on there.

723
00:30:48,446 --> 00:30:51,315
- Now we have a few other
tiny sections here for you,

724
00:30:51,316 --> 00:30:53,551
just to summarize other
things that we've seen.

725
00:30:53,551 --> 00:30:55,453
So, Apple Pay.

726
00:30:55,453 --> 00:30:58,189
On my Mac, in
Safari, I browse out

727
00:30:58,189 --> 00:31:00,358
to this Etsy site, which,
Eric, if you're sitting

728
00:31:00,358 --> 00:31:02,694
in here, this is
what those bows are.

729
00:31:02,694 --> 00:31:05,997
I went to an Etsy site, and
looked for Tiny Vibes Boutique.

730
00:31:05,997 --> 00:31:09,234
From there, I had the
option to use Apple Pay.

731
00:31:09,234 --> 00:31:11,401
So I used the touch
ID on my phone,

732
00:31:11,402 --> 00:31:14,472
and it saved to the Mac,
and also, on the phone.

733
00:31:14,472 --> 00:31:16,841
This is where the
artifacts could get tricky.

734
00:31:16,841 --> 00:31:18,976
The good news is, with
Safari, you'll see,

735
00:31:18,977 --> 00:31:21,379
under the history database file,

736
00:31:21,379 --> 00:31:24,115
you can see the
origin column and say,

737
00:31:24,115 --> 00:31:26,150
"Did it happen on
this device, or

738
00:31:26,150 --> 00:31:29,787
"is it associated from another
device on that same iCloud?"

739
00:31:29,787 --> 00:31:31,356
So you could then say,
"Okay, it's something else

740
00:31:31,356 --> 00:31:34,292
"that Heather was on, that's
logged into her same iCloud."

741
00:31:34,292 --> 00:31:35,927
And if you go back to
the very beginning,

742
00:31:35,927 --> 00:31:37,462
where Sarah showed
all my devices

743
00:31:37,462 --> 00:31:40,798
that my iPhone recognized,
it would be one of those.

744
00:31:40,798 --> 00:31:42,300
Also, the recents.

745
00:31:44,302 --> 00:31:46,937
I recovered the
actual transaction,

746
00:31:46,938 --> 00:31:48,706
where I got the
transaction receipt sent

747
00:31:48,706 --> 00:31:50,207
to my email, I was able to go...

748
00:31:50,208 --> 00:31:52,076
I deleted it, because I
delete everything as quickly

749
00:31:52,076 --> 00:31:54,746
as it comes in, even when
I'm creating evidence.

750
00:31:54,746 --> 00:31:56,447
And I was able to go in
and actually carve it out

751
00:31:56,447 --> 00:31:59,117
of the hex and recover
this information.

752
00:31:59,117 --> 00:32:00,985
But again, this is
really what you got

753
00:32:00,985 --> 00:32:02,520
with the Apple Pay artifacts.

754
00:32:02,520 --> 00:32:06,624
You can see that I go out to
Etsy, that I purchase a bow,

755
00:32:06,624 --> 00:32:09,160
that I paid for
it with Apple Pay,

756
00:32:09,160 --> 00:32:10,929
I got the transaction receipt,
and then you see the picture

757
00:32:10,929 --> 00:32:14,265
of my daughter with
the bow on her head.

758
00:32:17,235 --> 00:32:20,138
- So, one more. We
got Auto Unlock.

759
00:32:20,138 --> 00:32:22,572
This one I was thrilled
to be able to view.

760
00:32:22,573 --> 00:32:24,108
Auto Unlock is
the activity where

761
00:32:24,108 --> 00:32:26,476
I can open up my
Mac with my watch.

762
00:32:26,477 --> 00:32:28,379
There's certain
requirements for that.

763
00:32:28,379 --> 00:32:29,914
I had to be on the
same iCloud account,

764
00:32:29,914 --> 00:32:32,450
I had to have two-factor
authentication, Bluetooth

765
00:32:32,450 --> 00:32:34,953
and network have to be
enabled, all sorts of stuff.

766
00:32:34,953 --> 00:32:38,322
All the moons have to
align for this all to work.

767
00:32:38,323 --> 00:32:40,425
But it does actually
work out quite well.

768
00:32:40,425 --> 00:32:42,961
This just saves me
inputting the password in,

769
00:32:42,961 --> 00:32:45,229
because it's authenticating
through my watch.

770
00:32:45,229 --> 00:32:48,466
Very useful. So what
does it look like?

771
00:32:50,435 --> 00:32:51,569
That's not gonna happen, sorry.

772
00:32:51,569 --> 00:32:53,104
(laughter)

773
00:32:53,104 --> 00:32:55,974
We got a few more slides here
left to go. So, Auto Unlock.

774
00:32:55,974 --> 00:32:57,841
Again, we have these
Apple unified logs.

775
00:32:57,842 --> 00:32:59,477
We have different lock states.

776
00:32:59,477 --> 00:33:03,214
We'll see the lock states
just in general logging terms.

777
00:33:03,214 --> 00:33:06,250
It doesn't necessarily
associate to Auto Unlock.

778
00:33:06,250 --> 00:33:09,620
So I'm specifically gonna look
for that Auto Unlock activity

779
00:33:09,620 --> 00:33:11,889
and those log entries, and look

780
00:33:11,889 --> 00:33:14,024
for the different
log states in here.

781
00:33:14,025 --> 00:33:15,860
There's also other things
that we can look for,

782
00:33:15,860 --> 00:33:18,196
the Bluetooth, the
wireless proximity,

783
00:33:18,196 --> 00:33:21,198
nearby agent, sharing Handoff.

784
00:33:21,199 --> 00:33:23,201
Handoff gets used as
a subset for a lot

785
00:33:23,201 --> 00:33:26,871
of other Apple continuity
activity, as well.

786
00:33:28,006 --> 00:33:29,407
So, actually unlocking.

787
00:33:29,407 --> 00:33:30,942
You can see the Begin
Unlock in there.

788
00:33:30,942 --> 00:33:33,878
You can see the device
information, the make and model,

789
00:33:33,878 --> 00:33:36,280
the Apple ID
association with that,

790
00:33:36,280 --> 00:33:38,916
and a few other
devices in there.

791
00:33:38,916 --> 00:33:41,819
So the SharingD: AutoUnlock
Scanning For Bluetooth IDs,

792
00:33:41,819 --> 00:33:43,821
that's my phone and my watch.

793
00:33:43,821 --> 00:33:45,923
So it's got a proxy
device, meaning my phone,

794
00:33:45,923 --> 00:33:49,927
as well as the ID for the
watch itself in there.

795
00:33:51,095 --> 00:33:52,830
Once the unlock
actually happened,

796
00:33:52,830 --> 00:33:55,533
you can verify that with
these couple of items.

797
00:33:55,533 --> 00:33:57,034
It'll show you
which user account.

798
00:33:57,035 --> 00:33:58,770
My user account name is Oompa,

799
00:33:58,770 --> 00:34:01,072
a bad nickname that
I got many years ago.

800
00:34:01,072 --> 00:34:02,907
I think it's cause I'm short.

801
00:34:02,907 --> 00:34:05,076
A couple of different
Bluetooth IDs, again,

802
00:34:05,076 --> 00:34:07,645
the watch identifier
information, whether unlock

803
00:34:07,645 --> 00:34:10,081
was enabled, and whether
it was locked on my wrist.

804
00:34:10,081 --> 00:34:13,818
So if I had not put the
PIN code on my watch here,

805
00:34:13,818 --> 00:34:18,022
it's not gonna unlock,
so it is a locked device.

806
00:34:18,022 --> 00:34:20,158
Then finally, if I keep going
down here, I'm gonna see

807
00:34:20,158 --> 00:34:23,261
some Bluetooth IDs and
ranging information.

808
00:34:23,261 --> 00:34:24,629
It's basically
saying, "Is this watch

809
00:34:24,629 --> 00:34:27,197
"within proximity
of this laptop?"

810
00:34:27,197 --> 00:34:29,366
And different keybag
states and lock states

811
00:34:29,367 --> 00:34:31,035
associated with that.

812
00:34:31,034 --> 00:34:33,804
One note on this
Mac address here.

813
00:34:33,804 --> 00:34:37,140
Apple uses Mac
randomization for a lot

814
00:34:37,141 --> 00:34:39,077
of the Bluetooth and
wireless information.

815
00:34:39,077 --> 00:34:41,045
So you might see these
Mac addresses in here

816
00:34:41,045 --> 00:34:43,347
and try to pair it up
with a certain device.

817
00:34:43,347 --> 00:34:45,016
You're not gonna have a
whole lot of luck with that,

818
00:34:45,016 --> 00:34:48,519
because of the randomization,
so just a caveat there.

819
00:34:48,518 --> 00:34:51,589
You see it, you wanna
associate it with something,

820
00:34:51,589 --> 00:34:53,190
but Apple is not
going to let you,

821
00:34:53,190 --> 00:34:55,393
from a privacy standpoint,
so you gotta look

822
00:34:55,393 --> 00:34:59,063
in different areas of
the logs themselves.

823
00:34:59,063 --> 00:35:00,231
A couple caveats.

824
00:35:00,231 --> 00:35:03,634
If you do open up,
unlock your Mac devices

825
00:35:04,735 --> 00:35:06,637
with the watch itself,
it doesn't look

826
00:35:06,637 --> 00:35:08,973
the same as other
unlocks in the log.

827
00:35:08,973 --> 00:35:11,209
Sometimes it doesn't
get recorded at all.

828
00:35:11,209 --> 00:35:12,743
I'm still doing some
research on that,

829
00:35:12,743 --> 00:35:15,145
to figure out why it's
not being recorded,

830
00:35:15,146 --> 00:35:16,781
cause from a
forensic standpoint,

831
00:35:16,781 --> 00:35:19,683
that's gonna be really
important information.

832
00:35:19,684 --> 00:35:24,021
So in different logs, it
looks slightly different.

833
00:35:24,021 --> 00:35:25,756
- All right, I'll go
through Clipboard quickly.

834
00:35:25,756 --> 00:35:28,225
You do get these slides.
So, Clipboard here.

835
00:35:28,226 --> 00:35:30,695
We're on the Mac,
copying from Notes,

836
00:35:30,695 --> 00:35:33,865
pasting it into the iPhone,
and sending an email.

837
00:35:33,865 --> 00:35:35,031
We're just going to
take a quick look

838
00:35:35,032 --> 00:35:36,501
at what this looks like.

839
00:35:36,501 --> 00:35:38,069
When we look at the
log files on the Mac,

840
00:35:38,069 --> 00:35:39,303
what you're actually
going to see

841
00:35:39,303 --> 00:35:42,140
is the copypaste, so the
app that's being used.

842
00:35:42,140 --> 00:35:44,575
We can see the payload
request, that unique identifier

843
00:35:44,575 --> 00:35:47,044
that Sarah had mentioned
earlier, we see it's associated

844
00:35:47,044 --> 00:35:50,982
to the iPhone, and we see
that this was a text file.

845
00:35:50,982 --> 00:35:52,383
If you look at the
Flavor: at the bottom,

846
00:35:52,383 --> 00:35:54,218
that's what you're seeing there.

847
00:35:54,218 --> 00:35:56,953
Continuing on, we sent
two more flavors here.

848
00:35:56,954 --> 00:35:59,090
Flavor one was a
.jpeg, and then,

849
00:35:59,090 --> 00:36:01,459
flavor two was actually
going to be a movie file.

850
00:36:01,459 --> 00:36:02,926
As you go through here,
you're going to see

851
00:36:02,927 --> 00:36:05,496
the payload request and all
the sharing information,

852
00:36:05,496 --> 00:36:07,298
as well as that it was remote.

853
00:36:07,298 --> 00:36:08,633
The device is not the same one,

854
00:36:08,633 --> 00:36:10,868
so a remote device
was reaching out.

855
00:36:10,868 --> 00:36:13,070
Here, you can actually
see where the iPhone

856
00:36:13,070 --> 00:36:15,606
was sending the
movie to the Mac.

857
00:36:15,606 --> 00:36:18,342
That icon at the end there
is what it looks like

858
00:36:18,342 --> 00:36:20,611
on the Mac when the
movie is coming in.

859
00:36:20,611 --> 00:36:23,314
You can see from the log files
all of this remote access

860
00:36:23,314 --> 00:36:26,584
actually happening
with the continuity.

861
00:36:28,019 --> 00:36:31,522
- And finally, one last topic
for you is Instant Hotspot.

862
00:36:31,522 --> 00:36:33,524
So I have my phone
that I can tether to,

863
00:36:33,524 --> 00:36:35,859
so when I have crappy hotel
Internet, which I'm sure

864
00:36:35,860 --> 00:36:39,630
we've never come across before
ever, I can tether my phone

865
00:36:39,630 --> 00:36:42,066
to it, so I can actually
get some decent signal.

866
00:36:42,066 --> 00:36:45,136
It uses that same continuity
features on there.

867
00:36:45,136 --> 00:36:48,306
Again, Bluetooth and wireless
need to be up and running.

868
00:36:48,306 --> 00:36:51,242
And I can just select it
up in my wireless settings.

869
00:36:51,242 --> 00:36:53,578
Instead of AirDrop or
Handoff, I'm gonna look

870
00:36:53,578 --> 00:36:56,346
for Sharing.Tethering
in this case.

871
00:36:56,347 --> 00:36:57,882
So you can see it's
starting to browse, scanning

872
00:36:57,882 --> 00:37:00,084
for available tethering
devices, it's gonna find

873
00:37:00,084 --> 00:37:02,587
my phone in there with that F7.

874
00:37:02,587 --> 00:37:05,590
Discovered new device, you
see the wifi agent in there,

875
00:37:05,590 --> 00:37:08,326
miPhone7 and all the
other identifiers.

876
00:37:08,326 --> 00:37:10,094
But also the battery
life, what type

877
00:37:10,094 --> 00:37:12,496
of network it's on, and
the signal strength.

878
00:37:12,496 --> 00:37:14,332
That's signal
strength two, meaning

879
00:37:14,332 --> 00:37:17,868
it's got two dots
filled in on my iPhone,

880
00:37:17,868 --> 00:37:21,272
versus the normal five
if you have good signal.

881
00:37:21,272 --> 00:37:22,740
A few other things.

882
00:37:22,740 --> 00:37:25,575
Enabling Hotspot, so you can
see if it was just searched for

883
00:37:25,576 --> 00:37:27,745
or if it was actually enabled,

884
00:37:27,745 --> 00:37:30,147
whether credentials were
passed back and forth,

885
00:37:30,147 --> 00:37:32,917
the different channel
information on there,

886
00:37:32,917 --> 00:37:35,653
and finally, that it's
enabled, and the information

887
00:37:35,653 --> 00:37:38,856
associated with that
at the very end.

888
00:37:38,856 --> 00:37:40,024
- All right, so these are

889
00:37:40,024 --> 00:37:41,225
our final two slides,
Rob, we promise.

890
00:37:41,225 --> 00:37:43,160
Our caveats here.

891
00:37:43,160 --> 00:37:46,062
Mac artifacts are more
fruitful, and we do mean that,

892
00:37:46,063 --> 00:37:49,900
we do, with Cider, and the
pun, and everything here.

893
00:37:49,900 --> 00:37:51,836
We literally scratched
the surface here,

894
00:37:51,836 --> 00:37:54,372
so we have a ton
more digging to do.

895
00:37:54,372 --> 00:37:58,509
We intend to keep presenting
this at further events.

896
00:37:58,509 --> 00:38:00,177
What we're going to
do is, we're going

897
00:38:00,177 --> 00:38:03,648
to throw in Phil's network
respective with this.

898
00:38:03,648 --> 00:38:05,349
Sarah and I are going
to keep digging.

899
00:38:05,349 --> 00:38:07,451
We want to focus a
little bit more on iOS,

900
00:38:07,451 --> 00:38:10,021
and also throw in
jailbroken devices, and see

901
00:38:10,021 --> 00:38:12,556
what it actually looks like,
so you know what you can get

902
00:38:12,556 --> 00:38:14,458
if you have a forensic
image, versus trying

903
00:38:14,458 --> 00:38:17,895
to do dynamic analysis
on these devices.

904
00:38:17,895 --> 00:38:20,598
Just be aware that the
timestamps are tricky.

905
00:38:20,598 --> 00:38:23,467
Do not rely on them
when it comes to iOS.

906
00:38:23,467 --> 00:38:25,303
Make sure you are digging
through these logs,

907
00:38:25,303 --> 00:38:27,938
you will get buried in
them very, very quickly.

908
00:38:27,938 --> 00:38:29,307
It's a lot of data.

909
00:38:29,307 --> 00:38:32,310
- It's exhausting.
It is exhausting.

910
00:38:33,744 --> 00:38:35,846
So, again, if you
wanna see more about

911
00:38:35,846 --> 00:38:38,649
how we evolve this presentation,
we're gonna give it

912
00:38:38,649 --> 00:38:40,685
at a few different
other locations.

913
00:38:40,685 --> 00:38:42,420
If you're interested
in just general mobile

914
00:38:42,420 --> 00:38:44,121
or Mac forensics,
come to our classes,

915
00:38:44,121 --> 00:38:45,923
we got a few of
them going on here.

916
00:38:45,923 --> 00:38:47,290
We're both here
for the whole week,

917
00:38:47,291 --> 00:38:49,160
and Austin, which
is gonna be awesome.

918
00:38:49,160 --> 00:38:52,263
But we do travel to
other places, as well.

919
00:38:52,263 --> 00:38:53,497
- You can still transfer out of

920
00:38:53,497 --> 00:38:54,899
your other classes and
come to ours this week.

921
00:38:54,899 --> 00:38:56,467
(laughter)

922
00:38:56,467 --> 00:38:58,869
If you've changed your mind,
we'd be happy to have you.

923
00:38:58,869 --> 00:39:01,072
- Absolutely. All right.

924
00:39:01,072 --> 00:39:03,407
Thank you very much, I hope
you enjoyed the presentation.

925
00:39:03,407 --> 00:39:04,442
Slides will be
available later on.

926
00:39:04,442 --> 00:39:06,277
(applause)

927
00:39:06,277 --> 00:39:09,280
(suspenseful music)

