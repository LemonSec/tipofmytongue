1
00:00:00,734 --> 00:00:03,336
(light ethereal music)

2
00:00:09,309 --> 00:00:11,878
(audience applauding)

3
00:00:11,878 --> 00:00:15,415
- So today we're gonna talk
about the Alexa Echo system

4
00:00:15,415 --> 00:00:18,718
and really find out
if she is or will be,

5
00:00:18,718 --> 00:00:20,620
I mean, we're from the future,

6
00:00:20,620 --> 00:00:22,956
if she is or will be Skynet.

7
00:00:24,090 --> 00:00:25,925
So, just what we're
gonna talk about today.

8
00:00:25,925 --> 00:00:27,360
We'll give you an introduction.

9
00:00:27,360 --> 00:00:29,729
I know that as Sarah
Connor in the Terminator,

10
00:00:29,729 --> 00:00:31,531
we don't really need
an introduction,

11
00:00:31,531 --> 00:00:33,299
but we'll tell you who we are.

12
00:00:33,299 --> 00:00:35,268
Then we'll talk about
the hardware side,

13
00:00:35,268 --> 00:00:40,206
then we'll go a little into
the apps, both kasa and Alexa.

14
00:00:40,206 --> 00:00:42,342
Then we'll go ahead and
talk about some script

15
00:00:42,342 --> 00:00:46,713
and some great security
information that we discovered.

16
00:00:46,713 --> 00:00:48,648
And then we'll take questions.

17
00:00:48,648 --> 00:00:50,083
So, I'm Jessica.

18
00:00:50,083 --> 00:00:52,684
Briefly tell you my
background that's pertinent

19
00:00:52,685 --> 00:00:54,954
to the portion I did, which
is that I used to work

20
00:00:54,954 --> 00:00:57,257
in a forensics reverse
engineering lab

21
00:00:57,257 --> 00:01:01,795
where all I did was hack
into devices that needed

22
00:01:01,795 --> 00:01:05,632
hardware exploitation,
so JTAG, Chip-Off, etc.

23
00:01:08,134 --> 00:01:09,869
You want to know
my fun fact here?

24
00:01:09,869 --> 00:01:12,839
I don't normally run but
I do run for DATA Gen.

25
00:01:12,839 --> 00:01:16,709
So if last year you saw
Brian Moran's talk at OSDF,

26
00:01:16,709 --> 00:01:19,746
those run times were
mine and they're sad.

27
00:01:19,746 --> 00:01:23,917
I asked him for a t-shirt
and all I got was a meme.

28
00:01:24,918 --> 00:01:26,419
- So my name is Brian.

29
00:01:26,419 --> 00:01:28,188
Most of you probably know me.

30
00:01:28,188 --> 00:01:29,789
If you don't, again,
my name is Brian.

31
00:01:29,789 --> 00:01:32,659
I spent 13 years in the
Air Force, which actually,

32
00:01:32,659 --> 00:01:35,795
honestly enough, Sarah Edwards
did not know until last night

33
00:01:35,795 --> 00:01:37,597
that I was actually in
the Air Force before,

34
00:01:37,597 --> 00:01:40,500
which just blew her mind,
which is pretty awesome.

35
00:01:40,500 --> 00:01:42,035
You know, I've known
Sarah for a long time

36
00:01:42,035 --> 00:01:44,838
and somehow that blew her mind
that I was in the military.

37
00:01:44,838 --> 00:01:47,806
So if you watched us on
the Forensic Lunch about

38
00:01:47,807 --> 00:01:50,376
three or four weeks ago,
you might have noticed that

39
00:01:50,376 --> 00:01:52,612
Alexa actually popped
on during our talk

40
00:01:52,612 --> 00:01:54,814
and Dave was actually
talking to her.

41
00:01:54,814 --> 00:01:57,484
So, I didn't have smooth jazz
because I didn't actually

42
00:01:57,484 --> 00:02:00,820
have any music set up with my
actual fake Amazon account.

43
00:02:00,820 --> 00:02:03,690
However, Dave can't be with
us but I want to go ahead

44
00:02:03,690 --> 00:02:06,792
and just capture the essence
of all things that are Dave

45
00:02:06,793 --> 00:02:07,994
and smooth jazz.

46
00:02:07,994 --> 00:02:09,829
So that's my fun fact.

47
00:02:11,931 --> 00:02:14,267
So for this presentation,
just to kind of go over

48
00:02:14,267 --> 00:02:16,503
what we did kind of
Harbor-wise and everything,

49
00:02:16,503 --> 00:02:18,571
we obviously had to
use a bunch of phones,

50
00:02:18,571 --> 00:02:20,273
get a bunch of Amazon devices,

51
00:02:20,273 --> 00:02:22,375
and we started to work
through all of that.

52
00:02:22,375 --> 00:02:25,678
Our plan was actually
to bring in iOS devices

53
00:02:25,678 --> 00:02:28,114
as well as looking at what
the Amazon was actually

54
00:02:28,114 --> 00:02:30,583
working on releasing,
which is gonna be their new

55
00:02:30,583 --> 00:02:32,418
Echo Show next week.

56
00:02:32,418 --> 00:02:34,454
We're actually working on
getting kind of all of that

57
00:02:34,454 --> 00:02:36,856
done together in
one thing, however,

58
00:02:36,856 --> 00:02:40,994
the research that we did
unfortunately was kind of halted

59
00:02:40,994 --> 00:02:42,962
because we found some
pretty big security issues,

60
00:02:42,962 --> 00:02:45,030
which we're gonna talk
about here in a bit.

61
00:02:45,031 --> 00:02:47,767
So, this is still
ongoing, this is still,

62
00:02:47,767 --> 00:02:49,502
you know, this is just kind
of scraping the surface

63
00:02:49,502 --> 00:02:51,070
with the stuff that we found.

64
00:02:51,070 --> 00:02:54,707
So kind of how we got here,
last year, if you remember,

65
00:02:54,707 --> 00:02:57,410
we had a kind of a
competition for who could

66
00:02:57,410 --> 00:02:58,978
get the most tweets.

67
00:02:58,978 --> 00:03:00,813
Adrian brought up that he
wanted to actually get one

68
00:03:00,813 --> 00:03:02,881
of the Echos that was
given away so he could

69
00:03:02,882 --> 00:03:04,217
do Chip-Off on it.

70
00:03:04,217 --> 00:03:06,452
So that kind of spurred
some initial thoughts

71
00:03:06,452 --> 00:03:09,689
and how I actually ended up
with the smart phone stuff

72
00:03:09,689 --> 00:03:14,126
is I have a light that
is right by our couch

73
00:03:14,127 --> 00:03:16,863
on a split level house
and for the longest time

74
00:03:16,863 --> 00:03:19,399
I had to stand up on the
couch to turn off the light.

75
00:03:19,399 --> 00:03:21,868
Well, I didn't want to be the
guy who was drunk one night

76
00:03:21,868 --> 00:03:23,570
turning off the light
and fell over the steps.

77
00:03:23,570 --> 00:03:25,338
So I was like, you know,
I'm just gonna get an Alexa

78
00:03:25,338 --> 00:03:27,840
and just tell her to do that
so that way I don't have to

79
00:03:27,840 --> 00:03:29,642
worry about falling over
the balcony one night

80
00:03:29,642 --> 00:03:31,109
when I've been drinking.

81
00:03:31,110 --> 00:03:32,645
And then that kind of
spurred everything on.

82
00:03:32,645 --> 00:03:34,814
It's like, you know, I wonder
how much data is actually here

83
00:03:34,814 --> 00:03:36,416
and how much it's storing
and everything like that.

84
00:03:36,416 --> 00:03:38,718
So that's kind of the
backstory of how we got here

85
00:03:38,718 --> 00:03:41,654
full-circle a year later
with generating all this data

86
00:03:41,654 --> 00:03:44,357
and going through
all of our stuff.

87
00:03:44,357 --> 00:03:46,926
- So we're gonna start
with what we're gonna do

88
00:03:46,926 --> 00:03:49,661
as far as the Amazon Echo
devices and what I like to call

89
00:03:49,662 --> 00:03:50,997
the Echo system.

90
00:03:52,065 --> 00:03:53,433
- [Brian] Patent
pending, patent pending.

91
00:03:53,433 --> 00:03:55,468
- When we had the
opportunity to talk to Amazon

92
00:03:55,468 --> 00:03:57,936
they didn't actually really
care that much for the name.

93
00:03:57,937 --> 00:03:59,739
I thought it was like
the only smart thing

94
00:03:59,739 --> 00:04:02,075
I've ever said in my life.

95
00:04:02,075 --> 00:04:04,476
So the, we're gonna talk
about the Echo family.

96
00:04:04,477 --> 00:04:06,112
So one of the first
things we're gonna cover,

97
00:04:06,112 --> 00:04:07,847
one of the many sources
of data that we're gonna

98
00:04:07,847 --> 00:04:10,350
talk about today is
the hardware itself.

99
00:04:10,350 --> 00:04:12,652
The Amazon Echo and the
Echo Dot are the two

100
00:04:12,652 --> 00:04:14,119
that we look at.

101
00:04:14,120 --> 00:04:16,422
The Amazon Echo is the big
one with the speaker included,

102
00:04:16,422 --> 00:04:20,193
the Dot, it relies on you
having a Bluetooth speaker.

103
00:04:20,192 --> 00:04:21,861
Then we're gonna talk a
little bit about the apps,

104
00:04:21,861 --> 00:04:23,563
which are the sources of data.

105
00:04:23,563 --> 00:04:25,397
The Alexa as well
as the kasa app,

106
00:04:25,398 --> 00:04:27,233
which is used for some
of the smart things.

107
00:04:27,233 --> 00:04:28,601
The Alexa app itself,

108
00:04:28,601 --> 00:04:30,737
there are skills that
you can run also,

109
00:04:30,737 --> 00:04:32,872
that's also part of
our future resource.

110
00:04:32,872 --> 00:04:35,174
We didn't get to test
enough skills because of the

111
00:04:35,174 --> 00:04:38,911
security implications we
ran into doing our testing.

112
00:04:38,911 --> 00:04:40,413
Then we're also gonna
talk about the network

113
00:04:40,413 --> 00:04:42,715
and the connected
devices themselves.

114
00:04:42,715 --> 00:04:45,784
So the TP-Link network is the
network that Brian is using

115
00:04:45,785 --> 00:04:47,687
and here you'll see
both the smart bulb

116
00:04:47,687 --> 00:04:50,323
as well as a smart outlet.

117
00:04:50,323 --> 00:04:53,626
So, the question I had was I
was doing the hardware side

118
00:04:53,626 --> 00:04:56,561
and was how the heck am I
gonna get that off this device?

119
00:04:56,562 --> 00:04:58,064
And when you're looking
at hardware you're gonna

120
00:04:58,064 --> 00:04:59,532
look for a couple of things.

121
00:04:59,532 --> 00:05:00,500
You're gonna look for
ports, data entry points.

122
00:05:00,500 --> 00:05:02,068
And you're gonna go,

123
00:05:02,068 --> 00:05:04,370
am I gonna go destructive
or non-destructive?

124
00:05:04,370 --> 00:05:06,172
The goal is to get a
non-destructive method

125
00:05:06,172 --> 00:05:09,942
so that you can do it repeatably
so that law enforcement

126
00:05:09,942 --> 00:05:12,712
can use it if they have to
turn back over the device

127
00:05:12,712 --> 00:05:15,647
and it just saves you a
lot of money in the end.

128
00:05:15,648 --> 00:05:17,383
But sometimes to
get non-destructive,

129
00:05:17,383 --> 00:05:19,284
we have to get
destructive first.

130
00:05:19,285 --> 00:05:22,889
So, as far as ports, there
is a USB on these devices.

131
00:05:22,889 --> 00:05:23,823
Is it rootable?

132
00:05:23,823 --> 00:05:25,024
Most likely.

133
00:05:25,024 --> 00:05:26,259
When I did get
into the hardware,

134
00:05:26,259 --> 00:05:28,194
BusyBox and Super User
are already on there

135
00:05:28,194 --> 00:05:31,097
but that's not where I
was gonna start because

136
00:05:31,097 --> 00:05:32,864
I didn't know what,

137
00:05:32,865 --> 00:05:34,033
I didn't even know
that it was going to be

138
00:05:34,033 --> 00:05:36,069
Fire OS at that point.

139
00:05:36,069 --> 00:05:39,639
So, I looked for JTAG ports,
there's none on the boards

140
00:05:39,639 --> 00:05:42,108
for either of these,
no JTAG ports.

141
00:05:42,108 --> 00:05:44,610
Then, identify the chip, at
least on the regular Amazon

142
00:05:44,610 --> 00:05:47,880
it's ISP, a ball
because it's got eMMC,

143
00:05:47,880 --> 00:05:49,382
so that's the route
we're gonna go.

144
00:05:49,382 --> 00:05:51,384
It's the quickest route
for me with my background,

145
00:05:51,384 --> 00:05:53,386
take the chip off,
figure out the pinout,

146
00:05:53,386 --> 00:05:56,222
then I have a non-destructive
method for the future.

147
00:05:56,222 --> 00:05:58,291
So this is the original Echo.

148
00:05:58,291 --> 00:06:01,094
It's very well documented
as far as disassembly.

149
00:06:01,094 --> 00:06:02,594
It's actually great.

150
00:06:02,595 --> 00:06:05,298
This one actually came to
me from a police department

151
00:06:05,298 --> 00:06:07,734
in West Virginia, that they
actually wanted some analysis

152
00:06:07,734 --> 00:06:09,769
on this for a case.

153
00:06:09,769 --> 00:06:13,506
And what's great is I didn't,
I don't have a Chip-Off

154
00:06:13,506 --> 00:06:16,708
station at a home, I do have
a full soldering station,

155
00:06:16,709 --> 00:06:18,144
I do have a lot
of JTAG equipment,

156
00:06:18,144 --> 00:06:19,412
don't have a Chip-Off station.

157
00:06:19,412 --> 00:06:20,979
So I did go up to
Teel Tech Canada.

158
00:06:20,980 --> 00:06:23,249
Thank you guys for allowing
us and I used their

159
00:06:23,249 --> 00:06:25,651
Chip-Off station and since
they knew I was going up there

160
00:06:25,651 --> 00:06:27,387
to do it, they actually
procured their own Echo,

161
00:06:27,387 --> 00:06:30,456
put some test data on
it and took a chip off

162
00:06:30,456 --> 00:06:32,558
before I arrived.

163
00:06:32,558 --> 00:06:34,327
So the research on the
original Echo is pretty easy,

164
00:06:34,327 --> 00:06:35,294
pretty clean.

165
00:06:35,294 --> 00:06:36,763
You'll see the chips here.

166
00:06:36,763 --> 00:06:39,132
It's a well documented
chip, it's a SanDisk chip,

167
00:06:39,132 --> 00:06:43,703
four gigs of memory, easily
confined data sheets,

168
00:06:43,703 --> 00:06:45,570
and you can test
to find the pinout.

169
00:06:45,571 --> 00:06:48,975
When we're doing ISP
five pins, VCC, VCCq,

170
00:06:48,975 --> 00:06:50,543
CMD, CLK, and DAT0.

171
00:06:51,477 --> 00:06:53,613
So, here's your pinout.

172
00:06:53,613 --> 00:06:55,381
It might be hard to see in
the back but I don't think

173
00:06:55,381 --> 00:06:58,351
you're JTAGing in here or
ISPing in here so when you

174
00:06:58,351 --> 00:07:00,286
get home and want to
actually start reading off

175
00:07:00,286 --> 00:07:02,955
one of these devices
you'll be all set.

176
00:07:02,955 --> 00:07:04,390
It's pretty easy to wire up.

177
00:07:04,390 --> 00:07:06,192
I can use some nice
normal gauge wire

178
00:07:06,192 --> 00:07:07,794
because they're test points.

179
00:07:07,794 --> 00:07:10,496
I can read this with
73X Easy JTAG Box,

180
00:07:10,496 --> 00:07:11,998
which is pretty cheap.

181
00:07:11,998 --> 00:07:15,635
So, out with come with
a full four gig dump.

182
00:07:15,635 --> 00:07:17,570
Then I get to the Dot
and I'm like, yes,

183
00:07:17,570 --> 00:07:18,504
this is gonna be easy.

184
00:07:18,504 --> 00:07:19,739
I can't find any documentation

185
00:07:19,739 --> 00:07:21,907
about the actual
components online.

186
00:07:21,908 --> 00:07:23,443
Crap.

187
00:07:23,443 --> 00:07:27,113
So, I disassemble it and you
can see the two boards here.

188
00:07:28,614 --> 00:07:30,983
I knew that I had a
new one out of the box

189
00:07:30,983 --> 00:07:33,753
and I had two to work
with from Brian's house.

190
00:07:33,753 --> 00:07:35,988
One which was on
his test network,

191
00:07:35,988 --> 00:07:39,459
which does not have smooth
jazz, and his second one,

192
00:07:39,459 --> 00:07:41,227
which was actually in use
in his home for a year,

193
00:07:41,227 --> 00:07:43,496
so chock full of data.

194
00:07:43,496 --> 00:07:46,132
So we have a couple of
different components on here

195
00:07:46,132 --> 00:07:48,968
and the problem is on two
of the different Echos

196
00:07:48,968 --> 00:07:51,003
I looked at, so the one
from his test network

197
00:07:51,003 --> 00:07:52,472
and the one I had bought,

198
00:07:52,472 --> 00:07:53,940
which were both purchased
around the same time,

199
00:07:53,940 --> 00:07:56,943
different chips,
different markings,

200
00:07:56,943 --> 00:07:59,445
same BGA pattern because
it's the same exact board.

201
00:07:59,445 --> 00:08:01,347
The board markings were the same

202
00:08:01,347 --> 00:08:03,448
but no documentation on either.

203
00:08:03,449 --> 00:08:05,985
Now, I'm pretty good
at finding data sheets.

204
00:08:05,985 --> 00:08:09,288
I did it for a really long time
on boards of unknown origin.

205
00:08:09,288 --> 00:08:10,823
No dice here.

206
00:08:10,823 --> 00:08:13,292
The challenge was no data
sheets but I was starting

207
00:08:13,292 --> 00:08:15,393
with the assumption
that this was an eMMC

208
00:08:15,394 --> 00:08:17,730
because the other one was.

209
00:08:17,730 --> 00:08:19,665
So, I say I'm gonna
take a chip off.

210
00:08:19,665 --> 00:08:21,033
This is my favorite
picture in the world

211
00:08:21,033 --> 00:08:22,568
because that's actually
me chipping off.

212
00:08:22,568 --> 00:08:25,337
And if you notice the most
best piece of equipment there

213
00:08:25,338 --> 00:08:26,572
is a chopstick.

214
00:08:26,572 --> 00:08:27,907
It means that every time
I do a chip-off I have

215
00:08:27,907 --> 00:08:29,575
Chinese for lunch first.

216
00:08:29,575 --> 00:08:32,979
So, ha ha, so I took the
new one out of the box,

217
00:08:32,979 --> 00:08:35,515
it didn't have data, and went
ahead and took the chip off

218
00:08:35,515 --> 00:08:37,717
so that we could
determine the actual ISP

219
00:08:37,717 --> 00:08:39,150
so that we'd have a method

220
00:08:39,150 --> 00:08:41,587
for people to pull
data off later.

221
00:08:41,587 --> 00:08:44,423
So, again, this is an
IR chip-off machine,

222
00:08:44,423 --> 00:08:46,292
it was my first time using an
IR instead of heat top bottom.

223
00:08:46,292 --> 00:08:47,627
It was pretty dope.

224
00:08:47,627 --> 00:08:49,094
You have to wear
sunglasses when you do this

225
00:08:49,095 --> 00:08:52,098
so you don't get blinded
and it makes cool pictures.

226
00:08:52,098 --> 00:08:54,099
So I cleaned and read
the chip and then went on

227
00:08:54,100 --> 00:08:56,836
to determine the pinout which
was a little bit difficult

228
00:08:56,836 --> 00:08:58,838
because that section in blue,

229
00:08:58,838 --> 00:09:00,706
I'm gonna show
that to you closer,

230
00:09:00,706 --> 00:09:02,808
that's actually where I have
to go on the components.

231
00:09:02,808 --> 00:09:04,577
There are no test ports.

232
00:09:04,577 --> 00:09:06,078
Those TPs on the other board,

233
00:09:06,078 --> 00:09:08,381
which are nice and easy to
solder to, they don't exist.

234
00:09:08,381 --> 00:09:10,683
So I need to find all five pins.

235
00:09:10,683 --> 00:09:13,319
I go ahead and I do, here's
a close-up of the board.

236
00:09:13,319 --> 00:09:15,755
What might be a little
a difficult to see here

237
00:09:15,755 --> 00:09:17,957
is that every single one
of these places I have to

238
00:09:17,957 --> 00:09:21,060
solder to now are on the edges

239
00:09:21,060 --> 00:09:22,828
of onboard caps and resisters.

240
00:09:22,828 --> 00:09:25,363
Beige ones are caps,
black ones are resisters,

241
00:09:25,364 --> 00:09:29,368
had to find the right size
of them, shoot the pin out,

242
00:09:29,368 --> 00:09:31,671
and then solder onto
them with 40,000ths wire.

243
00:09:31,671 --> 00:09:33,139
Which, what did that mean?

244
00:09:33,139 --> 00:09:34,607
It meant I bought myself a
brand new $500 soldering iron

245
00:09:34,607 --> 00:09:36,509
because I couldn't do
it with my other one,

246
00:09:36,509 --> 00:09:38,811
which was cool, and yeah.

247
00:09:38,811 --> 00:09:39,979
It's a really good
soldering iron.

248
00:09:39,979 --> 00:09:41,247
It gets hot like that (snap).

249
00:09:41,247 --> 00:09:42,814
And then it cools
off immediately.

250
00:09:42,815 --> 00:09:44,817
Alright, so I image
it with RIFF2.

251
00:09:44,817 --> 00:09:46,819
RIFF2 has no trouble
imaging this.

252
00:09:46,819 --> 00:09:48,420
We now have a
non-destructive method,

253
00:09:48,421 --> 00:09:52,592
I can go ahead and start
ripping data off of Brian's.

254
00:09:52,592 --> 00:09:55,127
So I do, I get a dump.

255
00:09:55,127 --> 00:09:57,630
Anyone know what
operating system that is?

256
00:09:57,630 --> 00:09:58,664
Come on, it's Amazon.

257
00:09:58,664 --> 00:10:00,165
Fire OS.

258
00:10:00,166 --> 00:10:03,536
Alright, so, what data did
we find on the hardware

259
00:10:03,536 --> 00:10:05,738
that we can't find
anywhere else?

260
00:10:05,738 --> 00:10:10,242
We actually can get the WiFi
connection, Mac connections,

261
00:10:10,242 --> 00:10:13,012
registration information, but
most of what I find on there

262
00:10:13,012 --> 00:10:15,180
is actually future
use for Amazon.

263
00:10:15,181 --> 00:10:19,018
I can hear Alexa talking in
all her different voices,

264
00:10:19,018 --> 00:10:21,354
in different languages, etc.

265
00:10:22,221 --> 00:10:24,657
So then we go onto the apps.

266
00:10:24,657 --> 00:10:27,193
And what are it's, Alexa.

267
00:10:27,193 --> 00:10:31,364
Alexa is the app or the
virtual assistant for Amazon.

268
00:10:31,364 --> 00:10:33,899
And a common woman's name.

269
00:10:33,899 --> 00:10:36,669
So Amazon is what you
say when you, I mean,

270
00:10:36,669 --> 00:10:38,137
Alexa is what you say
when you're talking

271
00:10:38,137 --> 00:10:39,604
to your Amazon Echo.

272
00:10:39,605 --> 00:10:42,041
And you can do lots of
things with the Echo device.

273
00:10:42,041 --> 00:10:45,444
Everything from ordering
things from Amazon

274
00:10:45,444 --> 00:10:47,947
to asking questions
to newer features

275
00:10:47,947 --> 00:10:50,182
which we will talk about soon.

276
00:10:50,182 --> 00:10:54,320
So, you can also view the other
devices you have on there.

277
00:10:54,320 --> 00:10:56,722
You can control what's
playing on a device

278
00:10:56,722 --> 00:11:00,826
and in May 2017, while we were
doing all of our research,

279
00:11:02,261 --> 00:11:06,265
they released the message
and calling and other things

280
00:11:06,265 --> 00:11:09,901
for Amazon, which has
a lot of user issues

281
00:11:09,902 --> 00:11:11,737
for the Amazon
Echo device owners,

282
00:11:11,737 --> 00:11:13,572
which Brian's gonna talk about.

283
00:11:13,572 --> 00:11:16,575
Now, it completely
changed our research.

284
00:11:16,575 --> 00:11:20,646
I actually had to go back
and go ahead and re-take data

285
00:11:20,646 --> 00:11:24,949
off of Brian's test unit
and so I carved for some

286
00:11:24,950 --> 00:11:28,487
audio files on there and
bing, I get everything he had

287
00:11:28,487 --> 00:11:32,525
recorded for a text message
within the last 24 hours.

288
00:11:32,525 --> 00:11:33,459
That's freaking awesome!

289
00:11:33,459 --> 00:11:36,295
In his voice, so not just text.

290
00:11:36,295 --> 00:11:38,229
So I'll hand this off to Brian
to talk a little bit more

291
00:11:38,230 --> 00:11:39,699
about that side.

292
00:11:39,699 --> 00:11:41,901
- So now we're gonna focus,
step away from the hardware side

293
00:11:41,901 --> 00:11:44,236
and kind of look at the
application side, specifically,

294
00:11:44,236 --> 00:11:46,739
of the actual
applications themselves.

295
00:11:46,739 --> 00:11:49,241
So as Jessica said, this
calling and messaging stuff

296
00:11:49,241 --> 00:11:52,211
completely changed all of our
research, literally overnight.

297
00:11:52,211 --> 00:11:54,580
Like it was really, really
awesome because we were

298
00:11:54,580 --> 00:11:56,615
making good progress, like
everything is going well,

299
00:11:56,615 --> 00:11:58,884
this is fantastic, and
then they released this

300
00:11:58,884 --> 00:12:01,887
and then it just, we literally
had to stop everything

301
00:12:01,887 --> 00:12:05,090
we were doing, we had issues.

302
00:12:05,091 --> 00:12:07,827
Like, why couldn't you have
just done this after the summit

303
00:12:07,827 --> 00:12:10,096
so we could have just done our
work and then not had to like

304
00:12:10,096 --> 00:12:12,598
just try to throw everything
together as much as we could

305
00:12:12,598 --> 00:12:14,300
to try to get as much
information as we can,

306
00:12:14,300 --> 00:12:17,236
which is actually why we
have 100 slides that we're

307
00:12:17,236 --> 00:12:20,506
talking about today and
we probably have another

308
00:12:20,506 --> 00:12:23,742
four or five hours, at least,
of content to talk about stuff

309
00:12:23,743 --> 00:12:26,045
that we can't talk
about here, obviously.

310
00:12:26,045 --> 00:12:28,646
Because there is just so
much information that they

311
00:12:28,647 --> 00:12:30,483
just continue to store.

312
00:12:30,483 --> 00:12:32,752
So one of the things that
we noticed right off the bat

313
00:12:32,752 --> 00:12:35,154
is on the actual mobile
application itself,

314
00:12:35,154 --> 00:12:38,090
there's very, very little
data that actually stores

315
00:12:38,090 --> 00:12:39,925
on the device itself.

316
00:12:39,925 --> 00:12:41,560
Almost everything
is actually pulled

317
00:12:41,560 --> 00:12:45,164
from the AWS Cloud servers
and then onto the device.

318
00:12:45,164 --> 00:12:47,399
So if you have the Alexa
app open on your phone

319
00:12:47,399 --> 00:12:48,901
and you put it in airplane mode,

320
00:12:48,901 --> 00:12:50,435
you can't see anything anymore.

321
00:12:50,436 --> 00:12:52,371
It actually requires an
active internet connection

322
00:12:52,371 --> 00:12:55,207
to pull that down which is
why it's almost impossible

323
00:12:55,207 --> 00:12:59,545
to find good information on
the mobile device itself.

324
00:12:59,545 --> 00:13:00,813
So there are, however,

325
00:13:00,813 --> 00:13:03,749
some artifacts that
are obviously stored.

326
00:13:03,749 --> 00:13:06,886
One is comms.db which
is actually a database,

327
00:13:06,886 --> 00:13:08,954
we know that, it's
a SQLite database.

328
00:13:08,954 --> 00:13:10,689
That data in the
database looks like it is

329
00:13:10,689 --> 00:13:13,192
ridiculously encrypted
with some kind of mechanism

330
00:13:13,192 --> 00:13:15,895
that I have never seen and those
of you who know my history,

331
00:13:15,895 --> 00:13:17,730
if I have a problem
with encryption, like,

332
00:13:17,730 --> 00:13:20,499
you know it's actually probably
implemented pretty well.

333
00:13:20,499 --> 00:13:23,302
So Amazon had the
foresight to say, hey,

334
00:13:23,302 --> 00:13:26,038
if we're gonna store some kind
of actual application stuff

335
00:13:26,038 --> 00:13:28,040
with messaging on our
devices, we're gonna make sure

336
00:13:28,040 --> 00:13:30,642
that's encrypted and really,
really hard to pull off.

337
00:13:30,643 --> 00:13:32,144
Which is fantastic, however,

338
00:13:32,144 --> 00:13:33,746
as we're gonna show you in
a bit, like you can actually

339
00:13:33,746 --> 00:13:36,148
make a query to pull that
information back down.

340
00:13:36,148 --> 00:13:38,517
It's just if you're looking at
just the mobile device itself

341
00:13:38,517 --> 00:13:39,852
you're not gonna
get the full picture

342
00:13:39,852 --> 00:13:42,021
of what we're
specifically looking for.

343
00:13:42,021 --> 00:13:44,022
One of the other spots
that we saw that there was

344
00:13:44,023 --> 00:13:46,692
really, really good information
was the map_data_storage.

345
00:13:46,692 --> 00:13:49,962
So in previous versions
of the Alexa application,

346
00:13:49,962 --> 00:13:52,598
which is again why we're
just stressing so much

347
00:13:52,598 --> 00:13:54,199
about all the new
features and everything,

348
00:13:54,200 --> 00:13:56,502
is we try to stay up to
date as much as possible

349
00:13:56,502 --> 00:13:58,469
with the actual information
that we're presenting.

350
00:13:58,470 --> 00:14:00,272
Like, we don't want to present
on stuff from a year ago

351
00:14:00,272 --> 00:14:02,741
and just get up here and
say that, oh, well the Alexa

352
00:14:02,741 --> 00:14:05,544
you can do X, Y, and Z and then
somebody goes and does that

353
00:14:05,544 --> 00:14:07,513
in theory and turns out
that is not the case at all.

354
00:14:07,513 --> 00:14:09,815
Like, we want to try to
give as actual a pertinent

355
00:14:09,815 --> 00:14:11,283
information as we can.

356
00:14:11,283 --> 00:14:13,752
So in previous versions,
which was obviously probably

357
00:14:13,752 --> 00:14:17,790
just map_data_storage without
B2, you could do things

358
00:14:17,790 --> 00:14:20,192
like pull some of the cookies
down and actually use that

359
00:14:20,192 --> 00:14:22,261
to authenticate and pull
this information back.

360
00:14:22,261 --> 00:14:25,064
Amazon completely recognized
that was a flaw by themselves

361
00:14:25,064 --> 00:14:26,598
and changed all of that.

362
00:14:26,599 --> 00:14:29,702
So if you see other talks or
anything like that on Alexa

363
00:14:29,702 --> 00:14:31,670
just make sure that the
information is actually

364
00:14:31,670 --> 00:14:33,705
the most current information
that's actually talking about

365
00:14:33,706 --> 00:14:36,275
the newest releases of the
applications themselves.

366
00:14:36,275 --> 00:14:38,177
However, there is one
very, very important thing

367
00:14:38,177 --> 00:14:40,145
that we can actually
get from this database

368
00:14:40,145 --> 00:14:42,214
is the Amazon account ID strain.

369
00:14:42,214 --> 00:14:45,818
This is going to be our
essentially golden ticket

370
00:14:45,818 --> 00:14:48,087
to allow us to pull as
much information as can

371
00:14:48,087 --> 00:14:50,055
from these URLs to
actually get information

372
00:14:50,055 --> 00:14:53,025
from the Amazon Cloud
about our actual

373
00:14:53,025 --> 00:14:55,261
Alexa application itself.

374
00:14:55,261 --> 00:14:57,795
Again, this is our string, this
is actually a unique string

375
00:14:57,796 --> 00:14:59,231
for every single user.

376
00:14:59,231 --> 00:15:01,200
Every single Alexa user's
gonna have a uniquely generated

377
00:15:01,200 --> 00:15:03,869
string and we're gonna use
this, append to our URLs

378
00:15:03,869 --> 00:15:05,204
and do a whole bunch
of queries to get

379
00:15:05,204 --> 00:15:07,539
as much information as possible.

380
00:15:07,539 --> 00:15:10,074
So in order to do this, we're
working on trying to create

381
00:15:10,075 --> 00:15:11,610
a way to automate this.

382
00:15:11,610 --> 00:15:13,679
Like I said, we're
working towards that.

383
00:15:13,679 --> 00:15:15,581
We don't have a way to do
it yet so the easiest way

384
00:15:15,581 --> 00:15:18,150
is you have to actually log
in to the Alexa application

385
00:15:18,150 --> 00:15:19,651
from a web browser.

386
00:15:19,652 --> 00:15:21,320
This is gonna allow a
local cookie to be stored

387
00:15:21,320 --> 00:15:23,489
which is gonna allow
these queries to happen.

388
00:15:23,489 --> 00:15:25,157
Again, we're working on
a way to automate this

389
00:15:25,157 --> 00:15:27,359
but for now this is the only
way that we've been able

390
00:15:27,359 --> 00:15:30,362
to find that actually doesn't
violate the Amazon TOS

391
00:15:30,362 --> 00:15:31,697
because we've been
working pretty close

392
00:15:31,697 --> 00:15:33,132
with the Amazon security team.

393
00:15:33,132 --> 00:15:34,565
Like the last thing we
want to do is piss them off

394
00:15:34,566 --> 00:15:36,635
and do something that would
essentially just cease

395
00:15:36,635 --> 00:15:38,737
communication between us
because they've been fantastic

396
00:15:38,737 --> 00:15:40,606
throughout this entire process.

397
00:15:40,606 --> 00:15:42,474
Once of the things that you'll
notice when you browse there

398
00:15:42,474 --> 00:15:45,678
is there are more essentially
options that you can

399
00:15:45,678 --> 00:15:47,813
choose from from the web
browser but the one thing

400
00:15:47,813 --> 00:15:49,648
you can't do from the web
browser is you don't see

401
00:15:49,648 --> 00:15:51,517
any of the calling
and messaging stuff.

402
00:15:51,517 --> 00:15:53,218
And we're not exactly sure
yet if that's actually

403
00:15:53,218 --> 00:15:55,587
just a feature they have not
rolled to the mobile site

404
00:15:55,587 --> 00:15:57,423
or if they're just focusing
on calling and messaging

405
00:15:57,423 --> 00:15:59,892
only being tied
to mobile devices.

406
00:15:59,892 --> 00:16:01,593
And so far it seems like
that is actually probably

407
00:16:01,593 --> 00:16:04,396
the latter because you can
install the mobile application

408
00:16:04,396 --> 00:16:07,632
onto a tablet but you
can't make phone calls

409
00:16:07,633 --> 00:16:10,169
or send messages from a
tablet, you can only do it

410
00:16:10,169 --> 00:16:12,338
from an actual cell phone.

411
00:16:13,772 --> 00:16:16,408
So as we're pulling through
all of the data, you know,

412
00:16:16,408 --> 00:16:18,177
collecting network
traffic, doing all of that,

413
00:16:18,177 --> 00:16:20,145
one thing that we noticed a
lot is we noticed this one

414
00:16:20,145 --> 00:16:23,415
particular URL showed
up all the time.

415
00:16:23,415 --> 00:16:25,284
It's obviously pretty
straightforward what it is

416
00:16:25,284 --> 00:16:26,552
when you look at it.

417
00:16:26,552 --> 00:16:28,087
It's like, oh, it's some
kind of API call, like,

418
00:16:28,087 --> 00:16:30,155
I bet I can actually work
on getting information off

419
00:16:30,155 --> 00:16:32,223
because it has API in the URL.

420
00:16:32,224 --> 00:16:35,427
So in the event that
you actually have
one of these devices

421
00:16:35,427 --> 00:16:38,597
and you're doing an active
investigation on it, like,

422
00:16:38,597 --> 00:16:40,833
that's probably a pretty
good keyword to search for

423
00:16:40,833 --> 00:16:43,302
to try to figure out what
URLs potentially is gonna have

424
00:16:43,302 --> 00:16:45,637
information that you're
specifically looking for.

425
00:16:45,637 --> 00:16:47,606
One thing we will say is
because of the way that they

426
00:16:47,606 --> 00:16:50,242
changed it you will need the
actual account credentials

427
00:16:50,242 --> 00:16:54,179
from Amazon so you can't
just willy nilly login

428
00:16:54,179 --> 00:16:55,613
and grab anybody's stuff.

429
00:16:55,614 --> 00:16:56,915
You actually need the
account credentials to pull

430
00:16:56,915 --> 00:16:58,317
all this information back.

431
00:16:58,317 --> 00:16:59,985
So, again, for the
law enforcement side,

432
00:16:59,985 --> 00:17:01,720
make sure you have that
before you start doing

433
00:17:01,720 --> 00:17:04,757
all the stuff we're about
to show you what to do.

434
00:17:04,757 --> 00:17:08,861
So obviously we have our
unique identifier string.

435
00:17:08,861 --> 00:17:11,663
So if we just start adding
some of this stuff to the URLs

436
00:17:11,663 --> 00:17:14,165
that we see, we can actually
essentially start to build out

437
00:17:14,165 --> 00:17:17,836
our URLs and now we can
actually go ahead and pull

438
00:17:17,836 --> 00:17:19,738
the information
back from Amazon.

439
00:17:19,738 --> 00:17:21,407
So if we just type
that into the browser

440
00:17:21,406 --> 00:17:25,077
after we've logged in, we get
nicely formatted JSON data,

441
00:17:25,077 --> 00:17:27,713
which is very, very easy to
parse, and we can actually

442
00:17:27,713 --> 00:17:30,816
start to see this stuff that
Amazon is already parsing

443
00:17:30,816 --> 00:17:33,052
in the application itself but
now we can pull all this data

444
00:17:33,052 --> 00:17:34,953
back from the cloud and
we have the information

445
00:17:34,953 --> 00:17:36,822
what we're specifically
looking for.

446
00:17:36,822 --> 00:17:39,058
So this is just an example,
again, of the information

447
00:17:39,058 --> 00:17:42,361
you can do as we work through
the URLs that we're querying.

448
00:17:42,361 --> 00:17:44,830
So in order to actually view
the conversations which, again,

449
00:17:44,830 --> 00:17:46,799
you put it in airplane
mode, you're not,

450
00:17:46,799 --> 00:17:49,134
none of this information is
stored on the device itself

451
00:17:49,134 --> 00:17:50,936
that we've found so far.

452
00:17:50,936 --> 00:17:52,538
So in order to pull the
conversations, again,

453
00:17:52,538 --> 00:17:55,140
we just add a little
bit, we add our URL,

454
00:17:55,140 --> 00:17:56,475
we add our string
to the end of it,

455
00:17:56,475 --> 00:17:58,110
and then we can pull
our conversations.

456
00:17:58,110 --> 00:17:59,878
And we can actually see
that we get our actual

457
00:17:59,878 --> 00:18:02,814
conversations back for
all of the messaging stuff

458
00:18:02,815 --> 00:18:07,586
from the Alexa calling and
messaging feature of the device.

459
00:18:07,586 --> 00:18:09,321
So the other part that we
can do is we can actually

460
00:18:09,321 --> 00:18:13,324
take the conversation ID,
excuse me, and actually sort

461
00:18:13,325 --> 00:18:14,793
essentially by contact.

462
00:18:14,793 --> 00:18:17,228
So this is kind of going
through and saying if I have

463
00:18:17,229 --> 00:18:20,432
a bunch of contacts
with Sarah, for example,

464
00:18:20,432 --> 00:18:23,368
this is all of the
conversations that Sarah will,

465
00:18:23,368 --> 00:18:25,937
that I'll be able to see
that I've had with Sarah.

466
00:18:25,938 --> 00:18:28,307
So, again, we have to
add the specific URLs

467
00:18:28,307 --> 00:18:29,775
to make this happen.

468
00:18:29,775 --> 00:18:32,277
We appended a messages?count=100
and sort it so we can

469
00:18:32,277 --> 00:18:34,213
actually see the
most recent ones.

470
00:18:34,213 --> 00:18:36,548
So in order to actually see
these messages like that,

471
00:18:36,548 --> 00:18:38,317
we do our URL and
there is then actually

472
00:18:38,317 --> 00:18:42,521
nicely formatted JSON, again,
of the actual conversation

473
00:18:42,521 --> 00:18:43,889
that we can go through

474
00:18:43,889 --> 00:18:46,291
and pull off the
individual conversations.

475
00:18:46,291 --> 00:18:48,760
So one thing to note for
now is as of right now

476
00:18:48,760 --> 00:18:51,797
we're only allowed to pull
the last 100 messages.

477
00:18:51,797 --> 00:18:54,600
Amazon probably stores all
the messages at some point.

478
00:18:54,600 --> 00:18:56,135
We haven't been able to
confirm that with them.

479
00:18:56,135 --> 00:18:59,204
I would say they probably do,
however, from the actual API,

480
00:18:59,204 --> 00:19:01,106
which again, we're just
doing the API queries,

481
00:19:01,106 --> 00:19:03,342
we're not trying to do
anything that would, again,

482
00:19:03,342 --> 00:19:05,110
make Amazon unhappy.

483
00:19:05,110 --> 00:19:07,312
So we pull the 100 off.

484
00:19:07,312 --> 00:19:09,247
Again, you have to have login,

485
00:19:09,248 --> 00:19:11,316
you have to have the
credentials to actually login

486
00:19:11,316 --> 00:19:12,818
and get this application.

487
00:19:12,818 --> 00:19:14,920
The one thing that we'll
say which is just kind of

488
00:19:14,920 --> 00:19:18,056
a common theme is when
security issues are found,

489
00:19:18,056 --> 00:19:19,558
when issues of any
kind are found, like,

490
00:19:19,558 --> 00:19:21,727
all of this is subject to
change because Amazon could say

491
00:19:21,727 --> 00:19:25,564
you know what, we have to stop
doing this and all of this

492
00:19:25,564 --> 00:19:28,333
way to pull this information
back could completely change.

493
00:19:28,333 --> 00:19:31,570
However, it probably won't
because we're using the API,

494
00:19:31,570 --> 00:19:33,772
which is how they actually
generate their data.

495
00:19:33,772 --> 00:19:36,575
So even if it does change it
might just be like a change

496
00:19:36,575 --> 00:19:39,144
with the URL or something
like that but this probable

497
00:19:39,144 --> 00:19:41,079
methodology of pulling
this information back

498
00:19:41,079 --> 00:19:43,649
probably will still
work no matter what.

499
00:19:43,649 --> 00:19:44,815
So we can see all of the devices

500
00:19:44,816 --> 00:19:46,318
that are synced to the account.

501
00:19:46,318 --> 00:19:49,288
Again, we just browse to
the API, we have a device,

502
00:19:49,288 --> 00:19:51,590
and this is all of
our Alexa devices.

503
00:19:51,590 --> 00:19:53,024
Again, everything is JSON.

504
00:19:53,025 --> 00:19:54,493
It's kind of a common theme.

505
00:19:54,493 --> 00:19:56,061
All of the information that
comes back from the Amazon stuff

506
00:19:56,061 --> 00:20:00,365
is all gonna be in a nice,
nicely formatted JSON format.

507
00:20:00,365 --> 00:20:02,568
Of course, you know, there
we have our customer ID,

508
00:20:02,568 --> 00:20:04,403
we have all kinds of
interesting stuff.

509
00:20:04,403 --> 00:20:07,573
We can see the SSID from
the wireless network.

510
00:20:07,573 --> 00:20:10,576
All this information we can
pull back from the Amazon cloud

511
00:20:10,576 --> 00:20:11,843
about our stuff.

512
00:20:11,843 --> 00:20:13,545
So we have our model, we
have our serial number,

513
00:20:13,545 --> 00:20:15,147
we have a customer ID, we
have all this information

514
00:20:15,147 --> 00:20:18,050
so let's say, again, law
enforcement on an active case,

515
00:20:18,050 --> 00:20:21,253
you can actually say that this
particular Amazon Echo device

516
00:20:21,253 --> 00:20:24,255
was associated with this account
just from this information.

517
00:20:24,256 --> 00:20:27,092
So just like the old days
of tracking somebody's phone

518
00:20:27,092 --> 00:20:28,827
with like an IMEI or
anything like that,

519
00:20:28,827 --> 00:20:31,096
you want to make sure that
the devices that you see

520
00:20:31,096 --> 00:20:32,998
are actually associated
with that person,

521
00:20:32,998 --> 00:20:34,866
that they didn't run out to
Target and buy a whole bunch

522
00:20:34,866 --> 00:20:36,368
of Echos and just threw them
in the house and be like,

523
00:20:36,368 --> 00:20:37,602
hey, come on and
grab all my stuff

524
00:20:37,603 --> 00:20:40,172
and there's nothing
actually there.

525
00:20:40,172 --> 00:20:42,474
So the cards feature
is kind of interesting.

526
00:20:42,474 --> 00:20:45,377
You can only see the cards
on the website for right now

527
00:20:45,377 --> 00:20:48,312
and I'm not exactly sure why
that is but when you view it

528
00:20:48,313 --> 00:20:52,451
on the website the cards are
incredibly nicely formatted.

529
00:20:52,451 --> 00:20:56,755
JSON is obviously a whole bunch
of information that is not

530
00:20:56,755 --> 00:20:58,457
nearly as pretty as you're
looking at from the website.

531
00:20:58,457 --> 00:21:00,525
But again, you can parse
all this information out

532
00:21:00,525 --> 00:21:02,394
and you can actually
rebuild the actual card

533
00:21:02,394 --> 00:21:04,863
that you can see of the
information that Alexa

534
00:21:04,863 --> 00:21:06,632
is actually storing.

535
00:21:06,632 --> 00:21:10,435
The WiFi configs is a feature
that we've gone back and forth

536
00:21:10,435 --> 00:21:12,337
with Amazon a little bit on.

537
00:21:12,337 --> 00:21:16,775
So, this is where I guess
the I am fine dog started

538
00:21:16,775 --> 00:21:18,343
to kind of rear its
head a little bit.

539
00:21:18,343 --> 00:21:19,845
He didn't appear all the way.

540
00:21:19,845 --> 00:21:21,780
Like the fire didn't get up
all the way but this is where

541
00:21:21,780 --> 00:21:25,183
it kind of like, well, what
exactly are we getting into now?

542
00:21:25,183 --> 00:21:27,719
So this is a fantastic
feature because essentially

543
00:21:27,719 --> 00:21:30,122
you're able to save
your WiFi credentials

544
00:21:30,122 --> 00:21:32,157
to your Amazon accounts
so that way when you buy

545
00:21:32,157 --> 00:21:34,793
future Amazon devices they
can all automatically connect

546
00:21:34,793 --> 00:21:36,027
to your wireless network.

547
00:21:36,028 --> 00:21:38,397
That is fantastic from
a user perspective

548
00:21:38,397 --> 00:21:40,999
because essentially you get
a new device, you plug it in,

549
00:21:40,999 --> 00:21:42,934
everything's ready to
go, you're all set.

550
00:21:42,934 --> 00:21:46,538
However there is an issue
because as we've all worked

551
00:21:46,538 --> 00:21:48,240
in the field for a
considerable length of time,

552
00:21:48,240 --> 00:21:51,376
anytime that you see
plain text password

553
00:21:51,376 --> 00:21:54,413
something is just bad, like,
it just rubs you the wrong way.

554
00:21:54,413 --> 00:21:56,682
So this is no longer, actually,

555
00:21:56,682 --> 00:21:58,750
PeacockNet is completely down.

556
00:21:58,750 --> 00:22:01,019
The password is no longer
valid so if you see PeacockNet

557
00:22:01,019 --> 00:22:02,888
you can try to log into
this password but it's,

558
00:22:02,888 --> 00:22:06,024
it's not my network anymore,
so I have no idea what it is.

559
00:22:06,024 --> 00:22:09,093
You can literally actually
make the proper query

560
00:22:09,094 --> 00:22:11,963
from Amazon and you can
actually pull back SSID

561
00:22:11,963 --> 00:22:14,166
and password information
in plain text.

562
00:22:14,166 --> 00:22:16,568
And if you want to use
that power for good,

563
00:22:16,568 --> 00:22:18,470
or for evil, I
wouldn't recommend it.

564
00:22:18,470 --> 00:22:20,906
Try to use your powers
for mostly good.

565
00:22:20,906 --> 00:22:22,941
But again, it's an issue that
we brought up with Amazon

566
00:22:22,941 --> 00:22:26,378
and they, oddly enough,
were okay with this because

567
00:22:26,378 --> 00:22:28,513
it was working with the
way that they wanted to.

568
00:22:28,513 --> 00:22:31,983
So again, you know, we're
just two little minions

569
00:22:31,983 --> 00:22:34,453
from the future who came back
and trying to save everybody

570
00:22:34,453 --> 00:22:36,788
from the eventual Skynet stuff.

571
00:22:36,788 --> 00:22:39,524
And if Amazon's okay with it,
like, all hail overlord Jeff,

572
00:22:39,524 --> 00:22:42,627
and whatever they
want, we're good to go.

573
00:22:42,627 --> 00:22:45,664
So we can actually see
other devices in the home.

574
00:22:45,664 --> 00:22:48,300
So obviously one of the main
things that we have for Alexa

575
00:22:48,300 --> 00:22:49,634
is smart home devices.

576
00:22:49,634 --> 00:22:52,537
So you want to
control your lights,

577
00:22:52,537 --> 00:22:56,274
you want to control your TV,
you want to have smart locks,

578
00:22:56,274 --> 00:22:58,976
you want to have whatever
smart stuff you want.

579
00:22:58,977 --> 00:23:01,480
One of the main reasons for
Alexa is to actually connect

580
00:23:01,480 --> 00:23:03,648
these IoT devices to it.

581
00:23:03,648 --> 00:23:06,385
So you can actually use the
URL and you can pull back

582
00:23:06,385 --> 00:23:09,287
all the informa-, all the
devices that are actually synced

583
00:23:09,287 --> 00:23:11,390
essentially with
that Amazon account.

584
00:23:11,390 --> 00:23:14,092
So all the devices
that the Echo can see,

585
00:23:14,092 --> 00:23:15,894
all of it is synced to Alexa,

586
00:23:15,894 --> 00:23:17,796
you can pull all that
information back so you can see

587
00:23:17,796 --> 00:23:19,331
all the smart home devices.

588
00:23:19,331 --> 00:23:23,834
In my house, I want to say
I have maybe like 23 or so,

589
00:23:23,835 --> 00:23:27,339
mostly light bulbs,
some outlets, a couple
of switches now,

590
00:23:27,339 --> 00:23:29,307
and some newer stuff
that is actually

591
00:23:29,307 --> 00:23:31,943
not in this presentation.

592
00:23:31,943 --> 00:23:33,979
But all of this information
you can pull back.

593
00:23:33,979 --> 00:23:36,114
So, again, if you're working
an active case, like,

594
00:23:36,114 --> 00:23:38,683
it's so weird but like, you
know, sometimes you might,

595
00:23:38,683 --> 00:23:40,952
if you say you need all the
internet-connected devices

596
00:23:40,952 --> 00:23:42,421
in the house, you're
gonna have to get up there

597
00:23:42,421 --> 00:23:44,389
and unscrew light bulbs
and pull them out too.

598
00:23:44,389 --> 00:23:48,493
Like, it's, that's
unfortunately where we are now.

599
00:23:48,493 --> 00:23:51,830
So the other thing
is the activities.

600
00:23:51,830 --> 00:23:54,265
So, regardless of the device,
where it originated from,

601
00:23:54,266 --> 00:23:56,868
you can see the actual last
activities that occurred.

602
00:23:56,868 --> 00:24:00,405
So Amazon currently
limits it to 50.

603
00:24:00,405 --> 00:24:02,841
With our URL query we actually
set it to 100 just in case

604
00:24:02,841 --> 00:24:04,543
they decide to do that.

605
00:24:04,543 --> 00:24:07,312
But the one thing of note
here is you can tell Alexa

606
00:24:07,312 --> 00:24:09,880
to do something on your phone,
you can tell it do something

607
00:24:09,881 --> 00:24:12,617
on Fire TV remote, you can tell
it to do it on your tablet,

608
00:24:12,617 --> 00:24:14,853
you can tell it do it
on any actual device

609
00:24:14,853 --> 00:24:16,488
where Alexa is enabled.

610
00:24:16,488 --> 00:24:18,356
So regardless of where
it actually comes from,

611
00:24:18,356 --> 00:24:20,325
all of it's stored
under the activities.

612
00:24:20,325 --> 00:24:22,794
That's one caveat that I
want to say is just if you're

613
00:24:22,794 --> 00:24:24,429
pulling this information
and you see activities,

614
00:24:24,429 --> 00:24:26,698
it doesn't necessarily mean
that it was done on the phone

615
00:24:26,698 --> 00:24:28,166
or done on a tablet.

616
00:24:28,166 --> 00:24:31,002
It could be done on any
actual Alexa enabled device.

617
00:24:31,002 --> 00:24:35,005
And again, obviously, we
have JSON data that you can

618
00:24:35,006 --> 00:24:38,343
pull back and format and parse
and clean up and make pretty

619
00:24:38,343 --> 00:24:40,045
and all of that fun stuff.

620
00:24:40,045 --> 00:24:43,215
So there are other
URLs that we have found

621
00:24:43,215 --> 00:24:44,549
to pull information
and pull data.

622
00:24:44,549 --> 00:24:47,085
One that we specifically
did not talk about

623
00:24:47,085 --> 00:24:49,621
is the actual Alexa recordings.

624
00:24:49,621 --> 00:24:52,424
You can pull the Alexa
recordings from the cloud,

625
00:24:52,424 --> 00:24:55,594
however, depending on
the state that you're in,

626
00:24:55,594 --> 00:24:57,996
there may be some legal
ramifications to doing that

627
00:24:57,996 --> 00:25:01,333
because it may be actually
considered legally

628
00:25:01,333 --> 00:25:03,568
as private communication
which is not discoverable

629
00:25:03,568 --> 00:25:04,803
and all that stuff.

630
00:25:04,803 --> 00:25:07,339
So, we specifically
did not bring that up.

631
00:25:07,339 --> 00:25:10,041
It's easy enough to find if
you really want to find it but,

632
00:25:10,041 --> 00:25:13,311
again, we're trying to stay
on the side of mostly good

633
00:25:13,311 --> 00:25:15,447
and not mostly evil at all.

634
00:25:15,447 --> 00:25:19,016
Like, we're trying to stay on
that line and not vary over

635
00:25:19,017 --> 00:25:21,119
anymore than we have to.

636
00:25:21,119 --> 00:25:23,254
So, again, there are more URLs,

637
00:25:23,255 --> 00:25:24,789
there are more stuff
you can pull back,

638
00:25:24,789 --> 00:25:26,258
but this is just
kind of a methodology

639
00:25:26,258 --> 00:25:28,026
that we wanted to share
of how you're gonna

640
00:25:28,026 --> 00:25:30,262
need to pull this
information back in the event

641
00:25:30,262 --> 00:25:34,432
that you're looking at
these particular devices.

642
00:25:34,432 --> 00:25:35,901
And there we go.

643
00:25:35,901 --> 00:25:38,270
So, shifting a little
bit from the Amazon piece

644
00:25:38,270 --> 00:25:40,504
is the TP-Link side.

645
00:25:40,505 --> 00:25:42,641
So TP-Link is actually
the vendor that I use

646
00:25:42,641 --> 00:25:44,342
for all of my products
and the main reason why

647
00:25:44,342 --> 00:25:46,912
is that you don't need a
hub to run their products.

648
00:25:46,912 --> 00:25:49,481
Essentially, you plug them
in, you can control them

649
00:25:49,481 --> 00:25:51,750
from their application and
everything is good to go

650
00:25:51,750 --> 00:25:54,386
with the network so you're
just set and fantastic.

651
00:25:54,386 --> 00:25:55,987
That's the main reason
why I went with TP-Link

652
00:25:55,987 --> 00:25:57,656
so I didn't have to spend
more money to buy a hub

653
00:25:57,656 --> 00:25:59,323
and do everything like that.

654
00:25:59,324 --> 00:26:01,293
So this is just an example
of the kasa application.

655
00:26:01,293 --> 00:26:03,594
Obviously, you can
control the devices,

656
00:26:03,595 --> 00:26:05,764
everything is uniquely
named, you can set up scenes,

657
00:26:05,764 --> 00:26:07,399
you can do all of that stuff

658
00:26:07,399 --> 00:26:09,668
within the actual
application itself.

659
00:26:09,668 --> 00:26:12,203
TP-Link is very different
than Amazon and they store

660
00:26:12,203 --> 00:26:13,972
a bunch of information
locally on the phone.

661
00:26:13,972 --> 00:26:15,507
So, again, if you
have smart home,

662
00:26:15,507 --> 00:26:16,975
you can look for all of this.

663
00:26:16,975 --> 00:26:20,611
It's obviously a fairly
straightforward folder name.

664
00:26:20,612 --> 00:26:22,480
Obviously, database is just
somewhere that most of us

665
00:26:22,480 --> 00:26:24,115
as investigators are gonna look.

666
00:26:24,115 --> 00:26:27,285
And it's SQLite data,
which is a big surprise

667
00:26:27,285 --> 00:26:29,721
because most mobile
phones, we all know,

668
00:26:29,721 --> 00:26:32,057
never store anything
in SQLite databases.

669
00:26:32,057 --> 00:26:33,925
So it's a really big surprise
to actually find something

670
00:26:33,925 --> 00:26:35,793
called databases and
have a whole bunch

671
00:26:35,794 --> 00:26:37,829
of information in SQLite.

672
00:26:37,829 --> 00:26:40,398
So we browse the databases
folder and oddly enough,

673
00:26:40,398 --> 00:26:42,500
there is one database in
particular which should

674
00:26:42,500 --> 00:26:43,768
jump out to everybody.

675
00:26:43,768 --> 00:26:45,403
Like, I think if I'm
gonna look anywhere,

676
00:26:45,403 --> 00:26:48,173
I'm gonna look in something
called iot.1.db because I'm

677
00:26:48,173 --> 00:26:51,109
pretty sure I'm gonna get some
good information from there.

678
00:26:51,109 --> 00:26:53,745
So we pull it back, we
start to look through it,

679
00:26:53,745 --> 00:26:55,813
the actual format of it
is at least eight tables.

680
00:26:55,814 --> 00:26:58,316
And the reason that we say
at least eight is because,

681
00:26:58,316 --> 00:27:00,852
again, we're trying to account
for application updates

682
00:27:00,852 --> 00:27:02,053
and everything like that.

683
00:27:02,053 --> 00:27:03,688
As of right now,
it is eight tables.

684
00:27:03,688 --> 00:27:05,557
They're all fairly
straightforward names so you can

685
00:27:05,557 --> 00:27:07,392
actually go through and
figure what information

686
00:27:07,392 --> 00:27:08,827
you want to pull.

687
00:27:08,827 --> 00:27:12,297
So we can look for the accounts
and we can see some stuff.

688
00:27:12,297 --> 00:27:17,202
So this is where the I am fine
dog fire started to pop up,

689
00:27:17,202 --> 00:27:19,270
unfortunately, a
little more highly.

690
00:27:19,270 --> 00:27:23,541
So, we saw the plain
text wireless passwords.

691
00:27:23,541 --> 00:27:26,177
Now, unfortunately, hopefully
everybody doesn't use

692
00:27:26,177 --> 00:27:27,344
the same password
for everything,

693
00:27:27,345 --> 00:27:29,280
which we know never happens,

694
00:27:29,280 --> 00:27:33,318
but my actual password
is saved in plain text

695
00:27:33,318 --> 00:27:36,588
in the database for
this particular device.

696
00:27:36,588 --> 00:27:40,058
So now I can take
the Amazon data,

697
00:27:40,058 --> 00:27:41,960
I can take the TP-Link data,

698
00:27:41,960 --> 00:27:45,430
and if you reuse my passwords,
now I can get on your network

699
00:27:45,430 --> 00:27:48,233
and I can literally do
anything that I want to do.

700
00:27:48,233 --> 00:27:49,868
Not just control your stuff,

701
00:27:49,868 --> 00:27:51,336
anything that you want
to do on the network,

702
00:27:51,336 --> 00:27:53,938
you have all the information
for all of that now.

703
00:27:53,938 --> 00:27:58,109
So, again, this is no
longer my password.

704
00:27:58,109 --> 00:28:00,812
It was for the purpose
of this presentation.

705
00:28:00,812 --> 00:28:02,347
However, we'll get
into a little bit.

706
00:28:02,347 --> 00:28:05,050
Like, both Amazon and TP-Link
have been fantastic with this

707
00:28:05,050 --> 00:28:08,319
and as of yesterday, this
is no longer the case.

708
00:28:08,319 --> 00:28:10,622
So you may have older data
that is actually stored

709
00:28:10,622 --> 00:28:13,491
in this way but
as you're actually
updating the application

710
00:28:13,491 --> 00:28:16,094
itself, this no longer
happens anymore.

711
00:28:16,094 --> 00:28:19,631
So, again, I bet a table
called devices is probably

712
00:28:19,631 --> 00:28:21,299
gonna have a whole bunch
of device information

713
00:28:21,299 --> 00:28:22,567
and sure enough it does.

714
00:28:22,567 --> 00:28:24,035
It has the Mac address,
the day it was created,

715
00:28:24,035 --> 00:28:27,372
all this information on the
actual devices that the TP-Link

716
00:28:27,372 --> 00:28:29,641
application can actually access.

717
00:28:29,641 --> 00:28:31,276
Again, like I said,
I have a bunch.

718
00:28:31,276 --> 00:28:33,578
I have a bunch in my house,
primarily to generate

719
00:28:33,578 --> 00:28:36,181
as much data as possible so
that we can actually get up

720
00:28:36,181 --> 00:28:38,750
and fairly comfortably talk
about the amount of information

721
00:28:38,750 --> 00:28:40,652
that we're able to see.

722
00:28:40,652 --> 00:28:43,221
So, obviously there's a bunch
of information, you know,

723
00:28:43,221 --> 00:28:44,889
you can see the signal
strength, you can see all that.

724
00:28:44,889 --> 00:28:48,359
So essentially, again, with
the wireless information,

725
00:28:48,359 --> 00:28:50,794
you could probably map
out within the house

726
00:28:50,795 --> 00:28:52,564
just based on the signal
strength kind of like

727
00:28:52,564 --> 00:28:54,999
where the WiFi router is,
where all that information is.

728
00:28:54,999 --> 00:28:57,602
Like, you can actually kind
of like rebuild essentially

729
00:28:57,602 --> 00:28:59,838
kind of the structure
of somebody's house

730
00:28:59,838 --> 00:29:01,773
just from the information
in this database.

731
00:29:01,773 --> 00:29:04,109
Again, most of us will
probably never do that but,

732
00:29:04,109 --> 00:29:06,177
you know, if you're bored
on a weekend and drunk

733
00:29:06,177 --> 00:29:08,079
and poking around, like,
hey, like I just want to see

734
00:29:08,079 --> 00:29:09,880
if I can figure out like the
signal strength in my house

735
00:29:09,881 --> 00:29:11,382
and where to put something.

736
00:29:11,382 --> 00:29:13,284
It's all in, they've already
generated all the data for you

737
00:29:13,284 --> 00:29:14,786
so it's fantastic.

738
00:29:16,187 --> 00:29:19,189
The locations database
was a little interesting.

739
00:29:19,190 --> 00:29:20,725
So it is exactly
what you think it.

740
00:29:20,725 --> 00:29:22,659
It's the actual location,
however, it's a geographic

741
00:29:22,660 --> 00:29:25,330
coordinates of where
the account was.

742
00:29:25,330 --> 00:29:27,866
We're not exactly sure
how this is generated yet,

743
00:29:27,866 --> 00:29:31,636
where it actually is but
I will say when I put in

744
00:29:31,636 --> 00:29:32,870
the coordinates,

745
00:29:32,871 --> 00:29:35,173
because none of these
devices are GPS enabled,

746
00:29:35,173 --> 00:29:37,342
it's probably based on
the phone, I would guess.

747
00:29:37,342 --> 00:29:39,644
However, since it's not
required to run on a phone,

748
00:29:39,644 --> 00:29:40,979
since it could run
on a WiFi tablet,

749
00:29:40,979 --> 00:29:42,013
it's actually probably based off

750
00:29:42,013 --> 00:29:44,381
the ISP information somehow.

751
00:29:44,382 --> 00:29:47,252
But putting them
into an actual map,

752
00:29:47,252 --> 00:29:49,954
it's pretty darn close to
where my house actually is.

753
00:29:49,954 --> 00:29:52,423
I was very surprised by
the level of accuracy

754
00:29:52,423 --> 00:29:53,992
just based off the location data

755
00:29:53,992 --> 00:29:55,527
from the application itself.

756
00:29:55,527 --> 00:29:58,163
Like, it's not perfect but,
you know, it's close enough

757
00:29:58,163 --> 00:30:00,098
for horseshoes
and hand grenades.

758
00:30:00,098 --> 00:30:01,331
It's good enough.

759
00:30:01,332 --> 00:30:04,335
It's not quite there but
it's pretty darn good.

760
00:30:04,335 --> 00:30:07,572
So, as we said, we are
working on trying to get all

761
00:30:07,572 --> 00:30:09,239
of the information to parse
this out and make this

762
00:30:09,240 --> 00:30:11,609
as easy as possible.

763
00:30:11,609 --> 00:30:13,778
Next week, when the
Echo Show comes out,

764
00:30:13,778 --> 00:30:15,513
all of that's gonna change
because now we have,

765
00:30:15,513 --> 00:30:17,048
we have to pull out video files,

766
00:30:17,048 --> 00:30:18,183
we have to pull out audio files,

767
00:30:18,183 --> 00:30:20,218
we're gonna be able to pull back

768
00:30:20,218 --> 00:30:22,020
Amazon Prime video steaming.

769
00:30:22,020 --> 00:30:23,388
We're gonna have so
much more information

770
00:30:23,388 --> 00:30:24,656
that we're gonna
have to pull out.

771
00:30:24,656 --> 00:30:26,157
Like, we honestly go
to the point, like,

772
00:30:26,157 --> 00:30:27,559
it's not even worth it to
start looking at scripts

773
00:30:27,559 --> 00:30:29,427
that actually parses
data because everything

774
00:30:29,427 --> 00:30:31,295
is probably gonna change
in a week and then we have

775
00:30:31,296 --> 00:30:32,997
to drop all of our work
and restart everything

776
00:30:32,997 --> 00:30:34,132
all over again.

777
00:30:34,132 --> 00:30:35,967
So, we're working on it.

778
00:30:35,967 --> 00:30:38,102
We're more than willing to
talk to anybody who wants

779
00:30:38,102 --> 00:30:39,537
to find more
information about it.

780
00:30:39,537 --> 00:30:41,606
Like, we absolutely will
talk to you, however

781
00:30:41,606 --> 00:30:42,907
we don't have any scripts yet.

782
00:30:42,907 --> 00:30:45,342
We're getting there, we promise.

783
00:30:45,343 --> 00:30:47,312
But if there is anything
in specific that anybody

784
00:30:47,312 --> 00:30:48,812
has questions or
anything on, like I said,

785
00:30:48,813 --> 00:30:50,381
we'll talk to you
during question time,

786
00:30:50,381 --> 00:30:52,250
we'll talk to you
afterwards, I mean,

787
00:30:52,250 --> 00:30:53,518
she's here for a few more days,

788
00:30:53,518 --> 00:30:54,485
I'm here for a few
more days, like,

789
00:30:54,485 --> 00:30:56,821
we're gonna be around for sure.

790
00:30:56,821 --> 00:30:59,424
But the other reason was we
found lots of security issues.

791
00:30:59,424 --> 00:31:02,660
So, again, the I am fine
dog reared his head.

792
00:31:02,660 --> 00:31:04,729
So, obviously, we have
account credentials

793
00:31:04,729 --> 00:31:06,698
in plain text passwords.

794
00:31:06,698 --> 00:31:08,566
That is a problem,

795
00:31:08,566 --> 00:31:10,335
that was a problem from
the kasa security app.

796
00:31:10,335 --> 00:31:13,104
So literally anybody, wherever
they were in the world,

797
00:31:13,104 --> 00:31:15,273
could log in with
your kasa application

798
00:31:15,273 --> 00:31:17,140
and they can control
all of your stuff.

799
00:31:17,141 --> 00:31:19,410
There is no email that
said another application,

800
00:31:19,410 --> 00:31:21,145
that another person
logged into your account,

801
00:31:21,145 --> 00:31:22,580
there's no notification.

802
00:31:22,580 --> 00:31:24,115
Literally, if somebody
gets your credentials,

803
00:31:24,115 --> 00:31:25,850
they can log in and do
whatever they wanted

804
00:31:25,850 --> 00:31:27,084
to your smart house.

805
00:31:27,085 --> 00:31:29,587
That was a problem and
Stacey's been fantastic.

806
00:31:29,587 --> 00:31:32,290
She actually was doing a lot
of the testing in Chicago,

807
00:31:32,290 --> 00:31:34,259
which is how I know that
somebody could remotely

808
00:31:34,259 --> 00:31:35,760
control my stuff.

809
00:31:35,760 --> 00:31:37,762
It was a little freaky at
times when like the light bulb

810
00:31:37,762 --> 00:31:38,996
just starts going on and off.

811
00:31:38,997 --> 00:31:40,465
I was like, damn
it, Stacey, stop!

812
00:31:40,465 --> 00:31:42,233
Like, stop doing that,
just leave my stuff alone

813
00:31:42,233 --> 00:31:43,533
for a while.

814
00:31:43,534 --> 00:31:45,837
But, again, thank you so
much for all of the work

815
00:31:45,837 --> 00:31:47,238
that you did with that.

816
00:31:47,238 --> 00:31:50,108
So the other thing that
we found was initially

817
00:31:50,108 --> 00:31:52,243
you didn't even have to
be logged in to the kasa

818
00:31:52,243 --> 00:31:54,779
application to actually
control the devices.

819
00:31:54,779 --> 00:31:56,214
You just had to be on the
same wireless network,

820
00:31:56,214 --> 00:31:57,649
that was it.

821
00:31:57,649 --> 00:31:59,050
You had to be on an
encrypted wireless network,

822
00:31:59,050 --> 00:32:00,985
it won't let you connect
to an open network.

823
00:32:00,985 --> 00:32:03,388
But if you were on the same
network all you had to do

824
00:32:03,388 --> 00:32:05,255
was open the application
and you could control

825
00:32:05,256 --> 00:32:06,524
all the devices.

826
00:32:06,524 --> 00:32:08,059
The app automatically
goes through and finds

827
00:32:08,059 --> 00:32:10,028
all the TP-Link devices that
are actually on the network

828
00:32:10,028 --> 00:32:12,764
so it does all the network
scanning for you automatically.

829
00:32:12,764 --> 00:32:14,933
All you have to do is
literally open the application

830
00:32:14,933 --> 00:32:16,234
on the network and you can see

831
00:32:16,234 --> 00:32:18,436
what TP-Link devices are there.

832
00:32:18,436 --> 00:32:21,773
And just by opening
the application, you
can control them.

833
00:32:21,773 --> 00:32:23,942
TP-Link has been fantastic
throughout all of this

834
00:32:23,942 --> 00:32:27,011
and actually yesterday their
app update is specifically

835
00:32:27,011 --> 00:32:29,314
addressing our two issues
with the plain text

836
00:32:29,314 --> 00:32:31,549
security credentials
and the login account.

837
00:32:31,549 --> 00:32:34,152
So, essentially the takeaway
from this is when you're at

838
00:32:34,152 --> 00:32:36,955
your family reunion, that
little son-of-a-bitch, Timmy,

839
00:32:36,955 --> 00:32:39,857
who always doing random
stuff with his mobile phone,

840
00:32:39,857 --> 00:32:41,726
he can't download the app
and just randomly control

841
00:32:41,726 --> 00:32:42,827
all the shit anymore.

842
00:32:42,827 --> 00:32:44,662
Like, take it Timmy!

843
00:32:44,662 --> 00:32:46,097
Like, that's fantastic!

844
00:32:46,097 --> 00:32:48,666
So, again, like it was
kind of weird going through

845
00:32:48,666 --> 00:32:50,134
all of this.

846
00:32:50,134 --> 00:32:51,669
It's like, this is actually
I think the first time

847
00:32:51,669 --> 00:32:53,571
that we've done research
where like literally like

848
00:32:53,571 --> 00:32:56,474
the application update was
literally because of the stuff

849
00:32:56,474 --> 00:32:57,774
that we did.

850
00:32:57,775 --> 00:33:00,845
And it was, obviously,
these weren't terrible

851
00:33:00,845 --> 00:33:03,348
life-threatening issues,
potentially life-threatening

852
00:33:03,348 --> 00:33:05,216
issues that we're gonna get
into with the Amazon stuff

853
00:33:05,216 --> 00:33:08,352
but it was nice to see that,
you know, with all the focus

854
00:33:08,353 --> 00:33:09,854
on IoT security and
everything like that,

855
00:33:09,854 --> 00:33:12,190
like the companies are
actually responsive and willing

856
00:33:12,190 --> 00:33:14,659
and able to actually try to
work to make their applications

857
00:33:14,659 --> 00:33:18,463
better and perform in
a much better format.

858
00:33:18,463 --> 00:33:21,132
So, again, I can't say
enough good stuff about

859
00:33:21,132 --> 00:33:23,234
what TP-Link has been doing.

860
00:33:23,234 --> 00:33:25,168
Like, they've been fantastic
throughout all of this.

861
00:33:25,169 --> 00:33:26,838
We're trying to make
everything better,

862
00:33:26,838 --> 00:33:28,873
trying to balance that
fine line between usability

863
00:33:28,873 --> 00:33:31,042
and security which,
obviously, is really,

864
00:33:31,042 --> 00:33:33,477
it's important for
an IoT company.

865
00:33:33,478 --> 00:33:34,979
We're focusing on a
security side, like,

866
00:33:34,979 --> 00:33:37,081
while we would love everything
to be as secure as possible,

867
00:33:37,081 --> 00:33:38,949
we know that it's not
possible because if it's

868
00:33:38,950 --> 00:33:41,052
as secure as possible,
it's not usable.

869
00:33:41,052 --> 00:33:43,321
So, again, they have been
fantastic through all of that

870
00:33:43,321 --> 00:33:46,724
and I can't thank, I mean,
we can't thank TP-Link enough

871
00:33:46,724 --> 00:33:48,960
for the stuff that they've
been doing for this.

872
00:33:48,960 --> 00:33:51,829
And then we get to
Amazon and Alexa.

873
00:33:51,829 --> 00:33:53,630
So, the calling and
messaging feature,

874
00:33:53,631 --> 00:33:56,601
we found almost nothing,
nothing at all security-wise

875
00:33:56,601 --> 00:33:58,836
until calling and messaging hit.

876
00:33:58,836 --> 00:34:02,807
And if you follow me on
Twitter, you know that we had

877
00:34:02,807 --> 00:34:05,209
some issues with that
right off the way.

878
00:34:05,209 --> 00:34:08,946
So one of the things that
was noticed fairly early on

879
00:34:08,946 --> 00:34:11,449
is that a woman, I
believe in North Carolina,

880
00:34:11,449 --> 00:34:14,485
said that she couldn't
block any of the contacts.

881
00:34:14,485 --> 00:34:16,354
So that's pretty
straightforward.

882
00:34:16,353 --> 00:34:18,955
Like, if you don't want
contacts in your Alexa account

883
00:34:18,956 --> 00:34:20,425
just don't have the
contacts in your phone.

884
00:34:20,425 --> 00:34:21,926
Like, that's straightforward.

885
00:34:21,926 --> 00:34:23,895
But if you don't do that, you
would think that there would

886
00:34:23,895 --> 00:34:25,063
be a way to block contacts.

887
00:34:25,063 --> 00:34:28,433
And, unfortunately,
there was not.

888
00:34:28,433 --> 00:34:31,768
However that really
wasn't an issue.

889
00:34:31,768 --> 00:34:33,837
I mean, it's not that big
of an issue compared to

890
00:34:33,838 --> 00:34:37,442
what we found when we had
our dumpster fire happen.

891
00:34:37,442 --> 00:34:39,976
So fortunately the
one prior ransomware,

892
00:34:39,976 --> 00:34:42,480
or unfortunately for
those affected by it,

893
00:34:42,480 --> 00:34:45,216
happened while we were
finding this so fortunately

894
00:34:45,216 --> 00:34:47,685
there wasn't a whole lot of
time for people to try to do

895
00:34:47,685 --> 00:34:50,455
bad things with the
stuff that we found.

896
00:34:50,455 --> 00:34:52,556
It's weird that ransomware
worked that well

897
00:34:52,556 --> 00:34:54,292
but in this case I think it
actually worked that well

898
00:34:54,292 --> 00:34:56,594
to keep people away from
a certain until they could

899
00:34:56,594 --> 00:34:58,629
work on getting fixes in place.

900
00:34:58,629 --> 00:35:02,567
So this was literally my tweet
when I found what I found

901
00:35:02,567 --> 00:35:07,205
and I had my holy shit,
this is horrible, moment.

902
00:35:07,205 --> 00:35:08,940
We had, we reached out to
them and within an hour

903
00:35:08,940 --> 00:35:10,608
we were actually talking
to the Amazon security team

904
00:35:10,608 --> 00:35:12,310
with what we had found.

905
00:35:12,310 --> 00:35:15,078
So it's kind of weird,
again, and Stacey actually

906
00:35:15,079 --> 00:35:17,748
is the one who brought
all this to light because

907
00:35:17,748 --> 00:35:20,685
how we stumbled upon
this was my test device

908
00:35:20,685 --> 00:35:23,354
was a Galaxy Note II and
it was not compatible

909
00:35:23,354 --> 00:35:24,689
with the new version of the app,

910
00:35:24,689 --> 00:35:26,190
with the calling and messaging.

911
00:35:26,190 --> 00:35:27,825
So I was like, well, I want
to make sure that it works

912
00:35:27,825 --> 00:35:30,495
so I sign into my phone and
I actually had Stacey sign in

913
00:35:30,495 --> 00:35:33,197
with the peacock credentials
to her phone just to see

914
00:35:33,197 --> 00:35:34,532
what would happen.

915
00:35:34,532 --> 00:35:36,601
So, again, ease of
convenience, user interaction,

916
00:35:36,601 --> 00:35:38,102
all of that good stuff.

917
00:35:38,102 --> 00:35:41,571
Like, it makes sense from
a customer perspective.

918
00:35:41,572 --> 00:35:44,475
The very first time you sign
in and only the very first time

919
00:35:44,475 --> 00:35:47,444
you get an SMS message to
your phone to the number

920
00:35:47,445 --> 00:35:49,780
you associate with the account
and that is the only time

921
00:35:49,780 --> 00:35:51,883
that there's any kind
of authentication to it.

922
00:35:51,883 --> 00:35:54,352
So all it takes is one time
and automatically your account

923
00:35:54,352 --> 00:35:57,221
is now synced, your phone
is now synced with the Alexa

924
00:35:57,221 --> 00:35:58,856
account and you can pull
the calling and messaging

925
00:35:58,856 --> 00:36:01,292
and all that features
from your phone.

926
00:36:01,292 --> 00:36:03,728
So if you have the credentials,
you can log in to any device

927
00:36:03,728 --> 00:36:06,197
that actually has the
app installed to it.

928
00:36:06,197 --> 00:36:07,431
So, what this means is

929
00:36:07,431 --> 00:36:10,401
you could make Alexa
calls as another person,

930
00:36:10,401 --> 00:36:14,172
you could receive Alexa calls
being sent to another person,

931
00:36:14,172 --> 00:36:16,941
you could send messages
as another person.

932
00:36:16,941 --> 00:36:21,546
You literally could, you could
be NSA to all the Alexa stuff

933
00:36:21,546 --> 00:36:23,047
without anybody even knowing.

934
00:36:23,047 --> 00:36:24,882
Like, you could literally
man-in-the-middle anything.

935
00:36:24,882 --> 00:36:28,419
Like, you could, and all
of it, the worst thing was

936
00:36:28,419 --> 00:36:30,621
there was no way for the
user to actually know

937
00:36:30,621 --> 00:36:32,790
that somebody else had even
signed in to your account.

938
00:36:32,790 --> 00:36:36,794
So, from the safety perspective,
let's say you had a couple

939
00:36:36,794 --> 00:36:38,529
who were together who
shared an Amazon account

940
00:36:38,529 --> 00:36:40,731
and then they had a horrible
breakup and maybe even like

941
00:36:40,731 --> 00:36:42,800
there's a restraining
order now against the guy,

942
00:36:42,800 --> 00:36:44,569
or something like that.

943
00:36:44,569 --> 00:36:48,739
He could log in to the Alexa
account, sync the information,

944
00:36:50,208 --> 00:36:52,710
and actually could see all the
messages that are being sent,

945
00:36:52,710 --> 00:36:54,812
receive all the phone calls,
all of that information,

946
00:36:54,812 --> 00:36:56,580
it could do all of that
and there was no way

947
00:36:56,581 --> 00:36:58,082
for the user to know.

948
00:36:58,082 --> 00:37:00,518
So, at this point, it kind
of, it very much shifted

949
00:37:00,518 --> 00:37:02,453
from a security issue to
like this is an actual

950
00:37:02,453 --> 00:37:05,356
public safety issue which
is why we were so concerned.

951
00:37:05,356 --> 00:37:07,959
Like, the last thing that
we wanted to have happen

952
00:37:07,959 --> 00:37:09,694
is somebody take the
research that we're doing

953
00:37:09,694 --> 00:37:11,929
and use it for really,
really, really bad.

954
00:37:11,929 --> 00:37:15,066
Like, it's all fun and games,
like hack WiFi passwords

955
00:37:15,066 --> 00:37:17,167
and everything like that but,
I mean, this was actually

956
00:37:17,168 --> 00:37:19,170
potentially like
life-threatening
stuff that we had to

957
00:37:19,170 --> 00:37:20,371
bring up to Amazon.

958
00:37:20,371 --> 00:37:22,607
And, again, they were
fantastic with it.

959
00:37:22,607 --> 00:37:25,243
They worked really hard on
trying to get some of the fixes

960
00:37:25,243 --> 00:37:28,246
but unfortunately once
this information was out,

961
00:37:28,246 --> 00:37:30,214
we knew that people would
potentially take it and use it

962
00:37:30,214 --> 00:37:32,883
for bad so that's why we
didn't talk about anything

963
00:37:32,883 --> 00:37:34,085
that we found specifically

964
00:37:34,085 --> 00:37:35,620
with the calling
and messaging stuff.

965
00:37:35,620 --> 00:37:37,421
In any of the talks that we
did beforehand we just said

966
00:37:37,421 --> 00:37:40,258
that we found some stuff with
Alexa and went through there.

967
00:37:40,258 --> 00:37:42,827
So, sure enough,
when I did the call,

968
00:37:42,827 --> 00:37:46,764
calling the peacock account,
my test phones both rang,

969
00:37:46,764 --> 00:37:50,534
Stacey's phone in Chicago
rang, my Echo rang,

970
00:37:50,534 --> 00:37:54,705
all of that rang and had no
idea that it was even honestly

971
00:37:55,573 --> 00:37:57,308
signed in under the devices.

972
00:37:57,308 --> 00:37:59,010
So the only way that I knew
that something happened

973
00:37:59,010 --> 00:38:00,911
is there's a very, very
quick message that flashes up

974
00:38:00,911 --> 00:38:02,880
to say the call was
answered on another device.

975
00:38:02,880 --> 00:38:04,282
That is it.

976
00:38:04,282 --> 00:38:06,684
There was no, no it was
answered from your third iPhone

977
00:38:06,684 --> 00:38:08,586
or answered from the
living room Echo Dot.

978
00:38:08,586 --> 00:38:09,854
There's nothing like that.

979
00:38:09,854 --> 00:38:11,422
It was very quickly
something flashed

980
00:38:11,422 --> 00:38:13,391
and that was the extent of it.

981
00:38:13,391 --> 00:38:15,259
The other thing that we noticed
is that all of the contacts

982
00:38:15,259 --> 00:38:17,561
automatically replicate
across devices.

983
00:38:17,561 --> 00:38:20,564
So let's say you're
signed in on a device,

984
00:38:20,564 --> 00:38:23,000
it will automatically
scan through your phone

985
00:38:23,000 --> 00:38:25,169
looking through the contacts,
any contacts that it finds

986
00:38:25,169 --> 00:38:28,939
it will now sync with
your Alexa contacts.

987
00:38:28,939 --> 00:38:30,607
It doesn't matter
what phone it's in,

988
00:38:30,608 --> 00:38:33,210
it doesn't even matter if it's
associated with that account.

989
00:38:33,210 --> 00:38:36,080
Whatever device it signs
into last it will search

990
00:38:36,080 --> 00:38:38,015
through the contacts and
any of them that have

991
00:38:38,015 --> 00:38:39,817
a phone number associated
with the Alexa account

992
00:38:39,817 --> 00:38:42,219
will actually sync
across all the contacts.

993
00:38:42,219 --> 00:38:44,655
So even enabling two-factor
authentication did not

994
00:38:44,655 --> 00:38:46,857
change that because once
you were in the application

995
00:38:46,857 --> 00:38:48,326
you were good to go.

996
00:38:48,326 --> 00:38:50,661
There's no forced logout
after you enable two-factor

997
00:38:50,661 --> 00:38:53,164
authentication so essentially
if somebody had already

998
00:38:53,164 --> 00:38:55,800
logged into your Alexa,
or the Amazon account,

999
00:38:55,800 --> 00:38:57,935
you had no way of knowing
and unfortunately there was

1000
00:38:57,935 --> 00:39:00,871
no way to force them
out afterwards initially

1001
00:39:00,871 --> 00:39:04,275
and then we found
some ways to do that.

1002
00:39:04,275 --> 00:39:06,510
The other thing that we had
the big concerns with Amazon

1003
00:39:06,510 --> 00:39:09,280
was obviously the WiFi configs.

1004
00:39:09,280 --> 00:39:12,750
While we understand again
why it all works, by default,

1005
00:39:12,750 --> 00:39:15,886
Amazon will save your
network information to the

1006
00:39:15,886 --> 00:39:18,322
Alexa application to all
their stuff so you can sign in

1007
00:39:18,322 --> 00:39:19,657
across the devices.

1008
00:39:19,657 --> 00:39:21,826
So, we had big
concerns, obviously,

1009
00:39:21,826 --> 00:39:24,528
because of the plain
text SSID and password.

1010
00:39:24,528 --> 00:39:28,265
Again, it's an issue that we
still feel is a pretty big one

1011
00:39:28,265 --> 00:39:31,234
and Amazon seems to kind
of say that that's working

1012
00:39:31,235 --> 00:39:34,171
how it's supposed to so,
again, that's their call.

1013
00:39:34,171 --> 00:39:36,207
However, we did find out
that you can remove WiFi,

1014
00:39:36,207 --> 00:39:39,210
remove the actual credentials
from the account by calling

1015
00:39:39,210 --> 00:39:40,745
them up initially.

1016
00:39:40,745 --> 00:39:41,879
And then we found that
you can actually do it

1017
00:39:41,879 --> 00:39:43,381
from the browser.

1018
00:39:43,381 --> 00:39:44,714
So if you're concerned that
you actually have wireless

1019
00:39:44,715 --> 00:39:46,550
networks, or wireless
information saved

1020
00:39:46,550 --> 00:39:49,754
on the Amazon account you can
actually just browse the site,

1021
00:39:49,754 --> 00:39:52,723
delete all the passwords,
or delete all the saved

1022
00:39:52,723 --> 00:39:54,525
network information and
then it will actually

1023
00:39:54,525 --> 00:39:56,093
clear it all out and
you're good to go.

1024
00:39:56,093 --> 00:39:58,863
However, the information
does still get saved

1025
00:39:58,863 --> 00:40:02,165
on the Echo devices, however,
it's actually encrypted

1026
00:40:02,166 --> 00:40:04,268
and protected and everything
like that so it's not

1027
00:40:04,268 --> 00:40:06,737
just in plain text waiting
there, but it is actually saved

1028
00:40:06,737 --> 00:40:08,873
on the devices, even if you
delete it from the actual

1029
00:40:08,873 --> 00:40:11,208
web facing interface.

1030
00:40:11,208 --> 00:40:14,912
So Amazon released
an Echo update to,

1031
00:40:14,912 --> 00:40:17,180
actually I think it
was about a week ago.

1032
00:40:17,181 --> 00:40:19,483
Again, they've been fantastic
through all of this as well

1033
00:40:19,483 --> 00:40:21,919
but they, I think, are actually
taking more of a bigger

1034
00:40:21,919 --> 00:40:24,855
picture where they're trying
to balance the usability

1035
00:40:24,855 --> 00:40:26,690
features of the calling
and messaging feature,

1036
00:40:26,690 --> 00:40:28,325
especially since they
actually have a product

1037
00:40:28,325 --> 00:40:31,261
coming out next week which
entirely focuses around

1038
00:40:31,262 --> 00:40:33,063
the calling and
messaging features.

1039
00:40:33,063 --> 00:40:36,333
So, again, they have, we kind
of put them in a hard position

1040
00:40:36,333 --> 00:40:39,036
because it's like, this stuff
would be fantastic to fix

1041
00:40:39,036 --> 00:40:42,173
but it's hard to fix it
because it's already out there

1042
00:40:42,173 --> 00:40:44,107
and they feel that it's
working the way that it is.

1043
00:40:44,108 --> 00:40:46,310
So we did what we could,
we brought it up to them

1044
00:40:46,310 --> 00:40:48,446
and they're the ones
making decisions on the way

1045
00:40:48,446 --> 00:40:51,248
they're gonna go forward with
the issues that we found.

1046
00:40:51,248 --> 00:40:54,919
So our kind of future
plans and you want to?

1047
00:40:55,886 --> 00:40:57,354
- Sure.

1048
00:40:57,354 --> 00:40:59,056
So what we're gonna do is we're
gonna add some iOS devices

1049
00:40:59,056 --> 00:41:01,592
to the testing so that we can
go ahead and test that side

1050
00:41:01,592 --> 00:41:04,261
because we did only
test Android devices.

1051
00:41:04,261 --> 00:41:06,864
We do have an Amazon Show
will be arriving at my house

1052
00:41:06,864 --> 00:41:08,499
on the 28th.

1053
00:41:08,499 --> 00:41:11,734
Something of note, TP-Link
has actually now enrolled

1054
00:41:11,735 --> 00:41:13,904
both of us in their beta
testing program and we're both

1055
00:41:13,904 --> 00:41:15,973
receiving hardware from
them so we're now testing

1056
00:41:15,973 --> 00:41:18,075
for TP-Link, pre-release.

1057
00:41:19,643 --> 00:41:21,779
We're actually gonna write the
scripts after we get through

1058
00:41:21,779 --> 00:41:25,049
the data on the show to
actually parse this data.

1059
00:41:25,049 --> 00:41:27,718
And we should have that done,
we think we'll have it done

1060
00:41:27,718 --> 00:41:29,386
before OS the app.
- Hopefully.

1061
00:41:29,386 --> 00:41:32,990
So that voting's open so
vote for our talk because

1062
00:41:32,990 --> 00:41:36,160
we'd love to be able
to share that research.

1063
00:41:36,160 --> 00:41:37,962
So we're gonna do some
real robust testing

1064
00:41:37,962 --> 00:41:39,463
with the Echo Show.

1065
00:41:39,463 --> 00:41:41,966
I can't wait to find that
darn fox that keeps scatting

1066
00:41:41,966 --> 00:41:44,234
in front of my house.

1067
00:41:44,235 --> 00:41:48,772
And I won't shoot it,
I promise, (mumbles).

1068
00:41:48,772 --> 00:41:52,176
And then we're gonna continue
to work with both Amazon

1069
00:41:52,176 --> 00:41:54,378
and TP-Link to make sure that
the applications are working

1070
00:41:54,378 --> 00:41:57,548
securely and safely at
the same time figuring out

1071
00:41:57,548 --> 00:42:00,216
where the data is for
the forensics purposes.

1072
00:42:00,217 --> 00:42:03,153
We have plans to meet
with Amazon at DEFCON.

1073
00:42:03,153 --> 00:42:06,524
So, I mean, they have
really been fantastic.

1074
00:42:06,524 --> 00:42:08,692
And despite being
from the future,

1075
00:42:08,692 --> 00:42:10,861
we could not bring back
our test results yet

1076
00:42:10,861 --> 00:42:12,462
from the future.

1077
00:42:12,463 --> 00:42:15,466
So, in summary, the
data is pretty much

1078
00:42:15,466 --> 00:42:17,401
primarily stored in the cloud.

1079
00:42:17,401 --> 00:42:19,603
There is some information
that you can get off

1080
00:42:19,603 --> 00:42:22,773
the application and there are
time stamps in some of those

1081
00:42:22,773 --> 00:42:24,542
URLs that we didn't discuss
because that's pretty

1082
00:42:24,542 --> 00:42:27,611
common knowledge but
there's very, very little

1083
00:42:27,611 --> 00:42:30,247
that's available offline
because it's constantly

1084
00:42:30,247 --> 00:42:31,781
syncing to the device.

1085
00:42:31,782 --> 00:42:34,485
Based on what we saw on the
hardware on the Amazon Echo

1086
00:42:34,485 --> 00:42:38,389
and the fact that we had
the 24 hour storage of the

1087
00:42:38,389 --> 00:42:42,092
voice messaging, we are hopeful
that we'll find some more

1088
00:42:42,092 --> 00:42:44,161
physical stuff on the
hardware on the Show.

1089
00:42:44,161 --> 00:42:45,763
The exciting this in when
I started this research,

1090
00:42:45,763 --> 00:42:47,698
I really wasn't planning
much at all so it's exciting

1091
00:42:47,698 --> 00:42:50,200
to see as they're adding more,
more and more things stored

1092
00:42:50,200 --> 00:42:52,669
on the hardware itself.

1093
00:42:52,670 --> 00:42:56,073
There's a lot of useful
information in the secondary

1094
00:42:56,073 --> 00:42:58,609
applications that control
your smart home like kasa

1095
00:42:58,609 --> 00:43:02,712
TP-Link application and we
expect, based on the API,

1096
00:43:04,081 --> 00:43:06,584
that a lot of the skills
will also store robust amount

1097
00:43:06,584 --> 00:43:10,354
of data most likely
in SQLite databases.

1098
00:43:10,354 --> 00:43:15,024
Account credentials are all
you need up until yesterday?

1099
00:43:15,025 --> 00:43:16,460
- [Brian] Yep.

1100
00:43:16,460 --> 00:43:19,396
- Ha ha ha, to be able to
pretty much control a smart home

1101
00:43:19,396 --> 00:43:21,031
or being just on a network.

1102
00:43:21,031 --> 00:43:22,366
But, again, thanks to TP-Link

1103
00:43:22,366 --> 00:43:25,369
for changing that
stuff immediately.

1104
00:43:26,737 --> 00:43:28,005
The skills probably are gonna
have a lot of good data.

1105
00:43:28,005 --> 00:43:29,640
I can't wait to dig
into some of those.

1106
00:43:29,640 --> 00:43:33,077
And I cannot stress how
awesome it was to work with

1107
00:43:33,077 --> 00:43:35,179
both these security teams
and their responsiveness.

1108
00:43:35,179 --> 00:43:37,615
The fact that they were in
contact and responded back to us

1109
00:43:37,615 --> 00:43:40,850
within hours, that they took
time to do phone calls with us,

1110
00:43:40,851 --> 00:43:42,820
the fact that we're meeting
with some of these people

1111
00:43:42,820 --> 00:43:47,391
in person, it really
is fantastic how
much they've listened

1112
00:43:47,391 --> 00:43:51,395
and chosen to take action
and put out updates.

1113
00:43:51,395 --> 00:43:55,366
So, you know, the question
is, is Alexa Skynet?

1114
00:43:55,366 --> 00:43:56,200
Not yet.

1115
00:43:58,736 --> 00:44:00,738
And the other point here is,

1116
00:44:00,738 --> 00:44:02,772
I don't know if you guys
can see it in the image,

1117
00:44:02,773 --> 00:44:04,208
but we kind of were trying,

1118
00:44:04,208 --> 00:44:06,443
or Brian and his great
photoshopping was trying to

1119
00:44:06,443 --> 00:44:10,080
kind of capture the future
here with the drone delivery

1120
00:44:10,080 --> 00:44:12,249
as well as the fact that
we've got cloud data,

1121
00:44:12,249 --> 00:44:14,718
we've got hardware data,
and we've got app data.

1122
00:44:14,718 --> 00:44:16,353
Right, Alexa apps
on the brain there.

1123
00:44:16,353 --> 00:44:19,089
And really to get the
full picture of everything

1124
00:44:19,089 --> 00:44:21,291
we feel like you need
access to all three

1125
00:44:21,291 --> 00:44:22,793
and that's really
the only full way

1126
00:44:22,793 --> 00:44:25,129
that you the full picture
of what's going on here.

1127
00:44:25,129 --> 00:44:28,799
(dramatic percussion music)

