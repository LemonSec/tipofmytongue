1
00:00:09,576 --> 00:00:10,844
(audience applauding)

2
00:00:10,844 --> 00:00:11,878
(speaks indistinctly)

3
00:00:11,878 --> 00:00:13,646
(audience laughs)

4
00:00:13,646 --> 00:00:18,218
- Hi everyone, this is Heidi,
because I'm from Zurich,

5
00:00:18,218 --> 00:00:20,787
or I'm from Sweden, but
I'm working in Zurich.

6
00:00:20,787 --> 00:00:24,224
We play that every
Friday before TGIF,

7
00:00:24,224 --> 00:00:26,459
so that's the cue for
when to go and drink beer

8
00:00:26,459 --> 00:00:28,695
and have fun with
your colleagues.

9
00:00:28,695 --> 00:00:29,629
That's the theme song.

10
00:00:29,629 --> 00:00:31,664
All right, so, I'm Johan,

11
00:00:33,133 --> 00:00:36,903
I do incident response and
I do forensics at Google.

12
00:00:38,071 --> 00:00:40,839
We're gonna talk about,
we're gonna explore

13
00:00:40,840 --> 00:00:44,844
how great tools and
collaboration and procedures

14
00:00:46,713 --> 00:00:49,883
gonna help you scale
forensics, right.

15
00:00:51,518 --> 00:00:54,554
We're not gonna talk about
wizards today, unfortunately,

16
00:00:54,554 --> 00:00:56,456
because it isn't magic.

17
00:00:57,557 --> 00:01:00,160
It is about good engineering,

18
00:01:00,160 --> 00:01:03,596
and it's about working together,

19
00:01:03,596 --> 00:01:07,100
and having tools that
back you up in that.

20
00:01:08,701 --> 00:01:10,369
All right.

21
00:01:10,370 --> 00:01:11,871
So I remember on my first case,

22
00:01:11,871 --> 00:01:15,942
and this was many years ago,
long before I started Google.

23
00:01:18,478 --> 00:01:20,679
I was working at the
university at the time.

24
00:01:20,680 --> 00:01:23,183
My background is
system administration

25
00:01:23,183 --> 00:01:26,152
and network administration.

26
00:01:26,152 --> 00:01:28,054
I had spent years
kind of figuring out

27
00:01:28,054 --> 00:01:31,357
how systems work and
how to make users happy,

28
00:01:31,357 --> 00:01:35,195
and you know, digging
down into how DNS works,

29
00:01:36,529 --> 00:01:40,366
routing and peering
agreements and the politics

30
00:01:40,366 --> 00:01:44,137
and governance behind
the internet and so on.

31
00:01:46,873 --> 00:01:48,374
So I remember my first case.

32
00:01:48,374 --> 00:01:50,877
My boss called me up and
one of those, you know,

33
00:01:50,877 --> 00:01:53,312
"Johan, you know
about computers.

34
00:01:53,313 --> 00:01:55,315
"Can you try to figure this out?

35
00:01:55,315 --> 00:01:58,917
"It looks like one of
our servers is hacked."

36
00:01:58,918 --> 00:02:01,221
And I was, of course,
kind of curious,

37
00:02:01,221 --> 00:02:02,455
and I hadn't done that before,

38
00:02:02,455 --> 00:02:05,225
so yeah, challenge
accepted, right.

39
00:02:06,960 --> 00:02:10,662
But I had no idea
what I was doing.

40
00:02:10,663 --> 00:02:12,832
Started as a small fire.

41
00:02:12,832 --> 00:02:15,834
As many of you already
probably know, right,

42
00:02:15,835 --> 00:02:18,738
starts as a small
fire, one server,

43
00:02:20,173 --> 00:02:22,208
and I kind of had
no idea what to do.

44
00:02:22,208 --> 00:02:23,576
I was a total newbie
when it comes to this.

45
00:02:23,576 --> 00:02:26,946
But I know a thing
or two about systems,

46
00:02:26,946 --> 00:02:30,383
and how systems work,
so I can step back,

47
00:02:30,383 --> 00:02:33,553
and thought, where
is my comfort zone?

48
00:02:35,989 --> 00:02:37,957
How can I approach this problem?

49
00:02:37,957 --> 00:02:40,959
And my comfort zone was
system administration, right,

50
00:02:40,960 --> 00:02:42,228
and knowing how systems work.

51
00:02:42,228 --> 00:02:43,696
So I did believe that right,

52
00:02:43,696 --> 00:02:47,600
and I did all of the rookie
mistakes that you can do

53
00:02:47,600 --> 00:02:49,636
when you do your
first case, right.

54
00:02:49,636 --> 00:02:52,805
I was on my own, I
logged into the server

55
00:02:52,805 --> 00:02:56,042
and this is you know, live
forensics at its best.

56
00:02:56,042 --> 00:02:58,077
I would not do
that today, right.

57
00:02:58,077 --> 00:03:00,480
Logging into the server
while we probably

58
00:03:00,480 --> 00:03:03,583
had a active attacker
on the server.

59
00:03:03,583 --> 00:03:07,353
But I figure out kind
of what happened there.

60
00:03:07,353 --> 00:03:09,722
And it worked, and I got
kind of excited about it

61
00:03:09,722 --> 00:03:12,458
because I could use
my normal tools,

62
00:03:12,458 --> 00:03:14,694
I could use the tools that
I was used to use, right.

63
00:03:14,694 --> 00:03:17,897
So I had my Unix toolbox
with all of the things,

64
00:03:17,897 --> 00:03:20,566
like sed, grep, or in strings,

65
00:03:20,567 --> 00:03:22,402
and we all know that
strings is probably

66
00:03:22,402 --> 00:03:25,838
one of the best forensic
tools out there.

67
00:03:27,006 --> 00:03:28,741
So I could use this,
and it got me excited,

68
00:03:28,741 --> 00:03:31,544
and I remember this now
thinking back for this case,

69
00:03:31,544 --> 00:03:34,147
I still get that kind of
excitement, that feeling,

70
00:03:34,147 --> 00:03:37,716
because I was in control,
and the tools helped me

71
00:03:37,717 --> 00:03:41,387
be in control, and that
was a great feeling.

72
00:03:43,456 --> 00:03:45,625
Because that is
what it is about,

73
00:03:45,625 --> 00:03:47,827
being a system
administrator, right?

74
00:03:47,827 --> 00:03:49,362
You just make it work, right.

75
00:03:49,362 --> 00:03:52,298
So I grabbed my duct tape
and started gluing things

76
00:03:52,298 --> 00:03:54,367
together, right, because
this one small fire

77
00:03:54,367 --> 00:03:58,137
of course became many
more fires, right,

78
00:03:58,137 --> 00:04:02,242
because the attacker
moved throughout the
network and so on.

79
00:04:03,376 --> 00:04:05,278
So my approach with
logging into the server

80
00:04:05,278 --> 00:04:07,280
and doing this live didn't
really cut it, right,

81
00:04:07,280 --> 00:04:09,782
so I had to try to scale this.

82
00:04:11,184 --> 00:04:13,085
So what I did was, you know
go out on the internet,

83
00:04:13,086 --> 00:04:14,554
figuring out what to do,

84
00:04:14,554 --> 00:04:18,558
and I kind of started
imaging the boxes instead,

85
00:04:18,558 --> 00:04:22,161
talking to people, have them
image and send them to me.

86
00:04:22,161 --> 00:04:24,330
Put this in central
location, so I could script

87
00:04:24,330 --> 00:04:26,065
my way around, right.

88
00:04:27,433 --> 00:04:29,469
I could put all the
manual steps in a script,

89
00:04:29,469 --> 00:04:33,640
and do that for me, so
basically just make it work.

90
00:04:38,978 --> 00:04:43,082
All right, so let's
fast forward many years,

91
00:04:43,082 --> 00:04:45,318
and I started
working for Google,

92
00:04:45,318 --> 00:04:48,988
and I didn't know what to
expect when I started there,

93
00:04:48,988 --> 00:04:53,726
kind of how how do they
approach forensics at Google?

94
00:04:53,726 --> 00:04:55,461
I didn't really know.

95
00:04:58,398 --> 00:05:00,066
But I was happily surprised,

96
00:05:00,066 --> 00:05:02,301
because they did
the exact same thing

97
00:05:02,302 --> 00:05:06,105
that I have been
doing for many years.

98
00:05:06,105 --> 00:05:07,740
They were using
open source tools,

99
00:05:07,740 --> 00:05:10,176
they were using existing
tools out there,

100
00:05:10,176 --> 00:05:13,913
and they glued it
together to a toolbox

101
00:05:13,913 --> 00:05:16,482
that was really awesome.

102
00:05:16,482 --> 00:05:19,652
So I felt just like home, it
was basically what I've done

103
00:05:19,652 --> 00:05:20,919
for many years.

104
00:05:21,854 --> 00:05:23,356
So that was great.

105
00:05:24,991 --> 00:05:28,094
Google has challenges, and
we share these challenges

106
00:05:28,094 --> 00:05:31,230
with many others
in our industry.

107
00:05:31,230 --> 00:05:33,900
First off is the technical
scale, of course, right.

108
00:05:33,900 --> 00:05:37,070
It's just not one computer
anymore, or a couple of them,

109
00:05:37,070 --> 00:05:40,606
we have, it's more
than one computer.

110
00:05:40,606 --> 00:05:43,443
And that is a
challenge in itself.

111
00:05:45,111 --> 00:05:48,981
But we are also a company
who has valuable information,

112
00:05:48,981 --> 00:05:50,516
and when you have
valuable information

113
00:05:50,516 --> 00:05:54,587
you have attackers that know a
thing or two about computers,

114
00:05:55,922 --> 00:05:57,457
and when you have an
attacker that know something

115
00:05:57,457 --> 00:05:59,158
about computers,
they will move fast.

116
00:05:59,158 --> 00:06:02,061
They will move fast
in your network,

117
00:06:02,061 --> 00:06:04,996
and you have to be
able to keep up.

118
00:06:06,566 --> 00:06:10,703
As a response team, you
have to be able to keep up

119
00:06:10,703 --> 00:06:13,472
or be faster than
your attackers.

120
00:06:15,975 --> 00:06:19,379
We also have another
challenge at Google,

121
00:06:20,813 --> 00:06:24,616
and that is that we are
a very distributed team.

122
00:06:24,617 --> 00:06:27,286
We're working across time zones,

123
00:06:29,122 --> 00:06:30,723
and this is a
challenge in itself,

124
00:06:30,723 --> 00:06:32,658
because to be able to
scale our forensics,

125
00:06:32,658 --> 00:06:34,594
and I thought about this
when I started at Google.

126
00:06:34,594 --> 00:06:36,996
We had awesome tools,
and we were using,

127
00:06:36,996 --> 00:06:40,566
I will talk about some
of them a bit later,

128
00:06:42,402 --> 00:06:43,336
but I was thinking about this.

129
00:06:43,336 --> 00:06:44,871
How can we scale this?

130
00:06:44,871 --> 00:06:48,674
How can we be able to move
as fast as attackers does?

131
00:06:50,076 --> 00:06:51,411
And I came to the conclusion
that we need to do this

132
00:06:51,411 --> 00:06:53,913
with collaboration
and communication,

133
00:06:53,913 --> 00:06:57,116
because every second
matters, right.

134
00:06:57,116 --> 00:06:59,051
It's not days anymore
counting in response,

135
00:06:59,051 --> 00:07:00,753
you have to do this in hours,

136
00:07:00,753 --> 00:07:04,357
and most of the time
in minutes or seconds,

137
00:07:05,825 --> 00:07:09,027
and every second counts, and
every context switch hurts,

138
00:07:09,028 --> 00:07:11,998
because whenever you have
to hand over information

139
00:07:11,998 --> 00:07:15,134
to your colleagues, right,
we are a distributed team

140
00:07:15,134 --> 00:07:17,570
and we are a pretty big team.

141
00:07:20,406 --> 00:07:22,708
But as soon as you try
to hand over, you know,

142
00:07:22,708 --> 00:07:24,577
you have your state of
mind and you know this,

143
00:07:24,577 --> 00:07:27,013
doing forensics, right,
you have state in your mind

144
00:07:27,013 --> 00:07:28,881
when you doing your
forensics, try to figuring out

145
00:07:28,881 --> 00:07:30,582
and problem-solving,

146
00:07:30,583 --> 00:07:33,019
and dumping that information
down so anyone else

147
00:07:33,019 --> 00:07:35,521
can take it over
and run with it,

148
00:07:35,521 --> 00:07:38,558
that takes time and you
will lose bits and pieces

149
00:07:38,558 --> 00:07:42,028
if you don't have great
tools that help you.

150
00:07:42,028 --> 00:07:44,363
So I was thinking about
this and kind of came to

151
00:07:44,363 --> 00:07:46,265
the conclusion
that collaboration,

152
00:07:46,265 --> 00:07:49,801
and we need to have
collaboration as
part of the design

153
00:07:49,802 --> 00:07:51,637
for all of the tools
that we are building,

154
00:07:51,637 --> 00:07:54,874
and all of the tools
that we are using.

155
00:07:57,443 --> 00:07:59,679
All right, so before
we talk about tools,

156
00:07:59,679 --> 00:08:01,546
I'm passionate about tools
because I build tools

157
00:08:01,547 --> 00:08:05,751
and I like to take other
people's open source tools

158
00:08:05,751 --> 00:08:07,219
and use them and so on.

159
00:08:07,220 --> 00:08:09,655
I will talk about that,
but before we go into tools

160
00:08:09,655 --> 00:08:12,058
I want to talk about
incident management.

161
00:08:12,058 --> 00:08:15,561
So this is the
coordination part,

162
00:08:15,561 --> 00:08:18,063
which is also a very
important ingredient

163
00:08:18,064 --> 00:08:22,602
when you try to scale
your forensic operations,

164
00:08:22,602 --> 00:08:25,438
because coordination
is key, right.

165
00:08:25,438 --> 00:08:28,274
And this was another thing
that I was happily surprised

166
00:08:28,274 --> 00:08:31,744
when I started aT Google,
because we have a long history

167
00:08:31,744 --> 00:08:35,581
and a very strong culture
around system administration.

168
00:08:35,581 --> 00:08:37,817
So we have team called
SRE, which stands for

169
00:08:37,817 --> 00:08:40,852
Site Reliability Engineering,
and these are the people

170
00:08:40,852 --> 00:08:42,921
that keeps our services
up and running,

171
00:08:42,922 --> 00:08:45,191
so makes sure that
Gmail never goes down,

172
00:08:45,191 --> 00:08:48,995
makes sure that Google
Search never goes down.

173
00:08:50,496 --> 00:08:53,165
But when things happen, and
bad things happen, right,

174
00:08:53,165 --> 00:08:55,767
if something goes
wrong, they're there

175
00:08:55,768 --> 00:08:58,938
and they are ready
to respond to that.

176
00:09:00,473 --> 00:09:03,175
And what they did was
taking inspiration from

177
00:09:03,175 --> 00:09:04,776
the physical world.

178
00:09:05,912 --> 00:09:08,981
Looking at the policemen
and fire fighters

179
00:09:08,981 --> 00:09:12,385
and rescue workers responding
to physical incidents

180
00:09:12,385 --> 00:09:14,654
and catastrophes and so on.

181
00:09:16,088 --> 00:09:18,324
Looking at the procedures
that they use there, right,

182
00:09:18,324 --> 00:09:21,928
and they use a system
that we call it IMAG,

183
00:09:23,529 --> 00:09:27,033
which is Incident
Management at Google,

184
00:09:27,033 --> 00:09:28,868
and it's all about
communication,

185
00:09:28,868 --> 00:09:32,572
and having a really
strong chain of command

186
00:09:32,572 --> 00:09:34,106
and procedures around that,

187
00:09:34,106 --> 00:09:37,643
because if police and fire
workers just gonna run around

188
00:09:37,643 --> 00:09:41,781
and do their own thing,
things will go badly.

189
00:09:41,781 --> 00:09:45,952
So what this is, and I'm not
gonna talk in detail about this

190
00:09:46,852 --> 00:09:49,387
and this is a simplified chart,

191
00:09:49,388 --> 00:09:53,459
but what it is is about
setting up a virtual team.

192
00:09:53,459 --> 00:09:57,295
You set up a virtual team
for incident response,

193
00:09:57,296 --> 00:09:59,732
with a set of chain of
command where you have

194
00:09:59,732 --> 00:10:01,867
in the top there you have
the Incident Commander,

195
00:10:01,867 --> 00:10:05,103
and this is the person
that is appointed the role

196
00:10:05,104 --> 00:10:07,773
of commanding the
whole incident.

197
00:10:07,773 --> 00:10:10,042
That person needs
to have an overview,

198
00:10:10,042 --> 00:10:12,778
an holistic view of
the whole response,

199
00:10:12,778 --> 00:10:15,214
coordinating different teams.

200
00:10:16,415 --> 00:10:18,250
At Google if they have
a service going down,

201
00:10:18,250 --> 00:10:20,586
that would be the
Incident Commander talking

202
00:10:20,586 --> 00:10:23,122
and coordinating all the
different engineering teams

203
00:10:23,122 --> 00:10:26,058
for example, to
solve this problem.

204
00:10:27,760 --> 00:10:29,829
And we figure from
the security team

205
00:10:29,829 --> 00:10:32,698
that we can translate this
into a security response,

206
00:10:32,698 --> 00:10:35,167
we can set up the same thing.

207
00:10:35,167 --> 00:10:37,103
So if we have a complicated
incident that needs

208
00:10:37,103 --> 00:10:41,741
a lot of coordination, we
use the same technique.

209
00:10:41,741 --> 00:10:44,610
So under the Incident Commander,
you set up different roles,

210
00:10:44,610 --> 00:10:46,245
and there are many
others that you can use,

211
00:10:46,245 --> 00:10:48,781
and if you're thinking
about setting up something

212
00:10:48,781 --> 00:10:52,117
similar in your organization,
you can tweak this.

213
00:10:52,118 --> 00:10:56,022
But what we almost always
need is an Operations Lead,

214
00:10:56,022 --> 00:10:57,957
because operations
is what we do,

215
00:10:57,957 --> 00:11:00,926
we're a tech-heavy company,
so it will almost always

216
00:11:00,926 --> 00:11:02,762
be an Operations Lead.

217
00:11:04,563 --> 00:11:06,432
And this is also
where you come in,

218
00:11:06,432 --> 00:11:08,701
and we as forensic
analysts come in.

219
00:11:08,701 --> 00:11:10,369
This is what we do,
we're gonna be under

220
00:11:10,369 --> 00:11:12,038
the Operations Lead.

221
00:11:13,239 --> 00:11:15,975
And our role is gonna be
to answer the questions

222
00:11:15,975 --> 00:11:18,978
that the Incident
Commander has for us,

223
00:11:18,978 --> 00:11:22,048
because he needs those
answers as quick as possible

224
00:11:22,048 --> 00:11:24,684
in order to make strategic
decisions about response,

225
00:11:24,684 --> 00:11:26,485
how to take the response
to the next step,

226
00:11:26,485 --> 00:11:27,987
and to resolve it.

227
00:11:30,456 --> 00:11:32,425
So we as forensic analysts
gonna report back up

228
00:11:32,425 --> 00:11:34,526
to our Operations Lead, and
they're gonna report back

229
00:11:34,527 --> 00:11:38,497
to the Incident Commander,
who then coordinates this.

230
00:11:38,497 --> 00:11:40,232
And to be able to
do that, again,

231
00:11:40,232 --> 00:11:42,068
we need really good tooling,

232
00:11:42,068 --> 00:11:46,172
we need tooling that works
for us, not against us,

233
00:11:46,172 --> 00:11:50,509
to have those answers
as quick as possible.

234
00:11:50,509 --> 00:11:53,646
There are other roles in this.

235
00:11:53,646 --> 00:11:55,281
Also you have
Communications Lead

236
00:11:55,281 --> 00:11:58,483
if you need to communicate with
internal or external users.

237
00:11:58,484 --> 00:11:59,719
You might need a Planning Lead

238
00:11:59,719 --> 00:12:02,822
if it's a really long
running incident.

239
00:12:02,822 --> 00:12:06,726
You might need that for
strategic decisions and so on,

240
00:12:06,726 --> 00:12:11,063
and you can scale this up
and down however you want.

241
00:12:11,063 --> 00:12:12,497
So one thing that I tell people

242
00:12:12,498 --> 00:12:13,766
if they want to implement
something like this,

243
00:12:13,766 --> 00:12:15,334
because this is an
issue, go and read up

244
00:12:15,334 --> 00:12:17,737
on the details of it,

245
00:12:17,737 --> 00:12:21,307
it's a very efficient system
for getting things done,

246
00:12:21,307 --> 00:12:23,809
is never mix the roles,
this is the pro tip, right.

247
00:12:23,809 --> 00:12:25,411
So even if you're an excellent,

248
00:12:25,411 --> 00:12:27,179
you know you think you're an
excellent Incident Commander

249
00:12:27,179 --> 00:12:28,914
and an Operations
Lead, you can do both,

250
00:12:28,914 --> 00:12:32,251
and I know most of
us can do both roles,

251
00:12:33,452 --> 00:12:34,720
but never do them
at the same time,

252
00:12:34,720 --> 00:12:36,555
because you will not be
excellent at doing them

253
00:12:36,555 --> 00:12:38,424
at the same time.

254
00:12:38,424 --> 00:12:40,192
You have to be excellent
at doing one of them.

255
00:12:40,192 --> 00:12:43,496
So if you are an Operations
Lead, you should do that.

256
00:12:43,496 --> 00:12:45,297
If you are a Forensic
Analyst, you should do that,

257
00:12:45,297 --> 00:12:47,967
and you should scope down
and your work should be that.

258
00:12:47,967 --> 00:12:49,435
Because that's how
the whole response

259
00:12:49,435 --> 00:12:51,270
is gonna be excellent.

260
00:12:54,306 --> 00:12:55,141
All right.

261
00:12:57,576 --> 00:13:00,846
That's about coordination and
it is a very important part,

262
00:13:00,846 --> 00:13:02,314
but I also want to
talk about tools

263
00:13:02,314 --> 00:13:05,050
because as I said, I'm very
passionate about tools,

264
00:13:05,050 --> 00:13:08,319
because tools is a
thing that helps us,

265
00:13:08,320 --> 00:13:12,358
that backs us up and helps
us doing a great response

266
00:13:12,358 --> 00:13:14,292
in the IMAG procedures.

267
00:13:16,862 --> 00:13:18,997
So when I talk about
and think about tools,

268
00:13:18,998 --> 00:13:22,368
I usually say that my
toolbox is not your toolbox,

269
00:13:22,368 --> 00:13:24,303
and my workflow is
not your workflow,

270
00:13:24,303 --> 00:13:25,805
and that is totally fine,

271
00:13:25,805 --> 00:13:29,108
because we all solve our
problems in different ways

272
00:13:29,108 --> 00:13:31,810
with different tools,
but hopefully we can get

273
00:13:31,811 --> 00:13:33,212
the same answers.

274
00:13:34,380 --> 00:13:35,581
And that is totally
fine, and I think that

275
00:13:35,581 --> 00:13:37,149
is a great feature.

276
00:13:40,920 --> 00:13:43,255
And it's also about
having flexible tools,

277
00:13:43,255 --> 00:13:46,559
and the tools should
work with you.

278
00:13:46,559 --> 00:13:49,795
You need to be able in
anger to change your tools

279
00:13:49,795 --> 00:13:52,997
and modify your tools or
combine them in new ways

280
00:13:52,998 --> 00:13:56,302
that make it possible
to answer the questions

281
00:13:56,302 --> 00:13:59,705
that you have with
that specific problem.

282
00:14:05,144 --> 00:14:07,413
So if I had this back in the
days when I did my first case,

283
00:14:07,413 --> 00:14:08,914
I would be super happy, right,

284
00:14:08,914 --> 00:14:13,686
but the ecosystem we have
today with open source tools

285
00:14:13,686 --> 00:14:15,821
is just amazing,
and I couldn't fit

286
00:14:15,821 --> 00:14:19,358
all of the logos up there,
there's so many good logos

287
00:14:19,358 --> 00:14:21,993
of the different projects.

288
00:14:21,994 --> 00:14:24,096
But I have a bunch of them.

289
00:14:24,096 --> 00:14:27,533
So we have tools,
open source tools for,

290
00:14:27,533 --> 00:14:29,835
you know, GRR as a live
forensic framework,

291
00:14:29,835 --> 00:14:31,670
we have Libyal, which
is all about parsing,

292
00:14:31,670 --> 00:14:35,107
and Plaso for timelining,
time sketch or analysis.

293
00:14:35,107 --> 00:14:37,910
But we also have MISP, which is,

294
00:14:37,910 --> 00:14:40,312
I bet most of you know
what it is, right,

295
00:14:40,312 --> 00:14:41,814
it is a threat-sharing platform,

296
00:14:41,814 --> 00:14:44,583
it's an open platform for
sharing threat intelligence.

297
00:14:44,583 --> 00:14:47,019
That is not forensics per se,

298
00:14:48,554 --> 00:14:52,223
but it helps us, right, it
helps us in our investigations

299
00:14:52,224 --> 00:14:56,395
to get that information and
integrate that into our tools.

300
00:14:58,264 --> 00:14:59,865
We also have O
Square from Facebook,

301
00:14:59,865 --> 00:15:02,001
which is a great tool for
finding badness on your network

302
00:15:02,001 --> 00:15:03,602
or patching, and
patching files is great

303
00:15:03,602 --> 00:15:07,172
when we want to do
forensics on our device.

304
00:15:08,807 --> 00:15:11,377
And you know we have, all
of us know about Sleuth Kit

305
00:15:11,377 --> 00:15:13,912
and Autopsy for
for disk forensics,

306
00:15:13,913 --> 00:15:16,048
amazing projects, right.

307
00:15:16,048 --> 00:15:19,184
We have Volatility
for memory analysis,

308
00:15:19,184 --> 00:15:22,454
which becomes more
important every day.

309
00:15:23,856 --> 00:15:25,658
These are great tools.

310
00:15:25,658 --> 00:15:28,093
But it's not only
about the big projects

311
00:15:28,093 --> 00:15:30,863
and the big
frameworks out there.

312
00:15:32,264 --> 00:15:34,199
It's also about all the small
tools that we build here,

313
00:15:34,199 --> 00:15:36,769
and there are a lot
of you building tools,

314
00:15:36,769 --> 00:15:39,471
putting it out there
and open sourcing.

315
00:15:39,471 --> 00:15:43,309
All the small scripts
that we have, right.

316
00:15:43,309 --> 00:15:45,310
Maybe we're just gluing
some tools together,

317
00:15:45,311 --> 00:15:49,481
but that's great because it's
creativity and it helps us.

318
00:15:53,886 --> 00:15:55,920
All right, so you hear me
talk about open source a lot,

319
00:15:55,921 --> 00:15:59,124
and why do I care so
much about open source

320
00:15:59,124 --> 00:16:00,726
and why do I think
it is important?

321
00:16:00,726 --> 00:16:03,662
Well, first off, I
think open source is,

322
00:16:03,662 --> 00:16:05,698
it's about building
together, right,

323
00:16:05,698 --> 00:16:09,601
and it's about having
fun and being creative

324
00:16:09,601 --> 00:16:11,103
with the tools that we have.

325
00:16:11,103 --> 00:16:15,174
And I mentioned this, that
a fantastic feeling is

326
00:16:16,342 --> 00:16:18,177
when someone else
uses your tool,

327
00:16:18,177 --> 00:16:20,546
even if it's just
a small script.

328
00:16:20,546 --> 00:16:24,116
But they use your tool in
a slightly different way

329
00:16:24,116 --> 00:16:27,619
or they're solving a different
problem with your tool.

330
00:16:27,619 --> 00:16:29,822
That's a great feeling,
because you step out of

331
00:16:29,822 --> 00:16:32,691
your bubble, and you step
out of your tunnel vision

332
00:16:32,691 --> 00:16:34,827
with your tools, that this
is the result that I get

333
00:16:34,827 --> 00:16:36,595
and I'm comfortable with that,

334
00:16:36,595 --> 00:16:38,197
but then you see someone
else using your tool

335
00:16:38,197 --> 00:16:39,631
in a completely different way,

336
00:16:39,631 --> 00:16:42,101
and it just opens
up and you can start

337
00:16:42,101 --> 00:16:45,537
getting more creativity
and understanding

338
00:16:46,438 --> 00:16:48,473
different use cases and so on.

339
00:16:48,474 --> 00:16:50,743
I think that's a great
aspect of open source,

340
00:16:50,743 --> 00:16:52,878
and it's not only
about the source,

341
00:16:52,878 --> 00:16:56,281
it's also about open,
right, and sharing.

342
00:16:58,117 --> 00:17:00,352
It also has other benefits,

343
00:17:04,156 --> 00:17:06,892
and that is about being
able to verify your source,

344
00:17:06,892 --> 00:17:09,728
and I know that there are
other ways of doing this.

345
00:17:09,728 --> 00:17:12,197
It's not just about
having the code available,

346
00:17:12,196 --> 00:17:16,300
but if I have a parser,
and I have new file format

347
00:17:16,300 --> 00:17:20,138
and I have a parser for it,
I want to understand how it,

348
00:17:20,138 --> 00:17:21,572
you know I want to be
able to reason about

349
00:17:21,573 --> 00:17:25,144
how this parser is looking
at this file format

350
00:17:25,144 --> 00:17:28,079
and giving me the
results that it does.

351
00:17:28,079 --> 00:17:30,983
I would like to be
able to understand why,

352
00:17:30,983 --> 00:17:32,818
because if I can do that
and I can be certain

353
00:17:32,818 --> 00:17:36,922
that this is actually correct,
I can reason about this.

354
00:17:36,922 --> 00:17:38,457
Then I can apply that to other,

355
00:17:38,457 --> 00:17:40,025
if I have a less
transparent system

356
00:17:40,025 --> 00:17:44,196
or a black box where I have
input and then I have output.

357
00:17:45,531 --> 00:17:48,500
I can verify the results,
and be confident,

358
00:17:48,500 --> 00:17:52,438
because maybe this black
box is a fantastic product,

359
00:17:52,438 --> 00:17:56,108
and I want to use it, but
then I can verify that

360
00:17:56,108 --> 00:17:59,178
and I can be confident that
it gives me the results

361
00:17:59,178 --> 00:18:01,180
that it's supposed to do.

362
00:18:03,882 --> 00:18:07,786
It's not only about the
source code being open.

363
00:18:09,154 --> 00:18:13,125
It's also about open
systems and integrations,

364
00:18:13,125 --> 00:18:17,629
because if I'm going to
be hit tomorrow with,

365
00:18:17,629 --> 00:18:22,101
you have to process
hundred images tomorrow,

366
00:18:22,101 --> 00:18:24,603
and if I'm stuck with
three computers in a corner

367
00:18:24,603 --> 00:18:27,973
with three dongles in
them, that restricts me

368
00:18:27,973 --> 00:18:30,375
to process on those
three computers,

369
00:18:30,375 --> 00:18:32,778
it's just gonna take so long.

370
00:18:34,012 --> 00:18:36,715
I need software that is
flexible and open enough

371
00:18:36,715 --> 00:18:39,551
that allows me to not
have those restrictions.

372
00:18:39,551 --> 00:18:44,456
If I want to spin up 500
CPUs in a cloud somewhere

373
00:18:44,456 --> 00:18:46,625
to do the processing, I
want to be able to do that,

374
00:18:46,625 --> 00:18:48,427
and open systems give you that,

375
00:18:48,427 --> 00:18:51,530
and open source gives you that.

376
00:18:51,530 --> 00:18:53,565
And don't take me
wrong, there are amazing

377
00:18:53,565 --> 00:18:57,703
commercial software out
there that do amazing things,

378
00:18:57,703 --> 00:19:01,139
and when I look at them,
I look at how can I

379
00:19:01,140 --> 00:19:02,774
integrate this into my workflow.

380
00:19:02,774 --> 00:19:04,943
That's also important
for us to think about.

381
00:19:04,943 --> 00:19:08,046
When we buy a new software,
or when we are looking at

382
00:19:08,046 --> 00:19:09,882
new software, and it's not open,

383
00:19:09,882 --> 00:19:13,485
it has its restrictions,
but if you have

384
00:19:13,485 --> 00:19:17,488
great integration points,
API, well-defined API,

385
00:19:18,590 --> 00:19:20,391
you can start plugging
this system in,

386
00:19:20,392 --> 00:19:24,563
this amazing system into your
workflow and you can use it.

387
00:19:25,764 --> 00:19:26,697
That's important.

388
00:19:26,698 --> 00:19:28,200
So this is open source for me,

389
00:19:28,200 --> 00:19:30,369
and also I'm a bit biased
because, as I mentioned,

390
00:19:30,369 --> 00:19:31,837
I come from the
university world,

391
00:19:31,837 --> 00:19:34,473
and that's the de facto standard
of how you develop software

392
00:19:34,473 --> 00:19:36,707
is open source, and
you're just happy if

393
00:19:36,708 --> 00:19:38,577
someone else uses your software,

394
00:19:38,577 --> 00:19:40,512
so I'm a bit biased.

395
00:19:40,512 --> 00:19:42,614
I believe in open source,
and I think that we have

396
00:19:42,614 --> 00:19:44,616
a great community
where we are building

397
00:19:44,616 --> 00:19:47,352
a lot of great
open source tools.

398
00:19:50,055 --> 00:19:52,191
All, right so I'm gonna talk
about some specific tools

399
00:19:52,191 --> 00:19:53,692
because I like it.

400
00:19:55,394 --> 00:19:57,362
We're gonna talk about GRR.

401
00:19:57,362 --> 00:20:00,866
And I say here that what we
are trying to solve here,

402
00:20:00,866 --> 00:20:04,169
I just need a file, and that
is actually not fair to GRR,

403
00:20:04,169 --> 00:20:05,837
because GRR is so much more.

404
00:20:05,837 --> 00:20:08,307
So GRR, for those
who don't know,

405
00:20:08,307 --> 00:20:12,444
is a live forensic
framework and a system.

406
00:20:12,444 --> 00:20:15,080
It gives you the
ability to have,

407
00:20:15,080 --> 00:20:16,380
so remember back when
in my first case,

408
00:20:16,381 --> 00:20:18,083
when I logged onto the server

409
00:20:18,083 --> 00:20:20,752
and I did super live
response, right,

410
00:20:20,752 --> 00:20:23,455
side by side with that hacker.

411
00:20:23,455 --> 00:20:25,957
I could do this with GRR
today, but without doing that,

412
00:20:25,958 --> 00:20:27,659
doing it the right way.

413
00:20:27,659 --> 00:20:30,229
Because it's an agent
base, you have an end point

414
00:20:30,229 --> 00:20:32,164
and you have a server,
and the server can send

415
00:20:32,164 --> 00:20:35,533
asynchronous messages
to the end points

416
00:20:35,534 --> 00:20:38,470
and asking for actions,
we call them flows.

417
00:20:38,470 --> 00:20:40,372
So a flow could be for example,

418
00:20:40,372 --> 00:20:43,575
list this directory for
me, or fetch this file,

419
00:20:43,575 --> 00:20:46,912
or fetch this specific artifact,

420
00:20:46,912 --> 00:20:48,947
and all of that will be
rendered on the server side

421
00:20:48,947 --> 00:20:51,049
with a collaborated interface,

422
00:20:51,049 --> 00:20:53,952
where many analysts
can go in and they can

423
00:20:53,952 --> 00:20:56,288
analyze the system as if
they were on the system,

424
00:20:56,288 --> 00:20:59,291
but they never touch
the end system.

425
00:21:01,860 --> 00:21:03,661
It's also very great
for us in forensics

426
00:21:03,662 --> 00:21:06,965
to be able to hook this
up into our workflows,

427
00:21:06,965 --> 00:21:08,699
because it's a great
collection engine.

428
00:21:08,700 --> 00:21:10,902
So GRR is more than
a collection engine,

429
00:21:10,902 --> 00:21:14,006
but let's call it that for now.

430
00:21:14,006 --> 00:21:16,642
It has a feature called
artifact, an artifact report,

431
00:21:16,642 --> 00:21:20,412
so what that means is, we
have an open repository,

432
00:21:20,412 --> 00:21:23,682
it's up on GitHub with
artifact definition,

433
00:21:23,682 --> 00:21:25,317
and these are basically
just pointers to

434
00:21:25,317 --> 00:21:29,588
where to find specific
files on specific platforms,

435
00:21:29,588 --> 00:21:31,757
but the end user
experience for us is great,

436
00:21:31,757 --> 00:21:34,826
because as an analyst, I
don't have to care about

437
00:21:34,826 --> 00:21:36,962
where to find a file, I
just tell the system that,

438
00:21:36,962 --> 00:21:40,966
please give me, for example,
all the browser history files

439
00:21:40,966 --> 00:21:42,333
from this host.

440
00:21:42,334 --> 00:21:44,136
And it will figure
out the platform,

441
00:21:44,136 --> 00:21:46,071
it will figure out
where to find the files

442
00:21:46,071 --> 00:21:48,106
for all of the
users on the system,

443
00:21:48,106 --> 00:21:49,474
and it will figure out
where the different

444
00:21:49,474 --> 00:21:53,178
browser history files
are for Firefox, Chrome,

445
00:21:53,178 --> 00:21:56,515
Internet Explorer
and all of them.

446
00:21:56,515 --> 00:21:58,383
So as an end user, it's
great, I just tell it,

447
00:21:58,383 --> 00:22:00,886
give me that data so
I can analyze that,

448
00:22:00,886 --> 00:22:03,455
and you figure out where it is.

449
00:22:06,825 --> 00:22:10,495
GRR is also very extensible and
scriptable and customizable,

450
00:22:10,495 --> 00:22:13,165
and it has a great API, again.

451
00:22:13,165 --> 00:22:15,567
It is open source, but
it also has a great API,

452
00:22:15,567 --> 00:22:19,237
so you can hook this
up into your workflows.

453
00:22:21,673 --> 00:22:24,609
All right, so now we have,
say that we have collected

454
00:22:24,609 --> 00:22:28,013
these artifacts, say that
we have maybe collected

455
00:22:28,013 --> 00:22:31,316
some registry hives, event
logs, Plaso history files,

456
00:22:31,316 --> 00:22:32,484
maybe the MFT.

457
00:22:34,453 --> 00:22:35,721
Now we need to do
something with that.

458
00:22:35,721 --> 00:22:37,689
Now we need to process
this so we can actually

459
00:22:37,689 --> 00:22:40,225
extract something,
and I'm a big,

460
00:22:40,225 --> 00:22:42,159
as in the introduction
they said this,

461
00:22:42,160 --> 00:22:44,363
I'm a big timeline fan, right.

462
00:22:44,363 --> 00:22:46,164
I like timelines,
this is how I work,

463
00:22:46,164 --> 00:22:47,666
this is how my
brain works, right.

464
00:22:47,666 --> 00:22:49,935
I want to see what
happened on the system,

465
00:22:49,935 --> 00:22:53,238
so many systems, you
know at a point in time,

466
00:22:53,238 --> 00:22:55,607
and understand, and
step back right,

467
00:22:55,607 --> 00:22:58,410
and figuring out what, for
example what an attacker did

468
00:22:58,410 --> 00:22:59,578
on the system.

469
00:23:01,046 --> 00:23:02,848
And to be able to do this, we
need to parse a lot of files,

470
00:23:02,848 --> 00:23:04,282
we need to parse data.

471
00:23:04,282 --> 00:23:07,085
So Plaso is a framework
for exactly that.

472
00:23:07,085 --> 00:23:09,654
It comes from a very old
project called log2timeline.

473
00:23:09,654 --> 00:23:11,556
This was a Perl script
back in the day,

474
00:23:11,556 --> 00:23:13,091
and I actually learned yesterday

475
00:23:13,091 --> 00:23:15,593
that it was actually from
SANS that this came from,

476
00:23:15,594 --> 00:23:19,464
that the idea came
from in the beginning.

477
00:23:19,464 --> 00:23:21,332
It was my colleague
Kristinn Gudjonsson

478
00:23:21,333 --> 00:23:23,602
who wrote the first
Perl script for that.

479
00:23:23,602 --> 00:23:26,938
Then we hired him and told
him to rewrite it in Python,

480
00:23:26,938 --> 00:23:30,041
but that's when
Plaso became a thing.

481
00:23:32,878 --> 00:23:35,847
And it's amazing, because
you just point it to data

482
00:23:35,847 --> 00:23:37,649
that could be full disk
image, for example.

483
00:23:37,649 --> 00:23:39,283
It will figure out
everything for you,

484
00:23:39,284 --> 00:23:43,355
what OS it is, what parsers
to run and so on and so forth.

485
00:23:43,355 --> 00:23:45,390
But you can also point
it to a set of files,

486
00:23:45,390 --> 00:23:47,058
just parse those
files and create

487
00:23:47,058 --> 00:23:50,095
timestamp event out of that.

488
00:23:50,095 --> 00:23:53,532
So Plaso is built up
around a bunch of parsers

489
00:23:53,532 --> 00:23:55,300
for understanding
different file formats

490
00:23:55,300 --> 00:23:57,068
and log files and so on,

491
00:23:57,068 --> 00:23:59,304
and output modules
for outputting

492
00:23:59,304 --> 00:24:02,908
this resulting pile
of events that we get

493
00:24:02,908 --> 00:24:05,075
into useful format for us.

494
00:24:08,046 --> 00:24:10,816
The fourth one you
see is a CSV file,

495
00:24:10,816 --> 00:24:13,218
but there are others, there
are others for different

496
00:24:13,218 --> 00:24:15,620
databases and so on, and I
will talk about that a bit

497
00:24:15,620 --> 00:24:17,889
when we come to Timesketch.

498
00:24:20,292 --> 00:24:22,660
All right, so we cannot
really talk about Plaso

499
00:24:22,661 --> 00:24:23,962
without talking about Libyal,

500
00:24:23,962 --> 00:24:28,066
and this is known by
some, but not by many.

501
00:24:28,066 --> 00:24:30,168
It's an amazing
collection of libraries.

502
00:24:30,168 --> 00:24:32,904
So this is my
colleague Joachim Metz,

503
00:24:32,904 --> 00:24:36,141
who has written more
than 60 libraries

504
00:24:36,141 --> 00:24:38,643
for parsing different
file formats,

505
00:24:38,643 --> 00:24:41,313
for understanding how DSS works,

506
00:24:43,882 --> 00:24:47,719
and you can integrate that
into your other programs.

507
00:24:47,719 --> 00:24:50,322
It's an amazing collection,
it's basically all the libraries

508
00:24:50,322 --> 00:24:52,323
that you will ever need.

509
00:24:53,892 --> 00:24:55,794
So if you want to
parse a event log,

510
00:24:55,794 --> 00:24:57,329
if you want to parse
a registry file,

511
00:24:57,329 --> 00:25:00,831
if you want to parse different
file formats out there,

512
00:25:00,832 --> 00:25:02,734
you can turn to Libyal,
and this is actually

513
00:25:02,734 --> 00:25:06,705
on of my tips for people
coming into digital forensics

514
00:25:06,705 --> 00:25:10,574
and especially open
source digital forensics,

515
00:25:10,575 --> 00:25:11,843
is to take a look at Libyal.

516
00:25:11,843 --> 00:25:14,846
All of them, all
of these libraries,

517
00:25:16,281 --> 00:25:18,350
have the tools
together with them,

518
00:25:18,350 --> 00:25:20,385
so when you compile
it you'll get a tool

519
00:25:20,385 --> 00:25:22,988
and you can use that in your
bash script to automate things,

520
00:25:22,988 --> 00:25:26,558
or unencrypting a
encrypted disk image,

521
00:25:26,558 --> 00:25:28,460
if you have a rescue
key for example,

522
00:25:28,460 --> 00:25:32,264
list and access all of
the volume shadow copies.

523
00:25:32,264 --> 00:25:35,266
All of this is
possible with Libyal.

524
00:25:36,701 --> 00:25:39,604
And this also what underpins
most of the parsers in Plaso,

525
00:25:39,604 --> 00:25:41,106
so that's why I
want to bring it up.

526
00:25:41,106 --> 00:25:42,340
This is an amazing collection,

527
00:25:42,340 --> 00:25:45,709
and I recommend you
to take a look at it.

528
00:25:48,580 --> 00:25:51,649
All right, so as
amazing as Plaso is,

529
00:25:54,586 --> 00:25:56,154
it gives you a lot of data.

530
00:25:56,154 --> 00:25:58,390
For a normal Windows
system we extract

531
00:25:58,390 --> 00:26:00,992
around four to five
million events, depending,

532
00:26:00,992 --> 00:26:02,994
or equal more than that.

533
00:26:05,063 --> 00:26:07,399
And the default output
format is CSV files,

534
00:26:07,399 --> 00:26:10,534
and that was the format
and that was the way

535
00:26:10,535 --> 00:26:12,437
we did analysis when I
started at Google, right,

536
00:26:12,437 --> 00:26:13,471
it was still there right.

537
00:26:13,471 --> 00:26:16,341
We had CSV files that we put out

538
00:26:16,341 --> 00:26:18,043
and we'd sed, grep
and awk through them,

539
00:26:18,043 --> 00:26:19,744
we'd slice and dice them,

540
00:26:19,744 --> 00:26:20,911
and filtering out
different things,

541
00:26:20,912 --> 00:26:24,449
put that into smaller
files and so on.

542
00:26:24,449 --> 00:26:26,718
And mainly this is kind of okay

543
00:26:26,718 --> 00:26:30,522
if you have a one-off, or
if you're the only analyst.

544
00:26:30,522 --> 00:26:32,256
It's still messy,
but it kind of works,

545
00:26:32,257 --> 00:26:35,527
and it is powerful,
don't get me wrong.

546
00:26:36,728 --> 00:26:38,496
But going back to how
do we scale forensics,

547
00:26:38,496 --> 00:26:42,100
well we scale forensics
with collaboration,

548
00:26:42,100 --> 00:26:44,101
and collaborating on
this is very difficult

549
00:26:44,102 --> 00:26:46,972
because you have
to share the file,

550
00:26:46,972 --> 00:26:48,206
you have to link them,
you have to understand

551
00:26:48,206 --> 00:26:51,642
what the files are,
and so on and so forth.

552
00:26:51,643 --> 00:26:54,980
Maybe you have to send the
grep command that you're using

553
00:26:54,980 --> 00:26:57,816
to your colleagues and so on.

554
00:26:57,816 --> 00:27:00,085
It doesn't really scale,
and this is where I actually

555
00:27:00,085 --> 00:27:03,021
started thinking
about Timesketch,

556
00:27:03,021 --> 00:27:05,223
or a system around
this, how can we build

557
00:27:05,223 --> 00:27:09,127
a collaborated system
around timeline analysis?

558
00:27:11,062 --> 00:27:12,397
So the first, and
this was very early on

559
00:27:12,397 --> 00:27:14,499
when I started at Google.

560
00:27:15,634 --> 00:27:17,469
The first thing that
I thought of was

561
00:27:17,469 --> 00:27:19,304
of course you just
put this in a database

562
00:27:19,304 --> 00:27:20,939
and be done with it, right?

563
00:27:20,939 --> 00:27:23,174
And that is fun, but
the problem is that

564
00:27:23,174 --> 00:27:26,311
Plaso extracts a lot of
rich information for you,

565
00:27:26,311 --> 00:27:31,015
and all of the different
parsers extract different data.

566
00:27:31,016 --> 00:27:33,952
Internally, that is
represented as a JSON document,

567
00:27:33,952 --> 00:27:37,122
a JSON object, and that
is very hard to model

568
00:27:37,122 --> 00:27:41,660
as a SQL schema if you want
to use a system like that.

569
00:27:41,660 --> 00:27:43,762
And back at the time when
I started thinking about it

570
00:27:43,762 --> 00:27:46,297
was very popular if
you know SQL databases,

571
00:27:46,297 --> 00:27:49,567
like you know,
document-stored databases.

572
00:27:49,567 --> 00:27:53,405
So I tried to put the
information from Plaso

573
00:27:53,405 --> 00:27:56,241
into MongoDB and RIAC
and other databases,

574
00:27:56,241 --> 00:27:58,243
open source databases.

575
00:27:58,243 --> 00:27:59,744
They're all amazing projects,
but they it didn't really

576
00:27:59,744 --> 00:28:04,049
solve my problem, because
I wanted to search my data,

577
00:28:04,049 --> 00:28:06,618
I wanted to be
able to explore it.

578
00:28:06,618 --> 00:28:08,186
This is how I work.

579
00:28:09,788 --> 00:28:13,191
And I wanted it to be
a collaborated system.

580
00:28:13,191 --> 00:28:16,828
So then I turned to
Lucene, which is a library

581
00:28:16,828 --> 00:28:18,930
for full-text indexing,

582
00:28:18,930 --> 00:28:23,101
and a system on top of
that called Elastic Search.

583
00:28:24,202 --> 00:28:26,271
And I was a bit
skeptical at the time.

584
00:28:26,271 --> 00:28:27,605
So how well would it scale?

585
00:28:27,605 --> 00:28:29,674
Would it scale to
all of the timelines

586
00:28:29,674 --> 00:28:30,908
that I needed to scale?

587
00:28:30,909 --> 00:28:32,544
Would I build one
big index that would

588
00:28:32,544 --> 00:28:34,112
explode over time, right?

589
00:28:34,112 --> 00:28:38,850
And how long would it take to
ingest all of these events?

590
00:28:38,850 --> 00:28:42,454
But you know, I hacked
away and I tried it out,

591
00:28:42,454 --> 00:28:45,456
so I built a output
module for Plaso

592
00:28:46,624 --> 00:28:48,059
for outputting the
internal state,

593
00:28:48,059 --> 00:28:50,862
so the JSON representation
of it directly into

594
00:28:50,862 --> 00:28:54,766
Elastic Search, and I
started playing with it.

595
00:28:54,766 --> 00:28:55,934
Just get a feel of it.

596
00:28:55,934 --> 00:28:57,869
And I used the built-in
exploration tool,

597
00:28:57,869 --> 00:29:00,871
it's called Kibana
for Elastic Search,

598
00:29:00,872 --> 00:29:03,308
and it was great,
because it turned out

599
00:29:03,308 --> 00:29:05,143
that I didn't have to
have one big index,

600
00:29:05,143 --> 00:29:08,179
I could spread the timelines
over many smaller indexes,

601
00:29:08,179 --> 00:29:09,781
and then I can
query across them,

602
00:29:09,781 --> 00:29:12,884
and it was still
really, really fast.

603
00:29:14,018 --> 00:29:16,955
It was also really fast
to ingest an index,

604
00:29:16,955 --> 00:29:19,491
because if that would have
take hours and hours and hours,

605
00:29:19,491 --> 00:29:21,559
it kind of defeat the purpose.

606
00:29:21,559 --> 00:29:23,461
But it was fast enough.

607
00:29:23,461 --> 00:29:25,130
So I got excited about this,

608
00:29:25,130 --> 00:29:28,500
playing around with Kibana,
but it had its limitations.

609
00:29:28,500 --> 00:29:32,137
It's an amazing tool
for data exploration,

610
00:29:32,137 --> 00:29:34,339
but I wanted something
that could help us,

611
00:29:34,339 --> 00:29:37,708
a collaborative tool
for timeline analysis,

612
00:29:37,709 --> 00:29:39,410
and that's where
Timesketch came.

613
00:29:39,410 --> 00:29:41,813
So I started building
my own front end

614
00:29:41,813 --> 00:29:44,215
to Elastic Search to do this,

615
00:29:47,652 --> 00:29:50,955
and it became this, right,
it's a rich interface,

616
00:29:50,955 --> 00:29:54,292
and this was kind of,
when you are having,

617
00:29:54,292 --> 00:29:57,227
I remember this, the
first big run I did was

618
00:29:57,228 --> 00:29:59,664
I ingested like 40 million
or 50 million events

619
00:29:59,664 --> 00:30:02,467
into Elastic Search, and
I started querying it,

620
00:30:02,467 --> 00:30:03,968
and it was so fast.

621
00:30:03,968 --> 00:30:07,105
I could get results and filter
results within milliseconds.

622
00:30:07,105 --> 00:30:08,873
And I started
thinking about this,

623
00:30:08,873 --> 00:30:11,709
how can I use this,
what does this give me?

624
00:30:11,709 --> 00:30:13,778
Well it give me the
possibility to build

625
00:30:13,778 --> 00:30:16,848
a really rich user
interfaces on top of it,

626
00:30:16,848 --> 00:30:18,917
that are specialized for
us, for our use cases

627
00:30:18,917 --> 00:30:20,685
in digital forensics?

628
00:30:22,887 --> 00:30:25,823
It is not a general purpose
tool, it's a tool for us,

629
00:30:25,824 --> 00:30:28,326
it's a tool for collaboration.

630
00:30:29,561 --> 00:30:31,629
So you see here, you
have features that

631
00:30:31,629 --> 00:30:35,033
if you're using other
systems like this,

632
00:30:35,033 --> 00:30:38,468
we have saved views that you
can share with your colleagues,

633
00:30:38,469 --> 00:30:41,773
you can annotate the events
with labels and stars

634
00:30:41,773 --> 00:30:43,942
and comment on them.

635
00:30:43,942 --> 00:30:46,845
You can work on the case
simultaneously with many users,

636
00:30:46,845 --> 00:30:50,081
all of your analysts can be
in the same investigation.

637
00:30:50,081 --> 00:30:53,283
So basically, instead of
handing over all of your state,

638
00:30:53,284 --> 00:30:55,587
you put your state
into this system

639
00:30:55,587 --> 00:30:58,623
that you have in your
head, and you offload that,

640
00:30:58,623 --> 00:31:00,792
and your fellow
colleagues can continue.

641
00:31:00,792 --> 00:31:04,329
So if you're in a massive
big investigation,

642
00:31:04,329 --> 00:31:08,733
you can just continue
working 24/7.

643
00:31:08,733 --> 00:31:11,069
And you know the feature
that putting timelines

644
00:31:11,069 --> 00:31:13,771
in its own indexes,
gives you the possibility

645
00:31:13,771 --> 00:31:17,709
to just colorize them, and
it's a super simple feature,

646
00:31:17,709 --> 00:31:20,912
but it's extremely powerful,
so you see how for example

647
00:31:20,912 --> 00:31:24,582
attackers move across
different systems.

648
00:31:24,582 --> 00:31:26,417
And doing
multi-timeline analysis

649
00:31:26,417 --> 00:31:30,588
was a great feeling when we
started building this system.

650
00:31:33,324 --> 00:31:34,993
And also you see
here, I like that,

651
00:31:34,993 --> 00:31:36,694
I call them time bubbles.

652
00:31:36,694 --> 00:31:39,030
So when you have, you know,
if you're sitting in Excel,

653
00:31:39,030 --> 00:31:41,633
for example, and you
have all of these rows

654
00:31:41,633 --> 00:31:44,102
with your timeline,
it's really hard to spot

655
00:31:44,102 --> 00:31:47,572
when you have big gaps
in the times, right?

656
00:31:47,572 --> 00:31:50,041
But with this, with
this really fast system,

657
00:31:50,041 --> 00:31:51,708
you're able to build
these interfaces

658
00:31:51,709 --> 00:31:53,244
where we can have time bubbles,

659
00:31:53,244 --> 00:31:55,545
saying that hey, seven days
went through here, right,

660
00:31:55,546 --> 00:31:57,282
because it's so fast.

661
00:31:59,050 --> 00:32:00,685
Timesketch has many
other features,

662
00:32:00,685 --> 00:32:04,222
and I recommend you
to go and take a look.

663
00:32:04,222 --> 00:32:06,391
I'm here until Saturday,
also, and I wrote the thing,

664
00:32:06,391 --> 00:32:10,395
so catch me afterwards
if you want to know more.

665
00:32:12,263 --> 00:32:14,331
All right, so automation.

666
00:32:16,100 --> 00:32:20,103
Now we have great
collection, right, with GRR.

667
00:32:20,104 --> 00:32:22,807
We have processing with
Plaso, which automates

668
00:32:22,807 --> 00:32:25,576
most of the processing for us.

669
00:32:25,576 --> 00:32:26,878
And we have analysis
in Timesketch,

670
00:32:26,878 --> 00:32:28,980
but you also need automation.

671
00:32:28,980 --> 00:32:30,882
Automation doesn't solve
all of your problems,

672
00:32:30,882 --> 00:32:34,118
but it solves repetitive
tasks for you.

673
00:32:34,118 --> 00:32:36,754
It give back time
to you as an analyst

674
00:32:36,754 --> 00:32:40,457
to do what is actually
important, and that is analysis.

675
00:32:40,458 --> 00:32:44,729
I don't want my fellow
colleagues and analysts,

676
00:32:44,729 --> 00:32:46,864
they don't have to know
about the command line flag

677
00:32:46,864 --> 00:32:48,266
to bulk extractor,

678
00:32:48,266 --> 00:32:50,201
or command line flags
to load the timeline.

679
00:32:50,201 --> 00:32:51,502
I don't really care.

680
00:32:51,502 --> 00:32:54,839
I think you can read a
manual page for that.

681
00:32:54,839 --> 00:32:56,640
I care for them to have
the data available to them,

682
00:32:56,641 --> 00:32:58,743
to be able to analyze it.

683
00:32:59,911 --> 00:33:02,947
And automation comes
into play there.

684
00:33:02,947 --> 00:33:05,683
So we have another open source
project called Turbinia,

685
00:33:05,683 --> 00:33:07,118
which tries to do this.

686
00:33:07,118 --> 00:33:09,120
So it's very, again, geared
towards our use cases

687
00:33:09,120 --> 00:33:13,291
for forensic processing of
evidence and digital artifacts.

688
00:33:16,427 --> 00:33:20,063
And we found this, that
the more you automate,

689
00:33:20,064 --> 00:33:23,401
the more time you get to
get automate even more.

690
00:33:23,401 --> 00:33:25,470
And then all of a
sudden, you end up with

691
00:33:25,470 --> 00:33:27,772
a lot of time doing
important things.

692
00:33:27,772 --> 00:33:29,506
So automation is important,

693
00:33:29,507 --> 00:33:32,577
and we should try to automate
most of the processing for us.

694
00:33:32,577 --> 00:33:34,979
And with the open systems
and open source systems

695
00:33:34,979 --> 00:33:36,614
that we have, we can build it,

696
00:33:36,614 --> 00:33:40,785
and we can build this and
scale this however we want.

697
00:33:42,887 --> 00:33:44,389
All right, so to wrap this up,

698
00:33:44,389 --> 00:33:47,891
and talk about what
have we covered today.

699
00:33:49,460 --> 00:33:51,963
I've talked about open
source and flexibility

700
00:33:51,963 --> 00:33:55,366
and building systems
without restrictions,

701
00:33:55,366 --> 00:33:57,635
and I think that is important.

702
00:33:57,635 --> 00:34:00,805
So imagine that you have to
do an investigation on this

703
00:34:00,805 --> 00:34:02,273
on this mainframe.

704
00:34:03,541 --> 00:34:05,743
Would your tools
be able to do that?

705
00:34:05,743 --> 00:34:06,977
Would you be ready for that?

706
00:34:06,978 --> 00:34:08,546
Would you be able to
change your tools,

707
00:34:08,545 --> 00:34:11,448
adapt your tools
to this situation?

708
00:34:12,850 --> 00:34:14,951
Now I want to ask
you if you tomorrow,

709
00:34:14,952 --> 00:34:18,890
if your workload gonna
increase 10X or 100X,

710
00:34:18,889 --> 00:34:20,792
will you be able to handle that?

711
00:34:20,792 --> 00:34:23,194
Will your tools be
able to back you up

712
00:34:23,194 --> 00:34:24,594
and help you with that?

713
00:34:24,594 --> 00:34:26,297
Or will they just be in the way?

714
00:34:26,297 --> 00:34:28,366
Because if your tools
gonna be in the way,

715
00:34:28,366 --> 00:34:30,935
and you can't handle that load,

716
00:34:32,402 --> 00:34:33,737
you should take a look at
the open source ecosystems

717
00:34:33,737 --> 00:34:35,605
out there, and we
can build this,

718
00:34:35,606 --> 00:34:38,443
and we can build this together.

719
00:34:38,443 --> 00:34:41,212
(dramatic music)

