1
00:00:00,734 --> 00:00:03,303
(quick shimmering)

2
00:00:11,478 --> 00:00:14,180
(audience applause)

3
00:00:14,180 --> 00:00:15,615
- And thank you
all for attending.

4
00:00:15,615 --> 00:00:18,118
Last year, this
presentation was all mine

5
00:00:18,118 --> 00:00:19,753
based on my own research.

6
00:00:19,753 --> 00:00:22,288
Over the last year, various
people reached out to me

7
00:00:22,288 --> 00:00:24,524
and said hey, what you're
doing is interesting.

8
00:00:24,524 --> 00:00:26,226
Can I work with you on that?

9
00:00:26,226 --> 00:00:28,128
And I really wanna
encourage more people to do,

10
00:00:28,128 --> 00:00:30,530
so this is a very large subject,

11
00:00:30,530 --> 00:00:34,667
no one person can
encapsulate it all.

12
00:00:34,667 --> 00:00:37,203
Greg Dominguez was
particularly helpful

13
00:00:37,203 --> 00:00:39,672
in putting together parts
of this presentation.

14
00:00:39,672 --> 00:00:42,175
Cindy also helped out with
a lot with the mobile stuff

15
00:00:42,175 --> 00:00:44,677
and getting information
extracted for me

16
00:00:44,677 --> 00:00:46,780
that I had no clue
how to go about.

17
00:00:46,780 --> 00:00:48,148
Some other people
also contributed.

18
00:00:48,148 --> 00:00:49,949
They wanted their
names left off.

19
00:00:49,949 --> 00:00:51,451
Again, it's a community effort.

20
00:00:53,820 --> 00:00:56,956
I'm up here as a
subject matter expert,

21
00:00:56,956 --> 00:01:01,861
but I'm not here telling you
things you don't already know

22
00:01:03,029 --> 00:01:03,763
or you can't find
out on your own.

23
00:01:05,197 --> 00:01:08,333
Most of the information
that's extracted from UAVs

24
00:01:08,334 --> 00:01:10,303
and the systems around them

25
00:01:10,303 --> 00:01:12,505
are extracted and
analyzed using tools

26
00:01:12,505 --> 00:01:14,941
or processes and procedures
that we already know.

27
00:01:16,409 --> 00:01:18,812
I used to close with this slide.

28
00:01:18,812 --> 00:01:21,146
And that was when I had
a 50 minute presentation.

29
00:01:21,147 --> 00:01:23,049
And I have to encapsulate
this whole thing down

30
00:01:23,049 --> 00:01:25,585
in 25 minutes, so I
flipped it around.

31
00:01:25,585 --> 00:01:28,387
My end goal on any investigation

32
00:01:28,388 --> 00:01:31,891
is to tie as many different
artifacts together

33
00:01:31,891 --> 00:01:34,828
using forensic
artifacts and evidence

34
00:01:34,828 --> 00:01:37,263
to say here is what happened,

35
00:01:37,263 --> 00:01:40,500
here's all the evidence
to support my conclusion.

36
00:01:40,500 --> 00:01:44,604
So as many data points
as possible, bring
them all together.

37
00:01:44,604 --> 00:01:47,240
And not it's not the black
button, it's the up arrow.

38
00:01:48,274 --> 00:01:49,542
There we go.

39
00:01:49,542 --> 00:01:51,377
So the UAV is paired
with a controller.

40
00:01:52,812 --> 00:01:55,115
The UAV is also compared with
a ground control station,

41
00:01:55,115 --> 00:01:57,583
which is usually
a mobile device.

42
00:01:57,584 --> 00:01:59,052
All these things collect data

43
00:01:59,052 --> 00:02:02,255
that may be tagged in
some form or another.

44
00:02:02,255 --> 00:02:04,791
Something is used
to plan the mission.

45
00:02:04,791 --> 00:02:06,792
The sensor data
needs to be analyzed

46
00:02:06,793 --> 00:02:09,696
and then produced to the
client or to yourself,

47
00:02:09,696 --> 00:02:13,099
which means there has to be
unique IDs in here somewhere

48
00:02:13,099 --> 00:02:14,968
that tie all this
information together.

49
00:02:14,968 --> 00:02:16,935
Otherwise the
ecosystem falls apart.

50
00:02:18,938 --> 00:02:21,908
According to DJI, manufacturer

51
00:02:21,908 --> 00:02:25,210
of one of the most popular
UAVs or drones out there,

52
00:02:25,211 --> 00:02:27,213
there's no single serial number

53
00:02:27,213 --> 00:02:29,315
that ties all these
things together.

54
00:02:31,017 --> 00:02:34,420
Their explanation's here. It
seems a little bit vague to me.

55
00:02:34,420 --> 00:02:37,222
And we went off and proved
that they're not quite right.

56
00:02:38,825 --> 00:02:42,327
The Phantom 2 is the
picture on the left.

57
00:02:43,530 --> 00:02:45,665
They used to put the
IDs on the outside.

58
00:02:45,665 --> 00:02:46,733
It was very easy.

59
00:02:46,733 --> 00:02:48,001
They had a Mac address on there

60
00:02:48,001 --> 00:02:49,969
and they also had a
unique serial number.

61
00:02:52,172 --> 00:02:54,207
Over the last couple years,
they've actually made it

62
00:02:54,207 --> 00:02:57,609
more difficult to do
some forensic analysis.

63
00:02:57,610 --> 00:03:00,079
Some of these things
are now obfuscated

64
00:03:00,079 --> 00:03:02,348
on the new Phantom
3s and the Phantom 4,

65
00:03:02,348 --> 00:03:03,783
you see a lot of the
stuff on the right.

66
00:03:03,783 --> 00:03:06,819
And there are all these QR
codes and these random numbers,

67
00:03:06,819 --> 00:03:08,054
and they go to different things

68
00:03:08,054 --> 00:03:09,556
and some of them
are very difficult

69
00:03:09,556 --> 00:03:11,057
to figure out what they go to.

70
00:03:12,525 --> 00:03:16,996
But they've also provided us
with a wealth of information

71
00:03:16,996 --> 00:03:18,731
that was not available earlier,

72
00:03:18,731 --> 00:03:21,534
that make our analysis much
easier, we'll get into that.

73
00:03:23,002 --> 00:03:27,273
There's a UAV workflow
that I, as a UAV operator,

74
00:03:27,273 --> 00:03:29,008
go through every single mission.

75
00:03:29,008 --> 00:03:32,111
And some of it's formal,
and some of it I just do it

76
00:03:32,111 --> 00:03:34,012
because it's the
way I do things.

77
00:03:34,013 --> 00:03:35,782
There's the mission
planning step.

78
00:03:35,782 --> 00:03:38,685
There's an approval step that
may just be you checking in

79
00:03:38,685 --> 00:03:41,421
with yourself to say it's
okay, I wanna go fly this.

80
00:03:41,421 --> 00:03:44,624
Then you go fly it, then
you do the analysis on it.

81
00:03:44,624 --> 00:03:46,159
And the analysis may
just be publishing

82
00:03:46,159 --> 00:03:47,393
those pictures to Facebook,

83
00:03:47,393 --> 00:03:49,128
but you're still
doing that step.

84
00:03:49,128 --> 00:03:50,662
Oh sorry, that's the delivery.

85
00:03:50,663 --> 00:03:52,966
The analysis is saying do
I wanna deliver this stuff

86
00:03:52,966 --> 00:03:55,435
to Facebook, and then you
deliver it to Facebook.

87
00:03:57,904 --> 00:04:02,709
Each one of those
steps produces, or
potentially produces

88
00:04:02,709 --> 00:04:06,379
evidence or artifacts
that are useful to you.

89
00:04:08,047 --> 00:04:11,584
All of that UAV ecosystem
also has a lot of data flows

90
00:04:11,584 --> 00:04:13,453
that are also producing
a lot of artifacts

91
00:04:13,453 --> 00:04:15,321
that may be useful to you.

92
00:04:15,321 --> 00:04:18,825
The UAV is getting GPS
signals from the environment.

93
00:04:18,825 --> 00:04:21,493
It's uplinking
data to the cloud.

94
00:04:21,494 --> 00:04:25,031
It may be sending back telemetry
to the corporate network,

95
00:04:25,031 --> 00:04:27,634
or to DJI, which is not
your corporate network

96
00:04:27,634 --> 00:04:29,702
but is a corporate network.

97
00:04:29,702 --> 00:04:32,905
The ground control station
is talking to the UAV,

98
00:04:32,905 --> 00:04:35,808
the payload operator may
be talking to the UAV.

99
00:04:35,808 --> 00:04:38,945
The pilot and command
may be talking

100
00:04:38,945 --> 00:04:41,581
with the flight controller
via another mechanism.

101
00:04:41,581 --> 00:04:44,884
All these data flows are a
potential source of information.

102
00:04:46,052 --> 00:04:49,088
I use the Phantom 3
as an example UAV.

103
00:04:49,088 --> 00:04:50,757
There's not a lotta
good market data,

104
00:04:50,757 --> 00:04:53,926
but it's safe to say
that DJI products

105
00:04:53,926 --> 00:04:56,628
represent probably
between 30% and 60%

106
00:04:56,629 --> 00:04:59,198
of the U.S. consumer market.

107
00:05:01,034 --> 00:05:04,604
These are the physical
artifacts that are available,

108
00:05:04,604 --> 00:05:08,041
and that if you are
examining a UAV,

109
00:05:08,041 --> 00:05:10,276
you should go look for
these other artifacts

110
00:05:10,276 --> 00:05:12,578
if you do not already have them.

111
00:05:12,578 --> 00:05:14,681
We know that we need the UAV,

112
00:05:14,681 --> 00:05:17,082
the UAV's got a bunch of
processors, and memory,

113
00:05:17,083 --> 00:05:19,385
and other things on
board inside the shell,

114
00:05:19,385 --> 00:05:21,254
but it also is
gonna have a sensor,

115
00:05:21,254 --> 00:05:24,324
which is most often a
camera of some sort.

116
00:05:24,324 --> 00:05:29,329
There's a remote control
unit that is a necessity

117
00:05:30,196 --> 00:05:31,230
for operating these things.

118
00:05:31,230 --> 00:05:33,399
This is the manual control.

119
00:05:33,399 --> 00:05:35,768
Analyzing these
things is very tough

120
00:05:35,768 --> 00:05:37,503
but you still wanna collect it.

121
00:05:38,905 --> 00:05:41,640
There are batteries,
on the DJI products,

122
00:05:41,641 --> 00:05:43,710
those batteries actually
have a controller on them,

123
00:05:43,710 --> 00:05:45,311
and they've got a serial number,

124
00:05:45,311 --> 00:05:47,246
and you can examine
them to find out

125
00:05:47,246 --> 00:05:48,513
how much life is left on them,

126
00:05:48,514 --> 00:05:50,950
how many times
they've been charged.

127
00:05:50,950 --> 00:05:54,520
The biggest source of
information available

128
00:05:54,520 --> 00:05:58,724
is the ground control station,
this is the mobile device.

129
00:05:58,725 --> 00:06:02,195
It's really sexy to go analyze
all the embedded components

130
00:06:02,195 --> 00:06:04,197
and do JTAG analysis
and all this other stuff

131
00:06:04,197 --> 00:06:07,934
all on the UAV, I
love doing that stuff.

132
00:06:07,934 --> 00:06:11,471
The answer is 80%
of the information
you'll be looking for

133
00:06:11,471 --> 00:06:13,606
is gonna be on that
ground control station,

134
00:06:13,606 --> 00:06:15,608
and you already know
how to analyze that

135
00:06:15,608 --> 00:06:17,577
with open source
tools, mobile forensics

136
00:06:17,577 --> 00:06:21,447
that are taught by
Sans, Cellebrite, all
these other things.

137
00:06:21,447 --> 00:06:23,316
There's also sort
of back-end systems,

138
00:06:23,316 --> 00:06:25,251
which in my case is my laptop.

139
00:06:25,251 --> 00:06:27,352
Used for image processing,
uploading firmware

140
00:06:27,353 --> 00:06:28,855
and things like that.

141
00:06:28,855 --> 00:06:31,224
All together, those are
all the forensic artifacts

142
00:06:31,224 --> 00:06:33,058
that you wanna collect.

143
00:06:33,059 --> 00:06:36,662
Those physical artifacts
produce a large wealth

144
00:06:36,662 --> 00:06:38,563
of digital artifacts.

145
00:06:38,564 --> 00:06:40,633
This slide starts
talking about 'em.

146
00:06:41,667 --> 00:06:43,236
I'll make the slides available,

147
00:06:43,236 --> 00:06:44,736
you're welcome to go into it,

148
00:06:44,737 --> 00:06:46,639
but it's all the standard
stuff that we're looking at.

149
00:06:46,639 --> 00:06:48,608
Mobile operating systems,
all their artifacts.

150
00:06:48,608 --> 00:06:51,811
Traditional operating
systems, EPROMs, firmware,

151
00:06:51,811 --> 00:06:53,078
all that sorta stuff.

152
00:06:55,148 --> 00:06:57,750
JTAG analysis, last
year I was like okay,

153
00:06:57,750 --> 00:07:00,887
there's gotta be a wealth of
information on these chips.

154
00:07:00,887 --> 00:07:03,156
The answer is there probably
is a lot of information

155
00:07:03,156 --> 00:07:05,992
on these chips, I don't
know how to get to 'em yet.

156
00:07:05,992 --> 00:07:09,262
So if people are
interested in doing JTAG

157
00:07:09,262 --> 00:07:11,197
and things like that,
please reach out to me.

158
00:07:11,197 --> 00:07:14,233
I'll be happy to make
example UAVs available,

159
00:07:14,233 --> 00:07:17,570
whatever else you need to
chase down this sorta stuff.

160
00:07:19,439 --> 00:07:22,408
In the process of
doing the JTAG analysis

161
00:07:22,408 --> 00:07:25,611
we did tear a DJI
Phantom 3 apart.

162
00:07:25,611 --> 00:07:27,079
Some of these chips
are masked off,

163
00:07:27,079 --> 00:07:28,748
making it a little
more difficult.

164
00:07:28,748 --> 00:07:30,983
The GPS you can
open up and get to,

165
00:07:30,983 --> 00:07:34,554
but the biggest find
was on the casing

166
00:07:34,554 --> 00:07:37,089
on one of these chips,
there's a serial number.

167
00:07:38,758 --> 00:07:40,827
We didn't know the value
of that serial number

168
00:07:40,827 --> 00:07:42,462
until we were looking
at other artifacts

169
00:07:42,462 --> 00:07:43,962
and saying okay, I
got this string here,

170
00:07:43,963 --> 00:07:46,532
I don't know what it is,
where else does it appear?

171
00:07:46,532 --> 00:07:48,301
And there's no way
to go do a search

172
00:07:48,301 --> 00:07:50,937
through your artifacts
using GREP or anything

173
00:07:50,937 --> 00:07:52,538
looking for that image.

174
00:07:52,538 --> 00:07:54,373
We had to pay attention
to all these artifacts

175
00:07:54,373 --> 00:07:55,640
and keep 'em in our head.

176
00:07:56,943 --> 00:08:00,145
Phantom 2 had no logs available.

177
00:08:01,180 --> 00:08:03,850
Other flight controllers
produced logs.

178
00:08:03,850 --> 00:08:08,187
Phantom 3 now has extensive
data logging capability.

179
00:08:08,187 --> 00:08:10,490
People wanna know what
their UAVs are doing,

180
00:08:10,490 --> 00:08:12,191
they wanna know
how they crashed,

181
00:08:12,191 --> 00:08:14,926
this is your biggest
source of information.

182
00:08:14,927 --> 00:08:16,529
Most of the flight controllers

183
00:08:16,529 --> 00:08:18,264
have some sort of data
logging capabilities.

184
00:08:18,264 --> 00:08:20,333
Some is built in, such
as on the PixHawk.

185
00:08:20,333 --> 00:08:22,134
Other like the DJI Naza,

186
00:08:22,134 --> 00:08:25,404
you gotta get an
off-board data logger.

187
00:08:25,404 --> 00:08:27,139
Most of the ground
control stations

188
00:08:27,139 --> 00:08:30,009
have their own data
logging, bear that in mind.

189
00:08:30,009 --> 00:08:32,512
And the data logger's
essentially your black box.

190
00:08:33,479 --> 00:08:36,983
The Phantom 3 has a single file

191
00:08:36,982 --> 00:08:40,986
that's called Fly and a
series of numbers .DAT.

192
00:08:40,986 --> 00:08:44,457
The ground control station
creates its own log file

193
00:08:44,457 --> 00:08:47,126
and these are rotated
ala normal logs.

194
00:08:48,561 --> 00:08:53,533
It's stored on the Phantom
3 on four gigs SD card.

195
00:08:54,400 --> 00:08:56,569
It'll rotate those files out.

196
00:08:56,569 --> 00:09:01,307
You can get at that card
via booting up the UAV

197
00:09:01,307 --> 00:09:05,244
in a special mode and just
connecting to it via USB cable.

198
00:09:05,244 --> 00:09:08,214
Putting a write block on there
kinda interferes the process,

199
00:09:08,214 --> 00:09:11,450
so the best solution is
to pull the card off.

200
00:09:11,450 --> 00:09:15,855
That's the card, the locking
mechanism's epoxyed on.

201
00:09:15,855 --> 00:09:18,057
So you gotta go
open up the shell,

202
00:09:18,057 --> 00:09:20,026
clear that epoxy off,
pull the lock out

203
00:09:20,026 --> 00:09:21,426
and then you can
pull the cart out.

204
00:09:21,427 --> 00:09:23,629
It's really not rocket science.

205
00:09:23,629 --> 00:09:25,197
I can do it, you can do it.

206
00:09:27,800 --> 00:09:32,637
Though in those logs
you see this string,

207
00:09:32,638 --> 00:09:34,040
or a string like that.

208
00:09:34,040 --> 00:09:36,074
That was our first clue, MC ID.

209
00:09:36,075 --> 00:09:40,313
Master controller, main
controller, whatever ID.

210
00:09:40,313 --> 00:09:42,481
That ID is about five lines

211
00:09:42,481 --> 00:09:44,717
from the bottom
of that data file.

212
00:09:44,717 --> 00:09:48,254
It matches up with that string

213
00:09:48,254 --> 00:09:49,956
that's on top of the controller.

214
00:09:51,357 --> 00:09:54,392
Inside the DJI GO app,
the DJI's own application

215
00:09:54,393 --> 00:09:56,095
for controlling these things,

216
00:09:56,095 --> 00:09:59,065
in this particular file
that string shows up.

217
00:09:59,065 --> 00:10:01,334
Most of the mobile
device applications,

218
00:10:01,334 --> 00:10:03,102
that string shows up.

219
00:10:03,102 --> 00:10:05,805
It's on the main board, it
may be in the data string.

220
00:10:07,206 --> 00:10:11,744
There's a commercial,
it's not even commercial,

221
00:10:11,744 --> 00:10:15,081
it's a website called DatCon,

222
00:10:15,081 --> 00:10:18,451
and if you upload or
download their application

223
00:10:18,451 --> 00:10:21,020
and run that application
over that file,

224
00:10:21,020 --> 00:10:22,888
it'll produce a big CSV file,

225
00:10:22,888 --> 00:10:25,558
a KML file, useful
for Google Earth.

226
00:10:25,558 --> 00:10:29,261
A LOG file and a
config.txt file.

227
00:10:29,261 --> 00:10:33,733
That CSV file has an enormous
wealth of information in it.

228
00:10:33,733 --> 00:10:34,967
It'll tell you about the motors,

229
00:10:34,967 --> 00:10:36,235
it'll tell you
about the batteries,

230
00:10:36,235 --> 00:10:37,970
it'll tell you about all
these other artifacts,

231
00:10:37,970 --> 00:10:40,473
but it has a wealth of
GPS information in there

232
00:10:40,473 --> 00:10:43,575
that'll tell you about
where the aircraft has been,

233
00:10:43,576 --> 00:10:45,778
where it got launched
from and things like that.

234
00:10:45,778 --> 00:10:47,446
This is your key source of data.

235
00:10:50,149 --> 00:10:53,786
The event log, it's like
a Windows event log.

236
00:10:53,786 --> 00:10:56,021
It has got the boot
sequence in there,

237
00:10:56,022 --> 00:10:57,323
it'll show some of
the other things

238
00:10:57,323 --> 00:11:00,092
that are attached to
it, ala USB devices,

239
00:11:00,092 --> 00:11:02,828
primarily case of battery
barcode in this case.

240
00:11:02,828 --> 00:11:07,098
It also has the first home
point and lat, long point.

241
00:11:07,099 --> 00:11:09,769
You can now say okay,
where was this thing

242
00:11:09,769 --> 00:11:11,637
most often launched
or turned on?

243
00:11:13,105 --> 00:11:16,809
Configuration file, it's like
any other configuration file.

244
00:11:16,809 --> 00:11:19,411
Minute boot and
initialization information,

245
00:11:19,412 --> 00:11:21,747
it's got that MC ID in it again,

246
00:11:21,747 --> 00:11:24,583
it's got that ability
to say this log file

247
00:11:24,583 --> 00:11:26,117
goes with this airframe.

248
00:11:29,522 --> 00:11:32,758
Let's say that you have no UAV.

249
00:11:33,893 --> 00:11:35,394
You've got no mobile device.

250
00:11:36,595 --> 00:11:38,631
All you've got is
a bunch of images

251
00:11:38,631 --> 00:11:41,500
that you found on the guy's
computer, or the SD card.

252
00:11:42,935 --> 00:11:45,003
And it's not the SD
card on the main board,

253
00:11:45,004 --> 00:11:47,106
it's the SD card that
goes with the sensor.

254
00:11:48,140 --> 00:11:49,308
What can you do with it?

255
00:11:50,710 --> 00:11:53,379
Most of these UAVs, except
for the racing UAVs,

256
00:11:53,379 --> 00:11:54,714
first person view ones,

257
00:11:54,714 --> 00:11:57,083
are out there to collect
data of some form.

258
00:11:57,083 --> 00:11:58,550
They got a sensor on 'em,

259
00:11:58,551 --> 00:12:00,486
they're gonna be collecting
methane gas emissions,

260
00:12:00,486 --> 00:12:04,023
they're gonna be
collecting NDVI imagery,

261
00:12:04,023 --> 00:12:05,991
they'll be collecting
normal imagery.

262
00:12:05,991 --> 00:12:08,093
That imagery's really
only terribly useful

263
00:12:08,094 --> 00:12:09,595
if someone knows
where that imagery

264
00:12:09,595 --> 00:12:12,398
or that data came
from in real space,

265
00:12:12,398 --> 00:12:14,200
so it's gonna have
GPS coordinates.

266
00:12:14,200 --> 00:12:16,068
And it's gonna have
time information in it,

267
00:12:16,068 --> 00:12:18,504
because they wanna know
that this methane data

268
00:12:18,504 --> 00:12:22,074
came out three weeks
ago or three years ago.

269
00:12:22,074 --> 00:12:24,810
So just knowing what type
of sensor data you've got

270
00:12:24,810 --> 00:12:26,212
will tell you a lot

271
00:12:26,212 --> 00:12:27,680
about the intended
mission of this aircraft.

272
00:12:28,848 --> 00:12:31,983
The most common sensors
out there are optical.

273
00:12:31,984 --> 00:12:36,555
It's usually a GoPro, it's
usually the optical camera

274
00:12:36,555 --> 00:12:38,891
on a DJI or something like that.

275
00:12:38,891 --> 00:12:42,127
The artifacts that these produce
that are of interest to you

276
00:12:42,128 --> 00:12:44,396
are the image itself,
it's got a picture

277
00:12:44,396 --> 00:12:47,599
of the nuclear facility
near your house.

278
00:12:47,600 --> 00:12:49,101
Should it be there,
probably not.

279
00:12:49,101 --> 00:12:51,737
So just the image itself
tells you something.

280
00:12:51,737 --> 00:12:55,007
But the EXIF data, and
it's easy to collect,

281
00:12:55,007 --> 00:12:57,309
you just pull it
out of the camera.

282
00:12:57,309 --> 00:12:59,645
Does anybody here not know how

283
00:12:59,645 --> 00:13:03,783
to at least look at
EXIF data from an image?

284
00:13:03,783 --> 00:13:05,351
You can do it on a Mac,
you can do it on Windows,

285
00:13:05,351 --> 00:13:08,287
there's EXIF Tool,
it's easy to get to

286
00:13:08,287 --> 00:13:11,357
and it tells you an
awful lot of information.

287
00:13:11,357 --> 00:13:13,759
Tells you where the
image came from,

288
00:13:13,759 --> 00:13:15,194
it tells you the
camera model name

289
00:13:15,194 --> 00:13:18,697
which goes back, in this
case to a DJI product.

290
00:13:18,697 --> 00:13:21,000
It tells you the date
and time it was created.

291
00:13:22,401 --> 00:13:25,603
It used to be on the Phantom
2 that it only told you

292
00:13:25,604 --> 00:13:27,907
the GPS, latitude and longitude.

293
00:13:27,907 --> 00:13:29,441
And if you're trying
to prove that somebody

294
00:13:29,441 --> 00:13:33,279
was exceeding a threshold,
going too high or too low,

295
00:13:33,279 --> 00:13:35,314
wasn't terribly useful.

296
00:13:35,314 --> 00:13:38,117
They now put in GPS
altitude as well,

297
00:13:38,117 --> 00:13:39,752
so now we have that information.

298
00:13:41,854 --> 00:13:43,889
Using an EXIF data
and a Python script

299
00:13:43,889 --> 00:13:45,224
you can easily go
plot this stuff.

300
00:13:45,224 --> 00:13:46,492
So you can start saying okay,

301
00:13:46,492 --> 00:13:48,360
where were all these
pictures taken?

302
00:13:48,360 --> 00:13:50,229
And now what order
they were taken in,

303
00:13:50,229 --> 00:13:52,932
you now can generate
just from the images

304
00:13:52,932 --> 00:13:56,035
the flight path, what was
taken, when it was taken.

305
00:13:59,171 --> 00:14:01,907
All this information's
really kinda interesting,

306
00:14:03,509 --> 00:14:06,378
but, until you make
it available to others

307
00:14:06,378 --> 00:14:07,813
it's only interesting to you.

308
00:14:09,215 --> 00:14:10,883
You can post all this stuff,
you can post-process it

309
00:14:10,883 --> 00:14:12,785
and then upload that result.

310
00:14:12,785 --> 00:14:14,319
But a lot of these
consumer drones

311
00:14:14,320 --> 00:14:17,089
are now designed
to automatically

312
00:14:17,089 --> 00:14:19,124
make the information available.

313
00:14:19,124 --> 00:14:22,461
So they are able to directly
interact with YouTube,

314
00:14:22,461 --> 00:14:24,663
Facebook and other
social media sites.

315
00:14:26,131 --> 00:14:30,236
All of the commercial stuff
has a cloud component also.

316
00:14:30,236 --> 00:14:32,170
Drone Deploy, which is
one of the tools I use

317
00:14:32,171 --> 00:14:34,907
for doing surveying
and mapping like that,

318
00:14:34,907 --> 00:14:37,943
uploads all the flight
logs to Drone Deploy,

319
00:14:37,943 --> 00:14:40,478
uploads all the imagery,
does post-processing on it

320
00:14:40,479 --> 00:14:42,715
and gives you back a
digital elevation model

321
00:14:42,715 --> 00:14:44,216
of the whole thing.

322
00:14:44,216 --> 00:14:47,019
You need to go see what
applications they're using

323
00:14:47,019 --> 00:14:49,255
and go talk to the vendors
about getting that data back

324
00:14:49,255 --> 00:14:51,423
from them, another
wealth of data.

325
00:14:53,325 --> 00:14:55,227
Every one of these
apps I've used,

326
00:14:55,227 --> 00:14:58,130
I just fire up the
drone, I fire up the app.

327
00:14:58,130 --> 00:15:01,467
Not every one, almost all
of 'em, and away I go.

328
00:15:02,601 --> 00:15:04,436
Where are those
credentials stored?

329
00:15:05,838 --> 00:15:09,842
Probably not on the drone, most
likely on the mobile device.

330
00:15:09,842 --> 00:15:11,744
We're back to that
mobile device,

331
00:15:11,744 --> 00:15:13,345
there's a wealth of information.

332
00:15:16,048 --> 00:15:19,251
Ground control station
is the mobile device.

333
00:15:19,251 --> 00:15:21,587
The vast majority
of consumer UAVs

334
00:15:21,587 --> 00:15:26,191
use an Android or iOS device
and have a custom app.

335
00:15:26,191 --> 00:15:27,726
The vendors provide an app,

336
00:15:27,726 --> 00:15:29,662
but there are a lot of
third-party applications

337
00:15:29,662 --> 00:15:30,896
that are also used.

338
00:15:32,064 --> 00:15:33,632
Even the higher-end
commercial devices

339
00:15:33,632 --> 00:15:36,502
are actually running
on a custom Windows,

340
00:15:36,502 --> 00:15:40,805
or sometimes iOS tablet, we
know how to analyze those.

341
00:15:40,806 --> 00:15:45,210
What we're looking for
is planning information,

342
00:15:45,210 --> 00:15:46,812
did this person have the intent

343
00:15:46,812 --> 00:15:49,782
to go fly where we
found this thing?

344
00:15:49,782 --> 00:15:52,284
Flight telemetry data,
where did this thing fly

345
00:15:53,752 --> 00:15:56,521
and what was it doing when it
was flying through this space?

346
00:15:58,557 --> 00:15:59,758
We are looking for plans,

347
00:15:59,758 --> 00:16:02,127
we're looking where
it connects to,

348
00:16:02,127 --> 00:16:04,096
and we're trying to keep in mind

349
00:16:04,096 --> 00:16:07,166
that these are both
vendor applications,

350
00:16:07,166 --> 00:16:09,635
which they at least
have some sense

351
00:16:09,635 --> 00:16:11,403
of securing these things,

352
00:16:11,403 --> 00:16:14,006
and a lot of other people
writing applications

353
00:16:14,006 --> 00:16:16,875
who have a lot less interest
in securing what's going on.

354
00:16:18,077 --> 00:16:20,412
We're looking for
default settings,

355
00:16:20,412 --> 00:16:23,248
how did the person
configure this UAV?

356
00:16:23,248 --> 00:16:26,652
We're looking for
launch points and dates,

357
00:16:26,652 --> 00:16:28,187
where have they been flying?

358
00:16:28,187 --> 00:16:31,290
Have they been flying around
this nuclear facility a lot?

359
00:16:31,290 --> 00:16:33,125
Were they testing
this at home a lot?

360
00:16:34,293 --> 00:16:36,195
We're looking for the
owner name and account.

361
00:16:36,195 --> 00:16:38,030
We've got this
data, who owns it?

362
00:16:38,964 --> 00:16:41,600
So the DJI flight app,

363
00:16:41,600 --> 00:16:43,268
they've changed the
name of the application,

364
00:16:43,268 --> 00:16:45,037
there are a couple
different versions of it.

365
00:16:45,037 --> 00:16:47,339
It records a lot of
the data from the UAV.

366
00:16:47,339 --> 00:16:50,175
It's a subset of that
data that's in that log

367
00:16:50,175 --> 00:16:51,577
that we were talking about,

368
00:16:51,577 --> 00:16:54,079
so you can now correlate
between the two.

369
00:16:54,079 --> 00:16:56,714
It can contain thumbnail
images and video,

370
00:16:56,715 --> 00:16:59,218
and it contains
that MC ID number.

371
00:16:59,218 --> 00:17:02,221
You can parse it using the
tools that we're familiar with.

372
00:17:02,221 --> 00:17:04,490
There's the header,
there's the end of file,

373
00:17:04,490 --> 00:17:07,760
you can now start pulling out
all the JPG files from that.

374
00:17:09,294 --> 00:17:12,164
And there's another
online parser for this.

375
00:17:12,164 --> 00:17:14,233
So if you don't wanna go
analyze it by yourself,

376
00:17:14,233 --> 00:17:16,969
you can upload it and
this is what you get.

377
00:17:18,569 --> 00:17:21,106
You get a lot of information
about the aircraft.

378
00:17:21,106 --> 00:17:24,977
You get the flight path, you
get the name of the airplane,

379
00:17:24,977 --> 00:17:26,745
you get a bunch of other data.

380
00:17:26,744 --> 00:17:30,049
The person's address may even
be in the details section.

381
00:17:30,049 --> 00:17:34,420
So this is my flight path,
this is imagery from it,

382
00:17:34,420 --> 00:17:38,757
it's all available from
that mobile device.

383
00:17:38,757 --> 00:17:39,992
So now I don't have the images,

384
00:17:39,992 --> 00:17:41,293
you know, they're up
in the cloud somewhere,

385
00:17:41,293 --> 00:17:43,428
I haven't seen them, but
now I've got some images

386
00:17:43,429 --> 00:17:45,064
to go look for in the cloud.

387
00:17:45,064 --> 00:17:48,100
I don't have the UAV, but
I have the UAV's name.

388
00:17:48,100 --> 00:17:51,637
So if I ever find something
I can now tie it back.

389
00:17:51,637 --> 00:17:53,304
That's all available.

390
00:17:53,305 --> 00:17:56,141
We're working on taking some
of these cloud-based services

391
00:17:56,141 --> 00:17:59,111
and making a standalone
Python script

392
00:17:59,111 --> 00:18:00,579
for doing this sort of stuff,

393
00:18:00,579 --> 00:18:02,447
so you don't have to upload
your data to the cloud.

394
00:18:02,448 --> 00:18:03,649
It's a work-in-progress.

395
00:18:05,951 --> 00:18:07,753
These are three
different applications

396
00:18:07,753 --> 00:18:09,187
I use for flying UAVs.

397
00:18:09,188 --> 00:18:10,756
One's Drone Deploy
which I mentioned,

398
00:18:10,756 --> 00:18:13,692
one's Pix4D which is
image processing service,

399
00:18:13,692 --> 00:18:16,028
and one's a DJI application.

400
00:18:16,028 --> 00:18:19,064
Each one of these
has, as an example,

401
00:18:19,064 --> 00:18:20,532
some pieces of information.

402
00:18:20,532 --> 00:18:22,900
So that's one of my accounts
I use for Drone Deploy.

403
00:18:24,103 --> 00:18:28,173
On the DJI Pilot it
has my home location

404
00:18:28,173 --> 00:18:30,409
as the key aircraft location.

405
00:18:30,409 --> 00:18:32,711
You can go find
my house with it.

406
00:18:32,711 --> 00:18:36,448
It's also got
Facebook integration.

407
00:18:36,448 --> 00:18:40,686
Pix4D, it records where
waypoints were created.

408
00:18:40,686 --> 00:18:42,788
Again, showing intent,

409
00:18:42,788 --> 00:18:45,023
showing where this
thing may have been.

410
00:18:45,023 --> 00:18:49,495
It's got another account that
I use, it's got timestamps.

411
00:18:49,495 --> 00:18:51,729
Every single one of
these applications

412
00:18:51,730 --> 00:18:55,367
records very interesting
data, we haven't found it all.

413
00:18:55,367 --> 00:18:57,668
If you were in the
previous presentation

414
00:18:57,669 --> 00:19:00,105
about SQL databases,
the vast majority

415
00:19:00,105 --> 00:19:02,608
was either an SQL
database or in a P-list.

416
00:19:02,608 --> 00:19:04,309
We know how to work with these.

417
00:19:08,213 --> 00:19:12,518
My primary goal is to tie
all these things together.

418
00:19:12,518 --> 00:19:16,155
I wanna be able to say all of
these artifacts are related,

419
00:19:16,155 --> 00:19:17,623
or they're not related.

420
00:19:17,623 --> 00:19:20,626
If somebody comes up and
says hey, these images show

421
00:19:20,626 --> 00:19:22,728
that this person was
behaving illegally,

422
00:19:22,728 --> 00:19:25,330
and they owned the
UAV, and I can't tie

423
00:19:25,330 --> 00:19:26,532
all those bits and
pieces together

424
00:19:26,532 --> 00:19:28,567
I'll say yeah,
the images show X,

425
00:19:28,567 --> 00:19:30,702
but you haven't
tied it to the UAV.

426
00:19:30,702 --> 00:19:32,304
Go back and try again.

427
00:19:35,707 --> 00:19:40,712
The P-list has more
information about Facebook.

428
00:19:43,549 --> 00:19:46,952
The statistics DB is the file
that we're most interested in.

429
00:19:48,120 --> 00:19:50,555
There are four device types,

430
00:19:50,556 --> 00:19:52,524
three of which I
know what they are.

431
00:19:52,524 --> 00:19:57,196
One's the airframe, one's the
battery, one's the camera.

432
00:19:57,196 --> 00:19:58,463
There's a device type zero

433
00:19:58,463 --> 00:20:01,300
which I haven't figured
out what it is yet.

434
00:20:01,300 --> 00:20:06,305
If you look at this, we
have two device type twos.

435
00:20:07,739 --> 00:20:09,675
That's both the batteries I
ever had on this airframe.

436
00:20:11,109 --> 00:20:15,813
We have a device
type one right there.

437
00:20:15,814 --> 00:20:17,549
Sorry, my mouse
was trapped, sorry.

438
00:20:20,485 --> 00:20:25,490
One is the camera, sorry,
one is the airframe.

439
00:20:26,692 --> 00:20:28,827
The one that I'm missing
up on here is a camera.

440
00:20:28,827 --> 00:20:31,863
That airframe is that magic
number we've been looking for.

441
00:20:31,863 --> 00:20:33,899
That's the same thing that
we've seen in the applications,

442
00:20:33,899 --> 00:20:36,568
that's the same thing that
we saw on the motherboard.

443
00:20:37,736 --> 00:20:40,239
I believe, and I haven't
gotten this far yet,

444
00:20:40,239 --> 00:20:43,408
in all those data flows
that we were looking at,

445
00:20:43,408 --> 00:20:45,310
that ID will show
up there as well.

446
00:20:49,381 --> 00:20:52,584
DJI has 30 to 60% of the market.

447
00:20:52,584 --> 00:20:54,152
3DR has another chunk of it,

448
00:20:54,152 --> 00:20:55,988
there are a bunch of
other vendors out there.

449
00:20:55,988 --> 00:20:57,856
One of the more common
flight controllers

450
00:20:57,856 --> 00:20:59,891
that's not DJI is
called the PixHawk.

451
00:21:01,293 --> 00:21:03,462
The standard ground control
station for it runs on Windows,

452
00:21:03,462 --> 00:21:04,997
it's called Mission Planner.

453
00:21:04,997 --> 00:21:07,566
It has been around
for probably eight,

454
00:21:07,566 --> 00:21:09,801
nine, maybe even 10 years.

455
00:21:09,801 --> 00:21:12,771
It's the hobbiest
tool for learning

456
00:21:12,771 --> 00:21:16,274
how to build up their own UAVs,
and so they log everything.

457
00:21:16,275 --> 00:21:18,310
'Cause they're using
this for crash analysis,

458
00:21:18,310 --> 00:21:20,946
for tuning motors, for tuning
batteries, all of that.

459
00:21:21,980 --> 00:21:23,649
Simply by downloading the data

460
00:21:23,649 --> 00:21:27,619
off of the PixHawk Flight
Controller on my UAV

461
00:21:27,619 --> 00:21:29,420
and putting it into
Mission Planner,

462
00:21:29,421 --> 00:21:31,990
I can produce this map
in two minutes time.

463
00:21:31,990 --> 00:21:34,359
That's right there,
I'm not gonna say

464
00:21:34,359 --> 00:21:36,595
it's forensically sound but
at least it's standalone,

465
00:21:36,595 --> 00:21:38,063
it's not sitting
up on the cloud.

466
00:21:38,063 --> 00:21:40,032
It shows where I flew,
what I flew over,

467
00:21:40,032 --> 00:21:41,433
altitudes, all of that.

468
00:21:41,433 --> 00:21:43,268
That's just the
graphical representation,

469
00:21:43,268 --> 00:21:45,370
all the raw data's
sitting underneath that.

470
00:21:46,471 --> 00:21:47,873
Is anybody here a pilot?

471
00:21:49,141 --> 00:21:50,676
Oh wow, first time there's not.

472
00:21:52,277 --> 00:21:54,246
This is me landing
a fixed-wing UAV.

473
00:21:55,447 --> 00:21:57,381
What it's showing
is the pitch angle,

474
00:21:57,382 --> 00:21:58,583
and so I'm trying to land it,

475
00:21:58,583 --> 00:22:00,218
so my pitch is
fluctuating all over

476
00:22:00,218 --> 00:22:02,087
as I bring the nose up and down.

477
00:22:02,087 --> 00:22:06,825
I finally get it on my landing
path, everything's cool,

478
00:22:06,825 --> 00:22:09,394
we're just coming
in, we're coming in.

479
00:22:09,394 --> 00:22:10,796
If that's my pitch angle,

480
00:22:10,796 --> 00:22:12,497
what does that big
downward spike mean

481
00:22:12,497 --> 00:22:14,299
happened to my nose
and my aircraft?

482
00:22:16,168 --> 00:22:18,003
It hit a chain-link fence.

483
00:22:18,003 --> 00:22:22,741
So smacked into a chain-link
fence and pitched down,

484
00:22:22,741 --> 00:22:25,410
hit the ground, pitched
back up to level.

485
00:22:25,410 --> 00:22:29,581
All that data's available for
the PixHawk Flight Controller.

486
00:22:29,581 --> 00:22:30,982
There's an enormous amount

487
00:22:30,982 --> 00:22:33,085
of analysis tools
available for you already.

488
00:22:35,454 --> 00:22:37,121
So some closing thoughts.

489
00:22:38,523 --> 00:22:42,593
The DJI Phantom 2 had
a wifi access point

490
00:22:42,594 --> 00:22:44,262
right there on the controller.

491
00:22:44,262 --> 00:22:48,265
You fired up your phone, you
fired up the accenture point,

492
00:22:48,266 --> 00:22:53,238
you fire up the UAV, the access
point said I'm a DJI Phantom

493
00:22:54,639 --> 00:22:56,073
and had a string of
numbers right after that.

494
00:22:56,074 --> 00:22:58,310
Both the other devices
connected to that access point

495
00:22:58,310 --> 00:23:01,413
and now you can connect to them.

496
00:23:01,413 --> 00:23:05,183
You can also log in to that
access point remotely via SSH,

497
00:23:05,183 --> 00:23:07,152
and use all your
standard Linux tools

498
00:23:07,152 --> 00:23:09,121
to dump out whatever
you wanna do.

499
00:23:09,121 --> 00:23:11,123
Unfortunately they
moved away from that.

500
00:23:12,824 --> 00:23:14,459
In the interest in
getting more bandwidth

501
00:23:14,459 --> 00:23:16,228
and also in the interest
of getting more security,

502
00:23:16,228 --> 00:23:17,796
the vendors are gonna
get better and better

503
00:23:17,796 --> 00:23:20,432
at securing that data link,
and we're already seeing it.

504
00:23:20,432 --> 00:23:21,533
And some of this stuff is moving

505
00:23:21,533 --> 00:23:24,235
to LTE 4G cellular connections.

506
00:23:24,236 --> 00:23:27,172
There's a little bit of
lag but it's not fatal.

507
00:23:27,172 --> 00:23:31,376
So these are all some data links

508
00:23:31,376 --> 00:23:33,278
that we are accustomed
to analyzing.

509
00:23:33,278 --> 00:23:35,113
We know how the phone
interact with them,

510
00:23:35,113 --> 00:23:37,115
we know how to go file subpoenas

511
00:23:37,115 --> 00:23:39,017
against those data
service providers,

512
00:23:39,017 --> 00:23:41,119
we know how to work
with this sorta stuff.

513
00:23:42,454 --> 00:23:44,322
There are a lot of
vendors, a lot of variety,

514
00:23:44,322 --> 00:23:46,091
a lot of embedded systems.

515
00:23:47,426 --> 00:23:49,194
When I did this
presentation a year ago

516
00:23:49,194 --> 00:23:51,562
and was looking
at the Phantom 2,

517
00:23:51,563 --> 00:23:54,065
I had to look at three
different versions of Linux,

518
00:23:54,065 --> 00:23:58,270
I had to look at either iOS
or Android, OSX or Windows,

519
00:23:58,270 --> 00:24:02,641
six different file systems
to go lookin' for the data.

520
00:24:02,641 --> 00:24:05,377
I was looking at ser2net,
which takes serial IO

521
00:24:05,377 --> 00:24:07,779
and turns it into
a network flow.

522
00:24:07,779 --> 00:24:11,416
Wifi, Bluetooth, EXIF data, GPS.

523
00:24:11,416 --> 00:24:14,386
What I'm getting at, before
I get hyperactive here,

524
00:24:14,386 --> 00:24:17,189
is that there's no single UAV

525
00:24:18,356 --> 00:24:19,925
forensic analysis
tool out there.

526
00:24:19,925 --> 00:24:22,994
And if somebody tries to
say hey, we've got one,

527
00:24:22,994 --> 00:24:24,795
it's unlikely to be true.

528
00:24:26,231 --> 00:24:30,035
To properly analyze all this
requires a group of people

529
00:24:30,035 --> 00:24:31,703
that understand these
different components

530
00:24:31,703 --> 00:24:33,405
and put together
in a whole story.

531
00:24:35,407 --> 00:24:38,543
There's a cybersecurity
aspect to this as well.

532
00:24:38,543 --> 00:24:42,414
The proper name for a
drone is a UAS, or sUAS,

533
00:24:42,414 --> 00:24:44,483
Unmanned Aerial System.

534
00:24:44,483 --> 00:24:49,488
It's very similar in this regard
to the internet of things.

535
00:24:49,488 --> 00:24:52,357
You've got processors,
memory, and a bunch of sensors

536
00:24:52,357 --> 00:24:57,362
hooked up via either
direct or network IO paths,

537
00:24:57,362 --> 00:24:59,264
communicating with the cloud,

538
00:24:59,264 --> 00:25:01,433
running on a lotta
different devices.

539
00:25:01,433 --> 00:25:03,435
This is just an
instance of the IOT.

540
00:25:04,870 --> 00:25:08,607
Law and policy, remember
that it's just a vehicle.

541
00:25:08,607 --> 00:25:12,244
It's a pickup truck flying
these sensors around.

542
00:25:12,244 --> 00:25:16,648
If you're gonna write
a law about UAVs,

543
00:25:18,116 --> 00:25:21,386
and you wanna actually
protect people's privacy,

544
00:25:21,386 --> 00:25:23,088
don't write it to say hey,

545
00:25:23,088 --> 00:25:25,423
UAVs cannot fly
over the back yard

546
00:25:25,423 --> 00:25:28,026
because I'm gonna go fly a
kite over your back yard.

547
00:25:28,026 --> 00:25:31,429
Write your policy about
what's being detected

548
00:25:31,429 --> 00:25:33,832
and what your concerns
are about that detection.

549
00:25:35,467 --> 00:25:36,301
And that's it.

550
00:25:37,602 --> 00:25:39,771
If you have any.
(light applause)

551
00:25:39,771 --> 00:25:42,706
(quick shimmering)

