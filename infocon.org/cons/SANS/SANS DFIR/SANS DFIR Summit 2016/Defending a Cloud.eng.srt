1
00:00:00,867 --> 00:00:04,371
(inspirational electronic music)

2
00:00:13,213 --> 00:00:15,315
(audience applauding)
- Thank you, thank you.

3
00:00:20,387 --> 00:00:21,454
Good morning.
- [Audience] Good morning.

4
00:00:23,656 --> 00:00:26,826
- Sorry, sorry, I meant
good morning all y'alls!

5
00:00:26,826 --> 00:00:31,598
I'm in Texas now, today I'm
gonna talk as a keynote.

6
00:00:31,598 --> 00:00:35,501
I don't wanna bore you
with hex and offset

7
00:00:35,502 --> 00:00:37,170
so I'm gonna talk
about defending

8
00:00:37,170 --> 00:00:40,573
the cloud at a nice high level.

9
00:00:40,573 --> 00:00:42,108
And show you some
of the fun we're

10
00:00:42,108 --> 00:00:43,943
having at Microsoft these days.

11
00:00:45,111 --> 00:00:48,281
So my topic is
Defending a Cloud.

12
00:00:48,281 --> 00:00:50,116
And the blue around
it was intended

13
00:00:50,116 --> 00:00:53,720
to be azure blue 'cause the
Azure cloud is the one I defend.

14
00:00:53,720 --> 00:00:57,957
See if this works, oops okay.

15
00:00:59,859 --> 00:01:01,661
Before we get there,
how did I get here?

16
00:01:01,661 --> 00:01:03,897
I've been doing forensics now.

17
00:01:03,897 --> 00:01:05,565
I've just thought when we said,

18
00:01:05,565 --> 00:01:08,134
some of you might have
been here, are new.

19
00:01:08,134 --> 00:01:10,203
Some might have been
here for four years.

20
00:01:10,203 --> 00:01:12,172
And it dawned on me
because I can put this

21
00:01:12,172 --> 00:01:14,039
between the birth of
first and second daughter

22
00:01:14,040 --> 00:01:16,409
that I've been doing
this now 20 years.

23
00:01:16,409 --> 00:01:18,645
Which explains why when I look

24
00:01:18,645 --> 00:01:20,512
in the mirror I see my father.

25
00:01:21,948 --> 00:01:24,883
And here's my forensics
father, Andy Rosen.

26
00:01:24,884 --> 00:01:26,553
Good morning and
good to see you.

27
00:01:27,954 --> 00:01:32,958
So I currently
work in MSRC Azure.

28
00:01:34,360 --> 00:01:36,295
MSRC is the Microsoft
security response center.

29
00:01:36,296 --> 00:01:38,231
They're the people
who have for years

30
00:01:38,231 --> 00:01:41,033
handled the exploits when
people find something bad

31
00:01:41,034 --> 00:01:44,904
in Windows and they're
gonna publicize it,

32
00:01:44,904 --> 00:01:46,872
MSRC's the one that tracks down

33
00:01:46,873 --> 00:01:49,075
the code, starts
getting it fixed.

34
00:01:49,075 --> 00:01:50,643
So why did they get forensics?

35
00:01:50,643 --> 00:01:55,248
Well they get forensics because

36
00:01:55,248 --> 00:01:56,416
Microsoft's view of forensics

37
00:01:56,416 --> 00:01:59,018
is they're not just interested

38
00:01:59,018 --> 00:02:00,820
in the network forensics
protecting their own network,

39
00:02:00,820 --> 00:02:02,788
but they're interested
in everything

40
00:02:02,789 --> 00:02:04,257
they can learn about
forensics as part

41
00:02:04,257 --> 00:02:06,693
of improving
services and product.

42
00:02:06,693 --> 00:02:08,561
I'll get to that in a moment.

43
00:02:08,561 --> 00:02:11,164
My particular role in MSRC is

44
00:02:11,164 --> 00:02:15,000
to do compromise, intrusion,
and breach investigations.

45
00:02:15,001 --> 00:02:17,570
A lot of people jumble
those all together.

46
00:02:17,570 --> 00:02:19,305
I think they need
to be separated.

47
00:02:20,740 --> 00:02:24,310
And there's often very strict
legal definitions of breach

48
00:02:24,310 --> 00:02:27,547
so it makes it even funnier
when the lawyers mess it all up.

49
00:02:27,547 --> 00:02:29,516
But those are the three big
things I like to focus on.

50
00:02:29,516 --> 00:02:31,885
I've been able to
focus on them now

51
00:02:31,885 --> 00:02:34,353
for probably the past
seven or eight years.

52
00:02:35,555 --> 00:02:40,293
So my primary job has
been incident response

53
00:02:41,161 --> 00:02:43,663
and digital forensics related

54
00:02:43,663 --> 00:02:45,532
to security breaches
and the like.

55
00:02:45,532 --> 00:02:49,102
Compromise for almost a decade.

56
00:02:50,336 --> 00:02:52,572
Now as I mentioned I
have a little thing

57
00:02:52,572 --> 00:02:53,873
up there, forensics
at Microsoft.

58
00:02:53,873 --> 00:02:57,277
The fun thing, ooh, hey
be careful with this.

59
00:02:57,277 --> 00:03:00,647
(crowd laughing)

60
00:03:00,647 --> 00:03:02,815
Now what am I gonna
hold up myself with?

61
00:03:02,815 --> 00:03:06,986
Dave? Okay.
(crowd laughing)

62
00:03:06,986 --> 00:03:09,756
Fun thing about doing
forensics at Microsoft

63
00:03:09,756 --> 00:03:12,125
is as I mentioned
they do all the stuff

64
00:03:12,125 --> 00:03:14,861
that a normal security
forensics team would do.

65
00:03:14,861 --> 00:03:16,296
Defending their
network, following

66
00:03:16,296 --> 00:03:18,631
up on intrusions and the like.

67
00:03:18,631 --> 00:03:20,800
But there is now a
heavy threat intel

68
00:03:20,800 --> 00:03:23,937
component of it that's
stuff that Microsoft finds

69
00:03:23,937 --> 00:03:26,406
gets eventually
distributed out through

70
00:03:26,406 --> 00:03:30,543
like their MAP programs or the
MSRA programs and the like.

71
00:03:30,543 --> 00:03:33,680
Because Microsoft
also has a very big

72
00:03:33,680 --> 00:03:37,617
vested interest in
making the environment,

73
00:03:37,617 --> 00:03:40,286
the computing environment
in general a lot safer.

74
00:03:41,454 --> 00:03:43,323
So I find that is
one of the most

75
00:03:43,323 --> 00:03:45,592
compelling reasons to
be working at Microsoft.

76
00:03:45,592 --> 00:03:48,661
Because what I do maybe
goes to improve the product.

77
00:03:49,729 --> 00:03:51,764
It might go to
improve the services.

78
00:03:51,764 --> 00:03:55,235
It goes to make things
more secure and that stuff

79
00:03:55,235 --> 00:03:58,304
doesn't stay at Microsoft,
it goes out to the world.

80
00:03:58,304 --> 00:04:00,006
So some of the things
that have come out

81
00:04:00,006 --> 00:04:02,308
of our work for
example long ago was,

82
00:04:02,308 --> 00:04:03,810
I don't know if you know this,

83
00:04:03,810 --> 00:04:05,545
the dir command will show
you alternate data streams.

84
00:04:05,545 --> 00:04:08,214
That was some of the
stuff championed by us

85
00:04:08,214 --> 00:04:10,716
explaining why that would be
important to a product team.

86
00:04:10,717 --> 00:04:13,253
And then probably
one of the biggest

87
00:04:13,253 --> 00:04:16,455
and most recent
things we pushed for

88
00:04:16,456 --> 00:04:18,658
came out of the forensics
and instant response side

89
00:04:18,658 --> 00:04:20,727
was command line logging being

90
00:04:20,726 --> 00:04:23,296
in the process creation events.

91
00:04:23,296 --> 00:04:26,532
So it's fun to be pushing
that sort of thing.

92
00:04:27,667 --> 00:04:28,900
And you can go
home and it's like

93
00:04:28,901 --> 00:04:31,037
I just wasn't defending
intellectual property

94
00:04:31,037 --> 00:04:32,938
but doing my little teeny bit

95
00:04:32,939 --> 00:04:34,841
to make the world
a better place.

96
00:04:34,841 --> 00:04:38,811
If by better place means
that your Snapchat is secure.

97
00:04:38,811 --> 00:04:43,316
(crowd laughing)
Thank you, thank you for that.

98
00:04:43,316 --> 00:04:46,419
Supposed to warn everybody
'cause the strict liability laws

99
00:04:46,419 --> 00:04:51,424
Texas has for
products that for me

100
00:04:52,525 --> 00:04:54,460
it's bad jokes
told poorly, I just

101
00:04:54,460 --> 00:04:57,964
wanna set expectations
here 'cause it is early.

102
00:04:59,132 --> 00:05:02,168
So I came to the
cloud, wait, okay.

103
00:05:02,168 --> 00:05:03,569
I came to the cloud because I've

104
00:05:03,569 --> 00:05:05,004
been doing this for a long time

105
00:05:05,004 --> 00:05:06,339
and you see more and more stuff

106
00:05:06,339 --> 00:05:07,573
really is backed by the cloud.

107
00:05:07,573 --> 00:05:10,109
Even services on your
phone and like that.

108
00:05:10,109 --> 00:05:11,943
It seemed to me that
if you're looking

109
00:05:11,944 --> 00:05:13,246
for making the
world a safer place

110
00:05:13,246 --> 00:05:14,847
we gotta start
looking at the cloud.

111
00:05:14,847 --> 00:05:18,518
So I thought I would jump
in and start working on it.

112
00:05:18,518 --> 00:05:21,287
It's big, it's global, we
have to deal with borders

113
00:05:21,287 --> 00:05:24,823
and all kinds of legal
issues and the like.

114
00:05:24,824 --> 00:05:26,326
Some of that I'll talk about.

115
00:05:26,326 --> 00:05:28,928
In the end, everyone wants
things faster and accurate.

116
00:05:32,598 --> 00:05:34,967
I apologize in
advance if I shoot

117
00:05:34,967 --> 00:05:38,971
anyone in the eyes
with the laser.

118
00:05:38,971 --> 00:05:40,473
I normally have a laser shark

119
00:05:40,473 --> 00:05:41,708
with me that reminds that I'm

120
00:05:41,708 --> 00:05:44,877
holding a laser but I forgot it.

121
00:05:47,013 --> 00:05:50,549
I'm sorry, so I jumped
ahead, so I'll be talking

122
00:05:50,550 --> 00:05:52,485
about defending a
cloud, I'll begin

123
00:05:52,485 --> 00:05:55,188
by looking just a little
bit what is cloud computing.

124
00:05:55,188 --> 00:05:56,455
Kind of explain it, I don't know

125
00:05:56,456 --> 00:05:58,257
if many of you are
familiar with it.

126
00:05:58,257 --> 00:06:01,160
How many people are
working in enterprises

127
00:06:01,160 --> 00:06:03,196
that have anything in the cloud?

128
00:06:03,196 --> 00:06:06,766
That's, oh I can just
drop that part then.

129
00:06:06,766 --> 00:06:09,302
No, and then I'll turn to issues

130
00:06:09,302 --> 00:06:11,471
involved with defending a cloud,

131
00:06:11,471 --> 00:06:13,973
some of the things I think
make it kind of different

132
00:06:13,973 --> 00:06:18,978
from normal enterprise or
normal business type forensics.

133
00:06:20,146 --> 00:06:22,482
Oh it's that, I
keep pointing it.

134
00:06:22,482 --> 00:06:24,784
So beginning with
what is a cloud?

135
00:06:24,784 --> 00:06:26,551
I mean a cloud was
always the symbol

136
00:06:26,552 --> 00:06:27,787
used in your network diagram.

137
00:06:27,787 --> 00:06:29,621
That's when you connect
to the bigger network

138
00:06:29,622 --> 00:06:31,624
or the internet, that's
why I had to stop

139
00:06:31,624 --> 00:06:34,127
detailing anything I
just put it to the cloud.

140
00:06:34,127 --> 00:06:36,462
So it's my great big vague point

141
00:06:36,462 --> 00:06:38,765
in a Visio diagram or something.

142
00:06:38,765 --> 00:06:40,466
And to some extent that's
still kinda how it is.

143
00:06:40,466 --> 00:06:42,702
But I wanna look
at from the point

144
00:06:42,702 --> 00:06:44,637
of view of a service provider.

145
00:06:44,637 --> 00:06:48,441
So what is the cloud, well the
cloud actually starts with,

146
00:06:48,441 --> 00:06:52,210
and if I define it in
the most simple terms,

147
00:06:52,211 --> 00:06:55,214
it begins with an
automated data center

148
00:06:55,214 --> 00:06:58,251
where machines are
deployed by machines.

149
00:06:58,251 --> 00:07:02,455
They're managed by machine,
they're monitored by machine.

150
00:07:02,455 --> 00:07:04,022
It's at a vast scale, you don't

151
00:07:04,023 --> 00:07:06,092
have people plugging things in.

152
00:07:06,092 --> 00:07:07,393
After it gets all
plugged and built in,

153
00:07:07,393 --> 00:07:09,128
machines take over and machines

154
00:07:09,128 --> 00:07:11,097
will roll out the
deploy machines.

155
00:07:11,097 --> 00:07:13,032
They'll deploy virtual machines

156
00:07:13,032 --> 00:07:14,700
and it's done at a grand scale.

157
00:07:19,572 --> 00:07:23,409
Okay, whoop, yeah, for the
actual cloud service provider

158
00:07:23,409 --> 00:07:27,947
then a cloud is actually
just a large collection

159
00:07:27,947 --> 00:07:32,485
of these automated datacenters.

160
00:07:33,653 --> 00:07:35,455
So Microsoft has
them, have several

161
00:07:35,455 --> 00:07:38,657
in the United States on both
coasts and some in the middle.

162
00:07:38,658 --> 00:07:41,160
We have them in Europe,
we have them in Asia.

163
00:07:41,160 --> 00:07:46,165
I'm certain that AWS has
many many in many locations.

164
00:07:48,801 --> 00:07:52,604
So the essence of this
cloud that I'm talking

165
00:07:52,605 --> 00:07:55,575
about is this collection
of automated datacenters.

166
00:07:55,575 --> 00:07:57,409
What people get out
of those primarily

167
00:07:57,410 --> 00:07:59,812
are if you're to boil it down,

168
00:07:59,812 --> 00:08:02,081
this isn't meant to
be anything dogmatic.

169
00:08:02,081 --> 00:08:03,549
You're getting compute resources

170
00:08:03,549 --> 00:08:08,520
and you can buy machine time
or own your own machines in it.

171
00:08:09,589 --> 00:08:11,891
Or you're buying
storage or you're buying

172
00:08:11,891 --> 00:08:15,461
a network, IP addresses
and bandwidth.

173
00:08:15,461 --> 00:08:18,965
So those are the three
fundamental resources

174
00:08:18,965 --> 00:08:20,765
that people are
buying in the cloud.

175
00:08:25,304 --> 00:08:27,272
Gotta make sure I didn't, okay.

176
00:08:27,273 --> 00:08:29,041
So the way it works
at least at Microsoft

177
00:08:29,041 --> 00:08:32,044
is this datacenter boils
down to a bunch of clusters.

178
00:08:32,044 --> 00:08:33,913
A cluster is this
very large aggregate

179
00:08:33,913 --> 00:08:37,250
of some thousands of
blades, so you have

180
00:08:37,250 --> 00:08:41,453
blades in racks and many
racks go to form a cluster.

181
00:08:41,453 --> 00:08:44,390
Each cluster is
managed by in Azure

182
00:08:44,390 --> 00:08:46,092
Microsoft speak a
fabric controller.

183
00:08:46,092 --> 00:08:48,461
That's sort of
like you're seeing

184
00:08:48,461 --> 00:08:51,898
this automated datacenter
as one big computer.

185
00:08:51,898 --> 00:08:53,633
This would be equivalent
to like your kernel.

186
00:08:53,633 --> 00:08:56,836
The fabric controller
is the one controlling,

187
00:08:56,836 --> 00:08:59,372
monitoring, and
basically the point

188
00:08:59,372 --> 00:09:02,440
of management for the
automation in the cloud.

189
00:09:02,441 --> 00:09:07,179
The datacenter will be
usually four more buildings.

190
00:09:07,179 --> 00:09:09,382
These buildings
filled with clusters.

191
00:09:09,382 --> 00:09:12,551
One of the big overriding
architectural concerns of cloud

192
00:09:12,552 --> 00:09:15,154
is to have lots of redundancy.

193
00:09:15,154 --> 00:09:17,423
Clouds are designed
so you can have

194
00:09:17,423 --> 00:09:20,059
half those buildings
just suddenly lose power.

195
00:09:20,059 --> 00:09:23,161
And DMs would be
migrated or machines

196
00:09:23,162 --> 00:09:25,431
would be started up
in the other buildings

197
00:09:25,431 --> 00:09:27,400
or in other
geographical locations

198
00:09:27,400 --> 00:09:30,102
to nearly instantaneously
take over that load

199
00:09:30,102 --> 00:09:33,072
so services and webpages
all keep running.

200
00:09:36,576 --> 00:09:38,978
Dave, did you have
any questions?

201
00:09:38,978 --> 00:09:40,579
Great, isn't it
terrible that I managed

202
00:09:40,580 --> 00:09:42,782
to find where you
were in the crowd?

203
00:09:42,782 --> 00:09:46,852
Thanks to Rob, yeah, he's
my designated heckler.

204
00:09:46,852 --> 00:09:50,323
Everyone. (claps)
(audience claps)

205
00:09:53,159 --> 00:09:54,393
I always find it's good to have

206
00:09:54,393 --> 00:09:55,895
a designated heckler
that way you know

207
00:09:55,895 --> 00:09:58,297
where it's coming from,
I just hate surprises.

208
00:10:00,566 --> 00:10:04,136
Okay, so these nodes or blades.

209
00:10:04,136 --> 00:10:06,572
As they break down
in the Azure space,

210
00:10:06,572 --> 00:10:11,110
it's this blade server, and
these are massive blade servers.

211
00:10:11,110 --> 00:10:12,912
I think the current
iteration of them

212
00:10:12,912 --> 00:10:16,315
has something on the order
of half a terabyte of RAM.

213
00:10:16,315 --> 00:10:20,620
And just multiple arrays of
solid-state drives and the like.

214
00:10:20,620 --> 00:10:22,989
They're just massive and fast.

215
00:10:22,989 --> 00:10:25,257
The way it works is we
have, I guess I should point

216
00:10:25,257 --> 00:10:27,193
to things if I get
it right, let's see.

217
00:10:28,527 --> 00:10:30,696
A thinly provisioned
host OS that is used

218
00:10:30,696 --> 00:10:34,400
to manage the hypervisor
and be the point of contact

219
00:10:34,400 --> 00:10:37,470
between fabric controller
virtual machines and the like.

220
00:10:37,470 --> 00:10:42,308
Then you have your
hardware resources.

221
00:10:42,308 --> 00:10:45,378
And the hypervisor
using, and at Microsoft

222
00:10:45,378 --> 00:10:48,147
it's the Hyper-V basically
what you can see if you work

223
00:10:48,147 --> 00:10:52,218
the server, it's a variation
on that for the cloud.

224
00:10:52,218 --> 00:10:55,154
And then we have a
series of guest VMs, so.

225
00:11:07,099 --> 00:11:08,401
I'm presenting
these slides because

226
00:11:08,401 --> 00:11:10,069
I'm really happy
about the next one.

227
00:11:10,069 --> 00:11:13,772
This next one is like my
year's work all boils down.

228
00:11:13,773 --> 00:11:16,709
But anyway, so what are the
resources at compute resources?

229
00:11:16,709 --> 00:11:18,810
I'm gonna focus on
compute because if I start

230
00:11:18,811 --> 00:11:21,614
talking about storage,
it gets very esoteric.

231
00:11:21,614 --> 00:11:25,217
We have papers up on how ours
is, the Azure storage works.

232
00:11:25,217 --> 00:11:29,521
The networking, who
understands networking.

233
00:11:29,522 --> 00:11:32,024
So I'm gonna focus
on the compute.

234
00:11:32,024 --> 00:11:34,994
And basically cloud
computing is oriented

235
00:11:34,994 --> 00:11:37,797
around providing a
bunch of resources.

236
00:11:37,797 --> 00:11:38,964
This is sort of
the typical thing.

237
00:11:38,964 --> 00:11:40,332
I know Microsoft
puts it up, I've seen

238
00:11:40,332 --> 00:11:42,068
this put up by other vendors.

239
00:11:42,068 --> 00:11:44,236
But you have your, if you do it

240
00:11:44,236 --> 00:11:45,504
on premise you're
running everything.

241
00:11:45,504 --> 00:11:47,073
And then you've
got infrastructure

242
00:11:47,073 --> 00:11:49,608
as a service or
what's called IAAS.

243
00:11:49,608 --> 00:11:50,910
And they'll explain
well you bring

244
00:11:50,910 --> 00:11:52,778
your OS and your
applications and

245
00:11:52,778 --> 00:11:54,547
we'll provide the
infrastructure.

246
00:11:54,547 --> 00:11:56,148
And then they go
platform, you just

247
00:11:56,148 --> 00:11:57,783
bring your application and your

248
00:11:57,783 --> 00:11:59,485
data and we'll provide the rest.

249
00:11:59,485 --> 00:12:01,687
And then there's the
SAS, which would be

250
00:12:01,687 --> 00:12:04,724
like Gmail or Office 365 where

251
00:12:04,724 --> 00:12:06,325
they run everything, you're just

252
00:12:06,325 --> 00:12:09,795
letting them, you're just
connecting and getting stuff.

253
00:12:09,795 --> 00:12:11,630
Now I find this
hard to understand

254
00:12:11,630 --> 00:12:13,766
what this really means,
so after thinking

255
00:12:13,766 --> 00:12:16,635
about it long and hard I wanted

256
00:12:16,635 --> 00:12:18,571
to come up with an
analogy to better explain

257
00:12:18,571 --> 00:12:21,774
what cloud services
are because it will

258
00:12:21,774 --> 00:12:24,477
become important when we
talk about the security side.

259
00:12:27,246 --> 00:12:30,783
And it dawned on me,
vacation resources.

260
00:12:30,783 --> 00:12:33,018
So this will explain
more, if you look like

261
00:12:33,018 --> 00:12:36,322
on premise would be
like going backpacking.

262
00:12:36,322 --> 00:12:38,657
You've got
everything, you're it.

263
00:12:38,657 --> 00:12:40,893
You're bringing your water,
you're bringing the tent.

264
00:12:40,893 --> 00:12:42,928
You've gotta find
your campground,

265
00:12:42,928 --> 00:12:44,563
you've gotta not
roll off the cliff.

266
00:12:44,563 --> 00:12:46,198
You've gotta watch
out for rattlesnakes,
it's all up to you.

267
00:12:46,198 --> 00:12:50,369
IAAS or infrastructure
as service, it's
like renting an RV.

268
00:12:50,369 --> 00:12:52,471
You're getting the
infrastructure,

269
00:12:52,471 --> 00:12:54,306
you're getting the
RV, it's got some beds

270
00:12:54,306 --> 00:12:56,008
and it's got walls and
everything like that.

271
00:12:56,008 --> 00:12:57,576
But you might have to bring
your sheets and towels.

272
00:12:57,576 --> 00:13:00,946
You're gonna have to feed
yourself and the like.

273
00:13:00,946 --> 00:13:04,617
PAAS or platform as a
service is like staying

274
00:13:04,617 --> 00:13:07,286
at a nice hotel, everything
is there even the breakfast.

275
00:13:07,286 --> 00:13:10,823
So guess it's not this hotel.
(crowd laughs)

276
00:13:10,823 --> 00:13:13,726
But it's still
gonna be up to you

277
00:13:18,430 --> 00:13:22,101
to feed yourself, to entertain
yourself, get around.

278
00:13:22,101 --> 00:13:24,203
But everything else
is provided for you.

279
00:13:25,871 --> 00:13:30,543
And SAAS, it's like
a Disney cruise.

280
00:13:30,543 --> 00:13:32,011
It's just all
there, you just have

281
00:13:32,011 --> 00:13:34,413
to walk out of your
room and people

282
00:13:34,413 --> 00:13:36,182
are there to take care of you.

283
00:13:36,182 --> 00:13:41,187
So I'll show how this works
later in the security field.

284
00:13:42,321 --> 00:13:43,956
But let's see, yeah
I keep pointing

285
00:13:43,956 --> 00:13:45,891
at the screens to
change my slides.

286
00:13:47,293 --> 00:13:49,995
So just reiterate, we've
got, and out of these

287
00:13:49,995 --> 00:13:52,531
in the cloud stuff
that I deal with Azure.

288
00:13:52,531 --> 00:13:55,434
We're really looking at
the two, the PAAS and IAAS.

289
00:13:55,434 --> 00:13:58,270
So PAAS, platform as
service, you've spent,

290
00:13:58,270 --> 00:14:02,842
we have provisioned OSes
based on Window's server

291
00:14:02,842 --> 00:14:05,978
and the like that
you'll spin up.

292
00:14:05,978 --> 00:14:07,579
You basically provide
an application

293
00:14:07,580 --> 00:14:09,715
that is run as a
service on top of that.

294
00:14:09,715 --> 00:14:12,685
So the provisioning,
the updating

295
00:14:12,685 --> 00:14:14,053
and all that is up to Microsoft.

296
00:14:14,053 --> 00:14:16,622
But you still own the
VM, that's something

297
00:14:16,622 --> 00:14:19,091
where people get a
little bit iffy on.

298
00:14:19,091 --> 00:14:21,026
The most important
thing about PAAS

299
00:14:21,026 --> 00:14:22,694
at least the way it's
structured in Azure,

300
00:14:22,695 --> 00:14:26,031
is PAAS virtual
machines are stateless.

301
00:14:26,031 --> 00:14:28,032
They're designed for rollover,

302
00:14:28,033 --> 00:14:31,437
they're designed so that
the hardware can fail

303
00:14:31,437 --> 00:14:32,905
and new ones spin
up immediately.

304
00:14:32,905 --> 00:14:35,074
So they're stateless,
anything that's persisted,

305
00:14:35,074 --> 00:14:37,776
if the customer has data like
it's a website or anything,

306
00:14:37,776 --> 00:14:40,045
it's running off to databases,

307
00:14:40,045 --> 00:14:41,413
it's running off
to table storage,

308
00:14:41,413 --> 00:14:43,182
it's running off
to blob storage.

309
00:14:43,182 --> 00:14:44,950
But it's all going
to storage somewhere

310
00:14:44,950 --> 00:14:46,585
if it's intended
to be persistent.

311
00:14:46,585 --> 00:14:48,988
And that's because the whole
design idea behind PAAS

312
00:14:48,988 --> 00:14:51,624
is you can fail one of these
or replace it instantly.

313
00:14:51,624 --> 00:14:53,192
Migrate it to another
place and things

314
00:14:53,192 --> 00:14:54,994
keep running just as
they are, which means

315
00:14:54,994 --> 00:14:58,130
you can't have the data
tied to any particular VM.

316
00:14:58,130 --> 00:15:00,665
IAAS on the other hand,
since you're supplying

317
00:15:00,666 --> 00:15:02,902
the OS and stuff is
designed to be staple.

318
00:15:02,902 --> 00:15:05,905
It'll write everything to
your virtual hard drives

319
00:15:05,905 --> 00:15:08,439
and so if you
migrate this thing,

320
00:15:08,440 --> 00:15:10,175
you've gotta actually
migrate the hard drives.

321
00:15:10,175 --> 00:15:13,579
I'll show you how
that works here,

322
00:15:13,579 --> 00:15:15,981
almost instantaneously,
there you go.

323
00:15:15,981 --> 00:15:20,986
So how PAAS works as
a brief overview is,

324
00:15:21,854 --> 00:15:23,055
oh I have to go back and forth

325
00:15:23,055 --> 00:15:23,988
because I don't
want people thinking

326
00:15:23,989 --> 00:15:24,990
I favor the right or the left

327
00:15:26,058 --> 00:15:28,560
but I'm a left-winger.
(crowd laughs)

328
00:15:30,896 --> 00:15:33,799
Don't want them to hear, so.
(crowd laughs)

329
00:15:33,799 --> 00:15:38,569
So when you spin up on PAAS VM,

330
00:15:38,570 --> 00:15:41,473
if you were to get on
that virtual machine

331
00:15:41,473 --> 00:15:43,208
and like remote
desktop and look,

332
00:15:43,208 --> 00:15:45,577
you'd see you have C
D and E and F drives.

333
00:15:45,577 --> 00:15:48,013
So you'll have, but
the actual hard drives

334
00:15:48,013 --> 00:15:50,115
you're seeing are
running off of things

335
00:15:50,115 --> 00:15:51,717
called differencing
disks, are people

336
00:15:51,717 --> 00:15:52,851
familiar with virtual computing?

337
00:15:52,851 --> 00:15:56,055
If not, the way
virtual computing works

338
00:15:56,055 --> 00:15:58,056
is you can actually have hard
drives that are read-only.

339
00:15:58,057 --> 00:15:59,725
These are virtual hard drives.

340
00:15:59,725 --> 00:16:01,293
Basically you're
reading and writing,

341
00:16:01,293 --> 00:16:03,362
they'll read these
but they're writing

342
00:16:03,362 --> 00:16:04,964
everything to
differencing disks.

343
00:16:04,964 --> 00:16:06,465
So if you kill the
differencing disks

344
00:16:06,465 --> 00:16:08,901
you come back to
these, you start clean.

345
00:16:08,901 --> 00:16:11,670
So the way PAAS works
is that we have these

346
00:16:11,670 --> 00:16:14,205
stock images on all these nodes.

347
00:16:14,206 --> 00:16:16,141
Machines get spun
up, they'll refer

348
00:16:16,141 --> 00:16:17,810
to these base VHDs but they'll

349
00:16:17,810 --> 00:16:20,845
be doing all of their work
on differencing disks.

350
00:16:20,846 --> 00:16:23,148
And so that's what
you're seeing.

351
00:16:23,148 --> 00:16:24,917
A differencing disk
is actually consisted

352
00:16:24,917 --> 00:16:28,120
of everything new plus a
view of the other disks.

353
00:16:28,120 --> 00:16:32,291
What that means is that
if you do a redeployment,

354
00:16:32,291 --> 00:16:33,926
reset this, now I've
gotta run over to here

355
00:16:33,926 --> 00:16:38,597
to the Trump supporters.
(crowd laughs)

356
00:16:41,233 --> 00:16:45,536
Okay, sorry about that, I
thought Texas liked him.

357
00:16:49,241 --> 00:16:51,276
So, sorry about
that, didn't mean to.

358
00:16:52,745 --> 00:16:54,613
I was gonna do this whole
thing like Bernie Sanders

359
00:16:54,613 --> 00:16:57,182
but I just didn't know
how that would work.

360
00:16:57,182 --> 00:16:58,817
My daughter's a big
fan of Bernie Sanders

361
00:16:58,817 --> 00:17:01,453
and I didn't know
how that would work.

362
00:17:01,453 --> 00:17:03,355
(crowd laughs)
So anyway,

363
00:17:03,355 --> 00:17:06,125
when you restart a
PAAS VM it throws away

364
00:17:06,125 --> 00:17:10,529
your differencing disks
and starts up again,

365
00:17:10,529 --> 00:17:12,196
referring to your base disks and

366
00:17:12,196 --> 00:17:13,398
builds new differencing disks.

367
00:17:13,398 --> 00:17:14,966
The reason for that
is you can have,

368
00:17:14,967 --> 00:17:16,702
you have your PAAS
systems running

369
00:17:16,702 --> 00:17:18,203
and you need, oh all of a sudden

370
00:17:18,203 --> 00:17:19,805
it's Christmas sick and you need

371
00:17:20,672 --> 00:17:22,141
to double your computer power.

372
00:17:22,141 --> 00:17:23,342
You can keep spinning these up

373
00:17:23,342 --> 00:17:24,910
and they're all
pointing to the same

374
00:17:24,910 --> 00:17:26,412
persistent storage
so they can work

375
00:17:26,412 --> 00:17:27,880
off the same databases, and then

376
00:17:27,880 --> 00:17:30,015
it's post-Christmas, it's
post Black Friday or whenever.

377
00:17:30,015 --> 00:17:31,383
Everyone takes
back all the gifts

378
00:17:31,383 --> 00:17:35,120
you got them for credit
and then it dies down.

379
00:17:35,120 --> 00:17:38,689
They can get rid of
them, and this will play

380
00:17:38,690 --> 00:17:40,626
into security
questions later on.

381
00:17:40,626 --> 00:17:42,661
Now IAAS is a bit differently.

382
00:17:42,661 --> 00:17:45,397
And I apologize for
the color scheme

383
00:17:45,397 --> 00:17:48,367
but it looked good at the time.

384
00:17:48,367 --> 00:17:51,803
(crowd laughs)
But you spin up

385
00:17:51,804 --> 00:17:54,540
your IAAS, you've
supplied your VHD

386
00:17:54,540 --> 00:17:56,475
which is virtual hard
drive in Microsoft speak.

387
00:17:56,475 --> 00:17:59,511
You've supplied that,
you spin up your VM,

388
00:17:59,511 --> 00:18:01,180
you're looking at your C drive.

389
00:18:01,180 --> 00:18:03,282
You'll have a resource
disk which is basically

390
00:18:03,282 --> 00:18:04,616
for temporary storage and stuff

391
00:18:04,616 --> 00:18:06,185
on the node on the blade server.

392
00:18:06,185 --> 00:18:08,387
And then any data
drives you want.

393
00:18:08,387 --> 00:18:09,754
Now in order to
make these persist,

394
00:18:09,755 --> 00:18:13,192
because remember the
underlying architectural theme

395
00:18:13,192 --> 00:18:14,893
is everything's
supposed to be able

396
00:18:14,893 --> 00:18:17,162
to survive a node going down.

397
00:18:17,162 --> 00:18:18,964
Hardware fails so
the idea is that

398
00:18:18,964 --> 00:18:22,501
you're never gonna die
when a hardware fails.

399
00:18:22,501 --> 00:18:24,735
You'll get your
system back, so disks

400
00:18:24,736 --> 00:18:28,774
are written out to what's
called blob storage.

401
00:18:31,310 --> 00:18:35,746
I did a blog posting about
a year ago on some of this.

402
00:18:35,747 --> 00:18:39,284
So if you look up
How I Stopped Fearing

403
00:18:39,284 --> 00:18:41,086
and Began to Love the
Cloud or something

404
00:18:41,086 --> 00:18:43,322
by Troy Larson you'll find it.

405
00:18:43,322 --> 00:18:44,790
But I kind of talked about some

406
00:18:44,790 --> 00:18:46,992
of the interesting things
that happen with blob storage.

407
00:18:48,127 --> 00:18:51,830
But just my more, I
like in, okay let's see.

408
00:18:51,830 --> 00:18:54,566
It's not the controller
it's the finger.

409
00:18:56,168 --> 00:18:59,404
So these blob storage is
called persistent disk.

410
00:18:59,404 --> 00:19:01,940
The way it works,
if you love getting

411
00:19:01,940 --> 00:19:04,309
into the meat of things
I'll come over here.

412
00:19:04,309 --> 00:19:07,613
So the way you've
got your hypervisor

413
00:19:07,613 --> 00:19:12,050
sitting here, your guest OS,
that's the virtual machine.

414
00:19:12,050 --> 00:19:13,085
It's doing its thing, it thinks

415
00:19:13,085 --> 00:19:14,653
it's writing to its hard drive.

416
00:19:14,653 --> 00:19:16,488
It's actually
getting intercepted.

417
00:19:16,488 --> 00:19:18,357
The IO goes down
to the hypervisor

418
00:19:18,357 --> 00:19:21,226
and then it writes it
out to the local disk.

419
00:19:21,226 --> 00:19:23,629
But there's also drivers
working on the local disk

420
00:19:23,629 --> 00:19:26,430
that then replicate this
all to blob storage.

421
00:19:26,431 --> 00:19:28,467
Blob storage consists
of just a series

422
00:19:28,467 --> 00:19:33,138
of 512 byte page blobs
and everything gets stored

423
00:19:33,138 --> 00:19:35,307
in it just as you're writing it.

424
00:19:35,307 --> 00:19:37,776
It's very very fast,
but what it means

425
00:19:37,776 --> 00:19:39,311
is that if that actual hardware

426
00:19:39,311 --> 00:19:41,280
that's running the
VM fails or you need

427
00:19:41,280 --> 00:19:43,916
to start a VM someplace else,

428
00:19:43,916 --> 00:19:45,650
you can refer to
these disks in storage

429
00:19:45,651 --> 00:19:48,187
to move, migrate,
or recover data.

430
00:19:49,354 --> 00:19:51,323
So enough of that,
so where we get

431
00:19:51,323 --> 00:19:52,824
in the big picture,
I'm watching my time

432
00:19:52,824 --> 00:19:55,694
because I have a habit of
just droning on and on.

433
00:19:55,694 --> 00:19:59,097
At least if you talk to
my daughters about that.

434
00:19:59,097 --> 00:20:00,732
The reason I'm sensitive to this

435
00:20:00,732 --> 00:20:02,533
is 'cause I just
spent a vacation

436
00:20:02,534 --> 00:20:03,769
with them two and a half weeks

437
00:20:03,769 --> 00:20:06,505
driving around Italy
and after a while

438
00:20:06,505 --> 00:20:08,574
teenagers can get
surly in a car.

439
00:20:08,574 --> 00:20:11,276
(crowd laughs)
They can be mean!

440
00:20:12,144 --> 00:20:15,247
Also when your children become,

441
00:20:16,515 --> 00:20:18,150
when your children
reach the drinking age

442
00:20:18,150 --> 00:20:20,586
in the foreign
country you're in,

443
00:20:20,586 --> 00:20:24,890
you get a bar tab, I've really
never had that big of one.

444
00:20:24,890 --> 00:20:29,461
But this was a surprise,
and I shouldn't say more

445
00:20:29,461 --> 00:20:33,031
'cause if they ever
hear this I will suffer.

446
00:20:33,031 --> 00:20:35,500
So anyway the big
picture is what we have.

447
00:20:35,500 --> 00:20:37,069
If you're a defender
of the cloud

448
00:20:37,069 --> 00:20:38,971
I've got this physical
infrastructure.

449
00:20:38,971 --> 00:20:40,405
This physical infrastructure,

450
00:20:41,540 --> 00:20:43,274
we've got these
blades running the VMs

451
00:20:43,275 --> 00:20:45,677
which we call the
hosting environment.

452
00:20:45,677 --> 00:20:48,080
And then we've got a
bunch of services VMs

453
00:20:48,080 --> 00:20:49,581
'cause if you look,
go to the Azure site

454
00:20:49,581 --> 00:20:51,015
you can see you
have Azure web apps.

455
00:20:51,016 --> 00:20:53,085
You have Hadoop, you have all

456
00:20:53,085 --> 00:20:54,553
kinds of things
you can be doing.

457
00:20:54,553 --> 00:20:55,787
So we have a bunch of stuff
up there you can rent.

458
00:20:55,787 --> 00:20:57,756
And then we have
all the tenant VMs.

459
00:20:57,756 --> 00:21:01,426
The way that looks from a
security picture, let's see.

460
00:21:06,098 --> 00:21:10,802
There we go, you guys I'm
not really a graphics artist.

461
00:21:12,471 --> 00:21:16,575
But anyway we have a huge
amount of tenant VMs on top

462
00:21:17,843 --> 00:21:19,544
with all this internet exposure.

463
00:21:19,544 --> 00:21:21,713
We have our services
VMs with surface

464
00:21:21,713 --> 00:21:23,382
exposure but we're
managing them.

465
00:21:24,549 --> 00:21:26,051
And then we've got the
hosting environment

466
00:21:26,051 --> 00:21:29,788
and the infrastructure physical
assets and stuff down there.

467
00:21:29,788 --> 00:21:32,224
So we put the bad
guy and then I put

468
00:21:32,224 --> 00:21:34,426
my picture over there
for the good guy.

469
00:21:35,894 --> 00:21:40,866
So I took liberties, so what are

470
00:21:40,866 --> 00:21:43,068
the challenges with this model?

471
00:21:43,068 --> 00:21:45,504
I'm gonna try to synthesize
it down to some themes.

472
00:21:45,504 --> 00:21:50,274
It's ownership,
responsibility for security.

473
00:21:50,275 --> 00:21:52,678
Then we've got boundaries,
we've got time issues,

474
00:21:52,678 --> 00:21:55,347
and of course the
one people think

475
00:21:55,347 --> 00:21:57,182
I would lead with,
we have scale.

476
00:21:57,182 --> 00:22:02,087
So there we go, ownership,
this may surprise people.

477
00:22:03,355 --> 00:22:06,358
But if you are a
tenant in Azure,

478
00:22:08,994 --> 00:22:11,196
you own your VM and
you own your data.

479
00:22:11,196 --> 00:22:13,298
It is a no trespassing to me on

480
00:22:13,298 --> 00:22:15,334
the security team or to
Microsoft in general.

481
00:22:15,334 --> 00:22:18,136
We have had instances where
one of our big divisions,

482
00:22:18,136 --> 00:22:21,907
we had some bad guys in Azure

483
00:22:21,907 --> 00:22:24,109
who were doing all kinds of
bad things to this division.

484
00:22:24,109 --> 00:22:25,910
This is a big division
responsible for a lot of income.

485
00:22:25,911 --> 00:22:28,013
And they said we need
you to go grab those VHDs

486
00:22:28,013 --> 00:22:30,014
and give them to us,
we need to do forensic.

487
00:22:30,015 --> 00:22:32,284
We gotta figure out what
these guys are doing.

488
00:22:32,284 --> 00:22:34,286
My response backed up
by Microsoft legal is,

489
00:22:34,286 --> 00:22:36,755
you will need to go
get a court order.

490
00:22:38,056 --> 00:22:39,825
I don't care if you're
the Windows division

491
00:22:39,825 --> 00:22:42,961
or the Office division, but
that's the way it works.

492
00:22:42,961 --> 00:22:46,365
That's just not me saying it,
we spell it out in contract.

493
00:22:46,365 --> 00:22:48,133
So if you go on and
you look at the privacy

494
00:22:48,133 --> 00:22:50,435
and ownership, you own the data.

495
00:22:50,435 --> 00:22:52,137
There are very
limited situations

496
00:22:52,137 --> 00:22:54,072
when we can actually
access your data.

497
00:22:55,307 --> 00:22:57,876
Those would be defined
by law and by contract.

498
00:22:57,876 --> 00:22:59,878
They're not gonna be a surprise.

499
00:22:59,878 --> 00:23:01,679
You own it, I can't go on it.

500
00:23:01,680 --> 00:23:03,281
So if your machine
is doing bad stuff,

501
00:23:03,281 --> 00:23:05,117
I may be able to shut
you down, we can shut

502
00:23:05,117 --> 00:23:07,085
you down but I can't
get your stuff.

503
00:23:09,488 --> 00:23:12,524
Now that raises issues
then with security.

504
00:23:12,524 --> 00:23:14,693
When we have this is
my idea of indicating

505
00:23:14,693 --> 00:23:16,728
the security event,
putting a red band

506
00:23:16,728 --> 00:23:18,663
representing a bad
VM or something.

507
00:23:18,663 --> 00:23:21,833
So we get all the time,
you might can imagine

508
00:23:21,833 --> 00:23:23,502
you get all different
grades of people

509
00:23:23,502 --> 00:23:25,169
putting up machines in Azure.

510
00:23:25,170 --> 00:23:27,506
From people who got
their free trials

511
00:23:27,506 --> 00:23:30,108
from MSDN and are running stuff.

512
00:23:30,108 --> 00:23:32,310
We've got loads of
testers who set up stuff

513
00:23:32,310 --> 00:23:33,578
and then leave it
running forever

514
00:23:33,578 --> 00:23:35,414
without ever
looking at it again.

515
00:23:35,414 --> 00:23:37,581
And I think we all know what
kind of problem that can be.

516
00:23:37,582 --> 00:23:39,484
And we've got tenants and stuff.

517
00:23:39,484 --> 00:23:42,220
So we'll get these bad
things from time to time.

518
00:23:42,220 --> 00:23:43,655
So how is it that we respond

519
00:23:43,655 --> 00:23:45,389
when you have this ownership
and management issue?

520
00:23:45,390 --> 00:23:50,028
Well, there we go, see
it doesn't get, yep.

521
00:23:50,028 --> 00:23:52,964
This has been spelled
out some blog postings

522
00:23:52,964 --> 00:23:54,633
and you'll see in other
places in Microsoft website.

523
00:23:54,633 --> 00:23:56,435
We call it the shared
security model.

524
00:23:56,435 --> 00:23:57,769
I'm pretty certain
I've read stuff

525
00:23:57,769 --> 00:23:59,271
with AWS is doing
the same thing,

526
00:23:59,271 --> 00:24:01,273
that's the Amazon Web Services.

527
00:24:01,273 --> 00:24:04,141
It's based on management
and ownership.

528
00:24:04,142 --> 00:24:07,379
We're gonna be responsible
for the infrastructure

529
00:24:07,379 --> 00:24:09,147
in the hosting
environment and you will

530
00:24:09,147 --> 00:24:11,716
be responsible, you as tenant,

531
00:24:11,716 --> 00:24:14,285
for maintaining the
security of your own assets.

532
00:24:14,286 --> 00:24:16,121
We don't get to look
at your event logs.

533
00:24:16,121 --> 00:24:17,389
I don't know if
your system's bad.

534
00:24:17,389 --> 00:24:19,390
We might figure out
you have a bad system

535
00:24:19,391 --> 00:24:20,859
because all of a
sudden we're seeing

536
00:24:20,859 --> 00:24:22,961
network traffic hitting
other tenants or something.

537
00:24:22,961 --> 00:24:24,529
But we're not
monitoring your system,

538
00:24:24,529 --> 00:24:26,598
I don't know if you have
virus events coming off.

539
00:24:26,598 --> 00:24:28,700
I don't know if
someone's taking over it.

540
00:24:28,700 --> 00:24:31,169
And so this is
where it comes in.

541
00:24:31,169 --> 00:24:34,372
The security model, I like to
go back to my vacation model.

542
00:24:34,372 --> 00:24:36,475
Whoops, wrong one, did I
shoot anyone in the eyes?

543
00:24:36,475 --> 00:24:38,677
I probably shot the
camera with the laser.

544
00:24:38,677 --> 00:24:41,413
It probably, okay
so that green dot

545
00:24:41,413 --> 00:24:43,548
that you'll see in
all the other videos,

546
00:24:43,548 --> 00:24:47,285
that's my bad, sorry.
(crowd laughs)

547
00:24:47,285 --> 00:24:49,321
Anyway so if we get this
down to vacation model,

548
00:24:49,321 --> 00:24:53,257
and I have to look at
it, so Microsoft promises

549
00:24:53,258 --> 00:24:56,228
to give you a good RV, you know
we check the tire pressure.

550
00:24:56,228 --> 00:24:59,297
The engine's good, the walls,
everything closes and stuff.

551
00:24:59,297 --> 00:25:02,534
But we cannot prevent you
from driving it off a cliff.

552
00:25:03,702 --> 00:25:05,570
We cannot prevent you
from leaving your wallet

553
00:25:05,570 --> 00:25:08,206
and the keys in the
ignition and going

554
00:25:08,206 --> 00:25:10,274
into the bathroom
at a truck stop.

555
00:25:11,476 --> 00:25:13,812
So that's why I made
this vacation model.

556
00:25:13,812 --> 00:25:16,648
I think it bears things
out, so you own the VM.

557
00:25:16,648 --> 00:25:18,617
And you're responsible
for monitoring,

558
00:25:18,617 --> 00:25:21,485
you're responsible for
setting up the security.

559
00:25:21,486 --> 00:25:23,455
Now even with PAAS where
we're providing you

560
00:25:23,455 --> 00:25:26,157
the hotel room with everything.

561
00:25:26,157 --> 00:25:29,561
We're still, you're
coming in there.

562
00:25:29,561 --> 00:25:31,362
We can't make sure
you lock the door.

563
00:25:31,363 --> 00:25:32,931
We can't make sure
you're putting

564
00:25:32,931 --> 00:25:35,800
your valuables in the
safe, which I also

565
00:25:35,800 --> 00:25:37,802
understand from these
isn't all that secure.

566
00:25:37,802 --> 00:25:42,040
(crowd laughs)
So even though

567
00:25:42,040 --> 00:25:44,009
there's this, like you say
they're responsible for this.

568
00:25:44,009 --> 00:25:46,278
Basically you own your VM,
you're responsible for your own.

569
00:25:46,278 --> 00:25:48,980
You need to set up the
monitoring for it and the like.

570
00:25:48,980 --> 00:25:51,016
We own the stuff underneath
it and then we have

571
00:25:51,016 --> 00:25:54,352
to try to mix together
when there are incidents.

572
00:25:56,021 --> 00:25:58,290
Let's see, there we
go, the other challenge

573
00:25:58,290 --> 00:26:00,425
or the next big
challenge is boundaries.

574
00:26:00,425 --> 00:26:02,761
Azure like most cloud
services aspires to be global.

575
00:26:02,761 --> 00:26:04,930
Well we are global,
but there's all

576
00:26:04,930 --> 00:26:07,465
these boundaries and
there's all these rules.

577
00:26:07,465 --> 00:26:09,466
If you work for a
company that spans

578
00:26:09,467 --> 00:26:12,237
geographical boundaries
especially in Europe,

579
00:26:12,237 --> 00:26:13,371
you'll know there's a whole set

580
00:26:13,371 --> 00:26:14,839
of different rules that apply

581
00:26:15,974 --> 00:26:16,640
there, even for
your own employees.

582
00:26:18,076 --> 00:26:19,344
Back when we were doing
enterprise investigations,

583
00:26:19,344 --> 00:26:20,745
we think we have a
problem in the UK

584
00:26:20,745 --> 00:26:23,548
or Germany and others,
we just can't jump

585
00:26:23,548 --> 00:26:26,918
on and do stuff like we
might do in the countries

586
00:26:26,918 --> 00:26:30,722
like India, China,
and US where we could

587
00:26:30,722 --> 00:26:33,091
just go on anybody's computer
and do anything at any time.

588
00:26:33,091 --> 00:26:35,560
It's different rules, so
that's for enterprise.

589
00:26:35,560 --> 00:26:37,829
I'm not talking
cloud, well it's much

590
00:26:37,829 --> 00:26:42,834
more strict in the cloud space,

591
00:26:44,002 --> 00:26:46,705
because the ownership
issues and the like.

592
00:26:46,705 --> 00:26:48,706
I can't bring data
back, we think

593
00:26:48,707 --> 00:26:50,775
we have a problem in
the Dublin datacenter.

594
00:26:50,775 --> 00:26:52,477
Although something's going on,

595
00:26:52,477 --> 00:26:56,915
I can't bring those VMs and
memory or anything like that.

596
00:26:56,915 --> 00:26:58,950
I can't bring it back
to our lab in Redmond.

597
00:26:58,950 --> 00:27:00,819
That stuff can't leave Dublin.

598
00:27:00,819 --> 00:27:02,721
Or it can't leave the datacenter

599
00:27:02,721 --> 00:27:06,791
in Amsterdam or whatever,
or Shanghai or Tokyo.

600
00:27:06,791 --> 00:27:08,726
It has to stay there, so we have

601
00:27:08,727 --> 00:27:12,464
to go to where the
data is to work.

602
00:27:13,632 --> 00:27:15,333
Now it used to be
in the old as admin

603
00:27:15,333 --> 00:27:17,969
I got a trip to Dublin, but now
because it's cloud of course

604
00:27:17,969 --> 00:27:20,171
I'm still sitting in Redmond
and everything's virtual.

605
00:27:20,171 --> 00:27:23,108
So I can go home and say
I worked all day in Dublin

606
00:27:23,108 --> 00:27:25,644
and no one cares because I
was just sitting in Redmond.

607
00:27:25,644 --> 00:27:27,712
But it seemed cool
to me at the time.

608
00:27:30,115 --> 00:27:31,850
But those boundaries are
a very strict problem.

609
00:27:31,850 --> 00:27:34,886
Every time we get an issue,
it's like bring in lawyers.

610
00:27:34,886 --> 00:27:37,187
Luckily we've got some
really good lawyers

611
00:27:37,188 --> 00:27:39,924
that work with us in our team.

612
00:27:39,924 --> 00:27:41,292
Let's see where I'm
sitting on time.

613
00:27:41,292 --> 00:27:42,894
Oh my gosh it's
already tomorrow,

614
00:27:42,894 --> 00:27:45,830
I'm sorry.
(crowd laughs)

615
00:27:45,830 --> 00:27:49,100
So time, time can be
a great big challenge

616
00:27:49,100 --> 00:27:54,105
if you're defending a cloud
because things can change.

617
00:27:55,507 --> 00:27:58,276
You have scale but you have
scalability which means

618
00:27:58,276 --> 00:28:00,879
spinning up, spinning
down, moving things around.

619
00:28:00,879 --> 00:28:04,482
As a consequence VMs can exist

620
00:28:04,482 --> 00:28:06,051
for a day, they can disappear.

621
00:28:06,051 --> 00:28:10,155
Bad guys can come on for a
week, they take it all down.

622
00:28:10,155 --> 00:28:11,356
They can delete their stuff out

623
00:28:11,356 --> 00:28:12,824
of storage and then
I have nothing.

624
00:28:12,824 --> 00:28:14,926
You know if you take, if
you have a running computer

625
00:28:14,926 --> 00:28:16,761
and there's something
going on with it,

626
00:28:16,761 --> 00:28:21,232
it takes a long time to,
you can turn the computer

627
00:28:21,232 --> 00:28:22,600
off pretty quickly but it takes

628
00:28:22,600 --> 00:28:25,169
quite a while to say
wipe a hard drive.

629
00:28:25,170 --> 00:28:26,838
In Azure, I think
something's up,

630
00:28:26,838 --> 00:28:31,042
I shut down my VM, I delete
any VHDs that are in storage.

631
00:28:31,042 --> 00:28:34,913
It's gone, it's gone, it's
gonna be hard to get to.

632
00:28:34,913 --> 00:28:39,918
But it's very ephemeral, things
are designed to move around.

633
00:28:41,052 --> 00:28:42,286
They're designed
to be very dynamic.

634
00:28:42,287 --> 00:28:44,389
Of all of these,
probably the most

635
00:28:44,389 --> 00:28:46,190
dynamic of all is
the IP addresses.

636
00:28:46,191 --> 00:28:47,492
'Cause every
machine gets spun up

637
00:28:47,492 --> 00:28:49,260
has to have a
certain IP address.

638
00:28:49,260 --> 00:28:51,262
But they'll also have
public IP addresses.

639
00:28:51,262 --> 00:28:53,565
And there could be a
time when these addresses

640
00:28:53,565 --> 00:28:56,601
are in flux, you might have
a machine running for a week.

641
00:28:56,601 --> 00:28:58,169
Then that one goes down,
a new one comes up.

642
00:28:58,169 --> 00:28:59,971
It runs for a bit, for
whatever reason it goes down.

643
00:28:59,971 --> 00:29:02,207
So being able to pick,
go from an IP address

644
00:29:02,207 --> 00:29:05,643
to any particular machine
at any particular time

645
00:29:05,643 --> 00:29:09,380
can be a challenge, so you need

646
00:29:09,380 --> 00:29:10,582
good logging and stuff for this.

647
00:29:10,582 --> 00:29:14,052
But you have to understand that

648
00:29:14,052 --> 00:29:16,187
stuff can disappear
very quickly.

649
00:29:20,692 --> 00:29:24,329
Just when I think
I've got it, oh yeah.

650
00:29:25,764 --> 00:29:29,067
So these next slides, if
they make no sense at all.

651
00:29:29,067 --> 00:29:31,669
I was trying to comply, Rob
sends his speakers out this

652
00:29:31,669 --> 00:29:35,140
great big list of things, how
to be an interesting speaker.

653
00:29:36,207 --> 00:29:40,278
Which I am interested
in, thank you.

654
00:29:40,278 --> 00:29:43,047
Thank you.
(crowd laughs)

655
00:29:43,047 --> 00:29:46,484
So how was I gonna,
how do I do scale?

656
00:29:46,484 --> 00:29:51,156
And then I did okay it's
a Bing search scale.

657
00:29:52,357 --> 00:29:56,127
But if you say your
little home network

658
00:29:56,127 --> 00:30:01,132
is maybe Mars, a little
small office may be Earth.

659
00:30:02,167 --> 00:30:05,336
A bigger office may be Jupiter.

660
00:30:05,336 --> 00:30:08,306
You've got your enterprise
maybe coming in at Sirius A.

661
00:30:09,674 --> 00:30:13,545
Then gigantic enterprise,
global maybe is Alderaan, well.

662
00:30:13,545 --> 00:30:18,550
(crowd laughs)
Thanks.

663
00:30:22,987 --> 00:30:24,989
This is like shadow
boxing but I always

664
00:30:24,989 --> 00:30:27,058
end up hurting myself
when I shadow box.

665
00:30:27,058 --> 00:30:30,261
And then you have
the cloud services.

666
00:30:32,230 --> 00:30:37,235
So you can have obviously
AWS is gonna be way over here

667
00:30:38,369 --> 00:30:39,603
and we hope to be
somewhere over in here.

668
00:30:39,604 --> 00:30:43,141
But it's massive and
it does present issues.

669
00:30:44,642 --> 00:30:47,912
'Cause you can have a lot of
things going wrong at once.

670
00:30:47,912 --> 00:30:49,514
And one of our biggest
areas, for example

671
00:30:49,514 --> 00:30:53,717
we have people
spinning up bad VMs.

672
00:30:54,919 --> 00:30:57,388
And then can spin
them up in quantity

673
00:30:57,388 --> 00:31:01,226
'cause the whole
design aspect of Azure

674
00:31:01,226 --> 00:31:05,396
is that you can spin up lots
of machines very quickly.

675
00:31:05,396 --> 00:31:07,398
Because it's global you can have

676
00:31:07,398 --> 00:31:08,666
things happening all the time.

677
00:31:08,666 --> 00:31:10,168
Little incident here, a
little incident there.

678
00:31:10,168 --> 00:31:12,270
It all adds up when
you, pretty soon

679
00:31:12,270 --> 00:31:14,472
the security team
isn't going home.

680
00:31:14,472 --> 00:31:18,142
They're missing
their graduations for
their kids and stuff.

681
00:31:18,142 --> 00:31:21,980
So to make it all work
because of the scale,

682
00:31:21,980 --> 00:31:24,782
you really have to start
thinking how do you scale up?

683
00:31:24,782 --> 00:31:26,918
This is one of the big
challenges of defend,

684
00:31:26,918 --> 00:31:29,454
how do you scale
up a defense effort

685
00:31:29,454 --> 00:31:34,459
to match the scope of
what you are defending?

686
00:31:36,027 --> 00:31:39,697
I don't have an answer,
no I'm working on that.

687
00:31:39,697 --> 00:31:44,135
So underlying all this is
you have to keep in mind

688
00:31:44,135 --> 00:31:46,104
that the cloud is a
very attractive thing

689
00:31:46,104 --> 00:31:48,973
to an adversary or a bad guy.

690
00:31:50,208 --> 00:31:54,646
For one, AWS, Azure,
other cloud vendors

691
00:31:54,646 --> 00:31:56,380
they want people to learn the
cloud, lots of free trials.

692
00:31:56,381 --> 00:31:59,617
A lot use MSDN, BizSpark, you go

693
00:31:59,617 --> 00:32:02,486
to conferences with Microsoft,
we give people so much time.

694
00:32:02,487 --> 00:32:05,089
Well those get stolen,
there are brokers in it.

695
00:32:05,089 --> 00:32:07,524
But bad guys love to get free
trials and spin up machines.

696
00:32:07,525 --> 00:32:09,260
Even if we catch
them, they're running

697
00:32:09,260 --> 00:32:11,195
for a couple weeks, you
can do a lot of things.

698
00:32:11,195 --> 00:32:12,397
And if you just keep them going

699
00:32:12,397 --> 00:32:14,599
you can just keep doing
bad stuff on and on.

700
00:32:14,599 --> 00:32:16,634
So there's this
whole free trial.

701
00:32:16,634 --> 00:32:17,936
And there's the
unofficial free trials

702
00:32:17,936 --> 00:32:20,705
which you use stolen
credit card information

703
00:32:20,705 --> 00:32:22,340
for example to set things up.

704
00:32:22,340 --> 00:32:26,444
So I guess it's a poor man's
free trial or something.

705
00:32:27,812 --> 00:32:29,647
And why do they wanna do this?

706
00:32:29,647 --> 00:32:31,149
Well you get all this
free computing trial

707
00:32:31,149 --> 00:32:33,918
and it's not sitting in you,
it's harder to attribute.

708
00:32:33,918 --> 00:32:35,218
It's sitting in the
Microsoft cloud.

709
00:32:35,219 --> 00:32:36,654
We don't know who
owned it, we can see

710
00:32:36,654 --> 00:32:40,758
logging in coming from Turkey
and Vietnam and Tucson.

711
00:32:41,993 --> 00:32:46,998
Tucson, but Texas was
fighting with Arizona,

712
00:32:48,099 --> 00:32:49,333
am I wrong, is there,
missed that no?

713
00:32:50,468 --> 00:32:54,205
I just totally
made that up, okay.

714
00:32:54,205 --> 00:32:56,040
(crowd laughs)
Anyway, on top of that,

715
00:32:56,040 --> 00:32:59,077
you then all the
tenants and they've

716
00:32:59,077 --> 00:33:01,179
got internet exposed services.

717
00:33:01,179 --> 00:33:03,514
And they've got
internet exposed VMs.

718
00:33:03,514 --> 00:33:06,351
It's a very attractive
area both to reside in

719
00:33:06,351 --> 00:33:09,053
and to attack, do stuff there.

720
00:33:12,757 --> 00:33:14,158
The other thing that
works against us

721
00:33:14,158 --> 00:33:16,026
is that trying to defend this,

722
00:33:16,027 --> 00:33:19,931
it's not like a domain
or an enterprise network.

723
00:33:19,931 --> 00:33:22,867
It's not even like a big
giant enterprise network.

724
00:33:22,867 --> 00:33:26,236
I've worked on one of
those now for decades.

725
00:33:26,237 --> 00:33:29,240
It's highly
segmented, firewalled,

726
00:33:30,408 --> 00:33:31,641
and like you might see
this as a collection

727
00:33:31,642 --> 00:33:35,146
of tens of thousands
of individual work

728
00:33:35,146 --> 00:33:37,415
stations that are
not domain joined.

729
00:33:37,415 --> 00:33:40,184
Different accounts, different
firewall rules and stuff.

730
00:33:40,184 --> 00:33:43,087
So it's, and this is even
at the infrastructure level.

731
00:33:43,087 --> 00:33:44,655
You don't have a
domain going under.

732
00:33:44,655 --> 00:33:46,524
You don't have something
like a domain account

733
00:33:46,524 --> 00:33:49,526
where you can run
something like Kanza,

734
00:33:51,295 --> 00:33:53,097
Dave that was
calling out for you.

735
00:33:53,097 --> 00:33:55,333
Across your
infrastructure because

736
00:33:55,333 --> 00:33:57,068
of accounts and
firewall settings.

737
00:33:57,068 --> 00:34:00,004
So the stuff that
worked in the enterprise

738
00:34:00,004 --> 00:34:02,005
doesn't work in
the cloud, you have

739
00:34:02,006 --> 00:34:04,642
to have a new model of
doing things at scale.

740
00:34:04,642 --> 00:34:06,778
So that presents
a big challenge.

741
00:34:06,778 --> 00:34:09,414
Now with all of that, I don't
wanna unduly depress people.

742
00:34:09,414 --> 00:34:11,916
So I thought I'd move
on to the opportunities.

743
00:34:13,184 --> 00:34:14,952
There are lots of opportunities,

744
00:34:14,952 --> 00:34:16,421
meaning really fun
things or areas

745
00:34:16,420 --> 00:34:19,524
that I'm excited about
in cloud computing.

746
00:34:21,225 --> 00:34:24,094
Top among those, I love doing
virtual machine forensics.

747
00:34:24,094 --> 00:34:25,529
It's the best kind of
forensics there is.

748
00:34:25,530 --> 00:34:27,799
I should have a song
that goes with that.

749
00:34:27,799 --> 00:34:30,534
And then you've got all
those cloud resources

750
00:34:30,534 --> 00:34:34,871
you can bring to
bear and the like.

751
00:34:34,871 --> 00:34:37,408
And then there's some
aspects about time and scale

752
00:34:37,408 --> 00:34:40,944
that initially you think they
work against the defender.

753
00:34:40,945 --> 00:34:43,114
You can actually make
work for the defender.

754
00:34:43,114 --> 00:34:45,483
So that time it worked,
that's what I need,

755
00:34:45,483 --> 00:34:47,885
I need to be assertive, I need

756
00:34:47,885 --> 00:34:48,986
to be assertive when I do that.

757
00:34:48,985 --> 00:34:50,688
So speakers be
assertive when you press

758
00:34:50,688 --> 00:34:53,124
this button, that'll
move your slides.

759
00:34:53,123 --> 00:34:54,859
(crowd laughs)
So the thing about

760
00:34:54,859 --> 00:34:58,729
virtual machine
forensics is the disks,

761
00:34:58,729 --> 00:35:01,665
your virtual disks
are files on the host.

762
00:35:01,666 --> 00:35:04,802
I can get those
in nearly perfect,

763
00:35:04,802 --> 00:35:07,538
like stopping machine, even
if the machine is running it.

764
00:35:07,538 --> 00:35:09,674
I can knock persistent
shadow copies on a host

765
00:35:09,674 --> 00:35:13,277
and I can get a perfect
copy of a drive.

766
00:35:14,412 --> 00:35:16,080
Not like a copy of it running

767
00:35:16,080 --> 00:35:17,949
where it's going for a while.

768
00:35:17,949 --> 00:35:19,383
This copy of the
drive will, I can go

769
00:35:19,383 --> 00:35:20,618
put on system and it will boot.

770
00:35:20,618 --> 00:35:24,221
It will run, so
perfect copies of disk.

771
00:35:24,222 --> 00:35:28,826
The memory of a virtual
machine is in what's called

772
00:35:28,826 --> 00:35:33,197
the guest physical
address space on the host.

773
00:35:33,197 --> 00:35:35,299
And there are lots of
ways to get at that.

774
00:35:35,299 --> 00:35:38,269
My two preferred ways,
coming from Hyper-V,

775
00:35:38,269 --> 00:35:39,569
is to put things in a safe state

776
00:35:39,570 --> 00:35:42,440
where you save stuff
off and it actually,

777
00:35:42,440 --> 00:35:44,642
you get an encapsulation
of the memory.

778
00:35:44,642 --> 00:35:48,212
And the disks are all
stop run in good shape.

779
00:35:48,212 --> 00:35:50,515
Or doing things
like VM snapshots.

780
00:35:50,515 --> 00:35:53,683
None of those quite works
the way you think in Azure.

781
00:35:53,684 --> 00:35:56,020
And I don't have
time to explain it

782
00:35:56,020 --> 00:35:58,222
but even in Azure
with the limitations

783
00:35:58,222 --> 00:36:01,592
that I have and the
like, when you're

784
00:36:01,592 --> 00:36:04,095
working with VMs you
can get as perfect

785
00:36:04,095 --> 00:36:06,464
copies of evidence as possible.

786
00:36:06,464 --> 00:36:08,266
So I get memory dumps that I can

787
00:36:08,266 --> 00:36:11,469
throw into Windows Debug
and run thoroughly.

788
00:36:11,469 --> 00:36:15,673
It's a beautiful thing, okay.

789
00:36:15,673 --> 00:36:17,774
Now the other thing
on the analytical side

790
00:36:17,775 --> 00:36:20,178
is because you're
dealing with files,

791
00:36:21,512 --> 00:36:22,914
you've got some
interesting prospects.

792
00:36:22,914 --> 00:36:25,016
One of them is say
with the PAAS disk,

793
00:36:25,016 --> 00:36:27,451
because I have this parent VHD

794
00:36:27,451 --> 00:36:29,353
and then this differencing disk.

795
00:36:29,353 --> 00:36:30,821
When I go out and
collect it I'll collect

796
00:36:30,821 --> 00:36:33,391
that differencing disk, now
I have this parent disk.

797
00:36:33,391 --> 00:36:34,792
I can hash everything in there

798
00:36:34,792 --> 00:36:36,494
and then when I'm looking
the so full disks,

799
00:36:36,494 --> 00:36:38,796
or the picture presented
by the differencing disk,

800
00:36:38,796 --> 00:36:40,564
and the parent disk together,

801
00:36:40,565 --> 00:36:43,134
I can subtract everything
that's supposed to be there.

802
00:36:43,134 --> 00:36:45,269
I'm only looking at
the stuff that's new.

803
00:36:45,269 --> 00:36:49,674
So I got this small subset
of disk stuff to look at.

804
00:36:49,674 --> 00:36:51,509
It's refined, it
helps to refine it.

805
00:36:51,509 --> 00:36:53,244
You can also do that
if you have IAAS disks.

806
00:36:53,244 --> 00:36:55,680
So people, they've
got their own stuff.

807
00:36:55,680 --> 00:36:58,716
Typically they'll, I have my
VHD, this is my model VHD.

808
00:36:58,716 --> 00:36:59,817
I copy it to the cloud, now I'll

809
00:36:59,817 --> 00:37:02,320
just use this as
to build my VMs.

810
00:37:02,320 --> 00:37:04,355
And all of its sys prep,
but I'll just spin it,

811
00:37:04,355 --> 00:37:07,992
but you still have your
base OS images in this file.

812
00:37:07,992 --> 00:37:12,997
So you can use those in
whittling down your data

813
00:37:14,131 --> 00:37:18,301
to a, oh it doesn't
work, alohomora.

814
00:37:22,073 --> 00:37:24,609
(crowd laughs)
Okay, thank you.

815
00:37:24,609 --> 00:37:29,614
Cloud resources,
this is really cool

816
00:37:31,015 --> 00:37:32,516
and it takes a while to get
used to what you can do.

817
00:37:32,516 --> 00:37:36,921
I mentioned how we have
a problem in the Timbuktu

818
00:37:38,089 --> 00:37:39,824
datacenter, I've gotta
somehow go to Timbuktu.

819
00:37:39,824 --> 00:37:41,759
Well it's really easy if you own

820
00:37:41,759 --> 00:37:42,994
all the cloud infrastructure.

821
00:37:42,994 --> 00:37:45,963
'Cause I just go there
in that datacenter.

822
00:37:45,963 --> 00:37:48,499
I can set up any number of VHDs.

823
00:37:48,499 --> 00:37:50,468
I can have some
running my volatility,

824
00:37:50,468 --> 00:37:52,236
I can have some running explays.

825
00:37:52,236 --> 00:37:55,439
I can have some there
just so I have my

826
00:37:55,439 --> 00:37:58,942
Facebook page open
without doing stuff.

827
00:38:01,245 --> 00:38:03,180
So we can set up this
compute wherever we need to.

828
00:38:03,180 --> 00:38:05,448
Or I have a big case in
Redmond or something,

829
00:38:05,449 --> 00:38:07,685
we can just spun up
the VMs to do that.

830
00:38:07,685 --> 00:38:10,453
So it's nice to have a lab
that you can expand to need.

831
00:38:11,622 --> 00:38:13,457
We've got nearly,
I put unlimited

832
00:38:13,457 --> 00:38:15,426
'cause I didn't wanna
overburden it with text.

833
00:38:15,426 --> 00:38:17,161
Rob says people
don't wanna read.

834
00:38:18,763 --> 00:38:20,998
Well it didn't say
that, I kind of

835
00:38:20,998 --> 00:38:22,566
read that into
what he was saying.

836
00:38:22,566 --> 00:38:24,868
But anyway you've got
all this storage space.

837
00:38:24,869 --> 00:38:26,637
So I can just copy
VHDs and I can

838
00:38:26,637 --> 00:38:29,874
have work product and I can
do recovery shadow copies

839
00:38:29,874 --> 00:38:31,408
or whatever and I've
got all this space.

840
00:38:31,409 --> 00:38:34,612
So I don't have
to, in the old days

841
00:38:34,612 --> 00:38:36,747
go hey boss I'm
out of hard drive.

842
00:38:36,747 --> 00:38:38,883
I need to go to Hard
Drives Northwest

843
00:38:38,883 --> 00:38:41,919
and pick up a couple
terabyte drives or something.

844
00:38:41,919 --> 00:38:43,921
It's right there, and then
we have this bandwidth.

845
00:38:43,921 --> 00:38:45,388
And this bandwidth especially

846
00:38:45,389 --> 00:38:47,158
when you're working in the
same datacenter is phenomenal.

847
00:38:47,158 --> 00:38:49,827
You're taking this
100 gigabyte drives

848
00:38:49,827 --> 00:38:52,797
and it's just minutes
to move them around.

849
00:38:54,732 --> 00:38:59,403
It's really a fun
environment to work in.

850
00:38:59,403 --> 00:39:02,573
Plus we have, as we
learn to leverage it,

851
00:39:02,573 --> 00:39:04,607
you've got table storage,
we've got databases,

852
00:39:04,608 --> 00:39:06,143
we can do all kinds of stuff.

853
00:39:06,143 --> 00:39:09,447
Distributed computing, do all
kinds of interesting things.

854
00:39:10,881 --> 00:39:15,886
So, phew, okay,
then there's time.

855
00:39:17,088 --> 00:39:18,356
Now originally I put
time as an obstacle.

856
00:39:18,356 --> 00:39:20,791
Time can actually
help us in a way.

857
00:39:20,791 --> 00:39:23,961
For one, I mentioned
PAAS machines,

858
00:39:23,961 --> 00:39:26,997
you redeploy they're clean now.

859
00:39:27,998 --> 00:39:30,034
This gives you the, do you need

860
00:39:30,034 --> 00:39:33,204
to do forensics if you
can completely clean up?

861
00:39:33,204 --> 00:39:36,574
Well, it changes the
dynamic, it's very easy.

862
00:39:36,574 --> 00:39:38,676
I've got oh we've
got a intruder in.

863
00:39:38,676 --> 00:39:40,177
We've gotta clean the network.

864
00:39:41,345 --> 00:39:44,582
Redeploy, it's clean,
so in some ways it's fun

865
00:39:44,582 --> 00:39:46,384
'cause you've got to articulate

866
00:39:46,384 --> 00:39:48,652
why you would need to
do forensics and when.

867
00:39:48,652 --> 00:39:50,054
And it's just not at everything.

868
00:39:50,054 --> 00:39:52,456
Known attacks, things like that,

869
00:39:52,456 --> 00:39:54,325
it's easier to clean
up than do that.

870
00:39:58,562 --> 00:39:59,997
But it does raise the question:

871
00:39:59,997 --> 00:40:03,200
what is our role in a world
of stateless machines?

872
00:40:04,702 --> 00:40:07,238
Is that foreboding, it's
supposed to be foreboding.

873
00:40:09,407 --> 00:40:10,841
Then we have the
ephemeral nature.

874
00:40:10,841 --> 00:40:12,743
Now this can be a
thing against you

875
00:40:12,743 --> 00:40:15,679
but it also means if you put
the right logging in place,

876
00:40:17,081 --> 00:40:20,284
a lot of your really good end
analytics is done entirely

877
00:40:20,284 --> 00:40:22,653
by logs 'cause that's all
that's there persisting.

878
00:40:22,653 --> 00:40:23,921
But you can look
at process events

879
00:40:23,921 --> 00:40:26,557
and logon events and
things like that.

880
00:40:26,557 --> 00:40:28,091
And get a good understanding
of what happened

881
00:40:28,092 --> 00:40:29,293
even when everything
else is gone.

882
00:40:30,628 --> 00:40:32,696
I should've put a
slide in, I was just

883
00:40:32,696 --> 00:40:33,898
thinking this morning I
should add this slide.

884
00:40:33,898 --> 00:40:35,433
I did a magic quadrant
where I basically

885
00:40:35,433 --> 00:40:39,270
took the value of certain
evidence in resolving a case

886
00:40:39,270 --> 00:40:43,707
versus what I call the cost
to exhaust the evidence.

887
00:40:43,707 --> 00:40:45,776
The nice thing is if you've got

888
00:40:45,776 --> 00:40:49,513
sufficiently well-tuned logging,

889
00:40:49,513 --> 00:40:53,717
right up here in the gold area
of the quadrant is logging.

890
00:40:53,717 --> 00:40:56,153
It's very, the most dispositive.

891
00:40:56,153 --> 00:40:58,756
It's quite a, it's very valuable

892
00:40:58,756 --> 00:41:01,759
evidence, usually dispositive.

893
00:41:01,759 --> 00:41:03,727
And it's the lowest
cost to exhaust.

894
00:41:03,727 --> 00:41:05,129
So you could do a
lot of your work

895
00:41:05,129 --> 00:41:09,098
in that section of the quadrant
that is most economical.

896
00:41:10,801 --> 00:41:15,806
Now scale, this is one that
has dawned on me over time.

897
00:41:16,941 --> 00:41:19,410
Scale can be your enemy
because it's so big.

898
00:41:19,410 --> 00:41:24,415
But scale can actually be
incredibly useful in forensics.

899
00:41:25,983 --> 00:41:29,653
It comes in several years ago
at a SANS DFIR conference,

900
00:41:29,653 --> 00:41:31,187
as Jesse Kornblum said the thing

901
00:41:31,188 --> 00:41:33,090
we don't understand
is what is normal.

902
00:41:34,492 --> 00:41:37,595
Well scale can answer
that question at runtime.

903
00:41:37,595 --> 00:41:39,730
What is normal with
machines running?

904
00:41:39,730 --> 00:41:41,799
Because of the way especially

905
00:41:41,799 --> 00:41:43,100
in PAAS rules the way it works.

906
00:41:43,100 --> 00:41:44,735
You have a deployment,
there is this,

907
00:41:44,735 --> 00:41:48,205
like this I need to set
up an infrastructure,

908
00:41:48,205 --> 00:41:49,874
an architecture in the
cloud to do something.

909
00:41:49,874 --> 00:41:53,109
That's my deployment,
the deployment will
consist of roles.

910
00:41:53,110 --> 00:41:56,080
These will be, I need
machine for the front end.

911
00:41:56,080 --> 00:41:58,215
So the web roles, I
need back end machines.

912
00:41:58,215 --> 00:42:01,051
I need SQL machines, so
each of those are roles.

913
00:42:01,051 --> 00:42:03,087
Inside of every role
you have instances.

914
00:42:03,087 --> 00:42:04,588
These are the individual VMs.

915
00:42:04,588 --> 00:42:06,824
Now the thing at scale,
you have literally

916
00:42:06,824 --> 00:42:10,728
either scores to thousands
of identical machines.

917
00:42:10,728 --> 00:42:14,265
Completely identical, they're
identical configuration.

918
00:42:14,265 --> 00:42:18,769
OS volumes, the applications,
the role they'll do,

919
00:42:18,769 --> 00:42:20,303
the accounts, everything there.

920
00:42:21,872 --> 00:42:25,241
And this presents a
very interesting thing.

921
00:42:25,242 --> 00:42:29,747
If you have an instant,
you simply compare

922
00:42:29,747 --> 00:42:33,716
to what is supposed
to be in the role.

923
00:42:33,717 --> 00:42:36,320
So I actually have a model
of the file properties.

924
00:42:36,320 --> 00:42:38,522
I can look at the registry,
now the timestamps

925
00:42:38,522 --> 00:42:41,258
may be different but it should

926
00:42:41,258 --> 00:42:42,625
have the exact same
registry settings.

927
00:42:42,626 --> 00:42:44,862
It should have
the same accounts.

928
00:42:44,862 --> 00:42:47,231
It should have the
same everything.

929
00:42:47,231 --> 00:42:49,500
And most importantly, and this
is where it's really cool,

930
00:42:49,500 --> 00:42:52,169
it should have the same events.

931
00:42:52,169 --> 00:42:54,038
If I have 1000
machines all doing

932
00:42:54,038 --> 00:42:57,274
exactly the same thing,
they're gonna have,

933
00:42:57,274 --> 00:42:58,808
they may not be
in the same order.

934
00:42:58,809 --> 00:43:00,277
But it's gonna be the same
process creation events.

935
00:43:00,277 --> 00:43:02,980
The same task scheduler
events, the same everything.

936
00:43:02,980 --> 00:43:06,617
Which then gives very
interesting things
you can do with it.

937
00:43:06,617 --> 00:43:08,485
Now I'm looking
here at the process

938
00:43:08,485 --> 00:43:10,588
creation event with
the command line.

939
00:43:10,588 --> 00:43:15,593
So I had to pick one
that wasn't too long.

940
00:43:16,961 --> 00:43:18,562
'Cause they can get
long, but so you can look

941
00:43:18,562 --> 00:43:20,531
at we collect all
process creation

942
00:43:20,531 --> 00:43:21,832
events on machines in Microsoft.

943
00:43:21,832 --> 00:43:23,933
And I can look at the process.

944
00:43:23,934 --> 00:43:25,402
And out of this I can
see a number of things.

945
00:43:25,402 --> 00:43:27,438
I can see the
subject user account.

946
00:43:27,438 --> 00:43:28,706
Is this launched
as service, is this

947
00:43:28,706 --> 00:43:31,308
launched as a particular
service account.

948
00:43:31,308 --> 00:43:33,077
What's the name and
the path of this

949
00:43:33,077 --> 00:43:36,013
executable that's
running this service?

950
00:43:36,013 --> 00:43:40,049
What service or what
process is launching this?

951
00:43:40,050 --> 00:43:41,318
Is it launching
from the startup?

952
00:43:41,318 --> 00:43:43,921
What are the parent
child relationship,

953
00:43:43,921 --> 00:43:45,623
and then what is
the command line?

954
00:43:45,623 --> 00:43:49,293
And I can do this on
thousands of machines.

955
00:43:49,293 --> 00:43:52,496
That will tell me what
processes should run,

956
00:43:52,496 --> 00:43:54,465
how they should run,
who's running them,

957
00:43:54,465 --> 00:43:57,234
and sometimes when, like this

958
00:43:57,234 --> 00:43:59,036
always runs
immediately after that.

959
00:44:02,272 --> 00:44:04,274
Oh boy, we're not gonna
be able to finish.

960
00:44:04,274 --> 00:44:06,777
No I'm okay, we'll
get there, let's see.

961
00:44:08,145 --> 00:44:10,848
It's suspenseful, actually
I'm in the airplane

962
00:44:10,848 --> 00:44:15,285
coming back from vacation,
getting into Vancouver Canada.

963
00:44:15,285 --> 00:44:16,654
I'm watching the Hateful Eight,

964
00:44:16,654 --> 00:44:19,390
it's just right at that,
the last 10 minutes.

965
00:44:19,390 --> 00:44:21,491
And they come on and they start

966
00:44:21,492 --> 00:44:23,961
like (mimicking
airplane speaker noise)

967
00:44:23,961 --> 00:44:26,196
and they're interrupting
it, and I hate that.

968
00:44:26,196 --> 00:44:27,931
So I'm gonna finish
'cause it's like

969
00:44:27,931 --> 00:44:30,067
I thought I wasn't
gonna finish my movie.

970
00:44:30,067 --> 00:44:31,535
That itself wasn't very nice.

971
00:44:31,535 --> 00:44:34,672
Anyway, so this, I've
come up with this idea.

972
00:44:34,672 --> 00:44:36,674
And I'm running it
through everyone

973
00:44:36,674 --> 00:44:39,043
at Microsoft until they
won't answer my calls anymore

974
00:44:39,043 --> 00:44:43,147
which is the runtime
role-specific event baselines.

975
00:44:43,147 --> 00:44:45,482
Obviously I don't come up
with the best names of things.

976
00:44:45,482 --> 00:44:47,418
But it is descriptive,
the idea is

977
00:44:47,418 --> 00:44:49,887
we take any role, we
take all the instances

978
00:44:49,887 --> 00:44:52,022
of the role, we munch
all that data together.

979
00:44:52,022 --> 00:44:53,457
We see what are the
things that happen

980
00:44:53,457 --> 00:44:55,659
exactly the same on
every machine in there?

981
00:44:55,659 --> 00:44:57,161
And when we do that, we'll know

982
00:44:57,161 --> 00:44:59,296
what's normal, what
should be running.

983
00:44:59,296 --> 00:45:01,298
The converse of that
is really interesting.

984
00:45:01,298 --> 00:45:03,033
Because you start
getting the one-offs.

985
00:45:03,033 --> 00:45:06,470
Why did this machine run
Powershell all off a sudden?

986
00:45:09,073 --> 00:45:11,542
That bears looking
at, and I think

987
00:45:11,542 --> 00:45:13,009
you're gonna find your
compromise indicators

988
00:45:13,010 --> 00:45:15,079
and stuff are gonna be
in those unique things.

989
00:45:15,079 --> 00:45:18,248
So you can use this, the
runtime role-specific

990
00:45:18,248 --> 00:45:20,050
event baselines to do
some white listing.

991
00:45:20,050 --> 00:45:22,619
You could use this
in your forensics.

992
00:45:22,619 --> 00:45:25,322
So the next slide will go
where I'm sure I'm going next.

993
00:45:25,322 --> 00:45:26,857
But you could do white listing,

994
00:45:26,857 --> 00:45:28,892
but you could also use the
converse is true, hunting.

995
00:45:28,892 --> 00:45:31,462
Give me this baseline,
give me any deviations.

996
00:45:31,462 --> 00:45:32,730
What machines are deviating from

997
00:45:32,730 --> 00:45:34,498
it let me take a look at that.

998
00:45:34,498 --> 00:45:38,302
Which brings me to
where I'm at now,

999
00:45:38,302 --> 00:45:42,906
which is trying to automate
DFRI type activities.

1000
00:45:42,906 --> 00:45:45,576
Especially coming up with the
initial compromise assessment.

1001
00:45:45,576 --> 00:45:50,047
And that I take using scale
to define what's normal.

1002
00:45:50,047 --> 00:45:51,915
And using the idea
that deviations

1003
00:45:51,915 --> 00:45:55,384
from normal can indicate
a security incident.

1004
00:45:55,385 --> 00:45:57,421
So the idea I'm working
with is by taking

1005
00:45:57,421 --> 00:46:00,591
role event baselines
and all the data we get.

1006
00:46:00,591 --> 00:46:02,826
The hashes and all that stuff.

1007
00:46:02,826 --> 00:46:04,094
We put them in and then I throw

1008
00:46:04,094 --> 00:46:05,262
any particular VM against it.

1009
00:46:05,262 --> 00:46:06,363
I basically compare
the individual

1010
00:46:06,363 --> 00:46:08,031
to the herd as they say there.

1011
00:46:08,031 --> 00:46:11,268
To find out what is not
supposed to be there.

1012
00:46:11,268 --> 00:46:12,703
It's kinda like that
Sesame Street game.

1013
00:46:12,703 --> 00:46:13,971
What do they sing,
this doesn't belong.

1014
00:46:13,971 --> 00:46:15,773
Well I can do this in
an automated fashion.

1015
00:46:15,773 --> 00:46:18,108
And then I'm left to as
a forensic investigator,

1016
00:46:18,108 --> 00:46:21,078
determining is this
deviation a security event.

1017
00:46:21,078 --> 00:46:23,313
Does this indicate a compromise?

1018
00:46:23,313 --> 00:46:26,517
So this gets the first
pass and everything.

1019
00:46:26,517 --> 00:46:30,020
Anyway with that, I'll
be open for questions.

1020
00:46:30,020 --> 00:46:31,989
I will be around
for the two days.

1021
00:46:31,989 --> 00:46:33,590
I love to discuss
forensics, I've been

1022
00:46:33,590 --> 00:46:36,293
doing this for 20 years
because I love it.

1023
00:46:36,293 --> 00:46:39,229
And I love talking
about it, and I'll

1024
00:46:39,229 --> 00:46:41,330
be happy to answer
questions or talk

1025
00:46:41,331 --> 00:46:44,368
to people about ideas
they have and such.

1026
00:46:44,368 --> 00:46:46,436
And it looks like
I'm out of time.

1027
00:46:46,436 --> 00:46:47,905
- [Man] You
mentioned the ability

1028
00:46:47,905 --> 00:46:51,642
to pull images and
other data directly

1029
00:46:51,642 --> 00:46:54,243
from the images, is
that a standard part

1030
00:46:54,244 --> 00:46:57,648
of the Azure contract when
you're getting Azure services?

1031
00:46:57,648 --> 00:47:00,250
Or is that something you have
to negotiate as an add-on?

1032
00:47:00,250 --> 00:47:01,885
- That is not a part
of the contract.

1033
00:47:01,885 --> 00:47:04,488
It's not something that's
currently possible for tenants.

1034
00:47:04,488 --> 00:47:06,656
The question was,
the way I gather data

1035
00:47:06,657 --> 00:47:10,561
on the management
side of the Hyper-V.

1036
00:47:10,561 --> 00:47:12,095
That's an incident
response thing

1037
00:47:12,095 --> 00:47:14,531
done internally, it's
something I think

1038
00:47:14,531 --> 00:47:16,900
would be very
useful to customers.

1039
00:47:16,900 --> 00:47:18,101
It would be nice
to set up, it has

1040
00:47:18,101 --> 00:47:20,304
to be set up and very secure.

1041
00:47:20,304 --> 00:47:21,471
Because if we built this so that

1042
00:47:21,471 --> 00:47:22,706
you could have this push button,

1043
00:47:22,706 --> 00:47:25,209
give me my VHDs and
my memory samples,

1044
00:47:25,209 --> 00:47:26,810
we'd wanna make sure that that

1045
00:47:26,810 --> 00:47:28,478
worked for you and
only you and under

1046
00:47:28,478 --> 00:47:30,581
the right circumstances
and was adequately locked.

1047
00:47:30,581 --> 00:47:34,651
But it's a great idea to
do, I'd like to see it done.

1048
00:47:34,651 --> 00:47:37,254
But the way I do
it now is it's done

1049
00:47:37,254 --> 00:47:40,490
only by incident
responders, in fact

1050
00:47:40,490 --> 00:47:42,158
only by a few
incident responders.

1051
00:47:42,159 --> 00:47:44,328
It's done, it's heavily logged.

1052
00:47:44,328 --> 00:47:46,330
It's got legal and
everything on it.

1053
00:47:46,330 --> 00:47:49,466
And that's just with our stuff.

1054
00:47:49,466 --> 00:47:52,102
If it comes to customer stuff,

1055
00:47:52,102 --> 00:47:54,605
even there it would only be done

1056
00:47:54,605 --> 00:47:56,473
with customer consent and legal.

1057
00:47:56,473 --> 00:47:59,109
And that'd be very
special, 'cause it's,

1058
00:47:59,109 --> 00:48:02,011
we just with thousands
of customers,

1059
00:48:02,012 --> 00:48:05,182
a handful of us aren't
gonna be able to do that.

1060
00:48:05,182 --> 00:48:07,950
But I hope that
answered your question.

1061
00:48:07,951 --> 00:48:11,488
- [Man] So you talked
about the snapshots,

1062
00:48:11,488 --> 00:48:14,558
clean snapshots and then
the differencing disks

1063
00:48:14,558 --> 00:48:16,693
and being able to
compare and contrast.

1064
00:48:16,693 --> 00:48:18,829
Do you have a tool
suite or techniques

1065
00:48:18,829 --> 00:48:22,666
for showing, isolating
those differences?

1066
00:48:22,666 --> 00:48:26,069
Or getting them in a format
that can be analyzed?

1067
00:48:26,069 --> 00:48:29,273
- Yes, the question
was, I talked

1068
00:48:29,273 --> 00:48:30,774
about doing snapshots or looking

1069
00:48:30,774 --> 00:48:32,743
at differencing
disks and being able

1070
00:48:32,743 --> 00:48:34,378
to compare parent to
child or different

1071
00:48:34,378 --> 00:48:38,415
time iterations to each
other to detect differences

1072
00:48:38,415 --> 00:48:41,118
and whether I had special
tools for doing that.

1073
00:48:41,118 --> 00:48:44,288
Sort of yes and no, it's
not gonna be exciting.

1074
00:48:44,288 --> 00:48:46,957
My first base
tool, I use X-Ways.

1075
00:48:46,957 --> 00:48:48,458
It's not intended
to be a commercial

1076
00:48:48,458 --> 00:48:52,029
but the purest and
simplest thing I could do

1077
00:48:52,029 --> 00:48:53,864
is just drop the
parent VHD in X-Ways

1078
00:48:53,864 --> 00:48:56,900
and I create a
half-set of everything.

1079
00:48:56,900 --> 00:49:00,871
And then I drop the, I
bring in the child disk

1080
00:49:00,871 --> 00:49:03,273
to the differencing disk and it,

1081
00:49:03,273 --> 00:49:05,509
X-Ways will
automatically merge them

1082
00:49:05,509 --> 00:49:07,077
but you can merge them
through other tools too.

1083
00:49:07,077 --> 00:49:08,745
And then I basically
will take this,

1084
00:49:08,745 --> 00:49:10,781
when they're merged they're the,

1085
00:49:10,781 --> 00:49:14,484
they form the image of the
disk that the VM actually saw.

1086
00:49:14,484 --> 00:49:16,353
And then I've got the
hashes and everything

1087
00:49:16,353 --> 00:49:17,854
so I can instantly
do an exclusion.

1088
00:49:17,854 --> 00:49:19,823
I know what's new
and stuff like that.

1089
00:49:19,823 --> 00:49:22,558
You also have your time
stamps so you can separate.

1090
00:49:22,559 --> 00:49:26,029
So it's not fancy but a
standard forensics tools.

1091
00:49:26,029 --> 00:49:27,631
Other techniques you can use,

1092
00:49:31,501 --> 00:49:33,303
there's the built in
stuff with hypervisor.

1093
00:49:33,303 --> 00:49:35,404
But it's the hypervisor
Powershell tool.

1094
00:49:35,405 --> 00:49:40,110
So you can do an
analysis on the parent,

1095
00:49:40,110 --> 00:49:41,778
you can merge them
and do analysis.

1096
00:49:41,778 --> 00:49:43,779
But hypervisor, the
hypervisor tools

1097
00:49:43,780 --> 00:49:46,316
come built into Windows when
you set up the hypervisor.

1098
00:49:46,316 --> 00:49:48,518
Or Hyper-V are also
tools I can use

1099
00:49:48,518 --> 00:49:50,787
for that, for mounting disks.

1100
00:49:50,787 --> 00:49:52,388
And if you wanna discuss virtual

1101
00:49:52,389 --> 00:49:54,224
forensics techniques, I've done

1102
00:49:54,224 --> 00:49:56,259
a lot of work with
that and would be happy

1103
00:49:56,259 --> 00:49:57,728
to go over some of
the things I've done.

1104
00:49:57,728 --> 00:49:59,596
'Cause there's really so
many cool things you can do.

1105
00:49:59,596 --> 00:50:02,432
It's just, this is
the kind of thing

1106
00:50:02,432 --> 00:50:06,102
I get excited for which shows
you why I have bad jokes.

1107
00:50:06,103 --> 00:50:09,373
'Cause I'm not a
very exciting person.

1108
00:50:09,373 --> 00:50:12,809
(crowd laughs)
Any other questions?

1109
00:50:12,809 --> 00:50:14,611
- [Man] Final
question, all right.

1110
00:50:19,216 --> 00:50:21,718
Big round of applause
for Troy Larson!

1111
00:50:21,718 --> 00:50:25,989
(audience applauding
and cheering)

