1
00:00:00,834 --> 00:00:03,603
(dramatic music)

2
00:00:13,113 --> 00:00:15,382
(applause)

3
00:00:17,684 --> 00:00:18,518
- Thanks.

4
00:00:19,686 --> 00:00:20,553
Thank you Rob.

5
00:00:21,921 --> 00:00:24,524
I'm going to start us off.

6
00:00:24,524 --> 00:00:26,893
Explaining a little
bit about DNS.

7
00:00:26,893 --> 00:00:28,395
How it relates to the internet.

8
00:00:28,395 --> 00:00:32,564
How it relates to security and
what passive DNS looks like.

9
00:00:33,633 --> 00:00:35,201
And then we have in my opinion,

10
00:00:35,201 --> 00:00:38,671
a much more important story
from Gene about applications

11
00:00:38,671 --> 00:00:41,274
and results rather
than capabilities.

12
00:00:41,274 --> 00:00:43,610
So let me do the
boring part first.

13
00:00:45,145 --> 00:00:50,116
So the thing about DNS
that surprises folks is

14
00:00:52,886 --> 00:00:56,322
it's getting bigger but
it's looking smaller.

15
00:00:56,322 --> 00:00:58,425
We used to have to
type in domain names.

16
00:00:58,425 --> 00:01:03,163
Off of business cards or off
of billboards that we had seen

17
00:01:03,163 --> 00:01:05,798
and that's not happening
as much anymore.

18
00:01:05,799 --> 00:01:08,601
Most growth of internet
endpoints is mobile

19
00:01:08,601 --> 00:01:11,604
and typing domain names on
a mobile device is hard.

20
00:01:11,604 --> 00:01:14,874
And so the industry
has trended toward

21
00:01:14,874 --> 00:01:17,911
clicking on something,
searching for something,

22
00:01:17,911 --> 00:01:20,046
clicking on a link somewhere

23
00:01:20,046 --> 00:01:22,348
so that you're accessing
content more and more

24
00:01:22,348 --> 00:01:26,286
by replying to email or
clicking on some thing somewhere

25
00:01:27,187 --> 00:01:28,655
and not seeing the domain name.

26
00:01:28,655 --> 00:01:31,558
Not having to experience
the domain name.

27
00:01:31,558 --> 00:01:33,626
That's different from
even ten years ago

28
00:01:35,128 --> 00:01:38,164
and that makes
people perhaps think

29
00:01:38,164 --> 00:01:41,868
that DNS is less
important or less used.

30
00:01:41,868 --> 00:01:42,836
That is not the case.

31
00:01:42,836 --> 00:01:46,405
DNS is growing amazingly well.

32
00:01:46,406 --> 00:01:48,108
It is more important than ever

33
00:01:48,108 --> 00:01:50,677
and every one of those
links that you click on,

34
00:01:50,677 --> 00:01:52,178
everything that
you can search for,

35
00:01:52,178 --> 00:01:55,215
everything that you
can reply to is because

36
00:01:55,215 --> 00:01:56,983
the internet is linked together

37
00:01:56,983 --> 00:01:59,786
with pointers to
other domain names.

38
00:01:59,786 --> 00:02:03,823
So that's a difference
between the lived experience

39
00:02:03,823 --> 00:02:07,259
and the actual sort of
true red pill experience.

40
00:02:08,862 --> 00:02:10,597
I'll give you some metrics.

41
00:02:10,597 --> 00:02:14,033
First I should explain
what a delegation point is.

42
00:02:14,033 --> 00:02:15,902
People often call them domains

43
00:02:15,902 --> 00:02:19,105
but anything you can look
up in the DNS is a domain.

44
00:02:19,105 --> 00:02:21,340
So let me be very specific.

45
00:02:21,341 --> 00:02:24,911
A delegation point is something
you can buy from GoDaddy.

46
00:02:24,911 --> 00:02:28,014
Example.com is a
delegation point

47
00:02:28,014 --> 00:02:29,983
because the person
who owns that name

48
00:02:29,983 --> 00:02:31,151
is different from the person

49
00:02:31,151 --> 00:02:34,087
who owns the name
above it which is .com.

50
00:02:34,087 --> 00:02:37,190
Www.example.com is not
a delegation point.

51
00:02:37,190 --> 00:02:40,226
That is a fully
qualified domain name

52
00:02:40,226 --> 00:02:43,263
and I want you to bear
that distinction in mind

53
00:02:43,263 --> 00:02:44,731
as I explain that
there are about

54
00:02:44,731 --> 00:02:49,636
150,000 delegation
points created every day.

55
00:02:49,636 --> 00:02:53,339
And because there are
86,000 seconds in that day,

56
00:02:53,339 --> 00:02:56,276
that means we call it an
average of two per second.

57
00:02:57,644 --> 00:03:00,980
That's the aggregate creation
rate of domain names.

58
00:03:00,980 --> 00:03:02,482
Of delegation points.

59
00:03:02,482 --> 00:03:03,883
Most of them don't
live very long

60
00:03:03,883 --> 00:03:06,219
because most of them are
created for malicious

61
00:03:06,219 --> 00:03:08,721
or annoying purposes
and they get taken down,

62
00:03:08,721 --> 00:03:10,990
or abandoned, or black
holed, or whatever.

63
00:03:12,825 --> 00:03:17,829
About 600, no excuse me about
60 fully qualified names

64
00:03:19,732 --> 00:03:22,135
are created every second.

65
00:03:22,135 --> 00:03:25,971
And about 600 changes
occur every second.

66
00:03:25,972 --> 00:03:28,708
Where it used to be
that the A record

67
00:03:28,708 --> 00:03:31,477
for www.example.com
pointed at one thing

68
00:03:31,477 --> 00:03:33,913
and now it points
at something else.

69
00:03:33,913 --> 00:03:35,648
So keep those metrics in mind.

70
00:03:35,648 --> 00:03:38,384
That happens all day everyday.

71
00:03:38,384 --> 00:03:41,220
We are seeing
constant growth in DNS

72
00:03:41,221 --> 00:03:43,823
and constant churn in
the content of DNS.

73
00:03:45,258 --> 00:03:47,227
So what I've shown on this slide

74
00:03:47,227 --> 00:03:51,497
is a simple three
layer hierarchy showing
your smart phones

75
00:03:51,497 --> 00:03:53,433
at the bottom of
a stub resolver.

76
00:03:53,433 --> 00:03:55,301
Communicating with a
recursive name server

77
00:03:55,301 --> 00:03:59,805
which if you're on the wifi
here was provided to you by SANS

78
00:03:59,806 --> 00:04:02,942
but if you're at home it's
probably provided by you

79
00:04:02,942 --> 00:04:04,410
or your ISP.

80
00:04:04,410 --> 00:04:06,913
If you're at work probably
came from your IT department.

81
00:04:06,913 --> 00:04:08,314
That recursive name server

82
00:04:08,314 --> 00:04:11,150
is the heart of
complexity in DNS.

83
00:04:11,150 --> 00:04:14,254
It is where everybody
goes to look stuff up

84
00:04:14,254 --> 00:04:17,656
and if it knows the answer
it will answer from cache.

85
00:04:17,656 --> 00:04:19,591
That's how DNS has
been able to grow

86
00:04:19,591 --> 00:04:23,296
from humble academic
origins up until today

87
00:04:23,296 --> 00:04:25,765
where we have billions of
people depending on it.

88
00:04:25,765 --> 00:04:28,401
If it doesn't know the
answer the recursive server

89
00:04:28,401 --> 00:04:31,537
will have to go ask a
content or authority server.

90
00:04:31,537 --> 00:04:32,772
And that's it.

91
00:04:32,772 --> 00:04:34,240
I've just told you
have DNS works.

92
00:04:34,240 --> 00:04:35,208
Anybody who says it's
more complicated than that

93
00:04:35,208 --> 00:04:36,743
is missing the point.

94
00:04:38,611 --> 00:04:40,947
What you're seeing
over on the right is

95
00:04:40,947 --> 00:04:43,449
the Farsight Security
Information Exchange

96
00:04:44,584 --> 00:04:47,453
but really any
passive DNS writer

97
00:04:47,453 --> 00:04:49,688
has to get their
data from somewhere.

98
00:04:49,689 --> 00:04:52,792
We choose to get it above
the recursive server

99
00:04:52,792 --> 00:04:56,162
because it's our belief
that internet users

100
00:04:56,162 --> 00:04:58,931
have a reasonable
expectation of privacy

101
00:04:58,931 --> 00:05:00,767
and there's a whole lot of PII.

102
00:05:00,767 --> 00:05:03,603
Personally identifiably
information below the recursive

103
00:05:03,603 --> 00:05:06,272
because you know the IP
address of the person

104
00:05:06,272 --> 00:05:07,507
who asked the question.

105
00:05:07,507 --> 00:05:08,941
And you know what
question they asked

106
00:05:08,941 --> 00:05:12,178
and so you know what
kind of criminal they are

107
00:05:12,178 --> 00:05:13,546
if they are one

108
00:05:13,546 --> 00:05:15,615
and you also know the popularity
of names and so forth.

109
00:05:15,615 --> 00:05:18,818
So that's surveillance and
I don't do surveillance.

110
00:05:18,818 --> 00:05:20,853
So we collect above
where all you see is

111
00:05:20,853 --> 00:05:25,224
the cache missed traffic
that has server IP addresses.

112
00:05:25,224 --> 00:05:27,694
In my opinion
there's no PII there

113
00:05:27,694 --> 00:05:30,863
and various University
and ISP lawyers

114
00:05:30,863 --> 00:05:32,532
who operate sensors for us

115
00:05:32,532 --> 00:05:34,901
have agreed with
that perspective.

116
00:05:37,370 --> 00:05:41,708
We take the data and roll
it down this waterfall.

117
00:05:41,708 --> 00:05:46,713
So we take 200,000
cache misses per second.

118
00:05:47,847 --> 00:05:50,183
Run them through various
real time channels.

119
00:05:50,183 --> 00:05:52,418
You see a deduplicator here.

120
00:05:52,418 --> 00:05:55,154
That has an 800
gigabyte hash table

121
00:05:55,154 --> 00:05:57,790
and 24 of the fastest
cores that we,

122
00:05:57,790 --> 00:05:58,958
most expensive at least,

123
00:05:58,958 --> 00:06:00,760
cores that you can buy

124
00:06:00,760 --> 00:06:03,462
in order to turn that
200,000 events per second

125
00:06:03,463 --> 00:06:07,166
into closer to, I don't
know, 15,000 per second.

126
00:06:07,166 --> 00:06:09,035
Which are then
subsequently filtered down

127
00:06:09,035 --> 00:06:11,838
because there's a huge amount
of junk that goes through DNS

128
00:06:11,838 --> 00:06:14,273
that you wouldn't
want in a database.

129
00:06:14,273 --> 00:06:16,409
It has no security importance.

130
00:06:16,409 --> 00:06:18,044
If it does have
security importance.

131
00:06:18,044 --> 00:06:21,080
We put it into a real
time channel called 206.

132
00:06:21,080 --> 00:06:23,983
That's the bit bucket
hanging under the combine

133
00:06:23,983 --> 00:06:25,952
that gets all the chaff

134
00:06:25,952 --> 00:06:29,021
and a few security companies
get nothing but 206.

135
00:06:30,156 --> 00:06:31,457
We have nothing
else they care about

136
00:06:31,457 --> 00:06:32,658
but they love to see the junk.

137
00:06:32,658 --> 00:06:34,160
That's fine.

138
00:06:34,160 --> 00:06:36,763
Ultimately the output of
this goes into a database

139
00:06:36,763 --> 00:06:39,065
that you can do look ups on.

140
00:06:39,065 --> 00:06:40,900
Here's an example of
me doing a look up

141
00:06:40,900 --> 00:06:42,534
on my old vanity domain.

142
00:06:42,535 --> 00:06:46,205
I sold it and you can
tell exactly when I
listed it for sale

143
00:06:46,205 --> 00:06:47,873
because historically speaking,

144
00:06:47,874 --> 00:06:49,942
I used to have one
set of NS records.

145
00:06:49,942 --> 00:06:52,111
Now I have a different set.

146
00:06:52,111 --> 00:06:54,546
And now today it would
be an even different set

147
00:06:54,547 --> 00:06:57,116
because it's being
used to sell vixs.

148
00:06:57,116 --> 00:06:58,651
Whatever that is.

149
00:07:00,386 --> 00:07:02,688
Here's an example of iteration.

150
00:07:04,123 --> 00:07:07,026
Traditional DNS you can't
ask a wildcard question.

151
00:07:07,026 --> 00:07:09,228
There are wildcards but
only at the answer level.

152
00:07:09,228 --> 00:07:11,264
In passive DNS you can say

153
00:07:11,264 --> 00:07:13,466
what are all the names
that match this pattern

154
00:07:13,466 --> 00:07:14,934
and that's kind of cool.

155
00:07:14,934 --> 00:07:17,103
If vix.com was a criminal
then you could imagine

156
00:07:17,103 --> 00:07:20,673
how you might get a list
of all their related assets

157
00:07:20,673 --> 00:07:22,542
and figure out how
they're using them,

158
00:07:22,542 --> 00:07:24,010
or how they might use them,

159
00:07:24,010 --> 00:07:26,179
and how you might defend
yourself them against them.

160
00:07:26,179 --> 00:07:28,780
I grepped it down to just
my Comcast business link

161
00:07:28,781 --> 00:07:31,184
because there's so much
other crap in my domain.

162
00:07:33,686 --> 00:07:37,190
Here's an indication of
right hand side look up.

163
00:07:37,190 --> 00:07:40,126
Traditional DNS you can
only do a left side look up,

164
00:07:40,126 --> 00:07:42,594
but here I said show
me all the things

165
00:07:42,595 --> 00:07:44,764
that are MX-ing
through this server

166
00:07:44,764 --> 00:07:46,032
and in this case it was

167
00:07:46,032 --> 00:07:47,834
because I had lost
my post fix config

168
00:07:47,834 --> 00:07:49,068
and I needed to know

169
00:07:49,068 --> 00:07:50,669
what domains I should
be answering email for.

170
00:07:50,670 --> 00:07:54,106
So this was not a security
use this was an auditing use.

171
00:07:56,542 --> 00:08:00,378
Here you see what the FBI's
public presence looks like.

172
00:08:00,379 --> 00:08:01,581
Very clean.

173
00:08:01,581 --> 00:08:03,649
I didn't show the
dates in this example

174
00:08:03,649 --> 00:08:06,085
because it has never changed.

175
00:08:06,085 --> 00:08:08,387
We've been recording
this since 2010

176
00:08:08,387 --> 00:08:10,323
and it's been quite stable.

177
00:08:10,323 --> 00:08:12,525
But I have some
friends in the FBI

178
00:08:12,525 --> 00:08:15,361
and I wanted to either
congratulate them or not.

179
00:08:15,361 --> 00:08:17,096
It turned out not

180
00:08:17,096 --> 00:08:18,498
because they didn't realize

181
00:08:18,498 --> 00:08:20,466
that putting a whole
bunch of other things

182
00:08:20,466 --> 00:08:24,070
into the same /24 address
block they were exposing

183
00:08:24,070 --> 00:08:26,606
what other projects they had.

184
00:08:26,606 --> 00:08:31,611
InfraGard is supposed to be
spelled with just an A and no U

185
00:08:33,078 --> 00:08:35,881
so there were hundreds of
actual InfraGard chapters

186
00:08:35,881 --> 00:08:37,582
and on the IngraGard with a U

187
00:08:37,582 --> 00:08:41,786
was bought for typo squatting
purposes or prevention.

188
00:08:41,787 --> 00:08:43,890
But anyway again if
you're a criminal

189
00:08:43,890 --> 00:08:47,059
and you place related assets
in the same address block.

190
00:08:47,059 --> 00:08:49,262
Passive DNS will tell you,

191
00:08:49,262 --> 00:08:51,997
will tell the
security researchers

192
00:08:51,998 --> 00:08:54,600
who are following you
exactly what you own.

193
00:08:54,600 --> 00:08:56,736
And that is pretty cool stuff.

194
00:08:56,736 --> 00:08:59,038
It's magic when you first
get your hands on it.

195
00:08:59,038 --> 00:09:02,408
I do wanna emphasize
I like that dig format

196
00:09:02,408 --> 00:09:06,445
that I've been showing you
because I used to be a DNS guy.

197
00:09:06,445 --> 00:09:08,548
But it's terrible to program for

198
00:09:08,548 --> 00:09:11,150
so the server is actually
returning JSON blobs

199
00:09:11,150 --> 00:09:15,054
which my tool in that example
has been converting to dig.

200
00:09:16,756 --> 00:09:21,394
So let me just say before we
move onto the real part of this

201
00:09:21,394 --> 00:09:23,763
which has to do with
results not capabilities.

202
00:09:25,064 --> 00:09:28,434
Passive DNS is
getting very popular.

203
00:09:28,434 --> 00:09:31,469
I am one provider but
I know of five other.

204
00:09:31,470 --> 00:09:35,508
The particular JSON scheme
of that we developed

205
00:09:35,508 --> 00:09:36,876
is now used by all of them

206
00:09:36,876 --> 00:09:39,278
so that if you are
a client of one

207
00:09:39,278 --> 00:09:41,681
and you wish to become a
client of the other it's

208
00:09:41,681 --> 00:09:45,084
because we wrote internet
RFC describing our schema

209
00:09:45,084 --> 00:09:46,518
and then everybody
who followed us,

210
00:09:46,519 --> 00:09:48,421
followed the same schema.

211
00:09:48,421 --> 00:09:52,625
So this is not intended to
be a product placement issue.

212
00:09:52,625 --> 00:09:54,560
I'm just using our
system as an example

213
00:09:54,560 --> 00:09:56,561
because I have an
API key for it.

214
00:09:56,562 --> 00:09:58,064
So turning it over to Gene.

215
00:10:04,303 --> 00:10:05,137
- We're good.

216
00:10:05,137 --> 00:10:06,305
Okay.

217
00:10:06,305 --> 00:10:07,106
Hi everybody thanks
for having me.

218
00:10:07,106 --> 00:10:08,240
I'm Gene Stevens.

219
00:10:08,240 --> 00:10:10,009
I'm the CTO co-founder
of ProtectWise

220
00:10:10,009 --> 00:10:12,278
and what I'm going
to do is show you

221
00:10:12,278 --> 00:10:15,214
how we were able to leverage
this passive DNS functionality

222
00:10:15,214 --> 00:10:17,984
to do a fast hunt and pivot.

223
00:10:17,984 --> 00:10:20,753
So we're gonna go from a DNS

224
00:10:20,753 --> 00:10:25,091
into a full forensic packet
analysis back in time.

225
00:10:26,025 --> 00:10:27,927
Just as a little set up.

226
00:10:27,927 --> 00:10:30,630
Just context of how this works

227
00:10:30,630 --> 00:10:32,999
and you can imagine
how this kind of intel

228
00:10:32,999 --> 00:10:34,533
can be fed into the system.

229
00:10:34,533 --> 00:10:36,369
What ProtectWise
basically does is that we

230
00:10:36,369 --> 00:10:38,504
have these software sensors
we give to our customers

231
00:10:38,504 --> 00:10:40,840
and they put them
anywhere in the network.

232
00:10:40,840 --> 00:10:42,008
You can see some examples here.

233
00:10:42,008 --> 00:10:42,975
Industrial control by the way.

234
00:10:42,975 --> 00:10:43,976
That's pretty cool these days.

235
00:10:43,976 --> 00:10:45,711
That's a lot of fun to work on.

236
00:10:45,711 --> 00:10:47,480
But what they do, is
they do packet capture,

237
00:10:47,480 --> 00:10:49,682
and at great scale and they
stream it to the cloud.

238
00:10:49,682 --> 00:10:50,916
We run it through

239
00:10:50,916 --> 00:10:52,585
a bunch of different
detection capabilities.

240
00:10:52,585 --> 00:10:54,487
We also store a copy
of all that data

241
00:10:54,487 --> 00:10:56,555
and if you're doing the
math real fast right here,

242
00:10:56,555 --> 00:10:58,757
you're realizing that's a
monstrous amount of data

243
00:10:58,758 --> 00:11:00,259
and it absolutely is.

244
00:11:00,259 --> 00:11:02,028
But what we do
with it actually is

245
00:11:02,028 --> 00:11:03,195
that we run it through

246
00:11:03,195 --> 00:11:04,897
a suite of treat
detection capabilities

247
00:11:04,897 --> 00:11:06,799
and so that's signatures
and characteristics,

248
00:11:06,799 --> 00:11:08,733
bunch of ML classifiers,
behavior analytics,

249
00:11:08,734 --> 00:11:09,969
that kind of stuff.

250
00:11:09,969 --> 00:11:11,203
It's a suite of
different things.

251
00:11:11,203 --> 00:11:12,905
So Farsight feeds
into that right.

252
00:11:12,905 --> 00:11:15,141
So that's something
that we consume.

253
00:11:15,141 --> 00:11:16,342
We pull those API's.

254
00:11:16,342 --> 00:11:17,977
We drink from that fire hose.

255
00:11:17,977 --> 00:11:19,812
And kind of feed
it in the system.

256
00:11:19,812 --> 00:11:22,715
It's coming in thousands
and thousands of times a day

257
00:11:22,715 --> 00:11:24,650
and it gets turned
on in real time

258
00:11:24,650 --> 00:11:26,584
which is cool so people
can actually get that

259
00:11:26,585 --> 00:11:28,587
real time analytics
across even really

260
00:11:28,587 --> 00:11:31,524
disparate infrastructure but
what's also really interesting

261
00:11:31,524 --> 00:11:33,159
and we're gonna dig
into this a little bit,

262
00:11:33,159 --> 00:11:36,729
is that as that intel
comes into the system.

263
00:11:36,729 --> 00:11:38,864
It serves as an indicator.

264
00:11:38,864 --> 00:11:40,132
A trigger.

265
00:11:40,132 --> 00:11:41,633
It tells us what to
look for in the past

266
00:11:41,634 --> 00:11:44,470
so what our software does
is it takes that intel

267
00:11:44,470 --> 00:11:46,272
and then it does
packet analysis.

268
00:11:46,272 --> 00:11:48,908
It kind of rewinds the
tape just like in a bank.

269
00:11:48,908 --> 00:11:50,643
You wouldn't just be
satisfied with logs

270
00:11:50,643 --> 00:11:51,911
who went in and out the doors.

271
00:11:51,911 --> 00:11:53,713
You want cameras
recording, right.

272
00:11:53,713 --> 00:11:55,247
On all the time so you
can go back to them

273
00:11:55,247 --> 00:11:57,282
to ask them new questions
and we're gonna do that.

274
00:11:57,283 --> 00:11:58,918
We're gonna use passive DNS.

275
00:11:58,918 --> 00:12:00,319
We're gonna go back in time.

276
00:12:00,319 --> 00:12:02,188
Look at past network history

277
00:12:02,188 --> 00:12:04,423
and we're gonna find
something interesting.

278
00:12:04,423 --> 00:12:06,058
This is gonna be
a simple example.

279
00:12:06,058 --> 00:12:07,492
It's gonna be easy to follow.

280
00:12:08,627 --> 00:12:11,763
But show you how easy
kind of hunting is

281
00:12:11,764 --> 00:12:13,632
when you leverage this
kind of intelligence.

282
00:12:13,632 --> 00:12:15,834
DNS is super powerful.

283
00:12:15,835 --> 00:12:17,837
So let's go back in time.

284
00:12:17,837 --> 00:12:20,506
So before I get into
the meat of this.

285
00:12:21,640 --> 00:12:23,542
I do want to give credit
to the guys on video

286
00:12:23,542 --> 00:12:26,011
who are in ProtectWise who
did the actual work on this.

287
00:12:26,011 --> 00:12:28,180
I'm just on stage
on their behalf.

288
00:12:28,180 --> 00:12:30,649
So thank you James
Condon and Thomas Hagel.

289
00:12:30,649 --> 00:12:32,351
If you guys are
watching this later,

290
00:12:32,351 --> 00:12:34,520
thank you very
much for your work.

291
00:12:34,520 --> 00:12:38,324
So back in December
2015 there is an alarm

292
00:12:38,324 --> 00:12:41,627
that fires about a
compromised host is beaconing.

293
00:12:41,627 --> 00:12:43,728
This is a Codoso group.

294
00:12:43,729 --> 00:12:46,465
It's a known
beaconing structure.

295
00:12:46,465 --> 00:12:47,433
We see this.

296
00:12:47,433 --> 00:12:48,567
It's kind of easy to identify.

297
00:12:48,567 --> 00:12:50,736
Not super sexy all by itself

298
00:12:50,736 --> 00:12:53,271
but what's interesting is we
see this communication right.

299
00:12:53,272 --> 00:12:57,510
So we tie in the
DNS intelligence

300
00:12:57,510 --> 00:12:58,911
so we look at this akamie.

301
00:12:58,911 --> 00:13:00,246
We see this IP address.

302
00:13:00,246 --> 00:13:01,881
So one IP address.

303
00:13:01,881 --> 00:13:03,115
Okay that's interesting.

304
00:13:03,115 --> 00:13:05,384
So we know what
this is related to

305
00:13:05,384 --> 00:13:06,685
and then we're going to execute

306
00:13:06,685 --> 00:13:08,988
some forensic analysis
on the packets.

307
00:13:08,988 --> 00:13:11,490
Okay so initial indicators
have been discovered.

308
00:13:12,625 --> 00:13:14,927
What we do is we reach
out to DNS query.

309
00:13:16,362 --> 00:13:19,098
DNSDB query and our software
is very highly automated.

310
00:13:19,098 --> 00:13:20,366
I'm showing you manually

311
00:13:20,366 --> 00:13:21,934
what it would look like
off of the command line.

312
00:13:21,934 --> 00:13:25,938
You say okay so what else
do we know about this host.

313
00:13:25,938 --> 00:13:28,240
Well there's a whole
suite of IP addresses.

314
00:13:28,240 --> 00:13:30,810
Initially there were three
and then there were five

315
00:13:30,810 --> 00:13:32,143
and so we were able to
actually revisit this

316
00:13:32,144 --> 00:13:33,646
a couple of different times

317
00:13:33,646 --> 00:13:35,180
but you look in here.

318
00:13:35,181 --> 00:13:38,250
We see these five
different IP addresses.

319
00:13:38,250 --> 00:13:40,019
You look at the second
one from the bottom.

320
00:13:40,019 --> 00:13:44,023
You're gonna see
first scene 2015 8/20

321
00:13:44,023 --> 00:13:48,127
so many months prior to this
actual detection firing.

322
00:13:48,127 --> 00:13:49,060
So that's interesting.

323
00:13:49,061 --> 00:13:50,663
So we take that data

324
00:13:50,663 --> 00:13:53,966
and we look back inside
that same customer

325
00:13:53,966 --> 00:13:56,735
and so this is kind of
a high level summary

326
00:13:56,735 --> 00:13:58,838
but we hunt inside that customer

327
00:13:58,838 --> 00:14:01,140
and say let's take
all those IP addresses

328
00:14:01,140 --> 00:14:03,576
and let's find every
single network flow

329
00:14:03,576 --> 00:14:06,745
that has communicated
over that space

330
00:14:06,745 --> 00:14:09,281
and we have a copy of this
data that goes back months

331
00:14:09,281 --> 00:14:11,750
and years and so we're
able to go into that.

332
00:14:11,750 --> 00:14:13,419
Buried in that
petabytes of data,

333
00:14:13,419 --> 00:14:16,454
right that huge haystack
are these flows.

334
00:14:16,455 --> 00:14:18,123
So we find them hidden

335
00:14:18,123 --> 00:14:20,693
and we find connections
to those hosts

336
00:14:20,693 --> 00:14:24,196
going back to July 15, 2015.

337
00:14:24,196 --> 00:14:25,631
Let's see if I can
go back one slide

338
00:14:25,631 --> 00:14:27,867
cause I'm going to
look at something.

339
00:14:27,867 --> 00:14:28,700
Look at the intel.

340
00:14:28,701 --> 00:14:32,338
It says 2015 8/20 right.

341
00:14:32,338 --> 00:14:33,939
So we're seeing communications

342
00:14:33,939 --> 00:14:35,507
going back to that
same IP address.

343
00:14:35,507 --> 00:14:37,008
Maybe it's a different
domain back then

344
00:14:37,009 --> 00:14:38,344
but we're gonna
analyze it anyway.

345
00:14:38,344 --> 00:14:39,778
We're gonna use this.

346
00:14:39,778 --> 00:14:41,480
This is the indicators telling
us where to look right.

347
00:14:41,480 --> 00:14:42,648
So we're gonna hit.

348
00:14:42,648 --> 00:14:44,116
We're gonna land.

349
00:14:44,116 --> 00:14:45,516
We're gonna kind of expand
through the data set.

350
00:14:45,517 --> 00:14:48,787
And so we see packet
level forensics.

351
00:14:48,787 --> 00:14:50,689
Basically we pull
down those packets.

352
00:14:50,689 --> 00:14:52,190
We look at them

353
00:14:52,191 --> 00:14:53,893
and we see they're successful
HTTP communication going on.

354
00:14:53,893 --> 00:14:55,561
So we see the back an the forth.

355
00:14:55,561 --> 00:14:56,829
The firewalls not blocking this.

356
00:14:56,829 --> 00:14:57,963
Nothings going on right.

357
00:14:57,963 --> 00:15:01,533
There's active activity

358
00:15:01,533 --> 00:15:05,571
and we see nearly half a
year prior fully established

359
00:15:05,571 --> 00:15:08,874
APT activity trafficking
through that data set.

360
00:15:08,874 --> 00:15:10,709
And so then we dig in

361
00:15:10,709 --> 00:15:11,944
and this is a kind of a

362
00:15:11,944 --> 00:15:13,846
wire shark type screen
shot you're seeing here.

363
00:15:13,846 --> 00:15:15,080
But you can see the packets.

364
00:15:15,080 --> 00:15:17,182
Probably little hard
to read some of this,

365
00:15:17,182 --> 00:15:18,984
but we go in there

366
00:15:18,984 --> 00:15:21,053
and then this is the point
at which we're saying

367
00:15:21,053 --> 00:15:23,088
there's some interesting
payloads in the middle of this.

368
00:15:23,088 --> 00:15:24,522
We pull those out.

369
00:15:24,523 --> 00:15:26,091
Look at them and
you can just kind of

370
00:15:26,091 --> 00:15:27,626
sight read some of
this stuff right.

371
00:15:27,626 --> 00:15:30,863
You look at it and say
clearly base64 encoded

372
00:15:30,863 --> 00:15:32,131
so let's take a look at that.

373
00:15:32,131 --> 00:15:34,165
Let's decode that and
look inside the files.

374
00:15:34,166 --> 00:15:38,537
That turns out it's
just really simple XOR.

375
00:15:38,537 --> 00:15:41,874
So you're looking at saying
there's some repeating patterns

376
00:15:41,874 --> 00:15:43,142
here at the top of the file.

377
00:15:43,142 --> 00:15:45,244
A bunch of those
are zero value bytes

378
00:15:45,244 --> 00:15:47,446
or something like
that so we XOR them

379
00:15:47,446 --> 00:15:49,615
and sure enough the
whole thing flips.

380
00:15:49,615 --> 00:15:50,849
Which is kind of fun.

381
00:15:50,849 --> 00:15:53,319
Then they made it
kind of easy for us.

382
00:15:53,319 --> 00:15:54,786
We're looking at this

383
00:15:54,787 --> 00:15:56,288
and this is different
than the actual detection

384
00:15:56,288 --> 00:15:58,023
that we had initially that
started this whole thing

385
00:15:58,023 --> 00:16:00,426
so that boost dam
or I guess we don't

386
00:16:00,426 --> 00:16:02,995
actually have a name
for that back door

387
00:16:02,995 --> 00:16:06,832
but anyway that
one sends a signal.

388
00:16:06,832 --> 00:16:08,467
We hit Farsight.

389
00:16:08,467 --> 00:16:11,170
Farsight says here's the
potential impact on this.

390
00:16:11,170 --> 00:16:12,670
We follow that Farsight.

391
00:16:12,671 --> 00:16:14,473
That passive DNS data.

392
00:16:14,473 --> 00:16:15,974
And it's producing results.

393
00:16:15,975 --> 00:16:17,176
We're finding stuff in there.

394
00:16:17,176 --> 00:16:18,677
We're seeing these PE's.

395
00:16:18,677 --> 00:16:21,413
We're able to actually get
this thing deopfuscated

396
00:16:21,413 --> 00:16:23,849
and there you can see
the DOS stub right.

397
00:16:23,849 --> 00:16:26,251
And so we've successfully
identified it.

398
00:16:26,251 --> 00:16:27,319
We can tell what it's doing.

399
00:16:27,319 --> 00:16:28,753
We can statically classify it.

400
00:16:28,754 --> 00:16:29,989
That kind of stuff right.

401
00:16:29,989 --> 00:16:33,292
And so the real moral
of the story here is

402
00:16:33,292 --> 00:16:37,062
that in terms of
investigative analysis

403
00:16:37,062 --> 00:16:39,131
we're able to take this

404
00:16:39,131 --> 00:16:41,834
and go deep into this
customers haystack

405
00:16:41,834 --> 00:16:45,938
and validate this across
that customers experience.

406
00:16:45,938 --> 00:16:48,807
And that goes back like six
months of packet storage.

407
00:16:48,807 --> 00:16:51,043
So that was pretty cool.

408
00:16:51,043 --> 00:16:55,214
Also one key element of that
was how fast this can be.

409
00:16:55,214 --> 00:16:57,316
Because all that stuff
you can automate right.

410
00:16:57,316 --> 00:16:59,084
We had to do a little
bit of manual discovery

411
00:16:59,084 --> 00:17:00,819
but our analysts sat
there and we were like

412
00:17:00,819 --> 00:17:02,854
I've just got a bunch
of little binary's.

413
00:17:02,855 --> 00:17:04,923
I'm gonna see if I can unpack
some of this stuff right.

414
00:17:04,923 --> 00:17:06,258
Made the work really easy.

415
00:17:06,258 --> 00:17:08,694
Very automated
and instantaneous.

416
00:17:08,694 --> 00:17:11,763
But whats interesting
as well is that

417
00:17:11,763 --> 00:17:14,665
what ProtectWise does also
as an automated service

418
00:17:14,665 --> 00:17:16,635
is we take those
same indicators.

419
00:17:16,635 --> 00:17:18,404
We write the heuristics.

420
00:17:18,404 --> 00:17:22,407
We write other items that
describe their general behavior

421
00:17:22,407 --> 00:17:25,043
and then we apply it across
the entire customer base.

422
00:17:25,044 --> 00:17:29,048
So now we have a
bunch of customers

423
00:17:29,048 --> 00:17:31,884
that have these
massive data sets.

424
00:17:31,884 --> 00:17:33,385
We're finding a hit

425
00:17:33,385 --> 00:17:36,088
and following it through
in one customer's haystack.

426
00:17:36,088 --> 00:17:38,857
We don't have the same hit in
other customer's haystacks.

427
00:17:38,857 --> 00:17:42,327
We were able to discover
this file that existed

428
00:17:42,327 --> 00:17:44,630
and then we're able to
automatically go through

429
00:17:44,630 --> 00:17:45,864
all the other customers.

430
00:17:45,864 --> 00:17:47,166
I'm kind of giving
you a summary here.

431
00:17:47,166 --> 00:17:49,268
Hunt net flow customers all.

432
00:17:49,268 --> 00:17:51,770
We're able to find
latent infrastructure

433
00:17:51,770 --> 00:17:53,739
in other people's networks

434
00:17:53,739 --> 00:17:57,042
that was not detectable
in a real time system.

435
00:17:57,042 --> 00:17:58,310
There's no signatures.

436
00:17:58,310 --> 00:18:00,512
There's nothing that can
describe it at the time,

437
00:18:00,512 --> 00:18:02,915
but we're able to actually
go back using passive DNS

438
00:18:02,915 --> 00:18:06,652
and it told us where else
we can find this file

439
00:18:06,652 --> 00:18:09,088
that would only via
passive DNS discoverable

440
00:18:09,088 --> 00:18:10,322
in this one network.

441
00:18:10,322 --> 00:18:12,291
Just happened to be that
was just a delivery.

442
00:18:12,291 --> 00:18:13,591
The weaponization.

443
00:18:13,592 --> 00:18:16,528
That backdoor was
targeted against them.

444
00:18:16,528 --> 00:18:17,696
It was successful.

445
00:18:19,131 --> 00:18:20,766
The delivery mechanism in
other people's networks

446
00:18:20,766 --> 00:18:21,967
may have looked very differently

447
00:18:21,967 --> 00:18:24,069
but we're able to
actually identify that.

448
00:18:24,069 --> 00:18:27,004
So we're able to look at
and identify those machines.

449
00:18:29,074 --> 00:18:31,076
Help our customers get
them fully mitigated

450
00:18:31,076 --> 00:18:34,179
and we're able to look
at the domain resolution

451
00:18:34,179 --> 00:18:36,482
for all those customers.

452
00:18:36,482 --> 00:18:38,016
How are they communicating.

453
00:18:38,016 --> 00:18:39,384
What was going on in there.

454
00:18:39,384 --> 00:18:40,986
Go back to Farsight again.

455
00:18:40,986 --> 00:18:45,157
Expand and just kind
of fold over that list.

456
00:18:45,157 --> 00:18:46,824
The next thing you know
you've got actually

457
00:18:46,825 --> 00:18:50,329
strong validation
at a very solid

458
00:18:50,329 --> 00:18:52,865
and performant packet
level analysis.

459
00:18:52,865 --> 00:18:55,000
So the conclusion to this

460
00:18:55,000 --> 00:18:58,036
and it looks like we are
ahead of time on this.

461
00:18:58,036 --> 00:19:00,839
Which is good is that
we're able to use

462
00:19:00,839 --> 00:19:03,841
Farsight DNSDB passive DNS.

463
00:19:03,842 --> 00:19:05,043
Powerful concept.

464
00:19:05,043 --> 00:19:07,346
And use automated
retrospective analysis

465
00:19:07,346 --> 00:19:10,916
strong packet level
validation to discover

466
00:19:10,916 --> 00:19:13,918
effectively the
previously unknown inside

467
00:19:13,919 --> 00:19:15,454
our customers networks.

468
00:19:15,454 --> 00:19:19,725
So the hunt is actually
really powerful

469
00:19:19,725 --> 00:19:21,726
and it's actually really simple.

470
00:19:21,727 --> 00:19:24,630
You could put this in a Python
script and it will execute.

471
00:19:28,000 --> 00:19:29,535
Okay we are at the end.

472
00:19:33,772 --> 00:19:35,040
- [Facilitator] Questions?

473
00:19:39,811 --> 00:19:41,079
- I have an observation

474
00:19:41,079 --> 00:19:43,048
while we wait for the
microphone to settle.

475
00:19:44,249 --> 00:19:48,487
Just as there are many
passive DNS databases

476
00:19:48,487 --> 00:19:51,890
that you could choose
from there are also

477
00:19:51,890 --> 00:19:56,895
other storage stored data
indicating prior results

478
00:19:58,330 --> 00:20:02,067
so if you're saving syslogs
these same tricks work there.

479
00:20:02,067 --> 00:20:04,403
It's of course very
powerful to do with net flow

480
00:20:04,403 --> 00:20:05,637
and pcap and so forth

481
00:20:05,637 --> 00:20:08,240
but whatever you're
storing that shows

482
00:20:08,240 --> 00:20:10,209
historical activity
on your network

483
00:20:10,209 --> 00:20:13,979
can be used to hopscotch
through history

484
00:20:13,979 --> 00:20:15,581
and find a relationships

485
00:20:15,581 --> 00:20:18,015
and map our your
adversaries infrastructure.

486
00:20:20,886 --> 00:20:22,620
- [Man 1] So you
were talking about

487
00:20:23,922 --> 00:20:27,926
going back through
retrospective packet search.

488
00:20:27,926 --> 00:20:31,230
What's the volume of data
you're collecting there

489
00:20:31,230 --> 00:20:32,798
and what's your attention time?

490
00:20:34,366 --> 00:20:36,568
- So the volume of
data is petabytes.

491
00:20:36,568 --> 00:20:38,670
For even modest customers.

492
00:20:38,670 --> 00:20:40,405
A year of storage of
that gigabits a second,

493
00:20:40,405 --> 00:20:42,975
you get into petabyte
range pretty fast right.

494
00:20:42,975 --> 00:20:46,678
So in terms of how we
actually execute that.

495
00:20:46,678 --> 00:20:48,213
Our specific approach is

496
00:20:48,213 --> 00:20:50,782
that we do very targeted
packet capture for subset

497
00:20:50,782 --> 00:20:53,085
to the network that
are super valuable

498
00:20:53,085 --> 00:20:54,653
from a security perspective.

499
00:20:54,653 --> 00:20:57,389
Like YouTube videos, Netfilx
videos, that kind of stuff.

500
00:20:57,389 --> 00:20:58,857
Not super valuable right.

501
00:20:58,857 --> 00:20:59,891
DNS data.

502
00:20:59,891 --> 00:21:00,826
Not just the intel.

503
00:21:00,826 --> 00:21:03,061
The bytes, super valuable right.

504
00:21:03,061 --> 00:21:05,429
So very much targeted
around that subset of

505
00:21:05,430 --> 00:21:08,433
the network traffic that
we really want to analyze

506
00:21:08,433 --> 00:21:10,302
but it's kind of
greedy in that sense

507
00:21:10,302 --> 00:21:12,603
because we want to
capture all the HTTP

508
00:21:12,604 --> 00:21:15,707
that we don't feel safe
in actively filtering out

509
00:21:15,707 --> 00:21:17,409
because we wanna go back to it

510
00:21:17,409 --> 00:21:19,111
and ask it brand
new questions right.

511
00:21:19,111 --> 00:21:20,812
So there's HTTP
traffic that we stored

512
00:21:20,812 --> 00:21:24,181
that as far as we knew at the
time wasn't super valuable

513
00:21:24,182 --> 00:21:28,120
but then six months later turns
out it was super important

514
00:21:28,120 --> 00:21:29,687
and the impact was significant.

515
00:21:31,223 --> 00:21:32,390
Does that answer that question

516
00:21:32,391 --> 00:21:33,158
or was there another
part to that?

517
00:21:33,158 --> 00:21:34,325
Okay.

518
00:21:34,326 --> 00:21:36,862
Oh and how fast did you ask?

519
00:21:36,862 --> 00:21:39,331
- [Man 1] Yeah
like total volume.

520
00:21:39,331 --> 00:21:41,233
- Total volume of traffic.

521
00:21:41,233 --> 00:21:42,768
- [Man 1] Yeah.

522
00:21:42,768 --> 00:21:46,371
- That feeds into our platform
or many gigabits per second.

523
00:21:46,371 --> 00:21:47,939
Depends on the size
of the organization.

524
00:21:47,939 --> 00:21:50,208
We're mostly large enterprise
so very, very large networks.

525
00:21:52,778 --> 00:21:54,479
- [Man 2] Hi there.

526
00:21:54,479 --> 00:21:57,549
I've a question concerning
discoverability.

527
00:21:57,549 --> 00:22:02,454
Do you see any issues with the
fact that these data stores

528
00:22:03,655 --> 00:22:04,889
might become part
of a legal action

529
00:22:04,890 --> 00:22:09,695
and become a source
for lawyers to request

530
00:22:11,229 --> 00:22:12,864
as part of legal action?

531
00:22:14,066 --> 00:22:15,967
- Yeah it's a valuable
haystack right.

532
00:22:17,402 --> 00:22:19,404
So that's all about
making sure our customers

533
00:22:19,404 --> 00:22:21,406
control our access to it.

534
00:22:21,406 --> 00:22:22,507
Independent access.

535
00:22:22,507 --> 00:22:23,709
Right size viability.

536
00:22:25,644 --> 00:22:27,579
You can store and analyze
only what you want.

537
00:22:27,579 --> 00:22:28,413
Could be everything.

538
00:22:28,413 --> 00:22:30,882
Could be just a subset.

539
00:22:30,882 --> 00:22:33,385
Few assets, few hosts,
different apps protocols.

540
00:22:33,385 --> 00:22:37,422
- So let me follow up
by saying the telcos

541
00:22:37,422 --> 00:22:40,225
learned a long time ago
with call detail records

542
00:22:40,225 --> 00:22:43,028
that the best way to not
have to answer a subpoena

543
00:22:43,028 --> 00:22:46,331
is to not store the data for
a terrifically long period.

544
00:22:48,033 --> 00:22:51,002
We rift off of that
by simply saying

545
00:22:52,237 --> 00:22:54,406
if we don't collect any
PII there will never be

546
00:22:54,406 --> 00:22:57,476
a subpoena toward us
because we would be useless.

547
00:22:57,476 --> 00:23:00,178
So being deliberately useless
for that type of thing

548
00:23:00,178 --> 00:23:01,546
is another answer.

549
00:23:04,483 --> 00:23:06,585
- [Facilitator] All right
that's all we have time for.

550
00:23:06,585 --> 00:23:08,887
Big round of applause
for Dr. Vixie.

551
00:23:08,887 --> 00:23:11,123
(applause)

552
00:23:12,257 --> 00:23:14,993
(dramatic music)

