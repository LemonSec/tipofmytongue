1
00:00:00,030 --> 00:00:05,759
where everyone is thanks for nothing

2
00:00:03,810 --> 00:00:07,649
always still in bed the realtor but if

3
00:00:05,759 --> 00:00:09,300
you know I'm going to go I was talking

4
00:00:07,649 --> 00:00:12,540
to Chris up here I'm with alleviating

5
00:00:09,300 --> 00:00:14,929
anxiety in a few days as well receive an

6
00:00:12,540 --> 00:00:17,460
email and it will link to the

7
00:00:14,929 --> 00:00:20,520
presentations the slide thanks from our

8
00:00:17,460 --> 00:00:22,380
speakers so if you've missed one we are

9
00:00:20,520 --> 00:00:26,150
don't mean some of the presentations

10
00:00:22,380 --> 00:00:26,150
yesterday we got it going today and

11
00:00:26,630 --> 00:00:30,689
these will be on the dir website awesome

12
00:00:30,000 --> 00:00:32,430
awesome

13
00:00:30,689 --> 00:00:34,290
so hopefully that if you missed one or

14
00:00:32,430 --> 00:00:36,690
how to choose that one and one does he

15
00:00:34,290 --> 00:00:39,360
talk to also this is the problem we're

16
00:00:36,690 --> 00:00:41,250
taking care of recording oh I mention

17
00:00:39,360 --> 00:00:44,100
you box because we have another set of

18
00:00:41,250 --> 00:00:46,110
you dogs today one is going to be for

19
00:00:44,100 --> 00:00:48,960
the entire event and one is for today's

20
00:00:46,110 --> 00:00:51,180
presentations but there is a reward a

21
00:00:48,960 --> 00:00:53,520
math of the words as we received some

22
00:00:51,180 --> 00:01:03,480
$1.00 for yesterday's presentations you

23
00:00:53,520 --> 00:01:06,180
will be hold on so the following

24
00:01:03,480 --> 00:01:09,000
individuals are what we receiving that

25
00:01:06,180 --> 00:01:10,619
awesome sand shirts because they turned

26
00:01:09,000 --> 00:01:22,979
in their dogs for yesterday's

27
00:01:10,619 --> 00:01:24,450
presentation yeah Kevin Smith you gotta

28
00:01:22,979 --> 00:01:36,570
go to the UH the registration office

29
00:01:24,450 --> 00:01:40,009
don't usually funding up here following

30
00:01:36,570 --> 00:01:40,008
any business with the registration yes

31
00:01:40,729 --> 00:01:46,320
Jonathan Milford awesome job and these

32
00:01:44,460 --> 00:01:48,059
people actually here this morning as

33
00:01:46,320 --> 00:01:49,880
opposed with the slackers that did turn

34
00:01:48,060 --> 00:01:57,479
their evolve worse

35
00:01:49,880 --> 00:01:59,490
Michael Campbell D matters okay Wow he's

36
00:01:57,479 --> 00:02:05,539
here as well you see awesome job

37
00:01:59,490 --> 00:02:05,539
Edward winter Oh and Darrin with them

38
00:02:11,750 --> 00:02:22,709
see you later

39
00:02:13,400 --> 00:02:26,190
nice job Alex bond Anthony Layton and by

40
00:02:22,709 --> 00:02:28,500
eight Benton there you go Ryan so you

41
00:02:26,190 --> 00:02:30,650
guys so the server takes you to

42
00:02:28,500 --> 00:02:33,180
registration desk pick up your shirt

43
00:02:30,650 --> 00:02:36,180
there are two Lunch and Learn sessions

44
00:02:33,180 --> 00:02:38,100
today um let's see my jealous cyber

45
00:02:36,180 --> 00:02:53,790
security solutions and click security

46
00:02:38,100 --> 00:02:56,880
have you signed up yet we have next year

47
00:02:53,790 --> 00:02:59,760
some of these July 7th to the 8th and it

48
00:02:56,880 --> 00:03:07,049
shrinks a movie afterwards next year so

49
00:02:59,760 --> 00:03:08,640
people beyond 1 up 160 all right I was

50
00:03:07,049 --> 00:03:12,390
like I have the honor of introducing

51
00:03:08,640 --> 00:03:15,660
today's keynote speaker from Mannion's

52
00:03:12,390 --> 00:03:18,059
I am from Mannion - and I have some

53
00:03:15,660 --> 00:03:19,859
interactions with mr. crisp liar I

54
00:03:18,060 --> 00:03:21,810
doctored this fire I got that right no

55
00:03:19,859 --> 00:03:24,450
mr. crisp liar actually hooked me up I

56
00:03:21,810 --> 00:03:26,670
was set to investigate an intrusion and

57
00:03:24,450 --> 00:03:28,350
was given a machine and I was taking my

58
00:03:26,670 --> 00:03:30,450
time and he's like where's the dollar I

59
00:03:28,350 --> 00:03:32,790
was taking my time where's it now I was

60
00:03:30,450 --> 00:03:34,679
looking I was looking it goes side up on

61
00:03:32,790 --> 00:03:37,019
the wire I don't hear from Chris I'm

62
00:03:34,680 --> 00:03:38,780
here for Chris for about 90 seconds I'm

63
00:03:37,019 --> 00:03:42,260
here for Chris I've gone an hour

64
00:03:38,780 --> 00:03:45,900
continue on young padawan

65
00:03:42,260 --> 00:03:47,790
this guy is a technical director at man

66
00:03:45,900 --> 00:03:48,980
da but he's a he's responsible for

67
00:03:47,790 --> 00:03:51,019
keeping the East

68
00:03:48,980 --> 00:03:52,730
knowledge packing it all into people

69
00:03:51,019 --> 00:03:54,610
that work with them and it is an honor

70
00:03:52,730 --> 00:03:57,230
to have him today to talk about

71
00:03:54,610 --> 00:03:59,390
everything that they've seen over the

72
00:03:57,230 --> 00:04:02,379
last year at man gain so thank you very

73
00:03:59,390 --> 00:04:08,629
much Chris for coming out appreciate the

74
00:04:02,379 --> 00:04:11,420
director so my role at median is I do

75
00:04:08,629 --> 00:04:18,560
lead investigative teams so it typically

76
00:04:11,420 --> 00:04:20,978
teams of anywhere from two to six you

77
00:04:18,560 --> 00:04:23,030
know be the primary interface complaint

78
00:04:20,978 --> 00:04:24,560
service kind of set the overall

79
00:04:23,030 --> 00:04:26,650
direction for what we're doing what

80
00:04:24,560 --> 00:04:28,850
we're looking for what were prioritizing

81
00:04:26,650 --> 00:04:32,479
helping the client come up with a really

82
00:04:28,850 --> 00:04:34,400
ancient strategy and actually doing the

83
00:04:32,479 --> 00:04:36,949
forensic analysis myself as well so kind

84
00:04:34,400 --> 00:04:39,409
of mixing all those in and lighting up

85
00:04:36,949 --> 00:04:42,020
all the panel is doing network analysis

86
00:04:39,410 --> 00:04:46,250
host base analysis now analysis and

87
00:04:42,020 --> 00:04:47,359
keeping everything going if she helping

88
00:04:46,250 --> 00:04:51,889
teaching training other people within

89
00:04:47,360 --> 00:04:53,240
within Indian and said recommend and do

90
00:04:51,889 --> 00:04:55,880
research on some the newer things are

91
00:04:53,240 --> 00:05:03,430
things so this particular presentation

92
00:04:55,880 --> 00:05:08,870
is from one of our for one of our our

93
00:05:03,430 --> 00:05:10,700
clients we have so we did an

94
00:05:08,870 --> 00:05:12,229
investigation there's over years ago we

95
00:05:10,700 --> 00:05:14,870
do ongoing monitoring for them and then

96
00:05:12,229 --> 00:05:16,580
as part of that we then find breaches

97
00:05:14,870 --> 00:05:19,370
and then in kind of a quick search

98
00:05:16,580 --> 00:05:22,099
investigations less what days puts a

99
00:05:19,370 --> 00:05:24,380
package back out so this this set of key

100
00:05:22,099 --> 00:05:26,150
studies important over a six month

101
00:05:24,380 --> 00:05:27,200
period the client is attacked four

102
00:05:26,150 --> 00:05:29,960
different times by three different

103
00:05:27,200 --> 00:05:32,140
efforts in each attack was kind of

104
00:05:29,960 --> 00:05:34,150
unique rating

105
00:05:32,140 --> 00:05:40,719
so I want to kind of talk about each one

106
00:05:34,150 --> 00:05:42,760
what we did say what maybe so in general

107
00:05:40,720 --> 00:05:44,110
detection is really hard it's an I can

108
00:05:42,760 --> 00:05:47,380
even prevent attacker who wants to get

109
00:05:44,110 --> 00:05:48,310
into your network it's a TV and there

110
00:05:47,380 --> 00:05:49,659
are a lot of companies that are trying

111
00:05:48,310 --> 00:05:52,720
to come up with new technologies to do

112
00:05:49,660 --> 00:05:55,150
it but there's no like silver bullet

113
00:05:52,720 --> 00:05:59,260
there's no there's that's right now

114
00:05:55,150 --> 00:06:02,919
that's over and so the point of this

115
00:05:59,260 --> 00:06:04,840
talk is in addition to focusing on

116
00:06:02,920 --> 00:06:06,610
detection we need to think about

117
00:06:04,840 --> 00:06:08,799
different areas of the attack lifecycle

118
00:06:06,610 --> 00:06:10,630
that you can then target your monitoring

119
00:06:08,800 --> 00:06:12,340
so then you can find evidence to the

120
00:06:10,630 --> 00:06:14,500
attacker so you may not find if they

121
00:06:12,340 --> 00:06:16,359
want to work work day too but you may

122
00:06:14,500 --> 00:06:19,150
find a they attend work your way back if

123
00:06:16,360 --> 00:06:20,890
people are working with that quickly you

124
00:06:19,150 --> 00:06:22,000
can you can push the attacked out before

125
00:06:20,890 --> 00:06:26,860
they get a little some cup holders

126
00:06:22,000 --> 00:06:28,690
network so then all right now the

127
00:06:26,860 --> 00:06:32,950
industry pretty much family in detection

128
00:06:28,690 --> 00:06:35,650
in our caseload it takes on average 229

129
00:06:32,950 --> 00:06:40,240
days for our clients in last year to

130
00:06:35,650 --> 00:06:41,590
identify a breach now that that numbers

131
00:06:40,240 --> 00:06:43,720
probably speed of in terms of the

132
00:06:41,590 --> 00:06:45,510
organizations that we work with aren't

133
00:06:43,720 --> 00:06:47,470
gonna tend to be ones that are us mature

134
00:06:45,510 --> 00:06:49,090
during ones that they don't know that

135
00:06:47,470 --> 00:06:52,330
they have issues that they found to

136
00:06:49,090 --> 00:06:54,130
control you know into several years and

137
00:06:52,330 --> 00:06:59,050
they're these are being notified by an

138
00:06:54,130 --> 00:07:00,820
external source like the FBI or the card

139
00:06:59,050 --> 00:07:03,960
brands if it's a comic like purchase or

140
00:07:00,820 --> 00:07:03,960
or some up

141
00:07:10,780 --> 00:07:15,549
in this particular set of case studies

142
00:07:12,759 --> 00:07:19,689
the the average across the four was nine

143
00:07:15,550 --> 00:07:20,860
and a half days there's different logic

144
00:07:19,689 --> 00:07:22,599
and reasoning behind each one and we'll

145
00:07:20,860 --> 00:07:24,939
go through that but on average it took

146
00:07:22,599 --> 00:07:25,930
us nine half days a straight thing and

147
00:07:24,939 --> 00:07:27,909
then we're not touching it always

148
00:07:25,930 --> 00:07:30,629
updated one of the four we're actually

149
00:07:27,909 --> 00:07:30,629
caught it on day one

150
00:07:34,319 --> 00:07:39,280
so when you have a really discovery

151
00:07:37,569 --> 00:07:41,500
chapter your your organization does

152
00:07:39,280 --> 00:07:43,840
something that's really special you may

153
00:07:41,500 --> 00:07:47,259
expect a widget you research something

154
00:07:43,840 --> 00:07:53,770
that's really important right now what's

155
00:07:47,259 --> 00:07:54,729
happening is you have a central body

156
00:07:53,770 --> 00:07:57,669
that's defined a collection of

157
00:07:54,729 --> 00:07:59,560
apartments and they're sourcing that for

158
00:07:57,669 --> 00:08:01,870
multiple different detectors today go

159
00:07:59,560 --> 00:08:03,039
get that information and they're gonna

160
00:08:01,870 --> 00:08:08,080
increase their tanks with day if I

161
00:08:03,039 --> 00:08:10,960
haven't local tactics back what we're

162
00:08:08,080 --> 00:08:14,590
seeing is kind of tactic evolved to use

163
00:08:10,960 --> 00:08:16,568
non spiritual techniques and you know

164
00:08:14,590 --> 00:08:19,539
they may use memory only map an hour

165
00:08:16,569 --> 00:08:21,460
they may use non persistent or for

166
00:08:19,539 --> 00:08:24,009
non-traditional mount words in this case

167
00:08:21,460 --> 00:08:26,109
one of the two two of these actually is

168
00:08:24,009 --> 00:08:29,279
w minor which is I knew a trend across

169
00:08:26,110 --> 00:08:29,279
the routine last one

170
00:08:30,320 --> 00:08:34,110
so in general we think the

171
00:08:32,729 --> 00:08:36,360
organization's need the following it's

172
00:08:34,110 --> 00:08:40,260
really actually identify it and quickly

173
00:08:36,360 --> 00:08:41,760
rapidly response so any an investigation

174
00:08:40,260 --> 00:08:43,860
render demography so what is that

175
00:08:41,760 --> 00:08:46,980
that means you actually have your log

176
00:08:43,860 --> 00:08:47,430
sort of centralized so fire logs pottery

177
00:08:46,980 --> 00:08:50,370
lumps

178
00:08:47,430 --> 00:08:51,599
you can punch big logs and we can

179
00:08:50,370 --> 00:08:52,770
consider your actually gathering the

180
00:08:51,600 --> 00:08:56,150
first name of your system is connected

181
00:08:52,770 --> 00:08:59,279
to network most by default don't do that

182
00:08:56,150 --> 00:09:01,260
proxy loves DNS logs DHCP logs

183
00:08:59,279 --> 00:09:02,880
any virus logs application whitelisting

184
00:09:01,260 --> 00:09:05,160
amongst all those need to be centralized

185
00:09:02,880 --> 00:09:06,540
and searchable references so that when

186
00:09:05,160 --> 00:09:09,000
you do find something that's in it we

187
00:09:06,540 --> 00:09:11,219
can quickly search it I've been in cases

188
00:09:09,000 --> 00:09:13,080
before where you show up and if you want

189
00:09:11,220 --> 00:09:15,180
to run a query over six months of data

190
00:09:13,080 --> 00:09:17,490
it's going to take them like a week to

191
00:09:15,180 --> 00:09:20,880
get the result the result because of

192
00:09:17,490 --> 00:09:22,230
going to instructors there so you need

193
00:09:20,880 --> 00:09:23,670
to be able to view those type of query

194
00:09:22,230 --> 00:09:27,000
so you know I find in my favorites

195
00:09:23,670 --> 00:09:28,589
everybody connected to it in the last

196
00:09:27,000 --> 00:09:29,940
six months and I need that make sure

197
00:09:28,589 --> 00:09:31,860
with it and take five or ten minutes I

198
00:09:29,940 --> 00:09:33,839
need to cost poorly bet against repeal

199
00:09:31,860 --> 00:09:35,279
of you know sort of your he steal all

200
00:09:33,839 --> 00:09:37,620
that you're not really extra track back

201
00:09:35,279 --> 00:09:39,120
to keep your host you can identify that

202
00:09:37,620 --> 00:09:40,830
bad things are happening and it was

203
00:09:39,120 --> 00:09:44,240
coming from these IP addresses but you

204
00:09:40,830 --> 00:09:44,240
can't identify who is actually doing

205
00:09:47,149 --> 00:09:51,829
like I mentioned before you need to

206
00:09:48,499 --> 00:09:53,419
focus your your setup on trying to

207
00:09:51,829 --> 00:09:55,549
identify compromise at multiple stages

208
00:09:53,419 --> 00:09:57,039
exactly exactly so don't just focus on

209
00:09:55,549 --> 00:09:59,348
the info lead efficient attack now

210
00:09:57,039 --> 00:10:01,579
there's benefit in looking for that

211
00:09:59,349 --> 00:10:04,429
identify prevented but you're not always

212
00:10:01,579 --> 00:10:06,228
gonna tension there in three of these

213
00:10:04,429 --> 00:10:12,858
four key studies we actually found three

214
00:10:06,229 --> 00:10:17,569
to get through others be able to

215
00:10:12,859 --> 00:10:21,559
investigate rapidly respond so one of

216
00:10:17,569 --> 00:10:23,598
the challenges in needs two responses if

217
00:10:21,559 --> 00:10:25,339
your only tool to investigating system

218
00:10:23,599 --> 00:10:27,079
is taking a classic image of it that's

219
00:10:25,339 --> 00:10:29,419
not gonna scale especially pretty here a

220
00:10:27,079 --> 00:10:31,909
large global organization of boxes you

221
00:10:29,419 --> 00:10:33,619
need to find where the exit is

222
00:10:31,909 --> 00:10:35,679
I need to then send somebody there to be

223
00:10:33,619 --> 00:10:38,449
there you know see they have set or

224
00:10:35,679 --> 00:10:39,559
taking over chat to them and put them in

225
00:10:38,449 --> 00:10:41,179
to mediate ship it back to some

226
00:10:39,559 --> 00:10:43,009
connection location and then you can

227
00:10:41,179 --> 00:10:45,858
track chain of custody and evidence I

228
00:10:43,009 --> 00:10:47,719
need to you know receive it and you can

229
00:10:45,859 --> 00:10:49,579
check it into evidence I need to work

230
00:10:47,719 --> 00:10:51,079
with copy of it and then I can start

231
00:10:49,579 --> 00:10:52,579
doing analysis and all the meanwhile and

232
00:10:51,079 --> 00:10:53,779
chapters running on your network is

233
00:10:52,579 --> 00:10:56,868
you're trying to catch up to them

234
00:10:53,779 --> 00:10:58,819
so you need tools that are allow you to

235
00:10:56,869 --> 00:11:00,169
remotely pull friends appear there may

236
00:10:58,819 --> 00:11:01,669
need tools out there this is the first

237
00:11:00,169 --> 00:11:02,899
purpose of this stuff is in to kind of

238
00:11:01,669 --> 00:11:04,959
pitch on a particular tool but just

239
00:11:02,899 --> 00:11:07,339
think about the capability to do so

240
00:11:04,959 --> 00:11:09,409
we've tools that allow us that we can

241
00:11:07,339 --> 00:11:11,569
pull forensic data from any system when

242
00:11:09,409 --> 00:11:13,399
I find the assistant I don't care if

243
00:11:11,569 --> 00:11:17,358
it's in Bangalore or in Israel or in

244
00:11:13,399 --> 00:11:18,889
Brazil I can pull the data we will apply

245
00:11:17,359 --> 00:11:19,669
this and then pull the event log to pull

246
00:11:18,889 --> 00:11:22,279
the registry

247
00:11:19,669 --> 00:11:24,049
I pulled Europe history prefetch I can

248
00:11:22,279 --> 00:11:26,299
acquire files I didn't find delete files

249
00:11:24,049 --> 00:11:28,519
and I can utilize that system on the fly

250
00:11:26,299 --> 00:11:30,829
and then you know generate specific

251
00:11:28,519 --> 00:11:32,239
questions so that okay the attacker uses

252
00:11:30,829 --> 00:11:34,279
account will show me everywhere that

253
00:11:32,239 --> 00:11:35,449
I've got a couple of game or I know this

254
00:11:34,279 --> 00:11:36,400
is a complement that you use to that

255
00:11:35,449 --> 00:11:38,709
first thing

256
00:11:36,400 --> 00:11:40,930
you can search the event logs from every

257
00:11:38,710 --> 00:11:44,370
single system population by looking for

258
00:11:40,930 --> 00:11:44,370
logins from that hosting

259
00:11:47,000 --> 00:11:51,889
so in typical kind of network setup so

260
00:11:50,149 --> 00:11:54,800
if we bring it to remember to take again

261
00:11:51,889 --> 00:11:57,110
we have put Baker will review kind of

262
00:11:54,800 --> 00:11:59,709
analysis for dominance approach anybody

263
00:11:57,110 --> 00:11:59,709
network on

264
00:12:04,079 --> 00:12:09,209
one in piece of this particular slide is

265
00:12:06,119 --> 00:12:11,189
where we actually put the modern things

266
00:12:09,209 --> 00:12:12,868
through one monitor of course everything

267
00:12:11,189 --> 00:12:14,819
going in and out of your federal so we

268
00:12:12,869 --> 00:12:16,739
want to see what's going to your DMZ we

269
00:12:14,819 --> 00:12:19,170
want to one it seems a lot of amis don't

270
00:12:16,739 --> 00:12:21,480
think about is tapping the inside

271
00:12:19,170 --> 00:12:23,189
interface of the main trigger as if an

272
00:12:21,480 --> 00:12:24,959
attacker is broken into that you can

273
00:12:23,189 --> 00:12:26,309
it's really the Pokemon it's hard to

274
00:12:24,959 --> 00:12:28,018
find because it it just looks like they

275
00:12:26,309 --> 00:12:30,059
can use our connection to it they're

276
00:12:28,019 --> 00:12:34,589
then moving laterally using you know

277
00:12:30,059 --> 00:12:35,910
common things like RTP shares so tuck in

278
00:12:34,589 --> 00:12:39,619
the inside interface that you can if

279
00:12:35,910 --> 00:12:41,969
they're important obviously technically

280
00:12:39,619 --> 00:12:44,939
all traffic like you pump your proxies

281
00:12:41,970 --> 00:12:46,470
and then the other one that we don't see

282
00:12:44,939 --> 00:12:48,689
many companies do but that's actually

283
00:12:46,470 --> 00:12:50,730
tapping the core

284
00:12:48,689 --> 00:12:52,529
quit different countries so you can not

285
00:12:50,730 --> 00:12:55,470
see any chocolate that's transiting your

286
00:12:52,529 --> 00:12:56,699
core network so if it's going from one

287
00:12:55,470 --> 00:12:59,639
site to another site we're going to see

288
00:12:56,699 --> 00:13:00,719
that traffic and that is probably one of

289
00:12:59,639 --> 00:13:02,489
the most critical pieces if you're

290
00:13:00,720 --> 00:13:04,319
actually gonna identify things and say

291
00:13:02,489 --> 00:13:07,649
that the move on phase of the tech

292
00:13:04,319 --> 00:13:09,569
lifecycle or participation or some of

293
00:13:07,649 --> 00:13:10,949
the common services you're only going to

294
00:13:09,569 --> 00:13:13,259
see if I might be attractive at that

295
00:13:10,949 --> 00:13:15,979
point so if they're not doing that a lot

296
00:13:13,259 --> 00:13:15,980
of these techniques don't work

297
00:13:18,710 --> 00:13:25,610
so here are four key cities we had one

298
00:13:22,279 --> 00:13:28,070
that involved a joint venture we have

299
00:13:25,610 --> 00:13:30,050
one involved an outsourcer with one

300
00:13:28,070 --> 00:13:32,330
where the action is partly derivative in

301
00:13:30,050 --> 00:13:38,540
time trigger we've one word we found

302
00:13:32,330 --> 00:13:41,480
through the eye you see a Sony tech

303
00:13:38,540 --> 00:13:45,349
venture the this one this one thing

304
00:13:41,480 --> 00:13:48,200
because this company has multiple life

305
00:13:45,350 --> 00:13:49,820
story metrics around the world and they

306
00:13:48,200 --> 00:13:51,980
don't really control this entity and

307
00:13:49,820 --> 00:13:53,240
they're putting on speakers so they

308
00:13:51,980 --> 00:13:55,010
can't dictate what that you attempted

309
00:13:53,240 --> 00:13:55,459
and so they peckers broke into the joint

310
00:13:55,010 --> 00:13:57,200
venture

311
00:13:55,459 --> 00:14:00,310
they found you he knows that were being

312
00:13:57,200 --> 00:14:03,740
sent from the joint venture to the

313
00:14:00,310 --> 00:14:05,209
clients network and they found that it

314
00:14:03,740 --> 00:14:07,070
was reasonably simpler than Excel the

315
00:14:05,209 --> 00:14:10,310
time so they stripped off the excel at

316
00:14:07,070 --> 00:14:11,870
entrance created an Excel macro xlsm and

317
00:14:10,310 --> 00:14:13,279
then resetting it out to the you're

318
00:14:11,870 --> 00:14:15,250
saying hey I haven't updated you know

319
00:14:13,279 --> 00:14:17,720
copy of the document please take a look

320
00:14:15,250 --> 00:14:19,070
click on it because it's coming from

321
00:14:17,720 --> 00:14:21,140
email addresses through email

322
00:14:19,070 --> 00:14:22,580
infrastructure in a conversation that

323
00:14:21,140 --> 00:14:28,610
they were expected to receive from

324
00:14:22,580 --> 00:14:32,529
photographers at that point the what was

325
00:14:28,610 --> 00:14:35,450
new we're doing out this is the system I

326
00:14:32,529 --> 00:14:39,560
was looking for the perception and it

327
00:14:35,450 --> 00:14:41,270
dropped a JavaScript backdoor which is

328
00:14:39,560 --> 00:14:44,449
the new website we never seen that

329
00:14:41,270 --> 00:14:46,069
before the actual persistence mechanism

330
00:14:44,450 --> 00:14:48,150
took me I actually passed over the first

331
00:14:46,070 --> 00:14:50,620
time going through this

332
00:14:48,150 --> 00:14:53,620
probably took me now I have to find it

333
00:14:50,620 --> 00:14:55,900
what they did was he crazy delete file

334
00:14:53,620 --> 00:14:57,760
that link file was in a started for I

335
00:14:55,900 --> 00:14:59,319
didn't know you can do this until I

336
00:14:57,760 --> 00:15:01,600
found this place they actually invoked

337
00:14:59,320 --> 00:15:04,450
in the link file the windows script host

338
00:15:01,600 --> 00:15:05,950
of demonstrators and invoke use Windows

339
00:15:04,450 --> 00:15:09,130
cryptic notice that both the JavaScript

340
00:15:05,950 --> 00:15:11,110
file so link file in a starter folder

341
00:15:09,130 --> 00:15:15,450
window strictly notice X key in

342
00:15:11,110 --> 00:15:18,040
JavaScript prequel really Clark fine and

343
00:15:15,450 --> 00:15:22,210
kind of the power of creative function

344
00:15:18,040 --> 00:15:26,740
so the back door beating out to a cloud

345
00:15:22,210 --> 00:15:28,090
website would be categorized in and not

346
00:15:26,740 --> 00:15:29,830
blocking a lot of like you can any

347
00:15:28,090 --> 00:15:34,930
organization and it went in it

348
00:15:29,830 --> 00:15:38,010
downloaded the man comes pointing to be

349
00:15:34,930 --> 00:15:38,010
where to connect to or

350
00:15:42,500 --> 00:15:47,540
some of the interesting aspects from

351
00:15:44,000 --> 00:15:50,060
this one to the used javascript back to

352
00:15:47,540 --> 00:15:52,130
work they all CEW mine once he started

353
00:15:50,060 --> 00:15:57,040
remodeling they would use the JavaScript

354
00:15:52,130 --> 00:15:59,510
back doors to install now where the w-

355
00:15:57,040 --> 00:16:05,290
so from a detection perspectives of his

356
00:15:59,510 --> 00:16:05,290
20-gauge to detect activity a long time

357
00:16:05,410 --> 00:16:11,249
how do we detect it we by monitoring

358
00:16:08,679 --> 00:16:13,478
site to site traffic when the attacker

359
00:16:11,249 --> 00:16:15,809
finally isolated his privilege and got

360
00:16:13,479 --> 00:16:17,979
out of a particular Network soon and

361
00:16:15,809 --> 00:16:19,868
they moved to a different unit they

362
00:16:17,979 --> 00:16:21,249
access the server they've done password

363
00:16:19,869 --> 00:16:24,099
hash from the servers and copy the files

364
00:16:21,249 --> 00:16:26,109
over so we saw flying fox network passes

365
00:16:24,099 --> 00:16:35,199
touch the hatches in Ian's buyers and so

366
00:16:26,109 --> 00:16:37,239
that was actually in the tech lifecycle

367
00:16:35,199 --> 00:16:39,878
this is the kind of diagram that we

368
00:16:37,239 --> 00:16:42,579
generally use it starts with initial

369
00:16:39,879 --> 00:16:44,709
recon then you have a compromised

370
00:16:42,579 --> 00:16:46,059
established football and attacker than

371
00:16:44,709 --> 00:16:47,738
the infested their privileges

372
00:16:46,059 --> 00:16:50,108
lastly the privileges they're going to

373
00:16:47,739 --> 00:16:51,220
insert connect and recon in turn they're

374
00:16:50,109 --> 00:16:54,729
gonna remodel each other's systems

375
00:16:51,220 --> 00:16:57,339
trying to maintain presence by dropping

376
00:16:54,729 --> 00:16:59,049
additional back to work and then further

377
00:16:57,339 --> 00:17:00,999
escalate privileges so that usually go

378
00:16:59,049 --> 00:17:03,489
in that cycle for a little bit and it

379
00:17:00,999 --> 00:17:05,500
makes you want to complete so this is

380
00:17:03,489 --> 00:17:06,759
when I talk about the attack lifecycle

381
00:17:05,500 --> 00:17:08,859
this is what we're talking about and

382
00:17:06,759 --> 00:17:10,319
thinking about if you think about an

383
00:17:08,859 --> 00:17:12,428
attack in that perspective and

384
00:17:10,319 --> 00:17:14,109
organizing your your defenses and the

385
00:17:12,429 --> 00:17:14,860
protection that can be there on that you

386
00:17:14,109 --> 00:17:18,069
can actually come up with some pretty

387
00:17:14,859 --> 00:17:19,750
creative ways so this one it's actually

388
00:17:18,069 --> 00:17:21,519
technically to both lose viability and

389
00:17:19,750 --> 00:17:22,089
encourages its the attacker at this

390
00:17:21,519 --> 00:17:24,069
point

391
00:17:22,089 --> 00:17:25,319
who's our debugging system and they were

392
00:17:24,069 --> 00:17:28,470
trying to moving

393
00:17:25,319 --> 00:17:30,269
and try to do but had some privileged

394
00:17:28,470 --> 00:17:31,679
accounts in a couple of systems and they

395
00:17:30,269 --> 00:17:34,730
were trying to a state to produce to get

396
00:17:31,679 --> 00:17:34,730
to get a demonstrator

397
00:17:39,300 --> 00:17:44,550
so why did it take us 20 days well the

398
00:17:43,020 --> 00:17:47,100
purpose was they did nothing for the

399
00:17:44,550 --> 00:17:49,290
first 13 days after compromising the

400
00:17:47,100 --> 00:17:52,350
person other than making sure they

401
00:17:49,290 --> 00:17:54,149
affect your presence there they didn't

402
00:17:52,350 --> 00:17:59,520
really use that system much so that was

403
00:17:54,150 --> 00:18:01,230
their treatment their activity for the

404
00:17:59,520 --> 00:18:06,720
first 20 gauge was all within a very

405
00:18:01,230 --> 00:18:08,640
small isolated Network 1030 felt itself

406
00:18:06,720 --> 00:18:10,110
and they didn't really actually escalate

407
00:18:08,640 --> 00:18:12,840
their privileges or breakout work with

408
00:18:10,110 --> 00:18:17,219
them that network them until they 28th

409
00:18:12,840 --> 00:18:19,050
when he did so the 28th to do little

410
00:18:17,220 --> 00:18:20,160
misleading because although they were

411
00:18:19,050 --> 00:18:21,540
there at that period they did they

412
00:18:20,160 --> 00:18:24,780
weren't able actually do anything with

413
00:18:21,540 --> 00:18:26,970
it had time to point yet when they were

414
00:18:24,780 --> 00:18:30,830
seeing data or identifying if they were

415
00:18:26,970 --> 00:18:30,830
still in the early phase of attack

416
00:18:34,010 --> 00:18:37,580
so from when we identified that when we

417
00:18:36,290 --> 00:18:40,280
actually scoped remediated to the

418
00:18:37,580 --> 00:18:43,189
Freemasons next to theirs too

419
00:18:40,280 --> 00:18:45,649
we've estimated your movies after block

420
00:18:43,190 --> 00:18:51,080
they're the main control we remove the

421
00:18:45,650 --> 00:18:53,750
infected system this particular client

422
00:18:51,080 --> 00:18:59,059
had another dream mentor and with this

423
00:18:53,750 --> 00:19:01,309
joint venture they had they had to allow

424
00:18:59,059 --> 00:19:04,010
certain ports so that joint venture the

425
00:19:01,309 --> 00:19:07,010
excess that SAT investment and so on

426
00:19:04,010 --> 00:19:08,360
their firewall rules they allowed three

427
00:19:07,010 --> 00:19:11,780
three eight zero two three three nine

428
00:19:08,360 --> 00:19:15,020
two on there because some agents in the

429
00:19:11,780 --> 00:19:16,370
reports well what's the RDP protocol

430
00:19:15,020 --> 00:19:18,950
three three eight nine

431
00:19:16,370 --> 00:19:20,840
so although a type of remove attackers

432
00:19:18,950 --> 00:19:22,220
network we block search the queue and we

433
00:19:20,840 --> 00:19:23,928
change the passwords of the beacon

434
00:19:22,220 --> 00:19:25,460
accounts we knew they had there were

435
00:19:23,929 --> 00:19:26,630
other passwords that the again so they

436
00:19:25,460 --> 00:19:29,240
just started feed from this other

437
00:19:26,630 --> 00:19:31,299
network you squash them on one side and

438
00:19:29,240 --> 00:19:33,110
they popped over for this other networks

439
00:19:31,299 --> 00:19:33,918
that we didn't know existed

440
00:19:33,110 --> 00:19:37,520
that we didn't know they had any

441
00:19:33,919 --> 00:19:39,650
connection to and that was that was we

442
00:19:37,520 --> 00:19:43,250
spent the third day finding that about

443
00:19:39,650 --> 00:19:44,630
them gaming so in this case when all is

444
00:19:43,250 --> 00:19:47,299
said and done had southern pectin

445
00:19:44,630 --> 00:19:48,860
systems he had 57 access systems where

446
00:19:47,299 --> 00:19:51,320
they're attempting to check their

447
00:19:48,860 --> 00:19:53,580
credentials see if it was perfectly done

448
00:19:51,320 --> 00:19:56,129
passwords apparently

449
00:19:53,580 --> 00:19:59,989
and we least 13 different network-based

450
00:19:56,129 --> 00:19:59,988
engage of complement so I can

451
00:20:02,800 --> 00:20:06,250
so one together they're interesting

452
00:20:04,420 --> 00:20:09,430
things about this case this is first

453
00:20:06,250 --> 00:20:13,600
time leasing it was they use WMI for

454
00:20:09,430 --> 00:20:16,600
persistence so kind of a trimmer on what

455
00:20:13,600 --> 00:20:19,870
W is it's on every system since Windows

456
00:20:16,600 --> 00:20:21,550
2000 so it's in it's pretty much

457
00:20:19,870 --> 00:20:23,590
ubiquitous now and running by default

458
00:20:21,550 --> 00:20:24,879
every city the whole point is to allow

459
00:20:23,590 --> 00:20:28,090
to remotely into the system through

460
00:20:24,880 --> 00:20:31,830
vbscript or powershell and I think Dave

461
00:20:28,090 --> 00:20:31,830
pole is giving a talk later think about

462
00:20:35,070 --> 00:20:39,990
what teaching is there honor

463
00:20:38,080 --> 00:20:42,010
they're called managed object files and

464
00:20:39,990 --> 00:20:45,270
they're used implement particular

465
00:20:42,010 --> 00:20:47,710
classes and immunize so you can't just

466
00:20:45,270 --> 00:20:49,000
put a piece of software up on a name

467
00:20:47,710 --> 00:20:50,860
system you actually have to compile it

468
00:20:49,000 --> 00:20:56,740
on that system of approach run and be

469
00:20:50,860 --> 00:20:57,909
incorporated into the so that would show

470
00:20:56,740 --> 00:21:02,590
up as kind of a team's work for

471
00:20:57,910 --> 00:21:04,810
entertainment majors the main namespace

472
00:21:02,590 --> 00:21:06,250
that you know use it in terms of

473
00:21:04,810 --> 00:21:11,710
implementing those but those boxes is

474
00:21:06,250 --> 00:21:13,450
called route / 7dt and then lastly the

475
00:21:11,710 --> 00:21:14,890
information the actual backdoor itself

476
00:21:13,450 --> 00:21:17,350
will be stored in a data structure

477
00:21:14,890 --> 00:21:19,090
called hot jets iPad and this is

478
00:21:17,350 --> 00:21:20,530
important because here if you were to

479
00:21:19,090 --> 00:21:21,879
say the time lining system you know was

480
00:21:20,530 --> 00:21:23,260
compromised on a particular date in time

481
00:21:21,880 --> 00:21:25,090
and you're looking for a piece of

482
00:21:23,260 --> 00:21:27,550
malware that binary there will be no

483
00:21:25,090 --> 00:21:28,840
binary and if you just doing any

484
00:21:27,550 --> 00:21:30,970
timeline analysis you may miss it

485
00:21:28,840 --> 00:21:32,169
because you have to accept that would

486
00:21:30,970 --> 00:21:33,850
have been created when the system was

487
00:21:32,170 --> 00:21:35,440
installed any people it's going to use

488
00:21:33,850 --> 00:21:37,949
not modified constant so if i can show

489
00:21:35,440 --> 00:21:37,950
up when your

490
00:21:42,530 --> 00:21:47,300
so how can you actually instrument or or

491
00:21:44,840 --> 00:21:49,699
influence W on our you can either write

492
00:21:47,300 --> 00:21:51,770
write a JavaScript backdoor write a

493
00:21:49,700 --> 00:21:54,440
vbscript backdoor or can I tell yourself

494
00:21:51,770 --> 00:21:59,120
after the to the we've seen so far our

495
00:21:54,440 --> 00:22:00,500
JavaScript invasion when he maintained

496
00:21:59,120 --> 00:22:04,580
needs to note about this particular case

497
00:22:00,500 --> 00:22:06,350
was that the way they devote they

498
00:22:04,580 --> 00:22:08,990
actually invoked it an instantiation of

499
00:22:06,350 --> 00:22:11,389
Internet Explorer and so I picture we

500
00:22:08,990 --> 00:22:12,740
gonna vlog Deborah Kerr blog about it on

501
00:22:11,390 --> 00:22:15,380
our website we're actually talking about

502
00:22:12,740 --> 00:22:19,130
that when this dripping hose and how

503
00:22:15,380 --> 00:22:20,960
they implemented this particular back

504
00:22:19,130 --> 00:22:23,000
door what that a lot of for us is

505
00:22:20,960 --> 00:22:25,280
because they can vote the Internet's for

506
00:22:23,000 --> 00:22:27,470
instance it actually stored the commands

507
00:22:25,280 --> 00:22:29,060
that they were pulling down in temporary

508
00:22:27,470 --> 00:22:31,070
internet files so we just went to

509
00:22:29,060 --> 00:22:32,240
temporary files we do basically pulled

510
00:22:31,070 --> 00:22:34,550
in partial to one of those we had

511
00:22:32,240 --> 00:22:36,170
everything Amalekites so I don't think

512
00:22:34,550 --> 00:22:37,760
that's what was happening there

513
00:22:36,170 --> 00:22:39,530
background so you know we need to detect

514
00:22:37,760 --> 00:22:41,390
it for twenty days he actually could

515
00:22:39,530 --> 00:22:44,139
very quickly figure out what they were

516
00:22:41,390 --> 00:22:44,140
doing during that time

517
00:22:48,880 --> 00:22:54,990
so here's an example of what you might

518
00:22:51,220 --> 00:22:54,990
expect they're seeking W right now like

519
00:22:55,049 --> 00:23:00,850
you're gonna define an event in shelter

520
00:22:57,490 --> 00:23:02,919
so what's happening in basic mine and

521
00:23:00,850 --> 00:23:05,740
what's happening in various parts of the

522
00:23:02,919 --> 00:23:07,659
system you're creating a filter you're

523
00:23:05,740 --> 00:23:11,200
excited in HBase which is roots in BT

524
00:23:07,659 --> 00:23:12,610
you have to give it a name and then you

525
00:23:11,200 --> 00:23:14,019
have a query the query is actually how

526
00:23:12,610 --> 00:23:15,969
they do that which is inspected in this

527
00:23:14,019 --> 00:23:17,799
case so it's checking the internal

528
00:23:15,970 --> 00:23:20,340
system clock time and any time it takes

529
00:23:17,799 --> 00:23:23,139
five seconds it's gonna fire

530
00:23:20,340 --> 00:23:24,908
so that's implement using the windows

531
00:23:23,139 --> 00:23:27,158
career language so that's actually what

532
00:23:24,909 --> 00:23:30,789
what is kicking off the JavaScript

533
00:23:27,159 --> 00:23:32,409
module now what you'll see is an

534
00:23:30,789 --> 00:23:34,809
instance of the active subscription

535
00:23:32,409 --> 00:23:35,830
event consumer detective assuming that

536
00:23:34,809 --> 00:23:36,850
you have the scripting engine you have

537
00:23:35,830 --> 00:23:38,500
to define this in this case it's

538
00:23:36,850 --> 00:23:40,570
JavaScript code you can be stripped or

539
00:23:38,500 --> 00:23:43,059
PowerShell and you see if you after that

540
00:23:40,570 --> 00:23:48,279
accept it and so this is where they're

541
00:23:43,059 --> 00:23:49,480
actually implementing the logical it's

542
00:23:48,279 --> 00:23:51,899
longer than this but this is tentative

543
00:23:49,480 --> 00:23:51,899
you know

544
00:23:55,940 --> 00:24:01,219
so my friends perspective what does it

545
00:23:58,009 --> 00:24:02,539
look like well if you're sitting in any

546
00:24:01,219 --> 00:24:04,699
user workplace tea might have some cream

547
00:24:02,539 --> 00:24:05,929
in sauce so some of the prefetch ecology

548
00:24:04,699 --> 00:24:07,759
might be looking forward you might see

549
00:24:05,929 --> 00:24:10,909
you're in CC stripped of every strip

550
00:24:07,759 --> 00:24:12,919
depending on those you know what they're

551
00:24:10,909 --> 00:24:16,069
doing the vbscript backdoor for using

552
00:24:12,919 --> 00:24:20,499
javascript backdoor you might see mom

553
00:24:16,069 --> 00:24:25,339
come a mock comp is the actual compiler

554
00:24:20,499 --> 00:24:28,729
or installed and FC are colonies that

555
00:24:25,339 --> 00:24:33,499
could speed this trip to Memphis

556
00:24:28,729 --> 00:24:37,129
tomorrow if you're lucky you may see the

557
00:24:33,499 --> 00:24:40,279
actual f5 in some cases we did in other

558
00:24:37,129 --> 00:24:42,289
cases we did you can't assume whether

559
00:24:40,279 --> 00:24:44,959
lie that that's going to be there you

560
00:24:42,289 --> 00:24:48,769
may also see a file of show up in the

561
00:24:44,959 --> 00:24:50,989
auto recover record and then lastly if

562
00:24:48,769 --> 00:24:53,359
you look at the rectory at Richie time

563
00:24:50,989 --> 00:24:54,979
camping an analysis we may see some

564
00:24:53,359 --> 00:24:57,619
Richard whose modified records

565
00:24:54,979 --> 00:25:01,449
breakfasting route 72 when in this case

566
00:24:57,619 --> 00:25:01,448
the winter two clocks provider game

567
00:25:05,360 --> 00:25:08,360
yes

568
00:25:10,420 --> 00:25:17,320
yeah the actual the back door itself

569
00:25:14,500 --> 00:25:19,060
will be any outlets have gates reference

570
00:25:17,320 --> 00:25:21,040
fusion pretty big it's been kind of

571
00:25:19,060 --> 00:25:23,080
server it's been anywhere from 30 to 50

572
00:25:21,040 --> 00:25:25,470
tonight you're gonna have to take that

573
00:25:23,080 --> 00:25:25,470
file

574
00:25:35,760 --> 00:25:40,650
like how would you look for that so some

575
00:25:39,630 --> 00:25:43,440
of the techniques that we found really

576
00:25:40,650 --> 00:25:49,200
useful it don't happen very often and

577
00:25:43,440 --> 00:25:54,830
objects that data would be certain

578
00:25:49,200 --> 00:25:58,020
things like W script echo W script dot

579
00:25:54,830 --> 00:26:01,470
the three or four one to rename any

580
00:25:58,020 --> 00:26:08,129
after that object is pretty unique in

581
00:26:01,470 --> 00:26:10,290
st. 1894 the looking for the the

582
00:26:08,130 --> 00:26:12,000
anything that has an event consumer I

583
00:26:10,290 --> 00:26:18,930
would took with them that the blue side

584
00:26:12,000 --> 00:26:21,720
is just before there's also another so

585
00:26:18,930 --> 00:26:23,430
if you see the the hashtag probably

586
00:26:21,720 --> 00:26:30,090
autorecover at the top of an Anglophile

587
00:26:23,430 --> 00:26:32,220
what that means is and in case the tax

588
00:26:30,090 --> 00:26:33,510
gets corrupted there's a series of files

589
00:26:32,220 --> 00:26:36,240
in the auto recover directory as

590
00:26:33,510 --> 00:26:39,390
evidence and so if it gets corrupted it

591
00:26:36,240 --> 00:26:43,290
can rebuild and recompile the W might

592
00:26:39,390 --> 00:26:44,160
acid from that so if they instantiated

593
00:26:43,290 --> 00:26:45,990
pragma autorecover

594
00:26:44,160 --> 00:26:47,640
they'll have an M on a shelf in their

595
00:26:45,990 --> 00:26:49,710
auto cover directory if they don't

596
00:26:47,640 --> 00:26:51,210
specify that being stripped you won't

597
00:26:49,710 --> 00:26:53,580
see one so you can't just go to the auto

598
00:26:51,210 --> 00:26:57,980
recover directory to look at all the W

599
00:26:53,580 --> 00:26:57,980
my trick for novices

600
00:27:01,260 --> 00:27:04,530
so if you would actually do this

601
00:27:02,610 --> 00:27:07,530
yourself this is not from these

602
00:27:04,530 --> 00:27:09,990
acquisitions we made the way to do

603
00:27:07,530 --> 00:27:11,520
install it you're gonna see ma ya mop up

604
00:27:09,990 --> 00:27:13,260
you have to actually compile the amount

605
00:27:11,520 --> 00:27:15,840
fun so you're going to see it actually

606
00:27:13,260 --> 00:27:17,820
get compiled it's going to parse it and

607
00:27:15,840 --> 00:27:24,689
then place it being little posterity

608
00:27:17,820 --> 00:27:26,909
option set data repository Microsoft

609
00:27:24,690 --> 00:27:31,500
reason just updating systems manages the

610
00:27:26,910 --> 00:27:33,210
auto room so what people actually never

611
00:27:31,500 --> 00:27:37,020
intended so if you this is actually a

612
00:27:33,210 --> 00:27:38,669
system where we ran it on the we have we

613
00:27:37,020 --> 00:27:39,870
had an infected objects dot data and

614
00:27:38,669 --> 00:27:42,090
that's the way it shows up right there

615
00:27:39,870 --> 00:27:45,479
you know W my database entry with the

616
00:27:42,090 --> 00:27:47,340
with the name smq tumor then you can

617
00:27:45,480 --> 00:27:52,770
click on the double-click go for copy

618
00:27:47,340 --> 00:27:55,040
you'll actually get the data like was

619
00:27:52,770 --> 00:27:55,040
running

620
00:28:01,380 --> 00:28:06,360
before going on the challenge here is

621
00:28:03,480 --> 00:28:07,950
that WMI now where there's almost no

622
00:28:06,360 --> 00:28:10,049
information I like publicly on your

623
00:28:07,950 --> 00:28:11,220
negatives like one Trend Micro article

624
00:28:10,049 --> 00:28:12,720
talking about this

625
00:28:11,220 --> 00:28:15,559
so all this we had to kind of figure out

626
00:28:12,720 --> 00:28:17,970
on our own and maybe made the first

627
00:28:15,559 --> 00:28:20,759
analysis of this and figuring out how to

628
00:28:17,970 --> 00:28:22,679
work what you do how you find it how do

629
00:28:20,759 --> 00:28:25,009
we need other people to find it if it

630
00:28:22,679 --> 00:28:27,360
happens it's been pretty difficult so

631
00:28:25,009 --> 00:28:28,980
this is kind of our least our first

632
00:28:27,360 --> 00:28:32,149
attempt to document some of some of the

633
00:28:28,980 --> 00:28:32,149
things for the Prezi screen

634
00:28:36,600 --> 00:28:43,300
that's case one case two was interesting

635
00:28:40,860 --> 00:28:47,949
largely because they were pretty much no

636
00:28:43,300 --> 00:28:50,379
back door now we do see these actors

637
00:28:47,950 --> 00:28:57,010
broke in what they did was they this

638
00:28:50,380 --> 00:29:00,220
senior company helps works there and so

639
00:28:57,010 --> 00:29:01,750
that company had direct access RDP using

640
00:29:00,220 --> 00:29:04,600
the local administrator account on one

641
00:29:01,750 --> 00:29:06,460
system so detector compromised there's a

642
00:29:04,600 --> 00:29:08,469
different attacker they compromised this

643
00:29:06,460 --> 00:29:10,300
this other company the outputs or

644
00:29:08,470 --> 00:29:11,920
leverage that tunnel between the two

645
00:29:10,300 --> 00:29:13,600
companies already beat into the system

646
00:29:11,920 --> 00:29:19,929
and then use that system to the beach

647
00:29:13,600 --> 00:29:21,340
and it started with a matter so from

648
00:29:19,929 --> 00:29:25,150
when they actually broke things when we

649
00:29:21,340 --> 00:29:26,980
detected it to confuse and the way to be

650
00:29:25,150 --> 00:29:29,110
detected is because they deported myself

651
00:29:26,980 --> 00:29:31,630
so they were going to take their part of

652
00:29:29,110 --> 00:29:34,300
the network in a smaller part of their

653
00:29:31,630 --> 00:29:35,800
network and they had SK the privilege

654
00:29:34,300 --> 00:29:42,850
and privileges and we're trying to eat

655
00:29:35,800 --> 00:29:44,169
laterally so the attackers had gotten on

656
00:29:42,850 --> 00:29:47,050
the domain controller for the smaller

657
00:29:44,170 --> 00:29:49,929
network passport Isis and none of those

658
00:29:47,050 --> 00:29:51,370
accounts work on the network so they

659
00:29:49,929 --> 00:29:53,350
started giving port standings and

660
00:29:51,370 --> 00:29:54,459
looking for internal vulnerabilities and

661
00:29:53,350 --> 00:29:56,350
misconfigurations

662
00:29:54,460 --> 00:29:58,630
we found the Tomcat server that had a

663
00:29:56,350 --> 00:30:01,178
default administrator pencil so they

664
00:29:58,630 --> 00:30:05,440
access the Tomcat server to play the web

665
00:30:01,179 --> 00:30:07,390
shell and use that lips up to then run

666
00:30:05,440 --> 00:30:09,400
commands on average so we saw that open

667
00:30:07,390 --> 00:30:11,640
network we saw the deployment that one

668
00:30:09,400 --> 00:30:11,640
child

669
00:30:13,880 --> 00:30:18,650
so from attack life cycle perspective

670
00:30:16,070 --> 00:30:22,418
this was in the mood light blue light

671
00:30:18,650 --> 00:30:22,419
would take so this kind of time you

672
00:30:25,860 --> 00:30:29,459
so what made these cases penguins that

673
00:30:27,750 --> 00:30:31,740
because of that actress they had they

674
00:30:29,460 --> 00:30:33,480
did they didn't need any back doors so

675
00:30:31,740 --> 00:30:36,419
they leverage with the access to this

676
00:30:33,480 --> 00:30:39,779
house they targeted the clients artists

677
00:30:36,419 --> 00:30:41,250
a infrastructure they found users a good

678
00:30:39,779 --> 00:30:42,510
word in any motors they require two

679
00:30:41,250 --> 00:30:44,250
factor authentication two actors there

680
00:30:42,510 --> 00:30:46,769
were you can finally use is that one can

681
00:30:44,250 --> 00:30:49,200
only go and cut their pens and then use

682
00:30:46,769 --> 00:30:50,880
that to beginning to the so between the

683
00:30:49,200 --> 00:30:53,779
access from the upper upper and the

684
00:30:50,880 --> 00:30:53,779
access music an

685
00:31:03,140 --> 00:31:06,289
the way that they would put all this

686
00:31:04,669 --> 00:31:07,549
together because Annette rotated we

687
00:31:06,289 --> 00:31:10,070
didn't have the network data that we're

688
00:31:07,549 --> 00:31:12,230
tracking it back if we finally traced it

689
00:31:10,070 --> 00:31:13,760
back to this particular system you know

690
00:31:12,230 --> 00:31:16,340
we're doing ounce of refinement count

691
00:31:13,760 --> 00:31:18,559
that lock in were searching for use of

692
00:31:16,340 --> 00:31:24,350
that account it took us all the way back

693
00:31:18,559 --> 00:31:26,269
to this warning system that was you know

694
00:31:24,350 --> 00:31:27,830
we saw logins from to copy address

695
00:31:26,269 --> 00:31:32,059
management claim okay that's what it's

696
00:31:27,830 --> 00:31:34,340
like oh that's our outfit so we then had

697
00:31:32,059 --> 00:31:36,519
to do an imitation adapter for what they

698
00:31:34,340 --> 00:31:36,519
have

699
00:31:41,200 --> 00:31:45,430
so from detection to scoping and

700
00:31:43,420 --> 00:31:46,930
remediation took us two days to kind of

701
00:31:45,430 --> 00:31:48,580
put together your story figure out what

702
00:31:46,930 --> 00:31:51,970
happened and actually get you know get

703
00:31:48,580 --> 00:31:54,429
it successfully so no infected system

704
00:31:51,970 --> 00:31:56,170
from a back door perspective they

705
00:31:54,430 --> 00:32:00,600
accessed 27 systems in the environment

706
00:31:56,170 --> 00:32:00,600
and no real network infrastructure

707
00:32:09,710 --> 00:32:12,280
so

708
00:32:13,450 --> 00:32:21,099
the is to take the client also have her

709
00:32:18,459 --> 00:32:22,989
pretreated metal detector theater

710
00:32:21,099 --> 00:32:28,168
leading son was the same as the

711
00:32:22,989 --> 00:32:30,579
detective in the first a study when we

712
00:32:28,169 --> 00:32:32,709
actually this is actually the second

713
00:32:30,579 --> 00:32:34,418
client where we had I became used

714
00:32:32,709 --> 00:32:41,709
properly to this isn't what we talked

715
00:32:34,419 --> 00:32:43,299
about back on early this is some of

716
00:32:41,709 --> 00:32:46,629
what's different is in the initial

717
00:32:43,299 --> 00:32:51,099
attacks on Harper Lee we could actually

718
00:32:46,629 --> 00:32:53,019
triggered a lot of ideas work and so the

719
00:32:51,099 --> 00:32:57,668
way they were doing the exploit I would

720
00:32:53,019 --> 00:32:59,349
was while the connection was funny the

721
00:32:57,669 --> 00:33:01,839
way that they use her plea to this was

722
00:32:59,349 --> 00:33:06,399
later this was about a week later when

723
00:33:01,839 --> 00:33:08,649
they did this after the expose up their

724
00:33:06,399 --> 00:33:11,859
being in terms of they actually moved

725
00:33:08,649 --> 00:33:14,619
the use of the heart wait next 22 after

726
00:33:11,859 --> 00:33:16,539
the SSL to channel so we had a full

727
00:33:14,619 --> 00:33:21,279
kicked out of the data and it didn't

728
00:33:16,539 --> 00:33:24,129
find any ideas and so all of the acts of

729
00:33:21,279 --> 00:33:27,239
exploitation in the encrypted come up

730
00:33:24,129 --> 00:33:27,238
which made it much harder to identify

731
00:33:28,690 --> 00:33:33,799
so they used to hurt the exploit in this

732
00:33:32,149 --> 00:33:36,739
particular case to actually break into

733
00:33:33,799 --> 00:33:40,010
lead in country and so this is a second

734
00:33:36,740 --> 00:33:41,929
instance the median comes rated by that

735
00:33:40,010 --> 00:33:45,260
manufacturer being targeted in our

736
00:33:41,929 --> 00:33:48,890
experience it makes sense that you're

737
00:33:45,260 --> 00:33:50,090
going to see you know if you want to

738
00:33:48,890 --> 00:33:52,549
break into a company that's actually

739
00:33:50,090 --> 00:33:55,639
probably the best way to leverage tedx

740
00:33:52,549 --> 00:33:56,990
way to to have some effect the other

741
00:33:55,640 --> 00:33:58,549
ways we're just going to be if he just

742
00:33:56,990 --> 00:33:59,809
turned in a website we're gonna go get

743
00:33:58,549 --> 00:34:02,240
some friends instead websites as

744
00:33:59,809 --> 00:34:02,990
information if you want to break into

745
00:34:02,240 --> 00:34:05,740
the company

746
00:34:02,990 --> 00:34:05,740
Charlie

747
00:34:09,219 --> 00:34:15,509
so from you know from when they've

748
00:34:11,829 --> 00:34:18,879
broken when we actually visited a piece

749
00:34:15,510 --> 00:34:20,859
when we saw was detectors if they move

750
00:34:18,879 --> 00:34:21,879
laterally as if Network there's only so

751
00:34:20,859 --> 00:34:24,129
many ways that you can actually gives

752
00:34:21,879 --> 00:34:25,509
you the run on the remote system and one

753
00:34:24,129 --> 00:34:27,699
of those it's coming from any attackers

754
00:34:25,510 --> 00:34:29,349
just using when you take the test and so

755
00:34:27,699 --> 00:34:36,279
we saw them you know scheduler task of

756
00:34:29,349 --> 00:34:40,839
trunk network pack next and then it's a

757
00:34:36,280 --> 00:34:43,149
good play now we're sitting here in this

758
00:34:40,839 --> 00:34:45,279
particular case you know we don't go

759
00:34:43,149 --> 00:34:47,710
into cases like with a preconceived

760
00:34:45,280 --> 00:34:50,589
notion of what happened we look like the

761
00:34:47,710 --> 00:34:53,319
leads kind of development generate and

762
00:34:50,589 --> 00:34:55,960
we follow so this particular dates you

763
00:34:53,319 --> 00:34:57,069
see the windows single task we didn't

764
00:34:55,960 --> 00:34:57,400
need any jump to oh it must have been

765
00:34:57,069 --> 00:34:59,319
hard

766
00:34:57,400 --> 00:35:01,599
we have to work our way back to get done

767
00:34:59,319 --> 00:35:02,740
and so there's various methods and

768
00:35:01,599 --> 00:35:04,690
techniques that it used to be that

769
00:35:02,740 --> 00:35:06,069
sometimes going to be pulling forensic

770
00:35:04,690 --> 00:35:07,839
data from assistant so I know how to

771
00:35:06,069 --> 00:35:10,960
Tuesday's consider in research I had a

772
00:35:07,839 --> 00:35:12,849
system that had the windows task

773
00:35:10,960 --> 00:35:14,500
scheduler month on it and then the

774
00:35:12,849 --> 00:35:15,700
system when they did that from so we're

775
00:35:14,500 --> 00:35:17,890
full Friends of data from those two

776
00:35:15,700 --> 00:35:19,629
systems and start analyzing that and try

777
00:35:17,890 --> 00:35:22,109
to do all addition we need to figure out

778
00:35:19,630 --> 00:35:22,109
what happened

779
00:35:22,290 --> 00:35:26,910
the this is the same attacker - they're

780
00:35:24,390 --> 00:35:31,049
using WMI malware again with JavaScript

781
00:35:26,910 --> 00:35:34,279
afterwards they use a different C - er

782
00:35:31,050 --> 00:35:36,480
or cloud provider for those back doors

783
00:35:34,280 --> 00:35:40,410
this particular version X if you use

784
00:35:36,480 --> 00:35:42,830
with Google Google what makes Google

785
00:35:40,410 --> 00:35:42,830
thanks

786
00:35:51,410 --> 00:35:57,629
so we're tracing this back and we get to

787
00:35:55,500 --> 00:35:59,310
a Citrix server and so which are asking

788
00:35:57,630 --> 00:36:01,200
more questions about wall you know what

789
00:35:59,310 --> 00:36:03,540
is the Citrix server would a few happy

790
00:36:01,200 --> 00:36:05,460
actresses and it turns out that this

791
00:36:03,540 --> 00:36:07,140
Citrix server is only accessible from

792
00:36:05,460 --> 00:36:09,480
the weekend it's not directly accessible

793
00:36:07,140 --> 00:36:11,220
from here it's our first thought is okay

794
00:36:09,480 --> 00:36:13,619
you know must've broke needed Citrix

795
00:36:11,220 --> 00:36:15,029
server in some way the Citrix server

796
00:36:13,619 --> 00:36:16,710
wasn't more than directly accessible

797
00:36:15,030 --> 00:36:18,869
from the internet and when you need

798
00:36:16,710 --> 00:36:21,030
internet works you can't just get direct

799
00:36:18,869 --> 00:36:23,520
network access here you have to do such

800
00:36:21,030 --> 00:36:25,460
as sugar first a new command so we

801
00:36:23,520 --> 00:36:29,130
started pulling on the thread bit more

802
00:36:25,460 --> 00:36:31,440
ask more questions okay well we start

803
00:36:29,130 --> 00:36:34,770
doing reading offices anything we see

804
00:36:31,440 --> 00:36:36,780
logins that are initiating that system

805
00:36:34,770 --> 00:36:41,580
from the deep end so we have the client

806
00:36:36,780 --> 00:36:43,650
folder log driven and we look for the

807
00:36:41,580 --> 00:36:44,400
signs that you would expect to see for

808
00:36:43,650 --> 00:36:48,090
her please

809
00:36:44,400 --> 00:36:51,359
so in a in you can consider if they're

810
00:36:48,090 --> 00:36:53,369
actually tracking some sample logs in a

811
00:36:51,359 --> 00:36:54,569
minute but a few tracks the Epis if

812
00:36:53,369 --> 00:36:56,040
they're coming from and you can change

813
00:36:54,570 --> 00:36:57,900
your idea that's a little attack them as

814
00:36:56,040 --> 00:37:00,150
well and so with hardly what you're

815
00:36:57,900 --> 00:37:01,260
looking for in terms of use of it you're

816
00:37:00,150 --> 00:37:03,030
looking forward to you have to access

817
00:37:01,260 --> 00:37:05,280
interpret so if I steal assessment

818
00:37:03,030 --> 00:37:06,420
written and you have two active ones you

819
00:37:05,280 --> 00:37:08,430
can see it flipping back and forth

820
00:37:06,420 --> 00:37:10,530
between one user

821
00:37:08,430 --> 00:37:12,870
when either another kind of rapid

822
00:37:10,530 --> 00:37:16,070
fashion and so that was the kind of

823
00:37:12,870 --> 00:37:16,069
telltale sign here to Harvard

824
00:37:19,740 --> 00:37:24,799
so again we publish one who viability

825
00:37:21,750 --> 00:37:24,800
phases in that life cycle

826
00:37:26,750 --> 00:37:35,550
this one also use JavaScript backdoors

827
00:37:29,070 --> 00:37:36,060
infinite line so from a detection person

828
00:37:35,550 --> 00:37:38,160
perspective

829
00:37:36,060 --> 00:37:39,869
what to be expected to this two days

830
00:37:38,160 --> 00:37:41,279
actually scope to the leading to

831
00:37:39,869 --> 00:37:43,530
compromise find out what happened with

832
00:37:41,280 --> 00:37:45,180
the new woodcutter we get in and trace

833
00:37:43,530 --> 00:37:47,070
it back from just from this Windows

834
00:37:45,180 --> 00:37:49,230
fatal task chasing all the way back to

835
00:37:47,070 --> 00:37:52,140
these heartbreaking

836
00:37:49,230 --> 00:37:54,240
so this client had yet patched the game

837
00:37:52,140 --> 00:37:57,029
con traders because you know most of the

838
00:37:54,240 --> 00:37:59,700
time the precedent equal-tempered is

839
00:37:57,030 --> 00:38:02,990
focused on fixing systems that were like

840
00:37:59,700 --> 00:38:02,990
websites not

841
00:38:04,930 --> 00:38:09,500
so they were able to deploy a

842
00:38:08,060 --> 00:38:17,869
professional networks or five systems

843
00:38:09,500 --> 00:38:19,130
access additional - so this is headed

844
00:38:17,869 --> 00:38:21,710
some reductive you can come straighter

845
00:38:19,130 --> 00:38:23,150
walks and probably these small projects

846
00:38:21,710 --> 00:38:25,940
but it is in the back you can see it but

847
00:38:23,150 --> 00:38:27,829
what you'll see is if you just look at

848
00:38:25,940 --> 00:38:29,780
the weekend country logs you'll see in

849
00:38:27,829 --> 00:38:31,730
fairly short time here you'll see it

850
00:38:29,780 --> 00:38:35,210
changing from an IP address of one user

851
00:38:31,730 --> 00:38:36,859
key to a different leader and that's

852
00:38:35,210 --> 00:38:38,510
pretty normal when you're next to be ten

853
00:38:36,859 --> 00:38:48,828
if you go from a wired connection to

854
00:38:38,510 --> 00:38:50,240
wireless or removing it's fine to go

855
00:38:48,829 --> 00:38:53,569
teaching if that's normal but what's not

856
00:38:50,240 --> 00:39:07,009
normal is the same session token' being

857
00:38:53,569 --> 00:39:08,720
used to then come from one IP so if you

858
00:39:07,010 --> 00:39:11,089
look the echo of soviet netbook

859
00:39:08,720 --> 00:39:15,250
particular time you're going to see this

860
00:39:11,089 --> 00:39:18,230
attack started to 11:45 and so you see

861
00:39:15,250 --> 00:39:22,760
many many even requests over a four or

862
00:39:18,230 --> 00:39:25,099
three hitting so the text for the to 11

863
00:39:22,760 --> 00:39:31,810
to 15 a week we actually have another

864
00:39:25,099 --> 00:39:35,360
one and that lines up with the evidence

865
00:39:31,810 --> 00:39:39,380
became country to put buffing at 2:15

866
00:39:35,360 --> 00:39:41,420
so we have a three second ID over lot

867
00:39:39,380 --> 00:39:45,070
that are pretty well lining up the

868
00:39:41,420 --> 00:39:45,070
detailing to the attacker what they did

869
00:39:50,870 --> 00:39:56,990
and anything you can do and we can't

870
00:39:54,710 --> 00:39:59,540
prove this but we think it's likely that

871
00:39:56,990 --> 00:40:03,799
occurred is we could prove how they got

872
00:39:59,540 --> 00:40:05,779
into the specifics of themself and our

873
00:40:03,800 --> 00:40:08,150
theory is that they use the heartbleed

874
00:40:05,780 --> 00:40:10,870
exploit so any user that's logging into

875
00:40:08,150 --> 00:40:15,770
the VPN and we typed in your password or

876
00:40:10,870 --> 00:40:17,600
past accommodation it that's gonna be

877
00:40:15,770 --> 00:40:18,770
stored in memory on that web server so

878
00:40:17,600 --> 00:40:19,279
if you're usually heartbleed on that end

879
00:40:18,770 --> 00:40:20,930
system

880
00:40:19,280 --> 00:40:23,200
you're basically pulling random random

881
00:40:20,930 --> 00:40:25,490
chunks of memory from that system and

882
00:40:23,200 --> 00:40:27,859
you may actually get that using the

883
00:40:25,490 --> 00:40:31,520
password in clear text in addition to

884
00:40:27,860 --> 00:40:33,350
the session pivot in issuing that all of

885
00:40:31,520 --> 00:40:35,720
the activity give you over that session

886
00:40:33,350 --> 00:40:38,900
is also gonna be memory on that you can

887
00:40:35,720 --> 00:40:41,779
consider so we think that they've got

888
00:40:38,900 --> 00:40:47,270
credentials from memory of the VPN

889
00:40:41,780 --> 00:40:49,850
concentrator for partly or from the user

890
00:40:47,270 --> 00:40:50,740
Petrina citrix that they pulled that for

891
00:40:49,850 --> 00:40:52,819
memory

892
00:40:50,740 --> 00:40:55,310
one of those teeth because they just

893
00:40:52,820 --> 00:40:57,080
been logged into the Citrix server with

894
00:40:55,310 --> 00:41:00,259
credentials and there's no evidence it's

895
00:40:57,080 --> 00:41:02,870
how they got that and this is the Chi

896
00:41:00,260 --> 00:41:04,580
1500 is really the first time we saw two

897
00:41:02,870 --> 00:41:06,589
kids us there's no other two other

898
00:41:04,580 --> 00:41:08,900
attacks of a malware or anything else it

899
00:41:06,590 --> 00:41:11,200
explain kind of what's he doing how they

900
00:41:08,900 --> 00:41:11,200
got there

901
00:41:16,390 --> 00:41:29,980
so recently and this one this one always

902
00:41:24,700 --> 00:41:32,288
but actually you're not so um we saw

903
00:41:29,980 --> 00:41:40,599
initially we saw we detect this one we

904
00:41:32,289 --> 00:41:43,930
actually saw the attackers were setting

905
00:41:40,599 --> 00:41:45,400
up fishing though so we see a phishing

906
00:41:43,930 --> 00:41:47,440
email being sent and the way to be

907
00:41:45,400 --> 00:41:50,319
detected it was we actually network

908
00:41:47,440 --> 00:41:52,720
things for their backdoor so we fly to a

909
00:41:50,319 --> 00:41:54,940
numbered signature so you know I manage

910
00:41:52,720 --> 00:41:57,640
fencing says hey we found something go

911
00:41:54,940 --> 00:42:01,359
investigate it so anytime you have a

912
00:41:57,640 --> 00:42:03,640
network signature or I didn't want to

913
00:42:01,359 --> 00:42:04,960
answer three questions so what is it

914
00:42:03,640 --> 00:42:07,150
so what's the malware that caused that

915
00:42:04,960 --> 00:42:08,710
that you think we need to get there and

916
00:42:07,150 --> 00:42:10,480
how to get up there and introduce

917
00:42:08,710 --> 00:42:11,739
requesters is really difficult it's a

918
00:42:10,480 --> 00:42:15,940
response to infection if that should

919
00:42:11,739 --> 00:42:18,430
drive your response strategy if I tell

920
00:42:15,940 --> 00:42:21,869
you that assistant got infected today

921
00:42:18,430 --> 00:42:21,868
for a phishing attack and

922
00:42:22,460 --> 00:42:25,760
and that's happening your responses may

923
00:42:24,590 --> 00:42:28,790
be differently you're going to take that

924
00:42:25,760 --> 00:42:30,080
system in your paper long did I tell you

925
00:42:28,790 --> 00:42:31,640
that this system got infected a month

926
00:42:30,080 --> 00:42:32,630
ago collaterally to the doing

927
00:42:31,640 --> 00:42:37,279
administrator come from this other

928
00:42:32,630 --> 00:42:39,410
system how you respond to that the next

929
00:42:37,280 --> 00:42:40,520
activity is very different so this

930
00:42:39,410 --> 00:42:41,240
particular case we're turning it to

931
00:42:40,520 --> 00:42:42,980
those three questions

932
00:42:41,240 --> 00:42:47,330
see you network or I have that kind of

933
00:42:42,980 --> 00:42:48,830
behavior so when when the network Lord

934
00:42:47,330 --> 00:42:50,930
first went off with on a Thursday and

935
00:42:48,830 --> 00:42:52,340
the first thing I did was actually pull

936
00:42:50,930 --> 00:42:54,589
the plug from system so we come in line

937
00:42:52,340 --> 00:42:56,750
so we knew there wasn't at work earlier

938
00:42:54,590 --> 00:43:02,360
if they put locks in place but we can

939
00:42:56,750 --> 00:43:06,880
you know I said so I'm Friday and it's

940
00:43:02,360 --> 00:43:09,110
always on the fryer on Friday that we

941
00:43:06,880 --> 00:43:14,330
have dinner plans with my girlfriend

942
00:43:09,110 --> 00:43:16,580
and we get another look we didn't have a

943
00:43:14,330 --> 00:43:18,890
network and you can find kind of agents

944
00:43:16,580 --> 00:43:22,520
on two of these systems that had the

945
00:43:18,890 --> 00:43:27,040
network and we old friends of data from

946
00:43:22,520 --> 00:43:27,040
them so it's like yeah 7:00 or 7:30

947
00:43:28,210 --> 00:43:34,220
we're only trying full full forensic

948
00:43:30,230 --> 00:43:37,130
data from my girlfriends like David M

949
00:43:34,220 --> 00:43:39,350
equipment me really sad like yeah I just

950
00:43:37,130 --> 00:43:42,500
think it's important that I need to do

951
00:43:39,350 --> 00:43:43,940
real quick so some people plant healthy

952
00:43:42,500 --> 00:43:45,980
we've been kind of analyzing the alerts

953
00:43:43,940 --> 00:43:48,950
from from the day before other things

954
00:43:45,980 --> 00:43:51,350
and there were maybe maybe something

955
00:43:48,950 --> 00:43:53,779
involving they tried to go to the

956
00:43:51,350 --> 00:43:54,470
website for the day before and download

957
00:43:53,780 --> 00:43:56,450
the exploit

958
00:43:54,470 --> 00:43:58,250
they were unable thing would no longer

959
00:43:56,450 --> 00:43:59,509
be conserved and but they had some

960
00:43:58,250 --> 00:44:01,610
suspicions for maybe something going on

961
00:43:59,510 --> 00:44:04,040
so they asked that we could actually

962
00:44:01,610 --> 00:44:06,150
take a look at system and find any

963
00:44:04,040 --> 00:44:10,870
forensic lead

964
00:44:06,150 --> 00:44:14,890
so looking system my girlfriend is

965
00:44:10,870 --> 00:44:16,060
patiently waiting and you know one of

966
00:44:14,890 --> 00:44:17,560
the first things I look for is their

967
00:44:16,060 --> 00:44:19,810
persistence mechanism the usually if you

968
00:44:17,560 --> 00:44:24,549
want an easy job Manoa system you want

969
00:44:19,810 --> 00:44:26,680
to assistance rivalry on this system

970
00:44:24,550 --> 00:44:28,900
there was no consistent things there was

971
00:44:26,680 --> 00:44:30,399
no finer so it my name is actually when

972
00:44:28,900 --> 00:44:33,340
they work started on looking system

973
00:44:30,400 --> 00:44:35,470
there's no binary on disk so in his

974
00:44:33,340 --> 00:44:38,740
particular case the use memory only an

975
00:44:35,470 --> 00:44:39,879
hour they fished three or four hundred

976
00:44:38,740 --> 00:44:42,339
users at a time

977
00:44:39,880 --> 00:44:43,630
and then assuming that they have enough

978
00:44:42,340 --> 00:44:45,630
users they got compromise that they

979
00:44:43,630 --> 00:44:48,430
could use the memory only back to work

980
00:44:45,630 --> 00:44:53,110
than to drop the hitch one second stage

981
00:44:48,430 --> 00:44:55,720
knowledge so it buckles around the

982
00:44:53,110 --> 00:44:57,460
casinos around and I finally see find

983
00:44:55,720 --> 00:45:00,490
Europa streets on the website they went

984
00:44:57,460 --> 00:45:03,130
to I see a JavaScript file and a

985
00:45:00,490 --> 00:45:07,299
chocolate bar I part of those files and

986
00:45:03,130 --> 00:45:12,370
show you in a minute but passed off from

987
00:45:07,300 --> 00:45:15,610
our team and they validate what it was

988
00:45:12,370 --> 00:45:19,450
that was the actual exploit code between

989
00:45:15,610 --> 00:45:21,430
those two models so he thirty or so I

990
00:45:19,450 --> 00:45:25,689
was able to head off we were lonely for

991
00:45:21,430 --> 00:45:28,029
dinner but you know I'm getting like

992
00:45:25,690 --> 00:45:29,830
text messages and phone calls and other

993
00:45:28,030 --> 00:45:31,750
things because you know we didn't our

994
00:45:29,830 --> 00:45:35,170
they actually you know validated it was

995
00:45:31,750 --> 00:45:36,370
everything they had generated proof of

996
00:45:35,170 --> 00:45:37,720
concept code that they wanted to send

997
00:45:36,370 --> 00:45:42,160
Microsoft's we don't have to hide

998
00:45:37,720 --> 00:45:44,230
percent of the real exploit code and so

999
00:45:42,160 --> 00:45:46,720
my girlfriend firstly because on the

1000
00:45:44,230 --> 00:45:48,310
dinner and like I'm on my phone like

1001
00:45:46,720 --> 00:45:50,020
this is kind of a big deal

1002
00:45:48,310 --> 00:45:52,660
and she doesn't

1003
00:45:50,020 --> 00:45:59,170
and kind of explain her of what is

1004
00:45:52,660 --> 00:46:01,930
irritated and obviously so the best part

1005
00:45:59,170 --> 00:46:07,510
is that actually when the advisory

1006
00:46:01,930 --> 00:46:08,680
finally puts out for Microsoft because

1007
00:46:07,510 --> 00:46:11,140
they there's about a week period where

1008
00:46:08,680 --> 00:46:12,910
they didn't have a patch and so her IT

1009
00:46:11,140 --> 00:46:14,319
partner attitude on Tuesday emailed

1010
00:46:12,910 --> 00:46:16,779
everybody said please stop using

1011
00:46:14,320 --> 00:46:18,250
internet explorer and so she invented to

1012
00:46:16,780 --> 00:46:32,410
pull it all over Coker it's like my

1013
00:46:18,250 --> 00:46:33,760
boyfriend's responsible for that I said

1014
00:46:32,410 --> 00:46:35,680
this one we actually thought it in the

1015
00:46:33,760 --> 00:46:38,290
these that foothold facing life's like

1016
00:46:35,680 --> 00:46:40,210
tonight we caught it early we didn't

1017
00:46:38,290 --> 00:46:47,529
actually detective fiction email but we

1018
00:46:40,210 --> 00:46:48,610
detected the network perspective so what

1019
00:46:47,530 --> 00:46:50,290
were some of the friends guard effects

1020
00:46:48,610 --> 00:46:53,350
so you have your own history showing the

1021
00:46:50,290 --> 00:46:55,720
users going to a particular website we

1022
00:46:53,350 --> 00:46:59,020
have this XP deduct some fun that

1023
00:46:55,720 --> 00:47:01,839
particular type file was an Adobe poker

1024
00:46:59,020 --> 00:47:04,509
file and so the vulnerability used to

1025
00:47:01,840 --> 00:47:08,020
return after free and so it needed to go

1026
00:47:04,510 --> 00:47:11,080
to return after free technique and so it

1027
00:47:08,020 --> 00:47:12,970
needed Adobe to actually get loaded and

1028
00:47:11,080 --> 00:47:14,350
so they could guarantee they couldn't

1029
00:47:12,970 --> 00:47:16,149
guarantee the flash was installed and

1030
00:47:14,350 --> 00:47:18,100
what version is result so they stop this

1031
00:47:16,150 --> 00:47:21,640
helper cloud and use that to get their

1032
00:47:18,100 --> 00:47:24,779
exploits early you see the javascript

1033
00:47:21,640 --> 00:47:24,779
file and chocolate cloud

1034
00:47:25,850 --> 00:47:30,060
that was it in terms of printed

1035
00:47:27,780 --> 00:47:31,440
artifacts like that was that was all it

1036
00:47:30,060 --> 00:47:33,150
was there and then if you memory

1037
00:47:31,440 --> 00:47:34,830
analysis there were two I explore

1038
00:47:33,150 --> 00:47:38,010
prophecies that were started at that

1039
00:47:34,830 --> 00:47:39,569
exact same time as this extra beauty so

1040
00:47:38,010 --> 00:47:42,450
this is kind of snippet up from the

1041
00:47:39,570 --> 00:47:45,570
exploit code it's just looking for what

1042
00:47:42,450 --> 00:47:47,730
what version of ie running comes wrong

1043
00:47:45,570 --> 00:47:50,520
but that's what within the inside that's

1044
00:47:47,730 --> 00:47:51,750
a yes so when I grabbed that I think I

1045
00:47:50,520 --> 00:47:54,570
didn't know what it was at the time but

1046
00:47:51,750 --> 00:47:56,750
when I looked at it you could tell the

1047
00:47:54,570 --> 00:47:56,750
time

1048
00:48:01,590 --> 00:48:06,780
so the email this is an example at one

1049
00:48:04,770 --> 00:48:09,420
of you most of the sunset over the

1050
00:48:06,780 --> 00:48:11,130
course of a week period from from one

1051
00:48:09,420 --> 00:48:14,400
day when it's happened between the

1052
00:48:11,130 --> 00:48:17,280
factors at least we had 14 clients that

1053
00:48:14,400 --> 00:48:18,540
were work for fish we had four rounds of

1054
00:48:17,280 --> 00:48:20,070
fishing boats coming in from different

1055
00:48:18,540 --> 00:48:21,990
unique sites all with different any

1056
00:48:20,070 --> 00:48:24,210
points this is an example of one of them

1057
00:48:21,990 --> 00:48:26,910
they weren't particularly targeted or

1058
00:48:24,210 --> 00:48:29,160
you know savvy but you develop it

1059
00:48:26,910 --> 00:48:32,279
families and when you send it to know

1060
00:48:29,160 --> 00:48:36,049
when you send it to a large number of

1061
00:48:32,280 --> 00:48:36,050
people you're gonna get enough people on

1062
00:48:37,340 --> 00:48:41,700
the eastern point about in this

1063
00:48:40,170 --> 00:48:44,100
particular case for the fourteen claim

1064
00:48:41,700 --> 00:48:46,200
being compromised it made a really busy

1065
00:48:44,100 --> 00:48:48,750
deeper but the once we found the initial

1066
00:48:46,200 --> 00:48:50,879
piece we then develop some really good

1067
00:48:48,750 --> 00:48:52,920
Network signatures for natural use of

1068
00:48:50,880 --> 00:48:54,960
the zero day so once we found it the

1069
00:48:52,920 --> 00:48:56,190
first time we then create very taking

1070
00:48:54,960 --> 00:48:58,680
food court so that every time after that

1071
00:48:56,190 --> 00:49:00,450
we then identify too quickly Thomas et

1072
00:48:58,680 --> 00:49:03,089
you work with a client until of our

1073
00:49:00,450 --> 00:49:05,040
portrait planks the hunters didn't get

1074
00:49:03,090 --> 00:49:07,490
established in any of them

1075
00:49:05,040 --> 00:49:07,490
initial

1076
00:49:14,840 --> 00:49:18,050
so hundred infected systems over the

1077
00:49:16,850 --> 00:49:20,299
course of the week

1078
00:49:18,050 --> 00:49:22,310
but the attacker in one case they

1079
00:49:20,300 --> 00:49:23,540
download the second states backdoor and

1080
00:49:22,310 --> 00:49:26,509
we got a consistent pull-up and I work

1081
00:49:23,540 --> 00:49:27,980
within a couple of hours and so they the

1082
00:49:26,510 --> 00:49:29,930
other pieces they were targeted so many

1083
00:49:27,980 --> 00:49:31,220
different companies hundreds of hundreds

1084
00:49:29,930 --> 00:49:33,319
of companies to be parted with a

1085
00:49:31,220 --> 00:49:34,640
particular group of the groups that we

1086
00:49:33,320 --> 00:49:36,500
track this is probably one of the most

1087
00:49:34,640 --> 00:49:38,750
anticipated and they're probably one of

1088
00:49:36,500 --> 00:49:40,460
the best I've personally many them to

1089
00:49:38,750 --> 00:49:44,320
group recalling III I probably

1090
00:49:40,460 --> 00:49:44,320
investigate them about six thirty times

1091
00:49:47,230 --> 00:49:52,850
so of the of our four cases we have

1092
00:49:51,440 --> 00:49:57,110
three different unique exact resistors

1093
00:49:52,850 --> 00:49:58,670
the third unique attacker so we kind of

1094
00:49:57,110 --> 00:50:00,560
go back to our premise of detection

1095
00:49:58,670 --> 00:50:01,940
really hard you know they can come a

1096
00:50:00,560 --> 00:50:04,009
tree in all different ways they can use

1097
00:50:01,940 --> 00:50:06,020
techniques you've never even heard of

1098
00:50:04,010 --> 00:50:07,250
before or connections to your networking

1099
00:50:06,020 --> 00:50:09,350
you don't know about those it may not be

1100
00:50:07,250 --> 00:50:11,540
monitored you can't always assume that

1101
00:50:09,350 --> 00:50:13,610
it's going to be you know through the

1102
00:50:11,540 --> 00:50:15,680
same I've ever seen that many times

1103
00:50:13,610 --> 00:50:17,570
so if journey to a 90 days peace in our

1104
00:50:15,680 --> 00:50:18,740
caseload so how can we actually is an

1105
00:50:17,570 --> 00:50:21,470
industry how can we get this number in

1106
00:50:18,740 --> 00:50:24,950
the work so I have a couple of ideas

1107
00:50:21,470 --> 00:50:27,109
here you know some of them of which

1108
00:50:24,950 --> 00:50:29,120
we've already implemented I mean your

1109
00:50:27,110 --> 00:50:30,800
environment but you know if you look

1110
00:50:29,120 --> 00:50:33,080
it's a lot of movie face how do you set

1111
00:50:30,800 --> 00:50:34,630
that well you could look for remotely

1112
00:50:33,080 --> 00:50:37,430
under file of speech across the network

1113
00:50:34,630 --> 00:50:40,400
so you know there's a couple different

1114
00:50:37,430 --> 00:50:41,450
ways you can do that you look for

1115
00:50:40,400 --> 00:50:42,740
evidence of tested them so you're

1116
00:50:41,450 --> 00:50:45,799
transferring that detacher-- touches

1117
00:50:42,740 --> 00:50:48,799
through advice you could look for misuse

1118
00:50:45,800 --> 00:50:50,690
of tillage accounts in your network so

1119
00:50:48,800 --> 00:50:53,660
different organizations track some

1120
00:50:50,690 --> 00:50:55,310
sibling so say you take your each make

1121
00:50:53,660 --> 00:50:57,830
all your domains prologue to centralize

1122
00:50:55,310 --> 00:50:58,790
them and enable Intel and debugging so

1123
00:50:57,830 --> 00:51:01,490
you can actually the source and

1124
00:50:58,790 --> 00:51:03,560
destination of that account or that

1125
00:51:01,490 --> 00:51:05,120
login you can now come up with

1126
00:51:03,560 --> 00:51:07,549
potentially for all your current

1127
00:51:05,120 --> 00:51:08,769
accounts a profile of where they log in

1128
00:51:07,550 --> 00:51:11,749
to you and what

1129
00:51:08,769 --> 00:51:14,269
that we're sending your your adjutant

1130
00:51:11,749 --> 00:51:17,509
patient experience where you logged into

1131
00:51:14,269 --> 00:51:19,459
income to evaluate this I know other

1132
00:51:17,509 --> 00:51:22,339
word positions they do things like well

1133
00:51:19,459 --> 00:51:24,109
set up a jump server farm and so if you

1134
00:51:22,339 --> 00:51:26,269
donate attempt servers from the two

1135
00:51:24,109 --> 00:51:28,369
factor authentication and then my policy

1136
00:51:26,269 --> 00:51:30,709
not actually prevent you from doing this

1137
00:51:28,369 --> 00:51:32,749
but you have to order P from the system

1138
00:51:30,709 --> 00:51:34,519
in that that jumped over first so if you

1139
00:51:32,749 --> 00:51:36,198
just monitor all your servers looking

1140
00:51:34,519 --> 00:51:38,029
for a logging that's not originate from

1141
00:51:36,199 --> 00:51:39,829
the juncture of a pump that'll be an

1142
00:51:38,029 --> 00:51:44,179
immediate generic indicated something

1143
00:51:39,829 --> 00:51:46,309
that is having internal real-time book

1144
00:51:44,179 --> 00:51:49,640
reports pain learning tools like sequel

1145
00:51:46,309 --> 00:51:52,009
map you have to look for that internally

1146
00:51:49,640 --> 00:51:53,390
this actually maliciously from

1147
00:51:52,009 --> 00:51:57,529
completing admission you look for a

1148
00:51:53,390 --> 00:52:01,400
creation every factor loves of our use

1149
00:51:57,529 --> 00:52:02,900
of when you are looking for the header

1150
00:52:01,400 --> 00:52:05,089
in crypto are probably internships

1151
00:52:02,900 --> 00:52:07,459
through prudent is a toxic network or or

1152
00:52:05,089 --> 00:52:09,288
out-of-network because the poor NetFlow

1153
00:52:07,459 --> 00:52:13,308
logs with the large I'm I'm talking

1154
00:52:09,289 --> 00:52:16,789
first and then if I want to leave it

1155
00:52:13,309 --> 00:52:18,739
with any sound it's gonna put your

1156
00:52:16,789 --> 00:52:21,140
leading here what can you you in your

1157
00:52:18,739 --> 00:52:22,759
environment that generic appointments

1158
00:52:21,140 --> 00:52:24,618
don't you think about that and think

1159
00:52:22,759 --> 00:52:26,269
about you know some of these tactics and

1160
00:52:24,619 --> 00:52:27,409
these techniques and then you know your

1161
00:52:26,269 --> 00:52:29,629
you know your mark way there's an

1162
00:52:27,409 --> 00:52:30,769
attackers water so what can you do that

1163
00:52:29,630 --> 00:52:33,519
would actually make it more successful

1164
00:52:30,769 --> 00:52:33,519
technique

1165
00:52:37,250 --> 00:52:42,550
that's all I have for today we have ten

1166
00:52:40,160 --> 00:52:42,549
minutes per question

1167
00:52:51,200 --> 00:52:57,250
you know first example why was he

1168
00:52:54,860 --> 00:52:57,250
fighting me

1169
00:52:59,119 --> 00:53:06,829
they were instantiating I explore and I

1170
00:53:03,829 --> 00:53:09,589
exported new academic subjects that

1171
00:53:06,829 --> 00:53:11,059
insane to explore if you look at Devon

1172
00:53:09,589 --> 00:53:15,849
first law - except when he feels about

1173
00:53:11,059 --> 00:53:18,799
it on his blog death occurs blog post

1174
00:53:15,849 --> 00:53:22,220
but because of this is essentially an

1175
00:53:18,799 --> 00:53:23,989
actual web browser it's the operating

1176
00:53:22,220 --> 00:53:26,930
system of doing confirming Newton's

1177
00:53:23,989 --> 00:53:33,559
- website he painted and so it was

1178
00:53:26,930 --> 00:53:36,279
fashioned each time to pull down a man

1179
00:53:33,559 --> 00:53:36,279
it was

1180
00:53:40,240 --> 00:53:44,830
so for me gives your already standpoint

1181
00:53:42,580 --> 00:53:49,840
I'm going back to this fishing

1182
00:53:44,830 --> 00:53:52,330
expedition 28 days to come to life

1183
00:53:49,840 --> 00:53:55,540
you're saying in

1184
00:53:52,330 --> 00:53:57,880
zatia environment users who see the

1185
00:53:55,540 --> 00:54:00,310
spreadsheet that did not give them the

1186
00:53:57,880 --> 00:54:04,450
expected result they were stated female

1187
00:54:00,310 --> 00:54:09,040
and nobody says one so we finished

1188
00:54:04,450 --> 00:54:10,330
ripped off yourself attention with all

1189
00:54:09,040 --> 00:54:12,610
the content in these all attachment

1190
00:54:10,330 --> 00:54:14,290
pretty depending xlx and for either the

1191
00:54:12,610 --> 00:54:15,760
competitive the connector in it so when

1192
00:54:14,290 --> 00:54:17,440
they sent it it wouldn't even when

1193
00:54:15,760 --> 00:54:19,870
needed over did a had with real content

1194
00:54:17,440 --> 00:54:25,140
so they actually were expecting what was

1195
00:54:19,870 --> 00:54:27,400
in it it was a different but it wasn't

1196
00:54:25,140 --> 00:54:31,720
it wasn't unexpected you know we've

1197
00:54:27,400 --> 00:54:33,250
we've ended up commuters and it was that

1198
00:54:31,720 --> 00:54:35,799
such a big thing that's gonna find

1199
00:54:33,250 --> 00:54:39,790
greater thirteen if you look at the diet

1200
00:54:35,800 --> 00:54:42,670
be what's a lot more prevalent are the

1201
00:54:39,790 --> 00:54:44,200
cases like the eyes area where they're

1202
00:54:42,670 --> 00:54:46,060
going to set out kind of a more for more

1203
00:54:44,200 --> 00:54:48,339
generic message but we see everything

1204
00:54:46,060 --> 00:54:49,509
from like really generic to that's what

1205
00:54:48,340 --> 00:54:53,580
one of the examples up from the most

1206
00:54:49,510 --> 00:54:53,580
targeted phishing attacks

1207
00:55:05,610 --> 00:55:08,610
the

1208
00:55:12,890 --> 00:55:21,900
sure so the environment so my tools

1209
00:55:16,650 --> 00:55:23,820
perspective maybe we break supper so if

1210
00:55:21,900 --> 00:55:26,130
we use a tool called mandated for the

1211
00:55:23,820 --> 00:55:27,930
pelt response and so if even for the

1212
00:55:26,130 --> 00:55:30,660
plate agent every single system it's a

1213
00:55:27,930 --> 00:55:32,850
big occasion target then I can then run

1214
00:55:30,660 --> 00:55:34,740
run things and hold forensic Gator and

1215
00:55:32,850 --> 00:55:36,330
coastal February we the assumption is

1216
00:55:34,740 --> 00:55:37,470
pushing out the first time that I'm

1217
00:55:36,330 --> 00:55:39,569
worried about copying over additional

1218
00:55:37,470 --> 00:55:41,700
tools and then the output from it gets

1219
00:55:39,570 --> 00:55:43,560
treated back to a central location so

1220
00:55:41,700 --> 00:55:46,100
that the output results our contacts

1221
00:55:43,560 --> 00:55:46,100
name system

1222
00:55:52,910 --> 00:55:59,839
did you ever make up those dinner plans

1223
00:55:56,120 --> 00:56:13,069
with your boss later after rooting for

1224
00:55:59,840 --> 00:56:14,780
me when it's great when she saw the like

1225
00:56:13,070 --> 00:56:15,950
kind of the importance of it in terms of

1226
00:56:14,780 --> 00:56:22,640
like what it mentioned a good publicity

1227
00:56:15,950 --> 00:56:24,910
about it and in every requests and large

1228
00:56:22,640 --> 00:56:24,910
scale

1229
00:56:28,240 --> 00:56:35,029
help me a little bit they're ruining our

1230
00:56:31,460 --> 00:56:38,450
dinner plans but you know when we do is

1231
00:56:35,030 --> 00:56:40,610
it response this is a business of life

1232
00:56:38,450 --> 00:56:42,560
this is what happened apparently you get

1233
00:56:40,610 --> 00:56:44,090
called randomly had a Friday night and

1234
00:56:42,560 --> 00:56:46,880
of course it's always on a Friday night

1235
00:56:44,090 --> 00:56:48,770
and you reach everyone or you have to

1236
00:56:46,880 --> 00:56:50,960
work really long hours that's just kind

1237
00:56:48,770 --> 00:56:52,580
of what goes in there true some of my

1238
00:56:50,960 --> 00:56:56,570
favorite Annunciation - actually sir -

1239
00:56:52,580 --> 00:56:59,360
that's like a lot of our investigations

1240
00:56:56,570 --> 00:57:00,830
are really really old like they broke in

1241
00:56:59,360 --> 00:57:02,890
two years ago you might have tons of

1242
00:57:00,830 --> 00:57:05,060
data that's an error you recovered and

1243
00:57:02,890 --> 00:57:06,200
reconstructed be really hard and you get

1244
00:57:05,060 --> 00:57:08,270
there the attackers create you know

1245
00:57:06,200 --> 00:57:09,740
that's a piece of cake like there's so

1246
00:57:08,270 --> 00:57:11,240
many like there's so much data to work

1247
00:57:09,740 --> 00:57:13,009
with and pull it back I mean I'm used to

1248
00:57:11,240 --> 00:57:14,299
do in cases where like you're like

1249
00:57:13,010 --> 00:57:17,000
pulling it like spreads to like

1250
00:57:14,300 --> 00:57:24,490
hopefully put together a story like what

1251
00:57:17,000 --> 00:57:24,490
we have asking any other questions

1252
00:57:35,450 --> 00:57:42,810
all right now we have a half an hour

1253
00:57:39,000 --> 00:57:45,390
networking break there's breakfasts if

1254
00:57:42,810 --> 00:57:48,210
they're already with being an awesome

1255
00:57:45,390 --> 00:57:50,160
babe oh oh babe oh very cool

1256
00:57:48,210 --> 00:58:00,480
the next weekend takes you ten thirty

1257
00:57:50,160 --> 00:58:04,339
and no Gamecock wanted to there so it's

1258
00:58:00,480 --> 00:58:04,340
like right now it starts at ten

