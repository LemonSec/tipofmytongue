1
00:00:00,659 --> 00:00:02,960
foreign

2
00:00:05,640 --> 00:00:09,059
good afternoon everyone and uh

3
00:00:09,059 --> 00:00:10,559
good evening if you're in the

4
00:00:10,559 --> 00:00:13,139
Netherlands where I'm from Hello uh

5
00:00:13,139 --> 00:00:15,420
thank you all for being here I'm excited

6
00:00:15,420 --> 00:00:18,600
to get this talk going I realize it

7
00:00:18,600 --> 00:00:21,000
might be a bit of a niche subject so

8
00:00:21,000 --> 00:00:22,619
we'll start off a little bit different

9
00:00:22,619 --> 00:00:25,619
with some trivia questions to see how

10
00:00:25,619 --> 00:00:27,599
much you know about Google workspace or

11
00:00:27,599 --> 00:00:28,980
if you even know what Google workspace

12
00:00:28,980 --> 00:00:30,240
is

13
00:00:30,240 --> 00:00:32,579
so the first thing is did you know that

14
00:00:32,579 --> 00:00:33,960
Google workspace is not the same as

15
00:00:33,960 --> 00:00:36,120
Google Cloud it's two different things

16
00:00:36,120 --> 00:00:38,399
Google workspace is basically the SAS

17
00:00:38,399 --> 00:00:40,340
offering of Google Cloud

18
00:00:40,340 --> 00:00:42,899
it's a suite of productivity tools it's

19
00:00:42,899 --> 00:00:45,840
basically like Microsoft 365 and Google

20
00:00:45,840 --> 00:00:49,140
cloud is more like Azure so that's how

21
00:00:49,140 --> 00:00:50,280
you should look at it

22
00:00:50,280 --> 00:00:51,899
from a security perspective there's

23
00:00:51,899 --> 00:00:53,520
actually some really interesting things

24
00:00:53,520 --> 00:00:56,280
going on within Google workspace

25
00:00:56,280 --> 00:00:58,260
um out of the book there's almost

26
00:00:58,260 --> 00:01:01,260
time I counted 50 security rules that

27
00:01:01,260 --> 00:01:02,280
you can

28
00:01:02,280 --> 00:01:04,799
use to that are actually used to trigger

29
00:01:04,799 --> 00:01:07,439
alerts and notifications about weird

30
00:01:07,439 --> 00:01:08,939
stuff going on

31
00:01:08,939 --> 00:01:11,159
but did you also know that most of this

32
00:01:11,159 --> 00:01:13,619
security alerts do not generate an alert

33
00:01:13,619 --> 00:01:15,659
even though they're really good so what

34
00:01:15,659 --> 00:01:18,600
you can do is actually you can reroute

35
00:01:18,600 --> 00:01:20,700
all your email your domain to a whole

36
00:01:20,700 --> 00:01:22,799
different domain and won't trigger an

37
00:01:22,799 --> 00:01:25,560
alert or you could simply make a user a

38
00:01:25,560 --> 00:01:27,900
super admin and won't trigger an alert

39
00:01:27,900 --> 00:01:30,299
the alerts are there but you have to

40
00:01:30,299 --> 00:01:33,299
enable notification Etc

41
00:01:33,299 --> 00:01:36,360
from an incident response and analyst

42
00:01:36,360 --> 00:01:38,579
perspective there's something very nice

43
00:01:38,579 --> 00:01:40,140
about Google workspace that you probably

44
00:01:40,140 --> 00:01:42,479
heard yesterday in the Keynote you

45
00:01:42,479 --> 00:01:43,860
cannot disable all that logging in

46
00:01:43,860 --> 00:01:46,380
Google workspace it's there for you so

47
00:01:46,380 --> 00:01:48,600
if you do IR as a consultant you can

48
00:01:48,600 --> 00:01:50,759
just get into an environment and be like

49
00:01:50,759 --> 00:01:53,040
can I have to go the audit log and it

50
00:01:53,040 --> 00:01:55,740
won't be the story about Microsoft ready

51
00:01:55,740 --> 00:01:58,560
like ah it wasn't enabled at the time so

52
00:01:58,560 --> 00:02:00,960
you kind of stuck with that so that's

53
00:02:00,960 --> 00:02:02,399
great that was Google workspace

54
00:02:02,399 --> 00:02:04,820
introduction a little bit about myself

55
00:02:04,820 --> 00:02:07,619
uh so my name is Christian Stone I'm

56
00:02:07,619 --> 00:02:09,119
from the Netherlands as you may already

57
00:02:09,119 --> 00:02:11,220
heard or not

58
00:02:11,220 --> 00:02:13,379
um I started my career at nordway which

59
00:02:13,379 --> 00:02:15,720
is a cyber security firm and then moved

60
00:02:15,720 --> 00:02:17,580
to PWC did a lot of instant response

61
00:02:17,580 --> 00:02:19,860
there I was lucky enough to lead an IR

62
00:02:19,860 --> 00:02:22,860
team there which was great but at some

63
00:02:22,860 --> 00:02:25,200
point I thought maybe I can do things a

64
00:02:25,200 --> 00:02:26,520
little bit different or maybe even

65
00:02:26,520 --> 00:02:28,620
better so then I started my own company

66
00:02:28,620 --> 00:02:31,200
and it's called Invictus you might have

67
00:02:31,200 --> 00:02:32,819
seen it because it's on every slide it's

68
00:02:32,819 --> 00:02:36,060
on my shirt it's everywhere so that's my

69
00:02:36,060 --> 00:02:37,140
company

70
00:02:37,140 --> 00:02:40,260
I also really enjoy teaching

71
00:02:40,260 --> 00:02:42,540
um and that's why I started teaching at

72
00:02:42,540 --> 00:02:44,220
the University of applied sciences in

73
00:02:44,220 --> 00:02:47,099
Amsterdam it's like a part-time job and

74
00:02:47,099 --> 00:02:49,440
then I got the opportunity to work with

75
00:02:49,440 --> 00:02:51,660
Sense on the cloud instant response

76
00:02:51,660 --> 00:02:53,459
course so if you're doing five or nine

77
00:02:53,459 --> 00:02:56,220
this week you might be seeing a lot more

78
00:02:56,220 --> 00:02:57,360
of me

79
00:02:57,360 --> 00:03:00,300
um so good luck and yeah this was enough

80
00:03:00,300 --> 00:03:02,700
about me let's talk about the actual

81
00:03:02,700 --> 00:03:04,680
research why I'm here and why we're

82
00:03:04,680 --> 00:03:06,180
discussing this topic

83
00:03:06,180 --> 00:03:09,060
so I mentioned I started at um I did a

84
00:03:09,060 --> 00:03:11,459
lot of instant response at PWC and I

85
00:03:11,459 --> 00:03:13,140
think because we were in accounting firm

86
00:03:13,140 --> 00:03:15,319
we saw a lot of financial related

87
00:03:15,319 --> 00:03:17,940
incidents and that's mostly business

88
00:03:17,940 --> 00:03:19,980
email compromises so people getting into

89
00:03:19,980 --> 00:03:22,379
an email environment doing all kinds of

90
00:03:22,379 --> 00:03:24,599
shady stuff and then trying to get money

91
00:03:24,599 --> 00:03:26,940
out of it so I don't know changing

92
00:03:26,940 --> 00:03:30,180
invoices doing internal phishing Etc but

93
00:03:30,180 --> 00:03:32,819
the ultimate goal was getting monetary

94
00:03:32,819 --> 00:03:34,440
value out of your

95
00:03:34,440 --> 00:03:36,900
attack so to say

96
00:03:36,900 --> 00:03:39,060
um which is really cool for us and the

97
00:03:39,060 --> 00:03:40,620
whole team at BWC and we created a lot

98
00:03:40,620 --> 00:03:42,480
of Open Source projects which are

99
00:03:42,480 --> 00:03:44,760
actually still around and super popular

100
00:03:44,760 --> 00:03:47,580
uh so if you've ever do something with

101
00:03:47,580 --> 00:03:49,680
Microsoft 365

102
00:03:49,680 --> 00:03:51,599
um please check out the Microsoft 365

103
00:03:51,599 --> 00:03:53,400
extractor it's basically gets all the

104
00:03:53,400 --> 00:03:55,319
logs and if you have Splunk if you can

105
00:03:55,319 --> 00:03:58,739
afford it I also created an app and it

106
00:03:58,739 --> 00:04:00,299
will automatically analyze all the data

107
00:04:00,299 --> 00:04:02,280
and together with the team we created

108
00:04:02,280 --> 00:04:04,920
the BEC guide which is actually

109
00:04:04,920 --> 00:04:06,540
that's something I'm really proud of

110
00:04:06,540 --> 00:04:07,680
everyone that worked in it by the way

111
00:04:07,680 --> 00:04:10,560
not just me because it's really good and

112
00:04:10,560 --> 00:04:12,299
it helped a lot of

113
00:04:12,299 --> 00:04:13,980
other instance responders around the

114
00:04:13,980 --> 00:04:15,540
world responding to business email

115
00:04:15,540 --> 00:04:17,279
compromises

116
00:04:17,279 --> 00:04:18,779
oh this is all fine but there's nothing

117
00:04:18,779 --> 00:04:20,820
to do with Google workspace uh the thing

118
00:04:20,820 --> 00:04:22,800
is Google workspace is like the unknown

119
00:04:22,800 --> 00:04:24,600
thingy there was not a lot of data

120
00:04:24,600 --> 00:04:26,280
available in Google workspace who was

121
00:04:26,280 --> 00:04:28,440
using it there was no research on

122
00:04:28,440 --> 00:04:32,340
forensics nothing so I was like ah maybe

123
00:04:32,340 --> 00:04:34,259
um I should write a little two or

124
00:04:34,259 --> 00:04:36,360
something to get some to acquire for

125
00:04:36,360 --> 00:04:37,860
instance all the audit logging which is

126
00:04:37,860 --> 00:04:39,479
a nice start for your investigation of

127
00:04:39,479 --> 00:04:41,160
course

128
00:04:41,160 --> 00:04:43,320
um that was our original ID

129
00:04:43,320 --> 00:04:45,840
and um I also work at the University of

130
00:04:45,840 --> 00:04:47,160
Amsterdam and they're like do you have

131
00:04:47,160 --> 00:04:51,180
some research IDs and yeah I did I was

132
00:04:51,180 --> 00:04:52,380
like ah maybe we can do something with

133
00:04:52,380 --> 00:04:55,380
Google workspace so but these students

134
00:04:55,380 --> 00:04:56,880
need to uh prove that they're really

135
00:04:56,880 --> 00:04:58,919
smart of course and need to prove a lot

136
00:04:58,919 --> 00:05:00,660
of points so they were like ah can we

137
00:05:00,660 --> 00:05:03,000
take it one step further and this is

138
00:05:03,000 --> 00:05:04,500
sort of like the Holy Grail of I guess

139
00:05:04,500 --> 00:05:06,840
doing instant responses can we maybe

140
00:05:06,840 --> 00:05:09,780
automate analysis as well so we acquire

141
00:05:09,780 --> 00:05:11,520
data and we also analyze it

142
00:05:11,520 --> 00:05:13,620
automatically which is very dangerous I

143
00:05:13,620 --> 00:05:15,780
know but we try to do it

144
00:05:15,780 --> 00:05:18,720
um the reason is like analyst time and

145
00:05:18,720 --> 00:05:20,580
instant respondus time is very valuable

146
00:05:20,580 --> 00:05:23,340
and when you do instant response

147
00:05:23,340 --> 00:05:25,440
um you need to get a lot of answers very

148
00:05:25,440 --> 00:05:27,419
quick if you're in a case and there's a

149
00:05:27,419 --> 00:05:29,639
lot of pressure so what can we do to

150
00:05:29,639 --> 00:05:31,500
basically bring the analyst time down

151
00:05:31,500 --> 00:05:34,139
that was the original ID so I worked

152
00:05:34,139 --> 00:05:36,720
together with two very smart guys and I

153
00:05:36,720 --> 00:05:38,220
want to give a proper shout out to them

154
00:05:38,220 --> 00:05:40,560
betchaun on the left and Greg on the

155
00:05:40,560 --> 00:05:42,180
right they would love to get some

156
00:05:42,180 --> 00:05:43,979
followers or connection requests after

157
00:05:43,979 --> 00:05:46,860
this uh talk so feel free to stalk them

158
00:05:46,860 --> 00:05:48,960
at the really nice guys and they helped

159
00:05:48,960 --> 00:05:51,120
a lot with this research and honestly

160
00:05:51,120 --> 00:05:53,340
without them I probably wouldn't be here

161
00:05:53,340 --> 00:05:55,979
with this talk so that's the background

162
00:05:55,979 --> 00:05:57,479
so basically

163
00:05:57,479 --> 00:05:59,400
what can we do on the Google workspace

164
00:05:59,400 --> 00:06:02,280
and in terms of acquisition and also

165
00:06:02,280 --> 00:06:04,919
automatic analysis

166
00:06:04,919 --> 00:06:07,259
Google workspace I won't try to repeat

167
00:06:07,259 --> 00:06:08,699
too much what the keynote was yesterday

168
00:06:08,699 --> 00:06:11,220
so I only have a few slides on Google

169
00:06:11,220 --> 00:06:14,280
workspace what it is and I guess the

170
00:06:14,280 --> 00:06:16,800
forensic side of it

171
00:06:16,800 --> 00:06:18,660
so as I mentioned is the commercial

172
00:06:18,660 --> 00:06:21,300
Suite of products from Google so you

173
00:06:21,300 --> 00:06:23,759
basically have Gmail meet calendar drive

174
00:06:23,759 --> 00:06:26,340
but it's all like officially supported

175
00:06:26,340 --> 00:06:29,460
you have more storage space etc etc and

176
00:06:29,460 --> 00:06:30,900
if you have the right licenses you can

177
00:06:30,900 --> 00:06:32,699
get a lot of security features as well

178
00:06:32,699 --> 00:06:34,740
so that's what Google workspace is

179
00:06:34,740 --> 00:06:37,800
there's no real recent data but

180
00:06:37,800 --> 00:06:38,400
um

181
00:06:38,400 --> 00:06:40,380
from what I've seen which is anecdotal

182
00:06:40,380 --> 00:06:41,220
evidence

183
00:06:41,220 --> 00:06:43,740
it's getting pretty popular of course

184
00:06:43,740 --> 00:06:45,660
Microsoft 365 is by far the market

185
00:06:45,660 --> 00:06:48,060
leader but after that I suspect Google

186
00:06:48,060 --> 00:06:49,680
workspace is the number two but I don't

187
00:06:49,680 --> 00:06:51,060
have that data because they don't

188
00:06:51,060 --> 00:06:53,340
publish it

189
00:06:53,340 --> 00:06:55,139
in Google workspace

190
00:06:55,139 --> 00:06:56,759
um it's a SAS offering and as we've

191
00:06:56,759 --> 00:06:58,319
learned yesterday in the keynote as well

192
00:06:58,319 --> 00:07:00,180
if you have a sar Solution that's in the

193
00:07:00,180 --> 00:07:02,759
cloud you basically rely on the cloud

194
00:07:02,759 --> 00:07:05,520
provider to give you data

195
00:07:05,520 --> 00:07:07,620
um and Google does that they have audit

196
00:07:07,620 --> 00:07:10,319
logging available and audit logging is

197
00:07:10,319 --> 00:07:13,199
separated into several What I Call Log

198
00:07:13,199 --> 00:07:15,780
types so there's five main categories

199
00:07:15,780 --> 00:07:19,080
such as admin group login o or SML

200
00:07:19,080 --> 00:07:21,300
there's like the main categories of logs

201
00:07:21,300 --> 00:07:23,819
and then there's server-specific events

202
00:07:23,819 --> 00:07:26,460
so let's say you use the calendar to

203
00:07:26,460 --> 00:07:29,099
make an appointment and someone accepts

204
00:07:29,099 --> 00:07:31,380
that meeting that will be locked if you

205
00:07:31,380 --> 00:07:33,599
have Google Drive and you change the

206
00:07:33,599 --> 00:07:36,419
sharing settings or you send out an

207
00:07:36,419 --> 00:07:39,960
external invite everything gets logged

208
00:07:39,960 --> 00:07:40,620
um

209
00:07:40,620 --> 00:07:42,180
it shouldn't come as a surprise but

210
00:07:42,180 --> 00:07:44,280
Google is really good at logging and

211
00:07:44,280 --> 00:07:46,440
they know so much so if you ever look at

212
00:07:46,440 --> 00:07:48,419
these logs you'll be surprised at the

213
00:07:48,419 --> 00:07:49,800
level of detail that's available in

214
00:07:49,800 --> 00:07:52,380
these logs the good news is the

215
00:07:52,380 --> 00:07:54,960
retention is six months at least so what

216
00:07:54,960 --> 00:07:57,120
you can do which is a nice trick if you

217
00:07:57,120 --> 00:07:59,639
also use Google Cloud you can forward a

218
00:07:59,639 --> 00:08:01,020
log from Google workspace to Google

219
00:08:01,020 --> 00:08:02,940
Cloud then you can configure the

220
00:08:02,940 --> 00:08:06,240
retention period to go much longer which

221
00:08:06,240 --> 00:08:07,560
is pretty nice with six months is

222
00:08:07,560 --> 00:08:08,940
already really good I mean if you

223
00:08:08,940 --> 00:08:09,780
haven't

224
00:08:09,780 --> 00:08:12,720
I think I've most of the instance I did

225
00:08:12,720 --> 00:08:15,060
were I think after six months they sort

226
00:08:15,060 --> 00:08:17,099
of realized there was an incident so

227
00:08:17,099 --> 00:08:20,539
yeah six months is pretty okay

228
00:08:21,539 --> 00:08:23,039
so this is the thing I mentioned in

229
00:08:23,039 --> 00:08:25,440
Google workspace the admin Center you

230
00:08:25,440 --> 00:08:28,080
can simply say oh please send all my

231
00:08:28,080 --> 00:08:30,720
logs also to Google Cloud which is if

232
00:08:30,720 --> 00:08:33,599
you have both Google workspace and

233
00:08:33,599 --> 00:08:35,820
Google Cloud I think it's it's pretty

234
00:08:35,820 --> 00:08:36,839
good one I don't think it's very

235
00:08:36,839 --> 00:08:38,700
expensive either so you should probably

236
00:08:38,700 --> 00:08:40,260
do that

237
00:08:40,260 --> 00:08:42,059
if you want to take a look at the logs

238
00:08:42,059 --> 00:08:43,860
you can use the workspace admin Center

239
00:08:43,860 --> 00:08:45,420
there's a little section in the

240
00:08:45,420 --> 00:08:46,980
reporting that says auditing an

241
00:08:46,980 --> 00:08:50,160
investigation and you have like a visual

242
00:08:50,160 --> 00:08:53,160
interface where you can search for a

243
00:08:53,160 --> 00:08:55,320
filter for admin events group events

244
00:08:55,320 --> 00:08:56,940
everything that I just listed all the

245
00:08:56,940 --> 00:08:59,399
record types you can simply

246
00:08:59,399 --> 00:09:02,160
filter on those you can do some more

247
00:09:02,160 --> 00:09:03,660
advanced filtering with Boolean

248
00:09:03,660 --> 00:09:06,540
filtering and you can filter an IP you

249
00:09:06,540 --> 00:09:08,279
can do all kinds of crazy stuff there

250
00:09:08,279 --> 00:09:11,100
which is pretty okay for basic quick

251
00:09:11,100 --> 00:09:12,480
investigation

252
00:09:12,480 --> 00:09:14,279
and then you can export you can export

253
00:09:14,279 --> 00:09:16,680
to Google Sheets and CSV nowadays so

254
00:09:16,680 --> 00:09:18,660
that's pretty nice

255
00:09:18,660 --> 00:09:20,760
um but not what we want this is an

256
00:09:20,760 --> 00:09:22,560
example of the audit logging when we

257
00:09:22,560 --> 00:09:24,600
export it out what we really want to do

258
00:09:24,600 --> 00:09:27,959
is um build a tool give it to the world

259
00:09:27,959 --> 00:09:29,940
and where everyone can just use the tool

260
00:09:29,940 --> 00:09:32,040
to grab all the data from their client

261
00:09:32,040 --> 00:09:33,660
or from their own environment and do the

262
00:09:33,660 --> 00:09:37,560
magic with it so that's why we do not

263
00:09:37,560 --> 00:09:39,360
just rely on the graphical interface of

264
00:09:39,360 --> 00:09:42,839
Google and we go a step further

265
00:09:42,839 --> 00:09:45,600
and now we come into the topic of Alpha

266
00:09:45,600 --> 00:09:48,200
and what is alpha alpha stands for

267
00:09:48,200 --> 00:09:51,060
automated ordered look forensic analysis

268
00:09:51,060 --> 00:09:54,240
for Google workspace well Alpha has four

269
00:09:54,240 --> 00:09:55,920
letters and I think there's a lot more

270
00:09:55,920 --> 00:09:58,200
words there but we thought alpha sounds

271
00:09:58,200 --> 00:10:01,260
a bit better so we stuck with Alpha

272
00:10:01,260 --> 00:10:05,040
um what it is it's an open source tool

273
00:10:05,040 --> 00:10:06,779
and it's available right now I think I

274
00:10:06,779 --> 00:10:09,600
disabled or I cloned and made it

275
00:10:09,600 --> 00:10:11,459
publicly available this morning so it

276
00:10:11,459 --> 00:10:13,560
should be available for everyone to use

277
00:10:13,560 --> 00:10:15,720
what it does it it can acquire all

278
00:10:15,720 --> 00:10:19,260
Google workspace order logs and

279
00:10:19,260 --> 00:10:20,880
the next step is of course the analysis

280
00:10:20,880 --> 00:10:23,100
step is where the magic comes in it

281
00:10:23,100 --> 00:10:26,640
leverages the my attack Cloud framework

282
00:10:26,640 --> 00:10:28,860
to basically classify events so what it

283
00:10:28,860 --> 00:10:30,959
does it grabs all the logs and then

284
00:10:30,959 --> 00:10:33,600
tries to figure out based on a mapping

285
00:10:33,600 --> 00:10:36,000
oh is this event related to I don't know

286
00:10:36,000 --> 00:10:39,000
initial access to persistence or to

287
00:10:39,000 --> 00:10:41,399
another phase of the Mitra framework and

288
00:10:41,399 --> 00:10:42,360
then it

289
00:10:42,360 --> 00:10:45,060
basically classifies that event

290
00:10:45,060 --> 00:10:46,920
the next step is

291
00:10:46,920 --> 00:10:49,019
using that classification you can

292
00:10:49,019 --> 00:10:51,360
actually sort of automatically identify

293
00:10:51,360 --> 00:10:54,000
interesting activity because you can as

294
00:10:54,000 --> 00:10:56,279
a tool or as a as an analyst you can say

295
00:10:56,279 --> 00:10:58,500
like oh there's a lot of interesting uh

296
00:10:58,500 --> 00:11:00,120
or there's a lot of mapped events

297
00:11:00,120 --> 00:11:02,220
because not every event can be mapped to

298
00:11:02,220 --> 00:11:04,079
the miter framework of course but

299
00:11:04,079 --> 00:11:06,480
there's a lot of mapped events with a

300
00:11:06,480 --> 00:11:08,940
Mitra technique or ship technique in a

301
00:11:08,940 --> 00:11:10,380
certain period of time so it might be

302
00:11:10,380 --> 00:11:11,399
interesting

303
00:11:11,399 --> 00:11:13,620
so let's let's start

304
00:11:13,620 --> 00:11:17,040
we went a step further and we tried to

305
00:11:17,040 --> 00:11:19,380
build something that identifies skill

306
00:11:19,380 --> 00:11:22,320
chains I don't think guilt I think for

307
00:11:22,320 --> 00:11:24,959
the purest Among Us kill changes maybe

308
00:11:24,959 --> 00:11:26,220
the wrong word but what it basically

309
00:11:26,220 --> 00:11:28,800
does it tries to identify a tech change

310
00:11:28,800 --> 00:11:31,680
so where we based on the logging can we

311
00:11:31,680 --> 00:11:33,779
identify and attack can we identify

312
00:11:33,779 --> 00:11:35,579
multiple phases of an attack based on

313
00:11:35,579 --> 00:11:36,899
the logging

314
00:11:36,899 --> 00:11:37,500
um

315
00:11:37,500 --> 00:11:41,100
and what I can also do is after it has

316
00:11:41,100 --> 00:11:43,620
identified these interesting activities

317
00:11:43,620 --> 00:11:46,320
or the kill chains it can export it out

318
00:11:46,320 --> 00:11:48,779
so you end up with like all the logging

319
00:11:48,779 --> 00:11:51,240
on one side so all the exported logging

320
00:11:51,240 --> 00:11:53,339
which you can also

321
00:11:53,339 --> 00:11:55,079
um use a separate file which is way

322
00:11:55,079 --> 00:11:57,360
smaller with only the things that we

323
00:11:57,360 --> 00:11:59,579
think as authors of alpha to be

324
00:11:59,579 --> 00:12:01,200
interesting for you which is very

325
00:12:01,200 --> 00:12:03,360
dangerous but I'm going to be

326
00:12:03,360 --> 00:12:04,800
transparent about what it does so you

327
00:12:04,800 --> 00:12:07,140
can make your own decisions uh on how to

328
00:12:07,140 --> 00:12:08,820
use this

329
00:12:08,820 --> 00:12:11,339
and use a super complex algorithms to

330
00:12:11,339 --> 00:12:13,680
perform this magic this machine learning

331
00:12:13,680 --> 00:12:15,720
AI now just kidding it's it's not very

332
00:12:15,720 --> 00:12:18,240
complex uh I will explain everything in

333
00:12:18,240 --> 00:12:19,620
this talk

334
00:12:19,620 --> 00:12:22,019
um but it's it's good to know how it

335
00:12:22,019 --> 00:12:24,060
works in the back end basically to do

336
00:12:24,060 --> 00:12:26,579
this automated analysis

337
00:12:26,579 --> 00:12:27,720
so

338
00:12:27,720 --> 00:12:30,839
the first step is acquisition

339
00:12:30,839 --> 00:12:33,120
um so how can we acquire this data

340
00:12:33,120 --> 00:12:34,500
automatically and how can we get

341
00:12:34,500 --> 00:12:36,660
everything this is

342
00:12:36,660 --> 00:12:38,519
um how you set it all up

343
00:12:38,519 --> 00:12:39,600
um

344
00:12:39,600 --> 00:12:42,500
there's a specific API the reports API

345
00:12:42,500 --> 00:12:45,740
that basically exposes this information

346
00:12:45,740 --> 00:12:48,779
and there's two types of reports in the

347
00:12:48,779 --> 00:12:51,600
API there's activity reports and users

348
00:12:51,600 --> 00:12:54,120
reports as the name sort of suggests

349
00:12:54,120 --> 00:12:56,100
activity

350
00:12:56,100 --> 00:12:59,760
report is based on what kind of activity

351
00:12:59,760 --> 00:13:02,220
did we record in a certain

352
00:13:02,220 --> 00:13:04,920
category so in admin events or in Google

353
00:13:04,920 --> 00:13:07,800
Drive events or in chat events whereas a

354
00:13:07,800 --> 00:13:10,320
usage report is more like what did a

355
00:13:10,320 --> 00:13:13,019
certain user do

356
00:13:13,019 --> 00:13:14,519
um so made a decision to use the

357
00:13:14,519 --> 00:13:16,560
activity API because within activity

358
00:13:16,560 --> 00:13:20,399
report what I should say we use the

359
00:13:20,399 --> 00:13:23,040
activity log from the report API because

360
00:13:23,040 --> 00:13:24,720
you can still filter only use it there

361
00:13:24,720 --> 00:13:27,420
so it's it's a no-brainer to go for this

362
00:13:27,420 --> 00:13:28,860
one

363
00:13:28,860 --> 00:13:29,519
um

364
00:13:29,519 --> 00:13:31,680
if you want to use this in your client

365
00:13:31,680 --> 00:13:32,880
environment or in your own environment

366
00:13:32,880 --> 00:13:34,139
you need two things

367
00:13:34,139 --> 00:13:35,700
you need something with Google workspace

368
00:13:35,700 --> 00:13:41,160
you need basically a user that has the

369
00:13:41,160 --> 00:13:43,079
um a custom row called reports

370
00:13:43,079 --> 00:13:45,120
administrator or that basically you have

371
00:13:45,120 --> 00:13:47,820
to attach a certain permission

372
00:13:47,820 --> 00:13:49,260
um which falls on the repos

373
00:13:49,260 --> 00:13:51,360
administrator and you can tie it to an

374
00:13:51,360 --> 00:13:53,339
account or if you are going the easy

375
00:13:53,339 --> 00:13:55,500
route you can just request the super

376
00:13:55,500 --> 00:13:57,540
administrator account

377
00:13:57,540 --> 00:13:59,639
um it's a bit more secure I would say

378
00:13:59,639 --> 00:14:01,740
for an acquisition at your client to

379
00:14:01,740 --> 00:14:04,980
just repressed I only need this so set

380
00:14:04,980 --> 00:14:07,440
up a custom role for that

381
00:14:07,440 --> 00:14:10,440
because we do something with um a

382
00:14:10,440 --> 00:14:13,019
so-called oauth application to get the

383
00:14:13,019 --> 00:14:15,600
logs and to authorize you also need

384
00:14:15,600 --> 00:14:17,880
something in the Google Cloud

385
00:14:17,880 --> 00:14:19,139
um

386
00:14:19,139 --> 00:14:20,940
what you what you need to do is you need

387
00:14:20,940 --> 00:14:23,519
to create a Google Cloud project

388
00:14:23,519 --> 00:14:24,959
and within that project you need to

389
00:14:24,959 --> 00:14:28,040
enable a certain API so the admin SDK

390
00:14:28,040 --> 00:14:30,779
API basically and you need to register

391
00:14:30,779 --> 00:14:33,180
an oauth application the oauth

392
00:14:33,180 --> 00:14:35,060
application what it does is basically

393
00:14:35,060 --> 00:14:38,300
it's you can give it a certain

394
00:14:38,300 --> 00:14:41,699
set of you can give it a scope saying

395
00:14:41,699 --> 00:14:44,100
basically oh this application can look

396
00:14:44,100 --> 00:14:47,040
at this API and an oauth will try to

397
00:14:47,040 --> 00:14:49,620
perform authentication and authorization

398
00:14:49,620 --> 00:14:53,100
on your behalf and then you as a user as

399
00:14:53,100 --> 00:14:54,660
someone with the role repos

400
00:14:54,660 --> 00:14:56,399
administrator needs to approve that

401
00:14:56,399 --> 00:14:57,899
action

402
00:14:57,899 --> 00:15:00,899
um I made it visually so it's it's a bit

403
00:15:00,899 --> 00:15:03,779
more clear maybe maybe yes maybe it's a

404
00:15:03,779 --> 00:15:06,060
bit more clear in the next slide but

405
00:15:06,060 --> 00:15:07,800
this is also how most of the clouds

406
00:15:07,800 --> 00:15:09,720
nowadays work if you want to grab logs

407
00:15:09,720 --> 00:15:11,880
from apis you need to use an oauth

408
00:15:11,880 --> 00:15:13,440
application

409
00:15:13,440 --> 00:15:15,480
um so yeah so we can interact with the

410
00:15:15,480 --> 00:15:18,060
API to get the data and we'll use an

411
00:15:18,060 --> 00:15:20,100
oauth application especially four steps

412
00:15:20,100 --> 00:15:22,740
so you can create a new gcp project this

413
00:15:22,740 --> 00:15:25,160
is optional but I suggest if you do

414
00:15:25,160 --> 00:15:29,459
acquisition often or frequently and that

415
00:15:29,459 --> 00:15:31,620
you always have a separate project at

416
00:15:31,620 --> 00:15:33,839
the client side because it's easy to

417
00:15:33,839 --> 00:15:34,699
track

418
00:15:34,699 --> 00:15:36,959
course and permissions and you can

419
00:15:36,959 --> 00:15:39,060
easily also shoot it down afterwards

420
00:15:39,060 --> 00:15:42,120
within this project enable the API

421
00:15:42,120 --> 00:15:44,339
and then register an oauth application

422
00:15:44,339 --> 00:15:45,899
this is really straightforward it's just

423
00:15:45,899 --> 00:15:48,300
critically click give it a name and in

424
00:15:48,300 --> 00:15:49,560
the end you will end up with a

425
00:15:49,560 --> 00:15:51,000
credentials file and this is really

426
00:15:51,000 --> 00:15:52,680
important because the credentials fell

427
00:15:52,680 --> 00:15:56,160
will be used in Alpha to perform the

428
00:15:56,160 --> 00:15:58,500
right calls and to ask for the right

429
00:15:58,500 --> 00:16:00,720
permissions

430
00:16:00,720 --> 00:16:03,720
because this is very common like this

431
00:16:03,720 --> 00:16:06,000
building an old application is is being

432
00:16:06,000 --> 00:16:08,399
used on Microsoft Google probably also

433
00:16:08,399 --> 00:16:10,100
in AWS

434
00:16:10,100 --> 00:16:12,839
the instructions are very clear and very

435
00:16:12,839 --> 00:16:15,360
well documented what I've done is I've

436
00:16:15,360 --> 00:16:17,399
made a description on GitHub if you

437
00:16:17,399 --> 00:16:19,560
click on this link you'll find it

438
00:16:19,560 --> 00:16:21,240
um and there's also a whole YouTube

439
00:16:21,240 --> 00:16:22,800
video where I just go through each of

440
00:16:22,800 --> 00:16:25,139
the steps and I do it really slowly and

441
00:16:25,139 --> 00:16:26,579
you should be able to just follow that

442
00:16:26,579 --> 00:16:29,220
and then you're good to go so even

443
00:16:29,220 --> 00:16:31,440
though this may sound a bit don't think

444
00:16:31,440 --> 00:16:32,339
it's it's actually pretty

445
00:16:32,339 --> 00:16:35,040
straightforward uh most important thing

446
00:16:35,040 --> 00:16:37,320
you need to remember is at the end of

447
00:16:37,320 --> 00:16:39,720
this phase you will have a Json fell

448
00:16:39,720 --> 00:16:44,279
that you'll need to use with Alpha

449
00:16:44,279 --> 00:16:47,759
so using Alpha it has three modes Alpha

450
00:16:47,759 --> 00:16:50,040
acquire well it acquires all the loads

451
00:16:50,040 --> 00:16:54,300
Alpha analyze it acquires and analyzes

452
00:16:54,300 --> 00:16:56,220
the log so it tries to identify

453
00:16:56,220 --> 00:16:58,259
interesting activity

454
00:16:58,259 --> 00:17:01,380
and Alpha loads and you can use this if

455
00:17:01,380 --> 00:17:03,480
you already have previously acquired the

456
00:17:03,480 --> 00:17:05,339
logs and you just want to use the

457
00:17:05,339 --> 00:17:08,400
analysis functionality of the tool

458
00:17:08,400 --> 00:17:10,079
to use the two

459
00:17:10,079 --> 00:17:12,359
simply download it from GitHub and then

460
00:17:12,359 --> 00:17:14,099
you can run you can use pip to install

461
00:17:14,099 --> 00:17:16,380
it so go to the folder in this command

462
00:17:16,380 --> 00:17:17,939
and it will install it

463
00:17:17,939 --> 00:17:20,280
then you need to initialize it and this

464
00:17:20,280 --> 00:17:22,740
may might may be a bit different to

465
00:17:22,740 --> 00:17:24,839
other open source projects but we

466
00:17:24,839 --> 00:17:26,780
thought it was a good idea to use

467
00:17:26,780 --> 00:17:29,820
initialization for each project because

468
00:17:29,820 --> 00:17:31,440
let's say you are a consultant or you're

469
00:17:31,440 --> 00:17:33,360
doing more projects

470
00:17:33,360 --> 00:17:38,100
you may want to tune Alpha to a certain

471
00:17:38,100 --> 00:17:39,720
environment so you might want to change

472
00:17:39,720 --> 00:17:42,299
some variables and with initialization

473
00:17:42,299 --> 00:17:44,760
what it does it is it automatically

474
00:17:44,760 --> 00:17:46,980
creates a project folder and within the

475
00:17:46,980 --> 00:17:48,539
project photo there will be a config

476
00:17:48,539 --> 00:17:50,280
file that will be unique to the specific

477
00:17:50,280 --> 00:17:52,200
project so you can do all your tuning

478
00:17:52,200 --> 00:17:54,660
there without actually changing the main

479
00:17:54,660 --> 00:17:56,179
product

480
00:17:56,179 --> 00:17:58,679
so you need to run Alpha in it and then

481
00:17:58,679 --> 00:18:00,240
a project name you can decide what the

482
00:18:00,240 --> 00:18:02,100
project name is it automatically creates

483
00:18:02,100 --> 00:18:04,679
a folder structure for the logs and for

484
00:18:04,679 --> 00:18:06,840
the configuration in the configuration

485
00:18:06,840 --> 00:18:08,700
directory you throw in your credentials

486
00:18:08,700 --> 00:18:10,500
file that you have from the previous

487
00:18:10,500 --> 00:18:14,539
steps and you're good to go

488
00:18:14,580 --> 00:18:15,840
so what can you do in terms of

489
00:18:15,840 --> 00:18:18,059
acquisition you can just be like oh give

490
00:18:18,059 --> 00:18:20,880
me everything Alpha acquire you can say

491
00:18:20,880 --> 00:18:22,980
oh I only want to have the admin related

492
00:18:22,980 --> 00:18:25,440
activities or I only want to have the

493
00:18:25,440 --> 00:18:27,840
user login activities or only the drive

494
00:18:27,840 --> 00:18:30,179
activities and then you have to use dash

495
00:18:30,179 --> 00:18:33,539
dash log type equals the thing you want

496
00:18:33,539 --> 00:18:36,299
and as I mentioned you can also simply

497
00:18:36,299 --> 00:18:38,400
filter on users so let's say you could

498
00:18:38,400 --> 00:18:40,620
call it into an incident or you suspect

499
00:18:40,620 --> 00:18:41,760
something is going on with a certain

500
00:18:41,760 --> 00:18:44,280
user you can simply also just collect

501
00:18:44,280 --> 00:18:47,760
that user's audit logs

502
00:18:47,760 --> 00:18:50,220
last but not least you can also acquire

503
00:18:50,220 --> 00:18:52,380
based on a time frame so let's say most

504
00:18:52,380 --> 00:18:54,780
of the instance you have an ID on when

505
00:18:54,780 --> 00:18:57,240
it happened so then you can simply

506
00:18:57,240 --> 00:19:00,299
select a time frame

507
00:19:00,299 --> 00:19:02,520
I think I made a video about this yeah I

508
00:19:02,520 --> 00:19:03,900
did

509
00:19:03,900 --> 00:19:04,559
um

510
00:19:04,559 --> 00:19:06,240
as you can see I don't know yeah it's

511
00:19:06,240 --> 00:19:07,919
pretty pretty good

512
00:19:07,919 --> 00:19:09,720
um I'm now inside a project that I

513
00:19:09,720 --> 00:19:11,100
created so I initialized a project

514
00:19:11,100 --> 00:19:14,280
called sense project and automatically I

515
00:19:14,280 --> 00:19:16,440
already added the credentials file so

516
00:19:16,440 --> 00:19:19,200
now I can just ruin it

517
00:19:19,200 --> 00:19:21,360
what will happen is if I run it it will

518
00:19:21,360 --> 00:19:24,660
do the authorization with award

519
00:19:24,660 --> 00:19:27,000
um so it will open up a browser and

520
00:19:27,000 --> 00:19:28,740
it'll say please log in with an account

521
00:19:28,740 --> 00:19:30,840
that has the right permissions

522
00:19:30,840 --> 00:19:33,000
it's pretty quick but basically this was

523
00:19:33,000 --> 00:19:34,620
successful

524
00:19:34,620 --> 00:19:37,980
and now it shows you all the logs At the

525
00:19:37,980 --> 00:19:40,320
quiet per log tile because I said grab

526
00:19:40,320 --> 00:19:41,580
everything

527
00:19:41,580 --> 00:19:44,340
and in the end you can still see it on

528
00:19:44,340 --> 00:19:46,380
this as a screenshot you will have a

529
00:19:46,380 --> 00:19:49,740
little bit of you have 9 9.5 K activity

530
00:19:49,740 --> 00:19:52,200
saved to a data folder and this video

531
00:19:52,200 --> 00:19:54,419
was not fast forward or something so

532
00:19:54,419 --> 00:19:57,960
within I think 20-30 seconds we actually

533
00:19:57,960 --> 00:20:01,980
managed to get almost 10K events so it's

534
00:20:01,980 --> 00:20:04,679
really quick so yeah I should probably

535
00:20:04,679 --> 00:20:07,679
use this over an API export like a GUI

536
00:20:07,679 --> 00:20:09,020
export or something

537
00:20:09,020 --> 00:20:12,240
just because it's really fast so what

538
00:20:12,240 --> 00:20:13,559
happens next is

539
00:20:13,559 --> 00:20:15,620
as I mentioned the initial

540
00:20:15,620 --> 00:20:19,080
initialization of the project results in

541
00:20:19,080 --> 00:20:21,840
an in a data folder and a data folder

542
00:20:21,840 --> 00:20:24,419
contains the acquired logs and what

543
00:20:24,419 --> 00:20:26,280
Alpha does it it automatically creates a

544
00:20:26,280 --> 00:20:30,419
folder with the UTC date and time of the

545
00:20:30,419 --> 00:20:32,520
acquisition so to automatically you can

546
00:20:32,520 --> 00:20:34,320
always go back and be like ah when was

547
00:20:34,320 --> 00:20:35,640
this acquisition you can just look at

548
00:20:35,640 --> 00:20:38,100
the folder name and you also never end

549
00:20:38,100 --> 00:20:40,860
up with duplicate entries or something

550
00:20:40,860 --> 00:20:43,679
so here you'll see I think it's around

551
00:20:43,679 --> 00:20:46,020
20 different log types that have been

552
00:20:46,020 --> 00:20:48,960
acquired you will also see a few that

553
00:20:48,960 --> 00:20:50,580
actually are really small and it

554
00:20:50,580 --> 00:20:52,200
actually means that they are empty so

555
00:20:52,200 --> 00:20:55,200
they're 18 kilobytes and the new version

556
00:20:55,200 --> 00:20:57,240
that's actually released now it won't

557
00:20:57,240 --> 00:20:59,520
acquire empty log so it will only grab

558
00:20:59,520 --> 00:21:02,160
logs when there's data there so it's

559
00:21:02,160 --> 00:21:03,240
pretty nice

560
00:21:03,240 --> 00:21:04,919
so now

561
00:21:04,919 --> 00:21:05,820
um

562
00:21:05,820 --> 00:21:07,980
yeah you basically have a decision to

563
00:21:07,980 --> 00:21:09,780
make you can either say well this is

564
00:21:09,780 --> 00:21:10,620
nice

565
00:21:10,620 --> 00:21:12,480
um I can use this tool to acquire all

566
00:21:12,480 --> 00:21:14,940
the data and then I can run off to my

567
00:21:14,940 --> 00:21:17,640
own seam or my own data nurse platform

568
00:21:17,640 --> 00:21:19,860
or whatever you would like to use and

569
00:21:19,860 --> 00:21:22,860
stop but I would love for everyone to

570
00:21:22,860 --> 00:21:24,720
come along with the Journey of analysis

571
00:21:24,720 --> 00:21:26,580
and this is the second mode of alpha

572
00:21:26,580 --> 00:21:28,320
this is the analyze mode

573
00:21:28,320 --> 00:21:30,419
the way it works is and this is

574
00:21:30,419 --> 00:21:32,539
basically where I'm explaining the magic

575
00:21:32,539 --> 00:21:35,400
it's not not that magical but it's

576
00:21:35,400 --> 00:21:37,620
pretty cool we use the micro attack

577
00:21:37,620 --> 00:21:39,840
Cloud framework it's a collection for

578
00:21:39,840 --> 00:21:41,159
the people that don't know

579
00:21:41,159 --> 00:21:43,679
it's a collection of techniques that

580
00:21:43,679 --> 00:21:47,280
have been observed by threat actors

581
00:21:47,280 --> 00:21:49,200
um to be abused basically so let's say

582
00:21:49,200 --> 00:21:50,940
under

583
00:21:50,940 --> 00:21:52,880
um the privilege escalation

584
00:21:52,880 --> 00:21:55,679
phase there's a technique called valid

585
00:21:55,679 --> 00:21:57,840
accounts and

586
00:21:57,840 --> 00:21:59,700
basically what happened is is that

587
00:21:59,700 --> 00:22:02,340
certain threat actors use this tactic or

588
00:22:02,340 --> 00:22:05,100
this technique against a technology in

589
00:22:05,100 --> 00:22:07,559
this case it's Google workspace to abuse

590
00:22:07,559 --> 00:22:09,120
it

591
00:22:09,120 --> 00:22:10,620
um so what we do

592
00:22:10,620 --> 00:22:11,880
is

593
00:22:11,880 --> 00:22:13,919
we take the original event that's on the

594
00:22:13,919 --> 00:22:15,900
left hand side and I've made a little

595
00:22:15,900 --> 00:22:18,419
red box around it so the original event

596
00:22:18,419 --> 00:22:20,820
is around the creation of a user and

597
00:22:20,820 --> 00:22:22,740
I've blurt out some details it's

598
00:22:22,740 --> 00:22:24,600
probably my own home IP

599
00:22:24,600 --> 00:22:28,559
um so this is the create user event so

600
00:22:28,559 --> 00:22:30,539
this is the type of event what we do on

601
00:22:30,539 --> 00:22:32,039
the right hand side is we've made a

602
00:22:32,039 --> 00:22:33,539
mapping

603
00:22:33,539 --> 00:22:36,120
and the mapping is made towards the

604
00:22:36,120 --> 00:22:39,179
Mitra technique or ship technique

605
00:22:39,179 --> 00:22:40,919
so what you see is on the right hand

606
00:22:40,919 --> 00:22:44,159
side you'll see that this specific event

607
00:22:44,159 --> 00:22:46,500
belongs to the persistence phase

608
00:22:46,500 --> 00:22:49,620
and then to the create account technique

609
00:22:49,620 --> 00:22:51,419
and into the shift technique cloud

610
00:22:51,419 --> 00:22:53,220
account so that's basically the

611
00:22:53,220 --> 00:22:55,500
structure of the event

612
00:22:55,500 --> 00:22:57,419
and the link is there for the specific

613
00:22:57,419 --> 00:22:59,820
one if you look a little bit further

614
00:22:59,820 --> 00:23:01,679
down this download report this is a

615
00:23:01,679 --> 00:23:03,380
Google event

616
00:23:03,380 --> 00:23:06,360
and this belongs to what we think the

617
00:23:06,360 --> 00:23:08,640
collection phase of Mitra and into the

618
00:23:08,640 --> 00:23:10,280
technique data from information

619
00:23:10,280 --> 00:23:13,200
repositories so this is how we have

620
00:23:13,200 --> 00:23:16,200
defined what original Google workspace

621
00:23:16,200 --> 00:23:17,940
order logs

622
00:23:17,940 --> 00:23:19,860
um yeah basically are in terms of

623
00:23:19,860 --> 00:23:22,620
activity so really important to remember

624
00:23:22,620 --> 00:23:24,659
this fell as part of of course the tool

625
00:23:24,659 --> 00:23:27,360
you can modify it you can update it but

626
00:23:27,360 --> 00:23:29,640
this is what we have decided to be the

627
00:23:29,640 --> 00:23:30,960
case

628
00:23:30,960 --> 00:23:33,000
and you can make suggestions if you

629
00:23:33,000 --> 00:23:34,740
don't agree by the way

630
00:23:34,740 --> 00:23:37,380
um in the next step what we do is

631
00:23:37,380 --> 00:23:40,799
we take it original event that's mapped

632
00:23:40,799 --> 00:23:44,340
we give it a score based on the

633
00:23:44,340 --> 00:23:47,039
associated miter phase so here you will

634
00:23:47,039 --> 00:23:49,620
have the different phases from Mitra

635
00:23:49,620 --> 00:23:52,559
um so this previous event was related to

636
00:23:52,559 --> 00:23:56,100
persistency so that event will get the

637
00:23:56,100 --> 00:23:58,500
score of one because it occurs in the

638
00:23:58,500 --> 00:24:00,960
first phase according to us

639
00:24:00,960 --> 00:24:03,780
and the next thing it will do is

640
00:24:03,780 --> 00:24:07,440
it will create basically a running score

641
00:24:07,440 --> 00:24:09,539
where it compares

642
00:24:09,539 --> 00:24:12,960
the score of this event so the let's

643
00:24:12,960 --> 00:24:15,000
take this example of a persistency so we

644
00:24:15,000 --> 00:24:16,620
have a score of one

645
00:24:16,620 --> 00:24:18,360
and then we'll compare it with the next

646
00:24:18,360 --> 00:24:21,120
event and if the next event has a higher

647
00:24:21,120 --> 00:24:23,880
score based on the micro Attack Phase

648
00:24:23,880 --> 00:24:25,860
that occurs in

649
00:24:25,860 --> 00:24:29,340
well oop the running score with one if

650
00:24:29,340 --> 00:24:31,380
it doesn't follow the major attack flow

651
00:24:31,380 --> 00:24:33,600
basically so from persistence towards

652
00:24:33,600 --> 00:24:37,559
collection will subtract one so the

653
00:24:37,559 --> 00:24:40,200
running score will be minus one

654
00:24:40,200 --> 00:24:42,960
this allows us to generate what we call

655
00:24:42,960 --> 00:24:45,179
a kill change statistic and this is

656
00:24:45,179 --> 00:24:46,980
basically where we have a number of

657
00:24:46,980 --> 00:24:49,220
events so at least five

658
00:24:49,220 --> 00:24:52,200
that have occurred where we do this

659
00:24:52,200 --> 00:24:55,320
comparison so we check event one or

660
00:24:55,320 --> 00:24:57,659
event two is in a later phase in the

661
00:24:57,659 --> 00:24:59,580
monitor framework so the running score

662
00:24:59,580 --> 00:25:02,700
is updated event 3 is also updated so

663
00:25:02,700 --> 00:25:04,320
let's say we have five events that

664
00:25:04,320 --> 00:25:08,100
follow the Mitra attack chain the

665
00:25:08,100 --> 00:25:10,440
running score will be five because every

666
00:25:10,440 --> 00:25:12,059
time the next event

667
00:25:12,059 --> 00:25:14,820
follows the mitral attack flow

668
00:25:14,820 --> 00:25:18,000
okay and then we divide that number by

669
00:25:18,000 --> 00:25:19,919
the number of events so we have five

670
00:25:19,919 --> 00:25:22,440
events that follow the chain and we have

671
00:25:22,440 --> 00:25:24,900
five total events now what happens if

672
00:25:24,900 --> 00:25:26,640
you divide five by five we'll end up

673
00:25:26,640 --> 00:25:28,500
with one so the kill change statistic is

674
00:25:28,500 --> 00:25:30,840
one what does one mean it's the perfect

675
00:25:30,840 --> 00:25:33,480
kill chain it will never happen only if

676
00:25:33,480 --> 00:25:36,120
you have a fabricated data set of course

677
00:25:36,120 --> 00:25:39,059
um but that means that each event

678
00:25:39,059 --> 00:25:40,919
um yeah basically follows the miter

679
00:25:40,919 --> 00:25:43,320
attack framework which never happens you

680
00:25:43,320 --> 00:25:45,120
could also have minus one which is a

681
00:25:45,120 --> 00:25:47,100
reverse skill chain where an event

682
00:25:47,100 --> 00:25:49,020
basically goes backwards so you have

683
00:25:49,020 --> 00:25:51,419
five events or ten events that each time

684
00:25:51,419 --> 00:25:53,659
go back in the Mito attack

685
00:25:53,659 --> 00:25:55,740
framework flow so you will have an event

686
00:25:55,740 --> 00:25:57,360
electoral movement followed by an event

687
00:25:57,360 --> 00:25:59,940
in Prudential access for instance and

688
00:25:59,940 --> 00:26:00,840
Then followed by one in previous

689
00:26:00,840 --> 00:26:04,020
escalation highly unlikely if you have a

690
00:26:04,020 --> 00:26:06,000
score that's close to zero

691
00:26:06,000 --> 00:26:08,580
that represents basically random events

692
00:26:08,580 --> 00:26:10,919
so yeah that's

693
00:26:10,919 --> 00:26:13,020
maybe more common because you will have

694
00:26:13,020 --> 00:26:15,720
in a normal data set you expect there to

695
00:26:15,720 --> 00:26:18,360
be normal user activity maybe better

696
00:26:18,360 --> 00:26:20,279
maybe bad or suspicious activity

697
00:26:20,279 --> 00:26:22,620
followed by normal activity so this is

698
00:26:22,620 --> 00:26:24,059
what the tool tries to do it tries to

699
00:26:24,059 --> 00:26:27,240
identify Blobs of data so to say that

700
00:26:27,240 --> 00:26:29,700
that contain interesting activity

701
00:26:29,700 --> 00:26:31,080
step seven

702
00:26:31,080 --> 00:26:34,919
for each chain of events so

703
00:26:34,919 --> 00:26:35,520
um

704
00:26:35,520 --> 00:26:38,100
it will generate the kill chain

705
00:26:38,100 --> 00:26:41,100
statistic and if it's higher than 0.6

706
00:26:41,100 --> 00:26:44,100
it will be available for export so then

707
00:26:44,100 --> 00:26:45,659
we what we can do is with one command

708
00:26:45,659 --> 00:26:47,640
and I'll show you it automatically

709
00:26:47,640 --> 00:26:49,320
exports all these ship chains to a

710
00:26:49,320 --> 00:26:51,360
separate fell so in that separate file

711
00:26:51,360 --> 00:26:53,480
you should only have

712
00:26:53,480 --> 00:26:56,340
events in an ideal world that are

713
00:26:56,340 --> 00:26:58,440
interesting and this is a very important

714
00:26:58,440 --> 00:27:00,240
point that I want to make

715
00:27:00,240 --> 00:27:01,919
we are not in the business of saying

716
00:27:01,919 --> 00:27:04,679
something is malicious we are basically

717
00:27:04,679 --> 00:27:07,559
pointing out based on audit logging

718
00:27:07,559 --> 00:27:10,320
and our knowledge of incidents and what

719
00:27:10,320 --> 00:27:12,779
we think is important we come up with a

720
00:27:12,779 --> 00:27:14,520
bunch of interesting events but it's up

721
00:27:14,520 --> 00:27:15,960
to you to the analyst to the instant

722
00:27:15,960 --> 00:27:18,240
responder to actually determine is this

723
00:27:18,240 --> 00:27:19,679
malicious because

724
00:27:19,679 --> 00:27:22,559
if we follow the steps of Mitra it can

725
00:27:22,559 --> 00:27:24,840
also be that a normal administrator

726
00:27:24,840 --> 00:27:27,419
creates a user adds that you should do a

727
00:27:27,419 --> 00:27:28,460
certain group

728
00:27:28,460 --> 00:27:31,260
does some more legit activity which

729
00:27:31,260 --> 00:27:33,539
actually follows all the miter steps so

730
00:27:33,539 --> 00:27:35,580
what we do is we'll give you interesting

731
00:27:35,580 --> 00:27:37,500
events but they're not necessarily

732
00:27:37,500 --> 00:27:39,299
malicious events so that's where you are

733
00:27:39,299 --> 00:27:41,520
coming to Define that that's why they

734
00:27:41,520 --> 00:27:43,559
pay us

735
00:27:43,559 --> 00:27:45,600
um the analyze function and the commands

736
00:27:45,600 --> 00:27:48,539
you can use so what you do if you run

737
00:27:48,539 --> 00:27:50,820
Alpha analyze it will drop you in a

738
00:27:50,820 --> 00:27:53,159
shell and you can do all these things

739
00:27:53,159 --> 00:27:54,840
that I just showed you what you can do

740
00:27:54,840 --> 00:27:57,960
is you can run a.kcs which stands for

741
00:27:57,960 --> 00:28:00,299
kill change statistic and you can run it

742
00:28:00,299 --> 00:28:02,279
on the whole data set or a subset of the

743
00:28:02,279 --> 00:28:05,100
data and it will calculate the kill

744
00:28:05,100 --> 00:28:07,260
chain statistic so it'll give you the

745
00:28:07,260 --> 00:28:09,720
number whatever that is

746
00:28:09,720 --> 00:28:11,820
you can run the a DOT ship chains

747
00:28:11,820 --> 00:28:13,919
command which will automatically show

748
00:28:13,919 --> 00:28:14,760
you

749
00:28:14,760 --> 00:28:17,340
all the identified chains with a value

750
00:28:17,340 --> 00:28:20,720
higher than 0.6

751
00:28:20,760 --> 00:28:23,940
and what you can do within the tool as

752
00:28:23,940 --> 00:28:25,679
well is basically get a summary of the

753
00:28:25,679 --> 00:28:28,500
events within a certain slice of the

754
00:28:28,500 --> 00:28:30,179
data so let's say we have a ship chain

755
00:28:30,179 --> 00:28:33,900
that consists of event one to eight we

756
00:28:33,900 --> 00:28:36,140
can use the summary command with one

757
00:28:36,140 --> 00:28:38,760
semicolon 8 and we get a summary of the

758
00:28:38,760 --> 00:28:39,960
events

759
00:28:39,960 --> 00:28:41,580
which is nice but I'll show you what it

760
00:28:41,580 --> 00:28:42,480
looks like

761
00:28:42,480 --> 00:28:44,220
last but not least you can export out

762
00:28:44,220 --> 00:28:46,740
these activities for further analysis so

763
00:28:46,740 --> 00:28:48,299
what does it look like

764
00:28:48,299 --> 00:28:50,460
um so you have to separate anything

765
00:28:50,460 --> 00:28:54,240
that's belonged to seven and eight so in

766
00:28:54,240 --> 00:28:56,760
seven what we do is we call a DOT ship

767
00:28:56,760 --> 00:28:58,980
chains and it tells us that it found

768
00:28:58,980 --> 00:29:01,679
three strip chains in this data set

769
00:29:01,679 --> 00:29:04,620
and one ship chain for instance has a

770
00:29:04,620 --> 00:29:07,380
score of 0.9 which is very high and

771
00:29:07,380 --> 00:29:09,360
there's not a shift chain that starts at

772
00:29:09,360 --> 00:29:13,559
event 75 until 85 as a ship chain of

773
00:29:13,559 --> 00:29:16,500
score of 0.65 so it might also be

774
00:29:16,500 --> 00:29:17,400
interesting

775
00:29:17,400 --> 00:29:19,919
with the summary command we can see what

776
00:29:19,919 --> 00:29:21,899
type of data is in there and this will

777
00:29:21,899 --> 00:29:24,000
give you basic information like what the

778
00:29:24,000 --> 00:29:27,120
type of event it is so in this example

779
00:29:27,120 --> 00:29:29,460
it says change user access changes ACL

780
00:29:29,460 --> 00:29:31,860
and the end it's basically saying oh

781
00:29:31,860 --> 00:29:34,500
let's configure emo forwarding

782
00:29:34,500 --> 00:29:36,840
which is very interesting so using this

783
00:29:36,840 --> 00:29:37,980
method

784
00:29:37,980 --> 00:29:41,159
we hope to give you

785
00:29:41,159 --> 00:29:43,140
some pointers as to what is interesting

786
00:29:43,140 --> 00:29:45,720
in a data set of Google workspace audit

787
00:29:45,720 --> 00:29:47,580
logs

788
00:29:47,580 --> 00:29:50,760
you can also use load but it's uh you

789
00:29:50,760 --> 00:29:52,740
know as I mentioned is the same which

790
00:29:52,740 --> 00:29:54,360
you can just use previously acquired

791
00:29:54,360 --> 00:29:56,279
data what I really want to show you is

792
00:29:56,279 --> 00:29:57,720
actually

793
00:29:57,720 --> 00:30:00,360
is this any useful or is this yeah is

794
00:30:00,360 --> 00:30:02,640
this useful at all because we've created

795
00:30:02,640 --> 00:30:04,860
this and we've tested this but the talk

796
00:30:04,860 --> 00:30:06,960
was about detecting malicious actors so

797
00:30:06,960 --> 00:30:09,059
what do malicious actors do well they

798
00:30:09,059 --> 00:30:11,460
attack your Google workspace environment

799
00:30:11,460 --> 00:30:14,039
how do they do it in a few ways that

800
00:30:14,039 --> 00:30:16,740
I've chosen I've simulated in for this

801
00:30:16,740 --> 00:30:17,520
test

802
00:30:17,520 --> 00:30:20,100
I've did three attacks a business email

803
00:30:20,100 --> 00:30:21,779
compromise attack

804
00:30:21,779 --> 00:30:23,700
um so getting your email environment to

805
00:30:23,700 --> 00:30:27,240
fishing or through League passwords set

806
00:30:27,240 --> 00:30:29,520
up forwarding rules perform data

807
00:30:29,520 --> 00:30:32,100
exfiltration change invoices for

808
00:30:32,100 --> 00:30:33,120
instance

809
00:30:33,120 --> 00:30:36,899
Attack 2 is a malicious application this

810
00:30:36,899 --> 00:30:39,240
is more like a solarwinds type incident

811
00:30:39,240 --> 00:30:41,580
where you set up an application and you

812
00:30:41,580 --> 00:30:43,919
gave it a lot of permissions and then

813
00:30:43,919 --> 00:30:45,360
you send

814
00:30:45,360 --> 00:30:47,640
um what you can do in oauth you can

815
00:30:47,640 --> 00:30:51,000
generate a URL that authorizes that

816
00:30:51,000 --> 00:30:52,919
application to perform this activity so

817
00:30:52,919 --> 00:30:54,659
let's say you create an application with

818
00:30:54,659 --> 00:30:57,240
a lot of permissions you can then send a

819
00:30:57,240 --> 00:30:59,700
link to a user and when the user clicks

820
00:30:59,700 --> 00:31:01,200
on a link it shows you oh this

821
00:31:01,200 --> 00:31:03,720
application wants to access your data

822
00:31:03,720 --> 00:31:06,059
wants to access your email it wants to

823
00:31:06,059 --> 00:31:09,179
send email your behalf etc etc so this

824
00:31:09,179 --> 00:31:10,500
is the thing that threat actors also

825
00:31:10,500 --> 00:31:13,220
abused in the past and they still do

826
00:31:13,220 --> 00:31:16,620
attack three is what I call apt style so

827
00:31:16,620 --> 00:31:19,080
do some reconing your environment and

828
00:31:19,080 --> 00:31:22,380
then try to steal important data so I've

829
00:31:22,380 --> 00:31:24,240
simulated all these attacks

830
00:31:24,240 --> 00:31:27,299
and the good news is that the data set

831
00:31:27,299 --> 00:31:29,399
that this is all is based on is also

832
00:31:29,399 --> 00:31:31,679
publicly available and I'll I'll share

833
00:31:31,679 --> 00:31:33,539
the link later where you can basically

834
00:31:33,539 --> 00:31:35,820
do your own analysis based on this data

835
00:31:35,820 --> 00:31:38,159
which is pretty cool I think

836
00:31:38,159 --> 00:31:38,820
um

837
00:31:38,820 --> 00:31:41,640
so Attack One the BEC one what I did is

838
00:31:41,640 --> 00:31:44,640
basically four steps and then I uh below

839
00:31:44,640 --> 00:31:49,140
each step I I added a Mitra Attack Phase

840
00:31:49,140 --> 00:31:50,399
that it belongs to

841
00:31:50,399 --> 00:31:52,620
so forwarding rule relates to

842
00:31:52,620 --> 00:31:54,539
persistency

843
00:31:54,539 --> 00:31:57,000
um performing email log searches relates

844
00:31:57,000 --> 00:31:59,760
to the collection phase of maitra so

845
00:31:59,760 --> 00:32:02,279
this is a very controlled experiment in

846
00:32:02,279 --> 00:32:04,260
my environment in my Google workspace

847
00:32:04,260 --> 00:32:06,899
test environment so what I did is I

848
00:32:06,899 --> 00:32:08,640
performed all these steps and then went

849
00:32:08,640 --> 00:32:10,380
away for a few hours because it might

850
00:32:10,380 --> 00:32:11,760
take some time for all the logs to end

851
00:32:11,760 --> 00:32:13,860
up in there and then I counted all the

852
00:32:13,860 --> 00:32:16,200
events that are related to this attack

853
00:32:16,200 --> 00:32:18,779
and then I run Alpha against it to see

854
00:32:18,779 --> 00:32:20,580
if it could find it and if it would

855
00:32:20,580 --> 00:32:23,100
generate a kill change statistic so in

856
00:32:23,100 --> 00:32:25,559
this case it did

857
00:32:25,559 --> 00:32:28,140
um so there are 47 events generated

858
00:32:28,140 --> 00:32:30,179
because of this attack and the kill

859
00:32:30,179 --> 00:32:32,039
change statistic associated with it was

860
00:32:32,039 --> 00:32:34,620
0.9 so there's a very high probability

861
00:32:34,620 --> 00:32:37,140
that if you were to use Alpha that you

862
00:32:37,140 --> 00:32:38,640
would have seen this and that you would

863
00:32:38,640 --> 00:32:40,740
have investigated it further this is

864
00:32:40,740 --> 00:32:42,960
good news but I want to be honest the

865
00:32:42,960 --> 00:32:45,539
next attack not so much the malicious

866
00:32:45,539 --> 00:32:47,700
app is very difficult

867
00:32:47,700 --> 00:32:49,620
um to detect I would say based on the

868
00:32:49,620 --> 00:32:51,419
logging in in a Google workspace

869
00:32:51,419 --> 00:32:53,039
environment for a few reasons so what

870
00:32:53,039 --> 00:32:55,140
you do is you register an oauth

871
00:32:55,140 --> 00:32:57,000
application but you do that outside of

872
00:32:57,000 --> 00:32:58,620
Google workspace so there will be no

873
00:32:58,620 --> 00:33:01,559
record in Google workspace audit logging

874
00:33:01,559 --> 00:33:03,120
about this

875
00:33:03,120 --> 00:33:05,520
when you send a link to an email or you

876
00:33:05,520 --> 00:33:07,740
send an email with a link asking for

877
00:33:07,740 --> 00:33:09,840
permissions there will be no record in

878
00:33:09,840 --> 00:33:11,760
the audit log that there was an email

879
00:33:11,760 --> 00:33:14,580
basically sent yeah there will be if you

880
00:33:14,580 --> 00:33:16,799
go here search through everyone's emails

881
00:33:16,799 --> 00:33:18,240
you will find that email but there will

882
00:33:18,240 --> 00:33:20,760
be no audit record that a link was

883
00:33:20,760 --> 00:33:22,980
received for instance what you will see

884
00:33:22,980 --> 00:33:25,740
is if someone approves clicks on the

885
00:33:25,740 --> 00:33:27,899
link and approves it then it will be

886
00:33:27,899 --> 00:33:30,179
registered in the Google workspace audit

887
00:33:30,179 --> 00:33:31,980
log because then it will say like this

888
00:33:31,980 --> 00:33:33,720
application was given permissions by

889
00:33:33,720 --> 00:33:36,720
user X and then what will also be

890
00:33:36,720 --> 00:33:39,240
registered is if that application starts

891
00:33:39,240 --> 00:33:43,080
doing stuff on behalf of you so that

892
00:33:43,080 --> 00:33:45,059
will also be registered

893
00:33:45,059 --> 00:33:46,799
this attack

894
00:33:46,799 --> 00:33:47,399
um

895
00:33:47,399 --> 00:33:50,340
as I mentioned it generated a few logs

896
00:33:50,340 --> 00:33:53,399
14 in total but most of them being the

897
00:33:53,399 --> 00:33:55,679
application requesting permission or

898
00:33:55,679 --> 00:33:58,559
basically the application authorizing on

899
00:33:58,559 --> 00:34:02,039
your behalf Alpha was not able to find

900
00:34:02,039 --> 00:34:04,260
or at least to identify this with the

901
00:34:04,260 --> 00:34:06,539
kill change statistic method so yeah

902
00:34:06,539 --> 00:34:08,639
this wasn't successful for this specific

903
00:34:08,639 --> 00:34:10,260
attack

904
00:34:10,260 --> 00:34:13,980
um Attack 3 the APT style so we log in

905
00:34:13,980 --> 00:34:16,080
and what we're going to do is we use

906
00:34:16,080 --> 00:34:18,000
something in a Google workspace where

907
00:34:18,000 --> 00:34:19,379
you can what you can do is pretty useful

908
00:34:19,379 --> 00:34:21,839
you can get an export of all users and

909
00:34:21,839 --> 00:34:23,580
their roles just in the environment you

910
00:34:23,580 --> 00:34:25,560
can click export users and roles it'll

911
00:34:25,560 --> 00:34:27,300
give you a CSV with everyone in there

912
00:34:27,300 --> 00:34:29,760
pretty useful but it's also locked so

913
00:34:29,760 --> 00:34:31,619
it's really good for us what you can

914
00:34:31,619 --> 00:34:33,480
also then do is perform exfiltration

915
00:34:33,480 --> 00:34:35,639
what I did was performing exfiltration

916
00:34:35,639 --> 00:34:38,099
of emails so in Google you have

917
00:34:38,099 --> 00:34:40,560
something called email log search where

918
00:34:40,560 --> 00:34:43,379
you can simply search for emails based

919
00:34:43,379 --> 00:34:46,139
on sender recipient Etc it's a bit like

920
00:34:46,139 --> 00:34:48,300
e-discovery but not really the

921
00:34:48,300 --> 00:34:50,820
full-fledged e-discovery Suite in Google

922
00:34:50,820 --> 00:34:53,399
and I also did a Google takeout

923
00:34:53,399 --> 00:34:53,940
um

924
00:34:53,940 --> 00:34:55,199
for the people that don't know Google

925
00:34:55,199 --> 00:34:57,180
takeout is pretty powerful where you

926
00:34:57,180 --> 00:34:59,520
basically say give me everything Google

927
00:34:59,520 --> 00:35:01,560
you have on this account

928
00:35:01,560 --> 00:35:04,380
from a from a threat active perspective

929
00:35:04,380 --> 00:35:07,200
it's pretty useful because you can then

930
00:35:07,200 --> 00:35:09,359
basically inspect the data see if you

931
00:35:09,359 --> 00:35:12,119
can either extort them blackmail them or

932
00:35:12,119 --> 00:35:14,760
maybe use that data to perform a second

933
00:35:14,760 --> 00:35:16,560
attack on other websites they are

934
00:35:16,560 --> 00:35:19,020
registered to so pretty useful so I

935
00:35:19,020 --> 00:35:20,520
perform these activities and luckily

936
00:35:20,520 --> 00:35:23,160
this was detected by Alpha with a score

937
00:35:23,160 --> 00:35:25,859
of 0.65 and even though there were only

938
00:35:25,859 --> 00:35:28,020
seven events generated in the audit log

939
00:35:28,020 --> 00:35:30,839
so I was pretty happy with that

940
00:35:30,839 --> 00:35:34,320
this leads to the conclusion so

941
00:35:34,320 --> 00:35:36,480
out of the three attacks

942
00:35:36,480 --> 00:35:38,220
um two were detected I would say so it's

943
00:35:38,220 --> 00:35:39,540
pretty good

944
00:35:39,540 --> 00:35:40,680
um

945
00:35:40,680 --> 00:35:43,800
still I think what's very important is

946
00:35:43,800 --> 00:35:46,440
um what we do is we say in the tool

947
00:35:46,440 --> 00:35:48,060
itself there's a config file where you

948
00:35:48,060 --> 00:35:49,619
say oh we

949
00:35:49,619 --> 00:35:51,960
an attack gets detected if it generates

950
00:35:51,960 --> 00:35:55,200
at least five or seven events you can

951
00:35:55,200 --> 00:35:57,300
change that value so if you set that to

952
00:35:57,300 --> 00:35:59,760
really low you will have way more ship

953
00:35:59,760 --> 00:36:02,280
chains but you might also get generate

954
00:36:02,280 --> 00:36:04,200
way more noise in the other hand if you

955
00:36:04,200 --> 00:36:06,619
want to say I only want it to

956
00:36:06,619 --> 00:36:09,000
generate a kill change statistic if it

957
00:36:09,000 --> 00:36:11,520
has at least 10 events you might miss a

958
00:36:11,520 --> 00:36:12,780
lot of stuff so that's what I mean with

959
00:36:12,780 --> 00:36:13,859
tuning

960
00:36:13,859 --> 00:36:15,839
you might still need to tune it to your

961
00:36:15,839 --> 00:36:18,300
environment in my environment as I

962
00:36:18,300 --> 00:36:19,800
mentioned it's my environment so I have

963
00:36:19,800 --> 00:36:22,260
it in the control it's okay with the

964
00:36:22,260 --> 00:36:23,760
current settings

965
00:36:23,760 --> 00:36:25,560
um but what it really needs and this is

966
00:36:25,560 --> 00:36:28,260
the area of improvement is larger data

967
00:36:28,260 --> 00:36:29,579
sets and environments so if you have

968
00:36:29,579 --> 00:36:32,400
Google workspace uh please give it a try

969
00:36:32,400 --> 00:36:34,680
or if you have a client that you've done

970
00:36:34,680 --> 00:36:36,060
the investigation for and you still have

971
00:36:36,060 --> 00:36:37,980
the logs please load them in and test

972
00:36:37,980 --> 00:36:40,740
them more attacks there are definitely

973
00:36:40,740 --> 00:36:42,240
more attacks against Google workspace

974
00:36:42,240 --> 00:36:44,339
that can be tested

975
00:36:44,339 --> 00:36:46,619
um and when I started I mentioned event

976
00:36:46,619 --> 00:36:48,480
mapping so what I what we did was

977
00:36:48,480 --> 00:36:50,880
basically grab all events from the order

978
00:36:50,880 --> 00:36:52,859
log and try to map it to the miter

979
00:36:52,859 --> 00:36:55,680
phases well what if my miter decides to

980
00:36:55,680 --> 00:36:58,140
add more techniques we need to do redo

981
00:36:58,140 --> 00:37:00,060
the mapping or what if Google adds

982
00:37:00,060 --> 00:37:02,820
additional logging we need to add that

983
00:37:02,820 --> 00:37:05,099
mapping in so these are areas of

984
00:37:05,099 --> 00:37:08,839
improvement and I think it's continuous

985
00:37:09,300 --> 00:37:11,040
the most important slide is coming up

986
00:37:11,040 --> 00:37:12,660
right now

987
00:37:12,660 --> 00:37:15,180
and this is the too long didn't listen

988
00:37:15,180 --> 00:37:16,619
slide

989
00:37:16,619 --> 00:37:18,060
um just for everyone that was doing

990
00:37:18,060 --> 00:37:20,160
other stuff uh if you read this you

991
00:37:20,160 --> 00:37:21,660
should be up to speed a little bit on

992
00:37:21,660 --> 00:37:23,339
this presentation

993
00:37:23,339 --> 00:37:24,000
um

994
00:37:24,000 --> 00:37:26,099
so I think Google workspace is relevant

995
00:37:26,099 --> 00:37:28,800
uh because it's an entry part just like

996
00:37:28,800 --> 00:37:32,160
Microsoft 365 email is often an entry

997
00:37:32,160 --> 00:37:34,859
point for serious attacks so it's and

998
00:37:34,859 --> 00:37:36,359
Google workspace is going to grow

999
00:37:36,359 --> 00:37:37,859
because Google is behind it they're

1000
00:37:37,859 --> 00:37:39,420
going to invest in it and it will be

1001
00:37:39,420 --> 00:37:41,640
around for years it might change the

1002
00:37:41,640 --> 00:37:43,800
name again and again but it will still

1003
00:37:43,800 --> 00:37:45,180
be there

1004
00:37:45,180 --> 00:37:45,839
um

1005
00:37:45,839 --> 00:37:47,960
audit logging is on super important

1006
00:37:47,960 --> 00:37:50,880
Alpha is a tool that we developed and

1007
00:37:50,880 --> 00:37:52,920
it's available for free and I hope you

1008
00:37:52,920 --> 00:37:54,119
want to try it

1009
00:37:54,119 --> 00:37:56,220
and I would really appreciate your

1010
00:37:56,220 --> 00:37:58,740
feedback uh because we've developed this

1011
00:37:58,740 --> 00:38:02,520
in our little uh Echo chamber where

1012
00:38:02,520 --> 00:38:04,619
there might be other environments that

1013
00:38:04,619 --> 00:38:07,020
this skills very well to or maybe not so

1014
00:38:07,020 --> 00:38:10,460
please let me know

1015
00:38:10,800 --> 00:38:12,720
so if you want to help as I mentioned

1016
00:38:12,720 --> 00:38:15,420
the tool is on yeah the top link so

1017
00:38:15,420 --> 00:38:18,000
that's on our GitHub and the second link

1018
00:38:18,000 --> 00:38:20,040
is to the data set so I did all these

1019
00:38:20,040 --> 00:38:22,440
attacks I performed them and then I made

1020
00:38:22,440 --> 00:38:24,780
an export there's some very weird data

1021
00:38:24,780 --> 00:38:27,119
in it like because yeah I just needed to

1022
00:38:27,119 --> 00:38:28,980
come up with stuff and made a little bit

1023
00:38:28,980 --> 00:38:30,900
of a yeah all kinds of weird stuff but

1024
00:38:30,900 --> 00:38:32,579
I'll leave you to it

1025
00:38:32,579 --> 00:38:35,339
um I think I removed all IPS belonging

1026
00:38:35,339 --> 00:38:37,680
to me or other people that worked on the

1027
00:38:37,680 --> 00:38:40,200
project but if you find a one IP from

1028
00:38:40,200 --> 00:38:41,700
someone in the Netherlands please don't

1029
00:38:41,700 --> 00:38:45,180
those it that's my address probably

1030
00:38:45,180 --> 00:38:47,760
um there's also a YouTube link and this

1031
00:38:47,760 --> 00:38:50,220
is if you want to set it up you can just

1032
00:38:50,220 --> 00:38:51,660
follow this link and then I will show

1033
00:38:51,660 --> 00:38:55,020
you exactly how to do it and actually I

1034
00:38:55,020 --> 00:38:56,820
think in two minutes or maybe right now

1035
00:38:56,820 --> 00:38:59,640
there will be a post upon medium

1036
00:38:59,640 --> 00:39:02,280
on this link that will give you sort of

1037
00:39:02,280 --> 00:39:04,140
what I talked about today in a more text

1038
00:39:04,140 --> 00:39:06,300
format where you can just simply follow

1039
00:39:06,300 --> 00:39:08,339
all the steps and I will show you how to

1040
00:39:08,339 --> 00:39:10,500
use this tool with examples

1041
00:39:10,500 --> 00:39:11,700
etc etc

1042
00:39:11,700 --> 00:39:15,660
so please go there and check it out

1043
00:39:15,660 --> 00:39:18,000
we're almost there I have a challenge

1044
00:39:18,000 --> 00:39:19,380
for you

1045
00:39:19,380 --> 00:39:21,240
um it's pretty difficult to see for the

1046
00:39:21,240 --> 00:39:23,339
people online but who in this room uses

1047
00:39:23,339 --> 00:39:25,440
LinkedIn

1048
00:39:25,440 --> 00:39:28,140
that's pretty good well I had a goal at

1049
00:39:28,140 --> 00:39:29,339
the beginning of the year to have

1050
00:39:29,339 --> 00:39:31,320
thousands followers on LinkedIn because

1051
00:39:31,320 --> 00:39:33,359
I post a lot of stuff there

1052
00:39:33,359 --> 00:39:36,180
um I think I'm at 990 or something so I

1053
00:39:36,180 --> 00:39:38,520
hope at least 10 people online are here

1054
00:39:38,520 --> 00:39:41,640
can just click follow and then yeah I'll

1055
00:39:41,640 --> 00:39:43,500
have that go across stuff for this year

1056
00:39:43,500 --> 00:39:45,780
so please go ahead if you use LinkedIn I

1057
00:39:45,780 --> 00:39:47,460
won't do any sales purchase there but

1058
00:39:47,460 --> 00:39:49,740
I'll just post hopefully cool content

1059
00:39:49,740 --> 00:39:51,960
there so this is what the what the site

1060
00:39:51,960 --> 00:39:53,400
looks like

1061
00:39:53,400 --> 00:39:54,960
um I think we're the only one with this

1062
00:39:54,960 --> 00:39:58,820
specific name so should be easy to find

1063
00:39:58,920 --> 00:39:59,460
um

1064
00:39:59,460 --> 00:40:02,280
and then I'll open up the floor for the

1065
00:40:02,280 --> 00:40:04,200
next part of the challenge

1066
00:40:04,200 --> 00:40:06,960
um if you like this shirt or the white

1067
00:40:06,960 --> 00:40:08,520
version of it

1068
00:40:08,520 --> 00:40:10,740
um you can win one if you have a

1069
00:40:10,740 --> 00:40:12,240
question for me and I like the question

1070
00:40:12,240 --> 00:40:14,820
the best question you get a t-shirt it

1071
00:40:14,820 --> 00:40:16,800
doesn't matter I have small medium large

1072
00:40:16,800 --> 00:40:19,560
extra large everyone can have a t-shirt

1073
00:40:19,560 --> 00:40:21,420
that has a good question for the people

1074
00:40:21,420 --> 00:40:22,859
online you can still ask the question

1075
00:40:22,859 --> 00:40:25,140
but if Phil says it and I really like it

1076
00:40:25,140 --> 00:40:28,320
Phil gets a t-shirt so or Heather so uh

1077
00:40:28,320 --> 00:40:29,880
yeah this was what I wanted to share

1078
00:40:29,880 --> 00:40:31,650
with you and foreign

1079
00:40:31,650 --> 00:40:34,800
[Music]

