1
00:00:00,659 --> 00:00:02,960
foreign

2
00:00:07,700 --> 00:00:10,260
this is always such a treat for me to

3
00:00:10,260 --> 00:00:11,940
come out here and speak so I just want

4
00:00:11,940 --> 00:00:14,219
to say thank you for everybody uh this

5
00:00:14,219 --> 00:00:16,020
is a this is a just an amazing

6
00:00:16,020 --> 00:00:18,660
experience and meeting everybody here

7
00:00:18,660 --> 00:00:20,340
the Genesis of what I'm going to talk

8
00:00:20,340 --> 00:00:22,439
about really for the next half hour came

9
00:00:22,439 --> 00:00:24,480
out of of kind of what you know what

10
00:00:24,480 --> 00:00:28,140
Phil was talking about was

11
00:00:28,140 --> 00:00:30,779
approaching an investigation an incident

12
00:00:30,779 --> 00:00:32,399
investigation digital forensic

13
00:00:32,399 --> 00:00:33,899
investigation with with a clear

14
00:00:33,899 --> 00:00:38,040
objective what I saw is this kind of

15
00:00:38,040 --> 00:00:40,980
approach where people under a little bit

16
00:00:40,980 --> 00:00:42,719
of stress fall back to what they know

17
00:00:42,719 --> 00:00:46,100
right so if you come straight out of 572

18
00:00:46,100 --> 00:00:48,899
and you're handed an investigation your

19
00:00:48,899 --> 00:00:51,539
first uh first go-to is Give me the give

20
00:00:51,539 --> 00:00:53,160
me the uh netflow logs we're giving

21
00:00:53,160 --> 00:00:55,739
firewall logs or can we dump this into

22
00:00:55,739 --> 00:00:58,620
uh soft elk or something like that if

23
00:00:58,620 --> 00:01:00,180
you're really into memory forensics give

24
00:01:00,180 --> 00:01:01,739
me a memory image give me a memory image

25
00:01:01,739 --> 00:01:04,080
and really what we have is this this

26
00:01:04,080 --> 00:01:07,700
kind of rabbit hole that we go down into

27
00:01:07,700 --> 00:01:11,159
without any clear objective and we spend

28
00:01:11,159 --> 00:01:13,560
hours doing something and it's you know

29
00:01:13,560 --> 00:01:15,659
for lack of a better term sometimes the

30
00:01:15,659 --> 00:01:17,939
juice isn't really worth the squeeze

31
00:01:17,939 --> 00:01:19,560
before we get into that I'll just kind

32
00:01:19,560 --> 00:01:21,600
of give you a real quick rundown on on

33
00:01:21,600 --> 00:01:24,900
myself I'm a manager at uh Red Canary I

34
00:01:24,900 --> 00:01:27,720
run a team of incident handlers that are

35
00:01:27,720 --> 00:01:29,820
just absolute rock stars

36
00:01:29,820 --> 00:01:31,439
probably one of the best jobs at Red

37
00:01:31,439 --> 00:01:33,060
Canary because

38
00:01:33,060 --> 00:01:35,100
I just watched them work it's really

39
00:01:35,100 --> 00:01:37,799
great to have people that are smart

40
00:01:37,799 --> 00:01:40,140
came out of law enforcement years ago

41
00:01:40,140 --> 00:01:43,320
and again this is actually colored my

42
00:01:43,320 --> 00:01:46,020
approach to investigations because I I

43
00:01:46,020 --> 00:01:48,740
really had to look at at investigations

44
00:01:48,740 --> 00:01:52,079
both from a reactive critical component

45
00:01:52,079 --> 00:01:54,180
you know something that that needed some

46
00:01:54,180 --> 00:01:56,100
immediate attention to when I was a

47
00:01:56,100 --> 00:01:57,600
detective and later a federal agent

48
00:01:57,600 --> 00:02:00,659
where I had months to prepare a a

49
00:02:00,659 --> 00:02:02,420
full-on

50
00:02:02,420 --> 00:02:05,280
multi-prong with you know intelligence

51
00:02:05,280 --> 00:02:08,280
and digital forensics and interviews to

52
00:02:08,280 --> 00:02:11,038
to bring to Federal Court

53
00:02:11,038 --> 00:02:13,500
I'm originally from the East Coast I'm a

54
00:02:13,500 --> 00:02:15,360
New Yorker but I Live Now in Rapid City

55
00:02:15,360 --> 00:02:17,580
South Dakota which is is an interesting

56
00:02:17,580 --> 00:02:20,459
story if you ever want to hear it

57
00:02:20,459 --> 00:02:22,440
so where are we

58
00:02:22,440 --> 00:02:24,720
I said at the beginning the Genesis of

59
00:02:24,720 --> 00:02:26,580
this was kind of some observations over

60
00:02:26,580 --> 00:02:28,560
the last three or four years that I've

61
00:02:28,560 --> 00:02:32,160
seen but really what the Big Driver the

62
00:02:32,160 --> 00:02:34,800
main driver with us is we are going from

63
00:02:34,800 --> 00:02:36,980
initial foothold

64
00:02:36,980 --> 00:02:38,520
I.E

65
00:02:38,520 --> 00:02:41,099
execution of that initial piece of

66
00:02:41,099 --> 00:02:42,379
malware

67
00:02:42,379 --> 00:02:47,519
to Enterprise impact in about four hours

68
00:02:47,519 --> 00:02:49,739
this may be a Black Swan event kind of

69
00:02:49,739 --> 00:02:51,540
three standard deviations away from the

70
00:02:51,540 --> 00:02:54,180
mean but it really does give us an

71
00:02:54,180 --> 00:02:56,640
Insight of where ransomware attacks are

72
00:02:56,640 --> 00:02:59,099
going in terms of speed

73
00:02:59,099 --> 00:03:01,500
and that is something where we don't

74
00:03:01,500 --> 00:03:04,560
necessarily have the benefit of waiting

75
00:03:04,560 --> 00:03:07,140
8 to 12 hours for a full analysis of

76
00:03:07,140 --> 00:03:08,580
what is going on

77
00:03:08,580 --> 00:03:11,519
what we really need to do is step up and

78
00:03:11,519 --> 00:03:14,220
have critical pieces of information

79
00:03:14,220 --> 00:03:18,000
to our stakeholders as as judiciously I

80
00:03:18,000 --> 00:03:19,500
won't say rapidly but judiciously

81
00:03:19,500 --> 00:03:20,700
because we're going to balance things

82
00:03:20,700 --> 00:03:21,659
out

83
00:03:21,659 --> 00:03:23,940
so what I'm saying is with that full

84
00:03:23,940 --> 00:03:26,400
analysis is not going to be something

85
00:03:26,400 --> 00:03:27,900
that we can do we can get to good enough

86
00:03:27,900 --> 00:03:30,420
or we can do a portion of that analysis

87
00:03:30,420 --> 00:03:33,959
to meet some sort of objective

88
00:03:33,959 --> 00:03:36,300
that will bring us into another stage

89
00:03:36,300 --> 00:03:38,580
and another stage and another stage this

90
00:03:38,580 --> 00:03:40,980
way we can actually address the

91
00:03:40,980 --> 00:03:42,900
criticality here which is the speed of

92
00:03:42,900 --> 00:03:45,540
of our threat actors

93
00:03:45,540 --> 00:03:47,519
so what we need to do is is really kind

94
00:03:47,519 --> 00:03:50,340
of realign our incident response process

95
00:03:50,340 --> 00:03:53,159
in terms of Investigation along with

96
00:03:53,159 --> 00:03:57,360
other objectives to allow us some time

97
00:03:57,360 --> 00:03:59,280
to take care of the other things just

98
00:03:59,280 --> 00:04:03,019
outside of the the investigation

99
00:04:03,120 --> 00:04:05,760
what I'm talking about an analysis this

100
00:04:05,760 --> 00:04:07,920
is just a systemic approach

101
00:04:07,920 --> 00:04:11,580
to the data related to an incident

102
00:04:11,580 --> 00:04:14,640
or a detection we're analyzing that this

103
00:04:14,640 --> 00:04:16,079
is what we do this is the stock and

104
00:04:16,079 --> 00:04:18,000
trade of what we do here

105
00:04:18,000 --> 00:04:19,440
I always like to just throw a Gary

106
00:04:19,440 --> 00:04:20,820
Larson cartoon up there because he

107
00:04:20,820 --> 00:04:24,919
always had such fun ones especially cats

108
00:04:25,080 --> 00:04:26,699
but what are the challenges that we're

109
00:04:26,699 --> 00:04:28,740
facing right now sometimes it's a lack

110
00:04:28,740 --> 00:04:30,419
of a starting point as I said at the

111
00:04:30,419 --> 00:04:33,360
very beginning we often will revert to

112
00:04:33,360 --> 00:04:36,540
that which we are most comfortable with

113
00:04:36,540 --> 00:04:38,759
so if it's we're really good at log

114
00:04:38,759 --> 00:04:40,860
analysis we're going to ask for the logs

115
00:04:40,860 --> 00:04:43,139
if we're really good at

116
00:04:43,139 --> 00:04:45,479
uh pcap analysis we're going to see if

117
00:04:45,479 --> 00:04:47,759
they have a pcap good luck

118
00:04:47,759 --> 00:04:50,340
so oftentimes what this does is there's

119
00:04:50,340 --> 00:04:52,440
a mismatch of what we're looking for

120
00:04:52,440 --> 00:04:55,199
from an Evidence source and what our

121
00:04:55,199 --> 00:04:58,440
analysis goals really are and that's

122
00:04:58,440 --> 00:05:00,900
critical to understand because when we

123
00:05:00,900 --> 00:05:03,240
start to look at aligning these this is

124
00:05:03,240 --> 00:05:05,100
going to be crystallizing into a much

125
00:05:05,100 --> 00:05:07,800
more systemic approach

126
00:05:07,800 --> 00:05:09,419
one of the other things is we need to

127
00:05:09,419 --> 00:05:11,639
balance situational awareness and

128
00:05:11,639 --> 00:05:13,380
containment and isolation

129
00:05:13,380 --> 00:05:15,780
going back to that uh one of the first

130
00:05:15,780 --> 00:05:18,000
slides we talked about four hours from

131
00:05:18,000 --> 00:05:21,300
initial compromise all the way into full

132
00:05:21,300 --> 00:05:23,039
Enterprise impact

133
00:05:23,039 --> 00:05:26,340
so we have to get to good enough

134
00:05:26,340 --> 00:05:28,560
at the initial stages of an incident

135
00:05:28,560 --> 00:05:30,419
something hits you detection hits your

136
00:05:30,419 --> 00:05:32,220
desk we need to get to good enough and

137
00:05:32,220 --> 00:05:34,380
not a complete full high confidence

138
00:05:34,380 --> 00:05:37,560
picture of a root cause we need to get

139
00:05:37,560 --> 00:05:39,600
enough information and do stakeholders

140
00:05:39,600 --> 00:05:40,860
hands that they can start making

141
00:05:40,860 --> 00:05:44,220
decisions and start taking action within

142
00:05:44,220 --> 00:05:47,360
that couple of hours that we have

143
00:05:47,360 --> 00:05:50,220
we also have different stages of an

144
00:05:50,220 --> 00:05:51,720
incident response

145
00:05:51,720 --> 00:05:55,740
if you think back to say nist 861 a it's

146
00:05:55,740 --> 00:05:58,320
got its own instant response cycle Sans

147
00:05:58,320 --> 00:06:00,720
isn't a response cycle eu's got their

148
00:06:00,720 --> 00:06:02,340
own incident response cycle and how they

149
00:06:02,340 --> 00:06:04,080
approach this

150
00:06:04,080 --> 00:06:05,460
one of the things I've noticed

151
00:06:05,460 --> 00:06:07,080
specifically with nist because that's

152
00:06:07,080 --> 00:06:08,880
what I'm going to kind of align to right

153
00:06:08,880 --> 00:06:11,699
now is it really doesn't give us much

154
00:06:11,699 --> 00:06:14,340
guidance on hey what do we need to do

155
00:06:14,340 --> 00:06:16,080
from an analysis perspective it just

156
00:06:16,080 --> 00:06:17,759
says detection and Analysis stage and

157
00:06:17,759 --> 00:06:19,740
then you move on to the next thing

158
00:06:19,740 --> 00:06:22,560
so we need to match our Approach at

159
00:06:22,560 --> 00:06:24,660
different stages to get that information

160
00:06:24,660 --> 00:06:26,940
and take action just outside of the

161
00:06:26,940 --> 00:06:29,400
digital forensics Realm

162
00:06:29,400 --> 00:06:31,080
and here's the big one we have

163
00:06:31,080 --> 00:06:32,639
stakeholders

164
00:06:32,639 --> 00:06:34,680
internal and external each of them

165
00:06:34,680 --> 00:06:37,800
brings their own concern to Phil alluded

166
00:06:37,800 --> 00:06:38,639
to

167
00:06:38,639 --> 00:06:40,979
some of the questions that stakeholders

168
00:06:40,979 --> 00:06:42,600
are going to ask

169
00:06:42,600 --> 00:06:44,039
all right

170
00:06:44,039 --> 00:06:47,580
security manager security operations is

171
00:06:47,580 --> 00:06:48,840
this an incident

172
00:06:48,840 --> 00:06:51,000
is this truly an incident or is this a

173
00:06:51,000 --> 00:06:53,639
misconfiguration did somebody not cross

174
00:06:53,639 --> 00:06:54,780
off

175
00:06:54,780 --> 00:06:57,539
check box whatever is it a false

176
00:06:57,539 --> 00:06:58,500
positive

177
00:06:58,500 --> 00:07:00,720
is it benign behavior that looks like a

178
00:07:00,720 --> 00:07:02,220
malicious incident we need to understand

179
00:07:02,220 --> 00:07:03,900
this

180
00:07:03,900 --> 00:07:06,600
what is the impact

181
00:07:06,600 --> 00:07:09,539
how bad is this what is the breadth what

182
00:07:09,539 --> 00:07:12,539
is the width of this incident

183
00:07:12,539 --> 00:07:15,479
is it localized to a specific site or

184
00:07:15,479 --> 00:07:17,220
specific subnet

185
00:07:17,220 --> 00:07:19,860
or are we talking Enterprise is it a

186
00:07:19,860 --> 00:07:22,340
single system

187
00:07:22,500 --> 00:07:25,199
security manager network operations even

188
00:07:25,199 --> 00:07:26,699
desktop operations they're going to want

189
00:07:26,699 --> 00:07:28,860
to know this

190
00:07:28,860 --> 00:07:31,259
how did this happen

191
00:07:31,259 --> 00:07:33,840
how did this happen I thought we spent

192
00:07:33,840 --> 00:07:35,639
anybody ever hear this I thought we

193
00:07:35,639 --> 00:07:37,199
spent eight and a half gajillion dollars

194
00:07:37,199 --> 00:07:39,180
on all of this security hardware and we

195
00:07:39,180 --> 00:07:41,280
still got hacked how did this happen

196
00:07:41,280 --> 00:07:44,160
that's a really rough question to have

197
00:07:44,160 --> 00:07:46,919
and to have an answer for that is is

198
00:07:46,919 --> 00:07:48,479
going to be critical especially when

199
00:07:48,479 --> 00:07:50,220
you're talking the amount of money and

200
00:07:50,220 --> 00:07:51,900
the amount of time and resources that

201
00:07:51,900 --> 00:07:54,720
we've put into specifically addressing

202
00:07:54,720 --> 00:07:56,819
security concerns

203
00:07:56,819 --> 00:07:59,039
were we targeted

204
00:07:59,039 --> 00:08:01,440
maybe you know your internal

205
00:08:01,440 --> 00:08:02,819
stakeholders may be concerned about hey

206
00:08:02,819 --> 00:08:04,460
we're retargeted but let's look at

207
00:08:04,460 --> 00:08:06,720
Colonial pipeline for example I don't

208
00:08:06,720 --> 00:08:08,940
mean to pick on them but there were a

209
00:08:08,940 --> 00:08:11,400
lot of external stakeholders

210
00:08:11,400 --> 00:08:13,440
government law enforcement maybe

211
00:08:13,440 --> 00:08:16,800
intelligence that is interested in were

212
00:08:16,800 --> 00:08:19,500
they targeted or was this just a fluke

213
00:08:19,500 --> 00:08:21,780
Target of opportunity that somebody took

214
00:08:21,780 --> 00:08:26,340
it took advantage of while Global crisis

215
00:08:26,340 --> 00:08:29,099
were breaking out all over the place

216
00:08:29,099 --> 00:08:32,159
and then finally who did this maybe your

217
00:08:32,159 --> 00:08:33,659
organization doesn't do attribution

218
00:08:33,659 --> 00:08:37,260
analysis but there are there are that do

219
00:08:37,260 --> 00:08:39,059
I talked about external stakeholders

220
00:08:39,059 --> 00:08:41,039
like government law enforcement

221
00:08:41,039 --> 00:08:43,380
intelligence one of the other ones that

222
00:08:43,380 --> 00:08:45,120
really wants to know who did this as

223
00:08:45,120 --> 00:08:46,560
your insurance company because if they

224
00:08:46,560 --> 00:08:48,060
can tie it to a nation-state call it

225
00:08:48,060 --> 00:08:50,040
active War they don't have to pay rents

226
00:08:50,040 --> 00:08:51,300
or wear insurance

227
00:08:51,300 --> 00:08:54,660
so all of these factor into

228
00:08:54,660 --> 00:08:57,540
an analysis framework that we need to

229
00:08:57,540 --> 00:09:00,800
build to answer these questions

230
00:09:00,959 --> 00:09:03,000
so what is the solution what am I going

231
00:09:03,000 --> 00:09:04,860
to talk about really for the next 10-15

232
00:09:04,860 --> 00:09:07,500
minutes we are going to set

233
00:09:07,500 --> 00:09:09,839
an analysis objective that's going to

234
00:09:09,839 --> 00:09:12,300
drive our analysis approach so you think

235
00:09:12,300 --> 00:09:13,980
we have an objective

236
00:09:13,980 --> 00:09:16,320
this is how we're going to analyze our

237
00:09:16,320 --> 00:09:19,800
data to reach that objective

238
00:09:19,800 --> 00:09:21,240
that means we're going to align our

239
00:09:21,240 --> 00:09:23,040
investigative approach

240
00:09:23,040 --> 00:09:25,320
with that objective

241
00:09:25,320 --> 00:09:27,920
we're going to use tools and techniques

242
00:09:27,920 --> 00:09:30,959
and processes that allow us to reach

243
00:09:30,959 --> 00:09:32,880
that objective

244
00:09:32,880 --> 00:09:36,000
that's key so going back to you know

245
00:09:36,000 --> 00:09:37,980
jumping right into memory forensic jump

246
00:09:37,980 --> 00:09:39,600
writing into deadbox for instance now

247
00:09:39,600 --> 00:09:41,580
we're going to tailor our approach to

248
00:09:41,580 --> 00:09:43,560
meet that objective those other

249
00:09:43,560 --> 00:09:45,300
components memory forensics deadbox

250
00:09:45,300 --> 00:09:47,519
forensics log analysis all have their

251
00:09:47,519 --> 00:09:50,820
place in the overall scope of this but a

252
00:09:50,820 --> 00:09:52,860
different but at a later stage maybe

253
00:09:52,860 --> 00:09:55,560
than than earlier

254
00:09:55,560 --> 00:09:57,480
we're going to use people processes and

255
00:09:57,480 --> 00:09:59,640
Technology to answer those key questions

256
00:09:59,640 --> 00:10:01,500
we're going to align those to the

257
00:10:01,500 --> 00:10:02,580
objective

258
00:10:02,580 --> 00:10:04,860
so that we actually can answer those

259
00:10:04,860 --> 00:10:07,980
questions to the best of our ability

260
00:10:07,980 --> 00:10:10,019
one of the other things you'll see as we

261
00:10:10,019 --> 00:10:12,000
move forward with this is that at each

262
00:10:12,000 --> 00:10:14,519
stage we're going to determine whether

263
00:10:14,519 --> 00:10:16,080
or not we need to go any farther with

264
00:10:16,080 --> 00:10:17,580
our investigation

265
00:10:17,580 --> 00:10:19,440
as I said sometimes you just hit a

266
00:10:19,440 --> 00:10:21,300
roadblock or sometimes the you know if

267
00:10:21,300 --> 00:10:23,760
you're even a third party

268
00:10:23,760 --> 00:10:25,560
your third party provider and the

269
00:10:25,560 --> 00:10:26,820
customer says yeah we'll run out of

270
00:10:26,820 --> 00:10:29,339
hours we're going to stop here

271
00:10:29,339 --> 00:10:31,380
or they may say no we're going to need

272
00:10:31,380 --> 00:10:34,080
another another 80 hours a year time to

273
00:10:34,080 --> 00:10:37,220
figure out what's going on

274
00:10:39,420 --> 00:10:43,560
so do these stakeholder answers

275
00:10:43,560 --> 00:10:45,779
this is where we're going to get five

276
00:10:45,779 --> 00:10:49,140
different investigative analysis levels

277
00:10:49,140 --> 00:10:51,899
so when we're talking about is this an

278
00:10:51,899 --> 00:10:53,579
incident answering the is this an

279
00:10:53,579 --> 00:10:55,380
incident question we're going to look at

280
00:10:55,380 --> 00:10:57,420
an attack detection and Analysis

281
00:10:57,420 --> 00:10:59,899
framework

282
00:11:00,240 --> 00:11:03,180
what is the impact preliminary or if you

283
00:11:03,180 --> 00:11:06,680
want to say triage analysis

284
00:11:06,779 --> 00:11:09,360
when we look at coming up with a

285
00:11:09,360 --> 00:11:11,640
determination on on the sequence of

286
00:11:11,640 --> 00:11:14,040
events of how this occurred how did this

287
00:11:14,040 --> 00:11:14,880
happen

288
00:11:14,880 --> 00:11:16,320
this is where we're going to have our

289
00:11:16,320 --> 00:11:19,459
root cause analysis

290
00:11:20,040 --> 00:11:23,100
when we get to a targeting we're we

291
00:11:23,100 --> 00:11:24,720
targeted we're going to go into an

292
00:11:24,720 --> 00:11:26,459
intrusion analysis

293
00:11:26,459 --> 00:11:29,820
and then finally attribution analysis

294
00:11:29,820 --> 00:11:34,320
so these are our five investigative

295
00:11:34,320 --> 00:11:37,320
levels that we're going to Leverage

296
00:11:37,320 --> 00:11:40,640
to investigate an incident

297
00:11:40,800 --> 00:11:43,019
so let's go into a little bit in depth

298
00:11:43,019 --> 00:11:46,260
but the key here is we are tying each of

299
00:11:46,260 --> 00:11:48,240
these to a specific objective that we

300
00:11:48,240 --> 00:11:50,959
want to reach

301
00:11:52,380 --> 00:11:53,760
so there's really kind of four

302
00:11:53,760 --> 00:11:55,079
components that we're going to look at

303
00:11:55,079 --> 00:11:56,760
for each of these

304
00:11:56,760 --> 00:11:59,339
key objective again I've said objectives

305
00:11:59,339 --> 00:12:01,560
probably a million times already but

306
00:12:01,560 --> 00:12:04,019
that's the key here is an objective

307
00:12:04,019 --> 00:12:06,060
what we're focusing on from a tactical

308
00:12:06,060 --> 00:12:07,860
perspective what do the adversaries

309
00:12:07,860 --> 00:12:10,019
doing from a tactical perspective

310
00:12:10,019 --> 00:12:11,880
and then what are the people processing

311
00:12:11,880 --> 00:12:14,940
Technologies look like at each one of

312
00:12:14,940 --> 00:12:18,000
these levels the fourth component I want

313
00:12:18,000 --> 00:12:21,060
to talk about real quick is upper right

314
00:12:21,060 --> 00:12:23,880
I give you a time hack

315
00:12:23,880 --> 00:12:27,720
and I do this really to more align with

316
00:12:27,720 --> 00:12:31,740
what an objective should take

317
00:12:31,740 --> 00:12:34,019
without understanding the complexities

318
00:12:34,019 --> 00:12:35,220
of

319
00:12:35,220 --> 00:12:37,920
individual incidents so from a detection

320
00:12:37,920 --> 00:12:40,560
standpoint you may have a detection that

321
00:12:40,560 --> 00:12:42,240
takes you 10 15 minutes to work through

322
00:12:42,240 --> 00:12:44,700
and then either pass it up or call it a

323
00:12:44,700 --> 00:12:46,920
false positive

324
00:12:46,920 --> 00:12:49,139
or you may have one that goes an hour

325
00:12:49,139 --> 00:12:52,019
and a half the hour or less is really an

326
00:12:52,019 --> 00:12:54,480
objective it's not a hard and fast rule

327
00:12:54,480 --> 00:12:56,700
we have not written that in stone

328
00:12:56,700 --> 00:12:58,440
so

329
00:12:58,440 --> 00:13:00,480
when we get into putting this all

330
00:13:00,480 --> 00:13:01,800
together one of the things to understand

331
00:13:01,800 --> 00:13:04,079
is that's more of an objective than an

332
00:13:04,079 --> 00:13:06,300
agreement we do not write that in stone

333
00:13:06,300 --> 00:13:07,680
we just want to make that clear because

334
00:13:07,680 --> 00:13:09,240
sometimes people will get a little

335
00:13:09,240 --> 00:13:11,160
worked up saying that we can't do

336
00:13:11,160 --> 00:13:12,899
you know what about this type of

337
00:13:12,899 --> 00:13:14,639
incident May take us two hours that's

338
00:13:14,639 --> 00:13:17,700
absolutely absolutely fine because it's

339
00:13:17,700 --> 00:13:19,320
not something that we're writing in

340
00:13:19,320 --> 00:13:22,079
stone here so our detection analysis

341
00:13:22,079 --> 00:13:25,019
first stage

342
00:13:25,019 --> 00:13:29,160
two key questions is this an incident

343
00:13:29,160 --> 00:13:31,440
all right is this classified as a

344
00:13:31,440 --> 00:13:32,700
security incident according to our

345
00:13:32,700 --> 00:13:35,160
incident response process and procedures

346
00:13:35,160 --> 00:13:37,680
and does it need to be escalated

347
00:13:37,680 --> 00:13:39,300
that's it that's all we're going to do

348
00:13:39,300 --> 00:13:40,440
here

349
00:13:40,440 --> 00:13:44,519
and our focus of Investigation here is

350
00:13:44,519 --> 00:13:46,620
really around

351
00:13:46,620 --> 00:13:50,880
three main tactics initial access how

352
00:13:50,880 --> 00:13:52,200
did our adversary get into the

353
00:13:52,200 --> 00:13:53,700
environment was it Jane from payroll

354
00:13:53,700 --> 00:13:56,660
clicking on an email

355
00:13:57,240 --> 00:13:59,100
what did it look like from an execution

356
00:13:59,100 --> 00:14:01,680
path was there a macro involved that did

357
00:14:01,680 --> 00:14:03,899
it execute some sort of base64 encode a

358
00:14:03,899 --> 00:14:05,459
Powershell script downloading a second

359
00:14:05,459 --> 00:14:09,200
stage from a command and control server

360
00:14:09,200 --> 00:14:11,880
really what we're doing here is to say

361
00:14:11,880 --> 00:14:15,540
this behavior is indicative of malicious

362
00:14:15,540 --> 00:14:18,360
activity and it needs to be escalated

363
00:14:18,360 --> 00:14:20,040
so who's going to be responsible at this

364
00:14:20,040 --> 00:14:22,139
level security operations in the

365
00:14:22,139 --> 00:14:24,300
incident Response Team depending on how

366
00:14:24,300 --> 00:14:26,160
your organization or maybe you're a

367
00:14:26,160 --> 00:14:27,899
third party provider providing guidance

368
00:14:27,899 --> 00:14:29,339
on how to set up

369
00:14:29,339 --> 00:14:31,260
this type of construct it may be

370
00:14:31,260 --> 00:14:32,940
security operations maybe incident

371
00:14:32,940 --> 00:14:34,920
response

372
00:14:34,920 --> 00:14:37,320
from a process standpoint we're looking

373
00:14:37,320 --> 00:14:39,540
at how we handle our alerting and

374
00:14:39,540 --> 00:14:41,579
incident escalation processes and

375
00:14:41,579 --> 00:14:42,839
playbooks

376
00:14:42,839 --> 00:14:46,019
this is the focus here so we'll talk

377
00:14:46,019 --> 00:14:48,120
about aligning our playbooks to this in

378
00:14:48,120 --> 00:14:50,160
a second but this the playbooks can be

379
00:14:50,160 --> 00:14:51,839
fairly straightforward right now we

380
00:14:51,839 --> 00:14:53,279
don't have to go into too much depth

381
00:14:53,279 --> 00:14:54,660
they're really looking for three key

382
00:14:54,660 --> 00:14:56,399
things

383
00:14:56,399 --> 00:14:58,500
and from a technology standpoint we're

384
00:14:58,500 --> 00:15:01,440
focused either on endpoint detection

385
00:15:01,440 --> 00:15:04,860
maybe IPS IDs sensors

386
00:15:04,860 --> 00:15:07,019
all right we've had corelight here you

387
00:15:07,019 --> 00:15:08,279
know we've you know talking about

388
00:15:08,279 --> 00:15:10,620
cerakata and Zeke and and that kind of

389
00:15:10,620 --> 00:15:12,180
alerting maybe it's something that pops

390
00:15:12,180 --> 00:15:14,459
off of there they have a web proxy

391
00:15:14,459 --> 00:15:16,440
you know you've got some sort of uh web

392
00:15:16,440 --> 00:15:18,120
proxy that you know umbrella or

393
00:15:18,120 --> 00:15:19,740
something like that that kicks back in

394
00:15:19,740 --> 00:15:21,540
alerts saying this is a malicious domain

395
00:15:21,540 --> 00:15:24,120
something of that nature that's what

396
00:15:24,120 --> 00:15:27,180
you're using and you're going to be able

397
00:15:27,180 --> 00:15:28,620
to use those

398
00:15:28,620 --> 00:15:30,180
to make that uh to make that

399
00:15:30,180 --> 00:15:31,800
determination whether this needs to be

400
00:15:31,800 --> 00:15:33,899
escalated

401
00:15:33,899 --> 00:15:36,120
so let's say in in for sake of argument

402
00:15:36,120 --> 00:15:37,860
we've we've escalated this goes to a

403
00:15:37,860 --> 00:15:41,000
preliminary analysis

404
00:15:41,339 --> 00:15:43,260
this is where we're going to use maybe

405
00:15:43,260 --> 00:15:45,720
some triage to tools so sometimes you'll

406
00:15:45,720 --> 00:15:47,399
hear preliminary analysis I like to

407
00:15:47,399 --> 00:15:49,019
think of it as preliminary analysis if

408
00:15:49,019 --> 00:15:50,760
you want to say triage analysis that's

409
00:15:50,760 --> 00:15:52,800
that's perfectly acceptable

410
00:15:52,800 --> 00:15:55,980
here we're just trying to understand the

411
00:15:55,980 --> 00:15:57,480
scope of the incident for situational

412
00:15:57,480 --> 00:15:59,940
awareness and effective containment and

413
00:15:59,940 --> 00:16:02,339
I say effective containment and as you

414
00:16:02,339 --> 00:16:04,260
notice the time hack is kind of in line

415
00:16:04,260 --> 00:16:06,420
with what we're seeing from

416
00:16:06,420 --> 00:16:08,639
the macro level of threat actors going

417
00:16:08,639 --> 00:16:11,279
back to that that Diva report from April

418
00:16:11,279 --> 00:16:13,680
that showed four hours from initial

419
00:16:13,680 --> 00:16:15,959
foothold to compromise that's what we're

420
00:16:15,959 --> 00:16:17,519
trying to do here is tie that

421
00:16:17,519 --> 00:16:21,540
containment objective to that time hack

422
00:16:21,540 --> 00:16:24,019
again we're focused on initial access

423
00:16:24,019 --> 00:16:26,579
execution potentially privilege

424
00:16:26,579 --> 00:16:29,940
escalation or credential access lateral

425
00:16:29,940 --> 00:16:32,820
movement and command and control

426
00:16:32,820 --> 00:16:35,880
the objective here is to be able to have

427
00:16:35,880 --> 00:16:37,380
enough information to go to the network

428
00:16:37,380 --> 00:16:39,240
operations person

429
00:16:39,240 --> 00:16:42,480
or the CIO or whoever is in charge of

430
00:16:42,480 --> 00:16:44,160
running containment during an incident

431
00:16:44,160 --> 00:16:46,380
and say we have a threat actor they're

432
00:16:46,380 --> 00:16:48,060
coming in through email

433
00:16:48,060 --> 00:16:49,880
they executed a Powershell script

434
00:16:49,880 --> 00:16:52,740
downloaded a secondary payload

435
00:16:52,740 --> 00:16:54,959
they compromise some credentials a local

436
00:16:54,959 --> 00:16:56,339
admin account

437
00:16:56,339 --> 00:16:59,519
and they're using SMB to move laterally

438
00:16:59,519 --> 00:17:01,320
and this is the IP address for the

439
00:17:01,320 --> 00:17:03,720
command and control they can take that

440
00:17:03,720 --> 00:17:06,660
information now and execute in a a

441
00:17:06,660 --> 00:17:10,020
correction a containment strategy or

442
00:17:10,020 --> 00:17:11,400
just execute the containment that's

443
00:17:11,400 --> 00:17:13,140
within the incident response plan

444
00:17:13,140 --> 00:17:16,260
firewall rules Downing SMB

445
00:17:16,260 --> 00:17:18,599
maybe Downing certain land segments if

446
00:17:18,599 --> 00:17:19,919
you have to

447
00:17:19,919 --> 00:17:22,020
but it's really just driving that rapid

448
00:17:22,020 --> 00:17:23,939
containment

449
00:17:23,939 --> 00:17:25,859
again security operations and incident

450
00:17:25,859 --> 00:17:27,299
response are going to be primarily the

451
00:17:27,299 --> 00:17:29,040
ones that you're going to see doing this

452
00:17:29,040 --> 00:17:31,140
initial this may be that tier two

453
00:17:31,140 --> 00:17:33,419
incident Handler or incident response

454
00:17:33,419 --> 00:17:37,700
person that's actually taking this on

455
00:17:37,740 --> 00:17:40,320
triage analysis plans and playbooks

456
00:17:40,320 --> 00:17:42,960
again we're focused just strictly on on

457
00:17:42,960 --> 00:17:44,760
a limited scope here to get to that dry

458
00:17:44,760 --> 00:17:46,620
back containment

459
00:17:46,620 --> 00:17:48,299
so here's the big one remote evidence

460
00:17:48,299 --> 00:17:50,880
collection triage log and and your sim

461
00:17:50,880 --> 00:17:54,539
these are really handy in this regard

462
00:17:54,539 --> 00:17:57,900
because as we start to move

463
00:17:57,900 --> 00:18:00,660
further and further up

464
00:18:00,660 --> 00:18:03,179
we need this information in terms of of

465
00:18:03,179 --> 00:18:05,160
how to actually align this containment

466
00:18:05,160 --> 00:18:07,679
strategy and identify what's going on in

467
00:18:07,679 --> 00:18:10,280
the environment

468
00:18:13,140 --> 00:18:14,880
so here's the thing you get to

469
00:18:14,880 --> 00:18:18,539
containment now you have some room to

470
00:18:18,539 --> 00:18:19,799
breathe

471
00:18:19,799 --> 00:18:22,320
all right you're no longer bleeding you

472
00:18:22,320 --> 00:18:24,620
no longer under active active attack

473
00:18:24,620 --> 00:18:27,360
systems are are not getting compromised

474
00:18:27,360 --> 00:18:29,160
all over the place so really we have

475
00:18:29,160 --> 00:18:30,480
some we have a couple of seconds to

476
00:18:30,480 --> 00:18:33,360
catch our breath at this point

477
00:18:33,360 --> 00:18:34,860
more than likely you're going to move

478
00:18:34,860 --> 00:18:37,020
into a root cause analysis

479
00:18:37,020 --> 00:18:38,820
it's a special note

480
00:18:38,820 --> 00:18:40,620
prior to coming to Red Canary I worked

481
00:18:40,620 --> 00:18:42,960
for Cisco Systems on their IR team

482
00:18:42,960 --> 00:18:45,059
and one of the things that we were

483
00:18:45,059 --> 00:18:46,740
moving towards if you're a third party

484
00:18:46,740 --> 00:18:49,500
provider I'll throw this out here is if

485
00:18:49,500 --> 00:18:51,360
you can get your customer from that

486
00:18:51,360 --> 00:18:54,000
initial scoping call to containment you

487
00:18:54,000 --> 00:18:56,880
have some room the old methodology of

488
00:18:56,880 --> 00:18:59,280
saying okay we'll be there tomorrow

489
00:18:59,280 --> 00:19:02,039
12 hours from now and we'll start our

490
00:19:02,039 --> 00:19:03,299
work then

491
00:19:03,299 --> 00:19:05,220
just doesn't work anymore with this kind

492
00:19:05,220 --> 00:19:08,280
of Paradigm of Rapid uh rapid infection

493
00:19:08,280 --> 00:19:10,080
by the threat actor

494
00:19:10,080 --> 00:19:12,780
so generally a good way to structure

495
00:19:12,780 --> 00:19:14,280
this is to get them to containment in

496
00:19:14,280 --> 00:19:15,660
that first four hours and then you've

497
00:19:15,660 --> 00:19:17,340
got that wiggle room to get people on

498
00:19:17,340 --> 00:19:19,200
site to start pulling evidence and start

499
00:19:19,200 --> 00:19:21,059
doing your analysis from a root cause

500
00:19:21,059 --> 00:19:22,740
perspective

501
00:19:22,740 --> 00:19:24,720
what we're doing here

502
00:19:24,720 --> 00:19:27,780
is attempting to get as much information

503
00:19:27,780 --> 00:19:31,860
on how the adversary gained access

504
00:19:31,860 --> 00:19:33,539
what vulnerabilities they potentially

505
00:19:33,539 --> 00:19:35,400
leveraged whether it was poor security

506
00:19:35,400 --> 00:19:38,100
practices poor system hygiene

507
00:19:38,100 --> 00:19:40,320
whether they were using uh windows

508
00:19:40,320 --> 00:19:41,520
binaries

509
00:19:41,520 --> 00:19:44,220
or you know the dreaded zero day that's

510
00:19:44,220 --> 00:19:45,840
what we're trying to do here from a root

511
00:19:45,840 --> 00:19:48,660
cause analysis the objective of the root

512
00:19:48,660 --> 00:19:51,179
cause analysis is to give that analysis

513
00:19:51,179 --> 00:19:52,320
to

514
00:19:52,320 --> 00:19:54,480
I.T Personnel whether that's the network

515
00:19:54,480 --> 00:19:56,580
architect endpoint

516
00:19:56,580 --> 00:19:59,400
network operations so that they can move

517
00:19:59,400 --> 00:20:01,679
into eradication and Recovery

518
00:20:01,679 --> 00:20:03,660
so they can correct those deficiencies

519
00:20:03,660 --> 00:20:05,640
that we found in the root cause analysis

520
00:20:05,640 --> 00:20:08,580
and build build to use a phrase build

521
00:20:08,580 --> 00:20:11,640
back better so to speak

522
00:20:11,640 --> 00:20:13,380
we're going to use the entire miter

523
00:20:13,380 --> 00:20:15,360
attack framework here the whole Spectrum

524
00:20:15,360 --> 00:20:17,580
super nuts we want to get as clear a

525
00:20:17,580 --> 00:20:18,539
picture

526
00:20:18,539 --> 00:20:21,240
the focus though is not on the adversary

527
00:20:21,240 --> 00:20:24,080
it focuses on our internal Enterprise

528
00:20:24,080 --> 00:20:27,480
architecture our internal uh structure

529
00:20:27,480 --> 00:20:29,820
to make it better so that we're more

530
00:20:29,820 --> 00:20:32,039
resilient to this type of attack

531
00:20:32,039 --> 00:20:34,620
this is also a whole you know handy to

532
00:20:34,620 --> 00:20:37,380
know as you start to to go farther down

533
00:20:37,380 --> 00:20:39,660
into correcting these and eradicating

534
00:20:39,660 --> 00:20:41,460
and Recovery one of the key decisions

535
00:20:41,460 --> 00:20:43,620
right from eradication standpoint

536
00:20:43,620 --> 00:20:46,140
do we pull back nuke it from orbit

537
00:20:46,140 --> 00:20:48,419
or are we comfortable going through each

538
00:20:48,419 --> 00:20:50,039
individual machine and removing the

539
00:20:50,039 --> 00:20:52,380
schedule task that it wrong removing the

540
00:20:52,380 --> 00:20:54,960
binaries putting a new policy in place

541
00:20:54,960 --> 00:20:57,660
on our EDR tool that one of those key

542
00:20:57,660 --> 00:21:00,360
decisions this analysis feeds right into

543
00:21:00,360 --> 00:21:02,100
that

544
00:21:02,100 --> 00:21:03,600
you may see

545
00:21:03,600 --> 00:21:06,179
intrusion analysts work in this this

546
00:21:06,179 --> 00:21:08,580
kind of tier three maybe

547
00:21:08,580 --> 00:21:10,919
digital forensics is is obviously those

548
00:21:10,919 --> 00:21:12,480
key people same thing with incident

549
00:21:12,480 --> 00:21:14,039
responders

550
00:21:14,039 --> 00:21:16,140
this is where you're going to see

551
00:21:16,140 --> 00:21:18,720
digital forensics play much much more of

552
00:21:18,720 --> 00:21:22,679
a deeper role so for example we talked

553
00:21:22,679 --> 00:21:24,000
earlier about jumping into memory

554
00:21:24,000 --> 00:21:25,799
analysis this is where memory analysis

555
00:21:25,799 --> 00:21:28,740
may come in exceptionally handy to

556
00:21:28,740 --> 00:21:31,320
understand how the malware actually

557
00:21:31,320 --> 00:21:34,440
behaved how it actually maybe process

558
00:21:34,440 --> 00:21:36,179
injection or something of that nature

559
00:21:36,179 --> 00:21:38,700
that's where we're going to get the best

560
00:21:38,700 --> 00:21:41,220
information is here

561
00:21:41,220 --> 00:21:42,720
so we're going to use the full scope of

562
00:21:42,720 --> 00:21:44,100
tools and techniques that are available

563
00:21:44,100 --> 00:21:47,340
to us nothing's off the table

564
00:21:47,340 --> 00:21:49,559
again it's important to know the reason

565
00:21:49,559 --> 00:21:51,419
that we can use the full spectrum of

566
00:21:51,419 --> 00:21:53,640
tools and take our time here is we have

567
00:21:53,640 --> 00:21:55,559
contained the incident and we may be

568
00:21:55,559 --> 00:21:58,380
already moving towards an eradication

569
00:21:58,380 --> 00:22:00,360
but we have to make sure that we stop

570
00:22:00,360 --> 00:22:02,220
the bleeding before we start really

571
00:22:02,220 --> 00:22:04,500
going in detail and taking 48 hours to

572
00:22:04,500 --> 00:22:07,460
come up with a root cause

573
00:22:10,919 --> 00:22:12,840
so let's say we we go ahead and execute

574
00:22:12,840 --> 00:22:15,659
our eradication recovery plan here comes

575
00:22:15,659 --> 00:22:17,159
a decision point

576
00:22:17,159 --> 00:22:19,440
do we want to go any further

577
00:22:19,440 --> 00:22:21,299
or are we happy with the root cause

578
00:22:21,299 --> 00:22:23,039
analysis

579
00:22:23,039 --> 00:22:25,380
if it's if it's

580
00:22:25,380 --> 00:22:29,039
option A we need to go further here it

581
00:22:29,039 --> 00:22:31,140
is this is an intrusion analysis so if

582
00:22:31,140 --> 00:22:33,240
you think of root cause Focus entirely

583
00:22:33,240 --> 00:22:36,059
on us the organization whether we're a

584
00:22:36,059 --> 00:22:37,559
third party provider or whether we're

585
00:22:37,559 --> 00:22:38,940
in-house

586
00:22:38,940 --> 00:22:41,220
we're still focusing on

587
00:22:41,220 --> 00:22:43,380
that root cause piece but now we're

588
00:22:43,380 --> 00:22:46,440
looking at the adversary as well what

589
00:22:46,440 --> 00:22:48,000
did they do from an infrastructure

590
00:22:48,000 --> 00:22:49,860
standpoint what kind of capabilities do

591
00:22:49,860 --> 00:22:54,179
they have why did they target us

592
00:22:54,179 --> 00:22:56,520
we are trying to get to an in-depth

593
00:22:56,520 --> 00:23:00,120
knowledge of the adversary's ttps

594
00:23:00,120 --> 00:23:02,340
one to determine if this was a targeted

595
00:23:02,340 --> 00:23:05,700
attack and two what their objective was

596
00:23:05,700 --> 00:23:07,580
so again we might have a simple

597
00:23:07,580 --> 00:23:09,960
ransomware as a service attack we won't

598
00:23:09,960 --> 00:23:12,299
go into this but if we uncover something

599
00:23:12,299 --> 00:23:14,220
that we can kind of tie back to two or

600
00:23:14,220 --> 00:23:16,799
three four months of activity and they

601
00:23:16,799 --> 00:23:18,419
were gaining access to confidential

602
00:23:18,419 --> 00:23:20,220
research and development

603
00:23:20,220 --> 00:23:22,559
this might be the option that we have to

604
00:23:22,559 --> 00:23:24,720
go into we have to know exactly what

605
00:23:24,720 --> 00:23:26,700
they were after why they were after it

606
00:23:26,700 --> 00:23:28,740
all of those kind of questions that are

607
00:23:28,740 --> 00:23:30,840
coming from maybe at this point senior

608
00:23:30,840 --> 00:23:32,280
leadership and some of those external

609
00:23:32,280 --> 00:23:33,720
stakeholders

610
00:23:33,720 --> 00:23:36,120
as a result we're using the full miter

611
00:23:36,120 --> 00:23:38,760
attack spectrum of tactics and

612
00:23:38,760 --> 00:23:41,220
techniques to get as deep as we can into

613
00:23:41,220 --> 00:23:44,400
what the adversary actually did

614
00:23:44,400 --> 00:23:46,679
so when we're looking at this we've got

615
00:23:46,679 --> 00:23:49,919
intrusion analysts again that tier three

616
00:23:49,919 --> 00:23:53,039
some incident responders at that level

617
00:23:53,039 --> 00:23:55,559
other defer Personnel one of the things

618
00:23:55,559 --> 00:23:58,260
that you might want to consider is this

619
00:23:58,260 --> 00:24:00,299
is where you might throw in say a senior

620
00:24:00,299 --> 00:24:03,659
or a principal analyst somebody with a

621
00:24:03,659 --> 00:24:06,299
little bit more experience to get deep

622
00:24:06,299 --> 00:24:08,159
deep deep into what this adversary

623
00:24:08,159 --> 00:24:09,659
actually did

624
00:24:09,659 --> 00:24:11,820
from a process standpoint

625
00:24:11,820 --> 00:24:14,460
you may have your own but the combined

626
00:24:14,460 --> 00:24:16,740
kill chain Diamond analysis model or or

627
00:24:16,740 --> 00:24:18,659
with some cyber threat intelligence

628
00:24:18,659 --> 00:24:21,480
thrown in for augmenting and enhancing

629
00:24:21,480 --> 00:24:25,080
what you're doing and what you've found

630
00:24:25,080 --> 00:24:26,940
as a process that would give you the

631
00:24:26,940 --> 00:24:29,039
best kind of lattice structure to build

632
00:24:29,039 --> 00:24:31,559
and start inserting these iocs and and

633
00:24:31,559 --> 00:24:35,178
other indicators in in there

634
00:24:35,220 --> 00:24:36,840
other tools we're going to use that full

635
00:24:36,840 --> 00:24:38,700
Suite of D for tools

636
00:24:38,700 --> 00:24:40,559
but we're also going to pull in CTI

637
00:24:40,559 --> 00:24:42,840
correlation so we may have commercial

638
00:24:42,840 --> 00:24:44,520
ocean

639
00:24:44,520 --> 00:24:47,700
maybe internal to augment and enhance

640
00:24:47,700 --> 00:24:49,500
that intelligence that we're we're

641
00:24:49,500 --> 00:24:53,360
finding through this investigation

642
00:24:55,080 --> 00:24:57,179
and then finally attribution analysis

643
00:24:57,179 --> 00:24:58,980
this is something you're probably not

644
00:24:58,980 --> 00:25:00,840
going to do in your own organization

645
00:25:00,840 --> 00:25:02,520
maybe you do maybe don't if you're a

646
00:25:02,520 --> 00:25:03,900
third party provider maybe it is

647
00:25:03,900 --> 00:25:05,159
something that you do

648
00:25:05,159 --> 00:25:08,039
you do maybe you have a relationship

649
00:25:08,039 --> 00:25:11,640
with an external external stakeholder

650
00:25:11,640 --> 00:25:13,380
um I don't know maybe show hands how

651
00:25:13,380 --> 00:25:14,940
many of you worked a case where they

652
00:25:14,940 --> 00:25:17,039
call the FBI and the FBI said hey we

653
00:25:17,039 --> 00:25:19,020
want your iscs or we want we want a full

654
00:25:19,020 --> 00:25:20,580
copy of your report because we're going

655
00:25:20,580 --> 00:25:22,140
to do we're going to compare it with

656
00:25:22,140 --> 00:25:23,580
something else

657
00:25:23,580 --> 00:25:25,500
that's something that may happen when

658
00:25:25,500 --> 00:25:27,480
we're talking attribution analysis there

659
00:25:27,480 --> 00:25:29,760
we're tying this intrusion to a larger

660
00:25:29,760 --> 00:25:33,539
data set or campaign so that's all we're

661
00:25:33,539 --> 00:25:36,360
doing here with an attribution analysis

662
00:25:36,360 --> 00:25:38,700
again we're tying in full tactics and

663
00:25:38,700 --> 00:25:41,880
techniques across the Spectrum we're

664
00:25:41,880 --> 00:25:44,820
we're not going to leave any aside here

665
00:25:44,820 --> 00:25:46,919
we want absolutely everything that we

666
00:25:46,919 --> 00:25:48,419
can get

667
00:25:48,419 --> 00:25:50,340
same people that we saw with an

668
00:25:50,340 --> 00:25:53,159
intrusion analysis but in this we may be

669
00:25:53,159 --> 00:25:54,840
pulling in cyber threat intelligence

670
00:25:54,840 --> 00:25:58,200
practitioners this may be third party uh

671
00:25:58,200 --> 00:26:00,779
providers that you have maybe internal

672
00:26:00,779 --> 00:26:03,000
other stakeholders may have their own

673
00:26:03,000 --> 00:26:05,340
intelligence Personnel that are there to

674
00:26:05,340 --> 00:26:07,380
take this data and combine it with other

675
00:26:07,380 --> 00:26:11,039
data sets from potentially other victims

676
00:26:11,039 --> 00:26:12,779
again we're looking at a kill chain

677
00:26:12,779 --> 00:26:14,520
Diamond model analysis where link

678
00:26:14,520 --> 00:26:17,240
analysis we're putting this all together

679
00:26:17,240 --> 00:26:19,860
and the only real change is we may be

680
00:26:19,860 --> 00:26:21,539
using some link analysis tools like a

681
00:26:21,539 --> 00:26:24,299
threat intelligence platform

682
00:26:24,299 --> 00:26:27,600
so we've got these five levels and from

683
00:26:27,600 --> 00:26:29,820
a visual I'm a visual person that's why

684
00:26:29,820 --> 00:26:32,159
I like visual this is what we can

685
00:26:32,159 --> 00:26:33,659
actually have

686
00:26:33,659 --> 00:26:35,580
that nist model

687
00:26:35,580 --> 00:26:38,159
augmented with setting those clear

688
00:26:38,159 --> 00:26:40,559
objectives so if we look at this

689
00:26:40,559 --> 00:26:43,140
specifically we can see that detection

690
00:26:43,140 --> 00:26:45,779
analysis gets us into the analysis stage

691
00:26:45,779 --> 00:26:48,900
of the incident response process

692
00:26:48,900 --> 00:26:51,360
that preliminary analysis drives us to

693
00:26:51,360 --> 00:26:53,220
containment we've got data to start

694
00:26:53,220 --> 00:26:55,020
containing this incident

695
00:26:55,020 --> 00:26:57,720
we can then pull in additional resources

696
00:26:57,720 --> 00:27:00,240
for a root cause analysis

697
00:27:00,240 --> 00:27:03,059
gives that information to eradicate and

698
00:27:03,059 --> 00:27:06,600
remove and recover from the incident

699
00:27:06,600 --> 00:27:08,880
and then if necessary we can get into

700
00:27:08,880 --> 00:27:10,820
intrusion analysis to give us

701
00:27:10,820 --> 00:27:13,919
post-incident activity

702
00:27:13,919 --> 00:27:17,460
and then finally long term into say

703
00:27:17,460 --> 00:27:18,900
cyber threat intelligence reporting

704
00:27:18,900 --> 00:27:20,940
we're moving into an attribution

705
00:27:20,940 --> 00:27:22,799
analysis

706
00:27:22,799 --> 00:27:24,900
so this is just adding on to that

707
00:27:24,900 --> 00:27:27,600
construct no real changes per se but

708
00:27:27,600 --> 00:27:30,779
really tying each of these levels into

709
00:27:30,779 --> 00:27:32,220
an objective

710
00:27:32,220 --> 00:27:34,559
that will guide us through that entire

711
00:27:34,559 --> 00:27:37,100
process

712
00:27:38,460 --> 00:27:40,320
so to kind of wrap up where we are how

713
00:27:40,320 --> 00:27:42,539
do we put this all together

714
00:27:42,539 --> 00:27:44,340
so we're looking at this as a phased

715
00:27:44,340 --> 00:27:46,140
approach this doesn't mean we toss out

716
00:27:46,140 --> 00:27:48,720
anything all we're doing is realigning

717
00:27:48,720 --> 00:27:51,900
what we already do and do very well

718
00:27:51,900 --> 00:27:54,900
into a specific objective

719
00:27:54,900 --> 00:27:57,480
we are also able to translate those

720
00:27:57,480 --> 00:27:59,640
stakeholder concerns into analysis

721
00:27:59,640 --> 00:28:02,100
objectives so for example

722
00:28:02,100 --> 00:28:04,620
really good way to do this is on that

723
00:28:04,620 --> 00:28:05,880
scoping call where you're trying to

724
00:28:05,880 --> 00:28:08,039
figure out the the width and and breadth

725
00:28:08,039 --> 00:28:12,059
depth of this issue and that individual

726
00:28:12,059 --> 00:28:14,520
on the C Suite says hey

727
00:28:14,520 --> 00:28:17,460
who did this or how did this happen

728
00:28:17,460 --> 00:28:19,080
you can say we're going to get to that

729
00:28:19,080 --> 00:28:21,539
right now we're focused on objective one

730
00:28:21,539 --> 00:28:24,600
which is containment once we get to a

731
00:28:24,600 --> 00:28:26,940
root cause analysis we'll be able to to

732
00:28:26,940 --> 00:28:28,919
start providing you information for

733
00:28:28,919 --> 00:28:30,840
eradication and Recovery

734
00:28:30,840 --> 00:28:33,299
so we're taking those stakeholder

735
00:28:33,299 --> 00:28:34,980
concerns and We're translating them into

736
00:28:34,980 --> 00:28:36,659
objectives and tying them to specific

737
00:28:36,659 --> 00:28:38,580
sets of the investigation helps us

738
00:28:38,580 --> 00:28:40,559
answer those questions

739
00:28:40,559 --> 00:28:42,659
align detective controls and evidence

740
00:28:42,659 --> 00:28:44,640
sources with objectives uh Shelly

741
00:28:44,640 --> 00:28:47,460
giesbricht from crowdstrike just did a

742
00:28:47,460 --> 00:28:48,900
track two discussion earlier this

743
00:28:48,900 --> 00:28:51,059
morning on this very topic and I think

744
00:28:51,059 --> 00:28:54,299
it was very timely is aligning the

745
00:28:54,299 --> 00:28:55,919
detective controls and evidence sources

746
00:28:55,919 --> 00:28:58,559
with our objectives

747
00:28:58,559 --> 00:29:00,840
you may not be able to get a spend for

748
00:29:00,840 --> 00:29:02,400
tools to help you in an intrusion

749
00:29:02,400 --> 00:29:03,779
analysis

750
00:29:03,779 --> 00:29:05,760
so you can basically say we don't we

751
00:29:05,760 --> 00:29:07,140
don't have that capability but we can

752
00:29:07,140 --> 00:29:08,820
align our tool set we can align our

753
00:29:08,820 --> 00:29:10,320
techniques and our playbooks to get us

754
00:29:10,320 --> 00:29:13,260
at least to root cause

755
00:29:13,260 --> 00:29:15,299
this goes into incident response

756
00:29:15,299 --> 00:29:17,039
Frameworks your incident response plan

757
00:29:17,039 --> 00:29:19,980
can actually be defined along this you

758
00:29:19,980 --> 00:29:21,360
know if you want to steal that diagram

759
00:29:21,360 --> 00:29:23,220
to kind of help

760
00:29:23,220 --> 00:29:26,520
more power to you what this does is it

761
00:29:26,520 --> 00:29:28,740
basically delineates at which stage you

762
00:29:28,740 --> 00:29:31,500
are in the incident response cycle so

763
00:29:31,500 --> 00:29:33,000
you can get to

764
00:29:33,000 --> 00:29:35,279
root cause analysis finish that and you

765
00:29:35,279 --> 00:29:37,320
say we are now eradication and recovery

766
00:29:37,320 --> 00:29:39,179
and we are now moving into

767
00:29:39,179 --> 00:29:42,960
uh reporting out what we have

768
00:29:42,960 --> 00:29:44,940
one of the other things here

769
00:29:44,940 --> 00:29:47,940
is a focus on the tactics in the IR

770
00:29:47,940 --> 00:29:51,720
playbooks is now we can actually have

771
00:29:51,720 --> 00:29:54,899
specific statements such as we use

772
00:29:54,899 --> 00:29:58,799
we use uh you know this tool say

773
00:29:58,799 --> 00:30:00,899
Microsoft Defender for endpoint we use

774
00:30:00,899 --> 00:30:03,480
their capability for acquiring evidence

775
00:30:03,480 --> 00:30:05,460
and this is the output that we're

776
00:30:05,460 --> 00:30:07,320
looking for and this is what we're

777
00:30:07,320 --> 00:30:09,299
trying to do with it so finding that

778
00:30:09,299 --> 00:30:10,500
execution

779
00:30:10,500 --> 00:30:14,520
or we use uh surakata as as our primary

780
00:30:14,520 --> 00:30:16,740
detection mechanism and we augment that

781
00:30:16,740 --> 00:30:20,580
with selected pcap analysis to identify

782
00:30:20,580 --> 00:30:22,980
command and control

783
00:30:22,980 --> 00:30:25,440
really this is a construct that you can

784
00:30:25,440 --> 00:30:28,500
start building out specific elements

785
00:30:28,500 --> 00:30:31,020
and really tie what you're doing to an

786
00:30:31,020 --> 00:30:33,120
objective this doesn't

787
00:30:33,120 --> 00:30:35,760
toss out any tools or techniques it

788
00:30:35,760 --> 00:30:37,440
doesn't do anything of that nature what

789
00:30:37,440 --> 00:30:39,179
it does is it puts these in the right

790
00:30:39,179 --> 00:30:41,700
context with the right objective at the

791
00:30:41,700 --> 00:30:44,580
right time so that you can actually

792
00:30:44,580 --> 00:30:47,460
service better your customer

793
00:30:47,460 --> 00:30:49,740
those stakeholders that need that that

794
00:30:49,740 --> 00:30:52,440
critical information

795
00:30:52,440 --> 00:30:53,680
so with that

796
00:30:53,680 --> 00:30:58,819
[Applause]

