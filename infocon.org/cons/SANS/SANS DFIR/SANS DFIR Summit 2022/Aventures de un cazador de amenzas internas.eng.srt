1
00:00:05,400 --> 00:00:07,140
very very good thank you very much for the

2
00:00:07,140 --> 00:00:09,780
invitation it's sans's 15th birthday it's a

3
00:00:09,780 --> 00:00:11,400
pleasure to be here to come and talk a

4
00:00:11,400 --> 00:00:13,860
little bit about internal

5
00:00:13,860 --> 00:00:16,020
threats we call you here in English in I hope

6
00:00:16,020 --> 00:00:17,820
you like the talk it's a little

7
00:00:17,820 --> 00:00:20,220
dense I'm going to share everything  the deck but

8
00:00:20,220 --> 00:00:22,320
I'm going to cut some parts due to

9
00:00:22,320 --> 00:00:24,539
time but here I am at your disposal

10
00:00:24,539 --> 00:00:26,460
to talk with you it shows that

11
00:00:26,460 --> 00:00:28,140
you are ready and it shows that you have a lot

12
00:00:28,140 --> 00:00:31,520
to talk about so well I'll leave you so

13
00:00:31,520 --> 00:00:33,480
start start and I'll see you for a little while

14
00:00:33,480 --> 00:00:36,000
Until  soon perfect Thank you Hello how are

15
00:00:36,000 --> 00:00:37,800
you all Well this talk is a

16
00:00:37,800 --> 00:00:39,239
little dense I'm going to try to do it

17
00:00:39,239 --> 00:00:41,760
quickly the topic of insiders is quite

18
00:00:41,760 --> 00:00:44,100
broad and big we are going to talk a

19
00:00:44,100 --> 00:00:45,660
little about me we are going to talk about

20
00:00:45,660 --> 00:00:47,820
what are the insider threats the guys

21
00:00:47,820 --> 00:00:50,579
the importance  some examples of them

22
00:00:50,579 --> 00:00:52,739
later we are going to talk a little about

23
00:00:52,739 --> 00:00:54,960
the phases of insider threats and I

24
00:00:54,960 --> 00:00:57,120
am going to show you how I am going to present

25
00:00:57,120 --> 00:01:02,059
something that I call la la lands Psycho

26
00:01:02,059 --> 00:01:04,559
lo v  Let's see, I'm going to teach you how to

27
00:01:04,559 --> 00:01:06,020
create

28
00:01:06,020 --> 00:01:09,420
valuable insides so that you can do your three

29
00:01:09,420 --> 00:01:11,460
internal hunts. I'm going to talk a

30
00:01:11,460 --> 00:01:12,960
little about the obsidian project, which

31
00:01:12,960 --> 00:01:15,000
is what I used to generate the

32
00:01:15,000 --> 00:01:16,320
Torrejón examples and what I'm going to

33
00:01:16,320 --> 00:01:18,240
teach you and from there we'll  see us in the

34
00:01:18,240 --> 00:01:20,640
final grades

35
00:01:20,640 --> 00:01:22,860
well about me my name is Carlos

36
00:01:22,860 --> 00:01:26,100
But everyone knows me as a plug in my

37
00:01:26,100 --> 00:01:28,020
free time as a doctor how to

38
00:01:28,020 --> 00:01:31,320
volunteer for various things And well I

39
00:01:31,320 --> 00:01:33,060
like synthesizers and

40
00:01:33,060 --> 00:01:36,840
drum machines well they are internal threats

41
00:01:36,840 --> 00:01:39,360
to understand the  Insider threats It

42
00:01:39,360 --> 00:01:41,159
is important to first understand

43
00:01:41,159 --> 00:01:43,020
what an insider is, what the

44
00:01:43,020 --> 00:01:45,960
interested parties are, and well, a person or an

45
00:01:45,960 --> 00:01:47,220
insider. An interested person is

46
00:01:47,220 --> 00:01:49,799
any person who has or has had

47
00:01:49,799 --> 00:01:53,280
access to authorized or knowledge of

48
00:01:53,280 --> 00:01:54,500
the resources of an organization,

49
00:01:54,500 --> 00:01:57,780
including personnel, facilities,

50
00:01:57,780 --> 00:02:01,500
information.  equipment networks

51
00:02:01,500 --> 00:02:05,460
systems now inside 3 what are

52
00:02:05,460 --> 00:02:07,500
internal threats the topic we are going to

53
00:02:07,500 --> 00:02:08,119
talk about

54
00:02:08,119 --> 00:02:11,700
is defined by  The

55
00:02:11,700 --> 00:02:15,560
threat of an insider

56
00:02:15,560 --> 00:02:19,379
knowingly or unknowingly using their authorized access

57
00:02:19,379 --> 00:02:22,140
to harm your

58
00:02:22,140 --> 00:02:25,500
organization's resources, personnel,

59
00:02:25,500 --> 00:02:27,959
facilities, information,

60
00:02:27,959 --> 00:02:31,500
equipment, networks, etc.

61
00:02:31,500 --> 00:02:34,080
Now there are several types of

62
00:02:34,080 --> 00:02:36,120
insider threats and they manifest themselves in different

63
00:02:36,120 --> 00:02:38,480
ways, one of  They are through espionage,

64
00:02:38,480 --> 00:02:41,300
terrorism and sabotage, corruption,

65
00:02:41,300 --> 00:02:44,580
violence at work,

66
00:02:44,580 --> 00:02:47,580
unauthorized disclosure of information,

67
00:02:47,580 --> 00:02:49,620
intentional or unintentional loss or degradation

68
00:02:49,620 --> 00:02:52,140
of resources or capabilities.

69
00:02:52,140 --> 00:02:55,080
Now it is important to understand

70
00:02:55,080 --> 00:02:57,360
internal threats to know that there are types of

71
00:02:57,360 --> 00:03:00,480
internal threats and, in general, they are

72
00:03:00,480 --> 00:03:01,860
classified into  They have four

73
00:03:01,860 --> 00:03:04,200
general classifications, the first

74
00:03:04,200 --> 00:03:07,980
would be involuntary, intentional, compromised account,

75
00:03:07,980 --> 00:03:11,519
and third, but each of

76
00:03:11,519 --> 00:03:14,519
them has permutations. Let's see what

77
00:03:14,519 --> 00:03:17,640
the involuntary type is about, as he

78
00:03:17,640 --> 00:03:19,920
explains it, it will be people who

79
00:03:19,920 --> 00:03:21,260


80
00:03:21,260 --> 00:03:24,060
accidentally became an internal threat

81
00:03:24,060 --> 00:03:26,879
and this happens normally.  e when you have a

82
00:03:26,879 --> 00:03:29,220
negligent employee a person who is

83
00:03:29,220 --> 00:03:33,060
careless or inadvertent now the

84
00:03:33,060 --> 00:03:35,900
intentional type as the word says

85
00:03:35,900 --> 00:03:39,060
on purpose are doing this and

86
00:03:39,060 --> 00:03:41,640
usually the types of people who

87
00:03:41,640 --> 00:03:44,400
are intentional insider threats are

88
00:03:44,400 --> 00:03:46,260
the outgoing employees a

89
00:03:46,260 --> 00:03:49,680
disgruntled person a fraudster a  activist or

90
00:03:49,680 --> 00:03:51,720
whistleblower someone who is resorted to with a

91
00:03:51,720 --> 00:03:53,599
third party

92
00:03:53,599 --> 00:03:55,980
and obviously well, the truth is intended.

93
00:03:55,980 --> 00:03:57,959
Now from there we have what we call a

94
00:03:57,959 --> 00:03:59,580
compromised account and in general

95
00:03:59,580 --> 00:04:02,580
this means that a person on

96
00:04:02,580 --> 00:04:04,700
purpose unconsciously or

97
00:04:04,700 --> 00:04:06,599
unconsciously consciously or

98
00:04:06,599 --> 00:04:08,580
unconsciously or on purpose one on

99
00:04:08,580 --> 00:04:11,519
purpose  they steal your

100
00:04:11,519 --> 00:04:12,780
credentials This usually happens with what we

101
00:04:12,780 --> 00:04:14,819
call initial Brokers and those

102
00:04:14,819 --> 00:04:17,100
credentials are used to generate

103
00:04:17,100 --> 00:04:18,899
an internal threat in the company and

104
00:04:18,899 --> 00:04:20,940
finally they are the third parties

105
00:04:20,940 --> 00:04:22,740
we call them ter Party, they are the

106
00:04:22,740 --> 00:04:24,000
people who are the contractors,

107
00:04:24,000 --> 00:04:25,860
vendors, suppliers and  they

108
00:04:25,860 --> 00:04:27,540
somehow have access  some things that

109
00:04:27,540 --> 00:04:29,160
we handle in our organization

110
00:04:29,160 --> 00:04:32,040
organization now What is the

111
00:04:32,040 --> 00:04:33,720
importance Why do we worry

112
00:04:33,720 --> 00:04:37,400
about this good first because

113
00:04:37,400 --> 00:04:40,259
the insiders are the people who have

114
00:04:40,259 --> 00:04:43,380
knowledge of the organization because they

115
00:04:43,380 --> 00:04:44,820
are very important they have

116
00:04:44,820 --> 00:04:46,500
knowledge of the organization They

117
00:04:46,500 --> 00:04:49,259
know the location by  In general and the

118
00:04:49,259 --> 00:04:50,639
nature of confidential data, they

119
00:04:50,639 --> 00:04:52,860
know the secrets

120
00:04:52,860 --> 00:04:55,320
and many times they know

121
00:04:55,320 --> 00:04:57,120
the security weaknesses that we have in the

122
00:04:57,120 --> 00:04:59,300
organization, so

123
00:04:59,300 --> 00:05:02,639
you have to be very careful In these trials

124
00:05:02,639 --> 00:05:04,560
because there are many consequences in this

125
00:05:04,560 --> 00:05:06,660
case, so what are the

126
00:05:06,660 --> 00:05:08,040
consequences? Well, many losses.  of a

127
00:05:08,040 --> 00:05:10,139
lot of trust financial

128
00:05:10,139 --> 00:05:12,060
intellectual property There are many that

129
00:05:12,060 --> 00:05:14,460
can be raised the reputation of the

130
00:05:14,460 --> 00:05:16,620
company the secrets are disclosed

131
00:05:16,620 --> 00:05:18,600
leaking things that should not be

132
00:05:18,600 --> 00:05:20,820
leaked anyway

133
00:05:20,820 --> 00:05:23,220
and to make it clear what is

134
00:05:23,220 --> 00:05:24,720
happening here and why they are very

135
00:05:24,720 --> 00:05:26,039
important  this internal threats

136
00:05:26,039 --> 00:05:28,680
we have three examples  one of them The

137
00:05:28,680 --> 00:05:30,660
most common and that people know is that of

138
00:05:30,660 --> 00:05:33,240
airwanes, which leaked a lot of

139
00:05:33,240 --> 00:05:36,060
information to Wikileaks, became

140
00:05:36,060 --> 00:05:39,199
a very famous person because of it,

141
00:05:39,199 --> 00:05:42,300
something that almost many people do not know is the

142
00:05:42,300 --> 00:05:44,820
stock market, they know that they are the links that are

143
00:05:44,820 --> 00:05:48,259
They did Wikileaks from the Cia

144
00:05:48,259 --> 00:05:51,180
and well I highly recommend this

145
00:05:51,180 --> 00:05:53,220
this New Yorker Arctic which is quite

146
00:05:53,220 --> 00:05:55,080
good for you to read, super interesting

147
00:05:55,080 --> 00:05:58,020
and something closer is tesland test

148
00:05:58,020 --> 00:06:00,180
where a person took a lot of

149
00:06:00,180 --> 00:06:03,000
code and it is not known if he used it or

150
00:06:03,000 --> 00:06:06,600
sold it  So it's something that happens and it's

151
00:06:06,600 --> 00:06:08,580
quite a year for one, like a company,

152
00:06:08,580 --> 00:06:09,840
right

153
00:06:09,840 --> 00:06:11,699
now we've already talked a little about what

154
00:06:11,699 --> 00:06:13,680
the insares are when the internal masses are the

155
00:06:13,680 --> 00:06:16,080
types of internal threats and now we

156
00:06:16,080 --> 00:06:18,720
have to put everything in one place and

157
00:06:18,720 --> 00:06:22,139
this will  we call inside insider Attack

158
00:06:22,139 --> 00:06:24,000
Life cycle

159
00:06:24,000 --> 00:06:26,520
What are the phases of the attack Well I

160
00:06:26,520 --> 00:06:28,680
am a fan of the Attack cycle that has a

161
00:06:28,680 --> 00:06:30,060
mandio in which you can see it at the

162
00:06:30,060 --> 00:06:31,620
moment

163
00:06:31,620 --> 00:06:33,840
But something very important that you

164
00:06:33,840 --> 00:06:36,240
should  to know It is that in all the cases

165
00:06:36,240 --> 00:06:38,160
of insiders there are what we call the

166
00:06:38,160 --> 00:06:40,500
precursors, which means they are the phases

167
00:06:40,500 --> 00:06:43,020
that a person who has decided to

168
00:06:43,020 --> 00:06:46,020
become a threat will or will not do

169
00:06:46,020 --> 00:06:48,479
and will become something very

170
00:06:48,479 --> 00:06:49,940
important that you have to

171
00:06:49,940 --> 00:06:52,740
evaluate  and always keep up to date

172
00:06:52,740 --> 00:06:56,460
so the phases are when you have the

173
00:06:56,460 --> 00:07:00,000
greens and you're not unhappy when you

174
00:07:00,000 --> 00:07:03,060
decided you're going to commit something and you

175
00:07:03,060 --> 00:07:06,060
prepare for it and when the

176
00:07:06,060 --> 00:07:08,340
time comes Sure you decide I'm going to

177
00:07:08,340 --> 00:07:10,620
execute this I decided to do it now

178
00:07:10,620 --> 00:07:13,800
we take those two  and we put them together and

179
00:07:13,800 --> 00:07:15,900
we ended up with what I call the

180
00:07:15,900 --> 00:07:17,580
Black Saico message

181
00:07:17,580 --> 00:07:20,520
but as Comrade Raúl Velasco would say,

182
00:07:20,520 --> 00:07:22,680
there is still more, they are a little old.

183
00:07:22,680 --> 00:07:27,240


184
00:07:27,240 --> 00:07:30,080


185
00:07:30,080 --> 00:07:33,960


186
00:07:33,960 --> 00:07:36,120
analysis of which are the tttps that

187
00:07:36,120 --> 00:07:37,919
deal more with internal threats

188
00:07:37,919 --> 00:07:40,860
so we can use this

189
00:07:40,860 --> 00:07:43,620
information to create a Hotmail

190
00:07:43,620 --> 00:07:45,780
which they did and discover  What

191
00:07:45,780 --> 00:07:48,539
are the most important things the tpps

192
00:07:48,539 --> 00:07:51,300
that you have to keep an eye on

193
00:07:51,300 --> 00:07:54,620
but here's the key if we take the

194
00:07:54,620 --> 00:07:57,419
maider Attack framework and put it together

195
00:07:57,419 --> 00:08:00,720
with the Attack Life cycle that I

196
00:08:00,720 --> 00:08:03,300
presented to you we end up with what I call

197
00:08:03,300 --> 00:08:06,840
the insider review Attack lightcycle

198
00:08:06,840 --> 00:08:09,300
where we have the  precursors and

199
00:08:09,300 --> 00:08:12,000
tickets organized based on the maitre

200
00:08:12,000 --> 00:08:15,360
Attack now How can we slide This

201
00:08:15,360 --> 00:08:19,039
good we are going to use this to create

202
00:08:19,039 --> 00:08:22,259
insider Kill change

203
00:08:22,259 --> 00:08:25,199
if you do Google Search Yahoo

204
00:08:25,199 --> 00:08:27,780
Search or any other Search you will

205
00:08:27,780 --> 00:08:30,620
find that the problem of Search

206
00:08:30,620 --> 00:08:34,219
inside is that There are too many  proposals,

207
00:08:34,219 --> 00:08:37,559
but although there are several versions of the

208
00:08:37,559 --> 00:08:42,059
Chain, they all have the same problem,

209
00:08:42,059 --> 00:08:45,420
they all use only one kilching,

210
00:08:45,420 --> 00:08:47,519
that is, who uses this kilching

211
00:08:47,519 --> 00:08:49,500
to cover all the permutations of

212
00:08:49,500 --> 00:08:51,600
internal threats, and as I

213
00:08:51,600 --> 00:08:53,640
demonstrated, I taught you, there are four general types,

214
00:08:53,640 --> 00:08:56,459
but each of these types  has

215
00:08:56,459 --> 00:09:00,060
different permutations So it is

216
00:09:00,060 --> 00:09:02,220
impossible to use only one

217
00:09:02,220 --> 00:09:03,899
kiwichain for  to try to find all

218
00:09:03,899 --> 00:09:06,019
the permutations Especially when

219
00:09:06,019 --> 00:09:08,760
mighter does not have all the permutations

220
00:09:08,760 --> 00:09:12,000
or the ttps What is the solution Well I am going

221
00:09:12,000 --> 00:09:13,920
to teach you How to create your own

222
00:09:13,920 --> 00:09:15,240
kitchen

223
00:09:15,240 --> 00:09:17,220
what we are going to do is we are going to take the

224
00:09:17,220 --> 00:09:21,240
incidental that I present to you today and we are going

225
00:09:21,240 --> 00:09:23,459
to take  an example in this case the type

226
00:09:23,459 --> 00:09:25,380
of internal threat to which we are going to

227
00:09:25,380 --> 00:09:27,899
generate a Kill change that intentional

228
00:09:27,899 --> 00:09:29,580
someone who is only trying to do something

229
00:09:29,580 --> 00:09:32,580
and the modality will be collusion with

230
00:09:32,580 --> 00:09:34,500
third parties someone who is with another

231
00:09:34,500 --> 00:09:37,620
third person to be the damage now

232
00:09:37,620 --> 00:09:40,620
normally  in this modality there are two or

233
00:09:40,620 --> 00:09:42,720
more people involved there is a

234
00:09:42,720 --> 00:09:45,140
monetary incentive there is a

235
00:09:45,140 --> 00:09:47,940
forced incentive And in this forced case it may

236
00:09:47,940 --> 00:09:50,399
be that perhaps the person involved

237
00:09:50,399 --> 00:09:51,420
is not doing it because they want to

238
00:09:51,420 --> 00:09:53,820
maybe someone in the case of

239
00:09:53,820 --> 00:09:55,620
Latin America kidnapped their family and

240
00:09:55,620 --> 00:09:57,959
is  forcing the activity that happens to do so

241
00:09:57,959 --> 00:10:00,420
is almost always out of the ordinary

242
00:10:00,420 --> 00:10:02,420
and in non-working hours

243
00:10:02,420 --> 00:10:06,600
the activity generates  of defenses there will

244
00:10:06,600 --> 00:10:08,100
be attempts to evade the defenses

245
00:10:08,100 --> 00:10:10,080
and it generally ends in extraction

246
00:10:10,080 --> 00:10:12,240
or attack grafts means

247
00:10:12,240 --> 00:10:14,700
station because they are going to steal something from us the

248
00:10:14,700 --> 00:10:16,740
graft means that perhaps if

249
00:10:16,740 --> 00:10:18,720
someone has been forced to do something they will

250
00:10:18,720 --> 00:10:20,459
have for example  a USB drive they

251
00:10:20,459 --> 00:10:21,660
installed a computer to

252
00:10:21,660 --> 00:10:23,339
detect it

253
00:10:23,339 --> 00:10:25,860
now since we know this what we are going to

254
00:10:25,860 --> 00:10:28,140
do is take the table that they

255
00:10:28,140 --> 00:10:30,540
show you and we are going to start connecting the

256
00:10:30,540 --> 00:10:33,440
tpps that have the highest to create it

257
00:10:33,440 --> 00:10:38,240
our kitchen each phase It has certain

258
00:10:38,240 --> 00:10:41,399
ttps So we are going to take  all of them

259
00:10:41,399 --> 00:10:44,399
and you can create your culting now in this

260
00:10:44,399 --> 00:10:45,600
case I am showing you an example

261
00:10:45,600 --> 00:10:47,459
but you can create the

262
00:10:47,459 --> 00:10:49,380
version you want each

263
00:10:49,380 --> 00:10:51,140
organization has its properties

264
00:10:51,140 --> 00:10:53,640
risks its controls its

265
00:10:53,640 --> 00:10:55,860
operating system So the ctps are going to vary

266
00:10:55,860 --> 00:10:57,899
that this is an example of how  you

267
00:10:57,899 --> 00:10:59,579
can create it but it does not mean that it

268
00:10:59,579 --> 00:11:01,800
is the only version of the kitchen of

269
00:11:01,800 --> 00:11:03,720
third parties colluding to do

270
00:11:03,720 --> 00:11:05,040
damage

271
00:11:05,040 --> 00:11:09,240
So now that we have assembled the tpps and combined them

272
00:11:09,240 --> 00:11:12,060
with the Attack Life cycle, what we

273
00:11:12,060 --> 00:11:14,040
can do is finish it, how are

274
00:11:14,040 --> 00:11:15,839
we going to finish it?

275
00:11:15,839 --> 00:11:17,220


276
00:11:17,220 --> 00:11:20,459


277
00:11:20,459 --> 00:11:23,640
what

278
00:11:23,640 --> 00:11:25,620
you see on the screen this would now be

279
00:11:25,620 --> 00:11:27,720
the Kill Chain we are going to use it to

280
00:11:27,720 --> 00:11:29,880
then make three content or to

281
00:11:29,880 --> 00:11:32,899
create our detections

282
00:11:33,600 --> 00:11:37,320
Well now as you have seen this I am going

283
00:11:37,320 --> 00:11:39,120
to show you a super simple example of

284
00:11:39,120 --> 00:11:41,220
how this works we are going to do an

285
00:11:41,220 --> 00:11:43,800
example where the  clichen that voltage in

286
00:11:43,800 --> 00:11:45,899
the Sabotage when a saire wants to be

287
00:11:45,899 --> 00:11:48,420
Sabotage because it is really very fast The

288
00:11:48,420 --> 00:11:49,560
only thing they are going to do is need a

289
00:11:49,560 --> 00:11:51,660
valid account and from there they are going to destroy

290
00:11:51,660 --> 00:11:55,079
everything then your Kill Chain of the type

291
00:11:55,079 --> 00:11:57,180
of instax you dedicate Sabotage is going to be a

292
00:11:57,180 --> 00:11:59,579
lot  shorter here as you can see

293
00:11:59,579 --> 00:12:01,860
we have ladies Vale decans and the

294
00:12:01,860 --> 00:12:03,480
destruction of information those

295
00:12:03,480 --> 00:12:05,760
absolutely everything is an example that

296
00:12:05,760 --> 00:12:07,380
you can use for how you

297
00:12:07,380 --> 00:12:10,019
i say create your own

298
00:12:10,019 --> 00:12:13,140
now what is the obsidian project well

299
00:12:13,140 --> 00:12:14,579
the project if you have something you are very

300
00:12:14,579 --> 00:12:16,800
proud of i am the architect of the

301
00:12:16,800 --> 00:12:21,000
obsidian project this happened in Def with 30 in the

302
00:12:21,000 --> 00:12:22,860
blooting Village which was only

303
00:12:22,860 --> 00:12:23,959
two days ago

304
00:12:23,959 --> 00:12:27,060
we did a simulation of opponents from

305
00:12:27,060 --> 00:12:30,660
Apps and  The general design was to teach

306
00:12:30,660 --> 00:12:32,880
many kinds of visible things and

307
00:12:32,880 --> 00:12:34,939
security,

308
00:12:35,959 --> 00:12:39,360
but one of them is 3 hunting,

309
00:12:39,360 --> 00:12:41,640
which is something I

310
00:12:41,640 --> 00:12:44,240
do. We also made a ctp, a

311
00:12:44,240 --> 00:12:48,000
City of flag, and the materials are

312
00:12:48,000 --> 00:12:49,320
available from which you can

313
00:12:49,320 --> 00:12:51,660
download all this.  In the rhythm that I

314
00:12:51,660 --> 00:12:53,940
show you, I will put the link in

315
00:12:53,940 --> 00:12:55,519
the sans slack so that you can see it,

316
00:12:55,519 --> 00:12:58,320
but something very interesting is that

317
00:12:58,320 --> 00:13:00,079
we generate

318
00:13:00,079 --> 00:13:02,459
that an internal threat simulation is happening

319
00:13:02,459 --> 00:13:06,779
and this threat was

320
00:13:06,779 --> 00:13:09,200
based on a collation with third parties.

321
00:13:09,200 --> 00:13:11,339
This is what I am going to demonstrate to you now

322
00:13:11,339 --> 00:13:13,680
and I am going to use it to teach

323
00:13:13,680 --> 00:13:15,899
you how you can do simple things with three

324
00:13:15,899 --> 00:13:18,959
hunting to find internal threats

325
00:13:18,959 --> 00:13:22,620
and well let's go  to occupy this kilching that

326
00:13:22,620 --> 00:13:24,600
we generated for the obsidian project and

327
00:13:24,600 --> 00:13:26,760
we are going to start with the first thing that

328
00:13:26,760 --> 00:13:30,360
is Valley thanos Ok the first phase that

329
00:13:30,360 --> 00:13:33,060
needs an internal threat is in a

330
00:13:33,060 --> 00:13:34,980
valid account

331
00:13:34,980 --> 00:13:37,200
I like all the three hacks that

332
00:13:37,200 --> 00:13:39,360
I do I have to have  a hypothesis in

333
00:13:39,360 --> 00:13:42,480
this case in collusion with third parties

334
00:13:42,480 --> 00:13:44,519
insiders internal threats can

335
00:13:44,519 --> 00:13:46,920
use valid accounts to access

336
00:13:46,920 --> 00:13:48,660
our network in order to leak and

337
00:13:48,660 --> 00:13:50,220
steal confidential data So

338
00:13:50,220 --> 00:13:53,399
we are going to use this hypothesis

339
00:13:53,399 --> 00:13:55,560
normally what you should

340
00:13:55,560 --> 00:13:57,360
do is create a database  we call it a

341
00:13:57,360 --> 00:14:00,959
baseline to identify anomalies

342
00:14:00,959 --> 00:14:03,180
this one is giving you This example is the

343
00:14:03,180 --> 00:14:05,220
simplest I am using splong

344
00:14:05,220 --> 00:14:06,660
but you can convert it into any

345
00:14:06,660 --> 00:14:09,060
other SIM if you want But this is

346
00:14:09,060 --> 00:14:10,320
very simple what we are going to do is not

347
00:14:10,320 --> 00:14:12,240
take we are going to do we are going  make a

348
00:14:12,240 --> 00:14:16,320
list of all the machines with their

349
00:14:16,320 --> 00:14:18,779
name and what are the users that

350
00:14:18,779 --> 00:14:20,940
are connecting to them So when

351
00:14:20,940 --> 00:14:22,680
doing  that we can

352
00:14:22,680 --> 00:14:26,279
quickly identify which users are generating

353
00:14:26,279 --> 00:14:28,800
Windows events in this case I can

354
00:14:28,800 --> 00:14:31,139
see administrator and they can see a series

355
00:14:31,139 --> 00:14:32,720
of users

356
00:14:32,720 --> 00:14:35,760
this is where the key to know your

357
00:14:35,760 --> 00:14:38,820
organization is key in this case of the

358
00:14:38,820 --> 00:14:40,740
example we create an account a

359
00:14:40,740 --> 00:14:43,920
fictitious company and this white user  is

360
00:14:43,920 --> 00:14:46,019
connecting to the fal server as you

361
00:14:46,019 --> 00:14:48,600
can see there and another user brent is

362
00:14:48,600 --> 00:14:52,139
connecting to the CV terminal the rtp in

363
00:14:52,139 --> 00:14:54,540
this example for which we generated this

364
00:14:54,540 --> 00:14:57,120
Maybe it's normal but we have a

365
00:14:57,120 --> 00:14:59,940
user named Elena and this person

366
00:14:59,940 --> 00:15:02,579
is connecting to the rdp

367
00:15:02,579 --> 00:15:04,920
So in  this example that is not

368
00:15:04,920 --> 00:15:07,740
normal Something is strange and it is important

369
00:15:07,740 --> 00:15:10,560
that we document this This is the

370
00:15:10,560 --> 00:15:14,040
simplest example and the easiest horn

371
00:15:14,040 --> 00:15:15,860
that you can use to find

372
00:15:15,860 --> 00:15:18,720
anomalies not only from insiders but

373
00:15:18,720 --> 00:15:21,000
from things that are happening that are done

374
00:15:21,000 --> 00:15:22,680
in your case by the administrator  It should never

375
00:15:22,680 --> 00:15:25,380
connect anywhere but the

376
00:15:25,380 --> 00:15:26,519
fact that it is generating

377
00:15:26,519 --> 00:15:28,380
Windows events wants to be an indication  The realization that

378
00:15:28,380 --> 00:15:30,540
something is happening can be bad or not.

379
00:15:30,540 --> 00:15:33,600
So what to do when you do

380
00:15:33,600 --> 00:15:35,820
trek hunting when you are matching

381
00:15:35,820 --> 00:15:39,420
things, I have to document in my team

382
00:15:39,420 --> 00:15:42,240
where I work I have a template that is

383
00:15:42,240 --> 00:15:43,320
the one I am showing you with

384
00:15:43,320 --> 00:15:45,600
a little more variations and  It is the one that

385
00:15:45,600 --> 00:15:47,600
I occupy and it is the one that I teach all the time

386
00:15:47,600 --> 00:15:49,680
at the end of the talk I am going to give you

387
00:15:49,680 --> 00:15:51,300
all the temples so that you have them in

388
00:15:51,300 --> 00:15:53,040
the deck you will see them and in this example

389
00:15:53,040 --> 00:15:55,380
with the Quality we generate

390
00:15:55,380 --> 00:15:58,560
our Temple This is how we do it  fill it out and

391
00:15:58,560 --> 00:16:00,959
how I show you The example of a

392
00:16:00,959 --> 00:16:02,519
curry we

393
00:16:02,519 --> 00:16:07,019
marry it And this is how it all ends

394
00:16:07,019 --> 00:16:09,839
now we go to step 2 as you can see

395
00:16:09,839 --> 00:16:12,899
nothing so difficult we are going to search for

396
00:16:12,899 --> 00:16:14,940
domine accounts now we are going to take

397
00:16:14,940 --> 00:16:17,639
our hypothesis the only variation is

398
00:16:17,639 --> 00:16:20,100
that in this  case We are looking for

399
00:16:20,100 --> 00:16:23,100
collusion based on abuse

400
00:16:23,100 --> 00:16:27,300
of domain accounts eh again we are going to take

401
00:16:27,300 --> 00:16:29,639
a string and we are going to modify it in

402
00:16:29,639 --> 00:16:32,880
this case I am looking for the number

403
00:16:32,880 --> 00:16:37,860
of events that are generated in in l  to network

404
00:16:37,860 --> 00:16:40,620
by the user if I'm not mistaken and here you

405
00:16:40,620 --> 00:16:43,199
can see them then with this quarry

406
00:16:43,199 --> 00:16:45,959
You can do it daily by month every

407
00:16:45,959 --> 00:16:47,839
week as you want you can

408
00:16:47,839 --> 00:16:50,220
quickly identify which users

409
00:16:50,220 --> 00:16:53,040
are creating more Windows events here

410
00:16:53,040 --> 00:16:54,720
for example we can see that the

411
00:16:54,720 --> 00:16:58,440
System user has  77 and in the administrator 21

412
00:16:58,440 --> 00:17:00,959
now perhaps in your organization the

413
00:17:00,959 --> 00:17:03,000
administrator account should not be used by anyone

414
00:17:03,000 --> 00:17:03,660


415
00:17:03,660 --> 00:17:05,939
this would be an easy way this would be

416
00:17:05,939 --> 00:17:08,520
a very easy and effective way to find out

417
00:17:08,520 --> 00:17:10,500
that there are anomalies with the

418
00:17:10,500 --> 00:17:12,419
administrator account and now they are anomalies

419
00:17:12,419 --> 00:17:15,240
it means that  it could be something bad

420
00:17:15,240 --> 00:17:17,459
or really bad bad

421
00:17:17,459 --> 00:17:18,780
maybe someone is using the account

422
00:17:18,780 --> 00:17:20,760
inappropriately it could be an insider it

423
00:17:20,760 --> 00:17:23,280
could be that there was a problem and errors

424
00:17:23,280 --> 00:17:26,160
or it could be that you already have an actor in your

425
00:17:26,160 --> 00:17:27,959
network

426
00:17:27,959 --> 00:17:30,120
also one of the things that happens is  that

427
00:17:30,120 --> 00:17:32,520
you can find the opposite events

428
00:17:32,520 --> 00:17:35,580
that are not happening so often these

429
00:17:35,580 --> 00:17:37,620
events not so often generate questions

430
00:17:37,620 --> 00:17:39,539
in this case we have a u  user that

431
00:17:39,539 --> 00:17:41,520
only has one event that is this

432
00:17:41,520 --> 00:17:43,620
can be normal or perhaps it can be so

433
00:17:43,620 --> 00:17:45,539
abnormal how is it possible that a person

434
00:17:45,539 --> 00:17:48,120
in a single day only has a

435
00:17:48,120 --> 00:17:51,480
Windows event will have to be investigated

436
00:17:51,480 --> 00:17:54,240
but something that has to be is it is necessary to

437
00:17:54,240 --> 00:17:56,039
generate context it is important  generate

438
00:17:56,039 --> 00:17:58,080
context when you are generating your

439
00:17:58,080 --> 00:18:00,240
which your hunts in this case what I

440
00:18:00,240 --> 00:18:02,039
am going to do we are going to generate the context

441
00:18:02,039 --> 00:18:04,860
we are going to find which users are

442
00:18:04,860 --> 00:18:07,020
creating what type of events and here is

443
00:18:07,020 --> 00:18:09,600
the quarry the problem as you can see

444
00:18:09,600 --> 00:18:13,559
there is that we have 75,000 events  for a

445
00:18:13,559 --> 00:18:16,320
10 only where I work I see

446
00:18:16,320 --> 00:18:17,880
millions of events to access an

447
00:18:17,880 --> 00:18:21,179
idea So we have to make the

448
00:18:21,179 --> 00:18:24,059
information condensed and be more

449
00:18:24,059 --> 00:18:25,860
effective what we are going to do is that

450
00:18:25,860 --> 00:18:29,100
we are going to reduce the results

451
00:18:29,100 --> 00:18:31,679
and concentrate and concentrate on something

452
00:18:31,679 --> 00:18:34,440
specific  we are going to look for all the

453
00:18:34,440 --> 00:18:36,720
event logos if they go to if they look for a

454
00:18:36,720 --> 00:18:38,820
Windows article they are going to discover that

455
00:18:38,820 --> 00:18:40,620
these are the lolgon events and the

456
00:18:40,620 --> 00:18:42,240
we are going to use we want to see which

457
00:18:42,240 --> 00:18:43,679
users are generating these events

458
00:18:43,679 --> 00:18:47,520
so we alter our corint and

459
00:18:47,520 --> 00:18:49,679
use it to search the example

460
00:18:49,679 --> 00:18:52,980
here if you guys play it you would

461
00:18:52,980 --> 00:18:55,740
notice that you didn't find anything and that

462
00:18:55,740 --> 00:18:57,840
's because we would have to adjust some of

463
00:18:57,840 --> 00:19:00,419
the parameters of  I present the search

464
00:19:00,419 --> 00:19:02,039
Because they are going to be the

465
00:19:02,039 --> 00:19:04,260
CTF they are going to find the same problem

466
00:19:04,260 --> 00:19:06,179
and well I want to give them the solution to the

467
00:19:06,179 --> 00:19:10,679
problem So we alter this and

468
00:19:10,679 --> 00:19:12,360
what will happen is that we begin to

469
00:19:12,360 --> 00:19:16,799
discover things of interest now

470
00:19:16,799 --> 00:19:18,539
what we can see  well in this case

471
00:19:18,539 --> 00:19:20,880
we can see that there are

472
00:19:20,880 --> 00:19:22,679
subsex events and we can see the types of

473
00:19:22,679 --> 00:19:24,120
events that are happening and the machines

474
00:19:24,120 --> 00:19:26,840
and users that are generating them

475
00:19:26,840 --> 00:19:30,120
we alter our curry a bit and

476
00:19:30,120 --> 00:19:32,760
in this case we are going to look only for

477
00:19:32,760 --> 00:19:35,580
the events in false  server maybe

478
00:19:35,580 --> 00:19:37,380
you have a server that is the most

479
00:19:37,380 --> 00:19:40,679
important here you would call it the crown

480
00:19:40,679 --> 00:19:43,860
joule the thing where the server or the

481
00:19:43,860 --> 00:19:45,120
machine where they are located  the

482
00:19:45,120 --> 00:19:47,820
most valuable things So in this case because of

483
00:19:47,820 --> 00:19:51,360
because of the because of the project

484
00:19:51,360 --> 00:19:53,640
was on the false servers So we are going

485
00:19:53,640 --> 00:19:54,900
to look for what is happening on the false

486
00:19:54,900 --> 00:19:57,720
server and we can realize that

487
00:19:57,720 --> 00:19:59,220
there are several things that are obvious first

488
00:19:59,220 --> 00:20:01,860
we have enough trailers

489
00:20:01,860 --> 00:20:04,020
Many things are happening that are not right and they are

490
00:20:04,020 --> 00:20:05,960
happening through a large number of users,

491
00:20:05,960 --> 00:20:09,299
so we can create a pitcher and

492
00:20:09,299 --> 00:20:12,419
identify the number of errors and

493
00:20:12,419 --> 00:20:15,660
things that, if they are not having

494
00:20:15,660 --> 00:20:17,960
errors, we

495
00:20:17,960 --> 00:20:20,820
manipulate the neck a little more and

496
00:20:20,820 --> 00:20:23,640
with it we can then see what  is

497
00:20:23,640 --> 00:20:26,820
going through each user and based on

498
00:20:26,820 --> 00:20:30,600
that we can then find the

499
00:20:30,600 --> 00:20:33,600
fault codes and as you can see here

500
00:20:33,600 --> 00:20:36,299
are the fault codes Now I'm not going

501
00:20:36,299 --> 00:20:37,799
to try to go too much into these

502
00:20:37,799 --> 00:20:40,140
fault games but you have to keep generating

503
00:20:40,140 --> 00:20:42,059
context When you hunt with  these

504
00:20:42,059 --> 00:20:43,620
three you have to keep generating

505
00:20:43,620 --> 00:20:45,600
context and I hope I'm

506
00:20:45,600 --> 00:20:48,059
showing you how you start with a

507
00:20:48,059 --> 00:20:49,860
very simple query and start using it to

508
00:20:49,860 --> 00:20:51,720
use to  concentrate on something of

509
00:20:51,720 --> 00:20:54,419
interest. Well, if we continue doing this,

510
00:20:54,419 --> 00:20:56,520
we will realize that all the

511
00:20:56,520 --> 00:20:59,460
events we see are Logan type Tree,

512
00:20:59,460 --> 00:21:01,380
that is, they come from the Nervo del

513
00:21:01,380 --> 00:21:02,820
Network,

514
00:21:02,820 --> 00:21:06,000
except for one user who only generates

515
00:21:06,000 --> 00:21:08,039
an error and they tried to

516
00:21:08,039 --> 00:21:11,039
change it.  a password

517
00:21:11,039 --> 00:21:14,580
now we do not know why it is that all

518
00:21:14,580 --> 00:21:16,440
users have these errors but it

519
00:21:16,440 --> 00:21:18,660
is curious once again that the user of

520
00:21:18,660 --> 00:21:21,179
lana dulces is here again and also

521
00:21:21,179 --> 00:21:22,679
has a large number of errors

522
00:21:22,679 --> 00:21:25,679
so it is necessary to document it is

523
00:21:25,679 --> 00:21:28,020
important to say something this is this

524
00:21:28,020 --> 00:21:30,299
identifies  that we have an insider we

525
00:21:30,299 --> 00:21:33,960
are not in an initial phase But there is a

526
00:21:33,960 --> 00:21:35,340
lot of information that says that something

527
00:21:35,340 --> 00:21:39,000
is abnormal So we are going to document

528
00:21:39,000 --> 00:21:41,100
this is the example of the documentation

529
00:21:41,100 --> 00:21:42,780
that I did and once as I already told you

530
00:21:42,780 --> 00:21:45,480
I am going to pass it all on to you

531
00:21:45,480 --> 00:21:48,659
something that I want you to observe is what I

532
00:21:48,659 --> 00:21:51,240
put here in English which are my findings

533
00:21:51,240 --> 00:21:53,280
what we found and well here

534
00:21:53,280 --> 00:21:56,460
that it was not Clear because we had so many

535
00:21:56,460 --> 00:22:00,659
Logan crash errors and it was

536
00:22:00,659 --> 00:22:04,320
important to try to investigate and

537
00:22:04,320 --> 00:22:07,080
so right now if I was

538
00:22:07,080 --> 00:22:09,240
doing this at work I would send

539
00:22:09,240 --> 00:22:10,620
this information to our

540
00:22:10,620 --> 00:22:12,419
Einstein response team because there is

541
00:22:12,419 --> 00:22:15,480
pneumonia something is not right

542
00:22:15,480 --> 00:22:18,659
let's continue more than Reading which is more

543
00:22:18,659 --> 00:22:21,200
trading  well in this case

544
00:22:21,200 --> 00:22:23,299
Here we are going to

545
00:22:23,299 --> 00:22:27,240
make a note insiders can

546
00:22:27,240 --> 00:22:29,340
use different types of

547
00:22:29,340 --> 00:22:33,440
rating mask to access our network but

548
00:22:33,440 --> 00:22:37,080
the key to more trading is that it is something

549
00:22:37,080 --> 00:22:38,700
that is trying to do what it is not

550
00:22:38,700 --> 00:22:41,159
Now there are many options that we can

551
00:22:41,159 --> 00:22:43,440
explore without  However, I am going to teach you

552
00:22:43,440 --> 00:22:46,200
one in particular This is a tic And this is

553
00:22:46,200 --> 00:22:47,520
very simple and it will give you many

554
00:22:47,520 --> 00:22:49,380
results we are going to do a search

555
00:22:49,380 --> 00:22:52,320
looking for credential diagonal But

556
00:22:52,320 --> 00:22:54,299
before that I want to teach you how you can

557
00:22:54,299 --> 00:22:56,280
do super simple hunts let's

558
00:22:56,280 --> 00:22:58,799
first Search for the  term credential

559
00:22:58,799 --> 00:23:01,260
so we look for the term credential

560
00:23:01,260 --> 00:23:05,419
and as soon as they do I will find

561
00:23:05,419 --> 00:23:07,740
many or few results for that  Or is it

562
00:23:07,740 --> 00:23:09,360
that depending on your organization, the

563
00:23:09,360 --> 00:23:13,020
number will be large or small,

564
00:23:13,020 --> 00:23:17,220
but something important that will help you

565
00:23:17,220 --> 00:23:20,580
is to look for a credential diagonal

566
00:23:20,580 --> 00:23:23,720
Why, good, because

567
00:23:23,720 --> 00:23:26,880
when someone wants to believe in

568
00:23:26,880 --> 00:23:29,159
their executive, it is manipulating to be

569
00:23:29,159 --> 00:23:32,280
normal Something that is not  So one of

570
00:23:32,280 --> 00:23:35,340
those techniques that has been seen is to

571
00:23:35,340 --> 00:23:37,700
use the power shell to

572
00:23:37,700 --> 00:23:40,380
pass credentials of a third user

573
00:23:40,380 --> 00:23:43,620
so that the Script runs things in the

574
00:23:43,620 --> 00:23:46,620
context of the Third user. That is

575
00:23:46,620 --> 00:23:48,600
normal in your organization, maybe it is not.

576
00:23:48,600 --> 00:23:50,640
I recommend that you investigate and

577
00:23:50,640 --> 00:23:54,120
run  this aquarium now if we take that

578
00:23:54,120 --> 00:23:56,100
reference and adjust our curry

579
00:23:56,100 --> 00:23:59,940
we can then hunt for this event

580
00:23:59,940 --> 00:24:02,940
and as soon as we do we

581
00:24:02,940 --> 00:24:04,640
realize that once again we have this user

582
00:24:04,640 --> 00:24:08,580
Elena dulces who has some events

583
00:24:08,580 --> 00:24:10,799
but we also find other users

584
00:24:10,799 --> 00:24:13,020
who apparently have those same

585
00:24:13,020 --> 00:24:15,000
events this can be as I told you

586
00:24:15,000 --> 00:24:17,059
normal or not and you have to investigate it

587
00:24:17,059 --> 00:24:20,460
then as it says there it is not uncommon that

588
00:24:20,460 --> 00:24:22,260
there are sequences of  e

589
00:24:22,260 --> 00:24:25,260
patch commands that invoke credential but we have

590
00:24:25,260 --> 00:24:27,120
to investigate it

591
00:24:27,120 --> 00:24:29,940
we adjust our account and now we can

592
00:24:29,940 --> 00:24:33,360
see with the new adjustment of the quarry the

593
00:24:33,360 --> 00:24:35,760
machines that are generating it and by

594
00:24:35,760 --> 00:24:38,220
doing that we can realize that

595
00:24:38,220 --> 00:24:40,679
something is not right we have the user

596
00:24:40,679 --> 00:24:43,679
Elena who is  doing the quarry from

597
00:24:43,679 --> 00:24:45,659
a machine that is the Seven workstation

598
00:24:45,659 --> 00:24:49,260
But now we have another user

599
00:24:49,260 --> 00:24:51,419
what is happening here something really

600
00:24:51,419 --> 00:24:55,400
does not sound good we investigate a little more

601
00:24:55,400 --> 00:24:57,480
and as I tell you all the all the

602
00:24:57,480 --> 00:24:58,919
users that I have are going to see them they

603
00:24:58,919 --> 00:25:00,539
can get them  That's how he passed it to you No,

604
00:25:00,539 --> 00:25:03,360
don't worry about that. We do run

605
00:25:03,360 --> 00:25:05,159
this quadril that I showed you, so we can

606
00:25:05,159 --> 00:25:06,500


607
00:25:06,500 --> 00:25:09,240
find more details and one of the

608
00:25:09,240 --> 00:25:11,520
key things we can find is

609
00:25:11,520 --> 00:25:14,280
that the user Elena Dulce is being

610
00:25:14,280 --> 00:25:18,120
used to access a directory

611
00:25:18,120 --> 00:25:20,240
that  it's called research in the Fall server

612
00:25:20,240 --> 00:25:23,940
this really sounds bad So we have

613
00:25:23,940 --> 00:25:25,100
to document

614
00:25:25,100 --> 00:25:27,840
we generate our new document And in

615
00:25:27,840 --> 00:25:30,600
this case once more and  I

616
00:25:30,600 --> 00:25:33,120
was really doing this this means

617
00:25:33,120 --> 00:25:35,220
that I automatically have to

618
00:25:35,220 --> 00:25:37,380
involve the Instant response team

619
00:25:37,380 --> 00:25:39,179
Because something is not right and we have to

620
00:25:39,179 --> 00:25:41,940
investigate it immediately

621
00:25:41,940 --> 00:25:44,520
well we continue with more and we are going to

622
00:25:44,520 --> 00:25:46,980
talk about the remote a Services

623
00:25:46,980 --> 00:25:49,380
rbp I think I am a little short  of

624
00:25:49,380 --> 00:25:50,880
time so I'm going to try to do this

625
00:25:50,880 --> 00:25:52,860
a little quickly

626
00:25:52,860 --> 00:25:55,260
and well in this case the hypothesis is that they are

627
00:25:55,260 --> 00:25:58,260
going to use artp to try to

628
00:25:58,260 --> 00:25:59,720
explain things

629
00:25:59,720 --> 00:26:03,539
here one of the very easy things they

630
00:26:03,539 --> 00:26:05,580
can do are two strategies the

631
00:26:05,580 --> 00:26:08,220
first is  use the same strategy

632
00:26:08,220 --> 00:26:12,779
of the connection codes And try to

633
00:26:12,779 --> 00:26:14,940
find things that are not right but

634
00:26:14,940 --> 00:26:16,860
something that I can give you a tip that

635
00:26:16,860 --> 00:26:19,140
works quite a lot almost all

636
00:26:19,140 --> 00:26:20,580
organizations have a nomenclature

637
00:26:20,580 --> 00:26:23,539
that these computers occupy company

638
00:26:23,539 --> 00:26:26,100
computer one company computer 12

639
00:26:26,100 --> 00:26:28,620
etc. if you do  an aquarium

640
00:26:28,620 --> 00:26:30,360
like the ones I'm going to show you can

641
00:26:30,360 --> 00:26:33,299
find computers on the network that don't

642
00:26:33,299 --> 00:26:35,400
have the same  ma migration name that is

643
00:26:35,400 --> 00:26:38,039
used in your organization that is

644
00:26:38,039 --> 00:26:39,960
a very easy and simple way to find

645
00:26:39,960 --> 00:26:41,820
not only internal links But

646
00:26:41,820 --> 00:26:43,919
some other things so what I

647
00:26:43,919 --> 00:26:46,080
am doing here is running that

648
00:26:46,080 --> 00:26:48,240
Cory we are going to find that in fact there are

649
00:26:48,240 --> 00:26:49,799
quite a few machines that are

650
00:26:49,799 --> 00:26:51,419
connecting  now to our organization,

651
00:26:51,419 --> 00:26:54,539
not the nomenclature that we should

652
00:26:54,539 --> 00:26:56,700
have in the organization, something is not

653
00:26:56,700 --> 00:26:58,679
right Now there are many reasons why this

654
00:26:58,679 --> 00:27:01,440
can happen but we must investigate

655
00:27:01,440 --> 00:27:03,299
in this case we are going to investigate a

656
00:27:03,299 --> 00:27:04,620
little more in detail what

657
00:27:04,620 --> 00:27:07,500
is happening and we can with  a rigged aquarium to

658
00:27:07,500 --> 00:27:10,260
investigate who AND where

659
00:27:10,260 --> 00:27:12,840
is connecting and by doing that we can

660
00:27:12,840 --> 00:27:15,419
then figure out that there are

661
00:27:15,419 --> 00:27:18,419
some machines that are of interest if

662
00:27:18,419 --> 00:27:20,159
we keep concentrating on some of

663
00:27:20,159 --> 00:27:22,500
those machines we can figure out

664
00:27:22,500 --> 00:27:26,760
that someone is using the remote

665
00:27:26,760 --> 00:27:29,039
server and  they are being told from a

666
00:27:29,039 --> 00:27:33,000
particular place. So that already

667
00:27:33,000 --> 00:27:34,559
becomes something very fascinating and

668
00:27:34,559 --> 00:27:37,580
i  Interesting and it's time to document it.

669
00:27:37,580 --> 00:27:40,919
Simple. Now, since I'm

670
00:27:40,919 --> 00:27:42,539
going to be short of time, I'm going to skip what's

671
00:27:42,539 --> 00:27:45,240
coming a lot, but I'm going to give you the type. The

672
00:27:45,240 --> 00:27:46,620
easiest way to find

673
00:27:46,620 --> 00:27:49,520
anomalies in rpp is to Search for the event

674
00:27:49,520 --> 00:27:53,279
11:49 Search for elements in 49  It generates

675
00:27:53,279 --> 00:27:55,500
many of which I'm going to give you and

676
00:27:55,500 --> 00:27:57,000
I'm going to skip them because there won't be

677
00:27:57,000 --> 00:27:57,900
time

678
00:27:57,900 --> 00:28:00,480
and if you do, you'll be able to find

679
00:28:00,480 --> 00:28:02,520
anomalies. I also skipped it because it

680
00:28:02,520 --> 00:28:06,360
starts from the CTF and includes finding

681
00:28:06,360 --> 00:28:07,980
some things that are demonstrated there

682
00:28:07,980 --> 00:28:09,419
but it's  good chance that

683
00:28:09,419 --> 00:28:11,220
you do it on your own in this

684
00:28:11,220 --> 00:28:13,500
case we have enough information that

685
00:28:13,500 --> 00:28:16,140
something is not right so it is a

686
00:28:16,140 --> 00:28:18,360
very simple way to hunt and find not

687
00:28:18,360 --> 00:28:19,919
only internal anomalies but

688
00:28:19,919 --> 00:28:23,880
some other things finally we have

689
00:28:23,880 --> 00:28:26,279
the issue of automatic Collection no  I

690
00:28:26,279 --> 00:28:28,620
'm going to cover it because we covered it a little bit

691
00:28:28,620 --> 00:28:30,900
in a previous section and so on because

692
00:28:30,900 --> 00:28:32,340
I want you to explore this on your

693
00:28:32,340 --> 00:28:34,200
own but let's talk

694
00:28:34,200 --> 00:28:36,240
about the explanation.  and I am going to show you

695
00:28:36,240 --> 00:28:37,980
a very simple technique because there are

696
00:28:37,980 --> 00:28:39,960
too many filtration techniques in

697
00:28:39,960 --> 00:28:42,960
this case we are going to use the clipboard

698
00:28:42,960 --> 00:28:44,880
right we are going to copy things from one place

699
00:28:44,880 --> 00:28:46,980
to another and we are going to see if we find something

700
00:28:46,980 --> 00:28:50,220
interesting so here it is very

701
00:28:50,220 --> 00:28:52,799
important if you have seismic

702
00:28:52,799 --> 00:28:56,700
you are doing this is very good sismon event id24 is

703
00:28:56,700 --> 00:28:58,919
going to help you we use

704
00:28:58,919 --> 00:29:01,679
event id24 seism element we generate our

705
00:29:01,679 --> 00:29:04,020
curry and what we are going to do is we

706
00:29:04,020 --> 00:29:07,020
find a series of machines and

707
00:29:07,020 --> 00:29:08,400
users who are using the

708
00:29:08,400 --> 00:29:10,620
clipboard once again we find this

709
00:29:10,620 --> 00:29:13,799
user Elena And a  once again to Esteban

710
00:29:13,799 --> 00:29:17,039
something is not very right there

711
00:29:17,039 --> 00:29:19,260
we generate a different corey to

712
00:29:19,260 --> 00:29:22,140
generate the context we need and

713
00:29:22,140 --> 00:29:24,059
we realize that this is happening

714
00:29:24,059 --> 00:29:27,000
in the terminal server What does it mean

715
00:29:27,000 --> 00:29:28,799
that someone in the terminal server is

716
00:29:28,799 --> 00:29:31,200
copying files from one machine to another

717
00:29:31,200 --> 00:29:35,419
machine a very easy way to

718
00:29:35,419 --> 00:29:37,279
exfiltrate files from an organization

719
00:29:37,279 --> 00:29:40,260
So I recommend them to hunt

720
00:29:40,260 --> 00:29:42,779
for trejontings  quite valuable

721
00:29:42,779 --> 00:29:45,720
now handling this Core a little more

722
00:29:45,720 --> 00:29:48,480
we can find more context and here is

723
00:29:48,480 --> 00:29:50,760
something where the seism is quite valuable

724
00:29:50,760 --> 00:29:54,000
because seism can give you a Hash of a

725
00:29:54,000 --> 00:29:56,100
file and I am using this to

726
00:29:56,100 --> 00:29:59,820
then identify what file and what

727
00:29:59,820 --> 00:30:02,220
it is doing copying  now it doesn't

728
00:30:02,220 --> 00:30:03,899
have the name but a technique that

729
00:30:03,899 --> 00:30:06,240
you can do is generate the has

730
00:30:06,240 --> 00:30:08,340
or the files that you are interested in and

731
00:30:08,340 --> 00:30:09,960
have them to create a detection and

732
00:30:09,960 --> 00:30:11,760
we can talk about it later or out in

733
00:30:11,760 --> 00:30:14,580
slack if you like for an

734
00:30:14,580 --> 00:30:17,100
interesting thing is that in this event

735
00:30:17,100 --> 00:30:19,559
we found a computer that had not

736
00:30:19,559 --> 00:30:21,779
left And that covered something very

737
00:30:21,779 --> 00:30:24,140
interesting when Searching for this computer

738
00:30:24,140 --> 00:30:26,880
we can realize that there is a user

739
00:30:26,880 --> 00:30:29,580
who is apparently creating

740
00:30:29,580 --> 00:30:33,000
the collusion and is using another

741
00:30:33,000 --> 00:30:34,980
third user's credentials to

742
00:30:34,980 --> 00:30:38,340
generate the internal threat

743
00:30:38,340 --> 00:30:41,340
So when  generate the context we can

744
00:30:41,340 --> 00:30:43,860
find or in the ctf they can find

745
00:30:43,860 --> 00:30:46,200
who was macnulen was the person who

746
00:30:46,200 --> 00:30:48,480
was  On the inside

747
00:30:48,480 --> 00:30:51,440
we generate our template and with this

748
00:30:51,440 --> 00:30:53,880
we arrive at the final notes now it

749
00:30:53,880 --> 00:30:56,100
is doing a little fast but I want to

750
00:30:56,100 --> 00:30:58,080
note that what I teach you are

751
00:30:58,080 --> 00:31:00,059
really easy and simple things but they

752
00:31:00,059 --> 00:31:02,580
are things that have a lot of value they

753
00:31:02,580 --> 00:31:04,140
will help you a lot in  your organization

754
00:31:04,140 --> 00:31:07,559
to find things quickly and they are

755
00:31:07,559 --> 00:31:09,539
very effective as you can see in my

756
00:31:09,539 --> 00:31:12,179
opinion they are worth running

757
00:31:12,179 --> 00:31:16,080
today Well the final notes

758
00:31:16,080 --> 00:31:18,179
the insiders the people who are going to

759
00:31:18,179 --> 00:31:20,279
do the threats have the

760
00:31:20,279 --> 00:31:22,080
knowledge of the organization sometimes

761
00:31:22,080 --> 00:31:24,240
more  that you and I

762
00:31:24,240 --> 00:31:26,159
are not easy to find in this

763
00:31:26,159 --> 00:31:28,020
example it was very easy because I did it

764
00:31:28,020 --> 00:31:30,179
quickly because the truth is that it is not

765
00:31:30,179 --> 00:31:33,260
really that easy and they need a lot of

766
00:31:33,260 --> 00:31:36,000
bases or bases to be able to find the

767
00:31:36,000 --> 00:31:37,700
anomalies it

768
00:31:37,700 --> 00:31:40,140
is necessary to understand the

769
00:31:40,140 --> 00:31:42,140
precursor events and new

770
00:31:42,140 --> 00:31:45,299
and plan  do an internship where you are going

771
00:31:45,299 --> 00:31:47,159
to dedicate yourself to using the hunting train of

772
00:31:47,159 --> 00:31:48,899
precursor events because it is something very

773
00:31:48,899 --> 00:31:50,820
complex and there was no time to cover it.  Go through it

774
00:31:50,820 --> 00:31:53,000
all

775
00:31:53,100 --> 00:31:54,840
one more time, not all internal links

776
00:31:54,840 --> 00:31:57,779
are the same, you have to generate your

777
00:31:57,779 --> 00:32:00,179
own in knowing Kill change, depending on

778
00:32:00,179 --> 00:32:01,919
your organization, the open

779
00:32:01,919 --> 00:32:03,419
operating system that you generate, it is very important

780
00:32:03,419 --> 00:32:07,580
that you do it, and lastly, the context,

781
00:32:07,580 --> 00:32:10,980
the context, and the context, that is, each

782
00:32:10,980 --> 00:32:13,320
Every time you search, you do trejonting, it is

783
00:32:13,320 --> 00:32:15,360
important to have the key context, it is

784
00:32:15,360 --> 00:32:18,659
important that you do what we call

785
00:32:18,659 --> 00:32:20,760
in English summing, in short, that you

786
00:32:20,760 --> 00:32:24,779
look inward and look for

787
00:32:24,779 --> 00:32:26,460
details, but also sometimes you

788
00:32:26,460 --> 00:32:29,100
go out and see all the painting in

789
00:32:29,100 --> 00:32:30,679
general.  What is happening

790
00:32:30,679 --> 00:32:33,360
context will help you understand If

791
00:32:33,360 --> 00:32:34,860
this person is doing something good or

792
00:32:34,860 --> 00:32:37,799
something bad and it is the context of all the

793
00:32:37,799 --> 00:32:39,960
actions that give you an indication that

794
00:32:39,960 --> 00:32:43,260
something is happening then the key

795
00:32:43,260 --> 00:32:46,260
is do not judge to mark something  as an

796
00:32:46,260 --> 00:32:49,860
insider Unless you have context

797
00:32:49,860 --> 00:32:51,840
that this is actually happening it is very

798
00:32:51,840 --> 00:32:54,600
easy to be wrong and it is very difficult

799
00:32:54,600 --> 00:32:56,760
sometimes to prove that this is happening or

800
00:32:56,760 --> 00:32:59,220
is about to happen.  sar, but with the colors

801
00:32:59,220 --> 00:33:00,600
that I sent you, you may have the

802
00:33:00,600 --> 00:33:01,620
opportunity to find some things

803
00:33:01,620 --> 00:33:03,899
in your organization and well, with this

804
00:33:03,899 --> 00:33:07,020
we come to the final part. I want to

805
00:33:07,020 --> 00:33:09,360
thank Brooklyn Village, my friends

806
00:33:09,360 --> 00:33:13,320
there, defcon, a qualified person,

807
00:33:13,320 --> 00:33:16,399
she did practically

808
00:33:16,399 --> 00:33:20,720
with me, but she  generated all the

809
00:33:20,720 --> 00:33:22,860
simulation insider that we really wanted to

810
00:33:22,860 --> 00:33:26,220
enable Enrique vamode who is a

811
00:33:26,220 --> 00:33:28,860
friend from Mexico he helped me with the

812
00:33:28,860 --> 00:33:30,240
regulation in the lack of photographs

813
00:33:30,240 --> 00:33:31,980
So if there is something wrong then let us

814
00:33:31,980 --> 00:33:35,340
know and well I'm sorry a

815
00:33:35,340 --> 00:33:37,440
huge greeting to my colleagues  work To

816
00:33:37,440 --> 00:33:39,000
James Broly he is a person who is

817
00:33:39,000 --> 00:33:41,039
practically dedicated to the insider and

818
00:33:41,039 --> 00:33:43,559
well I recommend that if you have if you look for

819
00:33:43,559 --> 00:33:45,539
his Twitter to be friends with him

820
00:33:45,539 --> 00:33:47,460
finally thanks to sans I want to

821
00:33:47,460 --> 00:33:49,980
thank you very much to corygann she has been

822
00:33:49,980 --> 00:33:51,779
very kind to me and has helped me  helped me

823
00:33:51,779 --> 00:33:54,899
to be with today So

824
00:33:54,899 --> 00:33:56,340
thank you very much to all the

825
00:33:56,340 --> 00:33:58,440
sans team and finally to the team that I

826
00:33:58,440 --> 00:34:01,380
work for that is  n los pinos este Thank you

827
00:34:01,380 --> 00:34:05,399
for attending this talk and Well,

828
00:34:05,399 --> 00:34:07,080
the time for questions has arrived, if there are

829
00:34:07,080 --> 00:34:08,520
any questions out there, then

830
00:34:08,520 --> 00:34:10,639
let me know

