1
00:00:00,659 --> 00:00:02,960
foreign

2
00:00:05,819 --> 00:00:07,859
as Heather mentioned my name is Josh

3
00:00:07,859 --> 00:00:09,360
Hickman and today I'm going to be

4
00:00:09,360 --> 00:00:10,740
talking about Android malware but

5
00:00:10,740 --> 00:00:12,840
probably not in the way that we normally

6
00:00:12,840 --> 00:00:14,219
think about it

7
00:00:14,219 --> 00:00:15,900
but before I get started I do want to

8
00:00:15,900 --> 00:00:18,539
tell you a little bit about me I've uh

9
00:00:18,539 --> 00:00:21,180
you can see my title there

10
00:00:21,180 --> 00:00:23,279
um

11
00:00:23,279 --> 00:00:25,080
currently I'm a senior vice president in

12
00:00:25,080 --> 00:00:28,019
cyber risk practice at Kroll I'm coming

13
00:00:28,019 --> 00:00:29,760
up on my three year anniversary at crawl

14
00:00:29,760 --> 00:00:31,380
and before that I was the manager of the

15
00:00:31,380 --> 00:00:32,820
digital edit section of the State Crime

16
00:00:32,820 --> 00:00:34,380
Lab North Carolina

17
00:00:34,380 --> 00:00:36,239
and prior to that I was in law

18
00:00:36,239 --> 00:00:38,760
enforcement for 16 years most of that

19
00:00:38,760 --> 00:00:40,920
was at the state level dealing mainly

20
00:00:40,920 --> 00:00:42,360
with violent crime and public corruption

21
00:00:42,360 --> 00:00:44,520
but uh towards the end of my career I

22
00:00:44,520 --> 00:00:46,140
made my way over into the computer crime

23
00:00:46,140 --> 00:00:48,059
section which put me on the internet

24
00:00:48,059 --> 00:00:50,039
crimes against children's task force and

25
00:00:50,039 --> 00:00:51,420
introduced me to this whole digital

26
00:00:51,420 --> 00:00:53,160
forensics thing

27
00:00:53,160 --> 00:00:56,039
occasionally I do blog and periodically

28
00:00:56,039 --> 00:00:58,500
I release data sets to the public those

29
00:00:58,500 --> 00:01:01,320
normally coincide with major releases of

30
00:01:01,320 --> 00:01:03,019
Android and iOS

31
00:01:03,019 --> 00:01:04,799
side note

32
00:01:04,799 --> 00:01:06,420
you can probably expect to see one

33
00:01:06,420 --> 00:01:08,400
coming up Android 13 was released a

34
00:01:08,400 --> 00:01:11,460
couple of hours ago

35
00:01:11,460 --> 00:01:13,740
when I'm not doing all that I do like to

36
00:01:13,740 --> 00:01:15,540
run I know a lot of people in the

37
00:01:15,540 --> 00:01:17,220
digital forensics Community are run

38
00:01:17,220 --> 00:01:19,860
averse but I do like to run to as my my

39
00:01:19,860 --> 00:01:21,720
release

40
00:01:21,720 --> 00:01:23,400
so before we get to talking about the

41
00:01:23,400 --> 00:01:25,920
malware I want to talk about why I feel

42
00:01:25,920 --> 00:01:27,659
like this was an important talk and I'm

43
00:01:27,659 --> 00:01:29,400
going to start on the desktop side of

44
00:01:29,400 --> 00:01:30,479
the house

45
00:01:30,479 --> 00:01:32,520
back in June Microsoft would release a

46
00:01:32,520 --> 00:01:34,799
report in which they describe their

47
00:01:34,799 --> 00:01:37,500
investigation into a organization that

48
00:01:37,500 --> 00:01:39,600
was leveraging several zero days to

49
00:01:39,600 --> 00:01:42,299
Target and exploit Windows hosts

50
00:01:42,299 --> 00:01:44,220
um it was the notweed report for those

51
00:01:44,220 --> 00:01:46,560
of you that may have read it

52
00:01:46,560 --> 00:01:50,280
and in that report they used a phrase

53
00:01:50,280 --> 00:01:51,960
that has been around now for just about

54
00:01:51,960 --> 00:01:55,380
a year private sector offensive actor

55
00:01:55,380 --> 00:01:57,240
and for those of you that may not

56
00:01:57,240 --> 00:01:58,799
necessarily be familiar with that term

57
00:01:58,799 --> 00:02:02,640
that describes a organization that

58
00:02:02,640 --> 00:02:05,360
through whatever means they identify

59
00:02:05,360 --> 00:02:08,520
zero days in various platforms and

60
00:02:08,520 --> 00:02:10,380
instead of going through the mechanism

61
00:02:10,380 --> 00:02:12,780
for responsible reporting they take

62
00:02:12,780 --> 00:02:15,420
those exploits they package them up as a

63
00:02:15,420 --> 00:02:17,400
service and then they Market that

64
00:02:17,400 --> 00:02:20,099
service to interested parties

65
00:02:20,099 --> 00:02:22,980
now the fact that these organizations

66
00:02:22,980 --> 00:02:26,099
exist and there's a market for this

67
00:02:26,099 --> 00:02:27,660
particular service just brings to light

68
00:02:27,660 --> 00:02:29,220
the problem

69
00:02:29,220 --> 00:02:32,459
we are all walking around with lucrative

70
00:02:32,459 --> 00:02:35,280
targets and our back pockets

71
00:02:35,280 --> 00:02:37,560
and that is because the information that

72
00:02:37,560 --> 00:02:40,379
is contained on our phones can be very

73
00:02:40,379 --> 00:02:43,879
valuable to interested parties

74
00:02:43,980 --> 00:02:46,160
these organizations understand this

75
00:02:46,160 --> 00:02:49,440
malicious actors also understand this

76
00:02:49,440 --> 00:02:51,360
and they're trying very hard to get on

77
00:02:51,360 --> 00:02:53,580
our devices to commit on device fraud

78
00:02:53,580 --> 00:02:56,160
still our information whether it be

79
00:02:56,160 --> 00:02:59,040
credentials you know contact information

80
00:02:59,040 --> 00:03:03,560
and Communications what have you

81
00:03:03,900 --> 00:03:06,239
now I'm from North Carolina uh not

82
00:03:06,239 --> 00:03:07,980
necessarily deep deep south but I feel

83
00:03:07,980 --> 00:03:10,560
like I am allowed to say this

84
00:03:10,560 --> 00:03:14,159
Google unless their hearts they try very

85
00:03:14,159 --> 00:03:16,920
hard uh to keep malware out of the Play

86
00:03:16,920 --> 00:03:19,080
Store but they still struggle and that

87
00:03:19,080 --> 00:03:21,360
results in headlines that look like this

88
00:03:21,360 --> 00:03:24,780
and these are not small these are all um

89
00:03:24,780 --> 00:03:26,640
articles from the past month these are

90
00:03:26,640 --> 00:03:27,959
not small numbers that we're seeing

91
00:03:27,959 --> 00:03:30,599
right a hundred thousand plus a million

92
00:03:30,599 --> 00:03:33,720
downloads three million downloads uh

93
00:03:33,720 --> 00:03:35,760
relatively speaking probably a very

94
00:03:35,760 --> 00:03:37,080
small fraction of the overall Android

95
00:03:37,080 --> 00:03:40,080
install base but this is still a lot of

96
00:03:40,080 --> 00:03:43,080
potential victims and as mobile device

97
00:03:43,080 --> 00:03:45,060
examiners we need to just go ahead and

98
00:03:45,060 --> 00:03:47,280
come through the realization that

99
00:03:47,280 --> 00:03:47,879
um

100
00:03:47,879 --> 00:03:50,040
it's no longer a matter of if we're

101
00:03:50,040 --> 00:03:52,319
going to run across malware on a mobile

102
00:03:52,319 --> 00:03:55,440
device it's now a matter of when

103
00:03:55,440 --> 00:03:58,140
so considering all that what I wanted to

104
00:03:58,140 --> 00:04:00,480
do is take a look at malware on Android

105
00:04:00,480 --> 00:04:03,060
from two perspectives

106
00:04:03,060 --> 00:04:05,580
the first being the perspective of an

107
00:04:05,580 --> 00:04:07,379
examiner right

108
00:04:07,379 --> 00:04:09,420
as examiners we normally think of

109
00:04:09,420 --> 00:04:11,400
malware on Android hey I need to pull

110
00:04:11,400 --> 00:04:13,680
this APK off pull the Android manifest

111
00:04:13,680 --> 00:04:15,180
file out look at what permissions are

112
00:04:15,180 --> 00:04:17,880
there and possibly reverse engineer some

113
00:04:17,880 --> 00:04:21,540
of this code that's great but

114
00:04:21,540 --> 00:04:23,280
you may not necessarily be able to

115
00:04:23,280 --> 00:04:26,100
reverse engineer code all the time

116
00:04:26,100 --> 00:04:28,740
you may not have the skills needed to do

117
00:04:28,740 --> 00:04:32,100
it and that's fine you may not have time

118
00:04:32,100 --> 00:04:34,500
to do it whether you're you know

119
00:04:34,500 --> 00:04:37,199
criminal justice uh examiner and you

120
00:04:37,199 --> 00:04:39,000
have a very large backlog or if you're

121
00:04:39,000 --> 00:04:40,979
in consultancy and you just don't have a

122
00:04:40,979 --> 00:04:43,680
budget built out for reverse engineering

123
00:04:43,680 --> 00:04:46,500
code regardless reverse engineering may

124
00:04:46,500 --> 00:04:49,080
not necessarily always be an option for

125
00:04:49,080 --> 00:04:49,919
you

126
00:04:49,919 --> 00:04:52,500
the second perspective is that of a user

127
00:04:52,500 --> 00:04:54,780
a user is going to have a lot of good

128
00:04:54,780 --> 00:04:56,580
information for you as far as

129
00:04:56,580 --> 00:04:59,160
unexplained or odd behavior on a device

130
00:04:59,160 --> 00:05:01,860
but that person may not be available to

131
00:05:01,860 --> 00:05:03,060
you all the time

132
00:05:03,060 --> 00:05:05,400
they may be an opposing party in some

133
00:05:05,400 --> 00:05:07,740
type of legal proceeding or they may

134
00:05:07,740 --> 00:05:09,540
have the ultimate on availability they

135
00:05:09,540 --> 00:05:11,100
may be deceased

136
00:05:11,100 --> 00:05:12,360
for those of you that work in law

137
00:05:12,360 --> 00:05:14,220
enforcement how many times have you had

138
00:05:14,220 --> 00:05:16,320
a deceased individual Stone brought to

139
00:05:16,320 --> 00:05:18,720
you and the investigator says hey

140
00:05:18,720 --> 00:05:20,639
find me all the things right that

141
00:05:20,639 --> 00:05:22,740
happens all the time

142
00:05:22,740 --> 00:05:25,979
um so in order to look at it from both

143
00:05:25,979 --> 00:05:28,020
perspectives I took a page out of the

144
00:05:28,020 --> 00:05:30,180
security researchers Playbook

145
00:05:30,180 --> 00:05:32,940
and I set up

146
00:05:32,940 --> 00:05:35,160
a honey farm now this is just a honey

147
00:05:35,160 --> 00:05:38,100
pot but I thought hey you know security

148
00:05:38,100 --> 00:05:39,780
researchers do this all the time on the

149
00:05:39,780 --> 00:05:42,360
desktop side why can't we do this on the

150
00:05:42,360 --> 00:05:43,080
mobile

151
00:05:43,080 --> 00:05:44,880
and

152
00:05:44,880 --> 00:05:47,460
when I started this process I my

153
00:05:47,460 --> 00:05:49,320
intention was to have a physical phone

154
00:05:49,320 --> 00:05:51,300
available

155
00:05:51,300 --> 00:05:53,639
live on it for a while generate a lot of

156
00:05:53,639 --> 00:05:55,680
test data and then just infect it with

157
00:05:55,680 --> 00:05:58,020
malware and let the malware run rampant

158
00:05:58,020 --> 00:06:00,600
and what I found as I got into this was

159
00:06:00,600 --> 00:06:02,520
the

160
00:06:02,520 --> 00:06:04,979
current Trend in Mobile and malware on

161
00:06:04,979 --> 00:06:06,840
Android really involves banking Trojans

162
00:06:06,840 --> 00:06:08,460
and on device sprawling but I wanted to

163
00:06:08,460 --> 00:06:09,780
look at a different piece of malware

164
00:06:09,780 --> 00:06:12,600
that had a different objective other

165
00:06:12,600 --> 00:06:14,460
than just fraud and I was able to

166
00:06:14,460 --> 00:06:17,940
accomplish this as we'll see

167
00:06:17,940 --> 00:06:20,940
now if you've used any of my public data

168
00:06:20,940 --> 00:06:22,500
sets you know that there is a particular

169
00:06:22,500 --> 00:06:24,479
account that you always see I'm not

170
00:06:24,479 --> 00:06:26,520
quite ready to burn that account just

171
00:06:26,520 --> 00:06:29,520
yet so for this exercise I have two new

172
00:06:29,520 --> 00:06:32,400
accounts one on each phone and each

173
00:06:32,400 --> 00:06:34,560
phone had its own separate set of

174
00:06:34,560 --> 00:06:37,800
third-party applications uh all that

175
00:06:37,800 --> 00:06:40,380
with test data in it and to make these

176
00:06:40,380 --> 00:06:42,300
devices a little bit more attractive to

177
00:06:42,300 --> 00:06:45,120
potential attackers I did put some uh

178
00:06:45,120 --> 00:06:47,100
financial apps on there

179
00:06:47,100 --> 00:06:49,139
however there are no accounts associated

180
00:06:49,139 --> 00:06:51,060
with these final financial apps and

181
00:06:51,060 --> 00:06:52,680
that's just because the uh the

182
00:06:52,680 --> 00:06:55,139
government frowns upon using false

183
00:06:55,139 --> 00:06:57,300
identities to open up uh Financial

184
00:06:57,300 --> 00:07:00,780
accounts but one of these phones did

185
00:07:00,780 --> 00:07:03,720
have uh some crypto on it I used an app

186
00:07:03,720 --> 00:07:06,180
called Ledger uh it uses a cold storage

187
00:07:06,180 --> 00:07:09,960
wallet and had some Bitcoin ethereum and

188
00:07:09,960 --> 00:07:12,960
some Dogecoin all on one particular

189
00:07:12,960 --> 00:07:15,300
phone now these phones were pixel threes

190
00:07:15,300 --> 00:07:18,419
they are able to run the most up-to-date

191
00:07:18,419 --> 00:07:20,759
version of Android at the time when I

192
00:07:20,759 --> 00:07:22,440
was uh when I started this which was

193
00:07:22,440 --> 00:07:24,960
Android 12 and it was running the latest

194
00:07:24,960 --> 00:07:28,460
security patch at the time

195
00:07:31,020 --> 00:07:33,180
the first phone belongs to Mr Thomas

196
00:07:33,180 --> 00:07:36,120
defer or defer depending on how you want

197
00:07:36,120 --> 00:07:39,000
to pronounce it I lived on his phone for

198
00:07:39,000 --> 00:07:41,400
approximately a month and a half and uh

199
00:07:41,400 --> 00:07:44,460
that phone ran in an unrooted State for

200
00:07:44,460 --> 00:07:46,440
the entire time up until the very last

201
00:07:46,440 --> 00:07:48,840
second when I rooted it so I could get a

202
00:07:48,840 --> 00:07:50,220
full file system

203
00:07:50,220 --> 00:07:53,039
his phone had three malware samples on

204
00:07:53,039 --> 00:07:53,759
it

205
00:07:53,759 --> 00:07:56,280
the first is t-bot and in the

206
00:07:56,280 --> 00:07:58,199
parentheses below that is the APK name

207
00:07:58,199 --> 00:08:00,960
for that particular piece t-bot was

208
00:08:00,960 --> 00:08:02,880
caught earlier this year in the Google

209
00:08:02,880 --> 00:08:05,819
Play Store that is a legitimate QR code

210
00:08:05,819 --> 00:08:08,460
and Barcode Scanner it functions but

211
00:08:08,460 --> 00:08:10,919
this is a dropper what would happen is

212
00:08:10,919 --> 00:08:13,440
when a user would open this app at first

213
00:08:13,440 --> 00:08:15,620
run time it would download and add on

214
00:08:15,620 --> 00:08:18,360
and that was the malicious payload that

215
00:08:18,360 --> 00:08:21,060
came to the phone

216
00:08:21,060 --> 00:08:23,220
um it is a banking Trojan so it has all

217
00:08:23,220 --> 00:08:25,080
the typical features it can uh

218
00:08:25,080 --> 00:08:28,620
screenshot uh read your messages uh it

219
00:08:28,620 --> 00:08:30,000
can grant itself additional permissions

220
00:08:30,000 --> 00:08:32,039
if needed and there is a remote access

221
00:08:32,039 --> 00:08:34,679
capability to it should a human operator

222
00:08:34,679 --> 00:08:37,620
decide to hop on your device

223
00:08:37,620 --> 00:08:40,279
the second malware sample is sharkbot

224
00:08:40,279 --> 00:08:42,839
again another banking Trojan very

225
00:08:42,839 --> 00:08:44,880
similar to t-bot

226
00:08:44,880 --> 00:08:46,800
also in the play store earlier this year

227
00:08:46,800 --> 00:08:50,580
this is another dropper uh unlike t-bot

228
00:08:50,580 --> 00:08:52,380
what would happen is when this was

229
00:08:52,380 --> 00:08:54,300
installed it would silently download the

230
00:08:54,300 --> 00:08:56,459
malicious payload in the background the

231
00:08:56,459 --> 00:08:59,279
user would never be aware that this app

232
00:08:59,279 --> 00:09:01,980
did this in the background uh on being

233
00:09:01,980 --> 00:09:04,380
um with no intervention on their part

234
00:09:04,380 --> 00:09:07,260
in addition to the same capabilities as

235
00:09:07,260 --> 00:09:09,300
t-bot this also has a key logging

236
00:09:09,300 --> 00:09:12,240
function and a um it has the ability to

237
00:09:12,240 --> 00:09:14,700
perform injection attacks or overlay

238
00:09:14,700 --> 00:09:17,760
attacks so you would have an app that

239
00:09:17,760 --> 00:09:20,519
was open with a screen shortcut would

240
00:09:20,519 --> 00:09:22,380
overlay its screen on top of it you

241
00:09:22,380 --> 00:09:23,700
punch in your credentials and boom

242
00:09:23,700 --> 00:09:25,740
sharkbot has your creds it would send

243
00:09:25,740 --> 00:09:28,920
off to a C2 somewhere

244
00:09:28,920 --> 00:09:32,519
third variant is Escobar

245
00:09:32,519 --> 00:09:33,360
um

246
00:09:33,360 --> 00:09:35,580
and again you can see the APK name in

247
00:09:35,580 --> 00:09:37,680
the parentheses uh I wrote about this

248
00:09:37,680 --> 00:09:39,779
earlier this year it is not necessarily

249
00:09:39,779 --> 00:09:41,820
a banking Trojan but it does have

250
00:09:41,820 --> 00:09:45,180
banking Trojan like capabilities but in

251
00:09:45,180 --> 00:09:47,100
addition to those it's also able to grab

252
00:09:47,100 --> 00:09:50,760
your location and record video and audio

253
00:09:50,760 --> 00:09:54,300
again without your knowledge and there

254
00:09:54,300 --> 00:09:57,480
is also the ability to use a VNC module

255
00:09:57,480 --> 00:09:59,100
to allow an attacker to hop on your

256
00:09:59,100 --> 00:10:00,120
device

257
00:10:00,120 --> 00:10:02,459
the GIF on the right shows me granting

258
00:10:02,459 --> 00:10:06,540
access to granting Escobar access to the

259
00:10:06,540 --> 00:10:08,160
accessibility services and as you can

260
00:10:08,160 --> 00:10:11,040
see as soon as I click that switch it

261
00:10:11,040 --> 00:10:13,080
grants itself all of these permissions

262
00:10:13,080 --> 00:10:14,940
and Rapid succession

263
00:10:14,940 --> 00:10:18,060
so fast I can't even get it on video

264
00:10:18,060 --> 00:10:20,399
and then as a defensive mechanism what

265
00:10:20,399 --> 00:10:22,260
happened was Android tried the term play

266
00:10:22,260 --> 00:10:24,540
protect back on I had turned it off to

267
00:10:24,540 --> 00:10:27,420
make sure that the uh the malware is

268
00:10:27,420 --> 00:10:30,480
successfully installed and it tried to

269
00:10:30,480 --> 00:10:32,220
turn itself a couple times uh turn

270
00:10:32,220 --> 00:10:34,019
itself on a couple times and then I

271
00:10:34,019 --> 00:10:36,060
caught it and as you can see Escobar

272
00:10:36,060 --> 00:10:38,279
injected itself out of the most recently

273
00:10:38,279 --> 00:10:41,040
used apps tray

274
00:10:41,040 --> 00:10:42,959
the second phone belongs to Elizabeth

275
00:10:42,959 --> 00:10:45,959
denner Liz if there are any Star Trek

276
00:10:45,959 --> 00:10:47,760
fans out there you'll recognize that

277
00:10:47,760 --> 00:10:49,260
name she is a character from the

278
00:10:49,260 --> 00:10:50,700
original series

279
00:10:50,700 --> 00:10:52,380
I lived on her phone for about three and

280
00:10:52,380 --> 00:10:54,839
a half weeks and she had two samples on

281
00:10:54,839 --> 00:10:57,660
her phone and she was rooted the entire

282
00:10:57,660 --> 00:11:00,140
time uh that I was running this exercise

283
00:11:00,140 --> 00:11:02,959
the first piece of malware is Molly bot

284
00:11:02,959 --> 00:11:05,760
mollybot is a relatively new banking

285
00:11:05,760 --> 00:11:07,140
Trojan

286
00:11:07,140 --> 00:11:09,300
as you can see the the APK name in the

287
00:11:09,300 --> 00:11:10,440
parentheses

288
00:11:10,440 --> 00:11:12,360
this has the ability to masquerade as

289
00:11:12,360 --> 00:11:14,579
different types of apps but this

290
00:11:14,579 --> 00:11:16,560
particular samples case it tried to be

291
00:11:16,560 --> 00:11:19,620
Chrome as you see I exposed the

292
00:11:19,620 --> 00:11:21,779
notification or the recently used apps

293
00:11:21,779 --> 00:11:24,600
tray you can see there is

294
00:11:24,600 --> 00:11:26,760
um Molly bot and then the actual Chrome

295
00:11:26,760 --> 00:11:28,800
was next to it now the interesting thing

296
00:11:28,800 --> 00:11:30,779
about mollybot is

297
00:11:30,779 --> 00:11:33,060
anytime I opened any third-party

298
00:11:33,060 --> 00:11:34,860
application or certain native Android

299
00:11:34,860 --> 00:11:36,600
applications that would present me with

300
00:11:36,600 --> 00:11:38,459
this Google login screen and it got to

301
00:11:38,459 --> 00:11:40,800
the point where the phone was barely

302
00:11:40,800 --> 00:11:43,620
usable but it ended up malfunctioning at

303
00:11:43,620 --> 00:11:45,120
some point and this went away which was

304
00:11:45,120 --> 00:11:47,399
kind of nice

305
00:11:47,399 --> 00:11:49,500
the last piece of malware is hermit now

306
00:11:49,500 --> 00:11:51,660
hermit has been Associated by both

307
00:11:51,660 --> 00:11:54,540
Lookouts and Google as uh being

308
00:11:54,540 --> 00:11:57,240
associated with RCS lab so again one of

309
00:11:57,240 --> 00:12:00,300
those private sector offensive actors a

310
00:12:00,300 --> 00:12:01,920
very interesting backstory I'm not going

311
00:12:01,920 --> 00:12:03,420
to get into it I would highly recommend

312
00:12:03,420 --> 00:12:05,279
reading the Google and Lookout reports

313
00:12:05,279 --> 00:12:07,100
on this particular variant

314
00:12:07,100 --> 00:12:09,839
but as you can see in the GIF on the

315
00:12:09,839 --> 00:12:12,480
left it needs a bunch of permissions to

316
00:12:12,480 --> 00:12:14,399
operate but the interesting thing is

317
00:12:14,399 --> 00:12:17,100
once you get past this screen it opens

318
00:12:17,100 --> 00:12:19,560
legitimate Samsung Pages it was

319
00:12:19,560 --> 00:12:22,500
masquerading as Samsung helper but there

320
00:12:22,500 --> 00:12:25,320
are other variants That masquerade as

321
00:12:25,320 --> 00:12:28,560
like Facebook support WhatsApp support

322
00:12:28,560 --> 00:12:32,300
um you know the various meta products

323
00:12:32,399 --> 00:12:35,100
so I have two phones both are infected

324
00:12:35,100 --> 00:12:37,740
with malware where do I start and the

325
00:12:37,740 --> 00:12:39,300
answer to that question is the usual

326
00:12:39,300 --> 00:12:42,180
digital forensics answer it depends

327
00:12:42,180 --> 00:12:45,000
right it depends on what you know about

328
00:12:45,000 --> 00:12:47,040
that phone the Intel that you've got

329
00:12:47,040 --> 00:12:49,079
either by way of the user or if an

330
00:12:49,079 --> 00:12:50,579
investigator has brought this phone to

331
00:12:50,579 --> 00:12:53,040
you and can relate it relay that to you

332
00:12:53,040 --> 00:12:56,040
or it can be personal preference in this

333
00:12:56,040 --> 00:12:58,980
case I went with personal preference and

334
00:12:58,980 --> 00:13:01,200
I would like to see what apps are

335
00:13:01,200 --> 00:13:02,579
currently on the phone but have

336
00:13:02,579 --> 00:13:04,440
historically been on that phone as well

337
00:13:04,440 --> 00:13:06,480
and there are three three particular

338
00:13:06,480 --> 00:13:09,600
files that you can use to see that the

339
00:13:09,600 --> 00:13:12,019
first is Local app state DOT DB

340
00:13:12,019 --> 00:13:15,300
frostingdb and packages.xml now the

341
00:13:15,300 --> 00:13:16,800
reason I have all three of these files

342
00:13:16,800 --> 00:13:19,139
on one slide is to get the best overall

343
00:13:19,139 --> 00:13:20,220
View

344
00:13:20,220 --> 00:13:23,100
of all these apps is to look at these

345
00:13:23,100 --> 00:13:25,079
files collectively they have to be

346
00:13:25,079 --> 00:13:27,360
examined together in order to get the

347
00:13:27,360 --> 00:13:28,920
best picture

348
00:13:28,920 --> 00:13:31,980
this is Local app State B from Tom's

349
00:13:31,980 --> 00:13:33,839
phone as you can see there's some nice

350
00:13:33,839 --> 00:13:36,180
columns in here package name

351
00:13:36,180 --> 00:13:38,880
first download the Google account that's

352
00:13:38,880 --> 00:13:40,680
associated with the with the app and

353
00:13:40,680 --> 00:13:42,839
then the name or the friendly name all

354
00:13:42,839 --> 00:13:44,760
the way there on the right

355
00:13:44,760 --> 00:13:47,040
now I sorted I tried to filter the

356
00:13:47,040 --> 00:13:49,800
package column by Escobar that was the

357
00:13:49,800 --> 00:13:51,600
easiest term for me to remember because

358
00:13:51,600 --> 00:13:53,760
it wasn't gibberish and as you can see

359
00:13:53,760 --> 00:13:55,920
at the bottom uh I came up with nothing

360
00:13:55,920 --> 00:13:58,200
in fact none of the malware samples

361
00:13:58,200 --> 00:14:01,320
appeared in Local app state DOT DB and

362
00:14:01,320 --> 00:14:03,660
that's because Local app State DB is

363
00:14:03,660 --> 00:14:05,940
designed to keep tabs on apps that are

364
00:14:05,940 --> 00:14:07,380
coming from your uh the Google Play

365
00:14:07,380 --> 00:14:08,279
Store

366
00:14:08,279 --> 00:14:10,860
to get a view of what apps are side

367
00:14:10,860 --> 00:14:12,240
loaded

368
00:14:12,240 --> 00:14:14,519
not coming from the Play Store you need

369
00:14:14,519 --> 00:14:17,040
to go to frosting.db and this is uh here

370
00:14:17,040 --> 00:14:18,300
I've got the the malware samples

371
00:14:18,300 --> 00:14:20,459
highlighted each one of these malware

372
00:14:20,459 --> 00:14:22,740
samples were side loaded they were

373
00:14:22,740 --> 00:14:25,079
pushed to the file to the phones rather

374
00:14:25,079 --> 00:14:27,899
by ADB and then I use Google files to

375
00:14:27,899 --> 00:14:31,019
install the apps

376
00:14:31,019 --> 00:14:33,540
so now I have some some apps didn't come

377
00:14:33,540 --> 00:14:35,519
from the Google Play Store but they're

378
00:14:35,519 --> 00:14:38,339
here where did they come from well

379
00:14:38,339 --> 00:14:40,380
that's where packages.xml comes into

380
00:14:40,380 --> 00:14:43,019
played again this is from Tom's phone in

381
00:14:43,019 --> 00:14:44,459
the red I have the the package name

382
00:14:44,459 --> 00:14:46,680
highlighted that's Escobar but the key

383
00:14:46,680 --> 00:14:49,139
area here is the area in blue

384
00:14:49,139 --> 00:14:51,000
there's a tag there's a tag value in

385
00:14:51,000 --> 00:14:52,920
there called installer equals and it

386
00:14:52,920 --> 00:14:56,100
ends with mbu DOT files that is the APK

387
00:14:56,100 --> 00:14:58,560
name for the Google files app that makes

388
00:14:58,560 --> 00:15:00,540
sense because I use Google files to

389
00:15:00,540 --> 00:15:02,820
install all the malware

390
00:15:02,820 --> 00:15:06,000
if an app comes to Android by way of the

391
00:15:06,000 --> 00:15:09,740
Google Play Store that value will be

392
00:15:09,740 --> 00:15:12,060
com.android.vending that is the APK name

393
00:15:12,060 --> 00:15:13,440
from Play Store

394
00:15:13,440 --> 00:15:16,199
now you will find apps in this file that

395
00:15:16,199 --> 00:15:18,420
have no installer value it just won't be

396
00:15:18,420 --> 00:15:20,279
there and that's fine these are

397
00:15:20,279 --> 00:15:22,380
typically apps that are associated with

398
00:15:22,380 --> 00:15:25,680
Android and you can you know freezone

399
00:15:25,680 --> 00:15:29,479
Passos they're not that big of a deal

400
00:15:29,639 --> 00:15:32,100
a-leap will parse all three of these

401
00:15:32,100 --> 00:15:34,019
files for you this is uh again from Tom

402
00:15:34,019 --> 00:15:37,620
Stone this is the packages.xml report

403
00:15:37,620 --> 00:15:40,380
and I've got it filtered by

404
00:15:40,380 --> 00:15:41,600
um

405
00:15:41,600 --> 00:15:45,720
apps that were installed by Google files

406
00:15:45,720 --> 00:15:47,399
and you can see in the blue that's

407
00:15:47,399 --> 00:15:49,139
Google files in the red those are my

408
00:15:49,139 --> 00:15:52,320
malware samples and again a lead can

409
00:15:52,320 --> 00:15:55,399
parse all three of those files for you

410
00:15:55,399 --> 00:15:57,959
now we'll switch gears for a second or

411
00:15:57,959 --> 00:15:59,940
now and talk about battery I don't want

412
00:15:59,940 --> 00:16:01,199
to bring up something that I know

413
00:16:01,199 --> 00:16:03,420
appears sometimes in the in Sans uh

414
00:16:03,420 --> 00:16:04,680
instructional materials and that's the

415
00:16:04,680 --> 00:16:06,060
malware paradox

416
00:16:06,060 --> 00:16:10,440
malware can hide but it must run and on

417
00:16:10,440 --> 00:16:12,420
a phone it's going to need resources to

418
00:16:12,420 --> 00:16:15,240
do that right it needs access to the CPU

419
00:16:15,240 --> 00:16:17,880
needs access to memory and those things

420
00:16:17,880 --> 00:16:19,500
in turn are gonna need access to the

421
00:16:19,500 --> 00:16:21,839
battery now Android 12 has a new thing

422
00:16:21,839 --> 00:16:23,940
called battery usage I'm not going to

423
00:16:23,940 --> 00:16:26,399
get into that uh mainly because again

424
00:16:26,399 --> 00:16:29,519
that's fairly new I will direct you to

425
00:16:29,519 --> 00:16:32,880
an article that Kevin Pagano wrote about

426
00:16:32,880 --> 00:16:35,220
battery usage but just know battery

427
00:16:35,220 --> 00:16:37,500
usage is an option if it's Android 12 or

428
00:16:37,500 --> 00:16:41,100
13 and a lead can parse it for you but

429
00:16:41,100 --> 00:16:42,899
what about all these other devices that

430
00:16:42,899 --> 00:16:45,120
are not running Android 12. and as it

431
00:16:45,120 --> 00:16:46,860
turns out there is a utility that Google

432
00:16:46,860 --> 00:16:48,899
offers that can help us answer these

433
00:16:48,899 --> 00:16:50,100
questions with regards to battery

434
00:16:50,100 --> 00:16:52,560
decision is called battery historian

435
00:16:52,560 --> 00:16:54,480
Now battery historian is designed by

436
00:16:54,480 --> 00:16:58,519
Google uh to let app Developers

437
00:16:58,519 --> 00:17:00,779
troubleshoot their apps if there is a

438
00:17:00,779 --> 00:17:03,180
situation where their app is draining

439
00:17:03,180 --> 00:17:05,220
you know a lot of battery

440
00:17:05,220 --> 00:17:07,500
but we can use it for this particular

441
00:17:07,500 --> 00:17:08,760
purpose

442
00:17:08,760 --> 00:17:10,559
battery historian runs in a Docker

443
00:17:10,559 --> 00:17:12,540
container I'm not going to get into the

444
00:17:12,540 --> 00:17:14,579
setup process just know that where you

445
00:17:14,579 --> 00:17:16,799
download Battery historian from there's

446
00:17:16,799 --> 00:17:19,319
an excellent set of instructions that

447
00:17:19,319 --> 00:17:20,640
will walk you through that process it

448
00:17:20,640 --> 00:17:21,900
will have you up and running in about

449
00:17:21,900 --> 00:17:23,339
five minutes

450
00:17:23,339 --> 00:17:25,079
Now battery historian needs two things

451
00:17:25,079 --> 00:17:28,319
to operate battery stats dot text and a

452
00:17:28,319 --> 00:17:29,940
bug report from the phone and there's

453
00:17:29,940 --> 00:17:31,440
two ways to get a hold of those things

454
00:17:31,440 --> 00:17:34,799
the first and in my opinion the easiest

455
00:17:34,799 --> 00:17:37,260
way to do that is to use Android triage

456
00:17:37,260 --> 00:17:39,539
which is a tool that Matia Epiphany

457
00:17:39,539 --> 00:17:41,880
offers it's freely available you can run

458
00:17:41,880 --> 00:17:44,100
out to this GitHub repo and pull it down

459
00:17:44,100 --> 00:17:46,200
choosing option one will generate those

460
00:17:46,200 --> 00:17:49,080
two things for you and deposit it onto

461
00:17:49,080 --> 00:17:51,720
your workstation in a nice folder

462
00:17:51,720 --> 00:17:55,080
the other option is to use uh ADB on the

463
00:17:55,080 --> 00:17:56,280
command line

464
00:17:56,280 --> 00:17:58,380
I know a lot of people tend to shy away

465
00:17:58,380 --> 00:18:00,980
from command line uh and ADV in general

466
00:18:00,980 --> 00:18:03,240
but if you're comfortable with it and

467
00:18:03,240 --> 00:18:05,280
that is an option for you knock yourself

468
00:18:05,280 --> 00:18:08,460
out but again Android triage is the best

469
00:18:08,460 --> 00:18:12,660
way to tackle it no fuss now once you

470
00:18:12,660 --> 00:18:14,100
get those two things and you get it

471
00:18:14,100 --> 00:18:16,200
imported it's a battery historian this

472
00:18:16,200 --> 00:18:18,360
is what it's going to look like this is

473
00:18:18,360 --> 00:18:20,280
from Tom Stone and I will draw your

474
00:18:20,280 --> 00:18:22,980
attention to that line that goes you

475
00:18:22,980 --> 00:18:25,440
know there's a decline a sharp incline

476
00:18:25,440 --> 00:18:27,600
and then another decline that is

477
00:18:27,600 --> 00:18:29,880
actually the battery discharging over a

478
00:18:29,880 --> 00:18:33,720
48 hour period the phone discharged over

479
00:18:33,720 --> 00:18:36,660
24 hours I charged it and then it

480
00:18:36,660 --> 00:18:39,539
discharged yet again this is highly

481
00:18:39,539 --> 00:18:41,700
unusual for Tom Stone because that phone

482
00:18:41,700 --> 00:18:43,620
has been an absolute Workhorse for me

483
00:18:43,620 --> 00:18:46,140
for the past three years and it was

484
00:18:46,140 --> 00:18:48,660
easily able to go two and a half three

485
00:18:48,660 --> 00:18:51,059
days uh without a charge so this is

486
00:18:51,059 --> 00:18:53,039
unusual for this particular phone

487
00:18:53,039 --> 00:18:54,600
I'll draw your attention to that area

488
00:18:54,600 --> 00:18:57,660
down in the bottom left that is the area

489
00:18:57,660 --> 00:19:00,179
where you can sort apps by different

490
00:19:00,179 --> 00:19:01,980
metrics so in this case since we're

491
00:19:01,980 --> 00:19:04,320
talking about battery usage I want to

492
00:19:04,320 --> 00:19:06,480
sort all the apps on this phone by

493
00:19:06,480 --> 00:19:08,280
battery usage and see how they all look

494
00:19:08,280 --> 00:19:10,559
as compared to each other and when I do

495
00:19:10,559 --> 00:19:11,640
that

496
00:19:11,640 --> 00:19:14,039
you can see Escobar is all the way at

497
00:19:14,039 --> 00:19:15,539
the top

498
00:19:15,539 --> 00:19:18,480
now remember this is a 48 hour or this

499
00:19:18,480 --> 00:19:21,960
is about 48 hours worth of data and in a

500
00:19:21,960 --> 00:19:25,740
48 hour period it's using just under 58

501
00:19:25,740 --> 00:19:28,919
of the total battery power which is huge

502
00:19:28,919 --> 00:19:30,419
because I can't even interact with this

503
00:19:30,419 --> 00:19:32,100
particular app

504
00:19:32,100 --> 00:19:34,020
anytime I try to open this app it would

505
00:19:34,020 --> 00:19:36,419
immediately uh eject me out of the

506
00:19:36,419 --> 00:19:38,460
screen and then lock the phone

507
00:19:38,460 --> 00:19:41,039
so I have no interaction with this uh

508
00:19:41,039 --> 00:19:44,100
app but yet it's using a lot of battery

509
00:19:44,100 --> 00:19:45,059
power

510
00:19:45,059 --> 00:19:46,980
the second red box there in the middle

511
00:19:46,980 --> 00:19:49,500
and that is um

512
00:19:49,500 --> 00:19:52,860
t-bot and again uh another app I can't

513
00:19:52,860 --> 00:19:54,900
interact with and then pulling up the

514
00:19:54,900 --> 00:19:57,660
rear is sharkbot yet another app that I

515
00:19:57,660 --> 00:19:59,220
cannot interact with

516
00:19:59,220 --> 00:20:00,840
so

517
00:20:00,840 --> 00:20:03,660
um you know battery usage is is Big this

518
00:20:03,660 --> 00:20:05,460
is the best way to take a look at it but

519
00:20:05,460 --> 00:20:07,799
what about CPU usage well battery

520
00:20:07,799 --> 00:20:09,360
historian can actually help you with

521
00:20:09,360 --> 00:20:11,820
that as well and again no surprises here

522
00:20:11,820 --> 00:20:15,179
Escobar takes the top uh you know it was

523
00:20:15,179 --> 00:20:19,020
just over 23 hours uh it was on the CP

524
00:20:19,020 --> 00:20:21,299
for just over 23 hours during that 48

525
00:20:21,299 --> 00:20:23,100
hour period again which is huge because

526
00:20:23,100 --> 00:20:25,020
I can't interact with it

527
00:20:25,020 --> 00:20:27,240
um just below that is the sharkbot

528
00:20:27,240 --> 00:20:31,020
dropper which was a surprising find and

529
00:20:31,020 --> 00:20:33,600
uh t-bot is just below that and as

530
00:20:33,600 --> 00:20:36,299
before sharpbot is pulling up the rear

531
00:20:36,299 --> 00:20:39,660
now there are other uses of this data I

532
00:20:39,660 --> 00:20:43,980
can sort by what apps are sending and

533
00:20:43,980 --> 00:20:46,200
transmitting data and how much data is

534
00:20:46,200 --> 00:20:48,240
getting sent and received but actually

535
00:20:48,240 --> 00:20:50,280
this will also tell you what apps are

536
00:20:50,280 --> 00:20:53,220
using uh location on the phone you can

537
00:20:53,220 --> 00:20:56,220
see when how often what frequency and

538
00:20:56,220 --> 00:20:57,240
whatnot

539
00:20:57,240 --> 00:20:59,160
but there is another place that you can

540
00:20:59,160 --> 00:21:01,620
go to see about location usage and it's

541
00:21:01,620 --> 00:21:03,360
new in Android 12 and I thought it was

542
00:21:03,360 --> 00:21:05,760
important to talk about it here

543
00:21:05,760 --> 00:21:08,400
and that's called privacy dashboard

544
00:21:08,400 --> 00:21:12,539
uh privacy dashboard is a way or is a a

545
00:21:12,539 --> 00:21:16,140
tool that a user can use to see what

546
00:21:16,140 --> 00:21:18,720
apps are using location camera and

547
00:21:18,720 --> 00:21:21,539
microphone over a 24-hour period and

548
00:21:21,539 --> 00:21:23,460
this goes for both native and

549
00:21:23,460 --> 00:21:26,700
third-party applications now

550
00:21:26,700 --> 00:21:29,159
in Android 12 this is a 24 hour period

551
00:21:29,159 --> 00:21:31,980
Android 13 expands that out to seven

552
00:21:31,980 --> 00:21:33,840
days which is nice because a lot of

553
00:21:33,840 --> 00:21:35,520
times potential victims are not going to

554
00:21:35,520 --> 00:21:37,440
unders know that there's gonna there's a

555
00:21:37,440 --> 00:21:40,440
problem uh for some time so it may take

556
00:21:40,440 --> 00:21:41,840
a user some time to figure out

557
00:21:41,840 --> 00:21:43,980
something's you know phone's acting

558
00:21:43,980 --> 00:21:46,140
weird or I might have spyware on my

559
00:21:46,140 --> 00:21:47,640
phone this is a good place to take a

560
00:21:47,640 --> 00:21:48,419
look

561
00:21:48,419 --> 00:21:49,760
now

562
00:21:49,760 --> 00:21:52,260
there are several nuances with this I'm

563
00:21:52,260 --> 00:21:55,260
not going to go deep dive into it but um

564
00:21:55,260 --> 00:21:57,120
I did write about it earlier this year

565
00:21:57,120 --> 00:21:59,220
so I'll refer you out to my blog article

566
00:21:59,220 --> 00:22:00,900
about it

567
00:22:00,900 --> 00:22:02,580
this is what it looks like to the user

568
00:22:02,580 --> 00:22:05,100
on the left that is the main dashboard

569
00:22:05,100 --> 00:22:07,020
in the middle that is the location

570
00:22:07,020 --> 00:22:09,360
dashboard for Liz's phone you can see

571
00:22:09,360 --> 00:22:12,419
Samsung helper that's hermit uh is using

572
00:22:12,419 --> 00:22:14,760
my location quite a bit and then on the

573
00:22:14,760 --> 00:22:18,120
right that's from Thomson McAfee that is

574
00:22:18,120 --> 00:22:21,900
Escobar on Thompson now you can see how

575
00:22:21,900 --> 00:22:24,900
often it's using my location all I was

576
00:22:24,900 --> 00:22:26,580
doing was slipping the phones in my back

577
00:22:26,580 --> 00:22:28,260
pocket and just walking around my house

578
00:22:28,260 --> 00:22:31,260
my house is not that big but yet it was

579
00:22:31,260 --> 00:22:33,799
these apps are grabbing my location

580
00:22:33,799 --> 00:22:36,240
often and if I were getting a car and

581
00:22:36,240 --> 00:22:37,799
drive these things both apps went

582
00:22:37,799 --> 00:22:39,539
absolutely Bonkers and I could just see

583
00:22:39,539 --> 00:22:41,520
the battery dropping as you know very

584
00:22:41,520 --> 00:22:44,419
quickly as I'm driving along

585
00:22:44,419 --> 00:22:47,760
the um the data for privacy dashboard is

586
00:22:47,760 --> 00:22:50,220
stored in XML but not just or any

587
00:22:50,220 --> 00:22:52,320
ordinary xmls that new Android binary

588
00:22:52,320 --> 00:22:56,520
XML or ABX Alex kafenas has a script

589
00:22:56,520 --> 00:22:58,860
that can parse these for you but a leap

590
00:22:58,860 --> 00:23:01,320
will also parse uh privacy dashboard for

591
00:23:01,320 --> 00:23:02,580
you as well

592
00:23:02,580 --> 00:23:04,200
but I've got it color coded here so you

593
00:23:04,200 --> 00:23:06,360
can see it in the red I have the app

594
00:23:06,360 --> 00:23:09,000
name and the APK name on the right and

595
00:23:09,000 --> 00:23:11,039
the green I have the times and in the

596
00:23:11,039 --> 00:23:14,100
blue I have what's being used now in XML

597
00:23:14,100 --> 00:23:16,080
you'll see op equals one it's an

598
00:23:16,080 --> 00:23:19,320
operation uh anytime camera microphone

599
00:23:19,320 --> 00:23:21,240
or location is used by the phone it's

600
00:23:21,240 --> 00:23:23,580
considered to be an operation op equals

601
00:23:23,580 --> 00:23:26,460
one is location op 26 equals camera and

602
00:23:26,460 --> 00:23:31,380
op 27 equals microphone

603
00:23:31,440 --> 00:23:34,080
same view but just from Tom's phone this

604
00:23:34,080 --> 00:23:38,419
is uh again Escobar and as you can see

605
00:23:38,419 --> 00:23:42,419
uh operation app name and the time

606
00:23:42,419 --> 00:23:44,940
stamps now what you see on the left from

607
00:23:44,940 --> 00:23:47,220
the user's point of view uh versus what

608
00:23:47,220 --> 00:23:50,520
you see in XML file it may be a little

609
00:23:50,520 --> 00:23:52,679
different I found that the XML files

610
00:23:52,679 --> 00:23:55,320
tend to be a little bit more verbose you

611
00:23:55,320 --> 00:23:57,240
will see more operations in there than

612
00:23:57,240 --> 00:23:59,640
what may be displayed to the user so

613
00:23:59,640 --> 00:24:01,799
user may tell you something you may find

614
00:24:01,799 --> 00:24:04,140
something extra in these XML files and

615
00:24:04,140 --> 00:24:06,240
that's perfectly normal

616
00:24:06,240 --> 00:24:10,620
now camera location microphone these you

617
00:24:10,620 --> 00:24:12,120
know in order for apps to use these

618
00:24:12,120 --> 00:24:14,700
things a user has to Grant permission to

619
00:24:14,700 --> 00:24:16,260
these apps in order to make this happen

620
00:24:16,260 --> 00:24:19,080
and these particular permissions and

621
00:24:19,080 --> 00:24:20,700
others that are very similar to it are

622
00:24:20,700 --> 00:24:23,400
part of dangerous permissions

623
00:24:23,400 --> 00:24:26,520
and dangerous permissions are those that

624
00:24:26,520 --> 00:24:28,980
Google fills can cause you as a user or

625
00:24:28,980 --> 00:24:31,679
the phone or both the most harm so again

626
00:24:31,679 --> 00:24:34,620
camera location microphone access to

627
00:24:34,620 --> 00:24:37,620
your files access to your phone access

628
00:24:37,620 --> 00:24:39,900
to your messages these are all parts of

629
00:24:39,900 --> 00:24:41,520
dangerous permissions

630
00:24:41,520 --> 00:24:44,820
the Montage on the right is Instagram uh

631
00:24:44,820 --> 00:24:46,320
this is what happens when you're on

632
00:24:46,320 --> 00:24:48,120
Instagram for the first time on Android

633
00:24:48,120 --> 00:24:50,100
phone it's asking you for particular

634
00:24:50,100 --> 00:24:51,600
permissions it wants to access your

635
00:24:51,600 --> 00:24:54,960
files access your location your

636
00:24:54,960 --> 00:24:59,280
microphone and your camera now

637
00:24:59,460 --> 00:25:00,780
the

638
00:25:00,780 --> 00:25:04,020
um these permissions are stored in a

639
00:25:04,020 --> 00:25:06,419
particular file and

640
00:25:06,419 --> 00:25:08,460
they're it's called runtime permissions

641
00:25:08,460 --> 00:25:11,340
which makes sense because uh the phone

642
00:25:11,340 --> 00:25:12,419
is going to ask you for these

643
00:25:12,419 --> 00:25:14,460
permissions at first or one time

644
00:25:14,460 --> 00:25:16,740
the thing to remember about this file is

645
00:25:16,740 --> 00:25:18,840
that these are the permissions that an

646
00:25:18,840 --> 00:25:21,659
app actually has on the phone not the

647
00:25:21,659 --> 00:25:24,900
ones that are requested in the Manifest

648
00:25:24,900 --> 00:25:27,299
file so you you may have in the Manifest

649
00:25:27,299 --> 00:25:28,740
file hey it's got all these permissions

650
00:25:28,740 --> 00:25:30,659
well you need to check this particular

651
00:25:30,659 --> 00:25:32,640
file to make sure that they were it was

652
00:25:32,640 --> 00:25:34,860
actually granted access to them

653
00:25:34,860 --> 00:25:37,080
there can be a disconnect

654
00:25:37,080 --> 00:25:39,840
this is from Liz's phone this is uh

655
00:25:39,840 --> 00:25:42,779
excerpt from that file for hermit as you

656
00:25:42,779 --> 00:25:44,820
can see it has a very long list of

657
00:25:44,820 --> 00:25:46,799
dangerous permissions I granted them all

658
00:25:46,799 --> 00:25:48,779
just to see what would happen

659
00:25:48,779 --> 00:25:51,840
now a user can grant a permission to and

660
00:25:51,840 --> 00:25:53,880
out but then change their mind so for

661
00:25:53,880 --> 00:25:56,100
example if I granted hermit everything

662
00:25:56,100 --> 00:25:58,080
under the sun and then I changed my mind

663
00:25:58,080 --> 00:25:59,279
later say you know what I don't want you

664
00:25:59,279 --> 00:26:00,900
to have access to my location anymore I

665
00:26:00,900 --> 00:26:02,760
can go through and turn that off

666
00:26:02,760 --> 00:26:05,279
now it could be possible that you know

667
00:26:05,279 --> 00:26:06,779
hermit could turn that back on or

668
00:26:06,779 --> 00:26:09,240
prevent me from changing that but just

669
00:26:09,240 --> 00:26:10,200
know

670
00:26:10,200 --> 00:26:12,299
this file can help you explain

671
00:26:12,299 --> 00:26:15,539
Behavioral or explain a lack of behavior

672
00:26:15,539 --> 00:26:17,220
if you think you're dealing with a

673
00:26:17,220 --> 00:26:19,380
malicious app

674
00:26:19,380 --> 00:26:21,840
a leap just like before we'll parse this

675
00:26:21,840 --> 00:26:23,700
file for you nice and neat again this is

676
00:26:23,700 --> 00:26:26,400
from Liz's phone this is Phil hermit and

677
00:26:26,400 --> 00:26:29,400
you can see the all the APK name the

678
00:26:29,400 --> 00:26:30,840
permission and whether or not it's

679
00:26:30,840 --> 00:26:32,880
granted if it's granted the value will

680
00:26:32,880 --> 00:26:36,240
be true if it's not granted the value

681
00:26:36,240 --> 00:26:39,059
will be false

682
00:26:39,059 --> 00:26:40,799
now I want to talk about accessibility

683
00:26:40,799 --> 00:26:42,480
Services uh

684
00:26:42,480 --> 00:26:44,700
real quick because

685
00:26:44,700 --> 00:26:46,980
accessibility Services isn't necessarily

686
00:26:46,980 --> 00:26:49,200
A permission per se but it's permission

687
00:26:49,200 --> 00:26:52,799
ish a user has to Grant access to

688
00:26:52,799 --> 00:26:54,539
accessibility services in order for an

689
00:26:54,539 --> 00:26:57,179
app to actually use it but when you go

690
00:26:57,179 --> 00:27:00,000
to do that Android warns you and that is

691
00:27:00,000 --> 00:27:02,100
a screenshot on the right you can see

692
00:27:02,100 --> 00:27:04,860
hey do you want to let Tick Tock have

693
00:27:04,860 --> 00:27:07,260
access to all of these things and that's

694
00:27:07,260 --> 00:27:09,539
because accessibility Services is really

695
00:27:09,539 --> 00:27:12,000
powerful it allows an app to do a whole

696
00:27:12,000 --> 00:27:14,580
lot of things for those of you that may

697
00:27:14,580 --> 00:27:16,320
be in the IR space this is the

698
00:27:16,320 --> 00:27:18,480
equivalent of getting domain admin on a

699
00:27:18,480 --> 00:27:21,840
domain controller if a uh if a malicious

700
00:27:21,840 --> 00:27:23,760
app gets this they've got the keys to

701
00:27:23,760 --> 00:27:24,840
the kingdom

702
00:27:24,840 --> 00:27:29,220
uh it can read your screen it can uh

703
00:27:29,220 --> 00:27:32,580
register touches on the screen it can

704
00:27:32,580 --> 00:27:34,740
overlay screens on top of others and

705
00:27:34,740 --> 00:27:36,720
these are things that all this malware

706
00:27:36,720 --> 00:27:38,940
likes to do in order to trick you into

707
00:27:38,940 --> 00:27:42,840
giving it you know valuable information

708
00:27:42,840 --> 00:27:44,880
on the left that is the accessibility

709
00:27:44,880 --> 00:27:47,940
Services dashboard for Liz's phone you

710
00:27:47,940 --> 00:27:49,559
can see Samsung helper that's Herman

711
00:27:49,559 --> 00:27:51,900
again has access to it and then you can

712
00:27:51,900 --> 00:27:53,700
see just above that Chrome that's

713
00:27:53,700 --> 00:27:56,220
mollybot and you say you say it says

714
00:27:56,220 --> 00:27:57,539
it's not working and again that gets

715
00:27:57,539 --> 00:28:00,059
back to that malfunctioning uh behavior

716
00:28:00,059 --> 00:28:02,520
that I saw from volleyball during this

717
00:28:02,520 --> 00:28:03,720
exercise

718
00:28:03,720 --> 00:28:05,700
now the good thing is an examiner can

719
00:28:05,700 --> 00:28:08,700
look at a particular file on Android to

720
00:28:08,700 --> 00:28:10,700
determine not only

721
00:28:10,700 --> 00:28:13,740
what apps have access to it but also if

722
00:28:13,740 --> 00:28:16,500
it's even turned on and that file is

723
00:28:16,500 --> 00:28:18,419
settings underscore secure

724
00:28:18,419 --> 00:28:20,279
now

725
00:28:20,279 --> 00:28:23,279
the uh there are two tags in this

726
00:28:23,279 --> 00:28:25,500
particular file that you'll need to take

727
00:28:25,500 --> 00:28:27,559
a look at the first is accessibility

728
00:28:27,559 --> 00:28:30,840
enabled it's very simple the value is

729
00:28:30,840 --> 00:28:32,880
either going to be zero or one zero if

730
00:28:32,880 --> 00:28:35,580
it means it's off one means you have

731
00:28:35,580 --> 00:28:37,440
more digging to do because something has

732
00:28:37,440 --> 00:28:39,480
access to accessibility Services which

733
00:28:39,480 --> 00:28:42,120
leads you to the second tag and that is

734
00:28:42,120 --> 00:28:44,340
access enabled accessibility Services

735
00:28:44,340 --> 00:28:46,320
now this tag is important because it

736
00:28:46,320 --> 00:28:48,539
tells you which apps have access to

737
00:28:48,539 --> 00:28:50,760
accessibility Services now if you're in

738
00:28:50,760 --> 00:28:52,020
a position like this where you have

739
00:28:52,020 --> 00:28:55,020
multiple apps that have access to it the

740
00:28:55,020 --> 00:28:58,279
app names will be delineated by a

741
00:28:58,279 --> 00:29:01,860
colon so here in this case I've got the

742
00:29:01,860 --> 00:29:04,320
APK name for hermit they're in the blue

743
00:29:04,320 --> 00:29:06,779
and then in the green I've got the APK

744
00:29:06,779 --> 00:29:09,840
name for mollybot

745
00:29:09,840 --> 00:29:11,700
this is from Tom's phone and again

746
00:29:11,700 --> 00:29:13,799
remember he had three apps

747
00:29:13,799 --> 00:29:16,260
um in the blue you've got t-bot in the

748
00:29:16,260 --> 00:29:18,360
green you've got Escobar and in the

749
00:29:18,360 --> 00:29:21,059
purple you have uh sharkbot

750
00:29:21,059 --> 00:29:23,100
now if you've gotten this point in your

751
00:29:23,100 --> 00:29:25,260
examination and you've got some apps to

752
00:29:25,260 --> 00:29:27,080
have access to accessibility services

753
00:29:27,080 --> 00:29:29,820
and it's this app is checking all of

754
00:29:29,820 --> 00:29:31,740
these other boxes right it came to the

755
00:29:31,740 --> 00:29:34,020
phone by way of something other than the

756
00:29:34,020 --> 00:29:37,679
play store or it's uh you know it's got

757
00:29:37,679 --> 00:29:40,559
a weird APK name it's using a lot of

758
00:29:40,559 --> 00:29:43,440
battery contextually speaking or not

759
00:29:43,440 --> 00:29:47,399
just in general and it's got a Litany of

760
00:29:47,399 --> 00:29:49,260
dangerous permissions that don't seem to

761
00:29:49,260 --> 00:29:51,480
really line up with what you think the

762
00:29:51,480 --> 00:29:54,059
main purpose of that app may be you

763
00:29:54,059 --> 00:29:56,460
should absolutely be here

764
00:29:56,460 --> 00:30:00,000
at this point you should be okay I as

765
00:30:00,000 --> 00:30:02,100
likely I've got a malicious app on my

766
00:30:02,100 --> 00:30:03,600
hands and you've got a couple of

767
00:30:03,600 --> 00:30:05,220
different ways that you can attack this

768
00:30:05,220 --> 00:30:07,679
from this point you can upload it to an

769
00:30:07,679 --> 00:30:10,320
online sandbox and see what happens you

770
00:30:10,320 --> 00:30:12,299
can hash it and upload and search

771
00:30:12,299 --> 00:30:14,460
against buyers total but in a situation

772
00:30:14,460 --> 00:30:15,539
where you're dealing with the new

773
00:30:15,539 --> 00:30:16,740
variant

774
00:30:16,740 --> 00:30:19,020
these things may not be uh you know

775
00:30:19,020 --> 00:30:21,960
something that you get a hit on so reach

776
00:30:21,960 --> 00:30:24,419
out to friends and other practitioners

777
00:30:24,419 --> 00:30:26,640
they may be able to help you

778
00:30:26,640 --> 00:30:27,899
now

779
00:30:27,899 --> 00:30:30,419
keep in mind you may have an app that

780
00:30:30,419 --> 00:30:32,460
does check all these boxes but ends up

781
00:30:32,460 --> 00:30:34,799
not being malicious and it could be just

782
00:30:34,799 --> 00:30:36,779
that it's poorly coded and that could

783
00:30:36,779 --> 00:30:39,059
happen but if you've gotten to this

784
00:30:39,059 --> 00:30:41,220
point again you could probably assess

785
00:30:41,220 --> 00:30:43,260
with you know a fairly good likelihood

786
00:30:43,260 --> 00:30:45,600
that you do have a malicious app and if

787
00:30:45,600 --> 00:30:46,860
you notice we haven't even talked about

788
00:30:46,860 --> 00:30:49,799
opening the app files of cells but if

789
00:30:49,799 --> 00:30:52,020
you were you would see something like

790
00:30:52,020 --> 00:30:55,820
this on the left that is Molly bot from

791
00:30:55,820 --> 00:30:58,440
Liz's phone and I've got highlighted

792
00:30:58,440 --> 00:31:00,419
this is a this is a config file from the

793
00:31:00,419 --> 00:31:02,580
shared press folder I've got highlighted

794
00:31:02,580 --> 00:31:05,760
there bot I do and then that identifier

795
00:31:05,760 --> 00:31:08,640
okay all right so bot ID that's probably

796
00:31:08,640 --> 00:31:11,760
not good and then on the right I have a

797
00:31:11,760 --> 00:31:13,620
config file from sharkbot now if you

798
00:31:13,620 --> 00:31:17,039
notice in those highlighted areas it's K

799
00:31:17,039 --> 00:31:19,140
logger colon and then what it looks like

800
00:31:19,140 --> 00:31:21,120
to be an APK name and I've got a few

801
00:31:21,120 --> 00:31:25,320
highlighted USAA coinbase

802
00:31:25,320 --> 00:31:28,200
credit Susie and Queensland Bank

803
00:31:28,200 --> 00:31:30,360
these are financial apps that these are

804
00:31:30,360 --> 00:31:32,940
referring to so K logger key logger

805
00:31:32,940 --> 00:31:34,080
Maybe

806
00:31:34,080 --> 00:31:36,059
likely so

807
00:31:36,059 --> 00:31:38,460
um but again

808
00:31:38,460 --> 00:31:41,760
those Android artifacts coupled with

809
00:31:41,760 --> 00:31:44,820
what you're seeing in the specific APK

810
00:31:44,820 --> 00:31:47,279
folders can give you a really good way

811
00:31:47,279 --> 00:31:48,960
to determine yeah I've got I've

812
00:31:48,960 --> 00:31:50,460
definitely got a malicious sap on my

813
00:31:50,460 --> 00:31:52,980
hands uh so for those of you that work

814
00:31:52,980 --> 00:31:55,799
in consultancy that you know you can

815
00:31:55,799 --> 00:31:57,659
assess with high likelihood that that is

816
00:31:57,659 --> 00:32:00,500
the actual case

817
00:32:02,100 --> 00:32:04,919
this is my contact information if I can

818
00:32:04,919 --> 00:32:06,960
ever be of assistance to you please do

819
00:32:06,960 --> 00:32:09,779
not hesitate to reach out my blog site

820
00:32:09,779 --> 00:32:12,240
is up there that's my Twitter handle and

821
00:32:12,240 --> 00:32:14,760
I can be reached on dfir Discord like

822
00:32:14,760 --> 00:32:16,980
many people in here if I don't respond

823
00:32:16,980 --> 00:32:19,380
right away that usually means I am busy

824
00:32:19,380 --> 00:32:23,580
with work life both right so if you

825
00:32:23,580 --> 00:32:24,720
don't hear from me after a while please

826
00:32:24,720 --> 00:32:26,940
just nudge me gently and I'll I'll try

827
00:32:26,940 --> 00:32:28,500
to respond if I don't know the answer I

828
00:32:28,500 --> 00:32:30,080
will direct you to someone like Heather

829
00:32:30,080 --> 00:32:32,580
or some of the other practitioners in

830
00:32:32,580 --> 00:32:35,340
here that may know the answer to it uh

831
00:32:35,340 --> 00:32:38,220
but that's all I have with that do we

832
00:32:38,220 --> 00:32:39,690
have any questions

833
00:32:39,690 --> 00:32:40,410
[Applause]

834
00:32:40,410 --> 00:32:43,459
[Music]

