1
00:00:00,140 --> 00:00:05,580
so when I first got started in digital

2
00:00:03,060 --> 00:00:07,410
forensics in the early 2000s there

3
00:00:05,580 --> 00:00:09,960
weren't as many resources available as

4
00:00:07,410 --> 00:00:12,360
there are now to research new tools and

5
00:00:09,960 --> 00:00:14,099
techniques field was still relatively

6
00:00:12,360 --> 00:00:15,389
new at that time and there just weren't

7
00:00:14,099 --> 00:00:16,880
an awful lot of people who are writing

8
00:00:15,389 --> 00:00:18,750
about that kind of stuff back then

9
00:00:16,880 --> 00:00:23,189
nowadays there's a wealth of information

10
00:00:18,750 --> 00:00:26,400
that forensic aters can use to there you

11
00:00:23,189 --> 00:00:28,710
go to gain access to this wealth of

12
00:00:26,400 --> 00:00:29,880
information but dulles information

13
00:00:28,710 --> 00:00:33,660
because it could be somewhat

14
00:00:29,880 --> 00:00:35,460
overwhelming so much the point that it

15
00:00:33,660 --> 00:00:39,029
can create almost this information

16
00:00:35,460 --> 00:00:40,980
paralysis where if you're trying to if

17
00:00:39,030 --> 00:00:43,559
you're trying to find out about a new

18
00:00:40,980 --> 00:00:46,199
tool or technique you may have

19
00:00:43,559 --> 00:00:48,989
difficulties and you may have to try to

20
00:00:46,200 --> 00:00:51,140
think about the challenges so much that

21
00:00:48,989 --> 00:00:55,160
it'll be like trying to decide which

22
00:00:51,140 --> 00:00:55,160
Pokemon you want to you want to choose

23
00:00:55,370 --> 00:01:01,078
the famous philosopher and martial

24
00:00:59,430 --> 00:01:02,609
artist Bruce Lee said that if you spend

25
00:01:01,079 --> 00:01:04,260
up spend too much time thinking about a

26
00:01:02,609 --> 00:01:06,600
thing you'll never get it done and

27
00:01:04,260 --> 00:01:10,140
essentially what he was saying is that

28
00:01:06,600 --> 00:01:14,360
in order to achieve mastery of any type

29
00:01:10,140 --> 00:01:19,200
of endeavor you have to you have to

30
00:01:14,360 --> 00:01:21,420
focus on the big picture you can't get

31
00:01:19,200 --> 00:01:23,430
locked into thinking about the

32
00:01:21,420 --> 00:01:26,450
individual tool or technique because

33
00:01:23,430 --> 00:01:28,979
then what happens is you fail to see the

34
00:01:26,450 --> 00:01:30,450
big picture and you get focused and

35
00:01:28,979 --> 00:01:33,720
wrapped around the axle about a tool or

36
00:01:30,450 --> 00:01:38,270
technique and you then become unable to

37
00:01:33,720 --> 00:01:38,270
achieve your your ultimate objective a

38
00:01:38,299 --> 00:01:44,700
classic example of this philosophy in

39
00:01:41,549 --> 00:01:46,020
action is the series the a-team now for

40
00:01:44,700 --> 00:01:48,780
those of you who are fans of the 18

41
00:01:46,020 --> 00:01:51,149
you'll remember that a highlight of

42
00:01:48,780 --> 00:01:53,399
every episode was the montage that they

43
00:01:51,149 --> 00:01:58,939
showed during the last 15 minutes where

44
00:01:53,399 --> 00:02:03,360
we would see Hannibal face ba and

45
00:01:58,939 --> 00:02:07,740
Murdock collect all these items and

46
00:02:03,360 --> 00:02:09,628
create elaborate weapons and and combat

47
00:02:07,740 --> 00:02:11,970
vehicles out of seemingly unrelated

48
00:02:09,628 --> 00:02:13,069
items so they can go out and they can

49
00:02:11,970 --> 00:02:15,530
grab a

50
00:02:13,069 --> 00:02:17,719
wagon wheel and several feet of copper

51
00:02:15,530 --> 00:02:20,150
pipe in a box of marbles and create a

52
00:02:17,719 --> 00:02:21,888
field expending gattling gun and they

53
00:02:20,150 --> 00:02:23,870
could do that because they were

54
00:02:21,889 --> 00:02:26,659
resourceful but in addition to being

55
00:02:23,870 --> 00:02:28,579
resourceful they had the ability to see

56
00:02:26,659 --> 00:02:30,530
beyond each of these individual items

57
00:02:28,579 --> 00:02:32,750
and they could see that there was a

58
00:02:30,530 --> 00:02:36,409
greater purpose these items almost

59
00:02:32,750 --> 00:02:38,480
achieving a synergy of sorts in which

60
00:02:36,409 --> 00:02:43,129
they created something greater than the

61
00:02:38,480 --> 00:02:45,619
sum total of individual parts so we all

62
00:02:43,129 --> 00:02:47,810
know that there are a ton there's tons

63
00:02:45,620 --> 00:02:50,000
of great tools and techniques that are

64
00:02:47,810 --> 00:02:51,889
out there some of them that are so

65
00:02:50,000 --> 00:02:55,549
awesome they're literally the cat's

66
00:02:51,889 --> 00:02:57,349
pajamas however we can't get wrapped

67
00:02:55,549 --> 00:02:59,599
around the axle about these individual

68
00:02:57,349 --> 00:03:01,488
tools and we have to think about what

69
00:02:59,599 --> 00:03:04,159
the larger objective is and that larger

70
00:03:01,489 --> 00:03:07,579
objective is to think that again the big

71
00:03:04,159 --> 00:03:09,349
picture and so to illustrate that point

72
00:03:07,579 --> 00:03:10,939
I'd like to talk about some tools and

73
00:03:09,349 --> 00:03:13,069
techniques that have been particularly

74
00:03:10,939 --> 00:03:15,918
useful for me during the course of an

75
00:03:13,069 --> 00:03:18,078
intrusion investigation so one of the

76
00:03:15,919 --> 00:03:20,569
tools that I found pretty useful during

77
00:03:18,079 --> 00:03:22,759
the initial data collection stage was

78
00:03:20,569 --> 00:03:25,189
Corey Harrell's volatile data collection

79
00:03:22,759 --> 00:03:27,018
script and this is an awesome script if

80
00:03:25,189 --> 00:03:28,448
you haven't used it before it automates

81
00:03:27,019 --> 00:03:31,040
the bullet I'll data collection process

82
00:03:28,449 --> 00:03:33,709
leverages the use of various open source

83
00:03:31,040 --> 00:03:35,239
and free or tools and it also provides a

84
00:03:33,709 --> 00:03:36,919
menuing system where the incident

85
00:03:35,239 --> 00:03:39,379
responder can decide whether or not they

86
00:03:36,919 --> 00:03:42,409
want to collect Ram volatile data a

87
00:03:39,379 --> 00:03:44,810
collection of that and it also produces

88
00:03:42,409 --> 00:03:47,060
the triage data which in this particular

89
00:03:44,810 --> 00:03:50,329
case was useful in identifying some very

90
00:03:47,060 --> 00:03:51,979
critical pivot points early on and then

91
00:03:50,329 --> 00:03:54,470
we got to the stage where after we

92
00:03:51,979 --> 00:03:56,209
analyzed the volatile data we identified

93
00:03:54,470 --> 00:03:59,269
several critical systems for forensic

94
00:03:56,209 --> 00:04:01,729
imaging one of them was a legacy server

95
00:03:59,269 --> 00:04:04,969
running Windows 2000 which unfortunately

96
00:04:01,729 --> 00:04:07,310
we couldn't use our go to live imaging

97
00:04:04,969 --> 00:04:09,469
tool ftk imager so instead what we had

98
00:04:07,310 --> 00:04:11,689
to use was George Garner's forensic

99
00:04:09,469 --> 00:04:13,849
acquisition utility and what this

100
00:04:11,689 --> 00:04:15,560
allowed us to do was to use this

101
00:04:13,849 --> 00:04:17,959
customized version of DD along with

102
00:04:15,560 --> 00:04:20,149
netcat to collect the image across the

103
00:04:17,959 --> 00:04:23,570
network at faster speeds than we would

104
00:04:20,149 --> 00:04:25,659
have using the legacy USB port on this

105
00:04:23,570 --> 00:04:27,940
old system

106
00:04:25,660 --> 00:04:31,090
and then we also identified several

107
00:04:27,940 --> 00:04:32,920
systems that were end-user desktops that

108
00:04:31,090 --> 00:04:35,140
we there were more of these systems than

109
00:04:32,920 --> 00:04:38,230
we had right blockers so what we did to

110
00:04:35,140 --> 00:04:40,479
increase the minimize amount of time we

111
00:04:38,230 --> 00:04:42,400
spent imaging we use these live linux

112
00:04:40,480 --> 00:04:44,650
forensics distributions to boot up the

113
00:04:42,400 --> 00:04:46,810
end-user desktops plugged in some hard

114
00:04:44,650 --> 00:04:48,789
drives and collected the images that way

115
00:04:46,810 --> 00:04:52,330
significantly reducing the imaging time

116
00:04:48,790 --> 00:04:54,550
and freeing us up to focus more on more

117
00:04:52,330 --> 00:04:57,370
important tasks such as performing

118
00:04:54,550 --> 00:04:59,470
on-site analysis for those of you that

119
00:04:57,370 --> 00:05:01,570
aren't already familiar with Harlan car

120
00:04:59,470 --> 00:05:03,640
V's concepts of micro mini timelines I

121
00:05:01,570 --> 00:05:05,409
encourage you to read up on them it's a

122
00:05:03,640 --> 00:05:07,719
very great concept basically it says

123
00:05:05,410 --> 00:05:09,370
that you'll always need to create a

124
00:05:07,720 --> 00:05:11,470
super time line that contains everything

125
00:05:09,370 --> 00:05:13,030
including the kitchen sink sometimes you

126
00:05:11,470 --> 00:05:14,590
could get by and you can answer the

127
00:05:13,030 --> 00:05:16,539
questions that you need to have answered

128
00:05:14,590 --> 00:05:18,849
just by creating these mini timelines

129
00:05:16,540 --> 00:05:21,430
consisting of maybe the registry hives

130
00:05:18,850 --> 00:05:23,440
or event logs and that's exactly what

131
00:05:21,430 --> 00:05:25,000
worked for us in this case the data that

132
00:05:23,440 --> 00:05:26,920
the triage data that we collected using

133
00:05:25,000 --> 00:05:29,850
Corey her own scripts we were able to

134
00:05:26,920 --> 00:05:32,110
create these timelines and then we then

135
00:05:29,850 --> 00:05:36,100
analyzed the data that again created

136
00:05:32,110 --> 00:05:38,440
more critical pivot points at a certain

137
00:05:36,100 --> 00:05:39,940
point we identified malware and various

138
00:05:38,440 --> 00:05:41,469
ports that were being used as pivot

139
00:05:39,940 --> 00:05:43,419
points within the environment and we use

140
00:05:41,470 --> 00:05:46,300
this cool trick on the command line

141
00:05:43,419 --> 00:05:48,039
kung-fu website that created a network

142
00:05:46,300 --> 00:05:51,250
Sentinel so we could monitor for certain

143
00:05:48,040 --> 00:05:53,650
port activity and help the the customer

144
00:05:51,250 --> 00:05:56,230
identify whether or not containment was

145
00:05:53,650 --> 00:05:58,419
affected in their environment and last

146
00:05:56,230 --> 00:06:00,100
but not least we also used the Google

147
00:05:58,419 --> 00:06:02,200
Analytics parser a Python script

148
00:06:00,100 --> 00:06:05,440
developed by my friend and colleague at

149
00:06:02,200 --> 00:06:09,430
verizon which allowed us to directly

150
00:06:05,440 --> 00:06:12,580
identify and tie this back to a watering

151
00:06:09,430 --> 00:06:14,620
hole attack that was tied to legitimate

152
00:06:12,580 --> 00:06:16,500
websites that had been compromised that

153
00:06:14,620 --> 00:06:19,740
were being used to serve up malware

154
00:06:16,500 --> 00:06:19,740
there you have it

