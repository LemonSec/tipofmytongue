1
00:00:01,370 --> 00:00:13,018
<font color="#E5E5E5">okay hey can you hear me okay hey I'm</font>

2
00:00:10,080 --> 00:00:17,250
John Soriano<font color="#E5E5E5"> and this is not another</font>

3
00:00:13,019 --> 00:00:23,698
<font color="#CCCCCC">read</font><font color="#E5E5E5"> okay first of all I have to show</font>

4
00:00:17,250 --> 00:00:32,750
you<font color="#CCCCCC"> something this is me last night</font><font color="#E5E5E5"> so</font>

5
00:00:23,699 --> 00:00:36,420
please don't be our rule audience okay

6
00:00:32,750 --> 00:00:38,239
like I<font color="#E5E5E5"> have like a hot set</font><font color="#CCCCCC"> I work as an</font>

7
00:00:36,420 --> 00:00:41,149
<font color="#E5E5E5">IT security analyst in s of the group Oh</font>

8
00:00:38,239 --> 00:00:43,349
<font color="#E5E5E5">mostly in</font><font color="#CCCCCC"> honeypot some forensics</font><font color="#E5E5E5"> and</font>

9
00:00:41,149 --> 00:00:46,050
for more<font color="#CCCCCC"> than</font><font color="#E5E5E5"> two years I have been</font>

10
00:00:43,350 --> 00:00:48,660
following<font color="#E5E5E5"> Linux malware and I have</font>

11
00:00:46,050 --> 00:00:50,930
<font color="#E5E5E5">written some reports so maybe you have</font>

12
00:00:48,660 --> 00:00:55,890
rhythm

13
00:00:50,930 --> 00:00:58,079
<font color="#E5E5E5">why I'm up</font><font color="#CCCCCC"> here I'm here</font><font color="#E5E5E5"> to introduce</font>

14
00:00:55,890 --> 00:01:01,500
you<font color="#CCCCCC"> Yeah right which</font><font color="#E5E5E5"> is a carving</font><font color="#CCCCCC"> tool</font>

15
00:00:58,079 --> 00:01:04,439
based in<font color="#E5E5E5"> Colorado</font><font color="#CCCCCC"> Zangara and right an</font>

16
00:01:01,500 --> 00:01:06,750
Ingo<font color="#E5E5E5"> yes single sorry for Java</font>

17
00:01:04,438 --> 00:01:11,490
developers<font color="#E5E5E5"> but we know it in 1999</font>

18
00:01:06,750 --> 00:01:13,400
<font color="#E5E5E5">anymore first I'm going to show you why</font>

19
00:01:11,490 --> 00:01:16,320
I realized that I need this kind<font color="#E5E5E5"> of tool</font>

20
00:01:13,400 --> 00:01:18,780
<font color="#E5E5E5">after that we're gonna resolve on a</font>

21
00:01:16,320 --> 00:01:22,220
small<font color="#CCCCCC"> for in this case</font><font color="#E5E5E5"> using injera</font><font color="#CCCCCC"> red</font>

22
00:01:18,780 --> 00:01:26,640
<font color="#E5E5E5">and finally I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> show you</font>

23
00:01:22,220 --> 00:01:31,500
different problems I had to deal with so

24
00:01:26,640 --> 00:01:33,689
why I need<font color="#CCCCCC"> this tool for more than</font><font color="#E5E5E5"> nine</font>

25
00:01:31,500 --> 00:01:35,610
<font color="#CCCCCC">months</font><font color="#E5E5E5"> I have been</font><font color="#CCCCCC"> dealing with some</font>

26
00:01:33,689 --> 00:01:38,789
<font color="#E5E5E5">Frances cases which were based in</font>

27
00:01:35,610 --> 00:01:41,250
unreliable evidences<font color="#E5E5E5"> sometimes because</font>

28
00:01:38,790 --> 00:01:43,409
the client the<font color="#CCCCCC"> client didn't do a very</font>

29
00:01:41,250 --> 00:01:46,619
good incident response<font color="#CCCCCC"> all the time</font>

30
00:01:43,409 --> 00:01:50,700
<font color="#E5E5E5">because they don't have solid evidence</font>

31
00:01:46,619 --> 00:01:55,710
and him with only<font color="#CCCCCC"> buck suspicions or</font>

32
00:01:50,700 --> 00:01:57,479
there are forensics<font color="#E5E5E5"> so one option when</font>

33
00:01:55,710 --> 00:02:00,869
you<font color="#E5E5E5"> are stuck</font><font color="#CCCCCC"> in the middle</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> reference</font>

34
00:01:57,479 --> 00:02:04,770
<font color="#CCCCCC">this case is deal directly directly with</font>

35
00:02:00,869 --> 00:02:07,770
raw data and some forensics tools and

36
00:02:04,770 --> 00:02:09,780
when you have<font color="#E5E5E5"> to to deal with raw data</font>

37
00:02:07,770 --> 00:02:13,019
<font color="#E5E5E5">have less flexibility than</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> ultra</font>

38
00:02:09,780 --> 00:02:14,990
having sex so<font color="#E5E5E5"> I wrote a tool we solve</font>

39
00:02:13,020 --> 00:02:20,910
some<font color="#CCCCCC"> of these problems</font>

40
00:02:14,990 --> 00:02:24,750
<font color="#E5E5E5">okay the case this case like all these</font>

41
00:02:20,910 --> 00:02:26,579
news<font color="#E5E5E5"> it's fake it's only a mixture of</font>

42
00:02:24,750 --> 00:02:29,489
<font color="#CCCCCC">different cases</font><font color="#E5E5E5"> I had to handle along</font>

43
00:02:26,580 --> 00:02:33,110
<font color="#CCCCCC">these</font><font color="#E5E5E5"> months and the purposes of this</font>

44
00:02:29,489 --> 00:02:35,660
case is to show you how<font color="#CCCCCC"> I read works</font><font color="#E5E5E5"> and</font>

45
00:02:33,110 --> 00:02:36,810
<font color="#E5E5E5">realize together why I needed this tool</font>

46
00:02:35,660 --> 00:02:41,250
<font color="#E5E5E5">okay</font>

47
00:02:36,810 --> 00:02:45,209
<font color="#E5E5E5">in the case</font><font color="#CCCCCC"> computer did a request</font><font color="#E5E5E5"> to an</font>

48
00:02:41,250 --> 00:02:48,030
apt<font color="#CCCCCC"> 53 related IP or blue team detect</font>

49
00:02:45,209 --> 00:02:51,780
that request<font color="#E5E5E5"> and notify it to our client</font>

50
00:02:48,030 --> 00:02:55,799
<font color="#E5E5E5">after</font><font color="#CCCCCC"> that the client did an incident</font>

51
00:02:51,780 --> 00:03:00,390
response<font color="#E5E5E5"> and demands to us to read some</font>

52
00:02:55,799 --> 00:03:02,459
forensics<font color="#CCCCCC"> okay they told to</font><font color="#E5E5E5"> us that it's</font>

53
00:03:00,390 --> 00:03:05,369
a critical<font color="#E5E5E5"> computer which works as a</font>

54
00:03:02,459 --> 00:03:07,799
<font color="#E5E5E5">gateway of an industrial system and like</font>

55
00:03:05,370 --> 00:03:11,040
all the initial systems it had access to

56
00:03:07,799 --> 00:03:13,730
a critical<font color="#CCCCCC"> information and</font><font color="#E5E5E5"> another</font>

57
00:03:11,040 --> 00:03:16,440
<font color="#E5E5E5">similarity that this computer has it's a</font>

58
00:03:13,730 --> 00:03:20,399
heat it is able<font color="#CCCCCC"> to handle with</font>

59
00:03:16,440 --> 00:03:24,030
industrial protocols so what the client

60
00:03:20,400 --> 00:03:27,269
wants from us they want to know if the

61
00:03:24,030 --> 00:03:30,410
<font color="#E5E5E5">computer</font><font color="#CCCCCC"> is infected and what kind of</font>

62
00:03:27,269 --> 00:03:35,579
information<font color="#E5E5E5"> could have been exfiltrated</font>

63
00:03:30,410 --> 00:03:37,320
<font color="#E5E5E5">so after first analysis we found that</font>

64
00:03:35,579 --> 00:03:40,530
our client didn't do a very good

65
00:03:37,320 --> 00:03:42,989
incident response<font color="#E5E5E5"> and do you remember</font>

66
00:03:40,530 --> 00:03:45,930
when<font color="#E5E5E5"> I have said that the computer was</font>

67
00:03:42,989 --> 00:03:50,100
critical<font color="#E5E5E5"> boom computer is infected with</font>

68
00:03:45,930 --> 00:03:52,200
generic malware<font color="#E5E5E5"> and I get like what this</font>

69
00:03:50,100 --> 00:03:55,890
generic malware can communicate with a

70
00:03:52,200 --> 00:03:59,399
neutral system it was spread<font color="#E5E5E5"> with an USB</font>

71
00:03:55,890 --> 00:04:01,790
<font color="#E5E5E5">stick</font><font color="#CCCCCC"> and this malware is not related</font>

72
00:03:59,400 --> 00:04:04,350
<font color="#CCCCCC">with an</font><font color="#E5E5E5"> IP t-33</font>

73
00:04:01,790 --> 00:04:09,239
also it has a lot of<font color="#E5E5E5"> industrial</font>

74
00:04:04,350 --> 00:04:14,579
libraries and locks have<font color="#CCCCCC"> rotated so</font><font color="#E5E5E5"> we</font>

75
00:04:09,239 --> 00:04:18,500
<font color="#E5E5E5">are stuck</font><font color="#CCCCCC"> in the middle of case so I</font>

76
00:04:14,579 --> 00:04:23,200
realize that<font color="#E5E5E5"> maybe I can build a tool</font>

77
00:04:18,500 --> 00:04:27,760
<font color="#CCCCCC">okay yeah I knew too</font>

78
00:04:23,200 --> 00:04:30,090
the idea this tool is running<font color="#E5E5E5"> rule set</font>

79
00:04:27,760 --> 00:04:32,789
over the entire at the<font color="#E5E5E5"> older</font><font color="#CCCCCC"> L disk</font><font color="#E5E5E5"> and</font>

80
00:04:30,090 --> 00:04:35,739
extract the file which holds the offset

81
00:04:32,790 --> 00:04:41,770
<font color="#CCCCCC">carving it's a simple</font><font color="#E5E5E5"> job for other</font>

82
00:04:35,740 --> 00:04:44,350
<font color="#CCCCCC">readers so we run the era</font><font color="#E5E5E5"> and when we</font>

83
00:04:41,770 --> 00:04:47,440
gotta mats we a step back a maximum size

84
00:04:44,350 --> 00:04:50,680
<font color="#E5E5E5">and extract twice the</font><font color="#CCCCCC"> maximum size</font><font color="#E5E5E5"> after</font>

85
00:04:47,440 --> 00:04:53,580
<font color="#CCCCCC">that I wrote</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> rule set with magic</font>

86
00:04:50,680 --> 00:04:55,420
numbers and we're<font color="#E5E5E5"> gonna run again</font><font color="#CCCCCC"> gerra</font>

87
00:04:53,580 --> 00:04:59,260
<font color="#E5E5E5">when we got a match</font>

88
00:04:55,420 --> 00:05:03,720
we're<font color="#E5E5E5"> gonna have resize that file okay</font>

89
00:04:59,260 --> 00:05:03,719
let's take<font color="#CCCCCC"> a look of how it works</font>

90
00:05:19,240 --> 00:05:23,960
<font color="#E5E5E5">okay</font>

91
00:05:20,449 --> 00:05:28,159
we found the<font color="#E5E5E5"> file and when we see what</font>

92
00:05:23,960 --> 00:05:31,299
<font color="#E5E5E5">kind of file is it's that compiled a</font>

93
00:05:28,159 --> 00:05:36,469
<font color="#E5E5E5">Python compilot file</font>

94
00:05:31,300 --> 00:05:39,379
perfect we get<font color="#E5E5E5"> the file this file it's</font>

95
00:05:36,469 --> 00:05:39,800
related with<font color="#CCCCCC"> traces</font><font color="#E5E5E5"> malware if you don't</font>

96
00:05:39,379 --> 00:05:42,469
know it

97
00:05:39,800 --> 00:05:44,990
this is malware<font color="#CCCCCC"> it's a campaign from</font><font color="#E5E5E5"> a</font>

98
00:05:42,469 --> 00:05:48,139
<font color="#CCCCCC">bt-50 fee so</font><font color="#E5E5E5"> that could</font><font color="#CCCCCC"> be related with</font>

99
00:05:44,990 --> 00:05:50,180
<font color="#E5E5E5">the request we found but it's only a</font>

100
00:05:48,139 --> 00:05:55,370
support library<font color="#E5E5E5"> and we can still known</font>

101
00:05:50,180 --> 00:05:57,770
the scent of the of the<font color="#CCCCCC"> bridge</font><font color="#E5E5E5"> so when</font>

102
00:05:55,370 --> 00:06:01,029
you look for some<font color="#E5E5E5"> information</font><font color="#CCCCCC"> about</font>

103
00:05:57,770 --> 00:06:05,029
these<font color="#E5E5E5"> three C's campaign we can get a</font>

104
00:06:01,029 --> 00:06:09,789
lot<font color="#E5E5E5"> of reports so from that we can</font>

105
00:06:05,029 --> 00:06:13,099
extract<font color="#E5E5E5"> a io C's the idea was parts and</font>

106
00:06:09,789 --> 00:06:15,650
files like sticks or<font color="#E5E5E5"> raw files or</font>

107
00:06:13,099 --> 00:06:18,259
<font color="#E5E5E5">something like that and put</font><font color="#CCCCCC"> it in there</font>

108
00:06:15,650 --> 00:06:21,198
are rules<font color="#E5E5E5"> after</font><font color="#CCCCCC"> that we're gonna do the</font>

109
00:06:18,259 --> 00:06:24,919
<font color="#E5E5E5">same the same thing again</font><font color="#CCCCCC"> so at this</font>

110
00:06:21,199 --> 00:06:27,710
point I thought I had the power to<font color="#E5E5E5"> beat</font>

111
00:06:24,919 --> 00:06:30,068
them<font color="#E5E5E5"> let's take a look of</font><font color="#CCCCCC"> what really</font>

112
00:06:27,710 --> 00:06:30,068
happened

113
00:06:39,670 --> 00:06:42,839
[Music]

114
00:06:53,250 --> 00:06:56,410
[Music]

115
00:06:56,790 --> 00:07:13,090
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I think it's like this okay</font><font color="#E5E5E5"> so if</font>

116
00:07:04,300 --> 00:07:21,850
<font color="#E5E5E5">we look for in</font><font color="#CCCCCC"> that it's again the</font>

117
00:07:13,090 --> 00:07:24,640
<font color="#E5E5E5">Python compiler library okay</font><font color="#CCCCCC"> so where</font>

118
00:07:21,850 --> 00:07:27,610
<font color="#E5E5E5">are</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> we know that it's a pretty small</font>

119
00:07:24,640 --> 00:07:30,010
<font color="#CCCCCC">war</font><font color="#E5E5E5"> we know that campaign</font><font color="#CCCCCC"> it's able</font><font color="#E5E5E5"> to</font>

120
00:07:27,610 --> 00:07:35,440
communicate with neutral systems<font color="#E5E5E5"> but we</font>

121
00:07:30,010 --> 00:07:38,580
<font color="#E5E5E5">only got support library so at this</font>

122
00:07:35,440 --> 00:07:41,320
point<font color="#E5E5E5"> I thought it could be fine and</font>

123
00:07:38,580 --> 00:07:44,520
look for some information<font color="#CCCCCC"> about who</font>

124
00:07:41,320 --> 00:07:44,520
really<font color="#E5E5E5"> are apt to see</font>

125
00:07:45,930 --> 00:07:52,870
at this point<font color="#E5E5E5"> the priority was</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> speed</font>

126
00:07:50,220 --> 00:07:55,240
but like all the forensics tools they do

127
00:07:52,870 --> 00:07:57,340
if you spend more<font color="#CCCCCC"> time</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> the beginning</font>

128
00:07:55,240 --> 00:07:59,920
<font color="#CCCCCC">of the analysis</font><font color="#E5E5E5"> you could get complex</font>

129
00:07:57,340 --> 00:08:00,729
<font color="#E5E5E5">analysis a flexibility and correlation</font>

130
00:07:59,920 --> 00:08:06,520
of information

131
00:08:00,730 --> 00:08:10,110
so I wrote a shell mode this mode<font color="#CCCCCC"> it's</font>

132
00:08:06,520 --> 00:08:13,240
based on<font color="#E5E5E5"> running</font><font color="#CCCCCC"> Guerra over a</font><font color="#E5E5E5"> row disk</font>

133
00:08:10,110 --> 00:08:17,620
the the<font color="#CCCCCC"> rule</font><font color="#E5E5E5"> set of the magic number all</font>

134
00:08:13,240 --> 00:08:21,130
set<font color="#E5E5E5"> so I in its match we're gonna get</font>

135
00:08:17,620 --> 00:08:25,000
we're not<font color="#CCCCCC"> building a structure with file</font>

136
00:08:21,130 --> 00:08:30,159
type an index of a header and a

137
00:08:25,000 --> 00:08:32,710
Heather's offset so at this point we can

138
00:08:30,160 --> 00:08:35,110
get a start<font color="#CCCCCC"> on select file types</font><font color="#E5E5E5"> we</font>

139
00:08:32,710 --> 00:08:38,800
can't run your algorithm we<font color="#E5E5E5"> can get the</font>

140
00:08:35,110 --> 00:08:43,930
hash<font color="#E5E5E5"> and we can run rather a from from</font>

141
00:08:38,799 --> 00:08:48,069
the from the shell mode so<font color="#CCCCCC"> we open</font><font color="#E5E5E5"> the</font>

142
00:08:43,929 --> 00:08:52,209
shell we can start all files<font color="#CCCCCC"> okay</font>

143
00:08:48,070 --> 00:08:56,350
that's a small small<font color="#CCCCCC"> role disk there a</font>

144
00:08:52,210 --> 00:08:59,380
real real disk<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> take some too much</font>

145
00:08:56,350 --> 00:09:02,260
time and after<font color="#CCCCCC"> that after</font><font color="#E5E5E5"> after this I</font>

146
00:08:59,380 --> 00:09:07,420
<font color="#E5E5E5">will talk about these times</font><font color="#CCCCCC"> okay we can</font>

147
00:09:02,260 --> 00:09:09,069
select portable executable<font color="#E5E5E5"> you're gonna</font>

148
00:09:07,420 --> 00:09:13,800
show<font color="#E5E5E5"> okay</font>

149
00:09:09,070 --> 00:09:20,590
we have<font color="#E5E5E5"> a lot of files we</font><font color="#CCCCCC"> can select six</font>

150
00:09:13,800 --> 00:09:26,699
nine seven<font color="#E5E5E5"> okay at this point we have a</font>

151
00:09:20,590 --> 00:09:31,000
<font color="#E5E5E5">genetic size but if we run</font><font color="#CCCCCC"> that we build</font>

152
00:09:26,700 --> 00:09:37,410
the real footer from from the size of

153
00:09:31,000 --> 00:09:37,410
<font color="#E5E5E5">the headers of the portal executable so</font>

154
00:09:43,010 --> 00:09:55,110
<font color="#E5E5E5">okay in 300 gigabytes of</font><font color="#CCCCCC"> row</font><font color="#E5E5E5"> disk will</font>

155
00:09:49,980 --> 00:09:57,210
take<font color="#E5E5E5"> around 30 minutes</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> running a yes</font>

156
00:09:55,110 --> 00:10:02,820
<font color="#E5E5E5">starting a file type a single file type</font>

157
00:09:57,210 --> 00:10:06,150
<font color="#E5E5E5">will take around</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> 15 minutes so I wrote</font>

158
00:10:02,820 --> 00:10:14,150
a safe enough<font color="#E5E5E5"> open information</font><font color="#CCCCCC"> to like a</font>

159
00:10:06,150 --> 00:10:17,150
<font color="#CCCCCC">not like a project so if you</font><font color="#E5E5E5"> open that</font>

160
00:10:14,150 --> 00:10:17,150
<font color="#E5E5E5">in</font>

161
00:10:31,130 --> 00:10:48,189
okay we're gonna put an output<font color="#E5E5E5"> file and</font>

162
00:10:40,820 --> 00:10:48,190
we're gonna save it okay now we got a

163
00:10:48,430 --> 00:11:01,910
lease on file with all data<font color="#CCCCCC"> that we can</font>

164
00:10:55,510 --> 00:11:07,250
<font color="#E5E5E5">open the safe that we started okay</font><font color="#CCCCCC"> so</font>

165
00:11:01,910 --> 00:11:09,199
now let's<font color="#E5E5E5"> go</font><font color="#CCCCCC"> back to a case as we know</font>

166
00:11:07,250 --> 00:11:12,440
by<font color="#E5E5E5"> the</font><font color="#CCCCCC"> three C's</font><font color="#E5E5E5"> malware it's based on</font>

167
00:11:09,200 --> 00:11:15,770
<font color="#E5E5E5">Python compiler libraries but we have a</font>

168
00:11:12,440 --> 00:11:18,410
lot<font color="#CCCCCC"> of legitimate files</font><font color="#E5E5E5"> but after an</font>

169
00:11:15,770 --> 00:11:29,050
investigation we got that these files

170
00:11:18,410 --> 00:11:31,010
have a<font color="#CCCCCC"> company</font><font color="#E5E5E5"> signature so we</font><font color="#CCCCCC"> now start</font>

171
00:11:29,050 --> 00:11:37,250
<font color="#CCCCCC">the</font><font color="#E5E5E5"> Python compile it</font>

172
00:11:31,010 --> 00:11:43,100
we're gonna set a maximum size we're

173
00:11:37,250 --> 00:11:48,170
gonna set the<font color="#E5E5E5"> food</font><font color="#CCCCCC"> okay and now we're</font>

174
00:11:43,100 --> 00:11:51,650
gonna okay<font color="#CCCCCC"> and now we're</font><font color="#E5E5E5"> gonna run the</font>

175
00:11:48,170 --> 00:12:01,310
error the general rule I wrote with the

176
00:11:51,650 --> 00:12:03,980
<font color="#E5E5E5">company signature over them so okay</font><font color="#CCCCCC"> now</font>

177
00:12:01,310 --> 00:12:07,310
we got the<font color="#CCCCCC"> legitimate files</font><font color="#E5E5E5"> so at this</font>

178
00:12:03,980 --> 00:12:16,760
point we're gonna unselect all files

179
00:12:07,310 --> 00:12:20,810
that<font color="#CCCCCC"> have</font><font color="#E5E5E5"> tagged as legit now we get</font>

180
00:12:16,760 --> 00:12:24,290
only<font color="#E5E5E5"> a 350 files we're gonna set the</font>

181
00:12:20,810 --> 00:12:32,390
size with the footer<font color="#E5E5E5"> and let earn after</font>

182
00:12:24,290 --> 00:12:34,819
that done them so now<font color="#E5E5E5"> we got the Python</font>

183
00:12:32,390 --> 00:12:36,830
<font color="#CCCCCC">compiler</font><font color="#E5E5E5"> malware but we can still find</font>

184
00:12:34,820 --> 00:12:42,629
the executable who runs all those

185
00:12:36,830 --> 00:12:46,740
libraries<font color="#CCCCCC"> an</font><font color="#E5E5E5"> idea could</font><font color="#CCCCCC"> be a run</font>

186
00:12:42,629 --> 00:12:50,550
a simple<font color="#E5E5E5"> generic malware rule will get a</font>

187
00:12:46,740 --> 00:12:54,480
lot of false positives<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the</font>

188
00:12:50,550 --> 00:13:06,719
genetic<font color="#E5E5E5"> map where</font><font color="#CCCCCC"> we found in the in</font><font color="#E5E5E5"> in</font>

189
00:12:54,480 --> 00:13:10,279
the<font color="#E5E5E5"> disk</font><font color="#CCCCCC"> and maybe another</font><font color="#E5E5E5"> one we're</font>

190
00:13:06,720 --> 00:13:10,279
gonna start portable executable

191
00:13:28,140 --> 00:13:35,340
okay now we're gonna select those files

192
00:13:35,520 --> 00:13:47,740
okay<font color="#CCCCCC"> this is malware it's a public</font>

193
00:13:45,400 --> 00:13:52,380
campaign and there are lot of github

194
00:13:47,740 --> 00:13:55,630
<font color="#E5E5E5">repos which have these this malware</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I</font>

195
00:13:52,380 --> 00:14:00,790
<font color="#E5E5E5">don't use it</font><font color="#CCCCCC"> and why not do it with</font><font color="#E5E5E5"> some</font>

196
00:13:55,630 --> 00:14:06,720
style<font color="#CCCCCC"> I</font><font color="#E5E5E5"> wrote I wrote I implement in in</font>

197
00:14:00,790 --> 00:14:13,000
generate an SSD implementation<font color="#E5E5E5"> in go</font><font color="#CCCCCC"> so</font>

198
00:14:06,720 --> 00:14:22,680
this point we have all the<font color="#CCCCCC"> generic</font>

199
00:14:13,000 --> 00:14:28,780
malware and now we're<font color="#E5E5E5"> gonna run ssleep</font>

200
00:14:22,680 --> 00:14:31,239
<font color="#CCCCCC">over them okay we get</font><font color="#E5E5E5"> up the portal</font>

201
00:14:28,780 --> 00:14:34,990
executable number three have an escort

202
00:14:31,240 --> 00:14:40,390
with<font color="#E5E5E5"> relock the taxi with 71 we're gonna</font>

203
00:14:34,990 --> 00:14:46,810
select<font color="#CCCCCC"> into portable executable</font><font color="#E5E5E5"> we're</font>

204
00:14:40,390 --> 00:14:49,900
gonna put the real footer<font color="#E5E5E5"> and now we're</font>

205
00:14:46,810 --> 00:15:01,209
<font color="#E5E5E5">gonna dump it okay maybe we can get the</font>

206
00:14:49,900 --> 00:15:03,459
hash so now case closed

207
00:15:01,210 --> 00:15:06,550
we have the<font color="#E5E5E5"> portable executable we can</font>

208
00:15:03,460 --> 00:15:08,950
analyze those<font color="#CCCCCC"> though the file</font><font color="#E5E5E5"> and after</font>

209
00:15:06,550 --> 00:15:11,560
<font color="#E5E5E5">that</font><font color="#CCCCCC"> get what kind of information have</font>

210
00:15:08,950 --> 00:15:16,270
they have<font color="#E5E5E5"> then they have been</font>

211
00:15:11,560 --> 00:15:19,920
infiltrated<font color="#CCCCCC"> so that's all but I wrote</font>

212
00:15:16,270 --> 00:15:25,090
<font color="#E5E5E5">another implementation in yeah</font><font color="#CCCCCC"> all right</font>

213
00:15:19,920 --> 00:15:33,449
<font color="#E5E5E5">let's take a look</font><font color="#CCCCCC"> one it's a versatile</font>

214
00:15:25,090 --> 00:15:33,450
IP API implementation so if we put

215
00:15:34,180 --> 00:15:45,800
depakene and now<font color="#CCCCCC"> okay</font>

216
00:15:42,080 --> 00:15:49,360
now this file<font color="#CCCCCC"> is to</font><font color="#E5E5E5"> bloat in</font><font color="#CCCCCC"> be result</font>

217
00:15:45,800 --> 00:15:53,229
there's another another features like a

218
00:15:49,360 --> 00:15:58,100
<font color="#CCCCCC">unselected structure check</font><font color="#E5E5E5"> the hashes to</font>

219
00:15:53,230 --> 00:16:01,930
<font color="#CCCCCC">do versatile so that's the</font>

220
00:15:58,100 --> 00:16:05,830
implementation of<font color="#CCCCCC"> butyl</font><font color="#E5E5E5"> okay</font>

221
00:16:01,930 --> 00:16:09,620
another option is another another

222
00:16:05,830 --> 00:16:13,370
information we can have with the reports

223
00:16:09,620 --> 00:16:16,390
<font color="#E5E5E5">it's the hashes</font><font color="#CCCCCC"> so what I did</font>

224
00:16:13,370 --> 00:16:20,420
it's with<font color="#E5E5E5"> a selected fill file type</font>

225
00:16:16,390 --> 00:16:22,100
those file types which hold a the

226
00:16:20,420 --> 00:16:24,319
information of the size in the headers

227
00:16:22,100 --> 00:16:27,500
or have a magic<font color="#CCCCCC"> number</font><font color="#E5E5E5"> for the for the</font>

228
00:16:24,320 --> 00:16:30,590
end of the<font color="#E5E5E5"> file we can get their exact</font>

229
00:16:27,500 --> 00:16:33,830
size and after that generate the hash

230
00:16:30,590 --> 00:16:36,520
with<font color="#CCCCCC"> rather that we can compare</font><font color="#E5E5E5"> those</font>

231
00:16:33,830 --> 00:16:36,520
information

232
00:16:52,050 --> 00:17:06,750
okay and they<font color="#E5E5E5"> have much I put the X file</font>

233
00:17:00,759 --> 00:17:06,750
hi and we found that in in the raw disk

234
00:17:07,140 --> 00:17:10,140
<font color="#E5E5E5">okay</font>

235
00:17:12,569 --> 00:17:22,750
also a<font color="#E5E5E5"> we I put in in</font><font color="#CCCCCC"> read the magic</font>

236
00:17:18,039 --> 00:17:26,908
<font color="#E5E5E5">number a which get the the</font><font color="#CCCCCC"> magic number</font>

237
00:17:22,750 --> 00:17:26,909
<font color="#E5E5E5">of the end of the Master Boot Record so</font>

238
00:17:48,890 --> 00:18:01,100
we can open<font color="#E5E5E5"> with robbery or all run your</font>

239
00:17:54,090 --> 00:18:03,899
overhead<font color="#E5E5E5"> okay</font>

240
00:18:01,100 --> 00:18:07,189
currently generate only<font color="#E5E5E5"> supports</font><font color="#CCCCCC"> has 60</font>

241
00:18:03,900 --> 00:18:10,320
<font color="#CCCCCC">file types of files</font><font color="#E5E5E5"> but there is a repo</font>

242
00:18:07,190 --> 00:18:12,180
called<font color="#CCCCCC"> era forensics and owned by</font><font color="#E5E5E5"> a</font>

243
00:18:10,320 --> 00:18:16,110
shoemaker<font color="#E5E5E5"> which have a lot</font><font color="#CCCCCC"> of</font>

244
00:18:12,180 --> 00:18:27,330
interesting magic number so I put in

245
00:18:16,110 --> 00:18:32,179
general<font color="#CCCCCC"> read and if you right</font><font color="#E5E5E5"> now from</font>

246
00:18:27,330 --> 00:18:35,250
<font color="#CCCCCC">the era forensics there are all the</font>

247
00:18:32,180 --> 00:18:46,860
information we can get with from the

248
00:18:35,250 --> 00:18:49,650
rules of of forensics<font color="#CCCCCC"> okay maybe there</font>

249
00:18:46,860 --> 00:18:52,649
<font color="#E5E5E5">are some some cases when we know what we</font>

250
00:18:49,650 --> 00:18:57,120
want<font color="#CCCCCC"> to do but it's</font><font color="#E5E5E5"> going to take too</font>

251
00:18:52,650 --> 00:19:00,180
much<font color="#CCCCCC"> time or maybe we have two computers</font>

252
00:18:57,120 --> 00:19:01,800
which we want<font color="#E5E5E5"> to do this similar</font>

253
00:19:00,180 --> 00:19:07,130
<font color="#E5E5E5">analysis in in them</font>

254
00:19:01,800 --> 00:19:16,169
so<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are read supports a simple</font>

255
00:19:07,130 --> 00:19:24,920
scripting which for example we put a bar

256
00:19:16,170 --> 00:19:35,880
<font color="#E5E5E5">history so now we start all set the PE</font>

257
00:19:24,920 --> 00:19:40,550
show<font color="#E5E5E5"> select five four three a and</font><font color="#CCCCCC"> show</font>

258
00:19:35,880 --> 00:19:40,550
it<font color="#CCCCCC"> okay</font>

259
00:19:41,140 --> 00:19:52,340
if we look<font color="#E5E5E5"> for we can find a file with</font>

260
00:19:48,740 --> 00:19:58,429
the commands<font color="#E5E5E5"> but we if we open</font><font color="#CCCCCC"> that and</font>

261
00:19:52,340 --> 00:20:02,080
we would run and the file it<font color="#E5E5E5"> will run</font>

262
00:19:58,429 --> 00:20:02,080
the<font color="#E5E5E5"> commands we wrote in that</font>

263
00:20:10,770 --> 00:20:17,490
another<font color="#E5E5E5"> feature is the era that is able</font>

264
00:20:14,429 --> 00:20:22,260
<font color="#E5E5E5">to to send data from this area with TCP</font>

265
00:20:17,490 --> 00:20:24,690
so<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> reduces this implementation to</font>

266
00:20:22,260 --> 00:20:34,350
send select the structures so for

267
00:20:24,690 --> 00:20:53,010
example<font color="#E5E5E5"> now we got this we select the</font>

268
00:20:34,350 --> 00:20:58,080
real structure<font color="#E5E5E5"> now okay that could</font><font color="#CCCCCC"> be</font>

269
00:20:53,010 --> 00:21:01,408
<font color="#CCCCCC">for sending files to and sandbox or to</font>

270
00:20:58,080 --> 00:21:03,480
<font color="#E5E5E5">our server</font><font color="#CCCCCC"> or maybe you give the binary</font>

271
00:21:01,409 --> 00:21:11,460
with<font color="#CCCCCC"> regenerate</font><font color="#E5E5E5"> to a client and the</font>

272
00:21:03,480 --> 00:21:15,990
<font color="#E5E5E5">screed which they have to run okay</font>

273
00:21:11,460 --> 00:21:18,840
what the problems<font color="#E5E5E5"> they are</font><font color="#CCCCCC"> read have</font>

274
00:21:15,990 --> 00:21:22,860
failed<font color="#E5E5E5"> have some fails in footer</font>

275
00:21:18,840 --> 00:21:26,309
detection sometimes they they are some

276
00:21:22,860 --> 00:21:29,879
file<font color="#E5E5E5"> a kind of files which holds and</font>

277
00:21:26,309 --> 00:21:33,330
embedded files in them and we already

278
00:21:29,880 --> 00:21:35,399
<font color="#E5E5E5">know when hooning and it's a structure</font>

279
00:21:33,330 --> 00:21:39,059
and we have a problem<font color="#E5E5E5"> with memory</font>

280
00:21:35,399 --> 00:21:43,520
<font color="#CCCCCC">management and of</font><font color="#E5E5E5"> course I'm not a</font>

281
00:21:39,059 --> 00:21:48,779
<font color="#E5E5E5">developer so the code could be improved</font>

282
00:21:43,520 --> 00:21:50,730
<font color="#CCCCCC">okay the feature work the future work</font>

283
00:21:48,779 --> 00:21:53,870
<font color="#CCCCCC">there all its improving memory</font>

284
00:21:50,730 --> 00:21:59,570
management improve the footer detection

285
00:21:53,870 --> 00:22:04,559
more magic numbers improved algorithm of

286
00:21:59,570 --> 00:22:06,809
detecting those structures and<font color="#E5E5E5"> check the</font>

287
00:22:04,559 --> 00:22:12,928
information<font color="#E5E5E5"> we got with with</font><font color="#CCCCCC"> reg era</font>

288
00:22:06,809 --> 00:22:15,299
with<font color="#E5E5E5"> the MFT and of course I know that</font>

289
00:22:12,929 --> 00:22:19,020
yeah read it takes a lot<font color="#CCCCCC"> of features</font>

290
00:22:15,299 --> 00:22:22,679
<font color="#E5E5E5">with from from brother so maybe in</font>

291
00:22:19,020 --> 00:22:25,460
future<font color="#CCCCCC"> Jarrod will turn into a blue or</font><font color="#E5E5E5"> a</font>

292
00:22:22,679 --> 00:22:25,460
<font color="#E5E5E5">fluid</font>

293
00:22:26,730 --> 00:22:37,170
the stool will be available at my<font color="#CCCCCC"> repo</font>

294
00:22:30,320 --> 00:22:39,899
<font color="#CCCCCC">the next the the next week</font><font color="#E5E5E5"> so maybe if</font>

295
00:22:37,170 --> 00:22:45,900
you have<font color="#CCCCCC"> an</font><font color="#E5E5E5"> idea or you would</font><font color="#CCCCCC"> like to</font>

296
00:22:39,900 --> 00:22:49,800
help<font color="#CCCCCC"> I cannot pay</font><font color="#E5E5E5"> you but maybe like we</font>

297
00:22:45,900 --> 00:22:55,890
say in<font color="#E5E5E5"> Spanish I can pay you with carne</font>

298
00:22:49,800 --> 00:23:00,450
<font color="#E5E5E5">so thank you and</font><font color="#CCCCCC"> thanks Ella loophole</font>

299
00:22:55,890 --> 00:23:05,940
for<font color="#CCCCCC"> my</font><font color="#E5E5E5"> intervals if you have any</font>

300
00:23:00,450 --> 00:23:09,900
question<font color="#CCCCCC"> I have one question John</font><font color="#E5E5E5"> nice</font>

301
00:23:05,940 --> 00:23:13,740
talk<font color="#E5E5E5"> nice tool as well and I'm wondering</font>

302
00:23:09,900 --> 00:23:16,620
why instead<font color="#E5E5E5"> of use magic numbers and try</font>

303
00:23:13,740 --> 00:23:19,500
to<font color="#CCCCCC"> prevent yourself this kind of stuff</font>

304
00:23:16,620 --> 00:23:22,530
<font color="#E5E5E5">when not used as a library stuff like</font>

305
00:23:19,500 --> 00:23:24,570
<font color="#CCCCCC">bean walcorp or constructor okay does</font>

306
00:23:22,530 --> 00:23:26,340
you have<font color="#CCCCCC"> a lot of the issue</font><font color="#E5E5E5"> that you</font>

307
00:23:24,570 --> 00:23:29,370
commented<font color="#E5E5E5"> you have some of this work</font>

308
00:23:26,340 --> 00:23:33,300
already<font color="#CCCCCC"> resolve it I guess so yeah then</font>

309
00:23:29,370 --> 00:23:36,899
maybe it's building a new tool but yeah

310
00:23:33,300 --> 00:23:40,860
I<font color="#E5E5E5"> think the</font><font color="#CCCCCC"> the idea of this project</font>

311
00:23:36,900 --> 00:23:43,200
<font color="#CCCCCC">it's only</font><font color="#E5E5E5"> based in injera for the</font>

312
00:23:40,860 --> 00:23:45,419
<font color="#CCCCCC">flexibility that we have so if we have</font>

313
00:23:43,200 --> 00:23:48,540
to depend some from another<font color="#CCCCCC"> Viners I</font>

314
00:23:45,420 --> 00:23:54,390
don't know if we<font color="#E5E5E5"> are still working like</font>

315
00:23:48,540 --> 00:23:57,450
like I so I don't maybe maybe it<font color="#E5E5E5"> will</font>

316
00:23:54,390 --> 00:23:59,730
improve the that all but<font color="#E5E5E5"> I don't know if</font>

317
00:23:57,450 --> 00:24:10,490
I have to<font color="#E5E5E5"> talk about to think about it</font>

318
00:23:59,730 --> 00:24:10,490
<font color="#E5E5E5">okay well we can see you</font>

319
00:24:14,950 --> 00:24:19,750
does the whole<font color="#E5E5E5"> magic number find him</font>

320
00:24:19,090 --> 00:24:21,280
first

321
00:24:19,750 --> 00:24:23,500
<font color="#CCCCCC">it goes</font><font color="#E5E5E5"> around like for example do you</font>

322
00:24:21,280 --> 00:24:26,129
detect<font color="#CCCCCC"> they I don't know auntie vidas</font>

323
00:24:23,500 --> 00:24:28,630
signature files as malicious files

324
00:24:26,130 --> 00:24:31,540
<font color="#E5E5E5">sometimes yeah</font>

325
00:24:28,630 --> 00:24:37,300
no it's only based<font color="#E5E5E5"> in the room said you</font>

326
00:24:31,540 --> 00:24:42,580
wrote<font color="#CCCCCC"> okay okay</font><font color="#E5E5E5"> maybe the idea it's you</font>

327
00:24:37,300 --> 00:24:45,070
have a clue<font color="#E5E5E5"> for a campaign and you use</font>

328
00:24:42,580 --> 00:24:50,189
that that there<font color="#E5E5E5"> are route that there are</font>

329
00:24:45,070 --> 00:24:54,220
all set to find related<font color="#CCCCCC"> a</font><font color="#E5E5E5"> related binary</font>

330
00:24:50,190 --> 00:24:56,830
<font color="#CCCCCC">orally related file</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> Newtonian</font>

331
00:24:54,220 --> 00:24:59,860
antivirus for example when you run the

332
00:24:56,830 --> 00:25:02,139
generic malware<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> our rules</font><font color="#E5E5E5"> that</font>

333
00:24:59,860 --> 00:25:06,070
<font color="#CCCCCC">we'll probably find</font><font color="#E5E5E5"> the actual antivirus</font>

334
00:25:02,140 --> 00:25:06,610
because in the<font color="#CCCCCC"> antivirus yeah does it</font>

335
00:25:06,070 --> 00:25:10,090
<font color="#CCCCCC">happen</font>

336
00:25:06,610 --> 00:25:13,120
or since you're detecting<font color="#E5E5E5"> these</font>

337
00:25:10,090 --> 00:25:16,120
signature it's the signature<font color="#E5E5E5"> I</font><font color="#CCCCCC"> wrote</font>

338
00:25:13,120 --> 00:25:19,000
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> takes a lot a lot</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> a lot of false</font>

339
00:25:16,120 --> 00:25:21,250
positives<font color="#CCCCCC"> I think when we</font><font color="#E5E5E5"> lose don't</font>

340
00:25:19,000 --> 00:25:24,550
know<font color="#E5E5E5"> how</font><font color="#CCCCCC"> this signature because it's it</font>

341
00:25:21,250 --> 00:25:26,530
- it's an a very very small in this use

342
00:25:24,550 --> 00:25:29,980
but we were the flexibility with

343
00:25:26,530 --> 00:25:33,520
<font color="#E5E5E5">generate we can we can unselect those</font>

344
00:25:29,980 --> 00:25:35,530
files or check<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of a lot of a lot</font>

345
00:25:33,520 --> 00:25:36,280
of hashes with a<font color="#E5E5E5"> blue subtle or</font>

346
00:25:35,530 --> 00:25:39,629
something like<font color="#E5E5E5"> that</font>

347
00:25:36,280 --> 00:25:43,750
the<font color="#CCCCCC"> vs to get a lot of information</font>

348
00:25:39,630 --> 00:25:48,280
because an apt campaign<font color="#CCCCCC"> maybe it's</font>

349
00:25:43,750 --> 00:25:51,060
<font color="#CCCCCC">basing in unreliable evidences</font><font color="#E5E5E5"> so we</font>

350
00:25:48,280 --> 00:26:01,450
<font color="#E5E5E5">don't we don't know where where what is</font>

351
00:25:51,060 --> 00:26:02,540
okay thank you<font color="#CCCCCC"> okay for</font><font color="#E5E5E5"> questions</font><font color="#CCCCCC"> Thanks</font>

352
00:26:01,450 --> 00:26:10,619
<font color="#E5E5E5">okay</font>

353
00:26:02,540 --> 00:26:10,619
[Applause]

