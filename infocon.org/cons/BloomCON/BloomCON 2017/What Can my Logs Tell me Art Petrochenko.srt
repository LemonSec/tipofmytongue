1
00:00:00,000 --> 00:00:13,830
<font color="#E5E5E5">okay thank you sir all right you guys</font>

2
00:00:10,800 --> 00:00:16,199
can<font color="#E5E5E5"> hear me okay I all right I'm Arthur</font>

3
00:00:13,830 --> 00:00:19,170
<font color="#E5E5E5">Petra</font><font color="#CCCCCC"> chenko</font><font color="#E5E5E5"> the roads get into the</font>

4
00:00:16,199 --> 00:00:22,080
first slide this is me graduate of

5
00:00:19,170 --> 00:00:25,590
bloomsburg university class of 2015

6
00:00:22,080 --> 00:00:27,150
which is almost two years<font color="#E5E5E5"> ago</font><font color="#CCCCCC"> I was</font>

7
00:00:25,590 --> 00:00:28,980
hired by Dell SecureWorks I'm an

8
00:00:27,150 --> 00:00:32,219
incident response consultant so what

9
00:00:28,980 --> 00:00:35,969
does<font color="#CCCCCC"> that mean I do investigations I do</font>

10
00:00:32,219 --> 00:00:38,850
forensics analysis on disk images memory

11
00:00:35,969 --> 00:00:41,820
images log data i help clients with

12
00:00:38,850 --> 00:00:44,280
actually you know taking the steps and

13
00:00:41,820 --> 00:00:48,180
procedures to handle their<font color="#CCCCCC"> incidents I</font>

14
00:00:44,280 --> 00:00:50,340
also do a lot<font color="#CCCCCC"> of trainings I do</font>

15
00:00:48,180 --> 00:00:53,910
developments for it's a response plan so

16
00:00:50,340 --> 00:00:55,949
a client has you know some hours with us

17
00:00:53,910 --> 00:00:57,449
they want to better prepare<font color="#E5E5E5"> for an</font>

18
00:00:55,949 --> 00:01:00,510
instant so they'll bring in someone like

19
00:00:57,449 --> 00:01:02,519
me<font color="#CCCCCC"> to basically</font><font color="#E5E5E5"> create a mock scenario I</font>

20
00:01:00,510 --> 00:01:04,289
was presented to their IT team and then

21
00:01:02,520 --> 00:01:08,130
I basically great them on how well they

22
00:01:04,290 --> 00:01:09,689
did in their mock incident response so

23
00:01:08,130 --> 00:01:12,689
those are pretty much the things that I

24
00:01:09,689 --> 00:01:14,729
do most I do some other things like<font color="#E5E5E5"> you</font>

25
00:01:12,689 --> 00:01:16,830
know<font color="#E5E5E5"> malware analysis but I'm going to</font>

26
00:01:14,729 --> 00:01:19,080
be awesome that as great as that but I

27
00:01:16,830 --> 00:01:22,170
basically do forensics is like the most

28
00:01:19,080 --> 00:01:25,798
the primary duty I do what a<font color="#E5E5E5"> disk</font>

29
00:01:22,170 --> 00:01:28,770
analysis I like to<font color="#E5E5E5"> travel like nature</font>

30
00:01:25,799 --> 00:01:30,450
like animals currently renovating an RV

31
00:01:28,770 --> 00:01:34,289
my girlfriend's doing most of the work

32
00:01:30,450 --> 00:01:35,909
not me and when I'm not sitting in<font color="#E5E5E5"> front</font>

33
00:01:34,290 --> 00:01:38,640
of<font color="#E5E5E5"> my computer in front of for 10 hours</font>

34
00:01:35,909 --> 00:01:41,250
a day i'm outside trying to<font color="#E5E5E5"> enjoy nature</font>

35
00:01:38,640 --> 00:01:47,280
so what are<font color="#E5E5E5"> we going to talk about today</font>

36
00:01:41,250 --> 00:01:48,630
so this is<font color="#CCCCCC"> a this is a lot of some</font>

37
00:01:47,280 --> 00:01:49,770
people<font color="#E5E5E5"> might think</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> kind of some</font>

38
00:01:48,630 --> 00:01:52,740
<font color="#CCCCCC">beginner information if you're a</font>

39
00:01:49,770 --> 00:01:54,509
professional been working in IT or nir

40
00:01:52,740 --> 00:01:55,500
or forensics<font color="#E5E5E5"> for a long time</font><font color="#CCCCCC"> i'm</font>

41
00:01:54,509 --> 00:01:57,360
probably going to talk about<font color="#E5E5E5"> some things</font>

42
00:01:55,500 --> 00:02:02,969
you already know about who hears a

43
00:01:57,360 --> 00:02:05,460
student dr. Reilly vagina who here is a

44
00:02:02,969 --> 00:02:09,568
student<font color="#E5E5E5"> and they do digital forensics</font>

45
00:02:05,460 --> 00:02:10,899
computer science cool anyone there like

46
00:02:09,568 --> 00:02:14,109
a high school student

47
00:02:10,899 --> 00:02:20,560
hey anyone from a different University

48
00:02:14,110 --> 00:02:22,900
awesome well<font color="#CCCCCC"> University oh cool okay so</font>

49
00:02:20,560 --> 00:02:24,909
we're<font color="#E5E5E5"> going to talk about a lot</font><font color="#CCCCCC"> of bit</font>

50
00:02:22,900 --> 00:02:26,860
stuff<font color="#E5E5E5"> that you probably should know if</font>

51
00:02:24,909 --> 00:02:28,689
you want to go into IT in general if you

52
00:02:26,860 --> 00:02:30,069
want to learn about how<font color="#E5E5E5"> to do</font>

53
00:02:28,689 --> 00:02:31,629
investigations I think you should know

54
00:02:30,069 --> 00:02:35,048
some of this stuff we're also going to

55
00:02:31,629 --> 00:02:36,370
talk<font color="#E5E5E5"> about some analysis technique now</font>

56
00:02:35,049 --> 00:02:38,920
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to talk about mostly log</font>

57
00:02:36,370 --> 00:02:44,200
data and all the different devices that

58
00:02:38,920 --> 00:02:45,670
produce these logs so first off we're

59
00:02:44,200 --> 00:02:48,970
<font color="#E5E5E5">going to talk about forensics in general</font>

60
00:02:45,670 --> 00:02:51,399
there's<font color="#E5E5E5"> three main categories of</font>

61
00:02:48,970 --> 00:02:54,159
evidence there's a<font color="#CCCCCC"> disk there's memory</font>

62
00:02:51,400 --> 00:02:56,170
and then there's log data you'll find

63
00:02:54,159 --> 00:02:58,510
log data in a lot of<font color="#E5E5E5"> places so you'll</font>

64
00:02:56,170 --> 00:03:03,488
find them like in a<font color="#E5E5E5"> network device like</font>

65
00:02:58,510 --> 00:03:05,888
firewalls<font color="#E5E5E5"> ids IPS web proxies then</font>

66
00:03:03,489 --> 00:03:07,810
there's also log data on your<font color="#E5E5E5"> disk right</font>

67
00:03:05,889 --> 00:03:10,030
you know Windows Event log a lot of

68
00:03:07,810 --> 00:03:15,669
applications create laws teamviewer

69
00:03:10,030 --> 00:03:18,220
logmein<font color="#E5E5E5"> FTP servers create logs on a</font>

70
00:03:15,669 --> 00:03:20,919
local disk you can even<font color="#E5E5E5"> find log data on</font>

71
00:03:18,220 --> 00:03:23,049
memory images sometimes<font color="#E5E5E5"> you'll be able</font>

72
00:03:20,919 --> 00:03:24,970
to<font color="#E5E5E5"> recover windows event logs from</font>

73
00:03:23,049 --> 00:03:26,859
memory something a lot of people don't

74
00:03:24,970 --> 00:03:31,629
<font color="#E5E5E5">know about but it's definitely possible</font>

75
00:03:26,859 --> 00:03:33,370
when we talk about forensics it's a

76
00:03:31,629 --> 00:03:35,440
puzzle you need the pieces of the puzzle

77
00:03:33,370 --> 00:03:38,079
you have to understand<font color="#E5E5E5"> that there are</font>

78
00:03:35,440 --> 00:03:40,209
pieces and that there are pieces you

79
00:03:38,079 --> 00:03:41,590
might not actually have and<font color="#E5E5E5"> because of</font>

80
00:03:40,209 --> 00:03:44,049
that you might not be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> answer all</font>

81
00:03:41,590 --> 00:03:45,459
<font color="#E5E5E5">the questions that you're asking so you</font>

82
00:03:44,049 --> 00:03:47,650
have to come<font color="#E5E5E5"> up with an investigation</font>

83
00:03:45,459 --> 00:03:49,750
<font color="#CCCCCC">plan the first thing is what are your</font>

84
00:03:47,650 --> 00:03:51,699
goals you know what questions are you

85
00:03:49,750 --> 00:03:54,430
asking the client so a client comes to

86
00:03:51,699 --> 00:03:56,079
us they have a<font color="#E5E5E5"> problem hey we want you</font>

87
00:03:54,430 --> 00:03:57,760
<font color="#CCCCCC">to investigate</font><font color="#E5E5E5"> this computer tell us</font>

88
00:03:56,079 --> 00:04:01,810
everything that's bad on this computer

89
00:03:57,760 --> 00:04:05,108
secure work says that's a bad goal let's

90
00:04:01,810 --> 00:04:07,000
refine it what<font color="#CCCCCC"> exactly do you think is</font>

91
00:04:05,109 --> 00:04:08,949
happening what do you want us to

92
00:04:07,000 --> 00:04:11,620
investigate oh well we see some IP

93
00:04:08,949 --> 00:04:13,239
address communicating to this<font color="#E5E5E5"> computer</font>

94
00:04:11,620 --> 00:04:15,010
we think that<font color="#E5E5E5"> there might be some</font>

95
00:04:13,239 --> 00:04:17,019
intrusion okay well that's<font color="#E5E5E5"> a better goal</font>

96
00:04:15,010 --> 00:04:20,079
so now we<font color="#CCCCCC"> have a little</font><font color="#E5E5E5"> bit more narrow</font>

97
00:04:17,019 --> 00:04:22,630
field that we're<font color="#E5E5E5"> going to investigate so</font>

98
00:04:20,079 --> 00:04:23,980
you have to come up with a goal yes

99
00:04:22,630 --> 00:04:25,659
agree on the goal

100
00:04:23,980 --> 00:04:27,400
as if you don't<font color="#CCCCCC"> agree on</font><font color="#E5E5E5"> the goal and</font>

101
00:04:25,660 --> 00:04:29,350
<font color="#E5E5E5">then you end up answering question that</font>

102
00:04:27,400 --> 00:04:31,750
they didn't want<font color="#E5E5E5"> you to answer in the</font>

103
00:04:29,350 --> 00:04:33,220
first place<font color="#E5E5E5"> you then you're not really</font>

104
00:04:31,750 --> 00:04:34,840
helping them out there spending a lot of

105
00:04:33,220 --> 00:04:38,020
money<font color="#CCCCCC"> you want to make sure</font><font color="#E5E5E5"> that you're</font>

106
00:04:34,840 --> 00:04:40,390
providing them what they want so come up

107
00:04:38,020 --> 00:04:42,250
<font color="#E5E5E5">with the investigation plan ask what the</font>

108
00:04:40,390 --> 00:04:43,960
goals are and then think about it what

109
00:04:42,250 --> 00:04:46,240
artifacts will help you answer those

110
00:04:43,960 --> 00:04:49,780
questions you know if we're<font color="#CCCCCC"> talking</font>

111
00:04:46,240 --> 00:04:51,580
<font color="#E5E5E5">about a computer that we want to know</font>

112
00:04:49,780 --> 00:04:53,859
whether<font color="#CCCCCC"> or</font><font color="#E5E5E5"> not a professor visited a bad</font>

113
00:04:51,580 --> 00:04:55,180
website on a work computer we're not

114
00:04:53,860 --> 00:04:57,250
necessarily going<font color="#E5E5E5"> to look for malware</font>

115
00:04:55,180 --> 00:04:58,810
you know we're going to<font color="#E5E5E5"> look at you know</font>

116
00:04:57,250 --> 00:05:00,550
the artifacts<font color="#E5E5E5"> that tell us that users</font>

117
00:04:58,810 --> 00:05:04,180
web history think of it like that

118
00:05:00,550 --> 00:05:07,390
investigate the<font color="#E5E5E5"> artifacts that you deem</font>

119
00:05:04,180 --> 00:05:09,490
are worthy for your investigation then

120
00:05:07,390 --> 00:05:11,950
find out what's in those artifacts

121
00:05:09,490 --> 00:05:14,860
record on them and then determine how

122
00:05:11,950 --> 00:05:16,270
likely is that artifact true you know

123
00:05:14,860 --> 00:05:18,790
there<font color="#E5E5E5"> are some artifacts that might</font>

124
00:05:16,270 --> 00:05:21,340
report information but you have to kind

125
00:05:18,790 --> 00:05:23,740
<font color="#E5E5E5">of have you know a</font><font color="#CCCCCC"> judgement call</font><font color="#E5E5E5"> it</font>

126
00:05:21,340 --> 00:05:25,810
says it doesn't explicitly say that this

127
00:05:23,740 --> 00:05:27,520
artifact was created at this time but

128
00:05:25,810 --> 00:05:28,930
there's some surrounding artifacts that

129
00:05:27,520 --> 00:05:30,640
indicate that it was<font color="#CCCCCC"> created around the</font>

130
00:05:28,930 --> 00:05:32,530
time you<font color="#E5E5E5"> have to provide</font><font color="#CCCCCC"> a confidence</font>

131
00:05:30,640 --> 00:05:34,750
level for those artifacts you<font color="#E5E5E5"> can't just</font>

132
00:05:32,530 --> 00:05:36,789
say this site this artifact was created

133
00:05:34,750 --> 00:05:38,680
this file was created at this time<font color="#CCCCCC"> then</font>

134
00:05:36,790 --> 00:05:40,240
the we just kind of assume that that's

135
00:05:38,680 --> 00:05:45,340
not good enough<font color="#CCCCCC"> you have to</font><font color="#E5E5E5"> provide a</font>

136
00:05:40,240 --> 00:05:47,710
confidence level so we're going<font color="#CCCCCC"> to be</font>

137
00:05:45,340 --> 00:05:49,000
talking about log data here today but

138
00:05:47,710 --> 00:05:51,669
<font color="#E5E5E5">we're also going to talk a little bit</font>

139
00:05:49,000 --> 00:05:53,230
about some stuff on<font color="#E5E5E5"> dense usually we</font>

140
00:05:51,670 --> 00:05:55,900
want to get<font color="#E5E5E5"> all all the evidence</font>

141
00:05:53,230 --> 00:06:01,270
possible I<font color="#E5E5E5"> usually only get the disk</font>

142
00:05:55,900 --> 00:06:04,450
image unfortunately<font color="#CCCCCC"> okay so we're</font><font color="#E5E5E5"> going</font>

143
00:06:01,270 --> 00:06:08,620
to start<font color="#E5E5E5"> a little basic here who here</font>

144
00:06:04,450 --> 00:06:09,940
knows what a Windows domain is someone

145
00:06:08,620 --> 00:06:17,460
tell me what a Windows domain is

146
00:06:09,940 --> 00:06:17,460
preferably a student by hand anybody

147
00:06:20,030 --> 00:06:28,789
so<font color="#CCCCCC"> bloomsburg university has a domain</font>

148
00:06:24,980 --> 00:06:31,190
right basically you have users you have

149
00:06:28,790 --> 00:06:35,000
a bunch<font color="#E5E5E5"> of workstation a Windows domain</font>

150
00:06:31,190 --> 00:06:37,610
is basically where people will use

151
00:06:35,000 --> 00:06:39,650
infrastructure that IT has set up so

152
00:06:37,610 --> 00:06:42,740
does anybody<font color="#E5E5E5"> know what a domain</font>

153
00:06:39,650 --> 00:06:51,950
controller is what's the domain

154
00:06:42,740 --> 00:06:54,560
controller right right so it manages

155
00:06:51,950 --> 00:06:56,690
active directory so<font color="#CCCCCC"> windows domain</font><font color="#E5E5E5"> it</font>

156
00:06:54,560 --> 00:06:58,520
runs off of active directory and<font color="#CCCCCC"> then</font>

157
00:06:56,690 --> 00:07:00,860
there's a server called a domain

158
00:06:58,520 --> 00:07:02,359
controller that basically has active

159
00:07:00,860 --> 00:07:07,370
directory installed it's a windows

160
00:07:02,360 --> 00:07:10,970
server role so your IT staff lunes verbs

161
00:07:07,370 --> 00:07:13,640
IT staff manually creates users for all

162
00:07:10,970 --> 00:07:15,590
of the<font color="#E5E5E5"> student so</font><font color="#CCCCCC"> that the users the</font>

163
00:07:13,640 --> 00:07:18,289
students can log on to you know lab

164
00:07:15,590 --> 00:07:20,090
computers they can access<font color="#CCCCCC"> email they can</font>

165
00:07:18,290 --> 00:07:23,030
access<font color="#E5E5E5"> my husky so there's not a lot of</font>

166
00:07:20,090 --> 00:07:26,030
<font color="#CCCCCC">bloomsburg students here kind</font><font color="#E5E5E5"> of funny</font>

167
00:07:23,030 --> 00:07:28,580
so there's a there's an application

168
00:07:26,030 --> 00:07:31,700
called my husky it's basically a

169
00:07:28,580 --> 00:07:33,349
application<font color="#E5E5E5"> that students were all gone</font>

170
00:07:31,700 --> 00:07:36,110
to they<font color="#E5E5E5"> can manage their like financial</font>

171
00:07:33,350 --> 00:07:38,480
aid they can manage their emergency

172
00:07:36,110 --> 00:07:41,480
contacts<font color="#E5E5E5"> their personal information they</font>

173
00:07:38,480 --> 00:07:43,820
can check out their transcript right so

174
00:07:41,480 --> 00:07:47,750
that's that's a web application who here

175
00:07:43,820 --> 00:07:49,640
knows what<font color="#E5E5E5"> a web application is anyone</font>

176
00:07:47,750 --> 00:07:58,150
tell me<font color="#E5E5E5"> what a web application is so I'm</font>

177
00:07:49,640 --> 00:07:58,150
on this side<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> yep</font>

178
00:07:59,889 --> 00:08:08,529
mm-hmm right so you access it by typing

179
00:08:05,740 --> 00:08:09,639
in bloom<font color="#CCCCCC"> you DD you</font><font color="#E5E5E5"> forward slash my</font>

180
00:08:08,529 --> 00:08:14,740
husky and then you get to the

181
00:08:09,639 --> 00:08:32,919
application the application oh thanks

182
00:08:14,740 --> 00:08:37,029
<font color="#E5E5E5">for</font><font color="#CCCCCC"> telling me</font><font color="#E5E5E5"> that this is not great so</font>

183
00:08:32,919 --> 00:08:41,439
a web application is installed on<font color="#E5E5E5"> a</font>

184
00:08:37,029 --> 00:08:43,990
server right and it's<font color="#CCCCCC"> basically running</font>

185
00:08:41,440 --> 00:08:47,380
and serving this this web page that

186
00:08:43,990 --> 00:08:49,149
users can log on to they<font color="#E5E5E5"> can use this</font>

187
00:08:47,380 --> 00:08:52,269
application it's actually installed on a

188
00:08:49,149 --> 00:08:53,860
server and typically the the web

189
00:08:52,269 --> 00:08:55,089
application is connected to a database

190
00:08:53,860 --> 00:08:57,399
and that's where all the student

191
00:08:55,089 --> 00:09:00,010
information is<font color="#E5E5E5"> actually stored so it's</font>

192
00:08:57,399 --> 00:09:02,500
something<font color="#E5E5E5"> to keep in mind but one thing</font>

193
00:09:00,010 --> 00:09:04,360
to remember<font color="#E5E5E5"> is that users</font><font color="#CCCCCC"> have to log on</font>

194
00:09:02,500 --> 00:09:06,339
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the web application how did they log</font>

195
00:09:04,360 --> 00:09:08,709
on to use their bloom you<font color="#CCCCCC"> GED you</font>

196
00:09:06,339 --> 00:09:14,019
credentials which tied to Active

197
00:09:08,709 --> 00:09:21,040
Directory exchange so who knows<font color="#E5E5E5"> what an</font>

198
00:09:14,019 --> 00:09:22,899
<font color="#E5E5E5">exchange server is mm-hmm well so email</font>

199
00:09:21,040 --> 00:09:25,510
is essential for all businesses pretty

200
00:09:22,899 --> 00:09:27,279
much the way you authenticate<font color="#CCCCCC"> to it is</font>

201
00:09:25,510 --> 00:09:31,089
basically using Active Directory again

202
00:09:27,279 --> 00:09:34,510
you you have email you need to<font color="#CCCCCC"> login</font>

203
00:09:31,089 --> 00:09:37,000
because if you don't<font color="#E5E5E5"> login then someone</font>

204
00:09:34,510 --> 00:09:39,640
you know anybody<font color="#CCCCCC"> can</font><font color="#E5E5E5"> use your</font><font color="#CCCCCC"> email so</font>

205
00:09:37,000 --> 00:09:43,360
you<font color="#CCCCCC"> have to have credentials to login so</font>

206
00:09:39,640 --> 00:09:45,579
exchange is pretty much common on all

207
00:09:43,360 --> 00:09:47,709
domains if you're not using exchange

208
00:09:45,579 --> 00:09:50,079
<font color="#E5E5E5">then you might use office 365 which is</font>

209
00:09:47,709 --> 00:09:52,810
kind<font color="#E5E5E5"> of like Microsoft solution to not</font>

210
00:09:50,079 --> 00:09:55,779
having an on-premise server to manage

211
00:09:52,810 --> 00:09:58,750
email you gmail also has a solution<font color="#E5E5E5"> for</font>

212
00:09:55,779 --> 00:10:02,829
businesses to manage email for their

213
00:09:58,750 --> 00:10:04,570
users and then we have some<font color="#E5E5E5"> network</font>

214
00:10:02,829 --> 00:10:06,189
appliances<font color="#E5E5E5"> here so this is our this is</font>

215
00:10:04,570 --> 00:10:09,279
our domain this is what we're going to

216
00:10:06,190 --> 00:10:11,500
<font color="#E5E5E5">be talking about today for the most part</font>

217
00:10:09,279 --> 00:10:13,510
<font color="#E5E5E5">you don't interact with any of these</font>

218
00:10:11,500 --> 00:10:13,699
things other than a workstation you know

219
00:10:13,510 --> 00:10:15,439
you

220
00:10:13,699 --> 00:10:18,738
you type in your credentials at a lab

221
00:10:15,439 --> 00:10:22,099
work station and you do your work you

222
00:10:18,739 --> 00:10:24,019
have your files hosted on your profile

223
00:10:22,100 --> 00:10:25,819
and<font color="#E5E5E5"> then when you log</font><font color="#CCCCCC"> on to another</font>

224
00:10:24,019 --> 00:10:28,850
workstation those those files might

225
00:10:25,819 --> 00:10:32,540
migrate to another computer but they're

226
00:10:28,850 --> 00:10:36,889
only migrating for your username then

227
00:10:32,540 --> 00:10:39,679
this stuff here you don't really<font color="#E5E5E5"> see too</font>

228
00:10:36,889 --> 00:10:42,799
often but it exists and for

229
00:10:39,679 --> 00:10:44,480
investigation you want to you want to be

230
00:10:42,799 --> 00:10:47,929
you want<font color="#E5E5E5"> to have an idea of what</font><font color="#CCCCCC"> these</font>

231
00:10:44,480 --> 00:10:49,699
are<font color="#CCCCCC"> doing so today we're talking about</font>

232
00:10:47,929 --> 00:10:50,988
log data right why are we talking<font color="#CCCCCC"> about</font>

233
00:10:49,699 --> 00:10:53,809
a domain this has nothing to do with<font color="#CCCCCC"> a</font>

234
00:10:50,989 --> 00:10:55,669
talk what's<font color="#E5E5E5"> really important here is</font>

235
00:10:53,809 --> 00:10:58,100
that you are<font color="#E5E5E5"> aware that these devices</font>

236
00:10:55,669 --> 00:11:00,949
exist you are<font color="#CCCCCC"> aware of what these</font>

237
00:10:58,100 --> 00:11:06,199
devices do a firewall what who knows

238
00:11:00,949 --> 00:11:09,139
what a firewall does yeah it logs

239
00:11:06,199 --> 00:11:11,299
traffic going in and out<font color="#CCCCCC"> of the firewall</font>

240
00:11:09,139 --> 00:11:12,589
so if you're<font color="#CCCCCC"> thinking hey I want</font><font color="#E5E5E5"> to know</font>

241
00:11:11,299 --> 00:11:13,999
what's going on can I see the traffic

242
00:11:12,589 --> 00:11:17,089
between this workstation with this

243
00:11:13,999 --> 00:11:23,419
workstation can you see the traffic

244
00:11:17,089 --> 00:11:25,220
between that would log that data yeah

245
00:11:23,419 --> 00:11:26,929
the switch right so if you're<font color="#CCCCCC"> thinking</font>

246
00:11:25,220 --> 00:11:28,639
about I want to<font color="#E5E5E5"> see the</font><font color="#CCCCCC"> traffic between</font>

247
00:11:26,929 --> 00:11:30,350
these two workstation you're not going

248
00:11:28,639 --> 00:11:32,779
to look<font color="#E5E5E5"> at the firewall you're going to</font>

249
00:11:30,350 --> 00:11:35,299
have<font color="#E5E5E5"> to look at net flow logs that come</font>

250
00:11:32,779 --> 00:11:36,739
from the switch so it's important<font color="#CCCCCC"> to</font>

251
00:11:35,299 --> 00:11:40,339
understand that all of this information

252
00:11:36,739 --> 00:11:42,139
it doesn't just exist there<font color="#CCCCCC"> are devices</font>

253
00:11:40,339 --> 00:11:44,389
and you have to know what those<font color="#E5E5E5"> devices</font>

254
00:11:42,139 --> 00:11:46,279
do and you have to see whether or<font color="#E5E5E5"> not</font>

255
00:11:44,389 --> 00:11:49,429
you're actually logging data with those

256
00:11:46,279 --> 00:11:50,869
devices so common misconception client

257
00:11:49,429 --> 00:11:52,129
says hey we'll give you<font color="#CCCCCC"> all of our net</font>

258
00:11:50,869 --> 00:11:53,600
flow logs will give you<font color="#CCCCCC"> all of our</font>

259
00:11:52,129 --> 00:11:56,749
firewall logs tell us what happened<font color="#E5E5E5"> in</font>

260
00:11:53,600 --> 00:11:58,939
our environment and we'll say first of

261
00:11:56,749 --> 00:12:00,439
<font color="#E5E5E5">all do you have that data second of all</font>

262
00:11:58,939 --> 00:12:01,639
is it going to tell<font color="#CCCCCC"> us what we're</font>

263
00:12:00,439 --> 00:12:07,519
actually you know trying<font color="#CCCCCC"> to investigate</font>

264
00:12:01,639 --> 00:12:09,529
keep in<font color="#CCCCCC"> mind what</font><font color="#E5E5E5"> the goals are then we</font>

265
00:12:07,519 --> 00:12:12,230
<font color="#E5E5E5">have a remote computer won't really talk</font>

266
00:12:09,529 --> 00:12:13,939
<font color="#CCCCCC">about any questions on what a Windows</font>

267
00:12:12,230 --> 00:12:20,710
domain is or what any of these are at

268
00:12:13,939 --> 00:12:22,300
this time so first

269
00:12:20,710 --> 00:12:24,430
we're going<font color="#E5E5E5"> to talk about is a network</font>

270
00:12:22,300 --> 00:12:29,170
traffic log you<font color="#E5E5E5"> know like we mentioned</font>

271
00:12:24,430 --> 00:12:33,370
<font color="#E5E5E5">before we have a firewall here and we</font>

272
00:12:29,170 --> 00:12:37,390
<font color="#CCCCCC">have a web proxy here they are key to a</font>

273
00:12:33,370 --> 00:12:39,850
Windows domain<font color="#CCCCCC"> or key to a network so we</font>

274
00:12:37,390 --> 00:12:42,069
have to know<font color="#CCCCCC"> what they actually do so</font>

275
00:12:39,850 --> 00:12:43,990
here are<font color="#CCCCCC"> the type of information that</font>

276
00:12:42,070 --> 00:12:46,510
<font color="#CCCCCC">you guys will actually be able to get</font>

277
00:12:43,990 --> 00:12:49,090
from<font color="#E5E5E5"> a firewall you know event time</font>

278
00:12:46,510 --> 00:12:52,990
source IP address destination IP address

279
00:12:49,090 --> 00:12:54,580
the<font color="#CCCCCC"> the IP address of the actual device</font>

280
00:12:52,990 --> 00:12:57,730
that's doing the logging the firewall IP

281
00:12:54,580 --> 00:12:59,140
which direction it's going<font color="#E5E5E5"> I won't they</font>

282
00:12:57,730 --> 00:13:01,120
say explicitly but you can kind of

283
00:12:59,140 --> 00:13:03,490
assume based on looking at the which one

284
00:13:01,120 --> 00:13:05,200
comes first whether<font color="#CCCCCC"> or</font><font color="#E5E5E5"> not the traffic</font>

285
00:13:03,490 --> 00:13:08,380
was allowed or<font color="#E5E5E5"> what whether or not it</font>

286
00:13:05,200 --> 00:13:09,970
<font color="#CCCCCC">was denied what the interface was was</font>

287
00:13:08,380 --> 00:13:12,280
used in what firewall rule actually

288
00:13:09,970 --> 00:13:14,230
allowed that traffic or denied that

289
00:13:12,280 --> 00:13:17,380
traffic so these things are pretty

290
00:13:14,230 --> 00:13:18,820
important to keep in mind you know when

291
00:13:17,380 --> 00:13:21,460
you're looking at firewall logs you can

292
00:13:18,820 --> 00:13:23,350
say oh this data went from this IP

293
00:13:21,460 --> 00:13:25,540
address to this IP address<font color="#CCCCCC"> okay but</font><font color="#E5E5E5"> was</font>

294
00:13:23,350 --> 00:13:26,920
it allowed or was it denied<font color="#E5E5E5"> I was</font>

295
00:13:25,540 --> 00:13:28,870
allowed<font color="#E5E5E5"> okay are there any other</font>

296
00:13:26,920 --> 00:13:30,729
firewalls in front of it or behind<font color="#E5E5E5"> it</font>

297
00:13:28,870 --> 00:13:32,710
yeah okay<font color="#E5E5E5"> so we have to</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> at those</font>

298
00:13:30,730 --> 00:13:34,900
logs as well you have to<font color="#E5E5E5"> keep in</font><font color="#CCCCCC"> mind</font>

299
00:13:32,710 --> 00:13:38,290
that just getting<font color="#CCCCCC"> the information from</font>

300
00:13:34,900 --> 00:13:43,420
one source you<font color="#E5E5E5"> have to be aware of what</font>

301
00:13:38,290 --> 00:13:47,050
the other devices are around it who here

302
00:13:43,420 --> 00:13:49,620
knows what<font color="#E5E5E5"> a web proxy is tell me what</font>

303
00:13:47,050 --> 00:13:49,620
<font color="#CCCCCC">I've web proxies</font>

304
00:13:55,340 --> 00:14:04,430
yeah so it's kind of an intermediary

305
00:14:00,470 --> 00:14:07,340
intermediary between you and the

306
00:14:04,430 --> 00:14:10,339
<font color="#E5E5E5">Internet so when you make a web request</font>

307
00:14:07,340 --> 00:14:12,410
say if<font color="#E5E5E5"> I'm going to msn com I'm not</font>

308
00:14:10,340 --> 00:14:15,320
actually<font color="#E5E5E5"> going to msn com I'm telling my</font>

309
00:14:12,410 --> 00:14:18,020
web proxy<font color="#CCCCCC"> to go to msn com for me the</font>

310
00:14:15,320 --> 00:14:21,140
web proxy will pull<font color="#CCCCCC"> down the actual page</font>

311
00:14:18,020 --> 00:14:25,069
and then save a local copy of it and

312
00:14:21,140 --> 00:14:26,900
then that proxy is actually supplying me

313
00:14:25,070 --> 00:14:29,210
the information<font color="#E5E5E5"> I'm requesting it's</font>

314
00:14:26,900 --> 00:14:30,530
helpful because if you have<font color="#CCCCCC"> 3,000 people</font>

315
00:14:29,210 --> 00:14:33,140
on your<font color="#E5E5E5"> network asking for the same</font>

316
00:14:30,530 --> 00:14:35,540
webpage the web proxy<font color="#E5E5E5"> only makes the</font>

317
00:14:33,140 --> 00:14:38,120
request once and then instead of<font color="#E5E5E5"> having</font>

318
00:14:35,540 --> 00:14:40,520
3,000 requesting me which can save on

319
00:14:38,120 --> 00:14:43,610
bandwidth but what's also cool about web

320
00:14:40,520 --> 00:14:45,319
proxies that it can filter out websites

321
00:14:43,610 --> 00:14:47,390
that you shouldn't be looking at filter

322
00:14:45,320 --> 00:14:49,010
out say hey you shouldn't be<font color="#CCCCCC"> going to</font>

323
00:14:47,390 --> 00:14:52,400
these pornographic websites or gambling

324
00:14:49,010 --> 00:14:55,610
websites what else is that it<font color="#E5E5E5"> will log</font>

325
00:14:52,400 --> 00:14:58,699
hopefully log the data that you are<font color="#CCCCCC"> on</font>

326
00:14:55,610 --> 00:15:00,440
the web<font color="#CCCCCC"> requests that you're</font><font color="#E5E5E5"> trying to</font>

327
00:14:58,700 --> 00:15:02,690
make so you have a little<font color="#E5E5E5"> bit of</font>

328
00:15:00,440 --> 00:15:06,920
visibility into what your users are

329
00:15:02,690 --> 00:15:09,230
trying to access<font color="#E5E5E5"> so here's here's an</font>

330
00:15:06,920 --> 00:15:13,250
<font color="#E5E5E5">example of why it is important if you</font>

331
00:15:09,230 --> 00:15:16,550
were to use<font color="#E5E5E5"> incognito mode to browse to</font>

332
00:15:13,250 --> 00:15:18,110
say gambling website with<font color="#CCCCCC"> disk forensics</font>

333
00:15:16,550 --> 00:15:21,920
be able to tell you whether or<font color="#E5E5E5"> not that</font>

334
00:15:18,110 --> 00:15:24,170
person access that website probably not

335
00:15:21,920 --> 00:15:28,400
you may like there might be some

336
00:15:24,170 --> 00:15:29,719
artifacts but it's probably<font color="#E5E5E5"> none um so</font>

337
00:15:28,400 --> 00:15:31,160
that's a problem right because<font color="#CCCCCC"> if you're</font>

338
00:15:29,720 --> 00:15:32,510
an investigation you're saying hey we

339
00:15:31,160 --> 00:15:36,020
need<font color="#E5E5E5"> to find out whether or not this</font>

340
00:15:32,510 --> 00:15:37,819
person access this website and then you

341
00:15:36,020 --> 00:15:39,680
know you say okay this person did not

342
00:15:37,820 --> 00:15:41,000
access any gambling websites we looked

343
00:15:39,680 --> 00:15:43,489
at his internet history we didn't find

344
00:15:41,000 --> 00:15:45,950
<font color="#CCCCCC">any</font><font color="#E5E5E5"> all right how confident are you in</font>

345
00:15:43,490 --> 00:15:47,690
that<font color="#CCCCCC"> answer well we're</font><font color="#E5E5E5"> kind of confident</font>

346
00:15:45,950 --> 00:15:50,090
I mean he<font color="#E5E5E5"> might have</font><font color="#CCCCCC"> used incognito mode</font>

347
00:15:47,690 --> 00:15:51,530
so we can't<font color="#CCCCCC"> say for sure okay well that</font>

348
00:15:50,090 --> 00:15:54,050
answer is not good<font color="#CCCCCC"> enough well do</font><font color="#E5E5E5"> you</font>

349
00:15:51,530 --> 00:15:56,480
have<font color="#E5E5E5"> a web proxy if you have a web proxy</font>

350
00:15:54,050 --> 00:15:58,069
and they did that activity on<font color="#CCCCCC"> your</font>

351
00:15:56,480 --> 00:15:59,870
network then you would have<font color="#CCCCCC"> a much</font>

352
00:15:58,070 --> 00:16:01,730
higher confidence of whether<font color="#E5E5E5"> or not they</font>

353
00:15:59,870 --> 00:16:03,950
actually did visit to you know those

354
00:16:01,730 --> 00:16:05,180
gambling websites so that's important

355
00:16:03,950 --> 00:16:07,040
you know when you're talking about

356
00:16:05,180 --> 00:16:09,079
<font color="#CCCCCC">investigations where user activities</font>

357
00:16:07,040 --> 00:16:10,189
involved internet histories involved

358
00:16:09,080 --> 00:16:11,990
you want to make sure<font color="#E5E5E5"> that you're also</font>

359
00:16:10,190 --> 00:16:18,590
thinking about the log data that's

360
00:16:11,990 --> 00:16:20,780
that's available so this<font color="#E5E5E5"> is a some of</font>

361
00:16:18,590 --> 00:16:23,720
the some of the information you get from

362
00:16:20,780 --> 00:16:26,689
a web proxy you get what a you know like

363
00:16:23,720 --> 00:16:27,770
a web request so<font color="#CCCCCC"> you're we get</font>

364
00:16:26,690 --> 00:16:29,810
information whether or not it<font color="#E5E5E5"> was</font>

365
00:16:27,770 --> 00:16:32,360
actually successful so I get it resulted

366
00:16:29,810 --> 00:16:34,069
with a 200 status that means that<font color="#CCCCCC"> is a</font>

367
00:16:32,360 --> 00:16:36,140
you know you were able<font color="#E5E5E5"> to accept</font>

368
00:16:34,070 --> 00:16:38,060
successfully request the data the

369
00:16:36,140 --> 00:16:40,340
resulted with like a 404 that means the

370
00:16:38,060 --> 00:16:43,280
website was not found and that can<font color="#CCCCCC"> be</font>

371
00:16:40,340 --> 00:16:47,690
kind of interesting depending on the

372
00:16:43,280 --> 00:16:50,540
investigation so one other thing is that

373
00:16:47,690 --> 00:16:52,370
<font color="#CCCCCC">this data you know these are from like</font>

374
00:16:50,540 --> 00:16:54,920
what we can we kind of talked about like

375
00:16:52,370 --> 00:16:57,620
refer to as dumb network devices right

376
00:16:54,920 --> 00:17:00,260
so you know we talked about active

377
00:16:57,620 --> 00:17:02,540
directory before<font color="#E5E5E5"> it's if you have a</font>

378
00:17:00,260 --> 00:17:05,690
firewall and it's basically<font color="#CCCCCC"> logging</font>

379
00:17:02,540 --> 00:17:06,980
source IP address a destination IP

380
00:17:05,690 --> 00:17:09,200
address but it doesn't really<font color="#E5E5E5"> know what</font>

381
00:17:06,980 --> 00:17:13,069
<font color="#CCCCCC">the source is like I see that this is</font>

382
00:17:09,200 --> 00:17:14,480
you know 192 168 0 dot 30 but I don't

383
00:17:13,069 --> 00:17:15,829
actually<font color="#E5E5E5"> know if it's a</font><font color="#CCCCCC"> workstation if</font>

384
00:17:14,480 --> 00:17:18,440
it's a server you know you don't<font color="#CCCCCC"> really</font>

385
00:17:15,829 --> 00:17:20,599
have much contact with it that's what I

386
00:17:18,440 --> 00:17:21,560
like a next-generation firewall is so if

387
00:17:20,599 --> 00:17:23,569
you ever heard of the<font color="#E5E5E5"> term</font>

388
00:17:21,560 --> 00:17:25,669
next-generation firewall it really

389
00:17:23,569 --> 00:17:28,220
talked<font color="#E5E5E5"> about like the additional</font>

390
00:17:25,670 --> 00:17:31,250
capabilities that has the additional

391
00:17:28,220 --> 00:17:32,240
integration has with Active Directory do

392
00:17:31,250 --> 00:17:36,560
you think about it like this<font color="#CCCCCC"> you know</font>

393
00:17:32,240 --> 00:17:38,720
would you rather<font color="#CCCCCC"> have you know three or</font>

394
00:17:36,560 --> 00:17:40,879
would you rather<font color="#E5E5E5"> have like seven columns</font>

395
00:17:38,720 --> 00:17:42,560
in an Excel spreadsheet that tell you

396
00:17:40,880 --> 00:17:45,230
information<font color="#E5E5E5"> about what happened or would</font>

397
00:17:42,560 --> 00:17:47,179
you rather have<font color="#E5E5E5"> 30 columns that gives</font>

398
00:17:45,230 --> 00:17:49,400
you much more granular you know

399
00:17:47,180 --> 00:17:52,490
<font color="#CCCCCC">information about all the all the</font>

400
00:17:49,400 --> 00:17:55,370
traffic so the next-generation firewall

401
00:17:52,490 --> 00:17:57,710
they have a lot of great features in

402
00:17:55,370 --> 00:17:59,659
Active Directory Integration so you'll

403
00:17:57,710 --> 00:18:02,690
<font color="#E5E5E5">actually be able to have visibility into</font>

404
00:17:59,660 --> 00:18:05,030
what username requested such and such

405
00:18:02,690 --> 00:18:08,450
data what application was<font color="#CCCCCC"> used so</font>

406
00:18:05,030 --> 00:18:13,550
firewall who here knows what port 8443

407
00:18:08,450 --> 00:18:16,850
is right so its web traffic HTTP<font color="#CCCCCC"> HTTPS</font>

408
00:18:13,550 --> 00:18:20,300
right he just had a regular<font color="#E5E5E5"> firewall</font>

409
00:18:16,850 --> 00:18:22,260
that said you<font color="#E5E5E5"> know there is</font><font color="#CCCCCC"> a court 80</font>

410
00:18:20,300 --> 00:18:24,210
traffic from this IP address to this IP

411
00:18:22,260 --> 00:18:26,010
address you have to assume<font color="#CCCCCC"> that its web</font>

412
00:18:24,210 --> 00:18:28,020
traffic you know you really can't say

413
00:18:26,010 --> 00:18:30,180
for sure because port numbers are

414
00:18:28,020 --> 00:18:32,730
arbitrary i can do anything<font color="#E5E5E5"> i</font><font color="#CCCCCC"> can do</font>

415
00:18:30,180 --> 00:18:34,740
torrent activity over port 80 you know

416
00:18:32,730 --> 00:18:37,590
it's what it's whatever you can do

417
00:18:34,740 --> 00:18:40,830
anything over port 80 but next-gen

418
00:18:37,590 --> 00:18:42,330
firewall they do inspection they do that

419
00:18:40,830 --> 00:18:44,159
they're aware<font color="#CCCCCC"> of the application so</font>

420
00:18:42,330 --> 00:18:45,570
<font color="#CCCCCC">they'll look at the port 80 traffic and</font>

421
00:18:44,160 --> 00:18:48,030
tell you whether<font color="#E5E5E5"> or not it's actually</font><font color="#CCCCCC"> a</font>

422
00:18:45,570 --> 00:18:50,280
web request or if it's<font color="#CCCCCC"> actually you know</font>

423
00:18:48,030 --> 00:18:52,710
just like some hunk of data that looks

424
00:18:50,280 --> 00:18:54,600
weird might be encrypted so that's

425
00:18:52,710 --> 00:18:56,340
pretty important is so you know what

426
00:18:54,600 --> 00:18:57,929
<font color="#E5E5E5">kind of firewall are you using what kind</font>

427
00:18:56,340 --> 00:19:07,290
of data can you expect out of it yep

428
00:18:57,930 --> 00:19:09,780
<font color="#CCCCCC">I'll use</font><font color="#E5E5E5"> for malware like you can you</font>

429
00:19:07,290 --> 00:19:12,780
can post data but it's essentially<font color="#CCCCCC"> a web</font>

430
00:19:09,780 --> 00:19:17,160
request at that time this system it's an

431
00:19:12,780 --> 00:19:18,660
example<font color="#CCCCCC"> or if like you see notepad using</font>

432
00:19:17,160 --> 00:19:31,010
port 80 that's really you know<font color="#E5E5E5"> it's</font>

433
00:19:18,660 --> 00:19:31,010
<font color="#E5E5E5">really weird yep what's that</font>

434
00:19:46,680 --> 00:19:52,080
so question is if you<font color="#CCCCCC"> like incognito</font>

435
00:19:49,110 --> 00:19:58,590
mode like obfuscates the data that's it

436
00:19:52,080 --> 00:20:01,169
we<font color="#E5E5E5"> usually do so like if the incognito</font>

437
00:19:58,590 --> 00:20:03,659
mode is used it basically just<font color="#E5E5E5"> prevents</font>

438
00:20:01,170 --> 00:20:06,300
like website data from being cached

439
00:20:03,660 --> 00:20:09,180
locally or being stored locally so it

440
00:20:06,300 --> 00:20:13,620
doesn't necessarily alter the data or

441
00:20:09,180 --> 00:20:15,780
the web<font color="#CCCCCC"> request but we you know there</font>

442
00:20:13,620 --> 00:20:18,000
<font color="#CCCCCC">are there's malware that makes that make</font>

443
00:20:15,780 --> 00:20:20,490
web<font color="#E5E5E5"> requests to and use the URL encoding</font>

444
00:20:18,000 --> 00:20:22,380
<font color="#CCCCCC">so that you know if you look at</font><font color="#E5E5E5"> the URL</font>

445
00:20:20,490 --> 00:20:25,710
it doesn't necessarily<font color="#CCCCCC"> look malicious</font>

446
00:20:22,380 --> 00:20:28,200
but you can d obvious Kate the URL and

447
00:20:25,710 --> 00:20:30,270
<font color="#E5E5E5">then you know you can do that but in</font>

448
00:20:28,200 --> 00:20:32,280
terms<font color="#CCCCCC"> of buggy incognito mode it doesn't</font>

449
00:20:30,270 --> 00:20:35,060
the office key third doesn't office Kate

450
00:20:32,280 --> 00:20:35,060
any actual traffic

451
00:20:55,299 --> 00:21:07,259
ok

452
00:21:11,580 --> 00:21:19,379
yeah I /

453
00:21:14,940 --> 00:21:32,700
we haven't<font color="#E5E5E5"> seen</font><font color="#CCCCCC"> that yeah but it's not</font>

454
00:21:19,380 --> 00:21:34,200
<font color="#E5E5E5">to say that they</font><font color="#CCCCCC"> don't exist yep yeah I</font>

455
00:21:32,700 --> 00:21:35,730
<font color="#E5E5E5">mean they can do they can do both</font>

456
00:21:34,200 --> 00:21:38,610
depending<font color="#CCCCCC"> on how you configure it</font>

457
00:21:35,730 --> 00:21:40,740
ideally you'd like it to walk any like

458
00:21:38,610 --> 00:21:43,169
abnormal behavior so like if you think

459
00:21:40,740 --> 00:21:46,560
about data being<font color="#CCCCCC"> Exel traded right it's</font>

460
00:21:43,170 --> 00:21:47,850
going over<font color="#E5E5E5"> SSL normally if it's just</font>

461
00:21:46,560 --> 00:21:49,679
like a dumb firewall might not actually

462
00:21:47,850 --> 00:21:51,090
be able<font color="#E5E5E5"> to see that traffic you might</font>

463
00:21:49,680 --> 00:21:52,590
<font color="#E5E5E5">not be</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> say whether or not that</font>

464
00:21:51,090 --> 00:21:56,280
was internal data leaving your

465
00:21:52,590 --> 00:21:58,889
<font color="#CCCCCC">environment bullet SSL decryption you</font>

466
00:21:56,280 --> 00:22:00,510
know you'll<font color="#E5E5E5"> be able to say hey this this</font>

467
00:21:58,890 --> 00:22:02,190
doesn't<font color="#E5E5E5"> look like something we want to</font>

468
00:22:00,510 --> 00:22:04,230
leave our environment and<font color="#E5E5E5"> they can kill</font>

469
00:22:02,190 --> 00:22:08,730
it that's also like kind of<font color="#CCCCCC"> like a</font><font color="#E5E5E5"> DLP</font>

470
00:22:04,230 --> 00:22:14,850
like a data loss prevention solution any

471
00:22:08,730 --> 00:22:16,650
other questions<font color="#E5E5E5"> okay so yeah just be</font>

472
00:22:14,850 --> 00:22:18,209
aware of what your network traffic logs

473
00:22:16,650 --> 00:22:21,360
are I<font color="#E5E5E5"> mean there's there's other devices</font>

474
00:22:18,210 --> 00:22:23,940
like IDs IPS that<font color="#CCCCCC"> will provide some</font>

475
00:22:21,360 --> 00:22:26,219
insight<font color="#CCCCCC"> into whether or not you know</font>

476
00:22:23,940 --> 00:22:27,630
what what<font color="#E5E5E5"> this traffic actually is if</font>

477
00:22:26,220 --> 00:22:31,740
it's like a sequel injection attack

478
00:22:27,630 --> 00:22:33,180
there's also NetFlow data which we're

479
00:22:31,740 --> 00:22:35,580
<font color="#E5E5E5">not really going to talk about today</font><font color="#CCCCCC"> but</font>

480
00:22:33,180 --> 00:22:38,040
you know you're<font color="#E5E5E5"> not going to be able to</font>

481
00:22:35,580 --> 00:22:40,620
really have a lot of devices<font color="#CCCCCC"> that will</font>

482
00:22:38,040 --> 00:22:43,440
tell you network traffic within your

483
00:22:40,620 --> 00:22:47,370
environment it's only what the traffic

484
00:22:43,440 --> 00:22:49,350
is being passed through a firewall and

485
00:22:47,370 --> 00:22:51,239
typically these are at the border so you

486
00:22:49,350 --> 00:22:54,360
really often don't have visibility

487
00:22:51,240 --> 00:23:00,210
between<font color="#CCCCCC"> workstations in</font><font color="#E5E5E5"> your environment</font>

488
00:22:54,360 --> 00:23:00,580
so something to keep in mind some things

489
00:23:00,210 --> 00:23:03,429
that

490
00:23:00,580 --> 00:23:06,760
some tips to when investigating firewall

491
00:23:03,429 --> 00:23:09,370
logs so first of all you have to go into

492
00:23:06,760 --> 00:23:10,629
investigation with<font color="#E5E5E5"> a goal with a plan</font>

493
00:23:09,370 --> 00:23:12,908
right<font color="#E5E5E5"> you're not just going to look at</font>

494
00:23:10,630 --> 00:23:15,399
all this firewall log data and say hey I

495
00:23:12,909 --> 00:23:17,529
see all this badness you know it doesn't

496
00:23:15,399 --> 00:23:19,268
<font color="#E5E5E5">really work</font><font color="#CCCCCC"> that way we need to do is</font>

497
00:23:17,529 --> 00:23:20,890
have some context you know what are you

498
00:23:19,269 --> 00:23:22,750
specifically looking for do you<font color="#E5E5E5"> have an</font>

499
00:23:20,890 --> 00:23:29,230
indicator do you have an IP address that

500
00:23:22,750 --> 00:23:30,789
you know is a part of malware see to you

501
00:23:29,230 --> 00:23:35,260
know do<font color="#E5E5E5"> you have some indication that</font>

502
00:23:30,789 --> 00:23:37,929
there's a no problem you you know<font color="#CCCCCC"> if</font>

503
00:23:35,260 --> 00:23:39,580
there's a an indicator that you already

504
00:23:37,929 --> 00:23:41,049
aware of that you want<font color="#E5E5E5"> to search you</font>

505
00:23:39,580 --> 00:23:43,178
know start their search for<font color="#CCCCCC"> the</font>

506
00:23:41,049 --> 00:23:44,740
environment for<font color="#E5E5E5"> what you already know do</font>

507
00:23:43,179 --> 00:23:48,669
you have a time frame search for<font color="#CCCCCC"> that</font>

508
00:23:44,740 --> 00:23:50,350
time frame to see what pops up there if

509
00:23:48,669 --> 00:23:52,059
you<font color="#E5E5E5"> just kind of go in like say I'm</font>

510
00:23:50,350 --> 00:23:54,070
<font color="#E5E5E5">gonna look at all of your data with</font>

511
00:23:52,059 --> 00:23:58,120
blindly looking for badness it does it

512
00:23:54,070 --> 00:23:59,139
doesn't<font color="#CCCCCC"> really</font><font color="#E5E5E5"> work that way you if</font>

513
00:23:58,120 --> 00:24:01,178
you're talking<font color="#E5E5E5"> about like data</font>

514
00:23:59,139 --> 00:24:03,309
exfiltration you have a time for like or

515
00:24:01,179 --> 00:24:05,740
if you know a IP address that<font color="#E5E5E5"> you're</font>

516
00:24:03,309 --> 00:24:09,549
looking<font color="#CCCCCC"> to</font><font color="#E5E5E5"> see if there's being data</font>

517
00:24:05,740 --> 00:24:12,220
exfiltrated to you know how much data is

518
00:24:09,549 --> 00:24:15,010
being sent to that IP address if your if

519
00:24:12,220 --> 00:24:17,649
your firewall is capable of logging the

520
00:24:15,010 --> 00:24:20,019
amount of traffic then you know you can

521
00:24:17,649 --> 00:24:21,699
check over like a three minute period

522
00:24:20,019 --> 00:24:24,820
how much data is<font color="#E5E5E5"> actually being sent to</font>

523
00:24:21,700 --> 00:24:27,340
that IP address<font color="#E5E5E5"> so those kind of</font>

524
00:24:24,820 --> 00:24:30,789
strategies will help you answer your

525
00:24:27,340 --> 00:24:33,129
goal what port or observed you know what

526
00:24:30,789 --> 00:24:37,179
you know a workstation usually only uses

527
00:24:33,130 --> 00:24:39,460
a few ports you know<font color="#CCCCCC"> 84 for 325 you know</font>

528
00:24:37,179 --> 00:24:42,549
if there's a ftp server on your

529
00:24:39,460 --> 00:24:43,870
<font color="#CCCCCC">workstation or you know there's like a</font>

530
00:24:42,549 --> 00:24:45,490
really<font color="#E5E5E5"> high</font><font color="#CCCCCC"> pore you might want to</font>

531
00:24:43,870 --> 00:24:47,620
<font color="#E5E5E5">figure out what that port is being used</font>

532
00:24:45,490 --> 00:24:49,750
for is it for torque if<font color="#E5E5E5"> it's torrents</font>

533
00:24:47,620 --> 00:24:53,949
you know you you might want to<font color="#E5E5E5"> look into</font>

534
00:24:49,750 --> 00:24:55,630
that<font color="#E5E5E5"> so if you find any malicious</font>

535
00:24:53,950 --> 00:24:56,980
activity on the disk or if you find any

536
00:24:55,630 --> 00:24:58,990
malicious activity in your firewall logs

537
00:24:56,980 --> 00:25:00,730
try to correlate it with other evidence

538
00:24:58,990 --> 00:25:02,559
so if you have a disk image will get

539
00:25:00,730 --> 00:25:07,929
your disc and see what what's going on

540
00:25:02,559 --> 00:25:09,309
at that<font color="#CCCCCC"> time again</font><font color="#E5E5E5"> what's the web proxy</font>

541
00:25:07,929 --> 00:25:11,289
logs you know do you have<font color="#E5E5E5"> an indicator</font>

542
00:25:09,309 --> 00:25:13,809
do you have reason to believe<font color="#CCCCCC"> that you</font>

543
00:25:11,289 --> 00:25:15,429
<font color="#CCCCCC">know a teacher was looking at a bad</font>

544
00:25:13,809 --> 00:25:17,559
website<font color="#CCCCCC"> do you know what that</font><font color="#E5E5E5"> website</font>

545
00:25:15,429 --> 00:25:20,289
might be do you know what the<font color="#E5E5E5"> time frame</font>

546
00:25:17,559 --> 00:25:22,600
of that might be look for look<font color="#E5E5E5"> for</font>

547
00:25:20,289 --> 00:25:24,908
things that don't really necessarily

548
00:25:22,600 --> 00:25:27,279
make sense like when would a one would a

549
00:25:24,909 --> 00:25:28,929
user need to do a put request so put

550
00:25:27,279 --> 00:25:31,600
request is basically when you're sending

551
00:25:28,929 --> 00:25:34,419
a file to another server when would<font color="#E5E5E5"> you</font>

552
00:25:31,600 --> 00:25:36,219
actually need<font color="#CCCCCC"> to upload something it</font>

553
00:25:34,419 --> 00:25:37,570
shouldn't<font color="#E5E5E5"> happen too often so if you see</font>

554
00:25:36,220 --> 00:25:39,970
something like<font color="#CCCCCC"> that you know you can</font>

555
00:25:37,570 --> 00:25:43,360
just prep for put in your web proxy logs

556
00:25:39,970 --> 00:25:46,659
and see what shows up encoded characters

557
00:25:43,360 --> 00:25:48,100
in<font color="#CCCCCC"> your URL that can be kind of</font>

558
00:25:46,659 --> 00:25:49,570
suspicious it could be legitimate though

559
00:25:48,100 --> 00:25:53,110
there's a lot of legitimate URLs that

560
00:25:49,570 --> 00:25:55,928
have encoded characters any web requests

561
00:25:53,110 --> 00:25:58,629
that fail you know how often<font color="#E5E5E5"> does a user</font>

562
00:25:55,929 --> 00:26:00,429
go to a website that doesn't exist I

563
00:25:58,630 --> 00:26:01,750
mean it happens legitimately but if<font color="#CCCCCC"> it's</font>

564
00:26:00,429 --> 00:26:04,240
malware that's trying<font color="#CCCCCC"> to upload</font>

565
00:26:01,750 --> 00:26:06,490
information to the URL that's no longer

566
00:26:04,240 --> 00:26:08,260
available<font color="#E5E5E5"> because now we're sites get</font>

567
00:26:06,490 --> 00:26:10,029
taken down and<font color="#CCCCCC"> malware see two servers</font>

568
00:26:08,260 --> 00:26:12,908
get taken down you know if it's

569
00:26:10,029 --> 00:26:15,220
repeating<font color="#E5E5E5"> Lee trying to access those you</font>

570
00:26:12,909 --> 00:26:16,990
know those sites you'll you'll get a lot

571
00:26:15,220 --> 00:26:18,340
<font color="#E5E5E5">of failures so you know if you see a lot</font>

572
00:26:16,990 --> 00:26:19,630
of failures that's a good indication

573
00:26:18,340 --> 00:26:25,178
that<font color="#E5E5E5"> there's something weird going on</font>

574
00:26:19,630 --> 00:26:27,340
warrants additional investigation if you

575
00:26:25,179 --> 00:26:29,860
see a web request for an executable file

576
00:26:27,340 --> 00:26:31,689
are you trying to download Adobe set up

577
00:26:29,860 --> 00:26:34,090
you know that's legitimate but if you're

578
00:26:31,690 --> 00:26:36,730
trying to download a program from a

579
00:26:34,090 --> 00:26:40,120
domain that posted in<font color="#E5E5E5"> Russia with a exe</font>

580
00:26:36,730 --> 00:26:42,700
expansion that's that's<font color="#CCCCCC"> pretty weird so</font>

581
00:26:40,120 --> 00:26:43,658
those are<font color="#CCCCCC"> some things</font><font color="#E5E5E5"> to kind of keep in</font>

582
00:26:42,700 --> 00:26:48,700
the back of head if you're investigating

583
00:26:43,659 --> 00:26:50,320
web proxy logs so what do you what do<font color="#CCCCCC"> I</font>

584
00:26:48,700 --> 00:26:52,840
<font color="#E5E5E5">use for the you know investigating is</font>

585
00:26:50,320 --> 00:26:56,049
not not much nothing fancy really just

586
00:26:52,840 --> 00:26:58,149
you know a text editor um excels my

587
00:26:56,049 --> 00:27:02,379
friend if I can put it<font color="#E5E5E5"> into like a CSV</font>

588
00:26:58,149 --> 00:27:04,899
format I do yeah<font color="#E5E5E5"> and then if there's</font>

589
00:27:02,379 --> 00:27:06,850
like some data that<font color="#E5E5E5"> is not normalized or</font>

590
00:27:04,899 --> 00:27:08,199
if it's like<font color="#E5E5E5"> raw data it's not in a nice</font>

591
00:27:06,850 --> 00:27:11,019
delimited fashion you<font color="#CCCCCC"> can put it in</font>

592
00:27:08,200 --> 00:27:12,970
maybe into like like a central logging

593
00:27:11,019 --> 00:27:14,379
crew so I saw mill or something and then

594
00:27:12,970 --> 00:27:20,350
<font color="#E5E5E5">I might be able to help you out but</font>

595
00:27:14,379 --> 00:27:23,659
typically i just use<font color="#CCCCCC"> a text editor okay</font>

596
00:27:20,350 --> 00:27:25,219
so network traffic

597
00:27:23,660 --> 00:27:27,980
was really<font color="#E5E5E5"> good for telling you about</font>

598
00:27:25,220 --> 00:27:29,510
what's going<font color="#E5E5E5"> on passing through our</font>

599
00:27:27,980 --> 00:27:31,160
particular device but it doesn't really

600
00:27:29,510 --> 00:27:33,080
<font color="#E5E5E5">tell you a lot about what's happening</font>

601
00:27:31,160 --> 00:27:34,640
inside<font color="#CCCCCC"> your network because if you don't</font>

602
00:27:33,080 --> 00:27:37,820
log that kind of data you don't really

603
00:27:34,640 --> 00:27:39,830
<font color="#E5E5E5">have</font><font color="#CCCCCC"> the visibility and again it really</font>

604
00:27:37,820 --> 00:27:41,179
depends on<font color="#E5E5E5"> what</font><font color="#CCCCCC"> your what your goals are</font>

605
00:27:39,830 --> 00:27:44,330
for the investigation<font color="#E5E5E5"> so if you're</font>

606
00:27:41,180 --> 00:27:47,150
investigating you know malware and it's

607
00:27:44,330 --> 00:27:48,500
trying to contact the c2 server you know

608
00:27:47,150 --> 00:27:50,240
you're<font color="#E5E5E5"> going to want to look at traffic</font>

609
00:27:48,500 --> 00:27:52,100
laws but<font color="#E5E5E5"> if you're if you're concerned</font>

610
00:27:50,240 --> 00:27:54,500
about a human<font color="#E5E5E5"> threat actor inside your</font>

611
00:27:52,100 --> 00:27:56,060
environment time to get to<font color="#E5E5E5"> other systems</font>

612
00:27:54,500 --> 00:27:58,580
then you're not going<font color="#E5E5E5"> to necessarily</font>

613
00:27:56,060 --> 00:28:00,560
look at network traffic logs you're

614
00:27:58,580 --> 00:28:03,679
going to look at you authentication logs

615
00:28:00,560 --> 00:28:05,780
is this<font color="#CCCCCC"> username</font><font color="#E5E5E5"> trying to access other</font>

616
00:28:03,680 --> 00:28:12,050
computers in your<font color="#E5E5E5"> network so</font>

617
00:28:05,780 --> 00:28:15,649
<font color="#E5E5E5">authentication logs are huge so in our</font>

618
00:28:12,050 --> 00:28:17,149
<font color="#E5E5E5">domain you know if we want to rdp from</font>

619
00:28:15,650 --> 00:28:19,850
one computer to another you know we

620
00:28:17,150 --> 00:28:23,210
tempt a connection every connection is

621
00:28:19,850 --> 00:28:26,840
essentially going<font color="#CCCCCC"> to be authenticating</font>

622
00:28:23,210 --> 00:28:28,610
against the domain controller to you

623
00:28:26,840 --> 00:28:30,560
know basically<font color="#E5E5E5"> verify that your user</font>

624
00:28:28,610 --> 00:28:33,439
credentials are correct that<font color="#E5E5E5"> this user</font>

625
00:28:30,560 --> 00:28:38,480
exists in the<font color="#E5E5E5"> password</font><font color="#CCCCCC"> that we have in</font>

626
00:28:33,440 --> 00:28:41,360
our database is correct same goes for a

627
00:28:38,480 --> 00:28:45,320
exchange if you're trying to<font color="#CCCCCC"> log on to</font>

628
00:28:41,360 --> 00:28:48,530
your your email<font color="#CCCCCC"> or if you're setting up</font>

629
00:28:45,320 --> 00:28:50,270
like a connection one on your phone<font color="#E5E5E5"> you</font>

630
00:28:48,530 --> 00:28:51,980
know it's going to authenticate against

631
00:28:50,270 --> 00:28:54,650
the domain controller same thing with

632
00:28:51,980 --> 00:28:57,320
the my husky web app if you're trying<font color="#E5E5E5"> to</font>

633
00:28:54,650 --> 00:29:00,170
access you this web application and it's

634
00:28:57,320 --> 00:29:01,429
using your loom you edu credentials can

635
00:29:00,170 --> 00:29:03,080
authenticate against your domain

636
00:29:01,430 --> 00:29:05,780
controller keep these things in mind

637
00:29:03,080 --> 00:29:07,159
because you<font color="#E5E5E5"> might not remember that</font><font color="#CCCCCC"> you</font>

638
00:29:05,780 --> 00:29:09,200
have visibility into these

639
00:29:07,160 --> 00:29:11,360
authentication requests if you think

640
00:29:09,200 --> 00:29:13,430
<font color="#CCCCCC">someone's account with compromised what</font>

641
00:29:11,360 --> 00:29:16,100
what things can they try to break into

642
00:29:13,430 --> 00:29:18,230
well do I have visibility into things

643
00:29:16,100 --> 00:29:21,260
that<font color="#E5E5E5"> they're trying</font><font color="#CCCCCC"> to break into maybe</font>

644
00:29:18,230 --> 00:29:23,570
you have if you<font color="#CCCCCC"> have a lot of enough</font>

645
00:29:21,260 --> 00:29:26,120
logging for your domain control you

646
00:29:23,570 --> 00:29:30,050
might be able to<font color="#E5E5E5"> have a proof that hey</font>

647
00:29:26,120 --> 00:29:31,969
Joe<font color="#CCCCCC"> Schmoe was trying to log in</font><font color="#E5E5E5"> to is my</font>

648
00:29:30,050 --> 00:29:35,149
husky account at three o'clock in the

649
00:29:31,970 --> 00:29:37,250
morning is that normal maybe do I have a

650
00:29:35,150 --> 00:29:40,010
source IP address that says that

651
00:29:37,250 --> 00:29:43,520
and this guy was<font color="#CCCCCC"> trying to login</font><font color="#E5E5E5"> using</font>

652
00:29:40,010 --> 00:29:45,320
<font color="#E5E5E5">an IP address originated from Russia you</font>

653
00:29:43,520 --> 00:29:50,600
know that that can help indicate to

654
00:29:45,320 --> 00:29:52,220
identify what your logs tell you now

655
00:29:50,600 --> 00:29:53,929
we're also going to talk about an email

656
00:29:52,220 --> 00:29:58,610
authentication logged a little bit later

657
00:29:53,930 --> 00:30:00,500
for like office 365 is anyone here work

658
00:29:58,610 --> 00:30:03,949
in an environment that has office 365

659
00:30:00,500 --> 00:30:06,410
<font color="#CCCCCC">okay you</font><font color="#E5E5E5"> guys administer it or know the</font>

660
00:30:03,950 --> 00:30:08,810
people that administer it you have you

661
00:30:06,410 --> 00:30:14,630
ever tried to request authentication

662
00:30:08,810 --> 00:30:18,080
logs for Microsoft yeah how's that<font color="#E5E5E5"> go</font>

663
00:30:14,630 --> 00:30:20,870
did<font color="#E5E5E5"> you get him now did they say it</font>

664
00:30:18,080 --> 00:30:32,030
<font color="#CCCCCC">wasn't enabled or what was the problem I</font>

665
00:30:20,870 --> 00:30:37,810
can't share it okay<font color="#E5E5E5"> that might be</font><font color="#CCCCCC"> a</font>

666
00:30:32,030 --> 00:30:37,810
different issue then mmhmm yeah

667
00:30:40,809 --> 00:30:44,590
lot<font color="#CCCCCC"> of our clients</font><font color="#E5E5E5"> we have on you know</font>

668
00:30:42,519 --> 00:30:46,360
they use office 365 and<font color="#CCCCCC"> then they have</font>

669
00:30:44,590 --> 00:30:48,249
an incident<font color="#E5E5E5"> they say hey we need to find</font>

670
00:30:46,360 --> 00:30:51,490
out whether or<font color="#E5E5E5"> not someone access this</font>

671
00:30:48,249 --> 00:30:52,720
guy's email account and then they have

672
00:30:51,490 --> 00:30:54,789
no<font color="#E5E5E5"> visibility because they didn't</font>

673
00:30:52,720 --> 00:30:56,230
realize logging wasn't it wasn't enabled

674
00:30:54,789 --> 00:30:58,600
in<font color="#E5E5E5"> the first place so that's something</font>

675
00:30:56,230 --> 00:31:06,399
to keep in mind is you know proactively

676
00:30:58,600 --> 00:31:08,998
think about do I have<font color="#E5E5E5"> visibility they</font>

677
00:31:06,399 --> 00:31:08,998
would do all the time

678
00:31:13,910 --> 00:31:19,190
okay great next we're going to talk

679
00:31:16,820 --> 00:31:20,990
about<font color="#CCCCCC"> Windows event logs I mean you</font>

680
00:31:19,190 --> 00:31:22,970
<font color="#E5E5E5">could teach a whole semester</font><font color="#CCCCCC"> on on</font>

681
00:31:20,990 --> 00:31:26,270
Windows Event log there's so many<font color="#E5E5E5"> of</font>

682
00:31:22,970 --> 00:31:28,610
<font color="#CCCCCC">them there's so many nuances with them</font>

683
00:31:26,270 --> 00:31:31,190
it's a it's a it's a<font color="#E5E5E5"> well-documented</font>

684
00:31:28,610 --> 00:31:33,290
format but it is a like it's a binary

685
00:31:31,190 --> 00:31:35,690
with<font color="#CCCCCC"> Lewis</font><font color="#E5E5E5"> and New Orleans a binary</font>

686
00:31:33,290 --> 00:31:39,710
format so they can present some

687
00:31:35,690 --> 00:31:41,900
challenges they're not super easy<font color="#E5E5E5"> to</font>

688
00:31:39,710 --> 00:31:43,970
parse there's a lot<font color="#CCCCCC"> of parsers for them</font>

689
00:31:41,900 --> 00:31:47,270
a lot<font color="#CCCCCC"> of forensic</font><font color="#E5E5E5"> suites will help get</font>

690
00:31:43,970 --> 00:31:49,070
you the information you want so today

691
00:31:47,270 --> 00:31:51,320
we're going to talk about how to how to

692
00:31:49,070 --> 00:31:53,990
use a free tool to parse them really

693
00:31:51,320 --> 00:31:56,840
well but Windows Event log to provide a

694
00:31:53,990 --> 00:31:58,220
wealth of<font color="#CCCCCC"> information security event</font>

695
00:31:56,840 --> 00:32:00,980
logs are probably the more important

696
00:31:58,220 --> 00:32:03,620
ones they they basically show you know

697
00:32:00,980 --> 00:32:06,590
who logged<font color="#E5E5E5"> into this computer</font><font color="#CCCCCC"> and the</font>

698
00:32:03,620 --> 00:32:09,229
keep in<font color="#E5E5E5"> mind it also shows who try to a</font>

699
00:32:06,590 --> 00:32:11,149
sonic<font color="#E5E5E5"> 82 active directory so not only on</font>

700
00:32:09,230 --> 00:32:12,950
your<font color="#E5E5E5"> local computer users are going</font><font color="#CCCCCC"> to</font>

701
00:32:11,150 --> 00:32:15,260
show who logged on it's going to show

702
00:32:12,950 --> 00:32:19,670
who tried to log on from one computer to

703
00:32:15,260 --> 00:32:23,780
another it's<font color="#E5E5E5"> really important so here's</font>

704
00:32:19,670 --> 00:32:27,770
<font color="#E5E5E5">some really common event ID that are</font>

705
00:32:23,780 --> 00:32:29,510
investigated system events so service is

706
00:32:27,770 --> 00:32:31,310
<font color="#E5E5E5">being created this is really big a lot</font>

707
00:32:29,510 --> 00:32:34,010
of malware will create a service a lot

708
00:32:31,310 --> 00:32:37,129
<font color="#E5E5E5">of tools like that hackers use like</font>

709
00:32:34,010 --> 00:32:40,700
<font color="#CCCCCC">metasploit they will create art excuse</font>

710
00:32:37,130 --> 00:32:45,230
me they will create artifacts that that

711
00:32:40,700 --> 00:32:47,380
<font color="#E5E5E5">a service was created audit logs excuse</font>

712
00:32:45,230 --> 00:32:47,380
me

713
00:32:52,640 --> 00:32:59,600
so an audit log being cleared<font color="#E5E5E5"> is</font>

714
00:32:56,540 --> 00:33:01,399
basically someone deleting evidence in

715
00:32:59,600 --> 00:33:05,480
your<font color="#E5E5E5"> environment that should really not</font>

716
00:33:01,400 --> 00:33:07,010
happen IT administrators don't really do

717
00:33:05,480 --> 00:33:09,440
that they really shouldn't because of

718
00:33:07,010 --> 00:33:10,970
the security event logs all the event

719
00:33:09,440 --> 00:33:12,560
logs kind of roll over on themselves

720
00:33:10,970 --> 00:33:14,900
they don't<font color="#E5E5E5"> need to be cleared to free up</font>

721
00:33:12,560 --> 00:33:19,639
space<font color="#E5E5E5"> so if you see that that's pretty</font>

722
00:33:14,900 --> 00:33:22,250
suspicious application logs you know

723
00:33:19,640 --> 00:33:23,930
here's<font color="#E5E5E5"> some events that show when it an</font>

724
00:33:22,250 --> 00:33:25,730
application was installed but something

725
00:33:23,930 --> 00:33:28,100
else<font color="#CCCCCC"> to keep in mind</font><font color="#E5E5E5"> is that third-party</font>

726
00:33:25,730 --> 00:33:31,880
applications like I know symantec

727
00:33:28,100 --> 00:33:35,600
antivirus creates logs you know there's

728
00:33:31,880 --> 00:33:38,270
a lot<font color="#CCCCCC"> of logs that can be created by</font>

729
00:33:35,600 --> 00:33:39,409
vendors that you're not<font color="#E5E5E5"> aware of so keep</font>

730
00:33:38,270 --> 00:33:41,930
those things in mind if you're talking

731
00:33:39,410 --> 00:33:44,360
<font color="#E5E5E5">about a case where data might have been</font>

732
00:33:41,930 --> 00:33:46,100
exfiltrated yeah you're going<font color="#E5E5E5"> to look</font>

733
00:33:44,360 --> 00:33:47,899
<font color="#E5E5E5">for malware that actual traits data but</font>

734
00:33:46,100 --> 00:33:50,840
if<font color="#CCCCCC"> they're they have an application like</font>

735
00:33:47,900 --> 00:33:53,510
Dropbox or like<font color="#CCCCCC"> sugarsync are their logs</font>

736
00:33:50,840 --> 00:33:56,240
for those applications that say hey this

737
00:33:53,510 --> 00:33:59,600
person setup file sharing to you know

738
00:33:56,240 --> 00:34:01,820
his is a dropbox account those kind of

739
00:33:59,600 --> 00:34:04,550
logs can help you you know determine

740
00:34:01,820 --> 00:34:06,560
whether or<font color="#E5E5E5"> not something was done</font>

741
00:34:04,550 --> 00:34:09,469
unintentionally that was you<font color="#E5E5E5"> know data</font>

742
00:34:06,560 --> 00:34:14,659
exfiltration that's something<font color="#CCCCCC"> to keep in</font>

743
00:34:09,469 --> 00:34:17,120
mind<font color="#E5E5E5"> okay so this is a really good</font>

744
00:34:14,659 --> 00:34:20,570
resource here of ultimate windows

745
00:34:17,120 --> 00:34:22,370
security com it tells you all the

746
00:34:20,570 --> 00:34:23,929
details about all the security event

747
00:34:22,370 --> 00:34:26,690
logs because they can get pretty they

748
00:34:23,929 --> 00:34:31,010
can get pretty complicated there's a<font color="#CCCCCC"> lot</font>

749
00:34:26,690 --> 00:34:33,230
of information<font color="#E5E5E5"> in them so what up total</font>

750
00:34:31,010 --> 00:34:36,440
what do we use for analyzing windows

751
00:34:33,230 --> 00:34:40,100
event<font color="#E5E5E5"> logs who here actually looked at</font>

752
00:34:36,440 --> 00:34:42,080
event logs on a regular basis<font color="#E5E5E5"> okay what</font>

753
00:34:40,100 --> 00:34:46,000
do<font color="#E5E5E5"> you guys look at event logs for will</font>

754
00:34:42,080 --> 00:34:46,000
you think yeah

755
00:34:53,168 --> 00:34:59,308
mm-hmm

756
00:35:10,640 --> 00:35:13,970
that's<font color="#CCCCCC"> awesome and we're going to</font><font color="#E5E5E5"> talk</font>

757
00:35:12,380 --> 00:35:16,849
about central logging a little bit later

758
00:35:13,970 --> 00:35:19,368
today so someone<font color="#CCCCCC"> else them you know how</font>

759
00:35:16,849 --> 00:35:21,019
do you guys have analyzed event logs if

760
00:35:19,369 --> 00:35:25,190
you don't have a central logging server

761
00:35:21,019 --> 00:35:33,979
or a<font color="#CCCCCC"> theme what</font><font color="#E5E5E5"> strategies would you use</font>

762
00:35:25,190 --> 00:35:35,450
to look at event logs hmm<font color="#CCCCCC"> okay so you</font>

763
00:35:33,980 --> 00:35:39,799
just open them up in like event viewer

764
00:35:35,450 --> 00:35:41,180
yeah yeah so we're going<font color="#E5E5E5"> to talk about</font>

765
00:35:39,799 --> 00:35:44,630
<font color="#CCCCCC">some of</font><font color="#E5E5E5"> the tools that are available to</font>

766
00:35:41,180 --> 00:35:53,029
like get into<font color="#E5E5E5"> a format that's easy to</font>

767
00:35:44,630 --> 00:35:54,980
work with so here I think demo time so I

768
00:35:53,029 --> 00:36:04,369
have a<font color="#E5E5E5"> couple of sample Windows Event</font>

769
00:35:54,980 --> 00:36:08,599
log so we have here<font color="#E5E5E5"> so this these</font>

770
00:36:04,369 --> 00:36:12,349
<font color="#CCCCCC">samples come</font><font color="#E5E5E5"> from like a sand course</font>

771
00:36:08,599 --> 00:36:14,240
where there's a service created on a

772
00:36:12,349 --> 00:36:17,750
machine and we were trying<font color="#CCCCCC"> to identify</font>

773
00:36:14,240 --> 00:36:20,899
malicious activity so like I said before

774
00:36:17,750 --> 00:36:23,240
our service is a 70 45 on the system

775
00:36:20,900 --> 00:36:27,380
event logs and the<font color="#E5E5E5"> security event logs</font>

776
00:36:23,240 --> 00:36:28,669
show logging activity so will first look

777
00:36:27,380 --> 00:36:30,230
at the security event log so you can

778
00:36:28,670 --> 00:36:32,690
just double click on it and then open it

779
00:36:30,230 --> 00:36:34,910
up in an event viewer and this is

780
00:36:32,690 --> 00:36:38,990
typically how most people look at the

781
00:36:34,910 --> 00:36:42,049
data but if you have a very law large

782
00:36:38,990 --> 00:36:45,950
event log it becomes pretty cumbersome

783
00:36:42,049 --> 00:36:47,930
you can scroll through it right you<font color="#CCCCCC"> can</font>

784
00:36:45,950 --> 00:36:53,000
see account with successfully logged on

785
00:36:47,930 --> 00:36:57,680
logon type 3 who knows what a logon type

786
00:36:53,000 --> 00:37:00,650
3<font color="#E5E5E5"> log on is softened looks like a</font>

787
00:36:57,680 --> 00:37:04,759
network logon like I guess and be like

788
00:37:00,650 --> 00:37:07,130
accessing a file share so it's<font color="#CCCCCC"> pretty</font>

789
00:37:04,759 --> 00:37:10,730
common and you can see there's a lot of

790
00:37:07,130 --> 00:37:16,759
stuff here you know this account name

791
00:37:10,730 --> 00:37:19,309
vibranium logged transaction state has

792
00:37:16,759 --> 00:37:21,019
changed so you know one of the one<font color="#CCCCCC"> of</font>

793
00:37:19,309 --> 00:37:24,769
<font color="#E5E5E5">the first things you should do is filter</font>

794
00:37:21,019 --> 00:37:24,979
and this is where it comes to the point

795
00:37:24,769 --> 00:37:26,569
where

796
00:37:24,980 --> 00:37:28,520
you have to have some<font color="#CCCCCC"> idea of what</font>

797
00:37:26,570 --> 00:37:31,010
you're looking for you have to be aware

798
00:37:28,520 --> 00:37:32,810
of what event<font color="#CCCCCC"> IDs there are that will</font>

799
00:37:31,010 --> 00:37:35,660
help you<font color="#E5E5E5"> answer the question so we want</font>

800
00:37:32,810 --> 00:37:41,869
<font color="#E5E5E5">to know who all logged on so what's it</font>

801
00:37:35,660 --> 00:37:46,190
let's filter event IDs in 4624 will show

802
00:37:41,869 --> 00:37:48,170
log on<font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> here's all the log on</font>

803
00:37:46,190 --> 00:37:50,450
but as you can see we still have a ton

804
00:37:48,170 --> 00:37:51,890
of events here so someone just<font color="#E5E5E5"> handed me</font>

805
00:37:50,450 --> 00:37:54,319
this event while going to say hey go

806
00:37:51,890 --> 00:37:58,160
find badness it's going to<font color="#E5E5E5"> take</font><font color="#CCCCCC"> a long</font>

807
00:37:54,320 --> 00:38:00,560
time<font color="#E5E5E5"> oh so here's a logon type 10 so</font>

808
00:37:58,160 --> 00:38:03,200
logon type 10 is like using rdp that's a

809
00:38:00,560 --> 00:38:05,270
lot more interesting than logon type 3

810
00:38:03,200 --> 00:38:07,160
and means someone actually use rdp to

811
00:38:05,270 --> 00:38:09,140
get a<font color="#CCCCCC"> gooey access to the to the</font>

812
00:38:07,160 --> 00:38:11,779
workstation<font color="#E5E5E5"> and so this should give us</font>

813
00:38:09,140 --> 00:38:14,118
some<font color="#E5E5E5"> information like the source of the</font>

814
00:38:11,780 --> 00:38:15,980
source of where this person logged in

815
00:38:14,119 --> 00:38:17,960
from so<font color="#CCCCCC"> this is what the</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font>

816
00:38:15,980 --> 00:38:20,510
information you<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to know when it</font>

817
00:38:17,960 --> 00:38:24,020
happened the source of the<font color="#CCCCCC"> logon who</font>

818
00:38:20,510 --> 00:38:26,270
logged on so this is<font color="#E5E5E5"> good but like I</font>

819
00:38:24,020 --> 00:38:29,119
<font color="#E5E5E5">said before it's it's pretty cumbersome</font>

820
00:38:26,270 --> 00:38:30,980
to work with you there's a lot<font color="#CCCCCC"> of fields</font>

821
00:38:29,119 --> 00:38:32,300
here then it's really the only<font color="#E5E5E5"> way you</font>

822
00:38:30,980 --> 00:38:36,980
can pull data out of<font color="#E5E5E5"> it is just by</font>

823
00:38:32,300 --> 00:38:38,540
copying pasting it so there's a there's

824
00:38:36,980 --> 00:38:40,490
some tools available there's one<font color="#CCCCCC"> pull</font>

825
00:38:38,540 --> 00:38:43,420
that a lot<font color="#CCCCCC"> of people like out of that</font>

826
00:38:40,490 --> 00:38:43,419
log explore

827
00:38:50,599 --> 00:38:57,140
we

828
00:38:54,589 --> 00:39:01,160
eventlog with that tool and we have like

829
00:38:57,140 --> 00:39:03,200
a view here where we have column that

830
00:39:01,160 --> 00:39:06,920
pretty much we can sort and filter on

831
00:39:03,200 --> 00:39:09,680
which is really<font color="#E5E5E5"> great so let's see if we</font>

832
00:39:06,920 --> 00:39:15,710
can go find that event again so say

833
00:39:09,680 --> 00:39:20,149
event<font color="#E5E5E5"> idealist 4624 right so we</font><font color="#CCCCCC"> have all</font>

834
00:39:15,710 --> 00:39:28,249
<font color="#CCCCCC">of these logon event we get some context</font>

835
00:39:20,150 --> 00:39:29,779
down here source IP address so what we

836
00:39:28,249 --> 00:39:32,118
could do is we know we can take the

837
00:39:29,779 --> 00:39:36,680
source IP address and search to find all

838
00:39:32,119 --> 00:39:38,029
<font color="#CCCCCC">of the logs that reference this right so</font>

839
00:39:36,680 --> 00:39:40,190
here's all the logs that reference that

840
00:39:38,029 --> 00:39:43,279
what we're interested in is logon type

841
00:39:40,190 --> 00:39:50,210
logon type 10 so what we could do here

842
00:39:43,279 --> 00:39:51,979
is take this information pasted in here

843
00:39:50,210 --> 00:39:56,029
we want to look<font color="#E5E5E5"> for logon type 10 and</font>

844
00:39:51,979 --> 00:39:58,368
then you have a lot more a much<font color="#CCCCCC"> easier</font>

845
00:39:56,029 --> 00:39:59,599
way to access what you're looking for so

846
00:39:58,369 --> 00:40:01,190
if you're<font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in finding</font>

847
00:39:59,599 --> 00:40:03,680
intrusion you know you want<font color="#E5E5E5"> to look at</font>

848
00:40:01,190 --> 00:40:04,999
logon type 10 see what IP address is

849
00:40:03,680 --> 00:40:07,489
logged onto this computer if there's

850
00:40:04,999 --> 00:40:10,430
like a foreign IP address or which is

851
00:40:07,489 --> 00:40:12,349
<font color="#E5E5E5">really not difficult because are usually</font>

852
00:40:10,430 --> 00:40:13,700
don't have outside connections logging

853
00:40:12,349 --> 00:40:18,200
directly into computers but if you do

854
00:40:13,700 --> 00:40:20,930
that's bad so you can see<font color="#CCCCCC"> all these IP</font>

855
00:40:18,200 --> 00:40:24,979
addresses they're all internal logging

856
00:40:20,930 --> 00:40:27,379
on to this<font color="#E5E5E5"> computer so the cool thing</font>

857
00:40:24,979 --> 00:40:29,058
about<font color="#E5E5E5"> windows event logs is that they</font>

858
00:40:27,380 --> 00:40:32,239
have a whole<font color="#E5E5E5"> bunch of</font><font color="#CCCCCC"> information but</font>

859
00:40:29,059 --> 00:40:37,190
it's<font color="#E5E5E5"> really hard to pull the data out of</font>

860
00:40:32,239 --> 00:40:39,529
the event log so this<font color="#E5E5E5"> this area right</font>

861
00:40:37,190 --> 00:40:41,749
here all this description you can

862
00:40:39,529 --> 00:40:43,249
actually<font color="#E5E5E5"> pull out individual fields and</font>

863
00:40:41,749 --> 00:40:45,618
that's what exactly what we want to do

864
00:40:43,249 --> 00:40:47,598
is we want to<font color="#E5E5E5"> be able to say I want to</font>

865
00:40:45,619 --> 00:40:49,400
call them with all of these source IP

866
00:40:47,599 --> 00:40:53,779
addresses I want to call them with all

867
00:40:49,400 --> 00:40:56,059
of these no logon types what we can do

868
00:40:53,779 --> 00:40:59,239
here with this tool at least is we can

869
00:40:56,059 --> 00:41:03,170
configure custom column that basically

870
00:40:59,239 --> 00:41:05,860
allow us to look at the specific fields

871
00:41:03,170 --> 00:41:09,190
here they're actually parameters

872
00:41:05,860 --> 00:41:11,710
so we'll say we'll use a preset here one

873
00:41:09,190 --> 00:41:13,570
of the presets will populate these

874
00:41:11,710 --> 00:41:20,530
different parameters so it show you a

875
00:41:13,570 --> 00:41:23,860
<font color="#CCCCCC">username in</font><font color="#E5E5E5"> the domain say if we wanted</font>

876
00:41:20,530 --> 00:41:27,970
to<font color="#E5E5E5"> use a parameter to see the logon type</font>

877
00:41:23,860 --> 00:41:33,570
<font color="#E5E5E5">I believe it on type</font><font color="#CCCCCC"> 9 parameter numbers</font>

878
00:41:27,970 --> 00:41:33,569
nine for<font color="#E5E5E5"> the specific event log ID</font>

879
00:41:49,940 --> 00:41:56,030
you all these parameters<font color="#E5E5E5"> are assigned</font>

880
00:41:52,190 --> 00:41:57,500
basically a particular place so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

881
00:41:56,030 --> 00:42:01,160
just kind of play around and you know

882
00:41:57,500 --> 00:42:03,020
check out which parameters give you

883
00:42:01,160 --> 00:42:05,690
information<font color="#E5E5E5"> so the parameter</font><font color="#CCCCCC"> 10 was</font>

884
00:42:03,020 --> 00:42:08,509
user32 here so what we're<font color="#CCCCCC"> looking for is</font>

885
00:42:05,690 --> 00:42:20,180
can we get two parameter this parameter

886
00:42:08,510 --> 00:42:22,160
<font color="#CCCCCC">so actually know which one it is right</font>

887
00:42:20,180 --> 00:42:23,990
so now if we if we're investigating an

888
00:42:22,160 --> 00:42:26,060
intrusion on this<font color="#E5E5E5"> system this would be</font>

889
00:42:23,990 --> 00:42:28,430
very helpful<font color="#E5E5E5"> to have in this view</font>

890
00:42:26,060 --> 00:42:32,420
basically<font color="#CCCCCC"> all the IP addresses the</font>

891
00:42:28,430 --> 00:42:35,299
remote the logon type and then this will

892
00:42:32,420 --> 00:42:39,230
make our investigation a lot<font color="#E5E5E5"> easier the</font>

893
00:42:35,300 --> 00:42:41,480
problem with this view is that this data

894
00:42:39,230 --> 00:42:45,950
is still not<font color="#E5E5E5"> really accessible to us</font>

895
00:42:41,480 --> 00:42:48,710
it's we can't caught we can't filter on

896
00:42:45,950 --> 00:42:50,839
it we can't some double clicking here

897
00:42:48,710 --> 00:42:54,290
I'm double clicking here you<font color="#E5E5E5"> can see</font>

898
00:42:50,839 --> 00:42:57,380
<font color="#CCCCCC">that it changes of sorts it differently</font>

899
00:42:54,290 --> 00:43:02,119
but if<font color="#E5E5E5"> I click here it doesn't if you</font>

900
00:42:57,380 --> 00:43:04,369
try<font color="#E5E5E5"> to copy out this data it does it in</font>

901
00:43:02,119 --> 00:43:15,730
a way that it doesn't<font color="#E5E5E5"> actually export</font>

902
00:43:04,369 --> 00:43:15,730
the custom field so just save it here

903
00:43:31,530 --> 00:43:35,820
so we have<font color="#CCCCCC"> all this all these</font>

904
00:43:33,420 --> 00:43:38,610
descriptions here right we they're super

905
00:43:35,820 --> 00:43:42,660
detailed information in one column and

906
00:43:38,610 --> 00:43:44,310
an investigation this is helpful<font color="#E5E5E5"> if you</font>

907
00:43:42,660 --> 00:43:47,190
just want to<font color="#E5E5E5"> like search for something</font>

908
00:43:44,310 --> 00:43:52,710
in particular use the ctrl f to find but

909
00:43:47,190 --> 00:43:54,480
if you want to sort and filter it really

910
00:43:52,710 --> 00:43:56,940
is not helping<font color="#E5E5E5"> us in terms of what we</font>

911
00:43:54,480 --> 00:43:58,950
want to do so what we're going to talk

912
00:43:56,940 --> 00:44:02,760
about now is a tool called log parser

913
00:43:58,950 --> 00:44:05,640
it's actually made<font color="#CCCCCC"> by microsoft it works</font>

914
00:44:02,760 --> 00:44:09,330
on a wide variety of log formats like I

915
00:44:05,640 --> 00:44:11,910
is logs and Windows Event log so this is

916
00:44:09,330 --> 00:44:14,130
<font color="#CCCCCC">what</font><font color="#E5E5E5"> we're going to use it's a method</font>

917
00:44:11,910 --> 00:44:16,259
<font color="#E5E5E5">that I work with when I'm looking at a</font>

918
00:44:14,130 --> 00:44:19,830
lot of event logs from different systems

919
00:44:16,260 --> 00:44:21,690
so it's a program that's a command line

920
00:44:19,830 --> 00:44:23,910
program but there's also a GUI front-end

921
00:44:21,690 --> 00:44:26,210
called log parser studio it will fire

922
00:44:23,910 --> 00:44:26,210
that up

923
00:44:36,140 --> 00:44:42,589
access<font color="#E5E5E5"> to query a file so we'll look at</font>

924
00:44:40,250 --> 00:44:45,190
<font color="#E5E5E5">this security event log that we're</font>

925
00:44:42,590 --> 00:44:45,190
interested in

926
00:44:59,279 --> 00:45:03,179
see if I get this so one of the things

927
00:45:01,469 --> 00:45:04,799
we<font color="#CCCCCC"> can do real quick just make sure it</font>

928
00:45:03,179 --> 00:45:07,349
works is we can do is select it's

929
00:45:04,799 --> 00:45:13,459
basically running sequel queries we want

930
00:45:07,349 --> 00:45:13,459
to<font color="#E5E5E5"> select everything from this log file</font>

931
00:45:22,520 --> 00:45:27,009
<font color="#CCCCCC">gasps left by the event log</font>

932
00:45:39,510 --> 00:45:49,200
so it allows<font color="#CCCCCC"> us to basically select all</font>

933
00:45:47,250 --> 00:45:51,990
the events and put it out into<font color="#E5E5E5"> this</font>

934
00:45:49,200 --> 00:45:54,240
format<font color="#E5E5E5"> it spits it out</font><font color="#CCCCCC"> and we have some</font>

935
00:45:51,990 --> 00:45:56,580
<font color="#E5E5E5">interesting things here so some columns</font>

936
00:45:54,240 --> 00:46:00,180
or it looks pretty<font color="#E5E5E5"> similar to event log</font>

937
00:45:56,580 --> 00:46:05,640
<font color="#CCCCCC">explorer</font><font color="#E5E5E5"> right the event ID the category</font>

938
00:46:00,180 --> 00:46:07,830
and so we see that the strings over here

939
00:46:05,640 --> 00:46:10,799
pretty much contains the same data

940
00:46:07,830 --> 00:46:12,930
that's in the description field here so

941
00:46:10,800 --> 00:46:14,790
<font color="#E5E5E5">I can export this out into a CSV which</font>

942
00:46:12,930 --> 00:46:17,160
is you know helpful if I want<font color="#E5E5E5"> to look</font>

943
00:46:14,790 --> 00:46:19,050
search for strings but what I really

944
00:46:17,160 --> 00:46:21,450
want to<font color="#E5E5E5"> do is be</font><font color="#CCCCCC"> able to extract all</font>

945
00:46:19,050 --> 00:46:23,790
this data that's out of these um you

946
00:46:21,450 --> 00:46:25,290
know these these fields all these

947
00:46:23,790 --> 00:46:27,870
separate parameters I want to put them

948
00:46:25,290 --> 00:46:31,560
<font color="#E5E5E5">in individual column so what you can do</font>

949
00:46:27,870 --> 00:46:33,720
with the event with a log parser Studios

950
00:46:31,560 --> 00:46:35,850
you can basically write a query so that

951
00:46:33,720 --> 00:46:38,250
you're querying specific parameters

952
00:46:35,850 --> 00:46:42,299
inside the event<font color="#E5E5E5"> logs so we're</font><font color="#CCCCCC"> going to</font>

953
00:46:38,250 --> 00:46:45,480
do now so we'll say instead of select

954
00:46:42,300 --> 00:46:49,110
everything will say time generated so

955
00:46:45,480 --> 00:46:52,890
this<font color="#CCCCCC"> is this is a you know a field</font>

956
00:46:49,110 --> 00:46:56,760
that's already in let's define we do

957
00:46:52,890 --> 00:46:59,629
come generated and then we want<font color="#E5E5E5"> to do</font>

958
00:46:56,760 --> 00:46:59,630
event ID

959
00:47:05,740 --> 00:47:18,879
we'll<font color="#E5E5E5"> just try to run it against those</font>

960
00:47:09,580 --> 00:47:22,540
so we were able<font color="#CCCCCC"> to query what we're</font>

961
00:47:18,880 --> 00:47:24,369
requesting just these two columns<font color="#E5E5E5"> so</font>

962
00:47:22,540 --> 00:47:26,350
what we want<font color="#E5E5E5"> to do now</font><font color="#CCCCCC"> is see if</font><font color="#E5E5E5"> we can</font>

963
00:47:24,369 --> 00:47:29,350
pull data out of particular parameters

964
00:47:26,350 --> 00:47:36,540
so what you<font color="#E5E5E5"> can do that is you can use</font>

965
00:47:29,350 --> 00:47:36,540
extract string or token

966
00:47:49,519 --> 00:47:57,229
then you give it a name so we'll say

967
00:47:52,489 --> 00:48:00,679
string 4 is actually this did which is

968
00:47:57,229 --> 00:48:03,759
like the associated with the user keep

969
00:48:00,679 --> 00:48:03,759
that correct

970
00:48:09,220 --> 00:48:13,180
so you can see the user<font color="#CCCCCC"> that is</font>

971
00:48:11,410 --> 00:48:14,770
associated with these IDs so now what

972
00:48:13,180 --> 00:48:17,770
I'm<font color="#E5E5E5"> really concerned about is you know I</font>

973
00:48:14,770 --> 00:48:20,259
want to find out this you know the

974
00:48:17,770 --> 00:48:22,780
source IP addresses and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> the logon</font>

975
00:48:20,260 --> 00:48:27,130
types for all of these events and I'm

976
00:48:22,780 --> 00:48:30,310
only concerned about the event 4624 so

977
00:48:27,130 --> 00:48:36,609
we're going to further refine this so

978
00:48:30,310 --> 00:48:40,599
we'll do the sequel query where event ID

979
00:48:36,609 --> 00:48:57,460
equals 36 24 and we want to add another

980
00:48:40,599 --> 00:49:00,060
<font color="#E5E5E5">column so we'll say we'll say awesome</font>

981
00:48:57,460 --> 00:49:00,060
<font color="#E5E5E5">your source IP</font>

982
00:49:18,470 --> 00:49:21,830
[Music]

983
00:49:30,680 --> 00:49:32,740
Oh

984
00:49:45,090 --> 00:49:54,960
d i'm<font color="#E5E5E5"> not sure why it's not working so</font>

985
00:49:52,080 --> 00:49:57,540
what I have here is<font color="#E5E5E5"> um these are pre</font>

986
00:49:54,960 --> 00:49:59,760
cans<font color="#E5E5E5"> query so I basically ran through</font>

987
00:49:57,540 --> 00:50:02,700
and i found out which queries I want to

988
00:49:59,760 --> 00:50:04,560
do so you can<font color="#CCCCCC"> just come once you divide</font>

989
00:50:02,700 --> 00:50:07,230
them you can copy<font color="#E5E5E5"> and paste them into</font>

990
00:50:04,560 --> 00:50:10,200
log parser studio and you can run the

991
00:50:07,230 --> 00:50:12,810
query against an event log and output

992
00:50:10,200 --> 00:50:16,350
basically all of<font color="#E5E5E5"> the description</font>

993
00:50:12,810 --> 00:50:19,140
information in a nice column format so

994
00:50:16,350 --> 00:50:22,710
that you can say<font color="#CCCCCC"> alright here's all the</font>

995
00:50:19,140 --> 00:50:24,990
<font color="#E5E5E5">logon types to</font><font color="#CCCCCC"> ten and then you can see</font>

996
00:50:22,710 --> 00:50:26,670
<font color="#CCCCCC">all the source IP addresses processing</font>

997
00:50:24,990 --> 00:50:30,450
<font color="#E5E5E5">that was used for them and the users</font>

998
00:50:26,670 --> 00:50:32,910
that are associated<font color="#E5E5E5"> with it now this is</font>

999
00:50:30,450 --> 00:50:34,410
pretty pretty helpful because a lot of

1000
00:50:32,910 --> 00:50:36,270
times when<font color="#E5E5E5"> you're working with event</font>

1001
00:50:34,410 --> 00:50:38,609
logs it's pretty Congress them you don't

1002
00:50:36,270 --> 00:50:41,880
have the data separated into specific

1003
00:50:38,610 --> 00:50:43,350
fields so this<font color="#CCCCCC"> is really helpful who</font>

1004
00:50:41,880 --> 00:50:47,310
here works with event logs and thinks

1005
00:50:43,350 --> 00:50:50,100
this is<font color="#E5E5E5"> helpful yeah</font><font color="#CCCCCC"> okay this was not a</font>

1006
00:50:47,310 --> 00:50:54,870
waste of<font color="#CCCCCC"> time so we're going to export</font>

1007
00:50:50,100 --> 00:51:02,279
<font color="#E5E5E5">this as a CSV we're going to call it</font>

1008
00:50:54,870 --> 00:51:03,930
4624 so what we want to do is we want<font color="#E5E5E5"> to</font>

1009
00:51:02,280 --> 00:51:07,620
add<font color="#E5E5E5"> more information to this so we have</font>

1010
00:51:03,930 --> 00:51:12,690
<font color="#E5E5E5">all these event IDs that show us you</font>

1011
00:51:07,620 --> 00:51:14,100
know we have all these 4624<font color="#E5E5E5"> logon event</font>

1012
00:51:12,690 --> 00:51:16,290
and we want to get<font color="#E5E5E5"> more information</font>

1013
00:51:14,100 --> 00:51:19,140
around it so one<font color="#CCCCCC"> of the other things</font>

1014
00:51:16,290 --> 00:51:21,810
<font color="#CCCCCC">that</font><font color="#E5E5E5"> are really interesting is service</font>

1015
00:51:19,140 --> 00:51:28,529
creation so we'll go<font color="#CCCCCC"> ahead and</font><font color="#E5E5E5"> see if we</font>

1016
00:51:21,810 --> 00:51:33,180
can get the<font color="#CCCCCC"> system event log loaded so</font>

1017
00:51:28,530 --> 00:51:35,490
we'll add basically i created a query so

1018
00:51:33,180 --> 00:51:37,589
that we're<font color="#E5E5E5"> going to get the service</font>

1019
00:51:35,490 --> 00:51:40,410
creation event and then have these null

1020
00:51:37,590 --> 00:51:42,540
field so that they kind of act as<font color="#E5E5E5"> a</font>

1021
00:51:40,410 --> 00:51:45,029
space holder so that when<font color="#CCCCCC"> we add them to</font>

1022
00:51:42,540 --> 00:51:49,380
the<font color="#CCCCCC"> CSV the information winds up</font>

1023
00:51:45,030 --> 00:51:51,870
correctly we're chains will add an

1024
00:51:49,380 --> 00:51:56,549
additional file to query system event

1025
00:51:51,870 --> 00:51:58,380
Royal Command

1026
00:51:56,549 --> 00:52:01,079
are all the<font color="#CCCCCC"> server's services that were</font>

1027
00:51:58,380 --> 00:52:03,089
created on the the same box that we're

1028
00:52:01,079 --> 00:52:04,709
investigating you can see we<font color="#CCCCCC"> have the PS</font>

1029
00:52:03,089 --> 00:52:08,099
exec which is you know kind of

1030
00:52:04,709 --> 00:52:13,499
<font color="#E5E5E5">suspicious who here knows what PS exec</font>

1031
00:52:08,099 --> 00:52:15,509
is explaining I yeah you can use<font color="#CCCCCC"> it to</font>

1032
00:52:13,499 --> 00:52:17,669
push<font color="#E5E5E5"> PowerShell to other computers it</font>

1033
00:52:15,509 --> 00:52:20,130
can be used to push an actually cute

1034
00:52:17,670 --> 00:52:22,109
able to a remote system a lot<font color="#E5E5E5"> of times</font>

1035
00:52:20,130 --> 00:52:24,900
attackers will use it to remote we

1036
00:52:22,109 --> 00:52:28,229
execute a tool on a dental computer like

1037
00:52:24,900 --> 00:52:29,759
credential<font color="#CCCCCC"> harvester so we also see some</font>

1038
00:52:28,229 --> 00:52:34,589
other things here that are kind of

1039
00:52:29,759 --> 00:52:36,989
interesting so this executable here<font color="#CCCCCC"> we</font>

1040
00:52:34,589 --> 00:52:39,239
<font color="#CCCCCC">see s response was executed this top</font>

1041
00:52:36,989 --> 00:52:40,799
<font color="#CCCCCC">hell is that</font><font color="#E5E5E5"> so this is good information</font>

1042
00:52:39,239 --> 00:52:48,599
we're going to export<font color="#E5E5E5"> this out to</font>

1043
00:52:40,799 --> 00:52:52,829
another CSP call it so many 45 great and

1044
00:52:48,599 --> 00:52:59,579
then we're also do this event log this

1045
00:52:52,829 --> 00:53:02,789
is this is like a log off event so when

1046
00:52:59,579 --> 00:53:04,499
<font color="#E5E5E5">I'm working with a lot of system event</font>

1047
00:53:02,789 --> 00:53:08,579
logs and security event logs from

1048
00:53:04,499 --> 00:53:10,618
multiple multiple workstations it can

1049
00:53:08,579 --> 00:53:14,039
get pretty cumbersome when you're trying

1050
00:53:10,619 --> 00:53:15,900
<font color="#E5E5E5">to use an event log Explorer to you know</font>

1051
00:53:14,039 --> 00:53:17,519
basically<font color="#E5E5E5"> build a timeline of all this</font>

1052
00:53:15,900 --> 00:53:19,859
stuff<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> happened on multiple</font>

1053
00:53:17,519 --> 00:53:22,799
computers so this<font color="#E5E5E5"> is a this would be</font>

1054
00:53:19,859 --> 00:53:26,729
useful to pull event from multiple

1055
00:53:22,799 --> 00:53:29,219
security event logs into one view so

1056
00:53:26,729 --> 00:53:31,939
we'll do the same thing for the log off

1057
00:53:29,219 --> 00:53:31,939
creations

1058
00:53:46,770 --> 00:53:51,960
then so<font color="#E5E5E5"> after I have all these CSVs one</font>

1059
00:53:49,740 --> 00:53:56,279
thing<font color="#E5E5E5"> I would do is basically take the</font>

1060
00:53:51,960 --> 00:54:00,020
data that's in these and copy them all

1061
00:53:56,280 --> 00:54:00,020
into<font color="#CCCCCC"> one spreadsheet</font>

1062
00:54:26,070 --> 00:54:29,610
right now I have<font color="#E5E5E5"> all my events in one</font>

1063
00:54:28,050 --> 00:54:31,920
spreadsheet and it can<font color="#CCCCCC"> make it a lot</font>

1064
00:54:29,610 --> 00:54:36,630
easier to<font color="#E5E5E5"> identify what was going on so</font>

1065
00:54:31,920 --> 00:54:39,060
I'll sort it by date and then<font color="#E5E5E5"> a couple</font>

1066
00:54:36,630 --> 00:54:46,680
other things i'll do is add<font color="#E5E5E5"> to filter</font>

1067
00:54:39,060 --> 00:54:48,840
and then make the view top so<font color="#CCCCCC"> it freezes</font>

1068
00:54:46,680 --> 00:54:57,029
the top and<font color="#E5E5E5"> then I can start looking you</font>

1069
00:54:48,840 --> 00:54:59,010
<font color="#E5E5E5">know at</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> that one PS exec so we see</font>

1070
00:54:57,030 --> 00:55:03,270
that<font color="#E5E5E5"> the service was created PS exec</font>

1071
00:54:59,010 --> 00:55:05,160
then when you look at a lot<font color="#E5E5E5"> of event</font>

1072
00:55:03,270 --> 00:55:08,070
logs it might not<font color="#E5E5E5"> tell you you know the</font>

1073
00:55:05,160 --> 00:55:13,200
user particularly that was used to do

1074
00:55:08,070 --> 00:55:15,000
these activities but then you have some

1075
00:55:13,200 --> 00:55:16,649
you basically build a timeline of

1076
00:55:15,000 --> 00:55:18,600
activity<font color="#CCCCCC"> that happens so we see that</font>

1077
00:55:16,650 --> 00:55:21,750
this user logged in<font color="#CCCCCC"> it's my brain</font><font color="#E5E5E5"> Ian</font>

1078
00:55:18,600 --> 00:55:28,799
user logged in and then PS exec was

1079
00:55:21,750 --> 00:55:31,110
service was created this one here source

1080
00:55:28,800 --> 00:55:37,860
host is just like a random string of

1081
00:55:31,110 --> 00:55:40,050
numbers that's pretty suspicious<font color="#CCCCCC"> ok I'm</font>

1082
00:55:37,860 --> 00:55:41,700
going over so you know this<font color="#E5E5E5"> is one</font>

1083
00:55:40,050 --> 00:55:46,320
method<font color="#E5E5E5"> that I use when I'm working with</font>

1084
00:55:41,700 --> 00:55:48,689
<font color="#E5E5E5">a lot of system event logs if you have</font>

1085
00:55:46,320 --> 00:55:52,110
any questions<font color="#E5E5E5"> on that process what talk</font>

1086
00:55:48,690 --> 00:55:53,520
to me after this presentation a couple

1087
00:55:52,110 --> 00:55:54,750
of things<font color="#CCCCCC"> I wanted some other things I</font>

1088
00:55:53,520 --> 00:55:58,230
want to talk<font color="#CCCCCC"> about the email</font>

1089
00:55:54,750 --> 00:56:00,030
authentication logs so like we said

1090
00:55:58,230 --> 00:56:04,440
before you know you want to find out

1091
00:56:00,030 --> 00:56:05,850
what um what what users accounts might

1092
00:56:04,440 --> 00:56:08,100
have been compromised one not one way to

1093
00:56:05,850 --> 00:56:10,259
identify that is by looking to<font color="#E5E5E5"> see who</font>

1094
00:56:08,100 --> 00:56:15,150
may have accessed their email remotely

1095
00:56:10,260 --> 00:56:16,710
so you know<font color="#CCCCCC"> ola outlook webmail so a lot</font>

1096
00:56:15,150 --> 00:56:19,050
of people<font color="#CCCCCC"> a lot of corporations have</font>

1097
00:56:16,710 --> 00:56:21,540
users that are able<font color="#CCCCCC"> to log into a</font>

1098
00:56:19,050 --> 00:56:24,030
website to access or email office 365

1099
00:56:21,540 --> 00:56:26,790
similar one thing that keep in mind is

1100
00:56:24,030 --> 00:56:28,590
that by default this is<font color="#E5E5E5"> not logged so</font>

1101
00:56:26,790 --> 00:56:32,460
it's something<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want to talk to</font>

1102
00:56:28,590 --> 00:56:34,680
Microsoft about it actually office 365

1103
00:56:32,460 --> 00:56:36,540
actually uses as your as a backbone on

1104
00:56:34,680 --> 00:56:38,460
the measure is basically active

1105
00:56:36,540 --> 00:56:39,480
directory so what's one thing you want

1106
00:56:38,460 --> 00:56:43,020
<font color="#E5E5E5">to keep in mind</font>

1107
00:56:39,480 --> 00:56:44,490
is you<font color="#E5E5E5"> know you have act century active</font>

1108
00:56:43,020 --> 00:56:46,800
directory in the cloud and you can

1109
00:56:44,490 --> 00:56:48,000
request the authentication walks and

1110
00:56:46,800 --> 00:56:50,609
they provide a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> useful information</font>

1111
00:56:48,000 --> 00:56:52,800
<font color="#E5E5E5">like what applications were used by this</font>

1112
00:56:50,609 --> 00:56:55,380
user did they<font color="#E5E5E5"> use SharePoint did they</font>

1113
00:56:52,800 --> 00:56:59,460
create files they delete files in<font color="#E5E5E5"> their</font>

1114
00:56:55,380 --> 00:57:02,580
sharepoint online gmail also has a

1115
00:56:59,460 --> 00:57:06,600
synoptic authentication<font color="#CCCCCC"> log that can be</font>

1116
00:57:02,580 --> 00:57:09,150
useful<font color="#E5E5E5"> so when you're</font><font color="#CCCCCC"> thinking about you</font>

1117
00:57:06,600 --> 00:57:10,710
know<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these incidents you have</font>

1118
00:57:09,150 --> 00:57:13,950
to<font color="#E5E5E5"> think about what data do I actually</font>

1119
00:57:10,710 --> 00:57:16,440
want<font color="#E5E5E5"> to look at because you might</font>

1120
00:57:13,950 --> 00:57:17,879
overlook the fact that information are

1121
00:57:16,440 --> 00:57:20,550
you looking for is<font color="#E5E5E5"> not on the host but</font>

1122
00:57:17,880 --> 00:57:22,740
it's<font color="#E5E5E5"> actually in log data so you know</font>

1123
00:57:20,550 --> 00:57:25,140
some of the instant scenarios like we

1124
00:57:22,740 --> 00:57:27,509
talked about if you had a teacher who is

1125
00:57:25,140 --> 00:57:29,730
using their workstation for you know

1126
00:57:27,510 --> 00:57:31,650
looking at malicious websites you might

1127
00:57:29,730 --> 00:57:33,390
not see it on disk but if they did it<font color="#E5E5E5"> on</font>

1128
00:57:31,650 --> 00:57:38,250
the network then you go to the youth to

1129
00:57:33,390 --> 00:57:40,259
the web proxy logs and I'm one thing

1130
00:57:38,250 --> 00:57:43,080
<font color="#CCCCCC">about central logging so all this data</font>

1131
00:57:40,260 --> 00:57:44,700
is a you know stored on individual

1132
00:57:43,080 --> 00:57:46,500
systems you got security event logs here

1133
00:57:44,700 --> 00:57:48,899
you got security event logs here you

1134
00:57:46,500 --> 00:57:50,580
might have some actual logs on the

1135
00:57:48,900 --> 00:57:52,740
application server depending on what<font color="#CCCCCC"> the</font>

1136
00:57:50,580 --> 00:57:55,680
application is you have firewall logs

1137
00:57:52,740 --> 00:57:59,100
here you have web proxies here so

1138
00:57:55,680 --> 00:58:01,169
central logging like like a<font color="#E5E5E5"> blanc or</font>

1139
00:57:59,100 --> 00:58:03,359
something like that is really<font color="#E5E5E5"> useful</font>

1140
00:58:01,170 --> 00:58:05,820
because<font color="#CCCCCC"> it takes all the log data on the</font>

1141
00:58:03,359 --> 00:58:08,069
on the oats and then it puts it into one

1142
00:58:05,820 --> 00:58:11,340
central location this is useful<font color="#E5E5E5"> because</font>

1143
00:58:08,070 --> 00:58:12,930
it will do data analysis for you it will

1144
00:58:11,340 --> 00:58:15,480
look at your event logs and say hey

1145
00:58:12,930 --> 00:58:17,430
there's an event log being<font color="#E5E5E5"> queered</font>

1146
00:58:15,480 --> 00:58:19,770
that's officious<font color="#CCCCCC"> and i'll</font><font color="#E5E5E5"> send an email</font>

1147
00:58:17,430 --> 00:58:23,940
to your IT staff and say you should<font color="#CCCCCC"> look</font>

1148
00:58:19,770 --> 00:58:26,430
at<font color="#CCCCCC"> this it</font><font color="#E5E5E5"> will also release the burden</font>

1149
00:58:23,940 --> 00:58:27,990
of having all that information stored on

1150
00:58:26,430 --> 00:58:29,220
the local host so you don't want your

1151
00:58:27,990 --> 00:58:30,509
domain controller to crash because

1152
00:58:29,220 --> 00:58:33,180
you're running out<font color="#E5E5E5"> of disk space you</font>

1153
00:58:30,510 --> 00:58:36,060
want all that data to go somewhere<font color="#E5E5E5"> else</font>

1154
00:58:33,180 --> 00:58:37,799
that's dedicated for that purpose<font color="#E5E5E5"> and</font>

1155
00:58:36,060 --> 00:58:39,630
also<font color="#CCCCCC"> if you're if you have an attacker</font>

1156
00:58:37,800 --> 00:58:41,670
do you think there's an attacker in your

1157
00:58:39,630 --> 00:58:43,680
environment and they're trying<font color="#CCCCCC"> to delete</font>

1158
00:58:41,670 --> 00:58:45,480
data on the host then you can actually

1159
00:58:43,680 --> 00:58:47,009
you know have a peace of mind knowing

1160
00:58:45,480 --> 00:58:51,180
<font color="#CCCCCC">that they won't touch the data</font><font color="#E5E5E5"> that's on</font>

1161
00:58:47,010 --> 00:58:52,770
the central logging server so here are

1162
00:58:51,180 --> 00:58:53,460
some things<font color="#E5E5E5"> to consider for my</font>

1163
00:58:52,770 --> 00:58:54,750
investigation

1164
00:58:53,460 --> 00:58:55,950
you know we always<font color="#E5E5E5"> tell our clients you</font>

1165
00:58:54,750 --> 00:58:58,050
look at the logging that you currently

1166
00:58:55,950 --> 00:59:00,029
<font color="#E5E5E5">have what can be done better trying to</font>

1167
00:58:58,050 --> 00:59:01,440
improve on it make sure<font color="#E5E5E5"> that it's</font>

1168
00:59:00,030 --> 00:59:03,150
actually being retained a lot of times

1169
00:59:01,440 --> 00:59:05,040
we talk to clients and they say<font color="#CCCCCC"> hey we</font>

1170
00:59:03,150 --> 00:59:06,900
have log data we have firewall logs that

1171
00:59:05,040 --> 00:59:09,390
go back three years<font color="#E5E5E5"> then it turns out</font>

1172
00:59:06,900 --> 00:59:11,640
they don't so that's something that

1173
00:59:09,390 --> 00:59:14,009
<font color="#CCCCCC">needs to be</font><font color="#E5E5E5"> like probably periodically</font>

1174
00:59:11,640 --> 00:59:17,160
checked is make sure that<font color="#CCCCCC"> your logs are</font>

1175
00:59:14,010 --> 00:59:19,230
actually<font color="#CCCCCC"> exists practice collecting logs</font>

1176
00:59:17,160 --> 00:59:20,640
go talk to<font color="#E5E5E5"> Microsoft see how long it</font>

1177
00:59:19,230 --> 00:59:23,490
would<font color="#CCCCCC"> actually take for you to get log</font>

1178
00:59:20,640 --> 00:59:25,410
data from Microsoft if you have a vendor

1179
00:59:23,490 --> 00:59:29,040
<font color="#CCCCCC">that does your</font><font color="#E5E5E5"> manage your you know</font>

1180
00:59:25,410 --> 00:59:30,270
firewall management for you ask them if

1181
00:59:29,040 --> 00:59:33,839
<font color="#CCCCCC">you can get some logged and see how long</font>

1182
00:59:30,270 --> 00:59:35,490
<font color="#CCCCCC">that would take all right that went over</font>

1183
00:59:33,839 --> 00:59:40,339
<font color="#E5E5E5">a little bit are there any questions for</font>

1184
00:59:35,490 --> 00:59:40,339
<font color="#E5E5E5">my presentation yep</font>

1185
00:59:49,570 --> 00:59:55,300
so we see it we see them wiping out a

1186
00:59:52,300 --> 00:59:57,400
vent logs you know we see the event logs

1187
00:59:55,300 --> 00:59:58,750
being cleared for sure a lot<font color="#E5E5E5"> of times</font>

1188
00:59:57,400 --> 01:00:01,300
that happens like when people use like

1189
00:59:58,750 --> 01:00:03,730
<font color="#CCCCCC">amateur Peter metasploit or if they're</font>

1190
01:00:01,300 --> 01:00:05,950
installing appointed sale malware we've

1191
01:00:03,730 --> 01:00:08,050
seen that happen before in terms<font color="#CCCCCC"> of like</font>

1192
01:00:05,950 --> 01:00:09,790
you know firewall logs I don't see like

1193
01:00:08,050 --> 01:00:11,740
firewalls themselves being compromised

1194
01:00:09,790 --> 01:00:13,900
in the event log there's a<font color="#CCCCCC"> far wall dogs</font>

1195
01:00:11,740 --> 01:00:15,729
being destroyed that doesn't we<font color="#E5E5E5"> haven't</font>

1196
01:00:13,900 --> 01:00:22,720
seen<font color="#E5E5E5"> that often it's usually just like</font>

1197
01:00:15,730 --> 01:00:25,260
host logs that<font color="#CCCCCC"> could you know white any</font>

1198
01:00:22,720 --> 01:00:25,259
other questions

1199
01:00:26,670 --> 01:00:31,179
[Applause]

