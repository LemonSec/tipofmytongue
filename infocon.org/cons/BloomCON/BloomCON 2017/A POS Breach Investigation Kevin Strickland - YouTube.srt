1
00:00:00,000 --> 00:00:03,600
so<font color="#CCCCCC"> hopefully everybody's in the</font><font color="#E5E5E5"> right</font>

2
00:00:02,370 --> 00:00:06,720
room right corner cell breach

3
00:00:03,600 --> 00:00:08,730
investigation yeah anybody not all right

4
00:00:06,720 --> 00:00:10,260
so the title is a little bit misleading

5
00:00:08,730 --> 00:00:12,450
the whole point of this is actually<font color="#CCCCCC"> to</font>

6
00:00:10,260 --> 00:00:13,410
kind of show you guys investigation

7
00:00:12,450 --> 00:00:15,329
techniques and things<font color="#E5E5E5"> that you should be</font>

8
00:00:13,410 --> 00:00:17,100
looking<font color="#E5E5E5"> at on systems these are just</font>

9
00:00:15,330 --> 00:00:20,009
common ones that<font color="#E5E5E5"> I've observed myself</font>

10
00:00:17,100 --> 00:00:21,840
when working some of them so just<font color="#CCCCCC"> to</font>

11
00:00:20,010 --> 00:00:23,100
introduce<font color="#E5E5E5"> myself my name is Kevin</font>

12
00:00:21,840 --> 00:00:24,570
Strickland I'm one of the senior

13
00:00:23,100 --> 00:00:26,849
Incident Response consultants with Dell

14
00:00:24,570 --> 00:00:29,130
SecureWorks well just<font color="#CCCCCC"> secureworks now I</font>

15
00:00:26,849 --> 00:00:30,840
work on pretty much anything you can

16
00:00:29,130 --> 00:00:33,030
think of from you know large data

17
00:00:30,840 --> 00:00:34,380
breaches see website<font color="#E5E5E5"> compromises to rain</font>

18
00:00:33,030 --> 00:00:36,030
somewhere cases anything of that nature

19
00:00:34,380 --> 00:00:37,620
before I work towards the Cure works I

20
00:00:36,030 --> 00:00:39,690
actually<font color="#E5E5E5"> work for the Department of</font>

21
00:00:37,620 --> 00:00:41,250
Defense doing intrusion analysis into

22
00:00:39,690 --> 00:00:45,149
the handling<font color="#CCCCCC"> versioning</font><font color="#E5E5E5"> our and digital</font>

23
00:00:41,250 --> 00:00:47,640
forensics so mom so the reason why i

24
00:00:45,149 --> 00:00:48,960
created this presentation<font color="#E5E5E5"> i guess was</font>

25
00:00:47,640 --> 00:00:51,809
because i noticed<font color="#CCCCCC"> that we got a lot of</font>

26
00:00:48,960 --> 00:00:54,449
interns and college graduates and law

27
00:00:51,809 --> 00:00:56,879
enforcement guys that just<font color="#E5E5E5"> couldn't do</font>

28
00:00:54,449 --> 00:00:58,379
the ir function race they would take a

29
00:00:56,879 --> 00:00:59,519
week to find stuff<font color="#E5E5E5"> that we some of the</font>

30
00:00:58,379 --> 00:01:01,739
more experienced guys would find in an

31
00:00:59,520 --> 00:01:03,210
hour right and so my question was why is

32
00:01:01,739 --> 00:01:05,908
it taking you guys so long to find it

33
00:01:03,210 --> 00:01:07,830
<font color="#CCCCCC">right for us it's always you know</font>

34
00:01:05,909 --> 00:01:09,060
clients<font color="#E5E5E5"> are demanding answers they want</font>

35
00:01:07,830 --> 00:01:10,260
it now and we need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> go figure</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> out</font>

36
00:01:09,060 --> 00:01:11,340
right because the longer it takes us<font color="#E5E5E5"> to</font>

37
00:01:10,260 --> 00:01:12,780
<font color="#E5E5E5">figure it out the more damage is</font>

38
00:01:11,340 --> 00:01:15,630
happening to the customer right and

39
00:01:12,780 --> 00:01:17,460
that's what we need to figure out so<font color="#E5E5E5"> I</font>

40
00:01:15,630 --> 00:01:19,619
have a laser pointer so there's a lot<font color="#E5E5E5"> of</font>

41
00:01:17,460 --> 00:01:21,089
different<font color="#E5E5E5"> types of</font><font color="#CCCCCC"> point of sale malware</font>

42
00:01:19,619 --> 00:01:23,340
right and I'm just going to<font color="#E5E5E5"> call it POS</font>

43
00:01:21,090 --> 00:01:25,080
it's<font color="#E5E5E5"> not the other POS that you might be</font>

44
00:01:23,340 --> 00:01:27,689
<font color="#E5E5E5">thinking of so just remember that</font>

45
00:01:25,080 --> 00:01:31,200
there's a lot these are just a list of a

46
00:01:27,689 --> 00:01:33,508
couple of them some<font color="#E5E5E5"> of those popular</font>

47
00:01:31,200 --> 00:01:34,979
ones are framework POS for all POS black

48
00:01:33,509 --> 00:01:36,150
POS is a couple of different ones as

49
00:01:34,979 --> 00:01:38,070
well there's new<font color="#E5E5E5"> bearings that are</font>

50
00:01:36,150 --> 00:01:39,780
coming out all the time it's not just

51
00:01:38,070 --> 00:01:43,110
isolated to these<font color="#E5E5E5"> types of malware</font>

52
00:01:39,780 --> 00:01:47,430
variants right anyone know what net wire

53
00:01:43,110 --> 00:01:49,770
or a grind is or care to<font color="#E5E5E5"> guess now no</font>

54
00:01:47,430 --> 00:01:52,619
once I guess always google<font color="#E5E5E5"> to google is</font>

55
00:01:49,770 --> 00:01:54,149
<font color="#CCCCCC">your best</font><font color="#E5E5E5"> friend but Google I'm sorry</font>

56
00:01:52,619 --> 00:01:56,219
add wine and that wire types of remote

57
00:01:54,149 --> 00:01:58,979
access tools right so what we've seen in

58
00:01:56,219 --> 00:02:00,539
the past year is that hotel chains<font color="#E5E5E5"> are</font>

59
00:01:58,979 --> 00:02:01,798
getting inspected right so they<font color="#E5E5E5"> get an</font>

60
00:02:00,540 --> 00:02:04,259
email the basic says hey I have a

61
00:02:01,799 --> 00:02:05,820
reservation they open it up it's

62
00:02:04,259 --> 00:02:07,560
actually a malicious executable or

63
00:02:05,820 --> 00:02:09,840
malicious java file and none of the jar

64
00:02:07,560 --> 00:02:11,160
or<font color="#CCCCCC"> java archive and those are actually</font>

65
00:02:09,840 --> 00:02:13,090
rats and<font color="#CCCCCC"> the rats of key logging</font>

66
00:02:11,160 --> 00:02:14,290
functionality built into them

67
00:02:13,090 --> 00:02:15,610
you go to the hotel<font color="#E5E5E5"> and you swipe</font><font color="#CCCCCC"> your</font>

68
00:02:14,290 --> 00:02:17,349
card or they take the card and<font color="#E5E5E5"> they</font>

69
00:02:15,610 --> 00:02:20,019
tried before<font color="#E5E5E5"> you write that data gets</font>

70
00:02:17,349 --> 00:02:22,119
trained sent over to the computer<font color="#E5E5E5"> all in</font>

71
00:02:20,019 --> 00:02:23,560
clear text all right and because it's

72
00:02:22,120 --> 00:02:24,970
clear text the<font color="#CCCCCC"> keylogger sees it and</font>

73
00:02:23,560 --> 00:02:26,379
save it to<font color="#CCCCCC"> a file so now your credit</font>

74
00:02:24,970 --> 00:02:29,590
card credentials have been<font color="#E5E5E5"> stolen where</font>

75
00:02:26,379 --> 00:02:31,420
your card data has been stolen so that's

76
00:02:29,590 --> 00:02:32,799
one specific way for today we're

77
00:02:31,420 --> 00:02:35,140
probably concentrate more on the actual

78
00:02:32,799 --> 00:02:37,330
<font color="#E5E5E5">point-of-sale Mauer itself and sort of</font>

79
00:02:35,140 --> 00:02:39,760
<font color="#E5E5E5">the</font><font color="#CCCCCC"> way that it works so again you know</font>

80
00:02:37,330 --> 00:02:41,920
you go<font color="#E5E5E5"> to a retail store you go to you</font>

81
00:02:39,760 --> 00:02:43,899
know Target Home Depot Walmart etc what

82
00:02:41,920 --> 00:02:45,760
have you doesn't matter right you go and

83
00:02:43,900 --> 00:02:47,170
select your card the Cardinal gets sent

84
00:02:45,760 --> 00:02:48,819
from the pin pad over to the computer

85
00:02:47,170 --> 00:02:51,280
<font color="#E5E5E5">now that's sort of where the transaction</font>

86
00:02:48,819 --> 00:02:52,569
occurs and sometimes we have we<font color="#E5E5E5"> don't</font>

87
00:02:51,280 --> 00:02:54,790
have encryption that takes place<font color="#E5E5E5"> right</font>

88
00:02:52,569 --> 00:02:55,899
so sometimes you might hear point to

89
00:02:54,790 --> 00:02:57,670
<font color="#CCCCCC">point encryption right so that would be</font>

90
00:02:55,900 --> 00:03:00,160
pinned from the pin pads to the computer

91
00:02:57,670 --> 00:03:02,260
itself and be all encrypted well but

92
00:03:00,160 --> 00:03:03,700
does it really happen as much<font color="#E5E5E5"> as</font>

93
00:03:02,260 --> 00:03:05,260
retailers like to think<font color="#CCCCCC"> that it does</font>

94
00:03:03,700 --> 00:03:07,420
right<font color="#E5E5E5"> a lot of times that happens to be</font>

95
00:03:05,260 --> 00:03:09,489
in clear text so while the point style

96
00:03:07,420 --> 00:03:12,339
sorry point-of-sale malware is actively

97
00:03:09,489 --> 00:03:14,260
running on the system it looks<font color="#E5E5E5"> into</font>

98
00:03:12,340 --> 00:03:15,760
specific processes right there's some

99
00:03:14,260 --> 00:03:17,048
processes that aren't going<font color="#E5E5E5"> to hold card</font>

100
00:03:15,760 --> 00:03:19,630
data so the mower doesn't need to go

101
00:03:17,049 --> 00:03:22,959
scan them right process is like svchost

102
00:03:19,630 --> 00:03:24,459
probably word right notepad those things

103
00:03:22,959 --> 00:03:27,190
probably are<font color="#CCCCCC"> not holding credit card</font>

104
00:03:24,459 --> 00:03:28,870
data right there's actual opera is an

105
00:03:27,190 --> 00:03:29,799
example of point of sale software right

106
00:03:28,870 --> 00:03:31,750
that would store that type of

107
00:03:29,799 --> 00:03:33,370
information so now our authors do this

108
00:03:31,750 --> 00:03:35,470
so they hope make it less likely that

109
00:03:33,370 --> 00:03:38,590
they're going<font color="#E5E5E5"> to crash the system</font><font color="#CCCCCC"> all</font>

110
00:03:35,470 --> 00:03:39,489
<font color="#CCCCCC">right so another issue that we see you</font>

111
00:03:38,590 --> 00:03:41,049
<font color="#E5E5E5">know probably talk on this little bit</font>

112
00:03:39,489 --> 00:03:43,690
<font color="#E5E5E5">more later so I kind of I might jump</font>

113
00:03:41,049 --> 00:03:45,970
around is that that<font color="#E5E5E5"> card data but the</font>

114
00:03:43,690 --> 00:03:47,799
Mauer steals they don't often just put

115
00:03:45,970 --> 00:03:49,959
it on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> system that's card data right</font>

116
00:03:47,799 --> 00:03:51,970
they encode it all right so some things

117
00:03:49,959 --> 00:03:53,530
<font color="#E5E5E5">I see a lot of the new folks that we get</font>

118
00:03:51,970 --> 00:03:55,209
is they do keyword searches or<font color="#E5E5E5"> regex</font>

119
00:03:53,530 --> 00:03:57,880
expressions for a credit<font color="#E5E5E5"> card data or</font>

120
00:03:55,209 --> 00:03:59,109
card you know information<font color="#CCCCCC"> right they're</font>

121
00:03:57,880 --> 00:04:00,280
not going<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> results a lot of time</font>

122
00:03:59,109 --> 00:04:01,510
or the results that they're looking<font color="#E5E5E5"> for</font>

123
00:04:00,280 --> 00:04:03,549
because it's<font color="#E5E5E5"> been encoded and we'll talk</font>

124
00:04:01,510 --> 00:04:05,410
more about<font color="#E5E5E5"> that later and of course once</font>

125
00:04:03,549 --> 00:04:06,519
they kind of get that card data they

126
00:04:05,410 --> 00:04:07,780
have 2x will trade<font color="#E5E5E5"> it outside the</font>

127
00:04:06,519 --> 00:04:09,549
environment and there's two different

128
00:04:07,780 --> 00:04:11,590
types there's the manual exfiltration

129
00:04:09,549 --> 00:04:12,549
method<font color="#E5E5E5"> right where the there's a manual</font>

130
00:04:11,590 --> 00:04:14,169
intrusion in the<font color="#CCCCCC"> environment the</font>

131
00:04:12,549 --> 00:04:15,819
<font color="#E5E5E5">attacker will collect those output files</font>

132
00:04:14,169 --> 00:04:17,019
that were stored by the malware and then

133
00:04:15,819 --> 00:04:18,728
bring them to a central machine and send

134
00:04:17,019 --> 00:04:20,380
it out you also have the other type of

135
00:04:18,728 --> 00:04:21,849
points<font color="#E5E5E5"> on our that will actually once it</font>

136
00:04:20,380 --> 00:04:23,590
encodes it on the system<font color="#E5E5E5"> it'll send it</font>

137
00:04:21,849 --> 00:04:24,729
outside<font color="#E5E5E5"> that specific system</font>

138
00:04:23,590 --> 00:04:29,469
sends a lot on the environment that

139
00:04:24,730 --> 00:04:31,480
you're investigating so before we<font color="#E5E5E5"> kind</font>

140
00:04:29,470 --> 00:04:33,850
of get into<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the investigative</font>

141
00:04:31,480 --> 00:04:36,250
techniques just to talk about some<font color="#E5E5E5"> of</font>

142
00:04:33,850 --> 00:04:37,690
the way that the chains are set up these

143
00:04:36,250 --> 00:04:38,949
are rudimentary designs these aren't

144
00:04:37,690 --> 00:04:40,479
exactly what<font color="#CCCCCC"> they look like so please</font>

145
00:04:38,949 --> 00:04:42,699
forgive<font color="#E5E5E5"> me or just the best that I can</font>

146
00:04:40,479 --> 00:04:44,620
make up<font color="#E5E5E5"> without spending a lot of hours</font>

147
00:04:42,699 --> 00:04:45,940
on it so this<font color="#CCCCCC"> is the basic retail</font>

148
00:04:44,620 --> 00:04:47,380
network right so we have<font color="#E5E5E5"> the different</font>

149
00:04:45,940 --> 00:04:48,669
stores in those different stores you

150
00:04:47,380 --> 00:04:51,100
have your point-of-sale terminals right

151
00:04:48,669 --> 00:04:53,440
again you go to the cash register expect

152
00:04:51,100 --> 00:04:54,610
your<font color="#E5E5E5"> cards right</font><font color="#CCCCCC"> kohl's walmart sure</font>

153
00:04:53,440 --> 00:04:57,160
this is kind<font color="#E5E5E5"> of how it's setup right</font>

154
00:04:54,610 --> 00:04:59,590
here when that data gets processed it

155
00:04:57,160 --> 00:05:00,940
gets sent over to the way in or to a

156
00:04:59,590 --> 00:05:02,679
central location where then gets

157
00:05:00,940 --> 00:05:04,240
processed and sent out to sometimes

158
00:05:02,680 --> 00:05:06,820
headquarters or sometimes to the

159
00:05:04,240 --> 00:05:08,860
<font color="#E5E5E5">merchant or the processor right so the</font>

160
00:05:06,820 --> 00:05:10,900
processes are like first data<font color="#E5E5E5"> elavon</font>

161
00:05:08,860 --> 00:05:12,100
there's a company's actually process the

162
00:05:10,900 --> 00:05:15,849
card information in themselves before

163
00:05:12,100 --> 00:05:17,800
<font color="#CCCCCC">sense further along the lines this is</font>

164
00:05:15,850 --> 00:05:20,169
something<font color="#CCCCCC"> that you would see at a like a</font>

165
00:05:17,800 --> 00:05:22,030
mom and pop shop something awful like

166
00:05:20,169 --> 00:05:24,490
subway right some of<font color="#CCCCCC"> the smaller stores</font>

167
00:05:22,030 --> 00:05:25,960
so<font color="#E5E5E5"> I keep working front yeah you'd</font>

168
00:05:24,490 --> 00:05:28,720
probably see a<font color="#E5E5E5"> couple of computers in</font>

169
00:05:25,960 --> 00:05:30,130
<font color="#CCCCCC">the back of the house server and then</font>

170
00:05:28,720 --> 00:05:31,570
the modem that<font color="#E5E5E5"> sends the data out to the</font>

171
00:05:30,130 --> 00:05:34,150
<font color="#CCCCCC">Internet this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> also very</font><font color="#E5E5E5"> common in</font>

172
00:05:31,570 --> 00:05:35,919
your hotel chains right that are there

173
00:05:34,150 --> 00:05:38,799
more like franchises like<font color="#CCCCCC"> Hanson in</font>

174
00:05:35,919 --> 00:05:40,719
quality and things of that nature right

175
00:05:38,800 --> 00:05:42,280
they have like two front desk computers

176
00:05:40,720 --> 00:05:43,450
they have a manager<font color="#CCCCCC"> of PC and they have</font>

177
00:05:42,280 --> 00:05:45,638
a back of a house server where all the

178
00:05:43,450 --> 00:05:47,650
cards get sent to sometimes in bulk and

179
00:05:45,639 --> 00:05:51,729
it sent out to the<font color="#CCCCCC"> Internet we'll</font><font color="#E5E5E5"> just</font>

180
00:05:47,650 --> 00:05:53,830
call it the<font color="#E5E5E5"> internet renown right so</font>

181
00:05:51,729 --> 00:05:56,440
when we deal with the point of sale

182
00:05:53,830 --> 00:05:58,270
investigation right sometimes what

183
00:05:56,440 --> 00:06:00,250
happens is the<font color="#CCCCCC"> card brands will force</font>

184
00:05:58,270 --> 00:06:01,479
merchants to do it or retell it should

185
00:06:00,250 --> 00:06:02,349
do<font color="#E5E5E5"> it</font><font color="#CCCCCC"> right it's called a PFI</font>

186
00:06:01,479 --> 00:06:05,469
investigation or a professional

187
00:06:02,349 --> 00:06:07,030
<font color="#CCCCCC">forensics investigation I don't want to</font>

188
00:06:05,470 --> 00:06:09,220
<font color="#CCCCCC">argue about</font><font color="#E5E5E5"> it talk about</font><font color="#CCCCCC"> it later so</font>

189
00:06:07,030 --> 00:06:11,049
what happens when you're a merchant or

190
00:06:09,220 --> 00:06:13,150
<font color="#E5E5E5">retail you and say hey I want to process</font>

191
00:06:11,050 --> 00:06:14,560
visa I want to process<font color="#CCCCCC"> MasterCard right</font>

192
00:06:13,150 --> 00:06:16,060
they sign a contract with those card

193
00:06:14,560 --> 00:06:18,430
brands that basically says if they get

194
00:06:16,060 --> 00:06:20,919
breached or this evidence<font color="#E5E5E5"> of fraud that</font>

195
00:06:18,430 --> 00:06:23,020
warrants an investigation that<font color="#CCCCCC"> retailer</font>

196
00:06:20,919 --> 00:06:24,039
has to pay<font color="#CCCCCC"> for it right so then that's</font>

197
00:06:23,020 --> 00:06:26,859
what we'll do the actual investigation

198
00:06:24,039 --> 00:06:28,630
itself and so what we ask for is what we

199
00:06:26,860 --> 00:06:30,970
call a<font color="#E5E5E5"> CPP who are a common point of</font>

200
00:06:28,630 --> 00:06:32,830
purchase right so the card brands like

201
00:06:30,970 --> 00:06:34,360
Visa discovered on them will have their

202
00:06:32,830 --> 00:06:36,128
fraud teams and basically say look the

203
00:06:34,360 --> 00:06:38,020
last place these cards were used

204
00:06:36,129 --> 00:06:40,239
before fraud was reported was at<font color="#E5E5E5"> your</font>

205
00:06:38,020 --> 00:06:41,469
location so there's some compromise at

206
00:06:40,239 --> 00:06:43,270
your location or something happening

207
00:06:41,469 --> 00:06:46,659
there that we think is the cause of this

208
00:06:43,270 --> 00:06:50,049
so that's<font color="#E5E5E5"> the CPP the tbp also provides</font>

209
00:06:46,659 --> 00:06:52,808
dates the dates are pretty<font color="#CCCCCC"> easy right</font>

210
00:06:50,050 --> 00:06:54,249
we've<font color="#CCCCCC"> worked you lots of cases where</font>

211
00:06:52,809 --> 00:06:55,629
it's happened in November would come out

212
00:06:54,249 --> 00:06:57,999
to didn't compromise for two years right

213
00:06:55,629 --> 00:07:00,519
so timeline is very<font color="#CCCCCC"> difficult when we</font>

214
00:06:57,999 --> 00:07:01,929
get CPP's because you know my my my

215
00:07:00,519 --> 00:07:03,129
experience is<font color="#CCCCCC"> fifty-fifty they might be</font>

216
00:07:01,929 --> 00:07:04,869
right what's the time they're completely

217
00:07:03,129 --> 00:07:06,459
wrong<font color="#E5E5E5"> they just</font><font color="#CCCCCC"> been compromised for</font><font color="#E5E5E5"> a</font>

218
00:07:04,869 --> 00:07:09,909
long time<font color="#E5E5E5"> it took a fraud department a</font>

219
00:07:06,459 --> 00:07:11,769
pretty long time<font color="#CCCCCC"> to figure it</font><font color="#E5E5E5"> out um so</font>

220
00:07:09,909 --> 00:07:13,779
again time is ticking when we go<font color="#CCCCCC"> on site</font>

221
00:07:11,769 --> 00:07:15,939
or you ask for stuff in them you<font color="#E5E5E5"> want</font>

222
00:07:13,779 --> 00:07:17,050
and forensic images logs right we're not

223
00:07:15,939 --> 00:07:18,399
<font color="#E5E5E5">gonna get into all the things that</font>

224
00:07:17,050 --> 00:07:22,360
<font color="#CCCCCC">you're going</font><font color="#E5E5E5"> to ask for them but there's</font>

225
00:07:18,399 --> 00:07:25,899
some that<font color="#E5E5E5"> the basic ones one thing I'll</font>

226
00:07:22,360 --> 00:07:27,099
mention as you get into this is you know

227
00:07:25,899 --> 00:07:28,839
we<font color="#CCCCCC"> ask a lot</font><font color="#E5E5E5"> questions about how the</font>

228
00:07:27,099 --> 00:07:30,159
network<font color="#E5E5E5"> is set up right as you should if</font>

229
00:07:28,839 --> 00:07:32,110
you're investigating you know what kind

230
00:07:30,159 --> 00:07:33,459
<font color="#CCCCCC">of firewall logs you have how</font><font color="#E5E5E5"> is their</font>

231
00:07:32,110 --> 00:07:36,099
network segmentation things that nature

232
00:07:33,459 --> 00:07:38,439
take that with a grain of salt a lot<font color="#CCCCCC"> of</font>

233
00:07:36,099 --> 00:07:40,300
times it's wrong right<font color="#E5E5E5"> it's it's you</font>

234
00:07:38,439 --> 00:07:41,949
know can you get from A to B no well

235
00:07:40,300 --> 00:07:43,599
yeah the attacker did it but<font color="#CCCCCC"> you got for</font>

236
00:07:41,949 --> 00:07:45,849
made to be right so when<font color="#E5E5E5"> someone says</font>

237
00:07:43,599 --> 00:07:47,558
hey that's not possible it's<font color="#E5E5E5"> probably</font>

238
00:07:45,849 --> 00:07:48,699
possible they just haven't you<font color="#CCCCCC"> know we</font>

239
00:07:47,559 --> 00:07:52,749
haven't<font color="#CCCCCC"> figured it out yet we're someone</font>

240
00:07:48,699 --> 00:07:53,949
else figured it out for<font color="#E5E5E5"> us so we</font><font color="#CCCCCC"> can</font>

241
00:07:52,749 --> 00:07:56,050
when we get some of those new folks

242
00:07:53,949 --> 00:07:59,769
<font color="#E5E5E5">enemies and you kind of train the to get</font>

243
00:07:56,050 --> 00:08:02,199
them up to speed my goal is to<font color="#CCCCCC"> its we</font>

244
00:07:59,769 --> 00:08:03,550
give<font color="#E5E5E5"> you a forensic images and there's a</font>

245
00:08:02,199 --> 00:08:04,990
pretty<font color="#E5E5E5"> good indicator that they've</font><font color="#CCCCCC"> been</font>

246
00:08:03,550 --> 00:08:07,089
compromised or some sort of point some

247
00:08:04,990 --> 00:08:09,399
hours on<font color="#E5E5E5"> there find it within a couple</font>

248
00:08:07,089 --> 00:08:11,050
of hours right it takes you longer than

249
00:08:09,399 --> 00:08:12,639
a day to find it then there might not be

250
00:08:11,050 --> 00:08:14,289
anything there or we're just<font color="#E5E5E5"> not looking</font>

251
00:08:12,639 --> 00:08:15,909
in the right place so<font color="#CCCCCC"> it's kind of like</font>

252
00:08:14,289 --> 00:08:17,919
the goal of the investigation so this is

253
00:08:15,909 --> 00:08:20,409
sort of a very small investigation plan

254
00:08:17,919 --> 00:08:21,758
on what you're going to<font color="#E5E5E5"> be doing so of</font>

255
00:08:20,409 --> 00:08:23,740
<font color="#E5E5E5">course you have your pre processing your</font>

256
00:08:21,759 --> 00:08:25,269
time lining your artifact extraction

257
00:08:23,740 --> 00:08:29,229
parson keyword searching and<font color="#E5E5E5"> you are</font>

258
00:08:25,269 --> 00:08:31,509
rules in with familiar with Yara now

259
00:08:29,229 --> 00:08:34,389
yours the big one all right so<font color="#CCCCCC"> your is</font>

260
00:08:31,509 --> 00:08:36,159
basically rules that you can create to

261
00:08:34,389 --> 00:08:39,250
scan files on a system<font color="#E5E5E5"> that match</font>

262
00:08:36,159 --> 00:08:40,899
certain patterns so if<font color="#E5E5E5"> I know there's a</font>

263
00:08:39,250 --> 00:08:43,179
point seven hour out there<font color="#E5E5E5"> and it has</font>

264
00:08:40,899 --> 00:08:45,220
the specific data inside of it I can

265
00:08:43,179 --> 00:08:47,258
<font color="#E5E5E5">create rules to go scan other systems</font>

266
00:08:45,220 --> 00:08:49,180
looking for it<font color="#CCCCCC"> right kind</font><font color="#E5E5E5"> of make sense</font>

267
00:08:47,259 --> 00:08:50,860
all I know if<font color="#E5E5E5"> the marrow always says</font>

268
00:08:49,180 --> 00:08:52,060
we're in the file right I can use the

269
00:08:50,860 --> 00:08:53,680
yard<font color="#E5E5E5"> rule to go scan everything on the</font>

270
00:08:52,060 --> 00:08:56,170
system<font color="#CCCCCC"> that has yarra within that file</font>

271
00:08:53,680 --> 00:08:58,300
it's mostly beneficial for looking at

272
00:08:56,170 --> 00:08:59,920
gol e exceeds right binaries and things

273
00:08:58,300 --> 00:09:02,349
of that nature not so much for documents

274
00:08:59,920 --> 00:09:04,839
or PDF<font color="#E5E5E5"> I personally like to use the tool</font>

275
00:09:02,350 --> 00:09:06,310
<font color="#CCCCCC">low key it's free you can just go</font>

276
00:09:04,839 --> 00:09:08,080
download it<font color="#E5E5E5"> you can use your rules with</font>

277
00:09:06,310 --> 00:09:09,760
it you can<font color="#CCCCCC"> also use</font><font color="#E5E5E5"> indicators or</font>

278
00:09:08,080 --> 00:09:11,230
compromise rules as well so<font color="#CCCCCC"> it's pretty</font>

279
00:09:09,760 --> 00:09:13,180
<font color="#E5E5E5">nice and you can run that against images</font>

280
00:09:11,230 --> 00:09:18,550
directories files things of that nature

281
00:09:13,180 --> 00:09:20,979
so right now we're going<font color="#E5E5E5"> to try to jump</font>

282
00:09:18,550 --> 00:09:24,099
into what I call it's really sniper

283
00:09:20,980 --> 00:09:25,420
forensics if you will again the timeline

284
00:09:24,100 --> 00:09:28,149
we have folks that kind<font color="#E5E5E5"> of argue this</font>

285
00:09:25,420 --> 00:09:29,649
back and forth is look at<font color="#E5E5E5"> the system</font>

286
00:09:28,149 --> 00:09:31,270
<font color="#E5E5E5">from a timeline perspective but if you</font>

287
00:09:29,649 --> 00:09:32,800
don't know the timeline right well what

288
00:09:31,270 --> 00:09:34,120
am I going to look at right now am I

289
00:09:32,800 --> 00:09:35,800
going<font color="#E5E5E5"> to find badness on a computer</font>

290
00:09:34,120 --> 00:09:37,149
right and so that's<font color="#E5E5E5"> what we call sniper</font>

291
00:09:35,800 --> 00:09:40,000
forensics we can look at certain

292
00:09:37,149 --> 00:09:42,880
artifacts<font color="#E5E5E5"> to find badness it's sort of</font>

293
00:09:40,000 --> 00:09:43,839
<font color="#E5E5E5">like the eighty percent of your findings</font>

294
00:09:42,880 --> 00:09:46,000
are from like twenty percent of the

295
00:09:43,839 --> 00:09:47,200
files or something like that<font color="#E5E5E5"> so it's</font>

296
00:09:46,000 --> 00:09:48,339
kind of how I<font color="#CCCCCC"> put it out</font><font color="#E5E5E5"> there so one of</font>

297
00:09:47,200 --> 00:09:50,380
the first thing that<font color="#CCCCCC"> I like to look at</font>

298
00:09:48,339 --> 00:09:51,730
is program execution there's a lot<font color="#CCCCCC"> of</font>

299
00:09:50,380 --> 00:09:53,800
<font color="#CCCCCC">different artifacts for program</font>

300
00:09:51,730 --> 00:09:55,540
execution and it's also very dependent

301
00:09:53,800 --> 00:09:57,880
<font color="#CCCCCC">on in the operating system itself</font><font color="#E5E5E5"> right</font>

302
00:09:55,540 --> 00:10:00,339
windows XP has less evidence than

303
00:09:57,880 --> 00:10:02,110
Windows 10 does right Microsoft doesn't

304
00:10:00,339 --> 00:10:03,310
do it that way they actually<font color="#CCCCCC"> have more</font>

305
00:10:02,110 --> 00:10:05,860
<font color="#CCCCCC">evident someone to tend because of the</font>

306
00:10:03,310 --> 00:10:07,000
user<font color="#E5E5E5"> experience</font><font color="#CCCCCC"> that the designs and as</font>

307
00:10:05,860 --> 00:10:09,279
it progressed throughout the operating

308
00:10:07,000 --> 00:10:12,220
<font color="#E5E5E5">system so here's just a couple this</font>

309
00:10:09,279 --> 00:10:14,050
isn't just a list if<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> prefetched</font>

310
00:10:12,220 --> 00:10:16,089
your user<font color="#E5E5E5"> it's just your application</font>

311
00:10:14,050 --> 00:10:19,300
compatibility cash<font color="#E5E5E5"> also known as the</font>

312
00:10:16,089 --> 00:10:21,250
<font color="#E5E5E5">shim cash and the recent file cache the</font>

313
00:10:19,300 --> 00:10:23,260
am cash event logs and there's a lot

314
00:10:21,250 --> 00:10:25,000
more did anyone think of any other

315
00:10:23,260 --> 00:10:32,279
places to look on a Windows system for

316
00:10:25,000 --> 00:10:32,279
program execution you in the blue shirt

317
00:10:33,830 --> 00:10:40,370
yep good point so by default<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> and</font>

318
00:10:38,240 --> 00:10:41,630
not long process creation so you can

319
00:10:40,370 --> 00:10:43,520
enable that in the windows security

320
00:10:41,630 --> 00:10:45,439
event logs you can also enable

321
00:10:43,520 --> 00:10:46,699
<font color="#CCCCCC">command-line auditing as well which will</font>

322
00:10:45,440 --> 00:10:48,890
give you the full command path to the

323
00:10:46,700 --> 00:10:52,670
process again none of this is enabled by

324
00:10:48,890 --> 00:10:56,000
default a good point any other ideas how

325
00:10:52,670 --> 00:10:57,260
many people are students in<font color="#E5E5E5"> here ok how</font>

326
00:10:56,000 --> 00:10:59,990
many your people students<font color="#E5E5E5"> from</font>

327
00:10:57,260 --> 00:11:02,450
bloomsburg how many are<font color="#E5E5E5"> from</font><font color="#CCCCCC"> another</font>

328
00:10:59,990 --> 00:11:06,590
school how many like professionals are

329
00:11:02,450 --> 00:11:08,660
in here so like your job<font color="#E5E5E5"> is like</font>

330
00:11:06,590 --> 00:11:12,740
insulting or like forensics instant

331
00:11:08,660 --> 00:11:14,060
response now our analysis<font color="#CCCCCC"> no so what do</font>

332
00:11:12,740 --> 00:11:20,360
you guys do like what's your justing

333
00:11:14,060 --> 00:11:21,439
your ideas<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> alright so the reason i</font>

334
00:11:20,360 --> 00:11:22,700
ask that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> you know I want to make this</font>

335
00:11:21,440 --> 00:11:24,260
casual if you have questions ask

336
00:11:22,700 --> 00:11:25,550
questions right I'm gonna<font color="#E5E5E5"> go through</font>

337
00:11:24,260 --> 00:11:26,780
some things<font color="#E5E5E5"> I might go there and go</font>

338
00:11:25,550 --> 00:11:28,160
through them pretty fast because I want

339
00:11:26,780 --> 00:11:29,420
to<font color="#E5E5E5"> get to the end of the day exercise</font>

340
00:11:28,160 --> 00:11:30,560
<font color="#E5E5E5">where you guys want you have to try to</font>

341
00:11:29,420 --> 00:11:33,380
figure<font color="#E5E5E5"> out the point of</font><font color="#CCCCCC"> sale breach</font>

342
00:11:30,560 --> 00:11:36,739
itself right remember i'm talking about

343
00:11:33,380 --> 00:11:38,090
this from a point of sale view but

344
00:11:36,740 --> 00:11:39,500
there's a price to any investigation

345
00:11:38,090 --> 00:11:41,360
that you<font color="#E5E5E5"> could do right and the goal is</font>

346
00:11:39,500 --> 00:11:47,330
<font color="#CCCCCC">to</font><font color="#E5E5E5"> find badness as quick as</font><font color="#CCCCCC"> possible yes</font>

347
00:11:41,360 --> 00:11:51,050
ma'am yeah so alternate data streams

348
00:11:47,330 --> 00:11:53,720
were originally designed windows XP for

349
00:11:51,050 --> 00:11:55,790
cooperation<font color="#CCCCCC"> i guess with HFS file</font>

350
00:11:53,720 --> 00:11:58,940
systems or the mac file systems right so

351
00:11:55,790 --> 00:12:01,219
attackers like to use ADF ADF a lot

352
00:11:58,940 --> 00:12:04,370
because<font color="#E5E5E5"> windows XP natively couldn't see</font>

353
00:12:01,220 --> 00:12:05,780
them right so windows this<font color="#E5E5E5"> sign up they</font>

354
00:12:04,370 --> 00:12:07,880
got rid of<font color="#CCCCCC"> that and so you</font><font color="#E5E5E5"> can actually</font>

355
00:12:05,780 --> 00:12:09,709
see alternate data streams now natively

356
00:12:07,880 --> 00:12:11,510
so if you ever go to your computer open

357
00:12:09,710 --> 00:12:13,610
a command prompt command prompt sorry

358
00:12:11,510 --> 00:12:15,740
<font color="#CCCCCC">type Durst base</font><font color="#E5E5E5"> flash are that i'll show</font>

359
00:12:13,610 --> 00:12:21,320
you alternate data streams right anyone

360
00:12:15,740 --> 00:12:23,630
knows that windows uses them for now yep

361
00:12:21,320 --> 00:12:26,330
geo-tracking to talk about<font color="#E5E5E5"> that for</font>

362
00:12:23,630 --> 00:12:28,100
people<font color="#E5E5E5"> that probably are so want them to</font>

363
00:12:26,330 --> 00:12:29,660
find more common if you download a word

364
00:12:28,100 --> 00:12:30,890
document from anyone ever<font color="#E5E5E5"> get that thing</font>

365
00:12:29,660 --> 00:12:33,110
that<font color="#E5E5E5"> says this originated from the</font>

366
00:12:30,890 --> 00:12:36,230
internet you<font color="#CCCCCC"> know how windows knows that</font>

367
00:12:33,110 --> 00:12:37,370
from an alternate data stream there's an

368
00:12:36,230 --> 00:12:38,990
alternate data stream called a zone

369
00:12:37,370 --> 00:12:40,190
identifier and if it originates from the

370
00:12:38,990 --> 00:12:41,870
internet it's actually<font color="#E5E5E5"> a</font><font color="#CCCCCC"> number three</font>

371
00:12:40,190 --> 00:12:43,250
with in<font color="#E5E5E5"> that file and that's when you</font>

372
00:12:41,870 --> 00:12:44,630
<font color="#E5E5E5">get that prompt that says are you sure</font>

373
00:12:43,250 --> 00:12:45,180
you<font color="#E5E5E5"> want open this originated from the</font>

374
00:12:44,630 --> 00:12:46,200
internet

375
00:12:45,180 --> 00:12:47,670
actually comes from an alternate data

376
00:12:46,200 --> 00:12:51,930
stream but thanks for<font color="#CCCCCC"> bringing that up</font>

377
00:12:47,670 --> 00:12:53,160
anything else there's another one<font color="#CCCCCC"> that</font>

378
00:12:51,930 --> 00:12:55,949
will get to that probably people aren't

379
00:12:53,160 --> 00:12:58,050
<font color="#E5E5E5">really familiar with so one of the best</font>

380
00:12:55,950 --> 00:12:59,850
ones that<font color="#E5E5E5"> I recommend to look at when</font><font color="#CCCCCC"> i</font>

381
00:12:58,050 --> 00:13:01,829
first started<font color="#CCCCCC"> at the shin cash right</font>

382
00:12:59,850 --> 00:13:04,110
it's a registry entry it contains a lot

383
00:13:01,830 --> 00:13:06,330
of different<font color="#CCCCCC"> data in it but what are we</font>

384
00:13:04,110 --> 00:13:09,330
<font color="#E5E5E5">looking for you know what is bad in here</font>

385
00:13:06,330 --> 00:13:11,340
I've had somewhere there's<font color="#E5E5E5"> 800 lines a</font>

386
00:13:09,330 --> 00:13:12,900
thousand one hundred sometimes I had it

387
00:13:11,340 --> 00:13:15,330
was not even there which<font color="#E5E5E5"> is incredibly</font>

388
00:13:12,900 --> 00:13:17,310
unfortunate but that's<font color="#E5E5E5"> okay so just kind</font>

389
00:13:15,330 --> 00:13:19,530
of you know ideas of what to look for is

390
00:13:17,310 --> 00:13:21,270
file names that don't belong or in the

391
00:13:19,530 --> 00:13:26,939
wrong directory right where does svchost

392
00:13:21,270 --> 00:13:29,699
belong anyone care to guess no do you 10

393
00:13:26,940 --> 00:13:32,280
sec hostess<font color="#E5E5E5"> server service what's it</font>

394
00:13:29,700 --> 00:13:33,930
responsible for funds of things right<font color="#E5E5E5"> so</font>

395
00:13:32,280 --> 00:13:35,400
<font color="#E5E5E5">as you see how this is responsible for</font>

396
00:13:33,930 --> 00:13:37,079
tons<font color="#E5E5E5"> of things it's mainly responsible</font>

397
00:13:35,400 --> 00:13:39,150
for running services like printer

398
00:13:37,080 --> 00:13:40,410
spooler a couple of background jobs like

399
00:13:39,150 --> 00:13:42,420
bits and a couple of other<font color="#CCCCCC"> things as</font>

400
00:13:40,410 --> 00:13:44,430
well right so that belongs in system32

401
00:13:42,420 --> 00:13:47,069
we don't see it in there like someone's

402
00:13:44,430 --> 00:13:48,209
user profile that might be odd right

403
00:13:47,070 --> 00:13:51,450
that's something that we'd want<font color="#CCCCCC"> to look</font>

404
00:13:48,210 --> 00:13:53,220
<font color="#E5E5E5">into some also executables within like</font>

405
00:13:51,450 --> 00:13:56,070
the program data folder right which is

406
00:13:53,220 --> 00:13:58,320
<font color="#CCCCCC">windows this</font><font color="#E5E5E5"> then up also things that</font>

407
00:13:56,070 --> 00:14:00,840
are like random eight characters 10

408
00:13:58,320 --> 00:14:04,740
characters three characters one exe

409
00:14:00,840 --> 00:14:05,460
that's weird right sometimes the

410
00:14:04,740 --> 00:14:06,780
attacker is a little bit more

411
00:14:05,460 --> 00:14:09,030
<font color="#CCCCCC">sophisticated for this we're going</font><font color="#E5E5E5"> to</font>

412
00:14:06,780 --> 00:14:10,439
kind<font color="#E5E5E5"> of keep it low level but they will</font>

413
00:14:09,030 --> 00:14:11,910
<font color="#CCCCCC">actually go in and mimic other</font>

414
00:14:10,440 --> 00:14:13,110
executable in the environment just<font color="#E5E5E5"> move</font>

415
00:14:11,910 --> 00:14:14,939
it into a different directory so

416
00:14:13,110 --> 00:14:16,800
something to keep them to an account so

417
00:14:14,940 --> 00:14:18,840
what<font color="#E5E5E5"> I</font><font color="#CCCCCC"> did here is actually created a</font>

418
00:14:16,800 --> 00:14:21,569
list from an actual<font color="#CCCCCC"> point of sale breach</font>

419
00:14:18,840 --> 00:14:23,610
and I<font color="#CCCCCC"> shrunk it a lot to make it a</font>

420
00:14:21,570 --> 00:14:24,990
little bit easier<font color="#E5E5E5"> so I know we all</font><font color="#CCCCCC"> have</font>

421
00:14:23,610 --> 00:14:26,250
<font color="#E5E5E5">different experiences in the room but</font>

422
00:14:24,990 --> 00:14:29,250
<font color="#E5E5E5">assume that wants to you know give a</font>

423
00:14:26,250 --> 00:14:31,650
guess at how many bad executables are in

424
00:14:29,250 --> 00:14:34,670
here or like which ones bad<font color="#CCCCCC"> I guess if</font>

425
00:14:31,650 --> 00:14:34,670
you can see<font color="#CCCCCC"> it yeah</font>

426
00:14:34,710 --> 00:14:48,570
shoutouts talking about her there's no

427
00:14:37,800 --> 00:14:52,579
wrong answers good<font color="#E5E5E5"> I hope</font><font color="#CCCCCC"> lies as we</font>

428
00:14:48,570 --> 00:14:56,389
were<font color="#E5E5E5"> and until that bad and</font>

429
00:14:52,579 --> 00:14:58,459
so actually 464 it's all not bad right

430
00:14:56,389 --> 00:15:00,470
so those are pretty odd I don't know

431
00:14:58,459 --> 00:15:02,420
what they<font color="#CCCCCC"> are hash Sugar's fine it's all</font>

432
00:15:00,470 --> 00:15:09,410
<font color="#E5E5E5">that's a good find but why did you pick</font>

433
00:15:02,420 --> 00:15:22,248
install about that because first of all

434
00:15:09,410 --> 00:15:27,709
<font color="#CCCCCC">insult us that I don't remember water or</font>

435
00:15:22,249 --> 00:15:34,040
Windows Azure yeah very possible that's

436
00:15:27,709 --> 00:15:35,540
good well yeah so that's<font color="#CCCCCC"> actually going</font>

437
00:15:34,040 --> 00:15:49,819
back to like<font color="#E5E5E5"> Windows off so true so good</font>

438
00:15:35,540 --> 00:15:51,079
answer you in the back so so it's<font color="#E5E5E5"> not</font>

439
00:15:49,819 --> 00:15:52,639
but<font color="#E5E5E5"> I also have to do with the</font><font color="#CCCCCC"> parsha</font>

440
00:15:51,079 --> 00:15:54,109
<font color="#E5E5E5">that's being used right but that would</font>

441
00:15:52,639 --> 00:15:57,439
be something that might throw you off

442
00:15:54,110 --> 00:15:59,239
but we'll<font color="#E5E5E5"> take that case sensitivity</font>

443
00:15:57,439 --> 00:16:00,410
doesn't really matter<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> parchers</font>

444
00:15:59,239 --> 00:16:01,999
kind of change that based on like

445
00:16:00,410 --> 00:16:05,389
unicode after your visitation a couple

446
00:16:01,999 --> 00:16:06,829
other things like you had the same thing

447
00:16:05,389 --> 00:16:08,149
does anyone else have like any other

448
00:16:06,829 --> 00:16:10,388
patterns that they might see they think

449
00:16:08,149 --> 00:16:10,389
are odd

450
00:16:24,110 --> 00:16:29,209
yep so that's good good answer so the d

451
00:16:27,620 --> 00:16:30,290
drive is perfectly<font color="#CCCCCC"> fine here it's</font>

452
00:16:29,209 --> 00:16:31,910
actually<font color="#CCCCCC"> like the</font><font color="#E5E5E5"> data drive for this</font>

453
00:16:30,290 --> 00:16:33,140
<font color="#E5E5E5">particular system right but that would</font>

454
00:16:31,910 --> 00:16:35,719
be something<font color="#E5E5E5"> that you'd want</font><font color="#CCCCCC"> to look at</font>

455
00:16:33,140 --> 00:16:45,470
anyone notice anything<font color="#CCCCCC"> else that's weird</font>

456
00:16:35,720 --> 00:16:47,510
yes<font color="#E5E5E5"> exactly so what PS exact right so PS</font>

457
00:16:45,470 --> 00:16:48,890
<font color="#E5E5E5">exec is a Windows sysinternals tool that</font>

458
00:16:47,510 --> 00:16:50,540
allows you<font color="#CCCCCC"> to basically connect other</font>

459
00:16:48,890 --> 00:16:52,189
machines and run processes allows you to

460
00:16:50,540 --> 00:16:54,589
do a lot<font color="#CCCCCC"> more right so that's a bit odd</font>

461
00:16:52,190 --> 00:16:56,180
it's not that odd because system

462
00:16:54,589 --> 00:16:58,370
administrators use it so it's<font color="#E5E5E5"> hard to</font>

463
00:16:56,180 --> 00:17:00,349
<font color="#E5E5E5">say is that really like a bad threat</font>

464
00:16:58,370 --> 00:17:06,230
actor or is that the IT administrator is

465
00:17:00,350 --> 00:17:09,199
doing<font color="#E5E5E5"> something to</font><font color="#CCCCCC"> the system well once</font>

466
00:17:06,230 --> 00:17:10,520
you sir so there's also another strange

467
00:17:09,199 --> 00:17:12,110
pattern here that's kind of hard to pick

468
00:17:10,520 --> 00:17:14,000
out but there's four<font color="#E5E5E5"> files here they all</font>

469
00:17:12,109 --> 00:17:16,399
have the same exact date so let<font color="#CCCCCC"> me talk</font>

470
00:17:14,000 --> 00:17:18,380
<font color="#CCCCCC">to you about</font><font color="#E5E5E5"> the state so in the shim</font>

471
00:17:16,400 --> 00:17:20,569
cash there's a date entry associated

472
00:17:18,380 --> 00:17:23,720
with the executable<font color="#CCCCCC"> that</font><font color="#E5E5E5"> dates on</font>

473
00:17:20,569 --> 00:17:26,059
Windows Vista and<font color="#E5E5E5"> above is the modified</font>

474
00:17:23,720 --> 00:17:28,189
date of the file it's not the date that

475
00:17:26,059 --> 00:17:29,660
<font color="#CCCCCC">it executed alright that's very</font>

476
00:17:28,189 --> 00:17:31,280
important windows XP it is the date is

477
00:17:29,660 --> 00:17:33,110
executed right that's the only

478
00:17:31,280 --> 00:17:35,750
difference so you operating system plays

479
00:17:33,110 --> 00:17:37,760
a big part here so these stand out

480
00:17:35,750 --> 00:17:40,220
because they're all the same exact date

481
00:17:37,760 --> 00:17:42,169
that's a little<font color="#CCCCCC"> bit odd to</font><font color="#E5E5E5"> me like why</font>

482
00:17:40,220 --> 00:17:43,520
are they all the same exact date right

483
00:17:42,169 --> 00:17:47,960
anyone care to guess what could be going

484
00:17:43,520 --> 00:17:49,879
on it<font color="#E5E5E5"> could have all been put there at</font>

485
00:17:47,960 --> 00:17:51,500
the<font color="#E5E5E5"> same time the computer wasn't</font>

486
00:17:49,880 --> 00:17:57,669
created in 2003 I'll tell<font color="#E5E5E5"> you that</font>

487
00:17:51,500 --> 00:17:57,669
that's<font color="#CCCCCC"> a good</font><font color="#E5E5E5"> point though Oh over there</font>

488
00:17:58,550 --> 00:18:05,840
they were that's<font color="#E5E5E5"> possible it's possible</font>

489
00:18:03,710 --> 00:18:07,610
<font color="#E5E5E5">in this case that's not true but there</font>

490
00:18:05,840 --> 00:18:13,790
are cases where that could be and then I

491
00:18:07,610 --> 00:18:16,610
think they'll know so all that Bob

492
00:18:13,790 --> 00:18:17,629
methylation show the so i skipped over

493
00:18:16,610 --> 00:18:18,770
<font color="#CCCCCC">the skin</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> i'm trying to</font><font color="#E5E5E5"> get to</font>

494
00:18:17,630 --> 00:18:21,320
<font color="#CCCCCC">the exercise</font><font color="#E5E5E5"> because i was run a little</font>

495
00:18:18,770 --> 00:18:23,930
bit behind these are based in a registry

496
00:18:21,320 --> 00:18:25,580
entries that could be modified<font color="#E5E5E5"> it's</font>

497
00:18:23,930 --> 00:18:28,070
unlikely<font color="#CCCCCC"> but</font><font color="#E5E5E5"> that is a possibility so</font>

498
00:18:25,580 --> 00:18:29,330
what's really happening here based on

499
00:18:28,070 --> 00:18:31,700
you know some of my experience is that

500
00:18:29,330 --> 00:18:35,179
the attacker actually<font color="#CCCCCC"> times</font><font color="#E5E5E5"> stomped the</font>

501
00:18:31,700 --> 00:18:36,680
files right so I'm when<font color="#E5E5E5"> I go through</font>

502
00:18:35,180 --> 00:18:38,630
some<font color="#CCCCCC"> of the shim cash articles and I</font>

503
00:18:36,680 --> 00:18:39,890
look for patterns that might stand out

504
00:18:38,630 --> 00:18:41,990
to me this is a pattern that I look for

505
00:18:39,890 --> 00:18:43,610
<font color="#CCCCCC">is files with a lot of the same modified</font>

506
00:18:41,990 --> 00:18:46,790
timestamps it's<font color="#E5E5E5"> not something that</font>

507
00:18:43,610 --> 00:18:48,320
<font color="#E5E5E5">happens very very often right so that's</font>

508
00:18:46,790 --> 00:18:50,990
something that I look for<font color="#CCCCCC"> so here I</font>

509
00:18:48,320 --> 00:18:53,510
found four files that have the same

510
00:18:50,990 --> 00:18:54,950
modified date from 2003 in<font color="#E5E5E5"> this</font>

511
00:18:53,510 --> 00:18:55,970
particular<font color="#E5E5E5"> case when I was looking at</font>

512
00:18:54,950 --> 00:18:58,880
the forensic image they didn't even

513
00:18:55,970 --> 00:19:00,530
<font color="#E5E5E5">exist that's also another red flag why</font>

514
00:18:58,880 --> 00:19:02,720
do they exist at one point now they

515
00:19:00,530 --> 00:19:05,510
<font color="#E5E5E5">don't exist great ingest emission</font>

516
00:19:02,720 --> 00:19:08,750
installed our bat lots of<font color="#E5E5E5"> it on why is</font>

517
00:19:05,510 --> 00:19:09,740
it in system32 right most of some admins

518
00:19:08,750 --> 00:19:11,780
<font color="#E5E5E5">are going to create batch scripts and</font>

519
00:19:09,740 --> 00:19:13,340
put them in system32 in my experience

520
00:19:11,780 --> 00:19:16,460
against there's any system admins in

521
00:19:13,340 --> 00:19:19,070
here I'm free to debate after I'm sure

522
00:19:16,460 --> 00:19:20,960
we have so there's also other ways to

523
00:19:19,070 --> 00:19:23,899
sort of find baddest with the shrimp

524
00:19:20,960 --> 00:19:25,580
cash so i<font color="#E5E5E5"> always recommend you'll keep</font>

525
00:19:23,900 --> 00:19:27,200
that intelligence with you document

526
00:19:25,580 --> 00:19:28,879
these things keep a repository the shim

527
00:19:27,200 --> 00:19:31,220
cash so one of the things<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> up</font>

528
00:19:28,880 --> 00:19:32,450
doing<font color="#CCCCCC"> is we collected a lot of</font><font color="#E5E5E5"> Shem</font>

529
00:19:31,220 --> 00:19:34,160
cache entries from a<font color="#E5E5E5"> couple of</font>

530
00:19:32,450 --> 00:19:35,450
<font color="#E5E5E5">investigations so</font><font color="#CCCCCC"> I took all of the shim</font>

531
00:19:34,160 --> 00:19:38,510
cache entries right which was about

532
00:19:35,450 --> 00:19:39,980
53,000 and I stilted them down to see

533
00:19:38,510 --> 00:19:42,770
what i would find odd in windows

534
00:19:39,980 --> 00:19:44,900
system32<font color="#CCCCCC"> system32</font><font color="#E5E5E5"> is relatively static</font>

535
00:19:42,770 --> 00:19:47,210
right it should be the<font color="#CCCCCC"> same throughout</font>

536
00:19:44,900 --> 00:19:48,980
most environments give or take right so

537
00:19:47,210 --> 00:19:51,770
if I can you know find something that

538
00:19:48,980 --> 00:19:54,140
doesn't fit 10,000 other systems maybe

539
00:19:51,770 --> 00:19:55,850
there's an odd irregularity here right

540
00:19:54,140 --> 00:19:58,040
so I did<font color="#CCCCCC"> that so I took my first</font>

541
00:19:55,850 --> 00:19:59,840
engagement and it brought it down to 580

542
00:19:58,040 --> 00:20:02,300
entries for me to review horn well

543
00:19:59,840 --> 00:20:04,490
that's still<font color="#E5E5E5"> a lot of to review right so</font>

544
00:20:02,300 --> 00:20:07,040
why don't I take this 580 entries and I

545
00:20:04,490 --> 00:20:08,930
compare them to the 300 entries I found

546
00:20:07,040 --> 00:20:10,610
<font color="#E5E5E5">for engagement one and filter them down</font>

547
00:20:08,930 --> 00:20:12,770
to the ones that were unknown

548
00:20:10,610 --> 00:20:14,030
that's what I<font color="#E5E5E5"> did right here so I just</font>

549
00:20:12,770 --> 00:20:16,730
compare the two and said tell<font color="#CCCCCC"> me the</font>

550
00:20:14,030 --> 00:20:18,590
ones that aren't in<font color="#E5E5E5"> this first list that</font>

551
00:20:16,730 --> 00:20:20,990
are<font color="#E5E5E5"> in the second list and so I got</font>

552
00:20:18,590 --> 00:20:23,270
these entries here each one<font color="#CCCCCC"> of these</font>

553
00:20:20,990 --> 00:20:25,220
entries are bad they're all related to

554
00:20:23,270 --> 00:20:29,210
raw POS which is a type of malware

555
00:20:25,220 --> 00:20:31,010
family right so I could have searched

556
00:20:29,210 --> 00:20:33,049
and looked<font color="#CCCCCC"> through the whole entire</font>

557
00:20:31,010 --> 00:20:34,280
stream cash to find something<font color="#E5E5E5"> odd but I</font>

558
00:20:33,049 --> 00:20:35,929
said I wanted<font color="#E5E5E5"> to try to see if I can</font><font color="#CCCCCC"> do</font>

559
00:20:34,280 --> 00:20:37,610
some sort of analytical exercise to find

560
00:20:35,929 --> 00:20:41,120
it a little bit faster so I did that

561
00:20:37,610 --> 00:20:43,280
here so i did a<font color="#E5E5E5"> second engagement</font><font color="#CCCCCC"> i did</font>

562
00:20:41,120 --> 00:20:44,479
the<font color="#E5E5E5"> same exact thing great for you know</font>

563
00:20:43,280 --> 00:20:47,570
<font color="#E5E5E5">this happened to come a couple months</font>

564
00:20:44,480 --> 00:20:50,120
later once<font color="#CCCCCC"> again</font><font color="#E5E5E5"> i found some badness</font>

565
00:20:47,570 --> 00:20:52,428
right things that didn't belong right so

566
00:20:50,120 --> 00:20:54,739
Brent calm and just to touch on this

567
00:20:52,429 --> 00:20:59,480
real quick we<font color="#CCCCCC"> said a PS exec let me go</font>

568
00:20:54,740 --> 00:21:01,640
<font color="#E5E5E5">back to this is important note so PS</font>

569
00:20:59,480 --> 00:21:03,080
execs there's a really<font color="#E5E5E5"> important part</font>

570
00:21:01,640 --> 00:21:04,580
<font color="#E5E5E5">about PS exact so remember how I</font>

571
00:21:03,080 --> 00:21:07,610
mentioned<font color="#E5E5E5"> that the timestamps are the</font>

572
00:21:04,580 --> 00:21:09,980
modified times right well PS exact is

573
00:21:07,610 --> 00:21:11,899
special so when PS exact you use the

574
00:21:09,980 --> 00:21:14,030
<font color="#CCCCCC">invicta remote into another computer or</font>

575
00:21:11,900 --> 00:21:18,860
destination system it will create<font color="#E5E5E5"> the PS</font>

576
00:21:14,030 --> 00:21:22,910
<font color="#CCCCCC">exact service which is PS exact sorry</font>

577
00:21:18,860 --> 00:21:24,649
<font color="#E5E5E5">what's up here PS exe SBC THC right that</font>

578
00:21:22,910 --> 00:21:26,419
actual time stamp is the time and

579
00:21:24,650 --> 00:21:28,340
actually ran on the<font color="#E5E5E5"> endpoint that's the</font>

580
00:21:26,419 --> 00:21:30,470
one<font color="#E5E5E5"> of the only cases where it happens</font>

581
00:21:28,340 --> 00:21:33,530
like that so you can<font color="#E5E5E5"> use that as part of</font>

582
00:21:30,470 --> 00:21:36,770
your timeline analysis so in frame

583
00:21:33,530 --> 00:21:38,330
<font color="#CCCCCC">package</font><font color="#E5E5E5"> I exe is actually</font><font color="#CCCCCC"> a custom</font>

584
00:21:36,770 --> 00:21:43,370
version of PS exact<font color="#E5E5E5"> that the threat</font>

585
00:21:38,330 --> 00:21:45,168
actors made alright so moving on the

586
00:21:43,370 --> 00:21:47,418
preset prefetch is probably most useless

587
00:21:45,169 --> 00:21:49,220
ones in my opinion but<font color="#CCCCCC"> it's something</font>

588
00:21:47,419 --> 00:21:50,990
that a lot of folks come in and start

589
00:21:49,220 --> 00:21:52,460
looking<font color="#E5E5E5"> at but there's actually</font><font color="#CCCCCC"> a lot</font>

590
00:21:50,990 --> 00:21:55,340
more efficient then<font color="#E5E5E5"> people will actually</font>

591
00:21:52,460 --> 00:21:56,870
look into<font color="#E5E5E5"> so normally you kind of get</font>

592
00:21:55,340 --> 00:21:58,309
this it tells you<font color="#CCCCCC"> the last time it was</font>

593
00:21:56,870 --> 00:22:00,590
ran the first<font color="#E5E5E5"> time it was raining and</font>

594
00:21:58,309 --> 00:22:02,330
how many<font color="#E5E5E5"> times it was ran but one thing</font>

595
00:22:00,590 --> 00:22:05,510
to keep in mind when prefetch actually

596
00:22:02,330 --> 00:22:08,540
occurs right<font color="#CCCCCC"> z 10 prefetching is before</font>

597
00:22:05,510 --> 00:22:10,100
I kind of get too far not anyone so

598
00:22:08,540 --> 00:22:12,950
prefetching is a<font color="#CCCCCC"> Windows operating</font>

599
00:22:10,100 --> 00:22:15,889
system process so when you execute

600
00:22:12,950 --> 00:22:17,150
programs constantly<font color="#E5E5E5"> windows said hey let</font>

601
00:22:15,890 --> 00:22:18,530
<font color="#E5E5E5">us build a way so that those programs</font>

602
00:22:17,150 --> 00:22:20,419
can launch faster and that's what

603
00:22:18,530 --> 00:22:22,070
prefetch is so when you launch word for

604
00:22:20,419 --> 00:22:23,490
example<font color="#E5E5E5"> right windows takes into account</font>

605
00:22:22,070 --> 00:22:25,350
within the<font color="#E5E5E5"> first 10 sec</font>

606
00:22:23,490 --> 00:22:27,720
all the files at word needs right all

607
00:22:25,350 --> 00:22:29,340
the DLLs the dynamic link libraries and

608
00:22:27,720 --> 00:22:31,740
it stores them in a dot PF where a

609
00:22:29,340 --> 00:22:32,939
prefetch file right so that helps us

610
00:22:31,740 --> 00:22:34,920
with now or two so we're actually

611
00:22:32,940 --> 00:22:36,570
analyzing the prefetch files don't<font color="#E5E5E5"> just</font>

612
00:22:34,920 --> 00:22:38,190
look at the time stamp that says when it

613
00:22:36,570 --> 00:22:39,689
ran and where it ran from but<font color="#E5E5E5"> I actually</font>

614
00:22:38,190 --> 00:22:41,610
need<font color="#E5E5E5"> to parse it out and find out what</font>

615
00:22:39,690 --> 00:22:45,330
were the files called by<font color="#CCCCCC"> that process</font>

616
00:22:41,610 --> 00:22:47,520
right so you can<font color="#E5E5E5"> see here commander exe</font>

617
00:22:45,330 --> 00:22:49,830
I don't have<font color="#E5E5E5"> the laser pointer executed</font>

618
00:22:47,520 --> 00:22:51,330
here's<font color="#E5E5E5"> the files that were involved in</font>

619
00:22:49,830 --> 00:22:56,070
an execution and one of the files is in

620
00:22:51,330 --> 00:22:57,540
CSV r32 exe<font color="#E5E5E5"> alright so I went and found</font>

621
00:22:56,070 --> 00:23:00,389
that file it's part of the raw for

622
00:22:57,540 --> 00:23:01,559
nacelle malware family<font color="#E5E5E5"> right so that's</font>

623
00:23:00,390 --> 00:23:03,510
just another thing<font color="#E5E5E5"> if I just looked at</font>

624
00:23:01,559 --> 00:23:05,309
<font color="#E5E5E5">this data on the Left which a lot of</font>

625
00:23:03,510 --> 00:23:06,840
folks do I wouldn't have seen this and

626
00:23:05,309 --> 00:23:08,129
that's a that's a very important threat

627
00:23:06,840 --> 00:23:12,120
indicator that I have to do some my

628
00:23:08,130 --> 00:23:15,480
searches on all right so remember<font color="#E5E5E5"> that</font>

629
00:23:12,120 --> 00:23:18,959
next one is am cash in cash is in

630
00:23:15,480 --> 00:23:22,080
<font color="#E5E5E5">Windows 7 now when is 8 12 10 and above</font>

631
00:23:18,960 --> 00:23:24,300
so in cash is awesome because it<font color="#CCCCCC"> gives a</font>

632
00:23:22,080 --> 00:23:26,189
lot<font color="#CCCCCC"> of data what are the one significant</font>

633
00:23:24,300 --> 00:23:28,139
items that it gives us is the last

634
00:23:26,190 --> 00:23:31,500
modified time of the file<font color="#CCCCCC"> the creation</font>

635
00:23:28,140 --> 00:23:33,960
time in the sha-1 hash of<font color="#CCCCCC"> the file right</font>

636
00:23:31,500 --> 00:23:36,300
so the hash is significant because if

637
00:23:33,960 --> 00:23:38,280
it's on an online<font color="#E5E5E5"> source like a virus</font>

638
00:23:36,300 --> 00:23:41,010
total I can probably<font color="#CCCCCC"> go download it if I</font>

639
00:23:38,280 --> 00:23:43,920
have a private account so for example in

640
00:23:41,010 --> 00:23:46,470
this particular case p 1 die AFP which

641
00:23:43,920 --> 00:23:48,179
is a bit odd<font color="#CCCCCC"> insist rate exe were also a</font>

642
00:23:46,470 --> 00:23:50,130
<font color="#E5E5E5">little bit odd in these locations we</font>

643
00:23:48,179 --> 00:23:51,570
were able<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> the hash we</font><font color="#E5E5E5"> found them</font>

644
00:23:50,130 --> 00:23:53,130
on virustotal we were able to download

645
00:23:51,570 --> 00:23:54,510
them and do analysis on them even though

646
00:23:53,130 --> 00:23:58,230
they no longer existed<font color="#E5E5E5"> on the system</font>

647
00:23:54,510 --> 00:24:03,150
great very beneficial<font color="#E5E5E5"> for us in for</font>

648
00:23:58,230 --> 00:24:04,770
whoever does the analysis so<font color="#CCCCCC"> I'm going</font>

649
00:24:03,150 --> 00:24:05,580
to talk all these are windows tools but

650
00:24:04,770 --> 00:24:06,809
if you even want like the Linux

651
00:24:05,580 --> 00:24:09,449
counterparts just talk to me afterwards

652
00:24:06,809 --> 00:24:10,950
just most folks are windows-based this

653
00:24:09,450 --> 00:24:14,400
is another system turtle tools called

654
00:24:10,950 --> 00:24:16,080
this internal tool called autoruns does

655
00:24:14,400 --> 00:24:23,970
<font color="#E5E5E5">anyone</font><font color="#CCCCCC"> know what autoruns arming we</font>

656
00:24:16,080 --> 00:24:25,919
refer to forensics pretty much yeah so

657
00:24:23,970 --> 00:24:27,150
autoruns in the<font color="#E5E5E5"> generalist terms means</font>

658
00:24:25,920 --> 00:24:28,860
that these are the programs that are

659
00:24:27,150 --> 00:24:31,080
going<font color="#E5E5E5"> to execute when i log on or turn</font>

660
00:24:28,860 --> 00:24:32,668
the computer on right so now we're

661
00:24:31,080 --> 00:24:34,530
wanting to remain on<font color="#E5E5E5"> the system will</font>

662
00:24:32,669 --> 00:24:35,840
create these<font color="#E5E5E5"> autorun or persistence</font>

663
00:24:34,530 --> 00:24:37,850
mechanisms so that they

664
00:24:35,840 --> 00:24:40,428
keep starting over<font color="#E5E5E5"> and over again even</font>

665
00:24:37,850 --> 00:24:41,240
if the computer is restarted so one of

666
00:24:40,429 --> 00:24:42,650
the cool things that people don't

667
00:24:41,240 --> 00:24:44,779
realize about autoruns when you're doing

668
00:24:42,650 --> 00:24:46,700
like forensic analysis if you<font color="#E5E5E5"> just want</font>

669
00:24:44,779 --> 00:24:48,080
<font color="#E5E5E5">to have a nice graphical interface you</font>

670
00:24:46,700 --> 00:24:50,419
can<font color="#E5E5E5"> actually point it to amounts of disk</font>

671
00:24:48,080 --> 00:24:53,178
image and then boat it that's a little

672
00:24:50,419 --> 00:24:54,620
<font color="#CCCCCC">easier</font><font color="#E5E5E5"> to go through this one always</font>

673
00:24:53,179 --> 00:24:56,630
gets people<font color="#E5E5E5"> I just put it up here is the</font>

674
00:24:54,620 --> 00:24:58,309
gather network info that always flags

675
00:24:56,630 --> 00:25:00,230
almost<font color="#E5E5E5"> Windows computers but that's</font>

676
00:24:58,309 --> 00:25:02,120
actually<font color="#CCCCCC"> a home group VBS script it's</font>

677
00:25:00,230 --> 00:25:05,779
<font color="#E5E5E5">not bad that's something to keep in mind</font>

678
00:25:02,120 --> 00:25:08,120
so other<font color="#CCCCCC"> things to look for as far as</font>

679
00:25:05,779 --> 00:25:10,880
persistent mechanisms our services<font color="#CCCCCC"> right</font>

680
00:25:08,120 --> 00:25:11,809
we<font color="#CCCCCC"> talk about services a little bit but</font>

681
00:25:10,880 --> 00:25:13,340
the nice thing that services are

682
00:25:11,809 --> 00:25:15,678
recorded in the registry that are also

683
00:25:13,340 --> 00:25:19,820
recorded in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> system event log right</font>

684
00:25:15,679 --> 00:25:21,529
so system that EBT x<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna actually</font>

685
00:25:19,820 --> 00:25:23,210
skip forward to slide single hop out so

686
00:25:21,529 --> 00:25:24,350
what you want to look for<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know when</font>

687
00:25:23,210 --> 00:25:25,820
you're doing like your sniper forensics

688
00:25:24,350 --> 00:25:28,219
is more for me poor cell beaches is

689
00:25:25,820 --> 00:25:31,220
almost everyone I've worked at some

690
00:25:28,220 --> 00:25:34,100
point a<font color="#CCCCCC"> service is created right so who</font>

691
00:25:31,220 --> 00:25:36,470
can create services administrators<font color="#E5E5E5"> in</font>

692
00:25:34,100 --> 00:25:38,178
above right so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means administrator</font>

693
00:25:36,470 --> 00:25:39,710
access is available all right and also

694
00:25:38,179 --> 00:25:41,630
grants to that process the highest

695
00:25:39,710 --> 00:25:43,669
privileges on the system right so very

696
00:25:41,630 --> 00:25:45,740
significant for a card<font color="#E5E5E5"> stealing malware</font>

697
00:25:43,669 --> 00:25:48,649
as well so here's an example<font color="#CCCCCC"> from</font>

698
00:25:45,740 --> 00:25:49,820
another piece of our family where it's a

699
00:25:48,649 --> 00:25:52,010
service called the serial port

700
00:25:49,820 --> 00:25:53,689
synchronization monitor a little bit odd

701
00:25:52,010 --> 00:25:55,970
again what I'd look forward to see this

702
00:25:53,690 --> 00:25:57,380
being started as a 7045 events right one

703
00:25:55,970 --> 00:25:59,000
of the first things I go for is to look

704
00:25:57,380 --> 00:26:00,830
for that but you have service<font color="#E5E5E5"> being</font>

705
00:25:59,000 --> 00:26:02,360
started that might be malicious there's

706
00:26:00,830 --> 00:26:05,389
not<font color="#E5E5E5"> a lot of times on the system where</font>

707
00:26:02,360 --> 00:26:07,250
services are being created like past the

708
00:26:05,390 --> 00:26:09,200
initial install date sometimes you<font color="#CCCCCC"> have</font>

709
00:26:07,250 --> 00:26:11,539
updates from the system admins a couple

710
00:26:09,200 --> 00:26:12,830
<font color="#E5E5E5">things like that but not all the time so</font>

711
00:26:11,539 --> 00:26:14,750
if you were<font color="#E5E5E5"> looking into environment you</font>

712
00:26:12,830 --> 00:26:15,799
said hey let me get all these logs and

713
00:26:14,750 --> 00:26:17,929
look at all<font color="#CCCCCC"> the</font><font color="#E5E5E5"> services being created</font>

714
00:26:15,799 --> 00:26:20,658
and 100 computers have a service treated

715
00:26:17,929 --> 00:26:22,669
on<font color="#CCCCCC"> the same day that might be a trigger</font>

716
00:26:20,659 --> 00:26:25,039
right the other cool nice thing about

717
00:26:22,669 --> 00:26:26,450
this<font color="#CCCCCC"> is PS execs which is a service will</font>

718
00:26:25,039 --> 00:26:29,140
also create this event something that

719
00:26:26,450 --> 00:26:29,140
you want<font color="#E5E5E5"> to look into</font>

720
00:26:29,400 --> 00:26:34,740
so any of<font color="#E5E5E5"> you are like in charge or have</font>

721
00:26:32,850 --> 00:26:36,990
a sim or kind<font color="#E5E5E5"> of help lead the socket</font>

722
00:26:34,740 --> 00:26:38,580
any<font color="#E5E5E5"> of your organization's make sure</font>

723
00:26:36,990 --> 00:26:41,070
that event<font color="#E5E5E5"> send to trigger somewhere you</font>

724
00:26:38,580 --> 00:26:44,610
know an email or what have you I don't

725
00:26:41,070 --> 00:26:46,679
know how well you<font color="#E5E5E5"> guys can see</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> will</font>

726
00:26:44,610 --> 00:26:48,149
give it a try so this<font color="#E5E5E5"> is just a real</font>

727
00:26:46,680 --> 00:26:49,860
quick example there is actually a

728
00:26:48,150 --> 00:26:53,010
malicious service in here but would you

729
00:26:49,860 --> 00:26:54,270
<font color="#CCCCCC">guys be able</font><font color="#E5E5E5"> to pick it out I know it</font>

730
00:26:53,010 --> 00:26:55,950
might<font color="#CCCCCC"> be hard to</font><font color="#E5E5E5"> see and if you want the</font>

731
00:26:54,270 --> 00:27:01,050
slide just<font color="#E5E5E5"> get asking me after this and</font>

732
00:26:55,950 --> 00:27:08,910
<font color="#E5E5E5">I'll send them to you one day anybody</font>

733
00:27:01,050 --> 00:27:10,110
want to try we can little one by one the

734
00:27:08,910 --> 00:27:11,610
point of this is to show<font color="#E5E5E5"> you that it's</font>

735
00:27:10,110 --> 00:27:13,949
<font color="#CCCCCC">not easy to find the malicious service</font>

736
00:27:11,610 --> 00:27:15,060
right so when you<font color="#E5E5E5"> have your working on</font>

737
00:27:13,950 --> 00:27:16,920
computers and you're not looking at<font color="#E5E5E5"> it</font>

738
00:27:15,060 --> 00:27:17,790
<font color="#E5E5E5">from your own analysis perspective and</font>

739
00:27:16,920 --> 00:27:19,080
you just saying which one of these

740
00:27:17,790 --> 00:27:28,980
services is bad you're probably not

741
00:27:19,080 --> 00:27:31,199
going to find<font color="#E5E5E5"> it</font><font color="#CCCCCC"> right off the bat yeah</font>

742
00:27:28,980 --> 00:27:33,030
so one of the yeah so when I just

743
00:27:31,200 --> 00:27:38,070
brought up is the volume<font color="#E5E5E5"> shadow service</font>

744
00:27:33,030 --> 00:27:39,660
which one is it microsemi croissant

745
00:27:38,070 --> 00:27:41,220
software Shadow Copy provider is

746
00:27:39,660 --> 00:27:42,390
perfectly fine right but she was

747
00:27:41,220 --> 00:27:44,760
mentioning that she's used to seeing the

748
00:27:42,390 --> 00:27:46,080
volume Shadow Copy which is the<font color="#CCCCCC"> native</font>

749
00:27:44,760 --> 00:27:51,150
Microsoft Application but it's actually

750
00:27:46,080 --> 00:27:52,830
that and services<font color="#CCCCCC"> notice</font><font color="#E5E5E5"> the dotnet</font>

751
00:27:51,150 --> 00:27:55,020
right every window system has done that

752
00:27:52,830 --> 00:27:56,760
this one's a little outdated but it's

753
00:27:55,020 --> 00:27:59,900
perfectly fine but why would you make

754
00:27:56,760 --> 00:27:59,900
why do you say that might be<font color="#E5E5E5"> bad</font>

755
00:28:01,190 --> 00:28:15,260
it over<font color="#E5E5E5"> from the okay good point sorry</font>

756
00:28:12,170 --> 00:28:16,880
it is for<font color="#E5E5E5"> Firefox it does do make a</font>

757
00:28:15,260 --> 00:28:17,870
service for some of their updates but

758
00:28:16,880 --> 00:28:19,550
you could google that or look at your

759
00:28:17,870 --> 00:28:22,820
own system or install<font color="#E5E5E5"> Firefox and sort</font>

760
00:28:19,550 --> 00:28:24,050
<font color="#CCCCCC">of figure that out so again looking into</font>

761
00:28:22,820 --> 00:28:25,850
patterns a little bit things that we

762
00:28:24,050 --> 00:28:28,669
look for<font color="#CCCCCC"> it is odd Spelling's things not</font>

763
00:28:25,850 --> 00:28:30,980
spelled correctly on grammar so it's<font color="#E5E5E5"> not</font>

764
00:28:28,670 --> 00:28:32,300
a lot here but there is one that sort of

765
00:28:30,980 --> 00:28:34,010
<font color="#E5E5E5">stands out and I don't</font><font color="#CCCCCC"> have a later for</font>

766
00:28:32,300 --> 00:28:36,110
this reporter so the one that stands out

767
00:28:34,010 --> 00:28:38,750
to me Microsoft file manager services

768
00:28:36,110 --> 00:28:41,120
most windows services are singular this

769
00:28:38,750 --> 00:28:43,430
one's plural right so it's a little<font color="#CCCCCC"> bit</font>

770
00:28:41,120 --> 00:28:44,750
odd not to<font color="#CCCCCC"> mention that the system that</font>

771
00:28:43,430 --> 00:28:47,030
<font color="#E5E5E5">in this case that</font><font color="#CCCCCC"> I will be looking at</font>

772
00:28:44,750 --> 00:28:48,470
is just a workstation and not a file

773
00:28:47,030 --> 00:28:51,920
manager why does it have that service

774
00:28:48,470 --> 00:28:54,350
installed on it so I'll pop it up for

775
00:28:51,920 --> 00:28:56,060
you in the description<font color="#E5E5E5"> of it is create</font>

776
00:28:54,350 --> 00:28:57,800
updates managers and remove files for

777
00:28:56,060 --> 00:28:59,629
applications such as s mine that's a

778
00:28:57,800 --> 00:29:02,120
cell if the service is<font color="#E5E5E5"> stopped</font>

779
00:28:59,630 --> 00:29:03,260
certificates will not be created saw

780
00:29:02,120 --> 00:29:06,080
major it doesn't seem to<font color="#E5E5E5"> me to have</font>

781
00:29:03,260 --> 00:29:08,420
anything<font color="#E5E5E5"> to do with certificates all</font>

782
00:29:06,080 --> 00:29:09,560
right a little<font color="#CCCCCC"> bit odd right again well</font>

783
00:29:08,420 --> 00:29:11,480
it kind of points out to me is it's

784
00:29:09,560 --> 00:29:13,730
called services where the rest are

785
00:29:11,480 --> 00:29:18,230
mostly singular most<font color="#CCCCCC"> Microsoft ones are</font>

786
00:29:13,730 --> 00:29:20,510
singular and intense and<font color="#CCCCCC"> then just for</font>

787
00:29:18,230 --> 00:29:22,340
unfortunately a lot of<font color="#E5E5E5"> people still use</font>

788
00:29:20,510 --> 00:29:26,510
Windows XP this is<font color="#E5E5E5"> just another example</font>

789
00:29:22,340 --> 00:29:28,610
of what you<font color="#CCCCCC"> would see on windows XP so</font>

790
00:29:26,510 --> 00:29:30,710
one of the biggest questions we get is

791
00:29:28,610 --> 00:29:32,000
lateral movement right how do you find

792
00:29:30,710 --> 00:29:34,670
lateral movement it's one of the most

793
00:29:32,000 --> 00:29:35,840
it's sort of easy<font color="#E5E5E5"> to find it but it's</font>

794
00:29:34,670 --> 00:29:37,190
hard to<font color="#CCCCCC"> find at the same time it also</font>

795
00:29:35,840 --> 00:29:39,590
depends on<font color="#E5E5E5"> a lot of the data that you</font>

796
00:29:37,190 --> 00:29:40,850
<font color="#CCCCCC">have so for a lot of movement is</font>

797
00:29:39,590 --> 00:29:42,409
different artifacts but we're going<font color="#E5E5E5"> to</font>

798
00:29:40,850 --> 00:29:44,240
<font color="#E5E5E5">concentrate on here is the security</font>

799
00:29:42,410 --> 00:29:46,820
event logs and things to look for in the

800
00:29:44,240 --> 00:29:51,110
security of it logs so for 64 bits are

801
00:29:46,820 --> 00:29:53,360
log on right<font color="#E5E5E5"> 464 is our account</font><font color="#CCCCCC"> with</font>

802
00:29:51,110 --> 00:29:55,370
logged off and<font color="#E5E5E5"> 4672 is special</font>

803
00:29:53,360 --> 00:29:56,959
privileges so special privileges means

804
00:29:55,370 --> 00:30:00,649
that they are an administrator on the

805
00:29:56,960 --> 00:30:02,210
box<font color="#CCCCCC"> alright and</font><font color="#E5E5E5"> the types of logons also</font>

806
00:30:00,650 --> 00:30:03,980
play a very important role right there's

807
00:30:02,210 --> 00:30:05,450
multiple types of log on just type<font color="#E5E5E5"> to</font>

808
00:30:03,980 --> 00:30:07,760
which physical I'm sitting<font color="#E5E5E5"> at the</font>

809
00:30:05,450 --> 00:30:09,530
keyboard there's type 3 which<font color="#CCCCCC"> is a map</font>

810
00:30:07,760 --> 00:30:11,150
<font color="#CCCCCC">drives right so if you use PS exec</font>

811
00:30:09,530 --> 00:30:12,980
that's<font color="#E5E5E5"> actually going to be a type 3 log</font>

812
00:30:11,150 --> 00:30:14,269
on right because you're making<font color="#CCCCCC"> like a</font>

813
00:30:12,980 --> 00:30:16,729
map drive over 44

814
00:30:14,269 --> 00:30:18,919
five or the<font color="#E5E5E5"> netbios</font><font color="#CCCCCC"> ports in type 10</font>

815
00:30:16,729 --> 00:30:21,619
means remote<font color="#E5E5E5"> interactive which uses RTP</font>

816
00:30:18,919 --> 00:30:23,690
port 3389<font color="#CCCCCC"> all right so some of those are</font>

817
00:30:21,619 --> 00:30:25,820
<font color="#CCCCCC">the big takeaways there what</font><font color="#E5E5E5"> you want to</font>

818
00:30:23,690 --> 00:30:28,459
look<font color="#CCCCCC"> for and then where they're coming</font>

819
00:30:25,820 --> 00:30:30,408
from if you see if you're looking<font color="#E5E5E5"> at</font>

820
00:30:28,459 --> 00:30:31,789
some<font color="#CCCCCC"> of your your own</font><font color="#E5E5E5"> cases right you're</font>

821
00:30:30,409 --> 00:30:33,619
looking at the security event logs and

822
00:30:31,789 --> 00:30:36,320
there's logons that occur from outside

823
00:30:33,619 --> 00:30:39,379
the environment like from Russia that's

824
00:30:36,320 --> 00:30:40,849
probably<font color="#E5E5E5"> not a good sign one thing I</font>

825
00:30:39,379 --> 00:30:42,649
will mention like really quickly I don't

826
00:30:40,849 --> 00:30:45,379
know if anyone's in charge of actually

827
00:30:42,649 --> 00:30:47,689
configuring the event logs please do<font color="#E5E5E5"> not</font>

828
00:30:45,379 --> 00:30:50,119
that's a double negative please log

829
00:30:47,690 --> 00:30:51,200
successful log on if you don't log

830
00:30:50,119 --> 00:30:52,339
successful ah guys we're not<font color="#E5E5E5"> gonna be</font>

831
00:30:51,200 --> 00:30:54,320
able<font color="#E5E5E5"> to tell like we're moving around</font>

832
00:30:52,339 --> 00:30:56,029
from<font color="#E5E5E5"> great we see a lot of companies</font>

833
00:30:54,320 --> 00:30:58,668
that<font color="#E5E5E5"> just do a root force to like</font><font color="#CCCCCC"> say</font>

834
00:30:56,029 --> 00:30:59,809
log on what's the time the attackers in

835
00:30:58,669 --> 00:31:01,279
your environment they're not going<font color="#E5E5E5"> to</font>

836
00:30:59,809 --> 00:31:02,418
fail they already know the password or

837
00:31:01,279 --> 00:31:04,339
if they<font color="#E5E5E5"> don't know that one passable</font>

838
00:31:02,419 --> 00:31:07,279
<font color="#E5E5E5">using another one that'll work another</font>

839
00:31:04,339 --> 00:31:09,529
user name and account um the other thing

840
00:31:07,279 --> 00:31:12,469
to look for is actual like account

841
00:31:09,529 --> 00:31:14,419
escalation so with<font color="#E5E5E5"> an attackers making a</font>

842
00:31:12,469 --> 00:31:16,129
batch<font color="#E5E5E5"> script or some</font><font color="#CCCCCC"> of those X</font><font color="#E5E5E5"> program</font>

843
00:31:14,419 --> 00:31:18,049
they'll run those that's you know use

844
00:31:16,129 --> 00:31:19,458
your a but they want to use the main

845
00:31:18,049 --> 00:31:21,019
admin or domain administrator accounts

846
00:31:19,459 --> 00:31:22,669
which is user be so that will create a

847
00:31:21,019 --> 00:31:25,339
<font color="#CCCCCC">small 648 event saying that it's being</font>

848
00:31:22,669 --> 00:31:26,359
ran as an elevated account<font color="#CCCCCC"> all right so</font>

849
00:31:25,339 --> 00:31:27,649
something else would take into account

850
00:31:26,359 --> 00:31:30,320
so the pictures here basically show you

851
00:31:27,649 --> 00:31:33,829
that Regis anchor is running a program

852
00:31:30,320 --> 00:31:36,019
as IT admin one right not always

853
00:31:33,829 --> 00:31:38,029
malicious you know our IT admins could

854
00:31:36,019 --> 00:31:40,820
do that but this is<font color="#CCCCCC"> a case that you</font><font color="#E5E5E5"> go</font>

855
00:31:38,029 --> 00:31:44,269
to want to look for as well we see that

856
00:31:40,820 --> 00:31:48,408
<font color="#CCCCCC">a lot on some of the</font><font color="#E5E5E5"> went to earlier a</font>

857
00:31:44,269 --> 00:31:50,749
lot<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> cases so other things that</font>

858
00:31:48,409 --> 00:31:52,489
third actors do is they clear event logs

859
00:31:50,749 --> 00:31:58,039
right so what is clear in a bit log do

860
00:31:52,489 --> 00:31:59,539
it creates a new event tells you who

861
00:31:58,039 --> 00:32:00,979
cleared it and that's the<font color="#E5E5E5"> event log was</font>

862
00:31:59,539 --> 00:32:02,509
cleared another thing<font color="#E5E5E5"> that they're</font>

863
00:32:00,979 --> 00:32:04,339
actors do is it clear the registry which

864
00:32:02,509 --> 00:32:07,789
is a where a lot of the<font color="#E5E5E5"> day that we did</font>

865
00:32:04,339 --> 00:32:08,989
exist so we sort of work<font color="#CCCCCC"> try</font><font color="#E5E5E5"> to figure</font>

866
00:32:07,789 --> 00:32:10,249
<font color="#CCCCCC">out a way to how do we see lateral</font>

867
00:32:08,989 --> 00:32:12,919
movement if some of those files<font color="#E5E5E5"> are gone</font>

868
00:32:10,249 --> 00:32:15,229
right so if we<font color="#CCCCCC"> look at the windows</font><font color="#E5E5E5"> right</font>

869
00:32:12,919 --> 00:32:16,879
like a user<font color="#CCCCCC"> or for user a we can look at</font>

870
00:32:15,229 --> 00:32:21,320
their registry you know if a user a

871
00:32:16,879 --> 00:32:23,629
created a terminal service access to a

872
00:32:21,320 --> 00:32:26,029
remote<font color="#E5E5E5"> system right those entries for</font>

873
00:32:23,629 --> 00:32:27,468
that but if they clear those up in the

874
00:32:26,029 --> 00:32:28,220
registry how else can we figure it out

875
00:32:27,469 --> 00:32:30,260
<font color="#E5E5E5">in</font>

876
00:32:28,220 --> 00:32:31,309
also if they clear the security event

877
00:32:30,260 --> 00:32:33,559
log what are<font color="#CCCCCC"> some other</font><font color="#E5E5E5"> places we might</font>

878
00:32:31,309 --> 00:32:39,139
<font color="#CCCCCC">be able to look for that we don't want</font>

879
00:32:33,559 --> 00:32:40,399
to guess<font color="#CCCCCC"> Klingon history so command</font>

880
00:32:39,140 --> 00:32:41,510
history is generally stored in memory

881
00:32:40,400 --> 00:32:43,490
but if you have memory dump you may be

882
00:32:41,510 --> 00:32:45,230
able<font color="#CCCCCC"> to find that you could turn</font>

883
00:32:43,490 --> 00:32:46,789
<font color="#E5E5E5">command-line auditing on but will say</font>

884
00:32:45,230 --> 00:32:51,049
that doesn't<font color="#E5E5E5"> exist either but good point</font>

885
00:32:46,789 --> 00:32:53,720
there is a recent execution listen

886
00:32:51,049 --> 00:32:54,830
<font color="#CCCCCC">they're experts alright but that might</font>

887
00:32:53,720 --> 00:32:55,850
not tell us<font color="#E5E5E5"> where they went right if you</font>

888
00:32:54,830 --> 00:32:57,110
want<font color="#CCCCCC"> to know</font><font color="#E5E5E5"> what we're most just and</font>

889
00:32:55,850 --> 00:32:59,059
they went to that they may or may not

890
00:32:57,110 --> 00:33:00,379
tell<font color="#CCCCCC"> us sometimes you get like a run</font><font color="#E5E5E5"> em</font>

891
00:32:59,059 --> 00:33:02,480
<font color="#E5E5E5">are you come in which is</font><font color="#CCCCCC"> we need pop-up</font>

892
00:33:00,380 --> 00:33:03,620
windows are and the run prompt pops up

893
00:33:02,480 --> 00:33:06,110
and you do like the backslash backslash

894
00:33:03,620 --> 00:33:07,820
computer name which or get to that chair

895
00:33:06,110 --> 00:33:09,379
that would be<font color="#E5E5E5"> like something else in the</font>

896
00:33:07,820 --> 00:33:13,280
registry but of course the user<font color="#CCCCCC"> you</font>

897
00:33:09,380 --> 00:33:14,390
<font color="#CCCCCC">tackle clean that out so there's also</font>

898
00:33:13,280 --> 00:33:17,600
another file that's not really

899
00:33:14,390 --> 00:33:19,159
<font color="#CCCCCC">well-known it's called it'd be cash most</font>

900
00:33:17,600 --> 00:33:22,370
of time you see<font color="#E5E5E5"> it's be cash 22 or be</font>

901
00:33:19,159 --> 00:33:26,419
cash 24 b and c it's actually a bitmap

902
00:33:22,370 --> 00:33:29,689
file in windows stores little fragments

903
00:33:26,419 --> 00:33:31,250
of data in here to help load it when

904
00:33:29,690 --> 00:33:32,210
they do the remote computer<font color="#E5E5E5"> right so</font>

905
00:33:31,250 --> 00:33:34,970
when they log on to the remote computer

906
00:33:32,210 --> 00:33:37,280
<font color="#E5E5E5">it'll save some of those those images</font>

907
00:33:34,970 --> 00:33:40,610
into this file<font color="#CCCCCC"> i'm not</font><font color="#E5E5E5"> really sure why i</font>

908
00:33:37,280 --> 00:33:42,110
think<font color="#E5E5E5"> it's for speed but this was a</font>

909
00:33:40,610 --> 00:33:43,399
great indicator in a lot of<font color="#E5E5E5"> instances</font>

910
00:33:42,110 --> 00:33:44,840
<font color="#E5E5E5">and a lot of</font><font color="#CCCCCC"> people just aren't looking</font>

911
00:33:43,400 --> 00:33:46,100
at and what you can see here is it gives

912
00:33:44,840 --> 00:33:48,139
us a<font color="#E5E5E5"> little bit of information and this</font>

913
00:33:46,100 --> 00:33:49,219
is just<font color="#E5E5E5"> a really small snippet so</font>

914
00:33:48,140 --> 00:33:50,960
there's a lot<font color="#E5E5E5"> of things</font><font color="#CCCCCC"> gonna you can</font>

915
00:33:49,220 --> 00:33:54,350
see a net<font color="#CCCCCC"> use command for an IP address</font>

916
00:33:50,960 --> 00:33:55,880
right the user as well we<font color="#CCCCCC"> also see some</font>

917
00:33:54,350 --> 00:33:58,730
tools over here on the right like Ram

918
00:33:55,880 --> 00:34:01,190
exec run tool a text file called SRV

919
00:33:58,730 --> 00:34:02,450
right those are other threat indicates

920
00:34:01,190 --> 00:34:04,429
that we can look for across the network

921
00:34:02,450 --> 00:34:06,799
to see if there they are malicious so

922
00:34:04,429 --> 00:34:08,270
run exactly in<font color="#E5E5E5"> this case is actually the</font>

923
00:34:06,799 --> 00:34:10,759
way that the attacker was spreading them

924
00:34:08,270 --> 00:34:12,168
our around the environment so<font color="#E5E5E5"> I can see</font>

925
00:34:10,760 --> 00:34:13,669
this net used commands and now I have a

926
00:34:12,168 --> 00:34:14,839
new IP address to go after<font color="#E5E5E5"> that's</font>

927
00:34:13,668 --> 00:34:16,699
another system that you look at if<font color="#E5E5E5"> I</font>

928
00:34:14,839 --> 00:34:18,049
didn't previously know and so this file

929
00:34:16,699 --> 00:34:19,819
<font color="#E5E5E5">helped us a lot in a couple of incidents</font>

930
00:34:18,050 --> 00:34:24,200
because<font color="#E5E5E5"> they were clearing out a lot of</font>

931
00:34:19,820 --> 00:34:25,970
that data the fool there should be<font color="#E5E5E5"> two</font>

932
00:34:24,199 --> 00:34:28,069
files now<font color="#E5E5E5"> one of the file</font><font color="#CCCCCC"> the tools to</font>

933
00:34:25,969 --> 00:34:29,750
look at sorry the BMC viewer it's really

934
00:34:28,070 --> 00:34:33,050
<font color="#CCCCCC">hard to find I think there's another one</font>

935
00:34:29,750 --> 00:34:35,719
but I don't come use it so this<font color="#E5E5E5"> is also</font>

936
00:34:33,050 --> 00:34:37,909
another windows artifact that a lot of

937
00:34:35,719 --> 00:34:39,379
people don't<font color="#E5E5E5"> look at it Scott object</font>

938
00:34:37,909 --> 00:34:40,000
data is anyone know what it is or has

939
00:34:39,379 --> 00:34:45,610
anyone ever

940
00:34:40,000 --> 00:34:47,290
ribbit no one's heard<font color="#E5E5E5"> of it heard of it</font>

941
00:34:45,610 --> 00:34:50,980
yesterday they talked about<font color="#CCCCCC"> in the class</font>

942
00:34:47,290 --> 00:34:52,899
right before this I hope<font color="#E5E5E5"> for the w my</font>

943
00:34:50,980 --> 00:34:56,080
logging and stuff so anyway the object

944
00:34:52,899 --> 00:34:59,020
data file is a wmi or windows management

945
00:34:56,080 --> 00:35:03,490
instrumentation repository right it's

946
00:34:59,020 --> 00:35:05,320
got two different purposes for us<font color="#E5E5E5"> for</font>

947
00:35:03,490 --> 00:35:07,810
forensics the first purpose is really

948
00:35:05,320 --> 00:35:09,850
<font color="#E5E5E5">what we call persistence events right</font>

949
00:35:07,810 --> 00:35:11,049
and I talked<font color="#CCCCCC"> about autoruns well the</font>

950
00:35:09,850 --> 00:35:13,180
autorun tool and a lot of the other

951
00:35:11,050 --> 00:35:15,100
forensics tools that you use don't<font color="#E5E5E5"> parsh</font>

952
00:35:13,180 --> 00:35:17,529
this file correctly so you'll never find

953
00:35:15,100 --> 00:35:18,520
that<font color="#CCCCCC"> autorun event so what attackers are</font>

954
00:35:17,530 --> 00:35:21,220
doing is you're creating events

955
00:35:18,520 --> 00:35:23,530
consumers so basically say when the

956
00:35:21,220 --> 00:35:25,390
system uptime is 200 seconds run this

957
00:35:23,530 --> 00:35:27,760
executable right and that's stored in

958
00:35:25,390 --> 00:35:30,310
the<font color="#CCCCCC"> object data file</font><font color="#E5E5E5"> all right so it's</font>

959
00:35:27,760 --> 00:35:32,230
<font color="#E5E5E5">another method for creating persistence</font>

960
00:35:30,310 --> 00:35:33,850
events that a lot<font color="#E5E5E5"> of unfortunate</font>

961
00:35:32,230 --> 00:35:35,140
friendly folks are not looking<font color="#E5E5E5"> at right</font>

962
00:35:33,850 --> 00:35:37,480
so<font color="#E5E5E5"> remember</font><font color="#CCCCCC"> that's when you're doing</font>

963
00:35:35,140 --> 00:35:38,859
you're selling your analysis just<font color="#CCCCCC"> to</font>

964
00:35:37,480 --> 00:35:42,550
kind of<font color="#E5E5E5"> give you an interesting story is</font>

965
00:35:38,860 --> 00:35:44,620
we r you know there's an engagement that

966
00:35:42,550 --> 00:35:47,080
we're working<font color="#CCCCCC"> on right now and actually</font>

967
00:35:44,620 --> 00:35:50,080
found a very sophisticated nation-state

968
00:35:47,080 --> 00:35:51,549
tool so we<font color="#CCCCCC"> had</font><font color="#E5E5E5"> never seen before and</font>

969
00:35:50,080 --> 00:35:53,770
always ricotta is because we have<font color="#E5E5E5"> a tool</font>

970
00:35:51,550 --> 00:35:55,000
to parse this file but it just kind of

971
00:35:53,770 --> 00:35:56,470
makes you<font color="#E5E5E5"> think you know because we have</font>

972
00:35:55,000 --> 00:35:57,700
<font color="#CCCCCC">like people haven't noticed this file</font>

973
00:35:56,470 --> 00:36:00,669
for so long what else could have been

974
00:35:57,700 --> 00:36:02,500
missed and the second<font color="#E5E5E5"> part 4 is also</font>

975
00:36:00,670 --> 00:36:05,380
used for software metering for SCCM

976
00:36:02,500 --> 00:36:07,510
which is a windows product right so

977
00:36:05,380 --> 00:36:08,890
again part of one<font color="#E5E5E5"> of the engagements</font>

978
00:36:07,510 --> 00:36:11,110
that we were working on they cleared the

979
00:36:08,890 --> 00:36:12,310
event logs they clear the registry right

980
00:36:11,110 --> 00:36:14,650
we didn't really have an idea of what

981
00:36:12,310 --> 00:36:16,570
account was doing what fortunately they

982
00:36:14,650 --> 00:36:18,970
had turned on software metering which is

983
00:36:16,570 --> 00:36:20,380
stored into this file so<font color="#CCCCCC"> we create the</font>

984
00:36:18,970 --> 00:36:21,759
<font color="#E5E5E5">parser for it and we were able to pull</font>

985
00:36:20,380 --> 00:36:23,230
out a timeline is exactly what the

986
00:36:21,760 --> 00:36:24,910
attacker was doing in<font color="#E5E5E5"> the commands they</font>

987
00:36:23,230 --> 00:36:27,670
were running<font color="#E5E5E5"> in a time that they did it</font>

988
00:36:24,910 --> 00:36:29,470
okay so just looking at this you can you

989
00:36:27,670 --> 00:36:31,330
may or may not be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to spot something</font>

990
00:36:29,470 --> 00:36:34,618
bad we won't see anything<font color="#E5E5E5"> like really</font>

991
00:36:31,330 --> 00:36:41,788
weird in here

992
00:36:34,619 --> 00:36:44,130
well so one of the sort<font color="#E5E5E5"> of the second</font>

993
00:36:41,789 --> 00:36:47,190
time one of<font color="#CCCCCC"> the most unusual ones is WCE</font>

994
00:36:44,130 --> 00:36:48,749
32 right that is generally associated

995
00:36:47,190 --> 00:36:50,249
with a tool called<font color="#CCCCCC"> windows credential</font>

996
00:36:48,749 --> 00:36:51,569
editor right which<font color="#CCCCCC"> is a tool to the</font>

997
00:36:50,249 --> 00:36:53,189
harvest credentials from systems right

998
00:36:51,569 --> 00:36:56,430
so that's like<font color="#E5E5E5"> a</font><font color="#CCCCCC"> key word that we use</font>

999
00:36:53,190 --> 00:36:58,289
<font color="#E5E5E5">attackers sometimes change her name is a</font>

1000
00:36:56,430 --> 00:36:59,190
tool sometimes they don't they just

1001
00:36:58,289 --> 00:37:02,009
don't think they're<font color="#E5E5E5"> gonna get caught</font>

1002
00:36:59,190 --> 00:37:05,640
we're<font color="#E5E5E5"> just not worried about it Wow but</font>

1003
00:37:02,009 --> 00:37:13,230
that's a good give away their<font color="#E5E5E5"> touching</font>

1004
00:37:05,640 --> 00:37:15,269
saw still there<font color="#CCCCCC"> she just look</font><font color="#E5E5E5"> at me so</font>

1005
00:37:13,230 --> 00:37:16,799
last but not least because we did our

1006
00:37:15,269 --> 00:37:18,359
pre-processing<font color="#CCCCCC"> we were using time lining</font>

1007
00:37:16,799 --> 00:37:19,529
right there's different tools<font color="#E5E5E5"> do time</font>

1008
00:37:18,359 --> 00:37:22,170
lining most folks are<font color="#E5E5E5"> familiar with</font>

1009
00:37:19,529 --> 00:37:27,509
<font color="#CCCCCC">plasti or along the timeline any x rays</font>

1010
00:37:22,170 --> 00:37:29,369
fans in here no no so I'm a huge<font color="#E5E5E5"> x-rays</font>

1011
00:37:27,509 --> 00:37:32,190
person but<font color="#CCCCCC"> uh actually</font><font color="#E5E5E5"> this time line</font>

1012
00:37:29,369 --> 00:37:34,019
just like class so does laughing<font color="#CCCCCC"> so this</font>

1013
00:37:32,190 --> 00:37:35,549
is just<font color="#CCCCCC"> like a real good example of</font>

1014
00:37:34,019 --> 00:37:37,200
putting<font color="#E5E5E5"> it all back together based on</font>

1015
00:37:35,549 --> 00:37:40,680
some data<font color="#CCCCCC"> that we have so we have a</font>

1016
00:37:37,200 --> 00:37:42,269
logon type 3 from this minute<font color="#CCCCCC"> rater</font>

1017
00:37:40,680 --> 00:37:44,640
account we know when they logged in from

1018
00:37:42,269 --> 00:37:46,859
sorry if you guys can<font color="#E5E5E5"> hear me let me</font>

1019
00:37:44,640 --> 00:37:48,269
know if you like it went off it's an

1020
00:37:46,859 --> 00:37:50,970
administrator account as soon<font color="#E5E5E5"> as they</font>

1021
00:37:48,269 --> 00:37:53,669
log on i started PS exec it executed we

1022
00:37:50,970 --> 00:37:58,109
also have SC which is used<font color="#E5E5E5"> for services</font>

1023
00:37:53,670 --> 00:37:59,880
also in the new services created let me

1024
00:37:58,109 --> 00:38:03,660
go<font color="#E5E5E5"> back sorry the service is created</font>

1025
00:37:59,880 --> 00:38:06,509
here along with the file they log off

1026
00:38:03,660 --> 00:38:07,799
<font color="#E5E5E5">the service starts to new files down</font>

1027
00:38:06,509 --> 00:38:10,410
here at the bottom of creative spool SV

1028
00:38:07,799 --> 00:38:13,319
THM<font color="#E5E5E5"> and then the prefetch file form on</font>

1029
00:38:10,410 --> 00:38:14,549
think so again to talk<font color="#E5E5E5"> about prefetch a</font>

1030
00:38:13,319 --> 00:38:16,890
lot of prefetch files will get pushed

1031
00:38:14,549 --> 00:38:18,779
out<font color="#CCCCCC"> too so that's why</font><font color="#E5E5E5"> another reason why</font>

1032
00:38:16,890 --> 00:38:20,879
I don't<font color="#E5E5E5"> like they're not like the best</font>

1033
00:38:18,779 --> 00:38:23,269
means for finding program execution in a

1034
00:38:20,880 --> 00:38:23,269
lot<font color="#E5E5E5"> of cases</font>

1035
00:38:24,920 --> 00:38:29,930
and they sort of roll it up when you

1036
00:38:26,930 --> 00:38:31,640
start looking<font color="#E5E5E5"> at your different logons</font>

1037
00:38:29,930 --> 00:38:35,480
or remote<font color="#CCCCCC"> logon it's right so you have</font>

1038
00:38:31,640 --> 00:38:37,609
tools like logmein well so they're

1039
00:38:35,480 --> 00:38:40,700
teamviewer some anybody use a Citrix

1040
00:38:37,610 --> 00:38:43,130
environment or familiar with citrix<font color="#E5E5E5"> okay</font>

1041
00:38:40,700 --> 00:38:44,689
more VPNs you can get those logs and you

1042
00:38:43,130 --> 00:38:45,920
want to look for some abnormalities so

1043
00:38:44,690 --> 00:38:48,590
here's a really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> example of things</font>

1044
00:38:45,920 --> 00:38:50,630
that<font color="#E5E5E5"> you might want to look for we have</font>

1045
00:38:48,590 --> 00:38:52,850
the the client name here which is really

1046
00:38:50,630 --> 00:38:54,680
in<font color="#E5E5E5"> this case the workstation name and</font>

1047
00:38:52,850 --> 00:38:57,440
this is why you<font color="#E5E5E5"> ask what is the standard</font>

1048
00:38:54,680 --> 00:38:58,730
naming convention within your

1049
00:38:57,440 --> 00:39:00,590
environment or<font color="#CCCCCC"> the environment that you</font>

1050
00:38:58,730 --> 00:39:02,540
work in so in this case is<font color="#E5E5E5"> pretty easy</font>

1051
00:39:00,590 --> 00:39:05,990
desktop it's an admin it's called<font color="#E5E5E5"> adnan</font>

1052
00:39:02,540 --> 00:39:07,580
yeah renamed these but<font color="#CCCCCC"> desktop since</font><font color="#E5E5E5"> rip</font>

1053
00:39:05,990 --> 00:39:10,939
right and then you have this one system

1054
00:39:07,580 --> 00:39:12,770
that is a little bit odd right so if you

1055
00:39:10,940 --> 00:39:14,240
<font color="#E5E5E5">don't know this is how microsoft names</font>

1056
00:39:12,770 --> 00:39:15,980
or standard host names from default

1057
00:39:14,240 --> 00:39:18,439
installs like when hyphen or tack

1058
00:39:15,980 --> 00:39:19,670
something right so if you see that in

1059
00:39:18,440 --> 00:39:21,350
like someone's environment or your own

1060
00:39:19,670 --> 00:39:22,490
environment and you have a naming

1061
00:39:21,350 --> 00:39:24,650
standard that's something that should

1062
00:39:22,490 --> 00:39:26,299
try trigger you a little bit you can

1063
00:39:24,650 --> 00:39:28,370
also see that Regis and Fred biscuit

1064
00:39:26,300 --> 00:39:30,470
here are logging in from the same exact

1065
00:39:28,370 --> 00:39:33,080
IP address sometimes on the same day

1066
00:39:30,470 --> 00:39:34,850
right so if you were to ask yourself

1067
00:39:33,080 --> 00:39:36,830
world word of these two individuals live

1068
00:39:34,850 --> 00:39:39,110
one lives in georgia and the<font color="#CCCCCC"> other one</font>

1069
00:39:36,830 --> 00:39:41,029
lives in you know milena I mean I later

1070
00:39:39,110 --> 00:39:42,890
come on s in Georgia South Carolina

1071
00:39:41,030 --> 00:39:46,610
right and<font color="#E5E5E5"> that IP address is registered</font>

1072
00:39:42,890 --> 00:39:50,750
to Arizona that could be<font color="#CCCCCC"> odd right</font>

1073
00:39:46,610 --> 00:39:52,760
something to think about there and<font color="#E5E5E5"> just</font>

1074
00:39:50,750 --> 00:39:55,940
to talk back go back and talk about<font color="#E5E5E5"> my</font>

1075
00:39:52,760 --> 00:39:57,560
<font color="#E5E5E5">earlier point of keyword searches for</font>

1076
00:39:55,940 --> 00:39:59,540
regular expressions for card data is not

1077
00:39:57,560 --> 00:40:01,400
always the best method is because you

1078
00:39:59,540 --> 00:40:02,810
have<font color="#E5E5E5"> exactly what we see here this is</font>

1079
00:40:01,400 --> 00:40:04,160
actually an example from the framework

1080
00:40:02,810 --> 00:40:05,810
<font color="#E5E5E5">point of sale my our family where it</font>

1081
00:40:04,160 --> 00:40:07,790
seals the car data and then it encodes

1082
00:40:05,810 --> 00:40:09,980
it so you can see here on<font color="#E5E5E5"> the Left we</font>

1083
00:40:07,790 --> 00:40:11,990
have that spool SV that chm file similar

1084
00:40:09,980 --> 00:40:14,180
to what you saw in<font color="#CCCCCC"> the earlier slide and</font>

1085
00:40:11,990 --> 00:40:16,370
here it's encoded you know it's a custom

1086
00:40:14,180 --> 00:40:19,339
alphabet with basics for dex or encoding

1087
00:40:16,370 --> 00:40:21,109
and here's<font color="#E5E5E5"> what it looks like decoded if</font>

1088
00:40:19,340 --> 00:40:24,190
that actually is someone's credit card

1089
00:40:21,110 --> 00:40:28,780
that's not intended

1090
00:40:24,190 --> 00:40:31,540
alright alright so we<font color="#CCCCCC"> have a quick</font>

1091
00:40:28,780 --> 00:40:33,040
exercise for you guys but are there any

1092
00:40:31,540 --> 00:40:34,210
<font color="#E5E5E5">questions before I move on to the</font>

1093
00:40:33,040 --> 00:40:40,089
exercise<font color="#E5E5E5"> where you guys have to solve it</font>

1094
00:40:34,210 --> 00:40:42,310
yourself so it's<font color="#CCCCCC"> probably like a good</font>

1095
00:40:40,089 --> 00:40:43,569
talk<font color="#E5E5E5"> to have later but uh what's the</font>

1096
00:40:42,310 --> 00:40:44,980
time they're<font color="#CCCCCC"> not logging correctly or</font>

1097
00:40:43,569 --> 00:40:46,390
there's different ways<font color="#CCCCCC"> to get those logs</font>

1098
00:40:44,980 --> 00:40:47,890
what you feel ideally want to have as a

1099
00:40:46,390 --> 00:40:49,810
sequel database that's<font color="#E5E5E5"> storing all the</font>

1100
00:40:47,890 --> 00:40:51,098
information but it's actually stored on

1101
00:40:49,810 --> 00:40:52,599
the citrix servers themselves but

1102
00:40:51,099 --> 00:40:58,300
sometimes<font color="#CCCCCC"> your linux sometimes your</font>

1103
00:40:52,599 --> 00:41:00,520
windows yeah so most of the times the

1104
00:40:58,300 --> 00:41:02,170
point-of-sale systems are windows XP

1105
00:41:00,520 --> 00:41:03,400
embedded there's some windows<font color="#CCCCCC"> 7 pornete</font>

1106
00:41:02,170 --> 00:41:06,099
feel like they have special point still

1107
00:41:03,400 --> 00:41:09,790
my marker stock does we see<font color="#CCCCCC"> custom built</font>

1108
00:41:06,099 --> 00:41:12,220
applications<font color="#CCCCCC"> like in linux i had we have</font>

1109
00:41:09,790 --> 00:41:13,810
yet that I to my knowledge<font color="#E5E5E5"> but works one</font>

1110
00:41:12,220 --> 00:41:18,430
of those with a custom-built image a

1111
00:41:13,810 --> 00:41:21,578
good question<font color="#CCCCCC"> alright so we're looking</font>

1112
00:41:18,430 --> 00:41:23,500
<font color="#E5E5E5">at</font><font color="#CCCCCC"> a system and we're</font><font color="#E5E5E5"> trying to find</font>

1113
00:41:21,579 --> 00:41:24,430
badness right we don't<font color="#E5E5E5"> know the time we</font>

1114
00:41:23,500 --> 00:41:25,750
<font color="#CCCCCC">don't anything about it so we're doing</font>

1115
00:41:24,430 --> 00:41:27,549
<font color="#E5E5E5">our sniper forensics</font><font color="#CCCCCC"> just like we did</font>

1116
00:41:25,750 --> 00:41:29,440
today unfortunately increase<font color="#CCCCCC"> Bechet is</font>

1117
00:41:27,550 --> 00:41:30,910
disabled and if you didn't see<font color="#E5E5E5"> it</font>

1118
00:41:29,440 --> 00:41:32,740
prefetch is disabled by default on

1119
00:41:30,910 --> 00:41:36,910
servers in systems with a solid state

1120
00:41:32,740 --> 00:41:38,500
drives so subscribe server unfortunately

1121
00:41:36,910 --> 00:41:40,420
process auditing is abled so they'll

1122
00:41:38,500 --> 00:41:43,119
help you guys out even more so the goal

1123
00:41:40,420 --> 00:41:49,930
here is you see any files are a bit odd

1124
00:41:43,119 --> 00:41:51,579
or so remember we<font color="#E5E5E5"> will look and this is</font>

1125
00:41:49,930 --> 00:41:53,919
some ash in cache<font color="#E5E5E5"> entry right here these</font>

1126
00:41:51,579 --> 00:41:54,670
on the<font color="#CCCCCC"> left hand</font><font color="#E5E5E5"> side here is you're</font>

1127
00:41:53,920 --> 00:41:55,990
going<font color="#E5E5E5"> to see things that have been</font>

1128
00:41:54,670 --> 00:41:57,250
running on<font color="#E5E5E5"> the system right you don't</font>

1129
00:41:55,990 --> 00:41:59,049
know who did it you don't<font color="#CCCCCC"> really know</font>

1130
00:41:57,250 --> 00:42:00,670
the time<font color="#E5E5E5"> that they executed the goal</font>

1131
00:41:59,050 --> 00:42:02,319
here is really to find one that kind of

1132
00:42:00,670 --> 00:42:04,210
sticks out and just doesn't<font color="#CCCCCC"> make sense</font>

1133
00:42:02,319 --> 00:42:05,650
<font color="#E5E5E5">to you some things that I like to do is</font>

1134
00:42:04,210 --> 00:42:07,420
<font color="#E5E5E5">look at my own computer and see if I</font>

1135
00:42:05,650 --> 00:42:09,099
have it<font color="#E5E5E5"> right or if you're looking at</font>

1136
00:42:07,420 --> 00:42:11,050
<font color="#E5E5E5">the image it does that does that file</font>

1137
00:42:09,099 --> 00:42:13,900
exists on the image it's that odd pull

1138
00:42:11,050 --> 00:42:16,530
it off<font color="#E5E5E5"> and do some analysis let's be</font>

1139
00:42:13,900 --> 00:42:16,530
careful with right

1140
00:42:17,760 --> 00:42:34,920
so anybody have their computer<font color="#E5E5E5"> oh oh so</font>

1141
00:42:31,890 --> 00:42:40,710
if we ignored you probably<font color="#E5E5E5"> have changed</font>

1142
00:42:34,920 --> 00:42:42,300
at uxc yeah I don't have the top one

1143
00:42:40,710 --> 00:42:44,220
that's fine you probably have<font color="#CCCCCC"> WBT you</font>

1144
00:42:42,300 --> 00:42:45,990
till you definitely have<font color="#E5E5E5"> services you</font>

1145
00:42:44,220 --> 00:42:47,189
probably<font color="#E5E5E5"> not have rotate logs right</font><font color="#CCCCCC"> the</font>

1146
00:42:45,990 --> 00:42:48,720
<font color="#CCCCCC">other thing that</font><font color="#E5E5E5"> you might want to do is</font>

1147
00:42:47,190 --> 00:42:51,360
you know if you're<font color="#E5E5E5"> working for yourself</font>

1148
00:42:48,720 --> 00:42:53,069
or for a customer is asked them for a

1149
00:42:51,360 --> 00:42:55,200
standard image from one of their builds

1150
00:42:53,070 --> 00:42:57,000
if they have it you can also use<font color="#E5E5E5"> that as</font>

1151
00:42:55,200 --> 00:43:00,899
a comparison as well to find out what's

1152
00:42:57,000 --> 00:43:04,620
abnormal but the key takeaway here is

1153
00:43:00,900 --> 00:43:06,240
actually<font color="#E5E5E5"> this file called</font><font color="#CCCCCC"> win host it</font>

1154
00:43:04,620 --> 00:43:08,490
looks really good but it's not it

1155
00:43:06,240 --> 00:43:09,660
doesn't belong<font color="#E5E5E5"> all right so if you</font>

1156
00:43:08,490 --> 00:43:12,149
googled win host you probably wouldn't

1157
00:43:09,660 --> 00:43:13,799
find too much about<font color="#CCCCCC"> it if you're doing</font>

1158
00:43:12,150 --> 00:43:15,330
some of your research if you look<font color="#E5E5E5"> at</font>

1159
00:43:13,800 --> 00:43:17,160
<font color="#E5E5E5">your own computer you definitely</font>

1160
00:43:15,330 --> 00:43:20,520
shouldn't have it should you<font color="#CCCCCC"> have it</font>

1161
00:43:17,160 --> 00:43:22,109
<font color="#E5E5E5">probably have problems haha alright so</font>

1162
00:43:20,520 --> 00:43:23,460
it's<font color="#E5E5E5"> not it's not easy to find it but if</font>

1163
00:43:22,110 --> 00:43:26,220
you<font color="#E5E5E5"> were doing some of these analysis</font>

1164
00:43:23,460 --> 00:43:28,020
steps you you probably spot it out so

1165
00:43:26,220 --> 00:43:29,669
again using I'm going to run again<font color="#E5E5E5"> I'm</font>

1166
00:43:28,020 --> 00:43:31,259
using the GUI application here to sort

1167
00:43:29,670 --> 00:43:32,640
of help me out we can see<font color="#E5E5E5"> that</font><font color="#CCCCCC"> Windows</font>

1168
00:43:31,260 --> 00:43:35,220
is actually set<font color="#CCCCCC"> up down here at the</font>

1169
00:43:32,640 --> 00:43:36,480
bottom as a service or<font color="#E5E5E5"> the search things</font>

1170
00:43:35,220 --> 00:43:40,350
down but as a server should take my word

1171
00:43:36,480 --> 00:43:41,550
for it but<font color="#CCCCCC"> this file not found</font><font color="#E5E5E5"> right so</font>

1172
00:43:40,350 --> 00:43:43,830
i can<font color="#CCCCCC"> meet a couple of different things</font>

1173
00:43:41,550 --> 00:43:45,900
but<font color="#CCCCCC"> i know what the service and so i</font><font color="#E5E5E5"> can</font>

1174
00:43:43,830 --> 00:43:47,190
<font color="#CCCCCC">look at the event logs right for a 7045</font>

1175
00:43:45,900 --> 00:43:50,010
events to get my time and when it

1176
00:43:47,190 --> 00:43:51,330
started to help my timeline analysis but

1177
00:43:50,010 --> 00:43:53,610
<font color="#CCCCCC">i can also look in the registry where</font>

1178
00:43:51,330 --> 00:43:55,799
services are stored to see when that was

1179
00:43:53,610 --> 00:43:57,360
created as well so if i do that<font color="#E5E5E5"> what I</font>

1180
00:43:55,800 --> 00:43:59,280
see here is<font color="#E5E5E5"> that there is win host in</font>

1181
00:43:57,360 --> 00:44:02,490
there it has a date modified time of

1182
00:43:59,280 --> 00:44:03,960
somewhere in 2015 right that's<font color="#E5E5E5"> probably</font>

1183
00:44:02,490 --> 00:44:08,879
<font color="#E5E5E5">the most likely time it originated on</font>

1184
00:44:03,960 --> 00:44:11,550
the system all right and one thing<font color="#E5E5E5"> why</font>

1185
00:44:08,880 --> 00:44:13,470
this when you go back one when<font color="#E5E5E5"> you when</font>

1186
00:44:11,550 --> 00:44:15,600
you<font color="#E5E5E5"> look at windows and says file not</font>

1187
00:44:13,470 --> 00:44:17,549
found that's actually because of how I

1188
00:44:15,600 --> 00:44:20,130
runs a sort of programmed but if you

1189
00:44:17,550 --> 00:44:22,290
look up here in while 64 value and it

1190
00:44:20,130 --> 00:44:24,420
says one that's because it's an assist

1191
00:44:22,290 --> 00:44:25,680
while 64 path so that's what our one

1192
00:44:24,420 --> 00:44:27,690
says it can't find it<font color="#E5E5E5"> even though it</font>

1193
00:44:25,680 --> 00:44:30,089
<font color="#E5E5E5">does exist on the system because it's in</font>

1194
00:44:27,690 --> 00:44:34,860
<font color="#CCCCCC">the while sixty four folder</font>

1195
00:44:30,090 --> 00:44:37,140
she even<font color="#E5E5E5"> put that on there well no</font>

1196
00:44:34,860 --> 00:44:38,580
<font color="#CCCCCC">cheating so again going back to</font><font color="#E5E5E5"> our</font>

1197
00:44:37,140 --> 00:44:40,740
<font color="#E5E5E5">system event log this is hoping that</font>

1198
00:44:38,580 --> 00:44:43,380
they haven't<font color="#CCCCCC"> been cleaned or white you</font>

1199
00:44:40,740 --> 00:44:45,180
<font color="#CCCCCC">can see here the 7045 is an idea service</font>

1200
00:44:43,380 --> 00:44:47,430
was installed here's<font color="#E5E5E5"> the service path</font>

1201
00:44:45,180 --> 00:44:50,100
and the service<font color="#CCCCCC"> filename and every time</font>

1202
00:44:47,430 --> 00:44:51,569
<font color="#E5E5E5">that</font><font color="#CCCCCC"> it started okay so we had a pretty</font>

1203
00:44:50,100 --> 00:44:54,029
good idea we know the time that<font color="#E5E5E5"> I got on</font>

1204
00:44:51,570 --> 00:44:55,740
there we know how<font color="#CCCCCC"> many times it's ran we</font>

1205
00:44:54,030 --> 00:44:57,900
<font color="#E5E5E5">don't know how it got on there so</font>

1206
00:44:55,740 --> 00:45:03,149
luckily for us the process<font color="#E5E5E5"> audit logs</font>

1207
00:44:57,900 --> 00:45:04,440
are enabled alright so let's sort of use

1208
00:45:03,150 --> 00:45:05,940
this a little bit and<font color="#E5E5E5"> i know i didn't go</font>

1209
00:45:04,440 --> 00:45:08,280
to death about process sodding but it's

1210
00:45:05,940 --> 00:45:11,370
relatively easy to follow right so we

1211
00:45:08,280 --> 00:45:15,030
can see the login ID right which<font color="#CCCCCC"> is the</font>

1212
00:45:11,370 --> 00:45:17,400
<font color="#CCCCCC">3e seven if you count name the process</font>

1213
00:45:15,030 --> 00:45:19,500
ID which is services<font color="#CCCCCC"> alright so make</font>

1214
00:45:17,400 --> 00:45:21,810
sure your login ID you track those<font color="#E5E5E5"> as</font>

1215
00:45:19,500 --> 00:45:23,940
one log on so you<font color="#E5E5E5"> can see services is</font>

1216
00:45:21,810 --> 00:45:25,440
starting windows so it's definitely a

1217
00:45:23,940 --> 00:45:28,200
service is what we're seeing here right

1218
00:45:25,440 --> 00:45:29,610
well again how did windows get on the

1219
00:45:28,200 --> 00:45:31,259
box right I think<font color="#E5E5E5"> that's my militia</font>

1220
00:45:29,610 --> 00:45:34,560
service we need to do a little bit<font color="#E5E5E5"> more</font>

1221
00:45:31,260 --> 00:45:35,520
digging from so<font color="#CCCCCC"> I actually cut out one</font>

1222
00:45:34,560 --> 00:45:37,500
of these slides<font color="#E5E5E5"> make it a little easier</font>

1223
00:45:35,520 --> 00:45:40,380
lodge a timeline or plateau would do

1224
00:45:37,500 --> 00:45:41,850
this<font color="#CCCCCC"> for you</font><font color="#E5E5E5"> or x-rays right to build</font>

1225
00:45:40,380 --> 00:45:44,190
this timeline so you can see here the

1226
00:45:41,850 --> 00:45:46,230
account log on about IT admin one it's

1227
00:45:44,190 --> 00:45:48,540
an administrator account the logmein

1228
00:45:46,230 --> 00:45:50,580
process is started if you can't see the

1229
00:45:48,540 --> 00:45:52,800
<font color="#E5E5E5">c program files log me in all right</font>

1230
00:45:50,580 --> 00:45:55,170
command excuse quickly started after

1231
00:45:52,800 --> 00:45:56,670
that we also have w script<font color="#E5E5E5"> and then Sh</font>

1232
00:45:55,170 --> 00:45:59,310
and then also down here at the bottom

1233
00:45:56,670 --> 00:46:03,330
right<font color="#CCCCCC"> is the IT admin one at that</font><font color="#E5E5E5"> or</font>

1234
00:45:59,310 --> 00:46:06,570
roaming update exe that's<font color="#E5E5E5"> also a little</font>

1235
00:46:03,330 --> 00:46:07,950
<font color="#CCCCCC">bit odd right update is key and the</font>

1236
00:46:06,570 --> 00:46:09,870
appdata roaming<font color="#E5E5E5"> file is a bit strange</font>

1237
00:46:07,950 --> 00:46:12,450
and executable<font color="#CCCCCC"> Xin there should you</font>

1238
00:46:09,870 --> 00:46:14,160
should probably examine all right so

1239
00:46:12,450 --> 00:46:16,020
again following like the<font color="#E5E5E5"> process ID with</font>

1240
00:46:14,160 --> 00:46:19,319
16 bc here if you<font color="#E5E5E5"> wanted to fall out</font>

1241
00:46:16,020 --> 00:46:22,410
around so you can<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> update desi</font>

1242
00:46:19,320 --> 00:46:23,880
then starts svchost right which is<font color="#E5E5E5"> also</font>

1243
00:46:22,410 --> 00:46:26,819
weird then all of a<font color="#CCCCCC"> sudden a new service</font>

1244
00:46:23,880 --> 00:46:28,320
gets created window starts right which

1245
00:46:26,820 --> 00:46:30,990
is windows then starts another instance

1246
00:46:28,320 --> 00:46:33,150
of svchost what's really happening there

1247
00:46:30,990 --> 00:46:34,620
is what we call code injection the

1248
00:46:33,150 --> 00:46:36,870
windows process is actually injecting

1249
00:46:34,620 --> 00:46:37,920
some of its code into that process so

1250
00:46:36,870 --> 00:46:39,299
<font color="#E5E5E5">you can sort of follow this all the way</font>

1251
00:46:37,920 --> 00:46:41,130
down<font color="#CCCCCC"> and see how it got on there the</font>

1252
00:46:39,300 --> 00:46:43,310
point of this time line is we can

1253
00:46:41,130 --> 00:46:45,500
pinpoint it back to the update exe file

1254
00:46:43,310 --> 00:46:46,610
which came from a log me in so that

1255
00:46:45,500 --> 00:46:49,910
tells me I need to<font color="#E5E5E5"> go look at the</font>

1256
00:46:46,610 --> 00:46:51,650
logmein logs so if<font color="#CCCCCC"> I go find the logmein</font>

1257
00:46:49,910 --> 00:46:52,879
laws which are local to that host or

1258
00:46:51,650 --> 00:46:53,900
sometimes there may be a<font color="#E5E5E5"> central</font>

1259
00:46:52,880 --> 00:46:58,190
repository within that environment

1260
00:46:53,900 --> 00:47:00,830
looking at that time 2015 I can see<font color="#E5E5E5"> that</font>

1261
00:46:58,190 --> 00:47:04,580
this 122 IP which belongs to somewhere

1262
00:47:00,830 --> 00:47:06,410
<font color="#CCCCCC">says IP vanish Oh from Russia logged in</font>

1263
00:47:04,580 --> 00:47:10,460
right before the update exe file was

1264
00:47:06,410 --> 00:47:13,730
<font color="#E5E5E5">processed was created</font><font color="#CCCCCC"> alright so if this</font>

1265
00:47:10,460 --> 00:47:15,800
<font color="#CCCCCC">system is located in</font><font color="#E5E5E5"> California and</font>

1266
00:47:13,730 --> 00:47:17,030
their IT staff is also local still my

1267
00:47:15,800 --> 00:47:21,110
logging in from Russia is probably not a

1268
00:47:17,030 --> 00:47:22,250
good sign right makes sense so I did

1269
00:47:21,110 --> 00:47:23,780
down here<font color="#CCCCCC"> in the bottom right is I</font>

1270
00:47:22,250 --> 00:47:25,400
actually use grep the parched out all

1271
00:47:23,780 --> 00:47:27,350
the logmein logs and<font color="#CCCCCC"> i created a</font><font color="#E5E5E5"> pivot</font>

1272
00:47:25,400 --> 00:47:29,360
table to kind of put all the IPS and one

1273
00:47:27,350 --> 00:47:32,540
space to<font color="#E5E5E5"> figure out which one like an</font>

1274
00:47:29,360 --> 00:47:34,790
oddity to me it did help out too much to

1275
00:47:32,540 --> 00:47:37,100
be<font color="#E5E5E5"> quite honest the 122 had the most</font>

1276
00:47:34,790 --> 00:47:39,020
connections which was they were logging

1277
00:47:37,100 --> 00:47:43,490
in a lot so from that whole

1278
00:47:39,020 --> 00:47:45,860
investigation we went from system

1279
00:47:43,490 --> 00:47:47,959
<font color="#CCCCCC">accessed via logmein mal was created and</font>

1280
00:47:45,860 --> 00:47:51,080
executed on the system installed as the

1281
00:47:47,960 --> 00:47:53,810
service existed on there for over a year

1282
00:47:51,080 --> 00:47:57,680
technically for this one it continues to

1283
00:47:53,810 --> 00:48:01,400
run until someone finds it<font color="#E5E5E5"> alright so we</font>

1284
00:47:57,680 --> 00:48:06,049
solved it<font color="#E5E5E5"> in like five minutes alright</font>

1285
00:48:01,400 --> 00:48:07,700
so this sort of<font color="#E5E5E5"> like the end I</font><font color="#CCCCCC"> think I'm</font>

1286
00:48:06,050 --> 00:48:09,200
right on<font color="#CCCCCC"> time there so I just want to</font>

1287
00:48:07,700 --> 00:48:11,689
open up<font color="#E5E5E5"> the CEO a little woman and over</font>

1288
00:48:09,200 --> 00:48:16,549
there's any questions comments concerns

1289
00:48:11,690 --> 00:48:22,610
<font color="#E5E5E5">no so at least like educational or</font>

1290
00:48:16,550 --> 00:48:25,190
anything yeah yes back you up oh good

1291
00:48:22,610 --> 00:48:26,600
okay<font color="#CCCCCC"> well</font><font color="#E5E5E5"> alright if you guys want the</font>

1292
00:48:25,190 --> 00:48:29,710
slides just let me know<font color="#E5E5E5"> I'm not going to</font>

1293
00:48:26,600 --> 00:48:29,710
get them to<font color="#E5E5E5"> you till Monday to be honest</font>

1294
00:48:29,980 --> 00:48:41,440
look so the<font color="#CCCCCC"> question was who did</font><font color="#E5E5E5"> we get</font>

1295
00:48:40,060 --> 00:48:43,600
requests from for doing the

1296
00:48:41,440 --> 00:48:45,250
investigation that's a<font color="#E5E5E5"> great question so</font>

1297
00:48:43,600 --> 00:48:47,259
again we're over talk that they have a

1298
00:48:45,250 --> 00:48:49,180
contract with the card brands well the

1299
00:48:47,260 --> 00:48:51,220
car brands force the retailer to do the

1300
00:48:49,180 --> 00:48:54,520
investigation so the retailer pays for

1301
00:48:51,220 --> 00:48:56,589
the investigations but we report to the

1302
00:48:54,520 --> 00:48:57,759
car<font color="#CCCCCC"> brand so it's for you in the</font>

1303
00:48:56,590 --> 00:49:02,290
<font color="#E5E5E5">business taking cards make sure you</font>

1304
00:48:57,760 --> 00:49:12,100
review those contracts<font color="#E5E5E5"> oh so if you like</font>

1305
00:49:02,290 --> 00:49:13,060
thanks<font color="#E5E5E5"> everybody yeah we've done a</font>

1306
00:49:12,100 --> 00:49:16,540
couple 18 ones but they're very

1307
00:49:13,060 --> 00:49:18,040
<font color="#CCCCCC">different most of the murder</font><font color="#E5E5E5"> they're</font>

1308
00:49:16,540 --> 00:49:18,970
most of their windows systems but the

1309
00:49:18,040 --> 00:49:21,460
Malheur operates a little bit

1310
00:49:18,970 --> 00:49:24,009
differently I think mainly just put out

1311
00:49:21,460 --> 00:49:32,859
a post on I'm<font color="#E5E5E5"> like a new variant they</font>

1312
00:49:24,010 --> 00:49:34,720
just had I think they generally have a

1313
00:49:32,859 --> 00:49:36,220
command from a consensual system to spit

1314
00:49:34,720 --> 00:49:37,299
out money at a certain time so it's not

1315
00:49:36,220 --> 00:49:39,100
unless<font color="#E5E5E5"> you're looking for car data</font>

1316
00:49:37,300 --> 00:49:40,750
they're more of like spitting out money

1317
00:49:39,100 --> 00:49:43,150
for she's looking for<font color="#CCCCCC"> card</font><font color="#E5E5E5"> in my</font>

1318
00:49:40,750 --> 00:49:44,290
experience that's<font color="#E5E5E5"> not always the case so</font>

1319
00:49:43,150 --> 00:49:46,330
like they have what do<font color="#E5E5E5"> they call them</font>

1320
00:49:44,290 --> 00:49:48,220
like mules money meals that will spit

1321
00:49:46,330 --> 00:49:50,830
out it would read the report it came out

1322
00:49:48,220 --> 00:49:52,779
last year in like carbon ack because

1323
00:49:50,830 --> 00:49:54,910
first you put it out so carbon<font color="#E5E5E5"> act was a</font>

1324
00:49:52,780 --> 00:49:55,869
pretty big incident where they're in a

1325
00:49:54,910 --> 00:49:56,890
bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different banks and</font>

1326
00:49:55,869 --> 00:49:58,180
additionally at a certain time they

1327
00:49:56,890 --> 00:50:00,250
would<font color="#E5E5E5"> have the money will go to all the</font>

1328
00:49:58,180 --> 00:50:02,799
<font color="#CCCCCC">atms they tell them our to spit out all</font>

1329
00:50:00,250 --> 00:50:04,900
the money at the ATM so then<font color="#E5E5E5"> they'd get</font>

1330
00:50:02,800 --> 00:50:09,100
all the money if you haven't read it

1331
00:50:04,900 --> 00:50:10,780
from my think 7 and 16 it's kind of

1332
00:50:09,100 --> 00:50:14,170
<font color="#CCCCCC">carbonek</font><font color="#E5E5E5"> apt just google it it's like</font>

1333
00:50:10,780 --> 00:50:17,850
one of the top links in there but uh I

1334
00:50:14,170 --> 00:50:17,850
have to go<font color="#CCCCCC"> now</font>

