1
00:00:00,000 --> 00:00:04,019
good all right I<font color="#E5E5E5"> don't have a clicker so</font>

2
00:00:02,790 --> 00:00:06,029
I'm going<font color="#E5E5E5"> to have to awkwardly walk over</font>

3
00:00:04,019 --> 00:00:07,740
to my laptop every once in a while but

4
00:00:06,029 --> 00:00:10,019
i'm here today to talk to<font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys about</font>

5
00:00:07,740 --> 00:00:13,230
deleted evidence and more importantly

6
00:00:10,019 --> 00:00:15,450
evidence of deleted files and things<font color="#CCCCCC"> i</font>

7
00:00:13,230 --> 00:00:17,160
guess that's a little more accurate and

8
00:00:15,450 --> 00:00:19,050
and we're going<font color="#CCCCCC"> to go on this journey</font>

9
00:00:17,160 --> 00:00:23,640
together to fill in the map to Luke

10
00:00:19,050 --> 00:00:25,500
Skywalker it you may pick up on the

11
00:00:23,640 --> 00:00:28,859
theme of this talk<font color="#E5E5E5"> I'd also like to</font>

12
00:00:25,500 --> 00:00:31,170
thank you<font color="#CCCCCC"> all for being here because 2</font>

13
00:00:28,859 --> 00:00:32,880
of 11 there were four people here so I'd

14
00:00:31,170 --> 00:00:34,200
like<font color="#CCCCCC"> to give those people a big</font>

15
00:00:32,880 --> 00:00:35,850
<font color="#CCCCCC">shout-out for sticking through it and</font>

16
00:00:34,200 --> 00:00:41,730
then the rest of<font color="#E5E5E5"> you came in late I love</font>

17
00:00:35,850 --> 00:00:43,469
you<font color="#CCCCCC"> too so Who am I I'm Dave panty i'm</font>

18
00:00:41,730 --> 00:00:45,839
going to senior consultant at mandiant a

19
00:00:43,469 --> 00:00:48,450
<font color="#E5E5E5">fire I company i graduated from</font>

20
00:00:45,840 --> 00:00:51,629
bloomsburg in 2013<font color="#CCCCCC"> i do forensics for</font>

21
00:00:48,450 --> 00:00:53,910
the big apt financial cases i like to

22
00:00:51,629 --> 00:00:55,199
call it espionage and whatever that

23
00:00:53,910 --> 00:00:57,898
sounds fun but I've<font color="#E5E5E5"> done a couple need</font>

24
00:00:55,199 --> 00:01:00,839
cases like that<font color="#E5E5E5"> healthcare I like Python</font>

25
00:00:57,899 --> 00:01:03,629
I'm<font color="#E5E5E5"> not a not a coder I'm not a good</font>

26
00:01:00,840 --> 00:01:05,909
coder i right terrible code but my goal

27
00:01:03,629 --> 00:01:07,200
is easy to use<font color="#E5E5E5"> so on your end you think</font>

28
00:01:05,909 --> 00:01:10,619
it's good code even though it's<font color="#E5E5E5"> really</font>

29
00:01:07,200 --> 00:01:12,150
terrible that's all I care about yes<font color="#CCCCCC"> I</font>

30
00:01:10,619 --> 00:01:16,110
do work for fire who was at the<font color="#CCCCCC"> kino</font>

31
00:01:12,150 --> 00:01:19,950
earlier yeah fire I big money drive

32
00:01:16,110 --> 00:01:22,500
fancy cars i drive a kia so it's a nice

33
00:01:19,950 --> 00:01:24,930
kia but let's<font color="#CCCCCC"> i just want to</font><font color="#E5E5E5"> you know</font>

34
00:01:22,500 --> 00:01:26,610
set the stereotype straight that the

35
00:01:24,930 --> 00:01:29,070
sales guys have the big money as

36
00:01:26,610 --> 00:01:31,619
consultants we just do the work and then

37
00:01:29,070 --> 00:01:36,149
they<font color="#E5E5E5"> get all the money we're going to</font>

38
00:01:31,619 --> 00:01:38,540
switch<font color="#CCCCCC"> okay going to change here one</font>

39
00:01:36,150 --> 00:01:38,540
second

40
00:01:52,850 --> 00:02:05,449
you guys hear me is it on son<font color="#E5E5E5"> okay great</font>

41
00:02:02,240 --> 00:02:06,949
thank you<font color="#CCCCCC"> so much so I bet you guys you</font>

42
00:02:05,450 --> 00:02:08,750
know<font color="#E5E5E5"> wanted to</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> the behind</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> scenes</font>

43
00:02:06,950 --> 00:02:10,880
bloom con DVD that's coming out later

44
00:02:08,750 --> 00:02:13,910
you<font color="#CCCCCC"> just saw it happen this is you know</font>

45
00:02:10,880 --> 00:02:15,590
real life going on<font color="#E5E5E5"> right now so I'm Dave</font>

46
00:02:13,910 --> 00:02:18,650
I'd also like to<font color="#E5E5E5"> give a</font><font color="#CCCCCC"> shout-out to</font>

47
00:02:15,590 --> 00:02:20,330
marry sing my co-worker who co-wrote

48
00:02:18,650 --> 00:02:22,250
this presentation with me and I

49
00:02:20,330 --> 00:02:25,730
presented with her before she's not here

50
00:02:22,250 --> 00:02:28,459
today but<font color="#E5E5E5"> I'd like to thank her for for</font>

51
00:02:25,730 --> 00:02:29,840
all the hard work she put into this so

52
00:02:28,459 --> 00:02:32,239
we're going<font color="#E5E5E5"> to talk about you know</font>

53
00:02:29,840 --> 00:02:34,280
attackers create files bad guys create

54
00:02:32,239 --> 00:02:35,480
files they also delete some files

55
00:02:34,280 --> 00:02:36,739
sometimes I hear<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of talks and</font>

56
00:02:35,480 --> 00:02:38,660
that's why<font color="#CCCCCC"> we have jobs right the</font>

57
00:02:36,739 --> 00:02:39,950
attackers don't like to leave their

58
00:02:38,660 --> 00:02:41,930
stuff around so we have to try<font color="#CCCCCC"> and find</font>

59
00:02:39,950 --> 00:02:44,209
what they they left or hanging around

60
00:02:41,930 --> 00:02:46,580
inadvertently<font color="#E5E5E5"> we'll talk about the</font>

61
00:02:44,209 --> 00:02:48,080
artifacts that get created just because

62
00:02:46,580 --> 00:02:50,569
the file exists or just because he gets

63
00:02:48,080 --> 00:02:54,290
created so we're<font color="#E5E5E5"> going to talk about</font>

64
00:02:50,569 --> 00:02:57,738
artifacts that get created when a user

65
00:02:54,290 --> 00:02:59,060
or an attacker accesses a file execute

66
00:02:57,739 --> 00:03:02,150
the file maybe some other application

67
00:02:59,060 --> 00:03:03,799
accesses a file like antivirus some

68
00:03:02,150 --> 00:03:06,320
built in windows stuff that'll be pretty

69
00:03:03,799 --> 00:03:07,880
cool so a lot of these artifacts may be

70
00:03:06,320 --> 00:03:10,640
hanging around and you'll be able to

71
00:03:07,880 --> 00:03:12,320
<font color="#E5E5E5">find them to you know show yes this file</font>

72
00:03:10,640 --> 00:03:14,750
did exist on the system we<font color="#CCCCCC"> just how to</font>

73
00:03:12,320 --> 00:03:16,340
talk before that mentioned you<font color="#CCCCCC"> know what</font>

74
00:03:14,750 --> 00:03:18,890
about shell bags that's<font color="#E5E5E5"> a great example</font>

75
00:03:16,340 --> 00:03:20,150
of a file that's no longer there but you

76
00:03:18,890 --> 00:03:22,850
have<font color="#CCCCCC"> evidence of it these are some other</font>

77
00:03:20,150 --> 00:03:24,290
cool tactics no shell bags in my talk I

78
00:03:22,850 --> 00:03:32,358
apologize if<font color="#CCCCCC"> you just really love she'll</font>

79
00:03:24,290 --> 00:03:35,630
beg<font color="#E5E5E5"> okay so you know why would a file be</font>

80
00:03:32,359 --> 00:03:37,250
deleted I have an<font color="#E5E5E5"> interesting</font>

81
00:03:35,630 --> 00:03:39,620
perspective I know a lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> lot of</font>

82
00:03:37,250 --> 00:03:40,880
<font color="#E5E5E5">students at</font><font color="#CCCCCC"> Bloomsburg you know they</font>

83
00:03:39,620 --> 00:03:43,160
want to graduate and work in law

84
00:03:40,880 --> 00:03:44,780
enforcement where it's a user I'll tend

85
00:03:43,160 --> 00:03:46,880
to<font color="#E5E5E5"> use the word attacker because that's</font>

86
00:03:44,780 --> 00:03:47,989
how we describe it it's like you know

87
00:03:46,880 --> 00:03:50,000
some guy coming in your<font color="#E5E5E5"> career with a</font>

88
00:03:47,989 --> 00:03:51,290
knife that's that's what I was scared to

89
00:03:50,000 --> 00:03:53,299
say at a crapper that's what I thought

90
00:03:51,290 --> 00:03:55,280
<font color="#E5E5E5">everyone's</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> picture but it's you</font>

91
00:03:53,299 --> 00:03:56,569
know Russia China whoever i don't know i

92
00:03:55,280 --> 00:03:58,190
just find what they did I don't

93
00:03:56,569 --> 00:04:01,310
determine who did it that's a whole

94
00:03:58,190 --> 00:04:04,190
other department but bad guys will like

95
00:04:01,310 --> 00:04:06,109
to say if they're installing malware or

96
00:04:04,190 --> 00:04:06,770
virus they don't want<font color="#CCCCCC"> that to hang out</font>

97
00:04:06,109 --> 00:04:08,060
<font color="#E5E5E5">there forever</font>

98
00:04:06,770 --> 00:04:09,890
<font color="#E5E5E5">defined so they may tell the virus to</font>

99
00:04:08,060 --> 00:04:11,450
uninstall or delete itself so it's

100
00:04:09,890 --> 00:04:12,589
harder to find they'll say hey I'm

101
00:04:11,450 --> 00:04:13,820
probably going to be done this in a week

102
00:04:12,590 --> 00:04:16,190
so<font color="#CCCCCC"> let's use it for a week and then it</font>

103
00:04:13,820 --> 00:04:17,659
will blow itself up no<font color="#E5E5E5"> problem the</font>

104
00:04:16,190 --> 00:04:19,339
attacker will manually delete their

105
00:04:17,660 --> 00:04:23,150
files they may just<font color="#CCCCCC"> be on</font><font color="#E5E5E5"> the command</font>

106
00:04:19,339 --> 00:04:24,919
line you know through a back door or if

107
00:04:23,150 --> 00:04:27,020
they're on linux OBS<font color="#CCCCCC"> SSH into a system</font>

108
00:04:24,920 --> 00:04:28,970
or something<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> wanted Elka man</font>

109
00:04:27,020 --> 00:04:30,740
that's no problem if they're<font color="#CCCCCC"> on the</font>

110
00:04:28,970 --> 00:04:34,100
system through through rdp anyone

111
00:04:30,740 --> 00:04:37,310
familiar with rdp so r dt is just like

112
00:04:34,100 --> 00:04:39,260
logging on to a computer over the

113
00:04:37,310 --> 00:04:41,240
network you have<font color="#E5E5E5"> the full desktop and</font>

114
00:04:39,260 --> 00:04:43,039
you can click and<font color="#CCCCCC"> drag and drop and all</font>

115
00:04:41,240 --> 00:04:44,990
that fun stuff if you delete something

116
00:04:43,040 --> 00:04:46,940
that way a good chance to get going<font color="#E5E5E5"> to</font>

117
00:04:44,990 --> 00:04:48,590
the recycle bin if they you know don't

118
00:04:46,940 --> 00:04:50,540
permanently delete it with a ship delete

119
00:04:48,590 --> 00:04:52,280
or something so<font color="#E5E5E5"> you may want to check</font>

120
00:04:50,540 --> 00:04:54,320
your recycle bin and<font color="#E5E5E5"> you'll be part of</font>

121
00:04:52,280 --> 00:04:56,210
the info to and using<font color="#E5E5E5"> refuse all that</font>

122
00:04:54,320 --> 00:04:57,980
good stuff that you you'll learn here

123
00:04:56,210 --> 00:04:59,750
but there<font color="#E5E5E5"> are different ways that</font>

124
00:04:57,980 --> 00:05:04,010
attackers can manually delete files

125
00:04:59,750 --> 00:05:06,050
another big one is antivirus everybody

126
00:05:04,010 --> 00:05:08,240
loves antivirus some people say<font color="#E5E5E5"> MF iris</font>

127
00:05:06,050 --> 00:05:10,250
is dead<font color="#E5E5E5"> I say long live antivirus it's</font>

128
00:05:08,240 --> 00:05:12,020
probably going to be around even if it

129
00:05:10,250 --> 00:05:14,900
transforms into next next next

130
00:05:12,020 --> 00:05:16,969
generation antivirus and get super deep

131
00:05:14,900 --> 00:05:18,950
learning machine computer algorithms I'm

132
00:05:16,970 --> 00:05:20,810
not<font color="#E5E5E5"> sure what it's going to do but</font>

133
00:05:18,950 --> 00:05:23,990
antivirus does some really great things

134
00:05:20,810 --> 00:05:25,610
that<font color="#E5E5E5"> we'll talk about later and also</font>

135
00:05:23,990 --> 00:05:28,610
anyone know what happens if antivirus

136
00:05:25,610 --> 00:05:31,820
doesn't delete a file it may do

137
00:05:28,610 --> 00:05:34,550
something else quarantine a file yeah so

138
00:05:31,820 --> 00:05:36,740
it will you know encrypt that file or

139
00:05:34,550 --> 00:05:38,750
encode or something in a way that it's

140
00:05:36,740 --> 00:05:40,850
not deleted so you can still try<font color="#CCCCCC"> and</font>

141
00:05:38,750 --> 00:05:42,140
recover it do you know how to decrypt it

142
00:05:40,850 --> 00:05:43,280
or decode it that's a<font color="#CCCCCC"> whole door</font>

143
00:05:42,140 --> 00:05:44,330
question every end of our<font color="#E5E5E5"> so is it</font>

144
00:05:43,280 --> 00:05:46,880
differently sometimes it's easy

145
00:05:44,330 --> 00:05:49,880
sometimes it's not but that's<font color="#E5E5E5"> something</font>

146
00:05:46,880 --> 00:05:51,590
<font color="#E5E5E5">that can be</font><font color="#CCCCCC"> useful and you know we have</font>

147
00:05:49,880 --> 00:05:53,419
attackers<font color="#CCCCCC"> in our red team mint and</font>

148
00:05:51,590 --> 00:05:55,609
hacker guys they'll go in and if their

149
00:05:53,419 --> 00:05:57,020
tool gets picked up by a nevar so let's

150
00:05:55,610 --> 00:05:58,850
<font color="#E5E5E5">just pop out another version they'll try</font>

151
00:05:57,020 --> 00:06:00,409
different encoding still do some

152
00:05:58,850 --> 00:06:02,360
obfuscation to try and get<font color="#CCCCCC"> around that</font>

153
00:06:00,410 --> 00:06:05,030
antivirus and they'll keep going until

154
00:06:02,360 --> 00:06:08,570
work sometimes so that's why files get

155
00:06:05,030 --> 00:06:10,250
deleted and how they get deleted if you

156
00:06:08,570 --> 00:06:12,710
didn't<font color="#CCCCCC"> notice my slide transitions are</font>

157
00:06:10,250 --> 00:06:16,820
very<font color="#CCCCCC"> particular about why they're</font><font color="#E5E5E5"> those</font>

158
00:06:12,710 --> 00:06:19,070
ways so just a little easter egg so can

159
00:06:16,820 --> 00:06:19,969
you recover deleted files<font color="#CCCCCC"> I remember</font>

160
00:06:19,070 --> 00:06:22,879
back

161
00:06:19,969 --> 00:06:24,889
the day when I came<font color="#E5E5E5"> to bloomsburg I was</font>

162
00:06:22,879 --> 00:06:27,079
<font color="#E5E5E5">sitting in Ben Franklin Garrett was</font>

163
00:06:24,889 --> 00:06:28,969
there with me and one<font color="#CCCCCC"> of the students</font>

164
00:06:27,079 --> 00:06:31,069
deleted a file on a flash drive or a

165
00:06:28,969 --> 00:06:33,889
floppy disk said look it's gone<font color="#CCCCCC"> and then</font>

166
00:06:31,069 --> 00:06:36,169
opened it up an<font color="#E5E5E5"> H XD and found it that</font>

167
00:06:33,889 --> 00:06:38,809
blew my mind that's when I decided to

168
00:06:36,169 --> 00:06:40,998
come here it's like a really simple

169
00:06:38,809 --> 00:06:43,339
story but it means a lot<font color="#E5E5E5"> to me but the</font>

170
00:06:40,999 --> 00:06:45,199
whole<font color="#CCCCCC"> point is yes deleted files can be</font>

171
00:06:43,339 --> 00:06:46,909
recovered that's why we have work here

172
00:06:45,199 --> 00:06:48,799
that's you know looking for artifacts

173
00:06:46,909 --> 00:06:50,360
and hopefully we can get the files but

174
00:06:48,799 --> 00:06:52,399
it's going<font color="#E5E5E5"> to depend right how was that</font>

175
00:06:50,360 --> 00:06:54,079
file deleted was it shift delete it or

176
00:06:52,399 --> 00:06:55,309
was it sent to the recycle bin recycle

177
00:06:54,079 --> 00:06:57,559
bin is going to be a<font color="#E5E5E5"> little easier to</font>

178
00:06:55,309 --> 00:06:59,209
delete you know if you shift delete a

179
00:06:57,559 --> 00:07:01,369
file it won't go<font color="#E5E5E5"> to recycle bin you'll</font>

180
00:06:59,209 --> 00:07:03,589
have to carve that out or find the MFG

181
00:07:01,369 --> 00:07:05,269
record yourself up for the<font color="#CCCCCC"> data run I'm</font>

182
00:07:03,589 --> 00:07:07,789
do a little bit more manual approach

183
00:07:05,269 --> 00:07:10,039
that's going to depend on how<font color="#CCCCCC"> much</font>

184
00:07:07,789 --> 00:07:11,899
activity is going on on<font color="#CCCCCC"> that set that</font>

185
00:07:10,039 --> 00:07:13,969
driver that volume if it's an operating

186
00:07:11,899 --> 00:07:15,319
system volume lots of other files are

187
00:07:13,969 --> 00:07:18,229
going to be<font color="#E5E5E5"> over writing the unallocated</font>

188
00:07:15,319 --> 00:07:20,569
space it's more likely than not or you

189
00:07:18,229 --> 00:07:22,008
know than on other systems that that

190
00:07:20,569 --> 00:07:23,659
file<font color="#CCCCCC"> in unallocated</font><font color="#E5E5E5"> space will be</font>

191
00:07:22,009 --> 00:07:25,759
overwritten you'll be able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get chunks</font>

192
00:07:23,659 --> 00:07:27,860
of it fragments I'm just going to depend

193
00:07:25,759 --> 00:07:29,929
on<font color="#E5E5E5"> your discard where's is just very</font>

194
00:07:27,860 --> 00:07:31,069
<font color="#CCCCCC">small or</font><font color="#E5E5E5"> full it's not that on allocated</font>

195
00:07:29,929 --> 00:07:33,529
space is going to be circled through

196
00:07:31,069 --> 00:07:34,939
more frequently if it's solid state it's

197
00:07:33,529 --> 00:07:36,259
going to do we're leveling and all kinds

198
00:07:34,939 --> 00:07:38,809
of fragmentation might make it<font color="#CCCCCC"> more</font>

199
00:07:36,259 --> 00:07:41,119
tricky so there's a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> it's an art</font>

200
00:07:38,809 --> 00:07:42,679
and a science combined so there's a lot

201
00:07:41,119 --> 00:07:45,469
<font color="#CCCCCC">of factors sometimes you can get it</font>

202
00:07:42,679 --> 00:07:49,279
sometimes you can but if you can't

203
00:07:45,469 --> 00:07:51,229
recover file which in my day job we

204
00:07:49,279 --> 00:07:52,849
rarely attackers are getting really<font color="#E5E5E5"> good</font>

205
00:07:51,229 --> 00:07:54,739
at deleting their files and cleaning up

206
00:07:52,849 --> 00:07:56,389
with anti forensic techniques we rarely

207
00:07:54,739 --> 00:07:59,179
get to recover files unless we get lucky

208
00:07:56,389 --> 00:08:00,649
sometimes these days but we find all

209
00:07:59,179 --> 00:08:01,638
kinds of other artifacts that we're

210
00:08:00,649 --> 00:08:04,189
going<font color="#E5E5E5"> to talk about that show you that a</font>

211
00:08:01,639 --> 00:08:05,869
file was present on the system and if

212
00:08:04,189 --> 00:08:07,339
we're really lucky some artifact to even

213
00:08:05,869 --> 00:08:08,989
record a hash value of that files

214
00:08:07,339 --> 00:08:16,579
anybody know why a hash value would be

215
00:08:08,989 --> 00:08:18,739
important what's that<font color="#E5E5E5"> I also like to</font>

216
00:08:16,579 --> 00:08:22,669
offend a assigned to keep what that file

217
00:08:18,739 --> 00:08:24,709
was exactly so if we um if we find it at

218
00:08:22,669 --> 00:08:27,349
certain md5 or<font color="#CCCCCC"> am cash will do a sha-1</font>

219
00:08:24,709 --> 00:08:30,019
hash we can say oh this was a hash of

220
00:08:27,349 --> 00:08:31,938
the<font color="#E5E5E5"> file and we know</font><font color="#CCCCCC"> exactly what that</font>

221
00:08:30,019 --> 00:08:33,529
file was if we recovered a version of it

222
00:08:31,939 --> 00:08:43,459
previously from<font color="#E5E5E5"> another</font>

223
00:08:33,529 --> 00:08:47,990
aight i don't think that<font color="#E5E5E5"> the files we</font>

224
00:08:43,458 --> 00:08:49,638
look at make it into<font color="#E5E5E5"> n srl and also know</font>

225
00:08:47,990 --> 00:08:51,379
we we don't we have our own intelligence

226
00:08:49,639 --> 00:08:54,290
repositories that we<font color="#E5E5E5"> keep track of these</font>

227
00:08:51,379 --> 00:09:01,220
I've never used that at all has anybody

228
00:08:54,290 --> 00:09:02,899
used it<font color="#E5E5E5"> I assume it yes like I an</font>

229
00:09:01,220 --> 00:09:05,240
attackers change which also frequently

230
00:09:02,899 --> 00:09:09,230
I've never eat I<font color="#E5E5E5"> know it's you can put</font>

231
00:09:05,240 --> 00:09:12,290
hash listen n case itself given attacker

232
00:09:09,230 --> 00:09:15,139
is<font color="#CCCCCC"> replaced a huge pile of that version</font>

233
00:09:12,290 --> 00:09:18,199
gotcha the good version me Indiana's are

234
00:09:15,139 --> 00:09:23,959
you<font color="#CCCCCC"> sees a kerchief it was interesting</font>

235
00:09:18,199 --> 00:09:25,699
<font color="#CCCCCC">okay guys so so I think the moral is if</font>

236
00:09:23,959 --> 00:09:27,199
you have<font color="#E5E5E5"> like a list of hashes that you</font>

237
00:09:25,699 --> 00:09:28,279
know if<font color="#E5E5E5"> those files are that can be</font>

238
00:09:27,199 --> 00:09:29,508
great<font color="#E5E5E5"> even if you don't have the file</font>

239
00:09:28,279 --> 00:09:30,620
you can say<font color="#E5E5E5"> yes that's what's bad yes</font>

240
00:09:29,509 --> 00:09:36,079
this is good<font color="#E5E5E5"> no it's not</font><font color="#CCCCCC"> worry about</font>

241
00:09:30,620 --> 00:09:38,689
it's<font color="#E5E5E5"> not something like that so why you</font>

242
00:09:36,079 --> 00:09:41,569
know<font color="#E5E5E5"> artifacts happen when a file gets</font>

243
00:09:38,689 --> 00:09:43,790
created this is probably the most

244
00:09:41,569 --> 00:09:45,800
<font color="#E5E5E5">intimidating group of people to present</font>

245
00:09:43,790 --> 00:09:47,240
that too because you<font color="#CCCCCC"> guys hopefully when</font>

246
00:09:45,800 --> 00:09:49,339
you hit these classes should know this

247
00:09:47,240 --> 00:09:51,019
stuff in and out and<font color="#CCCCCC"> I'll mention that</font>

248
00:09:49,339 --> 00:09:53,329
so please call<font color="#CCCCCC"> me out</font><font color="#E5E5E5"> if I'm wrong I</font>

249
00:09:51,019 --> 00:09:55,759
hope I'm not been a while since I've

250
00:09:53,329 --> 00:09:57,620
done the cool stuff who's<font color="#CCCCCC"> open the</font><font color="#E5E5E5"> nmf</font>

251
00:09:55,759 --> 00:09:59,779
tnx ways and looked at the cool little

252
00:09:57,620 --> 00:10:01,220
sections the different colors but<font color="#E5E5E5"> have</font>

253
00:09:59,779 --> 00:10:04,550
you ever seen them ft attributes

254
00:10:01,220 --> 00:10:06,199
described as a lightsaber I bet<font color="#E5E5E5"> you have</font>

255
00:10:04,550 --> 00:10:10,339
an ex ways doesn't<font color="#CCCCCC"> do that that's only</font>

256
00:10:06,199 --> 00:10:12,258
here so if an<font color="#E5E5E5"> ntfs and let's keep in</font>

257
00:10:10,339 --> 00:10:14,269
mind the NTFS file system is separate

258
00:10:12,259 --> 00:10:16,550
than Windows Windows just uses it and

259
00:10:14,269 --> 00:10:18,889
you know recent versions of<font color="#E5E5E5"> Windows or</font>

260
00:10:16,550 --> 00:10:21,109
talks of replacing with our EFS

261
00:10:18,889 --> 00:10:24,259
redundant and whatever but II<font color="#CCCCCC"> used to</font>

262
00:10:21,110 --> 00:10:26,000
<font color="#E5E5E5">use fat</font><font color="#CCCCCC"> 30-something but friends gfs</font>

263
00:10:24,259 --> 00:10:28,429
that's the big dog in the house the

264
00:10:26,000 --> 00:10:30,589
metadata and the file system files will

265
00:10:28,429 --> 00:10:32,569
be dollar signs it look pretty expensive

266
00:10:30,589 --> 00:10:34,759
you know<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of us have heard of the</font>

267
00:10:32,569 --> 00:10:37,128
dollar sign mft file will have the dogs

268
00:10:34,759 --> 00:10:39,139
on us n journal dollar sign extend

269
00:10:37,129 --> 00:10:43,129
directory will talk about dollar sign I

270
00:10:39,139 --> 00:10:45,829
30s but when the mft or when a file gets

271
00:10:43,129 --> 00:10:47,160
created ntfs looks in the master file

272
00:10:45,829 --> 00:10:49,349
table and says I'm going<font color="#E5E5E5"> to take</font>

273
00:10:47,160 --> 00:10:51,810
that's 1024 bytes of data and<font color="#E5E5E5"> I'm going</font>

274
00:10:49,350 --> 00:10:54,360
<font color="#E5E5E5">to just say hey I have a file with this</font>

275
00:10:51,810 --> 00:10:55,888
these attributes every file will have a

276
00:10:54,360 --> 00:10:59,160
standard information attribute that's

277
00:10:55,889 --> 00:11:00,540
your hex 10 attribute what you'll<font color="#E5E5E5"> have</font>

278
00:10:59,160 --> 00:11:03,180
some time stamps<font color="#E5E5E5"> then are also have a</font>

279
00:11:00,540 --> 00:11:04,589
file name attribute that will have the

280
00:11:03,180 --> 00:11:07,649
file name itself with some other time

281
00:11:04,589 --> 00:11:10,199
stamps that<font color="#CCCCCC"> we'll talk</font><font color="#E5E5E5"> about and then if</font>

282
00:11:07,649 --> 00:11:12,540
your file is it pretty small the file

283
00:11:10,199 --> 00:11:13,740
contents will be resident in the<font color="#CCCCCC"> mft it</font>

284
00:11:12,540 --> 00:11:15,899
depends<font color="#E5E5E5"> on how many other attributes</font>

285
00:11:13,740 --> 00:11:17,790
there are say about 700 bites but if

286
00:11:15,899 --> 00:11:19,589
there's multiple file name attributes

287
00:11:17,790 --> 00:11:22,259
for a short file name which some of you

288
00:11:19,589 --> 00:11:24,420
may or may not<font color="#E5E5E5"> be familiar with this</font>

289
00:11:22,259 --> 00:11:28,680
<font color="#E5E5E5">amount of data left in that small</font>

290
00:11:24,420 --> 00:11:30,149
section is small so there's a higher

291
00:11:28,680 --> 00:11:33,628
chance that the file will<font color="#CCCCCC"> be put out to</font>

292
00:11:30,149 --> 00:11:36,000
disk and that data attribute will have

293
00:11:33,629 --> 00:11:37,230
data runs which say here's all my

294
00:11:36,000 --> 00:11:39,000
information but if you want<font color="#E5E5E5"> the actual</font>

295
00:11:37,230 --> 00:11:44,100
contents of the file go to this cluster

296
00:11:39,000 --> 00:11:46,500
and find it so yes everyone like loves

297
00:11:44,100 --> 00:11:48,540
to talk about<font color="#CCCCCC"> resident files hmm</font><font color="#E5E5E5"> I don't</font>

298
00:11:46,500 --> 00:11:50,100
<font color="#E5E5E5">really I don't find any interest in them</font>

299
00:11:48,540 --> 00:11:51,870
other than if you're carving them hey

300
00:11:50,100 --> 00:11:54,480
<font color="#E5E5E5">why is</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> file in the</font><font color="#CCCCCC"> mft that's good</font>

301
00:11:51,870 --> 00:11:55,410
to know but but they can be there so

302
00:11:54,480 --> 00:11:57,149
you'll have<font color="#E5E5E5"> your standard information</font>

303
00:11:55,410 --> 00:12:01,139
and<font color="#E5E5E5"> your</font><font color="#CCCCCC"> filename</font><font color="#E5E5E5"> attributes created</font>

304
00:11:57,149 --> 00:12:03,449
let's say we<font color="#E5E5E5"> delete a file and we're</font>

305
00:12:01,139 --> 00:12:06,959
looking through the<font color="#CCCCCC"> mft here some</font><font color="#E5E5E5"> some</font>

306
00:12:03,449 --> 00:12:09,359
things change when we delete a file we

307
00:12:06,959 --> 00:12:10,500
do a shift delete or maybe<font color="#E5E5E5"> I don't much</font>

308
00:12:09,360 --> 00:12:11,759
rather<font color="#E5E5E5"> cycle don't work so when you do</font>

309
00:12:10,500 --> 00:12:14,939
like a ship delete<font color="#E5E5E5"> or command line</font>

310
00:12:11,759 --> 00:12:16,439
delete that mft entry the standard info

311
00:12:14,939 --> 00:12:17,939
and the<font color="#CCCCCC"> file name attributes they're</font>

312
00:12:16,439 --> 00:12:27,540
still there they just<font color="#CCCCCC"> get marked as</font>

313
00:12:17,939 --> 00:12:29,670
<font color="#CCCCCC">unused know so the entire contents of</font>

314
00:12:27,540 --> 00:12:31,259
that 1024 bytes<font color="#CCCCCC"> the mft</font><font color="#E5E5E5"> answer you're</font>

315
00:12:29,670 --> 00:12:33,990
just going<font color="#E5E5E5"> to hang out there but they'll</font>

316
00:12:31,259 --> 00:12:35,519
be marked as inactive or unused<font color="#E5E5E5"> and</font>

317
00:12:33,990 --> 00:12:37,559
that's how you would know that that file

318
00:12:35,519 --> 00:12:40,290
has been deleted it's no longer<font color="#E5E5E5"> active</font>

319
00:12:37,559 --> 00:12:42,540
but the contents of the attributes and

320
00:12:40,290 --> 00:12:43,920
the data if its resident or the data run

321
00:12:42,540 --> 00:12:47,279
pointing out<font color="#E5E5E5"> they're still going to hang</font>

322
00:12:43,920 --> 00:12:49,529
out there until the<font color="#CCCCCC"> mft says hey we need</font>

323
00:12:47,279 --> 00:12:51,089
<font color="#CCCCCC">to we need a space for a new file I see</font>

324
00:12:49,529 --> 00:12:53,309
<font color="#E5E5E5">this</font><font color="#CCCCCC"> one is inactive let's get rid of</font><font color="#E5E5E5"> it</font>

325
00:12:51,089 --> 00:12:55,139
but until<font color="#CCCCCC"> that gets overwritten that</font>

326
00:12:53,309 --> 00:12:58,990
entries still going to be there

327
00:12:55,139 --> 00:13:04,839
including the data itself um so yes

328
00:12:58,990 --> 00:13:09,399
the flag right so it's<font color="#E5E5E5"> the rest is still</font>

329
00:13:04,839 --> 00:13:12,190
there pretty much<font color="#E5E5E5"> untouched right gotcha</font>

330
00:13:09,399 --> 00:13:14,320
hardline confused me a little bit<font color="#CCCCCC"> I I</font>

331
00:13:12,190 --> 00:13:16,390
don't deal with them a lot<font color="#E5E5E5"> but I mean</font>

332
00:13:14,320 --> 00:13:18,100
it's that's good to know you know also

333
00:13:16,390 --> 00:13:20,800
good know you guys have professors here

334
00:13:18,100 --> 00:13:23,830
who are smarter than and everyone about

335
00:13:20,800 --> 00:13:27,310
some of this stuff so that's how it was

336
00:13:23,830 --> 00:13:30,640
yes so you know it's the content is

337
00:13:27,310 --> 00:13:32,020
really there preserved intact until then

338
00:13:30,640 --> 00:13:33,730
that fear the file system decides we

339
00:13:32,020 --> 00:13:36,279
need to use this space for something

340
00:13:33,730 --> 00:13:39,430
else let's take<font color="#E5E5E5"> a look at the green hand</font>

341
00:13:36,279 --> 00:13:42,040
here it used to be a file known as a

342
00:13:39,430 --> 00:13:43,540
green hand<font color="#CCCCCC"> that got deleted mft said i</font>

343
00:13:42,040 --> 00:13:45,520
need a new space i'm going to put robot

344
00:13:43,540 --> 00:13:47,230
hand to wear that entry was so you

345
00:13:45,520 --> 00:13:49,720
cannot get those standard info<font color="#E5E5E5"> on file</font>

346
00:13:47,230 --> 00:13:53,020
<font color="#E5E5E5">name</font><font color="#CCCCCC"> timestamps and data anymore because</font>

347
00:13:49,720 --> 00:13:55,240
they've been overwritten whereas the

348
00:13:53,020 --> 00:13:57,069
blue hand here it got deleted but it's

349
00:13:55,240 --> 00:13:59,410
just hanging out I still deleted right

350
00:13:57,070 --> 00:14:01,480
now we can go and recover that file

351
00:13:59,410 --> 00:14:03,069
metadata and maybe you find out where

352
00:14:01,480 --> 00:14:04,690
the file was on disk if that hasn't been

353
00:14:03,070 --> 00:14:07,149
overwritten yet all kinds of<font color="#E5E5E5"> good stuff</font>

354
00:14:04,690 --> 00:14:12,850
if there any questions just shoot your

355
00:14:07,149 --> 00:14:14,620
hands up I'll do my best so this<font color="#CCCCCC"> is an</font>

356
00:14:12,850 --> 00:14:16,180
index record which you<font color="#E5E5E5"> guys may or may</font>

357
00:14:14,620 --> 00:14:18,190
not be<font color="#E5E5E5"> familiar with this kind of takes</font>

358
00:14:16,180 --> 00:14:20,529
us to the next level when a file gets

359
00:14:18,190 --> 00:14:23,620
created you get an<font color="#CCCCCC"> mft entry</font><font color="#E5E5E5"> that has</font>

360
00:14:20,529 --> 00:14:26,020
<font color="#E5E5E5">Darren info for timestamps in there we</font>

361
00:14:23,620 --> 00:14:28,329
<font color="#E5E5E5">get a file name attribute for timestamps</font>

362
00:14:26,020 --> 00:14:29,350
<font color="#E5E5E5">in there that may be different so I'm</font>

363
00:14:28,329 --> 00:14:30,880
<font color="#E5E5E5">not going to dig into why they're</font>

364
00:14:29,350 --> 00:14:32,709
different but keep this in mind there

365
00:14:30,880 --> 00:14:34,930
<font color="#CCCCCC">are eight time stamps for each file that</font>

366
00:14:32,709 --> 00:14:36,880
gets created an NTFS but then when you

367
00:14:34,930 --> 00:14:39,099
<font color="#CCCCCC">create a file it's in a folder right</font>

368
00:14:36,880 --> 00:14:42,010
that folder wants to say hey I need a

369
00:14:39,100 --> 00:14:45,459
list of what's in my folder so that's

370
00:14:42,010 --> 00:14:47,560
when an index record is created<font color="#CCCCCC"> the</font>

371
00:14:45,459 --> 00:14:49,660
folder is going to say<font color="#CCCCCC"> will give you the</font>

372
00:14:47,560 --> 00:14:51,939
names of all<font color="#E5E5E5"> the files and a copy of the</font>

373
00:14:49,660 --> 00:14:54,189
standard information<font color="#CCCCCC"> time stamp so</font>

374
00:14:51,940 --> 00:14:56,260
you'll be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to go find that other</font>

375
00:14:54,190 --> 00:14:58,180
record keep in<font color="#CCCCCC"> mind it's the name with a</font>

376
00:14:56,260 --> 00:15:00,069
copy of the standard information<font color="#CCCCCC"> time</font>

377
00:14:58,180 --> 00:15:02,109
<font color="#CCCCCC">stamp</font><font color="#E5E5E5"> so it's not for new or separate</font>

378
00:15:00,070 --> 00:15:04,510
time<font color="#CCCCCC"> stamps for a regular file that's</font>

379
00:15:02,110 --> 00:15:06,700
still active and present on the system

380
00:15:04,510 --> 00:15:08,170
no new<font color="#CCCCCC"> time stamps not going to be</font>

381
00:15:06,700 --> 00:15:12,700
anything interested but keep<font color="#E5E5E5"> in mind</font>

382
00:15:08,170 --> 00:15:14,770
they<font color="#CCCCCC"> are they're usually for files</font>

383
00:15:12,700 --> 00:15:16,840
lots of directories the index record is

384
00:15:14,770 --> 00:15:20,319
stored in them mft attributes that's a

385
00:15:16,840 --> 00:15:23,230
<font color="#CCCCCC">non-resident so it's moved out to disk</font>

386
00:15:20,320 --> 00:15:25,360
and you'll see<font color="#E5E5E5"> this indx does anybody</font>

387
00:15:23,230 --> 00:15:28,180
<font color="#CCCCCC">ever opened up ftk imager and seeing a</font>

388
00:15:25,360 --> 00:15:29,620
dollar sign I 30 file that's what<font color="#E5E5E5"> it is</font>

389
00:15:28,180 --> 00:15:31,839
<font color="#E5E5E5">it's not really a file it's just</font>

390
00:15:29,620 --> 00:15:33,040
attribute they call it dollar sign 930

391
00:15:31,840 --> 00:15:35,380
because these attributes<font color="#E5E5E5"> can hold</font>

392
00:15:33,040 --> 00:15:37,209
different kinds of data but if<font color="#CCCCCC"> Windows</font>

393
00:15:35,380 --> 00:15:40,840
has it says the data is dollar sign I

394
00:15:37,210 --> 00:15:42,730
<font color="#E5E5E5">authority is a directory listing and so</font>

395
00:15:40,840 --> 00:15:44,380
activated<font color="#CCCCCC"> calls it dollar sign eyes</font>

396
00:15:42,730 --> 00:15:47,290
already file but keep in mind the file

397
00:15:44,380 --> 00:15:50,560
doesn't really exist this it's just

398
00:15:47,290 --> 00:15:52,540
attribute I'm so in this we can see we

399
00:15:50,560 --> 00:15:55,599
have editor at the bottom I know it's

400
00:15:52,540 --> 00:15:57,610
<font color="#CCCCCC">small and also these non-resident files</font>

401
00:15:55,600 --> 00:15:59,050
they grow and shrink and all kinds of

402
00:15:57,610 --> 00:16:00,460
good stuff so it's a very<font color="#E5E5E5"> good chance</font>

403
00:15:59,050 --> 00:16:02,800
that<font color="#E5E5E5"> they grow really big one an</font>

404
00:16:00,460 --> 00:16:04,900
attacker creates a 30 part rar file once

405
00:16:02,800 --> 00:16:06,520
they delete that all those rar files is

406
00:16:04,900 --> 00:16:08,439
going to shrink back up guess what

407
00:16:06,520 --> 00:16:11,290
happens to all<font color="#E5E5E5"> the data that used to be</font>

408
00:16:08,440 --> 00:16:14,770
there it's still there so you can use

409
00:16:11,290 --> 00:16:18,099
that<font color="#E5E5E5"> tool index party</font><font color="#CCCCCC"> y by my colleague</font>

410
00:16:14,770 --> 00:16:19,990
<font color="#CCCCCC">Willy balance in to carve out some of</font>

411
00:16:18,100 --> 00:16:21,610
<font color="#CCCCCC">that data you have to use the dash D</font>

412
00:16:19,990 --> 00:16:23,200
flag when you<font color="#E5E5E5"> run that but it's very</font>

413
00:16:21,610 --> 00:16:25,480
useful<font color="#E5E5E5"> so you're just going to access</font>

414
00:16:23,200 --> 00:16:27,580
our<font color="#E5E5E5"> ftk imager right click on the dollar</font>

415
00:16:25,480 --> 00:16:28,660
sign I 30 or an end case when you click

416
00:16:27,580 --> 00:16:30,910
on a director show you this and<font color="#E5E5E5"> just</font>

417
00:16:28,660 --> 00:16:32,050
export that<font color="#E5E5E5"> run the tool on that and</font>

418
00:16:30,910 --> 00:16:35,290
they'll tell you what is carved from

419
00:16:32,050 --> 00:16:38,079
<font color="#E5E5E5">flax base because those records are</font>

420
00:16:35,290 --> 00:16:40,120
deleted that<font color="#E5E5E5"> they're mft records may</font>

421
00:16:38,080 --> 00:16:41,350
have been deleted<font color="#E5E5E5"> as well so even though</font>

422
00:16:40,120 --> 00:16:42,310
it's just standard information<font color="#CCCCCC"> time</font>

423
00:16:41,350 --> 00:16:44,110
<font color="#CCCCCC">stamps you're not going to get</font><font color="#E5E5E5"> those</font>

424
00:16:42,310 --> 00:16:46,869
<font color="#E5E5E5">anywhere else sometimes so it's very</font>

425
00:16:44,110 --> 00:16:57,220
<font color="#CCCCCC">useful we use</font><font color="#E5E5E5"> these all the time come on</font>

426
00:16:46,870 --> 00:16:59,020
in whoa hotline bling swag everyone has

427
00:16:57,220 --> 00:17:00,850
their binoculars i know i need my

428
00:16:59,020 --> 00:17:04,810
glasses don't worry about<font color="#E5E5E5"> looking at</font>

429
00:17:00,850 --> 00:17:06,970
this stuff will zoom in in a second but

430
00:17:04,810 --> 00:17:09,698
we just<font color="#CCCCCC"> looked at</font><font color="#E5E5E5"> a non-resident index</font>

431
00:17:06,970 --> 00:17:12,250
record here's an example of what it

432
00:17:09,699 --> 00:17:14,440
looks like in mfc record itself usually

433
00:17:12,250 --> 00:17:17,980
<font color="#E5E5E5">if it's if it's resident it'll be a</font><font color="#CCCCCC"> 0 x</font>

434
00:17:14,440 --> 00:17:19,660
90 attribute and if we look here<font color="#CCCCCC"> i have</font>

435
00:17:17,980 --> 00:17:21,130
nice highlighted in red it's not as fun

436
00:17:19,660 --> 00:17:22,990
as x ways one used<font color="#E5E5E5"> to like tip the</font>

437
00:17:21,130 --> 00:17:25,360
monitor back so you see the very faint

438
00:17:22,990 --> 00:17:26,230
colors better but it's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> standard flow</font>

439
00:17:25,359 --> 00:17:28,329
the<font color="#CCCCCC"> file name</font>

440
00:17:26,230 --> 00:17:31,780
file names here which is cool and then

441
00:17:28,329 --> 00:17:33,850
RR 0 x 90 attribute with the dollar sign

442
00:17:31,780 --> 00:17:35,740
I 30 indicator there that's telling<font color="#CCCCCC"> us</font>

443
00:17:33,850 --> 00:17:37,510
that this is a directory and this

444
00:17:35,740 --> 00:17:39,760
attributes going to have the names of

445
00:17:37,510 --> 00:17:43,419
the the directories unfortunately this

446
00:17:39,760 --> 00:17:46,480
one we see an a0 and b0 attribute which

447
00:17:43,419 --> 00:17:49,809
is<font color="#E5E5E5"> going to tell us that there's the the</font>

448
00:17:46,480 --> 00:17:51,910
index record is now<font color="#E5E5E5"> non-resident so we</font>

449
00:17:49,809 --> 00:17:53,918
won't<font color="#CCCCCC"> have those file names there but if</font>

450
00:17:51,910 --> 00:17:55,750
<font color="#E5E5E5">we get to the end we see all these X and</font>

451
00:17:53,919 --> 00:17:58,000
you're like a fat that's<font color="#CCCCCC"> ok because</font>

452
00:17:55,750 --> 00:18:01,360
after the end of the<font color="#CCCCCC"> mft record</font>

453
00:17:58,000 --> 00:18:03,669
signified by the 4f the four SS we see

454
00:18:01,360 --> 00:18:06,879
some key words here shield exe and

455
00:18:03,669 --> 00:18:08,860
<font color="#E5E5E5">cannons die exe so that's interesting so</font>

456
00:18:06,880 --> 00:18:12,490
things<font color="#E5E5E5"> to keep in mind as we dig into</font>

457
00:18:08,860 --> 00:18:13,990
this is that you know it's it can be a

458
00:18:12,490 --> 00:18:15,640
resident attributes as then gets move

459
00:18:13,990 --> 00:18:19,690
non-residents the director gets too big

460
00:18:15,640 --> 00:18:22,240
or resize and the slack space under at

461
00:18:19,690 --> 00:18:26,020
path to the end of an MST entry is not

462
00:18:22,240 --> 00:18:29,140
<font color="#E5E5E5">overwritten if that data changes the</font>

463
00:18:26,020 --> 00:18:32,110
entire contents<font color="#CCCCCC"> are only zero doubt if</font>

464
00:18:29,140 --> 00:18:33,429
the entry is reused then<font color="#E5E5E5"> it'll clear</font>

465
00:18:32,110 --> 00:18:36,399
everything out put a new entry in there

466
00:18:33,429 --> 00:18:38,919
but if the attributes change size that

467
00:18:36,400 --> 00:18:42,610
<font color="#E5E5E5">fox base may still be available let's</font>

468
00:18:38,919 --> 00:18:45,790
take a zoomed on<font color="#CCCCCC"> I forgot about</font><font color="#E5E5E5"> my</font>

469
00:18:42,610 --> 00:18:49,360
awesome yes they're not mine i don't own

470
00:18:45,790 --> 00:18:51,190
them<font color="#E5E5E5"> so let's take a closer look you</font>

471
00:18:49,360 --> 00:18:52,840
know we may have a keyword search for

472
00:18:51,190 --> 00:18:55,059
cannons<font color="#E5E5E5"> you know me know this is a bad</font>

473
00:18:52,840 --> 00:18:56,949
file it's not as cool as the<font color="#CCCCCC"> file names</font>

474
00:18:55,059 --> 00:19:00,370
that Brian was talking about over his

475
00:18:56,950 --> 00:19:02,020
case but these are fun to you know you

476
00:19:00,370 --> 00:19:04,449
have a your malware could be shield<font color="#E5E5E5"> dot</font>

477
00:19:02,020 --> 00:19:07,809
you see you take a look and you see this

478
00:19:04,450 --> 00:19:10,179
this one's not as<font color="#CCCCCC"> a parent has the</font><font color="#E5E5E5"> other</font>

479
00:19:07,809 --> 00:19:12,730
time stamps foot anytime I see this

480
00:19:10,179 --> 00:19:14,650
block of like concentrated data with a

481
00:19:12,730 --> 00:19:18,010
file<font color="#E5E5E5"> name attorneys I kind of think of</font>

482
00:19:14,650 --> 00:19:19,660
<font color="#E5E5E5">it as a set of four time stamp so that</font>

483
00:19:18,010 --> 00:19:21,910
may or<font color="#CCCCCC"> may not pan out you that's</font><font color="#E5E5E5"> okay</font>

484
00:19:19,660 --> 00:19:25,750
but we can see you know cannons and

485
00:19:21,910 --> 00:19:28,120
shield exe turns out that this is<font color="#E5E5E5"> these</font>

486
00:19:25,750 --> 00:19:31,419
are artifacts from a previously resident

487
00:19:28,120 --> 00:19:33,129
index record that is no<font color="#E5E5E5"> longer there so</font>

488
00:19:31,419 --> 00:19:34,780
if we carve some of this stuff out and

489
00:19:33,130 --> 00:19:38,200
we know the structure<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the index</font>

490
00:19:34,780 --> 00:19:40,060
record file attribute we can<font color="#E5E5E5"> actually</font>

491
00:19:38,200 --> 00:19:43,060
determine that

492
00:19:40,060 --> 00:19:45,669
shield<font color="#CCCCCC"> exe will trace back all the stuff</font>

493
00:19:43,060 --> 00:19:47,620
above it has those<font color="#CCCCCC"> time stamps that</font><font color="#E5E5E5"> size</font>

494
00:19:45,670 --> 00:19:49,330
and<font color="#E5E5E5"> we can determine its in</font><font color="#CCCCCC"> archive you</font>

495
00:19:47,620 --> 00:19:52,030
know anything<font color="#E5E5E5"> you get from a normal</font><font color="#CCCCCC"> mft</font>

496
00:19:49,330 --> 00:19:53,889
entry unfortunately cannons time stamps

497
00:19:52,030 --> 00:19:55,810
were up here somewhere<font color="#E5E5E5"> and they're</font>

498
00:19:53,890 --> 00:19:57,490
overwritten by you know the existing<font color="#E5E5E5"> in</font>

499
00:19:55,810 --> 00:19:59,200
my pantry so we couldn't get that but we

500
00:19:57,490 --> 00:20:00,910
know cannon there was probably a file

501
00:19:59,200 --> 00:20:02,890
named cannon in that folder at some

502
00:20:00,910 --> 00:20:04,000
point in time which may be useful we

503
00:20:02,890 --> 00:20:06,190
don't<font color="#E5E5E5"> know what the size was what the</font>

504
00:20:04,000 --> 00:20:10,030
time stamps were<font color="#CCCCCC"> well we know some</font><font color="#E5E5E5"> stuff</font>

505
00:20:06,190 --> 00:20:16,420
so that's useful we're very<font color="#CCCCCC"> excited</font>

506
00:20:10,030 --> 00:20:17,710
about<font color="#CCCCCC"> that so that is index records in a</font>

507
00:20:16,420 --> 00:20:20,680
nutshell we're going to move on<font color="#E5E5E5"> to the</font>

508
00:20:17,710 --> 00:20:24,670
<font color="#CCCCCC">usn journal the</font><font color="#E5E5E5"> usn journal is used by</font>

509
00:20:20,680 --> 00:20:26,890
ntfs to<font color="#E5E5E5"> keep track of what chain what</font>

510
00:20:24,670 --> 00:20:28,660
files are changing in case it gets

511
00:20:26,890 --> 00:20:30,580
interrupted in the middle of the phyllo

512
00:20:28,660 --> 00:20:31,990
change like if you pull the plug it'll

513
00:20:30,580 --> 00:20:34,629
remember oh<font color="#E5E5E5"> yes I was modifying this</font>

514
00:20:31,990 --> 00:20:35,920
file and<font color="#E5E5E5"> I got cut off that file might</font>

515
00:20:34,630 --> 00:20:38,200
be jacked up you might want to check

516
00:20:35,920 --> 00:20:39,790
<font color="#CCCCCC">that or I might want</font><font color="#E5E5E5"> to try and go</font><font color="#CCCCCC"> back</font>

517
00:20:38,200 --> 00:20:42,610
to a previous version of<font color="#E5E5E5"> the file if I</font>

518
00:20:39,790 --> 00:20:44,590
have volume shadow stuff going on but

519
00:20:42,610 --> 00:20:46,149
it's<font color="#E5E5E5"> super awesome because yes i would</font>

520
00:20:44,590 --> 00:20:48,220
like to know every time the attacker

521
00:20:46,150 --> 00:20:50,770
makes changes to files on this disk that

522
00:20:48,220 --> 00:20:53,350
would be super useful Thank<font color="#E5E5E5"> You ntfs for</font>

523
00:20:50,770 --> 00:20:55,060
offering to record that for me and what

524
00:20:53,350 --> 00:20:59,620
you'll find in<font color="#CCCCCC"> the usn journal</font>

525
00:20:55,060 --> 00:21:00,879
particularly its dollar sign<font color="#CCCCCC"> j alternate</font>

526
00:20:59,620 --> 00:21:02,350
data stream<font color="#E5E5E5"> i know alternate data</font>

527
00:21:00,880 --> 00:21:06,130
streams are scary but this<font color="#CCCCCC"> one's</font><font color="#E5E5E5"> awesome</font>

528
00:21:02,350 --> 00:21:10,090
<font color="#E5E5E5">you'll get the file name</font><font color="#CCCCCC"> it's mft entry</font>

529
00:21:06,130 --> 00:21:12,760
<font color="#E5E5E5">it's mft entry sequence number its</font>

530
00:21:10,090 --> 00:21:14,800
parent mft entry its parent msg entry

531
00:21:12,760 --> 00:21:16,990
sequence number and that will help you

532
00:21:14,800 --> 00:21:19,180
go back and<font color="#CCCCCC"> say i have a file name I</font>

533
00:21:16,990 --> 00:21:21,730
found this mft entry but<font color="#CCCCCC"> I also</font><font color="#E5E5E5"> know</font>

534
00:21:19,180 --> 00:21:23,350
what<font color="#E5E5E5"> that and the pantry parent was</font>

535
00:21:21,730 --> 00:21:25,060
which will correspond<font color="#CCCCCC"> to</font><font color="#E5E5E5"> its parent</font>

536
00:21:23,350 --> 00:21:27,730
directory you'll know what folder it was

537
00:21:25,060 --> 00:21:29,950
and every time<font color="#CCCCCC"> an mft entry gets reused</font>

538
00:21:27,730 --> 00:21:31,660
at sequence number increments so if the

539
00:21:29,950 --> 00:21:41,020
sequence numbers don't match it's likely

540
00:21:31,660 --> 00:21:44,930
that that directory no longer exists so

541
00:21:41,020 --> 00:21:49,280
it's just this one 15 this one

542
00:21:44,930 --> 00:21:50,900
so the dollar sign<font color="#CCCCCC"> us in journal file is</font>

543
00:21:49,280 --> 00:21:53,930
me useless I don't know what it does but

544
00:21:50,900 --> 00:21:56,360
it's alternate data stream dollar sign

545
00:21:53,930 --> 00:21:58,850
<font color="#E5E5E5">Jay keeps the useful information i'm not</font>

546
00:21:56,360 --> 00:22:00,830
sure what the other 80 s is are for and

547
00:21:58,850 --> 00:22:03,860
what the base file is for but it's this

548
00:22:00,830 --> 00:22:05,179
<font color="#E5E5E5">80s set that we like</font><font color="#CCCCCC"> i don't know why it</font>

549
00:22:03,860 --> 00:22:07,459
<font color="#E5E5E5">picks this one over the others i just</font>

550
00:22:05,180 --> 00:22:09,260
notice how is it good so you'll also

551
00:22:07,460 --> 00:22:11,810
hear me say that<font color="#CCCCCC"> i don't know a lot of</font>

552
00:22:09,260 --> 00:22:13,280
stuff so keep that in<font color="#CCCCCC"> mind when you're</font>

553
00:22:11,810 --> 00:22:15,350
like writing reports have to go to court

554
00:22:13,280 --> 00:22:18,110
Billy<font color="#E5E5E5"> Payne told me if he doesn't really</font>

555
00:22:15,350 --> 00:22:20,480
know and you'll see that<font color="#E5E5E5"> a lot and I'll</font>

556
00:22:18,110 --> 00:22:21,469
talk about that don't worry but some of

557
00:22:20,480 --> 00:22:23,390
the really useful things you'll see

558
00:22:21,470 --> 00:22:24,950
reason flags there's a whole technet

559
00:22:23,390 --> 00:22:27,290
article there with all the reasons about

560
00:22:24,950 --> 00:22:29,570
why you know what things get recorded by

561
00:22:27,290 --> 00:22:32,420
the journal<font color="#E5E5E5"> and why useful things for me</font>

562
00:22:29,570 --> 00:22:35,270
art is that<font color="#E5E5E5"> file gets created file gets</font>

563
00:22:32,420 --> 00:22:37,670
appended to or overwritten file gets

564
00:22:35,270 --> 00:22:40,520
deleted and file gets renamed there's

565
00:22:37,670 --> 00:22:43,460
all kinds of other ones like the streams

566
00:22:40,520 --> 00:22:44,660
change the reparse points change you'll

567
00:22:43,460 --> 00:22:46,640
see you know every<font color="#E5E5E5"> time I write to</font><font color="#CCCCCC"> a</font>

568
00:22:44,660 --> 00:22:48,860
file adult be open you'll get a<font color="#E5E5E5"> million</font>

569
00:22:46,640 --> 00:22:50,720
appends and a<font color="#E5E5E5"> close those are kind of</font>

570
00:22:48,860 --> 00:22:53,149
you know they're nice to me to know<font color="#E5E5E5"> but</font>

571
00:22:50,720 --> 00:22:54,350
if<font color="#E5E5E5"> I can tell when a file gets created</font>

572
00:22:53,150 --> 00:22:58,940
in deleting renamed that's that's very

573
00:22:54,350 --> 00:23:00,649
usefully we're going to talk about<font color="#E5E5E5"> that</font>

574
00:22:58,940 --> 00:23:04,220
we<font color="#E5E5E5"> will definitely</font><font color="#CCCCCC"> talk about when the</font>

575
00:23:00,650 --> 00:23:05,630
file or how long this data<font color="#E5E5E5"> last know so</font>

576
00:23:04,220 --> 00:23:08,330
there's a blog post here by a quarry

577
00:23:05,630 --> 00:23:09,920
Harrell again I'm preferential to

578
00:23:08,330 --> 00:23:11,449
<font color="#CCCCCC">Willie's parser us syndrome da pie</font>

579
00:23:09,920 --> 00:23:16,280
there's a whole<font color="#E5E5E5"> bunch of theirs you know</font>

580
00:23:11,450 --> 00:23:19,220
I<font color="#E5E5E5"> joaquim no chicks I think his name is</font>

581
00:23:16,280 --> 00:23:20,930
he has a<font color="#CCCCCC"> usn to CSC parts</font><font color="#E5E5E5"> there's all</font>

582
00:23:19,220 --> 00:23:27,770
kinds of good ones I like<font color="#E5E5E5"> the Python but</font>

583
00:23:20,930 --> 00:23:29,900
that's not everyone's cup of tea so this

584
00:23:27,770 --> 00:23:31,280
is<font color="#CCCCCC"> a case study about how you know what</font>

585
00:23:29,900 --> 00:23:32,960
kind of information can you get when<font color="#E5E5E5"> you</font>

586
00:23:31,280 --> 00:23:35,720
park you ascend Iran will take a big

587
00:23:32,960 --> 00:23:37,610
look at another one you have a lot of

588
00:23:35,720 --> 00:23:41,150
data right think<font color="#CCCCCC"> about how often file is</font>

589
00:23:37,610 --> 00:23:43,850
on your c drive yet modified appended

590
00:23:41,150 --> 00:23:47,180
overwritten rename a lot of data so this

591
00:23:43,850 --> 00:23:49,129
case had<font color="#CCCCCC"> 400,000 lines if you</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> excel</font>

592
00:23:47,180 --> 00:23:50,990
for analysis there goes about almost

593
00:23:49,130 --> 00:23:53,120
<font color="#E5E5E5">half your lines that</font><font color="#CCCCCC"> you can use you can</font>

594
00:23:50,990 --> 00:23:55,310
use 1 million 48,000 some lines and

595
00:23:53,120 --> 00:23:58,100
<font color="#CCCCCC">excel and then you're done</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> i like</font><font color="#E5E5E5"> to</font>

596
00:23:55,310 --> 00:23:58,830
open this and maybe<font color="#E5E5E5"> powergrip out what</font>

597
00:23:58,100 --> 00:24:00,779
<font color="#E5E5E5">i'm looking</font><font color="#CCCCCC"> for</font>

598
00:23:58,830 --> 00:24:02,970
or you know something<font color="#E5E5E5"> it's a lot of data</font>

599
00:24:00,779 --> 00:24:06,390
to<font color="#E5E5E5"> be prepared for that but in this</font>

600
00:24:02,970 --> 00:24:08,549
example we were looking<font color="#CCCCCC"> for hu xiexie we</font>

601
00:24:06,390 --> 00:24:09,720
knew that<font color="#E5E5E5"> was</font><font color="#CCCCCC"> a bad file name so we're</font>

602
00:24:08,549 --> 00:24:12,179
going to keyword search for this or

603
00:24:09,720 --> 00:24:16,080
search in our parse journal and what do

604
00:24:12,179 --> 00:24:17,880
you<font color="#E5E5E5"> know we found it</font><font color="#CCCCCC"> Huck CXC we can see</font>

605
00:24:16,080 --> 00:24:19,649
<font color="#E5E5E5">that it was</font><font color="#CCCCCC"> created at this time has</font>

606
00:24:17,880 --> 00:24:20,789
this MSP reference and that's you know

607
00:24:19,649 --> 00:24:23,729
<font color="#E5E5E5">where we were looking them at sea for</font>

608
00:24:20,789 --> 00:24:26,820
its data its sequence number is 140<font color="#E5E5E5"> plus</font>

609
00:24:23,730 --> 00:24:28,260
140th time at<font color="#CCCCCC"> MSP entries</font><font color="#E5E5E5"> venue so it</font>

610
00:24:26,820 --> 00:24:31,500
seems like a lot<font color="#CCCCCC"> to you but that's</font><font color="#E5E5E5"> cool</font>

611
00:24:28,260 --> 00:24:35,580
<font color="#CCCCCC">we can also see that is parent MSP</font>

612
00:24:31,500 --> 00:24:39,929
record is<font color="#E5E5E5"> 624 ah anybody know what that</font>

613
00:24:35,580 --> 00:24:43,080
tells<font color="#E5E5E5"> me that's its parent folder so we</font>

614
00:24:39,929 --> 00:24:45,029
see shortly after kylos I<font color="#CCCCCC"> exe got</font>

615
00:24:43,080 --> 00:24:46,620
<font color="#E5E5E5">created in that same folder what an</font>

616
00:24:45,029 --> 00:24:49,440
attacker use the same folder to hold

617
00:24:46,620 --> 00:24:51,120
multiple files but a bad guy probably

618
00:24:49,440 --> 00:24:52,590
<font color="#E5E5E5">everyone likes to see her eyes oh the</font>

619
00:24:51,120 --> 00:24:53,580
attackers to be super<font color="#CCCCCC"> still to use 20</font>

620
00:24:52,590 --> 00:24:54,899
different folders a whole bunch of<font color="#E5E5E5"> file</font>

621
00:24:53,580 --> 00:24:56,370
names but attackers don't want to

622
00:24:54,899 --> 00:24:57,928
remember all that crap like it's a lot

623
00:24:56,370 --> 00:25:00,658
they're gonna<font color="#CCCCCC"> use the same files all the</font>

624
00:24:57,929 --> 00:25:02,039
time same file names all the time same

625
00:25:00,659 --> 00:25:03,960
directories all the<font color="#E5E5E5"> time they do this</font>

626
00:25:02,039 --> 00:25:05,340
over and over where we see it every time

627
00:25:03,960 --> 00:25:08,070
we see a case with a previously known

628
00:25:05,340 --> 00:25:12,090
attacker it's good for us and convenient

629
00:25:08,070 --> 00:25:13,799
for them so if we<font color="#CCCCCC"> look at MSP record 624</font>

630
00:25:12,090 --> 00:25:15,600
thats see windows so the attacker was

631
00:25:13,799 --> 00:25:17,309
writing it to see windows probably had

632
00:25:15,600 --> 00:25:18,389
some elevated privileges running as an

633
00:25:17,309 --> 00:25:21,330
admin or something to be able<font color="#E5E5E5"> to write</font>

634
00:25:18,389 --> 00:25:22,949
that directory useful to know but by

635
00:25:21,330 --> 00:25:25,918
looking in the<font color="#CCCCCC"> US engine</font><font color="#E5E5E5"> we can see that</font>

636
00:25:22,950 --> 00:25:27,059
this other file kylo<font color="#CCCCCC"> DXE was created in</font>

637
00:25:25,919 --> 00:25:28,320
that<font color="#E5E5E5"> same directory around the same time</font>

638
00:25:27,059 --> 00:25:33,149
we're going to think that<font color="#CCCCCC"> it might be</font>

639
00:25:28,320 --> 00:25:35,370
<font color="#E5E5E5">bad here's an example of what a full</font>

640
00:25:33,149 --> 00:25:38,370
park usn journal might look like we can

641
00:25:35,370 --> 00:25:41,219
see that Huck's and<font color="#CCCCCC"> kyla were created</font>

642
00:25:38,370 --> 00:25:44,729
extended created extended and all of a

643
00:25:41,220 --> 00:25:46,950
sudden<font color="#CCCCCC"> we see a coyote renamed was from</font>

644
00:25:44,730 --> 00:25:52,049
the old name kylajp to the new name

645
00:25:46,950 --> 00:25:54,870
<font color="#E5E5E5">aaaaaa I'm not calling triple-a for my</font>

646
00:25:52,049 --> 00:25:56,730
tires to be flat today so that's a

647
00:25:54,870 --> 00:25:59,870
<font color="#CCCCCC">little suspicious me</font><font color="#E5E5E5"> anybody have an</font>

648
00:25:56,730 --> 00:25:59,870
inkling of what that represents

649
00:26:03,940 --> 00:26:09,519
shut up Andy anybody<font color="#E5E5E5"> else know</font><font color="#CCCCCC"> all right</font>

650
00:26:07,480 --> 00:26:11,559
so we're<font color="#E5E5E5"> going to talk about that but</font>

651
00:26:09,519 --> 00:26:13,750
keep<font color="#E5E5E5"> a note that that four-letter file</font>

652
00:26:11,559 --> 00:26:15,879
name got transferred got renamed to four

653
00:26:13,750 --> 00:26:16,960
letters of<font color="#E5E5E5"> a full autos of these now</font>

654
00:26:15,879 --> 00:26:18,699
<font color="#E5E5E5">let's come back to this but that's</font>

655
00:26:16,960 --> 00:26:21,580
interesting to know when we see that I

656
00:26:18,700 --> 00:26:23,980
just get keeps getting renamed and then

657
00:26:21,580 --> 00:26:27,009
also later the whole next day we look at

658
00:26:23,980 --> 00:26:28,779
the same parent directory 624 we can

659
00:26:27,009 --> 00:26:31,750
find that<font color="#E5E5E5"> a file named Tesla is created</font>

660
00:26:28,779 --> 00:26:34,899
file PS exactly<font color="#CCCCCC"> XD</font><font color="#E5E5E5"> was created everybody</font>

661
00:26:31,750 --> 00:26:36,309
know what PS exec is it's a file that

662
00:26:34,899 --> 00:26:39,789
you can<font color="#E5E5E5"> use to connect to another system</font>

663
00:26:36,309 --> 00:26:43,178
and execute a command or an application

664
00:26:39,789 --> 00:26:45,250
if you use<font color="#CCCCCC"> PS exact to run cmd.exe on a</font>

665
00:26:43,179 --> 00:26:47,470
remote system you have<font color="#E5E5E5"> just as this H to</font>

666
00:26:45,250 --> 00:26:48,940
that system congratulations took me like

667
00:26:47,470 --> 00:26:50,500
four years here how can<font color="#CCCCCC"> I just you know</font>

668
00:26:48,940 --> 00:26:52,600
open a command line on another system

669
00:26:50,500 --> 00:26:55,029
she just run PS exact system name

670
00:26:52,600 --> 00:26:56,289
username password cmd.exe it'll just let

671
00:26:55,029 --> 00:27:02,080
you have to say to<font color="#CCCCCC"> that system which is</font>

672
00:26:56,289 --> 00:27:03,850
very nice<font color="#E5E5E5"> okay we're good on time so you</font>

673
00:27:02,080 --> 00:27:07,570
<font color="#E5E5E5">know what are my thoughts about</font>

674
00:27:03,850 --> 00:27:10,360
journaling number one that dollar sign<font color="#CCCCCC"> J</font>

675
00:27:07,570 --> 00:27:12,639
file is huge man that<font color="#CCCCCC"> soccer can be big</font>

676
00:27:10,360 --> 00:27:15,129
usually it's a gig or so I think<font color="#CCCCCC"> I'm</font>

677
00:27:12,639 --> 00:27:17,199
like 16 gigabytes how do i copy this out

678
00:27:15,129 --> 00:27:18,519
on on my stupid macbook like can't

679
00:27:17,200 --> 00:27:22,059
possibly do<font color="#CCCCCC"> this it says they're</font>

680
00:27:18,519 --> 00:27:24,340
gigantic and not only are<font color="#E5E5E5"> they gigantic</font>

681
00:27:22,059 --> 00:27:27,009
they're really sports like a small

682
00:27:24,340 --> 00:27:29,678
portion of that giant file is used for

683
00:27:27,009 --> 00:27:31,059
any information and is useful so if you

684
00:27:29,679 --> 00:27:32,379
copy a silent try and park you're going

685
00:27:31,059 --> 00:27:34,149
to have a tough time it's going<font color="#E5E5E5"> to take</font>

686
00:27:32,379 --> 00:27:37,209
forever so what I've been<font color="#E5E5E5"> doing a lot</font>

687
00:27:34,149 --> 00:27:39,428
recently is I found<font color="#E5E5E5"> this tool also by</font>

688
00:27:37,210 --> 00:27:41,830
watching<font color="#CCCCCC"> trick that extract</font><font color="#E5E5E5"> us</font><font color="#CCCCCC"> in</font>

689
00:27:39,429 --> 00:27:43,509
<font color="#E5E5E5">journal you can run on a raw or maybe an</font>

690
00:27:41,830 --> 00:27:45,549
easier one I forget what file types are

691
00:27:43,509 --> 00:27:47,769
supported I just mount it with<font color="#E5E5E5"> ftk</font>

692
00:27:45,549 --> 00:27:49,990
imager and say hey to look at this

693
00:27:47,769 --> 00:27:52,419
mounted volume and extract<font color="#E5E5E5"> the US enter</font>

694
00:27:49,990 --> 00:27:53,710
and<font color="#CCCCCC"> I like opens it up somehow looks in</font>

695
00:27:52,419 --> 00:27:54,879
the journal and only pulled out the

696
00:27:53,710 --> 00:27:56,259
useful data so you'll have<font color="#E5E5E5"> to worry</font>

697
00:27:54,879 --> 00:27:58,120
about copying out the giant files

698
00:27:56,259 --> 00:28:01,690
because sometimes your central look like

699
00:27:58,120 --> 00:28:04,090
16 gigabytes that's huge but you can

700
00:28:01,690 --> 00:28:07,570
pull that<font color="#CCCCCC"> out the other question Oh</font>

701
00:28:04,090 --> 00:28:09,789
entries expire frequently so the best

702
00:28:07,570 --> 00:28:12,820
i've ever seen for us n you on a<font color="#CCCCCC"> C Drive</font>

703
00:28:09,789 --> 00:28:14,980
<font color="#E5E5E5">is like two or</font><font color="#CCCCCC"> three days remember your</font>

704
00:28:12,820 --> 00:28:17,500
<font color="#E5E5E5">C drives like updating registry files</font>

705
00:28:14,980 --> 00:28:19,030
updating system files got applications

706
00:28:17,500 --> 00:28:21,220
antivirus is doing all kinds of crazy

707
00:28:19,030 --> 00:28:22,870
stuff with files everything running is

708
00:28:21,220 --> 00:28:24,760
going to add entry to your usn journal

709
00:28:22,870 --> 00:28:26,500
so on your<font color="#E5E5E5"> C Drive and if you don't</font>

710
00:28:24,760 --> 00:28:28,600
catch<font color="#CCCCCC"> that</font><font color="#E5E5E5"> quick it's going to be tough</font>

711
00:28:26,500 --> 00:28:30,250
to have information useful in there

712
00:28:28,600 --> 00:28:31,929
where I have found useful is when the

713
00:28:30,250 --> 00:28:33,880
attacker does something on like a data

714
00:28:31,930 --> 00:28:35,290
driver d drive those us and<font color="#E5E5E5"> journals get</font>

715
00:28:33,880 --> 00:28:46,300
use a lot less frequently<font color="#CCCCCC"> they</font><font color="#E5E5E5"> last for</font>

716
00:28:35,290 --> 00:28:47,620
a month that's very<font color="#E5E5E5"> cool it's so the the</font>

717
00:28:46,300 --> 00:28:49,360
journal<font color="#E5E5E5"> entries have nothing to do with</font>

718
00:28:47,620 --> 00:28:56,379
<font color="#CCCCCC">the file is deleted or anything it just</font>

719
00:28:49,360 --> 00:28:57,820
<font color="#E5E5E5">is a log that goes and correct yeah so</font>

720
00:28:56,380 --> 00:29:00,880
if<font color="#CCCCCC"> that file hasn't been modified or</font>

721
00:28:57,820 --> 00:29:02,290
deleted or renamed recently you probably

722
00:29:00,880 --> 00:29:04,750
won't see it on the<font color="#E5E5E5"> operating system</font>

723
00:29:02,290 --> 00:29:07,990
drive but so there's a chance it will be

724
00:29:04,750 --> 00:29:10,060
there<font color="#E5E5E5"> and</font><font color="#CCCCCC"> even better you know talking</font>

725
00:29:07,990 --> 00:29:12,220
about<font color="#E5E5E5"> keyword searches you may find</font>

726
00:29:10,060 --> 00:29:14,320
deleted entries and unallocated drive

727
00:29:12,220 --> 00:29:16,210
space why they're not<font color="#CCCCCC"> just in the</font><font color="#E5E5E5"> rest</font>

728
00:29:14,320 --> 00:29:18,429
of the unused uses usn journal file

729
00:29:16,210 --> 00:29:19,990
itself I don't know why is the US

730
00:29:18,430 --> 00:29:21,580
internal like fragmented all over the

731
00:29:19,990 --> 00:29:23,440
place to like the mft<font color="#E5E5E5"> I'm pretty sure is</font>

732
00:29:21,580 --> 00:29:25,659
<font color="#E5E5E5">a consistent block of clusters that</font>

733
00:29:23,440 --> 00:29:27,580
always gets<font color="#E5E5E5"> used usn journal seems to</font>

734
00:29:25,660 --> 00:29:29,290
<font color="#E5E5E5">put stuff here what's up there you'll</font>

735
00:29:27,580 --> 00:29:30,699
have keyword searches for files that you

736
00:29:29,290 --> 00:29:32,530
know we're deleted a long time ago and

737
00:29:30,700 --> 00:29:34,540
I'm allocate space very strange but

738
00:29:32,530 --> 00:29:36,310
check your keywords and this is what a

739
00:29:34,540 --> 00:29:40,300
keyword search it looks like along<font color="#CCCCCC"> with</font>

740
00:29:36,310 --> 00:29:41,830
a self promotion of my<font color="#E5E5E5"> Twitter account I</font>

741
00:29:40,300 --> 00:29:44,680
saw this one time I what the heck is

742
00:29:41,830 --> 00:29:47,889
<font color="#E5E5E5">this and I had a file name so the</font>

743
00:29:44,680 --> 00:29:50,440
example here is<font color="#CCCCCC"> file name is RS file and</font>

744
00:29:47,890 --> 00:29:51,970
you'll see this less than sign and right

745
00:29:50,440 --> 00:29:53,920
around now you'll probably see a lot of

746
00:29:51,970 --> 00:29:55,870
other less than signs with other files

747
00:29:53,920 --> 00:29:58,360
and I was like what is<font color="#CCCCCC"> this and i found</font>

748
00:29:55,870 --> 00:30:00,969
out that<font color="#E5E5E5"> that was a deleted usn journal</font>

749
00:29:58,360 --> 00:30:02,740
entry so if you<font color="#E5E5E5"> find like the structure</font>

750
00:30:00,970 --> 00:30:04,750
of the<font color="#E5E5E5"> usn journal you can go in</font><font color="#CCCCCC"> 3 out</font>

751
00:30:02,740 --> 00:30:07,210
what all those bites and hex codes mean

752
00:30:04,750 --> 00:30:09,730
and stuff so if you go back twenty eight

753
00:30:07,210 --> 00:30:12,880
characters before the file name that's

754
00:30:09,730 --> 00:30:14,770
the<font color="#CCCCCC"> time stamps the entry was created so</font>

755
00:30:12,880 --> 00:30:17,410
I know at this time Wednesday August

756
00:30:14,770 --> 00:30:19,570
third 2016 something with<font color="#CCCCCC"> that file</font>

757
00:30:17,410 --> 00:30:21,040
happen I'd have to park the rest of them

758
00:30:19,570 --> 00:30:22,780
to know if it<font color="#E5E5E5"> was renamed deleted I'm</font>

759
00:30:21,040 --> 00:30:24,430
not<font color="#E5E5E5"> that tomorrow I</font><font color="#CCCCCC"> just got excited to</font>

760
00:30:22,780 --> 00:30:27,010
see<font color="#CCCCCC"> that hit and thought it was</font><font color="#E5E5E5"> worth</font>

761
00:30:24,430 --> 00:30:28,490
sharing but if you can you can do that

762
00:30:27,010 --> 00:30:33,320
that's good stuff

763
00:30:28,490 --> 00:30:36,620
any questions on us in general ok<font color="#CCCCCC"> all</font>

764
00:30:33,320 --> 00:30:39,559
<font color="#CCCCCC">right</font><font color="#E5E5E5"> no problem so special use case</font>

765
00:30:36,620 --> 00:30:42,979
here<font color="#CCCCCC"> x elite so remember those aaabbb</font>

766
00:30:39,559 --> 00:30:45,889
<font color="#CCCCCC">CTC ddd that was actually an artifact of</font>

767
00:30:42,980 --> 00:30:48,290
a utility being run called<font color="#CCCCCC"> Esteli and</font>

768
00:30:45,890 --> 00:30:49,490
escalade is a free system<font color="#CCCCCC"> journalist</font>

769
00:30:48,290 --> 00:30:51,950
tool<font color="#CCCCCC"> i know everyone loves to talk about</font>

770
00:30:49,490 --> 00:30:55,010
this<font color="#E5E5E5"> as internal tools it's one of the</font>

771
00:30:51,950 --> 00:30:57,350
more useful ones for attackers just

772
00:30:55,010 --> 00:30:59,360
similar to TS exec and that it's a

773
00:30:57,350 --> 00:31:01,850
secure deletion utility so when you run

774
00:30:59,360 --> 00:31:05,330
XP on a file its going to overwrite the

775
00:31:01,850 --> 00:31:06,770
file name 26 times going<font color="#E5E5E5"> to however many</font>

776
00:31:05,330 --> 00:31:09,169
characters it was going to convert them

777
00:31:06,770 --> 00:31:10,580
all 2 a's all 2 b's<font color="#E5E5E5"> all to seize all the</font>

778
00:31:09,170 --> 00:31:13,820
way through Z<font color="#CCCCCC"> scene with the extension</font>

779
00:31:10,580 --> 00:31:15,590
and it's also going to overwrite the

780
00:31:13,820 --> 00:31:17,330
contents of the file a bunch of<font color="#E5E5E5"> times</font><font color="#CCCCCC"> I</font>

781
00:31:15,590 --> 00:31:19,850
<font color="#E5E5E5">don't know if it's 35 or configurable or</font>

782
00:31:17,330 --> 00:31:21,260
whatever i'm not<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> but it's going to</font>

783
00:31:19,850 --> 00:31:25,428
make it really really tough to recover

784
00:31:21,260 --> 00:31:28,670
that file and luckily though when<font color="#CCCCCC"> we see</font>

785
00:31:25,429 --> 00:31:29,960
a file name z ZZ<font color="#E5E5E5"> i'm pretty</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> normal</font>

786
00:31:28,670 --> 00:31:32,000
<font color="#E5E5E5">asleep it on the keyboard when they</font>

787
00:31:29,960 --> 00:31:34,400
named that file it's probably secure

788
00:31:32,000 --> 00:31:37,700
delete and we can often<font color="#E5E5E5"> find evidence of</font>

789
00:31:34,400 --> 00:31:39,050
that so it's<font color="#E5E5E5"> very scary because you know</font>

790
00:31:37,700 --> 00:31:43,040
home in see if you're<font color="#E5E5E5"> telling me that</font>

791
00:31:39,050 --> 00:31:45,440
<font color="#E5E5E5">all this crap is gone it's</font><font color="#CCCCCC"> okay have no</font>

792
00:31:43,040 --> 00:31:47,360
fear<font color="#CCCCCC"> esteli leaves behind some artifacts</font>

793
00:31:45,440 --> 00:31:49,370
that are useful number one if we see

794
00:31:47,360 --> 00:31:51,530
files name z or keyword searches for a

795
00:31:49,370 --> 00:31:52,760
bunch of these or<font color="#E5E5E5"> aes</font><font color="#CCCCCC"> Orbeez that's good</font>

796
00:31:51,530 --> 00:31:54,950
<font color="#E5E5E5">news to tell us that someone tried to</font>

797
00:31:52,760 --> 00:31:59,090
use<font color="#CCCCCC"> Esteli I think ccleaner will also do</font>

798
00:31:54,950 --> 00:32:00,470
<font color="#E5E5E5">this stuff but whenever you run a system</font>

799
00:31:59,090 --> 00:32:02,240
<font color="#CCCCCC">Eternals to would ask you to</font><font color="#E5E5E5"> accept the</font>

800
00:32:00,470 --> 00:32:04,550
license agreement that you<font color="#E5E5E5"> look so if</font>

801
00:32:02,240 --> 00:32:08,030
you look<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the registry you'll be able</font>

802
00:32:04,550 --> 00:32:09,889
to see if the be able to see if the user

803
00:32:08,030 --> 00:32:11,480
accepted the<font color="#CCCCCC"> you'll because it will save</font>

804
00:32:09,890 --> 00:32:14,240
<font color="#CCCCCC">it so yeah this guy already accepted it</font>

805
00:32:11,480 --> 00:32:16,670
or girl and next<font color="#E5E5E5"> time I won't ask so</font>

806
00:32:14,240 --> 00:32:18,380
you'll see that his eternal registry key

807
00:32:16,670 --> 00:32:21,679
there and keep in mind it's in the end

808
00:32:18,380 --> 00:32:24,440
to user data registry key which we can

809
00:32:21,679 --> 00:32:26,420
tie to a specific user account so if the

810
00:32:24,440 --> 00:32:29,809
attacker compromises multiple accounts

811
00:32:26,420 --> 00:32:32,870
we know which accounts they use this is

812
00:32:29,809 --> 00:32:34,370
a insane regex that<font color="#E5E5E5"> I had an idea for</font>

813
00:32:32,870 --> 00:32:36,500
but didn't create because<font color="#CCCCCC"> I don't</font>

814
00:32:34,370 --> 00:32:37,639
understand it you might not want to<font color="#E5E5E5"> try</font>

815
00:32:36,500 --> 00:32:40,550
and sign that that's<font color="#E5E5E5"> going to be brutal</font>

816
00:32:37,640 --> 00:32:42,650
<font color="#E5E5E5">but it basically it looks for I think</font>

817
00:32:40,550 --> 00:32:44,180
<font color="#E5E5E5">three letters</font>

818
00:32:42,650 --> 00:32:45,890
by a dot and<font color="#CCCCCC"> then three of the same</font>

819
00:32:44,180 --> 00:32:48,470
letter so<font color="#E5E5E5"> I hope you find a is through</font>

820
00:32:45,890 --> 00:32:50,120
<font color="#CCCCCC">Z's all kinds of</font><font color="#E5E5E5"> good stuff it's very</font>

821
00:32:48,470 --> 00:32:52,970
complicated I don't get how it works I

822
00:32:50,120 --> 00:32:54,139
<font color="#CCCCCC">think it's</font><font color="#E5E5E5"> still work but you'll want to</font>

823
00:32:52,970 --> 00:32:58,820
look for those that that's the good

824
00:32:54,140 --> 00:33:01,430
stuff another artifact that you'll see

825
00:32:58,820 --> 00:33:04,730
is of a dollar sign log file I don't use

826
00:33:01,430 --> 00:33:06,320
this one as as much as I do the<font color="#E5E5E5"> usn</font>

827
00:33:04,730 --> 00:33:09,770
journal maybe I should start but<font color="#E5E5E5"> it's</font>

828
00:33:06,320 --> 00:33:11,689
very similar record file changes and

829
00:33:09,770 --> 00:33:12,770
that files<font color="#E5E5E5"> were change they'll record a</font>

830
00:33:11,690 --> 00:33:14,000
little bit more information<font color="#CCCCCC"> I think</font>

831
00:33:12,770 --> 00:33:17,180
sinuous and general but it's kind of the

832
00:33:14,000 --> 00:33:19,250
<font color="#CCCCCC">same thing for some reason it's log file</font>

833
00:33:17,180 --> 00:33:21,500
seems to store 32,000 entries before

834
00:33:19,250 --> 00:33:23,840
rules definitely worth parsing there are

835
00:33:21,500 --> 00:33:26,450
all kinds of CSV types I are you know

836
00:33:23,840 --> 00:33:27,949
parshas that are<font color="#E5E5E5"> convert it to a CSV for</font>

837
00:33:26,450 --> 00:33:29,300
you to analyze you know give you very

838
00:33:27,950 --> 00:33:31,970
similar information what was the<font color="#E5E5E5"> file</font>

839
00:33:29,300 --> 00:33:33,350
<font color="#E5E5E5">name what happened to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and you know is</font>

840
00:33:31,970 --> 00:33:35,870
<font color="#E5E5E5">there any more information about that</font>

841
00:33:33,350 --> 00:33:38,060
just another ntfs artifact when files

842
00:33:35,870 --> 00:33:39,469
are created and modified and access

843
00:33:38,060 --> 00:33:43,879
about<font color="#E5E5E5"> what's happening where you can</font>

844
00:33:39,470 --> 00:33:45,800
find it<font color="#CCCCCC"> in case that file is</font><font color="#E5E5E5"> deleted any</font>

845
00:33:43,880 --> 00:33:47,540
questions about files that you know

846
00:33:45,800 --> 00:33:51,940
artifacts that get creative on files are

847
00:33:47,540 --> 00:33:51,940
created yes

848
00:34:01,120 --> 00:34:20,168
gotcha so the comment was<font color="#E5E5E5"> about</font>

849
00:34:17,770 --> 00:34:21,759
attackers changing the maximum size<font color="#E5E5E5"> of</font>

850
00:34:20,168 --> 00:34:24,158
log files to hide their evidence I

851
00:34:21,760 --> 00:34:26,649
personally<font color="#E5E5E5"> never never come across them</font>

852
00:34:24,159 --> 00:34:28,300
I'm sure it<font color="#CCCCCC"> happened the</font><font color="#E5E5E5"> usn</font><font color="#CCCCCC"> journal I</font>

853
00:34:26,649 --> 00:34:30,399
don't know how to change<font color="#E5E5E5"> the file the</font>

854
00:34:28,300 --> 00:34:31,870
the max record count I know there's an

855
00:34:30,399 --> 00:34:34,509
FSU till command that will change<font color="#E5E5E5"> the</font>

856
00:34:31,870 --> 00:34:35,620
file size I've never seen an attacker do

857
00:34:34,510 --> 00:34:38,110
that you know that I've dealt with does

858
00:34:35,620 --> 00:34:39,819
not saying it doesn't happen but

859
00:34:38,110 --> 00:34:42,490
certainly like<font color="#CCCCCC"> Windows event logs yeah</font>

860
00:34:39,820 --> 00:34:46,300
they'll do that and I don't<font color="#CCCCCC"> see</font>

861
00:34:42,489 --> 00:34:48,428
attackers that I deal with change the

862
00:34:46,300 --> 00:34:50,350
event<font color="#E5E5E5"> log sizes but they'll clear it</font>

863
00:34:48,429 --> 00:34:52,090
they'll just say let's take all the

864
00:34:50,350 --> 00:34:54,250
events in there that I just made<font color="#CCCCCC"> it and</font>

865
00:34:52,090 --> 00:34:55,960
delete them which leaves behind an event

866
00:34:54,250 --> 00:34:58,180
log saying this event log has<font color="#CCCCCC"> been</font>

867
00:34:55,960 --> 00:34:59,170
cleared so that's useful you know the

868
00:34:58,180 --> 00:35:01,299
event logs are gone but you know they

869
00:34:59,170 --> 00:35:02,650
were there at a certain time but yeah I

870
00:35:01,300 --> 00:35:04,390
mean<font color="#E5E5E5"> there's all kinds of anti forensic</font>

871
00:35:02,650 --> 00:35:06,160
activities you can take to mess some of

872
00:35:04,390 --> 00:35:07,870
this stuff up we're recovering a lot of

873
00:35:06,160 --> 00:35:10,210
batch scripts of<font color="#E5E5E5"> attackers creating like</font>

874
00:35:07,870 --> 00:35:12,790
mr<font color="#CCCCCC"> you keys and user assist</font><font color="#E5E5E5"> keys and</font>

875
00:35:10,210 --> 00:35:14,290
she'll bags like say they know<font color="#CCCCCC"> about it</font>

876
00:35:12,790 --> 00:35:16,810
because<font color="#CCCCCC"> i'm up you're talking about it i</font>

877
00:35:14,290 --> 00:35:20,740
guess so that's<font color="#CCCCCC"> ok keeps me in the in</font>

878
00:35:16,810 --> 00:35:22,870
the hunt any other questions got about

879
00:35:20,740 --> 00:35:24,939
<font color="#CCCCCC">ten minutes so we're going to go these</font>

880
00:35:22,870 --> 00:35:27,220
are some<font color="#E5E5E5"> artifacts about files with that</font>

881
00:35:24,940 --> 00:35:30,220
that get created one files get access or

882
00:35:27,220 --> 00:35:34,450
modified by a user or executed or<font color="#E5E5E5"> access</font>

883
00:35:30,220 --> 00:35:39,189
by an application CCM recently used apps

884
00:35:34,450 --> 00:35:43,779
this is a really useful artifact that is

885
00:35:39,190 --> 00:35:46,210
enabled in an enterprise where the IT

886
00:35:43,780 --> 00:35:48,160
team is using sec how much like a

887
00:35:46,210 --> 00:35:51,580
<font color="#CCCCCC">built-in Microsoft management</font>

888
00:35:48,160 --> 00:35:54,580
application where they can install

889
00:35:51,580 --> 00:35:56,710
software and install updates and stuff

890
00:35:54,580 --> 00:35:57,880
get an inventory of all their assets but

891
00:35:56,710 --> 00:35:59,650
<font color="#E5E5E5">they can also turn on this feature</font>

892
00:35:57,880 --> 00:36:01,840
called software metering and all that

893
00:35:59,650 --> 00:36:03,310
does is say let's keep track of all the

894
00:36:01,840 --> 00:36:05,080
applications that<font color="#CCCCCC"> are running because I</font>

895
00:36:03,310 --> 00:36:07,570
want to<font color="#E5E5E5"> know are people using the</font>

896
00:36:05,080 --> 00:36:09,160
expensive software we<font color="#CCCCCC"> pay for are they</font>

897
00:36:07,570 --> 00:36:11,170
you know<font color="#E5E5E5"> using applications are not</font>

898
00:36:09,160 --> 00:36:14,109
supposed to be using which is<font color="#CCCCCC"> what</font>

899
00:36:11,170 --> 00:36:15,070
attackers do I guess and so<font color="#CCCCCC"> all this</font>

900
00:36:14,109 --> 00:36:17,590
data<font color="#CCCCCC"> is too</font>

901
00:36:15,070 --> 00:36:19,270
gets saved up and hey what applications

902
00:36:17,590 --> 00:36:20,980
<font color="#CCCCCC">run it</font><font color="#E5E5E5"> gets sent to their you</font><font color="#CCCCCC"> know main</font>

903
00:36:19,270 --> 00:36:22,960
server where I assume they run

904
00:36:20,980 --> 00:36:24,640
diagnostics and analytics on it I don't

905
00:36:22,960 --> 00:36:26,110
<font color="#E5E5E5">know but it does we find some really</font>

906
00:36:24,640 --> 00:36:27,790
<font color="#E5E5E5">cool host-based artifacts that you can</font>

907
00:36:26,110 --> 00:36:30,070
find from a keyword search if you search

908
00:36:27,790 --> 00:36:32,020
in this example for<font color="#E5E5E5"> X lead I exe across</font>

909
00:36:30,070 --> 00:36:34,780
<font color="#E5E5E5">the drive you may</font><font color="#CCCCCC"> have a keyword hit</font>

910
00:36:32,020 --> 00:36:36,730
that followed you know if that's

911
00:36:34,780 --> 00:36:41,800
following the keyword TPM recently used

912
00:36:36,730 --> 00:36:44,500
apps this this functionality seems to

913
00:36:41,800 --> 00:36:46,660
sort these logs in the windows<font color="#E5E5E5"> wmi repo</font>

914
00:36:44,500 --> 00:36:48,430
it's a bit complicated<font color="#E5E5E5"> wmi is like</font>

915
00:36:46,660 --> 00:36:50,440
windows management instrumentation

916
00:36:48,430 --> 00:36:51,669
something that controls the lots of

917
00:36:50,440 --> 00:36:54,010
stuff in<font color="#E5E5E5"> Windows that's very complicated</font>

918
00:36:51,670 --> 00:36:55,780
but these SCCM software meeting your

919
00:36:54,010 --> 00:36:58,240
metering logs stores they're like

920
00:36:55,780 --> 00:37:01,090
host-based logs in this a repository

921
00:36:58,240 --> 00:37:02,350
don't have to pass for<font color="#E5E5E5"> you again it's</font>

922
00:37:01,090 --> 00:37:03,430
probably only enterprise only so if

923
00:37:02,350 --> 00:37:06,700
you're working in<font color="#E5E5E5"> law enforcement you</font>

924
00:37:03,430 --> 00:37:08,169
may not come across this as much but

925
00:37:06,700 --> 00:37:12,100
you'll have keyword search hits there

926
00:37:08,170 --> 00:37:14,350
and you also see things like 2015 07 24

927
00:37:12,100 --> 00:37:15,580
that's a date and a time stamp that

928
00:37:14,350 --> 00:37:20,049
sounds pretty cool what the heck<font color="#CCCCCC"> is that</font>

929
00:37:15,580 --> 00:37:21,910
let's take a look so here<font color="#E5E5E5"> we have all</font>

930
00:37:20,050 --> 00:37:23,260
these fields<font color="#CCCCCC"> that are recovered and on</font>

931
00:37:21,910 --> 00:37:26,170
the previous slide I had a little<font color="#E5E5E5"> blurb</font>

932
00:37:23,260 --> 00:37:28,270
that said they can<font color="#CCCCCC"> either be all these</font>

933
00:37:26,170 --> 00:37:30,520
fields<font color="#E5E5E5"> are delimited by</font><font color="#CCCCCC"> to know bytes or</font>

934
00:37:28,270 --> 00:37:31,780
<font color="#CCCCCC">is it's a cool XML structure that tells</font>

935
00:37:30,520 --> 00:37:34,600
you what<font color="#CCCCCC"> the fields are it's</font><font color="#E5E5E5"> very useful</font>

936
00:37:31,780 --> 00:37:38,680
but you'll have company name filename

937
00:37:34,600 --> 00:37:42,040
file description last use time very

938
00:37:38,680 --> 00:37:44,410
<font color="#E5E5E5">useful last username very useful and a</font>

939
00:37:42,040 --> 00:37:48,400
launch count so how many times this ran

940
00:37:44,410 --> 00:37:49,990
similar to like user<font color="#CCCCCC"> assist so what W my</font>

941
00:37:48,400 --> 00:37:53,080
repository is sword in the<font color="#CCCCCC"> object-side</font>

942
00:37:49,990 --> 00:37:54,549
data file<font color="#E5E5E5"> fairies on vista and XP some</font>

943
00:37:53,080 --> 00:37:55,660
guy wrote a blog post trash on my<font color="#E5E5E5"> porch</font>

944
00:37:54,550 --> 00:37:56,770
on<font color="#CCCCCC"> this he said he couldn't</font><font color="#E5E5E5"> get to run</font>

945
00:37:55,660 --> 00:37:58,330
out what the deal<font color="#E5E5E5"> was it but he said</font>

946
00:37:56,770 --> 00:38:00,310
that<font color="#CCCCCC"> he finds use repositories in other</font>

947
00:37:58,330 --> 00:38:02,110
spaces sometimes just look<font color="#CCCCCC"> for the file</font>

948
00:38:00,310 --> 00:38:04,390
name object data I don't know where the

949
00:38:02,110 --> 00:38:06,490
file is just making any case file name

950
00:38:04,390 --> 00:38:09,279
filter you'll find it we also<font color="#E5E5E5"> have</font>

951
00:38:06,490 --> 00:38:11,589
keyword searches in this inventory sorta

952
00:38:09,280 --> 00:38:12,850
<font color="#E5E5E5">SDF file I wish is a contact sequel</font>

953
00:38:11,590 --> 00:38:13,990
database that you have to extract so

954
00:38:12,850 --> 00:38:16,360
brandish on door if you guys may know

955
00:38:13,990 --> 00:38:18,250
him he ruler tool that extract it for me

956
00:38:16,360 --> 00:38:19,750
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then I look for</font><font color="#E5E5E5"> the key word but</font>

957
00:38:18,250 --> 00:38:23,260
sometimes<font color="#CCCCCC"> you'll have decompressed</font>

958
00:38:19,750 --> 00:38:25,150
keywords in there so it's about<font color="#E5E5E5"> to get a</font>

959
00:38:23,260 --> 00:38:28,990
little<font color="#E5E5E5"> technical so c3 feels pretty</font>

960
00:38:25,150 --> 00:38:30,850
upset you know we talked about

961
00:38:28,990 --> 00:38:33,220
I'll version company name where's all

962
00:38:30,850 --> 00:38:35,230
that stuff come from so in an executable

963
00:38:33,220 --> 00:38:36,669
file it has a header and in that header

964
00:38:35,230 --> 00:38:38,590
keeps track of some of this information

965
00:38:36,670 --> 00:38:40,990
like who is the author what's the

966
00:38:38,590 --> 00:38:42,550
version what's the compile time Sam some

967
00:38:40,990 --> 00:38:44,560
of that information gets recorded in

968
00:38:42,550 --> 00:38:47,890
here this is also<font color="#CCCCCC"> that information just</font>

969
00:38:44,560 --> 00:38:49,600
parked out into a<font color="#E5E5E5"> CSV file most</font>

970
00:38:47,890 --> 00:38:51,129
legitimate files are going to have that

971
00:38:49,600 --> 00:38:54,730
header information that's going to be

972
00:38:51,130 --> 00:38:56,980
the company's author the user<font color="#E5E5E5"> so if you</font>

973
00:38:54,730 --> 00:38:58,570
look at this spreadsheet besides the

974
00:38:56,980 --> 00:39:02,890
bright yellow<font color="#CCCCCC"> you know what stands out</font>

975
00:38:58,570 --> 00:39:05,050
to me it's the lack of information in

976
00:39:02,890 --> 00:39:07,180
some of the entries so you know<font color="#CCCCCC"> estelí</font>

977
00:39:05,050 --> 00:39:10,780
is a real tool that's created by

978
00:39:07,180 --> 00:39:12,490
<font color="#CCCCCC">Microsoft it has a company</font><font color="#E5E5E5"> name has file</font>

979
00:39:10,780 --> 00:39:14,830
description file version same with rah

980
00:39:12,490 --> 00:39:16,540
rah txt which can attackers used to make

981
00:39:14,830 --> 00:39:19,779
archives as their files and extract

982
00:39:16,540 --> 00:39:21,400
files but adobe arm chrome dhcp w grab

983
00:39:19,780 --> 00:39:23,170
at 5442 that you see those don't have

984
00:39:21,400 --> 00:39:24,310
that information which tells me either

985
00:39:23,170 --> 00:39:25,600
someone<font color="#E5E5E5"> like myself who's really</font>

986
00:39:24,310 --> 00:39:27,009
terrible at coding wrote it or someone

987
00:39:25,600 --> 00:39:29,319
<font color="#E5E5E5">who doesn't</font><font color="#CCCCCC"> care about</font><font color="#E5E5E5"> version numbers</font>

988
00:39:27,010 --> 00:39:30,640
and course trying not to you know create

989
00:39:29,320 --> 00:39:31,900
a signature<font color="#E5E5E5"> because if they put this was</font>

990
00:39:30,640 --> 00:39:35,529
made<font color="#CCCCCC"> by a rush oh that's</font><font color="#E5E5E5"> going to be a</font>

991
00:39:31,900 --> 00:39:37,420
pretty pretty easy to find so the lack

992
00:39:35,530 --> 00:39:38,980
of that information will stand out also

993
00:39:37,420 --> 00:39:40,960
all these files are created in<font color="#CCCCCC"> ce temps</font>

994
00:39:38,980 --> 00:39:42,910
they'll all have a user accounting

995
00:39:40,960 --> 00:39:44,800
that's can be useful to us and the last

996
00:39:42,910 --> 00:39:46,810
user the last use timestamp can be

997
00:39:44,800 --> 00:39:50,710
pretty useful one of my favorite

998
00:39:46,810 --> 00:39:53,529
artifacts is fine actually<font color="#CCCCCC"> I have a blog</font>

999
00:39:50,710 --> 00:39:55,990
post on it that do you see what I see

1000
00:39:53,530 --> 00:39:59,320
see they cut the em off at<font color="#CCCCCC"> the end of</font>

1001
00:39:55,990 --> 00:40:00,459
the URL<font color="#E5E5E5"> or whatever and I have a parser</font>

1002
00:39:59,320 --> 00:40:02,109
that you can run<font color="#E5E5E5"> on objects that</font>

1003
00:40:00,460 --> 00:40:03,970
datafile they'll pull this stuff out no

1004
00:40:02,109 --> 00:40:06,819
dependencies required super easy to<font color="#E5E5E5"> run</font>

1005
00:40:03,970 --> 00:40:08,259
if you like<font color="#E5E5E5"> going crazy with Linux</font>

1006
00:40:06,820 --> 00:40:10,570
virtual machines you can install<font color="#E5E5E5"> our</font>

1007
00:40:08,260 --> 00:40:14,530
fire I<font color="#CCCCCC"> lives adventurous engineering</font>

1008
00:40:10,570 --> 00:40:15,820
utility pythons in which a little bit of

1009
00:40:14,530 --> 00:40:17,590
work to<font color="#E5E5E5"> get it set up but that'll</font>

1010
00:40:15,820 --> 00:40:19,840
actually open up the repository I'm just

1011
00:40:17,590 --> 00:40:24,010
carving them out like kind<font color="#E5E5E5"> of get out so</font>

1012
00:40:19,840 --> 00:40:26,290
it's<font color="#E5E5E5"> fun file system files is another</font>

1013
00:40:24,010 --> 00:40:27,400
pretty<font color="#E5E5E5"> much the exact same artifacts</font>

1014
00:40:26,290 --> 00:40:28,840
that I've seen<font color="#CCCCCC"> sort in there I</font><font color="#E5E5E5"> don't</font>

1015
00:40:27,400 --> 00:40:30,070
know why they're stored in there I

1016
00:40:28,840 --> 00:40:32,080
haven't<font color="#E5E5E5"> really figured this stuff out</font>

1017
00:40:30,070 --> 00:40:34,359
you know there goes Davey does<font color="#CCCCCC"> only</font>

1018
00:40:32,080 --> 00:40:35,470
<font color="#E5E5E5">notice talking out about</font><font color="#CCCCCC"> out again but</font>

1019
00:40:34,359 --> 00:40:37,569
<font color="#E5E5E5">there's a technical article that</font>

1020
00:40:35,470 --> 00:40:39,850
describes<font color="#E5E5E5"> there's just files that are</font>

1021
00:40:37,570 --> 00:40:41,230
created and w my records that they exist

1022
00:40:39,850 --> 00:40:42,930
so you'll see these in keyword search

1023
00:40:41,230 --> 00:40:44,730
<font color="#CCCCCC">hits luckily</font>

1024
00:40:42,930 --> 00:40:46,410
this is an SMS based format like you

1025
00:40:44,730 --> 00:40:47,760
mentioned so it'll tell you exactly what

1026
00:40:46,410 --> 00:40:49,740
the fields are you won't have to guess

1027
00:40:47,760 --> 00:40:52,920
it'll tell you in their product language

1028
00:40:49,740 --> 00:40:55,828
what the name<font color="#CCCCCC"> of the file is the size</font>

1029
00:40:52,920 --> 00:40:57,059
productversion very useful here's just a

1030
00:40:55,829 --> 00:40:59,309
list of the field you won't<font color="#E5E5E5"> get that</font>

1031
00:40:57,059 --> 00:41:00,059
last user time so I don't I can't<font color="#CCCCCC"> you</font>

1032
00:40:59,309 --> 00:41:01,619
<font color="#CCCCCC">know I don't</font><font color="#E5E5E5"> want to say that these</font>

1033
00:41:00,059 --> 00:41:03,510
files have been<font color="#E5E5E5"> executed cuz i don't</font>

1034
00:41:01,619 --> 00:41:05,430
know there's you know<font color="#E5E5E5"> there are present</font>

1035
00:41:03,510 --> 00:41:07,619
on the system at some point in time you

1036
00:41:05,430 --> 00:41:09,779
may get a size of half a size can be

1037
00:41:07,619 --> 00:41:11,700
almost as useful as a hash sometimes if

1038
00:41:09,780 --> 00:41:15,540
you you know<font color="#E5E5E5"> have the same file name and</font>

1039
00:41:11,700 --> 00:41:17,279
the same file size I mean maybe it's uh

1040
00:41:15,540 --> 00:41:19,290
you know you can you can make some

1041
00:41:17,280 --> 00:41:21,540
assumptions but you're ready<font color="#E5E5E5"> to back</font>

1042
00:41:19,290 --> 00:41:25,710
that up and the data is stored in<font color="#E5E5E5"> the</font>

1043
00:41:21,540 --> 00:41:28,558
same place next up we have Windows

1044
00:41:25,710 --> 00:41:31,079
Defender AP 29 case study anybody

1045
00:41:28,559 --> 00:41:33,420
familiar with Windows Defender it's like

1046
00:41:31,079 --> 00:41:36,270
microsoft antivirus you know it's built

1047
00:41:33,420 --> 00:41:38,970
in getting pretty<font color="#CCCCCC"> good Microsoft's</font>

1048
00:41:36,270 --> 00:41:41,250
advanced threat protection<font color="#CCCCCC"> there ATP not</font>

1049
00:41:38,970 --> 00:41:42,149
the<font color="#E5E5E5"> EPT is actually getting really</font>

1050
00:41:41,250 --> 00:41:44,309
really good it's going to be

1051
00:41:42,150 --> 00:41:45,839
commercially to detect anomalies and

1052
00:41:44,309 --> 00:41:47,520
stop attackers and attracts like it it's

1053
00:41:45,839 --> 00:41:50,099
<font color="#E5E5E5">pretty cool stuff but windows defender</font>

1054
00:41:47,520 --> 00:41:51,599
is built in like so almost every version

1055
00:41:50,099 --> 00:41:53,970
of Windows the workstation should have

1056
00:41:51,599 --> 00:41:55,380
it enabled by default enterprise and I

1057
00:41:53,970 --> 00:41:59,430
think you know home users as well

1058
00:41:55,380 --> 00:42:01,589
servers it might not be running<font color="#E5E5E5"> a super</font>

1059
00:41:59,430 --> 00:42:04,049
bad job at detecting and<font color="#E5E5E5"> store at</font>

1060
00:42:01,589 --> 00:42:05,790
stopping a PG 29 it's just like I guess

1061
00:42:04,049 --> 00:42:07,589
I'm not<font color="#E5E5E5"> going to stop</font><font color="#CCCCCC"> you but it did a</font>

1062
00:42:05,790 --> 00:42:09,180
great job scanning the<font color="#CCCCCC"> file so I mean it</font>

1063
00:42:07,589 --> 00:42:12,450
did scan them and told<font color="#E5E5E5"> me that it scan</font>

1064
00:42:09,180 --> 00:42:14,730
them it's just forgot<font color="#CCCCCC"> to stop them you</font>

1065
00:42:12,450 --> 00:42:16,859
can find the defender log file in this

1066
00:42:14,730 --> 00:42:18,210
path with a date before you know the

1067
00:42:16,859 --> 00:42:20,819
dodges dots are going to be a date and

1068
00:42:18,210 --> 00:42:22,230
<font color="#CCCCCC">Microsoft anti-malware is the same kind</font>

1069
00:42:20,819 --> 00:42:23,880
<font color="#E5E5E5">of thing but a little</font><font color="#CCCCCC"> different not sure</font>

1070
00:42:22,230 --> 00:42:25,260
which one's newer ones better I<font color="#E5E5E5"> don't</font>

1071
00:42:23,880 --> 00:42:26,700
know but they have you know<font color="#E5E5E5"> the same</font>

1072
00:42:25,260 --> 00:42:30,390
<font color="#E5E5E5">kind of log file that you can find</font>

1073
00:42:26,700 --> 00:42:33,000
they're quite a keyword search<font color="#CCCCCC"> hit</font><font color="#E5E5E5"> for</font>

1074
00:42:30,390 --> 00:42:36,150
and we looked at this earlier<font color="#E5E5E5"> 5442 exe</font>

1075
00:42:33,000 --> 00:42:39,210
<font color="#CCCCCC">attempt past that doesn't look so good</font>

1076
00:42:36,150 --> 00:42:40,980
that was<font color="#E5E5E5"> actually because they executed</font>

1077
00:42:39,210 --> 00:42:42,359
out of an email is a phishing email that

1078
00:42:40,980 --> 00:42:44,430
they double clicked it made it in a temp

1079
00:42:42,359 --> 00:42:45,930
directory and then<font color="#E5E5E5"> they ran this they</font>

1080
00:42:44,430 --> 00:42:47,549
thought<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was a zip file or something</font>

1081
00:42:45,930 --> 00:42:51,000
but it says oh you know I'm going<font color="#CCCCCC"> to</font>

1082
00:42:47,549 --> 00:42:52,500
scan this file at this time file cowboy

1083
00:42:51,000 --> 00:42:54,450
scanning one other words something else

1084
00:42:52,500 --> 00:42:56,910
useful

1085
00:42:54,450 --> 00:42:58,680
I guess<font color="#E5E5E5"> that's all we need to know maybe</font>

1086
00:42:56,910 --> 00:43:01,200
<font color="#E5E5E5">that's the pit of the process of running</font>

1087
00:42:58,680 --> 00:43:03,270
but I know at this time that file was

1088
00:43:01,200 --> 00:43:05,879
present on the system I don't know if it

1089
00:43:03,270 --> 00:43:07,530
was executing doesn't tell me<font color="#E5E5E5"> it was bad</font>

1090
00:43:05,880 --> 00:43:13,050
but I know it was on<font color="#E5E5E5"> the system at that</font>

1091
00:43:07,530 --> 00:43:14,940
point i'm so that very<font color="#CCCCCC"> useful yeah that</font>

1092
00:43:13,050 --> 00:43:18,720
makes sense yeah so is it<font color="#E5E5E5"> means probably</font>

1093
00:43:14,940 --> 00:43:21,359
run it's got that process ID so we know

1094
00:43:18,720 --> 00:43:23,189
all that good stuff so I thought let's

1095
00:43:21,359 --> 00:43:24,328
you know scroll it's just a text file at

1096
00:43:23,190 --> 00:43:26,460
scroll around and see what else we can

1097
00:43:24,329 --> 00:43:27,990
find there's got to be other stuff I was

1098
00:43:26,460 --> 00:43:30,570
pretty<font color="#E5E5E5"> psyched I think General Grievous</font>

1099
00:43:27,990 --> 00:43:32,040
is one of the coolest Star Wars guys

1100
00:43:30,570 --> 00:43:35,640
<font color="#E5E5E5">because who doesn't wish they had four</font>

1101
00:43:32,040 --> 00:43:38,970
lightsabers but it you know we look

1102
00:43:35,640 --> 00:43:40,828
shortly after that oh sorry<font color="#E5E5E5"> I thought it</font>

1103
00:43:38,970 --> 00:43:43,410
was<font color="#E5E5E5"> on the next</font><font color="#CCCCCC"> slide it was just mr.</font>

1104
00:43:40,829 --> 00:43:45,150
<font color="#E5E5E5">lightsaber so I scrolled around and I</font>

1105
00:43:43,410 --> 00:43:48,660
saw oh look at these other files that

1106
00:43:45,150 --> 00:43:51,690
are in<font color="#CCCCCC"> C temp esteli we know that's bad</font>

1107
00:43:48,660 --> 00:43:53,250
chrome da da Jie I mean maybe you can

1108
00:43:51,690 --> 00:43:56,910
browse your internet out<font color="#E5E5E5"> of the temp</font>

1109
00:43:53,250 --> 00:44:00,660
directory I don't know pw grab probably

1110
00:43:56,910 --> 00:44:02,819
a password grabber<font color="#CCCCCC"> on and they were all</font>

1111
00:44:00,660 --> 00:44:04,500
created or scanned so they're all

1112
00:44:02,819 --> 00:44:05,790
scanned around the same time something

1113
00:44:04,500 --> 00:44:07,890
and these are<font color="#CCCCCC"> all attacker utilities</font>

1114
00:44:05,790 --> 00:44:10,259
that Windows Defender thought were I

1115
00:44:07,890 --> 00:44:12,270
guess ok actually it of course is a

1116
00:44:10,260 --> 00:44:14,640
legitimate file aight inventoried I VBS

1117
00:44:12,270 --> 00:44:17,130
was not and we knew that this adobe

1118
00:44:14,640 --> 00:44:19,920
armed exe file name was dad from before

1119
00:44:17,130 --> 00:44:21,060
excuse me but Windows Defender did a

1120
00:44:19,920 --> 00:44:23,220
great job telling me that all these

1121
00:44:21,060 --> 00:44:25,710
files were present on the system at some

1122
00:44:23,220 --> 00:44:28,618
point i'm han solo was super impressed

1123
00:44:25,710 --> 00:44:30,869
at this and then Chewbacca was even more

1124
00:44:28,619 --> 00:44:32,339
impressed when<font color="#CCCCCC"> i wrote a parser that</font>

1125
00:44:30,869 --> 00:44:34,890
just pulled<font color="#E5E5E5"> out all that text and so</font>

1126
00:44:32,339 --> 00:44:36,359
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the scan start time this is the</font>

1127
00:44:34,890 --> 00:44:39,000
resource path of the file name and<font color="#E5E5E5"> we</font>

1128
00:44:36,359 --> 00:44:43,049
could do this in Excel all day long it

1129
00:44:39,000 --> 00:44:45,359
was good stuff so<font color="#E5E5E5"> that's my son with</font><font color="#CCCCCC"> the</font>

1130
00:44:43,050 --> 00:44:47,369
windows defender we saw some time going

1131
00:44:45,359 --> 00:44:49,259
on<font color="#CCCCCC"> I think let's talk</font><font color="#E5E5E5"> about the</font>

1132
00:44:47,369 --> 00:44:51,329
application compatibility cash this has

1133
00:44:49,260 --> 00:44:54,060
been around for a while I think maybe

1134
00:44:51,329 --> 00:44:56,819
has a blog post or a white paper that

1135
00:44:54,060 --> 00:44:58,770
<font color="#CCCCCC">came out 2012 2013 but</font><font color="#E5E5E5"> basically</font>

1136
00:44:56,819 --> 00:45:00,480
whenever you<font color="#E5E5E5"> like try and install an old</font>

1137
00:44:58,770 --> 00:45:02,880
file like roller coaster tycoon the

1138
00:45:00,480 --> 00:45:04,650
original I've done that recently like my

1139
00:45:02,880 --> 00:45:07,650
favorite downly have an<font color="#CCCCCC"> ipad app so</font>

1140
00:45:04,650 --> 00:45:08,880
great but window says is

1141
00:45:07,650 --> 00:45:10,920
version of<font color="#E5E5E5"> Windows going to be</font><font color="#CCCCCC"> able to</font>

1142
00:45:08,880 --> 00:45:11,850
run this application and it'll say you

1143
00:45:10,920 --> 00:45:13,440
may want to reinstall us with

1144
00:45:11,850 --> 00:45:15,660
compatibility settings whatever when it

1145
00:45:13,440 --> 00:45:17,460
does that check it looks for any gaps or

1146
00:45:15,660 --> 00:45:18,690
issues and then it tries to like shim

1147
00:45:17,460 --> 00:45:19,950
the code up for anyone who's not

1148
00:45:18,690 --> 00:45:20,970
familiar with what a shim is it's a

1149
00:45:19,950 --> 00:45:22,500
<font color="#E5E5E5">little piece</font><font color="#CCCCCC"> of wood that you put like</font>

1150
00:45:20,970 --> 00:45:24,270
in like a window to<font color="#CCCCCC"> make it fit better</font>

1151
00:45:22,500 --> 00:45:25,950
same kind of thing they're putting

1152
00:45:24,270 --> 00:45:28,170
little shims of code in there to help it

1153
00:45:25,950 --> 00:45:30,390
run depending on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> operating system</font>

1154
00:45:28,170 --> 00:45:33,930
it'll keep track of a file path file

1155
00:45:30,390 --> 00:45:36,299
size last modified<font color="#E5E5E5"> time not execution</font>

1156
00:45:33,930 --> 00:45:37,950
time whether or not it<font color="#CCCCCC"> was executed you</font>

1157
00:45:36,300 --> 00:45:39,510
may or may not have this flag depending

1158
00:45:37,950 --> 00:45:41,100
on your operating system version and you

1159
00:45:39,510 --> 00:45:43,380
may get<font color="#E5E5E5"> a file created</font><font color="#CCCCCC"> time stamp but</font><font color="#E5E5E5"> I</font>

1160
00:45:41,100 --> 00:45:44,940
don't really see<font color="#CCCCCC"> that I don't care about</font>

1161
00:45:43,380 --> 00:45:46,890
their registry path it's in the system

1162
00:45:44,940 --> 00:45:48,750
hive extract the system registry hive

1163
00:45:46,890 --> 00:45:50,009
and run mandiant shim cash parts<font color="#CCCCCC"> on it</font>

1164
00:45:48,750 --> 00:45:52,950
<font color="#CCCCCC">and you'll</font><font color="#E5E5E5"> get the good stuff that you</font>

1165
00:45:50,010 --> 00:45:56,850
<font color="#CCCCCC">need here's what it looks like kind</font><font color="#E5E5E5"> of</font>

1166
00:45:52,950 --> 00:45:58,560
um it will<font color="#E5E5E5"> give you the last modified</font>

1167
00:45:56,850 --> 00:46:00,180
timestamp there's just a copy of the

1168
00:45:58,560 --> 00:46:02,430
standard information last modified time

1169
00:46:00,180 --> 00:46:04,680
skin that is not the time the file was

1170
00:46:02,430 --> 00:46:06,600
added to the shim cash keep that in mind

1171
00:46:04,680 --> 00:46:10,470
people will say<font color="#CCCCCC"> this follow excuse on</font>

1172
00:46:06,600 --> 00:46:12,299
<font color="#CCCCCC">824 no it did not as do the shim cash or</font>

1173
00:46:10,470 --> 00:46:13,680
sorry it was it's<font color="#E5E5E5"> not the time as out of</font>

1174
00:46:12,300 --> 00:46:16,380
the shim cash it sets when that file was

1175
00:46:13,680 --> 00:46:17,790
last modified on dip it'll just<font color="#E5E5E5"> kind of</font>

1176
00:46:16,380 --> 00:46:19,110
roll through<font color="#E5E5E5"> the logs again it'll put</font>

1177
00:46:17,790 --> 00:46:21,840
the oldest stuff at the bottom<font color="#E5E5E5"> so</font>

1178
00:46:19,110 --> 00:46:23,490
obi-wan executed or we have our

1179
00:46:21,840 --> 00:46:25,230
execution fly here or we want to execute

1180
00:46:23,490 --> 00:46:28,049
it Anakin executors and Biggs importance

1181
00:46:25,230 --> 00:46:29,430
all that good stuff keep in mind it's

1182
00:46:28,050 --> 00:46:32,220
only written to the registry when the

1183
00:46:29,430 --> 00:46:33,720
operating system shuts down and if you

1184
00:46:32,220 --> 00:46:35,189
get there before the operating system

1185
00:46:33,720 --> 00:46:37,200
<font color="#E5E5E5">shut down you have to get a memory image</font>

1186
00:46:35,190 --> 00:46:38,970
and then run shrimp cash man pluck in

1187
00:46:37,200 --> 00:46:41,790
which a couple of our guys wrote and is

1188
00:46:38,970 --> 00:46:43,709
really<font color="#E5E5E5"> great almost done i know it's</font>

1189
00:46:41,790 --> 00:46:47,640
lunchtime<font color="#CCCCCC"> lunch</font><font color="#E5E5E5"> time I can told you guys</font>

1190
00:46:43,710 --> 00:46:49,020
all day that's fine just kidding so

1191
00:46:47,640 --> 00:46:50,220
windows prefetch I know when those

1192
00:46:49,020 --> 00:46:53,340
prefetch is taught here so hopefully

1193
00:46:50,220 --> 00:46:54,419
<font color="#E5E5E5">some you guys have seen it depending on</font>

1194
00:46:53,340 --> 00:46:56,700
<font color="#CCCCCC">the operating system I think</font><font color="#E5E5E5"> it will</font>

1195
00:46:54,420 --> 00:46:59,250
<font color="#CCCCCC">sort a different number of files or</font>

1196
00:46:56,700 --> 00:47:01,680
records but it will keep track of one

1197
00:46:59,250 --> 00:47:03,510
and<font color="#E5E5E5"> the one that file execute what were</font>

1198
00:47:01,680 --> 00:47:05,430
the files that<font color="#E5E5E5"> use within 10 seconds</font>

1199
00:47:03,510 --> 00:47:07,020
that it probably loaded data from that

1200
00:47:05,430 --> 00:47:09,960
way it knows where to find them next

1201
00:47:07,020 --> 00:47:11,820
time keep in mind it's disabled by

1202
00:47:09,960 --> 00:47:13,740
default<font color="#CCCCCC"> Windows Server so if someone</font>

1203
00:47:11,820 --> 00:47:15,120
like hacks your domain controller or

1204
00:47:13,740 --> 00:47:17,339
something you're<font color="#E5E5E5"> not going to have this</font>

1205
00:47:15,120 --> 00:47:20,040
artifact on<font color="#E5E5E5"> there most likely and that's</font>

1206
00:47:17,340 --> 00:47:20,730
because<font color="#E5E5E5"> it's used to speed you know when</font>

1207
00:47:20,040 --> 00:47:23,040
<font color="#E5E5E5">applicate</font>

1208
00:47:20,730 --> 00:47:24,660
and start when the system reboot and

1209
00:47:23,040 --> 00:47:29,220
<font color="#E5E5E5">servers don't really reboot they're</font>

1210
00:47:24,660 --> 00:47:30,690
pretty stable hopefully I there's a

1211
00:47:29,220 --> 00:47:32,040
whole bunch<font color="#E5E5E5"> of part because i like the</font>

1212
00:47:30,690 --> 00:47:34,260
low and<font color="#E5E5E5"> where lon here's another one</font>

1213
00:47:32,040 --> 00:47:37,770
that's good but<font color="#CCCCCC"> it'll tell you the name</font>

1214
00:47:34,260 --> 00:47:40,200
of executable a little hash that will be

1215
00:47:37,770 --> 00:47:42,660
unique<font color="#E5E5E5"> to that files tap so if iran says</font>

1216
00:47:40,200 --> 00:47:43,830
phasmid exe out of see windows and then

1217
00:47:42,660 --> 00:47:45,359
I ran<font color="#E5E5E5"> it out</font><font color="#CCCCCC"> of see I'm going to have</font>

1218
00:47:43,830 --> 00:47:47,340
two entries with two different ash

1219
00:47:45,360 --> 00:47:50,340
values there<font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> give you the time</font>

1220
00:47:47,340 --> 00:47:52,350
<font color="#CCCCCC">that at last</font><font color="#E5E5E5"> ran the files the prefetch</font>

1221
00:47:50,340 --> 00:47:54,420
file itself to dot<font color="#E5E5E5"> PS files creation</font>

1222
00:47:52,350 --> 00:47:56,100
time<font color="#E5E5E5"> will be when that file first ran</font>

1223
00:47:54,420 --> 00:47:57,330
hopefully you know you think when I

1224
00:47:56,100 --> 00:47:59,130
first ones that'll create this prefetch

1225
00:47:57,330 --> 00:48:00,660
time<font color="#E5E5E5"> I'll give you a number of times I</font>

1226
00:47:59,130 --> 00:48:02,220
ran and then it also gives you<font color="#E5E5E5"> a list of</font>

1227
00:48:00,660 --> 00:48:05,819
all the files<font color="#E5E5E5"> that it touch within 10</font>

1228
00:48:02,220 --> 00:48:08,609
seconds so effing if you know a first

1229
00:48:05,820 --> 00:48:10,200
stage of malware or a virus run and then

1230
00:48:08,610 --> 00:48:12,150
downloads additional files and runs them

1231
00:48:10,200 --> 00:48:15,960
you'll see those in Max's file with all

1232
00:48:12,150 --> 00:48:18,420
kinds of good stuff that's another good

1233
00:48:15,960 --> 00:48:21,990
artifact any questions about these

1234
00:48:18,420 --> 00:48:25,740
artifacts before I<font color="#E5E5E5"> start ranting AKA</font>

1235
00:48:21,990 --> 00:48:29,520
final thought so you know<font color="#CCCCCC"> all these</font>

1236
00:48:25,740 --> 00:48:31,020
artifacts were found basically all by

1237
00:48:29,520 --> 00:48:32,370
keyword searching for known bad file

1238
00:48:31,020 --> 00:48:34,740
names and moving around and doing the

1239
00:48:32,370 --> 00:48:36,270
research to back them up so there's so

1240
00:48:34,740 --> 00:48:38,520
many<font color="#E5E5E5"> more artifacts</font><font color="#CCCCCC"> for different</font>

1241
00:48:36,270 --> 00:48:39,840
antivirus vendors and software and all

1242
00:48:38,520 --> 00:48:41,730
kinds of stuff to keep in mind you'll

1243
00:48:39,840 --> 00:48:42,930
never know what you'll find and if you

1244
00:48:41,730 --> 00:48:44,130
find<font color="#CCCCCC"> something that</font><font color="#E5E5E5"> no one has down</font>

1245
00:48:42,930 --> 00:48:45,419
before you're going to have to<font color="#E5E5E5"> figure</font>

1246
00:48:44,130 --> 00:48:47,160
out what it means you<font color="#CCCCCC"> can't just say I</font>

1247
00:48:45,420 --> 00:48:48,810
found this<font color="#E5E5E5"> keyword I guess it means</font>

1248
00:48:47,160 --> 00:48:51,420
they're guilty like doesn't quite work

1249
00:48:48,810 --> 00:48:52,830
like that so always research your

1250
00:48:51,420 --> 00:48:54,510
keyword hits<font color="#CCCCCC"> when you're on them dig</font>

1251
00:48:52,830 --> 00:48:56,130
around ask around ask people on Twitter

1252
00:48:54,510 --> 00:48:58,440
find someone who may know<font color="#E5E5E5"> about these</font>

1253
00:48:56,130 --> 00:48:59,490
types of artifacts and ask them always

1254
00:48:58,440 --> 00:49:01,590
learn you know look<font color="#E5E5E5"> at other</font>

1255
00:48:59,490 --> 00:49:03,180
presentations here follow webinars

1256
00:49:01,590 --> 00:49:04,740
there's so many artifacts I can't

1257
00:49:03,180 --> 00:49:06,540
<font color="#E5E5E5">possibly keep them all straight myself</font>

1258
00:49:04,740 --> 00:49:10,589
let alone tell people about the ones i

1259
00:49:06,540 --> 00:49:11,790
think<font color="#CCCCCC"> i know the adaptable attackers of</font>

1260
00:49:10,590 --> 00:49:13,470
sneaky they're going to try and delete

1261
00:49:11,790 --> 00:49:16,380
the artifacts or going to you know try

1262
00:49:13,470 --> 00:49:18,930
and<font color="#E5E5E5"> support your detection mechanism and</font>

1263
00:49:16,380 --> 00:49:21,810
then a little<font color="#E5E5E5"> more thoughts as you</font><font color="#CCCCCC"> know</font>

1264
00:49:18,930 --> 00:49:24,029
this<font color="#E5E5E5"> is part art part science right a</font>

1265
00:49:21,810 --> 00:49:25,830
lot of this stuff I research myself and

1266
00:49:24,030 --> 00:49:28,860
if you're going<font color="#E5E5E5"> to trust my blog posts</font>

1267
00:49:25,830 --> 00:49:31,110
on TCM recently zaps good luck but you

1268
00:49:28,860 --> 00:49:33,930
<font color="#CCCCCC">know I take</font><font color="#E5E5E5"> it as much as you trust any</font>

1269
00:49:31,110 --> 00:49:34,619
other blog post unfortunately you know

1270
00:49:33,930 --> 00:49:36,419
there's a

1271
00:49:34,619 --> 00:49:38,009
is just someone testing the stuff<font color="#E5E5E5"> out</font>

1272
00:49:36,420 --> 00:49:40,259
and their spare time or<font color="#CCCCCC"> researcher is</font>

1273
00:49:38,009 --> 00:49:42,089
getting paid we're<font color="#E5E5E5"> lucky enough if we</font>

1274
00:49:40,259 --> 00:49:44,700
can get a white paper or a book that

1275
00:49:42,089 --> 00:49:46,170
really goes into<font color="#E5E5E5"> detail but I've tried</font>

1276
00:49:44,700 --> 00:49:47,848
<font color="#E5E5E5">to ask Microsoft how does this work</font>

1277
00:49:46,170 --> 00:49:49,470
they've never actually told me<font color="#E5E5E5"> like yes</font>

1278
00:49:47,849 --> 00:49:50,940
that's exactly how I am cash works I

1279
00:49:49,470 --> 00:49:52,439
just tweeted us in the other day no

1280
00:49:50,940 --> 00:49:54,089
one's ever been able<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> a straight</font>

1281
00:49:52,440 --> 00:49:55,799
answer out of Microsoft to say in court

1282
00:49:54,089 --> 00:49:57,359
yes microsoft confirmed this is how it

1283
00:49:55,799 --> 00:49:58,769
<font color="#E5E5E5">works it's all so many reverse</font>

1284
00:49:57,359 --> 00:50:02,160
engineered this and tried to figure<font color="#E5E5E5"> it</font>

1285
00:49:58,769 --> 00:50:04,558
<font color="#E5E5E5">out so things may change but keep in</font>

1286
00:50:02,160 --> 00:50:06,269
mind and be prepared for litigation I'm

1287
00:50:04,559 --> 00:50:08,160
big Santa is putting the word likely in

1288
00:50:06,269 --> 00:50:10,558
a report the attacker like we have this

1289
00:50:08,160 --> 00:50:12,180
gone on like it because you don't always

1290
00:50:10,559 --> 00:50:15,299
<font color="#CCCCCC">known you don't want</font><font color="#E5E5E5"> to be caught saying</font>

1291
00:50:12,180 --> 00:50:16,769
something happen for sure so you know we

1292
00:50:15,299 --> 00:50:18,240
look for all seven<font color="#CCCCCC"> inch loose kairos hi</font>

1293
00:50:16,769 --> 00:50:20,729
<font color="#CCCCCC">luke skywalker's hiding out somewhere</font>

1294
00:50:18,240 --> 00:50:22,680
near<font color="#CCCCCC"> ireland on that big island if you</font>

1295
00:50:20,730 --> 00:50:26,130
didn't see<font color="#CCCCCC"> that movie</font><font color="#E5E5E5"> yet that's too bad</font>

1296
00:50:22,680 --> 00:50:28,200
so yeah my name is Dave panty I work for

1297
00:50:26,130 --> 00:50:45,509
<font color="#CCCCCC">mandiant i drive a kia that's my twitter</font>

1298
00:50:28,200 --> 00:50:48,779
and does anybody have any questions yes

1299
00:50:45,509 --> 00:50:51,059
so the technical or the question was

1300
00:50:48,779 --> 00:50:53,849
about messing with timestamps and the

1301
00:50:51,059 --> 00:50:56,460
technical term is time stomp was not

1302
00:50:53,849 --> 00:50:58,559
super so like modifying timestamp tanda

1303
00:50:56,460 --> 00:50:59,819
absolutely it's very easy to well there

1304
00:50:58,559 --> 00:51:01,589
are tools that will go out<font color="#E5E5E5"> there and</font>

1305
00:50:59,819 --> 00:51:04,019
modify your time stamps in your MF<font color="#CCCCCC"> can</font>

1306
00:51:01,589 --> 00:51:05,279
<font color="#CCCCCC">trees both standard info and</font><font color="#E5E5E5"> filename it</font>

1307
00:51:04,019 --> 00:51:07,649
used to be that you couldn't modify your

1308
00:51:05,279 --> 00:51:08,999
file name time stamps but now people

1309
00:51:07,650 --> 00:51:10,619
just say I'm going<font color="#E5E5E5"> to get raw disk</font>

1310
00:51:08,999 --> 00:51:13,439
access and change them kind<font color="#E5E5E5"> of risky</font>

1311
00:51:10,619 --> 00:51:15,089
kind of not modifying<font color="#CCCCCC"> timestamps like in</font>

1312
00:51:13,440 --> 00:51:16,680
the<font color="#E5E5E5"> US end journal or other logs might</font>

1313
00:51:15,089 --> 00:51:18,299
might be tricky they might<font color="#E5E5E5"> not know</font>

1314
00:51:16,680 --> 00:51:20,759
about them so that's<font color="#E5E5E5"> why I enjoy it when</font>

1315
00:51:18,299 --> 00:51:23,220
I can get<font color="#E5E5E5"> those but yeah tackers do</font>

1316
00:51:20,759 --> 00:51:27,420
trying time some file<font color="#CCCCCC"> timestamps as part</font>

1317
00:51:23,220 --> 00:51:29,308
of anti forensics technique any other

1318
00:51:27,420 --> 00:51:30,569
questions I know it's<font color="#E5E5E5"> lunchtime I'll be</font>

1319
00:51:29,309 --> 00:51:33,869
here if<font color="#E5E5E5"> you guys want to chat all I'll</font>

1320
00:51:30,569 --> 00:51:35,849
be around tonight tomorrow so come<font color="#E5E5E5"> up</font>

1321
00:51:33,869 --> 00:51:37,769
and asking questions stop by the pot

1322
00:51:35,849 --> 00:51:39,630
probably unattended fire I booths

1323
00:51:37,769 --> 00:51:40,649
downstairs I<font color="#CCCCCC"> think Brandon's there i</font>

1324
00:51:39,630 --> 00:51:42,960
<font color="#E5E5E5">don't really know there's a bunch of</font>

1325
00:51:40,650 --> 00:51:44,460
free stuff please take<font color="#E5E5E5"> it</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> that</font>

1326
00:51:42,960 --> 00:51:46,680
means it's less<font color="#CCCCCC"> wait we have to pay to</font>

1327
00:51:44,460 --> 00:51:48,239
ship back so you know take take anything

1328
00:51:46,680 --> 00:51:50,270
on the table except the table

1329
00:51:48,239 --> 00:51:58,219
I so thank you guys very much

1330
00:51:50,270 --> 00:51:58,219
[Applause]

