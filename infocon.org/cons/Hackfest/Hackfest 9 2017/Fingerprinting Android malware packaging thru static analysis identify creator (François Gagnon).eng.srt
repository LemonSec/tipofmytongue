1
00:00:00,000 --> 00:00:04,200
all right um so this is all gonna be

2
00:00:04,200 --> 00:00:06,899
about the static analysis of Android

3
00:00:06,899 --> 00:00:07,620
malware

4
00:00:07,620 --> 00:00:10,290
what what kind of stuff can we get out

5
00:00:10,290 --> 00:00:14,000
of it and it's gonna be very simple

6
00:00:14,000 --> 00:00:18,119
analysis windows binary we can all sort

7
00:00:18,119 --> 00:00:22,609
of magically fuse with Andria that

8
00:00:22,609 --> 00:00:25,230
really should get a ton of information

9
00:00:25,230 --> 00:00:31,019
out of that project he secured that

10
00:00:31,019 --> 00:00:36,300
project with static analysis of Android

11
00:00:36,300 --> 00:00:37,860
application that's been done in the past

12
00:00:37,860 --> 00:00:41,160
but we felt like it was done with with

13
00:00:41,160 --> 00:00:43,469
old malware and needed to be updated and

14
00:00:43,469 --> 00:00:47,520
it was also not very deep deep as an

15
00:00:47,520 --> 00:00:49,559
analysis so we wanted to go like find

16
00:00:49,559 --> 00:00:55,050
some more interesting stuff we wanted as

17
00:00:55,050 --> 00:00:57,420
well to get an idea of differences

18
00:00:57,420 --> 00:00:59,489
between malware and legitimate

19
00:00:59,489 --> 00:01:02,309
applications we wanted to be able to

20
00:01:02,309 --> 00:01:04,080
find correlation between malware samples

21
00:01:04,080 --> 00:01:06,030
so just by static analysis can we say

22
00:01:06,030 --> 00:01:08,310
that these guys are sort of design and

23
00:01:08,310 --> 00:01:11,610
and we want we want it as well during

24
00:01:11,610 --> 00:01:13,140
the process we said well let's try to

25
00:01:13,140 --> 00:01:16,080
get out some information about how those

26
00:01:16,080 --> 00:01:18,840
malware are created so when they when

27
00:01:18,840 --> 00:01:19,979
they write the code or when they

28
00:01:19,979 --> 00:01:22,560
generate apk what kind of process to

29
00:01:22,560 --> 00:01:27,450
thee so so this is going to be really

30
00:01:27,450 --> 00:01:30,270
exciting right but but when I talk to

31
00:01:30,270 --> 00:01:32,579
one of my friend last week he said well

32
00:01:32,579 --> 00:01:35,240
this is gonna be how do you put it

33
00:01:35,240 --> 00:01:38,640
really boring this is kind of academic

34
00:01:38,640 --> 00:01:42,110
stuff and and this is gonna be boring so

35
00:01:42,110 --> 00:01:44,250
I'm gonna make a deal with you we'll

36
00:01:44,250 --> 00:01:46,409
just forget about what are the objective

37
00:01:46,409 --> 00:01:48,240
and we'll go with the presentation but

38
00:01:48,240 --> 00:01:51,990
first I need to ask all of those here

39
00:01:51,990 --> 00:01:54,659
that are actual malware writer for

40
00:01:54,659 --> 00:01:55,860
Android please leave the room

41
00:01:55,860 --> 00:01:57,930
okay this is not funny I don't want to

42
00:01:57,930 --> 00:02:00,390
guys you I want you guys here so anyone

43
00:02:00,390 --> 00:02:03,000
writing Android malware just doors over

44
00:02:03,000 --> 00:02:06,000
there just to sneak and the reason why

45
00:02:06,000 --> 00:02:07,920
I'm saying that is well we've done a

46
00:02:07,920 --> 00:02:10,080
nice element of andreal malware so we're

47
00:02:10,080 --> 00:02:12,270
going to last at you guys for the stupid

48
00:02:12,270 --> 00:02:13,800
mistake that you've been made

49
00:02:13,800 --> 00:02:15,270
and it's gonna be a bit awkward it's

50
00:02:15,270 --> 00:02:16,620
like you're sitting right there I'm not

51
00:02:16,620 --> 00:02:18,900
laughing at you so just like hey the

52
00:02:18,900 --> 00:02:23,600
room what I'm gonna also tell you how to

53
00:02:23,600 --> 00:02:26,400
what not to do when you you know you

54
00:02:26,400 --> 00:02:28,170
write your end will melt your Android

55
00:02:28,170 --> 00:02:30,060
malware so I don't want to give you guys

56
00:02:30,060 --> 00:02:32,220
trick so just leave through and of

57
00:02:32,220 --> 00:02:33,630
course outside like the police is

58
00:02:33,630 --> 00:02:37,380
waiting to pick you up in the end all

59
00:02:37,380 --> 00:02:39,240
right so this is the the plan of what

60
00:02:39,240 --> 00:02:40,860
will try to go to will see how time goes

61
00:02:40,860 --> 00:02:44,340
and and if we need to cut some things so

62
00:02:44,340 --> 00:02:47,310
I'm sound nobody

63
00:02:47,310 --> 00:02:50,910
so just for you guys who know me I used

64
00:02:50,910 --> 00:02:52,350
to be at the setup sign for as a

65
00:02:52,350 --> 00:02:55,110
researcher in cybersecurity now I'm a

66
00:02:55,110 --> 00:02:57,000
cyber security analyst with the

67
00:02:57,000 --> 00:03:00,990
Government of Canada and this work was a

68
00:03:00,990 --> 00:03:04,230
joint effort with my lab at C Jeb and C

69
00:03:04,230 --> 00:03:09,300
circuit Government of Canada and a

70
00:03:09,300 --> 00:03:12,209
couple of shameless plugs activists we

71
00:03:12,209 --> 00:03:14,850
are allowed to do that at sea search the

72
00:03:14,850 --> 00:03:16,830
cyber Incident Response Center of Canada

73
00:03:16,830 --> 00:03:19,200
we were actively looking for a student

74
00:03:19,200 --> 00:03:21,959
for internship this winter so data and I

75
00:03:21,959 --> 00:03:23,610
think guys the deep dives with those

76
00:03:23,610 --> 00:03:25,590
that are I've ends on and malware and

77
00:03:25,590 --> 00:03:27,840
trying to figure out what's going on so

78
00:03:27,840 --> 00:03:29,370
if you're interested guys just come and

79
00:03:29,370 --> 00:03:29,940
talk to me

80
00:03:29,940 --> 00:03:32,340
we just finished equipped for it was

81
00:03:32,340 --> 00:03:34,500
really nice and we're looking to a geek

82
00:03:34,500 --> 00:03:36,690
week file so it's a nine days event

83
00:03:36,690 --> 00:03:39,150
where we gather people we do a lot of

84
00:03:39,150 --> 00:03:41,040
cool project so if you're interested in

85
00:03:41,040 --> 00:03:43,260
participating or or giving us money for

86
00:03:43,260 --> 00:03:46,260
that come and see me as well and of

87
00:03:46,260 --> 00:03:48,450
course so there's like I've mentioned

88
00:03:48,450 --> 00:03:50,580
Government of Canada at some point so I

89
00:03:50,580 --> 00:03:52,530
need to put up with its Kramer the

90
00:03:52,530 --> 00:03:54,090
government is not responsible for

91
00:03:54,090 --> 00:03:56,340
whatever's in this presentation I'm here

92
00:03:56,340 --> 00:03:58,380
on my own so I'm going to say all sort

93
00:03:58,380 --> 00:04:01,049
of crap this is my crap they're not

94
00:04:01,049 --> 00:04:03,209
responsible for data resolved for stupid

95
00:04:03,209 --> 00:04:06,180
idea for bad joke or whatever okay so

96
00:04:06,180 --> 00:04:07,739
this is just me right now it's not the

97
00:04:07,739 --> 00:04:11,370
Government of Canada so all right what

98
00:04:11,370 --> 00:04:13,950
is static analysis of andrian malware or

99
00:04:13,950 --> 00:04:15,989
Android application at large so an

100
00:04:15,989 --> 00:04:18,089
Android application is an apk file it's

101
00:04:18,089 --> 00:04:20,070
an archive so this is the good starting

102
00:04:20,070 --> 00:04:21,978
point it's sort of a zip file you

103
00:04:21,978 --> 00:04:24,090
extract the zip file and there's a

104
00:04:24,090 --> 00:04:26,070
shitload of information just right there

105
00:04:26,070 --> 00:04:27,930
ready for us to pick up

106
00:04:27,930 --> 00:04:31,050
there's lots of files there's a Dex

107
00:04:31,050 --> 00:04:33,330
or maybe more than one sometimes the Dex

108
00:04:33,330 --> 00:04:35,310
file the dalvik is a cuticle so this is

109
00:04:35,310 --> 00:04:36,650
the core the code of the application

110
00:04:36,650 --> 00:04:38,639
we're not going to touch that because

111
00:04:38,639 --> 00:04:40,529
this is complicated I gave if you take

112
00:04:40,529 --> 00:04:42,360
I'm highly code and get Java code and

113
00:04:42,360 --> 00:04:45,449
then that that's complex so we'll go

114
00:04:45,449 --> 00:04:46,650
with more simpler stuff

115
00:04:46,650 --> 00:04:48,900
then there's the manifest so this is a

116
00:04:48,900 --> 00:04:51,449
file that describe to the system that's

117
00:04:51,449 --> 00:04:53,039
going to run run the application what

118
00:04:53,039 --> 00:04:54,569
the application looks like so what's the

119
00:04:54,569 --> 00:04:57,090
name what's the what kind of version

120
00:04:57,090 --> 00:04:59,430
it's running what kind of SDK needs the

121
00:04:59,430 --> 00:05:01,710
permission required and so on a lot of

122
00:05:01,710 --> 00:05:03,210
text information this is going to be

123
00:05:03,210 --> 00:05:04,650
interesting and then there's also

124
00:05:04,650 --> 00:05:06,090
something that is awesome

125
00:05:06,090 --> 00:05:09,120
it's a x.509 certificate so all the

126
00:05:09,120 --> 00:05:10,800
Android application are signed by the

127
00:05:10,800 --> 00:05:14,189
developer and the developer certificate

128
00:05:14,189 --> 00:05:15,900
is included in the apk so that the

129
00:05:15,900 --> 00:05:18,779
system can verify that all the files are

130
00:05:18,779 --> 00:05:22,169
signed and also when you update your

131
00:05:22,169 --> 00:05:23,969
application it makes sure that the

132
00:05:23,969 --> 00:05:25,740
update is signed with the same

133
00:05:25,740 --> 00:05:27,719
certificate and well there's a

134
00:05:27,719 --> 00:05:30,029
certificate inside the apk there's a lot

135
00:05:30,029 --> 00:05:31,830
of information inside a certificate and

136
00:05:31,830 --> 00:05:37,949
we'll see this in some some detail so

137
00:05:37,949 --> 00:05:39,569
we've done some experimentation we've

138
00:05:39,569 --> 00:05:41,750
analyzed a bunch of malware and

139
00:05:41,750 --> 00:05:43,620
legitimate application so we talked

140
00:05:43,620 --> 00:05:47,939
about 200,000 malware and we took about

141
00:05:47,939 --> 00:05:50,969
10,000 legitimate application we static

142
00:05:50,969 --> 00:05:53,339
we did static analysis on them and then

143
00:05:53,339 --> 00:05:56,250
we we looked at the result we compare

144
00:05:56,250 --> 00:06:00,919
them we cluster a bit and for so we got

145
00:06:00,919 --> 00:06:03,409
200,000 malware they they come from

146
00:06:03,409 --> 00:06:06,569
security vendors that are our partner at

147
00:06:06,569 --> 00:06:07,229
sea sir

148
00:06:07,229 --> 00:06:10,949
but they just give us malware and the

149
00:06:10,949 --> 00:06:12,479
alleged application come from Google

150
00:06:12,479 --> 00:06:14,159
they are of course it's really hard to

151
00:06:14,159 --> 00:06:17,099
say this is a malware and this is a

152
00:06:17,099 --> 00:06:19,409
legit application so what I'm saying is

153
00:06:19,409 --> 00:06:21,149
whenever it comes from Google please the

154
00:06:21,149 --> 00:06:23,279
chip this is not gonna always be true

155
00:06:23,279 --> 00:06:25,770
there will be malware at some point but

156
00:06:25,770 --> 00:06:27,659
hopefully not that much and whatever

157
00:06:27,659 --> 00:06:30,419
comes out from our security vendors will

158
00:06:30,419 --> 00:06:33,089
be malware at some point it will give us

159
00:06:33,089 --> 00:06:35,159
a legit application that they detect as

160
00:06:35,159 --> 00:06:37,669
malware and so on but this should not be

161
00:06:37,669 --> 00:06:40,740
too much so we've shown our sample at

162
00:06:40,740 --> 00:06:41,110
yours

163
00:06:41,110 --> 00:06:44,050
total and see what what sort of thing we

164
00:06:44,050 --> 00:06:45,670
had and we were pretty confident that

165
00:06:45,670 --> 00:06:47,710
the dataset is sort of good legit

166
00:06:47,710 --> 00:06:50,680
application are legit and malware most

167
00:06:50,680 --> 00:06:54,730
of them are our militia what what is

168
00:06:54,730 --> 00:06:56,440
interesting at least for me

169
00:06:56,440 --> 00:06:58,120
from an academic point of view here is

170
00:06:58,120 --> 00:07:00,160
that the data set is fairly recent so we

171
00:07:00,160 --> 00:07:02,830
stopped the analysis on January of this

172
00:07:02,830 --> 00:07:05,980
year and most of the sample we use the

173
00:07:05,980 --> 00:07:08,890
malware sample were for either 2015 and

174
00:07:08,890 --> 00:07:12,220
2016 so fairly recent right now I sort

175
00:07:12,220 --> 00:07:14,050
of understand that getting a bit

176
00:07:14,050 --> 00:07:15,970
outdated so we would need eventually to

177
00:07:15,970 --> 00:07:18,490
redo this kind of stuff and see if our

178
00:07:18,490 --> 00:07:22,210
statistics are still roughly defined so

179
00:07:22,210 --> 00:07:24,640
the information that we get inside the

180
00:07:24,640 --> 00:07:27,370
that we'll look at inside an apk is from

181
00:07:27,370 --> 00:07:29,350
the manifest we have lots of text-based

182
00:07:29,350 --> 00:07:30,520
fields so what are the list of

183
00:07:30,520 --> 00:07:32,020
permission that the application requires

184
00:07:32,020 --> 00:07:34,240
what is the minimum version of the

185
00:07:34,240 --> 00:07:36,610
system it needs the Android SDK version

186
00:07:36,610 --> 00:07:38,980
that it needs to run there's the target

187
00:07:38,980 --> 00:07:41,530
SDK version as well and the max version

188
00:07:41,530 --> 00:07:44,350
which is useless the application version

189
00:07:44,350 --> 00:07:46,540
code so it's the numeric version of the

190
00:07:46,540 --> 00:07:49,030
application I mean interesting there's

191
00:07:49,030 --> 00:07:50,560
the application version 9 so you get a

192
00:07:50,560 --> 00:07:51,970
string that you can put whatever you

193
00:07:51,970 --> 00:07:54,640
want in this that represent the sort of

194
00:07:54,640 --> 00:07:56,290
the human readable version of your

195
00:07:56,290 --> 00:07:58,450
application there's of course the name

196
00:07:58,450 --> 00:07:59,650
of the application there's an

197
00:07:59,650 --> 00:08:01,330
application label there's the Apetit the

198
00:08:01,330 --> 00:08:03,760
package name of the application so a lot

199
00:08:03,760 --> 00:08:07,240
of text bodies feel that a malware

200
00:08:07,240 --> 00:08:09,520
creator needs to put something here and

201
00:08:09,520 --> 00:08:11,680
it's not give me always something smart

202
00:08:11,680 --> 00:08:15,640
and especially when he's trying to

203
00:08:15,640 --> 00:08:17,860
generate those malware wrath and not

204
00:08:17,860 --> 00:08:19,870
randomly but automatically so he wants

205
00:08:19,870 --> 00:08:22,270
like he has one malicious payload didn't

206
00:08:22,270 --> 00:08:25,510
wanna put in 12 alcohol kind of in

207
00:08:25,510 --> 00:08:27,600
several application and distribute them

208
00:08:27,600 --> 00:08:29,710
well he's gonna need to come up with

209
00:08:29,710 --> 00:08:32,549
values for those field for each of those

210
00:08:32,549 --> 00:08:36,789
instances or of mouth and in there in a

211
00:08:36,789 --> 00:08:39,659
certificate we've got

212
00:08:39,760 --> 00:08:41,650
well the number of searches yet that are

213
00:08:41,650 --> 00:08:43,150
there I'm not going to talk about this

214
00:08:43,150 --> 00:08:44,980
dates that will be interesting we get a

215
00:08:44,980 --> 00:08:46,330
file name so this certificate is in a

216
00:08:46,330 --> 00:08:48,610
file name this looks like to build it's

217
00:08:48,610 --> 00:08:52,030
actually quite quite interesting like

218
00:08:52,030 --> 00:08:53,950
all the almost all the legit application

219
00:08:53,950 --> 00:08:55,810
are in the same that the file name for

220
00:08:55,810 --> 00:08:57,580
the certificate is always the sign but

221
00:08:57,580 --> 00:08:59,260
for malware there are all sorts of

222
00:08:59,260 --> 00:09:03,190
different one this each certificate has

223
00:09:03,190 --> 00:09:06,940
a serial number it's not really useful

224
00:09:06,940 --> 00:09:08,830
talk a bit about it later but it's not

225
00:09:08,830 --> 00:09:11,980
being useful each certificate as a

226
00:09:11,980 --> 00:09:13,570
signature so this is interesting because

227
00:09:13,570 --> 00:09:17,080
it uniquely identify the different

228
00:09:17,080 --> 00:09:18,610
certificates but it's going to be

229
00:09:18,610 --> 00:09:19,390
helpful

230
00:09:19,390 --> 00:09:20,950
there's of course a public key in there

231
00:09:20,950 --> 00:09:23,860
there's a vanity per year now at this

232
00:09:23,860 --> 00:09:25,600
point we're going to get into sort of

233
00:09:25,600 --> 00:09:30,130
weird stuff and that can happen or weird

234
00:09:30,130 --> 00:09:32,200
behavior that we're observing there's a

235
00:09:32,200 --> 00:09:33,850
subject name so whenever you create a

236
00:09:33,850 --> 00:09:35,230
certificate you need to put a subject

237
00:09:35,230 --> 00:09:38,890
name when it's htv-4 or HTTPS or or a

238
00:09:38,890 --> 00:09:42,400
website the subject name will be the URL

239
00:09:42,400 --> 00:09:44,380
the domain name or something like that

240
00:09:44,380 --> 00:09:46,180
but for Android application it doesn't

241
00:09:46,180 --> 00:09:48,490
matter there's no verification done on

242
00:09:48,490 --> 00:09:49,960
the nine so you can put whatever you

243
00:09:49,960 --> 00:09:53,020
want and it done a work but you need to

244
00:09:53,020 --> 00:09:56,320
come up with something and there's also

245
00:09:56,320 --> 00:09:58,000
be sure we're not going to look at it

246
00:09:58,000 --> 00:10:00,400
and for other thing that we've lost that

247
00:10:00,400 --> 00:10:02,080
we've looked at is the file list

248
00:10:02,080 --> 00:10:04,510
so how many file which files are

249
00:10:04,510 --> 00:10:06,430
included in the apk and the creation

250
00:10:06,430 --> 00:10:09,870
date so I've mentioned that we sort of

251
00:10:09,870 --> 00:10:12,100
believe that most of our applications

252
00:10:12,100 --> 00:10:15,250
are of our malware are from 2015 and

253
00:10:15,250 --> 00:10:18,280
2016 and the way we do that is when we

254
00:10:18,280 --> 00:10:21,310
you extract the apk the files within the

255
00:10:21,310 --> 00:10:24,820
archive retain their their properties so

256
00:10:24,820 --> 00:10:26,410
that we can pick the last modification

257
00:10:26,410 --> 00:10:29,290
date of a file we use the manifest for

258
00:10:29,290 --> 00:10:31,840
right now and this gives us an idea of

259
00:10:31,840 --> 00:10:33,970
when the application was packet because

260
00:10:33,970 --> 00:10:35,650
usually whenever you package the

261
00:10:35,650 --> 00:10:38,080
application Yury encode your manifest in

262
00:10:38,080 --> 00:10:42,460
fact a jury people that's good enough

263
00:10:42,460 --> 00:10:45,400
for us alright so let's go with the

264
00:10:45,400 --> 00:10:48,250
manifest start with the application

265
00:10:48,250 --> 00:10:50,560
package so every application needs a

266
00:10:50,560 --> 00:10:52,320
package name and

267
00:10:52,320 --> 00:10:54,780
room for that and when I mean what I

268
00:10:54,780 --> 00:10:58,160
mean what I mean by when I say rude is

269
00:10:58,160 --> 00:11:02,430
how Google Play and the dog value is

270
00:11:02,430 --> 00:11:04,890
that qu application on the Google Play

271
00:11:04,890 --> 00:11:06,840
can not have the same package name if

272
00:11:06,840 --> 00:11:08,310
you have to say to a petition have the

273
00:11:08,310 --> 00:11:10,200
same package name Google Play says were

274
00:11:10,200 --> 00:11:14,340
they're the same and when we look at the

275
00:11:14,340 --> 00:11:18,810
statistic we get almost one package name

276
00:11:18,810 --> 00:11:21,450
for legitimate application so one

277
00:11:21,450 --> 00:11:23,070
different package name for every

278
00:11:23,070 --> 00:11:26,280
legitimate application so we can assume

279
00:11:26,280 --> 00:11:27,900
that we have multiple version of the

280
00:11:27,900 --> 00:11:31,980
same app a few time like 10 times but we

281
00:11:31,980 --> 00:11:36,570
get only one package name for two

282
00:11:36,570 --> 00:11:39,000
malware so the the malware are you

283
00:11:39,000 --> 00:11:42,540
reusing package name a lot and obviously

284
00:11:42,540 --> 00:11:44,760
I'm gonna come back with this during a

285
00:11:44,760 --> 00:11:45,960
presentation they don't care about

286
00:11:45,960 --> 00:11:48,330
Google Play rules because eventually

287
00:11:48,330 --> 00:11:50,040
they're not going to push their malware

288
00:11:50,040 --> 00:11:52,590
on Google Play some will but most will

289
00:11:52,590 --> 00:11:54,150
be distributed through other market so

290
00:11:54,150 --> 00:11:57,000
they don't care what rules are on Google

291
00:11:57,000 --> 00:11:59,280
Play you just care will my malware get

292
00:11:59,280 --> 00:12:02,580
install on the device so a lot of reuse

293
00:12:02,580 --> 00:12:05,040
in the package 9 actually normal where

294
00:12:05,040 --> 00:12:09,120
data set we get one package name that is

295
00:12:09,120 --> 00:12:13,230
that that is that that come back 34,000

296
00:12:13,230 --> 00:12:16,590
pounds that's a lot of reuse for the

297
00:12:16,590 --> 00:12:18,870
same package name we also want I have

298
00:12:18,870 --> 00:12:24,000
one prefix that comes 7,000 time in our

299
00:12:24,000 --> 00:12:26,130
malware so if they're all different but

300
00:12:26,130 --> 00:12:27,660
they always have the same perfect and

301
00:12:27,660 --> 00:12:29,640
this is sort of interesting when you dig

302
00:12:29,640 --> 00:12:33,480
into that that sort of data so so we get

303
00:12:33,480 --> 00:12:35,880
the we can get this beautiful chart the

304
00:12:35,880 --> 00:12:38,550
big blue bubble is all the application

305
00:12:38,550 --> 00:12:41,670
that have the package name of a calm

306
00:12:41,670 --> 00:12:43,260
young run blah blah blah which happened

307
00:12:43,260 --> 00:12:45,840
30 2005 and then we've got all sorts of

308
00:12:45,840 --> 00:12:48,060
other smaller cluster that we could look

309
00:12:48,060 --> 00:12:50,610
at and some that can be eventually

310
00:12:50,610 --> 00:12:52,620
merged because they're really close to

311
00:12:52,620 --> 00:12:55,440
one another as syntactically but we can

312
00:12:55,440 --> 00:12:57,390
also what we need to get out of that as

313
00:12:57,390 --> 00:12:59,040
well is this is going to eventually skew

314
00:12:59,040 --> 00:13:02,640
our data like there's 33,000 samples

315
00:13:02,640 --> 00:13:06,240
that we could think of right now

316
00:13:06,240 --> 00:13:08,640
design so there are variation of design

317
00:13:08,640 --> 00:13:11,820
so this is eventually gonna pure data so

318
00:13:11,820 --> 00:13:13,920
whenever we look at stats we need to

319
00:13:13,920 --> 00:13:15,690
keep in mind that we've got lots of

320
00:13:15,690 --> 00:13:17,160
repetition in our data set but that's

321
00:13:17,160 --> 00:13:19,730
what we wanted wanted to have a

322
00:13:19,730 --> 00:13:21,779
representative overview of what's going

323
00:13:21,779 --> 00:13:25,440
on in the in real life and so just

324
00:13:25,440 --> 00:13:27,300
before I go any further when I say a

325
00:13:27,300 --> 00:13:31,890
sample what I mean is is an apk that has

326
00:13:31,890 --> 00:13:34,800
its own md5 hash so whenever you put an

327
00:13:34,800 --> 00:13:36,480
you take an NK you ash

328
00:13:36,480 --> 00:13:38,490
the file it gives you an md5 if they're

329
00:13:38,490 --> 00:13:40,230
different and I for me they're different

330
00:13:40,230 --> 00:13:42,600
sample it could be pretty much the same

331
00:13:42,600 --> 00:13:45,720
application with a different icon but

332
00:13:45,720 --> 00:13:47,550
they will ash two different md5 so

333
00:13:47,550 --> 00:13:50,310
they're different samples for me so we

334
00:13:50,310 --> 00:13:51,570
don't know right off the bat that they

335
00:13:51,570 --> 00:13:53,730
are different or did their same so we

336
00:13:53,730 --> 00:13:55,580
need to analyze them separate

337
00:13:55,580 --> 00:13:57,779
then there's the application version

338
00:13:57,779 --> 00:14:00,180
code so here we see a bunch of

339
00:14:00,180 --> 00:14:03,020
interesting things so first of all

340
00:14:03,020 --> 00:14:05,490
application version equal equal one

341
00:14:05,490 --> 00:14:07,649
we've got nearly half of our malware

342
00:14:07,649 --> 00:14:10,040
that use application version equal 1 and

343
00:14:10,040 --> 00:14:13,529
only 14% of legitimate application and

344
00:14:13,529 --> 00:14:17,610
the reason is on the Play Store whenever

345
00:14:17,610 --> 00:14:19,860
you push a new version of your app you

346
00:14:19,860 --> 00:14:22,380
need to increase the version code ok you

347
00:14:22,380 --> 00:14:24,329
absolutely add otherwise you won't get

348
00:14:24,329 --> 00:14:26,070
there since malware don't care about

349
00:14:26,070 --> 00:14:29,459
updates that much then they put version

350
00:14:29,459 --> 00:14:32,100
1 and it never get changed all right so

351
00:14:32,100 --> 00:14:34,190
this is one interesting thing so app

352
00:14:34,190 --> 00:14:38,520
version code equal one is weird then

353
00:14:38,520 --> 00:14:42,360
there's those values 2 billion 100

354
00:14:42,360 --> 00:14:47,220
million and 2 billion 100 million 147

355
00:14:47,220 --> 00:14:48,870
million and so on that apply the one at

356
00:14:48,870 --> 00:14:52,470
the top which are cure like both of them

357
00:14:52,470 --> 00:14:56,220
it's a tree 3 4 percent in malware and

358
00:14:56,220 --> 00:14:59,850
almost none like we got 1 instances in 6

359
00:14:59,850 --> 00:15:02,850
instances in alleged sample so this very

360
00:15:02,850 --> 00:15:07,649
high number here used again ok right now

361
00:15:07,649 --> 00:15:10,230
the maximum version code you can push to

362
00:15:10,230 --> 00:15:13,050
Google Play is 2 billion 100 million all

363
00:15:13,050 --> 00:15:15,570
right if you true try to billion 200

364
00:15:15,570 --> 00:15:18,329
million it won't make it so uh

365
00:15:18,329 --> 00:15:20,070
legitimate application

366
00:15:20,070 --> 00:15:22,889
have those I vowed but in the past the

367
00:15:22,889 --> 00:15:27,990
maximum was 202 billion 147 million bla

368
00:15:27,990 --> 00:15:29,970
bla bla so the value at the top and a

369
00:15:29,970 --> 00:15:32,759
few legit app made it to the Google Play

370
00:15:32,759 --> 00:15:34,589
Store before they changed that value and

371
00:15:34,589 --> 00:15:36,930
for some reason you know a fair amount

372
00:15:36,930 --> 00:15:40,170
of malware use that specific value for

373
00:15:40,170 --> 00:15:42,990
their version collide I don't know why

374
00:15:42,990 --> 00:15:47,850
they do that but really you there should

375
00:15:47,850 --> 00:15:50,339
be a value somewhere like four would be

376
00:15:50,339 --> 00:15:51,750
a good app version code for a malware

377
00:15:51,750 --> 00:15:55,220
it's what I'm saying all right

378
00:15:55,220 --> 00:15:58,470
then there's the minimum and target is

379
00:15:58,470 --> 00:16:01,110
the key versions of which on which

380
00:16:01,110 --> 00:16:03,690
system will the application run all

381
00:16:03,690 --> 00:16:06,569
right what it says so we got nice grass

382
00:16:06,569 --> 00:16:09,329
with my colors and and malware are

383
00:16:09,329 --> 00:16:11,790
different and then legit application but

384
00:16:11,790 --> 00:16:13,500
let's forget about that and let's look

385
00:16:13,500 --> 00:16:14,430
at this guy

386
00:16:14,430 --> 00:16:19,230
so target version for malware target is

387
00:16:19,230 --> 00:16:21,329
giver shown higher than 25 so remember

388
00:16:21,329 --> 00:16:23,610
that this was done in January of this

389
00:16:23,610 --> 00:16:27,839
year and at that time the is SDK version

390
00:16:27,839 --> 00:16:30,120
for Android was 25 so we got a few

391
00:16:30,120 --> 00:16:32,449
values for malware that are higher than

392
00:16:32,449 --> 00:16:38,279
the current greatest SDK version so

393
00:16:38,279 --> 00:16:42,230
actually what we see is 26 27 30 42 so

394
00:16:42,230 --> 00:16:47,940
and 9999 so some guy is doing a malware

395
00:16:47,940 --> 00:16:51,060
that will run very nicely in future and

396
00:16:51,060 --> 00:16:53,040
red version so whenever your Android

397
00:16:53,040 --> 00:16:54,959
phone can teleport to you this malware

398
00:16:54,959 --> 00:16:57,959
will work as a time so this is this is

399
00:16:57,959 --> 00:17:01,949
cool and this is easy to spot like it's

400
00:17:01,949 --> 00:17:05,669
sort of a mistake that you can spot easy

401
00:17:05,669 --> 00:17:08,640
in mouth then there's the there are the

402
00:17:08,640 --> 00:17:10,230
list of permission what permission are

403
00:17:10,230 --> 00:17:11,669
required by the application or the

404
00:17:11,669 --> 00:17:15,390
malware and this we see that all the

405
00:17:15,390 --> 00:17:18,119
time at least I do the the comparison

406
00:17:18,119 --> 00:17:19,589
between the permission the popular

407
00:17:19,589 --> 00:17:21,599
permission for alleged and malware and

408
00:17:21,599 --> 00:17:24,359
so so they're different a bunch of

409
00:17:24,359 --> 00:17:26,159
permission indicate malware more than

410
00:17:26,159 --> 00:17:28,049
net chip but what we found very

411
00:17:28,049 --> 00:17:30,960
interesting on on permission is a lot

412
00:17:30,960 --> 00:17:33,380
lot lot of malware more than half the

413
00:17:33,380 --> 00:17:36,000
have in their manifest duplicate

414
00:17:36,000 --> 00:17:38,070
permission so they require they request

415
00:17:38,070 --> 00:17:41,279
twice the permission let's say give me

416
00:17:41,279 --> 00:17:43,049
access to Internet and this is really

417
00:17:43,049 --> 00:17:45,690
interesting it happens a little bit with

418
00:17:45,690 --> 00:17:49,110
legit app but much much less and what we

419
00:17:49,110 --> 00:17:52,140
believe happens here is so so you got a

420
00:17:52,140 --> 00:17:54,360
malware now you get a legit app you get

421
00:17:54,360 --> 00:17:55,740
a manage this payload then you want to

422
00:17:55,740 --> 00:17:57,299
package your managers payload into that

423
00:17:57,299 --> 00:17:59,309
app so that everything will run so you

424
00:17:59,309 --> 00:18:02,220
take the app manifest and you add the

425
00:18:02,220 --> 00:18:03,779
permission that you need for you map

426
00:18:03,779 --> 00:18:05,789
from your fail your malicious payload

427
00:18:05,789 --> 00:18:07,950
you add that to the manifest but you

428
00:18:07,950 --> 00:18:09,690
don't do like all sort of complicated

429
00:18:09,690 --> 00:18:12,029
stuff like is this already there like

430
00:18:12,029 --> 00:18:13,679
I'm gonna do a set and it's gonna remove

431
00:18:13,679 --> 00:18:15,690
the duplicate you just put it there and

432
00:18:15,690 --> 00:18:17,850
if there are duplicate the system don't

433
00:18:17,850 --> 00:18:21,049
care it works anyway so we believe that

434
00:18:21,049 --> 00:18:24,000
this is an artifact of we automated

435
00:18:24,000 --> 00:18:27,390
repackaging of malicious payload into

436
00:18:27,390 --> 00:18:29,730
normal Android application and there's a

437
00:18:29,730 --> 00:18:32,000
lot of duplication it's not like

438
00:18:32,000 --> 00:18:34,470
Internet is always duplicated like some

439
00:18:34,470 --> 00:18:38,659
malware have like this dozens of

440
00:18:38,659 --> 00:18:41,000
duplicate permission and their manifest

441
00:18:41,000 --> 00:18:43,350
so it's really interesting order legit

442
00:18:43,350 --> 00:18:45,149
we believe it's more something like to

443
00:18:45,149 --> 00:18:48,230
developer manually had the permission

444
00:18:48,230 --> 00:18:50,309
separately and then when they commit it

445
00:18:50,309 --> 00:18:51,990
doesn't get merged probably but this is

446
00:18:51,990 --> 00:18:54,270
just like a while guessing we don't

447
00:18:54,270 --> 00:18:57,870
really care that much what they do so

448
00:18:57,870 --> 00:18:59,309
let's move on to this certificate part

449
00:18:59,309 --> 00:19:00,649
alright

450
00:19:00,649 --> 00:19:02,850
so serial number there are two

451
00:19:02,850 --> 00:19:04,649
certificate that are very special in

452
00:19:04,649 --> 00:19:07,260
Android the debug one and the platform

453
00:19:07,260 --> 00:19:10,320
test one of course you can never push an

454
00:19:10,320 --> 00:19:12,029
application that is signed by with those

455
00:19:12,029 --> 00:19:14,279
certificate but malware don't care so

456
00:19:14,279 --> 00:19:16,940
they do you use those sir yep a bit

457
00:19:16,940 --> 00:19:19,679
which is weird like it's sort of easy to

458
00:19:19,679 --> 00:19:25,200
spot we found also some works so serial

459
00:19:25,200 --> 00:19:26,640
number when you generate a certain cap

460
00:19:26,640 --> 00:19:28,799
you need to pick a serial number it's

461
00:19:28,799 --> 00:19:30,630
picked automatically for you and it the

462
00:19:30,630 --> 00:19:32,370
goal is that you this value will be

463
00:19:32,370 --> 00:19:34,770
unique across all the certificates I'm

464
00:19:34,770 --> 00:19:36,690
sort of magically of course it doesn't

465
00:19:36,690 --> 00:19:39,390
work so we've picked a bunch of serial

466
00:19:39,390 --> 00:19:42,870
numbers for which we we see in more than

467
00:19:42,870 --> 00:19:44,850
one different certificate so two

468
00:19:44,850 --> 00:19:46,559
different certificate share the same

469
00:19:46,559 --> 00:19:47,309
serial

470
00:19:47,309 --> 00:19:49,559
so the conclusion is serial number

471
00:19:49,559 --> 00:19:53,249
doesn't really uniquely identify sort

472
00:19:53,249 --> 00:19:54,570
yet so we need something else we're

473
00:19:54,570 --> 00:20:00,499
using signature so regarding signature

474
00:20:00,499 --> 00:20:02,820
so this signature of the certificate

475
00:20:02,820 --> 00:20:07,379
itself so for legitimate application the

476
00:20:07,379 --> 00:20:09,809
number of distinct signature that we see

477
00:20:09,809 --> 00:20:12,659
is fairly high so it's a it's a 85 out

478
00:20:12,659 --> 00:20:16,529
of 100 for different certificate versus

479
00:20:16,529 --> 00:20:19,619
number of occasion we are for malware

480
00:20:19,619 --> 00:20:23,159
it's much lower we're at this 40.6 rate

481
00:20:23,159 --> 00:20:25,919
or sixty percent rate or whatever so the

482
00:20:25,919 --> 00:20:28,320
reuse certificate much more than legit

483
00:20:28,320 --> 00:20:30,419
application so legit definition you

484
00:20:30,419 --> 00:20:35,009
reuse a search yet because you want to

485
00:20:35,009 --> 00:20:36,539
of your a so if I'm a developer I'm

486
00:20:36,539 --> 00:20:38,159
going to sing assign all my apps with

487
00:20:38,159 --> 00:20:39,480
the same certificate so that they can

488
00:20:39,480 --> 00:20:41,820
interact together better inside the

489
00:20:41,820 --> 00:20:43,590
system so under it there's a sort of a

490
00:20:43,590 --> 00:20:45,389
special channel communication channel

491
00:20:45,389 --> 00:20:47,070
between apps that are signed within the

492
00:20:47,070 --> 00:20:49,769
same certificate so it makes sense for a

493
00:20:49,769 --> 00:20:51,450
developer to sing all all their apps

494
00:20:51,450 --> 00:20:53,399
with the same certificate so that's why

495
00:20:53,399 --> 00:20:56,850
we got some amount of duplication for

496
00:20:56,850 --> 00:20:58,769
malware it doesn't really make sense

497
00:20:58,769 --> 00:21:01,249
unless you want them to interact which

498
00:21:01,249 --> 00:21:03,960
in some cases would make sense but

499
00:21:03,960 --> 00:21:05,610
there's way too much duplication for

500
00:21:05,610 --> 00:21:08,460
that we found like one certificate that

501
00:21:08,460 --> 00:21:12,330
is used to sign more than 10,000 sample

502
00:21:12,330 --> 00:21:14,159
in our mouth data set so when you see

503
00:21:14,159 --> 00:21:16,470
that you get one certificate signing

504
00:21:16,470 --> 00:21:19,519
multiple sample then you're fairly sure

505
00:21:19,519 --> 00:21:22,320
that all those samples come from the

506
00:21:22,320 --> 00:21:25,470
same place all right so it's not working

507
00:21:25,470 --> 00:21:26,009
anymore

508
00:21:26,009 --> 00:21:29,220
all right so same sort of kit means you

509
00:21:29,220 --> 00:21:33,330
know implies ish same origin but there's

510
00:21:33,330 --> 00:21:35,159
some cases where that might not be true

511
00:21:35,159 --> 00:21:38,210
but this is for mathematician trigger

512
00:21:38,210 --> 00:21:40,679
but if you have different certificate it

513
00:21:40,679 --> 00:21:41,970
doesn't mean that it comes from the

514
00:21:41,970 --> 00:21:43,649
different from different places and this

515
00:21:43,649 --> 00:21:46,889
is going to take us a bit deeper so the

516
00:21:46,889 --> 00:21:49,529
next step is alright we found 13 malware

517
00:21:49,529 --> 00:21:51,269
sample that I've this time certificate

518
00:21:51,269 --> 00:21:53,429
but all those certificate use the sign

519
00:21:53,429 --> 00:21:56,190
public key and obviously the same

520
00:21:56,190 --> 00:22:00,720
private key so they're most likely

521
00:22:00,720 --> 00:22:01,799
coming from the say

522
00:22:01,799 --> 00:22:04,769
so the guy he for each sample it

523
00:22:04,769 --> 00:22:07,019
generated a new certificate but he went

524
00:22:07,019 --> 00:22:09,600
to the trouble of reusing his old tea to

525
00:22:09,600 --> 00:22:12,269
generate each new certificate so - so he

526
00:22:12,269 --> 00:22:14,129
would make sure that it was easy for me

527
00:22:14,129 --> 00:22:15,989
to spot him

528
00:22:15,989 --> 00:22:20,879
so thanks man I was bad now there's the

529
00:22:20,879 --> 00:22:22,710
subject field in the certificate so who

530
00:22:22,710 --> 00:22:25,799
the certificate belongs fella for

531
00:22:25,799 --> 00:22:29,009
legitimate application we get almost a

532
00:22:29,009 --> 00:22:30,629
one on one correspondence between the

533
00:22:30,629 --> 00:22:32,610
number of different search yet we see

534
00:22:32,610 --> 00:22:34,139
the different signature and a number of

535
00:22:34,139 --> 00:22:36,210
different subject line we see the

536
00:22:36,210 --> 00:22:37,859
roughly one on one not quite there but

537
00:22:37,859 --> 00:22:42,059
for malware it's one to two so subject

538
00:22:42,059 --> 00:22:44,309
name yet we use twice as much as

539
00:22:44,309 --> 00:22:47,009
certificate themselves all right so this

540
00:22:47,009 --> 00:22:48,359
is interesting you know we can see a

541
00:22:48,359 --> 00:22:52,619
bunch of example here a very generic one

542
00:22:52,619 --> 00:22:55,609
yes yes yes yes yes

543
00:22:55,609 --> 00:22:57,779
35,000 times so this is probably your

544
00:22:57,779 --> 00:22:59,759
big cluster that we've seen earlier so

545
00:22:59,759 --> 00:23:01,440
they use the same package name and they

546
00:23:01,440 --> 00:23:04,309
use the same subject name

547
00:23:04,309 --> 00:23:06,869
we've got unknown unknown unknown but

548
00:23:06,869 --> 00:23:11,129
I'm from China 20,000 time oh no no no

549
00:23:11,129 --> 00:23:13,070
no none known 2000 time

550
00:23:13,070 --> 00:23:15,539
item three item three I thought I don't

551
00:23:15,539 --> 00:23:16,409
know what this is

552
00:23:16,409 --> 00:23:18,509
maybe it means something maybe it means

553
00:23:18,509 --> 00:23:21,480
unknown in a unknown language but this

554
00:23:21,480 --> 00:23:23,999
is fairly common like four thousand

555
00:23:23,999 --> 00:23:27,929
times and then there's the ll p fi h i

556
00:23:27,929 --> 00:23:31,169
gyd EI k ba bla bla that comes back

557
00:23:31,169 --> 00:23:33,600
3,000 so this is very specific this is

558
00:23:33,600 --> 00:23:36,059
probably a random generating string but

559
00:23:36,059 --> 00:23:39,239
it's the same on all the certificate all

560
00:23:39,239 --> 00:23:43,710
right so very interest sort of easy to

561
00:23:43,710 --> 00:23:45,929
spot it and say well I'm gonna look at

562
00:23:45,929 --> 00:23:47,609
those 2000 malware they probably come

563
00:23:47,609 --> 00:23:51,419
from the same guy or at least from the

564
00:23:51,419 --> 00:23:58,350
same place so you get fine 9 so let's

565
00:23:58,350 --> 00:24:02,570
not bother with the top let's go here so

566
00:24:02,570 --> 00:24:06,169
83 84 percent of legitimate application

567
00:24:06,169 --> 00:24:09,419
the certificate file name is called cert

568
00:24:09,419 --> 00:24:13,049
dot r SE alright so if you do a malware

569
00:24:13,049 --> 00:24:15,389
just call it that and nobody I'm not

570
00:24:15,389 --> 00:24:15,690
going to

571
00:24:15,690 --> 00:24:19,559
year for malware it's 42% so much much

572
00:24:19,559 --> 00:24:23,279
less some of those figured it out but

573
00:24:23,279 --> 00:24:28,769
lab didn't there's a 17% Zed Zed W dot

574
00:24:28,769 --> 00:24:32,220
RS like it stands out that that W stands

575
00:24:32,220 --> 00:24:34,610
out this is again the big cluster of

576
00:24:34,610 --> 00:24:37,350
3000 app that we've seen at the

577
00:24:37,350 --> 00:24:41,700
beginning so finally I mean it stupid

578
00:24:41,700 --> 00:24:43,350
but it's really interesting and there's

579
00:24:43,350 --> 00:24:45,269
an and another thing that is cool with

580
00:24:45,269 --> 00:24:47,759
that is we have a bit more than 2000

581
00:24:47,759 --> 00:24:50,820
malware sample that use a pattern of

582
00:24:50,820 --> 00:24:53,580
eight digits that are s Li for the fine

583
00:24:53,580 --> 00:24:56,669
line and eight digit for RSA the eight

584
00:24:56,669 --> 00:24:58,980
digit that are Thor that whatever is to

585
00:24:58,980 --> 00:25:02,039
me year year year month month and date

586
00:25:02,039 --> 00:25:07,289
right so it's a date well not calendar

587
00:25:07,289 --> 00:25:11,610
date so what we've done is we've crashed

588
00:25:11,610 --> 00:25:14,429
we compared those file names with the

589
00:25:14,429 --> 00:25:18,830
creation date of the apk and sure enough

590
00:25:18,830 --> 00:25:21,960
1600 of them the certificate file name

591
00:25:21,960 --> 00:25:24,360
match with the creation date of the apk

592
00:25:24,360 --> 00:25:27,269
so this is nice now we get a better a

593
00:25:27,269 --> 00:25:30,149
better understanding of how the process

594
00:25:30,149 --> 00:25:31,590
works so they generate the certificate

595
00:25:31,590 --> 00:25:34,590
automatically for every time the the you

596
00:25:34,590 --> 00:25:37,799
want to package a new sample they choose

597
00:25:37,799 --> 00:25:39,570
the name for the circuit file which is

598
00:25:39,570 --> 00:25:41,330
the current date and they package their

599
00:25:41,330 --> 00:25:43,860
application we're trying to see a good

600
00:25:43,860 --> 00:25:45,990
insight into how they're processed work

601
00:25:45,990 --> 00:25:47,190
all right

602
00:25:47,190 --> 00:25:48,629
we're going to come back with some of

603
00:25:48,629 --> 00:25:54,960
these things later another thing that is

604
00:25:54,960 --> 00:25:57,450
cool it's certificate is that you have a

605
00:25:57,450 --> 00:25:59,340
valid editorial so I start time and an

606
00:25:59,340 --> 00:26:00,210
end time all right

607
00:26:00,210 --> 00:26:03,600
so usually for HTTP this means if you go

608
00:26:03,600 --> 00:26:05,039
to suicide and you get a certificate you

609
00:26:05,039 --> 00:26:06,269
want to make sure that your certificate

610
00:26:06,269 --> 00:26:09,179
is not expired and I started to be

611
00:26:09,179 --> 00:26:11,100
valued all right otherwise you get an

612
00:26:11,100 --> 00:26:12,870
error chrome says well you shouldn't go

613
00:26:12,870 --> 00:26:16,340
there and Internet Explorer's is nothing

614
00:26:16,340 --> 00:26:19,459
just say

615
00:26:20,420 --> 00:26:24,210
but for Android the system actually the

616
00:26:24,210 --> 00:26:26,190
actual system doesn't care at all with

617
00:26:26,190 --> 00:26:28,890
the day Google Play cares about the day

618
00:26:28,890 --> 00:26:31,290
but the system doesn't care at all so

619
00:26:31,290 --> 00:26:32,670
you can have a certificate that is

620
00:26:32,670 --> 00:26:34,590
already expire you'll be able to install

621
00:26:34,590 --> 00:26:36,300
the application on your phone or your

622
00:26:36,300 --> 00:26:38,580
device but you won't be able to make it

623
00:26:38,580 --> 00:26:41,970
to the product to the store all right so

624
00:26:41,970 --> 00:26:43,470
there's a bunch of rule to be accepted

625
00:26:43,470 --> 00:26:44,970
to the Play Store but that they don't

626
00:26:44,970 --> 00:26:47,220
matter for malware creator so they don't

627
00:26:47,220 --> 00:26:49,110
necessarily follow them leave I guess

628
00:26:49,110 --> 00:26:51,780
they should you know so the certificate

629
00:26:51,780 --> 00:26:55,130
of an app - lets not expire before

630
00:26:55,130 --> 00:26:58,770
sometimes in 2023 and the certificate

631
00:26:58,770 --> 00:27:01,200
must have started this is valid per year

632
00:27:01,200 --> 00:27:03,690
when you push the application but it can

633
00:27:03,690 --> 00:27:05,190
still be installed on a device if you

634
00:27:05,190 --> 00:27:07,290
don't do to the place so we've used two

635
00:27:07,290 --> 00:27:09,800
strategies to leverage that information

636
00:27:09,800 --> 00:27:12,690
the first one is what is the actual

637
00:27:12,690 --> 00:27:14,340
value difference what is the Delta

638
00:27:14,340 --> 00:27:15,960
between the end time and the start

639
00:27:15,960 --> 00:27:20,870
ending and start dying of validity and

640
00:27:20,870 --> 00:27:25,890
and what we seen as data is two

641
00:27:25,890 --> 00:27:28,230
completely different world between legit

642
00:27:28,230 --> 00:27:30,620
and malware so in the legit world

643
00:27:30,620 --> 00:27:33,600
legitimate application the minimum

644
00:27:33,600 --> 00:27:37,080
values of value t period is 18 years all

645
00:27:37,080 --> 00:27:37,290
right

646
00:27:37,290 --> 00:27:41,430
and actually the the what is suggested

647
00:27:41,430 --> 00:27:43,380
to developers from the Google Play Store

648
00:27:43,380 --> 00:27:44,760
use 25 year

649
00:27:44,760 --> 00:27:47,340
all right so sort of a long code or

650
00:27:47,340 --> 00:27:50,370
malware the Mac the minimum value is one

651
00:27:50,370 --> 00:27:52,500
day but they really don't care about the

652
00:27:52,500 --> 00:27:54,360
valid Sitapur it's going to be installed

653
00:27:54,360 --> 00:27:57,800
anyway even if it's not valid anymore

654
00:27:57,800 --> 00:28:01,620
and it's the average for malware is 10

655
00:28:01,620 --> 00:28:03,980
year and for legitimate application is

656
00:28:03,980 --> 00:28:06,240
189 years so there's a huge huge

657
00:28:06,240 --> 00:28:08,460
difference between value DT period of

658
00:28:08,460 --> 00:28:10,470
malware and legitimate application and

659
00:28:10,470 --> 00:28:12,990
this is something that we can look at it

660
00:28:12,990 --> 00:28:16,650
very easily and that you guys when you

661
00:28:16,650 --> 00:28:18,210
write your malware you should you know

662
00:28:18,210 --> 00:28:20,970
be careful with that the second strategy

663
00:28:20,970 --> 00:28:22,650
I'm going to talk a bit more about that

664
00:28:22,650 --> 00:28:24,570
later is the difference the Delta

665
00:28:24,570 --> 00:28:29,340
between this tarde the start date of the

666
00:28:29,340 --> 00:28:32,250
circuit when the the certificates start

667
00:28:32,250 --> 00:28:33,420
to be valid

668
00:28:33,420 --> 00:28:34,920
and that they the application was

669
00:28:34,920 --> 00:28:37,680
created is there a sort of a delta

670
00:28:37,680 --> 00:28:39,930
between those two I'm gonna come back

671
00:28:39,930 --> 00:28:42,390
with this like whenever I've talked

672
00:28:42,390 --> 00:28:45,420
about creation there so I mentioned it a

673
00:28:45,420 --> 00:28:47,730
bit earlier so creation date is we

674
00:28:47,730 --> 00:28:50,580
extract the archive we pick the last

675
00:28:50,580 --> 00:28:52,290
medication date of the manifest and we

676
00:28:52,290 --> 00:28:54,660
say this is the creation date of the

677
00:28:54,660 --> 00:29:02,070
application now it's not 100% right okay

678
00:29:02,070 --> 00:29:04,160
for two reason we've got a bunch of

679
00:29:04,160 --> 00:29:06,300
application that were created before

680
00:29:06,300 --> 00:29:11,820
2000 okay which is weird for Android for

681
00:29:11,820 --> 00:29:13,530
those who don't know it wasn't there

682
00:29:13,530 --> 00:29:19,490
before 2000 alright and we also have

683
00:29:19,490 --> 00:29:22,710
it's not always clear that the manifest

684
00:29:22,710 --> 00:29:26,130
will be encoded when when you generate

685
00:29:26,130 --> 00:29:28,830
your apk so sometimes the Dex file is a

686
00:29:28,830 --> 00:29:32,160
bit more recent than the apk manifest so

687
00:29:32,160 --> 00:29:34,350
we'll eventually in the better algorithm

688
00:29:34,350 --> 00:29:36,240
for that but but let's not borrow with

689
00:29:36,240 --> 00:29:39,060
those idea let's assume that this works

690
00:29:39,060 --> 00:29:43,740
fairly and what we can see is that the

691
00:29:43,740 --> 00:29:46,800
malware creator like the legitimate

692
00:29:46,800 --> 00:29:49,200
application creator they work mostly

693
00:29:49,200 --> 00:29:52,710
Monday through Friday create their their

694
00:29:52,710 --> 00:29:55,290
apps and they do something else on the

695
00:29:55,290 --> 00:29:57,570
weekend or you could say well they write

696
00:29:57,570 --> 00:30:00,030
one legitimate application with one end

697
00:30:00,030 --> 00:30:01,530
and the malware on the other end and at

698
00:30:01,530 --> 00:30:03,990
the same time so different view

699
00:30:03,990 --> 00:30:05,990
different ways of saying that but

700
00:30:05,990 --> 00:30:08,820
creation date is sort of interesting now

701
00:30:08,820 --> 00:30:10,260
if we come back with the Delta between

702
00:30:10,260 --> 00:30:13,800
the creation date and the start of the

703
00:30:13,800 --> 00:30:15,750
validity period of the certificate this

704
00:30:15,750 --> 00:30:17,130
is weird

705
00:30:17,130 --> 00:30:19,890
and we look at those value with second

706
00:30:19,890 --> 00:30:22,740
level precision so like the Delta is one

707
00:30:22,740 --> 00:30:24,330
second that it takes two second the

708
00:30:24,330 --> 00:30:27,690
Delta is six hours 23 minutes three

709
00:30:27,690 --> 00:30:30,540
seconds we get that graph now this is an

710
00:30:30,540 --> 00:30:35,510
awesome graph so the values are the

711
00:30:35,510 --> 00:30:38,070
x-axis is ours and the y-axis is the

712
00:30:38,070 --> 00:30:39,570
number of application the number of

713
00:30:39,570 --> 00:30:42,690
malware sample so what we but jumps at

714
00:30:42,690 --> 00:30:45,300
us or should you haven't yet figured out

715
00:30:45,300 --> 00:30:46,919
is that we are

716
00:30:46,919 --> 00:30:51,539
the clock at hours 12 hours at Delta of

717
00:30:51,539 --> 00:30:54,570
12 hours between a creation of the apk

718
00:30:54,570 --> 00:30:58,830
and the start date of the validity of

719
00:30:58,830 --> 00:31:01,679
the certificate 12 hours 12 hours plus

720
00:31:01,679 --> 00:31:03,960
one second 12-hour - one second - the

721
00:31:03,960 --> 00:31:08,580
a cluster there 13 hours sharp eight

722
00:31:08,580 --> 00:31:11,190
hours sharp seven hours sharp six hours

723
00:31:11,190 --> 00:31:12,419
sharp 5 our shock

724
00:31:12,419 --> 00:31:14,850
0 our shock okay so we're on the clock

725
00:31:14,850 --> 00:31:18,269
on the hour this is really really weird

726
00:31:18,269 --> 00:31:22,409
and it's gonna suck but I don't really

727
00:31:22,409 --> 00:31:24,359
have a smart explanation for that my

728
00:31:24,359 --> 00:31:29,549
guess would be that the math the

729
00:31:29,549 --> 00:31:31,639
certificate is created on a machine and

730
00:31:31,639 --> 00:31:34,259
then the code and the certificate light

731
00:31:34,259 --> 00:31:38,190
ship on an under machine like package or

732
00:31:38,190 --> 00:31:40,649
malware as a service and then the EAP

733
00:31:40,649 --> 00:31:42,690
case tweeted there and the under machine

734
00:31:42,690 --> 00:31:44,999
will be on a different time zone so

735
00:31:44,999 --> 00:31:47,639
there's gonna be a an hour gap a few

736
00:31:47,639 --> 00:31:50,340
hour gap between those time with maybe

737
00:31:50,340 --> 00:31:55,320
sometimes one second because we've got a

738
00:31:55,320 --> 00:31:58,049
network glitch that took us longer to

739
00:31:58,049 --> 00:32:01,710
upload our stuff so this is something

740
00:32:01,710 --> 00:32:03,629
that that I'm looking for a smarter

741
00:32:03,629 --> 00:32:07,590
explanation to that but this is data

742
00:32:07,590 --> 00:32:10,529
that is we interesting to look at

743
00:32:10,529 --> 00:32:14,879
then there's the file list I'm going to

744
00:32:14,879 --> 00:32:17,190
just point to things here the first one

745
00:32:17,190 --> 00:32:19,440
is that the number of file in the

746
00:32:19,440 --> 00:32:21,330
legitimate application it's much higher

747
00:32:21,330 --> 00:32:23,100
than a number of file in the malware

748
00:32:23,100 --> 00:32:24,869
which sort of makes sense like in a

749
00:32:24,869 --> 00:32:26,759
matter where you don't expect them to

750
00:32:26,759 --> 00:32:29,210
provide you with icons for all different

751
00:32:29,210 --> 00:32:32,340
screen sizes they just wanted to run and

752
00:32:32,340 --> 00:32:34,379
infect your system so you don't care

753
00:32:34,379 --> 00:32:37,019
whether it looks slick or not so the

754
00:32:37,019 --> 00:32:39,749
number of file is quite different for a

755
00:32:39,749 --> 00:32:44,489
ratio of two to one and there's a lot of

756
00:32:44,489 --> 00:32:46,950
malware that when you unpack the apk

757
00:32:46,950 --> 00:32:48,869
what you find inside is a bunch of file

758
00:32:48,869 --> 00:32:50,669
Dex file manifest certificate and

759
00:32:50,669 --> 00:32:52,679
another repeating and this is

760
00:32:52,679 --> 00:32:55,889
interesting because from the outside you

761
00:32:55,889 --> 00:32:58,679
picky you can go and run curd code that

762
00:32:58,679 --> 00:33:00,630
is within the sort of

763
00:33:00,630 --> 00:33:04,139
embedded apk so when you do analysis of

764
00:33:04,139 --> 00:33:06,630
malware tatak and other malware and you

765
00:33:06,630 --> 00:33:09,929
need go to all the levels to get

766
00:33:09,929 --> 00:33:11,909
probably the code that you're looking

767
00:33:11,909 --> 00:33:14,970
but it's interesting and there's a few

768
00:33:14,970 --> 00:33:18,210
legit that do that as well not too sure

769
00:33:18,210 --> 00:33:18,960
why yeah

770
00:33:18,960 --> 00:33:20,809
all right so now we've got a lot of

771
00:33:20,809 --> 00:33:26,340
statistics and data and and we provide a

772
00:33:26,340 --> 00:33:28,789
few laughs about mistakes that they do

773
00:33:28,789 --> 00:33:33,419
what can we do about it can we like say

774
00:33:33,419 --> 00:33:35,429
well these malware they're from the same

775
00:33:35,429 --> 00:33:36,870
place because they're just too much

776
00:33:36,870 --> 00:33:40,529
alike so I've got a bunch I've got three

777
00:33:40,529 --> 00:33:44,820
cases to show you so the one the first

778
00:33:44,820 --> 00:33:48,090
one we pick one sample with the 75 and

779
00:33:48,090 --> 00:33:49,710
we want to know what can we do about of

780
00:33:49,710 --> 00:33:51,600
course it's all pre kuk right I did it

781
00:33:51,600 --> 00:33:53,669
before I know what gonna happen but you

782
00:33:53,669 --> 00:33:56,879
don't so we've got fourteen apks that

783
00:33:56,879 --> 00:33:58,620
are grouped together with these stamps

784
00:33:58,620 --> 00:34:00,450
so what we've done years we'll take each

785
00:34:00,450 --> 00:34:03,240
feature that we've extracted and the

786
00:34:03,240 --> 00:34:06,629
bubble is a specific value for that

787
00:34:06,629 --> 00:34:08,460
feature the larger the bubble the more

788
00:34:08,460 --> 00:34:11,969
apks have that value so for applying I'm

789
00:34:11,969 --> 00:34:14,609
gonna pick one at the highlight so for

790
00:34:14,609 --> 00:34:16,829
the circuit file name all the 14th year

791
00:34:16,829 --> 00:34:19,649
use the same fine line it's sort at RSA

792
00:34:19,649 --> 00:34:21,690
they all user that are see there's a

793
00:34:21,690 --> 00:34:23,790
hundred house more than a hundred

794
00:34:23,790 --> 00:34:28,020
thousand malware that does that for the

795
00:34:28,020 --> 00:34:32,069
application name the user come that you

796
00:34:32,069 --> 00:34:33,480
use safe Pratt the trapper that

797
00:34:33,480 --> 00:34:36,119
application there are nineteen malware

798
00:34:36,119 --> 00:34:37,949
that does that we've got a cluster of

799
00:34:37,949 --> 00:34:40,319
fourteen so this is sort of a bit more

800
00:34:40,319 --> 00:34:44,040
focused and what we have here is they

801
00:34:44,040 --> 00:34:46,199
all use the same public those fourteen

802
00:34:46,199 --> 00:34:48,119
use the same public hinder certificate

803
00:34:48,119 --> 00:34:50,310
and they're the only fourteen that does

804
00:34:50,310 --> 00:34:52,770
that okay so at that point we say well

805
00:34:52,770 --> 00:34:57,060
guys we got you the these are together

806
00:34:57,060 --> 00:34:58,980
for sure they're from the same place

807
00:34:58,980 --> 00:35:00,420
from the same guy or from the same

808
00:35:00,420 --> 00:35:03,960
organization or something like that so

809
00:35:03,960 --> 00:35:05,640
they go together they might not at all

810
00:35:05,640 --> 00:35:08,940
be the same malicious behavior okay but

811
00:35:08,940 --> 00:35:11,700
they come from the same point so it's

812
00:35:11,700 --> 00:35:14,420
the same cases this is a sort of it

813
00:35:14,420 --> 00:35:18,600
can you see anything on that or I'm just

814
00:35:18,600 --> 00:35:20,970
gonna highlight you if it's done they'll

815
00:35:20,970 --> 00:35:22,710
promise you can't read that much of

816
00:35:22,710 --> 00:35:24,180
what's there I'm good

817
00:35:24,180 --> 00:35:26,130
I'll go true what's important so we've

818
00:35:26,130 --> 00:35:28,080
got 14 sample that were created across

819
00:35:28,080 --> 00:35:30,000
an 18-month period so it quite it's

820
00:35:30,000 --> 00:35:33,690
quite a long span for so few sample so

821
00:35:33,690 --> 00:35:35,880
it this is interesting

822
00:35:35,880 --> 00:35:37,740
the very duty per yard for the circuit

823
00:35:37,740 --> 00:35:42,810
is always 1,000 day okay so I forget to

824
00:35:42,810 --> 00:35:44,070
mention something about the value TT

825
00:35:44,070 --> 00:35:46,290
period the reason why it's so low big

826
00:35:46,290 --> 00:35:49,350
for malware and so I for legit is when

827
00:35:49,350 --> 00:35:53,450
you package your legit application to

828
00:35:53,630 --> 00:35:59,610
tips or whenever ID you're using the

829
00:35:59,610 --> 00:36:02,010
default value gives you is 25 years it's

830
00:36:02,010 --> 00:36:03,870
in years so you you say three it's three

831
00:36:03,870 --> 00:36:06,600
year if you leave the default value 25

832
00:36:06,600 --> 00:36:08,970
years when you're a malware writer you

833
00:36:08,970 --> 00:36:11,430
don't go to that painting of using an

834
00:36:11,430 --> 00:36:12,750
IDE you generate your stuff

835
00:36:12,750 --> 00:36:14,040
automatically from the command line

836
00:36:14,040 --> 00:36:17,940
maybe you it using a tool like open SSL

837
00:36:17,940 --> 00:36:20,940
whatever and when you specify the value

838
00:36:20,940 --> 00:36:22,560
T period in that kind of to those kind

839
00:36:22,560 --> 00:36:24,990
of tool the default value is dice so if

840
00:36:24,990 --> 00:36:26,550
you enter tree it's gonna be three dates

841
00:36:26,550 --> 00:36:28,920
so that's one of the reason why it's so

842
00:36:28,920 --> 00:36:30,230
undone

843
00:36:30,230 --> 00:36:34,620
okay case number two it's a bit more

844
00:36:34,620 --> 00:36:37,710
difficult to see so we've got again a

845
00:36:37,710 --> 00:36:41,490
bunch of big bubbles so we got two

846
00:36:41,490 --> 00:36:44,070
hundred seventy seven application or

847
00:36:44,070 --> 00:36:46,410
malware samples that are clustered with

848
00:36:46,410 --> 00:36:48,780
the same app version name all right so

849
00:36:48,780 --> 00:36:50,880
they all use sort of RSA as a file name

850
00:36:50,880 --> 00:36:52,710
well they all do so we don't care they

851
00:36:52,710 --> 00:36:55,050
use seven as the mean SDK version but

852
00:36:55,050 --> 00:36:57,090
lots of them do they use 10 as the

853
00:36:57,090 --> 00:36:59,130
target SDK but a bunch of them do as

854
00:36:59,130 --> 00:37:00,690
well so it's hard

855
00:37:00,690 --> 00:37:02,610
they used 19 and 20 as the app version

856
00:37:02,610 --> 00:37:04,800
but a bunch of them does as well and

857
00:37:04,800 --> 00:37:08,130
they used 92.0 for the application

858
00:37:08,130 --> 00:37:10,770
version 9 so that's a string and only

859
00:37:10,770 --> 00:37:14,430
need 277 do that but it's not really

860
00:37:14,430 --> 00:37:17,010
hard evidence enough so 92.0 is sort of

861
00:37:17,010 --> 00:37:18,420
like I can put that in my application

862
00:37:18,420 --> 00:37:20,220
and you can put that in your application

863
00:37:20,220 --> 00:37:24,360
and we haven't talked to each other so

864
00:37:24,360 --> 00:37:26,130
if we dig a bit more in the data we see

865
00:37:26,130 --> 00:37:28,200
that there's 8 different values for that

866
00:37:28,200 --> 00:37:29,970
shishun name and they all have the same

867
00:37:29,970 --> 00:37:32,220
pattern have come that for letter for

868
00:37:32,220 --> 00:37:34,820
letter that five letters in lowercase if

869
00:37:34,820 --> 00:37:39,089
we go with the creation diet it spans

870
00:37:39,089 --> 00:37:42,690
from it's a month span from February to

871
00:37:42,690 --> 00:37:47,010
March of 2016 so they're 277 application

872
00:37:47,010 --> 00:37:50,520
cluster into that space or that time and

873
00:37:50,520 --> 00:37:54,030
if we take the application package now

874
00:37:54,030 --> 00:37:55,230
this is going to be cooler go play

875
00:37:55,230 --> 00:37:59,760
Scrabble with malware so I'm gonna blow

876
00:37:59,760 --> 00:38:01,530
this up a little bit and give out with

877
00:38:01,530 --> 00:38:04,230
my punch so these are the big bullet the

878
00:38:04,230 --> 00:38:05,880
black bullet or the actual package name

879
00:38:05,880 --> 00:38:10,290
and the sort of empty bullet or indented

880
00:38:10,290 --> 00:38:13,710
bullets are the word that originated

881
00:38:13,710 --> 00:38:15,300
from the package name

882
00:38:15,300 --> 00:38:17,400
so the big word all starting with the

883
00:38:17,400 --> 00:38:20,460
same letter and the added randomly a

884
00:38:20,460 --> 00:38:22,920
bunch of letters into that so that can

885
00:38:22,920 --> 00:38:26,400
we become Joshua Lee cattle becomes a

886
00:38:26,400 --> 00:38:29,310
doubler and sealing weakens feed so like

887
00:38:29,310 --> 00:38:32,609
they're playing with words to I guess

888
00:38:32,609 --> 00:38:34,170
throw us off or something I don't know

889
00:38:34,170 --> 00:38:36,359
but then when you look at that data and

890
00:38:36,359 --> 00:38:38,190
you see the process behind it's fairly

891
00:38:38,190 --> 00:38:41,040
clear I don't think that a lot of people

892
00:38:41,040 --> 00:38:43,020
will do that kind of game in their

893
00:38:43,020 --> 00:38:45,150
basement independent of one another but

894
00:38:45,150 --> 00:38:47,640
to me this is this is this is from the

895
00:38:47,640 --> 00:38:53,040
same place okay case number trees also

896
00:38:53,040 --> 00:38:54,660
interesting so we long we're getting a

897
00:38:54,660 --> 00:38:58,170
larger cluster so 7223

898
00:38:58,170 --> 00:39:02,220
malware sample all started with all with

899
00:39:02,220 --> 00:39:03,869
the application package starting with

900
00:39:03,869 --> 00:39:06,599
the specific graphics come that ym that

901
00:39:06,599 --> 00:39:10,290
weft package that G X Y Q dot not that

902
00:39:10,290 --> 00:39:12,030
but something else at the end there's

903
00:39:12,030 --> 00:39:13,710
something else is different for for

904
00:39:13,710 --> 00:39:15,450
every sample but if prefix always the

905
00:39:15,450 --> 00:39:17,240
same

906
00:39:17,240 --> 00:39:22,400
so again min version doesn't mean much

907
00:39:22,400 --> 00:39:24,440
target version doesn't mean much

908
00:39:24,440 --> 00:39:27,420
certificate is temp dot RSI so it's it

909
00:39:27,420 --> 00:39:29,819
doesn't mean much but actually it's

910
00:39:29,819 --> 00:39:31,650
pretty only those sample that use that

911
00:39:31,650 --> 00:39:34,920
file nine so it's quite interesting the

912
00:39:34,920 --> 00:39:36,869
certificates object or this one is good

913
00:39:36,869 --> 00:39:38,910
it's all they almost all use the same

914
00:39:38,910 --> 00:39:40,800
and then there's a bunch of different

915
00:39:40,800 --> 00:39:42,030
things so we're going to see

916
00:39:42,030 --> 00:39:45,090
data differently package names with the

917
00:39:45,090 --> 00:39:47,220
prefix that I've mentioned the app label

918
00:39:47,220 --> 00:39:53,160
it's always prefix and then VIP and five

919
00:39:53,160 --> 00:39:55,440
number so a huge pattern you can see

920
00:39:55,440 --> 00:39:58,710
here there's subject nine so we've got

921
00:39:58,710 --> 00:40:00,570
six thousand seven hundred sample that

922
00:40:00,570 --> 00:40:04,910
use xx xx xx xx and shoe any as as a

923
00:40:04,910 --> 00:40:08,700
subject nine and the other all the other

924
00:40:08,700 --> 00:40:11,820
so we've got like five six hundred ish

925
00:40:11,820 --> 00:40:14,610
others they use a pattern so they're

926
00:40:14,610 --> 00:40:16,800
random and unique but use a pattern of

927
00:40:16,800 --> 00:40:18,510
two letter to letter to letter to letter

928
00:40:18,510 --> 00:40:22,050
to letter seven letter okay and then a

929
00:40:22,050 --> 00:40:24,930
certificate pine nine most of them the

930
00:40:24,930 --> 00:40:26,700
exact same number six thousand seven

931
00:40:26,700 --> 00:40:29,280
hundred zero six you stamped at RSA and

932
00:40:29,280 --> 00:40:32,550
all the others they use five capital

933
00:40:32,550 --> 00:40:36,750
letter RSA and if we show this data into

934
00:40:36,750 --> 00:40:41,550
a timeline what we see I'm gonna jump up

935
00:40:41,550 --> 00:40:44,370
the stage here and I surely I got it

936
00:40:44,370 --> 00:40:46,880
yeah so the first line here is the cut

937
00:40:46,880 --> 00:40:51,060
between the subject line so prior to

938
00:40:51,060 --> 00:40:54,480
that line here subject name was the same

939
00:40:54,480 --> 00:40:57,900
and after that line which is the date is

940
00:40:57,900 --> 00:41:01,710
October 31st of 2016

941
00:41:01,710 --> 00:41:04,500
they changed the way that they generate

942
00:41:04,500 --> 00:41:07,680
the subject nine for their malware they

943
00:41:07,680 --> 00:41:09,930
also changed away at this point that

944
00:41:09,930 --> 00:41:12,090
they generate this the fight the circuit

945
00:41:12,090 --> 00:41:14,250
file name so they went from ten dot RSA

946
00:41:14,250 --> 00:41:18,300
to five random letter that Arthur and a

947
00:41:18,300 --> 00:41:21,060
month later first of December of the

948
00:41:21,060 --> 00:41:23,030
same year they changed the way that they

949
00:41:23,030 --> 00:41:25,680
generate their application label so they

950
00:41:25,680 --> 00:41:28,080
went from VIP five number to something

951
00:41:28,080 --> 00:41:29,640
that five number so they dropped into

952
00:41:29,640 --> 00:41:35,010
the VIP decibel so now we can follow the

953
00:41:35,010 --> 00:41:38,310
evolution of their a no generation

954
00:41:38,310 --> 00:41:42,330
process for the malware so at this point

955
00:41:42,330 --> 00:41:44,580
we say well you guys can follow you

956
00:41:44,580 --> 00:41:46,320
enough that that we know you're from the

957
00:41:46,320 --> 00:41:49,340
design so I'm thinking I'm running a bit

958
00:41:49,340 --> 00:41:52,320
late five minutes okay good

959
00:41:52,320 --> 00:41:55,680
so we're gonna see I made a

960
00:41:55,680 --> 00:41:59,309
for you a super crazy dashboard with a

961
00:41:59,309 --> 00:42:02,400
new technology that called HTML what we

962
00:42:02,400 --> 00:42:06,329
can sort of visualize or navigate

963
00:42:06,329 --> 00:42:08,280
through the cluster so we just pick one

964
00:42:08,280 --> 00:42:09,839
feature that this will start with

965
00:42:09,839 --> 00:42:12,599
signature and we have these are all the

966
00:42:12,599 --> 00:42:14,579
all this thing the values we see for

967
00:42:14,579 --> 00:42:16,349
certificates signature and all the

968
00:42:16,349 --> 00:42:18,780
clusters so we've got first line here is

969
00:42:18,780 --> 00:42:23,089
a cluster of sides 142 a cluster of size

970
00:42:23,089 --> 00:42:26,520
2119 so let's look at this one so this

971
00:42:26,520 --> 00:42:28,589
is all the feature for all the samples

972
00:42:28,589 --> 00:42:30,720
into that cluster and we see that they

973
00:42:30,720 --> 00:42:32,849
all use the same value for most of the

974
00:42:32,849 --> 00:42:35,640
field except for not valid before date

975
00:42:35,640 --> 00:42:37,859
not valid after date and the valid 50

976
00:42:37,859 --> 00:42:39,690
per year so there's something here that

977
00:42:39,690 --> 00:42:42,089
change we've got 2000 sample in that

978
00:42:42,089 --> 00:42:44,400
cluster and we've got two different not

979
00:42:44,400 --> 00:42:47,250
valid before date bad ok so we've got a

980
00:42:47,250 --> 00:42:51,540
very very strong feeling that they are

981
00:42:51,540 --> 00:42:53,819
indeed the same from the same place

982
00:42:53,819 --> 00:42:55,319
because all the values are the same

983
00:42:55,319 --> 00:42:59,970
all right let's come back and you know

984
00:42:59,970 --> 00:43:05,849
the one may be a subject line and most

985
00:43:05,849 --> 00:43:08,069
Hongkou we pick another one and we see

986
00:43:08,069 --> 00:43:10,559
that well this one has a fewer fields

987
00:43:10,559 --> 00:43:13,650
that are assigned but we can again get a

988
00:43:13,650 --> 00:43:16,109
good overview while they use all the

989
00:43:16,109 --> 00:43:18,150
same sort of to get stuff so right off

990
00:43:18,150 --> 00:43:19,740
the bat they are done this is coming

991
00:43:19,740 --> 00:43:22,890
from the same place but they use the

992
00:43:22,890 --> 00:43:25,260
same version of target is in use the

993
00:43:25,260 --> 00:43:27,930
same label same application name and so

994
00:43:27,930 --> 00:43:31,950
on and we have another one that might be

995
00:43:31,950 --> 00:43:34,609
interesting

996
00:43:37,310 --> 00:43:39,710
see this comes back you want me untie

997
00:43:39,710 --> 00:43:43,400
that I cannot read those and we see that

998
00:43:43,400 --> 00:43:45,260
they used this very same subject but

999
00:43:45,260 --> 00:43:47,930
they changed the certificate so we've

1000
00:43:47,930 --> 00:43:50,150
got a cluster size of 140 that use

1001
00:43:50,150 --> 00:43:52,700
always the same subject name always the

1002
00:43:52,700 --> 00:43:54,650
same that I did before not added after

1003
00:43:54,650 --> 00:43:56,570
and always the same validity per year

1004
00:43:56,570 --> 00:44:00,770
which is a hard number twenty thousand

1005
00:44:00,770 --> 00:44:04,910
eighty one days turns out not sorry

1006
00:44:04,910 --> 00:44:06,710
that's not the value so it's nine

1007
00:44:06,710 --> 00:44:09,650
hundred 125 days and we've got twenty

1008
00:44:09,650 --> 00:44:13,430
thousand sample using that value alright

1009
00:44:13,430 --> 00:44:17,599
so so there's a lot lot lot lot lot of

1010
00:44:17,599 --> 00:44:20,900
clustering to be done with with those

1011
00:44:20,900 --> 00:44:26,570
bad so conclusion so we've got some

1012
00:44:26,570 --> 00:44:28,580
weird so we can easily extract weird

1013
00:44:28,580 --> 00:44:30,560
stuff or interesting stuff to do

1014
00:44:30,560 --> 00:44:32,270
coronation it's low-hanging fruit

1015
00:44:32,270 --> 00:44:34,820
there's weird stuff apks inside EPK

1016
00:44:34,820 --> 00:44:36,650
there's a twelve hour gap there's

1017
00:44:36,650 --> 00:44:39,550
duplicated permission this is weird

1018
00:44:39,550 --> 00:44:42,800
and so the conclusion is so we can do

1019
00:44:42,800 --> 00:44:44,480
easy clustering is this a bad thing or a

1020
00:44:44,480 --> 00:44:46,640
good thing well it's good news because

1021
00:44:46,640 --> 00:44:49,130
it's fairly easy to wrap them all up and

1022
00:44:49,130 --> 00:44:51,740
and do something or detect them or

1023
00:44:51,740 --> 00:44:53,750
whatever we can get better easily but

1024
00:44:53,750 --> 00:44:55,790
it's also bad news because if it means

1025
00:44:55,790 --> 00:44:58,520
that it's so easy then they just don't

1026
00:44:58,520 --> 00:45:00,170
care because they can get away without

1027
00:45:00,170 --> 00:45:03,230
without doing any hard stuff of you know

1028
00:45:03,230 --> 00:45:05,180
picking a different name for each of

1029
00:45:05,180 --> 00:45:08,060
their mouths so I guess we're pretty

1030
00:45:08,060 --> 00:45:09,560
much done or if you have a few questions

1031
00:45:09,560 --> 00:45:11,330
I'll try to avoid them as much as I

1032
00:45:11,330 --> 00:45:13,010
could or I'm sticking around for two

1033
00:45:13,010 --> 00:45:16,609
days so you can grab me you have a chat

1034
00:45:16,609 --> 00:45:19,000
about that

1035
00:45:19,830 --> 00:45:23,288
[Applause]

