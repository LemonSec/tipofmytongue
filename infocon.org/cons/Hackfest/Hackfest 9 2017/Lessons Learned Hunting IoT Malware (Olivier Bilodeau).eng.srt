1
00:00:08,880 --> 00:00:14,040
I'm Oh Here I am so yes very very

2
00:00:14,040 --> 00:00:16,079
excited to share this stuff with you I

3
00:00:16,079 --> 00:00:19,619
hope you'll be you'll like it and and I

4
00:00:19,619 --> 00:00:20,279
will see how it goes

5
00:00:20,279 --> 00:00:24,090
so IOT has been really trendy Brian

6
00:00:24,090 --> 00:00:25,830
Krebs has been talking about it and what

7
00:00:25,830 --> 00:00:29,490
really started everything is the well

8
00:00:29,490 --> 00:00:33,300
for me at least it's more than this it

9
00:00:33,300 --> 00:00:36,360
has been for two years three years now

10
00:00:36,360 --> 00:00:39,260
reverse engineering embedded systems but

11
00:00:39,260 --> 00:00:41,670
what really crystallized it and the

12
00:00:41,670 --> 00:00:43,649
public eye is Brian Krebs when he

13
00:00:43,649 --> 00:00:46,379
published that OVH got a 1.5 terabyte

14
00:00:46,379 --> 00:00:49,770
per second DDoS attack from the Mirai

15
00:00:49,770 --> 00:00:52,559
and all of that that group and so this

16
00:00:52,559 --> 00:00:54,329
is where it really started happening

17
00:00:54,329 --> 00:00:57,120
what I liked about OVH and disclosure is

18
00:00:57,120 --> 00:00:58,829
that they were really technical showing

19
00:00:58,829 --> 00:01:00,989
stuff and now just like all the world is

20
00:01:00,989 --> 00:01:02,940
falling about we have no logs or no

21
00:01:02,940 --> 00:01:05,369
steps he went on Twitter with

22
00:01:05,369 --> 00:01:07,500
screenshots with like this geeky you

23
00:01:07,500 --> 00:01:09,900
know grape Hawk said and all this ascent

24
00:01:09,900 --> 00:01:11,729
men were like this is the this is

25
00:01:11,729 --> 00:01:13,920
what I do every day and so you see here

26
00:01:13,920 --> 00:01:17,220
like like the combination of the attack

27
00:01:17,220 --> 00:01:20,640
is like some of the cameras that were

28
00:01:20,640 --> 00:01:24,090
ddosing them had a very large internet

29
00:01:24,090 --> 00:01:25,979
pipes and so it was really attacking

30
00:01:25,979 --> 00:01:29,220
them massively and so he culminated that

31
00:01:29,220 --> 00:01:32,990
the botnet is around 150,000 devices

32
00:01:32,990 --> 00:01:35,729
cameras DVRs and stuff like that

33
00:01:35,729 --> 00:01:37,560
all with the connection between 1 and 30

34
00:01:37,560 --> 00:01:39,900
megabit per second this culminated into

35
00:01:39,900 --> 00:01:43,320
this 1.5 terabyte terabit per second

36
00:01:43,320 --> 00:01:46,740
story attack so this is where you know

37
00:01:46,740 --> 00:01:49,950
the IOT stuff gets problematic why I'm

38
00:01:49,950 --> 00:01:52,110
here I've been talking about this for a

39
00:01:52,110 --> 00:01:54,030
while so this was two years ago at

40
00:01:54,030 --> 00:01:58,380
hackfest so internet or up threats

41
00:01:58,380 --> 00:02:02,219
kind of stuff I try I hope like it's not

42
00:02:02,219 --> 00:02:04,860
again another IOT talk about the same

43
00:02:04,860 --> 00:02:07,079
 that we hear like IOT insecure

44
00:02:07,079 --> 00:02:07,680
and like that

45
00:02:07,680 --> 00:02:10,500
I mean this has been done by very good

46
00:02:10,500 --> 00:02:13,080
people very good talks me I'm really on

47
00:02:13,080 --> 00:02:15,120
focus on a malware and what's happening

48
00:02:15,120 --> 00:02:17,670
and and and what is actually bad for us

49
00:02:17,670 --> 00:02:20,040
right now not speculation on what it

50
00:02:20,040 --> 00:02:21,840
could be or what it will become

51
00:02:21,840 --> 00:02:25,980
and so the agenda for today is when we

52
00:02:25,980 --> 00:02:27,990
are hunting IOT malware the specifics

53
00:02:27,990 --> 00:02:29,970
what are the problem areas

54
00:02:29,970 --> 00:02:31,980
the problem is around collecting threats

55
00:02:31,980 --> 00:02:33,720
for us which is different than AV which

56
00:02:33,720 --> 00:02:36,180
will cover honey pots are a big part of

57
00:02:36,180 --> 00:02:38,970
it together these threats then once you

58
00:02:38,970 --> 00:02:40,380
have the samples you have reverse

59
00:02:40,380 --> 00:02:42,090
engineering problems which are different

60
00:02:42,090 --> 00:02:44,220
than Windows reverse engineering

61
00:02:44,220 --> 00:02:48,960
problems then you you you track a but

62
00:02:48,960 --> 00:02:50,550
net you run an infected those who

63
00:02:50,550 --> 00:02:52,230
collect data you have that analytic

64
00:02:52,230 --> 00:02:55,260
problem you I'll show you some three

65
00:02:55,260 --> 00:02:57,480
cases of malware that I've studied in

66
00:02:57,480 --> 00:03:00,500
the past few years that are kind of IOT

67
00:03:00,500 --> 00:03:04,470
style samples and then some takeaways

68
00:03:04,470 --> 00:03:06,810
and stuff that we can do as developer as

69
00:03:06,810 --> 00:03:09,270
buyers of products to make sure that the

70
00:03:09,270 --> 00:03:10,650
world would be a better place actually

71
00:03:10,650 --> 00:03:13,140
but first I wanted to say that I love

72
00:03:13,140 --> 00:03:18,360
mcfist so for me access 9 its my seventh

73
00:03:18,360 --> 00:03:21,209
hackfest that I am here and I think it's

74
00:03:21,209 --> 00:03:24,150
my fifth time speaking and or paneling

75
00:03:24,150 --> 00:03:27,209
and or stuff like that and so this year

76
00:03:27,209 --> 00:03:30,060
I will also do the animation of the the

77
00:03:30,060 --> 00:03:34,890
OSPF we're doing a lot of stuff this

78
00:03:34,890 --> 00:03:38,760
year and I it's just so much fun so much

79
00:03:38,760 --> 00:03:41,190
cool people and the CTF and everything's

80
00:03:41,190 --> 00:03:45,300
been growing it's amazing so Who am I

81
00:03:45,300 --> 00:03:47,750
cyber security researcher I go secure I

82
00:03:47,750 --> 00:03:50,490
founded co-founded mantri hack we've

83
00:03:50,490 --> 00:03:52,050
been doing this for five years next

84
00:03:52,050 --> 00:03:54,120
February it will be our fifth year every

85
00:03:54,120 --> 00:03:58,140
month we do technical cpf problem that

86
00:03:58,140 --> 00:03:59,990
we saw I'm really proud of that

87
00:03:59,990 --> 00:04:03,630
VP training of North SEC and I run the

88
00:04:03,630 --> 00:04:05,520
hacker jeopardy I write a question I run

89
00:04:05,520 --> 00:04:08,570
the show for it's our sixth seventh year

90
00:04:08,570 --> 00:04:11,580
so I really love this industry I love

91
00:04:11,580 --> 00:04:12,900
communicating and I love meeting people

92
00:04:12,900 --> 00:04:16,108
so don't hesitate to come and talk now

93
00:04:16,108 --> 00:04:18,120
I'm going fast because there's a lot of

94
00:04:18,120 --> 00:04:20,850
stuff here the problem area so Internet

95
00:04:20,850 --> 00:04:23,100
of Things this kind of conflated terms

96
00:04:23,100 --> 00:04:24,430
where we bungle

97
00:04:24,430 --> 00:04:27,130
everything in what I like to define it

98
00:04:27,130 --> 00:04:30,280
is an embedded system so embedded system

99
00:04:30,280 --> 00:04:33,520
means small cpu small memory small caste

100
00:04:33,520 --> 00:04:35,380
small caste means you don't have a lot

101
00:04:35,380 --> 00:04:38,770
of money to put on security and stuff

102
00:04:38,770 --> 00:04:41,199
like that the devices tend to be as

103
00:04:41,199 --> 00:04:43,840
generic as possible the architectures

104
00:04:43,840 --> 00:04:47,800
are non x86 usually they are networked

105
00:04:47,800 --> 00:04:51,460
so they have either Wi-Fi or Ethernet a

106
00:04:51,460 --> 00:04:54,340
connectivity they generally run Linux

107
00:04:54,340 --> 00:04:56,949
and this is again for costs reasons so

108
00:04:56,949 --> 00:04:59,500
running the same platform means that

109
00:04:59,500 --> 00:05:03,310
attackers can with one executable affect

110
00:05:03,310 --> 00:05:05,830
a lot of platforms which makes it bad in

111
00:05:05,830 --> 00:05:10,090
this context and also no user interface

112
00:05:10,090 --> 00:05:13,330
so no user interface is kind of

113
00:05:13,330 --> 00:05:15,699
important here because for threats or

114
00:05:15,699 --> 00:05:19,139
threaten analytics it's it's it matters

115
00:05:19,139 --> 00:05:21,910
so where it gets really problematic for

116
00:05:21,910 --> 00:05:25,449
and from a malware but net perspective

117
00:05:25,449 --> 00:05:27,280
again I want to I want to emphasis on

118
00:05:27,280 --> 00:05:30,360
that is when you have an administrative

119
00:05:30,360 --> 00:05:35,080
access like telnet or SSH exposed if you

120
00:05:35,080 --> 00:05:36,789
have this and when you connect you have

121
00:05:36,789 --> 00:05:39,430
a limited see I like Cisco switches for

122
00:05:39,430 --> 00:05:42,099
example it's less of a problem then if

123
00:05:42,099 --> 00:05:45,520
you get into a busy box shell where you

124
00:05:45,520 --> 00:05:47,639
can run ping and run several commands

125
00:05:47,639 --> 00:05:51,039
double you get you know fetch or stuff

126
00:05:51,039 --> 00:05:51,550
like that

127
00:05:51,550 --> 00:05:55,210
so a full user LAN is worse than having

128
00:05:55,210 --> 00:06:00,009
a custom shell I had ok you don't see

129
00:06:00,009 --> 00:06:05,860
that good having pop ups here the global

130
00:06:05,860 --> 00:06:08,860
credential this is something from a past

131
00:06:08,860 --> 00:06:11,440
era it shouldn't be that way anymore for

132
00:06:11,440 --> 00:06:14,289
routers manufacturers are able to do per

133
00:06:14,289 --> 00:06:16,120
device password so why not

134
00:06:16,120 --> 00:06:18,220
administrative have a per device

135
00:06:18,220 --> 00:06:20,560
password people don't understand like it

136
00:06:20,560 --> 00:06:22,840
yes if you print it on it you know

137
00:06:22,840 --> 00:06:24,610
people will have access the problem is

138
00:06:24,610 --> 00:06:26,560
not that your people in your house is

139
00:06:26,560 --> 00:06:27,759
attacking you the problem on the

140
00:06:27,759 --> 00:06:29,710
internet is people from remote is

141
00:06:29,710 --> 00:06:31,479
attacking you so printing the

142
00:06:31,479 --> 00:06:34,639
password on the mistake er is not bad

143
00:06:34,639 --> 00:06:36,349
not it's not that red mother you looking

144
00:06:36,349 --> 00:06:39,650
after right so again something that can

145
00:06:39,650 --> 00:06:41,240
be plugged directly on the Internet is

146
00:06:41,240 --> 00:06:42,889
more problematic because it can be

147
00:06:42,889 --> 00:06:44,210
accessed by the whole internet and

148
00:06:44,210 --> 00:06:46,430
something that has value of being

149
00:06:46,430 --> 00:06:48,650
plugged on the internet like an IP

150
00:06:48,650 --> 00:06:52,969
camera is a worse problem right also

151
00:06:52,969 --> 00:06:55,909
when you think Internet like we're a

152
00:06:55,909 --> 00:06:57,919
billion people online so of course

153
00:06:57,919 --> 00:07:00,289
people will plug stuff backwards so if

154
00:07:00,289 --> 00:07:02,389
you think oh yeah but we firewall from

155
00:07:02,389 --> 00:07:04,370
the one it's okay but people will put

156
00:07:04,370 --> 00:07:06,469
the LAN port expose on the internet and

157
00:07:06,469 --> 00:07:08,900
then telnet or SSH is available and when

158
00:07:08,900 --> 00:07:11,750
you think oh it will be you know one

159
00:07:11,750 --> 00:07:13,580
percent of the people who will make that

160
00:07:13,580 --> 00:07:15,830
mistake well one percent of a billion is

161
00:07:15,830 --> 00:07:19,879
a lot of people yeah still so the

162
00:07:19,879 --> 00:07:23,750
general-purpose user interface what I'm

163
00:07:23,750 --> 00:07:25,550
saying is like yes of course there are

164
00:07:25,550 --> 00:07:27,199
web interfaces or there are mobile

165
00:07:27,199 --> 00:07:31,339
interfaces but to analyze threats and to

166
00:07:31,339 --> 00:07:34,550
be on the forefront of finding samples

167
00:07:34,550 --> 00:07:37,039
and and stuff like that you need really

168
00:07:37,039 --> 00:07:40,250
like like we have on our Comment systems

169
00:07:40,250 --> 00:07:43,159
you need you know it's just an access

170
00:07:43,159 --> 00:07:44,900
where you can trust that you're not lied

171
00:07:44,900 --> 00:07:47,839
by the the environment or the malware so

172
00:07:47,839 --> 00:07:50,629
you cannot really investigate without a

173
00:07:50,629 --> 00:07:54,800
user interface of some sort this is a

174
00:07:54,800 --> 00:07:57,399
problem I will I will attack on later so

175
00:07:57,399 --> 00:08:00,169
there's another thing like there is no

176
00:08:00,169 --> 00:08:02,060
third party software except from maybe

177
00:08:02,060 --> 00:08:05,719
the the like the NASS some nass have a

178
00:08:05,719 --> 00:08:07,599
kind of an ecosystem an app ecosystem

179
00:08:07,599 --> 00:08:10,210
but besides that I mean there is no

180
00:08:10,210 --> 00:08:13,069
endpoint security there is no AV and I

181
00:08:13,069 --> 00:08:15,199
know people will bash on AV and

182
00:08:15,199 --> 00:08:17,779
next-generation and point whatever but

183
00:08:17,779 --> 00:08:20,509
the thing is they this is right now on

184
00:08:20,509 --> 00:08:24,020
Windows why the malware and not the

185
00:08:24,020 --> 00:08:25,490
malware industry but the anti-malware

186
00:08:25,490 --> 00:08:28,009
industry I guess is on the forefront of

187
00:08:28,009 --> 00:08:29,990
defending is because they do those

188
00:08:29,990 --> 00:08:32,448
near-miss signatures and they collect

189
00:08:32,448 --> 00:08:35,690
trade proactively on your where you run

190
00:08:35,690 --> 00:08:38,149
AV and this is why they do their malware

191
00:08:38,149 --> 00:08:39,380
research this is why they are able to

192
00:08:39,380 --> 00:08:42,469
say oh in Ukraine there is XYZ campaign

193
00:08:42,469 --> 00:08:44,660
it's because they run AV in that country

194
00:08:44,660 --> 00:08:46,730
and they collect the files that the

195
00:08:46,730 --> 00:08:48,410
people get and so they

196
00:08:48,410 --> 00:08:50,629
just because on IOT since there is no

197
00:08:50,629 --> 00:08:52,129
third-party software this doesn't happen

198
00:08:52,129 --> 00:08:54,139
which means that we need to be really

199
00:08:54,139 --> 00:08:56,720
creative in order to be there before the

200
00:08:56,720 --> 00:08:59,360
bad guys are there or at least to

201
00:08:59,360 --> 00:09:01,699
monitor what they are doing right now so

202
00:09:01,699 --> 00:09:05,480
this is in the problems list but again I

203
00:09:05,480 --> 00:09:07,370
don't want to say I would like to see

204
00:09:07,370 --> 00:09:09,860
Kaspersky for routers that this is not

205
00:09:09,860 --> 00:09:16,370
what I'm saying it's just a reality so

206
00:09:16,370 --> 00:09:19,639
it's different on Io t-then desktop

207
00:09:19,639 --> 00:09:21,310
mobile and even server-side threats

208
00:09:21,310 --> 00:09:23,870
because under stuff in mobile you bring

209
00:09:23,870 --> 00:09:26,029
the bad stuff in and there is an

210
00:09:26,029 --> 00:09:28,100
ecosystem of software which can collect

211
00:09:28,100 --> 00:09:29,000
it

212
00:09:29,000 --> 00:09:33,079
we have no there is no UI on IOT and and

213
00:09:33,079 --> 00:09:35,389
it's hard to reach the devices by the

214
00:09:35,389 --> 00:09:36,949
right channels to have access to the

215
00:09:36,949 --> 00:09:40,639
files also people don't realize they are

216
00:09:40,639 --> 00:09:43,759
infected so a lot of the the some people

217
00:09:43,759 --> 00:09:45,139
will have the router infected but as

218
00:09:45,139 --> 00:09:46,939
long as their internet works fine they

219
00:09:46,939 --> 00:09:48,110
don't really care and they don't really

220
00:09:48,110 --> 00:09:49,910
know about it which is fine I mean I

221
00:09:49,910 --> 00:09:51,589
might be infected right now at home and

222
00:09:51,589 --> 00:09:53,689
I wouldn't know I would reboot my router

223
00:09:53,689 --> 00:09:56,029
and if the threat doesn't persist then I

224
00:09:56,029 --> 00:09:57,620
would be fine until I get reinfected

225
00:09:57,620 --> 00:10:01,189
something like that right so starting

226
00:10:01,189 --> 00:10:04,459
attacking the the problems as we said no

227
00:10:04,459 --> 00:10:08,630
UI no automated samples collection so

228
00:10:08,630 --> 00:10:10,930
what are there ways to collect samples

229
00:10:10,930 --> 00:10:14,959
well we could solder you our port on

230
00:10:14,959 --> 00:10:17,569
routers and then you know have a shell

231
00:10:17,569 --> 00:10:20,360
hopefully a debug or JTAG access and

232
00:10:20,360 --> 00:10:22,670
then you know look at the file system

233
00:10:22,670 --> 00:10:26,089
and look at files but obviously this

234
00:10:26,089 --> 00:10:27,470
doesn't scale right

235
00:10:27,470 --> 00:10:30,949
it requires hardware and you cannot you

236
00:10:30,949 --> 00:10:34,550
know make it everywhere and you you can

237
00:10:34,550 --> 00:10:36,290
do it at home I heard you like hobbies

238
00:10:36,290 --> 00:10:40,149
style also it doesn't work well on

239
00:10:40,149 --> 00:10:45,100
hardened devices so anything like that

240
00:10:45,100 --> 00:10:48,980
did dipped in epoxy it wouldn't work

241
00:10:48,980 --> 00:10:50,480
right because you would need to scratch

242
00:10:50,480 --> 00:10:52,399
it well some people like recon level

243
00:10:52,399 --> 00:10:54,079
people could do it but this is not

244
00:10:54,079 --> 00:10:55,610
something that would scale and would be

245
00:10:55,610 --> 00:10:58,250
easy to do so then again you what you

246
00:10:58,250 --> 00:11:00,500
can do is ask your friends for files

247
00:11:00,500 --> 00:11:01,699
like a you have

248
00:11:01,699 --> 00:11:04,369
a router can you look inside it but then

249
00:11:04,369 --> 00:11:06,709
they would need to do the soldering and

250
00:11:06,709 --> 00:11:11,149
all that stuff and then if it doesn't

251
00:11:11,149 --> 00:11:14,389
scale it did the same problem right so

252
00:11:14,389 --> 00:11:17,029
then there is finding a way in so if the

253
00:11:17,029 --> 00:11:20,629
malware gets in via telnet or SSH you

254
00:11:20,629 --> 00:11:23,929
can say hey why not me I can get in via

255
00:11:23,929 --> 00:11:25,999
telnet and ssh and i can even use their

256
00:11:25,999 --> 00:11:27,859
list as i have some of the lists that

257
00:11:27,859 --> 00:11:30,649
they used to get in use the default

258
00:11:30,649 --> 00:11:33,139
creds right but then you you reuse that

259
00:11:33,139 --> 00:11:35,859
path but you have the problem of

260
00:11:35,859 --> 00:11:38,359
connecting at the same privilege level

261
00:11:38,359 --> 00:11:39,139
of the Maur

262
00:11:39,139 --> 00:11:41,839
so for now it would work well right

263
00:11:41,839 --> 00:11:44,569
because they don't expect researchers to

264
00:11:44,569 --> 00:11:46,790
do that but in one year two years then

265
00:11:46,790 --> 00:11:48,769
what they could do is kill the official

266
00:11:48,769 --> 00:11:51,769
telnet client demon kill the official

267
00:11:51,769 --> 00:11:54,589
SSH daemon and then emulate one give you

268
00:11:54,589 --> 00:11:57,199
one where you would not see the file

269
00:11:57,199 --> 00:11:59,139
right they could do something like that

270
00:11:59,139 --> 00:12:01,999
but the real problem is it's illegal

271
00:12:01,999 --> 00:12:04,309
right I could be doing what the malware

272
00:12:04,309 --> 00:12:06,799
does and connect to everyone's routers

273
00:12:06,799 --> 00:12:09,709
that are exposed and badly protected but

274
00:12:09,709 --> 00:12:11,720
I would have liked blogging about it

275
00:12:11,720 --> 00:12:13,789
maybe I would get some like a are you

276
00:12:13,789 --> 00:12:16,639
sure doing this yeah yeah like making

277
00:12:16,639 --> 00:12:20,509
sure it's nothing kind of that yeah so

278
00:12:20,509 --> 00:12:21,470
I'm not doing it right

279
00:12:21,470 --> 00:12:24,319
I tried hunting on virus photos so right

280
00:12:24,319 --> 00:12:27,230
right wrote some arrow rules to match

281
00:12:27,230 --> 00:12:31,059
her arm and elf headers and MIPS

282
00:12:31,059 --> 00:12:34,519
architecture but then I was getting a

283
00:12:34,519 --> 00:12:37,279
lot of people a lot of the like LS and

284
00:12:37,279 --> 00:12:39,410
you reverse engineer aesthetically

285
00:12:39,410 --> 00:12:42,079
compiled LS and then you realize it's LS

286
00:12:42,079 --> 00:12:45,410
it's kind of shitty like you you put

287
00:12:45,410 --> 00:12:47,029
this on your timesheet and you're not

288
00:12:47,029 --> 00:12:50,449
proud of yourself right took me a day to

289
00:12:50,449 --> 00:12:54,949
figure out it's LS and so there's that

290
00:12:54,949 --> 00:12:57,799
and there's also a feedback loop problem

291
00:12:57,799 --> 00:12:59,869
it's like that there are samples that

292
00:12:59,869 --> 00:13:03,019
you've studied or you blog about people

293
00:13:03,019 --> 00:13:07,459
kind of some variants of it yet

294
00:13:07,459 --> 00:13:10,069
published so you kind of always study

295
00:13:10,069 --> 00:13:12,889
the same lizard squad and or Linux moves

296
00:13:12,889 --> 00:13:14,270
type stuff because you

297
00:13:14,270 --> 00:13:17,240
yeah rules are built to collect these so

298
00:13:17,240 --> 00:13:18,980
you're not finding the new and

299
00:13:18,980 --> 00:13:20,600
interesting stuff you're always looking

300
00:13:20,600 --> 00:13:22,550
at the same same things so what we

301
00:13:22,550 --> 00:13:24,740
decided to do is we decided okay we will

302
00:13:24,740 --> 00:13:27,050
do honey but no interaction and if

303
00:13:27,050 --> 00:13:28,820
that's because I'm too lazy to manage a

304
00:13:28,820 --> 00:13:32,209
high interaction one am I gonna have it

305
00:13:32,209 --> 00:13:35,600
mimic system that III want

306
00:13:35,600 --> 00:13:38,450
I know it's targeted so kind of going

307
00:13:38,450 --> 00:13:40,730
you know one up from what the bad guys

308
00:13:40,730 --> 00:13:43,640
are doing type of stuff problem is only

309
00:13:43,640 --> 00:13:47,060
put are complex so honeypot quickly is a

310
00:13:47,060 --> 00:13:48,800
system that there's attackers into

311
00:13:48,800 --> 00:13:50,390
showing how they operate so they give

312
00:13:50,390 --> 00:13:53,270
you those famous TTP so tools tactics

313
00:13:53,270 --> 00:13:56,750
and procedures and including files so if

314
00:13:56,750 --> 00:13:59,089
they copy files or whatever they do you

315
00:13:59,089 --> 00:14:01,399
you get so you pick components and

316
00:14:01,399 --> 00:14:03,320
architecture and you deploy it so what

317
00:14:03,320 --> 00:14:06,920
we kind of was our choice so we were

318
00:14:06,920 --> 00:14:08,839
clear that we would go low interaction

319
00:14:08,839 --> 00:14:10,550
because high interaction is dangerous

320
00:14:10,550 --> 00:14:13,070
quickly so low interaction meaning that

321
00:14:13,070 --> 00:14:15,230
they are in the matrix like they can Oh

322
00:14:15,230 --> 00:14:18,110
am i you know and then you can test it

323
00:14:18,110 --> 00:14:20,870
and you can't fake until you know you

324
00:14:20,870 --> 00:14:24,279
get the files and stuff but our real

325
00:14:24,279 --> 00:14:26,720
struggle was okay do we do hardware

326
00:14:26,720 --> 00:14:28,730
since we're going after IOT or do we do

327
00:14:28,730 --> 00:14:30,709
software and so here are what the

328
00:14:30,709 --> 00:14:33,020
choices or the things we had to think

329
00:14:33,020 --> 00:14:37,300
think about maintenance monitoring so

330
00:14:37,300 --> 00:14:40,510
hardware you you have important

331
00:14:40,510 --> 00:14:42,709
limitations you do you need to do your

332
00:14:42,709 --> 00:14:45,190
man in the middle in front you need to

333
00:14:45,190 --> 00:14:47,920
maintain and you need to buy this stuff

334
00:14:47,920 --> 00:14:52,000
so in step and and I wanted that

335
00:14:52,000 --> 00:14:54,980
research to be Geographic kind of

336
00:14:54,980 --> 00:14:56,899
expected that red actors to be different

337
00:14:56,899 --> 00:14:58,430
based on where you are

338
00:14:58,430 --> 00:15:00,890
so Brazil's malware assault on Windows

339
00:15:00,890 --> 00:15:03,339
has always been really different than

340
00:15:03,339 --> 00:15:05,540
you know the rest of the world or the

341
00:15:05,540 --> 00:15:07,520
Russian bankers and stuff like that so I

342
00:15:07,520 --> 00:15:09,920
kind of expected this from IOT Maur

343
00:15:09,920 --> 00:15:11,890
turns out it's not different

344
00:15:11,890 --> 00:15:15,709
unfortunately but I wanted that so for

345
00:15:15,709 --> 00:15:17,540
us hardware was not a good approach

346
00:15:17,540 --> 00:15:20,360
right I couldn't like I'm just go Sakura

347
00:15:20,360 --> 00:15:21,360
I'm not

348
00:15:21,360 --> 00:15:25,079
a fortune 500 so I can have ship routers

349
00:15:25,079 --> 00:15:27,420
around and say hey plug this and you

350
00:15:27,420 --> 00:15:29,459
know run this man-in-the-middle thing in

351
00:15:29,459 --> 00:15:31,019
front and send me the pcaps

352
00:15:31,019 --> 00:15:34,440
and so we decided to go software

353
00:15:34,440 --> 00:15:37,440
based instead software is slower but

354
00:15:37,440 --> 00:15:39,329
doesn't really matter and even slower

355
00:15:39,329 --> 00:15:41,850
means more realistic in the IOT sense

356
00:15:41,850 --> 00:15:43,860
right but it can be fingerprinted so you

357
00:15:43,860 --> 00:15:46,740
really need to do the this kind of ok

358
00:15:46,740 --> 00:15:49,079
they connected but they didn't drop a

359
00:15:49,079 --> 00:15:51,750
binary what happen and then at that

360
00:15:51,750 --> 00:15:56,459
based on it for some malware turns out

361
00:15:56,459 --> 00:15:59,279
that the problem is they they don't even

362
00:15:59,279 --> 00:16:01,709
implement the protocol really well so if

363
00:16:01,709 --> 00:16:05,550
for linux moves if i would give proper

364
00:16:05,550 --> 00:16:07,649
telnet handshake they would disconnect

365
00:16:07,649 --> 00:16:09,360
they would draw because they didn't

366
00:16:09,360 --> 00:16:11,130
understand the meta character of telnet

367
00:16:11,130 --> 00:16:13,470
and so what I turned out doing his

368
00:16:13,470 --> 00:16:15,390
patching the the code so that it

369
00:16:15,390 --> 00:16:18,360
wouldn't send stuff just for this but

370
00:16:18,360 --> 00:16:20,399
net to get to you know infected by them

371
00:16:20,399 --> 00:16:25,709
it's kind of weird yeah in a sense so we

372
00:16:25,709 --> 00:16:27,570
went with the low interaction software

373
00:16:27,570 --> 00:16:29,880
base and it but which we deployed in the

374
00:16:29,880 --> 00:16:35,579
cloud some providers we had fun with at

375
00:16:35,579 --> 00:16:38,430
some places I ran a TCP dump and I got

376
00:16:38,430 --> 00:16:40,199
the traffic of everyone on the same

377
00:16:40,199 --> 00:16:43,320
physical server than me I was like I'm

378
00:16:43,320 --> 00:16:44,699
not sure that this is supposed to happen

379
00:16:44,699 --> 00:16:47,070
that's always something cool to do you

380
00:16:47,070 --> 00:16:48,899
know to do and realize when you deploy

381
00:16:48,899 --> 00:16:52,500
these type of stuff so the RO

382
00:16:52,500 --> 00:16:55,199
interaction another key thing is you're

383
00:16:55,199 --> 00:16:56,550
less likely to become part of the

384
00:16:56,550 --> 00:16:58,350
problem so spreading an infection

385
00:16:58,350 --> 00:17:01,709
sending email detailing other targets so

386
00:17:01,709 --> 00:17:03,779
for us it was a it was a better view

387
00:17:03,779 --> 00:17:06,630
right this is the architecture we came

388
00:17:06,630 --> 00:17:09,359
up with this is for the specific Linux

389
00:17:09,359 --> 00:17:12,809
moves that I talked about two years ago

390
00:17:12,809 --> 00:17:16,109
here and among other threats what we

391
00:17:16,109 --> 00:17:18,059
wanted to do is to run the actual sample

392
00:17:18,059 --> 00:17:21,839
so on one side we have a qnu arm with

393
00:17:21,839 --> 00:17:23,939
the sample on it but on the other side

394
00:17:23,939 --> 00:17:25,819
we have our low interaction Ani but

395
00:17:25,819 --> 00:17:29,280
which is the one getting connections and

396
00:17:29,280 --> 00:17:32,220
getting file transfers and stuff so on

397
00:17:32,220 --> 00:17:34,520
the the left hand side is

398
00:17:34,520 --> 00:17:38,630
qmu right hand side is there are Perry

399
00:17:38,630 --> 00:17:40,640
so we use carry for honeypot which is a

400
00:17:40,640 --> 00:17:41,570
SSH

401
00:17:41,570 --> 00:17:46,520
now telnet honeypot I'm for this

402
00:17:46,520 --> 00:17:49,580
specific case I needed to do HTTP and

403
00:17:49,580 --> 00:17:51,590
reception and decryption and I used

404
00:17:51,590 --> 00:17:53,210
man-in-the-middle proxy to do that and

405
00:17:53,210 --> 00:17:55,520
firewall rules to redirect that the

406
00:17:55,520 --> 00:17:58,760
right place and use bump cap in front in

407
00:17:58,760 --> 00:18:00,890
front of that to capture everything

408
00:18:00,890 --> 00:18:03,080
because you know collecting back at

409
00:18:03,080 --> 00:18:09,560
Cisco I named almost all of it for qmu I

410
00:18:09,560 --> 00:18:12,110
used the Debian images since we were

411
00:18:12,110 --> 00:18:13,970
only running samples and not getting

412
00:18:13,970 --> 00:18:16,220
actual connections the fingerprinting

413
00:18:16,220 --> 00:18:18,350
resistance was not that important for me

414
00:18:18,350 --> 00:18:21,620
and it worked pretty well right and I

415
00:18:21,620 --> 00:18:24,140
had gdb I had like you know a full Linux

416
00:18:24,140 --> 00:18:26,240
so I could do the debug the samples and

417
00:18:26,240 --> 00:18:30,680
stuff like that curry I liked as it's

418
00:18:30,680 --> 00:18:32,690
written in Python wasted so it's really

419
00:18:32,690 --> 00:18:36,440
easy to modify you can modify output of

420
00:18:36,440 --> 00:18:39,110
commands you can the lecturer is kind of

421
00:18:39,110 --> 00:18:41,210
simple the the things that interprets

422
00:18:41,210 --> 00:18:45,200
the command line so it's good but there

423
00:18:45,200 --> 00:18:47,030
was no telnet support at the time that I

424
00:18:47,030 --> 00:18:49,640
needed telnet support so what we did is

425
00:18:49,640 --> 00:18:51,830
we sent a pull request I implemented

426
00:18:51,830 --> 00:18:53,750
then I thought it would be like I said

427
00:18:53,750 --> 00:18:55,700
like Oh everything is so well done you

428
00:18:55,700 --> 00:18:58,880
know with heritage and stuff I just need

429
00:18:58,880 --> 00:19:00,950
to plug this thing at this layer and it

430
00:19:00,950 --> 00:19:03,200
will be alright and so it will be I

431
00:19:03,200 --> 00:19:05,210
don't know like two days of coding

432
00:19:05,210 --> 00:19:08,510
turned out it took me four weeks but I'm

433
00:19:08,510 --> 00:19:11,500
glad I did it so I sent the pull request

434
00:19:11,500 --> 00:19:15,320
last summer and this is just before me

435
00:19:15,320 --> 00:19:17,330
rice so this is when you feel kind of

436
00:19:17,330 --> 00:19:20,300
cool I contributed to everyone tracking

437
00:19:20,300 --> 00:19:22,010
Mariah Kazmir I was track heavily

438
00:19:22,010 --> 00:19:25,880
through curry but at the same time I was

439
00:19:25,880 --> 00:19:28,160
not the one tracking Mirai so I kind of

440
00:19:28,160 --> 00:19:31,130
missed the opportunity to I guess get

441
00:19:31,130 --> 00:19:34,940
some views on our blog or something like

442
00:19:34,940 --> 00:19:37,520
that but yeah I did the code instead

443
00:19:37,520 --> 00:19:39,490
[Laughter]

444
00:19:39,490 --> 00:19:41,710
poor man in the middle I use men the

445
00:19:41,710 --> 00:19:43,990
middle proxy I tried better cap which is

446
00:19:43,990 --> 00:19:46,409
a very good pen testing tool I think and

447
00:19:46,409 --> 00:19:48,880
also does the iptables for you

448
00:19:48,880 --> 00:19:51,370
so some four four people in pen test

449
00:19:51,370 --> 00:19:53,049
engagement I think better cap is more

450
00:19:53,049 --> 00:19:55,600
turnkey tools but mellow proxy better

451
00:19:55,600 --> 00:19:57,100
cap doesn't have any binary level

452
00:19:57,100 --> 00:20:00,010
logging so you cannot go back you only

453
00:20:00,010 --> 00:20:02,230
have the output in the terminal

454
00:20:02,230 --> 00:20:04,809
my name bill proxy has a log that is

455
00:20:04,809 --> 00:20:07,750
binary safe logs a lot of metadata and

456
00:20:07,750 --> 00:20:10,419
has been stable no crashes while better

457
00:20:10,419 --> 00:20:12,940
cap I had crashes but you need to do the

458
00:20:12,940 --> 00:20:15,549
IP tables as I said but the library is

459
00:20:15,549 --> 00:20:18,039
really high level a very you know well

460
00:20:18,039 --> 00:20:20,190
done well-designed tool I recommend it

461
00:20:20,190 --> 00:20:22,659
forget packet capture I prefer to use

462
00:20:22,659 --> 00:20:26,620
dump cap over TCP dump and I recommend

463
00:20:26,620 --> 00:20:28,270
people doing automatic rotation because

464
00:20:28,270 --> 00:20:30,399
the the whenever you do some TCP

465
00:20:30,399 --> 00:20:32,559
analysis you need to reconstruct the

466
00:20:32,559 --> 00:20:34,450
whole you know flow and it will go

467
00:20:34,450 --> 00:20:36,880
through the whole pcap and so if you

468
00:20:36,880 --> 00:20:39,370
have really really large pea caps last

469
00:20:39,370 --> 00:20:41,649
thing you know weeks it just doesn't

470
00:20:41,649 --> 00:20:43,720
scale if you do daily rotation you can

471
00:20:43,720 --> 00:20:50,260
then class agnew parallel some

472
00:20:50,260 --> 00:20:52,929
parallelization tools to process them

473
00:20:52,929 --> 00:20:55,870
you know a one for at a time so it

474
00:20:55,870 --> 00:20:58,419
really scales better don't forget to

475
00:20:58,419 --> 00:21:01,059
what I recommend anyway and you can do

476
00:21:01,059 --> 00:21:02,470
what you want but this is experience

477
00:21:02,470 --> 00:21:04,320
that's why I'm here right

478
00:21:04,320 --> 00:21:07,360
put your SSH on another port like really

479
00:21:07,360 --> 00:21:10,539
bastard port and then filter it out so

480
00:21:10,539 --> 00:21:12,070
that when you are saying or when you

481
00:21:12,070 --> 00:21:13,870
download your stuff it doesn't like you

482
00:21:13,870 --> 00:21:15,909
know make the ball the pcap bigger

483
00:21:15,909 --> 00:21:17,710
because the transfers are in the PK but

484
00:21:17,710 --> 00:21:19,539
then you transfer that it happened and

485
00:21:19,539 --> 00:21:24,760
stuff so yeah I avoid that the full

486
00:21:24,760 --> 00:21:26,289
packet capture also is interesting

487
00:21:26,289 --> 00:21:28,419
because sometimes people will release

488
00:21:28,419 --> 00:21:30,850
some research and then you like ah nice

489
00:21:30,850 --> 00:21:33,070
I have a full packet capture and I can

490
00:21:33,070 --> 00:21:35,770
you know reproduce that research one

491
00:21:35,770 --> 00:21:37,539
thing that the people at what comes did

492
00:21:37,539 --> 00:21:42,250
the Kehoe team is they they deployed

493
00:21:42,250 --> 00:21:45,580
several honey pots they collected the so

494
00:21:45,580 --> 00:21:46,929
when you do any dust you spoof the

495
00:21:46,929 --> 00:21:49,120
source you know if it's a UDP base the

496
00:21:49,120 --> 00:21:51,880
leaders and so they collected

497
00:21:51,880 --> 00:21:54,760
the replies of the server where this the

498
00:21:54,760 --> 00:21:56,980
source was poof and they correlated that

499
00:21:56,980 --> 00:21:59,800
with like the sequence numbers and

500
00:21:59,800 --> 00:22:00,970
windows size and stuff

501
00:22:00,970 --> 00:22:03,430
and the the Catholic they classified but

502
00:22:03,430 --> 00:22:06,220
not based on that information which is

503
00:22:06,220 --> 00:22:08,440
like really really geeky and technical

504
00:22:08,440 --> 00:22:10,660
and I was really I didn't do it

505
00:22:10,660 --> 00:22:13,510
unfortunately yet but the fact that I

506
00:22:13,510 --> 00:22:15,250
have full packet capture I can reproduce

507
00:22:15,250 --> 00:22:17,560
that research if I want so this is why

508
00:22:17,560 --> 00:22:20,260
you more data is always better than less

509
00:22:20,260 --> 00:22:23,050
data right so the reverse engineering

510
00:22:23,050 --> 00:22:25,300
problems that we have the biggest

511
00:22:25,300 --> 00:22:28,210
problem is everything is well everything

512
00:22:28,210 --> 00:22:31,300
well done is statically linked and strip

513
00:22:31,300 --> 00:22:34,240
so statically linked means that the

514
00:22:34,240 --> 00:22:36,490
libraries are in line this includes the

515
00:22:36,490 --> 00:22:40,330
the C library so you go it really blows

516
00:22:40,330 --> 00:22:43,150
up the amount of code and the complexity

517
00:22:43,150 --> 00:22:45,250
that you have to look at and strip means

518
00:22:45,250 --> 00:22:47,260
no debugging symbols so you don't have

519
00:22:47,260 --> 00:22:50,860
the the names of the variables and stuff

520
00:22:50,860 --> 00:22:54,460
like that that kind of metadata so all

521
00:22:54,460 --> 00:22:56,730
of the code is bundled together up to

522
00:22:56,730 --> 00:23:02,230
down to the cisco's right so it's a lot

523
00:23:02,230 --> 00:23:04,840
of stuff to reverse engineer but just to

524
00:23:04,840 --> 00:23:07,870
give you a sense this is a linux moves

525
00:23:07,870 --> 00:23:12,250
binary so what I highlighted at the

526
00:23:12,250 --> 00:23:15,490
bottom is so what we've seen is a few of

527
00:23:15,490 --> 00:23:17,470
the functions and there are five

528
00:23:17,470 --> 00:23:20,310
hundreds of them so these are all

529
00:23:20,310 --> 00:23:23,500
unidentified unknown code that you need

530
00:23:23,500 --> 00:23:25,780
to look at five hundred functions and

531
00:23:25,780 --> 00:23:28,870
you start to do some analysis now I've

532
00:23:28,870 --> 00:23:31,810
put in the we don't see that well right

533
00:23:31,810 --> 00:23:33,880
anyway it's just to show that it's

534
00:23:33,880 --> 00:23:37,180
complex so I guess I guess this is good

535
00:23:37,180 --> 00:23:40,960
that you don't see anything but okay so

536
00:23:40,960 --> 00:23:42,880
this is the printf family of cows and

537
00:23:42,880 --> 00:23:46,960
you have like s printf and printf and v

538
00:23:46,960 --> 00:23:49,660
printf calling underscore vs printf

539
00:23:49,660 --> 00:23:53,140
intorno there are the names here because

540
00:23:53,140 --> 00:23:55,480
this is the library with a symbol that i

541
00:23:55,480 --> 00:23:58,030
compiled but it wasn't malware I did a

542
00:23:58,030 --> 00:24:03,820
reverse thoroughly this thing and so

543
00:24:03,820 --> 00:24:05,890
this is the broader family of

544
00:24:05,890 --> 00:24:08,650
around the printf the skull and the the

545
00:24:08,650 --> 00:24:11,559
printf family of calls and the only

546
00:24:11,559 --> 00:24:14,230
sister and all of this is puts puts is

547
00:24:14,230 --> 00:24:16,780
to print on a terminal on Linux this is

548
00:24:16,780 --> 00:24:19,660
the put Cisco so you go really like

549
00:24:19,660 --> 00:24:22,870
there is a lot of dependencies a lot of

550
00:24:22,870 --> 00:24:24,520
stuff calling each other a lot of code

551
00:24:24,520 --> 00:24:26,920
we use and then you're like okay okay I

552
00:24:26,920 --> 00:24:29,140
need to drill into a function and this

553
00:24:29,140 --> 00:24:32,980
is the VF printf internal function so

554
00:24:32,980 --> 00:24:37,750
all of that code you need to look at and

555
00:24:37,750 --> 00:24:40,419
everything like every block is you know

556
00:24:40,419 --> 00:24:42,460
several lines of assembly and you need

557
00:24:42,460 --> 00:24:44,559
to figure all of that out to understand

558
00:24:44,559 --> 00:24:49,059
and in the end you're like I spent two

559
00:24:49,059 --> 00:24:54,220
days this is only printf right and then

560
00:24:54,220 --> 00:24:56,830
you you feel bad and you you like yeah

561
00:24:56,830 --> 00:25:01,179
you're like employment the ecosystem on

562
00:25:01,179 --> 00:25:03,370
Linux specifically and this is why it's

563
00:25:03,370 --> 00:25:05,860
a specific problem to that area makes it

564
00:25:05,860 --> 00:25:08,500
worse for your Sinjin ears because GCC

565
00:25:08,500 --> 00:25:10,120
changes version all the time

566
00:25:10,120 --> 00:25:12,400
they optimize and a tweak and it changed

567
00:25:12,400 --> 00:25:14,380
the way that they did generate assembly

568
00:25:14,380 --> 00:25:18,549
Lipsy are changing there is no or little

569
00:25:18,549 --> 00:25:21,360
either flirt signature some of the major

570
00:25:21,360 --> 00:25:24,400
you know this rose the desktop Linux

571
00:25:24,400 --> 00:25:26,350
will have some flirt signatures but

572
00:25:26,350 --> 00:25:28,690
other the embedded stuff I never seen

573
00:25:28,690 --> 00:25:31,299
one match and there are various C

574
00:25:31,299 --> 00:25:33,280
libraries like you see lip see each

575
00:25:33,280 --> 00:25:36,660
ative see muscles and stuff like that

576
00:25:36,660 --> 00:25:39,610
so it's really an ecosystem hard when

577
00:25:39,610 --> 00:25:40,900
you look at it from a reverse

578
00:25:40,900 --> 00:25:44,260
engineering standpoint what we did and

579
00:25:44,260 --> 00:25:46,299
failed at it is to try to match the

580
00:25:46,299 --> 00:25:48,669
scores with an Ida script so I extracted

581
00:25:48,669 --> 00:25:50,020
all this is called numbers from the

582
00:25:50,020 --> 00:25:52,780
kernel source code I wrote you know

583
00:25:52,780 --> 00:25:55,419
Python array and a thing wrote the Ida

584
00:25:55,419 --> 00:25:58,360
Python script would add and in a comment

585
00:25:58,360 --> 00:26:00,820
like oh this is girl is this cow but

586
00:26:00,820 --> 00:26:02,890
again the Lib C is so big and the stuff

587
00:26:02,890 --> 00:26:05,290
is so high level that you spend a lot of

588
00:26:05,290 --> 00:26:07,059
time and there is too much code to

589
00:26:07,059 --> 00:26:10,120
reverse engineer Mac it's Ian one of a

590
00:26:10,120 --> 00:26:12,540
former colleague of mine I had an idea

591
00:26:12,540 --> 00:26:16,730
he said why don't you build the

592
00:26:16,730 --> 00:26:19,490
the lightness e-library with some balls

593
00:26:19,490 --> 00:26:22,520
and then use bins if to import that

594
00:26:22,520 --> 00:26:25,010
stuff and do either I was like you know

595
00:26:25,010 --> 00:26:27,290
what it can work maybe so

596
00:26:27,290 --> 00:26:29,870
then we can focus on my work oh and this

597
00:26:29,870 --> 00:26:32,300
is what happened so this is a bins of

598
00:26:32,300 --> 00:26:35,150
output on the left-hand side that this

599
00:26:35,150 --> 00:26:38,030
column here is the name of the sample

600
00:26:38,030 --> 00:26:41,270
I was reverse engineering and here is

601
00:26:41,270 --> 00:26:43,940
the Lib C I compile and don't tell that

602
00:26:43,940 --> 00:26:46,550
to them our guys but the reason I was

603
00:26:46,550 --> 00:26:48,680
able to compile the exact same thing is

604
00:26:48,680 --> 00:26:50,750
because they left it in the source in

605
00:26:50,750 --> 00:26:52,780
the code it was like GCC version

606
00:26:52,780 --> 00:26:57,410
something open wrt toolchain revision of

607
00:26:57,410 --> 00:27:00,830
the open wrt check out from SVM so i was

608
00:27:00,830 --> 00:27:04,010
able to SVN check out exactly the same

609
00:27:04,010 --> 00:27:06,200
pack compile everything but don't don't

610
00:27:06,200 --> 00:27:07,700
don't tell it to them because they were

611
00:27:07,700 --> 00:27:09,350
strip it right and then I will have to

612
00:27:09,350 --> 00:27:13,370
 guess I'll be complicated so

613
00:27:13,370 --> 00:27:17,180
because of that I had 99% confidence 99%

614
00:27:17,180 --> 00:27:19,820
similarity and I was able to import STR

615
00:27:19,820 --> 00:27:21,800
and copy F gets and all of that stuff

616
00:27:21,800 --> 00:27:23,870
and then the malware was malware it was

617
00:27:23,870 --> 00:27:28,160
no longer the C library more than 225

618
00:27:28,160 --> 00:27:29,600
function were mapped with high

619
00:27:29,600 --> 00:27:32,720
confidence high similarity turned out it

620
00:27:32,720 --> 00:27:35,240
was you psyllium seed zero point nine

621
00:27:35,240 --> 00:27:38,960
point three three from the open W to to

622
00:27:38,960 --> 00:27:41,020
train and this is again a Linux mousse

623
00:27:41,020 --> 00:27:44,960
sample the other problems is

624
00:27:44,960 --> 00:27:47,900
architecture storage so NVRAM you need

625
00:27:47,900 --> 00:27:49,910
to simulate that I know there was a

626
00:27:49,910 --> 00:27:53,650
training this week about attacking

627
00:27:53,650 --> 00:27:56,270
embedded devices and I think that they

628
00:27:56,270 --> 00:27:57,830
cover some of the stuff that I even

629
00:27:57,830 --> 00:27:58,910
haven't done yet

630
00:27:58,910 --> 00:28:01,100
like emulating and me RAM and making

631
00:28:01,100 --> 00:28:02,600
sure you can damage either bug stuff

632
00:28:02,600 --> 00:28:05,240
like that I would love to actually get

633
00:28:05,240 --> 00:28:10,820
more knowledge on that with I did most

634
00:28:10,820 --> 00:28:13,340
of the stuff statically because of the

635
00:28:13,340 --> 00:28:15,800
complexity of running it or doing it

636
00:28:15,800 --> 00:28:18,800
dynamically but now they started doing

637
00:28:18,800 --> 00:28:21,230
some packing before I never saw packed

638
00:28:21,230 --> 00:28:23,570
samples and now they they have packed

639
00:28:23,570 --> 00:28:25,820
samples so I need to a handle this these

640
00:28:25,820 --> 00:28:29,060
problems eventually now that we have a

641
00:28:29,060 --> 00:28:29,870
botnet that

642
00:28:29,870 --> 00:28:31,880
runs an hour you know honey pot and

643
00:28:31,880 --> 00:28:34,670
stuff we a new problem is that analysis

644
00:28:34,670 --> 00:28:35,930
so we have pcaps

645
00:28:35,930 --> 00:28:37,730
we have loves we collected them for

646
00:28:37,730 --> 00:28:39,890
months with you know done some of the

647
00:28:39,890 --> 00:28:42,110
talks we forgot then we are sink

648
00:28:42,110 --> 00:28:43,820
everything and we look at it it's

649
00:28:43,820 --> 00:28:46,640
distributed so several servers so what

650
00:28:46,640 --> 00:28:49,760
we started doing is using a centralized

651
00:28:49,760 --> 00:28:52,010
the single server where we pulled all

652
00:28:52,010 --> 00:28:55,570
the files I want my honey pots to be

653
00:28:55,570 --> 00:28:59,030
deniable like none reputable to our

654
00:28:59,030 --> 00:29:01,160
organization so that if someone gains

655
00:29:01,160 --> 00:29:03,230
gains access to it that they are not

656
00:29:03,230 --> 00:29:05,960
near they are not linked to us so this

657
00:29:05,960 --> 00:29:08,750
is why I use this pool versus push model

658
00:29:08,750 --> 00:29:11,740
right I always pull from the honey pots

659
00:29:11,740 --> 00:29:15,950
we use ipython notebook as a an IDE that

660
00:29:15,950 --> 00:29:17,630
we run on the server the server has a

661
00:29:17,630 --> 00:29:19,730
lot of coral of RAM so it's better than

662
00:29:19,730 --> 00:29:22,480
you know doing it on the on our desktops

663
00:29:22,480 --> 00:29:26,179
we like with the gas we generate CSV

664
00:29:26,179 --> 00:29:28,040
files with the binary data in it we

665
00:29:28,040 --> 00:29:31,670
process it with Python and CSV reader

666
00:29:31,670 --> 00:29:35,210
from Python is like I think a thousand

667
00:29:35,210 --> 00:29:37,760
times lower than the CSV reader from

668
00:29:37,760 --> 00:29:38,450
panda

669
00:29:38,450 --> 00:29:40,850
so panda is really good library if you

670
00:29:40,850 --> 00:29:43,690
want to do those large-scale analysis

671
00:29:43,690 --> 00:29:45,380
paralyze

672
00:29:45,380 --> 00:29:48,950
CPU or i/o bound tasks with new parallel

673
00:29:48,950 --> 00:29:51,200
if you haven't played with new parallel

674
00:29:51,200 --> 00:29:53,720
you should it's amazing and it's a

675
00:29:53,720 --> 00:29:57,050
drop-in replacement of X arts so any

676
00:29:57,050 --> 00:29:59,450
workload that you throw X arts at you

677
00:29:59,450 --> 00:30:01,640
throw at new parallel and it will

678
00:30:01,640 --> 00:30:04,100
maximize the amount of course that are

679
00:30:04,100 --> 00:30:06,710
used I like it we'll see oh there are 12

680
00:30:06,710 --> 00:30:11,030
CPU cores I will run 12 jobs one besides

681
00:30:11,030 --> 00:30:13,429
each other it can do memory monitoring

682
00:30:13,429 --> 00:30:15,830
it can tilt asked we reschedule tasks

683
00:30:15,830 --> 00:30:17,960
that were killed and stuff an amazing

684
00:30:17,960 --> 00:30:21,740
tool we and then use specific tools for

685
00:30:21,740 --> 00:30:24,410
specific problems right tea sharks for

686
00:30:24,410 --> 00:30:27,440
pcap you know explore in Wireshark and

687
00:30:27,440 --> 00:30:31,160
then script with the shark and the MIT M

688
00:30:31,160 --> 00:30:33,020
proxy has been a really really fun

689
00:30:33,020 --> 00:30:36,350
library to play with too for HTTP data

690
00:30:36,350 --> 00:30:40,280
to analyze also so now it's storytime

691
00:30:40,280 --> 00:30:42,590
let's go through our cases that we

692
00:30:42,590 --> 00:30:46,730
we've analyzed these our squad so I

693
00:30:46,730 --> 00:30:48,950
spoke about this or squad I think here

694
00:30:48,950 --> 00:30:51,590
two years ago but so you can take a nap

695
00:30:51,590 --> 00:30:55,669
during this if you've seen that out so

696
00:30:55,669 --> 00:30:58,909
this square is actually gas yet the the

697
00:30:58,909 --> 00:31:00,980
sample and the source code was leaked so

698
00:31:00,980 --> 00:31:05,120
it's everything now Kaitlynn hydra reek

699
00:31:05,120 --> 00:31:08,240
eight and yeah it is a misnomer because

700
00:31:08,240 --> 00:31:10,610
the real string and the malware was gay

701
00:31:10,610 --> 00:31:13,279
 but the industry didn't find it was

702
00:31:13,279 --> 00:31:15,380
a cool name to give a signature name so

703
00:31:15,380 --> 00:31:21,620
they they said yes get instead the

704
00:31:21,620 --> 00:31:25,130
malware people are so offensive not

705
00:31:25,130 --> 00:31:27,700
they're not inclusive at all

706
00:31:27,700 --> 00:31:32,750
so this squad twitter images it's a

707
00:31:32,750 --> 00:31:34,520
black hat a hacking group they do it

708
00:31:34,520 --> 00:31:37,130
they were big in the ddos scene they

709
00:31:37,130 --> 00:31:39,200
were the ones who'd be the PlayStation

710
00:31:39,200 --> 00:31:43,700
Network and Xbox Live in Christmas 2014

711
00:31:43,700 --> 00:31:46,429
on Christmas Day like everyone's

712
00:31:46,429 --> 00:31:53,029
every kid's dream they got I don't know

713
00:31:53,029 --> 00:31:54,620
if everyone knows this but when I found

714
00:31:54,620 --> 00:31:56,720
out I found it funny so I tell that

715
00:31:56,720 --> 00:31:58,789
story all the time but they what got

716
00:31:58,789 --> 00:32:00,679
them into trouble like neither saying I

717
00:32:00,679 --> 00:32:03,080
mean it was bad but no the law

718
00:32:03,080 --> 00:32:05,000
enforcement were not really after them

719
00:32:05,000 --> 00:32:07,130
or I mean they like if they would like

720
00:32:07,130 --> 00:32:09,409
fell on a silver plate in front of them

721
00:32:09,409 --> 00:32:11,000
they would have you know handcuffed them

722
00:32:11,000 --> 00:32:12,740
and stuff but they were not actively

723
00:32:12,740 --> 00:32:14,620
after them but what happened is that

724
00:32:14,620 --> 00:32:17,299
they started doing bomb threats so one

725
00:32:17,299 --> 00:32:19,309
of the the threats they did is they

726
00:32:19,309 --> 00:32:21,740
called the American Airlines and they

727
00:32:21,740 --> 00:32:25,220
said the vice president of Sony in

728
00:32:25,220 --> 00:32:28,399
charge of the gaming group has a bomb in

729
00:32:28,399 --> 00:32:31,580
his luggage he's on this plane and stuff

730
00:32:31,580 --> 00:32:33,320
because the guy tweeted that he was

731
00:32:33,320 --> 00:32:35,779
traveling for work whatever anyway so

732
00:32:35,779 --> 00:32:37,760
they took down the plane that like the

733
00:32:37,760 --> 00:32:41,539
force landed the plane to hunt his stuff

734
00:32:41,539 --> 00:32:43,429
and everything and he was like like

735
00:32:43,429 --> 00:32:45,950
treated like a terrorist and it was all

736
00:32:45,950 --> 00:32:48,529
a prank done by the lizard squad people

737
00:32:48,529 --> 00:32:51,230
so this got them into trouble the FBI

738
00:32:51,230 --> 00:32:54,590
looked like a fool and the Sony guy sued

739
00:32:54,590 --> 00:32:56,090
the FBI for having

740
00:32:56,090 --> 00:32:58,460
him look like a fool so a big

741
00:32:58,460 --> 00:33:04,010
 in in 2016 dig seven or

742
00:33:04,010 --> 00:33:05,630
eight six seven or eight of them were

743
00:33:05,630 --> 00:33:07,850
arrested because of the follow-up of

744
00:33:07,850 --> 00:33:10,070
what happened with the bomb threats and

745
00:33:10,070 --> 00:33:12,200
stuff and they were all running adidas

746
00:33:12,200 --> 00:33:14,090
for hire service called litter stressor

747
00:33:14,090 --> 00:33:16,760
so you could like you know sign up and

748
00:33:16,760 --> 00:33:19,190
then you know have you pay some money to

749
00:33:19,190 --> 00:33:21,830
get some people D dust and when you play

750
00:33:21,830 --> 00:33:24,200
video games I think it's a cool service

751
00:33:24,200 --> 00:33:25,880
because you know when you're losing you

752
00:33:25,880 --> 00:33:28,070
can just disconnect the other guy and

753
00:33:28,070 --> 00:33:29,600
then I don't know I guess you get half

754
00:33:29,600 --> 00:33:31,520
that points or something it's been a

755
00:33:31,520 --> 00:33:34,580
while since I have games so in a

756
00:33:34,580 --> 00:33:37,220
nutshell they are cyber rascals or as I

757
00:33:37,220 --> 00:33:46,420
would say in tibia DC Basra Napa I

758
00:33:46,420 --> 00:33:51,920
[Applause]

759
00:33:52,059 --> 00:33:57,529
talked I said three years ago here so a

760
00:33:57,529 --> 00:33:59,510
krebs even acknowledged that lizard

761
00:33:59,510 --> 00:34:01,659
stressor were running on hack or routers

762
00:34:01,659 --> 00:34:04,549
so it's pretty clear and even then I

763
00:34:04,549 --> 00:34:06,950
have a something coming up a screenshot

764
00:34:06,950 --> 00:34:09,679
of like them acknowledging that it's

765
00:34:09,679 --> 00:34:11,449
running on embedded systems but then

766
00:34:11,449 --> 00:34:13,310
malware as I said Catherine I grow up

767
00:34:13,310 --> 00:34:15,230
out but it's everything because the

768
00:34:15,230 --> 00:34:16,820
source code was leaked and so there's

769
00:34:16,820 --> 00:34:18,949
various Forks and it's still active even

770
00:34:18,949 --> 00:34:20,480
though some people were put in jail

771
00:34:20,480 --> 00:34:22,460
right now it's still a very active

772
00:34:22,460 --> 00:34:25,760
threat it has an illness scanner it

773
00:34:25,760 --> 00:34:28,639
floods your various methods and I found

774
00:34:28,639 --> 00:34:31,790
one sample that had a quake 3 flooding

775
00:34:31,790 --> 00:34:33,889
mechanism so you would send a message to

776
00:34:33,889 --> 00:34:35,690
a quake 3 server and the reply would be

777
00:34:35,690 --> 00:34:37,460
large so an amplification attack and

778
00:34:37,460 --> 00:34:41,000
they would support that they run on

779
00:34:41,000 --> 00:34:45,168
super H which is like wet runs on super

780
00:34:45,168 --> 00:34:48,139
H and this is like the the kids like

781
00:34:48,139 --> 00:34:51,139
Yolo like GCC support super H will have

782
00:34:51,139 --> 00:34:53,839
super H samples right I'm sure they have

783
00:34:53,839 --> 00:34:57,640
no victim but I guess they do super H

784
00:34:57,640 --> 00:35:00,650
this is in the server source code so

785
00:35:00,650 --> 00:35:02,450
they have this like now with

786
00:35:02,450 --> 00:35:05,300
refrigerators support kind of bragging

787
00:35:05,300 --> 00:35:07,480
so they knew what they were doing right

788
00:35:07,480 --> 00:35:08,670
there

789
00:35:08,670 --> 00:35:10,349
actors it's mostly credential

790
00:35:10,349 --> 00:35:12,720
brute-forcing ssh telnet but they do

791
00:35:12,720 --> 00:35:15,089
have a shell shock shell shock looks

792
00:35:15,089 --> 00:35:17,549
like this the classic you know empty

793
00:35:17,549 --> 00:35:20,700
function and then W get and the W get

794
00:35:20,700 --> 00:35:23,750
strip just downloads every architecture

795
00:35:23,750 --> 00:35:27,299
mud and make it executable and then try

796
00:35:27,299 --> 00:35:29,730
to run it see it's a really you know a

797
00:35:29,730 --> 00:35:32,760
big hammer approach like I will try

798
00:35:32,760 --> 00:35:35,400
everything and we'll see what sticks and

799
00:35:35,400 --> 00:35:36,450
it's good because you get to

800
00:35:36,450 --> 00:35:37,920
reverse-engineer the architecture that

801
00:35:37,920 --> 00:35:40,740
you're more familiar with ah you have an

802
00:35:40,740 --> 00:35:43,710
x86 version that's kind of you because I

803
00:35:43,710 --> 00:35:45,690
have other Ida Pro with the Exodus if

804
00:35:45,690 --> 00:35:50,700
the compiler thank you they they have

805
00:35:50,700 --> 00:35:53,220
variants that supports HTTP and there is

806
00:35:53,220 --> 00:35:55,650
also a CloudFlare protection bypass and

807
00:35:55,650 --> 00:35:57,720
one of the samples I found this is what

808
00:35:57,720 --> 00:35:58,470
it looks like

809
00:35:58,470 --> 00:36:01,260
so the fingerprint the the server to see

810
00:36:01,260 --> 00:36:03,270
if it's the CloudFlare Ingenix and then

811
00:36:03,270 --> 00:36:05,849
they implemented in c something that

812
00:36:05,849 --> 00:36:08,010
will resolve the JavaScript challenge

813
00:36:08,010 --> 00:36:10,470
that the CloudFlare platform uses so

814
00:36:10,470 --> 00:36:13,440
they did they assemble the various bits

815
00:36:13,440 --> 00:36:15,480
of the CloudFlare challenge and then

816
00:36:15,480 --> 00:36:18,599
they compute like a normal JavaScript

817
00:36:18,599 --> 00:36:20,549
interpreter would do and then they are

818
00:36:20,549 --> 00:36:22,530
able to reply to the challenge so this

819
00:36:22,530 --> 00:36:25,500
allows them to do well in these the guys

820
00:36:25,500 --> 00:36:27,510
using these samples and this is so

821
00:36:27,510 --> 00:36:29,099
advanced that I think we're we're no

822
00:36:29,099 --> 00:36:31,440
longer dealing with the sebastian app

823
00:36:31,440 --> 00:36:33,720
and crew right we're with another group

824
00:36:33,720 --> 00:36:36,299
that is more sophisticated but they are

825
00:36:36,299 --> 00:36:38,549
able then to do application layer or

826
00:36:38,549 --> 00:36:41,040
level attacks on CloudFlare protected

827
00:36:41,040 --> 00:36:45,329
hosts are they sophisticated

828
00:36:45,329 --> 00:36:47,640
yes and no that database was leaked

829
00:36:47,640 --> 00:36:49,890
everything was in plain text password no

830
00:36:49,890 --> 00:36:55,410
hashing everything was just like so

831
00:36:55,410 --> 00:36:57,930
sophisticated yes and no and then and

832
00:36:57,930 --> 00:36:59,790
when you log on there IRC command

833
00:36:59,790 --> 00:37:02,430
control you know how many butts are

834
00:37:02,430 --> 00:37:05,010
there and you even have the operator

835
00:37:05,010 --> 00:37:07,980
handles so they don't like they we hide

836
00:37:07,980 --> 00:37:10,349
the butts but I mean this still like

837
00:37:10,349 --> 00:37:13,470
kind of you and I so I stayed on that

838
00:37:13,470 --> 00:37:15,839
channel for a few weeks and all of the

839
00:37:15,839 --> 00:37:18,900
targets was either DSL lines or cable

840
00:37:18,900 --> 00:37:21,630
lines so end users proudly gamers

841
00:37:21,630 --> 00:37:25,050
enemy's right or game hosting companies

842
00:37:25,050 --> 00:37:27,810
so some Eve online stuff Blizzard stuff

843
00:37:27,810 --> 00:37:33,360
like targets of kids right so this is

844
00:37:33,360 --> 00:37:36,090
very prevalent and it's like so I was a

845
00:37:36,090 --> 00:37:37,830
geek week last week and I deployed the

846
00:37:37,830 --> 00:37:40,320
honeypot and we got again even though

847
00:37:40,320 --> 00:37:41,640
it's been ages

848
00:37:41,640 --> 00:37:45,480
 and a metric shit-ton of samples

849
00:37:45,480 --> 00:37:49,500
around the lizard squad group so this is

850
00:37:49,500 --> 00:37:50,130
the thing

851
00:37:50,130 --> 00:37:53,700
Linux moose I'm I I think I need to go

852
00:37:53,700 --> 00:37:55,110
faster

853
00:37:55,110 --> 00:37:57,510
Linux moose is a but net that it is

854
00:37:57,510 --> 00:37:59,490
selling fraudulent followers on

855
00:37:59,490 --> 00:38:02,310
Instagram mostly I've been tracking that

856
00:38:02,310 --> 00:38:04,140
trap and reverse it for for a while now

857
00:38:04,140 --> 00:38:07,830
so first blog post was in 2015 when I

858
00:38:07,830 --> 00:38:10,350
was at ISA then we built this

859
00:38:10,350 --> 00:38:12,440
architecture that I I showed you earlier

860
00:38:12,440 --> 00:38:15,720
to be able to attack the HTTPS so here

861
00:38:15,720 --> 00:38:19,470
we have the classic unaffected version

862
00:38:19,470 --> 00:38:22,700
where the HTTPS is still a solid purple

863
00:38:22,700 --> 00:38:25,680
still valid then what we did is we

864
00:38:25,680 --> 00:38:29,100
weakened it so the HTTPS from after our

865
00:38:29,100 --> 00:38:31,230
attack is still valid but before you

866
00:38:31,230 --> 00:38:32,880
would get a certificate error of course

867
00:38:32,880 --> 00:38:35,430
so what I decided to do is oh I will

868
00:38:35,430 --> 00:38:37,500
spoof a nice certificate and so I

869
00:38:37,500 --> 00:38:41,550
decided to install a CA of my own CA of

870
00:38:41,550 --> 00:38:44,730
course not a vendor see but checkpoint

871
00:38:44,730 --> 00:38:48,030
maybe you know or fox net so I mimicked

872
00:38:48,030 --> 00:38:50,430
security appliances that were known to

873
00:38:50,430 --> 00:38:52,890
be doing SSL interception in the hope

874
00:38:52,890 --> 00:38:55,650
that the guys would you know be socially

875
00:38:55,650 --> 00:38:58,200
engineered by my clever you know idea

876
00:38:58,200 --> 00:39:00,660
what happen is nothing like there was

877
00:39:00,660 --> 00:39:03,330
not even a single check so there library

878
00:39:03,330 --> 00:39:05,370
or the code they're using it's just you

879
00:39:05,370 --> 00:39:08,490
know certificate errors again yellow we

880
00:39:08,490 --> 00:39:12,180
need we need to do our fraud right and

881
00:39:12,180 --> 00:39:15,780
so this is I was like our attack work I

882
00:39:15,780 --> 00:39:18,300
was like okay I haven't spent all those

883
00:39:18,300 --> 00:39:22,650
months to waste that's good so we did we

884
00:39:22,650 --> 00:39:24,060
did publish and this is why I was not

885
00:39:24,060 --> 00:39:25,920
here at hackfest last year is we were

886
00:39:25,920 --> 00:39:27,960
speaking about this at blackhat Europe

887
00:39:27,960 --> 00:39:30,900
our ego market finding around the next

888
00:39:30,900 --> 00:39:32,490
moves so

889
00:39:32,490 --> 00:39:34,500
I urge you to go on our blog and read

890
00:39:34,500 --> 00:39:37,890
the paper it's good quickly we found

891
00:39:37,890 --> 00:39:40,560
that Linux mousse is stealthy we adapt

892
00:39:40,560 --> 00:39:42,930
so I've been after three different

893
00:39:42,930 --> 00:39:44,700
layers of CNC and they are still

894
00:39:44,700 --> 00:39:46,320
changing whenever we publish something

895
00:39:46,320 --> 00:39:47,220
they change something

896
00:39:47,220 --> 00:39:49,170
there are no direct victims because

897
00:39:49,170 --> 00:39:51,240
people pay for a service which is I want

898
00:39:51,240 --> 00:39:54,270
some more followers and they get it for

899
00:39:54,270 --> 00:39:56,430
a while after well some followers

900
00:39:56,430 --> 00:39:59,100
disappear but I mean they still got it

901
00:39:59,100 --> 00:40:01,020
for the time that they need it so that

902
00:40:01,020 --> 00:40:02,730
the only real victims is that people

903
00:40:02,730 --> 00:40:05,070
that are fooled by accounts with a lot

904
00:40:05,070 --> 00:40:07,740
of followers we found the people paying

905
00:40:07,740 --> 00:40:10,470
and it's like models and it's a really

906
00:40:10,470 --> 00:40:13,200
cool story and talk that we gave and

907
00:40:13,200 --> 00:40:15,440
it's online if you want to see it

908
00:40:15,440 --> 00:40:18,180
another key factor is that they are

909
00:40:18,180 --> 00:40:20,130
hiding in plain sight so they'd be

910
00:40:20,130 --> 00:40:23,760
proudly brag to their you know parents

911
00:40:23,760 --> 00:40:27,600
and relatives that yeah so I'm in social

912
00:40:27,600 --> 00:40:29,460
media marketing and this is what I do

913
00:40:29,460 --> 00:40:32,850
and I can pay taxes and I charge

914
00:40:32,850 --> 00:40:35,520
legitimate credit cards so any other

915
00:40:35,520 --> 00:40:38,580
like a DDoS people the the ad fraud

916
00:40:38,580 --> 00:40:40,470
people they all need to launder their

917
00:40:40,470 --> 00:40:42,960
money you know and go through hoops and

918
00:40:42,960 --> 00:40:46,350
have really difficult things to do in

919
00:40:46,350 --> 00:40:48,810
order to be able to have a Jaguar but if

920
00:40:48,810 --> 00:40:51,869
you're in social media marketing

921
00:40:51,869 --> 00:40:54,330
then oh yeah social media

922
00:40:54,330 --> 00:40:56,280
I mean Mark Zuckerberg is rich so you

923
00:40:56,280 --> 00:40:58,910
must be rich also it sounds legit right

924
00:40:58,910 --> 00:41:01,470
so this is what the please button it

925
00:41:01,470 --> 00:41:03,990
guys are doing it this is MIA and they

926
00:41:03,990 --> 00:41:06,750
they do some some money and and pissed

927
00:41:06,750 --> 00:41:08,340
me off because the enforcement just

928
00:41:08,340 --> 00:41:10,710
doesn't care yeah I can't get their

929
00:41:10,710 --> 00:41:12,450
attention they're like yeah you know

930
00:41:12,450 --> 00:41:15,660
your or ransomware you know I have

931
00:41:15,660 --> 00:41:19,380
to choose I guess ransomware is

932
00:41:19,380 --> 00:41:21,150
important yes

933
00:41:21,150 --> 00:41:23,790
so maybe ransomware on Io T maybe that

934
00:41:23,790 --> 00:41:25,350
will be my like in two years I'll do

935
00:41:25,350 --> 00:41:26,970
well ransomware and I hope the your

936
00:41:26,970 --> 00:41:30,980
router is bankrupted no one cares

937
00:41:31,190 --> 00:41:34,680
chaos chaos is one something we collect

938
00:41:34,680 --> 00:41:36,270
this summer with an intern from Germany

939
00:41:36,270 --> 00:41:40,740
it was very nice thing that he did so

940
00:41:40,740 --> 00:41:42,750
chaos when it contacts it does this

941
00:41:42,750 --> 00:41:44,940
thing where it tries to fingerprint you

942
00:41:44,940 --> 00:41:46,800
we were able to catch it because we were

943
00:41:46,800 --> 00:41:51,450
again you know a proactive not being

944
00:41:51,450 --> 00:41:53,970
detected it it uses

945
00:41:53,970 --> 00:41:56,280
Rostock app and it checks the packet and

946
00:41:56,280 --> 00:41:58,290
it does a connect back so it even if

947
00:41:58,290 --> 00:42:00,030
you're heavily firewalled or even if

948
00:42:00,030 --> 00:42:02,400
you're poor that are exposed already

949
00:42:02,400 --> 00:42:04,710
served by another binary since it's a

950
00:42:04,710 --> 00:42:06,540
raw socket it will still work and do its

951
00:42:06,540 --> 00:42:08,640
connect back so it's it's kind of clever

952
00:42:08,640 --> 00:42:13,470
I never saw that before it has a kind of

953
00:42:13,470 --> 00:42:16,740
homemade crypto with you know I generate

954
00:42:16,740 --> 00:42:19,830
some noise noise it share some of it and

955
00:42:19,830 --> 00:42:23,609
then generate keys based on that it's

956
00:42:23,609 --> 00:42:26,220
kind of nice but I am running out of

957
00:42:26,220 --> 00:42:27,869
time so I'm going through quickly

958
00:42:27,869 --> 00:42:31,349
through it but it has integrity checking

959
00:42:31,349 --> 00:42:34,020
and and and this is the chaos is only

960
00:42:34,020 --> 00:42:36,060
the clinic back backdoor part of the

961
00:42:36,060 --> 00:42:39,119
operation there is more to it that where

962
00:42:39,119 --> 00:42:41,430
we are going to publish before the end

963
00:42:41,430 --> 00:42:45,630
of the year so basically the crypto is

964
00:42:45,630 --> 00:42:47,670
not good but it's good enough so that if

965
00:42:47,670 --> 00:42:50,339
you don't if you had a full trace and

966
00:42:50,339 --> 00:42:52,410
you have the sample you can reverse

967
00:42:52,410 --> 00:42:54,930
everything and you can get convert all

968
00:42:54,930 --> 00:42:56,940
of the communication back to plain text

969
00:42:56,940 --> 00:42:59,250
but if you don't have the sample then

970
00:42:59,250 --> 00:43:01,140
it's kind of hard and I think this is

971
00:43:01,140 --> 00:43:03,270
why they done it so that it wouldn't

972
00:43:03,270 --> 00:43:06,660
show up as like oh here we are a connect

973
00:43:06,660 --> 00:43:09,180
back backdoor and this is system that is

974
00:43:09,180 --> 00:43:11,790
run so kind of you know just a step

975
00:43:11,790 --> 00:43:14,609
ahead of other groups but we're gonna

976
00:43:14,609 --> 00:43:18,150
publish about it and some future work

977
00:43:18,150 --> 00:43:21,000
around what I want to do is I would like

978
00:43:21,000 --> 00:43:24,380
so right now since the IOT is evolving

979
00:43:24,380 --> 00:43:28,109
there is no more the time where you you

980
00:43:28,109 --> 00:43:30,330
would get a sample like right after that

981
00:43:30,330 --> 00:43:31,980
with everything what we see now is

982
00:43:31,980 --> 00:43:35,160
droppers on miss or on arm which is

983
00:43:35,160 --> 00:43:36,570
something Windows has been doing for

984
00:43:36,570 --> 00:43:39,420
ages windows malware author but now what

985
00:43:39,420 --> 00:43:41,250
I would like to do is run that the

986
00:43:41,250 --> 00:43:43,710
droppers in some safe way where

987
00:43:43,710 --> 00:43:46,170
execute necessarily the dangerous

988
00:43:46,170 --> 00:43:48,359
payload but I will add at least yet the

989
00:43:48,359 --> 00:43:51,390
stage to so this I think with um you and

990
00:43:51,390 --> 00:43:53,430
maybe sector I can accomplish something

991
00:43:53,430 --> 00:43:55,380
like that something I want to do if

992
00:43:55,380 --> 00:43:56,910
you're interested that I would be happy

993
00:43:56,910 --> 00:43:59,880
to collaborate on that emulate more type

994
00:43:59,880 --> 00:44:03,089
of devices and like Smart TVs and stuff

995
00:44:03,089 --> 00:44:08,490
like that I people say the Smart TV is a

996
00:44:08,490 --> 00:44:10,980
target you know and the CIA they have

997
00:44:10,980 --> 00:44:12,839
exploit on smart TV but this is not

998
00:44:12,839 --> 00:44:14,790
stuff that scaled and all it was really

999
00:44:14,790 --> 00:44:17,760
implants that of people targeted so I

1000
00:44:17,760 --> 00:44:20,190
want to see if we will see a but net or

1001
00:44:20,190 --> 00:44:23,040
something around that so and this is

1002
00:44:23,040 --> 00:44:25,079
very simple and cool you just take the

1003
00:44:25,079 --> 00:44:26,940
firmware you've been walk it you extract

1004
00:44:26,940 --> 00:44:29,250
the file system you mimic the file

1005
00:44:29,250 --> 00:44:31,890
system in psych re you mimic the output

1006
00:44:31,890 --> 00:44:34,650
of some commands it's kind of fun to do

1007
00:44:34,650 --> 00:44:38,520
so this is why I want to look at it for

1008
00:44:38,520 --> 00:44:41,430
that analysis they I don't have an elk

1009
00:44:41,430 --> 00:44:44,069
set up still at work and I should get to

1010
00:44:44,069 --> 00:44:46,619
it with a geek week I played with people

1011
00:44:46,619 --> 00:44:51,000
who were and Jason is here actually he's

1012
00:44:51,000 --> 00:44:54,170
running the social engineering show but

1013
00:44:54,170 --> 00:44:57,809
they they have a full elk stash and I

1014
00:44:57,809 --> 00:45:00,030
would like to you know make more use of

1015
00:45:00,030 --> 00:45:02,760
that and present fanciness dashboards to

1016
00:45:02,760 --> 00:45:04,170
management so that he come in my office

1017
00:45:04,170 --> 00:45:06,660
and they're like oh yeah well map that's

1018
00:45:06,660 --> 00:45:11,819
cool fancy funding hey like that so I

1019
00:45:11,819 --> 00:45:14,970
need that right I want to play with my

1020
00:45:14,970 --> 00:45:16,260
log from AOL

1021
00:45:16,260 --> 00:45:19,160
which is a pcap grinding to a very

1022
00:45:19,160 --> 00:45:21,780
interesting very well built again on

1023
00:45:21,780 --> 00:45:23,760
elasticsearch and stuff like that and I

1024
00:45:23,760 --> 00:45:25,349
would like to have a like higher level

1025
00:45:25,349 --> 00:45:28,079
construct around ipython for extractions

1026
00:45:28,079 --> 00:45:31,140
of stuff that I'm interested in which is

1027
00:45:31,140 --> 00:45:33,150
malware related all time for reverse

1028
00:45:33,150 --> 00:45:35,549
engineering I think I need I've been

1029
00:45:35,549 --> 00:45:37,140
talking about this for so long but I

1030
00:45:37,140 --> 00:45:41,730
need to do it bill pre-built flirt

1031
00:45:41,730 --> 00:45:44,970
signatures for embedded systems like

1032
00:45:44,970 --> 00:45:49,140
like combined compiler and C library and

1033
00:45:49,140 --> 00:45:52,140
just do Dockers and build the stuff and

1034
00:45:52,140 --> 00:45:54,420
then convert that into flow signature

1035
00:45:54,420 --> 00:45:56,280
and port them into either and so people

1036
00:45:56,280 --> 00:45:57,150
can do more

1037
00:45:57,150 --> 00:45:59,880
the reverse engineering so I said I was

1038
00:45:59,880 --> 00:46:02,819
gonna talk about fixing the problem yes

1039
00:46:02,819 --> 00:46:08,010
I will talk about so vendors they should

1040
00:46:08,010 --> 00:46:10,799
stop using the for credentials and use

1041
00:46:10,799 --> 00:46:13,349
per device potentials even if it's on a

1042
00:46:13,349 --> 00:46:18,150
sticker on the device it's you you are

1043
00:46:18,150 --> 00:46:21,450
doing it already for SS IDs and for the

1044
00:46:21,450 --> 00:46:24,390
Wi-Fi password so don't tell me it's a

1045
00:46:24,390 --> 00:46:26,730
supply chain nightmare right your your

1046
00:46:26,730 --> 00:46:30,660
disclose and the threat is remote like

1047
00:46:30,660 --> 00:46:32,910
it doesn't matter if the password is on

1048
00:46:32,910 --> 00:46:35,490
a label and if it matters then change it

1049
00:46:35,490 --> 00:46:38,849
right stop exposing general-purpose

1050
00:46:38,849 --> 00:46:42,329
management ports telnet SSH and consumer

1051
00:46:42,329 --> 00:46:45,089
foot password on your devices even if

1052
00:46:45,089 --> 00:46:46,380
you have to roll it on a post-it and

1053
00:46:46,380 --> 00:46:48,900
stick it and do that everywhere you go

1054
00:46:48,900 --> 00:46:51,900
right you go at your haunts house you

1055
00:46:51,900 --> 00:46:55,680
 in 192 168 0 1 and men and men if

1056
00:46:55,680 --> 00:46:59,039
you're in then change the password it's

1057
00:46:59,039 --> 00:47:02,720
just simple like that I have a demo

1058
00:47:04,220 --> 00:47:07,490
and sure

1059
00:47:09,900 --> 00:47:13,200
so I mean this is what I do now I go at

1060
00:47:13,200 --> 00:47:16,230
places try and minun man maybe it's some

1061
00:47:16,230 --> 00:47:18,120
time it's more complicated like admin

1062
00:47:18,120 --> 00:47:22,650
Linksys and you know but yes so we can

1063
00:47:22,650 --> 00:47:25,080
do some awareness training that way

1064
00:47:25,080 --> 00:47:27,390
again I know like they will

1065
00:47:27,390 --> 00:47:29,520
reset the thing with a pin and then it

1066
00:47:29,520 --> 00:47:32,730
would be a minute but yeah you know you

1067
00:47:32,730 --> 00:47:37,260
get a try people building this IOT stuff

1068
00:47:37,260 --> 00:47:39,840
and I know there is people like that and

1069
00:47:39,840 --> 00:47:44,790
you need to - I mean here I know there

1070
00:47:44,790 --> 00:47:47,430
are vendors or maybe purple interested

1071
00:47:47,430 --> 00:47:49,440
in it and I mean everyone every geek has

1072
00:47:49,440 --> 00:47:52,080
his own like oh I'm gonna build this

1073
00:47:52,080 --> 00:47:53,610
thing and it would revolutionize the

1074
00:47:53,610 --> 00:47:58,500
world think about scalability and how a

1075
00:47:58,500 --> 00:48:01,010
feature can be abused right how

1076
00:48:01,010 --> 00:48:04,470
something that for you looks like it's

1077
00:48:04,470 --> 00:48:05,100
not

1078
00:48:05,100 --> 00:48:08,190
if you send one bite and I reply 2

1079
00:48:08,190 --> 00:48:11,340
megabyte it's okay there's gonna be a

1080
00:48:11,340 --> 00:48:13,830
problem with that you know this is what

1081
00:48:13,830 --> 00:48:16,260
you have to think about when when you do

1082
00:48:16,260 --> 00:48:19,620
deploy and and and I know you like until

1083
00:48:19,620 --> 00:48:22,380
you make it you don't really care about

1084
00:48:22,380 --> 00:48:25,050
security but once you're big it's too

1085
00:48:25,050 --> 00:48:26,820
late so there's kind of this balance to

1086
00:48:26,820 --> 00:48:30,300
have and think about that also think

1087
00:48:30,300 --> 00:48:32,490
about physical access so for example no

1088
00:48:32,490 --> 00:48:34,680
SSH not ended by default but if you push

1089
00:48:34,680 --> 00:48:36,870
a button then for five minutes

1090
00:48:36,870 --> 00:48:39,210
there is SSH or telnet you know exposed

1091
00:48:39,210 --> 00:48:42,600
so think about the the advantage that

1092
00:48:42,600 --> 00:48:44,310
you have that Europe consumers will have

1093
00:48:44,310 --> 00:48:47,130
physical access and leverage it and time

1094
00:48:47,130 --> 00:48:49,560
based approaches are a good way to

1095
00:48:49,560 --> 00:48:51,930
mitigate a lot of the big problems and

1096
00:48:51,930 --> 00:48:55,470
and thinking of features as what if a

1097
00:48:55,470 --> 00:48:56,970
button operator

1098
00:48:56,970 --> 00:48:59,040
what would a botnet operator would do

1099
00:48:59,040 --> 00:49:01,770
kind of threat Marlo is a good way to

1100
00:49:01,770 --> 00:49:03,510
prevent some of the biggest problems

1101
00:49:03,510 --> 00:49:07,560
that you can have so takeaways I don't

1102
00:49:07,560 --> 00:49:10,770
have much but I hope isn't secure it can

1103
00:49:10,770 --> 00:49:12,060
be fixed for the low-hanging fruit

1104
00:49:12,060 --> 00:49:14,070
problems and this is what I see in the

1105
00:49:14,070 --> 00:49:16,770
malware this is like abuse of default

1106
00:49:16,770 --> 00:49:19,230
credentials and now I want I would like

1107
00:49:19,230 --> 00:49:22,020
reverse the stuff that is doing exploits

1108
00:49:22,020 --> 00:49:23,140
and you know coolers

1109
00:49:23,140 --> 00:49:25,570
but right now all I've got is the shitty

1110
00:49:25,570 --> 00:49:27,610
stuff so please let's make it more

1111
00:49:27,610 --> 00:49:29,950
secure so I get more interesting samples

1112
00:49:29,950 --> 00:49:33,700
the reverse engineer and we need to see

1113
00:49:33,700 --> 00:49:35,230
what's coming next right we need to be

1114
00:49:35,230 --> 00:49:37,480
focused on that because it's gonna be a

1115
00:49:37,480 --> 00:49:38,470
bigger problem

1116
00:49:38,470 --> 00:49:43,570
so we we need to keep keep on added you

1117
00:49:43,570 --> 00:49:46,780
can send me samples just zip file

1118
00:49:46,780 --> 00:49:50,290
infected here we go and I would like to

1119
00:49:50,290 --> 00:49:52,030
thank a hack thanks for having me it's

1120
00:49:52,030 --> 00:49:52,810
been a blast

1121
00:49:52,810 --> 00:49:55,390
like I said seven years and I hope that

1122
00:49:55,390 --> 00:49:57,550
I will be there for seven others so

1123
00:49:57,550 --> 00:50:13,500
thank you for having me any questions

1124
00:50:19,280 --> 00:50:21,910
yes

1125
00:50:22,430 --> 00:50:26,440
that's a man we can all well

1126
00:50:28,230 --> 00:50:31,289
[Music]

1127
00:50:33,400 --> 00:50:35,620
okay so I guess you don't want the bad

1128
00:50:35,620 --> 00:50:38,590
guys to know that you are a honeypot so

1129
00:50:38,590 --> 00:50:40,150
how do you do that then how do you

1130
00:50:40,150 --> 00:50:42,160
protect yourself from the statical

1131
00:50:42,160 --> 00:50:44,500
attack so that checks the performance

1132
00:50:44,500 --> 00:50:46,440
the response time of your system

1133
00:50:46,440 --> 00:50:50,830
you mean so okay so to avoid being

1134
00:50:50,830 --> 00:50:52,930
fingerprinted you look at what they are

1135
00:50:52,930 --> 00:50:55,330
doing and when they pull out so for

1136
00:50:55,330 --> 00:50:56,980
example one of the changes I made weeks

1137
00:50:56,980 --> 00:50:59,020
ago is they would write a file under

1138
00:50:59,020 --> 00:51:01,840
slash rock and for a Linux system you

1139
00:51:01,840 --> 00:51:04,120
can't it's not allowed it's a virtual

1140
00:51:04,120 --> 00:51:06,280
file system but on the honeypot it

1141
00:51:06,280 --> 00:51:08,890
worked so what I did is I implemented a

1142
00:51:08,890 --> 00:51:10,630
check an additional check that would say

1143
00:51:10,630 --> 00:51:12,370
oh if you're trying to write here this

1144
00:51:12,370 --> 00:51:16,870
is a specific system a directory that

1145
00:51:16,870 --> 00:51:19,240
you can't write and as soon as we change

1146
00:51:19,240 --> 00:51:21,190
that then we would go further

1147
00:51:21,190 --> 00:51:23,230
it was fingerprint other things and I

1148
00:51:23,230 --> 00:51:24,850
implemented the other things that they

1149
00:51:24,850 --> 00:51:26,530
were looking they were creating files

1150
00:51:26,530 --> 00:51:28,810
and removing them but some of the time

1151
00:51:28,810 --> 00:51:31,000
the files wouldn't exist and the

1152
00:51:31,000 --> 00:51:33,280
honeypot would not give an error so I

1153
00:51:33,280 --> 00:51:36,010
just make sure that the logic to give an

1154
00:51:36,010 --> 00:51:37,750
error when it's supposed to happen was

1155
00:51:37,750 --> 00:51:40,750
there and so then right so we'll run

1156
00:51:40,750 --> 00:51:43,510
these honeypots collect new samples but

1157
00:51:43,510 --> 00:51:45,850
then in one year they will have adapted

1158
00:51:45,850 --> 00:51:48,340
to our new way right so in one year I

1159
00:51:48,340 --> 00:51:51,340
need to look at this again and you know

1160
00:51:51,340 --> 00:51:54,730
be one step ahead type deal right well

1161
00:51:54,730 --> 00:51:58,320
with you try to emulate the performance

1162
00:51:58,320 --> 00:52:01,870
okay so no they're not doing this yet

1163
00:52:01,870 --> 00:52:03,940
but at some point we will have but on

1164
00:52:03,940 --> 00:52:06,550
Windows like they do to count and to

1165
00:52:06,550 --> 00:52:09,040
determine if it's on a VM or not and

1166
00:52:09,040 --> 00:52:11,770
there's stuff to be done or or to do in

1167
00:52:11,770 --> 00:52:15,070
that area I agree but on on Linux

1168
00:52:15,070 --> 00:52:16,900
systems right now I haven't seen that

1169
00:52:16,900 --> 00:52:19,150
that type of fingerprinting all right

1170
00:52:19,150 --> 00:52:19,720
thank you

1171
00:52:19,720 --> 00:52:25,560
Thanks any other question

1172
00:52:26,349 --> 00:52:29,109
all right thank you guys it was fun I

1173
00:52:29,109 --> 00:52:30,400
hope you enjoyed

1174
00:52:30,400 --> 00:52:32,579
[Applause]

