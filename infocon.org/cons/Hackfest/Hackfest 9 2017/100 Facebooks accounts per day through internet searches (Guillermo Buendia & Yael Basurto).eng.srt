1
00:00:00,199 --> 00:00:04,950
hello everybody thanks for coming

2
00:00:04,950 --> 00:00:08,250
I'm Guillermo and vigil and we present

3
00:00:08,250 --> 00:00:13,429
octane 150 cocoons per day current

4
00:00:13,429 --> 00:00:16,949
internet searches this is a word

5
00:00:16,949 --> 00:00:19,430
disclaimer

6
00:00:28,360 --> 00:00:48,050
okay and this is our agenda our office

7
00:00:48,050 --> 00:00:52,250
and we are members of of fellows our

8
00:00:52,250 --> 00:00:55,370
security team in Mexico City both as a

9
00:00:55,370 --> 00:01:00,110
penetration tester this is our failed

10
00:01:00,110 --> 00:01:03,739
the first serious reserves and we love

11
00:01:03,739 --> 00:01:06,430
security learn interesting things and

12
00:01:06,430 --> 00:01:10,370
breaking things for fun and we are into

13
00:01:10,370 --> 00:01:14,510
book bounces and participate intro city

14
00:01:14,510 --> 00:01:17,409
as a whole

15
00:01:22,500 --> 00:01:27,640
hello everyone buggy in 2016 we found a

16
00:01:27,640 --> 00:01:29,860
vulnerability related with the instant

17
00:01:29,860 --> 00:01:31,990
articles from finality from the mobile

18
00:01:31,990 --> 00:01:35,050
Facebook application we defy the

19
00:01:35,050 --> 00:01:39,910
possibility to stow accounts and we

20
00:01:39,910 --> 00:01:42,130
report these issues to the Facebook

21
00:01:42,130 --> 00:01:48,820
rebounding team in May 2016 M this day

22
00:01:48,820 --> 00:01:56,620
the Facebook issue let's see how it

23
00:01:56,620 --> 00:02:10,270
works to the lack proper validation in

24
00:02:10,270 --> 00:02:13,510
one satellite when created URL circuits

25
00:02:13,510 --> 00:02:16,870
professional instant article it was

26
00:02:16,870 --> 00:02:20,350
absurd some links are shared with us say

27
00:02:20,350 --> 00:02:23,650
50 another Keith which allows a surprise

28
00:02:23,650 --> 00:02:26,380
to still in session with open the link

29
00:02:26,380 --> 00:02:29,040
in a browser

30
00:02:29,040 --> 00:02:33,220
since the rotor are asked to in the same

31
00:02:33,220 --> 00:02:36,280
session as have the user initially

32
00:02:36,280 --> 00:02:46,209
insert the link here we can see how a

33
00:02:46,209 --> 00:02:48,550
legitimate user is using his more

34
00:02:48,550 --> 00:02:49,750
Facebook application

35
00:02:49,750 --> 00:02:53,709
keys so content I've made a content he

36
00:02:53,709 --> 00:02:56,140
likes it then she went to sharing she

37
00:02:56,140 --> 00:02:59,970
opens the open link a functionality

38
00:02:59,970 --> 00:03:02,980
ensured the link should be another media

39
00:03:02,980 --> 00:03:05,769
for instant what's up and the link

40
00:03:05,769 --> 00:03:08,250
contains already the session key

41
00:03:08,250 --> 00:03:15,190
embedded in this link so after it is

42
00:03:15,190 --> 00:03:19,269
sure another user open the link and the

43
00:03:19,269 --> 00:03:22,630
browser ask him to initiates a fan as

44
00:03:22,630 --> 00:03:25,900
the user and initially surely the

45
00:03:25,900 --> 00:03:29,980
content all the malicious user has to do

46
00:03:29,980 --> 00:03:32,460
is to click in ok and the session is

47
00:03:32,460 --> 00:03:35,640
already set in his browser

48
00:03:35,640 --> 00:03:42,980
and it is found as easy as that

49
00:03:42,980 --> 00:03:46,530
Express they were everything math it was

50
00:03:46,530 --> 00:03:50,550
not easy to tell this issue since we

51
00:03:50,550 --> 00:03:53,040
fight that the willingness is not always

52
00:03:53,040 --> 00:03:55,320
present when shamed a link from the

53
00:03:55,320 --> 00:03:58,230
facebook mobile application we already

54
00:03:58,230 --> 00:04:01,200
knew all these certain leagues were

55
00:04:01,200 --> 00:04:05,340
construct and its content this is the

56
00:04:05,340 --> 00:04:08,370
structure the they will not equal linked

57
00:04:08,370 --> 00:04:11,570
and so you can see the epic key and

58
00:04:11,570 --> 00:04:18,390
decision key so the solution was the

59
00:04:18,390 --> 00:04:22,320
Internet and it was possible to

60
00:04:22,320 --> 00:04:24,690
replicate this issue several times with

61
00:04:24,690 --> 00:04:27,540
a thought a lot of Facebook accounts on

62
00:04:27,540 --> 00:04:30,030
the world firms searching in Google it

63
00:04:30,030 --> 00:04:33,150
was possible to observe that it was

64
00:04:33,150 --> 00:04:35,160
quite common to share links on

65
00:04:35,160 --> 00:04:38,040
Parliament that can be used to still a

66
00:04:38,040 --> 00:04:40,979
panel session account and this is an

67
00:04:40,979 --> 00:04:46,050
invasive rule sir if it had a lot of

68
00:04:46,050 --> 00:04:50,040
unary feelings and some links work find

69
00:04:50,040 --> 00:04:53,430
out there six months both others things

70
00:04:53,430 --> 00:04:58,290
worked off and we need to some recent

71
00:04:58,290 --> 00:05:03,950
stuff yeah

72
00:05:03,950 --> 00:05:08,250
when we use a real-time search index a

73
00:05:08,250 --> 00:05:10,380
filter searches we are paying a lot of

74
00:05:10,380 --> 00:05:21,390
money buildings around a position many

75
00:05:21,390 --> 00:05:31,979
links we are saying now a couple of

76
00:05:31,979 --> 00:05:39,950
videos how to learn tea was fun

77
00:06:17,620 --> 00:06:26,839
this is pure searching said we research

78
00:06:26,839 --> 00:06:30,710
our lengthiest return link Facebook

79
00:06:30,710 --> 00:06:38,330
flies out that PHP we found that a lot

80
00:06:38,330 --> 00:06:53,569
of links in so our point was that not

81
00:06:53,569 --> 00:06:56,689
every link was vulnerable but we already

82
00:06:56,689 --> 00:06:59,060
knew they had a structure of these links

83
00:06:59,060 --> 00:07:03,009
so by using treat Peter we were able to

84
00:07:03,009 --> 00:07:06,469
search for the things surely like II

85
00:07:06,469 --> 00:07:08,810
merely or winning two or two days and

86
00:07:08,810 --> 00:07:11,149
those these things were we're already

87
00:07:11,149 --> 00:07:16,819
valid so this video was about searching

88
00:07:16,819 --> 00:07:23,629
the Rings and this one yes second one

89
00:07:23,629 --> 00:07:28,399
and this is how we exploit these these

90
00:07:28,399 --> 00:07:37,580
links once we found him so

91
00:07:37,580 --> 00:07:40,729
have seen and we search for this kind of

92
00:07:40,729 --> 00:07:49,559
vulnerable links within Twitter so we

93
00:07:49,559 --> 00:07:53,789
we found and all kinds of profiles since

94
00:07:53,789 --> 00:07:59,969
politicians people around the world and

95
00:07:59,969 --> 00:08:02,189
this these things were shared like

96
00:08:02,189 --> 00:08:04,109
immediately for instance you could see

97
00:08:04,109 --> 00:08:07,139
is something in Facebook it was sharing

98
00:08:07,139 --> 00:08:11,539
me Utley you know his media social media

99
00:08:11,539 --> 00:08:47,730
accounts there is only so we click it we

100
00:08:47,730 --> 00:08:50,480
have already but this so we have to

101
00:08:50,480 --> 00:09:05,059
clean our ketchup well once it is plan

102
00:09:05,059 --> 00:09:06,660
we up

103
00:09:06,660 --> 00:09:10,949
again the link and the browser asked us

104
00:09:10,949 --> 00:09:13,019
to initiate session as the user of

105
00:09:13,019 --> 00:09:18,410
shared lowing we click okay the Meher is

106
00:09:18,410 --> 00:09:23,100
media show we redirect our browser to

107
00:09:23,100 --> 00:09:26,040
Facebook and the browser has already

108
00:09:26,040 --> 00:09:31,459
decision so we have that count

109
00:10:07,519 --> 00:10:10,290
Sosa's we reported this as a bigger

110
00:10:10,290 --> 00:10:15,899
bounty program we were paid this side

111
00:10:15,899 --> 00:10:30,420
reward that was really fun the URL

112
00:10:30,420 --> 00:10:32,879
shortener they taught me to get they

113
00:10:32,879 --> 00:10:36,329
will never fit in one tabloid religion

114
00:10:36,329 --> 00:10:43,800
it was implemented in out that field and

115
00:10:43,800 --> 00:10:48,319
so that is no longer possible to still

116
00:11:01,879 --> 00:11:04,889
this is the revelation that the Facebook

117
00:11:04,889 --> 00:11:09,629
a team implemented so you can no longer

118
00:11:09,629 --> 00:11:13,559
open the the browser any and initiation

119
00:11:13,559 --> 00:11:16,379
as the users since the link immediately

120
00:11:16,379 --> 00:11:19,079
related to the content media that you're

121
00:11:19,079 --> 00:11:23,910
sharing however the structure of the

122
00:11:23,910 --> 00:11:28,379
link is not modified in any way the app

123
00:11:28,379 --> 00:11:33,350
it creates this kind of things today

124
00:11:40,760 --> 00:11:50,000
and this is the return of you can see

125
00:11:50,450 --> 00:11:58,280
their Malaysian me figured link is

126
00:11:58,280 --> 00:12:01,170
skipping the part when went up knocking

127
00:12:01,170 --> 00:12:03,570
is asking you to initiate Asian and

128
00:12:03,570 --> 00:12:10,650
within the browser buildings include you

129
00:12:10,650 --> 00:12:18,770
country many of them give you the links

130
00:12:35,320 --> 00:12:39,070
so what next

131
00:12:40,040 --> 00:12:43,410
so this molarity could be present

132
00:12:43,410 --> 00:12:45,900
another kind of things we said

133
00:12:45,900 --> 00:12:48,990
previously and Facebook didn't correct

134
00:12:48,990 --> 00:12:51,720
this functionality the Epistle create

135
00:12:51,720 --> 00:12:54,330
these kind of links and varying some

136
00:12:54,330 --> 00:13:02,190
probably vulnerable parameters such as

137
00:13:02,190 --> 00:13:05,370
this we found that there's another a

138
00:13:05,370 --> 00:13:09,150
link that could be vulnerable if this

139
00:13:09,150 --> 00:13:11,730
link contains the SS soul request

140
00:13:11,730 --> 00:13:14,970
parameter and this session is also

141
00:13:14,970 --> 00:13:18,540
embedded in these kind of things

142
00:13:18,540 --> 00:13:24,029
it's how we will how this is SSL wicked

143
00:13:24,029 --> 00:13:27,029
works

144
00:13:43,210 --> 00:13:46,610
we use the same method we use live

145
00:13:46,610 --> 00:13:49,730
searches and we didn't see there and we

146
00:13:49,730 --> 00:13:53,660
can find many of these a links that are

147
00:13:53,660 --> 00:13:56,440
already shirt

148
00:13:56,440 --> 00:13:59,029
the problem with the link was the

149
00:13:59,029 --> 00:14:01,279
expiration date it was really really

150
00:14:01,279 --> 00:14:04,250
short and it was really difficult to

151
00:14:04,250 --> 00:14:09,230
test or to find one valid link also when

152
00:14:09,230 --> 00:14:11,839
you use it when you find about a week

153
00:14:11,839 --> 00:14:14,690
you use it it is no longer valid you can

154
00:14:14,690 --> 00:14:18,560
exploit this issue once for per link so

155
00:14:18,560 --> 00:14:23,300
it was really difficult to test but the

156
00:14:23,300 --> 00:14:25,700
structure is still there you can search

157
00:14:25,700 --> 00:14:27,769
for these kind of things in there

158
00:14:27,769 --> 00:14:37,820
everywhere we will see our provoke

159
00:14:37,820 --> 00:14:45,980
concept it is what to mention this is

160
00:14:45,980 --> 00:14:49,100
another link it is not reported yet to

161
00:14:49,100 --> 00:14:56,810
Facebook and it is vulnerable still so

162
00:14:56,810 --> 00:15:09,050
be careful what your children so we

163
00:15:09,050 --> 00:15:11,510
first checked if there's an open session

164
00:15:11,510 --> 00:15:23,630
in the browser there is none and we have

165
00:15:23,630 --> 00:15:25,880
some content media shared with this kind

166
00:15:25,880 --> 00:15:30,440
of of winner of Unix by opening the

167
00:15:30,440 --> 00:15:36,740
browser asks you to initiation the

168
00:15:36,740 --> 00:15:37,630
structure

169
00:15:37,630 --> 00:15:42,240
blink it has the the same shortener or

170
00:15:42,240 --> 00:15:43,480
mistake

171
00:15:43,480 --> 00:15:46,330
embedded in the this is how request

172
00:15:46,330 --> 00:15:57,310
parameter did you click OK and the

173
00:15:57,310 --> 00:15:59,910
session is established on the browser

174
00:15:59,910 --> 00:16:05,189
the content media is shown obviously

175
00:16:05,860 --> 00:16:12,790
but now we open our browser create the

176
00:16:12,790 --> 00:16:17,130
Facebook we have the cows

177
00:16:26,690 --> 00:16:30,139
if you use the link one second

178
00:16:30,139 --> 00:16:37,180
they're inseparable anything works once

179
00:16:37,180 --> 00:16:47,540
and we try again the same and it is no

180
00:16:47,540 --> 00:17:05,900
longer value however that that doesn't

181
00:17:05,900 --> 00:17:08,569
mean this is not as playable and the

182
00:17:08,569 --> 00:17:11,179
next step could involve to create some

183
00:17:11,179 --> 00:17:14,089
script to ultimate eyes the this process

184
00:17:14,089 --> 00:17:16,909
find links they collect them and try to

185
00:17:16,909 --> 00:17:20,390
exploit them you only need a one

186
00:17:20,390 --> 00:17:23,919
successful agent

