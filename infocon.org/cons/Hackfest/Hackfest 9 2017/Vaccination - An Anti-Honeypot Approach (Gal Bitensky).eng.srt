1
00:00:00,230 --> 00:00:03,629
hi-oh so it's kind of a tradition that I

2
00:00:03,629 --> 00:00:05,879
get that post lunch slot it's the second

3
00:00:05,879 --> 00:00:08,870
time this year I'm getting a slot so I

4
00:00:08,870 --> 00:00:12,630
hope you all paid well but I hope that

5
00:00:12,630 --> 00:00:15,120
you are motivated a bit and I thought

6
00:00:15,120 --> 00:00:17,039
that I will do some game where I say how

7
00:00:17,039 --> 00:00:19,980
can you say fast but then are you in for

8
00:00:19,980 --> 00:00:28,010
it no okay so let's start with the talk

9
00:00:28,010 --> 00:00:31,460
I'm here today to speak about

10
00:00:31,460 --> 00:00:33,840
vaccination and anti honeypot approach

11
00:00:33,840 --> 00:00:36,710
it's not that I'm against honey pots

12
00:00:36,710 --> 00:00:41,550
I've clarified it but later on I'm Pro a

13
00:00:41,550 --> 00:00:44,100
different approach of repelling

14
00:00:44,100 --> 00:00:48,090
attackers by acting the other way around

15
00:00:48,090 --> 00:00:52,410
from honey pots wonderful animation

16
00:00:52,410 --> 00:00:55,469
you'll see a lot of those animations I'm

17
00:00:55,469 --> 00:00:58,500
doing my talk be ready for it

18
00:00:58,500 --> 00:01:00,930
what I'm trying to do is well today we

19
00:01:00,930 --> 00:01:02,789
are in the world of like we're we are

20
00:01:02,789 --> 00:01:05,459
like trying to chase malware it's just

21
00:01:05,459 --> 00:01:09,060
like cat and mouse game but well we end

22
00:01:09,060 --> 00:01:11,280
up most of the time the other way around

23
00:01:11,280 --> 00:01:15,540
you know the mouse chase of the canton

24
00:01:15,540 --> 00:01:19,590
yeah it's quite problematic and I feel

25
00:01:19,590 --> 00:01:22,409
that we're too much in this state and

26
00:01:22,409 --> 00:01:25,680
rather the other way around so what I'm

27
00:01:25,680 --> 00:01:29,549
trying to do is turn round well it's

28
00:01:29,549 --> 00:01:33,600
also my first time in Canada yeah yeah I

29
00:01:33,600 --> 00:01:35,610
once speak a bit about it before I start

30
00:01:35,610 --> 00:01:39,840
told to technical like boring stuff when

31
00:01:39,840 --> 00:01:42,840
I flew here I thought it does worry

32
00:01:42,840 --> 00:01:48,119
about see ya this was my like my idea of

33
00:01:48,119 --> 00:01:51,390
Canada like till now oh I remember that

34
00:01:51,390 --> 00:01:54,329
there's also this guy I'm not really can

35
00:01:54,329 --> 00:01:57,439
he looks like his Canadian Mountie knee

36
00:01:57,439 --> 00:02:03,450
Mountie Mountie yeah Mountie I'm not

37
00:02:03,450 --> 00:02:05,130
sure he's Canadian but it's was also my

38
00:02:05,130 --> 00:02:07,619
idea of Canada but then I remember

39
00:02:07,619 --> 00:02:11,370
there's also like this guy which is one

40
00:02:11,370 --> 00:02:13,770
of my favorite singer songwriters and

41
00:02:13,770 --> 00:02:16,770
also Canadians oh qoodles for you Canada

42
00:02:16,770 --> 00:02:19,860
and I thought no Neil Young is not the

43
00:02:19,860 --> 00:02:21,360
only one so yeah there are plenty of

44
00:02:21,360 --> 00:02:24,210
more amazing people from Canada which I

45
00:02:24,210 --> 00:02:27,530
really like and appreciate and what oh

46
00:02:27,530 --> 00:02:31,350
yeah but there's this guy also so yeah

47
00:02:31,350 --> 00:02:37,410
so Canada this is on you yeah this is

48
00:02:37,410 --> 00:02:41,160
the last that allows the animation of my

49
00:02:41,160 --> 00:02:45,600
intro to Canada so what's next

50
00:02:45,600 --> 00:02:48,320
what we are about it after they hear a

51
00:02:48,320 --> 00:02:50,970
bit about 20 pots was what is the honey

52
00:02:50,970 --> 00:02:53,550
part bit of like basic concepts about

53
00:02:53,550 --> 00:02:55,230
honey pots

54
00:02:55,230 --> 00:02:58,320
what is an anti honey pot but not in the

55
00:02:58,320 --> 00:03:00,180
world of computer security but in the

56
00:03:00,180 --> 00:03:02,970
nature it's not my idea there are a lot

57
00:03:02,970 --> 00:03:05,730
of cases in the nature of anti honey pot

58
00:03:05,730 --> 00:03:08,610
and from there we'll take this concept

59
00:03:08,610 --> 00:03:11,970
and apply it to computer security with

60
00:03:11,970 --> 00:03:15,480
hands-on examples and really deep

61
00:03:15,480 --> 00:03:17,700
technical stuff which I hope you're up

62
00:03:17,700 --> 00:03:21,360
to we'll do a bit of good idea that idea

63
00:03:21,360 --> 00:03:24,720
when applying vaccination to you know

64
00:03:24,720 --> 00:03:27,780
realize enterprises or even home users

65
00:03:27,780 --> 00:03:32,220
and also have a knife demo okay so a bit

66
00:03:32,220 --> 00:03:32,880
about myself

67
00:03:32,880 --> 00:03:38,760
hi I'm gal which is wave in Hebrew my 21

68
00:03:38,760 --> 00:03:42,990
year old geek from Tel Aviv my company

69
00:03:42,990 --> 00:03:45,540
it's not mine I'm working for it it's

70
00:03:45,540 --> 00:03:48,240
called Minerva labs this kind of my day

71
00:03:48,240 --> 00:03:50,970
job what you seeing here today but

72
00:03:50,970 --> 00:03:52,560
there's not like a commercial

73
00:03:52,560 --> 00:03:55,230
promotional talk so if I'm talking about

74
00:03:55,230 --> 00:03:58,560
layer it's ok it's not it's ok also I'm

75
00:03:58,560 --> 00:04:00,240
calling myself Margot psychologist

76
00:04:00,240 --> 00:04:03,000
because what I'm focusing on as the the

77
00:04:03,000 --> 00:04:06,410
fears of malware what it tries to evade

78
00:04:06,410 --> 00:04:10,580
I invented the term it's not like I'm an

79
00:04:10,580 --> 00:04:12,950
evangelist like all of those guys that

80
00:04:12,950 --> 00:04:16,560
I'm not a I'm just a malware

81
00:04:16,560 --> 00:04:19,440
psychologist senior one

82
00:04:19,440 --> 00:04:21,930
I know my way around all kind of weird

83
00:04:21,930 --> 00:04:25,470
exotic languages like Python and Java

84
00:04:25,470 --> 00:04:28,980
and I know like a bit more useful ones

85
00:04:28,980 --> 00:04:33,840
like Arabic also other Arabic speakers

86
00:04:33,840 --> 00:04:36,290
in the crowd

87
00:04:36,290 --> 00:04:40,320
hello Salafi khumba Manasa but hax first

88
00:04:40,320 --> 00:04:44,790
and finished about - so yeah and also

89
00:04:44,790 --> 00:04:48,330
I've learned another nicer linguistic

90
00:04:48,330 --> 00:04:52,010
joke which I thought I'll do here Dave

91
00:04:52,010 --> 00:04:55,500
as JFK did and it's like visiting Berlin

92
00:04:55,500 --> 00:04:57,690
he said bin ein Berliner

93
00:04:57,690 --> 00:05:01,530
right so ich bin eine québécois right

94
00:05:01,530 --> 00:05:05,700
epic war is the term yeah so another

95
00:05:05,700 --> 00:05:10,740
nice linguistic thing and I did tons of

96
00:05:10,740 --> 00:05:14,490
stuff from PowerShell little strips to

97
00:05:14,490 --> 00:05:19,980
attacking SCADA systems that's it's all

98
00:05:19,980 --> 00:05:22,740
important but what I like about this

99
00:05:22,740 --> 00:05:26,310
target all the like the different stuff

100
00:05:26,310 --> 00:05:31,919
I did they all have some kind of common

101
00:05:31,919 --> 00:05:35,910
ground they are all tried to to evade

102
00:05:35,910 --> 00:05:39,260
some some points and this allows us to

103
00:05:39,260 --> 00:05:42,360
vaccinate against you'll see it later on

104
00:05:42,360 --> 00:05:44,910
in stock it will be much more clear so I

105
00:05:44,910 --> 00:05:47,190
just want to follow me or ask me

106
00:05:47,190 --> 00:05:49,400
questions this is my Twitter by the way

107
00:05:49,400 --> 00:05:52,169
if we need to take any photos doing to

108
00:05:52,169 --> 00:05:55,770
talk feel free I don't mind it's a bit

109
00:05:55,770 --> 00:05:57,720
too fast sometimes there are a lot of

110
00:05:57,720 --> 00:06:04,650
links doing talk feel free to do so okay

111
00:06:04,650 --> 00:06:07,160
so let's start with what is the honeypot

112
00:06:07,160 --> 00:06:10,620
we'll do it the James Bond style you can

113
00:06:10,620 --> 00:06:13,800
see on the right side it's Sean Connery

114
00:06:13,800 --> 00:06:16,410
and on the left side as xenia onatopp

115
00:06:16,410 --> 00:06:19,830
from the classic Goldeneye so she's the

116
00:06:19,830 --> 00:06:23,040
honeypot it's a bit statistic and James

117
00:06:23,040 --> 00:06:24,780
Bond is known to be some kind of made

118
00:06:24,780 --> 00:06:27,990
surgeon istic scumbag but well she is

119
00:06:27,990 --> 00:06:32,560
the honeypot she abuses James like

120
00:06:32,560 --> 00:06:37,190
his lifetime no hunger for beautiful

121
00:06:37,190 --> 00:06:40,370
dangerous woman and she's always the

122
00:06:40,370 --> 00:06:42,170
first girl to appear and Bond movie

123
00:06:42,170 --> 00:06:45,530
she's doing like this little dance and

124
00:06:45,530 --> 00:06:48,530
she looks like a cat for James and then

125
00:06:48,530 --> 00:06:50,930
he comes over but then most of the time

126
00:06:50,930 --> 00:06:53,270
he realizes though you're not what I

127
00:06:53,270 --> 00:06:56,750
thought you are so been you know more

128
00:06:56,750 --> 00:07:01,790
zhenya want to talk and that's like what

129
00:07:01,790 --> 00:07:05,030
happens to most of our movies and and in

130
00:07:05,030 --> 00:07:07,760
life most of the times there are good

131
00:07:07,760 --> 00:07:12,740
products which do honeypot related kind

132
00:07:12,740 --> 00:07:16,010
of stuff but this happens quite a lot so

133
00:07:16,010 --> 00:07:18,500
this is the honeypot what is an anti

134
00:07:18,500 --> 00:07:22,190
honeypot well I like to think about anti

135
00:07:22,190 --> 00:07:26,150
honeypot as a very natural approach of

136
00:07:26,150 --> 00:07:30,020
repelling attackers you can see those

137
00:07:30,020 --> 00:07:32,690
two snakes here and this photo it's

138
00:07:32,690 --> 00:07:35,330
quite easy to differentiate one from

139
00:07:35,330 --> 00:07:37,790
another and one of the the milk snake

140
00:07:37,790 --> 00:07:41,090
and one is the coral snake once venomous

141
00:07:41,090 --> 00:07:45,110
and the other is not the one which is

142
00:07:45,110 --> 00:07:47,780
not which thinks that the milk snake he

143
00:07:47,780 --> 00:07:50,090
tries to mimic the one which is venomous

144
00:07:50,090 --> 00:07:53,330
and by that he repels the kind of I know

145
00:07:53,330 --> 00:07:56,930
birds or whatever that tries to attack

146
00:07:56,930 --> 00:07:58,910
it by just looking like one which is

147
00:07:58,910 --> 00:08:03,140
dangerous this becomes tough we are

148
00:08:03,140 --> 00:08:05,180
gonna do today you know to repel

149
00:08:05,180 --> 00:08:07,400
checkers from our computer we will look

150
00:08:07,400 --> 00:08:12,110
like we are venomous poisonous we'll do

151
00:08:12,110 --> 00:08:14,660
our best and by that we will repel

152
00:08:14,660 --> 00:08:17,720
real-life threats and a lot of them

153
00:08:17,720 --> 00:08:21,830
actually there's another example of two

154
00:08:21,830 --> 00:08:25,010
butterflies it's called by the way

155
00:08:25,010 --> 00:08:28,730
Bayesian mimicry I think so

156
00:08:28,730 --> 00:08:33,559
this kind of butterflies it was recently

157
00:08:33,559 --> 00:08:35,840
announced that it is not this guy it's

158
00:08:35,840 --> 00:08:38,659
like a really biological thing but it's

159
00:08:38,659 --> 00:08:40,969
not the exact kind of mimicry but also

160
00:08:40,969 --> 00:08:44,460
those butterflies are at least

161
00:08:44,460 --> 00:08:48,210
like a year ago they were considered to

162
00:08:48,210 --> 00:08:50,310
be hackers there you have the the

163
00:08:50,310 --> 00:08:52,320
monarch butterfly and the Viceroy

164
00:08:52,320 --> 00:08:55,140
butterfly you can see that they look a

165
00:08:55,140 --> 00:08:59,959
bit different and it was considered that

166
00:08:59,959 --> 00:09:02,190
one of them tries to mimic the other

167
00:09:02,190 --> 00:09:04,410
which don't have to be false but who

168
00:09:04,410 --> 00:09:11,310
cares and by that some that just like

169
00:09:11,310 --> 00:09:13,380
avoided of eating it because it who I

170
00:09:13,380 --> 00:09:16,560
don't know call them like diarrhea or

171
00:09:16,560 --> 00:09:19,920
something and so yeah there are also

172
00:09:19,920 --> 00:09:23,220
hackers the they don't type color zero a

173
00:09:23,220 --> 00:09:28,790
tree but there are also kind of hackers

174
00:09:29,120 --> 00:09:33,959
okay let's take this talk to a bit more

175
00:09:33,959 --> 00:09:37,140
practical place because you know yeah

176
00:09:37,140 --> 00:09:39,779
vaccination isn't an amazing concept

177
00:09:39,779 --> 00:09:41,899
yeah it's fit it's working but it's

178
00:09:41,899 --> 00:09:43,980
working in the nature and we are not

179
00:09:43,980 --> 00:09:47,370
going to take our PC from back home and

180
00:09:47,370 --> 00:09:50,490
paint it like it was a venomous snake or

181
00:09:50,490 --> 00:09:53,130
I know paint like I'm the butterfly

182
00:09:53,130 --> 00:09:56,310
wings on it it it's most definitely

183
00:09:56,310 --> 00:09:59,370
won't work and first in order to repel

184
00:09:59,370 --> 00:10:01,020
the attackers we need to know what they

185
00:10:01,020 --> 00:10:05,190
are afraid of and I did this work of

186
00:10:05,190 --> 00:10:08,520
categorizing their fears I started about

187
00:10:08,520 --> 00:10:11,160
a couple of years ago and recently I

188
00:10:11,160 --> 00:10:13,290
found a new fear of malware so didn't

189
00:10:13,290 --> 00:10:16,650
like it for plus plus ways to repel bad

190
00:10:16,650 --> 00:10:21,990
guys let's start with the first fear you

191
00:10:21,990 --> 00:10:24,330
guys in the crowd how many of you are

192
00:10:24,330 --> 00:10:29,970
blue teamers at least yeah yeah so more

193
00:10:29,970 --> 00:10:34,220
than one they're afraid of you and

194
00:10:34,220 --> 00:10:36,860
different panelists they're afraid of

195
00:10:36,860 --> 00:10:39,270
anyone who tries to dissect them they're

196
00:10:39,270 --> 00:10:41,399
afraid of running in sandbox you're not

197
00:10:41,399 --> 00:10:43,079
actually afraid they just think it's

198
00:10:43,079 --> 00:10:45,480
more cost-effective not to be executed

199
00:10:45,480 --> 00:10:47,850
in a sandbox because then they'll be

200
00:10:47,850 --> 00:10:50,910
captured and analyzed and all of their

201
00:10:50,910 --> 00:10:55,829
extensive array of VPNs and VPS and God

202
00:10:55,829 --> 00:10:58,410
knows what which they really try

203
00:10:58,410 --> 00:11:01,019
hard to set up it will be wasted and

204
00:11:01,019 --> 00:11:03,329
it's expensive and if you are a cyber

205
00:11:03,329 --> 00:11:06,000
crime gang well you want to be cost

206
00:11:06,000 --> 00:11:07,639
efficient because you have competition

207
00:11:07,639 --> 00:11:11,040
it's like a real really competitive

208
00:11:11,040 --> 00:11:14,129
market I think so they're afraid of

209
00:11:14,129 --> 00:11:16,620
first like virtualized and analysis

210
00:11:16,620 --> 00:11:19,050
environments sometimes they try to

211
00:11:19,050 --> 00:11:21,720
measly that reverse it directly if you

212
00:11:21,720 --> 00:11:24,060
manually analyze them sometimes they

213
00:11:24,060 --> 00:11:26,490
want to fool like automated analysis

214
00:11:26,490 --> 00:11:29,899
tools like sandbox they seek hints for

215
00:11:29,899 --> 00:11:33,569
either static and dynamic analysis tools

216
00:11:33,569 --> 00:11:38,310
like Ida Ida Pro or Wireshark which is

217
00:11:38,310 --> 00:11:40,709
dynamic it's a sniffer now but debugger

218
00:11:40,709 --> 00:11:43,199
ism they seek for the actual

219
00:11:43,199 --> 00:11:46,339
infrastructure for VirtualBox for vmware

220
00:11:46,339 --> 00:11:51,529
for AQ mvu and all this kind of stuff

221
00:11:51,529 --> 00:11:55,649
it's been out there for years now this

222
00:11:55,649 --> 00:11:59,279
little snippet it's a very simple vision

223
00:11:59,279 --> 00:12:02,970
technique it's like finding a window of

224
00:12:02,970 --> 00:12:08,040
all et bugger or windbg and it's been

225
00:12:08,040 --> 00:12:12,120
out there since blackhat 2007 it's over

226
00:12:12,120 --> 00:12:15,149
10 years old so it's not a kind of a

227
00:12:15,149 --> 00:12:17,670
cutting-edge technique you don't need

228
00:12:17,670 --> 00:12:20,759
you you can evade this way from like

229
00:12:20,759 --> 00:12:23,660
automated analysis and manual analysis

230
00:12:23,660 --> 00:12:26,610
although this kind of stuff I found a

231
00:12:26,610 --> 00:12:29,040
bit like salting because I know that

232
00:12:29,040 --> 00:12:31,589
when I debug male work I look exactly

233
00:12:31,589 --> 00:12:34,050
for this kind of stuff and well dude you

234
00:12:34,050 --> 00:12:35,220
must be kidding me if you're doing this

235
00:12:35,220 --> 00:12:37,410
kind of stuff I'm debugging you using a

236
00:12:37,410 --> 00:12:39,689
debugger so I can see where I'm doing

237
00:12:39,689 --> 00:12:43,259
this kind of stuff but just my personal

238
00:12:43,259 --> 00:12:49,759
idea about it so another example from

239
00:12:49,759 --> 00:12:53,250
this is the lucky sample from bit more

240
00:12:53,250 --> 00:12:55,699
than a year ago

241
00:12:55,699 --> 00:12:58,259
are there any asking injures in the

242
00:12:58,259 --> 00:12:59,449
crowd

243
00:12:59,449 --> 00:13:03,600
well if you look up close you will see

244
00:13:03,600 --> 00:13:06,000
that there's like a really complex

245
00:13:06,000 --> 00:13:09,779
jumping array over here and

246
00:13:09,779 --> 00:13:14,249
it's just like if it's match of like car

247
00:13:14,249 --> 00:13:18,810
by car string which it gets through get

248
00:13:18,810 --> 00:13:22,050
username a it will germinate but only if

249
00:13:22,050 --> 00:13:24,779
all the roads out found and if you

250
00:13:24,779 --> 00:13:27,050
translated that's fing down here from

251
00:13:27,050 --> 00:13:31,230
from ASCII to you know human readable

252
00:13:31,230 --> 00:13:35,279
stuff it will be sandbox so this lucky

253
00:13:35,279 --> 00:13:38,339
sample will never run on your machine if

254
00:13:38,339 --> 00:13:40,800
you use named sandbox I actually

255
00:13:40,800 --> 00:13:43,079
considered changing my his name back

256
00:13:43,079 --> 00:13:46,589
home and at my grandma's PC to sandbox

257
00:13:46,589 --> 00:13:49,019
to avoid this kind of stuff it would

258
00:13:49,019 --> 00:13:51,209
work if you know about like the recent

259
00:13:51,209 --> 00:13:54,480
emote at which wreak havoc look up close

260
00:13:54,480 --> 00:13:56,459
if its source but enough exhausted like

261
00:13:56,459 --> 00:13:59,790
I think it Jo sandbox have a really good

262
00:13:59,790 --> 00:14:02,399
D compilation of its source code and is

263
00:14:02,399 --> 00:14:03,839
afraid of the exactly the same thing

264
00:14:03,839 --> 00:14:11,910
just FYI so yeah a bit more recent

265
00:14:11,910 --> 00:14:14,790
example you all know want to cry but

266
00:14:14,790 --> 00:14:19,829
have you heard about you iwi X no and

267
00:14:19,829 --> 00:14:24,120
there was a bit of talked about it wanna

268
00:14:24,120 --> 00:14:26,009
cry you could have got the sample of it

269
00:14:26,009 --> 00:14:28,050
you just needed to set up an SMB honey

270
00:14:28,050 --> 00:14:31,110
pot but you iwi acts on the other hand

271
00:14:31,110 --> 00:14:34,319
it was a bit more smart so researchers

272
00:14:34,319 --> 00:14:36,449
had really tough time finding a sample

273
00:14:36,449 --> 00:14:41,069
of it and why it's just like copy pasted

274
00:14:41,069 --> 00:14:43,649
code from repositories it's dislike its

275
00:14:43,649 --> 00:14:46,259
did the is debugger present it searched

276
00:14:46,259 --> 00:14:50,730
for pipes at search for load modules and

277
00:14:50,730 --> 00:14:54,139
for average loaded model sorry for files

278
00:14:54,139 --> 00:14:56,790
the most elementary stuff you can think

279
00:14:56,790 --> 00:15:00,149
about I actually was able to find the

280
00:15:00,149 --> 00:15:02,579
the source where it you know copy/paste

281
00:15:02,579 --> 00:15:05,790
it from this like almost the exactly

282
00:15:05,790 --> 00:15:10,019
same order else and this also as almost

283
00:15:10,019 --> 00:15:14,249
the same order it's amazing to see how

284
00:15:14,249 --> 00:15:16,769
easy it is to be stealth fear like

285
00:15:16,769 --> 00:15:18,990
almost totally completely stealth

286
00:15:18,990 --> 00:15:21,389
because it was never observed almost in

287
00:15:21,389 --> 00:15:22,740
the wild

288
00:15:22,740 --> 00:15:25,950
and they did have an operation so I

289
00:15:25,950 --> 00:15:27,930
guess that they were able to infect guys

290
00:15:27,930 --> 00:15:30,000
they used internal eternal blue and

291
00:15:30,000 --> 00:15:34,589
double pulsar so like everyone else they

292
00:15:34,589 --> 00:15:38,700
must have some kind of success this

293
00:15:38,700 --> 00:15:40,920
one's a bit even more extreme you can

294
00:15:40,920 --> 00:15:43,680
see that the exact same pattern you see

295
00:15:43,680 --> 00:15:46,470
here by the way with way too much back

296
00:15:46,470 --> 00:15:49,470
slashes somehow windows kinda scenes

297
00:15:49,470 --> 00:15:52,560
handles it but you can see the exact

298
00:15:52,560 --> 00:15:56,120
same order over here and over here and

299
00:15:56,120 --> 00:16:00,930
funny enough where this arrow points you

300
00:16:00,930 --> 00:16:03,360
can see that both of those also copies

301
00:16:03,360 --> 00:16:05,040
from each other because they all also

302
00:16:05,040 --> 00:16:08,459
have this closing bracket thingy over

303
00:16:08,459 --> 00:16:11,700
there and well I know who copied from

304
00:16:11,700 --> 00:16:15,230
who but also and have a cop based job

305
00:16:15,230 --> 00:16:17,640
all the artifacts relates to

306
00:16:17,640 --> 00:16:19,940
virtualization infrastructure like

307
00:16:19,940 --> 00:16:21,360
cuckoo

308
00:16:21,360 --> 00:16:23,880
I think cuckoo wasn't free via slide and

309
00:16:23,880 --> 00:16:25,890
here it's just like either a VMware or

310
00:16:25,890 --> 00:16:28,220
VirtualBox

311
00:16:28,220 --> 00:16:31,740
again nothing new it's all known it's a

312
00:16:31,740 --> 00:16:34,170
colleague based job I have actually

313
00:16:34,170 --> 00:16:36,060
another talk about writing metal from

314
00:16:36,060 --> 00:16:38,670
scratch using copy paste but this one

315
00:16:38,670 --> 00:16:43,529
for maybe next year well next year

316
00:16:43,529 --> 00:16:46,080
they're also afraid of have like blue

317
00:16:46,080 --> 00:16:48,930
teamers but the other way around

318
00:16:48,930 --> 00:16:51,600
today you have great security products

319
00:16:51,600 --> 00:16:53,700
some of them are more expensive than

320
00:16:53,700 --> 00:16:55,290
others some are less expensive some of

321
00:16:55,290 --> 00:16:58,380
them for free but bad guys can test

322
00:16:58,380 --> 00:17:01,470
their stuff offline they can learn you

323
00:17:01,470 --> 00:17:06,900
let's say a bank buys your I know let's

324
00:17:06,900 --> 00:17:10,859
say say if ISA whatever product and

325
00:17:10,859 --> 00:17:13,800
severe large bank so II said will have

326
00:17:13,800 --> 00:17:15,959
the logo of this Bank in a web site or

327
00:17:15,959 --> 00:17:18,569
web I know Bank of America is using our

328
00:17:18,569 --> 00:17:23,160
products and well bad guys can I have

329
00:17:23,160 --> 00:17:24,630
not move east by the way they're

330
00:17:24,630 --> 00:17:26,760
actually a product but then that guys

331
00:17:26,760 --> 00:17:29,970
can just offline how we're doing against

332
00:17:29,970 --> 00:17:34,679
them are we good are we not and they can

333
00:17:34,679 --> 00:17:35,400
decide

334
00:17:35,400 --> 00:17:38,130
based on the results of their execution

335
00:17:38,130 --> 00:17:42,080
in their lab against this products well

336
00:17:42,080 --> 00:17:48,090
should we or shouldn't we yeah in most

337
00:17:48,090 --> 00:17:50,280
cases they won't meet all the products

338
00:17:50,280 --> 00:17:52,860
but we had a case of Tesla crypt and

339
00:17:52,860 --> 00:17:55,950
lucky a different variant of lucky from

340
00:17:55,950 --> 00:17:58,800
roughly a couple of years ago where they

341
00:17:58,800 --> 00:18:02,460
executed in all cases other than if

342
00:18:02,460 --> 00:18:04,470
there was a registry key associated with

343
00:18:04,470 --> 00:18:08,730
ESET Kaspersky Lab or not G data it was

344
00:18:08,730 --> 00:18:11,340
a vast I have the sample here for life

345
00:18:11,340 --> 00:18:13,790
demo later on I'll show it to you live

346
00:18:13,790 --> 00:18:15,990
well they know that they bypass like

347
00:18:15,990 --> 00:18:18,720
nine percent of the AVS and they have

348
00:18:18,720 --> 00:18:20,610
their operation ready to go and it's

349
00:18:20,610 --> 00:18:24,630
expensive to you know don't press the

350
00:18:24,630 --> 00:18:26,429
button but then you have a very costly

351
00:18:26,429 --> 00:18:29,250
infrastructure setup so and as we said

352
00:18:29,250 --> 00:18:31,650
you need to be cost effective so well we

353
00:18:31,650 --> 00:18:35,610
can be afraid of only two vendors and

354
00:18:35,610 --> 00:18:38,880
still be very effective so why not let's

355
00:18:38,880 --> 00:18:41,610
just see if those registry values are

356
00:18:41,610 --> 00:18:44,400
present and by that will decide if we

357
00:18:44,400 --> 00:18:48,840
execute or not and some examples for

358
00:18:48,840 --> 00:18:52,410
similar one similar mail well which did

359
00:18:52,410 --> 00:18:55,679
it it's not petia by the way am I not

360
00:18:55,679 --> 00:18:57,720
going to speak about the affiliation of

361
00:18:57,720 --> 00:19:00,540
not paid yeah or bad rabbit but not paid

362
00:19:00,540 --> 00:19:02,490
you actually checked if there are

363
00:19:02,490 --> 00:19:05,340
specific processes related to Norton

364
00:19:05,340 --> 00:19:10,470
Simon packages same and Kaspersky it was

365
00:19:10,470 --> 00:19:12,809
a bit complex they did a real nice trick

366
00:19:12,809 --> 00:19:16,890
using a white mask you know the bottom

367
00:19:16,890 --> 00:19:21,470
line is that they you know they had like

368
00:19:21,470 --> 00:19:23,180
five D

369
00:19:23,180 --> 00:19:26,390
capabilities and if you had Kaspersky

370
00:19:26,390 --> 00:19:28,790
specific ones won't be executing if you

371
00:19:28,790 --> 00:19:30,410
had known and semantics other ones won't

372
00:19:30,410 --> 00:19:32,210
be executed I did all of the bits

373
00:19:32,210 --> 00:19:35,180
calculation over there in a table and if

374
00:19:35,180 --> 00:19:38,180
you had ever Kaspersky or not--and slash

375
00:19:38,180 --> 00:19:40,220
simatech you had a really good chance

376
00:19:40,220 --> 00:19:42,770
that it won't fit if you NPR or will

377
00:19:42,770 --> 00:19:45,890
propagate through your network which is

378
00:19:45,890 --> 00:19:48,710
amazing just like by having specific AV

379
00:19:48,710 --> 00:19:51,920
which doesn't prevent anything the

380
00:19:51,920 --> 00:19:55,060
malware will decide not to attack you

381
00:19:55,060 --> 00:20:00,770
and well this prevents like 20% of stuff

382
00:20:00,770 --> 00:20:03,350
but later on we'll see how we can create

383
00:20:03,350 --> 00:20:05,600
this kind of indicators that will make

384
00:20:05,600 --> 00:20:10,370
the malware be afraid to prevent even

385
00:20:10,370 --> 00:20:13,580
40% of the capability of the Medway it's

386
00:20:13,580 --> 00:20:15,500
not like amazing but think about most

387
00:20:15,500 --> 00:20:20,630
damage won't be done that rabbit just

388
00:20:20,630 --> 00:20:23,330
the same again nothing about affiliation

389
00:20:23,330 --> 00:20:28,070
or I'm not trying to yeah it's the

390
00:20:28,070 --> 00:20:30,200
Russians not sorry and that God knows

391
00:20:30,200 --> 00:20:33,590
who but it's exactly the same trick they

392
00:20:33,590 --> 00:20:35,990
calculated some kind of a custom hash

393
00:20:35,990 --> 00:20:38,660
and compared it and they did of the same

394
00:20:38,660 --> 00:20:40,490
bytes calculations

395
00:20:40,490 --> 00:20:44,510
Kaspersky released the I think it was

396
00:20:44,510 --> 00:20:46,610
guess first yes from secure list they

397
00:20:46,610 --> 00:20:48,320
released the all the process of its

398
00:20:48,320 --> 00:20:52,340
either dr. Webb or McAfee in this case

399
00:20:52,340 --> 00:20:56,270
and actually the I did the test in my

400
00:20:56,270 --> 00:20:58,970
lab and it will keep executing no matter

401
00:20:58,970 --> 00:21:02,210
what but it's won't rip the disc locally

402
00:21:02,210 --> 00:21:04,460
the MBR will still be destroyed so it's

403
00:21:04,460 --> 00:21:07,660
not that helpful in this case that you

404
00:21:07,660 --> 00:21:10,370
can trade all those processes and maybe

405
00:21:10,370 --> 00:21:13,310
you the next not bad rabbit petia

406
00:21:13,310 --> 00:21:15,530
something will be prevented by it just

407
00:21:15,530 --> 00:21:18,850
like vaccinating your machine with

408
00:21:18,850 --> 00:21:22,040
random processes

409
00:21:22,040 --> 00:21:26,840
and by the way I released I rewrote the

410
00:21:26,840 --> 00:21:30,560
the hashing that was used by bad rabbit

411
00:21:30,560 --> 00:21:33,230
in Python I did a little experiment

412
00:21:33,230 --> 00:21:36,170
brute forcing it but Kaspersky released

413
00:21:36,170 --> 00:21:38,240
the results before me so if you want to

414
00:21:38,240 --> 00:21:40,130
see it is available and my kid have

415
00:21:40,130 --> 00:21:42,760
account under a good rabbit

416
00:21:42,760 --> 00:21:49,850
yeah and have a joke ok next we're at

417
00:21:49,850 --> 00:21:51,320
the first image of a cat in the

418
00:21:51,320 --> 00:21:54,140
slideshow by the way we have we have

419
00:21:54,140 --> 00:21:56,180
like cartoons back in the first line but

420
00:21:56,180 --> 00:22:00,500
no matter that guys are also afraid from

421
00:22:00,500 --> 00:22:02,660
themselves dislike the classic

422
00:22:02,660 --> 00:22:04,670
vaccination it's a subclass of

423
00:22:04,670 --> 00:22:07,340
vaccination actually they create

424
00:22:07,340 --> 00:22:09,920
infection markers to avoid infecting the

425
00:22:09,920 --> 00:22:12,230
same machine twice because garden hose

426
00:22:12,230 --> 00:22:14,810
what happens if you encrypt like with

427
00:22:14,810 --> 00:22:17,690
two multi-threaded ransomware the same

428
00:22:17,690 --> 00:22:20,870
machine twice like what is the first

429
00:22:20,870 --> 00:22:22,190
private kid

430
00:22:22,190 --> 00:22:24,200
what was the first like private and

431
00:22:24,200 --> 00:22:26,990
public and then the AES and you don't

432
00:22:26,990 --> 00:22:29,660
know what was encrypted when it's like

433
00:22:29,660 --> 00:22:32,600
awful awful thing so you use infection

434
00:22:32,600 --> 00:22:34,880
marker and if you start to infect a

435
00:22:34,880 --> 00:22:38,330
machine you won't do it again because

436
00:22:38,330 --> 00:22:41,720
you don't want to make like then the

437
00:22:41,720 --> 00:22:43,640
encryption irreversible or you don't

438
00:22:43,640 --> 00:22:45,890
want to execute two instances of Trojan

439
00:22:45,890 --> 00:22:48,760
horses because maybe if you are abiding

440
00:22:48,760 --> 00:22:51,890
binding the TCP port you'll get an error

441
00:22:51,890 --> 00:22:53,750
because you can't find the speed say

442
00:22:53,750 --> 00:22:56,510
this report twice do the same address

443
00:22:56,510 --> 00:23:01,400
because you know physics they've

444
00:23:01,400 --> 00:23:02,900
sometimes do it properly they sometimes

445
00:23:02,900 --> 00:23:06,170
do it less than properly taken for

446
00:23:06,170 --> 00:23:09,260
example hold the TCP port at the mutex

447
00:23:09,260 --> 00:23:11,600
but most of the times used and actually

448
00:23:11,600 --> 00:23:13,600
problem unix

449
00:23:13,600 --> 00:23:17,090
there are so so many examples for it

450
00:23:17,090 --> 00:23:21,350
this one is from configure which is just

451
00:23:21,350 --> 00:23:22,700
the same it's more examples you see

452
00:23:22,700 --> 00:23:24,650
later in like the next couple of slides

453
00:23:24,650 --> 00:23:27,560
and the pattern I always seek is a

454
00:23:27,560 --> 00:23:30,410
reverse engineer is get last error and

455
00:23:30,410 --> 00:23:34,190
then compare it with B seven which is a

456
00:23:34,190 --> 00:23:35,700
already exist

457
00:23:35,700 --> 00:23:38,279
whatever this means that the music's

458
00:23:38,279 --> 00:23:40,860
already exist and then you can see the

459
00:23:40,860 --> 00:23:43,080
exit process called like couple lines

460
00:23:43,080 --> 00:23:45,659
later it just moves pretty small so just

461
00:23:45,659 --> 00:23:49,169
trust me but always seek for this

462
00:23:49,169 --> 00:23:53,490
pattern another one which is a bit more

463
00:23:53,490 --> 00:23:57,510
contemporary this is an average yes yet

464
00:23:57,510 --> 00:24:00,419
another lucky example from very very

465
00:24:00,419 --> 00:24:04,950
early example lucky by this one is from

466
00:24:04,950 --> 00:24:08,130
a guy named sylveon I can't pronounce

467
00:24:08,130 --> 00:24:14,370
his last name sorry guys that's like

468
00:24:14,370 --> 00:24:16,830
amazing what he did here what like the

469
00:24:16,830 --> 00:24:17,789
bad guys did here

470
00:24:17,789 --> 00:24:20,519
they created a registry key called

471
00:24:20,519 --> 00:24:23,370
completed with a value which was either

472
00:24:23,370 --> 00:24:27,450
true or false it was under hklm software

473
00:24:27,450 --> 00:24:30,120
naki they actually did amazing software

474
00:24:30,120 --> 00:24:32,190
engineering here I would done exactly

475
00:24:32,190 --> 00:24:33,480
the same if I had like a commercial

476
00:24:33,480 --> 00:24:37,380
product called lucky I guess and if he

477
00:24:37,380 --> 00:24:40,230
created the same value and the same key

478
00:24:40,230 --> 00:24:42,870
in advance and the completed was set to

479
00:24:42,870 --> 00:24:45,299
true it won a trip to a machine but it

480
00:24:45,299 --> 00:24:47,130
is a radiant ripped one the registry

481
00:24:47,130 --> 00:24:49,110
value saver sure so yeah it's a writing

482
00:24:49,110 --> 00:24:53,190
cryptid so and if I create in advance I

483
00:24:53,190 --> 00:24:55,710
know that there is like a large Loki

484
00:24:55,710 --> 00:24:58,740
outbreak and i vaccinate endpoints

485
00:24:58,740 --> 00:25:01,620
against this outbreak by creating this

486
00:25:01,620 --> 00:25:04,559
registry key I'm winning the game no

487
00:25:04,559 --> 00:25:06,659
matter which Packer you used which

488
00:25:06,659 --> 00:25:08,460
obfuscation infection back to the

489
00:25:08,460 --> 00:25:10,649
payload it's same payload it's going to

490
00:25:10,649 --> 00:25:12,630
check this registry value I'm the same

491
00:25:12,630 --> 00:25:16,409
rent registry key and I can prevent it

492
00:25:16,409 --> 00:25:22,529
from it running display so yeah there

493
00:25:22,529 --> 00:25:25,380
are a bit more like recent examples like

494
00:25:25,380 --> 00:25:29,490
spora spore was this Hoffler text font

495
00:25:29,490 --> 00:25:31,510
wasn't found

496
00:25:31,510 --> 00:25:36,610
thank it also the same thing it's such a

497
00:25:36,610 --> 00:25:39,900
search actually a mutex which was M

498
00:25:39,900 --> 00:25:42,850
concatenated with the volume serial

499
00:25:42,850 --> 00:25:46,690
number in decimal format we released uh

500
00:25:46,690 --> 00:25:49,150
like our guys back home released a

501
00:25:49,150 --> 00:25:52,020
vaccination against it you want you can

502
00:25:52,020 --> 00:25:54,400
use it I think spore is no longer a

503
00:25:54,400 --> 00:25:58,270
thing now but it's nice to have publicly

504
00:25:58,270 --> 00:26:03,390
it's of course open source etc wanna cry

505
00:26:03,390 --> 00:26:07,030
again one of the largest infection yeah

506
00:26:07,030 --> 00:26:11,470
we we had this nice little guy met with

507
00:26:11,470 --> 00:26:15,250
check vlog which is currently under I

508
00:26:15,250 --> 00:26:17,080
think like Criminal Investigation or

509
00:26:17,080 --> 00:26:18,540
something

510
00:26:18,540 --> 00:26:21,610
he found the kill switch which wasn't

511
00:26:21,610 --> 00:26:24,100
vaccinations what kill switch but there

512
00:26:24,100 --> 00:26:27,670
was also vaccination he had mutex which

513
00:26:27,670 --> 00:26:30,010
was the same pattern you can you know

514
00:26:30,010 --> 00:26:32,050
things with larger so you can see it it

515
00:26:32,050 --> 00:26:34,510
checks for this set Emma Stone win

516
00:26:34,510 --> 00:26:37,630
whatever with an a concatenated in the

517
00:26:37,630 --> 00:26:40,300
end which is not a real mutex which you

518
00:26:40,300 --> 00:26:42,760
might see and it then you can see like

519
00:26:42,760 --> 00:26:44,590
the guess let's get this error and

520
00:26:44,590 --> 00:26:47,860
compare EAX with v7 which is what I said

521
00:26:47,860 --> 00:26:51,280
you should always look for and if you

522
00:26:51,280 --> 00:26:54,280
created this mutex wanna cry won't run

523
00:26:54,280 --> 00:26:56,200
your machine also in this case we

524
00:26:56,200 --> 00:26:59,050
released a nice vaccination this is a

525
00:26:59,050 --> 00:27:01,290
very interesting case because you know

526
00:27:01,290 --> 00:27:04,810
when you double-click on a sample use it

527
00:27:04,810 --> 00:27:07,420
Windows has this lovely lovely concept

528
00:27:07,420 --> 00:27:10,480
of sessions and it will run in your

529
00:27:10,480 --> 00:27:15,190
session but one cry was spread over and

530
00:27:15,190 --> 00:27:18,040
exploit and it was running and system

531
00:27:18,040 --> 00:27:21,370
privileges so if you create a script and

532
00:27:21,370 --> 00:27:23,200
you vaccinate your machine by

533
00:27:23,200 --> 00:27:25,930
double-clicking it or I know spreading

534
00:27:25,930 --> 00:27:27,180
it over

535
00:27:27,180 --> 00:27:30,550
WMI or something it won't be executed in

536
00:27:30,550 --> 00:27:32,980
the same session as wanna cry so yeah

537
00:27:32,980 --> 00:27:34,630
you can even like take the sample

538
00:27:34,630 --> 00:27:36,760
download it to your machine double-click

539
00:27:36,760 --> 00:27:38,380
the sample after you double-click on

540
00:27:38,380 --> 00:27:40,990
script of course and you can see how it

541
00:27:40,990 --> 00:27:43,420
is prevented I am vaccinated but no

542
00:27:43,420 --> 00:27:45,100
you're not because it's not running in

543
00:27:45,100 --> 00:27:45,309
the

544
00:27:45,309 --> 00:27:48,330
correct session and we have a little axe

545
00:27:48,330 --> 00:27:52,749
session about it in the last part of

546
00:27:52,749 --> 00:27:56,710
this slide of the SOI presentation but

547
00:27:56,710 --> 00:27:57,940
should be careful when you do

548
00:27:57,940 --> 00:28:01,990
vaccination it's it's not like that

549
00:28:01,990 --> 00:28:08,289
simple always yeah and yeah also not

550
00:28:08,289 --> 00:28:11,350
petia and that rabbit we have this great

551
00:28:11,350 --> 00:28:13,210
dude amid server which is a friend

552
00:28:13,210 --> 00:28:16,330
we found the donations for delve it's a

553
00:28:16,330 --> 00:28:18,070
simple fire we need to create and then

554
00:28:18,070 --> 00:28:21,129
you can get rid of girls I think it's

555
00:28:21,129 --> 00:28:22,840
not even an infection marker in bed

556
00:28:22,840 --> 00:28:25,600
rabbits case it's just like he prevents

557
00:28:25,600 --> 00:28:27,549
the capability to make it persistent and

558
00:28:27,549 --> 00:28:32,139
by that he just like it's just like

559
00:28:32,139 --> 00:28:38,259
making note freshens away and well we

560
00:28:38,259 --> 00:28:40,990
have so many cases like this I believe

561
00:28:40,990 --> 00:28:43,330
it's to be continued at least like this

562
00:28:43,330 --> 00:28:46,600
genre of infection markers we have it

563
00:28:46,600 --> 00:28:49,299
like since forever since the early 90s

564
00:28:49,299 --> 00:28:53,580
so I think we'll see much more of those

565
00:28:53,580 --> 00:28:59,590
next category of fears Russian yeah it's

566
00:28:59,590 --> 00:29:01,210
not actually like just specifically

567
00:29:01,210 --> 00:29:04,360
Russian but we need to be careful what

568
00:29:04,360 --> 00:29:06,580
we wish for when you do vaccination when

569
00:29:06,580 --> 00:29:09,309
you create all kinds of markers and you

570
00:29:09,309 --> 00:29:11,499
know many ransomware won't infect you if

571
00:29:11,499 --> 00:29:13,960
you have Russian or Ukrainian or any

572
00:29:13,960 --> 00:29:17,919
kind of Kerala keyboard well it's it's

573
00:29:17,919 --> 00:29:20,799
nice so let's all add keyboards you know

574
00:29:20,799 --> 00:29:25,090
maybe they're afraid of you know maybe

575
00:29:25,090 --> 00:29:26,860
they think this nice little fellow will

576
00:29:26,860 --> 00:29:31,299
be after them and if they infect Russian

577
00:29:31,299 --> 00:29:34,899
citizens possibly he's like really cute

578
00:29:34,899 --> 00:29:39,650
and furry I don't know why but

579
00:29:39,650 --> 00:29:42,670
other software what I like to call

580
00:29:42,670 --> 00:29:46,970
comrade targeted malware that's my

581
00:29:46,970 --> 00:29:51,650
granddad voice and they will infect you

582
00:29:51,650 --> 00:29:55,190
only if you have Russian keyboard so

583
00:29:55,190 --> 00:29:58,340
well repelling some of the attackers but

584
00:29:58,340 --> 00:30:01,820
I'm luring some other attackers so what

585
00:30:01,820 --> 00:30:05,330
is mine it's a bit of a tricky game as I

586
00:30:05,330 --> 00:30:07,580
said vaccination is nice it can be

587
00:30:07,580 --> 00:30:09,140
really good but we should be careful

588
00:30:09,140 --> 00:30:13,180
what we wish for and yeah that's like my

589
00:30:13,180 --> 00:30:17,020
last all new category of malware fears

590
00:30:17,020 --> 00:30:20,870
crypto - crystal - everywhere it's like

591
00:30:20,870 --> 00:30:23,330
my first attempt to use this meme and a

592
00:30:23,330 --> 00:30:26,810
finger there is right and crystal miner

593
00:30:26,810 --> 00:30:29,990
is the next ransomware this from like

594
00:30:29,990 --> 00:30:31,970
where I'm standing and from my point of

595
00:30:31,970 --> 00:30:35,870
view it's a quick easy money which it's

596
00:30:35,870 --> 00:30:40,280
hard to detect ransomware are where it's

597
00:30:40,280 --> 00:30:41,930
difficult today to write a proper

598
00:30:41,930 --> 00:30:44,380
ransomware

599
00:30:44,500 --> 00:30:46,910
there are a lot of like I don't know if

600
00:30:46,910 --> 00:30:48,650
it's like necessarily consumer grade

601
00:30:48,650 --> 00:30:52,100
software that handles brandsmart day but

602
00:30:52,100 --> 00:30:54,380
to do like a proper ransomware which

603
00:30:54,380 --> 00:30:57,220
will attack a properly defended

604
00:30:57,220 --> 00:31:00,970
organization it's pretty difficult to be

605
00:31:00,970 --> 00:31:03,740
and crypto miners are much more

606
00:31:03,740 --> 00:31:06,530
efficient live you know being liberated

607
00:31:06,530 --> 00:31:10,490
with little knowledge and I think it is

608
00:31:10,490 --> 00:31:13,730
we're gonna see much more of those but

609
00:31:13,730 --> 00:31:15,770
with this new malware we see new type of

610
00:31:15,770 --> 00:31:18,290
fears and crypto miners are

611
00:31:18,290 --> 00:31:22,120
interestingly afraid of test manager

612
00:31:22,120 --> 00:31:24,830
yeah your friendly neighborhood task

613
00:31:24,830 --> 00:31:28,190
manager because when you enter a website

614
00:31:28,190 --> 00:31:31,700
which uses a queen-high for somebody

615
00:31:31,700 --> 00:31:35,600
infected you with variants you know like

616
00:31:35,600 --> 00:31:38,720
a modified version of the XM r IG xml

617
00:31:38,720 --> 00:31:42,770
ring oh god knows how you call it it

618
00:31:42,770 --> 00:31:46,520
were grind your CPU many times the first

619
00:31:46,520 --> 00:31:49,010
time I browse to a website which hosts

620
00:31:49,010 --> 00:31:52,100
the coin hive script I heard a male

621
00:31:52,100 --> 00:31:53,570
worth for the first time in

622
00:31:53,570 --> 00:31:56,810
my life my CPU went crazy and I have an

623
00:31:56,810 --> 00:32:00,110
i7 so that's not like a weak CPU or

624
00:32:00,110 --> 00:32:02,720
something and the first thing I did what

625
00:32:02,720 --> 00:32:05,000
opening task manager understand what the

626
00:32:05,000 --> 00:32:06,410
hell's happening I beats again diner

627
00:32:06,410 --> 00:32:10,250
with my a-v but no it was the browser or

628
00:32:10,250 --> 00:32:13,250
so yeah chrome is is lousy and crying's

629
00:32:13,250 --> 00:32:15,500
your CPU from time time but it's not

630
00:32:15,500 --> 00:32:16,490
that crazy

631
00:32:16,490 --> 00:32:19,490
and I then eliminated tab by chap and I

632
00:32:19,490 --> 00:32:23,780
understood that a large website it's

633
00:32:23,780 --> 00:32:27,500
using coin hive I had this what the [ __ ]

634
00:32:27,500 --> 00:32:31,580
moment but this malware

635
00:32:31,580 --> 00:32:34,010
if it's this kind of detection by

636
00:32:34,010 --> 00:32:37,310
analysts like me by just searching for

637
00:32:37,310 --> 00:32:39,890
the window of evil task manager or you

638
00:32:39,890 --> 00:32:42,290
have some Russian things there which is

639
00:32:42,290 --> 00:32:46,790
test manager in Russian and whenever a

640
00:32:46,790 --> 00:32:49,370
window like this is opened it will just

641
00:32:49,370 --> 00:32:54,500
terminate which is nice there's also

642
00:32:54,500 --> 00:32:56,810
like another thing called an Vela and

643
00:32:56,810 --> 00:32:59,390
variants also a Russian task manager

644
00:32:59,390 --> 00:33:02,590
some sort this was taken from a campaign

645
00:33:02,590 --> 00:33:05,660
we unveiled a couple of weeks ago called

646
00:33:05,660 --> 00:33:07,490
the water miner I don't know if you've

647
00:33:07,490 --> 00:33:10,240
heard about it or not it was the spread

648
00:33:10,240 --> 00:33:15,560
at the GTA mod in Russia so this is why

649
00:33:15,560 --> 00:33:18,350
they target specifically task manager in

650
00:33:18,350 --> 00:33:21,650
Russia this one variant which which

651
00:33:21,650 --> 00:33:24,620
search window this one actually search

652
00:33:24,620 --> 00:33:28,280
for task manager and NV reg Z as like

653
00:33:28,280 --> 00:33:30,770
the process name they called the create

654
00:33:30,770 --> 00:33:33,110
who helps for into snapshot the API and

655
00:33:33,110 --> 00:33:35,870
then they just iterate it over it and if

656
00:33:35,870 --> 00:33:38,090
they found the strata running it just

657
00:33:38,090 --> 00:33:41,180
terminated immediately because I don't

658
00:33:41,180 --> 00:33:43,640
want it to detect me I want to stay on

659
00:33:43,640 --> 00:33:44,930
this machine I want to make some more

660
00:33:44,930 --> 00:33:45,320
money

661
00:33:45,320 --> 00:33:50,540
it just makes perfect sense I guess well

662
00:33:50,540 --> 00:33:51,000
you

663
00:33:51,000 --> 00:33:53,580
so we know what are the fields well we

664
00:33:53,580 --> 00:33:55,260
know already what is a honey pot what is

665
00:33:55,260 --> 00:33:57,900
a hand-tied honey pot we know how to

666
00:33:57,900 --> 00:34:01,320
apply the fears in the nature to fears

667
00:34:01,320 --> 00:34:07,140
and InfoSec like kind of genre but how

668
00:34:07,140 --> 00:34:08,849
bad guys know what to bug out they don't

669
00:34:08,849 --> 00:34:11,099
look in our machine and say oh you are

670
00:34:11,099 --> 00:34:14,609
virtual your sandbox you are they over

671
00:34:14,609 --> 00:34:17,070
there or you are trying to monitor me no

672
00:34:17,070 --> 00:34:20,570
they have specific artifacts and I did

673
00:34:20,570 --> 00:34:23,070
categorization in this matter as well

674
00:34:23,070 --> 00:34:25,409
between static windows artifacts like

675
00:34:25,409 --> 00:34:29,399
registry keys and values files folders

676
00:34:29,399 --> 00:34:33,570
oh can we create persistently and this

677
00:34:33,570 --> 00:34:36,750
what makes them unique I can execute a

678
00:34:36,750 --> 00:34:40,230
simple script and just create all those

679
00:34:40,230 --> 00:34:42,899
for good and I'm okay

680
00:34:42,899 --> 00:34:46,050
I can create you know hklm software a

681
00:34:46,050 --> 00:34:52,199
vmware inc and it's there for good on

682
00:34:52,199 --> 00:34:53,879
the other hand we have dynamic windows

683
00:34:53,879 --> 00:34:56,690
artifacts which are a bit more tricky

684
00:34:56,690 --> 00:35:01,080
processors Music's of Windows like

685
00:35:01,080 --> 00:35:04,859
Windows iOS windows the window you have

686
00:35:04,859 --> 00:35:09,990
in the OS that's like a totally

687
00:35:09,990 --> 00:35:12,750
different wall because you know we can

688
00:35:12,750 --> 00:35:15,119
if we create files yeah you can create a

689
00:35:15,119 --> 00:35:17,910
file and forget about it but should we

690
00:35:17,910 --> 00:35:20,609
try to run ten thousand like Windows

691
00:35:20,609 --> 00:35:23,700
processes music serve whatever at will I

692
00:35:23,700 --> 00:35:28,380
don't think it will end good I have a

693
00:35:28,380 --> 00:35:31,050
script for it - we will try those

694
00:35:31,050 --> 00:35:33,570
scripts later in the live demo they're

695
00:35:33,570 --> 00:35:36,000
also available online and same like

696
00:35:36,000 --> 00:35:40,320
under gal beads I'll post the link is

697
00:35:40,320 --> 00:35:42,030
like in the next slide so you'll be able

698
00:35:42,030 --> 00:35:44,849
to try it as well if you want to but

699
00:35:44,849 --> 00:35:46,859
it's a bit more tricky to do this

700
00:35:46,859 --> 00:35:54,060
dynamic vaccination you might say there

701
00:35:54,060 --> 00:35:54,690
are more

702
00:35:54,690 --> 00:36:00,089
Solutions but but they're like a bit

703
00:36:00,089 --> 00:36:03,000
more commercial and I don't know about

704
00:36:03,000 --> 00:36:06,960
any product which perform with this kind

705
00:36:06,960 --> 00:36:08,849
of the dynamic vaccinations in large

706
00:36:08,849 --> 00:36:11,010
scales effectively which is not

707
00:36:11,010 --> 00:36:16,500
commercial a third category which it's

708
00:36:16,500 --> 00:36:19,319
very interesting but I'm not doing it

709
00:36:19,319 --> 00:36:21,690
it's not like a simple Python script to

710
00:36:21,690 --> 00:36:24,300
write you and also vaccinates like using

711
00:36:24,300 --> 00:36:26,640
this kind of stuff well you have low

712
00:36:26,640 --> 00:36:31,140
level tricks memory using pop codes the

713
00:36:31,140 --> 00:36:32,849
first one which I am aware of is the red

714
00:36:32,849 --> 00:36:34,490
pill by joanna rutkowska

715
00:36:34,490 --> 00:36:37,800
it's amazing it's really efficient

716
00:36:37,800 --> 00:36:40,680
I think it's efficient till the days she

717
00:36:40,680 --> 00:36:44,819
seeks for a specific that's not a spring

718
00:36:44,819 --> 00:36:46,530
it's like specific vines in the memory

719
00:36:46,530 --> 00:36:49,020
which are in constant look it's like

720
00:36:49,020 --> 00:36:51,690
amazing it's I think it's harder to find

721
00:36:51,690 --> 00:36:53,400
this kind of stuff than writing an apt

722
00:36:53,400 --> 00:37:01,470
in like some kind of way many other

723
00:37:01,470 --> 00:37:03,480
things like timing attack scoring the AL

724
00:37:03,480 --> 00:37:08,490
DTSC and trying to measure time stamp

725
00:37:08,490 --> 00:37:11,130
like different serves which are

726
00:37:11,130 --> 00:37:13,500
different between real machines and

727
00:37:13,500 --> 00:37:16,369
machines with hypervisor or you can do

728
00:37:16,369 --> 00:37:19,470
abuse for all sorts of hardware features

729
00:37:19,470 --> 00:37:21,390
you can also call the CPUID instruction

730
00:37:21,390 --> 00:37:24,780
and find like the idea that if the maker

731
00:37:24,780 --> 00:37:28,640
of the cpu which it's different and

732
00:37:28,640 --> 00:37:31,710
there are tons of stuff chung Ventana

733
00:37:31,710 --> 00:37:37,890
constant but why bother this like story

734
00:37:37,890 --> 00:37:42,500
time now those guys are the copy kittens

735
00:37:42,500 --> 00:37:45,900
they are an Iranian apt we unveiled

736
00:37:45,900 --> 00:37:49,109
about if it was over a couple of years

737
00:37:49,109 --> 00:37:51,119
ago they attacked the Israeli Ministry

738
00:37:51,119 --> 00:37:54,270
of Foreign Affairs successfully if I

739
00:37:54,270 --> 00:37:58,020
might say they took an open source

740
00:37:58,020 --> 00:38:00,210
project called the fish the paranoid

741
00:38:00,210 --> 00:38:02,819
fish if anyone aware of efficient you

742
00:38:02,819 --> 00:38:05,190
know fish yeah they've got a vac nose

743
00:38:05,190 --> 00:38:06,340
for fish

744
00:38:06,340 --> 00:38:08,480
so proficient that has a really good

745
00:38:08,480 --> 00:38:11,000
open source project quite basic but

746
00:38:11,000 --> 00:38:14,180
quite good which assist you to find out

747
00:38:14,180 --> 00:38:17,000
if your sandbox is hidden or not you

748
00:38:17,000 --> 00:38:19,610
execute it inside your sandbox and then

749
00:38:19,610 --> 00:38:21,410
you can see if it's detectable by

750
00:38:21,410 --> 00:38:25,280
malware by simple techniques so yeah it

751
00:38:25,280 --> 00:38:27,440
uses the the red field not the red field

752
00:38:27,440 --> 00:38:29,030
but other if like the timing attacks in

753
00:38:29,030 --> 00:38:31,490
hardware featured and it used all this

754
00:38:31,490 --> 00:38:35,360
kind of stuff but well it also seeks for

755
00:38:35,360 --> 00:38:37,550
files and registry keys and artifacts

756
00:38:37,550 --> 00:38:39,770
and for dynamic artifacts we talked

757
00:38:39,770 --> 00:38:42,500
about and and then the the logical

758
00:38:42,500 --> 00:38:45,230
operation of or is performed between all

759
00:38:45,230 --> 00:38:48,590
those different tests and like in real

760
00:38:48,590 --> 00:38:50,810
case like the copy kittens need because

761
00:38:50,810 --> 00:38:54,590
they copycatted fish and then if you

762
00:38:54,590 --> 00:38:56,990
successfully triggered one of the tests

763
00:38:56,990 --> 00:39:00,200
by the original fish to be true which

764
00:39:00,200 --> 00:39:01,610
means it of the sandbox

765
00:39:01,610 --> 00:39:04,700
they won't execute their apt so if I'm

766
00:39:04,700 --> 00:39:07,220
trying to if they even like sorry to

767
00:39:07,220 --> 00:39:10,070
vaccinate against even like a PT class

768
00:39:10,070 --> 00:39:13,430
Iranian malware writers I can just

769
00:39:13,430 --> 00:39:16,960
create the file c program files vmware

770
00:39:16,960 --> 00:39:22,610
it's a simple of step well now it's time

771
00:39:22,610 --> 00:39:24,160
for a good idea bad idea

772
00:39:24,160 --> 00:39:27,470
yeah I hope that you all see in any

773
00:39:27,470 --> 00:39:34,520
maniacs is kid so good idea as a blue

774
00:39:34,520 --> 00:39:38,390
Timur right not a red teamer but it's

775
00:39:38,390 --> 00:39:42,710
quite the same a good idea as a defender

776
00:39:42,710 --> 00:39:46,270
is to sorry as the other way round as a

777
00:39:46,270 --> 00:39:48,860
as a red teamer but it's all for the

778
00:39:48,860 --> 00:39:51,140
same it's blue Timur a good idea is to

779
00:39:51,140 --> 00:39:54,260
search after persistent artifacts not do

780
00:39:54,260 --> 00:39:57,680
all this kind of a problematic timing

781
00:39:57,680 --> 00:40:00,770
attacks which yeah I know I actually

782
00:40:00,770 --> 00:40:03,050
executed some of those attacks on on my

783
00:40:03,050 --> 00:40:05,660
virtual machine then it's failed I want

784
00:40:05,660 --> 00:40:08,510
to have a chance which always succeed in

785
00:40:08,510 --> 00:40:11,630
making me avoid being detected because

786
00:40:11,630 --> 00:40:14,360
if I'm detect only once my entire

787
00:40:14,360 --> 00:40:17,120
operation is gone in some cases if I'm

788
00:40:17,120 --> 00:40:19,730
an apt group

789
00:40:19,730 --> 00:40:20,750
wanna be the chocolate when you are

790
00:40:20,750 --> 00:40:22,940
running an apt you will but you try to

791
00:40:22,940 --> 00:40:26,390
postpone it as much as possible you'll

792
00:40:26,390 --> 00:40:28,490
look for the common artifacts in most

793
00:40:28,490 --> 00:40:31,190
times because they won't be changed like

794
00:40:31,190 --> 00:40:35,780
every version or two and well it's also

795
00:40:35,780 --> 00:40:38,359
good for us when we vaccinate the

796
00:40:38,359 --> 00:40:41,869
endpoint then ideas are also the same

797
00:40:41,869 --> 00:40:44,359
for both attackers and defenders because

798
00:40:44,359 --> 00:40:47,840
bad ideas is going for you know it's

799
00:40:47,840 --> 00:40:50,060
trying to detect a specific process but

800
00:40:50,060 --> 00:40:51,710
if you are starting before the other

801
00:40:51,710 --> 00:40:53,930
process then you won't detect it because

802
00:40:53,930 --> 00:40:56,510
I know it starts like one minute after

803
00:40:56,510 --> 00:40:57,590
the Machine starts and you're already

804
00:40:57,590 --> 00:41:00,170
persistent so you won't see it started

805
00:41:00,170 --> 00:41:02,869
your like test for the presence of

806
00:41:02,869 --> 00:41:06,230
specific AV will return false although

807
00:41:06,230 --> 00:41:09,230
it is installed and I can thinking about

808
00:41:09,230 --> 00:41:11,930
tons of scenarios like this our case you

809
00:41:11,930 --> 00:41:13,850
don't want to do this kind of test

810
00:41:13,850 --> 00:41:16,790
that's human behavior monitoring for

811
00:41:16,790 --> 00:41:23,810
example moving a mouse well yeah that's

812
00:41:23,810 --> 00:41:26,270
like kind of a thing that I demonstrated

813
00:41:26,270 --> 00:41:28,580
I wrote a tool called the smooth

814
00:41:28,580 --> 00:41:31,400
criminal which detects sandboxes by

815
00:41:31,400 --> 00:41:36,200
moving Mouse's it's this really bad idea

816
00:41:36,200 --> 00:41:40,310
all I did was you know what we do today

817
00:41:40,310 --> 00:41:41,780
in sandbox is just like jumping the

818
00:41:41,780 --> 00:41:44,060
mouse from one place to another and by

819
00:41:44,060 --> 00:41:46,520
that we fool malware to think there's

820
00:41:46,520 --> 00:41:49,850
real analysts moving the mouse and what

821
00:41:49,850 --> 00:41:53,750
I did as an attacker I just like did

822
00:41:53,750 --> 00:41:57,530
calculus basic calculus and I calculated

823
00:41:57,530 --> 00:42:00,020
the derivative of the location of the

824
00:42:00,020 --> 00:42:03,260
mouse which is like so it's the speed of

825
00:42:03,260 --> 00:42:07,369
the mouse and I checked if it's like if

826
00:42:07,369 --> 00:42:11,330
head has low values it's good if it has

827
00:42:11,330 --> 00:42:13,070
high value of the mouse is jumping from

828
00:42:13,070 --> 00:42:15,200
one place to another and I was able to

829
00:42:15,200 --> 00:42:19,670
define a threshold but pretend you know

830
00:42:19,670 --> 00:42:22,340
I just come it's a really short script

831
00:42:22,340 --> 00:42:25,040
it's a bad idea because I was able to

832
00:42:25,040 --> 00:42:28,640
push I open the pull request for cuoco

833
00:42:28,640 --> 00:42:32,130
which wasn't first yet but i pushed

834
00:42:32,130 --> 00:42:34,350
Kukui fix exactly for it it is very easy

835
00:42:34,350 --> 00:42:39,540
to mitigate it it's not robust at all

836
00:42:39,540 --> 00:42:43,110
and as an attacker you don't want to do

837
00:42:43,110 --> 00:42:49,560
this kind of stuff so yeah we kind of

838
00:42:49,560 --> 00:42:51,840
already talked about fenders and I want

839
00:42:51,840 --> 00:42:55,200
you to have like a good time so let's do

840
00:42:55,200 --> 00:43:04,680
a bit of demo time so I will open this

841
00:43:04,680 --> 00:43:09,330
one I have a machine just for it we'll

842
00:43:09,330 --> 00:43:12,330
see some examples of executing my script

843
00:43:12,330 --> 00:43:17,000
which is available online you can also

844
00:43:19,610 --> 00:43:26,310
let's if you wanted it's available and

845
00:43:26,310 --> 00:43:33,480
this like address and I'll read it a

846
00:43:33,480 --> 00:43:35,370
snapshot because I forgot it it before a

847
00:43:35,370 --> 00:43:41,540
talk shame on me give it a snapshot

848
00:43:41,990 --> 00:43:49,490
let's drag this direction this direction

849
00:43:49,490 --> 00:44:02,310
that direction yeah so it is my VMware

850
00:44:02,310 --> 00:44:06,020
machine I don't

851
00:44:06,020 --> 00:44:09,350
VMware tools installed so it's quite

852
00:44:09,350 --> 00:44:12,320
stuff but it's not perfect I will

853
00:44:12,320 --> 00:44:15,140
execute the fish show you how much it's

854
00:44:15,140 --> 00:44:18,710
it's a bit like a stove you can do the

855
00:44:18,710 --> 00:44:20,480
same back home if you have a sandbox

856
00:44:20,480 --> 00:44:23,450
I really recommend using the fish it's

857
00:44:23,450 --> 00:44:26,620
also open source so no worries about it

858
00:44:26,620 --> 00:44:29,510
if there's a test which is ok which

859
00:44:29,510 --> 00:44:31,550
means I'm stuff it's in green and what's

860
00:44:31,550 --> 00:44:34,280
not stuff isn't red so you'll be able to

861
00:44:34,280 --> 00:44:36,260
see that most of it is in there

862
00:44:36,260 --> 00:44:41,960
in green what kind of good let's execute

863
00:44:41,960 --> 00:44:46,570
some malware to show how catastrophic

864
00:44:46,570 --> 00:44:59,660
situation is no yeah let's go for

865
00:44:59,660 --> 00:45:06,070
example for the low key I talked about

866
00:45:06,070 --> 00:45:11,090
this one I have a proc one which is

867
00:45:11,090 --> 00:45:15,740
filtered on it and I use the magnifying

868
00:45:15,740 --> 00:45:19,299
glass because we don't have a telescope

869
00:45:20,170 --> 00:45:30,800
fire yeah that's good let's go down okay

870
00:45:30,800 --> 00:45:35,170
so yeah you can see that it searches if

871
00:45:35,170 --> 00:45:38,330
I need to use the mouse you see it on

872
00:45:38,330 --> 00:45:40,400
the top there I'm like the magnified one

873
00:45:40,400 --> 00:45:44,960
you see that it's search of if either

874
00:45:44,960 --> 00:45:48,530
ESET or a vast its installed and one's

875
00:45:48,530 --> 00:45:52,070
name is not found yeah I can't see it up

876
00:45:52,070 --> 00:45:55,640
there yeah ok just make sure it just

877
00:45:55,640 --> 00:45:58,490
like continues its execution sorry and

878
00:45:58,490 --> 00:46:01,100
it loads all too suspiciously lll then

879
00:46:01,100 --> 00:46:02,900
well the things which are more

880
00:46:02,900 --> 00:46:06,830
suspicious for a visa I guess when it is

881
00:46:06,830 --> 00:46:10,160
loaded the CNC server is already off

882
00:46:10,160 --> 00:46:13,070
lines with wonder trips but well you get

883
00:46:13,070 --> 00:46:15,890
the idea by simply creating those couple

884
00:46:15,890 --> 00:46:18,410
of registry keys you can avoid really

885
00:46:18,410 --> 00:46:21,069
nasty ransomware

886
00:46:21,589 --> 00:46:23,369
let's try another one

887
00:46:23,369 --> 00:46:27,330
I have another case here of a malware

888
00:46:27,330 --> 00:46:31,200
called iron gate it was unveiled by fire

889
00:46:31,200 --> 00:46:34,400
how do any fire I guys are proud today

890
00:46:34,400 --> 00:46:38,839
know so it's also really really simple

891
00:46:38,839 --> 00:46:42,180
it's the thing that you will do has like

892
00:46:42,180 --> 00:46:44,820
a guy who don't know what you're doing

893
00:46:44,820 --> 00:46:47,130
the first day when your boss and you're

894
00:46:47,130 --> 00:46:49,410
right I'm malware that evades VMware

895
00:46:49,410 --> 00:46:51,900
this in this case it was written in

896
00:46:51,900 --> 00:46:55,020
Python I used the decompile for why

897
00:46:55,020 --> 00:46:58,680
because it was compiled but you can see

898
00:46:58,680 --> 00:47:01,050
the actual source with the comments

899
00:47:01,050 --> 00:47:02,400
which is nuts

900
00:47:02,400 --> 00:47:06,060
but you can see that the first function

901
00:47:06,060 --> 00:47:10,740
is detect VMware and well what is this

902
00:47:10,740 --> 00:47:23,490
detect VMware well why go to yeah well

903
00:47:23,490 --> 00:47:26,369
it's the most like as I said you don't

904
00:47:26,369 --> 00:47:28,410
want to be over complexing things when

905
00:47:28,410 --> 00:47:29,160
you're right

906
00:47:29,160 --> 00:47:35,270
and yeah it's awesome yeah gnostic great

907
00:47:35,270 --> 00:47:38,430
you don't want to make things like over

908
00:47:38,430 --> 00:47:40,050
complex when you're writing a malware

909
00:47:40,050 --> 00:47:42,570
you want to evade vehicle machines they

910
00:47:42,570 --> 00:47:44,250
just likely they have a commented test

911
00:47:44,250 --> 00:47:48,950
here for the disguise ee port which is a

912
00:47:48,950 --> 00:47:51,599
really good way to find a virtual

913
00:47:51,599 --> 00:47:53,369
machine they combed it out for some

914
00:47:53,369 --> 00:47:55,680
reason and why and they haven't have a

915
00:47:55,680 --> 00:48:00,349
test year for the registry key of VMware

916
00:48:00,349 --> 00:48:03,990
which is like the most obvious thing to

917
00:48:03,990 --> 00:48:08,550
detect VMware by I have all the hashes

918
00:48:08,550 --> 00:48:11,310
of those samples in the repository I see

919
00:48:11,310 --> 00:48:12,869
that I don't have time to execute all of

920
00:48:12,869 --> 00:48:15,119
them but you can see that it's just like

921
00:48:15,119 --> 00:48:16,859
searches for the most obvious things

922
00:48:16,859 --> 00:48:21,000
like VM Mouse or something

923
00:48:21,000 --> 00:48:25,079
let's do a quick reverse snob shot I

924
00:48:25,079 --> 00:48:27,410
will vaccinate the Machine and

925
00:48:27,410 --> 00:48:31,170
afterwards we'll execute the same sample

926
00:48:31,170 --> 00:48:34,160
and we'll take all me a minute

927
00:48:34,160 --> 00:48:37,170
then you'll be able to see how you can

928
00:48:37,170 --> 00:48:40,589
avoid infections live my demo because

929
00:48:40,589 --> 00:48:53,280
it's a live demo and we're good to go

930
00:48:53,280 --> 00:48:57,750
okay so first thing I will execute my

931
00:48:57,750 --> 00:49:02,460
script over here it can get a flag if

932
00:49:02,460 --> 00:49:05,310
you want you can create only the like

933
00:49:05,310 --> 00:49:06,690
static art effect if you want you can

934
00:49:06,690 --> 00:49:09,619
create only the dynamic artifacts I

935
00:49:09,619 --> 00:49:12,300
create both of them in this demo you can

936
00:49:12,300 --> 00:49:16,380
see that like 10 processes will be

937
00:49:16,380 --> 00:49:18,660
created here in a second

938
00:49:18,660 --> 00:49:21,359
yep it's all the same executable

939
00:49:21,359 --> 00:49:23,069
duplicated over and over again and

940
00:49:23,069 --> 00:49:27,079
renamed but it works so who cares and

941
00:49:27,079 --> 00:49:31,020
let's execute it start frogman execute

942
00:49:31,020 --> 00:49:36,510
the same sample and we'll be able to see

943
00:49:36,510 --> 00:49:40,500
the difference it's not a magnifying

944
00:49:40,500 --> 00:49:48,900
glass yeah you can see in down there the

945
00:49:48,900 --> 00:49:51,980
red thing that's lucky being terminated

946
00:49:51,980 --> 00:49:55,230
it alright terminated because we saw

947
00:49:55,230 --> 00:49:58,410
those registry keys we'll see if now in

948
00:49:58,410 --> 00:50:07,680
frogmen yeah so you can see that once

949
00:50:07,680 --> 00:50:10,440
he's up there in the magnifying glass

950
00:50:10,440 --> 00:50:13,170
once it found that Easter Keys was

951
00:50:13,170 --> 00:50:16,079
created it's just like the next thing is

952
00:50:16,079 --> 00:50:18,150
a thread exit it unloads a bunch of

953
00:50:18,150 --> 00:50:21,599
stuff and process exit which is the win

954
00:50:21,599 --> 00:50:24,630
for us because our theories say yeah

955
00:50:24,630 --> 00:50:26,280
there are tons of more examples in my

956
00:50:26,280 --> 00:50:29,880
repository and tons of more examples out

957
00:50:29,880 --> 00:50:32,579
there and I assumed I don't have time

958
00:50:32,579 --> 00:50:35,090
for questions right now

959
00:50:35,090 --> 00:50:40,800
anything okay so anyway I'll be more

960
00:50:40,800 --> 00:50:43,530
than glad to take questions afterwards

961
00:50:43,530 --> 00:50:45,390
but if you have any questions right now

962
00:50:45,390 --> 00:50:51,170
I preferred the even slide for it so

963
00:50:51,170 --> 00:50:55,290
that's 9 yeah that's the second cat of

964
00:50:55,290 --> 00:50:59,990
today and the last one questions

965
00:51:14,540 --> 00:51:17,010
actually there is a good example of an

966
00:51:17,010 --> 00:51:18,630
infection marker that is created between

967
00:51:18,630 --> 00:51:21,000
malware but it's not the manual which

968
00:51:21,000 --> 00:51:23,130
shares it it's the they use a framework

969
00:51:23,130 --> 00:51:26,280
to obfuscate the code which uses an

970
00:51:26,280 --> 00:51:28,140
infection marker so they all use the

971
00:51:28,140 --> 00:51:30,090
same framework and by that they used a

972
00:51:30,090 --> 00:51:35,160
same infection marker yeah yeah and

973
00:51:35,160 --> 00:51:37,410
spora for example you have a really long

974
00:51:37,410 --> 00:51:40,050
living family of ransomware which was

975
00:51:40,050 --> 00:51:42,000
really effective and they all use the

976
00:51:42,000 --> 00:51:51,360
same Unix because why not I'm lazy also

977
00:51:51,360 --> 00:51:53,670
I understand them I wrote I did an

978
00:51:53,670 --> 00:51:55,470
entire talk about copy pasting other

979
00:51:55,470 --> 00:51:57,930
guys curves and writing malware from it

980
00:51:57,930 --> 00:52:02,250
so I'm the same so thank you I'm

981
00:52:02,250 --> 00:52:04,260
available for more questions afterwards

982
00:52:04,260 --> 00:52:06,740
if you want to

