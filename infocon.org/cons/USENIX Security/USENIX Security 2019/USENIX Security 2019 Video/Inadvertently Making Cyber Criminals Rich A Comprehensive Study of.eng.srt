1
00:00:10,580 --> 00:00:14,690
I thank you very introductory my name is

2
00:00:12,620 --> 00:00:16,070
Hawaiians mrs. Christian Dewar and we're

3
00:00:14,690 --> 00:00:18,770
from to Adele's cyber threat

4
00:00:16,070 --> 00:00:20,840
intelligence lab we are happy to present

5
00:00:18,770 --> 00:00:23,150
our work on crypto jackin which is

6
00:00:20,840 --> 00:00:25,790
called an event in it furtively making

7
00:00:23,150 --> 00:00:27,799
cyber criminals rich and in this work we

8
00:00:25,790 --> 00:00:29,720
will tell you how several criminals are

9
00:00:27,800 --> 00:00:32,239
actually making money using your PC

10
00:00:29,720 --> 00:00:35,150
without you being aware of it without

11
00:00:32,238 --> 00:00:36,739
installing anything on your PC in this

12
00:00:35,150 --> 00:00:38,750
presentation we will show how cyber

13
00:00:36,739 --> 00:00:40,550
criminals deploy these attacks and on

14
00:00:38,750 --> 00:00:42,470
which skill they are operating so first

15
00:00:40,550 --> 00:00:44,839
of all how does a crypto checking attack

16
00:00:42,470 --> 00:00:46,760
inside the browser look like well

17
00:00:44,840 --> 00:00:48,079
nothing more than just this you're an

18
00:00:46,760 --> 00:00:49,730
innocent web user and you're visiting

19
00:00:48,079 --> 00:00:52,129
for example the Pirate Bay

20
00:00:49,730 --> 00:00:54,199
the firebase deploy such a crypto mining

21
00:00:52,129 --> 00:00:56,269
script and without they installing

22
00:00:54,199 --> 00:00:59,858
anything on your computer without you

23
00:00:56,269 --> 00:01:02,300
knowing it your CPU spikes to 100% and

24
00:00:59,859 --> 00:01:04,250
you are now currently mining

25
00:01:02,300 --> 00:01:06,740
cryptocurrencies in this case Manero

26
00:01:04,250 --> 00:01:08,750
for the owners of the Pirate Bay so how

27
00:01:06,740 --> 00:01:11,509
does this actually work let's dive into

28
00:01:08,750 --> 00:01:14,660
the anatomy of a browser-based crypto

29
00:01:11,510 --> 00:01:17,030
mining um you're an instant user again

30
00:01:14,660 --> 00:01:20,300
you're going to a website by an HTTP GET

31
00:01:17,030 --> 00:01:22,970
request between response and within this

32
00:01:20,300 --> 00:01:25,880
response there's an HTML page which has

33
00:01:22,970 --> 00:01:34,480
two interesting script tags first one is

34
00:01:25,880 --> 00:01:37,850
a press the wrong button first one is

35
00:01:34,480 --> 00:01:40,580
the script tag requesting additional

36
00:01:37,850 --> 00:01:45,710
resources from KO knife bitches and

37
00:01:40,580 --> 00:01:47,929
crypto mining service this request

38
00:01:45,710 --> 00:01:49,990
fetches two additional resources one

39
00:01:47,930 --> 00:01:52,370
being a JavaScript minor which

40
00:01:49,990 --> 00:01:54,050
orchestrates the whole mining operation

41
00:01:52,370 --> 00:01:56,960
on this website and the second one being

42
00:01:54,050 --> 00:01:58,880
a highly optimized web assembly module

43
00:01:56,960 --> 00:02:01,580
which is responsible for the actual

44
00:01:58,880 --> 00:02:04,130
mining operation that takes place once

45
00:02:01,580 --> 00:02:07,100
it is loaded is it it is initialized by

46
00:02:04,130 --> 00:02:08,780
this function call which involves a site

47
00:02:07,100 --> 00:02:11,390
key and the size is very important

48
00:02:08,780 --> 00:02:14,030
because this site key is essentially the

49
00:02:11,390 --> 00:02:15,500
UH narrow wallet or account ID or

50
00:02:14,030 --> 00:02:18,560
basically the bank account of the

51
00:02:15,500 --> 00:02:21,900
attacker to which funds made by mining

52
00:02:18,560 --> 00:02:25,099
on this miner are being transferred to

53
00:02:21,900 --> 00:02:27,090
and one says I'll initialize your

54
00:02:25,099 --> 00:02:29,488
browser will set up a WebSocket

55
00:02:27,090 --> 00:02:32,640
connection to a proxy which is in come

56
00:02:29,489 --> 00:02:34,260
in contact with the blockchain for the

57
00:02:32,640 --> 00:02:37,200
currency you're mining for in this case

58
00:02:34,260 --> 00:02:40,230
one euro and then when it's all set your

59
00:02:37,200 --> 00:02:43,230
browser starts mining for the owners of

60
00:02:40,230 --> 00:02:45,209
this site key so cyber criminals can

61
00:02:43,230 --> 00:02:46,920
deploy such an attack in a number of

62
00:02:45,209 --> 00:02:48,930
different ways which we call attack

63
00:02:46,920 --> 00:02:51,208
factors and the first one is pretty

64
00:02:48,930 --> 00:02:53,400
straightforward website owner initiated

65
00:02:51,209 --> 00:02:55,079
for example the fire Bay the owners of

66
00:02:53,400 --> 00:02:58,170
this website were looking for new ways

67
00:02:55,079 --> 00:03:00,090
to profit and they deploy the crypto

68
00:02:58,170 --> 00:03:03,268
miner on their websites to let their

69
00:03:00,090 --> 00:03:05,940
visitors mind for a narrow it is also

70
00:03:03,269 --> 00:03:07,859
seen attackers hacking often popular

71
00:03:05,940 --> 00:03:09,569
websites and doing nothing more than

72
00:03:07,859 --> 00:03:14,010
just installing a crypto minor which

73
00:03:09,569 --> 00:03:16,858
mines for them and thereby using the

74
00:03:14,010 --> 00:03:18,870
visitors of this website as miners if

75
00:03:16,859 --> 00:03:22,200
we've seen this at CVS Showtime which

76
00:03:18,870 --> 00:03:24,739
was recently hacked we've also seen

77
00:03:22,200 --> 00:03:27,780
attackers deploying crypto checking

78
00:03:24,739 --> 00:03:30,030
scripts through malicious advertisements

79
00:03:27,780 --> 00:03:31,859
spread by advertisement networks so

80
00:03:30,030 --> 00:03:33,870
these advertisements include also a

81
00:03:31,859 --> 00:03:36,239
crypto checking scripts and being served

82
00:03:33,870 --> 00:03:38,040
over a large number of websites which

83
00:03:36,239 --> 00:03:40,680
was for example the case as YouTube

84
00:03:38,040 --> 00:03:42,660
which showed these advertisements we

85
00:03:40,680 --> 00:03:46,139
equipped a mining script attached to it

86
00:03:42,660 --> 00:03:49,260
to its viewers and last but not least we

87
00:03:46,139 --> 00:03:51,299
have seen attackers abusing

88
00:03:49,260 --> 00:03:53,578
vulnerabilities within the third-party

89
00:03:51,299 --> 00:03:54,319
software ecosystem for example in

90
00:03:53,579 --> 00:03:57,090
WordPress

91
00:03:54,319 --> 00:03:58,858
they exported both vulnerabilities

92
00:03:57,090 --> 00:04:01,410
within services like WordPress and

93
00:03:58,859 --> 00:04:05,400
Drupal to install crypto jacking scripts

94
00:04:01,410 --> 00:04:08,879
on these websites but it also pirated

95
00:04:05,400 --> 00:04:11,150
premium WordPress themes and include a

96
00:04:08,879 --> 00:04:13,649
crypto jacking script and by doing so

97
00:04:11,150 --> 00:04:14,940
spreading their crypto checking

98
00:04:13,650 --> 00:04:18,298
infection over a large number of

99
00:04:14,940 --> 00:04:20,099
websites so this new cyber threat has

100
00:04:18,298 --> 00:04:21,988
obviously attracted the attention of the

101
00:04:20,099 --> 00:04:23,820
academic world as we've seen a number of

102
00:04:21,988 --> 00:04:26,190
papers being published on this matter

103
00:04:23,820 --> 00:04:30,539
but they are all primarily focused on

104
00:04:26,190 --> 00:04:33,539
detecting these crypto jacking scripts

105
00:04:30,539 --> 00:04:35,219
within the browser in a more most robust

106
00:04:33,539 --> 00:04:36,930
way instead

107
00:04:35,220 --> 00:04:40,410
focusing of understanding the actual

108
00:04:36,930 --> 00:04:42,680
ecosystem additionally they estimated

109
00:04:40,410 --> 00:04:46,170
the prevalence of search greater jacking

110
00:04:42,680 --> 00:04:47,880
attacks by crawling the Alexa top 1

111
00:04:46,170 --> 00:04:49,740
million list and there are

112
00:04:47,880 --> 00:04:54,000
qualifications if air right by a factor

113
00:04:49,740 --> 00:04:55,950
of four finally they have found out that

114
00:04:54,000 --> 00:04:57,750
most prevailing attack factors were the

115
00:04:55,950 --> 00:05:00,960
compromised websites and malicious

116
00:04:57,750 --> 00:05:03,000
advertisements attack vectors well in

117
00:05:00,960 --> 00:05:05,130
this work we characterize the whole

118
00:05:03,000 --> 00:05:08,100
ecosystem of crypto jacking across a

119
00:05:05,130 --> 00:05:10,770
truly random sample of 20% of the

120
00:05:08,100 --> 00:05:13,200
Internet and quantify actor methods and

121
00:05:10,770 --> 00:05:16,710
the used attack factors of these script

122
00:05:13,200 --> 00:05:19,110
checking attacks so how do we do it

123
00:05:16,710 --> 00:05:21,690
well we first need of need a truly

124
00:05:19,110 --> 00:05:24,270
random sample of internet websites so we

125
00:05:21,690 --> 00:05:27,330
took twenty percent of all websites in

126
00:05:24,270 --> 00:05:31,950
the.com zone 20% of all websites in

127
00:05:27,330 --> 00:05:35,310
the.net zone and across 20% of our other

128
00:05:31,950 --> 00:05:38,640
1,100 theories so this result in a list

129
00:05:35,310 --> 00:05:41,190
of 55 million websites which we fed into

130
00:05:38,640 --> 00:05:45,150
our crawling infrastructure and we

131
00:05:41,190 --> 00:05:47,070
actually crawled them twice first to

132
00:05:45,150 --> 00:05:49,109
check if the mining was happening on

133
00:05:47,070 --> 00:05:52,440
that web site we used the minesweeper

134
00:05:49,110 --> 00:05:55,940
tool you published by Knopf at all last

135
00:05:52,440 --> 00:05:59,760
year at CCS which relies on webassembly

136
00:05:55,940 --> 00:06:02,240
analysis to detect whether there was

137
00:05:59,760 --> 00:06:04,650
mining happening on that page

138
00:06:02,240 --> 00:06:07,680
additionally we wanted to know how this

139
00:06:04,650 --> 00:06:09,979
mining was taking place so we use

140
00:06:07,680 --> 00:06:13,260
another crawler to extract psyches

141
00:06:09,979 --> 00:06:14,849
WebSocket proxy connections initiator

142
00:06:13,260 --> 00:06:17,250
files which start the whole mining

143
00:06:14,850 --> 00:06:19,680
operation in order to do campaign

144
00:06:17,250 --> 00:06:21,060
analysis afterwards so since the

145
00:06:19,680 --> 00:06:23,760
equipped jackin landscape is evolving

146
00:06:21,060 --> 00:06:26,729
pretty fast we deployed this on a large

147
00:06:23,760 --> 00:06:29,669
scale on 60 servers in the university

148
00:06:26,729 --> 00:06:31,530
network and we were running 720

149
00:06:29,669 --> 00:06:34,760
simultaneous crawlers for a period of

150
00:06:31,530 --> 00:06:34,760
three months

151
00:06:37,219 --> 00:06:41,248
okay so the first thing that we now did

152
00:06:39,749 --> 00:06:42,719
was we also looked at the Alexa

153
00:06:41,249 --> 00:06:44,610
one-million because that's what previous

154
00:06:42,719 --> 00:06:47,429
studies have been doing so far

155
00:06:44,610 --> 00:06:50,189
and so the CCS paper from last year not

156
00:06:47,429 --> 00:06:51,628
only he gave the crawler to detect using

157
00:06:50,189 --> 00:06:53,909
web sembly analysis but they also

158
00:06:51,629 --> 00:06:55,349
mentioned the size that were cryptid

159
00:06:53,909 --> 00:06:57,449
checking so we recrawl up ten nine

160
00:06:55,349 --> 00:06:59,699
months later and in order to see what's

161
00:06:57,449 --> 00:07:02,099
going on here as you see here in this

162
00:06:59,699 --> 00:07:03,749
graph most of the activity has actually

163
00:07:02,099 --> 00:07:06,149
stopped most of the sites are no lone

164
00:07:03,749 --> 00:07:07,559
remaining anymore and so this was

165
00:07:06,149 --> 00:07:09,269
something that we also observed when

166
00:07:07,559 --> 00:07:11,399
keeping crawling this so the reason we

167
00:07:09,269 --> 00:07:12,929
we had 700 crawlers simultaneously

168
00:07:11,399 --> 00:07:15,059
running we wanted to turn this round

169
00:07:12,929 --> 00:07:17,159
every couple of hours and crawl all of

170
00:07:15,059 --> 00:07:18,929
these sites so we did this every second

171
00:07:17,159 --> 00:07:20,909
day and we saw that a lot fluctuation

172
00:07:18,929 --> 00:07:23,219
happens yeah within these top sites

173
00:07:20,909 --> 00:07:25,558
there's a lot of mining changing and if

174
00:07:23,219 --> 00:07:28,498
you look at the total percentage there

175
00:07:25,559 --> 00:07:30,329
was like this large variation and one

176
00:07:28,499 --> 00:07:32,429
year later is even lower than that but

177
00:07:30,329 --> 00:07:34,049
the alexa one-million is just like a

178
00:07:32,429 --> 00:07:36,688
small part of the Internet's less than

179
00:07:34,049 --> 00:07:38,609
1% it is a very privileged group so how

180
00:07:36,689 --> 00:07:41,219
does this go in the entire Internet

181
00:07:38,610 --> 00:07:43,019
well when you look at the random sample

182
00:07:41,219 --> 00:07:44,759
of the Internet the 20% of everything

183
00:07:43,019 --> 00:07:48,689
you see that crypto jacking is

184
00:07:44,759 --> 00:07:50,550
relatively uncommon it's only 0.01 1% of

185
00:07:48,689 --> 00:07:52,469
all sites that are doing this so if you

186
00:07:50,550 --> 00:07:54,629
are looking at the alexa you're

187
00:07:52,469 --> 00:07:57,779
overestimating the problem by a factor

188
00:07:54,629 --> 00:08:00,360
of 5 when you break this down into

189
00:07:57,779 --> 00:08:03,229
individual TLDs you see that this

190
00:08:00,360 --> 00:08:06,389
average of 0.1 1 which is the red line

191
00:08:03,229 --> 00:08:08,519
it depends a lot on which zone you're

192
00:08:06,389 --> 00:08:10,499
looking at so for example in the Russian

193
00:08:08,519 --> 00:08:12,749
zone or the Brazilian zone crypto

194
00:08:10,499 --> 00:08:16,049
jacking is pretty common if you're

195
00:08:12,749 --> 00:08:18,089
looking at a gTLDs such as the Pro it is

196
00:08:16,049 --> 00:08:19,619
almost as high as the Alexa 1 million

197
00:08:18,089 --> 00:08:23,099
but if you look at some other zones such

198
00:08:19,619 --> 00:08:25,529
as top info org it is comparatively

199
00:08:23,099 --> 00:08:28,679
clean so that's where other interesting

200
00:08:25,529 --> 00:08:31,529
to see such a diverse manifestation of

201
00:08:28,679 --> 00:08:33,539
this problem the next thing that we can

202
00:08:31,529 --> 00:08:36,058
do is we can understand what kind of

203
00:08:33,539 --> 00:08:37,169
services are being used now so there's a

204
00:08:36,058 --> 00:08:39,269
number of different companies that

205
00:08:37,169 --> 00:08:41,188
provide the toolkit the environment for

206
00:08:39,269 --> 00:08:42,688
web-based crypto mining and we can

207
00:08:41,188 --> 00:08:43,949
determine which service is being used

208
00:08:42,688 --> 00:08:46,800
based on the indicator

209
00:08:43,950 --> 00:08:48,660
on the on the startup so let's take for

210
00:08:46,800 --> 00:08:50,969
example coin I've crypto loot and coin

211
00:08:48,660 --> 00:08:52,980
in three of the major ones they all

212
00:08:50,970 --> 00:08:56,519
provide a web assembly they all provide

213
00:08:52,980 --> 00:08:58,560
in a startup file and it depends just an

214
00:08:56,519 --> 00:09:01,800
API call on how what your going to start

215
00:08:58,560 --> 00:09:03,899
up specifically so we can now turn to

216
00:09:01,800 --> 00:09:06,120
all of these sides and see what is being

217
00:09:03,899 --> 00:09:08,370
started and how does that work when you

218
00:09:06,120 --> 00:09:10,320
look at this for the two datasets the

219
00:09:08,370 --> 00:09:12,500
Alexa 1 million and the random sample

220
00:09:10,320 --> 00:09:15,510
you see that the installation base is

221
00:09:12,500 --> 00:09:18,120
relatively similar the blue bar is coin

222
00:09:15,510 --> 00:09:19,829
hive which is the company that first

223
00:09:18,120 --> 00:09:21,720
introduced web-based crypto mining was

224
00:09:19,829 --> 00:09:23,279
the first on the market and they do have

225
00:09:21,720 --> 00:09:26,250
by far the largest market share it's

226
00:09:23,279 --> 00:09:29,310
about 40% in the top 1 million and it's

227
00:09:26,250 --> 00:09:31,260
about 50% in the random sample the

228
00:09:29,310 --> 00:09:33,569
relative ranking of the different

229
00:09:31,260 --> 00:09:35,550
services and the market shares are

230
00:09:33,570 --> 00:09:37,769
surprisingly similar so when you do

231
00:09:35,550 --> 00:09:40,519
crawl the Alexa 1 million or the random

232
00:09:37,769 --> 00:09:43,260
sample it doesn't really matter so much

233
00:09:40,519 --> 00:09:46,079
however this is just the installation

234
00:09:43,260 --> 00:09:47,850
base this is where the site was included

235
00:09:46,079 --> 00:09:49,769
which kind of service it works ping to

236
00:09:47,850 --> 00:09:51,660
however this doesn't really tell you

237
00:09:49,769 --> 00:09:53,279
anything how much turnover there is how

238
00:09:51,660 --> 00:09:55,439
much money they're making so here it

239
00:09:53,279 --> 00:09:57,689
seems my coin hive is really the biggest

240
00:09:55,440 --> 00:09:59,579
player in there in the market in order

241
00:09:57,690 --> 00:10:00,420
to answer this we need to understand how

242
00:09:59,579 --> 00:10:02,010
many sites

243
00:10:00,420 --> 00:10:03,479
I mean users actually visiting these

244
00:10:02,010 --> 00:10:05,010
sites and how much crypto mining that's

245
00:10:03,480 --> 00:10:06,540
taking place in order to figure that out

246
00:10:05,010 --> 00:10:09,300
we teamed up with a Tier one network

247
00:10:06,540 --> 00:10:11,910
operator and we collected the daily

248
00:10:09,300 --> 00:10:14,310
number of flows from client IP addresses

249
00:10:11,910 --> 00:10:16,380
towards the WebSocket progress because

250
00:10:14,310 --> 00:10:18,510
that's where they are calling in and

251
00:10:16,380 --> 00:10:21,449
they're reporting found hashes for

252
00:10:18,510 --> 00:10:23,459
retrieving the instruction files so by

253
00:10:21,449 --> 00:10:26,219
doing this we get this 15 months

254
00:10:23,459 --> 00:10:28,500
evolution of connections made to these

255
00:10:26,220 --> 00:10:31,050
web proxy service and you see coin hive

256
00:10:28,500 --> 00:10:33,690
starts that's happened in October 2017

257
00:10:31,050 --> 00:10:35,880
very soon competitors enter the market

258
00:10:33,690 --> 00:10:38,880
coin high for a while was actually a

259
00:10:35,880 --> 00:10:40,740
dominant play around April 2018 and then

260
00:10:38,880 --> 00:10:42,959
it has greatly overshadowed by coin iam

261
00:10:40,740 --> 00:10:44,730
so if you recall the last graph you see

262
00:10:42,959 --> 00:10:47,069
that coin and actually didn't have a

263
00:10:44,730 --> 00:10:49,410
large installation base so it doesn't

264
00:10:47,069 --> 00:10:51,029
matter that you have a lot of clients it

265
00:10:49,410 --> 00:10:51,350
matters which clients you have and where

266
00:10:51,029 --> 00:10:53,660
the

267
00:10:51,350 --> 00:10:56,030
located what's also curious to see is

268
00:10:53,660 --> 00:10:57,589
that there is a lot of transitioning a

269
00:10:56,030 --> 00:10:59,300
lot of turnover happening I mentioned

270
00:10:57,590 --> 00:11:01,430
previously we are doing this every

271
00:10:59,300 --> 00:11:03,079
second day to understand how sides

272
00:11:01,430 --> 00:11:05,930
switch from one customer to the next

273
00:11:03,080 --> 00:11:08,480
look at the purple spike that is

274
00:11:05,930 --> 00:11:11,089
wordpress manera plug-in that was

275
00:11:08,480 --> 00:11:13,520
released in February 2018 it came out of

276
00:11:11,090 --> 00:11:15,710
nothing became within a couple of days

277
00:11:13,520 --> 00:11:18,260
the largest installation based allows of

278
00:11:15,710 --> 00:11:22,430
service and went into oblivion just

279
00:11:18,260 --> 00:11:24,620
eight weeks later towards October 2018

280
00:11:22,430 --> 00:11:26,719
you see that there's a general down

281
00:11:24,620 --> 00:11:28,760
client the Monaro price decreases it was

282
00:11:26,720 --> 00:11:30,800
less profitable and you see a general

283
00:11:28,760 --> 00:11:33,230
loss in this crew projecting activity

284
00:11:30,800 --> 00:11:36,140
and approximately all of these services

285
00:11:33,230 --> 00:11:38,960
are going towards the same the same

286
00:11:36,140 --> 00:11:41,240
market share so if you want to make a

287
00:11:38,960 --> 00:11:42,890
lot of money you are investing infecting

288
00:11:41,240 --> 00:11:45,410
a site where a lot of people are going

289
00:11:42,890 --> 00:11:47,120
to or what you can also do is you can

290
00:11:45,410 --> 00:11:50,060
get a lot of sites and which are all

291
00:11:47,120 --> 00:11:51,980
combined mining for your purpose and so

292
00:11:50,060 --> 00:11:53,479
what we want to know is now how many of

293
00:11:51,980 --> 00:11:56,390
these individual infections are

294
00:11:53,480 --> 00:11:57,710
belonging to the same actor so we need

295
00:11:56,390 --> 00:11:59,930
to link individual infections to

296
00:11:57,710 --> 00:12:02,570
campaigns and we can do this because if

297
00:11:59,930 --> 00:12:04,760
you are going to found this out too many

298
00:12:02,570 --> 00:12:06,410
infected sites you're going to reuse

299
00:12:04,760 --> 00:12:08,420
some indicators you're reusing some of

300
00:12:06,410 --> 00:12:10,130
your infrastructure because you that's

301
00:12:08,420 --> 00:12:12,770
the easy way of economies of scale of

302
00:12:10,130 --> 00:12:14,480
doing this so we call a campaign when

303
00:12:12,770 --> 00:12:16,280
there's at least five infected sites

304
00:12:14,480 --> 00:12:17,900
belong to the same person and how do we

305
00:12:16,280 --> 00:12:20,060
find a campaign well let's look at the

306
00:12:17,900 --> 00:12:22,010
workflow here again if you get an HP

307
00:12:20,060 --> 00:12:24,260
response and has the same site key it

308
00:12:22,010 --> 00:12:26,780
must be the same actor because why would

309
00:12:24,260 --> 00:12:28,880
somebody mind coin for a different bank

310
00:12:26,780 --> 00:12:31,400
account so it must be the same person if

311
00:12:28,880 --> 00:12:32,870
you look at the websocket proxy a lot of

312
00:12:31,400 --> 00:12:35,540
them actually most of them run their own

313
00:12:32,870 --> 00:12:37,700
infrastructure we can say that this is

314
00:12:35,540 --> 00:12:39,530
the same person because why would they

315
00:12:37,700 --> 00:12:41,450
run infrastructure for the profit of

316
00:12:39,530 --> 00:12:43,370
somebody else and then if you look at

317
00:12:41,450 --> 00:12:44,630
the JavaScript file like the way the

318
00:12:43,370 --> 00:12:46,130
infection is happening and how it's

319
00:12:44,630 --> 00:12:47,990
being called what configuration values

320
00:12:46,130 --> 00:12:50,360
they are if these are similar identical

321
00:12:47,990 --> 00:12:52,190
it must be the same person and we do

322
00:12:50,360 --> 00:12:53,690
this by a bias tech trace analysis we

323
00:12:52,190 --> 00:12:55,730
understand from which file the call

324
00:12:53,690 --> 00:12:59,090
graph happened in which order in order

325
00:12:55,730 --> 00:13:01,130
to have a high confidence value so based

326
00:12:59,090 --> 00:13:03,140
on these indicators that we had we are

327
00:13:01,130 --> 00:13:03,860
now starting a new crawl and we're going

328
00:13:03,140 --> 00:13:05,480
to

329
00:13:03,860 --> 00:13:07,910
target the scroll in finding campaigns

330
00:13:05,480 --> 00:13:09,860
and we detected a total of a map of more

331
00:13:07,910 --> 00:13:14,029
than 10,000 actively crypto checking

332
00:13:09,860 --> 00:13:16,640
websites this figure clusters these each

333
00:13:14,029 --> 00:13:18,500
dot is one particular website the color

334
00:13:16,640 --> 00:13:20,180
says which crypto mining service that's

335
00:13:18,500 --> 00:13:22,250
being used and in this force directed

336
00:13:20,180 --> 00:13:24,079
play out individual points are being

337
00:13:22,250 --> 00:13:26,779
pulled together if they are sharing

338
00:13:24,079 --> 00:13:28,459
indicators so naturally you see the big

339
00:13:26,779 --> 00:13:30,290
clusters those are the ones with the

340
00:13:28,459 --> 00:13:34,040
same indicator file those other ones

341
00:13:30,290 --> 00:13:35,839
were the same site key etc etc and you

342
00:13:34,040 --> 00:13:38,000
see the emergence of very very large

343
00:13:35,839 --> 00:13:40,750
campaigns all working together in total

344
00:13:38,000 --> 00:13:42,740
we find more than 200 of these and

345
00:13:40,750 --> 00:13:45,320
approximately half of the entire

346
00:13:42,740 --> 00:13:46,970
ecosystem is actually organized and

347
00:13:45,320 --> 00:13:49,370
powerful campaign and that means more

348
00:13:46,970 --> 00:13:52,339
than five individual sites working for a

349
00:13:49,370 --> 00:13:54,470
single actor curiously if you look at

350
00:13:52,339 --> 00:13:56,180
this the largest actor that we found has

351
00:13:54,470 --> 00:13:59,060
almost a thousand websites under their

352
00:13:56,180 --> 00:14:00,979
control so last year's CCS paper to put

353
00:13:59,060 --> 00:14:02,839
this into perspective found less than

354
00:14:00,980 --> 00:14:05,050
that in total crypto checking in the

355
00:14:02,839 --> 00:14:07,940
ecosystem so it's very largely driven by

356
00:14:05,050 --> 00:14:10,969
organized activity by actors who trying

357
00:14:07,940 --> 00:14:12,170
to make the most money out of it so

358
00:14:10,970 --> 00:14:13,760
there's a lot of different campaigns and

359
00:14:12,170 --> 00:14:15,589
you can analyze them more details of

360
00:14:13,760 --> 00:14:17,689
this on the paper one of them I will

361
00:14:15,589 --> 00:14:19,910
point out here and you can see what kind

362
00:14:17,690 --> 00:14:22,220
of analysis behind that that is somebody

363
00:14:19,910 --> 00:14:23,930
who's targeting the bit tricks 24

364
00:14:22,220 --> 00:14:25,940
customer relationship management system

365
00:14:23,930 --> 00:14:28,189
has found a vulnerability there and it's

366
00:14:25,940 --> 00:14:29,899
infecting 850 websites the most

367
00:14:28,190 --> 00:14:32,029
prominent victim was the Ministry of

368
00:14:29,899 --> 00:14:33,860
Education of Belarus and what was

369
00:14:32,029 --> 00:14:35,779
interesting about them is that it was

370
00:14:33,860 --> 00:14:38,839
specifically targeting this application

371
00:14:35,779 --> 00:14:40,970
and the Minor was swappable so they

372
00:14:38,839 --> 00:14:43,100
could mine for two different sites and

373
00:14:40,970 --> 00:14:46,730
they were randomly deciding which one to

374
00:14:43,100 --> 00:14:49,790
pick at a given moment so they hid this

375
00:14:46,730 --> 00:14:51,290
within the Beatrix core loader so this

376
00:14:49,790 --> 00:14:53,300
was actually targeted attack they know

377
00:14:51,290 --> 00:14:55,910
precisely what to go for the mining

378
00:14:53,300 --> 00:14:58,339
script was pretty standard but they

379
00:14:55,910 --> 00:15:00,260
included evasion techniques so when you

380
00:14:58,339 --> 00:15:02,180
try to debug this they were immediately

381
00:15:00,260 --> 00:15:06,620
dumping all the code that was related to

382
00:15:02,180 --> 00:15:09,109
this in order to avoid any detection so

383
00:15:06,620 --> 00:15:11,180
we analyzed all of these campaigns

384
00:15:09,110 --> 00:15:13,910
manually and we also had our tool chain

385
00:15:11,180 --> 00:15:15,380
that was now taking them apart and

386
00:15:13,910 --> 00:15:16,230
understanding where the call graph came

387
00:15:15,380 --> 00:15:17,850
from and how

388
00:15:16,230 --> 00:15:19,950
tres looked like and what actually

389
00:15:17,850 --> 00:15:22,500
happens and when you look at this in a

390
00:15:19,950 --> 00:15:24,600
bigger scheme you see that most of these

391
00:15:22,500 --> 00:15:26,610
infections are coming from third party

392
00:15:24,600 --> 00:15:28,890
compromises so these are compromised

393
00:15:26,610 --> 00:15:30,450
content management system templates so

394
00:15:28,890 --> 00:15:32,250
somebody downloads the template for

395
00:15:30,450 --> 00:15:34,410
WordPress and there's a minor embedded

396
00:15:32,250 --> 00:15:36,600
these were extended scripts stretches to

397
00:15:34,410 --> 00:15:38,640
jQuery and there was a minor in there or

398
00:15:36,600 --> 00:15:40,890
a credit card validation script with a

399
00:15:38,640 --> 00:15:42,150
minor in there or libraries that he

400
00:15:40,890 --> 00:15:46,199
would use within the JavaScript

401
00:15:42,150 --> 00:15:48,150
ecosystem as a matter of fact 60% of all

402
00:15:46,200 --> 00:15:50,340
cryptid jackin was the result of

403
00:15:48,150 --> 00:15:52,790
third-party software compromises so

404
00:15:50,340 --> 00:15:54,720
remember previous works that that most

405
00:15:52,790 --> 00:15:56,610
compromises happen as a result of

406
00:15:54,720 --> 00:15:58,170
compromised websites and malicious

407
00:15:56,610 --> 00:16:01,470
advertisement if you add this together

408
00:15:58,170 --> 00:16:03,030
this is less than 30% by far the big

409
00:16:01,470 --> 00:16:05,820
elephant in the room is third-party

410
00:16:03,030 --> 00:16:07,890
software so why is this happening well

411
00:16:05,820 --> 00:16:09,030
remember if you crawling the Alexa 1

412
00:16:07,890 --> 00:16:11,460
million you're looking at a very

413
00:16:09,030 --> 00:16:13,319
specific subset of the Internet these

414
00:16:11,460 --> 00:16:15,060
are not sites where somebody uses

415
00:16:13,320 --> 00:16:17,460
WordPress to run the e-commerce presence

416
00:16:15,060 --> 00:16:19,079
and more foremost goes on the Internet

417
00:16:17,460 --> 00:16:19,860
and download the shady template in order

418
00:16:19,080 --> 00:16:21,540
to save money

419
00:16:19,860 --> 00:16:23,520
well they would be running their own

420
00:16:21,540 --> 00:16:25,860
dedicated ecommerce platforms they would

421
00:16:23,520 --> 00:16:28,350
have web designers they would not be at

422
00:16:25,860 --> 00:16:30,750
risk for linking to external linked

423
00:16:28,350 --> 00:16:32,430
libraries in order to save some money so

424
00:16:30,750 --> 00:16:34,530
therefore if you're looking at this

425
00:16:32,430 --> 00:16:35,939
particular target group you are missing

426
00:16:34,530 --> 00:16:37,439
the biggest attack vector that they

427
00:16:35,940 --> 00:16:39,260
actually is that you can discover when

428
00:16:37,440 --> 00:16:42,150
you're looking at the Internet at large

429
00:16:39,260 --> 00:16:43,650
so what are the key takeaways if you

430
00:16:42,150 --> 00:16:45,750
really wanna understand this criminal

431
00:16:43,650 --> 00:16:48,209
problem of crypto jackin we have to

432
00:16:45,750 --> 00:16:49,740
understand the ecosystem and in order to

433
00:16:48,210 --> 00:16:52,140
understand the ecosystem campaign

434
00:16:49,740 --> 00:16:54,150
analysis is a key technique to do this

435
00:16:52,140 --> 00:16:56,580
and we do see this is necessary because

436
00:16:54,150 --> 00:17:00,300
half of the activity that we see is

437
00:16:56,580 --> 00:17:01,800
already related to organized activity

438
00:17:00,300 --> 00:17:04,649
organized individual actors that are

439
00:17:01,800 --> 00:17:06,780
doing this at scale what we also know is

440
00:17:04,650 --> 00:17:09,510
that third party software is by far the

441
00:17:06,780 --> 00:17:11,399
main attack vector that we need to be

442
00:17:09,510 --> 00:17:13,379
worried about and that's actually very

443
00:17:11,400 --> 00:17:14,640
difficult to to target there were many

444
00:17:13,380 --> 00:17:16,890
talks of this conference that also

445
00:17:14,640 --> 00:17:19,290
mentioned compromises in open source

446
00:17:16,890 --> 00:17:20,880
software ecosystems and this is

447
00:17:19,290 --> 00:17:22,800
extremely difficult for the average user

448
00:17:20,880 --> 00:17:23,700
to do something about because they don't

449
00:17:22,800 --> 00:17:25,440
have the knowledge they're just

450
00:17:23,700 --> 00:17:26,819
downloading something so how can you be

451
00:17:25,440 --> 00:17:28,350
sure that if you have a lie

452
00:17:26,819 --> 00:17:30,540
that invokes the library that there's

453
00:17:28,349 --> 00:17:31,949
everything clean around that that's

454
00:17:30,540 --> 00:17:33,629
something that we as a community should

455
00:17:31,950 --> 00:17:36,840
focus on and we have to be very

456
00:17:33,630 --> 00:17:38,760
observant that if we use studies of the

457
00:17:36,840 --> 00:17:41,159
Internet based for example on the Alexa

458
00:17:38,760 --> 00:17:43,110
1 million as a top list we are looking

459
00:17:41,160 --> 00:17:44,640
at a very biased sample because these

460
00:17:43,110 --> 00:17:46,649
are specific companies they are

461
00:17:44,640 --> 00:17:49,080
structurally different from how the rest

462
00:17:46,650 --> 00:17:50,880
of the internet looks like so this was

463
00:17:49,080 --> 00:17:52,290
just a quick taster there's a number of

464
00:17:50,880 --> 00:17:54,840
additional aspects in paper

465
00:17:52,290 --> 00:17:56,790
we have also looking into hiding an

466
00:17:54,840 --> 00:17:58,620
obfuscation techniques there's various

467
00:17:56,790 --> 00:18:00,930
levels and various sophistication levels

468
00:17:58,620 --> 00:18:02,669
of hiding going on if you ever wondered

469
00:18:00,930 --> 00:18:05,940
what Harry Potter has to do with crypto

470
00:18:02,670 --> 00:18:08,820
checking read our paper we also see that

471
00:18:05,940 --> 00:18:10,620
this hiding is much more prevalent where

472
00:18:08,820 --> 00:18:12,450
they are trying to actively hide because

473
00:18:10,620 --> 00:18:14,909
it's somewhere deep in the software tool

474
00:18:12,450 --> 00:18:16,140
chain and we also interestingly see that

475
00:18:14,910 --> 00:18:17,520
there's different market shares and

476
00:18:16,140 --> 00:18:19,370
different prevalence for certain

477
00:18:17,520 --> 00:18:21,570
services across different countries

478
00:18:19,370 --> 00:18:23,879
during the end of the study something

479
00:18:21,570 --> 00:18:25,740
very remarkable happens the largest

480
00:18:23,880 --> 00:18:28,110
company that was providing these

481
00:18:25,740 --> 00:18:30,330
web-based crypto mining coin hive was

482
00:18:28,110 --> 00:18:32,850
ceasing the operation because it was no

483
00:18:30,330 --> 00:18:34,770
longer profitable for that so what we

484
00:18:32,850 --> 00:18:36,379
could observe was the teardown of the

485
00:18:34,770 --> 00:18:39,540
entire infrastructure when the biggest

486
00:18:36,380 --> 00:18:41,640
provider left the ecosystem and how did

487
00:18:39,540 --> 00:18:45,870
the ecosystem afterwards react based on

488
00:18:41,640 --> 00:18:47,820
that so what's there for the future we

489
00:18:45,870 --> 00:18:50,010
found various sites we found various new

490
00:18:47,820 --> 00:18:51,689
- new techniques these indicators have

491
00:18:50,010 --> 00:18:53,220
been shared with online blacklist so if

492
00:18:51,690 --> 00:18:55,800
you're having one of those plugins or

493
00:18:53,220 --> 00:18:57,180
antivirus modules that protect you

494
00:18:55,800 --> 00:18:59,070
against these kind of threats our

495
00:18:57,180 --> 00:19:01,740
information is in there and and keeping

496
00:18:59,070 --> 00:19:03,659
you safe as a matter of the study we

497
00:19:01,740 --> 00:19:05,790
also found something very interesting

498
00:19:03,660 --> 00:19:07,350
there was a fifth attack vector that we

499
00:19:05,790 --> 00:19:09,240
happened on our radar when we started

500
00:19:07,350 --> 00:19:11,040
this what we discovered was that there

501
00:19:09,240 --> 00:19:13,110
was a cyber criminal group that was

502
00:19:11,040 --> 00:19:14,639
attacking Internet routers and doing a

503
00:19:13,110 --> 00:19:17,129
middlemen in the middle attack and

504
00:19:14,640 --> 00:19:18,750
rewriting the HTML code wild flow

505
00:19:17,130 --> 00:19:21,480
through the router and one router

506
00:19:18,750 --> 00:19:24,060
manufacturer 70% of their devices were

507
00:19:21,480 --> 00:19:26,040
compromised so this is an our upcoming

508
00:19:24,060 --> 00:19:28,649
CCS paper the analysis of this and and

509
00:19:26,040 --> 00:19:30,480
what concretely happened there and I

510
00:19:28,650 --> 00:19:33,890
thank you for your attention and I

511
00:19:30,480 --> 00:19:33,890
invite your questions thank you

512
00:19:35,620 --> 00:19:46,250
I'm afraid we have time for maybe one 20

513
00:19:39,050 --> 00:19:48,889
second question again start from you see

514
00:19:46,250 --> 00:19:50,600
if I really liked your presentation I've

515
00:19:48,890 --> 00:19:52,250
got one question when you when you talk

516
00:19:50,600 --> 00:19:54,679
about elect someone million measuring

517
00:19:52,250 --> 00:19:57,140
them a longitudinal study so there is a

518
00:19:54,680 --> 00:19:59,270
paper and I'm I'm C last year that shows

519
00:19:57,140 --> 00:20:01,370
that there's a significant churn in tell

520
00:19:59,270 --> 00:20:03,500
Excel 1 million do you think that's the

521
00:20:01,370 --> 00:20:07,489
reason why some of your result would be

522
00:20:03,500 --> 00:20:10,940
different from CCS 2018 minesweeper yes

523
00:20:07,490 --> 00:20:11,120
and no so the there are two aspects to

524
00:20:10,940 --> 00:20:13,190
it

525
00:20:11,120 --> 00:20:14,689
so exactly that that is one of the key

526
00:20:13,190 --> 00:20:16,370
papers that analyzed this so if you look

527
00:20:14,690 --> 00:20:18,080
in the Turner of overwrite of the Alexa

528
00:20:16,370 --> 00:20:19,159
1 million there are bad days where you

529
00:20:18,080 --> 00:20:20,600
have a hundred thousand two hundred

530
00:20:19,160 --> 00:20:21,950
thousand sites being swapped out

531
00:20:20,600 --> 00:20:25,850
especially at the long tail of the

532
00:20:21,950 --> 00:20:27,640
distribution this is a part of this but

533
00:20:25,850 --> 00:20:30,139
that's very difficult to measure

534
00:20:27,640 --> 00:20:32,420
objectively out and the other part of

535
00:20:30,140 --> 00:20:33,860
thing is that the ecosystem has been

536
00:20:32,420 --> 00:20:36,740
becoming a bit more aware of this

537
00:20:33,860 --> 00:20:38,179
problem and has also noticed that this

538
00:20:36,740 --> 00:20:39,860
is not too profitable for their their

539
00:20:38,180 --> 00:20:41,720
operation so I think it's a general

540
00:20:39,860 --> 00:20:45,889
decline in this because the Monaro price

541
00:20:41,720 --> 00:20:48,530
also dropped it is less useful and also

542
00:20:45,890 --> 00:20:50,060
issues such as the Alexa 1 million

543
00:20:48,530 --> 00:20:52,340
turnover but I think this should be

544
00:20:50,060 --> 00:20:57,070
probably averaged out on a large scale

545
00:20:52,340 --> 00:21:00,290
ok let's thank all the speakers again

546
00:20:57,070 --> 00:21:00,290
[Applause]

