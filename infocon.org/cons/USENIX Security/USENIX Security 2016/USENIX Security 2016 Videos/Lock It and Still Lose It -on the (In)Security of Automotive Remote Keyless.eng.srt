1
00:00:10,720 --> 00:00:12,700
I thank you very much for the kind

2
00:00:12,700 --> 00:00:14,710
introduction this joint work together

3
00:00:14,710 --> 00:00:17,560
with a team or who is in Germany and

4
00:00:17,560 --> 00:00:19,900
ampere who was a student in Birmingham

5
00:00:19,900 --> 00:00:21,910
and today I will present together with

6
00:00:21,910 --> 00:00:24,550
Flavio paper locket and Seleucid on the

7
00:00:24,550 --> 00:00:26,590
insecurity of automotive remote keyless

8
00:00:26,590 --> 00:00:30,640
entry systems so if you look at the

9
00:00:30,640 --> 00:00:32,560
typical cocky you I have two main

10
00:00:32,560 --> 00:00:34,390
electronic components in there

11
00:00:34,390 --> 00:00:36,310
one is the immobilizer which is in

12
00:00:36,310 --> 00:00:39,340
passive RFID system running at 125

13
00:00:39,340 --> 00:00:41,710
kilohertz with a range of a few

14
00:00:41,710 --> 00:00:44,680
centimeters maybe and this mobilizers

15
00:00:44,680 --> 00:00:46,420
have a very long or attacks on

16
00:00:46,420 --> 00:00:47,920
immobilizers have a very long history

17
00:00:47,920 --> 00:00:50,350
here at using it so if you're interested

18
00:00:50,350 --> 00:00:52,630
you can look into this today we will

19
00:00:52,630 --> 00:00:54,160
speak about the system which has not

20
00:00:54,160 --> 00:00:56,350
been looked into too much and this is a

21
00:00:56,350 --> 00:00:58,990
remote keyless entry systems rke systems

22
00:00:58,990 --> 00:01:00,580
it says this buttons here on the remote

23
00:01:00,580 --> 00:01:03,790
control that you press to open or lock

24
00:01:03,790 --> 00:01:07,150
your car or to access a trunk also or in

25
00:01:07,150 --> 00:01:09,640
the u.s. sometimes sounds alarm these

26
00:01:09,640 --> 00:01:12,430
are active UHF systems at high frequency

27
00:01:12,430 --> 00:01:13,659
with a higher range and say

28
00:01:13,659 --> 00:01:16,480
unidirectional so the remote just talks

29
00:01:16,480 --> 00:01:19,659
to the car basically they can sometimes

30
00:01:19,659 --> 00:01:21,760
be integrated with immobilizers and we

31
00:01:21,760 --> 00:01:23,920
have a so-called hybrid system or they

32
00:01:23,920 --> 00:01:27,729
can be completely separate so and we

33
00:01:27,729 --> 00:01:30,640
were curious also partially motivated by

34
00:01:30,640 --> 00:01:33,640
unexplained caste cases of car safe

35
00:01:33,640 --> 00:01:36,070
without signs of or theft from blood

36
00:01:36,070 --> 00:01:38,290
cars without signs of forced entry

37
00:01:38,290 --> 00:01:40,930
houses may be possible and how a

38
00:01:40,930 --> 00:01:43,810
security systems were so back in the day

39
00:01:43,810 --> 00:01:45,430
when this was introduced we had

40
00:01:45,430 --> 00:01:46,990
so-called fixed codes where you just

41
00:01:46,990 --> 00:01:49,479
sent a fixed UID and the button that was

42
00:01:49,479 --> 00:01:52,330
pressed to the vehicle and then the car

43
00:01:52,330 --> 00:01:54,580
would execute this action and obviously

44
00:01:54,580 --> 00:01:57,430
such systems are vulnerable to simply

45
00:01:57,430 --> 00:02:00,159
replay a text so Oscar can just

46
00:02:00,159 --> 00:02:02,140
eavesdrops a signal from a high range in

47
00:02:02,140 --> 00:02:04,170
this case we have high frequency systems

48
00:02:04,170 --> 00:02:07,210
replays the system and open the vehicle

49
00:02:07,210 --> 00:02:09,878
and the ranges are then the range up to

50
00:02:09,878 --> 00:02:12,489
a hundred meters reading so these

51
00:02:12,489 --> 00:02:14,830
systems obviously not good this is why

52
00:02:14,830 --> 00:02:16,569
industry has reacted and invented

53
00:02:16,569 --> 00:02:19,150
so-called rollin codes which are based

54
00:02:19,150 --> 00:02:21,520
on cryptography now so we have the

55
00:02:21,520 --> 00:02:23,560
shared secret both in the car

56
00:02:23,560 --> 00:02:27,040
and the remote control and houses is

57
00:02:27,040 --> 00:02:29,319
used the shared secret is used to in

58
00:02:29,319 --> 00:02:32,110
some way or CENTAC 8 so encrypt or Mac

59
00:02:32,110 --> 00:02:34,750
maybe account our value together with

60
00:02:34,750 --> 00:02:37,330
the press button and then on every

61
00:02:37,330 --> 00:02:40,150
button press this counter is incremented

62
00:02:40,150 --> 00:02:44,349
to give freshness and to prevent relay

63
00:02:44,349 --> 00:02:46,390
attacks in this way so if you want you

64
00:02:46,390 --> 00:02:50,230
can think of it this is a nice circle so

65
00:02:50,230 --> 00:02:52,420
you have some current counter values and

66
00:02:52,420 --> 00:02:54,519
only counter values and the future are

67
00:02:54,519 --> 00:02:57,870
accepted within some validity window and

68
00:02:57,870 --> 00:03:00,250
the encryptions then ensures its

69
00:03:00,250 --> 00:03:02,769
adversary cannot simply increment the

70
00:03:02,769 --> 00:03:03,880
counter himself

71
00:03:03,880 --> 00:03:05,860
so there are many realizations how this

72
00:03:05,860 --> 00:03:08,380
is actually done in practice that's just

73
00:03:08,380 --> 00:03:13,200
an illustration so I said Oscar has no

74
00:03:13,200 --> 00:03:16,209
opportunities to break the system unless

75
00:03:16,209 --> 00:03:18,370
he does one of the following two things

76
00:03:18,370 --> 00:03:20,170
and this can be either attacks of

77
00:03:20,170 --> 00:03:22,780
cryptography or attacks the key

78
00:03:22,780 --> 00:03:25,420
management and in this presentation will

79
00:03:25,420 --> 00:03:28,420
give examples for both cases where the

80
00:03:28,420 --> 00:03:30,130
texts are still possible I will talk

81
00:03:30,130 --> 00:03:32,680
about the key management part a bit more

82
00:03:32,680 --> 00:03:36,160
Flavio boards a crypto path so a very

83
00:03:36,160 --> 00:03:38,620
brief history of attacks on our ke

84
00:03:38,620 --> 00:03:41,769
systems roundabout in 2007-2008 we have

85
00:03:41,769 --> 00:03:44,410
seen many attacks on key log garage door

86
00:03:44,410 --> 00:03:46,269
openers they are also rolling code base

87
00:03:46,269 --> 00:03:49,750
first there was crypt analysis which

88
00:03:49,750 --> 00:03:52,150
however was sort of impractical in this

89
00:03:52,150 --> 00:03:53,920
keyless entry scenario because you

90
00:03:53,920 --> 00:03:57,400
needed 2 to the 16 codes to basically

91
00:03:57,400 --> 00:04:01,030
extract the key and afterwards in 2008

92
00:04:01,030 --> 00:04:03,060
we had a side-channel attacks on the key

93
00:04:03,060 --> 00:04:05,260
diversification which were more

94
00:04:05,260 --> 00:04:07,510
realistic a different line of research

95
00:04:07,510 --> 00:04:10,000
our attacks on so called passive keyless

96
00:04:10,000 --> 00:04:12,250
entry systems is a this keys where you

97
00:04:12,250 --> 00:04:14,019
do not have to press a button anymore

98
00:04:14,019 --> 00:04:17,950
they are vulnerable to relay and then in

99
00:04:17,950 --> 00:04:20,769
2014 we have seen a few attacks on

100
00:04:20,769 --> 00:04:23,500
actual vehicles one was an attack biases

101
00:04:23,500 --> 00:04:27,190
other on around about 2000 to 2005

102
00:04:27,190 --> 00:04:29,590
vehicle based on some mathematical

103
00:04:29,590 --> 00:04:31,810
techniques and later there was last year

104
00:04:31,810 --> 00:04:33,580
this road Jam attack

105
00:04:33,580 --> 00:04:35,650
which is based on a combination of

106
00:04:35,650 --> 00:04:37,599
intelligent jamming and replaying

107
00:04:37,599 --> 00:04:39,789
however in the cases that we'll talk

108
00:04:39,789 --> 00:04:41,259
about this will not apply

109
00:04:41,259 --> 00:04:43,199
since the button function is actually

110
00:04:43,199 --> 00:04:45,250
authenticated so it's included in the

111
00:04:45,250 --> 00:04:47,949
cryptography so if you eavesdrop a close

112
00:04:47,949 --> 00:04:49,810
signal you could not turn it into an

113
00:04:49,810 --> 00:04:54,220
open signal in our cases this brings me

114
00:04:54,220 --> 00:04:56,110
to the first case study which is the

115
00:04:56,110 --> 00:04:58,930
system employed by the VW Group so for

116
00:04:58,930 --> 00:05:01,000
those who do not know VW Group is formed

117
00:05:01,000 --> 00:05:04,330
of volkswagen audi is CH Gouda plus a

118
00:05:04,330 --> 00:05:07,830
few luxury brands such as Porsche and

119
00:05:07,830 --> 00:05:10,599
all in all that they have around about

120
00:05:10,599 --> 00:05:14,590
10% worldwide a market share so it's one

121
00:05:14,590 --> 00:05:16,330
of the leading automotive companies the

122
00:05:16,330 --> 00:05:18,490
system is widely employed the

123
00:05:18,490 --> 00:05:20,560
immobilizer system called mega Moss has

124
00:05:20,560 --> 00:05:22,569
some history at you snakes if you do not

125
00:05:22,569 --> 00:05:24,849
know you can look into this however the

126
00:05:24,849 --> 00:05:27,159
rke system is completely separate so

127
00:05:27,159 --> 00:05:29,470
there's no mega Moss used in the keyless

128
00:05:29,470 --> 00:05:32,409
entry system here we have looked at

129
00:05:32,409 --> 00:05:35,139
vehicles between roundabout 2000 or

130
00:05:35,139 --> 00:05:38,259
earlier and today and found four main

131
00:05:38,259 --> 00:05:41,620
schemes which we call VW want to BW for

132
00:05:41,620 --> 00:05:43,719
in the following of the presentation

133
00:05:43,719 --> 00:05:47,320
however there are a few more remaining

134
00:05:47,320 --> 00:05:49,509
niche schemes where we suspect the I in

135
00:05:49,509 --> 00:05:53,440
a similar way vulnerable so when

136
00:05:53,440 --> 00:05:55,570
analyzing this remote keyless entry

137
00:05:55,570 --> 00:05:57,400
systems in general you first need to

138
00:05:57,400 --> 00:05:59,680
eavesdrop signals and there are various

139
00:05:59,680 --> 00:06:02,199
opportunities for this one is to use

140
00:06:02,199 --> 00:06:04,539
software-defined radio such as is very

141
00:06:04,539 --> 00:06:07,479
low cost dvb-t sticks or also an HEC RF

142
00:06:07,479 --> 00:06:10,270
maybe us appeal the other option is to

143
00:06:10,270 --> 00:06:13,000
build purpose design systems like this

144
00:06:13,000 --> 00:06:14,800
Arduino board which can be built for

145
00:06:14,800 --> 00:06:17,860
round about 40 dollars which can receive

146
00:06:17,860 --> 00:06:20,440
and transmit data and is also as you can

147
00:06:20,440 --> 00:06:24,610
see battery-powered a typical VW rolling

148
00:06:24,610 --> 00:06:26,770
code would look like this you have some

149
00:06:26,770 --> 00:06:29,139
preamble at the beginning then start

150
00:06:29,139 --> 00:06:31,870
pattern and then the actual part

151
00:06:31,870 --> 00:06:34,630
carrying the data so we looked at this a

152
00:06:34,630 --> 00:06:36,330
bit in a black box fashion and could not

153
00:06:36,330 --> 00:06:39,069
really figure out what was going on so

154
00:06:39,069 --> 00:06:41,560
we continued to reverse-engineer ECU

155
00:06:41,560 --> 00:06:43,900
firmware for this we first had to find

156
00:06:43,900 --> 00:06:46,029
the correct issue for each of the

157
00:06:46,029 --> 00:06:47,230
schemes VW one

158
00:06:47,230 --> 00:06:50,380
to vw4 extracts the firmware from the

159
00:06:50,380 --> 00:06:52,600
microcontroller reverse engineers the

160
00:06:52,600 --> 00:06:55,780
cryptography using tools like Ida Pro

161
00:06:55,780 --> 00:06:57,580
for those who know reverse engineering

162
00:06:57,580 --> 00:06:59,410
this is similar to the software world

163
00:06:59,410 --> 00:07:02,800
and then from there we got access to the

164
00:07:02,800 --> 00:07:04,840
full cryptographic algorithms and also

165
00:07:04,840 --> 00:07:08,620
the utilized keys so I'll only briefly

166
00:07:08,620 --> 00:07:11,920
talk about two of these four schemes one

167
00:07:11,920 --> 00:07:14,140
is this as a to more recent schemes one

168
00:07:14,140 --> 00:07:17,620
is vw3 and we found out that the rolling

169
00:07:17,620 --> 00:07:19,840
code is basically constructed like this

170
00:07:19,840 --> 00:07:22,360
year you have a cipher called odd 64

171
00:07:22,360 --> 00:07:26,050
which you probably do not know we later

172
00:07:26,050 --> 00:07:28,420
basically found the cipher and some Atma

173
00:07:28,420 --> 00:07:31,180
data sheets in a high-level fashion we

174
00:07:31,180 --> 00:07:33,580
have not looked at it really deeply

175
00:07:33,580 --> 00:07:36,700
cryptographically and this odd 64 sci-fi

176
00:07:36,700 --> 00:07:40,180
is then used to encrypt encrypts UID the

177
00:07:40,180 --> 00:07:42,100
counter value and the button value and

178
00:07:42,100 --> 00:07:43,990
afterwards a button value is again sent

179
00:07:43,990 --> 00:07:46,660
in clear text for some reason what you

180
00:07:46,660 --> 00:07:49,090
already can notice is UID is never sent

181
00:07:49,090 --> 00:07:52,330
in clear so the car has first to decrypt

182
00:07:52,330 --> 00:07:55,690
to basically get all those values which

183
00:07:55,690 --> 00:07:57,340
sort of suggests that something may be

184
00:07:57,340 --> 00:07:59,110
wrong with the key management here and

185
00:07:59,110 --> 00:08:02,410
indeed this key case reads that you see

186
00:08:02,410 --> 00:08:05,860
is just the same key and all vehicles

187
00:08:05,860 --> 00:08:09,610
made under this VW scheme so there's no

188
00:08:09,610 --> 00:08:11,440
key diversification had all been

189
00:08:11,440 --> 00:08:13,300
employed and it's just one symmetric

190
00:08:13,300 --> 00:08:15,820
secret it's also interesting to note

191
00:08:15,820 --> 00:08:18,490
that actually all the w3 cars have to

192
00:08:18,490 --> 00:08:21,630
decrypt all the codes in their insanity

193
00:08:21,630 --> 00:08:25,960
this VW tooth system is just same cipher

194
00:08:25,960 --> 00:08:27,790
same system slightly different packet

195
00:08:27,790 --> 00:08:30,280
format and a different worldwide key and

196
00:08:30,280 --> 00:08:33,220
the system before that we w1 is just

197
00:08:33,220 --> 00:08:36,280
based on linear shift registers again

198
00:08:36,280 --> 00:08:38,409
with global secret so we did not have to

199
00:08:38,409 --> 00:08:41,080
open the box of trip analysis here at

200
00:08:41,080 --> 00:08:45,610
all the newest system that we looked at

201
00:08:45,610 --> 00:08:48,280
is called VW for users if you compare to

202
00:08:48,280 --> 00:08:52,450
the previous slide only the exteriors -

203
00:08:52,450 --> 00:08:54,820
instead of odd 64 but nothing else has

204
00:08:54,820 --> 00:08:57,640
changed so the cryptography is fine it's

205
00:08:57,640 --> 00:08:59,650
a secure standard cipher

206
00:08:59,650 --> 00:09:02,440
but again we have one worldwide key k4

207
00:09:02,440 --> 00:09:05,080
in in this case since summaries this

208
00:09:05,080 --> 00:09:07,570
means the adversary can just eavesdrop a

209
00:09:07,570 --> 00:09:11,350
single signal get the UID value gets a

210
00:09:11,350 --> 00:09:13,360
counter value and from then create a

211
00:09:13,360 --> 00:09:15,370
clone of the original remote control

212
00:09:15,370 --> 00:09:18,460
with this knowledge of those global keys

213
00:09:18,460 --> 00:09:21,400
and I'll also have a small video

214
00:09:21,400 --> 00:09:24,010
demonstration for you you see a folks

215
00:09:24,010 --> 00:09:28,330
van Passat and first of all now the

216
00:09:28,330 --> 00:09:31,420
original owner opens vehicle with this

217
00:09:31,420 --> 00:09:33,670
remote here we have open and close but

218
00:09:33,670 --> 00:09:36,190
one signal would just be sufficient

219
00:09:36,190 --> 00:09:38,890
basically and now for demonstration

220
00:09:38,890 --> 00:09:40,870
purposes we actually place a remote

221
00:09:40,870 --> 00:09:43,060
control on the car and have this

222
00:09:43,060 --> 00:09:45,940
sophisticated eavesdropping and sending

223
00:09:45,940 --> 00:09:49,050
device it's similar to Arduino board and

224
00:09:49,050 --> 00:09:52,450
this has now if stop the key and can

225
00:09:52,450 --> 00:09:55,029
generate future use of signal and can

226
00:09:55,029 --> 00:09:57,130
based on the global key generate future

227
00:09:57,130 --> 00:10:00,490
signals such as open closed open closed

228
00:10:00,490 --> 00:10:03,670
and so on so now the case actually this

229
00:10:03,670 --> 00:10:06,220
counter is for values ahead of the

230
00:10:06,220 --> 00:10:08,170
original remote so how many times does

231
00:10:08,170 --> 00:10:12,400
the owner now have to press four five

232
00:10:12,400 --> 00:10:15,190
five actually so you have to press five

233
00:10:15,190 --> 00:10:17,320
times such that the counter in the

234
00:10:17,320 --> 00:10:19,529
remote control again catches up with

235
00:10:19,529 --> 00:10:23,200
with the key with the car so under the

236
00:10:23,200 --> 00:10:25,120
fifth times the car works again with the

237
00:10:25,120 --> 00:10:29,200
original remote this affects a large

238
00:10:29,200 --> 00:10:32,680
amount of VW vehicles this is a list of

239
00:10:32,680 --> 00:10:33,940
vehicles that we could actually identify

240
00:10:33,940 --> 00:10:37,680
so we have audience list you have

241
00:10:37,680 --> 00:10:40,600
Volkswagen C art scooter

242
00:10:40,600 --> 00:10:42,850
so in summary probably most of the

243
00:10:42,850 --> 00:10:45,250
vehicles manufactured between two

244
00:10:45,250 --> 00:10:47,100
thousand or ninety five however and

245
00:10:47,100 --> 00:10:51,100
today the only exception is the newest

246
00:10:51,100 --> 00:10:54,100
platform that's a go of seven or MQB

247
00:10:54,100 --> 00:10:56,440
module logically about kaznia some

248
00:10:56,440 --> 00:10:59,820
german word a platform which allegedly

249
00:10:59,820 --> 00:11:02,380
uses better cryptography and more

250
00:11:02,380 --> 00:11:04,510
importantly maybe better key management

251
00:11:04,510 --> 00:11:08,500
actually so before I hand over to Flavia

252
00:11:08,500 --> 00:11:10,030
just to summarize this part we have seen

253
00:11:10,030 --> 00:11:11,580
the cryptographic algorithms

254
00:11:11,580 --> 00:11:13,740
a bit improving over time from this lfsr

255
00:11:13,740 --> 00:11:16,620
to add 64 to X TIA

256
00:11:16,620 --> 00:11:19,260
however just secure crypto doesn't make

257
00:11:19,260 --> 00:11:21,360
a secure system if you have a bad key

258
00:11:21,360 --> 00:11:24,000
much key management and in this case we

259
00:11:24,000 --> 00:11:26,040
could just reverse engineer su firmware

260
00:11:26,040 --> 00:11:28,770
gets this global master keys which makes

261
00:11:28,770 --> 00:11:31,530
attack very practical and very scalable

262
00:11:31,530 --> 00:11:34,950
and a said only the newest system if you

263
00:11:34,950 --> 00:11:37,860
have such a vehicle is allegedly more

264
00:11:37,860 --> 00:11:42,390
secure so so much for this failures in

265
00:11:42,390 --> 00:11:44,820
key diversification and now Flavio will

266
00:11:44,820 --> 00:11:46,560
tell you a bit more about problems with

267
00:11:46,560 --> 00:11:51,120
cryptography thank you hi so we look

268
00:11:51,120 --> 00:11:53,520
into another widely use remote keyless

269
00:11:53,520 --> 00:11:56,040
entry system so-called high-tech tube is

270
00:11:56,040 --> 00:11:59,430
used by several comics including a

271
00:11:59,430 --> 00:12:01,830
Romero's heathrow and Mies and fourth

272
00:12:01,830 --> 00:12:03,570
row show Mitsubishi

273
00:12:03,570 --> 00:12:07,770
Renault Opel among others in contrast to

274
00:12:07,770 --> 00:12:11,490
the to the BW systems these do have a

275
00:12:11,490 --> 00:12:15,780
different key per car key so we need to

276
00:12:15,780 --> 00:12:17,970
work with the we need to develop some

277
00:12:17,970 --> 00:12:20,730
crypt analysis for for retrieving the

278
00:12:20,730 --> 00:12:21,540
secret key

279
00:12:21,540 --> 00:12:25,200
so back in at least 6 2012 ever dueled

280
00:12:25,200 --> 00:12:28,170
Bala and myself proposed an attack

281
00:12:28,170 --> 00:12:29,790
against the hi-tech to immobilize

282
00:12:29,790 --> 00:12:33,720
decipher was known before so we did some

283
00:12:33,720 --> 00:12:35,730
crypt analysis and this attack required

284
00:12:35,730 --> 00:12:38,780
knowing the UID of the of the key

285
00:12:38,780 --> 00:12:42,000
required 136 authentication attempts

286
00:12:42,000 --> 00:12:44,820
from the car and 5-minute computation on

287
00:12:44,820 --> 00:12:48,080
a laptop while speaking with the

288
00:12:48,080 --> 00:12:51,240
manufacturers this attack was not deemed

289
00:12:51,240 --> 00:12:54,030
a really a practical car only for the do

290
00:12:54,030 --> 00:12:55,950
2d this first requirement that you have

291
00:12:55,950 --> 00:13:00,000
to gather the UID of the car key but and

292
00:13:00,000 --> 00:13:01,860
because of the immobilizer system is a

293
00:13:01,860 --> 00:13:03,840
passive chip you need to be really in

294
00:13:03,840 --> 00:13:06,510
close proximity typically 2 centimeters

295
00:13:06,510 --> 00:13:09,240
from the victim to read the UID of their

296
00:13:09,240 --> 00:13:11,160
key so it will say well yeah this is not

297
00:13:11,160 --> 00:13:13,550
really a concern is not that practical

298
00:13:13,550 --> 00:13:17,510
okay now in the remote keyless entry

299
00:13:17,510 --> 00:13:19,190
context

300
00:13:19,190 --> 00:13:22,819
this this high tattoo cheapest use is

301
00:13:22,819 --> 00:13:24,889
often integrating the both the

302
00:13:24,889 --> 00:13:26,690
immobilizer and the remote keyless entry

303
00:13:26,690 --> 00:13:28,550
system in one chip although they have

304
00:13:28,550 --> 00:13:32,959
different cryptographic keys but the

305
00:13:32,959 --> 00:13:34,670
first thing we notice is that the UID is

306
00:13:34,670 --> 00:13:37,519
the same for both interfaces so this

307
00:13:37,519 --> 00:13:40,339
allows you to eavesdrop the UID of the

308
00:13:40,339 --> 00:13:42,589
MIDI mobilizer through the remote

309
00:13:42,589 --> 00:13:44,029
keyless entry system but this you can do

310
00:13:44,029 --> 00:13:47,300
at a much larger range which which makes

311
00:13:47,300 --> 00:13:48,949
the immobilizer attack already

312
00:13:48,949 --> 00:13:52,220
a lot more powerful but yes in the

313
00:13:52,220 --> 00:13:55,699
remote keyless entry context 136 traces

314
00:13:55,699 --> 00:13:57,949
it's not really practical I would say

315
00:13:57,949 --> 00:13:59,720
because you would have to wait so many

316
00:13:59,720 --> 00:14:02,000
times that the owner pushes the car key

317
00:14:02,000 --> 00:14:04,069
and you will have to be listening in

318
00:14:04,069 --> 00:14:06,829
there so you you wouldn't deem that as a

319
00:14:06,829 --> 00:14:09,920
practical attack so we we went back to

320
00:14:09,920 --> 00:14:11,629
the drawing board and work a bit harder

321
00:14:11,629 --> 00:14:13,850
on the on the attack and we develop a

322
00:14:13,850 --> 00:14:16,220
completely new attack which is now

323
00:14:16,220 --> 00:14:18,500
correlation based but first we needed to

324
00:14:18,500 --> 00:14:20,420
figure out what the protocol the

325
00:14:20,420 --> 00:14:22,220
authentication protocol actually was we

326
00:14:22,220 --> 00:14:24,699
knew what the cipher was so we start

327
00:14:24,699 --> 00:14:27,649
simply observing at the signals being

328
00:14:27,649 --> 00:14:31,790
sent and just just trying trial and

329
00:14:31,790 --> 00:14:35,240
error until we got the the right the

330
00:14:35,240 --> 00:14:41,209
right guesses here is what it was quite

331
00:14:41,209 --> 00:14:43,730
simple it sends a UID a button and

332
00:14:43,730 --> 00:14:47,389
number a counter value and then a Mac of

333
00:14:47,389 --> 00:14:49,910
all the previous values and then as here

334
00:14:49,910 --> 00:14:51,910
C which is just a checksum to detect

335
00:14:51,910 --> 00:14:56,480
transmission errors over-the-air these

336
00:14:56,480 --> 00:15:00,170
this mark is basically just some key

337
00:15:00,170 --> 00:15:01,939
stream generated by a stream cipher

338
00:15:01,939 --> 00:15:04,699
which is initialized with all the UID

339
00:15:04,699 --> 00:15:06,649
the button on the counter and the and a

340
00:15:06,649 --> 00:15:09,470
shared key okay

341
00:15:09,470 --> 00:15:13,430
so this attack that we that I'm going to

342
00:15:13,430 --> 00:15:16,490
describe now requires a four to eight

343
00:15:16,490 --> 00:15:20,149
traces which you can collect easily as

344
00:15:20,149 --> 00:15:23,529
as David just mentioned with an Arduino

345
00:15:23,529 --> 00:15:25,639
inexpensive arenal device we built

346
00:15:25,639 --> 00:15:29,640
ourself which cost about $40

347
00:15:29,640 --> 00:15:32,550
if you want to speed up this harvesting

348
00:15:32,550 --> 00:15:35,670
these traces you could do some how neat

349
00:15:35,670 --> 00:15:39,270
trick reactive jamming so I mentioned

350
00:15:39,270 --> 00:15:40,590
that there is a checksum at the end of

351
00:15:40,590 --> 00:15:43,050
the message so if you are listening with

352
00:15:43,050 --> 00:15:46,530
the with this device until the last bit

353
00:15:46,530 --> 00:15:48,780
of the Mack and then you start sending a

354
00:15:48,780 --> 00:15:50,070
lot of noise

355
00:15:50,070 --> 00:15:52,020
this will jam the checksum and then the

356
00:15:52,020 --> 00:15:55,380
car will ignore that message but yet you

357
00:15:55,380 --> 00:15:57,240
were able to record this whole trace

358
00:15:57,240 --> 00:15:58,740
because the checksum you can compute

359
00:15:58,740 --> 00:16:02,940
yourself so two things may happen either

360
00:16:02,940 --> 00:16:06,480
the own the car owner realizes that the

361
00:16:06,480 --> 00:16:08,520
car didn't blink the lights or so and

362
00:16:08,520 --> 00:16:10,620
then pushes the key again and then you

363
00:16:10,620 --> 00:16:13,770
get an extra trace for free or the owner

364
00:16:13,770 --> 00:16:15,300
doesn't realize that the car didn't

365
00:16:15,300 --> 00:16:16,800
receive the signal and walks away with

366
00:16:16,800 --> 00:16:18,930
the car unlocked in either case the

367
00:16:18,930 --> 00:16:25,170
adversary wins so I'm going to now I

368
00:16:25,170 --> 00:16:27,360
have to abstract a bit of the crypto

369
00:16:27,360 --> 00:16:29,640
details but I will try to give you a bit

370
00:16:29,640 --> 00:16:31,320
of the flavor of the attack and how does

371
00:16:31,320 --> 00:16:33,930
this work this is the high-tech 2 side

372
00:16:33,930 --> 00:16:36,450
first you can see it's based on a 48-bit

373
00:16:36,450 --> 00:16:43,620
lfsr non-linear boolean function which

374
00:16:43,620 --> 00:16:46,200
produces one key to one key one bit of

375
00:16:46,200 --> 00:16:49,860
key stream with every clock tick as I

376
00:16:49,860 --> 00:16:51,480
said decipher as you can imagine is

377
00:16:51,480 --> 00:16:52,770
initialize with all the values the

378
00:16:52,770 --> 00:16:55,590
counter the button numbers the symmetric

379
00:16:55,590 --> 00:16:58,680
key and then it's run to produce this

380
00:16:58,680 --> 00:17:00,420
this Mac which is what gives you the

381
00:17:00,420 --> 00:17:04,430
security in the product so the attack

382
00:17:04,430 --> 00:17:07,859
goes as follows you first will get a 16

383
00:17:07,859 --> 00:17:10,829
bit window there on on the left side of

384
00:17:10,829 --> 00:17:14,849
the lfsr and we we are going to score

385
00:17:14,849 --> 00:17:17,520
our guesses based on correlation as I as

386
00:17:17,520 --> 00:17:20,490
I hinted before and we will compute for

387
00:17:20,490 --> 00:17:23,520
each guess a score based on the ratio of

388
00:17:23,520 --> 00:17:26,339
inputs to this boolean function that

389
00:17:26,339 --> 00:17:30,270
produced the correct key stream bit and

390
00:17:30,270 --> 00:17:32,040
then we will start shift in this window

391
00:17:32,040 --> 00:17:36,270
around and keep on computing the the

392
00:17:36,270 --> 00:17:38,850
score for every offset

393
00:17:38,850 --> 00:17:41,639
and then we really do this for each

394
00:17:41,639 --> 00:17:44,399
offset and we go on like that

395
00:17:44,399 --> 00:17:46,830
once we have all the score we take the

396
00:17:46,830 --> 00:17:48,960
average score for the guests and then we

397
00:17:48,960 --> 00:17:51,840
will keep a table of fixed length and

398
00:17:51,840 --> 00:17:54,210
we'll discard the the guesses with with

399
00:17:54,210 --> 00:17:57,480
low score and then we move on and we

400
00:17:57,480 --> 00:17:59,610
extend this window by one bit now

401
00:17:59,610 --> 00:18:03,389
seventeen bit 18 and 19 and so on and so

402
00:18:03,389 --> 00:18:05,789
forth until we get all the 48 bits from

403
00:18:05,789 --> 00:18:08,970
the internal state of decipher this

404
00:18:08,970 --> 00:18:10,799
sounds a bit complicated and actually

405
00:18:10,799 --> 00:18:12,389
I'm simplifying really a lot because

406
00:18:12,389 --> 00:18:14,190
when you want to do this on many traces

407
00:18:14,190 --> 00:18:17,639
you need to compute the keystream and to

408
00:18:17,639 --> 00:18:19,500
correct the counter the difference in

409
00:18:19,500 --> 00:18:20,940
the counter value in the internal state

410
00:18:20,940 --> 00:18:23,610
but I just want I'm just happy if if you

411
00:18:23,610 --> 00:18:25,169
walk out of here with a bit of the

412
00:18:25,169 --> 00:18:28,919
flavor of how the attack works so this

413
00:18:28,919 --> 00:18:31,500
runs in about one minute on this laptop

414
00:18:31,500 --> 00:18:33,269
and music male 2 percent so knows no

415
00:18:33,269 --> 00:18:35,009
specialized hardware whatsoever and

416
00:18:35,009 --> 00:18:40,169
computes the 48 bits secretly there are

417
00:18:40,169 --> 00:18:43,440
a few practical limitations something I

418
00:18:43,440 --> 00:18:45,210
didn't mention before in the

419
00:18:45,210 --> 00:18:48,029
authentication protocol only the 10

420
00:18:48,029 --> 00:18:49,950
least significant bits of the counter

421
00:18:49,950 --> 00:18:52,740
being sent over over-the-air but all 28

422
00:18:52,740 --> 00:18:55,860
bits of the of the counter are being

423
00:18:55,860 --> 00:18:59,100
used to initialize the cipher and for

424
00:18:59,100 --> 00:19:01,289
the authentication protocol so you will

425
00:19:01,289 --> 00:19:03,330
need to get guess this whole counter but

426
00:19:03,330 --> 00:19:06,179
this is surprisingly easy because for

427
00:19:06,179 --> 00:19:07,830
all the cars we tested which are quite a

428
00:19:07,830 --> 00:19:12,450
few all the key start from 0 so and 10

429
00:19:12,450 --> 00:19:16,769
bits is 1,024 key pushes so yeah it's

430
00:19:16,769 --> 00:19:18,870
not so hard to guess how many thousand

431
00:19:18,870 --> 00:19:20,940
times a victim has pushed the button

432
00:19:20,940 --> 00:19:23,610
especially if it's a recently relatively

433
00:19:23,610 --> 00:19:25,279
new car if it's a car from this year

434
00:19:25,279 --> 00:19:27,779
you're pretty sure the most significant

435
00:19:27,779 --> 00:19:30,990
bits will be either 0 or 1 right and for

436
00:19:30,990 --> 00:19:32,549
all the Indy cars we tested the count

437
00:19:32,549 --> 00:19:34,679
the most significant bits were at most

438
00:19:34,679 --> 00:19:36,809
10 so you can basically run the attack

439
00:19:36,809 --> 00:19:40,409
so many times and find out another

440
00:19:40,409 --> 00:19:43,110
problem we found is that well if you run

441
00:19:43,110 --> 00:19:44,970
this a type that I just described on the

442
00:19:44,970 --> 00:19:46,080
immobilizer

443
00:19:46,080 --> 00:19:48,870
then for traces are enough because the

444
00:19:48,870 --> 00:19:50,490
india10 dication protocol for the

445
00:19:50,490 --> 00:19:51,920
immobilizer you have

446
00:19:51,920 --> 00:19:56,360
random nonsense with this because here

447
00:19:56,360 --> 00:19:58,400
you you have a counter there's only one

448
00:19:58,400 --> 00:20:01,310
bit changing often in in the state and

449
00:20:01,310 --> 00:20:03,200
you can see I have a few real traces

450
00:20:03,200 --> 00:20:05,510
from a real car key and if you see there

451
00:20:05,510 --> 00:20:07,760
are two consecutive valleys there and if

452
00:20:07,760 --> 00:20:09,920
you look at the map you would expect a

453
00:20:09,920 --> 00:20:12,190
cryptographic match to be completely

454
00:20:12,190 --> 00:20:13,970
randomized but if you look at those

455
00:20:13,970 --> 00:20:16,040
values with the naked eye you can spot

456
00:20:16,040 --> 00:20:18,590
that they are really they look pretty

457
00:20:18,590 --> 00:20:20,720
much alike so there are only a few bits

458
00:20:20,720 --> 00:20:23,090
different so the cipher is so bad that

459
00:20:23,090 --> 00:20:25,940
it makes our attack less efficient

460
00:20:25,940 --> 00:20:28,910
because we only get a few bits of

461
00:20:28,910 --> 00:20:31,730
information with with consecutive traces

462
00:20:31,730 --> 00:20:33,620
so that means that in the context of

463
00:20:33,620 --> 00:20:35,330
remote keyless entry system we need a

464
00:20:35,330 --> 00:20:37,280
few more traces typically eight to

465
00:20:37,280 --> 00:20:42,110
recover the secret key okay Tom going to

466
00:20:42,110 --> 00:20:43,640
show you a demo now of this attack from

467
00:20:43,640 --> 00:20:47,810
beginning to end as you can see there is

468
00:20:47,810 --> 00:20:49,790
the Arduino board connected to the

469
00:20:49,790 --> 00:20:53,360
laptop I'm going to first collect a few

470
00:20:53,360 --> 00:20:54,920
traces you can see on the screen

471
00:20:54,920 --> 00:20:59,830
probably there the traces of

472
00:21:20,440 --> 00:21:24,559
there we go but there is the key now we

473
00:21:24,559 --> 00:21:26,269
are going to program that he and the

474
00:21:26,269 --> 00:21:27,679
counter value that we have served on the

475
00:21:27,679 --> 00:21:31,369
traces into this Arduino board which has

476
00:21:31,369 --> 00:21:34,340
cube which has two buttons one to open

477
00:21:34,340 --> 00:21:37,399
the car and one to love it you can see

478
00:21:37,399 --> 00:21:38,299
the car cannot tell the difference

479
00:21:38,299 --> 00:21:40,639
between this Arduino board and a and the

480
00:21:40,639 --> 00:21:49,490
original right

481
00:21:49,490 --> 00:21:53,960
so we tested this this attack known on

482
00:21:53,960 --> 00:21:57,080
many many vehicles which we got from

483
00:21:57,080 --> 00:21:59,690
friends and and colleagues which who

484
00:21:59,690 --> 00:22:04,190
were kind enough to lend us their car as

485
00:22:04,190 --> 00:22:05,600
you can see is quite at least some

486
00:22:05,600 --> 00:22:11,289
eighteen vehicles and quite a few 2016

487
00:22:11,289 --> 00:22:16,429
cars so yes we are running out of time

488
00:22:16,429 --> 00:22:20,779
so I will just move to the conclusions I

489
00:22:20,779 --> 00:22:25,009
wanted to say that as always we engaged

490
00:22:25,009 --> 00:22:27,190
in responsible disclosure we informed

491
00:22:27,190 --> 00:22:30,379
the buzzwagon group of our findings back

492
00:22:30,379 --> 00:22:33,649
in December 2015 and NXP Semiconductors

493
00:22:33,649 --> 00:22:36,200
the the manufacturers of the hi-tech -

494
00:22:36,200 --> 00:22:40,070
transponder back in January 2016 and I

495
00:22:40,070 --> 00:22:41,960
can say that the communication has been

496
00:22:41,960 --> 00:22:48,830
friendly and constructive so yes you see

497
00:22:48,830 --> 00:22:52,119
it is a bit surprising that a hi-tech -

498
00:22:52,119 --> 00:22:55,039
is still being used in vehicles from

499
00:22:55,039 --> 00:22:57,919
this year since the Hydra - cipher has

500
00:22:57,919 --> 00:23:00,320
been shown to have deficiencies for

501
00:23:00,320 --> 00:23:04,549
quite a few years now yes and we hope

502
00:23:04,549 --> 00:23:08,210
that this research will explain several

503
00:23:08,210 --> 00:23:11,840
cases mysterious cases of of theft where

504
00:23:11,840 --> 00:23:14,629
there was no sign of forced entry but

505
00:23:14,629 --> 00:23:18,230
yet things were missing from cars or the

506
00:23:18,230 --> 00:23:19,700
cars themselves and then the insurance

507
00:23:19,700 --> 00:23:23,210
was puzzled or was sceptical about those

508
00:23:23,210 --> 00:23:26,830
claims thank you

509
00:23:33,360 --> 00:23:35,770
that's an easy technical question the

510
00:23:35,770 --> 00:23:37,450
counters are the different for each UID

511
00:23:37,450 --> 00:23:43,410
or is it one for the for the car so the

512
00:23:43,410 --> 00:23:45,820
question was if the counters are

513
00:23:45,820 --> 00:23:48,220
different for each remote yes

514
00:23:48,220 --> 00:23:51,730
essentially yes yes would have always if

515
00:23:51,730 --> 00:23:53,500
your wife opened your car you would have

516
00:23:53,500 --> 00:23:55,420
to press ten times again that's so

517
00:23:55,420 --> 00:23:56,920
that's what I thought the other question

518
00:23:56,920 --> 00:24:00,280
is you might know the answer or not want

519
00:24:00,280 --> 00:24:02,710
to answer but are you aware whether

520
00:24:02,710 --> 00:24:04,390
these systems were designed by the

521
00:24:04,390 --> 00:24:06,400
engineers within the automotive industry

522
00:24:06,400 --> 00:24:10,000
or whether it was it outsourced was it

523
00:24:10,000 --> 00:24:11,230
some other company they have some

524
00:24:11,230 --> 00:24:17,380
technology that they bought in usually

525
00:24:17,380 --> 00:24:20,530
these companies have some suppliers that

526
00:24:20,530 --> 00:24:22,120
design the systems we don't know if it

527
00:24:22,120 --> 00:24:25,060
was true as a specification of the car

528
00:24:25,060 --> 00:24:27,130
companies or if they just externally

529
00:24:27,130 --> 00:24:31,230
bought it with a high-tech - system I

530
00:24:31,230 --> 00:24:34,510
think it's a system basically specified

531
00:24:34,510 --> 00:24:37,810
by an XP originally but automotive

532
00:24:37,810 --> 00:24:39,760
manufacturers of course free or was free

533
00:24:39,760 --> 00:24:42,100
to also modify the system times they

534
00:24:42,100 --> 00:24:48,280
took a small differences so regarding

535
00:24:48,280 --> 00:24:52,240
the Volkswagen I mean the immobilizers

536
00:24:52,240 --> 00:24:55,420
they typically use different keys per

537
00:24:55,420 --> 00:24:58,450
key right so there must be a mechanism

538
00:24:58,450 --> 00:25:02,920
in place to to hold out individual keys

539
00:25:02,920 --> 00:25:07,030
/ p4 so as when you communicate it with

540
00:25:07,030 --> 00:25:08,440
folks form have they given you any

541
00:25:08,440 --> 00:25:11,320
explanation why they are using one

542
00:25:11,320 --> 00:25:17,020
worldwide key I mean how stupid is that

543
00:25:17,020 --> 00:25:20,770
oh we were when we initially looked at

544
00:25:20,770 --> 00:25:22,630
the systems we were also very surprised

545
00:25:22,630 --> 00:25:25,140
to see this and we have never found any

546
00:25:25,140 --> 00:25:29,350
easy explanation I mean I mean the only

547
00:25:29,350 --> 00:25:31,270
lame excuse could be that they don't

548
00:25:31,270 --> 00:25:33,040
have a mechanism to roll out the keys

549
00:25:33,040 --> 00:25:34,929
into the key fobs but money immobilizer

550
00:25:34,929 --> 00:25:38,110
say this has to be there yes the

551
00:25:38,110 --> 00:25:39,730
immobilizer system in fork swung is

552
00:25:39,730 --> 00:25:41,350
really completely separate so you have

553
00:25:41,350 --> 00:25:43,330
this glass transponder which has no

554
00:25:43,330 --> 00:25:45,460
connection to the Archaea system so

555
00:25:45,460 --> 00:25:47,040
probably said some reasons that they

556
00:25:47,040 --> 00:25:50,429
didn't have this hybrid chip okay

557
00:25:50,429 --> 00:25:55,000
simplistic to system has a keeper car

558
00:25:55,000 --> 00:26:00,850
key let's say a different key yeah so

559
00:26:00,850 --> 00:26:02,770
actually I also have a question so can

560
00:26:02,770 --> 00:26:05,820
you elaborate a little bit on your

561
00:26:05,820 --> 00:26:08,050
experience with responsible disclosure

562
00:26:08,050 --> 00:26:11,530
Express especially you know comparing

563
00:26:11,530 --> 00:26:13,780
this how things have changed comparing

564
00:26:13,780 --> 00:26:15,670
to your previous experiences with a mega

565
00:26:15,670 --> 00:26:22,750
Mo's attack yes so by now we we knew the

566
00:26:22,750 --> 00:26:25,420
technical people within within the

567
00:26:25,420 --> 00:26:28,840
companies and that helps a lot so I

568
00:26:28,840 --> 00:26:31,360
always get getting to a company through

569
00:26:31,360 --> 00:26:34,210
the technical person's help a lot and

570
00:26:34,210 --> 00:26:37,059
they understand why we're doing this and

571
00:26:37,059 --> 00:26:39,400
then then the the climate is very

572
00:26:39,400 --> 00:26:44,140
different yeah all right great so if

573
00:26:44,140 --> 00:26:45,610
there are no more questions let's prank

574
00:26:45,610 --> 00:26:46,420
two speakers

575
00:26:46,420 --> 00:26:52,390
[Applause]

