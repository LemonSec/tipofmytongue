1
00:00:10,800 --> 00:00:12,559
okay so

2
00:00:12,559 --> 00:00:14,639
hi i'm daniel and i'm going to present

3
00:00:14,639 --> 00:00:16,480
the results of our measurement study on

4
00:00:16,480 --> 00:00:18,320
domain generating malware

5
00:00:18,320 --> 00:00:20,240
since this is basically the last slot of

6
00:00:20,240 --> 00:00:22,240
today and i need to check if you are

7
00:00:22,240 --> 00:00:24,960
still awake we play a little game and

8
00:00:24,960 --> 00:00:27,920
just be ready to raise your hand okay

9
00:00:27,920 --> 00:00:29,760
who thinks that this domain is

10
00:00:29,760 --> 00:00:32,479
automatically generated

11
00:00:32,479 --> 00:00:35,120
yeah okay yeah correct so that's

12
00:00:35,120 --> 00:00:37,120
cryptolocker for instance um what about

13
00:00:37,120 --> 00:00:39,600
this one also generated

14
00:00:39,600 --> 00:00:42,559
yeah yeah it's also generated this is ul

15
00:00:42,559 --> 00:00:45,120
zone and this one

16
00:00:45,120 --> 00:00:47,360
i know you're curious um

17
00:00:47,360 --> 00:00:49,120
okay still some people and this is

18
00:00:49,120 --> 00:00:50,800
basically just what i've been in for a

19
00:00:50,800 --> 00:00:51,840
long time

20
00:00:51,840 --> 00:00:54,399
though just a cat on my keyboard and the

21
00:00:54,399 --> 00:00:55,840
thing is you cannot really distinguish

22
00:00:55,840 --> 00:00:57,920
that stuff and it really frustrated me

23
00:00:57,920 --> 00:00:59,199
two years ago

24
00:00:59,199 --> 00:01:00,960
which is why i got into this research so

25
00:01:00,960 --> 00:01:04,720
basically this just as a short forward

26
00:01:04,720 --> 00:01:06,320
now i'm first doing a short intro on

27
00:01:06,320 --> 00:01:08,400
domain generation algorithms and next

28
00:01:08,400 --> 00:01:11,119
doing a summary of our findings

29
00:01:11,119 --> 00:01:12,720
then shortly going to talk about the

30
00:01:12,720 --> 00:01:14,560
data set that we have composed here um

31
00:01:14,560 --> 00:01:16,159
that we are also going to share with the

32
00:01:16,159 --> 00:01:17,600
community so you can if you're

33
00:01:17,600 --> 00:01:19,119
interested in that kind of stuff work on

34
00:01:19,119 --> 00:01:19,840
it

35
00:01:19,840 --> 00:01:22,320
um going to present the taxonomy that we

36
00:01:22,320 --> 00:01:23,920
have derived based on that data as well

37
00:01:23,920 --> 00:01:25,759
as looking into the registrations and

38
00:01:25,759 --> 00:01:28,240
collisions that you can find of domain

39
00:01:28,240 --> 00:01:31,840
generation algorithms and between those

40
00:01:31,840 --> 00:01:34,479
okay so first about domain generation

41
00:01:34,479 --> 00:01:36,079
algorithms

42
00:01:36,079 --> 00:01:37,840
it's a concept that's basically floating

43
00:01:37,840 --> 00:01:40,240
around since 2008 already so it came

44
00:01:40,240 --> 00:01:42,960
basically up in the same time as fast

45
00:01:42,960 --> 00:01:45,439
blocks so instead of quickly rotating ip

46
00:01:45,439 --> 00:01:46,880
addresses it's basically quickly

47
00:01:46,880 --> 00:01:48,880
rotating domain names

48
00:01:48,880 --> 00:01:50,960
and you can think of a domain generation

49
00:01:50,960 --> 00:01:53,600
algorithm as something that's basically

50
00:01:53,600 --> 00:01:56,479
dynamically generating command control

51
00:01:56,479 --> 00:01:58,240
rendezvous points so your malware knows

52
00:01:58,240 --> 00:02:00,399
which server to talk to and it's

53
00:02:00,399 --> 00:02:02,880
somewhat like a shared secret between

54
00:02:02,880 --> 00:02:04,240
the malware running on the compromised

55
00:02:04,240 --> 00:02:05,280
system

56
00:02:05,280 --> 00:02:07,360
and the bob master who also has to be

57
00:02:07,360 --> 00:02:08,560
able to

58
00:02:08,560 --> 00:02:10,878
basically calculate those domains

59
00:02:10,878 --> 00:02:12,800
another term that i'll be using here

60
00:02:12,800 --> 00:02:14,640
probably a lot is a seed

61
00:02:14,640 --> 00:02:16,239
and the seed is basically just the

62
00:02:16,239 --> 00:02:18,000
collection of parameters

63
00:02:18,000 --> 00:02:20,239
that is influencing the output of the

64
00:02:20,239 --> 00:02:24,400
set algorithm and finally agd is just a

65
00:02:24,400 --> 00:02:26,319
short abbreviation for basically what

66
00:02:26,319 --> 00:02:28,480
dji is spitting out so i grew up with

67
00:02:28,480 --> 00:02:31,840
the generated domains

68
00:02:31,920 --> 00:02:34,400
why would you want to use the dji

69
00:02:34,400 --> 00:02:36,879
so first off it's aggravating analysis

70
00:02:36,879 --> 00:02:38,319
so in the good old days it would be

71
00:02:38,319 --> 00:02:40,640
enough to just run a malware sample pull

72
00:02:40,640 --> 00:02:42,640
a memory dump of it and basically just

73
00:02:42,640 --> 00:02:44,239
look for hard-coded ip addresses or

74
00:02:44,239 --> 00:02:46,160
domain names um if you have dga you

75
00:02:46,160 --> 00:02:47,680
basically have to analyze code in order

76
00:02:47,680 --> 00:02:49,760
to understand what domains the malware

77
00:02:49,760 --> 00:02:51,840
might be talking to so a lot of effort

78
00:02:51,840 --> 00:02:53,280
going into that

79
00:02:53,280 --> 00:02:54,400
evasion

80
00:02:54,400 --> 00:02:56,319
many of the djs are using very

81
00:02:56,319 --> 00:02:58,159
short-lived domains so basically just a

82
00:02:58,159 --> 00:03:00,319
single day and if you look at

83
00:03:00,319 --> 00:03:02,879
blacklisting they are getting stale

84
00:03:02,879 --> 00:03:04,879
pretty quickly so we have to rotate a

85
00:03:04,879 --> 00:03:07,440
lot of domains in a short

86
00:03:07,440 --> 00:03:09,280
amount of time or basically

87
00:03:09,280 --> 00:03:11,280
um the dja domains are not caught up by

88
00:03:11,280 --> 00:03:12,720
blacklist at all

89
00:03:12,720 --> 00:03:14,720
um backup

90
00:03:14,720 --> 00:03:16,239
you as a bot master only need to

91
00:03:16,239 --> 00:03:17,680
register those domains if you really

92
00:03:17,680 --> 00:03:20,080
need them so for example um if you

93
00:03:20,080 --> 00:03:21,760
see that your current domain has been

94
00:03:21,760 --> 00:03:25,120
taken out you just take the next one

95
00:03:25,120 --> 00:03:27,200
there's a lot of asymmetry going on here

96
00:03:27,200 --> 00:03:28,799
so an attacker only needs a single

97
00:03:28,799 --> 00:03:31,040
domain in out of control control of his

98
00:03:31,040 --> 00:03:33,280
compromise systems while the defender if

99
00:03:33,280 --> 00:03:35,280
you want to do a takedown has to seize

100
00:03:35,280 --> 00:03:37,360
control of all of the domains or at

101
00:03:37,360 --> 00:03:40,000
least private access to them

102
00:03:40,000 --> 00:03:42,239
and finally um yeah domains are pretty

103
00:03:42,239 --> 00:03:44,480
cheap so this basically scales really

104
00:03:44,480 --> 00:03:46,159
well

105
00:03:46,159 --> 00:03:48,640
key findings so first what have we been

106
00:03:48,640 --> 00:03:51,360
doing in the study

107
00:03:51,360 --> 00:03:53,840
yeah we basically recovered 43 different

108
00:03:53,840 --> 00:03:56,319
dji implementations by doing reverse

109
00:03:56,319 --> 00:03:57,439
engineering

110
00:03:57,439 --> 00:03:59,439
and since it was asked in one of the

111
00:03:59,439 --> 00:04:02,480
reviews um on average it took about one

112
00:04:02,480 --> 00:04:03,360
day

113
00:04:03,360 --> 00:04:04,159
to

114
00:04:04,159 --> 00:04:06,879
basically re-implement one of those dgas

115
00:04:06,879 --> 00:04:08,879
um the the worst example was basically

116
00:04:08,879 --> 00:04:10,720
that i got stuck for a whole week when i

117
00:04:10,720 --> 00:04:13,439
had to debug a flawed implementation of

118
00:04:13,439 --> 00:04:15,920
mesentwister

119
00:04:15,920 --> 00:04:17,519
and the easiest examples are probably

120
00:04:17,519 --> 00:04:18,478
just

121
00:04:18,478 --> 00:04:20,478
a couple of minutes to an hour if it's

122
00:04:20,478 --> 00:04:23,199
really very cheap pseudo random number

123
00:04:23,199 --> 00:04:24,960
generator it's spitting out randomly

124
00:04:24,960 --> 00:04:27,440
characters

125
00:04:27,440 --> 00:04:29,280
by looking at a lot of malware samples

126
00:04:29,280 --> 00:04:31,759
we were able to extract 253 different

127
00:04:31,759 --> 00:04:32,800
seeds

128
00:04:32,800 --> 00:04:35,680
using those dgas and basically generated

129
00:04:35,680 --> 00:04:38,639
a data set of close to 160 million

130
00:04:38,639 --> 00:04:41,680
unique agds

131
00:04:41,680 --> 00:04:43,280
based on that data we were able to

132
00:04:43,280 --> 00:04:45,120
derive some characteristics about them

133
00:04:45,120 --> 00:04:48,880
and define a taxonomy and also to look

134
00:04:48,880 --> 00:04:50,639
for collisions between those different

135
00:04:50,639 --> 00:04:53,120
dgas

136
00:04:53,120 --> 00:04:55,440
next i got really lucky um when i got in

137
00:04:55,440 --> 00:04:56,800
touch with domain tools because they

138
00:04:56,800 --> 00:04:58,400
basically gave me access to their data

139
00:04:58,400 --> 00:05:01,039
which enabled me to look up the history

140
00:05:01,039 --> 00:05:03,199
for up to 18 million

141
00:05:03,199 --> 00:05:05,680
of such domains from 38 families i had

142
00:05:05,680 --> 00:05:07,919
to exclude some of them which i will

143
00:05:07,919 --> 00:05:08,880
explain

144
00:05:08,880 --> 00:05:11,680
shortly later

145
00:05:11,680 --> 00:05:13,759
anyhow we basically were able to look at

146
00:05:13,759 --> 00:05:15,440
the registration status so basically

147
00:05:15,440 --> 00:05:17,520
derive how many of those

148
00:05:17,520 --> 00:05:19,759
dga domains are actually registered and

149
00:05:19,759 --> 00:05:22,720
when were they registered for example

150
00:05:22,720 --> 00:05:24,960
and also are they colliding with the

151
00:05:24,960 --> 00:05:27,440
domain space of benign domains so

152
00:05:27,440 --> 00:05:29,039
basically um there's this one famous

153
00:05:29,039 --> 00:05:30,639
example of configure from a couple years

154
00:05:30,639 --> 00:05:32,800
ago where configure would generate

155
00:05:32,800 --> 00:05:34,479
itunes.is

156
00:05:34,479 --> 00:05:36,320
and basically giving apple a lot of

157
00:05:36,320 --> 00:05:39,680
influence of traffic

158
00:05:39,680 --> 00:05:42,240
what if we find out here so

159
00:05:42,240 --> 00:05:45,120
with those 43 different djs we have been

160
00:05:45,120 --> 00:05:46,800
looking at only three of them are using

161
00:05:46,800 --> 00:05:49,199
word lists so basically would be

162
00:05:49,199 --> 00:05:51,360
generating domains that look somewhat

163
00:05:51,360 --> 00:05:53,120
like natural domains

164
00:05:53,120 --> 00:05:54,720
which is a good sign because it means

165
00:05:54,720 --> 00:05:55,680
that the

166
00:05:55,680 --> 00:05:57,600
detection methodology that has been

167
00:05:57,600 --> 00:05:59,759
defined in previous papers still holds

168
00:05:59,759 --> 00:06:01,600
true and works well on those for example

169
00:06:01,600 --> 00:06:04,639
as defined in this paper here by antono

170
00:06:04,639 --> 00:06:06,319
carcass

171
00:06:06,319 --> 00:06:08,160
next um from

172
00:06:08,160 --> 00:06:10,319
our point of view djs massively

173
00:06:10,319 --> 00:06:12,080
increased in relevance over the last two

174
00:06:12,080 --> 00:06:16,240
or three years so um 25 out of those 43

175
00:06:16,240 --> 00:06:20,880
vgas appeared only in 2013 and later

176
00:06:20,880 --> 00:06:22,720
um from a bob master perspective

177
00:06:22,720 --> 00:06:24,720
probably correlating with that um djs

178
00:06:24,720 --> 00:06:27,680
are pretty effective um we found that

179
00:06:27,680 --> 00:06:30,240
the hdds so the generated domains are

180
00:06:30,240 --> 00:06:32,639
barely mitigated in time so um we were

181
00:06:32,639 --> 00:06:34,160
based on the sewers data for example we

182
00:06:34,160 --> 00:06:36,400
were looking at um if control of a

183
00:06:36,400 --> 00:06:38,400
domain shifted from a non-sinkhole to a

184
00:06:38,400 --> 00:06:39,440
sinkhole

185
00:06:39,440 --> 00:06:40,960
and in many of the cases where we

186
00:06:40,960 --> 00:06:42,800
observed those kinds of events it

187
00:06:42,800 --> 00:06:44,639
basically happened after the

188
00:06:44,639 --> 00:06:47,440
hdd was no longer valid so basically

189
00:06:47,440 --> 00:06:48,880
there was a mitigation but it didn't

190
00:06:48,880 --> 00:06:50,479
have any effect at all

191
00:06:50,479 --> 00:06:53,039
and looking at takedowns um yeah the

192
00:06:53,039 --> 00:06:54,639
only way that you probably

193
00:06:54,639 --> 00:06:56,240
would have here is buying a lot of

194
00:06:56,240 --> 00:06:58,000
domains for example this happened with a

195
00:06:58,000 --> 00:07:00,560
game over peer-to-peer and if you have

196
00:07:00,560 --> 00:07:01,599
to buy

197
00:07:01,599 --> 00:07:03,360
a couple of ten thousand of domains in

198
00:07:03,360 --> 00:07:04,960
order to just take down about net it's

199
00:07:04,960 --> 00:07:07,759
it's getting pretty expensive

200
00:07:07,759 --> 00:07:09,680
however there's also good news

201
00:07:09,680 --> 00:07:12,479
we found that dga domains barely collide

202
00:07:12,479 --> 00:07:13,520
so

203
00:07:13,520 --> 00:07:14,560
neither

204
00:07:14,560 --> 00:07:16,800
within a dj nor with

205
00:07:16,800 --> 00:07:18,319
b9 domains

206
00:07:18,319 --> 00:07:20,479
which means on the one hand

207
00:07:20,479 --> 00:07:22,720
dja domains if you pre-generate them are

208
00:07:22,720 --> 00:07:25,360
a great feature to just based on the dns

209
00:07:25,360 --> 00:07:28,240
output of a sandbox run for example

210
00:07:28,240 --> 00:07:29,919
can be used to identify the mother

211
00:07:29,919 --> 00:07:32,080
formally as well as a campaign and on

212
00:07:32,080 --> 00:07:33,840
the other hand if you don't have any

213
00:07:33,840 --> 00:07:35,360
collisions with b9 domains you can

214
00:07:35,360 --> 00:07:37,680
directly use them for blocking without

215
00:07:37,680 --> 00:07:40,800
having to fear a lot of false positives

216
00:07:40,800 --> 00:07:44,160
okay so for the data set

217
00:07:44,160 --> 00:07:46,560
this is basically the the core id which

218
00:07:46,560 --> 00:07:49,039
connects to the example that they gave

219
00:07:49,039 --> 00:07:50,960
in my forward

220
00:07:50,960 --> 00:07:52,879
by reverse engineering the the idea was

221
00:07:52,879 --> 00:07:54,479
basically to generate as many in the

222
00:07:54,479 --> 00:07:56,639
archive as many of those domains as

223
00:07:56,639 --> 00:07:58,560
possible so we ended up with this this

224
00:07:58,560 --> 00:08:01,599
database with this core idea so i don't

225
00:08:01,599 --> 00:08:03,599
have to to guess what the domain might

226
00:08:03,599 --> 00:08:06,000
be um i would just ask my database we

227
00:08:06,000 --> 00:08:07,840
know that one and it would tell me okay

228
00:08:07,840 --> 00:08:09,680
it's that family and

229
00:08:09,680 --> 00:08:11,520
this domain is basically valid on and

230
00:08:11,520 --> 00:08:12,960
this and that day

231
00:08:12,960 --> 00:08:15,199
and the logical net step was

232
00:08:15,199 --> 00:08:17,039
okay if i if i'm able to predict which

233
00:08:17,039 --> 00:08:18,879
domains are valid on which days i can

234
00:08:18,879 --> 00:08:20,960
derive block lists for all of the given

235
00:08:20,960 --> 00:08:23,199
days

236
00:08:23,199 --> 00:08:26,240
um now how to find dgas that you want to

237
00:08:26,240 --> 00:08:28,160
reverse engineer

238
00:08:28,160 --> 00:08:30,479
we use the only

239
00:08:30,479 --> 00:08:32,080
first let's look at them how you can

240
00:08:32,080 --> 00:08:35,200
classify domains we use the remix of

241
00:08:35,200 --> 00:08:37,200
academic approaches here and some some

242
00:08:37,200 --> 00:08:40,719
common sense we have to put in as well

243
00:08:40,719 --> 00:08:42,320
first the input that we were using here

244
00:08:42,320 --> 00:08:44,880
is lists of domains so um from shadow

245
00:08:44,880 --> 00:08:47,200
server we were basically receiving the

246
00:08:47,200 --> 00:08:48,399
full

247
00:08:48,399 --> 00:08:50,320
sandbox output that they produce

248
00:08:50,320 --> 00:08:52,399
basically telling us which member sample

249
00:08:52,399 --> 00:08:55,839
is talking to which domains

250
00:08:55,839 --> 00:08:58,160
and for the paper we used 1.2 million

251
00:08:58,160 --> 00:08:59,760
sandbox ones here

252
00:08:59,760 --> 00:09:03,440
which carried about 15.6 million

253
00:09:03,440 --> 00:09:05,440
year domain names out of them almost a

254
00:09:05,440 --> 00:09:07,120
million unique

255
00:09:07,120 --> 00:09:09,040
in the first filter step we would

256
00:09:09,040 --> 00:09:11,519
filter out some popular domains um over

257
00:09:11,519 --> 00:09:13,600
time we were curating

258
00:09:13,600 --> 00:09:16,640
our own blacklist in order to

259
00:09:16,640 --> 00:09:19,519
filter out common non-dja malware which

260
00:09:19,519 --> 00:09:21,200
basically used domains that looked like

261
00:09:21,200 --> 00:09:22,800
dja but actually weren't because they

262
00:09:22,800 --> 00:09:24,080
were hard coded

263
00:09:24,080 --> 00:09:26,640
and finally we could also filter already

264
00:09:26,640 --> 00:09:28,080
against the database of domains that we

265
00:09:28,080 --> 00:09:29,120
had there

266
00:09:29,120 --> 00:09:30,800
in the second step

267
00:09:30,800 --> 00:09:32,399
we would then look at the angular

268
00:09:32,399 --> 00:09:34,560
frequency of those domains because if

269
00:09:34,560 --> 00:09:37,279
domains are random you can expect

270
00:09:37,279 --> 00:09:39,279
combinations of characters that are not

271
00:09:39,279 --> 00:09:41,600
common in natural language which which

272
00:09:41,600 --> 00:09:43,040
proves really well here

273
00:09:43,040 --> 00:09:44,480
this is also an idea of the of the paper

274
00:09:44,480 --> 00:09:46,480
that i just listed earlier

275
00:09:46,480 --> 00:09:47,920
as well as entropy

276
00:09:47,920 --> 00:09:49,680
and one of the findings we had in the

277
00:09:49,680 --> 00:09:52,000
course is basically dj domains are not

278
00:09:52,000 --> 00:09:54,480
really short so you can use that as well

279
00:09:54,480 --> 00:09:56,959
as you will see many nx domain hits

280
00:09:56,959 --> 00:09:59,200
there as well because botmasters do not

281
00:09:59,200 --> 00:10:00,959
or basically all of the mains are not

282
00:10:00,959 --> 00:10:02,480
registered so they're basically hitting

283
00:10:02,480 --> 00:10:06,959
into nothing and finally by matching

284
00:10:06,959 --> 00:10:07,920
the

285
00:10:07,920 --> 00:10:09,839
highest scoring domains against a couple

286
00:10:09,839 --> 00:10:10,880
of patterns

287
00:10:10,880 --> 00:10:13,279
we can predict which family it might be

288
00:10:13,279 --> 00:10:15,040
which helps us because

289
00:10:15,040 --> 00:10:17,440
if we get a lot of matches

290
00:10:17,440 --> 00:10:19,839
on the same domains we can probably

291
00:10:19,839 --> 00:10:20,880
infer

292
00:10:20,880 --> 00:10:22,240
it's a new seed

293
00:10:22,240 --> 00:10:24,480
because it's not listed in our archive

294
00:10:24,480 --> 00:10:26,320
yet and otherwise if we have

295
00:10:26,320 --> 00:10:27,760
inconsistent matches we can probably

296
00:10:27,760 --> 00:10:30,000
infer it's like a new dj and then we

297
00:10:30,000 --> 00:10:31,600
have to do the reverse engineering all

298
00:10:31,600 --> 00:10:33,200
over again

299
00:10:33,200 --> 00:10:35,040
since we didn't stop after writing the

300
00:10:35,040 --> 00:10:36,079
paper

301
00:10:36,079 --> 00:10:38,480
we have now been looking at 8.8 million

302
00:10:38,480 --> 00:10:41,839
sandbox runs and 4.7 million unique

303
00:10:41,839 --> 00:10:43,839
domains in the course which also helped

304
00:10:43,839 --> 00:10:46,640
us lifting the numbers of covered dgas

305
00:10:46,640 --> 00:10:47,839
further

306
00:10:47,839 --> 00:10:49,760
so for the paper

307
00:10:49,760 --> 00:10:52,079
like i mentioned we were looking at 43

308
00:10:52,079 --> 00:10:55,040
different families with 250 free seats

309
00:10:55,040 --> 00:10:58,079
and 20 million domains um dj archive now

310
00:10:58,079 --> 00:11:02,480
tracks 59 families with 511 seats and 49

311
00:11:02,480 --> 00:11:03,760
million domains

312
00:11:03,760 --> 00:11:06,160
um the web service is already used

313
00:11:06,160 --> 00:11:08,399
by more than 300 different parties um

314
00:11:08,399 --> 00:11:10,720
including isps that are using it to

315
00:11:10,720 --> 00:11:12,839
protect their customers some financial

316
00:11:12,839 --> 00:11:15,680
institutions certs law enforcement avs

317
00:11:15,680 --> 00:11:17,920
and researchers so it's basically having

318
00:11:17,920 --> 00:11:19,200
some impact which is basically the

319
00:11:19,200 --> 00:11:20,640
nicest thing that you can have in doing

320
00:11:20,640 --> 00:11:21,760
research

321
00:11:21,760 --> 00:11:26,240
okay so looking at the taxonomy

322
00:11:26,320 --> 00:11:28,160
one main feature or two main features

323
00:11:28,160 --> 00:11:30,480
when looking at dgas

324
00:11:30,480 --> 00:11:32,959
are basically they can be time dependent

325
00:11:32,959 --> 00:11:35,040
or not so meaning if you run the malware

326
00:11:35,040 --> 00:11:36,720
sample it will always

327
00:11:36,720 --> 00:11:39,120
throughout the for the same domains

328
00:11:39,120 --> 00:11:40,800
regardless of the time it is being

329
00:11:40,800 --> 00:11:42,880
executed or it can be time dependent

330
00:11:42,880 --> 00:11:45,360
meaning if you execute it today and

331
00:11:45,360 --> 00:11:47,279
tomorrow tomorrow you will see a total

332
00:11:47,279 --> 00:11:49,040
different set of domains

333
00:11:49,040 --> 00:11:51,839
so this is basically time defense and

334
00:11:51,839 --> 00:11:54,000
the second feature is

335
00:11:54,000 --> 00:11:55,279
determinism

336
00:11:55,279 --> 00:11:56,639
in a sense

337
00:11:56,639 --> 00:11:59,680
that it doesn't matter where or when the

338
00:11:59,680 --> 00:12:01,519
member sample is executed it will

339
00:12:01,519 --> 00:12:03,440
produce the same domains um the basic

340
00:12:03,440 --> 00:12:04,880
example for that is

341
00:12:04,880 --> 00:12:06,880
if it's non-deterministic it will for

342
00:12:06,880 --> 00:12:08,639
example fetch additional information

343
00:12:08,639 --> 00:12:10,240
from the internet and in the past

344
00:12:10,240 --> 00:12:12,240
there's been topic using twitter trends

345
00:12:12,240 --> 00:12:15,360
for example and a new example is bdap

346
00:12:15,360 --> 00:12:16,800
which has been using currency

347
00:12:16,800 --> 00:12:19,839
information on a weekly schedule so this

348
00:12:19,839 --> 00:12:21,760
basically just means that you are not

349
00:12:21,760 --> 00:12:24,000
able to predict

350
00:12:24,000 --> 00:12:25,839
future domains beyond the certain

351
00:12:25,839 --> 00:12:27,519
threshold of information that is being

352
00:12:27,519 --> 00:12:28,639
fetched there

353
00:12:28,639 --> 00:12:29,680
the last

354
00:12:29,680 --> 00:12:31,760
example basically being non-time

355
00:12:31,760 --> 00:12:34,000
dependent and non-deterministic i didn't

356
00:12:34,000 --> 00:12:36,880
observe anything for that one yet

357
00:12:36,880 --> 00:12:38,800
one scenario that you basically can

358
00:12:38,800 --> 00:12:40,000
think of is

359
00:12:40,000 --> 00:12:42,560
you have a malware that scrapes

360
00:12:42,560 --> 00:12:44,000
information from the system and it's

361
00:12:44,000 --> 00:12:45,440
running on sending that to the bob

362
00:12:45,440 --> 00:12:48,000
master and in that way basically sharing

363
00:12:48,000 --> 00:12:49,440
information that's not visible to the

364
00:12:49,440 --> 00:12:51,360
outside

365
00:12:51,360 --> 00:12:53,279
not seen so far um something close to

366
00:12:53,279 --> 00:12:56,560
that has been used by one apt but not

367
00:12:56,560 --> 00:12:59,360
the exact case and secondly um looking

368
00:12:59,360 --> 00:13:02,480
for example at the generation schemes

369
00:13:02,480 --> 00:13:04,399
the first one arithmetic

370
00:13:04,399 --> 00:13:06,399
is basically the the standard one which

371
00:13:06,399 --> 00:13:08,079
you would expect when looking at dja

372
00:13:08,079 --> 00:13:09,600
domains those

373
00:13:09,600 --> 00:13:11,839
randomly looking domain names

374
00:13:11,839 --> 00:13:15,040
um second variation would be word lists

375
00:13:15,040 --> 00:13:17,440
in this case term except here basically

376
00:13:17,440 --> 00:13:19,120
combinations of words that are being

377
00:13:19,120 --> 00:13:21,839
randomly picked from

378
00:13:21,839 --> 00:13:24,240
one or more lists of words

379
00:13:24,240 --> 00:13:26,240
third version being hashing where

380
00:13:26,240 --> 00:13:28,240
directly a hash is being used as a

381
00:13:28,240 --> 00:13:30,480
domain name and lastly there's

382
00:13:30,480 --> 00:13:32,320
permutation which only one family is

383
00:13:32,320 --> 00:13:34,320
using

384
00:13:34,320 --> 00:13:36,480
basically means that based on the start

385
00:13:36,480 --> 00:13:38,320
domain you would

386
00:13:38,320 --> 00:13:42,000
do a permutation of the letters in there

387
00:13:42,000 --> 00:13:43,040
okay

388
00:13:43,040 --> 00:13:45,279
now the interesting part how are dji

389
00:13:45,279 --> 00:13:48,320
domains used

390
00:13:48,320 --> 00:13:50,399
some things that we were interested in

391
00:13:50,399 --> 00:13:52,399
for example how many potential dj

392
00:13:52,399 --> 00:13:54,800
domains are there so how many could we

393
00:13:54,800 --> 00:13:56,399
basically generate two to get the full

394
00:13:56,399 --> 00:13:57,360
set

395
00:13:57,360 --> 00:13:59,839
and how many of these are actually

396
00:13:59,839 --> 00:14:00,959
registered

397
00:14:00,959 --> 00:14:02,639
and basically the collisions as i've

398
00:14:02,639 --> 00:14:05,040
already mentioned and which i will be

399
00:14:05,040 --> 00:14:06,560
not addressing here but which you will

400
00:14:06,560 --> 00:14:08,560
find in the paper as well as

401
00:14:08,560 --> 00:14:10,880
other recognizable patterns

402
00:14:10,880 --> 00:14:12,560
how much upfront

403
00:14:12,560 --> 00:14:14,880
time dependent domains are registered

404
00:14:14,880 --> 00:14:16,800
for example what you can observe there

405
00:14:16,800 --> 00:14:17,839
is

406
00:14:17,839 --> 00:14:19,920
if you are a sinkhole operator it

407
00:14:19,920 --> 00:14:21,199
doesn't matter to you when you are

408
00:14:21,199 --> 00:14:23,360
registering but even because even if you

409
00:14:23,360 --> 00:14:25,440
register before the domain becomes valid

410
00:14:25,440 --> 00:14:28,000
you get some interesting information

411
00:14:28,000 --> 00:14:29,360
because

412
00:14:29,360 --> 00:14:31,760
if someone has had his

413
00:14:31,760 --> 00:14:34,160
pc clock wrongly and might be checking

414
00:14:34,160 --> 00:14:36,399
in earlier this information is also of

415
00:14:36,399 --> 00:14:37,760
interest to you

416
00:14:37,760 --> 00:14:39,279
while on the other hand

417
00:14:39,279 --> 00:14:42,240
a botnester basically has to ensure that

418
00:14:42,240 --> 00:14:44,079
his domain is up when the validity

419
00:14:44,079 --> 00:14:45,040
window

420
00:14:45,040 --> 00:14:47,760
is reached meaning he cannot register

421
00:14:47,760 --> 00:14:50,160
very long into the future because the

422
00:14:50,160 --> 00:14:51,680
domain might be spotted by law

423
00:14:51,680 --> 00:14:53,600
enforcement or anyone who can mitigate

424
00:14:53,600 --> 00:14:55,440
it and basically take away his domain

425
00:14:55,440 --> 00:14:57,199
before it becomes valid

426
00:14:57,199 --> 00:14:59,440
and secondly we also looked at how

427
00:14:59,440 --> 00:15:02,320
effective these mitigations have been

428
00:15:02,320 --> 00:15:03,760
okay as i mentioned

429
00:15:03,760 --> 00:15:05,360
when you write a paper you certainly

430
00:15:05,360 --> 00:15:07,680
have to fix the date and we chose

431
00:15:07,680 --> 00:15:10,160
deliberately the 22nd of september last

432
00:15:10,160 --> 00:15:11,120
year

433
00:15:11,120 --> 00:15:13,279
and included in our data set all the

434
00:15:13,279 --> 00:15:15,519
domains until the end of the year in

435
00:15:15,519 --> 00:15:17,680
order to ensure that we also see some of

436
00:15:17,680 --> 00:15:19,600
this this advanced registrations in

437
00:15:19,600 --> 00:15:20,560
there

438
00:15:20,560 --> 00:15:23,120
and then received this historic course

439
00:15:23,120 --> 00:15:24,480
data

440
00:15:24,480 --> 00:15:26,720
and then first had a look what you can

441
00:15:26,720 --> 00:15:29,120
derive from who's data so

442
00:15:29,120 --> 00:15:32,320
based on that we found some ways to at

443
00:15:32,320 --> 00:15:34,480
least recognize sinkholes

444
00:15:34,480 --> 00:15:35,360
um

445
00:15:35,360 --> 00:15:37,440
since the whose data we have there is

446
00:15:37,440 --> 00:15:40,800
historic it means we can look at when

447
00:15:40,800 --> 00:15:42,639
you have a registration and the

448
00:15:42,639 --> 00:15:44,240
registration is basically changed to a

449
00:15:44,240 --> 00:15:46,079
sinkhole or something that we recognize

450
00:15:46,079 --> 00:15:47,279
as a sinkhole

451
00:15:47,279 --> 00:15:49,440
before the standard

452
00:15:49,440 --> 00:15:51,360
uh registration time ends so basically

453
00:15:51,360 --> 00:15:53,120
forcefully the control was sent over to

454
00:15:53,120 --> 00:15:55,519
a sinkhole as well as pre-registrations

455
00:15:55,519 --> 00:15:56,639
which means

456
00:15:56,639 --> 00:15:58,240
are there any domains

457
00:15:58,240 --> 00:15:59,759
that are registered before the family

458
00:15:59,759 --> 00:16:01,279
even appeared

459
00:16:01,279 --> 00:16:03,519
for some reason

460
00:16:03,519 --> 00:16:05,279
think of those wordless domains it's

461
00:16:05,279 --> 00:16:07,040
very likely that they will produce some

462
00:16:07,040 --> 00:16:09,040
domains that are just attractive to

463
00:16:09,040 --> 00:16:11,199
someone and he has registered them

464
00:16:11,199 --> 00:16:13,040
before the malware even appeared

465
00:16:13,040 --> 00:16:14,959
and another story that you can find in

466
00:16:14,959 --> 00:16:16,720
the paper is we also looked at domain

467
00:16:16,720 --> 00:16:18,079
parking

468
00:16:18,079 --> 00:16:20,639
and we found at least one case where it

469
00:16:20,639 --> 00:16:23,040
seemed to us that there was some domain

470
00:16:23,040 --> 00:16:25,360
parking operator trying out if they can

471
00:16:25,360 --> 00:16:28,480
use um dji domains to drive traffic to

472
00:16:28,480 --> 00:16:30,880
towards advertisement because for a

473
00:16:30,880 --> 00:16:32,079
short period of time they were

474
00:16:32,079 --> 00:16:34,839
registering domains of several different

475
00:16:34,839 --> 00:16:36,959
dgas and

476
00:16:36,959 --> 00:16:38,880
yeah basically i think they just tried

477
00:16:38,880 --> 00:16:41,519
to pick up traffic there

478
00:16:41,519 --> 00:16:43,759
okay so trying to visualize that kind of

479
00:16:43,759 --> 00:16:45,120
information

480
00:16:45,120 --> 00:16:46,480
i came up with that

481
00:16:46,480 --> 00:16:47,279
um

482
00:16:47,279 --> 00:16:48,560
so that's all the different families

483
00:16:48,560 --> 00:16:50,240
that we have been looking at i had to

484
00:16:50,240 --> 00:16:52,959
leave out three because 43 is not a good

485
00:16:52,959 --> 00:16:56,079
number to show in the grid

486
00:16:56,079 --> 00:16:57,839
but there's not lots information lost

487
00:16:57,839 --> 00:16:58,880
and you can see the full data in the

488
00:16:58,880 --> 00:17:00,880
paper anyway

489
00:17:00,880 --> 00:17:02,240
let's first look at the number of

490
00:17:02,240 --> 00:17:04,640
generated domains per

491
00:17:04,640 --> 00:17:06,240
dga family

492
00:17:06,240 --> 00:17:09,119
the biggest ones obviously are configure

493
00:17:09,119 --> 00:17:10,799
because if you heard back then what

494
00:17:10,799 --> 00:17:12,880
happened there there was a lot of fuss

495
00:17:12,880 --> 00:17:13,919
about it

496
00:17:13,919 --> 00:17:16,799
as well as weird configure generates in

497
00:17:16,799 --> 00:17:20,480
one version 50 000 domains per day

498
00:17:20,480 --> 00:17:23,839
and that's happening since 2009

499
00:17:23,839 --> 00:17:25,039
so that that

500
00:17:25,039 --> 00:17:27,520
just simply adds up massively and vero

501
00:17:27,520 --> 00:17:30,480
is a similar case with 10 000 domains

502
00:17:30,480 --> 00:17:31,760
per day since

503
00:17:31,760 --> 00:17:34,559
2011.

504
00:17:34,559 --> 00:17:35,679
there's a couple more that are

505
00:17:35,679 --> 00:17:37,840
generating at least multiple million

506
00:17:37,840 --> 00:17:40,559
domains each of those also generating

507
00:17:40,559 --> 00:17:44,400
more than 1 000 domains per day and

508
00:17:44,400 --> 00:17:46,000
after that it's it's getting lower and

509
00:17:46,000 --> 00:17:47,919
lower so it's basically the the whole

510
00:17:47,919 --> 00:17:50,240
population of domains you have there but

511
00:17:50,240 --> 00:17:52,400
yet you can see many of those numbers

512
00:17:52,400 --> 00:17:54,320
are very high and if you would try to

513
00:17:54,320 --> 00:17:56,240
eradicate such a botnet by just blocking

514
00:17:56,240 --> 00:17:58,880
all of the domains

515
00:17:58,880 --> 00:18:00,559
it's quite a lot and with just buying

516
00:18:00,559 --> 00:18:02,640
domains it might be

517
00:18:02,640 --> 00:18:06,080
either expensive or a lot of effort

518
00:18:06,080 --> 00:18:08,240
um registration numbers

519
00:18:08,240 --> 00:18:10,400
which were pretty interesting

520
00:18:10,400 --> 00:18:12,559
um we had to exclude like like i

521
00:18:12,559 --> 00:18:14,480
mentioned earlier those families a few

522
00:18:14,480 --> 00:18:16,799
of them are basically using dynamic dns

523
00:18:16,799 --> 00:18:18,799
and we were not able to obtain

524
00:18:18,799 --> 00:18:21,120
the data for those third level domains

525
00:18:21,120 --> 00:18:23,200
and um for configure and viral basically

526
00:18:23,200 --> 00:18:25,760
the main tools told me um no it's that's

527
00:18:25,760 --> 00:18:27,600
just too much um because

528
00:18:27,600 --> 00:18:29,520
both of them together are 140 million

529
00:18:29,520 --> 00:18:31,600
domains if you look up the very signed

530
00:18:31,600 --> 00:18:33,600
reports you can see there's

531
00:18:33,600 --> 00:18:36,240
only 300 million domains registered at

532
00:18:36,240 --> 00:18:39,840
all so basically um those two are half

533
00:18:39,840 --> 00:18:41,760
of those the potential domains of both

534
00:18:41,760 --> 00:18:43,840
of them are half of the

535
00:18:43,840 --> 00:18:46,720
actually existing domains

536
00:18:46,720 --> 00:18:47,919
the

537
00:18:47,919 --> 00:18:49,919
dji with the most registrations i found

538
00:18:49,919 --> 00:18:52,160
is game over p2pm

539
00:18:52,160 --> 00:18:55,919
so out of the 260 000 domains it has 74

540
00:18:55,919 --> 00:18:57,919
000 domains actually registered which is

541
00:18:57,919 --> 00:19:00,320
close to 30 percent

542
00:19:00,320 --> 00:19:02,320
some others with relatively

543
00:19:02,320 --> 00:19:05,200
or high relative registration numbers

544
00:19:05,200 --> 00:19:08,000
are those listed here um the most

545
00:19:08,000 --> 00:19:09,760
interesting case of those is probably

546
00:19:09,760 --> 00:19:11,760
super box which i'll be addressing

547
00:19:11,760 --> 00:19:13,280
shortly

548
00:19:13,280 --> 00:19:14,400
and

549
00:19:14,400 --> 00:19:16,000
from there on you can see it's it's

550
00:19:16,000 --> 00:19:17,520
basically

551
00:19:17,520 --> 00:19:20,960
more and more going down so

552
00:19:20,960 --> 00:19:24,720
all together we found only 115 000

553
00:19:24,720 --> 00:19:27,280
of out of those 80 million domains being

554
00:19:27,280 --> 00:19:28,960
registered or

555
00:19:28,960 --> 00:19:33,039
in total 0.6 percent

556
00:19:34,400 --> 00:19:37,039
if we look at those registered domains

557
00:19:37,039 --> 00:19:38,720
that are connected to takedowns you can

558
00:19:38,720 --> 00:19:40,320
see that um

559
00:19:40,320 --> 00:19:43,200
even those again make up 70 percent out

560
00:19:43,200 --> 00:19:44,640
of all the domains we found there so for

561
00:19:44,640 --> 00:19:47,120
example the vast majority of those game

562
00:19:47,120 --> 00:19:48,559
over peer-to-peer domains are connected

563
00:19:48,559 --> 00:19:50,320
to to um

564
00:19:50,320 --> 00:19:53,039
the takedown of the botnet in 2014 as

565
00:19:53,039 --> 00:19:55,440
well as it's the case for for bomital

566
00:19:55,440 --> 00:19:58,000
and cryptoloca as well

567
00:19:58,000 --> 00:20:00,720
looking at the remainder of roughly 30

568
00:20:00,720 --> 00:20:02,640
000 domains that are not connected to

569
00:20:02,640 --> 00:20:04,880
takedowns we found

570
00:20:04,880 --> 00:20:06,559
9.6

571
00:20:06,559 --> 00:20:09,280
000 pre-registered domains so like i

572
00:20:09,280 --> 00:20:11,280
mentioned those that were registered

573
00:20:11,280 --> 00:20:14,240
before the botnet became active

574
00:20:14,240 --> 00:20:16,000
which is quite a lot of collisions if

575
00:20:16,000 --> 00:20:17,360
you think about it

576
00:20:17,360 --> 00:20:18,840
and

577
00:20:18,840 --> 00:20:23,200
mitigations are only 1.2 000 um which is

578
00:20:23,200 --> 00:20:25,280
also way less than i expected before

579
00:20:25,280 --> 00:20:26,880
doing that kind of research

580
00:20:26,880 --> 00:20:29,039
and 5 000 of those domains were directly

581
00:20:29,039 --> 00:20:30,960
registered as sinkholes so um the the

582
00:20:30,960 --> 00:20:32,400
very first registration you find for the

583
00:20:32,400 --> 00:20:34,640
domain is directly a sinkhole and that

584
00:20:34,640 --> 00:20:36,799
leaves us with around about 16 000

585
00:20:36,799 --> 00:20:38,559
domains that are

586
00:20:38,559 --> 00:20:40,559
either protected by

587
00:20:40,559 --> 00:20:42,880
who is privacy services

588
00:20:42,880 --> 00:20:44,080
or

589
00:20:44,080 --> 00:20:46,559
otherwise malicious likely malicious i

590
00:20:46,559 --> 00:20:49,679
wasn't able to ultimately find that out

591
00:20:49,679 --> 00:20:53,280
but it's a good assumption i think

592
00:20:53,280 --> 00:20:54,240
okay

593
00:20:54,240 --> 00:20:57,360
let's look at collisions

594
00:20:58,159 --> 00:20:59,679
let's first have a look at collisions

595
00:20:59,679 --> 00:21:01,600
with configure and vroad because they

596
00:21:01,600 --> 00:21:03,280
have so many domains and it might be

597
00:21:03,280 --> 00:21:04,720
like more likely that they basically

598
00:21:04,720 --> 00:21:06,320
produce collisions

599
00:21:06,320 --> 00:21:09,679
and in fact configure at least has

600
00:21:09,679 --> 00:21:10,880
15

601
00:21:10,880 --> 00:21:11,919
collisions

602
00:21:11,919 --> 00:21:14,960
not against reroute while firewood has

603
00:21:14,960 --> 00:21:17,200
altogether more than three thousand

604
00:21:17,200 --> 00:21:20,080
three thousand collisions there

605
00:21:20,080 --> 00:21:22,240
but since those are the only

606
00:21:22,240 --> 00:21:24,720
djs that have collisions at all and

607
00:21:24,720 --> 00:21:26,159
there's only three thousand and one

608
00:21:26,159 --> 00:21:28,640
hundred sixty million

609
00:21:28,640 --> 00:21:31,840
domains um that's a pretty good result

610
00:21:31,840 --> 00:21:33,360
when you think of

611
00:21:33,360 --> 00:21:35,679
the uniqueness that a collision implies

612
00:21:35,679 --> 00:21:38,480
so meaning if you have a domain and it's

613
00:21:38,480 --> 00:21:40,400
basically contained in the database it's

614
00:21:40,400 --> 00:21:42,559
very likely there's also the family that

615
00:21:42,559 --> 00:21:44,880
you basically would assume it is in the

616
00:21:44,880 --> 00:21:46,880
end database answers you

617
00:21:46,880 --> 00:21:49,520
and if we exclude now config convert

618
00:21:49,520 --> 00:21:51,600
there remains only one collision in

619
00:21:51,600 --> 00:21:53,840
there so this basically strengthens even

620
00:21:53,840 --> 00:21:55,200
this assumption

621
00:21:55,200 --> 00:21:59,440
and this is this exact domain

622
00:21:59,440 --> 00:22:02,240
which also simplifies my reaction to

623
00:22:02,240 --> 00:22:03,120
that

624
00:22:03,120 --> 00:22:05,679
okay so if there are so few

625
00:22:05,679 --> 00:22:07,600
collisions in there um that means that

626
00:22:07,600 --> 00:22:09,360
if we pre-calculate this whole set of

627
00:22:09,360 --> 00:22:11,360
atg's um it can be used

628
00:22:11,360 --> 00:22:14,480
very well to take malware with regard to

629
00:22:14,480 --> 00:22:17,600
the family in campaigns and this is what

630
00:22:17,600 --> 00:22:19,600
after we got into cooperation with uh

631
00:22:19,600 --> 00:22:21,440
shadow servers now happening in the back

632
00:22:21,440 --> 00:22:23,120
end as well so they are using our

633
00:22:23,120 --> 00:22:26,159
database to basically pre-tag malware as

634
00:22:26,159 --> 00:22:28,880
also some of the avs started doing

635
00:22:28,880 --> 00:22:31,280
and effectively that also means that you

636
00:22:31,280 --> 00:22:33,200
will not have any false positives with

637
00:22:33,200 --> 00:22:34,400
domain links

638
00:22:34,400 --> 00:22:36,960
seven and longer

639
00:22:36,960 --> 00:22:40,080
with regards to pre-registrations

640
00:22:40,080 --> 00:22:42,159
is the more interesting fact if you look

641
00:22:42,159 --> 00:22:43,039
at

642
00:22:43,039 --> 00:22:45,039
if you want to use those domains as

643
00:22:45,039 --> 00:22:46,880
block lists

644
00:22:46,880 --> 00:22:49,600
those three are the word list

645
00:22:49,600 --> 00:22:53,840
dgas and as expected those will have the

646
00:22:53,840 --> 00:22:56,240
or will at least have high numbers of

647
00:22:56,240 --> 00:22:58,559
such collisions against already existing

648
00:22:58,559 --> 00:23:00,000
benign domains

649
00:23:00,000 --> 00:23:03,039
and zippo box is the hardest case here

650
00:23:03,039 --> 00:23:04,720
because it's basically generating its

651
00:23:04,720 --> 00:23:07,120
domains by taking just two words and

652
00:23:07,120 --> 00:23:08,720
adding.net

653
00:23:08,720 --> 00:23:11,840
and one of those lists consists only of

654
00:23:11,840 --> 00:23:13,039
prenames

655
00:23:13,039 --> 00:23:15,280
so many people that basically

656
00:23:15,280 --> 00:23:17,120
try to register names for

657
00:23:17,120 --> 00:23:18,240
themselves

658
00:23:18,240 --> 00:23:22,159
are colliding with superbox there

659
00:23:22,559 --> 00:23:24,000
on the other hand is doing a little

660
00:23:24,000 --> 00:23:26,320
trick um to reduce this number of

661
00:23:26,320 --> 00:23:29,360
collisions um with a probability of 30

662
00:23:29,360 --> 00:23:31,679
percent it will cut off one of the

663
00:23:31,679 --> 00:23:34,000
random words it has chosen in half

664
00:23:34,000 --> 00:23:36,080
so this basically ensures that um if

665
00:23:36,080 --> 00:23:38,559
someone would try to register

666
00:23:38,559 --> 00:23:40,720
several words in a row um

667
00:23:40,720 --> 00:23:42,880
it's it's way more unlikely because you

668
00:23:42,880 --> 00:23:46,240
will have a broken word in there

669
00:23:46,960 --> 00:23:48,880
yeah those families basically have

670
00:23:48,880 --> 00:23:50,559
domains that are five to six letters

671
00:23:50,559 --> 00:23:51,919
long

672
00:23:51,919 --> 00:23:54,000
so this also implies why they might have

673
00:23:54,000 --> 00:23:55,440
more collisions

674
00:23:55,440 --> 00:23:56,320
and

675
00:23:56,320 --> 00:23:58,720
ever thereafter the number of collisions

676
00:23:58,720 --> 00:24:00,880
with pre-registrations is going down and

677
00:24:00,880 --> 00:24:04,080
down and the majority of djs actually

678
00:24:04,080 --> 00:24:06,880
has no pre-registrations at all meaning

679
00:24:06,880 --> 00:24:08,400
those will not be or likely not be

680
00:24:08,400 --> 00:24:10,960
affected when just using their domain

681
00:24:10,960 --> 00:24:13,039
lists for blocking

682
00:24:13,039 --> 00:24:16,320
looking a bit deeper in that information

683
00:24:16,320 --> 00:24:18,000
like i mentioned the wordless djs make

684
00:24:18,000 --> 00:24:21,200
up 90 of those collisions and in the

685
00:24:21,200 --> 00:24:22,640
remainder

686
00:24:22,640 --> 00:24:25,279
those domains with length 5 to 6 make up

687
00:24:25,279 --> 00:24:27,679
another 90 and

688
00:24:27,679 --> 00:24:29,360
occasionally we'll have some domains

689
00:24:29,360 --> 00:24:31,520
that look like legitimate domains again

690
00:24:31,520 --> 00:24:33,039
so um

691
00:24:33,039 --> 00:24:34,240
those

692
00:24:34,240 --> 00:24:36,240
just by pure incidents

693
00:24:36,240 --> 00:24:38,240
or are so pronounceable that they could

694
00:24:38,240 --> 00:24:41,120
be meaningful words as well

695
00:24:41,120 --> 00:24:43,360
but anyway this basically enables us to

696
00:24:43,360 --> 00:24:44,559
to use um

697
00:24:44,559 --> 00:24:46,720
those pre-generated domain names for

698
00:24:46,720 --> 00:24:49,120
blocking

699
00:24:50,400 --> 00:24:52,880
let's quickly go over this as well

700
00:24:52,880 --> 00:24:54,559
like i mentioned if you have

701
00:24:54,559 --> 00:24:56,720
time-dependent dgas it basically means

702
00:24:56,720 --> 00:24:58,799
that you can look how long domains are

703
00:24:58,799 --> 00:25:01,520
registered before they become valid

704
00:25:01,520 --> 00:25:03,120
so meaning they also have a window of

705
00:25:03,120 --> 00:25:04,799
validity so for example if you have a

706
00:25:04,799 --> 00:25:06,480
dja that has domains that are valid for

707
00:25:06,480 --> 00:25:08,640
runday i need to ensure i have control

708
00:25:08,640 --> 00:25:10,880
of the domain before this domain becomes

709
00:25:10,880 --> 00:25:13,679
valid and after this validity has ended

710
00:25:13,679 --> 00:25:17,039
it has no longer valid value to me so we

711
00:25:17,039 --> 00:25:18,720
defined this registration log ahead

712
00:25:18,720 --> 00:25:20,000
basically meaning

713
00:25:20,000 --> 00:25:22,320
the relative offset between startup

714
00:25:22,320 --> 00:25:23,360
validity

715
00:25:23,360 --> 00:25:26,320
and when the domain is registered

716
00:25:26,320 --> 00:25:29,120
and we plotted this for both sinkholes

717
00:25:29,120 --> 00:25:31,520
and non-sinkholes and ended up with this

718
00:25:31,520 --> 00:25:33,520
box plot

719
00:25:33,520 --> 00:25:34,480
so

720
00:25:34,480 --> 00:25:37,039
basically in the middle here is

721
00:25:37,039 --> 00:25:39,279
whenever you would register a domain on

722
00:25:39,279 --> 00:25:42,080
the day it becomes valid

723
00:25:42,080 --> 00:25:44,000
on the left hand you register it before

724
00:25:44,000 --> 00:25:46,000
it becomes valid on the right side you

725
00:25:46,000 --> 00:25:48,559
register it after it becomes valid

726
00:25:48,559 --> 00:25:50,400
which makes sense in some cases because

727
00:25:50,400 --> 00:25:51,440
if you

728
00:25:51,440 --> 00:25:52,799
see those

729
00:25:52,799 --> 00:25:54,880
red bars behind the

730
00:25:54,880 --> 00:25:56,640
light and dark gray bars

731
00:25:56,640 --> 00:25:58,240
that's basically the window in which

732
00:25:58,240 --> 00:26:00,159
domains are welded

733
00:26:00,159 --> 00:26:02,320
the most obvious opposite observations

734
00:26:02,320 --> 00:26:04,720
you could make here is

735
00:26:04,720 --> 00:26:06,400
sinkholes are often registered earlier

736
00:26:06,400 --> 00:26:08,000
than non-sinkholes

737
00:26:08,000 --> 00:26:09,919
because they want to get all the data

738
00:26:09,919 --> 00:26:11,919
they possibly can get

739
00:26:11,919 --> 00:26:14,000
um we found one very interesting case

740
00:26:14,000 --> 00:26:17,039
here um because this this box was far to

741
00:26:17,039 --> 00:26:19,200
the left so as you can see um

742
00:26:19,200 --> 00:26:21,919
it's almost

743
00:26:23,279 --> 00:26:24,799
eight nine hundred days before the

744
00:26:24,799 --> 00:26:27,120
domains become valid um

745
00:26:27,120 --> 00:26:29,679
we assume that some bot masters for

746
00:26:29,679 --> 00:26:32,480
several probably non-related botnets um

747
00:26:32,480 --> 00:26:35,679
try to register domains several years up

748
00:26:35,679 --> 00:26:38,640
front so basically they probably wanted

749
00:26:38,640 --> 00:26:40,799
to register themselves backup domain so

750
00:26:40,799 --> 00:26:42,400
whenever they were affected by a

751
00:26:42,400 --> 00:26:44,080
takedown they would at least have this

752
00:26:44,080 --> 00:26:48,000
one domain sitting way behind

753
00:26:48,000 --> 00:26:49,360
because they also were basically

754
00:26:49,360 --> 00:26:51,520
registered for the same day

755
00:26:51,520 --> 00:26:56,159
just with with a gap of 365 days

756
00:26:56,159 --> 00:26:58,240
and another curious case was this one up

757
00:26:58,240 --> 00:26:59,760
up there

758
00:26:59,760 --> 00:27:02,640
32 domains where they resisted exactly

759
00:27:02,640 --> 00:27:04,320
one month before

760
00:27:04,320 --> 00:27:07,039
they lost validity and the only

761
00:27:07,039 --> 00:27:08,559
assumption that we could make about that

762
00:27:08,559 --> 00:27:10,480
is basically some

763
00:27:10,480 --> 00:27:13,360
sinkholer failed in reversing and had an

764
00:27:13,360 --> 00:27:16,479
offset of one month in there

765
00:27:17,279 --> 00:27:21,120
okay so with that let me conclude

766
00:27:21,120 --> 00:27:24,000
um yeah so djs are pretty prevalent

767
00:27:24,000 --> 00:27:27,039
malware issue um if you read a lot on

768
00:27:27,039 --> 00:27:28,880
blog posts of analysis sensor on you

769
00:27:28,880 --> 00:27:31,840
will see that many of the um different

770
00:27:31,840 --> 00:27:33,679
and newer malware families will probably

771
00:27:33,679 --> 00:27:35,840
have a dga in there which is supported

772
00:27:35,840 --> 00:27:38,159
by our data

773
00:27:38,159 --> 00:27:39,600
a good sign is

774
00:27:39,600 --> 00:27:41,279
those local issues that i've mentioned

775
00:27:41,279 --> 00:27:43,200
because it allows you to

776
00:27:43,200 --> 00:27:45,440
use pre-generated

777
00:27:45,440 --> 00:27:48,240
domain lists for blocking as well as

778
00:27:48,240 --> 00:27:51,279
using it to identify the member families

779
00:27:51,279 --> 00:27:54,000
with regards to takedowns

780
00:27:54,000 --> 00:27:55,919
with botnet operators only registering

781
00:27:55,919 --> 00:27:57,679
shortly before the domains become valid

782
00:27:57,679 --> 00:27:59,919
um it's pretty easy to catch them off

783
00:27:59,919 --> 00:28:01,600
guard if you just register all of the

784
00:28:01,600 --> 00:28:03,440
domains and it also means that you do

785
00:28:03,440 --> 00:28:05,679
not have to care about

786
00:28:05,679 --> 00:28:08,080
many domains that are registered fine to

787
00:28:08,080 --> 00:28:10,000
the front it's probably not many that

788
00:28:10,000 --> 00:28:12,799
you have to cease in that case

789
00:28:12,799 --> 00:28:16,080
but we would rather prefer or proposes

790
00:28:16,080 --> 00:28:18,399
that you just go and rigorously block

791
00:28:18,399 --> 00:28:20,640
the atds because it will likely not have

792
00:28:20,640 --> 00:28:21,919
any

793
00:28:21,919 --> 00:28:23,440
impact on the benign users because you

794
00:28:23,440 --> 00:28:24,960
have solo

795
00:28:24,960 --> 00:28:26,720
collisions with

796
00:28:26,720 --> 00:28:30,000
the desirable domains that you

797
00:28:30,000 --> 00:28:31,600
can basically on a registry level

798
00:28:31,600 --> 00:28:33,039
probably just block them all out at

799
00:28:33,039 --> 00:28:35,840
least until the validity has ended and

800
00:28:35,840 --> 00:28:37,200
for that we are currently in contact

801
00:28:37,200 --> 00:28:38,480
with um

802
00:28:38,480 --> 00:28:40,559
i can verify a number number in order to

803
00:28:40,559 --> 00:28:42,799
check if we can basically put this into

804
00:28:42,799 --> 00:28:45,840
place on a larger scale

805
00:28:45,840 --> 00:28:48,240
as i mentioned

806
00:28:48,240 --> 00:28:50,480
we are providing this as a free service

807
00:28:50,480 --> 00:28:52,559
so if you want to play around with the

808
00:28:52,559 --> 00:28:56,000
service or play around with the data

809
00:28:56,000 --> 00:28:57,919
just write me an email or see me

810
00:28:57,919 --> 00:28:59,440
afterwards because i have some temporary

811
00:28:59,440 --> 00:29:01,120
access codes with me that i can hand out

812
00:29:01,120 --> 00:29:02,240
to you

813
00:29:02,240 --> 00:29:03,679
um and

814
00:29:03,679 --> 00:29:05,200
what i always do because i want to keep

815
00:29:05,200 --> 00:29:07,279
the bad guys hours is i need some basic

816
00:29:07,279 --> 00:29:08,880
proof of identity having met you in

817
00:29:08,880 --> 00:29:11,679
person is basically one way to do that

818
00:29:11,679 --> 00:29:13,679
or some vetting by already existing

819
00:29:13,679 --> 00:29:16,240
users and with that let me thank you for

820
00:29:16,240 --> 00:29:17,670
your attention

821
00:29:17,670 --> 00:29:25,979
[Applause]

822
00:29:26,080 --> 00:29:29,200
so in your uh when you classify the

823
00:29:29,200 --> 00:29:31,840
domains to the malware families do you

824
00:29:31,840 --> 00:29:34,159
have any gram choose you use for example

825
00:29:34,159 --> 00:29:36,080
you reverse engineer the

826
00:29:36,080 --> 00:29:38,240
binary of malware so they know that

827
00:29:38,240 --> 00:29:40,159
domain generating algorithms so you can

828
00:29:40,159 --> 00:29:43,120
collect exactly

829
00:29:43,120 --> 00:29:45,679
so what kind of ground shoes and how

830
00:29:45,679 --> 00:29:46,880
um

831
00:29:46,880 --> 00:29:50,159
in the past two years i looked at

832
00:29:50,159 --> 00:29:52,480
thousands of malware samples so um what

833
00:29:52,480 --> 00:29:54,320
i normally do is on the melva dumps that

834
00:29:54,320 --> 00:29:56,559
i have there i would run yara signatures

835
00:29:56,559 --> 00:29:58,960
for the specific families as well

836
00:29:58,960 --> 00:30:00,960
because i think they are working better

837
00:30:00,960 --> 00:30:02,720
than for example av labels and that kind

838
00:30:02,720 --> 00:30:03,919
of stuff

839
00:30:03,919 --> 00:30:05,440
so that's in that case the ground

840
00:30:05,440 --> 00:30:07,520
through that i'm using so manual

841
00:30:07,520 --> 00:30:09,840
verification

842
00:30:09,840 --> 00:30:12,559
how do you do manual verification

843
00:30:12,559 --> 00:30:14,640
um what do you mean by um basically

844
00:30:14,640 --> 00:30:16,480
given a domain say how do you know this

845
00:30:16,480 --> 00:30:19,679
belong to this particular male family or

846
00:30:19,679 --> 00:30:21,760
um

847
00:30:21,760 --> 00:30:24,000
if i reverse ddga i can run them in a

848
00:30:24,000 --> 00:30:25,840
sandbox as well so i can

849
00:30:25,840 --> 00:30:27,760
basically correlate against the sandbox

850
00:30:27,760 --> 00:30:30,799
list against the re-implementation list

851
00:30:30,799 --> 00:30:32,159
and if i

852
00:30:32,159 --> 00:30:34,640
do this in an exhaustive way for example

853
00:30:34,640 --> 00:30:36,480
the thousand domains for

854
00:30:36,480 --> 00:30:38,880
one day and i get the very same thousand

855
00:30:38,880 --> 00:30:40,399
domains before my reimplementation i'm

856
00:30:40,399 --> 00:30:42,000
pretty sure that it works i had some

857
00:30:42,000 --> 00:30:44,000
bugs in there if you're pointing to that

858
00:30:44,000 --> 00:30:45,039
um

859
00:30:45,039 --> 00:30:47,440
but since i also get a lot of feedback

860
00:30:47,440 --> 00:30:49,360
from basically the community that we've

861
00:30:49,360 --> 00:30:51,440
built here i'm pretty sure that we were

862
00:30:51,440 --> 00:30:54,880
able to eradicate most of the bugs

863
00:30:56,080 --> 00:30:57,600
william the culture applied physics

864
00:30:57,600 --> 00:30:59,039
laboratory i think this is really

865
00:30:59,039 --> 00:31:00,399
interesting work

866
00:31:00,399 --> 00:31:02,159
in its own right i'm also a little bit

867
00:31:02,159 --> 00:31:04,559
drawn to the re aspect of it because it

868
00:31:04,559 --> 00:31:06,320
seems like you've hit on a way that you

869
00:31:06,320 --> 00:31:08,080
could actually measure reverse

870
00:31:08,080 --> 00:31:10,880
engineering work factor

871
00:31:10,880 --> 00:31:11,600
just

872
00:31:11,600 --> 00:31:13,440
by by the size of your data set and the

873
00:31:13,440 --> 00:31:15,360
simplicity of the algorithm what are

874
00:31:15,360 --> 00:31:18,519
your thoughts

875
00:31:22,240 --> 00:31:24,720
i think metric basically yeah the thing

876
00:31:24,720 --> 00:31:26,240
is it's very specific to who is

877
00:31:26,240 --> 00:31:28,240
reversing

878
00:31:28,240 --> 00:31:29,200
so um

879
00:31:29,200 --> 00:31:31,600
i can only measure my own skill in that

880
00:31:31,600 --> 00:31:32,399
sense

881
00:31:32,399 --> 00:31:34,159
or basically get what other people tell

882
00:31:34,159 --> 00:31:36,159
me that basically contribute those

883
00:31:36,159 --> 00:31:37,919
implementations

884
00:31:37,919 --> 00:31:39,200
for now

885
00:31:39,200 --> 00:31:40,480
i would

886
00:31:40,480 --> 00:31:42,240
say it's um

887
00:31:42,240 --> 00:31:44,799
i've only observed one implementation of

888
00:31:44,799 --> 00:31:47,679
a dga that um basically where i said i

889
00:31:47,679 --> 00:31:48,960
have to

890
00:31:48,960 --> 00:31:51,919
um instrument dj instead of

891
00:31:51,919 --> 00:31:53,679
re-implementing it so basically where

892
00:31:53,679 --> 00:31:54,880
the effort

893
00:31:54,880 --> 00:31:56,320
basically would have been higher to

894
00:31:56,320 --> 00:31:58,840
reverse it than basically going another

895
00:31:58,840 --> 00:32:02,080
route um that's one out of 60. most

896
00:32:02,080 --> 00:32:04,480
really are very simple so they use um as

897
00:32:04,480 --> 00:32:05,760
you can read in paper most of them

898
00:32:05,760 --> 00:32:08,399
basically just use um lcg as a

899
00:32:08,399 --> 00:32:09,919
pseudo-random number generator and that

900
00:32:09,919 --> 00:32:11,679
kind of thing to spit out basically

901
00:32:11,679 --> 00:32:13,360
numbers that they would fit into the the

902
00:32:13,360 --> 00:32:15,840
alphabet range

903
00:32:15,919 --> 00:32:18,240
thank you

904
00:32:19,840 --> 00:32:22,000
hi i'm roberta pradish from university

905
00:32:22,000 --> 00:32:23,200
of georgia

906
00:32:23,200 --> 00:32:25,840
great work so have a question curiosity

907
00:32:25,840 --> 00:32:28,799
really about push though so there used

908
00:32:28,799 --> 00:32:31,120
to be a variant of push though that uh

909
00:32:31,120 --> 00:32:33,840
not only use it it used to query the dga

910
00:32:33,840 --> 00:32:36,240
domains every day but also

911
00:32:36,240 --> 00:32:38,880
i think a set of 200 domains uh popular

912
00:32:38,880 --> 00:32:40,960
domains that uh that would be queried by

913
00:32:40,960 --> 00:32:42,720
the malware just to hide

914
00:32:42,720 --> 00:32:45,679
uh the dga domains in the crowd i was

915
00:32:45,679 --> 00:32:46,640
wondering

916
00:32:46,640 --> 00:32:48,159
if you think

917
00:32:48,159 --> 00:32:50,080
you know since you reversed it is it

918
00:32:50,080 --> 00:32:52,880
really effective as a tactic and did you

919
00:32:52,880 --> 00:32:57,440
see any other family using it

920
00:32:57,440 --> 00:32:59,679
i know that weird is doing something

921
00:32:59,679 --> 00:33:02,000
similar to that

922
00:33:02,000 --> 00:33:04,480
but i don't think it's that effective

923
00:33:04,480 --> 00:33:06,080
because

924
00:33:06,080 --> 00:33:08,320
once you start reverse engineering you

925
00:33:08,320 --> 00:33:10,000
pretty sure know how to filter out that

926
00:33:10,000 --> 00:33:11,279
kind of stuff

927
00:33:11,279 --> 00:33:13,519
otherwise as i pointed out with alexa

928
00:33:13,519 --> 00:33:15,200
you can filter out a lot of noise in

929
00:33:15,200 --> 00:33:16,399
that sense

930
00:33:16,399 --> 00:33:18,000
what's more annoying is another

931
00:33:18,000 --> 00:33:20,080
technique used by some modern botnets

932
00:33:20,080 --> 00:33:21,760
which is um you would basically set the

933
00:33:21,760 --> 00:33:25,120
host field to our popular domain but

934
00:33:25,120 --> 00:33:26,880
directly post to an ip address that you

935
00:33:26,880 --> 00:33:27,840
know

936
00:33:27,840 --> 00:33:30,000
so this basically screws up proxies way

937
00:33:30,000 --> 00:33:31,679
more because you no longer can filter

938
00:33:31,679 --> 00:33:34,080
out the domain directly

939
00:33:34,080 --> 00:33:36,960
um but the other thing i think

940
00:33:36,960 --> 00:33:38,399
except for adding noise it doesn't

941
00:33:38,399 --> 00:33:39,679
really have any

942
00:33:39,679 --> 00:33:41,360
heart effect

943
00:33:41,360 --> 00:33:43,679
okay thanks uh is there time for another

944
00:33:43,679 --> 00:33:44,559
question

945
00:33:44,559 --> 00:33:46,880
so i was wondering if you have seen any

946
00:33:46,880 --> 00:33:48,640
case of um

947
00:33:48,640 --> 00:33:51,200
sort of like a server-side dga

948
00:33:51,200 --> 00:33:53,279
whereby the malware will every day

949
00:33:53,279 --> 00:33:56,159
download from the cnc the domains the

950
00:33:56,159 --> 00:33:57,919
list of random domains to be used the

951
00:33:57,919 --> 00:34:00,320
next day or something like that um so

952
00:34:00,320 --> 00:34:02,399
that you cannot reverse the dga the dj

953
00:34:02,399 --> 00:34:04,480
is not with the malware it's on the

954
00:34:04,480 --> 00:34:07,200
server side um there is

955
00:34:07,200 --> 00:34:09,599
some server-side dji going on for

956
00:34:09,599 --> 00:34:11,679
example um for a period of time

957
00:34:11,679 --> 00:34:13,599
nine-member was doing it um but they

958
00:34:13,599 --> 00:34:15,918
would do basically hard code a domain

959
00:34:15,918 --> 00:34:19,040
into a binary and update daily

960
00:34:19,040 --> 00:34:20,879
so that's basically how they implemented

961
00:34:20,879 --> 00:34:23,040
their server side dga

962
00:34:23,040 --> 00:34:25,199
there are some rarely hard-coded lists

963
00:34:25,199 --> 00:34:27,760
look generated but as i mentioned are

964
00:34:27,760 --> 00:34:29,440
hard coded and distributed in the

965
00:34:29,440 --> 00:34:30,719
binaries

966
00:34:30,719 --> 00:34:32,960
and the other trend that you can observe

967
00:34:32,960 --> 00:34:35,199
is or what i would see in the near

968
00:34:35,199 --> 00:34:36,719
future is that they distribute the seeds

969
00:34:36,719 --> 00:34:39,359
dynamically so um the configuration file

970
00:34:39,359 --> 00:34:40,879
that you download from the cnc server

971
00:34:40,879 --> 00:34:43,040
contains an update to the seed which for

972
00:34:43,040 --> 00:34:45,040
example was already seen implemented in

973
00:34:45,040 --> 00:34:47,280
corebot

974
00:34:47,280 --> 00:34:49,839
thanks

975
00:34:49,839 --> 00:34:52,320
okay any more questions

976
00:34:52,320 --> 00:34:55,599
okay that concludes this session

