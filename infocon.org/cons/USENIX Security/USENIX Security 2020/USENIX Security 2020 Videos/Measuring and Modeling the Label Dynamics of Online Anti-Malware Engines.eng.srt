1
00:00:08,880 --> 00:00:12,320
hello everyone

2
00:00:10,080 --> 00:00:14,240
this is trophy drew from penn state

3
00:00:12,320 --> 00:00:16,960
welcome to my talk

4
00:00:14,240 --> 00:00:18,640
in this talk i will present our work

5
00:00:16,960 --> 00:00:19,600
measuring and modeling the labor

6
00:00:18,640 --> 00:00:22,400
dynamics

7
00:00:19,600 --> 00:00:24,560
of online antimodal engines this is a

8
00:00:22,400 --> 00:00:27,359
joint work with colleagues in my group

9
00:00:24,560 --> 00:00:29,919
and researchers from illinois

10
00:00:27,359 --> 00:00:30,720
security researchers need labeled mobile

11
00:00:29,920 --> 00:00:32,880
data

12
00:00:30,720 --> 00:00:35,200
virustotal is the largest online

13
00:00:32,880 --> 00:00:37,760
antimobile scanning service

14
00:00:35,200 --> 00:00:38,879
after user submits a suspicious file to

15
00:00:37,760 --> 00:00:41,440
virustotal

16
00:00:38,879 --> 00:00:43,120
virustotal applies more than 70 engines

17
00:00:41,440 --> 00:00:44,960
to analyze the file

18
00:00:43,120 --> 00:00:47,038
and returns the engine's detection

19
00:00:44,960 --> 00:00:48,879
results back to the user

20
00:00:47,039 --> 00:00:51,120
virus total is widely used by

21
00:00:48,879 --> 00:00:54,000
researchers in the security community

22
00:00:51,120 --> 00:00:55,680
to label their mobile data sets there

23
00:00:54,000 --> 00:00:57,199
are three major challenges of using

24
00:00:55,680 --> 00:00:59,600
virustotal

25
00:00:57,199 --> 00:01:00,399
first virus total keeps updating its

26
00:00:59,600 --> 00:01:02,239
engines

27
00:01:00,399 --> 00:01:04,080
and the files labels are likely to

28
00:01:02,239 --> 00:01:07,200
change over time

29
00:01:04,080 --> 00:01:09,920
when can you trust virustotal labels

30
00:01:07,200 --> 00:01:11,360
second different engines often disagree

31
00:01:09,920 --> 00:01:13,520
with each other

32
00:01:11,360 --> 00:01:14,479
how should we resolve the disparity

33
00:01:13,520 --> 00:01:17,840
between engines

34
00:01:14,479 --> 00:01:19,840
and design and aggregate label third

35
00:01:17,840 --> 00:01:21,280
should we treat all the varsity engines

36
00:01:19,840 --> 00:01:23,759
equally

37
00:01:21,280 --> 00:01:24,479
we first conducted a paper survey to

38
00:01:23,759 --> 00:01:26,640
understand

39
00:01:24,479 --> 00:01:28,320
how previous researchers handle the

40
00:01:26,640 --> 00:01:31,920
three challenges

41
00:01:28,320 --> 00:01:33,679
our survey is based on 115 top tier

42
00:01:31,920 --> 00:01:37,200
conference papers

43
00:01:33,680 --> 00:01:39,119
we have three findings first most papers

44
00:01:37,200 --> 00:01:41,520
do not consider the possible label

45
00:01:39,119 --> 00:01:44,159
changes on virustotal

46
00:01:41,520 --> 00:01:46,000
second a large portion of papers choose

47
00:01:44,159 --> 00:01:47,920
a threshold-based method

48
00:01:46,000 --> 00:01:50,000
to aggregate labels from different

49
00:01:47,920 --> 00:01:52,720
engines when researchers choose t

50
00:01:50,000 --> 00:01:53,680
as a threshold they will consider a file

51
00:01:52,720 --> 00:01:56,880
is malicious

52
00:01:53,680 --> 00:02:00,560
if t or modern t engines detect the file

53
00:01:56,880 --> 00:02:02,798
as a malicious third in most papers

54
00:02:00,560 --> 00:02:04,399
researchers believe different engines

55
00:02:02,799 --> 00:02:07,040
are equally trustworthy

56
00:02:04,399 --> 00:02:08,000
and only in a few papers the authors

57
00:02:07,040 --> 00:02:10,720
handpicked a small

58
00:02:08,000 --> 00:02:12,080
set of reputable engines we then

59
00:02:10,720 --> 00:02:14,480
conducted a measurement

60
00:02:12,080 --> 00:02:16,160
to validate the approaches taken by the

61
00:02:14,480 --> 00:02:18,879
previous researchers

62
00:02:16,160 --> 00:02:20,079
we collect varsity data for both pe and

63
00:02:18,879 --> 00:02:22,560
apk files

64
00:02:20,080 --> 00:02:24,640
for each file type we have a small data

65
00:02:22,560 --> 00:02:26,959
set with ground truth labels

66
00:02:24,640 --> 00:02:27,760
and the large data set without ground

67
00:02:26,959 --> 00:02:29,920
labels

68
00:02:27,760 --> 00:02:31,679
our measurement is launched from three

69
00:02:29,920 --> 00:02:32,640
aspects corresponding to the three

70
00:02:31,680 --> 00:02:34,879
challenges

71
00:02:32,640 --> 00:02:36,720
first we study the impact of label

72
00:02:34,879 --> 00:02:38,959
changes second

73
00:02:36,720 --> 00:02:40,480
we examine how threshold-based label

74
00:02:38,959 --> 00:02:42,640
aggregation works

75
00:02:40,480 --> 00:02:43,920
third we measure the correlation between

76
00:02:42,640 --> 00:02:46,079
variable engines

77
00:02:43,920 --> 00:02:47,040
and inspect whether they can be equally

78
00:02:46,080 --> 00:02:49,519
treated

79
00:02:47,040 --> 00:02:50,079
due to the time limit i will focus on

80
00:02:49,519 --> 00:02:53,519
the large

81
00:02:50,080 --> 00:02:55,599
pe data set we call it the main data set

82
00:02:53,519 --> 00:02:57,440
let's first see how we construct the

83
00:02:55,599 --> 00:02:59,839
main data set

84
00:02:57,440 --> 00:03:00,640
we use fresh files to build the main

85
00:02:59,840 --> 00:03:02,640
data set

86
00:03:00,640 --> 00:03:05,040
to avoid the influence of earlier

87
00:03:02,640 --> 00:03:07,679
viruses histories on the files

88
00:03:05,040 --> 00:03:08,239
we randomly sampled more than 14 000

89
00:03:07,680 --> 00:03:10,319
files

90
00:03:08,239 --> 00:03:12,599
that were submitted to resulto for the

91
00:03:10,319 --> 00:03:16,238
first time on august 31st

92
00:03:12,599 --> 00:03:16,799
2018. about half of them were labeled as

93
00:03:16,239 --> 00:03:20,319
benign

94
00:03:16,800 --> 00:03:22,159
by all engines on that day for the rest

95
00:03:20,319 --> 00:03:23,599
at least one engine believed they are

96
00:03:22,159 --> 00:03:25,359
malicious

97
00:03:23,599 --> 00:03:28,959
we collected their vast water daily

98
00:03:25,360 --> 00:03:31,920
detect results over one year

99
00:03:28,959 --> 00:03:32,879
we used the rescale api to force via

100
00:03:31,920 --> 00:03:36,159
social engines

101
00:03:32,879 --> 00:03:39,200
to analyze the files every day

102
00:03:36,159 --> 00:03:42,159
we then use the report api to query

103
00:03:39,200 --> 00:03:43,839
the latest scanning results every day we

104
00:03:42,159 --> 00:03:44,480
successfully collected various water

105
00:03:43,840 --> 00:03:47,599
labels

106
00:03:44,480 --> 00:03:50,079
on 303 days

107
00:03:47,599 --> 00:03:50,879
after removing some engines with too few

108
00:03:50,080 --> 00:03:53,360
results

109
00:03:50,879 --> 00:03:54,000
we have more than 300 million data

110
00:03:53,360 --> 00:03:57,360
points

111
00:03:54,000 --> 00:03:59,680
from 65 engines for our measurement

112
00:03:57,360 --> 00:04:00,640
next i will discuss the impact of labor

113
00:03:59,680 --> 00:04:03,200
changes

114
00:04:00,640 --> 00:04:03,920
we model the labor dynamics by sequences

115
00:04:03,200 --> 00:04:06,399
of zero and

116
00:04:03,920 --> 00:04:07,679
one zero means benign and one means

117
00:04:06,400 --> 00:04:10,480
malicious

118
00:04:07,680 --> 00:04:11,360
for instance these detection results can

119
00:04:10,480 --> 00:04:15,119
be represented

120
00:04:11,360 --> 00:04:15,519
like this we use flip to refer to a

121
00:04:15,120 --> 00:04:18,160
change

122
00:04:15,519 --> 00:04:19,120
between two consecutive labels namely

123
00:04:18,160 --> 00:04:22,000
zero to one

124
00:04:19,120 --> 00:04:22,560
or one to zero there are two possible

125
00:04:22,000 --> 00:04:25,520
patterns

126
00:04:22,560 --> 00:04:26,240
for flip a temporary change lasts in one

127
00:04:25,520 --> 00:04:29,359
day

128
00:04:26,240 --> 00:04:31,520
we call it a hazard flip a change lasts

129
00:04:29,360 --> 00:04:33,840
at least two days we call it a

130
00:04:31,520 --> 00:04:36,320
non-hazard flip

131
00:04:33,840 --> 00:04:36,960
this figure shows how flips change over

132
00:04:36,320 --> 00:04:39,440
time

133
00:04:36,960 --> 00:04:40,560
the blue line represents the number of

134
00:04:39,440 --> 00:04:43,520
hazard flips

135
00:04:40,560 --> 00:04:44,960
in each week and the red line represents

136
00:04:43,520 --> 00:04:48,080
all flips

137
00:04:44,960 --> 00:04:50,479
there's no obvious change over time

138
00:04:48,080 --> 00:04:53,198
the second figure shows the cdf of

139
00:04:50,479 --> 00:04:56,960
engines on the number of flips

140
00:04:53,199 --> 00:04:59,440
all except one engine generate flips

141
00:04:56,960 --> 00:05:00,159
however the red line is skewed to the

142
00:04:59,440 --> 00:05:02,479
left

143
00:05:00,160 --> 00:05:05,520
indicating that a small group of engines

144
00:05:02,479 --> 00:05:08,840
contributes the majority of the flips

145
00:05:05,520 --> 00:05:10,080
we have similar observations on hazard

146
00:05:08,840 --> 00:05:12,400
flips

147
00:05:10,080 --> 00:05:13,599
third figure shows how flips and hazard

148
00:05:12,400 --> 00:05:16,159
flips distribute

149
00:05:13,600 --> 00:05:19,039
across files we find that only nine

150
00:05:16,160 --> 00:05:21,759
percent of the files have no flip

151
00:05:19,039 --> 00:05:24,159
and about 50 percent of the files have a

152
00:05:21,759 --> 00:05:26,639
few flips

153
00:05:24,160 --> 00:05:27,600
in sum both flips and hazard flips

154
00:05:26,639 --> 00:05:31,360
widely exist

155
00:05:27,600 --> 00:05:34,560
across scandals engines and files

156
00:05:31,360 --> 00:05:37,440
as flips widely exist users would ask

157
00:05:34,560 --> 00:05:39,360
how long they should wait until a file

158
00:05:37,440 --> 00:05:42,080
become stable

159
00:05:39,360 --> 00:05:44,320
here stable means all engine's levels

160
00:05:42,080 --> 00:05:46,240
won't change anymore

161
00:05:44,320 --> 00:05:48,960
we measured the percentage of steel

162
00:05:46,240 --> 00:05:51,520
files as time went by

163
00:05:48,960 --> 00:05:52,320
this stunning jump is because one engine

164
00:05:51,520 --> 00:05:56,000
has hazards

165
00:05:52,320 --> 00:05:58,159
on more than 3 000 files on that day

166
00:05:56,000 --> 00:06:00,319
we found that only when the days to

167
00:05:58,160 --> 00:06:03,840
weight is more than 300

168
00:06:00,319 --> 00:06:06,560
the percentage begins to increase

169
00:06:03,840 --> 00:06:08,080
unfortunately this is because the time

170
00:06:06,560 --> 00:06:10,160
period between the date

171
00:06:08,080 --> 00:06:11,440
and the end of this collection is too

172
00:06:10,160 --> 00:06:14,479
small

173
00:06:11,440 --> 00:06:16,960
thus we need to ignore this part

174
00:06:14,479 --> 00:06:17,840
even when we remove some engines with

175
00:06:16,960 --> 00:06:21,120
most flips

176
00:06:17,840 --> 00:06:22,880
and only have 20-35 engines left

177
00:06:21,120 --> 00:06:24,400
waiting for a longer period of time

178
00:06:22,880 --> 00:06:27,600
still does not guarantee

179
00:06:24,400 --> 00:06:29,198
to have more stable files

180
00:06:27,600 --> 00:06:32,880
next we take a look at how

181
00:06:29,199 --> 00:06:36,160
threshold-based label aggregation works

182
00:06:32,880 --> 00:06:38,719
as we discussed earlier many researchers

183
00:06:36,160 --> 00:06:40,639
use a threshold to aggregate labels of

184
00:06:38,720 --> 00:06:43,680
different resource engines

185
00:06:40,639 --> 00:06:45,840
when t is chosen at the threshold a file

186
00:06:43,680 --> 00:06:48,319
is considered to be malicious

187
00:06:45,840 --> 00:06:48,960
when t and volunteer engines detect the

188
00:06:48,319 --> 00:06:54,080
file as

189
00:06:48,960 --> 00:06:57,280
malicious here is an example

190
00:06:54,080 --> 00:06:59,840
assume we choose t to be two

191
00:06:57,280 --> 00:07:02,719
on day one there are two engines

192
00:06:59,840 --> 00:07:06,080
detecting the file

193
00:07:02,720 --> 00:07:08,319
the aggregate label is malicious

194
00:07:06,080 --> 00:07:09,919
since our total engines may change their

195
00:07:08,319 --> 00:07:12,479
labeling decisions

196
00:07:09,919 --> 00:07:14,400
the aggregated label may also change

197
00:07:12,479 --> 00:07:19,280
over time

198
00:07:14,400 --> 00:07:23,520
on d4 only one engine detects the file

199
00:07:19,280 --> 00:07:26,080
the aggregated label becomes benign

200
00:07:23,520 --> 00:07:27,919
we consider a file with both benign the

201
00:07:26,080 --> 00:07:30,800
malicious aggregate labels

202
00:07:27,919 --> 00:07:33,280
as the file whose aggregated label is

203
00:07:30,800 --> 00:07:35,440
influenced by flips

204
00:07:33,280 --> 00:07:37,758
we measured the percentage of influenced

205
00:07:35,440 --> 00:07:41,039
files for different team

206
00:07:37,759 --> 00:07:41,440
here are the results the first bar shows

207
00:07:41,039 --> 00:07:44,639
how

208
00:07:41,440 --> 00:07:47,280
files only with b9 aggregate labels

209
00:07:44,639 --> 00:07:48,720
files with both benign and malicious

210
00:07:47,280 --> 00:07:51,440
aggregate labels

211
00:07:48,720 --> 00:07:52,240
and files only with malicious aggregated

212
00:07:51,440 --> 00:07:56,319
labels

213
00:07:52,240 --> 00:07:58,400
distribute when t is equal to 1

214
00:07:56,319 --> 00:07:59,360
a large portion of files aggregated

215
00:07:58,400 --> 00:08:02,719
labels are

216
00:07:59,360 --> 00:08:05,919
influenced by flips however

217
00:08:02,720 --> 00:08:10,240
when t is equal to 2 the number of

218
00:08:05,919 --> 00:08:13,758
influence files significantly decreases

219
00:08:10,240 --> 00:08:16,560
when t is in the range from 2 to 20

220
00:08:13,759 --> 00:08:18,639
the ratio of influence file is less than

221
00:08:16,560 --> 00:08:21,520
4

222
00:08:18,639 --> 00:08:22,080
when t is large the ratio of influence

223
00:08:21,520 --> 00:08:25,680
files

224
00:08:22,080 --> 00:08:28,000
becomes large again in sum

225
00:08:25,680 --> 00:08:29,280
flips can heavily influence labeling

226
00:08:28,000 --> 00:08:32,719
aggregation results

227
00:08:29,280 --> 00:08:35,360
when t is too small or too large when t

228
00:08:32,719 --> 00:08:35,919
is from a reasonable range the aggregate

229
00:08:35,360 --> 00:08:39,039
labels

230
00:08:35,919 --> 00:08:41,199
are likely to be stable

231
00:08:39,039 --> 00:08:42,880
now we are going to study whether

232
00:08:41,200 --> 00:08:44,720
engines are independent

233
00:08:42,880 --> 00:08:46,720
by inspecting how similar their

234
00:08:44,720 --> 00:08:48,800
detection results are

235
00:08:46,720 --> 00:08:49,920
we take two steps to compute the

236
00:08:48,800 --> 00:08:53,120
similarity

237
00:08:49,920 --> 00:08:55,360
between engine a and engine b

238
00:08:53,120 --> 00:08:57,040
we first compute the similarity for each

239
00:08:55,360 --> 00:08:59,279
pair of labeling sequences

240
00:08:57,040 --> 00:09:00,880
when the two engines analyze the same

241
00:08:59,279 --> 00:09:03,200
file

242
00:09:00,880 --> 00:09:04,800
we then compute the engine similarity

243
00:09:03,200 --> 00:09:05,760
and the average sequence level

244
00:09:04,800 --> 00:09:09,120
similarity

245
00:09:05,760 --> 00:09:11,439
over all the files here is one

246
00:09:09,120 --> 00:09:13,279
example for how to compute sixth level

247
00:09:11,440 --> 00:09:15,680
similarity

248
00:09:13,279 --> 00:09:17,360
for each sequence we first divide it

249
00:09:15,680 --> 00:09:19,680
into beings

250
00:09:17,360 --> 00:09:20,560
we then extract four features from each

251
00:09:19,680 --> 00:09:23,040
beam

252
00:09:20,560 --> 00:09:24,719
based on the number of zero to one or

253
00:09:23,040 --> 00:09:27,279
one to zero flips

254
00:09:24,720 --> 00:09:28,160
and the number of longest consecutive

255
00:09:27,279 --> 00:09:31,600
sequences

256
00:09:28,160 --> 00:09:32,480
of one or zero we combine features from

257
00:09:31,600 --> 00:09:36,000
different bins

258
00:09:32,480 --> 00:09:38,399
into a feature vector the similarity

259
00:09:36,000 --> 00:09:39,440
between the two sequences is the cosine

260
00:09:38,399 --> 00:09:42,240
similarity

261
00:09:39,440 --> 00:09:44,480
between the two feature vectors we

262
00:09:42,240 --> 00:09:47,519
visualize the similarity results

263
00:09:44,480 --> 00:09:49,440
using a dendrogram where x-axis

264
00:09:47,519 --> 00:09:50,959
represents different engines on the

265
00:09:49,440 --> 00:09:54,800
y-axis represents

266
00:09:50,959 --> 00:09:58,079
engines distance distance is computed as

267
00:09:54,800 --> 00:10:00,880
one minus the similarity engines with

268
00:09:58,080 --> 00:10:03,120
minimal distances are connected

269
00:10:00,880 --> 00:10:04,640
overall detection results are similar

270
00:10:03,120 --> 00:10:06,839
for all engines

271
00:10:04,640 --> 00:10:08,079
when selecting the distance threshold at

272
00:10:06,839 --> 00:10:10,800
0.01

273
00:10:08,079 --> 00:10:11,359
we find several interesting clusters

274
00:10:10,800 --> 00:10:14,160
first

275
00:10:11,360 --> 00:10:15,680
avast and avg combined into one company

276
00:10:14,160 --> 00:10:17,279
in 2016

277
00:10:15,680 --> 00:10:18,719
and their detailed results are very

278
00:10:17,279 --> 00:10:21,040
similar

279
00:10:18,720 --> 00:10:22,079
second these two are products from the

280
00:10:21,040 --> 00:10:25,599
same company key

281
00:10:22,079 --> 00:10:26,399
seven third these six engines are also

282
00:10:25,600 --> 00:10:28,240
very similar

283
00:10:26,399 --> 00:10:29,760
but they are not obviously connected

284
00:10:28,240 --> 00:10:33,200
with each other

285
00:10:29,760 --> 00:10:34,319
here is a file we can see that five of

286
00:10:33,200 --> 00:10:37,839
the six engines

287
00:10:34,320 --> 00:10:40,640
reported exactly the same results

288
00:10:37,839 --> 00:10:42,079
to sum up there are groups of engines

289
00:10:40,640 --> 00:10:45,120
whose leveling decisions

290
00:10:42,079 --> 00:10:47,279
have strong correlations

291
00:10:45,120 --> 00:10:49,279
now we briefly discuss the results on

292
00:10:47,279 --> 00:10:51,680
the ground truth data set

293
00:10:49,279 --> 00:10:52,959
we mainly use obfuscation to create

294
00:10:51,680 --> 00:10:56,079
fresh ground truth

295
00:10:52,959 --> 00:10:58,880
samples however we found that

296
00:10:56,079 --> 00:11:02,079
observation brings many false positives

297
00:10:58,880 --> 00:11:04,560
even for some high reputation engines

298
00:11:02,079 --> 00:11:06,560
we also found that when threshold t is

299
00:11:04,560 --> 00:11:09,760
chosen from 3 for 15

300
00:11:06,560 --> 00:11:12,399
we can have accurate aggregation labels

301
00:11:09,760 --> 00:11:14,079
we notice that inconsistency exists

302
00:11:12,399 --> 00:11:16,320
between the desktop version and the

303
00:11:14,079 --> 00:11:18,239
virus total version

304
00:11:16,320 --> 00:11:19,360
more results on the ground truth data

305
00:11:18,240 --> 00:11:23,519
set can be found

306
00:11:19,360 --> 00:11:26,240
in our paper let me conclude my talk

307
00:11:23,519 --> 00:11:27,519
in this paper we first surveyed how

308
00:11:26,240 --> 00:11:30,720
previous researchers

309
00:11:27,519 --> 00:11:31,360
used mars hotel we then took data-driven

310
00:11:30,720 --> 00:11:34,399
methods

311
00:11:31,360 --> 00:11:36,640
to validate the previous methodologies

312
00:11:34,399 --> 00:11:38,399
here we have several suggestions on how

313
00:11:36,640 --> 00:11:40,560
to use rabsuto

314
00:11:38,399 --> 00:11:41,519
first our suitable data needs to be

315
00:11:40,560 --> 00:11:44,880
pre-processed

316
00:11:41,519 --> 00:11:45,360
such as removing hazards second a super

317
00:11:44,880 --> 00:11:47,680
t

318
00:11:45,360 --> 00:11:49,519
needs to be selected to aggregate labels

319
00:11:47,680 --> 00:11:51,920
of different engines

320
00:11:49,519 --> 00:11:52,560
third both correlation and causality

321
00:11:51,920 --> 00:11:55,279
exist

322
00:11:52,560 --> 00:11:56,160
between engines different engines should

323
00:11:55,279 --> 00:11:58,880
not be treated

324
00:11:56,160 --> 00:12:00,639
equally in the end high repetition

325
00:11:58,880 --> 00:12:02,240
engines are not always accurate

326
00:12:00,639 --> 00:12:03,760
attention is still needed for their

327
00:12:02,240 --> 00:12:05,680
detection results

328
00:12:03,760 --> 00:12:11,839
that's it thank you very much i would

329
00:12:05,680 --> 00:12:11,839
like to take questions

330
00:12:16,959 --> 00:12:19,040
you

