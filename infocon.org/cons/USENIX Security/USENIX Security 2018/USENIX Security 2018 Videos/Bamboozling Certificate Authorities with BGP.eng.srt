1
00:00:09,650 --> 00:00:13,969
my name is Henry<font color="#CCCCCC"> Burge</font><font color="#E5E5E5"> Lee and I've had</font>

2
00:00:12,769 --> 00:00:15,350
the honor of working<font color="#E5E5E5"> at Princeton</font>

3
00:00:13,969 --> 00:00:18,169
University<font color="#CCCCCC"> with these amazing</font>

4
00:00:15,350 --> 00:00:20,660
researchers on bamboozling<font color="#E5E5E5"> certificate</font>

5
00:00:18,170 --> 00:00:23,270
authorities with<font color="#CCCCCC"> BGP or the border</font>

6
00:00:20,660 --> 00:00:25,369
gateway protocol so I want to start<font color="#E5E5E5"> by</font>

7
00:00:23,270 --> 00:00:27,110
motivating<font color="#E5E5E5"> this problem let's say</font><font color="#CCCCCC"> that I</font>

8
00:00:25,369 --> 00:00:29,210
want<font color="#E5E5E5"> to connect to the credit card</font>

9
00:00:27,110 --> 00:00:32,418
payment processing<font color="#CCCCCC"> company van</font><font color="#E5E5E5"> t'v at</font>

10
00:00:29,210 --> 00:00:34,640
their website<font color="#CCCCCC"> Van TOCOM however I'm on</font>

11
00:00:32,418 --> 00:00:36,559
someone else's<font color="#CCCCCC"> network and I</font><font color="#E5E5E5"> potentially</font>

12
00:00:34,640 --> 00:00:38,059
don't trust this<font color="#E5E5E5"> network how do I know</font>

13
00:00:36,559 --> 00:00:41,360
that<font color="#CCCCCC"> I'm actually getting a server at</font>

14
00:00:38,059 --> 00:00:43,370
<font color="#CCCCCC">Van TOCOM</font><font color="#E5E5E5"> well pretty much the current</font>

15
00:00:41,360 --> 00:00:46,089
<font color="#E5E5E5">system in place</font><font color="#CCCCCC"> for this is</font><font color="#E5E5E5"> at Vantage</font>

16
00:00:43,370 --> 00:00:48,199
comm will present me with a certificate

17
00:00:46,089 --> 00:00:50,120
containing their public key that<font color="#CCCCCC"> I'll</font>

18
00:00:48,199 --> 00:00:51,858
later use to<font color="#E5E5E5"> encrypt my data with them</font>

19
00:00:50,120 --> 00:00:53,629
and I'm<font color="#E5E5E5"> gonna trust this certificate</font>

20
00:00:51,859 --> 00:00:56,179
<font color="#CCCCCC">only if it's signed by a trusted</font>

21
00:00:53,629 --> 00:00:58,309
<font color="#CCCCCC">certificate authority that my</font><font color="#E5E5E5"> browser</font>

22
00:00:56,179 --> 00:01:00,320
knows to trust<font color="#CCCCCC"> so in</font><font color="#E5E5E5"> this case the</font>

23
00:00:58,309 --> 00:01:03,230
certificate authority is<font color="#E5E5E5"> entrust right</font>

24
00:01:00,320 --> 00:01:05,300
down here<font color="#E5E5E5"> and because my browser has</font>

25
00:01:03,230 --> 00:01:07,280
<font color="#CCCCCC">entrust installed as a trusted</font>

26
00:01:05,300 --> 00:01:10,460
certificate<font color="#E5E5E5"> authority and knows</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> trust</font>

27
00:01:07,280 --> 00:01:12,740
this certificate for<font color="#E5E5E5"> mantle comm and in</font>

28
00:01:10,460 --> 00:01:14,929
this nature<font color="#E5E5E5"> certificate authorities are</font>

29
00:01:12,740 --> 00:01:16,940
really a<font color="#CCCCCC"> route</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> trust for</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> internet</font>

30
00:01:14,930 --> 00:01:19,490
encryption<font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> ensures that</font>

31
00:01:16,940 --> 00:01:20,750
<font color="#E5E5E5">on a first-time connection that you</font>

32
00:01:19,490 --> 00:01:22,670
actually know you're getting<font color="#E5E5E5"> the proper</font>

33
00:01:20,750 --> 00:01:24,490
<font color="#CCCCCC">sites so you've never</font><font color="#E5E5E5"> actually exchanged</font>

34
00:01:22,670 --> 00:01:26,690
key data with this site<font color="#CCCCCC"> previously</font>

35
00:01:24,490 --> 00:01:29,119
however<font color="#E5E5E5"> what I want to talk</font><font color="#CCCCCC"> about in</font>

36
00:01:26,690 --> 00:01:32,509
<font color="#E5E5E5">this attack is how vulnerabilities in</font>

37
00:01:29,120 --> 00:01:35,960
<font color="#E5E5E5">BGP undermine this trust that we've</font>

38
00:01:32,510 --> 00:01:37,940
placed in certificate authorities so

39
00:01:35,960 --> 00:01:39,679
with that in mind<font color="#E5E5E5"> I want to look at the</font>

40
00:01:37,940 --> 00:01:42,770
process<font color="#CCCCCC"> that certificate</font><font color="#E5E5E5"> authorities</font>

41
00:01:39,680 --> 00:01:44,660
actually<font color="#E5E5E5"> used to sign certificates so</font>

42
00:01:42,770 --> 00:01:47,240
let's say<font color="#CCCCCC"> that I control the domain</font>

43
00:01:44,660 --> 00:01:49,940
example.com<font color="#CCCCCC"> and I'd like</font><font color="#E5E5E5"> to get a</font>

44
00:01:47,240 --> 00:01:51,589
certificate<font color="#E5E5E5"> for my domain</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'm going</font>

45
00:01:49,940 --> 00:01:53,360
<font color="#CCCCCC">to start by selecting a certificate</font>

46
00:01:51,590 --> 00:01:55,910
authority<font color="#CCCCCC"> and approaching them with a</font>

47
00:01:53,360 --> 00:01:57,920
certificate<font color="#E5E5E5"> signing request</font><font color="#CCCCCC"> containing</font>

48
00:01:55,910 --> 00:01:59,750
<font color="#CCCCCC">the domain I want a</font><font color="#E5E5E5"> certificate for and</font>

49
00:01:57,920 --> 00:02:01,280
they're not<font color="#E5E5E5"> going to sign the request</font>

50
00:01:59,750 --> 00:02:04,130
immediately<font color="#E5E5E5"> instead they're going to get</font>

51
00:02:01,280 --> 00:02:06,920
back<font color="#E5E5E5"> to me with a challenge which</font><font color="#CCCCCC"> Emin</font>

52
00:02:04,130 --> 00:02:10,008
<font color="#E5E5E5">straits that</font><font color="#CCCCCC"> I actually</font><font color="#E5E5E5"> control example</font>

53
00:02:06,920 --> 00:02:11,959
<font color="#E5E5E5">calm and presuming that</font><font color="#CCCCCC"> I am the site</font>

54
00:02:10,008 --> 00:02:14,629
<font color="#CCCCCC">administrator for</font><font color="#E5E5E5"> example.com I can</font>

55
00:02:11,959 --> 00:02:16,430
simply modify my servers to upload the

56
00:02:14,629 --> 00:02:17,929
content so these challenges normally

57
00:02:16,430 --> 00:02:20,870
<font color="#E5E5E5">consist of putting a certain</font><font color="#CCCCCC"> piece of</font>

58
00:02:17,930 --> 00:02:23,450
<font color="#E5E5E5">content at a certain</font><font color="#CCCCCC"> URL on the</font><font color="#E5E5E5"> domain</font>

59
00:02:20,870 --> 00:02:25,610
<font color="#E5E5E5">so once I modify my servers</font>

60
00:02:23,450 --> 00:02:28,760
certificate authority can simply go and

61
00:02:25,610 --> 00:02:31,489
check for<font color="#E5E5E5"> this content and presuming</font>

62
00:02:28,760 --> 00:02:33,620
<font color="#E5E5E5">that</font><font color="#CCCCCC"> it gets the proper response it will</font>

63
00:02:31,489 --> 00:02:35,720
<font color="#CCCCCC">sign my</font><font color="#E5E5E5"> certificate but we need to</font>

64
00:02:33,620 --> 00:02:38,750
consider<font color="#E5E5E5"> that an adversary</font><font color="#CCCCCC"> can come into</font>

65
00:02:35,720 --> 00:02:41,269
<font color="#E5E5E5">this process simply by observing this</font>

66
00:02:38,750 --> 00:02:45,110
request<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the content so if an</font>

67
00:02:41,269 --> 00:02:47,840
adversary<font color="#E5E5E5"> say uses BGP to</font><font color="#CCCCCC"> hear this</font>

68
00:02:45,110 --> 00:02:49,730
<font color="#CCCCCC">request</font><font color="#E5E5E5"> for the content the adversary</font>

69
00:02:47,840 --> 00:02:51,860
server can simply generate<font color="#E5E5E5"> the proper</font>

70
00:02:49,730 --> 00:02:54,410
response<font color="#CCCCCC"> even though the</font><font color="#E5E5E5"> content doesn't</font>

71
00:02:51,860 --> 00:02:56,480
<font color="#E5E5E5">actually exist at example.com and in</font>

72
00:02:54,410 --> 00:02:58,819
this manner<font color="#E5E5E5"> an adversary can get a</font>

73
00:02:56,480 --> 00:03:03,048
certificate<font color="#E5E5E5"> for a domain</font><font color="#CCCCCC"> that it doesn't</font>

74
00:02:58,819 --> 00:03:04,940
<font color="#E5E5E5">control so with this in</font><font color="#CCCCCC"> mind</font><font color="#E5E5E5"> I kind of</font>

75
00:03:03,049 --> 00:03:08,450
want to switch<font color="#CCCCCC"> gears</font><font color="#E5E5E5"> a little bit to</font><font color="#CCCCCC"> UM</font>

76
00:03:04,940 --> 00:03:10,569
networking and looking at BGP<font color="#E5E5E5"> or the</font>

77
00:03:08,450 --> 00:03:13,790
border gateway protocol<font color="#E5E5E5"> um</font>

78
00:03:10,569 --> 00:03:16,130
<font color="#E5E5E5">BGP is the protocol by which autonomous</font>

79
00:03:13,790 --> 00:03:19,400
systems or a<font color="#CCCCCC"> s's exchange routes with</font>

80
00:03:16,130 --> 00:03:22,790
each other<font color="#E5E5E5"> so each circle here is an</font><font color="#CCCCCC"> AAS</font>

81
00:03:19,400 --> 00:03:24,680
<font color="#E5E5E5">and you can think of an a s as in</font><font color="#CCCCCC"> ISP</font><font color="#E5E5E5"> or</font>

82
00:03:22,790 --> 00:03:27,078
sometimes large content providers are

83
00:03:24,680 --> 00:03:28,549
also a<font color="#E5E5E5"> SS and BGP is the routing</font>

84
00:03:27,079 --> 00:03:30,859
protocol by which<font color="#E5E5E5"> they talk to each</font>

85
00:03:28,549 --> 00:03:35,780
other and agree<font color="#CCCCCC"> on who has which IP</font>

86
00:03:30,859 --> 00:03:38,690
prefix is so under normal operating

87
00:03:35,780 --> 00:03:41,150
procedure kind of example<font color="#E5E5E5"> comm let's say</font>

88
00:03:38,690 --> 00:03:45,319
it's run out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this IP prefix</font><font color="#CCCCCC"> 2 to 2</font>

89
00:03:41,150 --> 00:03:47,090
<font color="#E5E5E5">slash 23 example.com say s is going</font><font color="#CCCCCC"> to</font>

90
00:03:45,319 --> 00:03:49,310
<font color="#E5E5E5">announce</font><font color="#CCCCCC"> that prefix</font><font color="#E5E5E5"> and once the</font>

91
00:03:47,090 --> 00:03:51,049
routing protocol converges<font color="#E5E5E5"> all</font><font color="#CCCCCC"> internet</font>

92
00:03:49,310 --> 00:03:55,160
traffic is going to<font color="#CCCCCC"> be sent to that a s</font>

93
00:03:51,049 --> 00:03:58,940
for example<font color="#E5E5E5"> com however the simplest</font>

94
00:03:55,160 --> 00:04:02,329
attack an adversary<font color="#CCCCCC"> can launch in</font><font color="#E5E5E5"> BGP is</font>

95
00:03:58,940 --> 00:04:04,370
simply announcing<font color="#E5E5E5"> a sub prefix or a more</font>

96
00:04:02,329 --> 00:04:06,859
specific prefix so this is a prefix with

97
00:04:04,370 --> 00:04:08,030
a longer prefix<font color="#CCCCCC"> masked 24 bits instead</font>

98
00:04:06,859 --> 00:04:10,910
<font color="#CCCCCC">of 23</font><font color="#E5E5E5"> bits</font>

99
00:04:08,030 --> 00:04:12,859
it contains fewer IP addresses<font color="#E5E5E5"> but it's</font>

100
00:04:10,910 --> 00:04:15,349
more specific<font color="#CCCCCC"> and because of longest</font>

101
00:04:12,859 --> 00:04:17,359
prefix match routing all<font color="#CCCCCC"> is is on the</font>

102
00:04:15,349 --> 00:04:19,728
<font color="#E5E5E5">internet will prefer this more specific</font>

103
00:04:17,358 --> 00:04:22,820
route<font color="#E5E5E5"> for getting to example.com</font>

104
00:04:19,728 --> 00:04:26,690
so here the adversary gets<font color="#E5E5E5"> all of</font>

105
00:04:22,820 --> 00:04:28,789
example<font color="#CCCCCC"> coms traffic</font><font color="#E5E5E5"> and this includes</font>

106
00:04:26,690 --> 00:04:30,260
the get<font color="#CCCCCC"> request to</font><font color="#E5E5E5"> check the</font>

107
00:04:28,789 --> 00:04:33,979
verification document from<font color="#CCCCCC"> the</font>

108
00:04:30,260 --> 00:04:34,650
certificate authority<font color="#E5E5E5"> however</font><font color="#CCCCCC"> really the</font>

109
00:04:33,979 --> 00:04:37,620
catch with the

110
00:04:34,650 --> 00:04:39,030
attack is that all<font color="#E5E5E5"> routers are going to</font>

111
00:04:37,620 --> 00:04:40,320
<font color="#CCCCCC">prefer this</font><font color="#E5E5E5"> announcement and this</font>

112
00:04:39,030 --> 00:04:43,198
<font color="#E5E5E5">announcement is</font><font color="#CCCCCC"> going to be globally</font>

113
00:04:40,320 --> 00:04:45,030
visible<font color="#CCCCCC"> and as a result is</font><font color="#E5E5E5"> really not</font>

114
00:04:43,199 --> 00:04:46,530
<font color="#CCCCCC">very stealthy because</font><font color="#E5E5E5"> example.com is</font>

115
00:04:45,030 --> 00:04:49,888
going to notice a global connectivity

116
00:04:46,530 --> 00:04:51,448
outage<font color="#E5E5E5"> the moment this happens so with</font>

117
00:04:49,889 --> 00:04:53,600
this in mind<font color="#CCCCCC"> this sort of more stealthy</font>

118
00:04:51,449 --> 00:04:56,970
variant was presented at blackhat in

119
00:04:53,600 --> 00:04:58,410
2015 and first noticed I moved the

120
00:04:56,970 --> 00:04:59,789
certificate authority a little<font color="#CCCCCC"> bit</font>

121
00:04:58,410 --> 00:05:02,789
closer to the adversary<font color="#CCCCCC"> and you'll see</font>

122
00:04:59,789 --> 00:05:04,949
why<font color="#E5E5E5"> in a moment</font><font color="#CCCCCC"> if the adversary</font><font color="#E5E5E5"> is to</font>

123
00:05:02,789 --> 00:05:08,940
announce the<font color="#E5E5E5"> same prefix as the victim</font>

124
00:05:04,949 --> 00:05:10,530
so<font color="#CCCCCC"> - - - slash</font><font color="#E5E5E5"> 23 again in a way these</font>

125
00:05:08,940 --> 00:05:12,030
two announcements sort of compete for

126
00:05:10,530 --> 00:05:13,229
Internet traffic<font color="#E5E5E5"> and you can think of</font>

127
00:05:12,030 --> 00:05:16,380
the<font color="#E5E5E5"> internet actually being partitioned</font>

128
00:05:13,229 --> 00:05:17,820
<font color="#E5E5E5">into two parts</font><font color="#CCCCCC"> an unaffected portion</font>

129
00:05:16,380 --> 00:05:19,620
which is<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to continue</font><font color="#CCCCCC"> to use its</font>

130
00:05:17,820 --> 00:05:22,500
old route for example<font color="#CCCCCC"> com and</font>

131
00:05:19,620 --> 00:05:24,419
interestingly some<font color="#CCCCCC"> is is in</font><font color="#E5E5E5"> that portion</font>

132
00:05:22,500 --> 00:05:26,310
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> will actually not even</font>

133
00:05:24,419 --> 00:05:28,919
<font color="#E5E5E5">hear the adversaries malicious</font>

134
00:05:26,310 --> 00:05:30,720
announcement and then a hijacked portion

135
00:05:28,919 --> 00:05:33,180
where traffic<font color="#E5E5E5"> is going to</font><font color="#CCCCCC"> the adversary</font>

136
00:05:30,720 --> 00:05:34,970
<font color="#E5E5E5">and so clearly if the certificate</font>

137
00:05:33,180 --> 00:05:37,620
authority is in<font color="#E5E5E5"> this hijacked portion</font>

138
00:05:34,970 --> 00:05:39,240
then the get request<font color="#E5E5E5"> goes</font><font color="#CCCCCC"> to the</font>

139
00:05:37,620 --> 00:05:40,970
<font color="#E5E5E5">adversary and</font><font color="#CCCCCC"> we can get a bogus</font>

140
00:05:39,240 --> 00:05:44,190
certificate the same way we<font color="#E5E5E5"> did before</font>

141
00:05:40,970 --> 00:05:46,470
however kind of the with this attack

142
00:05:44,190 --> 00:05:48,270
<font color="#E5E5E5">we're still looking at causing a</font>

143
00:05:46,470 --> 00:05:50,190
connectivity outage now it's been

144
00:05:48,270 --> 00:05:52,740
localized this time and it's definitely

145
00:05:50,190 --> 00:05:54,270
<font color="#E5E5E5">more stealthy because not everyone here</font>

146
00:05:52,740 --> 00:05:56,699
<font color="#E5E5E5">is it we're still looking at breaking</font>

147
00:05:54,270 --> 00:06:00,389
example<font color="#CCCCCC"> comms connectivity in this</font>

148
00:05:56,699 --> 00:06:01,889
region<font color="#CCCCCC"> so with that</font><font color="#E5E5E5"> in mind</font><font color="#CCCCCC"> I kind of</font>

149
00:06:00,389 --> 00:06:06,110
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about a third attack and</font>

150
00:06:01,889 --> 00:06:08,280
this is known as<font color="#CCCCCC"> a.m. a</font><font color="#E5E5E5"> is and also</font>

151
00:06:06,110 --> 00:06:09,720
<font color="#CCCCCC">going</font><font color="#E5E5E5"> back as I mentioned with</font><font color="#CCCCCC"> the</font>

152
00:06:08,280 --> 00:06:11,909
certificate<font color="#CCCCCC"> authority if we move it back</font>

153
00:06:09,720 --> 00:06:13,260
to<font color="#CCCCCC"> where</font><font color="#E5E5E5"> it was before this adversary</font>

154
00:06:11,909 --> 00:06:14,789
can't<font color="#CCCCCC"> actually launch this attack</font>

155
00:06:13,260 --> 00:06:16,260
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the certificate authorities in</font>

156
00:06:14,789 --> 00:06:19,199
the unaffected portion of the<font color="#CCCCCC"> internet</font>

157
00:06:16,260 --> 00:06:22,800
<font color="#E5E5E5">so not all a say SS can perform those</font>

158
00:06:19,199 --> 00:06:24,630
equally specific prefix attacks so<font color="#E5E5E5"> that</font>

159
00:06:22,800 --> 00:06:27,030
sort of<font color="#CCCCCC"> brings us to a</font><font color="#E5E5E5"> third attack and</font>

160
00:06:24,630 --> 00:06:29,789
here an adversary is going<font color="#CCCCCC"> to go back to</font>

161
00:06:27,030 --> 00:06:31,739
announcing a sub prefix but instead of

162
00:06:29,789 --> 00:06:33,690
<font color="#E5E5E5">announcing that it owns this sub prefix</font>

163
00:06:31,740 --> 00:06:35,580
is simply going to claim<font color="#E5E5E5"> reach</font><font color="#CCCCCC"> ability</font>

164
00:06:33,690 --> 00:06:38,849
to<font color="#E5E5E5"> this sub prefix through its</font>

165
00:06:35,580 --> 00:06:40,590
legitimate route to the victim so<font color="#E5E5E5"> this</font>

166
00:06:38,849 --> 00:06:42,960
adversary would normally<font color="#CCCCCC"> get</font><font color="#E5E5E5"> to example</font>

167
00:06:40,590 --> 00:06:44,820
<font color="#CCCCCC">calm through a s</font><font color="#E5E5E5"> floor so it's going to</font>

168
00:06:42,960 --> 00:06:47,729
<font color="#E5E5E5">claim</font><font color="#CCCCCC"> that it can reach example calm at</font>

169
00:06:44,820 --> 00:06:48,780
this<font color="#CCCCCC"> / 20 floor prefix</font><font color="#E5E5E5"> going through a</font>

170
00:06:47,729 --> 00:06:52,340
<font color="#CCCCCC">s4</font><font color="#E5E5E5"> as</font>

171
00:06:48,780 --> 00:06:55,440
and what happens in this case is that a

172
00:06:52,340 --> 00:06:57,570
<font color="#E5E5E5">s4 doesn't want to import a route that's</font>

173
00:06:55,440 --> 00:07:00,210
going to cause a loop<font color="#E5E5E5"> so in</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> to</font>

174
00:06:57,570 --> 00:07:01,469
prevent loops and routing loop detection

175
00:07:00,210 --> 00:07:03,989
at<font color="#E5E5E5"> a s we're just going to drop this</font>

176
00:07:01,470 --> 00:07:07,320
<font color="#CCCCCC">route and a s floor is going</font><font color="#E5E5E5"> to continue</font>

177
00:07:03,990 --> 00:07:10,080
<font color="#E5E5E5">to use</font><font color="#CCCCCC"> its old route for the slash</font><font color="#E5E5E5"> 23</font>

178
00:07:07,320 --> 00:07:11,990
prefix to get to<font color="#E5E5E5"> example.com so routing</font>

179
00:07:10,080 --> 00:07:14,849
is effectively unaffected in a s floor

180
00:07:11,990 --> 00:07:16,500
<font color="#E5E5E5">but all the other a s is on the</font><font color="#CCCCCC"> Internet</font>

181
00:07:14,850 --> 00:07:18,150
<font color="#E5E5E5">will see this as a sub prefix and</font>

182
00:07:16,500 --> 00:07:19,140
they'll prefer<font color="#CCCCCC"> it as their route to</font>

183
00:07:18,150 --> 00:07:23,070
example.com

184
00:07:19,140 --> 00:07:25,409
<font color="#CCCCCC">and in this manner we've actually</font>

185
00:07:23,070 --> 00:07:27,690
preserved connectivity to example comm

186
00:07:25,410 --> 00:07:30,900
because the adversary<font color="#E5E5E5"> now can simply</font>

187
00:07:27,690 --> 00:07:32,520
forward<font color="#E5E5E5"> these</font><font color="#CCCCCC"> incoming packets out along</font>

188
00:07:30,900 --> 00:07:36,210
its legitimate route to get to

189
00:07:32,520 --> 00:07:39,539
example.com<font color="#CCCCCC"> and also because this attack</font>

190
00:07:36,210 --> 00:07:41,310
is global<font color="#E5E5E5"> um almost</font><font color="#CCCCCC"> any a s anywhere</font><font color="#E5E5E5"> in</font>

191
00:07:39,540 --> 00:07:43,410
<font color="#CCCCCC">Internet can perform it as long as it's</font>

192
00:07:41,310 --> 00:07:45,570
multihomed so it has one provider<font color="#CCCCCC"> to</font>

193
00:07:43,410 --> 00:07:47,100
receive<font color="#CCCCCC"> traffic and one to forward</font>

194
00:07:45,570 --> 00:07:49,500
<font color="#E5E5E5">traffic and this is very stealthy at the</font>

195
00:07:47,100 --> 00:07:52,530
data<font color="#E5E5E5"> plane because you won't notice any</font>

196
00:07:49,500 --> 00:07:53,940
connectivity effect at<font color="#CCCCCC"> example.com</font><font color="#E5E5E5"> the</font>

197
00:07:52,530 --> 00:07:55,679
other neat<font color="#CCCCCC"> thing about this attack is</font>

198
00:07:53,940 --> 00:07:58,560
that<font color="#E5E5E5"> if you imagine once an adversary</font>

199
00:07:55,680 --> 00:08:00,330
<font color="#CCCCCC">gets a bogus certificate this</font><font color="#E5E5E5"> is exactly</font>

200
00:07:58,560 --> 00:08:02,460
the<font color="#E5E5E5"> network position that they want to</font>

201
00:08:00,330 --> 00:08:05,940
be in to begin<font color="#E5E5E5"> intercepting traffic with</font>

202
00:08:02,460 --> 00:08:07,919
that certificate<font color="#E5E5E5"> so with this in mind we</font>

203
00:08:05,940 --> 00:08:09,300
kind of went<font color="#CCCCCC"> out</font><font color="#E5E5E5"> and we wanted to</font>

204
00:08:07,920 --> 00:08:12,330
actually<font color="#E5E5E5"> launch these attacks in the</font>

205
00:08:09,300 --> 00:08:14,160
wild on the real<font color="#E5E5E5"> internet</font><font color="#CCCCCC"> um and we did</font>

206
00:08:12,330 --> 00:08:16,530
this<font color="#E5E5E5"> in a completely ethical manner so</font>

207
00:08:14,160 --> 00:08:19,380
<font color="#E5E5E5">we had prefix allocated to us from the</font>

208
00:08:16,530 --> 00:08:21,989
peering<font color="#E5E5E5"> testbed and we ran domains on</font>

209
00:08:19,380 --> 00:08:24,000
those prefixes that<font color="#CCCCCC"> belong</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> and</font>

210
00:08:21,990 --> 00:08:26,070
these domains<font color="#E5E5E5"> had no actual users and</font>

211
00:08:24,000 --> 00:08:28,500
then we<font color="#E5E5E5"> went and we hijacked these</font>

212
00:08:26,070 --> 00:08:30,300
prefixes from<font color="#E5E5E5"> other nodes and then we</font>

213
00:08:28,500 --> 00:08:32,280
requested certificates for<font color="#E5E5E5"> our domains</font>

214
00:08:30,300 --> 00:08:34,830
<font color="#E5E5E5">once we had hijacked</font><font color="#CCCCCC"> your own prefixes</font>

215
00:08:32,280 --> 00:08:37,530
<font color="#E5E5E5">and we approached top trusted CA so it's</font>

216
00:08:34,830 --> 00:08:40,410
real valid certificates just<font color="#CCCCCC"> for domains</font>

217
00:08:37,530 --> 00:08:42,539
<font color="#E5E5E5">that don't have any users and I just</font>

218
00:08:40,409 --> 00:08:45,500
want to show a quick video demonstration

219
00:08:42,539 --> 00:08:50,060
of one of these<font color="#E5E5E5"> attacks so this is the</font>

220
00:08:45,500 --> 00:08:50,060
<font color="#CCCCCC">interception attack with path poisoning</font>

221
00:08:54,899 --> 00:08:59,740
so here we have an innocuous client<font color="#E5E5E5"> up</font>

222
00:08:58,089 --> 00:09:03,010
here that's contacting the<font color="#CCCCCC"> web server</font>

223
00:08:59,740 --> 00:09:08,140
<font color="#E5E5E5">and it's</font><font color="#CCCCCC"> HTTP so it's fully secured with</font>

224
00:09:03,010 --> 00:09:11,080
the lock<font color="#CCCCCC"> at</font><font color="#E5E5E5"> MDC t 2g</font><font color="#CCCCCC"> t TK</font><font color="#E5E5E5"> and it's</font>

225
00:09:08,140 --> 00:09:13,180
constantly sending<font color="#E5E5E5"> HTTP Ajax calls home</font>

226
00:09:11,080 --> 00:09:14,740
<font color="#E5E5E5">to its web server so notice that</font>

227
00:09:13,180 --> 00:09:19,000
everything<font color="#CCCCCC"> about this client</font><font color="#E5E5E5"> is</font>

228
00:09:14,740 --> 00:09:21,399
<font color="#E5E5E5">encrypted and secured with HTTPS um over</font>

229
00:09:19,000 --> 00:09:24,250
here<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a terminal on the victims</font>

230
00:09:21,399 --> 00:09:29,880
server and in just<font color="#E5E5E5"> one moment</font><font color="#CCCCCC"> I'm going</font>

231
00:09:24,250 --> 00:09:33,670
<font color="#E5E5E5">to start up a packet trace on</font><font color="#CCCCCC"> that and</font>

232
00:09:29,880 --> 00:09:35,800
what you'll<font color="#CCCCCC"> see is</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> all of these</font>

233
00:09:33,670 --> 00:09:43,750
Ajax calls you can<font color="#E5E5E5"> see them coming in on</font>

234
00:09:35,800 --> 00:09:45,370
the packet trace okay so the Ajax calls

235
00:09:43,750 --> 00:09:47,620
as they're being sent<font color="#CCCCCC"> there are seen on</font>

236
00:09:45,370 --> 00:09:48,850
the packet trace<font color="#E5E5E5"> over here and now we're</font>

237
00:09:47,620 --> 00:09:50,950
going<font color="#E5E5E5"> to go down to</font><font color="#CCCCCC"> the adversary</font>

238
00:09:48,850 --> 00:09:52,089
<font color="#E5E5E5">servers on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> red down here</font><font color="#CCCCCC"> we're going</font>

239
00:09:50,950 --> 00:09:54,190
<font color="#CCCCCC">to start his packet trace for the</font>

240
00:09:52,089 --> 00:09:56,080
adversary<font color="#E5E5E5"> as well and now notice that</font>

241
00:09:54,190 --> 00:09:57,850
the adversary hasn't made any<font color="#CCCCCC"> BGP</font>

242
00:09:56,080 --> 00:09:59,830
announcements yet so this<font color="#E5E5E5"> is just a dry</font>

243
00:09:57,850 --> 00:10:02,230
<font color="#E5E5E5">empty packet trace that's not seeing</font>

244
00:09:59,830 --> 00:10:03,700
anything<font color="#CCCCCC"> and the last thing that the</font>

245
00:10:02,230 --> 00:10:05,020
adversary<font color="#E5E5E5"> would do before</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> would</font>

246
00:10:03,700 --> 00:10:07,390
launch<font color="#E5E5E5"> one of these attacks</font><font color="#CCCCCC"> as though it</font>

247
00:10:05,020 --> 00:10:08,740
were approached let's encrypt<font color="#E5E5E5"> which is</font>

248
00:10:07,390 --> 00:10:10,720
<font color="#E5E5E5">the</font><font color="#CCCCCC"> certificate authority we're going to</font>

249
00:10:08,740 --> 00:10:13,089
use for this<font color="#E5E5E5"> bogus certificate here and</font>

250
00:10:10,720 --> 00:10:16,959
we're going to<font color="#E5E5E5"> request a</font><font color="#CCCCCC"> certificate for</font>

251
00:10:13,089 --> 00:10:19,150
the domain<font color="#CCCCCC"> and once we agree</font><font color="#E5E5E5"> to the IP</font>

252
00:10:16,959 --> 00:10:20,469
logging<font color="#E5E5E5"> it's going to this is the</font>

253
00:10:19,150 --> 00:10:23,439
challenge<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> actually have to</font>

254
00:10:20,470 --> 00:10:24,970
upload<font color="#CCCCCC"> to our server so in preparation</font>

255
00:10:23,440 --> 00:10:28,290
kind of the<font color="#E5E5E5"> adversary can put this</font>

256
00:10:24,970 --> 00:10:28,290
challenge on their web server

257
00:10:32,770 --> 00:10:40,120
and once<font color="#E5E5E5"> this one</font><font color="#CCCCCC"> has</font><font color="#E5E5E5"> been put up all</font>

258
00:10:36,700 --> 00:10:42,100
the adversary needs to do is make<font color="#CCCCCC"> the</font>

259
00:10:40,120 --> 00:10:44,649
<font color="#E5E5E5">BGP announcement required to intercept</font>

260
00:10:42,100 --> 00:10:46,510
traffic<font color="#CCCCCC"> and by the way I</font><font color="#E5E5E5"> should also</font>

261
00:10:44,649 --> 00:10:49,300
notice that the<font color="#CCCCCC"> adversaries route table</font>

262
00:10:46,510 --> 00:10:51,490
has an entry to forward all traffic

263
00:10:49,300 --> 00:10:52,870
<font color="#E5E5E5">through to the victim like you can see</font>

264
00:10:51,490 --> 00:10:54,820
here this is<font color="#E5E5E5"> that traffic going</font><font color="#CCCCCC"> through</font>

265
00:10:52,870 --> 00:10:57,190
<font color="#CCCCCC">the adversary now and then</font><font color="#E5E5E5"> being</font>

266
00:10:54,820 --> 00:10:59,230
forwarded onward to the victim and each

267
00:10:57,190 --> 00:11:01,089
packet<font color="#CCCCCC"> in that log is doubled up once</font>

268
00:10:59,230 --> 00:11:03,970
<font color="#E5E5E5">from the way in and then once from the</font>

269
00:11:01,089 --> 00:11:05,529
way out and but there's a rule<font color="#CCCCCC"> that</font>

270
00:11:03,970 --> 00:11:08,050
traffic<font color="#E5E5E5"> from let's encrypt is going to</font>

271
00:11:05,529 --> 00:11:09,939
be answered instead of forwarded<font color="#E5E5E5"> so this</font>

272
00:11:08,050 --> 00:11:12,310
way the document that<font color="#E5E5E5"> the adversary put</font>

273
00:11:09,940 --> 00:11:14,920
on its web server will take effect

274
00:11:12,310 --> 00:11:16,839
so all that adversary has to do is hit

275
00:11:14,920 --> 00:11:19,270
<font color="#CCCCCC">enter and</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> the request</font><font color="#E5E5E5"> from let's</font>

276
00:11:16,839 --> 00:11:21,010
encrypt will go through and they'll be

277
00:11:19,270 --> 00:11:23,230
answered by the adversary instead of the

278
00:11:21,010 --> 00:11:25,830
victim and notice that the whole time

279
00:11:23,230 --> 00:11:28,149
<font color="#E5E5E5">there's been no change in the packet log</font>

280
00:11:25,830 --> 00:11:30,339
from<font color="#E5E5E5"> the victim's</font><font color="#CCCCCC"> perspective so</font><font color="#E5E5E5"> this</font>

281
00:11:28,149 --> 00:11:32,110
traffic is<font color="#E5E5E5"> all happening</font><font color="#CCCCCC"> as normal and</font>

282
00:11:30,339 --> 00:11:35,440
the victim can't<font color="#E5E5E5"> detect the</font><font color="#CCCCCC"> attack at</font>

283
00:11:32,110 --> 00:11:37,529
this point<font color="#E5E5E5"> so now the adversary</font><font color="#CCCCCC"> can</font>

284
00:11:35,440 --> 00:11:40,209
simply use a certificate<font color="#E5E5E5"> to start</font>

285
00:11:37,529 --> 00:11:42,939
intercepting traffic and as soon as the

286
00:11:40,209 --> 00:11:45,040
adversary<font color="#E5E5E5"> puts the certificate up all of</font>

287
00:11:42,940 --> 00:11:46,779
these Ajax calls that were previously

288
00:11:45,040 --> 00:11:49,209
going through to the victim are now

289
00:11:46,779 --> 00:11:51,399
being<font color="#CCCCCC"> answered by the bogus HTTP</font>

290
00:11:49,209 --> 00:11:54,250
certificate running<font color="#E5E5E5"> on the adversary</font>

291
00:11:51,399 --> 00:11:55,720
server and also do you notice that<font color="#E5E5E5"> with</font>

292
00:11:54,250 --> 00:11:58,000
the current state<font color="#E5E5E5"> of browsers right now</font>

293
00:11:55,720 --> 00:12:00,160
the<font color="#E5E5E5"> browsers don't throw any warnings if</font>

294
00:11:58,000 --> 00:12:03,550
they notice a public key change on this

295
00:12:00,160 --> 00:12:05,110
<font color="#CCCCCC">certificate like this yeah and if we</font>

296
00:12:03,550 --> 00:12:07,120
reload the<font color="#E5E5E5"> page up</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> we get a</font>

297
00:12:05,110 --> 00:12:08,770
completely adversarial copy so we're no

298
00:12:07,120 --> 00:12:10,779
longer going through to the victim as

299
00:12:08,770 --> 00:12:13,420
you<font color="#CCCCCC"> can see now that packets have dried</font>

300
00:12:10,779 --> 00:12:21,160
up<font color="#E5E5E5"> over there and</font><font color="#CCCCCC"> everything's</font><font color="#E5E5E5"> being</font>

301
00:12:13,420 --> 00:12:22,959
<font color="#E5E5E5">answered by the adversary okay um so we</font>

302
00:12:21,160 --> 00:12:24,730
approached several<font color="#E5E5E5"> top certificate</font>

303
00:12:22,959 --> 00:12:26,829
authorities<font color="#E5E5E5"> and we pretty</font><font color="#CCCCCC"> much found</font>

304
00:12:24,730 --> 00:12:30,370
across<font color="#E5E5E5"> the</font><font color="#CCCCCC"> board</font><font color="#E5E5E5"> the same results if</font>

305
00:12:26,829 --> 00:12:32,170
they're all<font color="#CCCCCC"> vulnerable</font><font color="#E5E5E5"> and all of these</font>

306
00:12:30,370 --> 00:12:33,910
certificate authorities<font color="#E5E5E5"> particularly</font>

307
00:12:32,170 --> 00:12:36,130
they signed certificates very quickly

308
00:12:33,910 --> 00:12:38,469
<font color="#E5E5E5">and there's no direct human interaction</font>

309
00:12:36,130 --> 00:12:41,880
so you do not need to be a<font color="#E5E5E5"> human to</font>

310
00:12:38,470 --> 00:12:41,880
request these<font color="#CCCCCC"> certificates and</font>

311
00:12:43,060 --> 00:12:47,089
we also want to mention<font color="#CCCCCC"> very importantly</font>

312
00:12:45,590 --> 00:12:48,500
there's actually a lot more targets than

313
00:12:47,090 --> 00:12:51,680
just the domain servers<font color="#E5E5E5"> for these</font>

314
00:12:48,500 --> 00:12:53,510
attacks<font color="#E5E5E5"> so an adversary</font><font color="#CCCCCC"> kind of target</font><font color="#E5E5E5"> a</font>

315
00:12:51,680 --> 00:12:55,130
domains<font color="#E5E5E5"> email servers because some of</font>

316
00:12:53,510 --> 00:12:57,770
<font color="#E5E5E5">the certificate authorities perform the</font>

317
00:12:55,130 --> 00:13:01,340
verification with email or the domains

318
00:12:57,770 --> 00:13:02,870
authoritative DNS servers<font color="#E5E5E5"> and another</font>

319
00:13:01,340 --> 00:13:04,790
neat variant is that you actually<font color="#E5E5E5"> don't</font>

320
00:13:02,870 --> 00:13:06,530
<font color="#E5E5E5">have to hear traffic going from the</font>

321
00:13:04,790 --> 00:13:09,349
certificate authority to the CA you can

322
00:13:06,530 --> 00:13:11,390
only hear<font color="#E5E5E5"> return traffic so in this case</font>

323
00:13:09,350 --> 00:13:13,790
an adversary can<font color="#E5E5E5"> attack a certificate</font>

324
00:13:11,390 --> 00:13:15,680
authorities prefix and then simply

325
00:13:13,790 --> 00:13:18,260
modify the<font color="#CCCCCC"> returned traffic coming</font><font color="#E5E5E5"> from</font>

326
00:13:15,680 --> 00:13:22,699
<font color="#CCCCCC">the server</font><font color="#E5E5E5"> to get a bogus certificate as</font>

327
00:13:18,260 --> 00:13:24,380
well so with<font color="#E5E5E5"> this in</font><font color="#CCCCCC"> mind we really</font>

328
00:13:22,700 --> 00:13:27,440
wanted<font color="#E5E5E5"> to quantify the vulnerability of</font>

329
00:13:24,380 --> 00:13:29,300
domains out there today<font color="#CCCCCC"> and we really</font>

330
00:13:27,440 --> 00:13:31,340
wanted<font color="#E5E5E5"> to answer how many domains are</font>

331
00:13:29,300 --> 00:13:32,780
vulnerable<font color="#CCCCCC"> to this and how</font><font color="#E5E5E5"> many</font>

332
00:13:31,340 --> 00:13:35,270
<font color="#E5E5E5">adversaries can actually launch these</font>

333
00:13:32,780 --> 00:13:37,250
attacks<font color="#E5E5E5"> and to do that we look</font><font color="#CCCCCC"> back at</font>

334
00:13:35,270 --> 00:13:39,500
certificate transparency<font color="#CCCCCC"> and we scrape</font>

335
00:13:37,250 --> 00:13:41,420
the data set of 1.8 million certificates

336
00:13:39,500 --> 00:13:43,220
<font color="#E5E5E5">and for each certificate we took the</font>

337
00:13:41,420 --> 00:13:45,349
common name in<font color="#CCCCCC"> the certificate</font><font color="#E5E5E5"> and</font>

338
00:13:43,220 --> 00:13:47,750
resolved it to an IP<font color="#CCCCCC"> address</font><font color="#E5E5E5"> and then we</font>

339
00:13:45,350 --> 00:13:49,460
look back at historical routing data to

340
00:13:47,750 --> 00:13:50,960
find out information about<font color="#E5E5E5"> the routes</font>

341
00:13:49,460 --> 00:13:54,380
that<font color="#E5E5E5"> certificate authorities actually</font>

342
00:13:50,960 --> 00:13:57,650
<font color="#E5E5E5">used to validate</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> IPs</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> what we</font>

343
00:13:54,380 --> 00:14:00,650
found is that<font color="#E5E5E5"> with respect to sub prefix</font>

344
00:13:57,650 --> 00:14:03,980
attacks<font color="#E5E5E5"> if your domain</font><font color="#CCCCCC"> is running on a</font>

345
00:14:00,650 --> 00:14:05,780
<font color="#E5E5E5">slash 24 so a 24 bit prefix match you</font>

346
00:14:03,980 --> 00:14:08,480
are<font color="#CCCCCC"> in a sense immune to sub prefixed</font>

347
00:14:05,780 --> 00:14:11,180
attacks because<font color="#CCCCCC"> AAS is tend to filter</font>

348
00:14:08,480 --> 00:14:13,730
<font color="#CCCCCC">bgp announcements</font><font color="#E5E5E5"> longer than slash 24</font>

349
00:14:11,180 --> 00:14:16,640
<font color="#E5E5E5">so if the</font><font color="#CCCCCC"> adversary was</font><font color="#E5E5E5"> to announce</font><font color="#CCCCCC"> a</font>

350
00:14:13,730 --> 00:14:19,280
slash 25<font color="#E5E5E5"> it would be mostly filtered so</font>

351
00:14:16,640 --> 00:14:21,650
domains running on slash 24 can't be sub

352
00:14:19,280 --> 00:14:23,930
prefix attacked<font color="#E5E5E5"> and that is definitely a</font>

353
00:14:21,650 --> 00:14:25,579
plurality<font color="#CCCCCC"> but it turned out that</font><font color="#E5E5E5"> the</font>

354
00:14:23,930 --> 00:14:27,770
vast<font color="#E5E5E5"> majority of domains are running on</font>

355
00:14:25,580 --> 00:14:30,830
less than slash 24 making them

356
00:14:27,770 --> 00:14:32,270
vulnerable<font color="#E5E5E5"> to sub prefix attacks also we</font>

357
00:14:30,830 --> 00:14:35,360
wanted<font color="#E5E5E5"> to look at equally specific</font>

358
00:14:32,270 --> 00:14:37,819
prefix attacks so to do this<font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> as</font>

359
00:14:35,360 --> 00:14:39,440
much<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the domains but how likely is</font>

360
00:14:37,820 --> 00:14:41,540
it that<font color="#CCCCCC"> an adversary</font><font color="#E5E5E5"> can actually launch</font>

361
00:14:39,440 --> 00:14:43,250
one of<font color="#E5E5E5"> these attacks</font><font color="#CCCCCC"> so clearly in</font><font color="#E5E5E5"> this</font>

362
00:14:41,540 --> 00:14:46,099
diagram the certificate authority is

363
00:14:43,250 --> 00:14:47,660
<font color="#CCCCCC">being affected by the adversary and in</font>

364
00:14:46,100 --> 00:14:49,490
<font color="#E5E5E5">this version the certificate authority</font>

365
00:14:47,660 --> 00:14:51,260
is now in the unaffected portion so this

366
00:14:49,490 --> 00:14:54,950
<font color="#E5E5E5">adversary can't</font><font color="#CCCCCC"> actually launch</font><font color="#E5E5E5"> this</font>

367
00:14:51,260 --> 00:14:56,720
<font color="#CCCCCC">attack and resilience can</font><font color="#E5E5E5"> be thought of</font>

368
00:14:54,950 --> 00:14:58,250
as the<font color="#E5E5E5"> probability</font><font color="#CCCCCC"> that this search</font>

369
00:14:56,720 --> 00:15:00,800
figured authority will be resilient<font color="#E5E5E5"> to</font>

370
00:14:58,250 --> 00:15:03,050
<font color="#E5E5E5">an</font><font color="#CCCCCC"> adversary's</font><font color="#E5E5E5"> attack so it's sort of</font>

371
00:15:00,800 --> 00:15:05,359
the<font color="#E5E5E5"> inverse of the viability likelihood</font>

372
00:15:03,050 --> 00:15:06,949
of<font color="#E5E5E5"> the attack</font><font color="#CCCCCC"> we looked at the domains</font>

373
00:15:05,360 --> 00:15:09,379
in our data set assuming that<font color="#E5E5E5"> you chose</font>

374
00:15:06,949 --> 00:15:11,540
a random certificate authority and we

375
00:15:09,379 --> 00:15:14,540
took a CDF of<font color="#E5E5E5"> the resilience of the</font>

376
00:15:11,540 --> 00:15:16,969
domains so to get<font color="#E5E5E5"> a median or</font><font color="#CCCCCC"> a 50th</font>

377
00:15:14,540 --> 00:15:19,550
percentile cut we found the resilience

378
00:15:16,970 --> 00:15:22,220
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> 0.57 and that means still that</font>

379
00:15:19,550 --> 00:15:25,008
there's a<font color="#CCCCCC"> 43% chance that these</font><font color="#E5E5E5"> attacks</font>

380
00:15:22,220 --> 00:15:26,839
<font color="#E5E5E5">would be viable however this should be</font>

381
00:15:25,009 --> 00:15:28,490
complicated<font color="#E5E5E5"> with the fact that they're</font>

382
00:15:26,839 --> 00:15:30,709
actually<font color="#CCCCCC"> about a hundred commercial</font>

383
00:15:28,490 --> 00:15:32,870
certificate<font color="#E5E5E5"> authorities and anyone can</font>

384
00:15:30,709 --> 00:15:34,670
sign<font color="#E5E5E5"> a certificate for any</font><font color="#CCCCCC"> domain so</font>

385
00:15:32,870 --> 00:15:36,949
given<font color="#CCCCCC"> that an adversary can simply</font>

386
00:15:34,670 --> 00:15:40,550
choose a certificate authority that's in

387
00:15:36,949 --> 00:15:42,199
its<font color="#CCCCCC"> affected part of the internet</font><font color="#E5E5E5"> and to</font>

388
00:15:40,550 --> 00:15:44,089
take this<font color="#E5E5E5"> into account we developed this</font>

389
00:15:42,199 --> 00:15:46,160
notion of effective resilience<font color="#CCCCCC"> so this</font>

390
00:15:44,089 --> 00:15:48,290
is kind of what's<font color="#E5E5E5"> the resilience how</font>

391
00:15:46,160 --> 00:15:50,689
likely is<font color="#E5E5E5"> this attack gonna work given</font>

392
00:15:48,290 --> 00:15:53,629
an adversary<font color="#CCCCCC"> can now choose</font><font color="#E5E5E5"> a CA and</font>

393
00:15:50,689 --> 00:15:56,329
this caused the resilience to<font color="#CCCCCC"> drop the</font>

394
00:15:53,629 --> 00:15:59,600
median resilience to drop<font color="#E5E5E5"> from point</font><font color="#CCCCCC"> 5 7</font>

395
00:15:56,329 --> 00:16:01,399
to 0.25 so now there's a 75%<font color="#E5E5E5"> likelihood</font>

396
00:15:59,600 --> 00:16:03,610
that an adversary would be able<font color="#E5E5E5"> to</font>

397
00:16:01,399 --> 00:16:06,769
<font color="#E5E5E5">launch an equally specific prefix attack</font>

398
00:16:03,610 --> 00:16:08,870
and so clearly<font color="#CCCCCC"> the status quo</font><font color="#E5E5E5"> is really</font>

399
00:16:06,769 --> 00:16:12,379
not<font color="#E5E5E5"> that</font><font color="#CCCCCC"> good and we propose</font>

400
00:16:08,870 --> 00:16:14,600
countermeasures<font color="#CCCCCC"> so the first thing sort</font>

401
00:16:12,379 --> 00:16:15,980
of simplest<font color="#CCCCCC"> is this idea of certificate</font>

402
00:16:14,600 --> 00:16:18,110
authorities having multiple vantage

403
00:16:15,980 --> 00:16:19,939
<font color="#E5E5E5">points to protect them from</font><font color="#CCCCCC"> localized</font>

404
00:16:18,110 --> 00:16:22,399
attacks<font color="#CCCCCC"> so while this certificate</font>

405
00:16:19,939 --> 00:16:24,290
<font color="#E5E5E5">authority is</font><font color="#CCCCCC"> being affected you</font><font color="#E5E5E5"> could</font>

406
00:16:22,399 --> 00:16:25,699
imagine if the certificate<font color="#CCCCCC"> authority</font><font color="#E5E5E5"> had</font>

407
00:16:24,290 --> 00:16:27,889
a<font color="#E5E5E5"> vantage</font><font color="#CCCCCC"> point somewhat like the</font>

408
00:16:25,699 --> 00:16:29,930
perspectives work in this part<font color="#E5E5E5"> of the</font>

409
00:16:27,889 --> 00:16:31,490
<font color="#CCCCCC">internet this vantage</font><font color="#E5E5E5"> point would still</font>

410
00:16:29,930 --> 00:16:33,500
go through<font color="#E5E5E5"> to the proper server and</font>

411
00:16:31,490 --> 00:16:35,839
<font color="#E5E5E5">realize that</font><font color="#CCCCCC"> an attack is going on</font><font color="#E5E5E5"> and</font>

412
00:16:33,500 --> 00:16:37,850
by comparing the results<font color="#E5E5E5"> from these</font>

413
00:16:35,839 --> 00:16:39,889
remote vantage points<font color="#E5E5E5"> certificate</font>

414
00:16:37,850 --> 00:16:42,379
authorities can detect<font color="#CCCCCC"> localize attacks</font>

415
00:16:39,889 --> 00:16:45,199
and not sign certificates in those<font color="#E5E5E5"> cases</font>

416
00:16:42,379 --> 00:16:46,730
<font color="#E5E5E5">and let's encrypt has actually deployed</font>

417
00:16:45,199 --> 00:16:48,920
this in their staging environment our

418
00:16:46,730 --> 00:16:50,689
works<font color="#CCCCCC"> and a key factor for that</font><font color="#E5E5E5"> they're</font>

419
00:16:48,920 --> 00:16:52,459
<font color="#E5E5E5">working on a full</font><font color="#CCCCCC"> deployment and in this</font>

420
00:16:50,689 --> 00:16:54,949
<font color="#E5E5E5">slide you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see the remote vantage</font>

421
00:16:52,459 --> 00:16:56,930
points contacting the server for<font color="#CCCCCC"> the</font>

422
00:16:54,949 --> 00:17:00,170
<font color="#CCCCCC">verification document as well</font><font color="#E5E5E5"> as their</font>

423
00:16:56,930 --> 00:17:01,969
<font color="#CCCCCC">original data center and just</font><font color="#E5E5E5"> to</font>

424
00:17:00,170 --> 00:17:04,010
quantify<font color="#E5E5E5"> how much of an</font><font color="#CCCCCC"> improvement this</font>

425
00:17:01,970 --> 00:17:07,010
makes<font color="#E5E5E5"> to equally specific prefix attacks</font>

426
00:17:04,010 --> 00:17:08,209
<font color="#E5E5E5">if you take a median this is just from</font>

427
00:17:07,010 --> 00:17:10,039
<font color="#E5E5E5">let's encrypt</font><font color="#CCCCCC"> sper spective</font>

428
00:17:08,209 --> 00:17:10,650
their resilience<font color="#E5E5E5"> the resilience of</font>

429
00:17:10,039 --> 00:17:13,560
domains

430
00:17:10,650 --> 00:17:15,690
<font color="#CCCCCC">improve from</font><font color="#E5E5E5"> point 6 to point 9 5</font><font color="#CCCCCC"> with</font>

431
00:17:13,560 --> 00:17:19,290
simply a single optimally located

432
00:17:15,690 --> 00:17:21,990
<font color="#CCCCCC">advantage point to</font><font color="#E5E5E5"> help them out</font><font color="#CCCCCC"> there</font>

433
00:17:19,290 --> 00:17:23,700
also are other<font color="#CCCCCC"> defenses clearly multiple</font>

434
00:17:21,990 --> 00:17:25,620
<font color="#E5E5E5">vantage points does not help if the</font>

435
00:17:23,700 --> 00:17:28,050
attack<font color="#E5E5E5"> is global like the one I showed</font>

436
00:17:25,619 --> 00:17:29,639
<font color="#CCCCCC">in the</font><font color="#E5E5E5"> video</font><font color="#CCCCCC"> and so for that we</font>

437
00:17:28,050 --> 00:17:32,070
recommend certificate authorities also

438
00:17:29,640 --> 00:17:34,170
<font color="#E5E5E5">perform</font><font color="#CCCCCC"> BGP monitoring and we have a lot</font>

439
00:17:32,070 --> 00:17:36,780
about a<font color="#E5E5E5"> BGP monitoring</font><font color="#CCCCCC"> framework in our</font>

440
00:17:34,170 --> 00:17:38,430
paper<font color="#CCCCCC"> and then to</font><font color="#E5E5E5"> protect against the</font>

441
00:17:36,780 --> 00:17:40,290
reverse attacks I mentioned earlier

442
00:17:38,430 --> 00:17:42,390
certificate authorities have to be run

443
00:17:40,290 --> 00:17:44,340
out of secure<font color="#E5E5E5"> IP prefixes as well and</font>

444
00:17:42,390 --> 00:17:46,800
for<font color="#E5E5E5"> that we recommend running</font><font color="#CCCCCC"> out of</font><font color="#E5E5E5"> a</font>

445
00:17:44,340 --> 00:17:48,300
<font color="#E5E5E5">slash 24 prefix length and running out</font>

446
00:17:46,800 --> 00:17:51,810
of<font color="#E5E5E5"> a prefix with a relatively high</font>

447
00:17:48,300 --> 00:17:53,639
resilience to attacks<font color="#E5E5E5"> fortunately as it</font>

448
00:17:51,810 --> 00:17:55,770
<font color="#E5E5E5">recently there are ways that domains can</font>

449
00:17:53,640 --> 00:17:58,530
secure<font color="#CCCCCC"> themselves</font><font color="#E5E5E5"> this is particularly</font>

450
00:17:55,770 --> 00:18:01,920
with<font color="#E5E5E5"> CA a DNS records or certificate</font>

451
00:17:58,530 --> 00:18:03,840
authority authorization records these

452
00:18:01,920 --> 00:18:05,610
<font color="#CCCCCC">records indicate which certificate</font>

453
00:18:03,840 --> 00:18:07,620
authorities can sign certificates for

454
00:18:05,610 --> 00:18:09,540
that domain<font color="#CCCCCC"> and right there that takes</font>

455
00:18:07,620 --> 00:18:12,330
away<font color="#CCCCCC"> the choice of CA issue we talked</font>

456
00:18:09,540 --> 00:18:14,129
about<font color="#E5E5E5"> and they can also forbid signing</font>

457
00:18:12,330 --> 00:18:17,040
altogether which prevents<font color="#E5E5E5"> these attacks</font>

458
00:18:14,130 --> 00:18:19,830
<font color="#E5E5E5">but</font><font color="#CCCCCC"> the catch is that</font><font color="#E5E5E5"> if you have CA a</font>

459
00:18:17,040 --> 00:18:22,620
<font color="#E5E5E5">records you have to secure them with DNS</font>

460
00:18:19,830 --> 00:18:24,030
SEC<font color="#E5E5E5"> because otherwise the adversary will</font>

461
00:18:22,620 --> 00:18:26,219
simply choose to<font color="#E5E5E5"> target</font><font color="#CCCCCC"> your</font>

462
00:18:24,030 --> 00:18:28,379
authoritative DNS server instead of your

463
00:18:26,220 --> 00:18:30,690
domain<font color="#E5E5E5"> and if they hijack your DNS</font>

464
00:18:28,380 --> 00:18:34,200
server they can spoof<font color="#CCCCCC"> the responses for</font>

465
00:18:30,690 --> 00:18:36,600
the CIA records<font color="#CCCCCC"> and so in terms of</font>

466
00:18:34,200 --> 00:18:39,660
takeaways I just<font color="#E5E5E5"> wanted to say that this</font>

467
00:18:36,600 --> 00:18:42,270
is the<font color="#E5E5E5"> cryptocurrency website my ether</font>

468
00:18:39,660 --> 00:18:45,450
wallet my ether wallet was unfortunately

469
00:18:42,270 --> 00:18:47,490
the victim<font color="#E5E5E5"> of a BGP attacked however</font>

470
00:18:45,450 --> 00:18:49,740
users were alerted to this attack

471
00:18:47,490 --> 00:18:51,420
<font color="#E5E5E5">because when they visited my ether</font>

472
00:18:49,740 --> 00:18:54,360
wallet<font color="#E5E5E5"> they were presented with this</font>

473
00:18:51,420 --> 00:18:56,100
fake certificate and most users

474
00:18:54,360 --> 00:18:59,159
<font color="#E5E5E5">hopefully did not continue</font><font color="#CCCCCC"> on to the</font>

475
00:18:56,100 --> 00:19:02,129
site<font color="#E5E5E5"> and I just want to end by saying</font>

476
00:18:59,160 --> 00:19:04,680
<font color="#E5E5E5">that next BGP attack we see against a</font>

477
00:19:02,130 --> 00:19:06,750
cryptocurrency<font color="#E5E5E5"> website or a bank</font><font color="#CCCCCC"> that</font>

478
00:19:04,680 --> 00:19:07,980
<font color="#CCCCCC">might actually</font><font color="#E5E5E5"> be a real certificate and</font>

479
00:19:06,750 --> 00:19:11,130
we might<font color="#E5E5E5"> not</font><font color="#CCCCCC"> have that tool to</font><font color="#E5E5E5"> help</font>

480
00:19:07,980 --> 00:19:12,840
alert us to<font color="#CCCCCC"> an attack and so remember</font>

481
00:19:11,130 --> 00:19:14,760
<font color="#E5E5E5">that</font><font color="#CCCCCC"> cas are the root of trust</font><font color="#E5E5E5"> on the</font>

482
00:19:12,840 --> 00:19:16,949
<font color="#E5E5E5">internet yet the majority</font><font color="#CCCCCC"> of domains are</font>

483
00:19:14,760 --> 00:19:18,660
vulnerable<font color="#E5E5E5"> to</font><font color="#CCCCCC"> this attack so</font><font color="#E5E5E5"> i really</font>

484
00:19:16,950 --> 00:19:21,780
hope<font color="#CCCCCC"> that the CA industry will implement</font>

485
00:19:18,660 --> 00:19:23,410
countermeasures soon and secure routing

486
00:19:21,780 --> 00:19:26,289
on sort of<font color="#E5E5E5"> a second</font>

487
00:19:23,410 --> 00:19:30,190
<font color="#E5E5E5">an off topic is still important even</font>

488
00:19:26,289 --> 00:19:31,840
<font color="#CCCCCC">with</font><font color="#E5E5E5"> intend encryption so I want to say</font>

489
00:19:30,190 --> 00:19:34,020
thank<font color="#E5E5E5"> you to the audience</font><font color="#CCCCCC"> and are there</font>

490
00:19:31,840 --> 00:19:34,020
any<font color="#E5E5E5"> questions</font>

491
00:19:38,010 --> 00:19:41,129
[Music]

492
00:19:41,169 --> 00:19:46,400
hi<font color="#E5E5E5"> really great work</font>

493
00:19:43,419 --> 00:19:49,630
just one question<font color="#E5E5E5"> in terms of your list</font>

494
00:19:46,400 --> 00:19:52,220
of<font color="#E5E5E5"> countermeasures</font><font color="#CCCCCC"> did you consider</font>

495
00:19:49,630 --> 00:19:55,190
encrypted and authenticated<font color="#E5E5E5"> DNS a DNS</font>

496
00:19:52,220 --> 00:19:59,210
over TLS<font color="#E5E5E5"> as as one of the mitigations</font>

497
00:19:55,190 --> 00:20:01,880
rather than just DNS SEC absolutely<font color="#E5E5E5"> um</font>

498
00:19:59,210 --> 00:20:05,750
<font color="#E5E5E5">we are sort of we are not biased toward</font>

499
00:20:01,880 --> 00:20:07,309
any type of DNS security<font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> much one</font>

500
00:20:05,750 --> 00:20:09,380
<font color="#CCCCCC">of the main countermeasures for domains</font>

501
00:20:07,309 --> 00:20:11,870
is making sure<font color="#CCCCCC"> that your DNS is secure</font>

502
00:20:09,380 --> 00:20:16,400
sadly though<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> a certificate</font>

503
00:20:11,870 --> 00:20:17,629
authority could check DNS over TLS<font color="#E5E5E5"> but</font>

504
00:20:16,400 --> 00:20:20,210
you have to remember that this is<font color="#E5E5E5"> all</font>

505
00:20:17,630 --> 00:20:22,490
<font color="#E5E5E5">backbones so this is the authoritative</font>

506
00:20:20,210 --> 00:20:26,900
DNS servers not just the DNS clients it

507
00:20:22,490 --> 00:20:31,100
then yes<font color="#CCCCCC"> hi William</font><font color="#E5E5E5"> Simpson I'm sure</font>

508
00:20:26,900 --> 00:20:33,440
this is fine work<font color="#CCCCCC"> in some</font><font color="#E5E5E5"> way but I you</font>

509
00:20:31,100 --> 00:20:35,840
didn't get to securing routing until

510
00:20:33,440 --> 00:20:37,960
your very last bullet<font color="#E5E5E5"> point by</font><font color="#CCCCCC"> which</font>

511
00:20:35,840 --> 00:20:40,549
time I was<font color="#E5E5E5"> already walking up here and</font>

512
00:20:37,960 --> 00:20:42,169
we've already<font color="#E5E5E5"> known about this kind</font><font color="#CCCCCC"> of</font>

513
00:20:40,549 --> 00:20:47,418
problem and dealt with<font color="#E5E5E5"> it</font><font color="#CCCCCC"> for mail</font>

514
00:20:42,169 --> 00:20:49,039
servers<font color="#E5E5E5"> and DNS for 30 years because we</font>

515
00:20:47,419 --> 00:20:51,230
started the routing arbitral project

516
00:20:49,039 --> 00:20:53,049
<font color="#CCCCCC">very you know</font><font color="#E5E5E5"> when the internet was</font>

517
00:20:51,230 --> 00:20:56,990
commercialized moving it from<font color="#E5E5E5"> the NSFNET</font>

518
00:20:53,049 --> 00:20:59,809
<font color="#E5E5E5">to you know the big I</font><font color="#CCCCCC"> Internet</font>

519
00:20:56,990 --> 00:21:02,360
you didn't actually run an attendance

520
00:20:59,809 --> 00:21:06,980
system because you didn't actually<font color="#E5E5E5"> set</font>

521
00:21:02,360 --> 00:21:11,719
up your autumn's<font color="#E5E5E5"> to register your sub</font>

522
00:21:06,980 --> 00:21:14,120
prefixes with the authorities and so

523
00:21:11,720 --> 00:21:16,340
it'll only work<font color="#E5E5E5"> in a</font><font color="#CCCCCC"> testbed what would</font>

524
00:21:14,120 --> 00:21:19,309
have been more<font color="#CCCCCC"> useful from</font><font color="#E5E5E5"> my point of</font>

525
00:21:16,340 --> 00:21:22,610
view what is if you'd found that there

526
00:21:19,309 --> 00:21:24,820
were actual<font color="#CCCCCC"> guesses out there that we're</font>

527
00:21:22,610 --> 00:21:27,709
not<font color="#CCCCCC"> running the appropriate security</font><font color="#E5E5E5"> and</font>

528
00:21:24,820 --> 00:21:31,399
told us which ones they were so that we

529
00:21:27,710 --> 00:21:33,350
could deep<font color="#CCCCCC"> air with them because this</font>

530
00:21:31,400 --> 00:21:37,070
will<font color="#E5E5E5"> work in a test bed and we've known</font>

531
00:21:33,350 --> 00:21:40,340
it for<font color="#CCCCCC"> a very very</font><font color="#E5E5E5"> very long</font><font color="#CCCCCC"> time but it</font>

532
00:21:37,070 --> 00:21:43,610
shouldn't<font color="#CCCCCC"> work</font><font color="#E5E5E5"> in the actual running</font>

533
00:21:40,340 --> 00:21:46,309
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> so I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> to to begin by</font>

534
00:21:43,610 --> 00:21:49,820
<font color="#E5E5E5">answering that question</font><font color="#CCCCCC"> it shouldn't but</font>

535
00:21:46,309 --> 00:21:51,379
it should<font color="#CCCCCC"> um that it does my bed which</font>

536
00:21:49,820 --> 00:21:54,860
autonomous systems does

537
00:21:51,380 --> 00:21:55,730
this happen with<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> actual autonomous</font>

538
00:21:54,860 --> 00:21:58,100
systems<font color="#E5E5E5"> yes</font>

539
00:21:55,730 --> 00:22:00,140
<font color="#E5E5E5">event of the website that I showed</font><font color="#CCCCCC"> at</font>

540
00:21:58,100 --> 00:22:03,439
the<font color="#CCCCCC"> beginning</font><font color="#E5E5E5"> is an autonomous system</font>

541
00:22:00,140 --> 00:22:06,400
<font color="#E5E5E5">and their traffic was their DNS servers</font>

542
00:22:03,440 --> 00:22:09,020
were BGP hijacked we see BGP hijacks

543
00:22:06,400 --> 00:22:11,450
<font color="#CCCCCC">okay we did not</font><font color="#E5E5E5"> address routing security</font>

544
00:22:09,020 --> 00:22:13,940
as much in this<font color="#CCCCCC"> project</font><font color="#E5E5E5"> because we took</font>

545
00:22:11,450 --> 00:22:16,550
it in security as an assumption<font color="#CCCCCC"> moving</font>

546
00:22:13,940 --> 00:22:19,910
forward that was a bad assumption<font color="#E5E5E5"> we</font>

547
00:22:16,550 --> 00:22:21,770
<font color="#E5E5E5">spent a lot of time securing it then why</font>

548
00:22:19,910 --> 00:22:24,260
would any many years now there are bad

549
00:22:21,770 --> 00:22:25,790
at anima systems out<font color="#CCCCCC"> there but good</font>

550
00:22:24,260 --> 00:22:29,420
autonomous systems<font color="#E5E5E5"> won't accept</font><font color="#CCCCCC"> they're</font>

551
00:22:25,790 --> 00:22:31,909
<font color="#CCCCCC">not that's</font><font color="#E5E5E5"> just a lot of these hijacks</font>

552
00:22:29,420 --> 00:22:33,980
propagate<font color="#E5E5E5"> very widely and we have seen</font>

553
00:22:31,910 --> 00:22:36,170
these hijacks<font color="#E5E5E5"> as I said in recent months</font>

554
00:22:33,980 --> 00:22:38,660
we<font color="#E5E5E5"> actually saw like that my ether</font>

555
00:22:36,170 --> 00:22:41,120
wallet was a<font color="#E5E5E5"> BGP hijack that affected</font>

556
00:22:38,660 --> 00:22:44,390
Google DNS resolvers so people using

557
00:22:41,120 --> 00:22:46,939
<font color="#CCCCCC">Google eight eight eight eight</font><font color="#E5E5E5"> DNS they</font>

558
00:22:44,390 --> 00:22:49,070
hijacked Amazon's authoritative DNS

559
00:22:46,940 --> 00:22:51,170
servers and redirected them so if you

560
00:22:49,070 --> 00:22:54,470
<font color="#CCCCCC">think that Google is not</font><font color="#E5E5E5"> a secure enough</font>

561
00:22:51,170 --> 00:22:56,840
autonomous system and that you<font color="#E5E5E5"> mean an</font>

562
00:22:54,470 --> 00:22:59,890
Amazon Amazon<font color="#E5E5E5"> but who was the one who</font>

563
00:22:56,840 --> 00:23:02,480
accepted the<font color="#CCCCCC"> fake routes for Amazon okay</font>

564
00:22:59,890 --> 00:23:03,800
I'll talk<font color="#CCCCCC"> to the right people</font><font color="#E5E5E5"> at Google</font>

565
00:23:02,480 --> 00:23:06,620
<font color="#E5E5E5">I did not know</font><font color="#CCCCCC"> about that particular</font>

566
00:23:03,800 --> 00:23:08,270
<font color="#E5E5E5">attack yeah we have a group</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> talks</font>

567
00:23:06,620 --> 00:23:09,739
about<font color="#CCCCCC"> these attacks all the time yeah</font><font color="#E5E5E5"> we</font>

568
00:23:08,270 --> 00:23:11,660
might<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> take the questions</font><font color="#CCCCCC"> off</font>

569
00:23:09,740 --> 00:23:14,470
<font color="#CCCCCC">live</font><font color="#E5E5E5"> for the rest of the questions since</font>

570
00:23:11,660 --> 00:23:14,470
<font color="#CCCCCC">there we're running out of time</font>

