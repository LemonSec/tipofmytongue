1
00:00:09,890 --> 00:00:17,310
thank you for<font color="#E5E5E5"> the introduction</font><font color="#CCCCCC"> my talk</font>

2
00:00:13,590 --> 00:00:19,320
<font color="#E5E5E5">is about fancy a system for the</font>

3
00:00:17,310 --> 00:00:23,340
detection of domain generation algorithm

4
00:00:19,320 --> 00:00:28,040
a<font color="#CCCCCC"> where based on machine learning and to</font>

5
00:00:23,340 --> 00:00:31,680
get<font color="#E5E5E5"> started I first first take a look at</font>

6
00:00:28,040 --> 00:00:35,390
at traditional botnet communication and

7
00:00:31,680 --> 00:00:38,670
you have<font color="#E5E5E5"> usually two super approaches</font>

8
00:00:35,390 --> 00:00:41,250
either to use fixed IP addresses or

9
00:00:38,670 --> 00:00:43,410
<font color="#E5E5E5">fixed domain names but from Bob masters</font>

10
00:00:41,250 --> 00:00:45,840
perspective<font color="#CCCCCC"> there's a major drawback</font>

11
00:00:43,410 --> 00:00:48,419
<font color="#CCCCCC">once these values are known to a</font>

12
00:00:45,840 --> 00:00:51,930
defender it's rather easy<font color="#CCCCCC"> to block fro</font>

13
00:00:48,420 --> 00:00:53,640
<font color="#CCCCCC">defender and by this block</font><font color="#E5E5E5"> the</font>

14
00:00:51,930 --> 00:00:57,210
communication<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> body with the c2</font>

15
00:00:53,640 --> 00:00:59,730
server and that's the reason why modern

16
00:00:57,210 --> 00:01:05,880
<font color="#E5E5E5">botnets more and more often rely on</font>

17
00:00:59,730 --> 00:01:09,140
<font color="#E5E5E5">domain generation algorithms DJs and TGA</font>

18
00:01:05,880 --> 00:01:14,490
is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> pseudo-random algorithm generating</font>

19
00:01:09,140 --> 00:01:17,790
rather large sets of domains which<font color="#E5E5E5"> are</font>

20
00:01:14,490 --> 00:01:21,810
then subsequently queried by by the<font color="#E5E5E5"> bots</font>

21
00:01:17,790 --> 00:01:25,770
who eventually contact the c2 server and

22
00:01:21,810 --> 00:01:28,290
as typically the<font color="#E5E5E5"> bot master only</font>

23
00:01:25,770 --> 00:01:33,630
<font color="#E5E5E5">adjusters a small subset of the</font>

24
00:01:28,290 --> 00:01:35,909
generated domains<font color="#E5E5E5"> the major part of this</font>

25
00:01:33,630 --> 00:01:40,699
generated domains result in an X domain

26
00:01:35,909 --> 00:01:43,440
<font color="#E5E5E5">response by the DNS system</font><font color="#CCCCCC"> and that's</font>

27
00:01:40,700 --> 00:01:45,479
why it's a very<font color="#CCCCCC"> good idea to</font><font color="#E5E5E5"> take a</font>

28
00:01:43,440 --> 00:01:48,240
closer look<font color="#E5E5E5"> at the specific part of the</font>

29
00:01:45,479 --> 00:01:52,020
<font color="#E5E5E5">DNS traffic to detect domain generation</font>

30
00:01:48,240 --> 00:01:55,259
algorithm area but if you record such

31
00:01:52,020 --> 00:01:57,780
traffic<font color="#E5E5E5"> at a larger DNS server you will</font>

32
00:01:55,260 --> 00:02:00,270
not only see TGA related traffic but

33
00:01:57,780 --> 00:02:02,180
also<font color="#E5E5E5"> an extra</font><font color="#CCCCCC"> many responses caused for</font>

34
00:02:00,270 --> 00:02:07,789
example by typing<font color="#E5E5E5"> errors or</font>

35
00:02:02,180 --> 00:02:11,280
<font color="#E5E5E5">misconfigured software or DNS misuse and</font>

36
00:02:07,789 --> 00:02:14,010
that uses<font color="#E5E5E5"> our challenge here and the</font>

37
00:02:11,280 --> 00:02:17,250
challenge is<font color="#E5E5E5"> to classify these</font><font color="#CCCCCC"> non</font>

38
00:02:14,010 --> 00:02:18,959
<font color="#CCCCCC">existant domains into the nine domains</font>

39
00:02:17,250 --> 00:02:21,510
and<font color="#E5E5E5"> DJ related to main</font>

40
00:02:18,960 --> 00:02:23,430
<font color="#E5E5E5">till you see some examples how this</font>

41
00:02:21,510 --> 00:02:25,890
could<font color="#CCCCCC"> look like and if we perform</font>

42
00:02:23,430 --> 00:02:28,440
classification here<font color="#CCCCCC"> the result would</font>

43
00:02:25,890 --> 00:02:31,500
look<font color="#E5E5E5"> like look like this where the green</font>

44
00:02:28,440 --> 00:02:35,160
ones are benign domains and the red ones

45
00:02:31,500 --> 00:02:38,490
are known TGA related domains<font color="#CCCCCC"> and as you</font>

46
00:02:35,160 --> 00:02:41,010
can<font color="#E5E5E5"> see you it's not always intuitive to</font>

47
00:02:38,490 --> 00:02:43,980
determine whether a domain is<font color="#CCCCCC"> DG a</font>

48
00:02:41,010 --> 00:02:47,510
related or not<font color="#CCCCCC"> and to</font><font color="#E5E5E5"> tackle this</font>

49
00:02:43,980 --> 00:02:50,280
<font color="#CCCCCC">problem we</font><font color="#E5E5E5"> present our system fancy</font>

50
00:02:47,510 --> 00:02:53,609
feature based automated and X domain

51
00:02:50,280 --> 00:02:55,560
classification intelligence<font color="#E5E5E5"> and fancy is</font>

52
00:02:53,610 --> 00:02:58,320
<font color="#CCCCCC">the system performing machine learning</font>

53
00:02:55,560 --> 00:03:00,390
<font color="#E5E5E5">based classification of NXT so</font><font color="#CCCCCC"> 2p9 a</font><font color="#E5E5E5"> DG</font>

54
00:02:58,320 --> 00:03:02,280
<font color="#E5E5E5">a related fancy performs this</font>

55
00:03:00,390 --> 00:03:06,029
classification with very high accuracy

56
00:03:02,280 --> 00:03:07,830
<font color="#E5E5E5">is lightweight</font><font color="#CCCCCC"> and efficient and the</font>

57
00:03:06,030 --> 00:03:09,840
<font color="#E5E5E5">classification itself is performed on</font>

58
00:03:07,830 --> 00:03:11,640
domain names<font color="#E5E5E5"> only that means no media</font>

59
00:03:09,840 --> 00:03:14,270
data is<font color="#E5E5E5"> required for the</font><font color="#CCCCCC"> classification</font>

60
00:03:11,640 --> 00:03:16,470
itself<font color="#E5E5E5"> and fancies furthermore</font>

61
00:03:14,270 --> 00:03:19,050
generalizable<font color="#E5E5E5"> and therefore</font><font color="#CCCCCC"> usable as a</font>

62
00:03:16,470 --> 00:03:21,900
service with the help of fancy we are

63
00:03:19,050 --> 00:03:27,380
<font color="#CCCCCC">able to</font><font color="#E5E5E5"> find</font><font color="#CCCCCC"> EGA</font><font color="#E5E5E5"> based</font><font color="#CCCCCC"> Marian factor</font>

64
00:03:21,900 --> 00:03:27,380
<font color="#E5E5E5">devices and deliver actionable IRCs</font>

65
00:03:27,890 --> 00:03:33,238
next<font color="#CCCCCC"> I give you a short overview about</font>

66
00:03:31,140 --> 00:03:36,570
<font color="#CCCCCC">the system fancy itself starting with</font>

67
00:03:33,239 --> 00:03:38,610
the architecture and fancy<font color="#CCCCCC"> consoles many</font>

68
00:03:36,570 --> 00:03:40,560
of<font color="#E5E5E5"> three modules the training module the</font>

69
00:03:38,610 --> 00:03:44,220
classification module and<font color="#E5E5E5"> intelligence</font>

70
00:03:40,560 --> 00:03:46,530
module and the<font color="#E5E5E5"> training module takes</font>

71
00:03:44,220 --> 00:03:48,630
label<font color="#E5E5E5"> data as input performs the</font>

72
00:03:46,530 --> 00:03:50,850
training machine supervised machine

73
00:03:48,630 --> 00:03:52,170
learning classifier<font color="#E5E5E5"> outputs a model</font>

74
00:03:50,850 --> 00:03:54,150
which<font color="#E5E5E5"> is then</font><font color="#CCCCCC"> used by the</font><font color="#E5E5E5"> classification</font>

75
00:03:52,170 --> 00:03:57,179
module to perform the actual

76
00:03:54,150 --> 00:04:00,450
classification<font color="#CCCCCC"> of previously unlabeled</font>

77
00:03:57,180 --> 00:04:03,630
<font color="#E5E5E5">and</font><font color="#CCCCCC"> XD's the intelligence</font><font color="#E5E5E5"> module can</font><font color="#CCCCCC"> be</font>

78
00:04:00,450 --> 00:04:06,690
<font color="#CCCCCC">used to to process</font><font color="#E5E5E5"> full and X domain</font>

79
00:04:03,630 --> 00:04:09,900
responses that means<font color="#CCCCCC"> fold</font><font color="#E5E5E5"> in s packets</font>

80
00:04:06,690 --> 00:04:11,250
and not not<font color="#E5E5E5"> only domain names and the</font>

81
00:04:09,900 --> 00:04:13,830
intelligence module performs a

82
00:04:11,250 --> 00:04:17,790
pre-processing<font color="#E5E5E5"> uses the classification</font>

83
00:04:13,830 --> 00:04:21,900
module to store to assign the label to

84
00:04:17,790 --> 00:04:25,080
<font color="#E5E5E5">an</font><font color="#CCCCCC"> XD and then stores the</font><font color="#E5E5E5"> results in a</font>

85
00:04:21,899 --> 00:04:29,120
<font color="#E5E5E5">database</font><font color="#CCCCCC"> and provides</font><font color="#E5E5E5"> IOC s or process</font>

86
00:04:25,080 --> 00:04:29,120
result views for security analysts

87
00:04:29,900 --> 00:04:34,219
next we take<font color="#CCCCCC"> a closer look</font><font color="#E5E5E5"> at the</font>

88
00:04:32,180 --> 00:04:38,689
classification parts<font color="#E5E5E5"> of fence itself</font>

89
00:04:34,219 --> 00:04:40,729
<font color="#CCCCCC">offense users and</font><font color="#E5E5E5"> we use a supervised</font>

90
00:04:38,689 --> 00:04:43,219
<font color="#CCCCCC">learning classifying approach that means</font>

91
00:04:40,729 --> 00:04:45,110
<font color="#CCCCCC">require a label data as</font><font color="#E5E5E5"> input for</font>

92
00:04:43,219 --> 00:04:47,659
training in our case label domain names

93
00:04:45,110 --> 00:04:50,659
<font color="#CCCCCC">so DJ related to the domain names and</font>

94
00:04:47,659 --> 00:04:53,389
<font color="#CCCCCC">nine and X domains we perform a future</font>

95
00:04:50,659 --> 00:04:57,259
extraction and<font color="#E5E5E5"> then perform the training</font>

96
00:04:53,389 --> 00:04:59,569
when with with the output output<font color="#CCCCCC"> model</font>

97
00:04:57,259 --> 00:05:02,659
we are<font color="#E5E5E5"> then able to predict unknown</font>

98
00:04:59,569 --> 00:05:07,810
domains<font color="#E5E5E5"> and assign a</font><font color="#CCCCCC"> label to them</font><font color="#E5E5E5"> so</font>

99
00:05:02,659 --> 00:05:11,029
whether they are<font color="#CCCCCC"> DJ related or not and</font>

100
00:05:07,810 --> 00:05:14,210
next<font color="#CCCCCC"> I give a short</font><font color="#E5E5E5"> overview about the</font>

101
00:05:11,029 --> 00:05:18,439
features<font color="#CCCCCC"> we used within fancy here</font><font color="#E5E5E5"> I</font>

102
00:05:14,210 --> 00:05:21,229
present<font color="#E5E5E5"> three examples in general</font><font color="#CCCCCC"> a</font>

103
00:05:18,439 --> 00:05:23,300
feature is simply<font color="#CCCCCC"> a mathematical</font>

104
00:05:21,229 --> 00:05:25,550
function taking<font color="#E5E5E5"> an input value in our</font>

105
00:05:23,300 --> 00:05:28,759
case<font color="#E5E5E5"> that's only a domain</font><font color="#CCCCCC"> name and</font><font color="#E5E5E5"> then</font>

106
00:05:25,550 --> 00:05:33,259
outputting a numeric value<font color="#CCCCCC"> and fancy</font>

107
00:05:28,759 --> 00:05:35,930
uses<font color="#CCCCCC"> 21 features of all where</font><font color="#E5E5E5"> you can</font>

108
00:05:33,259 --> 00:05:37,759
distinguish three categories here the

109
00:05:35,930 --> 00:05:40,460
<font color="#CCCCCC">structure</font><font color="#E5E5E5"> category where</font><font color="#CCCCCC"> friends use</font>

110
00:05:37,759 --> 00:05:42,740
<font color="#CCCCCC">twelve features</font><font color="#E5E5E5"> seven linguistic</font>

111
00:05:40,460 --> 00:05:45,710
features and two statistical<font color="#CCCCCC"> features</font>

112
00:05:42,740 --> 00:05:47,300
and if we take a look<font color="#E5E5E5"> at the examples</font>

113
00:05:45,710 --> 00:05:49,219
here for<font color="#CCCCCC"> example the very top level</font>

114
00:05:47,300 --> 00:05:51,169
domain feature is an<font color="#E5E5E5"> example for a</font>

115
00:05:49,219 --> 00:05:53,870
<font color="#CCCCCC">structural category the alphabet</font>

116
00:05:51,169 --> 00:05:56,210
<font color="#CCCCCC">Caramella T is a example for a</font>

117
00:05:53,870 --> 00:05:58,969
linguistic feature and outputs an

118
00:05:56,210 --> 00:06:00,770
integer<font color="#E5E5E5"> and the entropy according to</font>

119
00:05:58,969 --> 00:06:04,449
Shannon is an example<font color="#E5E5E5"> for statistical</font>

120
00:06:00,770 --> 00:06:08,000
feature and outputs a rational value and

121
00:06:04,449 --> 00:06:10,580
now that we have<font color="#E5E5E5"> seen what fancy</font><font color="#CCCCCC"> once</font>

122
00:06:08,000 --> 00:06:12,889
<font color="#CCCCCC">wants</font><font color="#E5E5E5"> to achieve namely performing</font>

123
00:06:10,580 --> 00:06:18,128
classification of<font color="#E5E5E5"> an</font><font color="#CCCCCC"> X domains</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> DGA</font>

124
00:06:12,889 --> 00:06:21,770
related and benign<font color="#CCCCCC"> I present</font><font color="#E5E5E5"> to you our</font>

125
00:06:18,129 --> 00:06:25,550
evaluation and including a<font color="#E5E5E5"> real-world</font>

126
00:06:21,770 --> 00:06:28,250
<font color="#CCCCCC">application test first</font><font color="#E5E5E5"> I present our</font>

127
00:06:25,550 --> 00:06:31,400
<font color="#CCCCCC">data</font><font color="#E5E5E5"> sets for</font><font color="#CCCCCC"> for we used for laboratory</font>

128
00:06:28,250 --> 00:06:32,599
experiments<font color="#E5E5E5"> and as require label data</font>

129
00:06:31,400 --> 00:06:35,599
and we

130
00:06:32,599 --> 00:06:38,270
heavier we see here free data sources

131
00:06:35,599 --> 00:06:42,319
the first one is from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> central DNS of</font>

132
00:06:38,270 --> 00:06:45,589
of<font color="#CCCCCC"> university</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> art and here we were</font>

133
00:06:42,319 --> 00:06:49,999
able<font color="#E5E5E5"> to record 31 days of DNS X 2 matrix</font>

134
00:06:45,589 --> 00:06:52,639
<font color="#E5E5E5">and obtained 30 35 million unique benign</font>

135
00:06:49,999 --> 00:06:54,949
and<font color="#CCCCCC"> ex domains</font><font color="#E5E5E5"> our second data source</font>

136
00:06:52,639 --> 00:06:57,979
<font color="#E5E5E5">was the central DNS infrastructure of</font>

137
00:06:54,949 --> 00:07:00,349
Siemens AG and here we record at 61 days

138
00:06:57,979 --> 00:07:07,128
and<font color="#E5E5E5"> obtained 31 million unique benign</font>

139
00:07:00,349 --> 00:07:10,099
and<font color="#CCCCCC"> ex domains</font><font color="#E5E5E5"> and for our TGA related</font>

140
00:07:07,129 --> 00:07:12,499
to main data<font color="#CCCCCC"> source we had access to DG</font>

141
00:07:10,099 --> 00:07:15,259
<font color="#CCCCCC">a archive which is a database meant by</font>

142
00:07:12,499 --> 00:07:19,520
maintained by<font color="#E5E5E5"> a phone</font><font color="#CCCCCC"> offer</font><font color="#E5E5E5"> from Germany</font>

143
00:07:15,259 --> 00:07:24,519
<font color="#E5E5E5">and this database contains about 50</font>

144
00:07:19,520 --> 00:07:29,959
million unique<font color="#E5E5E5"> DG a domains of</font><font color="#CCCCCC"> 1344 days</font>

145
00:07:24,519 --> 00:07:34,279
of more than 70 different DJs and based

146
00:07:29,959 --> 00:07:36,769
based on<font color="#E5E5E5"> these data data sources we</font>

147
00:07:34,279 --> 00:07:39,229
performed<font color="#E5E5E5"> an</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> step of our</font>

148
00:07:36,769 --> 00:07:42,349
evaluation search<font color="#E5E5E5"> for the best</font>

149
00:07:39,229 --> 00:07:44,719
classifier for fancy and for this reason

150
00:07:42,349 --> 00:07:47,680
we compared support vector machines<font color="#E5E5E5"> and</font>

151
00:07:44,719 --> 00:07:50,509
random forests in mainly two different

152
00:07:47,680 --> 00:07:53,659
<font color="#E5E5E5">categories of scenarios the first</font>

153
00:07:50,509 --> 00:07:57,589
scenario assumes that we use<font color="#E5E5E5"> one</font>

154
00:07:53,659 --> 00:07:59,419
classifier per known<font color="#CCCCCC"> DJ and that</font><font color="#E5E5E5"> could</font>

155
00:07:57,589 --> 00:08:02,719
for example<font color="#E5E5E5"> look like this we use for</font>

156
00:07:59,419 --> 00:08:04,669
<font color="#E5E5E5">training domains from DG</font><font color="#CCCCCC"> a1 and compiled</font>

157
00:08:02,719 --> 00:08:05,808
with benign<font color="#E5E5E5"> and</font><font color="#CCCCCC"> X DS</font><font color="#E5E5E5"> from the University</font>

158
00:08:04,669 --> 00:08:09,469
<font color="#E5E5E5">Network</font><font color="#CCCCCC"> and then perform</font><font color="#E5E5E5"> the</font>

159
00:08:05,809 --> 00:08:10,879
classification on<font color="#E5E5E5"> DJ 1 + B 9 and X DS</font>

160
00:08:09,469 --> 00:08:15,019
from the<font color="#E5E5E5"> University Network</font>

161
00:08:10,879 --> 00:08:17,569
the second scenario assumes that we use

162
00:08:15,019 --> 00:08:21,279
one thing<font color="#E5E5E5"> a classifier trained with</font>

163
00:08:17,569 --> 00:08:23,839
domains of multiple different DJs<font color="#E5E5E5"> and</font>

164
00:08:21,279 --> 00:08:27,229
that's<font color="#CCCCCC"> called for example look like this</font>

165
00:08:23,839 --> 00:08:31,819
we<font color="#E5E5E5"> train our classifier using domains</font>

166
00:08:27,229 --> 00:08:33,409
from<font color="#CCCCCC"> DJ 1 to n combined with v9 annexes</font>

167
00:08:31,819 --> 00:08:35,659
from the<font color="#CCCCCC"> University</font><font color="#E5E5E5"> Network</font><font color="#CCCCCC"> and then</font>

168
00:08:33,409 --> 00:08:38,838
perform classification on different

169
00:08:35,659 --> 00:08:42,289
<font color="#E5E5E5">domains of</font><font color="#CCCCCC"> the same DJ s and P 9 and X</font>

170
00:08:38,839 --> 00:08:44,660
<font color="#CCCCCC">DS</font><font color="#E5E5E5"> from the University</font><font color="#CCCCCC"> Network and the</font>

171
00:08:42,289 --> 00:08:45,319
result of the search for<font color="#CCCCCC"> the best</font>

172
00:08:44,660 --> 00:08:48,350
<font color="#CCCCCC">classified</font>

173
00:08:45,320 --> 00:08:50,779
was that the best performing classifiers

174
00:08:48,350 --> 00:08:55,279
<font color="#E5E5E5">singer</font><font color="#CCCCCC"> ran a forest classifier trained</font>

175
00:08:50,779 --> 00:08:57,620
with all known<font color="#CCCCCC"> DJs</font><font color="#E5E5E5"> and to get an idea</font><font color="#CCCCCC"> of</font>

176
00:08:55,279 --> 00:08:59,170
how well<font color="#E5E5E5"> this classifier performs</font><font color="#CCCCCC"> I</font>

177
00:08:57,620 --> 00:09:02,860
present in the following three

178
00:08:59,170 --> 00:09:02,860
experiments<font color="#E5E5E5"> from our laboratory</font>

179
00:09:03,100 --> 00:09:10,670
evaluation<font color="#CCCCCC"> and the first experiment</font><font color="#E5E5E5"> had</font>

180
00:09:07,430 --> 00:09:14,810
to go to test fancies capabilities<font color="#E5E5E5"> and</font>

181
00:09:10,670 --> 00:09:17,240
detecting domains of known<font color="#E5E5E5"> DJ's for this</font>

182
00:09:14,810 --> 00:09:21,859
we performed<font color="#E5E5E5"> five fold cross validation</font>

183
00:09:17,240 --> 00:09:23,810
<font color="#CCCCCC">Zhan</font><font color="#E5E5E5"> 20 data sets of size 100,000 and</font>

184
00:09:21,860 --> 00:09:26,870
<font color="#E5E5E5">performed</font><font color="#CCCCCC"> five repetitions with fresh</font>

185
00:09:23,810 --> 00:09:30,410
phones<font color="#E5E5E5"> which results in</font><font color="#CCCCCC"> 500 passes</font>

186
00:09:26,870 --> 00:09:33,470
<font color="#CCCCCC">overall and for this test we performed</font>

187
00:09:30,410 --> 00:09:35,949
training and testing using you know

188
00:09:33,470 --> 00:09:40,069
<font color="#CCCCCC">nn-xt s from the University Network</font><font color="#E5E5E5"> and</font>

189
00:09:35,949 --> 00:09:42,469
domains from<font color="#CCCCCC"> TGA 1 to</font><font color="#E5E5E5"> n overall 59</font>

190
00:09:40,069 --> 00:09:44,689
<font color="#E5E5E5">different</font><font color="#CCCCCC"> TGS and</font><font color="#E5E5E5"> the table below shows</font>

191
00:09:42,470 --> 00:09:47,569
a statistical summary of our

192
00:09:44,690 --> 00:09:49,279
classification and performance including

193
00:09:47,569 --> 00:09:53,599
the ik you see the true positive rate

194
00:09:49,279 --> 00:09:57,350
and the false positive rate<font color="#E5E5E5"> and you can</font>

195
00:09:53,600 --> 00:10:00,589
see here<font color="#CCCCCC"> that QC is beyond</font><font color="#E5E5E5"> 99% the</font><font color="#CCCCCC"> true</font>

196
00:09:57,350 --> 00:10:04,010
positive rate is also beyond<font color="#CCCCCC"> 99 percent</font>

197
00:10:00,589 --> 00:10:06,529
<font color="#E5E5E5">at a very low false positive</font><font color="#CCCCCC"> rate which</font>

198
00:10:04,010 --> 00:10:10,310
allows us to<font color="#E5E5E5"> conclude that fancy is able</font>

199
00:10:06,529 --> 00:10:14,600
to detect<font color="#CCCCCC"> known TG domains of known DJs</font>

200
00:10:10,310 --> 00:10:17,119
with<font color="#CCCCCC"> very high accuracy the second</font>

201
00:10:14,600 --> 00:10:20,089
<font color="#E5E5E5">experiment had to go to test fancies</font>

202
00:10:17,120 --> 00:10:23,149
capabilities<font color="#CCCCCC"> in detecting domains of</font>

203
00:10:20,089 --> 00:10:25,490
previously<font color="#E5E5E5"> unknown</font><font color="#CCCCCC"> DJs</font><font color="#E5E5E5"> and for this we</font>

204
00:10:23,149 --> 00:10:28,459
again<font color="#E5E5E5"> used 20</font><font color="#CCCCCC"> datasets</font><font color="#E5E5E5"> 20 fresh data</font>

205
00:10:25,490 --> 00:10:32,329
<font color="#E5E5E5">sets of size 100 thousand for performed</font>

206
00:10:28,459 --> 00:10:33,170
a<font color="#CCCCCC"> leave one out evaluation for 59</font>

207
00:10:32,329 --> 00:10:36,050
<font color="#CCCCCC">different DJs</font>

208
00:10:33,170 --> 00:10:40,579
which results for<font color="#E5E5E5"> each of the 20</font>

209
00:10:36,050 --> 00:10:43,939
<font color="#CCCCCC">datasets</font><font color="#E5E5E5"> which results in 1180 passes of</font>

210
00:10:40,579 --> 00:10:45,849
all and this code for example<font color="#CCCCCC"> look like</font>

211
00:10:43,939 --> 00:10:49,759
this in a single<font color="#E5E5E5"> pass that we</font><font color="#CCCCCC"> trained</font>

212
00:10:45,850 --> 00:10:51,680
our classifier using domains of<font color="#E5E5E5"> DG a 2</font>

213
00:10:49,759 --> 00:10:53,240
to<font color="#E5E5E5"> N and B 9 and X</font><font color="#CCCCCC"> T's from</font><font color="#E5E5E5"> the</font>

214
00:10:51,680 --> 00:10:56,810
<font color="#CCCCCC">University Network and then try to</font>

215
00:10:53,240 --> 00:10:58,990
predict<font color="#E5E5E5"> a data set consisting of domains</font>

216
00:10:56,810 --> 00:11:01,029
of DJ<font color="#E5E5E5"> 1 and</font>

217
00:10:58,990 --> 00:11:03,550
next is of the<font color="#CCCCCC"> university network</font><font color="#E5E5E5"> the</font>

218
00:11:01,029 --> 00:11:07,060
table<font color="#E5E5E5"> below again shows a statistical</font>

219
00:11:03,550 --> 00:11:08,890
summary of the results<font color="#CCCCCC"> and it's</font>

220
00:11:07,060 --> 00:11:11,290
important to note here that<font color="#CCCCCC"> accuse is</font>

221
00:11:08,890 --> 00:11:15,550
slightly slightly<font color="#E5E5E5"> lower than an</font>

222
00:11:11,290 --> 00:11:17,529
experiment<font color="#E5E5E5"> before but only because the</font>

223
00:11:15,550 --> 00:11:22,149
true positive rate is a slightly lower

224
00:11:17,529 --> 00:11:24,459
the false positive rate is almost the

225
00:11:22,149 --> 00:11:28,300
same in this experiment<font color="#CCCCCC"> which means that</font>

226
00:11:24,459 --> 00:11:30,310
in worst case we may miss some unknown

227
00:11:28,300 --> 00:11:36,060
domains but we do<font color="#CCCCCC"> not increase our false</font>

228
00:11:30,310 --> 00:11:39,250
positive<font color="#CCCCCC"> a number</font><font color="#E5E5E5"> of false positives the</font>

229
00:11:36,060 --> 00:11:42,880
third experiment<font color="#E5E5E5"> I present us to test</font>

230
00:11:39,250 --> 00:11:45,990
how well fancy generalizes that means we

231
00:11:42,880 --> 00:11:49,180
<font color="#CCCCCC">wanted to test if it is possible to</font>

232
00:11:45,990 --> 00:11:51,790
perform<font color="#E5E5E5"> the training in network one and</font>

233
00:11:49,180 --> 00:11:55,089
then deploy<font color="#E5E5E5"> a fancy in a second unknown</font>

234
00:11:51,790 --> 00:11:57,939
<font color="#CCCCCC">Network and for this we again</font><font color="#E5E5E5"> use 20</font>

235
00:11:55,089 --> 00:12:00,160
<font color="#E5E5E5">data sets of size</font><font color="#CCCCCC"> 100,000 in this in</font>

236
00:11:57,940 --> 00:12:03,430
<font color="#E5E5E5">this case per benign data source and</font>

237
00:12:00,160 --> 00:12:07,569
perform the<font color="#CCCCCC"> cross-validation</font><font color="#E5E5E5"> resulting</font>

238
00:12:03,430 --> 00:12:09,550
in<font color="#E5E5E5"> 400 passes</font><font color="#CCCCCC"> overall and this code for</font>

239
00:12:07,570 --> 00:12:13,540
example<font color="#CCCCCC"> looked like this that we perform</font>

240
00:12:09,550 --> 00:12:15,609
training using domains form of<font color="#E5E5E5"> dj1</font><font color="#CCCCCC"> 2n +</font>

241
00:12:13,540 --> 00:12:19,660
<font color="#CCCCCC">b9 and exist from</font><font color="#E5E5E5"> the University Network</font>

242
00:12:15,610 --> 00:12:22,240
<font color="#E5E5E5">and then performed the testing on</font><font color="#CCCCCC"> DJ</font>

243
00:12:19,660 --> 00:12:26,920
<font color="#E5E5E5">want to end but with denied benign</font>

244
00:12:22,240 --> 00:12:28,930
domains<font color="#CCCCCC"> from the company</font><font color="#E5E5E5"> network and on</font>

245
00:12:26,920 --> 00:12:32,290
the right hand<font color="#CCCCCC"> side the same experiment</font>

246
00:12:28,930 --> 00:12:34,029
<font color="#CCCCCC">vice versa</font><font color="#E5E5E5"> and the tables below again</font>

247
00:12:32,290 --> 00:12:37,599
shows statistical summaries of<font color="#E5E5E5"> the</font>

248
00:12:34,029 --> 00:12:39,939
classification results<font color="#CCCCCC"> and as you can</font>

249
00:12:37,600 --> 00:12:44,890
<font color="#CCCCCC">see here the</font><font color="#E5E5E5"> accuracy and true positive</font>

250
00:12:39,940 --> 00:12:46,810
rate<font color="#CCCCCC"> are comparable</font><font color="#E5E5E5"> to the experiment to</font>

251
00:12:44,890 --> 00:12:50,829
the<font color="#E5E5E5"> first experiment where we trained</font>

252
00:12:46,810 --> 00:12:51,779
and tested<font color="#E5E5E5"> with benign data from the</font>

253
00:12:50,829 --> 00:12:54,399
same network

254
00:12:51,779 --> 00:12:58,000
<font color="#E5E5E5">only the false positive</font><font color="#CCCCCC"> rate slightly</font>

255
00:12:54,399 --> 00:13:01,959
increases<font color="#E5E5E5"> but is still very</font><font color="#CCCCCC"> small and so</font>

256
00:12:58,000 --> 00:13:06,250
we are able<font color="#CCCCCC"> to state that fancy can can</font>

257
00:13:01,959 --> 00:13:09,699
<font color="#E5E5E5">be used within a new network in which is</font>

258
00:13:06,250 --> 00:13:14,600
one was not trained<font color="#E5E5E5"> on and</font>

259
00:13:09,700 --> 00:13:17,360
yes exactly<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the last the</font><font color="#CCCCCC"> last part</font>

260
00:13:14,600 --> 00:13:20,300
<font color="#E5E5E5">of our evaluation is a</font><font color="#CCCCCC"> rivet application</font>

261
00:13:17,360 --> 00:13:22,460
test and for<font color="#E5E5E5"> this we</font><font color="#CCCCCC"> obtain the fresh</font>

262
00:13:20,300 --> 00:13:25,490
data set from the<font color="#CCCCCC"> University Network of</font>

263
00:13:22,460 --> 00:13:29,000
an X domain responses we record at<font color="#E5E5E5"> 31</font>

264
00:13:25,490 --> 00:13:31,670
days again<font color="#CCCCCC"> and obtained 35 million</font>

265
00:13:29,000 --> 00:13:34,220
unique and<font color="#CCCCCC"> X domains</font><font color="#E5E5E5"> and performed all</font>

266
00:13:31,670 --> 00:13:37,430
tests on<font color="#CCCCCC"> single threaded</font><font color="#E5E5E5"> on consumer</font>

267
00:13:34,220 --> 00:13:39,050
hardware and for our<font color="#CCCCCC"> real-world</font>

268
00:13:37,430 --> 00:13:41,540
application<font color="#CCCCCC"> tests we train the fresh</font>

269
00:13:39,050 --> 00:13:44,780
random forest classifier using a set

270
00:13:41,540 --> 00:13:48,650
size of<font color="#E5E5E5"> 100,000 and then use this</font>

271
00:13:44,780 --> 00:13:51,140
classifier to<font color="#E5E5E5"> predict all 700 million in</font>

272
00:13:48,650 --> 00:13:56,209
X domain responses we record it which is

273
00:13:51,140 --> 00:13:59,750
equivalent<font color="#E5E5E5"> to on average 100 664 and X</font>

274
00:13:56,210 --> 00:14:01,520
domain responses per second<font color="#E5E5E5"> and due</font><font color="#CCCCCC"> to</font>

275
00:13:59,750 --> 00:14:04,970
<font color="#E5E5E5">our performance measurements Fancy's</font>

276
00:14:01,520 --> 00:14:07,250
<font color="#E5E5E5">able to perform for hundreds samples to</font>

277
00:14:04,970 --> 00:14:07,760
perform prediction for<font color="#E5E5E5"> 400 samples per</font>

278
00:14:07,250 --> 00:14:09,800
second

279
00:14:07,760 --> 00:14:13,400
which allows us to<font color="#E5E5E5"> conclude that fancy</font>

280
00:14:09,800 --> 00:14:17,469
is in terms of performance<font color="#E5E5E5"> we would</font>

281
00:14:13,400 --> 00:14:20,390
<font color="#E5E5E5">applicable the main result of our</font>

282
00:14:17,470 --> 00:14:23,900
<font color="#CCCCCC">real-world</font><font color="#E5E5E5"> application test is that</font><font color="#CCCCCC"> we</font>

283
00:14:20,390 --> 00:14:27,319
are<font color="#E5E5E5"> able to report 10 groups of unknown</font>

284
00:14:23,900 --> 00:14:33,949
DJ related domains<font color="#E5E5E5"> overall there we</font>

285
00:14:27,320 --> 00:14:36,890
found 405 unknown DJ domains and here

286
00:14:33,950 --> 00:14:40,100
you<font color="#E5E5E5"> can see</font><font color="#CCCCCC"> 6 6 examples</font>

287
00:14:36,890 --> 00:14:43,970
<font color="#CCCCCC">6 example groups where the</font><font color="#E5E5E5"> upper</font><font color="#CCCCCC"> free</font>

288
00:14:40,100 --> 00:14:46,990
groups probably completely<font color="#E5E5E5"> unknown</font><font color="#CCCCCC"> DJs</font>

289
00:14:43,970 --> 00:14:52,160
and<font color="#CCCCCC"> the lower three groups probably</font>

290
00:14:46,990 --> 00:14:56,450
<font color="#E5E5E5">variants of known DJ's or unknown seeds</font>

291
00:14:52,160 --> 00:14:58,459
of non TGS<font color="#E5E5E5"> and the attribution in this</font>

292
00:14:56,450 --> 00:15:01,520
case was performed using<font color="#E5E5E5"> our domain</font>

293
00:14:58,460 --> 00:15:03,589
knowledge and the DJ<font color="#CCCCCC"> archive</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> we</font>

294
00:15:01,520 --> 00:15:07,400
had no ground truth in<font color="#E5E5E5"> this experiment</font>

295
00:15:03,589 --> 00:15:11,630
of course<font color="#E5E5E5"> and it's noteworthy to say</font>

296
00:15:07,400 --> 00:15:14,420
here that the<font color="#E5E5E5"> diversity is very high if</font>

297
00:15:11,630 --> 00:15:18,020
you for<font color="#CCCCCC"> example take a</font><font color="#E5E5E5"> look at DJ</font>

298
00:15:14,420 --> 00:15:20,030
<font color="#CCCCCC">1 2 & 4</font><font color="#E5E5E5"> which look almost completely</font>

299
00:15:18,020 --> 00:15:22,279
random<font color="#E5E5E5"> and compare</font><font color="#CCCCCC"> us for example</font><font color="#E5E5E5"> to</font>

300
00:15:20,030 --> 00:15:25,100
<font color="#CCCCCC">TGIF</font><font color="#E5E5E5"> 3 which look</font>

301
00:15:22,279 --> 00:15:28,699
more like hexadecimal string<font color="#E5E5E5"> with a</font>

302
00:15:25,100 --> 00:15:33,560
<font color="#E5E5E5">fixed prefix</font><font color="#CCCCCC"> you can see that fancy is</font>

303
00:15:28,699 --> 00:15:37,339
able to to detect<font color="#CCCCCC"> DJ domains independent</font>

304
00:15:33,560 --> 00:15:39,949
of the generation scheme and the<font color="#CCCCCC"> DJ five</font>

305
00:15:37,339 --> 00:15:47,899
<font color="#CCCCCC">and six group are generated using</font>

306
00:15:39,949 --> 00:15:51,199
<font color="#E5E5E5">dictionaries</font><font color="#CCCCCC"> and summary</font><font color="#E5E5E5"> fancy is a</font>

307
00:15:47,899 --> 00:15:55,540
system classifying<font color="#E5E5E5"> annex</font><font color="#CCCCCC"> DS</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> b9</font><font color="#E5E5E5"> and</font>

308
00:15:51,199 --> 00:15:57,378
<font color="#CCCCCC">DG a related it's the it's</font>

309
00:15:55,540 --> 00:15:59,629
<font color="#E5E5E5">classification is based on the main</font>

310
00:15:57,379 --> 00:16:02,180
names only it performs lightweight

311
00:15:59,629 --> 00:16:05,149
efficient and high accurate

312
00:16:02,180 --> 00:16:09,229
classification<font color="#CCCCCC"> fancies robot applicable</font>

313
00:16:05,149 --> 00:16:12,589
<font color="#E5E5E5">and we were able to report n groups of</font>

314
00:16:09,230 --> 00:16:14,449
unknown<font color="#E5E5E5"> DG a domains and fancy</font>

315
00:16:12,589 --> 00:16:18,589
<font color="#CCCCCC">generalize very</font><font color="#E5E5E5"> well and is therefore</font>

316
00:16:14,449 --> 00:16:31,939
<font color="#E5E5E5">usable as a</font><font color="#CCCCCC"> service thank you are there</font>

317
00:16:18,589 --> 00:16:34,040
<font color="#CCCCCC">any</font><font color="#E5E5E5"> questions any question</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> let me</font>

318
00:16:31,939 --> 00:16:37,519
<font color="#E5E5E5">start with a question</font><font color="#CCCCCC"> quite</font><font color="#E5E5E5"> similar</font><font color="#CCCCCC"> to</font>

319
00:16:34,040 --> 00:16:39,920
the previous one<font color="#CCCCCC"> so I also truly believe</font>

320
00:16:37,519 --> 00:16:43,610
that<font color="#E5E5E5"> your approach can identify new real</font>

321
00:16:39,920 --> 00:16:45,860
world of say Tian Tian Jia region in

322
00:16:43,610 --> 00:16:47,990
general<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you also found demonstrate</font>

323
00:16:45,860 --> 00:16:50,120
this you<font color="#E5E5E5"> really work but do you have any</font>

324
00:16:47,990 --> 00:16:52,309
concern about using<font color="#CCCCCC"> more machine</font>

325
00:16:50,120 --> 00:16:54,709
learning<font color="#E5E5E5"> in your approach for example</font>

326
00:16:52,309 --> 00:16:57,469
what if what if<font color="#CCCCCC"> you're the attacker can</font>

327
00:16:54,709 --> 00:16:59,268
you come up with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> the best domain</font>

328
00:16:57,470 --> 00:17:03,199
generation algorithm<font color="#E5E5E5"> to bypass your</font>

329
00:16:59,269 --> 00:17:05,899
scheme<font color="#E5E5E5"> yes very good question and as of</font>

330
00:17:03,199 --> 00:17:10,010
<font color="#E5E5E5">course if you if you have domain</font>

331
00:17:05,898 --> 00:17:14,530
<font color="#E5E5E5">knowledge about how domain generation</font>

332
00:17:10,010 --> 00:17:14,530
algorithms work you<font color="#CCCCCC"> probably are able to</font>

333
00:17:14,799 --> 00:17:21,829
invent a<font color="#CCCCCC"> new generation scheme which was</font>

334
00:17:19,609 --> 00:17:25,698
was<font color="#CCCCCC"> not used before and which we have</font>

335
00:17:21,829 --> 00:17:28,389
<font color="#CCCCCC">not</font><font color="#E5E5E5"> seen</font><font color="#CCCCCC"> before and then our very</font>

336
00:17:25,699 --> 00:17:34,570
probable<font color="#CCCCCC"> be able your</font>

337
00:17:28,390 --> 00:17:37,210
able<font color="#E5E5E5"> to bypass our detection but in you</font>

338
00:17:34,570 --> 00:17:39,340
have<font color="#E5E5E5"> to say that we considered</font><font color="#CCCCCC"> four</font>

339
00:17:37,210 --> 00:17:43,179
different generation schemes which are

340
00:17:39,340 --> 00:17:46,059
<font color="#E5E5E5">first arithmetic generation scheme based</font>

341
00:17:43,179 --> 00:17:48,790
on<font color="#CCCCCC"> random numbers</font><font color="#E5E5E5"> and hash panel based</font>

342
00:17:46,059 --> 00:17:50,770
generation schemes<font color="#E5E5E5"> worthless generation</font>

343
00:17:48,790 --> 00:17:57,309
<font color="#E5E5E5">schemes and permutation generation</font>

344
00:17:50,770 --> 00:17:59,740
schemes<font color="#E5E5E5"> and once we have seen such a DGA</font>

345
00:17:57,309 --> 00:18:04,899
of a certain generation<font color="#E5E5E5"> scheme we were</font>

346
00:17:59,740 --> 00:18:10,690
able<font color="#E5E5E5"> to detect it</font><font color="#CCCCCC"> so it's only yeah a</font>

347
00:18:04,900 --> 00:18:13,929
<font color="#E5E5E5">small</font><font color="#CCCCCC"> you're you</font><font color="#E5E5E5"> are only have a small</font>

348
00:18:10,690 --> 00:18:16,120
amount<font color="#CCCCCC"> of time you</font><font color="#E5E5E5"> can use your</font><font color="#CCCCCC"> DGA and</font>

349
00:18:13,929 --> 00:18:19,000
bypass<font color="#CCCCCC"> or detection because</font><font color="#E5E5E5"> once we have</font>

350
00:18:16,120 --> 00:18:22,840
<font color="#E5E5E5">seen it we can train our model and and</font>

351
00:18:19,000 --> 00:18:25,720
it's<font color="#E5E5E5"> able to</font><font color="#CCCCCC"> detect it your name and</font>

352
00:18:22,840 --> 00:18:29,470
affiliation<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> hi</font><font color="#CCCCCC"> Matt elder Johns</font>

353
00:18:25,720 --> 00:18:32,620
Hopkins APL<font color="#CCCCCC"> it's great work I had a</font>

354
00:18:29,470 --> 00:18:35,470
question<font color="#E5E5E5"> regarding your evaluation and</font>

355
00:18:32,620 --> 00:18:37,090
its<font color="#E5E5E5"> implications on deployment</font><font color="#CCCCCC"> so I</font>

356
00:18:35,470 --> 00:18:40,780
would characterize the evaluations you

357
00:18:37,090 --> 00:18:43,959
did as spatially you know taking out<font color="#E5E5E5"> you</font>

358
00:18:40,780 --> 00:18:46,480
know checking the applicability<font color="#CCCCCC"> of one</font>

359
00:18:43,960 --> 00:18:48,790
data set on on you know the data coming

360
00:18:46,480 --> 00:18:53,020
from<font color="#E5E5E5"> another site did you consider doing</font>

361
00:18:48,790 --> 00:18:55,600
any temporal evaluation where instead<font color="#CCCCCC"> of</font>

362
00:18:53,020 --> 00:18:57,910
you would split<font color="#E5E5E5"> your data set train on</font>

363
00:18:55,600 --> 00:18:59,740
the first half of<font color="#E5E5E5"> it temporarily and</font>

364
00:18:57,910 --> 00:19:02,530
<font color="#CCCCCC">then evaluate on the second half and</font>

365
00:18:59,740 --> 00:19:04,179
<font color="#CCCCCC">that relates to</font><font color="#E5E5E5"> a deployment model for</font>

366
00:19:02,530 --> 00:19:05,918
<font color="#E5E5E5">this on how often you</font><font color="#CCCCCC"> think you'd</font><font color="#E5E5E5"> have</font>

367
00:19:04,179 --> 00:19:10,270
to retrain your model if this were

368
00:19:05,919 --> 00:19:13,059
deployed for<font color="#E5E5E5"> benign data we didn't</font>

369
00:19:10,270 --> 00:19:16,150
<font color="#CCCCCC">consider</font><font color="#E5E5E5"> that but for the DGA data we</font>

370
00:19:13,059 --> 00:19:20,820
did<font color="#E5E5E5"> so there are several DJ's</font><font color="#CCCCCC"> that are</font>

371
00:19:16,150 --> 00:19:24,690
time<font color="#CCCCCC"> dependent and</font><font color="#E5E5E5"> yeah we performed a</font>

372
00:19:20,820 --> 00:19:27,178
evaluation to check whether it's

373
00:19:24,690 --> 00:19:30,419
whether<font color="#E5E5E5"> our classifiers able to detect</font>

374
00:19:27,179 --> 00:19:34,489
the same<font color="#E5E5E5"> DJ when it's one year ahead so</font>

375
00:19:30,419 --> 00:19:39,509
so and there<font color="#E5E5E5"> was no problem and I think</font>

376
00:19:34,489 --> 00:19:42,419
regarding the<font color="#E5E5E5"> p9 domains it's that there</font>

377
00:19:39,509 --> 00:19:45,359
is probably sometimes retraining

378
00:19:42,419 --> 00:19:47,909
necessary but first it's very<font color="#E5E5E5"> fast so</font>

379
00:19:45,359 --> 00:19:55,049
you can retrain the model on<font color="#E5E5E5"> within</font>

380
00:19:47,909 --> 00:19:56,729
minutes and seconds you have probably

381
00:19:55,049 --> 00:19:58,739
only to retrain if you know there's

382
00:19:56,729 --> 00:20:01,049
something<font color="#E5E5E5"> changing in the network so</font><font color="#CCCCCC"> you</font>

383
00:19:58,739 --> 00:20:07,470
you probably will know when<font color="#E5E5E5"> you have to</font>

384
00:20:01,049 --> 00:20:10,429
retrain<font color="#E5E5E5"> if before so thank you</font><font color="#CCCCCC"> let's our</font>

385
00:20:07,470 --> 00:20:10,429
<font color="#CCCCCC">speaker was more</font>

