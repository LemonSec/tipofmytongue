1
00:00:00,000 --> 00:00:08,429
appreciate y'all coming on 90 and after
party on friday i want a beer because

2
00:00:08,429 --> 00:00:12,420
there's more than 20 people in here so
that's a so my first one today

3
00:00:13,980 --> 00:00:18,210
my name is Bill books and we'll be
talking about privileged access

4
00:00:18,210 --> 00:00:23,580
workstations and some other ways women
potential that in lateral movement out

5
00:00:23,580 --> 00:00:30,720
of your networks a little bit about me
I'm blue team on twitter i work in the

6
00:00:30,720 --> 00:00:35,309
financial sector for a small company 400
employees and ten locations

7
00:00:36,510 --> 00:00:41,820
I you know working for a small company
usually means we're a lot of hats and

8
00:00:41,820 --> 00:00:46,649
you know i do everything from
configuring network equipment to vendor

9
00:00:46,649 --> 00:00:52,890
management to daily sysadmin stuff and a
little bit of physical security and just

10
00:00:52,890 --> 00:00:57,960
a wide range of different things and you
know I'm truly blessed i'm one of those

11
00:00:57,960 --> 00:01:02,100
people that i truly love what I do for a
living like a lot of you guys probably

12
00:01:02,100 --> 00:01:07,200
pretty passionate about it and my
favorite things to do is to learn

13
00:01:07,200 --> 00:01:12,299
offensive techniques bringing back to my
network and taking apart the girl

14
00:01:12,299 --> 00:01:20,009
countermeasures moron and protection
mechanisms and things like that so in my

15
00:01:20,009 --> 00:01:26,100
free time I like to build up my hands
you know as I keep people we don't

16
00:01:26,100 --> 00:01:30,149
always get to see the tangible thing
that we built and I just think there's

17
00:01:30,150 --> 00:01:33,180
something really cool about you know
stepping back after a long day at work

18
00:01:33,180 --> 00:01:34,560
and you

19
00:01:34,560 --> 00:01:39,150
you see that cool thing that you built
the summer i built a pirate ship with my

20
00:01:39,150 --> 00:01:46,530
kids in my backyard which was a lot of
fun i also like grow my beard and cook

21
00:01:47,130 --> 00:01:52,020
yeah homebrew and also look but also
cooking and stuff on the grill

22
00:01:52,680 --> 00:01:58,500
ok so let's start here by talking about
a typical attack scenario on windows

23
00:01:58,500 --> 00:02:03,810
network in this first case let's say
that the organization might not be very

24
00:02:03,810 --> 00:02:08,369
security-conscious most users are going
to be running as local admin and one

25
00:02:08,369 --> 00:02:11,250
gets popped with a phishing email

26
00:02:11,250 --> 00:02:16,530
I'll attackers can be running as local
admin they can migrate to system .

27
00:02:16,530 --> 00:02:22,770
credentials and you know it's probably
not all around possibility that I the IT

28
00:02:22,770 --> 00:02:27,750
admins set the local admin password the
same for all of workstations just to

29
00:02:27,750 --> 00:02:30,600
make the license you huh

30
00:02:30,600 --> 00:02:34,680
and if they did that the attack and
obviously you can use that local

31
00:02:34,680 --> 00:02:38,100
conventional walking have literally
throwing almost workstations and have a

32
00:02:38,100 --> 00:02:39,269
password

33
00:02:39,270 --> 00:02:44,850
I tell you find another workstation
where maybe a domain domain admin login

34
00:02:44,850 --> 00:02:49,680
we can steal those credentials the
various ways so it's pretty quick path

35
00:02:49,680 --> 00:02:52,590
to game over

36
00:02:52,590 --> 00:02:55,380
ok the next scenario let's say that
their little more security conscious

37
00:02:55,380 --> 00:03:04,019
most users are running a standard users
and same situation either get popped by

38
00:03:04,020 --> 00:03:08,970
phishing email and now this time the
attackers running as standard user so

39
00:03:08,970 --> 00:03:12,690
you're going to need to be able to
escalate privileges so that they can get

40
00:03:12,690 --> 00:03:17,640
the local admin and then system so they
can you know . credentials still tokens

41
00:03:17,640 --> 00:03:18,750
and things like that

42
00:03:18,750 --> 00:03:24,989
oh and one way to do that they may use
something like our boys powerup tool

43
00:03:24,989 --> 00:03:31,799
look for common misconfigurations on the
system along escalate privileges are you

44
00:03:31,799 --> 00:03:35,400
know it if they don't see an easy way to
do that they might move laterally with

45
00:03:35,400 --> 00:03:39,630
the standard grids and look for more
configurations just trying to find one

46
00:03:39,630 --> 00:03:44,850
that works for you only doing that you
know that probably will be looking for

47
00:03:44,850 --> 00:03:49,260
credentials that are just on the network
so maybe they have been team left

48
00:03:49,260 --> 00:03:55,890
unattended xml file they're using .
images for pcs or maybe they deploy

49
00:03:55,890 --> 00:04:02,010
password policy preferences attacker
could get password that way but one way

50
00:04:02,010 --> 00:04:04,739
or another you're going to you're going
to keep moving around laterally I'm

51
00:04:04,739 --> 00:04:09,989
stealing credentials until they either
get domain admin or some kind of

52
00:04:09,989 --> 00:04:13,350
privilege potential until I get what
they're looking for

53
00:04:13,350 --> 00:04:18,060
oh so you know these scenarios are
certainly not almost all accompanying

54
00:04:18,060 --> 00:04:21,048
but i think that you follow pretty
common path

55
00:04:21,048 --> 00:04:25,849
on windows network that attack on my
cake and like I said domain may not be

56
00:04:25,849 --> 00:04:30,409
the end goal and if they find what
they're looking for an open share from a

57
00:04:30,409 --> 00:04:34,639
standard the first box the population
standard user may not care about domain

58
00:04:34,639 --> 00:04:41,120
admin but the point here is that the
attacker tactics tend to revolve around

59
00:04:41,120 --> 00:04:46,520
finding and using existing credentials
on over and if you want to see really

60
00:04:46,520 --> 00:04:48,948
good demo how attackers do that

61
00:04:48,949 --> 00:04:54,199
Holly Holly move laterally and
potentials checkout illustrator and Amy

62
00:04:54,199 --> 00:05:01,159
Robbins top and besides las vegas on one
hand some really cool stuff there but

63
00:05:01,159 --> 00:05:04,729
the main goal of these privileged access
workstations that is to limit exposure

64
00:05:04,729 --> 00:05:10,699
right I in order to do that you need to
understand where potentials are stored

65
00:05:10,699 --> 00:05:15,919
in what form they are stored and then
you gonna do some other issues with

66
00:05:15,919 --> 00:05:23,508
windows authentication and credentials
so to start off your little background

67
00:05:23,509 --> 00:05:27,409
like for windows logon types different
login times within windows you know when

68
00:05:27,409 --> 00:05:31,340
you when you log into the system are
interactive would be like when you

69
00:05:31,340 --> 00:05:35,299
actually type your password into like
console or any type your password in the

70
00:05:35,300 --> 00:05:39,289
computer is going to be interactive and
there's a bunch of other logotypes but

71
00:05:39,289 --> 00:05:44,150
the the key thing to take away here is
that all of them except for the network

72
00:05:44,150 --> 00:05:49,099
logon time are going to leave some form
of reusable potential when you use it so

73
00:05:49,099 --> 00:05:53,330
that's a pretty key thing takeaway here
as we move along and network logon types

74
00:05:53,330 --> 00:05:58,310
are going to be things like that use
from the command prompt PowerShell

75
00:05:58,310 --> 00:06:04,250
remoting registry using a tendency
snap-in to connect to remote machines

76
00:06:04,250 --> 00:06:08,210
although there are not to leave any
reasonable grandchildren the system you

77
00:06:08,210 --> 00:06:09,198
connect

78
00:06:09,199 --> 00:06:14,539
ok so let's talk a little bit of all
your credentials are stored and windows

79
00:06:14,539 --> 00:06:20,599
of the one more commonly known ones is a
book like local San database which is a

80
00:06:20,599 --> 00:06:25,400
file on a local computers that has you
know all local user accounts and their

81
00:06:25,400 --> 00:06:27,219
hashes that are associated with them

82
00:06:27,220 --> 00:06:33,340
you mean don't with system rights and
you know it's just pretty trivial to get

83
00:06:33,340 --> 00:06:37,210
once you have a local admin once you
once they're done they can be reinforced

84
00:06:37,210 --> 00:06:43,210
offliner or past other systems are going
to do a little bit you know Active

85
00:06:43,210 --> 00:06:45,969
Directory database pretty pretty basic
stuff here i think most people know but

86
00:06:45,970 --> 00:06:48,430
just kind of cover and we're all the
credentials are stored

87
00:06:48,430 --> 00:06:53,020
ah Active Directory database same thing
only its potentials for all users in the

88
00:06:53,020 --> 00:06:59,049
domain now read only domain controllers
by default aren't going to store for

89
00:06:59,050 --> 00:07:06,190
those credentials but don't have a
subset of of of the of the database in

90
00:07:06,190 --> 00:07:11,469
there but i'm not going to get too deep
into diving the Active Directory domain

91
00:07:11,470 --> 00:07:15,640
controller security but it is good it is
going to remember that another crucial

92
00:07:15,640 --> 00:07:23,020
concept considered potential story
elsass were made famous bike tools like

93
00:07:23,020 --> 00:07:29,229
me cast and windows financial editor and
only those tools pull pull the

94
00:07:29,230 --> 00:07:33,940
credentials from memory of that process
when a user logs into a system also has

95
00:07:33,940 --> 00:07:37,930
will catch your credentials so when when
when

96
00:07:37,930 --> 00:07:41,950
after you log on when you go to access
the network resource you don't have to

97
00:07:41,950 --> 00:07:47,650
type your password every time and these
can be stored as hashes grows tickets or

98
00:07:47,650 --> 00:07:56,260
just the actual plaintext password so
prior to Windows 8.1 server 2012 lsat

99
00:07:56,260 --> 00:08:00,789
store a lot of potential remembering as
you can see here they mean a lot of

100
00:08:00,790 --> 00:08:02,590
progress in that department

101
00:08:02,590 --> 00:08:07,929
you know this chart actually comes from
the second past half white paper from

102
00:08:07,930 --> 00:08:13,150
microsoft it was originally adapted from
a Twitter post by Benjamin del P is the

103
00:08:13,150 --> 00:08:17,830
creator me gets and i find that kind of
fitting because you know it's because of

104
00:08:17,830 --> 00:08:22,690
people like like Ben and I other people
in the community you know like chris

105
00:08:22,690 --> 00:08:27,969
campbell and skip the wall another and
lots of other people that have really

106
00:08:27,970 --> 00:08:32,200
brought these issues in the spotlight
and kind of course Microsoft it it's

107
00:08:32,200 --> 00:08:36,280
more tools to mitigate these issues so
just want to kinda . that on state you

108
00:08:36,280 --> 00:08:36,740
too

109
00:08:36,740 --> 00:08:44,570
everybody was involved in that but this
kb 287 1997 also known as we cats

110
00:08:44,570 --> 00:08:51,470
maybe my son was released in 2014 and it
gave us a lot of the controls that we're

111
00:08:51,470 --> 00:08:52,670
going to talk about today

112
00:08:52,670 --> 00:09:01,189
yeah for example as long as that updates
installed on Windows 7 computer only

113
00:09:01,190 --> 00:09:08,570
plant exponential is going to be the w
digest provider in LCS s4 windows 8.1

114
00:09:08,570 --> 00:09:13,640
above is going to be no point
exponential store small but there are

115
00:09:13,640 --> 00:09:15,260
some caveats this

116
00:09:15,260 --> 00:09:22,069
ah it's good video is going to store any
hash and thrust to get for doing the

117
00:09:22,070 --> 00:09:28,100
main accounts for what for windows 7 or
windows 8.1 involved and also the third

118
00:09:28,100 --> 00:09:31,970
party SSB my store some third-party
software my storage potential is it

119
00:09:31,970 --> 00:09:39,890
announced as well this this this is
reach out here from the meerkats github

120
00:09:39,890 --> 00:09:44,240
page has a bunch of really good stuff on
it so caveat to the win kick

121
00:09:44,240 --> 00:09:49,010
Exponential's if you're off its domain
computer and that you can't access the

122
00:09:49,010 --> 00:09:52,520
domain controller the kerberos provider
my score some credentials memory

123
00:09:52,520 --> 00:09:58,550
although windows 8.1 evolved does not
store . Exponential's and everybody all

124
00:09:58,550 --> 00:10:05,420
it can be reasonable with the average
tricky registry edit reboot similarly

125
00:10:05,420 --> 00:10:14,449
windows 7 w digest can be disabled by
educated reboot to and these are

126
00:10:14,450 --> 00:10:19,459
highlighted registry keys here at these
have certain value them and also my

127
00:10:19,459 --> 00:10:24,469
store some point exponential significant
memory for example if the organization

128
00:10:24,470 --> 00:10:30,470
has a group policy that sets our
delegating people potentials for for

129
00:10:30,470 --> 00:10:34,220
auto logon and select remote
applications terminal server that will

130
00:10:34,220 --> 00:10:39,020
also store that will put some keys into
those registries that highlighted last

131
00:10:39,020 --> 00:10:44,900
slide that will store . Exponential's in
the TSP Katie provider or else ass so

132
00:10:44,900 --> 00:10:47,470
good thing to keep in mind

133
00:10:47,470 --> 00:10:54,730
ah LLC secrets are going to be dat only
accessible to the system process some of

134
00:10:54,730 --> 00:10:58,570
these are going to be potentials and
encrypted and stored on this is going to

135
00:10:58,570 --> 00:11:01,690
be things like to get scheduled task
passwords computer account passwords

136
00:11:01,690 --> 00:11:07,900
service account passwords and also cash
will be typically call cash potentials

137
00:11:07,900 --> 00:11:12,280
that Microsoft calls password their
fires are stored in LSA secrets

138
00:11:12,280 --> 00:11:17,709
these are stored as soft and hashes and
these can be passed in a fast cash tag

139
00:11:17,710 --> 00:11:23,830
but they can be dumped into of course
and you know the cash potentials being

140
00:11:23,830 --> 00:11:28,030
that when you bring your computer home
into can talk about making troller if

141
00:11:28,030 --> 00:11:32,890
you're able to walk in with that
confidence cash on the system is also

142
00:11:32,890 --> 00:11:37,000
crucial manager where passengers can be
entered manually in the control panel

143
00:11:37,000 --> 00:11:42,070
off or when you tell windows to remember
your DP password i'm going to start

144
00:11:42,070 --> 00:11:43,000
there

145
00:11:43,000 --> 00:11:46,720
these are encrypted with a key that
comes from your that users password and

146
00:11:46,720 --> 00:11:52,420
any user that's any program is running
as that user can access those and if

147
00:11:52,420 --> 00:11:55,420
there's actually a nice white post
module we don't go i believe

148
00:11:55,990 --> 00:12:01,420
ok so that's kind of where is restored
some of the common issues with windows

149
00:12:01,420 --> 00:12:05,439
credentials you know I think we're all
pretty familiar with hash if you're not

150
00:12:05,440 --> 00:12:08,830
there's a ton of documentation on
internet with building my references

151
00:12:08,830 --> 00:12:13,540
I you know it until I'm passionate can
be acquired from various various ways

152
00:12:13,540 --> 00:12:17,020
whether it be pulling up from memory
with someone gave me cancer windows

153
00:12:17,020 --> 00:12:23,020
translator or dumping him from the local
samer the active duties and once you

154
00:12:23,020 --> 00:12:28,180
have a hash you can authenticate just as
windows does no legitimate walking on

155
00:12:28,180 --> 00:12:33,069
the background bypassing each other
systems of network when you log on to be

156
00:12:33,070 --> 00:12:35,800
until $TIME a.m. until out there's
different people different flavors with

157
00:12:35,800 --> 00:12:41,319
protocol that uses and it doesn't
challenge response mechanism that I

158
00:12:41,320 --> 00:12:45,160
proves that the user knows their
password hash basically this couple of

159
00:12:45,160 --> 00:12:50,110
flavors that is until everyone is
completely broken if the attacker can

160
00:12:50,110 --> 00:12:55,000
capture the traffic on the wire we can
we can recover the hash and you went to

161
00:12:55,000 --> 00:12:56,110
a little bit better but

162
00:12:56,110 --> 00:13:00,730
as has issues can be grouped forest and
both these vulnerable to relay attacks

163
00:13:00,730 --> 00:13:05,019
which I believe can be partially
mitigated by S&B signing but not totally

164
00:13:05,019 --> 00:13:10,810
similar issues with kerberos you know
you can dump the ticket from one

165
00:13:10,810 --> 00:13:16,060
computer loaded onto another computer
also known as past ticket ticket ticket

166
00:13:16,060 --> 00:13:19,479
technically expired but they can be
there

167
00:13:19,480 --> 00:13:23,740
it expired to get presented they can be
repeated be extended and others other

168
00:13:23,740 --> 00:13:27,519
issues with kerberos you know I golden
ticket silver ticket which kind of

169
00:13:27,519 --> 00:13:34,209
hospital for today but still no ball so
you know the things we talked about so

170
00:13:34,209 --> 00:13:40,060
far branches in memory pass the hash
pass ticket i think you're already one

171
00:13:40,060 --> 00:13:46,060
blue team about Windows good i think
it's the same can be true said about

172
00:13:46,060 --> 00:13:51,399
Windows access tokens i remember i did a
class a few years ago when did Kennedy

173
00:13:51,399 --> 00:13:56,950
and you know we showed us how to use
incognito still tokens and print

174
00:13:56,950 --> 00:14:00,970
privileged users but I really didn't
grasp really what I was really doing

175
00:14:01,720 --> 00:14:06,370
oh and to be honest with you didn't we
know windows access tokens existed until

176
00:14:06,370 --> 00:14:12,339
fairly recently but to kind of quickly
explain our go over what windows access

177
00:14:12,339 --> 00:14:16,540
tokens are when you log into a system
verifies your password

178
00:14:17,170 --> 00:14:22,269
check your passwords ok if the past your
password is ok that soaking gets created

179
00:14:22,269 --> 00:14:27,220
and every process that gets executed on
behalf of that user is going to have a

180
00:14:27,220 --> 00:14:30,880
copy that token and talking talking to
be stored in memory and they basically

181
00:14:30,880 --> 00:14:36,550
enable six single sign-on functionality
within windows so there's a couple

182
00:14:36,550 --> 00:14:40,569
different types of these tokens there's
a person nation tokens if you saw the

183
00:14:40,570 --> 00:14:46,329
red potato talk yesterday you're talking
about personation tokens there is

184
00:14:46,329 --> 00:14:51,219
generated by non-interactive logons
these can be used escalate privileges

185
00:14:51,220 --> 00:14:56,440
but they can only be used locally then
there's delegation tokens which are used

186
00:14:56,440 --> 00:15:00,339
generated by interactive logon and these
are really the ones that attacker wants

187
00:15:00,339 --> 00:15:05,920
to get because the attacker can steal a
delegation talking the have a privileged

188
00:15:05,920 --> 00:15:08,019
user they can use that to your advantage

189
00:15:08,019 --> 00:15:13,059
just walked onto any network accessible
system so is everybody pretty familiar

190
00:15:13,059 --> 00:15:17,259
with incognito and help and homework
still tokens are you guys use that for

191
00:15:17,259 --> 00:15:20,439
ya

192
00:15:20,439 --> 00:15:24,939
I don't it doesn't seem to be super
well-known model defenders I just want

193
00:15:24,939 --> 00:15:29,920
to go over real quick little demo on
what looks like to go from the local

194
00:15:29,920 --> 00:15:35,439
admin to have been by stuart tokens so
you can see here we've got a interpreter

195
00:15:35,439 --> 00:15:41,139
shell running as local admin you know we
got this multiple ways let's just say

196
00:15:41,139 --> 00:15:46,509
it's a phishing email and now in order
to steal or list opens we need to be

197
00:15:46,509 --> 00:15:52,929
running a system and so you know you
want me to do that you migrate to a

198
00:15:52,929 --> 00:15:55,839
process that's currently running a
system and then you become you been

199
00:15:55,839 --> 00:16:00,189
running a system to this prophecy this
example i migrate the winlogon process

200
00:16:00,189 --> 00:16:06,849
and offered on the victims computer i
opened up a computer management box and

201
00:16:06,850 --> 00:16:12,189
in the USC probably typed in my domain
admin credentials and then close the

202
00:16:12,189 --> 00:16:16,209
computer management loss now that that
left that talking about user on the

203
00:16:16,209 --> 00:16:21,638
system so now i'm going to really attack
her list all the tokens he sees the dog

204
00:16:21,639 --> 00:16:27,910
is uh accountants in the blue team
domain domain admin account and it's is

205
00:16:27,910 --> 00:16:33,009
it was you know a person a token and you
steal that token you are able to use it

206
00:16:33,009 --> 00:16:37,299
on the network to access any any system
or network with those credentials

207
00:16:39,579 --> 00:16:43,388
well one thing I didn't know until it's
kind of preparing for this talk is that

208
00:16:43,389 --> 00:16:49,179
this company has been around for a
really long time it was presented it was

209
00:16:49,179 --> 00:16:54,279
written by the presented by a guy named
Luke Jennings in death on 15 and I know

210
00:16:54,279 --> 00:16:58,569
kind of late to the party on this but uh
his white paper that you wrote for

211
00:16:58,569 --> 00:17:05,799
public nine years ago it still rings
true today and if you go

212
00:17:05,799 --> 00:17:09,069
he's advocating for a lot of same things
that i'm talking about today so if you

213
00:17:09,069 --> 00:17:12,178
haven't checked it off it's still worth
three even though it's a 90

214
00:17:12,179 --> 00:17:19,199
the whole oh so you know eventually
after Zack has been a major issues for a

215
00:17:19,199 --> 00:17:23,970
long time even in that white paper he's
talking about how is nothing news and

216
00:17:23,970 --> 00:17:26,519
happiness has been an issue for a long
time

217
00:17:26,519 --> 00:17:31,110
ah but there's a couple major roadblocks
we need to overcome to to combat these

218
00:17:31,110 --> 00:17:36,959
issues i'll remember one thing IT admins
and other people that may not consider

219
00:17:36,960 --> 00:17:41,100
themselves you know security people they
don't think might not really understand

220
00:17:41,100 --> 00:17:43,740
the preschool talking about

221
00:17:43,740 --> 00:17:51,029
also you know change is hard and
usability tends to trump security you

222
00:17:51,029 --> 00:17:55,049
know as Luke Jennings said in that white
paper and chris campbell and skip the

223
00:17:55,049 --> 00:17:58,139
wall echoed in their black paper a
couple years ago

224
00:17:58,139 --> 00:18:02,850
there's there's no patch from these it
for these issues you know it's an

225
00:18:02,850 --> 00:18:08,248
unexpected consequence of a single
sign-on implementation and without a

226
00:18:08,249 --> 00:18:11,519
single sign-on you have to type your
password and you know ten times just

227
00:18:11,519 --> 00:18:16,440
when your system . right so you know but
there is panda life in the tunnel here

228
00:18:16,440 --> 00:18:21,119
and we're getting we have more controls
that than ever before to mitigate some

229
00:18:21,119 --> 00:18:26,908
of this stuff and it's going to provide
so much more value by using some of

230
00:18:26,909 --> 00:18:32,220
these controls than any next-gen blinky
blocks but you can go by and one of the

231
00:18:32,220 --> 00:18:38,789
wireless controllers using privileged
access workstations so privileged access

232
00:18:38,789 --> 00:18:45,960
workstations or pause you know that the
concept as far as I'm aware I'm was kind

233
00:18:45,960 --> 00:18:50,249
of outlined in the first pass the hash
white paper from what Microsoft and it

234
00:18:50,249 --> 00:18:54,509
was kind of expand upon a technological
for really this year and it could be a

235
00:18:54,509 --> 00:18:58,320
much older concept that it probably is
but the first i have heard about it was

236
00:18:58,320 --> 00:19:03,779
that second article but at the most
basic level their hard-won admin work

237
00:19:03,779 --> 00:19:08,639
stations that are designed to limit your
exposure to the types of threats we

238
00:19:08,639 --> 00:19:10,290
think we're just talking about

239
00:19:10,290 --> 00:19:18,510
so if your goal is to limit how often
privilege credentials you have left on

240
00:19:18,510 --> 00:19:22,440
systems for attackers to steal how do
you go about how do you go about doing

241
00:19:22,440 --> 00:19:23,130
that

242
00:19:23,130 --> 00:19:28,740
oh I like to think of it and compared to
network segmentation where you want to

243
00:19:28,740 --> 00:19:33,810
isolate those privileged credentials and
keep them off and away from riskier

244
00:19:33,810 --> 00:19:40,080
systems and risk your users and to do
that you need to group the systems and

245
00:19:40,080 --> 00:19:45,840
users my privilege level so the second
article references this administrated

246
00:19:45,840 --> 00:19:49,649
active directory administrative to your
model basically what this is it just

247
00:19:49,650 --> 00:19:55,020
splits up users and computers and you
computers into different levels of

248
00:19:55,020 --> 00:20:00,120
different tiers of access so you've got
20 which is going to be your domain

249
00:20:00,120 --> 00:20:03,959
admins domain controllers if you don't
make controllers are virtualized it's

250
00:20:03,960 --> 00:20:09,240
going to be any admin administer the
virtualized infrastructure this tier 1

251
00:20:09,240 --> 00:20:13,740
which is going to be your anything that
has control over mission-critical

252
00:20:13,740 --> 00:20:18,360
applications that's going to be a member
server admins never servers enterprise

253
00:20:18,360 --> 00:20:23,490
application admins and then this tier 2
which is going to be your your user

254
00:20:23,490 --> 00:20:28,830
devices in any accounts that have
control over the user devices so the

255
00:20:28,830 --> 00:20:33,810
idea here is that you have your domain
admin account you never log into

256
00:20:33,810 --> 00:20:37,080
anything other than domain controller
stay in that same here

257
00:20:37,080 --> 00:20:42,330
you're a member server admin should
should never log into a standard user

258
00:20:42,330 --> 00:20:48,570
workstation and a similar thought here
you never log in to a domain controller

259
00:20:48,570 --> 00:20:53,340
from the same computer that you're
looking at kathleen's and i'm checking

260
00:20:53,340 --> 00:20:59,909
your email and things like that because
once your admin state workstation is

261
00:20:59,910 --> 00:21:04,200
compromised so does anything else that
you've administer from the right and

262
00:21:04,200 --> 00:21:09,060
that's the best that's a really key
thing to understand so you know

263
00:21:09,060 --> 00:21:13,260
traditional solutions this problem are
can be inherently Flying Squad depending

264
00:21:13,260 --> 00:21:17,460
on Halloween implemented if you're
accessing admin jump server from a user

265
00:21:17,460 --> 00:21:22,410
workstation that you browse the internet
and check email from got the same

266
00:21:22,410 --> 00:21:23,340
problem we just talk

267
00:21:23,340 --> 00:21:29,250
well I know you can use any more jump
servers I pot appointment but you're

268
00:21:29,250 --> 00:21:31,980
gonna want to make sure anyway that's
asset accessing them is doing it from a

269
00:21:31,980 --> 00:21:39,690
hard work station now before you go
start configuring hard work stations

270
00:21:39,690 --> 00:21:42,720
there's some prerequisites you're gonna
want to consider before you do that

271
00:21:42,720 --> 00:21:52,350
first of all here in Austin users are
running as local admin you're gonna want

272
00:21:52,350 --> 00:21:55,860
to tackle that problem first grade that
could be a difficult thing to accomplish

273
00:21:55,860 --> 00:22:01,020
depending on how much you know
management wise and just security types

274
00:22:01,020 --> 00:22:06,240
of legacy application long run and
things like that but you know don't give

275
00:22:06,240 --> 00:22:08,940
up if you have a subset of users that
you just can't figure out how to get

276
00:22:08,940 --> 00:22:13,050
running a standard users don't give up
because there's so much there's a ton of

277
00:22:13,050 --> 00:22:16,889
value and getting a few people running
as local admin as you possibly can you

278
00:22:16,890 --> 00:22:19,800
know you want to you want to make it
harder for the attacker to go from

279
00:22:19,800 --> 00:22:24,090
staining you want to make a call from
standard user to local admin and system

280
00:22:24,090 --> 00:22:29,340
and if you have legacy applications that
maybe not don't play well as user

281
00:22:29,340 --> 00:22:30,720
account control

282
00:22:30,720 --> 00:22:37,200
oh you cannot you think was a workaround
you can do maybe you can run it from the

283
00:22:37,200 --> 00:22:43,890
application in terminal server you know
if you need to put some pressure on that

284
00:22:43,890 --> 00:22:48,240
vendor if you need more full of the
vendor maybe team up with other

285
00:22:48,240 --> 00:22:51,570
customers and vendors to try to get them
to fix their software

286
00:22:51,570 --> 00:22:55,230
ah and you can also split up their
college give them a standard user gonna

287
00:22:55,230 --> 00:22:59,160
get a local admin account and try to
force them to use the standard user

288
00:22:59,160 --> 00:23:04,380
account only the what will happen when
they need escalate you can put the local

289
00:23:04,380 --> 00:23:07,830
admin account to protect users group
will have a little bit more in a minute

290
00:23:08,430 --> 00:23:13,020
um so you know you're happy here

291
00:23:13,020 --> 00:23:17,910
your IT help us people are going to be
running a standard users to and what

292
00:23:17,910 --> 00:23:22,950
they only use the local admin we need to
and if you do have some of the group

293
00:23:22,950 --> 00:23:28,770
users that are 90 in a separate house
for standard and local admin make sure

294
00:23:28,770 --> 00:23:31,470
they're only love living on their their
box and not

295
00:23:31,470 --> 00:23:39,780
every box and the next thing you want to
do is uh you know some small companies

296
00:23:39,780 --> 00:23:45,780
they just use domain admin and mr.
everything is a big no-no so break out

297
00:23:45,780 --> 00:23:50,158
your break out your admins into like
never server admins and also you're

298
00:23:50,159 --> 00:23:55,650
gonna want to limit your domain admins
to view is he possibly can get you know

299
00:23:55,650 --> 00:23:59,730
delegate villages and easy as as you
need to and it's also a good idea if you

300
00:23:59,730 --> 00:24:03,870
can two segments each group admin so if
you've got a you've got a couple of

301
00:24:03,870 --> 00:24:09,209
admins that we need access to operations
cooperation servers you make them their

302
00:24:09,210 --> 00:24:16,620
own you make them their own group so
that the technical is so a couple of

303
00:24:16,620 --> 00:24:21,870
phases of deployment here on these was
going to be immediate deployment Active

304
00:24:21,870 --> 00:24:25,770
Directory admins this is going to be
getting up and running using positives

305
00:24:25,770 --> 00:24:32,039
quickly as you can to help your most
privileged accounts phase two is going

306
00:24:32,039 --> 00:24:37,260
to be extending pasta all users with the
fish better admins over mission-critical

307
00:24:37,260 --> 00:24:43,289
applications to me things like never
happens cause services admins energy

308
00:24:43,289 --> 00:24:48,240
phase three is going to be advanced pasa
curity it's going to be adding some

309
00:24:48,240 --> 00:24:54,929
additional controls which all . so for
the deployment models that is a couple

310
00:24:54,929 --> 00:24:59,789
recommended . models on the first one
being dedicated hardware which is going

311
00:24:59,789 --> 00:25:04,020
to be where you give admins a dedicated
workstation will it be a laptop or

312
00:25:04,020 --> 00:25:10,139
desktop and they have one that's your
standard user system they only use their

313
00:25:10,140 --> 00:25:13,770
standard user account login to that they
that's where they check email browse the

314
00:25:13,770 --> 00:25:18,210
internet things like that they have a
totally separate system the user

315
00:25:18,210 --> 00:25:22,770
administration they log in with their
privilege potential and then they're not

316
00:25:22,770 --> 00:25:30,510
local admins on that box they can browse
the internet and so isn't there some

317
00:25:30,510 --> 00:25:34,110
pros with the dedicated Hardware model
it's probably got the strongest security

318
00:25:34,110 --> 00:25:40,110
separation because they're two separate
systems the job apps takes up more desk

319
00:25:40,110 --> 00:25:42,399
space it's more week to haul around

320
00:25:42,400 --> 00:25:48,310
if especially this laptop and it's
double hardware cost model is

321
00:25:48,310 --> 00:25:56,440
simultaneous use this will be a hardon
host machine will be your paw and you

322
00:25:56,440 --> 00:26:01,570
have a local your local p.m. that is
your standard user system or you'll

323
00:26:01,570 --> 00:26:07,629
access of a vm on like up with me dir
dep or something like that but in a

324
00:26:07,630 --> 00:26:11,980
centralized place and so the conflict
arose they're obviously a little

325
00:26:11,980 --> 00:26:16,000
hardware costs better user experience
and the drawback is you know when you

326
00:26:16,000 --> 00:26:22,570
have a single keyboard mouse you can
tend to type the password into the wrong

327
00:26:22,570 --> 00:26:26,830
system may be no it's just easier to
make those years and also you don't have

328
00:26:26,830 --> 00:26:30,010
that separation as you would with the
dedicated hard work

329
00:26:30,010 --> 00:26:35,770
so for the simultaneous use all you know
you either have that local of a vm

330
00:26:35,770 --> 00:26:40,629
locally on the harder haha that's your
standard user system or you can have

331
00:26:40,630 --> 00:26:45,370
access to your beady eye on him and
essentially the drop back up the vdi

332
00:26:45,370 --> 00:26:52,149
that it is that if you're offline or you
can access that data center if you can't

333
00:26:52,150 --> 00:26:56,170
do your standard user activities so you
can access that so you have to be always

334
00:26:56,170 --> 00:27:02,560
kept that I'm gonna start talking about
this model other IT people attend this

335
00:27:02,560 --> 00:27:07,090
table i can I just have a know my
regular user workstation and have an

336
00:27:07,090 --> 00:27:10,510
admin vm on it just seems like that
makes more sense it's more convenient

337
00:27:10,510 --> 00:27:14,860
but that brings us back to the same
issue we're just talking about where you

338
00:27:14,860 --> 00:27:20,020
use your workstation gets compromised
and anything that you administered from

339
00:27:20,020 --> 00:27:24,129
there is because also could be
compromised as well as if you flip that

340
00:27:24,130 --> 00:27:27,610
around and your your user p.m. gets
compromised

341
00:27:28,810 --> 00:27:34,120
I'm going to get back the host you need
you know a vm escape exploit or

342
00:27:34,120 --> 00:27:37,270
something like that which I'm sure is
beautiful but going to be a lot harder

343
00:27:37,270 --> 00:27:45,190
to do so once you've chosen your . model
and you can mix and match that obviously

344
00:27:45,190 --> 00:27:52,000
de to your environment what your admin
group you can use a couple of PowerShell

345
00:27:52,000 --> 00:27:52,920
scripts that the

346
00:27:52,920 --> 00:27:59,520
they actually microsoft has a non-tech
and so one will create the new all you

347
00:27:59,520 --> 00:28:02,790
structure one will create the new
security groups put them in the right

348
00:28:02,790 --> 00:28:07,020
only use and one will assign permissions
to do you put the right groups

349
00:28:07,680 --> 00:28:14,400
oh it's so when it when you get to know
you always created the meat potatoes

350
00:28:14,400 --> 00:28:19,560
we're gonna be working in the admin
top-level newly-created admin top-level

351
00:28:19,560 --> 00:28:24,389
ah oh you and it creates mother used to
but mostly what you're going to be

352
00:28:24,390 --> 00:28:30,420
working is that you and that underneath
that is going to be 20 to 1 tier two and

353
00:28:30,420 --> 00:28:33,930
then a column underneath each one of
those there's a palace devices groups

354
00:28:33,930 --> 00:28:39,600
and services counselor I'm just going to
quickly go over the tier 10 you so

355
00:28:39,600 --> 00:28:44,969
enough in the account so you want to
tier1 this is going to be going to put

356
00:28:44,970 --> 00:28:49,500
users that are members of domain admins
enterprise that means our club global

357
00:28:49,500 --> 00:28:53,460
Internet know you and the devices though
you're going to put your your pocket

358
00:28:53,460 --> 00:28:57,450
computer accounts that's going to be the
computer comments that are in our paws

359
00:28:57,450 --> 00:29:01,080
and here's your old and then under
groups are going to have some new groups

360
00:29:01,080 --> 00:29:06,419
that were created in there and the pot
users group is going to be the actual

361
00:29:06,420 --> 00:29:11,610
users the logon hopefully to the the
workstations now these are not going to

362
00:29:11,610 --> 00:29:16,469
be local admins on those systems there
are the palm maintenance group is going

363
00:29:16,470 --> 00:29:21,090
to be localizing if you need to login to
troubleshoot it or whatever you know

364
00:29:21,090 --> 00:29:24,179
you're going to really use that but
that's that that that group is going to

365
00:29:24,180 --> 00:29:31,350
be the local admin on the system and
it's important to note to users should

366
00:29:31,350 --> 00:29:39,300
never be a member of both parties and
comments so keep that line so i want you

367
00:29:39,300 --> 00:29:42,360
have the whole you framework laid out
you can start working for policies that

368
00:29:42,360 --> 00:29:48,060
are going to harden the heart of the
devices is some of the ones listed on

369
00:29:48,060 --> 00:29:52,050
the technical and you could obviously
expand on this and do more but i'm

370
00:29:52,050 --> 00:29:55,950
personally that you'll do is it empty
using group policy to empty on google

371
00:29:55,950 --> 00:30:01,880
groups and just put in the Armenians and
local administrator account

372
00:30:01,880 --> 00:30:07,640
do it localizes group if you can grant
all users group local walk-in access to

373
00:30:07,640 --> 00:30:13,430
the top and then you can use windows
firewall rules to block all unsolicited

374
00:30:13,430 --> 00:30:19,160
involve traffic you can use you can't
wait list for certain ideas that you may

375
00:30:19,160 --> 00:30:24,620
be used for cash management security
handing things like that and then you

376
00:30:24,620 --> 00:30:31,939
can get your w says to automatically
install windows updates for the user

377
00:30:31,940 --> 00:30:37,640
gpo's you're gonna want to block
internet access for all Paul users group

378
00:30:37,640 --> 00:30:38,960
that was created

379
00:30:38,960 --> 00:30:43,730
ah you can do that through you know
RuPaul see you through internet explorer

380
00:30:43,730 --> 00:30:47,210
approximate sittings or you can use
whatever you already have in place you

381
00:30:47,210 --> 00:30:52,130
know if you have processor windows
security when let's carry whatever you

382
00:30:52,130 --> 00:30:53,090
do that

383
00:30:53,090 --> 00:30:56,449
oh you're also going to want to restrict
administrators from walking onto

384
00:30:56,450 --> 00:31:02,900
volunteering post and you can do that
with the dialogue on rights so basically

385
00:31:02,900 --> 00:31:07,220
you know you have your tr0 college they
should not be allowed to log onto your

386
00:31:07,220 --> 00:31:13,190
tier 1 systems or two systems and then
you have your tier 1 college but should

387
00:31:13,190 --> 00:31:19,580
be allowed want to use your workstations
you can use those login login right bebe

388
00:31:19,580 --> 00:31:20,840
eau de do that

389
00:31:20,840 --> 00:31:27,500
so what you have all the policies know
you all also pretty much been ready to

390
00:31:27,500 --> 00:31:31,610
go you can start working on your
hospital hardware and when you do that

391
00:31:31,610 --> 00:31:36,080
you can might want to consider your
supply chain and how much you trust your

392
00:31:36,080 --> 00:31:41,300
you-know-what manufacturer and supplier
their security practices of a few actual

393
00:31:41,300 --> 00:31:44,810
hardware that you're getting you don't
want to acquire your installation media

394
00:31:44,810 --> 00:31:51,919
I'm so if you can use Windows 10
enterprise that the ideal so you can

395
00:31:51,920 --> 00:31:56,300
take advantage of things like potential
guard place card you can use Windows 10

396
00:31:56,300 --> 00:32:02,960
pro to you just walk you're going to use
those things so keep that in mind you

397
00:32:02,960 --> 00:32:06,080
can set any complex password of the
local admin account

398
00:32:07,750 --> 00:32:20,770
look look at this guide you can catch up
on the network join the domain go to the

399
00:32:20,770 --> 00:32:25,180
right all you install windows updates
any necessary admin tools and when you

400
00:32:25,180 --> 00:32:28,180
for the admin tools and installation
media you're gonna wanna obviously

401
00:32:28,180 --> 00:32:32,980
verify your integrity on that and you
know check the hashes make sure that

402
00:32:32,980 --> 00:32:36,790
match and for any admin tools that you
install the box

403
00:32:36,790 --> 00:32:41,530
you're gonna want to really carefully
consider the risk exposure that you're

404
00:32:41,530 --> 00:32:46,060
adding that system he only wanted
install stuff that is absolutely need

405
00:32:46,060 --> 00:32:52,000
that in then you can forward your lost
any sim that you have a centralized

406
00:32:52,000 --> 00:32:57,520
water repository and validate your
parking policies and once you have these

407
00:32:57,520 --> 00:33:02,590
deployed to all active directory admins
that will be that you'll be doing phase

408
00:33:02,590 --> 00:33:10,449
1 phase 2 is going to be extending this
out to all admins of mission-critical

409
00:33:10,450 --> 00:33:15,280
applications and this is going to be
things you know like member server

410
00:33:15,280 --> 00:33:22,690
admins hot services admins network
admins things like that and in face to

411
00:33:22,690 --> 00:33:30,970
microsoft recommends enabling enforcing
restricted admin mode for desktop

412
00:33:30,970 --> 00:33:38,110
connections and you know this is kind of
controversial thing I think you know the

413
00:33:38,110 --> 00:33:45,310
the because ironically when you enable
restricted mode you are allowing hear

414
00:33:45,310 --> 00:33:53,440
your long past the half Ashby rdp the
system and you know the benefit of

415
00:33:53,440 --> 00:33:58,450
restricted have been mode is that it
leaves no reasonable credentials on the

416
00:33:58,450 --> 00:34:02,710
other systems that you have anything to
wear as typical remote desktop

417
00:34:02,710 --> 00:34:11,230
connection will leave it empty fashion
girls to get but you know you don't want

418
00:34:11,230 --> 00:34:14,230
to weigh the risk versus reward here and
you know

419
00:34:15,540 --> 00:34:22,620
you know that in my mind if you lock
down rdp so you can only you can only

420
00:34:22,620 --> 00:34:28,049
rdp from trusted host enabling
researchers have been mowed the benefit

421
00:34:28,050 --> 00:34:32,580
in not leaving reasonable credentials
when you have medicate are always any

422
00:34:32,580 --> 00:34:38,250
additional additional recipe gets
created by enabling restricted am

423
00:34:38,250 --> 00:34:45,719
anymore so you decide to use your admin
mode is off by default you need to

424
00:34:45,719 --> 00:34:52,350
enable a lot of destination systems the
restricted to use it you just use the

425
00:34:52,350 --> 00:34:57,990
restrictive in flag all with rdp and to
enforce that you do the restricted

426
00:34:57,990 --> 00:35:02,850
restricted allegation of potentials to
remote servers are awesome and you make

427
00:35:02,850 --> 00:35:08,580
that to any admin computer will use the
limitations of using restricted mode is

428
00:35:08,580 --> 00:35:14,490
that when you connect to a system with
the shutdown mode and then you connect

429
00:35:14,490 --> 00:35:17,879
to another system from that problem
there you're gonna be up any getting

430
00:35:17,880 --> 00:35:23,460
with the computer account of that system
that you first walk into so you know

431
00:35:23,460 --> 00:35:26,730
what you have like a network share
something like that it's going to be

432
00:35:26,730 --> 00:35:31,020
using the computer account logging that
so that's just want to keep that in mind

433
00:35:31,020 --> 00:35:36,690
then face to you're also going to want
me

434
00:35:36,690 --> 00:35:40,590
move move objects to appropriately use
so 21 users herbs

435
00:35:40,590 --> 00:35:46,770
thank you computer console and then any
Oscars want to also add users to the

436
00:35:46,770 --> 00:35:51,180
tier 1 admins group so that's going to
allow you to use your policy to restrict

437
00:35:51,180 --> 00:35:57,690
water or two places an optional step
here is you can while you can allow

438
00:35:57,690 --> 00:36:03,480
whitelisted in a destination so like if
you have a cloud services that you need

439
00:36:03,480 --> 00:36:09,240
to administer if you have a vendor that
means to be able to remote into provide

440
00:36:09,240 --> 00:36:14,160
support for their application you can
West their their investigation on the

441
00:36:14,160 --> 00:36:20,640
pause you know tr1 admins might need
different tools and 20 admin so you

442
00:36:20,640 --> 00:36:24,089
don't want to carefully consider the way
to risk the beach in the tool you're

443
00:36:24,090 --> 00:36:24,610
going to install

444
00:36:24,610 --> 00:36:32,800
all you can also enable crystal guard at
this point guard is a fairly new

445
00:36:32,800 --> 00:36:38,200
technology that the idea is to
virtualize windows services that manage

446
00:36:38,200 --> 00:36:39,490
credentials

447
00:36:39,490 --> 00:36:45,040
the idea is that you you're isolating
soul of an attacker is running as local

448
00:36:45,040 --> 00:36:49,779
admin admin rights they're not the idea
would be not allow them to access those

449
00:36:49,780 --> 00:36:54,070
credentials but there are some
requirements for that you need Windows

450
00:36:54,070 --> 00:36:59,680
10 enterprising forbid i even have
secure boot enable and if they're good

451
00:36:59,680 --> 00:37:03,339
the machine is at $TIME p.m. and he's
being hyper V and there's also a couple

452
00:37:03,340 --> 00:37:06,340
of the record apartments with that so
keep that in mind

453
00:37:08,350 --> 00:37:11,740
so face three builds on phase one is
really not depending on face to it all

454
00:37:11,740 --> 00:37:16,330
and as things like multi-factor
authentication using smart cards and

455
00:37:16,330 --> 00:37:21,610
white listing but things like device
garden at Walker which are really

456
00:37:21,610 --> 00:37:27,340
awesome controls I don't have time to
dive into that you're fairly complex but

457
00:37:27,340 --> 00:37:32,320
I brought them in for device card if you
can if you're interested in looking at

458
00:37:32,320 --> 00:37:38,260
that check out matt grevers uh Bobby's
gonna get stuff on there also will talk

459
00:37:38,260 --> 00:37:44,290
about protecting issues and dedication
policies styles so when those two factor

460
00:37:44,290 --> 00:37:48,850
authentication solutions great control
but you gotta remember they're not a

461
00:37:48,850 --> 00:37:52,029
magic bullet for this issue these issues

462
00:37:52,030 --> 00:37:57,190
no they do have some limitations there
only enforce our interactive logons and

463
00:37:57,190 --> 00:38:02,290
if you force my heart logons the hash
won't change that count

464
00:38:02,290 --> 00:38:07,060
so if the attacker gets a passion for
those accounts they could use it to log

465
00:38:07,060 --> 00:38:13,570
on the network wat ons and now you can
mitigate that by toggling the smart card

466
00:38:13,570 --> 00:38:19,510
required setting and you can you script
that obviously but i believe that will

467
00:38:19,510 --> 00:38:24,550
invalidate any sessions of those users
deadline

468
00:38:26,470 --> 00:38:31,540
so protected users group this is one of
my favorite controls i think most think

469
00:38:31,540 --> 00:38:35,590
that's the most painless to implement
basically just put users in the affected

470
00:38:35,590 --> 00:38:40,420
users group and you get a whole bunch of
good benefits from that most of your

471
00:38:40,420 --> 00:38:44,109
benefits that you're going to be you're
going to be given when she's running

472
00:38:44,109 --> 00:38:50,200
2012 r2 functional level but you can you
still get some little bit if you're not

473
00:38:50,200 --> 00:38:54,250
quite there yet and what this basically
does is it'll it'll force kerberos

474
00:38:54,250 --> 00:38:59,470
authentication so you won't use it to
him at all and it'll force using AES

475
00:38:59,470 --> 00:39:04,569
partner Bruce it all take your ticket
hours from 10-2 for your ticket you take

476
00:39:04,570 --> 00:39:08,830
it only lasts for four hours instead of
10 and if you want to take it expires

477
00:39:08,830 --> 00:39:14,859
and forces the user to relog on really
indicate now and also in in a little

478
00:39:14,859 --> 00:39:17,020
graphic down there

479
00:39:17,020 --> 00:39:22,330
the only thing stored in memory or else
ass is gonna be girls to get and don't

480
00:39:22,330 --> 00:39:26,680
feature limitation depending on how you
look at it I wouldn't the user is a

481
00:39:26,680 --> 00:39:31,118
member of protecting users group it was
the system any system log onto will not

482
00:39:31,119 --> 00:39:36,849
store any local cache credentials so if
you put your user into the pop into my

483
00:39:36,849 --> 00:39:40,540
user into the protective user group then
you go home and you're not able to hit

484
00:39:40,540 --> 00:39:45,730
the domain controller you will be a lot
on that account so good thing to keep in

485
00:39:45,730 --> 00:39:52,990
mind they're so education policies in
silos these pair well with protecting

486
00:39:52,990 --> 00:39:58,359
users group and they do require 2012 r2
functional level now this'll do things

487
00:39:58,359 --> 00:40:02,200
like you can control warehouse log on
what services they can authenticate to

488
00:40:02,200 --> 00:40:08,259
you can set kind of granular Kerberos
ticket settings and is a great control

489
00:40:08,260 --> 00:40:12,580
as well and also lessons learned from my
deployment

490
00:40:12,580 --> 00:40:17,830
oh i know not everyone shares this but
Windows 10 enterprise has been great for

491
00:40:17,830 --> 00:40:18,640
me

492
00:40:18,640 --> 00:40:26,170
oh really good really good experience
with that you know using local p.m. we

493
00:40:26,170 --> 00:40:29,800
don't have a dual monitors in a dock and
the audio microphone and copy space

494
00:40:29,800 --> 00:40:32,200
between hosting bm's

495
00:40:32,200 --> 00:40:38,049
ingrate also hyper-v networking has been
great you can easily put the answer in

496
00:40:38,050 --> 00:40:42,670
two different view and you can change
from the private network to the wired

497
00:40:42,670 --> 00:40:44,200
network wireless network

498
00:40:44,200 --> 00:40:48,759
I had really good luck with all that but
i'm not going to say that deploying

499
00:40:48,760 --> 00:40:52,240
pause going to make anything easier for
you

500
00:40:52,240 --> 00:40:59,109
you know it really is a dramatic shift
in the date of most IT admins and you

501
00:40:59,109 --> 00:41:03,098
know even for a small company you don't
have a handful or couple of IT people

502
00:41:03,099 --> 00:41:06,880
the number of privileged accounts you
have to manage is can be seen kind of

503
00:41:06,880 --> 00:41:12,730
daunting and I haven't found myself kind
of swearing at myself for making me

504
00:41:12,730 --> 00:41:18,579
making myself do this but you know just
you get used to it after a while and the

505
00:41:18,579 --> 00:41:23,950
benefits are definitely worth it if you
care about security environment so even

506
00:41:23,950 --> 00:41:27,520
if you you know if you need just have to
figure out what works for you so if you

507
00:41:27,520 --> 00:41:31,000
need you can't remember all those
passwords yourself you might want to

508
00:41:31,000 --> 00:41:35,020
think about enterprise password project
something you're obviously going to put

509
00:41:35,020 --> 00:41:38,770
away the risk of that as well but you
just need to figure out what works for

510
00:41:38,770 --> 00:41:45,009
you and your your decision also you're
gonna probably want enabling internal

511
00:41:45,010 --> 00:41:50,710
web browsing is it probably managing no
weapons of systems on your network and

512
00:41:50,710 --> 00:41:56,410
if you do that if you walk in and
browsing with proxy settings policy one

513
00:41:56,410 --> 00:42:00,160
way to do that is the proxy override the
policy-setting and also i found it

514
00:42:00,160 --> 00:42:06,520
useful to script virtual switch config
changes in title using powershell like

515
00:42:06,520 --> 00:42:10,930
switching locations shape scripting
those things making a password

516
00:42:13,119 --> 00:42:16,930
ok so that's kind of the pot appointment
i'm gonna switch gears here a little bit

517
00:42:16,930 --> 00:42:21,069
and talk about other things you can do
to women exposed to potential that and I

518
00:42:21,069 --> 00:42:25,810
don't move and first one here being
network segmentation and you know I i

519
00:42:25,810 --> 00:42:32,470
kinda compared college access
workstations 22 network segmentation at

520
00:42:32,470 --> 00:42:37,930
you know it's a theory they're similar
but they're also have also found to my

521
00:42:37,930 --> 00:42:42,520
appointment that they also pair well
with network segmentation so you know if

522
00:42:42,520 --> 00:42:44,820
in this in this

523
00:42:44,820 --> 00:42:49,800
Campbell here we have three offices in
each office has a different subnet four

524
00:42:49,800 --> 00:42:56,700
different user groups you've got legal
accounting HR and IT and you know if you

525
00:42:56,700 --> 00:42:59,310
start talking about network security
segmentation you start thinking about

526
00:42:59,310 --> 00:43:04,770
things like okay like counting users
inside wanna do those pcs need to talk

527
00:43:04,770 --> 00:43:11,040
to other users in accounting inside one
you know I don't know depends on the

528
00:43:11,040 --> 00:43:16,380
business that could be a reason but
probably not another situation would be

529
00:43:16,380 --> 00:43:21,780
like my users in legal and like three
they need to walk any of those computers

530
00:43:21,780 --> 00:43:26,550
be to be able to talk to any other
computers in any of that coming subnets

531
00:43:26,550 --> 00:43:30,360
you know maybe but if they do why do
they

532
00:43:31,080 --> 00:43:34,560
and can we figure out a workaround so
they don't have to they don't have to

533
00:43:34,560 --> 00:43:38,700
talk directly to each other it now
example that would be like if your legal

534
00:43:38,700 --> 00:43:43,859
users inside 3i like to share screens
and help each other out with the legal

535
00:43:43,860 --> 00:43:48,180
users inside one maybe you can use some
kind of cloud remote support service so

536
00:43:48,180 --> 00:43:52,109
that they can still be each other's
screens but they don't have to talk

537
00:43:52,110 --> 00:43:56,670
directly back and forth to each other
that would be a workaround so that you

538
00:43:56,670 --> 00:44:04,050
can still segment those networks now one
way to do that never segmentation is to

539
00:44:04,050 --> 00:44:10,380
use layer-3 ACL of the router level 2 to
block access from each subnet from each

540
00:44:10,380 --> 00:44:13,110
other and then use do anything else

541
00:44:13,110 --> 00:44:18,960
switch sides switch little hole so that
users within the same VLAN can't talk to

542
00:44:18,960 --> 00:44:24,930
each other and save you in so in an
ideal an ideal situation here your your

543
00:44:24,930 --> 00:44:30,870
legal users inside one would be able to
talk to any computers in any of the

544
00:44:30,870 --> 00:44:36,240
counting subnets any computers in any of
the HR subnets or even any other

545
00:44:36,240 --> 00:44:41,160
computers in any of the legal subnets
and what they know and obviously still

546
00:44:41,160 --> 00:44:44,330
be able to get the servers so that they
need to hit

547
00:44:44,330 --> 00:44:53,360
and and you know obviously need to hit
the IT subjects to be managed my key so

548
00:44:53,360 --> 00:44:57,770
I was just thinking about those things
you know if you drop an attacker into an

549
00:44:57,770 --> 00:45:01,580
environment where they can talk to any
other user workstations I think you're

550
00:45:01,580 --> 00:45:06,140
going to make my job harder and it's on
top of that you're doing some of these

551
00:45:06,140 --> 00:45:10,430
control so many potential left you're
gonna you're gonna make the job even

552
00:45:10,430 --> 00:45:16,490
harder so does invest that kind of logic
there some other things you can do to

553
00:45:16,490 --> 00:45:21,740
limit the potential left or specifically
lateral movement in this case I'll

554
00:45:21,740 --> 00:45:25,310
randomized you look like a glance you
something like Microsoft lapses in where

555
00:45:25,310 --> 00:45:32,120
I in that would that mean kaskapi they
give you a couple new SIDS user sits so

556
00:45:32,120 --> 00:45:38,870
you can use the local account therefore
it says s 1s 5s 13 locale that's going

557
00:45:38,870 --> 00:45:44,180
to be you can use that to deny logon
network logon to other systems so that

558
00:45:44,180 --> 00:45:48,890
in a first example where you don't
potentials and you move laterally with

559
00:45:48,890 --> 00:45:53,299
local accounts that will know how that
as a huge quickly and you're not doing

560
00:45:53,300 --> 00:45:56,300
that I make sure you go home and do that
right away

561
00:45:57,410 --> 00:46:02,240
also you can disable on the lnternet
vials if you familiar with like

562
00:46:02,240 --> 00:46:06,709
responder and how it works you can see
obviously going to want to limit your

563
00:46:06,710 --> 00:46:12,650
service top villages so as to as little
as possible and use manuscripts account

564
00:46:12,650 --> 00:46:20,810
whenever you can and you can you don't
want to force into mb2 and if you can

565
00:46:20,810 --> 00:46:23,810
disable some people say disabled in
Thailand altogether

566
00:46:24,380 --> 00:46:29,420
I think that's great if you can not
everybody can probably do that so you

567
00:46:29,420 --> 00:46:40,220
want at least for porcelain v2 and so it
comes to kind of wrap up here you hear

568
00:46:40,220 --> 00:46:45,049
people talking all the time of all the
next-gen clients your sophomore that

569
00:46:45,050 --> 00:46:49,760
stops every threat on demand and has
machine learning

570
00:46:49,760 --> 00:46:55,730
Union apt detection and probably why
you're asking stuff ready to oh you know

571
00:46:55,730 --> 00:47:01,400
it's so those are sales and marketing
people those companies are really good

572
00:47:01,400 --> 00:47:05,390
at what they do that got really sexy
graphics and everything is so much

573
00:47:05,390 --> 00:47:10,279
easier to go find one of those things
wrapped in your network and then say

574
00:47:10,280 --> 00:47:14,060
alright we're good we're protected let's
go to lunch guys you know when to really

575
00:47:14,060 --> 00:47:19,430
sit down and truly understand the risk
that you're dealing with and you know

576
00:47:19,430 --> 00:47:24,770
learning from some offensive guys taking
their tools and trying to let Holly were

577
00:47:24,770 --> 00:47:29,750
thinking you know things like power
company don't you know when most things

578
00:47:29,750 --> 00:47:36,200
on your own mini-me cats rentals on your
network and use them to try to figure

579
00:47:36,200 --> 00:47:39,890
out how they were not necessarily
blocking those tools to figure out how

580
00:47:39,890 --> 00:47:46,339
those tools work you know finding your
weak points building walls said trips as

581
00:47:46,340 --> 00:47:51,110
many trip wires as you can and plug the
point of all the best you can so

582
00:47:52,040 --> 00:47:56,540
oh just want to say thank you to watch
people on Twitter that stuff with me

583
00:47:56,540 --> 00:48:00,320
asking dumb questions after blue team
and these are definitely people with

584
00:48:00,320 --> 00:48:08,540
people ball also well did mention Carlos
Perez but also fought him a lot of good

585
00:48:08,540 --> 00:48:13,940
stuff there and uh i also want to
mention breaks that podcast and

586
00:48:13,940 --> 00:48:20,750
offensive security podcast really good
start with your booty work so it all the

587
00:48:20,750 --> 00:48:24,320
time we've got three minutes for
questions

588
00:48:29,600 --> 00:48:36,110
yes the believe in you

589
00:48:45,410 --> 00:48:54,049
organization i'm not doing much as these
switches and I mostly work with this

590
00:48:54,050 --> 00:49:00,440
gold hardware switches and actually on
the slide back there's a config you an

591
00:49:00,440 --> 00:49:14,750
ACL and that's what i use and all that
sounds like a kind of a more specific

592
00:49:14,750 --> 00:49:19,100
question for any organization I i can I
don't have an answer for that

593
00:49:19,100 --> 00:49:23,870
alright alright well thanks everybody
for coming

