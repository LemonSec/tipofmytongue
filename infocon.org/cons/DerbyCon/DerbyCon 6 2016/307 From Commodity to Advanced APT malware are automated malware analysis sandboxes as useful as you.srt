1
00:00:00,000 --> 00:00:05,609
big large four rooms were competing with
the alcoholism downstairs so if you have

2
00:00:05,609 --> 00:00:09,059
a really interesting question in regards
to the topic on the slide go ahead and

3
00:00:09,059 --> 00:00:12,928
stop me will try to answer it in the
form ask your question form of a quick

4
00:00:12,929 --> 00:00:17,670
statement i'll answer or expand upon it
as a part of the slide and if your

5
00:00:17,670 --> 00:00:21,960
question is good and compelling then
we'll toss you a t-shirt so will you

6
00:00:21,960 --> 00:00:26,609
know your your search sighs if I i say
t-shirt and my entourage down here we'll

7
00:00:26,609 --> 00:00:28,500
get your shirt

8
00:00:28,500 --> 00:00:31,859
we do have another one mr. better would
you stand up and demonstrate the other

9
00:00:31,859 --> 00:00:35,640
shirts you'll have to potentially make a
choice and we can bring it with us

10
00:00:36,149 --> 00:00:40,710
that's why you're still sitting i'll
make you stand in a second actually make

11
00:00:40,710 --> 00:00:45,239
you stand now so for those many people
here listen to breaking down security IC

12
00:00:45,239 --> 00:00:45,959
like wow

13
00:00:45,960 --> 00:00:49,980
actually there's like ten hands up so
stand up you to this is breaking down

14
00:00:49,980 --> 00:00:53,849
securities Brian break on the left and a
very bright yellow shirt want to get

15
00:00:53,850 --> 00:00:58,170
attacked by bees and then my colleague
and and business partner Brian pitcher

16
00:00:58,170 --> 00:01:01,410
so if you have a listen to bring down
security i really recommend you do

17
00:01:01,410 --> 00:01:07,380
hacker Jane is my blog so he failed at
first test question and the

18
00:01:07,380 --> 00:01:14,548
unfortunately put this one up there so I
couldn't ask the second question so our

19
00:01:14,549 --> 00:01:19,470
is obviously involves it never changes
anybody here was in the man you talked

20
00:01:19,470 --> 00:01:24,539
we talked about the b-29 stuff anybody
what was in that that's really

21
00:01:24,540 --> 00:01:30,270
appropriate for this talk to so it's
gonna be interesting to see but clearly

22
00:01:30,270 --> 00:01:33,839
you saw the fact they have over a
thousand different samples or a thousand

23
00:01:33,840 --> 00:01:38,759
hashes of roughly what it basically said
10 different types of malware nine of

24
00:01:38,759 --> 00:01:43,200
which were similar and of all that there
were a thousand hashes right so now

25
00:01:43,200 --> 00:01:47,700
we're involves and now obviously by
design so we must evolve Darwin says so

26
00:01:47,700 --> 00:01:48,960
right evolve or die

27
00:01:48,960 --> 00:01:53,520
well or evolving it breached anyway
because you know if we get breached we

28
00:01:53,520 --> 00:01:57,420
know that means energy e how many people
here know what energy is there okay

29
00:01:57,420 --> 00:02:01,920
regimented resume generating event I i
say this kiddingly but i'm actually

30
00:02:01,920 --> 00:02:02,820
quite serious

31
00:02:02,820 --> 00:02:09,239
what is the first thing you should do in
an actual breach updated resume he gets

32
00:02:09,239 --> 00:02:10,080
a shirt

33
00:02:10,080 --> 00:02:18,270
what size which one you want medium
krebs alright Brian try to carry that

34
00:02:18,270 --> 00:02:21,660
for you that is important because i've
been involved with several large

35
00:02:21,660 --> 00:02:27,359
breeches and I don't work for and I are
firm on the blue team defender and and

36
00:02:27,360 --> 00:02:32,040
all that so i had to deal with the
mansions of the world and whatnot and it

37
00:02:32,040 --> 00:02:36,900
turns out very logical or instrument
article management suddenly it was

38
00:02:36,900 --> 00:02:40,140
rational most the time that goes out the
window when a breach occurs the

39
00:02:40,140 --> 00:02:43,619
rationality comes and so really for us
are people you should really always be

40
00:02:43,620 --> 00:02:46,920
prepared for this we potentially can be
scapegoated something resume as much

41
00:02:46,920 --> 00:02:53,670
it's funny it's actually pretty serious
comment you obviously is endless example

42
00:02:53,670 --> 00:02:57,780
of how many people been laid off and of
course the breach and of course we're

43
00:02:57,780 --> 00:03:01,950
here all because we want to catch the
bad guys we all going to recognize these

44
00:03:01,950 --> 00:03:06,899
guys these characters here obviously
been ten with not powershell Carlos with

45
00:03:06,900 --> 00:03:11,280
all his medical aid food former HP
colleague of mine and are our host dave

46
00:03:11,280 --> 00:03:15,090
Kennedy as well and Kevin one of the
sponsors out here with his pen testing

47
00:03:15,090 --> 00:03:19,320
apparently i need to update that picture
because now he's handing out the storm

48
00:03:19,320 --> 00:03:22,530
trooper version of his outfits I guess
he's decided to go from red to white

49
00:03:22,530 --> 00:03:28,260
maybe because he's expanding out of
pentesting not sure what a sandbox

50
00:03:28,260 --> 00:03:33,780
analysis how many people here actually
use sandbox in some capacity in what

51
00:03:33,780 --> 00:03:34,440
they do

52
00:03:34,440 --> 00:03:37,620
alright so about half of you actually
all of you use it right so use anything

53
00:03:37,620 --> 00:03:41,130
on the internet you're using a sandbox
anything vm is a sandbox in certain

54
00:03:41,130 --> 00:03:42,299
aspects right there

55
00:03:42,300 --> 00:03:47,700
virtual machines and so we all have used
as many people uploaded hashes or palos

56
00:03:47,700 --> 00:03:52,560
de virustotal that's a hand box payload
security or cool sandbox or malware

57
00:03:52,560 --> 00:03:59,070
these are all sandboxes just for the
most part you have a piece of our you

58
00:03:59,070 --> 00:04:02,850
want to basically analyze it very
quickly so this is something from maybe

59
00:04:02,850 --> 00:04:06,570
an email or web surfing or you find an
artifact on the box or you're involved

60
00:04:06,570 --> 00:04:10,920
in something like Manuel was talking
about with apt 29 and so you need to be

61
00:04:10,920 --> 00:04:14,910
able to upload the stuff and get some
sort of information and and you want to

62
00:04:14,910 --> 00:04:18,810
get this information fairly rapidly and
you also want to be somewhat accurate

63
00:04:19,310 --> 00:04:23,540
so use cloud-based solutions because i
don't have the infrastructure so I'm

64
00:04:23,540 --> 00:04:27,740
just going to upload my payload to one
of many that are there and I'm gonna go

65
00:04:27,740 --> 00:04:31,880
ahead and see what the results are you
can also roll your own right so you can

66
00:04:31,880 --> 00:04:36,169
go download cool sandbox and build your
own infrastructure they are built on the

67
00:04:36,169 --> 00:04:44,690
virtual machines not hardware bare bones
or or or their hardware so you basically

68
00:04:44,690 --> 00:04:49,969
are already not looking like the thing
that the malaria is potentially wrote

69
00:04:49,970 --> 00:04:54,110
their mouth for so you're not exactly
mimicking what you have in your

70
00:04:54,110 --> 00:04:57,200
production environment unless of course
you're in an esxi arts and whatnot

71
00:04:57,200 --> 00:04:59,870
whatnot environment and again

72
00:04:59,870 --> 00:05:03,139
also these cloud solutions are being
heavily used in email gateways and

73
00:05:03,139 --> 00:05:07,669
next-gen firewall is palo alto service
at on Sourcefire has a service and on

74
00:05:07,669 --> 00:05:14,060
Mac these semantic all these people have
add-ons for the email gateway as a web

75
00:05:14,060 --> 00:05:18,020
proxies fire I for example etc all those
are considered sandbox type solutions

76
00:05:18,020 --> 00:05:23,299
from my description and some even do
automated reversing which is a little

77
00:05:23,300 --> 00:05:27,650
bit of a slap from the typical analysis
most analysis of just detonate see what

78
00:05:27,650 --> 00:05:30,710
happened determine whether or not
malicious or not and give you back some

79
00:05:30,710 --> 00:05:35,599
information there are some free
solutions so hybrid analysis or payload

80
00:05:35,600 --> 00:05:38,900
securities 32-bit free solution many
people here played with that or use it

81
00:05:38,900 --> 00:05:44,150
you know not bad do some information on
our common is really well known from the

82
00:05:44,150 --> 00:05:49,039
space so again all these are free Komodo
announced Komodo so I'm sure should be

83
00:05:49,039 --> 00:05:54,050
on here that deep is and thread expert
VI check is Canadian one and that's much

84
00:05:54,050 --> 00:05:57,979
a fan of that one and then of course we
gotta consider virustotal now and talk a

85
00:05:57,979 --> 00:06:01,460
little bit about that as we get going
and then if you want updates on to give

86
00:06:01,460 --> 00:06:03,770
you the link that's the thing that
really pay attention to your other than

87
00:06:03,770 --> 00:06:08,060
espresso will be obviously recorded as
well as its streaming for those that are

88
00:06:08,060 --> 00:06:12,139
there and and for I guess not Mike
slovak who gave me the idea of the

89
00:06:12,139 --> 00:06:17,330
standing ovation shout out to you for
giving that hilarious little bit about

90
00:06:17,330 --> 00:06:20,960
any little Seltzer publishes the stuff
that keeps it update so i highly

91
00:06:20,960 --> 00:06:25,280
recommend for this area that you look at
Lenny's shelters information and give

92
00:06:25,280 --> 00:06:28,929
you URL there so I also post these in my
slideshare so you just go

93
00:06:28,930 --> 00:06:32,500
hunt for login dior member archaeology
will be able to get my president PDF

94
00:06:32,500 --> 00:06:38,110
page solutions payload security again
the paid version you can actually see

95
00:06:38,110 --> 00:06:41,680
what they don't give you the free
version and potentially will expose the

96
00:06:41,680 --> 00:06:46,660
paid version and so you will have to pay
for the service joe sandbox serious

97
00:06:46,660 --> 00:06:50,620
overhaul and his stuff in the last
couple years and so there's a lot of

98
00:06:50,620 --> 00:06:54,039
information there the graphs and whatnot
are pretty colorful definitely take a

99
00:06:54,039 --> 00:06:57,490
look at register for an account you can
just upload at the register and then

100
00:06:57,490 --> 00:07:00,550
last line is a paid service as well

101
00:07:00,550 --> 00:07:03,580
login he will be integrated within the
future we'll talk about that a little

102
00:07:03,580 --> 00:07:05,080
bit

103
00:07:05,080 --> 00:07:07,810
it used to be known as the newest labs
many people have ever heard her play the

104
00:07:07,810 --> 00:07:11,830
newest stuff it's actually have a slight
shot of it but they've taken offline now

105
00:07:11,830 --> 00:07:17,109
because they're focusing at the paid
service binary guard again paid service

106
00:07:17,110 --> 00:07:21,250
but it does detonate on bare metal it's
gonna be important . as we move forward

107
00:07:21,250 --> 00:07:25,509
and three track as well as paid and
again Lenny keeps a nice maintain sites

108
00:07:25,509 --> 00:07:31,780
really like that and again you can roll
your own so many people here built cool

109
00:07:31,780 --> 00:07:34,780
sandbox or some semblance of something
similar

110
00:07:35,530 --> 00:07:38,349
you think you think pretty much and
there's actually could talk to hear

111
00:07:38,349 --> 00:07:44,199
about using esxi and some kit in attend
the talk but I did tell somebody to sit

112
00:07:44,199 --> 00:07:48,370
next to my saws notes on like that you
really did come to my talk because you

113
00:07:48,370 --> 00:07:51,340
build your own but is it really
mimicking what the mountain areans wrote

114
00:07:51,340 --> 00:07:55,900
their stuff to attack and so you have to
actually ask yourself a question that

115
00:07:55,900 --> 00:08:01,090
you can see why maybe that's not a good
idea but rednecks ladies else's complete

116
00:08:01,090 --> 00:08:06,310
environment of dns in mail and all the
services you can mimic we're talking

117
00:08:06,310 --> 00:08:10,509
serious stuff but again it is a virtual
environment isn't actually production so

118
00:08:10,509 --> 00:08:14,740
if the Marines are at all smart they
really want to do avoidance probably

119
00:08:14,740 --> 00:08:19,630
like the man in apt talk where some of
their tools they interfered with this

120
00:08:19,630 --> 00:08:23,050
probably won't work too well because
they'll know about it right and also

121
00:08:23,050 --> 00:08:26,259
these are all very time-consuming as
opposed to trying to get stuff done

122
00:08:26,259 --> 00:08:31,780
quickly 2014 linux Buster sandbox and
now here is another one and again Lenny

123
00:08:31,780 --> 00:08:35,709
keeps nice list of this but you also
could build in

124
00:08:35,710 --> 00:08:40,120
in rackspace or Amazon or anywhere else
you could build a cloud server with your

125
00:08:40,120 --> 00:08:44,049
own configuration however you want and
again you can use one of these solutions

126
00:08:44,049 --> 00:08:50,530
to do it so it's matt manual analysis
now this is my definition because there

127
00:08:50,530 --> 00:08:55,209
has been training here this week and and
so that is a former amount of manual

128
00:08:55,210 --> 00:09:00,280
analysis but my definition personally is
the evaluation of our on a bare bones or

129
00:09:00,280 --> 00:09:05,949
bare metal system to exactly mimic what
is used in production no virtual

130
00:09:05,950 --> 00:09:10,120
machines no cloud but you might build
one to mimic the vm environment like

131
00:09:10,120 --> 00:09:14,890
esxi oars and hyper-v rate abs or
whatever right so there are cases where

132
00:09:14,890 --> 00:09:20,020
you will move to vm but i'm saying only
when that is a production environment is

133
00:09:20,020 --> 00:09:25,630
so you want to mimic exactly what you
have and that's the point here right

134
00:09:25,630 --> 00:09:29,439
the vm stuff if you're running on bare
bones is not the same thing

135
00:09:29,440 --> 00:09:34,690
Mauer will act differently and then can
you do this within an hour right the

136
00:09:34,690 --> 00:09:39,430
whole the whole goal here when I teach
our discovery and basically our analysis

137
00:09:39,430 --> 00:09:46,150
is rapid change right the horizon dr
report showed that you're compromising

138
00:09:46,150 --> 00:09:50,050
minutes in your data starts exhaling in
days which means is blue team defenders

139
00:09:50,050 --> 00:09:54,130
are people we have to respond within an
hour or within hours so the goal of

140
00:09:54,130 --> 00:09:57,640
everything I teach everything I talk
about is can you do this quickly in

141
00:09:57,640 --> 00:10:01,210
under an hour and some people are like
we can do this another hour

142
00:10:01,210 --> 00:10:07,480
yeah you can actually talk about how to
do that so again you detonate them our

143
00:10:07,480 --> 00:10:09,820
you find the sample however you get it

144
00:10:09,820 --> 00:10:12,820
I was involved with a big Chinese
hacking the gaming industry called winnt

145
00:10:12,820 --> 00:10:16,690
I in some cases we have to collect the
artifacts place them in the same

146
00:10:16,690 --> 00:10:20,770
locations and then invoke how they got
involved dll sideloading things like

147
00:10:20,770 --> 00:10:24,880
that where I just login to explore it
loads the dll boom infected but however

148
00:10:24,880 --> 00:10:28,480
you want to detonate that my wherever
you can get an hour and that's what

149
00:10:28,480 --> 00:10:29,170
you're after

150
00:10:29,170 --> 00:10:33,459
thereafter mimic what it is that got the
box infected and use whatever tools you

151
00:10:33,460 --> 00:10:34,030
want

152
00:10:34,030 --> 00:10:37,420
now granted I have a small subset I
think people should concentrate on and

153
00:10:37,420 --> 00:10:41,469
again i have a basic training course of
our discovery basic analysis and biting

154
00:10:41,470 --> 00:10:45,520
Taylor the tailor who Decker's again he
got selected to do the advance our

155
00:10:45,520 --> 00:10:47,079
analysis training this week

156
00:10:47,080 --> 00:10:48,410
anybody here tennis training

157
00:10:48,410 --> 00:10:53,660
great stuff get a grip was there and so
him and I always share stuff you heard

158
00:10:53,660 --> 00:10:55,639
me mention my stuff in his class

159
00:10:55,639 --> 00:11:01,879
I understand and so again he's the next
step what I teach I'm somebody for

160
00:11:01,879 --> 00:11:06,829
getting selected target and we're gonna
get here to get this training here you

161
00:11:06,829 --> 00:11:10,910
see the treatment were like it's
designed ok and she got to think about

162
00:11:10,910 --> 00:11:15,290
what how did they designed this malware
may not know until you actually do the

163
00:11:15,290 --> 00:11:21,349
analysis but you should take this
seriously into account in most markets

164
00:11:21,350 --> 00:11:25,970
going to be designed to detonate on bare
bones or bare metal boxes has anybody

165
00:11:25,970 --> 00:11:30,889
done any analysis where they drop a
piece of our in a vm and it doesn't run

166
00:11:30,889 --> 00:11:32,360
like you think you should

167
00:11:32,360 --> 00:11:38,389
ok so a few years your hands which means
yeah we've seen this I read reports that

168
00:11:38,389 --> 00:11:43,459
some our up to thirty percent is now
auto v am aware now it's at thirty

169
00:11:43,459 --> 00:11:45,050
percent that means it's on

170
00:11:45,050 --> 00:11:48,589
obviously the increase because it didn't
used to do that very often i had

171
00:11:48,589 --> 00:11:52,670
multiple versions of windy I where I'd
detonated the vm turn around and do

172
00:11:52,670 --> 00:11:56,509
something can turn around and it's all
gone and so the Chinese are very good at

173
00:11:56,509 --> 00:12:00,860
saying ah you're trying to evaluate me I
am NOT going to execute and so really

174
00:12:00,860 --> 00:12:05,269
bare bones manual analysis to me means
bare-bones whatever toolset do it with

175
00:12:05,269 --> 00:12:11,449
under an hour so really what's the
difference the future so I prediction is

176
00:12:11,449 --> 00:12:14,359
cloud-based solutions the ones I
mentioned the list I gave you the stuff

177
00:12:14,360 --> 00:12:18,589
that Lenny lets down his website will
need to have bare-bones bare-metal

178
00:12:18,589 --> 00:12:23,329
options for you to deal with them our
that specifically designed for those

179
00:12:23,329 --> 00:12:24,800
environments

180
00:12:24,800 --> 00:12:29,389
I also think they're gonna have to
evolve to have or send you to a Zen

181
00:12:29,389 --> 00:12:33,439
environment is excited us hyper-v
whatever based on what you have so you

182
00:12:33,439 --> 00:12:36,800
get these about an hour on a box
investigating its on hyper-v environment

183
00:12:36,800 --> 00:12:41,029
and let's say you've decided it is an
adversarial not just commodity stuff you

184
00:12:41,029 --> 00:12:45,079
will probably have to analyze that and
hyper-v environment future

185
00:12:45,079 --> 00:12:49,099
I'm so i think that is the move of the
malaria's to try to refer to reduce your

186
00:12:49,100 --> 00:12:50,120
ability to analyze

187
00:12:50,120 --> 00:12:54,920
our we're seeing it with commodity stuff
already it's really quite surprising and

188
00:12:54,920 --> 00:12:58,400
again our will evolve to detonate only
what was written for they will figure

189
00:12:58,400 --> 00:13:02,480
out what to write stuff they buy all the
stuff we do and they're using all the

190
00:13:02,480 --> 00:13:06,650
stuff we do and they're gonna get
bypasses for all that and again all

191
00:13:06,650 --> 00:13:11,990
overweight everybody's analysis so many
people here run an email gateway

192
00:13:11,990 --> 00:13:17,630
everybody has an email gateway with
gmail your own personal stuff no worries

193
00:13:17,630 --> 00:13:19,850
my hand afraid was gonna say next

194
00:13:19,850 --> 00:13:24,260
so one of the things about this talk
which was kind of joke better and I were

195
00:13:24,260 --> 00:13:27,680
saying we can talk there because i don't
want to do that cloud analysis versus

196
00:13:27,680 --> 00:13:32,900
manual analysis and so much better or
different the manual too clouded and in

197
00:13:32,900 --> 00:13:38,750
this shows up so i'm going to disclose a
vulnerability with a very large cloud

198
00:13:38,750 --> 00:13:40,610
provider serious flaw

199
00:13:40,610 --> 00:13:47,330
there's actually two now registered
defects with the product and so there

200
00:13:47,330 --> 00:13:47,960
you go

201
00:13:47,960 --> 00:13:50,420
we are gonna have some fun and picking
out a vendor I'm not gonna mention

202
00:13:50,420 --> 00:13:53,360
vendor or anything else you have to
figure it out for yourself

203
00:13:53,360 --> 00:13:57,740
I don't wanna be that much of a douche
but nevertheless I think it's important

204
00:13:57,740 --> 00:14:01,339
because it drives the point home with
the presentation and what we are seeing

205
00:14:01,339 --> 00:14:04,010
as I our people are more and more

206
00:14:04,010 --> 00:14:07,069
okay we got fax typical fish facts

207
00:14:07,070 --> 00:14:12,140
seriously that's so nineties i mean come
on it's 2016 many people here actually

208
00:14:12,140 --> 00:14:13,790
facts anything anymore

209
00:14:13,790 --> 00:14:20,240
anybody oh wow ok then your people all
opened his emails probably it's an efax

210
00:14:20,240 --> 00:14:24,200
as you can sell it was literally just
probably a copy and pasted a real efax

211
00:14:24,200 --> 00:14:29,120
is my guess but unfortunately with the
addition of a word doc and the important

212
00:14:29,120 --> 00:14:32,630
parts to hold onto just from a time
perspective is the date and time of this

213
00:14:32,630 --> 00:14:38,300
so we haven't got this 1 832 very you
know current contract was 18 literally

214
00:14:38,300 --> 00:14:42,020
decked detonated yesterday before we
flew here some of that made into the

215
00:14:42,020 --> 00:14:46,459
present as well because of the
information and in a new feature and so

216
00:14:46,459 --> 00:14:52,219
830 at roughly 11 15 these emails
started coming in and again simple

217
00:14:52,220 --> 00:14:56,150
analysis fast simple analysis is what i
teach people spit on my classes so he

218
00:14:56,150 --> 00:14:56,689
knows

219
00:14:56,690 --> 00:15:05,060
brian has and well frankly seattle soon
cares now and obviously 7-zip if you

220
00:15:05,060 --> 00:15:08,420
have never taken a word doc and just
open it in 7-zip you can see that within

221
00:15:08,420 --> 00:15:13,370
the word doc is a folder called macros
many you see this you now know that this

222
00:15:13,370 --> 00:15:18,620
word contains some sort of bb or macro
capability at this point you can make an

223
00:15:18,620 --> 00:15:22,190
assumption would probably ninety five
percent accuracy short of you have in

224
00:15:22,190 --> 00:15:27,470
some designed for Doc that does this
especially is coming outside in that the

225
00:15:27,470 --> 00:15:31,250
stock is malicious just from this one
step and if you open that folder you can

226
00:15:31,250 --> 00:15:35,540
definitely see vba which is indicating
vegan / visual basic for vbscript

227
00:15:35,540 --> 00:15:40,699
capability so boom already know that
this word doc is bad just from that one

228
00:15:40,700 --> 00:15:45,740
step or I go to the command line because
the security guy use command line there

229
00:15:45,740 --> 00:15:50,600
are some things with duties but most of
us online string out and you can see

230
00:15:50,600 --> 00:15:55,850
efax I just rings efax and look for
macros are no macro or the word macro

231
00:15:55,850 --> 00:15:58,940
and it will come out and give me the
macros you can see in the the second

232
00:15:58,940 --> 00:16:02,840
line and the third line so now I know
just from doing the type command against

233
00:16:02,840 --> 00:16:06,710
a word doc that it has some sort of
macro capabilities in it or look for the

234
00:16:06,710 --> 00:16:10,220
obvious thing which most of these things
do after you enable macros is the

235
00:16:10,220 --> 00:16:14,330
document open which you can just type
the name of that word doc find document

236
00:16:14,330 --> 00:16:19,400
open bam there it is as the as the funny
and non clear information but you now

237
00:16:19,400 --> 00:16:23,720
know that this thing will autorun once
you select enable macros i know this is

238
00:16:23,720 --> 00:16:31,730
bad from a command-line simple simple
analysis there it is so often smile

239
00:16:31,730 --> 00:16:35,690
scanner many people here familiar office
now scanner works pretty well i would

240
00:16:35,690 --> 00:16:40,160
say probably 8020 rule in regards to
analyzing word docs and RTF there's an

241
00:16:40,160 --> 00:16:44,959
RTF scan as well and just running again
mouse office mailscanner as you can see

242
00:16:44,960 --> 00:16:48,320
the / scan it will come up there and
sometimes give you this doesn't work as

243
00:16:48,320 --> 00:16:52,010
well as the info but it will give you a
malicious indicator and if it can and it

244
00:16:52,010 --> 00:16:54,800
clearly knows there's something
delicious in here a lot of times this

245
00:16:54,800 --> 00:16:55,849
does not work

246
00:16:55,850 --> 00:16:58,550
the reason i put this slide I versus the
other one the other one generally always

247
00:16:58,550 --> 00:17:03,349
works is used the info option because it
will extract the vb out of the word doc

248
00:17:03,350 --> 00:17:06,640
create a directory you can actually go
read the vbscript

249
00:17:06,640 --> 00:17:10,930
which is generally really obvious skated
you immediately go what is this you know

250
00:17:10,930 --> 00:17:15,610
you have something bad so again this
doesn't take me very long so in one

251
00:17:15,609 --> 00:17:19,359
minute or less i was able to tell you
this word doc was malicious with very

252
00:17:19,359 --> 00:17:23,260
basic analysis anybody disagrees what I
just showed you is malicious alright so

253
00:17:23,260 --> 00:17:27,730
consensus is definitely bad word dark to
be certain files bad of course we're

254
00:17:27,730 --> 00:17:30,730
gonna detonate the same lab there's
reason to do that which is we're going

255
00:17:30,730 --> 00:17:35,680
to talk about in a second so let's see
what fancy fans email cloud sandbox says

256
00:17:35,680 --> 00:17:39,820
about it so email comes the outside goes
to the S&P gateway is evaluated by the

257
00:17:39,820 --> 00:17:47,020
antivirus and span engine stuff and and
well yea at eight-thirty at 0 2 47

258
00:17:47,020 --> 00:17:52,060
minutes later another copy comes in and
so now 47 minutes after this initial

259
00:17:52,060 --> 00:17:56,530
risks receipt of this email we received
multiple so they come in they're slow

260
00:17:56,530 --> 00:18:00,220
crawl right they don't do the hundred a
time attacks anymore because they

261
00:18:00,220 --> 00:18:03,820
understand the quantity limitations you
can put on gateways so they're slow

262
00:18:03,820 --> 00:18:08,860
crawling every minute 35 hour whatever
and boom there it is the clearly seen by

263
00:18:08,860 --> 00:18:10,959
their the outbreak filters say you're
good

264
00:18:10,960 --> 00:18:16,690
the interim verdict negative the case of
spam is negative and the virus is

265
00:18:16,690 --> 00:18:17,800
negative so right now

266
00:18:17,800 --> 00:18:22,120
all good it's not spans not outbreak
it's not the virus and of course to come

267
00:18:22,120 --> 00:18:25,120
down here in the advanced malware
analysis comes out and says the verdict

268
00:18:25,120 --> 00:18:26,439
is clean

269
00:18:26,440 --> 00:18:32,110
ok i just showed you the files malicious
with some very very simple techniques

270
00:18:32,110 --> 00:18:36,459
and here is a fence fence email gateway
telling you it's perfectly clean

271
00:18:36,460 --> 00:18:39,460
I don't think so

272
00:18:39,460 --> 00:18:43,960
so let's look at a couple more these are
again another word doc another variant

273
00:18:43,960 --> 00:18:48,340
is the fax a document here another copy
we got to a few days of cute little

274
00:18:48,340 --> 00:18:54,879
later this is a showing up at 1149 and
then here's another one and another

275
00:18:54,880 --> 00:18:58,810
solution we got there redelivery
document again the alcoholic the same

276
00:18:58,810 --> 00:19:00,820
both saying they're clean

277
00:19:00,820 --> 00:19:04,810
sorry these are vol track in our
district distributions these are as bad

278
00:19:04,810 --> 00:19:07,899
as bad debts for commodity my work

279
00:19:07,900 --> 00:19:13,690
really amateur and decide or see that
these things are bad so even a be caught

280
00:19:13,690 --> 00:19:18,700
in the case of the bottom sample you can
see here that maybe at some point caught

281
00:19:18,700 --> 00:19:21,940
this I was really quite surprised as we
got this and within an hour

282
00:19:22,540 --> 00:19:28,450
this particular plug-in saw that it was
it was bad this is Rav on the top and

283
00:19:28,450 --> 00:19:32,380
the gateway on the bottom showing that
it's clean but they be sayin ya know I

284
00:19:32,380 --> 00:19:36,250
see it not look and no it is not good
and another sample of autocracy quite a

285
00:19:36,250 --> 00:19:39,760
bit lately attract seems to be the
replacement of products in regards to

286
00:19:39,760 --> 00:19:44,800
the quantity we see this year versus
last year and so again a perfect failure

287
00:19:44,800 --> 00:19:48,580
of Absolution we know generally
initially recorded well over a hundred

288
00:19:48,580 --> 00:19:54,460
thousand dollars to implement is failing
us because it is a cloud-based sandbox

289
00:19:54,460 --> 00:19:59,740
solution so even virustotal Apple
abilities virustotal now keep in mind

290
00:19:59,740 --> 00:20:04,420
when you upload a hashtag virustotal and
you will get back the solution that says

291
00:20:04,420 --> 00:20:07,900
hey I've already seen this or we analyze
it i just said go ahead and show me what

292
00:20:07,900 --> 00:20:11,950
you already have and again eight days
later preparing for this president I'm

293
00:20:11,950 --> 00:20:17,530
gonna head and saw its 2853 I'm and then
I uploaded it saturday again just to see

294
00:20:17,530 --> 00:20:22,030
what changes in a few more creeped in 33
and again we're within a week

295
00:20:22,030 --> 00:20:26,410
it's only nine twenty-two now and bam
you know even virustotal knows things

296
00:20:26,410 --> 00:20:31,810
bad beyond belief and again the track
you notice that the file names are

297
00:20:31,810 --> 00:20:36,429
changed as well upload the hash they've
got the same pelo going out as a million

298
00:20:36,430 --> 00:20:40,720
different versions sometimes the append
your email domain to it they randomized

299
00:20:40,720 --> 00:20:44,380
the number they randomized the name they
put a different image in there like I

300
00:20:44,380 --> 00:20:47,530
saw the efax another one would be
something else that that addresses your

301
00:20:47,530 --> 00:20:52,300
you know defense industry or health care
or manufacturing whatever you are and

302
00:20:52,300 --> 00:20:55,600
they just regurgitate these things by
the tons and so sometimes you'll see the

303
00:20:55,600 --> 00:20:58,570
data does not match what your upload is
so you do have to pay attention you

304
00:20:58,570 --> 00:21:02,290
uploaded a hash not the filename
sometimes that confuses people

305
00:21:02,860 --> 00:21:07,449
so let's see what cloud analysis so now
we know it's bad from a very simple

306
00:21:07,450 --> 00:21:12,400
analysis and we clearly know that Davey
caught one of the variance so at this

307
00:21:12,400 --> 00:21:15,020
point we're wondering what the heck's
going on with this email gateway

308
00:21:15,020 --> 00:21:19,280
so what is the cloud say payload
security reverse . it is the free

309
00:21:19,280 --> 00:21:23,660
version and in here we can see that the
actual file did drop the word doc did

310
00:21:23,660 --> 00:21:27,620
extract an executable it's too small fee
to read but i'm just certainly in fact

311
00:21:27,620 --> 00:21:31,760
that the cloud solutions case the free
solution . security didn't catch it and

312
00:21:31,760 --> 00:21:36,200
it shows you that it did find it and
that it was a extravagan word auto open

313
00:21:36,200 --> 00:21:41,120
document and so right now simple it
tells me there's a executable and b it

314
00:21:41,120 --> 00:21:45,439
is definitely on a run were dark not
just from simple analysis again a little

315
00:21:45,440 --> 00:21:50,660
bit bigger picture you can see that it's
oh I 80 90 x he was dropped and there

316
00:21:50,660 --> 00:21:55,670
were some interesting BTW macro strings
of all of this thing so you're like okay

317
00:21:55,670 --> 00:22:00,050
well i know it's bad have a binary now
great but is that enough

318
00:22:01,130 --> 00:22:05,390
well drilled a little more good
on-screen hybrid and also shows you the

319
00:22:05,390 --> 00:22:10,550
windward actually was the parent of this
process it dropped the oh I 80 90 x c

320
00:22:10,550 --> 00:22:15,800
and then executed another one so now you
know it has two instances as you can see

321
00:22:15,800 --> 00:22:20,720
below DNS request contact jose traffic
not much there again why is that

322
00:22:20,720 --> 00:22:25,190
important to us we'll talk about that in
a minute i also have used in the past to

323
00:22:25,190 --> 00:22:28,970
make sure i covered more solutions some
other analysis when I was evaluating the

324
00:22:28,970 --> 00:22:33,980
solutions because the winter I stuff we
had a lot of samples a lot of options of

325
00:22:33,980 --> 00:22:39,350
word docs we have the actual winnt I apt
and you could DLLs harvest DLLs well

326
00:22:39,350 --> 00:22:43,310
somebody's sandboxes don't have a good
way to upload DLLs that's an area they

327
00:22:43,310 --> 00:22:46,639
are improving in and so initially when I
start uploading all of these are like

328
00:22:46,640 --> 00:22:50,930
and it's not a binary that I can execute
so you're a lock some sort of putting

329
00:22:50,930 --> 00:22:54,920
some ability if you knew what the flags
were to do rundll32 but while the name

330
00:22:54,920 --> 00:22:59,450
of the dll and flag but you have to know
what that is to detonate their an hour

331
00:22:59,450 --> 00:23:03,230
and load it but some are getting better
some of our running scripts they run the

332
00:23:03,230 --> 00:23:06,350
deal through a bunch of options and then
they see they get it up to execute

333
00:23:06,350 --> 00:23:10,969
reversing land is one more expensive
ones that 70 k year they also have a

334
00:23:10,970 --> 00:23:15,680
list of known good lookups if you're
looking for a very good list of known

335
00:23:15,680 --> 00:23:21,320
good lookups about 70k year you can
literally feed it every file and if it's

336
00:23:21,320 --> 00:23:23,460
a Microsoft file or adobe file they have
a room

337
00:23:23,460 --> 00:23:27,270
a good whitelist so tell ya that's good
we know what it is and then you can

338
00:23:27,270 --> 00:23:30,210
filter out that these are unknown and
potentially drill down on analysis of

339
00:23:30,210 --> 00:23:34,350
those but inexpensive solution i had an
interesting time doing it the console is

340
00:23:34,350 --> 00:23:39,600
pretty easy to use but 70k year for just
the detonation part another 70 k for the

341
00:23:39,600 --> 00:23:44,250
whitelist lookups and or black lookups I
thought that was a bit pricey for this

342
00:23:44,250 --> 00:23:47,250
kind of capability Anubis no longer
around

343
00:23:47,970 --> 00:23:51,149
they've been taken down but I did have
it when I was evaluating these for this

344
00:23:51,149 --> 00:23:56,309
particular area for this talk that I was
planning to do before i went ahead and

345
00:23:56,309 --> 00:23:59,520
threw it up here because this is last
line now last line is now the company

346
00:23:59,520 --> 00:24:04,649
that runs a new or took over or newest
initially started out they created a is

347
00:24:04,649 --> 00:24:09,330
for sale version called last night and
then of course malware com a lot of us

348
00:24:09,330 --> 00:24:12,750
have used that a lot of people are
familiar with more calm and again system

349
00:24:12,750 --> 00:24:16,590
output there so you can see that through
some stuff added to see what it does

350
00:24:17,159 --> 00:24:21,120
three experts another one you can see
there real clear and it's kind of

351
00:24:21,120 --> 00:24:25,229
important . immediately russian
federation points out and this is the

352
00:24:25,230 --> 00:24:29,549
kind of stuff as incident responders and
blue teams we want to see this data and

353
00:24:29,549 --> 00:24:32,760
make it more obvious to the person
reviewing and we have a lot of other job

354
00:24:32,760 --> 00:24:36,390
duties are not full-time at this we're
not full-time our analysis people are

355
00:24:36,390 --> 00:24:40,559
not mandiant I need to see these things
stick out at me right he's be obvious

356
00:24:40,559 --> 00:24:45,690
and so I rather like the look and feel
of this joe sandbox done a lot of work

357
00:24:45,690 --> 00:24:48,360
and in their whole GUI infrastructure
really like it

358
00:24:48,360 --> 00:24:53,070
VI check yeah not so much i just kind of
blow by this one but there's some some

359
00:24:53,070 --> 00:24:57,240
cloud providers clearly what payload
showed on that one particular sample and

360
00:24:57,240 --> 00:25:02,010
we can take another look at it in an
amount manual way so we have this cloud

361
00:25:02,010 --> 00:25:07,049
stuff or with sandbox and also be non
cloud and so what we really want out of

362
00:25:07,049 --> 00:25:07,649
this

363
00:25:07,649 --> 00:25:11,789
well I'm an IRB I'm a blue team guy
right I need the information that allows

364
00:25:11,789 --> 00:25:16,260
me to improve my network defenses or
figure out anybody else in the

365
00:25:16,260 --> 00:25:21,270
environment has opened this word doc
accidentally or purposely or by design

366
00:25:21,270 --> 00:25:25,799
socially engineered to open the box and
I need to know possibly how to clean it

367
00:25:25,799 --> 00:25:28,740
i want to know if I can remediate it and
I know there's two things you do you

368
00:25:28,740 --> 00:25:33,240
need to clean it or image but I need to
know this information you are else okay

369
00:25:33,240 --> 00:25:36,720
if I web proxy i might want to block the
stuff i need to know what web

370
00:25:36,720 --> 00:25:42,000
sites are visited any wips so if i get
the IP a piece of our i can then say all

371
00:25:42,000 --> 00:25:46,740
right router devices does anybody else
going to this place oh yeah Bob and Mary

372
00:25:46,740 --> 00:25:50,880
and and Cody went to this place so now i
know who to go look up or issue a ticket

373
00:25:50,880 --> 00:25:56,070
to get visited the filenames if you
don't know what file name is on the box

374
00:25:56,070 --> 00:26:00,870
then how do you know what to look for or
if it's a bit random generated file name

375
00:26:00,870 --> 00:26:04,408
how about the directory is being dropped
in even if thats random you can mount

376
00:26:04,409 --> 00:26:07,950
the pattern that it's being put in
appdata some random name with some

377
00:26:07,950 --> 00:26:11,820
random dxc well you can now go to
AppData look for some random name and

378
00:26:11,820 --> 00:26:15,330
some you know random exe I'm so that's
an important thing for remediation and

379
00:26:15,330 --> 00:26:19,110
clean up the autoruns how does it
launched that's a piece of information I

380
00:26:19,110 --> 00:26:22,830
want to look at my hours at a snake I
need to chop the head off the snake

381
00:26:22,830 --> 00:26:27,480
piece of the body stay behind that's
okay it's not auto running it's not you

382
00:26:27,480 --> 00:26:31,679
know persisting and I've got the main
binaries for the most part move on

383
00:26:31,679 --> 00:26:35,610
not a lot of us can go reimage a
thousand pcs and you know thousand

384
00:26:35,610 --> 00:26:40,350
pieces of our like we heard the man you
project that took 18 months thats that's

385
00:26:40,350 --> 00:26:42,840
an insane project a lot of working out
from there

386
00:26:42,840 --> 00:26:46,649
of course configure patient changes what
did it alter that modify the windows

387
00:26:46,650 --> 00:26:50,580
firewall policies did it change other
registry settings that bork up your

388
00:26:50,580 --> 00:26:53,428
internet explorer and all the various
things that potentially can do the

389
00:26:53,429 --> 00:26:56,730
registry because that's a huge database
of all kinds of settings configurations

390
00:26:56,730 --> 00:27:01,080
like the many guys pointed out the rdp
got enabled so can you detect that

391
00:27:01,080 --> 00:27:03,720
conditions you could turn it back off or
you don't want to leave these things

392
00:27:03,720 --> 00:27:06,750
open in case someone goes starbucks to
start to work in and poof someone's

393
00:27:06,750 --> 00:27:09,510
trying to rdp into the boxes they have a
crappy password because I got

394
00:27:09,510 --> 00:27:13,320
compromised from yahoo so you have to
really understand what those those

395
00:27:13,320 --> 00:27:17,730
settings are metadata these are all
things within the cloud solutions and in

396
00:27:17,730 --> 00:27:21,600
the analysis solutions that tell you a
lot about the file and all the

397
00:27:21,600 --> 00:27:24,539
miscellaneous data that it's somewhat
valuable to help you determine that the

398
00:27:24,539 --> 00:27:28,408
files bad that it's 90 digital
signatures that is signed or not signed

399
00:27:28,409 --> 00:27:32,309
who signed it a chinese company versus
you know American company it's not

400
00:27:32,309 --> 00:27:33,389
signed at all

401
00:27:33,390 --> 00:27:38,340
etc signed by Microsoft yeah it's
probably okay adobe probably okay maybe

402
00:27:38,340 --> 00:27:43,260
it's all this information I'm looking
for the behavior what happened

403
00:27:43,260 --> 00:27:48,180
what had the power detonate what was the
specific commands or things that it did

404
00:27:48,180 --> 00:27:52,140
when it detonated and then potentially
the network info right track . netflow

405
00:27:52,140 --> 00:27:56,970
that you're not going to find so much of
our analysis manual analysis unless

406
00:27:56,970 --> 00:28:00,450
you're going to get into the basically
the packet capture and sniffing like

407
00:28:00,450 --> 00:28:04,320
something like a wireshark i do not have
our shark and do not use wireshark crime

408
00:28:04,320 --> 00:28:09,570
analysis lab I would do that only after
the point i determined man type

409
00:28:09,570 --> 00:28:12,870
situation where it's a really big deal
would occur and then we start getting

410
00:28:12,870 --> 00:28:15,840
into it because the minute they see that
they're gonna kill them our we had this

411
00:28:15,840 --> 00:28:19,530
experience with Chinese frequently we
didn't solve certain tools boom that

412
00:28:19,530 --> 00:28:24,000
shut down there very good at this stuff
just like we are trying to become better

413
00:28:24,660 --> 00:28:29,370
so again what we want to learn what you
want this data we need to know who else

414
00:28:29,370 --> 00:28:33,030
got affected that is a big thing
whenever you look at a piece of our what

415
00:28:33,030 --> 00:28:36,570
can I get out of this thing that I can
execute in a box and how do i take that

416
00:28:36,570 --> 00:28:40,409
information and decide whether Cody is
now infected or break is now infected

417
00:28:41,250 --> 00:28:45,630
what was that it was changed ok why way
to make a decision

418
00:28:46,710 --> 00:28:50,700
image for cleanup how many people here
have a standard reimage for anything

419
00:28:50,700 --> 00:28:53,730
infected don't even don't even bother
trying to clean it up

420
00:28:53,730 --> 00:28:59,700
12345 many people here really do two
quantities or just workload or it's the

421
00:28:59,700 --> 00:29:04,530
CXO or whatever have to actually go man
using stuff up i think probably a lot of

422
00:29:04,530 --> 00:29:08,040
us have been forced to do that so we
have to know both it's not just one of

423
00:29:08,040 --> 00:29:11,340
the other will be awesome your image
thousand pieces but that's just not

424
00:29:11,340 --> 00:29:12,330
reality

425
00:29:12,330 --> 00:29:15,449
so let's see what Manuel analysis can
show us

426
00:29:15,450 --> 00:29:19,560
well artifacts anywhere else so in this
case is little script that I do during

427
00:29:19,560 --> 00:29:25,590
analysis i run it's just ipconfig
display dns i create a little loop that

428
00:29:25,590 --> 00:29:30,149
gets rid of all my whitelisted stuff the
stuff that's normal I'm our lamb and we

429
00:29:30,150 --> 00:29:34,230
can see here that shop techshop tacky
was that particular URL that this ball

430
00:29:34,230 --> 00:29:38,370
track used it happens to be on godaddy
we can also see that the Russian

431
00:29:38,370 --> 00:29:42,030
Federation was included here if I who is
the information i get the russian

432
00:29:42,030 --> 00:29:46,139
federation and so now I had a web
gateway have a piece of information that

433
00:29:46,140 --> 00:29:50,730
i don't necessarily get out of the
sandbox solutions and of course in this

434
00:29:50,730 --> 00:29:53,620
case they reached out to google and that
was

435
00:29:53,620 --> 00:29:59,709
as oddly enough the apt 29 so maybe this
is very Russian thing to do in using

436
00:29:59,710 --> 00:30:03,550
these cloud solutions to either go out
and get the payloads and sucking down or

437
00:30:03,550 --> 00:30:07,840
put payloads up if they're stealing data
and so we see this behavior but that in

438
00:30:07,840 --> 00:30:11,949
itself because Google we really can't
block we really can't act upon it but in

439
00:30:11,950 --> 00:30:16,120
context which will see a little bit it's
very important to understand what was

440
00:30:16,120 --> 00:30:20,110
used in the attack that you can't
necessarily get out of the sandbox

441
00:30:20,110 --> 00:30:21,639
environment

442
00:30:21,640 --> 00:30:27,370
ok the process the artifacts and what's
long straight you want to link the

443
00:30:27,370 --> 00:30:31,959
processes the bad exe what calls what
this is the behavior of the malware you

444
00:30:31,960 --> 00:30:35,020
understand that that word doc was
launched

445
00:30:35,020 --> 00:30:42,070
ok there it is there's the efax and that
the process idea got the 0 x 10 then

446
00:30:42,070 --> 00:30:43,149
respond

447
00:30:43,150 --> 00:30:48,940
oh I 809 which gave now a new process ID
which now can be linked to another

448
00:30:48,940 --> 00:30:52,960
version of it we saw that in the cloud
sandbox solution for sure so we did get

449
00:30:52,960 --> 00:30:58,240
that out of it clearly not the pads or
whatnot we did get the associate did not

450
00:30:58,240 --> 00:31:03,850
get the Association out of the oh I 80
90 xe2 windows 32

451
00:31:04,390 --> 00:31:08,080
ok so this is something that through
doing the manual analysis I now know I

452
00:31:08,080 --> 00:31:11,980
have two files involved i did not get
that out of the payload security

453
00:31:11,980 --> 00:31:16,540
analysis that i did and you can see that
it too loaded multiple times so

454
00:31:16,540 --> 00:31:19,990
different process execution perspective
I don't have two locations one of which

455
00:31:19,990 --> 00:31:25,270
looks like aids in the windows system
folder system 32 or in this case this

456
00:31:25,270 --> 00:31:28,270
while 64 and it is

457
00:31:28,270 --> 00:31:31,059
name something that looks like a normal
windows file which could be missed by a

458
00:31:31,059 --> 00:31:36,100
typical IT guy or or lower end admin
which is what they're trying to do

459
00:31:36,100 --> 00:31:39,760
they're trying to you know office Kate
and get by and so again you know what

460
00:31:39,760 --> 00:31:43,450
you have the IP address information this
is the windows firewall log information

461
00:31:43,450 --> 00:31:47,140
where you get a destination address the
port that's on and then the executable

462
00:31:47,140 --> 00:31:50,860
it's a big advantage of the application
names of the windows firewall is it

463
00:31:50,860 --> 00:31:57,669
gives you not just IPA talk to ipb but
that the application within IP a talk to

464
00:31:57,670 --> 00:32:02,050
i PB which is really powerful in this
case we now have a pit showing windows

465
00:32:02,050 --> 00:32:03,610
32 is involved

466
00:32:03,610 --> 00:32:09,729
and a win32 hosted not show up in the
sandbox cloud environment so we're

467
00:32:09,730 --> 00:32:12,549
getting more information manually then
we definitely did from a cloud or

468
00:32:12,549 --> 00:32:17,049
sandbox environment and again what files
are involved the files we have the

469
00:32:17,049 --> 00:32:20,650
directory names again doesn't matter
what they're named we have an idea where

470
00:32:20,650 --> 00:32:24,790
to look at we need to clean up the file
names are definitely going to alter we

471
00:32:24,790 --> 00:32:28,330
heard again many talking about a
thousand variants of like nine samples

472
00:32:28,330 --> 00:32:31,750
we see it all the time we can detonate
we had right x last year every time you

473
00:32:31,750 --> 00:32:35,890
move The Box not only the folder change
but the file change and the hash change

474
00:32:35,890 --> 00:32:40,630
every reboot so itself propagated a
difference every time you can no longer

475
00:32:40,630 --> 00:32:44,710
look for a hash across your entire
environment that's dead but now we have

476
00:32:44,710 --> 00:32:48,340
locations we can focus on the potential
cleanup for further investigation or

477
00:32:48,340 --> 00:32:52,209
harvesting and again we got something
out of manual analysis we did not get

478
00:32:52,210 --> 00:32:57,340
out of the cloud sandbox solution I find
this very frequent by the way this is a

479
00:32:57,340 --> 00:33:01,720
very common thing it focuses on what's
on top once it gets that but it never

480
00:33:01,720 --> 00:33:05,230
sees the bottom part whether because the
mauers intelligent or not you have to

481
00:33:05,230 --> 00:33:06,549
reverse it to find out

482
00:33:06,549 --> 00:33:10,900
persistence is a big one you gotta know
the head of the snake right what bicha

483
00:33:10,900 --> 00:33:13,960
what's going to reload this thing while
the run key updated manually house is

484
00:33:13,960 --> 00:33:18,970
going to show me that and that windows
32 is the thing that persists not oh I

485
00:33:18,970 --> 00:33:24,490
809 it loads twice does the change and
says okay now windows 32 down here and

486
00:33:24,490 --> 00:33:28,840
go update the persistent autorun key to
launch next time the system rebooted i

487
00:33:28,840 --> 00:33:33,939
did not get that out of the sandbox
analysis either this money people here

488
00:33:33,940 --> 00:33:38,559
use this internal system on tool great
ir i would recommend maybe updating your

489
00:33:38,559 --> 00:33:41,710
log management solution to collect it
and then if you have to put on the box

490
00:33:41,710 --> 00:33:45,910
you don't have to update your your log
management client you can just start it

491
00:33:45,910 --> 00:33:49,809
and then it'll start collecting it
that's a great way to be ready for the

492
00:33:49,809 --> 00:33:54,129
use of it but it gives you a lot more
information system on does great for our

493
00:33:54,130 --> 00:33:58,570
must use in the lab with the
understanding that they can obviously

494
00:33:58,570 --> 00:34:01,899
detected it's there and potentially not
work so be prepared to potentially

495
00:34:01,900 --> 00:34:06,490
remove it and try re-analysis but again
here you can see that oh I 809 was

496
00:34:06,490 --> 00:34:10,659
directly launching through the system
logs the windows 32 and there is the

497
00:34:10,659 --> 00:34:13,490
hash the file but also that the files
now

498
00:34:13,489 --> 00:34:17,989
are the same file just named differently
and putting different places and so

499
00:34:17,989 --> 00:34:22,368
again now analysis through the fact that
system longest eyelashes and logs can

500
00:34:22,369 --> 00:34:25,129
show us that information above and
beyond with the windows logon show us

501
00:34:25,129 --> 00:34:31,069
another script i run i look for very
commonly parentless processes so you saw

502
00:34:31,070 --> 00:34:36,260
in the sandbox solution of payload we
had windward and then oh I don't exe oh

503
00:34:36,260 --> 00:34:39,679
I don't exe right parent-child child

504
00:34:39,679 --> 00:34:42,379
well I always look at these child
processes because generally when the

505
00:34:42,379 --> 00:34:46,219
droppers install and they trigger
something there now parentless that's

506
00:34:46,219 --> 00:34:50,330
not uncommon windows but there's not a
lot of them in windows so I run a script

507
00:34:50,330 --> 00:34:54,020
that looks for this condition once i
find this condition and then upload that

508
00:34:54,020 --> 00:34:56,360
send them the virus total and bam

509
00:34:56,360 --> 00:34:59,570
I a found a parentless process to focus
on girls

510
00:34:59,570 --> 00:35:04,520
regardless of all the other analysis i'm
doing and i now can focus and say hey

511
00:35:04,520 --> 00:35:09,230
and even VT knows it's bad just from the
hash lookups and so again I don't get

512
00:35:09,230 --> 00:35:15,320
that out of a sandbox or cloud solution
and clearly did not get those out of my

513
00:35:15,320 --> 00:35:22,130
email late so it's comparable URLs ip's
URLs yes I got some of those in the

514
00:35:22,130 --> 00:35:25,550
cloud they did have a list of like 45 of
them what they're not was from thread

515
00:35:25,550 --> 00:35:30,680
until or not don't know but there were
was 45 in their manual yes clearly you

516
00:35:30,680 --> 00:35:35,509
saw what actually detonated on our lab
ip's i did not get any IP as you saw

517
00:35:35,510 --> 00:35:40,310
that from the DNS names on the register
on the payload security but yes I

518
00:35:40,310 --> 00:35:43,730
clearly have eye peas as you saw from
russian federation whatnot in my menu

519
00:35:43,730 --> 00:35:49,520
analysis file names i got some oh I 809
i did not get windows 32 or the context

520
00:35:49,520 --> 00:35:53,900
behind that the location so potentially
I would have missed if just relying on

521
00:35:53,900 --> 00:35:59,150
the payload security cloud sandbox I
would have missed the actual persistence

522
00:35:59,150 --> 00:36:03,230
because it did not show up in the evo
and so yes I do see that in manual

523
00:36:03,230 --> 00:36:07,190
analysis if you set the machine to
properly complete changes i did not see

524
00:36:07,190 --> 00:36:09,350
much of that in the in the cloud
solution

525
00:36:09,350 --> 00:36:12,100
yes clearly saw that if you again

526
00:36:12,100 --> 00:36:16,810
thats it look at how we do it with our
metadata there is definitely some

527
00:36:16,810 --> 00:36:21,730
metadata very powerful for that scenario
and sign in fact whether the matter was

528
00:36:21,730 --> 00:36:24,760
signed or not you can see those that you
definitely look for that and then

529
00:36:24,760 --> 00:36:25,870
behavior

530
00:36:25,870 --> 00:36:29,470
the one thing the same boxes will not
give you or the cloud analysis will give

531
00:36:29,470 --> 00:36:32,950
you is the behavior what actually
happened in our case we do our analysis

532
00:36:32,950 --> 00:36:36,430
we see the command line is executed we
see all the scripts that are running we

533
00:36:36,430 --> 00:36:39,910
see the actual behavior through process
command line that's an option windows

534
00:36:39,910 --> 00:36:44,200
and so we get a lot more behavioral
information then travel or practice so

535
00:36:44,200 --> 00:36:47,319
you can see it's pretty clear winner on
the right that manual analysis is much

536
00:36:47,320 --> 00:36:51,520
easier so again paid solutions
definitely work better than the freeones

537
00:36:51,520 --> 00:36:55,720
palos real obvious they hide stuff but
again i don't think it's good enough i

538
00:36:55,720 --> 00:36:58,930
think there's a lot of work to be done
here there are and they are moving

539
00:36:58,930 --> 00:37:02,259
towards doing more bare-bones bare metal
work because they understand that

540
00:37:02,260 --> 00:37:06,220
they're running into this problem so I
know some are working on it and again we

541
00:37:06,220 --> 00:37:10,480
have loaded a lot of samples to these
things and a lot of them just don't

542
00:37:10,480 --> 00:37:14,920
detonate i have a training class that i
showed us at $FULLPHONENUM and let the

543
00:37:14,920 --> 00:37:19,150
class uploaded to the payload and then I
go ahead and detonated on the other lab

544
00:37:19,150 --> 00:37:23,650
we do the comparison with the chart that
you just saw this chart here and it's

545
00:37:23,650 --> 00:37:24,640
pretty obvious

546
00:37:24,640 --> 00:37:29,230
Cody you actually was in that class that
the cloud stuff just doesn't do the same

547
00:37:29,230 --> 00:37:34,630
capability that you can do by yourself
and you can do is get a job and easily

548
00:37:34,630 --> 00:37:38,920
as these cloud solutions do and quickly
too but they're good for multiple

549
00:37:38,920 --> 00:37:43,090
samples so let's take an example where I
have four ransomware samples got time to

550
00:37:43,090 --> 00:37:46,780
detonate this thing is unfortunately
ransomware detonates it encrypts my data

551
00:37:46,780 --> 00:37:50,500
of my scripts so i gotta log in as
different user created bobbed account

552
00:37:50,500 --> 00:37:53,950
login as Bob cover my scripts back on
the box then analyzed the logs

553
00:37:53,950 --> 00:37:56,049
everything boom figure out what's going
on

554
00:37:56,050 --> 00:37:59,620
once i get that data i get an IP address
and whatever and I know that that's are

555
00:37:59,620 --> 00:38:03,310
looking for and it gives me when I'm i
can upload the rest of the samples to

556
00:38:03,310 --> 00:38:07,270
cloud and see if I'm getting the same
info so i can quickly rip through three

557
00:38:07,270 --> 00:38:10,690
of them because ransom was kind of a
pain to analyze from the perspective of

558
00:38:10,690 --> 00:38:14,530
what all your reports and script gets
encrypted in your output scripted and so

559
00:38:14,530 --> 00:38:18,700
it does have some future use for that
multiple samples the same thing if you

560
00:38:18,700 --> 00:38:20,180
know what you're looking for United's

561
00:38:20,180 --> 00:38:23,240
yep clouds give me roughly the same
thing or at least enough of what i need

562
00:38:23,240 --> 00:38:27,348
all these other three four samples of
this of this campaign up there and so it

563
00:38:27,349 --> 00:38:30,589
might have used their for a lot of
people actually say that's probably the

564
00:38:30,589 --> 00:38:35,480
best use for it so we use from our
analysis the manual analysis

565
00:38:35,480 --> 00:38:39,589
well login d i'm wearing a shirt i'm
wearing a hat walking advertisement here

566
00:38:39,589 --> 00:38:44,029
the login lists every tool was designed
specifically for the purpose of quickly

567
00:38:44,030 --> 00:38:48,619
analyzing in working with nnti one of
the biggest problems we had is quickly

568
00:38:48,619 --> 00:38:52,099
being able to look at these samples that
got email to us or that we harvested off

569
00:38:52,099 --> 00:38:56,000
machine to get the IP address
information to get the metadata get the

570
00:38:56,000 --> 00:38:59,990
digital signatures and all the things we
could put into other solutions to say

571
00:38:59,990 --> 00:39:05,209
who else has this and and so we ended up
at one lunch and we wrote it and so

572
00:39:05,210 --> 00:39:09,140
that's that's how we came up with the
idea and again we run the tool it tells

573
00:39:09,140 --> 00:39:11,569
you it's not set on the windows
environment whether you're actually

574
00:39:11,569 --> 00:39:15,050
going into the field and doing this I
are on your systems and or you're doing

575
00:39:15,050 --> 00:39:19,130
in our analysis lab and then it won't
actually click the log until you finish

576
00:39:19,130 --> 00:39:23,030
configuring it and the reports and the
dumps tell you what it is so it answers

577
00:39:23,030 --> 00:39:27,200
the issue what how do i check things and
then I what do I said that's the first

578
00:39:27,200 --> 00:39:32,540
purpose login d it produces an audit
report I'm sample that a second to show

579
00:39:32,540 --> 00:39:36,829
you how you compare to other standard
CIS benchmarks a lot of us have

580
00:39:36,829 --> 00:39:41,540
compliance requirements so you have to
apply that or usg Seabees think that is

581
00:39:41,540 --> 00:39:44,930
like the Stig's or whatnot and then if
you're for the foreigners a lot of

582
00:39:44,930 --> 00:39:48,290
people filed hace standards I we have
those in there as well and then

583
00:39:48,290 --> 00:39:52,670
whitelist to filter out the known good
noise right so we know that this stuff's

584
00:39:52,670 --> 00:39:56,450
our stuff for this stuff is normal for
our particular environment i don't see

585
00:39:56,450 --> 00:39:59,720
that my results so let's put it in white
list we have that ability for you as

586
00:39:59,720 --> 00:40:03,770
well and produces one big massive report
called report dot CSV which

587
00:40:03,770 --> 00:40:07,970
theoretically you could consume into a
log management solution and here's what

588
00:40:07,970 --> 00:40:11,209
the audit report looks like when you
print it out and word and you get the

589
00:40:11,210 --> 00:40:15,320
three columns of the different CSS stuff
then you get the SS and the

590
00:40:15,320 --> 00:40:20,330
yeah and the USCCB in there i just took
it out to fit in the screen and then

591
00:40:20,330 --> 00:40:24,290
what your pc looks like so before you
start using the log personal login ID

592
00:40:24,290 --> 00:40:28,130
you'll get a report to know what to go
set and then notes about it at the

593
00:40:28,130 --> 00:40:31,820
bottom of the report issued the actual
rich keys to tweak and settings to do

594
00:40:31,820 --> 00:40:36,800
and when you run along and finally works
you'll get a summary of the output

595
00:40:36,800 --> 00:40:40,520
really cool so you know if it's got zero
bytes in it they didn't make any changes

596
00:40:40,520 --> 00:40:44,600
that item so just looking at the summary
will give me information of what the

597
00:40:44,600 --> 00:40:48,200
shower might have done you always get
process executions but if you don't see

598
00:40:48,200 --> 00:40:52,549
task schedule something that a b-29
talked about they used heavily use of

599
00:40:52,550 --> 00:40:55,580
the task scheduler if you don't see any
changes in that you know they didn't

600
00:40:55,580 --> 00:40:58,940
have anything there's no far firewall
policy report that you know they didn't

601
00:40:58,940 --> 00:41:02,090
change anything in the federal policy so
very quickly you know we're not to look

602
00:41:02,090 --> 00:41:06,080
as well as you know where to look by
this summary report pretty cool so the

603
00:41:06,080 --> 00:41:09,319
purpose of this is our analysis lab
that's when we first developed for it

604
00:41:09,320 --> 00:41:13,220
turned out had a lot of the purposes
investigate sussex system so we have

605
00:41:13,220 --> 00:41:17,060
people bring their system down we get
login to run properly with the box the

606
00:41:17,060 --> 00:41:18,230
persistent kicks in

607
00:41:18,230 --> 00:41:22,070
it fills the logs and we can get the
data we want to figure out of the box is

608
00:41:22,070 --> 00:41:22,910
infected

609
00:41:22,910 --> 00:41:27,440
it's actually I found somehow a piece of
our the guy got injected a dll into

610
00:41:27,440 --> 00:41:32,180
skype and skype was the thing talking to
this particular bad sinkhole that was

611
00:41:32,180 --> 00:41:36,379
trigger RBS's and so really quickly
within 15-20 minutes i was able to

612
00:41:36,380 --> 00:41:40,370
determine that audit the window system
for those who are auditors that produce

613
00:41:40,370 --> 00:41:44,210
reports like the one you showed you you
can easily run this and say hey don't

614
00:41:44,210 --> 00:41:48,920
get this fixed IT or or customer go turn
the stuff on and again the whole goal

615
00:41:48,920 --> 00:41:52,760
here is to help push and move security
forward blue team members as Carlos

616
00:41:52,760 --> 00:41:57,260
Perez talk about the protein we need to
share this information and help promote

617
00:41:57,260 --> 00:42:00,500
us to move forward if you're gonna have
any chance of catching the guys behind

618
00:42:00,500 --> 00:42:04,070
the beginning of those slides you're
going to have to do this to the box so

619
00:42:04,070 --> 00:42:08,450
that when they get on the box and then
Tanner for Kevin or Carlos or Dave or

620
00:42:08,450 --> 00:42:12,470
anybody else does their food you can
actually see what behavior and nowhere

621
00:42:12,470 --> 00:42:15,830
and what they're doing and so it's
designed really help move security

622
00:42:15,830 --> 00:42:18,299
forward a lot of ways to get those logs
turned on

623
00:42:18,299 --> 00:42:24,420
because many people here have to deal
with the feds and many logs new well

624
00:42:24,420 --> 00:42:28,349
really can't help you much you can give
any logs and ir guy i really can't help

625
00:42:28,349 --> 00:42:31,349
you much you don't get the logs were
talking immediate jump to forensics and

626
00:42:31,349 --> 00:42:35,910
that's why that project eight months
instead of eight weeks and again give I

627
00:42:35,910 --> 00:42:39,808
our folks and the feds what they need a
tool that really helps you you take a

628
00:42:39,809 --> 00:42:44,369
full file and registry snapshot meaning
i can I didn't take a good box or my

629
00:42:44,369 --> 00:42:48,630
particular windows box let's say even if
it's even consultant snapshot it because

630
00:42:48,630 --> 00:42:51,959
windows is pretty much the same across
all systems for the version and then

631
00:42:51,959 --> 00:42:55,828
compare that snapshot to a suspect
system i've thrown out all that no-good

632
00:42:55,829 --> 00:43:00,660
by doing compared these are all good
system on trusting these are the file

633
00:43:00,660 --> 00:43:05,879
differences now I have ass much smaller
list 35,000 files in Windows 750,000

634
00:43:05,880 --> 00:43:06,869
Windows 10

635
00:43:06,869 --> 00:43:11,130
yes double I can throw out probably
ninety percent of those files by doing a

636
00:43:11,130 --> 00:43:15,150
simple file compare registry same thing
register as a lot of changes so he's

637
00:43:15,150 --> 00:43:18,630
gonna be a little bigger output but i
have to look to the entire registry a

638
00:43:18,630 --> 00:43:20,369
lot of keys never change

639
00:43:20,369 --> 00:43:24,630
now I can focus at the keys that have
changed that are added in our reports

640
00:43:24,630 --> 00:43:30,299
definitely separate what's been added
change and deleted and so well

641
00:43:30,299 --> 00:43:34,859
profile whole registered snapshots
discover tricky Mauer artifacts so one

642
00:43:34,859 --> 00:43:39,239
of the things we did in winnt I that I
completed stumbled across because of the

643
00:43:39,239 --> 00:43:43,140
command line that they executed as they
had key name involved investigated the

644
00:43:43,140 --> 00:43:49,558
key and i found that there was a 256k
burb at the point is called a blurb in

645
00:43:49,559 --> 00:43:50,969
the registry morning

646
00:43:50,969 --> 00:43:54,269
that's really unusual how many keys have
this big a blurb so it sent me out

647
00:43:54,269 --> 00:43:57,808
looking for that condition and sure
enough it was a binary hidden in the

648
00:43:57,809 --> 00:44:01,920
registry so we've integrated login to be
able to scan a system minus RS to be

649
00:44:01,920 --> 00:44:05,849
able to dump out keys that are larger
than 20k you can adjust that any size

650
00:44:05,849 --> 00:44:08,170
you want once you filter out about

651
00:44:08,170 --> 00:44:12,910
a couple dozen keys vary a lot of people
gets you know your user versus HD users

652
00:44:12,910 --> 00:44:16,420
so duplicates want to filter that out if
you were to scan your environment for

653
00:44:16,420 --> 00:44:19,329
these large keys that stick out like a
sore thumb with this particular one

654
00:44:19,329 --> 00:44:24,880
feature coaster doesn't cool trick it
puts a no bite in the value of a risky

655
00:44:24,880 --> 00:44:30,040
so when you actually open regedit or do
a range query it reads a run key and

656
00:44:30,040 --> 00:44:34,808
throws an error because of the snow bite
that's in the in the value and then when

657
00:44:34,809 --> 00:44:38,530
it funny fails you'll see the other ones
are there but you won't see the bad one

658
00:44:38,530 --> 00:44:41,740
so now how the heck do i get rid of this
thing well Koecher had a really cool

659
00:44:41,740 --> 00:44:42,399
feature

660
00:44:42,400 --> 00:44:46,720
well they knew like we know what the
slinky and recreated well no they

661
00:44:46,720 --> 00:44:49,839
recreated it immediately put the
infection right back in so they were

662
00:44:49,839 --> 00:44:52,630
watching the fact that they're autorun
might be deleted

663
00:44:52,630 --> 00:44:56,349
awesome i'm so we did that we have that
is an interesting artifact so now we

664
00:44:56,349 --> 00:44:57,430
look for that

665
00:44:57,430 --> 00:45:01,960
no by being written to register as part
of a scan and also the autoruns will be

666
00:45:01,960 --> 00:45:05,619
producing reports for our own stuff as
well so now the run keys will stick out

667
00:45:05,619 --> 00:45:08,770
his own report so it becomes obvious
where that persistence going to stick

668
00:45:08,770 --> 00:45:12,549
and of course was designed for speed
again under an hour

669
00:45:13,359 --> 00:45:16,779
okay to play with anything you want to
see em landesk manually walked up this

670
00:45:16,780 --> 00:45:20,079
box I don't care how you do it this
executive probably not a good idea a

671
00:45:20,079 --> 00:45:24,339
powershell it however you want to get
this log indeed around a box big fix but

672
00:45:24,339 --> 00:45:25,960
not you can do so

673
00:45:25,960 --> 00:45:30,040
ok because its standalone binary hundred
percent self-sustained and we also

674
00:45:30,040 --> 00:45:33,130
wanted to replace several tools so many
people here use red shot

675
00:45:33,130 --> 00:45:37,329
yeah you don't need it anymore it's a
GUI you have a command-line equivalent

676
00:45:37,329 --> 00:45:41,890
that's better than red shot that you
deploy with with login d so very popular

677
00:45:41,890 --> 00:45:43,420
tool no longer needed

678
00:45:43,420 --> 00:45:48,069
Sean deep chocolate six we do everything
in sha-256 so you no longer need to run

679
00:45:48,069 --> 00:45:52,390
those tools we look at all the files
into compares and will start scanning

680
00:45:52,390 --> 00:45:55,990
and doing reports you can see sdsu can
totally run scripts and parts of stuff

681
00:45:55,990 --> 00:45:59,979
on your own and so we can get much more
data say well here's this report on go

682
00:45:59,980 --> 00:46:03,130
ahead and look for all the executables
I'm gonna go through and look at all the

683
00:46:03,130 --> 00:46:07,180
the strips and whatnot pull those out so
it's really flexible for you guys to

684
00:46:07,180 --> 00:46:08,440
come up wherever you want

685
00:46:08,440 --> 00:46:12,339
and again replaced several older tools
so that's the nice thing and get rid of

686
00:46:12,339 --> 00:46:16,900
the GUI so i can actually deploy these
like us want to do it or like most

687
00:46:16,900 --> 00:46:19,869
people deploy stuff with soccer
distribution or configuration management

688
00:46:19,869 --> 00:46:26,260
and again do it quickly tradition audio
settings so you can download the free

689
00:46:26,260 --> 00:46:30,010
edition now again we believe in securing
it better we gotta give you the free

690
00:46:30,010 --> 00:46:33,940
tools ok it's pretty typical it's our
people we don't have something to do the

691
00:46:33,940 --> 00:46:37,450
job we want to go out and write it and
show that they didn't have a parser for

692
00:46:37,450 --> 00:46:41,950
the index BTR they went out and wrote it
because they have to because the stuff

693
00:46:41,950 --> 00:46:45,189
just doesn't exist we have to chase the
bad guys and so we end up creating these

694
00:46:45,190 --> 00:46:50,260
tools to make our lives a lot easier
harvest security relevant log data we

695
00:46:50,260 --> 00:46:55,510
don't harvest entire log we harvest what
we need for an irr our analysis purpose

696
00:46:55,510 --> 00:46:58,060
there's a lot of other stuff you
probably look at we're trying to get you

697
00:46:58,060 --> 00:47:02,170
to focus of the timelines and start to
roughly ends here and you look to your

698
00:47:02,170 --> 00:47:05,950
heart's content anywhere else in for
anything else you want but you'll get a

699
00:47:05,950 --> 00:47:09,730
lot of information with the behavior we
collect you can Whitelock whitelist up

700
00:47:09,730 --> 00:47:14,440
IP command-line IP or by command line so
whatever actually detonated so you're

701
00:47:14,440 --> 00:47:17,230
getting your guys are detonating a
script that's normal

702
00:47:17,230 --> 00:47:21,700
you can't let Outsiders shopping results
and the process also by process don't

703
00:47:21,700 --> 00:47:24,700
recommend doing this very big because
you might get rid of this prep for

704
00:47:24,700 --> 00:47:28,750
example uses people to get rid of it a
lot of known misuses her sister up so

705
00:47:28,750 --> 00:47:31,569
you want to make sure you get the
command line exactly right and only

706
00:47:31,569 --> 00:47:32,650
filter that out

707
00:47:32,650 --> 00:47:37,329
don't go too heavy on the process of
course you do bye-bye baseline you can

708
00:47:37,329 --> 00:47:41,380
do a file as well you can compare the
full system to baseline to baseline is a

709
00:47:41,380 --> 00:47:45,940
good box you're comparing to suspect
marks or in our lab in this case same

710
00:47:45,940 --> 00:47:50,170
thing in the registry and then the
compare the registry compared with the

711
00:47:50,170 --> 00:47:53,470
full file as well and large cage you get
all that free

712
00:47:53,470 --> 00:47:56,980
it's all yours download it let me know
what you think it was good feedback for

713
00:47:56,980 --> 00:48:00,490
sure we do a professional version stuff
we have to maintain the intelligence we

714
00:48:00,490 --> 00:48:05,200
have to add to it we does everything the
free version doesn't more breakdown more

715
00:48:05,200 --> 00:48:09,399
reports to break down so autoruns things
like that power show and again this is

716
00:48:09,400 --> 00:48:12,790
the second year of come to dirty say I
release though which I did last year

717
00:48:12,790 --> 00:48:15,650
finally actually this year

718
00:48:15,650 --> 00:48:19,730
the energy released the windows
powershell logging cheat on the guy who

719
00:48:19,730 --> 00:48:25,190
writes the windows login teaches by the
way and i held that back for about six

720
00:48:25,190 --> 00:48:29,210
months because ben 10 last year to talk
not powershell because you can actually

721
00:48:29,210 --> 00:48:33,260
launch powershell without ever calling
powershell dxtr powershell underscore

722
00:48:33,260 --> 00:48:36,800
icd-10-cm like doing it not going to put
how to detect that and the cheat sheet

723
00:48:36,800 --> 00:48:40,340
and so I had to do that and put in there
you know hey system will do it because

724
00:48:40,340 --> 00:48:44,480
you can see the deals are loaded yeah
well they're talking Sunday recommend

725
00:48:44,480 --> 00:48:49,130
everybody go to obfuscation powershell
because Daniel works Mannion and you

726
00:48:49,130 --> 00:48:54,380
share with us some information that says
yeah good luck taking the 41 for events

727
00:48:54,380 --> 00:48:57,200
and deciding to run scripts to harvest
some of the stuff I having the cheat

728
00:48:57,200 --> 00:49:01,430
because there's lots of way to obfuscate
it so i highly recommend with the use of

729
00:49:01,430 --> 00:49:05,690
PowerShell to look at that talk because
we are going to figure out how to

730
00:49:05,690 --> 00:49:10,160
actually hunt the stuff that Daniels
talking about and so especially reports

731
00:49:10,160 --> 00:49:13,970
require effort and that's what the pro
versions for we do harvests monologues

732
00:49:13,970 --> 00:49:18,859
without additional API calls are going
we got approval to do google hours total

733
00:49:18,860 --> 00:49:23,420
also going to get last line to pay for
these services but google's free for

734
00:49:23,420 --> 00:49:26,750
lips a minute but not and there's others
were talking to as well

735
00:49:26,750 --> 00:49:30,110
windows login service and be familiar
with windows login service the project

736
00:49:30,110 --> 00:49:35,690
they are made to syslog replacement
universal for replacement does all the

737
00:49:35,690 --> 00:49:39,230
stuff that's his mom doesn't more
doesn't it logs w my calls

738
00:49:39,230 --> 00:49:44,210
lots of cool stuff and so we can collect
that Egypt running locally before you

739
00:49:44,210 --> 00:49:48,890
sent it to the log server and game
addicts that really cool details

740
00:49:48,890 --> 00:49:53,839
whitelists registry compare results
compare the master digest message digest

741
00:49:53,840 --> 00:49:57,200
so you get a baseline of the gold build
but now i got a bunch of people have

742
00:49:57,200 --> 00:50:00,980
different apps i add that to a master
digest and compare the two and it throws

743
00:50:00,980 --> 00:50:04,070
those out so every time you find
something new unique you decide approved

744
00:50:04,070 --> 00:50:08,120
you can throw that master digested a way
to get rid of more stuff you get free

745
00:50:08,120 --> 00:50:12,740
updates in a nice manually road so again
future versions we have a powershell

746
00:50:12,740 --> 00:50:17,899
details coming virustotal covered most
this parentless process and parent tree

747
00:50:17,900 --> 00:50:21,320
parent-child tree will be coming out in
the future so you saw hide in the

748
00:50:21,320 --> 00:50:22,420
spreadsheet

749
00:50:22,420 --> 00:50:25,750
have you know again the way Microsoft
wrote it we're gonna do a little better

750
00:50:25,750 --> 00:50:30,250
job and try to make it easier for you to
find those links so that stuff works

751
00:50:30,250 --> 00:50:33,940
because those little hex codes actually
are temporary they can be reused within

752
00:50:33,940 --> 00:50:38,589
five minutes of class once a process
terminates so you can't say all these

753
00:50:38,589 --> 00:50:42,250
are linked know at some point if this
stopped those are something totally

754
00:50:42,250 --> 00:50:46,210
different and so we'll set those up in
the future as well and again virustotal

755
00:50:46,210 --> 00:50:49,150
so you can actually then send the
results again not automatically

756
00:50:49,150 --> 00:50:52,390
understand that close lab environment it
will be an option in the command line to

757
00:50:52,390 --> 00:50:55,930
harvest files put them in a folder and
will send all those up a four-minute

758
00:50:55,930 --> 00:51:00,819
rate and then some other street vendors
can talk about right now but we would

759
00:51:00,819 --> 00:51:04,420
like to announce a new feature so this
be coming out very shortly after econ

760
00:51:04,420 --> 00:51:08,619
for those of you that are in the pro
scenario in this guy being one of them

761
00:51:09,190 --> 00:51:13,599
we have integrated the whois lookup so
now the windows firewall auger system on

762
00:51:13,599 --> 00:51:18,250
firewall or system network information
there's the IP addresses you now can see

763
00:51:18,250 --> 00:51:25,030
who the owner and network is as well as
the country of origin and also the

764
00:51:25,030 --> 00:51:28,510
network range so if you do decide to go
and block you now have everything you

765
00:51:28,510 --> 00:51:33,549
need and if you look at this particular
output here probably highly readable is

766
00:51:33,549 --> 00:51:38,920
a little fuzzy because of the size but
you can download and get more detail

767
00:51:38,920 --> 00:51:42,640
when you read it personal line you can
get a look at this just in the output

768
00:51:42,640 --> 00:51:46,509
alone with that who is information and
no you've got something funky because

769
00:51:46,510 --> 00:51:51,609
Google's in here as when you can see
here the the personally called so you

770
00:51:51,609 --> 00:51:52,420
can see who it was

771
00:51:52,420 --> 00:51:56,319
Aaron or AP neck or whatnot but you can
see very quickly that

772
00:51:56,319 --> 00:52:00,400
hey I executed this thing at this time .
and he will be called google and

773
00:52:00,400 --> 00:52:02,440
launched into google chrome didn't
update

774
00:52:02,440 --> 00:52:06,130
hey what's Amazon and went to go daddy
went to Russia see very quickly just

775
00:52:06,130 --> 00:52:09,309
looking at the country data and the
owner data can really kind of get an

776
00:52:09,309 --> 00:52:13,299
idea what the communications are growing
very quickly something you cannot get

777
00:52:13,299 --> 00:52:14,770
out of sandbox analysis

778
00:52:14,770 --> 00:52:18,520
ok this happens to be the output from
the track that I detonated yesterday

779
00:52:18,520 --> 00:52:19,180
morning

780
00:52:19,180 --> 00:52:23,440
ok so thank you for sending power mr.
Marion's to get a nice little update to

781
00:52:23,440 --> 00:52:28,210
the appraisal what you get with all this
manual analysis gives you what process

782
00:52:28,210 --> 00:52:29,920
executed where it executed from

783
00:52:29,920 --> 00:52:33,549
who else opening hours what you're after
so you take that IP address information

784
00:52:33,549 --> 00:52:36,940
you put it you know your spunk or
whatever you have even have to do it

785
00:52:36,940 --> 00:52:40,599
manually and you say who else got this
to urls whatever you're harvesting out

786
00:52:40,599 --> 00:52:44,500
of this and the details potentially
remediated or improve your active

787
00:52:44,500 --> 00:52:47,950
defense I did those spreadsheets in 15
minutes

788
00:52:47,950 --> 00:52:51,339
you can't tell me you can't do this in
under an hour I can do this better and

789
00:52:51,339 --> 00:52:56,828
faster with login d then cloud analysis
can give me and I'm on actual native

790
00:52:56,829 --> 00:53:01,839
hardware of whatever running it with AWS
whether it is n whether its bare bones

791
00:53:01,839 --> 00:53:06,640
desktop Windows 7 10 whatever i do much
quicker and I get much better accurate

792
00:53:06,640 --> 00:53:09,640
accurate information so very cool from
that perspective

793
00:53:10,299 --> 00:53:14,079
here's where you can find us login decom
go download the free version my

794
00:53:14,079 --> 00:53:18,010
archaeology is where you get the windows
login sheets 51 we have a Windows File

795
00:53:18,010 --> 00:53:22,569
auditing cheat registry auditing cheap
our show auditing cheat and splunk

796
00:53:22,569 --> 00:53:27,099
logging cheese as well and again we have
some links to some now reports if you

797
00:53:27,099 --> 00:53:30,700
want to practice what I calm our
management read the reports like a b-29

798
00:53:30,700 --> 00:53:34,750
look for those key indicators that are
interesting and say how do I detect

799
00:53:34,750 --> 00:53:40,089
those our management's actually how
Brian and I will improve login d will

800
00:53:40,089 --> 00:53:43,240
take talks like minions take these
reports

801
00:53:43,240 --> 00:53:47,078
hey that's really cool we can search a
registry for a URL and find the common

802
00:53:47,079 --> 00:53:50,890
objects going out and downloading the
payload and dropping it to disk we can

803
00:53:50,890 --> 00:53:54,279
do that because we have the data we just
have to write the code to do it and so

804
00:53:54,280 --> 00:53:57,369
that's how we improve the product is
with all these talks and these reports

805
00:53:57,369 --> 00:54:01,030
and we call that matter management again
i'll be posting this on SlideShare so

806
00:54:01,030 --> 00:54:04,990
just look for this item with that I we
have 10 minutes become I'm the one

807
00:54:04,990 --> 00:54:08,200
holding back from dinner beer so well

808
00:54:08,200 --> 00:54:11,859
ok I've got my beer you guys are going
to look but questions

809
00:54:19,390 --> 00:54:24,700
great question what size shirt you would
she want to make sure you arch crabs are

810
00:54:24,700 --> 00:54:27,210
find your back doors for the feds
Malcolm

811
00:54:27,210 --> 00:54:37,440
ok large back door uh took a minute to
minute that's why we had to stand up and

812
00:54:37,440 --> 00:54:41,040
do all that i do not reload this on the
system

813
00:54:41,040 --> 00:54:45,300
why because I don't want the Marines
doing inventory of it not that i have an

814
00:54:45,300 --> 00:54:49,830
active actor in my environment but maybe
I could but the reality is i don't need

815
00:54:49,830 --> 00:54:52,619
the stuff in the tool i use software
distribution remember i mentioned land

816
00:54:52,619 --> 00:54:56,849
sem big fix whatever i am a huge
proponent big dicks with any big fix

817
00:54:56,849 --> 00:55:01,020
users announce that will admit it or not
pet are using it for not patch

818
00:55:01,020 --> 00:55:02,009
management

819
00:55:02,010 --> 00:55:05,580
ok so you understand the whole analysis
and fix the thing is it's not the best

820
00:55:05,580 --> 00:55:07,230
security tool ever

821
00:55:07,230 --> 00:55:11,339
yeah you don't need mere big fix is the
boss in regards to tools

822
00:55:11,339 --> 00:55:15,930
unfortunately it's owned by them so i
pushed out with big 5 megapixel it drop

823
00:55:15,930 --> 00:55:19,080
it in there run the script I tell we
have a minus on the pro version so you

824
00:55:19,080 --> 00:55:23,640
can send the output garrison mapserver
share push the output pull down anyway

825
00:55:23,640 --> 00:55:26,430
listen we need whatever we need to
configuration and then push the output

826
00:55:26,430 --> 00:55:30,089
of the server and the disconnect share
and then delete the file off the box so

827
00:55:30,089 --> 00:55:34,410
what many complain about is as they're
rolling out mirror they would not work

828
00:55:34,410 --> 00:55:36,930
the right the mirror thing a they
couldn't get rolled out in time but a

829
00:55:36,930 --> 00:55:40,740
lot of what happens to them because it's
so well-known is the bad guys will stop

830
00:55:40,740 --> 00:55:44,220
doing what they're doing because they
see mirror being deployed and so no I

831
00:55:44,220 --> 00:55:47,669
don't know the stuff in boxes we do it
with bigfix again even in the manual

832
00:55:47,670 --> 00:55:50,880
talk they pointed out how they had them
more how they do things and use the

833
00:55:50,880 --> 00:55:55,260
customers own tools my top 10 list is
this log management

834
00:55:55,260 --> 00:55:58,650
I don't care what you use hopefully it's
good he understands because we went

835
00:55:58,650 --> 00:56:00,330
through to them

836
00:56:00,330 --> 00:56:03,569
number two would be a big fixed type
tool use titanium you're gonna have a

837
00:56:03,570 --> 00:56:07,080
lot of PowerShell scripts or BB and
detonating environment so you'll have to

838
00:56:07,080 --> 00:56:10,740
figure out a filter those out number
three is login d 4 through 10 or blank

839
00:56:10,740 --> 00:56:13,740
and now you're gettin into the high end
solutions like a crowd striker silence

840
00:56:13,740 --> 00:56:18,029
or whatever because the bad guys are
hunting for this stuff

841
00:56:18,030 --> 00:56:21,960
11 on they really can't do much about
the stuff that's one two and three

842
00:56:21,960 --> 00:56:24,990
because doesn't live in the box
sysinternals you install it look for the

843
00:56:24,990 --> 00:56:27,629
red key they ran into that with their
engagement

844
00:56:27,630 --> 00:56:31,260
I'm so great question the answer is no I
deploy with my software distribution

845
00:56:31,260 --> 00:56:35,070
tool PS exact powershell however you
want to do it don't leave the stuff on

846
00:56:35,070 --> 00:56:36,540
the box for them to learn

847
00:56:36,540 --> 00:56:37,259
yeah

848
00:56:37,260 --> 00:56:56,100
wanna make sure I repeat the question so
that people watching later can get it so

849
00:56:56,100 --> 00:56:59,100
how many times we see large websites
getting nowhere

850
00:57:01,830 --> 00:57:07,770
oh how much we see delivery to adds a
lot of drive-bys we've had a lot of

851
00:57:07,770 --> 00:57:11,250
actually looks like it's morphing from
flash player a bogus bass player

852
00:57:11,250 --> 00:57:15,960
probably delivered to an ad or just a
scripted site on a blog unfortunate you

853
00:57:15,960 --> 00:57:19,470
know like nine percent of our constant
legitimate sites to compromise blogs

854
00:57:19,470 --> 00:57:24,990
whatnot adware definitely we have given
people that repeat offenders ad blockers

855
00:57:24,990 --> 00:57:29,669
and problem has disappeared for them
disappears a relative term because that

856
00:57:29,670 --> 00:57:34,770
means permanency course not pregnancy so
surprising a lot so I proxy with some

857
00:57:34,770 --> 00:57:38,820
sort of intelligent unknown bad sites
definitely a good thing to have would be

858
00:57:38,820 --> 00:57:44,040
in my you know 13th spot or so because
unfortunately more fewer also fast it's

859
00:57:44,040 --> 00:57:47,009
really hard but you have the ability now
to block it once you find it through

860
00:57:47,010 --> 00:57:51,150
matter analysis that's kind of the
reason web proxy is important so I do

861
00:57:51,150 --> 00:57:55,500
see it pretty heavily and Brian I think
you'd probably agree we see it weekly

862
00:57:55,500 --> 00:58:00,840
more so the word docs by far the the
word docs coming through her and again I

863
00:58:00,840 --> 00:58:03,720
won't pick on the vendor other than
picking on the matter like i showed you

864
00:58:03,720 --> 00:58:09,060
some of you clearly know the vendor is
by the slides but that's an epic fail

865
00:58:09,600 --> 00:58:13,170
I mean there are now two defects one the
the files are getting released to

866
00:58:13,170 --> 00:58:16,920
quarantine from quarantine before their
and analyze completely and the others

867
00:58:16,920 --> 00:58:20,670
fact they're saying they're clean and
they're obviously freaking bad and the

868
00:58:20,670 --> 00:58:25,050
solutions a hundred grand plus and in
you know if you're all really big

869
00:58:25,620 --> 00:58:31,170
yeah it's a chunk of money to throw for
total failure so yes we see a lot but

870
00:58:31,170 --> 00:58:36,270
mostly the word docs the emails by far
are you people are click happy I'm our

871
00:58:36,270 --> 00:58:40,110
archaeologist shirt on the back says
because people work on stuff by far as

872
00:58:40,110 --> 00:58:41,119
number one

873
00:58:41,119 --> 00:58:49,069
the question which shirt extra large 21
which one back door back door x-large

874
00:58:49,069 --> 00:58:54,799
that he's got another large and
extra-large backdoor good pickup

875
00:58:55,369 --> 00:59:12,470
yes blue shirt first creature second um
it we have some stuff in aus so if i had

876
00:59:12,470 --> 00:59:15,828
to investigate us i would use login d
get the stuff configure the way I want

877
00:59:15,829 --> 00:59:19,759
and harvest the registry and file system
and all that that's how I would do it

878
00:59:19,759 --> 00:59:23,450
I'm not tried any of those other tools
within the environments doctor for

879
00:59:23,450 --> 00:59:26,029
example has a really cool feature where
you can actually see the difference of

880
00:59:26,029 --> 00:59:29,450
files this is really good for linux by
the way really great tip I can see the

881
00:59:29,450 --> 00:59:33,019
difference of the files compared to the
actual original snapshot it's a really

882
00:59:33,019 --> 00:59:37,368
cool feature of this whole dr. eyes to
container and stuff and so that if you

883
00:59:37,369 --> 00:59:42,349
can get that ability being better get
the registry but that's kind of cool for

884
00:59:42,349 --> 00:59:46,640
those containers scenarios but I'm not
played with them I pretty much i use

885
00:59:46,640 --> 00:59:49,460
something that I know the bad guys
really can't manipulate and that's built

886
00:59:49,460 --> 00:59:50,509
into the system

887
00:59:50,509 --> 01:00:00,739
what size shirt XL crabs or backdoor
he's got an extra large backdoor t-shirt

888
01:00:01,670 --> 01:00:17,809
how do i use the output to further my
active defense really a question so i

889
01:00:17,809 --> 01:00:21,470
actually one of our clients had inquired
because of slow links and other things

890
01:00:21,470 --> 01:00:23,569
that can you consume the CSP and respond

891
01:00:23,569 --> 01:00:28,220
it is one of the reasons we designed it
to be a CSV Excel with the filtering and

892
01:00:28,220 --> 01:00:33,470
sorting is an awesome tool by far the
number one security tool is excel but

893
01:00:33,470 --> 01:00:37,879
yeah the the use of doing that log man
solution we have a CSV for you to suck

894
01:00:37,880 --> 01:00:42,680
in there so you can actually use that is
your is your for sort of so to speak and

895
01:00:42,680 --> 01:00:47,149
so from that aspect there's that the
other is the IP addresses so we in an

896
01:00:47,150 --> 01:00:50,809
arson environment when we analyze an
hour which is why we harvested so often

897
01:00:50,809 --> 01:00:52,800
which is why we're so interested in the
cloud

898
01:00:52,800 --> 01:00:55,830
well solution i have splunk alerts kind
of alert me to the condition that

899
01:00:55,830 --> 01:00:59,490
something was clean and now it's malware
and go get a copy of it and we analyze

900
01:00:59,490 --> 01:01:04,080
it we put the IPS into this one thing
and say who else open this and now we

901
01:01:04,080 --> 01:01:06,569
have full coverage across the
environment because our router logs are

902
01:01:06,570 --> 01:01:10,080
all and firewall logs are all in the
this Punk environment so from that

903
01:01:10,080 --> 01:01:14,759
aspect get my proxy if i get URL so i
can put those in web proxy decide when I

904
01:01:14,760 --> 01:01:20,040
block him or set up a report to monitor
them warning i'm blocking when you know

905
01:01:20,040 --> 01:01:25,500
when they know you know danger if it's
somebody coming after you be careful

906
01:01:25,500 --> 01:01:25,860
there

907
01:01:25,860 --> 01:01:29,940
ok it's better to watch them poke the
bear and the Chinese we whack them they

908
01:01:29,940 --> 01:01:32,640
morph to the point where real quick

909
01:01:32,640 --> 01:01:36,089
they came information-packed we blocked
all of Asia back to enterprise they keep

910
01:01:36,090 --> 01:01:40,350
me from opendns the change in our Soyuz
open the audacity blocked opendns to

911
01:01:40,350 --> 01:01:43,440
change our to use google tenacity block
will unless you are using any of them

912
01:01:43,440 --> 01:01:48,990
they did that they changed the code
again to code google com crap can't

913
01:01:48,990 --> 01:01:52,709
block that we're using a project at 40
character string in front of the page

914
01:01:52,710 --> 01:01:57,060
and they use 20 of it to tell the matter
where the IP was brilliant

915
01:01:57,060 --> 01:02:00,600
ok so that if you start blocking this
stuff you're going to change their

916
01:02:00,600 --> 01:02:04,799
behavior and it's going to come harder
for you to react much like the man you

917
01:02:04,800 --> 01:02:09,750
guys are talking about so monitoring is
how i would go after it only use

918
01:02:09,750 --> 01:02:15,270
blocking when something really Bad's
occurring because they know you know and

919
01:02:15,270 --> 01:02:18,600
they'll change their behavior and so so
again you have to make that decision

920
01:02:18,600 --> 01:02:25,560
based on business and stuff but that's
my take on so I do that so URLs ip's for

921
01:02:25,560 --> 01:02:28,890
those are big 6 users will totally
understand i have of i have a $YEAR

922
01:02:28,890 --> 01:02:33,509
analysis and big fix that says show me
anything it's new and and it's called

923
01:02:33,510 --> 01:02:37,230
folders folders so if you follow app
data is a folder but I want to know

924
01:02:37,230 --> 01:02:43,080
what's in a folder below have data so of
folders AppData show me any binary dll

925
01:02:43,080 --> 01:02:47,040
exe that's been there last week I
dropped last 24 hours so now when our I

926
01:02:47,040 --> 01:02:49,920
don't care what the directory name gets
dropped i'll see this new funky

927
01:02:49,920 --> 01:02:52,190
directory name show up in my analysis
learn

928
01:02:52,190 --> 01:02:56,180
and I'll see the new funky binary and it
will go across all the nodes that have

929
01:02:56,180 --> 01:02:59,419
big dicks on it so i can take that
information Marinette from basic

930
01:02:59,420 --> 01:03:03,770
analysis and create an inventory for sem
or i can create an analysis of big fix

931
01:03:03,770 --> 01:03:07,130
or equivalent and I can go out and look
for that kind of behavior in the

932
01:03:07,130 --> 01:03:11,599
environment through those tools so great
question and if you have netflix stuff

933
01:03:11,599 --> 01:03:15,800
you can obviously do that fo details as
well maybe maybe look wireshark capture

934
01:03:15,800 --> 01:03:17,960
a really good question

935
01:03:17,960 --> 01:03:26,329
yes as little as possible you don't
upload the hash virus or not the payload

936
01:03:26,329 --> 01:03:29,150
yet

937
01:03:29,150 --> 01:03:45,650
correct correct so do you want to know
if you want to upload the question was

938
01:03:45,650 --> 01:03:49,609
you not want to upload some of our store
the answer is yes eventually you do you

939
01:03:49,609 --> 01:03:53,240
want to make sure any engagement you
like again many guys had mentioned had

940
01:03:53,240 --> 01:03:55,879
to keep everything on a spreadsheet and
not on the computer because they were

941
01:03:55,880 --> 01:03:58,670
watching what they were doing and so
every time they could write something or

942
01:03:58,670 --> 01:04:01,069
internet somewhere these guys and see
what they entered keystroke logging

943
01:04:01,069 --> 01:04:04,730
whatever they're doing it and then they
would more to come back after the

944
01:04:04,730 --> 01:04:07,819
weekend they realize all of a sudden you
know 89 things they were watching

945
01:04:07,819 --> 01:04:11,060
disappeared and so you have to
understand that right once you get your

946
01:04:11,060 --> 01:04:14,750
analysis down you say okay I kind of got
what this thing's doing i'm gonna go

947
01:04:14,750 --> 01:04:19,190
ahead and upload the payload virustotal
go for it but make sure you kind of have

948
01:04:19,190 --> 01:04:22,790
an idea what it's done like all the way
into I stuff that we had and I got some

949
01:04:22,790 --> 01:04:26,930
serious amount of winnt i never uploaded
it until we finished all the reports and

950
01:04:26,930 --> 01:04:30,230
got the debrief to the to the feds and
then we uploaded it because the minute

951
01:04:30,230 --> 01:04:34,550
that occurs with those Chinese campaigns
Russian campaigns like a b-29 they will

952
01:04:34,550 --> 01:04:38,240
completely change from doing simple
sideloading to hiding things in a

953
01:04:38,240 --> 01:04:42,169
registry and now what you were looking
for is completely different when they

954
01:04:42,170 --> 01:04:47,210
come back in which is you know bummer
for you now pop the complexity but yes

955
01:04:47,210 --> 01:04:50,720
you do want to do it because that
metadata is very valuable to everybody

956
01:04:50,720 --> 01:04:54,470
who's using it but make sure you're done
with it before you upload it

957
01:04:54,980 --> 01:04:58,640
the actual file itself so great question
for the URL or anything else because

958
01:04:58,640 --> 01:05:01,700
they're up they're paying for the
service to monitor looking for that hash

959
01:05:01,700 --> 01:05:05,270
and one minute it shows up the repo they
know you know whoever you are if you

960
01:05:05,270 --> 01:05:06,109
need to you

961
01:05:06,109 --> 01:05:10,880
yeah they know you know who you r their
know that they're not the company itself

962
01:05:10,880 --> 01:05:17,119
so question about size large backdoor
crabs

963
01:05:17,119 --> 01:05:25,490
he's got a large cribs get creature
outside shirt because you got a 2xl

964
01:05:25,490 --> 01:05:33,319
crabs or backdoor he's got a
double-double large back door man hey

965
01:05:33,320 --> 01:05:34,130
the question

966
01:05:34,130 --> 01:05:41,930
yep i think i get two shirts

967
01:05:41,930 --> 01:05:45,618
what size are you what do you have to
enable other than windows default

968
01:05:45,619 --> 01:05:51,470
windows default everybody ready for this
windows default flex one thing that's

969
01:05:51,470 --> 01:05:58,100
useful one at maybe to service starting
or stopping 7040 event and new service

970
01:05:58,100 --> 01:06:05,690
install 7045 and login success local
that's it and I'm not kidding when I say

971
01:06:05,690 --> 01:06:06,770
that's it

972
01:06:06,770 --> 01:06:11,119
so the windows login sheet is the thing
you want to follow to turn on all of it

973
01:06:11,930 --> 01:06:16,640
those were designed specifically the
best example I give you as many talk but

974
01:06:16,640 --> 01:06:20,900
we designed based on the Chinese attacks
when TI ok what did we have to turn on

975
01:06:20,900 --> 01:06:24,530
to catch all this behavior and that's
actually why i wrote the cheat sheets

976
01:06:24,530 --> 01:06:27,440
because i used for HP and teach people
this but there was never really a good

977
01:06:27,440 --> 01:06:30,410
resource port which is why the cheats
got a minute

978
01:06:30,410 --> 01:06:33,890
and so that's what you have to do
literally everything the power show

979
01:06:33,890 --> 01:06:37,400
logging is not there there is no w my
logging unless you use windows login

980
01:06:37,400 --> 01:06:43,940
service SS stuff the powershell logins
only gotten better and 45 so you have to

981
01:06:43,940 --> 01:06:47,210
use a profile for two and three and that
can be bypassed as they always do ano

982
01:06:47,210 --> 01:06:53,030
profile process of creation is not on by
default but the CIS benchmark did add

983
01:06:53,030 --> 01:06:56,359
that it didn't used to be in there and
then the process command line is not in

984
01:06:56,359 --> 01:06:57,470
any of them

985
01:06:57,470 --> 01:07:01,339
it's only adds one line to the 4068
event which tells you exactly was type

986
01:07:01,340 --> 01:07:04,030
the command line that is huge and we are
talking to

987
01:07:04,030 --> 01:07:08,140
Daniel on Sunday when you go to go to
the new natok new talk on Sunday really

988
01:07:08,140 --> 01:07:12,310
recommend you do your sheet powershell
is is going to own all you at some point

989
01:07:12,310 --> 01:07:16,180
you really need to understand what can
have a partial and your linux to which

990
01:07:16,180 --> 01:07:20,710
seemed more awesome that command
execution the fact of how he initially

991
01:07:20,710 --> 01:07:23,830
gets on the box is how you're going to
detect that because he's gonna go dark

992
01:07:23,830 --> 01:07:24,819
after that

993
01:07:24,820 --> 01:07:27,790
carlos has a display module that
specifically looks at the stuff we tell

994
01:07:27,790 --> 01:07:31,810
you to turn on to determine how noisy
can be in the box so it is i give

995
01:07:31,810 --> 01:07:34,990
another pet red team looks like we do
and we look at they do it's just

996
01:07:34,990 --> 01:07:39,069
constant back forth so by default
windows sucks at logging you must go and

997
01:07:39,070 --> 01:07:40,540
enable what you need

998
01:07:40,540 --> 01:07:44,140
you will not catch squat unless you do
with the windows login sheet tell you

999
01:07:44,140 --> 01:07:54,220
first behind there is he asked you get
that he gets his church sighs yeah i'll

1000
01:07:54,220 --> 01:08:04,899
leave that joke alone question behind
correct time stopping good catch

1001
01:08:05,860 --> 01:08:09,100
again we're looking at the window of a
long time not the timestamp I really

1002
01:08:09,100 --> 01:08:12,700
don't give a crap about the timestamp it
is this affecting me i'm looking at the

1003
01:08:12,700 --> 01:08:16,540
log entry of when the event started and
when it ended and then the times can be

1004
01:08:16,540 --> 01:08:19,930
all over the place that file says it's
been there since 2005 you have probably

1005
01:08:19,930 --> 01:08:22,600
not look at the great time to look at
the access time to look at the right

1006
01:08:22,600 --> 01:08:25,810
time they usually mess that up and
they're not like they're supposed to be

1007
01:08:25,810 --> 01:08:29,830
and so I generally don't use that
feature that's more forensic features on

1008
01:08:29,830 --> 01:08:33,100
a quick feature the log entry recursion
is what I'm after

1009
01:08:33,100 --> 01:08:40,180
so the question church size x-large
crabs crabs exhale

1010
01:08:40,180 --> 01:08:43,180
well yes

1011
01:08:47,229 --> 01:08:51,608
yep

1012
01:08:51,609 --> 01:08:52,150
anybody here

1013
01:08:52,149 --> 01:08:58,120
the gaming industry like I was the most
technical users i have ever had in the

1014
01:08:58,120 --> 01:09:01,448
gaming industry without a doubt I mean
if we ran a big fix inventory on

1015
01:09:01,448 --> 01:09:04,568
software analysis because it literally
reads every executable to figure out

1016
01:09:04,569 --> 01:09:09,819
what it is it's ridiculously burdensome
the logging that occurs for what we

1017
01:09:09,819 --> 01:09:13,509
recommend windows login sheet for
example process create will also create

1018
01:09:13,509 --> 01:09:18,370
4068 creates 4069 i tell people don't
bother collecting that it's do I know

1019
01:09:18,370 --> 01:09:19,179
something started

1020
01:09:19,179 --> 01:09:23,199
I can look to see if it terminated it's
not a big deal and so there are ways to

1021
01:09:23,198 --> 01:09:26,979
trim that data so it doesn't it doesn't
have as much impact so from that aspect

1022
01:09:26,979 --> 01:09:30,608
not noticeable in almost all
environments that will be exceptions

1023
01:09:30,609 --> 01:09:34,509
that because we're talking about modern
hardware and undersized BM or old

1024
01:09:34,509 --> 01:09:36,969
hardware but modern hardware

1025
01:09:36,969 --> 01:09:42,520
it's an SSD yeah no problem even spindle
drives the gamers never knew we had

1026
01:09:42,520 --> 01:09:46,029
every workstation with all the walking
and talking about turned on every server

1027
01:09:46,029 --> 01:09:48,400
every workstation every linux box

1028
01:09:48,399 --> 01:09:52,839
no one ever noticed anything and we had
everything we needed but there are older

1029
01:09:52,839 --> 01:09:56,140
hardware that if something goes a report
matter fact the only notice notice they

1030
01:09:56,140 --> 01:10:00,610
would have us on this blog universal
order went crazy would be the only real

1031
01:10:00,610 --> 01:10:09,909
notice that's more of a bug in their
client software my son Ben 10

1032
01:10:09,909 --> 01:10:14,920
my internets on the take questions
outside thanks

