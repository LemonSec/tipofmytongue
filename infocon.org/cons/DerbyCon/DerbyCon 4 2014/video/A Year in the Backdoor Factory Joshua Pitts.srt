1
00:00:00,000 --> 00:00:03,129
good I welcome up

2
00:00:03,129 --> 00:00:06,359
this is track three 4 o'clock track 14
clock

3
00:00:06,359 --> 00:00:11,010
I'm Josh thats it's with an ass for
whoever had the wifi access point

4
00:00:11,010 --> 00:00:14,490
us personally I'm talks about

5
00:00:14,490 --> 00:00:17,770
the backer factory for those that know
it's

6
00:00:17,770 --> 00:00:21,010
thank you for being here those that
don't think for being here

7
00:00:21,010 --> 00:00:25,279
and those that don't care I don't know
why you're here right

8
00:00:25,279 --> 00:00:28,730
that's much better handle I'm a former
well

9
00:00:28,730 --> 00:00:34,070
I am still a marine but I got on 2001 I
you can just see red t mean

10
00:00:34,070 --> 00:00:38,140
and code reviews pretty much everything
in the security space only thing I don't

11
00:00:38,140 --> 00:00:39,230
do really a

12
00:00:39,230 --> 00:00:43,680
up Harbor hardware I know I don't except
of chips

13
00:00:43,680 --> 00:00:47,710
yet a record for fun my wife says any
new hobbies

14
00:00:47,710 --> 00:00:50,890
up any work invited security

15
00:00:50,890 --> 00:00:55,149
we're hiring like every other security
vendor your Harry over better

16
00:00:55,149 --> 00:00:58,680
we have a lot of fun so the doctor
factory

17
00:00:58,680 --> 00:01:02,309
on that when I'm first name decided to
go see it

18
00:01:02,309 --> 00:01:06,810
popular its kinda popular now so I
shortened it to PDF

19
00:01:06,810 --> 00:01:10,490
just for the stocks I don't say that
over and over again and then Google

20
00:01:10,490 --> 00:01:11,430
blacklists

21
00:01:11,430 --> 00:01:14,490
the YouTube video so

22
00:01:14,490 --> 00:01:18,060
the goal the goal PDF is to
automatically

23
00:01:18,060 --> 00:01:22,240
patch XQ refineries so that the user

24
00:01:22,240 --> 00:01:26,590
does not know that they've been patched
and I i

25
00:01:26,590 --> 00:01:30,400
when it when it first started this it
was mainly just

26
00:01:30,400 --> 00:01:34,810
Windows execute ables because I thought
to be called on me to process that I

27
00:01:34,810 --> 00:01:36,780
learned while taking one of them forces

28
00:01:36,780 --> 00:01:41,110
well extended it all binary formats
because

29
00:01:41,110 --> 00:01:46,610
I wanna learn how work right now spied
on 27

30
00:01:46,610 --> 00:01:50,090
its that's the get home I S my get help

31
00:01:50,090 --> 00:01:54,329
accounts this dialogue in and

32
00:01:54,329 --> 00:01:58,450
it's been in development for about two
years so why

33
00:01:58,450 --> 00:02:03,680
I'm once its some reason

34
00:02:03,680 --> 00:02:08,489
attacking the speaker whose

35
00:02:08,489 --> 00:02:15,489
mark Hodges

36
00:02:18,980 --> 00:02:25,980
that's not good work either

37
00:02:26,170 --> 00:02:31,879
so one to rate this

38
00:02:31,879 --> 00:02:36,090
up for for 99 percent the individuals
out there 99 percent

39
00:02:36,090 --> 00:02:39,550
enterprises up usual Anderson up

40
00:02:39,550 --> 00:02:42,769
right rickets

41
00:02:42,769 --> 00:02:47,340
are sexy Ricketts if you're in green 0

42
00:02:47,340 --> 00:02:51,370
that is awesome but is it up can see my
notes but

43
00:02:51,370 --> 00:02:55,349
but on rootkits are like underwear

44
00:02:55,349 --> 00:02:58,610
models okay they are sexy

45
00:02:58,610 --> 00:03:05,129
up I'm sorry minutes hate maximize

46
00:03:05,129 --> 00:03:08,269
the Rays unicorns and most people never
be touched by them

47
00:03:08,269 --> 00:03:11,510
so that hard targets

48
00:03:11,510 --> 00:03:15,800
you need you need a you can hear it
right gonna need

49
00:03:15,800 --> 00:03:19,810
he deeply to to be agree 0 you're gonna
need to be

50
00:03:19,810 --> 00:03:23,640
a lowering 0 and hypervisor in the BIOS
the firmware

51
00:03:23,640 --> 00:03:27,090
right to hide from the west but

52
00:03:27,090 --> 00:03:30,769
for example target on that was

53
00:03:30,769 --> 00:03:34,620
everything I've read I was in userspace
Fisher

54
00:03:34,620 --> 00:03:38,040
except for the exploits to get onto the

55
00:03:38,040 --> 00:03:41,930
the boxes up the end users that were
infected with this malware

56
00:03:41,930 --> 00:03:45,340
it was all your space arson attack

57
00:03:45,340 --> 00:03:50,110
this was poison ivy modified user land

58
00:03:50,110 --> 00:03:53,439
Home Depot who knows let's put that in
there

59
00:03:53,439 --> 00:03:57,209
ice last year I presented

60
00:03:57,209 --> 00:04:00,610
passionate sex kills a backer factory
just Windows XP Tools

61
00:04:00,610 --> 00:04:03,739
I could patch x86 stage payloads on

62
00:04:03,739 --> 00:04:08,739
images provide their own show code x64
non station is like a reverse TCP shell

63
00:04:08,739 --> 00:04:11,970
I'd and catching up in options were

64
00:04:11,970 --> 00:04:16,150
pinned a new section you could do
cocaine injection and also you could do

65
00:04:16,150 --> 00:04:16,709
I'm

66
00:04:16,709 --> 00:04:19,729
multi cocaine injection if the binary

67
00:04:19,729 --> 00:04:23,300
or the paler that you were injecting
into it was put into

68
00:04:23,300 --> 00:04:26,680
smaller chunks you could use use it in
most cases

69
00:04:26,680 --> 00:04:30,330
in at into the presentation I said

70
00:04:30,330 --> 00:04:33,759
alright this is what I want to do and I
wasn't really sure I could do any of

71
00:04:33,759 --> 00:04:34,250
this

72
00:04:34,250 --> 00:04:38,350
I just thought this is like pine sky
this be greater and we say

73
00:04:38,350 --> 00:04:44,410
was a great year so

74
00:04:44,410 --> 00:04:48,060
PDF overall was imported into other
projects television

75
00:04:48,060 --> 00:04:51,699
up who hears her dad Vail

76
00:04:51,699 --> 00:04:56,190
okay so it's a way to make binary
supplant princess so that

77
00:04:56,190 --> 00:05:01,330
AB doesn't pick you up right Kelly Lenox

78
00:05:01,330 --> 00:05:05,690
they it needs to be updated but it is in
calendar now miss Mina patch

79
00:05:05,690 --> 00:05:10,030
after the stock and then a placard to
the next

80
00:05:10,030 --> 00:05:13,440
so the first thing accomplished was the
x86 stagehands I'm

81
00:05:13,440 --> 00:05:17,580
way works is I took and the x86 create
read method

82
00:05:17,580 --> 00:05:21,539
so that uses staged payload any writer
Impaler

83
00:05:21,539 --> 00:05:25,449
I poor that every x64 I wrote that by
hand he was originally from

84
00:05:25,449 --> 00:05:30,550
and set them what what who wrote that
was a i think is to keep your

85
00:05:30,550 --> 00:05:34,009
in all it does is allocate memory copper
payload into a separate

86
00:05:34,009 --> 00:05:37,979
a into that memory and then crashed
thread: watch them

87
00:05:37,979 --> 00:05:41,830
so now for x64 uses by their payloads
I've heard people

88
00:05:41,830 --> 00:05:45,220
actually you seen on run

89
00:05:45,220 --> 00:05:48,389
like PE files actually press it down so
it

90
00:05:48,389 --> 00:05:51,990
because an actual pillared you can I
support a six pack your rights

91
00:05:51,990 --> 00:05:55,600
and that's pretty huge jeff is expected
like Taylor

92
00:05:55,600 --> 00:05:58,710
and so good I've heard people actually
using

93
00:05:58,710 --> 00:06:03,169
using this is a dropper a method to that
to drop other miners

94
00:06:03,169 --> 00:06:09,210
Addison generate reported ice is our
first dinner

95
00:06:09,210 --> 00:06:14,270
alright so I'm richer moderate clears

96
00:06:14,270 --> 00:06:19,289
right so

97
00:06:19,289 --> 00:06:23,910
I'm going to patch WinRAR x64

98
00:06:23,910 --> 00:06:27,470
going to use a IOC

99
00:06:27,470 --> 00:06:31,300
see see what we have available

100
00:06:31,300 --> 00:06:34,699
so we have all these pillars avail on
for this

101
00:06:34,699 --> 00:06:40,919
I'm going to use river Scheldt ECP

102
00:06:40,919 --> 00:06:44,350
going to you pick my host which is

103
00:06:44,350 --> 00:06:47,630
incidences 16 or to

104
00:06:47,630 --> 00:06:53,180
courts he sorry have a mess with us are
set up

105
00:06:53,180 --> 00:06:57,930
make this easier now you'll see that
it's looking for cave

106
00:06:57,930 --> 00:07:02,710
561 fights nets huge and is one cable
available

107
00:07:02,710 --> 00:07:06,840
I couldn't hit a jumper J and that's
puts that into different

108
00:07:06,840 --> 00:07:11,220
I'll different sizes so that you have
more caves work with

109
00:07:11,220 --> 00:07:14,389
& Co K you don't know kate is just a
a.m.

110
00:07:14,389 --> 00:07:18,110
empty place in a binary that's yours and
you could put

111
00:07:18,110 --> 00:07:22,000
when everyone in there may break the
binary may not if it's if it says non

112
00:07:22,000 --> 00:07:22,610
here

113
00:07:22,610 --> 00:07:26,610
means don't use it I should just hide
that

114
00:07:26,610 --> 00:07:31,120
but I'm actually working on a way to
solve what I call the cocaine injection

115
00:07:31,120 --> 00:07:32,740
problem in the problem is

116
00:07:32,740 --> 00:07:35,840
not every cable works because they may
be in it

117
00:07:35,840 --> 00:07:38,870
for whatever reason maybe a data type
that you cannot use

118
00:07:38,870 --> 00:07:43,030
I'm working away to get around that and
I think I'm pretty close

119
00:07:43,030 --> 00:07:46,680
to solving that so this can all be
automated

120
00:07:46,680 --> 00:07:50,310
so II and for for demonstration purposes
I'm gonna

121
00:07:50,310 --> 00:07:56,120
hence I Taipei ever see that okay
receptor

122
00:07:56,120 --> 00:08:01,650
okay i still can use a mouse

123
00:08:01,650 --> 00:08:05,370
to get art

124
00:08:05,370 --> 00:08:09,289
serpent at and I'm going to appended a
new section

125
00:08:09,289 --> 00:08:12,319
and it it gives a section on

126
00:08:12,319 --> 00:08:19,319
Read Write execute permissions

127
00:08:23,560 --> 00:08:27,060
alright so copied over in this so this

128
00:08:27,060 --> 00:08:31,120
is a win is a .1 on the M

129
00:08:31,120 --> 00:08:35,029
has he might run into this this binder
is not talk about you that right now

130
00:08:35,029 --> 00:08:41,180
has Windows Defender an issue happens

131
00:08:41,180 --> 00:08:45,700
yes alright show

132
00:08:45,700 --> 00:08:49,260
and I can also install WinRAR so still
use

133
00:08:49,260 --> 00:08:53,470
this is what danger talk about it to use

134
00:08:53,470 --> 00:08:56,990
for those it's all a top alright so a

135
00:08:56,990 --> 00:09:00,120
there's there's the first ima

136
00:09:00,120 --> 00:09:04,200
who alright

137
00:09:04,200 --> 00:09:08,089
back to the boring presentation

138
00:09:08,089 --> 00:09:11,500
I so the next text format was I'll and

139
00:09:11,500 --> 00:09:14,760
so for those who don't know Linux use L

140
00:09:14,760 --> 00:09:18,380
right her health is to the primary
format

141
00:09:18,380 --> 00:09:22,100
for the next environment it's also the
current for the next

142
00:09:22,100 --> 00:09:25,660
is very stable has been around long time
i think is more complex than the

143
00:09:25,660 --> 00:09:30,130
PE format on and it's been heavily
research so heavily researched that

144
00:09:30,130 --> 00:09:32,510
never I asked from the mining of Master

145
00:09:32,510 --> 00:09:35,730
he wrote it article and frack apps

146
00:09:35,730 --> 00:09:39,580
issue 67 about k probes this rotation

147
00:09:39,580 --> 00:09:43,120
his check it out so the guy says
coworker and the method he pointed to

148
00:09:43,120 --> 00:09:43,690
was a

149
00:09:43,690 --> 00:09:48,080
text segment padding up code injection
infection

150
00:09:48,080 --> 00:09:52,110
called and this was originally from so
the Aussies are

151
00:09:52,110 --> 00:09:55,990
in 1999 he this is on the X haven't seen
you can check it out and

152
00:09:55,990 --> 00:09:59,450
years a whole list of things you can do
to they'll format

153
00:09:59,450 --> 00:10:04,970
this is in 1999 like I said office table
is still works

154
00:10:04,970 --> 00:10:08,579
on where you guys doing in 1999 silvio

155
00:10:08,579 --> 00:10:13,980
was patching up files in C

156
00:10:13,980 --> 00:10:18,610
so does it work you extend the on text
segment by page size

157
00:10:18,610 --> 00:10:22,050
and then you patcher code into it and
then

158
00:10:22,050 --> 00:10:26,089
you change the program hatter's up and
the section headers that are behind that

159
00:10:26,089 --> 00:10:26,740
takes

160
00:10:26,740 --> 00:10:30,149
text segment I to proper

161
00:10:30,149 --> 00:10:34,290
memory can also file offsets to
accommodate the new page size

162
00:10:34,290 --> 00:10:37,600
and then change entry point to the
location a paler

163
00:10:37,600 --> 00:10:40,750
and dementia in the payload you I up

164
00:10:40,750 --> 00:10:45,510
continue you for your paper and then you
continue the original entry point

165
00:10:45,510 --> 00:10:50,089
it's actually is pretty summer so I
added over over the over the year

166
00:10:50,089 --> 00:10:53,950
I added up Linux x86-64 in February

167
00:10:53,950 --> 00:10:57,620
FreeBSD x86 ilex arm

168
00:10:57,620 --> 00:11:01,260
little Indian 32-bit and the you user to
provide

169
00:11:01,260 --> 00:11:04,950
are orchid could provide their own
payloads for all these on

170
00:11:04,950 --> 00:11:07,950
types he's gotta make sure serait chips
chipset

171
00:11:07,950 --> 00:11:11,029
had to make sure it's the on the right

172
00:11:11,029 --> 00:11:15,980
shellcode payload so that if you're
using Cisco's it is to that specific

173
00:11:15,980 --> 00:11:19,500
OS in ship Architektur I

174
00:11:19,500 --> 00:11:22,810
some people tried to estimate a pull
request

175
00:11:22,810 --> 00:11:26,100
up for for FreeBSD

176
00:11:26,100 --> 00:11:31,200
and using lennox says cost that didn't
go well

177
00:11:31,200 --> 00:11:38,200
right so Ultimo

178
00:11:39,410 --> 00:11:40,190
so I'm

179
00:11:40,190 --> 00:11:47,190
do I'm gonna patch alas right

180
00:11:50,270 --> 00:11:53,630
and then same type a

181
00:11:53,630 --> 00:11:56,640
command line usage so when attached alas

182
00:11:56,640 --> 00:12:00,680
see what we have available so I had her
first

183
00:12:00,680 --> 00:12:04,890
I shall TCP reverse TCP stager and then
user click user

184
00:12:04,890 --> 00:12:09,290
supplied shoko so I'm just gonna do it a
simple river Scheldt ECP

185
00:12:09,290 --> 00:12:16,290
you see that

186
00:12:23,390 --> 00:12:27,370
it checks to see what the chipset is
system deep it died

187
00:12:27,370 --> 00:12:30,440
gathers did necessary data it

188
00:12:30,440 --> 00:12:34,020
it looks at the link to the show cuz
you're going to patch

189
00:12:34,020 --> 00:12:37,240
and then fast binary says

190
00:12:37,240 --> 00:12:40,540
x64 right so let's go ahead and run this

191
00:12:40,540 --> 00:12:43,550
you'll see

192
00:12:43,550 --> 00:12:50,550
sickness consider back to itself right

193
00:13:00,910 --> 00:13:07,910
there we go

194
00:13:09,790 --> 00:13:12,850
I'm so so far where px 64

195
00:13:12,850 --> 00:13:16,450
a a couple of formats and next it-based

196
00:13:16,450 --> 00:13:21,560
Taylor so when you're

197
00:13:21,560 --> 00:13:25,900
when your passion wind is executed rules
and something to keep in mind that

198
00:13:25,900 --> 00:13:29,570
compile code is static go on

199
00:13:29,570 --> 00:13:32,980
that's why I position independent code
sticks out so far

200
00:13:32,980 --> 00:13:38,950
whenever it's injected into an exploit
that's what he met is protecting against

201
00:13:38,950 --> 00:13:43,790
is position independent code so

202
00:13:43,790 --> 00:13:48,170
win your passion a binary you didn't you
do not need position independent code

203
00:13:48,170 --> 00:13:51,510
cigarette your payload stacked just like

204
00:13:51,510 --> 00:13:58,510
I have compile code so the best way to
do that do this is use import at a

205
00:13:58,540 --> 00:13:59,050
stable

206
00:13:59,050 --> 00:14:03,420
so I got this idea after reading bypass
he met with 11 biter tonight

207
00:14:03,420 --> 00:14:07,680
so a quick high-level import address
able

208
00:14:07,680 --> 00:14:10,700
has I'm winners API's in there

209
00:14:10,700 --> 00:14:13,850
and they're called on is a

210
00:14:13,850 --> 00:14:18,200
fun table and has all the API said that
binary

211
00:14:18,200 --> 00:14:21,209
that particular binary needs and

212
00:14:21,209 --> 00:14:24,390
they are in the same location sir so say
a binary day

213
00:14:24,390 --> 00:14:27,610
binary a loads up in memory

214
00:14:27,610 --> 00:14:30,330
every single time lows a memory that
some tables in the same distance from

215
00:14:30,330 --> 00:14:31,650
entry point everything time

216
00:14:31,650 --> 00:14:34,680
statically compile code needs that

217
00:14:34,680 --> 00:14:38,200
binary be will have different Windows
APIs

218
00:14:38,200 --> 00:14:41,600
and the timetable would be the same
distance everything's

219
00:14:41,600 --> 00:14:45,160
in in for our payloads

220
00:14:45,160 --> 00:14:48,880
Metasploit you sis are you need is Lodi
burying a process

221
00:14:48,880 --> 00:14:52,740
so for those you that you any meds play
developing the should be

222
00:14:52,740 --> 00:14:57,770
should our universe then in the nice
thing is that most Windows programs have

223
00:14:57,770 --> 00:14:58,750
these two API's

224
00:14:58,750 --> 00:15:03,120
in the I in the timetable not all the
most

225
00:15:03,120 --> 00:15:06,980
so how does has work I course I T for
these two

226
00:15:06,980 --> 00:15:10,510
on these two windows API's I figured out
what they're upset from

227
00:15:10,510 --> 00:15:13,750
a from from entry point is by looking at
the static

228
00:15:13,750 --> 00:15:17,339
numbers on disk and then I A take

229
00:15:17,339 --> 00:15:20,410
when one's memory I take DDX

230
00:15:20,410 --> 00:15:23,800
has 120 x86 binaries learning memory
edix

231
00:15:23,800 --> 00:15:29,020
points it DX has the entry point the
address at the entry point so I just

232
00:15:29,020 --> 00:15:29,650
take that

233
00:15:29,650 --> 00:15:33,950
with the what I know is the offsets are
then I have the library a get processors

234
00:15:33,950 --> 00:15:37,380
and then I go through a step through
that every

235
00:15:37,380 --> 00:15:40,400
Windows API that mean and I track bases

236
00:15:40,400 --> 00:15:43,640
is like a shell game I track the address
is

237
00:15:43,640 --> 00:15:46,800
in different registers for the library a
depressed center signature

238
00:15:46,800 --> 00:15:52,800
that I'd have them available for each
Windows API right now it's on the x86

239
00:15:52,800 --> 00:15:53,360
reversed

240
00:15:53,360 --> 00:15:56,430
a TCP shell just a shell popular jet

241
00:15:56,430 --> 00:16:01,140
it beats unit 50 because it acts like
stacking compile code

242
00:16:01,140 --> 00:16:04,140
I releases in May 2014 with another

243
00:16:04,140 --> 00:16:07,350
project that I'm you show your second
and for

244
00:16:07,350 --> 00:16:10,360
a division is pretty good so opinion

245
00:16:10,360 --> 00:16:13,510
a opinion a on koch et

246
00:16:13,510 --> 00:16:16,550
for NACA okay but a new section on a
binary at the end

247
00:16:16,550 --> 00:16:20,520
retread execute should be a red flag for
every single AB Thunder

248
00:16:20,520 --> 00:16:25,720
if I really taken put knots and a new
section on the and a binary

249
00:16:25,720 --> 00:16:29,670
I would get a about the same result 13
at 54

250
00:16:29,670 --> 00:16:32,820
antivirus like this because it is
suspicious

251
00:16:32,820 --> 00:16:36,320
perhaps that me right excuse section on
the end

252
00:16:36,320 --> 00:16:39,810
but if I could go to a single okay I get
to add

253
00:16:39,810 --> 00:16:43,459
were and I do not like okay jumpin' it
wanted

254
00:16:43,459 --> 00:16:47,760
for and kinda funny is that it's McAfee

255
00:16:47,760 --> 00:16:51,339
now I've never had McAfee in a real
environment ever catch anything

256
00:16:51,339 --> 00:16:54,520
ever that idea nothing so

257
00:16:54,520 --> 00:16:58,370
this is the when you see behaves like
that is there Chris tix engine

258
00:16:58,370 --> 00:17:02,150
and so on of course umpires total they
haven't turned up all the way

259
00:17:02,150 --> 00:17:06,570
but if you did this in an enterprise
environment you can open a word document

260
00:17:06,570 --> 00:17:09,689
were PDF so I think this is kinda funny

261
00:17:09,689 --> 00:17:13,350
this is what I would you call this a
false negative

262
00:17:13,350 --> 00:17:18,030
for a positive positive I don't wanna
but you posit

263
00:17:18,030 --> 00:17:23,160
alright so on next we're going to talk
about mental passion binaries

264
00:17:23,160 --> 00:17:27,110
I'm any any questions right now this can
be interactive you buy any questions on

265
00:17:27,110 --> 00:17:28,679
us

266
00:17:28,679 --> 00:17:31,750
are

267
00:17:31,750 --> 00:17:35,900
i sorry sis in May 2014 the same time as
I T E

268
00:17:35,900 --> 00:17:39,500
on payload and

269
00:17:39,500 --> 00:17:43,000
the reason I wanted this out there the
OPP is because not many

270
00:17:43,000 --> 00:17:46,390
web sites for serving minors still do
not

271
00:17:46,390 --> 00:17:50,560
use ssl/tls and this is disturbing

272
00:17:50,560 --> 00:17:54,640
and there's no there was open source PO
si

273
00:17:54,640 --> 00:17:58,179
now bernie Jack in 2007 can sequester he
released

274
00:17:58,179 --> 00:18:01,919
a on waitin release showed an exploit

275
00:18:01,919 --> 00:18:06,550
love rewriting firmware router and then
patching P execute it was as they went

276
00:18:06,550 --> 00:18:07,380
through the router

277
00:18:07,380 --> 00:18:12,730
the Homer now those executed was will
not continue execution

278
00:18:12,730 --> 00:18:16,520
they would you that the person we're in
the binary in the payload would

279
00:18:16,520 --> 00:18:20,340
Ron bites

280
00:18:20,340 --> 00:18:24,490
it worked in this was seven years ago
and not much just come out there was a

281
00:18:24,490 --> 00:18:25,040
paper

282
00:18:25,040 --> 00:18:30,520
in 2008 I found two months ago probably
because at the funny title

283
00:18:30,520 --> 00:18:33,740
soccer distribution our infection vector

284
00:18:33,740 --> 00:18:37,150
I just think that's weird title and I
didn't Google

285
00:18:37,150 --> 00:18:41,130
infection vector for distribution and I
never found this so I can add two months

286
00:18:41,130 --> 00:18:42,500
ago

287
00:18:42,500 --> 00:18:45,640
I their method was they would attend I S

288
00:18:45,640 --> 00:18:50,419
there evil code: they they did so what
they did is aided streaming patching

289
00:18:50,419 --> 00:18:53,540
so is extremely fast supposedly written
in C

290
00:18:53,540 --> 00:18:56,960
then release the PSE and they would
depend

291
00:18:56,960 --> 00:19:00,790
up the malicious code on the begin the
binder

292
00:19:00,790 --> 00:19:04,820
so what happens at that point is that
your icon is going to change

293
00:19:04,820 --> 00:19:09,550
so that the user is looking for specific
icon they notice posted be

294
00:19:09,550 --> 00:19:13,360
user would see a San Diego I don't know
what this is

295
00:19:13,360 --> 00:19:17,340
if they if they're smart but chances are
users would run this anyway

296
00:19:17,340 --> 00:19:22,010
I could implement this I if people want
me to

297
00:19:22,010 --> 00:19:26,300
anyway certain no public PSE's I try to
find these be a season and they're just

298
00:19:26,300 --> 00:19:27,060
another

299
00:19:27,060 --> 00:19:31,080
so I wanted to the public on so here's
some a short list

300
00:19:31,080 --> 00:19:35,200
of sites that are projects that do not
use SSL

301
00:19:35,200 --> 00:19:40,250
so Sysinternals dizzy my uses internals
and enterprise environment

302
00:19:40,250 --> 00:19:43,860
do you check the digital signatures

303
00:19:43,860 --> 00:19:48,070
I hope so Microsoft the comp now

304
00:19:48,070 --> 00:19:52,020
the update process is in the clear but
as long as you stay with an automatic

305
00:19:52,020 --> 00:19:53,730
update your okay

306
00:19:53,730 --> 00:19:58,650
she tried to update anything outside
about a manic updates manually

307
00:19:58,650 --> 00:20:02,179
a couple those things a couple those
updates

308
00:20:02,179 --> 00:20:06,030
or cabey's on are not protected

309
00:20:06,030 --> 00:20:09,750
so that's that's actually kinda an issue
up

310
00:20:09,750 --> 00:20:13,790
most save the vendors so you you're
listening to disperse your Mac be

311
00:20:13,790 --> 00:20:17,280
the whole sign-up process taking your
money and everything is

312
00:20:17,280 --> 00:20:20,419
in cricket but as soon as you click to
get the installer

313
00:20:20,419 --> 00:20:25,090
its nuclear and it's in the background
so you really LSU LSU

314
00:20:25,090 --> 00:20:28,970
look you how it's been downloaded you
don't know

315
00:20:28,970 --> 00:20:32,470
it is yeah Kaspersky is a market

316
00:20:32,470 --> 00:20:38,679
answers Mac I'm getting don't sue me

317
00:20:38,679 --> 00:20:41,860
yes your crack I'll get to that I'm

318
00:20:41,860 --> 00:20:45,919
the the comment was that the banners our
side and their

319
00:20:45,919 --> 00:20:48,980
so you're getting sacked

320
00:20:48,980 --> 00:20:52,140
art source force I most these are not
signed

321
00:20:52,140 --> 00:20:55,540
I but the use something called NS I S
and that is a

322
00:20:55,540 --> 00:20:58,810
fine urself checker so if if your patch
with the on

323
00:20:58,810 --> 00:21:02,000
BDF her via proxy you get air

324
00:21:02,000 --> 00:21:05,530
when you're on the binary on saying that

325
00:21:05,530 --> 00:21:10,899
it's been modified but after the payload
executes because I cook entry point

326
00:21:10,899 --> 00:21:14,950
n you can also buy I I've been able to
automatically bypass

327
00:21:14,950 --> 00:21:17,950
in a science but there's so many
versions that I would have to build

328
00:21:17,950 --> 00:21:22,179
probably like five or six different ways
a checking to see which version A

329
00:21:22,179 --> 00:21:26,850
in S I S it is so it's kinda is pretty
problematic

330
00:21:26,850 --> 00:21:30,429
but whatever party when SEP

331
00:21:30,429 --> 00:21:33,960
that in software do you guys know it got
its offer makes

332
00:21:33,960 --> 00:21:37,679
in case now writes

333
00:21:37,679 --> 00:21:42,130
semi I keep going seen at up the way
this this look at our lives just charles

334
00:21:42,130 --> 00:21:42,800
is a

335
00:21:42,800 --> 00:21:46,390
case site with this

336
00:21:46,390 --> 00:21:49,590
marks on dish comes back their side

337
00:21:49,590 --> 00:21:55,220
and he's correct now being hackers was a
next logical step

338
00:21:55,220 --> 00:21:59,130
sorry moving the peace injure is
actually pretty easy to do

339
00:21:59,130 --> 00:22:03,100
I so you find a specific detail is an
optional Heather

340
00:22:03,100 --> 00:22:07,940
in PE header and there's it's a bytes
long has the address in the size

341
00:22:07,940 --> 00:22:11,560
the binary I mean the size of a stick at

342
00:22:11,560 --> 00:22:18,090
is there that out mountainside and this
is the fall behavior media

343
00:22:18,090 --> 00:22:23,730
cell up now you do you know what the
three types buyers they are so they're

344
00:22:23,730 --> 00:22:24,960
they're signed binary

345
00:22:24,960 --> 00:22:28,040
unsigned binary and and binary the bad
signature

346
00:22:28,040 --> 00:22:34,250
users are gonna run one into they might
run three

347
00:22:34,250 --> 00:22:37,550
so in export tries to help you out with
us so

348
00:22:37,550 --> 00:22:43,350
the top pitcher is yes sack descriptor
about that's a bad it's a bad

349
00:22:43,350 --> 00:22:47,600
digital signature and it gives you the
option to closer delete if you closed on

350
00:22:47,600 --> 00:22:48,419
desk

351
00:22:48,419 --> 00:22:52,300
Julie tourism that's good now the bottom
is the same

352
00:22:52,300 --> 00:22:55,320
same binary without signature

353
00:22:55,320 --> 00:22:58,440
but this is only Internet Explorer

354
00:22:58,440 --> 00:23:01,850
that's it now hi people

355
00:23:01,850 --> 00:23:07,050
is an explorer so where it's at H 8.3
percent

356
00:23:07,050 --> 00:23:14,050
yes not much so in Chrome and Firefox do
not have the same checks

357
00:23:15,429 --> 00:23:19,310
alright so once you get a binary have
you checked the digital signature

358
00:23:19,310 --> 00:23:22,500
well natively there's no way on Windows

359
00:23:22,500 --> 00:23:26,440
side right clicking going to properties
in seeing the tab digital signatures

360
00:23:26,440 --> 00:23:29,880
the check and see if there's also
features okay there's no way natively

361
00:23:29,880 --> 00:23:33,940
without downloading something from
Microsoft

362
00:23:33,940 --> 00:23:36,940
sure going this from Microsoft to

363
00:23:36,940 --> 00:23:40,649
for you could you could use powershell
script or something check

364
00:23:40,649 --> 00:23:44,030
md5 ashes check shot hashes

365
00:23:44,030 --> 00:23:47,399
were even on to check the signature

366
00:23:47,399 --> 00:23:50,510
you can right-click good properties like
I said so this is

367
00:23:50,510 --> 00:23:54,010
this is a I a banner that has a digital
signature

368
00:23:54,010 --> 00:23:57,610
address incise and stick a table still

369
00:23:57,610 --> 00:24:01,399
present now this is what happens when
your sure that out

370
00:24:01,399 --> 00:24:04,770
the tab is gone so the

371
00:24:04,770 --> 00:24:10,440
the docking system camp brute force
where this interview tape should be

372
00:24:10,440 --> 00:24:14,610
so smart screens go into another useless
permission

373
00:24:14,610 --> 00:24:19,140
per and was not use this just nine

374
00:24:19,140 --> 00:24:22,919
right so what this march reduce March
cream will sit there and tell you

375
00:24:22,919 --> 00:24:26,810
that this app is not common and that's
it can tell you this malicious a can

376
00:24:26,810 --> 00:24:28,080
tell you

377
00:24:28,080 --> 00:24:32,270
it's like a is like a father say to a
daughter I don't know this guy

378
00:24:32,270 --> 00:24:35,750
it's pretty much it and so

379
00:24:35,750 --> 00:24:39,500
you can actually just run it anyway any
only one you want after that it's like

380
00:24:39,500 --> 00:24:42,820
okay go ahead to everyone with your life

381
00:24:42,820 --> 00:24:47,050
up but if you will Smart Filter winners
8.1

382
00:24:47,050 --> 00:24:50,649
the first the first step is the first
result is

383
00:24:50,649 --> 00:24:53,740
okay use a smart filter the next his
return office for

384
00:24:53,740 --> 00:24:56,740
sir so

385
00:24:56,740 --> 00:25:02,230
and his forty nine thousand results so
people are turning off Smart Filter

386
00:25:02,230 --> 00:25:05,730
I so some features I'm soyuz man
approximate number

387
00:25:05,730 --> 00:25:08,940
no proxy does all the heavy lifting what
I do is I take

388
00:25:08,940 --> 00:25:12,830
in handle every request response and I
look at it

389
00:25:12,830 --> 00:25:16,560
desi really the by to look at the Magic
header to see if it's a

390
00:25:16,560 --> 00:25:19,679
on you know tell PE

391
00:25:19,679 --> 00:25:24,370
Sep tar yes the supports a zip in
archive formats

392
00:25:24,370 --> 00:25:28,610
but what's a pintar formats but our
house was written by out Victor

393
00:25:28,610 --> 00:25:34,970
Stan church II he canceling some code
and he definitely help me out with that

394
00:25:34,970 --> 00:25:38,220
also it up it's a mess quit IRC script
the Metasploit

395
00:25:38,220 --> 00:25:42,149
consul thats is catching payload rain
our shelter now

396
00:25:42,149 --> 00:25:45,919
is what I use to to launch that

397
00:25:45,919 --> 00:25:50,070
so this is the app media oxy configures
the overall configure

398
00:25:50,070 --> 00:25:55,190
there's a very nice can fake that
because its limitations to Manal proxy

399
00:25:55,190 --> 00:25:57,270
right now these when I wrote this

400
00:25:57,270 --> 00:26:01,370
II rutan I really nice can take with
quite the same blacklist these oh I have

401
00:26:01,370 --> 00:26:04,750
there's overall section overall section

402
00:26:04,750 --> 00:26:08,389
allows you to configure the proxy before
you run it for whatever settings you

403
00:26:08,389 --> 00:26:09,250
want in this is

404
00:26:09,250 --> 00:26:12,960
what this the only part that you can
fake before you launch it

405
00:26:12,960 --> 00:26:16,980
everything else you can on update on the
fly and the next request

406
00:26:16,980 --> 00:26:20,850
soon as you say that the next request
comes in it's applied so

407
00:26:20,850 --> 00:26:24,580
this this starts the live update in ok
so if you get this

408
00:26:24,580 --> 00:26:28,120
like I said the next request it supplied

409
00:26:28,120 --> 00:26:31,780
with the seven so I've host host our
servers that you're talking like

410
00:26:31,780 --> 00:26:35,590
Sysinternals Microsoft so when you say
whitelist

411
00:26:35,590 --> 00:26:39,020
I want to patch everything coming and so
if you wanna send it to just one server

412
00:26:39,020 --> 00:26:39,710
he say

413
00:26:39,710 --> 00:26:44,139
i won you a source for child in so you
take out on you but SourceForge

414
00:26:44,139 --> 00:26:45,020
blacklist

415
00:26:45,020 --> 00:26:48,820
is for host I do not want to catch
anything from Microsoft

416
00:26:48,820 --> 00:26:53,020
okay keywords whatever's in Europe ap

417
00:26:53,020 --> 00:26:57,220
so if you wanna hit I a few if you want
patch just TCP view you just but then a

418
00:26:57,220 --> 00:26:58,070
whitelist

419
00:26:58,070 --> 00:27:02,040
if are you do not want to patch it so
you have Blackline you have a blacklist

420
00:27:02,040 --> 00:27:05,389
first for example and I do not wanna
patch to spew

421
00:27:05,389 --> 00:27:09,940
Skype or any deals now the target
section

422
00:27:09,940 --> 00:27:13,320
is how you want to handle a specific
chipset

423
00:27:13,320 --> 00:27:16,889
were architecture were less actually

424
00:27:16,889 --> 00:27:20,720
and within that you have the all yours
always two brackets

425
00:27:20,720 --> 00:27:24,840
this is a higher it's a hierarchy so the
more brackets the lower

426
00:27:24,840 --> 00:27:29,159
it is in the configuration so the all

427
00:27:29,159 --> 00:27:33,110
sets all right so I go through

428
00:27:33,110 --> 00:27:36,169
you go through the set for every chipset
every

429
00:27:36,169 --> 00:27:39,510
operating system you check he said how
you want to handle

430
00:27:39,510 --> 00:27:42,800
on payloads for the c2

431
00:27:42,800 --> 00:27:46,030
now you need to make sure that you don't
send a Lennox

432
00:27:46,030 --> 00:27:50,139
stager to a Windows machine you have a
bad day

433
00:27:50,139 --> 00:27:54,370
you at your you will sect called on the
on on the target

434
00:27:54,370 --> 00:27:58,350
so you said different this is why I had
this configures so that you can set

435
00:27:58,350 --> 00:28:02,020
a different ports so that everything
works together properly

436
00:28:02,020 --> 00:28:05,370
now knows that always to two brackets

437
00:28:05,370 --> 00:28:09,230
donors here this is internal to calm is
two brackets what this means

438
00:28:09,230 --> 00:28:14,120
is it inherits from all and then you
overwrite anything that you do not want

439
00:28:14,120 --> 00:28:17,100
to do or you do want to do

440
00:28:17,100 --> 00:28:20,350
and this as soon as you say this like I
said

441
00:28:20,350 --> 00:28:24,690
it's applied to if you want to make a
change you can also use hosts you can

442
00:28:24,690 --> 00:28:25,060
use

443
00:28:25,060 --> 00:28:28,720
as you see here I'm using host names you
could use IP addresses I suggest using

444
00:28:28,720 --> 00:28:29,730
both

445
00:28:29,730 --> 00:28:33,090
because sometimes the download comes
from a different IP and

446
00:28:33,090 --> 00:28:37,510
it really doesn't have a hostname CSS
the convict

447
00:28:37,510 --> 00:28:41,419
in for this conference for for today
this is my setup

448
00:28:41,419 --> 00:28:46,580
I had the Internet which everyone knows
India proxy in NY 504

449
00:28:46,580 --> 00:28:50,350
please do not shell-shocked be

450
00:28:50,350 --> 00:28:54,869
and I'm on a Mac machine I'm living
dangerously

451
00:28:54,869 --> 00:29:01,869
it's up to the demo

452
00:29:04,060 --> 00:29:07,899
alright are you have BDF on

453
00:29:07,899 --> 00:29:12,470
proxy running and I just started over

454
00:29:12,470 --> 00:29:15,760
so that's all it takes to run its I mean
retail the

455
00:29:15,760 --> 00:29:22,760
and its

456
00:29:26,649 --> 00:29:30,879
rights are gonna tale The a log and
there's logs for both you can change it

457
00:29:30,879 --> 00:29:35,480
warning debug it so use the Python login

458
00:29:35,480 --> 00:29:39,500
right so starter be a proxy you notice
here

459
00:29:39,500 --> 00:29:43,639
that's it out that's what your settings
are so you can look at see what your

460
00:29:43,639 --> 00:29:44,629
settings are

461
00:29:44,629 --> 00:29:48,379
this isn't a python ticked format

462
00:29:48,379 --> 00:29:51,970
right and we ever on MSF consul running

463
00:29:51,970 --> 00:29:55,090
Solis the surf perhaps a Niners

464
00:29:55,090 --> 00:29:59,050
this is the first thing I'm gonna patch
is

465
00:29:59,050 --> 00:30:03,879
the Microsoft the standard Microsoft
cool

466
00:30:03,879 --> 00:30:07,899
thats they recommend to get for checkin
md5

467
00:30:07,899 --> 00:30:14,830
and Shaw ashes

468
00:30:14,830 --> 00:30:20,080
course IBM wants to rent sliver

469
00:30:20,080 --> 00:30:27,080
its stage fright

470
00:30:35,149 --> 00:30:42,149
is picture

471
00:30:57,560 --> 00:31:00,899
Sarna how fast the connection is

472
00:31:00,899 --> 00:31:06,659
whatnot try

473
00:31:06,659 --> 00:31:13,659
read-back this

474
00:31:17,310 --> 00:31:21,960
writer I so you see here is called the

475
00:31:21,960 --> 00:31:27,600
job

476
00:31:27,600 --> 00:31:30,669
available availability description

477
00:31:30,669 --> 00:31:37,669
work

478
00:31:40,270 --> 00:31:44,080
the check if I'll check some integrity
verifier utility

479
00:31:44,080 --> 00:31:48,909
right so i can download it here

480
00:31:48,909 --> 00:31:52,020
so you'll see that just make a selection
like

481
00:31:52,020 --> 00:31:55,970
before but I can just hit a her

482
00:31:55,970 --> 00:31:59,450
and should for long

483
00:31:59,450 --> 00:32:02,550
there we go now

484
00:32:02,550 --> 00:32:09,550
I'm I run that I disable Smart Filter
like the web said to do

485
00:32:11,409 --> 00:32:15,149
nigga shell restate

486
00:32:15,149 --> 00:32:22,149
richer for it and the fireworks turn

487
00:32:23,060 --> 00:32:23,690
all right

488
00:32:23,690 --> 00:32:28,200
I'm the six Sysinternals are two runs

489
00:32:28,200 --> 00:32:32,179
its run on two runs

490
00:32:32,179 --> 00:32:37,259
now the shell came in

491
00:32:37,259 --> 00:32:42,669
just brushes down here on C

492
00:32:42,669 --> 00:32:46,580
she's

493
00:32:46,580 --> 00:32:53,580
review so I can view my own connection
going out way that would be scary right

494
00:32:56,639 --> 00:33:00,370
my steez review contacting China

495
00:33:00,370 --> 00:33:03,610
a look

496
00:33:03,610 --> 00:33:07,309
group

497
00:33:07,309 --> 00:33:11,840
right Alice just to drive the point home

498
00:33:11,840 --> 00:33:17,690
miss to Process Explorer yea

499
00:33:17,690 --> 00:33:24,370
alphabet by others

500
00:33:24,370 --> 00:33:27,440
okay so there's not much slack when
you're

501
00:33:27,440 --> 00:33:33,289
fast connection recap

502
00:33:33,289 --> 00:33:40,289
the CE Process Explorer has a command on
EXE

503
00:33:40,919 --> 00:33:45,509
hang of it an outing of

504
00:33:45,509 --> 00:33:48,600
explore okay

505
00:33:48,600 --> 00:33:52,909
so there's the see what else we can do
it either other sites we can patch

506
00:33:52,909 --> 00:33:56,240
to to from

507
00:33:56,240 --> 00:33:59,330
so this what I like about PE bear

508
00:33:59,330 --> 00:34:03,070
not only does have different binaries
for this damn on

509
00:34:03,070 --> 00:34:06,529
I to me because I know it has on

510
00:34:06,529 --> 00:34:09,780
on the site's that soapy bear is an
awesome tool

511
00:34:09,780 --> 00:34:13,339
if you wanna look at the PE file looking
like how the I H E is

512
00:34:13,339 --> 00:34:16,339
you know you where it is a memory is
actually great

513
00:34:16,339 --> 00:34:19,839
if you like working injuries Sosa

514
00:34:19,839 --> 00:34:24,869
download 64 bit version and

515
00:34:24,869 --> 00:34:28,700
so the stop me now here's PDF proxy you
can figure it out

516
00:34:28,700 --> 00:34:32,800
and and I look at every on requests come
in and now

517
00:34:32,800 --> 00:34:35,960
so it's still

518
00:34:35,960 --> 00:34:39,450
still waiting it's easier

519
00:34:39,450 --> 00:34:42,500
its connection here to

520
00:34:42,500 --> 00:34:45,719
so this is a file ice-covered

521
00:34:45,720 --> 00:34:49,879
okay sells quick on so what happen

522
00:34:49,879 --> 00:34:52,909
is ours step through it so I get a zip
file

523
00:34:52,909 --> 00:34:56,359
I I am packed zip file using temp found
Python

524
00:34:56,359 --> 00:35:01,010
and I i look at every single file in the
zip file to see what it is

525
00:35:01,010 --> 00:35:04,290
she was doing so I have a deal well and
so I have

526
00:35:04,290 --> 00:35:08,310
in my in my arm configuration I say I do
not wanna

527
00:35:08,310 --> 00:35:11,800
if it's in a zip file I do not want
patch deals

528
00:35:11,800 --> 00:35:14,960
on but

529
00:35:14,960 --> 00:35:19,020
gets it I comes across the P bear

530
00:35:19,020 --> 00:35:24,329
da txt and then attach that still going
through look at every file

531
00:35:24,329 --> 00:35:29,000
and then actors number files three packs
is the zip file in San on its way

532
00:35:29,000 --> 00:35:33,430
in

533
00:35:33,430 --> 00:35:37,040
right iced she also has released

534
00:35:37,040 --> 00:35:40,890
I'm someone X binary solo go and
download those

535
00:35:40,890 --> 00:35:47,650
ago

536
00:35:47,650 --> 00:35:53,450
has done now realize this is written in
Python

537
00:35:53,450 --> 00:35:56,550
and it's not see K so

538
00:35:56,550 --> 00:35:59,869
if an organization with a much bigger
budget had

539
00:35:59,869 --> 00:36:03,970
have or has we're going to have this
idea and

540
00:36:03,970 --> 00:36:09,560
if their ear I didn't see there would be
no delay to the user see

541
00:36:09,560 --> 00:36:12,810
on so that I downloaded the X 64 bit
binary

542
00:36:12,810 --> 00:36:16,130
there you go that's so that that's a the
sea

543
00:36:16,130 --> 00:36:19,849
I was that site now

544
00:36:19,849 --> 00:36:23,210
for the Windows I'm development STK
installer

545
00:36:23,210 --> 00:36:30,210
in

546
00:36:49,049 --> 00:36:52,740
ago

547
00:36:52,740 --> 00:36:59,740
so now I get development tools and watch
for the developers do in

548
00:36:59,930 --> 00:37:03,690
right so we're running short on time so

549
00:37:03,690 --> 00:37:07,920
another one else gun shows an hour bytes
and let's connect with Mr bytes

550
00:37:07,920 --> 00:37:12,349
is that I get to shells for the price is
$100.00 launch the installer

551
00:37:12,349 --> 00:37:17,650
one is regular user one is as admin

552
00:37:17,650 --> 00:37:24,650
but ok I'm gonna I'll archerd its kinda
cool

553
00:37:25,319 --> 00:37:28,470
howard's get the street amor

554
00:37:28,470 --> 00:37:35,470
come

555
00:37:47,260 --> 00:37:51,560
and you can set what method you use in
the config so you could say I want to do

556
00:37:51,560 --> 00:37:58,560
append only up

557
00:38:00,119 --> 00:38:06,450
the owners to shells come in so 8k man
and now nine

558
00:38:06,450 --> 00:38:10,730
so one israeli in 17 rights

559
00:38:10,730 --> 00:38:17,500
I'm moving on

560
00:38:17,500 --> 00:38:21,260
are so another thing I did was a for the
summer capstone engine you haven't

561
00:38:21,260 --> 00:38:22,700
checked our capstone engines of

562
00:38:22,700 --> 00:38:26,109
sports about a chipsets up

563
00:38:26,109 --> 00:38:30,250
and it's pretty amazing a there's a
presentation a black cat

564
00:38:30,250 --> 00:38:34,010
and I have my own to simpler dissimilar
n

565
00:38:34,010 --> 00:38:37,770
PDF it was kinda kind ghetto

566
00:38:37,770 --> 00:38:41,240
I I was trying just to map the entry
point instructions

567
00:38:41,240 --> 00:38:44,619
entire around and I would always have an
edge cases where

568
00:38:44,619 --> 00:38:48,450
I couldn't I didn't know an instruction
so I use a for this

569
00:38:48,450 --> 00:38:52,069
just I used capstone for disassembler
and I

570
00:38:52,069 --> 00:38:55,740
limited about five airlines occur

571
00:38:55,740 --> 00:39:02,740
right so this is the highlight at the
TOC

572
00:39:03,150 --> 00:39:06,720
so PDF Today sports AMACO Patchen

573
00:39:06,720 --> 00:39:10,030
but so or Marco sorry for those for this
picture

574
00:39:10,030 --> 00:39:13,490
hardcore less expense

575
00:39:13,490 --> 00:39:16,799
I don't know how to set that hatcher I

576
00:39:16,799 --> 00:39:19,980
OSX is is the binary go to format for

577
00:39:19,980 --> 00:39:23,040
an act there's also the that my name
which holds multiple

578
00:39:23,040 --> 00:39:26,319
Marco formats it's a very
straightforward format

579
00:39:26,319 --> 00:39:29,740
i think is easier to catch than elf and
also p

580
00:39:29,740 --> 00:39:34,890
so this is the format that's it no
seriously it's a it's a thankless

581
00:39:34,890 --> 00:39:38,299
so how I do it is it's called I called
the pretext section patching

582
00:39:38,299 --> 00:39:42,200
I ever the SIS on a blog post about a
month ago I haven't seen this

583
00:39:42,200 --> 00:39:46,920
anywhere else a a sec reverser said he
knew about it but he really wasn't

584
00:39:46,920 --> 00:39:48,690
talking about it

585
00:39:48,690 --> 00:39:52,970
so that's kinda cool so there's a lot of
empty space

586
00:39:52,970 --> 00:39:56,880
before the tech section I had some
purists tell me that's for alignment

587
00:39:56,880 --> 00:40:00,730
and for on for other historical reasons
and for pattern

588
00:40:00,730 --> 00:40:04,549
I really don't care and jackets I could
put break points in their accurate

589
00:40:04,549 --> 00:40:08,470
a whatever I wanted and the finer
restaurants I figured I could

590
00:40:08,470 --> 00:40:12,420
I can do whatever I want with it so what
I do is extend it xx

591
00:40:12,420 --> 00:40:15,520
SEK SEK text section forward based

592
00:40:15,520 --> 00:40:18,799
on the payload that I'm using and this
that

593
00:40:18,799 --> 00:40:21,940
tech section pretext section

594
00:40:21,940 --> 00:40:25,280
is actually really really large on some
these miners were talking like two

595
00:40:25,280 --> 00:40:26,630
thousand bites

596
00:40:26,630 --> 00:40:29,859
on so what are you is a except the tech
section

597
00:40:29,859 --> 00:40:33,980
locum and 2.2 that new up to begin the
payload

598
00:40:33,980 --> 00:40:37,069
night except the LC main I'll see you
next thread

599
00:40:37,069 --> 00:40:41,359
in these these control where the binary
stars memory and I make sure those

600
00:40:41,359 --> 00:40:45,549
point to the beginning of my pillar

601
00:40:45,549 --> 00:40:48,890
so for exist for example this is

602
00:40:48,890 --> 00:40:52,880
some zeros before the tech section you
see down the bottom

603
00:40:52,880 --> 00:40:57,200
that's the beginning of the text section
normally so up to their support

604
00:40:57,200 --> 00:41:01,560
x86 x64 fat binaries

605
00:41:01,560 --> 00:41:05,080
and also signature removal and the way
to signature in the room

606
00:41:05,080 --> 00:41:08,580
is that the up on the end the binary

607
00:41:08,580 --> 00:41:11,940
is where they keep the signature

608
00:41:11,940 --> 00:41:17,040
up woody car just a signature tables are
decisions the certificates

609
00:41:17,040 --> 00:41:21,020
and what you do is removal ok commands
that point to that

610
00:41:21,020 --> 00:41:25,970
pretty easy and now for the demo

611
00:41:25,970 --> 00:41:31,849
so I got about five minutes out to know
two things:

612
00:41:31,849 --> 00:41:37,299
from a good are

613
00:41:37,299 --> 00:41:41,339
first I'm going to patch Safari

614
00:41:41,339 --> 00:41:48,339
for those that don't know that's the web
browser

615
00:42:05,099 --> 00:42:08,400
you see here that's I it is LC main

616
00:42:08,400 --> 00:42:12,390
up based binary that means that they'll
see main is that your format

617
00:42:12,390 --> 00:42:16,730
for find an entry point and also I
remove their to

618
00:42:16,730 --> 00:42:23,730
on signatures on this binary Naruto's

619
00:42:36,020 --> 00:42:39,529
each

620
00:42:39,529 --> 00:42:44,960
somebody has I so you know someone
session nine right now

621
00:42:44,960 --> 00:42:48,630
me run safari to make sure

622
00:42:48,630 --> 00:42:52,049
I didn't do anything

623
00:42:52,049 --> 00:42:55,660
10 searched on session I'm so this is
not

624
00:42:55,660 --> 00:43:02,660
this is a clean Safari ho

625
00:43:04,680 --> 00:43:11,680
now

626
00:43:11,790 --> 00:43:12,500
so one

627
00:43:12,500 --> 00:43:17,130
my access my keychain cya session 10 is
that

628
00:43:17,130 --> 00:43:24,130
awesome or not

629
00:43:26,450 --> 00:43:29,570
and for those that think that I'm taking
everything

630
00:43:29,570 --> 00:43:33,500
up

631
00:43:33,500 --> 00:43:40,500
I room we're seeing write your own show
candice's

632
00:43:47,330 --> 00:43:52,610
is gonna be fun I'm let's do

633
00:43:52,610 --> 00:43:59,610
user so I mater

634
00:44:00,110 --> 00:44:03,880
kinda fun show confirmed as planets

635
00:44:03,880 --> 00:44:10,880
him

636
00:44:19,799 --> 00:44:24,890
when your them

637
00:44:24,890 --> 00:44:29,190
herro

638
00:44:29,190 --> 00:44:32,190
Derby Conn shall we play that game

639
00:44:32,190 --> 00:44:39,190
or do you want me to russell your
jimmies

640
00:44:45,430 --> 00:44:46,530
alright I'm

641
00:44:46,530 --> 00:44:52,210
just hope that my face its continue on

642
00:44:52,210 --> 00:44:57,990
so there you go that's what I compass
over this year not too shabby

643
00:44:57,990 --> 00:45:02,800
up so the room at going forward I'm
going to pour all the PE

644
00:45:02,800 --> 00:45:06,100
payloads it-based payloads so that

645
00:45:06,100 --> 00:45:09,110
so now with x64-bit

646
00:45:09,110 --> 00:45:12,290
he met catches position independent code

647
00:45:12,290 --> 00:45:16,400
so that means Metasploit payloads are
going to be broken now must find a way

648
00:45:16,400 --> 00:45:16,940
around it

649
00:45:16,940 --> 00:45:20,120
some import everything to it-based

650
00:45:20,120 --> 00:45:24,320
I'm gonna make on me the code keep
jumping I'm gonna implement

651
00:45:24,320 --> 00:45:27,510
be a proxy are the approx is streaming

652
00:45:27,510 --> 00:45:31,320
an ad was axe and I any other formats: I
at

653
00:45:31,320 --> 00:45:34,530
now the UPS format I think this is a
interesting form and I

654
00:45:34,530 --> 00:45:37,720
I think you can append a cocaine on
format and actually

655
00:45:37,720 --> 00:45:42,000
patch it that way instead of trying to
decompress it and also men were Ralph

656
00:45:42,000 --> 00:45:46,810
payloads on and also look into the MSI
format which is the installer

657
00:45:46,810 --> 00:45:52,170
second file and EMG so in conclusion I
think

658
00:45:52,170 --> 00:45:56,220
that hopefully some people with these
these companies

659
00:45:56,220 --> 00:46:00,430
the project see this and actually
comment SSL

660
00:46:00,430 --> 00:46:05,280
G less on their sites and please let
your clients know and we will rework

661
00:46:05,280 --> 00:46:08,830
checker hashes and be very careful what
you download

662
00:46:08,830 --> 00:46:13,470
cuz I think this might are you be in use
any questions

663
00:46:13,470 --> 00:46:18,810
Marty about be over time any questions
any complaints

664
00:46:18,810 --> 00:46:22,060
right

665
00:46:22,060 --> 00:46:22,540
thanks for your time

