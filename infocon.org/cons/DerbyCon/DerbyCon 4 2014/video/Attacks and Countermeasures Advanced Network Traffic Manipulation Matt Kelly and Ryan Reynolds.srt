1
00:00:00,240 --> 00:00:03,210
go ago

2
00:00:03,210 --> 00:00:07,100
yup hope

3
00:00:07,100 --> 00:00:10,639
so ion iMac County

4
00:00:10,639 --> 00:00:16,330
is Ryan Reynolds I'm are gonna go over I
advanced network traffic manipulation

5
00:00:16,330 --> 00:00:20,140
so this Alice and Bob with for Snyder

6
00:00:20,140 --> 00:00:23,529
in the middle in

7
00:00:23,529 --> 00:00:27,099
so I'm at Kelly and I'm a senior
consultant

8
00:00:27,099 --> 00:00:31,590
at you iron smearing I'm on Twitter and
get help

9
00:00:31,590 --> 00:00:35,130
everything every two years and doorstep
I'm

10
00:00:35,130 --> 00:00:38,469
from Houston are from Chicago and
Houston now

11
00:00:38,469 --> 00:00:42,160
I do a pen testing red teaming that
other stuff

12
00:00:42,160 --> 00:00:45,260
I work in the attack and division on

13
00:00:45,260 --> 00:00:48,629
him from Ryan

14
00:00:48,629 --> 00:00:52,739
our care professional services for up
firm called grow

15
00:00:52,739 --> 00:00:56,460
and manager focus and pen testing

16
00:00:56,460 --> 00:01:00,230
I'm met him at force me to put in and
that I cheated

17
00:01:00,230 --> 00:01:03,680
fantasy football solo background their I

18
00:01:03,680 --> 00:01:07,420
I don't know anything about football so
I outsource my team

19
00:01:07,420 --> 00:01:10,720
on track to someone else I don't know
some call it cheating

20
00:01:10,720 --> 00:01:15,479
tomatoes manana whatever on but i won
and

21
00:01:15,479 --> 00:01:18,950
Raven Sep blog there just a little blog
metal have mom

22
00:01:18,950 --> 00:01:23,270
the slide in are in the slides and some
notes around this presentation and check

23
00:01:23,270 --> 00:01:23,659
out

24
00:01:23,659 --> 00:01:27,390
I'm you

25
00:01:27,390 --> 00:01:30,810
so this a canada-wide the top I'm

26
00:01:30,810 --> 00:01:33,960
there's two main points the first one is

27
00:01:33,960 --> 00:01:37,799
the attacks were about to cover are
practical and they do have a huge impact

28
00:01:37,799 --> 00:01:38,619
on your network

29
00:01:38,619 --> 00:01:42,220
and and the reason we're emphasizing
this point is

30
00:01:42,220 --> 00:01:45,369
I see a lot of great presentations an

31
00:01:45,369 --> 00:01:49,549
I'm attacking protocols like our fellow
men are

32
00:01:49,549 --> 00:01:54,720
net buyers I heard attacking the edger
appear HSRP but they don't have a lot of

33
00:01:54,720 --> 00:01:55,509
the impact

34
00:01:55,509 --> 00:01:59,159
they don't have something that I can
translate when I'm

35
00:01:59,159 --> 00:02:02,610
attacking network and feel comfortable
doing or

36
00:02:02,610 --> 00:02:04,640
feel comfortable exploiting and

37
00:02:04,640 --> 00:02:08,050
getting results from it so that was a
big thing a bus

38
00:02:08,050 --> 00:02:12,950
changing our mindset and saying how can
we is this an internal network talking

39
00:02:12,950 --> 00:02:13,590
to me

40
00:02:13,590 --> 00:02:18,020
is this impose sexploitation attacked at
to move around laterally

41
00:02:18,020 --> 00:02:21,590
are performed privilege escalation on

42
00:02:21,590 --> 00:02:26,800
and we've also seen a large focus on
network security historically and where

43
00:02:26,800 --> 00:02:30,120
as an industry often shifting towards ap
sack

44
00:02:30,120 --> 00:02:33,120
but these issues never went away

45
00:02:33,120 --> 00:02:36,310
difference despite our focus on
application security

46
00:02:36,310 --> 00:02:40,070
now guarantee you on I don't know the
make up a defender's worse

47
00:02:40,070 --> 00:02:43,470
ard defenders verse offense

48
00:02:43,470 --> 00:02:46,300
in this room but I guarantee you're
gonna see this and every network you

49
00:02:46,300 --> 00:02:46,930
encounter

50
00:02:46,930 --> 00:02:49,940
are you network here one these things
were going to cover

51
00:02:49,940 --> 00:02:54,940
on the other thing is these
vulnerabilities can be faxed

52
00:02:54,940 --> 00:02:59,390
networking and talk about are our talk
is broken up into

53
00:02:59,390 --> 00:03:03,739
on how protocol works briefly the
vulnerability

54
00:03:03,739 --> 00:03:08,739
attack countermeasures I'm oftentimes
the attacks we go over

55
00:03:08,739 --> 00:03:12,630
are dismissed because they can't be
fixed and we're going to challenge you

56
00:03:12,630 --> 00:03:13,810
to say they can

57
00:03:13,810 --> 00:03:17,100
and everything we've covered here we'd
we've helped

58
00:03:17,100 --> 00:03:21,660
organizations fixin between Ryan and I
would benefit a lot organizations and

59
00:03:21,660 --> 00:03:27,049
and these things can defects I'm so

60
00:03:27,049 --> 00:03:31,320
again on the practicality I'm real
attackers

61
00:03:31,320 --> 00:03:34,579
3cds posts exploitation techniques used

62
00:03:34,579 --> 00:03:38,780
I'm friend since man in the middle arts
but think that I'm about cover

63
00:03:38,780 --> 00:03:41,920
I'm a lot of people say that's cheating

64
00:03:41,920 --> 00:03:45,519
are it's not about attack vector cuz he
cant fix it

65
00:03:45,519 --> 00:03:49,360
and that's not true and we're gonna tell
you how on

66
00:03:49,360 --> 00:03:51,250
and and we'd argue that

67
00:03:51,250 --> 00:03:55,130
TJX would probably argue that this is
about attack vector

68
00:03:55,130 --> 00:03:59,070
I'm now is 2007 and we still see our

69
00:03:59,070 --> 00:04:04,520
spitting everywhere we go are poisoning
so the topics for any cover

70
00:04:04,520 --> 00:04:08,010
will we tried to avoid it some the

71
00:04:08,010 --> 00:04:11,700
more esoteric attacks are the ones that
we don't see realistic attack vectors

72
00:04:11,700 --> 00:04:12,550
coming from

73
00:04:12,550 --> 00:04:15,970
maybe in the future that a change but at
this point in time we're not gonna

74
00:04:15,970 --> 00:04:20,100
not be focusing and STP root bridge
attacks cuz that's not a realistic

75
00:04:20,100 --> 00:04:22,030
internal attack vector thais

76
00:04:22,030 --> 00:04:26,550
what we will cover is later to
manipulation attacks

77
00:04:26,550 --> 00:04:29,970
I am such as TTP TTP

78
00:04:29,970 --> 00:04:33,270
attacks are splitting gateway redundancy

79
00:04:33,270 --> 00:04:38,430
attacks so BRP HSRP I'm CNAME spoofing
attacks

80
00:04:38,430 --> 00:04:41,900
and then route update attacks along with
a few other tips and tricks

81
00:04:41,900 --> 00:04:46,290
on taking a vulnerability attacking and
defending

82
00:04:46,290 --> 00:04:49,290
so with that all moving are poisoning

83
00:04:49,290 --> 00:04:52,850
him who all here's her devar poisoning

84
00:04:52,850 --> 00:04:57,800
senate Majority the room so I'm not
going to spend too much time

85
00:04:57,800 --> 00:05:01,270
and how this protocol works and how to
attack it cuz theres

86
00:05:01,270 --> 00:05:07,389
has not yet so

87
00:05:07,389 --> 00:05:08,940
thanks iron great for this

88
00:05:08,940 --> 00:05:12,900
a in quote shady looking graphics and

89
00:05:12,900 --> 00:05:16,520
but I N so briefly

90
00:05:16,520 --> 00:05:19,930
ARB is not authenticated that means that
I is a bad guy

91
00:05:19,930 --> 00:05:24,069
can send in our packet and tell you that
I now the gateway and the Gateway I'm

92
00:05:24,069 --> 00:05:24,669
now you

93
00:05:24,669 --> 00:05:28,090
that's already covering like it up
otherwise

94
00:05:28,090 --> 00:05:31,150
there's some great tools called came in
under cap

95
00:05:31,150 --> 00:05:35,319
that I'm sure you've all heard ironic
that act is very well

96
00:05:35,319 --> 00:05:39,199
under cap works great for process
British into as a stand-alone EXE

97
00:05:39,199 --> 00:05:42,919
I'm then there's million other tools

98
00:05:42,919 --> 00:05:46,949
if you wanna see how to do it there's a
lot a great videos with that met on the

99
00:05:46,949 --> 00:05:48,000
background

100
00:05:48,000 --> 00:05:52,069
and you too so with that we're gonna
move into countermeasures

101
00:05:52,069 --> 00:05:58,009
I'm so things are going covers you see
peacekeeping and dynamic carp inspection

102
00:05:58,009 --> 00:06:02,219
which I would argue is one that most
widely misunderstood networking concepts

103
00:06:02,219 --> 00:06:07,379
I then we're getting toter some
detective controls as I know I got a lot

104
00:06:07,379 --> 00:06:07,680
as

105
00:06:07,680 --> 00:06:11,560
a sock people in the room her more or
blue team

106
00:06:11,560 --> 00:06:15,090
focused the so

107
00:06:15,090 --> 00:06:18,360
DHCP snooping and dynamic ARP inspection
what's that

108
00:06:18,360 --> 00:06:22,710
well this is how you fix are poisoning

109
00:06:22,710 --> 00:06:28,500
on it's also what we're gonna cover
today is probably the most intense fixed

110
00:06:28,500 --> 00:06:32,039
however it is extremely effective if
done well

111
00:06:32,039 --> 00:06:36,000
and it is very doable we have had many
organizations do this

112
00:06:36,000 --> 00:06:39,120
over the years so DHCP snooping

113
00:06:39,120 --> 00:06:42,740
basically tells a switch to look at TCP
packets

114
00:06:42,740 --> 00:06:46,020
and build up at a trusted table

115
00:06:46,020 --> 00:06:49,300
tying the IP and mac to report

116
00:06:49,300 --> 00:06:53,639
it also looks at it every DTP packing
coming in

117
00:06:53,639 --> 00:06:57,409
and if it's on a trust report drop Sep
so this is

118
00:06:57,409 --> 00:07:00,529
the misunderstood part a lot of
organizations think

119
00:07:00,529 --> 00:07:03,170
I enable DHCP snooping

120
00:07:03,170 --> 00:07:05,810
how did you still are poison well

121
00:07:05,810 --> 00:07:09,050
that's only half a picture so the other
half

122
00:07:09,050 --> 00:07:12,750
is dynamic our construction that's where
we're actively blocking

123
00:07:12,750 --> 00:07:16,370
so it takes that table that we just felt
from

124
00:07:16,370 --> 00:07:21,050
DHCP snooping and actually axe on that
so I get in our packet

125
00:07:21,050 --> 00:07:25,590
coming from this part that is not the
same IP and mac

126
00:07:25,590 --> 00:07:28,700
tied to that port some gonna drop it
right away

127
00:07:28,700 --> 00:07:31,780
there's two different types supports
there's

128
00:07:31,780 --> 00:07:35,170
trusted sportsman trust reports they're
pretty

129
00:07:35,170 --> 00:07:38,300
pretty basic concept trust a port scan
multiple

130
00:07:38,300 --> 00:07:42,960
mac Address is tied to it I'm these
ports you money is pretty sparingly your

131
00:07:42,960 --> 00:07:44,810
knees than your trucks year

132
00:07:44,810 --> 00:07:47,940
here I am sportswear

133
00:07:47,940 --> 00:07:52,040
allotted movement is going on huntress
reports are gonna

134
00:07:52,040 --> 00:07:55,440
have that action applied words blocking
on one

135
00:07:55,440 --> 00:07:59,270
mac Address countries so

136
00:07:59,270 --> 00:08:03,630
on the important things to note here is
the rate limit by default

137
00:08:03,630 --> 00:08:08,670
in a Cisco environment is 15 frames per
second so that means 15r

138
00:08:08,670 --> 00:08:12,530
0 I'm frames and no I actually

139
00:08:12,530 --> 00:08:16,650
trigger that block at that port to be
blocked this is a

140
00:08:16,650 --> 00:08:20,170
probably a bad default setup so if you
guys do this

141
00:08:20,170 --> 00:08:24,970
you wanna move that up the reason that
is is that there's a lot of

142
00:08:24,970 --> 00:08:30,320
devices the F Sport that have a really
bad TCPIP stacks

143
00:08:30,320 --> 00:08:34,230
he's are going to be a printer's
earphones I'm

144
00:08:34,230 --> 00:08:38,250
no that just blasts out are traffic if
you've ever white sharks

145
00:08:38,250 --> 00:08:41,860
some printers all it is are are are

146
00:08:41,860 --> 00:08:45,390
your block these parts so you might have
to make trust it pours through our

147
00:08:45,390 --> 00:08:46,320
network

148
00:08:46,320 --> 00:08:51,840
but more than likely does have to
increase this rate women on

149
00:08:51,840 --> 00:08:54,840
the other thing is make sure

150
00:08:54,840 --> 00:08:57,910
your you audit your trust reports I'm
you might

151
00:08:57,910 --> 00:09:01,140
be tempted to put these in conference
rooms but those are the ones I most

152
00:09:01,140 --> 00:09:02,250
likely to attack

153
00:09:02,250 --> 00:09:06,380
so just make sure you look at these i've
at organizations I've gone to that went

154
00:09:06,380 --> 00:09:07,290
through the trouble and

155
00:09:07,290 --> 00:09:10,769
implementing this and then they forget

156
00:09:10,769 --> 00:09:14,890
changed my poor to an entre supports i0
so this attack

157
00:09:14,890 --> 00:09:18,060
I'm so the important thing is just

158
00:09:18,060 --> 00:09:22,490
just putting both these in place and it
is a very doable goal

159
00:09:22,490 --> 00:09:26,320
on a lot of places view this is
insurmountable thing to do on your

160
00:09:26,320 --> 00:09:26,890
network

161
00:09:26,890 --> 00:09:30,350
I would challenge you to do it piecemeal
wanted time as you

162
00:09:30,350 --> 00:09:34,490
touch switch implement this and the
local beer and this is

163
00:09:34,490 --> 00:09:38,870
applied to your Zune local subnet so it
is quite the sexy have to do this and

164
00:09:38,870 --> 00:09:39,850
every switch

165
00:09:39,850 --> 00:09:43,700
but it is very doable and this will
block

166
00:09:43,700 --> 00:09:47,930
are poisoning attacks the next one

167
00:09:47,930 --> 00:09:52,730
on for more than a counter measures on
the client side Symantec Endpoint

168
00:09:52,730 --> 00:09:54,670
Protection has a really great

169
00:09:54,670 --> 00:09:58,260
feature called anti Mac spoofing what
this is

170
00:09:58,260 --> 00:10:01,890
is I'm basically it alerts on

171
00:10:01,890 --> 00:10:04,940
are poisoning attack taking place it's
pretty effective

172
00:10:04,940 --> 00:10:08,980
if you have your I R guys responding to
these alerts on

173
00:10:08,980 --> 00:10:12,560
to our knowledge this is one of the very
few clients

174
00:10:12,560 --> 00:10:15,930
I from my cat endpoint protection
standpoint

175
00:10:15,930 --> 00:10:19,790
that actually attacks on this attack

176
00:10:19,790 --> 00:10:24,100
he said he 932 supposedly does I haven't
seen in place so

177
00:10:24,100 --> 00:10:28,740
I can only speak that it has that
capability but this is one we see

178
00:10:28,740 --> 00:10:31,970
regularly as actively defending this
really cool feature

179
00:10:31,970 --> 00:10:36,140
the other cool thing in all the tech
challenged ascetic challenge keys so

180
00:10:36,140 --> 00:10:37,190
when I'm doing our

181
00:10:37,190 --> 00:10:40,990
poisoning attack and probably gonna be
challenging you

182
00:10:40,990 --> 00:10:46,240
with any real winners of with the static
challenger 11 22 33 44

183
00:10:46,240 --> 00:10:50,680
with that comes by default in every
major tool I'm so

184
00:10:50,680 --> 00:10:54,140
Symantec Endpoint will actually detect
on that which is really need so take a

185
00:10:54,140 --> 00:10:54,930
look for those

186
00:10:54,930 --> 00:10:58,170
then your other options that we see
everyone smile

187
00:10:58,170 --> 00:11:01,790
is our watch which is a open source tool

188
00:11:01,790 --> 00:11:04,660
to detect Artsmith Inc

189
00:11:04,660 --> 00:11:08,140
and then there is some some commercial
commercial off-the-shelf tools

190
00:11:08,140 --> 00:11:11,160
on Sep 20 boxes they do this as well

191
00:11:11,160 --> 00:11:14,180
on I would not recommend

192
00:11:14,180 --> 00:11:19,060
you go with the cats approach I'm we see
a lot of these very expensive boxes

193
00:11:19,060 --> 00:11:24,370
that organizations by and then you have
to deploy these on every some metal

194
00:11:24,370 --> 00:11:28,830
same with our pledge and monitor for
these attacks which is quite that

195
00:11:28,830 --> 00:11:34,070
quite intensive operation to do and it's
very expensive but you can do it

196
00:11:34,070 --> 00:11:37,490
on so that

197
00:11:37,490 --> 00:11:41,170
are going to ipv6 man in the middle so
some

198
00:11:41,170 --> 00:11:44,890
some been talks on it lately and but

199
00:11:44,890 --> 00:11:48,620
very just a bit is I you might be saying

200
00:11:48,620 --> 00:11:52,430
well you can't not doing our jobs in any
place you design crypt everything with

201
00:11:52,430 --> 00:11:53,210
IP sec

202
00:11:53,210 --> 00:11:57,730
it's a very misunderstood concept I P
sac is built into the protocol

203
00:11:57,730 --> 00:12:01,850
it's not enabled by default I mean it's
very difficult to enable to

204
00:12:01,850 --> 00:12:05,480
in so with that

205
00:12:05,480 --> 00:12:09,320
I'm how how ipv6 works at a very high
level

206
00:12:09,320 --> 00:12:12,750
so you take DHCP and IP v4 which assigns
year

207
00:12:12,750 --> 00:12:17,150
your on DNS information your IP
information all that

208
00:12:17,150 --> 00:12:21,340
and then we split that into basically
three three major protocols we got

209
00:12:21,340 --> 00:12:22,760
router advertisements

210
00:12:22,760 --> 00:12:26,000
which we send out on which you can

211
00:12:26,000 --> 00:12:30,230
somewhat think a DHCP tells year your
default gateway

212
00:12:30,230 --> 00:12:33,780
and then you got dhcpv6 which

213
00:12:33,780 --> 00:12:37,550
can do some other stuff I router
advertisements to you

214
00:12:37,550 --> 00:12:40,810
I USI is this for your DNS information

215
00:12:40,810 --> 00:12:44,130
no such slack I'm stateless

216
00:12:44,130 --> 00:12:47,350
address on a configuration an

217
00:12:47,350 --> 00:12:52,470
this basically I'm is where a client
figures out its actual

218
00:12:52,470 --> 00:12:58,400
link local IP address and an important
thing to know is a Windows

219
00:12:58,400 --> 00:13:01,980
by the hardships that ipv6 same with Max
and Lenox

220
00:13:01,980 --> 00:13:05,340
on their enabled by default on a network
which is really

221
00:13:05,340 --> 00:13:11,480
useful for us since for Penn testers and
clients per for ipv6 ipv4

222
00:13:11,480 --> 00:13:13,790
right now if you look in your Windows
environment

223
00:13:13,790 --> 00:13:18,200
that if you look in your DNS server I
see some ipv6 entries in there

224
00:13:18,200 --> 00:13:21,790
the say way I don't use ipv6 well but

225
00:13:21,790 --> 00:13:25,529
that's when does happily configuring
things

226
00:13:25,529 --> 00:13:30,160
for you and so the vulnerabilities were
gonna go over

227
00:13:30,160 --> 00:13:35,400
there's slack attack which up well cover
next neighbor advertisement spoofing

228
00:13:35,400 --> 00:13:38,020
attack which I haven't seen a lot a
great details on

229
00:13:38,020 --> 00:13:42,620
then there's fake dhcpv6 when I can
cover that in this presentation

230
00:13:42,620 --> 00:13:45,970
but it's out there so slack attack

231
00:13:45,970 --> 00:13:51,480
and how it works so remember ipv6 is
enabled on your network but

232
00:13:51,480 --> 00:13:56,710
I would that ninety-nine percent in the
do not actively use ipv6 intentionally

233
00:13:56,710 --> 00:13:57,610
on your network

234
00:13:57,610 --> 00:14:01,620
I at a local network anyway and

235
00:14:01,620 --> 00:14:05,089
so now it's in a bowl but we don't have

236
00:14:05,089 --> 00:14:08,300
many these protocols that are required
to make it function

237
00:14:08,300 --> 00:14:13,660
so I is a bad guy I can't do our spirit
fingers you just text that said now I so

238
00:14:13,660 --> 00:14:15,400
wanna man in the middle your traffic

239
00:14:15,400 --> 00:14:20,410
so how do I do that I a start my slack
attack I sent out a router advertisement

240
00:14:20,410 --> 00:14:21,450
my local subnet

241
00:14:21,450 --> 00:14:24,680
and his and tell hosts

242
00:14:24,680 --> 00:14:29,130
hehehe initiate slackin sent me as your
default gateway

243
00:14:29,130 --> 00:14:34,100
then the host a ride heroic local
address is based on that information it

244
00:14:34,100 --> 00:14:35,950
sets me as the default gateway

245
00:14:35,950 --> 00:14:40,110
I send out the CPE v6 information for
your DNS server

246
00:14:40,110 --> 00:14:46,000
on host now automatically prefer to send
traffic to me over there I keep

247
00:14:46,000 --> 00:14:49,060
he for equipment which is really awesome
this is

248
00:14:49,060 --> 00:14:52,080
enabled almost everywhere and

249
00:14:52,080 --> 00:14:55,650
and then I configure pastor and they
don't even notice

250
00:14:55,650 --> 00:15:00,310
so it's pretty cool attack on so

251
00:15:00,310 --> 00:15:03,330
how do we actually do this attack sore

252
00:15:03,330 --> 00:15:06,520
are and tools tactics and procedures on

253
00:15:06,520 --> 00:15:10,779
there's few great blog posts on this I
am 1n

254
00:15:10,779 --> 00:15:13,559
the basic just have it as is we need to
set up

255
00:15:13,559 --> 00:15:16,999
ipv6 honor on in this case Linux box

256
00:15:16,999 --> 00:15:21,499
we're gonna set up on sis CTL

257
00:15:21,499 --> 00:15:25,299
to do his greatest sporting then

258
00:15:25,299 --> 00:15:29,569
rad BD much as 80 D to send out those

259
00:15:29,569 --> 00:15:32,629
malicious router advertisements miss fun

260
00:15:32,629 --> 00:15:36,229
we're gonna have to do some
configuration based on brown denies

261
00:15:36,229 --> 00:15:37,359
lessons learned

262
00:15:37,359 --> 00:15:41,699
doing this attack on much these attacks
were inscribed if you don't owe

263
00:15:41,699 --> 00:15:44,919
they've really understand the protocol
details on how these attacks work

264
00:15:44,919 --> 00:15:47,979
I would not recommend doing them on your
network and

265
00:15:47,979 --> 00:15:51,259
isn't bad things can happen on

266
00:15:51,259 --> 00:15:54,369
but then I DCP v6

267
00:15:54,369 --> 00:15:58,329
to set up the DNS information then

268
00:15:58,329 --> 00:16:02,359
its but then down at Pt

269
00:16:02,359 --> 00:16:06,199
and to do not pass through so the
important things to do

270
00:16:06,199 --> 00:16:09,609
when this attack is Roger advertisements
on

271
00:16:09,609 --> 00:16:13,959
their default in the multicast added
gonna send out to everybody

272
00:16:13,959 --> 00:16:17,439
and all this on your your man middling

273
00:16:17,439 --> 00:16:21,449
you know whole subnet which you know
depending on the configuration that sent

274
00:16:21,449 --> 00:16:23,179
on a traffic going to you

275
00:16:23,179 --> 00:16:26,959
really bad idea and webber's done our

276
00:16:26,959 --> 00:16:29,970
poisoning in a real-world environment he
generally only target

277
00:16:29,970 --> 00:16:33,299
a couple host because otherwise
everything starts breaking

278
00:16:33,299 --> 00:16:37,439
and you don't want to do that isn't
actor that's a big cock so

279
00:16:37,439 --> 00:16:41,749
you said that to you to castro me any
target only specific host

280
00:16:41,749 --> 00:16:44,999
so on you pick out a few host

281
00:16:44,999 --> 00:16:48,899
unit cast then to them and you this
attack

282
00:16:48,899 --> 00:16:52,109
now they start writing and traffic
despite all that effort he just

283
00:16:52,109 --> 00:16:56,949
but in our poison protection now they're
using ipv6 what you're probably not even

284
00:16:56,949 --> 00:16:59,709
actively monitoring so it's kinda covert
channel two

285
00:16:59,709 --> 00:17:03,389
on the other big takeaway

286
00:17:03,389 --> 00:17:07,059
is on the default least I'm

287
00:17:07,059 --> 00:17:09,949
is going to be about 10 hours I'm

288
00:17:09,949 --> 00:17:14,980
so when Ryan and I have done this attack
I listen we unplug and sometimes bad

289
00:17:14,980 --> 00:17:16,009
things happen

290
00:17:16,009 --> 00:17:20,269
and see what a set that pretty low so
that when he stops this attack

291
00:17:20,269 --> 00:17:26,720
things don't break in men there some
other great small city this size 32c

292
00:17:26,720 --> 00:17:28,889
7676

293
00:17:28,889 --> 00:17:32,389
I believe both Ryan and I and he is that
one that's pretty good

294
00:17:32,389 --> 00:17:39,139
but just make sure you change the
defaults again I'm the next one you're

295
00:17:39,139 --> 00:17:39,820
gonna go over

296
00:17:39,820 --> 00:17:43,860
so a are neighbor splitting so our
neighbor spitting

297
00:17:43,860 --> 00:17:48,570
think it s is literally the are
poisoning attack for ipv6

298
00:17:48,570 --> 00:17:51,720
I'm not a like rates liza Eric a

299
00:17:51,720 --> 00:17:55,279
blog posts on this one on this is

300
00:17:55,279 --> 00:17:59,750
one is a tax that would be more
effective if you are actively using ipv6

301
00:17:59,750 --> 00:18:04,830
so so where the slack attack might not
work well or it's a race condition irony

302
00:18:04,830 --> 00:18:05,889
is this attack

303
00:18:05,889 --> 00:18:09,580
to basically do the same thing as are
poisoning except

304
00:18:09,580 --> 00:18:14,659
in this case it's on our pets ICMP v6
neighbor solicitation

305
00:18:14,659 --> 00:18:17,830
address its you can do this with skate
its

306
00:18:17,830 --> 00:18:20,919
at and it's not even difficult most the
time people say

307
00:18:20,919 --> 00:18:24,860
escapee when I think escapee I don't use
it

308
00:18:24,860 --> 00:18:28,860
scape is pretty easy for this attack I
am

309
00:18:28,860 --> 00:18:32,139
you then the next one

310
00:18:32,139 --> 00:18:35,450
so for countermeasures how do we stop
this on

311
00:18:35,450 --> 00:18:39,419
here are a few that the main one is
disabled on your internal network now

312
00:18:39,419 --> 00:18:41,669
this might hinder adoption but i wouldnt

313
00:18:41,669 --> 00:18:46,500
I would say most have you are not
intentionally actively using ipv6 on

314
00:18:46,500 --> 00:18:47,350
your network

315
00:18:47,350 --> 00:18:51,110
so we need to change the default
configurations and network devices and

316
00:18:51,110 --> 00:18:53,650
clients disabled us

317
00:18:53,650 --> 00:18:57,650
the next one is re- Gard times that's a
Cisco Feature to prevent

318
00:18:57,650 --> 00:19:02,740
router advertisement on spoofing the
space I think DHCP snooping kind

319
00:19:02,740 --> 00:19:06,940
on in this whole I basically stopped
that slack attack

320
00:19:06,940 --> 00:19:10,520
then there's these really cool things
called senator GCAA

321
00:19:10,520 --> 00:19:13,690
will cover briefly on not gonna be

322
00:19:13,690 --> 00:19:17,070
probably what you're doing and realistic
enterprise network

323
00:19:17,070 --> 00:19:20,440
much as well we care about

324
00:19:20,440 --> 00:19:24,590
on then there's some climbing controls
to think about as well so

325
00:19:24,590 --> 00:19:28,210
are regarded and figured on your the
lands

326
00:19:28,210 --> 00:19:31,780
basically say I don't want unwanted on

327
00:19:31,780 --> 00:19:35,640
writer advertisements is probably pretty
easy for you guys to do

328
00:19:35,640 --> 00:19:40,000
because most the time you're not gonna
have legitimate router advertisements on

329
00:19:40,000 --> 00:19:41,180
an enterprise network

330
00:19:41,180 --> 00:19:44,280
I the next one

331
00:19:44,280 --> 00:19:49,220
sir sandy CA this basically PK I wait a
cryptographically generated dress is

332
00:19:49,220 --> 00:19:50,730
really cool concepts

333
00:19:50,730 --> 00:19:54,440
not great support this time this is poor
had a future vision

334
00:19:54,440 --> 00:19:58,290
this will actually stop that need
neighbor advertisement spoofing attack

335
00:19:58,290 --> 00:20:01,920
I'm this probably one of the only good
ways to stop it at this point

336
00:20:01,920 --> 00:20:02,810
unfortunately

337
00:20:02,810 --> 00:20:06,010
but you're not gonna realistically
implement that

338
00:20:06,010 --> 00:20:10,270
your enterprise at this point in time
next one is disabling

339
00:20:10,270 --> 00:20:14,790
to disable in an hour device input fire
are all set preventing capsule Asian

340
00:20:14,790 --> 00:20:19,690
sewing the big things we do is we do
encapsulation so we encapsulate that I

341
00:20:19,690 --> 00:20:22,550
can be six trafficked ipv4 traffic

342
00:20:22,550 --> 00:20:25,950
so that we can traverse it throughout
your network if you block

343
00:20:25,950 --> 00:20:29,050
that IP protocol forty-one that makes
that

344
00:20:29,050 --> 00:20:33,360
activity not possible it's really great
way prevent covert channels and prevents

345
00:20:33,360 --> 00:20:34,370
me is a tax

346
00:20:34,370 --> 00:20:38,559
I am and then also block

347
00:20:38,559 --> 00:20:41,940
iconic encapsulation sites to earn your
proxy

348
00:20:41,940 --> 00:20:45,159
on hurricane electric

349
00:20:45,159 --> 00:20:48,190
but to planning controls on

350
00:20:48,190 --> 00:20:51,830
disabling ipv6 on your windows devices

351
00:20:51,830 --> 00:20:54,899
very smart thing to do at this point in
time I'd highly recommend that you can

352
00:20:54,899 --> 00:20:56,110
do it via group policy

353
00:20:56,110 --> 00:20:59,850
I'm also changing your default belts
next time

354
00:20:59,850 --> 00:21:03,320
set the preference to ipv4 over ipv6

355
00:21:03,320 --> 00:21:07,830
this all or let you keep ipv6 to degree
in your network

356
00:21:07,830 --> 00:21:11,820
and prevent me from using that that
default setting windows to

357
00:21:11,820 --> 00:21:17,369
kinda route traffic through me you can
also disable slack

358
00:21:17,369 --> 00:21:21,960
from on the client's this one it's a
great

359
00:21:21,960 --> 00:21:25,879
mitigating control on I would

360
00:21:25,879 --> 00:21:29,850
out for on a former options we discuss
them

361
00:21:29,850 --> 00:21:33,929
that all ended up turning

362
00:21:33,929 --> 00:21:39,159
so names moving here com who served in a
fast-moving at home in our

363
00:21:39,159 --> 00:21:43,409
think a lot of people in this room
probably on saw go through this

364
00:21:43,409 --> 00:21:47,610
pretty quickly but we'll just baseline
this real quick on so

365
00:21:47,610 --> 00:21:52,710
when you're accessing its a share right
you type in hostname slash the dollar

366
00:21:52,710 --> 00:21:56,649
whenever and your house needs translate
that to an IP address

367
00:21:56,649 --> 00:21:59,909
so it's gonna burst looking at a local
host bounds ahead to have any static

368
00:21:59,909 --> 00:22:00,929
entries for this

369
00:22:00,929 --> 00:22:05,480
okay if I know minute check my DNS cache
because aidid I look this up already

370
00:22:05,480 --> 00:22:09,899
okay no IP address their then ima send
out a DNS request

371
00:22:09,899 --> 00:22:13,710
DNS there's an answer me now the next
thing on go to

372
00:22:13,710 --> 00:22:17,409
is wins I'll ask wins has only if you
actually have once configured in your

373
00:22:17,409 --> 00:22:19,210
network them

374
00:22:19,210 --> 00:22:21,970
the Hail Mary is a nap miles broadcast

375
00:22:21,970 --> 00:22:25,190
which essentially send it to the local
subnet

376
00:22:25,190 --> 00:22:28,690
and says hey as anyone have nom you know
this house

377
00:22:28,690 --> 00:22:32,020
who who are you and so this is where we
respond and say you hate

378
00:22:32,020 --> 00:22:35,130
you're looking for that resource that
ass more right here

379
00:22:35,130 --> 00:22:38,980
on there are lotsa tools that can be
used to launch this attack

380
00:22:38,980 --> 00:22:42,620
I favors responder mean by gappy
translate

381
00:22:42,620 --> 00:22:46,400
awesome Metasploit has and DNS pooper

382
00:22:46,400 --> 00:22:51,280
which you can use in conjunction with
SMB capture interceptor angie is a

383
00:22:51,280 --> 00:22:54,990
windows-based do we com man the middle
attack

384
00:22:54,990 --> 00:22:58,100
framework can do a bunch protocols
including and be an ass

385
00:22:58,100 --> 00:23:01,400
and then for a pivoting perspective

386
00:23:01,400 --> 00:23:04,410
great stand-alone cool is on a cruise

387
00:23:04,410 --> 00:23:09,530
and DNS spoofed on a new mix did also
kinda modification that so it's pretty

388
00:23:09,530 --> 00:23:10,120
cool

389
00:23:10,120 --> 00:23:14,260
but there's a lot of tools out there to
launch this attack I'm so basically

390
00:23:14,260 --> 00:23:17,980
we're just answering back we are you to
say hey you can find out where this host

391
00:23:17,980 --> 00:23:18,360
is

392
00:23:18,360 --> 00:23:21,410
its ass connect us arm and now

393
00:23:21,410 --> 00:23:26,440
typically when the files is being used
the user has invoked something like

394
00:23:26,440 --> 00:23:30,880
computer browser or load my computer and
it's trying to map all their home drives

395
00:23:30,880 --> 00:23:32,140
and things of that nature

396
00:23:32,140 --> 00:23:37,460
so the little Windows integrated offer
the single sign-on mechanism is trying

397
00:23:37,460 --> 00:23:39,370
to make that scene was for the user

398
00:23:39,370 --> 00:23:43,370
so therefore incentive them having to
type in their username and password for

399
00:23:43,370 --> 00:23:44,990
every share that their mapping

400
00:23:44,990 --> 00:23:49,200
it just doesn't automatically and so
that process

401
00:23:49,200 --> 00:23:52,840
is going to most likely send us their
credentials so when we're doing this

402
00:23:52,840 --> 00:23:53,390
attack

403
00:23:53,390 --> 00:23:57,380
nine times out of ten we're going to get
om their

404
00:23:57,380 --> 00:24:01,110
SMB murder and timp-2 31 credentials

405
00:24:01,110 --> 00:24:04,250
and so it's really good for us as mean
attackers

406
00:24:04,250 --> 00:24:07,460
you know when we plug into an hour won
the first thing we need to get off

407
00:24:07,460 --> 00:24:11,100
arm so once you get that challenge
response century

408
00:24:11,100 --> 00:24:14,490
you can time to crack the credentials or
you can

409
00:24:14,490 --> 00:24:18,400
relay using something like SMB axe and

410
00:24:18,400 --> 00:24:22,550
arm in order to actually relate though
you do need to be local Aussie at the No

411
00:24:22,550 --> 00:24:28,000
that user has local administrative
access anywhere how women are

412
00:24:28,000 --> 00:24:32,620
it's pretty much the new version apna
BIOS power comes with mister NOP

413
00:24:32,620 --> 00:24:36,610
on Microsoft made it a little more
efficient by saying let's use multicast

414
00:24:36,610 --> 00:24:38,390
incentive broadcast

415
00:24:38,390 --> 00:24:43,120
basically it works like Mtns is a lot of
blogs out that that pretty much say

416
00:24:43,120 --> 00:24:46,210
why did Microsoft make this when and DNS
is

417
00:24:46,210 --> 00:24:49,300
century the exact same thing and a wanna

418
00:24:49,300 --> 00:24:52,300
on so we can do the same type attack
here

419
00:24:52,300 --> 00:24:55,860
I think one other things a

420
00:24:55,860 --> 00:25:00,200
we run into when doing our penthouse in
saying hey we were able to do not buy a

421
00:25:00,200 --> 00:25:02,820
scooping and i own R&D credentials

422
00:25:02,820 --> 00:25:06,200
and you know that goddess into the
network and we just ran from their

423
00:25:06,200 --> 00:25:10,540
comparable just cleaning clients say
well what's the pics are the fix is to

424
00:25:10,540 --> 00:25:11,350
disable it

425
00:25:11,350 --> 00:25:14,970
but the next ball question is well what
do you mean you wanna just flip a switch

426
00:25:14,970 --> 00:25:16,170
my entire network

427
00:25:16,170 --> 00:25:19,850
and turn this off what's going to break
and so I try to help from

428
00:25:19,850 --> 00:25:23,730
walk through learning their network so

429
00:25:23,730 --> 00:25:27,940
wins enough miles are tied and pretty
heavily basically will

430
00:25:27,940 --> 00:25:31,140
DNS tress replacements so ask yourself

431
00:25:31,140 --> 00:25:34,370
if you're an admin and sis and India
wins out there

432
00:25:34,370 --> 00:25:37,500
now by default all domain controllers
have wins

433
00:25:37,500 --> 00:25:41,230
but that doesn't necessarily mean it's
being used on so

434
00:25:41,230 --> 00:25:45,290
the other thing is so basically did you
set up any when servers manually

435
00:25:45,290 --> 00:25:48,990
the Senate many wins proxies which all
this does is for twins request

436
00:25:48,990 --> 00:25:52,740
outside smoke or something two main when
server

437
00:25:52,740 --> 00:25:56,309
give any servers that are on the same
subnet

438
00:25:56,309 --> 00:26:00,750
as your workstations because if your
workstation is doing in a bias query

439
00:26:00,750 --> 00:26:04,640
can only go with in the local broadcast
domain

440
00:26:04,640 --> 00:26:08,720
and so it doesn't get an answer you know
that's fine

441
00:26:08,720 --> 00:26:11,910
by if it does have on a server

442
00:26:11,910 --> 00:26:15,059
on that same some known as the
workstation maybe the server is actually

443
00:26:15,059 --> 00:26:16,340
responding be in that blast

444
00:26:16,340 --> 00:26:19,820
you mine I know unless you're actually
looking on how your network is setup in

445
00:26:19,820 --> 00:26:22,410
terms of our servers on the same subnet

446
00:26:22,410 --> 00:26:26,950
as workstations deming legacy systems
out there basically pure XP

447
00:26:26,950 --> 00:26:30,170
and above on Microsoft made a strong
push to

448
00:26:30,170 --> 00:26:33,250
roll out %ah and fade away from

449
00:26:33,250 --> 00:26:36,840
wins and not by us they miss Louise

450
00:26:36,840 --> 00:26:41,360
be an ass and so the last thing is let's
see if you have someone servers

451
00:26:41,360 --> 00:26:44,950
you can essentially use performance
monitor

452
00:26:44,950 --> 00:26:48,390
to figure out how many times there arm

453
00:26:48,390 --> 00:26:51,760
it's actually been queried and how many
responses it's sending so you can say

454
00:26:51,760 --> 00:26:52,710
hey okay

455
00:26:52,710 --> 00:26:56,040
I'm gonna monitor this for up whole
business cycle our whole corner six

456
00:26:56,040 --> 00:26:56,580
months

457
00:26:56,580 --> 00:27:00,309
and I only got like one I'll Win Server

458
00:27:00,309 --> 00:27:03,660
request which was initiated essentially
vietnam files

459
00:27:03,660 --> 00:27:07,669
and probably not using it in my network
on the main takeaway here though that we

460
00:27:07,669 --> 00:27:08,770
tell clients as hey

461
00:27:08,770 --> 00:27:12,770
basically roll this out turn off

462
00:27:12,770 --> 00:27:16,809
now piles on your IT workstations sees
what's making against

463
00:27:16,809 --> 00:27:20,530
you know the guinea pigs essentially
then pick the marketing department and

464
00:27:20,530 --> 00:27:21,740
do kind of a

465
00:27:21,740 --> 00:27:26,780
babies rollout of disabling this now
when it comes to disabling this

466
00:27:26,780 --> 00:27:30,100
there's a group policy and

467
00:27:30,100 --> 00:27:33,650
it works by creating essentially a DHCP
option

468
00:27:33,650 --> 00:27:38,390
so you do if your computer you get the
ACP this juku policies enable

469
00:27:38,390 --> 00:27:42,150
it says hey on disable now buy a house
on your neck

470
00:27:42,150 --> 00:27:45,390
that's all fine angry so my corporate
systems

471
00:27:45,390 --> 00:27:48,780
when they get DHCP will have an
impossible

472
00:27:48,780 --> 00:27:52,549
but I have a laptop and I go to
Starbucks or go to hotel

473
00:27:52,549 --> 00:27:56,210
on now those the ACP servers aren't on
in Salem

474
00:27:56,210 --> 00:27:59,830
miles so we say hey what's killed at the
fire along level

475
00:27:59,830 --> 00:28:04,080
yes perm happy or even Windows just
block now buy a house

476
00:28:04,080 --> 00:28:09,220
at that I model which is by far the best

477
00:28:09,220 --> 00:28:12,350
kinda going along with what mass and
with Mike Carp watching things that

478
00:28:12,350 --> 00:28:14,580
nature there's a few blogs out there
that say hey

479
00:28:14,580 --> 00:28:17,640
while you're trying to figure out if not
by us as being used

480
00:28:17,640 --> 00:28:20,940
com you can set up %ah hosta when x box
on

481
00:28:20,940 --> 00:28:25,650
each have your subnets that will send
out a fake on a pious query

482
00:28:25,650 --> 00:28:29,100
and then listened to see if it ever gets
a response and if it does can send you

483
00:28:29,100 --> 00:28:29,650
an email

484
00:28:29,650 --> 00:28:33,060
at give us a message tunnel ok

485
00:28:33,060 --> 00:28:36,160
but OK go for out of its really feasible
for

486
00:28:36,160 --> 00:28:39,260
Al Manar disabling that

487
00:28:39,260 --> 00:28:42,770
actually has much easier it is just
literally switching up

488
00:28:42,770 --> 00:28:46,650
a switch and all you do is Sadie sable

489
00:28:46,650 --> 00:28:50,290
and its disabled forever doesn't matter
what network I'm on but we know say

490
00:28:50,290 --> 00:28:56,840
as aware approach disabling on fire
while another thing that we commonly see

491
00:28:56,840 --> 00:28:58,260
and networks

492
00:28:58,260 --> 00:29:02,150
is the ability to create DNS entries

493
00:29:02,150 --> 00:29:05,290
essentially so in an Active Directory
environment

494
00:29:05,290 --> 00:29:09,000
on by default domain controllers DNS
servers essentially

495
00:29:09,000 --> 00:29:13,200
will allow in secure updates which means
any system on the network

496
00:29:13,200 --> 00:29:16,670
can just create an a record arm

497
00:29:16,670 --> 00:29:21,200
on Indiana's which century here you're
saying you're saying that a

498
00:29:21,200 --> 00:29:24,450
Google's at the tent and and 10 so

499
00:29:24,450 --> 00:29:28,400
it's kind of a man metal stack you can
just and in whatever entry you can

500
00:29:28,400 --> 00:29:31,780
you know add internet that will cost you
1

501
00:29:31,780 --> 00:29:36,130
have it all point to you dynamic dns and
secure updates

502
00:29:36,130 --> 00:29:39,250
don't you added a record so you can only

503
00:29:39,250 --> 00:29:44,860
and in toledo com so this is something
that you could do to say hey I wanna add

504
00:29:44,860 --> 00:29:45,770
in Google

505
00:29:45,770 --> 00:29:49,560
I'm gonna have arm a website that I'm
hosting

506
00:29:49,560 --> 00:29:54,170
when to act would attack and get access
harm gannett hand in NW penitentiary so

507
00:29:54,170 --> 00:29:55,040
every time I E

508
00:29:55,040 --> 00:29:57,799
boots up it's going to come to me and

509
00:29:57,799 --> 00:30:02,230
I'm gonna get tons trends so this is a
really quick fix though

510
00:30:02,230 --> 00:30:06,649
all you have to do is literally change
common Group Policy settings sync

511
00:30:06,649 --> 00:30:09,759
only allow secure a place here but this
is something that we see in probably

512
00:30:09,759 --> 00:30:10,659
fifty percent

513
00:30:10,659 --> 00:30:15,379
lines aren't switching to

514
00:30:15,379 --> 00:30:18,879
routing attacks om so

515
00:30:18,879 --> 00:30:22,809
will focus on %eh your p obviously
there's OSPF as well

516
00:30:22,809 --> 00:30:25,850
by just a level set a little here %eh
year

517
00:30:25,850 --> 00:30:29,470
he has that Cisco's version up an inch
here

518
00:30:29,470 --> 00:30:32,779
routing protocol I use as multicast

519
00:30:32,779 --> 00:30:35,850
basically what happens is when a router

520
00:30:35,850 --> 00:30:40,399
joins the network you send a hollow pack
and say hey I'm a new router

521
00:30:40,399 --> 00:30:44,659
and other routers that are listening to
the mall the castle say okay cool let's

522
00:30:44,659 --> 00:30:46,279
create an adjacency then

523
00:30:46,279 --> 00:30:49,830
and will basically om swap route tables
here

524
00:30:49,830 --> 00:30:53,779
so after the Hello packets go through
you send over your

525
00:30:53,779 --> 00:30:57,090
up the packets which contain all the
routes you know about

526
00:30:57,090 --> 00:31:02,239
and the nice thing here which helps us
in this attack is a %eh europea

527
00:31:02,239 --> 00:31:06,230
on dictates that all update exchanges
between routers

528
00:31:06,230 --> 00:31:10,509
mean to be acknowledged so essentially
you're just acting zike routes did you

529
00:31:10,509 --> 00:31:11,450
mine yeah I got your

530
00:31:11,450 --> 00:31:14,710
cool arm and then

531
00:31:14,710 --> 00:31:18,299
the way that routers keep track of each
other is these hello packets

532
00:31:18,299 --> 00:31:21,279
get shot out every five to thirty
seconds depending on how you have it

533
00:31:21,279 --> 00:31:22,119
configured

534
00:31:22,119 --> 00:31:25,789
and so a router doesn't hear from
another router you know within like two

535
00:31:25,789 --> 00:31:26,460
minutes

536
00:31:26,460 --> 00:31:29,669
and assumes that routers that and so now
needs to figure out a different way to

537
00:31:29,669 --> 00:31:30,340
get the data

538
00:31:30,340 --> 00:31:34,210
somewhere so from up attackers
respective

539
00:31:34,210 --> 00:31:38,249
these hello packets aren't using
authentication by default

540
00:31:38,249 --> 00:31:41,279
so what we can do is

541
00:31:41,279 --> 00:31:45,200
pose as a router and send now hollow
packets

542
00:31:45,200 --> 00:31:49,759
and create an indecency and download all
the routes that that router knows about

543
00:31:49,759 --> 00:31:52,799
and them potentially injector outs on

544
00:31:52,799 --> 00:31:56,369
so there's a lot stools that do this
actually can enable

545
00:31:56,369 --> 00:32:00,399
by default you just turn on the snapper
and click the little %eh year P

546
00:32:00,399 --> 00:32:03,690
time in their banning automatically
sends out a whole package

547
00:32:03,690 --> 00:32:08,130
downloads all the routes Korea I'm the
hacking exposed guys

548
00:32:08,130 --> 00:32:11,980
made a set of tools that are basically

549
00:32:11,980 --> 00:32:15,680
just rappers apps Kb sprawl scripts not
user-friendly

550
00:32:15,680 --> 00:32:19,290
kinda difficult I'm so go for it if you
want but

551
00:32:19,290 --> 00:32:23,030
I would recommend using low key its
awesome it's basically

552
00:32:23,030 --> 00:32:26,890
your Sania if you're familiar with that
but for where three can do

553
00:32:26,890 --> 00:32:30,780
Hunza different protocols on its awesome
Anna

554
00:32:30,780 --> 00:32:34,550
mass adjusted net noses bring your own
router I'm

555
00:32:34,550 --> 00:32:37,760
can do that but has intense her

556
00:32:37,760 --> 00:32:41,940
I'm so this week performing an adjacency
were downloading the routes

557
00:32:41,940 --> 00:32:46,400
and at this point when we do our route
exchange we just dance on the router

558
00:32:46,400 --> 00:32:46,940
anything

559
00:32:46,940 --> 00:32:50,570
you know we we have no idea we don't own
anything but we get all that info so

560
00:32:50,570 --> 00:32:53,300
it's a great way to map networks is one
the first things we need to map a

561
00:32:53,300 --> 00:32:53,830
network

562
00:32:53,830 --> 00:32:58,150
because the pen and how your GRP setup I
can figure out where all your son thats

563
00:32:58,150 --> 00:32:58,930
are essentially

564
00:32:58,930 --> 00:33:05,260
arm one of the things that will do to is
just because he made energy since seen

565
00:33:05,260 --> 00:33:06,370
you down on the routes

566
00:33:06,370 --> 00:33:09,910
doesn't mean you automatically get to
you arm inject

567
00:33:09,910 --> 00:33:13,590
routes most the time that's the case but
not always

568
00:33:13,590 --> 00:33:17,060
and so arm one things will do is say
okay

569
00:33:17,060 --> 00:33:20,440
we download all these routes and it
looks like this environment is pretty

570
00:33:20,440 --> 00:33:23,360
much using the 172 16 Rangers let's aim

571
00:33:23,360 --> 00:33:29,730
so then will inject a row of the 192 168
you know 1.2

572
00:33:29,730 --> 00:33:34,900
will make it a slash 32 arm to see if
that when I send that update

573
00:33:34,900 --> 00:33:39,420
I get an act back I get an act back I
know that router has now taken into its

574
00:33:39,420 --> 00:33:40,460
route table

575
00:33:40,460 --> 00:33:45,130
and we're going to go if you don't see
that akc something else is blocking and

576
00:33:45,130 --> 00:33:46,640
not allowing you to inject

577
00:33:46,640 --> 00:33:50,430
even though you have an indecency form
im kinda get into what that might be

578
00:33:50,430 --> 00:33:53,670
lesson learned

579
00:33:53,670 --> 00:33:57,080
I double check here outsider notation

580
00:33:57,080 --> 00:34:00,500
kids you don't want to inject like a
whole hour in class beers on them

581
00:34:00,500 --> 00:34:03,820
om we would recommend just this last 32

582
00:34:03,820 --> 00:34:08,020
first arm so what's the pics here

583
00:34:08,020 --> 00:34:11,490
it's pretty simple passive mode would be

584
00:34:11,490 --> 00:34:15,350
the easiest one so basically I have I am

585
00:34:15,350 --> 00:34:19,149
router connected to rather a connection
driver be over an interface

586
00:34:19,149 --> 00:34:22,220
these have to exchange hello packets in
route updates

587
00:34:22,220 --> 00:34:25,889
but I have a router a also having a
switching off

588
00:34:25,889 --> 00:34:30,620
another interface which has a buncha
users and I would put passive mode on

589
00:34:30,620 --> 00:34:32,159
that interface to say hey

590
00:34:32,159 --> 00:34:36,290
nothing your GRP goes out that interface
so basically bank can see those hello

591
00:34:36,290 --> 00:34:36,940
packets

592
00:34:36,940 --> 00:34:40,740
I can't do anything I can form Jays in
CA can inject routes

593
00:34:40,740 --> 00:34:43,950
bomb good to go mitre Cisco

594
00:34:43,950 --> 00:34:47,460
recommends using md5 authentication as
well

595
00:34:47,460 --> 00:34:50,919
I'm which is good so basically all the
whole own up the packets

596
00:34:50,919 --> 00:34:54,730
you have to know the key in order to
actually have the routers listen to you

597
00:34:54,730 --> 00:34:56,520
if they are configured with md5

598
00:34:56,520 --> 00:35:00,400
authentication so if you do you actually
see a little packet and there's arming

599
00:35:00,400 --> 00:35:01,960
troops in there and you can just look
'em

600
00:35:01,960 --> 00:35:05,140
Mopac and then I'll show you you can try
to crack mackey

601
00:35:05,140 --> 00:35:09,760
arm and then inject but arm MD five
authentication the only

602
00:35:09,760 --> 00:35:13,820
caveat here is that you have to up the
only routers at the same time

603
00:35:13,820 --> 00:35:17,280
is that you have one key here in this
guy doesn't have a key gonna stop

604
00:35:17,280 --> 00:35:18,100
talking to each other

605
00:35:18,100 --> 00:35:21,259
one other things that we found out

606
00:35:21,260 --> 00:35:24,420
when doing the stack was like I said hey
we're

607
00:35:24,420 --> 00:35:28,510
again and Jason C were trying to inject
and there's no

608
00:35:28,510 --> 00:35:32,700
Omaxe back well one of the things I
found out is that would distribute list

609
00:35:32,700 --> 00:35:37,480
you can pretty much set an interface to
say hey I should only listen to you or

610
00:35:37,480 --> 00:35:38,340
receive

611
00:35:38,340 --> 00:35:42,830
are or send EA GRP update information

612
00:35:42,830 --> 00:35:48,490
that contains the 172 16 address so when
we tried to inject on the 192 168

613
00:35:48,490 --> 00:35:52,320
said not not I am I don't care about
that a man can do that Manning nor

614
00:35:52,320 --> 00:35:55,560
and so that was one of the things that
we realize that okay

615
00:35:55,560 --> 00:35:58,930
om meh stopped us from getting an ACK in
that injecting

616
00:35:58,930 --> 00:36:01,800
I'm usually these are used in
conjunction with access list pretty much

617
00:36:01,800 --> 00:36:02,690
say hey

618
00:36:02,690 --> 00:36:07,470
on only actually there's any routers can
talk to the multicast your

619
00:36:07,470 --> 00:36:11,570
like I said I'm earlier

620
00:36:11,570 --> 00:36:14,680
OSPF is vital to the same type attack

621
00:36:14,680 --> 00:36:18,670
essentially for updates her for its
hello packets it uses

622
00:36:18,670 --> 00:36:22,210
link-state advertisements om and then

623
00:36:22,210 --> 00:36:25,810
for its updates that users are our
issues

624
00:36:25,810 --> 00:36:28,859
and then rep is also vulnerable to this
so

625
00:36:28,859 --> 00:36:32,160
they're definitely visa wanna be
attacked the people say hey the school's

626
00:36:32,160 --> 00:36:33,480
out there to PO see it

627
00:36:33,480 --> 00:36:36,880
but can you actually weapon I said and
you know we

628
00:36:36,880 --> 00:36:40,080
walking through a quick example here an
awfully walkthrough

629
00:36:40,080 --> 00:36:44,690
yes 0 we've been seeing me

630
00:36:44,690 --> 00:36:49,960
he had year P a lot on but it took us a
while to figure out a practical attack

631
00:36:49,960 --> 00:36:50,530
as me

632
00:36:50,530 --> 00:36:54,830
we ask ourselves way se eu un and jacked
at any age earpiece

633
00:36:54,830 --> 00:36:58,760
you know routing protocol is it
Pentastar that seems pretty dangerous

634
00:36:58,760 --> 00:37:02,820
to finally got the guts to do it and
figured out permission

635
00:37:02,820 --> 00:37:05,940
yeah of course hun

636
00:37:05,940 --> 00:37:09,010
we figured out and basically a practical
attack

637
00:37:09,010 --> 00:37:13,910
so I we were somewhere shark we see a
GRP packets

638
00:37:13,910 --> 00:37:18,390
we think okay we probably have a good
shot at for me Energy Agency

639
00:37:18,390 --> 00:37:21,570
sorry for NJ sissy with low key are with

640
00:37:21,570 --> 00:37:26,000
whatever tool we went over I'm then we
actually

641
00:37:26,000 --> 00:37:29,170
dump the route updates so we we he edger
p

642
00:37:29,170 --> 00:37:33,000
then after forming the adjacency we we
dump followed the routes and the

643
00:37:33,000 --> 00:37:34,840
networks is great we went over that

644
00:37:34,840 --> 00:37:38,359
the next part is we actually inject

645
00:37:38,359 --> 00:37:41,830
a a route on that network so I'm

646
00:37:41,830 --> 00:37:45,090
in this case thanks to distribute less
we

647
00:37:45,090 --> 00:37:49,510
we target internal hosts so version we
started trying to target

648
00:37:49,510 --> 00:37:52,390
like semi four-dot axe so cool

649
00:37:52,390 --> 00:37:56,180
thinking people grouse that we stop that
and said okay but

650
00:37:56,180 --> 00:37:59,330
let's target internet are some site that
people are gonna go to

651
00:37:59,330 --> 00:38:02,450
so we inject the route with

652
00:38:02,450 --> 00:38:07,170
slash 32 I'm and that basically means if
you don't

653
00:38:07,170 --> 00:38:10,910
set a prefix on low key prefixes your
site or notation

654
00:38:10,910 --> 00:38:14,000
that would try to inject 0 to 0 to 0 to
0

655
00:38:14,000 --> 00:38:18,400
so again said the prefects and then I'm

656
00:38:18,400 --> 00:38:21,460
basically disable ICMP redirects

657
00:38:21,460 --> 00:38:24,590
so make sure that you get the akc from
the router

658
00:38:24,590 --> 00:38:27,890
saying that I acknowledge us if low key
doesn't work

659
00:38:27,890 --> 00:38:31,600
low key doesn't know is you can try
those other two also easy Egypt be a

660
00:38:31,600 --> 00:38:33,610
jerky islamic stand-alone

661
00:38:33,610 --> 00:38:37,060
yeah GOP clan miss some other tools as
art

662
00:38:37,060 --> 00:38:40,570
some there's some great network
engineering

663
00:38:40,570 --> 00:38:45,090
I applications that we can just use for
this attack on

664
00:38:45,090 --> 00:38:49,940
disable ICMP redirects because you can
figure you is the next optimise attack

665
00:38:49,940 --> 00:38:53,020
on so basically you don't your host

666
00:38:53,020 --> 00:38:56,520
sending back like hey this isn't smart
to route it's me

667
00:38:56,520 --> 00:39:00,360
which by default when x is gonna do and
make sure you have route 49

668
00:39:00,360 --> 00:39:03,940
on if you wanna pass that traffic

669
00:39:03,940 --> 00:39:07,420
if you don't set up something like
social engineering toolkit

670
00:39:07,420 --> 00:39:10,500
Nate Kennedy on and

671
00:39:10,500 --> 00:39:15,570
also put a UNC path American SMB Wesner
now you're injecting in traffic so every

672
00:39:15,570 --> 00:39:17,130
time that hosts goes to

673
00:39:17,130 --> 00:39:21,210
say the internet site it's now just
thinks you're the next top

674
00:39:21,210 --> 00:39:24,490
Yuki you launch the webpage the Emir

675
00:39:24,490 --> 00:39:29,030
with a Java in there ap attack in there
so now you have a future per session

676
00:39:29,030 --> 00:39:32,120
he also a UNC path and there's another
auto Windows

677
00:39:32,120 --> 00:39:35,260
authenticating to you then you have the
challenge response hash

678
00:39:35,260 --> 00:39:40,260
sprinkle attack and we see this probably
in at least 40 percent in the networks

679
00:39:40,260 --> 00:39:41,300
we come across

680
00:39:41,300 --> 00:39:45,780
these are large enterprise networks that
heavy a GRP an end-user 7s

681
00:39:45,780 --> 00:39:48,220
so this is the practical attack that

682
00:39:48,220 --> 00:39:51,500
him and I'm just

683
00:39:51,500 --> 00:39:55,349
if you are gonna do this attack you will
need two interfaces

684
00:39:55,349 --> 00:39:58,940
I one is essentially what you're going
to on the adjacency wouldn't say no

685
00:39:58,940 --> 00:40:00,030
you're hello packets

686
00:40:00,030 --> 00:40:03,310
you need to have a second one to you on
route through

687
00:40:03,310 --> 00:40:07,480
essentially because your PSP's ability
bill tenants can say hey you're sending

688
00:40:07,480 --> 00:40:08,900
them right back to me when you done

689
00:40:08,900 --> 00:40:12,920
season two interfaces I'm going on to
you

690
00:40:12,920 --> 00:40:16,740
the UN manipulation so DDP one of my
favorites here

691
00:40:16,740 --> 00:40:19,990
on dynamic trunking protocol totally
different than

692
00:40:19,990 --> 00:40:23,270
BTP on Cisco proprietary protocol

693
00:40:23,270 --> 00:40:26,660
basically DTP was invented in order to
make

694
00:40:26,660 --> 00:40:30,940
are setting up trunks for switches much
easier so basically it to you

695
00:40:30,940 --> 00:40:34,930
switches switch a switch be net and
plugs in the other Cisco said I water

696
00:40:34,930 --> 00:40:35,580
manically

697
00:40:35,580 --> 00:40:38,580
trying to for your so

698
00:40:38,580 --> 00:40:42,790
DTP just establishes trunks VTP

699
00:40:42,790 --> 00:40:47,480
is how your communicating and are
configuring out view and information

700
00:40:47,480 --> 00:40:48,950
across those switches

701
00:40:48,950 --> 00:40:53,030
so that's just two different things that
sometimes people mix up

702
00:40:53,030 --> 00:40:58,480
I'm DTP does use the same domain that
VTP uses so basically in order to create

703
00:40:58,480 --> 00:40:58,950
an

704
00:40:58,950 --> 00:41:02,830
Manjot the UN's using BTP you just have
to have a domain

705
00:41:02,830 --> 00:41:06,150
and so each time you can have different
RB Lance if you're

706
00:41:06,150 --> 00:41:10,609
really the environment on so basically
BTP will just inherently use the same

707
00:41:10,609 --> 00:41:11,220
domain

708
00:41:11,220 --> 00:41:15,800
kinda get a how that played into wanna
marcescens a little later

709
00:41:15,800 --> 00:41:19,970
this is enabled by default the still
blew my mind actually I what this up for

710
00:41:19,970 --> 00:41:20,580
the stock

711
00:41:20,580 --> 00:41:24,290
and top 2014 switches are being sent out

712
00:41:24,290 --> 00:41:28,119
manufactured with this animal may
default on all interfaces on

713
00:41:28,119 --> 00:41:31,460
there's a lot of different modes for TTP
which will talk about real quick

714
00:41:31,460 --> 00:41:34,650
basically a few plug in a Cisco switch

715
00:41:34,650 --> 00:41:38,260
out a box is going to be enabled and the
ports each poor

716
00:41:38,260 --> 00:41:42,450
will be arm by default on don't dynamic
auto mode

717
00:41:42,450 --> 00:41:46,580
which pretty much says hey DTP frames
will be broadcast in

718
00:41:46,580 --> 00:41:50,920
and it'll say if you wanna be a trunk
slimming down to send me the TT

719
00:41:50,920 --> 00:41:54,950
iframe otherwise now or discontinue on
an axis Mon

720
00:41:54,950 --> 00:41:58,000
the other mod it that we can take it
managed

721
00:41:58,000 --> 00:42:01,580
love is a dynamic desirable and this is
pretty much

722
00:42:01,580 --> 00:42:05,619
would have to be manually configured by
the net admin but it says hey I really

723
00:42:05,619 --> 00:42:08,650
want to be a trend with you i really
wanna be a trump me please be a truck

724
00:42:08,650 --> 00:42:09,040
with me

725
00:42:09,040 --> 00:42:13,050
verses the first one which says that
whatever com

726
00:42:13,050 --> 00:42:16,850
trunk obviously the truck parts truck
access

727
00:42:16,850 --> 00:42:20,390
mode means that it's not a trunk and it
will only be a normal user

728
00:42:20,390 --> 00:42:25,119
court and a non negotiate is a setting
that will essentially stop

729
00:42:25,119 --> 00:42:31,330
the interface from sending out DTP
frames so I have to do is plug in the

730
00:42:31,330 --> 00:42:31,950
network

731
00:42:31,950 --> 00:42:35,600
open up Wireshark and BC DTP enable

732
00:42:35,600 --> 00:42:39,700
on you can essentially become a trump
and so once you become a trunk

733
00:42:39,700 --> 00:42:42,840
you now can you know essentially hopper
access

734
00:42:42,840 --> 00:42:46,100
all the V Lance armor that trunk can
access

735
00:42:46,100 --> 00:42:50,060
you just would tag your interface it's
super easy to use

736
00:42:50,060 --> 00:42:53,960
awesome tools like you've seen near Fort
and one other things that gets a lot

737
00:42:53,960 --> 00:42:58,320
and that means that a ran across is that
you know most of them are going into the

738
00:42:58,320 --> 00:42:59,640
interface and saying hey

739
00:42:59,640 --> 00:43:03,650
you now on-axis UNID 200 rate for poor 3

740
00:43:03,650 --> 00:43:07,340
I have DTP is enabled it will override
that

741
00:43:07,340 --> 00:43:12,080
on UNID I'm so when the point
essentially instill become a truck even

742
00:43:12,080 --> 00:43:14,119
if he doesn't mean that interface to be

743
00:43:14,119 --> 00:43:19,560
on a specific %um only I'm so basically
you use arsenio

744
00:43:19,560 --> 00:43:23,290
last out say hey wanna be a trunk on

745
00:43:23,290 --> 00:43:26,900
and then in order to interact with all
of the the UN's

746
00:43:26,900 --> 00:43:29,940
just do some interfaces on your county
boxer so

747
00:43:29,940 --> 00:43:33,960
on can see the commands there once you
have the subinterface is up

748
00:43:33,960 --> 00:43:37,210
on you would just DHCP client

749
00:43:37,210 --> 00:43:40,950
you don't get IP addresses on them are
set we sent you need to you and the way

750
00:43:40,950 --> 00:43:42,780
that you can find what view and

751
00:43:42,780 --> 00:43:46,550
actually taggers after you arm create
the trunk

752
00:43:46,550 --> 00:43:51,010
open a Wireshark sort on are pure gonna
see our traffic from different UN's

753
00:43:51,010 --> 00:43:54,850
and then there's those the little on
tablets says want to be a ninety years

754
00:43:54,850 --> 00:43:56,869
in a row 21 Q portion number

755
00:43:56,869 --> 00:44:00,510
packet and so now you can say okay the
reason the 163 me when

756
00:44:00,510 --> 00:44:06,869
on how tag my some interfaces that
couple lessons learned here

757
00:44:06,869 --> 00:44:11,100
arm its head home house and a job where

758
00:44:11,100 --> 00:44:15,060
I was a good as they got the TP enable
doing an internal panamanian truck

759
00:44:15,060 --> 00:44:18,369
and Mike and obviously want a strong
consensus guys didn't have any some

760
00:44:18,369 --> 00:44:20,160
interfaces set up before

761
00:44:20,160 --> 00:44:24,050
all their stuff just ahead answer just
now communicating

762
00:44:24,050 --> 00:44:27,330
already that on next item is

763
00:44:27,330 --> 00:44:31,350
we use your same here to launch this
attack your city is awesome

764
00:44:31,350 --> 00:44:36,400
but in a lot of the protocol that
supports it does not tear down correctly

765
00:44:36,400 --> 00:44:39,560
so you kill your senior what's gonna
happen

766
00:44:39,560 --> 00:44:43,200
is om the port still gonna be and trunk
mode

767
00:44:43,200 --> 00:44:46,590
every time to get this to stop I have
had actually physically unplug

768
00:44:46,590 --> 00:44:50,619
and might kill the link now I only got a
killer for you know 30 seconds or so

769
00:44:50,619 --> 00:44:54,740
for everything the recent go back to
normal but yeah he just close your Sanya

770
00:44:54,740 --> 00:44:57,990
chances are it's not gonna murder time

771
00:44:57,990 --> 00:45:01,140
the best part was we were on a job
together and

772
00:45:01,140 --> 00:45:04,190
I'm going back to how this client was
using

773
00:45:04,190 --> 00:45:08,340
BTP to are spread out UN's across their
network which

774
00:45:08,340 --> 00:45:11,420
DTP one hand we use as well on

775
00:45:11,420 --> 00:45:14,420
they had their domain name which is
arbitrary

776
00:45:14,420 --> 00:45:15,810
doesn't have to be anything

777
00:45:15,810 --> 00:45:18,720
I'm be made it a domain admin password

778
00:45:18,720 --> 00:45:22,010
soho we open up Wireshark unlike

779
00:45:22,010 --> 00:45:25,730
pat's weird that looks like a pass
really is why would you name your domain

780
00:45:25,730 --> 00:45:26,090
that

781
00:45:26,090 --> 00:45:29,150
and we looked we did anonymous
enumeration a nadie

782
00:45:29,150 --> 00:45:33,450
and found that there was an account name
with what the first portion that

783
00:45:33,450 --> 00:45:34,230
password was

784
00:45:34,230 --> 00:45:37,490
like it saddam and like no way I'll buy
you beer that works

785
00:45:37,490 --> 00:45:40,780
and Mike tried it for the amendments was
crazy

786
00:45:40,780 --> 00:45:45,330
com this kinda something you see in the
field okay quick-fix here

787
00:45:45,330 --> 00:45:48,490
arm basically

788
00:45:48,490 --> 00:45:52,210
as I said all the Cisco devices come
with this enabled so you have to go into

789
00:45:52,210 --> 00:45:52,590
each

790
00:45:52,590 --> 00:45:57,670
interface in states which mode access
Sears interesting hey you don't have the

791
00:45:57,670 --> 00:45:59,270
ability to be anything

792
00:45:59,270 --> 00:46:02,420
by an access mode you have to manually
going to each

793
00:46:02,420 --> 00:46:06,200
interface I have tried to scour the
internet

794
00:46:06,200 --> 00:46:09,630
to see if there's a way to just make a
global setting the push this out

795
00:46:09,630 --> 00:46:13,400
I can't find anything are but a few
years now that because Oracle

796
00:46:13,400 --> 00:46:16,570
or range

797
00:46:16,570 --> 00:46:20,510
now in idiots yep

798
00:46:20,510 --> 00:46:26,810
on up

799
00:46:26,810 --> 00:46:33,770
go think go

800
00:46:33,770 --> 00:46:37,040
okay awesome awesome I'm just in case
someone watches later on

801
00:46:37,040 --> 00:46:40,070
on a Jameson you can use macros to do
this as well which is pretty cool women

802
00:46:40,070 --> 00:46:41,070
have to look into that

803
00:46:41,070 --> 00:46:45,430
appreciate the input sir that's awesome
basically you're going to then say

804
00:46:45,430 --> 00:46:49,310
switch port nine negotiate which means
stop sending DTP frames out so

805
00:46:49,310 --> 00:46:52,340
Wireshark you know of them back I can't
even tell that its

806
00:46:52,340 --> 00:46:55,820
a possibility here and then just assign
your view 19

807
00:46:55,820 --> 00:46:59,190
arm so basically

808
00:46:59,190 --> 00:47:05,079
for the DTP attack here I'm at a
walk-through kinda quick thing

809
00:47:05,079 --> 00:47:07,990
I guess so DTP what is it get you

810
00:47:07,990 --> 00:47:12,269
I meant sorry just talked a lot about
how did a tack the

811
00:47:12,269 --> 00:47:15,359
we're speed through this for trying to
boil the ocean in a stock if you haven't

812
00:47:15,359 --> 00:47:16,240
figured that out

813
00:47:16,240 --> 00:47:19,400
on so DTP its

814
00:47:19,400 --> 00:47:23,369
and devastating attack and so now if we
made a trunk

815
00:47:23,369 --> 00:47:28,519
now I figure out what view and use for
all your PC I traffic

816
00:47:28,519 --> 00:47:32,880
and i'd tagged at now I just bypassed
every ACL

817
00:47:32,880 --> 00:47:37,569
in your environment and I'm on your PCI
network pretty devastating and a

818
00:47:37,569 --> 00:47:40,670
now the hard part is you gotta figure
out this are are

819
00:47:40,670 --> 00:47:44,720
which beer and that's on and that's not
always apparent but if you can do that

820
00:47:44,720 --> 00:47:48,599
that's really devastating and now I just
bypassed all your PC I controls

821
00:47:48,599 --> 00:47:51,710
the next one is I'm it right

822
00:47:51,710 --> 00:47:55,779
and and now I can the a member at every
view and that I what

823
00:47:55,779 --> 00:47:59,339
now I can mark launch those other two
attacks we talked about

824
00:47:59,339 --> 00:48:03,730
so are spitting or Alan Arnette biased
but I think

825
00:48:03,730 --> 00:48:07,740
all over your networks I take it from a
layer 2

826
00:48:07,740 --> 00:48:10,950
only local subnet now I attach it with
your sanity in

827
00:48:10,950 --> 00:48:16,000
I'm a trunk attack on interfaces now I'm
doing that by its name responses

828
00:48:16,000 --> 00:48:20,069
for your server is your clients your
home network it's pretty crazy

829
00:48:20,069 --> 00:48:25,859
I'm and then went for time that's all
we're gonna cover for that one

830
00:48:25,859 --> 00:48:29,740
I'm so real quick real-world network
attacks

831
00:48:29,740 --> 00:48:33,089
so we went over I'm some some

832
00:48:33,089 --> 00:48:36,180
protocol taxes is how we we compromise

833
00:48:36,180 --> 00:48:40,809
networks all the time I'm so will go for
domain and then we'll also go for

834
00:48:40,809 --> 00:48:43,869
your network routers and switches so

835
00:48:43,869 --> 00:48:48,190
first step is he obtain your S&P strings
on

836
00:48:48,190 --> 00:48:51,670
so then you dumped in thinks you analyze
those

837
00:48:51,670 --> 00:48:56,450
find your S&P private strings and now I
attack your home network infrastructure

838
00:48:56,450 --> 00:48:59,869
I'm so there's a few ways we do that and

839
00:48:59,869 --> 00:49:04,180
said that the first play you obtain your
S&P string on

840
00:49:04,180 --> 00:49:07,619
my favorite ways prata percent tax I'm

841
00:49:07,619 --> 00:49:11,279
couple other guys made prata which is
used to attack him

842
00:49:11,279 --> 00:49:14,930
mean the S&P and web interface is a
default password so I watched at your

843
00:49:14,930 --> 00:49:16,119
wet your printer's

844
00:49:16,119 --> 00:49:20,579
one printer I find your network guy set
up with the S&P community read write

845
00:49:20,579 --> 00:49:21,829
string the EU's

846
00:49:21,829 --> 00:49:26,359
now use that and chances are that
strings for use throughout your network

847
00:49:26,359 --> 00:49:30,539
you don't have ACLs on interfaces which
we see all the time

848
00:49:30,539 --> 00:49:34,059
now i cant dont every configure network
figure out here

849
00:49:34,059 --> 00:49:37,349
local user passwords depending on the
authentication preference I just a

850
00:49:37,349 --> 00:49:38,940
Career Network

851
00:49:38,940 --> 00:49:42,990
on so this example scanning

852
00:49:42,990 --> 00:49:46,880
public-private I find one Cisco switch
now i download

853
00:49:46,880 --> 00:49:49,900
all those next one prayed at

854
00:49:49,900 --> 00:49:53,009
here's some SNMP strings we we
encountered I'm

855
00:49:53,009 --> 00:49:56,170
with pride and entries for private
community strings

856
00:49:56,170 --> 00:49:59,200
next one miss type 16 bypass this

857
00:49:59,200 --> 00:50:03,779
this in all the 2001 vulnerability that
we see all the time cuz no one updates

858
00:50:03,779 --> 00:50:05,200
to routers and switches

859
00:50:05,200 --> 00:50:08,539
and because they just work so

860
00:50:08,539 --> 00:50:12,059
all you need to do is find that one old
switch that might be used for the

861
00:50:12,059 --> 00:50:16,109
you know IT Helpdesk a VM or something
that has this phone ability

862
00:50:16,109 --> 00:50:19,650
now i bypass your authentication I don't
care configure I found that private

863
00:50:19,650 --> 00:50:20,349
string

864
00:50:20,349 --> 00:50:23,749
marries an on your networking I'm

865
00:50:23,749 --> 00:50:27,869
or you just look for not I for ones
without authentication so

866
00:50:27,869 --> 00:50:31,539
if you search showed and Cisco IRS last
modified

867
00:50:31,539 --> 00:50:35,529
these are routers and switches that
don't require authentication

868
00:50:35,529 --> 00:50:38,650
and in this case there's thousands them
on the internet

869
00:50:38,650 --> 00:50:41,690
has handed and

870
00:50:41,690 --> 00:50:45,019
next we dumb thing in Fig so we do that
with that

871
00:50:45,019 --> 00:50:49,230
Cisco SMB zeros Kane many other tools
support this

872
00:50:49,230 --> 00:50:54,749
on dumping in Fig we look at it for type
7 pass for as we look at it for

873
00:50:54,749 --> 00:50:58,680
real password Cisco keeps introducing
new protocols that are easier to crack

874
00:50:58,680 --> 00:50:59,319
so

875
00:50:59,319 --> 00:51:02,589
we had typed by passwords those are a
little harder crack

876
00:51:02,589 --> 00:51:06,299
then they said hey let's take away the
salt to make it tight for

877
00:51:06,299 --> 00:51:08,240
now I can crack there's easy

878
00:51:08,240 --> 00:51:12,400
and and then we can use those to condone
the network

879
00:51:12,400 --> 00:51:17,240
that's basically then we scan with that
new string and now we have every single

880
00:51:17,240 --> 00:51:18,369
network device

881
00:51:18,369 --> 00:51:22,099
I'm now what do we do with that

882
00:51:22,099 --> 00:51:26,040
quick order static routes default
highest administrative distance this

883
00:51:26,040 --> 00:51:28,430
means that when it looks and writing
preferences

884
00:51:28,430 --> 00:51:31,730
for static routes then

885
00:51:31,730 --> 00:51:36,339
we use that test do kinda similar attack
vectors and I had a default gateway

886
00:51:36,339 --> 00:51:39,540
right a new route to Google now every
time

887
00:51:39,540 --> 00:51:42,980
some user on your local senate President
Google to go to me

888
00:51:42,980 --> 00:51:46,390
I had that set UNC path and I on that
device to this is

889
00:51:46,390 --> 00:51:49,790
how we took owning a router switch and
made a practical

890
00:51:49,790 --> 00:51:54,510
really useful stuff %um on

891
00:51:54,510 --> 00:51:58,060
men other things we can do I'm

892
00:51:58,060 --> 00:52:01,829
we can actually configure are ported to
try to do that TTP tak

893
00:52:01,829 --> 00:52:06,650
at Sandy now or we can port near your
home network

894
00:52:06,650 --> 00:52:10,240
now I wanna partner your mainframe cuz I
know that has uninterrupted

895
00:52:10,240 --> 00:52:13,720
FTP telnet so I promote cormier

896
00:52:13,720 --> 00:52:16,910
partner issue our Spanish GRE tunnel

897
00:52:16,910 --> 00:52:19,970
not important hearing that switching
year in years

898
00:52:19,970 --> 00:52:24,609
I Server data center from my local
client interface

899
00:52:24,609 --> 00:52:28,470
and now I'm seeing all the traffic it
has because I own here

900
00:52:28,470 --> 00:52:32,450
your private string on your S&P go

901
00:52:32,450 --> 00:52:36,829
I'm and since we try to boil the ocean
we don't have time for the HSRP VRRP

902
00:52:36,829 --> 00:52:38,720
attacks will post them later

903
00:52:38,720 --> 00:52:41,910
I'm one last thing bash

904
00:52:41,910 --> 00:52:45,060
bug shell-shocked I can do the same

905
00:52:45,060 --> 00:52:48,490
attack with this pretty call I'm you to
set a default gateway

906
00:52:48,490 --> 00:52:52,130
now me as a pen tester I prefer a shout
but you can do this

907
00:52:52,130 --> 00:52:55,369
on and just added default gateway at

908
00:52:55,369 --> 00:53:01,800
your attack box I'm and just issued via
DHCP cell

909
00:53:01,800 --> 00:53:05,010
I I think where running short on time

910
00:53:05,010 --> 00:53:08,220
I'm we have time for maybe one or two
questions I think

911
00:53:08,220 --> 00:53:13,310
and up okay

912
00:53:13,310 --> 00:53:20,310
I any questions up

913
00:53:34,590 --> 00:53:41,590
well go

914
00:53:43,080 --> 00:53:48,640
up

915
00:53:48,640 --> 00:53:51,800
yep at absolutely so they there's two
things there

916
00:53:51,800 --> 00:53:56,800
on the first one is the a jerky update
started their DNS infrastructure a good

917
00:53:56,800 --> 00:53:57,310
idea

918
00:53:57,310 --> 00:54:00,610
the second one ways lot of client tools

919
00:54:00,610 --> 00:54:05,310
scan out S&P private string so you just
Wireshark you do passively

920
00:54:05,310 --> 00:54:10,480
listening and you see your S&P community
string we've seen that all the time too

921
00:54:10,480 --> 00:54:13,880
and is effective so up all these
different

922
00:54:13,880 --> 00:54:16,930
client management also did back new
devices

923
00:54:16,930 --> 00:54:20,350
do this all the time really great useful
trick I so

924
00:54:20,350 --> 00:54:24,950
good comments there on any other last
questions

925
00:54:24,950 --> 00:54:29,910
yes we're gonna put our slides up

926
00:54:29,910 --> 00:54:32,970
I'm we we help to cover more attack
spoke up

927
00:54:32,970 --> 00:54:37,020
at but what about the sides up and if
you guys have any questions our contact

928
00:54:37,020 --> 00:54:38,820
info is a good getting the slides

929
00:54:38,820 --> 00:54:42,940
we're happy dance answer questions I'm
one last thing I

930
00:54:42,940 --> 00:54:46,400
promise my employer our group is hiring
so

931
00:54:46,400 --> 00:54:49,960
on if you want to work in attacking pan
for at the largest

932
00:54:49,960 --> 00:54:53,150
10 largest in for a sec I'm

933
00:54:53,150 --> 00:54:56,190
offerings were were actively hiring for

934
00:54:56,190 --> 00:54:59,960
just about any security position you can
imagine on

935
00:54:59,960 --> 00:55:00,370
that's it

