1
00:00:00,000 --> 00:00:03,860
the only thing between you and a
shitload a free beer so

2
00:00:03,860 --> 00:00:07,480
I'm not going to be very cognitive that
and timely

3
00:00:07,480 --> 00:00:10,870
I yes yes hurry rice hurry

4
00:00:10,870 --> 00:00:17,160
hash tag hurry %ah I must mckree

5
00:00:17,160 --> 00:00:21,350
I am the director of threat intelligence
and engineering for Microsoft Online

6
00:00:21,350 --> 00:00:22,220
Services

7
00:00:22,220 --> 00:00:26,269
I am as a function of that also
intimately aware that

8
00:00:26,269 --> 00:00:31,330
today has been no clearly questionable
first Microsoft products Active

9
00:00:31,330 --> 00:00:33,329
Directory PowerShell are clearly

10
00:00:33,329 --> 00:00:36,520
security for hacker features now so

11
00:00:36,520 --> 00:00:40,790
I get it I'm I'm with you we use them in
Penn tests to you

12
00:00:40,790 --> 00:00:45,120
I so there's that and there's the fear
prancer gonna move along very quickly

13
00:00:45,120 --> 00:00:45,850
but

14
00:00:45,850 --> 00:00:49,510
one other things its cool about the work
I do there's work to do in the military

15
00:00:49,510 --> 00:00:51,750
they were going to use the sands handler

16
00:00:51,750 --> 00:00:55,050
a clear hopefully with the Internet
storm center

17
00:00:55,050 --> 00:00:58,370
and up with some

18
00:00:58,370 --> 00:01:02,140
in particular holistic InfoSec .org
which my site I get to spend a lot of

19
00:01:02,140 --> 00:01:03,809
time on Tools that's my goal

20
00:01:03,809 --> 00:01:07,470
and the mission behind those tools and
and their uses to you

21
00:01:07,470 --> 00:01:12,439
I inform readers on how to hopefully go
take sometimes simple concepts go ply

22
00:01:12,439 --> 00:01:14,439
them right away so what you learned here
tonight

23
00:01:14,439 --> 00:01:18,320
is something you can go do or may
already be doing but you with us

24
00:01:18,320 --> 00:01:22,259
potentially very how you do it I the
tools you do it with

25
00:01:22,259 --> 00:01:25,659
recognize that this is in essence a blue
teaming primer

26
00:01:25,659 --> 00:01:29,570
this is not necessarily highly scaleable
it is in essence

27
00:01:29,570 --> 00:01:33,340
test data but what we talk about tonight
will be I

28
00:01:33,340 --> 00:01:38,229
based on some realities some truths I'm
not basically pose things to you guys as

29
00:01:38,229 --> 00:01:39,079
questions

30
00:01:39,079 --> 00:01:42,560
I so that I don't have to actually get
myself in trouble by answering or say

31
00:01:42,560 --> 00:01:44,119
anything terribly specific

32
00:01:44,119 --> 00:01:49,470
so you'll you'll see why when we get
there so on we go see 3cm

33
00:01:49,470 --> 00:01:53,640
is alternately command control

34
00:01:53,640 --> 00:01:56,719
countermeasures communications
countermeasures

35
00:01:56,719 --> 00:02:00,000
that is a acronym I picked up

36
00:02:00,000 --> 00:02:03,430
during Officer Candidate School and

37
00:02:03,430 --> 00:02:06,549
self anybody who's been in the military
and as

38
00:02:06,549 --> 00:02:11,849
spent time in any kinda schools I'll of
scan school tends to be taught by

39
00:02:11,849 --> 00:02:15,709
sometimes older officers you can go on
horror

40
00:02:15,709 --> 00:02:20,879
so what about the twelfth hour with no
brakes with the incredibly history

41
00:02:20,879 --> 00:02:25,050
colonel I was losing my minds and I'm
actually reading the back

42
00:02:25,050 --> 00:02:28,459
a bf from 10 to which is Field Manual
army

43
00:02:28,459 --> 00:02:32,470
doctrine reference publications
overthrowing right

44
00:02:32,470 --> 00:02:36,860
but in the back we get this thing see
3cm I'm like that's a presentation

45
00:02:36,860 --> 00:02:37,849
waiting to happen

46
00:02:37,849 --> 00:02:44,010
so here we are a three-part series on C
three cm is available as of August 2013

47
00:02:44,010 --> 00:02:48,280
at holistic info Sep dot blogspot dot
com

48
00:02:48,280 --> 00:02:51,370
our daughter working and I

49
00:02:51,370 --> 00:02:55,410
in essence it is three different
write-ups on exactly what we're talking

50
00:02:55,410 --> 00:02:57,620
about today how to in essence conduct

51
00:02:57,620 --> 00:03:01,000
I am identify

52
00:03:01,000 --> 00:03:05,290
interrupt encounter what might be an
adversary on your network

53
00:03:05,290 --> 00:03:10,500
I am principally its not too terribly
revealing but

54
00:03:10,500 --> 00:03:13,810
as an aggregate over activities it can
be very interesting

55
00:03:13,810 --> 00:03:16,930
we've applied it I've applied in a few
different places

56
00:03:16,930 --> 00:03:20,760
this conforms really nicely with what
you guys may already know %uh vez

57
00:03:20,760 --> 00:03:24,540
network security monitoring practices
you guys are packing has your blue team

58
00:03:24,540 --> 00:03:26,610
urgent spent a lot of time with snorts

59
00:03:26,610 --> 00:03:29,860
spent a lot of time on the wire you
probably read

60
00:03:29,860 --> 00:03:34,760
Richard valence books practices network
security monitoring his latest

61
00:03:34,760 --> 00:03:38,319
were applied network security monitoring
that just came out from Chris Sanders

62
00:03:38,319 --> 00:03:41,790
both those books are have a lovely
referenced in here

63
00:03:41,790 --> 00:03:45,480
and our really good reads and this
activity is in essence very much in

64
00:03:45,480 --> 00:03:46,340
keeping with that

65
00:03:46,340 --> 00:03:51,500
Stefan identified in any

66
00:03:51,500 --> 00:03:55,459
an environment like microsoft's Online
Services is an example

67
00:03:55,459 --> 00:03:59,549
full content regular timely all-time on

68
00:03:59,549 --> 00:04:04,580
fact captures not feasible snapshot on
demand when you need it short

69
00:04:04,580 --> 00:04:08,819
but typically we have to use flows why
flows

70
00:04:08,819 --> 00:04:12,700
is packed he spent time on the wire wire
you money is now 40

71
00:04:12,700 --> 00:04:18,000
shorter

72
00:04:18,000 --> 00:04:23,389
smaller right I'm basically yet source
IP destination IP source port

73
00:04:23,389 --> 00:04:26,750
destination port sometimes spending on a
flight type: a little more data

74
00:04:26,750 --> 00:04:29,870
but it's a much smaller footprint when
you can manage it than it is

75
00:04:29,870 --> 00:04:36,870
on before captures so what's cool about
it is you can use tools

76
00:04:36,970 --> 00:04:40,470
there are freely available easily
installed on Linux systems that's the

77
00:04:40,470 --> 00:04:43,220
other irony is everything I talk about
tonight is on Ubuntu system

78
00:04:43,220 --> 00:04:47,060
so I

79
00:04:47,060 --> 00:04:50,639
F probe does basically watch I am

80
00:04:50,639 --> 00:04:53,940
you know promiscuous listener with you
for packet captures

81
00:04:53,940 --> 00:04:59,160
will translate traffic intercepts in the
flows and forwarded on to collect right

82
00:04:59,160 --> 00:05:03,340
very functional very simple very light I
am incredibly useful

83
00:05:03,340 --> 00:05:07,120
particularly when experts again you can
stage the sensors anywhere

84
00:05:07,120 --> 00:05:10,509
you can put listening devices if you
will on Span's on poor

85
00:05:10,509 --> 00:05:15,310
are on my taps so you know the ability
to scale this out is quite reasonable

86
00:05:15,310 --> 00:05:19,360
there are of course tons and tons
commercial inexpensive flow tools

87
00:05:19,360 --> 00:05:22,800
so this isn't to say this is the only
way you can do this activity

88
00:05:22,800 --> 00:05:26,080
but you know I money not big shopping on
a budget cool

89
00:05:26,080 --> 00:05:29,810
this is one of the options are you can
utilize

90
00:05:29,810 --> 00:05:33,259
and a dump is a toolset if you will not
unlike

91
00:05:33,259 --> 00:05:38,410
TCP don't um and its collection have
useful tools like TCP replay

92
00:05:38,410 --> 00:05:41,470
it's just the same concepts for flows I

93
00:05:41,470 --> 00:05:45,259
and again really useful very
syntactically like

94
00:05:45,259 --> 00:05:50,960
she see examples and then NSN which is
basically a web based in a graphical

95
00:05:50,960 --> 00:05:52,240
front-end

96
00:05:52,240 --> 00:05:55,910
that simplifies viewing all this data

97
00:05:55,910 --> 00:06:01,550
but allows modularity and plugins and
that is we're in a site comes in

98
00:06:01,550 --> 00:06:05,919
and it's a flow processing told it does
a few things most importantly it takes

99
00:06:05,919 --> 00:06:09,120
in a directional flows murchison and
makes sense

100
00:06:09,120 --> 00:06:13,150
love them as they traverse your network
in Press an egress purses egress and

101
00:06:13,150 --> 00:06:14,370
ingress

102
00:06:14,370 --> 00:06:17,610
incredibly important as you're doing
network security monitoring definitely

103
00:06:17,610 --> 00:06:18,400
needed

104
00:06:18,400 --> 00:06:22,720
differentiates direction and what's
going on and I will give you examples

105
00:06:22,720 --> 00:06:26,509
up why as we trail what is

106
00:06:26,509 --> 00:06:30,880
a somewhat made up adversary

107
00:06:30,880 --> 00:06:34,509
in sorta real conditions that I can't
really

108
00:06:34,509 --> 00:06:37,710
talk about agreement

109
00:06:37,710 --> 00:06:43,500
but the plugin is incredibly useful for
visualization perspective sup

110
00:06:43,500 --> 00:06:48,370
let's look at it and SN profiles a
traffic

111
00:06:48,370 --> 00:06:51,849
and as you guys look at this you'll see
if you think anybody who spent a bunch

112
00:06:51,849 --> 00:06:54,690
of time on glass looking at network
traffic

113
00:06:54,690 --> 00:06:58,180
recognizes this is moral ask i neva
voters Pat

114
00:06:58,180 --> 00:07:02,160
right you know if there's also an is no
traffic and then there's huge

115
00:07:02,160 --> 00:07:05,810
very flat traffic spike you know like
yeah that doesn't look anything like

116
00:07:05,810 --> 00:07:07,960
what a real network would look like

117
00:07:07,960 --> 00:07:12,220
very good this is a lab scenario were
playing with the concept of

118
00:07:12,220 --> 00:07:16,560
simulating traffic there are some
wonderful NetFlow simulators but what

119
00:07:16,560 --> 00:07:18,380
you get from this

120
00:07:18,380 --> 00:07:22,039
is the principal behaviors these tools
are built on

121
00:07:22,039 --> 00:07:26,110
Rd tools scripts that are probably
familiar with you

122
00:07:26,110 --> 00:07:29,539
for you if using cricket or MRTG I'm so

123
00:07:29,539 --> 00:07:33,380
similar concept but as you zoom in

124
00:07:33,380 --> 00:07:36,900
you see a few things you know sorted
jump out

125
00:07:36,900 --> 00:07:41,780
but nothing to address in Seoul what if
we dig in a little further

126
00:07:41,780 --> 00:07:45,580
right away as you look at this you and
sort it

127
00:07:45,580 --> 00:07:49,440
obviously right at the top what's the
most important interesting thing you see

128
00:07:49,440 --> 00:07:54,190
the jumps right out

129
00:07:54,190 --> 00:07:57,940
yet a lot shid right 4.9 getting

130
00:07:57,940 --> 00:08:01,900
kinda kinda heavy that's not consistent
with the rest of the traffic patterns

131
00:08:01,900 --> 00:08:02,560
and

132
00:08:02,560 --> 00:08:05,840
its obviously interesting it's probably
worth dating and no

133
00:08:05,840 --> 00:08:10,650
mall so we do so that's where n/a site
comes in

134
00:08:10,650 --> 00:08:13,650
incredibly handy because it helps you
sort traffic

135
00:08:13,650 --> 00:08:17,490
each of these entities is quick Pro Bowl

136
00:08:17,490 --> 00:08:21,960
East user unfortunately staggering I am

137
00:08:21,960 --> 00:08:26,400
but if I'd really in any one of these
boxes though pop out I'll give me more

138
00:08:26,400 --> 00:08:29,849
date on the hits in course right away we
see the fact that we've got some twenty

139
00:08:29,849 --> 00:08:32,589
to drop it from the 70 dot 40 address

140
00:08:32,589 --> 00:08:36,260
but nothing that stands out our matches
particularly that 4.9

141
00:08:36,260 --> 00:08:41,169
gigs so maybe that's cool its SSA
trafficking clearly worried about it so

142
00:08:41,169 --> 00:08:42,190
maybe I want to market

143
00:08:42,190 --> 00:08:46,350
right it allows me to tag I can

144
00:08:46,350 --> 00:08:50,160
flag any given traffic and say hey maybe
this is part of some exploration

145
00:08:50,160 --> 00:08:52,990
something %uh ventures something I want
to keep an eye on

146
00:08:52,990 --> 00:08:56,029
and I site allows you to tag that in pop
out I

147
00:08:56,029 --> 00:09:00,810
an interesting view providing a little
bit further to change my time window

148
00:09:00,810 --> 00:09:05,709
little bit then all of a sudden I can
find

149
00:09:05,709 --> 00:09:09,839
that guy I was interested in there's a
little more traffic right

150
00:09:09,839 --> 00:09:13,910
I've got 31 died 1948 got 78

151
00:09:13,910 --> 00:09:17,930
I have that many flows but it definitely
got a little more data

152
00:09:17,930 --> 00:09:22,070
make today divers kilobytes that's
probably something more interesting and

153
00:09:22,070 --> 00:09:23,850
I think I'm gonna work on

154
00:09:23,850 --> 00:09:28,279
so course anytime you have an IP
ventures you gonna look it up

155
00:09:28,279 --> 00:09:31,620
rolling update on this one says moon

156
00:09:31,620 --> 00:09:35,360
Syria now fear

157
00:09:35,360 --> 00:09:39,380
large enterprise in seeing interest in
traffic from Syria what's the first

158
00:09:39,380 --> 00:09:46,380
thing you might see

159
00:09:46,610 --> 00:09:51,019
right channel charm they were really
busy when we started

160
00:09:51,019 --> 00:09:55,279
doing this research you know late last
year and then all of a sudden and

161
00:09:55,279 --> 00:09:58,430
in January 2014 those guys growing

162
00:09:58,430 --> 00:10:01,880
got very aggressive and I'll while not

163
00:10:01,880 --> 00:10:05,459
similar to this scenario it is public
information that Microsoft had more than

164
00:10:05,459 --> 00:10:08,339
one run and what the certain electronic
army and

165
00:10:08,339 --> 00:10:12,250
did in fact suffer what was a
compromiser social

166
00:10:12,250 --> 00:10:15,620
I'll media accounts if you will

167
00:10:15,620 --> 00:10:19,829
so all sudden we started tweeting out
some very interesting things on

168
00:10:19,829 --> 00:10:24,709
you have a very interesting people not
to our intensive course

169
00:10:24,709 --> 00:10:28,180
so up when it makes for great pattern

170
00:10:28,180 --> 00:10:32,910
to analyzing and continue down the path
imagining this is our adversaries with

171
00:10:32,910 --> 00:10:34,610
cherry on through this activity

172
00:10:34,610 --> 00:10:39,570
sign of site now has a and if I D S
which is incredibly call from a

173
00:10:39,570 --> 00:10:41,390
visualization perspective

174
00:10:41,390 --> 00:10:46,120
%uh not only for detecting certain
skinny tie spin in particular really

175
00:10:46,120 --> 00:10:47,450
working well on

176
00:10:47,450 --> 00:10:51,560
not deny what service and suspicious
communications he can sorta see in a

177
00:10:51,560 --> 00:10:53,570
visualization

178
00:10:53,570 --> 00:10:58,180
that's obviously either a and I'll
service traffic or potentially

179
00:10:58,180 --> 00:11:02,050
on some individual single host scanning
it doesn't give us a lot of information

180
00:11:02,050 --> 00:11:05,220
around actual specific service or
suggest that he's

181
00:11:05,220 --> 00:11:08,970
but if you were to drill and assign
specific data points to it

182
00:11:08,970 --> 00:11:13,120
visualization start to represent more so
getting more flexible there's a new

183
00:11:13,120 --> 00:11:14,980
release candidate this tool as a

184
00:11:14,980 --> 00:11:18,300
5 September he hadn't updated it for
years but I've been bugging him

185
00:11:18,300 --> 00:11:19,850
incessantly its gonna

186
00:11:19,850 --> 00:11:23,870
Robert hurt the any did drop new code so
he got wanna play with this

187
00:11:23,870 --> 00:11:29,110
just go see it on a on the SourceForge
site you can pull it down

188
00:11:29,110 --> 00:11:33,589
I make this decked really available so
this is it all interest in you

189
00:11:33,589 --> 00:11:36,959
just hit me dropping Cardinal email it
to you but not

190
00:11:36,959 --> 00:11:40,120
is just type the link is its an online
presentation but

191
00:11:40,120 --> 00:11:43,029
all the resources and all the
information than you might find

192
00:11:43,029 --> 00:11:44,160
interesting on the back

193
00:11:44,160 --> 00:11:47,680
so

194
00:11:47,680 --> 00:11:52,860
so faced you we have identified somebody
we are obviously interested in that

195
00:11:52,860 --> 00:11:54,970
thirty 1.0 address

196
00:11:54,970 --> 00:11:59,029
so let's get into interruption my time I
look like

197
00:11:59,029 --> 00:12:04,490
you probably now heard a good deal about
be out staff elastic search

198
00:12:04,490 --> 00:12:07,930
large stash in Camano they used to be
separate entities

199
00:12:07,930 --> 00:12:11,779
plastic surgeon for bond I think we're
together in one company

200
00:12:11,779 --> 00:12:15,459
they went out and bought a large stash
guy and now it's one company that

201
00:12:15,459 --> 00:12:17,060
promotes

202
00:12:17,060 --> 00:12:20,769
these tools together and they're
incredibly useful in their growing

203
00:12:20,769 --> 00:12:23,829
I and their use all the time fact

204
00:12:23,829 --> 00:12:28,860
I'm right in the middle and writing up a
full article for the source mccollum on

205
00:12:28,860 --> 00:12:29,760
honey drive

206
00:12:29,760 --> 00:12:34,490
and he's using plastic surgeon the outs
that for any drive data now too

207
00:12:34,490 --> 00:12:38,519
so it's incredibly flexible works really
well in the circumstances particularly

208
00:12:38,519 --> 00:12:40,079
with Bro

209
00:12:40,079 --> 00:12:44,810
you may have spent a ton of time what
snorts your packet person

210
00:12:44,810 --> 00:12:48,810
but I am if you have an experiment with
Bro and its capabilities

211
00:12:48,810 --> 00:12:52,970
it is a true NSM network security
monitoring platform

212
00:12:52,970 --> 00:12:56,459
and it's different and snort it doesn't
bogged down quite as much

213
00:12:56,459 --> 00:12:59,930
differentiates different data
differently it die sechs

214
00:12:59,930 --> 00:13:03,269
traffic differently I'm and it's pretty
flexible

215
00:13:03,269 --> 00:13:07,660
and it's very extensible which is what
will see here

216
00:13:07,660 --> 00:13:12,839
rego adaptable very efficient flexible
acts on for forensics

217
00:13:12,839 --> 00:13:17,130
allows in-depth analysis allows
individual query centric parsing and

218
00:13:17,130 --> 00:13:18,029
logging

219
00:13:18,029 --> 00:13:22,040
highly stateful works really well in
high performance networks we have to

220
00:13:22,040 --> 00:13:24,810
spend a great deal of time and massive
traffic fines

221
00:13:24,810 --> 00:13:29,070
its Perry performing and its course is
broadly open source it does not have

222
00:13:29,070 --> 00:13:32,130
any restrictions so you can do with it
what you will

223
00:13:32,130 --> 00:13:37,440
an extended how you might

224
00:13:37,440 --> 00:13:41,339
classic search is just a restful you
know text search engine basically it's

225
00:13:41,339 --> 00:13:45,290
incredibly useful though not very flat
very fast

226
00:13:45,290 --> 00:13:50,940
very lean and not the issues with soap
for obviously performance

227
00:13:50,940 --> 00:13:56,180
a simple object access protocol
individualize is entities in data

228
00:13:56,180 --> 00:13:59,800
where the the restful input is basically

229
00:13:59,800 --> 00:14:03,070
180 I that aggregates everything for you
much more

230
00:14:03,070 --> 00:14:08,240
how quickly an official so that's what
really makes last searched and out

231
00:14:08,240 --> 00:14:12,260
and of course large stash he spent a
bunch of time with

232
00:14:12,260 --> 00:14:15,380
I'll you know albeit highly expensive
but

233
00:14:15,380 --> 00:14:19,519
at least partially schools on
cross-strait if you've got the money

234
00:14:19,519 --> 00:14:23,019
you got the last seen that allows you to
run a bunch of data to respond anybody

235
00:14:23,019 --> 00:14:24,860
spends time with spawn

236
00:14:24,860 --> 00:14:29,800
recognizes how quickly you can overload
license right she's laughing giuliani

237
00:14:29,800 --> 00:14:33,940
I you know or god forbid you use logger
with

238
00:14:33,940 --> 00:14:38,310
by you know ArcSight or something
similar in a very quickly run into a

239
00:14:38,310 --> 00:14:42,610
a licensing model update will limit you
to no end

240
00:14:42,610 --> 00:14:45,810
watched ash does not but the payoff

241
00:14:45,810 --> 00:14:50,829
then is complexity of setup you need to
understand how

242
00:14:50,829 --> 00:14:54,310
to in essence configure large task horse

243
00:14:54,310 --> 00:14:58,620
the appropriate wats it does so
inherently and natively for certain long

244
00:14:58,620 --> 00:15:01,050
tights but you may have one that is

245
00:15:01,050 --> 00:15:04,709
unique or someone custom that you wish
to write a large catching up to work on

246
00:15:04,709 --> 00:15:05,720
that a little bit

247
00:15:05,720 --> 00:15:09,410
it's not two brutal but that nonetheless
it is

248
00:15:09,410 --> 00:15:12,899
very flexible again soon

249
00:15:12,899 --> 00:15:17,440
I think Obama's the visualization
component here and incredibly

250
00:15:17,440 --> 00:15:21,260
attractive very simplistic

251
00:15:21,260 --> 00:15:24,560
not overloaded doesn't necessarily mean

252
00:15:24,560 --> 00:15:28,380
you know overwhelm you with data in the
view

253
00:15:28,380 --> 00:15:32,899
and can be highly customized as well
specific query types to

254
00:15:32,899 --> 00:15:36,220
not make the day useful to you as your
monitoring and again

255
00:15:36,220 --> 00:15:40,560
you have individuals with eyes on glass
so

256
00:15:40,560 --> 00:15:44,519
here's our adversary can see exactly the
the same IP you're talking about and

257
00:15:44,519 --> 00:15:50,579
and now that we've identified who and
what we think the problem is

258
00:15:50,579 --> 00:15:54,310
and probably want to move to doing
something a little differently with down

259
00:15:54,310 --> 00:15:57,410
essentially blocking them doing
something active

260
00:15:57,410 --> 00:16:01,440
and keeping them at a bar how to burn
our space reality is

261
00:16:01,440 --> 00:16:05,810
again just log stash by itself has a
nice you a nice query engine it looks

262
00:16:05,810 --> 00:16:06,680
again

263
00:16:06,680 --> 00:16:09,839
not unlike Splunk and you can see here
we've got

264
00:16:09,839 --> 00:16:12,850
now for guess is a traffic specific

265
00:16:12,850 --> 00:16:16,040
based on time stamps to that IP

266
00:16:16,040 --> 00:16:19,899
cool but not particularly attractive for
cock ensign

267
00:16:19,899 --> 00:16:23,750
that's work product comes in and you'll
know

268
00:16:23,750 --> 00:16:28,120
as we zoom in but on the far right and
there's little tabs you got the blood

269
00:16:28,120 --> 00:16:31,839
types and then you got the IP address
for that specific

270
00:16:31,839 --> 00:16:36,509
adversary you can individually query and
identify and make you know

271
00:16:36,509 --> 00:16:39,860
interesting data pots specific to your
adversaries

272
00:16:39,860 --> 00:16:42,959
but what school years that he also just
Parsons out be

273
00:16:42,959 --> 00:16:47,949
the prologues for all rights its logs
out specifically for connections

274
00:16:47,949 --> 00:16:51,509
SSL DNS notice is coming off syslog

275
00:16:51,509 --> 00:16:54,680
cetera but then to me the weird log

276
00:16:54,680 --> 00:16:58,019
where large great because anything it
doesn't necessarily have clean

277
00:16:58,019 --> 00:16:59,170
identification

278
00:16:59,170 --> 00:17:02,690
up but still wants being logged based on

279
00:17:02,690 --> 00:17:06,419
up logic will drop in the weird lots o

280
00:17:06,419 --> 00:17:10,350
that's definitely one that if you're
running bro you wanna spend

281
00:17:10,350 --> 00:17:14,209
time parsing some form or fashion but
you can tell obviously that

282
00:17:14,209 --> 00:17:18,289
in this test scenario are most
aggressive traffic is obviously coming

283
00:17:18,289 --> 00:17:20,660
from that 31 address

284
00:17:20,660 --> 00:17:24,059
and we are so on again a little more

285
00:17:24,059 --> 00:17:28,030
if you read applied network a security
monitoring Chris Sanders a

286
00:17:28,030 --> 00:17:31,830
Syngress booked on the ones I mentioned
you'll find lots and lots o

287
00:17:31,830 --> 00:17:37,429
references to I'm too bro income on
large stash in you also finding

288
00:17:37,429 --> 00:17:41,480
on website associated with it some
really good scripts to do this activity

289
00:17:41,480 --> 00:17:42,390
with

290
00:17:42,390 --> 00:17:46,770
security onion a lot of what I'm talking
about here is just building this your

291
00:17:46,770 --> 00:17:48,929
cell phone Ubuntu incense

292
00:17:48,929 --> 00:17:53,960
but if you want you know NSM in a box
network security monitoring in a box

293
00:17:53,960 --> 00:17:58,280
the single best resource in the universe
period is Doug Burks

294
00:17:58,280 --> 00:18:03,059
security on downloaded it's a distro
it's ready to go in minutes

295
00:18:03,059 --> 00:18:06,280
highly performant you can drop it
anywhere and start driving

296
00:18:06,280 --> 00:18:10,230
evil traffic of the wire the
conflict-ridden this activity and

297
00:18:10,230 --> 00:18:14,090
security onion is security and configure
very specifically

298
00:18:14,090 --> 00:18:17,210
out to do certain in SM activities

299
00:18:17,210 --> 00:18:20,309
and as a function of it at your pad
these tools

300
00:18:20,309 --> 00:18:24,370
you may end up with contending are
competing service is trying to use the

301
00:18:24,370 --> 00:18:25,309
same ports

302
00:18:25,309 --> 00:18:28,640
and no run into a bit of issues around
interfaces and

303
00:18:28,640 --> 00:18:32,590
job you know you run into some
complexity setting up which is why

304
00:18:32,590 --> 00:18:36,169
just interested in learning you now
playing long as you develop with these

305
00:18:36,169 --> 00:18:36,789
tools

306
00:18:36,789 --> 00:18:40,000
up gone from rise of in the easier way
to go

307
00:18:40,000 --> 00:18:45,370
straight up problems so but I will
strongly recommend you spend time with

308
00:18:45,370 --> 00:18:52,370
security onion at this activities
interests you

309
00:18:59,610 --> 00:19:06,610
whose is it flying camel inserting

310
00:19:07,419 --> 00:19:12,870
whole okay

311
00:19:12,870 --> 00:19:16,970
write not so anybody who doesn't anybody
familiar with circa from just a couple

312
00:19:16,970 --> 00:19:19,559
sewed everybody knows the soreness or
cut as a

313
00:19:19,559 --> 00:19:23,200
on an engine created by AOL ISF

314
00:19:23,200 --> 00:19:27,470
with funding from DOD I'm and some other
very interested

315
00:19:27,470 --> 00:19:31,770
knows three-letter agencies for very
very high performance

316
00:19:31,770 --> 00:19:35,780
I'll full content inspection so sir ka
to basically can

317
00:19:35,780 --> 00:19:39,220
not consume Snort rules but does it with
a different

318
00:19:39,220 --> 00:19:42,789
different performance measurements then
you might be used what's more

319
00:19:42,789 --> 00:19:45,980
so very cool too particularly when you
think about

320
00:19:45,980 --> 00:19:50,580
I'm short by definition being now in
essence a largely

321
00:19:50,580 --> 00:19:54,809
commercial fender ventures so up

322
00:19:54,809 --> 00:19:59,780
the beauty in bro is the ability to do
things like execute scripts and have

323
00:19:59,780 --> 00:20:00,929
after-action

324
00:20:00,929 --> 00:20:04,090
based on texan so if you want to run

325
00:20:04,090 --> 00:20:07,520
you know something that says hey any
hits for this guy bang

326
00:20:07,520 --> 00:20:12,370
send something to change in ako or drop
in a firewall rule or any number

327
00:20:12,370 --> 00:20:16,350
possible action items scripting outubro
for action

328
00:20:16,350 --> 00:20:20,280
I'm is is really straightforward
well-documented

329
00:20:20,280 --> 00:20:24,090
I'll and in essence relatively easy to
act on so

330
00:20:24,090 --> 00:20:29,280
that's one other true advantages foreign
policy scripts and and program execution

331
00:20:29,280 --> 00:20:33,110
so very cool on that past

332
00:20:33,110 --> 00:20:36,659
so lastly you know all day we've seen

333
00:20:36,659 --> 00:20:39,960
some various posts John strand in this
room just a couple hours

334
00:20:39,960 --> 00:20:43,380
go talk about how not such and test that
was great

335
00:20:43,380 --> 00:20:48,039
so the Black Hills security guys were
all facially sitting in a row up there

336
00:20:48,039 --> 00:20:52,690
watching the boss I have written some
incredibly good tools and then we saw

337
00:20:52,690 --> 00:20:56,010
com Tom sitting up here with Ben

338
00:20:56,010 --> 00:20:59,400
iron couple runs over talking about ball
and chain

339
00:20:59,400 --> 00:21:04,700
and I'm Tom Roach her is also land
master has written a couple tools will

340
00:21:04,700 --> 00:21:05,929
talk about here in

341
00:21:05,929 --> 00:21:09,559
in ADHD to I'll you can download

342
00:21:09,559 --> 00:21:14,820
ADHD as a fully realized I so as well
and personalize it too

343
00:21:14,820 --> 00:21:20,390
question you have to ask yourself is
what does active defense really mean

344
00:21:20,390 --> 00:21:23,669
in a context like C three cm when you
got

345
00:21:23,669 --> 00:21:28,559
I am you've identified an adversary you
made movement to generate them and you

346
00:21:28,559 --> 00:21:30,789
feel like you may have been fairly
contain

347
00:21:30,789 --> 00:21:34,700
and now it's time to mess moreover feels
strong and capable enough

348
00:21:34,700 --> 00:21:39,240
do that you know to what extent there's
lots of debate right now

349
00:21:39,240 --> 00:21:43,770
military in three-letter agencies where
you know people want to talk about

350
00:21:43,770 --> 00:21:47,320
attacking back and I will tell you that
that's

351
00:21:47,320 --> 00:21:50,799
a gray area that gets all fuzzy
particularly for corporate america

352
00:21:50,799 --> 00:21:52,620
that's not something

353
00:21:52,620 --> 00:21:57,630
that you know I'm in any position to
advocate for say that you know we would

354
00:21:57,630 --> 00:21:58,760
ever do because it's

355
00:21:58,760 --> 00:22:02,520
in essence a legal up do with that what
you will

356
00:22:02,520 --> 00:22:07,150
some folks freely in clearly pursue
these avenues regardless

357
00:22:07,150 --> 00:22:10,559
10 things you can do is in essence a
passive active defense

358
00:22:10,559 --> 00:22:15,220
you can confound distract cause painful
whoops

359
00:22:15,220 --> 00:22:18,730
trap there's all kinds of activities she
can

360
00:22:18,730 --> 00:22:23,059
perpetrate against your attacker that
are not illegal and that's the intensive

361
00:22:23,059 --> 00:22:24,200
ADHD

362
00:22:24,200 --> 00:22:31,200
and some other tools like it so

363
00:22:31,669 --> 00:22:35,789
great names honey badger pushpin weblog
server de CuO

364
00:22:35,789 --> 00:22:39,270
they're all tools that help you identify
your attacker even if there's were

365
00:22:39,270 --> 00:22:40,730
trying to hide themselves

366
00:22:40,730 --> 00:22:46,510
and I'm some form a bob station up there
trafficker proxies

367
00:22:46,510 --> 00:22:49,630
and then the likes of artillery which is
above all things

368
00:22:49,630 --> 00:22:52,700
a trusted sec Dave Kennedy special

369
00:22:52,700 --> 00:22:55,850
I'm so here we are at their peak on
that's absolutely appropriate python

370
00:22:55,850 --> 00:22:57,280
script that in essence

371
00:22:57,280 --> 00:23:01,990
I'm not only runs honey pot like
features but helps hardened systems and

372
00:23:01,990 --> 00:23:05,280
I'm provide a number of other services
as your

373
00:23:05,280 --> 00:23:09,450
administering and monitoring on your
network you could stand up most sports

374
00:23:09,450 --> 00:23:09,990
oriented

375
00:23:09,990 --> 00:23:14,429
says ditto with no but here's the catch:
with no buses literacy

376
00:23:14,429 --> 00:23:17,650
literally just talking to Tom

377
00:23:17,650 --> 00:23:22,669
about some the ADHD releases sorry ten
times

378
00:23:22,669 --> 00:23:27,470
and tens added and then said that nobody
is now

379
00:23:27,470 --> 00:23:31,429
literally a commercial tool so if you
download their current instance have

380
00:23:31,429 --> 00:23:33,230
ADHD it's the .5

381
00:23:33,230 --> 00:23:36,950
made up which we talking about here it
still works

382
00:23:36,950 --> 00:23:39,789
he tried to go download it from the site
now they've moved on to a commercial

383
00:23:39,789 --> 00:23:41,960
model something that uphold know that
out

384
00:23:41,960 --> 00:23:45,690
have ADHD in the next release so keep
that in mind and literally just learned

385
00:23:45,690 --> 00:23:47,240
that down the speaker round

386
00:23:47,240 --> 00:23:52,570
unfortunately I'm by web labyrinth and
then some others aren't they're designed

387
00:23:52,570 --> 00:23:54,990
to disorienting confuse Nova

388
00:23:54,990 --> 00:23:59,029
in its in it's currently available
instance is great because you can build

389
00:23:59,029 --> 00:24:03,159
what are in essence I at your conscience

390
00:24:03,159 --> 00:24:06,220
haystacks take on a stack some ideas

391
00:24:06,220 --> 00:24:10,640
no your enticing your adversary to find
the needle in the haystack

392
00:24:10,640 --> 00:24:15,110
the beauty raise taxes that you can set
it up to look like

393
00:24:15,110 --> 00:24:18,750
to an attacker stronger and neck were
pretty much anything you want so

394
00:24:18,750 --> 00:24:22,610
I'm wanna look like you're having 1x
shop cuz thats

395
00:24:22,610 --> 00:24:25,510
turned on with this guy still sell its
like you might be interested in five

396
00:24:25,510 --> 00:24:26,370
herpes a

397
00:24:26,370 --> 00:24:29,720
interested in I ask sites or WebSphere

398
00:24:29,720 --> 00:24:33,789
who knows what but you got some
indicator what he wants to play with

399
00:24:33,789 --> 00:24:36,809
build a man a stack strongman and

400
00:24:36,809 --> 00:24:41,270
monitor everything he's doing the beauty
of Nova is the ability to

401
00:24:41,270 --> 00:24:44,529
not only prevent and detect but then

402
00:24:44,529 --> 00:24:48,210
even though it's basically an active
defense to it too will log out so if

403
00:24:48,210 --> 00:24:48,909
you're doing

404
00:24:48,909 --> 00:24:52,610
you know securities and event management
with some hugely expensive commercial

405
00:24:52,610 --> 00:24:54,029
platform you can send

406
00:24:54,029 --> 00:24:58,140
syslog doubt that platform as well I
devise real-time

407
00:24:58,140 --> 00:25:02,260
monitoring and alerting specific to this
anti reconnaissance activities

408
00:25:02,260 --> 00:25:07,460
to so in concert with your regular
defensive tactics it's pretty cool here

409
00:25:07,460 --> 00:25:11,039
again one of those bleachers

410
00:25:11,039 --> 00:25:14,419
sir carrier adversary with no they need
to find a stacks

411
00:25:14,419 --> 00:25:18,049
and you can immediately based on what
they claim is

412
00:25:18,049 --> 00:25:23,279
machine learning algorithms et cetera
begin to identify and profile

413
00:25:23,279 --> 00:25:27,260
I am your adversary it's running honey
bee and Ernie

414
00:25:27,260 --> 00:25:30,150
which you know if you know anything
about honey bee its cool it's a great

415
00:25:30,150 --> 00:25:31,330
long five minutes

416
00:25:31,330 --> 00:25:36,850
its they did so I'm imagining if they're
offering this is product they probably

417
00:25:36,850 --> 00:25:39,970
potentially made some changes the log
entries

418
00:25:39,970 --> 00:25:44,360
show clearly its ability to kill hi
attempted connections from

419
00:25:44,360 --> 00:25:47,890
that very same adversary we've been
talking about so 31 addresses

420
00:25:47,890 --> 00:25:52,159
is in essence being dropped which is
great

421
00:25:52,159 --> 00:25:57,169
but we want to hang profile traffic flag
it as a hostile event

422
00:25:57,169 --> 00:26:00,480
classify it and again at this point

423
00:26:00,480 --> 00:26:03,990
ultimately send it now in the well

424
00:26:03,990 --> 00:26:09,039
form to fully realize log format again
can be consumed by any number

425
00:26:09,039 --> 00:26:12,750
different logging and monitoring
resources so

426
00:26:12,750 --> 00:26:17,470
basically you identified you interrupted
and now you're able to even

427
00:26:17,470 --> 00:26:22,150
you know chillin counter in info contact

428
00:26:22,150 --> 00:26:25,789
but there are other options here too
wannabes I love

429
00:26:25,789 --> 00:26:29,870
I don't know how many you know if your
website administrator

430
00:26:29,870 --> 00:26:35,000
you're fully cognitive love how terribly
most

431
00:26:35,000 --> 00:26:40,720
crawlers actually ignore robot start
texting pounder side anyway

432
00:26:40,720 --> 00:26:44,900
some more scenarios when I'm a pen
tester and I'm

433
00:26:44,900 --> 00:26:48,679
sweeping through your in trying that's
looking for

434
00:26:48,679 --> 00:26:51,870
resources and compromising applications
cetera

435
00:26:51,870 --> 00:26:55,230
hot the first thing I do is ignore
robots attacks them

436
00:26:55,230 --> 00:27:00,309
you know ultimately look for what you're
trying to hide in that file so

437
00:27:00,309 --> 00:27:05,650
on that's a great opportunity though
somebody's crawling perspiring through

438
00:27:05,650 --> 00:27:07,000
networks away

439
00:27:07,000 --> 00:27:10,309
a few interesting pitfalls and that's
what spider trap

440
00:27:10,309 --> 00:27:14,000
again from not Ethan Rome Asha a Black
Hills

441
00:27:14,000 --> 00:27:18,090
to you sir to confound trawlers into
thinking maybe found something

442
00:27:18,090 --> 00:27:19,000
interesting

443
00:27:19,000 --> 00:27:22,110
and then just wrapping them in a
perpetual loop says fast as a

444
00:27:22,110 --> 00:27:26,090
aspiring hits that site it just wraps it
not just

445
00:27:26,090 --> 00:27:29,450
runs and runs and runs test this week
for perot just

446
00:27:29,450 --> 00:27:33,090
pointed it at a at Aspire trap

447
00:27:33,090 --> 00:27:37,850
instance and then just came back the
next morning there was just blindly in

448
00:27:37,850 --> 00:27:38,590
fact that it

449
00:27:38,590 --> 00:27:42,169
I had forgotten to use them memory
limiting

450
00:27:42,169 --> 00:27:47,960
up start up for ferber sought to consume
memory cuz its job earn it just sucked

451
00:27:47,960 --> 00:27:50,429
everything up and you know I'm no time
flat it was

452
00:27:50,429 --> 00:27:54,659
it was done all thanks to this little
scrap notes in this case it basically

453
00:27:54,659 --> 00:27:57,360
thinks hey I found at: password is a
must-have

454
00:27:57,360 --> 00:28:00,700
and successful some director commercial
lol

455
00:28:00,700 --> 00:28:05,500
you know and on and on and on it goes so
very cool from the perspective

456
00:28:05,500 --> 00:28:09,760
just causing absolute mayhem somebody's
Senate brown

457
00:28:09,760 --> 00:28:13,659
some the others again we talked about
artillery by Tom

458
00:28:13,659 --> 00:28:17,740
their traps open ports in in so doing

459
00:28:17,740 --> 00:28:21,000
takes the information and can
automatically blacklist

460
00:28:21,000 --> 00:28:25,350
de klerk's kinda cool because it's
basically a

461
00:28:25,350 --> 00:28:28,760
DNS server configuration that

462
00:28:28,760 --> 00:28:33,240
through a little JavaScript in a little
flash

463
00:28:33,240 --> 00:28:36,260
and its own DNS server I'm

464
00:28:36,260 --> 00:28:40,090
basically gets right past any attempt to
proxy or

465
00:28:40,090 --> 00:28:44,850
Hide IP zan and just causes them very
quickly in the logs

466
00:28:44,850 --> 00:28:49,899
and then honey badger uses no awesome
people like to share their location now

467
00:28:49,899 --> 00:28:52,649
is a feature in the web browser ninety
better will

468
00:28:52,649 --> 00:28:57,440
make your immediate use a bad and find
out who and where you actually are

469
00:28:57,440 --> 00:29:01,700
so ADHD has a lot of fun I was again
told

470
00:29:01,700 --> 00:29:04,960
not you know 30 minutes ago

471
00:29:04,960 --> 00:29:08,380
that a new releases Pending and should
be out pretty soon havin

472
00:29:08,380 --> 00:29:12,299
updated in awhile but the young man
who's developing ball and chain which

473
00:29:12,299 --> 00:29:13,450
summit you may have

474
00:29:13,450 --> 00:29:18,419
seen earlier I'm is now also the
maintainer for ADHD

475
00:29:18,419 --> 00:29:23,390
so pretty cool and I'm hopeful

476
00:29:23,390 --> 00:29:27,350
so that being said promised engine
through this

477
00:29:27,350 --> 00:29:31,570
we move on to beer so here we are
resources are in there again if you want

478
00:29:31,570 --> 00:29:32,260
the deck

479
00:29:32,260 --> 00:29:36,070
you find the sect immediate all
interesting no starch geyser over

480
00:29:36,070 --> 00:29:40,260
in there somewhere up

481
00:29:40,260 --> 00:29:44,500
and they have the practice of network
security monitoring highly recommended

482
00:29:44,500 --> 00:29:48,240
grab that book for sure if you want the
link to the deck

483
00:29:48,240 --> 00:29:51,610
I will give you cards here but beyond
that hi

484
00:29:51,610 --> 00:29:55,620
any questions before we depart for the
evening

485
00:29:55,620 --> 00:30:02,620
certain you

486
00:30:04,690 --> 00:30:08,049
performance right i mean you wanna
questions are you know what this tag a

487
00:30:08,049 --> 00:30:09,000
lot as

488
00:30:09,000 --> 00:30:13,360
I'm know what about software-defined
networking her huge scale networks

489
00:30:13,360 --> 00:30:17,110
use this is a principal guideline for
for the activity you may wish to dark

490
00:30:17,110 --> 00:30:19,130
but don't get narrow down are limited in

491
00:30:19,130 --> 00:30:23,179
easygoing tools and do it with you all
this with commercial tools

492
00:30:23,179 --> 00:30:28,679
right so you know VM's to get overloaded
you have to reset them

493
00:30:28,679 --> 00:30:31,990
Java Joe's your memory you know there's
all kinds of interesting

494
00:30:31,990 --> 00:30:36,750
issues I'm buttons you know small/medium
business networks

495
00:30:36,750 --> 00:30:40,090
this said a sensors works really well in
the activity is actually

496
00:30:40,090 --> 00:30:44,850
know completely viable does it you know
cloud scale as configured here probably

497
00:30:44,850 --> 00:30:47,000
not but there are other ways and means

498
00:30:47,000 --> 00:30:53,539
use

499
00:30:53,539 --> 00:30:57,289
collection flush click Refresh
absolutely yeah I mean that's

500
00:30:57,289 --> 00:31:02,710
you know 5 design depending on the
hostility of the activity

501
00:31:02,710 --> 00:31:06,230
insurer collecting endicott environment
you know

502
00:31:06,230 --> 00:31:09,460
the flush cycle might be as fast their
20 minutes

503
00:31:09,460 --> 00:31:13,010
and that is that is absolutely viable so
yes

504
00:31:13,010 --> 00:31:20,010
you that cool for

505
00:31:28,409 --> 00:31:33,230
as an option or you know drugs by
definition personal connection to

506
00:31:33,230 --> 00:31:36,899
I'm in essence attack network

507
00:31:36,899 --> 00:31:40,130
so a lot of times you know your shun
trafficking split it often and

508
00:31:40,130 --> 00:31:43,620
multi-port topping off to the side and
by definition you can

509
00:31:43,620 --> 00:31:48,000
establish connectivity directly to that
from universal next or real make sure

510
00:31:48,000 --> 00:31:50,049
you put a number of different host
machines

511
00:31:50,049 --> 00:31:54,830
to top iraq switching that allows direct
access back to the top

512
00:31:54,830 --> 00:31:59,409
there's his number never means but at
the simplest yes basic Coast

513
00:31:59,409 --> 00:32:02,549
networking as specific to the virtual
machines

514
00:32:02,549 --> 00:32:09,549
virtual switch can in essence be capped
off a monitor some oil

515
00:32:14,299 --> 00:32:19,710
legacy at out and that's an interesting
scenario

516
00:32:19,710 --> 00:32:23,740
probably opt out a second listener

517
00:32:23,740 --> 00:32:28,779
each sensor for in truck traffic

518
00:32:28,779 --> 00:32:32,010
yeah

519
00:32:32,010 --> 00:32:35,769
yep yeah it's the watching the watchers

520
00:32:35,769 --> 00:32:42,769
guy yeah your yessir

521
00:33:01,289 --> 00:33:04,649
I'd say not only you definitely want
someone X kills no question

522
00:33:04,649 --> 00:33:11,630
I'm

523
00:33:11,630 --> 00:33:15,179
well Bros inherent security onion right
so that the trick is read the

524
00:33:15,179 --> 00:33:16,350
documentation

525
00:33:16,350 --> 00:33:20,480
dogs Aug is in essence the documentation
is gonna make new

526
00:33:20,480 --> 00:33:24,450
it's amazing what that man as both
documented captured

527
00:33:24,450 --> 00:33:28,799
hot about his own product between that
and the fact that both those two books

528
00:33:28,799 --> 00:33:29,659
ever mention

529
00:33:29,659 --> 00:33:34,010
go to great lengths to help in fact the
practice and network security monitoring

530
00:33:34,010 --> 00:33:34,710
is

531
00:33:34,710 --> 00:33:38,159
is in essence written around security on
so

532
00:33:38,159 --> 00:33:42,360
janam ka peace security and get on that
book and get a couple days and that they

533
00:33:42,360 --> 00:33:43,100
will be

534
00:33:43,100 --> 00:33:49,110
quietly collecting physician properly I
really believe

535
00:33:49,110 --> 00:33:53,450
absolutely I've I've used it in
defensive engagements

536
00:33:53,450 --> 00:33:56,779
where I know the network's hostile and I
need to find the bad guy fast

537
00:33:56,779 --> 00:34:00,220
have been able to do that in the last
night

538
00:34:00,220 --> 00:34:03,940
so no question ya

539
00:34:03,940 --> 00:34:06,940
time for beer

540
00:34:06,940 --> 00:34:07,299
at all

