1
00:00:01,639 --> 00:00:08,910
<font color="#E5E5E5">we'll see how's everyone's derbycon</font>

2
00:00:04,290 --> 00:00:13,500
<font color="#E5E5E5">going so far</font><font color="#CCCCCC"> all right let's see why are</font>

3
00:00:08,910 --> 00:00:15,030
we all here<font color="#E5E5E5"> today</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> our talk sorry our</font>

4
00:00:13,500 --> 00:00:17,490
talk overview a few things we'll<font color="#CCCCCC"> be</font>

5
00:00:15,030 --> 00:00:21,150
covering<font color="#E5E5E5"> information about what's our</font>

6
00:00:17,490 --> 00:00:22,709
speakers<font color="#CCCCCC"> a couple background</font><font color="#E5E5E5"> points that</font>

7
00:00:21,150 --> 00:00:25,320
you might need<font color="#E5E5E5"> to know</font><font color="#CCCCCC"> through the</font>

8
00:00:22,710 --> 00:00:27,320
presentation<font color="#E5E5E5"> and a couple of frequently</font>

9
00:00:25,320 --> 00:00:29,460
<font color="#E5E5E5">used techniques and post exploitation</font>

10
00:00:27,320 --> 00:00:32,099
<font color="#CCCCCC">we're gonna kind of be going over the</font>

11
00:00:29,460 --> 00:00:34,790
past<font color="#E5E5E5"> the post exploitation and the</font>

12
00:00:32,098 --> 00:00:37,349
future where we<font color="#E5E5E5"> see it moving towards</font>

13
00:00:34,790 --> 00:00:38,550
<font color="#CCCCCC">we'll briefly</font><font color="#E5E5E5"> talk about implementing a</font>

14
00:00:37,350 --> 00:00:43,379
couple of these techniques in COBOL

15
00:00:38,550 --> 00:00:45,149
strikes and then conclude<font color="#E5E5E5"> who am i my</font>

16
00:00:43,379 --> 00:00:47,730
<font color="#CCCCCC">name</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> Michael Roberts I have a dog</font>

17
00:00:45,149 --> 00:00:49,920
named<font color="#CCCCCC"> wily coyote I go to the</font><font color="#E5E5E5"> University</font>

18
00:00:47,730 --> 00:00:54,569
of Central Florida<font color="#CCCCCC"> and I mostly do</font>

19
00:00:49,920 --> 00:00:56,550
windows security<font color="#E5E5E5"> hi my name is hi my</font>

20
00:00:54,570 --> 00:00:58,350
name is Martin Roberts I also<font color="#E5E5E5"> go the</font>

21
00:00:56,550 --> 00:01:04,319
University of<font color="#E5E5E5"> Central Florida and I</font>

22
00:00:58,350 --> 00:01:06,180
focus on Linux security will be just for

23
00:01:04,319 --> 00:01:07,529
our introduction<font color="#E5E5E5"> talking about some</font>

24
00:01:06,180 --> 00:01:09,570
competitions that we've done in the past

25
00:01:07,530 --> 00:01:12,840
<font color="#E5E5E5">these are all off them some competitions</font>

26
00:01:09,570 --> 00:01:15,210
if you're<font color="#E5E5E5"> aware</font><font color="#CCCCCC"> Fanaa</font><font color="#E5E5E5"> Polly</font><font color="#CCCCCC"> Monopoly at</font>

27
00:01:12,840 --> 00:01:18,270
<font color="#CCCCCC">CCDC</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> pranati a black</font><font color="#E5E5E5"> hat we won this</font>

28
00:01:15,210 --> 00:01:20,789
year and is CS and he said no there's

29
00:01:18,270 --> 00:01:23,789
some other offensive competitions<font color="#CCCCCC"> we'd</font>

30
00:01:20,790 --> 00:01:25,770
love to do competitions<font color="#CCCCCC"> and so it's</font><font color="#E5E5E5"> here</font>

31
00:01:23,790 --> 00:01:27,119
<font color="#E5E5E5">so I would like to start off with</font><font color="#CCCCCC"> giving</font>

32
00:01:25,770 --> 00:01:29,700
<font color="#E5E5E5">special thanks to some other people</font><font color="#CCCCCC"> that</font>

33
00:01:27,119 --> 00:01:32,460
we did this<font color="#CCCCCC"> research with first is</font>

34
00:01:29,700 --> 00:01:34,259
<font color="#E5E5E5">Jonathan</font><font color="#CCCCCC"> Chua</font><font color="#E5E5E5"> he worked</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> a said</font>

35
00:01:32,460 --> 00:01:37,679
x-force<font color="#E5E5E5"> read this summer where we</font>

36
00:01:34,259 --> 00:01:38,549
interned doing pen testing so we're

37
00:01:37,680 --> 00:01:40,680
gonna start<font color="#E5E5E5"> off giving some background</font>

38
00:01:38,549 --> 00:01:43,470
<font color="#CCCCCC">knowledge</font><font color="#E5E5E5"> first what is post</font>

39
00:01:40,680 --> 00:01:46,140
exploitation<font color="#CCCCCC"> basically we define it as</font>

40
00:01:43,470 --> 00:01:47,939
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> that happens after getting a</font>

41
00:01:46,140 --> 00:01:50,399
shell<font color="#E5E5E5"> so a couple questions that we have</font>

42
00:01:47,939 --> 00:01:52,320
to<font color="#CCCCCC"> ask how do you move across the</font>

43
00:01:50,399 --> 00:01:54,899
network<font color="#E5E5E5"> and how do you gather</font>

44
00:01:52,320 --> 00:01:57,179
<font color="#E5E5E5">information</font><font color="#CCCCCC"> on that</font><font color="#E5E5E5"> network that</font><font color="#CCCCCC"> you</font>

45
00:01:54,899 --> 00:01:59,009
<font color="#E5E5E5">just landed on we'd like to start off by</font>

46
00:01:57,180 --> 00:02:02,040
<font color="#CCCCCC">just</font><font color="#E5E5E5"> stating that credentials are really</font>

47
00:01:59,009 --> 00:02:03,299
important we believe that credentials

48
00:02:02,040 --> 00:02:06,060
are the most important thing you<font color="#E5E5E5"> can</font>

49
00:02:03,299 --> 00:02:09,420
gather during<font color="#E5E5E5"> this red team operation</font>

50
00:02:06,060 --> 00:02:11,310
<font color="#E5E5E5">with credentials</font><font color="#CCCCCC"> you have basically</font>

51
00:02:09,419 --> 00:02:14,069
persistence where you can<font color="#E5E5E5"> login</font><font color="#CCCCCC"> to</font>

52
00:02:11,310 --> 00:02:17,099
remote services SMB<font color="#CCCCCC"> associate</font>

53
00:02:14,069 --> 00:02:19,560
across the network so credentials are

54
00:02:17,099 --> 00:02:23,569
key<font color="#E5E5E5"> and we just want to point that out</font>

55
00:02:19,560 --> 00:02:26,250
that's a premise of our or talk<font color="#E5E5E5"> so</font>

56
00:02:23,569 --> 00:02:29,310
another necessary background<font color="#E5E5E5"> item is</font>

57
00:02:26,250 --> 00:02:32,400
what is<font color="#E5E5E5"> OPSEC so another just basic</font>

58
00:02:29,310 --> 00:02:34,489
definition<font color="#E5E5E5"> it's preventing you know what</font>

59
00:02:32,400 --> 00:02:37,340
you're doing<font color="#CCCCCC"> from getting flagged by</font>

60
00:02:34,489 --> 00:02:41,099
your enemy or in this<font color="#E5E5E5"> case the blue team</font>

61
00:02:37,340 --> 00:02:42,660
so as you all know red<font color="#E5E5E5"> team's trying to</font>

62
00:02:41,099 --> 00:02:45,599
not get<font color="#E5E5E5"> caught by blue team</font><font color="#CCCCCC"> we'll be</font>

63
00:02:42,660 --> 00:02:47,340
<font color="#E5E5E5">talking about it here so why is</font><font color="#CCCCCC"> postal</font>

64
00:02:45,599 --> 00:02:50,670
<font color="#E5E5E5">exploitation important why are you here</font>

65
00:02:47,340 --> 00:02:52,920
<font color="#E5E5E5">you know why should this matter</font><font color="#CCCCCC"> so you</font>

66
00:02:50,670 --> 00:02:55,260
spend weeks trying<font color="#CCCCCC"> to get a shell with</font>

67
00:02:52,920 --> 00:02:56,760
cobalt strike<font color="#E5E5E5"> or you spend</font><font color="#CCCCCC"> weeks trying</font>

68
00:02:55,260 --> 00:02:57,899
<font color="#CCCCCC">to</font><font color="#E5E5E5"> get a shell with</font><font color="#CCCCCC"> your fishing you</font>

69
00:02:56,760 --> 00:03:00,200
might use cobalt strike or other

70
00:02:57,900 --> 00:03:03,450
products to set up your infrastructure

71
00:03:00,200 --> 00:03:05,609
<font color="#CCCCCC">but you spend a lot</font><font color="#E5E5E5"> of time so when you</font>

72
00:03:03,450 --> 00:03:08,488
get a shell<font color="#CCCCCC"> you're you know really happy</font>

73
00:03:05,610 --> 00:03:10,980
<font color="#E5E5E5">I'm sure you all know</font><font color="#CCCCCC"> you want to keep</font>

74
00:03:08,489 --> 00:03:13,500
that harder in shell<font color="#CCCCCC"> and then second if</font>

75
00:03:10,980 --> 00:03:16,109
you do lose your shell<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's because</font>

76
00:03:13,500 --> 00:03:19,799
a a in point detection product getting

77
00:03:16,110 --> 00:03:21,720
flag flagging<font color="#E5E5E5"> your actions then the blue</font>

78
00:03:19,799 --> 00:03:25,709
team is one aware<font color="#E5E5E5"> of what you're doing</font>

79
00:03:21,720 --> 00:03:28,950
<font color="#CCCCCC">into watching you so the</font><font color="#E5E5E5"> next steps</font>

80
00:03:25,709 --> 00:03:30,239
<font color="#E5E5E5">might be to prevent the way that you got</font>

81
00:03:28,950 --> 00:03:32,638
in the<font color="#E5E5E5"> first time if</font><font color="#CCCCCC"> that makes sense</font>

82
00:03:30,239 --> 00:03:33,810
<font color="#CCCCCC">that you get</font><font color="#E5E5E5"> a shell the first time the</font>

83
00:03:32,639 --> 00:03:36,299
blue<font color="#E5E5E5"> team's gonna</font><font color="#CCCCCC"> be working on</font>

84
00:03:33,810 --> 00:03:38,160
<font color="#E5E5E5">preventing the</font><font color="#CCCCCC"> way you got</font><font color="#E5E5E5"> the shell and</font>

85
00:03:36,299 --> 00:03:40,019
then also watching your actions<font color="#E5E5E5"> across</font>

86
00:03:38,160 --> 00:03:42,090
the network<font color="#E5E5E5"> and</font><font color="#CCCCCC"> just generally they're</font>

87
00:03:40,019 --> 00:03:43,470
going to be<font color="#E5E5E5"> more suspicious</font><font color="#CCCCCC"> so you do</font>

88
00:03:42,090 --> 00:03:45,420
not<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to get flagged by</font><font color="#E5E5E5"> the red team</font>

89
00:03:43,470 --> 00:03:48,540
or by the blue team<font color="#CCCCCC"> when you're</font>

90
00:03:45,420 --> 00:03:50,250
<font color="#E5E5E5">performing</font><font color="#CCCCCC"> a red team operations and</font>

91
00:03:48,540 --> 00:03:53,790
<font color="#E5E5E5">Michael's</font><font color="#CCCCCC"> gonna talk about frequently</font>

92
00:03:50,250 --> 00:03:55,319
<font color="#E5E5E5">used techniques code execution which you</font>

93
00:03:53,790 --> 00:03:58,739
might<font color="#E5E5E5"> be most familiar with of course</font>

94
00:03:55,319 --> 00:04:01,440
PowerShell<font color="#E5E5E5"> just code execution through</font>

95
00:03:58,739 --> 00:04:03,900
<font color="#E5E5E5">command prompt and million different old</font>

96
00:04:01,440 --> 00:04:05,420
ways of<font color="#E5E5E5"> doing command execution that</font>

97
00:04:03,900 --> 00:04:09,060
have been around forever

98
00:04:05,420 --> 00:04:11,940
getting your executable through<font color="#CCCCCC"> IEX or</font>

99
00:04:09,060 --> 00:04:14,639
bits admin or just copying it over<font color="#CCCCCC"> SMB</font>

100
00:04:11,940 --> 00:04:17,039
or<font color="#E5E5E5"> something like that</font><font color="#CCCCCC"> older methods</font>

101
00:04:14,639 --> 00:04:19,349
that are very likely to<font color="#CCCCCC"> get caught by</font>

102
00:04:17,039 --> 00:04:24,320
<font color="#E5E5E5">endpoint detection response solutions</font>

103
00:04:19,349 --> 00:04:27,180
<font color="#E5E5E5">and any mature blue team organization</font>

104
00:04:24,320 --> 00:04:27,810
<font color="#CCCCCC">lateral movement</font><font color="#E5E5E5"> obviously passed the</font>

105
00:04:27,180 --> 00:04:30,600
hash

106
00:04:27,810 --> 00:04:33,690
in a<font color="#E5E5E5"> suspicious way we'll get caught</font><font color="#CCCCCC"> a</font>

107
00:04:30,600 --> 00:04:35,700
lot<font color="#E5E5E5"> of times remote</font><font color="#CCCCCC"> PowerShell and PS</font>

108
00:04:33,690 --> 00:04:39,000
exact<font color="#CCCCCC"> buy a secure organization will get</font>

109
00:04:35,700 --> 00:04:42,560
caught<font color="#CCCCCC"> and then later on we're going to</font>

110
00:04:39,000 --> 00:04:45,690
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to improve upon these and</font>

111
00:04:42,560 --> 00:04:47,640
<font color="#E5E5E5">new solutions in the industry so you</font>

112
00:04:45,690 --> 00:04:51,710
don't have<font color="#E5E5E5"> to use win RM and remote</font>

113
00:04:47,640 --> 00:04:54,840
<font color="#E5E5E5">powershell</font><font color="#CCCCCC"> for stuff persistence</font>

114
00:04:51,710 --> 00:04:57,780
writing a motion<font color="#CCCCCC"> CXC to disk</font><font color="#E5E5E5"> and</font>

115
00:04:54,840 --> 00:05:00,690
including<font color="#E5E5E5"> getting a</font><font color="#CCCCCC"> startup</font><font color="#E5E5E5"> folder or an</font>

116
00:04:57,780 --> 00:05:02,729
obvious registry key<font color="#E5E5E5"> or even a</font><font color="#CCCCCC"> scheduled</font>

117
00:05:00,690 --> 00:05:04,650
tasks it's<font color="#E5E5E5"> going to get flagged by an</font>

118
00:05:02,730 --> 00:05:07,320
<font color="#E5E5E5">endpoint endpoint detection response at</font>

119
00:05:04,650 --> 00:05:10,530
least like CrowdStrike<font color="#CCCCCC"> Falcon and</font>

120
00:05:07,320 --> 00:05:14,400
<font color="#CCCCCC">Microsoft</font><font color="#E5E5E5"> ata will flag</font><font color="#CCCCCC"> all of these</font>

121
00:05:10,530 --> 00:05:17,640
<font color="#E5E5E5">especially the last three so these kind</font>

122
00:05:14,400 --> 00:05:22,460
of techniques<font color="#CCCCCC"> that obviously can't</font><font color="#E5E5E5"> be</font>

123
00:05:17,640 --> 00:05:24,630
used anymore<font color="#CCCCCC"> a few critical</font><font color="#E5E5E5"> flaws so</font>

124
00:05:22,460 --> 00:05:26,370
<font color="#E5E5E5">basically a critical flaw is something</font>

125
00:05:24,630 --> 00:05:28,020
that's just going<font color="#E5E5E5"> to get flagged by in</font>

126
00:05:26,370 --> 00:05:29,700
point detection some of the time most of

127
00:05:28,020 --> 00:05:32,190
<font color="#CCCCCC">the time</font><font color="#E5E5E5"> or all the time</font>

128
00:05:29,700 --> 00:05:34,979
so leaving suspicious logs<font color="#CCCCCC"> behind is the</font>

129
00:05:32,190 --> 00:05:37,350
first item<font color="#E5E5E5"> we'll be talking about just</font>

130
00:05:34,980 --> 00:05:40,140
<font color="#CCCCCC">basic things that</font><font color="#E5E5E5"> leave you know logs</font>

131
00:05:37,350 --> 00:05:44,280
behind login attempts<font color="#CCCCCC"> you want to watch</font>

132
00:05:40,140 --> 00:05:46,020
your<font color="#CCCCCC"> login time if you know the user is</font>

133
00:05:44,280 --> 00:05:48,690
9:00 to 5:00 Eastern or something and

134
00:05:46,020 --> 00:05:51,960
you are<font color="#CCCCCC"> logging in at I</font><font color="#E5E5E5"> don't know</font>

135
00:05:48,690 --> 00:05:54,900
<font color="#E5E5E5">running</font><font color="#CCCCCC"> Antilia you know every day that</font>

136
00:05:51,960 --> 00:05:57,270
<font color="#CCCCCC">could be suspicious</font><font color="#E5E5E5"> if the user hasn't</font>

137
00:05:54,900 --> 00:05:59,940
<font color="#E5E5E5">previously logged in at this weird times</font>

138
00:05:57,270 --> 00:06:03,560
so just watch<font color="#CCCCCC"> login time</font><font color="#E5E5E5"> something basic</font>

139
00:05:59,940 --> 00:06:08,640
<font color="#CCCCCC">sudo attempts for you know the Linux</font>

140
00:06:03,560 --> 00:06:11,070
UNIX systems<font color="#E5E5E5"> sudo attempts will be</font>

141
00:06:08,640 --> 00:06:12,719
logged and then<font color="#E5E5E5"> if someone could be</font>

142
00:06:11,070 --> 00:06:14,760
<font color="#CCCCCC">checking that out if they're watching</font>

143
00:06:12,720 --> 00:06:17,610
logs if it's a<font color="#CCCCCC"> mature organization and</font>

144
00:06:14,760 --> 00:06:19,560
then creating users something that I

145
00:06:17,610 --> 00:06:21,180
hope most people<font color="#CCCCCC"> don't do why some</font>

146
00:06:19,560 --> 00:06:24,240
people<font color="#CCCCCC"> feel necessary to create</font><font color="#E5E5E5"> a user</font>

147
00:06:21,180 --> 00:06:26,700
that's heavily logged<font color="#E5E5E5"> the company is</font>

148
00:06:24,240 --> 00:06:28,320
<font color="#E5E5E5">going to</font><font color="#CCCCCC"> be you</font><font color="#E5E5E5"> know asking</font><font color="#CCCCCC"> did we get a</font>

149
00:06:26,700 --> 00:06:31,289
<font color="#E5E5E5">new employee recently why are we</font>

150
00:06:28,320 --> 00:06:32,419
creating a new user<font color="#E5E5E5"> so you should be</font>

151
00:06:31,290 --> 00:06:34,460
asking<font color="#E5E5E5"> the question is this necessary</font>

152
00:06:32,419 --> 00:06:37,799
<font color="#E5E5E5">for your needs</font>

153
00:06:34,460 --> 00:06:39,729
excessive disk writes do you need to be

154
00:06:37,800 --> 00:06:41,819
<font color="#E5E5E5">writing</font><font color="#CCCCCC"> to disk and</font>

155
00:06:39,729 --> 00:06:44,830
can you be running<font color="#E5E5E5"> it in memory</font><font color="#CCCCCC"> a</font>

156
00:06:41,819 --> 00:06:47,680
classic<font color="#CCCCCC"> example of this just some Linux</font>

157
00:06:44,830 --> 00:06:51,669
<font color="#E5E5E5">would be curling something down say</font>

158
00:06:47,680 --> 00:06:53,379
Linux probe s script so curl<font color="#CCCCCC"> you know</font>

159
00:06:51,669 --> 00:06:56,139
the script<font color="#E5E5E5"> and then instead of</font><font color="#CCCCCC"> writing</font>

160
00:06:53,379 --> 00:06:57,819
it to disk<font color="#E5E5E5"> with like the - go flag you</font>

161
00:06:56,139 --> 00:07:01,300
can<font color="#CCCCCC"> just pipe it</font><font color="#E5E5E5"> to bash</font><font color="#CCCCCC"> it will run in</font>

162
00:06:57,819 --> 00:07:03,909
<font color="#E5E5E5">memory as a process and it won't write</font>

163
00:07:01,300 --> 00:07:05,319
to disk<font color="#CCCCCC"> so just things to</font><font color="#E5E5E5"> remember how</font>

164
00:07:03,909 --> 00:07:07,150
<font color="#E5E5E5">can I be running things in</font><font color="#CCCCCC"> memory</font>

165
00:07:05,319 --> 00:07:10,180
instead<font color="#E5E5E5"> of writing to disk whenever</font>

166
00:07:07,150 --> 00:07:11,620
possible<font color="#CCCCCC"> and is the EDR scanning this</font>

167
00:07:10,180 --> 00:07:15,099
location this<font color="#CCCCCC"> is something we'll cover</font>

168
00:07:11,620 --> 00:07:17,379
here<font color="#CCCCCC"> we'll cover later unusual</font>

169
00:07:15,099 --> 00:07:19,960
PowerShell commands<font color="#E5E5E5"> do you need to run</font>

170
00:07:17,379 --> 00:07:22,539
the<font color="#E5E5E5"> command that you're running we have</font>

171
00:07:19,960 --> 00:07:26,229
an example<font color="#E5E5E5"> here</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> dig command will</font>

172
00:07:22,539 --> 00:07:29,199
return a list<font color="#E5E5E5"> of domain controllers</font><font color="#CCCCCC"> in</font>

173
00:07:26,229 --> 00:07:31,930
the environment this dick command can be

174
00:07:29,199 --> 00:07:33,669
<font color="#CCCCCC">ran</font><font color="#E5E5E5"> you know from like Linux UNIX hosts</font>

175
00:07:31,930 --> 00:07:37,240
that you've acquired instead of having

176
00:07:33,669 --> 00:07:39,698
to run a similar<font color="#E5E5E5"> command in PowerShell</font>

177
00:07:37,240 --> 00:07:42,279
so if you can't avoid PowerShell just

178
00:07:39,699 --> 00:07:44,229
because of PowerShell<font color="#E5E5E5"> version 5 logging</font>

179
00:07:42,279 --> 00:07:46,599
look for other ways<font color="#CCCCCC"> to do it</font>

180
00:07:44,229 --> 00:07:51,878
Linux OS<font color="#CCCCCC"> UNIX hosts that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> on that</font>

181
00:07:46,599 --> 00:07:53,469
<font color="#CCCCCC">network</font><font color="#E5E5E5"> and detection by EDR obviously</font>

182
00:07:51,879 --> 00:07:55,629
you<font color="#E5E5E5"> want to avoid</font><font color="#CCCCCC"> getting detected by</font>

183
00:07:53,469 --> 00:07:57,219
EDR on some of the reasons<font color="#CCCCCC"> we</font><font color="#E5E5E5"> mentioned</font>

184
00:07:55,629 --> 00:07:59,469
earlier we're at the blue<font color="#E5E5E5"> team's</font>

185
00:07:57,219 --> 00:08:01,330
watching you<font color="#E5E5E5"> you know your life's gonna</font>

186
00:07:59,469 --> 00:08:02,520
<font color="#CCCCCC">be a lot harder</font><font color="#E5E5E5"> you're not gonna be</font><font color="#CCCCCC"> able</font>

187
00:08:01,330 --> 00:08:06,490
<font color="#E5E5E5">to gather the</font><font color="#CCCCCC"> information that you need</font>

188
00:08:02,520 --> 00:08:09,609
<font color="#E5E5E5">so if you're you know outside of normal</font>

189
00:08:06,490 --> 00:08:11,649
user behavior<font color="#E5E5E5"> if you're just</font><font color="#CCCCCC"> trying a</font>

190
00:08:09,610 --> 00:08:14,439
<font color="#E5E5E5">bunch of creds against the domain</font>

191
00:08:11,649 --> 00:08:17,110
controller<font color="#CCCCCC"> or just doing</font><font color="#E5E5E5"> really noisy</font>

192
00:08:14,439 --> 00:08:19,870
stuff you could just be flagged by<font color="#CCCCCC"> the</font>

193
00:08:17,110 --> 00:08:22,979
blue team so if you're writing<font color="#E5E5E5"> to disk</font>

194
00:08:19,870 --> 00:08:25,870
<font color="#CCCCCC">you could be flagged by</font><font color="#E5E5E5"> like EDR if the</font>

195
00:08:22,979 --> 00:08:29,399
you<font color="#E5E5E5"> know common tools have signatures</font>

196
00:08:25,870 --> 00:08:32,380
with that idea product<font color="#E5E5E5"> so things to note</font>

197
00:08:29,399 --> 00:08:35,169
<font color="#CCCCCC">just basic things that you should keep</font>

198
00:08:32,380 --> 00:08:38,019
in<font color="#CCCCCC"> mind during an engagement you want to</font>

199
00:08:35,169 --> 00:08:41,439
<font color="#E5E5E5">follow normal user behavior you want to</font>

200
00:08:38,019 --> 00:08:44,649
use some of<font color="#CCCCCC"> these services</font><font color="#E5E5E5"> SSH</font>

201
00:08:41,440 --> 00:08:47,350
NFS<font color="#CCCCCC"> is</font><font color="#E5E5E5"> somewhere a favor I like</font><font color="#CCCCCC"> RDP S&B</font>

202
00:08:44,649 --> 00:08:49,990
those services are<font color="#E5E5E5"> widely</font><font color="#CCCCCC"> used across</font>

203
00:08:47,350 --> 00:08:52,240
<font color="#E5E5E5">the corporate network and even</font><font color="#CCCCCC"> better</font>

204
00:08:49,990 --> 00:08:52,940
they're going<font color="#CCCCCC"> to use most</font><font color="#E5E5E5"> of the time</font>

205
00:08:52,240 --> 00:08:55,340
user

206
00:08:52,940 --> 00:08:58,340
potentials that are<font color="#E5E5E5"> just similar across</font>

207
00:08:55,340 --> 00:09:00,800
all of the<font color="#CCCCCC"> hosts so if you're able to</font>

208
00:08:58,340 --> 00:09:03,650
acquire user credentials<font color="#E5E5E5"> from say a</font>

209
00:09:00,800 --> 00:09:05,420
Windows host and you can use those to

210
00:09:03,650 --> 00:09:08,390
<font color="#CCCCCC">log into</font><font color="#E5E5E5"> like critical infrastructure</font>

211
00:09:05,420 --> 00:09:11,209
with SSH<font color="#CCCCCC"> or access critical</font><font color="#E5E5E5"> files with</font>

212
00:09:08,390 --> 00:09:13,040
SMB<font color="#E5E5E5"> so user credentials are key during</font>

213
00:09:11,210 --> 00:09:14,690
<font color="#E5E5E5">post exploitation</font><font color="#CCCCCC"> you want to gather</font>

214
00:09:13,040 --> 00:09:17,920
those whenever<font color="#E5E5E5"> possible</font>

215
00:09:14,690 --> 00:09:20,660
private<font color="#E5E5E5"> keys are obviously useful</font>

216
00:09:17,920 --> 00:09:23,930
<font color="#CCCCCC">assuming they have a</font><font color="#E5E5E5"> weak or no</font>

217
00:09:20,660 --> 00:09:25,339
passphrase on them you can<font color="#E5E5E5"> use private</font>

218
00:09:23,930 --> 00:09:27,530
keys to<font color="#CCCCCC"> login to like</font><font color="#E5E5E5"> critical</font>

219
00:09:25,340 --> 00:09:29,360
infrastructure<font color="#E5E5E5"> so those are just some</font>

220
00:09:27,530 --> 00:09:32,390
important things together<font color="#E5E5E5"> during an</font>

221
00:09:29,360 --> 00:09:34,610
<font color="#CCCCCC">engagement</font><font color="#E5E5E5"> and then for like all the Mac</font>

222
00:09:32,390 --> 00:09:37,370
users out there<font color="#E5E5E5"> I'm sure most of you</font>

223
00:09:34,610 --> 00:09:41,180
have<font color="#E5E5E5"> you know your user in the pseudo</font>

224
00:09:37,370 --> 00:09:44,690
group which is necessary for just a lot

225
00:09:41,180 --> 00:09:46,250
of your roles every<font color="#E5E5E5"> day but being in the</font>

226
00:09:44,690 --> 00:09:50,420
pseudo group the attacker can grab

227
00:09:46,250 --> 00:09:52,730
things like the<font color="#E5E5E5"> keychain with your user</font>

228
00:09:50,420 --> 00:09:54,589
<font color="#CCCCCC">passwords so after they unlock your</font>

229
00:09:52,730 --> 00:09:56,780
<font color="#E5E5E5">keychain</font><font color="#CCCCCC"> you know they have</font><font color="#E5E5E5"> access to</font>

230
00:09:54,590 --> 00:09:59,660
<font color="#CCCCCC">things like</font><font color="#E5E5E5"> CrowdStrike</font><font color="#CCCCCC"> falcon if you're</font>

231
00:09:56,780 --> 00:10:01,670
<font color="#E5E5E5">storing that your keychain yeah just a</font>

232
00:09:59,660 --> 00:10:02,540
bunch<font color="#E5E5E5"> of things could be storing your</font>

233
00:10:01,670 --> 00:10:05,060
<font color="#CCCCCC">keychain and</font><font color="#E5E5E5"> they can use those</font>

234
00:10:02,540 --> 00:10:08,660
credentials to just log<font color="#E5E5E5"> into other</font>

235
00:10:05,060 --> 00:10:10,430
services<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> critical so yeah you</font>

236
00:10:08,660 --> 00:10:12,319
want<font color="#CCCCCC"> to look</font><font color="#E5E5E5"> for if you're</font><font color="#CCCCCC"> a red team or</font>

237
00:10:10,430 --> 00:10:16,000
you want to look<font color="#E5E5E5"> for just pseudo proofs</font>

238
00:10:12,320 --> 00:10:19,670
<font color="#E5E5E5">on Mac OS or you know a similar system</font>

239
00:10:16,000 --> 00:10:23,180
and then the looking<font color="#CCCCCC"> around the network</font>

240
00:10:19,670 --> 00:10:25,880
<font color="#CCCCCC">Pelin my favorite thing so</font><font color="#E5E5E5"> just an</font>

241
00:10:23,180 --> 00:10:28,849
example<font color="#CCCCCC"> this week</font><font color="#E5E5E5"> I was on an engagement</font>

242
00:10:25,880 --> 00:10:31,130
<font color="#E5E5E5">and I was just looking around the</font>

243
00:10:28,850 --> 00:10:32,690
<font color="#E5E5E5">network and I noticed that I was looking</font>

244
00:10:31,130 --> 00:10:34,520
at all the<font color="#CCCCCC"> SSH banners and that a</font>

245
00:10:32,690 --> 00:10:35,110
corporate<font color="#E5E5E5"> network</font><font color="#CCCCCC"> the first time I saw</font>

246
00:10:34,520 --> 00:10:37,579
it

247
00:10:35,110 --> 00:10:40,339
looking at SSH banners<font color="#E5E5E5"> seeing you know</font>

248
00:10:37,580 --> 00:10:41,839
what products are<font color="#E5E5E5"> out there it's seeing</font>

249
00:10:40,339 --> 00:10:44,390
like<font color="#CCCCCC"> the version</font><font color="#E5E5E5"> numbers and stuff like</font>

250
00:10:41,839 --> 00:10:46,610
that of SSH and I noticed there was some

251
00:10:44,390 --> 00:10:47,839
black raspberry<font color="#CCCCCC"> PI's on the network you</font>

252
00:10:46,610 --> 00:10:49,820
guys might be questioning your<font color="#CCCCCC"> why's</font>

253
00:10:47,839 --> 00:10:52,280
<font color="#E5E5E5">raspberry PI's on a mature corporate</font>

254
00:10:49,820 --> 00:10:53,230
network the answer is actually simpler

255
00:10:52,280 --> 00:10:56,390
than<font color="#CCCCCC"> you think</font>

256
00:10:53,230 --> 00:10:57,080
signage sometimes<font color="#CCCCCC"> will be running</font><font color="#E5E5E5"> off a</font>

257
00:10:56,390 --> 00:11:00,920
<font color="#CCCCCC">Raspberry Pi</font>

258
00:10:57,080 --> 00:11:04,310
or in this<font color="#E5E5E5"> case a 3d printer was managed</font>

259
00:11:00,920 --> 00:11:06,180
by<font color="#E5E5E5"> Raspberry Pi</font><font color="#CCCCCC"> so the the key isn't to</font>

260
00:11:04,310 --> 00:11:09,719
look for raspberry<font color="#E5E5E5"> PI's the key is to</font>

261
00:11:06,180 --> 00:11:11,520
look for<font color="#CCCCCC"> hosts on the network that</font><font color="#E5E5E5"> you</font>

262
00:11:09,720 --> 00:11:16,350
know might not<font color="#E5E5E5"> be in the classic realm</font>

263
00:11:11,520 --> 00:11:18,060
of their<font color="#E5E5E5"> end point detection so devices</font>

264
00:11:16,350 --> 00:11:20,690
like<font color="#E5E5E5"> the</font><font color="#CCCCCC"> red wires</font><font color="#E5E5E5"> something similar</font>

265
00:11:18,060 --> 00:11:23,279
that<font color="#CCCCCC"> we'll talk</font><font color="#E5E5E5"> about in the next slide</font>

266
00:11:20,690 --> 00:11:25,649
<font color="#CCCCCC">those devices</font><font color="#E5E5E5"> are almost certainly not</font>

267
00:11:23,279 --> 00:11:27,540
monitored<font color="#E5E5E5"> you know by endpoint detection</font>

268
00:11:25,649 --> 00:11:31,470
so if you're able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> launch all your</font>

269
00:11:27,540 --> 00:11:34,649
attacks by you know<font color="#E5E5E5"> that host</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

270
00:11:31,470 --> 00:11:36,630
evade a lot of detection<font color="#E5E5E5"> and you just</font>

271
00:11:34,649 --> 00:11:38,430
want to<font color="#E5E5E5"> live on those devices because</font>

272
00:11:36,630 --> 00:11:41,700
they<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> have you know</font><font color="#E5E5E5"> any logging</font>

273
00:11:38,430 --> 00:11:44,099
probably and we talked about earlier

274
00:11:41,700 --> 00:11:49,070
credentials and keys<font color="#E5E5E5"> are helpful</font><font color="#CCCCCC"> on to</font>

275
00:11:44,100 --> 00:11:52,020
get into those<font color="#CCCCCC"> boxes</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> just something</font>

276
00:11:49,070 --> 00:11:55,830
<font color="#CCCCCC">another</font><font color="#E5E5E5"> example looking around that</font>

277
00:11:52,020 --> 00:11:58,589
<font color="#CCCCCC">network I saw that like NFS was open and</font>

278
00:11:55,830 --> 00:12:00,420
I'm sure most of you thinking great

279
00:11:58,589 --> 00:12:05,370
there's probably something great<font color="#CCCCCC"> on that</font>

280
00:12:00,420 --> 00:12:07,860
share but it has another use<font color="#E5E5E5"> so I saw</font>

281
00:12:05,370 --> 00:12:09,600
NFS was open and<font color="#E5E5E5"> then I'm just looking</font>

282
00:12:07,860 --> 00:12:12,270
at the<font color="#E5E5E5"> end map there</font><font color="#CCCCCC"> was you know port</font>

283
00:12:09,600 --> 00:12:14,520
80 and<font color="#E5E5E5"> 443 open I'm sure you can</font><font color="#CCCCCC"> imagine</font>

284
00:12:12,270 --> 00:12:16,880
where this is going<font color="#CCCCCC"> I check out</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> web</font>

285
00:12:14,520 --> 00:12:21,300
portal you know see what's there and

286
00:12:16,880 --> 00:12:23,520
<font color="#CCCCCC">user name password is admin admin so we</font>

287
00:12:21,300 --> 00:12:26,430
have you<font color="#E5E5E5"> know that storage controller</font>

288
00:12:23,520 --> 00:12:27,810
<font color="#E5E5E5">and that's great to see</font><font color="#CCCCCC"> the files but it</font>

289
00:12:26,430 --> 00:12:29,939
actually has another use that we want to

290
00:12:27,810 --> 00:12:33,300
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about if you're on just say a</font>

291
00:12:29,940 --> 00:12:36,080
compromised Linux host<font color="#E5E5E5"> and you want to</font>

292
00:12:33,300 --> 00:12:37,890
avoid<font color="#E5E5E5"> writing to disk on that host</font>

293
00:12:36,080 --> 00:12:40,110
because you're<font color="#E5E5E5"> afraid it could be</font>

294
00:12:37,890 --> 00:12:43,050
monitored<font color="#CCCCCC"> people could</font><font color="#E5E5E5"> be looking at it</font>

295
00:12:40,110 --> 00:12:46,950
why not mount an NFS<font color="#CCCCCC"> here and write to</font>

296
00:12:43,050 --> 00:12:48,979
that<font color="#E5E5E5"> it's if you're you know</font><font color="#CCCCCC"> write</font><font color="#E5E5E5"> to it</font>

297
00:12:46,950 --> 00:12:51,089
and then access<font color="#E5E5E5"> it</font><font color="#CCCCCC"> from that Linux host</font>

298
00:12:48,980 --> 00:12:54,480
<font color="#CCCCCC">there it's very unlikely that they're</font>

299
00:12:51,089 --> 00:12:56,600
monitoring new NFS shares<font color="#E5E5E5"> but the</font><font color="#CCCCCC"> import</font>

300
00:12:54,480 --> 00:12:59,730
<font color="#E5E5E5">detection services that we've looked at</font>

301
00:12:56,600 --> 00:13:02,610
<font color="#E5E5E5">they if they do monitor new and</font><font color="#CCCCCC"> fs</font>

302
00:12:59,730 --> 00:13:05,310
<font color="#CCCCCC">mounts they don't block that</font><font color="#E5E5E5"> out those</font>

303
00:13:02,610 --> 00:13:07,950
actions<font color="#E5E5E5"> they just like flag gate and</font>

304
00:13:05,310 --> 00:13:10,290
then<font color="#CCCCCC"> a user hasta</font><font color="#E5E5E5"> intervene</font><font color="#CCCCCC"> which we</font>

305
00:13:07,950 --> 00:13:11,820
<font color="#CCCCCC">almost you know slow and they're not</font>

306
00:13:10,290 --> 00:13:13,800
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> you know catch you right away so</font>

307
00:13:11,820 --> 00:13:17,010
<font color="#E5E5E5">you</font><font color="#CCCCCC"> have at least a</font><font color="#E5E5E5"> couple minutes hours</font>

308
00:13:13,800 --> 00:13:20,660
to do things on that<font color="#E5E5E5"> host</font><font color="#CCCCCC"> michael</font><font color="#E5E5E5"> will</font>

309
00:13:17,010 --> 00:13:20,660
<font color="#E5E5E5">be talking about improving techniques</font>

310
00:13:20,899 --> 00:13:27,029
<font color="#CCCCCC">let's start with code execution every</font>

311
00:13:24,480 --> 00:13:29,459
<font color="#E5E5E5">day</font><font color="#CCCCCC"> seems like</font><font color="#E5E5E5"> on Twitter there's a new</font>

312
00:13:27,029 --> 00:13:32,250
method<font color="#CCCCCC"> of code execution</font><font color="#E5E5E5"> that can get to</font>

313
00:13:29,459 --> 00:13:36,258
get sorry<font color="#E5E5E5"> that can get around Windows</font>

314
00:13:32,250 --> 00:13:38,720
Defender<font color="#E5E5E5"> or another</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> point solution</font>

315
00:13:36,259 --> 00:13:41,639
<font color="#E5E5E5">power picks been around for a while</font>

316
00:13:38,720 --> 00:13:43,680
<font color="#CCCCCC">there's plenty of solutions</font><font color="#E5E5E5"> for running</font>

317
00:13:41,639 --> 00:13:46,639
completely<font color="#E5E5E5"> a memory avoiding writing to</font>

318
00:13:43,680 --> 00:13:50,189
disk<font color="#E5E5E5"> which we talked about earlier and</font>

319
00:13:46,639 --> 00:13:51,569
overall just<font color="#CCCCCC"> not getting caught by EDR</font>

320
00:13:50,190 --> 00:13:54,990
solutions obviously parent process

321
00:13:51,569 --> 00:13:58,170
spoofing and<font color="#E5E5E5"> we're seeing a trend of</font>

322
00:13:54,990 --> 00:14:00,690
using<font color="#E5E5E5"> more c-sharp executables and stuff</font>

323
00:13:58,170 --> 00:14:03,540
<font color="#E5E5E5">like that like ghost pack and stuff</font>

324
00:14:00,690 --> 00:14:05,130
written<font color="#E5E5E5"> entirely in</font><font color="#CCCCCC"> c-sharp</font><font color="#E5E5E5"> that you can</font>

325
00:14:03,540 --> 00:14:08,759
compile<font color="#CCCCCC"> it yourself let's have a</font>

326
00:14:05,130 --> 00:14:11,310
<font color="#E5E5E5">different signature</font><font color="#CCCCCC"> so there's plenty</font><font color="#E5E5E5"> of</font>

327
00:14:08,759 --> 00:14:13,620
new techniques<font color="#CCCCCC"> for still</font><font color="#E5E5E5"> doing code</font>

328
00:14:11,310 --> 00:14:16,189
execution<font color="#CCCCCC"> and not using the old methods</font>

329
00:14:13,620 --> 00:14:19,740
of<font color="#E5E5E5"> PowerShell and stuff like that</font>

330
00:14:16,190 --> 00:14:23,550
<font color="#CCCCCC">lateral</font><font color="#E5E5E5"> movement let's see sharp</font><font color="#CCCCCC"> WMI I</font>

331
00:14:19,740 --> 00:14:25,980
mentioned<font color="#CCCCCC"> goes</font><font color="#E5E5E5"> back earlier</font><font color="#CCCCCC"> destroyed</font><font color="#E5E5E5"> we</font>

332
00:14:23,550 --> 00:14:29,430
<font color="#CCCCCC">call objects is another new technique</font>

333
00:14:25,980 --> 00:14:33,420
there's tons of new techniques<font color="#E5E5E5"> coming</font>

334
00:14:29,430 --> 00:14:36,689
out everyday<font color="#E5E5E5"> that don't involve old</font>

335
00:14:33,420 --> 00:14:38,089
<font color="#E5E5E5">bottle movement methods like win RM and</font>

336
00:14:36,689 --> 00:14:41,819
stuff that's<font color="#E5E5E5"> gonna get flagged</font>

337
00:14:38,089 --> 00:14:46,160
<font color="#E5E5E5">immediately obviously private</font><font color="#CCCCCC"> keys on a</font>

338
00:14:41,819 --> 00:14:48,959
UNIX environment for a lot<font color="#E5E5E5"> of movement</font>

339
00:14:46,160 --> 00:14:51,449
persistence<font color="#CCCCCC"> file this</font><font color="#E5E5E5"> back door so</font>

340
00:14:48,959 --> 00:14:54,869
storing completely in registry or

341
00:14:51,449 --> 00:14:57,060
another part of<font color="#E5E5E5"> the system</font><font color="#CCCCCC"> so it doesn't</font>

342
00:14:54,870 --> 00:14:59,819
write to disk obviously antivirus

343
00:14:57,060 --> 00:15:02,699
solutions immediately scan<font color="#E5E5E5"> everything in</font>

344
00:14:59,819 --> 00:15:05,279
<font color="#E5E5E5">disk and any other</font><font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> detection</font>

345
00:15:02,699 --> 00:15:08,189
will immediately catch something I've

346
00:15:05,279 --> 00:15:10,649
written to disk<font color="#E5E5E5"> so as file</font><font color="#CCCCCC"> lists as</font><font color="#E5E5E5"> you</font>

347
00:15:08,189 --> 00:15:12,870
can go credentials<font color="#CCCCCC"> martin briefly</font>

348
00:15:10,649 --> 00:15:16,290
mentioned<font color="#E5E5E5"> credentials obviously being</font>

349
00:15:12,870 --> 00:15:20,550
the<font color="#E5E5E5"> best form of persistence with valid</font>

350
00:15:16,290 --> 00:15:23,099
credentials<font color="#E5E5E5"> you can avoid abnormal</font>

351
00:15:20,550 --> 00:15:26,310
activity so if you know<font color="#E5E5E5"> users always</font>

352
00:15:23,100 --> 00:15:30,930
<font color="#CCCCCC">gonna log in to say manage</font><font color="#E5E5E5"> a server then</font>

353
00:15:26,310 --> 00:15:32,529
<font color="#CCCCCC">you can use those credentials and like</font>

354
00:15:30,930 --> 00:15:35,050
that user would and<font color="#E5E5E5"> it's</font>

355
00:15:32,529 --> 00:15:37,689
much less suspicious there's other

356
00:15:35,050 --> 00:15:41,829
persistence methods obviously that<font color="#E5E5E5"> won't</font>

357
00:15:37,689 --> 00:15:43,719
get<font color="#E5E5E5"> caught by EDR attack</font><font color="#CCCCCC"> mitre</font><font color="#E5E5E5"> framework</font>

358
00:15:41,829 --> 00:15:45,849
is a great place to reference these

359
00:15:43,720 --> 00:15:48,089
techniques<font color="#E5E5E5"> there's stuff like using</font>

360
00:15:45,850 --> 00:15:50,290
<font color="#E5E5E5">third-party</font><font color="#CCCCCC"> management software that</font>

361
00:15:48,089 --> 00:15:52,839
<font color="#E5E5E5">administrator might be using to</font><font color="#CCCCCC"> manage</font>

362
00:15:50,290 --> 00:15:55,449
<font color="#E5E5E5">that server</font><font color="#CCCCCC"> if you're using</font><font color="#E5E5E5"> that to</font>

363
00:15:52,839 --> 00:15:58,600
<font color="#E5E5E5">manage the server in your</font><font color="#CCCCCC"> own way that's</font>

364
00:15:55,449 --> 00:16:00,430
<font color="#E5E5E5">less</font><font color="#CCCCCC"> likely to get flagged</font><font color="#E5E5E5"> implementing</font>

365
00:15:58,600 --> 00:16:02,829
<font color="#E5E5E5">these techniques</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> just going to</font>

366
00:16:00,430 --> 00:16:04,329
<font color="#E5E5E5">briefly talk about let's say we're just</font>

367
00:16:02,829 --> 00:16:07,779
<font color="#CCCCCC">gonna briefly</font><font color="#E5E5E5"> talk about some</font><font color="#CCCCCC"> of the</font>

368
00:16:04,329 --> 00:16:09,939
ways<font color="#CCCCCC"> that we did it</font><font color="#E5E5E5"> and more broadly</font>

369
00:16:07,779 --> 00:16:12,550
some of the ways that<font color="#E5E5E5"> I guess we think</font>

370
00:16:09,939 --> 00:16:14,829
you should<font color="#E5E5E5"> also implement these</font>

371
00:16:12,550 --> 00:16:18,189
techniques<font color="#E5E5E5"> so this is just a picture</font><font color="#CCCCCC"> of</font>

372
00:16:14,829 --> 00:16:21,059
<font color="#E5E5E5">a couple compiled COBOL strike</font><font color="#CCCCCC"> agressor</font>

373
00:16:18,189 --> 00:16:24,879
scripts<font color="#CCCCCC"> that we made it</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> menu so</font>

374
00:16:21,059 --> 00:16:28,300
MSHDA<font color="#E5E5E5"> script</font><font color="#CCCCCC"> stuff like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> that's</font>

375
00:16:24,879 --> 00:16:34,350
<font color="#E5E5E5">coming out</font><font color="#CCCCCC"> as new ways to execute code</font>

376
00:16:28,300 --> 00:16:37,209
or binaries or whatever you want<font color="#CCCCCC"> so</font>

377
00:16:34,350 --> 00:16:41,860
there's plenty<font color="#E5E5E5"> of new executables or</font>

378
00:16:37,209 --> 00:16:44,559
methods<font color="#E5E5E5"> written in c-sharp and we see</font>

379
00:16:41,860 --> 00:16:48,420
the industry<font color="#E5E5E5"> as moving more towards</font>

380
00:16:44,559 --> 00:16:52,480
using c-sharp<font color="#E5E5E5"> and methods like this to</font>

381
00:16:48,420 --> 00:16:54,430
<font color="#E5E5E5">download</font><font color="#CCCCCC"> an execute</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> so a</font><font color="#E5E5E5"> couple</font>

382
00:16:52,480 --> 00:16:57,809
<font color="#CCCCCC">more methods some lateral</font><font color="#E5E5E5"> movement</font>

383
00:16:54,430 --> 00:17:02,290
methods<font color="#E5E5E5"> let's see and then</font><font color="#CCCCCC"> persistence</font>

384
00:16:57,809 --> 00:17:03,879
<font color="#CCCCCC">some of these are old ways but we're</font>

385
00:17:02,290 --> 00:17:06,579
just pointing out<font color="#CCCCCC"> that it can Billy</font>

386
00:17:03,879 --> 00:17:14,470
sorry it can be implemented in<font color="#CCCCCC"> COBOL</font>

387
00:17:06,579 --> 00:17:16,688
strike and let's see improvement<font color="#E5E5E5"> and</font>

388
00:17:14,470 --> 00:17:19,689
cobalt strike or any of ideas<font color="#CCCCCC"> as I've</font>

389
00:17:16,689 --> 00:17:22,000
<font color="#E5E5E5">mentioned</font><font color="#CCCCCC"> today committed and you know</font>

390
00:17:19,689 --> 00:17:23,799
any platform<font color="#CCCCCC"> that you use for your</font><font color="#E5E5E5"> post</font>

391
00:17:22,000 --> 00:17:26,260
exploitation needs so we<font color="#E5E5E5"> don't want to</font>

392
00:17:23,799 --> 00:17:29,320
get up here<font color="#CCCCCC"> talk</font><font color="#E5E5E5"> about all the ways</font>

393
00:17:26,260 --> 00:17:31,960
maybe you can avoid EDR and

394
00:17:29,320 --> 00:17:33,759
all the ways you know<font color="#CCCCCC"> to get your</font>

395
00:17:31,960 --> 00:17:36,460
information<font color="#CCCCCC"> that you need whether it be</font>

396
00:17:33,759 --> 00:17:37,539
credentials<font color="#E5E5E5"> or just other information</font>

397
00:17:36,460 --> 00:17:40,090
that<font color="#CCCCCC"> you need from</font><font color="#E5E5E5"> the corporate network</font>

398
00:17:37,539 --> 00:17:42,429
<font color="#CCCCCC">without</font><font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about what can</font><font color="#E5E5E5"> be done</font>

399
00:17:40,090 --> 00:17:43,928
so the standard thing you see is red

400
00:17:42,429 --> 00:17:47,200
team against blue team<font color="#E5E5E5"> and that's what</font>

401
00:17:43,929 --> 00:17:49,210
this<font color="#E5E5E5"> picture depicts</font><font color="#CCCCCC"> so some ways to</font>

402
00:17:47,200 --> 00:17:52,169
<font color="#E5E5E5">defend against these techniques that</font>

403
00:17:49,210 --> 00:17:55,120
<font color="#CCCCCC">either corporations aren't doing or</font>

404
00:17:52,169 --> 00:17:57,009
aren't<font color="#CCCCCC"> doing enough of lateral movement</font>

405
00:17:55,120 --> 00:18:00,100
would<font color="#CCCCCC"> be things</font><font color="#E5E5E5"> like Network</font>

406
00:17:57,009 --> 00:18:02,049
segmentation<font color="#CCCCCC"> an example would be you</font>

407
00:18:00,100 --> 00:18:05,110
<font color="#CCCCCC">know why does all the</font><font color="#E5E5E5"> windows</font><font color="#CCCCCC"> hosts need</font>

408
00:18:02,049 --> 00:18:07,710
to talk to every<font color="#E5E5E5"> other network in the</font>

409
00:18:05,110 --> 00:18:10,689
environment<font color="#E5E5E5"> my example earlier with the</font>

410
00:18:07,710 --> 00:18:14,259
<font color="#E5E5E5">Raspberry Pi the signage or the 3d</font>

411
00:18:10,690 --> 00:18:15,429
printer running the Raspberry Pi<font color="#CCCCCC"> why you</font>

412
00:18:14,259 --> 00:18:17,169
know why do they need<font color="#E5E5E5"> to communicate</font>

413
00:18:15,429 --> 00:18:20,139
<font color="#E5E5E5">you could have network segmentation</font>

414
00:18:17,169 --> 00:18:22,299
<font color="#E5E5E5">there host-based firewalls were</font><font color="#CCCCCC"> a huge</font>

415
00:18:20,139 --> 00:18:25,779
fan<font color="#CCCCCC"> of and our respective operating</font>

416
00:18:22,299 --> 00:18:29,408
<font color="#CCCCCC">systems like IP tables</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> linux you know</font>

417
00:18:25,779 --> 00:18:31,690
why does<font color="#CCCCCC"> that</font><font color="#E5E5E5"> a Linux host</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to or</font>

418
00:18:29,409 --> 00:18:35,200
let's use the<font color="#CCCCCC"> NASS example why does that</font>

419
00:18:31,690 --> 00:18:38,919
host that's just serving NFS need every

420
00:18:35,200 --> 00:18:40,029
single<font color="#E5E5E5"> network</font><font color="#CCCCCC"> open on</font><font color="#E5E5E5"> 80 so why it is</font>

421
00:18:38,919 --> 00:18:43,389
every<font color="#E5E5E5"> single</font><font color="#CCCCCC"> network need to communicate</font>

422
00:18:40,029 --> 00:18:45,909
<font color="#CCCCCC">with that</font><font color="#E5E5E5"> nassos on port 80 or 443</font><font color="#CCCCCC"> and</font>

423
00:18:43,389 --> 00:18:48,908
<font color="#E5E5E5">you know why is</font><font color="#CCCCCC"> 22 open on that nassos</font>

424
00:18:45,909 --> 00:18:52,509
<font color="#E5E5E5">if no one's using it and if you do use</font>

425
00:18:48,909 --> 00:18:55,360
<font color="#CCCCCC">it restricted by IP because</font><font color="#E5E5E5"> the admin</font>

426
00:18:52,509 --> 00:18:57,879
admin privileges<font color="#CCCCCC"> or the credentials that</font>

427
00:18:55,360 --> 00:18:59,889
<font color="#E5E5E5">I mentioned earlier also</font><font color="#CCCCCC"> work with SSH</font>

428
00:18:57,879 --> 00:19:03,370
I'm sorry sage<font color="#E5E5E5"> into</font><font color="#CCCCCC"> that storage</font>

429
00:18:59,889 --> 00:19:05,199
controller<font color="#E5E5E5"> so you're basically able to</font>

430
00:19:03,370 --> 00:19:06,908
do anything<font color="#CCCCCC"> you want I've just storage</font>

431
00:19:05,200 --> 00:19:09,490
controller so<font color="#E5E5E5"> yeah host-based firewalls</font>

432
00:19:06,909 --> 00:19:11,529
restrict IPS<font color="#E5E5E5"> or I've just blocked that</font>

433
00:19:09,490 --> 00:19:14,950
port in general if possible passphrase

434
00:19:11,529 --> 00:19:16,750
<font color="#E5E5E5">or SSH keys</font><font color="#CCCCCC"> it's just something basic we</font>

435
00:19:14,950 --> 00:19:18,730
could do I'm<font color="#E5E5E5"> sure everyone's familiar</font>

436
00:19:16,750 --> 00:19:21,009
<font color="#CCCCCC">with it so we're not</font><font color="#E5E5E5"> going to spend</font><font color="#CCCCCC"> too</font>

437
00:19:18,730 --> 00:19:23,710
much time<font color="#E5E5E5"> on</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> and then this is a big</font>

438
00:19:21,009 --> 00:19:26,259
<font color="#E5E5E5">one</font><font color="#CCCCCC"> so active monitoring of EDR</font>

439
00:19:23,710 --> 00:19:28,269
dashboards<font color="#E5E5E5"> sure you have a</font><font color="#CCCCCC"> solution</font><font color="#E5E5E5"> that</font>

440
00:19:26,259 --> 00:19:32,169
either tells you when a<font color="#CCCCCC"> critical event</font>

441
00:19:28,269 --> 00:19:34,750
happens on that host but someone's needs

442
00:19:32,169 --> 00:19:38,860
<font color="#E5E5E5">to check it someone needs to be alerted</font>

443
00:19:34,750 --> 00:19:41,470
when it happens the the<font color="#E5E5E5"> NFS thing I</font>

444
00:19:38,860 --> 00:19:42,639
<font color="#E5E5E5">mentioned earlier mature EDR is might</font>

445
00:19:41,470 --> 00:19:46,510
flag on new

446
00:19:42,640 --> 00:19:49,000
NFS<font color="#CCCCCC"> host mount but if someone's not</font>

447
00:19:46,510 --> 00:19:50,440
<font color="#E5E5E5">checking that EDR solution then you know</font>

448
00:19:49,000 --> 00:19:53,559
<font color="#E5E5E5">nothing happens about it</font>

449
00:19:50,440 --> 00:19:56,230
so<font color="#E5E5E5"> some defense techniques for</font>

450
00:19:53,559 --> 00:19:59,168
persistence<font color="#CCCCCC"> things like threat hunting</font>

451
00:19:56,230 --> 00:20:01,960
looking<font color="#E5E5E5"> you know what happened to a host</font>

452
00:19:59,169 --> 00:20:04,210
<font color="#CCCCCC">or what's happening</font><font color="#E5E5E5"> to a host and</font><font color="#CCCCCC"> what's</font>

453
00:20:01,960 --> 00:20:07,990
changed with the host limiting<font color="#E5E5E5"> disk</font>

454
00:20:04,210 --> 00:20:09,700
<font color="#CCCCCC">rights</font><font color="#E5E5E5"> whenever possible</font><font color="#CCCCCC"> so you want to</font>

455
00:20:07,990 --> 00:20:11,529
avoid<font color="#E5E5E5"> this</font><font color="#CCCCCC"> red teamer wants to avoid</font>

456
00:20:09,700 --> 00:20:14,620
<font color="#CCCCCC">disk writes sometimes it's just not</font>

457
00:20:11,529 --> 00:20:17,470
<font color="#E5E5E5">possible</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to drop a binary on</font>

458
00:20:14,620 --> 00:20:20,529
the<font color="#E5E5E5"> disk for whatever reason so limiting</font>

459
00:20:17,470 --> 00:20:24,340
<font color="#CCCCCC">if possible</font><font color="#E5E5E5"> as a blue team limiting</font>

460
00:20:20,529 --> 00:20:27,370
where they can write very simple<font color="#E5E5E5"> and</font>

461
00:20:24,340 --> 00:20:30,149
then rotating passwords so you should

462
00:20:27,370 --> 00:20:33,729
assume the<font color="#E5E5E5"> passwords are compromised the</font>

463
00:20:30,149 --> 00:20:35,830
user that my example earlier with the

464
00:20:33,730 --> 00:20:37,299
<font color="#CCCCCC">Raspberry Pi</font><font color="#E5E5E5"> they were logging into the</font>

465
00:20:35,830 --> 00:20:39,610
raspberry pi whether it be like<font color="#E5E5E5"> B and C</font>

466
00:20:37,299 --> 00:20:41,860
and then<font color="#E5E5E5"> they were SSH in outbound</font><font color="#CCCCCC"> to</font>

467
00:20:39,610 --> 00:20:44,830
other critical<font color="#E5E5E5"> services which is</font>

468
00:20:41,860 --> 00:20:46,928
obviously bad<font color="#E5E5E5"> but the point is the users</font>

469
00:20:44,830 --> 00:20:51,908
going<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> mistakes</font><font color="#E5E5E5"> like that so</font>

470
00:20:46,929 --> 00:20:55,360
<font color="#E5E5E5">password rotation has to be a thing yes</font>

471
00:20:51,909 --> 00:20:57,100
so an old<font color="#E5E5E5"> technique is just honey pots</font>

472
00:20:55,360 --> 00:20:59,289
<font color="#CCCCCC">you might be saying you know why are you</font>

473
00:20:57,100 --> 00:21:00,820
<font color="#E5E5E5">talking about that</font><font color="#CCCCCC"> everyone's been</font>

474
00:20:59,289 --> 00:21:04,210
<font color="#E5E5E5">talking about it for you know he'll</font>

475
00:21:00,820 --> 00:21:06,639
notice how<font color="#E5E5E5"> many years but if an attacker</font>

476
00:21:04,210 --> 00:21:09,970
<font color="#E5E5E5">like I was looking around the network at</font>

477
00:21:06,639 --> 00:21:12,399
like NFS<font color="#E5E5E5"> host SSH O's I'm looking at</font>

478
00:21:09,970 --> 00:21:14,080
<font color="#E5E5E5">their brainers</font><font color="#CCCCCC"> you want to catch an</font>

479
00:21:12,399 --> 00:21:16,779
attacker<font color="#CCCCCC"> doing those actions</font><font color="#E5E5E5"> and a great</font>

480
00:21:14,080 --> 00:21:19,480
way to do<font color="#CCCCCC"> it is to set up something like</font>

481
00:21:16,779 --> 00:21:21,279
<font color="#E5E5E5">this where you know that no one else no</font>

482
00:21:19,480 --> 00:21:23,919
one<font color="#E5E5E5"> in the business with the legitimate</font>

483
00:21:21,279 --> 00:21:26,860
purpose<font color="#CCCCCC"> should be accessing</font><font color="#E5E5E5"> this host so</font>

484
00:21:23,919 --> 00:21:28,090
you caught an attacker there and you can

485
00:21:26,860 --> 00:21:29,559
you know retrace<font color="#E5E5E5"> his steps</font>

486
00:21:28,090 --> 00:21:32,529
<font color="#CCCCCC">you know what host he's coming</font><font color="#E5E5E5"> from and</font>

487
00:21:29,559 --> 00:21:33,820
things<font color="#CCCCCC"> like that and you just want a log</font>

488
00:21:32,529 --> 00:21:34,870
what they're doing because<font color="#E5E5E5"> you're</font>

489
00:21:33,820 --> 00:21:38,168
assuming that<font color="#E5E5E5"> they're doing the same</font>

490
00:21:34,870 --> 00:21:39,639
thing another host and Michael<font color="#E5E5E5"> be</font>

491
00:21:38,169 --> 00:21:43,510
talking about defense techniques for

492
00:21:39,639 --> 00:21:45,850
code execution we all know like

493
00:21:43,510 --> 00:21:49,029
malicious PowerShell<font color="#E5E5E5"> commands common</font>

494
00:21:45,850 --> 00:21:51,370
PowerShell<font color="#E5E5E5"> commands</font><font color="#CCCCCC"> that shouldn't be</font>

495
00:21:49,029 --> 00:21:53,320
run and there's<font color="#CCCCCC"> plenty of</font><font color="#E5E5E5"> ways</font><font color="#CCCCCC"> to block</font>

496
00:21:51,370 --> 00:21:55,840
it at the bottom<font color="#CCCCCC"> I say logging</font><font color="#E5E5E5"> a</font>

497
00:21:53,320 --> 00:22:02,200
<font color="#E5E5E5">PowerShell version 5 has logging</font>

498
00:21:55,840 --> 00:22:04,540
every major<font color="#E5E5E5"> edr solution</font><font color="#CCCCCC"> will read these</font>

499
00:22:02,200 --> 00:22:07,930
<font color="#CCCCCC">PowerShell logs and alert you if a</font>

500
00:22:04,540 --> 00:22:10,570
<font color="#CCCCCC">malicious command is executed</font>

501
00:22:07,930 --> 00:22:14,230
I love sis bond<font color="#E5E5E5"> if you don't have a ADR</font>

502
00:22:10,570 --> 00:22:17,050
solution<font color="#CCCCCC"> it's great for being able to</font>

503
00:22:14,230 --> 00:22:18,880
see what commands are run<font color="#E5E5E5"> and all the</font>

504
00:22:17,050 --> 00:22:21,340
<font color="#E5E5E5">posts exploitation activities that are</font>

505
00:22:18,880 --> 00:22:23,380
occurring and<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> know your</font><font color="#E5E5E5"> normal</font>

506
00:22:21,340 --> 00:22:27,540
state which<font color="#E5E5E5"> was</font><font color="#CCCCCC"> mentioned earlier in the</font>

507
00:22:23,380 --> 00:22:30,280
presentation<font color="#E5E5E5"> conclusion implementation</font>

508
00:22:27,540 --> 00:22:31,510
<font color="#CCCCCC">there's plenty of ways to</font><font color="#E5E5E5"> implement more</font>

509
00:22:30,280 --> 00:22:33,250
secure

510
00:22:31,510 --> 00:22:35,530
OPSEC techniques during<font color="#E5E5E5"> post</font>

511
00:22:33,250 --> 00:22:39,520
exploitation using<font color="#E5E5E5"> c-sharp using power</font>

512
00:22:35,530 --> 00:22:41,590
pick<font color="#E5E5E5"> using different techniques than the</font>

513
00:22:39,520 --> 00:22:45,040
same old persistence the same old

514
00:22:41,590 --> 00:22:46,929
techniques<font color="#CCCCCC"> building your own techniques</font>

515
00:22:45,040 --> 00:22:48,850
<font color="#E5E5E5">like ghost pack I mentioned earlier you</font>

516
00:22:46,930 --> 00:22:51,130
<font color="#CCCCCC">have to build on your</font><font color="#E5E5E5"> own a</font><font color="#CCCCCC"> Visual</font>

517
00:22:48,850 --> 00:22:53,399
<font color="#CCCCCC">Studio</font><font color="#E5E5E5"> to avoid signature detection</font>

518
00:22:51,130 --> 00:22:55,690
obviously most organizations have

519
00:22:53,400 --> 00:22:59,080
signature detection<font color="#E5E5E5"> so you want to avoid</font>

520
00:22:55,690 --> 00:23:00,880
that<font color="#E5E5E5"> this has say this talk has many</font>

521
00:22:59,080 --> 00:23:02,830
benefits<font color="#E5E5E5"> to a red</font><font color="#CCCCCC"> teamer</font>

522
00:23:00,880 --> 00:23:04,420
<font color="#E5E5E5">if they can remain off if they can</font>

523
00:23:02,830 --> 00:23:08,740
remain<font color="#E5E5E5"> OPSEC safe</font><font color="#CCCCCC"> during a presentation</font>

524
00:23:04,420 --> 00:23:11,920
or<font color="#CCCCCC"> during</font><font color="#E5E5E5"> pen testing engagement they</font>

525
00:23:08,740 --> 00:23:13,780
can avoid detection by<font color="#E5E5E5"> a blue team they</font>

526
00:23:11,920 --> 00:23:15,940
can<font color="#E5E5E5"> last longer on the network they</font><font color="#CCCCCC"> can</font>

527
00:23:13,780 --> 00:23:20,170
provide<font color="#E5E5E5"> more results to the customers</font>

528
00:23:15,940 --> 00:23:21,030
and stuff<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> so thanks thanks for</font>

529
00:23:20,170 --> 00:23:24,669
<font color="#CCCCCC">coming out</font>

530
00:23:21,030 --> 00:23:26,730
[Applause]

531
00:23:24,669 --> 00:23:26,730
you

