1
00:00:01,610 --> 00:00:08,639
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> I might have another</font><font color="#E5E5E5"> couple</font>

2
00:00:05,430 --> 00:00:11,160
people<font color="#CCCCCC"> straggle</font><font color="#E5E5E5"> in but thank</font><font color="#CCCCCC"> you guys</font>

3
00:00:08,639 --> 00:00:12,840
for showing up<font color="#E5E5E5"> to to this talk I know a</font>

4
00:00:11,160 --> 00:00:14,309
lot of people have been going<font color="#E5E5E5"> through</font>

5
00:00:12,840 --> 00:00:16,198
the rigorous<font color="#CCCCCC"> con schedule so</font><font color="#E5E5E5"> I</font>

6
00:00:14,309 --> 00:00:19,169
appreciate you still being on<font color="#E5E5E5"> your feet</font>

7
00:00:16,199 --> 00:00:20,789
today<font color="#CCCCCC"> to come see this so the name of</font>

8
00:00:19,170 --> 00:00:24,150
<font color="#CCCCCC">the talk today is comparing apples to</font>

9
00:00:20,789 --> 00:00:26,760
apples<font color="#CCCCCC"> the idea</font><font color="#E5E5E5"> of comparing apples to</font>

10
00:00:24,150 --> 00:00:28,169
apple<font color="#E5E5E5"> rather the idea</font><font color="#CCCCCC"> being like if you</font>

11
00:00:26,760 --> 00:00:31,320
come from a background<font color="#E5E5E5"> where you haven't</font>

12
00:00:28,170 --> 00:00:33,710
<font color="#E5E5E5">had to defend or attack a lot of Apple</font>

13
00:00:31,320 --> 00:00:36,480
devices<font color="#E5E5E5"> which is a lot of organizations</font>

14
00:00:33,710 --> 00:00:38,809
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is supposed to be a like a</font>

15
00:00:36,480 --> 00:00:40,828
practical<font color="#E5E5E5"> primer for you to take</font>

16
00:00:38,809 --> 00:00:42,750
<font color="#E5E5E5">techniques and tactics that you know</font>

17
00:00:40,829 --> 00:00:44,390
from<font color="#CCCCCC"> like Windows</font><font color="#E5E5E5"> and then apply them to</font>

18
00:00:42,750 --> 00:00:47,519
<font color="#E5E5E5">Mac so you can quickly come</font><font color="#CCCCCC"> up to speed</font>

19
00:00:44,390 --> 00:00:49,140
<font color="#CCCCCC">so my name is</font><font color="#E5E5E5"> Adam</font><font color="#CCCCCC"> I work</font><font color="#E5E5E5"> for a canary</font>

20
00:00:47,520 --> 00:00:51,270
<font color="#E5E5E5">these are a few of my favorite</font><font color="#CCCCCC"> things</font>

21
00:00:49,140 --> 00:00:55,800
you<font color="#CCCCCC"> can follow me on Twitter</font><font color="#E5E5E5"> but I</font>

22
00:00:51,270 --> 00:00:57,480
wouldn't<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't really do on there</font><font color="#E5E5E5"> all</font>

23
00:00:55,800 --> 00:00:58,858
<font color="#E5E5E5">right so here's the</font><font color="#CCCCCC"> agenda this</font><font color="#E5E5E5"> is kind</font>

24
00:00:57,480 --> 00:01:00,898
of<font color="#E5E5E5"> what we're gonna go through so some</font>

25
00:00:58,859 --> 00:01:02,340
<font color="#E5E5E5">really</font><font color="#CCCCCC"> high-level Mac OS security</font>

26
00:01:00,899 --> 00:01:05,070
overview is kind<font color="#E5E5E5"> of talking about like</font>

27
00:01:02,340 --> 00:01:07,880
what they prioritize we're gonna go

28
00:01:05,069 --> 00:01:10,408
through a lot of different<font color="#CCCCCC"> tactics and</font>

29
00:01:07,880 --> 00:01:12,210
some individual techniques we'll do some

30
00:01:10,409 --> 00:01:13,920
deep dives<font color="#E5E5E5"> kind of show you what it</font>

31
00:01:12,210 --> 00:01:15,779
looks like to see evil stuff on Mac<font color="#E5E5E5"> and</font>

32
00:01:13,920 --> 00:01:17,790
how you can do it<font color="#CCCCCC"> talk about some</font>

33
00:01:15,780 --> 00:01:20,729
tooling some open source<font color="#E5E5E5"> free tools and</font>

34
00:01:17,790 --> 00:01:26,820
then I'll show you<font color="#E5E5E5"> a little fun thing I</font>

35
00:01:20,729 --> 00:01:29,880
<font color="#CCCCCC">created that you can use right so</font><font color="#E5E5E5"> Apple</font>

36
00:01:26,820 --> 00:01:31,669
has kind of built<font color="#E5E5E5"> Mac OS</font><font color="#CCCCCC"> and iOS and all</font>

37
00:01:29,880 --> 00:01:34,110
the other OS is kind<font color="#CCCCCC"> of on three main</font>

38
00:01:31,670 --> 00:01:35,630
<font color="#E5E5E5">pillars so everything is kind of</font>

39
00:01:34,110 --> 00:01:37,890
centered<font color="#E5E5E5"> around code signing</font>

40
00:01:35,630 --> 00:01:39,780
<font color="#E5E5E5">entitlements</font><font color="#CCCCCC"> in sandboxing</font><font color="#E5E5E5"> so code</font>

41
00:01:37,890 --> 00:01:42,030
<font color="#CCCCCC">signing is pretty</font><font color="#E5E5E5"> straightforward</font><font color="#CCCCCC"> Apple</font>

42
00:01:39,780 --> 00:01:44,280
controls<font color="#E5E5E5"> all the certificates they hand</font>

43
00:01:42,030 --> 00:01:45,720
them<font color="#E5E5E5"> out to developers as needed</font><font color="#CCCCCC"> but</font>

44
00:01:44,280 --> 00:01:48,780
they're kind of<font color="#CCCCCC"> like the one-stop shop</font>

45
00:01:45,720 --> 00:01:51,929
<font color="#CCCCCC">and as as Mac OS continues to move</font>

46
00:01:48,780 --> 00:01:54,979
forward<font color="#E5E5E5"> it's increasingly difficult</font><font color="#CCCCCC"> to</font>

47
00:01:51,930 --> 00:01:57,299
run things that are not signed<font color="#CCCCCC"> it's</font>

48
00:01:54,979 --> 00:01:58,798
specifically<font color="#E5E5E5"> by either Apple or one of</font>

49
00:01:57,299 --> 00:02:00,869
these third-party<font color="#E5E5E5"> developer approved</font>

50
00:01:58,799 --> 00:02:01,890
certs<font color="#CCCCCC"> although there was a great talk on</font>

51
00:02:00,869 --> 00:02:04,350
<font color="#CCCCCC">Friday that</font><font color="#E5E5E5"> you should definitely check</font>

52
00:02:01,890 --> 00:02:07,500
<font color="#E5E5E5">out if you didn't see it</font><font color="#CCCCCC"> on a cool</font>

53
00:02:04,350 --> 00:02:09,750
bypass<font color="#CCCCCC"> entitlements are kind of</font>

54
00:02:07,500 --> 00:02:12,330
attributes that<font color="#CCCCCC"> are assigned to binaries</font>

55
00:02:09,750 --> 00:02:13,150
<font color="#E5E5E5">so just by virtue</font><font color="#CCCCCC"> the fact that you are</font>

56
00:02:12,330 --> 00:02:14,920
<font color="#E5E5E5">on an</font>

57
00:02:13,150 --> 00:02:16,750
system and running<font color="#E5E5E5"> even his route</font><font color="#CCCCCC"> does</font>

58
00:02:14,920 --> 00:02:19,750
not necessarily give you access to<font color="#E5E5E5"> other</font>

59
00:02:16,750 --> 00:02:21,909
processes<font color="#CCCCCC"> which is some that sandboxing</font>

60
00:02:19,750 --> 00:02:24,819
<font color="#CCCCCC">if you want to interrogate another</font>

61
00:02:21,909 --> 00:02:27,370
process<font color="#CCCCCC"> you need specific entitlements</font>

62
00:02:24,819 --> 00:02:28,599
<font color="#E5E5E5">like</font><font color="#CCCCCC"> get tasks for</font><font color="#E5E5E5"> bid other</font>

63
00:02:27,370 --> 00:02:30,310
entitlements like<font color="#E5E5E5"> that there's like the</font>

64
00:02:28,599 --> 00:02:31,720
whole<font color="#CCCCCC"> dictionary of them out there</font><font color="#E5E5E5"> and a</font>

65
00:02:30,310 --> 00:02:34,390
<font color="#E5E5E5">lot of them especially the most powerful</font>

66
00:02:31,720 --> 00:02:35,980
ones are reserved by<font color="#E5E5E5"> Apple</font><font color="#CCCCCC"> so if you</font>

67
00:02:34,390 --> 00:02:37,208
send<font color="#E5E5E5"> something up to Apple and say hey I</font>

68
00:02:35,980 --> 00:02:37,659
want<font color="#CCCCCC"> to put this in the App Store please</font>

69
00:02:37,209 --> 00:02:38,799
sign it

70
00:02:37,659 --> 00:02:40,569
<font color="#E5E5E5">they look at the entitlements and</font>

71
00:02:38,799 --> 00:02:43,390
<font color="#E5E5E5">they're like no you can't have this</font>

72
00:02:40,569 --> 00:02:44,679
<font color="#CCCCCC">you're too powerful so even if you're</font>

73
00:02:43,390 --> 00:02:46,510
running with what you feel<font color="#CCCCCC"> like it's god</font>

74
00:02:44,680 --> 00:02:49,060
<font color="#E5E5E5">mode</font><font color="#CCCCCC"> you're still restricted</font><font color="#E5E5E5"> by some of</font>

75
00:02:46,510 --> 00:02:51,540
these things<font color="#CCCCCC"> so all</font><font color="#E5E5E5"> of these subsystems</font>

76
00:02:49,060 --> 00:02:54,010
<font color="#E5E5E5">which I won't get</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> in the Mac OS</font>

77
00:02:51,540 --> 00:02:56,530
system are kind of designed<font color="#CCCCCC"> around</font>

78
00:02:54,010 --> 00:02:59,138
enforcing<font color="#E5E5E5"> these principles very</font>

79
00:02:56,530 --> 00:03:00,930
resilient<font color="#CCCCCC"> latticework it's</font><font color="#E5E5E5"> really it's</font>

80
00:02:59,139 --> 00:03:06,209
<font color="#CCCCCC">really actually</font><font color="#E5E5E5"> kind of intricate stuff</font>

81
00:03:00,930 --> 00:03:08,439
so<font color="#E5E5E5"> just to kind of like pivot from there</font>

82
00:03:06,209 --> 00:03:09,700
you'll notice based on all<font color="#E5E5E5"> that it's</font>

83
00:03:08,439 --> 00:03:11,170
kind of a hostile environment to bring

84
00:03:09,700 --> 00:03:12,700
<font color="#E5E5E5">your own binary</font><font color="#CCCCCC"> to so if you're an</font>

85
00:03:11,170 --> 00:03:14,319
attacker<font color="#CCCCCC"> you're not going</font><font color="#E5E5E5"> to necessarily</font>

86
00:03:12,700 --> 00:03:16,599
to say like oh I built this<font color="#CCCCCC"> super</font>

87
00:03:14,319 --> 00:03:18,040
<font color="#CCCCCC">awesome like rootkit or some other piece</font>

88
00:03:16,599 --> 00:03:19,869
of malware<font color="#E5E5E5"> I'm just gonna run and drop</font>

89
00:03:18,040 --> 00:03:21,040
it on the machine<font color="#E5E5E5"> and run it</font><font color="#CCCCCC"> there's a</font>

90
00:03:19,870 --> 00:03:23,169
good<font color="#CCCCCC"> chance that</font><font color="#E5E5E5"> they're gonna run into</font>

91
00:03:21,040 --> 00:03:25,209
some<font color="#CCCCCC"> problems but Apple has made</font><font color="#E5E5E5"> this</font>

92
00:03:23,169 --> 00:03:28,629
really easy<font color="#CCCCCC"> for</font><font color="#E5E5E5"> them by giving them like</font>

93
00:03:25,209 --> 00:03:31,120
every scripting language in the world by

94
00:03:28,629 --> 00:03:32,649
default<font color="#E5E5E5"> so just to kind of give you</font><font color="#CCCCCC"> a</font>

95
00:03:31,120 --> 00:03:33,790
taste of<font color="#E5E5E5"> things to come so like on the</font>

96
00:03:32,650 --> 00:03:36,220
window side if you're familiar with

97
00:03:33,790 --> 00:03:38,470
<font color="#E5E5E5">PowerShell been used a lot in the</font><font color="#CCCCCC"> last</font>

98
00:03:36,220 --> 00:03:40,090
<font color="#E5E5E5">few years for like</font><font color="#CCCCCC"> Fallas malware all</font>

99
00:03:38,470 --> 00:03:41,919
kinds of different<font color="#E5E5E5"> attacks lateral</font>

100
00:03:40,090 --> 00:03:43,569
movement all kinds of<font color="#E5E5E5"> cool stuff there</font>

101
00:03:41,919 --> 00:03:46,269
are some corollaries on the<font color="#E5E5E5"> Apple side</font>

102
00:03:43,569 --> 00:03:48,790
so<font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> script is is the most Mac</font>

103
00:03:46,269 --> 00:03:50,319
specific<font color="#E5E5E5"> it's very fun you</font><font color="#CCCCCC"> can do all</font>

104
00:03:48,790 --> 00:03:53,739
<font color="#E5E5E5">kinds of stuff</font><font color="#CCCCCC"> with it like</font><font color="#E5E5E5"> execute</font>

105
00:03:50,319 --> 00:03:56,409
software run shell scripts<font color="#E5E5E5"> you can run</font>

106
00:03:53,739 --> 00:04:00,340
remote code on other systems<font color="#CCCCCC"> you can</font>

107
00:03:56,409 --> 00:04:03,399
interact with the GUI<font color="#E5E5E5"> of any apple apple</font>

108
00:04:00,340 --> 00:04:06,430
process so it's it's really<font color="#E5E5E5"> rife with</font>

109
00:04:03,400 --> 00:04:08,139
possibility for<font color="#CCCCCC"> compromise we'll</font><font color="#E5E5E5"> get</font>

110
00:04:06,430 --> 00:04:10,329
into<font color="#E5E5E5"> a couple of examples as we go</font>

111
00:04:08,139 --> 00:04:11,889
deeper into<font color="#E5E5E5"> the tradecraft them but then</font>

112
00:04:10,329 --> 00:04:14,709
of<font color="#E5E5E5"> course they have bash in Python and</font>

113
00:04:11,889 --> 00:04:17,139
<font color="#E5E5E5">Ruby and</font><font color="#CCCCCC"> perl PHP</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> install</font>

114
00:04:14,709 --> 00:04:19,090
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> and and all</font><font color="#E5E5E5"> of those</font>

115
00:04:17,139 --> 00:04:20,889
excluding<font color="#E5E5E5"> PowerShell you can't get rid</font>

116
00:04:19,089 --> 00:04:22,690
of them<font color="#E5E5E5"> so you can remove them</font><font color="#CCCCCC"> you'll</font>

117
00:04:20,889 --> 00:04:24,010
break some internal<font color="#CCCCCC"> Apple stuff and it</font>

118
00:04:22,690 --> 00:04:26,710
will show back<font color="#CCCCCC"> up the next time</font>

119
00:04:24,010 --> 00:04:28,330
<font color="#CCCCCC">update</font><font color="#E5E5E5"> so and a lot</font><font color="#CCCCCC"> of times their older</font>

120
00:04:26,710 --> 00:04:29,710
versions of it as well so<font color="#E5E5E5"> they might not</font>

121
00:04:28,330 --> 00:04:33,550
<font color="#CCCCCC">even be the version that you need to</font>

122
00:04:29,710 --> 00:04:36,760
execute the things you want<font color="#CCCCCC"> all right so</font>

123
00:04:33,550 --> 00:04:38,560
a couple<font color="#E5E5E5"> couple of other things before</font>

124
00:04:36,760 --> 00:04:40,210
<font color="#E5E5E5">we get into the individual techniques</font>

125
00:04:38,560 --> 00:04:42,550
<font color="#CCCCCC">we'll be using</font>

126
00:04:40,210 --> 00:04:44,760
mitre attack for a taxonomy<font color="#E5E5E5"> so if you're</font>

127
00:04:42,550 --> 00:04:48,310
<font color="#E5E5E5">not familiar</font><font color="#CCCCCC"> with a tackle two of you</font>

128
00:04:44,760 --> 00:04:50,860
know it's basically<font color="#CCCCCC"> miters wiki of</font>

129
00:04:48,310 --> 00:04:54,040
observed adversarial behavior tactics

130
00:04:50,860 --> 00:04:56,170
techniques<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're cooling so it's</font>

131
00:04:54,040 --> 00:04:57,340
really<font color="#E5E5E5"> great resource both as a defender</font>

132
00:04:56,170 --> 00:04:58,510
<font color="#CCCCCC">and ins attacker if you're trying to</font>

133
00:04:57,340 --> 00:05:01,060
<font color="#CCCCCC">figure out like how do I go about</font>

134
00:04:58,510 --> 00:05:03,070
<font color="#E5E5E5">learning a new platform</font><font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> it's a</font>

135
00:05:01,060 --> 00:05:04,630
great<font color="#E5E5E5"> resource</font><font color="#CCCCCC"> for that</font><font color="#E5E5E5"> and at the</font>

136
00:05:03,070 --> 00:05:07,090
bottom<font color="#E5E5E5"> there we have the the mandiant</font>

137
00:05:04,630 --> 00:05:08,620
attack lifecycle so kind of the steps<font color="#CCCCCC"> an</font>

138
00:05:07,090 --> 00:05:10,840
adversary will go through when they<font color="#E5E5E5"> land</font>

139
00:05:08,620 --> 00:05:12,280
on<font color="#E5E5E5"> the system we're gonna be mostly</font>

140
00:05:10,840 --> 00:05:13,810
focusing<font color="#E5E5E5"> on that loop there because</font>

141
00:05:12,280 --> 00:05:16,690
that's<font color="#E5E5E5"> where they the attacker spend the</font>

142
00:05:13,810 --> 00:05:19,450
most time<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> the ways they</font><font color="#E5E5E5"> get into</font>

143
00:05:16,690 --> 00:05:20,440
a<font color="#E5E5E5"> system change rapidly day to day but</font>

144
00:05:19,450 --> 00:05:22,690
<font color="#E5E5E5">what they do once they're in there</font>

145
00:05:20,440 --> 00:05:24,070
that's I mean attackers are lazy just

146
00:05:22,690 --> 00:05:26,620
<font color="#E5E5E5">like everybody else</font><font color="#CCCCCC"> so they do the same</font>

147
00:05:24,070 --> 00:05:29,320
<font color="#E5E5E5">thing so we're gonna focus mostly on</font>

148
00:05:26,620 --> 00:05:30,970
that<font color="#E5E5E5"> all right so this is</font><font color="#CCCCCC"> kind of how</font>

149
00:05:29,320 --> 00:05:32,349
we're gonna approach<font color="#E5E5E5"> it so we'll look at</font>

150
00:05:30,970 --> 00:05:34,660
the thing<font color="#CCCCCC"> window-side we'll look</font><font color="#E5E5E5"> at the</font>

151
00:05:32,350 --> 00:05:40,540
thing on<font color="#E5E5E5"> the Mac side so Who am I is Who</font>

152
00:05:34,660 --> 00:05:42,700
am I talkin plea<font color="#CCCCCC"> so it's the same exact</font>

153
00:05:40,540 --> 00:05:46,450
thing<font color="#CCCCCC"> it's Who am I it says who the</font><font color="#E5E5E5"> user</font>

154
00:05:42,700 --> 00:05:50,440
is<font color="#E5E5E5"> so net dot exe on the window side is</font>

155
00:05:46,450 --> 00:05:52,479
<font color="#E5E5E5">a common attacker tool and admin tool to</font>

156
00:05:50,440 --> 00:05:54,940
learn<font color="#E5E5E5"> information about users which</font>

157
00:05:52,480 --> 00:05:56,950
groups<font color="#E5E5E5"> they're in group membership other</font>

158
00:05:54,940 --> 00:05:59,890
attributes<font color="#E5E5E5"> so there's there's two tools</font>

159
00:05:56,950 --> 00:06:03,400
on the Mac side<font color="#E5E5E5"> so</font><font color="#CCCCCC"> D SEL and DF cash</font>

160
00:05:59,890 --> 00:06:04,780
<font color="#CCCCCC">hotel those are utilities that</font><font color="#E5E5E5"> you can</font>

161
00:06:03,400 --> 00:06:06,520
get all<font color="#CCCCCC"> kinds of attributes about</font>

162
00:06:04,780 --> 00:06:09,219
individual users their group membership

163
00:06:06,520 --> 00:06:12,330
<font color="#CCCCCC">other kinds of permission stuff so just</font>

164
00:06:09,220 --> 00:06:15,970
<font color="#CCCCCC">something to kind</font><font color="#E5E5E5"> of keep</font><font color="#CCCCCC"> an eye out for</font>

165
00:06:12,330 --> 00:06:17,409
<font color="#E5E5E5">system profiler I compared it to</font><font color="#CCCCCC"> NS info</font>

166
00:06:15,970 --> 00:06:19,270
<font color="#E5E5E5">because I couldn't think of anything</font>

167
00:06:17,410 --> 00:06:21,490
else<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is as complete as system</font>

168
00:06:19,270 --> 00:06:23,830
profiler<font color="#E5E5E5"> system profiler will collect</font>

169
00:06:21,490 --> 00:06:26,560
<font color="#CCCCCC">all of</font><font color="#E5E5E5"> your hardware information</font><font color="#CCCCCC"> your</font>

170
00:06:23,830 --> 00:06:29,229
software<font color="#CCCCCC"> information your firewall rules</font>

171
00:06:26,560 --> 00:06:32,760
<font color="#E5E5E5">like user information like it's it's</font>

172
00:06:29,230 --> 00:06:35,530
insane<font color="#E5E5E5"> how much data this thing pulls</font>

173
00:06:32,760 --> 00:06:37,930
there's a little<font color="#E5E5E5"> screenshot there so a</font>

174
00:06:35,530 --> 00:06:40,179
<font color="#CCCCCC">male doc that we observed in the wild</font>

175
00:06:37,930 --> 00:06:41,980
it was running<font color="#E5E5E5"> off all kinds of system</font>

176
00:06:40,180 --> 00:06:43,750
profile or individual attributes<font color="#E5E5E5"> looking</font>

177
00:06:41,980 --> 00:06:45,750
for those<font color="#E5E5E5"> things and</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> kind of</font>

178
00:06:43,750 --> 00:06:49,480
storing them all<font color="#CCCCCC"> for for recon purposes</font>

179
00:06:45,750 --> 00:06:51,550
<font color="#CCCCCC">so it's really</font><font color="#E5E5E5"> cool tool</font><font color="#CCCCCC"> and then so</font>

180
00:06:49,480 --> 00:06:53,980
like another thing if you learn in an

181
00:06:51,550 --> 00:06:55,620
<font color="#CCCCCC">environment you</font><font color="#E5E5E5"> want to walk around see</font>

182
00:06:53,980 --> 00:06:57,940
what else is out<font color="#E5E5E5"> there</font>

183
00:06:55,620 --> 00:06:59,350
on<font color="#CCCCCC"> Windows a lot of times people use</font>

184
00:06:57,940 --> 00:07:02,740
things<font color="#E5E5E5"> like in map other kinds of</font>

185
00:06:59,350 --> 00:07:05,440
utilities<font color="#E5E5E5"> to to scan adjoining systems</font>

186
00:07:02,740 --> 00:07:07,390
<font color="#E5E5E5">so Apple has included a really cool</font>

187
00:07:05,440 --> 00:07:09,490
utility that<font color="#E5E5E5"> is a little known called</font>

188
00:07:07,390 --> 00:07:11,770
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> utility and which has got like</font>

189
00:07:09,490 --> 00:07:13,450
the<font color="#CCCCCC"> ability to ping and and you know do</font>

190
00:07:11,770 --> 00:07:15,729
<font color="#CCCCCC">DNS lookups and</font><font color="#E5E5E5"> stuff but also has a</font>

191
00:07:13,450 --> 00:07:17,950
port<font color="#E5E5E5"> scanner built right into it so you</font>

192
00:07:15,730 --> 00:07:19,990
can port scan<font color="#E5E5E5"> using nothing but Apple</font>

193
00:07:17,950 --> 00:07:21,670
utilities<font color="#E5E5E5"> it also it can</font><font color="#CCCCCC"> be called</font>

194
00:07:19,990 --> 00:07:24,220
directly<font color="#E5E5E5"> from the command</font><font color="#CCCCCC"> line so if you</font>

195
00:07:21,670 --> 00:07:28,300
go<font color="#E5E5E5"> to the stroke you tell it that if you</font>

196
00:07:24,220 --> 00:07:30,220
<font color="#E5E5E5">can I don't know basically it</font><font color="#CCCCCC"> just takes</font>

197
00:07:28,300 --> 00:07:32,620
an IP<font color="#CCCCCC"> it takes the port range that you</font>

198
00:07:30,220 --> 00:07:33,850
want<font color="#CCCCCC"> to scan you go so you don't have to</font>

199
00:07:32,620 --> 00:07:37,140
<font color="#CCCCCC">even bring anything to the table</font>

200
00:07:33,850 --> 00:07:43,420
<font color="#E5E5E5">although</font><font color="#CCCCCC"> you can install a map of</font><font color="#E5E5E5"> course</font>

201
00:07:37,140 --> 00:07:46,180
<font color="#E5E5E5">all right so let's look at credential</font>

202
00:07:43,420 --> 00:07:48,790
access and privilege escalation<font color="#CCCCCC"> so</font>

203
00:07:46,180 --> 00:07:50,860
changing tactics<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit so on the</font>

204
00:07:48,790 --> 00:07:52,000
window side<font color="#E5E5E5"> if you have a command prompt</font>

205
00:07:50,860 --> 00:07:53,800
<font color="#E5E5E5">and you've done a whole bunch</font><font color="#CCCCCC"> of stuff</font>

206
00:07:52,000 --> 00:07:54,550
<font color="#E5E5E5">and somebody comes behind</font><font color="#CCCCCC"> you and</font><font color="#E5E5E5"> they</font>

207
00:07:53,800 --> 00:07:56,890
want to see what you've done

208
00:07:54,550 --> 00:07:58,540
<font color="#E5E5E5">they can use the Doss key command they</font>

209
00:07:56,890 --> 00:07:59,770
can use the f7<font color="#E5E5E5"> key there's a lot of</font>

210
00:07:58,540 --> 00:08:03,490
different<font color="#E5E5E5"> ways</font><font color="#CCCCCC"> to see</font><font color="#E5E5E5"> the history of</font>

211
00:07:59,770 --> 00:08:05,530
your<font color="#E5E5E5"> command prompt</font><font color="#CCCCCC"> so because Mac has</font>

212
00:08:03,490 --> 00:08:07,450
bash natively<font color="#E5E5E5"> every user has a bash</font>

213
00:08:05,530 --> 00:08:09,880
history file<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> come from a Linux</font>

214
00:08:07,450 --> 00:08:11,860
background<font color="#CCCCCC"> you're familiar with</font><font color="#E5E5E5"> this but</font>

215
00:08:09,880 --> 00:08:15,820
<font color="#E5E5E5">basically just</font><font color="#CCCCCC"> a list of</font><font color="#E5E5E5"> all the</font><font color="#CCCCCC"> things</font>

216
00:08:11,860 --> 00:08:17,440
<font color="#E5E5E5">that you've run in terminal now as an</font>

217
00:08:15,820 --> 00:08:19,719
attacker<font color="#CCCCCC"> it might be interesting because</font>

218
00:08:17,440 --> 00:08:20,980
someone might be you<font color="#E5E5E5"> know working</font><font color="#CCCCCC"> with a</font>

219
00:08:19,720 --> 00:08:23,620
<font color="#E5E5E5">system</font><font color="#CCCCCC"> where they</font><font color="#E5E5E5"> pass</font><font color="#CCCCCC"> to commit a</font>

220
00:08:20,980 --> 00:08:25,180
password along the command line or<font color="#E5E5E5"> had</font>

221
00:08:23,620 --> 00:08:26,620
some kind of identities file that

222
00:08:25,180 --> 00:08:28,410
they're<font color="#E5E5E5"> referencing</font><font color="#CCCCCC"> got user name and</font>

223
00:08:26,620 --> 00:08:30,790
passwords in it<font color="#E5E5E5"> maybe in a hidden file</font>

224
00:08:28,410 --> 00:08:32,770
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> they've they're just</font><font color="#CCCCCC"> hitting a</font>

225
00:08:30,790 --> 00:08:34,870
bunch<font color="#E5E5E5"> of things on</font><font color="#CCCCCC"> SSH and you can find</font>

226
00:08:32,770 --> 00:08:38,260
something<font color="#CCCCCC"> that you already have a key to</font>

227
00:08:34,870 --> 00:08:40,240
access to under this<font color="#CCCCCC"> user's context</font><font color="#E5E5E5"> so</font>

228
00:08:38,260 --> 00:08:42,549
the bash history file is kind of<font color="#E5E5E5"> a great</font>

229
00:08:40,240 --> 00:08:44,380
one as a defender just<font color="#E5E5E5"> to watch whether</font>

230
00:08:42,549 --> 00:08:45,400
<font color="#CCCCCC">somebody trying to reference it somebody</font>

231
00:08:44,380 --> 00:08:46,390
trying to delete<font color="#E5E5E5"> it to cover their</font>

232
00:08:45,400 --> 00:08:48,760
tracks

233
00:08:46,390 --> 00:08:51,089
it's just a it's it's a<font color="#E5E5E5"> really easy easy</font>

234
00:08:48,760 --> 00:08:51,089
win

235
00:08:51,200 --> 00:08:55,550
DLL hijacking<font color="#CCCCCC"> direct corollary with</font>

236
00:08:53,870 --> 00:08:57,829
dial-up hijacking on the Mac side so

237
00:08:55,550 --> 00:09:00,889
basically<font color="#CCCCCC"> the idea is</font><font color="#E5E5E5"> you have a you</font>

238
00:08:57,829 --> 00:09:02,540
<font color="#CCCCCC">have a binary</font><font color="#E5E5E5"> that's trying to call a</font>

239
00:09:00,889 --> 00:09:04,310
series of libraries<font color="#E5E5E5"> and it's going to go</font>

240
00:09:02,540 --> 00:09:06,740
through a search order<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> times</font>

241
00:09:04,310 --> 00:09:08,359
<font color="#E5E5E5">especially if there's lazy programming</font>

242
00:09:06,740 --> 00:09:10,339
going<font color="#E5E5E5"> on they'll just be like hey I'm</font>

243
00:09:08,360 --> 00:09:12,290
<font color="#CCCCCC">just gonna</font><font color="#E5E5E5"> search all the directories in</font>

244
00:09:10,339 --> 00:09:14,240
this path until<font color="#CCCCCC"> I find this thing so</font>

245
00:09:12,290 --> 00:09:15,680
what you do<font color="#E5E5E5"> is an attacker</font><font color="#CCCCCC"> it say here's</font>

246
00:09:14,240 --> 00:09:18,649
the binary you're looking for here's the

247
00:09:15,680 --> 00:09:20,149
<font color="#E5E5E5">library</font><font color="#CCCCCC"> it you know</font><font color="#E5E5E5"> pulls it into</font><font color="#CCCCCC"> memory</font>

248
00:09:18,649 --> 00:09:23,870
and<font color="#E5E5E5"> now you're running under</font><font color="#CCCCCC"> the context</font>

249
00:09:20,149 --> 00:09:25,250
of<font color="#E5E5E5"> that process</font><font color="#CCCCCC"> so this this tool is one</font>

250
00:09:23,870 --> 00:09:27,079
that<font color="#CCCCCC"> Patrick Wartell wrote from</font>

251
00:09:25,250 --> 00:09:29,110
<font color="#E5E5E5">Objective C he's got like a ton of tools</font>

252
00:09:27,079 --> 00:09:31,638
<font color="#E5E5E5">are really awesome</font><font color="#CCCCCC"> but it's a good</font>

253
00:09:29,110 --> 00:09:35,690
visual of where you might have some

254
00:09:31,639 --> 00:09:38,660
<font color="#CCCCCC">compromise in user prompt if you've ever</font>

255
00:09:35,690 --> 00:09:40,699
run responder to attack<font color="#E5E5E5"> window systems</font>

256
00:09:38,660 --> 00:09:42,350
<font color="#E5E5E5">basically pop up something says hey I</font>

257
00:09:40,699 --> 00:09:43,339
<font color="#E5E5E5">need your password users love putting</font>

258
00:09:42,350 --> 00:09:45,230
<font color="#E5E5E5">their password in boxes</font>

259
00:09:43,339 --> 00:09:46,940
you can do the same<font color="#E5E5E5"> exact</font><font color="#CCCCCC"> thing with</font>

260
00:09:45,230 --> 00:09:48,709
Apple script and you can do<font color="#E5E5E5"> it in a</font>

261
00:09:46,940 --> 00:09:49,910
really clean nice way<font color="#E5E5E5"> because you're</font>

262
00:09:48,709 --> 00:09:52,279
going<font color="#CCCCCC"> to do it in the exact same</font><font color="#E5E5E5"> way</font>

263
00:09:49,910 --> 00:09:54,889
Apple would do it so down<font color="#E5E5E5"> here you</font><font color="#CCCCCC"> can</font>

264
00:09:52,279 --> 00:09:56,269
see<font color="#CCCCCC"> an example</font><font color="#E5E5E5"> of an</font><font color="#CCCCCC"> Apple script script</font>

265
00:09:54,889 --> 00:09:58,790
<font color="#CCCCCC">that's run directly from the</font><font color="#E5E5E5"> command</font>

266
00:09:56,269 --> 00:10:00,589
line with Oso script<font color="#E5E5E5"> so each one of</font>

267
00:09:58,790 --> 00:10:02,329
these<font color="#CCCCCC"> e's is like its own little line</font><font color="#E5E5E5"> if</font>

268
00:10:00,589 --> 00:10:04,490
you want<font color="#CCCCCC"> to visualize what the script</font>

269
00:10:02,329 --> 00:10:06,410
might look like<font color="#E5E5E5"> but basically</font><font color="#CCCCCC"> it says</font>

270
00:10:04,490 --> 00:10:08,660
hey<font color="#E5E5E5"> system preferences open up pop up a</font>

271
00:10:06,410 --> 00:10:10,189
dialog<font color="#CCCCCC"> box prompt the user for</font><font color="#E5E5E5"> their</font>

272
00:10:08,660 --> 00:10:12,529
<font color="#CCCCCC">password and</font><font color="#E5E5E5"> then give it</font><font color="#CCCCCC"> back to the</font>

273
00:10:10,190 --> 00:10:16,910
shell and<font color="#CCCCCC"> when it's done and that would</font>

274
00:10:12,529 --> 00:10:19,760
look kind of<font color="#E5E5E5"> like</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> so it's going</font><font color="#CCCCCC"> to</font>

275
00:10:16,910 --> 00:10:22,300
paste the command you see this software

276
00:10:19,760 --> 00:10:25,519
<font color="#E5E5E5">updates you user puts in the</font><font color="#CCCCCC"> password</font>

277
00:10:22,300 --> 00:10:29,660
<font color="#CCCCCC">super cool and now you get hello to</font>

278
00:10:25,519 --> 00:10:31,790
every<font color="#E5E5E5"> cons great password</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> usually you</font>

279
00:10:29,660 --> 00:10:33,680
would be you know as an attacker you

280
00:10:31,790 --> 00:10:35,599
<font color="#E5E5E5">would be on the other end of a reverse</font>

281
00:10:33,680 --> 00:10:36,920
<font color="#CCCCCC">shell or</font><font color="#E5E5E5"> something like that</font><font color="#CCCCCC"> and so this</font>

282
00:10:35,600 --> 00:10:40,610
you wouldn't have a big box popping up

283
00:10:36,920 --> 00:10:44,089
for the user<font color="#CCCCCC"> so this is an</font><font color="#E5E5E5"> example so</font>

284
00:10:40,610 --> 00:10:47,209
egg shell is a post exploit<font color="#E5E5E5"> Python base</font>

285
00:10:44,089 --> 00:10:49,699
kit<font color="#CCCCCC"> surveillance</font><font color="#E5E5E5"> focused for Mac OS and</font>

286
00:10:47,209 --> 00:10:52,250
iOS specifically so one<font color="#CCCCCC"> of the things</font>

287
00:10:49,699 --> 00:10:54,139
you have this nice<font color="#CCCCCC"> little prompt</font><font color="#E5E5E5"> plug-in</font>

288
00:10:52,250 --> 00:10:56,240
which will pop up<font color="#E5E5E5"> that same kind of box</font>

289
00:10:54,139 --> 00:10:58,160
<font color="#CCCCCC">pass it right</font><font color="#E5E5E5"> down the shell the cool</font>

290
00:10:56,240 --> 00:11:02,450
thing<font color="#CCCCCC"> about Apple is if you have a</font>

291
00:10:58,160 --> 00:11:04,459
single user<font color="#E5E5E5"> you are probably the admin</font>

292
00:11:02,450 --> 00:11:06,829
unless it's been<font color="#E5E5E5"> taken from you so it's</font>

293
00:11:04,459 --> 00:11:09,469
a very quick<font color="#E5E5E5"> escalation to route if you</font>

294
00:11:06,829 --> 00:11:10,939
ever get<font color="#CCCCCC"> that users</font><font color="#E5E5E5"> password um</font>

295
00:11:09,470 --> 00:11:13,040
so down<font color="#E5E5E5"> here at the bottom</font><font color="#CCCCCC"> that have</font><font color="#E5E5E5"> a</font>

296
00:11:10,940 --> 00:11:14,870
idea for<font color="#CCCCCC"> like a detection</font><font color="#E5E5E5"> looking for</font>

297
00:11:13,040 --> 00:11:16,969
<font color="#CCCCCC">OSA Script</font><font color="#E5E5E5"> anything in the command line</font>

298
00:11:14,870 --> 00:11:19,220
is this focused on<font color="#E5E5E5"> password system</font>

299
00:11:16,970 --> 00:11:21,260
preferences<font color="#E5E5E5"> software update look for the</font>

300
00:11:19,220 --> 00:11:25,010
things<font color="#E5E5E5"> that an adversary would use to</font>

301
00:11:21,260 --> 00:11:27,380
try to<font color="#E5E5E5"> get somebody confused</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> and</font>

302
00:11:25,010 --> 00:11:29,089
<font color="#CCCCCC">two another</font><font color="#E5E5E5"> way if you if you have that</font>

303
00:11:27,380 --> 00:11:30,709
password<font color="#E5E5E5"> but you're not able to escalate</font>

304
00:11:29,089 --> 00:11:32,149
to<font color="#CCCCCC"> to root so you've got the password</font>

305
00:11:30,709 --> 00:11:34,638
<font color="#E5E5E5">but you're still kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> a limited user</font>

306
00:11:32,149 --> 00:11:36,680
keychain access is a great way to get

307
00:11:34,639 --> 00:11:38,899
yourself<font color="#CCCCCC"> on</font><font color="#E5E5E5"> to other systems so the</font>

308
00:11:36,680 --> 00:11:41,149
keychain and<font color="#E5E5E5"> Apple is a database</font><font color="#CCCCCC"> that</font>

309
00:11:38,899 --> 00:11:44,360
<font color="#E5E5E5">it's full of all of your</font><font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> your</font>

310
00:11:41,149 --> 00:11:45,800
shared keys<font color="#E5E5E5"> your certificates that you</font>

311
00:11:44,360 --> 00:11:48,350
might use<font color="#CCCCCC"> to authenticate to you like a</font>

312
00:11:45,800 --> 00:11:50,389
secure website<font color="#CCCCCC"> all kinds of identity</font>

313
00:11:48,350 --> 00:11:53,870
stuff it's a really<font color="#E5E5E5"> really</font><font color="#CCCCCC"> cool resource</font>

314
00:11:50,389 --> 00:11:56,240
to to pull clear text passwords out of

315
00:11:53,870 --> 00:11:58,060
so here's a couple<font color="#CCCCCC"> of different</font><font color="#E5E5E5"> ways</font>

316
00:11:56,240 --> 00:12:01,310
that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can interrogate</font><font color="#E5E5E5"> that database</font>

317
00:11:58,060 --> 00:12:04,609
<font color="#CCCCCC">so find internet password just</font><font color="#E5E5E5"> pass it</font>

318
00:12:01,310 --> 00:12:07,279
the name<font color="#CCCCCC"> of a URL</font><font color="#E5E5E5"> if it exists and you</font>

319
00:12:04,610 --> 00:12:09,260
have that password<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the user you</font><font color="#E5E5E5"> can</font>

320
00:12:07,279 --> 00:12:11,810
pull<font color="#CCCCCC"> that out in</font><font color="#E5E5E5"> clear text</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can also</font>

321
00:12:09,260 --> 00:12:15,589
dump the keychain out into a text file

322
00:12:11,810 --> 00:12:17,540
<font color="#CCCCCC">so</font><font color="#E5E5E5"> Apple does have a nice little pop-up</font>

323
00:12:15,589 --> 00:12:19,550
box that<font color="#CCCCCC"> comes up and says hey</font><font color="#E5E5E5"> this</font>

324
00:12:17,540 --> 00:12:22,160
<font color="#CCCCCC">program wants</font><font color="#E5E5E5"> to get</font><font color="#CCCCCC"> access to</font><font color="#E5E5E5"> your</font>

325
00:12:19,550 --> 00:12:23,569
keychain<font color="#E5E5E5"> is that cool</font><font color="#CCCCCC"> and you can't</font>

326
00:12:22,160 --> 00:12:25,670
actually interact<font color="#CCCCCC"> with that through</font>

327
00:12:23,570 --> 00:12:28,130
Apple script anymore<font color="#E5E5E5"> you used to be able</font>

328
00:12:25,670 --> 00:12:29,990
<font color="#E5E5E5">to there have been some bypasses using</font>

329
00:12:28,130 --> 00:12:31,519
things like<font color="#CCCCCC"> Mouse keys which is like an</font>

330
00:12:29,990 --> 00:12:32,870
accessibility thing where you can move

331
00:12:31,519 --> 00:12:35,209
the mouse around<font color="#CCCCCC"> with you keyboard and</font>

332
00:12:32,870 --> 00:12:37,630
click but some of those have<font color="#E5E5E5"> been</font>

333
00:12:35,209 --> 00:12:39,890
patched<font color="#CCCCCC"> but if you have an old</font><font color="#E5E5E5"> system</font>

334
00:12:37,630 --> 00:12:41,420
<font color="#CCCCCC">definitely watch out for this</font><font color="#E5E5E5"> as you</font><font color="#CCCCCC"> can</font>

335
00:12:39,890 --> 00:12:44,420
<font color="#E5E5E5">you can do a lot of people</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> it</font>

336
00:12:41,420 --> 00:12:46,339
um<font color="#CCCCCC"> the easier way to</font><font color="#E5E5E5"> into to mess with</font>

337
00:12:44,420 --> 00:12:48,349
the keychain<font color="#CCCCCC"> it's just to steal it so</font>

338
00:12:46,339 --> 00:12:50,120
you can<font color="#E5E5E5"> just copy</font><font color="#CCCCCC"> that file</font><font color="#E5E5E5"> move it</font><font color="#CCCCCC"> on</font>

339
00:12:48,350 --> 00:12:53,209
<font color="#CCCCCC">to</font><font color="#E5E5E5"> another Mac you can just open it up</font>

340
00:12:50,120 --> 00:12:54,410
in<font color="#E5E5E5"> the keychain</font><font color="#CCCCCC"> utility it's going to</font>

341
00:12:53,209 --> 00:12:56,359
say hey what's the password<font color="#E5E5E5"> for this</font>

342
00:12:54,410 --> 00:12:58,130
keychain<font color="#CCCCCC"> you give it</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> them you have</font>

343
00:12:56,360 --> 00:13:00,829
<font color="#E5E5E5">the entire keychain all of the passwords</font>

344
00:12:58,130 --> 00:13:03,830
<font color="#CCCCCC">in</font><font color="#E5E5E5"> clear-text</font><font color="#CCCCCC"> all the the</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> the</font>

345
00:13:00,829 --> 00:13:07,109
locations that<font color="#E5E5E5"> they're accessing</font><font color="#CCCCCC"> etc</font>

346
00:13:03,830 --> 00:13:09,510
so<font color="#E5E5E5"> looking for any kind of process that</font>

347
00:13:07,110 --> 00:13:11,730
<font color="#CCCCCC">is referencing one of those</font><font color="#E5E5E5"> keychain</font>

348
00:13:09,510 --> 00:13:13,260
databases<font color="#E5E5E5"> is a great way to find someone</font>

349
00:13:11,730 --> 00:13:14,580
trying to<font color="#CCCCCC"> through monkey</font><font color="#E5E5E5"> with us or just</font>

350
00:13:13,260 --> 00:13:16,170
looking for<font color="#CCCCCC"> any kind</font><font color="#E5E5E5"> of file</font>

351
00:13:14,580 --> 00:13:20,760
modification<font color="#E5E5E5"> to to one of these</font>

352
00:13:16,170 --> 00:13:22,589
<font color="#E5E5E5">databases</font><font color="#CCCCCC"> a great way to catch this all</font>

353
00:13:20,760 --> 00:13:24,840
<font color="#CCCCCC">right so lateral movements</font><font color="#E5E5E5"> so moving</font>

354
00:13:22,590 --> 00:13:26,490
from<font color="#E5E5E5"> one space to</font><font color="#CCCCCC"> another you're</font>

355
00:13:24,840 --> 00:13:28,590
probably familiar with<font color="#E5E5E5"> PS exec if you've</font>

356
00:13:26,490 --> 00:13:29,940
done anything with Windows systems it's

357
00:13:28,590 --> 00:13:32,280
a great administrative tool it's a great

358
00:13:29,940 --> 00:13:33,810
tool for running code on other<font color="#E5E5E5"> machines</font>

359
00:13:32,280 --> 00:13:35,880
as long as you have admin it's a great

360
00:13:33,810 --> 00:13:38,640
way to escalate yourself to system on

361
00:13:35,880 --> 00:13:40,439
any<font color="#CCCCCC"> machine you want so some of</font><font color="#E5E5E5"> that</font>

362
00:13:38,640 --> 00:13:42,360
<font color="#CCCCCC">functionality</font><font color="#E5E5E5"> you can find in Apple</font>

363
00:13:40,440 --> 00:13:46,470
script<font color="#E5E5E5"> again because</font><font color="#CCCCCC"> Apple script can do</font>

364
00:13:42,360 --> 00:13:49,980
everything<font color="#E5E5E5"> so here is a remote command</font>

365
00:13:46,470 --> 00:13:52,170
to open<font color="#CCCCCC"> up a terminal</font><font color="#E5E5E5"> SSH into another</font>

366
00:13:49,980 --> 00:13:55,260
system<font color="#CCCCCC"> and then run a script</font><font color="#E5E5E5"> on that</font>

367
00:13:52,170 --> 00:13:58,050
system<font color="#CCCCCC"> now you might say like why would</font>

368
00:13:55,260 --> 00:14:00,270
I<font color="#E5E5E5"> not just SSH natively</font><font color="#CCCCCC"> you can pass</font>

369
00:13:58,050 --> 00:14:01,800
like a bajillion systems into this one

370
00:14:00,270 --> 00:14:03,300
so if<font color="#E5E5E5"> you if you want to run through</font>

371
00:14:01,800 --> 00:14:05,069
every<font color="#CCCCCC"> single system</font><font color="#E5E5E5"> you think you might</font>

372
00:14:03,300 --> 00:14:09,120
<font color="#E5E5E5">have access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> it's very simple to</font>

373
00:14:05,070 --> 00:14:13,080
script<font color="#E5E5E5"> that through this so here is an</font>

374
00:14:09,120 --> 00:14:15,060
example<font color="#E5E5E5"> so the terminal boxes are on</font><font color="#CCCCCC"> the</font>

375
00:14:13,080 --> 00:14:18,300
host machine<font color="#E5E5E5"> the</font><font color="#CCCCCC"> other the underlying</font>

376
00:14:15,060 --> 00:14:20,130
box is a separate VM<font color="#E5E5E5"> so we've popped up</font>

377
00:14:18,300 --> 00:14:22,170
this terminal prompted for a password

378
00:14:20,130 --> 00:14:24,510
which you<font color="#E5E5E5"> could pass via Apple script if</font>

379
00:14:22,170 --> 00:14:26,189
you want to do it in clear text<font color="#CCCCCC"> we call</font>

380
00:14:24,510 --> 00:14:29,880
the application and now we have

381
00:14:26,190 --> 00:14:31,590
calculator on the victim machine<font color="#E5E5E5"> that</font>

382
00:14:29,880 --> 00:14:32,850
could<font color="#E5E5E5"> be anything</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> could run any you</font>

383
00:14:31,590 --> 00:14:36,210
could run any shell script you wanted to

384
00:14:32,850 --> 00:14:40,560
any Python<font color="#E5E5E5"> script etc etc so</font><font color="#CCCCCC"> a lot of</font>

385
00:14:36,210 --> 00:14:43,290
opportunity for bad behavior there<font color="#CCCCCC"> once</font>

386
00:14:40,560 --> 00:14:44,640
you have gotten<font color="#CCCCCC"> that</font><font color="#E5E5E5"> kind of access</font><font color="#CCCCCC"> you</font>

387
00:14:43,290 --> 00:14:47,490
<font color="#CCCCCC">can actually</font><font color="#E5E5E5"> make it</font><font color="#CCCCCC"> a little bit easier</font>

388
00:14:44,640 --> 00:14:50,280
<font color="#CCCCCC">so you can enable</font><font color="#E5E5E5"> what they call remote</font>

389
00:14:47,490 --> 00:14:52,350
<font color="#E5E5E5">Apple events so basically</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> tells the</font>

390
00:14:50,280 --> 00:14:54,750
<font color="#CCCCCC">system hey listen out for</font><font color="#E5E5E5"> any kind of</font>

391
00:14:52,350 --> 00:14:57,660
Apple script from remote systems<font color="#E5E5E5"> you can</font>

392
00:14:54,750 --> 00:14:59,940
secure<font color="#CCCCCC"> that to a single user or you can</font>

393
00:14:57,660 --> 00:15:01,140
just say every user<font color="#CCCCCC"> by default and it's</font>

394
00:14:59,940 --> 00:15:03,450
an<font color="#CCCCCC"> Apple script which is</font><font color="#E5E5E5"> kind of</font>

395
00:15:01,140 --> 00:15:04,740
horrifying<font color="#CCCCCC"> but</font><font color="#E5E5E5"> once you have that now</font>

396
00:15:03,450 --> 00:15:07,020
you can do something like<font color="#E5E5E5"> this come in</font>

397
00:15:04,740 --> 00:15:09,540
here where it says hey tell this

398
00:15:07,020 --> 00:15:11,970
application<font color="#E5E5E5"> of this remote system to do</font>

399
00:15:09,540 --> 00:15:13,170
a thing<font color="#E5E5E5"> and that can</font><font color="#CCCCCC"> be literally</font>

400
00:15:11,970 --> 00:15:15,000
<font color="#E5E5E5">anything you can think up you can just</font>

401
00:15:13,170 --> 00:15:15,689
say hey<font color="#E5E5E5"> tell it to run a shell to open</font>

402
00:15:15,000 --> 00:15:18,840
up a reverse

403
00:15:15,690 --> 00:15:21,900
you know<font color="#E5E5E5"> reverse shell back to my c2 etc</font>

404
00:15:18,840 --> 00:15:24,330
um and then down there<font color="#E5E5E5"> and that's where</font>

405
00:15:21,900 --> 00:15:26,520
<font color="#E5E5E5">the remote Apple events can</font><font color="#CCCCCC"> be toggled</font>

406
00:15:24,330 --> 00:15:28,860
<font color="#E5E5E5">on and off you can also with the</font>

407
00:15:26,520 --> 00:15:32,900
<font color="#CCCCCC">kickstart utility</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> also turn</font><font color="#E5E5E5"> that</font>

408
00:15:28,860 --> 00:15:32,900
<font color="#E5E5E5">on remotely through like an SSH session</font>

409
00:15:33,410 --> 00:15:39,810
<font color="#CCCCCC">so a</font><font color="#E5E5E5"> couple ideas defection ideas</font><font color="#CCCCCC"> so</font>

410
00:15:37,860 --> 00:15:41,250
looking<font color="#E5E5E5"> for any kind of</font><font color="#CCCCCC"> OSA</font><font color="#E5E5E5"> script with</font>

411
00:15:39,810 --> 00:15:42,449
network connections<font color="#E5E5E5"> for the most part</font>

412
00:15:41,250 --> 00:15:45,120
these things are going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be localized</font>

413
00:15:42,450 --> 00:15:46,950
<font color="#E5E5E5">to the system</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can also look for any</font>

414
00:15:45,120 --> 00:15:49,290
any of those that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> passing a do</font>

415
00:15:46,950 --> 00:15:51,810
script or do shell script<font color="#E5E5E5"> on the command</font>

416
00:15:49,290 --> 00:15:54,329
<font color="#CCCCCC">line because</font><font color="#E5E5E5"> that's you can you can wrap</font>

417
00:15:51,810 --> 00:15:56,969
a you can wrap a command<font color="#E5E5E5"> in</font><font color="#CCCCCC"> python in</font>

418
00:15:54,330 --> 00:15:59,550
bash in<font color="#CCCCCC"> OC script</font><font color="#E5E5E5"> like have multiple</font>

419
00:15:56,970 --> 00:16:03,900
layers<font color="#CCCCCC"> to really</font><font color="#E5E5E5"> obvious</font><font color="#CCCCCC"> kate what</font>

420
00:15:59,550 --> 00:16:06,900
you're doing so a couple<font color="#E5E5E5"> of things on</font>

421
00:16:03,900 --> 00:16:09,810
persistence so we'll look at<font color="#E5E5E5"> startup</font>

422
00:16:06,900 --> 00:16:11,160
folders<font color="#E5E5E5"> if you're familiar</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> like the</font>

423
00:16:09,810 --> 00:16:12,869
startup<font color="#E5E5E5"> folder on Windows you drop a</font>

424
00:16:11,160 --> 00:16:15,180
binary into it<font color="#CCCCCC"> it starts up with the</font>

425
00:16:12,870 --> 00:16:17,790
system there's a there's a library<font color="#CCCCCC"> start</font>

426
00:16:15,180 --> 00:16:19,650
<font color="#CCCCCC">up</font><font color="#E5E5E5"> items that's been deprecated and it</font>

427
00:16:17,790 --> 00:16:22,290
doesn't exist on new<font color="#E5E5E5"> systems but you can</font>

428
00:16:19,650 --> 00:16:24,420
create<font color="#E5E5E5"> it and it's still you</font><font color="#CCCCCC"> know Apple</font>

429
00:16:22,290 --> 00:16:27,089
still<font color="#E5E5E5"> honors it they're like oh I</font><font color="#CCCCCC"> need</font>

430
00:16:24,420 --> 00:16:29,130
<font color="#CCCCCC">to do this thing so any</font><font color="#E5E5E5"> kind of file</font>

431
00:16:27,090 --> 00:16:30,660
modification to<font color="#CCCCCC"> that folder is suspect</font>

432
00:16:29,130 --> 00:16:32,460
<font color="#E5E5E5">because you either have some very old</font>

433
00:16:30,660 --> 00:16:34,699
<font color="#E5E5E5">software or you have someone who's</font>

434
00:16:32,460 --> 00:16:38,040
trying<font color="#E5E5E5"> to do something they shouldn't do</font>

435
00:16:34,700 --> 00:16:39,420
<font color="#E5E5E5">services kind of similar to to launch</font>

436
00:16:38,040 --> 00:16:41,339
daemon so launch demons are not

437
00:16:39,420 --> 00:16:43,979
dependent<font color="#CCCCCC"> on a user being logged in</font><font color="#E5E5E5"> they</font>

438
00:16:41,340 --> 00:16:46,170
just<font color="#E5E5E5"> kind of run</font><font color="#CCCCCC"> on their own which is</font>

439
00:16:43,980 --> 00:16:47,610
<font color="#CCCCCC">different than launch</font><font color="#E5E5E5"> agents which are</font>

440
00:16:46,170 --> 00:16:50,280
kind of<font color="#E5E5E5"> more like run keys</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> run once</font>

441
00:16:47,610 --> 00:16:52,170
keys<font color="#E5E5E5"> which can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> associated with an</font>

442
00:16:50,280 --> 00:16:54,480
individual user or<font color="#E5E5E5"> any user the logs on</font>

443
00:16:52,170 --> 00:16:56,819
the<font color="#E5E5E5"> box</font><font color="#CCCCCC"> so somebody logs in these this</font>

444
00:16:54,480 --> 00:16:58,260
launch agent<font color="#E5E5E5"> starts and it can be</font>

445
00:16:56,820 --> 00:17:00,870
<font color="#E5E5E5">restricted to a</font><font color="#CCCCCC"> specific user</font><font color="#E5E5E5"> if you</font>

446
00:16:58,260 --> 00:17:03,230
want and then you have scheduled<font color="#E5E5E5"> tasks</font>

447
00:17:00,870 --> 00:17:05,339
<font color="#E5E5E5">cron jobs again for the links world</font>

448
00:17:03,230 --> 00:17:07,349
<font color="#CCCCCC">schedule anything you want to run at</font>

449
00:17:05,339 --> 00:17:09,899
whatever<font color="#E5E5E5"> time every user has their own</font>

450
00:17:07,349 --> 00:17:11,069
cron job<font color="#E5E5E5"> so if you log in as</font><font color="#CCCCCC"> root</font><font color="#E5E5E5"> and</font>

451
00:17:09,900 --> 00:17:13,590
you say let me<font color="#E5E5E5"> look at my crontab</font>

452
00:17:11,069 --> 00:17:15,270
<font color="#E5E5E5">there's no jobs there's no remote tasks</font>

453
00:17:13,589 --> 00:17:17,189
everything there's no<font color="#E5E5E5"> scheduled tasks</font>

454
00:17:15,270 --> 00:17:19,230
<font color="#CCCCCC">not</font><font color="#E5E5E5"> necessarily true because every user</font>

455
00:17:17,190 --> 00:17:20,220
could individually<font color="#E5E5E5"> have their own so you</font>

456
00:17:19,230 --> 00:17:21,980
have to kind<font color="#CCCCCC"> of iterate through all</font>

457
00:17:20,220 --> 00:17:26,030
<font color="#E5E5E5">those cron</font><font color="#CCCCCC"> tabs</font>

458
00:17:21,980 --> 00:17:27,530
and then<font color="#CCCCCC"> launched</font><font color="#E5E5E5"> CTL is it's kind of an</font>

459
00:17:26,030 --> 00:17:29,330
<font color="#E5E5E5">interesting persistence mechanism</font>

460
00:17:27,530 --> 00:17:31,428
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it allows you to run</font><font color="#E5E5E5"> a</font>

461
00:17:29,330 --> 00:17:33,049
persistent job<font color="#CCCCCC"> that will</font><font color="#E5E5E5"> kind of</font>

462
00:17:31,429 --> 00:17:36,530
disappear once you reboot the system

463
00:17:33,049 --> 00:17:39,740
so what this<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like I'm going</font><font color="#E5E5E5"> to</font>

464
00:17:36,530 --> 00:17:41,840
start a job for<font color="#E5E5E5"> a</font><font color="#CCCCCC"> non-evil PI script</font>

465
00:17:39,740 --> 00:17:43,460
just<font color="#E5E5E5"> this pops up a box that says hey</font>

466
00:17:41,840 --> 00:17:45,080
<font color="#CCCCCC">pythons run it on your machine</font>

467
00:17:43,460 --> 00:17:48,020
I'm not going<font color="#E5E5E5"> to execute anything else</font><font color="#CCCCCC"> I</font>

468
00:17:45,080 --> 00:17:50,799
<font color="#E5E5E5">close that and it's going</font><font color="#CCCCCC"> through pop</font>

469
00:17:48,020 --> 00:17:53,000
back<font color="#E5E5E5"> up and it</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> just keep doing that</font>

470
00:17:50,799 --> 00:17:54,770
<font color="#E5E5E5">perpetually until you either remove the</font>

471
00:17:53,000 --> 00:17:56,510
job or you<font color="#E5E5E5"> bounce the box so if you have</font>

472
00:17:54,770 --> 00:17:59,389
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> you want to</font><font color="#E5E5E5"> run on a</font>

473
00:17:56,510 --> 00:18:01,820
victim machine<font color="#CCCCCC"> you want it to run</font><font color="#E5E5E5"> till</font>

474
00:17:59,390 --> 00:18:02,750
it's complete<font color="#E5E5E5"> that's a it's a good</font>

475
00:18:01,820 --> 00:18:04,040
opportunity<font color="#CCCCCC"> because then you don't</font><font color="#E5E5E5"> have</font>

476
00:18:02,750 --> 00:18:07,940
to<font color="#E5E5E5"> clean up behind yourself it just kind</font>

477
00:18:04,040 --> 00:18:09,159
of<font color="#CCCCCC"> disappears alright so we've gone</font>

478
00:18:07,940 --> 00:18:11,570
through some<font color="#E5E5E5"> of this tradecraft</font>

479
00:18:09,160 --> 00:18:13,580
what are<font color="#E5E5E5"> some tools that</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> use to</font>

480
00:18:11,570 --> 00:18:16,549
<font color="#E5E5E5">start collecting</font><font color="#CCCCCC"> the information</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> os</font>

481
00:18:13,580 --> 00:18:19,850
query is a popular utility developed by

482
00:18:16,549 --> 00:18:22,760
Facebook<font color="#CCCCCC"> it's it's used to retroactively</font>

483
00:18:19,850 --> 00:18:24,320
Lee query systems<font color="#CCCCCC"> so basically it's</font>

484
00:18:22,760 --> 00:18:26,600
<font color="#CCCCCC">looking for files on disk</font><font color="#E5E5E5"> for</font>

485
00:18:24,320 --> 00:18:28,159
configuration<font color="#E5E5E5"> files</font><font color="#CCCCCC"> etc</font><font color="#E5E5E5"> it's not really</font>

486
00:18:26,600 --> 00:18:29,990
<font color="#E5E5E5">great for</font><font color="#CCCCCC"> real-time monitoring</font><font color="#E5E5E5"> but it's</font>

487
00:18:28,160 --> 00:18:32,690
an<font color="#E5E5E5"> excellent tool for gathering forensic</font>

488
00:18:29,990 --> 00:18:34,460
evidence<font color="#CCCCCC"> it's local by default but</font><font color="#E5E5E5"> you</font>

489
00:18:32,690 --> 00:18:36,260
can<font color="#E5E5E5"> use something like file B or like a</font>

490
00:18:34,460 --> 00:18:40,640
<font color="#CCCCCC">spawn forwarder to</font><font color="#E5E5E5"> take that and shove</font>

491
00:18:36,260 --> 00:18:43,100
<font color="#E5E5E5">those logs up elsewhere</font><font color="#CCCCCC"> super audit is</font>

492
00:18:40,640 --> 00:18:46,370
another this was developed<font color="#CCCCCC"> by</font><font color="#E5E5E5"> Jonathan</font>

493
00:18:43,100 --> 00:18:50,540
<font color="#E5E5E5">Levin</font><font color="#CCCCCC"> super-bright</font><font color="#E5E5E5"> Mac OS guy</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

494
00:18:46,370 --> 00:18:53,689
<font color="#CCCCCC">real-time</font><font color="#E5E5E5"> monitoring</font><font color="#CCCCCC"> it collects process</font>

495
00:18:50,540 --> 00:18:55,730
file modifications net cons all that

496
00:18:53,690 --> 00:18:58,160
good stuff<font color="#CCCCCC"> it can be syslog about or</font>

497
00:18:55,730 --> 00:19:00,799
kept<font color="#CCCCCC"> locally you</font><font color="#E5E5E5"> can keep it in JSON or</font>

498
00:18:58,160 --> 00:19:03,470
in the format you<font color="#E5E5E5"> see down</font><font color="#CCCCCC"> there it's a</font>

499
00:19:00,799 --> 00:19:05,330
<font color="#E5E5E5">really excellent tool it's free for like</font>

500
00:19:03,470 --> 00:19:08,059
a handful systems<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> closed source but</font>

501
00:19:05,330 --> 00:19:09,620
it is it is<font color="#CCCCCC"> a really neat</font><font color="#E5E5E5"> tool if you</font>

502
00:19:08,059 --> 00:19:13,129
only have a handful of Mac<font color="#E5E5E5"> devices to</font>

503
00:19:09,620 --> 00:19:15,590
monitor<font color="#E5E5E5"> this is a great</font><font color="#CCCCCC"> option and</font><font color="#E5E5E5"> then</font>

504
00:19:13,130 --> 00:19:17,059
<font color="#CCCCCC">Nouman is is like</font><font color="#E5E5E5"> the newest contender</font>

505
00:19:15,590 --> 00:19:19,760
<font color="#CCCCCC">that came</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> earlier this year at a</font>

506
00:19:17,059 --> 00:19:21,500
conference<font color="#E5E5E5"> that's it's an open source</font>

507
00:19:19,760 --> 00:19:24,740
<font color="#E5E5E5">project</font><font color="#CCCCCC"> they're still</font><font color="#E5E5E5"> building it out</font>

508
00:19:21,500 --> 00:19:27,320
it's meant to<font color="#CCCCCC"> be kind</font><font color="#E5E5E5"> of a system on for</font>

509
00:19:24,740 --> 00:19:29,210
<font color="#E5E5E5">Mac so right now it's primarily process</font>

510
00:19:27,320 --> 00:19:31,490
<font color="#CCCCCC">related events they have recently added</font>

511
00:19:29,210 --> 00:19:34,190
some<font color="#CCCCCC"> Network events so that's one to</font>

512
00:19:31,490 --> 00:19:35,480
watch as well and a couple<font color="#CCCCCC"> other useful</font>

513
00:19:34,190 --> 00:19:37,519
tools

514
00:19:35,480 --> 00:19:40,220
so<font color="#CCCCCC"> ab dev has</font><font color="#E5E5E5"> Little Snitch which is</font>

515
00:19:37,519 --> 00:19:42,889
probably<font color="#E5E5E5"> the most popular firewall for</font>

516
00:19:40,220 --> 00:19:44,149
Mac systems<font color="#E5E5E5"> process-oriented so every</font>

517
00:19:42,889 --> 00:19:45,529
process that wants to make<font color="#CCCCCC"> a network</font>

518
00:19:44,149 --> 00:19:47,449
<font color="#E5E5E5">connection if it's not</font><font color="#CCCCCC"> already allowed</font>

519
00:19:45,529 --> 00:19:50,809
by some rule<font color="#E5E5E5"> is gonna say hey you know</font>

520
00:19:47,450 --> 00:19:53,480
like your<font color="#E5E5E5"> DNS resolver wants to talk to</font>

521
00:19:50,809 --> 00:19:55,580
<font color="#CCCCCC">this</font><font color="#E5E5E5"> thing now or you know your your</font>

522
00:19:53,480 --> 00:19:57,130
shell your<font color="#E5E5E5"> shell wants to talk</font><font color="#CCCCCC"> to this</font>

523
00:19:55,580 --> 00:19:59,928
Russian<font color="#CCCCCC"> web site or</font><font color="#E5E5E5"> something like that</font>

524
00:19:57,130 --> 00:20:01,880
so it's a great way to find evil stuff

525
00:19:59,929 --> 00:20:03,620
and knock it out early<font color="#CCCCCC"> Micro stitch is</font>

526
00:20:01,880 --> 00:20:06,440
another cool<font color="#E5E5E5"> one actually monitors your</font>

527
00:20:03,620 --> 00:20:08,479
microphone and<font color="#E5E5E5"> your</font><font color="#CCCCCC"> camera</font><font color="#E5E5E5"> so if one of</font>

528
00:20:06,440 --> 00:20:12,019
<font color="#CCCCCC">those</font><font color="#E5E5E5"> things goes hot it will tell you</font>

529
00:20:08,480 --> 00:20:13,399
<font color="#E5E5E5">by either giving you ears or eyes</font><font color="#CCCCCC"> which</font>

530
00:20:12,019 --> 00:20:14,960
is nice<font color="#E5E5E5"> because if you're not expecting</font>

531
00:20:13,399 --> 00:20:18,709
<font color="#CCCCCC">your camera to go hot and it goes hot</font>

532
00:20:14,960 --> 00:20:20,090
<font color="#E5E5E5">it's kind of terrifying</font><font color="#CCCCCC"> so and then</font>

533
00:20:18,710 --> 00:20:23,360
<font color="#E5E5E5">objective-c I mentioned Patrick</font><font color="#CCCCCC"> Portal</font>

534
00:20:20,090 --> 00:20:25,668
earlier<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> dial-up hijack scanner</font>

535
00:20:23,360 --> 00:20:27,080
<font color="#E5E5E5">it's a great tool</font><font color="#CCCCCC"> knock knock is is</font>

536
00:20:25,669 --> 00:20:29,830
something<font color="#CCCCCC"> that checks like cron jobs</font>

537
00:20:27,080 --> 00:20:33,168
checks other<font color="#E5E5E5"> persistence mechanisms etc</font>

538
00:20:29,830 --> 00:20:36,379
and then last<font color="#E5E5E5"> I created a little tool</font>

539
00:20:33,169 --> 00:20:40,010
<font color="#E5E5E5">called Macintosh</font><font color="#CCCCCC"> it's open source</font>

540
00:20:36,380 --> 00:20:42,500
it is super alpha it<font color="#E5E5E5"> is basically the</font>

541
00:20:40,010 --> 00:20:45,049
idea<font color="#CCCCCC"> is if you</font><font color="#E5E5E5"> have if you're handed a</font>

542
00:20:42,500 --> 00:20:46,309
<font color="#CCCCCC">Mac system and it's like hey like see if</font>

543
00:20:45,049 --> 00:20:48,679
anything's going<font color="#E5E5E5"> on with this or</font><font color="#CCCCCC"> you</font>

544
00:20:46,309 --> 00:20:50,720
you're responsible<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> thing now it</font>

545
00:20:48,679 --> 00:20:51,919
might<font color="#E5E5E5"> take you a while</font><font color="#CCCCCC"> to get approval</font>

546
00:20:50,720 --> 00:20:53,870
for<font color="#E5E5E5"> some of these other tools to install</font>

547
00:20:51,919 --> 00:20:55,909
across your network<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is just a shell</font>

548
00:20:53,870 --> 00:20:58,219
script<font color="#E5E5E5"> it has no other dependencies</font><font color="#CCCCCC"> you</font>

549
00:20:55,909 --> 00:20:59,870
<font color="#CCCCCC">can run it just uses like basic</font>

550
00:20:58,220 --> 00:21:02,059
command-line tools to collect<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font>

551
00:20:59,870 --> 00:21:03,289
this<font color="#E5E5E5"> evidence and throw it to a file for</font>

552
00:21:02,059 --> 00:21:05,539
you so it's a great way just<font color="#E5E5E5"> to kind of</font>

553
00:21:03,289 --> 00:21:07,820
get<font color="#CCCCCC"> a snapshot of</font><font color="#E5E5E5"> like this is what I'm</font>

554
00:21:05,539 --> 00:21:10,100
working<font color="#E5E5E5"> with so the idea is like tell</font><font color="#CCCCCC"> me</font>

555
00:21:07,820 --> 00:21:12,350
the users tell me the the groups<font color="#E5E5E5"> that</font>

556
00:21:10,100 --> 00:21:13,840
exist<font color="#E5E5E5"> on the machine what kind of</font>

557
00:21:12,350 --> 00:21:16,100
security<font color="#E5E5E5"> software do they have running</font>

558
00:21:13,840 --> 00:21:18,769
<font color="#E5E5E5">if</font><font color="#CCCCCC"> there any kind of possible</font><font color="#E5E5E5"> compromise</font>

559
00:21:16,100 --> 00:21:20,870
<font color="#E5E5E5">is there any weird cron jobs or any kind</font>

560
00:21:18,769 --> 00:21:23,600
of<font color="#E5E5E5"> weird launch agents or demons that</font>

561
00:21:20,870 --> 00:21:24,768
<font color="#E5E5E5">are out there so the idea is just run</font>

562
00:21:23,600 --> 00:21:26,480
<font color="#E5E5E5">this it'll iterate through all that</font>

563
00:21:24,769 --> 00:21:28,010
stuff<font color="#E5E5E5"> and it'll give</font><font color="#CCCCCC"> you a nice little</font>

564
00:21:26,480 --> 00:21:30,380
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> to start</font><font color="#E5E5E5"> out with say hey okay</font><font color="#CCCCCC"> I</font>

565
00:21:28,010 --> 00:21:34,760
know where I stand<font color="#CCCCCC"> now</font><font color="#E5E5E5"> so you can find</font>

566
00:21:30,380 --> 00:21:35,960
that at<font color="#CCCCCC"> the github</font><font color="#E5E5E5"> thing below</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

567
00:21:34,760 --> 00:21:37,700
what it looks<font color="#E5E5E5"> like</font><font color="#CCCCCC"> it's just</font><font color="#E5E5E5"> right now</font>

568
00:21:35,960 --> 00:21:38,809
like I<font color="#E5E5E5"> said it's very alpha</font><font color="#CCCCCC"> so it just</font>

569
00:21:37,700 --> 00:21:40,940
kind of runs<font color="#E5E5E5"> through and says hey I'm</font>

570
00:21:38,809 --> 00:21:43,580
<font color="#CCCCCC">gonna do all these things</font><font color="#E5E5E5"> and then it</font>

571
00:21:40,940 --> 00:21:45,409
drops a file in<font color="#CCCCCC"> temple</font><font color="#E5E5E5"> and then you can</font>

572
00:21:43,580 --> 00:21:47,649
go and see the<font color="#E5E5E5"> code for yourself</font>

573
00:21:45,409 --> 00:21:51,320
don't judge me<font color="#E5E5E5"> I'm not good at it</font>

574
00:21:47,649 --> 00:22:04,428
<font color="#E5E5E5">all right so I got that was like</font>

575
00:21:51,320 --> 00:22:07,189
<font color="#CCCCCC">marathon yes it's kind of noisy yeah</font>

576
00:22:04,429 --> 00:22:09,679
<font color="#CCCCCC">cause like there's yeah</font><font color="#E5E5E5"> oh sorry yes so</font>

577
00:22:07,190 --> 00:22:11,119
the the<font color="#CCCCCC"> question was</font><font color="#E5E5E5"> if I just look for</font>

578
00:22:09,679 --> 00:22:13,009
<font color="#E5E5E5">oh so script is that</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be really</font>

579
00:22:11,119 --> 00:22:15,408
<font color="#CCCCCC">noisy and the answer is</font><font color="#E5E5E5"> yes because</font>

580
00:22:13,009 --> 00:22:17,329
there's a lot of<font color="#CCCCCC"> applications</font><font color="#E5E5E5"> including</font>

581
00:22:15,409 --> 00:22:19,279
like Microsoft<font color="#E5E5E5"> the whole Microsoft suite</font>

582
00:22:17,329 --> 00:22:23,029
<font color="#CCCCCC">oh and Mac uses Apple script pretty</font>

583
00:22:19,279 --> 00:22:25,759
pretty heavily<font color="#E5E5E5"> to like show you know</font>

584
00:22:23,029 --> 00:22:28,399
<font color="#E5E5E5">show boxes or to facilitate things on</font>

585
00:22:25,759 --> 00:22:30,349
the<font color="#CCCCCC"> backend</font><font color="#E5E5E5"> so yes it can be if you</font>

586
00:22:28,399 --> 00:22:31,458
leave it unqualified<font color="#E5E5E5"> but just like</font>

587
00:22:30,349 --> 00:22:32,958
anything else<font color="#E5E5E5"> like when you're building</font>

588
00:22:31,459 --> 00:22:34,249
detection<font color="#CCCCCC"> in your environment they're</font>

589
00:22:32,959 --> 00:22:35,599
going to be<font color="#CCCCCC"> too specific</font><font color="#E5E5E5"> to your</font>

590
00:22:34,249 --> 00:22:37,129
environment<font color="#CCCCCC"> so I can give</font><font color="#E5E5E5"> you like a</font>

591
00:22:35,599 --> 00:22:38,629
starting place like I<font color="#E5E5E5"> did</font><font color="#CCCCCC"> on some of</font>

592
00:22:37,129 --> 00:22:40,399
those<font color="#E5E5E5"> slides but for the most part</font><font color="#CCCCCC"> like</font>

593
00:22:38,629 --> 00:22:41,809
you're like you're<font color="#E5E5E5"> gonna know what's</font>

594
00:22:40,399 --> 00:22:42,889
<font color="#CCCCCC">gonna work in your</font><font color="#E5E5E5"> environment</font><font color="#CCCCCC"> some some</font>

595
00:22:41,809 --> 00:22:44,119
people<font color="#E5E5E5"> are not going to have software</font>

596
00:22:42,889 --> 00:22:45,708
that's gonna<font color="#CCCCCC"> that's going to be a noisy</font>

597
00:22:44,119 --> 00:23:05,570
detect for and they<font color="#E5E5E5"> can run that no</font>

598
00:22:45,709 --> 00:23:07,669
problem<font color="#E5E5E5"> yes sir so the question is like</font>

599
00:23:05,570 --> 00:23:11,479
<font color="#CCCCCC">what do we commonly see is an initial</font>

600
00:23:07,669 --> 00:23:14,029
vector for<font color="#CCCCCC"> Mac's so it's kind of the</font>

601
00:23:11,479 --> 00:23:16,749
same thing you see a lot of<font color="#E5E5E5"> places so so</font>

602
00:23:14,029 --> 00:23:20,659
malicious attachments is a common one

603
00:23:16,749 --> 00:23:22,249
<font color="#CCCCCC">drive-by downloads</font><font color="#E5E5E5"> one of the so</font><font color="#CCCCCC"> Ritchie</font>

604
00:23:20,659 --> 00:23:25,219
<font color="#E5E5E5">and his talk the</font><font color="#CCCCCC"> other day talked about</font>

605
00:23:22,249 --> 00:23:28,099
one of<font color="#E5E5E5"> the most common pieces of adware</font>

606
00:23:25,219 --> 00:23:29,959
<font color="#E5E5E5">slash gray</font><font color="#CCCCCC"> wear on systems is like the</font>

607
00:23:28,099 --> 00:23:31,789
flash because<font color="#E5E5E5"> it's you've got a</font><font color="#CCCCCC"> pop-up</font>

608
00:23:29,959 --> 00:23:33,259
<font color="#CCCCCC">say hey you</font><font color="#E5E5E5"> need to</font><font color="#CCCCCC"> install flash</font><font color="#E5E5E5"> you</font>

609
00:23:31,789 --> 00:23:35,658
click on the thing now you have some

610
00:23:33,259 --> 00:23:37,519
terrible<font color="#E5E5E5"> like tracking stuff on your</font>

611
00:23:35,659 --> 00:23:39,979
system so<font color="#E5E5E5"> yeah usually it's it's the</font>

612
00:23:37,519 --> 00:23:43,479
<font color="#E5E5E5">it's the common suspects it's</font><font color="#CCCCCC"> its email</font>

613
00:23:39,979 --> 00:23:43,479
<font color="#CCCCCC">it's drive-by download stuff</font>

614
00:23:53,900 --> 00:23:59,450
so so the<font color="#CCCCCC"> question is is are the good</font>

615
00:23:57,110 --> 00:24:01,850
<font color="#CCCCCC">preventative controls</font><font color="#E5E5E5"> for Mac and there</font>

616
00:23:59,450 --> 00:24:04,520
are I would I would<font color="#E5E5E5"> say the detection is</font>

617
00:24:01,850 --> 00:24:06,080
mandatory<font color="#CCCCCC"> and Prevention is a luxury so</font>

618
00:24:04,520 --> 00:24:07,309
being able<font color="#CCCCCC"> to detect</font><font color="#E5E5E5"> something you're</font>

619
00:24:06,080 --> 00:24:08,540
going<font color="#E5E5E5"> to be able to</font><font color="#CCCCCC"> cast a much wider</font>

620
00:24:07,309 --> 00:24:10,820
net<font color="#E5E5E5"> you're gonna be able to find</font>

621
00:24:08,540 --> 00:24:12,530
<font color="#E5E5E5">something that if you try to prevent</font>

622
00:24:10,820 --> 00:24:14,600
that<font color="#E5E5E5"> exact same thing you</font><font color="#CCCCCC"> might</font><font color="#E5E5E5"> like</font>

623
00:24:12,530 --> 00:24:17,780
take<font color="#E5E5E5"> business units down</font><font color="#CCCCCC"> but</font>

624
00:24:14,600 --> 00:24:19,909
specifically for<font color="#CCCCCC"> Mac preventatives</font><font color="#E5E5E5"> Sante</font>

625
00:24:17,780 --> 00:24:22,370
from Google<font color="#CCCCCC"> it's a great</font><font color="#E5E5E5"> white listing</font>

626
00:24:19,910 --> 00:24:24,320
utility<font color="#E5E5E5"> they have some really</font><font color="#CCCCCC"> cool you</font>

627
00:24:22,370 --> 00:24:26,389
know<font color="#E5E5E5"> configurations where you can allow</font>

628
00:24:24,320 --> 00:24:28,399
people<font color="#CCCCCC"> to up vote</font><font color="#E5E5E5"> like hey I'm running</font>

629
00:24:26,390 --> 00:24:29,990
<font color="#E5E5E5">this thing it's not allowed I want to</font>

630
00:24:28,400 --> 00:24:31,670
upload<font color="#CCCCCC"> it everyone else gets to vote on</font>

631
00:24:29,990 --> 00:24:33,950
and say yeah we<font color="#E5E5E5"> should allow</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so it</font>

632
00:24:31,670 --> 00:24:35,960
<font color="#E5E5E5">makes it a little bit easier</font><font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> a</font>

633
00:24:33,950 --> 00:24:41,050
that's a I'm a big<font color="#CCCCCC"> fan of</font><font color="#E5E5E5"> a polite</font>

634
00:24:35,960 --> 00:24:43,750
listening it's good control anybody<font color="#CCCCCC"> else</font>

635
00:24:41,050 --> 00:24:50,950
thank you guys

636
00:24:43,750 --> 00:24:50,950
[Applause]

