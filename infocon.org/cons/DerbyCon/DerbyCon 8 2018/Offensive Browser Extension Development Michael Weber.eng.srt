1
00:00:55,640 --> 00:01:02,489
<font color="#E5E5E5">all right it's uh it's just about</font><font color="#CCCCCC"> to so</font>

2
00:00:58,800 --> 00:01:04,709
I'm gonna dive into this<font color="#E5E5E5"> what's up folks</font>

3
00:01:02,489 --> 00:01:07,070
I'm Michael<font color="#CCCCCC"> Weber</font><font color="#E5E5E5"> and I'm here to talk</font>

4
00:01:04,709 --> 00:01:10,710
with<font color="#CCCCCC"> you today about offensive</font><font color="#E5E5E5"> browser</font>

5
00:01:07,070 --> 00:01:12,929
extension<font color="#CCCCCC"> development but first</font><font color="#E5E5E5"> Who am I</font>

6
00:01:10,710 --> 00:01:15,479
<font color="#CCCCCC">I'm a</font><font color="#E5E5E5"> security consultant for NCC group</font>

7
00:01:12,930 --> 00:01:18,000
<font color="#CCCCCC">I am not affiliated with Red Hat I</font><font color="#E5E5E5"> just</font>

8
00:01:15,479 --> 00:01:20,100
like this hat<font color="#CCCCCC"> I also like to break</font>

9
00:01:18,000 --> 00:01:21,990
<font color="#CCCCCC">things from time</font><font color="#E5E5E5"> to time</font><font color="#CCCCCC"> that stems</font><font color="#E5E5E5"> from</font>

10
00:01:20,100 --> 00:01:23,850
<font color="#E5E5E5">the fact that in a previous life I was</font>

11
00:01:21,990 --> 00:01:25,530
<font color="#CCCCCC">on the defense side</font><font color="#E5E5E5"> doing now</font><font color="#CCCCCC"> or reverse</font>

12
00:01:23,850 --> 00:01:27,000
engineering<font color="#E5E5E5"> until I got so frustrated</font>

13
00:01:25,530 --> 00:01:28,290
with it that I<font color="#E5E5E5"> decided I would try</font>

14
00:01:27,000 --> 00:01:29,850
offense for<font color="#E5E5E5"> a little bit and it's</font>

15
00:01:28,290 --> 00:01:33,270
actually a lot of<font color="#CCCCCC"> fun I'm pretty into it</font>

16
00:01:29,850 --> 00:01:35,460
it's good stuff<font color="#CCCCCC"> also my name</font><font color="#E5E5E5"> is little</font>

17
00:01:33,270 --> 00:01:38,280
<font color="#E5E5E5">common so I have to clarify</font><font color="#CCCCCC"> I am</font><font color="#E5E5E5"> NOT</font>

18
00:01:35,460 --> 00:01:40,679
Mike Weber from<font color="#E5E5E5"> coal fire</font><font color="#CCCCCC"> I am NOT</font>

19
00:01:38,280 --> 00:01:42,210
Michael<font color="#E5E5E5"> Weber from aspect security which</font>

20
00:01:40,680 --> 00:01:43,649
is<font color="#E5E5E5"> now owned by Ernst & Young I am NOT</font>

21
00:01:42,210 --> 00:01:46,320
Michael<font color="#E5E5E5"> Weber from the cyber security</font>

22
00:01:43,649 --> 00:01:48,509
area of Lockheed Martin<font color="#CCCCCC"> there are many</font>

23
00:01:46,320 --> 00:01:50,339
of us<font color="#CCCCCC"> in</font><font color="#E5E5E5"> security we are legion</font>

24
00:01:48,509 --> 00:01:51,899
if any of you are<font color="#E5E5E5"> here I'd be happy to</font>

25
00:01:50,340 --> 00:01:53,369
<font color="#E5E5E5">do some like Parent Trap style like</font>

26
00:01:51,899 --> 00:01:54,689
switcheroos maybe we love each other's

27
00:01:53,369 --> 00:01:58,469
life for a day or two<font color="#CCCCCC"> just</font><font color="#E5E5E5"> to see what</font>

28
00:01:54,689 --> 00:01:59,850
happens<font color="#CCCCCC"> I'd be cool but anyways we're</font>

29
00:01:58,469 --> 00:02:03,179
here to talk<font color="#CCCCCC"> about browser extensions</font>

30
00:01:59,850 --> 00:02:04,770
<font color="#E5E5E5">and what they are and if you do a google</font>

31
00:02:03,180 --> 00:02:06,060
image search<font color="#E5E5E5"> for browser extensions</font>

32
00:02:04,770 --> 00:02:07,679
<font color="#E5E5E5">you're gonna get like the smiley</font>

33
00:02:06,060 --> 00:02:09,390
espousal pieces that you've<font color="#E5E5E5"> ever seen</font>

34
00:02:07,680 --> 00:02:12,000
<font color="#E5E5E5">like dozens and dozens of puzzle pieces</font>

35
00:02:09,389 --> 00:02:13,220
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> kind of the shared nomenclature</font>

36
00:02:12,000 --> 00:02:15,680
we have<font color="#E5E5E5"> for plugins</font>

37
00:02:13,220 --> 00:02:17,840
and it's important to<font color="#CCCCCC"> note</font><font color="#E5E5E5"> these aren't</font>

38
00:02:15,680 --> 00:02:19,940
quite<font color="#E5E5E5"> plugins there's really only one</font>

39
00:02:17,840 --> 00:02:22,700
<font color="#CCCCCC">plug-in</font><font color="#E5E5E5"> that runs for your browser these</font>

40
00:02:19,940 --> 00:02:24,560
days which<font color="#E5E5E5"> is flash you can't compile</font>

41
00:02:22,700 --> 00:02:26,560
<font color="#E5E5E5">something</font><font color="#CCCCCC"> than C++ and then just have</font><font color="#E5E5E5"> it</font>

42
00:02:24,560 --> 00:02:29,560
interact<font color="#E5E5E5"> with your browser anymore</font>

43
00:02:26,560 --> 00:02:32,360
<font color="#CCCCCC">instead what we've got are these</font>

44
00:02:29,560 --> 00:02:34,040
extensions which can<font color="#E5E5E5"> extend and modify</font>

45
00:02:32,360 --> 00:02:35,570
the capability of<font color="#E5E5E5"> a browser that's the</font>

46
00:02:34,040 --> 00:02:37,340
<font color="#E5E5E5">official definition</font><font color="#CCCCCC"> I find it a little</font>

47
00:02:35,570 --> 00:02:40,430
<font color="#E5E5E5">weird to use the word to define itself</font>

48
00:02:37,340 --> 00:02:41,930
<font color="#E5E5E5">but that's how they describe it</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> in</font>

49
00:02:40,430 --> 00:02:44,480
practice<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> that they're like a</font>

50
00:02:41,930 --> 00:02:45,980
catch-all bucket<font color="#E5E5E5"> for</font><font color="#CCCCCC"> functionality that</font>

51
00:02:44,480 --> 00:02:47,359
we need to<font color="#CCCCCC"> kind of just like</font><font color="#E5E5E5"> hack on top</font>

52
00:02:45,980 --> 00:02:49,160
of the browser it provides a<font color="#E5E5E5"> lot of</font>

53
00:02:47,360 --> 00:02:51,230
<font color="#E5E5E5">extra functionality that the browser has</font>

54
00:02:49,160 --> 00:02:53,540
<font color="#E5E5E5">available to it and then makes it easy</font>

55
00:02:51,230 --> 00:02:55,010
for<font color="#CCCCCC"> everybody to use</font><font color="#E5E5E5"> users install these</font>

56
00:02:53,540 --> 00:02:57,470
things from like a browser specific

57
00:02:55,010 --> 00:02:59,450
storefront<font color="#CCCCCC"> or you side load them though</font>

58
00:02:57,470 --> 00:03:01,130
it's<font color="#E5E5E5"> kind of less common to side load</font>

59
00:02:59,450 --> 00:03:02,480
<font color="#E5E5E5">things now the number one way</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> all</font>

60
00:03:01,130 --> 00:03:03,560
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> providers want you to handle this</font>

61
00:03:02,480 --> 00:03:07,880
is they want you to install it<font color="#CCCCCC"> from a</font>

62
00:03:03,560 --> 00:03:09,920
store so the way that<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of this is</font>

63
00:03:07,880 --> 00:03:14,870
actually written<font color="#E5E5E5"> is a bunch of the</font>

64
00:03:09,920 --> 00:03:17,119
<font color="#E5E5E5">powers-that-be had a they reached a</font>

65
00:03:14,870 --> 00:03:19,400
consensus<font color="#E5E5E5"> on what shared behavior should</font>

66
00:03:17,120 --> 00:03:21,080
<font color="#CCCCCC">be</font><font color="#E5E5E5"> in browsers and they've exposed that</font>

67
00:03:19,400 --> 00:03:23,360
<font color="#E5E5E5">in the form of what they call the</font><font color="#CCCCCC"> web</font>

68
00:03:21,080 --> 00:03:25,850
extension API and this<font color="#E5E5E5"> is kind of a</font>

69
00:03:23,360 --> 00:03:30,230
shared API that's implemented<font color="#E5E5E5"> in part by</font>

70
00:03:25,850 --> 00:03:31,459
<font color="#CCCCCC">Chrome edged</font><font color="#E5E5E5"> opera and Firefox expose it</font>

71
00:03:30,230 --> 00:03:33,429
just a little more functionality than

72
00:03:31,459 --> 00:03:35,900
<font color="#E5E5E5">you get in your average</font><font color="#CCCCCC"> web application</font>

73
00:03:33,430 --> 00:03:37,250
<font color="#CCCCCC">the way I like to describe</font><font color="#E5E5E5"> it is imagine</font>

74
00:03:35,900 --> 00:03:39,530
that<font color="#CCCCCC"> you kind of got like cross-site</font>

75
00:03:37,250 --> 00:03:41,510
scripting for every<font color="#CCCCCC"> website that the</font>

76
00:03:39,530 --> 00:03:42,980
browser can<font color="#E5E5E5"> touch and you also have no</font>

77
00:03:41,510 --> 00:03:44,600
course policy so it's kind of like<font color="#CCCCCC"> a</font>

78
00:03:42,980 --> 00:03:47,480
supercharged cross-site scripting I

79
00:03:44,600 --> 00:03:49,280
think it's<font color="#E5E5E5"> really neat and the way that</font>

80
00:03:47,480 --> 00:03:51,950
you write these things it's entirely in

81
00:03:49,280 --> 00:03:53,390
<font color="#CCCCCC">JavaScript so</font><font color="#E5E5E5"> like everything</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> on</font>

82
00:03:51,950 --> 00:03:54,799
the web these days<font color="#E5E5E5"> javascript javascript</font>

83
00:03:53,390 --> 00:03:56,149
javascript<font color="#E5E5E5"> everything is a web</font>

84
00:03:54,800 --> 00:03:59,360
application<font color="#E5E5E5"> and that's how you write</font>

85
00:03:56,150 --> 00:04:01,540
extensions<font color="#CCCCCC"> - also given that</font><font color="#E5E5E5"> work here</font>

86
00:03:59,360 --> 00:04:03,890
<font color="#E5E5E5">in red teaming context</font><font color="#CCCCCC"> i do have</font><font color="#E5E5E5"> to say</font>

87
00:04:01,540 --> 00:04:05,870
there isn't exactly<font color="#E5E5E5"> the easiest way</font><font color="#CCCCCC"> to</font>

88
00:04:03,890 --> 00:04:07,488
execute<font color="#E5E5E5"> shell commands though</font><font color="#CCCCCC"> i saw that</font>

89
00:04:05,870 --> 00:04:08,600
there's a talk in about<font color="#E5E5E5"> two hours</font><font color="#CCCCCC"> which</font>

90
00:04:07,489 --> 00:04:10,430
is going<font color="#E5E5E5"> to tell</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that with</font>

91
00:04:08,600 --> 00:04:11,570
<font color="#E5E5E5">javascript so</font><font color="#CCCCCC"> i'm really</font><font color="#E5E5E5"> excited to see</font>

92
00:04:10,430 --> 00:04:14,300
<font color="#CCCCCC">that</font><font color="#E5E5E5"> because that will charge these</font>

93
00:04:11,570 --> 00:04:15,590
things up even<font color="#CCCCCC"> more it is worth noting</font>

94
00:04:14,300 --> 00:04:17,660
there something called native messaging

95
00:04:15,590 --> 00:04:19,668
that extension support which will let

96
00:04:17,660 --> 00:04:21,350
you do shell execution but<font color="#E5E5E5"> you need to</font>

97
00:04:19,668 --> 00:04:23,960
have<font color="#E5E5E5"> already</font><font color="#CCCCCC"> been</font><font color="#E5E5E5"> on the box and we'll</font>

98
00:04:21,350 --> 00:04:25,070
talk about<font color="#E5E5E5"> that later so different</font>

99
00:04:23,960 --> 00:04:27,109
browsers will<font color="#E5E5E5"> implement this</font>

100
00:04:25,070 --> 00:04:27,440
functionality<font color="#E5E5E5"> slightly differently</font><font color="#CCCCCC"> what</font>

101
00:04:27,110 --> 00:04:30,560
there's no

102
00:04:27,440 --> 00:04:32,630
a real totally shared<font color="#CCCCCC"> API so you can</font><font color="#E5E5E5"> go</font>

103
00:04:30,560 --> 00:04:34,940
to the<font color="#E5E5E5"> Mozilla web page and see these</font>

104
00:04:32,630 --> 00:04:36,980
<font color="#E5E5E5">big graphs of like</font><font color="#CCCCCC"> Oh Chrome does this</font>

105
00:04:34,940 --> 00:04:39,020
and you know edge does this and you know

106
00:04:36,980 --> 00:04:40,250
we all support this API<font color="#CCCCCC"> we've supported</font>

107
00:04:39,020 --> 00:04:42,440
<font color="#E5E5E5">since different versions it's just you</font>

108
00:04:40,250 --> 00:04:45,110
know<font color="#E5E5E5"> it's worth noting not everyone does</font>

109
00:04:42,440 --> 00:04:46,940
it the<font color="#CCCCCC"> same chrome sometimes goes above</font>

110
00:04:45,110 --> 00:04:49,640
and beyond and implements way more stuff

111
00:04:46,940 --> 00:04:51,440
in the form of applications<font color="#E5E5E5"> but that's</font>

112
00:04:49,640 --> 00:04:52,280
been discontinued<font color="#E5E5E5"> and there's no way</font>

113
00:04:51,440 --> 00:04:57,050
that<font color="#E5E5E5"> you can create your own</font>

114
00:04:52,280 --> 00:04:58,429
applications now<font color="#CCCCCC"> the or is there and the</font>

115
00:04:57,050 --> 00:05:00,740
<font color="#E5E5E5">reason that any of this matters and that</font>

116
00:04:58,430 --> 00:05:02,780
you're here is the way that you install

117
00:05:00,740 --> 00:05:05,450
this<font color="#CCCCCC"> turbocharge cross-site scripting</font>

118
00:05:02,780 --> 00:05:07,549
<font color="#E5E5E5">requires two clicks from</font><font color="#CCCCCC"> the user</font><font color="#E5E5E5"> that's</font>

119
00:05:05,450 --> 00:05:09,979
it<font color="#E5E5E5"> you need to go click on like add</font><font color="#CCCCCC"> to</font>

120
00:05:07,550 --> 00:05:13,070
Chrome or<font color="#CCCCCC"> add to Firefox you see a</font><font color="#E5E5E5"> pop</font>

121
00:05:09,980 --> 00:05:15,320
<font color="#E5E5E5">up and then you just hit add</font><font color="#CCCCCC"> extension</font>

122
00:05:13,070 --> 00:05:18,080
and you're good<font color="#CCCCCC"> to go this is</font><font color="#E5E5E5"> kind of a</font>

123
00:05:15,320 --> 00:05:19,310
less<font color="#E5E5E5"> challenging thing</font><font color="#CCCCCC"> for users</font><font color="#E5E5E5"> to do</font>

124
00:05:18,080 --> 00:05:21,289
than say<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> gonna double click</font><font color="#E5E5E5"> your</font>

125
00:05:19,310 --> 00:05:23,240
executable that<font color="#E5E5E5"> you've mailed me or you</font>

126
00:05:21,290 --> 00:05:24,590
know run<font color="#E5E5E5"> this Excel macro and</font><font color="#CCCCCC"> user</font>

127
00:05:23,240 --> 00:05:26,240
<font color="#E5E5E5">should start quite as aware that maybe</font>

128
00:05:24,590 --> 00:05:27,890
they shouldn't<font color="#CCCCCC"> be</font><font color="#E5E5E5"> doing this and the</font>

129
00:05:26,240 --> 00:05:29,990
reason<font color="#CCCCCC"> for that is the place that</font><font color="#E5E5E5"> you do</font>

130
00:05:27,890 --> 00:05:31,669
<font color="#CCCCCC">this</font><font color="#E5E5E5"> from is these trustworthy sites</font>

131
00:05:29,990 --> 00:05:34,700
that are run by<font color="#E5E5E5"> Google or Mozilla</font><font color="#CCCCCC"> you're</font>

132
00:05:31,669 --> 00:05:36,320
on a site explicitly by a provider<font color="#CCCCCC"> that</font>

133
00:05:34,700 --> 00:05:38,900
made their browser so it makes sense

134
00:05:36,320 --> 00:05:41,030
<font color="#CCCCCC">that they're gonna want to trust it the</font>

135
00:05:38,900 --> 00:05:42,169
only<font color="#E5E5E5"> trick is</font><font color="#CCCCCC"> in order</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> your</font>

136
00:05:41,030 --> 00:05:43,849
extension<font color="#CCCCCC"> onto this delightful</font>

137
00:05:42,169 --> 00:05:47,060
storefront<font color="#E5E5E5"> you need to get through the</font>

138
00:05:43,850 --> 00:05:48,860
<font color="#CCCCCC">approval process</font><font color="#E5E5E5"> once you've done that</font>

139
00:05:47,060 --> 00:05:50,419
<font color="#E5E5E5">though anything</font><font color="#CCCCCC"> that your extensions</font>

140
00:05:48,860 --> 00:05:52,669
doing it's coming<font color="#E5E5E5"> from inside the</font>

141
00:05:50,419 --> 00:05:55,130
browser<font color="#E5E5E5"> so like there's nothing unusual</font>

142
00:05:52,669 --> 00:05:56,210
about<font color="#E5E5E5"> seeing</font><font color="#CCCCCC"> Chrome</font><font color="#E5E5E5"> open a TCP</font>

143
00:05:55,130 --> 00:05:57,080
connection<font color="#CCCCCC"> to connect to a</font><font color="#E5E5E5"> website</font>

144
00:05:56,210 --> 00:05:59,120
<font color="#E5E5E5">that's just something you're</font><font color="#CCCCCC"> gonna</font>

145
00:05:57,080 --> 00:06:00,650
<font color="#E5E5E5">expect to see so a lot of endpoint</font>

146
00:05:59,120 --> 00:06:03,380
detection solutions are<font color="#E5E5E5"> probably not</font>

147
00:06:00,650 --> 00:06:04,820
going to be keen as frequently<font color="#E5E5E5"> on what</font>

148
00:06:03,380 --> 00:06:06,130
you're<font color="#E5E5E5"> doing if you're an extension</font>

149
00:06:04,820 --> 00:06:11,210
inside the browser

150
00:06:06,130 --> 00:06:12,919
<font color="#CCCCCC">avy tends to give you a pass</font><font color="#E5E5E5"> and because</font>

151
00:06:11,210 --> 00:06:14,989
of this browser extension API they are

152
00:06:12,919 --> 00:06:16,340
actually multi-platform I know I just

153
00:06:14,990 --> 00:06:19,340
went<font color="#CCCCCC"> on about how everybody's different</font>

154
00:06:16,340 --> 00:06:21,679
<font color="#CCCCCC">but in</font><font color="#E5E5E5"> practice I've found that you can</font>

155
00:06:19,340 --> 00:06:22,940
write a<font color="#E5E5E5"> Chrome extension to target a</font>

156
00:06:21,680 --> 00:06:25,040
specific<font color="#CCCCCC"> user and then I've actually</font>

157
00:06:22,940 --> 00:06:28,250
found<font color="#E5E5E5"> out on gigs</font><font color="#CCCCCC"> oh man my target</font>

158
00:06:25,040 --> 00:06:29,930
actually<font color="#E5E5E5"> uses Firefox</font><font color="#CCCCCC"> whoo so I went</font>

159
00:06:28,250 --> 00:06:31,610
through<font color="#E5E5E5"> and so well how easy what</font><font color="#CCCCCC"> is it</font>

160
00:06:29,930 --> 00:06:33,919
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be for me</font><font color="#CCCCCC"> to take my extension</font>

161
00:06:31,610 --> 00:06:36,080
and publish it<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Mozilla add-on</font>

162
00:06:33,919 --> 00:06:40,719
store and it<font color="#E5E5E5"> took 30 minutes the reason</font>

163
00:06:36,080 --> 00:06:42,490
for that is they allow you<font color="#E5E5E5"> to take</font>

164
00:06:40,720 --> 00:06:45,010
same syntax<font color="#E5E5E5"> you read a</font><font color="#CCCCCC"> Chrome extension</font>

165
00:06:42,490 --> 00:06:48,010
with which is you say like<font color="#CCCCCC"> Chrome dot</font>

166
00:06:45,010 --> 00:06:51,159
you<font color="#E5E5E5"> know web extension API so Chrome web</font>

167
00:06:48,010 --> 00:06:53,200
request<font color="#CCCCCC"> or</font><font color="#E5E5E5"> Chrome cookies or</font><font color="#CCCCCC"> Chrome dot</font>

168
00:06:51,160 --> 00:06:54,820
whatever and Firefox will also read that

169
00:06:53,200 --> 00:06:56,320
<font color="#CCCCCC">it's supposed to be browser dot</font><font color="#E5E5E5"> whatever</font>

170
00:06:54,820 --> 00:06:57,700
but everybody kind of<font color="#E5E5E5"> wants to make sure</font>

171
00:06:56,320 --> 00:06:59,080
<font color="#CCCCCC">that</font><font color="#E5E5E5"> it's easy</font><font color="#CCCCCC"> to import</font><font color="#E5E5E5"> a Chrome</font>

172
00:06:57,700 --> 00:07:03,099
extension because<font color="#E5E5E5"> that's the number one</font>

173
00:06:59,080 --> 00:07:04,810
market share and<font color="#E5E5E5"> malware authors know</font>

174
00:07:03,100 --> 00:07:06,400
that this stuff<font color="#E5E5E5"> is really juicy so</font>

175
00:07:04,810 --> 00:07:08,740
they've been abusing<font color="#CCCCCC"> this for quite</font><font color="#E5E5E5"> some</font>

176
00:07:06,400 --> 00:07:10,390
time<font color="#CCCCCC"> I think there's even more</font>

177
00:07:08,740 --> 00:07:13,650
possibilities<font color="#E5E5E5"> though in a red teaming</font>

178
00:07:10,390 --> 00:07:13,650
context and we're going to talk<font color="#CCCCCC"> about</font>

179
00:07:14,130 --> 00:07:18,820
that<font color="#E5E5E5"> but before</font><font color="#CCCCCC"> we do I think</font><font color="#E5E5E5"> we have to</font>

180
00:07:17,380 --> 00:07:21,430
talk<font color="#E5E5E5"> about the prior art which is</font>

181
00:07:18,820 --> 00:07:23,260
<font color="#E5E5E5">malware malware is great for this for</font>

182
00:07:21,430 --> 00:07:25,540
<font color="#E5E5E5">example there was a malware family</font>

183
00:07:23,260 --> 00:07:27,280
called<font color="#CCCCCC"> catch-all</font><font color="#E5E5E5"> where after</font><font color="#CCCCCC"> you ran</font>

184
00:07:25,540 --> 00:07:28,540
<font color="#E5E5E5">their executable it was a normal</font>

185
00:07:27,280 --> 00:07:31,750
<font color="#CCCCCC">conventional like download and run</font><font color="#E5E5E5"> my</font>

186
00:07:28,540 --> 00:07:33,850
executable<font color="#CCCCCC"> they would side load a Chrome</font>

187
00:07:31,750 --> 00:07:35,320
extension<font color="#CCCCCC"> which</font><font color="#E5E5E5"> would intercept</font><font color="#CCCCCC"> every</font>

188
00:07:33,850 --> 00:07:37,480
single<font color="#E5E5E5"> post request that you had and</font>

189
00:07:35,320 --> 00:07:39,340
then<font color="#E5E5E5"> ship that back to a situ so every</font>

190
00:07:37,480 --> 00:07:40,870
time<font color="#E5E5E5"> you've logged in or used anything</font>

191
00:07:39,340 --> 00:07:42,429
that might have a credit<font color="#CCCCCC"> card number</font><font color="#E5E5E5"> in</font>

192
00:07:40,870 --> 00:07:45,070
it that information got beamed right

193
00:07:42,430 --> 00:07:46,840
<font color="#E5E5E5">back to them and the way</font><font color="#CCCCCC"> you used to do</font>

194
00:07:45,070 --> 00:07:49,000
this was you who would<font color="#CCCCCC"> manipulate the</font>

195
00:07:46,840 --> 00:07:51,400
chrome shortcuts<font color="#CCCCCC"> so you would</font><font color="#E5E5E5"> change the</font>

196
00:07:49,000 --> 00:07:53,080
users like<font color="#CCCCCC"> chrome shortcuts to us like</font>

197
00:07:51,400 --> 00:07:55,630
<font color="#E5E5E5">immediately load an extension and</font>

198
00:07:53,080 --> 00:07:58,150
<font color="#CCCCCC">disable of</font><font color="#E5E5E5"> warnings and that works for a</font>

199
00:07:55,630 --> 00:08:00,310
<font color="#E5E5E5">while and then</font><font color="#CCCCCC"> Chrome understandably was</font>

200
00:07:58,150 --> 00:08:01,479
said this is<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of unsafe we're not</font>

201
00:08:00,310 --> 00:08:02,740
gonna<font color="#E5E5E5"> let you do this anymore so when</font>

202
00:08:01,479 --> 00:08:04,659
your current versions of<font color="#E5E5E5"> Chrome you</font><font color="#CCCCCC"> can</font>

203
00:08:02,740 --> 00:08:06,600
no<font color="#CCCCCC"> longer</font><font color="#E5E5E5"> just say like - - disable</font>

204
00:08:04,660 --> 00:08:08,320
warnings<font color="#E5E5E5"> and have everything</font><font color="#CCCCCC"> work</font>

205
00:08:06,600 --> 00:08:10,810
<font color="#E5E5E5">unsurprising when we've also seen this</font>

206
00:08:08,320 --> 00:08:12,849
in<font color="#E5E5E5"> the banking sector I call this one</font>

207
00:08:10,810 --> 00:08:15,100
<font color="#E5E5E5">out specifically</font><font color="#CCCCCC"> because I think it's</font>

208
00:08:12,850 --> 00:08:16,600
<font color="#E5E5E5">worth noting</font><font color="#CCCCCC"> on that right over there</font>

209
00:08:15,100 --> 00:08:18,340
that's what the store page actually

210
00:08:16,600 --> 00:08:19,600
<font color="#E5E5E5">would look like for someone that was</font>

211
00:08:18,340 --> 00:08:21,340
<font color="#CCCCCC">going to install this extension</font><font color="#E5E5E5"> this is</font>

212
00:08:19,600 --> 00:08:23,050
<font color="#E5E5E5">what they'd see and then somebody would</font>

213
00:08:21,340 --> 00:08:24,520
<font color="#CCCCCC">actually click that and install it I</font>

214
00:08:23,050 --> 00:08:25,630
mean<font color="#E5E5E5"> you have to do a little bit</font><font color="#CCCCCC"> more</font>

215
00:08:24,520 --> 00:08:27,039
than<font color="#E5E5E5"> this these days it's a little</font>

216
00:08:25,630 --> 00:08:29,200
harder than<font color="#E5E5E5"> just having</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> no</font>

217
00:08:27,040 --> 00:08:31,750
screenshots whatsoever and calling

218
00:08:29,200 --> 00:08:33,490
<font color="#E5E5E5">yourself interface</font><font color="#CCCCCC"> online but it's</font>

219
00:08:31,750 --> 00:08:35,110
fundamentally<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is all you're</font>

220
00:08:33,490 --> 00:08:37,180
contending<font color="#CCCCCC"> with it's a small social</font>

221
00:08:35,110 --> 00:08:40,570
engineering challenge for you

222
00:08:37,179 --> 00:08:42,338
essentially and sometimes<font color="#E5E5E5"> this comes out</font>

223
00:08:40,570 --> 00:08:44,500
in fun way so you can take an<font color="#E5E5E5"> existing</font>

224
00:08:42,339 --> 00:08:46,390
extension that<font color="#E5E5E5"> does something benign for</font>

225
00:08:44,500 --> 00:08:48,460
example<font color="#E5E5E5"> Google the custom logo for</font>

226
00:08:46,390 --> 00:08:50,230
<font color="#CCCCCC">google extension which was</font><font color="#E5E5E5"> also an ad</font>

227
00:08:48,460 --> 00:08:52,630
fraud proxy<font color="#E5E5E5"> and it was awesome</font><font color="#CCCCCC"> because</font>

228
00:08:50,230 --> 00:08:54,520
<font color="#CCCCCC">it would normally be benign until it got</font>

229
00:08:52,630 --> 00:08:55,870
<font color="#E5E5E5">a configuration update which said Oh</font>

230
00:08:54,520 --> 00:08:59,079
by the way<font color="#E5E5E5"> I need</font><font color="#CCCCCC"> you to also</font><font color="#E5E5E5"> hit this</font>

231
00:08:55,870 --> 00:09:01,840
ad so I can make some<font color="#CCCCCC"> money and that was</font>

232
00:08:59,080 --> 00:09:03,520
quite successful<font color="#CCCCCC"> and then finally my</font>

233
00:09:01,840 --> 00:09:04,750
personal<font color="#E5E5E5"> favorite because</font><font color="#CCCCCC"> you can't have</font>

234
00:09:03,520 --> 00:09:07,240
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> without any sort of</font>

235
00:09:04,750 --> 00:09:08,680
<font color="#CCCCCC">cryptocurrency getting involved which</font>

236
00:09:07,240 --> 00:09:10,030
was the face<font color="#E5E5E5"> X worm and this would</font>

237
00:09:08,680 --> 00:09:12,099
spread through all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> your messenger</font>

238
00:09:10,030 --> 00:09:13,449
contacts and then once you installed it

239
00:09:12,100 --> 00:09:15,880
it would intercept all of your post

240
00:09:13,450 --> 00:09:17,710
<font color="#E5E5E5">requests - crypto sites Jack your</font>

241
00:09:15,880 --> 00:09:19,930
credentials<font color="#CCCCCC"> and to add insult to injury</font>

242
00:09:17,710 --> 00:09:21,310
<font color="#E5E5E5">it would also use you to mine</font>

243
00:09:19,930 --> 00:09:22,989
cryptocurrency because it's not bad

244
00:09:21,310 --> 00:09:25,719
enough<font color="#E5E5E5"> that I got your coins I also need</font>

245
00:09:22,990 --> 00:09:27,640
like another<font color="#CCCCCC"> 20 cents a month which I</font>

246
00:09:25,720 --> 00:09:30,370
<font color="#E5E5E5">just you know you gotta get that value</font>

247
00:09:27,640 --> 00:09:32,500
<font color="#CCCCCC">out of your</font><font color="#E5E5E5"> mouth</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> I think that you</font>

248
00:09:30,370 --> 00:09:34,810
can do more with<font color="#CCCCCC"> this like it's nice</font>

249
00:09:32,500 --> 00:09:37,000
that<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> ad fraud that's a great</font>

250
00:09:34,810 --> 00:09:39,489
thing but simultaneously<font color="#E5E5E5"> we also have</font>

251
00:09:37,000 --> 00:09:41,140
access<font color="#E5E5E5"> to every internal resource that</font>

252
00:09:39,490 --> 00:09:42,700
that user has<font color="#CCCCCC"> access to</font><font color="#E5E5E5"> and we can hit</font>

253
00:09:41,140 --> 00:09:44,050
<font color="#E5E5E5">it with their cookies and their local</font>

254
00:09:42,700 --> 00:09:47,260
storage the browser was already<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do</font>

255
00:09:44,050 --> 00:09:50,560
that<font color="#CCCCCC"> I actually have</font><font color="#E5E5E5"> a colleague who</font>

256
00:09:47,260 --> 00:09:53,710
wrote a<font color="#E5E5E5"> really cool</font><font color="#CCCCCC"> cross-site scripting</font>

257
00:09:50,560 --> 00:09:54,880
proxy<font color="#E5E5E5"> as like a POC that hey once I get</font>

258
00:09:53,710 --> 00:09:56,140
cross-site scripting I'm gonna be able

259
00:09:54,880 --> 00:09:58,330
<font color="#E5E5E5">to connect to all kinds of things</font><font color="#CCCCCC"> on</font>

260
00:09:56,140 --> 00:09:59,800
<font color="#CCCCCC">your behalf through another browser</font><font color="#E5E5E5"> we</font>

261
00:09:58,330 --> 00:10:01,420
<font color="#E5E5E5">can take something like that</font><font color="#CCCCCC"> and then</font>

262
00:09:59,800 --> 00:10:02,859
turn<font color="#E5E5E5"> it up to 11 because now it's not</font>

263
00:10:01,420 --> 00:10:05,469
<font color="#CCCCCC">just on the site that we're on it's on</font>

264
00:10:02,860 --> 00:10:07,630
all<font color="#E5E5E5"> the sites</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we can enumerate</font>

265
00:10:05,470 --> 00:10:09,100
internal DNS<font color="#E5E5E5"> I might not know that you</font>

266
00:10:07,630 --> 00:10:10,540
have a Jenkins installation but if I

267
00:10:09,100 --> 00:10:12,640
start<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for Jenkins dot whatever</font>

268
00:10:10,540 --> 00:10:14,740
<font color="#E5E5E5">and it suddenly returns me a</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> I</font>

269
00:10:12,640 --> 00:10:16,150
know you've<font color="#E5E5E5"> got it and I can hit it we</font>

270
00:10:14,740 --> 00:10:17,560
can<font color="#E5E5E5"> access local host developer</font>

271
00:10:16,150 --> 00:10:20,199
resources<font color="#CCCCCC"> without me</font><font color="#E5E5E5"> being able to do</font>

272
00:10:17,560 --> 00:10:21,640
fancy DNS rebinding attacks<font color="#CCCCCC"> IP white</font>

273
00:10:20,200 --> 00:10:23,310
listings no good<font color="#CCCCCC"> because</font><font color="#E5E5E5"> the calls</font>

274
00:10:21,640 --> 00:10:25,630
coming<font color="#CCCCCC"> from</font><font color="#E5E5E5"> inside the house and</font>

275
00:10:23,310 --> 00:10:27,400
sometimes you can<font color="#CCCCCC"> even access the file</font>

276
00:10:25,630 --> 00:10:29,110
you<font color="#E5E5E5"> are eyes to read files directly off</font>

277
00:10:27,400 --> 00:10:31,240
disk<font color="#CCCCCC"> from the browser and that's</font>

278
00:10:29,110 --> 00:10:33,580
disabled by default unfortunately but

279
00:10:31,240 --> 00:10:37,270
there's some<font color="#E5E5E5"> stuff we</font><font color="#CCCCCC"> can do to fix that</font>

280
00:10:33,580 --> 00:10:39,610
and I'll go into that<font color="#E5E5E5"> later obviously</font><font color="#CCCCCC"> as</font>

281
00:10:37,270 --> 00:10:41,439
<font color="#E5E5E5">you saw in all those malware examples</font>

282
00:10:39,610 --> 00:10:43,180
that I gave we can also man in the

283
00:10:41,440 --> 00:10:44,500
middle all<font color="#E5E5E5"> of those communications that</font>

284
00:10:43,180 --> 00:10:47,260
we get so we can Jack credentials from

285
00:10:44,500 --> 00:10:51,460
people you even actually used to be able

286
00:10:47,260 --> 00:10:53,170
<font color="#E5E5E5">to intercept and modify</font><font color="#CCCCCC"> traffic that</font>

287
00:10:51,460 --> 00:10:55,720
would<font color="#E5E5E5"> go directly to Chrome's internal</font>

288
00:10:53,170 --> 00:10:57,160
pages<font color="#E5E5E5"> so there was one malware family</font>

289
00:10:55,720 --> 00:10:59,200
which would say oh it looks like<font color="#E5E5E5"> you're</font>

290
00:10:57,160 --> 00:11:00,579
<font color="#E5E5E5">trying to go to Chrome extensions I'm</font>

291
00:10:59,200 --> 00:11:02,560
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> send you somewhere else you can't</font>

292
00:11:00,580 --> 00:11:04,600
actually uninstall me and it would send

293
00:11:02,560 --> 00:11:06,189
you to<font color="#CCCCCC"> a page that</font><font color="#E5E5E5"> looked like this and</font>

294
00:11:04,600 --> 00:11:08,790
say oh sorry it's corrupted I guess

295
00:11:06,190 --> 00:11:12,120
you're just<font color="#E5E5E5"> gonna have to live with it</font>

296
00:11:08,790 --> 00:11:14,439
yeah and no it was it was a clever usage

297
00:11:12,120 --> 00:11:15,550
<font color="#E5E5E5">unfortunately it got a lot of press or</font>

298
00:11:14,440 --> 00:11:17,770
fortunately got a lot of<font color="#E5E5E5"> press and</font>

299
00:11:15,550 --> 00:11:19,120
<font color="#E5E5E5">chrome no longer</font><font color="#CCCCCC"> lets you intercept this</font>

300
00:11:17,770 --> 00:11:20,560
functionality<font color="#E5E5E5"> which you'll kind of</font>

301
00:11:19,120 --> 00:11:21,640
notice is the theme<font color="#E5E5E5"> for a lot of the</font>

302
00:11:20,560 --> 00:11:23,109
things that<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to start talking</font>

303
00:11:21,640 --> 00:11:25,390
<font color="#CCCCCC">about which is it used to be</font><font color="#E5E5E5"> possible</font>

304
00:11:23,110 --> 00:11:27,100
<font color="#E5E5E5">and then it got overused and is no</font>

305
00:11:25,390 --> 00:11:29,050
longer<font color="#E5E5E5"> possible</font><font color="#CCCCCC"> but don't worry</font><font color="#E5E5E5"> there's</font>

306
00:11:27,100 --> 00:11:30,870
still<font color="#CCCCCC"> plenty of</font><font color="#E5E5E5"> fun stuff for us so we</font>

307
00:11:29,050 --> 00:11:33,040
were fun

308
00:11:30,870 --> 00:11:36,040
so let's<font color="#E5E5E5"> actually talk about writing</font>

309
00:11:33,040 --> 00:11:38,650
some of<font color="#CCCCCC"> these bad boys</font><font color="#E5E5E5"> the basic</font>

310
00:11:36,040 --> 00:11:40,120
extension structure is not that<font color="#E5E5E5"> much</font>

311
00:11:38,650 --> 00:11:42,730
really<font color="#E5E5E5"> all that we need is a</font>

312
00:11:40,120 --> 00:11:43,900
manifest.json file<font color="#CCCCCC"> that's pretty much</font>

313
00:11:42,730 --> 00:11:45,520
what contains everything<font color="#E5E5E5"> that's going to</font>

314
00:11:43,900 --> 00:11:46,569
point<font color="#CCCCCC"> at all</font><font color="#E5E5E5"> the other files so in</font>

315
00:11:45,520 --> 00:11:48,790
practice<font color="#CCCCCC"> you</font><font color="#E5E5E5"> could have an extension</font>

316
00:11:46,570 --> 00:11:50,530
<font color="#CCCCCC">that's like one javascript file and</font><font color="#E5E5E5"> a</font>

317
00:11:48,790 --> 00:11:51,849
manifest<font color="#CCCCCC"> file or you could have like</font>

318
00:11:50,530 --> 00:11:52,810
<font color="#E5E5E5">tons and tons and tons of stuff that's</font>

319
00:11:51,850 --> 00:11:55,750
probably<font color="#E5E5E5"> what you're going to see in a</font>

320
00:11:52,810 --> 00:11:57,489
real extension the reason<font color="#E5E5E5"> that we care</font>

321
00:11:55,750 --> 00:11:58,870
about<font color="#E5E5E5"> the manifest.json though besides</font>

322
00:11:57,490 --> 00:12:00,460
the fact that says what's going<font color="#E5E5E5"> to run</font>

323
00:11:58,870 --> 00:12:02,140
and<font color="#E5E5E5"> what</font><font color="#CCCCCC"> content</font><font color="#E5E5E5"> is there is it</font>

324
00:12:00,460 --> 00:12:05,110
specifies what permissions<font color="#E5E5E5"> are</font>

325
00:12:02,140 --> 00:12:07,120
extensions<font color="#E5E5E5"> actually need to run so for</font>

326
00:12:05,110 --> 00:12:09,100
<font color="#E5E5E5">example if I write an extension that I</font>

327
00:12:07,120 --> 00:12:10,930
want to use<font color="#E5E5E5"> facebook Messenger</font><font color="#CCCCCC"> I need to</font>

328
00:12:09,100 --> 00:12:14,740
explicitly<font color="#E5E5E5"> say</font><font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font>

329
00:12:10,930 --> 00:12:16,810
access<font color="#CCCCCC"> WFA spoke comm in</font><font color="#E5E5E5"> my manifest but</font>

330
00:12:14,740 --> 00:12:18,520
what if I also<font color="#E5E5E5"> then want</font><font color="#CCCCCC"> to have you</font>

331
00:12:16,810 --> 00:12:20,079
<font color="#E5E5E5">know my ad click revenue now I need to</font>

332
00:12:18,520 --> 00:12:21,430
add Google<font color="#CCCCCC"> ads and maybe I want to</font><font color="#E5E5E5"> pull</font>

333
00:12:20,080 --> 00:12:23,020
it in figuration down from<font color="#E5E5E5"> somewhere so</font>

334
00:12:21,430 --> 00:12:24,550
<font color="#CCCCCC">I pull</font><font color="#E5E5E5"> something else and I add another</font>

335
00:12:23,020 --> 00:12:27,850
thing and suddenly<font color="#CCCCCC"> I've got this big</font>

336
00:12:24,550 --> 00:12:29,680
long list<font color="#E5E5E5"> of URLs</font><font color="#CCCCCC"> and as a result of</font>

337
00:12:27,850 --> 00:12:32,290
that it's possible<font color="#E5E5E5"> to specify wildcards</font>

338
00:12:29,680 --> 00:12:33,670
<font color="#E5E5E5">which let you request everything</font><font color="#CCCCCC"> and you</font>

339
00:12:32,290 --> 00:12:34,719
can probably take<font color="#E5E5E5"> a guess at where</font>

340
00:12:33,670 --> 00:12:37,329
<font color="#E5E5E5">that's going to lead for your average</font>

341
00:12:34,720 --> 00:12:38,560
<font color="#CCCCCC">developer who writes extensions in</font>

342
00:12:37,330 --> 00:12:40,810
addition to<font color="#E5E5E5"> that we also need to specify</font>

343
00:12:38,560 --> 00:12:42,640
stuff like you<font color="#E5E5E5"> know do I want</font><font color="#CCCCCC"> to touch</font>

344
00:12:40,810 --> 00:12:44,560
cookies<font color="#CCCCCC"> ok great</font><font color="#E5E5E5"> I'm gonna request</font>

345
00:12:42,640 --> 00:12:45,870
cookie permissions history history

346
00:12:44,560 --> 00:12:48,520
permissions I'll go<font color="#E5E5E5"> into a list later</font>

347
00:12:45,870 --> 00:12:50,770
<font color="#CCCCCC">and</font><font color="#E5E5E5"> depending on what permissions you</font>

348
00:12:48,520 --> 00:12:52,150
request it<font color="#CCCCCC"> will affect what warning</font>

349
00:12:50,770 --> 00:12:53,770
<font color="#E5E5E5">window that you get when somebody tries</font>

350
00:12:52,150 --> 00:12:55,720
to install stuff<font color="#E5E5E5"> so that second window</font>

351
00:12:53,770 --> 00:12:58,930
that pops up is based on what

352
00:12:55,720 --> 00:13:00,730
permissions<font color="#E5E5E5"> you request so here's an</font>

353
00:12:58,930 --> 00:13:02,829
example manifest.json file this is all

354
00:13:00,730 --> 00:13:04,390
that<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> in order to say</font><font color="#CCCCCC"> ok that's</font>

355
00:13:02,830 --> 00:13:06,250
<font color="#E5E5E5">great I want a man-in-the-middle</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of</font>

356
00:13:04,390 --> 00:13:07,810
your traffic<font color="#CCCCCC"> I want to steal all of</font><font color="#E5E5E5"> your</font>

357
00:13:06,250 --> 00:13:09,340
cookies<font color="#E5E5E5"> and I want to be able to proxy</font>

358
00:13:07,810 --> 00:13:10,719
all of my traffic<font color="#CCCCCC"> through you it's not</font>

359
00:13:09,340 --> 00:13:13,000
really that<font color="#CCCCCC"> much we</font><font color="#E5E5E5"> really are</font><font color="#CCCCCC"> just</font>

360
00:13:10,720 --> 00:13:14,350
looking for<font color="#E5E5E5"> for permissions here it's</font>

361
00:13:13,000 --> 00:13:16,150
not<font color="#CCCCCC"> too much</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you might be thinking</font>

362
00:13:14,350 --> 00:13:18,460
well surely the permissions warning<font color="#E5E5E5"> that</font>

363
00:13:16,150 --> 00:13:19,959
pops up is<font color="#E5E5E5"> going to tell</font><font color="#CCCCCC"> us you know</font>

364
00:13:18,460 --> 00:13:21,970
there's no way you should<font color="#E5E5E5"> install this</font>

365
00:13:19,960 --> 00:13:24,160
extension<font color="#CCCCCC"> but the answer is it</font>

366
00:13:21,970 --> 00:13:25,779
<font color="#CCCCCC">kind of looks something like this this</font>

367
00:13:24,160 --> 00:13:29,230
<font color="#E5E5E5">is all that you</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> in order to man in</font>

368
00:13:25,779 --> 00:13:30,730
the middle all<font color="#E5E5E5"> the things it's it does</font>

369
00:13:29,230 --> 00:13:32,379
say<font color="#E5E5E5"> you need to read and change all of</font>

370
00:13:30,730 --> 00:13:34,810
<font color="#CCCCCC">your</font><font color="#E5E5E5"> data on the websites you visit</font>

371
00:13:32,379 --> 00:13:36,519
which sounds scary is how<font color="#E5E5E5"> all</font><font color="#CCCCCC"> hell like</font>

372
00:13:34,810 --> 00:13:38,339
<font color="#CCCCCC">it</font><font color="#E5E5E5"> that's really bad</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it means</font>

373
00:13:36,519 --> 00:13:41,259
exactly<font color="#E5E5E5"> what it sounds like it does</font>

374
00:13:38,339 --> 00:13:42,879
unfortunately<font color="#CCCCCC"> if you go to the front</font>

375
00:13:41,259 --> 00:13:44,019
<font color="#CCCCCC">page of the Chrome Web Store and just</font>

376
00:13:42,879 --> 00:13:46,029
look at like what<font color="#CCCCCC"> free apps are</font>

377
00:13:44,019 --> 00:13:48,819
<font color="#CCCCCC">available there you're gonna find that</font>

378
00:13:46,029 --> 00:13:50,920
that permission<font color="#E5E5E5"> is requested</font><font color="#CCCCCC"> by a huge</font>

379
00:13:48,819 --> 00:13:53,050
<font color="#CCCCCC">number of applications I've highlighted</font>

380
00:13:50,920 --> 00:13:54,399
in red on<font color="#E5E5E5"> this image</font><font color="#CCCCCC"> here every</font>

381
00:13:53,050 --> 00:13:56,019
application<font color="#E5E5E5"> there with requests enough</font>

382
00:13:54,399 --> 00:13:57,160
permissions to do all that bad<font color="#E5E5E5"> stuff we</font>

383
00:13:56,019 --> 00:13:58,689
were just talking about it's a good

384
00:13:57,160 --> 00:14:01,839
number<font color="#E5E5E5"> it's a very common</font><font color="#CCCCCC"> thing that</font>

385
00:13:58,689 --> 00:14:04,029
<font color="#E5E5E5">happens the reason is that users are</font>

386
00:14:01,839 --> 00:14:05,589
effectively desensitized to this

387
00:14:04,029 --> 00:14:07,029
permission warning<font color="#E5E5E5"> like the first thing</font>

388
00:14:05,589 --> 00:14:08,769
you go and install<font color="#E5E5E5"> when you get a</font>

389
00:14:07,029 --> 00:14:10,029
browser<font color="#CCCCCC"> is</font><font color="#E5E5E5"> you're going to install</font><font color="#CCCCCC"> some</font>

390
00:14:08,769 --> 00:14:12,009
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> adblock which makes sense</font>

391
00:14:10,029 --> 00:14:13,439
<font color="#E5E5E5">because you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> who wants to go browse</font>

392
00:14:12,009 --> 00:14:15,879
the<font color="#E5E5E5"> internet without an ad blocker and</font>

393
00:14:13,439 --> 00:14:18,009
that's going<font color="#E5E5E5"> to require the ability</font><font color="#CCCCCC"> to</font>

394
00:14:15,879 --> 00:14:19,839
intercept<font color="#E5E5E5"> all of your communications and</font>

395
00:14:18,009 --> 00:14:23,529
then modify<font color="#E5E5E5"> them to remove all those</font>

396
00:14:19,839 --> 00:14:25,120
<font color="#E5E5E5">pesky ads so developers</font><font color="#CCCCCC"> and practice</font>

397
00:14:23,529 --> 00:14:26,740
<font color="#CCCCCC">know I don't really need</font><font color="#E5E5E5"> to specify</font>

398
00:14:25,120 --> 00:14:28,629
facebook.com and<font color="#E5E5E5"> exactly what I'm</font>

399
00:14:26,740 --> 00:14:31,589
<font color="#CCCCCC">touching</font><font color="#E5E5E5"> I'm going to</font><font color="#CCCCCC"> specify</font><font color="#E5E5E5"> a just</font>

400
00:14:28,629 --> 00:14:34,509
wild card set and that's<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be fine</font>

401
00:14:31,589 --> 00:14:36,879
<font color="#E5E5E5">some permissions also won't even tell</font>

402
00:14:34,509 --> 00:14:38,860
you or<font color="#E5E5E5"> change the permission warning so</font>

403
00:14:36,879 --> 00:14:40,899
like if I request<font color="#E5E5E5"> cookies that box</font>

404
00:14:38,860 --> 00:14:42,309
doesn't<font color="#E5E5E5"> change because it's considered a</font>

405
00:14:40,899 --> 00:14:43,930
maybe not<font color="#E5E5E5"> that big</font><font color="#CCCCCC"> of a deal so you can</font>

406
00:14:42,309 --> 00:14:46,000
sneak<font color="#E5E5E5"> a lot of stuff into an extension</font>

407
00:14:43,930 --> 00:14:49,089
<font color="#CCCCCC">without it really making a difference to</font>

408
00:14:46,000 --> 00:14:51,279
<font color="#E5E5E5">the user and Google's aware that this is</font>

409
00:14:49,089 --> 00:14:53,139
a thing<font color="#CCCCCC"> so in</font><font color="#E5E5E5"> the tradition of all talks</font>

410
00:14:51,279 --> 00:14:54,279
like four days before<font color="#E5E5E5"> I</font><font color="#CCCCCC"> was going</font><font color="#E5E5E5"> to</font>

411
00:14:53,139 --> 00:14:55,660
give this<font color="#E5E5E5"> Google had a gigantic</font>

412
00:14:54,279 --> 00:14:56,949
announcement<font color="#E5E5E5"> about how they were going</font>

413
00:14:55,660 --> 00:14:59,740
<font color="#E5E5E5">to change the trustworthiness of all</font>

414
00:14:56,949 --> 00:15:01,990
<font color="#E5E5E5">extensions and they come they came up</font>

415
00:14:59,740 --> 00:15:03,939
<font color="#CCCCCC">with some good fixes I think so they're</font>

416
00:15:01,990 --> 00:15:06,699
<font color="#E5E5E5">going to allow users to explicitly</font>

417
00:15:03,939 --> 00:15:09,250
whitelist specific sites when you go and

418
00:15:06,699 --> 00:15:11,109
request<font color="#CCCCCC"> wildcard permissions</font><font color="#E5E5E5"> so I might</font>

419
00:15:09,250 --> 00:15:13,899
say<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> that's great you</font><font color="#E5E5E5"> can have all</font>

420
00:15:11,110 --> 00:15:15,939
the URLs but<font color="#E5E5E5"> in practice I'm really only</font>

421
00:15:13,899 --> 00:15:17,019
<font color="#E5E5E5">gonna let you go to like you know one or</font>

422
00:15:15,939 --> 00:15:19,779
two sites<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> explicitly</font>

423
00:15:17,019 --> 00:15:21,309
<font color="#CCCCCC">whitelisted I'm a little skeptical that</font>

424
00:15:19,779 --> 00:15:23,470
that's alone is gonna be<font color="#CCCCCC"> sufficient</font>

425
00:15:21,309 --> 00:15:25,149
because<font color="#E5E5E5"> as security people we know that</font>

426
00:15:23,470 --> 00:15:26,620
<font color="#E5E5E5">a whitelist is a great solution but your</font>

427
00:15:25,149 --> 00:15:28,540
<font color="#E5E5E5">users and practice are gonna fight</font>

428
00:15:26,620 --> 00:15:30,339
<font color="#E5E5E5">before</font><font color="#CCCCCC"> they have to actually</font><font color="#E5E5E5"> accept that</font>

429
00:15:28,540 --> 00:15:31,870
and can<font color="#E5E5E5"> you imagine someone installing</font>

430
00:15:30,339 --> 00:15:33,519
an ad blocker<font color="#E5E5E5"> and then having to</font>

431
00:15:31,870 --> 00:15:34,899
manually whitelist<font color="#E5E5E5"> every single site</font>

432
00:15:33,519 --> 00:15:36,250
that they go to I just I<font color="#CCCCCC"> don't see that</font>

433
00:15:34,899 --> 00:15:38,829
<font color="#E5E5E5">happening</font>

434
00:15:36,250 --> 00:15:41,250
one thing though<font color="#CCCCCC"> that will impact us I</font>

435
00:15:38,829 --> 00:15:43,508
think<font color="#CCCCCC"> is they've changed the review</font>

436
00:15:41,250 --> 00:15:44,889
<font color="#E5E5E5">process so if you request these more</font>

437
00:15:43,509 --> 00:15:46,990
dangerous permissions you're

438
00:15:44,889 --> 00:15:49,959
automatically going to get<font color="#E5E5E5"> flagged</font><font color="#CCCCCC"> for a</font>

439
00:15:46,990 --> 00:15:50,980
more intensive manual review<font color="#CCCCCC"> so you're</font>

440
00:15:49,959 --> 00:15:53,699
going to<font color="#E5E5E5"> have to figure out how to get</font>

441
00:15:50,980 --> 00:15:56,079
past<font color="#CCCCCC"> that</font><font color="#E5E5E5"> if you want these permissions</font>

442
00:15:53,699 --> 00:15:57,250
the api's that we're<font color="#E5E5E5"> going to be using</font>

443
00:15:56,079 --> 00:15:58,930
<font color="#CCCCCC">once we've requested</font><font color="#E5E5E5"> them I'm just</font><font color="#CCCCCC"> going</font>

444
00:15:57,250 --> 00:16:00,910
<font color="#CCCCCC">to blow through</font><font color="#E5E5E5"> these pretty quick</font>

445
00:15:58,930 --> 00:16:02,319
you've got web requests and web<font color="#CCCCCC"> requests</font>

446
00:16:00,910 --> 00:16:04,029
blocking permissions<font color="#E5E5E5"> that's what's</font>

447
00:16:02,319 --> 00:16:05,920
necessary<font color="#CCCCCC"> to actually man in the middle</font>

448
00:16:04,029 --> 00:16:07,660
<font color="#CCCCCC">the</font><font color="#E5E5E5"> traffic that you want</font>

449
00:16:05,920 --> 00:16:09,819
you've got native messaging permissions

450
00:16:07,660 --> 00:16:11,110
<font color="#E5E5E5">these are interesting in a more post</font>

451
00:16:09,819 --> 00:16:12,579
exploitation sense because if you

452
00:16:11,110 --> 00:16:15,100
<font color="#E5E5E5">request</font><font color="#CCCCCC"> them you can communicate with</font>

453
00:16:12,579 --> 00:16:18,128
<font color="#E5E5E5">binaries on disk and trigger</font><font color="#CCCCCC"> chrome to</font>

454
00:16:15,100 --> 00:16:20,649
run stuff debugger permissions which are

455
00:16:18,129 --> 00:16:21,670
interesting from<font color="#E5E5E5"> kind of a anti analysis</font>

456
00:16:20,649 --> 00:16:22,839
perspective<font color="#CCCCCC"> because we can set</font>

457
00:16:21,670 --> 00:16:24,550
breakpoints on every<font color="#CCCCCC"> single line of</font>

458
00:16:22,839 --> 00:16:25,660
<font color="#E5E5E5">JavaScript in our app and then just</font>

459
00:16:24,550 --> 00:16:28,000
drive<font color="#E5E5E5"> people nuts as they try to figure</font>

460
00:16:25,660 --> 00:16:29,079
<font color="#E5E5E5">out what's</font><font color="#CCCCCC"> happening</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> a couple</font>

461
00:16:28,000 --> 00:16:30,459
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> other permissions</font><font color="#E5E5E5"> they're pretty</font>

462
00:16:29,079 --> 00:16:31,870
straightforward<font color="#CCCCCC"> so like you need</font><font color="#E5E5E5"> to ask</font>

463
00:16:30,459 --> 00:16:33,518
for<font color="#E5E5E5"> cookies permissions to</font><font color="#CCCCCC"> access the</font>

464
00:16:31,870 --> 00:16:35,649
cookies<font color="#E5E5E5"> you</font><font color="#CCCCCC"> need to ask for history to</font>

465
00:16:33,519 --> 00:16:39,880
access history you need to ask for<font color="#E5E5E5"> the</font>

466
00:16:35,649 --> 00:16:41,439
<font color="#E5E5E5">idle permissions you tell when the user</font>

467
00:16:39,880 --> 00:16:43,120
is<font color="#E5E5E5"> not using</font><font color="#CCCCCC"> the browser so you don't</font>

468
00:16:41,439 --> 00:16:46,060
impact their average use case as you

469
00:16:43,120 --> 00:16:47,829
crypt<font color="#E5E5E5"> online and you've got the proxy</font>

470
00:16:46,060 --> 00:16:49,779
permission for situations where we<font color="#E5E5E5"> might</font>

471
00:16:47,829 --> 00:16:52,388
<font color="#CCCCCC">want</font><font color="#E5E5E5"> to forcibly tunnel a user through a</font>

472
00:16:49,779 --> 00:16:53,560
proxy we control so we can<font color="#CCCCCC"> also</font><font color="#E5E5E5"> listen</font>

473
00:16:52,389 --> 00:16:55,360
on what they're<font color="#E5E5E5"> doing maybe without</font>

474
00:16:53,560 --> 00:16:56,410
<font color="#E5E5E5">requesting all those previous URL</font>

475
00:16:55,360 --> 00:17:00,550
permissions<font color="#E5E5E5"> that we were talking</font><font color="#CCCCCC"> about</font>

476
00:16:56,410 --> 00:17:02,110
<font color="#E5E5E5">they're still going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have TLS but in</font>

477
00:17:00,550 --> 00:17:03,490
some cases a user might<font color="#E5E5E5"> get so</font>

478
00:17:02,110 --> 00:17:04,990
<font color="#CCCCCC">frustrated with seeing the</font><font color="#E5E5E5"> warning</font>

479
00:17:03,490 --> 00:17:09,250
constantly they might<font color="#E5E5E5"> just install the</font>

480
00:17:04,990 --> 00:17:10,480
CA or they<font color="#E5E5E5"> might not care one thing I do</font>

481
00:17:09,250 --> 00:17:12,130
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> mention by the way in talking</font>

482
00:17:10,480 --> 00:17:14,230
<font color="#E5E5E5">about the manifest JSON is wildcard</font>

483
00:17:12,130 --> 00:17:15,880
permissions allegedly<font color="#E5E5E5"> have been</font>

484
00:17:14,230 --> 00:17:17,860
identified<font color="#CCCCCC"> as something</font><font color="#E5E5E5"> that could be</font><font color="#CCCCCC"> a</font>

485
00:17:15,880 --> 00:17:21,669
potentially unwanted product<font color="#E5E5E5"> a really</font>

486
00:17:17,859 --> 00:17:24,698
common search string for<font color="#E5E5E5"> antivirus so if</font>

487
00:17:21,669 --> 00:17:26,919
you<font color="#E5E5E5"> literally have all URLs or similar</font>

488
00:17:24,699 --> 00:17:29,409
<font color="#E5E5E5">requests inside your permission or your</font>

489
00:17:26,919 --> 00:17:31,929
manifest.json file<font color="#CCCCCC"> AV might</font><font color="#E5E5E5"> trigger on</font>

490
00:17:29,409 --> 00:17:33,610
that<font color="#CCCCCC"> as a as a signature and you've got</font>

491
00:17:31,929 --> 00:17:34,990
two<font color="#CCCCCC"> options</font><font color="#E5E5E5"> there one is don't literally</font>

492
00:17:33,610 --> 00:17:36,520
request everything but that's<font color="#E5E5E5"> really</font>

493
00:17:34,990 --> 00:17:38,890
<font color="#E5E5E5">where half the</font><font color="#CCCCCC"> fun is because</font><font color="#E5E5E5"> we can't</font>

494
00:17:36,520 --> 00:17:41,200
predict what internal resources<font color="#CCCCCC"> a target</font>

495
00:17:38,890 --> 00:17:43,179
is<font color="#E5E5E5"> going to have an option</font><font color="#CCCCCC"> two is you</font>

496
00:17:41,200 --> 00:17:45,429
can get a little creative<font color="#CCCCCC"> which is that</font>

497
00:17:43,179 --> 00:17:47,470
<font color="#E5E5E5">because these are JSON files we can use</font>

498
00:17:45,429 --> 00:17:48,669
<font color="#CCCCCC">Unicode escapes to just randomly change</font>

499
00:17:47,470 --> 00:17:49,270
specific letters so if they've got<font color="#CCCCCC"> a</font>

500
00:17:48,669 --> 00:17:51,850
really

501
00:17:49,270 --> 00:17:54,100
<font color="#CCCCCC">a signature that's looking for literally</font>

502
00:17:51,850 --> 00:17:55,780
all<font color="#E5E5E5"> urls then we can change it just</font>

503
00:17:54,100 --> 00:17:57,580
<font color="#E5E5E5">enough to maybe get by</font><font color="#CCCCCC"> I mean if they</font>

504
00:17:55,780 --> 00:17:59,590
parse the<font color="#E5E5E5"> JSON this is gonna be no</font><font color="#CCCCCC"> good</font>

505
00:17:57,580 --> 00:18:01,090
<font color="#E5E5E5">and if anyone actually looks at this</font>

506
00:17:59,590 --> 00:18:02,409
they're gonna say what the heck is this

507
00:18:01,090 --> 00:18:04,510
person doing<font color="#E5E5E5"> and it's probably gonna</font>

508
00:18:02,410 --> 00:18:05,620
<font color="#E5E5E5">look shadier than it's worth to do but</font>

509
00:18:04,510 --> 00:18:09,490
just<font color="#CCCCCC"> something I wanted</font><font color="#E5E5E5"> to explicitly</font>

510
00:18:05,620 --> 00:18:11,110
call out what we're gonna be<font color="#CCCCCC"> doing and</font>

511
00:18:09,490 --> 00:18:13,540
what I'm<font color="#E5E5E5"> gonna keep coming</font><font color="#CCCCCC"> back to here</font>

512
00:18:11,110 --> 00:18:15,760
is<font color="#E5E5E5"> never a tribute to malice that which</font>

513
00:18:13,540 --> 00:18:18,040
is adequately explained by stupidity

514
00:18:15,760 --> 00:18:19,660
<font color="#E5E5E5">that's like the catchphrase for how</font>

515
00:18:18,040 --> 00:18:22,060
we're gonna hide<font color="#CCCCCC"> all of our malicious</font>

516
00:18:19,660 --> 00:18:23,530
behavior<font color="#CCCCCC"> you just have</font><font color="#E5E5E5"> to assume</font><font color="#CCCCCC"> that</font>

517
00:18:22,060 --> 00:18:24,790
your extensions<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> get reviewed where</font>

518
00:18:23,530 --> 00:18:26,350
we really need to be in these

519
00:18:24,790 --> 00:18:30,070
<font color="#E5E5E5">storefronts to get any amount</font><font color="#CCCCCC"> of</font>

520
00:18:26,350 --> 00:18:34,060
distribution so with that in<font color="#CCCCCC"> mind you</font>

521
00:18:30,070 --> 00:18:36,159
shouldn't be too indiscreet<font color="#CCCCCC"> with your</font>

522
00:18:34,060 --> 00:18:38,020
actual bad behavior but<font color="#E5E5E5"> don't just</font>

523
00:18:36,160 --> 00:18:40,000
infect every<font color="#CCCCCC"> installation that</font><font color="#E5E5E5"> you get</font>

524
00:18:38,020 --> 00:18:41,680
and cause it<font color="#CCCCCC"> to start you know dumping</font>

525
00:18:40,000 --> 00:18:43,210
cookies and doing all<font color="#CCCCCC"> kinds of</font><font color="#E5E5E5"> bad stuff</font>

526
00:18:41,680 --> 00:18:46,270
<font color="#CCCCCC">immediately because you're gonna get</font>

527
00:18:43,210 --> 00:18:48,040
caught<font color="#E5E5E5"> the best way</font><font color="#CCCCCC"> to make sure</font><font color="#E5E5E5"> that</font>

528
00:18:46,270 --> 00:18:50,710
people<font color="#E5E5E5"> don't think that your plugin</font><font color="#CCCCCC"> or</font>

529
00:18:48,040 --> 00:18:52,240
your extension excuse me<font color="#CCCCCC"> is malicious is</font>

530
00:18:50,710 --> 00:18:53,560
to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you don't actually</font>

531
00:18:52,240 --> 00:18:55,450
have<font color="#E5E5E5"> the malicious code</font><font color="#CCCCCC"> in there like</font>

532
00:18:53,560 --> 00:18:56,620
there's really not a good way<font color="#E5E5E5"> to say how</font>

533
00:18:55,450 --> 00:18:59,500
do<font color="#E5E5E5"> I make it look like I'm dumping</font>

534
00:18:56,620 --> 00:19:01,419
cookies<font color="#E5E5E5"> for a good reason</font><font color="#CCCCCC"> that's just a</font>

535
00:18:59,500 --> 00:19:04,120
rough<font color="#CCCCCC"> thing to do so we really want to</font>

536
00:19:01,420 --> 00:19:05,830
push that content down after we've

537
00:19:04,120 --> 00:19:08,139
identified that that's a target<font color="#E5E5E5"> we care</font>

538
00:19:05,830 --> 00:19:09,730
<font color="#CCCCCC">about but</font><font color="#E5E5E5"> we still need to request the</font>

539
00:19:08,140 --> 00:19:11,650
permissions<font color="#E5E5E5"> anyways regardless of</font>

540
00:19:09,730 --> 00:19:12,910
whether<font color="#E5E5E5"> our bad code is there or not</font><font color="#CCCCCC"> so</font>

541
00:19:11,650 --> 00:19:15,730
we're gonna want to have some<font color="#E5E5E5"> kind of</font>

542
00:19:12,910 --> 00:19:17,980
pretext<font color="#CCCCCC"> to make a casual review of our</font>

543
00:19:15,730 --> 00:19:19,330
extension say oh yeah it totally<font color="#CCCCCC"> makes</font>

544
00:19:17,980 --> 00:19:20,950
sense<font color="#E5E5E5"> this guy needs web</font><font color="#CCCCCC"> requests and</font>

545
00:19:19,330 --> 00:19:23,080
web requests blocking because<font color="#CCCCCC"> I don't</font>

546
00:19:20,950 --> 00:19:25,120
know<font color="#E5E5E5"> they want to implement a custom URI</font>

547
00:19:23,080 --> 00:19:28,419
scheme and that<font color="#CCCCCC"> this is a kind of hacky</font>

548
00:19:25,120 --> 00:19:29,709
way to do it<font color="#CCCCCC"> in general</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> look like</font>

549
00:19:28,420 --> 00:19:30,880
<font color="#E5E5E5">a bad developer they're just going</font><font color="#CCCCCC"> to</font>

550
00:19:29,710 --> 00:19:32,200
<font color="#CCCCCC">assume</font><font color="#E5E5E5"> you don't know what you're doing</font>

551
00:19:30,880 --> 00:19:33,940
more<font color="#CCCCCC"> than they're gonna assume that</font>

552
00:19:32,200 --> 00:19:35,950
you're someone<font color="#E5E5E5"> that's trying to pop a</font>

553
00:19:33,940 --> 00:19:37,600
company explicitly<font color="#E5E5E5"> and if you don't</font>

554
00:19:35,950 --> 00:19:38,740
write JavaScript code congratulations

555
00:19:37,600 --> 00:19:39,969
you can already<font color="#CCCCCC"> look like a bad</font>

556
00:19:38,740 --> 00:19:44,680
developer the moment you start<font color="#E5E5E5"> trying</font>

557
00:19:39,970 --> 00:19:46,900
this stuff<font color="#E5E5E5"> it's super easy so just as an</font>

558
00:19:44,680 --> 00:19:48,640
example<font color="#E5E5E5"> like I mentioned that custom</font><font color="#CCCCCC"> URI</font>

559
00:19:46,900 --> 00:19:50,830
scheme before<font color="#E5E5E5"> this is how</font><font color="#CCCCCC"> you would</font>

560
00:19:48,640 --> 00:19:52,480
implement<font color="#E5E5E5"> a custom URI scheme to say if</font>

561
00:19:50,830 --> 00:19:53,770
you try to go<font color="#E5E5E5"> to like</font><font color="#CCCCCC"> Derby con colon</font>

562
00:19:52,480 --> 00:19:55,540
forward slash forward<font color="#E5E5E5"> slash I'm just</font>

563
00:19:53,770 --> 00:19:58,120
gonna<font color="#E5E5E5"> redirect you to Derby con com it's</font>

564
00:19:55,540 --> 00:19:59,740
a really<font color="#E5E5E5"> really you know there's there's</font>

565
00:19:58,120 --> 00:20:01,539
nothing<font color="#E5E5E5"> bad about this this is totally</font>

566
00:19:59,740 --> 00:20:03,399
<font color="#CCCCCC">benign but you need</font>

567
00:20:01,539 --> 00:20:05,919
<font color="#E5E5E5">web requests and web</font><font color="#CCCCCC"> requests blocking</font>

568
00:20:03,399 --> 00:20:07,299
permissions<font color="#E5E5E5"> in order to request it so</font>

569
00:20:05,919 --> 00:20:08,139
you can just come up<font color="#CCCCCC"> with some really</font>

570
00:20:07,299 --> 00:20:10,149
<font color="#CCCCCC">tie</font>

571
00:20:08,139 --> 00:20:11,559
<font color="#CCCCCC">of the permissions and</font><font color="#E5E5E5"> then when someone</font>

572
00:20:10,149 --> 00:20:13,119
<font color="#E5E5E5">looks at</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> like oh yeah that's why</font>

573
00:20:11,559 --> 00:20:15,279
you're<font color="#E5E5E5"> doing it but that's not a big</font>

574
00:20:13,119 --> 00:20:18,459
deal<font color="#CCCCCC"> and then later on you push down the</font>

575
00:20:15,279 --> 00:20:21,039
real bad stuff another<font color="#E5E5E5"> trick for</font>

576
00:20:18,460 --> 00:20:22,539
obfuscating<font color="#E5E5E5"> without being</font><font color="#CCCCCC"> officially</font>

577
00:20:21,039 --> 00:20:25,600
<font color="#CCCCCC">label is obfuscation which you're not</font>

578
00:20:22,539 --> 00:20:27,850
<font color="#E5E5E5">allowed to do is to bundle everything so</font>

579
00:20:25,600 --> 00:20:30,699
there's tools called browserify<font color="#E5E5E5"> and web</font>

580
00:20:27,850 --> 00:20:34,178
pack which let you take large nodejs or

581
00:20:30,700 --> 00:20:36,609
<font color="#CCCCCC">commonjs</font><font color="#E5E5E5"> modules and just jam them all</font>

582
00:20:34,179 --> 00:20:38,769
into<font color="#E5E5E5"> a single</font><font color="#CCCCCC"> file for ease of running</font>

583
00:20:36,609 --> 00:20:40,809
in your browser<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can do</font><font color="#E5E5E5"> this with</font>

584
00:20:38,769 --> 00:20:42,279
any pure JavaScript implementation so

585
00:20:40,809 --> 00:20:43,869
say you're like well I want compression

586
00:20:42,279 --> 00:20:46,149
I want encryption I'm gonna want a

587
00:20:43,869 --> 00:20:49,080
couple of functions<font color="#E5E5E5"> in my actual payload</font>

588
00:20:46,149 --> 00:20:51,518
<font color="#CCCCCC">I'll just put it into</font><font color="#E5E5E5"> the real thing</font>

589
00:20:49,080 --> 00:20:53,978
<font color="#E5E5E5">browserify that entirely so it's one</font>

590
00:20:51,519 --> 00:20:55,779
file and<font color="#E5E5E5"> now I've got like a</font><font color="#CCCCCC"> 30,000</font>

591
00:20:53,979 --> 00:20:57,129
point<font color="#E5E5E5"> javascript file</font><font color="#CCCCCC"> that I</font><font color="#E5E5E5"> can hide</font>

592
00:20:55,779 --> 00:20:58,690
some bad stuff<font color="#E5E5E5"> in and it's gonna be</font>

593
00:20:57,129 --> 00:21:00,668
really hard<font color="#E5E5E5"> for an analyst</font><font color="#CCCCCC"> to really</font>

594
00:20:58,690 --> 00:21:03,580
quickly<font color="#E5E5E5"> look at that and say hey look</font>

595
00:21:00,669 --> 00:21:04,809
<font color="#CCCCCC">what you're doing online 27,000 652 as</font>

596
00:21:03,580 --> 00:21:07,139
<font color="#E5E5E5">long as I don't get picked up by</font>

597
00:21:04,809 --> 00:21:09,580
conventional static<font color="#E5E5E5"> analysis tools</font>

598
00:21:07,139 --> 00:21:11,349
<font color="#CCCCCC">because it's a commonly used developer</font>

599
00:21:09,580 --> 00:21:12,728
tool this<font color="#CCCCCC"> is a common approach</font><font color="#E5E5E5"> and a lot</font>

600
00:21:11,349 --> 00:21:13,928
of<font color="#CCCCCC"> JavaScript applications it's not</font>

601
00:21:12,729 --> 00:21:15,989
going to look<font color="#E5E5E5"> like you're trying to do</font>

602
00:21:13,929 --> 00:21:18,519
anything<font color="#CCCCCC"> Shady</font>

603
00:21:15,989 --> 00:21:20,559
but fundamentally<font color="#CCCCCC"> what we need to do is</font>

604
00:21:18,519 --> 00:21:23,619
within our actual extension<font color="#CCCCCC"> we need to</font>

605
00:21:20,559 --> 00:21:25,029
hide what acts as an evaluation<font color="#E5E5E5"> because</font>

606
00:21:23,619 --> 00:21:27,428
we need to push down<font color="#E5E5E5"> some code and have</font>

607
00:21:25,029 --> 00:21:29,409
it remotely execute so if you just put

608
00:21:27,429 --> 00:21:30,820
<font color="#E5E5E5">an eval somewhere that's</font><font color="#CCCCCC"> gonna show</font><font color="#E5E5E5"> up</font>

609
00:21:29,409 --> 00:21:32,519
immediately everyone's<font color="#E5E5E5"> gonna recognize</font>

610
00:21:30,820 --> 00:21:34,869
<font color="#E5E5E5">oh look at that</font><font color="#CCCCCC"> evil that's</font><font color="#E5E5E5"> a problem</font>

611
00:21:32,519 --> 00:21:36,190
<font color="#E5E5E5">but you've got a lot</font><font color="#CCCCCC"> of options because</font>

612
00:21:34,869 --> 00:21:38,259
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Java Script</font><font color="#E5E5E5"> this is a super</font>

613
00:21:36,190 --> 00:21:39,609
powerful<font color="#E5E5E5"> language we can write eval or</font>

614
00:21:38,259 --> 00:21:41,529
we can write constructor constructor

615
00:21:39,609 --> 00:21:43,689
constructor and pass<font color="#E5E5E5"> in the same content</font>

616
00:21:41,529 --> 00:21:46,479
<font color="#E5E5E5">and it will still evaluate there's tons</font>

617
00:21:43,690 --> 00:21:49,059
of<font color="#E5E5E5"> these like really awesome</font><font color="#CCCCCC"> and silly</font>

618
00:21:46,479 --> 00:21:50,830
gotchas<font color="#CCCCCC"> and javascript</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> go look</font>

619
00:21:49,059 --> 00:21:52,450
for<font color="#E5E5E5"> any underhanded</font><font color="#CCCCCC"> JavaScript</font>

620
00:21:50,830 --> 00:21:55,478
presentation and you'll find all<font color="#CCCCCC"> kinds</font>

621
00:21:52,450 --> 00:21:57,759
of tools<font color="#CCCCCC"> that you can use here if you</font>

622
00:21:55,479 --> 00:21:59,830
put<font color="#E5E5E5"> that inside</font><font color="#CCCCCC"> that 25,000 line</font>

623
00:21:57,759 --> 00:22:01,059
monstrosity which we just browser<font color="#CCCCCC"> a 5</font>

624
00:21:59,830 --> 00:22:03,039
you're really gonna make somebody's day

625
00:22:01,059 --> 00:22:05,200
really frustrating if they want<font color="#E5E5E5"> to find</font>

626
00:22:03,039 --> 00:22:07,029
what you're doing<font color="#E5E5E5"> and then finally</font>

627
00:22:05,200 --> 00:22:08,739
another<font color="#E5E5E5"> idea is just you take a</font>

628
00:22:07,029 --> 00:22:11,409
previously<font color="#E5E5E5"> known to be vulnerable</font>

629
00:22:08,739 --> 00:22:12,580
library and then exploit<font color="#E5E5E5"> whatever the</font>

630
00:22:11,409 --> 00:22:14,799
cross-site scripting vulnerability is

631
00:22:12,580 --> 00:22:15,280
inside there and no one will<font color="#E5E5E5"> be the</font>

632
00:22:14,799 --> 00:22:16,780
wiser

633
00:22:15,280 --> 00:22:18,970
and a lot<font color="#CCCCCC"> of the time</font><font color="#E5E5E5"> unless you've got</font>

634
00:22:16,780 --> 00:22:20,080
some real cross-site scripting hotshot

635
00:22:18,970 --> 00:22:21,340
looking at your stuff it's gonna be

636
00:22:20,080 --> 00:22:22,480
really hard<font color="#E5E5E5"> to tell</font><font color="#CCCCCC"> that as they're</font>

637
00:22:21,340 --> 00:22:24,429
<font color="#E5E5E5">looking at this stuff</font><font color="#CCCCCC"> there's just way</font>

638
00:22:22,480 --> 00:22:27,970
<font color="#E5E5E5">too big of a queue for really detailed</font>

639
00:22:24,430 --> 00:22:29,320
analysis<font color="#E5E5E5"> and this is just one</font><font color="#CCCCCC"> other</font>

640
00:22:27,970 --> 00:22:31,540
point I wanted<font color="#E5E5E5"> to make which</font><font color="#CCCCCC"> is you're</font>

641
00:22:29,320 --> 00:22:34,510
not allowed<font color="#CCCCCC"> to obfuscate but you are</font>

642
00:22:31,540 --> 00:22:36,760
allowed to minify<font color="#E5E5E5"> and as far as I'm</font>

643
00:22:34,510 --> 00:22:39,250
concerned<font color="#E5E5E5"> they're very similar things</font><font color="#CCCCCC"> I</font>

644
00:22:36,760 --> 00:22:40,900
showed this to<font color="#CCCCCC"> a colleague</font><font color="#E5E5E5"> and he said I</font>

645
00:22:39,250 --> 00:22:41,920
don't<font color="#E5E5E5"> know why you're using that</font><font color="#CCCCCC"> as your</font>

646
00:22:40,900 --> 00:22:44,230
<font color="#CCCCCC">example</font>

647
00:22:41,920 --> 00:22:46,210
that's way too easy<font color="#CCCCCC"> to tell what's</font>

648
00:22:44,230 --> 00:22:49,360
<font color="#CCCCCC">happening</font><font color="#E5E5E5"> you just</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> use any</font>

649
00:22:46,210 --> 00:22:50,680
Silicon Valley darling company and look

650
00:22:49,360 --> 00:22:53,139
at how their site runs when you go to

651
00:22:50,680 --> 00:22:55,630
page one<font color="#E5E5E5"> and it will blow people's minds</font>

652
00:22:53,140 --> 00:22:57,700
and he's totally right<font color="#E5E5E5"> it is very</font>

653
00:22:55,630 --> 00:22:59,890
<font color="#CCCCCC">possible to</font><font color="#E5E5E5"> make a minified bit of</font>

654
00:22:57,700 --> 00:23:01,210
<font color="#E5E5E5">JavaScript like completely unpossible to</font>

655
00:22:59,890 --> 00:23:03,420
the average<font color="#E5E5E5"> human being regardless</font><font color="#CCCCCC"> of</font>

656
00:23:01,210 --> 00:23:06,040
whether they<font color="#E5E5E5"> have tools</font><font color="#CCCCCC"> to assist or not</font>

657
00:23:03,420 --> 00:23:08,710
<font color="#E5E5E5">the final piece is a trick which I like</font>

658
00:23:06,040 --> 00:23:10,540
is using example code<font color="#E5E5E5"> one of the things</font>

659
00:23:08,710 --> 00:23:13,270
you're<font color="#CCCCCC"> gonna have to do is say</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> well</font>

660
00:23:10,540 --> 00:23:15,129
I have all these pretexts<font color="#E5E5E5"> I need to like</font>

661
00:23:13,270 --> 00:23:17,170
fill<font color="#E5E5E5"> out an actual chat application</font>

662
00:23:15,130 --> 00:23:19,300
where am I gonna<font color="#E5E5E5"> get this from and a</font>

663
00:23:17,170 --> 00:23:21,130
great place<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get it is like my first</font>

664
00:23:19,300 --> 00:23:23,620
JavaScript chat client<font color="#E5E5E5"> you can just</font>

665
00:23:21,130 --> 00:23:25,000
literally go grab this code dump<font color="#E5E5E5"> it into</font>

666
00:23:23,620 --> 00:23:26,409
your<font color="#E5E5E5"> extension you don't even have to</font>

667
00:23:25,000 --> 00:23:28,480
use most of<font color="#CCCCCC"> it</font><font color="#E5E5E5"> because think of how you</font>

668
00:23:26,410 --> 00:23:30,610
see extent the example<font color="#CCCCCC"> code used in</font>

669
00:23:28,480 --> 00:23:31,990
projects<font color="#E5E5E5"> that you look at it maybe was</font>

670
00:23:30,610 --> 00:23:33,790
<font color="#CCCCCC">the base for what</font><font color="#E5E5E5"> the project was but</font>

671
00:23:31,990 --> 00:23:36,700
<font color="#E5E5E5">most of the code that's in there now is</font>

672
00:23:33,790 --> 00:23:38,710
dead it's not<font color="#E5E5E5"> used it there's a lot of</font>

673
00:23:36,700 --> 00:23:40,150
comments to explain it but<font color="#CCCCCC"> you know most</font>

674
00:23:38,710 --> 00:23:41,560
of it doesn't<font color="#E5E5E5"> matter and that's okay</font>

675
00:23:40,150 --> 00:23:43,630
because it's example code this is how a

676
00:23:41,560 --> 00:23:45,399
<font color="#CCCCCC">lot of people start but it</font><font color="#E5E5E5"> certainly</font>

677
00:23:43,630 --> 00:23:48,190
doesn't<font color="#E5E5E5"> look like it's maliciously</font>

678
00:23:45,400 --> 00:23:49,840
creating lots of flow to hide<font color="#E5E5E5"> another</font>

679
00:23:48,190 --> 00:23:51,340
<font color="#CCCCCC">evil</font><font color="#E5E5E5"> statement and but that's what it is</font>

680
00:23:49,840 --> 00:23:53,740
<font color="#E5E5E5">for</font><font color="#CCCCCC"> you</font>

681
00:23:51,340 --> 00:23:54,939
so just<font color="#E5E5E5"> Google</font><font color="#CCCCCC"> for some application</font>

682
00:23:53,740 --> 00:23:57,190
that's roughly similar<font color="#E5E5E5"> to what you want</font>

683
00:23:54,940 --> 00:24:00,760
to do<font color="#E5E5E5"> grab the example and then you're</font>

684
00:23:57,190 --> 00:24:02,140
good<font color="#CCCCCC"> to go</font><font color="#E5E5E5"> as an added bonus</font><font color="#CCCCCC"> I'm pretty</font>

685
00:24:00,760 --> 00:24:04,120
<font color="#CCCCCC">sure</font><font color="#E5E5E5"> that a lot of</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> extension</font>

686
00:24:02,140 --> 00:24:07,750
stores<font color="#E5E5E5"> will do some degree of</font><font color="#CCCCCC"> static</font>

687
00:24:04,120 --> 00:24:11,050
<font color="#E5E5E5">analysis to compare</font><font color="#CCCCCC"> different plugins</font><font color="#E5E5E5"> or</font>

688
00:24:07,750 --> 00:24:12,610
<font color="#E5E5E5">different extensions and if you only</font>

689
00:24:11,050 --> 00:24:13,990
match with one extension<font color="#E5E5E5"> they're</font>

690
00:24:12,610 --> 00:24:15,129
probably going to<font color="#E5E5E5"> assume you</font><font color="#CCCCCC"> just copied</font>

691
00:24:13,990 --> 00:24:17,140
somebody else's extension you're trying

692
00:24:15,130 --> 00:24:18,430
to<font color="#E5E5E5"> perform fraud but if you match</font><font color="#CCCCCC"> with</font>

693
00:24:17,140 --> 00:24:19,750
dozens of extensions<font color="#CCCCCC"> because lots of</font>

694
00:24:18,430 --> 00:24:23,500
people<font color="#CCCCCC"> use example code you're probably</font>

695
00:24:19,750 --> 00:24:24,970
gonna slip under the<font color="#CCCCCC"> radar</font><font color="#E5E5E5"> but what do</font>

696
00:24:23,500 --> 00:24:26,260
you<font color="#E5E5E5"> use for your actual extension</font>

697
00:24:24,970 --> 00:24:27,580
command and control<font color="#E5E5E5"> and this is</font>

698
00:24:26,260 --> 00:24:29,169
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that I think</font><font color="#E5E5E5"> could probably be</font>

699
00:24:27,580 --> 00:24:30,879
a talk in its own right

700
00:24:29,169 --> 00:24:33,190
you have to keep in<font color="#CCCCCC"> mind</font><font color="#E5E5E5"> that reviewers</font>

701
00:24:30,879 --> 00:24:34,330
<font color="#E5E5E5">are suspicious about any external calls</font>

702
00:24:33,190 --> 00:24:35,769
which download something this<font color="#E5E5E5"> is the</font>

703
00:24:34,330 --> 00:24:38,228
<font color="#E5E5E5">number one way we're getting our payload</font>

704
00:24:35,769 --> 00:24:40,119
into the<font color="#E5E5E5"> actual extension but I think</font>

705
00:24:38,229 --> 00:24:41,889
that we can hide behind technology<font color="#CCCCCC"> that</font>

706
00:24:40,119 --> 00:24:43,238
is just so<font color="#E5E5E5"> complicated there's no</font>

707
00:24:41,889 --> 00:24:45,189
<font color="#E5E5E5">reasonable</font><font color="#CCCCCC"> way that someone's going to</font>

708
00:24:43,239 --> 00:24:47,169
understand what's<font color="#E5E5E5"> happening and the</font>

709
00:24:45,190 --> 00:24:49,479
place<font color="#E5E5E5"> that I like to hide is something</font>

710
00:24:47,169 --> 00:24:51,759
that is called mobile backend as a

711
00:24:49,479 --> 00:24:55,419
service also<font color="#E5E5E5"> known as</font><font color="#CCCCCC"> Google boss and</font>

712
00:24:51,759 --> 00:24:57,580
it's really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> because that</font>

713
00:24:55,419 --> 00:24:59,859
<font color="#E5E5E5">what this is is pretty much a one</font>

714
00:24:57,580 --> 00:25:01,239
<font color="#E5E5E5">javascript file include that's supposed</font>

715
00:24:59,859 --> 00:25:06,580
<font color="#E5E5E5">to give you functionality like a be</font>

716
00:25:01,239 --> 00:25:08,769
testing and authorization<font color="#CCCCCC"> and real</font><font color="#E5E5E5"> time</font>

717
00:25:06,580 --> 00:25:10,809
database functionality like<font color="#E5E5E5"> you can have</font>

718
00:25:08,769 --> 00:25:12,279
like Redis in<font color="#E5E5E5"> JavaScript for yourself</font>

719
00:25:10,809 --> 00:25:16,418
and that's<font color="#E5E5E5"> just a common thing</font><font color="#CCCCCC"> that</font>

720
00:25:12,279 --> 00:25:18,999
<font color="#CCCCCC">people will want right and so Google's</font>

721
00:25:16,419 --> 00:25:21,580
own firebase<font color="#E5E5E5"> does all of this for us and</font>

722
00:25:18,999 --> 00:25:23,590
<font color="#E5E5E5">it makes for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> really awesome</font><font color="#CCCCCC"> c2 channel</font>

723
00:25:21,580 --> 00:25:25,059
for lots of reasons in fact the<font color="#CCCCCC"> reason I</font>

724
00:25:23,590 --> 00:25:26,830
know about<font color="#E5E5E5"> firebase is while I was</font>

725
00:25:25,059 --> 00:25:28,149
<font color="#E5E5E5">reading the documentation for how they</font>

726
00:25:26,830 --> 00:25:31,210
suggest handling some degrees<font color="#CCCCCC"> of</font>

727
00:25:28,149 --> 00:25:33,219
messaging<font color="#E5E5E5"> Google explicitly says in your</font>

728
00:25:31,210 --> 00:25:34,840
extensions you<font color="#E5E5E5"> should use firebase</font><font color="#CCCCCC"> so</font>

729
00:25:33,220 --> 00:25:36,669
I'm pretty<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that this is not going</font>

730
00:25:34,840 --> 00:25:38,289
<font color="#E5E5E5">to get you banned or pulled from the</font>

731
00:25:36,669 --> 00:25:40,570
<font color="#CCCCCC">webstore as their own documentation</font><font color="#E5E5E5"> says</font>

732
00:25:38,289 --> 00:25:43,029
you should totally<font color="#CCCCCC"> use this as an added</font>

733
00:25:40,570 --> 00:25:44,168
bonus<font color="#E5E5E5"> it's all over WebSockets</font><font color="#CCCCCC"> I don't</font>

734
00:25:43,029 --> 00:25:45,820
know how many<font color="#E5E5E5"> of you</font><font color="#CCCCCC"> who have ever had</font>

735
00:25:44,169 --> 00:25:48,609
<font color="#CCCCCC">it's a</font><font color="#E5E5E5"> man-in-the-middle WebSockets it's</font>

736
00:25:45,820 --> 00:25:50,739
kind of<font color="#E5E5E5"> a pain</font><font color="#CCCCCC"> in the butt so it's an</font>

737
00:25:48,609 --> 00:25:52,359
added bonus<font color="#CCCCCC"> that all of this traffic is</font>

738
00:25:50,739 --> 00:25:54,009
<font color="#E5E5E5">just like really frustrating imagine a</font>

739
00:25:52,359 --> 00:25:56,320
WebSocket connection going<font color="#E5E5E5"> to a very</font>

740
00:25:54,009 --> 00:25:57,999
trusted entity<font color="#E5E5E5"> like Google it's probably</font>

741
00:25:56,320 --> 00:25:59,439
not gonna stand out as<font color="#E5E5E5"> much as something</font>

742
00:25:57,999 --> 00:26:00,700
going to like your own<font color="#CCCCCC"> shave ec2 what</font>

743
00:25:59,440 --> 00:26:04,899
you're running<font color="#CCCCCC"> on</font><font color="#E5E5E5"> you know who knows</font>

744
00:26:00,700 --> 00:26:05,889
where but<font color="#E5E5E5"> Mike</font><font color="#CCCCCC"> I hear you say I</font><font color="#E5E5E5"> don't</font>

745
00:26:04,899 --> 00:26:08,199
want to have to do<font color="#CCCCCC"> all this you've just</font>

746
00:26:05,889 --> 00:26:09,789
<font color="#E5E5E5">described an incredibly frustrating</font>

747
00:26:08,200 --> 00:26:11,320
amount of work to<font color="#CCCCCC"> do and and you're</font><font color="#E5E5E5"> not</font>

748
00:26:09,789 --> 00:26:13,330
wrong<font color="#E5E5E5"> it it takes a good amount of</font>

749
00:26:11,320 --> 00:26:15,489
effort<font color="#E5E5E5"> to make one of these but if</font>

750
00:26:13,330 --> 00:26:17,710
you're<font color="#E5E5E5"> feeling a little less work</font>

751
00:26:15,489 --> 00:26:19,539
inspired another good option<font color="#CCCCCC"> is you can</font>

752
00:26:17,710 --> 00:26:20,769
<font color="#CCCCCC">just clone an existing extension there's</font>

753
00:26:19,539 --> 00:26:22,179
people that<font color="#E5E5E5"> have already implemented</font>

754
00:26:20,769 --> 00:26:23,769
extensions that do all<font color="#E5E5E5"> the things we</font>

755
00:26:22,179 --> 00:26:26,830
<font color="#E5E5E5">need</font><font color="#CCCCCC"> to try to pretend</font><font color="#E5E5E5"> to do there's no</font>

756
00:26:23,769 --> 00:26:29,409
reason to reinvent<font color="#CCCCCC"> the wheel so given</font>

757
00:26:26,830 --> 00:26:31,178
that most<font color="#E5E5E5"> of the stuff that we can find</font>

758
00:26:29,409 --> 00:26:32,979
in the web<font color="#E5E5E5"> store</font><font color="#CCCCCC"> is already as asking</font>

759
00:26:31,179 --> 00:26:35,169
<font color="#E5E5E5">for too many permissions we can pick one</font>

760
00:26:32,979 --> 00:26:37,839
<font color="#E5E5E5">that's doing that grab of a code</font>

761
00:26:35,169 --> 00:26:38,879
wholesale and then resubmit it<font color="#CCCCCC"> we'll</font>

762
00:26:37,839 --> 00:26:41,499
need to<font color="#E5E5E5"> make some changes</font>

763
00:26:38,879 --> 00:26:42,520
<font color="#CCCCCC">you can't just literally take</font><font color="#E5E5E5"> the</font>

764
00:26:41,499 --> 00:26:45,310
extension<font color="#CCCCCC"> you can't say</font>

765
00:26:42,520 --> 00:26:47,139
this is my app and then call yourself my

766
00:26:45,310 --> 00:26:48,610
app<font color="#CCCCCC"> - or</font><font color="#E5E5E5"> something and hope that</font>

767
00:26:47,140 --> 00:26:49,630
nobody's<font color="#E5E5E5"> gonna notice that's no good you</font>

768
00:26:48,610 --> 00:26:50,770
need to be a little<font color="#CCCCCC"> more</font><font color="#E5E5E5"> creative than</font>

769
00:26:49,630 --> 00:26:53,530
<font color="#CCCCCC">that</font><font color="#E5E5E5"> but it's still</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be</font>

770
00:26:50,770 --> 00:26:55,930
fundamentally easier than having<font color="#E5E5E5"> to deal</font>

771
00:26:53,530 --> 00:26:57,790
with<font color="#CCCCCC"> writing an entire extension</font><font color="#E5E5E5"> from</font>

772
00:26:55,930 --> 00:26:59,140
scratch<font color="#E5E5E5"> the stuff you're really going to</font>

773
00:26:57,790 --> 00:27:01,540
<font color="#CCCCCC">want</font><font color="#E5E5E5"> to do is make sure that</font><font color="#CCCCCC"> your code</font>

774
00:26:59,140 --> 00:27:03,400
runs on the on<font color="#CCCCCC"> installation and on</font>

775
00:27:01,540 --> 00:27:04,930
startup<font color="#E5E5E5"> run time events because that's</font>

776
00:27:03,400 --> 00:27:06,160
<font color="#E5E5E5">going to make sure</font><font color="#CCCCCC"> that your code always</font>

777
00:27:04,930 --> 00:27:08,920
runs whenever the extensions were

778
00:27:06,160 --> 00:27:14,020
started<font color="#E5E5E5"> or when they install it for the</font>

779
00:27:08,920 --> 00:27:16,030
first time and one<font color="#E5E5E5"> of the reasons that I</font>

780
00:27:14,020 --> 00:27:19,060
bring up<font color="#E5E5E5"> renaming your extension is</font>

781
00:27:16,030 --> 00:27:21,399
because it's it can<font color="#E5E5E5"> be kind of hard</font><font color="#CCCCCC"> to</font>

782
00:27:19,060 --> 00:27:24,700
see what's the real version of what

783
00:27:21,400 --> 00:27:26,260
you're looking<font color="#E5E5E5"> for at a glance</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> only</font>

784
00:27:24,700 --> 00:27:28,630
<font color="#E5E5E5">information you're shown in the stores</font>

785
00:27:26,260 --> 00:27:31,360
frequently is stuff<font color="#E5E5E5"> like here's an icon</font>

786
00:27:28,630 --> 00:27:34,570
<font color="#E5E5E5">here's some reviews and</font><font color="#CCCCCC"> here's a rating</font>

787
00:27:31,360 --> 00:27:36,219
for those<font color="#E5E5E5"> reviews and we can fake all of</font>

788
00:27:34,570 --> 00:27:39,879
this<font color="#E5E5E5"> this isn't stuff that's beyond our</font>

789
00:27:36,220 --> 00:27:41,920
realm<font color="#CCCCCC"> in some cases stuff isn't</font><font color="#E5E5E5"> even</font>

790
00:27:39,880 --> 00:27:43,240
<font color="#E5E5E5">really use</font><font color="#CCCCCC"> that much and but it's</font><font color="#E5E5E5"> still</font>

791
00:27:41,920 --> 00:27:47,980
the<font color="#CCCCCC"> official thing so like</font><font color="#E5E5E5"> here we've</font>

792
00:27:43,240 --> 00:27:49,630
got this<font color="#E5E5E5"> WebEx content sharing extension</font>

793
00:27:47,980 --> 00:27:51,220
it's got<font color="#E5E5E5"> 21 ratings</font>

794
00:27:49,630 --> 00:27:52,780
<font color="#E5E5E5">I've got extensions that</font><font color="#CCCCCC"> have more</font>

795
00:27:51,220 --> 00:27:55,960
ratings<font color="#E5E5E5"> than that that I've just created</font>

796
00:27:52,780 --> 00:27:57,280
<font color="#E5E5E5">for gigs it's not that challenging</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to</font>

797
00:27:55,960 --> 00:28:00,460
make happen but we'll talk<font color="#E5E5E5"> about that</font>

798
00:27:57,280 --> 00:28:01,960
<font color="#CCCCCC">one</font><font color="#E5E5E5"> of it my main point is that it is</font>

799
00:28:00,460 --> 00:28:04,560
<font color="#E5E5E5">possible to clone an extension and</font>

800
00:28:01,960 --> 00:28:06,550
people really can't tell<font color="#E5E5E5"> the</font><font color="#CCCCCC"> difference</font>

801
00:28:04,560 --> 00:28:08,500
<font color="#E5E5E5">so we're gonna have</font><font color="#CCCCCC"> to submit</font><font color="#E5E5E5"> this stuff</font>

802
00:28:06,550 --> 00:28:09,760
to a<font color="#CCCCCC"> webstore eventually</font><font color="#E5E5E5"> and because</font>

803
00:28:08,500 --> 00:28:11,200
it's<font color="#E5E5E5"> easiest way that</font><font color="#CCCCCC"> we can distribute</font>

804
00:28:09,760 --> 00:28:12,790
anything<font color="#E5E5E5"> that we're gonna have and</font>

805
00:28:11,200 --> 00:28:14,200
you're gonna need to<font color="#E5E5E5"> get your graphics</font>

806
00:28:12,790 --> 00:28:15,580
<font color="#E5E5E5">from somewhere and the more professional</font>

807
00:28:14,200 --> 00:28:17,200
<font color="#E5E5E5">they look the better</font><font color="#CCCCCC"> like all social</font>

808
00:28:15,580 --> 00:28:19,419
<font color="#E5E5E5">engineering the more effort that you put</font>

809
00:28:17,200 --> 00:28:22,090
into<font color="#CCCCCC"> it the</font><font color="#E5E5E5"> more professional it</font><font color="#CCCCCC"> looks</font>

810
00:28:19,420 --> 00:28:23,230
the more<font color="#E5E5E5"> successful</font><font color="#CCCCCC"> it'll be so you</font>

811
00:28:22,090 --> 00:28:25,360
should<font color="#CCCCCC"> just you can copy it from</font>

812
00:28:23,230 --> 00:28:27,190
somewhere<font color="#E5E5E5"> but make sure you modify</font><font color="#CCCCCC"> that</font>

813
00:28:25,360 --> 00:28:29,439
content<font color="#E5E5E5"> first if you just pull an image</font>

814
00:28:27,190 --> 00:28:31,920
<font color="#E5E5E5">and</font><font color="#CCCCCC"> some text of what the extension</font><font color="#E5E5E5"> does</font>

815
00:28:29,440 --> 00:28:34,300
<font color="#E5E5E5">there's a possibility that during the</font>

816
00:28:31,920 --> 00:28:35,740
initial review phase<font color="#E5E5E5"> they're going to</font>

817
00:28:34,300 --> 00:28:37,870
check to see<font color="#E5E5E5"> if you've just copied</font>

818
00:28:35,740 --> 00:28:39,640
<font color="#E5E5E5">somebody else's extension and then</font>

819
00:28:37,870 --> 00:28:41,469
<font color="#E5E5E5">they're going to search for</font><font color="#CCCCCC"> that in</font>

820
00:28:39,640 --> 00:28:42,730
<font color="#CCCCCC">Google or whatever and see oh look</font>

821
00:28:41,470 --> 00:28:44,890
that's<font color="#E5E5E5"> actually literally the</font>

822
00:28:42,730 --> 00:28:46,270
description<font color="#E5E5E5"> from this other tool I'm</font>

823
00:28:44,890 --> 00:28:47,860
guessing that's probably something

824
00:28:46,270 --> 00:28:48,910
<font color="#CCCCCC">that's been copied because somebody</font>

825
00:28:47,860 --> 00:28:49,810
wants to<font color="#E5E5E5"> make some extra</font><font color="#CCCCCC"> money</font><font color="#E5E5E5"> or</font>

826
00:28:48,910 --> 00:28:52,030
something<font color="#E5E5E5"> now you're just gonna get</font>

827
00:28:49,810 --> 00:28:53,710
<font color="#E5E5E5">pulled from the store</font><font color="#CCCCCC"> edit graphics</font>

828
00:28:52,030 --> 00:28:55,120
slightly like change the<font color="#E5E5E5"> color or tint</font>

829
00:28:53,710 --> 00:28:56,350
<font color="#E5E5E5">something that make sure</font><font color="#CCCCCC"> that a reverse</font>

830
00:28:55,120 --> 00:28:59,649
<font color="#E5E5E5">image search isn't going to take</font>

831
00:28:56,350 --> 00:29:02,049
<font color="#CCCCCC">-</font><font color="#E5E5E5"> exactly where you took it</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> also</font>

832
00:28:59,649 --> 00:29:04,209
worth noting as highlighted<font color="#CCCCCC"> by Chrome</font>

833
00:29:02,049 --> 00:29:05,649
this week the policies are always going

834
00:29:04,210 --> 00:29:07,120
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> changing so you have to be on the</font>

835
00:29:05,649 --> 00:29:09,549
lookout for<font color="#E5E5E5"> it what worked six months</font>

836
00:29:07,120 --> 00:29:10,750
ago<font color="#CCCCCC"> probably won't work now or any well</font>

837
00:29:09,549 --> 00:29:12,070
you never know it's really<font color="#E5E5E5"> a roll of the</font>

838
00:29:10,750 --> 00:29:13,799
<font color="#CCCCCC">dice</font><font color="#E5E5E5"> but that's pretty much everything</font>

839
00:29:12,070 --> 00:29:16,120
<font color="#E5E5E5">in the field</font>

840
00:29:13,799 --> 00:29:18,158
so let's actually<font color="#E5E5E5"> talk about</font><font color="#CCCCCC"> the Google</font>

841
00:29:16,120 --> 00:29:20,229
<font color="#E5E5E5">Web Store when you submit to this you're</font>

842
00:29:18,159 --> 00:29:23,110
going<font color="#E5E5E5"> to need a Google account</font><font color="#CCCCCC"> five</font>

843
00:29:20,230 --> 00:29:25,600
bucks<font color="#CCCCCC"> and a</font><font color="#E5E5E5"> credit card</font><font color="#CCCCCC"> and it's worth</font>

844
00:29:23,110 --> 00:29:27,459
noting<font color="#CCCCCC"> that though</font><font color="#E5E5E5"> it's probably not</font>

845
00:29:25,600 --> 00:29:29,439
explicitly<font color="#E5E5E5"> stated they probably</font>

846
00:29:27,460 --> 00:29:31,149
correlate<font color="#E5E5E5"> extensions based off of the</font>

847
00:29:29,440 --> 00:29:34,389
credit card you use so if you register

848
00:29:31,149 --> 00:29:36,039
say<font color="#CCCCCC"> fifteen malicious extensions on the</font>

849
00:29:34,389 --> 00:29:37,750
<font color="#E5E5E5">same credit card</font><font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of them gets</font>

850
00:29:36,039 --> 00:29:39,158
detected<font color="#CCCCCC"> that's a very easy pivot for</font>

851
00:29:37,750 --> 00:29:41,379
them to say oh<font color="#E5E5E5"> look these other</font><font color="#CCCCCC"> fourteen</font>

852
00:29:39,159 --> 00:29:43,960
are probably<font color="#CCCCCC"> bad - so you</font><font color="#E5E5E5"> can use</font>

853
00:29:41,379 --> 00:29:46,539
prepaid visas<font color="#E5E5E5"> just get a couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those</font>

854
00:29:43,960 --> 00:29:48,759
and<font color="#E5E5E5"> you know go</font><font color="#CCCCCC"> to town</font><font color="#E5E5E5"> you can set the</font>

855
00:29:46,539 --> 00:29:50,980
extensions visibility to private public

856
00:29:48,759 --> 00:29:52,090
<font color="#E5E5E5">or link only link</font><font color="#CCCCCC"> only was my personal</font>

857
00:29:50,980 --> 00:29:54,250
favorite<font color="#CCCCCC"> because that meant it was</font>

858
00:29:52,090 --> 00:29:55,449
published<font color="#E5E5E5"> and live but some random</font>

859
00:29:54,250 --> 00:29:56,950
person<font color="#E5E5E5"> wasn't going to install it off</font>

860
00:29:55,450 --> 00:29:58,570
the<font color="#E5E5E5"> Stork remember that bit about like</font>

861
00:29:56,950 --> 00:30:01,600
not<font color="#E5E5E5"> having to infect way too many people</font>

862
00:29:58,570 --> 00:30:03,220
<font color="#E5E5E5">this makes it much easier unfortunately</font>

863
00:30:01,600 --> 00:30:05,620
Google got wise<font color="#CCCCCC"> to this and if you</font>

864
00:30:03,220 --> 00:30:07,720
install an extension<font color="#E5E5E5"> from a link</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> on</font>

865
00:30:05,620 --> 00:30:09,610
restart they'll say hey did you really

866
00:30:07,720 --> 00:30:11,500
<font color="#E5E5E5">need to do this it was probably bad and</font>

867
00:30:09,610 --> 00:30:13,629
they'll disable it<font color="#CCCCCC"> so just</font><font color="#E5E5E5"> another</font>

868
00:30:11,500 --> 00:30:15,399
<font color="#E5E5E5">example of</font><font color="#CCCCCC"> Google</font><font color="#E5E5E5"> cutting down on a lot</font>

869
00:30:13,629 --> 00:30:17,129
of<font color="#E5E5E5"> our vectors for being able to infect</font>

870
00:30:15,399 --> 00:30:19,508
<font color="#CCCCCC">people with malicious extensions</font>

871
00:30:17,129 --> 00:30:22,509
obfuscation is also officially<font color="#E5E5E5"> been but</font>

872
00:30:19,509 --> 00:30:23,889
we've already talked<font color="#CCCCCC"> about that once you</font>

873
00:30:22,509 --> 00:30:25,600
do submit there's going to be a bunch<font color="#E5E5E5"> of</font>

874
00:30:23,889 --> 00:30:27,370
automated dynamic analysis you're gonna

875
00:30:25,600 --> 00:30:28,658
find<font color="#CCCCCC"> 10 to 15 different machines have</font>

876
00:30:27,370 --> 00:30:30,100
just<font color="#E5E5E5"> installed you over and</font><font color="#CCCCCC"> over again</font>

877
00:30:28,659 --> 00:30:31,659
<font color="#CCCCCC">they're gonna change their</font><font color="#E5E5E5"> timestamp</font>

878
00:30:30,100 --> 00:30:32,620
like<font color="#E5E5E5"> two years in the</font><font color="#CCCCCC"> future</font><font color="#E5E5E5"> so make</font>

879
00:30:31,659 --> 00:30:34,120
<font color="#CCCCCC">sure you're</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> using some sort</font><font color="#E5E5E5"> of</font>

880
00:30:32,620 --> 00:30:35,500
default logic bomb or<font color="#E5E5E5"> something like</font>

881
00:30:34,120 --> 00:30:36,639
that<font color="#E5E5E5"> which is totally</font><font color="#CCCCCC"> reasonable because</font>

882
00:30:35,500 --> 00:30:38,860
that's how<font color="#CCCCCC"> people used to get by this</font>

883
00:30:36,639 --> 00:30:40,418
<font color="#E5E5E5">they'd say I'm safe for the first two</font>

884
00:30:38,860 --> 00:30:42,879
<font color="#CCCCCC">months and then I turn</font><font color="#E5E5E5"> to an</font><font color="#CCCCCC"> ad-hoc</font>

885
00:30:40,419 --> 00:30:44,830
<font color="#E5E5E5">proxy you can actually tell</font><font color="#CCCCCC"> based</font><font color="#E5E5E5"> on</font>

886
00:30:42,879 --> 00:30:46,570
their user agents<font color="#E5E5E5"> what's probably</font><font color="#CCCCCC"> there</font>

887
00:30:44,830 --> 00:30:48,699
because who's using<font color="#E5E5E5"> like</font><font color="#CCCCCC"> Chrome</font><font color="#E5E5E5"> that's</font>

888
00:30:46,570 --> 00:30:50,289
from<font color="#E5E5E5"> seven plus versions ago it's pretty</font>

889
00:30:48,700 --> 00:30:51,159
hard to<font color="#E5E5E5"> do that but that seems to</font><font color="#CCCCCC"> be</font>

890
00:30:50,289 --> 00:30:54,070
what all<font color="#E5E5E5"> their connections</font><font color="#CCCCCC"> are the</font>

891
00:30:51,159 --> 00:30:56,200
<font color="#CCCCCC">battle change it used to be that</font><font color="#E5E5E5"> if you</font>

892
00:30:54,070 --> 00:30:59,139
got<font color="#E5E5E5"> past the automated analysis you were</font>

893
00:30:56,200 --> 00:31:01,480
live<font color="#CCCCCC"> on the store in under an hour but</font>

894
00:30:59,139 --> 00:31:03,250
<font color="#E5E5E5">as I understand it now when we request</font>

895
00:31:01,480 --> 00:31:04,299
<font color="#E5E5E5">these newer</font><font color="#CCCCCC"> wild card permissions which</font>

896
00:31:03,250 --> 00:31:05,799
we're<font color="#CCCCCC"> still going</font><font color="#E5E5E5"> to want it's going to</font>

897
00:31:04,299 --> 00:31:06,940
take a<font color="#E5E5E5"> couple of days so give yourself</font>

898
00:31:05,799 --> 00:31:08,408
some lead<font color="#CCCCCC"> time if you're doing this for</font>

899
00:31:06,940 --> 00:31:09,880
<font color="#CCCCCC">a gig don't just say I can make that</font>

900
00:31:08,409 --> 00:31:11,320
<font color="#E5E5E5">extension on Monday and be done</font>

901
00:31:09,880 --> 00:31:15,940
Friday it's probably gonna<font color="#CCCCCC"> take a little</font>

902
00:31:11,320 --> 00:31:17,290
<font color="#E5E5E5">more</font><font color="#CCCCCC"> time than that but on the</font><font color="#E5E5E5"> Mozilla</font>

903
00:31:15,940 --> 00:31:19,120
<font color="#E5E5E5">side it's a little bit different</font><font color="#CCCCCC"> you</font>

904
00:31:17,290 --> 00:31:20,850
<font color="#CCCCCC">just need an account</font><font color="#E5E5E5"> there's no credit</font>

905
00:31:19,120 --> 00:31:23,409
card you don't<font color="#E5E5E5"> pay for anything</font>

906
00:31:20,850 --> 00:31:25,959
<font color="#CCCCCC">similarly you</font><font color="#E5E5E5"> can flag things as public</font>

907
00:31:23,410 --> 00:31:28,180
<font color="#E5E5E5">or private</font><font color="#CCCCCC"> there's no listing view</font><font color="#E5E5E5"> but</font>

908
00:31:25,960 --> 00:31:29,880
<font color="#E5E5E5">that's pretty much</font><font color="#CCCCCC"> dead anyways you can</font>

909
00:31:28,180 --> 00:31:32,320
flag extensions as experimental

910
00:31:29,880 --> 00:31:34,930
<font color="#E5E5E5">allegedly this means that it</font><font color="#CCCCCC"> is less</font>

911
00:31:32,320 --> 00:31:36,189
scrutinized<font color="#CCCCCC"> because it's para mental</font><font color="#E5E5E5"> so</font>

912
00:31:34,930 --> 00:31:37,360
they put like<font color="#E5E5E5"> a little beaker next to</font>

913
00:31:36,190 --> 00:31:38,740
your extension<font color="#E5E5E5"> and don't look at</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> as</font>

914
00:31:37,360 --> 00:31:39,969
<font color="#E5E5E5">much so that's a great thing that you</font>

915
00:31:38,740 --> 00:31:41,500
<font color="#E5E5E5">should be doing if you just want to</font>

916
00:31:39,970 --> 00:31:41,860
minimize as many eyes as<font color="#CCCCCC"> you have on</font>

917
00:31:41,500 --> 00:31:43,840
here

918
00:31:41,860 --> 00:31:45,340
extension is possible you can't

919
00:31:43,840 --> 00:31:48,340
obfuscate but they might<font color="#E5E5E5"> be able to ask</font>

920
00:31:45,340 --> 00:31:50,500
<font color="#E5E5E5">you for some source code and they very</font>

921
00:31:48,340 --> 00:31:52,480
helpfully run a static analysis<font color="#E5E5E5"> tool on</font>

922
00:31:50,500 --> 00:31:54,880
<font color="#E5E5E5">your extension and</font><font color="#CCCCCC"> give you the output</font>

923
00:31:52,480 --> 00:31:56,440
<font color="#CCCCCC">before you actually push it to be</font>

924
00:31:54,880 --> 00:31:58,150
reviewed and that<font color="#CCCCCC"> just</font><font color="#E5E5E5"> looks like a</font>

925
00:31:56,440 --> 00:31:59,350
<font color="#E5E5E5">bunch of like warnings and errors so</font>

926
00:31:58,150 --> 00:32:00,850
like oh<font color="#E5E5E5"> look I found cross-site</font>

927
00:31:59,350 --> 00:32:02,620
scripting here<font color="#E5E5E5"> or this isn't good you</font>

928
00:32:00,850 --> 00:32:05,620
need to change<font color="#E5E5E5"> this it's a really great</font>

929
00:32:02,620 --> 00:32:08,080
helper<font color="#CCCCCC"> because if you don't have any</font>

930
00:32:05,620 --> 00:32:10,060
warnings manual review is probably gonna

931
00:32:08,080 --> 00:32:11,320
pass you that's what feeds<font color="#E5E5E5"> into the</font>

932
00:32:10,060 --> 00:32:12,940
report there's a bunch of<font color="#CCCCCC"> volunteers</font>

933
00:32:11,320 --> 00:32:14,560
that<font color="#CCCCCC"> go through the Mozilla add-on store</font>

934
00:32:12,940 --> 00:32:17,080
<font color="#E5E5E5">look at these reports and then say oh</font>

935
00:32:14,560 --> 00:32:18,100
<font color="#E5E5E5">look you you know pinged on this this</font>

936
00:32:17,080 --> 00:32:20,080
and this is a warning

937
00:32:18,100 --> 00:32:21,669
so I've submitted extensions to that

938
00:32:20,080 --> 00:32:25,659
store before<font color="#E5E5E5"> and they've said like hey</font>

939
00:32:21,670 --> 00:32:27,790
man<font color="#E5E5E5"> online 149 162 and 411 you actually</font>

940
00:32:25,660 --> 00:32:29,950
had some cross-site scripting<font color="#E5E5E5"> and that</font>

941
00:32:27,790 --> 00:32:31,629
was actually<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the example code which</font>

942
00:32:29,950 --> 00:32:35,760
I'd copied for<font color="#E5E5E5"> that particular extension</font>

943
00:32:31,630 --> 00:32:37,450
<font color="#E5E5E5">so you know it happens sometimes we</font>

944
00:32:35,760 --> 00:32:39,250
<font color="#E5E5E5">unintentionally damage ourself because</font>

945
00:32:37,450 --> 00:32:42,580
<font color="#E5E5E5">bad development</font><font color="#CCCCCC"> or malicious intent you</font>

946
00:32:39,250 --> 00:32:43,780
can't tell and I just fixed it and<font color="#E5E5E5"> then</font>

947
00:32:42,580 --> 00:32:46,379
they push it back out<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the store</font><font color="#CCCCCC"> and</font>

948
00:32:43,780 --> 00:32:50,139
it<font color="#CCCCCC"> was totally</font><font color="#E5E5E5"> gone</font>

949
00:32:46,380 --> 00:32:51,940
on that note<font color="#E5E5E5"> of like let's say we're in</font>

950
00:32:50,140 --> 00:32:54,870
the store<font color="#E5E5E5"> now we don't want to look like</font>

951
00:32:51,940 --> 00:32:57,010
we're<font color="#E5E5E5"> some</font><font color="#CCCCCC"> zero review</font><font color="#E5E5E5"> zero star</font>

952
00:32:54,870 --> 00:32:58,120
extension<font color="#E5E5E5"> because that's pretty</font><font color="#CCCCCC"> much one</font>

953
00:32:57,010 --> 00:32:59,320
of the only<font color="#CCCCCC"> things that look suspicious</font>

954
00:32:58,120 --> 00:33:01,540
when somebody takes<font color="#E5E5E5"> a look immediately</font>

955
00:32:59,320 --> 00:33:03,040
<font color="#E5E5E5">so you can either have some friends and</font>

956
00:33:01,540 --> 00:33:04,870
<font color="#E5E5E5">co-workers just install this thing and</font>

957
00:33:03,040 --> 00:33:07,180
give you some great<font color="#CCCCCC"> reviews or you can</font>

958
00:33:04,870 --> 00:33:09,939
go on Fiverr<font color="#E5E5E5"> and pay a dude like 30</font>

959
00:33:07,180 --> 00:33:14,830
<font color="#E5E5E5">bucks to give you 50 ratings and that</font>

960
00:33:09,940 --> 00:33:16,480
works<font color="#CCCCCC"> so like it's an</font><font color="#E5E5E5"> easy way to</font><font color="#CCCCCC"> get</font>

961
00:33:14,830 --> 00:33:17,679
yourself positioned as I am totally

962
00:33:16,480 --> 00:33:19,360
<font color="#E5E5E5">legitimate</font><font color="#CCCCCC"> because as you've seen</font>

963
00:33:17,680 --> 00:33:22,000
legitimate companies have<font color="#E5E5E5"> less than</font><font color="#CCCCCC"> 20</font>

964
00:33:19,360 --> 00:33:24,120
ratings for some other things so fiber

965
00:33:22,000 --> 00:33:27,159
for<font color="#E5E5E5"> the win</font>

966
00:33:24,120 --> 00:33:28,840
let's say we're now installed<font color="#E5E5E5"> we're in</font>

967
00:33:27,159 --> 00:33:30,070
the store we're good to go<font color="#CCCCCC"> we need</font><font color="#E5E5E5"> to</font>

968
00:33:28,840 --> 00:33:32,049
<font color="#E5E5E5">get other people actually install this</font>

969
00:33:30,070 --> 00:33:33,639
stuff I'd love to tell<font color="#CCCCCC"> you about</font><font color="#E5E5E5"> this</font>

970
00:33:32,049 --> 00:33:35,168
awesome<font color="#E5E5E5"> thing called</font><font color="#CCCCCC"> chrome inline</font>

971
00:33:33,640 --> 00:33:36,730
installations which was essentially a

972
00:33:35,169 --> 00:33:39,100
nice little<font color="#E5E5E5"> JavaScript API you could</font>

973
00:33:36,730 --> 00:33:41,429
hook into and then on a page<font color="#CCCCCC"> that wasn't</font>

974
00:33:39,100 --> 00:33:43,570
the<font color="#E5E5E5"> story you could trigger</font><font color="#CCCCCC"> the</font>

975
00:33:41,429 --> 00:33:45,279
extension installation process it would

976
00:33:43,570 --> 00:33:46,840
<font color="#E5E5E5">immediately pop up the permission window</font>

977
00:33:45,279 --> 00:33:48,490
and then people just<font color="#E5E5E5"> had to click one</font>

978
00:33:46,840 --> 00:33:51,070
button in order to install<font color="#CCCCCC"> this stuff</font>

979
00:33:48,490 --> 00:33:54,010
but malware authors<font color="#CCCCCC"> abused this so badly</font>

980
00:33:51,070 --> 00:33:55,330
<font color="#CCCCCC">that the chrome</font><font color="#E5E5E5"> just gave up and said</font>

981
00:33:54,010 --> 00:33:56,649
there's really no legitimate usage for

982
00:33:55,330 --> 00:33:58,960
<font color="#E5E5E5">this whatsoever and pulled the</font><font color="#CCCCCC"> future</font>

983
00:33:56,649 --> 00:34:00,428
entirely<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> leaves</font><font color="#E5E5E5"> us back with</font>

984
00:33:58,960 --> 00:34:02,019
what we were planning<font color="#E5E5E5"> for to begin with</font>

985
00:34:00,429 --> 00:34:03,220
we're gonna be social engineering<font color="#E5E5E5"> people</font>

986
00:34:02,019 --> 00:34:07,450
<font color="#E5E5E5">into actually installing these things</font>

987
00:34:03,220 --> 00:34:09,099
and installing extensions currently as I

988
00:34:07,450 --> 00:34:11,020
understand it is considered a slightly

989
00:34:09,099 --> 00:34:12,609
more trustworthy process than just

990
00:34:11,020 --> 00:34:14,168
<font color="#CCCCCC">running</font><font color="#E5E5E5"> an arbitrary document that</font>

991
00:34:12,609 --> 00:34:16,210
somebody emailed to me<font color="#CCCCCC"> because once</font>

992
00:34:14,168 --> 00:34:18,069
<font color="#CCCCCC">again we're going to this nice</font><font color="#E5E5E5"> trusted</font>

993
00:34:16,210 --> 00:34:21,668
<font color="#CCCCCC">web store</font><font color="#E5E5E5"> that's run by Google or</font>

994
00:34:18,070 --> 00:34:24,820
Mozilla or Microsoft<font color="#E5E5E5"> and we trust those</font>

995
00:34:21,668 --> 00:34:26,379
<font color="#E5E5E5">guys as an added bonus Google is</font>

996
00:34:24,820 --> 00:34:27,879
actively<font color="#E5E5E5"> main you know fighting to</font>

997
00:34:26,379 --> 00:34:29,589
maintain<font color="#CCCCCC"> this that blog post they</font>

998
00:34:27,879 --> 00:34:30,759
literally use the word trustworthy in it

999
00:34:29,589 --> 00:34:32,290
because they want<font color="#CCCCCC"> people</font><font color="#E5E5E5"> to trust the</font>

1000
00:34:30,760 --> 00:34:33,990
extensions if you can't trust extensions

1001
00:34:32,290 --> 00:34:36,429
no one's going to install them

1002
00:34:33,989 --> 00:34:38,020
simultaneously every two months<font color="#E5E5E5"> we've</font>

1003
00:34:36,429 --> 00:34:40,149
got a new story about extensions being

1004
00:34:38,020 --> 00:34:42,550
compromised and being used<font color="#E5E5E5"> to like steal</font>

1005
00:34:40,149 --> 00:34:43,810
<font color="#CCCCCC">away too much stuff so I don't know</font>

1006
00:34:42,550 --> 00:34:45,399
which way it's gonna<font color="#E5E5E5"> fall in the long</font>

1007
00:34:43,810 --> 00:34:46,869
run but right now<font color="#E5E5E5"> people still trust</font>

1008
00:34:45,399 --> 00:34:51,040
this more than saying let me<font color="#E5E5E5"> run an</font>

1009
00:34:46,869 --> 00:34:52,540
executable<font color="#CCCCCC"> or give me your creds so</font>

1010
00:34:51,040 --> 00:34:54,909
here's a couple<font color="#E5E5E5"> of pretext that we can</font>

1011
00:34:52,540 --> 00:34:56,918
use pretext one<font color="#E5E5E5"> this is my personal</font>

1012
00:34:54,909 --> 00:34:59,080
<font color="#E5E5E5">favorite</font><font color="#CCCCCC"> which is</font><font color="#E5E5E5"> we're gonna create or</font>

1013
00:34:56,918 --> 00:35:01,118
clone<font color="#E5E5E5"> a video conferencing extension and</font>

1014
00:34:59,080 --> 00:35:02,740
we need to convince<font color="#E5E5E5"> somebody from our</font>

1015
00:35:01,119 --> 00:35:04,060
<font color="#E5E5E5">target to get on a call</font><font color="#CCCCCC"> with us which</font><font color="#E5E5E5"> is</font>

1016
00:35:02,740 --> 00:35:05,470
actually<font color="#E5E5E5"> not as</font><font color="#CCCCCC"> hard as you would</font><font color="#E5E5E5"> think</font>

1017
00:35:04,060 --> 00:35:07,750
<font color="#E5E5E5">it is we</font><font color="#CCCCCC"> just need to dangle a big</font>

1018
00:35:05,470 --> 00:35:08,950
enough<font color="#CCCCCC"> carrot so say we go on LinkedIn</font>

1019
00:35:07,750 --> 00:35:10,750
and<font color="#CCCCCC"> look at our target and</font><font color="#E5E5E5"> see who's</font>

1020
00:35:08,950 --> 00:35:12,359
<font color="#CCCCCC">looking for</font><font color="#E5E5E5"> a job</font><font color="#CCCCCC"> we reach out to</font><font color="#E5E5E5"> them</font>

1021
00:35:10,750 --> 00:35:14,830
<font color="#E5E5E5">and say</font><font color="#CCCCCC"> hey</font><font color="#E5E5E5"> you look perfect for this</font>

1022
00:35:12,359 --> 00:35:16,330
$250,000 a year job I<font color="#E5E5E5"> just need you to</font>

1023
00:35:14,830 --> 00:35:17,980
<font color="#E5E5E5">have a quick video conference</font><font color="#CCCCCC"> with a</font>

1024
00:35:16,330 --> 00:35:20,680
lead developer<font color="#E5E5E5"> to</font><font color="#CCCCCC"> see if you're a good</font>

1025
00:35:17,980 --> 00:35:23,500
<font color="#CCCCCC">fit for the team I've</font><font color="#E5E5E5"> found that</font>

1026
00:35:20,680 --> 00:35:25,270
spokespeople<font color="#E5E5E5"> for companies are really</font>

1027
00:35:23,500 --> 00:35:27,700
really really jonesing<font color="#CCCCCC"> to talk to the</font>

1028
00:35:25,270 --> 00:35:29,380
media<font color="#E5E5E5"> so if you convince them</font><font color="#CCCCCC"> that</font>

1029
00:35:27,700 --> 00:35:30,700
you're a reporter<font color="#CCCCCC"> from some outfit they</font>

1030
00:35:29,380 --> 00:35:32,830
will want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk with you and they will</font>

1031
00:35:30,700 --> 00:35:35,830
jump<font color="#CCCCCC"> through hoops</font><font color="#E5E5E5"> for that and then of</font>

1032
00:35:32,830 --> 00:35:36,880
course<font color="#E5E5E5"> the sales team if you dangle some</font>

1033
00:35:35,830 --> 00:35:39,089
money in<font color="#E5E5E5"> front of them they're</font><font color="#CCCCCC"> going to</font>

1034
00:35:36,880 --> 00:35:41,410
anything<font color="#E5E5E5"> for that sweet Commission and</font>

1035
00:35:39,089 --> 00:35:42,880
they will install whatever<font color="#E5E5E5"> you tell them</font>

1036
00:35:41,410 --> 00:35:43,328
<font color="#CCCCCC">to if it means</font><font color="#E5E5E5"> that they're gonna land a</font>

1037
00:35:42,880 --> 00:35:46,359
job

1038
00:35:43,329 --> 00:35:47,410
so once we've gotten somebody<font color="#E5E5E5"> to</font><font color="#CCCCCC"> agree</font>

1039
00:35:46,359 --> 00:35:49,328
to<font color="#E5E5E5"> chat with us</font><font color="#CCCCCC"> on our video</font>

1040
00:35:47,410 --> 00:35:50,950
<font color="#E5E5E5">conferencing extension we're going to</font>

1041
00:35:49,329 --> 00:35:52,359
send them an<font color="#E5E5E5"> email invite we're</font><font color="#CCCCCC"> going to</font>

1042
00:35:50,950 --> 00:35:54,009
<font color="#E5E5E5">ninja invite them to a</font><font color="#CCCCCC"> meeting that's</font>

1043
00:35:52,359 --> 00:35:55,509
like<font color="#CCCCCC"> thirty minutes from</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's</font>

1044
00:35:54,009 --> 00:35:56,890
gonna<font color="#E5E5E5"> be like oh come</font><font color="#CCCCCC"> to my video</font>

1045
00:35:55,509 --> 00:35:59,920
conferencing<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> at like</font><font color="#E5E5E5"> maboob</font><font color="#CCCCCC"> early</font>

1046
00:35:56,890 --> 00:36:01,569
calm calm or something and once they go

1047
00:35:59,920 --> 00:36:03,519
<font color="#CCCCCC">to that they're only</font><font color="#E5E5E5"> going to have the</font>

1048
00:36:01,569 --> 00:36:05,140
<font color="#E5E5E5">option</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> install an extension that's</font>

1049
00:36:03,519 --> 00:36:07,359
where we can say like<font color="#E5E5E5"> hey you're</font><font color="#CCCCCC"> in</font>

1050
00:36:05,140 --> 00:36:09,190
<font color="#E5E5E5">Firefox install this add-on</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> hey your</font>

1051
00:36:07,359 --> 00:36:10,630
<font color="#E5E5E5">chrome install this extension for</font><font color="#CCCCCC"> Chrome</font>

1052
00:36:09,190 --> 00:36:13,000
<font color="#CCCCCC">and so on</font>

1053
00:36:10,630 --> 00:36:14,259
don't give them any other options<font color="#CCCCCC"> people</font>

1054
00:36:13,000 --> 00:36:15,940
<font color="#CCCCCC">will be worried about looking</font>

1055
00:36:14,259 --> 00:36:17,920
<font color="#E5E5E5">unprofessional if they show</font><font color="#CCCCCC"> up at the</font>

1056
00:36:15,940 --> 00:36:19,119
<font color="#CCCCCC">age</font><font color="#E5E5E5"> old</font><font color="#CCCCCC"> of dodge with social engineering</font>

1057
00:36:17,920 --> 00:36:20,559
which is<font color="#E5E5E5"> like you know set an</font><font color="#CCCCCC"> arbitrary</font>

1058
00:36:19,119 --> 00:36:21,880
<font color="#E5E5E5">limit and people are</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> run through</font>

1059
00:36:20,559 --> 00:36:25,089
it and succumb to pressure even though

1060
00:36:21,880 --> 00:36:27,490
it<font color="#E5E5E5"> doesn't maybe make any sense</font><font color="#CCCCCC"> as an</font>

1061
00:36:25,089 --> 00:36:29,170
added<font color="#E5E5E5"> bonus</font><font color="#CCCCCC"> you know video and chat</font><font color="#E5E5E5"> are</font>

1062
00:36:27,490 --> 00:36:31,569
really great excuses to do<font color="#E5E5E5"> WebSocket</font>

1063
00:36:29,170 --> 00:36:34,329
stuff because nobody<font color="#E5E5E5"> really understands</font>

1064
00:36:31,569 --> 00:36:35,740
<font color="#E5E5E5">how video streaming works another</font>

1065
00:36:34,329 --> 00:36:37,720
pretext we can use is we can pretend to

1066
00:36:35,740 --> 00:36:40,029
be<font color="#E5E5E5"> one of these super awesome security</font>

1067
00:36:37,720 --> 00:36:42,430
extensions<font color="#E5E5E5"> that there are many many many</font>

1068
00:36:40,029 --> 00:36:44,769
of<font color="#E5E5E5"> within the store</font><font color="#CCCCCC"> so just send</font>

1069
00:36:42,430 --> 00:36:47,859
<font color="#CCCCCC">somebody like a cat picture</font><font color="#E5E5E5"> or something</font>

1070
00:36:44,769 --> 00:36:49,479
that's<font color="#E5E5E5"> really on you know benign but</font>

1071
00:36:47,859 --> 00:36:52,000
unsolicited<font color="#E5E5E5"> and then when they click on</font>

1072
00:36:49,480 --> 00:36:53,829
<font color="#CCCCCC">it</font><font color="#E5E5E5"> you send</font><font color="#CCCCCC"> them a follow-up email and</font>

1073
00:36:52,000 --> 00:36:56,470
you say hey this<font color="#CCCCCC"> is that was an internal</font>

1074
00:36:53,829 --> 00:36:58,509
<font color="#CCCCCC">security phishing test sorry you failed</font>

1075
00:36:56,470 --> 00:37:00,279
<font color="#E5E5E5">you can either take a</font><font color="#CCCCCC"> one-hour</font><font color="#E5E5E5"> training</font>

1076
00:36:58,509 --> 00:37:03,730
<font color="#CCCCCC">class it's mandatory or you can go</font>

1077
00:37:00,279 --> 00:37:07,720
install this<font color="#E5E5E5"> approved extension and have</font>

1078
00:37:03,730 --> 00:37:10,900
a guess<font color="#E5E5E5"> what people will do as as an</font>

1079
00:37:07,720 --> 00:37:13,359
added bonus<font color="#E5E5E5"> the security extensions in</font>

1080
00:37:10,900 --> 00:37:16,089
the store are already kind<font color="#CCCCCC"> of goofy</font><font color="#E5E5E5"> so</font>

1081
00:37:13,359 --> 00:37:17,500
here we have an<font color="#E5E5E5"> extension it's asking</font>

1082
00:37:16,089 --> 00:37:19,150
for<font color="#E5E5E5"> those dangerous permissions that we</font>

1083
00:37:17,500 --> 00:37:21,579
<font color="#E5E5E5">all care</font><font color="#CCCCCC"> about it's by</font><font color="#E5E5E5"> Kaspersky but</font>

1084
00:37:19,150 --> 00:37:24,039
what the heck is this<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know I</font>

1085
00:37:21,579 --> 00:37:26,650
guess it was a low effort<font color="#E5E5E5"> extension it's</font>

1086
00:37:24,039 --> 00:37:28,150
probably fraud<font color="#E5E5E5"> no it's real actually</font>

1087
00:37:26,650 --> 00:37:31,750
because<font color="#CCCCCC"> they</font><font color="#E5E5E5"> just nobody puts thought</font>

1088
00:37:28,150 --> 00:37:33,190
this<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's not as hard of a target</font>

1089
00:37:31,750 --> 00:37:35,859
<font color="#CCCCCC">as you might think to look legitimate</font>

1090
00:37:33,190 --> 00:37:37,809
<font color="#CCCCCC">and then a final</font><font color="#E5E5E5"> one is an old SE</font>

1091
00:37:35,859 --> 00:37:39,700
classic which is<font color="#E5E5E5"> if you don't do this</font>

1092
00:37:37,809 --> 00:37:41,710
you're gonna<font color="#E5E5E5"> lose all your email or oh</font>

1093
00:37:39,700 --> 00:37:42,910
no the VPN<font color="#E5E5E5"> is going down or you know</font>

1094
00:37:41,710 --> 00:37:45,069
<font color="#E5E5E5">this will make your life</font><font color="#CCCCCC"> easier just</font>

1095
00:37:42,910 --> 00:37:47,319
make whatever<font color="#E5E5E5"> you want and then set up</font>

1096
00:37:45,069 --> 00:37:49,750
<font color="#CCCCCC">this fake like infrastructure extension</font>

1097
00:37:47,319 --> 00:37:50,740
have them install it<font color="#E5E5E5"> and then say</font><font color="#CCCCCC"> okay</font>

1098
00:37:49,750 --> 00:37:56,920
it's all<font color="#E5E5E5"> good everything</font>

1099
00:37:50,740 --> 00:37:58,689
fine<font color="#CCCCCC"> but</font><font color="#E5E5E5"> now you owned them so that's</font>

1100
00:37:56,920 --> 00:37:59,890
what we want<font color="#E5E5E5"> to be doing what does this</font>

1101
00:37:58,690 --> 00:38:12,790
actually<font color="#E5E5E5"> look like in practice like</font>

1102
00:37:59,890 --> 00:38:14,589
<font color="#E5E5E5">let's let's put it all together</font><font color="#CCCCCC"> alright</font>

1103
00:38:12,790 --> 00:38:17,350
<font color="#E5E5E5">so here we're</font><font color="#CCCCCC"> taking a look</font><font color="#E5E5E5"> at an</font>

1104
00:38:14,590 --> 00:38:19,300
attacker machine and as<font color="#CCCCCC"> I've recommended</font>

1105
00:38:17,350 --> 00:38:21,100
<font color="#CCCCCC">we are using firebase because it is a</font>

1106
00:38:19,300 --> 00:38:26,430
<font color="#E5E5E5">delightful piece of technology for</font><font color="#CCCCCC"> our</font>

1107
00:38:21,100 --> 00:38:31,029
all OVR<font color="#E5E5E5"> CTS</font><font color="#CCCCCC"> and in addition</font><font color="#E5E5E5"> to firebase</font>

1108
00:38:26,430 --> 00:38:33,069
<font color="#CCCCCC">we also have a small node.js application</font>

1109
00:38:31,030 --> 00:38:34,270
which is here to<font color="#E5E5E5"> help us manage our</font>

1110
00:38:33,070 --> 00:38:35,650
clients as they<font color="#E5E5E5"> come in because when</font>

1111
00:38:34,270 --> 00:38:38,080
<font color="#CCCCCC">this works you're</font><font color="#E5E5E5"> gonna get so many</font>

1112
00:38:35,650 --> 00:38:39,610
installs<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you're gonna need a UI to</font>

1113
00:38:38,080 --> 00:38:42,400
deal with it it's<font color="#E5E5E5"> just not going to work</font>

1114
00:38:39,610 --> 00:38:44,710
if<font color="#E5E5E5"> if you just try to like manually</font>

1115
00:38:42,400 --> 00:38:48,610
handle things<font color="#E5E5E5"> so let's take a look at</font>

1116
00:38:44,710 --> 00:38:50,920
the victim machine the victim machine is

1117
00:38:48,610 --> 00:38:53,560
on a private<font color="#CCCCCC"> network we</font><font color="#E5E5E5"> want to get into</font>

1118
00:38:50,920 --> 00:38:56,190
<font color="#E5E5E5">that Network has Jenkins this user is</font>

1119
00:38:53,560 --> 00:38:58,840
logged in as admin to their Jenkins

1120
00:38:56,190 --> 00:39:00,670
instance it's a really<font color="#CCCCCC"> juicy target</font>

1121
00:38:58,840 --> 00:39:02,050
because once we can get<font color="#E5E5E5"> in there we're</font>

1122
00:39:00,670 --> 00:39:04,090
<font color="#E5E5E5">gonna be able to pop a shell on that</font>

1123
00:39:02,050 --> 00:39:05,590
Jenkins<font color="#E5E5E5"> box</font><font color="#CCCCCC"> its admin so there's</font>

1124
00:39:04,090 --> 00:39:07,300
probably source code there's all kinds

1125
00:39:05,590 --> 00:39:11,770
of real goodies<font color="#CCCCCC"> that you want in a red</font>

1126
00:39:07,300 --> 00:39:13,150
teaming context but<font color="#E5E5E5"> unfortunately you</font>

1127
00:39:11,770 --> 00:39:14,830
know this is an internal<font color="#E5E5E5"> network thing</font>

1128
00:39:13,150 --> 00:39:16,150
so we're not<font color="#E5E5E5"> going to be able to we</font>

1129
00:39:14,830 --> 00:39:17,920
can't just<font color="#E5E5E5"> hit this from anywhere we</font>

1130
00:39:16,150 --> 00:39:19,090
<font color="#CCCCCC">need to be inside their network so you</font>

1131
00:39:17,920 --> 00:39:24,430
know<font color="#E5E5E5"> if we go on our</font><font color="#CCCCCC"> attacker</font><font color="#E5E5E5"> machine</font>

1132
00:39:19,090 --> 00:39:25,810
try<font color="#E5E5E5"> to go there no good so let's take</font>

1133
00:39:24,430 --> 00:39:28,210
the conceit<font color="#E5E5E5"> that we've managed to</font>

1134
00:39:25,810 --> 00:39:30,130
<font color="#CCCCCC">successfully social engineer this</font><font color="#E5E5E5"> user</font>

1135
00:39:28,210 --> 00:39:32,980
<font color="#E5E5E5">using one of the pretext which we talked</font>

1136
00:39:30,130 --> 00:39:35,020
about<font color="#E5E5E5"> before</font><font color="#CCCCCC"> so they go to the web</font><font color="#E5E5E5"> store</font>

1137
00:39:32,980 --> 00:39:36,640
<font color="#E5E5E5">and they're going to install</font><font color="#CCCCCC"> our</font>

1138
00:39:35,020 --> 00:39:38,320
extension this is a live extension this

1139
00:39:36,640 --> 00:39:40,180
<font color="#E5E5E5">is really in the store the names have</font>

1140
00:39:38,320 --> 00:39:42,250
<font color="#CCCCCC">been changed to protect</font><font color="#E5E5E5"> the guilty</font><font color="#CCCCCC"> I</font>

1141
00:39:40,180 --> 00:39:43,990
have no interest in having<font color="#E5E5E5"> this stuff be</font>

1142
00:39:42,250 --> 00:39:46,330
banned<font color="#E5E5E5"> but fair</font><font color="#CCCCCC"> enough if</font><font color="#E5E5E5"> it happens it</font>

1143
00:39:43,990 --> 00:39:48,879
happens<font color="#E5E5E5"> but anyways what you just saw</font>

1144
00:39:46,330 --> 00:39:52,270
there that's it their own<font color="#CCCCCC"> it's over</font>

1145
00:39:48,880 --> 00:39:53,800
<font color="#E5E5E5">they're done so when we go over to</font><font color="#CCCCCC"> our</font>

1146
00:39:52,270 --> 00:39:54,880
actual<font color="#E5E5E5"> a little nodejs app we</font><font color="#CCCCCC"> can see oh</font>

1147
00:39:53,800 --> 00:39:56,560
look we<font color="#CCCCCC"> have a connection</font>

1148
00:39:54,880 --> 00:39:57,580
<font color="#E5E5E5">firebase is helping us track these</font>

1149
00:39:56,560 --> 00:40:02,200
<font color="#E5E5E5">things because it's a</font><font color="#CCCCCC"> real-time database</font>

1150
00:39:57,580 --> 00:40:04,420
<font color="#CCCCCC">and remember earlier when</font><font color="#E5E5E5"> I was saying</font>

1151
00:40:02,200 --> 00:40:06,098
you shouldn't<font color="#CCCCCC"> have your malicious code</font>

1152
00:40:04,420 --> 00:40:08,019
on the extension<font color="#E5E5E5"> or within the extension</font>

1153
00:40:06,099 --> 00:40:09,220
<font color="#CCCCCC">we're now going</font><font color="#E5E5E5"> to push</font><font color="#CCCCCC"> down that</font>

1154
00:40:08,019 --> 00:40:11,529
<font color="#E5E5E5">malicious code that's gonna let us do</font>

1155
00:40:09,220 --> 00:40:13,990
all<font color="#CCCCCC"> the bad stuff that we want to</font><font color="#E5E5E5"> do so</font>

1156
00:40:11,529 --> 00:40:16,420
<font color="#E5E5E5">let's deploy all of our nasty code and</font>

1157
00:40:13,990 --> 00:40:18,069
let's dump<font color="#E5E5E5"> some cookies and real quickly</font>

1158
00:40:16,420 --> 00:40:19,420
<font color="#CCCCCC">that is every cookie that is</font><font color="#E5E5E5"> installed</font>

1159
00:40:18,069 --> 00:40:20,950
<font color="#E5E5E5">in that browser for every</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> we</font>

1160
00:40:19,420 --> 00:40:23,109
just have it it gets sent<font color="#E5E5E5"> back pretty</font>

1161
00:40:20,950 --> 00:40:24,098
quickly<font color="#E5E5E5"> and that's great in practice by</font>

1162
00:40:23,109 --> 00:40:25,808
<font color="#CCCCCC">the way when you do this for a real</font>

1163
00:40:24,099 --> 00:40:27,279
<font color="#E5E5E5">browser it's gonna be like a really</font>

1164
00:40:25,809 --> 00:40:28,690
<font color="#E5E5E5">large file you're probably going to need</font>

1165
00:40:27,279 --> 00:40:30,460
<font color="#E5E5E5">to open it and like sublime</font><font color="#CCCCCC"> text or</font>

1166
00:40:28,690 --> 00:40:31,480
something<font color="#CCCCCC"> this is just</font><font color="#E5E5E5"> from a like a toy</font>

1167
00:40:30,460 --> 00:40:34,059
test machine that's never touched

1168
00:40:31,480 --> 00:40:35,740
anything<font color="#E5E5E5"> but that's not enough because</font>

1169
00:40:34,059 --> 00:40:38,500
<font color="#CCCCCC">while we might</font><font color="#E5E5E5"> have cookies here for</font>

1170
00:40:35,740 --> 00:40:42,160
<font color="#CCCCCC">Jenkins we can't touch Jenkins</font><font color="#E5E5E5"> which is</font>

1171
00:40:38,500 --> 00:40:44,140
why I've written<font color="#E5E5E5"> a Python tool which</font>

1172
00:40:42,160 --> 00:40:46,690
will let<font color="#E5E5E5"> us create a proxy which</font>

1173
00:40:44,140 --> 00:40:48,879
translates web requests<font color="#CCCCCC"> into stuff that</font>

1174
00:40:46,690 --> 00:40:50,559
<font color="#E5E5E5">goes into</font><font color="#CCCCCC"> that firebase c2</font>

1175
00:40:48,880 --> 00:40:52,690
pushes it<font color="#CCCCCC"> down to the actual extension</font>

1176
00:40:50,559 --> 00:40:54,730
and then makes the request<font color="#E5E5E5"> on our behalf</font>

1177
00:40:52,690 --> 00:40:56,410
so<font color="#CCCCCC"> I'm firing</font><font color="#E5E5E5"> up the proxy here for that</font>

1178
00:40:54,730 --> 00:40:58,930
<font color="#CCCCCC">client this</font><font color="#E5E5E5"> is Firefox pointed that</font>

1179
00:40:56,410 --> 00:41:01,000
proxy<font color="#E5E5E5"> it's making the request firebase</font>

1180
00:40:58,930 --> 00:41:02,919
is relaying all<font color="#E5E5E5"> of these requests here</font>

1181
00:41:01,000 --> 00:41:04,660
it's actually<font color="#CCCCCC"> quite quick as we're</font>

1182
00:41:02,920 --> 00:41:07,660
taking<font color="#CCCCCC"> all of</font><font color="#E5E5E5"> our requests and now we</font>

1183
00:41:04,660 --> 00:41:09,490
can actually see the internal<font color="#E5E5E5"> Jenkins</font>

1184
00:41:07,660 --> 00:41:11,470
instance from<font color="#E5E5E5"> our attacker machine we're</font>

1185
00:41:09,490 --> 00:41:14,680
logged in already<font color="#E5E5E5"> as admin</font><font color="#CCCCCC"> - because</font>

1186
00:41:11,470 --> 00:41:17,109
that<font color="#CCCCCC"> guy's logged in as admin so we've</font>

1187
00:41:14,680 --> 00:41:20,049
pretty much<font color="#E5E5E5"> already won but let's say I</font>

1188
00:41:17,109 --> 00:41:22,509
<font color="#CCCCCC">want his password let's log him out and</font>

1189
00:41:20,049 --> 00:41:25,390
because Jenkins doesn't<font color="#CCCCCC"> have a broken</font>

1190
00:41:22,509 --> 00:41:27,369
logout process that<font color="#E5E5E5"> guy's cookie is also</font>

1191
00:41:25,390 --> 00:41:29,920
busted<font color="#CCCCCC"> so let's go back to our victim</font>

1192
00:41:27,369 --> 00:41:32,799
<font color="#E5E5E5">and the victim</font><font color="#CCCCCC"> is now going</font><font color="#E5E5E5"> to Jenkins</font>

1193
00:41:29,920 --> 00:41:34,210
for something<font color="#CCCCCC"> oh darn</font><font color="#E5E5E5"> I'm logged out</font>

1194
00:41:32,799 --> 00:41:35,650
well I saved my password so<font color="#CCCCCC"> I'm just</font>

1195
00:41:34,210 --> 00:41:38,200
<font color="#E5E5E5">gonna click this button and sign in and</font>

1196
00:41:35,650 --> 00:41:39,519
<font color="#E5E5E5">we got</font><font color="#CCCCCC"> him I don't</font><font color="#E5E5E5"> know if you</font><font color="#CCCCCC"> remember</font>

1197
00:41:38,200 --> 00:41:43,839
the malware I was talking<font color="#CCCCCC"> about earlier</font>

1198
00:41:39,519 --> 00:41:45,368
<font color="#E5E5E5">that catch all</font><font color="#CCCCCC"> that took</font><font color="#E5E5E5"> all the post</font>

1199
00:41:43,839 --> 00:41:47,170
<font color="#CCCCCC">requests and forwarded our way</font><font color="#E5E5E5"> we</font>

1200
00:41:45,369 --> 00:41:48,789
grabbed that login<font color="#E5E5E5"> request and now we</font>

1201
00:41:47,170 --> 00:41:51,160
have their username and their password

1202
00:41:48,789 --> 00:41:52,420
<font color="#E5E5E5">and we're done</font><font color="#CCCCCC"> we've got it we're ready</font>

1203
00:41:51,160 --> 00:41:53,769
<font color="#E5E5E5">to</font><font color="#CCCCCC"> pivot through the rest of</font><font color="#E5E5E5"> their web</font>

1204
00:41:52,420 --> 00:41:56,750
applications<font color="#E5E5E5"> and their infrastructure</font>

1205
00:41:53,769 --> 00:42:05,259
<font color="#CCCCCC">and</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> cause some damage</font>

1206
00:41:56,750 --> 00:42:05,260
[Applause]

1207
00:42:10,690 --> 00:42:16,880
so that's great<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> a nice tool we</font>

1208
00:42:14,120 --> 00:42:18,680
can<font color="#CCCCCC"> use for</font><font color="#E5E5E5"> social</font><font color="#CCCCCC"> engineering but</font>

1209
00:42:16,880 --> 00:42:20,300
there's a whole<font color="#CCCCCC"> other side</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> these</font>

1210
00:42:18,680 --> 00:42:22,279
<font color="#E5E5E5">extensions that we can</font><font color="#CCCCCC"> abuse to really</font>

1211
00:42:20,300 --> 00:42:23,690
up our game<font color="#E5E5E5"> there's a post exploitation</font>

1212
00:42:22,280 --> 00:42:26,600
way that we can take<font color="#CCCCCC"> advantage of this</font>

1213
00:42:23,690 --> 00:42:27,770
stuff as well<font color="#E5E5E5"> say that</font><font color="#CCCCCC"> we wanted</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> we</font>

1214
00:42:26,600 --> 00:42:29,540
were<font color="#E5E5E5"> already on</font><font color="#CCCCCC"> a machine through a</font>

1215
00:42:27,770 --> 00:42:30,830
different<font color="#E5E5E5"> mechanism</font><font color="#CCCCCC"> but we wanted to be</font>

1216
00:42:29,540 --> 00:42:32,210
capturing<font color="#E5E5E5"> all their creds and we didn't</font>

1217
00:42:30,830 --> 00:42:33,620
want<font color="#CCCCCC"> to be installing a key logger or</font>

1218
00:42:32,210 --> 00:42:36,080
something else that<font color="#CCCCCC"> might be obvious to</font>

1219
00:42:33,620 --> 00:42:38,150
<font color="#CCCCCC">AV this is where there's this thing</font>

1220
00:42:36,080 --> 00:42:40,009
called<font color="#CCCCCC"> Chrome external installs this is</font>

1221
00:42:38,150 --> 00:42:42,650
essentially<font color="#CCCCCC"> gonna let a side load our</font>

1222
00:42:40,010 --> 00:42:44,930
existing extension<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> persons</font>

1223
00:42:42,650 --> 00:42:47,360
machine<font color="#E5E5E5"> all you need to do depending</font><font color="#CCCCCC"> on</font>

1224
00:42:44,930 --> 00:42:49,730
<font color="#E5E5E5">the</font><font color="#CCCCCC"> operating</font><font color="#E5E5E5"> system is write to a file</font>

1225
00:42:47,360 --> 00:42:51,500
or<font color="#E5E5E5"> registry key literally something that</font>

1226
00:42:49,730 --> 00:42:53,420
is like the name<font color="#CCCCCC"> of your</font><font color="#E5E5E5"> extension so</font>

1227
00:42:51,500 --> 00:42:55,430
it's<font color="#CCCCCC"> just</font><font color="#E5E5E5"> like you're 32 character</font>

1228
00:42:53,420 --> 00:42:59,390
extension ID<font color="#E5E5E5"> and inside</font><font color="#CCCCCC"> that you need to</font>

1229
00:42:55,430 --> 00:43:02,270
put this external<font color="#CCCCCC"> update URL to</font><font color="#E5E5E5"> point at</font>

1230
00:42:59,390 --> 00:43:03,589
<font color="#CCCCCC">the</font><font color="#E5E5E5"> web store that's all you do and then</font>

1231
00:43:02,270 --> 00:43:05,270
the<font color="#E5E5E5"> next time that</font><font color="#CCCCCC"> the user restarts</font>

1232
00:43:03,590 --> 00:43:07,700
<font color="#CCCCCC">chrome congratulations your extensions</font>

1233
00:43:05,270 --> 00:43:09,590
installed you're done or it used to be

1234
00:43:07,700 --> 00:43:11,029
that way<font color="#CCCCCC"> because unfortunately malware</font>

1235
00:43:09,590 --> 00:43:13,610
authors ruin things for<font color="#E5E5E5"> us again and</font>

1236
00:43:11,030 --> 00:43:15,050
they used it too much<font color="#CCCCCC"> and</font><font color="#E5E5E5"> now the user</font>

1237
00:43:13,610 --> 00:43:16,880
gets a<font color="#E5E5E5"> very helpful warning that says</font>

1238
00:43:15,050 --> 00:43:19,040
hey did you totally mean to install this

1239
00:43:16,880 --> 00:43:22,760
extension<font color="#E5E5E5"> and most users</font><font color="#CCCCCC"> are gonna said</font>

1240
00:43:19,040 --> 00:43:24,020
no and turn it<font color="#E5E5E5"> off</font><font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of the things</font>

1241
00:43:22,760 --> 00:43:26,390
that you might<font color="#E5E5E5"> be thinking those but</font>

1242
00:43:24,020 --> 00:43:28,580
we're on<font color="#E5E5E5"> the machine we have rce we can</font>

1243
00:43:26,390 --> 00:43:30,950
do ever we<font color="#CCCCCC"> want</font><font color="#E5E5E5"> so what does Chrome do</font>

1244
00:43:28,580 --> 00:43:33,350
when somebody<font color="#E5E5E5"> hits enable extension and</font>

1245
00:43:30,950 --> 00:43:35,299
what it does is it<font color="#E5E5E5"> flips a flag in this</font>

1246
00:43:33,350 --> 00:43:36,529
thing called<font color="#E5E5E5"> a secure preferences file</font>

1247
00:43:35,300 --> 00:43:39,350
for Chrome which is<font color="#E5E5E5"> stored in the users</font>

1248
00:43:36,530 --> 00:43:41,540
local<font color="#E5E5E5"> data so the secure preferences</font>

1249
00:43:39,350 --> 00:43:45,049
file is pretty<font color="#CCCCCC"> much just a one big JSON</font>

1250
00:43:41,540 --> 00:43:47,779
<font color="#E5E5E5">blob it's been locked down with</font><font color="#CCCCCC"> a bunch</font>

1251
00:43:45,050 --> 00:43:50,450
of<font color="#E5E5E5"> H max</font><font color="#CCCCCC"> sha-256 hashes for individual</font>

1252
00:43:47,780 --> 00:43:52,070
entries the key is based off of<font color="#E5E5E5"> really</font>

1253
00:43:50,450 --> 00:43:54,140
machine specific stuff like your user

1254
00:43:52,070 --> 00:43:56,720
accounts in Windows<font color="#CCCCCC"> and maybe they hit</font>

1255
00:43:54,140 --> 00:43:58,299
<font color="#E5E5E5">like a 32 byte key or something randomly</font>

1256
00:43:56,720 --> 00:44:00,620
<font color="#E5E5E5">in a random</font><font color="#CCCCCC"> Chrome installation file</font>

1257
00:43:58,300 --> 00:44:02,090
<font color="#E5E5E5">people dug into this years and years ago</font>

1258
00:44:00,620 --> 00:44:03,440
<font color="#E5E5E5">there's a couple blog posts on how does</font>

1259
00:44:02,090 --> 00:44:05,750
<font color="#CCCCCC">this work and how do</font><font color="#E5E5E5"> you manually modify</font>

1260
00:44:03,440 --> 00:44:07,640
<font color="#CCCCCC">this</font><font color="#E5E5E5"> but as far as</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> aware there's no</font>

1261
00:44:05,750 --> 00:44:09,140
public tooling available in terms of

1262
00:44:07,640 --> 00:44:10,598
saying well how do<font color="#E5E5E5"> I just like flip a</font>

1263
00:44:09,140 --> 00:44:12,879
flag<font color="#E5E5E5"> here</font>

1264
00:44:10,599 --> 00:44:14,380
or at least<font color="#CCCCCC"> that was the case</font><font color="#E5E5E5"> I have</font><font color="#CCCCCC"> a</font>

1265
00:44:12,880 --> 00:44:18,070
script<font color="#E5E5E5"> which will work for this</font><font color="#CCCCCC"> and I'm</font>

1266
00:44:14,380 --> 00:44:20,320
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> publishing that soon so in</font>

1267
00:44:18,070 --> 00:44:21,760
terms of<font color="#E5E5E5"> what we're interested in for</font>

1268
00:44:20,320 --> 00:44:22,900
being<font color="#E5E5E5"> able to actually change here's a</font>

1269
00:44:21,760 --> 00:44:24,369
couple<font color="#E5E5E5"> of flags that might be</font>

1270
00:44:22,900 --> 00:44:27,400
interesting to<font color="#E5E5E5"> you as an attacker</font>

1271
00:44:24,369 --> 00:44:28,960
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> every single extension has its</font>

1272
00:44:27,400 --> 00:44:31,510
own entry and within that entry you

1273
00:44:28,960 --> 00:44:33,040
might see<font color="#E5E5E5"> things like</font><font color="#CCCCCC"> AK</font><font color="#E5E5E5"> external which</font>

1274
00:44:31,510 --> 00:44:34,810
means<font color="#E5E5E5"> I acknowledge that</font><font color="#CCCCCC"> this external</font>

1275
00:44:33,040 --> 00:44:36,820
has been plugging hasn't been installed

1276
00:44:34,810 --> 00:44:39,490
<font color="#E5E5E5">by me so you flip that from false to</font>

1277
00:44:36,820 --> 00:44:42,280
<font color="#CCCCCC">true and we no longer see that pop up</font>

1278
00:44:39,490 --> 00:44:44,140
<font color="#E5E5E5">when you</font><font color="#CCCCCC"> sideload</font><font color="#E5E5E5"> your extension we can</font>

1279
00:44:42,280 --> 00:44:46,240
also do<font color="#CCCCCC"> stuff like say</font><font color="#E5E5E5"> I want you to run</font>

1280
00:44:44,140 --> 00:44:48,819
an incognito<font color="#CCCCCC"> mode if I set incognito</font><font color="#E5E5E5"> to</font>

1281
00:44:46,240 --> 00:44:52,810
<font color="#E5E5E5">true</font><font color="#CCCCCC"> or I want to be able to refile URLs</font>

1282
00:44:48,820 --> 00:44:55,330
if we set<font color="#E5E5E5"> that</font><font color="#CCCCCC"> to true but what about</font>

1283
00:44:52,810 --> 00:44:56,830
reading and<font color="#E5E5E5"> writing files to disk</font><font color="#CCCCCC"> that's</font>

1284
00:44:55,330 --> 00:44:59,109
a thing<font color="#CCCCCC"> we want to do too and that's</font>

1285
00:44:56,830 --> 00:45:01,210
where we have<font color="#E5E5E5"> to go to</font><font color="#CCCCCC"> Chrome</font>

1286
00:44:59,109 --> 00:45:04,509
applications that whole giant feature

1287
00:45:01,210 --> 00:45:08,770
set that<font color="#CCCCCC"> has long been made a deprecated</font>

1288
00:45:04,510 --> 00:45:10,270
thing unless<font color="#CCCCCC"> we</font><font color="#E5E5E5"> side load these entirely</font>

1289
00:45:08,770 --> 00:45:12,580
by saying that they've<font color="#CCCCCC"> been manually</font>

1290
00:45:10,270 --> 00:45:16,150
added within<font color="#E5E5E5"> the secure preferences file</font>

1291
00:45:12,580 --> 00:45:18,069
and then we can chain<font color="#E5E5E5"> we can unlock all</font>

1292
00:45:16,150 --> 00:45:21,160
<font color="#E5E5E5">of these api's which are really</font><font color="#CCCCCC"> powerful</font>

1293
00:45:18,070 --> 00:45:24,430
things<font color="#CCCCCC"> raw socket API</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> per</font><font color="#E5E5E5"> TCP and UDP</font>

1294
00:45:21,160 --> 00:45:26,500
<font color="#E5E5E5">reading and writing files from disk SSH</font>

1295
00:45:24,430 --> 00:45:28,089
clients HTTP servers like<font color="#E5E5E5"> the world is</font>

1296
00:45:26,500 --> 00:45:31,330
your oyster it's really powerful stuff

1297
00:45:28,089 --> 00:45:33,339
and unfortunately<font color="#E5E5E5"> they have a very</font>

1298
00:45:31,330 --> 00:45:36,009
strict CSP policy you can't normally

1299
00:45:33,339 --> 00:45:37,750
<font color="#E5E5E5">make an XML HTTP request and just put in</font>

1300
00:45:36,010 --> 00:45:39,310
any<font color="#E5E5E5"> JavaScript code you want you're</font>

1301
00:45:37,750 --> 00:45:40,900
<font color="#E5E5E5">gonna need to be a little more creative</font>

1302
00:45:39,310 --> 00:45:42,490
<font color="#E5E5E5">and use those raw sockets it's a lot of</font>

1303
00:45:40,900 --> 00:45:44,290
work so I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have a good example</font>

1304
00:45:42,490 --> 00:45:47,290
application that takes<font color="#CCCCCC"> advantage</font><font color="#E5E5E5"> of all</font>

1305
00:45:44,290 --> 00:45:49,450
<font color="#CCCCCC">of these things but</font><font color="#E5E5E5"> I do have a small</font>

1306
00:45:47,290 --> 00:45:51,279
<font color="#E5E5E5">piece of advice for how you read and</font>

1307
00:45:49,450 --> 00:45:52,540
write<font color="#CCCCCC"> anything from disk so there's a</font>

1308
00:45:51,280 --> 00:45:53,650
permission called the file system

1309
00:45:52,540 --> 00:45:56,589
permissions<font color="#E5E5E5"> it makes sense that does</font>

1310
00:45:53,650 --> 00:45:59,170
what<font color="#CCCCCC"> you'd think</font><font color="#E5E5E5"> and to prevent users</font>

1311
00:45:56,589 --> 00:46:01,270
from<font color="#E5E5E5"> abusing this or extensions</font><font color="#CCCCCC"> from</font>

1312
00:45:59,170 --> 00:46:03,640
abusing<font color="#E5E5E5"> this the</font><font color="#CCCCCC"> users supposed to be</font>

1313
00:46:01,270 --> 00:46:06,430
<font color="#E5E5E5">notified when they have to interact with</font>

1314
00:46:03,640 --> 00:46:07,509
<font color="#E5E5E5">the hard drive</font><font color="#CCCCCC"> and so say that I</font>

1315
00:46:06,430 --> 00:46:09,069
constantly want<font color="#E5E5E5"> to read something from</font>

1316
00:46:07,510 --> 00:46:11,560
disk<font color="#E5E5E5"> I'm not gonna want</font><font color="#CCCCCC"> to re prompt the</font>

1317
00:46:09,070 --> 00:46:14,950
user every time so there's a way to save

1318
00:46:11,560 --> 00:46:17,080
entries or retain them and once you've

1319
00:46:14,950 --> 00:46:19,089
<font color="#E5E5E5">retained to this entry it gets saved</font>

1320
00:46:17,080 --> 00:46:20,560
into<font color="#E5E5E5"> a preferences file that might be</font>

1321
00:46:19,089 --> 00:46:21,700
important<font color="#E5E5E5"> and might be called secure</font>

1322
00:46:20,560 --> 00:46:23,470
preferences and<font color="#E5E5E5"> it looks something like</font>

1323
00:46:21,700 --> 00:46:25,509
this<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> just write</font><font color="#E5E5E5"> your own</font>

1324
00:46:23,470 --> 00:46:27,310
<font color="#CCCCCC">IOL entries into</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> secure preferences</font>

1325
00:46:25,510 --> 00:46:29,530
file<font color="#E5E5E5"> to give yourself read/write access</font>

1326
00:46:27,310 --> 00:46:30,670
to whatever you want<font color="#CCCCCC"> in addition to all</font>

1327
00:46:29,530 --> 00:46:34,810
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> other stuff you would do for</font><font color="#CCCCCC"> that</font>

1328
00:46:30,670 --> 00:46:37,270
<font color="#E5E5E5">and then finally I'm</font><font color="#CCCCCC"> gonna have to go a</font>

1329
00:46:34,810 --> 00:46:38,680
<font color="#E5E5E5">little quick here</font><font color="#CCCCCC"> native messaging is</font>

1330
00:46:37,270 --> 00:46:40,800
the way that we're gonna pop a shell

1331
00:46:38,680 --> 00:46:44,259
native messaging is a functionality<font color="#E5E5E5"> that</font>

1332
00:46:40,800 --> 00:46:47,020
<font color="#E5E5E5">essentially lets us say okay when I call</font>

1333
00:46:44,260 --> 00:46:49,690
<font color="#CCCCCC">runtime that</font><font color="#E5E5E5"> connect external Chrome is</font>

1334
00:46:47,020 --> 00:46:51,520
gonna fire up a different executable on

1335
00:46:49,690 --> 00:46:53,230
disk that<font color="#E5E5E5"> executable is based off of</font>

1336
00:46:51,520 --> 00:46:54,940
<font color="#E5E5E5">some JSON file</font><font color="#CCCCCC"> which is stored in the</font>

1337
00:46:53,230 --> 00:46:56,619
registry or stored on disk<font color="#CCCCCC"> it's this</font>

1338
00:46:54,940 --> 00:46:58,990
whole kind<font color="#E5E5E5"> of like</font><font color="#CCCCCC"> kooky system</font><font color="#E5E5E5"> it's not</font>

1339
00:46:56,619 --> 00:47:00,910
<font color="#E5E5E5">super great</font><font color="#CCCCCC"> for documentation either</font><font color="#E5E5E5"> but</font>

1340
00:46:58,990 --> 00:47:02,649
once you have this executable<font color="#E5E5E5"> it's gonna</font>

1341
00:47:00,910 --> 00:47:04,060
read things from<font color="#E5E5E5"> standard in and it's</font>

1342
00:47:02,650 --> 00:47:05,380
gonna<font color="#E5E5E5"> write all</font><font color="#CCCCCC"> of its</font><font color="#E5E5E5"> output standard</font>

1343
00:47:04,060 --> 00:47:09,430
out so you can interact with<font color="#E5E5E5"> it through</font>

1344
00:47:05,380 --> 00:47:10,510
<font color="#E5E5E5">these</font><font color="#CCCCCC"> API when you need to</font><font color="#E5E5E5"> have a shell</font>

1345
00:47:09,430 --> 00:47:11,669
<font color="#E5E5E5">that's what you're gonna want to do</font>

1346
00:47:10,510 --> 00:47:14,020
you're gonna have to<font color="#E5E5E5"> create your own</font>

1347
00:47:11,670 --> 00:47:15,460
mini shell which reads off of standard

1348
00:47:14,020 --> 00:47:16,900
in and standard out drop it<font color="#CCCCCC"> to disk</font><font color="#E5E5E5"> in</font>

1349
00:47:15,460 --> 00:47:18,160
<font color="#CCCCCC">the post exploitation context and</font>

1350
00:47:16,900 --> 00:47:21,400
congratulations now you're good

1351
00:47:18,160 --> 00:47:23,348
<font color="#CCCCCC">a bunch of effort we need sample code</font>

1352
00:47:21,400 --> 00:47:25,450
for<font color="#CCCCCC"> that and that's</font><font color="#E5E5E5"> what this code dump</font>

1353
00:47:23,349 --> 00:47:27,250
is going to be for soon if you<font color="#CCCCCC"> go to</font>

1354
00:47:25,450 --> 00:47:28,598
that URL<font color="#E5E5E5"> you will start seeing code</font>

1355
00:47:27,250 --> 00:47:30,160
appear which is going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> make a lot of</font>

1356
00:47:28,599 --> 00:47:32,050
<font color="#E5E5E5">this stuff easier to do so</font><font color="#CCCCCC"> you don't</font>

1357
00:47:30,160 --> 00:47:34,690
have to pull<font color="#E5E5E5"> your hair out</font><font color="#CCCCCC"> while you're</font>

1358
00:47:32,050 --> 00:47:36,310
<font color="#E5E5E5">doing all this stuff</font><font color="#CCCCCC"> stuff that you're</font>

1359
00:47:34,690 --> 00:47:38,109
<font color="#E5E5E5">gonna start seeing pop up in that repo</font>

1360
00:47:36,310 --> 00:47:39,849
is workarounds<font color="#CCCCCC"> for side loading apps</font>

1361
00:47:38,109 --> 00:47:41,049
without having errors<font color="#E5E5E5"> because once we're</font>

1362
00:47:39,849 --> 00:47:42,490
on the<font color="#CCCCCC"> box we should be able to</font><font color="#E5E5E5"> do</font>

1363
00:47:41,050 --> 00:47:43,780
whatever we want<font color="#CCCCCC"> right we should be able</font>

1364
00:47:42,490 --> 00:47:45,220
<font color="#E5E5E5">to make that thing run an extension</font>

1365
00:47:43,780 --> 00:47:47,470
regardless of whether or<font color="#E5E5E5"> not it's in</font><font color="#CCCCCC"> the</font>

1366
00:47:45,220 --> 00:47:49,359
store<font color="#CCCCCC"> something that I'd like</font><font color="#E5E5E5"> to think</font>

1367
00:47:47,470 --> 00:47:51,189
<font color="#E5E5E5">of is a malicious extension cookbook a</font>

1368
00:47:49,359 --> 00:47:52,750
bunch of recipes<font color="#CCCCCC"> that are interesting</font>

1369
00:47:51,190 --> 00:47:54,730
for<font color="#CCCCCC"> us</font><font color="#E5E5E5"> like what does it</font><font color="#CCCCCC"> mean to dump</font>

1370
00:47:52,750 --> 00:47:57,550
all the cookies or<font color="#E5E5E5"> how</font><font color="#CCCCCC"> would I run a</font>

1371
00:47:54,730 --> 00:47:59,380
shell instantly<font color="#CCCCCC"> as well as some general</font>

1372
00:47:57,550 --> 00:48:01,330
framework<font color="#CCCCCC"> for</font><font color="#E5E5E5"> that c2i kind of</font><font color="#CCCCCC"> demo</font>

1373
00:47:59,380 --> 00:48:02,859
playing around with firebase<font color="#E5E5E5"> like</font>

1374
00:48:01,330 --> 00:48:03,910
<font color="#E5E5E5">obviously we can't publish everything</font>

1375
00:48:02,859 --> 00:48:05,710
<font color="#E5E5E5">there is here because it's gonna get</font>

1376
00:48:03,910 --> 00:48:07,598
detected in the actual store approval

1377
00:48:05,710 --> 00:48:09,520
process but in that beyond the approval

1378
00:48:07,599 --> 00:48:14,260
process all of<font color="#CCCCCC"> the good stuff</font><font color="#E5E5E5"> I see no</font>

1379
00:48:09,520 --> 00:48:17,320
<font color="#E5E5E5">reason why that can't be public do we</font>

1380
00:48:14,260 --> 00:48:19,390
<font color="#E5E5E5">have any</font><font color="#CCCCCC"> questions can I answer</font><font color="#E5E5E5"> anything</font>

1381
00:48:17,320 --> 00:48:21,480
<font color="#E5E5E5">for you guys yes man in the red</font><font color="#CCCCCC"> shirt in</font>

1382
00:48:19,390 --> 00:48:21,480
<font color="#E5E5E5">the front</font>

1383
00:48:24,490 --> 00:48:30,709
so not<font color="#CCCCCC"> directly but</font><font color="#E5E5E5"> once</font><font color="#CCCCCC"> you get disc</font>

1384
00:48:28,700 --> 00:48:34,640
access what you can do is you can read

1385
00:48:30,710 --> 00:48:36,560
the<font color="#E5E5E5"> users like data protection API key</font>

1386
00:48:34,640 --> 00:48:38,480
to then decrypt the file on disk<font color="#E5E5E5"> that</font>

1387
00:48:36,560 --> 00:48:44,750
has all their<font color="#E5E5E5"> story passwords and then</font>

1388
00:48:38,480 --> 00:48:46,070
you can dump all<font color="#CCCCCC"> of them oh yeah sorry</font>

1389
00:48:44,750 --> 00:48:52,580
there's there's an<font color="#E5E5E5"> API for hitting local</font>

1390
00:48:46,070 --> 00:48:53,780
<font color="#E5E5E5">storage you can</font><font color="#CCCCCC"> mail all of that so yeah</font>

1391
00:48:52,580 --> 00:48:56,930
that's that's<font color="#E5E5E5"> the</font><font color="#CCCCCC"> thing there's an</font>

1392
00:48:53,780 --> 00:48:58,610
encrypted file on disk which you can

1393
00:48:56,930 --> 00:49:02,779
read you have to get file reading access

1394
00:48:58,610 --> 00:49:03,590
<font color="#CCCCCC">before you can touch that well guy back</font>

1395
00:49:02,780 --> 00:49:13,280
there that<font color="#CCCCCC"> won't</font><font color="#E5E5E5"> get this deep in the</font>

1396
00:49:03,590 --> 00:49:14,780
head yes it it's it's every cookie

1397
00:49:13,280 --> 00:49:27,590
that's stored in the<font color="#E5E5E5"> browser</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> it</font>

1398
00:49:14,780 --> 00:49:28,850
yeah<font color="#E5E5E5"> oh sorry you menu so</font><font color="#CCCCCC"> that would</font>

1399
00:49:27,590 --> 00:49:30,680
probably<font color="#E5E5E5"> require reading things from</font>

1400
00:49:28,850 --> 00:49:32,299
disk but that stuff is right in the same

1401
00:49:30,680 --> 00:49:33,830
area<font color="#CCCCCC"> where you'd expect to see</font><font color="#E5E5E5"> other</font>

1402
00:49:32,300 --> 00:49:36,380
extensions so once we can read<font color="#E5E5E5"> things</font>

1403
00:49:33,830 --> 00:49:38,630
off disk<font color="#E5E5E5"> yes you can</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you're not</font>

1404
00:49:36,380 --> 00:49:39,890
gonna get it purely from<font color="#E5E5E5"> just an</font>

1405
00:49:38,630 --> 00:49:51,980
<font color="#E5E5E5">extension that</font><font color="#CCCCCC"> you don't have</font><font color="#E5E5E5"> any post</font>

1406
00:49:39,890 --> 00:49:54,290
exploitation shells on yes so the

1407
00:49:51,980 --> 00:49:56,930
question<font color="#CCCCCC"> was what about</font><font color="#E5E5E5"> newer extensions</font>

1408
00:49:54,290 --> 00:49:58,340
that<font color="#E5E5E5"> are about like u2f and handling</font>

1409
00:49:56,930 --> 00:50:00,980
interactions with that<font color="#CCCCCC"> so there are</font>

1410
00:49:58,340 --> 00:50:03,620
<font color="#E5E5E5">actually this this great class of super</font>

1411
00:50:00,980 --> 00:50:05,180
legitimate security extensions which are

1412
00:50:03,620 --> 00:50:06,319
supposed<font color="#E5E5E5"> to be used for</font><font color="#CCCCCC"> handling like</font>

1413
00:50:05,180 --> 00:50:08,029
your<font color="#CCCCCC"> YouTube</font><font color="#E5E5E5"> web stuff if you can</font>

1414
00:50:06,320 --> 00:50:10,280
convince<font color="#E5E5E5"> somebody else to install your</font>

1415
00:50:08,030 --> 00:50:12,170
own extension<font color="#E5E5E5"> instead of that you</font><font color="#CCCCCC"> can</font>

1416
00:50:10,280 --> 00:50:14,060
man in the middle<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to up all day and</font>

1417
00:50:12,170 --> 00:50:18,230
start using that<font color="#E5E5E5"> stuff to access</font><font color="#CCCCCC"> things</font>

1418
00:50:14,060 --> 00:50:19,420
you probably<font color="#CCCCCC"> shouldn't I think we're</font>

1419
00:50:18,230 --> 00:50:26,300
good

1420
00:50:19,420 --> 00:50:26,300
[Applause]

1421
00:50:29,240 --> 00:50:32,240
<font color="#E5E5E5">Hey</font>

