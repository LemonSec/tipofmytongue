1
00:00:02,389 --> 00:00:10,379
<font color="#E5E5E5">all right hey derbycon how's everybody</font>

2
00:00:06,660 --> 00:00:13,379
doing this<font color="#E5E5E5"> morning</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right well I want</font>

3
00:00:10,380 --> 00:00:17,850
to welcome<font color="#E5E5E5"> you to</font><font color="#CCCCCC"> Rai Satori</font><font color="#E5E5E5"> OMG</font>

4
00:00:13,380 --> 00:00:20,310
or re<font color="#CCCCCC"> IOT botnets oh my</font><font color="#E5E5E5"> a little bit</font>

5
00:00:17,850 --> 00:00:20,939
about me<font color="#CCCCCC"> I work on the threat Intel team</font>

6
00:00:20,310 --> 00:00:24,659
<font color="#E5E5E5">at netskope</font>

7
00:00:20,939 --> 00:00:27,300
right focus on IOT Linux<font color="#E5E5E5"> and mobile</font>

8
00:00:24,660 --> 00:00:29,189
malware<font color="#CCCCCC"> I'm recovering</font><font color="#E5E5E5"> pentester I've</font>

9
00:00:27,300 --> 00:00:33,420
done<font color="#E5E5E5"> everything from</font><font color="#CCCCCC"> network on testing</font>

10
00:00:29,189 --> 00:00:37,440
to IOT<font color="#E5E5E5"> software hardware and back-end</font>

11
00:00:33,420 --> 00:00:39,360
service testing today's agenda<font color="#CCCCCC"> we're</font>

12
00:00:37,440 --> 00:00:42,769
gonna look at how mariah has been used

13
00:00:39,360 --> 00:00:45,840
as a framework<font color="#E5E5E5"> for IOT bot net authors</font>

14
00:00:42,770 --> 00:00:51,570
<font color="#CCCCCC">will take a look</font><font color="#E5E5E5"> at three specific IOT</font>

15
00:00:45,840 --> 00:00:55,079
variances look at how each of them have

16
00:00:51,570 --> 00:00:57,449
used<font color="#CCCCCC"> Rai as a</font><font color="#E5E5E5"> framework the base to</font>

17
00:00:55,079 --> 00:00:58,530
<font color="#E5E5E5">build upon and then also additional</font>

18
00:00:57,449 --> 00:01:00,710
<font color="#CCCCCC">Flair that</font><font color="#E5E5E5"> they've added</font><font color="#CCCCCC"> to make it</font>

19
00:00:58,530 --> 00:01:03,449
<font color="#CCCCCC">their own</font>

20
00:01:00,710 --> 00:01:06,210
next we'll look at tricks and techniques

21
00:01:03,449 --> 00:01:09,119
you can use<font color="#E5E5E5"> when analyzing IOT</font><font color="#CCCCCC"> based</font>

22
00:01:06,210 --> 00:01:12,570
malware we'll talk about some<font color="#E5E5E5"> best</font>

23
00:01:09,119 --> 00:01:15,720
practices around<font color="#E5E5E5"> defending against IOT</font>

24
00:01:12,570 --> 00:01:22,679
<font color="#CCCCCC">bots and finally we'll open</font><font color="#E5E5E5"> it up</font><font color="#CCCCCC"> to any</font>

25
00:01:15,720 --> 00:01:25,110
<font color="#CCCCCC">questions you all may have then</font>

26
00:01:22,680 --> 00:01:27,180
obviously 2016 the internet was hit with

27
00:01:25,110 --> 00:01:29,100
some<font color="#E5E5E5"> high profile</font><font color="#CCCCCC"> high-impact</font><font color="#E5E5E5"> DDoS</font>

28
00:01:27,180 --> 00:01:32,040
attacks these DDoS attacks were

29
00:01:29,100 --> 00:01:34,289
associated with Mariah Mariah<font color="#E5E5E5"> targeted</font>

30
00:01:32,040 --> 00:01:36,600
IOT devices<font color="#E5E5E5"> and some of you may be</font>

31
00:01:34,290 --> 00:01:40,110
<font color="#E5E5E5">asking what's</font><font color="#CCCCCC"> Niall T device</font><font color="#E5E5E5"> well I can</font>

32
00:01:36,600 --> 00:01:42,210
<font color="#CCCCCC">think</font><font color="#E5E5E5"> of an IOT device as any system or</font>

33
00:01:40,110 --> 00:01:43,770
<font color="#E5E5E5">any hardware that's running an embedded</font>

34
00:01:42,210 --> 00:01:46,289
operating system<font color="#E5E5E5"> that can send and</font>

35
00:01:43,770 --> 00:01:47,700
<font color="#CCCCCC">receive data</font><font color="#E5E5E5"> on the network common IOT</font>

36
00:01:46,290 --> 00:01:50,700
devices that you'll see out<font color="#E5E5E5"> there are IP</font>

37
00:01:47,700 --> 00:01:54,299
based cameras cable DSL modems and<font color="#E5E5E5"> DVR</font>

38
00:01:50,700 --> 00:01:58,259
systems<font color="#E5E5E5"> Mirai supported several</font>

39
00:01:54,299 --> 00:02:00,450
architectures such as arm<font color="#CCCCCC"> MIPS x86 and</font>

40
00:01:58,259 --> 00:02:02,729
PowerPC the reason<font color="#E5E5E5"> for this is because a</font>

41
00:02:00,450 --> 00:02:04,140
<font color="#E5E5E5">lot</font><font color="#CCCCCC"> of these</font><font color="#E5E5E5"> IOT devices have these</font>

42
00:02:02,729 --> 00:02:05,820
different chipsets not all of them<font color="#E5E5E5"> are</font>

43
00:02:04,140 --> 00:02:09,288
based on arm not all of them have MIPS

44
00:02:05,820 --> 00:02:12,959
or PowerPC<font color="#CCCCCC"> NAM they're</font><font color="#E5E5E5"> across</font><font color="#CCCCCC"> the board</font>

45
00:02:09,288 --> 00:02:13,910
when<font color="#CCCCCC"> Mirai came out it's a tag vector</font>

46
00:02:12,959 --> 00:02:15,770
was to use default

47
00:02:13,910 --> 00:02:17,510
<font color="#CCCCCC">pencils and scan for telnet so</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> it</font>

48
00:02:15,770 --> 00:02:19,040
<font color="#CCCCCC">do its</font><font color="#E5E5E5"> standing</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> look for any</font>

49
00:02:17,510 --> 00:02:21,200
devices<font color="#E5E5E5"> that</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> have telnet available</font>

50
00:02:19,040 --> 00:02:22,850
and then use a set<font color="#E5E5E5"> list of default</font>

51
00:02:21,200 --> 00:02:25,070
<font color="#E5E5E5">credentials these default credentials</font>

52
00:02:22,850 --> 00:02:27,079
<font color="#E5E5E5">Community Network set from the factory</font>

53
00:02:25,070 --> 00:02:29,269
time when the user received<font color="#E5E5E5"> the device</font>

54
00:02:27,080 --> 00:02:31,790
or even credentials that were hard coded

55
00:02:29,270 --> 00:02:33,350
by support organizations such as you

56
00:02:31,790 --> 00:02:35,720
know<font color="#E5E5E5"> maybe your DSL modem your cable</font>

57
00:02:33,350 --> 00:02:37,400
modem<font color="#E5E5E5"> may have a back</font><font color="#CCCCCC"> door password on</font>

58
00:02:35,720 --> 00:02:41,420
there so they can<font color="#E5E5E5"> get in to update any</font>

59
00:02:37,400 --> 00:02:46,630
firmware<font color="#CCCCCC"> that type of</font><font color="#E5E5E5"> stuff now we fast</font>

60
00:02:41,420 --> 00:02:46,630
forward to<font color="#E5E5E5"> September of 2016</font>

61
00:02:47,980 --> 00:02:54,590
author of<font color="#E5E5E5"> ride decides to hey</font><font color="#CCCCCC"> I'm gonna</font>

62
00:02:51,080 --> 00:03:03,440
<font color="#E5E5E5">open source or release my code pretty</font>

63
00:02:54,590 --> 00:03:05,420
much talks about also kind of made fun

64
00:03:03,440 --> 00:03:09,609
<font color="#E5E5E5">of people that were doing analysis on</font>

65
00:03:05,420 --> 00:03:12,350
the<font color="#E5E5E5"> bot itself once you open sourced it</font>

66
00:03:09,610 --> 00:03:14,600
or<font color="#E5E5E5"> released it are leaked it however you</font>

67
00:03:12,350 --> 00:03:17,290
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> look at it we started seeing</font>

68
00:03:14,600 --> 00:03:19,850
several variants come out based<font color="#CCCCCC"> on my</font>

69
00:03:17,290 --> 00:03:21,650
<font color="#E5E5E5">here's the following graph of just</font><font color="#CCCCCC"> a</font>

70
00:03:19,850 --> 00:03:23,450
year date of ingestion<font color="#E5E5E5"> of different</font>

71
00:03:21,650 --> 00:03:25,640
types of variances<font color="#CCCCCC"> that were based on</font>

72
00:03:23,450 --> 00:03:33,200
right<font color="#E5E5E5"> you see several peaks and valleys</font>

73
00:03:25,640 --> 00:03:35,470
here<font color="#CCCCCC"> when a new variant comes out that</font>

74
00:03:33,200 --> 00:03:38,510
adds additional functionality or as

75
00:03:35,470 --> 00:03:40,580
additional attack vectors or implements

76
00:03:38,510 --> 00:03:44,149
some<font color="#E5E5E5"> sort of new IOT vulnerability has</font>

77
00:03:40,580 --> 00:03:48,400
<font color="#E5E5E5">been released</font><font color="#CCCCCC"> examples</font><font color="#E5E5E5"> are like</font><font color="#CCCCCC"> a cheap</font>

78
00:03:44,150 --> 00:03:48,400
on exploit or the<font color="#CCCCCC"> realtek</font><font color="#E5E5E5"> sdk exploits</font>

79
00:03:49,270 --> 00:03:52,819
now that we have a kind

80
00:03:50,840 --> 00:03:54,849
a<font color="#E5E5E5"> background of</font><font color="#CCCCCC"> moriah let's take a look</font>

81
00:03:52,819 --> 00:03:57,470
at three specific variances and how<font color="#E5E5E5"> they</font>

82
00:03:54,849 --> 00:03:59,839
<font color="#CCCCCC">leverage</font><font color="#E5E5E5"> Mariah has a framework and then</font>

83
00:03:57,470 --> 00:04:03,220
built upon it to add their own<font color="#CCCCCC"> Flair</font><font color="#E5E5E5"> the</font>

84
00:03:59,840 --> 00:04:03,220
first one take a<font color="#E5E5E5"> look at it Satori</font>

85
00:04:09,190 --> 00:04:15,950
<font color="#E5E5E5">Satori Satori emerged in late 2017</font><font color="#CCCCCC"> since</font>

86
00:04:14,299 --> 00:04:19,519
then there have<font color="#CCCCCC"> been several variances</font>

87
00:04:15,950 --> 00:04:21,370
of Satori analyzing Satori you can see

88
00:04:19,519 --> 00:04:23,600
it<font color="#E5E5E5"> heavily used Mirai as a framework</font>

89
00:04:21,370 --> 00:04:25,330
<font color="#E5E5E5">several functions map between the two</font>

90
00:04:23,600 --> 00:04:28,220
and we'll take<font color="#E5E5E5"> a look at some of</font><font color="#CCCCCC"> that</font>

91
00:04:25,330 --> 00:04:30,440
the original version<font color="#E5E5E5"> used a default</font>

92
00:04:28,220 --> 00:04:32,690
credential scanner<font color="#CCCCCC"> just like Mariah but</font>

93
00:04:30,440 --> 00:04:34,910
other variances<font color="#E5E5E5"> of Satori then started</font>

94
00:04:32,690 --> 00:04:37,910
to<font color="#CCCCCC"> implement other exploit techniques</font>

95
00:04:34,910 --> 00:04:40,850
such as remote<font color="#CCCCCC"> codecs</font><font color="#E5E5E5"> remote command</font>

96
00:04:37,910 --> 00:04:42,169
execution vulnerabilities and some other

97
00:04:40,850 --> 00:04:45,200
ones which<font color="#CCCCCC"> we'll dive a little bit</font>

98
00:04:42,169 --> 00:04:47,000
deeper into<font color="#E5E5E5"> one cool</font><font color="#CCCCCC"> thing about Satori</font>

99
00:04:45,200 --> 00:04:50,030
was it's the<font color="#E5E5E5"> first bot to support the</font>

100
00:04:47,000 --> 00:04:51,110
arch<font color="#E5E5E5"> architecture no other box so far</font>

101
00:04:50,030 --> 00:04:53,780
has come out and support that

102
00:04:51,110 --> 00:04:57,470
architecture now I take<font color="#E5E5E5"> a look at some</font>

103
00:04:53,780 --> 00:04:58,039
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> co-chair Annette</font><font color="#E5E5E5"> Satori</font><font color="#CCCCCC"> uses from</font>

104
00:04:57,470 --> 00:05:08,380
<font color="#CCCCCC">Mariah</font>

105
00:04:58,039 --> 00:05:10,789
this first example<font color="#E5E5E5"> here figuration table</font>

106
00:05:08,380 --> 00:05:13,159
in there it stores information about

107
00:05:10,789 --> 00:05:15,320
like where the CNC domain is or where

108
00:05:13,160 --> 00:05:17,020
the CNC port is and these values<font color="#E5E5E5"> are</font>

109
00:05:15,320 --> 00:05:19,820
stored<font color="#E5E5E5"> if you look at the strings</font>

110
00:05:17,020 --> 00:05:21,409
<font color="#E5E5E5">they're stored</font><font color="#CCCCCC"> obvi skated and we'll</font>

111
00:05:19,820 --> 00:05:24,740
look at that<font color="#CCCCCC"> obviously a ssin technique</font>

112
00:05:21,410 --> 00:05:27,020
<font color="#E5E5E5">here in the minutes on the right hand</font>

113
00:05:24,740 --> 00:05:29,330
side view<font color="#CCCCCC"> we see Satori's the pseudo</font>

114
00:05:27,020 --> 00:05:31,969
Satori's configuration file we see the

115
00:05:29,330 --> 00:05:35,570
same type of<font color="#E5E5E5"> function where we're adding</font>

116
00:05:31,970 --> 00:05:37,849
<font color="#E5E5E5">our table index we add</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> obviously</font>

117
00:05:35,570 --> 00:05:40,789
<font color="#E5E5E5">value and then the size and the length</font>

118
00:05:37,849 --> 00:05:43,460
<font color="#E5E5E5">of that value I talked about</font><font color="#CCCCCC"> Halle</font>

119
00:05:40,789 --> 00:05:45,530
Satori<font color="#E5E5E5"> and right obvi skates</font><font color="#CCCCCC"> their</font>

120
00:05:43,460 --> 00:05:47,930
information<font color="#E5E5E5"> we can see that they</font><font color="#CCCCCC"> both</font>

121
00:05:45,530 --> 00:05:50,679
<font color="#E5E5E5">leverage the same function the original</font>

122
00:05:47,930 --> 00:05:50,680
<font color="#CCCCCC">Mariah's</font>

123
00:05:52,479 --> 00:05:55,479
<font color="#CCCCCC">table</font>

124
00:06:02,250 --> 00:06:15,159
it was used when<font color="#E5E5E5"> the source was leased</font>

125
00:06:04,810 --> 00:06:16,659
<font color="#E5E5E5">that</font><font color="#CCCCCC"> key is with you those strings</font><font color="#E5E5E5"> but</font>

126
00:06:15,159 --> 00:06:18,009
<font color="#E5E5E5">use different</font><font color="#CCCCCC"> keys so you</font><font color="#E5E5E5"> weren't seeing</font>

127
00:06:16,659 --> 00:06:20,770
<font color="#E5E5E5">the same dead beef they may have used</font>

128
00:06:18,009 --> 00:06:22,689
different<font color="#E5E5E5"> incantations of that but same</font>

129
00:06:20,770 --> 00:06:25,150
function very easy to<font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out what</font>

130
00:06:22,689 --> 00:06:27,159
those encrypted<font color="#CCCCCC"> or</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> ex-ored strings</font>

131
00:06:25,150 --> 00:06:29,289
were the reason for the<font color="#CCCCCC"> XOR they've been</font>

132
00:06:27,159 --> 00:06:32,469
a<font color="#E5E5E5"> couple</font><font color="#CCCCCC"> of things</font><font color="#E5E5E5"> one to</font><font color="#CCCCCC"> bypass maybe</font>

133
00:06:29,289 --> 00:06:35,169
ids/ips types of situations<font color="#E5E5E5"> or to make</font>

134
00:06:32,469 --> 00:06:36,520
<font color="#E5E5E5">it difficult for reversers or blue team</font>

135
00:06:35,169 --> 00:06:37,508
members<font color="#CCCCCC"> just</font><font color="#E5E5E5"> to be able to run strings</font>

136
00:06:36,520 --> 00:06:39,008
<font color="#CCCCCC">and figure out</font><font color="#E5E5E5"> all I hear there's a</font>

137
00:06:37,509 --> 00:06:43,180
domain<font color="#E5E5E5"> that it uses here's a port it</font>

138
00:06:39,009 --> 00:06:45,940
uses<font color="#E5E5E5"> the later</font><font color="#CCCCCC"> variances though</font><font color="#E5E5E5"> satori</font>

139
00:06:43,180 --> 00:06:47,759
<font color="#E5E5E5">swapped out its</font><font color="#CCCCCC"> XOR function for a bit</font>

140
00:06:45,940 --> 00:06:49,960
swap which you see the<font color="#CCCCCC"> pseudocode</font><font color="#E5E5E5"> here</font>

141
00:06:47,759 --> 00:06:52,000
<font color="#E5E5E5">so it swapped the bits and then it would</font>

142
00:06:49,960 --> 00:06:54,779
call this base64 encode or decode

143
00:06:52,000 --> 00:06:57,610
function<font color="#CCCCCC"> and it would encode or decode</font>

144
00:06:54,779 --> 00:07:00,789
the actual string itself<font color="#E5E5E5"> and here's the</font>

145
00:06:57,610 --> 00:07:02,199
<font color="#E5E5E5">the base64 encode</font><font color="#CCCCCC"> er</font><font color="#E5E5E5"> or decoder and as</font>

146
00:07:00,789 --> 00:07:03,969
you can<font color="#CCCCCC"> see I mean nothing special it's</font>

147
00:07:02,199 --> 00:07:09,370
nothing revolutionary just kind of

148
00:07:03,969 --> 00:07:12,849
reusing basic techniques where I

149
00:07:09,370 --> 00:07:14,199
<font color="#CCCCCC">originally used a telnet</font><font color="#E5E5E5"> or you know</font>

150
00:07:12,849 --> 00:07:15,159
telnet scanner more or less then we'll

151
00:07:14,199 --> 00:07:17,379
look for<font color="#E5E5E5"> default credentials</font>

152
00:07:15,159 --> 00:07:20,080
<font color="#CCCCCC">satori did the same but then it kind of</font>

153
00:07:17,379 --> 00:07:22,120
upped its game by introducing<font color="#CCCCCC"> IOT based</font>

154
00:07:20,080 --> 00:07:26,169
vulnerabilities such as the reach<font color="#E5E5E5"> real</font>

155
00:07:22,120 --> 00:07:28,389
<font color="#CCCCCC">Tech SDK here's this assembly for a</font>

156
00:07:26,169 --> 00:07:30,128
variant that was leveraging<font color="#E5E5E5"> this exploit</font>

157
00:07:28,389 --> 00:07:31,779
and here we can see the exploit and the

158
00:07:30,129 --> 00:07:34,389
string being built for<font color="#E5E5E5"> it if we take a</font>

159
00:07:31,779 --> 00:07:45,219
look at the payload<font color="#E5E5E5"> itself we can</font><font color="#CCCCCC"> see</font>

160
00:07:34,389 --> 00:07:50,889
what's<font color="#E5E5E5"> actually going on of Satori and</font>

161
00:07:45,219 --> 00:07:52,900
<font color="#CCCCCC">run</font><font color="#E5E5E5"> it on device similar Satori used the</font>

162
00:07:50,889 --> 00:07:55,029
Jeep on exploit same type of<font color="#CCCCCC"> fashion</font>

163
00:07:52,900 --> 00:07:57,429
here's a mixed sample<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can see the</font>

164
00:07:55,029 --> 00:08:06,009
string bean builds and if we look at<font color="#E5E5E5"> the</font>

165
00:07:57,430 --> 00:08:10,060
payload<font color="#E5E5E5"> we see the same type of and run</font>

166
00:08:06,009 --> 00:08:11,020
it<font color="#E5E5E5"> last example here of vulnerability or</font>

167
00:08:10,060 --> 00:08:12,699
attack

168
00:08:11,020 --> 00:08:16,628
that's a<font color="#CCCCCC"> Tory added</font><font color="#E5E5E5"> it's kind of one of</font>

169
00:08:12,699 --> 00:08:20,169
<font color="#E5E5E5">my favorites</font><font color="#CCCCCC"> from late August</font><font color="#E5E5E5"> timeframe</font>

170
00:08:16,629 --> 00:08:21,930
middle of August<font color="#E5E5E5"> we saw a huge uptick in</font>

171
00:08:20,169 --> 00:08:24,310
scanning<font color="#CCCCCC"> for work five five five five</font>

172
00:08:21,930 --> 00:08:25,720
<font color="#CCCCCC">and for those Android</font><font color="#E5E5E5"> people out there</font>

173
00:08:24,310 --> 00:08:28,300
you know exactly what that<font color="#E5E5E5"> port is</font>

174
00:08:25,720 --> 00:08:29,740
that's the<font color="#E5E5E5"> ATD port so Satori would sit</font>

175
00:08:28,300 --> 00:08:32,260
there and scan the<font color="#CCCCCC"> internet look for any</font>

176
00:08:29,740 --> 00:08:35,080
systems that had<font color="#E5E5E5"> a DB open and then</font>

177
00:08:32,260 --> 00:08:38,080
would<font color="#E5E5E5"> issue the following man to connect</font>

178
00:08:35,080 --> 00:08:39,760
<font color="#E5E5E5">to a DB and issue a request to download</font>

179
00:08:38,080 --> 00:08:41,409
a sample<font color="#E5E5E5"> and run that sample so again</font>

180
00:08:39,760 --> 00:08:43,360
<font color="#E5E5E5">infect the device and add it to its</font>

181
00:08:41,409 --> 00:08:46,260
botnet<font color="#E5E5E5"> so we can see here through the</font>

182
00:08:43,360 --> 00:08:48,610
evolution<font color="#E5E5E5"> Satori the addition of new</font>

183
00:08:46,260 --> 00:08:56,290
techniques<font color="#CCCCCC"> to gain</font><font color="#E5E5E5"> access and building</font><font color="#CCCCCC"> a</font>

184
00:08:48,610 --> 00:08:59,500
<font color="#CCCCCC">Pomeroy the</font><font color="#E5E5E5"> next example I want to talk</font>

185
00:08:56,290 --> 00:09:03,250
<font color="#E5E5E5">about is omg omg was discovered in early</font>

186
00:08:59,500 --> 00:09:06,160
2018<font color="#E5E5E5"> another my base variant with cool</font>

187
00:09:03,250 --> 00:09:08,920
<font color="#CCCCCC">about Emmet oMG is the author's decided</font>

188
00:09:06,160 --> 00:09:11,100
to integrate<font color="#E5E5E5"> proxy server</font><font color="#CCCCCC"> for both HP</font>

189
00:09:08,920 --> 00:09:13,300
<font color="#E5E5E5">proxy and socks proxy</font><font color="#CCCCCC"> into it and</font>

190
00:09:11,100 --> 00:09:15,850
similar to other variants it uses

191
00:09:13,300 --> 00:09:17,410
default credentials<font color="#CCCCCC"> if we simply run</font>

192
00:09:15,850 --> 00:09:19,240
strings on the binary we get a good

193
00:09:17,410 --> 00:09:21,219
indication<font color="#E5E5E5"> of maybe what proxy and</font><font color="#CCCCCC"> me</font>

194
00:09:19,240 --> 00:09:24,970
run you can see here it's using three

195
00:09:21,220 --> 00:09:28,959
proxy let's take a look at how oMG sets

196
00:09:24,970 --> 00:09:31,420
up<font color="#E5E5E5"> this proxy</font><font color="#CCCCCC"> here's a function that</font><font color="#E5E5E5"> was</font>

197
00:09:28,959 --> 00:09:33,040
inside<font color="#CCCCCC"> oMG that actually gets the proxy</font>

198
00:09:31,420 --> 00:09:36,880
portion<font color="#E5E5E5"> set up what it does it first</font>

199
00:09:33,040 --> 00:09:39,370
creates random ports for both the proxy

200
00:09:36,880 --> 00:09:46,000
<font color="#E5E5E5">HTTP proxy and</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> socks proxy then it</font>

201
00:09:39,370 --> 00:09:48,220
goes<font color="#CCCCCC"> through and tables and what</font><font color="#E5E5E5"> this</font>

202
00:09:46,000 --> 00:09:51,459
<font color="#E5E5E5">does is it either enables or disables IP</font>

203
00:09:48,220 --> 00:09:53,110
tables on a device so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the botnet</font>

204
00:09:51,459 --> 00:09:55,270
author can connect to<font color="#CCCCCC"> it and proxy</font>

205
00:09:53,110 --> 00:09:56,829
through<font color="#CCCCCC"> it</font><font color="#E5E5E5"> part of this function</font><font color="#CCCCCC"> too</font>

206
00:09:55,270 --> 00:09:59,110
would also send information<font color="#E5E5E5"> on what</font>

207
00:09:56,829 --> 00:10:00,489
ports those are<font color="#CCCCCC"> - it's</font><font color="#E5E5E5"> C and C so they</font>

208
00:09:59,110 --> 00:10:04,000
know<font color="#E5E5E5"> which one to connect to and if we</font>

209
00:10:00,490 --> 00:10:14,500
look at the actually of IP<font color="#E5E5E5"> tables</font>

210
00:10:04,000 --> 00:10:16,270
function we see how this is<font color="#E5E5E5"> done how it</font>

211
00:10:14,500 --> 00:10:19,240
does that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> it stores the IP tables</font>

212
00:10:16,270 --> 00:10:21,130
commands in a similar table figuration

213
00:10:19,240 --> 00:10:22,839
file<font color="#E5E5E5"> similar to</font><font color="#CCCCCC"> Mirai</font>

214
00:10:21,130 --> 00:10:24,550
<font color="#E5E5E5">and it pulled that value out and then</font>

215
00:10:22,839 --> 00:10:27,310
substitutes it in<font color="#E5E5E5"> in this</font>

216
00:10:24,550 --> 00:10:29,560
and then returns<font color="#CCCCCC"> and called the command</font>

217
00:10:27,310 --> 00:10:32,140
<font color="#E5E5E5">to either enable or disable it based on</font>

218
00:10:29,560 --> 00:10:34,000
what's the<font color="#CCCCCC"> c2s</font><font color="#E5E5E5"> said and if we go look at</font>

219
00:10:32,140 --> 00:10:37,180
that configuration table we see the same

220
00:10:34,000 --> 00:10:39,610
type<font color="#CCCCCC"> of table setting where we</font><font color="#E5E5E5"> have our</font>

221
00:10:37,180 --> 00:10:42,849
values here which are again<font color="#CCCCCC"> obvious</font>

222
00:10:39,610 --> 00:10:44,620
<font color="#CCCCCC">gated and it uses that</font><font color="#E5E5E5"> table to</font>

223
00:10:42,850 --> 00:10:46,060
reference where that information<font color="#E5E5E5"> is</font><font color="#CCCCCC"> and</font>

224
00:10:44,620 --> 00:10:48,910
pull it<font color="#E5E5E5"> out and we can</font><font color="#CCCCCC"> see the actual</font>

225
00:10:46,060 --> 00:10:51,699
<font color="#E5E5E5">ITP IP naval commander right here where</font>

226
00:10:48,910 --> 00:10:58,240
this one specific talks about dropping

227
00:10:51,700 --> 00:11:01,120
the<font color="#E5E5E5"> table so once it enable these ports</font>

228
00:10:58,240 --> 00:11:02,470
are disabled once<font color="#E5E5E5"> enable the ports they</font>

229
00:11:01,120 --> 00:11:04,450
needed to set<font color="#CCCCCC"> up the proxy we need to</font>

230
00:11:02,470 --> 00:11:05,860
get those ports<font color="#CCCCCC"> listening on the system</font>

231
00:11:04,450 --> 00:11:08,230
<font color="#E5E5E5">and whatnot here's the function that</font>

232
00:11:05,860 --> 00:11:22,230
<font color="#E5E5E5">handle it we look at the</font><font color="#CCCCCC"> function we can</font>

233
00:11:08,230 --> 00:11:22,230
see<font color="#CCCCCC"> how it calls the proxy options use</font>

234
00:11:22,890 --> 00:11:28,120
these server options use along with<font color="#E5E5E5"> the</font>

235
00:11:25,870 --> 00:11:31,000
cache server and so forth if we look at

236
00:11:28,120 --> 00:11:34,209
the configuration<font color="#E5E5E5"> file on github we can</font>

237
00:11:31,000 --> 00:11:35,800
see the exact same options here<font color="#E5E5E5"> so we</font>

238
00:11:34,209 --> 00:11:38,079
can kind of<font color="#E5E5E5"> get a good indication</font><font color="#CCCCCC"> at the</font>

239
00:11:35,800 --> 00:11:39,219
author just quickly copy this over<font color="#E5E5E5"> just</font>

240
00:11:38,079 --> 00:11:43,329
<font color="#E5E5E5">to get it up and running and</font><font color="#CCCCCC"> get it out</font>

241
00:11:39,220 --> 00:11:46,839
there the last<font color="#CCCCCC"> grant I</font><font color="#E5E5E5"> want to look at</font>

242
00:11:43,329 --> 00:11:49,680
is called<font color="#CCCCCC"> our</font><font color="#E5E5E5"> re over re and wiki were</font>

243
00:11:46,839 --> 00:11:53,890
discovered in 2018<font color="#CCCCCC"> both were based on</font>

244
00:11:49,680 --> 00:11:55,569
Mariah<font color="#E5E5E5"> or re is a funny</font><font color="#CCCCCC"> store</font><font color="#E5E5E5"> and we'll</font>

245
00:11:53,890 --> 00:11:57,579
<font color="#E5E5E5">get into it here in a minute</font><font color="#CCCCCC"> our re</font>

246
00:11:55,570 --> 00:11:59,290
originally used the default credentials

247
00:11:57,579 --> 00:12:01,209
similar to basic<font color="#E5E5E5"> Mariah</font>

248
00:11:59,290 --> 00:12:03,040
then it was updated<font color="#CCCCCC"> to include</font>

249
00:12:01,209 --> 00:12:05,040
additional command execution

250
00:12:03,040 --> 00:12:07,120
vulnerabilities there's a version

251
00:12:05,040 --> 00:12:09,699
variant called wiki that<font color="#E5E5E5"> was discovered</font>

252
00:12:07,120 --> 00:12:11,500
and part<font color="#E5E5E5"> of Wicked's main purpose in</font>

253
00:12:09,700 --> 00:12:12,940
life<font color="#CCCCCC"> was to download</font><font color="#E5E5E5"> copies over</font><font color="#CCCCCC"> r-e so</font>

254
00:12:11,500 --> 00:12:15,730
it's a good indication<font color="#E5E5E5"> that these two</font>

255
00:12:12,940 --> 00:12:18,060
<font color="#CCCCCC">families were tied together and wicked</font>

256
00:12:15,730 --> 00:12:24,310
targeted specific Netgear routers and

257
00:12:18,060 --> 00:12:26,699
CCTV<font color="#E5E5E5"> dvrs similar to</font><font color="#CCCCCC"> Mirai owari used</font>

258
00:12:24,310 --> 00:12:26,699
the same

259
00:12:53,130 --> 00:12:57,370
this<font color="#CCCCCC"> setup</font><font color="#E5E5E5"> versus just either</font>

260
00:12:55,720 --> 00:13:02,500
<font color="#CCCCCC">hard-coding both</font><font color="#E5E5E5"> or just put them in a</font>

261
00:12:57,370 --> 00:13:04,060
configuration<font color="#E5E5E5"> table who knows here's the</font>

262
00:13:02,500 --> 00:13:05,470
function<font color="#CCCCCC"> that</font><font color="#E5E5E5"> looks for the default</font>

263
00:13:04,060 --> 00:13:13,719
<font color="#CCCCCC">credentials we can see the ones</font><font color="#E5E5E5"> that</font>

264
00:13:05,470 --> 00:13:17,530
were<font color="#E5E5E5"> matched then it would move forth</font>

265
00:13:13,720 --> 00:13:19,450
from there so it<font color="#CCCCCC"> used this until they</font>

266
00:13:17,530 --> 00:13:21,640
<font color="#E5E5E5">got some love on Twitter here's a post</font>

267
00:13:19,450 --> 00:13:23,560
that<font color="#E5E5E5"> was put</font><font color="#CCCCCC"> up pretty</font><font color="#E5E5E5"> much making fun</font>

268
00:13:21,640 --> 00:13:24,040
of our poking at the fact that our<font color="#CCCCCC"> are</font>

269
00:13:23,560 --> 00:13:27,069
used

270
00:13:24,040 --> 00:13:29,110
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> old-school technique telnet in</font>

271
00:13:27,070 --> 00:13:31,870
response to this<font color="#CCCCCC"> Twitter feed artists</font>

272
00:13:29,110 --> 00:13:35,920
Twitter post<font color="#E5E5E5"> the</font><font color="#CCCCCC"> authors introduced some</font>

273
00:13:31,870 --> 00:13:38,490
vulnerability the<font color="#E5E5E5"> this CVE</font><font color="#CCCCCC"> attack this</font>

274
00:13:35,920 --> 00:13:38,490
to gain access

275
00:13:39,150 --> 00:13:44,980
as I said wicked was also<font color="#E5E5E5"> associated</font>

276
00:13:42,460 --> 00:14:21,250
with<font color="#E5E5E5"> our re here's a different exploits</font>

277
00:13:44,980 --> 00:14:35,200
that<font color="#E5E5E5"> were used from wicked words and the</font>

278
00:14:21,250 --> 00:14:37,930
last one is<font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> a funny thing the</font>

279
00:14:35,200 --> 00:14:39,910
<font color="#CCCCCC">vice know that it's been compromised so</font>

280
00:14:37,930 --> 00:14:42,130
we see<font color="#E5E5E5"> the again storing the</font><font color="#CCCCCC"> information</font>

281
00:14:39,910 --> 00:14:44,410
within the<font color="#CCCCCC"> table uh</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> D skating it</font>

282
00:14:42,130 --> 00:14:49,620
right<font color="#CCCCCC"> and out to the</font><font color="#E5E5E5"> different</font><font color="#CCCCCC"> portions</font>

283
00:14:44,410 --> 00:14:49,620
of the filesystem<font color="#CCCCCC"> and then who will ask</font>

284
00:14:50,660 --> 00:14:54,839
we still see<font color="#E5E5E5"> these attacks and they're</font>

285
00:14:52,950 --> 00:14:55,980
still<font color="#E5E5E5"> going on they're not going away</font>

286
00:14:54,840 --> 00:14:57,360
they're not<font color="#E5E5E5"> slowing down</font>

287
00:14:55,980 --> 00:15:00,960
we'll see<font color="#CCCCCC"> seem variance using this</font>

288
00:14:57,360 --> 00:15:02,340
here's<font color="#E5E5E5"> just an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of a point of</font>

289
00:15:00,960 --> 00:15:03,690
time in the beginning<font color="#CCCCCC"> of August where</font>

290
00:15:02,340 --> 00:15:04,320
we're seeing<font color="#E5E5E5"> traffic this is from our</font>

291
00:15:03,690 --> 00:15:26,490
<font color="#E5E5E5">honeypot</font>

292
00:15:04,320 --> 00:15:31,290
collecting data and people<font color="#E5E5E5"> still use</font>

293
00:15:26,490 --> 00:15:33,000
telnet so now<font color="#CCCCCC"> that we talked about</font><font color="#E5E5E5"> all</font>

294
00:15:31,290 --> 00:15:34,980
these variances how do we analyze<font color="#E5E5E5"> them</font>

295
00:15:33,000 --> 00:15:37,080
<font color="#E5E5E5">in a quick</font><font color="#CCCCCC"> and efficient</font><font color="#E5E5E5"> fashion from a</font>

296
00:15:34,980 --> 00:15:38,970
butenes perspective our goal is<font color="#CCCCCC"> to</font>

297
00:15:37,080 --> 00:15:40,560
figure out what<font color="#E5E5E5"> new functionality they</font>

298
00:15:38,970 --> 00:15:43,190
have what new exploits they have so we

299
00:15:40,560 --> 00:15:45,000
<font color="#E5E5E5">can kick out our i/o</font><font color="#CCCCCC"> sees as part of the</font>

300
00:15:43,190 --> 00:15:46,590
source<font color="#E5E5E5"> that was released from Rai</font>

301
00:15:45,000 --> 00:15:49,230
there's a build<font color="#E5E5E5"> script to make your life</font>

302
00:15:46,590 --> 00:15:51,570
easier<font color="#CCCCCC"> in the build script there's a use</font>

303
00:15:49,230 --> 00:15:53,070
of strip<font color="#E5E5E5"> and for those that are not</font>

304
00:15:51,570 --> 00:15:55,230
<font color="#E5E5E5">familiar with strip what it does</font><font color="#CCCCCC"> is it</font>

305
00:15:53,070 --> 00:15:57,810
<font color="#E5E5E5">removes any type of symbols</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> binary</font>

306
00:15:55,230 --> 00:15:59,460
<font color="#E5E5E5">which makes it difficult to</font><font color="#CCCCCC"> reverse and</font>

307
00:15:57,810 --> 00:16:01,890
when<font color="#E5E5E5"> I say symbols it's stuff like</font>

308
00:15:59,460 --> 00:16:03,390
what's work is and stuff<font color="#E5E5E5"> like that which</font>

309
00:16:01,890 --> 00:16:04,620
makes you have<font color="#E5E5E5"> to go through and figure</font>

310
00:16:03,390 --> 00:16:06,330
<font color="#E5E5E5">out</font><font color="#CCCCCC"> okay we're all these system calls</font>

311
00:16:04,620 --> 00:16:08,100
<font color="#CCCCCC">it's real a trace it so what you'll see</font>

312
00:16:06,330 --> 00:16:11,220
<font color="#CCCCCC">is</font><font color="#E5E5E5"> you'll just</font><font color="#CCCCCC"> see the basic assembly</font>

313
00:16:08,100 --> 00:16:12,930
<font color="#E5E5E5">you'll see a SVC</font><font color="#CCCCCC"> 0 in the</font><font color="#E5E5E5"> arm world and</font>

314
00:16:11,220 --> 00:16:14,130
then you'll see<font color="#E5E5E5"> the variable that's</font>

315
00:16:12,930 --> 00:16:15,510
<font color="#E5E5E5">being passed to it to tell you what</font>

316
00:16:14,130 --> 00:16:18,030
system call is so you have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> figure</font>

317
00:16:15,510 --> 00:16:20,160
that<font color="#CCCCCC"> all by yourself but in some</font><font color="#E5E5E5"> cases</font>

318
00:16:18,030 --> 00:16:21,600
<font color="#E5E5E5">Dafa gets lazy and just leaves full</font>

319
00:16:20,160 --> 00:16:29,160
symbols there so it's very<font color="#CCCCCC"> easy to</font>

320
00:16:21,600 --> 00:16:31,020
figure<font color="#CCCCCC"> out this blue team's</font><font color="#E5E5E5"> perspective</font>

321
00:16:29,160 --> 00:16:33,900
<font color="#CCCCCC">or analyst perspective makes our life</font>

322
00:16:31,020 --> 00:16:35,490
<font color="#E5E5E5">really</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> but what happens when you</font>

323
00:16:33,900 --> 00:16:38,880
<font color="#E5E5E5">don't have that you don't have these</font>

324
00:16:35,490 --> 00:16:40,320
symbols<font color="#E5E5E5"> you get the script binary why</font>

325
00:16:38,880 --> 00:16:43,080
not use the source code the same<font color="#E5E5E5"> way</font>

326
00:16:40,320 --> 00:16:44,280
that<font color="#E5E5E5"> a botnet author does why not</font>

327
00:16:43,080 --> 00:16:46,200
leverage that to help<font color="#E5E5E5"> us build</font>

328
00:16:44,280 --> 00:16:48,209
signatures to<font color="#E5E5E5"> be able to quickly analyze</font>

329
00:16:46,200 --> 00:16:50,640
these variants to figure out what has

330
00:16:48,210 --> 00:16:52,260
changed<font color="#E5E5E5"> there's still tools I'm going</font><font color="#CCCCCC"> to</font>

331
00:16:50,640 --> 00:16:54,480
<font color="#E5E5E5">talk about real quick</font><font color="#CCCCCC"> here is the phoria</font>

332
00:16:52,260 --> 00:16:57,270
<font color="#E5E5E5">and</font><font color="#CCCCCC"> rizal which allows us to quickly</font>

333
00:16:54,480 --> 00:16:59,770
analyze these samples<font color="#CCCCCC"> and if authors are</font>

334
00:16:57,270 --> 00:17:01,630
here to wrote those thank you

335
00:16:59,770 --> 00:17:04,750
the<font color="#CCCCCC"> forea</font><font color="#E5E5E5"> you can think up the</font><font color="#CCCCCC"> phoria</font>

336
00:17:01,630 --> 00:17:20,500
<font color="#CCCCCC">has been DIF and there may get their</font>

337
00:17:04,750 --> 00:17:22,900
<font color="#CCCCCC">screenshots</font><font color="#E5E5E5"> there you information about</font>

338
00:17:20,500 --> 00:17:24,310
<font color="#E5E5E5">what functions are there and kind of</font>

339
00:17:22,900 --> 00:17:27,790
like signatures are<font color="#E5E5E5"> on those functions</font>

340
00:17:24,310 --> 00:17:53,889
then what you can do is apply<font color="#CCCCCC"> it to your</font>

341
00:17:27,790 --> 00:17:55,750
<font color="#CCCCCC">stripped binary function Rizzo</font><font color="#E5E5E5"> Rizzo's</font>

342
00:17:53,890 --> 00:17:58,780
another favorite tool<font color="#E5E5E5"> mile of results</font>

343
00:17:55,750 --> 00:18:00,820
<font color="#E5E5E5">Rizal Bay builds like signatures and</font>

344
00:17:58,780 --> 00:18:02,860
<font color="#CCCCCC">that you can</font><font color="#E5E5E5"> apply against</font><font color="#CCCCCC"> stripped</font>

345
00:18:00,820 --> 00:18:05,290
binaries so<font color="#CCCCCC"> a similar fashion</font><font color="#E5E5E5"> you create</font>

346
00:18:02,860 --> 00:18:07,270
your<font color="#CCCCCC"> arrival rate that's not earlier</font>

347
00:18:05,290 --> 00:18:08,920
build your version MRI for the

348
00:18:07,270 --> 00:18:11,470
architecture<font color="#E5E5E5"> you want to test rip or</font>

349
00:18:08,920 --> 00:18:14,560
analyze make sure you<font color="#E5E5E5"> don't strip</font><font color="#CCCCCC"> the</font>

350
00:18:11,470 --> 00:18:18,910
symbols<font color="#E5E5E5"> then you use Rizzo to creates a</font>

351
00:18:14,560 --> 00:18:20,379
pattern file or a signature file here's

352
00:18:18,910 --> 00:18:21,820
the<font color="#CCCCCC"> stripped binary</font><font color="#E5E5E5"> this is what we see</font>

353
00:18:20,380 --> 00:18:24,520
we see<font color="#CCCCCC"> the functions over here there</font>

354
00:18:21,820 --> 00:18:26,950
aren't label just the default<font color="#CCCCCC"> Ida</font>

355
00:18:24,520 --> 00:18:28,330
labeling<font color="#E5E5E5"> we see the assembly nothing no</font>

356
00:18:26,950 --> 00:18:29,560
real good clues here you know a lot<font color="#CCCCCC"> of</font>

357
00:18:28,330 --> 00:18:32,230
work to<font color="#CCCCCC"> try to figure out</font><font color="#E5E5E5"> some just the</font>

358
00:18:29,560 --> 00:18:34,149
basic functionality well once<font color="#E5E5E5"> we apply</font>

359
00:18:32,230 --> 00:18:57,490
<font color="#E5E5E5">the</font><font color="#CCCCCC"> original database</font><font color="#E5E5E5"> and we start</font>

360
00:18:34,150 --> 00:18:59,500
seeing<font color="#E5E5E5"> great information it's not</font><font color="#CCCCCC"> a</font>

361
00:18:57,490 --> 00:19:01,510
hundred<font color="#CCCCCC"> percent so you're not going to</font>

362
00:18:59,500 --> 00:19:04,960
get<font color="#CCCCCC"> 100% one-to-one matches all the</font><font color="#E5E5E5"> time</font>

363
00:19:01,510 --> 00:19:06,430
<font color="#E5E5E5">sometimes Rizzo or</font><font color="#CCCCCC"> the foria messes up</font>

364
00:19:04,960 --> 00:19:08,590
and<font color="#E5E5E5"> doesn't catch the</font><font color="#CCCCCC"> right function</font><font color="#E5E5E5"> so</font>

365
00:19:06,430 --> 00:19:10,300
a lot<font color="#E5E5E5"> of times you just double check to</font>

366
00:19:08,590 --> 00:19:13,330
<font color="#CCCCCC">make sure but it does help reduce the</font>

367
00:19:10,300 --> 00:19:13,840
noise another<font color="#E5E5E5"> example of you know using</font>

368
00:19:13,330 --> 00:19:15,990
<font color="#E5E5E5">red zone</font>

369
00:19:13,840 --> 00:19:18,070
<font color="#CCCCCC">phoria it's not just</font><font color="#E5E5E5"> limited to</font><font color="#CCCCCC"> Mirai</font>

370
00:19:15,990 --> 00:19:21,690
<font color="#CCCCCC">recently there's a new bot that came out</font>

371
00:19:18,070 --> 00:19:23,260
called<font color="#CCCCCC"> Tori this bot was built off of</font>

372
00:19:21,690 --> 00:19:25,630
you<font color="#CCCCCC"> Lipsy</font>

373
00:19:23,260 --> 00:19:27,429
so what we can do with the same type<font color="#CCCCCC"> of</font>

374
00:19:25,630 --> 00:19:30,130
kind<font color="#CCCCCC"> of ID in mine we can build a Rizal</font>

375
00:19:27,429 --> 00:19:32,740
file or a de Fora<font color="#CCCCCC"> DIF database based off</font>

376
00:19:30,130 --> 00:19:34,870
<font color="#CCCCCC">a UMC and</font><font color="#E5E5E5"> then apply that</font><font color="#CCCCCC"> to the strip</font>

377
00:19:32,740 --> 00:19:39,220
version<font color="#CCCCCC"> of Tori</font><font color="#E5E5E5"> to help us identify</font>

378
00:19:34,870 --> 00:19:40,750
these common functions like memcache or

379
00:19:39,220 --> 00:19:41,230
mem<font color="#E5E5E5"> Alex so we don't have to sit</font><font color="#CCCCCC"> there</font>

380
00:19:40,750 --> 00:19:43,960
<font color="#CCCCCC">and figure</font>

381
00:19:41,230 --> 00:19:45,760
oh well we see this<font color="#E5E5E5"> type of pattern here</font>

382
00:19:43,960 --> 00:19:47,770
okay this<font color="#E5E5E5"> has to</font><font color="#CCCCCC"> be mem copy Satori and</font>

383
00:19:45,760 --> 00:19:54,429
<font color="#CCCCCC">D forea does</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of heavy lifting</font><font color="#E5E5E5"> for</font>

384
00:19:47,770 --> 00:19:56,260
us the fan against IOT<font color="#CCCCCC"> BA saw what can</font>

385
00:19:54,429 --> 00:19:58,659
we do<font color="#E5E5E5"> you know the help reduce the risk</font>

386
00:19:56,260 --> 00:20:00,940
<font color="#CCCCCC">of this from the manufacture side we can</font>

387
00:19:58,659 --> 00:20:03,909
start looking at<font color="#CCCCCC"> doing code reviews make</font>

388
00:20:00,940 --> 00:20:04,960
sure to secure code reviews<font color="#E5E5E5"> and security</font>

389
00:20:03,909 --> 00:20:06,730
assessments are being<font color="#E5E5E5"> done against the</font>

390
00:20:04,960 --> 00:20:08,649
<font color="#E5E5E5">devices during</font><font color="#CCCCCC"> development time not as</font>

391
00:20:06,730 --> 00:20:10,330
an afterthought<font color="#CCCCCC"> or a</font><font color="#E5E5E5"> bolt on that okay</font>

392
00:20:08,649 --> 00:20:11,889
we have the<font color="#E5E5E5"> chipsets we have all this</font>

393
00:20:10,330 --> 00:20:13,449
stuff<font color="#E5E5E5"> now let's do the security review</font>

394
00:20:11,890 --> 00:20:15,940
and we're kind of locked<font color="#E5E5E5"> into using the</font>

395
00:20:13,450 --> 00:20:18,250
technology and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> hardware from</font><font color="#CCCCCC"> the</font>

396
00:20:15,940 --> 00:20:19,960
user side basic basic thing we can do is

397
00:20:18,250 --> 00:20:21,370
<font color="#E5E5E5">change the password</font><font color="#CCCCCC"> go away</font><font color="#E5E5E5"> let's not</font>

398
00:20:19,960 --> 00:20:23,409
leave those default<font color="#E5E5E5"> passwords admin</font>

399
00:20:21,370 --> 00:20:28,239
admin and let our devices<font color="#E5E5E5"> be used as a</font>

400
00:20:23,409 --> 00:20:30,010
bot from an enterprise perspective if

401
00:20:28,240 --> 00:20:31,240
we're using<font color="#E5E5E5"> like DVRs or IP based</font>

402
00:20:30,010 --> 00:20:32,799
cameras let's do ingress<font color="#E5E5E5"> egress</font>

403
00:20:31,240 --> 00:20:35,110
filtering you know simple things<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

404
00:20:32,799 --> 00:20:37,029
<font color="#CCCCCC">can prevent anybody on the internet from</font>

405
00:20:35,110 --> 00:20:38,260
attacking there's no reason that<font color="#CCCCCC"> anybody</font>

406
00:20:37,029 --> 00:20:42,460
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> internet should be able access</font><font color="#E5E5E5"> my</font>

407
00:20:38,260 --> 00:20:43,750
DVR<font color="#E5E5E5"> or my IP based camera and from users</font>

408
00:20:42,460 --> 00:20:45,669
<font color="#CCCCCC">perspective also</font><font color="#E5E5E5"> we need to make</font><font color="#CCCCCC"> sure</font>

409
00:20:43,750 --> 00:20:48,159
<font color="#CCCCCC">that we're applying</font><font color="#E5E5E5"> or subscribing to</font>

410
00:20:45,669 --> 00:20:49,929
the manufacturers security updates and

411
00:20:48,159 --> 00:20:51,279
once we get<font color="#E5E5E5"> that message coming in we</font>

412
00:20:49,929 --> 00:20:52,570
need<font color="#E5E5E5"> to apply those</font><font color="#CCCCCC"> patches and make</font>

413
00:20:51,279 --> 00:20:54,419
sure that those<font color="#E5E5E5"> devices are</font><font color="#CCCCCC"> getting</font>

414
00:20:52,570 --> 00:20:57,370
passionate<font color="#E5E5E5"> timely manner</font>

415
00:20:54,419 --> 00:21:00,340
so in summary<font color="#E5E5E5"> IOT devices are not going</font>

416
00:20:57,370 --> 00:21:02,529
<font color="#E5E5E5">away nor our malware targeting them it</font>

417
00:21:00,340 --> 00:21:05,080
just<font color="#CCCCCC"> because</font><font color="#E5E5E5"> of the simple fact</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> how</font>

418
00:21:02,529 --> 00:21:07,240
many<font color="#CCCCCC"> devices are out there it's a huge</font>

419
00:21:05,080 --> 00:21:09,520
footprint<font color="#E5E5E5"> and it's a very juicy target</font>

420
00:21:07,240 --> 00:21:12,700
you know security<font color="#CCCCCC"> around IOT is like</font>

421
00:21:09,520 --> 00:21:15,100
that<font color="#CCCCCC"> of late 90s on PCs we see the same</font>

422
00:21:12,700 --> 00:21:16,600
<font color="#E5E5E5">type of issues that we saw back then we</font>

423
00:21:15,100 --> 00:21:19,510
see default credentials we see easy

424
00:21:16,600 --> 00:21:23,439
<font color="#E5E5E5">command injection colder execution that</font>

425
00:21:19,510 --> 00:21:24,580
type of<font color="#E5E5E5"> stuff you still see and from you</font>

426
00:21:23,440 --> 00:21:26,860
<font color="#E5E5E5">know a blue team perspective let's</font>

427
00:21:24,580 --> 00:21:27,639
leverage<font color="#E5E5E5"> the source botnet authors are</font>

428
00:21:26,860 --> 00:21:29,559
doing it why can't

429
00:21:27,640 --> 00:21:30,940
to help us reduce<font color="#CCCCCC"> the time it takes to</font>

430
00:21:29,559 --> 00:21:33,460
analyze these things<font color="#CCCCCC"> and pull off these</font>

431
00:21:30,940 --> 00:21:35,470
<font color="#CCCCCC">ilcs</font><font color="#E5E5E5"> and lastly we should be thinking</font><font color="#CCCCCC"> of</font>

432
00:21:33,460 --> 00:21:37,500
IOT<font color="#E5E5E5"> devices the same as our</font><font color="#CCCCCC"> PCs and</font><font color="#E5E5E5"> our</font>

433
00:21:35,470 --> 00:21:40,720
servers<font color="#E5E5E5"> they should be added to</font><font color="#CCCCCC"> our</font>

434
00:21:37,500 --> 00:21:43,090
<font color="#E5E5E5">regular security testing you know any</font>

435
00:21:40,720 --> 00:21:44,380
type<font color="#CCCCCC"> of network pen</font><font color="#E5E5E5"> test or web app pen</font>

436
00:21:43,090 --> 00:21:45,850
test these device<font color="#E5E5E5"> should</font><font color="#CCCCCC"> be thrown in</font>

437
00:21:44,380 --> 00:21:47,679
there along<font color="#CCCCCC"> with our regular patching</font>

438
00:21:45,850 --> 00:21:48,909
cycle<font color="#E5E5E5"> I know most corporations have a</font>

439
00:21:47,679 --> 00:21:50,650
railer date where they're doing<font color="#CCCCCC"> their</font>

440
00:21:48,910 --> 00:21:52,390
patches they're patching their Microsoft

441
00:21:50,650 --> 00:21:54,460
systems are patching their applications

442
00:21:52,390 --> 00:21:59,290
<font color="#E5E5E5">these IOT devices should</font><font color="#CCCCCC"> be included</font>

443
00:21:54,460 --> 00:22:00,910
along<font color="#CCCCCC"> with that</font><font color="#E5E5E5"> packing cycle that's it</font>

444
00:21:59,290 --> 00:22:17,020
<font color="#E5E5E5">well thank you guys for coming</font><font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> open</font>

445
00:22:00,910 --> 00:22:18,190
it up<font color="#CCCCCC"> for any questions yes sir yeah</font>

446
00:22:17,020 --> 00:22:20,918
that's an interesting<font color="#E5E5E5"> question I've</font>

447
00:22:18,190 --> 00:22:23,169
thought<font color="#CCCCCC"> about is actually</font><font color="#E5E5E5"> attacking</font><font color="#CCCCCC"> um</font>

448
00:22:20,919 --> 00:22:25,330
not<font color="#E5E5E5"> only that since you have</font><font color="#CCCCCC"> the source</font>

449
00:22:23,169 --> 00:22:27,309
<font color="#CCCCCC">Mariah also have the CNC server</font>

450
00:22:25,330 --> 00:22:28,870
reviewing a CNC server see if there's

451
00:22:27,309 --> 00:22:30,280
any volunteers there and attacking<font color="#E5E5E5"> the</font>

452
00:22:28,870 --> 00:22:32,080
C&C server and taking it<font color="#CCCCCC"> over and</font>

453
00:22:30,280 --> 00:22:34,990
shutting it down that<font color="#E5E5E5"> way so there's a</font>

454
00:22:32,080 --> 00:22:37,449
lot of<font color="#CCCCCC"> these bots I mean</font><font color="#E5E5E5"> the authors are</font>

455
00:22:34,990 --> 00:22:39,820
not<font color="#E5E5E5"> I would say the most</font>

456
00:22:37,450 --> 00:22:41,410
security-conscious<font color="#CCCCCC"> coders so yeah</font>

457
00:22:39,820 --> 00:22:42,549
there's a lot of bugs<font color="#CCCCCC"> in</font><font color="#E5E5E5"> them that we</font>

458
00:22:41,410 --> 00:22:44,650
can leverage from<font color="#CCCCCC"> a blue team</font>

459
00:22:42,549 --> 00:22:46,240
<font color="#CCCCCC">perspective to you know either</font><font color="#E5E5E5"> use those</font>

460
00:22:44,650 --> 00:22:47,380
to shut them down or<font color="#CCCCCC"> whatnot</font><font color="#E5E5E5"> but that's</font>

461
00:22:46,240 --> 00:22:51,490
one<font color="#E5E5E5"> of those things</font><font color="#CCCCCC"> you need to probably</font>

462
00:22:47,380 --> 00:22:55,750
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> to your</font><font color="#E5E5E5"> legal group no problem</font>

463
00:22:51,490 --> 00:22:57,130
<font color="#E5E5E5">anybody else any questions all right</font>

464
00:22:55,750 --> 00:22:58,410
<font color="#CCCCCC">I'll be here for the rest</font><font color="#E5E5E5"> of the con</font>

465
00:22:57,130 --> 00:23:04,329
thank you guys

466
00:22:58,410 --> 00:23:04,329
[Applause]

