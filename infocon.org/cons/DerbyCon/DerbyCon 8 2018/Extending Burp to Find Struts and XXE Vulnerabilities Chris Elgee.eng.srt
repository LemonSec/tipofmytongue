1
00:00:16,699 --> 00:00:20,910
<font color="#CCCCCC">well good afternoon</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> name is</font><font color="#E5E5E5"> Chris and</font>

2
00:00:19,260 --> 00:00:22,529
<font color="#CCCCCC">I'm happy to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to you about</font><font color="#E5E5E5"> burping</font>

3
00:00:20,910 --> 00:00:24,510
better<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> they're really</font><font color="#CCCCCC"> kind of</font>

4
00:00:22,529 --> 00:00:26,400
two concurrent themes in this talk<font color="#E5E5E5"> one</font>

5
00:00:24,510 --> 00:00:27,990
is<font color="#E5E5E5"> about really</font><font color="#CCCCCC"> about finding struts</font><font color="#E5E5E5"> and</font>

6
00:00:26,400 --> 00:00:29,220
kind of<font color="#E5E5E5"> the best way to do</font><font color="#CCCCCC"> that in an</font>

7
00:00:27,990 --> 00:00:32,040
environment<font color="#CCCCCC"> whether it's</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> own</font>

8
00:00:29,220 --> 00:00:33,870
environment or in a client's environment

9
00:00:32,040 --> 00:00:35,690
in<font color="#E5E5E5"> a pen test but then there's also kind</font>

10
00:00:33,870 --> 00:00:38,089
<font color="#E5E5E5">of a bit of</font><font color="#CCCCCC"> a John strand theme here of</font>

11
00:00:35,690 --> 00:00:39,899
<font color="#E5E5E5">building things and giving them away so</font>

12
00:00:38,090 --> 00:00:42,030
you pay<font color="#CCCCCC"> attention I'm sure</font><font color="#E5E5E5"> you'll pick</font>

13
00:00:39,899 --> 00:00:43,710
that up<font color="#CCCCCC"> so just a bit</font><font color="#E5E5E5"> about myself so</font>

14
00:00:42,030 --> 00:00:45,660
you<font color="#E5E5E5"> have some</font><font color="#CCCCCC"> idea who I am the</font><font color="#E5E5E5"> last</font>

15
00:00:43,710 --> 00:00:48,930
name<font color="#E5E5E5"> is pronounced LG like a letter L</font>

16
00:00:45,660 --> 00:00:51,148
<font color="#CCCCCC">and the letter G I am a nerd at counter</font>

17
00:00:48,930 --> 00:00:53,309
hack challenges<font color="#E5E5E5"> proud to be there were</font>

18
00:00:51,149 --> 00:00:54,809
<font color="#E5E5E5">those guys I do want to mention</font><font color="#CCCCCC"> Sage</font>

19
00:00:53,309 --> 00:00:56,849
data security<font color="#CCCCCC"> too and my previous</font>

20
00:00:54,809 --> 00:00:58,500
<font color="#E5E5E5">employer because I did most this work on</font>

21
00:00:56,850 --> 00:01:01,469
their time<font color="#E5E5E5"> I do appreciate that from</font>

22
00:00:58,500 --> 00:01:02,399
them<font color="#CCCCCC"> I got</font><font color="#E5E5E5"> some certs</font><font color="#CCCCCC"> I'm also in the</font>

23
00:01:01,469 --> 00:01:03,809
<font color="#E5E5E5">Army National Guard</font>

24
00:01:02,399 --> 00:01:07,049
if you speak army at<font color="#E5E5E5"> all</font><font color="#CCCCCC"> there's some</font>

25
00:01:03,809 --> 00:01:10,560
letters<font color="#CCCCCC"> and I feel really</font><font color="#E5E5E5"> so important</font>

26
00:01:07,049 --> 00:01:11,939
<font color="#E5E5E5">all right so so this this all kind of</font>

27
00:01:10,560 --> 00:01:14,640
came from what I like to<font color="#E5E5E5"> call false</font>

28
00:01:11,939 --> 00:01:16,830
negative<font color="#CCCCCC"> anxiety now a</font><font color="#E5E5E5"> penetration test</font>

29
00:01:14,640 --> 00:01:18,600
<font color="#E5E5E5">is not about finding every single thing</font>

30
00:01:16,830 --> 00:01:19,890
in a<font color="#E5E5E5"> client's environment if you're</font>

31
00:01:18,600 --> 00:01:20,880
hiring a pen tester<font color="#E5E5E5"> and they tell you</font>

32
00:01:19,890 --> 00:01:24,150
that<font color="#CCCCCC"> they're going to</font><font color="#E5E5E5"> find every single</font>

33
00:01:20,880 --> 00:01:25,649
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> they're lying to you run away at</font>

34
00:01:24,150 --> 00:01:28,470
the same time if there's something

35
00:01:25,650 --> 00:01:30,180
<font color="#E5E5E5">really obvious</font><font color="#CCCCCC"> that you miss you're kind</font>

36
00:01:28,470 --> 00:01:31,950
of<font color="#E5E5E5"> letting your client down so for</font>

37
00:01:30,180 --> 00:01:33,420
example had I been the pen tester and<font color="#E5E5E5"> I</font>

38
00:01:31,950 --> 00:01:35,220
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> know they had a pen test but had I</font>

39
00:01:33,420 --> 00:01:37,259
been a pen tester a month before<font color="#E5E5E5"> Equifax</font>

40
00:01:35,220 --> 00:01:38,820
got hacked<font color="#CCCCCC"> I would feel really</font><font color="#E5E5E5"> bad</font>

41
00:01:37,259 --> 00:01:40,920
having not found the<font color="#CCCCCC"> RCD in their</font>

42
00:01:38,820 --> 00:01:42,119
website and and not<font color="#E5E5E5"> to pick on Equifax</font>

43
00:01:40,920 --> 00:01:43,619
but it's it's a case that<font color="#CCCCCC"> I think</font>

44
00:01:42,119 --> 00:01:46,350
<font color="#CCCCCC">everybody's familiar</font><font color="#E5E5E5"> with when it comes</font>

45
00:01:43,619 --> 00:01:48,390
<font color="#CCCCCC">to us to stress vulnerabilities by the</font>

46
00:01:46,350 --> 00:01:50,729
way as this goes on<font color="#E5E5E5"> this is this is a</font>

47
00:01:48,390 --> 00:01:52,500
moderately technical talk and<font color="#E5E5E5"> and really</font>

48
00:01:50,729 --> 00:01:54,090
more<font color="#E5E5E5"> looking at the strut side of things</font>

49
00:01:52,500 --> 00:01:56,189
in the burp extension building side of

50
00:01:54,090 --> 00:02:00,000
things there was<font color="#E5E5E5"> a talk last year in</font>

51
00:01:56,189 --> 00:02:01,408
stables<font color="#E5E5E5"> by</font><font color="#CCCCCC"> Samson was the last name he</font>

52
00:02:00,000 --> 00:02:02,610
talked specifically<font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to belt</font>

53
00:02:01,409 --> 00:02:04,110
extensions so if you're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for that</font>

54
00:02:02,610 --> 00:02:05,219
<font color="#E5E5E5">piece</font><font color="#CCCCCC"> of it that could</font><font color="#E5E5E5"> be the piece</font>

55
00:02:04,110 --> 00:02:06,380
<font color="#E5E5E5">you're missing I encourage you to go</font>

56
00:02:05,219 --> 00:02:08,609
back<font color="#CCCCCC"> and look at that</font>

57
00:02:06,380 --> 00:02:10,228
so things<font color="#CCCCCC"> that things that</font><font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> want</font>

58
00:02:08,610 --> 00:02:12,660
to<font color="#E5E5E5"> miss is a pen tester I don't want to</font>

59
00:02:10,229 --> 00:02:13,770
miss<font color="#E5E5E5"> Cisco Cisco</font><font color="#CCCCCC"> right if that's</font><font color="#E5E5E5"> there</font>

60
00:02:12,660 --> 00:02:15,810
and<font color="#CCCCCC"> someone still got that</font>

61
00:02:13,770 --> 00:02:18,060
I'm gonna really<font color="#E5E5E5"> feel like a jerk having</font>

62
00:02:15,810 --> 00:02:19,920
missed<font color="#E5E5E5"> that if somebody's got a password</font>

63
00:02:18,060 --> 00:02:21,720
<font color="#CCCCCC">that's really</font><font color="#E5E5E5"> terrible but not in my</font>

64
00:02:19,920 --> 00:02:23,579
dictionary<font color="#CCCCCC"> I mean that's</font><font color="#E5E5E5"> that's kind</font><font color="#CCCCCC"> of</font>

65
00:02:21,720 --> 00:02:25,770
hard to deal with<font color="#E5E5E5"> but I might miss</font><font color="#CCCCCC"> that</font>

66
00:02:23,580 --> 00:02:28,080
<font color="#CCCCCC">I don't have an easy</font><font color="#E5E5E5"> way to find all</font>

67
00:02:25,770 --> 00:02:30,930
those terrible passwords<font color="#CCCCCC"> a really dumb</font>

68
00:02:28,080 --> 00:02:32,850
URL with things hidden<font color="#E5E5E5"> in it again maybe</font>

69
00:02:30,930 --> 00:02:35,160
it's in my my fuzzing dictionary maybe I

70
00:02:32,850 --> 00:02:36,329
found<font color="#CCCCCC"> it with der</font><font color="#E5E5E5"> Buster and and then</font>

71
00:02:35,160 --> 00:02:37,650
I'm gonna feel<font color="#CCCCCC"> like a jerk if I didn't</font>

72
00:02:36,330 --> 00:02:40,140
if<font color="#E5E5E5"> it's something obvious</font><font color="#CCCCCC"> like this that</font>

73
00:02:37,650 --> 00:02:41,670
I<font color="#E5E5E5"> just wasn't able to find logic bugs</font>

74
00:02:40,140 --> 00:02:43,950
like like shopping cart quantities

75
00:02:41,670 --> 00:02:45,239
that's that's really what humans<font color="#E5E5E5"> are for</font>

76
00:02:43,950 --> 00:02:47,880
when it comes<font color="#E5E5E5"> to web app pentesting</font>

77
00:02:45,240 --> 00:02:50,160
right<font color="#CCCCCC"> tools</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> Nets Parker can find a</font>

78
00:02:47,880 --> 00:02:52,740
lot of the<font color="#E5E5E5"> automated finds but it's</font>

79
00:02:50,160 --> 00:02:54,900
really the purpose<font color="#E5E5E5"> of having humans is</font>

80
00:02:52,740 --> 00:02:57,570
to<font color="#E5E5E5"> is to think about things there and be</font>

81
00:02:54,900 --> 00:02:58,650
creative<font color="#E5E5E5"> and and think that</font><font color="#CCCCCC"> oh that txt</font>

82
00:02:57,570 --> 00:03:01,290
file that's being<font color="#E5E5E5"> served up that's</font>

83
00:02:58,650 --> 00:03:03,480
actually<font color="#CCCCCC"> a log file of admin log ons I</font>

84
00:03:01,290 --> 00:03:05,310
saw that recently<font color="#E5E5E5"> scanners will</font>

85
00:03:03,480 --> 00:03:07,970
typically pick up on<font color="#E5E5E5"> that the last two</font>

86
00:03:05,310 --> 00:03:10,560
are also kind<font color="#E5E5E5"> of in that same category</font>

87
00:03:07,970 --> 00:03:13,590
<font color="#CCCCCC">when you've got an</font><font color="#E5E5E5"> XML external entity</font>

88
00:03:10,560 --> 00:03:16,770
in a in a<font color="#CCCCCC"> website where you're able to</font>

89
00:03:13,590 --> 00:03:19,200
basically inject<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> call out</font><font color="#CCCCCC"> to</font>

90
00:03:16,770 --> 00:03:21,360
another site<font color="#CCCCCC"> to pull in</font><font color="#E5E5E5"> additional</font>

91
00:03:19,200 --> 00:03:22,410
entities<font color="#E5E5E5"> that's that's not hard to check</font>

92
00:03:21,360 --> 00:03:24,510
for but it's<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> don't</font>

93
00:03:22,410 --> 00:03:26,160
always think<font color="#E5E5E5"> to do in every case</font><font color="#CCCCCC"> maybe</font>

94
00:03:24,510 --> 00:03:28,380
if there's<font color="#E5E5E5"> that if there's a piece of a</font>

95
00:03:26,160 --> 00:03:29,549
web app that involves submitting XML you

96
00:03:28,380 --> 00:03:31,620
might you<font color="#E5E5E5"> might think of that or maybe</font>

97
00:03:29,550 --> 00:03:33,180
it<font color="#E5E5E5"> involves submitting JSON you</font><font color="#CCCCCC"> think</font>

98
00:03:31,620 --> 00:03:35,910
well maybe<font color="#CCCCCC"> they can Swiss switch it to</font>

99
00:03:33,180 --> 00:03:37,200
XML and try it<font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> do that I want</font>

100
00:03:35,910 --> 00:03:39,299
<font color="#E5E5E5">to do that automatically every time same</font>

101
00:03:37,200 --> 00:03:41,760
thing<font color="#CCCCCC"> for struts there are ways to find</font>

102
00:03:39,300 --> 00:03:44,850
struts vulnerabilities and oh my<font color="#E5E5E5"> aching</font>

103
00:03:41,760 --> 00:03:46,290
struts<font color="#E5E5E5"> this is just a partial list these</font>

104
00:03:44,850 --> 00:03:47,700
by<font color="#E5E5E5"> the way on the</font><font color="#CCCCCC"> left-hand side</font><font color="#E5E5E5"> those</font>

105
00:03:46,290 --> 00:03:50,609
are<font color="#CCCCCC"> the CBE numbers along</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the</font>

106
00:03:47,700 --> 00:03:53,700
<font color="#CCCCCC">Apache</font><font color="#E5E5E5"> internal</font><font color="#CCCCCC"> s2 struts two numbers</font>

107
00:03:50,610 --> 00:03:55,320
with them<font color="#E5E5E5"> those are all</font><font color="#CCCCCC"> RCE</font><font color="#E5E5E5"> and as you</font>

108
00:03:53,700 --> 00:03:57,869
can<font color="#CCCCCC"> tell by</font><font color="#E5E5E5"> the years they come out fast</font>

109
00:03:55,320 --> 00:04:01,170
<font color="#E5E5E5">and furious and</font><font color="#CCCCCC"> they're they just</font><font color="#E5E5E5"> they</font>

110
00:03:57,870 --> 00:04:02,640
seem to keep<font color="#CCCCCC"> coming as far as</font><font color="#E5E5E5"> finding</font>

111
00:04:01,170 --> 00:04:04,980
them there there are plenty<font color="#CCCCCC"> of methods</font>

112
00:04:02,640 --> 00:04:07,649
of discovering<font color="#E5E5E5"> them I didn't invent any</font>

113
00:04:04,980 --> 00:04:08,519
of these<font color="#E5E5E5"> Python scripts in the red box</font>

114
00:04:07,650 --> 00:04:10,950
there because we're gonna come<font color="#CCCCCC"> back to</font>

115
00:04:08,520 --> 00:04:12,870
<font color="#E5E5E5">Python scripts is a good way to exploit</font>

116
00:04:10,950 --> 00:04:13,890
things in fact if you look<font color="#E5E5E5"> and I</font>

117
00:04:12,870 --> 00:04:15,480
<font color="#CCCCCC">actually built this before I started</font>

118
00:04:13,890 --> 00:04:17,579
<font color="#CCCCCC">built</font><font color="#E5E5E5"> this piece of it before I</font><font color="#CCCCCC"> started</font>

119
00:04:15,480 --> 00:04:19,950
<font color="#E5E5E5">working for the</font><font color="#CCCCCC"> fur counter</font><font color="#E5E5E5"> hack if you</font>

120
00:04:17,579 --> 00:04:21,539
like the<font color="#E5E5E5"> 2017 holiday hack challenge you</font>

121
00:04:19,950 --> 00:04:24,060
actually<font color="#E5E5E5"> needed</font><font color="#CCCCCC"> to use a stressful</font><font color="#E5E5E5"> nura</font>

122
00:04:21,540 --> 00:04:26,280
bility<font color="#E5E5E5"> to</font><font color="#CCCCCC"> get into a web server to pivot</font>

123
00:04:24,060 --> 00:04:28,170
<font color="#E5E5E5">into the internal environment</font>

124
00:04:26,280 --> 00:04:29,820
and there was actually a coincidentally

125
00:04:28,170 --> 00:04:32,160
there was a<font color="#E5E5E5"> sans</font><font color="#CCCCCC"> pentest blog post about</font>

126
00:04:29,820 --> 00:04:34,830
doing<font color="#E5E5E5"> that very</font><font color="#CCCCCC"> thing right before the</font>

127
00:04:32,160 --> 00:04:36,870
holiday hat came out<font color="#CCCCCC"> and by</font><font color="#E5E5E5"> the way if</font>

128
00:04:34,830 --> 00:04:39,359
you do try this<font color="#CCCCCC"> plug in</font><font color="#E5E5E5"> and we'll get</font>

129
00:04:36,870 --> 00:04:41,010
there<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you want to scan dev North</font>

130
00:04:39,360 --> 00:04:43,200
North Pole Christmas<font color="#E5E5E5"> town calm it will</font>

131
00:04:41,010 --> 00:04:47,280
pop with<font color="#CCCCCC"> the vulnerability</font><font color="#E5E5E5"> for struts</font>

132
00:04:43,200 --> 00:04:48,360
<font color="#E5E5E5">this second newest one 1905 another way</font>

133
00:04:47,280 --> 00:04:49,559
sometimes<font color="#CCCCCC"> you can find struts with the</font>

134
00:04:48,360 --> 00:04:51,840
ball<font color="#E5E5E5"> and scanners but that's kind of</font>

135
00:04:49,560 --> 00:04:53,670
hard because they could<font color="#E5E5E5"> be URL</font><font color="#CCCCCC"> specific</font>

136
00:04:51,840 --> 00:04:55,619
so unless you're feeding your<font color="#CCCCCC"> nessus</font>

137
00:04:53,670 --> 00:04:57,810
<font color="#E5E5E5">Qualis next close with a full list of</font>

138
00:04:55,620 --> 00:04:59,940
<font color="#CCCCCC">urls</font><font color="#E5E5E5"> you're probably going to miss that</font>

139
00:04:57,810 --> 00:05:02,400
that one page that has the vulnerability

140
00:04:59,940 --> 00:05:04,530
in it<font color="#CCCCCC"> NSE</font><font color="#E5E5E5"> scripts similar there are some</font>

141
00:05:02,400 --> 00:05:06,390
powerful<font color="#CCCCCC"> NSE scripts and</font><font color="#E5E5E5"> I love and map</font>

142
00:05:04,530 --> 00:05:07,830
scripts<font color="#E5E5E5"> but they've got</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have that URL</font>

143
00:05:06,390 --> 00:05:09,000
<font color="#E5E5E5">s because they're not typically going to</font>

144
00:05:07,830 --> 00:05:11,729
<font color="#E5E5E5">do this to the kind of</font><font color="#CCCCCC"> spidering you</font>

145
00:05:09,000 --> 00:05:13,860
need to find<font color="#E5E5E5"> these things active scan</font>

146
00:05:11,730 --> 00:05:16,440
<font color="#CCCCCC">plus plus</font><font color="#E5E5E5"> has anybody used active scan</font>

147
00:05:13,860 --> 00:05:18,360
plus plus awesome so if you're using

148
00:05:16,440 --> 00:05:19,500
<font color="#CCCCCC">Bert Pro</font><font color="#E5E5E5"> already it's a free</font><font color="#CCCCCC"> extension</font>

149
00:05:18,360 --> 00:05:21,570
you can<font color="#E5E5E5"> get we're gonna talk a lot about</font>

150
00:05:19,500 --> 00:05:23,580
it here in a bit<font color="#E5E5E5"> and it looks for</font><font color="#CCCCCC"> cool</font>

151
00:05:21,570 --> 00:05:28,320
<font color="#E5E5E5">things including the</font><font color="#CCCCCC"> epiphytes version</font>

152
00:05:23,580 --> 00:05:29,940
of struts<font color="#CCCCCC"> the 5638 so here's here is a</font>

153
00:05:28,320 --> 00:05:33,599
<font color="#E5E5E5">Python script this</font><font color="#CCCCCC"> is something actually</font>

154
00:05:29,940 --> 00:05:35,550
<font color="#E5E5E5">coded by Chris Davis Chris Davis thank</font>

155
00:05:33,600 --> 00:05:37,470
you<font color="#E5E5E5"> very much Chris Davis</font><font color="#CCCCCC"> code this cool</font>

156
00:05:35,550 --> 00:05:39,030
thing<font color="#E5E5E5"> it's up on github and then in</font>

157
00:05:37,470 --> 00:05:41,070
longshore what it does in<font color="#E5E5E5"> the top box</font>

158
00:05:39,030 --> 00:05:42,179
you I set up my<font color="#CCCCCC"> home</font><font color="#E5E5E5"> script for the</font>

159
00:05:41,070 --> 00:05:44,159
holiday hack last year where I could

160
00:05:42,180 --> 00:05:45,840
<font color="#CCCCCC">just get a shell on</font><font color="#E5E5E5"> a box by feeding a</font>

161
00:05:44,160 --> 00:05:47,460
command in this is what I want the box

162
00:05:45,840 --> 00:05:49,469
to do please execute<font color="#E5E5E5"> this command and</font>

163
00:05:47,460 --> 00:05:52,080
then the script very helpfully hands

164
00:05:49,470 --> 00:05:53,220
<font color="#E5E5E5">this big</font><font color="#CCCCCC"> OGN el blob of java</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> that</font>

165
00:05:52,080 --> 00:05:55,859
you<font color="#CCCCCC"> don't really need to understand</font>

166
00:05:53,220 --> 00:05:57,419
<font color="#E5E5E5">other than that it's the the</font><font color="#CCCCCC"> stress</font>

167
00:05:55,860 --> 00:05:59,370
engine is interpreting this<font color="#E5E5E5"> and then</font>

168
00:05:57,419 --> 00:06:01,950
taking the command which was very

169
00:05:59,370 --> 00:06:03,810
<font color="#E5E5E5">cleverly disguised with base64 and some</font>

170
00:06:01,950 --> 00:06:05,370
tea<font color="#E5E5E5"> also</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> get special characters</font>

171
00:06:03,810 --> 00:06:07,080
through so long<font color="#CCCCCC"> and short paths on</font>

172
00:06:05,370 --> 00:06:09,390
script awesome I aim<font color="#CCCCCC"> it at a specific</font>

173
00:06:07,080 --> 00:06:10,830
<font color="#CCCCCC">website give it a specific</font><font color="#E5E5E5"> command it</font>

174
00:06:09,390 --> 00:06:11,400
<font color="#E5E5E5">executes the command for</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> that's</font>

175
00:06:10,830 --> 00:06:13,979
<font color="#E5E5E5">awesome</font>

176
00:06:11,400 --> 00:06:15,239
now if I have a<font color="#E5E5E5"> whole list of URLs and I</font>

177
00:06:13,979 --> 00:06:16,650
want to script<font color="#E5E5E5"> something to use this</font>

178
00:06:15,240 --> 00:06:18,900
script a bunch of times<font color="#CCCCCC"> for each</font><font color="#E5E5E5"> of</font>

179
00:06:16,650 --> 00:06:21,090
those<font color="#CCCCCC"> URLs you could in theory use that</font>

180
00:06:18,900 --> 00:06:23,729
to scan for this specific<font color="#CCCCCC"> struts</font>

181
00:06:21,090 --> 00:06:25,080
vulnerability<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I'm lazy and</font><font color="#CCCCCC"> I'm</font>

182
00:06:23,729 --> 00:06:28,440
forgetful<font color="#E5E5E5"> and I want it to happen</font>

183
00:06:25,080 --> 00:06:31,580
automatically for<font color="#CCCCCC"> me every time I in</font>

184
00:06:28,440 --> 00:06:34,130
<font color="#E5E5E5">your shell</font><font color="#CCCCCC"> oh my god I have</font><font color="#E5E5E5"> configure</font>

185
00:06:31,580 --> 00:06:35,960
<font color="#E5E5E5">all right so active</font><font color="#CCCCCC"> scan plus plus</font><font color="#E5E5E5"> built</font>

186
00:06:34,130 --> 00:06:38,150
by one<font color="#E5E5E5"> of the one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the smartest Weber</font>

187
00:06:35,960 --> 00:06:40,700
testers I've ever heard of<font color="#E5E5E5"> James kettle</font>

188
00:06:38,150 --> 00:06:42,320
<font color="#CCCCCC">if you've ever heard of L vinyl wax</font><font color="#E5E5E5"> if</font>

189
00:06:40,700 --> 00:06:44,719
you want to feel really<font color="#E5E5E5"> dumb go look up</font>

190
00:06:42,320 --> 00:06:46,670
a talk like cracking<font color="#E5E5E5"> the lens the man is</font>

191
00:06:44,720 --> 00:06:48,110
<font color="#CCCCCC">absolutely brilliant when it comes to</font>

192
00:06:46,670 --> 00:06:50,300
web<font color="#E5E5E5"> at pen testing and he wrote this</font>

193
00:06:48,110 --> 00:06:53,000
cool extension and gave it away<font color="#E5E5E5"> thank</font>

194
00:06:50,300 --> 00:06:56,230
<font color="#E5E5E5">you James kettle where it'll look for a</font>

195
00:06:53,000 --> 00:06:59,630
bunch of funky side things including

196
00:06:56,230 --> 00:07:03,050
<font color="#CCCCCC">5638 that is the that again the</font><font color="#E5E5E5"> Equifax</font>

197
00:06:59,630 --> 00:07:06,260
<font color="#CCCCCC">struts bug</font><font color="#E5E5E5"> it does require</font><font color="#CCCCCC"> Bert</font><font color="#E5E5E5"> Pro I'm</font>

198
00:07:03,050 --> 00:07:08,720
sorry<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> 3:50 a year</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> joy on is it</font>

199
00:07:06,260 --> 00:07:11,930
is a<font color="#E5E5E5"> Java Python interpreter that lets</font>

200
00:07:08,720 --> 00:07:15,170
you<font color="#E5E5E5"> use Python code in in verb and also</font>

201
00:07:11,930 --> 00:07:16,430
<font color="#E5E5E5">Bert collaborator welcome back to</font>

202
00:07:15,170 --> 00:07:17,720
<font color="#E5E5E5">burping a letter collaborator in just a</font>

203
00:07:16,430 --> 00:07:19,280
second<font color="#CCCCCC"> so here's an example of what</font>

204
00:07:17,720 --> 00:07:21,620
happens so<font color="#CCCCCC"> you're you're on a page</font>

205
00:07:19,280 --> 00:07:23,780
you're<font color="#CCCCCC"> you you've</font><font color="#E5E5E5"> spidered all your urls</font>

206
00:07:21,620 --> 00:07:26,570
<font color="#E5E5E5">you're been told it to active scan</font>

207
00:07:23,780 --> 00:07:28,849
whatever pages<font color="#CCCCCC"> you've found so active</font>

208
00:07:26,570 --> 00:07:30,620
scan<font color="#E5E5E5"> plus plus would already go ahead</font>

209
00:07:28,850 --> 00:07:32,720
<font color="#CCCCCC">and give some funky commands so here in</font>

210
00:07:30,620 --> 00:07:36,350
red box you see<font color="#CCCCCC"> a content type and then</font>

211
00:07:32,720 --> 00:07:38,270
like weird code stuff as web<font color="#E5E5E5"> app pen</font>

212
00:07:36,350 --> 00:07:40,040
testers typically we think<font color="#E5E5E5"> of injecting</font>

213
00:07:38,270 --> 00:07:44,000
funky values<font color="#CCCCCC"> in</font><font color="#E5E5E5"> in what kind</font><font color="#CCCCCC"> of areas of</font>

214
00:07:40,040 --> 00:07:49,340
<font color="#CCCCCC">a request form</font><font color="#E5E5E5"> feels</font><font color="#CCCCCC"> absolutely</font><font color="#E5E5E5"> where</font>

215
00:07:44,000 --> 00:07:51,470
else and<font color="#E5E5E5"> cookie yeah absolutely values</font>

216
00:07:49,340 --> 00:07:53,510
<font color="#CCCCCC">may be in the URL</font><font color="#E5E5E5"> may be in the host</font>

217
00:07:51,470 --> 00:07:54,830
<font color="#E5E5E5">header field right with with</font><font color="#CCCCCC"> some of</font>

218
00:07:53,510 --> 00:07:56,539
these<font color="#E5E5E5"> Java struts you kind of things</font>

219
00:07:54,830 --> 00:07:58,310
it'll be in like content type or<font color="#CCCCCC"> it'll</font>

220
00:07:56,540 --> 00:08:00,560
be in the name<font color="#CCCCCC"> of the cookie or maybe</font>

221
00:07:58,310 --> 00:08:02,420
even in<font color="#E5E5E5"> the name</font><font color="#CCCCCC"> of a header it'll show</font>

222
00:08:00,560 --> 00:08:04,550
up in<font color="#E5E5E5"> weird places where people</font><font color="#CCCCCC"> haven't</font>

223
00:08:02,420 --> 00:08:06,560
<font color="#CCCCCC">thought to sanitize input so kind of</font>

224
00:08:04,550 --> 00:08:09,410
<font color="#E5E5E5">cool</font><font color="#CCCCCC"> so what this one does is</font><font color="#E5E5E5"> it throws</font>

225
00:08:06,560 --> 00:08:10,910
in a please add a header called<font color="#CCCCCC"> X AK and</font>

226
00:08:09,410 --> 00:08:12,320
here's some math<font color="#E5E5E5"> and then when it comes</font>

227
00:08:10,910 --> 00:08:14,450
<font color="#E5E5E5">back</font><font color="#CCCCCC"> from the server with a response</font>

228
00:08:12,320 --> 00:08:15,800
with a new header called X AK and the

229
00:08:14,450 --> 00:08:18,020
math completed for you you know<font color="#E5E5E5"> that</font>

230
00:08:15,800 --> 00:08:20,780
it's vulnerable<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 56:38 so cool</font><font color="#E5E5E5"> that's</font>

231
00:08:18,020 --> 00:08:22,010
a cool easy check all<font color="#E5E5E5"> right switching</font>

232
00:08:20,780 --> 00:08:24,020
<font color="#E5E5E5">gears which is second Bert collaborator</font>

233
00:08:22,010 --> 00:08:25,310
so normally when<font color="#E5E5E5"> you're testing the</font>

234
00:08:24,020 --> 00:08:27,310
packets<font color="#E5E5E5"> are</font><font color="#CCCCCC"> going back and</font><font color="#E5E5E5"> forth between</font>

235
00:08:25,310 --> 00:08:30,140
<font color="#E5E5E5">you and the server and</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> awesome</font>

236
00:08:27,310 --> 00:08:32,179
<font color="#E5E5E5">your</font><font color="#CCCCCC"> your client server</font><font color="#E5E5E5"> as does client I</font>

237
00:08:30,140 --> 00:08:33,620
should push<font color="#CCCCCC"> it the class over anyway now</font>

238
00:08:32,179 --> 00:08:34,729
<font color="#E5E5E5">sometimes it's useful to have a third</font>

239
00:08:33,620 --> 00:08:37,100
party<font color="#CCCCCC"> in</font><font color="#E5E5E5"> here and that's where</font><font color="#CCCCCC"> Brooke</font>

240
00:08:34,730 --> 00:08:38,600
collaborator<font color="#E5E5E5"> pops in this is a this</font><font color="#CCCCCC"> is a</font>

241
00:08:37,100 --> 00:08:39,979
service<font color="#E5E5E5"> it's available to anybody using</font>

242
00:08:38,600 --> 00:08:41,479
<font color="#E5E5E5">Burke Pro you can also set up</font><font color="#CCCCCC"> your own</font>

243
00:08:39,979 --> 00:08:44,720
collaborator server for no additional

244
00:08:41,479 --> 00:08:45,230
<font color="#E5E5E5">cost</font><font color="#CCCCCC"> so that when you send something to</font>

245
00:08:44,720 --> 00:08:46,340
the<font color="#E5E5E5"> client</font>

246
00:08:45,230 --> 00:08:47,870
is<font color="#E5E5E5"> going to cause an external</font>

247
00:08:46,340 --> 00:08:49,550
interaction<font color="#E5E5E5"> it'll go up</font><font color="#CCCCCC"> to the</font>

248
00:08:47,870 --> 00:08:54,320
collaborator<font color="#E5E5E5"> whether that's pulling an</font>

249
00:08:49,550 --> 00:08:56,180
HTTP request<font color="#E5E5E5"> SMTP smtps or DNS this will</font>

250
00:08:54,320 --> 00:08:57,920
serve as a DNS server as a<font color="#CCCCCC"> webserver all</font>

251
00:08:56,180 --> 00:08:59,630
those things<font color="#E5E5E5"> just to receive those</font>

252
00:08:57,920 --> 00:09:02,180
<font color="#E5E5E5">interactions so that then you</font><font color="#CCCCCC"> can pull</font>

253
00:08:59,630 --> 00:09:03,920
the<font color="#CCCCCC"> verb collaborator automatically in</font>

254
00:09:02,180 --> 00:09:05,589
the<font color="#CCCCCC"> background and</font><font color="#E5E5E5"> find out what what</font>

255
00:09:03,920 --> 00:09:07,790
you've caused that<font color="#CCCCCC"> webserver</font><font color="#E5E5E5"> to do</font>

256
00:09:05,590 --> 00:09:10,820
useful<font color="#E5E5E5"> for things like blind command</font>

257
00:09:07,790 --> 00:09:12,079
injection<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so so active scan</font>

258
00:09:10,820 --> 00:09:13,880
plus plus it does all these things<font color="#CCCCCC"> I</font>

259
00:09:12,080 --> 00:09:16,940
wanted<font color="#E5E5E5"> to do more but I don't want a</font>

260
00:09:13,880 --> 00:09:19,400
code in Java<font color="#E5E5E5"> I'm sorry it's their</font><font color="#CCCCCC"> Java</font>

261
00:09:16,940 --> 00:09:21,980
coders in<font color="#E5E5E5"> the room god bless you</font><font color="#CCCCCC"> thank</font>

262
00:09:19,400 --> 00:09:23,030
you<font color="#CCCCCC"> I don't want to</font><font color="#E5E5E5"> but I can use Python</font>

263
00:09:21,980 --> 00:09:24,500
<font color="#E5E5E5">right cuz there's this there's this</font>

264
00:09:23,030 --> 00:09:26,390
GenCon thing and that's that's<font color="#E5E5E5"> great I'm</font>

265
00:09:24,500 --> 00:09:28,100
much more<font color="#CCCCCC"> comfortable</font><font color="#E5E5E5"> with Python not</font>

266
00:09:26,390 --> 00:09:31,699
like Java are comfortable but but a

267
00:09:28,100 --> 00:09:33,320
little<font color="#CCCCCC"> bit comfortable also</font><font color="#E5E5E5"> alright and</font>

268
00:09:31,700 --> 00:09:34,970
this<font color="#E5E5E5"> is a co-worker saying just</font><font color="#CCCCCC"> an</font>

269
00:09:33,320 --> 00:09:36,440
<font color="#E5E5E5">extension of my to</font><font color="#CCCCCC"> type I don't know the</font>

270
00:09:34,970 --> 00:09:38,420
first<font color="#E5E5E5"> thing about building a</font><font color="#CCCCCC"> burp</font>

271
00:09:36,440 --> 00:09:40,280
extension<font color="#CCCCCC"> this is in my first year as a</font>

272
00:09:38,420 --> 00:09:41,540
<font color="#CCCCCC">professional pen tester like I have no</font>

273
00:09:40,280 --> 00:09:43,250
<font color="#E5E5E5">idea but they're already things out</font>

274
00:09:41,540 --> 00:09:44,930
there that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> similar like</font><font color="#E5E5E5"> active scan</font>

275
00:09:43,250 --> 00:09:47,540
plus plus<font color="#CCCCCC"> that where you can</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> pilfer</font>

276
00:09:44,930 --> 00:09:49,699
code because everybody<font color="#E5E5E5"> pilfers</font><font color="#CCCCCC"> code</font>

277
00:09:47,540 --> 00:09:51,740
<font color="#E5E5E5">right we all</font><font color="#CCCCCC"> google and take other</font>

278
00:09:49,700 --> 00:09:54,770
<font color="#E5E5E5">chunks of code some of us are honest</font>

279
00:09:51,740 --> 00:09:55,970
<font color="#CCCCCC">about everybody okay and then and then</font>

280
00:09:54,770 --> 00:09:58,310
<font color="#E5E5E5">it comes you know how do I make it go</font>

281
00:09:55,970 --> 00:10:00,260
<font color="#CCCCCC">well there are a these cool existing</font>

282
00:09:58,310 --> 00:10:01,189
Python<font color="#E5E5E5"> scripts so at this point at this</font>

283
00:10:00,260 --> 00:10:03,439
<font color="#CCCCCC">point</font><font color="#E5E5E5"> you get everything you need right</font>

284
00:10:01,190 --> 00:10:06,530
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> use a language I'm comfortable</font>

285
00:10:03,440 --> 00:10:09,320
with<font color="#CCCCCC"> there's also JRuby if you want to</font>

286
00:10:06,530 --> 00:10:11,360
code and remove<font color="#CCCCCC"> your burp I guess there</font>

287
00:10:09,320 --> 00:10:13,220
are similar tensions that can pilfer and

288
00:10:11,360 --> 00:10:14,780
<font color="#E5E5E5">their scripts I can use to</font><font color="#CCCCCC"> ripoff</font><font color="#E5E5E5"> so at</font>

289
00:10:13,220 --> 00:10:16,490
that point<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just a matter of coding it</font>

290
00:10:14,780 --> 00:10:18,920
so that's what I<font color="#CCCCCC"> did I stole Chris</font>

291
00:10:16,490 --> 00:10:21,230
Davis's code<font color="#E5E5E5"> thank you Chris Davis and I</font>

292
00:10:18,920 --> 00:10:22,849
just put<font color="#E5E5E5"> these big</font><font color="#CCCCCC"> ogl blobs that again</font>

293
00:10:21,230 --> 00:10:24,950
not essentially understand every piece

294
00:10:22,850 --> 00:10:26,410
<font color="#CCCCCC">of it but</font><font color="#E5E5E5"> you're putting it</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

295
00:10:24,950 --> 00:10:30,430
extension<font color="#CCCCCC"> into the code that's</font><font color="#E5E5E5"> already</font>

296
00:10:26,410 --> 00:10:32,900
not<font color="#E5E5E5"> started there thank you James kettle</font>

297
00:10:30,430 --> 00:10:34,760
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right no this is this</font><font color="#CCCCCC"> is about</font>

298
00:10:32,900 --> 00:10:36,260
command injection<font color="#E5E5E5"> and in a lot of cases</font>

299
00:10:34,760 --> 00:10:38,000
blind command injection you may get

300
00:10:36,260 --> 00:10:39,050
reflection<font color="#E5E5E5"> and that's great but if you</font>

301
00:10:38,000 --> 00:10:40,340
<font color="#E5E5E5">don't you want something where you're</font>

302
00:10:39,050 --> 00:10:42,439
going to be able<font color="#E5E5E5"> to detect detect that</font>

303
00:10:40,340 --> 00:10:43,700
because if your client<font color="#E5E5E5"> if it's if it's</font>

304
00:10:42,440 --> 00:10:45,410
<font color="#CCCCCC">buried somehow you want to make sure</font>

305
00:10:43,700 --> 00:10:47,060
<font color="#E5E5E5">that you're you're detecting whether or</font>

306
00:10:45,410 --> 00:10:48,650
not something's happening right<font color="#E5E5E5"> so I</font>

307
00:10:47,060 --> 00:10:50,689
wanted to<font color="#E5E5E5"> work in a blind context which</font>

308
00:10:48,650 --> 00:10:52,250
means<font color="#CCCCCC"> Durer</font><font color="#E5E5E5"> LS</font><font color="#CCCCCC"> Who am I echo they're</font>

309
00:10:50,690 --> 00:10:54,380
<font color="#CCCCCC">they're just out I wanted</font><font color="#E5E5E5"> to be</font>

310
00:10:52,250 --> 00:10:56,960
cross-platform<font color="#CCCCCC"> and</font><font color="#E5E5E5"> yes I know there's</font><font color="#CCCCCC"> W</font>

311
00:10:54,380 --> 00:10:58,130
get in<font color="#E5E5E5"> PowerShell and that's great but</font>

312
00:10:56,960 --> 00:10:58,670
<font color="#E5E5E5">you're probably not operating in a</font>

313
00:10:58,130 --> 00:11:00,860
<font color="#CCCCCC">PowerShell</font>

314
00:10:58,670 --> 00:11:03,290
<font color="#CCCCCC">texts</font><font color="#E5E5E5"> I wanted to be widely available</font>

315
00:11:00,860 --> 00:11:04,970
and this lookup<font color="#E5E5E5"> is great but if you're</font>

316
00:11:03,290 --> 00:11:07,640
in like a<font color="#CCCCCC"> a bear docker instance that</font>

317
00:11:04,970 --> 00:11:09,110
just has Apache in it Thank You<font color="#E5E5E5"> Daniel</font>

318
00:11:07,640 --> 00:11:10,730
<font color="#CCCCCC">pendolino you may or may not have</font>

319
00:11:09,110 --> 00:11:12,110
nslookup there right that's that's<font color="#E5E5E5"> an</font>

320
00:11:10,730 --> 00:11:14,480
additional package<font color="#E5E5E5"> that's not</font>

321
00:11:12,110 --> 00:11:15,740
necessarily there<font color="#E5E5E5"> I do like it though</font>

322
00:11:14,480 --> 00:11:17,660
<font color="#CCCCCC">because Windows is gonna use it in</font><font color="#E5E5E5"> most</font>

323
00:11:15,740 --> 00:11:20,210
<font color="#E5E5E5">Linux most likes distros will use it</font><font color="#CCCCCC"> I</font>

324
00:11:17,660 --> 00:11:22,219
also<font color="#E5E5E5"> want to go over firewalls so</font><font color="#CCCCCC"> clunky</font>

325
00:11:20,210 --> 00:11:23,450
<font color="#E5E5E5">ports are kind of out</font><font color="#CCCCCC"> I also don't want</font>

326
00:11:22,220 --> 00:11:27,020
<font color="#CCCCCC">it to</font><font color="#E5E5E5"> run forever because again this is</font>

327
00:11:23,450 --> 00:11:28,370
<font color="#E5E5E5">in a</font><font color="#CCCCCC"> client-server and if I'm testing a</font>

328
00:11:27,020 --> 00:11:30,860
bunch I don't want to leave<font color="#E5E5E5"> you know a</font>

329
00:11:28,370 --> 00:11:31,880
thousand running ping processes so what

330
00:11:30,860 --> 00:11:33,260
I<font color="#E5E5E5"> ended up with</font><font color="#CCCCCC"> and this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> going to</font>

331
00:11:31,880 --> 00:11:36,370
look<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little strange</font><font color="#CCCCCC"> to probably</font>

332
00:11:33,260 --> 00:11:40,430
everybody<font color="#CCCCCC"> is this is this command on</font>

333
00:11:36,370 --> 00:11:42,050
<font color="#CCCCCC">Linux</font><font color="#E5E5E5"> well what will this do it'll pain</font>

334
00:11:40,430 --> 00:11:43,910
once<font color="#E5E5E5"> even though it's out of order</font><font color="#CCCCCC"> it</font>

335
00:11:42,050 --> 00:11:47,479
will in every environment<font color="#CCCCCC"> I tested it</font>

336
00:11:43,910 --> 00:11:51,230
will ping once but before it can ping

337
00:11:47,480 --> 00:11:52,760
what does it need to<font color="#E5E5E5"> do it needs to look</font>

338
00:11:51,230 --> 00:11:54,470
<font color="#E5E5E5">up the host right so even</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> nslookup is</font>

339
00:11:52,760 --> 00:12:01,880
in there it's going to<font color="#E5E5E5"> resolve that name</font>

340
00:11:54,470 --> 00:12:05,540
on<font color="#E5E5E5"> Windows you</font><font color="#CCCCCC"> know what</font><font color="#E5E5E5"> this will do it</font>

341
00:12:01,880 --> 00:12:07,189
will<font color="#CCCCCC"> not launch calc</font><font color="#E5E5E5"> I wish it did it'll</font>

342
00:12:05,540 --> 00:12:09,110
it'll actually<font color="#E5E5E5"> fail when it gets to the</font>

343
00:12:07,190 --> 00:12:12,980
-<font color="#CCCCCC"> c1 because in Windows this</font><font color="#E5E5E5"> is what n1</font>

344
00:12:09,110 --> 00:12:14,810
<font color="#E5E5E5">and but before</font><font color="#CCCCCC"> it fails it will</font><font color="#E5E5E5"> resolve</font>

345
00:12:12,980 --> 00:12:16,490
<font color="#E5E5E5">that name so this is a cheap cross</font>

346
00:12:14,810 --> 00:12:17,719
cross-platform way to get the name

347
00:12:16,490 --> 00:12:19,250
<font color="#CCCCCC">resolution and maybe it will ping out</font>

348
00:12:17,720 --> 00:12:20,810
that's great I<font color="#E5E5E5"> don't care what I'm</font>

349
00:12:19,250 --> 00:12:22,580
<font color="#E5E5E5">looking for in verb collaborator is did</font>

350
00:12:20,810 --> 00:12:24,619
<font color="#E5E5E5">that name resolve so that's what I'm</font>

351
00:12:22,580 --> 00:12:27,650
<font color="#E5E5E5">using in this extension for to check for</font>

352
00:12:24,620 --> 00:12:29,360
<font color="#E5E5E5">command execution</font><font color="#CCCCCC"> so then it comes</font><font color="#E5E5E5"> as a</font>

353
00:12:27,650 --> 00:12:32,420
matter of hey I got<font color="#CCCCCC"> it it's up it's</font>

354
00:12:29,360 --> 00:12:35,000
<font color="#E5E5E5">working</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then you know new pen tester</font>

355
00:12:32,420 --> 00:12:36,349
anxiety how am I gonna go<font color="#E5E5E5"> to James</font>

356
00:12:35,000 --> 00:12:39,500
<font color="#CCCCCC">Kendall and be like hey I</font><font color="#E5E5E5"> made your</font>

357
00:12:36,350 --> 00:12:41,420
thing better right<font color="#CCCCCC"> I'm just some some</font>

358
00:12:39,500 --> 00:12:44,180
<font color="#E5E5E5">new guy and then I don't know who who's</font>

359
00:12:41,420 --> 00:12:45,860
ever fish is but with an avatar like

360
00:12:44,180 --> 00:12:49,160
that it can<font color="#E5E5E5"> be a little intimidating</font>

361
00:12:45,860 --> 00:12:52,760
<font color="#CCCCCC">right I've never seen such a sharply</font>

362
00:12:49,160 --> 00:12:54,829
<font color="#E5E5E5">dressed</font><font color="#CCCCCC"> stormtrooper so you kind of have</font>

363
00:12:52,760 --> 00:12:56,390
to<font color="#E5E5E5"> get over right and that's what I did</font>

364
00:12:54,830 --> 00:12:57,920
<font color="#E5E5E5">and this is paraphrase it a little bit</font>

365
00:12:56,390 --> 00:12:59,990
but basically<font color="#E5E5E5"> you know I go to github</font>

366
00:12:57,920 --> 00:13:02,120
and<font color="#CCCCCC"> make my</font><font color="#E5E5E5"> changes and hey I'd like you</font>

367
00:12:59,990 --> 00:13:03,790
to merge<font color="#E5E5E5"> this into the main thing and</font><font color="#CCCCCC"> I</font>

368
00:13:02,120 --> 00:13:06,380
made<font color="#E5E5E5"> it and then James Kettle replies</font>

369
00:13:03,790 --> 00:13:08,030
this is the real James<font color="#CCCCCC"> Kelly's he's</font>

370
00:13:06,380 --> 00:13:09,200
talking back to me<font color="#E5E5E5"> he says oh yeah but</font>

371
00:13:08,030 --> 00:13:10,670
he does something<font color="#E5E5E5"> kind of funky here did</font>

372
00:13:09,200 --> 00:13:11,900
you really mean<font color="#CCCCCC"> to oh right yeah no</font>

373
00:13:10,670 --> 00:13:13,729
that's that's<font color="#E5E5E5"> not quite right</font>

374
00:13:11,900 --> 00:13:16,610
just based on we can do that<font color="#CCCCCC"> later</font><font color="#E5E5E5"> about</font>

375
00:13:13,730 --> 00:13:17,990
what was<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of off</font><font color="#E5E5E5"> about it but</font><font color="#CCCCCC"> fixed</font>

376
00:13:16,610 --> 00:13:19,040
<font color="#E5E5E5">it</font><font color="#CCCCCC"> and went back to him and he bumped</font>

377
00:13:17,990 --> 00:13:20,840
the version<font color="#E5E5E5"> and made a couple style</font>

378
00:13:19,040 --> 00:13:22,699
changes and now<font color="#E5E5E5"> it's in the product so</font>

379
00:13:20,840 --> 00:13:24,950
if you've been<font color="#CCCCCC"> using active scan plus</font>

380
00:13:22,700 --> 00:13:27,620
plus since like May or so you've got

381
00:13:24,950 --> 00:13:34,490
these these changes there thank you

382
00:13:27,620 --> 00:13:36,260
thank you my mom loves me too so look at

383
00:13:34,490 --> 00:13:37,800
me now number<font color="#E5E5E5"> two contributor for this</font>

384
00:13:36,260 --> 00:13:40,850
<font color="#E5E5E5">plugin</font><font color="#CCCCCC"> thank you very much</font>

385
00:13:37,800 --> 00:13:40,849
[Music]

386
00:13:40,900 --> 00:13:44,240
and then<font color="#E5E5E5"> homestar runner wants</font><font color="#CCCCCC"> to know</font>

387
00:13:43,010 --> 00:13:45,819
so<font color="#E5E5E5"> what all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> you made this thing</font>

388
00:13:44,240 --> 00:13:47,780
what is<font color="#CCCCCC"> it actually</font><font color="#E5E5E5"> gotten um</font>

389
00:13:45,820 --> 00:13:51,350
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> they actually actually</font><font color="#E5E5E5"> found</font>

390
00:13:47,780 --> 00:13:53,990
a<font color="#CCCCCC"> zero-day in Jam Pro it's it's a like</font>

391
00:13:51,350 --> 00:13:56,570
an iOS device management<font color="#E5E5E5"> thing for</font>

392
00:13:53,990 --> 00:13:58,520
enterprises where it wasn't<font color="#E5E5E5"> the struts</font>

393
00:13:56,570 --> 00:14:00,490
piece of it<font color="#E5E5E5"> but it was but with</font>

394
00:13:58,520 --> 00:14:02,960
developing<font color="#E5E5E5"> those struts little checks</font>

395
00:14:00,490 --> 00:14:04,040
doing an<font color="#CCCCCC"> xxe check was actually kind of</font>

396
00:14:02,960 --> 00:14:06,200
trivial because<font color="#CCCCCC"> I had all the pieces</font><font color="#E5E5E5"> I</font>

397
00:14:04,040 --> 00:14:08,599
need especially<font color="#E5E5E5"> the the collaborator</font>

398
00:14:06,200 --> 00:14:10,910
interaction so I found on a on a client

399
00:14:08,600 --> 00:14:12,890
system that if I just just define the

400
00:14:10,910 --> 00:14:15,890
the<font color="#E5E5E5"> DTD that it would actually resolve</font>

401
00:14:12,890 --> 00:14:17,510
the name and then here it and it'll<font color="#E5E5E5"> put</font>

402
00:14:15,890 --> 00:14:19,520
make the HTTP<font color="#CCCCCC"> request as well so here's</font>

403
00:14:17,510 --> 00:14:20,810
my server listening for on a<font color="#CCCCCC"> specific</font>

404
00:14:19,520 --> 00:14:23,120
<font color="#E5E5E5">board getting that</font><font color="#CCCCCC"> callback so that was</font>

405
00:14:20,810 --> 00:14:26,540
cool<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is basically an</font><font color="#CCCCCC"> SSR app</font><font color="#E5E5E5"> so</font>

406
00:14:23,120 --> 00:14:27,950
<font color="#CCCCCC">neat another use of</font><font color="#E5E5E5"> it I thought was</font>

407
00:14:26,540 --> 00:14:31,310
kind of cool<font color="#E5E5E5"> is if I give it an internal</font>

408
00:14:27,950 --> 00:14:32,900
IP address and<font color="#CCCCCC"> port</font><font color="#E5E5E5"> and it's valid it'll</font>

409
00:14:31,310 --> 00:14:35,060
come back<font color="#E5E5E5"> in less than a second if it's</font>

410
00:14:32,900 --> 00:14:37,370
not valid<font color="#E5E5E5"> the watch means it took some</font>

411
00:14:35,060 --> 00:14:38,540
time<font color="#CCCCCC"> took</font><font color="#E5E5E5"> about a second then I know</font>

412
00:14:37,370 --> 00:14:39,890
<font color="#E5E5E5">that</font><font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> bad word so I can use this</font>

413
00:14:38,540 --> 00:14:41,750
to port scan inside<font color="#E5E5E5"> their environment</font>

414
00:14:39,890 --> 00:14:42,920
<font color="#E5E5E5">that's kind of cool too I was a little</font>

415
00:14:41,750 --> 00:14:44,480
disappointed<font color="#CCCCCC"> when</font><font color="#E5E5E5"> I went to report it to</font>

416
00:14:42,920 --> 00:14:47,030
<font color="#E5E5E5">him because</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> took a</font><font color="#CCCCCC"> while to</font><font color="#E5E5E5"> kind of</font>

417
00:14:44,480 --> 00:14:48,140
like communicate well so that everybody

418
00:14:47,030 --> 00:14:49,850
understood what I was talking<font color="#CCCCCC"> about and</font>

419
00:14:48,140 --> 00:14:51,290
then<font color="#E5E5E5"> once like once they got you know it</font>

420
00:14:49,850 --> 00:14:54,520
fully what I was explaining they said oh

421
00:14:51,290 --> 00:14:57,230
we're<font color="#E5E5E5"> already working</font><font color="#CCCCCC"> on that</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> okay</font>

422
00:14:54,520 --> 00:14:58,939
<font color="#CCCCCC">so to answer</font><font color="#E5E5E5"> your first question what</font>

423
00:14:57,230 --> 00:15:01,040
<font color="#CCCCCC">about the the new new struts right the</font>

424
00:14:58,940 --> 00:15:03,650
one that just<font color="#CCCCCC"> came out this summer one</font>

425
00:15:01,040 --> 00:15:05,180
one seven seven<font color="#E5E5E5"> six that one we actually</font>

426
00:15:03,650 --> 00:15:08,140
<font color="#E5E5E5">got</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> actually we</font><font color="#CCCCCC"> his though you know</font>

427
00:15:05,180 --> 00:15:10,670
James<font color="#E5E5E5"> kettle and I hang out</font>

428
00:15:08,140 --> 00:15:13,670
<font color="#CCCCCC">that's oh we got a request</font><font color="#E5E5E5"> from</font>

429
00:15:10,670 --> 00:15:15,199
<font color="#E5E5E5">decidedly gray asking for that and I</font>

430
00:15:13,670 --> 00:15:16,280
looked into it<font color="#E5E5E5"> and it wasn't much</font>

431
00:15:15,200 --> 00:15:18,350
<font color="#CCCCCC">different from the other</font><font color="#E5E5E5"> vulnerabilities</font>

432
00:15:16,280 --> 00:15:21,199
<font color="#CCCCCC">the only catch with this</font><font color="#E5E5E5"> one is it's</font>

433
00:15:18,350 --> 00:15:23,780
specifically for malformed redirects<font color="#CCCCCC"> so</font>

434
00:15:21,200 --> 00:15:27,380
if you are when you're<font color="#E5E5E5"> actively scanning</font>

435
00:15:23,780 --> 00:15:29,510
your your target<font color="#E5E5E5"> if you're not actively</font>

436
00:15:27,380 --> 00:15:31,310
scanning the 302s the redirects<font color="#E5E5E5"> you're</font>

437
00:15:29,510 --> 00:15:32,810
going to miss<font color="#E5E5E5"> this specific</font><font color="#CCCCCC"> struts</font>

438
00:15:31,310 --> 00:15:35,180
vulnerability because it's in it's in

439
00:15:32,810 --> 00:15:38,390
badly<font color="#E5E5E5"> handled redirects so</font><font color="#CCCCCC"> so be aware</font>

440
00:15:35,180 --> 00:15:40,430
of<font color="#E5E5E5"> that but</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is now in as well that</font>

441
00:15:38,390 --> 00:15:41,780
<font color="#E5E5E5">took</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> a couple of weeks</font><font color="#CCCCCC"> from from</font>

442
00:15:40,430 --> 00:15:43,969
the release of the<font color="#CCCCCC"> vols that was that</font>

443
00:15:41,780 --> 00:15:45,860
was<font color="#E5E5E5"> fun</font>

444
00:15:43,970 --> 00:15:47,750
<font color="#CCCCCC">I speak quickly so there's there's time</font>

445
00:15:45,860 --> 00:15:49,430
for<font color="#CCCCCC"> questions I believe</font><font color="#E5E5E5"> what questions</font>

446
00:15:47,750 --> 00:15:57,320
that people have<font color="#CCCCCC"> about coding giving</font>

447
00:15:49,430 --> 00:15:59,329
things away and<font color="#CCCCCC"> in</font><font color="#E5E5E5"> struts yeah yeah yes</font>

448
00:15:57,320 --> 00:16:00,800
so so it worked<font color="#E5E5E5"> the question was what</font>

449
00:15:59,330 --> 00:16:02,120
was<font color="#E5E5E5"> the thing that that</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> he wanted</font>

450
00:16:00,800 --> 00:16:05,000
<font color="#E5E5E5">me to change in it and it was actually</font>

451
00:16:02,120 --> 00:16:07,340
<font color="#E5E5E5">in and kind of how I used the the API</font>

452
00:16:05,000 --> 00:16:09,470
<font color="#E5E5E5">because some things are</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> easy and</font>

453
00:16:07,340 --> 00:16:10,610
automatic in in burp and<font color="#E5E5E5"> in the way in</font>

454
00:16:09,470 --> 00:16:13,570
the way it<font color="#E5E5E5"> handles that the different</font>

455
00:16:10,610 --> 00:16:15,560
methods and objects<font color="#CCCCCC"> some things aren't I</font>

456
00:16:13,570 --> 00:16:19,130
didn't realize that<font color="#E5E5E5"> there was an easy</font>

457
00:16:15,560 --> 00:16:21,260
way<font color="#CCCCCC"> to have to have my my</font><font color="#E5E5E5"> test insertion</font>

458
00:16:19,130 --> 00:16:22,670
happen with every insertion point so I

459
00:16:21,260 --> 00:16:24,980
was having<font color="#CCCCCC"> it happen</font><font color="#E5E5E5"> with each</font><font color="#CCCCCC"> request</font>

460
00:16:22,670 --> 00:16:28,280
so it would<font color="#E5E5E5"> actually go to and this was</font>

461
00:16:24,980 --> 00:16:30,320
the 2017 holiday hack<font color="#CCCCCC"> addition of struts</font>

462
00:16:28,280 --> 00:16:31,610
vulnerability<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> having it like cycle</font>

463
00:16:30,320 --> 00:16:33,320
through the<font color="#E5E5E5"> head alert headers manually</font>

464
00:16:31,610 --> 00:16:34,790
to inject the payload and<font color="#CCCCCC"> the different</font>

465
00:16:33,320 --> 00:16:35,600
headers when there's actually<font color="#E5E5E5"> already a</font>

466
00:16:34,790 --> 00:16:36,770
different function<font color="#CCCCCC"> and do that</font>

467
00:16:35,600 --> 00:16:38,900
automatically<font color="#E5E5E5"> so it's just</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> matter of</font>

468
00:16:36,770 --> 00:16:40,220
<font color="#E5E5E5">simplifying that by the way if you look</font>

469
00:16:38,900 --> 00:16:41,750
<font color="#E5E5E5">at the code there's there's no easy way</font>

470
00:16:40,220 --> 00:16:44,210
when you're coding<font color="#E5E5E5"> an extension to</font>

471
00:16:41,750 --> 00:16:46,010
switch and get<font color="#CCCCCC"> requests to a post</font><font color="#E5E5E5"> so if</font>

472
00:16:44,210 --> 00:16:47,750
you're scanning a get request<font color="#E5E5E5"> and you</font>

473
00:16:46,010 --> 00:16:51,439
want it maybe switch it to a post so you

474
00:16:47,750 --> 00:16:53,450
<font color="#E5E5E5">can post</font><font color="#CCCCCC"> a neck sexy</font><font color="#E5E5E5"> trial</font><font color="#CCCCCC"> into the into</font>

475
00:16:51,440 --> 00:16:55,490
the web web application<font color="#E5E5E5"> there's there's</font>

476
00:16:53,450 --> 00:16:56,510
no<font color="#CCCCCC"> functions just swap it</font><font color="#E5E5E5"> over so it so</font>

477
00:16:55,490 --> 00:16:58,310
in the code you'll actually see me

478
00:16:56,510 --> 00:16:59,660
looking<font color="#CCCCCC"> for a capital G like for a get</font>

479
00:16:58,310 --> 00:17:02,270
and then deleting<font color="#E5E5E5"> three characters and</font>

480
00:16:59,660 --> 00:17:03,560
then inserting POS T and<font color="#CCCCCC"> burp thankfully</font>

481
00:17:02,270 --> 00:17:05,780
takes care of<font color="#E5E5E5"> like content length but</font>

482
00:17:03,560 --> 00:17:09,669
yes it was it was just just really<font color="#E5E5E5"> that</font>

483
00:17:05,780 --> 00:17:09,670
made it a lot<font color="#CCCCCC"> slicker mr fire</font>

484
00:17:13,660 --> 00:17:18,040
you know the one I was<font color="#E5E5E5"> working with was</font>

485
00:17:16,240 --> 00:17:24,040
Python<font color="#CCCCCC"> 2 to 7 I don't know</font><font color="#E5E5E5"> does anybody</font>

486
00:17:18,040 --> 00:17:31,620
know if there's a Python<font color="#CCCCCC"> 3 JSON great</font>

487
00:17:24,040 --> 00:17:31,620
question<font color="#CCCCCC"> yeah</font>

488
00:17:32,760 --> 00:17:36,570
I'm sorry if you see that one more<font color="#CCCCCC"> Sam</font>

489
00:17:37,170 --> 00:17:41,860
yeah what resources are useful for

490
00:17:39,310 --> 00:17:43,270
<font color="#CCCCCC">building a</font><font color="#E5E5E5"> plug-in</font><font color="#CCCCCC"> Furber so</font><font color="#E5E5E5"> I wish I'd</font>

491
00:17:41,860 --> 00:17:44,199
noticed<font color="#CCCCCC"> actually the Derby con talk from</font>

492
00:17:43,270 --> 00:17:46,270
<font color="#E5E5E5">last</font><font color="#CCCCCC"> year</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> would have been</font><font color="#E5E5E5"> helpful</font>

493
00:17:44,200 --> 00:17:47,860
to look<font color="#E5E5E5"> at but there's there's a</font><font color="#CCCCCC"> decent</font>

494
00:17:46,270 --> 00:17:49,090
<font color="#CCCCCC">amount of</font><font color="#E5E5E5"> documentation up from</font><font color="#CCCCCC"> ports</font>

495
00:17:47,860 --> 00:17:51,340
<font color="#CCCCCC">wigger about about all the different</font>

496
00:17:49,090 --> 00:17:53,230
<font color="#CCCCCC">methods and objects</font><font color="#E5E5E5"> so that was helpful</font>

497
00:17:51,340 --> 00:17:55,270
<font color="#E5E5E5">and also</font><font color="#CCCCCC"> just just looking at other</font>

498
00:17:53,230 --> 00:17:56,680
<font color="#CCCCCC">people's code</font><font color="#E5E5E5"> looking at the the</font>

499
00:17:55,270 --> 00:17:58,480
existing active scan<font color="#E5E5E5"> applause applause</font>

500
00:17:56,680 --> 00:18:00,550
<font color="#E5E5E5">and</font><font color="#CCCCCC"> some of the just weirdo</font><font color="#E5E5E5"> things that</font>

501
00:17:58,480 --> 00:18:01,950
looks for for me was<font color="#E5E5E5"> really helpful</font><font color="#CCCCCC"> so</font>

502
00:18:00,550 --> 00:18:04,870
if you're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> to code your</font><font color="#CCCCCC"> own</font>

503
00:18:01,950 --> 00:18:06,310
someone someone may have<font color="#E5E5E5"> already done it</font>

504
00:18:04,870 --> 00:18:07,419
<font color="#E5E5E5">or what you're</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to do but I would</font>

505
00:18:06,310 --> 00:18:09,129
almost guarantee someone has<font color="#E5E5E5"> done</font>

506
00:18:07,420 --> 00:18:11,730
<font color="#E5E5E5">something similar so just look around</font>

507
00:18:09,130 --> 00:18:18,070
and see what<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see what</font><font color="#E5E5E5"> you steal</font>

508
00:18:11,730 --> 00:18:20,290
other questions yeah does it run

509
00:18:18,070 --> 00:18:21,760
passively as well as actively<font color="#E5E5E5"> it does</font>

510
00:18:20,290 --> 00:18:23,440
<font color="#E5E5E5">not know these texts are specifically</font>

511
00:18:21,760 --> 00:18:29,950
active checks yeah looking for remote

512
00:18:23,440 --> 00:18:32,080
code execution<font color="#CCCCCC"> thank you fails well</font>

513
00:18:29,950 --> 00:18:41,320
thanks so much<font color="#E5E5E5"> for coming appreciate you</font>

514
00:18:32,080 --> 00:18:41,320
[Applause]

