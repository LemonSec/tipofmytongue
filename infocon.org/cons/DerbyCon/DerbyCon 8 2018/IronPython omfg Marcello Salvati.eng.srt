1
00:00:00,000 --> 00:00:21,660
<font color="#E5E5E5">pick up some direct but right we're</font>

2
00:00:03,210 --> 00:00:24,420
<font color="#CCCCCC">rolling</font><font color="#E5E5E5"> you're ready okay so as you're</font>

3
00:00:21,660 --> 00:00:26,550
probably aware from<font color="#E5E5E5"> the talk title we're</font>

4
00:00:24,420 --> 00:00:28,769
<font color="#E5E5E5">gonna be covering my approach</font><font color="#CCCCCC"> into</font>

5
00:00:26,550 --> 00:00:30,900
solving<font color="#E5E5E5"> the trig problem there in secret</font>

6
00:00:28,769 --> 00:00:32,460
<font color="#E5E5E5">that problem of dynamically accessing</font>

7
00:00:30,900 --> 00:00:33,750
<font color="#CCCCCC">content</font><font color="#E5E5E5"> because that gives</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> all the</font>

8
00:00:32,460 --> 00:00:35,610
goodies right<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the post exploitation</font>

9
00:00:33,750 --> 00:00:37,079
on<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> that that's what we want and</font>

10
00:00:35,610 --> 00:00:40,559
<font color="#E5E5E5">that's why at the end of the day that's</font>

11
00:00:37,079 --> 00:00:42,329
why<font color="#E5E5E5"> PowerShell was</font><font color="#CCCCCC"> such a is still such</font>

12
00:00:40,559 --> 00:00:44,339
a big deal in terms<font color="#CCCCCC"> of</font><font color="#E5E5E5"> offensive</font>

13
00:00:42,329 --> 00:00:49,950
tradecraft<font color="#E5E5E5"> is because it allows</font><font color="#CCCCCC"> us to</font>

14
00:00:44,340 --> 00:00:55,320
access<font color="#CCCCCC"> that we all like is red teamers</font>

15
00:00:49,950 --> 00:00:58,710
<font color="#E5E5E5">in</font><font color="#CCCCCC"> pairs right so warning also</font><font color="#E5E5E5"> have to</font>

16
00:00:55,320 --> 00:01:01,109
try not<font color="#CCCCCC"> to</font><font color="#E5E5E5"> move</font><font color="#CCCCCC"> around a</font><font color="#E5E5E5"> lot but there's</font>

17
00:00:58,710 --> 00:01:03,870
some c-sharp and<font color="#CCCCCC"> Python code ed but</font><font color="#E5E5E5"> I</font>

18
00:01:01,109 --> 00:01:05,280
will<font color="#E5E5E5"> try</font><font color="#CCCCCC"> my best</font><font color="#E5E5E5"> to explain everything</font>

19
00:01:03,870 --> 00:01:07,649
as<font color="#CCCCCC"> much as I can</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> obviously</font>

20
00:01:05,280 --> 00:01:10,770
I'm gonna assume that<font color="#E5E5E5"> somebody</font><font color="#CCCCCC"> does not</font>

21
00:01:07,650 --> 00:01:11,909
see sharp so I'll try I'll do my<font color="#E5E5E5"> best to</font>

22
00:01:10,770 --> 00:01:13,649
try<font color="#CCCCCC"> to explain it</font>

23
00:01:11,909 --> 00:01:15,810
we're gonna start<font color="#E5E5E5"> with just</font><font color="#CCCCCC"> the general</font>

24
00:01:13,650 --> 00:01:17,850
motivation of white and trying to do

25
00:01:15,810 --> 00:01:22,549
this<font color="#E5E5E5"> we're gonna go down the</font><font color="#CCCCCC"> rabbit hole</font>

26
00:01:17,850 --> 00:01:25,649
<font color="#CCCCCC">of just how and all of the tears sweat</font>

27
00:01:22,549 --> 00:01:27,570
drinks that I had to have to even get

28
00:01:25,650 --> 00:01:29,579
<font color="#E5E5E5">this working and we're</font><font color="#CCCCCC"> gonna talk about</font>

29
00:01:27,570 --> 00:01:32,250
<font color="#E5E5E5">how one I</font><font color="#CCCCCC"> think we're gonna end to a</font>

30
00:01:29,579 --> 00:01:36,240
live demo<font color="#CCCCCC"> so I pray to the devil guns</font>

31
00:01:32,250 --> 00:01:39,060
and conclusion and<font color="#CCCCCC"> takeaways from</font><font color="#E5E5E5"> all</font>

32
00:01:36,240 --> 00:01:41,759
this stuff<font color="#CCCCCC"> just get</font><font color="#E5E5E5"> right into it</font>

33
00:01:39,060 --> 00:01:43,920
this<font color="#E5E5E5"> is my -</font><font color="#CCCCCC"> Porcello I</font><font color="#E5E5E5"> don't let my</font>

34
00:01:41,759 --> 00:01:47,040
<font color="#CCCCCC">tweet on Twitter I work for</font><font color="#E5E5E5"> Black Hills</font>

35
00:01:43,920 --> 00:01:48,659
they're kind enough to sponsor me and do

36
00:01:47,040 --> 00:01:50,189
all this great<font color="#E5E5E5"> stuff send me out to</font>

37
00:01:48,659 --> 00:01:52,439
<font color="#E5E5E5">these conferences that selects my</font><font color="#CCCCCC"> github</font>

38
00:01:50,189 --> 00:01:57,329
<font color="#CCCCCC">if you want to come talk after or before</font>

39
00:01:52,439 --> 00:01:59,899
<font color="#E5E5E5">or after</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can't go back in</font><font color="#CCCCCC"> time after</font>

40
00:01:57,329 --> 00:02:02,210
<font color="#E5E5E5">the</font><font color="#CCCCCC"> this dog I'm at the Black Hills move</font>

41
00:01:59,900 --> 00:02:06,320
come around<font color="#E5E5E5"> and pop them in there and</font>

42
00:02:02,210 --> 00:02:09,019
all for that so let's start with why

43
00:02:06,320 --> 00:02:13,340
even try to do this<font color="#CCCCCC"> right</font>

44
00:02:09,020 --> 00:02:14,810
well how<font color="#E5E5E5"> our show it's sort of that it's</font>

45
00:02:13,340 --> 00:02:16,430
not<font color="#E5E5E5"> really good like in terms of at</font>

46
00:02:14,810 --> 00:02:19,040
least offensive tradecraft<font color="#E5E5E5"> right it's</font>

47
00:02:16,430 --> 00:02:20,450
it's<font color="#CCCCCC"> sort of like</font><font color="#E5E5E5"> a zombie</font><font color="#CCCCCC"> it's not</font>

48
00:02:19,040 --> 00:02:21,799
completely dead because there's still

49
00:02:20,450 --> 00:02:23,420
environments<font color="#E5E5E5"> that you know you can just</font>

50
00:02:21,800 --> 00:02:27,080
run PowerShell<font color="#E5E5E5"> BT that you get to go and</font>

51
00:02:23,420 --> 00:02:28,760
some environments<font color="#E5E5E5"> that just don't have</font>

52
00:02:27,080 --> 00:02:31,070
the<font color="#CCCCCC"> latest version of</font><font color="#E5E5E5"> PowerShell stall</font>

53
00:02:28,760 --> 00:02:33,019
which has all the<font color="#CCCCCC"> defenses so it's it's</font>

54
00:02:31,070 --> 00:02:36,769
it's<font color="#E5E5E5"> and intermix but at least at Black</font>

55
00:02:33,020 --> 00:02:38,900
Hills we have most<font color="#E5E5E5"> of our clients do</font>

56
00:02:36,770 --> 00:02:40,310
have only run Windows<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> most the time</font>

57
00:02:38,900 --> 00:02:43,580
and so they have the latest<font color="#E5E5E5"> and greatest</font>

58
00:02:40,310 --> 00:02:46,100
<font color="#E5E5E5">stuff in terms of EDR solutions and so</font>

59
00:02:43,580 --> 00:02:49,010
we sort of have to<font color="#E5E5E5"> improvise a lot of</font>

60
00:02:46,100 --> 00:02:50,540
fun right<font color="#E5E5E5"> so and I</font><font color="#CCCCCC"> like I said like</font>

61
00:02:49,010 --> 00:02:52,700
usually<font color="#E5E5E5"> the card clients have witness</font>

62
00:02:50,540 --> 00:02:55,040
said PowerShell version for greater and

63
00:02:52,700 --> 00:02:56,420
<font color="#CCCCCC">they have which has a and a thigh they</font>

64
00:02:55,040 --> 00:02:57,950
have a constraint language<font color="#E5E5E5"> mode they</font>

65
00:02:56,420 --> 00:02:59,750
most the time they have<font color="#CCCCCC"> Molyneux strip</font>

66
00:02:57,950 --> 00:03:03,859
off logging learned transcription

67
00:02:59,750 --> 00:03:07,790
logging whatever so how do we<font color="#E5E5E5"> get around</font>

68
00:03:03,860 --> 00:03:09,860
<font color="#E5E5E5">this well up until now we really you can</font>

69
00:03:07,790 --> 00:03:11,450
obfuscate<font color="#E5E5E5"> right</font><font color="#CCCCCC"> with using something</font>

70
00:03:09,860 --> 00:03:13,400
like<font color="#E5E5E5"> a mocha obfuscation which is</font>

71
00:03:11,450 --> 00:03:15,738
awesome<font color="#CCCCCC"> you can use some</font><font color="#E5E5E5"> of the game</font>

72
00:03:13,400 --> 00:03:17,209
<font color="#E5E5E5">inside logging bypasses right but the</font>

73
00:03:15,739 --> 00:03:19,670
<font color="#E5E5E5">problem with that is you have</font><font color="#CCCCCC"> to</font>

74
00:03:17,209 --> 00:03:22,010
obviously the bypasses<font color="#E5E5E5"> because he</font>

75
00:03:19,670 --> 00:03:24,859
bypasses themselves a signature<font color="#CCCCCC"> so</font>

76
00:03:22,010 --> 00:03:28,549
that's that's just<font color="#E5E5E5"> another thing</font><font color="#CCCCCC"> of the</font>

77
00:03:24,860 --> 00:03:30,920
but really<font color="#CCCCCC"> poor use PowerShell</font><font color="#E5E5E5"> v2 which</font>

78
00:03:28,550 --> 00:03:32,120
sometimes I actually<font color="#E5E5E5"> I'm I was surprised</font>

79
00:03:30,920 --> 00:03:34,250
to<font color="#E5E5E5"> see like how many environments</font>

80
00:03:32,120 --> 00:03:38,300
actually have PowerShell<font color="#CCCCCC"> b2 in Windows</font>

81
00:03:34,250 --> 00:03:43,489
10 is really<font color="#CCCCCC"> very or just</font><font color="#E5E5E5"> directly go to</font>

82
00:03:38,300 --> 00:03:46,130
<font color="#CCCCCC">c-sharp and this has been sort</font><font color="#E5E5E5"> of me go</font>

83
00:03:43,489 --> 00:03:48,590
to way of getting around<font color="#E5E5E5"> this and we've</font>

84
00:03:46,130 --> 00:03:50,420
seen like<font color="#E5E5E5"> in the past year or</font><font color="#CCCCCC"> so like</font>

85
00:03:48,590 --> 00:03:52,250
the great tooling migration<font color="#E5E5E5"> does he shop</font>

86
00:03:50,420 --> 00:03:54,320
<font color="#E5E5E5">right and so everything was PowerShell</font>

87
00:03:52,250 --> 00:03:56,950
now it's it's<font color="#E5E5E5"> just everything as you see</font>

88
00:03:54,320 --> 00:03:58,359
sharp<font color="#E5E5E5"> and it's got</font>

89
00:03:56,950 --> 00:04:00,489
there's there's some definitely some

90
00:03:58,360 --> 00:04:02,050
pros and cons to this<font color="#E5E5E5"> but the pros is by</font>

91
00:04:00,490 --> 00:04:03,760
far the<font color="#CCCCCC"> most direct the solution in</font>

92
00:04:02,050 --> 00:04:05,380
terms<font color="#CCCCCC"> of tradecraft right because if</font>

93
00:04:03,760 --> 00:04:08,799
you're familiar with PowerShell<font color="#CCCCCC"> you'll</font>

94
00:04:05,380 --> 00:04:10,959
find<font color="#E5E5E5"> yourself</font><font color="#CCCCCC"> a helmet c-sharp the.net</font>

95
00:04:08,800 --> 00:04:12,069
framework is tightly<font color="#CCCCCC"> integrated</font><font color="#E5E5E5"> within</font>

96
00:04:10,959 --> 00:04:13,480
<font color="#CCCCCC">Windows like I said before like</font><font color="#E5E5E5"> the</font>

97
00:04:12,069 --> 00:04:14,140
<font color="#CCCCCC">reason why we like c-sharp some lunges</font>

98
00:04:13,480 --> 00:04:15,819
<font color="#CCCCCC">yeah</font>

99
00:04:14,140 --> 00:04:17,048
<font color="#CCCCCC">how shall I see chef so much is</font><font color="#E5E5E5"> it</font>

100
00:04:15,819 --> 00:04:18,339
because you<font color="#E5E5E5"> can go as low as you</font><font color="#CCCCCC"> want</font>

101
00:04:17,048 --> 00:04:19,510
you go as high as you<font color="#CCCCCC"> want like it</font>

102
00:04:18,339 --> 00:04:21,760
really<font color="#E5E5E5"> really gives you with lots of</font>

103
00:04:19,510 --> 00:04:24,639
flexibility in terms of tradecraft<font color="#E5E5E5"> the</font>

104
00:04:21,760 --> 00:04:27,820
cons is it's a compiled and strongly

105
00:04:24,639 --> 00:04:29,800
<font color="#E5E5E5">typed language meaning that during like</font>

106
00:04:27,820 --> 00:04:31,750
limited engagement<font color="#E5E5E5"> windows you think I'd</font>

107
00:04:29,800 --> 00:04:35,169
really like I<font color="#CCCCCC"> personally don't want</font><font color="#E5E5E5"> to</font>

108
00:04:31,750 --> 00:04:36,550
compile stuff every two seconds<font color="#E5E5E5"> and drop</font>

109
00:04:35,169 --> 00:04:38,229
binaries to this can and<font color="#E5E5E5"> all that stuff</font>

110
00:04:36,550 --> 00:04:40,540
<font color="#E5E5E5">and also got that version was like if</font>

111
00:04:38,229 --> 00:04:42,310
<font color="#E5E5E5">you compile something against version</font>

112
00:04:40,540 --> 00:04:44,979
of.net<font color="#CCCCCC"> it will that it's not gonna be</font>

113
00:04:42,310 --> 00:04:46,360
backwards compatible<font color="#CCCCCC"> so it's just it's</font>

114
00:04:44,979 --> 00:04:47,409
just a lot<font color="#CCCCCC"> of stuff that I</font><font color="#E5E5E5"> agree I</font>

115
00:04:46,360 --> 00:04:49,630
really don't want<font color="#E5E5E5"> to deal</font><font color="#CCCCCC"> with</font>

116
00:04:47,410 --> 00:04:52,600
<font color="#CCCCCC">especially if I'm on eliminating agent</font>

117
00:04:49,630 --> 00:04:56,710
right<font color="#E5E5E5"> and also I'm sort of a Python</font>

118
00:04:52,600 --> 00:05:01,240
fanatic and it's not what<font color="#CCCCCC"> PowerShell and</font>

119
00:04:56,710 --> 00:05:03,159
<font color="#CCCCCC">I really like a</font><font color="#E5E5E5"> lot I have</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> problem but</font>

120
00:05:01,240 --> 00:05:05,800
so the whole reasoning<font color="#E5E5E5"> behind this</font><font color="#CCCCCC"> is I</font>

121
00:05:03,160 --> 00:05:07,780
<font color="#E5E5E5">really just want</font><font color="#CCCCCC"> something that can just</font>

122
00:05:05,800 --> 00:05:11,680
work natively<font color="#CCCCCC"> and</font><font color="#E5E5E5"> is a scripting</font>

123
00:05:07,780 --> 00:05:13,000
language<font color="#CCCCCC"> right and the question that I</font>

124
00:05:11,680 --> 00:05:15,220
<font color="#E5E5E5">guess the following question</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that is</font>

125
00:05:13,000 --> 00:05:16,690
<font color="#E5E5E5">can</font><font color="#CCCCCC"> I execute powers of them</font><font color="#E5E5E5"> this was</font>

126
00:05:15,220 --> 00:05:19,630
the<font color="#CCCCCC"> original police</font><font color="#E5E5E5"> the original</font>

127
00:05:16,690 --> 00:05:21,430
question<font color="#E5E5E5"> was can I execute powerful code</font>

128
00:05:19,630 --> 00:05:22,690
without worrying about<font color="#E5E5E5"> am easy defenses</font>

129
00:05:21,430 --> 00:05:25,000
<font color="#E5E5E5">I just want something that works</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> just</font>

130
00:05:22,690 --> 00:05:26,740
want to run some powerful code<font color="#E5E5E5"> maybe on</font>

131
00:05:25,000 --> 00:05:27,580
the system on the<font color="#E5E5E5"> endpoint without</font>

132
00:05:26,740 --> 00:05:30,039
worrying about any

133
00:05:27,580 --> 00:05:32,020
<font color="#E5E5E5">obfuscation none of this stuff I just</font>

134
00:05:30,039 --> 00:05:37,060
<font color="#CCCCCC">want something told her</font><font color="#E5E5E5"> so</font>

135
00:05:32,020 --> 00:05:38,560
how I<font color="#E5E5E5"> thought man so the first thing I</font>

136
00:05:37,060 --> 00:05:40,810
was committed at this point<font color="#E5E5E5"> I'm gonna</font>

137
00:05:38,560 --> 00:05:42,100
find I was so frustrated<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was just I</font>

138
00:05:40,810 --> 00:05:44,289
<font color="#CCCCCC">just want something that</font><font color="#E5E5E5"> works right so</font>

139
00:05:42,100 --> 00:05:47,020
<font color="#E5E5E5">first thing I</font><font color="#CCCCCC"> did</font><font color="#E5E5E5"> sit down by my bed</font>

140
00:05:44,289 --> 00:05:48,039
<font color="#E5E5E5">PowerShell Python and this turned out</font><font color="#CCCCCC"> to</font>

141
00:05:47,020 --> 00:05:48,448
be the best<font color="#CCCCCC"> people</font><font color="#E5E5E5"> will search</font><font color="#CCCCCC"> with my</font>

142
00:05:48,039 --> 00:05:52,719
life

143
00:05:48,449 --> 00:05:54,550
so the second Google<font color="#E5E5E5"> page result which</font>

144
00:05:52,719 --> 00:05:56,379
if you're on the second<font color="#CCCCCC"> page pool of his</font>

145
00:05:54,550 --> 00:05:59,289
own page here already<font color="#E5E5E5"> scraping the</font>

146
00:05:56,379 --> 00:06:02,710
bottom of<font color="#E5E5E5"> the barrel there</font><font color="#CCCCCC"> the second</font>

147
00:05:59,289 --> 00:06:05,169
page result was a<font color="#E5E5E5"> Python script called</font>

148
00:06:02,710 --> 00:06:11,830
powerslam but this guy called woman

149
00:06:05,169 --> 00:06:14,378
<font color="#E5E5E5">called bounce sketch right and I was</font>

150
00:06:11,830 --> 00:06:17,020
looking at<font color="#CCCCCC"> it and and</font><font color="#E5E5E5"> try it and install</font>

151
00:06:14,379 --> 00:06:19,180
it<font color="#CCCCCC"> was</font><font color="#E5E5E5"> iron my bond but I know up until</font>

152
00:06:17,020 --> 00:06:21,008
<font color="#E5E5E5">this</font><font color="#CCCCCC"> point I had</font><font color="#E5E5E5"> never had</font><font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> even</font>

153
00:06:19,180 --> 00:06:22,719
know what I found<font color="#CCCCCC"> them was so I just</font>

154
00:06:21,009 --> 00:06:24,550
downloaded on<font color="#CCCCCC"> my phone and I run it and</font>

155
00:06:22,719 --> 00:06:27,369
it works<font color="#CCCCCC"> and I have a really</font><font color="#E5E5E5"> bad habit</font>

156
00:06:24,550 --> 00:06:31,089
of<font color="#E5E5E5"> getting really excited about stuff</font>

157
00:06:27,369 --> 00:06:33,399
without just taking a step back<font color="#E5E5E5"> calming</font>

158
00:06:31,089 --> 00:06:34,899
myself down<font color="#E5E5E5"> and actually looking</font><font color="#CCCCCC"> the</font>

159
00:06:33,399 --> 00:06:35,949
more objectively of what I'm seeing<font color="#CCCCCC"> so I</font>

160
00:06:34,899 --> 00:06:37,749
immediately<font color="#E5E5E5"> tweeted bizarre you have a</font>

161
00:06:35,949 --> 00:06:39,639
<font color="#CCCCCC">title problem</font><font color="#E5E5E5"> and like</font><font color="#CCCCCC"> hey you know this</font>

162
00:06:37,749 --> 00:06:42,369
is<font color="#E5E5E5"> cool</font>

163
00:06:39,639 --> 00:06:46,869
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> unmanaged from space the</font>

164
00:06:42,369 --> 00:06:48,639
Python right and then I'm like okay

165
00:06:46,869 --> 00:06:51,550
<font color="#E5E5E5">let's</font><font color="#CCCCCC"> fix that</font><font color="#E5E5E5"> back here and actually</font>

166
00:06:48,639 --> 00:06:53,499
look<font color="#CCCCCC"> at what we're seeing here because I</font>

167
00:06:51,550 --> 00:06:55,629
<font color="#E5E5E5">don't know how any of this actually work</font>

168
00:06:53,499 --> 00:06:59,259
<font color="#E5E5E5">so</font><font color="#CCCCCC"> take a look at the first four</font><font color="#E5E5E5"> lines</font>

169
00:06:55,629 --> 00:07:00,490
and I see import CLR<font color="#E5E5E5"> CLR add references</font>

170
00:06:59,259 --> 00:07:02,919
<font color="#CCCCCC">now that management system management</font>

171
00:07:00,490 --> 00:07:04,629
<font color="#CCCCCC">automation I'm like okay I wait I pulled</font>

172
00:07:02,919 --> 00:07:07,539
up I've seen these<font color="#E5E5E5"> before</font><font color="#CCCCCC"> where have I</font>

173
00:07:04,629 --> 00:07:09,819
seen this<font color="#CCCCCC"> oh yeah I've seen this and</font>

174
00:07:07,539 --> 00:07:11,139
stuff like<font color="#CCCCCC"> NPS right so look not</font>

175
00:07:09,819 --> 00:07:13,149
<font color="#E5E5E5">PowerShell like this is just</font><font color="#CCCCCC"> a way of</font>

176
00:07:11,139 --> 00:07:15,339
<font color="#E5E5E5">creating like running powers you're not</font>

177
00:07:13,149 --> 00:07:15,550
on a management<font color="#E5E5E5"> space</font><font color="#CCCCCC"> so that's kind of</font>

178
00:07:15,339 --> 00:07:19,149
cool

179
00:07:15,550 --> 00:07:21,519
so that obviously means<font color="#E5E5E5"> that like</font>

180
00:07:19,149 --> 00:07:23,289
<font color="#E5E5E5">something stuff like in</font><font color="#CCCCCC"> Gaza</font><font color="#E5E5E5"> really any</font>

181
00:07:21,519 --> 00:07:26,349
<font color="#E5E5E5">other tool that</font><font color="#CCCCCC"> creates a manager on</font>

182
00:07:23,289 --> 00:07:28,180
space is the same like it's doing<font color="#CCCCCC"> the</font>

183
00:07:26,349 --> 00:07:33,099
same<font color="#CCCCCC"> thing in this difficulty marcelin</font>

184
00:07:28,180 --> 00:07:38,439
right<font color="#E5E5E5"> so that's really cool so</font><font color="#CCCCCC"> you're</font>

185
00:07:33,099 --> 00:07:40,569
<font color="#E5E5E5">telling me that I can just call net from</font>

186
00:07:38,439 --> 00:07:41,439
Python<font color="#CCCCCC"> so I can have the power of</font>

187
00:07:40,569 --> 00:07:43,269
PowerShell

188
00:07:41,439 --> 00:07:45,009
without going through PowerShell because

189
00:07:43,269 --> 00:07:48,639
we're able to<font color="#E5E5E5"> just that Amazon called</font>

190
00:07:45,009 --> 00:07:49,340
dotnet api's right in<font color="#E5E5E5"> Python like that I</font>

191
00:07:48,639 --> 00:07:52,250
feel

192
00:07:49,340 --> 00:07:53,330
just died and<font color="#E5E5E5"> gone to heaven right okay</font>

193
00:07:52,250 --> 00:08:00,620
<font color="#CCCCCC">I've no clue</font>

194
00:07:53,330 --> 00:08:02,570
let's tell about it so<font color="#E5E5E5"> Python so I</font>

195
00:08:00,620 --> 00:08:05,330
started and this<font color="#CCCCCC"> is this</font><font color="#E5E5E5"> is this is how</font>

196
00:08:02,570 --> 00:08:07,639
this all<font color="#CCCCCC"> started I I went</font><font color="#E5E5E5"> down the</font>

197
00:08:05,330 --> 00:08:09,919
rabbit hole<font color="#CCCCCC"> and so let's go down this</font>

198
00:08:07,639 --> 00:08:11,510
rabbit hole<font color="#E5E5E5"> together</font><font color="#CCCCCC"> so the first</font>

199
00:08:09,919 --> 00:08:12,740
technical<font color="#E5E5E5"> challenges I had coming into</font>

200
00:08:11,510 --> 00:08:14,419
this I had no knowledge of C sharp

201
00:08:12,740 --> 00:08:16,460
<font color="#E5E5E5">whatsoever like I knew some of</font><font color="#CCCCCC"> the</font>

202
00:08:14,419 --> 00:08:18,099
basics but<font color="#CCCCCC"> its first challenge for</font>

203
00:08:16,460 --> 00:08:20,090
<font color="#E5E5E5">obvious is gonna be I'm gonna be sure</font>

204
00:08:18,100 --> 00:08:23,240
<font color="#E5E5E5">second challenge is how do I set up a</font>

205
00:08:20,090 --> 00:08:26,690
development<font color="#CCCCCC"> environment to</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> higher</font>

206
00:08:23,240 --> 00:08:28,070
<font color="#E5E5E5">Python third is how can I get</font><font color="#CCCCCC"> ironpython</font>

207
00:08:26,690 --> 00:08:30,280
<font color="#E5E5E5">scripts to run natively and</font><font color="#CCCCCC"> win them</font>

208
00:08:28,070 --> 00:08:33,260
<font color="#E5E5E5">because obviously I don't want like</font><font color="#CCCCCC"> the</font>

209
00:08:30,280 --> 00:08:34,939
social engineer<font color="#E5E5E5"> the user into installing</font>

210
00:08:33,260 --> 00:08:38,029
on Python<font color="#CCCCCC"> so I can run my stuff</font><font color="#E5E5E5"> without</font>

211
00:08:34,940 --> 00:08:39,710
being kind of<font color="#CCCCCC"> weird and</font><font color="#E5E5E5"> possibly the end</font>

212
00:08:38,029 --> 00:08:42,500
<font color="#E5E5E5">to that point</font><font color="#CCCCCC"> like can I possibly</font>

213
00:08:39,710 --> 00:08:45,980
compile on Python scripts to do that

214
00:08:42,500 --> 00:08:47,750
<font color="#E5E5E5">right so</font><font color="#CCCCCC"> the goal really is native</font>

215
00:08:45,980 --> 00:08:49,370
execution of<font color="#E5E5E5"> our Python scripts on</font>

216
00:08:47,750 --> 00:08:51,200
<font color="#CCCCCC">Windows so which would</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> amazing</font>

217
00:08:49,370 --> 00:08:53,029
<font color="#E5E5E5">because that</font><font color="#CCCCCC"> would be</font><font color="#E5E5E5"> like a script</font><font color="#CCCCCC"> that</font>

218
00:08:51,200 --> 00:08:54,680
interface<font color="#E5E5E5"> that</font><font color="#CCCCCC"> which would allow us</font>

219
00:08:53,029 --> 00:08:56,839
<font color="#E5E5E5">especially native language what</font><font color="#CCCCCC"> allow us</font>

220
00:08:54,680 --> 00:09:01,870
<font color="#E5E5E5">to just dynamically call these dotnet</font>

221
00:08:56,839 --> 00:09:04,459
functions or<font color="#CCCCCC"> any guys on Windows so I</font>

222
00:09:01,870 --> 00:09:06,740
immediately because just this is was

223
00:09:04,459 --> 00:09:08,719
naive but<font color="#CCCCCC"> I try to find</font><font color="#E5E5E5"> some of my thumb</font>

224
00:09:06,740 --> 00:09:11,209
<font color="#CCCCCC">T&C and walk</font><font color="#E5E5E5"> wall does not work</font>

225
00:09:08,720 --> 00:09:13,070
obviously<font color="#CCCCCC"> this is because so high and</font>

226
00:09:11,209 --> 00:09:15,219
<font color="#CCCCCC">seller and</font><font color="#E5E5E5"> Python</font><font color="#CCCCCC"> high THC</font><font color="#E5E5E5"> these</font>

227
00:09:13,070 --> 00:09:18,560
frameworks which are meant to compile

228
00:09:15,220 --> 00:09:21,260
<font color="#E5E5E5">Python scripts to executables are meant</font>

229
00:09:18,560 --> 00:09:22,670
to be run on C Python<font color="#E5E5E5"> which is the C</font>

230
00:09:21,260 --> 00:09:25,640
<font color="#E5E5E5">version of</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> supposed to ironclad</font>

231
00:09:22,670 --> 00:09:27,199
level just<font color="#E5E5E5"> based on</font><font color="#CCCCCC"> that right so right</font>

232
00:09:25,640 --> 00:09:28,670
<font color="#CCCCCC">out of the gate this</font><font color="#E5E5E5"> is the easiest way</font>

233
00:09:27,200 --> 00:09:30,920
I can think<font color="#E5E5E5"> of to do it it</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> does</font>

234
00:09:28,670 --> 00:09:33,349
important so I'm like<font color="#E5E5E5"> okay</font>

235
00:09:30,920 --> 00:09:35,089
at this<font color="#E5E5E5"> point</font><font color="#CCCCCC"> I I'm just</font><font color="#E5E5E5"> completely</font><font color="#CCCCCC"> out</font>

236
00:09:33,350 --> 00:09:36,950
of the realm<font color="#E5E5E5"> of anything</font><font color="#CCCCCC"> that I know</font><font color="#E5E5E5"> so</font>

237
00:09:35,089 --> 00:09:39,260
I'm gonna actually<font color="#CCCCCC"> my book on her by</font>

238
00:09:36,950 --> 00:09:41,470
<font color="#E5E5E5">though so I go</font><font color="#CCCCCC"> on Amazon and I order</font>

239
00:09:39,260 --> 00:09:44,120
<font color="#CCCCCC">like 20</font><font color="#E5E5E5"> books which was very impulsive</font>

240
00:09:41,470 --> 00:09:45,680
<font color="#E5E5E5">excited about</font><font color="#CCCCCC"> the stuff</font><font color="#E5E5E5"> is fast but</font>

241
00:09:44,120 --> 00:09:47,390
<font color="#E5E5E5">really</font><font color="#CCCCCC"> the only book that</font><font color="#E5E5E5"> I really</font>

242
00:09:45,680 --> 00:09:49,089
needed was<font color="#E5E5E5"> this and this is by far the</font>

243
00:09:47,390 --> 00:09:50,680
<font color="#E5E5E5">most practical book on the subject</font>

244
00:09:49,089 --> 00:09:51,970
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> in action I think if I recall</font>

245
00:09:50,680 --> 00:09:55,359
correctly it<font color="#E5E5E5"> was actually written by the</font>

246
00:09:51,970 --> 00:09:57,579
creators of ironpython<font color="#CCCCCC"> and it's in terms</font>

247
00:09:55,360 --> 00:10:02,019
of like practicality of<font color="#E5E5E5"> the language</font>

248
00:09:57,579 --> 00:10:03,189
like this<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> book</font><font color="#E5E5E5"> and setting up a</font>

249
00:10:02,019 --> 00:10:04,660
development<font color="#CCCCCC"> environment was actually</font>

250
00:10:03,189 --> 00:10:05,110
quite straightforward<font color="#E5E5E5"> all you really</font>

251
00:10:04,660 --> 00:10:08,980
need is

252
00:10:05,110 --> 00:10:11,410
ironpython<font color="#CCCCCC"> add it</font><font color="#E5E5E5"> to your path</font><font color="#CCCCCC"> there's</font>

253
00:10:08,980 --> 00:10:14,170
actually so<font color="#E5E5E5"> current version of our</font>

254
00:10:11,410 --> 00:10:15,999
Python that's staple is<font color="#E5E5E5"> Python - so it's</font>

255
00:10:14,170 --> 00:10:18,849
based on<font color="#E5E5E5"> Python - they're working on</font>

256
00:10:15,999 --> 00:10:20,860
Python<font color="#CCCCCC"> 3 but it's in the works but</font>

257
00:10:18,850 --> 00:10:23,399
<font color="#E5E5E5">definitely use the one</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> website</font>

258
00:10:20,860 --> 00:10:26,379
<font color="#E5E5E5">right now because the</font><font color="#CCCCCC"> Python 3 means</font>

259
00:10:23,399 --> 00:10:29,470
it's<font color="#E5E5E5"> very much so all you</font><font color="#CCCCCC"> really need is</font>

260
00:10:26,379 --> 00:10:33,819
visual studio visual code and the

261
00:10:29,470 --> 00:10:37,420
<font color="#E5E5E5">installer for my</font><font color="#CCCCCC"> apartment so I read the</font>

262
00:10:33,819 --> 00:10:40,569
<font color="#CCCCCC">book in</font><font color="#E5E5E5"> one night and I it left me more</font>

263
00:10:37,420 --> 00:10:43,479
confused<font color="#CCCCCC"> than I was in then I was before</font>

264
00:10:40,569 --> 00:10:45,849
because again<font color="#E5E5E5"> know nothing about c-sharp</font>

265
00:10:43,480 --> 00:10:49,029
<font color="#CCCCCC">I still don't think I know that much</font>

266
00:10:45,850 --> 00:10:51,759
about c-sharp and<font color="#E5E5E5"> but there was this</font><font color="#CCCCCC"> one</font>

267
00:10:49,029 --> 00:10:55,449
part<font color="#E5E5E5"> of the book that</font><font color="#CCCCCC"> really got me</font>

268
00:10:51,759 --> 00:10:56,920
<font color="#CCCCCC">interested</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that was you and they</font>

269
00:10:55,449 --> 00:10:59,290
were<font color="#E5E5E5"> talking about how to embed the</font>

270
00:10:56,920 --> 00:11:03,128
ironpython<font color="#E5E5E5"> engine within</font><font color="#CCCCCC"> a c-sharp</font>

271
00:10:59,290 --> 00:11:04,660
<font color="#CCCCCC">battery which sounded really cool and</font>

272
00:11:03,129 --> 00:11:07,209
the examples that they gave in the book

273
00:11:04,660 --> 00:11:09,459
was almost<font color="#E5E5E5"> exactly what I wanted to what</font>

274
00:11:07,209 --> 00:11:12,219
<font color="#CCCCCC">I wanted to have so it was a native way</font>

275
00:11:09,459 --> 00:11:15,279
of<font color="#E5E5E5"> basically executing hiring Python</font>

276
00:11:12,220 --> 00:11:17,589
scripts through C sharp<font color="#E5E5E5"> which I thought</font>

277
00:11:15,279 --> 00:11:20,589
was pretty pretty<font color="#CCCCCC"> amazing</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is an</font>

278
00:11:17,589 --> 00:11:22,540
excerpt from the<font color="#CCCCCC"> book on the author's</font>

279
00:11:20,589 --> 00:11:24,790
website<font color="#E5E5E5"> void space that word that UK</font>

280
00:11:22,540 --> 00:11:27,670
most of the book<font color="#CCCCCC"> that I just</font><font color="#E5E5E5"> mentioned</font>

281
00:11:24,790 --> 00:11:29,139
by the<font color="#E5E5E5"> way is on his</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> so if you</font>

282
00:11:27,670 --> 00:11:31,599
don't want to buy the book like most of

283
00:11:29,139 --> 00:11:35,110
the most practical<font color="#E5E5E5"> examples are on</font><font color="#CCCCCC"> its</font>

284
00:11:31,600 --> 00:11:36,040
<font color="#E5E5E5">website so the first thing I just wanted</font>

285
00:11:35,110 --> 00:11:37,749
something<font color="#E5E5E5"> I just want</font><font color="#CCCCCC"> to get this</font>

286
00:11:36,040 --> 00:11:40,329
<font color="#CCCCCC">working right at</font><font color="#E5E5E5"> this point I</font><font color="#CCCCCC"> just</font>

287
00:11:37,749 --> 00:11:41,589
wanted something<font color="#CCCCCC"> to work</font><font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

288
00:11:40,329 --> 00:11:44,138
simplest thing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I come a come up</font>

289
00:11:41,589 --> 00:11:47,439
with so import CLR which is basically

290
00:11:44,139 --> 00:11:49,179
the how ironpython<font color="#CCCCCC"> how you can like add</font>

291
00:11:47,439 --> 00:11:52,300
references to assemblies and ironpython

292
00:11:49,179 --> 00:11:53,920
right<font color="#E5E5E5"> it puts the LR 0 add reference</font>

293
00:11:52,300 --> 00:11:55,209
systems from those<font color="#CCCCCC"> forms</font><font color="#E5E5E5"> and this just</font>

294
00:11:53,920 --> 00:11:56,759
pops<font color="#E5E5E5"> a message box</font>

295
00:11:55,209 --> 00:11:59,130
so<font color="#CCCCCC"> you're just</font><font color="#E5E5E5"> popular message box</font>

296
00:11:56,759 --> 00:12:01,770
<font color="#E5E5E5">pretty simple right</font>

297
00:11:59,130 --> 00:12:04,470
so I just want this<font color="#E5E5E5"> to run I just want</font>

298
00:12:01,770 --> 00:12:06,240
to see a<font color="#E5E5E5"> message box</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> apparently all</font>

299
00:12:04,470 --> 00:12:09,450
you<font color="#CCCCCC"> really need</font><font color="#E5E5E5"> to do this is pretty</font>

300
00:12:06,240 --> 00:12:12,810
<font color="#E5E5E5">simple it is reference the ironpython</font>

301
00:12:09,450 --> 00:12:15,260
assemblies which provided by our<font color="#E5E5E5"> Python</font>

302
00:12:12,810 --> 00:12:18,569
<font color="#E5E5E5">DLL arm Python modules that DLL and</font>

303
00:12:15,260 --> 00:12:21,210
<font color="#CCCCCC">Microsoft Dynamics F scripted</font><font color="#E5E5E5"> the last</font>

304
00:12:18,570 --> 00:12:23,520
two are signed by<font color="#E5E5E5"> Microsoft these first</font>

305
00:12:21,210 --> 00:12:24,990
two<font color="#CCCCCC"> are not but how you</font><font color="#E5E5E5"> really need to</font>

306
00:12:23,520 --> 00:12:28,280
do is<font color="#CCCCCC"> reference these</font><font color="#E5E5E5"> four assemblies</font>

307
00:12:24,990 --> 00:12:29,610
and I want to try something fancy<font color="#E5E5E5"> here</font>

308
00:12:28,280 --> 00:12:34,800
<font color="#CCCCCC">this works</font>

309
00:12:29,610 --> 00:12:37,290
<font color="#E5E5E5">hey script</font><font color="#CCCCCC"> engine run time creative</font>

310
00:12:34,800 --> 00:12:38,400
engine which basically just embeds<font color="#E5E5E5"> like</font>

311
00:12:37,290 --> 00:12:40,680
I said before<font color="#E5E5E5"> in Medscape ironpython</font>

312
00:12:38,400 --> 00:12:45,180
<font color="#CCCCCC">engine within a c-sharp</font><font color="#E5E5E5"> minor E and then</font>

313
00:12:40,680 --> 00:12:48,180
<font color="#CCCCCC">engine that</font><font color="#E5E5E5"> executes and my script</font>

314
00:12:45,180 --> 00:12:51,150
variable here is basically just<font color="#E5E5E5"> the</font>

315
00:12:48,180 --> 00:12:53,010
source file for<font color="#E5E5E5"> your iPod on script so</font>

316
00:12:51,150 --> 00:12:57,060
<font color="#E5E5E5">you just give that my script the source</font>

317
00:12:53,010 --> 00:13:02,280
file and it executes<font color="#E5E5E5"> native ironpython</font>

318
00:12:57,060 --> 00:13:05,010
which is amazing so obviously<font color="#E5E5E5"> my first</font>

319
00:13:02,280 --> 00:13:06,000
sort of proof of concept<font color="#E5E5E5"> I'm sorry if</font>

320
00:13:05,010 --> 00:13:10,920
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> small that's just</font><font color="#CCCCCC"> the big world</font>

321
00:13:06,000 --> 00:13:13,140
<font color="#CCCCCC">minor was just to run</font><font color="#E5E5E5"> just a c-sharp</font>

322
00:13:10,920 --> 00:13:14,939
binary you give it as the person or if

323
00:13:13,140 --> 00:13:16,620
you<font color="#CCCCCC"> think you gave</font><font color="#E5E5E5"> it a my</font><font color="#CCCCCC"> presence kid</font>

324
00:13:14,940 --> 00:13:18,810
on this and it would<font color="#E5E5E5"> run it and it</font>

325
00:13:16,620 --> 00:13:20,790
worked<font color="#CCCCCC"> right but</font><font color="#E5E5E5"> obviously in terms of</font>

326
00:13:18,810 --> 00:13:22,949
<font color="#E5E5E5">tradecraft weaponization you wouldn't</font>

327
00:13:20,790 --> 00:13:26,910
want to<font color="#E5E5E5"> drop like another file on this</font>

328
00:13:22,950 --> 00:13:29,100
the source of your payload<font color="#E5E5E5"> right so and</font>

329
00:13:26,910 --> 00:13:30,360
<font color="#E5E5E5">again this was this was pretty new to</font>

330
00:13:29,100 --> 00:13:32,280
meeting is that again I knew nothing<font color="#E5E5E5"> is</font>

331
00:13:30,360 --> 00:13:33,720
<font color="#CCCCCC">he sharp so it turns out is he sure</font><font color="#E5E5E5"> all</font>

332
00:13:32,280 --> 00:13:36,030
you really need<font color="#E5E5E5"> to do is call it</font>

333
00:13:33,720 --> 00:13:40,740
manifest resource stream you give it<font color="#E5E5E5"> the</font>

334
00:13:36,030 --> 00:13:43,410
name<font color="#E5E5E5"> of a file that you</font><font color="#CCCCCC"> can embed it in</font>

335
00:13:40,740 --> 00:13:47,250
the<font color="#CCCCCC"> c-sharp</font><font color="#E5E5E5"> minor in itself and on</font>

336
00:13:43,410 --> 00:13:49,920
<font color="#E5E5E5">runtime inches gets the whatever data</font>

337
00:13:47,250 --> 00:13:51,660
you embedded in the C sharp binary in

338
00:13:49,920 --> 00:13:54,589
<font color="#E5E5E5">Visual Studio it's literally just embed</font>

339
00:13:51,660 --> 00:13:57,060
resource<font color="#CCCCCC"> a new city is very</font><font color="#E5E5E5"> simple and</font>

340
00:13:54,590 --> 00:13:58,500
it will just read the read whatever

341
00:13:57,060 --> 00:14:01,349
resource you get it<font color="#E5E5E5"> and put it in your</font>

342
00:13:58,500 --> 00:14:01,950
variable<font color="#E5E5E5"> so that's great</font><font color="#CCCCCC"> right so now we</font>

343
00:14:01,350 --> 00:14:04,980
<font color="#E5E5E5">even</font>

344
00:14:01,950 --> 00:14:07,430
<font color="#E5E5E5">are the</font><font color="#CCCCCC"> pikey our pilots</font><font color="#E5E5E5"> give</font><font color="#CCCCCC"> WN execute</font>

345
00:14:04,980 --> 00:14:11,520
inside<font color="#E5E5E5"> the</font><font color="#CCCCCC"> seashore binary itself and</font>

346
00:14:07,430 --> 00:14:14,040
when we<font color="#E5E5E5"> run it it pops the message box</font>

347
00:14:11,520 --> 00:14:15,420
<font color="#E5E5E5">and it worked it was great</font><font color="#CCCCCC"> so now we</font>

348
00:14:14,040 --> 00:14:17,550
have the C sharp binary<font color="#E5E5E5"> and that</font>

349
00:14:15,420 --> 00:14:19,829
natively<font color="#CCCCCC"> executes ironpython code which</font>

350
00:14:17,550 --> 00:14:21,599
is awesome<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> what I wanted right</font>

351
00:14:19,830 --> 00:14:25,020
so let's go<font color="#CCCCCC"> back</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> our technical</font>

352
00:14:21,600 --> 00:14:29,370
<font color="#E5E5E5">challenges here learn</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> c-sharp still</font>

353
00:14:25,020 --> 00:14:33,380
<font color="#E5E5E5">work in</font><font color="#CCCCCC"> progress we we finally we got</font>

354
00:14:29,370 --> 00:14:36,180
ironpython<font color="#E5E5E5"> to natively execute scripts</font>

355
00:14:33,380 --> 00:14:40,230
<font color="#E5E5E5">but the problem now</font><font color="#CCCCCC"> is how</font><font color="#E5E5E5"> do we give</font>

356
00:14:36,180 --> 00:14:41,729
access to<font color="#E5E5E5"> B script within that engine to</font>

357
00:14:40,230 --> 00:14:44,880
the Python<font color="#E5E5E5"> standard library</font><font color="#CCCCCC"> right</font>

358
00:14:41,730 --> 00:14:47,250
because obviously we want access<font color="#E5E5E5"> to the</font>

359
00:14:44,880 --> 00:14:50,400
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> standard library so we call all</font>

360
00:14:47,250 --> 00:14:52,770
the like<font color="#E5E5E5"> all those nice little libraries</font>

361
00:14:50,400 --> 00:14:54,480
that<font color="#E5E5E5"> we know</font><font color="#CCCCCC"> eleven Python</font><font color="#E5E5E5"> and also the</font>

362
00:14:52,770 --> 00:14:56,610
second<font color="#E5E5E5"> problem was in</font><font color="#CCCCCC"> each</font><font color="#E5E5E5"> third-party</font>

363
00:14:54,480 --> 00:14:57,810
Gila so the ironpython<font color="#CCCCCC"> view allows</font><font color="#E5E5E5"> in</font>

364
00:14:56,610 --> 00:14:59,940
the<font color="#CCCCCC"> microsoft</font><font color="#E5E5E5"> that identifier so</font>

365
00:14:57,810 --> 00:15:04,260
<font color="#E5E5E5">scripting dll's are not shipped by</font>

366
00:14:59,940 --> 00:15:06,060
default on Windows 10<font color="#CCCCCC"> so that was also</font><font color="#E5E5E5"> a</font>

367
00:15:04,260 --> 00:15:07,580
<font color="#CCCCCC">problem as well</font><font color="#E5E5E5"> and I needed to figure</font>

368
00:15:06,060 --> 00:15:09,900
<font color="#CCCCCC">out how</font><font color="#E5E5E5"> to do that</font>

369
00:15:07,580 --> 00:15:14,310
compiling<font color="#E5E5E5"> our Python scripts</font>

370
00:15:09,900 --> 00:15:19,380
turned out<font color="#CCCCCC"> to be not</font><font color="#E5E5E5"> possible with the</font>

371
00:15:14,310 --> 00:15:20,760
usual tools<font color="#CCCCCC"> I was used to but turns out</font>

372
00:15:19,380 --> 00:15:22,560
<font color="#E5E5E5">that's possible as well and I'll talk</font>

373
00:15:20,760 --> 00:15:29,460
about<font color="#E5E5E5"> that a little bit later if I have</font>

374
00:15:22,560 --> 00:15:31,709
time so I wanted to<font color="#E5E5E5"> basically give</font>

375
00:15:29,460 --> 00:15:33,660
access to<font color="#E5E5E5"> the script that I executed</font>

376
00:15:31,710 --> 00:15:36,600
within the engine to<font color="#CCCCCC"> the Python</font><font color="#E5E5E5"> standard</font>

377
00:15:33,660 --> 00:15:40,709
library<font color="#E5E5E5"> right and I worked on this for a</font>

378
00:15:36,600 --> 00:15:43,580
long<font color="#CCCCCC"> time and to do this</font><font color="#E5E5E5"> I basically</font>

379
00:15:40,710 --> 00:15:47,670
found an<font color="#E5E5E5"> article from what I think was</font>

380
00:15:43,580 --> 00:15:49,500
2012 in<font color="#E5E5E5"> the far reaches of Google that</font>

381
00:15:47,670 --> 00:15:51,540
and got one of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> authors I think of</font>

382
00:15:49,500 --> 00:15:56,040
our Python<font color="#CCCCCC"> actually posted code to say</font>

383
00:15:51,540 --> 00:15:58,020
hey like if you want to give access<font color="#CCCCCC"> to</font>

384
00:15:56,040 --> 00:15:59,550
<font color="#E5E5E5">the standard laptop</font><font color="#CCCCCC"> give access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font>

385
00:15:58,020 --> 00:16:03,000
<font color="#E5E5E5">second library</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the script in</font><font color="#CCCCCC"> the</font>

386
00:15:59,550 --> 00:16:04,650
<font color="#CCCCCC">sea-shore</font><font color="#E5E5E5"> binary you basically just have</font>

387
00:16:03,000 --> 00:16:06,750
<font color="#CCCCCC">to embed the entire standard library in</font>

388
00:16:04,650 --> 00:16:10,020
a zip file in this sharp minor itself

389
00:16:06,750 --> 00:16:12,270
and then call this magic function called

390
00:16:10,020 --> 00:16:13,250
<font color="#E5E5E5">resource meta path reporter and your</font>

391
00:16:12,270 --> 00:16:16,180
good name

392
00:16:13,250 --> 00:16:18,470
of the resource that<font color="#CCCCCC"> you met it</font><font color="#E5E5E5"> and</font>

393
00:16:16,180 --> 00:16:21,290
automatically it<font color="#CCCCCC"> will take that resource</font>

394
00:16:18,470 --> 00:16:24,019
<font color="#E5E5E5">unzip it it expects a zip file load all</font>

395
00:16:21,290 --> 00:16:28,610
multi Python files that are in<font color="#CCCCCC"> that zip</font>

396
00:16:24,019 --> 00:16:31,730
file in memory<font color="#E5E5E5"> and then all you</font><font color="#CCCCCC"> need to</font>

397
00:16:28,610 --> 00:16:35,300
do with that is append it to the cysts

398
00:16:31,730 --> 00:16:38,899
path<font color="#CCCCCC"> so this is the path of the engine</font>

399
00:16:35,300 --> 00:16:41,149
itself<font color="#CCCCCC"> so</font><font color="#E5E5E5"> really the magic sauce here is</font>

400
00:16:38,899 --> 00:16:43,399
this resource<font color="#E5E5E5"> been a path and Porter</font>

401
00:16:41,149 --> 00:16:45,139
function<font color="#E5E5E5"> will you give it the assembly</font>

402
00:16:43,399 --> 00:16:46,519
name and then the resource<font color="#E5E5E5"> name and</font>

403
00:16:45,139 --> 00:16:49,310
usually<font color="#CCCCCC"> sharp mentoring and</font><font color="#E5E5E5"> you're good</font>

404
00:16:46,519 --> 00:16:53,480
<font color="#E5E5E5">to go</font><font color="#CCCCCC"> and just dependent assistant path</font>

405
00:16:49,310 --> 00:16:56,000
and I try that<font color="#CCCCCC"> wampum</font><font color="#E5E5E5"> does not work and</font>

406
00:16:53,480 --> 00:16:57,980
I tried this for a long time

407
00:16:56,000 --> 00:17:00,199
like a<font color="#E5E5E5"> long time I think I tried</font>

408
00:16:57,980 --> 00:17:02,449
figuring<font color="#CCCCCC"> out why it did not</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> for at</font>

409
00:17:00,199 --> 00:17:05,599
least a week<font color="#CCCCCC"> to two weeks so one week</font>

410
00:17:02,449 --> 00:17:07,789
later I completely<font color="#E5E5E5"> give up and I am</font>

411
00:17:05,599 --> 00:17:09,859
frustrated as all hell<font color="#CCCCCC"> and I decide okay</font>

412
00:17:07,789 --> 00:17:11,720
<font color="#CCCCCC">obviously I don't know if</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> sharp well</font>

413
00:17:09,859 --> 00:17:12,859
enough to even try<font color="#CCCCCC"> it</font><font color="#E5E5E5"> like I've tried</font>

414
00:17:11,720 --> 00:17:14,720
everything<font color="#CCCCCC"> possible I don't know so</font>

415
00:17:12,859 --> 00:17:17,208
check<font color="#E5E5E5"> well</font><font color="#CCCCCC"> enough right so I post a</font>

416
00:17:14,720 --> 00:17:18,860
issue on the ironpython<font color="#E5E5E5"> repository and</font>

417
00:17:17,209 --> 00:17:21,230
I'm like hey you know I'm doing stuff

418
00:17:18,859 --> 00:17:24,649
<font color="#CCCCCC">which I think</font><font color="#E5E5E5"> should be working why is</font>

419
00:17:21,230 --> 00:17:26,179
<font color="#E5E5E5">it working</font><font color="#CCCCCC"> and I wasn't</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> expecting</font>

420
00:17:24,650 --> 00:17:28,010
in response to<font color="#CCCCCC"> be perfectly honest</font><font color="#E5E5E5"> and</font>

421
00:17:26,179 --> 00:17:29,690
the next day<font color="#CCCCCC"> one of the</font><font color="#E5E5E5"> containers</font>

422
00:17:28,010 --> 00:17:32,990
respond<font color="#E5E5E5"> can you try the latest release</font>

423
00:17:29,690 --> 00:17:34,970
<font color="#CCCCCC">reduce two-point-seven</font><font color="#E5E5E5"> money and</font><font color="#CCCCCC"> she</font>

424
00:17:32,990 --> 00:17:38,419
<font color="#CCCCCC">would said what hey where's that head</font>

425
00:17:34,970 --> 00:17:40,669
it's not<font color="#CCCCCC"> on the website 2.77 lose</font>

426
00:17:38,419 --> 00:17:43,120
release so it turns out they don't know

427
00:17:40,669 --> 00:17:43,120
<font color="#CCCCCC">that their website</font>

428
00:17:47,410 --> 00:17:52,900
so I go<font color="#E5E5E5"> to the github page and some of</font>

429
00:17:50,650 --> 00:17:58,000
the releases<font color="#CCCCCC"> tab</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> github page at</font>

430
00:17:52,900 --> 00:18:00,550
that<font color="#E5E5E5"> point I'm like you if you want you</font>

431
00:17:58,000 --> 00:18:03,580
<font color="#CCCCCC">want me</font><font color="#E5E5E5"> to play</font><font color="#CCCCCC"> probably you</font><font color="#E5E5E5"> hear so</font>

432
00:18:00,550 --> 00:18:05,980
many guys this is how you<font color="#E5E5E5"> get taken</font>

433
00:18:03,580 --> 00:18:07,419
murder<font color="#E5E5E5"> but hey it works now</font><font color="#CCCCCC"> this isn't</font>

434
00:18:05,980 --> 00:18:08,890
it it works now it's fun<font color="#E5E5E5"> and it's all</font>

435
00:18:07,420 --> 00:18:10,570
good<font color="#E5E5E5"> it actually</font><font color="#CCCCCC"> worked</font>

436
00:18:08,890 --> 00:18:13,720
I literally just download the new

437
00:18:10,570 --> 00:18:15,429
version<font color="#E5E5E5"> of our buds on install it</font><font color="#CCCCCC"> I run</font>

438
00:18:13,720 --> 00:18:20,650
the<font color="#E5E5E5"> sequel that</font><font color="#CCCCCC"> I had before</font><font color="#E5E5E5"> it works</font>

439
00:18:15,430 --> 00:18:21,970
perfectly<font color="#E5E5E5"> so I'm happy right now</font><font color="#CCCCCC"> so now</font>

440
00:18:20,650 --> 00:18:23,950
we<font color="#CCCCCC"> solve</font><font color="#E5E5E5"> the second problem we</font><font color="#CCCCCC"> could do</font>

441
00:18:21,970 --> 00:18:26,260
so<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> Python</font>

442
00:18:23,950 --> 00:18:27,700
<font color="#E5E5E5">standard library in the for the script</font>

443
00:18:26,260 --> 00:18:31,450
that<font color="#E5E5E5"> we invented within the c-sharp</font>

444
00:18:27,700 --> 00:18:33,190
minor right using<font color="#E5E5E5"> the Python engine now</font>

445
00:18:31,450 --> 00:18:35,950
the problem is which I thought was gonna

446
00:18:33,190 --> 00:18:37,780
<font color="#CCCCCC">be a lot more</font><font color="#E5E5E5"> complicated than this was</font>

447
00:18:35,950 --> 00:18:40,150
it needs a third<font color="#CCCCCC"> party</font><font color="#E5E5E5"> he loves right it</font>

448
00:18:37,780 --> 00:18:43,389
needs those ironpython<font color="#CCCCCC"> he loves that</font><font color="#E5E5E5"> are</font>

449
00:18:40,150 --> 00:18:45,550
not shipped by default<font color="#E5E5E5"> that framework so</font>

450
00:18:43,390 --> 00:18:47,560
I<font color="#E5E5E5"> don't know C sharp but even I knew</font>

451
00:18:45,550 --> 00:18:49,690
about I'll merge and I thought<font color="#E5E5E5"> okay this</font>

452
00:18:47,560 --> 00:18:53,470
<font color="#CCCCCC">should be very</font><font color="#E5E5E5"> straightforward right</font><font color="#CCCCCC"> so</font>

453
00:18:49,690 --> 00:18:56,230
I use<font color="#E5E5E5"> I alert</font><font color="#CCCCCC"> whomp-whomp does not work</font>

454
00:18:53,470 --> 00:18:57,790
and I google it first thing that comes

455
00:18:56,230 --> 00:18:59,710
<font color="#CCCCCC">out in a stack overflow post that says</font>

456
00:18:57,790 --> 00:19:03,310
sadly<font color="#CCCCCC"> I all learnt just</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> working</font><font color="#E5E5E5"> with</font>

457
00:18:59,710 --> 00:19:05,830
<font color="#E5E5E5">our my phone so I'm like well crap</font><font color="#CCCCCC"> there</font>

458
00:19:03,310 --> 00:19:09,520
goes that<font color="#CCCCCC"> mess but this guy is extremely</font>

459
00:19:05,830 --> 00:19:16,990
useful<font color="#CCCCCC"> and he puts me to a really really</font>

460
00:19:09,520 --> 00:19:21,460
<font color="#E5E5E5">old post by Geoffrey Richard which and</font>

461
00:19:16,990 --> 00:19:25,450
an excerpt from his<font color="#E5E5E5"> CLR BSC sharp his</font>

462
00:19:21,460 --> 00:19:28,360
book and in this book he filled a very

463
00:19:25,450 --> 00:19:30,520
very<font color="#E5E5E5"> interesting way of dealing with</font>

464
00:19:28,360 --> 00:19:32,379
this without<font color="#E5E5E5"> idle merge so to packed all</font>

465
00:19:30,520 --> 00:19:35,050
<font color="#E5E5E5">third party assemblies with Tennessee</font>

466
00:19:32,380 --> 00:19:36,820
sharp<font color="#E5E5E5"> binary without using I'll merge</font>

467
00:19:35,050 --> 00:19:39,730
<font color="#E5E5E5">and bite and to do this all you do is</font>

468
00:19:36,820 --> 00:19:41,260
register a callback method with the app

469
00:19:39,730 --> 00:19:46,480
<font color="#E5E5E5">domains</font><font color="#CCCCCC"> resolved</font>

470
00:19:41,260 --> 00:19:47,890
<font color="#E5E5E5">assembly event and he gives a a little</font>

471
00:19:46,480 --> 00:19:49,660
snippet<font color="#E5E5E5"> of code which does exactly this</font>

472
00:19:47,890 --> 00:19:51,730
<font color="#CCCCCC">and what</font><font color="#E5E5E5"> this book does is it basically</font>

473
00:19:49,660 --> 00:19:53,170
<font color="#E5E5E5">whenever you run a c-sharp</font><font color="#CCCCCC"> minor' and</font>

474
00:19:51,730 --> 00:19:55,360
<font color="#E5E5E5">put that you can put this code basically</font>

475
00:19:53,170 --> 00:19:57,490
at least from just my<font color="#E5E5E5"> test thing and</font>

476
00:19:55,360 --> 00:19:59,199
what it'll do<font color="#CCCCCC"> is it'll hook they simply</font>

477
00:19:57,490 --> 00:20:00,850
<font color="#E5E5E5">resolve that and what that means it is</font>

478
00:19:59,200 --> 00:20:04,780
when the c-sharp minor' tries to resolve

479
00:20:00,850 --> 00:20:06,250
<font color="#CCCCCC">an assembly and it can't find it</font><font color="#E5E5E5"> it'll</font>

480
00:20:04,780 --> 00:20:08,260
<font color="#E5E5E5">execute the function that you</font><font color="#CCCCCC"> gave it so</font>

481
00:20:06,250 --> 00:20:11,020
with<font color="#E5E5E5"> this function we can tell it hey if</font>

482
00:20:08,260 --> 00:20:12,760
you don't<font color="#E5E5E5"> find an assembly just look for</font>

483
00:20:11,020 --> 00:20:15,639
it<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> embedded resources</font><font color="#E5E5E5"> in the</font>

484
00:20:12,760 --> 00:20:18,820
<font color="#CCCCCC">sea-shore binary or fetch it from</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> URL</font>

485
00:20:15,640 --> 00:20:22,000
right<font color="#E5E5E5"> so we can just stage dll's this</font>

486
00:20:18,820 --> 00:20:24,399
way or<font color="#CCCCCC"> just pack them inside the seizure</font>

487
00:20:22,000 --> 00:20:28,300
finding themselves<font color="#CCCCCC"> and it'll just work</font>

488
00:20:24,400 --> 00:20:31,270
and so the next<font color="#E5E5E5"> question is like if this</font>

489
00:20:28,300 --> 00:20:33,340
exists what's the point of<font color="#CCCCCC"> a Elbert</font>

490
00:20:31,270 --> 00:20:36,610
<font color="#E5E5E5">right like I thought I</font><font color="#CCCCCC"> already</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> so</font>

491
00:20:33,340 --> 00:20:43,020
<font color="#CCCCCC">Miss</font><font color="#E5E5E5"> turns out there is no</font><font color="#CCCCCC"> point large</font>

492
00:20:36,610 --> 00:20:43,020
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the author</font>

493
00:20:44,050 --> 00:20:49,419
the author of<font color="#CCCCCC"> IL burned himself</font>

494
00:20:46,000 --> 00:20:51,520
commented on the this little episode

495
00:20:49,420 --> 00:20:53,770
here and he says hey you know this<font color="#CCCCCC"> is</font>

496
00:20:51,520 --> 00:20:57,220
<font color="#E5E5E5">absolutely</font><font color="#CCCCCC"> amazing</font><font color="#E5E5E5"> I known</font><font color="#CCCCCC"> about this I</font>

497
00:20:53,770 --> 00:20:58,840
never<font color="#CCCCCC"> would have written</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> alert so</font>

498
00:20:57,220 --> 00:21:02,140
that's that's<font color="#CCCCCC"> pretty cool</font>

499
00:20:58,840 --> 00:21:04,209
so this is that<font color="#E5E5E5"> literally this is this</font>

500
00:21:02,140 --> 00:21:06,300
is literally just a straight-up way<font color="#CCCCCC"> I</font>

501
00:21:04,210 --> 00:21:08,559
<font color="#CCCCCC">straight up better way of dealing with</font>

502
00:21:06,300 --> 00:21:10,540
<font color="#CCCCCC">third</font><font color="#E5E5E5"> party assemblies and it sounds</font>

503
00:21:08,559 --> 00:21:11,490
pretty<font color="#CCCCCC"> cool I thought</font><font color="#E5E5E5"> that was that</font><font color="#CCCCCC"> was</font>

504
00:21:10,540 --> 00:21:13,360
really<font color="#E5E5E5"> really cool</font>

505
00:21:11,490 --> 00:21:16,300
so going back<font color="#CCCCCC"> to our technology</font>

506
00:21:13,360 --> 00:21:18,580
<font color="#CCCCCC">challenges</font><font color="#E5E5E5"> right so we pretty much took</font>

507
00:21:16,300 --> 00:21:21,639
care<font color="#CCCCCC"> of everything but</font><font color="#E5E5E5"> the problem</font><font color="#CCCCCC"> is</font>

508
00:21:18,580 --> 00:21:24,669
now it only<font color="#E5E5E5"> works</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> that version 4.0</font>

509
00:21:21,640 --> 00:21:27,460
and this is because<font color="#CCCCCC"> we compiled</font>

510
00:21:24,670 --> 00:21:28,990
<font color="#E5E5E5">ironpython</font><font color="#CCCCCC"> of snow days are the</font><font color="#E5E5E5"> iron</font>

511
00:21:27,460 --> 00:21:31,809
<font color="#CCCCCC">problem assemblies are compiled against</font>

512
00:21:28,990 --> 00:21:34,929
<font color="#CCCCCC">tough metal so they won't</font><font color="#E5E5E5"> work on</font>

513
00:21:31,809 --> 00:21:38,470
<font color="#CCCCCC">anything underneath</font><font color="#E5E5E5"> lesser versions than</font>

514
00:21:34,929 --> 00:21:40,030
that right<font color="#E5E5E5"> and actually</font><font color="#CCCCCC"> figured out a</font>

515
00:21:38,470 --> 00:21:43,540
way around this I just<font color="#E5E5E5"> need a lot</font><font color="#CCCCCC"> more</font>

516
00:21:40,030 --> 00:21:45,490
time to do<font color="#E5E5E5"> that but it is possible</font><font color="#CCCCCC"> and</font>

517
00:21:43,540 --> 00:21:47,200
it's not that<font color="#CCCCCC"> big of a deal</font><font color="#E5E5E5"> in my mind</font>

518
00:21:45,490 --> 00:21:49,059
to be perfectly honest because<font color="#E5E5E5"> the</font>

519
00:21:47,200 --> 00:21:51,190
reason why you want<font color="#CCCCCC"> to use this in</font><font color="#E5E5E5"> the</font>

520
00:21:49,059 --> 00:21:52,570
first place<font color="#E5E5E5"> really is to get</font><font color="#CCCCCC"> around the</font>

521
00:21:51,190 --> 00:21:55,030
<font color="#CCCCCC">PowerShell protections and</font><font color="#E5E5E5"> if you're not</font>

522
00:21:52,570 --> 00:21:56,950
<font color="#CCCCCC">on a Windows 10 machine</font><font color="#E5E5E5"> you should be</font>

523
00:21:55,030 --> 00:21:59,590
you should be<font color="#E5E5E5"> able to use PowerShell</font>

524
00:21:56,950 --> 00:22:02,200
stuff so<font color="#CCCCCC"> it's it's</font><font color="#E5E5E5"> but I figured out a</font>

525
00:21:59,590 --> 00:22:03,760
<font color="#E5E5E5">way</font><font color="#CCCCCC"> I'll talk about</font><font color="#E5E5E5"> that here</font><font color="#CCCCCC"> so I got</font>

526
00:22:02,200 --> 00:22:05,320
<font color="#CCCCCC">the</font><font color="#E5E5E5"> I get a proof of concept work again</font>

527
00:22:03,760 --> 00:22:07,059
I apologize<font color="#CCCCCC"> this is small but you get</font>

528
00:22:05,320 --> 00:22:09,100
the point if it<font color="#E5E5E5"> pops the message box and</font>

529
00:22:07,059 --> 00:22:10,780
it all<font color="#E5E5E5"> works so now we have the</font>

530
00:22:09,100 --> 00:22:13,419
accomplish<font color="#E5E5E5"> start bulb right we have</font>

531
00:22:10,780 --> 00:22:17,620
native<font color="#E5E5E5"> execution of ironpython scripts</font>

532
00:22:13,420 --> 00:22:20,410
on a Windows machine<font color="#CCCCCC"> so now we have</font>

533
00:22:17,620 --> 00:22:22,719
<font color="#CCCCCC">access to entirety a.net and we both</font>

534
00:22:20,410 --> 00:22:24,850
discovered some cool stuff along the way

535
00:22:22,720 --> 00:22:26,650
<font color="#E5E5E5">found</font><font color="#CCCCCC"> the better way of creating</font><font color="#E5E5E5"> high</font>

536
00:22:24,850 --> 00:22:29,230
not executables<font color="#CCCCCC"> for</font><font color="#E5E5E5"> Windows period</font>

537
00:22:26,650 --> 00:22:31,870
<font color="#E5E5E5">because this method is just</font><font color="#CCCCCC"> straight-up</font>

538
00:22:29,230 --> 00:22:33,429
better<font color="#E5E5E5"> than pine</font><font color="#CCCCCC"> stellar</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> high 2xe</font>

539
00:22:31,870 --> 00:22:35,678
like if you if you didn't care<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the</font>

540
00:22:33,429 --> 00:22:38,170
binary<font color="#E5E5E5"> sides you can embed the entire</font>

541
00:22:35,679 --> 00:22:40,510
standard<font color="#E5E5E5"> library in the c-sharp minor</font>

542
00:22:38,170 --> 00:22:42,490
you<font color="#CCCCCC"> can embed your</font><font color="#E5E5E5"> source file up in the</font>

543
00:22:40,510 --> 00:22:45,640
C sharp<font color="#E5E5E5"> minor a run this single</font>

544
00:22:42,490 --> 00:22:48,420
executable<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it will just</font><font color="#E5E5E5"> work on that</font>

545
00:22:45,640 --> 00:22:51,280
<font color="#CCCCCC">version</font><font color="#E5E5E5"> for anything without</font><font color="#CCCCCC"> memory core</font>

546
00:22:48,420 --> 00:22:53,360
we dissolve so discovered a lesser no

547
00:22:51,280 --> 00:22:56,030
way and

548
00:22:53,360 --> 00:22:59,149
better<font color="#E5E5E5"> as the author of</font><font color="#CCCCCC"> IL emerge stated</font>

549
00:22:56,030 --> 00:23:00,950
<font color="#CCCCCC">I'm creating a single exe that dependent</font>

550
00:22:59,150 --> 00:23:02,990
third-party<font color="#CCCCCC"> sembly</font><font color="#E5E5E5"> so that's that's cool</font>

551
00:23:00,950 --> 00:23:04,610
as well<font color="#E5E5E5"> and even if you're not</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> hear</font>

552
00:23:02,990 --> 00:23:06,790
just<font color="#CCCCCC"> the developer</font><font color="#E5E5E5"> I think this is</font>

553
00:23:04,610 --> 00:23:09,350
pretty amazing like<font color="#CCCCCC"> you can you can just</font>

554
00:23:06,790 --> 00:23:11,540
natively<font color="#E5E5E5"> like you can write your</font>

555
00:23:09,350 --> 00:23:14,060
application and ironpython<font color="#E5E5E5"> and only have</font>

556
00:23:11,540 --> 00:23:15,230
like<font color="#E5E5E5"> this</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> short stuff to deploy your</font>

557
00:23:14,060 --> 00:23:16,610
application which i think is pretty

558
00:23:15,230 --> 00:23:17,930
<font color="#E5E5E5">amazing</font><font color="#CCCCCC"> like from</font><font color="#E5E5E5"> even developers</font>

559
00:23:16,610 --> 00:23:21,530
<font color="#CCCCCC">template if you're not interested in</font>

560
00:23:17,930 --> 00:23:22,790
security<font color="#CCCCCC"> whatsoever</font><font color="#E5E5E5"> and we and again</font>

561
00:23:21,530 --> 00:23:24,500
might be<font color="#CCCCCC"> accomplish our goal but if you</font>

562
00:23:22,790 --> 00:23:26,570
have<font color="#E5E5E5"> native our might not script</font>

563
00:23:24,500 --> 00:23:28,850
execution on<font color="#E5E5E5"> Windows 10 through an</font>

564
00:23:26,570 --> 00:23:31,970
embedded ironpython engine with<font color="#E5E5E5"> in</font>

565
00:23:28,850 --> 00:23:33,800
c-sharp<font color="#E5E5E5"> binary but wait there's more we</font>

566
00:23:31,970 --> 00:23:36,530
go deeper on<font color="#E5E5E5"> this it's us becoming like</font>

567
00:23:33,800 --> 00:23:40,040
<font color="#CCCCCC">Inception so how is this even possible</font>

568
00:23:36,530 --> 00:23:41,690
right<font color="#E5E5E5"> well turns out there's the CLR</font><font color="#CCCCCC"> and</font>

569
00:23:40,040 --> 00:23:45,740
then there's this<font color="#E5E5E5"> thing that sits on top</font>

570
00:23:41,690 --> 00:23:47,840
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the CLR called the DLR and I before</font>

571
00:23:45,740 --> 00:23:51,530
anyone this I've never<font color="#CCCCCC"> learned before</font>

572
00:23:47,840 --> 00:23:54,080
<font color="#E5E5E5">but it turns out c-sharp runs on the DLR</font>

573
00:23:51,530 --> 00:23:57,170
and a lot in all of the iron<font color="#CCCCCC"> languages</font>

574
00:23:54,080 --> 00:24:01,669
<font color="#CCCCCC">run</font><font color="#E5E5E5"> the DLR and the DLR is basically an</font>

575
00:23:57,170 --> 00:24:04,100
interface<font color="#CCCCCC"> for scripting languages to the</font>

576
00:24:01,670 --> 00:24:06,500
<font color="#E5E5E5">CLR and I still don't perfectly</font>

577
00:24:04,100 --> 00:24:09,469
understand how this<font color="#E5E5E5"> even works</font>

578
00:24:06,500 --> 00:24:12,500
let<font color="#CCCCCC"> alone the internal details of this</font>

579
00:24:09,470 --> 00:24:14,660
but<font color="#E5E5E5"> that seemed from the documentation I</font>

580
00:24:12,500 --> 00:24:17,030
read I think<font color="#E5E5E5"> that's pretty accurate but</font>

581
00:24:14,660 --> 00:24:18,800
if there's a link<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> slide</font><font color="#E5E5E5"> which on</font>

582
00:24:17,030 --> 00:24:20,149
<font color="#CCCCCC">the sides of</font><font color="#E5E5E5"> which I'll be releasing so</font>

583
00:24:18,800 --> 00:24:22,520
if you want<font color="#E5E5E5"> to read</font><font color="#CCCCCC"> up more about that I</font>

584
00:24:20,150 --> 00:24:24,730
sure will because I still<font color="#CCCCCC"> don't</font>

585
00:24:22,520 --> 00:24:27,440
understand<font color="#E5E5E5"> how everything works</font>

586
00:24:24,730 --> 00:24:29,470
you can definitely<font color="#E5E5E5"> read there hopefully</font>

587
00:24:27,440 --> 00:24:32,150
<font color="#E5E5E5">they</font><font color="#CCCCCC"> explained it better</font><font color="#E5E5E5"> than I did</font><font color="#CCCCCC"> so</font>

588
00:24:29,470 --> 00:24:33,890
<font color="#CCCCCC">let's talk about weaponization so now we</font>

589
00:24:32,150 --> 00:24:37,030
have native my<font color="#CCCCCC"> brother's participation</font>

590
00:24:33,890 --> 00:24:39,650
now we have<font color="#E5E5E5"> to weaponize this right so</font>

591
00:24:37,030 --> 00:24:42,320
we still<font color="#E5E5E5"> have to learn C sharp which is</font>

592
00:24:39,650 --> 00:24:44,600
<font color="#E5E5E5">the problem</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> file size</font><font color="#CCCCCC"> so in my</font>

593
00:24:42,320 --> 00:24:46,429
original proof of concept<font color="#E5E5E5"> we embedded a</font>

594
00:24:44,600 --> 00:24:47,840
standard<font color="#E5E5E5"> library</font><font color="#CCCCCC"> members</font><font color="#E5E5E5"> first file all</font>

595
00:24:46,430 --> 00:24:50,000
<font color="#E5E5E5">in one binary</font><font color="#CCCCCC"> the problem with this was</font>

596
00:24:47,840 --> 00:24:52,250
<font color="#E5E5E5">if</font><font color="#CCCCCC"> you understand the library it's the</font>

597
00:24:50,000 --> 00:24:55,820
binary becomes like<font color="#E5E5E5"> 15 minutes which</font><font color="#CCCCCC"> is</font>

598
00:24:52,250 --> 00:24:59,150
not exactly<font color="#CCCCCC"> ideal offensively if you</font>

599
00:24:55,820 --> 00:25:01,310
compress that standard library to<font color="#E5E5E5"> the</font>

600
00:24:59,150 --> 00:25:03,080
max compression level<font color="#CCCCCC"> does it fire</font>

601
00:25:01,310 --> 00:25:06,230
allows the binary becomes around<font color="#E5E5E5"> neat</font>

602
00:25:03,080 --> 00:25:07,989
megabytes<font color="#E5E5E5"> which is still way too big</font>

603
00:25:06,230 --> 00:25:10,609
from<font color="#CCCCCC"> an</font><font color="#E5E5E5"> opposite perspective</font><font color="#CCCCCC"> I</font>

604
00:25:07,989 --> 00:25:13,220
preferably do not want this<font color="#E5E5E5"> to touch</font>

605
00:25:10,609 --> 00:25:15,769
this<font color="#CCCCCC"> that'd be</font><font color="#E5E5E5"> great</font><font color="#CCCCCC"> and can we</font><font color="#E5E5E5"> get this</font>

606
00:25:13,220 --> 00:25:19,129
<font color="#E5E5E5">to work on that version 4.0 which we'll</font>

607
00:25:15,769 --> 00:25:20,629
talk about at<font color="#E5E5E5"> halftime</font><font color="#CCCCCC"> and now really</font>

608
00:25:19,129 --> 00:25:24,049
the only thing we<font color="#E5E5E5"> have to do is write a</font>

609
00:25:20,629 --> 00:25:25,639
framework around it<font color="#E5E5E5"> student and board</font>

610
00:25:24,049 --> 00:25:26,960
some of<font color="#CCCCCC"> the existing c-sharp tooling</font>

611
00:25:25,639 --> 00:25:28,998
that's been coming<font color="#E5E5E5"> out to our Python</font>

612
00:25:26,960 --> 00:25:31,460
<font color="#E5E5E5">which is really really</font><font color="#CCCCCC"> easy because</font><font color="#E5E5E5"> it's</font>

613
00:25:28,999 --> 00:25:34,489
the same function<font color="#CCCCCC"> calls that you didn't</font>

614
00:25:31,460 --> 00:25:36,559
see sharp<font color="#CCCCCC"> only in Python it's</font><font color="#E5E5E5"> better and</font>

615
00:25:34,489 --> 00:25:37,759
all<font color="#CCCCCC"> the data type converts between high</font>

616
00:25:36,559 --> 00:25:38,840
<font color="#CCCCCC">price and c-sharp</font>

617
00:25:37,759 --> 00:25:40,039
I thought that would initially be a

618
00:25:38,840 --> 00:25:46,039
problem and it turns out it's pretty

619
00:25:40,039 --> 00:25:48,429
<font color="#CCCCCC">easy as well so the</font><font color="#E5E5E5"> question is now do</font>

620
00:25:46,039 --> 00:25:51,710
we when I first<font color="#E5E5E5"> started writing this I</font>

621
00:25:48,429 --> 00:25:54,070
thought to myself well do we really<font color="#CCCCCC"> even</font>

622
00:25:51,710 --> 00:25:56,629
need the Python<font color="#E5E5E5"> standard library right</font>

623
00:25:54,070 --> 00:25:59,689
because we<font color="#E5E5E5"> have access</font><font color="#CCCCCC"> to done that</font><font color="#E5E5E5"> so</font>

624
00:25:56,629 --> 00:26:01,850
like we can just<font color="#E5E5E5"> download stuff with</font>

625
00:25:59,690 --> 00:26:05,210
dotnet using you know web<font color="#CCCCCC"> request create</font>

626
00:26:01,850 --> 00:26:08,029
we can<font color="#E5E5E5"> do everything that that</font><font color="#CCCCCC"> does only</font>

627
00:26:05,210 --> 00:26:10,070
in<font color="#E5E5E5"> Python</font><font color="#CCCCCC"> so do we really need</font><font color="#E5E5E5"> the</font>

628
00:26:08,029 --> 00:26:11,419
Python standard<font color="#E5E5E5"> library</font><font color="#CCCCCC"> I mean in the</font>

629
00:26:10,070 --> 00:26:12,918
long term<font color="#E5E5E5"> that would be great because it</font>

630
00:26:11,419 --> 00:26:14,779
<font color="#E5E5E5">would be awesome to</font><font color="#CCCCCC"> just like push</font>

631
00:26:12,919 --> 00:26:17,690
<font color="#E5E5E5">responder down to it and</font><font color="#CCCCCC"> respond there</font>

632
00:26:14,779 --> 00:26:20,779
<font color="#CCCCCC">on Windows 10 machine</font><font color="#E5E5E5"> that'd</font><font color="#CCCCCC"> be kind of</font>

633
00:26:17,690 --> 00:26:22,220
cool<font color="#E5E5E5"> but like initially</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> really</font>

634
00:26:20,779 --> 00:26:23,720
<font color="#CCCCCC">making stage other with a</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> the</font>

635
00:26:22,220 --> 00:26:25,220
<font color="#E5E5E5">Union</font><font color="#CCCCCC"> staged entire standard</font><font color="#E5E5E5"> library</font>

636
00:26:23,720 --> 00:26:26,929
over<font color="#E5E5E5"> the network</font><font color="#CCCCCC"> and that's perfectly</font>

637
00:26:25,220 --> 00:26:28,850
fine<font color="#E5E5E5"> if needed</font>

638
00:26:26,929 --> 00:26:31,159
<font color="#CCCCCC">so without the standard library and</font><font color="#E5E5E5"> this</font>

639
00:26:28,850 --> 00:26:33,469
becomes 10 kilobytes which is much much

640
00:26:31,159 --> 00:26:37,999
better<font color="#E5E5E5"> that's that's great</font><font color="#CCCCCC"> you can work</font>

641
00:26:33,470 --> 00:26:39,830
with<font color="#CCCCCC"> that so I started writing like</font>

642
00:26:37,999 --> 00:26:42,679
actual modules for the<font color="#E5E5E5"> framework right</font>

643
00:26:39,830 --> 00:26:44,600
and it's<font color="#E5E5E5"> just amazing</font><font color="#CCCCCC"> like you</font><font color="#E5E5E5"> then</font>

644
00:26:42,679 --> 00:26:47,450
there's some there's some<font color="#E5E5E5"> modern Python</font>

645
00:26:44,600 --> 00:26:49,519
examples online<font color="#E5E5E5"> which we're almost like</font>

646
00:26:47,450 --> 00:26:51,679
they're not even<font color="#E5E5E5"> meant to be weaponized</font>

647
00:26:49,519 --> 00:26:53,330
but it's it's<font color="#E5E5E5"> just the main layer from</font><font color="#CCCCCC"> a</font>

648
00:26:51,679 --> 00:26:55,580
<font color="#E5E5E5">writing perspective all the</font><font color="#CCCCCC"> examples</font>

649
00:26:53,330 --> 00:26:57,889
online<font color="#E5E5E5"> are amazing so the first one here</font>

650
00:26:55,580 --> 00:27:02,149
<font color="#E5E5E5">for example</font><font color="#CCCCCC"> we're just</font><font color="#E5E5E5"> you can you can</font>

651
00:26:57,889 --> 00:27:04,039
<font color="#CCCCCC">just send down a</font><font color="#E5E5E5"> I'm a c-sharp assembly</font>

652
00:27:02,149 --> 00:27:07,149
<font color="#E5E5E5">it'll execute that assembly completed</font>

653
00:27:04,039 --> 00:27:09,980
memory and the right<font color="#E5E5E5"> gal go to a buffer</font>

654
00:27:07,149 --> 00:27:15,738
we print<font color="#E5E5E5"> down the buffer to the STL</font>

655
00:27:09,980 --> 00:27:18,930
which we can capture in the amount of<font color="#E5E5E5"> my</font>

656
00:27:15,739 --> 00:27:20,430
<font color="#CCCCCC">dimension and so this way this</font>

657
00:27:18,930 --> 00:27:21,960
perfect<font color="#CCCCCC"> and one of the this is</font><font color="#E5E5E5"> the</font>

658
00:27:20,430 --> 00:27:23,670
execute assembly module for example<font color="#CCCCCC"> the</font>

659
00:27:21,960 --> 00:27:25,890
<font color="#E5E5E5">tool</font><font color="#CCCCCC"> silent Trinity</font><font color="#E5E5E5"> they'll be releasing</font>

660
00:27:23,670 --> 00:27:28,020
and there's in<font color="#CCCCCC"> ten lines of code</font><font color="#E5E5E5"> we can</font>

661
00:27:25,890 --> 00:27:30,330
<font color="#E5E5E5">do that in our in Python</font><font color="#CCCCCC"> and it's really</font>

662
00:27:28,020 --> 00:27:31,770
really<font color="#CCCCCC"> cool so if you want if you</font><font color="#E5E5E5"> want</font>

663
00:27:30,330 --> 00:27:33,060
to write<font color="#E5E5E5"> your own see like if you</font>

664
00:27:31,770 --> 00:27:34,379
just<font color="#E5E5E5"> want to write your own C sharp</font>

665
00:27:33,060 --> 00:27:38,990
assemblies you can just push them<font color="#CCCCCC"> down</font>

666
00:27:34,380 --> 00:27:43,200
<font color="#E5E5E5">and all</font><font color="#CCCCCC"> those exit</font><font color="#E5E5E5"> memory you can also</font>

667
00:27:38,990 --> 00:27:46,710
compile C sharp<font color="#E5E5E5"> directly in ironpython</font>

668
00:27:43,200 --> 00:27:48,960
<font color="#CCCCCC">via code</font><font color="#E5E5E5"> um so you can take</font><font color="#CCCCCC"> a whole like</font>

669
00:27:46,710 --> 00:27:50,250
for example<font color="#E5E5E5"> any any sharp</font><font color="#CCCCCC"> tool you think</font>

670
00:27:48,960 --> 00:27:53,280
that you can literally<font color="#E5E5E5"> copy paste the</font>

671
00:27:50,250 --> 00:27:56,790
source code for<font color="#E5E5E5"> C sharp into an iron</font>

672
00:27:53,280 --> 00:28:00,770
pipe on file and<font color="#E5E5E5"> using this handy dandy</font>

673
00:27:56,790 --> 00:28:04,320
example which the actual<font color="#E5E5E5"> ironpython</font>

674
00:28:00,770 --> 00:28:08,400
<font color="#E5E5E5">website has online</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> you do</font><font color="#CCCCCC"> is give it</font>

675
00:28:04,320 --> 00:28:10,860
the sort<font color="#E5E5E5"> be C sharp source code and it</font>

676
00:28:08,400 --> 00:28:13,290
will dynamically compile<font color="#CCCCCC"> that iron pipe</font>

677
00:28:10,860 --> 00:28:14,820
that<font color="#CCCCCC"> a</font><font color="#E5E5E5"> C</font><font color="#CCCCCC"> sharp on the end point</font><font color="#E5E5E5"> when you</font>

678
00:28:13,290 --> 00:28:17,129
<font color="#E5E5E5">execute the function and this is</font><font color="#CCCCCC"> the</font>

679
00:28:14,820 --> 00:28:18,179
<font color="#E5E5E5">equivalent of</font><font color="#CCCCCC"> at type in PowerShell</font><font color="#E5E5E5"> like</font>

680
00:28:17,130 --> 00:28:20,520
if you're familiar with<font color="#E5E5E5"> at that</font><font color="#CCCCCC"> time</font>

681
00:28:18,180 --> 00:28:22,920
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> the exact equivalent</font><font color="#E5E5E5"> and you can</font>

682
00:28:20,520 --> 00:28:25,680
pass in a call<font color="#E5E5E5"> see</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> see that XD in the</font>

683
00:28:22,920 --> 00:28:28,620
background so<font color="#E5E5E5"> a and</font><font color="#CCCCCC"> it there is an</font>

684
00:28:25,680 --> 00:28:31,080
option for in men like<font color="#E5E5E5"> generating one of</font>

685
00:28:28,620 --> 00:28:34,169
these<font color="#E5E5E5"> are some assembly in memory but it</font>

686
00:28:31,080 --> 00:28:35,639
does touch this<font color="#CCCCCC"> misnomer</font><font color="#E5E5E5"> but then I</font>

687
00:28:34,170 --> 00:28:38,970
<font color="#E5E5E5">think that's that's that's</font><font color="#CCCCCC"> it's a whole</font>

688
00:28:35,640 --> 00:28:41,430
<font color="#CCCCCC">different thing</font><font color="#E5E5E5"> but so you can just copy</font>

689
00:28:38,970 --> 00:28:43,530
paste c-sharp code into an iron<font color="#CCCCCC"> Python</font>

690
00:28:41,430 --> 00:28:45,840
file and it'll that internal dynamic new

691
00:28:43,530 --> 00:28:50,250
pilot<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> endpoint because I thought</font>

692
00:28:45,840 --> 00:28:54,649
of that<font color="#E5E5E5"> title which means this is</font><font color="#CCCCCC"> the</font>

693
00:28:50,250 --> 00:28:57,240
<font color="#CCCCCC">mini-cons module in the tool we can take</font>

694
00:28:54,650 --> 00:28:58,860
the<font color="#CCCCCC"> safety has module rather so I've</font>

695
00:28:57,240 --> 00:29:01,290
learnt in<font color="#CCCCCC"> respect their offices safety</font>

696
00:28:58,860 --> 00:29:04,919
cats to arm Python and we can just take

697
00:29:01,290 --> 00:29:08,399
a c-sharp either a c-sharp assembly<font color="#CCCCCC"> not</font>

698
00:29:04,920 --> 00:29:12,300
an<font color="#E5E5E5"> assembly or just paste in the source</font>

699
00:29:08,400 --> 00:29:15,300
code<font color="#CCCCCC"> that exposes the win32 debug</font><font color="#E5E5E5"> held</font>

700
00:29:12,300 --> 00:29:16,740
<font color="#CCCCCC">mini dump read dump function which is</font>

701
00:29:15,300 --> 00:29:19,230
what we can<font color="#CCCCCC"> call to action create a</font>

702
00:29:16,740 --> 00:29:23,100
memory process<font color="#E5E5E5"> memory down below</font>

703
00:29:19,230 --> 00:29:28,200
specified process in<font color="#CCCCCC"> Python</font><font color="#E5E5E5"> and then we</font>

704
00:29:23,100 --> 00:29:30,100
just decompress<font color="#CCCCCC"> a string in the same</font>

705
00:29:28,200 --> 00:29:34,420
source file<font color="#CCCCCC"> which is just the press</font>

706
00:29:30,100 --> 00:29:37,240
we can then pass that to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Sharps</font><font color="#CCCCCC"> koi</font>

707
00:29:34,420 --> 00:29:39,670
<font color="#CCCCCC">P loader</font><font color="#E5E5E5"> function which I've also poured</font>

708
00:29:37,240 --> 00:29:46,020
<font color="#E5E5E5">to ironpython</font><font color="#CCCCCC"> and I'll</font><font color="#E5E5E5"> just execute any</font>

709
00:29:39,670 --> 00:29:49,630
cats<font color="#E5E5E5"> through</font><font color="#CCCCCC"> and I -</font><font color="#E5E5E5"> engine 3 o AC sharp</font>

710
00:29:46,020 --> 00:29:51,250
<font color="#E5E5E5">assembly natively on</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> instead which i</font>

711
00:29:49,630 --> 00:29:53,710
think is<font color="#E5E5E5"> pretty amazing and I think</font><font color="#CCCCCC"> that</font>

712
00:29:51,250 --> 00:29:56,020
at this<font color="#E5E5E5"> point this is like even better</font>

713
00:29:53,710 --> 00:29:57,580
than I initially this<font color="#E5E5E5"> is just beyond my</font>

714
00:29:56,020 --> 00:29:58,270
expectations<font color="#CCCCCC"> of a perfectly honest and I</font>

715
00:29:57,580 --> 00:30:00,189
<font color="#E5E5E5">think in terms as opposed to</font>

716
00:29:58,270 --> 00:30:02,110
expectations just<font color="#CCCCCC"> peak right</font><font color="#E5E5E5"> here like</font>

717
00:30:00,190 --> 00:30:03,460
you're<font color="#E5E5E5"> writing your stuff in Python</font>

718
00:30:02,110 --> 00:30:04,929
which<font color="#E5E5E5"> is a scripting language and it's</font>

719
00:30:03,460 --> 00:30:09,010
executing<font color="#CCCCCC"> the attendance I</font><font color="#E5E5E5"> think it's</font>

720
00:30:04,930 --> 00:30:11,170
pretty cool there's also you can<font color="#CCCCCC"> there's</font>

721
00:30:09,010 --> 00:30:15,430
<font color="#CCCCCC">interrupt with calm like through higher</font>

722
00:30:11,170 --> 00:30:17,080
<font color="#CCCCCC">python so you can and one of it</font><font color="#E5E5E5"> this is</font>

723
00:30:15,430 --> 00:30:20,080
<font color="#CCCCCC">just an example</font><font color="#E5E5E5"> that i got off the air</font>

724
00:30:17,080 --> 00:30:22,030
by<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bug mutation you can call comm</font>

725
00:30:20,080 --> 00:30:24,129
objects<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> excel common objects so</font>

726
00:30:22,030 --> 00:30:26,649
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> do stuff like inject shell code</font>

727
00:30:24,130 --> 00:30:28,600
through VBA macros in Excel which<font color="#CCCCCC"> is one</font>

728
00:30:26,650 --> 00:30:31,450
of<font color="#E5E5E5"> those techniques</font><font color="#CCCCCC"> that something put</font>

729
00:30:28,600 --> 00:30:34,929
out through<font color="#CCCCCC"> higher python itself</font>

730
00:30:31,450 --> 00:30:38,680
all dynamically all scripted<font color="#CCCCCC"> throughout</font>

731
00:30:34,930 --> 00:30:41,830
<font color="#CCCCCC">my thought tom</font><font color="#E5E5E5"> was cool and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just</font>

732
00:30:38,680 --> 00:30:44,070
a direct example<font color="#E5E5E5"> from one of the from</font>

733
00:30:41,830 --> 00:30:46,179
one of the websites<font color="#E5E5E5"> online which is just</font>

734
00:30:44,070 --> 00:30:50,200
literally<font color="#E5E5E5"> showing you a you can</font><font color="#CCCCCC"> just</font>

735
00:30:46,180 --> 00:30:52,030
import CLR import<font color="#E5E5E5"> interrupt</font><font color="#CCCCCC"> call the</font>

736
00:30:50,200 --> 00:30:53,230
<font color="#CCCCCC">excel comm object and do whatever you</font>

737
00:30:52,030 --> 00:30:55,240
want at<font color="#CCCCCC"> that point and</font><font color="#E5E5E5"> actually</font>

738
00:30:53,230 --> 00:30:57,640
weaponize this and there's a excel

739
00:30:55,240 --> 00:30:59,980
Sheldon<font color="#CCCCCC"> jet module and then tool that</font>

740
00:30:57,640 --> 00:31:02,920
I'll be<font color="#CCCCCC"> really safe but it goes even</font>

741
00:30:59,980 --> 00:31:05,560
<font color="#E5E5E5">further so you can</font>

742
00:31:02,920 --> 00:31:08,380
<font color="#CCCCCC">who bed and I won't stay with</font><font color="#E5E5E5"> me here</font><font color="#CCCCCC"> I</font>

743
00:31:05,560 --> 00:31:11,399
know this is I'm having I'm struggling

744
00:31:08,380 --> 00:31:14,350
<font color="#E5E5E5">myself to explain</font><font color="#CCCCCC"> this in a concise way</font>

745
00:31:11,400 --> 00:31:16,660
you can embed<font color="#CCCCCC"> an</font><font color="#E5E5E5"> ironpython engine</font>

746
00:31:14,350 --> 00:31:18,129
within<font color="#E5E5E5"> an honor Python engine within the</font>

747
00:31:16,660 --> 00:31:19,870
c-sharp minor so that you can embed

748
00:31:18,130 --> 00:31:21,400
<font color="#CCCCCC">clarify you can embed multiple</font>

749
00:31:19,870 --> 00:31:24,729
ironpython engines within ironpython

750
00:31:21,400 --> 00:31:27,070
engines which is possible<font color="#E5E5E5"> because what</font>

751
00:31:24,730 --> 00:31:28,900
this<font color="#E5E5E5"> does is if you for</font><font color="#CCCCCC"> example send out</font>

752
00:31:27,070 --> 00:31:31,679
a job<font color="#E5E5E5"> right so you want to execute a</font>

753
00:31:28,900 --> 00:31:34,420
<font color="#E5E5E5">Python</font><font color="#CCCCCC"> script on the Windows 10</font><font color="#E5E5E5"> machine</font>

754
00:31:31,680 --> 00:31:36,520
instead<font color="#E5E5E5"> of making it execute in the</font>

755
00:31:34,420 --> 00:31:38,800
initial run space what<font color="#E5E5E5"> you can do is</font>

756
00:31:36,520 --> 00:31:41,320
<font color="#E5E5E5">just spin up another ironpython engine</font>

757
00:31:38,800 --> 00:31:43,750
make that<font color="#E5E5E5"> script executed that engine</font>

758
00:31:41,320 --> 00:31:46,689
<font color="#E5E5E5">and when the script is</font><font color="#CCCCCC"> the next</font>

759
00:31:43,750 --> 00:31:49,600
executing the actual assemblies that<font color="#E5E5E5"> the</font>

760
00:31:46,690 --> 00:31:52,060
job you wanted to execute get unloaded

761
00:31:49,600 --> 00:31:54,659
and memory after<font color="#E5E5E5"> finishes executing so</font>

762
00:31:52,060 --> 00:31:57,520
like for<font color="#E5E5E5"> example the this shark slowly</font>

763
00:31:54,660 --> 00:31:59,500
assemblies and all of us<font color="#E5E5E5"> that stuff that</font>

764
00:31:57,520 --> 00:32:01,780
<font color="#E5E5E5">it needs to actually load</font><font color="#CCCCCC"> meet me cats</font>

765
00:31:59,500 --> 00:32:03,700
<font color="#E5E5E5">and inject me</font><font color="#CCCCCC"> got some memory</font><font color="#E5E5E5"> and pulled</font>

766
00:32:01,780 --> 00:32:06,100
<font color="#E5E5E5">out credentials that will get completely</font>

767
00:32:03,700 --> 00:32:07,960
unloaded from memory on<font color="#CCCCCC"> runtime after it</font>

768
00:32:06,100 --> 00:32:10,179
finishes executing<font color="#E5E5E5"> and all you do is</font>

769
00:32:07,960 --> 00:32:13,690
<font color="#CCCCCC">really</font><font color="#E5E5E5"> just running in a separate</font>

770
00:32:10,180 --> 00:32:16,240
ipython engine and you can set the

771
00:32:13,690 --> 00:32:18,430
standard outputs down an error to just

772
00:32:16,240 --> 00:32:22,960
the stream so that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> capture the</font>

773
00:32:18,430 --> 00:32:25,150
<font color="#CCCCCC">output of of the module or the job you</font>

774
00:32:22,960 --> 00:32:27,880
want to execute<font color="#E5E5E5"> right which is amazing</font>

775
00:32:25,150 --> 00:32:29,890
so<font color="#E5E5E5"> I love the iron ion engine so much</font>

776
00:32:27,880 --> 00:32:31,630
that I am better than<font color="#CCCCCC"> iron</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> phone</font>

777
00:32:29,890 --> 00:32:35,500
engine<font color="#CCCCCC"> with in an iron</font><font color="#E5E5E5"> vital engine</font><font color="#CCCCCC"> with</font>

778
00:32:31,630 --> 00:32:38,740
<font color="#CCCCCC">innocence are better that's it so holy</font>

779
00:32:35,500 --> 00:32:40,210
crap right so this<font color="#CCCCCC"> is so there's zero</font>

780
00:32:38,740 --> 00:32:44,140
optics<font color="#E5E5E5"> into any of this and I've tried</font>

781
00:32:40,210 --> 00:32:47,740
this<font color="#E5E5E5"> on a couple of EGR solutions and it</font>

782
00:32:44,140 --> 00:32:52,030
goes through<font color="#CCCCCC"> defender trees ADR</font>

783
00:32:47,740 --> 00:32:53,860
solutions so if you properly<font color="#E5E5E5"> instrument</font>

784
00:32:52,030 --> 00:32:55,690
your payloads<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> get by</font><font color="#CCCCCC"> it the</font>

785
00:32:53,860 --> 00:32:56,860
problem is<font color="#E5E5E5"> like if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> start doing if</font>

786
00:32:55,690 --> 00:32:58,690
you start injecting shell going<font color="#CCCCCC"> and</font>

787
00:32:56,860 --> 00:33:01,179
<font color="#E5E5E5">stuff and you're using the standard</font>

788
00:32:58,690 --> 00:33:06,120
win32 API calls<font color="#CCCCCC"> that you usually run</font>

789
00:33:01,180 --> 00:33:08,350
like reflectively inject yellows or or

790
00:33:06,120 --> 00:33:09,969
<font color="#CCCCCC">rejects</font><font color="#E5E5E5"> shell code like obviously that</font>

791
00:33:08,350 --> 00:33:11,590
that's from<font color="#E5E5E5"> heuristic standpoint that's</font>

792
00:33:09,970 --> 00:33:15,490
easy to catch<font color="#E5E5E5"> so if you properly</font>

793
00:33:11,590 --> 00:33:16,899
instrument<font color="#E5E5E5"> your arm Python payloads it</font>

794
00:33:15,490 --> 00:33:20,080
just flies<font color="#E5E5E5"> by everything yes this</font><font color="#CCCCCC"> you're</font>

795
00:33:16,900 --> 00:33:22,360
<font color="#CCCCCC">off its</font><font color="#E5E5E5"> the CLR</font>

796
00:33:20,080 --> 00:33:23,710
<font color="#CCCCCC">I don't even know about the</font><font color="#E5E5E5"> dealer like</font>

797
00:33:22,360 --> 00:33:25,090
I'm assuming<font color="#CCCCCC"> like if you instrument</font>

798
00:33:23,710 --> 00:33:27,040
optics into<font color="#CCCCCC"> the skill are should</font>

799
00:33:25,090 --> 00:33:28,449
automatically just give you access to

800
00:33:27,040 --> 00:33:32,430
the<font color="#CCCCCC"> DLR</font>

801
00:33:28,450 --> 00:33:35,650
because I don't know enough<font color="#CCCCCC"> about it</font><font color="#E5E5E5"> to</font>

802
00:33:32,430 --> 00:33:37,870
<font color="#CCCCCC">make that</font><font color="#E5E5E5"> conclusion massive amounts of</font>

803
00:33:35,650 --> 00:33:39,520
reflection which is<font color="#E5E5E5"> amazing from a red</font>

804
00:33:37,870 --> 00:33:41,199
<font color="#E5E5E5">team point of view because that means</font>

805
00:33:39,520 --> 00:33:43,060
more<font color="#CCCCCC"> engagement for us right so the more</font>

806
00:33:41,200 --> 00:33:44,710
reflection is<font color="#E5E5E5"> the better</font>

807
00:33:43,060 --> 00:33:46,510
payload is decoupled<font color="#CCCCCC"> from execution</font>

808
00:33:44,710 --> 00:33:47,090
<font color="#E5E5E5">which means that you can</font><font color="#CCCCCC"> just like for</font>

809
00:33:46,510 --> 00:33:49,730
example what

810
00:33:47,090 --> 00:33:51,110
the sub<font color="#CCCCCC"> T's whitelisting bypasses that</font>

811
00:33:49,730 --> 00:33:53,570
<font color="#CCCCCC">he's been putting on</font><font color="#E5E5E5"> here something</font><font color="#CCCCCC"> like</font>

812
00:33:51,110 --> 00:33:57,320
<font color="#CCCCCC">Danis build one which works great on a</font>

813
00:33:53,570 --> 00:33:59,510
number of<font color="#CCCCCC"> white</font><font color="#E5E5E5"> listing solutions the</font>

814
00:33:57,320 --> 00:34:01,879
gate goes by those and you can<font color="#CCCCCC"> have</font>

815
00:33:59,510 --> 00:34:03,800
become the logic of<font color="#CCCCCC"> your payload</font>

816
00:34:01,880 --> 00:34:05,480
completely decoupled from<font color="#CCCCCC"> your actual</font>

817
00:34:03,800 --> 00:34:08,750
standard which<font color="#E5E5E5"> is great and you're</font>

818
00:34:05,480 --> 00:34:10,969
<font color="#CCCCCC">actually the logic does not</font><font color="#E5E5E5"> reside in</font>

819
00:34:08,750 --> 00:34:13,580
memory<font color="#E5E5E5"> that the only resides a member</font>

820
00:34:10,969 --> 00:34:15,560
gather sorry<font color="#CCCCCC"> not touch this so you have</font>

821
00:34:13,580 --> 00:34:17,270
<font color="#CCCCCC">a c-sharp minor' a in that state so and</font>

822
00:34:15,560 --> 00:34:19,900
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> tool</font><font color="#CCCCCC"> son eternity that</font>

823
00:34:17,270 --> 00:34:22,610
basically the actual Python<font color="#CCCCCC"> project of</font>

824
00:34:19,900 --> 00:34:25,400
the payload<font color="#CCCCCC"> it's staged over</font><font color="#E5E5E5"> the network</font>

825
00:34:22,610 --> 00:34:27,200
<font color="#CCCCCC">so if you the blue team</font><font color="#E5E5E5"> for example went</font>

826
00:34:25,400 --> 00:34:29,600
to decompile the<font color="#E5E5E5"> actual c-sharp binary</font>

827
00:34:27,199 --> 00:34:32,449
they would<font color="#CCCCCC"> only see HTTP calls or</font>

828
00:34:29,600 --> 00:34:34,279
whatever<font color="#CCCCCC"> College is to</font><font color="#E5E5E5"> use to a certain</font>

829
00:34:32,449 --> 00:34:36,830
URL like the actual<font color="#E5E5E5"> logic that the</font>

830
00:34:34,280 --> 00:34:39,080
payload is not in the<font color="#E5E5E5"> c-sharp minor</font>

831
00:34:36,830 --> 00:34:40,850
because it's staged at runtime<font color="#E5E5E5"> over the</font>

832
00:34:39,080 --> 00:34:42,920
network<font color="#E5E5E5"> which is it</font><font color="#CCCCCC"> amazing right</font>

833
00:34:40,850 --> 00:34:45,920
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not adding in scriptable</font>

834
00:34:42,920 --> 00:34:48,500
<font color="#CCCCCC">which means more productivity</font><font color="#E5E5E5"> than grant</font>

835
00:34:45,920 --> 00:34:49,850
teams and you don't have<font color="#E5E5E5"> to compile your</font>

836
00:34:48,500 --> 00:34:52,010
stuff all the time

837
00:34:49,850 --> 00:34:53,569
<font color="#E5E5E5">and if you're sending it dot pi file</font>

838
00:34:52,010 --> 00:34:55,460
whatever<font color="#E5E5E5"> that's really all it is like</font>

839
00:34:53,570 --> 00:34:57,650
you're<font color="#E5E5E5"> just sending a Python source file</font>

840
00:34:55,460 --> 00:35:00,170
<font color="#E5E5E5">the network which is which is text and</font>

841
00:34:57,650 --> 00:35:02,510
it's<font color="#E5E5E5"> pretty awesome and it's about</font><font color="#CCCCCC"> night</font>

842
00:35:00,170 --> 00:35:03,980
<font color="#E5E5E5">assembly right so</font><font color="#CCCCCC"> which means</font><font color="#E5E5E5"> that it's</font>

843
00:35:02,510 --> 00:35:05,780
extremely<font color="#E5E5E5"> flexible in the way</font><font color="#CCCCCC"> you can</font>

844
00:35:03,980 --> 00:35:08,720
<font color="#E5E5E5">stage this like you can stay</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> being</font>

845
00:35:05,780 --> 00:35:09,890
done at<font color="#CCCCCC"> the</font><font color="#E5E5E5"> J SMS build like all the all</font>

846
00:35:08,720 --> 00:35:12,560
the stuff<font color="#CCCCCC"> that's been</font><font color="#E5E5E5"> coming out</font>

847
00:35:09,890 --> 00:35:14,870
<font color="#E5E5E5">recently and since each job</font>

848
00:35:12,560 --> 00:35:15,440
<font color="#CCCCCC">quote-unquote runs it and</font><font color="#E5E5E5"> its own</font>

849
00:35:14,870 --> 00:35:16,880
<font color="#CCCCCC">isolated</font>

850
00:35:15,440 --> 00:35:19,100
ironpython engine<font color="#E5E5E5"> although the</font>

851
00:35:16,880 --> 00:35:20,630
<font color="#E5E5E5">assemblies</font><font color="#CCCCCC"> that it needs get</font>

852
00:35:19,100 --> 00:35:25,880
automatically unloaded afterwards so

853
00:35:20,630 --> 00:35:27,110
it's<font color="#CCCCCC"> stuff that you memorize and again</font>

854
00:35:25,880 --> 00:35:29,120
like<font color="#CCCCCC"> the great thing about this is you</font>

855
00:35:27,110 --> 00:35:30,500
<font color="#E5E5E5">can easily pour it over most of the</font>

856
00:35:29,120 --> 00:35:33,200
<font color="#CCCCCC">sea-shore tooling that's been</font><font color="#E5E5E5"> coming out</font>

857
00:35:30,500 --> 00:35:34,760
<font color="#E5E5E5">recently directly to</font><font color="#CCCCCC"> our eyes on very</font>

858
00:35:33,200 --> 00:35:37,759
few<font color="#CCCCCC"> changes hell you can like move</font><font color="#E5E5E5"> like</font>

859
00:35:34,760 --> 00:35:39,950
this<font color="#CCCCCC"> one module which injects</font><font color="#E5E5E5"> shellcode</font>

860
00:35:37,760 --> 00:35:43,760
<font color="#E5E5E5">MSI also code injection which hopefully</font>

861
00:35:39,950 --> 00:35:46,189
will work<font color="#CCCCCC"> we'll see</font><font color="#E5E5E5"> now show you in a</font>

862
00:35:43,760 --> 00:35:48,860
second which just basically<font color="#E5E5E5"> I copied the</font>

863
00:35:46,190 --> 00:35:50,810
source code for<font color="#E5E5E5"> XOR ears</font>

864
00:35:48,860 --> 00:35:52,760
<font color="#E5E5E5">c-sharp version of this put in an arm</font>

865
00:35:50,810 --> 00:35:54,860
<font color="#CCCCCC">Python file called to generate</font><font color="#E5E5E5"> function</font>

866
00:35:52,760 --> 00:35:57,440
<font color="#CCCCCC">and just</font><font color="#E5E5E5"> works like</font><font color="#CCCCCC"> a you didn't</font><font color="#E5E5E5"> even</font>

867
00:35:54,860 --> 00:35:58,820
have<font color="#E5E5E5"> to pour</font><font color="#CCCCCC"> it over if you want but I</font>

868
00:35:57,440 --> 00:35:59,960
guess you know it would be<font color="#E5E5E5"> a little bit</font>

869
00:35:58,820 --> 00:36:02,720
more stealthy since

870
00:35:59,960 --> 00:36:09,010
compiling c-sharp<font color="#E5E5E5"> through ironpython</font>

871
00:36:02,720 --> 00:36:11,750
<font color="#CCCCCC">leaves stuff on this so the whole time</font>

872
00:36:09,010 --> 00:36:22,789
<font color="#CCCCCC">it's all</font><font color="#E5E5E5"> worship the devil</font><font color="#CCCCCC"> guys</font><font color="#E5E5E5"> right</font>

873
00:36:11,750 --> 00:36:25,430
now<font color="#E5E5E5"> okay so I wanted</font><font color="#CCCCCC"> to build</font><font color="#E5E5E5"> something</font>

874
00:36:22,789 --> 00:36:27,020
<font color="#E5E5E5">this took a while to build this is</font>

875
00:36:25,430 --> 00:36:28,730
actually not what I wanted<font color="#E5E5E5"> to release</font><font color="#CCCCCC"> I</font>

876
00:36:27,020 --> 00:36:30,770
was actually working on<font color="#E5E5E5"> a team server</font>

877
00:36:28,730 --> 00:36:33,470
implementation of<font color="#CCCCCC"> this because I'm</font>

878
00:36:30,770 --> 00:36:34,910
really<font color="#CCCCCC"> tired of stuff that can't</font><font color="#E5E5E5"> really</font>

879
00:36:33,470 --> 00:36:36,709
show<font color="#CCCCCC"> shell because you know</font><font color="#E5E5E5"> red team's</font>

880
00:36:34,910 --> 00:36:38,509
like you<font color="#E5E5E5"> you collaborate with</font><font color="#CCCCCC"> other</font>

881
00:36:36,710 --> 00:36:40,099
people<font color="#CCCCCC"> but I hadn't been</font><font color="#E5E5E5"> finished</font><font color="#CCCCCC"> in</font>

882
00:36:38,510 --> 00:36:43,700
<font color="#E5E5E5">time so I'm releasing only the</font>

883
00:36:40,099 --> 00:36:46,819
standalone<font color="#CCCCCC"> version of this</font><font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is</font>

884
00:36:43,700 --> 00:36:49,788
silent trimming<font color="#E5E5E5"> and it's basically the</font>

885
00:36:46,819 --> 00:36:52,400
<font color="#E5E5E5">server side certain Python</font><font color="#CCCCCC"> Python 3</font><font color="#E5E5E5"> and</font>

886
00:36:49,789 --> 00:36:54,680
it's got<font color="#E5E5E5"> some really modern UI features</font>

887
00:36:52,400 --> 00:36:56,599
which I really desperately wanted in<font color="#CCCCCC"> one</font>

888
00:36:54,680 --> 00:36:58,098
of these frameworks<font color="#CCCCCC"> it supports a</font>

889
00:36:56,599 --> 00:37:00,049
resources every source files which

890
00:36:58,099 --> 00:37:02,180
is<font color="#E5E5E5"> what I just did I died</font><font color="#CCCCCC"> just tacked on</font>

891
00:37:00,049 --> 00:37:03,890
- are<font color="#CCCCCC"> given a resource file and it</font>

892
00:37:02,180 --> 00:37:06,589
automatically runs whatever commands<font color="#E5E5E5"> are</font>

893
00:37:03,890 --> 00:37:07,970
<font color="#E5E5E5">in the resource file it's got some</font>

894
00:37:06,589 --> 00:37:10,430
really cool<font color="#CCCCCC"> auto completion features</font>

895
00:37:07,970 --> 00:37:12,799
like<font color="#E5E5E5"> that that's kind of cool it shows</font>

896
00:37:10,430 --> 00:37:30,609
you<font color="#CCCCCC"> all the all the in commands that you</font>

897
00:37:12,799 --> 00:37:33,079
<font color="#E5E5E5">had are available I'm gonna okay</font><font color="#CCCCCC"> so</font>

898
00:37:30,609 --> 00:37:36,650
<font color="#E5E5E5">there</font><font color="#CCCCCC"> are a couple of stages</font><font color="#E5E5E5"> implemented</font>

899
00:37:33,079 --> 00:37:39,170
within<font color="#E5E5E5"> sign eternity right now there's</font>

900
00:37:36,650 --> 00:37:42,650
the women stager which dynamically

901
00:37:39,170 --> 00:37:45,200
injects the<font color="#CCCCCC"> c-sharp</font><font color="#E5E5E5"> assembly is an</font>

902
00:37:42,650 --> 00:37:49,549
eternity assembly using that meant<font color="#E5E5E5"> to</font>

903
00:37:45,200 --> 00:37:51,828
<font color="#CCCCCC">j/s with XSL with</font><font color="#E5E5E5"> excel files using</font>

904
00:37:49,549 --> 00:37:54,799
women<font color="#E5E5E5"> which is one of these methods and</font>

905
00:37:51,829 --> 00:37:57,799
there's the<font color="#CCCCCC"> msbuild</font><font color="#E5E5E5"> method which stages</font>

906
00:37:54,799 --> 00:37:59,809
at the<font color="#E5E5E5"> aniline c-sharp</font><font color="#CCCCCC"> tasks</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> MS</font>

907
00:37:57,799 --> 00:38:01,940
bill<font color="#CCCCCC"> I'm gonna</font><font color="#E5E5E5"> show you that one</font><font color="#CCCCCC"> I</font>

908
00:37:59,809 --> 00:38:03,460
already generated one because I<font color="#E5E5E5"> don't</font>

909
00:38:01,940 --> 00:38:09,460
trust the<font color="#E5E5E5"> demagogues enough to do this</font>

910
00:38:03,460 --> 00:38:13,650
twice so<font color="#CCCCCC"> and I put it on the VM and now</font>

911
00:38:09,460 --> 00:38:16,780
executed<font color="#CCCCCC"> so I'm</font><font color="#E5E5E5"> just calling msbuild</font>

912
00:38:13,650 --> 00:38:20,589
sexy<font color="#E5E5E5"> giving it the XML file that</font><font color="#CCCCCC"> I have</font>

913
00:38:16,780 --> 00:38:24,369
in the VM and I'm gonna<font color="#E5E5E5"> read this to you</font>

914
00:38:20,589 --> 00:38:30,339
so<font color="#E5E5E5"> because I'm assuming it's not</font><font color="#CCCCCC"> had</font>

915
00:38:24,369 --> 00:38:32,320
this<font color="#CCCCCC"> so we give it a URL in the in the</font>

916
00:38:30,339 --> 00:38:34,680
XML that<font color="#E5E5E5"> it generates it already has the</font>

917
00:38:32,320 --> 00:38:38,170
<font color="#CCCCCC">URL you see two</font><font color="#E5E5E5"> server and the channel</font>

918
00:38:34,680 --> 00:38:41,859
<font color="#E5E5E5">it downloaded the stage which</font><font color="#CCCCCC"> is a zip</font>

919
00:38:38,170 --> 00:38:46,900
file<font color="#CCCCCC"> containing the ironpython dll's</font>

920
00:38:41,859 --> 00:38:48,910
and the main dot<font color="#CCCCCC"> PI</font><font color="#E5E5E5"> source code I'm by</font>

921
00:38:46,900 --> 00:38:51,790
that source code<font color="#CCCCCC"> that that's your actual</font>

922
00:38:48,910 --> 00:38:53,799
payload logic<font color="#E5E5E5"> right and then</font>

923
00:38:51,790 --> 00:38:56,320
<font color="#E5E5E5">automatically resolved all of the</font>

924
00:38:53,800 --> 00:38:59,680
assemblies<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it needed from the zip</font>

925
00:38:56,320 --> 00:39:02,230
file and then<font color="#E5E5E5"> it executed the main dot</font>

926
00:38:59,680 --> 00:39:06,009
<font color="#CCCCCC">pi file in a</font><font color="#E5E5E5"> zip file hopefully that</font>

927
00:39:02,230 --> 00:39:10,030
makes sense<font color="#CCCCCC"> and from there you have a</font>

928
00:39:06,010 --> 00:39:14,020
session and it shows<font color="#CCCCCC"> you nice and pretty</font>

929
00:39:10,030 --> 00:39:16,240
<font color="#E5E5E5">like UI and now you literally have a</font>

930
00:39:14,020 --> 00:39:17,890
scripted access to that<font color="#CCCCCC"> so I'm going to</font>

931
00:39:16,240 --> 00:39:22,750
show you<font color="#E5E5E5"> some couple of things real</font>

932
00:39:17,890 --> 00:39:25,690
quick<font color="#E5E5E5"> so the modules right now fonts</font>

933
00:39:22,750 --> 00:39:29,170
pretty<font color="#E5E5E5"> big they're only a handful of</font>

934
00:39:25,690 --> 00:39:31,830
modules because I was<font color="#E5E5E5"> impressed I</font><font color="#CCCCCC"> was</font>

935
00:39:29,170 --> 00:39:35,770
just<font color="#E5E5E5"> excited that</font><font color="#CCCCCC"> this works let alone</font>

936
00:39:31,830 --> 00:39:36,940
<font color="#CCCCCC">finishing in time for a talk so there's</font>

937
00:39:35,770 --> 00:39:38,410
a message box which I'll show<font color="#E5E5E5"> you the</font>

938
00:39:36,940 --> 00:39:39,369
<font color="#E5E5E5">first because it sort of shows</font><font color="#CCCCCC"> you some</font>

939
00:39:38,410 --> 00:39:43,420
<font color="#CCCCCC">of the capabilities of</font><font color="#E5E5E5"> this</font>

940
00:39:39,369 --> 00:39:47,200
there's the<font color="#E5E5E5"> power module which executes</font>

941
00:39:43,420 --> 00:39:48,640
arbitrary power shell but purpose of

942
00:39:47,200 --> 00:39:50,560
this whole tool but I<font color="#E5E5E5"> thought I'd put it</font>

943
00:39:48,640 --> 00:39:53,080
in there<font color="#E5E5E5"> because you can call PowerShell</font>

944
00:39:50,560 --> 00:39:54,359
from<font color="#CCCCCC"> Monty Python but feeds</font><font color="#E5E5E5"> the purpose</font>

945
00:39:53,080 --> 00:39:56,770
of using this in the first place

946
00:39:54,359 --> 00:39:58,119
<font color="#E5E5E5">Ashoka man there's</font><font color="#CCCCCC"> many cats which is</font>

947
00:39:56,770 --> 00:40:01,150
awesome and<font color="#CCCCCC"> I can't</font><font color="#E5E5E5"> believe that</font><font color="#CCCCCC"> even</font>

948
00:39:58,119 --> 00:40:03,900
<font color="#CCCCCC">works Excel shell</font><font color="#E5E5E5"> inject which I told</font>

949
00:40:01,150 --> 00:40:08,349
<font color="#E5E5E5">you the earlier injects shell code via</font>

950
00:40:03,900 --> 00:40:09,700
<font color="#CCCCCC">Excel objects and the MSI of shell code</font>

951
00:40:08,349 --> 00:40:12,700
injection which is basically important

952
00:40:09,700 --> 00:40:14,230
of<font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> grievers and exteriors technique</font>

953
00:40:12,700 --> 00:40:17,740
of basically executing shell code via

954
00:40:14,230 --> 00:40:18,849
crafted and missile<font color="#CCCCCC"> op codes and</font><font color="#E5E5E5"> it</font>

955
00:40:17,740 --> 00:40:19,450
doesn't call and the great thing about

956
00:40:18,849 --> 00:40:20,350
this

957
00:40:19,450 --> 00:40:22,359
is that it doesn't<font color="#CCCCCC"> call the standard</font>

958
00:40:20,350 --> 00:40:24,580
<font color="#E5E5E5">win32</font><font color="#CCCCCC"> API calls</font><font color="#E5E5E5"> associated with</font>

959
00:40:22,360 --> 00:40:28,510
chocolate injection so it goes by a lot

960
00:40:24,580 --> 00:40:30,009
<font color="#CCCCCC">of stuff and and the execute assembly</font>

961
00:40:28,510 --> 00:40:30,970
mantra which is awesome<font color="#E5E5E5"> too</font>

962
00:40:30,010 --> 00:40:31,930
so I'm going<font color="#CCCCCC"> to show</font><font color="#E5E5E5"> you the first</font><font color="#CCCCCC"> thing</font>

963
00:40:30,970 --> 00:40:34,029
I want to<font color="#E5E5E5"> show you is the message box</font>

964
00:40:31,930 --> 00:40:36,009
one because it demonstrates really

965
00:40:34,030 --> 00:40:41,710
<font color="#E5E5E5">easily a lot of capabilities of this so</font>

966
00:40:36,010 --> 00:40:44,110
use box<font color="#E5E5E5"> options and all modules require</font>

967
00:40:41,710 --> 00:40:46,120
a set of<font color="#E5E5E5"> options this case this is</font><font color="#CCCCCC"> gonna</font>

968
00:40:44,110 --> 00:40:50,920
problem message box once you have a

969
00:40:46,120 --> 00:40:53,440
<font color="#E5E5E5">session which we have here and I sort of</font>

970
00:40:50,920 --> 00:40:55,780
modeled it I'm<font color="#CCCCCC"> not like I tried to build</font>

971
00:40:53,440 --> 00:40:56,890
<font color="#CCCCCC">this against like</font><font color="#E5E5E5"> Empire and Menace</font>

972
00:40:55,780 --> 00:40:58,390
<font color="#CCCCCC">planets so like some of the features of</font>

973
00:40:56,890 --> 00:41:02,259
<font color="#CCCCCC">Metasploit some of the features</font><font color="#E5E5E5"> are</font>

974
00:40:58,390 --> 00:41:03,400
<font color="#CCCCCC">Empire are in this</font><font color="#E5E5E5"> framework as well so</font>

975
00:41:02,260 --> 00:41:04,870
in the great but the great<font color="#CCCCCC"> thing about</font>

976
00:41:03,400 --> 00:41:06,580
<font color="#E5E5E5">silent rarity is that actually had it</font>

977
00:41:04,870 --> 00:41:08,200
tells you the last<font color="#CCCCCC"> check-in</font><font color="#E5E5E5"> time so like</font>

978
00:41:06,580 --> 00:41:09,460
cobalt strike I tried to model this

979
00:41:08,200 --> 00:41:10,750
<font color="#E5E5E5">against global strike two</font>

980
00:41:09,460 --> 00:41:14,110
so it has the last<font color="#E5E5E5"> check</font><font color="#CCCCCC"> of time which</font>

981
00:41:10,750 --> 00:41:17,530
is<font color="#E5E5E5"> really really useful</font><font color="#CCCCCC"> so I just</font>

982
00:41:14,110 --> 00:41:19,060
<font color="#CCCCCC">executed</font><font color="#E5E5E5"> is message box function this</font>

983
00:41:17,530 --> 00:41:20,680
message<font color="#CCCCCC"> marks Mago</font><font color="#E5E5E5"> and you can do</font>

984
00:41:19,060 --> 00:41:22,060
<font color="#E5E5E5">retinol</font><font color="#CCCCCC"> to run</font><font color="#E5E5E5"> this module against all</font>

985
00:41:20,680 --> 00:41:28,870
sessions but I'd<font color="#E5E5E5"> only</font><font color="#CCCCCC"> have one session</font>

986
00:41:22,060 --> 00:41:30,790
now so obviously this is<font color="#CCCCCC"> only here</font><font color="#E5E5E5"> so</font>

987
00:41:28,870 --> 00:41:35,700
there<font color="#E5E5E5"> you go message</font><font color="#CCCCCC"> so that's it's</font>

988
00:41:30,790 --> 00:41:35,700
<font color="#CCCCCC">really boring</font><font color="#E5E5E5"> but how about this run all</font>

989
00:41:38,510 --> 00:41:41,599
[Music]

990
00:41:42,180 --> 00:41:46,240
there you go<font color="#E5E5E5"> there you go so that's</font>

991
00:41:44,290 --> 00:41:48,640
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to do</font><font color="#CCCCCC"> five times</font><font color="#E5E5E5"> so since we</font>

992
00:41:46,240 --> 00:41:50,649
<font color="#E5E5E5">access</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> can make the client</font>

993
00:41:48,640 --> 00:41:52,480
completely<font color="#E5E5E5"> asynchronous</font><font color="#CCCCCC"> so if you want</font>

994
00:41:50,650 --> 00:41:54,640
you can just stage<font color="#E5E5E5"> you could just hit</font>

995
00:41:52,480 --> 00:41:56,500
run all like you can stage<font color="#E5E5E5"> jobs</font><font color="#CCCCCC"> it'll</font>

996
00:41:54,640 --> 00:42:02,890
<font color="#E5E5E5">put them in a queue and then every time</font>

997
00:41:56,500 --> 00:42:04,420
the<font color="#E5E5E5"> the actual calls back</font><font color="#CCCCCC"> it'll just</font>

998
00:42:02,890 --> 00:42:05,859
<font color="#E5E5E5">execute the jobs that you queued up</font>

999
00:42:04,420 --> 00:42:07,620
<font color="#E5E5E5">which i think is pretty</font><font color="#CCCCCC"> cool so it's</font>

1000
00:42:05,860 --> 00:42:10,300
sort of like<font color="#E5E5E5"> cold strike in that way and</font>

1001
00:42:07,620 --> 00:42:12,549
the actual and the<font color="#CCCCCC"> great thing about</font>

1002
00:42:10,300 --> 00:42:15,970
that<font color="#CCCCCC"> too is</font><font color="#E5E5E5"> that whenever it's almost</font>

1003
00:42:12,550 --> 00:42:17,440
like<font color="#CCCCCC"> real-time results so like the</font>

1004
00:42:15,970 --> 00:42:19,270
minute<font color="#E5E5E5"> you've hit</font><font color="#CCCCCC"> okay like it sends the</font>

1005
00:42:17,440 --> 00:42:20,860
results back<font color="#E5E5E5"> because the dead call a</font>

1006
00:42:19,270 --> 00:42:22,900
message<font color="#CCCCCC"> over boxes of blocking function</font>

1007
00:42:20,860 --> 00:42:25,030
<font color="#E5E5E5">each job gets running at separate net</font>

1008
00:42:22,900 --> 00:42:26,680
thread<font color="#CCCCCC"> so every time</font><font color="#E5E5E5"> you hit okay it</font>

1009
00:42:25,030 --> 00:42:27,520
<font color="#CCCCCC">just returns a function and in this case</font>

1010
00:42:26,680 --> 00:42:30,250
<font color="#E5E5E5">we're</font><font color="#CCCCCC"> just with pretty</font>

1011
00:42:27,520 --> 00:42:31,750
back to the server<font color="#CCCCCC"> alright so let's</font>

1012
00:42:30,250 --> 00:42:33,180
actually look at something interesting

1013
00:42:31,750 --> 00:42:35,560
<font color="#E5E5E5">now right</font>

1014
00:42:33,180 --> 00:42:37,720
so there is the execute assembly

1015
00:42:35,560 --> 00:42:39,190
function and this<font color="#E5E5E5"> is awesome so all the</font>

1016
00:42:37,720 --> 00:42:41,770
C sharp<font color="#E5E5E5"> stuff that's been coming out</font>

1017
00:42:39,190 --> 00:42:43,840
recently<font color="#E5E5E5"> you don't even if you really</font>

1018
00:42:41,770 --> 00:42:45,580
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> put it</font><font color="#CCCCCC"> over to ironpython</font>

1019
00:42:43,840 --> 00:42:46,900
or<font color="#CCCCCC"> Mike</font><font color="#E5E5E5"> modules for this you can just</font>

1020
00:42:45,580 --> 00:42:49,150
just compile that<font color="#CCCCCC"> and run it through</font>

1021
00:42:46,900 --> 00:42:54,970
silent charity<font color="#E5E5E5"> so let's take a look at</font>

1022
00:42:49,150 --> 00:42:57,010
that<font color="#E5E5E5"> execute the actual module names</font>

1023
00:42:54,970 --> 00:42:58,689
aren't<font color="#CCCCCC"> auto-completed</font><font color="#E5E5E5"> yet but I can fix</font>

1024
00:42:57,010 --> 00:43:00,790
that

1025
00:42:58,690 --> 00:43:02,860
and all<font color="#E5E5E5"> this</font><font color="#CCCCCC"> moment acquires is</font><font color="#E5E5E5"> the</font>

1026
00:43:00,790 --> 00:43:06,460
assembly path and the arguments you want

1027
00:43:02,860 --> 00:43:14,860
<font color="#E5E5E5">assembly to</font><font color="#CCCCCC"> pass the</font><font color="#E5E5E5"> assembly right so</font>

1028
00:43:06,460 --> 00:43:18,820
set assembly and in<font color="#E5E5E5"> this case I had a</font>

1029
00:43:14,860 --> 00:43:20,650
pre compiled version of<font color="#E5E5E5"> seat belt here</font>

1030
00:43:18,820 --> 00:43:25,570
and if you have<font color="#E5E5E5"> familiar she felt just</font>

1031
00:43:20,650 --> 00:43:27,250
like<font color="#E5E5E5"> a bunch of checks</font><font color="#CCCCCC"> it's an issue</font><font color="#E5E5E5"> a</font>

1032
00:43:25,570 --> 00:43:30,490
lot<font color="#E5E5E5"> of situation awareness situation</font>

1033
00:43:27,250 --> 00:43:35,170
awareness<font color="#CCCCCC"> inspection Ops guys</font><font color="#E5E5E5"> and I'm</font>

1034
00:43:30,490 --> 00:43:38,259
just<font color="#CCCCCC"> gonna run this</font><font color="#E5E5E5"> real quick there you</font>

1035
00:43:35,170 --> 00:43:44,470
go so this is the<font color="#CCCCCC"> output</font><font color="#E5E5E5"> from seat belt</font>

1036
00:43:38,260 --> 00:43:47,440
<font color="#E5E5E5">and this is</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> it stage</font><font color="#CCCCCC"> D assembly</font><font color="#E5E5E5"> over</font>

1037
00:43:44,470 --> 00:43:50,410
<font color="#E5E5E5">the network encoded in base64</font><font color="#CCCCCC"> executor</font>

1038
00:43:47,440 --> 00:43:51,940
<font color="#CCCCCC">TIF memory and</font><font color="#E5E5E5"> sent back the</font><font color="#CCCCCC"> output so I</font>

1039
00:43:50,410 --> 00:44:06,910
didn't<font color="#E5E5E5"> really give it any options here</font>

1040
00:43:51,940 --> 00:44:08,680
let's say<font color="#CCCCCC"> users</font><font color="#E5E5E5"> there you go so that's</font>

1041
00:44:06,910 --> 00:44:10,930
the<font color="#CCCCCC"> output of</font><font color="#E5E5E5"> seat belt and I just told</font>

1042
00:44:08,680 --> 00:44:14,169
it to run the hall the user<font color="#CCCCCC"> triage</font>

1043
00:44:10,930 --> 00:44:16,870
checks and that's awesome<font color="#CCCCCC"> right so you</font>

1044
00:44:14,170 --> 00:44:19,630
can dynamically<font color="#E5E5E5"> execute assembly sort of</font>

1045
00:44:16,870 --> 00:44:22,359
like<font color="#E5E5E5"> hope</font><font color="#CCCCCC"> won't strike through c-sharp</font>

1046
00:44:19,630 --> 00:44:25,470
<font color="#E5E5E5">through and ironpython engine through</font>

1047
00:44:22,360 --> 00:44:28,820
another<font color="#E5E5E5"> midnight my</font><font color="#CCCCCC"> intentions</font>

1048
00:44:25,470 --> 00:44:28,819
[Applause]

1049
00:44:35,270 --> 00:44:41,509
and I'm putting<font color="#E5E5E5"> by the time having</font>

1050
00:44:38,040 --> 00:44:43,980
<font color="#E5E5E5">pushing my luck here but how much</font><font color="#CCCCCC"> time</font>

1051
00:44:41,510 --> 00:44:50,760
but<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> want to show this and</font><font color="#E5E5E5"> then I</font>

1052
00:44:43,980 --> 00:45:02,340
<font color="#E5E5E5">am done</font><font color="#CCCCCC"> that's all we all want to run</font>

1053
00:44:50,760 --> 00:45:04,610
<font color="#CCCCCC">meeting against right Lucy I should go</font>

1054
00:45:02,340 --> 00:45:36,360
<font color="#E5E5E5">inside UNC but as is here</font>

1055
00:45:04,610 --> 00:45:38,910
there you<font color="#E5E5E5"> go okay okay so I just</font>

1056
00:45:36,360 --> 00:45:40,200
executed<font color="#E5E5E5"> the</font><font color="#CCCCCC"> msbuild</font><font color="#E5E5E5"> file again</font><font color="#CCCCCC"> it's</font>

1057
00:45:38,910 --> 00:45:42,089
<font color="#E5E5E5">admin so that I can actually show you</font>

1058
00:45:40,200 --> 00:45:45,120
mean it gets<font color="#CCCCCC"> I am again</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the session</font>

1059
00:45:42,090 --> 00:45:47,640
connected if we go to the sessions<font color="#E5E5E5"> list</font>

1060
00:45:45,120 --> 00:45:49,650
them out<font color="#CCCCCC"> it's sort of like Empire so</font>

1061
00:45:47,640 --> 00:45:51,299
<font color="#E5E5E5">you'll be at home here it'll give</font><font color="#CCCCCC"> you</font>

1062
00:45:49,650 --> 00:45:52,680
like a<font color="#E5E5E5"> little asterisk and put the</font>

1063
00:45:51,300 --> 00:45:54,900
<font color="#CCCCCC">username</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know you're</font><font color="#CCCCCC"> putting in</font>

1064
00:45:52,680 --> 00:46:02,759
<font color="#CCCCCC">high integrity context</font><font color="#E5E5E5"> you can then go</font>

1065
00:45:54,900 --> 00:46:14,220
over to modules list<font color="#E5E5E5"> use</font><font color="#CCCCCC"> against options</font>

1066
00:46:02,760 --> 00:46:16,160
run and there you go so just to recap

1067
00:46:14,220 --> 00:46:20,640
here

1068
00:46:16,160 --> 00:46:22,859
we dynamically we run<font color="#CCCCCC"> Mimi cat's</font>

1069
00:46:20,640 --> 00:46:25,589
completely a memory<font color="#E5E5E5"> diversity sharp I</font>

1070
00:46:22,860 --> 00:46:27,630
<font color="#E5E5E5">don't do</font><font color="#CCCCCC"> an iPad 102 in a better than I</font>

1071
00:46:25,590 --> 00:46:30,150
<font color="#E5E5E5">revived on engine</font><font color="#CCCCCC"> by reflectively</font>

1072
00:46:27,630 --> 00:46:32,450
loading and assembly<font color="#E5E5E5"> that injects</font><font color="#CCCCCC"> me</font>

1073
00:46:30,150 --> 00:46:32,450
handsome

1074
00:46:34,010 --> 00:46:37,449
[Applause]

1075
00:46:43,109 --> 00:46:48,609
just to show you<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> not cheating</font>

1076
00:46:45,819 --> 00:47:05,920
here<font color="#E5E5E5"> this has been turned</font><font color="#CCCCCC"> on the entire</font>

1077
00:46:48,609 --> 00:47:07,359
time okay<font color="#CCCCCC"> okay oh</font><font color="#E5E5E5"> okay yeah I guess I'm</font>

1078
00:47:05,920 --> 00:47:07,790
hoping for vanilla ice I forgot about

1079
00:47:07,359 --> 00:47:09,720
<font color="#E5E5E5">that</font>

1080
00:47:07,790 --> 00:47:12,520
[Music]

1081
00:47:09,720 --> 00:47:13,808
you have three minutes<font color="#CCCCCC"> okay I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

1082
00:47:12,520 --> 00:47:17,130
<font color="#E5E5E5">try to get this back to presentation</font>

1083
00:47:13,809 --> 00:47:17,130
<font color="#E5E5E5">much as possible</font>

1084
00:47:17,280 --> 00:47:25,059
<font color="#CCCCCC">does this</font><font color="#E5E5E5"> work yes okay let's</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> about</font>

1085
00:47:21,970 --> 00:47:26,200
<font color="#E5E5E5">detection real quick because yeah</font>

1086
00:47:25,059 --> 00:47:30,339
thermal protection

1087
00:47:26,200 --> 00:47:32,470
so unfortunately<font color="#E5E5E5"> because they're not</font>

1088
00:47:30,339 --> 00:47:35,109
there's no optics into<font color="#E5E5E5"> the CLR the</font><font color="#CCCCCC"> deal</font>

1089
00:47:32,470 --> 00:47:37,118
<font color="#CCCCCC">are the only real and</font><font color="#E5E5E5"> I've run</font><font color="#CCCCCC"> prop on</font>

1090
00:47:35,109 --> 00:47:38,380
on this<font color="#E5E5E5"> thing and I and this is why I</font>

1091
00:47:37,119 --> 00:47:40,780
like sort<font color="#E5E5E5"> of want to talk to people here</font>

1092
00:47:38,380 --> 00:47:43,440
because<font color="#E5E5E5"> I and maybe one of forensics</font>

1093
00:47:40,780 --> 00:47:46,000
people<font color="#E5E5E5"> can find something that I missed</font>

1094
00:47:43,440 --> 00:47:48,010
<font color="#E5E5E5">they're the only really defense against</font>

1095
00:47:46,000 --> 00:47:50,410
<font color="#E5E5E5">this right now is defense and death</font><font color="#CCCCCC"> so</font>

1096
00:47:48,010 --> 00:47:53,200
have my<font color="#E5E5E5"> whitelisting</font><font color="#CCCCCC"> have egress</font>

1097
00:47:50,410 --> 00:47:55,690
building filtering<font color="#CCCCCC"> have it easy are or</font>

1098
00:47:53,200 --> 00:47:57,220
something like<font color="#E5E5E5"> that and most of those</font>

1099
00:47:55,690 --> 00:47:58,780
things<font color="#E5E5E5"> will</font><font color="#CCCCCC"> make it harder to even</font>

1100
00:47:57,220 --> 00:48:00,669
execute<font color="#E5E5E5"> this in the first place right</font>

1101
00:47:58,780 --> 00:48:03,940
other than that<font color="#E5E5E5"> there really isn't a</font><font color="#CCCCCC"> lot</font>

1102
00:48:00,670 --> 00:48:05,470
to detect on if<font color="#CCCCCC"> you're instrumenting</font>

1103
00:48:03,940 --> 00:48:07,690
your payloads properly<font color="#E5E5E5"> because again</font>

1104
00:48:05,470 --> 00:48:09,129
like<font color="#E5E5E5"> I said the generate function which</font>

1105
00:48:07,690 --> 00:48:11,319
is the equivalent<font color="#CCCCCC"> of had type in</font>

1106
00:48:09,130 --> 00:48:13,030
PowerShell<font color="#E5E5E5"> that does compile stuff</font>

1107
00:48:11,319 --> 00:48:16,150
through<font color="#E5E5E5"> CSC that I see which means that</font>

1108
00:48:13,030 --> 00:48:18,549
you'll see processes spawn as CS you see

1109
00:48:16,150 --> 00:48:20,589
<font color="#E5E5E5">you see that exiting spawn and they will</font>

1110
00:48:18,549 --> 00:48:23,470
be final to talk to this<font color="#E5E5E5"> temporary</font>

1111
00:48:20,589 --> 00:48:25,210
assemblies that<font color="#CCCCCC"> CSE that</font><font color="#E5E5E5"> exit uses but</font>

1112
00:48:23,470 --> 00:48:26,520
<font color="#E5E5E5">you can rename those but and so the</font>

1113
00:48:25,210 --> 00:48:28,990
thing is<font color="#E5E5E5"> if you're triggering on</font>

1114
00:48:26,520 --> 00:48:30,910
temporary<font color="#CCCCCC"> dll's this that's a fragile</font>

1115
00:48:28,990 --> 00:48:32,649
detection mechanism<font color="#E5E5E5"> because you can just</font>

1116
00:48:30,910 --> 00:48:37,990
set an option that<font color="#E5E5E5"> will rename those dll</font>

1117
00:48:32,650 --> 00:48:41,049
assemblies<font color="#E5E5E5"> ironpython deals are sort of</font>

1118
00:48:37,990 --> 00:48:44,020
an IOC<font color="#CCCCCC"> now</font><font color="#E5E5E5"> like I don't I'm not</font><font color="#CCCCCC"> sure if</font>

1119
00:48:41,049 --> 00:48:46,089
there's a good way of inspecting<font color="#CCCCCC"> there</font>

1120
00:48:44,020 --> 00:48:48,549
<font color="#E5E5E5">probably is just I</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> don't know but</font>

1121
00:48:46,089 --> 00:48:49,210
<font color="#E5E5E5">there's a good way of inspecting all of</font>

1122
00:48:48,549 --> 00:48:51,759
the memory

1123
00:48:49,210 --> 00:48:54,340
of every process<font color="#E5E5E5"> and seeing if they are</font>

1124
00:48:51,760 --> 00:48:56,500
<font color="#CCCCCC">vital</font><font color="#E5E5E5"> gills</font><font color="#CCCCCC"> a limited I'm not sure that</font>

1125
00:48:54,340 --> 00:48:58,240
<font color="#E5E5E5">might be</font><font color="#CCCCCC"> away so everything</font><font color="#E5E5E5"> so if you're</font>

1126
00:48:56,500 --> 00:48:58,810
sure you're<font color="#E5E5E5"> not using ironpython in your</font>

1127
00:48:58,240 --> 00:49:00,790
environment

1128
00:48:58,810 --> 00:49:03,330
<font color="#E5E5E5">you probably should look into seeing if</font>

1129
00:49:00,790 --> 00:49:07,560
you can get to just<font color="#E5E5E5"> not let those load</font>

1130
00:49:03,330 --> 00:49:09,759
which might be is a problem in itself

1131
00:49:07,560 --> 00:49:11,290
<font color="#E5E5E5">and like</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> said before the code Dom</font>

1132
00:49:09,760 --> 00:49:14,350
stuff is fragile detection so I would

1133
00:49:11,290 --> 00:49:16,570
<font color="#CCCCCC">recommend that really just</font><font color="#E5E5E5"> Microsoft</font>

1134
00:49:14,350 --> 00:49:19,690
please<font color="#E5E5E5"> point optics that</font><font color="#CCCCCC"> just solves</font>

1135
00:49:16,570 --> 00:49:23,560
most<font color="#E5E5E5"> of this I think but even</font><font color="#CCCCCC"> then I'm</font>

1136
00:49:19,690 --> 00:49:25,420
not<font color="#E5E5E5"> sure that</font><font color="#CCCCCC"> it works</font><font color="#E5E5E5"> prior</font><font color="#CCCCCC"> work I just</font>

1137
00:49:23,560 --> 00:49:30,060
<font color="#E5E5E5">want to give a huge shout</font><font color="#CCCCCC"> out to Dmitri</font>

1138
00:49:25,420 --> 00:49:32,680
<font color="#CCCCCC">Dmitri she's never seen his</font><font color="#E5E5E5"> name right</font><font color="#CCCCCC"> I</font>

1139
00:49:30,060 --> 00:49:34,450
highly<font color="#E5E5E5"> recommend you</font><font color="#CCCCCC"> look at his talk</font>

1140
00:49:32,680 --> 00:49:36,069
called quick retooling and dotnet<font color="#CCCCCC"> for</font>

1141
00:49:34,450 --> 00:49:38,710
<font color="#CCCCCC">Red Team this is</font><font color="#E5E5E5"> PI this is my favorite</font>

1142
00:49:36,070 --> 00:49:41,140
talk of the<font color="#CCCCCC"> year like he is amazing the</font>

1143
00:49:38,710 --> 00:49:45,030
stuff<font color="#E5E5E5"> that he talks about in this</font><font color="#CCCCCC"> talk</font>

1144
00:49:41,140 --> 00:49:47,410
<font color="#E5E5E5">is really really cool and he actually</font>

1145
00:49:45,030 --> 00:49:49,390
did some of the prior work on this

1146
00:49:47,410 --> 00:49:50,649
ironpython stuff that he<font color="#CCCCCC"> did mentioned</font>

1147
00:49:49,390 --> 00:49:53,170
some of<font color="#CCCCCC"> this iron violent stuff in</font><font color="#E5E5E5"> his</font>

1148
00:49:50,650 --> 00:49:56,290
talk and he's got a really<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> project</font>

1149
00:49:53,170 --> 00:49:59,080
called typhoon out there which tries to

1150
00:49:56,290 --> 00:50:00,460
which did some of the<font color="#E5E5E5"> work that I just</font>

1151
00:49:59,080 --> 00:50:02,230
put together like a lot of<font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> here</font>

1152
00:50:00,460 --> 00:50:05,460
<font color="#CCCCCC">but he did like the initial proof of</font>

1153
00:50:02,230 --> 00:50:10,810
concept I think<font color="#CCCCCC"> on this</font><font color="#E5E5E5"> and he really</font>

1154
00:50:05,460 --> 00:50:13,060
called typhoon so future work more<font color="#E5E5E5"> calms</font>

1155
00:50:10,810 --> 00:50:15,970
the server side of<font color="#CCCCCC"> the silent unity</font>

1156
00:50:13,060 --> 00:50:18,009
<font color="#CCCCCC">actually supports</font><font color="#E5E5E5"> HTTP</font><font color="#CCCCCC"> 2 and</font><font color="#E5E5E5"> WebSockets</font>

1157
00:50:15,970 --> 00:50:21,129
as of right now<font color="#E5E5E5"> it's based on port which</font>

1158
00:50:18,010 --> 00:50:23,830
is<font color="#E5E5E5"> like a new version of</font><font color="#CCCCCC"> class Python</font>

1159
00:50:21,130 --> 00:50:27,190
web servers so the server side is ready

1160
00:50:23,830 --> 00:50:30,730
<font color="#CCCCCC">problem is been dotnet doesn't at least</font>

1161
00:50:27,190 --> 00:50:33,520
to my knowledge does not<font color="#CCCCCC"> have an HTTP 2</font>

1162
00:50:30,730 --> 00:50:35,310
client available it<font color="#E5E5E5"> actually recently</font>

1163
00:50:33,520 --> 00:50:38,650
added a WebSocket

1164
00:50:35,310 --> 00:50:41,080
<font color="#CCCCCC">WebSocket</font><font color="#E5E5E5"> support so I accepted you</font><font color="#CCCCCC"> know</font>

1165
00:50:38,650 --> 00:50:44,650
<font color="#E5E5E5">get that going</font><font color="#CCCCCC"> but so more cons I want</font>

1166
00:50:41,080 --> 00:50:46,840
all the<font color="#E5E5E5"> comms</font><font color="#CCCCCC"> more modules restful api</font>

1167
00:50:44,650 --> 00:50:48,160
I'd like to port<font color="#CCCCCC"> Deathstar</font><font color="#E5E5E5"> over if</font>

1168
00:50:46,840 --> 00:50:49,450
you're not familiar with<font color="#CCCCCC"> DES aren't some</font>

1169
00:50:48,160 --> 00:50:51,940
other one of my projects and basically

1170
00:50:49,450 --> 00:50:53,680
automates gaining domain admin and

1171
00:50:51,940 --> 00:50:54,580
Windows Active Directory environments

1172
00:50:53,680 --> 00:50:55,990
<font color="#E5E5E5">using</font><font color="#CCCCCC"> Empire</font>

1173
00:50:54,580 --> 00:50:57,160
I would like to pour it over to this

1174
00:50:55,990 --> 00:50:58,009
<font color="#CCCCCC">because I</font><font color="#E5E5E5"> think that would be</font><font color="#CCCCCC"> amazing</font>

1175
00:50:57,160 --> 00:51:01,100
but<font color="#CCCCCC"> that would require</font>

1176
00:50:58,010 --> 00:51:03,020
<font color="#E5E5E5">to finish like all the</font><font color="#CCCCCC"> models that in</font>

1177
00:51:01,100 --> 00:51:04,310
order to<font color="#E5E5E5"> do that I'd</font><font color="#CCCCCC"> like to make it</font>

1178
00:51:03,020 --> 00:51:06,550
work I've got<font color="#CCCCCC"> an</font><font color="#E5E5E5"> average</font><font color="#CCCCCC"> uniform</font><font color="#E5E5E5"> I know</font>

1179
00:51:04,310 --> 00:51:10,279
I<font color="#CCCCCC"> figured out a way to</font><font color="#E5E5E5"> do this</font>

1180
00:51:06,550 --> 00:51:13,430
apparently if you<font color="#E5E5E5"> generate the c-sharp</font>

1181
00:51:10,280 --> 00:51:15,410
code via<font color="#E5E5E5"> il which is what the official</font>

1182
00:51:13,430 --> 00:51:17,330
ironpython compiler<font color="#E5E5E5"> those there is an</font>

1183
00:51:15,410 --> 00:51:20,830
<font color="#E5E5E5">actual official</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> Python compiler that</font>

1184
00:51:17,330 --> 00:51:23,330
<font color="#E5E5E5">generates an exe stub with</font><font color="#CCCCCC"> il code and</font>

1185
00:51:20,830 --> 00:51:25,490
it<font color="#CCCCCC"> references the ironpython</font><font color="#E5E5E5"> assemblies</font>

1186
00:51:23,330 --> 00:51:27,470
<font color="#E5E5E5">and apparently if you do that you you</font>

1187
00:51:25,490 --> 00:51:29,870
can just run<font color="#CCCCCC"> the ironpython assemblies</font>

1188
00:51:27,470 --> 00:51:31,669
on a<font color="#E5E5E5"> version</font><font color="#CCCCCC"> of.net and</font><font color="#E5E5E5"> i tried that it</font>

1189
00:51:29,870 --> 00:51:33,319
works<font color="#E5E5E5"> so you can run on impression any</font>

1190
00:51:31,670 --> 00:51:34,640
version<font color="#CCCCCC"> of.net the problem with this is</font>

1191
00:51:33,320 --> 00:51:36,410
<font color="#E5E5E5">I would have</font><font color="#CCCCCC"> to modify the compiler</font>

1192
00:51:34,640 --> 00:51:39,170
which is actually more trivial than I

1193
00:51:36,410 --> 00:51:41,779
initially thought<font color="#CCCCCC"> you set them find the</font>

1194
00:51:39,170 --> 00:51:43,070
right like<font color="#CCCCCC"> vm api calls which is what it</font>

1195
00:51:41,780 --> 00:51:44,660
uses<font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually generate that</font><font color="#CCCCCC"> I have</font>

1196
00:51:43,070 --> 00:51:46,970
covered so I'm<font color="#E5E5E5"> gonna figure that out</font>

1197
00:51:44,660 --> 00:51:49,520
Python object proxy there are actual

1198
00:51:46,970 --> 00:51:52,189
Python<font color="#CCCCCC"> RPCs out there that you</font><font color="#E5E5E5"> have RPC</font>

1199
00:51:49,520 --> 00:51:53,330
clients in c-sharp<font color="#CCCCCC"> PI room I think one</font>

1200
00:51:52,190 --> 00:51:54,710
of them<font color="#CCCCCC"> is called that would be</font>

1201
00:51:53,330 --> 00:51:56,990
interesting so<font color="#CCCCCC"> instead of just like</font>

1202
00:51:54,710 --> 00:51:58,520
sending our Python files over the

1203
00:51:56,990 --> 00:51:59,359
<font color="#CCCCCC">network you just be proxying on your</font>

1204
00:51:58,520 --> 00:52:03,800
Python<font color="#CCCCCC"> Oh</font>

1205
00:51:59,360 --> 00:52:05,480
ironpython<font color="#E5E5E5"> objects</font><font color="#CCCCCC"> and I'd also</font><font color="#E5E5E5"> like to</font>

1206
00:52:03,800 --> 00:52:08,090
<font color="#E5E5E5">add support to actually running normal</font>

1207
00:52:05,480 --> 00:52:09,530
Python scripts through it so like with

1208
00:52:08,090 --> 00:52:14,030
the standard library so you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> push</font>

1209
00:52:09,530 --> 00:52:14,420
down responder to the<font color="#E5E5E5"> needs more arm</font><font color="#CCCCCC"> -</font>

1210
00:52:14,030 --> 00:52:15,830
<font color="#E5E5E5">action</font>

1211
00:52:14,420 --> 00:52:17,650
thankfully there are<font color="#E5E5E5"> other people</font><font color="#CCCCCC"> that</font>

1212
00:52:15,830 --> 00:52:20,480
<font color="#CCCCCC">are that are talking</font><font color="#E5E5E5"> about this because</font>

1213
00:52:17,650 --> 00:52:23,900
they stood validates<font color="#E5E5E5"> I'm just not crazy</font>

1214
00:52:20,480 --> 00:52:25,730
<font color="#CCCCCC">Lisa validates my stuff here</font><font color="#E5E5E5"> tomorrow</font>

1215
00:52:23,900 --> 00:52:28,130
<font color="#E5E5E5">9:00 to 9:15</font>

1216
00:52:25,730 --> 00:52:29,480
there's<font color="#E5E5E5"> tuck bye - shaver building in</font>

1217
00:52:28,130 --> 00:52:30,950
<font color="#E5E5E5">Empire with our Python so if you</font>

1218
00:52:29,480 --> 00:52:33,190
<font color="#CCCCCC">interested in this you just</font><font color="#E5E5E5"> probably got</font>

1219
00:52:30,950 --> 00:52:36,439
some cool stuff<font color="#CCCCCC"> that</font><font color="#E5E5E5"> this as well</font>

1220
00:52:33,190 --> 00:52:37,540
credits<font color="#E5E5E5"> all these people</font><font color="#CCCCCC"> Cobra Cobra</font><font color="#E5E5E5"> IO</font>

1221
00:52:36,440 --> 00:52:40,640
food inspector<font color="#E5E5E5"> ops</font>

1222
00:52:37,540 --> 00:52:43,340
I wrote the<font color="#CCCCCC"> Sharps GUI toolkit hope you</font>

1223
00:52:40,640 --> 00:52:45,620
know<font color="#CCCCCC"> mad Dimitri thank you so much for</font>

1224
00:52:43,340 --> 00:52:47,090
your talk it was<font color="#E5E5E5"> awesome Egypt which put</font>

1225
00:52:45,620 --> 00:52:49,430
<font color="#CCCCCC">me pointed me in the right</font><font color="#E5E5E5"> direction a</font>

1226
00:52:47,090 --> 00:52:51,680
couple of things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I need to resolve</font>

1227
00:52:49,430 --> 00:52:54,319
with<font color="#CCCCCC"> the mutant</font><font color="#E5E5E5"> cast module and the</font>

1228
00:52:51,680 --> 00:52:57,080
usual suspects here<font color="#CCCCCC"> X</font><font color="#E5E5E5"> Oreo gentle wiki</font>

1229
00:52:54,320 --> 00:53:00,130
<font color="#E5E5E5">sub T</font><font color="#CCCCCC"> enigma manifestation all their</font>

1230
00:52:57,080 --> 00:53:00,130
work amazing

