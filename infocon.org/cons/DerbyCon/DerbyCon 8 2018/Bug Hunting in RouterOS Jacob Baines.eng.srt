1
00:00:00,500 --> 00:00:06,750
<font color="#E5E5E5">all right good morning everyone you guys</font>

2
00:00:03,179 --> 00:00:07,318
<font color="#CCCCCC">gave me</font><font color="#E5E5E5"> in that perfect</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> talk is</font>

3
00:00:06,750 --> 00:00:10,410
<font color="#CCCCCC">called</font>

4
00:00:07,319 --> 00:00:11,940
bug hunting matter or less<font color="#E5E5E5"> but why</font>

5
00:00:10,410 --> 00:00:14,849
should a<font color="#E5E5E5"> named is talk too much without</font>

6
00:00:11,940 --> 00:00:15,269
protocols<font color="#CCCCCC"> none</font><font color="#E5E5E5"> of you were woken up this</font>

7
00:00:14,849 --> 00:00:18,480
early

8
00:00:15,269 --> 00:00:23,460
where are<font color="#E5E5E5"> your small pads good I tricked</font>

9
00:00:18,480 --> 00:00:25,830
<font color="#E5E5E5">you</font><font color="#CCCCCC"> to get in here</font><font color="#E5E5E5"> so uh here</font><font color="#CCCCCC"> we go now</font>

10
00:00:23,460 --> 00:00:27,230
<font color="#E5E5E5">before</font><font color="#CCCCCC"> we get going I want you to all</font>

11
00:00:25,830 --> 00:00:29,369
know<font color="#CCCCCC"> that the slides in the</font><font color="#E5E5E5"> code</font>

12
00:00:27,230 --> 00:00:30,210
reference in<font color="#E5E5E5"> this talk it's already up</font>

13
00:00:29,369 --> 00:00:32,940
<font color="#E5E5E5">on github</font>

14
00:00:30,210 --> 00:00:35,670
I made this repository public just this

15
00:00:32,940 --> 00:00:39,300
morning so if you get bored<font color="#E5E5E5"> of me</font>

16
00:00:35,670 --> 00:00:43,250
<font color="#CCCCCC">mapping JSON to binary</font><font color="#E5E5E5"> broke readers hop</font>

17
00:00:39,300 --> 00:00:45,360
on github pull<font color="#E5E5E5"> that down and jump ahead</font>

18
00:00:43,250 --> 00:00:47,670
<font color="#E5E5E5">now this talk is broken down into four</font>

19
00:00:45,360 --> 00:00:50,760
parts and part one I'll start<font color="#CCCCCC"> off</font><font color="#E5E5E5"> by</font>

20
00:00:47,670 --> 00:00:52,980
introducing myself<font color="#E5E5E5"> and</font><font color="#CCCCCC"> rather or less in</font>

21
00:00:50,760 --> 00:00:57,120
part<font color="#E5E5E5"> two I'll spend</font><font color="#CCCCCC"> some time explaining</font>

22
00:00:52,980 --> 00:00:58,800
<font color="#E5E5E5">I can route</font><font color="#CCCCCC"> letter A so at the end when</font>

23
00:00:57,120 --> 00:01:01,169
<font color="#CCCCCC">you're bug hunting having access to</font><font color="#E5E5E5"> the</font>

24
00:00:58,800 --> 00:01:04,830
file system<font color="#E5E5E5"> being able to run tools like</font>

25
00:01:01,170 --> 00:01:07,320
<font color="#E5E5E5">GTP's</font><font color="#CCCCCC"> reporting on part</font><font color="#E5E5E5"> three we'll talk</font>

26
00:01:04,830 --> 00:01:09,798
about<font color="#E5E5E5"> the message protocol will be in</font>

27
00:01:07,320 --> 00:01:12,389
that section<font color="#CCCCCC"> quite a while but just</font><font color="#E5E5E5"> know</font>

28
00:01:09,799 --> 00:01:14,010
it's really fundamental for part<font color="#CCCCCC"> four</font>

29
00:01:12,390 --> 00:01:18,150
<font color="#CCCCCC">what we're going to</font><font color="#E5E5E5"> talk about three</font>

30
00:01:14,010 --> 00:01:20,900
different<font color="#CCCCCC"> parts</font><font color="#E5E5E5"> starting with the</font>

31
00:01:18,150 --> 00:01:24,150
introduction my<font color="#CCCCCC"> name is Jake</font><font color="#E5E5E5"> Baines</font><font color="#CCCCCC"> I</font>

32
00:01:20,900 --> 00:01:26,610
often<font color="#E5E5E5"> use the handle</font><font color="#CCCCCC"> albino lobster well</font>

33
00:01:24,150 --> 00:01:28,049
that guys up<font color="#E5E5E5"> there</font><font color="#CCCCCC"> apparently work a</font>

34
00:01:26,610 --> 00:01:30,390
tenable<font color="#CCCCCC"> at the senior research engineer</font>

35
00:01:28,049 --> 00:01:35,850
<font color="#E5E5E5">and I'm the team lead at the zero day</font>

36
00:01:30,390 --> 00:01:38,250
research group<font color="#E5E5E5"> bug hunting and router OS</font>

37
00:01:35,850 --> 00:01:41,250
is a really generic title might be

38
00:01:38,250 --> 00:01:43,229
wondering<font color="#E5E5E5"> which I don't</font><font color="#CCCCCC"> learn here for</font>

39
00:01:41,250 --> 00:01:45,270
my point of view<font color="#E5E5E5"> just talking is purely</font>

40
00:01:43,229 --> 00:01:48,720
practical<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> kind of a</font><font color="#CCCCCC"> dummies</font>

41
00:01:45,270 --> 00:01:50,908
<font color="#CCCCCC">guide to hacking at or less</font><font color="#E5E5E5"> after this</font>

42
00:01:48,720 --> 00:01:52,439
talk you'll be<font color="#CCCCCC"> able to route p.m.</font><font color="#E5E5E5"> you</font>

43
00:01:50,909 --> 00:01:55,320
<font color="#E5E5E5">know how to communicate over four eighty</font>

44
00:01:52,439 --> 00:01:57,240
seven eighty to ninety one<font color="#CCCCCC"> you'll</font>

45
00:01:55,320 --> 00:01:59,100
understand how to<font color="#E5E5E5"> notify</font><font color="#CCCCCC"> in areas relate</font>

46
00:01:57,240 --> 00:02:02,009
to the message protocol<font color="#E5E5E5"> you'll have a</font>

47
00:01:59,100 --> 00:02:04,469
boatload of<font color="#E5E5E5"> bad stuff though to read and</font>

48
00:02:02,009 --> 00:02:07,259
possibly even use and most<font color="#E5E5E5"> importantly</font>

49
00:02:04,469 --> 00:02:09,628
<font color="#CCCCCC">for my own ego I'm going to share with</font>

50
00:02:07,259 --> 00:02:11,989
you a<font color="#E5E5E5"> brand new vulnerability that we</font>

51
00:02:09,628 --> 00:02:11,989
can all play

52
00:02:13,520 --> 00:02:19,730
<font color="#E5E5E5">but before you learn all that</font><font color="#CCCCCC"> you start</font>

53
00:02:15,740 --> 00:02:21,590
at the<font color="#CCCCCC"> beginning what is router OS now</font>

54
00:02:19,730 --> 00:02:23,540
rather OS is the operating<font color="#CCCCCC"> system used</font>

55
00:02:21,590 --> 00:02:27,110
on<font color="#E5E5E5"> a variety of mikrotik switches</font>

56
00:02:23,540 --> 00:02:28,609
routers and<font color="#E5E5E5"> access points</font><font color="#CCCCCC"> and although</font>

57
00:02:27,110 --> 00:02:31,700
it's<font color="#E5E5E5"> not really the operating system</font>

58
00:02:28,610 --> 00:02:33,140
<font color="#E5E5E5">place that we run Linux rather OS is a</font>

59
00:02:31,700 --> 00:02:36,079
whole bunch<font color="#CCCCCC"> of binaries</font><font color="#E5E5E5"> and kernel</font>

60
00:02:33,140 --> 00:02:39,380
modules that run in that context either

61
00:02:36,080 --> 00:02:41,930
way rudderless<font color="#CCCCCC"> shipped on a really wide</font>

62
00:02:39,380 --> 00:02:44,420
<font color="#CCCCCC">variety</font><font color="#E5E5E5"> of hardware</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> as some</font>

63
00:02:41,930 --> 00:02:47,990
samples<font color="#CCCCCC"> here</font><font color="#E5E5E5"> we have everything from</font>

64
00:02:44,420 --> 00:02:50,739
edge routers wireless access points we

65
00:02:47,990 --> 00:02:54,200
<font color="#E5E5E5">could use in the enterprise</font><font color="#CCCCCC"> or at</font><font color="#E5E5E5"> home</font>

66
00:02:50,740 --> 00:02:57,370
and crap most importantly these devices

67
00:02:54,200 --> 00:03:00,410
are fairly<font color="#E5E5E5"> well</font><font color="#CCCCCC"> known for being</font><font color="#E5E5E5"> cheap</font>

68
00:02:57,370 --> 00:03:02,150
now sort of important to<font color="#E5E5E5"> know</font><font color="#CCCCCC"> microchip</font>

69
00:03:00,410 --> 00:03:04,670
turns out router or less releases like

70
00:03:02,150 --> 00:03:06,920
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> nobody's business</font><font color="#E5E5E5"> in fact I</font>

71
00:03:04,670 --> 00:03:10,730
probably this slides about<font color="#CCCCCC"> ten times we</font>

72
00:03:06,920 --> 00:03:15,040
<font color="#E5E5E5">just gave up last week but suffice to</font>

73
00:03:10,730 --> 00:03:18,459
say<font color="#E5E5E5"> they keep for major branches going</font>

74
00:03:15,040 --> 00:03:20,720
<font color="#E5E5E5">legacy a long term is stable in a beta</font>

75
00:03:18,460 --> 00:03:22,310
<font color="#E5E5E5">now to get an idea of what's actually</font>

76
00:03:20,720 --> 00:03:25,220
out there<font color="#CCCCCC"> in the wild</font><font color="#E5E5E5"> I hopped on</font>

77
00:03:22,310 --> 00:03:28,520
<font color="#CCCCCC">shodhan and I just looked at</font><font color="#E5E5E5"> FTP banners</font>

78
00:03:25,220 --> 00:03:33,350
which we all know<font color="#CCCCCC"> shodhan</font><font color="#E5E5E5"> isn't perfect</font>

79
00:03:28,520 --> 00:03:36,680
<font color="#E5E5E5">and</font><font color="#CCCCCC"> per happy banners will unfair the</font>

80
00:03:33,350 --> 00:03:39,260
type of administrator that<font color="#E5E5E5"> it's their</font>

81
00:03:36,680 --> 00:03:42,050
FTP open a world<font color="#E5E5E5"> on the router probably</font>

82
00:03:39,260 --> 00:03:44,239
isn't patching<font color="#E5E5E5"> but I think this gives us</font>

83
00:03:42,050 --> 00:03:47,870
the basic idea what's out<font color="#E5E5E5"> there you</font><font color="#CCCCCC"> know</font>

84
00:03:44,240 --> 00:03:51,610
a whole<font color="#CCCCCC"> lot of stable nearly equal</font>

85
00:03:47,870 --> 00:03:56,270
amounts of<font color="#E5E5E5"> long term and legacy</font>

86
00:03:51,610 --> 00:03:59,060
<font color="#E5E5E5">bizarrely there's never</font><font color="#CCCCCC"> full amounts of</font>

87
00:03:56,270 --> 00:04:01,930
the beta releases actually<font color="#CCCCCC"> released</font>

88
00:03:59,060 --> 00:04:05,060
candidate code I went on on my router

89
00:04:01,930 --> 00:04:08,360
<font color="#CCCCCC">and finally there was metal amount of</font>

90
00:04:05,060 --> 00:04:14,170
<font color="#E5E5E5">Florida X</font><font color="#CCCCCC"> West cortex</font><font color="#E5E5E5"> released was seven</font>

91
00:04:08,360 --> 00:04:16,370
years<font color="#E5E5E5"> ago</font><font color="#CCCCCC"> so in the last year and a half</font>

92
00:04:14,170 --> 00:04:19,969
<font color="#CCCCCC">there's been a lot of</font><font color="#E5E5E5"> excitement about</font>

93
00:04:16,370 --> 00:04:22,160
<font color="#CCCCCC">red or less in the news mostly</font><font color="#E5E5E5"> bad news</font>

94
00:04:19,970 --> 00:04:25,070
from<font color="#E5E5E5"> microfiche</font><font color="#CCCCCC"> was pretty</font><font color="#E5E5E5"> interesting</font>

95
00:04:22,160 --> 00:04:27,410
<font color="#CCCCCC">to us there</font><font color="#E5E5E5"> are two different threat</font>

96
00:04:25,070 --> 00:04:31,130
actors currently in the wild

97
00:04:27,410 --> 00:04:32,960
shot<font color="#E5E5E5"> a PT VPN filter</font><font color="#CCCCCC"> there a couple</font><font color="#E5E5E5"> of</font>

98
00:04:31,130 --> 00:04:36,469
<font color="#E5E5E5">big vulnerabilities that come out</font>

99
00:04:32,960 --> 00:04:38,989
<font color="#CCCCCC">Shammi red was an unauthenticated remote</font>

100
00:04:36,470 --> 00:04:41,690
code execution vulnerability alluded to

101
00:04:38,990 --> 00:04:44,570
in<font color="#E5E5E5"> vault</font><font color="#CCCCCC"> seven the researcher</font><font color="#E5E5E5"> has since</font>

102
00:04:41,690 --> 00:04:47,480
written<font color="#E5E5E5"> appeals before it than their</font><font color="#CCCCCC"> CV</font>

103
00:04:44,570 --> 00:04:49,610
2018<font color="#CCCCCC"> fourteen eight four seven and</font>

104
00:04:47,480 --> 00:04:54,620
that's actively being exploited for

105
00:04:49,610 --> 00:04:56,750
various activities<font color="#CCCCCC"> at</font><font color="#E5E5E5"> Ivy kind of</font>

106
00:04:54,620 --> 00:04:59,180
<font color="#E5E5E5">interesting mikrotik was recently added</font>

107
00:04:56,750 --> 00:05:04,010
<font color="#CCCCCC">CG odium they've been looking for payout</font>

108
00:04:59,180 --> 00:05:06,230
<font color="#CCCCCC">you might want to listen now I'm not the</font>

109
00:05:04,010 --> 00:05:09,289
first to present<font color="#E5E5E5"> microchip research and</font>

110
00:05:06,230 --> 00:05:11,780
I'm<font color="#CCCCCC"> try to</font><font color="#E5E5E5"> avoid covering these</font><font color="#CCCCCC"> those</font>

111
00:05:09,290 --> 00:05:14,600
old research it's good to show what<font color="#CCCCCC"> is</font>

112
00:05:11,780 --> 00:05:17,630
<font color="#E5E5E5">already out there rooting the microchip</font>

113
00:05:14,600 --> 00:05:20,090
routers was previously presenting a 2017

114
00:05:17,630 --> 00:05:24,050
<font color="#CCCCCC">and why block mount that gentleman's</font>

115
00:05:20,090 --> 00:05:26,239
name<font color="#CCCCCC"> I would put her it and not only</font>

116
00:05:24,050 --> 00:05:29,300
<font color="#E5E5E5">embarrassed myself but maybe him but</font>

117
00:05:26,240 --> 00:05:30,950
either<font color="#E5E5E5"> way</font><font color="#CCCCCC"> both his talk</font><font color="#E5E5E5"> and his github</font>

118
00:05:29,300 --> 00:05:36,220
repository were simply reasonable<font color="#E5E5E5"> in the</font>

119
00:05:30,950 --> 00:05:36,219
<font color="#CCCCCC">meet and while</font><font color="#E5E5E5"> over it not by Lorenzo</font>

120
00:05:36,910 --> 00:05:47,080
they<font color="#E5E5E5"> weren't my</font><font color="#CCCCCC"> perfectly and finally</font>

121
00:05:57,790 --> 00:06:04,880
<font color="#CCCCCC">all right so you know</font>

122
00:06:00,920 --> 00:06:07,370
me you know at<font color="#E5E5E5"> our router OS let's move</font>

123
00:06:04,880 --> 00:06:09,080
<font color="#E5E5E5">on to routing the devices</font><font color="#CCCCCC"> now this topic</font>

124
00:06:07,370 --> 00:06:11,060
is really<font color="#E5E5E5"> important as I said because</font>

125
00:06:09,080 --> 00:06:14,390
<font color="#CCCCCC">when</font><font color="#E5E5E5"> we actually bug hunting</font><font color="#CCCCCC"> the ability</font>

126
00:06:11,060 --> 00:06:16,550
to collect<font color="#CCCCCC"> coordinates attached</font><font color="#E5E5E5"> gdb or</font>

127
00:06:14,390 --> 00:06:19,390
simply lists which binaries on which

128
00:06:16,550 --> 00:06:19,390
<font color="#CCCCCC">core is pretty fundamental</font>

129
00:06:20,680 --> 00:06:25,250
so start we<font color="#CCCCCC"> need something to</font><font color="#E5E5E5"> test on</font>

130
00:06:23,230 --> 00:06:27,680
<font color="#E5E5E5">unfortunately</font><font color="#CCCCCC"> your address can be</font>

131
00:06:25,250 --> 00:06:29,510
virtualized<font color="#E5E5E5"> you can go to microchips</font>

132
00:06:27,680 --> 00:06:31,220
website and download<font color="#E5E5E5"> any version through</font>

133
00:06:29,510 --> 00:06:34,099
the last eight years<font color="#CCCCCC"> she's all</font><font color="#E5E5E5"> the way</font>

134
00:06:31,220 --> 00:06:39,020
back for<font color="#CCCCCC"> ten</font><font color="#E5E5E5"> in this slide</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see</font>

135
00:06:34,100 --> 00:06:40,940
<font color="#CCCCCC">I've created a VM with a 6.49</font><font color="#E5E5E5"> ISO now</font>

136
00:06:39,020 --> 00:06:43,880
unfortunately the shells<font color="#E5E5E5"> offered on the</font>

137
00:06:40,940 --> 00:06:46,550
console telnet and ssh are totally

138
00:06:43,880 --> 00:06:48,770
useless does<font color="#CCCCCC"> that bug hunters those</font>

139
00:06:46,550 --> 00:06:50,930
shells are<font color="#E5E5E5"> they</font><font color="#CCCCCC"> only process router</font><font color="#E5E5E5"> OS</font>

140
00:06:48,770 --> 00:06:54,680
commands<font color="#E5E5E5"> they don't provide any access</font>

141
00:06:50,930 --> 00:06:57,860
<font color="#E5E5E5">to Linux or busybox shell or</font><font color="#CCCCCC"> the</font>

142
00:06:54,680 --> 00:07:01,280
underlying<font color="#E5E5E5"> file</font><font color="#CCCCCC"> system it's</font><font color="#E5E5E5"> almost like</font>

143
00:06:57,860 --> 00:07:03,470
they don't<font color="#CCCCCC"> want to have a real film but</font>

144
00:07:01,280 --> 00:07:05,840
of<font color="#E5E5E5"> course developers want real shells</font>

145
00:07:03,470 --> 00:07:07,640
<font color="#CCCCCC">too so fortunately the mikrotik</font>

146
00:07:05,840 --> 00:07:10,369
<font color="#E5E5E5">developers have our back and they insert</font>

147
00:07:07,640 --> 00:07:11,960
a<font color="#E5E5E5"> backdoor but before you get all</font>

148
00:07:10,370 --> 00:07:13,820
excited the<font color="#E5E5E5"> stack door requires</font><font color="#CCCCCC"> a</font>

149
00:07:11,960 --> 00:07:17,180
specific<font color="#CCCCCC"> file be present on a</font><font color="#E5E5E5"> file</font>

150
00:07:13,820 --> 00:07:19,310
system<font color="#E5E5E5"> in normal cases users</font><font color="#CCCCCC"> don't have</font>

151
00:07:17,180 --> 00:07:22,580
access<font color="#E5E5E5"> as part of the file system so</font>

152
00:07:19,310 --> 00:07:24,620
<font color="#E5E5E5">that's probably out right now</font><font color="#CCCCCC"> for</font>

153
00:07:22,580 --> 00:07:27,289
whatever reason mikrotik has changed

154
00:07:24,620 --> 00:07:29,830
this behavior over time there are<font color="#E5E5E5"> three</font>

155
00:07:27,290 --> 00:07:35,840
major<font color="#CCCCCC"> versions of the</font><font color="#E5E5E5"> backdoor</font>

156
00:07:29,830 --> 00:07:38,990
so I'm going<font color="#CCCCCC"> to run you</font><font color="#E5E5E5"> those in 6.49</font>

157
00:07:35,840 --> 00:07:41,119
<font color="#E5E5E5">which is a long term lease if you find</font>

158
00:07:38,990 --> 00:07:42,050
the<font color="#CCCCCC"> Picard code block in Nova slash bin</font>

159
00:07:41,120 --> 00:07:44,540
slash<font color="#CCCCCC"> logins</font>

160
00:07:42,050 --> 00:07:48,530
now<font color="#E5E5E5"> click the poll logic in the slides</font>

161
00:07:44,540 --> 00:07:52,580
but<font color="#CCCCCC"> it</font><font color="#E5E5E5"> just is this is a login username</font>

162
00:07:48,530 --> 00:07:55,909
<font color="#CCCCCC">devel it's</font><font color="#E5E5E5"> so does the file de</font><font color="#CCCCCC"> Velde</font>

163
00:07:52,580 --> 00:08:00,800
<font color="#CCCCCC">that logging exists in debt in</font><font color="#E5E5E5"> Nova that</font>

164
00:07:55,910 --> 00:08:04,490
<font color="#E5E5E5">Etsy if so is logging in user using the</font>

165
00:08:00,800 --> 00:08:07,180
<font color="#E5E5E5">admin password it's so drop down into a</font>

166
00:08:04,490 --> 00:08:07,180
bit and pop shop

167
00:08:08,240 --> 00:08:14,090
now the<font color="#CCCCCC"> logic and 6.41 that for which</font>

168
00:08:11,330 --> 00:08:15,919
the stable release the similar except

169
00:08:14,090 --> 00:08:18,650
<font color="#E5E5E5">now some</font><font color="#CCCCCC"> of the logic lives in let you</font>

170
00:08:15,919 --> 00:08:20,568
message you<font color="#E5E5E5"> can see in the slides</font><font color="#CCCCCC"> that</font>

171
00:08:18,650 --> 00:08:23,448
after the<font color="#CCCCCC"> login binary determines the</font>

172
00:08:20,569 --> 00:08:25,130
<font color="#E5E5E5">users the</font><font color="#CCCCCC"> bail</font><font color="#E5E5E5"> it makes a call to a</font>

173
00:08:23,449 --> 00:08:27,259
library function called<font color="#CCCCCC"> had often</font>

174
00:08:25,130 --> 00:08:30,289
<font color="#CCCCCC">package which in turn calls a function</font>

175
00:08:27,259 --> 00:08:35,360
<font color="#E5E5E5">called has</font><font color="#CCCCCC"> package with a string option</font>

176
00:08:30,289 --> 00:08:37,429
<font color="#E5E5E5">as a</font><font color="#CCCCCC"> parameter</font><font color="#E5E5E5"> and has package just</font>

177
00:08:35,360 --> 00:08:39,649
checks the parameter exists in the

178
00:08:37,429 --> 00:08:45,170
package directory so the<font color="#E5E5E5"> backdoor file</font>

179
00:08:39,649 --> 00:08:47,839
for this version is package<font color="#CCCCCC"> / option now</font>

180
00:08:45,170 --> 00:08:50,569
from 6.4<font color="#E5E5E5"> to upwards the</font><font color="#CCCCCC"> backdoor logics</font>

181
00:08:47,839 --> 00:08:53,000
<font color="#CCCCCC">is the same as six</font><font color="#E5E5E5"> 41.4 except has</font>

182
00:08:50,570 --> 00:08:54,950
package has extra checks and

183
00:08:53,000 --> 00:08:57,170
specifically<font color="#E5E5E5"> it verifies that package</font>

184
00:08:54,950 --> 00:08:59,420
<font color="#CCCCCC">last</font><font color="#E5E5E5"> option has a</font><font color="#CCCCCC"> filesystem type of</font>

185
00:08:57,170 --> 00:09:01,790
<font color="#E5E5E5">squash FS</font><font color="#CCCCCC"> or that a</font><font color="#E5E5E5"> sim length is</font>

186
00:08:59,420 --> 00:09:03,319
pointing to the<font color="#E5E5E5"> bungle directory well</font>

187
00:09:01,790 --> 00:09:08,689
that doesn't<font color="#E5E5E5"> sound problematic we'll see</font>

188
00:09:03,320 --> 00:09:10,730
in a few<font color="#CCCCCC"> slides</font><font color="#E5E5E5"> that it is so now that</font>

189
00:09:08,690 --> 00:09:12,620
we know<font color="#CCCCCC"> that</font><font color="#E5E5E5"> grow file is how do we</font>

190
00:09:10,730 --> 00:09:14,720
actually<font color="#E5E5E5"> create it</font><font color="#CCCCCC"> those like I said</font>

191
00:09:12,620 --> 00:09:17,180
<font color="#E5E5E5">normally you don't have access to the</font>

192
00:09:14,720 --> 00:09:19,640
underlying<font color="#E5E5E5"> file system but</font><font color="#CCCCCC"> that's where</font>

193
00:09:17,180 --> 00:09:22,130
our correlation really helps<font color="#E5E5E5"> us we can</font>

194
00:09:19,640 --> 00:09:24,579
just<font color="#CCCCCC"> move the VM</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> ICD mount the</font>

195
00:09:22,130 --> 00:09:27,140
<font color="#CCCCCC">filesystem and create files as needed</font>

196
00:09:24,579 --> 00:09:30,319
<font color="#E5E5E5">now I don't fully understand read our</font>

197
00:09:27,140 --> 00:09:32,270
essence<font color="#CCCCCC"> file</font><font color="#E5E5E5"> system overlay and I'm not</font>

198
00:09:30,320 --> 00:09:34,760
<font color="#E5E5E5">seeing other researchers</font><font color="#CCCCCC"> describe</font>

199
00:09:32,270 --> 00:09:37,640
<font color="#CCCCCC">booting the</font><font color="#E5E5E5"> vmware quite like I do how I</font>

200
00:09:34,760 --> 00:09:39,260
do it<font color="#E5E5E5"> as office</font><font color="#CCCCCC"> in length the root</font>

201
00:09:37,640 --> 00:09:42,949
directory<font color="#CCCCCC"> and the mountain top with</font><font color="#E5E5E5"> them</font>

202
00:09:39,260 --> 00:09:45,860
<font color="#CCCCCC">RW v directory and this directory that</font>

203
00:09:42,950 --> 00:09:48,860
<font color="#E5E5E5">he had that for to do and after</font>

204
00:09:45,860 --> 00:09:51,079
rebooting the device<font color="#CCCCCC"> I can then FTP in</font>

205
00:09:48,860 --> 00:09:53,810
her birth<font color="#E5E5E5"> the sim link and create</font><font color="#CCCCCC"> a</font>

206
00:09:51,079 --> 00:09:56,029
backdoor file using the<font color="#E5E5E5"> dirt it's also a</font>

207
00:09:53,810 --> 00:09:58,060
really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> opportunity to</font><font color="#E5E5E5"> drop</font><font color="#CCCCCC"> to</font>

208
00:09:56,029 --> 00:10:00,140
<font color="#CCCCCC">debauch ug UG serve around the system</font>

209
00:09:58,060 --> 00:10:00,859
it's really<font color="#E5E5E5"> important to drop a new</font>

210
00:10:00,140 --> 00:10:04,310
<font color="#CCCCCC">busybox</font>

211
00:10:00,860 --> 00:10:07,070
<font color="#E5E5E5">because</font><font color="#CCCCCC"> Divi</font><font color="#E5E5E5"> box on these systems is</font>

212
00:10:04,310 --> 00:10:11,449
notorious for lacking features missing

213
00:10:07,070 --> 00:10:13,339
<font color="#CCCCCC">LS command</font><font color="#E5E5E5"> and this cloud you can</font>

214
00:10:11,450 --> 00:10:15,589
<font color="#E5E5E5">actually see me logged in at the devel</font>

215
00:10:13,339 --> 00:10:18,910
user again<font color="#E5E5E5"> I dropped right to the</font>

216
00:10:15,589 --> 00:10:20,650
<font color="#CCCCCC">busybox shell but before we</font>

217
00:10:18,910 --> 00:10:25,329
<font color="#CCCCCC">- excited we have</font><font color="#E5E5E5"> to remember that</font><font color="#CCCCCC"> and</font>

218
00:10:20,650 --> 00:10:28,510
fix<font color="#CCCCCC"> upwards</font><font color="#E5E5E5"> - and up</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> change</font><font color="#CCCCCC"> in form</font>

219
00:10:25,330 --> 00:10:30,250
<font color="#CCCCCC">a</font><font color="#E5E5E5"> check</font><font color="#CCCCCC"> file system ties in those newer</font>

220
00:10:28,510 --> 00:10:32,439
versions the file type<font color="#E5E5E5"> have to be</font>

221
00:10:30,250 --> 00:10:34,120
<font color="#CCCCCC">squashed a</font><font color="#E5E5E5"> test</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> you can see in the</font>

222
00:10:32,440 --> 00:10:37,090
slide my back door method create the

223
00:10:34,120 --> 00:10:39,520
file<font color="#E5E5E5"> file type of tent at that</font><font color="#CCCCCC"> these</font>

224
00:10:37,090 --> 00:10:43,960
newer<font color="#E5E5E5"> versions</font><font color="#CCCCCC"> we need to find another</font>

225
00:10:39,520 --> 00:10:45,910
way to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> route so fortunately router</font>

226
00:10:43,960 --> 00:10:49,810
OS has<font color="#E5E5E5"> known its</font><font color="#CCCCCC"> risk</font><font color="#E5E5E5"> they'll execute</font>

227
00:10:45,910 --> 00:10:51,219
<font color="#E5E5E5">anything in the</font><font color="#CCCCCC"> RWS jet pump file as</font>

228
00:10:49,810 --> 00:10:54,729
written<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think they want to provide</font>

229
00:10:51,220 --> 00:10:56,620
thin<font color="#CCCCCC"> Slashdot with parameters</font><font color="#E5E5E5"> for those</font>

230
00:10:54,730 --> 00:10:58,660
that are excited that gosh might be the

231
00:10:56,620 --> 00:11:02,080
ghost shell it<font color="#E5E5E5"> is unfortunate or not</font>

232
00:10:58,660 --> 00:11:04,089
Timlin for logging by noon<font color="#E5E5E5"> but either</font>

233
00:11:02,080 --> 00:11:06,100
way<font color="#E5E5E5"> there's nothing stopping us from</font>

234
00:11:04,090 --> 00:11:09,160
adding commands after green<font color="#CCCCCC"> slash gothic</font>

235
00:11:06,100 --> 00:11:10,960
and<font color="#CCCCCC"> executed</font><font color="#E5E5E5"> so in this slide</font><font color="#CCCCCC"> you can</font>

236
00:11:09,160 --> 00:11:15,370
<font color="#E5E5E5">see</font><font color="#CCCCCC"> I've booted</font><font color="#E5E5E5"> into the live PD again</font>

237
00:11:10,960 --> 00:11:17,170
<font color="#CCCCCC">at echo commands are useless comp the</font>

238
00:11:15,370 --> 00:11:19,870
commands will start come<font color="#E5E5E5"> out on that on</font>

239
00:11:17,170 --> 00:11:24,069
for 1270<font color="#CCCCCC"> have</font><font color="#E5E5E5"> hidden thoughts that I put</font>

240
00:11:19,870 --> 00:11:25,690
in the RW flashes so badly that we've

241
00:11:24,070 --> 00:11:28,380
<font color="#E5E5E5">moved on from</font><font color="#CCCCCC"> the backdoor file for a</font>

242
00:11:25,690 --> 00:11:31,030
new version<font color="#CCCCCC"> for the results of things a</font>

243
00:11:28,380 --> 00:11:34,980
<font color="#E5E5E5">pari butanol you need to use connection</font>

244
00:11:31,030 --> 00:11:34,980
and this<font color="#E5E5E5"> about pictures</font><font color="#CCCCCC"> excel</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> free</font>

245
00:11:36,330 --> 00:11:41,140
<font color="#CCCCCC">ok we can route all versions of</font><font color="#E5E5E5"> the</font>

246
00:11:39,070 --> 00:11:43,930
<font color="#E5E5E5">retro p.m. and that's that's pretty</font>

247
00:11:41,140 --> 00:11:45,430
useful<font color="#CCCCCC"> but bug</font><font color="#E5E5E5"> hundred what we really</font>

248
00:11:43,930 --> 00:11:48,609
want to be<font color="#CCCCCC"> dealing with</font><font color="#E5E5E5"> hunky bugs so</font>

249
00:11:45,430 --> 00:11:51,400
let's move<font color="#E5E5E5"> on to at once though let's</font>

250
00:11:48,610 --> 00:11:54,460
start with an<font color="#CCCCCC"> nmap</font><font color="#E5E5E5"> and we immediately</font>

251
00:11:51,400 --> 00:11:56,290
<font color="#E5E5E5">find a good amount of attacker</font><font color="#CCCCCC"> he is</font>

252
00:11:54,460 --> 00:12:00,280
<font color="#E5E5E5">open there are</font><font color="#CCCCCC"> six different</font><font color="#E5E5E5"> management</font>

253
00:11:56,290 --> 00:12:02,410
ports at the page comment HTTP team when

254
00:12:00,280 --> 00:12:08,140
<font color="#CCCCCC">boxes on eighty to ninety one</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> are</font>

255
00:12:02,410 --> 00:12:10,030
<font color="#E5E5E5">two men mikrotik api ports</font><font color="#CCCCCC"> 87</font><font color="#E5E5E5"> 28 729 and</font>

256
00:12:08,140 --> 00:12:13,270
the bandwidth servers open on<font color="#E5E5E5"> two</font>

257
00:12:10,030 --> 00:12:16,329
<font color="#E5E5E5">thousand now I'm a sucker for Apple</font>

258
00:12:13,270 --> 00:12:20,610
familiarity<font color="#E5E5E5"> and low-hanging bugs so like</font>

259
00:12:16,330 --> 00:12:20,610
many<font color="#E5E5E5"> I go straight</font><font color="#CCCCCC"> to the HTTP interface</font>

260
00:12:21,090 --> 00:12:26,260
<font color="#E5E5E5">because it's traffic</font>

261
00:12:22,750 --> 00:12:29,200
the little weird<font color="#E5E5E5"> to posting</font><font color="#CCCCCC"> over and</font>

262
00:12:26,260 --> 00:12:32,430
over again which<font color="#CCCCCC"> I have coffee</font><font color="#E5E5E5"> the data</font>

263
00:12:29,200 --> 00:12:32,430
doesn't really look normal

264
00:12:32,980 --> 00:12:40,750
and the content type of message which

265
00:12:35,910 --> 00:12:44,730
<font color="#CCCCCC">preacher nama conventional thing</font><font color="#E5E5E5"> so</font>

266
00:12:40,750 --> 00:12:44,730
<font color="#E5E5E5">leaves me asking what's going</font><font color="#CCCCCC"> on here</font>

267
00:12:44,790 --> 00:12:49,240
<font color="#E5E5E5">now we know the browser is sending post</font>

268
00:12:47,200 --> 00:12:52,930
requests<font color="#E5E5E5"> so there must be some logic on</font>

269
00:12:49,240 --> 00:12:54,520
client side<font color="#E5E5E5"> that controls behavior</font><font color="#CCCCCC"> it's</font>

270
00:12:52,930 --> 00:12:57,370
just<font color="#CCCCCC"> a</font><font color="#E5E5E5"> matter of tracking down where the</font>

271
00:12:54,520 --> 00:12:59,620
<font color="#CCCCCC">browser's felt that logics</font><font color="#E5E5E5"> now looking</font>

272
00:12:57,370 --> 00:13:02,470
at the<font color="#E5E5E5"> early stages of the connection we</font>

273
00:12:59,620 --> 00:13:05,080
see web page class<font color="#CCCCCC"> mastery</font><font color="#E5E5E5"> is that</font>

274
00:13:02,470 --> 00:13:09,240
highlighted here<font color="#E5E5E5"> and that seems</font><font color="#CCCCCC"> like me</font>

275
00:13:05,080 --> 00:13:11,980
<font color="#CCCCCC">interrupting candidate and it turns</font><font color="#E5E5E5"> out</font>

276
00:13:09,240 --> 00:13:13,420
it isn't interact with him that it's the

277
00:13:11,980 --> 00:13:16,210
code that's<font color="#E5E5E5"> actually making the</font><font color="#CCCCCC"> post</font>

278
00:13:13,420 --> 00:13:18,040
<font color="#CCCCCC">requests</font><font color="#E5E5E5"> huge losses and it's about</font>

279
00:13:16,210 --> 00:13:20,710
<font color="#CCCCCC">seventeen</font><font color="#E5E5E5"> thousand lines of JavaScript</font>

280
00:13:18,040 --> 00:13:22,810
in this slide you<font color="#CCCCCC"> can see some of</font><font color="#E5E5E5"> the</font>

281
00:13:20,710 --> 00:13:26,260
agency<font color="#E5E5E5"> post requests UJS proxy</font>

282
00:13:22,810 --> 00:13:31,719
highlighted them as well as some

283
00:13:26,260 --> 00:13:34,630
authentication<font color="#E5E5E5"> modules now as it turns</font>

284
00:13:31,720 --> 00:13:36,820
out they've implemented<font color="#CCCCCC"> mschap each ug</font>

285
00:13:34,630 --> 00:13:41,470
<font color="#CCCCCC">Tierra vation and are key for encryption</font>

286
00:13:36,820 --> 00:13:44,890
<font color="#E5E5E5">just</font><font color="#CCCCCC"> seems like</font><font color="#E5E5E5"> a really</font><font color="#CCCCCC"> odd put me</font>

287
00:13:41,470 --> 00:13:48,060
you<font color="#E5E5E5"> see LS being much easier but</font><font color="#CCCCCC"> leave</font>

288
00:13:44,890 --> 00:13:52,360
these algorithms are<font color="#E5E5E5"> very familiar RFC</font>

289
00:13:48,060 --> 00:13:55,089
3079 is nearly<font color="#CCCCCC"> eighteen</font><font color="#E5E5E5"> years old now so</font>

290
00:13:52,360 --> 00:13:57,130
<font color="#CCCCCC">what are our steps forward from here</font><font color="#E5E5E5"> we</font>

291
00:13:55,090 --> 00:13:58,630
<font color="#E5E5E5">want to explore this interface for the</font>

292
00:13:57,130 --> 00:14:02,010
<font color="#E5E5E5">communication hidden behind cut</font>

293
00:13:58,630 --> 00:14:04,570
encryption the obvious answer to<font color="#CCCCCC"> me Ali</font>

294
00:14:02,010 --> 00:14:08,319
so<font color="#E5E5E5"> that we need to write a tool you clip</font>

295
00:14:04,570 --> 00:14:10,230
this<font color="#CCCCCC"> rabbit but</font><font color="#E5E5E5"> before we can decrypt</font>

296
00:14:08,320 --> 00:14:13,420
anything you need to<font color="#E5E5E5"> know how to</font>

297
00:14:10,230 --> 00:14:15,040
negotiation<font color="#E5E5E5"> work we can see here that</font>

298
00:14:13,420 --> 00:14:22,540
starts<font color="#E5E5E5"> with a client sending an empty</font>

299
00:14:15,040 --> 00:14:24,670
HTTP HTTP POST request doing some

300
00:14:22,540 --> 00:14:26,349
<font color="#CCCCCC">uninfected re you know that the perfect</font>

301
00:14:24,670 --> 00:14:28,540
<font color="#CCCCCC">response should contain four bytes of</font>

302
00:14:26,350 --> 00:14:30,660
session ID<font color="#E5E5E5"> four bytes the sequence</font>

303
00:14:28,540 --> 00:14:33,599
number and<font color="#E5E5E5"> sixteen by the challenge text</font>

304
00:14:30,660 --> 00:14:36,370
which adds up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> twenty four</font><font color="#E5E5E5"> bytes</font><font color="#CCCCCC"> you</font>

305
00:14:33,600 --> 00:14:39,190
<font color="#CCCCCC">can also see in this slide that</font><font color="#E5E5E5"> the</font>

306
00:14:36,370 --> 00:14:42,970
content length and the HTTP response is

307
00:14:39,190 --> 00:14:46,360
37 bytes so a<font color="#E5E5E5"> little while there I was</font>

308
00:14:42,970 --> 00:14:47,680
<font color="#CCCCCC">wondering again what's going on well</font>

309
00:14:46,360 --> 00:14:50,110
<font color="#CCCCCC">that everything you to encode it into</font>

310
00:14:47,680 --> 00:14:54,459
utf-8 code points<font color="#CCCCCC"> for the size of the</font>

311
00:14:50,110 --> 00:14:56,440
<font color="#E5E5E5">payload</font><font color="#CCCCCC"> those can be variable this</font><font color="#E5E5E5"> is a</font>

312
00:14:54,459 --> 00:14:59,109
quick<font color="#CCCCCC"> example of decoding the code point</font>

313
00:14:56,440 --> 00:15:04,300
<font color="#CCCCCC">you see everything sanely</font><font color="#E5E5E5"> goes down to</font>

314
00:14:59,110 --> 00:15:05,980
<font color="#E5E5E5">exactly what said</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> for it seems now</font>

315
00:15:04,300 --> 00:15:07,630
for the client<font color="#CCCCCC"> will cease</font><font color="#E5E5E5"> the service</font>

316
00:15:05,980 --> 00:15:09,519
challenge<font color="#CCCCCC"> it confuse the</font><font color="#E5E5E5"> Challenger</font>

317
00:15:07,630 --> 00:15:11,890
phone as well<font color="#E5E5E5"> as</font><font color="#CCCCCC"> the sending</font><font color="#E5E5E5"> the fuse</font>

318
00:15:09,519 --> 00:15:13,709
art and for cami's the client didn't

319
00:15:11,890 --> 00:15:16,079
send the big blob back to the server

320
00:15:13,709 --> 00:15:19,420
containing the following<font color="#CCCCCC"> information</font><font color="#E5E5E5"> a</font>

321
00:15:16,079 --> 00:15:21,880
<font color="#E5E5E5">username</font><font color="#CCCCCC"> the server</font><font color="#E5E5E5"> challenge the client</font>

322
00:15:19,420 --> 00:15:25,660
challenge and an encrypted challenge

323
00:15:21,880 --> 00:15:27,700
with mom which is<font color="#E5E5E5"> everything</font><font color="#CCCCCC"> we need he</font>

324
00:15:25,660 --> 00:15:30,640
needs<font color="#CCCCCC"> to do offline boot quotes</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> hat</font>

325
00:15:27,700 --> 00:15:33,310
words<font color="#CCCCCC"> I</font><font color="#E5E5E5"> coated up a little project</font><font color="#CCCCCC"> with</font>

326
00:15:30,640 --> 00:15:35,019
<font color="#CCCCCC">up before us just takes in a pea cap and</font>

327
00:15:33,310 --> 00:15:38,260
a password list and they'll fit up<font color="#E5E5E5"> using</font>

328
00:15:35,019 --> 00:15:42,310
a<font color="#E5E5E5"> new peppers in this example I just</font>

329
00:15:38,260 --> 00:15:45,430
need half with<font color="#E5E5E5"> dense peppers this seems</font>

330
00:15:42,310 --> 00:15:48,180
like a toy<font color="#E5E5E5"> but you need to realize that</font>

331
00:15:45,430 --> 00:16:01,060
<font color="#E5E5E5">in the real world</font><font color="#CCCCCC"> this traffic is</font>

332
00:15:48,180 --> 00:16:04,060
flowing<font color="#E5E5E5"> over the</font><font color="#CCCCCC"> Internet so so it's</font>

333
00:16:01,060 --> 00:16:05,560
important that just last month<font color="#CCCCCC"> Microtech</font>

334
00:16:04,060 --> 00:16:08,529
moved away from<font color="#E5E5E5"> the implement</font>

335
00:16:05,560 --> 00:16:10,420
implementation in their table<font color="#CCCCCC"> rings</font><font color="#E5E5E5"> they</font>

336
00:16:08,529 --> 00:16:15,310
moved to pick<font color="#E5E5E5"> stop for</font><font color="#CCCCCC"> three which now</font>

337
00:16:10,420 --> 00:16:17,529
uses a<font color="#E5E5E5"> curved</font><font color="#CCCCCC"> base key exchange long</font>

338
00:16:15,310 --> 00:16:19,719
term is still affected and as I showed

339
00:16:17,529 --> 00:16:24,430
earlier<font color="#E5E5E5"> patching is not great on the</font>

340
00:16:19,720 --> 00:16:26,769
<font color="#E5E5E5">systems now this is not employed this is</font>

341
00:16:24,430 --> 00:16:29,079
actually pretty<font color="#E5E5E5"> useful for us</font><font color="#CCCCCC"> pull</font>

342
00:16:26,769 --> 00:16:31,709
decrypt the contents<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> jf</font><font color="#CCCCCC"> proc</font>

343
00:16:29,079 --> 00:16:33,969
confession and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> P cap and</font><font color="#E5E5E5"> every bite</font>

344
00:16:31,709 --> 00:16:37,300
<font color="#CCCCCC">the method of</font><font color="#E5E5E5"> decrypt the messages</font>

345
00:16:33,970 --> 00:16:40,630
<font color="#E5E5E5">standard out this is an example from</font><font color="#CCCCCC"> pic</font>

346
00:16:37,300 --> 00:16:45,269
<font color="#CCCCCC">stop 32.3</font><font color="#E5E5E5"> and we find underneath the rc4</font>

347
00:16:40,630 --> 00:16:45,269
<font color="#E5E5E5">encryption JSON based messages</font>

348
00:16:47,280 --> 00:16:53,250
but the protocol here isn't<font color="#E5E5E5"> obviously</font>

349
00:16:50,070 --> 00:16:56,850
anything<font color="#E5E5E5"> if it wasn't to me so I had to</font>

350
00:16:53,250 --> 00:16:58,760
influence you see each JSON<font color="#E5E5E5"> key value</font>

351
00:16:56,850 --> 00:17:01,290
pair is broken down into three<font color="#CCCCCC"> parts in</font>

352
00:16:58,760 --> 00:17:03,300
<font color="#CCCCCC">the first part the first character</font>

353
00:17:01,290 --> 00:17:05,280
defines the<font color="#E5E5E5"> type of which there are</font>

354
00:17:03,300 --> 00:17:08,310
<font color="#E5E5E5">fortune different types I put them all</font>

355
00:17:05,280 --> 00:17:10,980
<font color="#E5E5E5">here the second part is a heck integer</font>

356
00:17:08,310 --> 00:17:13,980
and it represents<font color="#E5E5E5"> the name and finally</font>

357
00:17:10,980 --> 00:17:16,290
<font color="#E5E5E5">part</font><font color="#CCCCCC"> three you put value now combine</font>

358
00:17:13,980 --> 00:17:20,699
these three things<font color="#E5E5E5"> describe a variable</font>

359
00:17:16,290 --> 00:17:22,260
and this is the<font color="#CCCCCC"> example in the slide you</font>

360
00:17:20,699 --> 00:17:24,660
can see that<font color="#CCCCCC"> the first variable press</font>

361
00:17:22,260 --> 00:17:29,220
with capital u which means a<font color="#CCCCCC"> 32-bit</font>

362
00:17:24,660 --> 00:17:34,170
array it has a name of<font color="#CCCCCC"> ff01 and an array</font>

363
00:17:29,220 --> 00:17:36,270
value of<font color="#CCCCCC"> 13 7</font><font color="#E5E5E5"> furthermore the protocol</font>

364
00:17:34,170 --> 00:17:40,980
<font color="#E5E5E5">has been built in our known variables</font>

365
00:17:36,270 --> 00:17:43,050
for example uppercase<font color="#CCCCCC"> uff</font><font color="#E5E5E5"> ooo one from</font>

366
00:17:40,980 --> 00:17:46,680
the previous vehicle campus system<font color="#E5E5E5"> suit</font>

367
00:17:43,050 --> 00:17:49,200
and lower pay see you at<font color="#CCCCCC"> that of Devon's</font>

368
00:17:46,680 --> 00:17:53,610
<font color="#E5E5E5">answer</font><font color="#CCCCCC"> commands</font><font color="#E5E5E5"> I've listened time the</font>

369
00:17:49,200 --> 00:17:55,980
other<font color="#CCCCCC"> built in sludge so hopefully we</font>

370
00:17:53,610 --> 00:17:58,050
understand the basics of<font color="#E5E5E5"> the cornet but</font>

371
00:17:55,980 --> 00:18:01,200
<font color="#E5E5E5">obviously we don't understand what any</font>

372
00:17:58,050 --> 00:18:03,720
<font color="#E5E5E5">of that mean stuff</font><font color="#CCCCCC"> like system to like</font>

373
00:18:01,200 --> 00:18:05,100
what is that if we look<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> decrypted</font>

374
00:18:03,720 --> 00:18:08,100
traffic there are all<font color="#E5E5E5"> sorts of</font>

375
00:18:05,100 --> 00:18:10,409
<font color="#CCCCCC">differences in to array values some have</font>

376
00:18:08,100 --> 00:18:12,110
one entry some have two entries<font color="#E5E5E5"> and</font>

377
00:18:10,410 --> 00:18:14,670
they're all total different numbers

378
00:18:12,110 --> 00:18:17,129
now there's one<font color="#E5E5E5"> line in the JavaScript</font>

379
00:18:14,670 --> 00:18:18,330
<font color="#E5E5E5">that gives us the innings</font><font color="#CCCCCC"> and the</font>

380
00:18:17,130 --> 00:18:21,390
example in this<font color="#CCCCCC"> lie</font>

381
00:18:18,330 --> 00:18:23,970
<font color="#E5E5E5">the system</font><font color="#CCCCCC"> 2 is</font><font color="#E5E5E5"> set to ID underscore</font>

382
00:18:21,390 --> 00:18:27,090
file man and the thought<font color="#CCCCCC"> IBU on</font><font color="#E5E5E5"> short</font>

383
00:18:23,970 --> 00:18:29,010
<font color="#CCCCCC">bursts</font><font color="#E5E5E5"> it turns out that file man the</font>

384
00:18:27,090 --> 00:18:33,199
name<font color="#E5E5E5"> of a binary putting in</font><font color="#CCCCCC"> router is</font>

385
00:18:29,010 --> 00:18:33,200
<font color="#CCCCCC">files with them within Millett left in</font>

386
00:18:33,380 --> 00:18:40,640
now in my own<font color="#E5E5E5"> bug hunting journey of the</font>

387
00:18:37,950 --> 00:18:44,010
deal time<font color="#E5E5E5"> pass before I thump upon this</font>

388
00:18:40,640 --> 00:18:46,050
so eventually I found<font color="#CCCCCC"> the</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> that</font>

389
00:18:44,010 --> 00:18:49,200
excrete file you by the no<font color="#E5E5E5"> vote left</font>

390
00:18:46,050 --> 00:18:51,540
<font color="#CCCCCC">pimp rush loader binary the final this</font>

391
00:18:49,200 --> 00:18:53,010
caught my<font color="#E5E5E5"> attention finally because it</font>

392
00:18:51,540 --> 00:18:55,260
lists<font color="#CCCCCC"> all</font><font color="#E5E5E5"> the other know</font><font color="#CCCCCC"> the question</font>

393
00:18:53,010 --> 00:18:57,300
<font color="#E5E5E5">binary in it and there's</font><font color="#CCCCCC"> some type of</font>

394
00:18:55,260 --> 00:18:59,270
<font color="#E5E5E5">pattern but just</font><font color="#CCCCCC"> started pulling</font><font color="#E5E5E5"> the</font>

395
00:18:57,300 --> 00:19:01,760
plug

396
00:18:59,270 --> 00:19:03,740
<font color="#CCCCCC">and this slide pulled apart by pulled</font>

397
00:19:01,760 --> 00:19:07,129
out<font color="#E5E5E5"> single entry from the</font><font color="#CCCCCC"> systemic</font><font color="#E5E5E5"> three</font>

398
00:19:03,740 --> 00:19:10,460
file and this entries<font color="#E5E5E5"> for Nova clash in</font>

399
00:19:07,130 --> 00:19:13,280
<font color="#CCCCCC">Wroclaw</font><font color="#E5E5E5"> each entry has been associated</font>

400
00:19:10,460 --> 00:19:16,100
with an ASCII numbers<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> you</font>

401
00:19:13,280 --> 00:19:18,200
can see<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Nova - that logs a crispy</font>

402
00:19:16,100 --> 00:19:21,649
<font color="#CCCCCC">it opens</font><font color="#E5E5E5"> with the number</font><font color="#CCCCCC"> 3 highlighted</font>

403
00:19:18,200 --> 00:19:24,530
that<font color="#CCCCCC"> Anila so is it possible that three</font>

404
00:19:21,650 --> 00:19:29,240
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the log is blogs that we remembered</font>

405
00:19:24,530 --> 00:19:31,160
the<font color="#CCCCCC"> picture here</font><font color="#E5E5E5"> is some decrypted</font>

406
00:19:29,240 --> 00:19:34,690
traffic where the system<font color="#CCCCCC"> that - starts</font>

407
00:19:31,160 --> 00:19:37,280
with upgrades the contents of this trap

408
00:19:34,690 --> 00:19:40,250
the<font color="#CCCCCC"> content</font><font color="#E5E5E5"> of this traffic is was a</font>

409
00:19:37,280 --> 00:19:44,330
retro applause file utility a number of

410
00:19:40,250 --> 00:19:45,679
user admin logged in entry so I would

411
00:19:44,330 --> 00:19:51,490
say it appeared that the system back

412
00:19:45,679 --> 00:19:51,490
through file does map the city that is

413
00:19:51,850 --> 00:19:55,428
fortunately no one<font color="#CCCCCC"> equal parts of</font>

414
00:19:53,750 --> 00:19:57,020
expertise my hands<font color="#CCCCCC"> because I wrote the</font>

415
00:19:55,429 --> 00:19:59,720
tool to do<font color="#E5E5E5"> it</font>

416
00:19:57,020 --> 00:20:02,600
x3<font color="#CCCCCC"> park will take in system by x3 found</font>

417
00:19:59,720 --> 00:20:03,980
that out all those mapping and from what

418
00:20:02,600 --> 00:20:06,649
I've observed<font color="#E5E5E5"> these mappings don't</font>

419
00:20:03,980 --> 00:20:08,420
really change across version it's more

420
00:20:06,650 --> 00:20:12,070
likely that new map things are added

421
00:20:08,420 --> 00:20:12,070
<font color="#CCCCCC">with mikrotik rules out any features</font>

422
00:20:12,160 --> 00:20:16,460
without you

423
00:20:13,850 --> 00:20:18,889
<font color="#CCCCCC">Durbin T old - thinking what about</font>

424
00:20:16,460 --> 00:20:20,690
forward if you didn't<font color="#E5E5E5"> notice in the</font>

425
00:20:18,890 --> 00:20:22,580
previous<font color="#E5E5E5"> vlog again called the</font><font color="#CCCCCC"> system's</font>

426
00:20:20,690 --> 00:20:24,470
<font color="#CCCCCC">new array had two</font><font color="#E5E5E5"> numbers in it up three</font>

427
00:20:22,580 --> 00:20:27,770
that we've learned is associated<font color="#CCCCCC"> with a</font>

428
00:20:24,470 --> 00:20:30,679
binary<font color="#CCCCCC"> if it's legal on</font><font color="#E5E5E5"> fire and a</font><font color="#CCCCCC"> four</font>

429
00:20:27,770 --> 00:20:32,540
which I totally<font color="#E5E5E5"> ignored on the left side</font>

430
00:20:30,679 --> 00:20:34,910
of on<font color="#E5E5E5"> the left side of the slide</font><font color="#CCCCCC"> will be</font>

431
00:20:32,540 --> 00:20:36,370
a<font color="#CCCCCC"> screen shot</font><font color="#E5E5E5"> from Nova questions I</font>

432
00:20:34,910 --> 00:20:38,600
<font color="#CCCCCC">login hider</font>

433
00:20:36,370 --> 00:20:40,459
you should know that that<font color="#CCCCCC"> the repeated</font>

434
00:20:38,600 --> 00:20:42,520
<font color="#E5E5E5">calls to add handle are associated with</font>

435
00:20:40,460 --> 00:20:44,720
<font color="#E5E5E5">a</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> and a handler</font><font color="#CCCCCC"> winter</font>

436
00:20:42,520 --> 00:20:50,750
you're now looking at the second number

437
00:20:44,720 --> 00:20:52,280
is<font color="#CCCCCC"> the tool right now handler is an</font>

438
00:20:50,750 --> 00:20:55,340
object that handles different commands

439
00:20:52,280 --> 00:20:57,800
<font color="#E5E5E5">into it on the right and see Android</font>

440
00:20:55,340 --> 00:21:01,070
number<font color="#E5E5E5"> four and the Nova flash</font><font color="#CCCCCC"> pin</font><font color="#E5E5E5"> plus</font>

441
00:20:57,800 --> 00:21:06,159
log binary messages with<font color="#CCCCCC"> us to</font><font color="#E5E5E5"> come to</font>

442
00:21:01,070 --> 00:21:08,629
of<font color="#E5E5E5"> three four or handled by this project</font>

443
00:21:06,160 --> 00:21:10,460
<font color="#E5E5E5">now an obvious question at this point is</font>

444
00:21:08,630 --> 00:21:12,770
how many<font color="#CCCCCC"> systems to endpoint and</font>

445
00:21:10,460 --> 00:21:15,980
brighter or are there

446
00:21:12,770 --> 00:21:16,790
<font color="#E5E5E5">we have to manually map them</font><font color="#CCCCCC"> the answer</font>

447
00:21:15,980 --> 00:21:18,710
is no we go

448
00:21:16,790 --> 00:21:21,440
I wrote a binary ninda script that will

449
00:21:18,710 --> 00:21:23,530
be look<font color="#CCCCCC"> for us the script takes</font><font color="#E5E5E5"> in a</font>

450
00:21:21,440 --> 00:21:26,630
Directorate<font color="#E5E5E5"> binary</font>

451
00:21:23,530 --> 00:21:28,780
ideally<font color="#E5E5E5"> Novick left in and sets out the</font>

452
00:21:26,630 --> 00:21:31,190
handler numbers associated each binary

453
00:21:28,780 --> 00:21:32,809
the screen<font color="#CCCCCC"> sha and</font><font color="#E5E5E5"> this slide</font><font color="#CCCCCC"> shows the</font>

454
00:21:31,190 --> 00:21:35,630
handler numbers from the first view

455
00:21:32,809 --> 00:21:37,730
<font color="#E5E5E5">process binaries</font><font color="#CCCCCC"> you can see some of the</font>

456
00:21:35,630 --> 00:21:40,250
binaries you have one<font color="#CCCCCC"> Handler</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> others</font>

457
00:21:37,730 --> 00:21:41,179
<font color="#CCCCCC">a dozen</font><font color="#E5E5E5"> and there are appears to be no</font>

458
00:21:40,250 --> 00:21:45,950
real rhyme or reason

459
00:21:41,179 --> 00:21:48,950
how the handlers<font color="#CCCCCC"> are numbered let's go</font>

460
00:21:45,950 --> 00:21:52,070
back<font color="#E5E5E5"> to the original example we now know</font>

461
00:21:48,950 --> 00:21:55,100
<font color="#E5E5E5">deck is assistant to or a</font><font color="#CCCCCC"> meme for this</font>

462
00:21:52,070 --> 00:21:57,500
message<font color="#E5E5E5"> just</font><font color="#CCCCCC"> a 7th</font><font color="#E5E5E5"> handler and the</font>

463
00:21:55,100 --> 00:21:59,209
<font color="#E5E5E5">binary that is</font><font color="#CCCCCC"> map authority which</font>

464
00:21:57,500 --> 00:22:02,540
happens to be<font color="#E5E5E5"> no the</font><font color="#CCCCCC"> brush didn't clash</font>

465
00:21:59,210 --> 00:22:06,020
<font color="#CCCCCC">users but now it's the number and the</font>

466
00:22:02,540 --> 00:22:07,850
command variable<font color="#E5E5E5"> fortunately thanks for</font>

467
00:22:06,020 --> 00:22:10,280
very useful debugging functions and live

468
00:22:07,850 --> 00:22:13,550
you message<font color="#CCCCCC"> finding the fan mappings</font>

469
00:22:10,280 --> 00:22:15,410
<font color="#CCCCCC">will try the nuclei did I've listed the</font>

470
00:22:13,550 --> 00:22:18,050
known ones here we can see that<font color="#E5E5E5"> the</font>

471
00:22:15,410 --> 00:22:23,300
command provided in the example is oh by

472
00:22:18,050 --> 00:22:24,950
<font color="#E5E5E5">SEO oog or the victim and now I want to</font>

473
00:22:23,300 --> 00:22:27,379
<font color="#E5E5E5">draw</font><font color="#CCCCCC"> your attention to</font><font color="#E5E5E5"> by text the</font>

474
00:22:24,950 --> 00:22:28,730
<font color="#E5E5E5">right-hand corner it's actually really</font>

475
00:22:27,380 --> 00:22:32,179
important understand<font color="#E5E5E5"> what an unknown</font>

476
00:22:28,730 --> 00:22:35,240
command is an unknown man that any value

477
00:22:32,179 --> 00:22:37,160
<font color="#E5E5E5">not listed in this slide handle is that</font>

478
00:22:35,240 --> 00:22:39,290
<font color="#CCCCCC">youth unknowns man have to implement</font>

479
00:22:37,160 --> 00:22:45,950
<font color="#E5E5E5">their own functionality for</font><font color="#CCCCCC"> proper</font>

480
00:22:39,290 --> 00:22:48,920
<font color="#CCCCCC">things or commands now you're probably</font>

481
00:22:45,950 --> 00:22:51,110
thinking<font color="#E5E5E5"> there's a little sort of mating</font>

482
00:22:48,920 --> 00:22:55,160
<font color="#E5E5E5">making sense so</font><font color="#CCCCCC"> if I start talking about</font>

483
00:22:51,110 --> 00:22:57,590
bugs<font color="#CCCCCC"> but you're wrong</font><font color="#E5E5E5"> because micro</font>

484
00:22:55,160 --> 00:22:59,990
<font color="#E5E5E5">checks which the HTTP interface from the</font>

485
00:22:57,590 --> 00:23:03,409
<font color="#E5E5E5">JSON message format over to a binary</font>

486
00:22:59,990 --> 00:23:06,500
format<font color="#E5E5E5"> the wire presented a punk</font><font color="#CCCCCC"> will</font>

487
00:23:03,410 --> 00:23:08,690
<font color="#CCCCCC">Matt at all well I really like the JSON</font>

488
00:23:06,500 --> 00:23:12,050
format<font color="#E5E5E5"> once you understand it and pull</font>

489
00:23:08,690 --> 00:23:14,090
<font color="#CCCCCC">the read also micro tech didn't remove</font>

490
00:23:12,050 --> 00:23:17,178
the functionality<font color="#E5E5E5"> you can still talk</font>

491
00:23:14,090 --> 00:23:20,629
JSON response<font color="#CCCCCC"> page</font><font color="#E5E5E5"> if you perverts but</font>

492
00:23:17,179 --> 00:23:22,309
by default<font color="#CCCCCC"> it wants to talk binary but</font>

493
00:23:20,630 --> 00:23:25,070
it's not all bad<font color="#CCCCCC"> the underlying message</font>

494
00:23:22,309 --> 00:23:26,230
protocol is insane it's just<font color="#E5E5E5"> for magical</font>

495
00:23:25,070 --> 00:23:28,850
<font color="#E5E5E5">bit different</font>

496
00:23:26,230 --> 00:23:33,740
this<font color="#CCCCCC"> slide</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> yep</font><font color="#E5E5E5"> map a type name</font>

497
00:23:28,850 --> 00:23:35,899
value<font color="#E5E5E5"> and</font><font color="#CCCCCC"> book</font><font color="#E5E5E5"> format now unlike</font><font color="#CCCCCC"> the</font>

498
00:23:33,740 --> 00:23:40,100
JSON version which relies on the<font color="#CCCCCC"> wonders</font>

499
00:23:35,899 --> 00:23:42,908
<font color="#E5E5E5">the</font><font color="#CCCCCC"> binary version</font><font color="#E5E5E5"> so every</font><font color="#CCCCCC"> method shuts</font>

500
00:23:40,100 --> 00:23:45,889
off with a 1 by 1 plate<font color="#E5E5E5"> packet</font><font color="#CCCCCC"> links</font><font color="#E5E5E5"> a</font>

501
00:23:42,909 --> 00:23:48,970
security mode flag<font color="#CCCCCC"> 2 bytes the total</font>

502
00:23:45,889 --> 00:23:51,199
message length and then<font color="#E5E5E5"> the magic M -</font>

503
00:23:48,970 --> 00:23:54,500
all that<font color="#CCCCCC"> is finally followed by the</font>

504
00:23:51,200 --> 00:23:56,870
actual<font color="#CCCCCC"> message</font><font color="#E5E5E5"> data note that the data</font>

505
00:23:54,500 --> 00:23:59,330
in<font color="#E5E5E5"> this slide is a as it appears on the</font>

506
00:23:56,870 --> 00:24:02,600
wire as an ID copy and paste<font color="#CCCCCC"> discrete</font>

507
00:23:59,330 --> 00:24:03,980
<font color="#E5E5E5">great from Wireshark so</font><font color="#CCCCCC"> we'll be</font>

508
00:24:02,600 --> 00:24:07,509
<font color="#E5E5E5">flipping</font><font color="#CCCCCC"> some the field can you talk</font>

509
00:24:03,980 --> 00:24:07,509
about how they're actually<font color="#CCCCCC"> constructed</font>

510
00:24:07,960 --> 00:24:13,580
<font color="#CCCCCC">so similar to the JSON version</font><font color="#E5E5E5"> type the</font>

511
00:24:11,090 --> 00:24:15,439
names immersion<font color="#CCCCCC"> from one</font><font color="#E5E5E5"> field in the</font>

512
00:24:13,580 --> 00:24:17,840
binary format the immersion<font color="#E5E5E5"> to a core</font>

513
00:24:15,440 --> 00:24:19,580
byte value with a high<font color="#CCCCCC"> eight</font><font color="#E5E5E5"> bits of the</font>

514
00:24:17,840 --> 00:24:22,428
type and the<font color="#E5E5E5"> well</font><font color="#CCCCCC"> of 24-bit both</font>

515
00:24:19,580 --> 00:24:24,500
variable names just<font color="#CCCCCC"> like the JSON on</font>

516
00:24:22,429 --> 00:24:26,659
that there are 14 different<font color="#E5E5E5"> types of</font>

517
00:24:24,500 --> 00:24:29,600
<font color="#E5E5E5">variables and in fact they're</font><font color="#CCCCCC"> the exact</font>

518
00:24:26,659 --> 00:24:33,769
names of variable types found in his

519
00:24:29,600 --> 00:24:35,389
employment and this slide<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the effect</font>

520
00:24:33,769 --> 00:24:38,330
the different versions that are easier

521
00:24:35,389 --> 00:24:40,219
to compare ruling values are sort of

522
00:24:38,330 --> 00:24:42,799
unique and how they're encoded and that

523
00:24:40,220 --> 00:24:44,570
the type field doubles as the<font color="#E5E5E5"> value the</font>

524
00:24:42,799 --> 00:24:48,500
type of oh one is true<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the type of</font>

525
00:24:44,570 --> 00:24:50,779
<font color="#CCCCCC">oil it falls variable to subscribe</font>

526
00:24:48,500 --> 00:24:53,840
integers<font color="#E5E5E5"> 2</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> 4 bytes of integer data</font>

527
00:24:50,779 --> 00:24:55,850
unless<font color="#E5E5E5"> a short day is that in that case</font>

528
00:24:53,840 --> 00:24:58,759
only one byte<font color="#CCCCCC"> of data will call variable</font>

529
00:24:55,850 --> 00:25:01,459
name the short<font color="#E5E5E5"> bit is lowest bit</font><font color="#CCCCCC"> and</font>

530
00:24:58,759 --> 00:25:02,299
type fields you can<font color="#CCCCCC"> slide an integer</font>

531
00:25:01,460 --> 00:25:04,460
<font color="#CCCCCC">variable</font>

532
00:25:02,299 --> 00:25:10,190
normally has a type of<font color="#E5E5E5"> 8 but when the</font>

533
00:25:04,460 --> 00:25:11,929
short<font color="#CCCCCC"> day is</font><font color="#E5E5E5"> that as a type</font><font color="#CCCCCC"> of 9 now</font>

534
00:25:10,190 --> 00:25:13,940
similar to<font color="#CCCCCC"> the previous example the</font>

535
00:25:11,929 --> 00:25:17,629
<font color="#CCCCCC">short bit control the size of the length</font>

536
00:25:13,940 --> 00:25:19,820
of<font color="#CCCCCC"> a string variable normally a string</font>

537
00:25:17,629 --> 00:25:23,709
<font color="#E5E5E5">length is 2 bytes but with the</font><font color="#CCCCCC"> shortcut</font>

538
00:25:19,820 --> 00:25:23,710
<font color="#E5E5E5">set</font><font color="#CCCCCC"> feel this</font><font color="#E5E5E5"> with one break</font>

539
00:25:24,210 --> 00:25:29,490
and the<font color="#CCCCCC"> message type literally messages</font>

540
00:25:27,059 --> 00:25:30,990
embedded in the current method which

541
00:25:29,490 --> 00:25:33,990
means<font color="#E5E5E5"> that you're gonna see a preamble</font>

542
00:25:30,990 --> 00:25:37,409
<font color="#E5E5E5">again</font><font color="#CCCCCC"> here you can see the</font><font color="#E5E5E5"> m2 right</font>

543
00:25:33,990 --> 00:25:38,999
there in the middle<font color="#CCCCCC"> for t32 and again</font>

544
00:25:37,409 --> 00:25:42,210
you can see the<font color="#E5E5E5"> length field controlled</font>

545
00:25:38,999 --> 00:25:43,919
by a short day<font color="#CCCCCC"> kind of a funny side note</font>

546
00:25:42,210 --> 00:25:49,049
that I'm the only woman's ever laughed

547
00:25:43,919 --> 00:25:51,990
at it I<font color="#E5E5E5"> think CBE 2018</font><font color="#CCCCCC"> 11:50 58 describe</font>

548
00:25:49,049 --> 00:25:53,850
<font color="#CCCCCC">calm architects json parser</font><font color="#E5E5E5"> me unbounded</font>

549
00:25:51,990 --> 00:25:56,820
recursive<font color="#CCCCCC"> call to handle embedded</font>

550
00:25:53,850 --> 00:25:58,980
messages if a method recursive deep

551
00:25:56,820 --> 00:26:02,309
enough an attacker for<font color="#E5E5E5"> the exact goal of</font>

552
00:25:58,980 --> 00:26:03,600
the system<font color="#E5E5E5"> would reduce how was the one</font>

553
00:26:02,309 --> 00:26:05,730
that<font color="#E5E5E5"> actually recorded that form of</font>

554
00:26:03,600 --> 00:26:08,759
abilities as you can see<font color="#CCCCCC"> Evert in the</font>

555
00:26:05,730 --> 00:26:11,100
<font color="#E5E5E5">paramount is code for the project</font><font color="#CCCCCC"> so the</font>

556
00:26:08,759 --> 00:26:15,450
funny part is that<font color="#CCCCCC"> this bugs still</font>

557
00:26:11,100 --> 00:26:17,759
<font color="#CCCCCC">exists my hood now the</font><font color="#E5E5E5"> length field in</font>

558
00:26:15,450 --> 00:26:20,490
an array variable actually<font color="#CCCCCC"> describes the</font>

559
00:26:17,759 --> 00:26:23,399
<font color="#E5E5E5">number of entries in the array this</font>

560
00:26:20,490 --> 00:26:25,549
example the<font color="#CCCCCC"> length visit to and the</font>

561
00:26:23,399 --> 00:26:28,289
length is followed<font color="#CCCCCC"> by</font><font color="#E5E5E5"> two 32-bit</font><font color="#CCCCCC"> AMR</font>

562
00:26:25,549 --> 00:26:31,679
that's because the variable type is a

563
00:26:28,289 --> 00:26:36,749
32-bit<font color="#CCCCCC"> array so two entries gives us two</font>

564
00:26:31,679 --> 00:26:38,789
32-bit arrays I'm impressed you guys

565
00:26:36,749 --> 00:26:41,460
have hung on<font color="#E5E5E5"> this long I'm done</font>

566
00:26:38,789 --> 00:26:43,919
describing the protocol field<font color="#CCCCCC"> I won't be</font>

567
00:26:41,460 --> 00:26:47,369
mapping date on the binary anymore we're

568
00:26:43,919 --> 00:26:48,749
getting closer<font color="#E5E5E5"> to this stuff</font><font color="#CCCCCC"> micro tech</font>

569
00:26:47,369 --> 00:26:51,209
offers a<font color="#E5E5E5"> pic client</font><font color="#CCCCCC"> a router</font>

570
00:26:48,749 --> 00:26:54,149
configuration called wind box and it

571
00:26:51,210 --> 00:26:55,740
communicates<font color="#CCCCCC"> on eighty to ninety one now</font>

572
00:26:54,149 --> 00:26:57,860
that turns out it<font color="#CCCCCC"> uses the binary</font>

573
00:26:55,740 --> 00:27:00,539
message protocol<font color="#CCCCCC"> by this was Drive I</font>

574
00:26:57,860 --> 00:27:03,299
wasn't totally wasting your time you now

575
00:27:00,539 --> 00:27:08,100
know how<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> to pull HTTP and the</font>

576
00:27:03,299 --> 00:27:11,100
wind block<font color="#CCCCCC"> port and of course I had to</font>

577
00:27:08,100 --> 00:27:13,619
<font color="#E5E5E5">write</font><font color="#CCCCCC"> partner Corwin</font><font color="#E5E5E5"> boxes low but</font>

578
00:27:11,100 --> 00:27:15,178
<font color="#E5E5E5">somewhere to the HCP</font><font color="#CCCCCC"> partners</font><font color="#E5E5E5"> this tool</font>

579
00:27:13,619 --> 00:27:18,509
takes<font color="#E5E5E5"> and the key</font><font color="#CCCCCC"> patents</font><font color="#E5E5E5"> gives out the</font>

580
00:27:15,179 --> 00:27:20,429
messages in JSON<font color="#CCCCCC"> format</font><font color="#E5E5E5"> Talos just</font>

581
00:27:18,509 --> 00:27:24,350
released a wire<font color="#CCCCCC"> carp detector</font><font color="#E5E5E5"> the</font>

582
00:27:20,429 --> 00:27:24,350
similar functionality is a week ago

583
00:27:29,260 --> 00:27:35,649
and knowing the method protocol is truly

584
00:27:32,200 --> 00:27:37,690
<font color="#CCCCCC">fundamental about hunting another OS now</font>

585
00:27:35,649 --> 00:27:39,610
that you know how to forms<font color="#E5E5E5"> now you know</font>

586
00:27:37,690 --> 00:27:42,039
what's<font color="#E5E5E5"> that you mean how handlers work</font>

587
00:27:39,610 --> 00:27:44,049
and how<font color="#E5E5E5"> to format messages you can</font><font color="#CCCCCC"> reach</font>

588
00:27:42,039 --> 00:27:46,720
<font color="#E5E5E5">any of these binaries in Nova question</font>

589
00:27:44,049 --> 00:27:51,850
which as you can<font color="#E5E5E5"> see you pretty large</font>

590
00:27:46,720 --> 00:27:52,450
attack<font color="#E5E5E5"> cursor and I know what you're</font>

591
00:27:51,850 --> 00:27:54,820
thinking

592
00:27:52,450 --> 00:27:57,580
<font color="#E5E5E5">this guy</font><font color="#CCCCCC"> pedal to talk about</font><font color="#E5E5E5"> hunting</font>

593
00:27:54,820 --> 00:27:59,639
<font color="#CCCCCC">matter oh</font><font color="#E5E5E5"> it doesn't prevent a single</font>

594
00:27:57,580 --> 00:28:03,610
<font color="#CCCCCC">damn bug in the first 30</font><font color="#E5E5E5"> minutes</font>

595
00:27:59,639 --> 00:28:06,100
well<font color="#CCCCCC"> you finally</font><font color="#E5E5E5"> made it I'm not done</font>

596
00:28:03,610 --> 00:28:08,080
<font color="#E5E5E5">talking about protocol jump</font><font color="#CCCCCC"> not by long</font>

597
00:28:06,100 --> 00:28:13,149
shot but ready<font color="#E5E5E5"> to talk about three</font>

598
00:28:08,080 --> 00:28:15,189
<font color="#CCCCCC">different bugs you can see on the left a</font>

599
00:28:13,149 --> 00:28:17,979
stack<font color="#E5E5E5"> overflow in the life looking up</font>

600
00:28:15,190 --> 00:28:20,799
great binary<font color="#CCCCCC"> system our ability can</font><font color="#E5E5E5"> be</font>

601
00:28:17,980 --> 00:28:23,340
<font color="#E5E5E5">triggered remotely through</font><font color="#CCCCCC"> inbox or HTTP</font>

602
00:28:20,799 --> 00:28:25,720
<font color="#E5E5E5">but it requires authentication</font><font color="#CCCCCC"> I</font>

603
00:28:23,340 --> 00:28:30,480
reported the former ability and they may

604
00:28:25,720 --> 00:28:32,799
and<font color="#E5E5E5"> mikrotik relief was</font><font color="#CCCCCC"> hash in August</font>

605
00:28:30,480 --> 00:28:35,740
now one of the ways<font color="#E5E5E5"> I like to start by</font>

606
00:28:32,799 --> 00:28:37,899
hunting elf binaries and<font color="#CCCCCC"> I know a lot of</font>

607
00:28:35,740 --> 00:28:40,570
people<font color="#E5E5E5"> do this but I just look at the</font>

608
00:28:37,899 --> 00:28:44,049
imports and find any known bad functions

609
00:28:40,570 --> 00:28:47,260
like system<font color="#E5E5E5"> the exact functions print</font>

610
00:28:44,049 --> 00:28:48,820
deaths or coffee whatever<font color="#E5E5E5"> when I was</font>

611
00:28:47,260 --> 00:28:51,820
looking<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the license upgrade binary I</font>

612
00:28:48,820 --> 00:28:54,809
found this<font color="#E5E5E5"> print testing for me HTTP GET</font>

613
00:28:51,820 --> 00:28:57,250
collection now<font color="#E5E5E5"> obviously at this point</font>

614
00:28:54,809 --> 00:28:59,590
location I have<font color="#E5E5E5"> no clue</font><font color="#CCCCCC"> if I can</font><font color="#E5E5E5"> control</font>

615
00:28:57,250 --> 00:29:00,760
any<font color="#E5E5E5"> of these</font><font color="#CCCCCC"> parameters but it looks</font>

616
00:28:59,590 --> 00:29:02,500
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> interesting</font>

617
00:29:00,760 --> 00:29:05,320
<font color="#E5E5E5">you're the name and password parameters</font>

618
00:29:02,500 --> 00:29:07,149
really could have to me look figure out

619
00:29:05,320 --> 00:29:12,070
where those that<font color="#E5E5E5"> come from</font><font color="#CCCCCC"> the even</font>

620
00:29:07,149 --> 00:29:14,649
Colvin's<font color="#CCCCCC"> liddie method has a whole</font><font color="#E5E5E5"> bunch</font>

621
00:29:12,070 --> 00:29:18,189
of helper functions for polling variable

622
00:29:14,649 --> 00:29:20,918
<font color="#CCCCCC">out of messages on this side of the Z 2</font>

623
00:29:18,190 --> 00:29:24,639
has functions<font color="#E5E5E5"> looking for to string IDs</font>

624
00:29:20,919 --> 00:29:26,769
<font color="#CCCCCC">during</font><font color="#E5E5E5"> a t1 speech dramatically we can</font>

625
00:29:24,639 --> 00:29:29,469
also see<font color="#E5E5E5"> that the have functions fail</font>

626
00:29:26,769 --> 00:29:32,169
<font color="#E5E5E5">the strings no usually a notepad forget</font>

627
00:29:29,470 --> 00:29:34,029
<font color="#CCCCCC">but</font><font color="#E5E5E5"> rounded</font><font color="#CCCCCC"> up that but clearly</font><font color="#E5E5E5"> during</font>

628
00:29:32,169 --> 00:29:37,210
one<font color="#CCCCCC"> of the username was from two</font>

629
00:29:34,029 --> 00:29:39,669
aspirins<font color="#E5E5E5"> my CDs have</font><font color="#CCCCCC"> some method</font>

630
00:29:37,210 --> 00:29:42,460
function<font color="#E5E5E5"> I generally assume that I can</font>

631
00:29:39,669 --> 00:29:42,850
<font color="#CCCCCC">pick this code over</font><font color="#E5E5E5"> the network and I</font>

632
00:29:42,460 --> 00:29:45,940
have

633
00:29:42,850 --> 00:29:47,320
called contents<font color="#E5E5E5"> so that the case we</font><font color="#CCCCCC"> just</font>

634
00:29:45,940 --> 00:29:50,310
need to figure out<font color="#E5E5E5"> how we can actually</font>

635
00:29:47,320 --> 00:29:50,310
<font color="#E5E5E5">reach</font><font color="#CCCCCC"> nobility</font>

636
00:29:51,420 --> 00:29:55,240
the first step to figuring out how to

637
00:29:53,620 --> 00:29:58,300
<font color="#E5E5E5">reach the</font><font color="#CCCCCC"> print ad if we figure</font><font color="#E5E5E5"> out this</font>

638
00:29:55,240 --> 00:30:00,160
will<font color="#CCCCCC"> be to array using the x3 parse pool</font>

639
00:29:58,300 --> 00:30:02,379
<font color="#E5E5E5">with the steps earlier you know that the</font>

640
00:30:00,160 --> 00:30:06,520
license<font color="#E5E5E5"> upgrade binaries system number</font>

641
00:30:02,380 --> 00:30:10,150
is 50<font color="#E5E5E5"> bucks so the question is what's</font>

642
00:30:06,520 --> 00:30:12,250
<font color="#E5E5E5">the handler number following the extras</font>

643
00:30:10,150 --> 00:30:13,990
in<font color="#E5E5E5"> Ida upwards we eventually arrived to</font>

644
00:30:12,250 --> 00:30:16,540
an unknown command function and the

645
00:30:13,990 --> 00:30:17,920
handler<font color="#E5E5E5"> pictured in this slide now this</font>

646
00:30:16,540 --> 00:30:20,290
handler<font color="#E5E5E5"> is part</font><font color="#CCCCCC"> of the main</font><font color="#E5E5E5"> looper</font>

647
00:30:17,920 --> 00:30:22,510
construction it is<font color="#E5E5E5"> an ad added using</font>

648
00:30:20,290 --> 00:30:24,970
<font color="#E5E5E5">that handler there's no special</font>

649
00:30:22,510 --> 00:30:28,600
<font color="#CCCCCC">right-hand no</font><font color="#E5E5E5"> special handler ie for</font>

650
00:30:24,970 --> 00:30:31,090
this<font color="#CCCCCC"> object so to send a message to</font><font color="#E5E5E5"> this</font>

651
00:30:28,600 --> 00:30:38,080
handler<font color="#E5E5E5"> we simply use an array with one</font>

652
00:30:31,090 --> 00:30:40,419
injury of 55 so we notice the compute

653
00:30:38,080 --> 00:30:43,060
<font color="#CCCCCC">know the commands</font><font color="#E5E5E5"> to send in order to</font>

654
00:30:40,420 --> 00:30:44,860
reach<font color="#E5E5E5"> this</font><font color="#CCCCCC"> print deputies the handlers</font>

655
00:30:43,060 --> 00:30:46,450
implementation of the unknown command

656
00:30:44,860 --> 00:30:49,330
function is basically<font color="#CCCCCC"> a switch statement</font>

657
00:30:46,450 --> 00:30:51,430
on the<font color="#E5E5E5"> command value and the</font><font color="#CCCCCC"> other</font>

658
00:30:49,330 --> 00:30:54,370
<font color="#CCCCCC">screenshot in this wise even feeds two</font>

659
00:30:51,430 --> 00:30:56,890
cases one in<font color="#CCCCCC"> forest</font><font color="#E5E5E5"> that lead down the</font>

660
00:30:54,370 --> 00:30:58,810
<font color="#E5E5E5">function that calls for death so we</font>

661
00:30:56,890 --> 00:31:01,090
should be fine<font color="#E5E5E5"> using either commands</font><font color="#CCCCCC"> 1</font>

662
00:30:58,810 --> 00:31:06,190
or<font color="#CCCCCC"> 4 and the message protocol demands</font>

663
00:31:01,090 --> 00:31:07,810
<font color="#CCCCCC">variables the very last part</font><font color="#E5E5E5"> to reach</font>

664
00:31:06,190 --> 00:31:09,670
<font color="#CCCCCC">this code we just</font><font color="#E5E5E5"> need to collect</font>

665
00:31:07,810 --> 00:31:12,850
remaining parameters who might need

666
00:31:09,670 --> 00:31:14,650
<font color="#E5E5E5">effective</font><font color="#CCCCCC"> birth the code</font><font color="#E5E5E5"> passed in the</font>

667
00:31:12,850 --> 00:31:17,409
previous slide there was a pool variable

668
00:31:14,650 --> 00:31:18,580
the<font color="#CCCCCC"> ninetieth 7 pictured in this platter</font>

669
00:31:17,410 --> 00:31:20,350
<font color="#CCCCCC">two-and-thirty</font>

670
00:31:18,580 --> 00:31:22,659
<font color="#CCCCCC">who's being extracted from the message</font>

671
00:31:20,350 --> 00:31:24,370
ID 3<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it6</font>

672
00:31:22,660 --> 00:31:26,680
but<font color="#CCCCCC"> i don't really see any</font><font color="#E5E5E5"> of these</font>

673
00:31:24,370 --> 00:31:29,949
being used<font color="#E5E5E5"> until after this printf is</font>

674
00:31:26,680 --> 00:31:33,310
hit so we probably don't<font color="#E5E5E5"> need anything</font>

675
00:31:29,950 --> 00:31:34,780
specific in there for our purposes<font color="#E5E5E5"> at</font>

676
00:31:33,310 --> 00:31:38,700
the<font color="#E5E5E5"> bottom of this slide you'll see a</font>

677
00:31:34,780 --> 00:31:38,700
<font color="#CCCCCC">poll</font><font color="#E5E5E5"> method who wants to send in JSON</font>

678
00:31:39,690 --> 00:31:46,140
but before<font color="#E5E5E5"> we test that message can we</font>

679
00:31:43,660 --> 00:31:49,720
hit this printf without authentication

680
00:31:46,140 --> 00:31:52,210
<font color="#E5E5E5">sure I told you earlier</font><font color="#CCCCCC"> that CVE 2018</font>

681
00:31:49,720 --> 00:31:55,420
<font color="#CCCCCC">1156 requires authentication but i</font>

682
00:31:52,210 --> 00:31:56,850
didn't<font color="#E5E5E5"> offer any ebony here to hear some</font>

683
00:31:55,420 --> 00:31:58,440
evidence

684
00:31:56,850 --> 00:32:01,379
I've learned that every unknown command

685
00:31:58,440 --> 00:32:03,990
to assign<font color="#CCCCCC"> apologies</font><font color="#E5E5E5"> in this slide</font>

686
00:32:01,380 --> 00:32:07,350
screenshot you can<font color="#E5E5E5"> see commands</font><font color="#CCCCCC"> 116</font><font color="#E5E5E5"> find</font>

687
00:32:03,990 --> 00:32:10,710
<font color="#E5E5E5">a policy of</font><font color="#CCCCCC"> a hundred heck what</font><font color="#E5E5E5"> exactly</font>

688
00:32:07,350 --> 00:32:13,139
does that mean<font color="#E5E5E5"> I'm not entirely sure</font><font color="#CCCCCC"> but</font>

689
00:32:10,710 --> 00:32:16,889
<font color="#CCCCCC">what I do know that</font><font color="#E5E5E5"> commands that don't</font>

690
00:32:13,139 --> 00:32:20,008
require off<font color="#CCCCCC"> they have a policy at</font><font color="#E5E5E5"> zero</font>

691
00:32:16,889 --> 00:32:26,820
<font color="#E5E5E5">and as such none of the license operate</font>

692
00:32:20,009 --> 00:32:28,200
<font color="#E5E5E5">unknown the ends are unaffected now we</font>

693
00:32:26,820 --> 00:32:30,299
have<font color="#E5E5E5"> everything we</font><font color="#CCCCCC"> need to write</font><font color="#E5E5E5"> proof</font>

694
00:32:28,200 --> 00:32:32,820
concepts<font color="#E5E5E5"> I'd like to highlight a few</font>

695
00:32:30,299 --> 00:32:34,110
<font color="#CCCCCC">things on the screen on the right the</font>

696
00:32:32,820 --> 00:32:36,990
part of<font color="#CCCCCC"> the project</font><font color="#E5E5E5"> I wrote a message</font>

697
00:32:34,110 --> 00:32:40,168
implementation<font color="#CCCCCC"> and creating them even</font>

698
00:32:36,990 --> 00:32:42,269
nested<font color="#CCCCCC"> v's you can see in the court POC</font>

699
00:32:40,169 --> 00:32:45,029
that<font color="#E5E5E5"> methods instructions</font><font color="#CCCCCC"> serial</font>

700
00:32:42,269 --> 00:32:47,669
function call and<font color="#CCCCCC"> all the formatting is</font>

701
00:32:45,029 --> 00:32:50,730
handled for<font color="#CCCCCC"> you also know how simple it</font>

702
00:32:47,669 --> 00:32:52,710
is this<font color="#E5E5E5"> year life energy stays on the PC</font>

703
00:32:50,730 --> 00:32:54,809
<font color="#CCCCCC">ot also relies on the joy of coffee</font>

704
00:32:52,710 --> 00:32:58,200
<font color="#E5E5E5">second class of the handles</font>

705
00:32:54,809 --> 00:33:00,840
authentication and session<font color="#CCCCCC"> Madre</font><font color="#E5E5E5"> you can</font>

706
00:32:58,200 --> 00:33:03,029
also see the I've shot 512 bytes of<font color="#E5E5E5"> the</font>

707
00:33:00,840 --> 00:33:03,990
letter<font color="#CCCCCC"> A and username field and</font><font color="#E5E5E5"> the</font>

708
00:33:03,029 --> 00:33:08,210
password<font color="#E5E5E5"> field</font>

709
00:33:03,990 --> 00:33:08,210
so<font color="#CCCCCC"> this PLC</font><font color="#E5E5E5"> will trigger the back</font><font color="#CCCCCC"> over</font>

710
00:33:08,389 --> 00:33:13,918
now it's kind of tedious<font color="#E5E5E5"> look up every</font>

711
00:33:10,980 --> 00:33:17,250
single<font color="#E5E5E5"> Handler and government but the</font>

712
00:33:13,919 --> 00:33:19,289
man<font color="#CCCCCC"> falls buying so I wrote it cool it</font>

713
00:33:17,250 --> 00:33:22,590
<font color="#CCCCCC">doesn't automatically they take from the</font>

714
00:33:19,289 --> 00:33:24,240
<font color="#E5E5E5">x3 Parker output and the fine handlers</font>

715
00:33:22,590 --> 00:33:26,158
output and it tends get<font color="#E5E5E5"> all of your</font>

716
00:33:24,240 --> 00:33:28,529
requests<font color="#E5E5E5"> everything will handle in</font>

717
00:33:26,159 --> 00:33:30,120
<font color="#CCCCCC">system when the script</font><font color="#E5E5E5"> is finished</font>

718
00:33:28,529 --> 00:33:32,190
running you've mapped out the entire

719
00:33:30,120 --> 00:33:34,799
attack surface of<font color="#CCCCCC"> the novus up in</font>

720
00:33:32,190 --> 00:33:36,269
directories<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the network protocol we</font>

721
00:33:34,799 --> 00:33:40,740
also have a<font color="#E5E5E5"> really clear picture of how</font>

722
00:33:36,269 --> 00:33:46,500
many commands can be invocation and with

723
00:33:40,740 --> 00:33:48,360
that number<font color="#CCCCCC"> 870 degrees</font><font color="#E5E5E5"> man's let's talk</font>

724
00:33:46,500 --> 00:33:53,759
about<font color="#E5E5E5"> a bug being actively avoided in</font>

725
00:33:48,360 --> 00:33:55,979
<font color="#E5E5E5">the wild CBE 2018 working 14</font><font color="#CCCCCC"> K port</font>

726
00:33:53,759 --> 00:33:59,179
<font color="#CCCCCC">seven that being used to obtain</font><font color="#E5E5E5"> you</font>

727
00:33:55,980 --> 00:34:01,559
admitted any<font color="#CCCCCC"> whole router or</font><font color="#E5E5E5"> system</font>

728
00:33:59,179 --> 00:34:03,629
attackers have used those credentials<font color="#E5E5E5"> to</font>

729
00:34:01,559 --> 00:34:06,149
insert coin<font color="#E5E5E5"> high on JavaScript and oral</font>

730
00:34:03,629 --> 00:34:09,199
core pages<font color="#CCCCCC"> talking network traffic</font><font color="#E5E5E5"> and</font>

731
00:34:06,149 --> 00:34:12,138
<font color="#E5E5E5">you know what else</font><font color="#CCCCCC"> but</font>

732
00:34:09,199 --> 00:34:15,888
good<font color="#CCCCCC"> write-up Don project though the PVD</font>

733
00:34:12,139 --> 00:34:18,109
entries descriptions it because when box

734
00:34:15,889 --> 00:34:20,060
for mikrotik router<font color="#E5E5E5"> OS</font><font color="#CCCCCC"> booth picked up</font>

735
00:34:18,109 --> 00:34:22,578
or to<font color="#CCCCCC"> allow the gnome attackers and</font>

736
00:34:20,060 --> 00:34:25,639
bypass authentication<font color="#E5E5E5"> read arbitrary</font>

737
00:34:22,579 --> 00:34:29,510
files by modifying a request<font color="#E5E5E5"> and change</font>

738
00:34:25,639 --> 00:34:31,149
one by related<font color="#E5E5E5"> session ID now</font><font color="#CCCCCC"> if that</font>

739
00:34:29,510 --> 00:34:33,169
<font color="#E5E5E5">doesn't</font><font color="#CCCCCC"> make any</font><font color="#E5E5E5"> sense any of you</font>

740
00:34:31,149 --> 00:34:35,540
<font color="#CCCCCC">doesn't make income to me</font>

741
00:34:33,168 --> 00:34:38,239
but luckily there<font color="#E5E5E5"> there are a few</font>

742
00:34:35,540 --> 00:34:39,770
implementations on exploit<font color="#CCCCCC"> PV</font><font color="#E5E5E5"> haven't</font>

743
00:34:38,239 --> 00:34:43,368
<font color="#E5E5E5">they're largely talking</font><font color="#CCCCCC"> even pace of</font>

744
00:34:39,770 --> 00:34:46,550
each other<font color="#E5E5E5"> they all use the same text</font>

745
00:34:43,369 --> 00:34:51,349
<font color="#CCCCCC">log that's</font><font color="#E5E5E5"> really unclear what</font><font color="#CCCCCC"> that hex</font>

746
00:34:46,550 --> 00:34:53,089
<font color="#CCCCCC">blob means</font><font color="#E5E5E5"> so let's check</font><font color="#CCCCCC"> that out using</font>

747
00:34:51,349 --> 00:34:55,820
our newly acquired knowledge<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> limb</font>

748
00:34:53,089 --> 00:34:58,160
box<font color="#E5E5E5"> protocol we can simply convert the</font>

749
00:34:55,820 --> 00:35:00,920
<font color="#E5E5E5">perc blog so much easier to reach a</font>

750
00:34:58,160 --> 00:35:03,589
common format<font color="#E5E5E5"> you can see the system</font><font color="#CCCCCC"> to</font>

751
00:35:00,920 --> 00:35:05,810
array is<font color="#E5E5E5"> the binary number</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> and handler</font>

752
00:35:03,589 --> 00:35:08,630
number<font color="#E5E5E5"> 2 and furthermore the command</font>

753
00:35:05,810 --> 00:35:10,369
being used is<font color="#E5E5E5"> 7 and we do see that there</font>

754
00:35:08,630 --> 00:35:12,770
<font color="#CCCCCC">is correct Retriever</font><font color="#E5E5E5"> holes that you who</font>

755
00:35:10,369 --> 00:35:18,650
<font color="#E5E5E5">thought that file which does contain the</font>

756
00:35:12,770 --> 00:35:20,540
<font color="#CCCCCC">computer insul backwards people using</font>

757
00:35:18,650 --> 00:35:22,520
the<font color="#CCCCCC"> x3 parser we can put the determined</font>

758
00:35:20,540 --> 00:35:25,970
that binary<font color="#E5E5E5"> number 2 is actually no book</font>

759
00:35:22,520 --> 00:35:28,190
lessons<font color="#CCCCCC"> of 7 proxy</font><font color="#E5E5E5"> furthermore we can</font>

760
00:35:25,970 --> 00:35:30,618
<font color="#E5E5E5">quickly far in handler number 2 but</font>

761
00:35:28,190 --> 00:35:33,770
bonding by following an<font color="#CCCCCC"> ADD handler</font>

762
00:35:30,619 --> 00:35:36,170
calls in<font color="#E5E5E5"> M proxy and locating unknown</font>

763
00:35:33,770 --> 00:35:40,759
function<font color="#CCCCCC"> implements implementations fans</font>

764
00:35:36,170 --> 00:35:44,450
have dropped down into so what does

765
00:35:40,760 --> 00:35:47,390
<font color="#E5E5E5">command 7</font><font color="#CCCCCC"> actually do all it does is</font>

766
00:35:44,450 --> 00:35:51,529
open and open<font color="#E5E5E5"> an existing file and home</font>

767
00:35:47,390 --> 00:35:53,480
<font color="#E5E5E5">plus web web big for reading now M proxy</font>

768
00:35:51,530 --> 00:35:55,480
replies to the client with a session<font color="#E5E5E5"> ID</font>

769
00:35:53,480 --> 00:35:58,130
<font color="#E5E5E5">and size of the open file</font>

770
00:35:55,480 --> 00:36:00,109
<font color="#E5E5E5">I'm pictured here the</font><font color="#CCCCCC"> logics that</font><font color="#E5E5E5"> check</font>

771
00:35:58,130 --> 00:36:02,060
for direct referral

772
00:36:00,109 --> 00:36:05,150
it's actually really large<font color="#CCCCCC"> its</font>

773
00:36:02,060 --> 00:36:07,490
<font color="#E5E5E5">convoluted</font><font color="#CCCCCC"> it doesn't</font><font color="#E5E5E5"> fit into applied</font>

774
00:36:05,150 --> 00:36:11,619
and we're actually talking about this

775
00:36:07,490 --> 00:36:14,598
<font color="#CCCCCC">TV's CBE it</font><font color="#E5E5E5"> obviously doesn't work</font>

776
00:36:11,619 --> 00:36:17,720
so the first payload make sense<font color="#E5E5E5"> it opens</font>

777
00:36:14,599 --> 00:36:19,880
the user dot file for reading the second

778
00:36:17,720 --> 00:36:22,038
payload

779
00:36:19,880 --> 00:36:24,410
<font color="#E5E5E5">the assistants were rated M cross new</font>

780
00:36:22,039 --> 00:36:27,079
handler analyst do<font color="#CCCCCC"> command</font><font color="#E5E5E5"> account for</font>

781
00:36:24,410 --> 00:36:30,259
the<font color="#E5E5E5"> request ideas been incremented and</font>

782
00:36:27,079 --> 00:36:35,960
<font color="#E5E5E5">that 19 out ears there's also a new you</font>

783
00:36:30,259 --> 00:36:39,680
<font color="#E5E5E5">to variable so what does the command for</font>

784
00:36:35,960 --> 00:36:42,559
do<font color="#E5E5E5"> unsurprisingly that</font><font color="#CCCCCC"> reach from the</font>

785
00:36:39,680 --> 00:36:44,118
file opens in<font color="#CCCCCC"> loop and seven the read</font>

786
00:36:42,559 --> 00:36:47,059
the amount requested in the YouTube

787
00:36:44,119 --> 00:36:51,589
variable in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> agility hard-coded</font>

788
00:36:47,059 --> 00:36:53,359
be cute or<font color="#CCCCCC"> 32,768 and and</font><font color="#E5E5E5"> proxy reads</font>

789
00:36:51,589 --> 00:36:57,920
the file data<font color="#E5E5E5"> and send</font><font color="#CCCCCC"> it back color</font>

790
00:36:53,359 --> 00:37:01,038
reflector and that is all there is<font color="#CCCCCC"> TV</font>

791
00:36:57,920 --> 00:37:04,720
<font color="#E5E5E5">mm</font><font color="#CCCCCC"> support 2018 court in your court</font>

792
00:37:01,039 --> 00:37:07,099
<font color="#CCCCCC">seven and it's actually a really simple</font>

793
00:37:04,720 --> 00:37:09,348
but<font color="#E5E5E5"> I really</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> hex claw</font><font color="#E5E5E5"> of</font>

794
00:37:07,099 --> 00:37:11,599
implementation so I rewrote appeals

795
00:37:09,349 --> 00:37:14,359
<font color="#E5E5E5">using my method implementation and the</font>

796
00:37:11,599 --> 00:37:20,089
wind box a few class communities<font color="#E5E5E5"> just</font>

797
00:37:14,359 --> 00:37:21,828
easier<font color="#E5E5E5"> to understand</font><font color="#CCCCCC"> and one thing</font>

798
00:37:20,089 --> 00:37:24,049
you'll notice<font color="#E5E5E5"> is that we never talked</font>

799
00:37:21,829 --> 00:37:26,029
about authentication<font color="#E5E5E5"> if the TV's</font>

800
00:37:24,049 --> 00:37:28,759
description<font color="#CCCCCC"> clearly says five hats</font>

801
00:37:26,029 --> 00:37:30,500
authentication using the policy to

802
00:37:28,759 --> 00:37:33,710
discovery<font color="#E5E5E5"> cool we talked about earlier</font>

803
00:37:30,500 --> 00:37:36,410
it's clear that man<font color="#CCCCCC"> four and seven don't</font>

804
00:37:33,710 --> 00:37:38,210
require authentication involved actually

805
00:37:36,410 --> 00:37:40,910
the TV subscription is pretty confused

806
00:37:38,210 --> 00:37:46,250
<font color="#CCCCCC">all around so last</font><font color="#E5E5E5"> night actually</font><font color="#CCCCCC"> says</font>

807
00:37:40,910 --> 00:37:48,710
an<font color="#E5E5E5"> updated with script not my turn</font><font color="#CCCCCC"> and</font>

808
00:37:46,250 --> 00:37:49,759
by the way super<font color="#E5E5E5"> rrv here why don't</font><font color="#CCCCCC"> we</font>

809
00:37:48,710 --> 00:37:53,269
just<font color="#E5E5E5"> check out the other unknown</font>

810
00:37:49,759 --> 00:37:54,829
commands or<font color="#E5E5E5"> handler</font><font color="#CCCCCC"> tube after</font><font color="#E5E5E5"> poking</font>

811
00:37:53,269 --> 00:37:57,500
around a bit I found that commands one

812
00:37:54,829 --> 00:38:00,619
through seven<font color="#E5E5E5"> to following one open the</font>

813
00:37:57,500 --> 00:38:03,799
file to rights to<font color="#CCCCCC"> be open opens about</font>

814
00:38:00,619 --> 00:38:06,470
<font color="#E5E5E5">the writing to rights to that file free</font>

815
00:38:03,799 --> 00:38:09,200
<font color="#E5E5E5">open the file for reading</font><font color="#CCCCCC"> in for repeal</font>

816
00:38:06,470 --> 00:38:11,328
<font color="#CCCCCC">to file</font><font color="#E5E5E5"> five tamper with</font><font color="#CCCCCC"> transparent</font>

817
00:38:09,200 --> 00:38:14,629
<font color="#E5E5E5">delete the file six create the directory</font>

818
00:38:11,329 --> 00:38:19,220
<font color="#CCCCCC">in bars the package</font><font color="#E5E5E5"> and as we know seven</font>

819
00:38:14,630 --> 00:38:20,930
opens<font color="#CCCCCC"> the file for reading now as any of</font>

820
00:38:19,220 --> 00:38:23,180
that youthful or interesting that up

821
00:38:20,930 --> 00:38:25,700
<font color="#E5E5E5">most of those new commands require</font>

822
00:38:23,180 --> 00:38:28,339
authentication<font color="#E5E5E5"> none of us really care</font>

823
00:38:25,700 --> 00:38:32,359
<font color="#CCCCCC">because birthdate</font><font color="#E5E5E5"> hackers don't care</font>

824
00:38:28,339 --> 00:38:33,710
about<font color="#E5E5E5"> on</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> our PD just hold on</font><font color="#CCCCCC"> just</font>

825
00:38:32,359 --> 00:38:36,828
<font color="#E5E5E5">remember</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> TV</font>

826
00:38:33,710 --> 00:38:39,230
thousand<font color="#CCCCCC"> fourteen or seven allowed to</font>

827
00:38:36,829 --> 00:38:41,720
read<font color="#E5E5E5"> the</font><font color="#CCCCCC"> users dot that file is he'll</font>

828
00:38:39,230 --> 00:38:43,790
<font color="#CCCCCC">pretend roles so we can hit pretty</font><font color="#E5E5E5"> much</font>

829
00:38:41,720 --> 00:38:46,689
any code path without knowing<font color="#E5E5E5"> the</font><font color="#CCCCCC"> clips</font>

830
00:38:43,790 --> 00:38:49,400
beforehand so that<font color="#E5E5E5"> leaves me wondering</font>

831
00:38:46,690 --> 00:38:52,700
does the directory traversal<font color="#E5E5E5"> exist for</font>

832
00:38:49,400 --> 00:38:54,770
any other<font color="#CCCCCC"> demands</font><font color="#E5E5E5"> and the</font><font color="#CCCCCC"> Ida screenshot</font>

833
00:38:52,700 --> 00:38:56,660
the right you<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> the directory</font>

834
00:38:54,770 --> 00:39:00,079
traversal function which I created

835
00:38:56,660 --> 00:39:03,379
<font color="#CCCCCC">leaning check direct route purple is</font>

836
00:39:00,079 --> 00:39:05,510
shared by the<font color="#E5E5E5"> inform 3/7 both command</font>

837
00:39:03,380 --> 00:39:08,599
three and seven open<font color="#E5E5E5"> file reading</font><font color="#CCCCCC"> that's</font>

838
00:39:05,510 --> 00:39:13,520
pretty exciting<font color="#E5E5E5"> but command one opens</font>

839
00:39:08,599 --> 00:39:15,800
file writing<font color="#CCCCCC"> obviously writing new</font>

840
00:39:13,520 --> 00:39:19,009
functionality<font color="#E5E5E5"> for us what do we want to</font>

841
00:39:15,800 --> 00:39:21,170
<font color="#E5E5E5">write do we overwrite user dad maybe we</font>

842
00:39:19,010 --> 00:39:22,849
<font color="#CCCCCC">write in a net strip or maybe there's a</font>

843
00:39:21,170 --> 00:39:26,480
con on the system we<font color="#CCCCCC"> can take advantage</font>

844
00:39:22,849 --> 00:39:30,650
of or we can just write to develop the

845
00:39:26,480 --> 00:39:32,150
backdoor file what I<font color="#E5E5E5"> think works quite</font>

846
00:39:30,650 --> 00:39:35,270
nicely<font color="#CCCCCC"> I've written up a</font>

847
00:39:32,150 --> 00:39:37,280
<font color="#CCCCCC">proof-of-concept does this first deals</font>

848
00:39:35,270 --> 00:39:40,009
<font color="#CCCCCC">with credentials</font><font color="#E5E5E5"> and then creates that</font>

849
00:39:37,280 --> 00:39:42,319
<font color="#CCCCCC">gore file that</font><font color="#E5E5E5"> gives a remote</font>

850
00:39:40,010 --> 00:39:44,780
unauthenticated attacker<font color="#CCCCCC"> a route</font>

851
00:39:42,319 --> 00:39:46,460
terminal on<font color="#E5E5E5"> the device which</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> pretty</font>

852
00:39:44,780 --> 00:39:49,609
sweet<font color="#E5E5E5"> for</font><font color="#CCCCCC"> its device it doesn't want</font>

853
00:39:46,460 --> 00:39:53,240
guillotine<font color="#CCCCCC"> capital at all note that</font>

854
00:39:49,609 --> 00:39:58,549
thankfully<font color="#CCCCCC"> TV 2008</font><font color="#E5E5E5"> youth</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> coming</font>

855
00:39:53,240 --> 00:40:01,339
to<font color="#E5E5E5"> catch in April this to</font><font color="#CCCCCC"> impasse for</font>

856
00:39:58,549 --> 00:40:05,240
<font color="#E5E5E5">passionate</font><font color="#CCCCCC"> quo and as of September 30th</font>

857
00:40:01,339 --> 00:40:06,828
<font color="#CCCCCC">Jim gave on</font><font color="#E5E5E5"> that EP</font><font color="#CCCCCC"> banners a nearly 70%</font>

858
00:40:05,240 --> 00:40:08,930
of the internet<font color="#E5E5E5"> dating mikrotik router</font>

859
00:40:06,829 --> 00:40:12,170
<font color="#CCCCCC">remained vulnerable</font><font color="#E5E5E5"> so that would</font>

860
00:40:08,930 --> 00:40:16,069
promote<font color="#CCCCCC"> religion</font><font color="#E5E5E5"> techniques and that's a</font>

861
00:40:12,170 --> 00:40:17,540
couple<font color="#CCCCCC"> hundred</font><font color="#E5E5E5"> thousand routers now</font><font color="#CCCCCC"> here</font>

862
00:40:16,069 --> 00:40:19,730
the little<font color="#CCCCCC"> screenshot me attempting to</font>

863
00:40:17,540 --> 00:40:21,470
log in at the<font color="#CCCCCC"> velcome this page router</font>

864
00:40:19,730 --> 00:40:21,950
boards of<font color="#CCCCCC"> I thought had in my home</font>

865
00:40:21,470 --> 00:40:25,160
forever

866
00:40:21,950 --> 00:40:28,640
<font color="#CCCCCC">I</font><font color="#E5E5E5"> found the login I didn't run</font><font color="#CCCCCC"> the</font>

867
00:40:25,160 --> 00:40:32,779
exploit and try to log in again and<font color="#CCCCCC"> I</font>

868
00:40:28,640 --> 00:40:35,049
<font color="#CCCCCC">get my shell I thought I have to you</font>

869
00:40:32,780 --> 00:40:35,049
today

870
00:40:38,780 --> 00:41:08,070
<font color="#E5E5E5">okay then when actually have any</font>

871
00:40:45,150 --> 00:41:09,770
questions how's<font color="#CCCCCC"> it working</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> mikrotik</font>

872
00:41:08,070 --> 00:41:13,830
[Music]

873
00:41:09,770 --> 00:41:16,590
<font color="#CCCCCC">so I</font><font color="#E5E5E5"> my folks</font><font color="#CCCCCC"> mikrotik was during the</font>

874
00:41:13,830 --> 00:41:19,130
August<font color="#CCCCCC"> patches</font><font color="#E5E5E5"> and they're fine they're</font>

875
00:41:16,590 --> 00:41:22,020
<font color="#E5E5E5">not super communicative but notes</font>

876
00:41:19,130 --> 00:41:34,050
company<font color="#CCCCCC"> think there was a small language</font>

877
00:41:22,020 --> 00:41:36,150
<font color="#E5E5E5">barrier but generally okay how pissed</font>

878
00:41:34,050 --> 00:41:38,160
one day<font color="#E5E5E5"> let me figure it out when you</font>

879
00:41:36,150 --> 00:41:41,580
may<font color="#E5E5E5"> figure out that you knew but you can</font>

880
00:41:38,160 --> 00:41:43,020
order<font color="#E5E5E5"> backdoor I'm not actually the</font>

881
00:41:41,580 --> 00:41:46,230
<font color="#CCCCCC">first that figured that out I've</font>

882
00:41:43,020 --> 00:41:49,109
extended that<font color="#CCCCCC"> doesn't seem</font><font color="#E5E5E5"> to be that</font>

883
00:41:46,230 --> 00:41:59,130
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> hiding it at all it's fairly</font>

884
00:41:49,109 --> 00:42:00,740
obvious<font color="#CCCCCC"> might</font><font color="#E5E5E5"> feel important thanks</font>

885
00:41:59,130 --> 00:42:09,000
everyone

886
00:42:00,740 --> 00:42:09,000
[Applause]

