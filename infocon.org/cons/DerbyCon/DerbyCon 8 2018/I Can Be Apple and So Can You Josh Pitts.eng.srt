1
00:00:00,000 --> 00:00:17,130
<font color="#E5E5E5">starting</font>

2
00:00:02,250 --> 00:00:19,499
I guess<font color="#CCCCCC"> they're just all right so the</font>

3
00:00:17,130 --> 00:00:21,390
title of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> talk I can be</font><font color="#E5E5E5"> Apple and so</font>

4
00:00:19,499 --> 00:00:24,119
can<font color="#CCCCCC"> you if you're using hacker cracker</font>

5
00:00:21,390 --> 00:00:27,480
it so I can<font color="#CCCCCC"> be company X because</font>

6
00:00:24,119 --> 00:00:34,800
<font color="#CCCCCC">anything that to censor</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> popping out</font>

7
00:00:27,480 --> 00:00:37,500
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> title I just so anyway yeah</font>

8
00:00:34,800 --> 00:00:40,489
welcome to<font color="#E5E5E5"> derbycon welcome to noon high</font>

9
00:00:37,500 --> 00:00:43,110
noon track<font color="#E5E5E5"> to thank you for coming</font><font color="#CCCCCC"> a</font>

10
00:00:40,490 --> 00:00:47,250
little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> about my</font><font color="#CCCCCC"> background</font><font color="#E5E5E5"> that was</font>

11
00:00:43,110 --> 00:00:50,640
<font color="#E5E5E5">a breeze back last century</font><font color="#CCCCCC"> I got out in</font>

12
00:00:47,250 --> 00:00:52,320
this<font color="#E5E5E5"> 72 cost how</font><font color="#CCCCCC"> station in Hawaii and</font>

13
00:00:50,640 --> 00:00:53,940
I've worked in<font color="#E5E5E5"> sickened and the reason</font>

14
00:00:52,320 --> 00:00:57,060
I'm in InfoSec today because I got

15
00:00:53,940 --> 00:00:59,370
worked in training<font color="#E5E5E5"> put</font><font color="#CCCCCC"> behind a desk</font><font color="#E5E5E5"> per</font>

16
00:00:57,060 --> 00:01:04,890
year they told me to become a<font color="#E5E5E5"> security</font>

17
00:00:59,370 --> 00:01:10,408
officer basically<font color="#CCCCCC"> there's no such</font><font color="#E5E5E5"> thing</font>

18
00:01:04,890 --> 00:01:14,610
as<font color="#CCCCCC"> 6 purity</font><font color="#E5E5E5"> so I was like</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> well then</font>

19
00:01:10,409 --> 00:01:16,020
you'll see that<font color="#CCCCCC"> as</font><font color="#E5E5E5"> Michael so after the</font>

20
00:01:14,610 --> 00:01:19,800
breeds<font color="#CCCCCC"> at which</font><font color="#E5E5E5"> of University of Florida</font>

21
00:01:16,020 --> 00:01:22,229
<font color="#CCCCCC">I worked for PwC and the Booz Allen</font>

22
00:01:19,800 --> 00:01:25,530
<font color="#CCCCCC">libido security group</font><font color="#E5E5E5"> and now I'm with</font>

23
00:01:22,229 --> 00:01:27,658
<font color="#CCCCCC">octo who hears furtive octa raise</font><font color="#E5E5E5"> your</font>

24
00:01:25,530 --> 00:01:36,500
hands helping years ago there would be

25
00:01:27,659 --> 00:01:40,590
no<font color="#E5E5E5"> hands betrayed it now longer</font><font color="#CCCCCC"> startup</font>

26
00:01:36,500 --> 00:01:44,880
and<font color="#E5E5E5"> I'm on the internal offensive team</font>

27
00:01:40,590 --> 00:01:48,119
thanks<font color="#CCCCCC"> for offending</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> now we throw</font>

28
00:01:44,880 --> 00:01:49,830
<font color="#CCCCCC">our bug reports</font><font color="#E5E5E5"> so I work on the vendor</font>

29
00:01:48,119 --> 00:01:53,610
side of the house<font color="#CCCCCC"> so anything that</font><font color="#E5E5E5"> comes</font>

30
00:01:49,830 --> 00:01:56,908
in that needs to be<font color="#E5E5E5"> looked at hiding</font>

31
00:01:53,610 --> 00:01:59,280
bugs do that also<font color="#E5E5E5"> structure</font><font color="#CCCCCC"> I look at</font>

32
00:01:56,909 --> 00:02:02,630
everything from routers to huevos<font color="#E5E5E5"> so I'm</font>

33
00:01:59,280 --> 00:02:02,630
a full stack<font color="#E5E5E5"> pen tester</font>

34
00:02:05,420 --> 00:02:11,850
yeah so I also write code for fun that's

35
00:02:08,520 --> 00:02:13,410
my github<font color="#CCCCCC"> I wrote back to her</font><font color="#E5E5E5"> factory</font>

36
00:02:11,850 --> 00:02:17,040
<font color="#E5E5E5">and I percent in the first one four</font>

37
00:02:13,410 --> 00:02:19,400
years<font color="#E5E5E5"> ago</font><font color="#CCCCCC"> or at</font><font color="#E5E5E5"> least the current</font>

38
00:02:17,040 --> 00:02:23,790
version and<font color="#CCCCCC"> forty years ago here at</font>

39
00:02:19,400 --> 00:02:26,040
<font color="#CCCCCC">Derby con and I introduced the proxy to</font>

40
00:02:23,790 --> 00:02:27,780
exact repeat<font color="#E5E5E5"> two weeks after that</font>

41
00:02:26,040 --> 00:02:30,569
<font color="#E5E5E5">presentation I found this</font><font color="#CCCCCC"> thing called</font>

42
00:02:27,780 --> 00:02:35,160
<font color="#CCCCCC">ending two which was</font><font color="#E5E5E5"> four years ago now</font>

43
00:02:30,569 --> 00:02:38,100
<font color="#E5E5E5">that</font><font color="#CCCCCC"> was downloading infecting binaries</font>

44
00:02:35,160 --> 00:02:39,959
<font color="#CCCCCC">over</font><font color="#E5E5E5"> tour during download or HTTP so</font>

45
00:02:38,100 --> 00:02:42,120
that's enough about<font color="#E5E5E5"> me</font>

46
00:02:39,959 --> 00:02:43,709
this is the<font color="#E5E5E5"> outline I'm kind of doing</font>

47
00:02:42,120 --> 00:02:47,610
something different<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> in Reverse</font>

48
00:02:43,709 --> 00:02:48,959
and then show a demo<font color="#E5E5E5"> and then we're</font>

49
00:02:47,610 --> 00:02:50,970
going<font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> how I found this bug</font>

50
00:02:48,959 --> 00:02:54,780
but I also have an<font color="#CCCCCC"> update</font>

51
00:02:50,970 --> 00:02:57,060
I added<font color="#E5E5E5"> because some news came out two</font>

52
00:02:54,780 --> 00:02:58,769
days<font color="#CCCCCC"> ago that I don't agree</font><font color="#E5E5E5"> with in the</font>

53
00:02:57,060 --> 00:03:02,489
Mac security<font color="#E5E5E5"> space I'm going</font><font color="#CCCCCC"> to talk</font>

54
00:02:58,769 --> 00:03:04,290
<font color="#E5E5E5">about that so what is</font><font color="#CCCCCC"> cosine T cosine T</font>

55
00:03:02,489 --> 00:03:06,750
is a security construct that allows<font color="#E5E5E5"> for</font>

56
00:03:04,290 --> 00:03:09,030
the consumer and user to fair fight move

57
00:03:06,750 --> 00:03:12,060
<font color="#E5E5E5">aside encoded in question and</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> verify</font>

58
00:03:09,030 --> 00:03:14,130
the encoding question and<font color="#E5E5E5"> modify you</font>

59
00:03:12,060 --> 00:03:15,989
<font color="#E5E5E5">need fighter in cosign name either at</font>

60
00:03:14,130 --> 00:03:17,880
the lowest level<font color="#CCCCCC"> when third-party</font>

61
00:03:15,989 --> 00:03:19,530
developer tools can have disastrous side

62
00:03:17,880 --> 00:03:21,780
effects<font color="#E5E5E5"> especially</font><font color="#CCCCCC"> if you're in</font><font color="#E5E5E5"> the</font>

63
00:03:19,530 --> 00:03:25,130
defense side of the house<font color="#E5E5E5"> or doing isn't</font>

64
00:03:21,780 --> 00:03:28,350
<font color="#E5E5E5">a response okay both Windows and</font><font color="#CCCCCC"> Mac OS</font>

65
00:03:25,130 --> 00:03:30,269
<font color="#E5E5E5">support the concept co-signing cosign</font>

66
00:03:28,350 --> 00:03:32,358
for portable code<font color="#E5E5E5"> there</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> issues</font><font color="#CCCCCC"> in</font>

67
00:03:30,269 --> 00:03:35,790
Windows<font color="#CCCCCC"> co-signing</font><font color="#E5E5E5"> in the past however</font>

68
00:03:32,359 --> 00:03:39,900
<font color="#E5E5E5">we're focusing just on the Mac side</font><font color="#CCCCCC"> of</font>

69
00:03:35,790 --> 00:03:43,560
house today<font color="#CCCCCC"> so to talk about impact code</font>

70
00:03:39,900 --> 00:03:44,849
<font color="#E5E5E5">signing we're not talking about</font><font color="#CCCCCC"> one of</font>

71
00:03:43,560 --> 00:03:49,170
<font color="#CCCCCC">Ben's</font>

72
00:03:44,849 --> 00:03:52,980
<font color="#E5E5E5">fineries per se</font><font color="#CCCCCC"> while they are it's a</font>

73
00:03:49,170 --> 00:03:55,018
<font color="#E5E5E5">valid way to get code execution</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of</font>

74
00:03:52,980 --> 00:03:55,920
the focuses on<font color="#CCCCCC"> windows I</font><font color="#E5E5E5"> challenge</font><font color="#CCCCCC"> you</font>

75
00:03:55,019 --> 00:04:01,939
<font color="#E5E5E5">to find</font><font color="#CCCCCC"> Goldmans</font>

76
00:03:55,920 --> 00:04:04,529
<font color="#CCCCCC">in Chrome</font><font color="#E5E5E5"> OS or they might exist</font><font color="#CCCCCC"> but I</font>

77
00:04:01,939 --> 00:04:06,120
don't<font color="#CCCCCC"> think so but Mac OS does</font><font color="#E5E5E5"> have a</font>

78
00:04:04,530 --> 00:04:08,760
particularly particularly interesting

79
00:04:06,120 --> 00:04:10,650
well then which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> Python it's signed</font>

80
00:04:08,760 --> 00:04:12,510
<font color="#E5E5E5">it's protected by sip and you</font><font color="#CCCCCC"> say you</font>

81
00:04:10,650 --> 00:04:18,630
can't remem this you have<font color="#E5E5E5"> these petals</font>

82
00:04:12,510 --> 00:04:20,789
<font color="#E5E5E5">or a driver but anyway what we want to</font>

83
00:04:18,630 --> 00:04:22,199
do is persist between reboots and<font color="#E5E5E5"> full</font>

84
00:04:20,789 --> 00:04:24,120
user that what we're<font color="#CCCCCC"> running the same</font>

85
00:04:22,199 --> 00:04:26,720
ballot and that's where it goes I<font color="#E5E5E5"> mean</font>

86
00:04:24,120 --> 00:04:30,180
by peasants<font color="#CCCCCC"> come in as far</font><font color="#E5E5E5"> as impact</font>

87
00:04:26,720 --> 00:04:32,430
<font color="#CCCCCC">code-signing really impact</font><font color="#E5E5E5"> zero</font><font color="#CCCCCC"> trust</font>

88
00:04:30,180 --> 00:04:35,490
networks<font color="#E5E5E5"> if you Michael at zero trust</font>

89
00:04:32,430 --> 00:04:38,400
networks are your hand young<font color="#E5E5E5"> port so</font>

90
00:04:35,490 --> 00:04:40,530
zero trust networks is the<font color="#E5E5E5"> concept of</font>

91
00:04:38,400 --> 00:04:42,870
you no longer have physical boundaries

92
00:04:40,530 --> 00:04:45,448
on your honor<font color="#E5E5E5"> there are no longer a</font>

93
00:04:42,870 --> 00:04:47,610
physical<font color="#E5E5E5"> network like a moat for</font><font color="#CCCCCC"> example</font>

94
00:04:45,449 --> 00:04:49,620
and you<font color="#E5E5E5"> can have the device anywhere in</font>

95
00:04:47,610 --> 00:04:53,909
the world and we can make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that is</font>

96
00:04:49,620 --> 00:04:55,919
secured and<font color="#CCCCCC"> that we trust it just</font>

97
00:04:53,909 --> 00:04:57,690
because your device is trusted<font color="#E5E5E5"> and you</font>

98
00:04:55,919 --> 00:05:00,448
have a token<font color="#E5E5E5"> or something that says we</font>

99
00:04:57,690 --> 00:05:04,949
trust you<font color="#CCCCCC"> now part of that</font><font color="#E5E5E5"> is if you</font>

100
00:05:00,449 --> 00:05:08,550
bypass<font color="#CCCCCC"> then the whole entire security</font>

101
00:05:04,949 --> 00:05:09,960
model for<font color="#CCCCCC"> service networks broken so</font><font color="#E5E5E5"> you</font>

102
00:05:08,550 --> 00:05:12,599
gotta have a code<font color="#E5E5E5"> side enforcement you</font>

103
00:05:09,960 --> 00:05:15,780
also have to have<font color="#E5E5E5"> modern which is a very</font>

104
00:05:12,599 --> 00:05:18,870
important part<font color="#CCCCCC"> so we're gonna</font><font color="#E5E5E5"> do a demo</font>

105
00:05:15,780 --> 00:05:20,849
<font color="#E5E5E5">this is going to show Google Santa which</font>

106
00:05:18,870 --> 00:05:24,570
is a white listing tool<font color="#E5E5E5"> in full lockdown</font>

107
00:05:20,849 --> 00:05:26,009
mode and<font color="#CCCCCC"> only Apple</font><font color="#E5E5E5"> or native code can</font>

108
00:05:24,570 --> 00:05:28,430
run<font color="#E5E5E5"> an</font><font color="#CCCCCC"> apple</font><font color="#E5E5E5"> sonic over where native</font>

109
00:05:26,009 --> 00:05:31,080
code from the from the<font color="#E5E5E5"> App Store</font><font color="#CCCCCC"> and</font>

110
00:05:28,430 --> 00:05:34,250
this is going<font color="#E5E5E5"> to show the concept after</font>

111
00:05:31,080 --> 00:05:36,780
<font color="#CCCCCC">a phishing attack or social engineering</font>

112
00:05:34,250 --> 00:05:39,150
<font color="#CCCCCC">or some kind of post exploitation where</font>

113
00:05:36,780 --> 00:05:41,159
the user or not<font color="#CCCCCC"> the attacker can drop</font>

114
00:05:39,150 --> 00:05:43,599
<font color="#E5E5E5">something to distance between removes</font>

115
00:05:41,159 --> 00:06:05,110
and this is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> show that</font>

116
00:05:43,600 --> 00:06:06,580
<font color="#CCCCCC">you hide in plain sight so for those of</font>

117
00:06:05,110 --> 00:06:10,750
<font color="#E5E5E5">you</font><font color="#CCCCCC"> in the back</font><font color="#E5E5E5"> I hope</font><font color="#CCCCCC"> you can't see</font>

118
00:06:06,580 --> 00:06:13,469
this<font color="#CCCCCC"> today my room</font>

119
00:06:10,750 --> 00:06:18,550
<font color="#CCCCCC">alright on the on the</font><font color="#E5E5E5"> Left we have the</font>

120
00:06:13,470 --> 00:06:22,330
<font color="#E5E5E5">user victim we have a root</font><font color="#CCCCCC"> shell and a</font>

121
00:06:18,550 --> 00:06:26,800
regular shells on top and then<font color="#E5E5E5"> on the</font>

122
00:06:22,330 --> 00:06:31,120
right we<font color="#CCCCCC"> have the attacker</font><font color="#E5E5E5"> come on</font><font color="#CCCCCC"> so</font>

123
00:06:26,800 --> 00:06:32,620
we're going to do here is show you<font color="#CCCCCC"> their</font>

124
00:06:31,120 --> 00:06:36,330
really calculator app this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> not the</font>

125
00:06:32,620 --> 00:06:36,330
<font color="#E5E5E5">exploit it's just a show</font>

126
00:06:44,949 --> 00:06:55,550
it just works<font color="#E5E5E5"> too soon so so yeah this</font>

127
00:06:53,389 --> 00:06:58,159
is<font color="#CCCCCC"> just a show that native app pioneers</font>

128
00:06:55,550 --> 00:07:01,159
are running and I'm going<font color="#E5E5E5"> to show next I</font>

129
00:06:58,159 --> 00:07:02,479
should be showing this is Santa<font color="#CCCCCC"> for</font>

130
00:07:01,159 --> 00:07:04,039
<font color="#E5E5E5">control I'm just going</font><font color="#CCCCCC"> to show what the</font>

131
00:07:02,479 --> 00:07:07,159
<font color="#CCCCCC">statuses and</font><font color="#E5E5E5"> this and lock down</font><font color="#CCCCCC"> those</font>

132
00:07:04,039 --> 00:07:09,378
only<font color="#E5E5E5"> Apple</font><font color="#CCCCCC"> sign go</font><font color="#E5E5E5"> we can't run</font><font color="#CCCCCC"> so I'm</font>

133
00:07:07,159 --> 00:07:14,780
<font color="#E5E5E5">going to try to execute in pattern</font><font color="#CCCCCC"> Epcot</font>

134
00:07:09,379 --> 00:07:18,889
<font color="#E5E5E5">and of course</font><font color="#CCCCCC"> as long as it should be</font>

135
00:07:14,780 --> 00:07:22,938
because it's not signed at all now I'm

136
00:07:18,889 --> 00:07:25,789
going to show where<font color="#CCCCCC"> LS this is a</font>

137
00:07:22,939 --> 00:07:26,770
maliciously<font color="#E5E5E5"> patched LS the</font><font color="#CCCCCC"> backdoor in</font>

138
00:07:25,789 --> 00:07:29,360
<font color="#E5E5E5">it</font>

139
00:07:26,770 --> 00:07:31,849
and it's in user<font color="#E5E5E5"> local</font><font color="#CCCCCC"> bed this is kind</font>

140
00:07:29,360 --> 00:07:33,520
of neat because<font color="#E5E5E5"> this is showing what the</font>

141
00:07:31,849 --> 00:07:37,400
default<font color="#CCCCCC"> do here but this is homework</font>

142
00:07:33,520 --> 00:07:39,378
<font color="#CCCCCC">demo room</font><font color="#E5E5E5"> so if you do the default</font>

143
00:07:37,400 --> 00:07:41,719
install<font color="#CCCCCC"> if you haven't really</font><font color="#E5E5E5"> been</font>

144
00:07:39,379 --> 00:07:43,490
privileged escalation bug just<font color="#E5E5E5"> someone</font>

145
00:07:41,719 --> 00:07:46,580
gets<font color="#E5E5E5"> underwear station if you do</font>

146
00:07:43,490 --> 00:07:49,039
<font color="#E5E5E5">anything</font><font color="#CCCCCC"> I'm gonna</font><font color="#E5E5E5"> show you that and so</font>

147
00:07:46,580 --> 00:07:52,909
<font color="#E5E5E5">I just dropped in Melissa malicious LS</font>

148
00:07:49,039 --> 00:07:56,330
and use a little<font color="#E5E5E5"> bit okay and so if I</font>

149
00:07:52,909 --> 00:08:00,080
use LS<font color="#E5E5E5"> I get code execution and contacts</font>

150
00:07:56,330 --> 00:08:03,758
<font color="#E5E5E5">the attack on the right okay so now I'm</font>

151
00:08:00,080 --> 00:08:03,758
going<font color="#E5E5E5"> to show the path of the</font><font color="#CCCCCC"> routes and</font>

152
00:08:04,000 --> 00:08:06,800
<font color="#CCCCCC">you see that usually local business</font>

153
00:08:06,169 --> 00:08:09,710
first

154
00:08:06,800 --> 00:08:11,650
that's<font color="#CCCCCC"> default</font><font color="#E5E5E5"> okay so if you have any</font>

155
00:08:09,710 --> 00:08:14,989
<font color="#E5E5E5">route scripts that run through soon</font>

156
00:08:11,650 --> 00:08:16,758
whatever those<font color="#E5E5E5"> and you don't set the</font>

157
00:08:14,990 --> 00:08:18,469
path specifically<font color="#CCCCCC"> the</font><font color="#E5E5E5"> environment</font>

158
00:08:16,759 --> 00:08:20,539
variables or in the<font color="#E5E5E5"> beginning the script</font>

159
00:08:18,469 --> 00:08:23,449
then whatever<font color="#E5E5E5"> isn't usually use of local</font>

160
00:08:20,539 --> 00:08:27,969
<font color="#CCCCCC">bed is</font><font color="#E5E5E5"> going to execute just keep that</font>

161
00:08:23,449 --> 00:08:27,969
line so now we're going<font color="#E5E5E5"> to execute LS</font>

162
00:08:33,210 --> 00:08:41,700
and now I have it<font color="#CCCCCC"> Rochelle okay</font>

163
00:08:37,510 --> 00:08:46,600
I don't not pop it<font color="#CCCCCC"> into</font><font color="#E5E5E5"> California sorry</font>

164
00:08:41,700 --> 00:08:55,750
so next<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going to turn off</font><font color="#CCCCCC"> Santa</font><font color="#E5E5E5"> or</font>

165
00:08:46,600 --> 00:08:57,790
put<font color="#E5E5E5"> it in monitor mode and I'm going to</font>

166
00:08:55,750 --> 00:09:00,880
bring<font color="#E5E5E5"> up I'm gonna use Patrick whirls</font>

167
00:08:57,790 --> 00:09:02,800
<font color="#E5E5E5">what's your sign - Linda show that the</font>

168
00:09:00,880 --> 00:09:05,590
check to see if this<font color="#CCCCCC"> is signed by Apple</font>

169
00:09:02,800 --> 00:09:11,770
see who's I'm by<font color="#E5E5E5"> and it says signed by</font>

170
00:09:05,590 --> 00:09:14,830
<font color="#CCCCCC">Amber and then I'm going to</font><font color="#E5E5E5"> use cosine</font>

171
00:09:11,770 --> 00:09:16,900
tool which comes with<font color="#E5E5E5"> the operating</font>

172
00:09:14,830 --> 00:09:21,250
<font color="#E5E5E5">system which shows code signing</font>

173
00:09:16,900 --> 00:09:23,829
contributes let me show<font color="#E5E5E5"> you calm down a</font>

174
00:09:21,250 --> 00:09:25,870
little s<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> dinner fire that</font>

175
00:09:23,830 --> 00:09:28,180
this is signed by Apple<font color="#E5E5E5"> and then I'm</font>

176
00:09:25,870 --> 00:09:40,810
<font color="#E5E5E5">going to check to</font><font color="#CCCCCC"> see if it's it's</font><font color="#E5E5E5"> valid</font>

177
00:09:28,180 --> 00:09:45,069
and<font color="#CCCCCC"> it says it's Beth</font><font color="#E5E5E5"> that's demo so how</font>

178
00:09:40,810 --> 00:09:48,160
does this work<font color="#E5E5E5"> well this is released</font>

179
00:09:45,070 --> 00:09:53,770
<font color="#E5E5E5">June 12th</font><font color="#CCCCCC"> alright and</font><font color="#E5E5E5"> it's made a pretty</font>

180
00:09:48,160 --> 00:09:55,630
big splash<font color="#CCCCCC"> but the details are so this</font>

181
00:09:53,770 --> 00:09:58,449
takes advantage<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> fats commercial</font>

182
00:09:55,630 --> 00:10:01,510
binary formats<font color="#E5E5E5"> what needs to happen is</font>

183
00:09:58,450 --> 00:10:03,340
the first file in the universal file or

184
00:10:01,510 --> 00:10:06,400
fat file I'm gonna explain<font color="#CCCCCC"> that a second</font>

185
00:10:03,340 --> 00:10:11,020
<font color="#CCCCCC">must</font><font color="#E5E5E5"> be signed by Apple it must be</font>

186
00:10:06,400 --> 00:10:13,000
either<font color="#CCCCCC"> PI</font><font color="#E5E5E5"> 386 64-bit or even PowerPC the</font>

187
00:10:11,020 --> 00:10:18,360
<font color="#CCCCCC">malicious binary or not</font><font color="#E5E5E5"> at this point</font>

188
00:10:13,000 --> 00:10:22,590
<font color="#CCCCCC">everything is in</font><font color="#E5E5E5"> the oxide and also how</font>

189
00:10:18,360 --> 00:10:26,800
<font color="#CCCCCC">386 code with</font><font color="#E5E5E5"> your target need to</font><font color="#CCCCCC"> say a</font>

190
00:10:22,590 --> 00:10:29,770
little<font color="#CCCCCC"> bit operating system you'll see</font>

191
00:10:26,800 --> 00:10:31,620
why in a second<font color="#CCCCCC"> and the CPU type</font><font color="#E5E5E5"> and the</font>

192
00:10:29,770 --> 00:10:34,390
fat header at the top of<font color="#E5E5E5"> binary</font>

193
00:10:31,620 --> 00:10:37,480
<font color="#CCCCCC">must be set to an invalid type for the</font>

194
00:10:34,390 --> 00:10:41,110
first for the first file or<font color="#CCCCCC"> YZ the anon</font>

195
00:10:37,480 --> 00:10:42,920
native chipset and I'll explain this so

196
00:10:41,110 --> 00:10:44,839
it exists in

197
00:10:42,920 --> 00:10:47,060
difference between<font color="#CCCCCC"> how</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> maca</font><font color="#E5E5E5"> litter</font>

198
00:10:44,839 --> 00:10:49,610
<font color="#CCCCCC">though psycho</font><font color="#E5E5E5"> versus how improperly he</font>

199
00:10:47,060 --> 00:10:52,010
was consigned<font color="#E5E5E5"> a the eyes check psycho is</font>

200
00:10:49,610 --> 00:11:06,620
wooden via the mouth horn universally

201
00:10:52,010 --> 00:11:10,490
that binary okay so this is<font color="#CCCCCC"> you</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> pop</font>

202
00:11:06,620 --> 00:11:14,269
on that all right<font color="#CCCCCC"> you have two</font>

203
00:11:10,490 --> 00:11:16,190
architectures<font color="#E5E5E5"> in each slice is the same</font>

204
00:11:14,269 --> 00:11:20,000
program compiled for<font color="#E5E5E5"> different target</font>

205
00:11:16,190 --> 00:11:21,560
cpu so<font color="#CCCCCC"> five 386 is for item 86 and</font>

206
00:11:20,000 --> 00:11:26,630
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> 64</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> system</font>

207
00:11:21,560 --> 00:11:28,969
threesome<font color="#CCCCCC"> and there's no signing on</font><font color="#E5E5E5"> the</font>

208
00:11:26,630 --> 00:11:32,839
fat file itself so you can modify this

209
00:11:28,970 --> 00:11:34,250
all<font color="#CCCCCC"> just</font><font color="#E5E5E5"> not the Mafia binaries and the</font>

210
00:11:32,839 --> 00:11:35,839
owner ability exists<font color="#E5E5E5"> the difference</font>

211
00:11:34,250 --> 00:11:37,850
<font color="#CCCCCC">between how the Mako's order</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> load</font>

212
00:11:35,839 --> 00:11:41,209
sign code versus how incredibly is

213
00:11:37,850 --> 00:11:45,889
consigned<font color="#CCCCCC"> API so check the sign code so</font>

214
00:11:41,209 --> 00:11:48,640
<font color="#CCCCCC">let's create a</font><font color="#E5E5E5"> Frankenstein binary and</font>

215
00:11:45,889 --> 00:11:52,160
how i did this<font color="#E5E5E5"> i if i compiled</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> cap</font>

216
00:11:48,640 --> 00:11:54,230
1986 and i'm ad hoc signed it<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> use</font>

217
00:11:52,160 --> 00:11:58,339
the lipo command which<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> real command</font>

218
00:11:54,230 --> 00:12:02,029
to create<font color="#CCCCCC"> fat bottles like</font><font color="#E5E5E5"> TV</font><font color="#CCCCCC"> not tools</font>

219
00:11:58,339 --> 00:12:06,019
<font color="#CCCCCC">use light flow to add to create fat</font><font color="#E5E5E5"> or</font>

220
00:12:02,029 --> 00:12:13,939
you<font color="#CCCCCC"> can use like though too thin it's</font>

221
00:12:06,019 --> 00:12:17,600
<font color="#CCCCCC">not something</font><font color="#E5E5E5"> so anyway so we have a</font>

222
00:12:13,940 --> 00:12:21,110
universal<font color="#E5E5E5"> fly over that</font><font color="#CCCCCC"> bug you'll see</font>

223
00:12:17,600 --> 00:12:25,790
that<font color="#CCCCCC"> Python is first and Hancock signed</font>

224
00:12:21,110 --> 00:12:30,110
<font color="#CCCCCC">yourself sign that cat is next next</font><font color="#E5E5E5"> and</font>

225
00:12:25,790 --> 00:12:32,930
<font color="#E5E5E5">I'm over yeah so anyway so I'm showing</font>

226
00:12:30,110 --> 00:12:36,649
<font color="#E5E5E5">the cosine here</font><font color="#CCCCCC"> he's</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> code signing</font>

227
00:12:32,930 --> 00:12:39,050
<font color="#E5E5E5">here so you'll see that net cotton isn't</font>

228
00:12:36,649 --> 00:12:40,730
<font color="#CCCCCC">he ad hoc sign and the team identify</font>

229
00:12:39,050 --> 00:12:42,180
there's not set<font color="#CCCCCC"> so this is important</font>

230
00:12:40,730 --> 00:12:44,040
because you could use<font color="#CCCCCC"> this</font>

231
00:12:42,180 --> 00:12:47,758
I'm just<font color="#E5E5E5"> showing</font><font color="#CCCCCC"> outside miners but</font><font color="#E5E5E5"> you</font>

232
00:12:44,040 --> 00:12:50,309
could<font color="#E5E5E5"> have used this on applications not</font>

233
00:12:47,759 --> 00:12:53,120
by Apple<font color="#E5E5E5"> if you can set a team and I</font>

234
00:12:50,309 --> 00:12:55,829
<font color="#E5E5E5">team identified and that is a challenge</font>

235
00:12:53,120 --> 00:13:00,120
<font color="#CCCCCC">there's holes</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> it right now I would</font>

236
00:12:55,829 --> 00:13:02,040
<font color="#E5E5E5">have to write one</font><font color="#CCCCCC"> so yeah so we're just</font>

237
00:13:00,120 --> 00:13:04,470
<font color="#E5E5E5">going to jackpot the liners</font><font color="#CCCCCC"> so if I take</font>

238
00:13:02,040 --> 00:13:06,889
<font color="#E5E5E5">a copy the necktie Frankenstein - Tim</font>

239
00:13:04,470 --> 00:13:10,199
Python and execute Python<font color="#CCCCCC"> I get my</font><font color="#E5E5E5"> phone</font>

240
00:13:06,889 --> 00:13:11,579
<font color="#CCCCCC">but I want in</font><font color="#E5E5E5"> cap or net capped execute</font>

241
00:13:10,199 --> 00:13:14,729
so how do I do this did not mess up

242
00:13:11,579 --> 00:13:16,709
<font color="#CCCCCC">because I'm here</font><font color="#E5E5E5"> well what I do</font><font color="#CCCCCC"> is I</font>

243
00:13:14,730 --> 00:13:19,439
<font color="#E5E5E5">need to set the</font><font color="#CCCCCC"> CPU type there in the</font>

244
00:13:16,709 --> 00:13:23,719
<font color="#E5E5E5">box to an invalid type or non-native</font>

245
00:13:19,439 --> 00:13:27,269
type I said<font color="#CCCCCC"> to CPU to</font><font color="#E5E5E5"> the data type or</font>

246
00:13:23,720 --> 00:13:29,579
the<font color="#CCCCCC"> my</font><font color="#E5E5E5"> computer will just</font><font color="#CCCCCC"> skip over the</font>

247
00:13:27,269 --> 00:13:33,089
assignment<font color="#CCCCCC"> popular binary and execute</font>

248
00:13:29,579 --> 00:13:36,180
the malicious code<font color="#CCCCCC"> that's how simple</font><font color="#E5E5E5"> it</font>

249
00:13:33,089 --> 00:13:38,910
<font color="#E5E5E5">is</font><font color="#CCCCCC"> so you take here you see that</font><font color="#E5E5E5"> Python</font>

250
00:13:36,180 --> 00:13:43,319
<font color="#CCCCCC">is now executing impact</font><font color="#E5E5E5"> I give the</font>

251
00:13:38,910 --> 00:13:46,139
listen verbosity on port 8080<font color="#E5E5E5"> and</font><font color="#CCCCCC"> he is</font>

252
00:13:43,319 --> 00:13:54,779
you'll see that shows that it is con

253
00:13:46,139 --> 00:13:58,079
<font color="#CCCCCC">Dada Dada Python and that it</font><font color="#E5E5E5"> is so let's</font>

254
00:13:54,779 --> 00:14:01,499
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> it was affected and everyone</font>

255
00:13:58,079 --> 00:14:02,969
that<font color="#CCCCCC"> I was able to test that every third</font>

256
00:14:01,499 --> 00:14:05,519
party developer that was able<font color="#E5E5E5"> to test</font>

257
00:14:02,970 --> 00:14:07,259
they use that use cosine<font color="#E5E5E5"> he gave me</font><font color="#CCCCCC"> ice</font>

258
00:14:05,519 --> 00:14:10,230
and their<font color="#E5E5E5"> chipset or in their future</font>

259
00:14:07,259 --> 00:14:12,689
<font color="#CCCCCC">sell everything I was able to</font><font color="#E5E5E5"> touch some</font>

260
00:14:10,230 --> 00:14:14,910
some<font color="#E5E5E5"> people I couldn't get a sample code</font>

261
00:14:12,689 --> 00:14:19,379
before<font color="#E5E5E5"> this came out so</font><font color="#CCCCCC"> I'm sure that</font>

262
00:14:14,910 --> 00:14:21,029
there were solid phases<font color="#CCCCCC"> so I reached</font>

263
00:14:19,379 --> 00:14:23,550
<font color="#CCCCCC">record where I provided for samples for</font>

264
00:14:21,029 --> 00:14:25,860
the vendors<font color="#E5E5E5"> to verify their bug and also</font>

265
00:14:23,550 --> 00:14:28,620
to fix it and each<font color="#E5E5E5"> of these should</font>

266
00:14:25,860 --> 00:14:32,040
return non-valid basically the first<font color="#E5E5E5"> one</font>

267
00:14:28,620 --> 00:14:33,779
is as it says<font color="#E5E5E5"> it's a bash binary it's</font>

268
00:14:32,040 --> 00:14:36,779
not signed<font color="#E5E5E5"> and has a malformed header</font>

269
00:14:33,779 --> 00:14:38,459
<font color="#CCCCCC">the next is a PPC binary it's the</font>

270
00:14:36,779 --> 00:14:40,350
malicious<font color="#CCCCCC"> code bad luck sign and there's</font>

271
00:14:38,459 --> 00:14:44,008
no mount form header<font color="#E5E5E5"> I found I found the</font>

272
00:14:40,350 --> 00:14:44,870
<font color="#E5E5E5">PPC</font><font color="#CCCCCC"> binary in a install disk</font><font color="#E5E5E5"> for OS X</font>

273
00:14:44,009 --> 00:14:47,000
leopard

274
00:14:44,870 --> 00:14:48,680
I had to hang around<font color="#E5E5E5"> I just pulled it</font>

275
00:14:47,000 --> 00:14:52,300
<font color="#CCCCCC">off there and then made the submission</font>

276
00:14:48,680 --> 00:14:55,010
potentially malicious binary and then uh

277
00:14:52,300 --> 00:14:56,689
so back<font color="#E5E5E5"> catalogue is just a box on</font>

278
00:14:55,010 --> 00:14:58,250
binary<font color="#E5E5E5"> with a malformed header that</font>

279
00:14:56,690 --> 00:15:00,620
means invalid<font color="#CCCCCC"> CPU type and then I</font>

280
00:14:58,250 --> 00:15:03,710
<font color="#E5E5E5">created</font><font color="#CCCCCC"> a terminal app it's full</font>

281
00:15:00,620 --> 00:15:07,070
application bundle<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> ad-hoc sign and</font>

282
00:15:03,710 --> 00:15:08,510
if there is a<font color="#CCCCCC"> not</font><font color="#E5E5E5"> more pattern terminals</font>

283
00:15:07,070 --> 00:15:11,360
kind of iffy when you go across

284
00:15:08,510 --> 00:15:14,210
different OSX architecture earlier

285
00:15:11,360 --> 00:15:18,980
<font color="#E5E5E5">versions so little</font>

286
00:15:14,210 --> 00:15:22,370
is there a little<font color="#CCCCCC"> flocker upgraded</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> X</font>

287
00:15:18,980 --> 00:15:27,529
<font color="#CCCCCC">fence which also had you're still</font>

288
00:15:22,370 --> 00:15:30,589
vulnerable<font color="#E5E5E5"> to this so objective-c every</font>

289
00:15:27,529 --> 00:15:32,779
memory so the see Patrick<font color="#CCCCCC"> portals tools</font>

290
00:15:30,589 --> 00:15:35,200
all his tools that did cosign each

291
00:15:32,779 --> 00:15:43,040
expert<font color="#E5E5E5"> affected</font><font color="#CCCCCC"> I only signed one CD</font>

292
00:15:35,200 --> 00:15:45,980
<font color="#E5E5E5">because so the first tool was what's</font>

293
00:15:43,040 --> 00:15:48,680
your sign sorry<font color="#E5E5E5"> so what's your sign</font><font color="#CCCCCC"> and</font>

294
00:15:45,980 --> 00:15:53,350
then next tool was uh I think<font color="#CCCCCC"> tests for</font>

295
00:15:48,680 --> 00:15:56,689
the green<font color="#E5E5E5"> lock means that</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> was on map</font>

296
00:15:53,350 --> 00:16:02,740
so a<font color="#E5E5E5"> pupil Santa say that says the quite</font>

297
00:15:56,690 --> 00:16:05,089
the<font color="#CCCCCC"> student and it's also OSX</font><font color="#E5E5E5"> collector</font>

298
00:16:02,740 --> 00:16:07,440
<font color="#E5E5E5">decided information so most ice</font>

299
00:16:05,089 --> 00:16:08,650
collector only<font color="#E5E5E5"> only</font><font color="#CCCCCC"> return errors on</font>

300
00:16:07,440 --> 00:16:11,480
[Music]

301
00:16:08,650 --> 00:16:13,870
invalid signatures so I had to patch it

302
00:16:11,480 --> 00:16:18,220
up<font color="#E5E5E5"> just to show</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> zeros municipality</font>

303
00:16:13,870 --> 00:16:21,050
carbon black<font color="#CCCCCC"> advice from</font><font color="#E5E5E5"> carbon black</font>

304
00:16:18,220 --> 00:16:23,510
but they came<font color="#CCCCCC"> back as you can sign</font><font color="#E5E5E5"> by</font>

305
00:16:21,050 --> 00:16:28,130
Apple<font color="#CCCCCC"> Firestone invite your virus whole</font>

306
00:16:23,510 --> 00:16:32,720
I hear<font color="#CCCCCC"> they're they're decent but yeah</font>

307
00:16:28,130 --> 00:16:35,020
this yeah and then it was<font color="#CCCCCC"> very vague</font>

308
00:16:32,720 --> 00:16:40,580
<font color="#CCCCCC">about this thing</font>

309
00:16:35,020 --> 00:16:42,770
yes yeah<font color="#CCCCCC"> Little Snitch</font><font color="#E5E5E5"> so a little</font>

310
00:16:40,580 --> 00:16:44,360
<font color="#CCCCCC">snippet</font><font color="#E5E5E5"> best response they could come</font>

311
00:16:42,770 --> 00:16:45,500
back<font color="#E5E5E5"> and say hey this is different than</font>

312
00:16:44,360 --> 00:16:47,329
what's<font color="#E5E5E5"> on</font>

313
00:16:45,500 --> 00:16:49,370
this might be<font color="#E5E5E5"> maliciously modified no</font>

314
00:16:47,329 --> 00:16:53,540
<font color="#E5E5E5">like a memory or</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> but if you go</font>

315
00:16:49,370 --> 00:16:54,920
<font color="#E5E5E5">and check you know</font><font color="#CCCCCC"> genique more</font><font color="#E5E5E5"> detail</font>

316
00:16:53,540 --> 00:16:57,019
<font color="#E5E5E5">showed that bottom right</font>

317
00:16:54,920 --> 00:16:59,719
signed by<font color="#E5E5E5"> Apple and then you</font><font color="#CCCCCC"> follow your</font>

318
00:16:57,019 --> 00:17:06,250
other tools are saying hey it's<font color="#E5E5E5"> fine bro</font>

319
00:16:59,720 --> 00:17:11,110
and then you<font color="#CCCCCC"> probably just</font><font color="#E5E5E5"> let it go so</font>

320
00:17:06,250 --> 00:17:14,630
well<font color="#E5E5E5"> so this gatekeeper wasn't affected</font>

321
00:17:11,109 --> 00:17:17,839
<font color="#CCCCCC">if you</font><font color="#E5E5E5"> used</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> application on dole but</font>

322
00:17:14,630 --> 00:17:19,490
also so let me<font color="#E5E5E5"> just talk</font><font color="#CCCCCC"> about</font>

323
00:17:17,839 --> 00:17:20,958
<font color="#CCCCCC">gatekeeper and this is where I'm going</font>

324
00:17:19,490 --> 00:17:22,539
<font color="#E5E5E5">to talk</font><font color="#CCCCCC"> about some</font><font color="#E5E5E5"> research</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> at least</font>

325
00:17:20,959 --> 00:17:24,500
<font color="#E5E5E5">two days ago that I don't agree with</font>

326
00:17:22,539 --> 00:17:26,449
<font color="#CCCCCC">gatekeepers a security feature that</font>

327
00:17:24,500 --> 00:17:28,789
enforces<font color="#CCCCCC"> cosign and verifies the</font>

328
00:17:26,449 --> 00:17:31,940
<font color="#E5E5E5">downloaded application poor live</font><font color="#CCCCCC"> in a</font>

329
00:17:28,789 --> 00:17:34,669
run right one time and that's off<font color="#E5E5E5"> of</font>

330
00:17:31,940 --> 00:17:38,059
<font color="#CCCCCC">Wikipedia</font><font color="#E5E5E5"> says true</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is how a</font>

331
00:17:34,669 --> 00:18:04,429
police gatekeeper<font color="#E5E5E5"> it's very awesome this</font>

332
00:17:38,059 --> 00:18:07,789
<font color="#E5E5E5">is how I see it does not computer savvy</font>

333
00:18:04,429 --> 00:18:10,640
<font color="#E5E5E5">to go and download an application bundle</font>

334
00:18:07,789 --> 00:18:20,750
<font color="#E5E5E5">off of a shady website</font><font color="#CCCCCC"> you know that's</font>

335
00:18:10,640 --> 00:18:23,990
not so yeah it does help people<font color="#E5E5E5"> but it's</font>

336
00:18:20,750 --> 00:18:26,179
<font color="#E5E5E5">really not so</font><font color="#CCCCCC"> patrick moore</font><font color="#E5E5E5"> will talk</font>

337
00:18:23,990 --> 00:18:31,220
about this in his hey peepers exposed

338
00:18:26,179 --> 00:18:33,559
talk back in<font color="#CCCCCC"> i don't know was like</font>

339
00:18:31,220 --> 00:18:36,559
<font color="#CCCCCC">twenty sixty or some point that i can go</font>

340
00:18:33,559 --> 00:18:39,168
over<font color="#CCCCCC"> the details here so what does all</font>

341
00:18:36,559 --> 00:18:42,158
<font color="#CCCCCC">that doesn't</font><font color="#E5E5E5"> protect on the bypass</font>

342
00:18:39,169 --> 00:18:45,590
<font color="#E5E5E5">gatekeeper so an application bubbles and</font>

343
00:18:42,159 --> 00:18:48,080
DG's downloaded or the browser and<font color="#E5E5E5"> also</font>

344
00:18:45,590 --> 00:18:49,760
<font color="#E5E5E5">happen</font><font color="#CCCCCC"> to change</font><font color="#E5E5E5"> these at any time they</font>

345
00:18:48,080 --> 00:18:52,320
can<font color="#E5E5E5"> they can do whatever</font><font color="#CCCCCC"> they want</font>

346
00:18:49,760 --> 00:18:54,910
<font color="#CCCCCC">Sarah</font><font color="#E5E5E5"> us</font>

347
00:18:52,320 --> 00:18:57,490
so if you use<font color="#E5E5E5"> their</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> Banco</font>

348
00:18:54,910 --> 00:19:00,610
binaries<font color="#E5E5E5"> that's my homeroom</font><font color="#CCCCCC"> execute for</font>

349
00:18:57,490 --> 00:19:02,530
you<font color="#CCCCCC"> download it</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> there's no gate</font>

350
00:19:00,610 --> 00:19:04,540
<font color="#CCCCCC">keeper check at all so that's why that's</font>

351
00:19:02,530 --> 00:19:08,050
that's what I use mostly if I get access

352
00:19:04,540 --> 00:19:10,360
<font color="#CCCCCC">to a machine</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> just run amok oh so if</font>

353
00:19:08,050 --> 00:19:13,210
you have protect against<font color="#E5E5E5"> nip bundles</font>

354
00:19:10,360 --> 00:19:20,399
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you download it over the browser</font>

355
00:19:13,210 --> 00:19:24,400
<font color="#E5E5E5">unless you</font><font color="#CCCCCC"> sevens</font><font color="#E5E5E5"> in so if you 7-zip if</font>

356
00:19:20,400 --> 00:19:27,880
but little<font color="#E5E5E5"> via the browser will check</font>

357
00:19:24,400 --> 00:19:33,670
for<font color="#E5E5E5"> that uses curl or double you get</font>

358
00:19:27,880 --> 00:19:35,560
underneath those<font color="#E5E5E5"> and also refuse it</font><font color="#CCCCCC"> you</font>

359
00:19:33,670 --> 00:19:38,200
know if you're fishing<font color="#E5E5E5"> misty sticks and</font>

360
00:19:35,560 --> 00:19:40,870
using a<font color="#CCCCCC"> half bumble</font><font color="#E5E5E5"> there's been</font><font color="#CCCCCC"> check</font>

361
00:19:38,200 --> 00:19:46,060
<font color="#E5E5E5">that I wouldn't use can somebody get</font>

362
00:19:40,870 --> 00:19:47,889
<font color="#CCCCCC">that board please take it yeah I</font>

363
00:19:46,060 --> 00:19:51,490
wouldn't<font color="#CCCCCC"> use a half mumbles in general</font>

364
00:19:47,890 --> 00:19:53,860
if you're<font color="#CCCCCC"> contesting just so this is</font>

365
00:19:51,490 --> 00:19:57,190
where I'm<font color="#E5E5E5"> gonna make a detour and I got</font>

366
00:19:53,860 --> 00:19:58,629
nothing against the researcher that had

367
00:19:57,190 --> 00:20:01,450
this part will come out<font color="#E5E5E5"> but it ended up</font>

368
00:19:58,630 --> 00:20:04,330
<font color="#CCCCCC">in Wired and if you're gonna publish</font>

369
00:20:01,450 --> 00:20:08,230
something in Wired<font color="#E5E5E5"> better bring it</font>

370
00:20:04,330 --> 00:20:10,360
so this came<font color="#E5E5E5"> out two</font><font color="#CCCCCC"> days ago it</font><font color="#E5E5E5"> was a</font>

371
00:20:08,230 --> 00:20:12,490
<font color="#CCCCCC">talk</font><font color="#E5E5E5"> that happened at</font><font color="#CCCCCC"> virus the bulletin</font>

372
00:20:10,360 --> 00:20:16,240
<font color="#CCCCCC">and I don't really</font><font color="#E5E5E5"> agree</font><font color="#CCCCCC"> with concepts</font>

373
00:20:12,490 --> 00:20:19,300
I'm<font color="#E5E5E5"> gonna tell you why and here we go</font>

374
00:20:16,240 --> 00:20:21,430
so there are<font color="#E5E5E5"> three main points</font><font color="#CCCCCC"> maca less</font>

375
00:20:19,300 --> 00:20:24,490
for<font color="#E5E5E5"> Mac</font><font color="#CCCCCC"> OS does not check</font><font color="#E5E5E5"> code</font>

376
00:20:21,430 --> 00:20:27,550
signatures after first run<font color="#E5E5E5"> Cottle</font>

377
00:20:24,490 --> 00:20:29,790
infection is new<font color="#E5E5E5"> application should</font><font color="#CCCCCC"> be</font>

378
00:20:27,550 --> 00:20:32,379
<font color="#E5E5E5">self checks to ensure no modification</font>

379
00:20:29,790 --> 00:20:33,270
<font color="#E5E5E5">those are the three main points</font><font color="#CCCCCC"> where</font>

380
00:20:32,380 --> 00:20:35,890
each month

381
00:20:33,270 --> 00:20:39,639
so<font color="#CCCCCC"> with checking Co signatures after</font>

382
00:20:35,890 --> 00:20:42,810
first<font color="#CCCCCC"> run and</font><font color="#E5E5E5"> my response is so what and</font>

383
00:20:39,640 --> 00:20:46,210
this<font color="#E5E5E5"> is only for application bundles</font>

384
00:20:42,810 --> 00:20:49,450
<font color="#E5E5E5">right see my prior slides and no</font><font color="#CCCCCC"> they're</font>

385
00:20:46,210 --> 00:20:52,470
<font color="#E5E5E5">less does this right there's no security</font>

386
00:20:49,450 --> 00:20:55,840
checks on<font color="#CCCCCC"> windows on a default installer</font>

387
00:20:52,470 --> 00:20:58,810
so this is kind of a<font color="#E5E5E5"> non-issue</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> if</font>

388
00:20:55,840 --> 00:21:00,490
you do<font color="#CCCCCC"> Co sign your checks it has to be</font>

389
00:20:58,810 --> 00:21:01,570
a binary load<font color="#E5E5E5"> time where there's being</font>

390
00:21:00,490 --> 00:21:03,369
blase about it

391
00:21:01,570 --> 00:21:05,320
and that it's really<font color="#CCCCCC"> not severity</font>

392
00:21:03,369 --> 00:21:09,220
control<font color="#E5E5E5"> so you're gonna have a race</font>

393
00:21:05,320 --> 00:21:10,539
condition<font color="#E5E5E5"> and if you do it if you do it</font>

394
00:21:09,220 --> 00:21:11,649
it binder a little time<font color="#E5E5E5"> and call this we</font>

395
00:21:10,539 --> 00:21:15,158
call<font color="#CCCCCC"> it this</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> called whitelist and</font>

396
00:21:11,649 --> 00:21:18,039
<font color="#E5E5E5">it's been around</font><font color="#CCCCCC"> for a long time and you</font>

397
00:21:15,159 --> 00:21:21,669
can actually put your<font color="#CCCCCC"> Mac and iOS</font><font color="#E5E5E5"> move</font>

398
00:21:18,039 --> 00:21:23,859
right now<font color="#E5E5E5"> with this command and only</font>

399
00:21:21,669 --> 00:21:24,369
<font color="#E5E5E5">Apple sign coke and rum from the App</font>

400
00:21:23,859 --> 00:21:26,350
Store

401
00:21:24,369 --> 00:21:30,399
it's very capable if you do that<font color="#E5E5E5"> I've</font>

402
00:21:26,350 --> 00:21:33,668
done<font color="#E5E5E5"> it it's like oh my god</font><font color="#CCCCCC"> so if you do</font>

403
00:21:30,399 --> 00:21:35,978
that and the reason<font color="#CCCCCC"> that this</font><font color="#E5E5E5"> was a</font>

404
00:21:33,669 --> 00:21:38,769
suggestion is because it<font color="#CCCCCC"> needs</font><font color="#E5E5E5"> to they</font>

405
00:21:35,979 --> 00:21:42,159
need for<font color="#E5E5E5"> a</font><font color="#CCCCCC"> B and</font><font color="#E5E5E5"> there are at a virus</font>

406
00:21:38,769 --> 00:21:48,669
bullets in the conference and for a

407
00:21:42,159 --> 00:21:52,720
virus<font color="#E5E5E5"> anniversary so this is yeah anyway</font>

408
00:21:48,669 --> 00:21:53,919
file infection is new so thought<font color="#E5E5E5"> that</font>

409
00:21:52,720 --> 00:22:04,299
she goes back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the games</font>

410
00:21:53,919 --> 00:22:09,940
<font color="#CCCCCC">I heard mamako for Mongo</font><font color="#E5E5E5"> in 2006 ROYGBIV</font>

411
00:22:04,299 --> 00:22:12,158
<font color="#CCCCCC">which I'm sure is his real name age hero</font>

412
00:22:09,940 --> 00:22:17,830
method which is no longer<font color="#CCCCCC"> usable because</font>

413
00:22:12,159 --> 00:22:20,879
<font color="#E5E5E5">of changes so</font><font color="#CCCCCC"> 2006 2012</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> section</font>

414
00:22:17,830 --> 00:22:23,549
<font color="#CCCCCC">reverser FG introduced a library</font>

415
00:22:20,879 --> 00:22:28,119
infection<font color="#CCCCCC"> method and then myself</font>

416
00:22:23,549 --> 00:22:29,918
<font color="#E5E5E5">introduced a pretext infection method</font>

417
00:22:28,119 --> 00:22:35,019
and has been in the back row factory

418
00:22:29,919 --> 00:22:37,419
since 2014<font color="#E5E5E5"> so it's definitely not and so</font>

419
00:22:35,019 --> 00:22:39,639
the next point was an<font color="#E5E5E5"> application to</font>

420
00:22:37,419 --> 00:22:42,099
self checks to ensure no modification

421
00:22:39,639 --> 00:22:44,199
<font color="#CCCCCC">just show his who thinks</font><font color="#E5E5E5"> that's a really</font>

422
00:22:42,099 --> 00:22:45,158
good idea<font color="#E5E5E5"> who think</font><font color="#CCCCCC"> that who think</font>

423
00:22:44,200 --> 00:22:47,830
that's<font color="#E5E5E5"> a bad</font><font color="#CCCCCC"> idea</font>

424
00:22:45,159 --> 00:22:51,940
show hands<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> those of</font><font color="#E5E5E5"> you that are on</font>

425
00:22:47,830 --> 00:22:54,759
the<font color="#E5E5E5"> fence or have done hands</font><font color="#CCCCCC"> it's</font>

426
00:22:51,940 --> 00:22:56,679
generally<font color="#E5E5E5"> not a good idea</font><font color="#CCCCCC"> and you're</font>

427
00:22:54,759 --> 00:22:58,119
going to<font color="#CCCCCC"> have race conditions</font><font color="#E5E5E5"> unless</font>

428
00:22:56,679 --> 00:23:01,330
<font color="#E5E5E5">it's coming from the</font><font color="#CCCCCC"> kernel</font>

429
00:22:58,119 --> 00:23:04,779
<font color="#E5E5E5">listen in the kernel that boo you're</font>

430
00:23:01,330 --> 00:23:08,399
going to<font color="#E5E5E5"> race conditions and if I can</font>

431
00:23:04,779 --> 00:23:08,399
<font color="#E5E5E5">modify the fire</font><font color="#CCCCCC"> age</font><font color="#E5E5E5"> modify the checks</font>

432
00:23:08,520 --> 00:23:14,170
so this is part of<font color="#E5E5E5"> a particle as a</font>

433
00:23:12,340 --> 00:23:16,090
result of this research<font color="#E5E5E5"> you read himself</font>

434
00:23:14,170 --> 00:23:18,490
<font color="#E5E5E5">at a</font><font color="#CCCCCC"> co-signature verification of my</font>

435
00:23:16,090 --> 00:23:21,490
wife Mac products<font color="#E5E5E5"> so you're not before</font>

436
00:23:18,490 --> 00:23:45,190
me check every time they<font color="#E5E5E5"> launch my</font>

437
00:23:21,490 --> 00:23:46,870
response and so I get back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> my hotel</font>

438
00:23:45,190 --> 00:23:48,310
room<font color="#E5E5E5"> at like 1:30 morning I'm like well</font>

439
00:23:46,870 --> 00:23:55,780
how long will<font color="#E5E5E5"> it take me to bypass this</font>

440
00:23:48,310 --> 00:24:01,450
and<font color="#CCCCCC"> take ten minutes just to show you</font>

441
00:23:55,780 --> 00:24:03,340
this<font color="#E5E5E5"> and put this to rest</font><font color="#CCCCCC"> all right so</font>

442
00:24:01,450 --> 00:24:05,680
on the right same times I've got the

443
00:24:03,340 --> 00:24:07,300
attacker<font color="#E5E5E5"> already on the</font><font color="#CCCCCC"> left got the</font>

444
00:24:05,680 --> 00:24:09,640
attack on the<font color="#CCCCCC"> dragging of the victim</font>

445
00:24:07,300 --> 00:24:18,399
we got the recent<font color="#E5E5E5"> version of</font><font color="#CCCCCC"> ice trial</font>

446
00:24:09,640 --> 00:24:19,600
<font color="#E5E5E5">and so so what I'm gonna do here is I'm</font>

447
00:24:18,400 --> 00:24:21,520
going to<font color="#E5E5E5"> pop</font><font color="#CCCCCC"> in this thing called</font>

448
00:24:19,600 --> 00:24:25,060
settings<font color="#E5E5E5"> test into the</font><font color="#CCCCCC"> sudden sentence</font>

449
00:24:21,520 --> 00:24:28,210
demon<font color="#E5E5E5"> and I is the back door factory</font>

450
00:24:25,060 --> 00:24:30,070
patched version of itself<font color="#E5E5E5"> it is not</font>

451
00:24:28,210 --> 00:24:34,270
<font color="#E5E5E5">signed</font><font color="#CCCCCC"> and back row fact that runs</font>

452
00:24:30,070 --> 00:24:37,300
<font color="#CCCCCC">removes the</font><font color="#E5E5E5"> code signature okay</font><font color="#CCCCCC"> then I'm</font>

453
00:24:34,270 --> 00:24:38,770
going to kill the demon and then go to

454
00:24:37,300 --> 00:24:43,379
settings and<font color="#CCCCCC"> then you'll see that I get</font>

455
00:24:38,770 --> 00:24:46,720
a<font color="#E5E5E5"> shell</font>

456
00:24:43,380 --> 00:24:51,820
and then you'll see<font color="#CCCCCC"> that there's a self</font>

457
00:24:46,720 --> 00:24:53,950
check<font color="#E5E5E5"> okay so now I'm going to confident</font>

458
00:24:51,820 --> 00:24:58,230
we're going<font color="#E5E5E5"> back kill the process and</font>

459
00:24:53,950 --> 00:24:58,230
then I'm going<font color="#CCCCCC"> to run back over factory</font>

460
00:25:17,960 --> 00:25:27,000
delicious anyway<font color="#CCCCCC"> so I'm gonna execute</font>

461
00:25:22,320 --> 00:25:28,470
vector<font color="#E5E5E5"> vector here and I'm so what I'm</font>

462
00:25:27,000 --> 00:25:31,410
matching here is<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> real time</font>

463
00:25:28,470 --> 00:25:33,480
protection process<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> cashing the</font>

464
00:25:31,410 --> 00:25:39,080
process that<font color="#E5E5E5"> ensures that it doesn't get</font>

465
00:25:33,480 --> 00:25:41,429
<font color="#E5E5E5">patched so I'm going to head over</font><font color="#CCCCCC"> to the</font>

466
00:25:39,080 --> 00:25:43,409
workstation<font color="#E5E5E5"> I'm just going to run a real</font>

467
00:25:41,429 --> 00:25:47,790
script that just<font color="#CCCCCC"> does what I</font><font color="#E5E5E5"> just showed</font>

468
00:25:43,410 --> 00:25:54,950
you<font color="#CCCCCC"> just doesn't quickly</font><font color="#E5E5E5"> and then you</font>

469
00:25:47,790 --> 00:25:57,629
see I got a<font color="#E5E5E5"> red shell right eye and</font>

470
00:25:54,950 --> 00:26:04,700
<font color="#CCCCCC">you'll see</font><font color="#E5E5E5"> that I didn't get any warning</font>

471
00:25:57,630 --> 00:26:04,700
this<font color="#CCCCCC"> time because I read</font><font color="#E5E5E5"> so I'm</font>

472
00:26:12,590 --> 00:26:35,610
<font color="#CCCCCC">researcher so I decide to contact that</font>

473
00:26:31,620 --> 00:26:38,570
<font color="#CCCCCC">about this bug</font><font color="#E5E5E5"> and on February 2nd</font><font color="#CCCCCC"> I</font>

474
00:26:35,610 --> 00:26:42,659
sent the initial sample<font color="#E5E5E5"> that was not</font>

475
00:26:38,570 --> 00:26:45,540
self signed to Apple and I knew I would

476
00:26:42,660 --> 00:26:47,549
get this response<font color="#E5E5E5"> they said I need to do</font>

477
00:26:45,540 --> 00:26:49,290
<font color="#E5E5E5">this trick checking so then I provided</font>

478
00:26:47,549 --> 00:26:52,530
them a<font color="#CCCCCC"> sample that bypassed their</font>

479
00:26:49,290 --> 00:26:53,940
recommendation and then they gave you

480
00:26:52,530 --> 00:26:57,000
another<font color="#CCCCCC"> recommendation and didn't solve</font>

481
00:26:53,940 --> 00:26:58,770
the issue<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I told them how I would</font>

482
00:26:57,000 --> 00:27:00,360
address<font color="#E5E5E5"> the issue and then they said</font>

483
00:26:58,770 --> 00:27:02,879
<font color="#CCCCCC">that all third-party developers have to</font>

484
00:27:00,360 --> 00:27:05,250
do this on their own<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then we'll</font>

485
00:27:02,880 --> 00:27:07,320
update the documentation<font color="#CCCCCC"> so it's not a</font>

486
00:27:05,250 --> 00:27:09,830
<font color="#CCCCCC">wonderful now I haven't</font><font color="#E5E5E5"> found any real</font>

487
00:27:07,320 --> 00:27:12,409
security<font color="#CCCCCC"> baton boundaries in their code</font>

488
00:27:09,830 --> 00:27:15,139
say yes they're vulnerable though if you

489
00:27:12,410 --> 00:27:18,650
<font color="#CCCCCC">look at the</font><font color="#E5E5E5"> system information at see</font>

490
00:27:15,140 --> 00:27:20,360
that this is my terminal at<font color="#E5E5E5"> POC and it</font>

491
00:27:18,650 --> 00:27:22,220
says that it's signed by<font color="#E5E5E5"> Apple</font><font color="#CCCCCC"> now I</font>

492
00:27:20,360 --> 00:27:24,879
hope they're not<font color="#E5E5E5"> making security</font>

493
00:27:22,220 --> 00:27:32,480
decisions from<font color="#E5E5E5"> these information now but</font>

494
00:27:24,880 --> 00:27:36,790
so yeah<font color="#CCCCCC"> so developer reactions were very</font>

495
00:27:32,480 --> 00:27:36,790
<font color="#CCCCCC">good this</font><font color="#E5E5E5"> is one reaction</font>

496
00:27:51,090 --> 00:27:54,179
[Music]

497
00:27:58,810 --> 00:28:05,899
<font color="#CCCCCC">I contacted</font><font color="#E5E5E5"> served the Carnegie Mellon</font>

498
00:28:02,960 --> 00:28:08,150
<font color="#E5E5E5">and the blog post because</font><font color="#CCCCCC"> we don't know</font>

499
00:28:05,900 --> 00:28:10,700
<font color="#E5E5E5">who's using this code</font><font color="#CCCCCC"> sine cosine in the</font>

500
00:28:08,150 --> 00:28:12,650
API is eternally<font color="#CCCCCC"> I'm sure</font><font color="#E5E5E5"> people are</font>

501
00:28:10,700 --> 00:28:15,530
writing their own stop<font color="#E5E5E5"> especially the</font>

502
00:28:12,650 --> 00:28:17,960
government<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> had</font><font color="#E5E5E5"> the public</font>

503
00:28:15,530 --> 00:28:20,420
disclosure<font color="#CCCCCC"> and so this is their</font>

504
00:28:17,960 --> 00:28:23,030
documentation<font color="#E5E5E5"> common API at the top</font>

505
00:28:20,420 --> 00:28:25,520
<font color="#E5E5E5">before and</font><font color="#CCCCCC"> after</font>

506
00:28:23,030 --> 00:28:27,770
so this paragraph specifically I'm just

507
00:28:25,520 --> 00:28:29,420
going<font color="#E5E5E5"> to call out a sentence or</font><font color="#CCCCCC"> two be</font>

508
00:28:27,770 --> 00:28:30,980
aware that the slices<font color="#E5E5E5"> of the universal</font>

509
00:28:29,420 --> 00:28:34,490
binary<font color="#E5E5E5"> don't have to be signed by</font><font color="#CCCCCC"> the</font>

510
00:28:30,980 --> 00:28:41,720
same signer or the test<font color="#CCCCCC"> pass</font><font color="#E5E5E5"> one slice</font>

511
00:28:34,490 --> 00:28:44,660
might be at my<font color="#E5E5E5"> side for example yes yeah</font>

512
00:28:41,720 --> 00:28:46,310
that's<font color="#E5E5E5"> it so how do we that was all</font>

513
00:28:44,660 --> 00:28:47,900
basically<font color="#E5E5E5"> all that was</font><font color="#CCCCCC"> updated there was</font>

514
00:28:46,310 --> 00:28:49,610
another API<font color="#E5E5E5"> that was updated</font><font color="#CCCCCC"> but they do</font>

515
00:28:47,900 --> 00:28:50,300
the same<font color="#CCCCCC"> thing one returns with errors</font>

516
00:28:49,610 --> 00:28:52,760
<font color="#CCCCCC">and one doesn't</font>

517
00:28:50,300 --> 00:28:55,220
so how do we do<font color="#E5E5E5"> this correctly</font><font color="#CCCCCC"> well</font>

518
00:28:52,760 --> 00:28:56,870
there's different<font color="#E5E5E5"> ways you're a non</font>

519
00:28:55,220 --> 00:29:00,650
developer or if you're working from<font color="#E5E5E5"> the</font>

520
00:28:56,870 --> 00:29:03,199
command line<font color="#E5E5E5"> you use cosign you have to</font>

521
00:29:00,650 --> 00:29:07,360
specifically call in<font color="#E5E5E5"> there</font><font color="#CCCCCC"> Apple on the</font>

522
00:29:03,200 --> 00:29:09,890
<font color="#CCCCCC">app or the</font><font color="#E5E5E5"> PID you can check in memory</font>

523
00:29:07,360 --> 00:29:14,919
<font color="#CCCCCC">or if you're doing Apple generic means</font>

524
00:29:09,890 --> 00:29:14,920
anything that<font color="#E5E5E5"> is from a developer a</font>

525
00:29:16,810 --> 00:29:26,159
developer

526
00:29:19,400 --> 00:29:27,960
from a developer<font color="#CCCCCC"> coach has</font><font color="#E5E5E5"> rooted or</font><font color="#CCCCCC"> you</font>

527
00:29:26,160 --> 00:29:30,870
can use<font color="#CCCCCC"> lipo that fun</font><font color="#E5E5E5"> little tool again</font>

528
00:29:27,960 --> 00:29:36,060
<font color="#E5E5E5">to send them out the fat file barely</font>

529
00:29:30,870 --> 00:29:37,979
<font color="#CCCCCC">exists then pull out the</font><font color="#E5E5E5"> 64-bit part</font>

530
00:29:36,060 --> 00:29:39,360
like out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> login for example and then</font>

531
00:29:37,980 --> 00:29:42,630
<font color="#CCCCCC">you can check to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that they're</font>

532
00:29:39,360 --> 00:29:44,129
<font color="#CCCCCC">actually the same program</font><font color="#E5E5E5"> because you</font>

533
00:29:42,630 --> 00:29:47,850
<font color="#CCCCCC">can</font><font color="#E5E5E5"> make some mash different programs</font>

534
00:29:44,130 --> 00:29:50,040
<font color="#E5E5E5">together so free</font><font color="#CCCCCC"> adulterers it's really</font>

535
00:29:47,850 --> 00:29:51,419
simple you<font color="#CCCCCC"> just call this separate</font>

536
00:29:50,040 --> 00:29:53,790
partnered with stranding<font color="#E5E5E5"> and then you</font>

537
00:29:51,420 --> 00:29:55,880
pass in<font color="#CCCCCC"> your app or a</font><font color="#E5E5E5"> deploy Ankur</font>

538
00:29:53,790 --> 00:30:00,149
Kotwal generic that<font color="#E5E5E5"> you call this but</font>

539
00:29:55,880 --> 00:30:02,640
all of them<font color="#CCCCCC"> and then you have to depend</font>

540
00:30:00,150 --> 00:30:04,230
<font color="#CCCCCC">on what you want</font><font color="#E5E5E5"> to see like boysenberry</font>

541
00:30:02,640 --> 00:30:05,760
<font color="#E5E5E5">they have to break out you slice</font><font color="#CCCCCC"> in the</font>

542
00:30:04,230 --> 00:30:09,030
<font color="#E5E5E5">fat file to ensure that</font><font color="#CCCCCC"> they're by the</font>

543
00:30:05,760 --> 00:30:14,670
same signer<font color="#E5E5E5"> and by increasing the</font>

544
00:30:09,030 --> 00:30:16,620
complexity there that doesn't so

545
00:30:14,670 --> 00:30:19,680
penetration<font color="#E5E5E5"> tester you're testing a</font>

546
00:30:16,620 --> 00:30:21,689
product either<font color="#E5E5E5"> either internally as part</font>

547
00:30:19,680 --> 00:30:23,010
<font color="#CCCCCC">of a product about don't development</font>

548
00:30:21,690 --> 00:30:25,230
cycle or if you're testing against

549
00:30:23,010 --> 00:30:27,600
anything<font color="#CCCCCC"> to this</font><font color="#E5E5E5"> code signing we have</font>

550
00:30:25,230 --> 00:30:30,060
some samples there<font color="#E5E5E5"> ought to security</font>

551
00:30:27,600 --> 00:30:35,120
<font color="#E5E5E5">labs on github and you</font><font color="#CCCCCC"> just download the</font>

552
00:30:30,060 --> 00:30:37,950
samples and test against<font color="#E5E5E5"> the actual</font>

553
00:30:35,120 --> 00:30:40,590
product<font color="#CCCCCC"> and all those samples</font><font color="#E5E5E5"> should</font>

554
00:30:37,950 --> 00:30:43,380
come back has invalid<font color="#E5E5E5"> so how do I find</font>

555
00:30:40,590 --> 00:30:46,350
<font color="#E5E5E5">us well I've been doing cocoa signing</font>

556
00:30:43,380 --> 00:30:51,630
stuff for a while<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just from the nature</font>

557
00:30:46,350 --> 00:30:55,199
<font color="#CCCCCC">of writing the UM</font>

558
00:30:51,630 --> 00:30:57,570
so this was an interesting<font color="#E5E5E5"> bug just</font>

559
00:30:55,200 --> 00:31:00,960
outside<font color="#E5E5E5"> of resources and</font><font color="#CCCCCC"> I kept</font><font color="#E5E5E5"> talking</font>

560
00:30:57,570 --> 00:31:03,270
<font color="#E5E5E5">2016 about hiding the investigator and I</font>

561
00:31:00,960 --> 00:31:05,580
found<font color="#E5E5E5"> a kind of a weird bug if I added</font>

562
00:31:03,270 --> 00:31:07,950
padding to these are the padding between

563
00:31:05,580 --> 00:31:08,929
<font color="#E5E5E5">each motto is</font><font color="#CCCCCC"> straight yours if you had</font>

564
00:31:07,950 --> 00:31:12,570
anything in there

565
00:31:08,930 --> 00:31:16,130
<font color="#CCCCCC">could sign the</font><font color="#E5E5E5"> air</font><font color="#CCCCCC"> l you says</font><font color="#E5E5E5"> something</font>

566
00:31:12,570 --> 00:31:18,960
<font color="#E5E5E5">happened</font><font color="#CCCCCC"> sorry</font>

567
00:31:16,130 --> 00:31:21,090
so this<font color="#CCCCCC"> maybe want to</font><font color="#E5E5E5"> look at the</font>

568
00:31:18,960 --> 00:31:22,710
universal file from<font color="#E5E5E5"> that a little</font><font color="#CCCCCC"> bit</font>

569
00:31:21,090 --> 00:31:25,409
more teacher I knew that there were more

570
00:31:22,710 --> 00:31:28,590
gloves<font color="#E5E5E5"> you know in that area</font><font color="#CCCCCC"> so fast</font>

571
00:31:25,410 --> 00:31:31,350
forward<font color="#E5E5E5"> with urgency about almost two</font>

572
00:31:28,590 --> 00:31:31,800
years later<font color="#E5E5E5"> I decided to look at</font><font color="#CCCCCC"> this</font>

573
00:31:31,350 --> 00:31:34,850
<font color="#E5E5E5">again</font>

574
00:31:31,800 --> 00:31:39,889
and I for instance<font color="#E5E5E5"> I put it back door in</font>

575
00:31:34,850 --> 00:31:43,280
<font color="#CCCCCC">Pearl and then I uploaded the virustotal</font>

576
00:31:39,890 --> 00:31:46,110
and I got it was in fat pile and<font color="#E5E5E5"> I got</font>

577
00:31:43,280 --> 00:31:49,320
that it<font color="#E5E5E5"> was signed by Apple I was like</font>

578
00:31:46,110 --> 00:31:51,740
holy crap<font color="#CCCCCC"> so I knew I was</font><font color="#E5E5E5"> kind of going</font>

579
00:31:49,320 --> 00:31:55,530
on<font color="#E5E5E5"> the right</font><font color="#CCCCCC"> track here</font>

580
00:31:51,740 --> 00:31:58,530
so I come around<font color="#E5E5E5"> February 13th</font><font color="#CCCCCC"> you know</font>

581
00:31:55,530 --> 00:32:00,480
I'm really really<font color="#E5E5E5"> in a hurry what</font>

582
00:31:58,530 --> 00:32:06,389
<font color="#E5E5E5">actually happens that kid and I just</font>

583
00:32:00,480 --> 00:32:13,110
<font color="#CCCCCC">right after that so so one thing I</font>

584
00:32:06,390 --> 00:32:13,920
wanted<font color="#E5E5E5"> to see if I can create a mouth to</font>

585
00:32:13,110 --> 00:32:17,490
<font color="#CCCCCC">chipsets</font>

586
00:32:13,920 --> 00:32:22,410
the same time and I was like<font color="#CCCCCC"> can</font><font color="#E5E5E5"> I use</font>

587
00:32:17,490 --> 00:32:24,120
and I really the<font color="#E5E5E5"> you'll see that you</font>

588
00:32:22,410 --> 00:32:27,420
know as<font color="#E5E5E5"> the area says they have the same</font>

589
00:32:24,120 --> 00:32:28,919
architectures generally if<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> that</font>

590
00:32:27,420 --> 00:32:29,940
<font color="#E5E5E5">kind of error if something's trying to</font>

591
00:32:28,920 --> 00:32:32,730
<font color="#CCCCCC">hamstring</font>

592
00:32:29,940 --> 00:32:38,070
doing something to<font color="#CCCCCC"> protect you you want</font>

593
00:32:32,730 --> 00:32:40,170
<font color="#E5E5E5">to look at you want to do that thing I'm</font>

594
00:32:38,070 --> 00:32:42,330
going to do that so I manually<font color="#E5E5E5"> did it</font><font color="#CCCCCC"> I</font>

595
00:32:40,170 --> 00:32:44,610
created a fat file that would do<font color="#E5E5E5"> this</font>

596
00:32:42,330 --> 00:32:48,960
and then the loader<font color="#E5E5E5"> the</font><font color="#CCCCCC"> mock-up loader</font>

597
00:32:44,610 --> 00:32:50,459
fail<font color="#E5E5E5"> okay then the next</font><font color="#CCCCCC"> question was is</font>

598
00:32:48,960 --> 00:32:53,430
like how<font color="#CCCCCC"> can I</font><font color="#E5E5E5"> make this an execute</font>

599
00:32:50,460 --> 00:32:57,060
<font color="#E5E5E5">anyway I wanted to execute</font><font color="#CCCCCC"> inter makes a</font>

600
00:32:53,430 --> 00:33:00,300
<font color="#E5E5E5">match and that's when I found that if I</font>

601
00:32:57,060 --> 00:33:02,190
changed the<font color="#E5E5E5"> CPU types</font><font color="#CCCCCC"> I can get code</font>

602
00:33:00,300 --> 00:33:04,020
execution<font color="#E5E5E5"> and I have to be able to</font>

603
00:33:02,190 --> 00:33:06,120
create<font color="#CCCCCC"> a malformed fat biology</font><font color="#E5E5E5"> I was</font>

604
00:33:04,020 --> 00:33:08,310
quickly able to make a fat<font color="#E5E5E5"> file</font><font color="#CCCCCC"> bypass</font>

605
00:33:06,120 --> 00:33:10,530
<font color="#E5E5E5">and</font><font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> developer code signing</font>

606
00:33:08,310 --> 00:33:12,800
checks by using their<font color="#CCCCCC"> novel signed code</font>

607
00:33:10,530 --> 00:33:12,800
first

608
00:33:13,000 --> 00:33:19,389
and everything else<font color="#CCCCCC"> you see</font><font color="#E5E5E5"> from the</font>

609
00:33:15,190 --> 00:33:24,279
<font color="#E5E5E5">earlier parts this talk so in conclusion</font>

610
00:33:19,389 --> 00:33:27,729
I encourage<font color="#E5E5E5"> people to take a look at</font>

611
00:33:24,279 --> 00:33:30,549
<font color="#E5E5E5">code signing especially anywhere you see</font>

612
00:33:27,730 --> 00:33:33,309
<font color="#CCCCCC">buy any product</font><font color="#E5E5E5"> it's a corset recon</font>

613
00:33:30,549 --> 00:33:35,799
construct based in math<font color="#CCCCCC"> and it's</font>

614
00:33:33,309 --> 00:33:38,470
<font color="#E5E5E5">extremely complex</font><font color="#CCCCCC"> I believe</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> more</font>

615
00:33:35,799 --> 00:33:40,929
third-party developers will make state

616
00:33:38,470 --> 00:33:43,600
mistakes again<font color="#CCCCCC"> especially since the</font>

617
00:33:40,929 --> 00:34:00,009
documentation is<font color="#E5E5E5"> not very good</font><font color="#CCCCCC"> so any</font>

618
00:33:43,600 --> 00:34:03,399
questions<font color="#E5E5E5"> yes actually said oh yeah</font>

619
00:34:00,009 --> 00:34:08,859
right<font color="#CCCCCC"> and journalists are too so</font><font color="#E5E5E5"> value</font>

620
00:34:03,399 --> 00:34:10,918
<font color="#E5E5E5">from</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> went back and</font><font color="#CCCCCC"> forth</font><font color="#E5E5E5"> on</font>

621
00:34:08,859 --> 00:34:10,918
Twitter

622
00:34:35,070 --> 00:34:38,169
[Applause]

623
00:34:39,710 --> 00:34:44,059
<font color="#CCCCCC">oh she's just so in your example</font><font color="#E5E5E5"> that</font>

624
00:34:42,079 --> 00:34:47,030
<font color="#E5E5E5">you have</font><font color="#CCCCCC"> to code segments for different</font>

625
00:34:44,059 --> 00:34:53,690
<font color="#CCCCCC">particle CPU architecture to each other</font>

626
00:34:47,030 --> 00:34:55,940
<font color="#CCCCCC">or yeah so I don't know if there's</font>

627
00:34:53,690 --> 00:34:58,760
<font color="#CCCCCC">eleven and</font><font color="#E5E5E5"> if somebody wants</font><font color="#CCCCCC"> to strip</font>

628
00:34:55,940 --> 00:35:01,400
<font color="#CCCCCC">that it would be fun</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> would be</font>

629
00:34:58,760 --> 00:35:03,530
<font color="#CCCCCC">really fun</font><font color="#E5E5E5"> put like</font><font color="#CCCCCC"> 300</font><font color="#E5E5E5"> ship set</font>

630
00:35:01,400 --> 00:35:05,210
architecture together<font color="#CCCCCC"> palette types and</font>

631
00:35:03,530 --> 00:35:10,520
see what the loader does<font color="#CCCCCC"> they need a</font>

632
00:35:05,210 --> 00:35:23,240
code execution on you<font color="#E5E5E5"> 256 who knows the</font>

633
00:35:10,520 --> 00:35:26,930
other questions yes so if if<font color="#CCCCCC"> your this</font>

634
00:35:23,240 --> 00:35:28,669
<font color="#E5E5E5">is Douglas</font><font color="#CCCCCC"> 4-0 trust networks doesn't</font>

635
00:35:26,930 --> 00:35:31,040
<font color="#CCCCCC">like you're gonna have</font><font color="#E5E5E5"> zero trust</font>

636
00:35:28,670 --> 00:35:32,990
networks<font color="#E5E5E5"> you can't you need device trust</font>

637
00:35:31,040 --> 00:35:35,990
that<font color="#E5E5E5"> means you have to have a high</font>

638
00:35:32,990 --> 00:35:38,359
percent accuracy that nothing there's no

639
00:35:35,990 --> 00:35:41,058
<font color="#CCCCCC">malware on that device</font><font color="#E5E5E5"> that can get like</font>

640
00:35:38,359 --> 00:35:43,910
session<font color="#CCCCCC"> cookies up of the browser so you</font>

641
00:35:41,059 --> 00:35:46,630
need to have you need to<font color="#E5E5E5"> have at least</font>

642
00:35:43,910 --> 00:35:49,279
<font color="#E5E5E5">some kind of code signing on that device</font>

643
00:35:46,630 --> 00:35:52,220
<font color="#E5E5E5">right it's 70 cents yeah and then you</font>

644
00:35:49,280 --> 00:35:54,940
also got<font color="#CCCCCC"> that</font><font color="#E5E5E5"> monitoring so I mean</font>

645
00:35:52,220 --> 00:35:54,939
include look at

646
00:36:07,240 --> 00:36:11,560
and like<font color="#E5E5E5"> what's the most secure devices</font>

647
00:36:09,760 --> 00:36:13,570
out there right now<font color="#E5E5E5"> it's your Chrome OS</font>

648
00:36:11,560 --> 00:36:16,210
and<font color="#E5E5E5"> iOS right because a horse goes</font>

649
00:36:13,570 --> 00:36:17,950
<font color="#CCCCCC">talking all</font><font color="#E5E5E5"> the time</font><font color="#CCCCCC"> unless</font><font color="#E5E5E5"> you put it</font>

650
00:36:16,210 --> 00:36:20,740
<font color="#E5E5E5">like</font><font color="#CCCCCC"> unless</font><font color="#E5E5E5"> you put the Chrome OS in</font>

651
00:36:17,950 --> 00:36:22,569
developer mode<font color="#CCCCCC"> but then if you look at</font>

652
00:36:20,740 --> 00:36:25,540
the monitoring on iOS and chrome iOS

653
00:36:22,570 --> 00:36:43,750
<font color="#CCCCCC">devices it's not very good</font><font color="#E5E5E5"> so it's kind</font>

654
00:36:25,540 --> 00:36:46,900
of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> dick opposed any questions yes iOS</font>

655
00:36:43,750 --> 00:36:56,619
right now does<font color="#CCCCCC"> it</font><font color="#E5E5E5"> cuz I'm right now</font>

656
00:36:46,900 --> 00:36:58,810
<font color="#E5E5E5">that's I didn't just</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> hardware I mean</font>

657
00:36:56,619 --> 00:37:00,700
I think I<font color="#E5E5E5"> think I mean I'm not an iOS</font>

658
00:36:58,810 --> 00:37:04,349
expert<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> hardware is pretty no</font>

659
00:37:00,700 --> 00:37:04,348
there's a she's everything

