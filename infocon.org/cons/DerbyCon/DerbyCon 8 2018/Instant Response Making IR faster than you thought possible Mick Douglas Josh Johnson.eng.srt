1
00:00:00,000 --> 00:00:04,319
<font color="#E5E5E5">hi folks</font><font color="#CCCCCC"> Angie here</font><font color="#E5E5E5"> unfortunately</font><font color="#CCCCCC"> after</font>

2
00:00:02,190 --> 00:00:07,619
buckle<font color="#E5E5E5"> 26 minute</font><font color="#CCCCCC"> lock we lose audio</font><font color="#E5E5E5"> in</font>

3
00:00:04,319 --> 00:00:09,929
<font color="#E5E5E5">this video I have no idea why sorry for</font>

4
00:00:07,620 --> 00:00:15,690
the<font color="#E5E5E5"> inconvenience</font><font color="#CCCCCC"> but enjoy what we did</font>

5
00:00:09,929 --> 00:00:19,400
get recorded please<font color="#E5E5E5"> thank you</font><font color="#CCCCCC"> alright</font>

6
00:00:15,690 --> 00:00:24,960
<font color="#CCCCCC">well hey</font><font color="#E5E5E5"> derbycon</font><font color="#CCCCCC"> Hey</font>

7
00:00:19,400 --> 00:00:27,750
hi Internet<font color="#CCCCCC"> I so for</font><font color="#E5E5E5"> those of you who</font>

8
00:00:24,960 --> 00:00:29,880
were who are joining late on the stream

9
00:00:27,750 --> 00:00:32,369
<font color="#E5E5E5">or watching on the telly up in your</font>

10
00:00:29,880 --> 00:00:35,790
rooms<font color="#CCCCCC"> there's been some pretty</font><font color="#E5E5E5"> heavy</font>

11
00:00:32,369 --> 00:00:38,850
demo fail<font color="#E5E5E5"> so there's going to</font><font color="#CCCCCC"> be part of</font>

12
00:00:35,790 --> 00:00:40,860
this<font color="#E5E5E5"> lab part of this talk that won't</font>

13
00:00:38,850 --> 00:00:44,010
work as expected<font color="#E5E5E5"> but in the interest of</font>

14
00:00:40,860 --> 00:00:46,440
just moving<font color="#CCCCCC"> on over</font><font color="#E5E5E5"> four-fifths of the</font>

15
00:00:44,010 --> 00:00:49,949
demos will work<font color="#E5E5E5"> so we're just going to</font>

16
00:00:46,440 --> 00:00:53,579
move and get going so we're here to talk

17
00:00:49,950 --> 00:00:56,460
<font color="#CCCCCC">about instant response</font><font color="#E5E5E5"> and one of the</font>

18
00:00:53,579 --> 00:00:59,340
things that<font color="#E5E5E5"> I think that we're all</font>

19
00:00:56,460 --> 00:01:01,379
becoming<font color="#E5E5E5"> very painfully aware as</font>

20
00:00:59,340 --> 00:01:03,570
defenders is just how fast<font color="#E5E5E5"> the attacks</font>

21
00:01:01,379 --> 00:01:07,310
are taking place<font color="#CCCCCC"> I don't know if you</font>

22
00:01:03,570 --> 00:01:10,229
folks read the talk that was read<font color="#E5E5E5"> the</font>

23
00:01:07,310 --> 00:01:13,049
paper in Wired<font color="#E5E5E5"> about the not petty</font>

24
00:01:10,229 --> 00:01:15,750
attack<font color="#CCCCCC"> did you guys any takers on what</font>

25
00:01:13,049 --> 00:01:20,580
the fastest worldwide infection rate was

26
00:01:15,750 --> 00:01:27,180
for a company<font color="#E5E5E5"> 45 seconds</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> actually</font>

27
00:01:20,580 --> 00:01:30,780
lower 17 seconds<font color="#E5E5E5"> so we got to start</font>

28
00:01:27,180 --> 00:01:31,920
<font color="#CCCCCC">moving a lot</font><font color="#E5E5E5"> a lot faster so what we're</font>

29
00:01:30,780 --> 00:01:35,189
going<font color="#E5E5E5"> to be talking about are things</font>

30
00:01:31,920 --> 00:01:40,229
<font color="#E5E5E5">that you can do using built-in</font>

31
00:01:35,189 --> 00:01:42,720
<font color="#E5E5E5">components of</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> that allow you</font><font color="#CCCCCC"> to</font>

32
00:01:40,229 --> 00:01:44,939
do all<font color="#CCCCCC"> kinds of</font><font color="#E5E5E5"> interesting and fun</font>

33
00:01:42,720 --> 00:01:48,240
shenanigans<font color="#E5E5E5"> and really will frustrate</font>

34
00:01:44,939 --> 00:01:50,850
<font color="#E5E5E5">the attackers so what we're going to be</font>

35
00:01:48,240 --> 00:01:53,490
covering<font color="#E5E5E5"> is a series of</font><font color="#CCCCCC"> PowerShell</font>

36
00:01:50,850 --> 00:01:58,110
scripts and tools that<font color="#E5E5E5"> Josh</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I've</font>

37
00:01:53,490 --> 00:02:02,130
made<font color="#E5E5E5"> and basically each three of these</font>

38
00:01:58,110 --> 00:02:06,930
are<font color="#E5E5E5"> gonna be as a section that we cover</font>

39
00:02:02,130 --> 00:02:09,478
and all of them<font color="#E5E5E5"> should</font><font color="#CCCCCC"> help you make</font>

40
00:02:06,930 --> 00:02:12,840
your network significantly more hostile

41
00:02:09,479 --> 00:02:13,560
<font color="#CCCCCC">to the bad guys</font><font color="#E5E5E5"> without costing you a</font>

42
00:02:12,840 --> 00:02:17,040
thin

43
00:02:13,560 --> 00:02:19,410
dime<font color="#CCCCCC"> this is all based off</font><font color="#E5E5E5"> of components</font>

44
00:02:17,040 --> 00:02:23,220
that<font color="#E5E5E5"> every Windows machine has we're</font>

45
00:02:19,410 --> 00:02:27,750
using built-in<font color="#CCCCCC"> API</font><font color="#E5E5E5"> and we're just</font><font color="#CCCCCC"> using</font>

46
00:02:23,220 --> 00:02:30,720
them in novel and interesting<font color="#CCCCCC"> ways</font><font color="#E5E5E5"> so hi</font>

47
00:02:27,750 --> 00:02:34,739
my<font color="#E5E5E5"> name is Mick and this was</font><font color="#CCCCCC"> actually at</font>

48
00:02:30,720 --> 00:02:38,370
my<font color="#E5E5E5"> last Derby con talk so see you hi it</font>

49
00:02:34,739 --> 00:02:40,080
but I'm digging<font color="#E5E5E5"> the new digs</font><font color="#CCCCCC"> and when</font>

50
00:02:38,370 --> 00:02:41,730
I'm not<font color="#E5E5E5"> giving talks at Derby con I'm</font>

51
00:02:40,080 --> 00:02:44,430
the managing partner at InfoSec

52
00:02:41,730 --> 00:02:47,880
innovations<font color="#E5E5E5"> and what we do is exotic</font>

53
00:02:44,430 --> 00:02:50,880
defense<font color="#E5E5E5"> so basically if you</font><font color="#CCCCCC"> have a</font>

54
00:02:47,880 --> 00:02:52,829
network where<font color="#CCCCCC"> you want every host</font><font color="#E5E5E5"> you</font>

55
00:02:50,880 --> 00:02:58,500
want every firewall you want every

56
00:02:52,830 --> 00:03:01,080
router to be a some sort<font color="#E5E5E5"> of sensor you</font>

57
00:02:58,500 --> 00:03:03,150
can<font color="#E5E5E5"> do that basically if you're doing</font>

58
00:03:01,080 --> 00:03:06,989
defense<font color="#E5E5E5"> right</font><font color="#CCCCCC"> you're the</font><font color="#E5E5E5"> spider sitting</font>

59
00:03:03,150 --> 00:03:10,170
in the<font color="#CCCCCC"> center of</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> web and any thing</font>

60
00:03:06,989 --> 00:03:12,060
<font color="#E5E5E5">that the attackers do will be detectable</font>

61
00:03:10,170 --> 00:03:15,119
and you're going to<font color="#E5E5E5"> be able to pounce</font>

62
00:03:12,060 --> 00:03:18,329
<font color="#E5E5E5">either in an automated fashion or a more</font>

63
00:03:15,120 --> 00:03:22,530
focused<font color="#E5E5E5"> incident response fashion so</font>

64
00:03:18,329 --> 00:03:24,750
that's<font color="#E5E5E5"> what we like to do and when I'm</font>

65
00:03:22,530 --> 00:03:27,420
not<font color="#CCCCCC"> doing that I teach</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> sans I teach</font>

66
00:03:24,750 --> 00:03:29,730
both five oh four and five five five so

67
00:03:27,420 --> 00:03:32,069
<font color="#E5E5E5">five oh four is the hacker techniques an</font>

68
00:03:29,730 --> 00:03:35,940
incident response class and five five

69
00:03:32,069 --> 00:03:38,429
five<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> tactical sim analytics class</font>

70
00:03:35,940 --> 00:03:41,400
<font color="#E5E5E5">both are a ton of fun</font><font color="#CCCCCC"> and you can follow</font>

71
00:03:38,430 --> 00:03:42,120
me<font color="#CCCCCC"> on Twitter</font><font color="#E5E5E5"> where</font><font color="#CCCCCC"> I'll be ranting and</font>

72
00:03:41,400 --> 00:03:45,569
raving about

73
00:03:42,120 --> 00:03:47,940
<font color="#E5E5E5">who knows what</font><font color="#CCCCCC"> most recently</font><font color="#E5E5E5"> about that</font>

74
00:03:45,569 --> 00:03:49,708
little<font color="#E5E5E5"> tiny grain of</font><font color="#CCCCCC"> rice sized chip</font>

75
00:03:47,940 --> 00:03:54,239
that everybody said oh the sky is

76
00:03:49,709 --> 00:03:56,760
falling<font color="#CCCCCC"> it's not</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> hint hint</font>

77
00:03:54,239 --> 00:04:01,139
you know in in a<font color="#E5E5E5"> couple days like if you</font>

78
00:03:56,760 --> 00:04:03,600
want to buy some micro serve stuff off

79
00:04:01,139 --> 00:04:10,139
of on<font color="#E5E5E5"> ebay you're probably going to get</font>

80
00:04:03,600 --> 00:04:11,940
<font color="#E5E5E5">a really good deal hey guys I'm Josh</font><font color="#CCCCCC"> I</font>

81
00:04:10,139 --> 00:04:13,799
never thought I would get to<font color="#CCCCCC"> present to</font>

82
00:04:11,940 --> 00:04:17,010
a unicorn<font color="#CCCCCC"> so that's really awesome thank</font>

83
00:04:13,799 --> 00:04:19,350
<font color="#E5E5E5">you for that so I'm</font><font color="#CCCCCC"> I'm new</font><font color="#E5E5E5"> to say is I</font>

84
00:04:17,010 --> 00:04:20,940
teach<font color="#CCCCCC"> SEK 530 which is the new</font>

85
00:04:19,350 --> 00:04:24,270
defensible security architecture class

86
00:04:20,940 --> 00:04:27,570
<font color="#E5E5E5">and are any of you guys red teamers in</font>

87
00:04:24,270 --> 00:04:29,609
the room<font color="#CCCCCC"> oh cool quite a few</font>

88
00:04:27,570 --> 00:04:31,920
<font color="#CCCCCC">I hope you</font><font color="#E5E5E5"> leave today just a little</font><font color="#CCCCCC"> bit</font>

89
00:04:29,610 --> 00:04:34,440
upset<font color="#CCCCCC"> and I mean that</font><font color="#E5E5E5"> with as much love</font>

90
00:04:31,920 --> 00:04:36,390
as possible<font color="#CCCCCC"> what I've been</font><font color="#E5E5E5"> doing in my</font>

91
00:04:34,440 --> 00:04:39,240
spare<font color="#CCCCCC"> time is</font><font color="#E5E5E5"> research to</font><font color="#CCCCCC"> make your jobs</font>

92
00:04:36,390 --> 00:04:41,510
as hard as possible<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you guys have</font>

93
00:04:39,240 --> 00:04:44,250
done honestly<font color="#CCCCCC"> a fantastic job with</font>

94
00:04:41,510 --> 00:04:46,710
automation<font color="#E5E5E5"> with PowerShell</font><font color="#CCCCCC"> and I think</font>

95
00:04:44,250 --> 00:04:49,950
red teamers and<font color="#E5E5E5"> adversaries do a great</font>

96
00:04:46,710 --> 00:04:51,510
job<font color="#E5E5E5"> in that post exploitation they're</font>

97
00:04:49,950 --> 00:04:53,820
using the tools that<font color="#E5E5E5"> exist on the system</font>

98
00:04:51,510 --> 00:04:55,860
and they're automating as much of<font color="#E5E5E5"> a tax</font>

99
00:04:53,820 --> 00:04:57,690
as they can and you know post

100
00:04:55,860 --> 00:04:59,940
exploitation<font color="#E5E5E5"> to mix point happens like</font>

101
00:04:57,690 --> 00:05:02,070
that<font color="#CCCCCC"> as defenders what we're trying</font><font color="#E5E5E5"> to</font>

102
00:04:59,940 --> 00:05:05,969
do is build our<font color="#E5E5E5"> toolset to match that</font>

103
00:05:02,070 --> 00:05:07,920
rate of attack and<font color="#E5E5E5"> defense</font><font color="#CCCCCC"> if you guys</font>

104
00:05:05,970 --> 00:05:12,180
want to<font color="#E5E5E5"> follow me</font><font color="#CCCCCC"> on Twitter</font><font color="#E5E5E5"> github</font>

105
00:05:07,920 --> 00:05:14,160
JC Johnson 34<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the tools we'll</font>

106
00:05:12,180 --> 00:05:16,890
talk about aren't really fully developed

107
00:05:14,160 --> 00:05:18,240
yet<font color="#E5E5E5"> we really need your</font><font color="#CCCCCC"> help</font><font color="#E5E5E5"> so please</font>

108
00:05:16,890 --> 00:05:19,620
if you're interested get in touch with

109
00:05:18,240 --> 00:05:27,180
<font color="#CCCCCC">us</font><font color="#E5E5E5"> and we'd love to keep</font><font color="#CCCCCC"> working</font><font color="#E5E5E5"> on</font>

110
00:05:19,620 --> 00:05:31,200
these<font color="#E5E5E5"> tools with you so one thing that I</font>

111
00:05:27,180 --> 00:05:34,170
find really<font color="#CCCCCC"> weird is</font><font color="#E5E5E5"> you have a lot of</font>

112
00:05:31,200 --> 00:05:37,110
red teamers giving talks on how how to

113
00:05:34,170 --> 00:05:40,230
do security<font color="#E5E5E5"> and you hear them say</font>

114
00:05:37,110 --> 00:05:41,850
defending is hard and<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> know the</font>

115
00:05:40,230 --> 00:05:46,760
attackers have the advantage they<font color="#E5E5E5"> only</font>

116
00:05:41,850 --> 00:05:49,530
need one way in and well that's true

117
00:05:46,760 --> 00:05:53,370
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> you know what though defending</font><font color="#CCCCCC"> is a</font>

118
00:05:49,530 --> 00:05:55,859
lot of fun because I am I consider

119
00:05:53,370 --> 00:05:58,170
<font color="#E5E5E5">myself a bit</font><font color="#CCCCCC"> above average</font><font color="#E5E5E5"> as a pen</font>

120
00:05:55,860 --> 00:06:00,600
tester but<font color="#E5E5E5"> I've never encountered</font>

121
00:05:58,170 --> 00:06:05,940
<font color="#CCCCCC">network where I didn't</font><font color="#E5E5E5"> have some way of</font>

122
00:06:00,600 --> 00:06:07,950
<font color="#CCCCCC">getting</font><font color="#E5E5E5"> in attacking is easy</font><font color="#CCCCCC"> defense is</font>

123
00:06:05,940 --> 00:06:10,140
<font color="#E5E5E5">actually really pretty badass if you do</font>

124
00:06:07,950 --> 00:06:12,150
it right and<font color="#CCCCCC"> so what we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be</font>

125
00:06:10,140 --> 00:06:15,780
spending<font color="#E5E5E5"> over</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> next couple</font><font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> is</font>

126
00:06:12,150 --> 00:06:17,520
some of the<font color="#E5E5E5"> late-breaking testing and</font>

127
00:06:15,780 --> 00:06:20,400
ideas that<font color="#E5E5E5"> we've been kicking around</font>

128
00:06:17,520 --> 00:06:22,830
over the past couple<font color="#E5E5E5"> months</font><font color="#CCCCCC"> to make life</font>

129
00:06:20,400 --> 00:06:25,859
really<font color="#E5E5E5"> miserable for pen testers and</font>

130
00:06:22,830 --> 00:06:28,020
attackers alike<font color="#E5E5E5"> now one of the things we</font>

131
00:06:25,860 --> 00:06:31,710
want to<font color="#E5E5E5"> talk about is invoke network</font>

132
00:06:28,020 --> 00:06:34,680
lockdown now<font color="#E5E5E5"> you probably how many</font>

133
00:06:31,710 --> 00:06:36,479
people were at the<font color="#E5E5E5"> keynote where John</font>

134
00:06:34,680 --> 00:06:38,520
strand and<font color="#E5E5E5"> that's go to some hacks for</font>

135
00:06:36,480 --> 00:06:40,890
pancakes<font color="#E5E5E5"> we're all</font><font color="#CCCCCC"> together</font><font color="#E5E5E5"> right when</font>

136
00:06:38,520 --> 00:06:41,390
John said<font color="#E5E5E5"> you need</font><font color="#CCCCCC"> to start using a host</font>

137
00:06:40,890 --> 00:06:43,340
<font color="#CCCCCC">based</font>

138
00:06:41,390 --> 00:06:50,330
<font color="#E5E5E5">our wall there was one person who went</font>

139
00:06:43,340 --> 00:06:54,729
whoa<font color="#CCCCCC"> that was me</font><font color="#E5E5E5"> and the reason why they</font>

140
00:06:50,330 --> 00:06:57,020
work they work<font color="#E5E5E5"> really</font><font color="#CCCCCC"> freaking well</font><font color="#E5E5E5"> and</font>

141
00:06:54,730 --> 00:06:59,450
so what we're going<font color="#E5E5E5"> to do is show you</font>

142
00:06:57,020 --> 00:07:02,979
<font color="#CCCCCC">some</font><font color="#E5E5E5"> interesting things</font><font color="#CCCCCC"> that you can do</font>

143
00:06:59,450 --> 00:07:06,260
that<font color="#E5E5E5"> use the default Windows Firewall</font>

144
00:07:02,980 --> 00:07:09,380
<font color="#E5E5E5">make some very minor tweaks to them and</font>

145
00:07:06,260 --> 00:07:11,570
give you awesome<font color="#E5E5E5"> telemetry in terms of</font>

146
00:07:09,380 --> 00:07:14,990
what the attackers are doing but<font color="#CCCCCC"> also</font>

147
00:07:11,570 --> 00:07:18,500
make it<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that your systems</font><font color="#E5E5E5"> will make</font>

148
00:07:14,990 --> 00:07:21,140
life<font color="#CCCCCC"> just miserable</font><font color="#E5E5E5"> for the bad guys so</font>

149
00:07:18,500 --> 00:07:23,000
one of the things we're going<font color="#CCCCCC"> to talk</font>

150
00:07:21,140 --> 00:07:27,050
<font color="#CCCCCC">about or just</font><font color="#E5E5E5"> the host-based firewalls</font>

151
00:07:23,000 --> 00:07:28,790
<font color="#CCCCCC">that come with</font><font color="#E5E5E5"> Windows now when Windows</font>

152
00:07:27,050 --> 00:07:33,200
Firewall was first<font color="#CCCCCC"> released for</font><font color="#E5E5E5"> Windows</font>

153
00:07:28,790 --> 00:07:35,060
XP<font color="#CCCCCC"> that was a bit of a joke and I you</font>

154
00:07:33,200 --> 00:07:37,940
know I hate to<font color="#E5E5E5"> feel to say it but</font>

155
00:07:35,060 --> 00:07:38,630
Microsoft kind of missed<font color="#E5E5E5"> the ball on</font>

156
00:07:37,940 --> 00:07:41,330
that<font color="#E5E5E5"> one</font>

157
00:07:38,630 --> 00:07:44,300
so the<font color="#E5E5E5"> Windows XP firewall was really</font>

158
00:07:41,330 --> 00:07:47,659
weak<font color="#E5E5E5"> and really bad the cool thing is</font>

159
00:07:44,300 --> 00:07:49,760
though<font color="#E5E5E5"> starting with Vista they rebuilt</font>

160
00:07:47,660 --> 00:07:51,560
<font color="#E5E5E5">the Windows Firewall system and they</font>

161
00:07:49,760 --> 00:07:54,110
<font color="#CCCCCC">added all kinds of cool new features</font>

162
00:07:51,560 --> 00:07:56,690
that XP didn't have such as outbound

163
00:07:54,110 --> 00:07:59,690
filtering which you know<font color="#E5E5E5"> that's kind of</font>

164
00:07:56,690 --> 00:08:03,830
<font color="#E5E5E5">nifty but</font><font color="#CCCCCC"> they also added some other</font>

165
00:07:59,690 --> 00:08:07,040
things that<font color="#CCCCCC"> almost nobody is aware of</font>

166
00:08:03,830 --> 00:08:10,099
I am shocked and a<font color="#CCCCCC"> little embarrassed</font><font color="#E5E5E5"> to</font>

167
00:08:07,040 --> 00:08:14,120
admit that less<font color="#CCCCCC"> than a</font><font color="#E5E5E5"> year ago I didn't</font>

168
00:08:10,100 --> 00:08:17,090
know<font color="#E5E5E5"> that Windows Firewall</font><font color="#CCCCCC"> can actually</font>

169
00:08:14,120 --> 00:08:20,360
instantiate<font color="#E5E5E5"> IPSec communications from</font>

170
00:08:17,090 --> 00:08:22,489
point to<font color="#CCCCCC"> point</font><font color="#E5E5E5"> so it's pretty awesome</font>

171
00:08:20,360 --> 00:08:25,340
<font color="#E5E5E5">when</font><font color="#CCCCCC"> you start using some of these</font>

172
00:08:22,490 --> 00:08:27,980
things in creative ways<font color="#E5E5E5"> so when you have</font>

173
00:08:25,340 --> 00:08:30,409
your<font color="#E5E5E5"> typical networks the attackers</font><font color="#CCCCCC"> you</font>

174
00:08:27,980 --> 00:08:32,210
know they know that<font color="#CCCCCC"> there's unsecure</font>

175
00:08:30,410 --> 00:08:36,140
protocols and machines are chatting<font color="#E5E5E5"> to</font>

176
00:08:32,210 --> 00:08:39,250
one<font color="#E5E5E5"> another in really weak ways</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> no is</font>

177
00:08:36,140 --> 00:08:39,250
that<font color="#E5E5E5"> a nice coming our way</font>

178
00:08:42,760 --> 00:08:48,029
well let's get the<font color="#CCCCCC"> iso acing over with</font>

179
00:08:49,769 --> 00:08:56,199
okay yeah Josh<font color="#CCCCCC"> wizzy</font><font color="#E5E5E5"> so josh</font><font color="#CCCCCC"> is a</font>

180
00:08:54,610 --> 00:08:58,660
first-time presenter here and he was

181
00:08:56,199 --> 00:09:00,609
<font color="#E5E5E5">like oh he's he's only got one somehow</font>

182
00:08:58,660 --> 00:09:11,230
<font color="#E5E5E5">I've dodged a bullet</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> so fast my</font>

183
00:09:00,610 --> 00:09:15,540
friend<font color="#E5E5E5"> no it's so warm it is so warm</font>

184
00:09:11,230 --> 00:09:15,540
<font color="#E5E5E5">yeah you have to</font><font color="#CCCCCC"> do this all right salud</font>

185
00:09:35,620 --> 00:09:42,530
I'm never presenting here again<font color="#CCCCCC"> I want</font>

186
00:09:40,970 --> 00:09:49,160
to know what<font color="#CCCCCC"> that says about me that I</font>

187
00:09:42,530 --> 00:09:53,600
keep<font color="#E5E5E5"> coming</font><font color="#CCCCCC"> back ah all right</font>

188
00:09:49,160 --> 00:09:55,160
<font color="#E5E5E5">so typical networks right there's no</font>

189
00:09:53,600 --> 00:09:58,160
transition<font color="#E5E5E5"> right you just gotta jump</font>

190
00:09:55,160 --> 00:09:59,480
<font color="#E5E5E5">right back in</font><font color="#CCCCCC"> so typical</font><font color="#E5E5E5"> networks the</font>

191
00:09:58,160 --> 00:10:01,310
attackers know that machines are

192
00:09:59,480 --> 00:10:02,660
<font color="#E5E5E5">chatting</font><font color="#CCCCCC"> with one another and that's</font><font color="#E5E5E5"> a</font>

193
00:10:01,310 --> 00:10:05,089
<font color="#E5E5E5">problem because they can</font><font color="#CCCCCC"> hop on the</font>

194
00:10:02,660 --> 00:10:06,350
<font color="#E5E5E5">network and now they're able to start</font>

195
00:10:05,090 --> 00:10:10,370
<font color="#CCCCCC">doing all kinds of fun and interesting</font>

196
00:10:06,350 --> 00:10:12,050
stuff on on the network and<font color="#CCCCCC"> you know</font>

197
00:10:10,370 --> 00:10:13,760
right away<font color="#E5E5E5"> they start</font><font color="#CCCCCC"> attacking other</font>

198
00:10:12,050 --> 00:10:17,030
machines and they start doing<font color="#E5E5E5"> all these</font>

199
00:10:13,760 --> 00:10:19,550
<font color="#E5E5E5">leet hacks</font><font color="#CCCCCC"> all kinds of</font><font color="#E5E5E5"> cool stuff</font><font color="#CCCCCC"> to</font>

200
00:10:17,030 --> 00:10:22,579
compromise your networks<font color="#E5E5E5"> and doing all</font>

201
00:10:19,550 --> 00:10:24,319
<font color="#CCCCCC">sorts of</font><font color="#E5E5E5"> things like</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> honing</font>

202
00:10:22,580 --> 00:10:27,740
your machines and<font color="#E5E5E5"> all they're</font><font color="#CCCCCC"> doing is</font>

203
00:10:24,320 --> 00:10:30,200
stuff like<font color="#E5E5E5"> PS exact right how many</font>

204
00:10:27,740 --> 00:10:31,940
<font color="#CCCCCC">people here</font><font color="#E5E5E5"> have run PS exec in your</font>

205
00:10:30,200 --> 00:10:34,430
networks or at home or<font color="#CCCCCC"> something like</font>

206
00:10:31,940 --> 00:10:35,690
<font color="#E5E5E5">that</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> keep your</font><font color="#CCCCCC"> hand</font><font color="#E5E5E5"> up if you felt</font>

207
00:10:34,430 --> 00:10:39,500
that<font color="#CCCCCC"> that was a little</font><font color="#E5E5E5"> disappointing</font><font color="#CCCCCC"> ly</font>

208
00:10:35,690 --> 00:10:41,620
easy<font color="#E5E5E5"> right yeah so here's the deal</font>

209
00:10:39,500 --> 00:10:45,890
you want to know how to stop<font color="#E5E5E5"> that</font>

210
00:10:41,620 --> 00:10:48,830
Windows Firewall<font color="#E5E5E5"> you can't hack what you</font>

211
00:10:45,890 --> 00:10:52,220
can't<font color="#E5E5E5"> interact with so when you have a</font>

212
00:10:48,830 --> 00:10:56,480
Windows host firewall all of a sudden PS

213
00:10:52,220 --> 00:10:59,350
exec no bueno<font color="#CCCCCC"> because it can't interact</font>

214
00:10:56,480 --> 00:11:02,930
<font color="#CCCCCC">now a lot of</font><font color="#E5E5E5"> organizations</font><font color="#CCCCCC"> say put Nick</font>

215
00:10:59,350 --> 00:11:06,050
<font color="#E5E5E5">how do we do this we can't put hosts</font>

216
00:11:02,930 --> 00:11:08,270
firewalls everywhere<font color="#E5E5E5"> yeah you can</font>

217
00:11:06,050 --> 00:11:13,250
<font color="#E5E5E5">windows firewalls can be pushed out via</font>

218
00:11:08,270 --> 00:11:16,699
GPO and<font color="#E5E5E5"> the other cool bit is when do</font>

219
00:11:13,250 --> 00:11:19,820
you have workstations chatting to one

220
00:11:16,700 --> 00:11:21,830
<font color="#E5E5E5">another over four four five workstation</font>

221
00:11:19,820 --> 00:11:25,010
<font color="#E5E5E5">to workstation traffic is one of the</font>

222
00:11:21,830 --> 00:11:28,340
best and easiest detects that<font color="#E5E5E5"> you can do</font>

223
00:11:25,010 --> 00:11:29,930
please please please write that<font color="#CCCCCC"> down add</font>

224
00:11:28,340 --> 00:11:32,810
that<font color="#E5E5E5"> to your homework for when you go to</font>

225
00:11:29,930 --> 00:11:34,880
your day job on Monday<font color="#CCCCCC"> Adrian I would</font>

226
00:11:32,810 --> 00:11:37,400
really<font color="#CCCCCC"> appreciate it if you exercised</font>

227
00:11:34,880 --> 00:11:39,500
that from the presentation because I

228
00:11:37,400 --> 00:11:42,610
charge<font color="#E5E5E5"> four</font><font color="#CCCCCC"> hundred and fifty</font><font color="#E5E5E5"> dollars an</font>

229
00:11:39,500 --> 00:11:45,279
hour to<font color="#E5E5E5"> give that and detect</font>

230
00:11:42,610 --> 00:11:47,200
so with the<font color="#E5E5E5"> windows firewall</font><font color="#CCCCCC"> all of a</font>

231
00:11:45,279 --> 00:11:49,959
<font color="#CCCCCC">sudden you</font><font color="#E5E5E5"> stop that attack dead and</font>

232
00:11:47,200 --> 00:11:54,070
it's awesome<font color="#CCCCCC"> and what's even better is</font>

233
00:11:49,959 --> 00:11:57,010
<font color="#E5E5E5">Windows Firewall</font><font color="#CCCCCC"> has logging what you</font>

234
00:11:54,070 --> 00:12:00,010
can do is log potential connection

235
00:11:57,010 --> 00:12:02,920
attempts to ports<font color="#E5E5E5"> and use that as a</font>

236
00:12:00,010 --> 00:12:06,819
honey<font color="#E5E5E5"> port one of my favorite things to</font>

237
00:12:02,920 --> 00:12:10,750
<font color="#E5E5E5">do is to</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> periodically</font><font color="#CCCCCC"> look through</font>

238
00:12:06,820 --> 00:12:14,640
the<font color="#E5E5E5"> nmap top</font><font color="#CCCCCC"> 1000 ports</font><font color="#E5E5E5"> and then use</font>

239
00:12:10,750 --> 00:12:17,140
that<font color="#E5E5E5"> as some honey ports</font><font color="#CCCCCC"> what I'll do I</font>

240
00:12:14,640 --> 00:12:22,839
will excuse me<font color="#E5E5E5"> that's some</font><font color="#CCCCCC"> II's coming</font>

241
00:12:17,140 --> 00:12:29,649
up not good I just<font color="#E5E5E5"> had to share misery</font>

242
00:12:22,839 --> 00:12:32,950
<font color="#E5E5E5">loves company</font><font color="#CCCCCC"> so what you can do is have</font>

243
00:12:29,649 --> 00:12:37,000
logging on a blocked port<font color="#E5E5E5"> I want to be</font>

244
00:12:32,950 --> 00:12:38,620
very<font color="#E5E5E5"> clear</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> this block port</font><font color="#CCCCCC"> a lot</font>

245
00:12:37,000 --> 00:12:39,970
<font color="#E5E5E5">of times they go to organizations</font><font color="#CCCCCC"> and I</font>

246
00:12:38,620 --> 00:12:43,600
say hey guys we're gonna set up honey

247
00:12:39,970 --> 00:12:46,000
ports in<font color="#E5E5E5"> the gum mmm</font><font color="#CCCCCC"> hackers gonna get</font>

248
00:12:43,600 --> 00:12:49,300
into<font color="#E5E5E5"> that honey port you know what honey</font>

249
00:12:46,000 --> 00:12:52,410
ports not even running anybody who just

250
00:12:49,300 --> 00:12:55,630
even tries to connect to the honey port

251
00:12:52,410 --> 00:12:57,969
busted so that's what you need to<font color="#CCCCCC"> start</font>

252
00:12:55,630 --> 00:12:59,439
<font color="#CCCCCC">doing</font><font color="#E5E5E5"> just twist in the tools that you</font>

253
00:12:57,970 --> 00:13:00,490
have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit differently and you're</font>

254
00:12:59,440 --> 00:13:03,100
going to start<font color="#CCCCCC"> seeing some pretty</font>

255
00:13:00,490 --> 00:13:05,320
<font color="#E5E5E5">magical things pretty quickly</font><font color="#CCCCCC"> so once</font>

256
00:13:03,100 --> 00:13:09,100
they're busted bad<font color="#CCCCCC"> guys game plan is</font>

257
00:13:05,320 --> 00:13:10,990
<font color="#E5E5E5">flipped on on its ear and they're so</font>

258
00:13:09,100 --> 00:13:12,190
<font color="#E5E5E5">used to the same old same old that</font>

259
00:13:10,990 --> 00:13:13,779
they're not<font color="#E5E5E5"> going to know what to do</font>

260
00:13:12,190 --> 00:13:15,490
you're<font color="#E5E5E5"> going to be pushing them off</font>

261
00:13:13,779 --> 00:13:17,709
their normal stride which makes<font color="#E5E5E5"> your</font>

262
00:13:15,490 --> 00:13:18,899
other detects easier<font color="#CCCCCC"> because they're</font>

263
00:13:17,709 --> 00:13:23,260
making<font color="#CCCCCC"> mistakes</font>

264
00:13:18,899 --> 00:13:29,320
so my Kali Linux VM<font color="#E5E5E5"> is dead I want</font><font color="#CCCCCC"> to</font>

265
00:13:23,260 --> 00:13:36,250
<font color="#E5E5E5">double check on that but</font><font color="#CCCCCC"> we mean we may</font>

266
00:13:29,320 --> 00:13:38,740
be out I had a VM fail yep the<font color="#E5E5E5"> NIC is</font>

267
00:13:36,250 --> 00:13:40,660
dead<font color="#E5E5E5"> so we're just gonna kill that sorry</font>

268
00:13:38,740 --> 00:13:44,440
<font color="#CCCCCC">what I'll do</font><font color="#E5E5E5"> is I'll do a webinar where</font>

269
00:13:40,660 --> 00:13:48,360
<font color="#E5E5E5">I show how that works</font><font color="#CCCCCC"> but basically what</font>

270
00:13:44,440 --> 00:13:50,649
<font color="#CCCCCC">you can do with in Windows Firewall</font>

271
00:13:48,360 --> 00:13:53,790
<font color="#CCCCCC">let's let's do it this a slightly</font>

272
00:13:50,649 --> 00:13:53,790
<font color="#CCCCCC">different</font><font color="#E5E5E5"> approach</font>

273
00:13:57,189 --> 00:14:01,748
if<font color="#E5E5E5"> you're in your windows control panel</font>

274
00:13:59,769 --> 00:14:04,990
<font color="#CCCCCC">and you</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> into the windows firewall</font>

275
00:14:01,749 --> 00:14:09,399
<font color="#E5E5E5">defender and go under advanced settings</font>

276
00:14:04,990 --> 00:14:13,749
right<font color="#E5E5E5"> here you can actually create IPSec</font>

277
00:14:09,399 --> 00:14:17,170
<font color="#CCCCCC">rules</font><font color="#E5E5E5"> and there's a connection security</font>

278
00:14:13,749 --> 00:14:20,379
rules<font color="#E5E5E5"> and what you can do here is</font>

279
00:14:17,170 --> 00:14:24,069
<font color="#E5E5E5">actually set it up so</font><font color="#CCCCCC"> that you have</font><font color="#E5E5E5"> IP</font>

280
00:14:20,379 --> 00:14:26,920
SEC instantiate<font color="#CCCCCC"> it between two different</font>

281
00:14:24,069 --> 00:14:31,540
hosts or even host ranges and<font color="#CCCCCC"> the</font>

282
00:14:26,920 --> 00:14:34,660
beautiful part<font color="#CCCCCC"> about this is it</font><font color="#E5E5E5"> doesn't</font>

283
00:14:31,540 --> 00:14:36,490
matter what<font color="#CCCCCC"> the protocol is I actually</font>

284
00:14:34,660 --> 00:14:39,309
have some<font color="#CCCCCC"> clients that</font><font color="#E5E5E5"> work in the</font>

285
00:14:36,490 --> 00:14:41,769
industrial control supply<font color="#E5E5E5"> or industrial</font>

286
00:14:39,309 --> 00:14:44,949
<font color="#E5E5E5">ICS the</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> raise your hand if you're</font>

287
00:14:41,769 --> 00:14:47,050
in the ICS or energy distribution<font color="#E5E5E5"> yep so</font>

288
00:14:44,949 --> 00:14:49,180
<font color="#E5E5E5">you guys got some pretty</font><font color="#CCCCCC"> freaky networks</font>

289
00:14:47,050 --> 00:14:50,410
<font color="#E5E5E5">stuff like Modbus I even know some</font>

290
00:14:49,180 --> 00:14:53,019
production systems that are still

291
00:14:50,410 --> 00:14:56,759
running<font color="#E5E5E5"> telnet you know what's cool</font>

292
00:14:53,019 --> 00:14:59,980
<font color="#CCCCCC">about that</font><font color="#E5E5E5"> put IPSec tunneling around it</font>

293
00:14:56,759 --> 00:15:02,769
nobody<font color="#E5E5E5"> can see your login information</font>

294
00:14:59,980 --> 00:15:07,110
so IPSec all the things now let me show

295
00:15:02,769 --> 00:15:07,110
you<font color="#CCCCCC"> just how</font><font color="#E5E5E5"> easy it is to enable IPSec</font>

296
00:15:23,710 --> 00:15:35,540
<font color="#CCCCCC">okay so we got to get</font><font color="#E5E5E5"> into our</font>

297
00:15:26,450 --> 00:15:39,410
<font color="#E5E5E5">PowerShell execution bypass mode and now</font>

298
00:15:35,540 --> 00:15:44,150
we're going to<font color="#E5E5E5"> go ahead and invoke</font>

299
00:15:39,410 --> 00:15:46,339
<font color="#CCCCCC">Network lockdown and now the IPSec rules</font>

300
00:15:44,150 --> 00:15:49,850
are enabled<font color="#E5E5E5"> and the cool</font><font color="#CCCCCC"> thing is now</font>

301
00:15:46,340 --> 00:15:52,360
when we hop<font color="#CCCCCC"> over to</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> and do</font>

302
00:15:49,850 --> 00:15:52,360
likewise

303
00:16:19,700 --> 00:16:29,550
<font color="#CCCCCC">okay so now I'm on</font><font color="#E5E5E5"> my host I have</font><font color="#CCCCCC"> to</font>

304
00:16:22,770 --> 00:16:31,100
<font color="#CCCCCC">enable</font><font color="#E5E5E5"> the same setting okay now we've</font>

305
00:16:29,550 --> 00:16:35,339
got<font color="#E5E5E5"> IPSec rules</font>

306
00:16:31,100 --> 00:16:36,230
<font color="#E5E5E5">running on both</font><font color="#CCCCCC"> hosts now let's see if</font>

307
00:16:35,339 --> 00:16:40,080
<font color="#E5E5E5">this works</font>

308
00:16:36,230 --> 00:16:41,730
we'll find out<font color="#E5E5E5"> what you can do is</font>

309
00:16:40,080 --> 00:16:44,070
<font color="#E5E5E5">everything should just</font><font color="#CCCCCC"> work as normal</font>

310
00:16:41,730 --> 00:16:52,130
<font color="#E5E5E5">here when we bring this up to the top so</font>

311
00:16:44,070 --> 00:16:52,130
<font color="#CCCCCC">net net use</font>

312
00:17:07,510 --> 00:17:14,839
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right so now I was able to do a net</font>

313
00:17:11,299 --> 00:17:17,150
use right<font color="#E5E5E5"> did that look any different</font><font color="#CCCCCC"> no</font>

314
00:17:14,839 --> 00:17:20,480
you know why<font color="#CCCCCC"> cuz Windows Firewall took</font>

315
00:17:17,150 --> 00:17:23,419
care of<font color="#E5E5E5"> all the crypto for</font><font color="#CCCCCC"> us if I had</font>

316
00:17:20,480 --> 00:17:26,329
my<font color="#E5E5E5"> Kali Linux box sitting up here and</font>

317
00:17:23,419 --> 00:17:28,760
working what I would do is<font color="#E5E5E5"> point to the</font>

318
00:17:26,329 --> 00:17:32,360
Kali Linux box<font color="#E5E5E5"> and it wouldn't be able</font>

319
00:17:28,760 --> 00:17:35,390
<font color="#E5E5E5">to instantiate why because that</font><font color="#CCCCCC"> Cali</font><font color="#E5E5E5"> box</font>

320
00:17:32,360 --> 00:17:37,000
<font color="#E5E5E5">could not do the authentication against</font>

321
00:17:35,390 --> 00:17:40,840
those<font color="#E5E5E5"> ports opening up</font>

322
00:17:37,000 --> 00:17:43,190
it kills<font color="#CCCCCC"> man-in-the-middle</font><font color="#E5E5E5"> dead</font>

323
00:17:40,840 --> 00:17:45,139
<font color="#E5E5E5">completely</font><font color="#CCCCCC"> dead and I don't</font><font color="#E5E5E5"> care what</font>

324
00:17:43,190 --> 00:17:47,470
<font color="#E5E5E5">kind of man in the middle</font><font color="#CCCCCC"> there doing</font>

325
00:17:45,140 --> 00:17:50,480
ARP cache poisoning DNS poisoning

326
00:17:47,470 --> 00:17:53,600
<font color="#CCCCCC">whatever kills it</font><font color="#E5E5E5"> dead</font>

327
00:17:50,480 --> 00:17:56,919
deploy it<font color="#CCCCCC"> oh and</font><font color="#E5E5E5"> by the way it can</font><font color="#CCCCCC"> be</font>

328
00:17:53,600 --> 00:18:00,740
pushed<font color="#E5E5E5"> out via GPO you can put</font><font color="#CCCCCC"> user</font>

329
00:17:56,919 --> 00:18:02,450
<font color="#CCCCCC">specific firewall rules so your users</font>

330
00:18:00,740 --> 00:18:04,280
can<font color="#CCCCCC"> only go to sites and parts of</font><font color="#E5E5E5"> the</font>

331
00:18:02,450 --> 00:18:06,470
network<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they're allowed</font><font color="#CCCCCC"> to go to so</font>

332
00:18:04,280 --> 00:18:08,418
this<font color="#E5E5E5"> is amazing stuff</font><font color="#CCCCCC"> over the next</font>

333
00:18:06,470 --> 00:18:09,799
couple<font color="#CCCCCC"> weeks and months Josh and I are</font>

334
00:18:08,419 --> 00:18:12,650
going to be giving you<font color="#CCCCCC"> guys plenty of</font>

335
00:18:09,799 --> 00:18:16,370
cool resources<font color="#E5E5E5"> on how to do this super</font>

336
00:18:12,650 --> 00:18:21,260
<font color="#CCCCCC">easy believe it</font><font color="#E5E5E5"> or not that command as</font>

337
00:18:16,370 --> 00:18:24,678
easy as<font color="#CCCCCC"> that was to run this this</font><font color="#E5E5E5"> invoke</font>

338
00:18:21,260 --> 00:18:27,230
<font color="#E5E5E5">network lockdown that's actually</font><font color="#CCCCCC"> the</font>

339
00:18:24,679 --> 00:18:29,330
hard way<font color="#E5E5E5"> normally it's going to be</font>

340
00:18:27,230 --> 00:18:31,400
something<font color="#E5E5E5"> that happens at boot time so</font>

341
00:18:29,330 --> 00:18:40,549
you're gonna have fun we're going<font color="#E5E5E5"> to</font>

342
00:18:31,400 --> 00:18:42,559
make secure easy<font color="#E5E5E5"> all right so one thing</font>

343
00:18:40,549 --> 00:18:44,780
that<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of people I've</font><font color="#CCCCCC"> been doing</font>

344
00:18:42,559 --> 00:18:46,520
InfoSec for quite some<font color="#CCCCCC"> time</font><font color="#E5E5E5"> and one of</font>

345
00:18:44,780 --> 00:18:48,860
<font color="#CCCCCC">the things that I</font><font color="#E5E5E5"> find really</font>

346
00:18:46,520 --> 00:18:50,750
problematic<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that people say but Mik</font>

347
00:18:48,860 --> 00:18:52,309
<font color="#CCCCCC">if we start putting</font><font color="#E5E5E5"> in host-based</font>

348
00:18:50,750 --> 00:18:53,900
firewall rules we're gonna break

349
00:18:52,309 --> 00:18:55,280
everything<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the line of business is</font>

350
00:18:53,900 --> 00:18:56,150
<font color="#E5E5E5">going to be super angry and we're gonna</font>

351
00:18:55,280 --> 00:18:59,690
be out of a job

352
00:18:56,150 --> 00:19:02,240
<font color="#E5E5E5">no have some</font><font color="#CCCCCC"> faith</font><font color="#E5E5E5"> what we're gonna do</font>

353
00:18:59,690 --> 00:19:05,570
for you is<font color="#CCCCCC"> we've got this cool tool that</font>

354
00:19:02,240 --> 00:19:08,360
Josh made<font color="#E5E5E5"> that turns your NIC</font><font color="#CCCCCC"> into learn</font>

355
00:19:05,570 --> 00:19:11,120
mode and it<font color="#E5E5E5"> will log the network</font>

356
00:19:08,360 --> 00:19:13,879
connections that happen and the magic of

357
00:19:11,120 --> 00:19:14,449
this<font color="#E5E5E5"> is that literally you don't need a</font>

358
00:19:13,880 --> 00:19:16,130
sim

359
00:19:14,450 --> 00:19:18,380
you don't need<font color="#CCCCCC"> net flow you</font><font color="#E5E5E5"> don't need</font>

360
00:19:16,130 --> 00:19:21,320
nothing<font color="#CCCCCC"> other than this script to run</font>

361
00:19:18,380 --> 00:19:23,540
and then when it's run you had now have

362
00:19:21,320 --> 00:19:25,610
a log of<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the connections that took</font>

363
00:19:23,540 --> 00:19:28,430
place<font color="#E5E5E5"> for how long that systems been</font>

364
00:19:25,610 --> 00:19:32,770
<font color="#E5E5E5">going and here's the beauty of it</font>

365
00:19:28,430 --> 00:19:35,120
anything<font color="#CCCCCC"> that gets set up you can just</font>

366
00:19:32,770 --> 00:19:36,770
<font color="#E5E5E5">automatically whitelist and then over</font>

367
00:19:35,120 --> 00:19:39,949
time come<font color="#CCCCCC"> back and clean up</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> little</font>

368
00:19:36,770 --> 00:19:42,830
stragglers<font color="#E5E5E5"> so you know what the magic is</font>

369
00:19:39,950 --> 00:19:45,590
<font color="#CCCCCC">I have now</font><font color="#E5E5E5"> four times in my</font><font color="#CCCCCC"> career</font>

370
00:19:42,830 --> 00:19:48,679
<font color="#E5E5E5">deployed similar concept except we used</font>

371
00:19:45,590 --> 00:19:51,169
a<font color="#E5E5E5"> sim we were trying to be fancy</font><font color="#CCCCCC"> I did</font>

372
00:19:48,680 --> 00:19:55,160
this<font color="#E5E5E5"> you know how many users notice that</font>

373
00:19:51,170 --> 00:19:57,860
we did that goose egg<font color="#E5E5E5"> not a single</font>

374
00:19:55,160 --> 00:20:00,080
complaint<font color="#E5E5E5"> not a single ticket</font><font color="#CCCCCC"> because if</font>

375
00:19:57,860 --> 00:20:02,300
there was any<font color="#E5E5E5"> traffic over you know</font>

376
00:20:00,080 --> 00:20:04,129
three months<font color="#E5E5E5"> one month six month</font>

377
00:20:02,300 --> 00:20:06,110
<font color="#E5E5E5">whatever the time window was we just</font>

378
00:20:04,130 --> 00:20:07,820
<font color="#E5E5E5">wait-listed it and allowed it to go</font><font color="#CCCCCC"> on</font>

379
00:20:06,110 --> 00:20:11,120
and then every week we<font color="#E5E5E5"> went back and</font>

380
00:20:07,820 --> 00:20:13,850
<font color="#E5E5E5">culled that list</font><font color="#CCCCCC"> now here's the magic of</font>

381
00:20:11,120 --> 00:20:16,340
this we<font color="#E5E5E5"> also have a helper</font><font color="#CCCCCC"> script that</font>

382
00:20:13,850 --> 00:20:19,689
will call these firewall logs<font color="#E5E5E5"> and help</font>

383
00:20:16,340 --> 00:20:21,080
set up the IPSec tunnels for you so now

384
00:20:19,690 --> 00:20:24,740
<font color="#CCCCCC">giddyup</font>

385
00:20:21,080 --> 00:20:27,080
a lot<font color="#E5E5E5"> of people complain</font><font color="#CCCCCC"> Mik these logs</font>

386
00:20:24,740 --> 00:20:29,210
are long yeah they are<font color="#E5E5E5"> you know what</font>

387
00:20:27,080 --> 00:20:31,300
you're not<font color="#E5E5E5"> reading them the scripts are</font>

388
00:20:29,210 --> 00:20:34,450
let them do<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> work</font>

389
00:20:31,300 --> 00:20:37,760
so trying to<font color="#E5E5E5"> send me an exploit nope</font>

390
00:20:34,450 --> 00:20:40,580
it's just<font color="#CCCCCC"> that simple</font><font color="#E5E5E5"> folks you can't</font>

391
00:20:37,760 --> 00:20:42,500
hack what you can't interact with now

392
00:20:40,580 --> 00:20:44,300
<font color="#CCCCCC">man-in-the-middle is a really big</font>

393
00:20:42,500 --> 00:20:47,450
<font color="#E5E5E5">problem in our industry that</font><font color="#CCCCCC"> we got to</font>

394
00:20:44,300 --> 00:20:50,110
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> and there are tons of</font>

395
00:20:47,450 --> 00:20:53,750
insecure protocols<font color="#CCCCCC"> and again</font>

396
00:20:50,110 --> 00:20:55,520
<font color="#E5E5E5">unfortunately the</font><font color="#CCCCCC"> Kali</font><font color="#E5E5E5"> box died but I</font>

397
00:20:53,750 --> 00:20:58,490
would be able<font color="#E5E5E5"> to show you how it</font><font color="#CCCCCC"> looks</font>

398
00:20:55,520 --> 00:21:00,740
when you set<font color="#CCCCCC"> up a relay setting up a</font>

399
00:20:58,490 --> 00:21:03,230
relay literally is a one-liner and you

400
00:21:00,740 --> 00:21:06,500
can just start listening<font color="#CCCCCC"> in on the</font>

401
00:21:03,230 --> 00:21:09,590
traffic<font color="#E5E5E5"> so man-in-the-middle simple easy</font>

402
00:21:06,500 --> 00:21:12,530
<font color="#CCCCCC">just</font><font color="#E5E5E5"> say</font><font color="#CCCCCC"> no to it do IPSec tunneling and</font>

403
00:21:09,590 --> 00:21:15,949
the bad guys can't do<font color="#CCCCCC"> anything about</font><font color="#E5E5E5"> it</font>

404
00:21:12,530 --> 00:21:20,480
so remember learn mode IPSec<font color="#E5E5E5"> tunneling</font>

405
00:21:15,950 --> 00:21:23,600
for you and the works<font color="#E5E5E5"> already</font><font color="#CCCCCC"> done my</font>

406
00:21:20,480 --> 00:21:26,800
goal and Josh's goal is by this time

407
00:21:23,600 --> 00:21:29,689
<font color="#E5E5E5">next year</font><font color="#CCCCCC"> there's going to</font><font color="#E5E5E5"> be way more</font>

408
00:21:26,800 --> 00:21:30,659
IPSec networking going<font color="#E5E5E5"> on in Windows</font>

409
00:21:29,690 --> 00:21:33,870
environments

410
00:21:30,660 --> 00:21:36,680
the cool thing<font color="#CCCCCC"> about it</font><font color="#E5E5E5"> is as I</font><font color="#CCCCCC"> just</font>

411
00:21:33,870 --> 00:21:40,169
showed<font color="#CCCCCC"> you with that net use command</font>

412
00:21:36,680 --> 00:21:42,870
<font color="#E5E5E5">completely transparent to the user</font><font color="#CCCCCC"> you</font>

413
00:21:40,170 --> 00:21:45,390
know<font color="#E5E5E5"> it's not transparent to the</font>

414
00:21:42,870 --> 00:21:48,600
attackers<font color="#E5E5E5"> because all they see is random</font>

415
00:21:45,390 --> 00:21:49,740
gibberish if that<font color="#E5E5E5"> a lot of times they're</font>

416
00:21:48,600 --> 00:21:51,570
not<font color="#E5E5E5"> even going to be able to instantiate</font>

417
00:21:49,740 --> 00:21:55,800
the man in the middle<font color="#E5E5E5"> so this is awesome</font>

418
00:21:51,570 --> 00:21:57,689
<font color="#CCCCCC">when again you can't get man in the</font>

419
00:21:55,800 --> 00:22:01,350
<font color="#E5E5E5">middle attack if attackers can't send</font>

420
00:21:57,690 --> 00:22:02,460
packets so with that<font color="#E5E5E5"> when I kick it over</font>

421
00:22:01,350 --> 00:22:09,540
to<font color="#E5E5E5"> Josh and</font><font color="#CCCCCC"> he's</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to talk about</font>

422
00:22:02,460 --> 00:22:13,260
<font color="#CCCCCC">Paul's process was anyone here during</font>

423
00:22:09,540 --> 00:22:15,420
<font color="#E5E5E5">mix talk on pause process last year cool</font>

424
00:22:13,260 --> 00:22:18,000
<font color="#CCCCCC">so that that inspired me to</font><font color="#E5E5E5"> start</font><font color="#CCCCCC"> using</font>

425
00:22:15,420 --> 00:22:19,800
this tool so what pause process is<font color="#CCCCCC"> Nick</font>

426
00:22:18,000 --> 00:22:22,920
wrote<font color="#E5E5E5"> this tool and what it does is it</font>

427
00:22:19,800 --> 00:22:25,350
allows<font color="#CCCCCC"> you to attach a</font><font color="#E5E5E5"> built-in windows</font>

428
00:22:22,920 --> 00:22:28,170
debugger to a<font color="#E5E5E5"> running process and when</font>

429
00:22:25,350 --> 00:22:30,330
you do<font color="#E5E5E5"> that the process execution is</font>

430
00:22:28,170 --> 00:22:32,250
<font color="#CCCCCC">just completely halted</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the debugger</font>

431
00:22:30,330 --> 00:22:35,189
<font color="#CCCCCC">has full control</font><font color="#E5E5E5"> if it's a shell that an</font>

432
00:22:32,250 --> 00:22:36,480
attacker has it's completely useless to

433
00:22:35,190 --> 00:22:38,730
<font color="#E5E5E5">them at</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> point they can't interact</font>

434
00:22:36,480 --> 00:22:41,700
with<font color="#E5E5E5"> it they can't do anything until</font><font color="#CCCCCC"> we</font>

435
00:22:38,730 --> 00:22:43,770
unpause that process<font color="#E5E5E5"> so when I first saw</font>

436
00:22:41,700 --> 00:22:47,160
pause process<font color="#E5E5E5"> it inspired me</font><font color="#CCCCCC"> to write a</font>

437
00:22:43,770 --> 00:22:49,350
tool<font color="#CCCCCC"> and it was kind of a weird use case</font>

438
00:22:47,160 --> 00:22:51,980
<font color="#E5E5E5">make</font><font color="#CCCCCC"> Nick was kind of surprised by this</font>

439
00:22:49,350 --> 00:22:54,990
but what<font color="#E5E5E5"> we did was</font><font color="#CCCCCC"> we wrote a tool and</font>

440
00:22:51,980 --> 00:22:56,970
it watched<font color="#E5E5E5"> process invocation and</font>

441
00:22:54,990 --> 00:22:59,850
whenever<font color="#E5E5E5"> a new process</font><font color="#CCCCCC"> processes were</font>

442
00:22:56,970 --> 00:23:01,830
created<font color="#CCCCCC"> if the process was Internet</font>

443
00:22:59,850 --> 00:23:04,020
Explorer<font color="#E5E5E5"> it went and looked at what the</font>

444
00:23:01,830 --> 00:23:06,870
parent<font color="#CCCCCC"> process was and if</font><font color="#E5E5E5"> the parent</font>

445
00:23:04,020 --> 00:23:09,000
<font color="#CCCCCC">process was out looked at exe it that</font>

446
00:23:06,870 --> 00:23:11,250
means that we know that the user has

447
00:23:09,000 --> 00:23:13,320
clicked a link<font color="#E5E5E5"> in an email</font><font color="#CCCCCC"> outlook has</font>

448
00:23:11,250 --> 00:23:15,780
spawned<font color="#E5E5E5"> a child process</font><font color="#CCCCCC"> of Internet</font>

449
00:23:13,320 --> 00:23:18,300
Explorer<font color="#E5E5E5"> so what I</font><font color="#CCCCCC"> did was I wrote this</font>

450
00:23:15,780 --> 00:23:20,639
tool and it it scraped out the command

451
00:23:18,300 --> 00:23:23,159
line of the<font color="#E5E5E5"> Internet Explorer process</font>

452
00:23:20,640 --> 00:23:25,410
invocation<font color="#CCCCCC"> and what that allowed us to</font>

453
00:23:23,160 --> 00:23:27,600
do<font color="#E5E5E5"> was pop up a</font><font color="#CCCCCC"> message to the user so</font>

454
00:23:25,410 --> 00:23:30,090
we'd pause Internet Explorer<font color="#E5E5E5"> we'd pop a</font>

455
00:23:27,600 --> 00:23:32,540
message to the user<font color="#E5E5E5"> and</font><font color="#CCCCCC"> say hey this is</font>

456
00:23:30,090 --> 00:23:35,639
<font color="#E5E5E5">the URL that you're actually going to</font>

457
00:23:32,540 --> 00:23:38,040
did you mean to go here and if it's a

458
00:23:35,640 --> 00:23:40,110
phishing email<font color="#E5E5E5"> the</font><font color="#CCCCCC"> user's like blah blah</font>

459
00:23:38,040 --> 00:23:44,129
blah<font color="#CCCCCC"> are you</font><font color="#E5E5E5"> know I thought I was going</font>

460
00:23:40,110 --> 00:23:44,490
to Amazon<font color="#E5E5E5"> and sure enough we saw quite</font><font color="#CCCCCC"> a</font>

461
00:23:44,130 --> 00:23:46,650
bit of

462
00:23:44,490 --> 00:23:48,179
impact here with users just<font color="#E5E5E5"> not getting</font>

463
00:23:46,650 --> 00:23:51,000
fished anymore because<font color="#E5E5E5"> now they're</font><font color="#CCCCCC"> able</font>

464
00:23:48,179 --> 00:23:52,920
<font color="#CCCCCC">to get</font><font color="#E5E5E5"> just a second</font><font color="#CCCCCC"> chance</font><font color="#E5E5E5"> and and</font>

465
00:23:51,000 --> 00:23:55,380
again<font color="#E5E5E5"> we put it we put some other</font><font color="#CCCCCC"> logic</font>

466
00:23:52,920 --> 00:23:57,780
in there<font color="#E5E5E5"> so that we call a Google Safe</font>

467
00:23:55,380 --> 00:23:59,610
Browsing API at the same time<font color="#CCCCCC"> check to</font>

468
00:23:57,780 --> 00:24:02,040
<font color="#CCCCCC">see</font><font color="#E5E5E5"> if the sites of malicious block it</font>

469
00:23:59,610 --> 00:24:05,370
<font color="#CCCCCC">completely if</font><font color="#E5E5E5"> it is but we just gave the</font>

470
00:24:02,040 --> 00:24:07,139
user another chance<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that</font>

471
00:24:05,370 --> 00:24:09,570
<font color="#E5E5E5">conversation with Nick and I spawned</font>

472
00:24:07,140 --> 00:24:11,309
some more conversation and we we're

473
00:24:09,570 --> 00:24:13,860
coming out<font color="#CCCCCC"> with this idea that's it's</font>

474
00:24:11,309 --> 00:24:15,990
almost<font color="#E5E5E5"> like</font><font color="#CCCCCC"> EDR but it gives us the</font>

475
00:24:13,860 --> 00:24:19,620
ability<font color="#E5E5E5"> to natively just using</font>

476
00:24:15,990 --> 00:24:20,820
<font color="#E5E5E5">PowerShell pause processes</font><font color="#CCCCCC"> on-demand so</font>

477
00:24:19,620 --> 00:24:23,159
if you<font color="#E5E5E5"> think</font><font color="#CCCCCC"> about it when you look</font><font color="#E5E5E5"> at</font>

478
00:24:20,820 --> 00:24:26,639
processes on a<font color="#E5E5E5"> Windows system you'll see</font>

479
00:24:23,160 --> 00:24:29,070
things like<font color="#CCCCCC"> this</font><font color="#E5E5E5"> and you'll see notepad</font>

480
00:24:26,640 --> 00:24:33,230
and is that normal maybe

481
00:24:29,070 --> 00:24:36,240
well what if notepad is running a system

482
00:24:33,230 --> 00:24:38,880
and what if notepad is beaconing out to

483
00:24:36,240 --> 00:24:41,400
the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> every five seconds those</font>

484
00:24:38,880 --> 00:24:42,990
are<font color="#E5E5E5"> completely abnormal situations we</font>

485
00:24:41,400 --> 00:24:43,650
want to be able<font color="#E5E5E5"> to take</font><font color="#CCCCCC"> action on that</font>

486
00:24:42,990 --> 00:24:45,630
immediately

487
00:24:43,650 --> 00:24:49,350
and I think pause process is the perfect

488
00:24:45,630 --> 00:24:51,780
way to do that<font color="#CCCCCC"> so again if you see if</font>

489
00:24:49,350 --> 00:24:53,189
<font color="#E5E5E5">you see notepad running as a system it</font>

490
00:24:51,780 --> 00:24:55,830
could be that<font color="#E5E5E5"> an attacker as a</font><font color="#CCCCCC"> matter</font>

491
00:24:53,190 --> 00:24:57,480
<font color="#CCCCCC">per to shell spawned a notepad a</font><font color="#E5E5E5"> system</font>

492
00:24:55,830 --> 00:25:00,059
and<font color="#E5E5E5"> then migrated into that process so</font>

493
00:24:57,480 --> 00:25:01,260
they don't lose their shell we went

494
00:25:00,059 --> 00:25:04,710
<font color="#E5E5E5">through a bunch of different</font><font color="#CCCCCC"> scenarios</font>

495
00:25:01,260 --> 00:25:06,179
and we kind of outlined<font color="#E5E5E5"> well here's</font>

496
00:25:04,710 --> 00:25:07,920
everything we<font color="#E5E5E5"> can do with</font><font color="#CCCCCC"> PowerShell</font>

497
00:25:06,179 --> 00:25:09,840
<font color="#E5E5E5">just running on the system watching</font>

498
00:25:07,920 --> 00:25:11,730
process invocation<font color="#E5E5E5"> watching Network</font>

499
00:25:09,840 --> 00:25:14,550
events<font color="#E5E5E5"> watching system on logs does</font>

500
00:25:11,730 --> 00:25:17,429
anyone run system on awesome I see a ton

501
00:25:14,550 --> 00:25:19,050
of hands that's excellent<font color="#CCCCCC"> so what we're</font>

502
00:25:17,429 --> 00:25:21,000
doing<font color="#CCCCCC"> here is we're pulling all of those</font>

503
00:25:19,050 --> 00:25:22,200
different data<font color="#CCCCCC"> points</font><font color="#E5E5E5"> and we're making</font>

504
00:25:21,000 --> 00:25:24,690
<font color="#CCCCCC">decisions</font><font color="#E5E5E5"> on if we want</font><font color="#CCCCCC"> to pause</font>

505
00:25:22,200 --> 00:25:36,120
processes or not so let me show<font color="#E5E5E5"> you an</font>

506
00:25:24,690 --> 00:25:37,690
example of a honey document access so

507
00:25:36,120 --> 00:25:40,268
one thing we didn't one

508
00:25:37,690 --> 00:25:42,789
thing we didn't mention<font color="#E5E5E5"> is that that</font>

509
00:25:40,269 --> 00:25:44,409
<font color="#E5E5E5">honey port</font><font color="#CCCCCC"> the whole honey port process</font>

510
00:25:42,789 --> 00:25:46,600
we actually<font color="#CCCCCC"> wrote a script for</font><font color="#E5E5E5"> this and</font>

511
00:25:44,409 --> 00:25:48,070
the honey port script will spin up<font color="#CCCCCC"> a</font>

512
00:25:46,600 --> 00:25:50,860
bunch of<font color="#E5E5E5"> different deception techniques</font>

513
00:25:48,070 --> 00:25:52,539
<font color="#E5E5E5">on every host so you blow this script</font>

514
00:25:50,860 --> 00:25:54,459
out<font color="#E5E5E5"> to all your machines it'll spin up</font>

515
00:25:52,539 --> 00:25:56,289
honey ports on each one<font color="#E5E5E5"> and it'll also</font>

516
00:25:54,460 --> 00:25:58,919
do things like<font color="#E5E5E5"> this it'll create a honey</font>

517
00:25:56,289 --> 00:25:58,919
directory

