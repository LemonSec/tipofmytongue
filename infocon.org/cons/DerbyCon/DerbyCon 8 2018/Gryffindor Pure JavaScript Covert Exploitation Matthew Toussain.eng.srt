1
00:00:09,830 --> 00:00:15,360
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right</font>

2
00:00:11,639 --> 00:00:17,789
hey derbycon sorry that last minutes

3
00:00:15,360 --> 00:00:19,250
<font color="#E5E5E5">free presentation</font><font color="#CCCCCC"> oh my gosh nothing's</font>

4
00:00:17,789 --> 00:00:21,330
<font color="#E5E5E5">working I can't get the screen how many</font>

5
00:00:19,250 --> 00:00:23,369
<font color="#E5E5E5">pen testers to take to screw in a light</font>

6
00:00:21,330 --> 00:00:24,839
bulb<font color="#E5E5E5"> that kind of thing it's all up and</font>

7
00:00:23,369 --> 00:00:26,789
<font color="#E5E5E5">running</font><font color="#CCCCCC"> now so we can jump in and get</font>

8
00:00:24,840 --> 00:00:28,859
<font color="#E5E5E5">started</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right as you can tell this</font>

9
00:00:26,789 --> 00:00:31,320
<font color="#E5E5E5">Hawk is about a tool called Gryffindor</font>

10
00:00:28,859 --> 00:00:32,610
releasing that today it's a<font color="#E5E5E5"> JavaScript</font>

11
00:00:31,320 --> 00:00:35,340
based backdoor remote administration

12
00:00:32,610 --> 00:00:37,620
tool<font color="#E5E5E5"> slash framework so kind of see why</font>

13
00:00:35,340 --> 00:00:40,620
we're doing<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like this kind of</font>

14
00:00:37,620 --> 00:00:44,218
where<font color="#E5E5E5"> our</font><font color="#CCCCCC"> tool kit exists in red teaming</font>

15
00:00:40,620 --> 00:00:47,010
in general and then go<font color="#E5E5E5"> from there so</font>

16
00:00:44,219 --> 00:00:49,320
first<font color="#E5E5E5"> Who am I obviously very cool you</font>

17
00:00:47,010 --> 00:00:50,550
could<font color="#E5E5E5"> tell by the glasses</font><font color="#CCCCCC"> does Don</font><font color="#E5E5E5"> I</font>

18
00:00:49,320 --> 00:00:52,829
used to be in the Air Force

19
00:00:50,550 --> 00:00:56,129
hence the digs<font color="#CCCCCC"> there Air Force aviators</font>

20
00:00:52,829 --> 00:00:58,469
and<font color="#CCCCCC"> such and BH</font><font color="#E5E5E5"> yes</font>

21
00:00:56,129 --> 00:00:59,968
so John strand<font color="#E5E5E5"> saved my life</font><font color="#CCCCCC"> kind of</font>

22
00:00:58,469 --> 00:01:01,800
like a rescue<font color="#E5E5E5"> puppy and now I'm a</font>

23
00:00:59,969 --> 00:01:03,780
<font color="#E5E5E5">penetration tester for Black Hills I do</font>

24
00:01:01,800 --> 00:01:05,518
a lot of web applications<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of red</font>

25
00:01:03,780 --> 00:01:07,799
teaming<font color="#E5E5E5"> those kind of things</font>

26
00:01:05,519 --> 00:01:09,869
fun stuff<font color="#CCCCCC"> it's out of those</font><font color="#E5E5E5"> things that</font>

27
00:01:07,799 --> 00:01:11,909
tools like this we find<font color="#CCCCCC"> the need for</font>

28
00:01:09,869 --> 00:01:13,320
<font color="#E5E5E5">them and while we start developing a lot</font>

29
00:01:11,909 --> 00:01:16,080
of those<font color="#E5E5E5"> things and try to give</font><font color="#CCCCCC"> back to</font>

30
00:01:13,320 --> 00:01:17,580
the community<font color="#CCCCCC"> if we can</font><font color="#E5E5E5"> i'm also founder</font>

31
00:01:16,080 --> 00:01:19,860
<font color="#CCCCCC">of a company called open security and</font>

32
00:01:17,580 --> 00:01:22,080
instructor with<font color="#E5E5E5"> the SANS Institute</font><font color="#CCCCCC"> the</font>

33
00:01:19,860 --> 00:01:24,869
author<font color="#E5E5E5"> of our</font><font color="#CCCCCC"> SEK 460 course which</font>

34
00:01:22,080 --> 00:01:25,770
launched in<font color="#CCCCCC"> August so it's</font><font color="#E5E5E5"> brand-new so</font>

35
00:01:24,869 --> 00:01:27,810
far it's<font color="#E5E5E5"> going really well</font>

36
00:01:25,770 --> 00:01:28,890
<font color="#CCCCCC">I wrote</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> with Tim</font><font color="#E5E5E5"> Dean who's</font><font color="#CCCCCC"> also</font>

37
00:01:27,810 --> 00:01:32,369
around the conference<font color="#E5E5E5"> somewhere so if</font>

38
00:01:28,890 --> 00:01:34,740
you run<font color="#CCCCCC"> into him</font><font color="#E5E5E5"> say hi for me so when</font>

39
00:01:32,369 --> 00:01:38,090
it comes to<font color="#CCCCCC"> Red Team operations in</font>

40
00:01:34,740 --> 00:01:40,919
general and just<font color="#E5E5E5"> penetration testing</font>

41
00:01:38,090 --> 00:01:44,759
offensive operations there's a big

42
00:01:40,920 --> 00:01:46,920
<font color="#E5E5E5">diversity in the top and most secure we</font>

43
00:01:44,759 --> 00:01:48,840
see organizations<font color="#CCCCCC"> versus</font><font color="#E5E5E5"> kind of</font>

44
00:01:46,920 --> 00:01:52,350
everyone else and<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> this linear</font>

45
00:01:48,840 --> 00:01:55,079
scale<font color="#E5E5E5"> where the top 10% is just as much</font>

46
00:01:52,350 --> 00:01:56,969
better from the next group of<font color="#E5E5E5"> 10%</font><font color="#CCCCCC"> as</font>

47
00:01:55,079 --> 00:01:59,579
they are from<font color="#CCCCCC"> the one below that</font><font color="#E5E5E5"> it's</font>

48
00:01:56,969 --> 00:02:01,169
<font color="#E5E5E5">completely different</font><font color="#CCCCCC"> so the top</font><font color="#E5E5E5"> 10% of</font>

49
00:01:59,579 --> 00:02:03,380
organizations<font color="#E5E5E5"> we're seeing some really</font>

50
00:02:01,170 --> 00:02:05,369
<font color="#CCCCCC">good stuff some</font><font color="#E5E5E5"> absolutely outstanding</font>

51
00:02:03,380 --> 00:02:07,408
defenses and protections they're doing<font color="#E5E5E5"> a</font>

52
00:02:05,369 --> 00:02:09,209
<font color="#E5E5E5">lot</font><font color="#CCCCCC"> of active defense where the blue</font>

53
00:02:07,409 --> 00:02:11,310
team<font color="#E5E5E5"> is really being focused</font><font color="#CCCCCC"> in on and</font>

54
00:02:09,209 --> 00:02:12,750
they're targeting whatever the attackers

55
00:02:11,310 --> 00:02:13,590
doing the techniques<font color="#E5E5E5"> that the attacker</font>

56
00:02:12,750 --> 00:02:15,930
is maybe

57
00:02:13,590 --> 00:02:17,489
implementing<font color="#E5E5E5"> in order to prevent and to</font>

58
00:02:15,930 --> 00:02:19,349
stop those<font color="#E5E5E5"> in the case of these</font>

59
00:02:17,489 --> 00:02:21,270
organizations<font color="#E5E5E5"> are starting</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> come to</font>

60
00:02:19,349 --> 00:02:23,220
this<font color="#CCCCCC"> realization that our powershell</font>

61
00:02:21,270 --> 00:02:24,780
tool kit which is<font color="#CCCCCC"> Kevon developed by the</font>

62
00:02:23,220 --> 00:02:27,209
<font color="#E5E5E5">community over the</font><font color="#CCCCCC"> past five years is</font>

63
00:02:24,780 --> 00:02:29,010
really<font color="#E5E5E5"> really not quite cutting it</font>

64
00:02:27,209 --> 00:02:30,209
anymore<font color="#E5E5E5"> it's getting really weak we're</font>

65
00:02:29,010 --> 00:02:32,130
running into<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of fences that are</font>

66
00:02:30,209 --> 00:02:35,760
<font color="#E5E5E5">breaking apart our capability to</font><font color="#CCCCCC"> perform</font>

67
00:02:32,130 --> 00:02:38,069
<font color="#E5E5E5">and do offensive actions within</font><font color="#CCCCCC"> our</font>

68
00:02:35,760 --> 00:02:40,590
<font color="#E5E5E5">toolkit that</font><font color="#CCCCCC"> we got accustomed to</font><font color="#E5E5E5"> over</font>

69
00:02:38,069 --> 00:02:42,420
<font color="#CCCCCC">time so microsoft's done a really good</font>

70
00:02:40,590 --> 00:02:44,580
job here<font color="#CCCCCC"> putting the tools in the hands</font>

71
00:02:42,420 --> 00:02:47,190
<font color="#E5E5E5">of organizations to be able to take on</font>

72
00:02:44,580 --> 00:02:50,519
that burden<font color="#CCCCCC"> and</font><font color="#E5E5E5"> do some defenses of</font>

73
00:02:47,190 --> 00:02:53,549
themselves<font color="#CCCCCC"> these</font><font color="#E5E5E5"> tools though do a lot</font>

74
00:02:50,519 --> 00:02:54,989
of targeting what they know<font color="#E5E5E5"> to be bad</font>

75
00:02:53,549 --> 00:02:57,000
which kind of makes<font color="#CCCCCC"> sense right if</font>

76
00:02:54,989 --> 00:02:59,370
you're gonna try<font color="#E5E5E5"> to stop malicious</font>

77
00:02:57,000 --> 00:03:00,959
activity figure<font color="#CCCCCC"> out what malicious</font>

78
00:02:59,370 --> 00:03:03,030
activity<font color="#E5E5E5"> looks like and start blocking</font>

79
00:03:00,959 --> 00:03:03,959
<font color="#E5E5E5">that for us as penetration testers</font>

80
00:03:03,030 --> 00:03:07,440
though in the<font color="#CCCCCC"> open-source community</font>

81
00:03:03,959 --> 00:03:09,989
<font color="#CCCCCC">that's a little difficult</font><font color="#E5E5E5"> because many</font>

82
00:03:07,440 --> 00:03:11,400
<font color="#CCCCCC">of the tools that we use aren't</font><font color="#E5E5E5"> written</font>

83
00:03:09,989 --> 00:03:13,349
by us in fact<font color="#E5E5E5"> I've never</font><font color="#CCCCCC"> done a</font>

84
00:03:11,400 --> 00:03:15,180
<font color="#E5E5E5">penetration test where every single tool</font>

85
00:03:13,349 --> 00:03:17,608
that<font color="#CCCCCC"> I used on</font><font color="#E5E5E5"> that penetration test was</font>

86
00:03:15,180 --> 00:03:19,019
written in-house I've never done<font color="#CCCCCC"> that</font><font color="#E5E5E5"> do</font>

87
00:03:17,609 --> 00:03:21,180
a lot of<font color="#E5E5E5"> tests where most</font><font color="#CCCCCC"> of the tools</font>

88
00:03:19,019 --> 00:03:23,340
<font color="#E5E5E5">that we</font><font color="#CCCCCC"> use are built into</font><font color="#E5E5E5"> the operating</font>

89
00:03:21,180 --> 00:03:25,590
<font color="#E5E5E5">system themselves so inherent Windows</font>

90
00:03:23,340 --> 00:03:26,940
executables<font color="#E5E5E5"> things that are ready</font>

91
00:03:25,590 --> 00:03:29,329
<font color="#E5E5E5">they're using a lot</font><font color="#CCCCCC"> of the Windows</font>

92
00:03:26,940 --> 00:03:31,319
Firewall these days that<font color="#E5E5E5"> just works</font>

93
00:03:29,329 --> 00:03:33,870
<font color="#CCCCCC">universal and</font><font color="#E5E5E5"> it's really nice</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have</font>

94
00:03:31,319 --> 00:03:34,738
<font color="#E5E5E5">that capability there but when we get</font><font color="#CCCCCC"> a</font>

95
00:03:33,870 --> 00:03:37,350
little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> further you</font><font color="#CCCCCC"> want to be</font>

96
00:03:34,739 --> 00:03:38,790
<font color="#E5E5E5">something a bit deeper like pull</font>

97
00:03:37,350 --> 00:03:40,858
<font color="#CCCCCC">plaintext tarantulas out of</font><font color="#E5E5E5"> memory or</font>

98
00:03:38,790 --> 00:03:44,250
<font color="#E5E5E5">start dumping hashes or</font><font color="#CCCCCC"> move laterally</font>

99
00:03:40,859 --> 00:03:46,500
<font color="#E5E5E5">within say tokenized windows session</font>

100
00:03:44,250 --> 00:03:48,450
<font color="#E5E5E5">well we might want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a</font><font color="#CCCCCC"> toolkit</font>

101
00:03:46,500 --> 00:03:50,130
it's an<font color="#CCCCCC"> optimize for</font><font color="#E5E5E5"> that it's also</font>

102
00:03:48,450 --> 00:03:52,858
helpful<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the perspective of</font><font color="#CCCCCC"> being</font>

103
00:03:50,130 --> 00:03:54,060
more covert for using built-in<font color="#E5E5E5"> tools we</font>

104
00:03:52,859 --> 00:03:56,400
probably don't<font color="#E5E5E5"> have the</font><font color="#CCCCCC"> ability to do</font>

105
00:03:54,060 --> 00:03:59,400
<font color="#E5E5E5">things like delay timers and beaconing</font>

106
00:03:56,400 --> 00:04:01,019
and jitter<font color="#E5E5E5"> where you mix up the rate at</font>

107
00:03:59,400 --> 00:04:03,000
which your command<font color="#E5E5E5"> and control</font>

108
00:04:01,019 --> 00:04:04,230
communication exfiltrate sand

109
00:04:03,000 --> 00:04:06,630
infiltrates from the environment

110
00:04:04,230 --> 00:04:08,100
<font color="#CCCCCC">addresses and ingresses</font><font color="#E5E5E5"> these are things</font>

111
00:04:06,630 --> 00:04:09,630
we really want<font color="#CCCCCC"> to have in our</font><font color="#E5E5E5"> toolkit</font>

112
00:04:08,100 --> 00:04:11,700
<font color="#E5E5E5">and there are things that we get and</font>

113
00:04:09,630 --> 00:04:13,769
<font color="#E5E5E5">things like PowerShell Empire or</font><font color="#CCCCCC"> cobalt</font>

114
00:04:11,700 --> 00:04:14,638
strike cobalt<font color="#CCCCCC"> Rex beacon tool implements</font>

115
00:04:13,769 --> 00:04:18,329
a lot of these and it's quite

116
00:04:14,639 --> 00:04:19,859
<font color="#CCCCCC">outstanding</font><font color="#E5E5E5"> but security vendors are</font>

117
00:04:18,329 --> 00:04:21,478
very<font color="#CCCCCC"> familiar with</font><font color="#E5E5E5"> those tools and they</font>

118
00:04:19,858 --> 00:04:23,430
do a lot<font color="#CCCCCC"> of targeting against what those</font>

119
00:04:21,478 --> 00:04:25,109
tools specifically do and that's<font color="#E5E5E5"> not</font>

120
00:04:23,430 --> 00:04:26,610
necessarily down to the tactic is<font color="#E5E5E5"> in</font>

121
00:04:25,110 --> 00:04:28,919
beaconing malware

122
00:04:26,610 --> 00:04:30,539
but often focused in on the tool itself

123
00:04:28,919 --> 00:04:32,490
<font color="#E5E5E5">and its</font><font color="#CCCCCC"> implementation</font>

124
00:04:30,539 --> 00:04:34,500
this<font color="#CCCCCC"> p8 creates a challenge for</font><font color="#E5E5E5"> us as</font>

125
00:04:32,490 --> 00:04:37,979
penetration<font color="#E5E5E5"> testers on the other hand</font>

126
00:04:34,500 --> 00:04:40,409
the<font color="#CCCCCC"> other</font><font color="#E5E5E5"> 90%</font><font color="#CCCCCC"> of organizations we don't</font>

127
00:04:37,979 --> 00:04:42,180
<font color="#E5E5E5">really see a lot</font><font color="#CCCCCC"> of that PowerShell</font><font color="#E5E5E5"> is</font>

128
00:04:40,409 --> 00:04:44,129
probably gonna be alive and well<font color="#CCCCCC"> in many</font>

129
00:04:42,180 --> 00:04:45,840
different ways shapes and<font color="#E5E5E5"> forms</font><font color="#CCCCCC"> for</font>

130
00:04:44,129 --> 00:04:48,509
those organizations<font color="#E5E5E5"> for a long period of</font>

131
00:04:45,840 --> 00:04:51,479
time<font color="#E5E5E5"> this makes it really weird for us</font>

132
00:04:48,509 --> 00:04:55,319
as testers<font color="#E5E5E5"> as in</font><font color="#CCCCCC"> 90% of the time we are</font>

133
00:04:51,479 --> 00:04:57,000
<font color="#E5E5E5">on top absolutely demigods every day and</font>

134
00:04:55,319 --> 00:04:59,580
the<font color="#E5E5E5"> other 10% we feel like we're getting</font>

135
00:04:57,000 --> 00:05:02,189
<font color="#E5E5E5">our</font><font color="#CCCCCC"> butts kicked there's nothing wrong</font>

136
00:04:59,580 --> 00:05:03,960
with<font color="#CCCCCC"> that per se</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> do have to make</font>

137
00:05:02,189 --> 00:05:05,699
<font color="#E5E5E5">sure that</font><font color="#CCCCCC"> when we do work</font><font color="#E5E5E5"> for our</font>

138
00:05:03,960 --> 00:05:07,650
customers<font color="#E5E5E5"> the value that we're providing</font>

139
00:05:05,699 --> 00:05:10,590
<font color="#E5E5E5">them does not provide them with a false</font>

140
00:05:07,650 --> 00:05:13,020
sense of security<font color="#CCCCCC"> that's based</font><font color="#E5E5E5"> off what</font>

141
00:05:10,590 --> 00:05:16,109
we are<font color="#E5E5E5"> doing and not</font><font color="#CCCCCC"> what intrusion sets</font>

142
00:05:13,020 --> 00:05:19,318
<font color="#E5E5E5">in the real world are doing so it's okay</font>

143
00:05:16,110 --> 00:05:21,449
<font color="#E5E5E5">to lose</font><font color="#CCCCCC"> it's not the wrong</font><font color="#E5E5E5"> way and so</font>

144
00:05:19,319 --> 00:05:24,060
look<font color="#E5E5E5"> at that to know</font><font color="#CCCCCC"> that we are taking</font>

145
00:05:21,449 --> 00:05:25,469
<font color="#E5E5E5">up this burden properly and actualizing</font>

146
00:05:24,060 --> 00:05:27,810
it for our customers we<font color="#CCCCCC"> actually to be</font>

147
00:05:25,469 --> 00:05:29,370
<font color="#CCCCCC">fairly</font><font color="#E5E5E5"> familiar with</font><font color="#CCCCCC"> what's going on in</font>

148
00:05:27,810 --> 00:05:31,259
the real world when<font color="#CCCCCC"> intrusion sets are</font>

149
00:05:29,370 --> 00:05:32,819
doing what kind<font color="#CCCCCC"> of attacks they're going</font>

150
00:05:31,259 --> 00:05:35,729
<font color="#CCCCCC">after what their goals</font><font color="#E5E5E5"> are and how</font>

151
00:05:32,819 --> 00:05:37,770
<font color="#CCCCCC">they're implementing that because if</font><font color="#E5E5E5"> our</font>

152
00:05:35,729 --> 00:05:40,740
<font color="#E5E5E5">toolkit if what we would normally do is</font>

153
00:05:37,770 --> 00:05:42,900
not that<font color="#E5E5E5"> and we're unsuccessful but</font>

154
00:05:40,740 --> 00:05:44,310
they're successful we've caused that

155
00:05:42,900 --> 00:05:45,929
false sense of security for<font color="#E5E5E5"> the customer</font>

156
00:05:44,310 --> 00:05:49,409
<font color="#E5E5E5">and that's really really bad that's</font>

157
00:05:45,930 --> 00:05:51,629
dangerous<font color="#E5E5E5"> so to start we want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> think</font>

158
00:05:49,409 --> 00:05:53,279
<font color="#CCCCCC">about what they're doing</font><font color="#E5E5E5"> and why for the</font>

159
00:05:51,629 --> 00:05:55,259
perspective<font color="#CCCCCC"> of cyber criminal</font>

160
00:05:53,279 --> 00:05:57,479
<font color="#CCCCCC">organizations often it's all about</font>

161
00:05:55,259 --> 00:05:57,930
monetization<font color="#CCCCCC"> we see this grow over time</font>

162
00:05:57,479 --> 00:06:00,210
as well

163
00:05:57,930 --> 00:06:02,099
spam is<font color="#CCCCCC"> still a big one viagra got to</font>

164
00:06:00,210 --> 00:06:04,409
<font color="#E5E5E5">get that viagra</font><font color="#CCCCCC"> that's a way</font><font color="#E5E5E5"> to make</font>

165
00:06:02,099 --> 00:06:06,599
money<font color="#E5E5E5"> absolutely so it's still something</font>

166
00:06:04,409 --> 00:06:08,969
<font color="#CCCCCC">to consider ransomware grew very very</font>

167
00:06:06,599 --> 00:06:11,310
<font color="#E5E5E5">rapidly it's still around</font><font color="#CCCCCC"> absolutely see</font>

168
00:06:08,969 --> 00:06:13,469
it every<font color="#E5E5E5"> day but it is beginning</font><font color="#CCCCCC"> to</font>

169
00:06:11,310 --> 00:06:15,300
taper<font color="#CCCCCC"> off for things like crypto miners</font>

170
00:06:13,469 --> 00:06:18,330
as well because it's a new way to

171
00:06:15,300 --> 00:06:20,639
<font color="#E5E5E5">monetize the exploitation</font><font color="#CCCCCC"> that they've</font>

172
00:06:18,330 --> 00:06:23,310
gained against an unwitting<font color="#E5E5E5"> unwary</font>

173
00:06:20,639 --> 00:06:25,349
target<font color="#E5E5E5"> now that last one is a bit</font>

174
00:06:23,310 --> 00:06:27,539
different<font color="#CCCCCC"> cybercrime the service isn't</font>

175
00:06:25,349 --> 00:06:30,330
necessarily a specific<font color="#E5E5E5"> way of doing</font>

176
00:06:27,539 --> 00:06:32,729
something<font color="#CCCCCC"> like spam or ransomware or</font>

177
00:06:30,330 --> 00:06:35,490
crypto miners it's a way for<font color="#CCCCCC"> them to</font>

178
00:06:32,729 --> 00:06:37,529
monetize those schemes to others we see

179
00:06:35,490 --> 00:06:40,289
quite<font color="#E5E5E5"> a bit of</font><font color="#CCCCCC"> cybercrime</font><font color="#E5E5E5"> as a service</font>

180
00:06:37,529 --> 00:06:41,550
specifically in the case of ransomware

181
00:06:40,289 --> 00:06:44,460
some<font color="#E5E5E5"> interesting ones in the case of</font>

182
00:06:41,550 --> 00:06:46,289
crypto miners for blogs that do it

183
00:06:44,460 --> 00:06:47,669
wittingly<font color="#E5E5E5"> instead of providing ad</font>

184
00:06:46,289 --> 00:06:49,289
<font color="#CCCCCC">revenue it's a pretty</font><font color="#E5E5E5"> interesting thing</font>

185
00:06:47,669 --> 00:06:51,599
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> seeing today because that is</font>

186
00:06:49,289 --> 00:06:53,339
potentially malicious software<font color="#CCCCCC"> that</font>

187
00:06:51,599 --> 00:06:55,289
they're using<font color="#E5E5E5"> legitimately</font>

188
00:06:53,339 --> 00:06:57,059
<font color="#E5E5E5">nothing wrong with that but it does make</font>

189
00:06:55,289 --> 00:06:59,029
<font color="#CCCCCC">it</font><font color="#E5E5E5"> harder to find what's wrong what's</font>

190
00:06:57,059 --> 00:07:02,279
<font color="#CCCCCC">actually bad</font><font color="#E5E5E5"> block and break that apart</font>

191
00:06:59,029 --> 00:07:04,169
<font color="#E5E5E5">now this is a talk about</font><font color="#CCCCCC"> JavaScript you</font>

192
00:07:02,279 --> 00:07:08,249
can<font color="#CCCCCC"> do all of</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> things in JavaScript</font>

193
00:07:04,169 --> 00:07:09,839
<font color="#CCCCCC">and our at the cases is specifically</font><font color="#E5E5E5"> we</font>

194
00:07:08,249 --> 00:07:13,589
started to see this<font color="#CCCCCC"> really start to</font><font color="#E5E5E5"> come</font>

195
00:07:09,839 --> 00:07:16,110
<font color="#CCCCCC">up and take speed in 2017 say in 2017</font>

196
00:07:13,589 --> 00:07:18,119
<font color="#CCCCCC">January time period they were using</font><font color="#E5E5E5"> a</font>

197
00:07:16,110 --> 00:07:20,490
decent amount<font color="#CCCCCC"> of Windows scripting host</font>

198
00:07:18,119 --> 00:07:21,809
<font color="#CCCCCC">based JavaScript malware</font><font color="#E5E5E5"> in order to</font>

199
00:07:20,490 --> 00:07:23,309
execute<font color="#E5E5E5"> things we'll take a look at what</font>

200
00:07:21,809 --> 00:07:24,869
<font color="#CCCCCC">that actually looks like</font><font color="#E5E5E5"> how it works</font>

201
00:07:23,309 --> 00:07:27,539
<font color="#E5E5E5">and</font><font color="#CCCCCC"> how easy</font><font color="#E5E5E5"> it is to perform here in</font>

202
00:07:24,869 --> 00:07:29,459
just a second but<font color="#E5E5E5"> what they started</font><font color="#CCCCCC"> out</font>

203
00:07:27,539 --> 00:07:31,558
<font color="#E5E5E5">with is they were using this to run</font>

204
00:07:29,459 --> 00:07:33,209
something<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> something would</font>

205
00:07:31,559 --> 00:07:35,490
download<font color="#E5E5E5"> all of the rest of their</font>

206
00:07:33,209 --> 00:07:38,009
malware toolkit<font color="#E5E5E5"> all of these executables</font>

207
00:07:35,490 --> 00:07:39,990
<font color="#CCCCCC">exe s</font><font color="#E5E5E5"> to then run whatever it was attack</font>

208
00:07:38,009 --> 00:07:42,360
wise they wanted to do in the case<font color="#E5E5E5"> of</font>

209
00:07:39,990 --> 00:07:44,009
ransomware what this means is they would

210
00:07:42,360 --> 00:07:46,379
do some kind of phishing attack or get

211
00:07:44,009 --> 00:07:48,539
some user to<font color="#E5E5E5"> click on something</font><font color="#CCCCCC"> the dot</font>

212
00:07:46,379 --> 00:07:50,580
J's file and that<font color="#E5E5E5"> dot J's file would</font>

213
00:07:48,539 --> 00:07:52,558
then download the<font color="#E5E5E5"> ransomware</font><font color="#CCCCCC"> it wasn't</font>

214
00:07:50,580 --> 00:07:54,508
itself actually<font color="#CCCCCC"> the ransomware</font><font color="#E5E5E5"> it was a</font>

215
00:07:52,559 --> 00:07:57,029
trojan downloader<font color="#E5E5E5"> a malware downloader</font>

216
00:07:54,509 --> 00:07:58,680
<font color="#CCCCCC">when they started</font><font color="#E5E5E5"> to grow in complexity</font>

217
00:07:57,029 --> 00:08:01,919
<font color="#CCCCCC">over time this</font><font color="#E5E5E5"> is what's really</font>

218
00:07:58,680 --> 00:08:04,409
<font color="#E5E5E5">interesting in the adversaries</font>

219
00:08:01,919 --> 00:08:06,409
perspective<font color="#E5E5E5"> when it comes to ransomware</font>

220
00:08:04,409 --> 00:08:09,360
specifically<font color="#E5E5E5"> I mentioned</font><font color="#CCCCCC"> before that</font>

221
00:08:06,409 --> 00:08:10,919
<font color="#E5E5E5">when antivirus is targeting our tools</font>

222
00:08:09,360 --> 00:08:12,809
and<font color="#E5E5E5"> we're unsuccessful there isn't</font>

223
00:08:10,919 --> 00:08:15,209
necessarily reflect upon the intrusion

224
00:08:12,809 --> 00:08:17,459
<font color="#CCCCCC">sense however</font><font color="#E5E5E5"> in the case of ransomware</font>

225
00:08:15,209 --> 00:08:19,229
we want to make<font color="#E5E5E5"> money and the way we</font>

226
00:08:17,459 --> 00:08:21,300
make money is we ransom<font color="#E5E5E5"> and extorts an</font>

227
00:08:19,229 --> 00:08:23,279
organization the more<font color="#CCCCCC"> I organization</font>

228
00:08:21,300 --> 00:08:24,959
<font color="#E5E5E5">sign extort the more money I can</font><font color="#CCCCCC"> make</font>

229
00:08:23,279 --> 00:08:29,159
which means I want<font color="#E5E5E5"> to do these as much</font>

230
00:08:24,959 --> 00:08:31,589
as<font color="#CCCCCC"> possible this gives antivirus the</font>

231
00:08:29,159 --> 00:08:33,179
opportunity to develop signatures and

232
00:08:31,589 --> 00:08:34,529
countermeasures<font color="#E5E5E5"> and host</font><font color="#CCCCCC"> based</font>

233
00:08:33,179 --> 00:08:38,008
protection mechanisms against something

234
00:08:34,529 --> 00:08:40,500
like ransomware<font color="#E5E5E5"> this means less</font><font color="#CCCCCC"> money</font>

235
00:08:38,009 --> 00:08:42,000
<font color="#E5E5E5">for the bad guy the way that they stay</font>

236
00:08:40,500 --> 00:08:45,019
ahead of<font color="#E5E5E5"> this is they continuously</font>

237
00:08:42,000 --> 00:08:48,360
iterate<font color="#E5E5E5"> upon their</font><font color="#CCCCCC"> toolkit in most other</font>

238
00:08:45,019 --> 00:08:49,649
malicious offensive operations<font color="#E5E5E5"> we see</font>

239
00:08:48,360 --> 00:08:51,779
this iteration take place much more

240
00:08:49,649 --> 00:08:53,910
<font color="#E5E5E5">slowly because they're very careful</font>

241
00:08:51,779 --> 00:08:55,350
<font color="#E5E5E5">about losing their expensive</font>

242
00:08:53,910 --> 00:08:56,880
-<font color="#E5E5E5"> okay that they spent hundreds of</font><font color="#CCCCCC"> hours</font>

243
00:08:55,350 --> 00:08:59,310
developing<font color="#E5E5E5"> for the purpose of</font>

244
00:08:56,880 --> 00:09:00,120
weaponizing<font color="#E5E5E5"> your environment and making</font>

245
00:08:59,310 --> 00:09:01,800
<font color="#E5E5E5">money off</font><font color="#CCCCCC"> of you</font>

246
00:09:00,120 --> 00:09:03,330
<font color="#E5E5E5">well these are ransomware they can't</font>

247
00:09:01,800 --> 00:09:06,479
quite do that<font color="#E5E5E5"> so they need to stay ahead</font>

248
00:09:03,330 --> 00:09:08,250
<font color="#E5E5E5">of Av this means that they make a lot</font>

249
00:09:06,480 --> 00:09:10,620
more<font color="#E5E5E5"> tools they keep making</font><font color="#CCCCCC"> more and</font>

250
00:09:08,250 --> 00:09:12,600
more<font color="#CCCCCC"> and more and more</font><font color="#E5E5E5"> as penetration</font>

251
00:09:10,620 --> 00:09:15,150
<font color="#E5E5E5">testers when it comes to our backdoors</font>

252
00:09:12,600 --> 00:09:17,190
we could also<font color="#E5E5E5"> try to do this we could</font>

253
00:09:15,150 --> 00:09:19,050
make a new<font color="#E5E5E5"> backdoor for every pen test</font>

254
00:09:17,190 --> 00:09:22,140
that we do we<font color="#E5E5E5"> would bypass antivirus</font>

255
00:09:19,050 --> 00:09:24,510
every time<font color="#CCCCCC"> 100</font><font color="#E5E5E5"> percent over 100</font><font color="#CCCCCC"> our pen</font>

256
00:09:22,140 --> 00:09:26,490
tests have<font color="#E5E5E5"> also now become</font><font color="#CCCCCC"> 5,000 times</font>

257
00:09:24,510 --> 00:09:27,660
<font color="#E5E5E5">more</font><font color="#CCCCCC"> expensive</font><font color="#E5E5E5"> this is not necessarily</font>

258
00:09:26,490 --> 00:09:31,380
<font color="#CCCCCC">something we have the ability to do</font>

259
00:09:27,660 --> 00:09:33,390
<font color="#E5E5E5">because our cost model is different</font><font color="#CCCCCC"> then</font>

260
00:09:31,380 --> 00:09:36,120
<font color="#CCCCCC">theirs is awful one of</font><font color="#E5E5E5"> these ransomware</font>

261
00:09:33,390 --> 00:09:38,220
<font color="#E5E5E5">gigs</font><font color="#CCCCCC"> they can make tens of thousands</font><font color="#E5E5E5"> or</font>

262
00:09:36,120 --> 00:09:39,840
hundreds of thousands<font color="#E5E5E5"> of dollars simply</font>

263
00:09:38,220 --> 00:09:42,450
<font color="#E5E5E5">because the value of the data that</font>

264
00:09:39,840 --> 00:09:44,730
<font color="#CCCCCC">they've now managed to extort the victim</font>

265
00:09:42,450 --> 00:09:47,430
<font color="#E5E5E5">organization for and a penetration test</font>

266
00:09:44,730 --> 00:09:49,830
<font color="#E5E5E5">we can't necessarily do that but we</font>

267
00:09:47,430 --> 00:09:51,660
<font color="#CCCCCC">can't observe</font><font color="#E5E5E5"> the growth and development</font>

268
00:09:49,830 --> 00:09:53,490
of<font color="#E5E5E5"> their tool kit over time and try to</font>

269
00:09:51,660 --> 00:09:55,620
<font color="#E5E5E5">replicate some of those features</font><font color="#CCCCCC"> so what</font>

270
00:09:53,490 --> 00:09:58,500
you saw next was a move<font color="#CCCCCC"> towards</font>

271
00:09:55,620 --> 00:10:01,260
<font color="#E5E5E5">JavaScript centric malware where fewer</font>

272
00:09:58,500 --> 00:10:02,460
of those ransomware tools<font color="#E5E5E5"> were pulled</font>

273
00:10:01,260 --> 00:10:04,080
down and downloaded into<font color="#E5E5E5"> the</font>

274
00:10:02,460 --> 00:10:07,290
organization<font color="#E5E5E5"> with that malware</font>

275
00:10:04,080 --> 00:10:08,820
downloader this started<font color="#E5E5E5"> with most of the</font>

276
00:10:07,290 --> 00:10:11,880
ransom our<font color="#CCCCCC"> toolkit with the exception of</font>

277
00:10:08,820 --> 00:10:13,110
the cryptography portions<font color="#E5E5E5"> of whatever it</font>

278
00:10:11,880 --> 00:10:15,180
is<font color="#E5E5E5"> that they were doing</font><font color="#CCCCCC"> they'd be</font>

279
00:10:13,110 --> 00:10:16,320
infiltrating these as executables and<font color="#CCCCCC"> it</font>

280
00:10:15,180 --> 00:10:17,819
would still<font color="#CCCCCC"> be an executable written to</font>

281
00:10:16,320 --> 00:10:19,890
disk at some point that<font color="#E5E5E5"> would do the</font>

282
00:10:17,820 --> 00:10:23,790
actual cryptography and then give you

283
00:10:19,890 --> 00:10:26,730
<font color="#E5E5E5">the</font><font color="#CCCCCC"> extra tation notice the first</font>

284
00:10:23,790 --> 00:10:29,490
stand-alone<font color="#CCCCCC"> javascript</font><font color="#E5E5E5"> only ransomware</font>

285
00:10:26,730 --> 00:10:31,830
that we saw was known as ransom 32 and

286
00:10:29,490 --> 00:10:34,980
this<font color="#E5E5E5"> has written an nwj</font><font color="#CCCCCC"> ask those who</font>

287
00:10:31,830 --> 00:10:37,830
know what<font color="#E5E5E5"> nwj s is the idea with nwj s</font>

288
00:10:34,980 --> 00:10:43,260
is applications<font color="#E5E5E5"> on all systems</font><font color="#CCCCCC"> be they</font>

289
00:10:37,830 --> 00:10:44,550
<font color="#CCCCCC">mac OS x windows linux using javascript</font>

290
00:10:43,260 --> 00:10:47,250
<font color="#E5E5E5">which is something that</font><font color="#CCCCCC"> people know how</font>

291
00:10:44,550 --> 00:10:49,380
<font color="#CCCCCC">to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> you eyes in</font><font color="#E5E5E5"> gooeys very quickly</font>

292
00:10:47,250 --> 00:10:51,450
<font color="#CCCCCC">very easily</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> can then run</font>

293
00:10:49,380 --> 00:10:55,350
cross-platform<font color="#CCCCCC"> that's what the purpose</font>

294
00:10:51,450 --> 00:10:56,550
<font color="#E5E5E5">of node WebKit NW is one that you might</font>

295
00:10:55,350 --> 00:10:58,560
<font color="#E5E5E5">be a little more familiar with is called</font>

296
00:10:56,550 --> 00:11:00,359
electron it's the same<font color="#CCCCCC"> idea a lot</font><font color="#E5E5E5"> of the</font>

297
00:10:58,560 --> 00:11:02,280
same modules in there<font color="#E5E5E5"> it's the idea of</font>

298
00:11:00,360 --> 00:11:04,560
<font color="#E5E5E5">having something that can then run on</font>

299
00:11:02,280 --> 00:11:05,490
the local<font color="#CCCCCC"> system if you're familiar with</font>

300
00:11:04,560 --> 00:11:07,290
<font color="#E5E5E5">electron you might have seen the very</font>

301
00:11:05,490 --> 00:11:09,420
first slide<font color="#E5E5E5"> electron logo</font>

302
00:11:07,290 --> 00:11:10,290
was there so is<font color="#E5E5E5"> the reaction one the</font>

303
00:11:09,420 --> 00:11:12,479
tools that were going to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font>

304
00:11:10,290 --> 00:11:14,490
today<font color="#CCCCCC"> are written in</font><font color="#E5E5E5"> those same kind of</font>

305
00:11:12,480 --> 00:11:15,990
languages<font color="#E5E5E5"> the</font><font color="#CCCCCC"> same frameworks</font><font color="#E5E5E5"> so that we</font>

306
00:11:14,490 --> 00:11:18,899
can do<font color="#CCCCCC"> exactly what the adversaries</font>

307
00:11:15,990 --> 00:11:20,550
doing kind<font color="#E5E5E5"> of replicate what their modus</font>

308
00:11:18,899 --> 00:11:22,829
operandi<font color="#CCCCCC"> is here</font>

309
00:11:20,550 --> 00:11:24,899
so with ransom<font color="#E5E5E5"> 32 what it would create</font>

310
00:11:22,829 --> 00:11:28,620
is an executable payload if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> a dot</font>

311
00:11:24,899 --> 00:11:29,759
exe file binaries are<font color="#E5E5E5"> little suspect you</font>

312
00:11:28,620 --> 00:11:31,139
don't<font color="#CCCCCC"> esses really want to</font><font color="#E5E5E5"> email</font>

313
00:11:29,759 --> 00:11:32,850
somebody binary and hope they double

314
00:11:31,139 --> 00:11:34,620
click on it<font color="#E5E5E5"> and get pwned so you might</font>

315
00:11:32,850 --> 00:11:36,269
still need<font color="#E5E5E5"> some other kind</font><font color="#CCCCCC"> of payload</font>

316
00:11:34,620 --> 00:11:38,730
execution mechanism<font color="#E5E5E5"> some way to stage</font>

317
00:11:36,269 --> 00:11:41,069
that<font color="#E5E5E5"> which ended up with a binary here</font>

318
00:11:38,730 --> 00:11:42,240
to be fair<font color="#CCCCCC"> in penetration testing</font><font color="#E5E5E5"> we're</font>

319
00:11:41,069 --> 00:11:43,769
<font color="#E5E5E5">seeing a lot of moving back towards</font>

320
00:11:42,240 --> 00:11:46,470
binary payloads because they<font color="#E5E5E5"> just work</font>

321
00:11:43,769 --> 00:11:48,360
they work really really well<font color="#E5E5E5"> often often</font>

322
00:11:46,470 --> 00:11:49,889
often<font color="#E5E5E5"> the reason for that is we don't</font>

323
00:11:48,360 --> 00:11:51,810
<font color="#E5E5E5">see a huge amount</font><font color="#CCCCCC"> of application</font>

324
00:11:49,889 --> 00:11:53,399
whitelisting and<font color="#E5E5E5"> organizations there's a</font>

325
00:11:51,810 --> 00:11:54,869
push towards<font color="#E5E5E5"> this I would say eight</font>

326
00:11:53,399 --> 00:11:56,639
years ago and<font color="#E5E5E5"> it kind of tapered out</font>

327
00:11:54,870 --> 00:11:58,829
once the<font color="#CCCCCC"> communities shifted to</font>

328
00:11:56,639 --> 00:12:00,720
<font color="#E5E5E5">PowerShell style malware you saw a lot</font>

329
00:11:58,829 --> 00:12:03,149
<font color="#E5E5E5">less focus and emphasis on binary</font>

330
00:12:00,720 --> 00:12:04,589
payloads<font color="#E5E5E5"> so it's definitely still</font>

331
00:12:03,149 --> 00:12:06,480
effective<font color="#CCCCCC"> but</font><font color="#E5E5E5"> not necessarily the</font>

332
00:12:04,589 --> 00:12:09,089
easiest<font color="#CCCCCC"> thing to immediately get</font><font color="#E5E5E5"> in and</font>

333
00:12:06,480 --> 00:12:12,209
start<font color="#E5E5E5"> wrecking the network making havoc</font>

334
00:12:09,089 --> 00:12:14,399
now the next<font color="#CCCCCC"> one here is</font><font color="#E5E5E5"> Raa Raa is</font>

335
00:12:12,209 --> 00:12:16,529
<font color="#CCCCCC">javascript javascript javascript but</font>

336
00:12:14,399 --> 00:12:20,010
executed via the<font color="#CCCCCC"> windows scripting host</font>

337
00:12:16,529 --> 00:12:21,750
<font color="#E5E5E5">and using the crypto</font><font color="#CCCCCC"> j/s module in order</font>

338
00:12:20,010 --> 00:12:24,290
to do the cryptography<font color="#E5E5E5"> for the</font>

339
00:12:21,750 --> 00:12:26,850
development of<font color="#E5E5E5"> the exploitation scheme</font>

340
00:12:24,290 --> 00:12:28,050
<font color="#E5E5E5">and finally what we see in malware as</font>

341
00:12:26,850 --> 00:12:30,420
well in<font color="#CCCCCC"> JavaScript space our</font>

342
00:12:28,050 --> 00:12:32,130
cryptocurrency miners typically these

343
00:12:30,420 --> 00:12:34,139
<font color="#E5E5E5">are implemented in</font><font color="#CCCCCC"> JavaScript because</font>

344
00:12:32,130 --> 00:12:35,819
<font color="#E5E5E5">you just want system resources the</font>

345
00:12:34,139 --> 00:12:38,370
<font color="#CCCCCC">browser's you got system</font><font color="#E5E5E5"> resources you</font>

346
00:12:35,819 --> 00:12:40,019
don't<font color="#CCCCCC"> have to pone the browser</font><font color="#E5E5E5"> in order</font>

347
00:12:38,370 --> 00:12:41,699
to get it<font color="#E5E5E5"> to do things for you you</font><font color="#CCCCCC"> just</font>

348
00:12:40,019 --> 00:12:42,870
<font color="#CCCCCC">have to use</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> and so we see a lot of</font>

349
00:12:41,699 --> 00:12:44,670
<font color="#E5E5E5">those</font><font color="#CCCCCC"> input</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> JavaScript because</font>

350
00:12:42,870 --> 00:12:48,720
<font color="#CCCCCC">JavaScript so logical language for</font>

351
00:12:44,670 --> 00:12:50,939
browsers and then when your ransom

352
00:12:48,720 --> 00:12:52,649
<font color="#E5E5E5">where'd you see something like that</font>

353
00:12:50,939 --> 00:12:54,839
let's take<font color="#CCCCCC"> a look at what this actually</font>

354
00:12:52,649 --> 00:12:56,610
<font color="#CCCCCC">looks</font><font color="#E5E5E5"> like in practice here this is just</font>

355
00:12:54,839 --> 00:12:58,170
<font color="#CCCCCC">a Windows operating system normal</font>

356
00:12:56,610 --> 00:13:01,769
computer oops<font color="#E5E5E5"> that is not what I want</font><font color="#CCCCCC"> to</font>

357
00:12:58,170 --> 00:13:05,759
hit and we've got here<font color="#E5E5E5"> on the desktop</font>

358
00:13:01,769 --> 00:13:07,800
<font color="#CCCCCC">little pay stub dot</font><font color="#E5E5E5"> dot file what's</font>

359
00:13:05,759 --> 00:13:12,389
interesting about<font color="#E5E5E5"> Windows scripting host</font>

360
00:13:07,800 --> 00:13:13,979
is it's<font color="#E5E5E5"> a</font><font color="#CCCCCC"> j/s file but on Windows by</font>

361
00:13:12,389 --> 00:13:15,810
default the file extension is<font color="#E5E5E5"> not</font>

362
00:13:13,980 --> 00:13:17,699
displayed<font color="#E5E5E5"> so you look</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> bottom one</font>

363
00:13:15,810 --> 00:13:20,140
<font color="#E5E5E5">here it's at</font><font color="#CCCCCC"> Gryffindor Jas</font><font color="#E5E5E5"> I've</font>

364
00:13:17,699 --> 00:13:22,270
specifically gone into Windows Explorer

365
00:13:20,140 --> 00:13:24,130
in order to<font color="#E5E5E5"> say view file extensions</font>

366
00:13:22,270 --> 00:13:26,020
your average user is<font color="#E5E5E5"> not</font><font color="#CCCCCC"> going to see</font>

367
00:13:24,130 --> 00:13:27,250
the file extensions on these so they'll

368
00:13:26,020 --> 00:13:29,260
perceive the file extension to<font color="#CCCCCC"> be</font>

369
00:13:27,250 --> 00:13:32,590
<font color="#E5E5E5">whatever</font><font color="#CCCCCC"> I've put in front of</font><font color="#E5E5E5"> that the</font>

370
00:13:29,260 --> 00:13:35,830
days of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> pay stub dot</font><font color="#CCCCCC"> docx dot</font>

371
00:13:32,590 --> 00:13:38,530
<font color="#E5E5E5">J s and for unwitting users this is also</font>

372
00:13:35,830 --> 00:13:39,970
<font color="#E5E5E5">a little interesting because I see the</font>

373
00:13:38,530 --> 00:13:42,400
scroll icon<font color="#CCCCCC"> that doesn't look</font><font color="#E5E5E5"> like the</font>

374
00:13:39,970 --> 00:13:44,080
standard<font color="#E5E5E5"> Microsoft Word icon but then</font>

375
00:13:42,400 --> 00:13:45,730
you've got<font color="#E5E5E5"> WordPad as well and you've</font>

376
00:13:44,080 --> 00:13:47,530
got other<font color="#E5E5E5"> weird file extensions then</font>

377
00:13:45,730 --> 00:13:48,880
maybe aren't too useful<font color="#CCCCCC"> used to they're</font>

378
00:13:47,530 --> 00:13:51,069
definitely not<font color="#E5E5E5"> looking at the</font><font color="#CCCCCC"> icon is</font>

379
00:13:48,880 --> 00:13:53,470
saying this is evil for sure for<font color="#E5E5E5"> sure</font>

380
00:13:51,070 --> 00:13:55,120
<font color="#E5E5E5">for sure just based off that and</font>

381
00:13:53,470 --> 00:13:56,920
certainly<font color="#E5E5E5"> not a hundred</font><font color="#CCCCCC"> percent</font><font color="#E5E5E5"> of the</font>

382
00:13:55,120 --> 00:13:58,510
cases<font color="#E5E5E5"> within your environment</font><font color="#CCCCCC"> we only</font>

383
00:13:56,920 --> 00:14:01,270
need to get<font color="#E5E5E5"> it to execute once</font><font color="#CCCCCC"> in order</font>

384
00:13:58,510 --> 00:14:03,520
to be<font color="#E5E5E5"> in if you double click</font><font color="#CCCCCC"> on this</font>

385
00:14:01,270 --> 00:14:06,130
<font color="#CCCCCC">Windows runs it immediately</font>

386
00:14:03,520 --> 00:14:08,860
this here is JavaScript<font color="#CCCCCC"> and all it says</font>

387
00:14:06,130 --> 00:14:13,689
is start<font color="#CCCCCC"> a W script shell and run</font>

388
00:14:08,860 --> 00:14:15,070
<font color="#CCCCCC">Kalkaji AXI that looks like this so</font>

389
00:14:13,690 --> 00:14:16,780
<font color="#E5E5E5">that's the code that's it just</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> few</font>

390
00:14:15,070 --> 00:14:18,370
lines<font color="#E5E5E5"> in fact if you wanted to make it</font>

391
00:14:16,780 --> 00:14:20,770
simpler<font color="#CCCCCC"> you could even take out the</font>

392
00:14:18,370 --> 00:14:23,740
function definition and just run<font color="#CCCCCC"> the</font>

393
00:14:20,770 --> 00:14:24,939
code<font color="#E5E5E5"> directly very simple and this on</font>

394
00:14:23,740 --> 00:14:26,530
<font color="#E5E5E5">the right here is what it would</font><font color="#CCCCCC"> normally</font>

395
00:14:24,940 --> 00:14:29,170
<font color="#E5E5E5">look</font><font color="#CCCCCC"> like to a user</font><font color="#E5E5E5"> when the file</font>

396
00:14:26,530 --> 00:14:32,110
extensions are hidden<font color="#CCCCCC"> pay stub dock pay</font>

397
00:14:29,170 --> 00:14:33,699
stub docx<font color="#CCCCCC"> pay stub XS</font><font color="#E5E5E5"> LS whatever you</font>

398
00:14:32,110 --> 00:14:36,490
want to call it<font color="#CCCCCC"> for the final extension</font>

399
00:14:33,700 --> 00:14:39,100
<font color="#CCCCCC">the</font><font color="#E5E5E5"> dodging</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> s is invisible</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> makes</font>

400
00:14:36,490 --> 00:14:40,630
it a<font color="#E5E5E5"> powerful technique to use to</font><font color="#CCCCCC"> gain</font>

401
00:14:39,100 --> 00:14:42,340
an initial exploitation that<font color="#E5E5E5"> initial</font>

402
00:14:40,630 --> 00:14:45,490
execution<font color="#E5E5E5"> this is why we see it being</font>

403
00:14:42,340 --> 00:14:48,490
used<font color="#E5E5E5"> by criminal organizations</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> very</font>

404
00:14:45,490 --> 00:14:50,680
frequently<font color="#CCCCCC"> and a good way to look at</font>

405
00:14:48,490 --> 00:14:52,660
these and differentiate them<font color="#E5E5E5"> is to</font>

406
00:14:50,680 --> 00:14:55,780
compare it<font color="#CCCCCC"> to</font><font color="#E5E5E5"> some other way for us get</font>

407
00:14:52,660 --> 00:14:56,949
execution<font color="#CCCCCC"> phishing is often the way that</font>

408
00:14:55,780 --> 00:14:58,750
we'll get something<font color="#E5E5E5"> to run on</font>

409
00:14:56,950 --> 00:15:00,310
environment<font color="#E5E5E5"> just kind of a</font><font color="#CCCCCC"> go-to</font><font color="#E5E5E5"> that'll</font>

410
00:14:58,750 --> 00:15:01,210
work we like<font color="#CCCCCC"> to do a lot of</font><font color="#E5E5E5"> different</font>

411
00:15:00,310 --> 00:15:02,140
<font color="#E5E5E5">things at BHS</font>

412
00:15:01,210 --> 00:15:04,270
to get this<font color="#E5E5E5"> to happen</font><font color="#CCCCCC"> just because</font>

413
00:15:02,140 --> 00:15:06,220
<font color="#E5E5E5">fishing gets boring after</font><font color="#CCCCCC"> a while but</font>

414
00:15:04,270 --> 00:15:07,900
<font color="#E5E5E5">for criminal organization boring still</font>

415
00:15:06,220 --> 00:15:09,610
sells<font color="#E5E5E5"> boring still makes money so we see</font>

416
00:15:07,900 --> 00:15:11,350
a lot of fishing<font color="#CCCCCC"> and when you fish</font>

417
00:15:09,610 --> 00:15:13,120
someone<font color="#CCCCCC"> oftentimes gonna have some kind</font>

418
00:15:11,350 --> 00:15:16,840
<font color="#CCCCCC">of payload some kind of document</font><font color="#E5E5E5"> that</font>

419
00:15:13,120 --> 00:15:18,190
you send in there<font color="#E5E5E5"> this here is my fish</font>

420
00:15:16,840 --> 00:15:19,750
of choice because I'm a really<font color="#E5E5E5"> bad</font>

421
00:15:18,190 --> 00:15:22,390
person<font color="#E5E5E5"> we'll see why here in a second</font>

422
00:15:19,750 --> 00:15:23,920
particularly<font color="#E5E5E5"> around tax season</font><font color="#CCCCCC"> so</font>

423
00:15:22,390 --> 00:15:26,260
normally here on the top<font color="#E5E5E5"> I'll put a logo</font>

424
00:15:23,920 --> 00:15:29,260
<font color="#CCCCCC">of the customer</font><font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> a charitable</font>

425
00:15:26,260 --> 00:15:32,890
charitable donations<font color="#CCCCCC"> XSL X file and it</font>

426
00:15:29,260 --> 00:15:34,089
says hey<font color="#CCCCCC"> it's tax season</font><font color="#E5E5E5"> the company is</font>

427
00:15:32,890 --> 00:15:37,269
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> donate</font><font color="#E5E5E5"> to</font>

428
00:15:34,089 --> 00:15:38,649
charity of your choice here<font color="#E5E5E5"> $400 pick</font>

429
00:15:37,269 --> 00:15:42,550
the three charities<font color="#E5E5E5"> you would like that</font>

430
00:15:38,649 --> 00:15:44,170
$400<font color="#E5E5E5"> be split amongst this works the</font>

431
00:15:42,550 --> 00:15:45,998
<font color="#E5E5E5">reason this works is because if you</font>

432
00:15:44,170 --> 00:15:48,399
<font color="#E5E5E5">don't pick this suddenly your charity</font>

433
00:15:45,999 --> 00:15:51,519
suddenly the Wounded<font color="#CCCCCC"> Warrior</font><font color="#E5E5E5"> Project</font>

434
00:15:48,399 --> 00:15:52,660
<font color="#CCCCCC">isn't getting money so this always</font><font color="#E5E5E5"> works</font>

435
00:15:51,519 --> 00:15:54,610
<font color="#CCCCCC">this</font><font color="#E5E5E5"> works very well in</font><font color="#CCCCCC"> fact</font><font color="#E5E5E5"> this works</font>

436
00:15:52,660 --> 00:15:56,980
so<font color="#CCCCCC"> well that when we do this</font><font color="#E5E5E5"> without</font>

437
00:15:54,610 --> 00:15:58,629
<font color="#E5E5E5">exception</font><font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> get an email back</font><font color="#CCCCCC"> from</font>

438
00:15:56,980 --> 00:16:01,089
some user in the organization<font color="#CCCCCC"> that says</font>

439
00:15:58,629 --> 00:16:02,439
why was I<font color="#CCCCCC"> not consulted on what</font>

440
00:16:01,089 --> 00:16:05,050
charities we're gonna make this list

441
00:16:02,439 --> 00:16:06,699
<font color="#E5E5E5">next</font><font color="#CCCCCC"> year you absolutely must consult us</font>

442
00:16:05,050 --> 00:16:08,139
and add these<font color="#E5E5E5"> three charities</font><font color="#CCCCCC"> you're a</font>

443
00:16:06,699 --> 00:16:08,559
bad<font color="#E5E5E5"> person for not</font><font color="#CCCCCC"> talking to us</font><font color="#E5E5E5"> about</font>

444
00:16:08,139 --> 00:16:12,069
<font color="#CCCCCC">it</font>

445
00:16:08,559 --> 00:16:13,870
Thanks<font color="#CCCCCC"> I know you</font><font color="#E5E5E5"> ran it</font><font color="#CCCCCC"> so what</font><font color="#E5E5E5"> you see</font>

446
00:16:12,069 --> 00:16:15,899
here<font color="#CCCCCC"> is pop-up and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> pop-up</font><font color="#E5E5E5"> is asking</font>

447
00:16:13,870 --> 00:16:19,269
me if I want<font color="#E5E5E5"> to update the Excel</font>

448
00:16:15,899 --> 00:16:20,860
document<font color="#CCCCCC"> click</font><font color="#E5E5E5"> update here it's gonna</font>

449
00:16:19,269 --> 00:16:23,139
give us<font color="#E5E5E5"> another</font><font color="#CCCCCC"> pop-up</font><font color="#E5E5E5"> and this pop-up</font>

450
00:16:20,860 --> 00:16:26,949
says<font color="#E5E5E5"> would you like to start the</font>

451
00:16:23,139 --> 00:16:29,499
<font color="#E5E5E5">application</font><font color="#CCCCCC"> ms excel exe sure i want</font><font color="#E5E5E5"> to</font>

452
00:16:26,949 --> 00:16:32,800
start ms excel we click<font color="#CCCCCC"> yes and now</font><font color="#E5E5E5"> we</font>

453
00:16:29,499 --> 00:16:36,399
have a calc<font color="#E5E5E5"> there's one other step here</font>

454
00:16:32,800 --> 00:16:37,839
<font color="#E5E5E5">for a de based Excel document from</font><font color="#CCCCCC"> a</font>

455
00:16:36,399 --> 00:16:40,209
<font color="#CCCCCC">click perspective and that's</font><font color="#E5E5E5"> the</font>

456
00:16:37,839 --> 00:16:42,249
protected view<font color="#E5E5E5"> so in this case this</font>

457
00:16:40,209 --> 00:16:44,138
document<font color="#E5E5E5"> I wrote myself</font><font color="#CCCCCC"> and I saved it</font>

458
00:16:42,249 --> 00:16:45,339
<font color="#CCCCCC">on</font><font color="#E5E5E5"> to my own disk so protected view</font>

459
00:16:44,139 --> 00:16:47,139
isn't observed<font color="#E5E5E5"> because I made it myself</font>

460
00:16:45,339 --> 00:16:49,240
<font color="#CCCCCC">but</font><font color="#E5E5E5"> if I were</font><font color="#CCCCCC"> to email this to someone</font>

461
00:16:47,139 --> 00:16:51,399
<font color="#E5E5E5">else</font><font color="#CCCCCC"> it's in protected view</font><font color="#E5E5E5"> and there'll</font>

462
00:16:49,240 --> 00:16:54,100
be<font color="#E5E5E5"> this little enable</font><font color="#CCCCCC"> content button</font>

463
00:16:51,399 --> 00:16:56,319
here at the<font color="#E5E5E5"> top now the reason this ruse</font>

464
00:16:54,100 --> 00:16:57,970
says hey I need you to modify<font color="#E5E5E5"> the</font>

465
00:16:56,319 --> 00:16:59,469
<font color="#CCCCCC">document</font><font color="#E5E5E5"> and send it</font><font color="#CCCCCC"> back to me is</font>

466
00:16:57,970 --> 00:17:01,589
because<font color="#CCCCCC"> they</font><font color="#E5E5E5"> have to click enable</font>

467
00:16:59,470 --> 00:17:03,759
<font color="#CCCCCC">content</font><font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to modify the document</font>

468
00:17:01,589 --> 00:17:07,059
<font color="#E5E5E5">there's complexity here and this is</font>

469
00:17:03,759 --> 00:17:08,770
important<font color="#E5E5E5"> I need them now to</font><font color="#CCCCCC"> open</font><font color="#E5E5E5"> the</font>

470
00:17:07,059 --> 00:17:10,389
document<font color="#E5E5E5"> that's a double click then I</font>

471
00:17:08,770 --> 00:17:12,699
need them<font color="#CCCCCC"> to click</font><font color="#E5E5E5"> three different</font>

472
00:17:10,390 --> 00:17:14,079
<font color="#E5E5E5">things edit the document and send it</font>

473
00:17:12,699 --> 00:17:15,339
back<font color="#CCCCCC"> to me and</font><font color="#E5E5E5"> in fact the complexity</font>

474
00:17:14,079 --> 00:17:18,039
goes further because<font color="#E5E5E5"> I had to have a</font>

475
00:17:15,339 --> 00:17:20,289
ruse<font color="#E5E5E5"> that would convince them to do this</font>

476
00:17:18,039 --> 00:17:22,240
<font color="#E5E5E5">in the case of something</font><font color="#CCCCCC"> like Windows</font>

477
00:17:20,289 --> 00:17:25,240
scripting<font color="#CCCCCC"> houseware just run and it done</font>

478
00:17:22,240 --> 00:17:28,949
a lot less<font color="#CCCCCC"> that complexity means</font><font color="#E5E5E5"> a</font>

479
00:17:25,240 --> 00:17:28,949
substantially greater click-through rate

480
00:17:29,850 --> 00:17:34,899
<font color="#E5E5E5">okay</font>

481
00:17:31,360 --> 00:17:37,620
so that sounds bad why would<font color="#E5E5E5"> Microsoft</font>

482
00:17:34,899 --> 00:17:39,969
have done something<font color="#CCCCCC"> like that I mean why</font>

483
00:17:37,620 --> 00:17:41,889
<font color="#CCCCCC">javascript</font><font color="#E5E5E5"> I get it needs to run in the</font>

484
00:17:39,970 --> 00:17:43,809
browser that's<font color="#E5E5E5"> how you tell you make</font>

485
00:17:41,890 --> 00:17:48,429
logic<font color="#CCCCCC"> and</font><font color="#E5E5E5"> your web applications that you</font>

486
00:17:43,809 --> 00:17:49,779
make<font color="#CCCCCC"> html5 web 2.0 nice</font><font color="#E5E5E5"> you know Model</font>

487
00:17:48,429 --> 00:17:52,840
View<font color="#E5E5E5"> controller web applications and all</font>

488
00:17:49,779 --> 00:17:55,600
that jazz makes sense got it but on the

489
00:17:52,840 --> 00:17:57,129
host the<font color="#CCCCCC"> host operating system by</font>

490
00:17:55,600 --> 00:18:00,969
default<font color="#E5E5E5"> double-click on a dot JS file</font>

491
00:17:57,130 --> 00:18:02,919
and it runs it well so who<font color="#CCCCCC"> here's ever</font>

492
00:18:00,970 --> 00:18:04,809
used<font color="#E5E5E5"> mosaics first browser for anyone</font>

493
00:18:02,919 --> 00:18:06,820
<font color="#E5E5E5">yeah a couple folks use mosaic and</font>

494
00:18:04,809 --> 00:18:08,740
Netscape Navigator anyone yeah some

495
00:18:06,820 --> 00:18:10,168
Netscape Navigator in the house<font color="#E5E5E5"> Internet</font>

496
00:18:08,740 --> 00:18:13,480
Explorer your<font color="#E5E5E5"> favorite browser forever</font>

497
00:18:10,169 --> 00:18:17,260
no I got<font color="#CCCCCC"> one or two</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> an explorer</font>

498
00:18:13,480 --> 00:18:18,820
<font color="#E5E5E5">3 so I hope it's not that</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> so this is</font>

499
00:18:17,260 --> 00:18:20,710
actually the generation the genesis of

500
00:18:18,820 --> 00:18:22,870
<font color="#CCCCCC">javascript it</font><font color="#E5E5E5"> was made by the</font><font color="#CCCCCC"> netscape</font>

501
00:18:20,710 --> 00:18:24,760
<font color="#CCCCCC">corporation as part of</font><font color="#E5E5E5"> the initial</font>

502
00:18:22,870 --> 00:18:26,408
browser<font color="#CCCCCC"> Wars</font><font color="#E5E5E5"> we all know the browser</font>

503
00:18:24,760 --> 00:18:28,210
wars are ended<font color="#CCCCCC"> there's the only</font><font color="#E5E5E5"> now the</font>

504
00:18:26,409 --> 00:18:31,740
one true<font color="#CCCCCC"> Bowser known as Microsoft</font><font color="#E5E5E5"> edge</font>

505
00:18:28,210 --> 00:18:33,970
it has one<font color="#CCCCCC"> and is king</font><font color="#E5E5E5"> forever and ever</font>

506
00:18:31,740 --> 00:18:37,330
<font color="#E5E5E5">but it's not a new</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> these browser</font>

507
00:18:33,970 --> 00:18:38,740
<font color="#CCCCCC">Wars</font><font color="#E5E5E5"> Firefox of course is now what would</font>

508
00:18:37,330 --> 00:18:40,480
Netscape Navigator<font color="#CCCCCC"> into turning into</font>

509
00:18:38,740 --> 00:18:43,630
after Internet Explorer and Microsoft

510
00:18:40,480 --> 00:18:46,659
did essentially win the browser war at

511
00:18:43,630 --> 00:18:49,000
the time to<font color="#E5E5E5"> win this though Microsoft</font>

512
00:18:46,659 --> 00:18:50,409
tried everything<font color="#E5E5E5"> they didn't make</font>

513
00:18:49,000 --> 00:18:52,750
JavaScript<font color="#CCCCCC"> heck they didn't even</font><font color="#E5E5E5"> make</font>

514
00:18:50,409 --> 00:18:55,600
<font color="#CCCCCC">HTTP</font><font color="#E5E5E5"> but they said implement implement</font>

515
00:18:52,750 --> 00:18:57,100
implement implement everywhere<font color="#E5E5E5"> and this</font>

516
00:18:55,600 --> 00:18:59,260
is one of<font color="#E5E5E5"> the reasons why the windows</font>

517
00:18:57,100 --> 00:19:00,850
script host and<font color="#E5E5E5"> its consumers throughout</font>

518
00:18:59,260 --> 00:19:03,190
<font color="#E5E5E5">the fabric of Windows operating system</font>

519
00:19:00,850 --> 00:19:06,399
<font color="#CCCCCC">exist</font><font color="#E5E5E5"> and can run things</font><font color="#CCCCCC"> in the weirdest</font>

520
00:19:03,190 --> 00:19:09,399
of places you<font color="#CCCCCC"> can run scripts</font><font color="#E5E5E5"> JavaScript</font>

521
00:19:06,399 --> 00:19:11,559
or Visual Basic<font color="#E5E5E5"> from within</font><font color="#CCCCCC"> WMI</font><font color="#E5E5E5"> you can</font>

522
00:19:09,399 --> 00:19:14,139
run scripts<font color="#E5E5E5"> from JavaScript within run</font>

523
00:19:11,559 --> 00:19:15,158
<font color="#CCCCCC">dll 32</font><font color="#E5E5E5"> you can just</font><font color="#CCCCCC"> double-click on them</font>

524
00:19:14,139 --> 00:19:16,750
<font color="#CCCCCC">and windows scripting host will</font>

525
00:19:15,159 --> 00:19:18,880
automatically<font color="#E5E5E5"> run these scripts there</font>

526
00:19:16,750 --> 00:19:21,250
are so<font color="#E5E5E5"> many different weird random</font>

527
00:19:18,880 --> 00:19:23,320
places<font color="#E5E5E5"> inside Microsoft</font><font color="#CCCCCC"> where you can</font>

528
00:19:21,250 --> 00:19:24,549
run these things<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is why it's</font>

529
00:19:23,320 --> 00:19:28,809
<font color="#E5E5E5">Windows 95</font>

530
00:19:24,549 --> 00:19:31,000
and Internet Explorer<font color="#E5E5E5"> 3 and mosaic thank</font>

531
00:19:28,809 --> 00:19:31,928
goodness<font color="#CCCCCC"> let's</font><font color="#E5E5E5"> talk about any fire is</font>

532
00:19:31,000 --> 00:19:34,000
<font color="#E5E5E5">here for a second</font><font color="#CCCCCC"> because this</font><font color="#E5E5E5"> is</font>

533
00:19:31,929 --> 00:19:36,399
<font color="#CCCCCC">actually a really big</font><font color="#E5E5E5"> reason</font><font color="#CCCCCC"> why we</font><font color="#E5E5E5"> push</font>

534
00:19:34,000 --> 00:19:38,980
to JavaScript here for the purpose of

535
00:19:36,399 --> 00:19:40,658
post exploitation<font color="#E5E5E5"> capability it's nice</font>

536
00:19:38,980 --> 00:19:42,039
that we can<font color="#E5E5E5"> send somebody</font><font color="#CCCCCC"> J's file they</font>

537
00:19:40,659 --> 00:19:43,960
had a<font color="#CCCCCC"> double-click on it</font><font color="#E5E5E5"> and we're</font><font color="#CCCCCC"> in</font>

538
00:19:42,039 --> 00:19:44,800
and that's<font color="#E5E5E5"> and done with no need for</font>

539
00:19:43,960 --> 00:19:46,870
<font color="#CCCCCC">dynamic</font>

540
00:19:44,800 --> 00:19:48,639
<font color="#CCCCCC">teaming exchange or some weird excel</font>

541
00:19:46,870 --> 00:19:50,379
thing<font color="#E5E5E5"> that might get patched out from</font>

542
00:19:48,640 --> 00:19:52,600
under us in the<font color="#E5E5E5"> future as an example</font>

543
00:19:50,380 --> 00:19:54,220
<font color="#E5E5E5">ransomware</font><font color="#CCCCCC"> artists we're using a lot</font><font color="#E5E5E5"> of</font>

544
00:19:52,600 --> 00:19:56,230
dynamic document<font color="#CCCCCC"> exchange as well in</font>

545
00:19:54,220 --> 00:19:57,730
order<font color="#E5E5E5"> to do ransomware attacks but they</font>

546
00:19:56,230 --> 00:20:01,270
were<font color="#E5E5E5"> generally using Microsoft Word for</font>

547
00:19:57,730 --> 00:20:02,980
this<font color="#E5E5E5"> Microsoft patched</font><font color="#CCCCCC"> dde</font><font color="#E5E5E5"> out of</font><font color="#CCCCCC"> Word</font>

548
00:20:01,270 --> 00:20:04,629
<font color="#E5E5E5">the way they patched out of words they</font>

549
00:20:02,980 --> 00:20:04,990
remove the feature it's just not there

550
00:20:04,630 --> 00:20:07,960
<font color="#CCCCCC">anymore</font>

551
00:20:04,990 --> 00:20:09,970
nice patch<font color="#E5E5E5"> but they didn't patch it out</font>

552
00:20:07,960 --> 00:20:12,250
of other components<font color="#CCCCCC"> of the office</font><font color="#E5E5E5"> suite</font>

553
00:20:09,970 --> 00:20:14,260
things like Excel things like<font color="#E5E5E5"> Outlook</font>

554
00:20:12,250 --> 00:20:15,700
<font color="#E5E5E5">things like OneNote so it's still there</font>

555
00:20:14,260 --> 00:20:17,530
<font color="#CCCCCC">a lot of</font><font color="#E5E5E5"> folks think</font><font color="#CCCCCC"> that is not because</font>

556
00:20:15,700 --> 00:20:19,420
<font color="#CCCCCC">I saw the patch went across</font><font color="#E5E5E5"> patch only</font>

557
00:20:17,530 --> 00:20:21,820
<font color="#CCCCCC">effects Microsoft Word</font><font color="#E5E5E5"> when it comes to</font>

558
00:20:19,420 --> 00:20:22,600
JavaScript<font color="#E5E5E5"> well it looks normal when</font>

559
00:20:21,820 --> 00:20:24,850
it's<font color="#E5E5E5"> going across the network</font>

560
00:20:22,600 --> 00:20:26,919
<font color="#CCCCCC">you see</font><font color="#E5E5E5"> JavaScript going across the</font>

561
00:20:24,850 --> 00:20:29,080
network<font color="#E5E5E5"> over port 80 or port 443 the web</font>

562
00:20:26,920 --> 00:20:30,640
application ports<font color="#E5E5E5"> that's pretty normal</font>

563
00:20:29,080 --> 00:20:32,530
<font color="#CCCCCC">you might be able</font><font color="#E5E5E5"> to do something if you</font>

564
00:20:30,640 --> 00:20:34,090
<font color="#E5E5E5">will</font><font color="#CCCCCC"> save</font><font color="#E5E5E5"> vbscript that looks maybe a</font>

565
00:20:32,530 --> 00:20:35,590
little<font color="#E5E5E5"> weird if that's being uploaded or</font>

566
00:20:34,090 --> 00:20:37,959
downloaded within the network<font color="#E5E5E5"> but</font>

567
00:20:35,590 --> 00:20:40,770
<font color="#CCCCCC">JavaScript Java scripts very</font><font color="#E5E5E5"> ubiquitous</font>

568
00:20:37,960 --> 00:20:44,050
<font color="#CCCCCC">we absolutely see that all</font><font color="#E5E5E5"> of the time</font>

569
00:20:40,770 --> 00:20:45,240
when<font color="#E5E5E5"> it comes to antivirus here we've</font>

570
00:20:44,050 --> 00:20:47,290
<font color="#E5E5E5">got a lot of signature based detection</font>

571
00:20:45,240 --> 00:20:49,150
mechanism<font color="#E5E5E5"> that's a traditional</font><font color="#CCCCCC"> way to do</font>

572
00:20:47,290 --> 00:20:50,770
things<font color="#CCCCCC"> I'm not really gonna bash on</font>

573
00:20:49,150 --> 00:20:51,610
antivirus there's there some problems

574
00:20:50,770 --> 00:20:53,650
<font color="#CCCCCC">that we've gotten the community</font>

575
00:20:51,610 --> 00:20:55,179
revolving around antivirus<font color="#CCCCCC"> but I'm not</font>

576
00:20:53,650 --> 00:20:56,950
gonna bash on it as a tool I'm not gonna

577
00:20:55,180 --> 00:20:58,570
<font color="#E5E5E5">say any virus it's dead I think there's</font>

578
00:20:56,950 --> 00:20:59,890
some serious problems there I<font color="#E5E5E5"> think</font>

579
00:20:58,570 --> 00:21:03,310
we're definitely still<font color="#CCCCCC"> in a signature</font>

580
00:20:59,890 --> 00:21:06,160
<font color="#E5E5E5">based detection space even if marketing</font>

581
00:21:03,310 --> 00:21:08,860
tells you otherwise<font color="#E5E5E5"> signature based</font>

582
00:21:06,160 --> 00:21:10,570
detection<font color="#E5E5E5"> has done really well over the</font>

583
00:21:08,860 --> 00:21:12,669
past<font color="#E5E5E5"> several months</font><font color="#CCCCCC"> use Windows</font><font color="#E5E5E5"> Defender</font>

584
00:21:10,570 --> 00:21:14,050
<font color="#CCCCCC">the past ever once it is absolutely</font><font color="#E5E5E5"> on</font>

585
00:21:12,670 --> 00:21:14,620
the ball if<font color="#E5E5E5"> it knows about something</font>

586
00:21:14,050 --> 00:21:18,760
<font color="#E5E5E5">that's bad</font>

587
00:21:14,620 --> 00:21:21,399
the way<font color="#E5E5E5"> to get past it</font><font color="#CCCCCC"> is magic you know</font>

588
00:21:18,760 --> 00:21:23,080
do wizard<font color="#E5E5E5"> ants</font><font color="#CCCCCC"> and it changes</font><font color="#E5E5E5"> all the</font>

589
00:21:21,400 --> 00:21:24,220
<font color="#E5E5E5">time</font><font color="#CCCCCC"> so for us</font><font color="#E5E5E5"> at Black Hills we're</font>

590
00:21:23,080 --> 00:21:26,139
spending a substantial amount<font color="#E5E5E5"> of time</font>

591
00:21:24,220 --> 00:21:27,940
<font color="#E5E5E5">these days getting execution of the</font>

592
00:21:26,140 --> 00:21:30,820
tools we traditionally use<font color="#CCCCCC"> like cobalt</font>

593
00:21:27,940 --> 00:21:32,380
strike or meterpreter from<font color="#CCCCCC"> Metasploit</font><font color="#E5E5E5"> or</font>

594
00:21:30,820 --> 00:21:34,870
<font color="#CCCCCC">PowerShell Empire spent a lot of time</font>

595
00:21:32,380 --> 00:21:36,790
just<font color="#CCCCCC"> getting those things</font><font color="#E5E5E5"> to run</font><font color="#CCCCCC"> and if</font>

596
00:21:34,870 --> 00:21:38,139
we need to<font color="#CCCCCC"> send</font><font color="#E5E5E5"> somebody a phishing</font>

597
00:21:36,790 --> 00:21:40,120
message every<font color="#CCCCCC"> time one of these things</font>

598
00:21:38,140 --> 00:21:41,410
needs<font color="#CCCCCC"> to run well</font><font color="#E5E5E5"> it's inefficient</font>

599
00:21:40,120 --> 00:21:43,840
that's horrible we're gonna be in a

600
00:21:41,410 --> 00:21:45,340
<font color="#CCCCCC">really bad space here we're also</font><font color="#E5E5E5"> be</font>

601
00:21:43,840 --> 00:21:47,050
wasting a lot of<font color="#CCCCCC"> the customers time and</font>

602
00:21:45,340 --> 00:21:48,939
<font color="#E5E5E5">dollars if we're</font><font color="#CCCCCC"> doing this all</font><font color="#E5E5E5"> of the</font>

603
00:21:47,050 --> 00:21:51,639
time<font color="#E5E5E5"> this is because antivirus has</font>

604
00:21:48,940 --> 00:21:53,620
focused very very heavily<font color="#E5E5E5"> on the tools</font>

605
00:21:51,640 --> 00:21:55,600
that<font color="#E5E5E5"> we use this makes sense if</font><font color="#CCCCCC"> you</font>

606
00:21:53,620 --> 00:21:59,100
<font color="#CCCCCC">think</font><font color="#E5E5E5"> about it right if I'm a vendor and</font>

607
00:21:55,600 --> 00:22:00,840
I need to sell<font color="#E5E5E5"> my antivirus product to</font>

608
00:21:59,100 --> 00:22:02,429
probably not Microsoft<font color="#E5E5E5"> comm because</font>

609
00:22:00,840 --> 00:22:03,360
Microsoft<font color="#E5E5E5"> makes their own</font><font color="#CCCCCC"> though you'd</font>

610
00:22:02,430 --> 00:22:05,900
be surprised

611
00:22:03,360 --> 00:22:09,199
<font color="#CCCCCC">they get</font><font color="#E5E5E5"> so my</font><font color="#CCCCCC"> antivirus solution</font><font color="#E5E5E5"> to</font>

612
00:22:05,900 --> 00:22:12,270
General Motors I want them to<font color="#E5E5E5"> buy it</font><font color="#CCCCCC"> ok</font>

613
00:22:09,200 --> 00:22:14,520
if GM says we want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> test out how</font>

614
00:22:12,270 --> 00:22:15,990
effective<font color="#CCCCCC"> this is what do they do they</font>

615
00:22:14,520 --> 00:22:17,100
might grab a pen tester and<font color="#E5E5E5"> say hey come</font>

616
00:22:15,990 --> 00:22:19,440
pen test this<font color="#CCCCCC"> thing can you</font><font color="#E5E5E5"> get it to</font>

617
00:22:17,100 --> 00:22:21,360
<font color="#E5E5E5">work if you beat the pen tester you must</font>

618
00:22:19,440 --> 00:22:23,160
be a<font color="#E5E5E5"> really good antivirus solution and</font>

619
00:22:21,360 --> 00:22:24,959
this<font color="#E5E5E5"> is where we start to get into</font>

620
00:22:23,160 --> 00:22:29,850
<font color="#CCCCCC">pretty dangerous space as penetration</font>

621
00:22:24,960 --> 00:22:31,230
testers<font color="#E5E5E5"> because we get beat by</font><font color="#CCCCCC"> AV is the</font>

622
00:22:29,850 --> 00:22:34,050
<font color="#CCCCCC">attacker</font><font color="#E5E5E5"> the adversary the real</font>

623
00:22:31,230 --> 00:22:35,850
<font color="#CCCCCC">intrusion set also getting</font><font color="#E5E5E5"> beat by AV</font>

624
00:22:34,050 --> 00:22:39,120
and if we're not iterating our<font color="#E5E5E5"> toolkit</font>

625
00:22:35,850 --> 00:22:40,980
the answer is going<font color="#E5E5E5"> to be no and we</font>

626
00:22:39,120 --> 00:22:44,250
can't give our customers that false

627
00:22:40,980 --> 00:22:45,900
sense of security<font color="#E5E5E5"> by actually happening</font>

628
00:22:44,250 --> 00:22:47,130
<font color="#CCCCCC">so be</font><font color="#E5E5E5"> very careful here about vendor</font>

629
00:22:45,900 --> 00:22:49,230
marketing because a lot of<font color="#E5E5E5"> the</font>

630
00:22:47,130 --> 00:22:52,320
<font color="#CCCCCC">terminology is just simply</font><font color="#E5E5E5"> incorrect or</font>

631
00:22:49,230 --> 00:22:54,150
ludicrously overblown<font color="#E5E5E5"> that doesn't mean</font>

632
00:22:52,320 --> 00:22:55,620
<font color="#CCCCCC">that the engineers in those</font>

633
00:22:54,150 --> 00:22:56,880
<font color="#CCCCCC">organizations those antivirus companies</font>

634
00:22:55,620 --> 00:22:58,199
are bad<font color="#E5E5E5"> I've had some really good</font>

635
00:22:56,880 --> 00:22:59,730
<font color="#CCCCCC">friends in</font><font color="#E5E5E5"> Symantec I know a lot of</font>

636
00:22:58,200 --> 00:23:01,920
<font color="#E5E5E5">people carbon black they're doing some</font>

637
00:22:59,730 --> 00:23:02,970
<font color="#E5E5E5">wonderful stuff</font><font color="#CCCCCC"> Black Hills</font><font color="#E5E5E5"> is love-hate</font>

638
00:23:01,920 --> 00:23:05,040
relationship with silence

639
00:23:02,970 --> 00:23:09,990
they send<font color="#CCCCCC"> JA fire beers</font><font color="#E5E5E5"> every now and</font>

640
00:23:05,040 --> 00:23:11,970
then<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> smart guys and they're</font>

641
00:23:09,990 --> 00:23:13,530
<font color="#E5E5E5">doing good work</font><font color="#CCCCCC"> but the work isn't</font>

642
00:23:11,970 --> 00:23:15,570
necessarily<font color="#E5E5E5"> affecting the problem and</font>

643
00:23:13,530 --> 00:23:16,860
<font color="#E5E5E5">that we're experiencing</font><font color="#CCCCCC"> I'm not saying</font>

644
00:23:15,570 --> 00:23:18,629
that they need<font color="#CCCCCC"> to not</font><font color="#E5E5E5"> focus on things a</font>

645
00:23:16,860 --> 00:23:20,760
cobalt strike<font color="#CCCCCC"> if I'm an intrusion set</font>

646
00:23:18,630 --> 00:23:22,800
and cobalt strike works<font color="#CCCCCC"> I will</font>

647
00:23:20,760 --> 00:23:24,720
<font color="#CCCCCC">absolutely use that because I'm not</font>

648
00:23:22,800 --> 00:23:26,220
worried about<font color="#E5E5E5"> burning my</font><font color="#CCCCCC"> toolkit</font><font color="#E5E5E5"> if I'm</font>

649
00:23:24,720 --> 00:23:28,350
<font color="#E5E5E5">using something that's</font><font color="#CCCCCC"> open source or</font>

650
00:23:26,220 --> 00:23:30,240
something<font color="#CCCCCC"> that I can pay for if</font><font color="#E5E5E5"> Cola Ike</font>

651
00:23:28,350 --> 00:23:32,459
<font color="#E5E5E5">doesn't work though then I need to do</font>

652
00:23:30,240 --> 00:23:34,290
something<font color="#E5E5E5"> else and first</font><font color="#CCCCCC"> as penetration</font>

653
00:23:32,460 --> 00:23:35,760
<font color="#E5E5E5">testers we have to</font><font color="#CCCCCC"> also be able to</font><font color="#E5E5E5"> take</font>

654
00:23:34,290 --> 00:23:38,610
<font color="#CCCCCC">that</font><font color="#E5E5E5"> next step we need</font><font color="#CCCCCC"> to be able to do</font>

655
00:23:35,760 --> 00:23:39,750
<font color="#CCCCCC">something else</font><font color="#E5E5E5"> as well</font><font color="#CCCCCC"> it's a behavioral</font>

656
00:23:38,610 --> 00:23:41,820
detection<font color="#E5E5E5"> this is one of those big</font>

657
00:23:39,750 --> 00:23:42,980
<font color="#CCCCCC">buzzwords most</font><font color="#E5E5E5"> the implementations of</font>

658
00:23:41,820 --> 00:23:45,629
<font color="#E5E5E5">behavioral detection are actually</font>

659
00:23:42,980 --> 00:23:47,430
signatures of a pattern of behavior<font color="#CCCCCC"> so</font>

660
00:23:45,630 --> 00:23:48,630
<font color="#CCCCCC">it's not a signature for one thing but</font>

661
00:23:47,430 --> 00:23:50,700
<font color="#E5E5E5">it's two or</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> things linked together</font>

662
00:23:48,630 --> 00:23:52,050
<font color="#E5E5E5">and a signature for that it's still a</font>

663
00:23:50,700 --> 00:23:54,570
signature based detection mechanism

664
00:23:52,050 --> 00:23:56,070
<font color="#E5E5E5">that's not really a behavior but you'll</font>

665
00:23:54,570 --> 00:23:59,580
hear it<font color="#E5E5E5"> called that all the time</font><font color="#CCCCCC"> and</font>

666
00:23:56,070 --> 00:24:02,189
then anomaly detection<font color="#E5E5E5"> is cool it's also</font>

667
00:23:59,580 --> 00:24:04,169
very very<font color="#E5E5E5"> hype centric I think an almost</font>

668
00:24:02,190 --> 00:24:05,610
based detection<font color="#CCCCCC"> is going to be a really</font>

669
00:24:04,170 --> 00:24:07,320
cool<font color="#CCCCCC"> thing that emerges over</font><font color="#E5E5E5"> the next</font>

670
00:24:05,610 --> 00:24:09,120
five<font color="#E5E5E5"> to twenty years and I think you</font>

671
00:24:07,320 --> 00:24:11,250
might<font color="#E5E5E5"> have a</font><font color="#CCCCCC"> little bit of growth there</font>

672
00:24:09,120 --> 00:24:13,770
as we get more into<font color="#E5E5E5"> and more understand</font>

673
00:24:11,250 --> 00:24:16,050
of<font color="#E5E5E5"> machine based learning we're not</font>

674
00:24:13,770 --> 00:24:18,120
there<font color="#CCCCCC"> yet</font><font color="#E5E5E5"> we're not</font><font color="#CCCCCC"> even close to</font><font color="#E5E5E5"> there</font>

675
00:24:16,050 --> 00:24:22,169
yet<font color="#E5E5E5"> most these anomalous based solutions</font>

676
00:24:18,120 --> 00:24:23,939
are hot air so if a<font color="#CCCCCC"> bee beats your</font>

677
00:24:22,170 --> 00:24:28,800
<font color="#E5E5E5">pentesters does that mean you're safe</font>

678
00:24:23,940 --> 00:24:30,690
<font color="#E5E5E5">hopefully</font><font color="#CCCCCC"> the answer is yes</font><font color="#E5E5E5"> but security</font>

679
00:24:28,800 --> 00:24:34,200
is<font color="#E5E5E5"> not mathematically</font><font color="#CCCCCC"> provable not</font>

680
00:24:30,690 --> 00:24:35,340
directly<font color="#E5E5E5"> and things might</font><font color="#CCCCCC"> come out this</font>

681
00:24:34,200 --> 00:24:37,110
<font color="#E5E5E5">is one of the reasons why officers often</font>

682
00:24:35,340 --> 00:24:38,459
<font color="#E5E5E5">emphasize that onion model of security</font>

683
00:24:37,110 --> 00:24:40,139
where<font color="#E5E5E5"> you layer these security controls</font>

684
00:24:38,460 --> 00:24:41,250
<font color="#E5E5E5">and in many cases what you'll do is</font>

685
00:24:40,140 --> 00:24:42,990
you'll give your penetration<font color="#E5E5E5"> testers a</font>

686
00:24:41,250 --> 00:24:44,850
leg up and say<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> the antivirus</font>

687
00:24:42,990 --> 00:24:46,500
defeated you but what happens if it

688
00:24:44,850 --> 00:24:47,820
<font color="#CCCCCC">doesn't</font><font color="#E5E5E5"> because we want to know</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> -</font>

689
00:24:46,500 --> 00:24:50,070
<font color="#E5E5E5">we want to know if you're stopped</font><font color="#CCCCCC"> during</font>

690
00:24:47,820 --> 00:24:53,340
the next<font color="#E5E5E5"> stage the</font><font color="#CCCCCC"> next phases</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> well</font>

691
00:24:50,070 --> 00:24:55,950
so vendors of course they're trying<font color="#E5E5E5"> not</font>

692
00:24:53,340 --> 00:24:56,699
to<font color="#E5E5E5"> have that conversation</font><font color="#CCCCCC"> they want</font><font color="#E5E5E5"> to</font>

693
00:24:55,950 --> 00:24:59,580
look<font color="#E5E5E5"> good</font>

694
00:24:56,700 --> 00:25:01,620
to sell product<font color="#E5E5E5"> their businesses</font><font color="#CCCCCC"> this</font>

695
00:24:59,580 --> 00:25:03,000
happens for<font color="#E5E5E5"> us as penetration testers</font>

696
00:25:01,620 --> 00:25:06,209
though we need<font color="#E5E5E5"> to be aware of this and</font>

697
00:25:03,000 --> 00:25:08,190
<font color="#CCCCCC">we absolutely</font><font color="#E5E5E5"> need to be able to perform</font>

698
00:25:06,210 --> 00:25:12,390
at the same<font color="#CCCCCC"> level as attackers who</font><font color="#E5E5E5"> are</font>

699
00:25:08,190 --> 00:25:13,860
using custom and homegrown tools so this

700
00:25:12,390 --> 00:25:15,930
is an example of<font color="#E5E5E5"> that this</font><font color="#CCCCCC"> is actually</font>

701
00:25:13,860 --> 00:25:18,209
code written<font color="#E5E5E5"> by Joe fire with black</font>

702
00:25:15,930 --> 00:25:19,740
<font color="#CCCCCC">holes</font><font color="#E5E5E5"> to defeat silence so science had a</font>

703
00:25:18,210 --> 00:25:21,420
behavioral based detection mechanism

704
00:25:19,740 --> 00:25:23,910
that essentially would trap on

705
00:25:21,420 --> 00:25:25,950
meterpreter<font color="#E5E5E5"> when</font><font color="#CCCCCC"> mature / made a call to</font>

706
00:25:23,910 --> 00:25:27,450
create<font color="#E5E5E5"> threat this isn't really going</font>

707
00:25:25,950 --> 00:25:30,210
<font color="#E5E5E5">after the behavior</font><font color="#CCCCCC"> or the existence</font><font color="#E5E5E5"> or</font>

708
00:25:27,450 --> 00:25:31,920
the what is of meterpreter<font color="#CCCCCC"> Metasploit</font>

709
00:25:30,210 --> 00:25:33,780
<font color="#E5E5E5">backdoor this is going after</font><font color="#CCCCCC"> a very</font>

710
00:25:31,920 --> 00:25:36,480
<font color="#E5E5E5">specific call this is very much</font><font color="#CCCCCC"> a</font>

711
00:25:33,780 --> 00:25:37,920
signature<font color="#E5E5E5"> swapping that call to memory</font>

712
00:25:36,480 --> 00:25:40,530
mapping<font color="#E5E5E5"> and memory</font><font color="#CCCCCC"> mapping the</font><font color="#E5E5E5"> shell</font>

713
00:25:37,920 --> 00:25:42,570
<font color="#E5E5E5">code before invocation</font><font color="#CCCCCC"> by passive</font>

714
00:25:40,530 --> 00:25:44,760
silence<font color="#CCCCCC"> I haven't done this</font><font color="#E5E5E5"> quite</font>

715
00:25:42,570 --> 00:25:47,429
recently<font color="#E5E5E5"> but talking the</font><font color="#CCCCCC"> job I'm pretty</font>

716
00:25:44,760 --> 00:25:49,350
sure<font color="#E5E5E5"> this still works today</font><font color="#CCCCCC"> and you're</font>

717
00:25:47,430 --> 00:25:51,330
bypassing<font color="#E5E5E5"> antivirus vendor</font><font color="#CCCCCC"> that way of</font>

718
00:25:49,350 --> 00:25:54,149
<font color="#E5E5E5">course this is a dedicated specific</font>

719
00:25:51,330 --> 00:25:55,649
bypass<font color="#E5E5E5"> for a specific</font><font color="#CCCCCC"> vendor if you do</font>

720
00:25:54,150 --> 00:25:58,110
this for every vendor that<font color="#E5E5E5"> you encounter</font>

721
00:25:55,650 --> 00:26:00,650
on every test ever<font color="#E5E5E5"> and when you publish</font>

722
00:25:58,110 --> 00:26:02,850
this they send you beer and fix it

723
00:26:00,650 --> 00:26:04,200
<font color="#E5E5E5">that's not something that's death that's</font>

724
00:26:02,850 --> 00:26:06,149
generally sustainable this<font color="#E5E5E5"> has</font><font color="#CCCCCC"> become a</font>

725
00:26:04,200 --> 00:26:07,320
bit<font color="#E5E5E5"> of a conundrum for</font><font color="#CCCCCC"> us at Black Hills</font>

726
00:26:06,150 --> 00:26:09,060
because<font color="#E5E5E5"> we really like to give back to</font>

727
00:26:07,320 --> 00:26:10,980
the community<font color="#CCCCCC"> contribute</font><font color="#E5E5E5"> over source and</font>

728
00:26:09,060 --> 00:26:13,590
<font color="#E5E5E5">just about everything that we do but</font>

729
00:26:10,980 --> 00:26:17,550
we've still<font color="#CCCCCC"> got that need and that</font>

730
00:26:13,590 --> 00:26:20,159
requirement<font color="#E5E5E5"> to effectively do what's</font>

731
00:26:17,550 --> 00:26:22,770
best for<font color="#E5E5E5"> our customers</font><font color="#CCCCCC"> so we can't lose</font>

732
00:26:20,160 --> 00:26:24,630
to<font color="#CCCCCC"> antivirus that</font><font color="#E5E5E5"> we know another</font>

733
00:26:22,770 --> 00:26:27,810
intrusion set isn't<font color="#E5E5E5"> going to lose too</font>

734
00:26:24,630 --> 00:26:29,670
<font color="#E5E5E5">this means considering holding back some</font>

735
00:26:27,810 --> 00:26:31,740
of those latest<font color="#E5E5E5"> techniques and starting</font>

736
00:26:29,670 --> 00:26:33,090
to stockpile<font color="#CCCCCC"> this is a bad idea this</font>

737
00:26:31,740 --> 00:26:34,800
isn't a place<font color="#CCCCCC"> that we want the world to</font>

738
00:26:33,090 --> 00:26:36,090
be<font color="#CCCCCC"> in but it</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> something that we have</font>

739
00:26:34,800 --> 00:26:38,040
to<font color="#E5E5E5"> consider as penetration testers</font>

740
00:26:36,090 --> 00:26:40,470
<font color="#CCCCCC">because he absolutely need to be able to</font>

741
00:26:38,040 --> 00:26:42,149
<font color="#E5E5E5">affect the proper amount of value</font><font color="#CCCCCC"> that</font>

742
00:26:40,470 --> 00:26:46,320
we've been hired to<font color="#E5E5E5"> perform when doing</font>

743
00:26:42,150 --> 00:26:49,770
testing so when it comes to<font color="#CCCCCC"> antivirus</font>

744
00:26:46,320 --> 00:26:51,689
<font color="#CCCCCC">they've got one job and it's to stop</font><font color="#E5E5E5"> bad</font>

745
00:26:49,770 --> 00:26:53,310
stuff<font color="#CCCCCC"> from</font><font color="#E5E5E5"> happening they focus on a</font>

746
00:26:51,690 --> 00:26:55,680
<font color="#E5E5E5">problem that isn't necessarily the right</font>

747
00:26:53,310 --> 00:26:58,310
problem but they do have a place in<font color="#E5E5E5"> our</font>

748
00:26:55,680 --> 00:27:01,080
<font color="#CCCCCC">Information Security</font><font color="#E5E5E5"> calculus</font>

749
00:26:58,310 --> 00:27:02,970
so these evasion in detection games are

750
00:27:01,080 --> 00:27:05,550
detracting I think from the overarching

751
00:27:02,970 --> 00:27:06,720
security opportunity for many<font color="#CCCCCC"> customers</font>

752
00:27:05,550 --> 00:27:08,580
<font color="#E5E5E5">we have to kind of be aware</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> that</font>

753
00:27:06,720 --> 00:27:10,470
<font color="#E5E5E5">specifically</font><font color="#CCCCCC"> because I'm seeing</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

754
00:27:08,580 --> 00:27:13,470
<font color="#E5E5E5">folks taking away a false sense of</font>

755
00:27:10,470 --> 00:27:15,270
<font color="#E5E5E5">security because</font><font color="#CCCCCC"> the penetration</font><font color="#E5E5E5"> tester</font>

756
00:27:13,470 --> 00:27:17,490
failed<font color="#E5E5E5"> or they fail at some stage the</font>

757
00:27:15,270 --> 00:27:18,870
<font color="#CCCCCC">compromise</font><font color="#E5E5E5"> this is already a dangerous</font>

758
00:27:17,490 --> 00:27:21,330
<font color="#E5E5E5">problem that you see happen all the</font><font color="#CCCCCC"> time</font>

759
00:27:18,870 --> 00:27:23,610
<font color="#E5E5E5">when the pen tester didn't fail</font>

760
00:27:21,330 --> 00:27:25,830
where they say well actually in a

761
00:27:23,610 --> 00:27:27,449
<font color="#E5E5E5">real-world</font><font color="#CCCCCC"> situation it wouldn't have</font>

762
00:27:25,830 --> 00:27:28,980
worked<font color="#E5E5E5"> out quite that way or he</font>

763
00:27:27,450 --> 00:27:31,530
accidentally<font color="#E5E5E5"> gave you a little</font><font color="#CCCCCC"> bit too</font>

764
00:27:28,980 --> 00:27:33,330
much access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the system well the</font>

765
00:27:31,530 --> 00:27:35,100
attacker who targeted that one user over

766
00:27:33,330 --> 00:27:36,480
there via phishing that user<font color="#E5E5E5"> you also</font>

767
00:27:35,100 --> 00:27:37,409
<font color="#E5E5E5">gave a</font><font color="#CCCCCC"> little too much</font><font color="#E5E5E5"> access the system</font>

768
00:27:36,480 --> 00:27:39,960
and therefore<font color="#E5E5E5"> the</font><font color="#CCCCCC"> system is now</font>

769
00:27:37,410 --> 00:27:41,640
compromised<font color="#CCCCCC"> as a result of other user</font>

770
00:27:39,960 --> 00:27:43,130
permissions<font color="#E5E5E5"> other user controls a</font>

771
00:27:41,640 --> 00:27:45,630
<font color="#E5E5E5">zero-day is not what's necessary to</font>

772
00:27:43,130 --> 00:27:46,890
<font color="#E5E5E5">compromise an organization and really</font>

773
00:27:45,630 --> 00:27:48,900
there might just<font color="#E5E5E5"> be</font><font color="#CCCCCC"> a waste of your time</font>

774
00:27:46,890 --> 00:27:50,340
<font color="#CCCCCC">if you're going after an organization</font><font color="#E5E5E5"> so</font>

775
00:27:48,900 --> 00:27:51,660
this whole false sense of security

776
00:27:50,340 --> 00:27:53,250
it's something<font color="#E5E5E5"> that we want</font><font color="#CCCCCC"> to have</font>

777
00:27:51,660 --> 00:27:54,690
absolutely<font color="#E5E5E5"> want to have</font><font color="#CCCCCC"> that sense of</font>

778
00:27:53,250 --> 00:27:56,520
<font color="#E5E5E5">security</font><font color="#CCCCCC"> we want to stick our head in</font>

779
00:27:54,690 --> 00:27:59,490
the<font color="#CCCCCC"> sand and pretend</font><font color="#E5E5E5"> like things are</font>

780
00:27:56,520 --> 00:28:02,220
good we absolutely want<font color="#E5E5E5"> to that's just</font>

781
00:27:59,490 --> 00:28:04,410
visceral<font color="#E5E5E5"> however if we're going to do</font>

782
00:28:02,220 --> 00:28:06,690
right we absolutely have to<font color="#E5E5E5"> break that</font>

783
00:28:04,410 --> 00:28:08,430
<font color="#E5E5E5">and make sure</font><font color="#CCCCCC"> that we have a good</font>

784
00:28:06,690 --> 00:28:11,160
<font color="#CCCCCC">understanding of where we are security</font>

785
00:28:08,430 --> 00:28:11,430
wise be it for the better or<font color="#E5E5E5"> for the</font>

786
00:28:11,160 --> 00:28:13,110
worse

787
00:28:11,430 --> 00:28:15,420
<font color="#CCCCCC">we're outstanding and we know we're</font>

788
00:28:13,110 --> 00:28:16,889
outstanding we know where our<font color="#E5E5E5"> edges lie</font>

789
00:28:15,420 --> 00:28:19,770
where we've got some weaknesses that's

790
00:28:16,890 --> 00:28:21,870
great<font color="#CCCCCC"> if we're</font><font color="#E5E5E5"> not doing so hot but we</font>

791
00:28:19,770 --> 00:28:24,030
know it<font color="#E5E5E5"> that's still better than not</font>

792
00:28:21,870 --> 00:28:24,750
doing<font color="#CCCCCC"> very</font><font color="#E5E5E5"> well and not knowing anything</font>

793
00:28:24,030 --> 00:28:26,610
about<font color="#E5E5E5"> it at all</font>

794
00:28:24,750 --> 00:28:28,440
<font color="#CCCCCC">it's penetration testers we have to make</font>

795
00:28:26,610 --> 00:28:30,479
<font color="#E5E5E5">sure that</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> gets communicated across</font>

796
00:28:28,440 --> 00:28:33,510
<font color="#E5E5E5">to our customers and</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> don't lead</font>

797
00:28:30,480 --> 00:28:35,460
them into this mind<font color="#CCCCCC"> problem</font><font color="#E5E5E5"> this mind</font>

798
00:28:33,510 --> 00:28:37,950
trap<font color="#E5E5E5"> where they think they're more</font>

799
00:28:35,460 --> 00:28:38,560
secure than they actually are<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font>

800
00:28:37,950 --> 00:28:40,510
<font color="#CCCCCC">real</font>

801
00:28:38,560 --> 00:28:44,080
so if we want to do something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> this</font>

802
00:28:40,510 --> 00:28:47,500
if we want to<font color="#E5E5E5"> bypass these protection</font>

803
00:28:44,080 --> 00:28:50,080
mechanisms antivirus is targeting what

804
00:28:47,500 --> 00:28:53,020
it knows to<font color="#E5E5E5"> be bad</font><font color="#CCCCCC"> and so if we target</font>

805
00:28:50,080 --> 00:28:54,250
<font color="#E5E5E5">what we know to be good because much</font>

806
00:28:53,020 --> 00:28:56,260
more difficult for antivirus<font color="#CCCCCC"> you go</font>

807
00:28:54,250 --> 00:28:58,060
after<font color="#E5E5E5"> you when it comes to the top</font><font color="#CCCCCC"> 10%</font>

808
00:28:56,260 --> 00:28:59,350
<font color="#E5E5E5">of</font><font color="#CCCCCC"> organizations some of the defenses</font>

809
00:28:58,060 --> 00:29:01,120
<font color="#CCCCCC">that we see them put in place that are</font>

810
00:28:59,350 --> 00:29:03,370
absolutely<font color="#E5E5E5"> outstanding and</font><font color="#CCCCCC"> very good</font><font color="#E5E5E5"> are</font>

811
00:29:01,120 --> 00:29:05,320
focused<font color="#E5E5E5"> host based or network based</font>

812
00:29:03,370 --> 00:29:07,570
<font color="#E5E5E5">oftentimes there are human involved</font>

813
00:29:05,320 --> 00:29:09,220
doing analysis<font color="#E5E5E5"> might be</font><font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> based</font>

814
00:29:07,570 --> 00:29:11,220
analytics on what the<font color="#E5E5E5"> processes on</font><font color="#CCCCCC"> the</font>

815
00:29:09,220 --> 00:29:13,330
systems are<font color="#E5E5E5"> doing for</font><font color="#CCCCCC"> example if</font>

816
00:29:11,220 --> 00:29:14,920
PowerShell that exe is<font color="#E5E5E5"> constantly</font>

817
00:29:13,330 --> 00:29:16,179
<font color="#E5E5E5">calling out to a random IP address on</font>

818
00:29:14,920 --> 00:29:18,630
the<font color="#CCCCCC"> Internet from one of the hosts</font>

819
00:29:16,180 --> 00:29:20,290
inside your environment it's not<font color="#CCCCCC"> okay</font>

820
00:29:18,630 --> 00:29:21,460
<font color="#CCCCCC">might want to talk</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> your domain</font>

821
00:29:20,290 --> 00:29:23,200
administrators maybe somebody wrote a

822
00:29:21,460 --> 00:29:26,890
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> script that's doing that it's</font>

823
00:29:23,200 --> 00:29:29,320
weird<font color="#E5E5E5"> but maybe it happened if spools V</font>

824
00:29:26,890 --> 00:29:30,550
dot exe is beaconing out to some random

825
00:29:29,320 --> 00:29:32,950
IP address<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the internet that's your</font>

826
00:29:30,550 --> 00:29:34,020
principal<font color="#CCCCCC"> ur</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> that's probably</font>

827
00:29:32,950 --> 00:29:37,270
<font color="#E5E5E5">not</font><font color="#CCCCCC"> okay</font>

828
00:29:34,020 --> 00:29:39,520
probably pwned<font color="#E5E5E5"> this is a great way for</font>

829
00:29:37,270 --> 00:29:41,230
defenders to really get in on the<font color="#CCCCCC"> hosts</font>

830
00:29:39,520 --> 00:29:42,879
<font color="#E5E5E5">get in</font><font color="#CCCCCC"> on the weeds</font><font color="#E5E5E5"> and start to find</font>

831
00:29:41,230 --> 00:29:45,070
bad stuff<font color="#E5E5E5"> that's happening looking for</font>

832
00:29:42,880 --> 00:29:46,150
the<font color="#E5E5E5"> host processes are doing those</font>

833
00:29:45,070 --> 00:29:48,370
processes probably have no business

834
00:29:46,150 --> 00:29:50,830
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> other side the network as</font>

835
00:29:48,370 --> 00:29:52,360
well is<font color="#E5E5E5"> that same</font><font color="#CCCCCC"> opportunity if you've</font>

836
00:29:50,830 --> 00:29:53,620
got a<font color="#E5E5E5"> random IP address in the internet</font>

837
00:29:52,360 --> 00:29:55,510
<font color="#E5E5E5">that's being called out to</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> five</font>

838
00:29:53,620 --> 00:29:57,489
seconds<font color="#E5E5E5"> that's behavior indicative a</font>

839
00:29:55,510 --> 00:29:59,530
beaconing malware weakening malware is

840
00:29:57,490 --> 00:30:01,210
reaching<font color="#E5E5E5"> out to look for taskings every</font>

841
00:29:59,530 --> 00:30:02,770
<font color="#E5E5E5">five seconds</font><font color="#CCCCCC"> when it gets them it</font>

842
00:30:01,210 --> 00:30:04,840
executed on the system and then<font color="#E5E5E5"> it</font>

843
00:30:02,770 --> 00:30:07,480
responds with here's the<font color="#CCCCCC"> output of the</font>

844
00:30:04,840 --> 00:30:08,949
command<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you just ran so if we're</font>

845
00:30:07,480 --> 00:30:10,990
<font color="#CCCCCC">looking for</font><font color="#E5E5E5"> these kind of things</font><font color="#CCCCCC"> maybe</font>

846
00:30:08,950 --> 00:30:12,790
on a<font color="#CCCCCC"> frequency-domain Black Hills put</font>

847
00:30:10,990 --> 00:30:14,860
out a tool called Rita<font color="#E5E5E5"> and there's also</font>

848
00:30:12,790 --> 00:30:17,740
a commercial<font color="#CCCCCC"> version that they've</font>

849
00:30:14,860 --> 00:30:19,389
released<font color="#E5E5E5"> called AI hunter that does a</font>

850
00:30:17,740 --> 00:30:21,880
lot<font color="#E5E5E5"> of these kind of things but the goal</font>

851
00:30:19,390 --> 00:30:24,130
of<font color="#CCCCCC"> it is to hunt</font><font color="#E5E5E5"> down beaconing based</font>

852
00:30:21,880 --> 00:30:25,510
malware by doing things like analysis

853
00:30:24,130 --> 00:30:26,950
against<font color="#CCCCCC"> frequency domain against a time</font>

854
00:30:25,510 --> 00:30:29,200
spectrum<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> network to identify</font>

855
00:30:26,950 --> 00:30:31,320
<font color="#CCCCCC">these kinds of</font><font color="#E5E5E5"> activities</font><font color="#CCCCCC"> that are</font>

856
00:30:29,200 --> 00:30:33,430
<font color="#E5E5E5">indicative of malware this will work for</font>

857
00:30:31,320 --> 00:30:35,070
powerful<font color="#CCCCCC"> Empire</font><font color="#E5E5E5"> this will work for</font>

858
00:30:33,430 --> 00:30:37,180
cobalt strike<font color="#E5E5E5"> this will work for</font>

859
00:30:35,070 --> 00:30:37,720
malicious malware that<font color="#E5E5E5"> we've never seen</font>

860
00:30:37,180 --> 00:30:40,270
<font color="#CCCCCC">before</font>

861
00:30:37,720 --> 00:30:42,580
<font color="#CCCCCC">it also beacons</font><font color="#E5E5E5"> in order to do it see -</font>

862
00:30:40,270 --> 00:30:44,770
<font color="#E5E5E5">this is a common way to do see - and if</font>

863
00:30:42,580 --> 00:30:46,570
we're focused on<font color="#CCCCCC"> what that tactic is and</font>

864
00:30:44,770 --> 00:30:49,210
breaking that apart we'll be much more

865
00:30:46,570 --> 00:30:51,730
<font color="#CCCCCC">effective but</font><font color="#E5E5E5"> if we're trying to operate</font>

866
00:30:49,210 --> 00:30:54,279
<font color="#E5E5E5">and we want to win win win every time</font>

867
00:30:51,730 --> 00:30:57,429
we also need to<font color="#E5E5E5"> iterate beyond that for</font>

868
00:30:54,279 --> 00:30:58,720
example this random IP address<font color="#E5E5E5"> that's on</font>

869
00:30:57,429 --> 00:31:00,760
the<font color="#E5E5E5"> Internet's</font><font color="#CCCCCC"> that we're beginning to</font>

870
00:30:58,720 --> 00:31:02,529
should we<font color="#E5E5E5"> be going</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> it's a lot of</font>

871
00:31:00,760 --> 00:31:04,269
<font color="#E5E5E5">use of domain fronting these days to</font>

872
00:31:02,529 --> 00:31:05,620
<font color="#E5E5E5">make</font><font color="#CCCCCC"> that not appear to be</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same IP</font>

873
00:31:04,269 --> 00:31:08,139
address<font color="#E5E5E5"> that you're</font><font color="#CCCCCC"> actually</font>

874
00:31:05,620 --> 00:31:10,059
communicating<font color="#E5E5E5"> out to there's other</font>

875
00:31:08,139 --> 00:31:10,840
techniques<font color="#CCCCCC"> as well</font><font color="#E5E5E5"> like social</font>

876
00:31:10,059 --> 00:31:13,149
<font color="#CCCCCC">media-based</font>

877
00:31:10,840 --> 00:31:14,769
command and control<font color="#E5E5E5"> where is Twitter</font>

878
00:31:13,149 --> 00:31:17,018
blocked in your<font color="#E5E5E5"> network perhaps is</font>

879
00:31:14,769 --> 00:31:19,330
reddit block to your<font color="#E5E5E5"> network maybe maybe</font>

880
00:31:17,019 --> 00:31:21,010
got<font color="#CCCCCC"> some social media blacklist going on</font>

881
00:31:19,330 --> 00:31:23,678
she's a really<font color="#E5E5E5"> securitisation is the New</font>

882
00:31:21,010 --> 00:31:25,000
York<font color="#CCCCCC"> Times blocked</font><font color="#E5E5E5"> on your network well</font>

883
00:31:23,679 --> 00:31:26,740
there's this<font color="#E5E5E5"> thing of New York Times if</font>

884
00:31:25,000 --> 00:31:27,909
you go to an article<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you scroll to</font>

885
00:31:26,740 --> 00:31:31,539
<font color="#E5E5E5">the bottom you</font><font color="#CCCCCC"> see a lot of Russian</font>

886
00:31:27,909 --> 00:31:33,309
messages<font color="#CCCCCC"> in the comments that means that</font>

887
00:31:31,539 --> 00:31:35,230
they can type in<font color="#CCCCCC"> information they can</font>

888
00:31:33,309 --> 00:31:36,940
hit post<font color="#CCCCCC"> the information is stored there</font>

889
00:31:35,230 --> 00:31:38,769
anybody else<font color="#E5E5E5"> can browse</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> and see</font>

890
00:31:36,940 --> 00:31:41,380
<font color="#CCCCCC">that information and download</font><font color="#E5E5E5"> it as well</font>

891
00:31:38,769 --> 00:31:43,090
this<font color="#E5E5E5"> is everything</font><font color="#CCCCCC"> that you need from a</font>

892
00:31:41,380 --> 00:31:45,820
<font color="#CCCCCC">situ perspective</font><font color="#E5E5E5"> for malware</font>

893
00:31:43,090 --> 00:31:48,250
communication send information<font color="#E5E5E5"> receive</font>

894
00:31:45,820 --> 00:31:49,960
information from<font color="#E5E5E5"> some joint</font><font color="#CCCCCC"> host some</font>

895
00:31:48,250 --> 00:31:53,200
joint location<font color="#E5E5E5"> so you can see things</font>

896
00:31:49,960 --> 00:31:56,200
<font color="#E5E5E5">like gee cat which is</font><font color="#CCCCCC"> a net cat</font><font color="#E5E5E5"> over</font>

897
00:31:53,200 --> 00:31:58,320
<font color="#E5E5E5">Gmail absolutely outstanding</font><font color="#CCCCCC"> that's</font>

898
00:31:56,200 --> 00:32:01,450
<font color="#E5E5E5">going to get around basically everyone's</font>

899
00:31:58,320 --> 00:32:02,918
network based controls like that<font color="#E5E5E5"> and</font>

900
00:32:01,450 --> 00:32:04,299
when it comes<font color="#E5E5E5"> to those kind of things</font>

901
00:32:02,919 --> 00:32:06,190
many of these web<font color="#CCCCCC"> applications</font>

902
00:32:04,299 --> 00:32:08,710
themselves beacon<font color="#E5E5E5"> for example you browse</font>

903
00:32:06,190 --> 00:32:10,389
to Gmail<font color="#E5E5E5"> and you get a new email that</font>

904
00:32:08,710 --> 00:32:13,029
<font color="#CCCCCC">email shows up automatically</font><font color="#E5E5E5"> that's</font>

905
00:32:10,389 --> 00:32:15,250
<font color="#E5E5E5">because your browser is</font><font color="#CCCCCC"> beaconing to</font>

906
00:32:13,029 --> 00:32:17,350
that web application<font color="#CCCCCC"> consistently in</font>

907
00:32:15,250 --> 00:32:19,389
order<font color="#E5E5E5"> to find the new information</font><font color="#CCCCCC"> and</font>

908
00:32:17,350 --> 00:32:21,519
then adjust the<font color="#E5E5E5"> web application</font><font color="#CCCCCC"> state</font>

909
00:32:19,389 --> 00:32:24,100
<font color="#E5E5E5">that you can see your new email as</font><font color="#CCCCCC"> it</font>

910
00:32:21,519 --> 00:32:25,990
pops in immediately<font color="#E5E5E5"> javascript does a</font>

911
00:32:24,100 --> 00:32:27,730
lot<font color="#CCCCCC"> of this very well</font><font color="#E5E5E5"> and kind</font><font color="#CCCCCC"> of just</font>

912
00:32:25,990 --> 00:32:31,419
intrinsically in many cases<font color="#E5E5E5"> things like</font>

913
00:32:27,730 --> 00:32:35,169
meteor that mod manage the data state of

914
00:32:31,419 --> 00:32:38,980
an application directly and so these web

915
00:32:35,169 --> 00:32:41,049
<font color="#CCCCCC">applications can be hard to</font><font color="#E5E5E5"> to discern</font>

916
00:32:38,980 --> 00:32:44,230
<font color="#E5E5E5">versus malware as well another</font><font color="#CCCCCC"> things</font>

917
00:32:41,049 --> 00:32:45,760
you might look at is payload size<font color="#E5E5E5"> for</font>

918
00:32:44,230 --> 00:32:47,950
<font color="#CCCCCC">instance if we're</font><font color="#E5E5E5"> constantly getting our</font>

919
00:32:45,760 --> 00:32:49,210
tweets<font color="#E5E5E5"> our tweet feed that tweet feed is</font>

920
00:32:47,950 --> 00:32:51,669
probably gonna<font color="#E5E5E5"> look</font><font color="#CCCCCC"> different over time</font>

921
00:32:49,210 --> 00:32:53,679
<font color="#E5E5E5">because the size of</font><font color="#CCCCCC"> the tweet</font><font color="#E5E5E5"> size the</font>

922
00:32:51,669 --> 00:32:55,149
messages they're different for<font color="#CCCCCC"> each one</font>

923
00:32:53,679 --> 00:32:56,799
as we get a new tweet<font color="#E5E5E5"> that shows up</font>

924
00:32:55,149 --> 00:32:58,989
there again the size<font color="#E5E5E5"> that package can be</font>

925
00:32:56,799 --> 00:33:01,870
<font color="#E5E5E5">different so you can also look on your</font>

926
00:32:58,990 --> 00:33:03,960
network for beacon packets that are

927
00:33:01,870 --> 00:33:05,309
<font color="#E5E5E5">always</font><font color="#CCCCCC"> the same</font><font color="#E5E5E5"> size</font>

928
00:33:03,960 --> 00:33:06,899
that's another great<font color="#E5E5E5"> way</font><font color="#CCCCCC"> to find</font>

929
00:33:05,309 --> 00:33:09,840
<font color="#CCCCCC">beaconing malware so if you want to look</font>

930
00:33:06,899 --> 00:33:11,129
real<font color="#E5E5E5"> we want to model what is real and</font>

931
00:33:09,840 --> 00:33:14,580
we can actually<font color="#E5E5E5"> use many of these things</font>

932
00:33:11,129 --> 00:33:17,248
like Gmail<font color="#E5E5E5"> like</font><font color="#CCCCCC"> Docs</font><font color="#E5E5E5"> like Twitter in</font>

933
00:33:14,580 --> 00:33:18,539
order<font color="#CCCCCC"> to accomplish</font><font color="#E5E5E5"> those ends there's</font>

934
00:33:17,249 --> 00:33:20,759
two pieces<font color="#E5E5E5"> here though</font><font color="#CCCCCC"> right</font>

935
00:33:18,539 --> 00:33:23,759
there's the<font color="#E5E5E5"> network for sure there's</font>

936
00:33:20,759 --> 00:33:26,460
also the<font color="#E5E5E5"> host this is</font><font color="#CCCCCC"> where we have a</font>

937
00:33:23,759 --> 00:33:28,889
lot of<font color="#E5E5E5"> trouble</font><font color="#CCCCCC"> getting</font><font color="#E5E5E5"> around because if</font>

938
00:33:26,460 --> 00:33:31,320
we<font color="#E5E5E5"> want to have something execute we</font>

939
00:33:28,889 --> 00:33:32,939
could try<font color="#E5E5E5"> to inject into the memory</font>

940
00:33:31,320 --> 00:33:35,428
<font color="#CCCCCC">space of a process that</font><font color="#E5E5E5"> would normally</font>

941
00:33:32,940 --> 00:33:37,830
<font color="#E5E5E5">do this maybe inject into</font><font color="#CCCCCC"> Explorer</font>

942
00:33:35,429 --> 00:33:38,940
Internet Explorer or<font color="#E5E5E5"> Firefox or Chrome</font>

943
00:33:37,830 --> 00:33:40,710
we could try<font color="#E5E5E5"> to do something like this</font>

944
00:33:38,940 --> 00:33:42,330
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> probably not where it's executing</font>

945
00:33:40,710 --> 00:33:43,769
to begin with though<font color="#E5E5E5"> which means if you</font>

946
00:33:42,330 --> 00:33:46,080
see that communication activity happen

947
00:33:43,769 --> 00:33:49,440
before or<font color="#E5E5E5"> after you can</font><font color="#CCCCCC"> see some things</font>

948
00:33:46,080 --> 00:33:51,480
there<font color="#CCCCCC"> but if we</font><font color="#E5E5E5"> really want to model</font>

949
00:33:49,440 --> 00:33:53,220
what's good<font color="#E5E5E5"> the browser is making</font>

950
00:33:51,480 --> 00:33:54,779
<font color="#E5E5E5">network communications there are</font>

951
00:33:53,220 --> 00:33:57,389
processes<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the host that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> doing</font>

952
00:33:54,779 --> 00:33:59,570
<font color="#E5E5E5">process</font><font color="#CCCCCC"> see things</font><font color="#E5E5E5"> that looks normal</font><font color="#CCCCCC"> so</font>

953
00:33:57,389 --> 00:34:02,399
<font color="#CCCCCC">if you want to have covert communication</font>

954
00:33:59,570 --> 00:34:04,850
beaconing executables on the<font color="#CCCCCC"> host look</font>

955
00:34:02,399 --> 00:34:06,989
<font color="#CCCCCC">suspect that doesn't look</font><font color="#E5E5E5"> normal</font>

956
00:34:04,850 --> 00:34:10,040
somebody's looking carefully<font color="#E5E5E5"> they can</font>

957
00:34:06,990 --> 00:34:12,540
stumble<font color="#E5E5E5"> upon that</font><font color="#CCCCCC"> and you're caught</font>

958
00:34:10,040 --> 00:34:15,020
<font color="#E5E5E5">Internet traffic from</font><font color="#CCCCCC"> I explorer.exe on</font>

959
00:34:12,540 --> 00:34:17,339
<font color="#CCCCCC">their hand</font><font color="#E5E5E5"> that's probably pretty normal</font>

960
00:34:15,020 --> 00:34:19,049
so solution<font color="#E5E5E5"> here</font><font color="#CCCCCC"> is for our</font>

961
00:34:17,339 --> 00:34:21,719
communication<font color="#CCCCCC"> if we could use the</font>

962
00:34:19,049 --> 00:34:23,549
browser and JavaScript logical language

963
00:34:21,719 --> 00:34:27,290
for the browser<font color="#E5E5E5"> to do all of that c2</font>

964
00:34:23,549 --> 00:34:29,190
communication that's nice that's covert

965
00:34:27,290 --> 00:34:30,960
then we've got the problem<font color="#E5E5E5"> system</font>

966
00:34:29,190 --> 00:34:32,339
execution though<font color="#E5E5E5"> because just javascript</font>

967
00:34:30,960 --> 00:34:34,829
in the browser doesn't<font color="#E5E5E5"> mean you can run</font>

968
00:34:32,339 --> 00:34:37,199
things<font color="#E5E5E5"> on the local system you need</font><font color="#CCCCCC"> to</font>

969
00:34:34,829 --> 00:34:39,059
<font color="#CCCCCC">have</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> way to tie that in well</font>

970
00:34:37,199 --> 00:34:40,739
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> has this fancy</font><font color="#CCCCCC"> thing that lets</font>

971
00:34:39,059 --> 00:34:42,750
you run<font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> local system</font>

972
00:34:40,739 --> 00:34:44,908
<font color="#CCCCCC">too</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> it's not the JavaScript that's</font>

973
00:34:42,750 --> 00:34:46,949
in the<font color="#E5E5E5"> browser so</font><font color="#CCCCCC"> you might want to have</font>

974
00:34:44,909 --> 00:34:48,750
something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> browser</font><font color="#CCCCCC"> JavaScript and</font><font color="#E5E5E5"> a</font>

975
00:34:46,949 --> 00:34:50,668
host<font color="#E5E5E5"> JavaScript that are running</font>

976
00:34:48,750 --> 00:34:53,250
independently of each<font color="#E5E5E5"> other that window</font>

977
00:34:50,668 --> 00:34:54,418
scripting host<font color="#E5E5E5"> is generally executed via</font>

978
00:34:53,250 --> 00:34:56,280
<font color="#E5E5E5">C script you actually with a much</font>

979
00:34:54,418 --> 00:34:59,279
different things because<font color="#E5E5E5"> everything runs</font>

980
00:34:56,280 --> 00:35:00,720
on Windows just<font color="#CCCCCC"> does but typically</font><font color="#E5E5E5"> you</font>

981
00:34:59,280 --> 00:35:02,700
see that a<font color="#CCCCCC"> C script</font><font color="#E5E5E5"> if you were to run a</font>

982
00:35:00,720 --> 00:35:05,160
<font color="#E5E5E5">C script based backdoor you might see on</font>

983
00:35:02,700 --> 00:35:06,960
<font color="#CCCCCC">the host C script that you see making</font>

984
00:35:05,160 --> 00:35:09,328
network traffic<font color="#E5E5E5"> out on your network</font>

985
00:35:06,960 --> 00:35:11,339
<font color="#E5E5E5">might flag that as something that looks</font>

986
00:35:09,329 --> 00:35:12,510
malicious something looks bad but<font color="#E5E5E5"> if</font>

987
00:35:11,339 --> 00:35:15,720
you've got<font color="#E5E5E5"> C</font><font color="#CCCCCC"> script running</font><font color="#E5E5E5"> on your</font>

988
00:35:12,510 --> 00:35:17,850
<font color="#CCCCCC">system</font><font color="#E5E5E5"> doesn't necessarily mean that the</font>

989
00:35:15,720 --> 00:35:19,799
<font color="#E5E5E5">system's compromised by itself</font>

990
00:35:17,850 --> 00:35:21,930
for example if<font color="#E5E5E5"> your your users your</font>

991
00:35:19,800 --> 00:35:23,580
admins<font color="#E5E5E5"> and such are doing things with</font>

992
00:35:21,930 --> 00:35:25,169
<font color="#E5E5E5">visual</font><font color="#CCCCCC"> basic or they've got a startup</font>

993
00:35:23,580 --> 00:35:26,160
<font color="#CCCCCC">script</font><font color="#E5E5E5"> that's in Visual Basic</font><font color="#CCCCCC"> these</font>

994
00:35:25,170 --> 00:35:28,980
things are<font color="#E5E5E5"> common we see</font><font color="#CCCCCC"> them all over</font>

995
00:35:26,160 --> 00:35:30,600
<font color="#E5E5E5">networks all the time they're done Dada</font>

996
00:35:28,980 --> 00:35:32,640
<font color="#E5E5E5">nauseam</font><font color="#CCCCCC"> CCS with batch scripts as well</font>

997
00:35:30,600 --> 00:35:33,690
those normally are running things<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font>

998
00:35:32,640 --> 00:35:35,250
<font color="#E5E5E5">host or maybe they're doing</font><font color="#CCCCCC"> things to</font>

999
00:35:33,690 --> 00:35:37,020
other nodes inside the internal<font color="#E5E5E5"> network</font>

1000
00:35:35,250 --> 00:35:38,580
<font color="#CCCCCC">they're typically not beaconing out to</font>

1001
00:35:37,020 --> 00:35:40,500
the<font color="#E5E5E5"> Internet so</font><font color="#CCCCCC"> as far</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> that Network</font>

1002
00:35:38,580 --> 00:35:42,060
<font color="#CCCCCC">behavior</font><font color="#E5E5E5"> you can still look at that and</font>

1003
00:35:40,500 --> 00:35:47,460
say that<font color="#E5E5E5"> suspect</font><font color="#CCCCCC"> which is the execution</font>

1004
00:35:42,060 --> 00:35:49,440
<font color="#CCCCCC">itself isn't</font><font color="#E5E5E5"> necessarily bad so we could</font>

1005
00:35:47,460 --> 00:35:52,050
run<font color="#E5E5E5"> something in the host and we could</font>

1006
00:35:49,440 --> 00:35:54,270
send the information<font color="#E5E5E5"> through the browser</font>

1007
00:35:52,050 --> 00:35:56,880
<font color="#CCCCCC">that means we need to</font><font color="#E5E5E5"> have some kind of</font>

1008
00:35:54,270 --> 00:35:58,440
linkage between the<font color="#E5E5E5"> browser and between</font>

1009
00:35:56,880 --> 00:36:00,480
that thing<font color="#E5E5E5"> that's running on the host</font>

1010
00:35:58,440 --> 00:36:02,070
<font color="#CCCCCC">there's a lot of ways we can</font><font color="#E5E5E5"> do this now</font>

1011
00:36:00,480 --> 00:36:03,690
up<font color="#CCCCCC"> here's the diagram of the first way</font>

1012
00:36:02,070 --> 00:36:05,580
that<font color="#CCCCCC"> I thought</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> this and it was a</font>

1013
00:36:03,690 --> 00:36:07,110
bad idea so<font color="#CCCCCC"> I did</font><font color="#E5E5E5"> it once I'm</font><font color="#CCCCCC"> like asses</font>

1014
00:36:05,580 --> 00:36:08,130
and<font color="#E5E5E5"> now this is not a good idea</font><font color="#CCCCCC"> so it is</font>

1015
00:36:07,110 --> 00:36:09,420
you've got the<font color="#E5E5E5"> JavaScript running the</font>

1016
00:36:08,130 --> 00:36:11,670
browser<font color="#CCCCCC"> you got the</font><font color="#E5E5E5"> job keep running the</font>

1017
00:36:09,420 --> 00:36:13,200
<font color="#CCCCCC">host and then when you've got</font><font color="#E5E5E5"> commands</font>

1018
00:36:11,670 --> 00:36:15,090
<font color="#E5E5E5">that you'd be executed you've got a net</font>

1019
00:36:13,200 --> 00:36:17,669
<font color="#E5E5E5">a</font><font color="#CCCCCC"> sage firewall rule</font><font color="#E5E5E5"> that's just waiting</font>

1020
00:36:15,090 --> 00:36:19,020
and logging<font color="#E5E5E5"> when it gets a packet so</font>

1021
00:36:17,670 --> 00:36:21,510
then when you<font color="#E5E5E5"> send the jobs from the</font>

1022
00:36:19,020 --> 00:36:23,190
browser a command<font color="#E5E5E5"> it then browses</font><font color="#CCCCCC"> to the</font>

1023
00:36:21,510 --> 00:36:25,380
local system<font color="#CCCCCC"> hits that net sage firewall</font>

1024
00:36:23,190 --> 00:36:27,180
rule and then<font color="#CCCCCC"> establishes the channel</font>

1025
00:36:25,380 --> 00:36:30,300
with a local system<font color="#E5E5E5"> to pass that data</font>

1026
00:36:27,180 --> 00:36:32,069
back<font color="#E5E5E5"> and forth complex easy to break</font>

1027
00:36:30,300 --> 00:36:34,950
<font color="#E5E5E5">apart</font><font color="#CCCCCC"> you need to have an</font><font color="#E5E5E5"> SH firewall</font>

1028
00:36:32,070 --> 00:36:36,480
permissions<font color="#E5E5E5"> not so cool and so I was</font>

1029
00:36:34,950 --> 00:36:39,299
chatting<font color="#E5E5E5"> with a friend</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> was like well</font>

1030
00:36:36,480 --> 00:36:41,340
<font color="#E5E5E5">you know there's artifacts the browser</font>

1031
00:36:39,300 --> 00:36:42,600
puts in the system right like cookies

1032
00:36:41,340 --> 00:36:45,360
<font color="#E5E5E5">your cookies are stored you've got</font>

1033
00:36:42,600 --> 00:36:47,009
temporary<font color="#CCCCCC"> Internet files</font><font color="#E5E5E5"> in html5</font><font color="#CCCCCC"> even</font>

1034
00:36:45,360 --> 00:36:50,640
<font color="#CCCCCC">at the snazzy thing called local storage</font>

1035
00:36:47,010 --> 00:36:52,230
<font color="#E5E5E5">local storage is</font><font color="#CCCCCC"> a data cache where many</font>

1036
00:36:50,640 --> 00:36:54,089
html5 applications will store

1037
00:36:52,230 --> 00:36:55,320
information<font color="#E5E5E5"> and this information isn't</font>

1038
00:36:54,090 --> 00:36:57,030
simply temporary<font color="#E5E5E5"> for that browser</font>

1039
00:36:55,320 --> 00:36:58,710
session<font color="#E5E5E5"> it's actually stored on a local</font>

1040
00:36:57,030 --> 00:36:59,730
system<font color="#CCCCCC"> so that if you were to open up</font>

1041
00:36:58,710 --> 00:37:01,920
<font color="#E5E5E5">that browser and go to</font><font color="#CCCCCC"> that website</font>

1042
00:36:59,730 --> 00:37:03,600
<font color="#E5E5E5">again</font><font color="#CCCCCC"> then you still have access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> that</font>

1043
00:37:01,920 --> 00:37:07,050
local<font color="#E5E5E5"> storage that local cache of</font>

1044
00:37:03,600 --> 00:37:08,670
information so the web browser and<font color="#E5E5E5"> the</font>

1045
00:37:07,050 --> 00:37:10,860
JavaScript running in it can add things

1046
00:37:08,670 --> 00:37:13,430
local storage gets its purpose but local

1047
00:37:10,860 --> 00:37:15,750
storage lives actually<font color="#CCCCCC"> on the physical</font>

1048
00:37:13,430 --> 00:37:17,700
<font color="#CCCCCC">filesystem</font><font color="#E5E5E5"> so if you've got something</font>

1049
00:37:15,750 --> 00:37:19,860
<font color="#E5E5E5">running on a physical file system it can</font>

1050
00:37:17,700 --> 00:37:21,480
edit that<font color="#CCCCCC"> information as</font><font color="#E5E5E5"> well and since</font>

1051
00:37:19,860 --> 00:37:23,160
<font color="#E5E5E5">all</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> is in the</font><font color="#CCCCCC"> App data directory</font>

1052
00:37:21,480 --> 00:37:23,580
of that user<font color="#CCCCCC"> if you're running</font><font color="#E5E5E5"> as that</font>

1053
00:37:23,160 --> 00:37:25,379
user

1054
00:37:23,580 --> 00:37:27,299
you've got the permissions to<font color="#CCCCCC"> edit and</font>

1055
00:37:25,380 --> 00:37:28,560
interact<font color="#E5E5E5"> with this</font><font color="#CCCCCC"> information</font><font color="#E5E5E5"> so you</font>

1056
00:37:27,300 --> 00:37:30,540
<font color="#CCCCCC">can trade information back and forth</font>

1057
00:37:28,560 --> 00:37:31,710
here through a<font color="#CCCCCC"> local file system</font>

1058
00:37:30,540 --> 00:37:34,500
<font color="#E5E5E5">io</font><font color="#CCCCCC"> Channel</font>

1059
00:37:31,710 --> 00:37:36,570
<font color="#E5E5E5">where your execution on</font><font color="#CCCCCC"> the host</font><font color="#E5E5E5"> makes</font>

1060
00:37:34,500 --> 00:37:38,430
no network communication whatsoever<font color="#CCCCCC"> your</font>

1061
00:37:36,570 --> 00:37:40,020
<font color="#CCCCCC">execution the browser does all of</font><font color="#E5E5E5"> that</font>

1062
00:37:38,430 --> 00:37:42,720
if you<font color="#E5E5E5"> want to run something the host</font>

1063
00:37:40,020 --> 00:37:47,520
the browser tells the JavaScript on the

1064
00:37:42,720 --> 00:37:49,709
<font color="#E5E5E5">host to run that stuff for you all right</font>

1065
00:37:47,520 --> 00:37:51,119
<font color="#CCCCCC">and so in comes</font><font color="#E5E5E5"> Gryffindor is the tool</font>

1066
00:37:49,710 --> 00:37:52,710
<font color="#E5E5E5">that I wrote to do a lot of these kind</font>

1067
00:37:51,119 --> 00:37:54,300
of<font color="#E5E5E5"> things there's</font><font color="#CCCCCC"> an it several</font><font color="#E5E5E5"> ways you</font>

1068
00:37:52,710 --> 00:37:55,920
<font color="#CCCCCC">can of course make JavaScript based</font>

1069
00:37:54,300 --> 00:37:57,570
malware<font color="#E5E5E5"> we kind of</font><font color="#CCCCCC"> talked through</font><font color="#E5E5E5"> them</font>

1070
00:37:55,920 --> 00:37:59,849
but<font color="#E5E5E5"> to summarize</font><font color="#CCCCCC"> you could use something</font>

1071
00:37:57,570 --> 00:38:01,619
like electron or<font color="#CCCCCC"> n WDAS to create</font>

1072
00:37:59,849 --> 00:38:04,020
something<font color="#CCCCCC"> like an executable to run</font><font color="#E5E5E5"> the</font>

1073
00:38:01,619 --> 00:38:06,119
code<font color="#E5E5E5"> for that would be almost</font><font color="#CCCCCC"> exactly</font>

1074
00:38:04,020 --> 00:38:06,900
equivalent to<font color="#CCCCCC"> the code that you use</font><font color="#E5E5E5"> for</font>

1075
00:38:06,119 --> 00:38:09,540
whatever is running in the browser

1076
00:38:06,900 --> 00:38:13,080
<font color="#E5E5E5">because</font><font color="#CCCCCC"> remember n wjs and electron are</font>

1077
00:38:09,540 --> 00:38:14,849
just a<font color="#CCCCCC"> website</font><font color="#E5E5E5"> in an executable they're</font>

1078
00:38:13,080 --> 00:38:16,770
packaged around the chromium<font color="#E5E5E5"> project</font><font color="#CCCCCC"> and</font>

1079
00:38:14,849 --> 00:38:18,060
<font color="#E5E5E5">that's how it achieves those ends so we</font>

1080
00:38:16,770 --> 00:38:19,830
can definitely<font color="#E5E5E5"> have executables we want</font>

1081
00:38:18,060 --> 00:38:21,180
to with<font color="#CCCCCC"> JavaScript we have JavaScript</font>

1082
00:38:19,830 --> 00:38:22,770
payloads<font color="#CCCCCC"> or during the browser</font><font color="#E5E5E5"> we can</font>

1083
00:38:21,180 --> 00:38:24,060
establish browser sessions<font color="#E5E5E5"> these are</font>

1084
00:38:22,770 --> 00:38:25,650
also pretty<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> because let's</font>

1085
00:38:24,060 --> 00:38:27,420
<font color="#CCCCCC">say</font><font color="#E5E5E5"> you have no ability</font><font color="#CCCCCC"> to execute</font><font color="#E5E5E5"> on a</font>

1086
00:38:25,650 --> 00:38:29,010
local<font color="#CCCCCC"> system does that mean you can't</font>

1087
00:38:27,420 --> 00:38:30,930
see<font color="#CCCCCC"> to in the network or do thinks</font><font color="#E5E5E5"> the</font>

1088
00:38:29,010 --> 00:38:32,760
internal environment<font color="#E5E5E5"> answer's no if you</font>

1089
00:38:30,930 --> 00:38:34,109
own the browser and the browser is

1090
00:38:32,760 --> 00:38:35,730
behind<font color="#E5E5E5"> their firewall their internal</font>

1091
00:38:34,109 --> 00:38:37,920
firewall<font color="#CCCCCC"> you can have that browser do</font>

1092
00:38:35,730 --> 00:38:39,180
other things<font color="#E5E5E5"> to things it behind the</font>

1093
00:38:37,920 --> 00:38:41,369
internal firewall<font color="#E5E5E5"> you absolutely</font><font color="#CCCCCC"> can't</font>

1094
00:38:39,180 --> 00:38:43,770
<font color="#E5E5E5">so there is value in these browser</font>

1095
00:38:41,369 --> 00:38:45,330
sessions<font color="#CCCCCC"> the beef project is a</font><font color="#E5E5E5"> good</font>

1096
00:38:43,770 --> 00:38:46,560
<font color="#CCCCCC">example of this where you've got beef</font>

1097
00:38:45,330 --> 00:38:47,759
hooks that<font color="#CCCCCC"> you would put into</font><font color="#E5E5E5"> the</font>

1098
00:38:46,560 --> 00:38:50,339
browser<font color="#E5E5E5"> to control the</font><font color="#CCCCCC"> browsers long</font>

1099
00:38:47,760 --> 00:38:52,619
term you<font color="#E5E5E5"> know the browser do things now</font>

1100
00:38:50,339 --> 00:38:54,540
<font color="#E5E5E5">beefs also been around for quite</font><font color="#CCCCCC"> a long</font>

1101
00:38:52,619 --> 00:38:56,190
<font color="#E5E5E5">time has it seen a huge amount of</font>

1102
00:38:54,540 --> 00:38:59,009
development<font color="#CCCCCC"> in</font><font color="#E5E5E5"> recent years what</font>

1103
00:38:56,190 --> 00:39:01,500
browsers have<font color="#E5E5E5"> Chrome and Firefox and</font>

1104
00:38:59,010 --> 00:39:03,810
<font color="#E5E5E5">those projects</font><font color="#CCCCCC"> have absolutely exploded</font>

1105
00:39:01,500 --> 00:39:06,240
the capability<font color="#CCCCCC"> of a browser itself</font><font color="#E5E5E5"> and</font>

1106
00:39:03,810 --> 00:39:07,890
so now browsers are very nearly<font color="#E5E5E5"> an</font>

1107
00:39:06,240 --> 00:39:10,410
operating<font color="#CCCCCC"> system in and of themselves so</font>

1108
00:39:07,890 --> 00:39:13,650
you've got some<font color="#E5E5E5"> some difficulties back</font>

1109
00:39:10,410 --> 00:39:15,210
and forth<font color="#E5E5E5"> as in cores which prevents you</font>

1110
00:39:13,650 --> 00:39:16,830
from getting<font color="#E5E5E5"> things that are not from</font>

1111
00:39:15,210 --> 00:39:18,150
the<font color="#E5E5E5"> same domain as</font><font color="#CCCCCC"> you are so if you're</font>

1112
00:39:16,830 --> 00:39:19,589
in the<font color="#E5E5E5"> brows and</font><font color="#CCCCCC"> you own</font><font color="#E5E5E5"> the browser</font>

1113
00:39:18,150 --> 00:39:21,630
that<font color="#CCCCCC"> doesn't technically mean you own</font>

1114
00:39:19,589 --> 00:39:23,220
<font color="#E5E5E5">things from every resource the browser's</font>

1115
00:39:21,630 --> 00:39:24,900
ever communicated with<font color="#E5E5E5"> that browser</font>

1116
00:39:23,220 --> 00:39:28,459
sandboxing does still tie<font color="#CCCCCC"> our hands a</font>

1117
00:39:24,900 --> 00:39:30,960
<font color="#CCCCCC">little bit but if we</font><font color="#E5E5E5"> own the browser</font>

1118
00:39:28,460 --> 00:39:32,520
<font color="#E5E5E5">we've got some kind</font><font color="#CCCCCC"> of session</font><font color="#E5E5E5"> going on</font>

1119
00:39:30,960 --> 00:39:33,450
inside their environment and with the

1120
00:39:32,520 --> 00:39:35,880
growth of<font color="#E5E5E5"> a lot of</font><font color="#CCCCCC"> these browser</font>

1121
00:39:33,450 --> 00:39:37,710
technologies like web<font color="#E5E5E5"> RTC that means we</font>

1122
00:39:35,880 --> 00:39:40,950
can do a lot<font color="#CCCCCC"> of things for instance</font>

1123
00:39:37,710 --> 00:39:44,790
WebRTC is used to do full torrent

1124
00:39:40,950 --> 00:39:45,560
clients that stream like download a

1125
00:39:44,790 --> 00:39:47,270
torrent thing

1126
00:39:45,560 --> 00:39:49,700
through browsers and the<font color="#E5E5E5"> peer-to-peer</font>

1127
00:39:47,270 --> 00:39:51,470
communication is all in the browser as

1128
00:39:49,700 --> 00:39:53,240
in when it's downloading<font color="#E5E5E5"> something it's</font>

1129
00:39:51,470 --> 00:39:55,100
<font color="#E5E5E5">not downloading it from the website</font><font color="#CCCCCC"> it's</font>

1130
00:39:53,240 --> 00:39:57,500
<font color="#E5E5E5">downloading it from all of the other</font>

1131
00:39:55,100 --> 00:39:59,120
torrent peers<font color="#E5E5E5"> and it's all in the</font>

1132
00:39:57,500 --> 00:40:01,040
browser<font color="#CCCCCC"> so your browser suddenly</font><font color="#E5E5E5"> making</font>

1133
00:39:59,120 --> 00:40:03,410
weird network connections to other third

1134
00:40:01,040 --> 00:40:05,180
parties and WebRTC is what enables all

1135
00:40:03,410 --> 00:40:06,560
of<font color="#CCCCCC"> these things</font><font color="#E5E5E5"> so when it comes to the</font>

1136
00:40:05,180 --> 00:40:08,359
newer browser technologies we've got the

1137
00:40:06,560 --> 00:40:09,920
<font color="#E5E5E5">ability to do things</font><font color="#CCCCCC"> like port scans in</font>

1138
00:40:08,360 --> 00:40:12,080
the internal environment<font color="#E5E5E5"> with pretty</font>

1139
00:40:09,920 --> 00:40:14,000
with some pretty heavy efficacy so<font color="#E5E5E5"> I</font>

1140
00:40:12,080 --> 00:40:16,220
think<font color="#E5E5E5"> if we start</font><font color="#CCCCCC"> to have</font><font color="#E5E5E5"> more and more</font>

1141
00:40:14,000 --> 00:40:18,590
<font color="#E5E5E5">trouble when it comes to executing on a</font>

1142
00:40:16,220 --> 00:40:20,569
local file<font color="#CCCCCC"> system of individual</font><font color="#E5E5E5"> host</font>

1143
00:40:18,590 --> 00:40:22,280
machines<font color="#E5E5E5"> we may end up</font><font color="#CCCCCC"> moving a</font>

1144
00:40:20,570 --> 00:40:24,530
substantial amount<font color="#E5E5E5"> or a toolkit</font><font color="#CCCCCC"> into the</font>

1145
00:40:22,280 --> 00:40:26,930
browser itself<font color="#E5E5E5"> and using that browser as</font>

1146
00:40:24,530 --> 00:40:27,320
the agent by which we<font color="#E5E5E5"> compromise other</font>

1147
00:40:26,930 --> 00:40:28,819
things

1148
00:40:27,320 --> 00:40:32,030
insert internal to<font color="#E5E5E5"> the environment and</font>

1149
00:40:28,820 --> 00:40:34,070
<font color="#E5E5E5">begin moving laterally we're not quite</font>

1150
00:40:32,030 --> 00:40:35,600
<font color="#CCCCCC">there yet most of our things still kind</font>

1151
00:40:34,070 --> 00:40:38,090
of<font color="#E5E5E5"> work in a host you just have to find</font>

1152
00:40:35,600 --> 00:40:40,069
<font color="#E5E5E5">out which one's perfect</font><font color="#CCCCCC"> so in this</font><font color="#E5E5E5"> case</font>

1153
00:40:38,090 --> 00:40:42,260
the project<font color="#E5E5E5"> here is actually a</font>

1154
00:40:40,070 --> 00:40:43,460
collection<font color="#E5E5E5"> of several tools because</font>

1155
00:40:42,260 --> 00:40:46,520
there's another<font color="#CCCCCC"> problem I've kind of</font>

1156
00:40:43,460 --> 00:40:48,920
interacted with in our community<font color="#CCCCCC"> too so</font>

1157
00:40:46,520 --> 00:40:51,500
these attackers<font color="#E5E5E5"> they might be building</font><font color="#CCCCCC"> a</font>

1158
00:40:48,920 --> 00:40:52,790
new<font color="#E5E5E5"> backdoor for whatever the engagement</font>

1159
00:40:51,500 --> 00:40:53,900
is and we can't necessarily keep up with

1160
00:40:52,790 --> 00:40:55,550
that there's a lot<font color="#CCCCCC"> of other things</font>

1161
00:40:53,900 --> 00:40:57,260
involve the backdoor<font color="#E5E5E5"> you've got to have</font>

1162
00:40:55,550 --> 00:40:58,700
a<font color="#CCCCCC"> situ server</font><font color="#E5E5E5"> you've got to have some</font>

1163
00:40:57,260 --> 00:41:00,650
way<font color="#CCCCCC"> to push and pull the data back and</font>

1164
00:40:58,700 --> 00:41:03,560
<font color="#CCCCCC">forth</font><font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to have a UI to control</font>

1165
00:41:00,650 --> 00:41:04,910
that<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> and so if you're using</font><font color="#E5E5E5"> Empire</font>

1166
00:41:03,560 --> 00:41:06,860
you're probably using empires UI<font color="#E5E5E5"> if</font>

1167
00:41:04,910 --> 00:41:09,649
you're using cobalt<font color="#E5E5E5"> strike you're using</font>

1168
00:41:06,860 --> 00:41:11,450
<font color="#E5E5E5">cobalt strikes UI if using</font><font color="#CCCCCC"> Metasploit</font>

1169
00:41:09,650 --> 00:41:13,760
you're using<font color="#CCCCCC"> Metasploit multi</font><font color="#E5E5E5"> handler</font>

1170
00:41:11,450 --> 00:41:16,700
<font color="#CCCCCC">ism</font><font color="#E5E5E5"> interpreter</font><font color="#CCCCCC"> okay it's another UI if</font>

1171
00:41:13,760 --> 00:41:18,350
you want to<font color="#E5E5E5"> build your own</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> you</font>

1172
00:41:16,700 --> 00:41:19,640
can't necessarily just<font color="#E5E5E5"> build</font><font color="#CCCCCC"> it into one</font>

1173
00:41:18,350 --> 00:41:21,920
<font color="#E5E5E5">of these other</font><font color="#CCCCCC"> systems you have to</font><font color="#E5E5E5"> build</font>

1174
00:41:19,640 --> 00:41:23,319
<font color="#E5E5E5">all those</font><font color="#CCCCCC"> other pieces as well so</font><font color="#E5E5E5"> these</font>

1175
00:41:21,920 --> 00:41:26,810
<font color="#CCCCCC">other tools</font><font color="#E5E5E5"> that you see up here</font>

1176
00:41:23,320 --> 00:41:31,160
<font color="#E5E5E5">emergence and oculus are that so oculus</font>

1177
00:41:26,810 --> 00:41:34,009
<font color="#E5E5E5">is a module</font><font color="#CCCCCC"> a modular C 2 system to</font><font color="#E5E5E5"> let</font>

1178
00:41:31,160 --> 00:41:35,660
you set up things<font color="#CCCCCC"> like handlers and HTTP</font>

1179
00:41:34,010 --> 00:41:37,520
listeners and such and it sends<font color="#E5E5E5"> the</font>

1180
00:41:35,660 --> 00:41:39,470
information<font color="#E5E5E5"> to emergence which is an API</font>

1181
00:41:37,520 --> 00:41:40,970
and so if you want to<font color="#CCCCCC"> interact</font><font color="#E5E5E5"> with that</font>

1182
00:41:39,470 --> 00:41:43,549
API<font color="#E5E5E5"> you want to get the information</font><font color="#CCCCCC"> that</font>

1183
00:41:40,970 --> 00:41:45,259
<font color="#CCCCCC">is a</font><font color="#E5E5E5"> callback from one of your</font><font color="#CCCCCC"> backdoors</font>

1184
00:41:43,550 --> 00:41:47,060
<font color="#E5E5E5">or you want to</font><font color="#CCCCCC"> create a new backdoor</font><font color="#E5E5E5"> to</font>

1185
00:41:45,260 --> 00:41:48,890
<font color="#E5E5E5">interact with it all you have</font><font color="#CCCCCC"> to do is</font>

1186
00:41:47,060 --> 00:41:53,240
create<font color="#E5E5E5"> a backdoor that makes the proper</font>

1187
00:41:48,890 --> 00:41:55,100
<font color="#E5E5E5">API calls via</font><font color="#CCCCCC"> JSON and</font><font color="#E5E5E5"> suddenly your</font>

1188
00:41:53,240 --> 00:41:56,779
backdoor just works with<font color="#CCCCCC"> the entire</font>

1189
00:41:55,100 --> 00:41:57,170
system<font color="#E5E5E5"> and you can use the same UI as</font>

1190
00:41:56,780 --> 00:41:58,550
well

1191
00:41:57,170 --> 00:41:59,150
so if we're in<font color="#E5E5E5"> a situation</font><font color="#CCCCCC"> where we're</font>

1192
00:41:58,550 --> 00:42:00,230
<font color="#E5E5E5">constantly</font>

1193
00:41:59,150 --> 00:42:02,180
these new<font color="#CCCCCC"> backdoors because we need to</font>

1194
00:42:00,230 --> 00:42:04,460
keep up with<font color="#E5E5E5"> the Joneses you have a</font>

1195
00:42:02,180 --> 00:42:06,980
system now<font color="#E5E5E5"> where you can just make the</font>

1196
00:42:04,460 --> 00:42:10,040
<font color="#E5E5E5">backdoor piece much simpler than all of</font>

1197
00:42:06,980 --> 00:42:11,360
the other logic and such<font color="#E5E5E5"> okay so is the</font>

1198
00:42:10,040 --> 00:42:13,100
API here<font color="#E5E5E5"> for the tool development is</font>

1199
00:42:11,360 --> 00:42:17,110
just<font color="#CCCCCC"> a public</font><font color="#E5E5E5"> API with all the API calls</font>

1200
00:42:13,100 --> 00:42:19,940
<font color="#E5E5E5">and objects and such and onto the tool</font>

1201
00:42:17,110 --> 00:42:20,930
<font color="#E5E5E5">so this here that the whole project</font><font color="#CCCCCC"> all</font>

1202
00:42:19,940 --> 00:42:22,370
<font color="#E5E5E5">of those different pieces is called</font>

1203
00:42:20,930 --> 00:42:24,319
prism<font color="#CCCCCC"> attica</font><font color="#E5E5E5"> it's got us on little</font>

1204
00:42:22,370 --> 00:42:25,549
websites and<font color="#E5E5E5"> meticulously developing</font>

1205
00:42:24,320 --> 00:42:27,230
other tools against it to be able<font color="#E5E5E5"> to use</font>

1206
00:42:25,550 --> 00:42:28,900
all<font color="#E5E5E5"> those pieces and data model but the</font>

1207
00:42:27,230 --> 00:42:31,580
first<font color="#E5E5E5"> piece that</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> leasing here is</font>

1208
00:42:28,900 --> 00:42:34,300
<font color="#CCCCCC">Gryffindor and the whole c2 project</font>

1209
00:42:31,580 --> 00:42:36,770
<font color="#E5E5E5">there this is kind of what it looks</font><font color="#CCCCCC"> like</font>

1210
00:42:34,300 --> 00:42:40,490
<font color="#E5E5E5">okay we're almost out of time</font><font color="#CCCCCC"> so let's</font>

1211
00:42:36,770 --> 00:42:42,020
just run<font color="#CCCCCC"> a couple things</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> through an</font>

1212
00:42:40,490 --> 00:42:45,259
example<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> back door you type</font>

1213
00:42:42,020 --> 00:42:46,430
something like sessions and this can

1214
00:42:45,260 --> 00:42:48,950
show<font color="#CCCCCC"> you that there is a session</font><font color="#E5E5E5"> now</font>

1215
00:42:46,430 --> 00:42:50,629
established already<font color="#E5E5E5"> on the system we can</font>

1216
00:42:48,950 --> 00:42:52,250
interact that session the<font color="#E5E5E5"> session ID</font>

1217
00:42:50,630 --> 00:42:54,620
here<font color="#E5E5E5"> it's a little small</font><font color="#CCCCCC"> so hard to see</font>

1218
00:42:52,250 --> 00:42:59,120
<font color="#E5E5E5">that ID is</font><font color="#CCCCCC"> 0</font><font color="#E5E5E5"> it's the first session we</font>

1219
00:42:54,620 --> 00:43:00,500
say interact with that<font color="#CCCCCC"> session</font><font color="#E5E5E5"> and then</font>

1220
00:42:59,120 --> 00:43:02,180
we<font color="#CCCCCC"> can type shell commands to have it</font>

1221
00:43:00,500 --> 00:43:09,680
run<font color="#E5E5E5"> with you something like shell calc</font>

1222
00:43:02,180 --> 00:43:11,210
<font color="#CCCCCC">to pop a calc could do shell</font><font color="#E5E5E5"> dir it's</font>

1223
00:43:09,680 --> 00:43:12,350
gonna<font color="#CCCCCC"> return the system and it's gonna</font>

1224
00:43:11,210 --> 00:43:14,090
show<font color="#E5E5E5"> you the files that are</font><font color="#CCCCCC"> in that</font>

1225
00:43:12,350 --> 00:43:16,100
directory<font color="#E5E5E5"> now taking a little while</font><font color="#CCCCCC"> to</font>

1226
00:43:14,090 --> 00:43:17,780
come<font color="#CCCCCC"> back</font><font color="#E5E5E5"> the reason for this is it's</font>

1227
00:43:16,100 --> 00:43:20,000
beaconing malware<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> making those</font>

1228
00:43:17,780 --> 00:43:21,470
API calls on an interval<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> adjust</font>

1229
00:43:20,000 --> 00:43:22,910
<font color="#CCCCCC">that interval</font><font color="#E5E5E5"> right now the interval is</font>

1230
00:43:21,470 --> 00:43:24,379
<font color="#E5E5E5">5 seconds so every five seconds it's</font>

1231
00:43:22,910 --> 00:43:26,629
checking<font color="#E5E5E5"> in to see there's new tasks</font><font color="#CCCCCC"> and</font>

1232
00:43:24,380 --> 00:43:28,220
then if there's no new tasks<font color="#CCCCCC"> it doesn't</font>

1233
00:43:26,630 --> 00:43:29,360
do anything<font color="#E5E5E5"> if there's a new task</font><font color="#CCCCCC"> it</font>

1234
00:43:28,220 --> 00:43:32,240
runs that and<font color="#E5E5E5"> it sends</font><font color="#CCCCCC"> the information</font>

1235
00:43:29,360 --> 00:43:35,120
<font color="#E5E5E5">back and the UI goes in and gets</font><font color="#CCCCCC"> the</font>

1236
00:43:32,240 --> 00:43:37,100
<font color="#CCCCCC">information this UI here is in electron</font>

1237
00:43:35,120 --> 00:43:40,220
<font color="#CCCCCC">so it will run</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> all operating systems</font>

1238
00:43:37,100 --> 00:43:43,310
<font color="#CCCCCC">mac</font><font color="#E5E5E5"> os/x well</font><font color="#CCCCCC"> i say all electron</font><font color="#E5E5E5"> doesn't</font>

1239
00:43:40,220 --> 00:43:44,779
run<font color="#CCCCCC"> on mobile</font><font color="#E5E5E5"> just yet so no mobile but</font>

1240
00:43:43,310 --> 00:43:46,430
everything else<font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> run on</font>

1241
00:43:44,780 --> 00:43:48,410
it's got<font color="#CCCCCC"> tab so you</font><font color="#E5E5E5"> can have</font><font color="#CCCCCC"> multiple</font>

1242
00:43:46,430 --> 00:43:51,200
tabs as<font color="#CCCCCC"> well for your your multiple</font>

1243
00:43:48,410 --> 00:43:54,140
sessions if you want to<font color="#E5E5E5"> and all that</font>

1244
00:43:51,200 --> 00:43:56,149
jazz<font color="#CCCCCC"> long term</font><font color="#E5E5E5"> I intend to have this UI</font>

1245
00:43:54,140 --> 00:43:58,640
work for other tools<font color="#CCCCCC"> like Empire Empire</font>

1246
00:43:56,150 --> 00:44:00,140
has a rest<font color="#E5E5E5"> you I just like the API here</font>

1247
00:43:58,640 --> 00:44:01,580
of the emergence product<font color="#E5E5E5"> so you should</font>

1248
00:44:00,140 --> 00:44:02,870
be<font color="#E5E5E5"> able to use more than one</font><font color="#CCCCCC"> backdoor</font>

1249
00:44:01,580 --> 00:44:04,370
<font color="#E5E5E5">within a single system which would be</font>

1250
00:44:02,870 --> 00:44:06,080
very<font color="#E5E5E5"> nice</font><font color="#CCCCCC"> to have</font><font color="#E5E5E5"> long term</font><font color="#CCCCCC"> at the</font>

1251
00:44:04,370 --> 00:44:08,509
moment it's just<font color="#E5E5E5"> died just works for</font>

1252
00:44:06,080 --> 00:44:11,390
gryffindor<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> I think</font><font color="#CCCCCC"> that's about</font>

1253
00:44:08,510 --> 00:44:13,010
<font color="#E5E5E5">all the time</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> I'll be up here for</font>

1254
00:44:11,390 --> 00:44:14,480
questions if you've got any

1255
00:44:13,010 --> 00:44:32,530
after that<font color="#E5E5E5"> all and turn over the new</font>

1256
00:44:14,480 --> 00:44:32,530
speaker hi<font color="#E5E5E5"> here how's it going</font>

