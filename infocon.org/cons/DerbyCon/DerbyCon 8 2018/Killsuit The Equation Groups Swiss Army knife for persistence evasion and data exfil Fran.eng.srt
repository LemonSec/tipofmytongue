1
00:00:02,240 --> 00:00:07,259
well<font color="#E5E5E5"> thanks everyone for coming to my</font>

2
00:00:05,400 --> 00:00:09,360
talk after that<font color="#CCCCCC"> awesome offspring</font>

3
00:00:07,259 --> 00:00:12,210
concert<font color="#E5E5E5"> appreciate you getting up for</font>

4
00:00:09,360 --> 00:00:14,940
<font color="#E5E5E5">this</font><font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> just go ahead and get started</font>

5
00:00:12,210 --> 00:00:17,250
<font color="#CCCCCC">my name is Francisco</font><font color="#E5E5E5"> DiNozzo</font>

6
00:00:14,940 --> 00:00:20,279
and I'm currently doing security and

7
00:00:17,250 --> 00:00:21,779
DevOps<font color="#CCCCCC"> at a start-up just that just</font><font color="#E5E5E5"> came</font>

8
00:00:20,279 --> 00:00:24,359
<font color="#CCCCCC">out of stealth</font><font color="#E5E5E5"> on Thursday</font>

9
00:00:21,779 --> 00:00:26,609
we're building a<font color="#E5E5E5"> nation-state caliber</font>

10
00:00:24,359 --> 00:00:28,260
attack platform<font color="#E5E5E5"> to let organizations</font>

11
00:00:26,609 --> 00:00:32,189
test their defenses against<font color="#CCCCCC"> a very</font>

12
00:00:28,260 --> 00:00:36,600
well-funded<font color="#CCCCCC"> and well instrumented</font>

13
00:00:32,189 --> 00:00:38,399
adversary<font color="#CCCCCC"> prior to that I worked as a</font>

14
00:00:36,600 --> 00:00:41,160
lead architect<font color="#CCCCCC"> running a team of</font>

15
00:00:38,399 --> 00:00:43,320
<font color="#E5E5E5">architects at a Swiss cybersecurity</font>

16
00:00:41,160 --> 00:00:45,239
company<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I've also</font><font color="#E5E5E5"> been a security</font>

17
00:00:43,320 --> 00:00:48,570
engineer done the consultant thing and

18
00:00:45,239 --> 00:00:50,610
probably my best and most fun job<font color="#CCCCCC"> of all</font>

19
00:00:48,570 --> 00:00:54,120
I was a<font color="#E5E5E5"> security analyst try to catch</font>

20
00:00:50,610 --> 00:00:56,340
other people<font color="#E5E5E5"> just to give you guys a</font>

21
00:00:54,120 --> 00:01:00,449
quick reminder in some context about

22
00:00:56,340 --> 00:01:03,059
<font color="#E5E5E5">this</font><font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> April of last year of</font>

23
00:01:00,449 --> 00:01:05,280
2017 there was a release<font color="#E5E5E5"> by a group</font>

24
00:01:03,059 --> 00:01:08,100
known<font color="#CCCCCC"> as</font><font color="#E5E5E5"> the shadow brokers</font><font color="#CCCCCC"> where in</font>

25
00:01:05,280 --> 00:01:10,260
<font color="#E5E5E5">there lost in translation</font><font color="#CCCCCC"> leaked they</font>

26
00:01:08,100 --> 00:01:13,080
actually leaked<font color="#E5E5E5"> quite a few of the</font>

27
00:01:10,260 --> 00:01:14,700
equation groups<font color="#E5E5E5"> exploit tools there are</font>

28
00:01:13,080 --> 00:01:16,890
exploits<font color="#E5E5E5"> as well as their post</font>

29
00:01:14,700 --> 00:01:19,229
exploitation tools<font color="#CCCCCC"> and there were also</font>

30
00:01:16,890 --> 00:01:22,080
<font color="#E5E5E5">some operational notes from an operator</font>

31
00:01:19,229 --> 00:01:25,710
<font color="#E5E5E5">targeting a Middle Eastern Swift</font>

32
00:01:22,080 --> 00:01:27,780
<font color="#CCCCCC">organization and I actually</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> started</font>

33
00:01:25,710 --> 00:01:31,439
<font color="#E5E5E5">digging into this right</font><font color="#CCCCCC"> away everybody</font>

34
00:01:27,780 --> 00:01:33,810
<font color="#CCCCCC">who I saw online</font><font color="#E5E5E5"> was really focusing on</font>

35
00:01:31,439 --> 00:01:36,059
their<font color="#CCCCCC"> kick-ass exploits</font><font color="#E5E5E5"> you know the</font>

36
00:01:33,810 --> 00:01:38,460
eternal blue eternal romance and and all

37
00:01:36,060 --> 00:01:41,009
<font color="#E5E5E5">that stuff</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> those things get patched</font>

38
00:01:38,460 --> 00:01:43,500
<font color="#E5E5E5">tradecraft and kind of capabilities that</font>

39
00:01:41,009 --> 00:01:45,390
<font color="#CCCCCC">they've built over times do not</font><font color="#E5E5E5"> and I</font>

40
00:01:43,500 --> 00:01:48,600
personally<font color="#E5E5E5"> really</font><font color="#CCCCCC"> always wanted to know</font>

41
00:01:45,390 --> 00:01:50,820
about<font color="#E5E5E5"> true like apt capabilities we</font>

42
00:01:48,600 --> 00:01:53,579
normally see it from the other<font color="#CCCCCC"> side</font><font color="#E5E5E5"> we</font>

43
00:01:50,820 --> 00:01:55,889
<font color="#CCCCCC">see</font><font color="#E5E5E5"> the artifacts that an apt or some</font>

44
00:01:53,579 --> 00:01:58,649
kind<font color="#E5E5E5"> of like well-funded adversary has</font>

45
00:01:55,890 --> 00:02:00,210
left<font color="#E5E5E5"> after a organization goes and does</font>

46
00:01:58,649 --> 00:02:01,619
some reverse engineering<font color="#E5E5E5"> this was the</font>

47
00:02:00,210 --> 00:02:03,750
first<font color="#E5E5E5"> time we could actually use them</font>

48
00:02:01,619 --> 00:02:04,110
and see how they worked<font color="#E5E5E5"> so I was pretty</font>

49
00:02:03,750 --> 00:02:06,750
cool

50
00:02:04,110 --> 00:02:09,300
I'm also here hoping that<font color="#E5E5E5"> I encourage</font>

51
00:02:06,750 --> 00:02:11,700
others<font color="#CCCCCC"> to reverse engineer</font><font color="#E5E5E5"> and just poke</font>

52
00:02:09,300 --> 00:02:13,440
around at these tools<font color="#CCCCCC"> it looks like it</font>

53
00:02:11,700 --> 00:02:15,720
<font color="#CCCCCC">took them a good like 13</font>

54
00:02:13,440 --> 00:02:18,060
<font color="#CCCCCC">fifteen years to build this tool set so</font>

55
00:02:15,720 --> 00:02:21,000
there's<font color="#CCCCCC"> a lot of stuff to dig into</font><font color="#E5E5E5"> I'm</font>

56
00:02:18,060 --> 00:02:22,590
not<font color="#CCCCCC"> a reverse engineer by trade but I'm</font>

57
00:02:21,000 --> 00:02:26,310
learning<font color="#CCCCCC"> my way</font><font color="#E5E5E5"> through it</font><font color="#CCCCCC"> and I just</font>

58
00:02:22,590 --> 00:02:27,600
hope<font color="#CCCCCC"> I'll you look at it as well and at</font>

59
00:02:26,310 --> 00:02:29,910
the time I wanted<font color="#CCCCCC"> a technical side</font>

60
00:02:27,600 --> 00:02:31,260
project<font color="#E5E5E5"> I was just a manager telling</font>

61
00:02:29,910 --> 00:02:33,060
architects what to do who told the

62
00:02:31,260 --> 00:02:33,929
engineers what to do who then actually

63
00:02:33,060 --> 00:02:37,700
<font color="#E5E5E5">did this stuff</font>

64
00:02:33,930 --> 00:02:39,870
now I'm hands-on which is cool so quick

65
00:02:37,700 --> 00:02:41,549
overview<font color="#CCCCCC"> of what we'll</font><font color="#E5E5E5"> be talking about</font>

66
00:02:39,870 --> 00:02:43,890
today<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> just gonna give</font><font color="#CCCCCC"> you a really</font>

67
00:02:41,550 --> 00:02:46,020
brief intro into dander<font color="#E5E5E5"> spritz which is</font>

68
00:02:43,890 --> 00:02:48,420
the larger post exploitation framework

69
00:02:46,020 --> 00:02:50,790
that<font color="#E5E5E5"> kill soot is included in along</font><font color="#CCCCCC"> with</font>

70
00:02:48,420 --> 00:02:52,320
a ton of other<font color="#E5E5E5"> awesome tools and if</font>

71
00:02:50,790 --> 00:02:54,209
you're<font color="#E5E5E5"> interested in how those tools</font>

72
00:02:52,320 --> 00:02:56,910
work at a greater<font color="#E5E5E5"> level I actually did a</font>

73
00:02:54,210 --> 00:02:59,610
talk last<font color="#E5E5E5"> year</font><font color="#CCCCCC"> at Derby con</font><font color="#E5E5E5"> titled</font>

74
00:02:56,910 --> 00:03:01,859
dander spritz<font color="#E5E5E5"> where I covered that so if</font>

75
00:02:59,610 --> 00:03:03,870
you're<font color="#CCCCCC"> interested go</font><font color="#E5E5E5"> check that out then</font>

76
00:03:01,860 --> 00:03:05,910
we'll get to how exactly<font color="#CCCCCC"> the equation</font>

77
00:03:03,870 --> 00:03:07,500
group got to post<font color="#E5E5E5"> exploitation like how</font>

78
00:03:05,910 --> 00:03:09,359
they went<font color="#E5E5E5"> from nothing to post</font>

79
00:03:07,500 --> 00:03:12,150
exploitation<font color="#E5E5E5"> and a few novel ways and</font>

80
00:03:09,360 --> 00:03:15,330
then talk more<font color="#E5E5E5"> about kill</font><font color="#CCCCCC"> suit and how</font>

81
00:03:12,150 --> 00:03:17,700
it actually<font color="#E5E5E5"> works</font><font color="#CCCCCC"> in its capabilities so</font>

82
00:03:15,330 --> 00:03:19,560
just a brief<font color="#E5E5E5"> overview of dander spritz</font>

83
00:03:17,700 --> 00:03:21,600
as I mentioned what is dander spritz

84
00:03:19,560 --> 00:03:23,550
<font color="#E5E5E5">well first of all dander spritz is</font>

85
00:03:21,600 --> 00:03:25,980
actually really<font color="#CCCCCC"> frickin</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> I've never</font>

86
00:03:23,550 --> 00:03:30,030
<font color="#CCCCCC">seen a tool set</font><font color="#E5E5E5"> that's as comprehensive</font>

87
00:03:25,980 --> 00:03:32,010
or as capable as this one it's a fully

88
00:03:30,030 --> 00:03:34,830
functional<font color="#CCCCCC"> post exploitation framework</font>

89
00:03:32,010 --> 00:03:37,920
<font color="#E5E5E5">so that</font><font color="#CCCCCC"> means you go from living</font><font color="#E5E5E5"> on a</font>

90
00:03:34,830 --> 00:03:40,260
machine<font color="#CCCCCC"> to data and like recon gathering</font>

91
00:03:37,920 --> 00:03:42,869
lateral movement persisting on<font color="#E5E5E5"> a machine</font>

92
00:03:40,260 --> 00:03:45,179
like stealthy exfil all that stuff is

93
00:03:42,870 --> 00:03:49,110
included in the<font color="#E5E5E5"> framework the actual</font>

94
00:03:45,180 --> 00:03:51,269
framework<font color="#CCCCCC"> is written in</font><font color="#E5E5E5"> Java but it's</font>

95
00:03:49,110 --> 00:03:53,640
extremely modular and<font color="#E5E5E5"> the way they make</font>

96
00:03:51,269 --> 00:03:55,680
it<font color="#E5E5E5"> extremely modular is by adding a</font>

97
00:03:53,640 --> 00:03:57,450
bunch<font color="#E5E5E5"> of plugins and plugins can be</font>

98
00:03:55,680 --> 00:03:59,220
<font color="#E5E5E5">written either in a custom scripting</font>

99
00:03:57,450 --> 00:04:01,410
language which were sort<font color="#CCCCCC"> of later</font>

100
00:03:59,220 --> 00:04:03,390
deprecated as well as<font color="#CCCCCC"> Python scripts</font>

101
00:04:01,410 --> 00:04:05,880
<font color="#E5E5E5">which is awesome</font><font color="#CCCCCC"> it was easy</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> me to</font>

102
00:04:03,390 --> 00:04:08,130
<font color="#E5E5E5">look at that</font><font color="#CCCCCC"> it's also designed for</font>

103
00:04:05,880 --> 00:04:09,870
<font color="#CCCCCC">stuff</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of what the equation group</font>

104
00:04:08,130 --> 00:04:11,430
did was make<font color="#CCCCCC"> sure that they were not</font>

105
00:04:09,870 --> 00:04:14,400
<font color="#CCCCCC">caught</font><font color="#E5E5E5"> that they didn't blow their</font>

106
00:04:11,430 --> 00:04:16,739
operation<font color="#E5E5E5"> and they actually did that by</font>

107
00:04:14,400 --> 00:04:18,840
building<font color="#E5E5E5"> it a lot of safety mechanisms</font>

108
00:04:16,738 --> 00:04:21,329
that prevent even<font color="#CCCCCC"> dom operator</font><font color="#E5E5E5"> dumb</font>

109
00:04:18,839 --> 00:04:23,250
operators from making a mistake<font color="#CCCCCC"> that's</font>

110
00:04:21,329 --> 00:04:25,469
<font color="#E5E5E5">going to get them caught as well as the</font>

111
00:04:23,250 --> 00:04:26,950
<font color="#E5E5E5">platform itself has a lot</font><font color="#CCCCCC"> of tooling</font><font color="#E5E5E5"> to</font>

112
00:04:25,470 --> 00:04:29,440
prevent it from doing<font color="#CCCCCC"> some</font>

113
00:04:26,950 --> 00:04:32,909
that may get<font color="#E5E5E5"> it caught by something on</font>

114
00:04:29,440 --> 00:04:35,290
the machine<font color="#E5E5E5"> or</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> a good blue team so</font>

115
00:04:32,910 --> 00:04:36,850
I'll just be giving you a brief<font color="#CCCCCC"> overview</font>

116
00:04:35,290 --> 00:04:38,860
of what<font color="#E5E5E5"> it looks like</font>

117
00:04:36,850 --> 00:04:40,930
the<font color="#E5E5E5"> equation group built in terms of</font>

118
00:04:38,860 --> 00:04:43,240
tooling and when it looks<font color="#CCCCCC"> like what</font><font color="#E5E5E5"> we</font>

119
00:04:40,930 --> 00:04:47,410
see in<font color="#CCCCCC"> this leek</font><font color="#E5E5E5"> sort of all started</font>

120
00:04:43,240 --> 00:04:49,900
being built<font color="#CCCCCC"> around 2001</font><font color="#E5E5E5"> and the dander</font>

121
00:04:47,410 --> 00:04:53,140
<font color="#CCCCCC">splits capability as it looks like today</font>

122
00:04:49,900 --> 00:04:57,580
which was from 2013<font color="#CCCCCC"> when</font><font color="#E5E5E5"> it leaked</font><font color="#CCCCCC"> was</font>

123
00:04:53,140 --> 00:04:59,289
<font color="#E5E5E5">developed in around 20 2011 and then</font>

124
00:04:57,580 --> 00:05:01,659
when we're talking about kill suit it

125
00:04:59,290 --> 00:05:04,630
looks like that was built<font color="#E5E5E5"> around 2008</font>

126
00:05:01,660 --> 00:05:09,120
and was operational until the shadow

127
00:05:04,630 --> 00:05:11,770
brokers possibly leaked it in the actual

128
00:05:09,120 --> 00:05:13,930
<font color="#E5E5E5">dump</font><font color="#CCCCCC"> there's a bunch of Python byte code</font>

129
00:05:11,770 --> 00:05:15,820
<font color="#E5E5E5">but if you</font><font color="#CCCCCC"> decompile the Python byte</font>

130
00:05:13,930 --> 00:05:17,410
code it's actually<font color="#CCCCCC"> super easy</font><font color="#E5E5E5"> to see</font>

131
00:05:15,820 --> 00:05:20,590
some of the scripting that<font color="#E5E5E5"> they have</font>

132
00:05:17,410 --> 00:05:22,690
this is a custom script based on<font color="#CCCCCC"> the</font>

133
00:05:20,590 --> 00:05:24,669
extension and what it's<font color="#E5E5E5"> used for it</font>

134
00:05:22,690 --> 00:05:27,370
seems to me like<font color="#E5E5E5"> the naming</font><font color="#CCCCCC"> is expanding</font>

135
00:05:24,670 --> 00:05:29,140
<font color="#CCCCCC">puli</font><font color="#E5E5E5"> script so it's just for their post</font>

136
00:05:27,370 --> 00:05:31,510
exploitation<font color="#E5E5E5"> for mark it's a custom</font>

137
00:05:29,140 --> 00:05:33,250
scripting language<font color="#E5E5E5"> this is actually what</font>

138
00:05:31,510 --> 00:05:36,430
expanding<font color="#CCCCCC"> puli looked like this</font><font color="#E5E5E5"> was the</font>

139
00:05:33,250 --> 00:05:38,380
tool set from 2001<font color="#E5E5E5"> looks super basic you</font>

140
00:05:36,430 --> 00:05:39,970
have<font color="#E5E5E5"> kind of a command prompt with</font>

141
00:05:38,380 --> 00:05:41,380
something on<font color="#E5E5E5"> the side</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> tells you</font>

142
00:05:39,970 --> 00:05:46,210
what's<font color="#CCCCCC"> actually running on</font><font color="#E5E5E5"> the box that</font>

143
00:05:41,380 --> 00:05:49,810
you're<font color="#E5E5E5"> targeting in 2005 we see them</font>

144
00:05:46,210 --> 00:05:53,289
<font color="#E5E5E5">start writing these danderyd scripts so</font>

145
00:05:49,810 --> 00:05:55,030
<font color="#E5E5E5">dot DDS DSS scripts and they just</font><font color="#CCCCCC"> added</font>

146
00:05:53,290 --> 00:05:56,920
a<font color="#CCCCCC"> few more capabilities to the scripting</font>

147
00:05:55,030 --> 00:06:00,450
<font color="#CCCCCC">language and</font><font color="#E5E5E5"> just kind of renamed the</font>

148
00:05:56,920 --> 00:06:03,640
scripting<font color="#CCCCCC"> language</font><font color="#E5E5E5"> and then actually in</font>

149
00:06:00,450 --> 00:06:05,229
2011 or sorry 2011 we actually see them

150
00:06:03,640 --> 00:06:07,570
start recording a lot<font color="#CCCCCC"> of this stuff</font><font color="#E5E5E5"> to</font>

151
00:06:05,230 --> 00:06:09,700
Python<font color="#E5E5E5"> so they just kind</font><font color="#CCCCCC"> of gut all that</font>

152
00:06:07,570 --> 00:06:11,260
stuff and poured it to Python<font color="#CCCCCC"> I assume</font>

153
00:06:09,700 --> 00:06:13,870
<font color="#E5E5E5">because it's probably easier</font><font color="#CCCCCC"> to have an</font>

154
00:06:11,260 --> 00:06:15,730
operator<font color="#CCCCCC"> come in and learn Python or</font>

155
00:06:13,870 --> 00:06:17,680
<font color="#CCCCCC">already know Python</font><font color="#E5E5E5"> and build more</font>

156
00:06:15,730 --> 00:06:19,650
tooling if necessary kind of on the<font color="#E5E5E5"> fly</font>

157
00:06:17,680 --> 00:06:22,030
to adapt<font color="#CCCCCC"> to what the operation needs</font>

158
00:06:19,650 --> 00:06:24,760
this is actually what<font color="#E5E5E5"> dander squits</font>

159
00:06:22,030 --> 00:06:26,200
looks like<font color="#E5E5E5"> the default theme is like</font>

160
00:06:24,760 --> 00:06:28,060
very matrix<font color="#CCCCCC"> II they actually have a</font>

161
00:06:26,200 --> 00:06:31,830
bunch<font color="#E5E5E5"> of different themes built into it</font>

162
00:06:28,060 --> 00:06:34,630
<font color="#E5E5E5">so I'm glad</font><font color="#CCCCCC"> they spent time on</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and</font>

163
00:06:31,830 --> 00:06:37,390
just<font color="#CCCCCC"> a few terms that I'll be using</font>

164
00:06:34,630 --> 00:06:39,010
during<font color="#E5E5E5"> this presentation</font><font color="#CCCCCC"> some of it is</font>

165
00:06:37,390 --> 00:06:40,740
industry parlance some of them seems to

166
00:06:39,010 --> 00:06:42,990
<font color="#CCCCCC">be specific to</font><font color="#E5E5E5"> this</font>

167
00:06:40,740 --> 00:06:44,669
<font color="#E5E5E5">group the first is target all that means</font>

168
00:06:42,990 --> 00:06:46,740
is an<font color="#CCCCCC"> attacked computer so what</font><font color="#E5E5E5"> I'm</font>

169
00:06:44,669 --> 00:06:49,229
actually targeting or what I'm pivoting

170
00:06:46,740 --> 00:06:50,130
<font color="#E5E5E5">through in the network LP stands for</font>

171
00:06:49,229 --> 00:06:52,349
listening post

172
00:06:50,130 --> 00:06:54,389
so our parlance would be a CNC server

173
00:06:52,349 --> 00:06:56,669
it's just what it's calling<font color="#E5E5E5"> back to</font><font color="#CCCCCC"> a</font>

174
00:06:54,389 --> 00:06:57,990
command<font color="#E5E5E5"> anytime you see command it's</font>

175
00:06:56,669 --> 00:06:59,940
actually<font color="#E5E5E5"> just something running on the</font>

176
00:06:57,990 --> 00:07:02,069
target<font color="#CCCCCC"> so it's not something</font><font color="#E5E5E5"> I entered</font>

177
00:06:59,940 --> 00:07:04,919
it's something that I entered<font color="#E5E5E5"> and ran</font><font color="#CCCCCC"> on</font>

178
00:07:02,069 --> 00:07:07,530
<font color="#E5E5E5">the target PSP is a personal security</font>

179
00:07:04,919 --> 00:07:09,419
<font color="#E5E5E5">product it's just</font><font color="#CCCCCC"> a V and they have some</font>

180
00:07:07,530 --> 00:07:12,000
<font color="#E5E5E5">really cool capabilities about AV</font>

181
00:07:09,419 --> 00:07:14,880
bypasses the safety<font color="#CCCCCC"> handler is what</font><font color="#E5E5E5"> I</font>

182
00:07:12,000 --> 00:07:16,949
<font color="#CCCCCC">mentioned that is registered to</font><font color="#E5E5E5"> avoid an</font>

183
00:07:14,880 --> 00:07:18,990
operator from doing something<font color="#CCCCCC"> really</font>

184
00:07:16,949 --> 00:07:21,150
dumb or something<font color="#E5E5E5"> built into the</font>

185
00:07:18,990 --> 00:07:23,520
framework<font color="#E5E5E5"> so safety handlers are</font>

186
00:07:21,150 --> 00:07:26,250
triggered based on how<font color="#E5E5E5"> a V is configured</font>

187
00:07:23,520 --> 00:07:28,049
and what a<font color="#E5E5E5"> V is installed</font><font color="#CCCCCC"> so if the AV</font>

188
00:07:26,250 --> 00:07:30,330
is likely to catch them injecting into

189
00:07:28,050 --> 00:07:32,669
<font color="#E5E5E5">the</font><font color="#CCCCCC"> L sauce process they'll disable</font><font color="#E5E5E5"> that</font>

190
00:07:30,330 --> 00:07:34,740
capability<font color="#E5E5E5"> and prevent an operator or</font>

191
00:07:32,669 --> 00:07:37,258
any other automatic tools from doing

192
00:07:34,740 --> 00:07:39,210
that<font color="#CCCCCC"> and finally the implants just a</font>

193
00:07:37,259 --> 00:07:42,690
<font color="#CCCCCC">backdoor it's</font><font color="#E5E5E5"> just the actual malicious</font>

194
00:07:39,210 --> 00:07:44,729
code that's deployed on the<font color="#E5E5E5"> target quick</font>

195
00:07:42,690 --> 00:07:47,370
overview<font color="#E5E5E5"> like I mentioned of what</font>

196
00:07:44,729 --> 00:07:49,919
<font color="#E5E5E5">exactly it looks like post exploitation</font>

197
00:07:47,370 --> 00:07:51,840
was<font color="#CCCCCC"> it's fuzz</font><font color="#E5E5E5"> Bunch</font><font color="#CCCCCC"> which is their</font>

198
00:07:49,919 --> 00:07:54,330
<font color="#CCCCCC">Metasploit like framework</font><font color="#E5E5E5"> that was</font>

199
00:07:51,840 --> 00:07:56,219
leaked<font color="#E5E5E5"> by the shadow brokers and then</font>

200
00:07:54,330 --> 00:07:57,750
you have the exploit<font color="#CCCCCC"> the framework</font>

201
00:07:56,219 --> 00:07:59,550
<font color="#CCCCCC">actually has the ability to</font><font color="#E5E5E5"> tell you</font>

202
00:07:57,750 --> 00:08:01,349
what exploit it thinks you should use

203
00:07:59,550 --> 00:08:03,659
<font color="#E5E5E5">based on what the machine was vulnerable</font>

204
00:08:01,349 --> 00:08:05,639
to<font color="#E5E5E5"> so you can just say hey use eternal</font>

205
00:08:03,659 --> 00:08:08,370
blue or eternal romance or any of those

206
00:08:05,639 --> 00:08:10,560
and then double pulsars the backdoor<font color="#CCCCCC"> so</font>

207
00:08:08,370 --> 00:08:12,840
the<font color="#E5E5E5"> actual thing the ring zero thing</font>

208
00:08:10,560 --> 00:08:15,120
that's responsible<font color="#E5E5E5"> for</font><font color="#CCCCCC"> executing shell</font>

209
00:08:12,840 --> 00:08:17,729
code or<font color="#E5E5E5"> DLL or whatever you pass it</font>

210
00:08:15,120 --> 00:08:19,560
which is<font color="#E5E5E5"> actually your implant pedal</font>

211
00:08:17,729 --> 00:08:21,289
cheap in this case is<font color="#E5E5E5"> the implant</font>

212
00:08:19,560 --> 00:08:24,120
<font color="#CCCCCC">it's what's responsible</font><font color="#E5E5E5"> for executing</font>

213
00:08:21,289 --> 00:08:26,190
<font color="#E5E5E5">commands on the box and then calling</font>

214
00:08:24,120 --> 00:08:28,169
back<font color="#CCCCCC"> to the CNC server that listening</font>

215
00:08:26,190 --> 00:08:30,330
post<font color="#E5E5E5"> and when we're talking about</font><font color="#CCCCCC"> danish</font>

216
00:08:28,169 --> 00:08:32,610
<font color="#CCCCCC">blitz as the framework danish</font><font color="#E5E5E5"> grits is</font>

217
00:08:30,330 --> 00:08:34,679
actually the listening<font color="#E5E5E5"> post so it is the</font>

218
00:08:32,610 --> 00:08:36,360
<font color="#CCCCCC">CNC system</font><font color="#E5E5E5"> that the thing is calling</font>

219
00:08:34,679 --> 00:08:38,760
back to<font color="#CCCCCC"> but it's also the software that</font>

220
00:08:36,360 --> 00:08:43,560
you're<font color="#CCCCCC"> using to communicate with the</font>

221
00:08:38,760 --> 00:08:46,200
implant<font color="#CCCCCC"> alright so what exactly is kill</font>

222
00:08:43,559 --> 00:08:48,689
suit<font color="#E5E5E5"> I have</font><font color="#CCCCCC"> to tease you first</font><font color="#E5E5E5"> and just</font>

223
00:08:46,200 --> 00:08:51,060
tell you that<font color="#CCCCCC"> based on</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> research it</font>

224
00:08:48,690 --> 00:08:54,120
looks<font color="#CCCCCC"> like first</font><font color="#E5E5E5"> kill suit is not</font>

225
00:08:51,060 --> 00:08:54,779
specific to<font color="#CCCCCC"> dander spirits in a later</font>

226
00:08:54,120 --> 00:08:57,480
<font color="#CCCCCC">leak</font>

227
00:08:54,779 --> 00:09:01,110
the shadow workers there was a leak of a

228
00:08:57,480 --> 00:09:03,569
unmarked<font color="#E5E5E5"> United rake manual which</font>

229
00:09:01,110 --> 00:09:04,949
actually references another sort of

230
00:09:03,569 --> 00:09:07,498
lighter weight post exploitation

231
00:09:04,949 --> 00:09:09,300
capability toolkit and if you read

232
00:09:07,499 --> 00:09:12,839
through<font color="#E5E5E5"> that toolkit and that manual</font>

233
00:09:09,300 --> 00:09:14,729
<font color="#E5E5E5">they actually mention and call out</font><font color="#CCCCCC"> kill</font>

234
00:09:12,839 --> 00:09:16,470
suit or<font color="#CCCCCC"> ki-suh as they call</font><font color="#E5E5E5"> it as a</font>

235
00:09:14,730 --> 00:09:19,259
capability<font color="#E5E5E5"> that can be deployed</font><font color="#CCCCCC"> by this</font>

236
00:09:16,470 --> 00:09:22,740
toolkit<font color="#CCCCCC"> so it seems</font><font color="#E5E5E5"> like kill suit is</font>

237
00:09:19,259 --> 00:09:25,079
kind<font color="#E5E5E5"> of an extremely modular and very</font>

238
00:09:22,740 --> 00:09:26,879
easy to<font color="#E5E5E5"> configure to use across a wide</font>

239
00:09:25,079 --> 00:09:30,388
<font color="#CCCCCC">range of</font><font color="#E5E5E5"> different operations</font><font color="#CCCCCC"> and needs</font>

240
00:09:26,879 --> 00:09:32,430
<font color="#E5E5E5">so</font><font color="#CCCCCC"> okay what exactly is kill suit</font><font color="#E5E5E5"> kill</font>

241
00:09:30,389 --> 00:09:34,740
suits actually<font color="#E5E5E5"> a super modular</font>

242
00:09:32,430 --> 00:09:37,258
persistence framework<font color="#E5E5E5"> it's built to get</font>

243
00:09:34,740 --> 00:09:38,910
persistence on the<font color="#E5E5E5"> box to actually</font>

244
00:09:37,259 --> 00:09:42,569
deploy<font color="#E5E5E5"> something that calls back to you</font>

245
00:09:38,910 --> 00:09:44,999
<font color="#E5E5E5">or deploy recon and data exfil tools it</font>

246
00:09:42,569 --> 00:09:47,370
supports<font color="#E5E5E5"> multiple persistent methods</font>

247
00:09:44,999 --> 00:09:49,980
<font color="#E5E5E5">some of them are</font><font color="#CCCCCC"> really crazy</font><font color="#E5E5E5"> complex</font>

248
00:09:47,370 --> 00:09:53,939
you can actually<font color="#E5E5E5"> load different plugins</font>

249
00:09:49,980 --> 00:09:56,579
<font color="#E5E5E5">so a plug-in can be either a DLL or a</font>

250
00:09:53,939 --> 00:09:58,259
more complex implant that<font color="#E5E5E5"> has different</font>

251
00:09:56,579 --> 00:10:00,569
<font color="#CCCCCC">capabilities that the equation group</font>

252
00:09:58,259 --> 00:10:03,389
needs for this specific operation<font color="#CCCCCC"> and</font>

253
00:10:00,569 --> 00:10:04,979
then it actually<font color="#CCCCCC"> uses encryption</font><font color="#E5E5E5"> for</font>

254
00:10:03,389 --> 00:10:07,259
everything<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> actually why the</font>

255
00:10:04,980 --> 00:10:09,449
equation group got its name everything

256
00:10:07,259 --> 00:10:11,970
that touches this machine is encrypted

257
00:10:09,449 --> 00:10:14,430
<font color="#CCCCCC">each stage is encrypted separately</font>

258
00:10:11,970 --> 00:10:16,019
making<font color="#CCCCCC"> it very difficult for</font><font color="#E5E5E5"> even a</font>

259
00:10:14,430 --> 00:10:19,229
<font color="#E5E5E5">well-trained blue team to figure out</font>

260
00:10:16,019 --> 00:10:21,360
what the hell is going on so there's

261
00:10:19,230 --> 00:10:23,579
quite<font color="#E5E5E5"> a few different</font><font color="#CCCCCC"> terms within kill</font>

262
00:10:21,360 --> 00:10:26,009
suit<font color="#CCCCCC"> some of them got confusing</font><font color="#E5E5E5"> to me as</font>

263
00:10:23,579 --> 00:10:29,550
I went<font color="#E5E5E5"> along</font><font color="#CCCCCC"> the first is</font><font color="#E5E5E5"> this concept</font>

264
00:10:26,009 --> 00:10:31,740
<font color="#E5E5E5">of an instance so an instance is just a</font>

265
00:10:29,550 --> 00:10:33,750
different specific<font color="#E5E5E5"> instance of kill suit</font>

266
00:10:31,740 --> 00:10:35,370
<font color="#E5E5E5">which tells you that multiple instances</font>

267
00:10:33,750 --> 00:10:37,500
of kill suit can actually be installed

268
00:10:35,370 --> 00:10:39,120
persistently on this machine<font color="#CCCCCC"> to launch</font>

269
00:10:37,500 --> 00:10:42,420
different implants depending on the

270
00:10:39,120 --> 00:10:44,730
needs some<font color="#E5E5E5"> implants actually</font><font color="#CCCCCC"> have what</font>

271
00:10:42,420 --> 00:10:47,040
they call a<font color="#E5E5E5"> specific key</font><font color="#CCCCCC"> su type so</font>

272
00:10:44,730 --> 00:10:51,120
there's a type registered for kill suit

273
00:10:47,040 --> 00:10:53,459
<font color="#E5E5E5">for a complex implant the launcher as</font>

274
00:10:51,120 --> 00:10:56,220
they call<font color="#CCCCCC"> it is just a driver</font>

275
00:10:53,459 --> 00:10:58,679
<font color="#CCCCCC">that's exploited to get kind of</font><font color="#E5E5E5"> kernel</font>

276
00:10:56,220 --> 00:11:02,730
<font color="#E5E5E5">mode code execution if they need that</font>

277
00:10:58,679 --> 00:11:04,379
<font color="#E5E5E5">in the implant and a module is just like</font>

278
00:11:02,730 --> 00:11:06,149
a<font color="#E5E5E5"> plug-in or a thing that's actually</font>

279
00:11:04,379 --> 00:11:08,640
running<font color="#E5E5E5"> as part</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> that implant some</font>

280
00:11:06,149 --> 00:11:11,339
implant have<font color="#E5E5E5"> kernel mode capability</font>

281
00:11:08,640 --> 00:11:13,170
<font color="#E5E5E5">user mode capability and then other</font>

282
00:11:11,339 --> 00:11:15,209
types<font color="#E5E5E5"> of capabilities</font><font color="#CCCCCC"> that are</font>

283
00:11:13,170 --> 00:11:18,209
responsible for silently<font color="#E5E5E5"> exfilling data</font>

284
00:11:15,209 --> 00:11:20,699
<font color="#E5E5E5">and then the module store as they call</font>

285
00:11:18,209 --> 00:11:22,949
<font color="#CCCCCC">it is actually a fully encrypted virtual</font>

286
00:11:20,700 --> 00:11:25,380
file system<font color="#CCCCCC"> that resides all in the</font>

287
00:11:22,950 --> 00:11:27,360
registry<font color="#E5E5E5"> so for persistence they do need</font>

288
00:11:25,380 --> 00:11:30,480
<font color="#E5E5E5">to touch disk but it all resides</font>

289
00:11:27,360 --> 00:11:32,910
encrypted in the registry there's a lot

290
00:11:30,480 --> 00:11:35,700
<font color="#E5E5E5">of cool tooling</font><font color="#CCCCCC"> around interacting</font><font color="#E5E5E5"> with</font>

291
00:11:32,910 --> 00:11:37,469
kill suit within dander<font color="#E5E5E5"> spirits</font><font color="#CCCCCC"> as you</font>

292
00:11:35,700 --> 00:11:39,390
see in this case<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> actually running a</font>

293
00:11:37,470 --> 00:11:41,550
command<font color="#CCCCCC"> that's called key su</font><font color="#E5E5E5"> survey</font><font color="#CCCCCC"> and</font>

294
00:11:39,390 --> 00:11:43,949
the point of<font color="#E5E5E5"> key su survey is</font><font color="#CCCCCC"> to tell</font>

295
00:11:41,550 --> 00:11:46,949
the operator<font color="#E5E5E5"> the type</font><font color="#CCCCCC"> of persistence</font>

296
00:11:43,950 --> 00:11:49,680
<font color="#CCCCCC">that's supported by this machine</font><font color="#E5E5E5"> based</font>

297
00:11:46,950 --> 00:11:52,769
on what it<font color="#CCCCCC"> is</font><font color="#E5E5E5"> you can see that they have</font>

298
00:11:49,680 --> 00:11:55,620
persistence<font color="#E5E5E5"> via driver which is just a</font>

299
00:11:52,769 --> 00:11:57,990
driver<font color="#CCCCCC"> so</font><font color="#E5E5E5"> non if you're on an operating</font>

300
00:11:55,620 --> 00:11:59,820
<font color="#CCCCCC">system like</font><font color="#E5E5E5"> Windows 7</font><font color="#CCCCCC"> 32 bit</font><font color="#E5E5E5"> that</font>

301
00:11:57,990 --> 00:12:01,649
doesn't require driver signing by

302
00:11:59,820 --> 00:12:03,390
default<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> just persist with a</font>

303
00:12:01,649 --> 00:12:06,180
driver drop a driver and<font color="#CCCCCC"> that's your</font>

304
00:12:03,390 --> 00:12:09,510
method<font color="#E5E5E5"> pretty easy so T is a more</font>

305
00:12:06,180 --> 00:12:11,489
complex<font color="#CCCCCC"> persistence mechanism that I'll</font>

306
00:12:09,510 --> 00:12:13,769
cover in<font color="#CCCCCC"> just a second but that</font><font color="#E5E5E5"> stands</font>

307
00:12:11,490 --> 00:12:15,480
<font color="#E5E5E5">for solar time that's</font><font color="#CCCCCC"> what's so T stands</font>

308
00:12:13,769 --> 00:12:19,290
<font color="#CCCCCC">for it's actually</font><font color="#E5E5E5"> pretty cool how they</font>

309
00:12:15,480 --> 00:12:21,420
did this<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> juvey is just visiting</font>

310
00:12:19,290 --> 00:12:23,430
which<font color="#E5E5E5"> I have to say is a fantastic name</font>

311
00:12:21,420 --> 00:12:26,339
for a persistence implant<font color="#E5E5E5"> like super</font>

312
00:12:23,430 --> 00:12:28,649
cool<font color="#CCCCCC"> and it</font><font color="#E5E5E5"> was actually only supported</font>

313
00:12:26,339 --> 00:12:30,240
by<font color="#E5E5E5"> XP</font><font color="#CCCCCC"> I wasn't super</font><font color="#E5E5E5"> thrilled so I</font>

314
00:12:28,649 --> 00:12:31,800
didn't<font color="#E5E5E5"> really dig into it but I</font>

315
00:12:30,240 --> 00:12:35,279
<font color="#CCCCCC">encourage some of you to</font><font color="#E5E5E5"> look at what</font>

316
00:12:31,800 --> 00:12:37,949
that<font color="#CCCCCC"> does</font><font color="#E5E5E5"> so all right what exactly</font><font color="#CCCCCC"> is</font>

317
00:12:35,279 --> 00:12:41,250
solar time<font color="#E5E5E5"> so if the equation groups on</font>

318
00:12:37,949 --> 00:12:43,890
a machine<font color="#E5E5E5"> that requires actual driver</font>

319
00:12:41,250 --> 00:12:45,750
signing the driver has<font color="#CCCCCC"> to be</font><font color="#E5E5E5"> signed one</font>

320
00:12:43,890 --> 00:12:48,839
<font color="#CCCCCC">within the</font><font color="#E5E5E5"> toolkit they do have the</font>

321
00:12:45,750 --> 00:12:50,970
capability if they have a<font color="#CCCCCC"> certificate to</font>

322
00:12:48,839 --> 00:12:52,680
<font color="#E5E5E5">sign the drivers or all the things that</font>

323
00:12:50,970 --> 00:12:54,779
they're<font color="#E5E5E5"> dropping but</font><font color="#CCCCCC"> maybe they</font><font color="#E5E5E5"> don't</font>

324
00:12:52,680 --> 00:12:57,420
<font color="#E5E5E5">want to blow a certificate that</font><font color="#CCCCCC"> they've</font>

325
00:12:54,779 --> 00:12:59,670
somehow retrieved or stolen<font color="#E5E5E5"> for this</font>

326
00:12:57,420 --> 00:13:02,910
<font color="#E5E5E5">operation they can actually implant the</font>

327
00:12:59,670 --> 00:13:06,449
machine<font color="#E5E5E5"> with solar time which is a super</font>

328
00:13:02,910 --> 00:13:08,519
complex<font color="#E5E5E5"> a volume boot record boot kit</font><font color="#CCCCCC"> so</font>

329
00:13:06,449 --> 00:13:10,829
it's a fully<font color="#CCCCCC"> functional boot kit that's</font>

330
00:13:08,519 --> 00:13:12,480
responsible for gaming persistence on

331
00:13:10,829 --> 00:13:14,699
the machine<font color="#CCCCCC"> it does this</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> actually</font>

332
00:13:12,480 --> 00:13:16,829
modifying the volume<font color="#CCCCCC"> boot record</font><font color="#E5E5E5"> which</font>

333
00:13:14,699 --> 00:13:19,500
is right after the Master Boot Record on

334
00:13:16,829 --> 00:13:22,400
<font color="#E5E5E5">disk and then is responsible</font><font color="#CCCCCC"> for kind</font><font color="#E5E5E5"> of</font>

335
00:13:19,500 --> 00:13:25,310
hijacking<font color="#CCCCCC"> Windows as</font><font color="#E5E5E5"> it were</font>

336
00:13:22,400 --> 00:13:28,160
I'll dig<font color="#E5E5E5"> into that in just</font><font color="#CCCCCC"> a bit</font><font color="#E5E5E5"> and</font>

337
00:13:25,310 --> 00:13:30,709
solar time actually uses<font color="#CCCCCC"> TrueType font</font>

338
00:13:28,160 --> 00:13:32,719
files as an encrypted container so they

339
00:13:30,710 --> 00:13:35,240
do drop something on disk<font color="#E5E5E5"> that's not in</font>

340
00:13:32,720 --> 00:13:36,980
registry it's a true type font file and

341
00:13:35,240 --> 00:13:38,840
that's<font color="#E5E5E5"> an encrypted container that</font>

342
00:13:36,980 --> 00:13:41,150
<font color="#E5E5E5">actually contains the kernel driver that</font>

343
00:13:38,840 --> 00:13:43,970
they're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> load as they're kind of</font>

344
00:13:41,150 --> 00:13:46,850
hijacking<font color="#CCCCCC"> Windows when it boots</font><font color="#E5E5E5"> the way</font>

345
00:13:43,970 --> 00:13:49,550
it<font color="#E5E5E5"> actually works</font><font color="#CCCCCC"> is it'll hijack the</font>

346
00:13:46,850 --> 00:13:52,250
<font color="#CCCCCC">bbr so the volume Boot Record</font><font color="#E5E5E5"> and then</font>

347
00:13:49,550 --> 00:13:55,010
let<font color="#E5E5E5"> windows proceed booting until it</font>

348
00:13:52,250 --> 00:13:56,570
gets to win low<font color="#E5E5E5"> DXE which is the</font>

349
00:13:55,010 --> 00:13:59,510
software<font color="#E5E5E5"> that's actually</font><font color="#CCCCCC"> responsible</font>

350
00:13:56,570 --> 00:14:01,760
<font color="#E5E5E5">from taking the processor from</font><font color="#CCCCCC"> like real</font>

351
00:13:59,510 --> 00:14:05,870
mode<font color="#E5E5E5"> to what we use today</font>

352
00:14:01,760 --> 00:14:07,880
and<font color="#CCCCCC"> when</font><font color="#E5E5E5"> load that</font><font color="#CCCCCC"> exe</font><font color="#E5E5E5"> is patched</font><font color="#CCCCCC"> they</font>

353
00:14:05,870 --> 00:14:09,710
look for the<font color="#E5E5E5"> very first driver that has</font>

354
00:14:07,880 --> 00:14:11,420
the capabilities that<font color="#E5E5E5"> they need and that</font>

355
00:14:09,710 --> 00:14:13,130
<font color="#E5E5E5">they</font><font color="#CCCCCC"> know is vulnerable</font><font color="#E5E5E5"> so they're</font>

356
00:14:11,420 --> 00:14:14,270
<font color="#E5E5E5">building a list of all the drivers</font><font color="#CCCCCC"> that</font>

357
00:14:13,130 --> 00:14:16,910
are<font color="#E5E5E5"> installed on the</font><font color="#CCCCCC"> machine and</font>

358
00:14:14,270 --> 00:14:19,160
selecting one<font color="#E5E5E5"> randomly that knows it has</font>

359
00:14:16,910 --> 00:14:22,610
the capabilities that<font color="#E5E5E5"> they</font><font color="#CCCCCC"> need when</font>

360
00:14:19,160 --> 00:14:25,910
this is booting then they'll actually go

361
00:14:22,610 --> 00:14:29,360
ahead<font color="#E5E5E5"> and hijack</font><font color="#CCCCCC"> that first</font><font color="#E5E5E5"> kernel</font>

362
00:14:25,910 --> 00:14:32,420
driver<font color="#E5E5E5"> during boot</font><font color="#CCCCCC"> and start their</font>

363
00:14:29,360 --> 00:14:34,280
specific<font color="#CCCCCC"> kernel mode</font><font color="#E5E5E5"> there's a lot of</font>

364
00:14:32,420 --> 00:14:35,810
tooling like I mentioned that's built

365
00:14:34,280 --> 00:14:37,880
<font color="#E5E5E5">into</font><font color="#CCCCCC"> dangerous boots that</font><font color="#E5E5E5"> I encourage</font>

366
00:14:35,810 --> 00:14:39,890
you to<font color="#CCCCCC"> check out this</font><font color="#E5E5E5"> is a really sweet</font>

367
00:14:37,880 --> 00:14:42,650
Python script<font color="#E5E5E5"> that they wrote called</font>

368
00:14:39,890 --> 00:14:44,660
<font color="#E5E5E5">check so T so check solar time which was</font>

369
00:14:42,650 --> 00:14:47,449
actually<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to just tell me</font><font color="#E5E5E5"> which</font>

370
00:14:44,660 --> 00:14:49,040
<font color="#E5E5E5">specific</font><font color="#CCCCCC"> true type font file they</font>

371
00:14:47,450 --> 00:14:51,500
determined was not being<font color="#E5E5E5"> used</font><font color="#CCCCCC"> in the</font>

372
00:14:49,040 --> 00:14:54,079
<font color="#E5E5E5">system and they actually wrote a</font>

373
00:14:51,500 --> 00:14:55,700
encrypted<font color="#E5E5E5"> container</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> so this is</font>

374
00:14:54,080 --> 00:15:00,200
where<font color="#E5E5E5"> the encrypted kernel mode driver</font>

375
00:14:55,700 --> 00:15:01,940
lives<font color="#E5E5E5"> it then starts launching what they</font>

376
00:15:00,200 --> 00:15:04,640
call a kernel mode<font color="#CCCCCC"> Orchestrator</font><font color="#E5E5E5"> the</font>

377
00:15:01,940 --> 00:15:06,860
kernel<font color="#E5E5E5"> mode</font><font color="#CCCCCC"> Orchestrator</font><font color="#E5E5E5"> is actually</font>

378
00:15:04,640 --> 00:15:08,870
responsible<font color="#CCCCCC"> for orchestrating any type</font>

379
00:15:06,860 --> 00:15:11,030
<font color="#CCCCCC">of access to kernel mode code execution</font>

380
00:15:08,870 --> 00:15:13,340
if they need it<font color="#CCCCCC"> so if an implant needs</font>

381
00:15:11,030 --> 00:15:14,750
kernel mode code<font color="#E5E5E5"> execution it goes</font>

382
00:15:13,340 --> 00:15:17,200
through this kernel mode<font color="#CCCCCC"> Orchestrator</font>

383
00:15:14,750 --> 00:15:20,420
<font color="#E5E5E5">and get stitched</font><font color="#CCCCCC"> dispatched that way</font>

384
00:15:17,200 --> 00:15:23,570
<font color="#E5E5E5">this as</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> mentioned gives them access to</font>

385
00:15:20,420 --> 00:15:25,900
<font color="#E5E5E5">run unsigned</font><font color="#CCCCCC"> kernel mode code and user</font>

386
00:15:23,570 --> 00:15:28,220
<font color="#CCCCCC">mode code</font><font color="#E5E5E5"> it's actually really dope</font><font color="#CCCCCC"> and</font>

387
00:15:25,900 --> 00:15:30,439
then they begin launching implants

388
00:15:28,220 --> 00:15:33,380
implants<font color="#E5E5E5"> can be configured in a myriad</font>

389
00:15:30,440 --> 00:15:35,330
of ways<font color="#E5E5E5"> you can say hey launch when this</font>

390
00:15:33,380 --> 00:15:35,779
service<font color="#CCCCCC"> launched inject into</font><font color="#E5E5E5"> that</font>

391
00:15:35,330 --> 00:15:38,600
process

392
00:15:35,779 --> 00:15:41,839
<font color="#E5E5E5">memory and then start</font><font color="#CCCCCC"> using whatever the</font>

393
00:15:38,600 --> 00:15:43,999
implant is an interesting<font color="#E5E5E5"> thing about</font>

394
00:15:41,839 --> 00:15:46,249
<font color="#E5E5E5">solar time specifically is that</font>

395
00:15:43,999 --> 00:15:48,949
Kaspersky actually talked about<font color="#E5E5E5"> it in</font>

396
00:15:46,249 --> 00:15:51,439
their 2015<font color="#E5E5E5"> report about the equation</font>

397
00:15:48,949 --> 00:15:54,469
<font color="#E5E5E5">group after</font><font color="#CCCCCC"> I had done some digging into</font>

398
00:15:51,439 --> 00:15:57,019
how this<font color="#E5E5E5"> toolkit worked and what solar</font>

399
00:15:54,470 --> 00:15:58,819
<font color="#E5E5E5">time was doing specifically</font><font color="#CCCCCC"> I looked at</font>

400
00:15:57,019 --> 00:16:01,339
this report<font color="#CCCCCC"> and was really</font><font color="#E5E5E5"> interested to</font>

401
00:15:58,819 --> 00:16:03,759
<font color="#E5E5E5">see</font><font color="#CCCCCC"> that they had actually reversed a</font>

402
00:16:01,339 --> 00:16:06,800
lot of it<font color="#E5E5E5"> in the report they called</font>

403
00:16:03,759 --> 00:16:08,149
solar time<font color="#CCCCCC"> plus kill suit</font><font color="#E5E5E5"> two different</font>

404
00:16:06,800 --> 00:16:11,209
<font color="#E5E5E5">frameworks so a framework and a</font>

405
00:16:08,149 --> 00:16:12,920
persistence method<font color="#E5E5E5"> as</font><font color="#CCCCCC"> gray fish they</font>

406
00:16:11,209 --> 00:16:14,779
thought that gray fish was kind of the

407
00:16:12,920 --> 00:16:16,459
<font color="#E5E5E5">next</font><font color="#CCCCCC"> iteration</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> their post</font>

408
00:16:14,779 --> 00:16:18,829
exploitation<font color="#CCCCCC"> toolkits</font><font color="#E5E5E5"> and implants</font>

409
00:16:16,459 --> 00:16:23,628
<font color="#E5E5E5">that's not the case it's just a method</font>

410
00:16:18,829 --> 00:16:25,969
for persistence<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so let's get to</font>

411
00:16:23,629 --> 00:16:28,420
the<font color="#CCCCCC"> good stuff how do they actually</font>

412
00:16:25,970 --> 00:16:31,249
avoid defenders or blue teams in<font color="#E5E5E5"> general</font>

413
00:16:28,420 --> 00:16:33,378
<font color="#E5E5E5">well</font><font color="#CCCCCC"> the first mode is like I</font><font color="#E5E5E5"> mentioned</font>

414
00:16:31,249 --> 00:16:36,319
everything<font color="#E5E5E5"> is encrypted with</font><font color="#CCCCCC"> a unique</font>

415
00:16:33,379 --> 00:16:39,499
<font color="#E5E5E5">keeper target so</font><font color="#CCCCCC"> they're actually</font>

416
00:16:36,319 --> 00:16:40,939
finding like NTFS<font color="#E5E5E5"> IDs of specific files</font>

417
00:16:39,499 --> 00:16:44,209
that exist<font color="#CCCCCC"> that are going</font><font color="#E5E5E5"> to be unique</font>

418
00:16:40,939 --> 00:16:46,399
<font color="#CCCCCC">per system and</font><font color="#E5E5E5"> seeding all their crypto</font>

419
00:16:44,209 --> 00:16:48,170
with that<font color="#E5E5E5"> so every single target is</font>

420
00:16:46,399 --> 00:16:50,569
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a unique key if you have</font>

421
00:16:48,170 --> 00:16:52,430
seven of seven systems implanted on your

422
00:16:50,569 --> 00:16:54,889
network they're all not going to be

423
00:16:52,430 --> 00:16:56,569
using the<font color="#E5E5E5"> same stuff</font><font color="#CCCCCC"> as I mentioned they</font>

424
00:16:54,889 --> 00:17:00,889
actually encrypt a full virtual file

425
00:16:56,569 --> 00:17:02,599
<font color="#CCCCCC">system in registry and every method or</font>

426
00:17:00,889 --> 00:17:04,699
every component of kill suits

427
00:17:02,600 --> 00:17:08,959
responsible for decrypting the<font color="#E5E5E5"> next</font>

428
00:17:04,699 --> 00:17:11,360
stage<font color="#E5E5E5"> and a lot</font><font color="#CCCCCC"> of it is process</font>

429
00:17:08,959 --> 00:17:14,709
injection for user mode code<font color="#E5E5E5"> if they</font>

430
00:17:11,359 --> 00:17:17,839
have to touch disk remember this is<font color="#E5E5E5"> 2013</font>

431
00:17:14,709 --> 00:17:20,360
<font color="#CCCCCC">they actually will drop something</font><font color="#E5E5E5"> and</font>

432
00:17:17,839 --> 00:17:23,059
then automatically<font color="#E5E5E5"> do time stamping so</font>

433
00:17:20,359 --> 00:17:25,069
if kill suit or any framework says hey I

434
00:17:23,059 --> 00:17:27,139
just<font color="#E5E5E5"> dropped something on disk they'll</font>

435
00:17:25,069 --> 00:17:29,539
go and automatically<font color="#E5E5E5"> match</font><font color="#CCCCCC"> timestamps</font>

436
00:17:27,140 --> 00:17:31,250
<font color="#E5E5E5">with an executable that they know was</font>

437
00:17:29,539 --> 00:17:33,710
installed around<font color="#E5E5E5"> the time windows was</font>

438
00:17:31,250 --> 00:17:36,830
installed it's all<font color="#E5E5E5"> automatic and pretty</font>

439
00:17:33,710 --> 00:17:40,039
<font color="#E5E5E5">cool one of my favorite capabilities</font>

440
00:17:36,830 --> 00:17:42,408
that comes with this<font color="#E5E5E5"> toolkit is they</font>

441
00:17:40,039 --> 00:17:45,230
<font color="#E5E5E5">actually wrote their own custom tcp/ip</font>

442
00:17:42,409 --> 00:17:47,809
stack to avoid detection<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> host so</font>

443
00:17:45,230 --> 00:17:49,100
<font color="#E5E5E5">you're cool maybe you're a red team or</font>

444
00:17:47,809 --> 00:17:51,230
you have implants

445
00:17:49,100 --> 00:17:54,919
you're probably not like I wrote my own

446
00:17:51,230 --> 00:17:57,140
tcp/ip<font color="#CCCCCC"> stack</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> bypass a V</font><font color="#E5E5E5"> like bypass</font>

447
00:17:54,920 --> 00:18:00,340
things type of cool and if you are props

448
00:17:57,140 --> 00:18:04,430
to you man come talk to<font color="#E5E5E5"> me after</font><font color="#CCCCCC"> so it's</font>

449
00:18:00,340 --> 00:18:07,730
entirely done to provide<font color="#E5E5E5"> covert non</font>

450
00:18:04,430 --> 00:18:09,920
<font color="#E5E5E5">windsock</font><font color="#CCCCCC"> api interactions for all of</font>

451
00:18:07,730 --> 00:18:11,810
their network tooling and implants<font color="#E5E5E5"> what</font>

452
00:18:09,920 --> 00:18:14,030
this means is that you as a<font color="#CCCCCC"> defender</font>

453
00:18:11,810 --> 00:18:15,950
like me<font color="#E5E5E5"> I'm a blue team guy are looking</font>

454
00:18:14,030 --> 00:18:18,110
at like<font color="#CCCCCC"> net stat or Wireshark on the</font>

455
00:18:15,950 --> 00:18:19,970
machine<font color="#E5E5E5"> to see what</font><font color="#CCCCCC"> type of traffic</font><font color="#E5E5E5"> is</font>

456
00:18:18,110 --> 00:18:22,580
going<font color="#E5E5E5"> through it you're not gonna see</font>

457
00:18:19,970 --> 00:18:25,490
anything<font color="#E5E5E5"> it's all custom written they</font>

458
00:18:22,580 --> 00:18:28,550
have two different<font color="#E5E5E5"> versions of this flu</font>

459
00:18:25,490 --> 00:18:31,370
<font color="#E5E5E5">Avenue is an ipv4 driver so like if you</font>

460
00:18:28,550 --> 00:18:33,050
<font color="#CCCCCC">need ipv4 and</font><font color="#E5E5E5"> they're actually super</font>

461
00:18:31,370 --> 00:18:34,699
<font color="#CCCCCC">forward-looking I don't know who they</font>

462
00:18:33,050 --> 00:18:37,220
were implanting but they also have an

463
00:18:34,700 --> 00:18:41,030
ipv6 capability<font color="#E5E5E5"> so it's pretty</font>

464
00:18:37,220 --> 00:18:43,160
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> in in the dander speech</font>

465
00:18:41,030 --> 00:18:45,710
framework there's a lot of tooling<font color="#E5E5E5"> to</font>

466
00:18:43,160 --> 00:18:49,280
interact with<font color="#CCCCCC"> flew Avenue or</font><font color="#E5E5E5"> Dorman</font><font color="#CCCCCC"> goz</font>

467
00:18:45,710 --> 00:18:52,870
<font color="#E5E5E5">here you see me running a command that</font>

468
00:18:49,280 --> 00:18:55,520
actually gives me<font color="#E5E5E5"> feedback about</font><font color="#CCCCCC"> okay is</font>

469
00:18:52,870 --> 00:18:58,580
<font color="#CCCCCC">flu Avenue actually properly</font><font color="#E5E5E5"> installed</font>

470
00:18:55,520 --> 00:19:00,620
<font color="#E5E5E5">and which different types of network</font>

471
00:18:58,580 --> 00:19:03,740
interfaces does it see available<font color="#E5E5E5"> to me</font>

472
00:19:00,620 --> 00:19:07,280
<font color="#CCCCCC">for use with this capability they did a</font>

473
00:19:03,740 --> 00:19:10,070
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> things around</font><font color="#E5E5E5"> using their</font>

474
00:19:07,280 --> 00:19:11,990
own<font color="#E5E5E5"> custom tcp/ip stack the first is the</font>

475
00:19:10,070 --> 00:19:14,870
<font color="#CCCCCC">ability</font><font color="#E5E5E5"> to pivot silently through this</font>

476
00:19:11,990 --> 00:19:16,880
node so<font color="#CCCCCC"> they have the capability to do</font>

477
00:19:14,870 --> 00:19:19,100
what they call a redirect which is just

478
00:19:16,880 --> 00:19:21,290
kind of put a VPN<font color="#CCCCCC"> on this system and</font>

479
00:19:19,100 --> 00:19:24,350
pivot through it to reach other systems

480
00:19:21,290 --> 00:19:27,200
<font color="#CCCCCC">if you look at their tooling that</font><font color="#E5E5E5"> is for</font>

481
00:19:24,350 --> 00:19:29,419
exploitation<font color="#E5E5E5"> like fuzz</font><font color="#CCCCCC"> bunch it's</font>

482
00:19:27,200 --> 00:19:31,760
actually capable<font color="#E5E5E5"> of</font><font color="#CCCCCC"> using what they call</font>

483
00:19:29,420 --> 00:19:34,160
a<font color="#CCCCCC"> redirector which is</font><font color="#E5E5E5"> this to actually</font>

484
00:19:31,760 --> 00:19:36,020
<font color="#CCCCCC">redirect through one system to exploit</font>

485
00:19:34,160 --> 00:19:38,990
<font color="#CCCCCC">another and it's all silent that's</font>

486
00:19:36,020 --> 00:19:41,090
pretty cool and this was a shock<font color="#CCCCCC"> to</font><font color="#E5E5E5"> me</font>

487
00:19:38,990 --> 00:19:42,950
<font color="#CCCCCC">they actually can also enable what they</font>

488
00:19:41,090 --> 00:19:44,810
call<font color="#CCCCCC"> knocking and the knocking</font>

489
00:19:42,950 --> 00:19:47,780
capability is not<font color="#E5E5E5"> just like knock a few</font>

490
00:19:44,810 --> 00:19:50,330
ports in a sequence<font color="#CCCCCC"> it's it could</font><font color="#E5E5E5"> be</font>

491
00:19:47,780 --> 00:19:52,760
something like this port<font color="#E5E5E5"> from this</font>

492
00:19:50,330 --> 00:19:54,560
source of<font color="#CCCCCC"> ephemeral port with these TCP</font>

493
00:19:52,760 --> 00:19:56,660
headers and they can have<font color="#CCCCCC"> up to</font><font color="#E5E5E5"> five of</font>

494
00:19:54,560 --> 00:19:59,300
<font color="#CCCCCC">those options</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> they actually</font>

495
00:19:56,660 --> 00:20:01,860
initiate<font color="#E5E5E5"> that knock which is call back</font>

496
00:19:59,300 --> 00:20:05,970
to me<font color="#E5E5E5"> or opening a port that's</font>

497
00:20:01,860 --> 00:20:09,000
<font color="#E5E5E5">on the implant and then they also have a</font>

498
00:20:05,970 --> 00:20:11,640
ton of crazy data gathering<font color="#E5E5E5"> capabilities</font>

499
00:20:09,000 --> 00:20:14,220
<font color="#E5E5E5">the first is sort of what you'd expect</font>

500
00:20:11,640 --> 00:20:17,460
<font color="#CCCCCC">they have a bunch of different stealthy</font>

501
00:20:14,220 --> 00:20:21,030
key loggers<font color="#CCCCCC"> they're strangelands yak and</font>

502
00:20:17,460 --> 00:20:23,179
<font color="#CCCCCC">grok and all</font><font color="#E5E5E5"> of these are implants that</font>

503
00:20:21,030 --> 00:20:26,160
<font color="#CCCCCC">can be installed persistently using a</font>

504
00:20:23,179 --> 00:20:28,799
kill suit type that's called<font color="#E5E5E5"> STL a so</font>

505
00:20:26,160 --> 00:20:30,780
strange land<font color="#CCCCCC"> and it's all encrypted</font><font color="#E5E5E5"> on</font>

506
00:20:28,799 --> 00:20:33,360
the<font color="#E5E5E5"> disk when they're</font><font color="#CCCCCC"> actually storing</font>

507
00:20:30,780 --> 00:20:36,059
keystrokes<font color="#E5E5E5"> what's actually super cool</font>

508
00:20:33,360 --> 00:20:37,709
<font color="#E5E5E5">about this tool is not</font><font color="#CCCCCC"> only does it</font>

509
00:20:36,059 --> 00:20:39,990
capture keystrokes and tell you like

510
00:20:37,710 --> 00:20:42,540
<font color="#E5E5E5">what LED lights were on the actual</font>

511
00:20:39,990 --> 00:20:44,669
keyboard<font color="#E5E5E5"> but when they pull this data</font>

512
00:20:42,540 --> 00:20:46,590
back for decryption<font color="#E5E5E5"> they actually have a</font>

513
00:20:44,669 --> 00:20:48,780
bunch<font color="#E5E5E5"> of translators built into their</font>

514
00:20:46,590 --> 00:20:51,418
encryption<font color="#E5E5E5"> or decryption tool so if the</font>

515
00:20:48,780 --> 00:20:54,059
operator<font color="#E5E5E5"> is targeting an organization</font>

516
00:20:51,419 --> 00:20:56,160
<font color="#E5E5E5">that's mainly Arabic speaking or Russian</font>

517
00:20:54,059 --> 00:20:58,020
speaking or Chinese speaking those

518
00:20:56,160 --> 00:21:00,600
keystrokes will actually be translated

519
00:20:58,020 --> 00:21:02,429
into English and ASCII<font color="#CCCCCC"> and whatever they</font>

520
00:21:00,600 --> 00:21:04,980
need<font color="#E5E5E5"> to make it easier for the operator</font>

521
00:21:02,429 --> 00:21:08,040
<font color="#E5E5E5">to understand what's</font><font color="#CCCCCC"> going on I thought</font>

522
00:21:04,980 --> 00:21:10,470
that was pretty sweet<font color="#CCCCCC"> other capabilities</font>

523
00:21:08,040 --> 00:21:12,299
<font color="#E5E5E5">that they have is dark</font><font color="#CCCCCC"> skyline so dark</font>

524
00:21:10,470 --> 00:21:15,000
skyline is a tool<font color="#CCCCCC"> that</font><font color="#E5E5E5"> can be installed</font>

525
00:21:12,299 --> 00:21:17,639
persistently and it's meant to<font color="#E5E5E5"> do packet</font>

526
00:21:15,000 --> 00:21:19,320
capture<font color="#E5E5E5"> it can actually just do kind of</font>

527
00:21:17,640 --> 00:21:22,260
raw socket packet capture as you'd

528
00:21:19,320 --> 00:21:24,270
assume from<font color="#E5E5E5"> a Wireshark</font><font color="#CCCCCC"> or TCP</font><font color="#E5E5E5"> dump type</font>

529
00:21:22,260 --> 00:21:27,059
capability but<font color="#E5E5E5"> it has a built in</font>

530
00:21:24,270 --> 00:21:29,010
<font color="#E5E5E5">Berkeley packet filter so the operator</font>

531
00:21:27,059 --> 00:21:32,760
<font color="#CCCCCC">can choose exactly</font><font color="#E5E5E5"> what traffic they</font>

532
00:21:29,010 --> 00:21:35,100
want to save and examine and this tool

533
00:21:32,760 --> 00:21:37,200
can just be installed<font color="#E5E5E5"> into an existing</font>

534
00:21:35,100 --> 00:21:39,418
kill suit instance<font color="#E5E5E5"> so if they need</font>

535
00:21:37,200 --> 00:21:40,919
persistence<font color="#E5E5E5"> for dark skyline they can</font>

536
00:21:39,419 --> 00:21:43,919
just say hey<font color="#CCCCCC"> use this instance that's</font>

537
00:21:40,919 --> 00:21:47,250
already stored and as you would assume

538
00:21:43,919 --> 00:21:49,590
<font color="#E5E5E5">all of</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> data is encrypted on</font><font color="#CCCCCC"> the</font>

539
00:21:47,250 --> 00:21:52,260
<font color="#E5E5E5">disk</font><font color="#CCCCCC"> again as a TrueType font file they</font>

540
00:21:49,590 --> 00:21:53,610
really love<font color="#E5E5E5"> this for some reason some</font><font color="#CCCCCC"> of</font>

541
00:21:52,260 --> 00:21:56,010
<font color="#E5E5E5">the cool things that they built into</font>

542
00:21:53,610 --> 00:21:58,139
this<font color="#CCCCCC"> tool kit</font><font color="#E5E5E5"> is they were being very</font>

543
00:21:56,010 --> 00:22:00,840
<font color="#E5E5E5">helpful to their operators so they built</font>

544
00:21:58,140 --> 00:22:03,299
in a bunch of default<font color="#E5E5E5"> filters that could</font>

545
00:22:00,840 --> 00:22:05,100
be applied<font color="#CCCCCC"> to dark skyline</font><font color="#E5E5E5"> so if you're</font>

546
00:22:03,299 --> 00:22:07,710
looking<font color="#CCCCCC"> for as an example</font>

547
00:22:05,100 --> 00:22:09,990
<font color="#CCCCCC">Cisco discovery protocol traffic which</font>

548
00:22:07,710 --> 00:22:11,429
is<font color="#E5E5E5"> responsible</font><font color="#CCCCCC"> for telling different</font>

549
00:22:09,990 --> 00:22:13,440
Cisco<font color="#E5E5E5"> devices that are on the network</font>

550
00:22:11,429 --> 00:22:15,539
<font color="#E5E5E5">who they are and what their capabilities</font>

551
00:22:13,440 --> 00:22:18,299
<font color="#CCCCCC">are super useful for an attacker</font>

552
00:22:15,539 --> 00:22:19,979
was built in conflict<font color="#E5E5E5"> I thought was</font>

553
00:22:18,299 --> 00:22:22,408
<font color="#CCCCCC">hilarious if you look at their</font>

554
00:22:19,979 --> 00:22:26,210
operational notes from that<font color="#CCCCCC"> swift attack</font>

555
00:22:22,409 --> 00:22:28,830
<font color="#CCCCCC">they run across a lot of conflict</font><font color="#E5E5E5"> they</font>

556
00:22:26,210 --> 00:22:30,629
see<font color="#E5E5E5"> it all the</font><font color="#CCCCCC"> time and</font><font color="#E5E5E5"> at times they'll</font>

557
00:22:28,830 --> 00:22:32,189
actually uninstall it<font color="#E5E5E5"> and clean the</font>

558
00:22:30,629 --> 00:22:33,840
<font color="#E5E5E5">machine so they can just leave</font>

559
00:22:32,190 --> 00:22:37,169
persistently and<font color="#E5E5E5"> not worry about</font>

560
00:22:33,840 --> 00:22:41,039
conflict<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then they also just capture</font>

561
00:22:37,169 --> 00:22:43,409
a lot of<font color="#E5E5E5"> my sequel logins and queries so</font>

562
00:22:41,039 --> 00:22:44,850
they're very<font color="#CCCCCC"> interested in</font><font color="#E5E5E5"> the type of</font>

563
00:22:43,409 --> 00:22:47,519
<font color="#E5E5E5">data</font><font color="#CCCCCC"> that could be</font><font color="#E5E5E5"> stored in a database</font>

564
00:22:44,850 --> 00:22:49,769
<font color="#CCCCCC">in fact they're so</font><font color="#E5E5E5"> interested</font><font color="#CCCCCC"> in this</font>

565
00:22:47,519 --> 00:22:52,529
that dander<font color="#CCCCCC"> spirits in kill</font><font color="#E5E5E5"> suit as a</font>

566
00:22:49,769 --> 00:22:55,440
whole<font color="#E5E5E5"> just brings its own drivers for a</font>

567
00:22:52,529 --> 00:22:58,109
wide variety<font color="#E5E5E5"> of different databases</font><font color="#CCCCCC"> that</font>

568
00:22:55,440 --> 00:23:01,169
are<font color="#E5E5E5"> available</font><font color="#CCCCCC"> so if the machine that</font>

569
00:22:58,109 --> 00:23:02,849
they're on doesn't have the drivers<font color="#CCCCCC"> or</font>

570
00:23:01,169 --> 00:23:05,070
kind of<font color="#E5E5E5"> the software to talk to the</font>

571
00:23:02,849 --> 00:23:06,509
database<font color="#CCCCCC"> that they're interested in they</font>

572
00:23:05,070 --> 00:23:08,129
can just bring<font color="#E5E5E5"> it in and it can be</font>

573
00:23:06,509 --> 00:23:10,919
<font color="#E5E5E5">installed persistently via kill suit</font>

574
00:23:08,129 --> 00:23:14,849
they have the<font color="#CCCCCC"> ability to</font><font color="#E5E5E5"> just kind</font><font color="#CCCCCC"> of</font>

575
00:23:10,919 --> 00:23:18,389
load<font color="#CCCCCC"> ms sequel</font><font color="#E5E5E5"> my sequel sequel</font><font color="#CCCCCC"> Lite or</font>

576
00:23:14,849 --> 00:23:19,939
Oracle<font color="#E5E5E5"> as the ODBC drivers that they</font>

577
00:23:18,389 --> 00:23:22,830
want to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> to talk to the database</font>

578
00:23:19,940 --> 00:23:24,629
<font color="#E5E5E5">another cool thing that was in this leak</font>

579
00:23:22,830 --> 00:23:26,519
is they<font color="#CCCCCC"> actually have an Oracle</font>

580
00:23:24,629 --> 00:23:28,889
authentication bypass that they called

581
00:23:26,519 --> 00:23:31,649
pass<font color="#E5E5E5"> freely again I really love</font><font color="#CCCCCC"> these</font>

582
00:23:28,889 --> 00:23:33,269
names<font color="#CCCCCC"> that they can just launch so if</font>

583
00:23:31,649 --> 00:23:35,309
you're using pass<font color="#CCCCCC"> freely</font><font color="#E5E5E5"> it'll just be</font>

584
00:23:33,269 --> 00:23:37,169
like cool<font color="#CCCCCC"> here's your auth go ahead and</font>

585
00:23:35,309 --> 00:23:39,509
pull all the<font color="#E5E5E5"> stuff you want from this</font>

586
00:23:37,169 --> 00:23:41,849
<font color="#E5E5E5">Oracle database and then more tooling</font>

587
00:23:39,509 --> 00:23:44,849
that<font color="#E5E5E5"> they built is all about</font><font color="#CCCCCC"> canned</font>

588
00:23:41,849 --> 00:23:47,450
query<font color="#E5E5E5"> plans so if you're touching a</font>

589
00:23:44,849 --> 00:23:50,939
thing<font color="#CCCCCC"> like Kaspersky or</font><font color="#E5E5E5"> SolarWinds or</font>

590
00:23:47,450 --> 00:23:53,099
something like<font color="#CCCCCC"> wsus server or sharepoint</font>

591
00:23:50,940 --> 00:23:54,989
<font color="#E5E5E5">they were very interested in that a lot</font>

592
00:23:53,099 --> 00:23:57,599
of their tooling around<font color="#E5E5E5"> my sequel was</font>

593
00:23:54,989 --> 00:24:00,509
also data exfil and also changing

594
00:23:57,599 --> 00:24:02,489
configurations of servers like wsus or

595
00:24:00,509 --> 00:24:07,409
Kaspersky or McAfee<font color="#CCCCCC"> were the</font>

596
00:24:02,489 --> 00:24:09,960
capabilities another really<font color="#E5E5E5"> cool tool is</font>

597
00:24:07,409 --> 00:24:12,450
called magic<font color="#CCCCCC"> bean</font><font color="#E5E5E5"> and magic beans</font>

598
00:24:09,960 --> 00:24:14,070
<font color="#CCCCCC">actually responsible for man in the</font>

599
00:24:12,450 --> 00:24:16,019
<font color="#E5E5E5">middle like Wi-Fi man-in-the-middle</font>

600
00:24:14,070 --> 00:24:19,259
capabilities<font color="#CCCCCC"> so if they're in a position</font>

601
00:24:16,019 --> 00:24:21,659
<font color="#E5E5E5">where they actually want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> grab like</font>

602
00:24:19,259 --> 00:24:24,330
Wi-Fi credentials<font color="#E5E5E5"> out of the air</font><font color="#CCCCCC"> they</font>

603
00:24:21,659 --> 00:24:27,580
can install this type using kill<font color="#E5E5E5"> suit</font>

604
00:24:24,330 --> 00:24:30,010
and the type name is made so magic bean

605
00:24:27,580 --> 00:24:31,840
and it just<font color="#CCCCCC"> installs a package like if</font>

606
00:24:30,010 --> 00:24:33,430
they need<font color="#E5E5E5"> it they can install a packet</font>

607
00:24:31,840 --> 00:24:35,199
<font color="#E5E5E5">driver with packet injection</font>

608
00:24:33,430 --> 00:24:36,970
capabilities so if they need<font color="#E5E5E5"> to inject</font>

609
00:24:35,200 --> 00:24:38,890
packets to do like deaaath or other

610
00:24:36,970 --> 00:24:42,340
stuff<font color="#E5E5E5"> they can just kind of install that</font>

611
00:24:38,890 --> 00:24:44,800
driver on the fly<font color="#E5E5E5"> and you can actually</font>

612
00:24:42,340 --> 00:24:46,780
<font color="#E5E5E5">see me here just running a command that</font>

613
00:24:44,800 --> 00:24:49,389
<font color="#CCCCCC">tells kill suit to install</font><font color="#E5E5E5"> magic</font><font color="#CCCCCC"> bean</font>

614
00:24:46,780 --> 00:24:53,020
the capabilities are<font color="#E5E5E5"> pretty cool</font><font color="#CCCCCC"> if you</font>

615
00:24:49,390 --> 00:24:55,690
look at some<font color="#E5E5E5"> of the exploits or issues</font>

616
00:24:53,020 --> 00:24:57,370
that<font color="#CCCCCC"> came</font><font color="#E5E5E5"> out with Wi-Fi Protected</font>

617
00:24:55,690 --> 00:24:59,770
access and like all that<font color="#CCCCCC"> stuff recently</font>

618
00:24:57,370 --> 00:25:03,100
<font color="#CCCCCC">in 2017 some of those capabilities</font>

619
00:24:59,770 --> 00:25:04,629
<font color="#E5E5E5">actually exists in magic bean so they</font>

620
00:25:03,100 --> 00:25:09,520
were way ahead of their time from<font color="#E5E5E5"> a</font>

621
00:25:04,630 --> 00:25:11,890
Wi-Fi exploitation perspective and of

622
00:25:09,520 --> 00:25:14,050
course<font color="#E5E5E5"> as the</font><font color="#CCCCCC"> equation group a lot</font><font color="#E5E5E5"> of</font>

623
00:25:11,890 --> 00:25:16,030
their time<font color="#E5E5E5"> is spent</font><font color="#CCCCCC"> trying to figure out</font>

624
00:25:14,050 --> 00:25:19,570
<font color="#CCCCCC">how</font><font color="#E5E5E5"> to do super stealthy data</font>

625
00:25:16,030 --> 00:25:22,450
exfiltration<font color="#CCCCCC"> so a lot of</font><font color="#E5E5E5"> that comes to</font>

626
00:25:19,570 --> 00:25:25,060
once again<font color="#CCCCCC"> designing a fully custom</font>

627
00:25:22,450 --> 00:25:26,980
<font color="#E5E5E5">network protocol so if they're in a</font>

628
00:25:25,060 --> 00:25:29,159
situation<font color="#E5E5E5"> where they know that the</font>

629
00:25:26,980 --> 00:25:31,450
defenders have<font color="#E5E5E5"> good network visibility</font>

630
00:25:29,160 --> 00:25:33,820
<font color="#E5E5E5">they've designed their</font><font color="#CCCCCC"> own custom</font>

631
00:25:31,450 --> 00:25:36,130
<font color="#E5E5E5">network protocol there's two components</font>

632
00:25:33,820 --> 00:25:39,040
<font color="#CCCCCC">to this</font><font color="#E5E5E5"> there's an implant called</font>

633
00:25:36,130 --> 00:25:41,890
straight<font color="#CCCCCC"> Bazaar which is responsible for</font>

634
00:25:39,040 --> 00:25:43,629
actually doing<font color="#E5E5E5"> stealthy data exfil so</font>

635
00:25:41,890 --> 00:25:47,380
this is the implant that<font color="#E5E5E5"> actually uses</font>

636
00:25:43,630 --> 00:25:49,840
<font color="#E5E5E5">the custom network protocol the custom</font>

637
00:25:47,380 --> 00:25:53,560
<font color="#CCCCCC">network protocol</font><font color="#E5E5E5"> is super cool it's</font>

638
00:25:49,840 --> 00:25:56,230
called freeze ramp<font color="#E5E5E5"> and it's very IPSec</font>

639
00:25:53,560 --> 00:25:59,200
<font color="#E5E5E5">like so if you've looked at IPSec like</font>

640
00:25:56,230 --> 00:26:01,180
VPN tunnels<font color="#E5E5E5"> this is very similar</font><font color="#CCCCCC"> and</font>

641
00:25:59,200 --> 00:26:04,420
some of the terminology<font color="#CCCCCC"> is</font><font color="#E5E5E5"> very</font>

642
00:26:01,180 --> 00:26:05,860
reminiscent of that<font color="#CCCCCC"> freeze ramp</font><font color="#E5E5E5"> actually</font>

643
00:26:04,420 --> 00:26:08,170
also<font color="#E5E5E5"> has a bunch of what they call</font>

644
00:26:05,860 --> 00:26:10,959
<font color="#E5E5E5">adapters</font><font color="#CCCCCC"> that allows them to kind of</font>

645
00:26:08,170 --> 00:26:13,660
inject traffic<font color="#CCCCCC"> into different layer</font><font color="#E5E5E5"> two</font>

646
00:26:10,960 --> 00:26:16,600
or like transport<font color="#E5E5E5"> layer solutions so</font>

647
00:26:13,660 --> 00:26:18,640
like if they need<font color="#E5E5E5"> TCP or UDP or ICMP</font>

648
00:26:16,600 --> 00:26:20,949
whatever it is they have<font color="#CCCCCC"> an adapter that</font>

649
00:26:18,640 --> 00:26:24,280
<font color="#E5E5E5">can kind</font><font color="#CCCCCC"> of translate</font><font color="#E5E5E5"> this traffic to</font>

650
00:26:20,950 --> 00:26:26,320
how they want<font color="#CCCCCC"> to exfil from it if you're</font>

651
00:26:24,280 --> 00:26:28,540
looking at freeze ramp within dander

652
00:26:26,320 --> 00:26:30,909
spirits<font color="#E5E5E5"> there's a lot of tooling</font><font color="#CCCCCC"> that</font>

653
00:26:28,540 --> 00:26:33,700
<font color="#E5E5E5">lets you see</font><font color="#CCCCCC"> the types of links that</font><font color="#E5E5E5"> are</font>

654
00:26:30,910 --> 00:26:36,490
<font color="#CCCCCC">established between</font><font color="#E5E5E5"> the listening post</font>

655
00:26:33,700 --> 00:26:38,590
<font color="#E5E5E5">and the actual freeze ramp using implant</font>

656
00:26:36,490 --> 00:26:40,960
<font color="#CCCCCC">you can actually see here that there's a</font>

657
00:26:38,590 --> 00:26:41,570
bunch<font color="#E5E5E5"> of security associations so once</font>

658
00:26:40,960 --> 00:26:44,300
again<font color="#E5E5E5"> if</font><font color="#CCCCCC"> your</font>

659
00:26:41,570 --> 00:26:46,429
familiar with a VPN or IPSec capability

660
00:26:44,300 --> 00:26:49,280
security associations is exactly what

661
00:26:46,430 --> 00:26:51,170
they use here what you see<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that my</font>

662
00:26:49,280 --> 00:26:55,250
machine<font color="#CCCCCC"> which is running</font><font color="#E5E5E5"> dander spritz</font>

663
00:26:51,170 --> 00:26:58,220
<font color="#E5E5E5">is called an address of Z</font><font color="#CCCCCC"> zero zero one</font>

664
00:26:55,250 --> 00:27:00,380
and then all the targets kind of just go

665
00:26:58,220 --> 00:27:02,300
up<font color="#E5E5E5"> from that sequentially so the first</font>

666
00:27:00,380 --> 00:27:04,880
target that connect to will be Z zero

667
00:27:02,300 --> 00:27:06,830
zero two<font color="#E5E5E5"> and so on</font><font color="#CCCCCC"> and they'll</font><font color="#E5E5E5"> actually</font>

668
00:27:04,880 --> 00:27:08,990
establish bi-directional security

669
00:27:06,830 --> 00:27:11,600
associations<font color="#E5E5E5"> to send</font><font color="#CCCCCC"> encrypted traffic</font>

670
00:27:08,990 --> 00:27:13,510
back and forth<font color="#E5E5E5"> if you're interested in</font>

671
00:27:11,600 --> 00:27:16,219
<font color="#E5E5E5">what this traffic looks like on the wire</font>

672
00:27:13,510 --> 00:27:18,020
<font color="#CCCCCC">the team at</font><font color="#E5E5E5"> force point</font><font color="#CCCCCC"> that are really</font>

673
00:27:16,220 --> 00:27:20,330
fantastic write-up<font color="#E5E5E5"> of how they reverse</font>

674
00:27:18,020 --> 00:27:22,340
engineered this<font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> I don't know if</font>

675
00:27:20,330 --> 00:27:24,710
they found freeze ramp because<font color="#E5E5E5"> they</font>

676
00:27:22,340 --> 00:27:25,699
don't mention this in their paper<font color="#E5E5E5"> but</font>

677
00:27:24,710 --> 00:27:27,290
they just kind<font color="#E5E5E5"> of looked at the</font>

678
00:27:25,700 --> 00:27:29,150
encrypted<font color="#E5E5E5"> network traffic and broke</font><font color="#CCCCCC"> down</font>

679
00:27:27,290 --> 00:27:30,770
how it works<font color="#E5E5E5"> so if you're</font><font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in</font>

680
00:27:29,150 --> 00:27:33,940
<font color="#CCCCCC">understanding a bit</font><font color="#E5E5E5"> more of that I</font>

681
00:27:30,770 --> 00:27:38,120
recommend that force point<font color="#E5E5E5"> white paper</font>

682
00:27:33,940 --> 00:27:40,490
<font color="#E5E5E5">all right cool</font><font color="#CCCCCC"> so what other tools or</font>

683
00:27:38,120 --> 00:27:43,370
things do they have from<font color="#CCCCCC"> a persistent</font>

684
00:27:40,490 --> 00:27:47,330
like data<font color="#E5E5E5"> exfil capability</font><font color="#CCCCCC"> they're</font>

685
00:27:43,370 --> 00:27:50,389
<font color="#CCCCCC">somber nave</font><font color="#E5E5E5"> and somber nave is used to</font>

686
00:27:47,330 --> 00:27:53,000
hijack disabled Wi-Fi cards<font color="#E5E5E5"> so if</font>

687
00:27:50,390 --> 00:27:55,340
they're in<font color="#CCCCCC"> a secure facility where</font>

688
00:27:53,000 --> 00:27:57,500
potentially the<font color="#CCCCCC"> ethernet network the</font>

689
00:27:55,340 --> 00:28:00,050
wired<font color="#E5E5E5"> network is air gapped they can</font>

690
00:27:57,500 --> 00:28:03,170
actually reenable<font color="#CCCCCC"> a</font><font color="#E5E5E5"> previously disabled</font>

691
00:28:00,050 --> 00:28:06,440
Wi-Fi card<font color="#E5E5E5"> and then use that to kind of</font>

692
00:28:03,170 --> 00:28:08,330
expel all their data<font color="#E5E5E5"> across it and you</font>

693
00:28:06,440 --> 00:28:11,090
can<font color="#CCCCCC"> actually use the credentials that</font>

694
00:28:08,330 --> 00:28:12,949
<font color="#CCCCCC">you stole using magic beam</font><font color="#E5E5E5"> to off</font><font color="#CCCCCC"> two</font>

695
00:28:11,090 --> 00:28:17,000
Wi-Fi networks and<font color="#CCCCCC"> exfilled data that</font>

696
00:28:12,950 --> 00:28:21,260
way<font color="#E5E5E5"> or you can use just an open Wi-Fi</font>

697
00:28:17,000 --> 00:28:23,660
network nearby<font color="#E5E5E5"> and just</font><font color="#CCCCCC"> like with all</font>

698
00:28:21,260 --> 00:28:25,879
these other systems<font color="#E5E5E5"> that I mentioned it</font>

699
00:28:23,660 --> 00:28:29,810
<font color="#E5E5E5">has its own separate kill suit instance</font>

700
00:28:25,880 --> 00:28:31,310
and this is<font color="#E5E5E5"> SL</font><font color="#CCCCCC"> KN boy</font><font color="#E5E5E5"> let me</font><font color="#CCCCCC"> tell you</font>

701
00:28:29,810 --> 00:28:34,639
was it fun finding out what these<font color="#CCCCCC"> things</font>

702
00:28:31,310 --> 00:28:37,010
stood<font color="#E5E5E5"> for all right</font><font color="#CCCCCC"> so here you can</font>

703
00:28:34,640 --> 00:28:40,640
actually<font color="#E5E5E5"> see me installing this</font><font color="#CCCCCC"> sombre</font>

704
00:28:37,010 --> 00:28:42,470
nave tool and before we keep<font color="#CCCCCC"> talking</font>

705
00:28:40,640 --> 00:28:43,820
about<font color="#E5E5E5"> these capabilities I want to loop</font>

706
00:28:42,470 --> 00:28:46,040
<font color="#CCCCCC">back to one of the implants that I</font>

707
00:28:43,820 --> 00:28:49,010
talked<font color="#CCCCCC"> about which was</font><font color="#E5E5E5"> straight</font><font color="#CCCCCC"> bizarre</font>

708
00:28:46,040 --> 00:28:51,720
so straight bizarre is responsible for

709
00:28:49,010 --> 00:28:53,908
again<font color="#E5E5E5"> doing stealthy</font><font color="#CCCCCC"> network</font>

710
00:28:51,720 --> 00:28:56,789
<font color="#E5E5E5">Expo but they also have the capability</font>

711
00:28:53,909 --> 00:28:59,429
<font color="#CCCCCC">to</font><font color="#E5E5E5"> turn it into what they call a</font>

712
00:28:56,789 --> 00:29:02,039
straight<font color="#CCCCCC"> Bazaar shooter and a</font><font color="#E5E5E5"> stripe is</font>

713
00:28:59,429 --> 00:29:04,379
our shooter is actually<font color="#CCCCCC"> a supercool</font>

714
00:29:02,039 --> 00:29:07,139
capability that they use when they need

715
00:29:04,379 --> 00:29:09,149
<font color="#E5E5E5">to target</font><font color="#CCCCCC"> hard-to-reach targets</font><font color="#E5E5E5"> so let's</font>

716
00:29:07,139 --> 00:29:11,519
say you're<font color="#CCCCCC"> the equation group and you</font>

717
00:29:09,149 --> 00:29:14,219
happen to<font color="#E5E5E5"> have the ability to monitor</font>

718
00:29:11,519 --> 00:29:16,320
monitor<font color="#CCCCCC"> eighty</font><font color="#E5E5E5"> to ninety percent of</font>

719
00:29:14,220 --> 00:29:18,840
<font color="#E5E5E5">global network traffic kind of at scale</font>

720
00:29:16,320 --> 00:29:22,740
<font color="#CCCCCC">and</font><font color="#E5E5E5"> you're trying</font><font color="#CCCCCC"> to target</font><font color="#E5E5E5"> a hard to</font>

721
00:29:18,840 --> 00:29:26,090
<font color="#CCCCCC">reach organization</font><font color="#E5E5E5"> you can actually put</font>

722
00:29:22,740 --> 00:29:29,490
what they call a task<font color="#CCCCCC"> on a specific</font>

723
00:29:26,090 --> 00:29:32,549
listener<font color="#E5E5E5"> which again is a global network</font>

724
00:29:29,490 --> 00:29:34,980
of listeners<font color="#E5E5E5"> to say okay</font><font color="#CCCCCC"> I know that</font>

725
00:29:32,549 --> 00:29:37,740
<font color="#E5E5E5">this network administrator at company</font><font color="#CCCCCC"> X</font>

726
00:29:34,980 --> 00:29:40,440
or<font color="#E5E5E5"> organization why has this</font><font color="#CCCCCC"> yahoo</font>

727
00:29:37,740 --> 00:29:43,049
account or is logged into Facebook<font color="#E5E5E5"> with</font>

728
00:29:40,440 --> 00:29:45,419
this<font color="#CCCCCC"> session ID were all sorts of other</font>

729
00:29:43,049 --> 00:29:48,120
different tasks<font color="#CCCCCC"> and what their network</font>

730
00:29:45,419 --> 00:29:50,639
of<font color="#CCCCCC"> sensors will do is identify</font><font color="#E5E5E5"> that and</font>

731
00:29:48,120 --> 00:29:52,620
say oh hey that guy you asked me to

732
00:29:50,639 --> 00:29:55,918
watch for I actually just saw him log

733
00:29:52,620 --> 00:29:58,620
into a server<font color="#E5E5E5"> it'll send a tip-off to</font><font color="#CCCCCC"> a</font>

734
00:29:55,919 --> 00:30:01,320
tasking engine which<font color="#E5E5E5"> is then responsible</font>

735
00:29:58,620 --> 00:30:04,830
<font color="#E5E5E5">for telling the straight bizarre shooter</font>

736
00:30:01,320 --> 00:30:08,820
to do man on the side at scale packet

737
00:30:04,830 --> 00:30:11,460
injection and beat the actual like

738
00:30:08,820 --> 00:30:13,230
response packet<font color="#E5E5E5"> from the server back</font><font color="#CCCCCC"> to</font>

739
00:30:11,460 --> 00:30:15,330
the<font color="#E5E5E5"> target and redirect them to</font>

740
00:30:13,230 --> 00:30:17,129
something<font color="#E5E5E5"> malicious</font><font color="#CCCCCC"> I just want to stop</font>

741
00:30:15,330 --> 00:30:19,949
for a second<font color="#E5E5E5"> to tell you that like if</font>

742
00:30:17,129 --> 00:30:22,350
they were trying<font color="#E5E5E5"> to hack into a hard to</font>

743
00:30:19,950 --> 00:30:24,299
reach<font color="#CCCCCC"> Network they did at scale man on</font>

744
00:30:22,350 --> 00:30:26,580
the side they<font color="#E5E5E5"> literally found the</font>

745
00:30:24,299 --> 00:30:29,730
geographically closest quantum shooter

746
00:30:26,580 --> 00:30:32,158
to the<font color="#E5E5E5"> target and did like passive</font><font color="#CCCCCC"> man</font>

747
00:30:29,730 --> 00:30:35,279
on<font color="#E5E5E5"> the side injection this requires them</font>

748
00:30:32,159 --> 00:30:37,769
<font color="#CCCCCC">to</font><font color="#E5E5E5"> be able to kind of calculate the TCP</font>

749
00:30:35,279 --> 00:30:39,539
sequence<font color="#E5E5E5"> number that will be at play by</font>

750
00:30:37,769 --> 00:30:41,879
the time this quantum shooter is

751
00:30:39,539 --> 00:30:44,820
actually firing<font color="#CCCCCC"> its man on the side</font>

752
00:30:41,879 --> 00:30:47,759
traffic and that's super<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> what</font>

753
00:30:44,820 --> 00:30:49,649
<font color="#CCCCCC">actually happened was</font><font color="#E5E5E5"> the quantum</font>

754
00:30:47,759 --> 00:30:51,960
shooter was responsible for injecting

755
00:30:49,649 --> 00:30:54,989
some JavaScript<font color="#E5E5E5"> that redirects the</font>

756
00:30:51,960 --> 00:30:56,820
target<font color="#E5E5E5"> to an exploit server so if you've</font>

757
00:30:54,990 --> 00:30:58,919
<font color="#CCCCCC">seen an exploit kit like black hole or</font>

758
00:30:56,820 --> 00:31:01,590
<font color="#CCCCCC">fiestas all these different exploit kits</font>

759
00:30:58,919 --> 00:31:04,649
<font color="#E5E5E5">this server is sort of the same</font><font color="#CCCCCC"> but full</font>

760
00:31:01,590 --> 00:31:05,340
of<font color="#CCCCCC"> O'Dea</font><font color="#E5E5E5"> so from what we could see they</font>

761
00:31:04,649 --> 00:31:08,310
<font color="#E5E5E5">had</font>

762
00:31:05,340 --> 00:31:11,159
zero days<font color="#E5E5E5"> for like Safari on iPhone and</font>

763
00:31:08,310 --> 00:31:12,720
Mac<font color="#E5E5E5"> and Internet Explorer</font><font color="#CCCCCC"> that they</font>

764
00:31:11,160 --> 00:31:15,600
could drop<font color="#E5E5E5"> on the target depending</font><font color="#CCCCCC"> on</font>

765
00:31:12,720 --> 00:31:18,960
what they had and the way this tooling

766
00:31:15,600 --> 00:31:21,169
worked is as I<font color="#CCCCCC"> mentioned the straight</font>

767
00:31:18,960 --> 00:31:23,700
<font color="#CCCCCC">bizarre shooter</font><font color="#E5E5E5"> is responsible for</font>

768
00:31:21,170 --> 00:31:25,260
redirecting to<font color="#CCCCCC"> the Fox acid</font><font color="#E5E5E5"> exploit</font>

769
00:31:23,700 --> 00:31:27,690
server so that's the exploit server

770
00:31:25,260 --> 00:31:30,780
that's<font color="#E5E5E5"> responsible</font><font color="#CCCCCC"> for deploying</font><font color="#E5E5E5"> some</font>

771
00:31:27,690 --> 00:31:32,970
sort of code to the target the exploit

772
00:31:30,780 --> 00:31:35,910
server deploys a tool that<font color="#E5E5E5"> they call a</font>

773
00:31:32,970 --> 00:31:38,190
validator<font color="#E5E5E5"> and the validator as you would</font>

774
00:31:35,910 --> 00:31:40,230
assume is responsible<font color="#CCCCCC"> for confirming</font>

775
00:31:38,190 --> 00:31:42,900
<font color="#E5E5E5">that they actually implanted the right</font>

776
00:31:40,230 --> 00:31:46,170
target<font color="#E5E5E5"> so not</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> are they tasking</font>

777
00:31:42,900 --> 00:31:48,060
based on like session<font color="#E5E5E5"> IDs or</font><font color="#CCCCCC"> Yahoo email</font>

778
00:31:46,170 --> 00:31:50,280
that you're<font color="#E5E5E5"> logging into but they also</font>

779
00:31:48,060 --> 00:31:52,409
<font color="#E5E5E5">deploy a validator</font><font color="#CCCCCC"> that's responsible</font>

780
00:31:50,280 --> 00:31:54,990
<font color="#E5E5E5">for</font><font color="#CCCCCC"> confirming that</font><font color="#E5E5E5"> they actually did</font>

781
00:31:52,410 --> 00:31:56,730
implant the right target<font color="#E5E5E5"> if they didn't</font>

782
00:31:54,990 --> 00:31:59,010
implant the right target they just kind

783
00:31:56,730 --> 00:32:01,500
of silently<font color="#E5E5E5"> uninstall</font><font color="#CCCCCC"> that and back</font><font color="#E5E5E5"> away</font>

784
00:31:59,010 --> 00:32:03,750
if they did implant the correct<font color="#CCCCCC"> target</font>

785
00:32:01,500 --> 00:32:05,130
<font color="#E5E5E5">they deploy that United rake framework</font>

786
00:32:03,750 --> 00:32:08,820
that we mentioned earlier

787
00:32:05,130 --> 00:32:10,380
<font color="#E5E5E5">so United</font><font color="#CCCCCC"> rig it</font><font color="#E5E5E5"> United rake is just a</font>

788
00:32:08,820 --> 00:32:13,110
lightweight version<font color="#E5E5E5"> of a post</font>

789
00:32:10,380 --> 00:32:15,540
exploitation kit it'll just<font color="#E5E5E5"> call back to</font>

790
00:32:13,110 --> 00:32:18,149
a CNC server<font color="#E5E5E5"> a listening post and just</font>

791
00:32:15,540 --> 00:32:20,820
<font color="#CCCCCC">tell the</font><font color="#E5E5E5"> operators hey I'm here what do</font>

792
00:32:18,150 --> 00:32:22,680
you<font color="#E5E5E5"> want me to do</font><font color="#CCCCCC"> and from there they</font>

793
00:32:20,820 --> 00:32:25,860
<font color="#E5E5E5">can</font><font color="#CCCCCC"> go ahead and upgrade it to a session</font>

794
00:32:22,680 --> 00:32:31,080
<font color="#E5E5E5">of danger spritz or other tooling if</font>

795
00:32:25,860 --> 00:32:33,870
they need it<font color="#CCCCCC"> so quick story time around</font>

796
00:32:31,080 --> 00:32:37,350
<font color="#CCCCCC">how I found this</font><font color="#E5E5E5"> and how I want to</font>

797
00:32:33,870 --> 00:32:39,270
encourage you to<font color="#E5E5E5"> look at this so last</font>

798
00:32:37,350 --> 00:32:43,139
year I mentioned I did<font color="#CCCCCC"> this</font><font color="#E5E5E5"> dander split</font>

799
00:32:39,270 --> 00:32:45,060
stalk and my buddy<font color="#E5E5E5"> Casey Smith</font><font color="#CCCCCC"> subti on</font>

800
00:32:43,140 --> 00:32:47,730
Twitter<font color="#E5E5E5"> really recommend you follow that</font>

801
00:32:45,060 --> 00:32:49,710
dude<font color="#CCCCCC"> superb right</font><font color="#E5E5E5"> and another friend</font>

802
00:32:47,730 --> 00:32:53,850
<font color="#CCCCCC">we're all hanging out at Casey's house</font>

803
00:32:49,710 --> 00:32:56,700
and none of us are like<font color="#E5E5E5"> Boot Record</font>

804
00:32:53,850 --> 00:32:58,949
people<font color="#E5E5E5"> you know we're like buying a</font>

805
00:32:56,700 --> 00:33:00,900
<font color="#E5E5E5">bunch of forensics and like file system</font>

806
00:32:58,950 --> 00:33:04,170
forensics books to figure out how solar

807
00:33:00,900 --> 00:33:06,000
time is working<font color="#CCCCCC"> and what that meant is</font>

808
00:33:04,170 --> 00:33:08,460
<font color="#CCCCCC">that we were</font><font color="#E5E5E5"> just like persistently</font>

809
00:33:06,000 --> 00:33:11,700
installing a bunch of tools consistently

810
00:33:08,460 --> 00:33:13,520
using kill<font color="#E5E5E5"> suit so we're like okay let's</font>

811
00:33:11,700 --> 00:33:17,160
<font color="#E5E5E5">just keep installing</font><font color="#CCCCCC"> these things and</font>

812
00:33:13,520 --> 00:33:19,090
<font color="#E5E5E5">eventually we ran across the fact that</font>

813
00:33:17,160 --> 00:33:21,730
whenever we deployed a

814
00:33:19,090 --> 00:33:24,669
a implant<font color="#E5E5E5"> persistently with kill suit</font>

815
00:33:21,730 --> 00:33:28,020
like<font color="#CCCCCC"> petal</font><font color="#E5E5E5"> cheap we saw it run a command</font>

816
00:33:24,670 --> 00:33:31,300
<font color="#E5E5E5">that was like</font><font color="#CCCCCC"> ki-suh install type</font>

817
00:33:28,020 --> 00:33:33,070
<font color="#CCCCCC">whatever</font><font color="#E5E5E5"> and we started digging into</font>

818
00:33:31,300 --> 00:33:35,260
well<font color="#E5E5E5"> what does that mean</font><font color="#CCCCCC"> like what's a</font>

819
00:33:33,070 --> 00:33:37,179
<font color="#CCCCCC">key su install we're kind of feeling</font>

820
00:33:35,260 --> 00:33:38,710
<font color="#E5E5E5">dumb we can't figure out how this boot</font>

821
00:33:37,180 --> 00:33:39,630
kit<font color="#E5E5E5"> works let's just look at</font><font color="#CCCCCC"> something</font>

822
00:33:38,710 --> 00:33:43,270
<font color="#E5E5E5">else</font>

823
00:33:39,630 --> 00:33:45,040
<font color="#E5E5E5">so we run another command that says hey</font>

824
00:33:43,270 --> 00:33:47,650
show me<font color="#CCCCCC"> all the kill suit installations</font>

825
00:33:45,040 --> 00:33:49,240
on this box<font color="#E5E5E5"> what we end up seeing is</font>

826
00:33:47,650 --> 00:33:53,440
<font color="#CCCCCC">that they have this thing</font><font color="#E5E5E5"> that they call</font>

827
00:33:49,240 --> 00:33:55,450
<font color="#CCCCCC">a</font><font color="#E5E5E5"> key su ID so a kill suit IB and they</font>

828
00:33:53,440 --> 00:33:58,240
have a<font color="#E5E5E5"> little like PC next to it</font>

829
00:33:55,450 --> 00:34:01,000
PC stood for<font color="#E5E5E5"> petal</font><font color="#CCCCCC"> cheap</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> start</font>

830
00:33:58,240 --> 00:34:02,680
<font color="#CCCCCC">thinking I wonder why they have IDs on</font>

831
00:34:01,000 --> 00:34:04,540
these<font color="#E5E5E5"> things and what else could I</font>

832
00:34:02,680 --> 00:34:07,720
install with kill suit<font color="#E5E5E5"> that would be</font>

833
00:34:04,540 --> 00:34:10,509
interesting to<font color="#E5E5E5"> me and what I remembered</font>

834
00:34:07,720 --> 00:34:12,970
is once again<font color="#CCCCCC"> they had a bunch of Python</font>

835
00:34:10,510 --> 00:34:15,940
<font color="#CCCCCC">that I could read without</font><font color="#E5E5E5"> having</font><font color="#CCCCCC"> to</font>

836
00:34:12,969 --> 00:34:17,649
reverse a bunch of things and in a kill

837
00:34:15,940 --> 00:34:20,800
suit folder<font color="#E5E5E5"> that we were looking</font><font color="#CCCCCC"> at</font>

838
00:34:17,650 --> 00:34:23,500
there was this<font color="#E5E5E5"> IDs dot</font><font color="#CCCCCC"> Pi file</font><font color="#E5E5E5"> and I was</font>

839
00:34:20,800 --> 00:34:26,860
like<font color="#E5E5E5"> that's probably</font><font color="#CCCCCC"> useful and related</font>

840
00:34:23,500 --> 00:34:30,130
<font color="#E5E5E5">and what we saw was</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> that PC thing</font>

841
00:34:26,860 --> 00:34:33,370
is<font color="#E5E5E5"> actually listed in there and when we</font>

842
00:34:30,130 --> 00:34:36,670
<font color="#E5E5E5">looked that was what it</font><font color="#CCCCCC"> was in hex so</font>

843
00:34:33,370 --> 00:34:40,239
we're like<font color="#E5E5E5"> okay what if we do like</font><font color="#CCCCCC"> key</font>

844
00:34:36,670 --> 00:34:42,940
<font color="#CCCCCC">su install</font><font color="#E5E5E5"> all of these things so that's</font>

845
00:34:40,239 --> 00:34:45,100
what we did we just<font color="#E5E5E5"> like started</font>

846
00:34:42,940 --> 00:34:46,510
installing stuff<font color="#CCCCCC"> we're like</font><font color="#E5E5E5"> no idea</font><font color="#CCCCCC"> what</font>

847
00:34:45,100 --> 00:34:50,049
this does<font color="#E5E5E5"> but cool I'm just gonna</font>

848
00:34:46,510 --> 00:34:53,350
install all<font color="#CCCCCC"> of it so we end up</font><font color="#E5E5E5"> with this</font>

849
00:34:50,050 --> 00:34:55,480
box<font color="#E5E5E5"> that's got like I kid you not like</font>

850
00:34:53,350 --> 00:34:57,400
13 different<font color="#CCCCCC"> implants we have no idea</font>

851
00:34:55,480 --> 00:34:59,650
what they do yet<font color="#E5E5E5"> but</font><font color="#CCCCCC"> we're like cool</font>

852
00:34:57,400 --> 00:35:01,690
these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> all installed that's super</font>

853
00:34:59,650 --> 00:35:06,240
sweet let's start figuring<font color="#E5E5E5"> out what they</font>

854
00:35:01,690 --> 00:35:09,640
do so what we<font color="#CCCCCC"> actually end up doing is</font>

855
00:35:06,240 --> 00:35:11,290
looking<font color="#E5E5E5"> at that check so T script so</font>

856
00:35:09,640 --> 00:35:13,480
<font color="#CCCCCC">that script that</font><font color="#E5E5E5"> I mentioned that looks</font>

857
00:35:11,290 --> 00:35:15,910
for<font color="#E5E5E5"> a solar time container and how its</font>

858
00:35:13,480 --> 00:35:19,330
configured<font color="#E5E5E5"> it had this super helpful</font>

859
00:35:15,910 --> 00:35:22,210
piece of code that<font color="#CCCCCC"> was like hey I don't</font>

860
00:35:19,330 --> 00:35:25,480
know what<font color="#CCCCCC"> version this is but if you</font><font color="#E5E5E5"> run</font>

861
00:35:22,210 --> 00:35:27,940
double feature<font color="#E5E5E5"> it will tell you so we're</font>

862
00:35:25,480 --> 00:35:29,730
like double feature<font color="#CCCCCC"> yeah that sounds</font>

863
00:35:27,940 --> 00:35:31,800
like something<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to look at</font>

864
00:35:29,730 --> 00:35:33,780
so we just<font color="#E5E5E5"> kind of ran a double feature</font>

865
00:35:31,800 --> 00:35:36,450
<font color="#E5E5E5">report and let me tell you was that</font>

866
00:35:33,780 --> 00:35:38,550
<font color="#CCCCCC">useful as health so double feature is</font>

867
00:35:36,450 --> 00:35:40,919
actually<font color="#CCCCCC"> responsible for</font><font color="#E5E5E5"> figuring out</font>

868
00:35:38,550 --> 00:35:43,650
all the<font color="#CCCCCC"> things that are</font><font color="#E5E5E5"> implanted by</font>

869
00:35:40,920 --> 00:35:47,280
<font color="#E5E5E5">kill soot and dander spritz it actually</font>

870
00:35:43,650 --> 00:35:49,140
spits out<font color="#E5E5E5"> what is installed and the full</font>

871
00:35:47,280 --> 00:35:49,560
name<font color="#CCCCCC"> of the implant so that was</font><font color="#E5E5E5"> pretty</font>

872
00:35:49,140 --> 00:35:51,450
<font color="#CCCCCC">cool</font>

873
00:35:49,560 --> 00:35:54,180
and then also<font color="#E5E5E5"> tells you a bunch of other</font>

874
00:35:51,450 --> 00:35:56,549
<font color="#CCCCCC">information like where in the registry</font>

875
00:35:54,180 --> 00:35:57,990
they installed<font color="#E5E5E5"> all of their</font><font color="#CCCCCC"> persistent</font>

876
00:35:56,550 --> 00:36:00,150
stuff for that virtual<font color="#E5E5E5"> file system</font>

877
00:35:57,990 --> 00:36:02,129
<font color="#CCCCCC">they'll tell</font><font color="#E5E5E5"> you hey this is the</font>

878
00:36:00,150 --> 00:36:03,930
launcher driver<font color="#CCCCCC"> that we're gonna exploit</font>

879
00:36:02,130 --> 00:36:06,359
<font color="#CCCCCC">to actually get persistence on this</font>

880
00:36:03,930 --> 00:36:09,990
<font color="#E5E5E5">machine and run kernel mode code and a</font>

881
00:36:06,359 --> 00:36:12,598
bunch of other<font color="#E5E5E5"> cool stuff</font><font color="#CCCCCC"> so we end</font><font color="#E5E5E5"> up</font>

882
00:36:09,990 --> 00:36:14,879
just<font color="#CCCCCC"> running a bunch of double feature</font>

883
00:36:12,599 --> 00:36:16,800
reports<font color="#E5E5E5"> something interesting about</font>

884
00:36:14,880 --> 00:36:18,570
double feature which if you're

885
00:36:16,800 --> 00:36:22,260
<font color="#E5E5E5">investigating dander</font><font color="#CCCCCC"> spritz and kill</font>

886
00:36:18,570 --> 00:36:24,180
soot I really recommend you run is one

887
00:36:22,260 --> 00:36:26,339
you could just run<font color="#CCCCCC"> a standard double</font>

888
00:36:24,180 --> 00:36:29,549
<font color="#CCCCCC">feature query which is what we did we</font>

889
00:36:26,339 --> 00:36:33,089
just queried everything but it also has

890
00:36:29,550 --> 00:36:36,569
features<font color="#CCCCCC"> built</font><font color="#E5E5E5"> in to enable debug</font>

891
00:36:33,089 --> 00:36:38,880
logging on United rake so super helpful

892
00:36:36,569 --> 00:36:41,160
<font color="#CCCCCC">that they built a tool that enabled</font>

893
00:36:38,880 --> 00:36:41,760
logging on all of their persistence

894
00:36:41,160 --> 00:36:44,960
<font color="#CCCCCC">toolkits</font>

895
00:36:41,760 --> 00:36:48,359
<font color="#E5E5E5">and post exploitation frameworks so</font>

896
00:36:44,960 --> 00:36:49,890
<font color="#E5E5E5">double feature is a super useful system</font>

897
00:36:48,359 --> 00:36:53,759
that I recommend you look at<font color="#E5E5E5"> if you're</font>

898
00:36:49,890 --> 00:36:55,920
going to be digging<font color="#E5E5E5"> into this so let's</font>

899
00:36:53,760 --> 00:36:58,500
talk<font color="#CCCCCC"> about just a few</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the implants</font>

900
00:36:55,920 --> 00:37:00,869
<font color="#E5E5E5">that are supported by</font><font color="#CCCCCC"> kill soot and if</font>

901
00:36:58,500 --> 00:37:02,430
you look here<font color="#CCCCCC"> in this slide the ones</font>

902
00:37:00,869 --> 00:37:03,900
that I've highlighted<font color="#E5E5E5"> are the ones that</font>

903
00:37:02,430 --> 00:37:06,899
I<font color="#CCCCCC"> mentioned in this talk</font><font color="#E5E5E5"> or that I know</font>

904
00:37:03,900 --> 00:37:09,270
what they do<font color="#E5E5E5"> so as you</font><font color="#CCCCCC"> see this please</font>

905
00:37:06,900 --> 00:37:10,380
consider<font color="#E5E5E5"> helping me reverse this we have</font>

906
00:37:09,270 --> 00:37:13,319
Morbid Angel

907
00:37:10,380 --> 00:37:17,250
we have<font color="#E5E5E5"> savage angel we have straight</font>

908
00:37:13,319 --> 00:37:17,940
<font color="#CCCCCC">Bazaar we have</font><font color="#E5E5E5"> magic bean we have Chin</font>

909
00:37:17,250 --> 00:37:20,369
Music

910
00:37:17,940 --> 00:37:23,490
super cool<font color="#E5E5E5"> dimension wheel that one's</font>

911
00:37:20,369 --> 00:37:25,980
fun we have tilt tsunami<font color="#CCCCCC"> I really like</font>

912
00:37:23,490 --> 00:37:28,618
<font color="#E5E5E5">that one and</font><font color="#CCCCCC"> Wraith watch funny thing</font>

913
00:37:25,980 --> 00:37:30,990
about<font color="#E5E5E5"> Wraith watch</font><font color="#CCCCCC"> I really</font><font color="#E5E5E5"> recommend</font>

914
00:37:28,619 --> 00:37:33,030
you go<font color="#CCCCCC"> onto LinkedIn</font><font color="#E5E5E5"> and just like</font>

915
00:37:30,990 --> 00:37:34,589
search<font color="#CCCCCC"> rate</font><font color="#E5E5E5"> watch you'll find a bunch of</font>

916
00:37:33,030 --> 00:37:38,979
interesting<font color="#E5E5E5"> people who have had Wraith</font>

917
00:37:34,589 --> 00:37:42,170
watch training<font color="#E5E5E5"> that is terrible OPSEC</font>

918
00:37:38,979 --> 00:37:45,680
other things we have double dare<font color="#E5E5E5"> we have</font>

919
00:37:42,170 --> 00:37:48,920
magic grain<font color="#CCCCCC"> Matt</font><font color="#E5E5E5"> magic monkey</font><font color="#CCCCCC"> sleepy</font>

920
00:37:45,680 --> 00:37:51,259
sheriff we have snuffle unicorn<font color="#CCCCCC"> I really</font>

921
00:37:48,920 --> 00:37:54,470
want to know<font color="#E5E5E5"> what that</font><font color="#CCCCCC"> one does woozi</font>

922
00:37:51,259 --> 00:37:58,190
ramble<font color="#E5E5E5"> somber</font><font color="#CCCCCC"> nave and</font><font color="#E5E5E5"> then strange land</font>

923
00:37:54,470 --> 00:38:00,220
<font color="#CCCCCC">so again</font><font color="#E5E5E5"> let's fill in a few more of</font>

924
00:37:58,190 --> 00:38:02,599
these<font color="#E5E5E5"> let's figure out what they do</font>

925
00:38:00,220 --> 00:38:04,788
<font color="#CCCCCC">alright so as</font><font color="#E5E5E5"> I mentioned at the</font>

926
00:38:02,599 --> 00:38:06,950
beginning of<font color="#E5E5E5"> this talk my entire goal</font>

927
00:38:04,789 --> 00:38:08,839
with this was<font color="#CCCCCC"> to enable research and</font>

928
00:38:06,950 --> 00:38:10,729
enable other people<font color="#CCCCCC"> to look at dander</font>

929
00:38:08,839 --> 00:38:14,569
<font color="#E5E5E5">spirits and understand the</font><font color="#CCCCCC"> capabilities</font>

930
00:38:10,729 --> 00:38:17,269
there's been<font color="#CCCCCC"> thirteen at least 13 years</font>

931
00:38:14,569 --> 00:38:19,400
of work into this tooling<font color="#E5E5E5"> this trade</font>

932
00:38:17,269 --> 00:38:21,709
craft<font color="#E5E5E5"> and these capabilities</font><font color="#CCCCCC"> and now</font>

933
00:38:19,400 --> 00:38:23,289
it's out in the<font color="#CCCCCC"> open we need</font><font color="#E5E5E5"> to look at</font>

934
00:38:21,710 --> 00:38:25,670
what they're doing<font color="#E5E5E5"> and what other</font>

935
00:38:23,289 --> 00:38:28,220
<font color="#CCCCCC">organizations or criminal groups are</font>

936
00:38:25,670 --> 00:38:30,619
<font color="#E5E5E5">going to start using against us</font><font color="#CCCCCC"> as the</font>

937
00:38:28,220 --> 00:38:33,410
blue team<font color="#CCCCCC"> in the future so in order</font><font color="#E5E5E5"> to</font>

938
00:38:30,619 --> 00:38:35,630
<font color="#E5E5E5">enable research I actually built a fully</font>

939
00:38:33,410 --> 00:38:37,970
functional dander<font color="#CCCCCC"> split</font><font color="#E5E5E5"> slab that you</font>

940
00:38:35,630 --> 00:38:40,460
can<font color="#E5E5E5"> bring up in two commands you just</font>

941
00:38:37,970 --> 00:38:43,189
have to run<font color="#E5E5E5"> Packer</font><font color="#CCCCCC"> to build the lab and</font>

942
00:38:40,460 --> 00:38:46,279
then vagrant up<font color="#E5E5E5"> and then you'll have a</font>

943
00:38:43,190 --> 00:38:49,190
fully functional dander<font color="#E5E5E5"> split slab with</font>

944
00:38:46,279 --> 00:38:52,609
<font color="#E5E5E5">dander splits</font><font color="#CCCCCC"> as the exploitation</font><font color="#E5E5E5"> system</font>

945
00:38:49,190 --> 00:38:54,529
<font color="#E5E5E5">it includes</font><font color="#CCCCCC"> fuds</font><font color="#E5E5E5"> bunch</font><font color="#CCCCCC"> you'll have the</font>

946
00:38:52,609 --> 00:38:56,869
target that you should hopefully be<font color="#E5E5E5"> able</font>

947
00:38:54,529 --> 00:39:00,079
to implant and play against<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> as a</font>

948
00:38:56,869 --> 00:39:02,839
domain<font color="#CCCCCC"> controller</font><font color="#E5E5E5"> and a bunch of tooling</font>

949
00:39:00,079 --> 00:39:04,640
around<font color="#E5E5E5"> doing forensics and discovery on</font>

950
00:39:02,839 --> 00:39:06,589
that machine<font color="#CCCCCC"> the domain controller</font>

951
00:39:04,640 --> 00:39:08,089
includes things like you event log

952
00:39:06,589 --> 00:39:09,828
forwarding and other things<font color="#CCCCCC"> that were</font>

953
00:39:08,089 --> 00:39:14,049
super helpful<font color="#E5E5E5"> to me when I was trying to</font>

954
00:39:09,829 --> 00:39:16,489
understand how this<font color="#CCCCCC"> toolkit worked so</font>

955
00:39:14,049 --> 00:39:19,549
quick review of<font color="#E5E5E5"> what</font><font color="#CCCCCC"> we talked about</font>

956
00:39:16,489 --> 00:39:22,999
today<font color="#CCCCCC"> so we talked about dander</font><font color="#E5E5E5"> splits</font>

957
00:39:19,549 --> 00:39:24,999
<font color="#CCCCCC">as a super cool framework and we talked</font>

958
00:39:22,999 --> 00:39:28,009
about<font color="#E5E5E5"> their post exploitation</font>

959
00:39:24,999 --> 00:39:31,098
capabilities<font color="#E5E5E5"> not just using fuzz</font><font color="#CCCCCC"> Bunch</font>

960
00:39:28,009 --> 00:39:32,630
<font color="#E5E5E5">but doing at scale man on the side</font><font color="#CCCCCC"> we're</font>

961
00:39:31,099 --> 00:39:35,180
<font color="#E5E5E5">just still mind-blowing to me</font>

962
00:39:32,630 --> 00:39:38,269
and I told you about<font color="#CCCCCC"> dander spritz</font><font color="#E5E5E5"> lab</font>

963
00:39:35,180 --> 00:39:39,828
so I actually<font color="#E5E5E5"> own</font><font color="#CCCCCC"> Danish Boots</font><font color="#E5E5E5"> calm by</font>

964
00:39:38,269 --> 00:39:41,779
the way so if<font color="#CCCCCC"> you guys want to</font><font color="#E5E5E5"> look at</font>

965
00:39:39,829 --> 00:39:44,180
that<font color="#E5E5E5"> I've been putting a lot of stuff on</font>

966
00:39:41,779 --> 00:39:46,339
<font color="#E5E5E5">there and please take a look</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> the</font>

967
00:39:44,180 --> 00:39:47,749
<font color="#CCCCCC">inner sports lab dander split stocks and</font>

968
00:39:46,339 --> 00:39:50,328
let me know if you have<font color="#E5E5E5"> any questions</font>

969
00:39:47,749 --> 00:39:52,310
<font color="#CCCCCC">just a heads up we have a few randori</font>

970
00:39:50,329 --> 00:39:54,500
shirts<font color="#CCCCCC"> so if you're</font><font color="#E5E5E5"> interested</font>

971
00:39:52,310 --> 00:39:57,080
not that many<font color="#E5E5E5"> but we have</font><font color="#CCCCCC"> a few please</font>

972
00:39:54,500 --> 00:40:08,539
come up<font color="#E5E5E5"> to you and let me</font><font color="#CCCCCC"> know Thanks</font>

973
00:39:57,080 --> 00:40:08,538
[Applause]

