1
00:00:00,000 --> 00:00:12,040
is this looks like a pack top so my wife
i think is still coming so what I'm

2
00:00:12,040 --> 00:00:15,839
gonna do when she walks in as I'm gonna
say honey all of these men have

3
00:00:15,839 --> 00:00:17,640
volunteered to have you sit next to them

4
00:00:17,640 --> 00:00:23,650
won't be he's patting it he's patting
his lap

5
00:00:23,650 --> 00:00:36,460
what the hell that's right I'm a bad
husband's killing time waiting get

6
00:00:36,460 --> 00:00:37,890
started we being recorded

7
00:00:37,890 --> 00:00:43,829
everybody in very very cool give it a
few more minutes

8
00:00:43,829 --> 00:00:47,960
got some people coming in people in the
back please feel free we still got some

9
00:00:47,960 --> 00:00:49,480
hands up holding up high

10
00:00:49,480 --> 00:00:53,210
you don't want to stand for this
presentation is gonna be a long there's

11
00:00:53,210 --> 00:00:55,780
gonna be math not for me

12
00:00:55,780 --> 00:01:00,680
got no not not for me I'm the dumbest
person at my company also we have some

13
00:01:00,680 --> 00:01:04,580
children coming in please make room for
the entire family if you guys can kind

14
00:01:04,580 --> 00:01:09,740
of cold towards the outside edges so we
can get the kids in so if you have a

15
00:01:09,740 --> 00:01:10,930
seat next to you

16
00:01:10,930 --> 00:01:16,970
outwards so we can get a seat of 34
family think of the children won't

17
00:01:16,970 --> 00:01:24,320
somebody think of the children so like
for example come up front come up front

18
00:01:24,320 --> 00:01:31,210
come up front we got your radio you guys
right here all of you that way right

19
00:01:31,210 --> 00:01:37,220
there we go go in these two girls can
there we go see everybody round of

20
00:01:37,220 --> 00:01:39,170
applause

21
00:01:39,170 --> 00:01:47,049
and that's that's operating system
theory that's how we do memory

22
00:01:47,049 --> 00:01:54,580
management children you just DL Malik
alright alright so let's get this

23
00:01:54,580 --> 00:01:58,619
started first and foremost I want to say
thank you very much for attending this

24
00:01:58,619 --> 00:02:02,450
presentation and proving me wrong I
greatly appreciate that if you guys

25
00:02:02,450 --> 00:02:07,649
remember a number of years ago I came up
here that if we did a talk on defense no

26
00:02:07,649 --> 00:02:11,970
one would show up if I was giving a talk
on hacking a toaster everyone would show

27
00:02:11,970 --> 00:02:14,350
up and having a bunch of people show up

28
00:02:14,350 --> 00:02:20,760
got on the right room is this the break
room cause I really wanna go in that

29
00:02:20,760 --> 00:02:25,970
room we're gonna be talking about
defense here a little bit so this is an

30
00:02:25,970 --> 00:02:29,410
introduction to the reader framework a
lot of you will ask why exactly do we

31
00:02:29,410 --> 00:02:35,540
call it the reader framework because
John's mom was taken at so we're going

32
00:02:35,540 --> 00:02:39,280
to call it's named after my mom and I
didn't name it after him on the fine

33
00:02:39,280 --> 00:02:44,959
folks at bhi tested so we're going for
bad guys for free and using map using

34
00:02:44,959 --> 00:02:49,880
hunting tactics to do the introduction
and get upstaged quickly possible job

35
00:02:49,880 --> 00:02:54,480
insecurity we gonna give Brian he's
gonna jump up where's Brian ok let's

36
00:02:54,480 --> 00:02:58,130
turn to get nervous cuz i havent seen
you yet today it's probably cuz we were

37
00:02:58,130 --> 00:03:03,290
the same shirt and testing and
validation derek's gonna come up and get

38
00:03:03,290 --> 00:03:06,260
some conclusions before we get into that
some things that I like to bring up in

39
00:03:06,260 --> 00:03:11,100
many presentations as elected cover why
it is defensive security technologies

40
00:03:11,100 --> 00:03:14,739
are not working a lot of presentations
you attend they will talk about how

41
00:03:14,739 --> 00:03:18,950
everything is broken security is broken
vendors are down the vendors are vendors

42
00:03:18,950 --> 00:03:22,819
right I spent a good portion of
yesterday trolling symantec has a right

43
00:03:22,819 --> 00:03:25,910
across the hall from us by running a
video on how to bypass semantics and

44
00:03:25,910 --> 00:03:27,430
neighbors

45
00:03:27,430 --> 00:03:34,099
at our table and semantic they basically
said you know well why don't you try our

46
00:03:34,099 --> 00:03:37,730
next super awesome generation tool for
new advanced threats whatever they've

47
00:03:37,730 --> 00:03:40,090
changed the name of that product you
like the third or fourth time and I said

48
00:03:40,090 --> 00:03:43,239
we'd be happy to bypass it as soon as
we've seen a customer implemented

49
00:03:43,239 --> 00:03:48,900
successfully that that's a little bit of
escalation right but it's not their

50
00:03:48,900 --> 00:03:49,609
fault

51
00:03:49,609 --> 00:03:55,260
okay it really isn't as much as I i'm
i'm making fun of those those find

52
00:03:55,260 --> 00:03:59,950
gentlemen are at Symantec absolute best
they can but the fact is if we're taking

53
00:03:59,950 --> 00:04:02,310
a look at what we've been doing an
information security we're doing the

54
00:04:02,310 --> 00:04:05,870
exact same thing I've opened with the
slide it to Derby Conn so far we're

55
00:04:05,870 --> 00:04:08,989
doing the same thing for the past five
six years we're seeing the exact same

56
00:04:08,989 --> 00:04:12,180
bad pattern because we're doing the same
thing again and again and again and

57
00:04:12,180 --> 00:04:15,780
expecting different results so with that
I've couple questions for you first and

58
00:04:15,780 --> 00:04:23,130
foremost name three AV companies big
ones you have a chichi Samantha ok well

59
00:04:23,130 --> 00:04:27,690
that's cheating too I just got done
talking about them that's that's awesome

60
00:04:27,690 --> 00:04:33,789
check Kaspersky Sophos no one's
mentioned McAfee they so bad they don't

61
00:04:33,789 --> 00:04:35,639
even qualify now

62
00:04:35,639 --> 00:04:43,849
so named three firewall idea spenders
big names Palo Alto checkpoint Cisco

63
00:04:43,849 --> 00:04:47,610
were done right now whenever we're
looking at that what is the total market

64
00:04:47,610 --> 00:04:51,180
share when we look at Symantec and
McAfee we look at Palo Alto we look at

65
00:04:51,180 --> 00:04:54,620
checkpoint we look at Cisco looking at
well over eighty percent of the total

66
00:04:54,620 --> 00:04:58,810
market share right these are massive
massive companies with a massive market

67
00:04:58,810 --> 00:05:01,379
share and almost all of us have their
products implemented in their

68
00:05:01,379 --> 00:05:06,550
environments to name a couple of
adversaries are you afraid of China are

69
00:05:06,550 --> 00:05:11,610
you afraid of Russia afraid of the NSA
are you afraid of organized crime now I

70
00:05:11,610 --> 00:05:14,889
had Pinky and the brain up your ass or
someone wearing a pink in the brain

71
00:05:14,889 --> 00:05:21,629
shirt yesterday and how do they start
every single episode brain what are we

72
00:05:21,629 --> 00:05:26,620
going to do tonight everyone same thing
we do every night try to take over the

73
00:05:26,620 --> 00:05:30,129
world now Erika pointed out to me when I
showed her the slideshows you could have

74
00:05:30,129 --> 00:05:35,120
used a lot of your Putin for organized
crime and Russia

75
00:05:35,120 --> 00:05:41,919
but to be perfectly honest he terrifies
me a lot tremendous amount so this is

76
00:05:41,919 --> 00:05:45,449
the leader of russia and by all intents
and purposes according to polling looks

77
00:05:45,449 --> 00:05:46,850
like we're gonna get donald Trump

78
00:05:46,850 --> 00:05:51,580
it's a hell of a comparison between
those two and that I have never seen

79
00:05:51,580 --> 00:05:55,680
donald Trump without a shirt and now you
have that image in your head so you're

80
00:05:55,680 --> 00:06:00,760
welcome so one last question for
absolutely everybody do you think the

81
00:06:00,760 --> 00:06:03,430
officers that were listed on the
previous slide have the ability to

82
00:06:03,430 --> 00:06:09,960
bypass the limited technologies that I
just mentioned yes there are static your

83
00:06:09,960 --> 00:06:14,050
defenses are static like yours
information security predominately we do

84
00:06:14,050 --> 00:06:18,060
network penetration testing isn't it odd
that the main products we released our

85
00:06:18,060 --> 00:06:21,949
active defense harbinger distribution
the reader framework for hunting because

86
00:06:21,949 --> 00:06:24,650
we desperately want to see the world
become a better place for trying to

87
00:06:24,650 --> 00:06:28,449
create products and released product to
make things difficult for us because

88
00:06:28,449 --> 00:06:34,820
defenses are static and static defenses
are easily bypass is always the bad guys

89
00:06:34,820 --> 00:06:39,229
have got to do is simply get them in
their lab bypass them in their lab and

90
00:06:39,229 --> 00:06:42,930
then bye pass them on your network in
short breaking into your network has

91
00:06:42,930 --> 00:06:46,880
many times a foregone conclusion before
they launched a single packet that you

92
00:06:46,880 --> 00:06:52,610
saw this requires us to be active this
requires us to stay away from the easy

93
00:06:52,610 --> 00:06:57,950
but because every time you hit the easy
button what has God do it doesn't kill a

94
00:06:57,950 --> 00:07:01,190
kitten that something completely
different

95
00:07:01,190 --> 00:07:05,570
you're mixing your means every time you
hit the every time you easy button God

96
00:07:05,570 --> 00:07:09,919
poison other bots on your network we
gotta stay away from the easy but so

97
00:07:09,919 --> 00:07:16,199
hunting is actively looking for advanced
attackers in your network if Phis can

98
00:07:16,199 --> 00:07:21,210
bypass ideas I P SAV attackers can
choose a small company

99
00:07:21,210 --> 00:07:25,360
Hills Black Hills of South Dakota so
we're going to talk about looking for

100
00:07:25,360 --> 00:07:28,990
buchanan activity involves close
coordination with our customers were for

101
00:07:28,990 --> 00:07:29,830
consultants

102
00:07:29,830 --> 00:07:32,849
requires close coordination with her
internal teams as we have to ask

103
00:07:32,849 --> 00:07:36,750
questions because we have to analyze
their networks day it isn't being a

104
00:07:36,750 --> 00:07:40,699
hacker was all about initially was about
knowing things understanding things and

105
00:07:40,699 --> 00:07:42,540
right now we don't understand

106
00:07:42,540 --> 00:07:47,350
instead we're constantly looking for a
product we're constantly looking for an

107
00:07:47,350 --> 00:07:51,820
easy way out there trying to make things
as simplistic as we possibly can I have

108
00:07:51,820 --> 00:07:55,450
a number of customers because hunting
such a hot topic they come up to me and

109
00:07:55,450 --> 00:08:01,000
they say what's the major product in the
hunting in space today that we can buy

110
00:08:01,000 --> 00:08:08,390
and will make on teaming automated for
us in short this is not hunting folks

111
00:08:08,390 --> 00:08:13,670
going out and buying a product off the
shelf and calling it hunting is

112
00:08:13,670 --> 00:08:20,560
completely enough to the entire idea
what hun teaming actually is so how do

113
00:08:20,560 --> 00:08:21,080
we approach

114
00:08:21,080 --> 00:08:24,090
well this is the beginning of a
framework we're not trying to release it

115
00:08:24,090 --> 00:08:27,520
will tell you we can catch up so
everything if anyone stands out like our

116
00:08:27,520 --> 00:08:31,560
country to pee smells like pass that
great write a signature for writing to

117
00:08:31,560 --> 00:08:36,830
plug in the analysis to identify it
let's try to get better actually take

118
00:08:36,830 --> 00:08:39,290
the signature thing back we're going to
talk about signatures were talking about

119
00:08:39,290 --> 00:08:43,320
statistical analysis and other things so
that I'm headed over to job was gonna

120
00:08:43,320 --> 00:08:47,040
come up and going to talk about Jenna
slots are going to Bryan and Eric and

121
00:08:47,040 --> 00:08:50,150
then I'm going to come up and wrapped up
the answer just taking away jobs from

122
00:08:50,150 --> 00:08:54,810
security weekly everybody

123
00:08:54,810 --> 00:09:17,790
that guy come on let's here for dinner
to follow John by the way I did like

124
00:09:17,790 --> 00:09:25,660
she's right across anyway that was
alright so i cant talk about the dry

125
00:09:25,660 --> 00:09:32,350
stuff so a little bit of math c2 hunting
using DNS logs for starters so you know

126
00:09:32,350 --> 00:09:42,390
we the math behind what we wanted to do
to achieve some of the goals and looked

127
00:09:42,390 --> 00:09:49,500
at and DNS logs is a really incredibly
valuable information on your network

128
00:09:49,500 --> 00:09:51,420
what can we do with it

129
00:09:51,420 --> 00:09:55,910
well what we decided pretty early on as
take up fairly simplistic approach let's

130
00:09:55,910 --> 00:10:00,430
look at DNS servers that are facing the
points out of the network let's look at

131
00:10:00,430 --> 00:10:05,020
them from the perspective of getting log
information and performing a peer

132
00:10:05,020 --> 00:10:09,800
statistical analysis of the data that's
coming out of the the logs and compare

133
00:10:09,800 --> 00:10:15,150
what the individual stations are doing
to each other so the idea here is with

134
00:10:15,150 --> 00:10:19,800
Tali all that information up and we just
do means standard deviations and we look

135
00:10:19,800 --> 00:10:25,220
for things that are outliers fairly
fairly simple concept to do that we just

136
00:10:25,220 --> 00:10:31,460
asking our customers just to turn on
debug logging from my perspective or if

137
00:10:31,460 --> 00:10:36,580
they're running up line 94 I'm look at
turning on by nine logging and ingest

138
00:10:36,580 --> 00:10:42,450
those logs into our code whether it's a
Python script last week search we're

139
00:10:42,450 --> 00:10:46,790
just pulling those logs and calculating
the tallies doing the means standard

140
00:10:46,790 --> 00:10:52,820
deviations of pulling out the outlets
guy so wassup totaled my response code

141
00:10:52,820 --> 00:10:56,830
Korean response types we create this
mean and standard deviation

142
00:10:56,830 --> 00:11:02,280
look for standard deviations outside 22
outside the main and if we see them more

143
00:11:02,280 --> 00:11:08,590
than just point them out this one is an
example of just the Python script one of

144
00:11:08,590 --> 00:11:13,320
the challenges we run into what we're
doing this is that we have to filter

145
00:11:13,320 --> 00:11:19,330
certain notes on network in terms of
what their behavior is for example we

146
00:11:19,330 --> 00:11:24,130
might pick up a mail server in the
dataset from the DNS debugging locks

147
00:11:24,130 --> 00:11:28,220
mail service again I have lots of
gimmicks queries and service record

148
00:11:28,220 --> 00:11:32,910
queries maybe txt queries they gonna
stand out immediately as two standard

149
00:11:32,910 --> 00:11:36,590
deviations away from the rest of traffic
so we have to play with the code so that

150
00:11:36,590 --> 00:11:41,330
we're filtering that stuff out so we
don't pick up things that we don't want

151
00:11:41,330 --> 00:11:47,230
to challenge their we can filter that
stuff out intelligently ghetto customers

152
00:11:47,230 --> 00:11:52,240
say look what's your mail server what's
your address space but still to that

153
00:11:52,240 --> 00:12:00,590
list and get get those allies success so
far visualization perspective what we do

154
00:12:00,590 --> 00:12:05,050
is pull that data and we we run the mean
standard deviation and then we take

155
00:12:05,050 --> 00:12:10,210
output of that and we write back into a
field in elasticsearch in the field is a

156
00:12:10,210 --> 00:12:16,480
behavior feel if there is just an
outlier check it and we just as a

157
00:12:16,480 --> 00:12:21,880
potential DNS behavior essentially but
we don't have to look at it and that

158
00:12:21,880 --> 00:12:26,880
perspective we can also look at the raw
data inside elasticsearch using using to

159
00:12:26,880 --> 00:12:30,740
combine our visualization piece in the
Elks tech and just looking at the road

160
00:12:30,740 --> 00:12:36,670
at the example on the screen is raw data
we are running DNS cat right so what's

161
00:12:36,670 --> 00:12:45,730
the behavior of the desk at Liberty know
lots of weeks but right txt txt record

162
00:12:45,730 --> 00:12:49,720
types so do you run that even for a
short time period of five or ten minutes

163
00:12:49,720 --> 00:12:55,750
you're immediately going to see a
massive massive increase in the amount

164
00:12:55,750 --> 00:13:01,700
of txt DNS queries coming from a
specific station if we visualize that

165
00:13:01,700 --> 00:13:07,500
inside of combined in elasticsearch and
we actually just do basic history

166
00:13:07,500 --> 00:13:11,620
grams we gonna see some big deviation
and that's before we even run meanness

167
00:13:11,620 --> 00:13:19,200
and now after we run the analysis we can
cut the data in different ways so this

168
00:13:19,200 --> 00:13:28,820
is just a pie chart after running the
analysis of having the behavior flagged

169
00:13:28,820 --> 00:13:34,730
inside of elasticsearch and then just
plotting the different IP's that have

170
00:13:34,730 --> 00:13:40,270
that flag turned on just a binary flexi
the council really low right but we can

171
00:13:40,270 --> 00:13:44,880
see that in this case we had one address
that had three different record types

172
00:13:44,880 --> 00:13:50,560
that flag and the unusual thing here is
a txt record type again it was that DNS

173
00:13:50,560 --> 00:13:54,940
cat behavior that was the outlier and
got flagged in the data so this is

174
00:13:54,940 --> 00:14:00,760
actually doing visualization on the
results of the analysis rather than just

175
00:14:00,760 --> 00:14:08,390
the ward at Castle you have two choices
so nothing we can do with DNS data is

176
00:14:08,390 --> 00:14:11,520
look at demand generation algorithm

177
00:14:11,520 --> 00:14:15,170
domain name generation algorithms now
this is when we get into more of an AI

178
00:14:15,170 --> 00:14:20,230
approach with them and they maintain
generation algorithm is what I went

179
00:14:20,230 --> 00:14:25,870
after is what I can train a model a
random decision tree essentially that

180
00:14:25,870 --> 00:14:31,380
enables me to identify a domain name
that's highly random identified domain

181
00:14:31,380 --> 00:14:36,070
name that is being looked up it is
likely but not related to what I did is

182
00:14:36,070 --> 00:14:41,230
I went out and wrapped 10,000 DNS
lookups removing DNS that are good

183
00:14:41,230 --> 00:14:45,960
lookups I grabbed the 10 top 10,000
random domain names from the good look

184
00:14:45,960 --> 00:14:51,820
up I'll ok then grabbed the top one
million election good demand stuff from

185
00:14:51,820 --> 00:14:58,850
the Euro right then we grabbed some bad
data in this case the DNS lookup list

186
00:14:58,850 --> 00:15:03,990
from the logging business botnets right
highly randomized DNS lookup straight

187
00:15:03,990 --> 00:15:09,150
out of the algorithms generated this
domain names that were specifically used

188
00:15:09,150 --> 00:15:11,620
perplexing activity with these botnets

189
00:15:11,620 --> 00:15:18,100
and then we grabbed some some good
english words that ok travelers things

190
00:15:18,100 --> 00:15:25,140
and then we have to develop what's Co
classifiers in the DNS Da Ponte me to do

191
00:15:25,140 --> 00:15:29,380
classified as we have to look at
different measures in in the data in

192
00:15:29,380 --> 00:15:32,470
this particular case and this is based
off of work it out there widely

193
00:15:32,470 --> 00:15:38,460
published its click security and entropy
tattoo good measures in grams being the

194
00:15:38,460 --> 00:15:43,930
repeated occurrences in a domain name
into 345 space tend to be very good and

195
00:15:43,930 --> 00:15:48,080
there's a difference between the end
bram distances we take that we measured

196
00:15:48,080 --> 00:15:53,150
across all those data system we get into
a random decision tree this is a classic

197
00:15:53,150 --> 00:15:58,200
AIO much we feed into the random
decision tree and have calculated that

198
00:15:58,200 --> 00:16:03,570
stats in the trees but are essentially
within gotta see realized that train

199
00:16:03,570 --> 00:16:07,820
data to disk and we've built kind of a
brain a way of thinking we can do

200
00:16:07,820 --> 00:16:12,490
different feature sets we could decide
to look at the number of consonants in

201
00:16:12,490 --> 00:16:16,279
the DNS lookup maybe we can look at the
ratio of numbers to letters weekend

202
00:16:16,279 --> 00:16:20,959
different features that we can build a
brain that is biased in certain

203
00:16:20,959 --> 00:16:28,850
directions depending on the data what we
did here was a Python script that

204
00:16:28,850 --> 00:16:33,010
initially just does the classification
of training of the model to disk and

205
00:16:33,010 --> 00:16:41,089
then we look at that and just testing of
that test against the bed remains as

206
00:16:41,089 --> 00:16:45,670
many different datasets testing as we
can to try to get the quality and the

207
00:16:45,670 --> 00:16:51,709
precision of that rain as close as
possible to giving a speech says like I

208
00:16:51,709 --> 00:16:56,740
mentioned we can experiment with so
that's really about it I'm gonna turn it

209
00:16:56,740 --> 00:17:00,400
up to brian i know i have those very
short but I got like six point six

210
00:17:00,400 --> 00:17:05,000
minutes but we will be here for
questions athletes thanks John and we're

211
00:17:05,000 --> 00:17:10,339
gonna have Ryan explained some deep
level math that he developed

212
00:17:10,339 --> 00:17:18,650
the framework so come on up

213
00:17:18,650 --> 00:17:37,900
not begin taking we know we make a lot
of now where they were seen to see two

214
00:17:37,900 --> 00:17:42,320
channels you smile we're gonna try and
it's gonna call home gonna say hey I'm

215
00:17:42,320 --> 00:17:47,790
still here I'm still here I'm still here
and so when these calls happened there

216
00:17:47,790 --> 00:17:54,480
they're usually going to buy happen at
defined intervals gonna happen but by

217
00:17:54,480 --> 00:17:58,120
the time between weekend is going to be
roughly the same usually what we're

218
00:17:58,120 --> 00:18:05,980
seeing right now at most malware and so
on this math

219
00:18:05,980 --> 00:18:13,860
restate the keyboard out that thank you
so so we're looking at working actions

220
00:18:13,860 --> 00:18:19,030
we were looking at this log data it's
really just hiring signals anyone who's

221
00:18:19,030 --> 00:18:23,040
in signal processing you look at this
you'll say yes to signal there's there's

222
00:18:23,040 --> 00:18:27,150
nothing special about it we can take
that and we can apply most the

223
00:18:27,150 --> 00:18:34,360
fundamentals of signal processing and so
when rinsing the process and we have to

224
00:18:34,360 --> 00:18:38,470
demands we have what's called the time
domain so we're looking at things

225
00:18:38,470 --> 00:18:45,320
occurring over series saying like this
occurred this time next connection and

226
00:18:45,320 --> 00:18:50,500
we we spread that out and so we have a
time and we have an amplitude alright so

227
00:18:50,500 --> 00:18:55,250
the other the other domain that we look
at all the frequency-domain we're

228
00:18:55,250 --> 00:18:59,799
looking at what frequency or
disconnections happening what frequency

229
00:18:59,799 --> 00:19:06,690
as is most dominant in the signal that
we're looking at and so how can we

230
00:19:06,690 --> 00:19:10,210
determine the frequency if we have a
time signal we have something occurring

231
00:19:10,210 --> 00:19:16,250
and I'm space in the time domain how can
we tell what we can see that well we

232
00:19:16,250 --> 00:19:20,130
have what's called fast Fourier
transform technically the Discrete

233
00:19:20,130 --> 00:19:26,090
Fourier Transform won't go too much into
that here and really all this does is it

234
00:19:26,090 --> 00:19:31,570
just passport signal from the space for
spatial domain to the frequency domain

235
00:19:31,570 --> 00:19:37,590
so we can look at that data in a little
bit different way and so what does this

236
00:19:37,590 --> 00:19:38,570
mean

237
00:19:38,570 --> 00:19:43,559
alright well most users if you look at
most user activity it's not going to be

238
00:19:43,559 --> 00:19:47,500
a predefined interval I'm not going to
click on a link every five seconds I'm

239
00:19:47,500 --> 00:19:51,120
not going to view an image every 10
seconds talking to happen is going to be

240
00:19:51,120 --> 00:19:54,929
some variation there's going to be some
randomness in the way that I'm browsing

241
00:19:54,929 --> 00:20:01,350
around and so most software though it's
not going to her animals especially

242
00:20:01,350 --> 00:20:05,690
malware that's what we're seeing with
major powers that that's out there after

243
00:20:05,690 --> 00:20:11,870
being asked at all the things I would
say about a little bit later but all

244
00:20:11,870 --> 00:20:15,679
these are really crane regular intervals
and this is something that sticks out

245
00:20:15,679 --> 00:20:21,039
quite a bit if we make those connections
and we look at that within the frequency

246
00:20:21,039 --> 00:20:27,029
domain we can quickly brought back and
I'll show you that here so here's just

247
00:20:27,029 --> 00:20:30,679
some data generated this is an actual
log data but this is just kind of more

248
00:20:30,679 --> 00:20:35,600
of the fundamentals of a powerful this
process works so on the top we have a

249
00:20:35,600 --> 00:20:40,659
signal that end the time domain you can
see it on the x-axis there we have time

250
00:20:40,659 --> 00:20:41,649
in seconds

251
00:20:41,649 --> 00:20:46,039
y axis just amplitude of the signal to
basic science I mean you can look at

252
00:20:46,039 --> 00:20:49,830
that and you can say that's occurring at
a particular frequency let's see what we

253
00:20:49,830 --> 00:20:54,299
can see is that a car now so after
taking that signal running that through

254
00:20:54,299 --> 00:20:59,340
the fast Fourier transform we get down
on the bottom the frequency domain of

255
00:20:59,340 --> 00:21:04,039
that the person sitting in grass and
there we have a large spike it said

256
00:21:04,039 --> 00:21:12,139
about 55 per five times per second as
the frequency of that transition ok cool

257
00:21:12,139 --> 00:21:17,389
so what's cooking something a little bit
faster ok so we can look at that looks

258
00:21:17,389 --> 00:21:22,019
like a regular frequency but what
frequency ok so here we can see this

259
00:21:22,019 --> 00:21:25,710
100% hundred times per second

260
00:21:25,710 --> 00:21:27,950
these transitions are

261
00:21:27,950 --> 00:21:34,169
alright so what's what's making little
more interesting what about if we add

262
00:21:34,169 --> 00:21:38,539
some noise so say there's some gender so
this this might be something more what

263
00:21:38,539 --> 00:21:43,000
you're going to see we we have this
signal now we're looking at this point

264
00:21:43,000 --> 00:21:48,549
on the left we can we can see you know
we're looking at is is redefined

265
00:21:48,549 --> 00:21:51,980
frequency is that occurring regular
intervals I don't know but what's right

266
00:21:51,980 --> 00:21:55,980
to the poor transport and on the bottom
we can clearly see there's still that

267
00:21:55,980 --> 00:22:00,720
spike so I've done there is I took that
previous signal every hundred her during

268
00:22:00,720 --> 00:22:05,710
some noise we run it transformed film
it's still there and knows exactly that

269
00:22:05,710 --> 00:22:11,990
there is a dominant frequency in that
and so we compare that to the right

270
00:22:11,990 --> 00:22:18,669
graph all that is random noise created a
random signal that might be a little bit

271
00:22:18,669 --> 00:22:23,080
closer to a user behaviour going to be
you can see we don't have any large

272
00:22:23,080 --> 00:22:26,779
spikes we don't have any huge spikes
sticking out and say hey this is

273
00:22:26,779 --> 00:22:32,120
occurring at exactly this frequency it's
more static it's more noise and so that

274
00:22:32,120 --> 00:22:37,539
that's one way that we can kind of
distinguish malware behavior from normal

275
00:22:37,539 --> 00:22:40,580
user behavior so we're looking through
logs were throwing this connection data

276
00:22:40,580 --> 00:22:45,679
through these transforms are going
through and we see something I like what

277
00:22:45,679 --> 00:22:49,679
you see on the left there but hey that's
that's the first thing we should go look

278
00:22:49,679 --> 00:22:54,010
at that we should find out you know do
we expect that software to be there or

279
00:22:54,010 --> 00:22:56,519
is that something unexpected

280
00:22:56,519 --> 00:22:57,140
up

281
00:22:57,140 --> 00:23:04,430
and so that passes over to derek is
going to talk about the actual results

282
00:23:04,430 --> 00:23:13,600
we've got per hour

283
00:23:13,600 --> 00:23:32,240
testing we set up a FreeBSD router and
used 12 to capture the data using bro if

284
00:23:32,240 --> 00:23:37,510
anyone knows me and talks to me and
unapologetic growth and win so I had to

285
00:23:37,510 --> 00:23:38,650
use broke the law

286
00:23:38,650 --> 00:23:45,960
this and then the infected Windows 7
machine was routed to go through the BSD

287
00:23:45,960 --> 00:23:51,110
riders the default routes and the
FreeBSD rather had a bridge connection

288
00:23:51,110 --> 00:23:58,409
over using VirtualBox as Internet
feature to log on one of the interfaces

289
00:23:58,409 --> 00:24:03,049
on the brain machine and then we wrote a
python script to simulate random traffic

290
00:24:03,049 --> 00:24:07,530
because obviously there's not a whole
lot of users in this environment so we

291
00:24:07,530 --> 00:24:11,830
want to make sure that there was some
random randomness in the law

292
00:24:11,830 --> 00:24:16,539
so we started with PowerShell empire of
use PowerShell impaired as a REIT

293
00:24:16,539 --> 00:24:24,380
framework the default Bay that you can
treat situ and in PowerShell empire is

294
00:24:24,380 --> 00:24:28,870
through HTTP and if you look at a long
pilots fairly obvious talents

295
00:24:28,870 --> 00:24:33,830
communicating that a false the default
of five second interval you can

296
00:24:33,830 --> 00:24:38,090
configure Jer we did not configured for
this and if you look at the graph

297
00:24:38,090 --> 00:24:45,149
there's a Mac speak point winning and
then some mortgages after that

298
00:24:45,149 --> 00:24:50,470
on the bottom you can see that it's a
little difficult to see but in the log

299
00:24:50,470 --> 00:24:55,690
files every five seconds it's beginning
out to the IP address that we had a

300
00:24:55,690 --> 00:25:02,039
romantic stroll the max P works out to
be if you do the math every 5.3 seconds

301
00:25:02,039 --> 00:25:04,770
so it it matched up

302
00:25:04,770 --> 00:25:11,620
next we use custom out where that we
have called BSE agent this uses HTTP

303
00:25:11,620 --> 00:25:20,660
used to communicate so again we set it
up and do the longing we discovered that

304
00:25:20,660 --> 00:25:26,450
there was a max peak value of 2009 8 and
so that worked out to be every 10

305
00:25:26,450 --> 00:25:32,140
seconds if you look at the log files it
matched every 10 seconds it was back

306
00:25:32,140 --> 00:25:32,760
home

307
00:25:32,760 --> 00:25:36,720
mutation next

308
00:25:36,720 --> 00:25:45,320
everybody separate we set it up to be
encrypted HTTPS using a reverse HTTP

309
00:25:45,320 --> 00:25:50,790
HTTPS model and in the log files we saw
that it was basically every 10 seconds

310
00:25:50,790 --> 00:25:59,120
and again the max value of the Fourier
transform match the actual beginning

311
00:25:59,120 --> 00:26:00,490
traffic

312
00:26:00,490 --> 00:26:09,970
and then job talking earlier about DNS
cat we had used as well to test here is

313
00:26:09,970 --> 00:26:14,750
actually a little bit different DNS cat
communicate every one second and

314
00:26:14,750 --> 00:26:17,880
actually did not know this until we
actually started looking at the log file

315
00:26:17,880 --> 00:26:25,070
to have no idea how how much traffic was
involved with Dennis to hear the max

316
00:26:25,070 --> 00:26:31,559
value doesn't match however you can see
it the same peaks and valleys are strong

317
00:26:31,559 --> 00:26:35,370
signal there at the beginning is
occurring the reason it doesn't match is

318
00:26:35,370 --> 00:26:42,040
more mountainous it's the Nyquist
Nyquist frequency it's because the

319
00:26:42,040 --> 00:26:46,870
traffic is everyone second the fast
Fourier transform because the minimum

320
00:26:46,870 --> 00:26:52,910
time is one second and in in the series
it can't pick up that because that

321
00:26:52,910 --> 00:26:57,400
traffic however you still see their
strong peaks and valleys obviously

322
00:26:57,400 --> 00:27:10,460
begins now

323
00:27:10,460 --> 00:27:17,620
like everybody take from this is we are
not up here saying here we're gonna

324
00:27:17,620 --> 00:27:22,190
catch all know that's not the point we
are saying is hey let's hope we create a

325
00:27:22,190 --> 00:27:26,340
framework where we can actually do some
statistical analysis to help us identify

326
00:27:26,340 --> 00:27:32,360
more advanced math and I think that's
the key key difference and as part of it

327
00:27:32,360 --> 00:27:34,860
being a free market means that we have
different things that are going to come

328
00:27:34,860 --> 00:27:42,600
out all the time for example do we have
Lisa and joe joe joe said up there also

329
00:27:42,600 --> 00:27:51,390
to the developers on this project so
give them around

330
00:27:51,390 --> 00:27:54,730
last week the office and Lisa

331
00:27:54,730 --> 00:27:58,640
be down here is we've we've got a
problem we had a problem and the problem

332
00:27:58,640 --> 00:28:02,440
was if you have something that has a
strong beacon and in that system goes

333
00:28:02,440 --> 00:28:09,120
offline for six hours and it comes back
on Moses and fast Fourier transform of

334
00:28:09,120 --> 00:28:13,690
run into issues and actually identifying
it as an outlier so she wrote a new all

335
00:28:13,690 --> 00:28:18,690
Jones wrote a new algorithm that would
help identify this particular case you

336
00:28:18,690 --> 00:28:21,930
also have randomized didn't like
something tries to be randomized it's

337
00:28:21,930 --> 00:28:25,640
beginning to actually go about
protecting that you also have edta acts

338
00:28:25,640 --> 00:28:31,310
event logs in comparison you can import
into into the system and look for

339
00:28:31,310 --> 00:28:34,960
multiple concurrent logins has nothing
to do with being inside but don't you

340
00:28:34,960 --> 00:28:38,030
think would be useful if you're doing
incident response you could pull list of

341
00:28:38,030 --> 00:28:42,260
every single accountants concurrently
logged in at the same time

342
00:28:42,260 --> 00:28:48,430
ok that's in here also bad demands were
shocked at how many organizations we go

343
00:28:48,430 --> 00:28:52,230
into we run that just say okay how many
systems on the insider going to known

344
00:28:52,230 --> 00:28:57,690
bad actor demands a lot apparently and
that was kind of shocking when that

345
00:28:57,690 --> 00:29:02,130
occurred so you should take from all of
this is what we're giving you is

346
00:29:02,130 --> 00:29:07,150
effectively a prism and we're inviting
everybody to come and help us with a

347
00:29:07,150 --> 00:29:11,800
prison work together a prison if you
know what the prism you turn it and it

348
00:29:11,800 --> 00:29:14,700
displays different light right it's all
the same white then breaks it up into

349
00:29:14,700 --> 00:29:19,670
different frequencies colors you are not
trying to develop a framework that

350
00:29:19,670 --> 00:29:25,310
basically says hey this is pure evil in
generate similar that's that's not what

351
00:29:25,310 --> 00:29:29,780
we're trying to do is create tools
require us to Iraqi data and giving us

352
00:29:29,780 --> 00:29:34,840
the ability to do so right now I
strongly believe that we are going to

353
00:29:34,840 --> 00:29:37,760
see very many products in the space that
are going to be very good at this and I

354
00:29:37,760 --> 00:29:43,610
don't want to explain why not right away
right I don't think that we're going to

355
00:29:43,610 --> 00:29:46,780
see a lot of products in this space
they're gonna do fantastic anytime real

356
00:29:46,780 --> 00:29:50,260
soon in the reason why I don't believe
that we're gonna get into this anytime

357
00:29:50,260 --> 00:29:56,120
real soon as because the tremendous
amount of false positives ok so let's go

358
00:29:56,120 --> 00:30:02,320
through some sample some data we've seen
if you have an antispam plants and it's

359
00:30:02,320 --> 00:30:06,150
checking demands constantly see if those
demands are evil for spam coming in do

360
00:30:06,150 --> 00:30:09,060
you think that's gonna generator
frequency that is going to known bad

361
00:30:09,060 --> 00:30:10,740
demands on a very regular basis

362
00:30:10,740 --> 00:30:15,970
oh hell yeah okay here's another fun
questions Skype IP addresses or Skype

363
00:30:15,970 --> 00:30:21,230
connect back and then makes connections
you can do Skype to the stay static no

364
00:30:21,230 --> 00:30:27,650
need to move around the port stay static
all the time no see situations were

365
00:30:27,650 --> 00:30:31,850
Skype is generating frequency see
situations where box.com traffic or

366
00:30:31,850 --> 00:30:35,730
Dropbox generating this type of
frequency we've even seen organizations

367
00:30:35,730 --> 00:30:40,580
for whatever reason they've decided to
put a syslog server on Amazon instead of

368
00:30:40,580 --> 00:30:44,480
the inside of their network and systems
regularly sending logs out to the Amazon

369
00:30:44,480 --> 00:30:47,490
ec2 Cloud you're like why are you doing
that

370
00:30:47,490 --> 00:30:48,330
like we

371
00:30:48,330 --> 00:30:56,539
so so that looks like beginning so the
point of all of this is somebody was

372
00:30:56,539 --> 00:30:59,399
going to try to create a commercial
product just kicked out a report nicely

373
00:30:59,399 --> 00:31:05,220
at the end of the day said you had been
hacked it's not going to happen because

374
00:31:05,220 --> 00:31:08,870
there's so much noise in your
environment looks like Mauer except

375
00:31:08,870 --> 00:31:13,059
that's not really the right way to look
at it now is it more accurately is your

376
00:31:13,059 --> 00:31:17,059
mouth where is beginning to look like
the noise in your network and we need

377
00:31:17,059 --> 00:31:21,250
better tools to actually start filtering
filtering doing analysis like I said

378
00:31:21,250 --> 00:31:27,539
this is absolutely an invitation for
absolutely everyone in this room too if

379
00:31:27,539 --> 00:31:29,909
you want to get involved you want to
write something in Python he wants a

380
00:31:29,909 --> 00:31:33,470
minute so we can do a different type of
analysis think that's awesome

381
00:31:33,470 --> 00:31:38,480
somebody wants to take a file parser two
parcels specific weird type of firewall

382
00:31:38,480 --> 00:31:43,320
or some type of DNS that we have
encountered yet thank you that's awesome

383
00:31:43,320 --> 00:31:47,070
so basically creating a framework for
inviting everyone to come this way and

384
00:31:47,070 --> 00:31:50,809
that brain working of course we can use
it well and it gets into a bigger

385
00:31:50,809 --> 00:31:53,659
problem computer security at least I'm
hoping that this helps make things

386
00:31:53,659 --> 00:32:00,110
better because seriously what did you
guys think security was going to be in

387
00:32:00,110 --> 00:32:02,980
this matters because we have children in
the audience right and the kids alike

388
00:32:02,980 --> 00:32:06,909
should I get into computer security
computer security awesome is it is it is

389
00:32:06,909 --> 00:32:12,679
it like Derby Conn is it ok so packing
with two people on the same keyboard for

390
00:32:12,679 --> 00:32:20,580
tried that it's really hard so is
talking about this in Lawrence is gonna

391
00:32:20,580 --> 00:32:24,630
come up here in a couple of seconds said
you know there's a theory that hollywood

392
00:32:24,630 --> 00:32:27,480
all the script writers are trying to
come up with the most insane thing

393
00:32:27,480 --> 00:32:31,940
possible that will actually make it all
the way through making it onto a TV show

394
00:32:31,940 --> 00:32:38,360
or movie this guy must have won
something we wrote the same quote I love

395
00:32:38,360 --> 00:32:44,050
it he goes he has to know how keyboards
work he wrote a script

396
00:32:44,050 --> 00:32:50,870
so you know this is what we think
computer security is like right when you

397
00:32:50,870 --> 00:32:53,860
walk by some of the boots that are out
there and they become a cyber warrior

398
00:32:53,860 --> 00:32:58,730
become a cyber defender and the fact of
the matter is this isn't what computer

399
00:32:58,730 --> 00:33:04,450
security is like more accurately what
computer security is like is a computer

400
00:33:04,450 --> 00:33:09,200
breaks or gets compromised and then you
clean up constantly get notification

401
00:33:09,200 --> 00:33:20,170
cleanup on aisle three bill Smith's
computer has crypto locker and I am so

402
00:33:20,170 --> 00:33:24,380
glad you're home to someone pooped in
the hallway how many of you when you get

403
00:33:24,380 --> 00:33:28,430
back to work on Monday you fully expect
someone to come up here and ask

404
00:33:28,430 --> 00:33:33,750
something analogous to the new house
Derby Conn it was good

405
00:33:33,750 --> 00:33:45,880
Bill Smith groups in the whole immune
system is compromised no literal so this

406
00:33:45,880 --> 00:33:49,430
is what computer security is right is
cleaning up after things and it's not

407
00:33:49,430 --> 00:33:54,440
being a cyberwar right we're not running
around fighting hackers yet we might be

408
00:33:54,440 --> 00:33:57,650
able to hunt for and this is at least
interesting and this is what we're

409
00:33:57,650 --> 00:34:01,470
trying to do we're trying desperately to
make things better now

410
00:34:01,470 --> 00:34:06,420
Lawrence link for me so as I said here's
the deal

411
00:34:06,420 --> 00:34:12,130
the framework that we're releasing is
going to be get proposals got a couple

412
00:34:12,130 --> 00:34:31,260
of things geez we're gonna put this up
on get free guest today this is this is

413
00:34:31,260 --> 00:34:38,660
meant to be downloaded played with added
to you can you can add modules so so the

414
00:34:38,660 --> 00:34:40,120
short stories huh

415
00:34:40,120 --> 00:34:46,560
sometime last week John Johnson you know
be really cool front end so I got

416
00:34:46,560 --> 00:34:54,790
together with joanne woodward supply
closet and we wrote our opponents over

417
00:34:54,790 --> 00:34:58,330
the past week and it's not bad it's
actually pretty good

418
00:34:58,330 --> 00:35:03,980
its its its modular eyes so if you were
to write your own scripts and you

419
00:35:03,980 --> 00:35:06,730
thought that it might be cool to have in
there there's about eight lines that

420
00:35:06,730 --> 00:35:10,310
need to put at the top of your module
the frontal automatically detected

421
00:35:10,310 --> 00:35:14,990
loaded so it's something that everybody
can add to and as john said that

422
00:35:14,990 --> 00:35:18,600
something that we want to encourage add
to it the email address

423
00:35:18,600 --> 00:35:22,310
that's they're actually goes the
developers and we will be reading the

424
00:35:22,310 --> 00:35:25,350
email so I hate mail

425
00:35:25,350 --> 00:35:29,820
go ahead and talk to us about about what
you wanna see and whatnot and notes that

426
00:35:29,820 --> 00:35:34,170
there will be a reach me there there is
some dependencies year the tools that we

427
00:35:34,170 --> 00:35:39,080
use a black girls in postsecondary like
elasticsearch logs that we're almost

428
00:35:39,080 --> 00:35:42,170
this in a Debian environment so it's
probably gonna be easy as the set up

429
00:35:42,170 --> 00:35:46,550
there and I'll be around at the booth
today have any questions about the way

430
00:35:46,550 --> 00:35:50,900
lawrence is the official official her
cats on this project so round of

431
00:35:50,900 --> 00:35:55,760
applause for him to make sure top

432
00:35:55,760 --> 00:36:01,690
so I would like the team to come up here
and I would like to field questions and

433
00:36:01,690 --> 00:36:07,650
I will play donahue walk around here the
question we have a wireless mic that I

434
00:36:07,650 --> 00:36:08,820
can use at all

435
00:36:08,820 --> 00:36:12,520
alright since we don't have a wireless
mic I want the team to come up and you

436
00:36:12,520 --> 00:36:17,600
guys just raise your hand and coming
here question and then sell it for

437
00:36:17,600 --> 00:36:20,930
everybody or you can just shot it out
for like to open it up for questions and

438
00:36:20,930 --> 00:36:26,440
so let's get started

439
00:36:26,440 --> 00:36:53,170
so the question is right now we're
specifically focusing on areas like well

440
00:36:53,170 --> 00:36:56,790
there's some of the things that we have
like doing URL analysis for web proxy

441
00:36:56,790 --> 00:37:01,440
logs connection logs on routers and
firewalls and then also DNS logs we

442
00:37:01,440 --> 00:37:04,650
focus on those three areas predominately
because they're everywhere they are the

443
00:37:04,650 --> 00:37:07,950
bottle next but you also said you could
also write plugins specifically for

444
00:37:07,950 --> 00:37:12,320
API's and custom applications to do the
same type of analysis on this outpatient

445
00:37:12,320 --> 00:37:26,250
center correct interpretation of your
question

446
00:37:26,250 --> 00:37:30,520
so so you don't have good DNS logs but
you do have connection logs for other

447
00:37:30,520 --> 00:37:31,630
apps is that correct

448
00:37:31,630 --> 00:37:39,390
alright I'm gonna give this was Brian
because it's all so I said something

449
00:37:39,390 --> 00:37:41,480
we're we're constantly working on as
well

450
00:37:41,480 --> 00:37:46,650
doing with different formats one of the
tools we have in place for Python

451
00:37:46,650 --> 00:37:52,680
version of framework is is using walk /
so you're not familiar with locks that

452
00:37:52,680 --> 00:37:58,830
shit makes it up pretty easy to write a
custom parser for a different formats so

453
00:37:58,830 --> 00:38:02,910
basically what you need to do is you
just need to take your log format you

454
00:38:02,910 --> 00:38:07,250
how you need to look at the different
plz have so see you know where you have

455
00:38:07,250 --> 00:38:13,280
source IP we have a destination IP
destination and write filter in lockstep

456
00:38:13,280 --> 00:38:18,520
snow go ahead and hold an information
out and it opened in to elasticsearch so

457
00:38:18,520 --> 00:38:22,020
you work throughout the quote that we
have you'll see how to power naming

458
00:38:22,020 --> 00:38:26,430
fields where what we expect but what
they do we expect the different analysis

459
00:38:26,430 --> 00:38:31,520
modules as soon as you write a walk and
you get that into the elasticsearch

460
00:38:31,520 --> 00:38:36,760
database then it doesn't really matter
who the analysis as long as it has the

461
00:38:36,760 --> 00:38:40,810
different needed that it needs it
doesn't care as much about walk the walk

462
00:38:40,810 --> 00:38:51,599
source rather

463
00:38:51,599 --> 00:38:56,619
yeah that's one of the things we're just
talking about that's why we need more

464
00:38:56,619 --> 00:39:00,829
filters so the point was a bad guy and I
know that it's trouble trouble looking

465
00:39:00,829 --> 00:39:09,190
at reporting transformants speaking at a
second or less one so so yeah absolutely

466
00:39:09,190 --> 00:39:13,009
and that's why we can write additional
brokers also possible guys can't answer

467
00:39:13,009 --> 00:39:20,650
that that's why we're working on that a
little bit too so it's not it's not that

468
00:39:20,650 --> 00:39:25,489
it detected if it's going to pass it's
that it's not going to show it at the

469
00:39:25,489 --> 00:39:31,720
rape frequency in the crap here

470
00:39:31,720 --> 00:39:38,489
yeah this one you can see that we
actually still are you can see that we

471
00:39:38,489 --> 00:39:44,009
actually still detected it just the
issue is is that where it says the

472
00:39:44,009 --> 00:39:48,950
preconceived it's occurring isn't
actually a true frequency but it's still

473
00:39:48,950 --> 00:39:54,569
there we still detected that happening
and so but the next question probably

474
00:39:54,569 --> 00:39:58,579
going to be alright so we mention it's
going we're gonna have to do it ran

475
00:39:58,579 --> 00:40:03,079
behavior what we do there so that's
that's something else we're working on

476
00:40:03,079 --> 00:40:07,210
we have a proven concepts something John
Lee said iraq not as well to which I

477
00:40:07,210 --> 00:40:12,109
think works really get that thing is
that you know we we do browse randomly

478
00:40:12,109 --> 00:40:17,160
it's not predefined intervals but we
don't browse 100% randomly so if you're

479
00:40:17,160 --> 00:40:24,309
using like a random number generator if
we take that we take the time in between

480
00:40:24,309 --> 00:40:28,460
the numbers we look at that over a long
period of time and we build a histogram

481
00:40:28,460 --> 00:40:33,969
if that beacon was generated using a
random random number generator what

482
00:40:33,969 --> 00:40:39,039
you're going to get is a distribution
histogram that's almost wow that's weird

483
00:40:39,039 --> 00:40:43,910
people are not going to generate a
statistically wow its turnaround from

484
00:40:43,910 --> 00:40:46,989
there and they're so that's one thing
that one thing we're going to

485
00:40:46,989 --> 00:40:49,770
investigate well

486
00:40:49,770 --> 00:41:29,270
got ray Davidson PhD extraordinaire so
so raise point on that is so we used to

487
00:41:29,270 --> 00:41:33,060
tell people if you wanna get information
security learn and learn lessons learned

488
00:41:33,060 --> 00:41:36,290
Metasploit learn the tools to break into
things and I still think that that

489
00:41:36,290 --> 00:41:40,480
follows I think that's true so many
paraphrase a little bit crazed saying if

490
00:41:40,480 --> 00:41:44,380
you wanna get really good computer
security it helps to have like an

491
00:41:44,380 --> 00:41:48,590
electrical engineering degree or
something of that nature so what are

492
00:41:48,590 --> 00:42:06,560
your degrees in any of the mighty
security so that I did do is in

493
00:42:06,560 --> 00:42:09,970
mechanical engineering and while I said
that I did a lot of signal process and

494
00:42:09,970 --> 00:42:13,700
that's kind of what got me into that
field in so when I get on with the job

495
00:42:13,700 --> 00:42:17,650
figures in the first week of the
problems we want to work out with the

496
00:42:17,650 --> 00:42:21,820
walks and one of the things that came up
was you know how to read attack things

497
00:42:21,820 --> 00:42:25,590
radio frequencies and Watson just
insanely popular you know you wanna

498
00:42:25,590 --> 00:42:37,339
frequency so it says that's that's kind
of a green hoodie doing fantastic

499
00:42:37,339 --> 00:43:06,339
so question something something
something math deviations 95% something

500
00:43:06,339 --> 00:43:15,869
something how did you get so I'm gonna
hand it over to job as I think everybody

501
00:43:15,869 --> 00:43:19,739
heard it's a job I think you've heard it
so go ahead and I'm not sure that I can

502
00:43:19,739 --> 00:43:24,119
answer it first of all I want to point
out that as we ingest Edina stated we

503
00:43:24,119 --> 00:43:29,219
are able to filter through which we try
to make intelligent decisions as to what

504
00:43:29,219 --> 00:43:34,430
group of that up with has pausing so we
we we have an implicit assumption that

505
00:43:34,430 --> 00:43:35,869
is it is going to be normal

506
00:43:35,869 --> 00:43:41,700
overtime space but only if we are
ingesting the data that represents the

507
00:43:41,700 --> 00:43:45,829
client workstations so there is an
implicit implicit assumption there but

508
00:43:45,829 --> 00:43:50,549
it's a very good question and also I do
have degree in mathematics but it's a

509
00:43:50,549 --> 00:44:02,090
lot older industrial then brian's agrees
adding and subtracting rocks

510
00:44:02,090 --> 00:44:17,840
any other questions you sir the orange
shirt in the back

511
00:44:17,840 --> 00:44:20,870
time to live on DNS does that matter

512
00:44:20,870 --> 00:44:29,770
yeah yes and no one of the things we did
start that that's that's a good question

513
00:44:29,770 --> 00:44:35,610
we did look at DNS cache that we don't
we don't the cash out of control we

514
00:44:35,610 --> 00:44:40,680
jumped up on nine we took a look at it
from the perspective of good bad record

515
00:44:40,680 --> 00:44:46,700
lookup one of the challenges is exactly
that DNS details expire and the cash

516
00:44:46,700 --> 00:44:52,970
transient so we should have stopped
looking because it really didn't turn

517
00:44:52,970 --> 00:44:56,360
out to be as useful as we thought that
doesn't mean we gonna stop looking for

518
00:44:56,360 --> 00:45:10,470
ever but yet your question that got it
alright so what type of sites have very

519
00:45:10,470 --> 00:45:18,110
very short details and not just bad ones
not just bedrooms what else round robin

520
00:45:18,110 --> 00:45:25,190
for what types of sites very big sites
right so Google has very short TTL

521
00:45:25,190 --> 00:45:30,910
values we would expect right we would
expect that if you have a hot pic kitten

522
00:45:30,910 --> 00:45:38,220
love and it's got a very short TTL value
is that strange so yes we haven't given

523
00:45:38,220 --> 00:45:42,390
up on details it's just it's it's harder
to go through and filter out those types

524
00:45:42,390 --> 00:45:45,550
of demands that we would expect to have
very very short TTL values associated

525
00:45:45,550 --> 00:45:50,820
with does that help answer the question
very cool yeah this guy over here in the

526
00:45:50,820 --> 00:45:53,640
fancy hat hat sir

527
00:45:53,640 --> 00:46:30,880
that's a fantastic point there's a lot
of pot that's out there that actually

528
00:46:30,880 --> 00:46:35,140
looks like they're preparing for this
and they're starting to change the way

529
00:46:35,140 --> 00:46:39,170
they do random at randomization or not
and how they actually set up and that's

530
00:46:39,170 --> 00:46:42,289
why we said it's important you look at
this is a prism it's not like one

531
00:46:42,289 --> 00:46:47,000
specific look its best looking at in
multiple ways so they can change number

532
00:46:47,000 --> 00:46:49,640
of their behaviour but odds are once you
look at it

533
00:46:49,640 --> 00:46:52,789
56 different ways probably gonna be at
least one of those that shows up as an

534
00:46:52,789 --> 00:46:56,349
indicator and that's what you want and
that's the goal so great point but if we

535
00:46:56,349 --> 00:47:00,490
can raise the bar and keep doing that as
we haven't seen a lot of an hour until

536
00:47:00,490 --> 00:47:04,940
fairly recently getting all that hard to
detect on the network if you're actually

537
00:47:04,940 --> 00:47:07,279
looking for it you know what you're
looking for

538
00:47:07,279 --> 00:47:10,250
so you have to continue to elevate their
game that's what it means we're pushing

539
00:47:10,250 --> 00:47:16,089
them all very good at just one thing to
that in the India classification she

540
00:47:16,089 --> 00:47:20,539
just said that I was using for the DGA
detection algorithm I wins three gram

541
00:47:20,539 --> 00:47:24,670
for gram fiber him seem to be a nice
balance and I went with the differences

542
00:47:24,670 --> 00:47:30,329
between the distance between them in the
strike one of the other things I want to

543
00:47:30,329 --> 00:47:36,259
add into that is is that in grammar and
English water and try to differentiate

544
00:47:36,259 --> 00:47:41,220
that out so keep lexan the hour then I'm
gonna build multiple brains essentially

545
00:47:41,220 --> 00:47:44,460
that have different biases and will try
to advertising with different prices so

546
00:47:44,460 --> 00:47:50,849
you have the choice of which one you
want to apply for a question gentleman

547
00:47:50,849 --> 00:47:53,470
in the red polo shirts

548
00:47:53,470 --> 00:48:13,450
just one mark of you never go for Marcus
the answer is I'm really busy and yes

549
00:48:13,450 --> 00:48:18,940
it's in the pipeline for me to look at
haven't done a yes yet would you like to

550
00:48:18,940 --> 00:48:24,310
write it it's a good question you're
welcome to come work with me on that I'd

551
00:48:24,310 --> 00:48:37,580
love to have somebody that's my biggest
plenty of data analytics is not it is

552
00:48:37,580 --> 00:49:02,440
difficult to do and it takes a lot of
experimentation research question right

553
00:49:02,440 --> 00:49:08,200
so just paraphrase that if you go down
the direction you going to bias the

554
00:49:08,200 --> 00:49:13,390
model and that's true of any of this
work actually you know even even the end

555
00:49:13,390 --> 00:49:18,830
of the entropy approach makes the string
any one of these approaches in the class

556
00:49:18,830 --> 00:49:22,970
is gonna buy said one direction or the
other and say I think that's the reason

557
00:49:22,970 --> 00:49:27,339
for us to develop multiple filters
multiple approaches and Abby and to be

558
00:49:27,339 --> 00:49:35,060
very very descriptive balancing you know
what you're getting into ya know

559
00:49:35,060 --> 00:49:49,150
this is rob van der brink this is gonna
hurt rob the question was there any stew

560
00:49:49,150 --> 00:50:03,560
because of work station DNS cache with
the answer is yes but I think it's yes I

561
00:50:03,560 --> 00:50:09,170
i mean i think naturally it's going to
be a threat to cash in on hold on to

562
00:50:09,170 --> 00:50:14,440
record video it s as to whether the
demented souls gonna log the record is

563
00:50:14,440 --> 00:50:19,560
gonna be at time of look at look up I
think we're gonna see you not only work

564
00:50:19,560 --> 00:50:25,460
session cache gussied up from dance cash
in unison structures were a question

565
00:50:25,460 --> 00:50:37,280
back so the question must execute repeat
the question will ever I didn't quite

566
00:50:37,280 --> 00:50:46,800
catch yes we don't have that much yet
the question what have we done the

567
00:50:46,800 --> 00:50:50,590
modeling over DHCP networks work with
clients and moving around in the network

568
00:50:50,590 --> 00:50:54,810
we don't have that much less an
excellent idea and I think it's well

569
00:50:54,810 --> 00:51:00,440
with us looking at running that we can
actually imported my hostname as well as

570
00:51:00,440 --> 00:51:03,630
long as that's being logged at some
point then you can probably make sure

571
00:51:03,630 --> 00:51:06,680
that they match up with that specific
time whenever that log entries created

572
00:51:06,680 --> 00:51:11,300
so right now is based on IP address but
yes it be relatively the hostname and

573
00:51:11,300 --> 00:51:22,289
then walk back but that would require
some water filtering

574
00:51:22,289 --> 00:51:32,419
so the question was looking at HDB data
yes and back whenever you're looking at

575
00:51:32,419 --> 00:51:35,709
the Fourier transforms it was leaving
your environment it doesn't care what

576
00:51:35,709 --> 00:51:40,229
the protocol is it is it communicating
outbound one of the things that we're

577
00:51:40,229 --> 00:51:44,079
learning very very very cleanly right
now is that traditional detection I

578
00:51:44,079 --> 00:51:49,140
don't wanna say is dead because it still
has value but it's very nearly dead in

579
00:51:49,140 --> 00:51:52,640
there in the reason why is it we look at
vs agent just told that we wrote anybody

580
00:51:52,640 --> 00:51:53,469
can download it

581
00:51:53,469 --> 00:51:57,199
we actually created it so it's clear
text HTTP interview state parameter that

582
00:51:57,199 --> 00:52:00,660
space 64 encoded with random characters
in the middle of it so it's extremely

583
00:52:00,660 --> 00:52:07,979
difficult to identify it doesn't clear
tax base 64 its beginning out it's very

584
00:52:07,979 --> 00:52:12,569
hard to detect but if you look at its
beacon then you can detect a lot better

585
00:52:12,569 --> 00:52:15,729
and there's always weird protocols that
are out there that are you know people

586
00:52:15,729 --> 00:52:20,109
quit all kinds of strange particles of
malware is using today and we want to

587
00:52:20,109 --> 00:52:22,859
make sure that we continue to take that
and that's why the speaking and also

588
00:52:22,859 --> 00:52:26,979
because it doesn't care if it's
beginning over DNS it doesn't care if

589
00:52:26,979 --> 00:52:29,979
it's after he doesn't care its HDB it
doesn't care

590
00:52:29,979 --> 00:52:33,079
the only thing it knows there's an
internal connection there's an external

591
00:52:33,079 --> 00:52:36,159
connection and that connection happens
at some interval that's what we're

592
00:52:36,159 --> 00:52:47,020
looking at great question

593
00:52:47,020 --> 00:52:53,280
with this work if your I think you said
proximal traffic in the DNS does not go

594
00:52:53,280 --> 00:52:59,510
outside the just for clarification you
still got an internal DNS structure

595
00:52:59,510 --> 00:53:04,150
though because look upset to be done
right so yeah I mean it's gonna work

596
00:53:04,150 --> 00:53:07,670
because the lookups are still going to
be done against the internal structure

597
00:53:07,670 --> 00:53:12,310
is one of the one of the challenges we
did encounter leon is to make sure some

598
00:53:12,310 --> 00:53:19,040
of our customers give us the right DNS
data like if they give us your typical

599
00:53:19,040 --> 00:53:23,180
customer that security-conscious you can
write honestly right if you're running a

600
00:53:23,180 --> 00:53:27,850
split DNS and you're looking at the data
that's going from your external DNS out

601
00:53:27,850 --> 00:53:34,140
to the names of the other day we want we
want the internal client facing DNS data

602
00:53:34,140 --> 00:53:36,760
because that's the one that's gonna give
us that the strip distribution across

603
00:53:36,760 --> 00:53:47,180
all of the station's coming out it right
but it's all coming back as long as we

604
00:53:47,180 --> 00:53:50,180
can look at the demands we can do demand
analysis as well as citizens a look at

605
00:53:50,180 --> 00:53:53,860
the demands as well but it was kind of
funny no job is talking about working

606
00:53:53,860 --> 00:53:56,760
with customers as number of customers
that we have to give this presentation

607
00:53:56,760 --> 00:54:01,900
at ions forms and other places and
customers like we want that looks

608
00:54:01,900 --> 00:54:07,160
awesome like trade what we need are your
your connection blocks from her former

609
00:54:07,160 --> 00:54:12,040
fire water and router and we need your
DNS logs when your web proxy logs we

610
00:54:12,040 --> 00:54:14,380
don't have any

611
00:54:14,380 --> 00:54:22,650
ok so we need those but we want to tool
but Stolz not work without the logs but

612
00:54:22,650 --> 00:54:27,850
it looks cool so in those situations
just a GUI just prints out you've been

613
00:54:27,850 --> 00:54:32,720
hacked over I saw a hand up your last
question and I think we gotta wrap it up

614
00:54:32,720 --> 00:55:03,140
but our booth is right outside and yes
sir so so we're getting all these

615
00:55:03,140 --> 00:55:06,930
questions about reared logging
infrastructures as long as you can log

616
00:55:06,930 --> 00:55:10,070
internal external connections long as
you can log the demands that are being

617
00:55:10,070 --> 00:55:14,560
resolved you can use log stash to get it
into the proper format and I don't know

618
00:55:14,560 --> 00:55:18,190
where lawrence's right now but looks
like he's crying cuz he spends most of

619
00:55:18,190 --> 00:55:22,410
his time where customers give a strange
log formats like what you're talking

620
00:55:22,410 --> 00:55:26,240
about and they say it well we need to
injustice and he spends a tremendous

621
00:55:26,240 --> 00:55:30,390
amount of time writing said knock
scripts to get into the format that we

622
00:55:30,390 --> 00:55:31,830
need to make it work

623
00:55:31,830 --> 00:55:35,560
the point as long as we can capture that
time stamp we can capture the internal

624
00:55:35,560 --> 00:55:39,420
to external connection as long as we can
capture the demand and yes we can parse

625
00:55:39,420 --> 00:55:43,320
it can process but we need to get it
into the proper format so if you don't

626
00:55:43,320 --> 00:55:46,650
collect those things this stuff isn't
going to help you because we need timing

627
00:55:46,650 --> 00:55:51,220
and we need to know who's talking from
who what and to be honest all of us

628
00:55:51,220 --> 00:55:56,800
should have that in computer security so
so ok so I'm gonna wrap this up real

629
00:55:56,800 --> 00:56:00,070
quick 'cause were aware of her time so
we're gonna be up here is it ok if we

630
00:56:00,070 --> 00:56:03,420
hangout answer questions for a little
while I know its launch alright serving

631
00:56:03,420 --> 00:56:07,410
hang out we're gonna answer questions we
have free shirts out there for everybody

632
00:56:07,410 --> 00:56:12,860
and they got popeye preview yet it's got
Popeye the Sailor man without his head

633
00:56:12,860 --> 00:56:15,430
because I would be copyright violation
if we had his head

634
00:56:15,430 --> 00:56:19,540
and he's got the Linux pork banh
tattooed on his arm and it says I am

635
00:56:19,540 --> 00:56:23,589
what I am cause I RTFM so thank you so
much for coming everybody get out of

636
00:56:23,589 --> 00:56:23,660
here

