1
00:00:00,000 --> 00:00:15,299
everybody thank you for waking up I'm
glad that I'm here

2
00:00:15,299 --> 00:00:20,510
surprised that any of you are I'm
Richard Bartel hired for Palo Alto

3
00:00:20,510 --> 00:00:23,010
Networks and we'll talk a little bit
about power today

4
00:00:23,010 --> 00:00:28,750
abt is all that fun stuff just to give
you heads up I have exactly a hundred

5
00:00:28,750 --> 00:00:32,450
slides to get through in 25 minutes
let's do this

6
00:00:32,450 --> 00:00:37,760
all right we're going to talk about who
I am will talk about AZT is a little bit

7
00:00:37,760 --> 00:00:42,079
I'm gonna tell a story because stories
are fun and then we'll talk a little bit

8
00:00:42,079 --> 00:00:45,809
about baby Jesus do a really good job
and then we'll talk about how they could

9
00:00:45,809 --> 00:00:51,730
do better and then a little bit so
you're wondering what your child is this

10
00:00:51,730 --> 00:00:58,160
is a weird how the person your airfare
Palo Alto Networks and when I asked my

11
00:00:58,160 --> 00:01:07,260
friends to draw me this is what happens
so ABT's what r ABT's the internet just

12
00:01:07,260 --> 00:01:10,799
absolutely loves us and it's exploded in
the media lately and it's kind of

13
00:01:10,799 --> 00:01:16,930
horrible so according to the Internet
this is what an apt is ABC's are ninjas

14
00:01:16,930 --> 00:01:22,280
in the in the bites in their reading all
the credit card data so it really

15
00:01:22,280 --> 00:01:29,130
happened here is and sorry if you google
image search abt this does come up so we

16
00:01:29,130 --> 00:01:32,560
really happened here is somebody road
projects that looks something like this

17
00:01:32,560 --> 00:01:33,299
for looking

18
00:01:33,299 --> 00:01:38,119
track one interactive data out of memory
that's the main thing that happened and

19
00:01:38,119 --> 00:01:43,540
then oh my god the internets like these
hackers are like ninjas writing T Rex's

20
00:01:43,540 --> 00:01:48,020
flying through the Gibson reading all
the Matrix code so that they can create

21
00:01:48,020 --> 00:01:53,640
terminators and take over the world was
basically the crux of what how bad

22
00:01:53,640 --> 00:01:58,020
everybody made this crap sound and
that's not really what's going on what's

23
00:01:58,020 --> 00:02:01,850
really going on here is this is much
more with an apt probably looks like

24
00:02:01,850 --> 00:02:06,520
however ABT's are all over the place
like they're they're different they're

25
00:02:06,520 --> 00:02:10,780
different motivations different skill
levels so you know some EP teaser like

26
00:02:10,780 --> 00:02:12,300
striptease that are just use

27
00:02:12,300 --> 00:02:16,450
in scripts that they're finding on some
of them are writing packed kernel

28
00:02:16,450 --> 00:02:19,650
drivers so there's different skill
levels there's a different motivation

29
00:02:19,650 --> 00:02:26,180
summer after intellectual property some
are just doing reconnaissance summer

30
00:02:26,180 --> 00:02:31,040
doing are entirely financial base are
doing PCI stuff so they're just it's

31
00:02:31,040 --> 00:02:34,220
just important to know that there's
different levels and when somebody says

32
00:02:34,220 --> 00:02:38,830
abt they mean a helluva lot of different
things most of the time it's important

33
00:02:38,830 --> 00:02:43,290
to know that sometimes abt looks like
this and sometimes abt looks like this

34
00:02:43,290 --> 00:02:50,100
and also apparently sometimes abt now
looks like this makes no sense to me so

35
00:02:50,100 --> 00:02:54,240
rather than it being apt maybe we should
start calling it

36
00:02:54,240 --> 00:03:00,240
PTA like these are persistent threat
actors advanced is subject so with that

37
00:03:00,240 --> 00:03:06,840
let me tell a story this is Fran Fran
works for the apt is she writes now

38
00:03:06,840 --> 00:03:10,820
we're and she is you know God the same
problems at all of us like she's got a

39
00:03:10,820 --> 00:03:15,840
mortgage in a family she worries about
she's just a dead doing her thing this

40
00:03:15,840 --> 00:03:21,440
is Barbara Barbara sir and IR company
and reverse engineered malware for

41
00:03:21,440 --> 00:03:26,950
leaving so that's what she does and shes
exact same you know she's doing job and

42
00:03:26,950 --> 00:03:35,870
this is Taylor

43
00:03:35,870 --> 00:03:50,209
killing over last through early Taylor's
friends boss and you know sometimes

44
00:03:50,209 --> 00:03:53,560
sailors kind of addictive friend comes
down on a really hard trying to get her

45
00:03:53,560 --> 00:04:01,330
to do so so one day frank it's a call
from Taylor's like hey

46
00:04:01,330 --> 00:04:06,700
we got attacked this construction
company and get in there we need to back

47
00:04:06,700 --> 00:04:12,790
to all the things and steal their IP and
translate ok I think about this work

48
00:04:12,790 --> 00:04:16,209
through it and you know she's also
thinking about her kids and putting food

49
00:04:16,209 --> 00:04:22,490
on the table you know her marriage and
making sure everything is good there and

50
00:04:22,490 --> 00:04:28,120
like that dream boat that she wants oh
that's right so she works really hard

51
00:04:28,120 --> 00:04:36,450
and things about this she's like I'm
gonna use twice she says she starts

52
00:04:36,450 --> 00:04:39,230
working really hard I'm not going
through and it slides by the way you

53
00:04:39,230 --> 00:04:45,600
keep his servants working really hard
and she's like I'm gonna use public

54
00:04:45,600 --> 00:04:49,560
tools like I don't even have to do
anything I can just using public stuff

55
00:04:49,560 --> 00:04:53,050
she hears about this cool thing called
poison ivy and she's like I'm just going

56
00:04:53,050 --> 00:04:56,680
to take this I'm gonna make a PDF

57
00:04:56,680 --> 00:05:01,970
great show this show Conan as PDF and
we'll just shoot it out everywhere and

58
00:05:01,970 --> 00:05:06,720
it's gonna be awesome and so she like a
couple hours of hurricanes like we're

59
00:05:06,720 --> 00:05:07,710
done

60
00:05:07,710 --> 00:05:12,000
killed it views it out to the internet
and gets it over to where it's supposed

61
00:05:12,000 --> 00:05:19,360
to be however that construction company
gets a notification something's not

62
00:05:19,360 --> 00:05:24,350
quite right here from like the FBI or
something happens and the construction

63
00:05:24,350 --> 00:05:28,360
company hires parts company and then
bart gets this piece of malware as I hey

64
00:05:28,360 --> 00:05:36,440
as PDF doesn't look quite right because
yeah not quite right and I that's not an

65
00:05:36,440 --> 00:05:42,810
exaggeration this is as bad as they are
sometimes so far like ok cool I'm gonna

66
00:05:42,810 --> 00:05:46,320
go and look into this you start digging
into it she wakes up and has a morning

67
00:05:46,320 --> 00:05:52,990
coffee just like ok time to look into
this matter so far starts work in she's

68
00:05:52,990 --> 00:05:53,860
like i right

69
00:05:53,860 --> 00:05:59,099
I got this I get those who runs it seems
like that's a mutex a recognized Oh I

70
00:05:59,099 --> 00:06:04,330
see this traffic it's like 256 bytes of
encrypted traffic for every pay this

71
00:06:04,330 --> 00:06:08,490
looks really familiar like I've seen
this before this poison ivy league ok I

72
00:06:08,490 --> 00:06:09,740
figure this out

73
00:06:09,740 --> 00:06:14,050
done within seconds because this is
public tools that she seen before

74
00:06:14,050 --> 00:06:18,879
cool rates and I'll see you in a
terrible program like this

75
00:06:18,879 --> 00:06:22,979
spits it out there does the splits and
was like yes killed it did my job today

76
00:06:22,979 --> 00:06:32,610
however is now they're out leg they
found everything knocked him out again

77
00:06:32,610 --> 00:06:39,240
so Taylor comes down on Franz Franz
freely of settling I'm sorry but she's I

78
00:06:39,240 --> 00:06:43,710
can I got this I might try harder this
time to write my own mouth we're gonna

79
00:06:43,710 --> 00:06:50,430
kill it it's gonna be great I'm gonna do
this so gets back to get back to Barb

80
00:06:50,430 --> 00:06:55,300
basically they spit it out there are
power is out there again and the

81
00:06:55,300 --> 00:06:59,889
construction company hire get some hour
to barb she starts looking at it she

82
00:06:59,889 --> 00:07:03,500
runs it you know why not let's see what
it does when you're on it and she sees

83
00:07:03,500 --> 00:07:10,099
this the malware has usage that's great
that you just told me what your mouth

84
00:07:10,099 --> 00:07:16,360
where it does thats awesome so that was
great brands like using our site buyer

85
00:07:16,360 --> 00:07:23,409
and she does her same thing rights and
IOC they do some stuff knock him out and

86
00:07:23,409 --> 00:07:28,110
his best friend is worried about a job

87
00:07:28,110 --> 00:07:33,779
kids all of these things but she's like
ok this AM rates and better malware I

88
00:07:33,779 --> 00:07:39,839
think I know what went wrong maybe that
was a bad idea so she gets their power

89
00:07:39,839 --> 00:07:48,949
gets back to bar she starts working on
it and this is what she sees this time

90
00:07:48,949 --> 00:07:54,650
the malware drops a text file that's
full of debugging information about

91
00:07:54,650 --> 00:07:58,500
everything it's doing so doesn't have
usage but when you run it still goes

92
00:07:58,500 --> 00:08:01,420
through and tells you everything that
it's doing as it does it

93
00:08:01,420 --> 00:08:07,500
fran has left all over debugging strings
that they're not so smart bar says laws

94
00:08:07,500 --> 00:08:12,780
again she also see something else really
hilarious so inside here this now is

95
00:08:12,780 --> 00:08:14,070
communicating with it

96
00:08:14,070 --> 00:08:21,820
command-and-control server and she sees
the communication gets its encrypted and

97
00:08:21,820 --> 00:08:27,990
then it gets compressed does anybody see
a problem with this so when you take

98
00:08:27,990 --> 00:08:33,020
something and you encrypt it the entropy
goes through the roof because the bites

99
00:08:33,020 --> 00:08:37,110
are already buys and then when you can
press a compression is based on patterns

100
00:08:37,110 --> 00:08:40,550
like that's how you can make impress
items so you can press it and nothing

101
00:08:40,550 --> 00:08:43,810
happens it's not gonna get smaller bag
compression algorithms will make it

102
00:08:43,810 --> 00:08:48,470
bigger if you do this pretty awesome
bars like this is awesome a little areas

103
00:08:48,470 --> 00:09:02,420
she and her co-workers go out for some
drinks story yes I I did buy three

104
00:09:02,420 --> 00:09:10,330
barbies for this stock my girlfriend
found me on the floor of my office

105
00:09:10,330 --> 00:09:14,260
playing with Barbies one day and
giggling and she thought I'd gone insane

106
00:09:14,260 --> 00:09:19,130
he was pretty sure taylor's really mad
again

107
00:09:19,130 --> 00:09:26,470
brands like super scared but she she
works are in my car and I know what went

108
00:09:26,470 --> 00:09:31,560
wrong and it's dumb things I can do
better so our gets back to bar all those

109
00:09:31,560 --> 00:09:34,740
debugging strings are gone and bars like
our site

110
00:09:34,740 --> 00:09:39,740
barbara's like more interesting I might
actually have to do some reversing work

111
00:09:39,740 --> 00:09:45,850
then she actually looks into the binder
inserts oversee it and she sees this the

112
00:09:45,850 --> 00:09:50,310
printer function doesn't do anything so
this is like it's a she sees a function

113
00:09:50,310 --> 00:09:54,700
having a strong push to it but that
function doesn't do anything however

114
00:09:54,700 --> 00:09:59,920
basically like fran has marked up the
whole binary for her so I don't need to

115
00:09:59,920 --> 00:10:04,030
do any work in the IDB because it's all
marked up there's these debugging

116
00:10:04,030 --> 00:10:06,990
strings right around all the cool
interesting things

117
00:10:06,990 --> 00:10:12,100
nice it's like commented code but it's a
minor pretty hilarious barr says low

118
00:10:12,100 --> 00:10:13,290
again this is great

119
00:10:13,290 --> 00:10:18,620
her bosses like you're killin it
barbosa's awesome well done she goes out

120
00:10:18,620 --> 00:10:24,060
for a beer you know she's having good
times however Taylor is not exactly

121
00:10:24,060 --> 00:10:29,459
happy so you know fran has ran its care
about all the things that are going on

122
00:10:29,459 --> 00:10:34,060
its way from what's going on and how
she's not doing that well at a job right

123
00:10:34,060 --> 00:10:39,120
now but she thinks about things like ok
I got this I got some cool ideas I can

124
00:10:39,120 --> 00:10:43,149
do this right something that she's
really proud of it gets to Barb and

125
00:10:43,149 --> 00:10:50,959
she's working today and Barb looks looks
at it and says okay this is more

126
00:10:50,959 --> 00:10:54,649
interesting this is harder it's not as
nerdy billion strings is nothing like

127
00:10:54,649 --> 00:10:59,149
super easy about this however then she
goes and she sees the network traffic

128
00:10:59,149 --> 00:11:04,060
that this is creating and looks like
this now this may look very simple and

129
00:11:04,060 --> 00:11:10,440
nothing's wrong however that is wrong
there's a space missing because fran has

130
00:11:10,440 --> 00:11:16,279
not copy pasta all that well because
there's that space missing image that's

131
00:11:16,279 --> 00:11:21,839
a semicolon you can write a network
traffic firefighters traffic is never

132
00:11:21,839 --> 00:11:24,360
gonna look like that that space should
be there

133
00:11:24,360 --> 00:11:28,850
you write a network saying and suddenly
catch it every time taylor's pissed

134
00:11:28,850 --> 00:11:36,130
again like do better and she scared but
she thinks about things and she's she's

135
00:11:36,130 --> 00:11:40,000
like I can I come back and work through
this she finally write some some damn

136
00:11:40,000 --> 00:11:44,550
cold shower so what she does to fix this
is she actually searches through the

137
00:11:44,550 --> 00:11:50,410
Windows registry and says okay what
version of a web browser is running she

138
00:11:50,410 --> 00:11:54,630
checks her that she finds that
information and then she has all of the

139
00:11:54,630 --> 00:11:58,709
user agent strings for all of those in
the Chi and Jackson of that she watches

140
00:11:58,709 --> 00:12:03,260
a browser injects into it and mimics the
traffic mimics user agent needs does it

141
00:12:03,260 --> 00:12:04,110
that way

142
00:12:04,110 --> 00:12:10,149
pretty smart and does a really good job
so now we have very very good way of

143
00:12:10,149 --> 00:12:14,720
hiding so Franzese although that's
pretty cool like can never say that

144
00:12:14,720 --> 00:12:17,300
looks really good

145
00:12:17,300 --> 00:12:21,709
to see some other dumb things that may
make it really easy to find so the

146
00:12:21,709 --> 00:12:24,990
command-and-control structure here
there's always a command looping back to

147
00:12:24,990 --> 00:12:30,740
her and she goes and she starts looking
through and she sees this if ran ever

148
00:12:30,740 --> 00:12:34,370
tries to change the configuration for
this now we're which like there's an

149
00:12:34,370 --> 00:12:37,940
option for you know when she's
communicating with it

150
00:12:37,940 --> 00:12:40,980
you change the configuration like use a
different command-and-control server

151
00:12:40,980 --> 00:12:45,660
yeah it's broken it's absolutely broken
and will crash them our if she tries to

152
00:12:45,660 --> 00:12:50,170
do it so that makes Bardwell then she
looks a little closer she sees something

153
00:12:50,170 --> 00:12:56,970
even better does anybody know the first
rule of crypto do not roll your own

154
00:12:56,970 --> 00:13:01,730
thank you very much and this there's
been a great example of this and I'll go

155
00:13:01,730 --> 00:13:05,860
over in a second but you don't roll your
own damn crypto just trust me the people

156
00:13:05,860 --> 00:13:10,760
that wrote the crypto algorithms that
you can use publicly are probably better

157
00:13:10,760 --> 00:13:17,310
at it than you are just true so this
makes everybody low and then it gets

158
00:13:17,310 --> 00:13:24,930
even worse so in France now where she
goes through and she's like oh she's

159
00:13:24,930 --> 00:13:30,070
going to actually look through all the
open file handles on the system and find

160
00:13:30,070 --> 00:13:33,720
the one for her mouth her because she
knows the size of it and she checks the

161
00:13:33,720 --> 00:13:38,839
size of it to see where it is so she
tries to find it go and get to the end

162
00:13:38,839 --> 00:13:43,790
of that power so she just seeks to the
end of that power and there's data

163
00:13:43,790 --> 00:13:48,630
that's not being loaded as part of the P
that's actually just in the raw file on

164
00:13:48,630 --> 00:13:54,360
disk however she does this and she has
like the encoded c2 information at the

165
00:13:54,360 --> 00:13:58,420
end of the file she does is based on a
certain file size for a certain domain

166
00:13:58,420 --> 00:14:04,480
that she did protesting called evil dot
com but then when they deploy she

167
00:14:04,480 --> 00:14:11,600
changes it to you about calm and she
doesn't change her file size and her

168
00:14:11,600 --> 00:14:13,939
backdoor never fires

169
00:14:13,939 --> 00:14:19,869
and now barbs are just like this is
amazing

170
00:14:19,869 --> 00:14:25,479
Taylor is super have said this is not
going well and friends like this is

171
00:14:25,479 --> 00:14:30,459
terrible she loses her job she estimates
and then barb goes out and has a party

172
00:14:30,459 --> 00:14:39,589
with their stress I don't have an
elegant and for the stories so this is

173
00:14:39,589 --> 00:14:44,559
obviously I get exaggerated stories like
this is that however every single one of

174
00:14:44,559 --> 00:14:47,399
those pieces of malware I was talking
about that stuff I've seen in awhile but

175
00:14:47,399 --> 00:14:49,939
that's all realistic things that happen

176
00:14:49,939 --> 00:14:54,549
these are dads out there that are making
silly mistakes just like the rest of us

177
00:14:54,549 --> 00:14:59,709
they're not crazy ninja some of them are
so let's talk about some of the cool

178
00:14:59,709 --> 00:15:03,549
power that's out there some of the
clever things that have been done so one

179
00:15:03,549 --> 00:15:08,959
of the first ones I like to talk about
is what I saw where the malware actually

180
00:15:08,959 --> 00:15:14,569
implemented an entire shell inside of
itself so rather than just you creating

181
00:15:14,569 --> 00:15:19,470
a reverse shell out 200 lines of code
they implemented all the functionality

182
00:15:19,470 --> 00:15:23,299
of a shell internally to it so the back
door with commands that were all of the

183
00:15:23,299 --> 00:15:28,409
commands for like a whole show including
things like that cat ipconfig and other

184
00:15:28,409 --> 00:15:32,659
things that are you know not default in
a shell so kind of cool really

185
00:15:32,659 --> 00:15:36,859
interesting a lot of work for what you
can do with the reversal but I'm still

186
00:15:36,859 --> 00:15:38,579
pretty cool

187
00:15:38,579 --> 00:15:42,309
another one we saw that actually the
person and analyze this is sitting right

188
00:15:42,309 --> 00:15:47,629
there his name from a career he's a
smart man he he saw some hour where he

189
00:15:47,629 --> 00:15:54,059
it was a third it was an executable
where as it executed it checks if it was

190
00:15:54,059 --> 00:15:58,889
running on 32 bit or 64 bit architecture
and it had two different shellcode

191
00:15:58,889 --> 00:16:02,559
payloads and would run one or the other
based on which architecture was what

192
00:16:02,559 --> 00:16:08,189
running so that was also one of my
favorites that I saw was a really tiny

193
00:16:08,189 --> 00:16:12,579
binary well it was it was a large
minority full of red herring coder like

194
00:16:12,579 --> 00:16:17,410
code that didn't do anything to it was
just there to distract you so that it

195
00:16:17,410 --> 00:16:21,119
would just execute all that stuff and
slowly build the tiny shellcode buffer

196
00:16:21,119 --> 00:16:25,819
and that shellcode buffer was just a
download and execute program whose sole

197
00:16:25,819 --> 00:16:31,179
focus was to downloads one module
executed and that that would then

198
00:16:31,179 --> 00:16:35,850
download and execute more module so a
very tiny very modular and that it's

199
00:16:35,850 --> 00:16:39,389
tough to analyze because unless I get
those modules I can't see it I don't

200
00:16:39,389 --> 00:16:45,689
know what it's so so pretty cool then I
recently saw some stuff that was pretty

201
00:16:45,689 --> 00:16:50,980
awesome where I say I saw it I'm almost
positive I can't prove this but this is

202
00:16:50,980 --> 00:16:55,980
what I like to do when I'm writing
obvious Gators and things is I saw what

203
00:16:55,980 --> 00:16:59,399
looked like somebody was writing code
that wrote code for them so they were

204
00:16:59,399 --> 00:17:03,939
programatically generating things so
that rather than having a hand create

205
00:17:03,939 --> 00:17:09,809
them they were making a program to do it
for them so you started really what I

206
00:17:09,809 --> 00:17:13,730
saw was I started hurting a sample and
the encoding was definitely custom it

207
00:17:13,730 --> 00:17:17,889
wasn't something new but it was more
complicated than any sane human would

208
00:17:17,889 --> 00:17:22,959
probably put together so this was one of
the multiple encoding loops that were

209
00:17:22,959 --> 00:17:24,309
involved in it

210
00:17:24,309 --> 00:17:29,159
however it wasn't any mainstream
encoding it was just a bunch of

211
00:17:29,159 --> 00:17:34,370
different binary operations that they
that looked very much programmatic and

212
00:17:34,370 --> 00:17:38,039
random which is pretty cool a guy hadn't
seen somebody doing this before so it

213
00:17:38,039 --> 00:17:42,460
was kind of cool to see that makes it a
pain to reverse and then in that same

214
00:17:42,460 --> 00:17:46,280
sample they had written something that
was a command lou that

215
00:17:46,280 --> 00:17:49,870
it was really difficult to get this
sample to be canceled you start digging

216
00:17:49,870 --> 00:17:53,540
in their final command loop but if
you're running us can't get it to be

217
00:17:53,540 --> 00:17:58,110
what was happening was the power
actually had another programmatically

218
00:17:58,110 --> 00:18:01,730
generated function that had all kinds of
sleeps in weights and different things

219
00:18:01,730 --> 00:18:06,300
that were all based on a state machine
and it that state machine would say okay

220
00:18:06,300 --> 00:18:11,460
based on the state I'm in a move to the
next eight and it would randomly go to

221
00:18:11,460 --> 00:18:15,750
one of these states and eventually it
would get down to the state of executing

222
00:18:15,750 --> 00:18:19,720
the loop however most of the time it's
just gonna go and create threads and

223
00:18:19,720 --> 00:18:23,410
wait for them to finish or call sleep or
do some math

224
00:18:23,410 --> 00:18:28,260
it was really cool because it would
execute and if you ran it it's not gonna

225
00:18:28,260 --> 00:18:31,770
do anything most of the time just going
to sit there and wait and then

226
00:18:31,770 --> 00:18:36,610
eventually just by the power of math was
going to execute its command so pretty

227
00:18:36,610 --> 00:18:38,260
cool hadn't seen that before

228
00:18:38,260 --> 00:18:42,620
there's actually a blog posts erupted
that I did about this is a backdoor

229
00:18:42,620 --> 00:18:46,220
family called purple that actually has
like evolving protections which was

230
00:18:46,220 --> 00:18:51,930
skeptical of my favorite one to talk
about is one that we saw in an

231
00:18:51,930 --> 00:18:58,590
investigation where there was an evil
service and that service was pointing to

232
00:18:58,590 --> 00:19:06,310
a packed kernel driver so that the pact
kernel driver would launch unpack itself

233
00:19:06,310 --> 00:19:11,910
and then inject into user lantos so it
would do that and have all of these

234
00:19:11,910 --> 00:19:18,080
Melissa and malicious processes and it's
things like explore and CSR assess that

235
00:19:18,080 --> 00:19:21,720
are all of these malicious user easily
and processes and then do it on purpose

236
00:19:21,720 --> 00:19:27,480
crash and it would go away so all you
had was your usual and processes were

237
00:19:27,480 --> 00:19:28,790
infected in its like you

238
00:19:28,790 --> 00:19:33,930
there's not anything running that you
didn't put in there and the kernel

239
00:19:33,930 --> 00:19:38,220
drivers not even there anymore so kind
of awesome really cool to see however

240
00:19:38,220 --> 00:19:44,740
there were some ridiculous silliness to
this this is an external driver but they

241
00:19:44,740 --> 00:19:46,230
didn't figure out a way to sign it

242
00:19:46,230 --> 00:19:52,800
most kernel drivers are signs like it's
usually it's a glaring red flag flag on

243
00:19:52,800 --> 00:20:00,020
top of that it is unsigned the file name
was a random character string like you

244
00:20:00,020 --> 00:20:05,660
also usually don't see that the service
was service name was a random characters

245
00:20:05,660 --> 00:20:12,150
and then the description was Microsoft
the random character string support that

246
00:20:12,150 --> 00:20:18,880
Microsoft signs their shit that's just
silly so that was what was going through

247
00:20:18,880 --> 00:20:24,760
my brain when we saw this and then even
better their end goal was to wrap a

248
00:20:24,760 --> 00:20:31,480
a.net string copy function that was all
they were after this was a PC I think so

249
00:20:31,480 --> 00:20:35,460
they were just trying to wrap a.net
string copy function so they're trying

250
00:20:35,460 --> 00:20:42,230
to rapid dotnet binary you can decompile
dotnet really easily it's almost a you

251
00:20:42,230 --> 00:20:46,250
know there's skaters out there but most
of the time D compiling and recompiling

252
00:20:46,250 --> 00:20:52,340
it pretty easy to do so you can
decompile that and recompile it and it's

253
00:20:52,340 --> 00:20:56,930
changed a little bit on disk or you have
an unsigned Pat kernel driver called

254
00:20:56,930 --> 00:21:01,920
Microsoft random character named support
yet just a little ridiculous this is

255
00:21:01,920 --> 00:21:06,180
when we really get these might be
dockside

256
00:21:06,180 --> 00:21:12,470
finally the last thing I want to talk
about his ways to do this better so you

257
00:21:12,470 --> 00:21:18,470
know there's a lot of ways to protect
your code engineering there's an tre

258
00:21:18,470 --> 00:21:22,320
techniques in this way so just have
better practices for like when you're

259
00:21:22,320 --> 00:21:25,670
writing things so if you're in a red
team in your writing malware because you

260
00:21:25,670 --> 00:21:30,110
need and you want to make it difficult
difficult for your blue team or just a

261
00:21:30,110 --> 00:21:32,360
troll them might have fun with it so

262
00:21:32,360 --> 00:21:36,530
the first one is just use if tests like
if you're reading this and see if you're

263
00:21:36,530 --> 00:21:40,030
going to use debugging strings just
happened in its death and then when you

264
00:21:40,030 --> 00:21:44,910
deploy it exchanging one thing and all
of them go away so used pre compiler

265
00:21:44,910 --> 00:21:50,890
stuff but it's a great option and also
you know there's even more clever ways

266
00:21:50,890 --> 00:21:55,770
to do is like print FAQ siege mess with
me a little bit like there you can use

267
00:21:55,770 --> 00:22:00,770
the usage from paying and this might be
paying like I might I might make a

268
00:22:00,770 --> 00:22:05,679
mistake on that like so you know mess
around with that kind of stuff even

269
00:22:05,679 --> 00:22:11,500
better is interesting debugging strings
that makes absolutely no sense like

270
00:22:11,500 --> 00:22:17,650
starting a drone collider like whatever
next check all of your strings and

271
00:22:17,650 --> 00:22:21,750
you're mine airy ripping strings out is
really easy if I see it we're user-agent

272
00:22:21,750 --> 00:22:27,130
it's really easy to network sick if I
see super awesome backdoor oh my god as

273
00:22:27,130 --> 00:22:31,429
like your project path because you wrote
this in Visual Studio and it shows that

274
00:22:31,429 --> 00:22:38,040
in there it's bad you're telling me
things stop doing that next exit is

275
00:22:38,040 --> 00:22:44,750
everybody understand how to mathematics
or works so X soaring is great it's an

276
00:22:44,750 --> 00:22:48,860
invertible mathematical function this is
like simple explanation of what happens

277
00:22:48,860 --> 00:22:53,179
when you accelerate things however it
doesn't protect you it's actually pretty

278
00:22:53,179 --> 00:22:58,490
ineffective in terms of hiding
contextual data a lot of times so I have

279
00:22:58,490 --> 00:23:03,480
a very great proof of concept of this if
you take a threat but and you exaggerate

280
00:23:03,480 --> 00:23:10,220
with yo threat it still looks like a
threat but it doesn't protect you that

281
00:23:10,220 --> 00:23:14,260
well it's pretty obvious you get when
you access or things you leave data

282
00:23:14,260 --> 00:23:19,059
because you're you're not changing its
not it doesn't raise entropy lot of the

283
00:23:19,059 --> 00:23:23,130
times were it all depends on like the
data that you're dealing with you have a

284
00:23:23,130 --> 00:23:28,460
lot of 0 bytes and using an hour and
often you're showing me exactly what the

285
00:23:28,460 --> 00:23:33,220
key is so just know that

286
00:23:33,220 --> 00:23:37,590
and it's also really easy to use
mainstream crypto and stuff like that or

287
00:23:37,590 --> 00:23:41,820
create your own custom coding like I was
describing with that programmatic

288
00:23:41,820 --> 00:23:46,600
generation you can create something that
makes it an invertible function and that

289
00:23:46,600 --> 00:23:51,169
that is really not that hard to do you
just have to do some math and then it's

290
00:23:51,169 --> 00:23:54,580
more difficult to reverse and more
difficult to get your data that you want

291
00:23:54,580 --> 00:24:00,150
to protect don't reinvent the wheel like
the mighty nvm protector terrifying

292
00:24:00,150 --> 00:24:04,630
Packers don't write your own you
probably do a worse job than most people

293
00:24:04,630 --> 00:24:08,860
than some of the really good ones out
there and legacy news mainstream crypto

294
00:24:08,860 --> 00:24:16,049
also choose a programming language
that's interesting leg C&C sharp are bad

295
00:24:16,049 --> 00:24:20,770
choices most of the time because they
Decompiler easily a lot of work that's

296
00:24:20,770 --> 00:24:25,240
been out there that's been done out
there to get them to disassemble

297
00:24:25,240 --> 00:24:30,929
decompile very very easily so use things
like Delphine delphi is as old outdated

298
00:24:30,929 --> 00:24:37,159
languages terrifying an ugly to reverse
it was just a horrible compiler yeah

299
00:24:37,159 --> 00:24:41,850
it's a pain C++ it with a lot of object
oriented in function pointer pass and

300
00:24:41,850 --> 00:24:46,960
does makes it really annoying rivers
also go lang is knowing her it's like

301
00:24:46,960 --> 00:24:53,659
playing around with that I'm also told
that rust as a real pains next Haider

302
00:24:53,659 --> 00:24:59,059
communication like it was saying like if
you have very obvious networks rings

303
00:24:59,059 --> 00:25:03,770
it's bad so hot like when you're sending
back data to your seat to hide it a

304
00:25:03,770 --> 00:25:09,720
little bit and I mean you can also use
things like public jobs like use Twitter

305
00:25:09,720 --> 00:25:14,380
in and WordPress and Facebook and
LinkedIn AP I like you have fun with

306
00:25:14,380 --> 00:25:20,390
that and it makes it interesting to work
with and also in last just be a little

307
00:25:20,390 --> 00:25:25,090
more clever so you know switch between
different network communications troll a

308
00:25:25,090 --> 00:25:29,179
little bit like heightened very similar
code so that if you're using you know

309
00:25:29,179 --> 00:25:32,990
network communications hiding something
that also does network communications

310
00:25:32,990 --> 00:25:39,280
you know pretend to be something else
like you can do some cool stuff there or

311
00:25:39,280 --> 00:25:43,760
and then you can write modular power
like I was describing earlier if you if

312
00:25:43,760 --> 00:25:45,730
the power downloads pieces as

313
00:25:45,730 --> 00:25:49,710
need them it's much harder to reverse
unless I get all of the pieces I won't

314
00:25:49,710 --> 00:25:54,900
know everything that's going on so just
make modular things and download new

315
00:25:54,900 --> 00:25:58,930
functionality or write rootkit back to
his roots are much harder to write but

316
00:25:58,930 --> 00:26:04,250
much harder to reverse its a good way to
protect your stuff or write a bad back

317
00:26:04,250 --> 00:26:09,860
to our and you know propagate via sound
waves apparently that's a thing now and

318
00:26:09,860 --> 00:26:14,230
like I was also saying write code their
rights code it's actually fun right sum

319
00:26:14,230 --> 00:26:18,190
up the skaters it it's pretty
entertaining to do I'm a very big fan of

320
00:26:18,190 --> 00:26:23,700
writing pipe underwrite other things for
me and then finally just don't be this

321
00:26:23,700 --> 00:26:27,250
guy don't be lazy like think about what
you're trying to accomplish an

322
00:26:27,250 --> 00:26:31,380
accomplished it i mean we're often under
the gun a lot in terms of what we're

323
00:26:31,380 --> 00:26:35,280
doing but you can write good code if you
just thinking about what you're after

324
00:26:35,280 --> 00:26:45,020
so you just don't want to be this guy
and you may be asking you know all of

325
00:26:45,020 --> 00:26:49,510
this is the case and it's so tough to be
the apt who would want to do it and this

326
00:26:49,510 --> 00:26:58,390
is the only reason I can come up with
and without I'll take your questions

327
00:26:58,390 --> 00:27:05,070
also I have two newly printed t-shirts
that look like this if you are

328
00:27:05,070 --> 00:27:25,220
interested in them and first two
questions can have one

329
00:27:25,220 --> 00:27:32,640
thank God no but yeah I just saw that
talking I loved it I thought it was

330
00:27:32,640 --> 00:27:39,039
awesome I'm terrified of it it's
disgusting and yeah so he was asking

331
00:27:39,039 --> 00:27:43,500
about movie theater which is another guy
give a talk on where they made an

332
00:27:43,500 --> 00:27:48,570
obfuscator where it has takes the whole
instruction set and the move instruction

333
00:27:48,570 --> 00:27:52,780
is touring complete so it takes
everything and turns it into just moves

334
00:27:52,780 --> 00:27:58,250
there's not even at the end any non move
instructions so when you bring up an

335
00:27:58,250 --> 00:28:06,710
idea it's a line it's terrible i mean so
figure this out its 500,000 move

336
00:28:06,710 --> 00:28:14,620
instructions I i dont like in his
talkies leg when I would if I was

337
00:28:14,620 --> 00:28:17,460
arguing this I would see it as a No

338
00:28:17,460 --> 00:28:28,480
might drop on how ya terrifying so
awesome thank you

