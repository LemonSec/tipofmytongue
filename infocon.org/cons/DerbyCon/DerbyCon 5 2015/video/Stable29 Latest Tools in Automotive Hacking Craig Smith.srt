1
00:00:00,000 --> 00:00:07,620
Francisco be a tools demonstration
discussion but I have a new tool I'm

2
00:00:07,620 --> 00:00:12,780
gonna release instead today and that's
going to go over the concept of creating

3
00:00:12,780 --> 00:00:19,830
an auto auto brothel you know the places
unsavory people go to to get diseases

4
00:00:19,830 --> 00:00:25,630
that's we're gonna go over so over a
little bit hardware the beginning so

5
00:00:25,630 --> 00:00:30,929
when things are recommended as cheap can
bust ups but we're getting started at

6
00:00:30,929 --> 00:00:37,920
the top one is can't act that's by air
kevin is a sales last name its doubts

7
00:00:37,920 --> 00:00:44,100
that the box open source hardware or
just call was pretty well another one's

8
00:00:44,100 --> 00:00:52,210
kind of equipment 9042 can do you make
this better

9
00:00:52,210 --> 00:00:56,030
ok we'll have the tracks

10
00:00:56,030 --> 00:01:06,369
where'd ya chair so ok so we had a USB
can that's about 60 bucks concern

11
00:01:06,369 --> 00:01:11,710
anyways he is available for shipping I
like it a lot on Linux simply because it

12
00:01:11,710 --> 00:01:15,840
shows up as a trial can when you start
messing with these one seriously when

13
00:01:15,840 --> 00:01:21,630
can I prefer I can but they're about
equivalent when things were going to

14
00:01:21,630 --> 00:01:26,540
talk about his scandals is a big boat
dealership in normal ones this one's

15
00:01:26,540 --> 00:01:30,570
when you get from Mike Autozone or you
know arrived here in this kind of places

16
00:01:30,570 --> 00:01:36,210
ABC plugs into your car they tell you
what your engine lights on reporting but

17
00:01:36,210 --> 00:01:41,600
a DTC diagnostic trouble code and you
can clear that's pretty much what they

18
00:01:41,600 --> 00:01:42,740
do

19
00:01:42,740 --> 00:01:47,090
normal person has and they have a
dealership tall and he's a lot more

20
00:01:47,090 --> 00:01:54,530
expensive the last month's pay like $100
for these games 2000 but they go up from

21
00:01:54,530 --> 00:02:01,899
there and so this particular picture is
a tech to by Jim yeah and they all

22
00:02:01,899 --> 00:02:06,560
connections because they work on cars
more features the do a lot of stuff

23
00:02:06,560 --> 00:02:10,640
that's kinda own proprietary protocol

24
00:02:10,640 --> 00:02:16,250
so the generic protocol to get dynastic
stuff and there's an unpublished one and

25
00:02:16,250 --> 00:02:20,350
most dealerships use the non published
12 at their their cars to get things

26
00:02:20,350 --> 00:02:25,010
done numbers and that kind of stuff or
to work on actuators like in a row

27
00:02:25,010 --> 00:02:29,570
window down or a card or those kinds of
things he's also can be used for

28
00:02:29,570 --> 00:02:33,910
reprogramming some of the ECU engine
control units from where

29
00:02:33,910 --> 00:02:41,209
so they're nice and the nice tools I
guess to get your hands on you can also

30
00:02:41,209 --> 00:02:46,840
probably argue for software side we have
psychic and this is my preferred method

31
00:02:46,840 --> 00:02:53,630
Linux kernel have some tools there
that's the can packets up there so you

32
00:02:53,630 --> 00:02:58,570
can see him God you can see that all
right door but that's really really

33
00:02:58,570 --> 00:03:03,080
simple so can packets have an idea they
don't have a source or destination just

34
00:03:03,080 --> 00:03:04,459
a simple I D

35
00:03:04,459 --> 00:03:09,660
up to eight bytes for the data packet
the payload and that's pretty much so it

36
00:03:09,660 --> 00:03:12,980
becomes a look at them three persons not
too hard it's mainly just a matter of

37
00:03:12,980 --> 00:03:17,370
seeing them out of a noise of a bunch of
other packets going by your screen that

38
00:03:17,370 --> 00:03:17,989
kind of stuff

39
00:03:17,989 --> 00:03:24,519
the reason I can is because once I catch
and it it you let you use all your hard

40
00:03:24,519 --> 00:03:25,980
work the same tools

41
00:03:25,980 --> 00:03:28,890
countries like a network interface you
know so no matter which never occurred

42
00:03:28,890 --> 00:03:38,370
to have you in New Lenox wth 0 same here
this is can 00 but a break and then work

43
00:03:38,370 --> 00:03:45,380
no matter what hardware the person
pictured used so the way this neutral

44
00:03:45,380 --> 00:03:50,820
him about his kind of an extension of
the other two are icy some open source

45
00:03:50,820 --> 00:03:58,100
on github if you search for zombie Craig
and I see you find it it's basically

46
00:03:58,100 --> 00:04:03,600
pieces you have a instrument cluster the
top which has your speedometer turns

47
00:04:03,600 --> 00:04:06,430
saying nose and a picture for your door
locks

48
00:04:06,430 --> 00:04:09,769
there's another screen comes up that's
your controls the reason why looks like

49
00:04:09,769 --> 00:04:15,989
game controllers and game controllers
playstation xbox whatever the controls a

50
00:04:15,989 --> 00:04:19,030
pretty much the same as grand theft auto
and as you

51
00:04:19,030 --> 00:04:23,420
driver allan that it controls your
inspectors from the top and it does it

52
00:04:23,420 --> 00:04:27,150
but not not by using a programming
methods such as any for anything like

53
00:04:27,150 --> 00:04:32,440
that but doesn't by using can packets
just having a real car so the window you

54
00:04:32,440 --> 00:04:33,419
see on the left

55
00:04:33,419 --> 00:04:39,440
can't rap it's going by and so we can do
is you can practice your looking at can

56
00:04:39,440 --> 00:04:42,770
traffic identifying different things
like what controls the throttle what

57
00:04:42,770 --> 00:04:46,190
does door locks and then you can send
packets just like you would on a real

58
00:04:46,190 --> 00:04:50,760
car and see if it actually has an effect
doesn't unlock the car doors those kinds

59
00:04:50,760 --> 00:04:55,600
of things and there's a lot of
background traffic that comes from real

60
00:04:55,600 --> 00:05:01,940
car traffic should my car so that's
balanced so get used to looking at can

61
00:05:01,940 --> 00:05:08,140
do I can stop you can change the
difficulty levels so once again I kind

62
00:05:08,140 --> 00:05:09,000
of stuff

63
00:05:09,000 --> 00:05:13,680
one thing and doing training classes is
the certain tools that work against

64
00:05:13,680 --> 00:05:18,790
components such as engine control units
are body control modules those don't

65
00:05:18,790 --> 00:05:23,570
work of ICC it's mainly can traffic so I
want to make another tool that allows

66
00:05:23,570 --> 00:05:29,700
you to do queries for diagnostic trouble
codes and those kinds of things in a

67
00:05:29,700 --> 00:05:34,440
virtualized environment and ICIC
simulation your car to do it so I create

68
00:05:34,440 --> 00:05:40,250
the Cinco de UDS server so also free get
upset because they can't read it but

69
00:05:40,250 --> 00:05:41,930
it's

70
00:05:41,930 --> 00:05:46,770
and so that allows you to run that you
can run other tools like caring caribou

71
00:05:46,770 --> 00:05:53,479
universal I system actual results in
Metro cars can do like him but forcing

72
00:05:53,479 --> 00:05:57,220
and that kind of stuff so you can
practice with those but one doing this

73
00:05:57,220 --> 00:06:03,419
kind of came to this realization that
old likud said during a virtualized

74
00:06:03,419 --> 00:06:06,910
simulation environment for training I
can also use this attack dealership

75
00:06:06,910 --> 00:06:13,699
tools dealership tools are using out of
scope for security development they have

76
00:06:13,699 --> 00:06:18,330
all the keys all the cars he's the
firmware of those kinds of things you

77
00:06:18,330 --> 00:06:24,690
really need is an extra piece of
hardware so the ODB gateway comes from

78
00:06:24,690 --> 00:06:30,240
OBD is the normal course you plug into
and I tend to hoist a dirty bastards who

79
00:06:30,240 --> 00:06:35,720
d be instead so I wouldn't have made a
tool so now I'm not wrong I say no debe

80
00:06:35,720 --> 00:06:44,020
it's just different all in all it really
is is you have to be ports attached to

81
00:06:44,020 --> 00:06:50,330
it but you have to do is this is kind of
minimum install you would run the ground

82
00:06:50,330 --> 00:06:51,780
wires to each other

83
00:06:51,780 --> 00:06:56,840
12 volt power and then the green one so
they can hike and that's the minimum you

84
00:06:56,840 --> 00:07:02,000
will have to put a 200 or 250 ohm
resistor on the can lines for it to work

85
00:07:02,000 --> 00:07:08,380
and what are you trying to mimic the
other one still so if you're going like

86
00:07:08,380 --> 00:07:12,490
an American car though typically have
more can so that's a high-speed cameras

87
00:07:12,490 --> 00:07:17,150
may have a middle seat can or low-speed
can and in those cases wanna run those

88
00:07:17,150 --> 00:07:21,710
two but sometimes a line or something
else your thing will vary but if you

89
00:07:21,710 --> 00:07:28,270
keep it to just can't high power and
ground it's fairly universal so here is

90
00:07:28,270 --> 00:07:32,400
one thing you can do you can be any
vehicle you take a scan tool which is

91
00:07:32,400 --> 00:07:34,449
like da

92
00:07:34,449 --> 00:07:47,159
here so that's the scandal here

93
00:07:47,159 --> 00:07:53,159
Bosch it does everything make all the
decisions based on your then one thing

94
00:07:53,159 --> 00:07:57,759
you can do is use in a ban from another
car are you in similar cases showing a

95
00:07:57,759 --> 00:08:02,099
2006 Dodge Charger and then when you're
through his assumptions based on that

96
00:08:02,099 --> 00:08:12,729
you can also make up your own vents on
the command line options and so this one

97
00:08:12,729 --> 00:08:18,330
is a believer not a valid then says
permit open garages thence have a

98
00:08:18,330 --> 00:08:24,120
checksum in bytes in this case is free
and open so this tool if it didn't

99
00:08:24,120 --> 00:08:30,080
couldn't do proper calculations on your
been bashful where it won't get some

100
00:08:30,080 --> 00:08:32,409
signs this one is fine

101
00:08:32,409 --> 00:08:37,649
is concerned it will try to process this
one no problem you can work from

102
00:08:37,649 --> 00:08:43,610
anywhere this picture was taken out of
our laptop had a scan tool doing much

103
00:08:43,610 --> 00:08:48,970
testing allows for fussing so many
things you can also send a bunch of

104
00:08:48,970 --> 00:08:55,000
closing packets I think this means ample
that is well you can do it for no

105
00:08:55,000 --> 00:09:01,139
controls so I mentioned we need to go
dealership to like you know controlling

106
00:09:01,139 --> 00:09:05,230
door unlocked that kind of stuff if you
look at the debug log which is on the

107
00:09:05,230 --> 00:09:10,149
left side and you can read it but it'll
basically an English what's going on

108
00:09:10,149 --> 00:09:15,540
you're plugged in this way you have you
know a deal at all like an MDI here for

109
00:09:15,540 --> 00:09:21,069
the tech to go and you say I liked the
card or it will show you on the left and

110
00:09:21,069 --> 00:09:25,740
English no se ok were spying to test her
present we've gotten a request for

111
00:09:25,740 --> 00:09:29,410
sending data and then you'll see the
highlighted section there which is

112
00:09:29,410 --> 00:09:33,889
saying that was unhandled device control
from gym and that's the other

113
00:09:33,889 --> 00:09:39,579
highlighted packet so it's the package
began a are those controls and so we all

114
00:09:39,579 --> 00:09:40,410
know

115
00:09:40,410 --> 00:09:43,000
the reasons I'm handles because there's
nothing to do from the simulation

116
00:09:43,000 --> 00:09:46,569
perspective not gonna simulated door
unlocking with this because just

117
00:09:46,569 --> 00:09:52,509
software only basis output so that's
what you see as a unhandled but you know

118
00:09:52,509 --> 00:09:55,490
right away when you could do a lot
that's attacking you can send a lot that

119
00:09:55,490 --> 00:09:59,399
card or you need the car there to do it
and so if you're in icing as opposed to

120
00:09:59,399 --> 00:10:04,319
getting a rental car and then figuring
things out you can just tell this the

121
00:10:04,319 --> 00:10:07,949
car you're interested in the national
press the buttons here's what it would

122
00:10:07,949 --> 00:10:12,800
be for this cars such a lot of times you
not looking through all of that can

123
00:10:12,800 --> 00:10:13,269
traffic

124
00:10:13,269 --> 00:10:19,120
here's another example of the buzzer so
DC's were trouble codes normally get

125
00:10:19,120 --> 00:10:24,569
like my worst 205 trouble codes in a car
although no car really would have

126
00:10:24,569 --> 00:10:30,220
something like that this week in July
comes on this case when i dun jim has a

127
00:10:30,220 --> 00:10:35,389
a different way of sending packet data
so you can speak much much higher number

128
00:10:35,389 --> 00:10:42,720
of the EBC a model there at like 1030 or
98 trouble codes body control module 676

129
00:10:42,720 --> 00:10:46,790
I mean so fake stuff but like what's
happening here is you can have it trying

130
00:10:46,790 --> 00:10:52,449
to display these things so one thousand
and see how the devices handle that the

131
00:10:52,449 --> 00:10:55,139
goal is get to crash when you get these
the crash

132
00:10:55,139 --> 00:10:58,170
you can then work on getting for their
exploits to it is again they have the

133
00:10:58,170 --> 00:11:03,230
keys to all the other ones doing some
relatively squishy

134
00:11:03,230 --> 00:11:07,649
they have very low security they don't
use even have a internal I T Department

135
00:11:07,649 --> 00:11:13,360
these tools like I said I trusted their
tools that you know aren't like security

136
00:11:13,360 --> 00:11:18,240
review kind of stuff so you can make a
malicious car that drives into a

137
00:11:18,240 --> 00:11:22,850
dealership and it's there to attack the
dealership has you playing the

138
00:11:22,850 --> 00:11:27,370
diagnostic tools see where engine light
is on again take care of that tool and

139
00:11:27,370 --> 00:11:30,959
then when she had on that to you don't
any other car that comes in handy on a

140
00:11:30,959 --> 00:11:32,499
brothel

141
00:11:32,499 --> 00:11:45,349
and now we see what this is about you
know like that picture in case me

142
00:11:45,349 --> 00:11:52,399
nothing you should go and do this as a
security audit tests are adding 10

143
00:11:52,399 --> 00:12:00,119
testing tool to bring contesting two
types of a lot so it's kind of getting

144
00:12:00,119 --> 00:12:04,679
another big area just hasn't been looked
at as a lot of interesting stuff there

145
00:12:04,679 --> 00:12:11,599
the UDS tool just like I said we got
pushed this morning so there'll be

146
00:12:11,599 --> 00:12:13,919
something certain tools it doesn't work
terribly well but there's a lot of

147
00:12:13,919 --> 00:12:17,989
involvement with getting a lot more
generic man the father better that kind

148
00:12:17,989 --> 00:12:22,819
of stuff some ruling for technique
contributions to us if you have problems

149
00:12:22,819 --> 00:12:34,039
to do something better let me know so
the very early stages so any questions

150
00:12:34,039 --> 00:12:39,209
about this store your car hacking tools
in general that I didn't cover exciting

151
00:12:39,209 --> 00:12:56,540
give you the original talk would be ok

152
00:12:56,540 --> 00:13:02,180
ok so that the password piece that's
kinda referring to that has the keys to

153
00:13:02,180 --> 00:13:07,140
her car or the security access to it and
so typically when you're going to modify

154
00:13:07,140 --> 00:13:14,410
firmware likes a change in number but
you can do you may 16 challenge response

155
00:13:14,410 --> 00:13:20,470
you make every class to 24 bytes use a
comeback and you have to give it an

156
00:13:20,470 --> 00:13:25,000
equivalent to a place that's at that it
like a rolling he typically or something

157
00:13:25,000 --> 00:13:30,070
of that nature and so on the dealership
poolside and password will side it will

158
00:13:30,070 --> 00:13:33,680
go through and kick it with a number
should be it passes back to the ECU

159
00:13:33,680 --> 00:13:40,870
nieces alright cool now willing to take
take changes so with this tool what you

160
00:13:40,870 --> 00:13:46,470
could do if you wanted to as you could
smoosh the request so the seed initial

161
00:13:46,470 --> 00:13:52,850
seed part toward to give you a bunch of
keys assume you have a lot of times this

162
00:13:52,850 --> 00:13:59,580
past rituals do I have a kind of like
license so maybe only get the push like

163
00:13:59,580 --> 00:14:03,380
10 keys or something like that before
you have to pay again so it may not be

164
00:14:03,380 --> 00:14:08,850
that great for you to unlimited unlock
stow yeah you could run through the kind

165
00:14:08,850 --> 00:14:13,130
of the entropy out of it determine how
hard is just the guests to hear these

166
00:14:13,130 --> 00:14:19,570
keys that when I would recommend 0 for
breaking those as a couple days to do it

167
00:14:19,570 --> 00:14:26,550
but for a tool perspective caring care
bill is a has gone away and map like

168
00:14:26,550 --> 00:14:33,020
things but also can be the framework I
have a model had released but you can

169
00:14:33,020 --> 00:14:39,160
make 12 that does the same thing for one
of the vehicles that requests that's the

170
00:14:39,160 --> 00:14:44,230
key the seed and then I just are
proportionate and will happen is she

171
00:14:44,230 --> 00:14:49,230
like you out after like three to be like
oh you know teammate rises with your

172
00:14:49,230 --> 00:14:54,960
area code is and so then you send a
packet that tells you to reboot and then

173
00:14:54,960 --> 00:14:58,090
what does that your you can do it again
just the tour does that they wait for an

174
00:14:58,090 --> 00:15:03,380
area and then we continue where you left
off and it's not too hard ratings front

175
00:15:03,380 --> 00:15:07,750
lines that's that's one way to get the
key another one

176
00:15:07,750 --> 00:15:17,270
so their thing you can do is when you
see like one side so here you can see

177
00:15:17,270 --> 00:15:21,190
where it was like oh I sent a door
unlocked and here's the packet loss of

178
00:15:21,190 --> 00:15:26,400
course there's other things we say like
oh gets information like the VIN for

179
00:15:26,400 --> 00:15:29,350
things like that the way dealership
tools work they don't do the standard

180
00:15:29,350 --> 00:15:34,880
mode nine to get to them which is the
generic yes pls scan tool from Bosch at

181
00:15:34,880 --> 00:15:35,830
work

182
00:15:35,830 --> 00:15:39,960
the request data based on a memory
address off the see your body control

183
00:15:39,960 --> 00:15:45,920
model those memory addresses like 30
then would be simply should go to change

184
00:15:45,920 --> 00:15:50,580
it so when you make a request to go read
it you can change that packet to go

185
00:15:50,580 --> 00:15:55,770
right as well so you can also kind of
brute force that memory space undersea

186
00:15:55,770 --> 00:16:00,070
well as in there one thing to look for
for these keys as you can make a request

187
00:16:00,070 --> 00:16:05,260
for the CT scan the memory space as you
can see that sweet shop in memory if you

188
00:16:05,260 --> 00:16:09,860
do a lot of times these these embedded
systems also pre generate the response

189
00:16:09,860 --> 00:16:15,810
is supposed to be restored right next to
the seed so you can request the

190
00:16:15,810 --> 00:16:16,800
Mauritian

191
00:16:16,800 --> 00:16:21,089
the memory check the base next witness
in that as your answer and your right

192
00:16:21,089 --> 00:16:26,610
amount time to do it can be pretty
smooth I went on like that happen to you

193
00:16:26,610 --> 00:16:43,020
of any of the testing of the keys are
and human nature and science questions

194
00:16:43,020 --> 00:16:47,020
came down from where I'm not a few yes
I'm glad you're you're the component in

195
00:16:47,020 --> 00:16:50,990
this case you can make it would make it
it was a request from where you can get

196
00:16:50,990 --> 00:16:56,080
fake firmware but I think a lot of your
ship tools don't down the former

197
00:16:56,080 --> 00:16:58,450
modifying uploaded on the way they do as
directed

198
00:16:58,450 --> 00:17:03,089
parameters little spots in the memory
you wanna go out the other way he'd want

199
00:17:03,089 --> 00:17:06,990
you like hearing caribou something like
that some other tool to download the

200
00:17:06,990 --> 00:17:24,170
firmware you absolutely can download ECU
from where

201
00:17:24,170 --> 00:17:28,720
do most likely to come from their
dealership if you bought it for party at

202
00:17:28,720 --> 00:17:36,160
the UC don't always can either princess
I have 2009 Honda and that was on key

203
00:17:36,160 --> 00:17:40,800
line so it's a different type of bus
they are using Kinect your car and

204
00:17:40,800 --> 00:17:45,010
getting into them as always through can
you know sometimes you can smooth things

205
00:17:45,010 --> 00:17:48,740
to the entertainment that kind of stuff
you get into your entertainment you know

206
00:17:48,740 --> 00:17:53,970
that when you gonna do it differently
you gonna do it through you know you see

207
00:17:53,970 --> 00:17:58,540
like updates offer that kind of stuff so
I could have a web app loading Delos our

208
00:17:58,540 --> 00:18:00,670
new firmware version that's a good place
to start

209
00:18:00,670 --> 00:18:06,530
you can also take their radio unit out
and look for like 80 lines into it and

210
00:18:06,530 --> 00:18:11,300
some have either not now the newer
vehicles which street that like you

211
00:18:11,300 --> 00:18:14,639
would a dust-up

212
00:18:14,640 --> 00:18:29,150
embedded systems another good sign for
most things in the newer stuff there's

213
00:18:29,150 --> 00:18:32,950
planning for doing a lot that I mean the
PKI infrastructure for doing over there

214
00:18:32,950 --> 00:18:38,650
updates at the have them it's not just a
nice to have the PKI infrastructure for

215
00:18:38,650 --> 00:18:46,150
it and there is a lesson handful of
people I know they're doing a PCI

216
00:18:46,150 --> 00:18:51,720
further updates and when they do it
there could be an issue as well

217
00:18:51,720 --> 00:18:57,690
weather entertainment unit itself may
check the key information in may not

218
00:18:57,690 --> 00:19:01,530
check this pushing out to other devices
are in venice is something that is

219
00:19:01,530 --> 00:19:06,440
insulting check the PKI just have an
understanding of it so that's you

220
00:19:06,440 --> 00:19:10,830
sometimes that each component
entertainment center does all the

221
00:19:10,830 --> 00:19:16,230
checking and then and then passes it
using using just a standard password

222
00:19:16,230 --> 00:19:20,620
things that you can circumvent the whole
peek at you want I just jumping on the

223
00:19:20,620 --> 00:19:22,690
bus and acting like an entertainment
center

224
00:19:22,690 --> 00:19:25,299
school so it might take this it takes
from where

225
00:19:25,299 --> 00:19:32,809
and I mention this but you get my
participate in and just hacking and

226
00:19:32,809 --> 00:19:37,860
general short talk feel free to jump on
open ground just at work as a mailing

227
00:19:37,860 --> 00:19:43,340
list there we can shoot me an email
directly at Craig at they'll as I am i

228
00:19:43,340 --> 00:19:50,239
think im here I don't but it's a lab SCI
com

229
00:19:50,239 --> 00:19:53,929
this website also has the crackers
handbook for free download that look at

230
00:19:53,929 --> 00:19:54,840
things

231
00:19:54,840 --> 00:20:00,350
yeah I think that should be questioned

232
00:20:00,350 --> 00:20:04,200
URL yeah

