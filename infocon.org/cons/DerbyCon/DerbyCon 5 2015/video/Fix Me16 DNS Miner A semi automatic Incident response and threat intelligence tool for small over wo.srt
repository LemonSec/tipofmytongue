1
00:00:00,000 --> 00:00:08,349
so what are the odds you bring two
laptops and one decides to update

2
00:00:08,349 --> 00:00:14,660
literally just before you go to power up
so excuse us 42 seconds won't get the

3
00:00:14,660 --> 00:00:21,910
video gone just floored they've ever
seen the movie the story of anvil got

4
00:00:21,910 --> 00:00:26,250
check it out it's about this aging rock
band that used to be somebody and they

5
00:00:26,250 --> 00:00:31,789
get this gig in Japan of all places and
it's at eleven o'clock on the morning

6
00:00:31,789 --> 00:00:39,620
and they're going that this sock and I
walk in and the place is packed so thank

7
00:00:39,620 --> 00:00:45,890
you all so much for for showing up this
morning this is great for PowerPoint

8
00:00:45,890 --> 00:00:50,890
gods are almost with us so that if the
VGA guys join out we should be good to

9
00:00:50,890 --> 00:00:59,109
go untucked lease security consultant
from Calgary Alberta so the place just

10
00:00:59,109 --> 00:01:06,650
north of Montana you might have heard of
it alright if you ever get the chance to

11
00:01:06,650 --> 00:01:07,590
go up there

12
00:01:07,590 --> 00:01:11,560
highly recommended as you're gonna go at
once

13
00:01:11,560 --> 00:01:15,750
make sure you go during Stampede we tell
people it's like Mardi Gras with Cowboys

14
00:01:15,750 --> 00:01:25,060
the whole town gets drunk for 10 days
it's phenomenal and if you're actually

15
00:01:25,060 --> 00:01:28,520
good at that all cowboy thing there's a
lot of money in it it's one of the most

16
00:01:28,520 --> 00:01:32,950
lucrative rodeos in the world so if you
can sit on a full 48 seconds you can

17
00:01:32,950 --> 00:01:39,119
with yourself a hundred thousand bucks
we have no I did mention you gotta sit

18
00:01:39,119 --> 00:01:41,900
on an angry bull for aids

19
00:01:41,900 --> 00:01:48,690
her to get to the hundred thousand
around you have to do it with style

20
00:01:48,690 --> 00:01:58,680
about six times but if you can do it so
we got video recording good to go

21
00:01:58,680 --> 00:02:15,890
ok depends on here unfortunately this
year that would be about 80 grand

22
00:02:15,890 --> 00:02:21,860
americans so and then there's the whole
ballpark so maybe just get a good good

23
00:02:21,860 --> 00:02:27,180
at computers and maybe it'll have to
learn how to write bowls safer alright

24
00:02:27,180 --> 00:02:34,380
and shout out to any opinions that are
here this morning I see a few you're not

25
00:02:34,380 --> 00:02:55,530
really Canadian is conveniently from any
country Canada is a lot better at this

26
00:02:55,530 --> 00:02:58,750
than I am still pretty new thanks
everybody for coming out there is an

27
00:02:58,750 --> 00:03:01,769
awful lot of people here for Sunday
morning you guys can hear me in the

28
00:03:01,769 --> 00:03:06,040
cheap seats just let me know we've
already done some introductions as Doug

29
00:03:06,040 --> 00:03:10,660
least my name is a jury consultant with
trust leave our disclaimers the opinions

30
00:03:10,660 --> 00:03:15,110
and views expressed in the stock are not
necessarily those of our respective

31
00:03:15,110 --> 00:03:19,300
employers that's a pretty important
topic I don't really know how relevant

32
00:03:19,300 --> 00:03:22,920
this is anymore but even though we are
Canadians be having a dog sled we don't

33
00:03:22,920 --> 00:03:27,230
know Albert Toronto but we're all really
connected through the internet and

34
00:03:27,230 --> 00:03:31,870
everything somehow so there's that this
everything about to see today is an

35
00:03:31,870 --> 00:03:37,950
alpha testing at the moment so we
weren't expecting it to be con- talk we

36
00:03:37,950 --> 00:03:42,080
got the Derby contacts so really excel
accelerated a lot of our timelines and

37
00:03:42,080 --> 00:03:46,180
as a result we had to put a lot together
to get this going so again it is alpha

38
00:03:46,180 --> 00:03:50,450
testing we have users using it but stuff
works everything that you see has been

39
00:03:50,450 --> 00:03:53,350
tested so looks good

40
00:03:53,350 --> 00:03:59,000
so we have here so DNS minor but simply
is a DNS sinkhole built on

41
00:03:59,000 --> 00:04:02,690
fault-tolerant cloud-based
infrastructure and is designed to

42
00:04:02,690 --> 00:04:06,710
actually ensure that malicious demand
request never make it to their intended

43
00:04:06,710 --> 00:04:10,470
destination will go through a lot of the
features and everything like that a

44
00:04:10,470 --> 00:04:14,550
little further on so this is just the
high-level what it really does it saves

45
00:04:14,550 --> 00:04:18,690
incident response time we come from
shops where we've had to be one man army

46
00:04:18,690 --> 00:04:22,410
when it came to handling our security
incidents of this really can save a lot

47
00:04:22,410 --> 00:04:26,020
of time so I did we build it it's
personal

48
00:04:26,020 --> 00:04:29,450
we want to know what's going on in our
environment with our DNS and we'll get

49
00:04:29,450 --> 00:04:33,660
into I that's really important leaders
well but we wanted to know what was

50
00:04:33,660 --> 00:04:36,910
happening with all the traffic that was
coming in and out of the environment

51
00:04:36,910 --> 00:04:42,110
because we could why do people climb
Everest because it's there for us this

52
00:04:42,110 --> 00:04:48,490
was everest and the doctor said so
public sees DEFCON 22 talkers sitting in

53
00:04:48,490 --> 00:04:52,700
there discussing that and that started
getting the wheels turning of we need to

54
00:04:52,700 --> 00:04:57,849
put together a larger scale DNS
monitoring solution and everybody likes

55
00:04:57,850 --> 00:05:04,540
open source here so I called DNS minor
there's a lot of questions in the

56
00:05:04,540 --> 00:05:09,580
beginning of presentation and that sort
of on purpose we put together a lot of

57
00:05:09,580 --> 00:05:13,280
the white paper and everything that we
submitted for this but it still answered

58
00:05:13,280 --> 00:05:16,340
a lot of questions we still have a lot
of stuff to begin with so a lot of

59
00:05:16,340 --> 00:05:20,380
answered a lot of questions to answer
before you go on so I D minor with a

60
00:05:20,380 --> 00:05:23,620
minor typically would have to sit
through a ton of trash rock in order to

61
00:05:23,620 --> 00:05:28,260
find a document DNS records are no
exception there's tons of them most of

62
00:05:28,260 --> 00:05:31,730
them are benign but there's one on one
or two in your environment that could

63
00:05:31,730 --> 00:05:36,250
lead to better investigation if you were
to find it in keeping with the theme

64
00:05:36,250 --> 00:05:40,550
everything is actually named after
various roles inside of the mine and

65
00:05:40,550 --> 00:05:44,660
against some of that will become very
clear so securing DNS hope everybody

66
00:05:44,660 --> 00:05:49,340
understands why it's important but if
not that's fine too

67
00:05:49,340 --> 00:05:53,810
we're here to learn right so the
government carries an awful lot and

68
00:05:53,810 --> 00:05:58,520
reminded us that securing DNS signer
about is a good idea and created a

69
00:05:58,520 --> 00:06:01,970
report as such because we all know it
doesn't necessarily mean management

70
00:06:01,970 --> 00:06:04,250
knows it you can come to them with this
report

71
00:06:04,250 --> 00:06:06,289
lends credibility to your cause

72
00:06:06,289 --> 00:06:10,189
and you see something to fall back on
DNS is also really good for covert

73
00:06:10,189 --> 00:06:16,990
channels so we have some examples of how
DNS can be used as a reverse shell for

74
00:06:16,990 --> 00:06:22,379
data exfiltration and I won't spoil what
that ended up doing is kind of me so

75
00:06:22,379 --> 00:06:25,360
we'll just leave it there and
everybody's willing to put a firewall

76
00:06:25,360 --> 00:06:30,409
anywhere you tell your boss you need a
firewall somewhere in the range in check

77
00:06:30,409 --> 00:06:34,909
as long as nobody needs new printers a
quarter but given that situation

78
00:06:34,909 --> 00:06:38,999
nobody's really paying attention to what
the need to maintain traffic is doing so

79
00:06:38,999 --> 00:06:46,969
often really overlooked it's also really
difficult we all understand how it works

80
00:06:46,969 --> 00:06:51,189
and we can all stand up DNS server but
really securing it takes a lot of work a

81
00:06:51,189 --> 00:06:53,550
lot of effort there's some really good
guys out there were not really gonna dig

82
00:06:53,550 --> 00:06:56,939
into those now but if you can't find
them let us know and we'll send you the

83
00:06:56,939 --> 00:07:03,199
reports we used more than welcome to
read through so securing DNS

84
00:07:03,199 --> 00:07:06,869
transactions we're not really gonna go
too deep into this is all from in this

85
00:07:06,869 --> 00:07:10,680
report that we used to develop a
presentation if anybody really wants to

86
00:07:10,680 --> 00:07:15,300
read into it I think it's ridiculous
amount so if you're looking for

87
00:07:15,300 --> 00:07:18,740
something to do on the flight home has
to work out really well

88
00:07:18,740 --> 00:07:26,719
same deal here securing your DNS query
in response this is a lot of this is

89
00:07:26,719 --> 00:07:32,360
pertaining to DNS DNS minor doesn't use
DNS doesn't implement the second anyway

90
00:07:32,360 --> 00:07:35,899
but it won't break you so if you have to
use it in your environment you wanna

91
00:07:35,899 --> 00:07:42,789
have this action later I guess so how we
responded this is a really good question

92
00:07:42,789 --> 00:07:47,080
as to ok so here you have all these
security thing you have to do how is

93
00:07:47,080 --> 00:07:51,499
this tool set designed to handle that
while we VCRs which blocked the traffic

94
00:07:51,499 --> 00:07:55,919
from unknown hosts everything is on the
waitlist or it doesn't get through

95
00:07:55,919 --> 00:08:00,899
everything that has to be authorised
each client we have different users are

96
00:08:00,899 --> 00:08:05,729
using this interview based so you can
actually see what each single client is

97
00:08:05,729 --> 00:08:09,689
doing but you can't talk across each
client environments all works out pretty

98
00:08:09,689 --> 00:08:16,409
well that way and again DNS seconds up
to the rest of the world but this one

99
00:08:16,409 --> 00:08:21,800
so I think some people in here may have
responded to the survey we won't go over

100
00:08:21,800 --> 00:08:25,559
the stats we have a lot to cover we just
kept writing and then we realized we

101
00:08:25,559 --> 00:08:30,919
only have 45 minutes solution is down so
the beginning he see the 45 percent

102
00:08:30,919 --> 00:08:34,000
cited lack of visibility into the
environment I think we can all agree

103
00:08:34,000 --> 00:08:39,039
with that you know roughly half of us
seem like unable to see more on

104
00:08:39,039 --> 00:08:43,180
environment is a really big risk but the
bottom status especially scary one in

105
00:08:43,180 --> 00:08:48,459
four feel that because they detected it
they found that led to a breach in it

106
00:08:48,459 --> 00:08:54,329
for them but what about the other three
of the four who didn't find a breach was

107
00:08:54,329 --> 00:08:58,519
that because no breach occurred or
because they just couldn't see I think

108
00:08:58,519 --> 00:09:07,250
we all know which answer that might end
up being alright there was an old man I

109
00:09:07,250 --> 00:09:11,300
wrote this slide them sort of proud of
it so taken care of business so let's

110
00:09:11,300 --> 00:09:15,110
let's suppose a scenario and I think
we've all read into this I specially run

111
00:09:15,110 --> 00:09:19,230
into this you get a list of 20
questionable IP addresses from fire well

112
00:09:19,230 --> 00:09:23,959
if you have an overzealous director who
says you have to have this sorted out by

113
00:09:23,959 --> 00:09:29,180
the end of the day I mean I'm by no
means incredibly senior but I do know a

114
00:09:29,180 --> 00:09:32,490
thing or two then when it came to
investigating this you have to mind

115
00:09:32,490 --> 00:09:35,839
different intelligence feeds whatever
you could find some would say it's good

116
00:09:35,839 --> 00:09:39,449
someone say it's bad some have no
opinion so if you start to get down the

117
00:09:39,449 --> 00:09:44,540
rabbit hole and gets increasingly more
difficult to develop Yes No maybe so

118
00:09:44,540 --> 00:09:49,310
answer so if we suppose that it takes
roughly 30 minutes for each IP address

119
00:09:49,310 --> 00:09:53,389
which you know is probably median rate
some might be really quick some might

120
00:09:53,389 --> 00:09:57,050
even longer so let's just assume 30
minutes all of a sudden there's twenty

121
00:09:57,050 --> 00:10:03,740
IP's become towers work overtime

122
00:10:03,740 --> 00:10:08,960
let's try that again with DNS minor and
we tested this I personally tested this

123
00:10:08,960 --> 00:10:15,520
your list of 28 peas all of a sudden you
plug it into your minor and the console

124
00:10:15,520 --> 00:10:18,560
will show you everything you do
everything you need to know about the

125
00:10:18,560 --> 00:10:22,750
answer will give you the IP address when
it was requested the nameserver the head

126
00:10:22,750 --> 00:10:26,570
to toe open to other really good
information that will get into a little

127
00:10:26,570 --> 00:10:31,540
bit later and now takes you five minutes
per IP address as opposed to 30 minutes

128
00:10:31,540 --> 00:10:35,100
because you can immediately we don't
which ones you don't care about by

129
00:10:35,100 --> 00:10:39,260
putting in the IDs and going out now
belongs to Google care I'm gonna move on

130
00:10:39,260 --> 00:10:45,040
so it actually make sure incident
response time a lot easier and all of a

131
00:10:45,040 --> 00:10:48,990
sudden you're ten hours became ninety
minutes to finish asparagine start your

132
00:10:48,990 --> 00:10:54,710
weekend early alright so we are
preaching to the converted on a lot of

133
00:10:54,710 --> 00:10:58,310
this I think some people are really an
agreement that so let's go over what it

134
00:10:58,310 --> 00:11:04,800
means to the business so the way we have
got to distributed was we had multiple

135
00:11:04,800 --> 00:11:10,240
card providers in the event that there's
a geographical disruptions or what

136
00:11:10,240 --> 00:11:15,880
really happened is credit card got on
and the autopay didn't get updated and

137
00:11:15,880 --> 00:11:20,550
all of a sudden the server stopped
responding which became kind of

138
00:11:20,550 --> 00:11:25,660
frightening however because the way it's
set up full time wise there was no I

139
00:11:25,660 --> 00:11:27,850
wouldn't it was just an inconvenience

140
00:11:27,850 --> 00:11:32,680
so if we look at the rates I won't go
into each one here but the rates boil

141
00:11:32,680 --> 00:11:38,870
down to about $65 a month thats canyon
so 40 bucks American give-and-take

142
00:11:38,870 --> 00:11:43,630
so it's not a bad deal but what does
that all mean let's put in some context

143
00:11:43,630 --> 00:11:46,370
of the business can come to you the
accountants gonna look at you and say

144
00:11:46,370 --> 00:11:49,620
okay but what is actually going to cost
rate so for supposing that one of these

145
00:11:49,620 --> 00:11:53,540
incidents happened a month in maybe it's
an operational tasking an awful lot of

146
00:11:53,540 --> 00:11:58,890
people would have that in an environment
without DNS miners 0 additional compute

147
00:11:58,890 --> 00:12:04,090
cost it doesn't cost you anything extra
whatever you have in there or don't have

148
00:12:04,090 --> 00:12:08,320
in there doesn't cause you any more or
less so that's a zero you still have

149
00:12:08,320 --> 00:12:13,540
that 10 hours of work every month and if
we suppose an average loaded rate of $65

150
00:12:13,540 --> 00:12:16,780
an hour that's a $650 monthly

151
00:12:16,780 --> 00:12:21,700
incident that you have to pay for maybe
if you're one man security guy you have

152
00:12:21,700 --> 00:12:26,920
to fit that into your firewall that man
matching user wherein s what are also

153
00:12:26,920 --> 00:12:31,040
might be so gets typical and the worst
part is that the end of the day you only

154
00:12:31,040 --> 00:12:35,350
have a medium understanding of what
you've seen because you get to mine some

155
00:12:35,350 --> 00:12:40,020
of these sources that may say it's good
it's bad it just depends rate so your

156
00:12:40,020 --> 00:12:45,370
level of confidence isn't as high as if
you're using the other minor so it's a

157
00:12:45,370 --> 00:12:51,070
way to what happens if you do use it so
it's $65 a month we suppose the same

158
00:12:51,070 --> 00:12:57,870
loaded rain but it ends up being roughly
$160 $65 month give or take to hope to

159
00:12:57,870 --> 00:13:02,690
have this as an operational task and
your degree of confidence in your sports

160
00:13:02,690 --> 00:13:06,000
is now a lot higher so we broke it out
over the course of the year and I think

161
00:13:06,000 --> 00:13:11,230
it saves the business roughly $5,000 if
you're working this every month that's

162
00:13:11,230 --> 00:13:17,250
not huge but again if your small shop
for you have been counted especially

163
00:13:17,250 --> 00:13:21,900
interested in the bottom line is that
she is really attractive so what else

164
00:13:21,900 --> 00:13:27,880
does it do also DNS sinkhole leverages
passive DNS historic log analysis using

165
00:13:27,880 --> 00:13:32,560
open source intelligence feeds into a
little later and it actually enforces

166
00:13:32,560 --> 00:13:37,680
rules set so response policies on means
that users to connect intentionally or

167
00:13:37,680 --> 00:13:43,870
unintentionally if that domain is on the
naughty list to get redirected and we

168
00:13:43,870 --> 00:13:49,040
also offer big data analytics data being
good word and some customizable

169
00:13:49,040 --> 00:13:53,170
reporting so we have some freak and
reporting but you as the admin can build

170
00:13:53,170 --> 00:13:59,840
your own party like it's entirely up to
you hear some words from the end user

171
00:13:59,840 --> 00:14:07,460
ok no feedback for me so you have your
User user connected behind the corporate

172
00:14:07,460 --> 00:14:12,200
firewall this can be iPads desktops
workstations whatever situation might be

173
00:14:12,200 --> 00:14:16,100
makes a query for malicious domain now
this may be an advert maybe they have a

174
00:14:16,100 --> 00:14:19,120
piece of malware that's finding out if
they don't know that this link they've

175
00:14:19,120 --> 00:14:22,790
been convinced to click on his bad we
can't always assume that they're being

176
00:14:22,790 --> 00:14:26,870
foolish so in this scenario they would
make the request

177
00:14:26,870 --> 00:14:30,600
your questions answered and some magic
happens in the cloud over the magic

178
00:14:30,600 --> 00:14:34,010
little later this is just from their
point of view and instead of being

179
00:14:34,010 --> 00:14:37,510
redirected instead of being directed to
the malicious domain they get redirected

180
00:14:37,510 --> 00:14:43,240
to an internal web server that says you
may have come across this domain

181
00:14:43,240 --> 00:14:52,390
this is a bad thing please tell somebody
that's great so gonna start diving into

182
00:14:52,390 --> 00:14:59,690
this from the perspective of the end
user in the incident responder so we

183
00:14:59,690 --> 00:15:04,220
picked on this something called us
blacklisting her black holding you know

184
00:15:04,220 --> 00:15:04,940
Harvey L

185
00:15:04,940 --> 00:15:08,970
the terminology isn't as important as
the fact that what we're trying to do is

186
00:15:08,970 --> 00:15:15,420
disrupt the attack chain chain whatever
your preferences and we picked on DNS

187
00:15:15,420 --> 00:15:22,240
because hardly anybody's looking at it
and number two it provides that context

188
00:15:22,240 --> 00:15:26,630
that you could get from just straight IP
address and the main reason for that is

189
00:15:26,630 --> 00:15:31,850
a lot of the campaigns were seeing the
attackers bad guys whatever you want to

190
00:15:31,850 --> 00:15:36,360
call them are using the same hosted
infrastructure as your mom's flower shop

191
00:15:36,360 --> 00:15:41,360
and indie rock bands and I'm a big fan
indie rock bands and every mom should

192
00:15:41,360 --> 00:15:50,360
have a chance to rural flower shop so
you don't want a black list so what we

193
00:15:50,360 --> 00:15:56,360
did was we built this need we felt this
need for redirection and function of the

194
00:15:56,360 --> 00:16:00,470
Canary server is to actually direct the
user to a safe place that we can control

195
00:16:00,470 --> 00:16:06,130
has we want to have some metrics on what
happen and there's a lot of sinkhole

196
00:16:06,130 --> 00:16:09,600
guidance so there you're gonna find on
the internet says just sent him to

197
00:16:09,600 --> 00:16:14,839
localhost or just drop to traffic and
life will be good and you've stopped the

198
00:16:14,839 --> 00:16:20,060
attack but we think you need more
control than that so quickly

199
00:16:20,060 --> 00:16:28,900
sample look at the file infrastructure
and anything that's going to 507 . are

200
00:16:28,900 --> 00:16:35,530
you you know the main to dot 507 are you
were gonna redirected back to a server

201
00:16:35,530 --> 00:16:40,279
the weed control we say it's an app it's
got a pretty low

202
00:16:40,279 --> 00:16:45,810
footprint it's a couple of web pages and
they're written in ASP or PHP it's all

203
00:16:45,810 --> 00:16:50,410
server side but it the samples in the
git repo also include a stylesheet

204
00:16:50,410 --> 00:16:55,829
stylesheet you say why would you need a
stylesheet well Egypt mentioned user

205
00:16:55,829 --> 00:17:01,800
awareness so it's really important that
one user gets that link they actually

206
00:17:01,800 --> 00:17:06,880
feel like this is legit and so if you're
not a real web developer and you can

207
00:17:06,880 --> 00:17:12,990
tell by the HTML there that I'm not you
know any reasonable system and could

208
00:17:12,990 --> 00:17:16,669
take the stylesheet tweak it to me have
at the same look and feel as whatever

209
00:17:16,669 --> 00:17:21,659
here company internal documentation
looks like and the part that I really

210
00:17:21,659 --> 00:17:29,260
think is used is as an IR person with
this I'm getting things like user agent

211
00:17:29,260 --> 00:17:33,210
string or their browser is depending on
the attack

212
00:17:33,210 --> 00:17:38,070
seen it were for Firefox browsers or
something like that so it's a little PC

213
00:17:38,070 --> 00:17:42,250
Intel you grab the buncher hackers
tactics you get the fully qualified

214
00:17:42,250 --> 00:17:44,799
domain name that they were looking for

215
00:17:44,799 --> 00:17:48,320
you're going to get things like the
query string that they requested as part

216
00:17:48,320 --> 00:17:53,730
of that if it's there and most
importantly you get the inside IP

217
00:17:53,730 --> 00:18:01,640
address the user or users that clicked
and you do that all without an agent and

218
00:18:01,640 --> 00:18:07,110
that was the number one thing we want to
make sure there was no no agent now I'm

219
00:18:07,110 --> 00:18:11,780
pretty sure there are people around this
may be in this room that could do way

220
00:18:11,780 --> 00:18:18,169
better at sniffing out information on a
user's browser session and add even more

221
00:18:18,169 --> 00:18:24,780
context to that but however you go about
it we need to get that Intel back that

222
00:18:24,780 --> 00:18:30,500
user did and one more thing that I just
forgot about you see those dashed lines

223
00:18:30,500 --> 00:18:34,809
there when all we got to do get that
users to swipe that cut and paste it

224
00:18:34,809 --> 00:18:41,919
into an email and there's your reporting
if they happen not to report gives users

225
00:18:41,919 --> 00:18:46,179
never like to say I did something bad
there's also a log on the Canary server

226
00:18:46,179 --> 00:18:52,549
that contains all the same information
so not sure how many people saw at

227
00:18:52,549 --> 00:18:53,380
Stockton

228
00:18:53,380 --> 00:18:59,260
front of us if you didn't you gotta go
check out the video cuz it's it's good

229
00:18:59,260 --> 00:19:03,590
he's talking about open source threat
intelligence and I think that it's a

230
00:19:03,590 --> 00:19:10,600
super valuable asset but we also gotta
watch the return on investment because I

231
00:19:10,600 --> 00:19:15,850
peas on their own or not really what I
would call something worth blowing your

232
00:19:15,850 --> 00:19:22,580
budget so shut out of the guys are
critical stack and their free threat in

233
00:19:22,580 --> 00:19:28,420
Telemark that plugs into bro that's very
cool idea this one here

234
00:19:28,420 --> 00:19:33,220
currently what we're doing is
downloading about a half a dozen lists

235
00:19:33,220 --> 00:19:37,110
over HTTP were normalizing that data
because every single list looks

236
00:19:37,110 --> 00:19:42,540
different get rid of that and then we
got us lunch all that stuff together in

237
00:19:42,540 --> 00:19:48,430
a form that the DNS notes can actually
consuming this all goes on automatically

238
00:19:48,430 --> 00:19:57,110
once a day and the nice thing about that
is that it's going to get fixed it last

239
00:19:57,110 --> 00:20:05,130
summer's Holden bash the air handling is
currently like Microsoft On Error Resume

240
00:20:05,130 --> 00:20:11,350
next just keep on going but you know hey
this threat he hasn't responded for a

241
00:20:11,350 --> 00:20:17,370
week you know as a freebie maybe you
want to take that off the list or hey

242
00:20:17,370 --> 00:20:21,430
we're paying for that one so we should
probably go give me a call like he

243
00:20:21,430 --> 00:20:23,730
expired do now

244
00:20:23,730 --> 00:20:29,040
problem with lists that I found is that
everybody really wants to do the best

245
00:20:29,040 --> 00:20:34,050
job they can but most of us are
volunteers and it's a best effort thing

246
00:20:34,050 --> 00:20:38,090
and I know from personal experience it's
easier to get on some of those lists

247
00:20:38,090 --> 00:20:43,790
that off them so if you find that you
have a business partner somebody's on

248
00:20:43,790 --> 00:20:48,830
one of those lists you definitely don't
want to be dropping all the traffic so

249
00:20:48,830 --> 00:20:54,310
there's a custom white list for each
organization and before the daily list

250
00:20:54,310 --> 00:20:57,750
is updated

251
00:20:57,750 --> 00:21:03,100
a whitelist wins there you go that's
where I was trying to say now in in its

252
00:21:03,100 --> 00:21:06,920
talk as well you had a honey pot and
somebody was poking away little in his

253
00:21:06,920 --> 00:21:12,190
malware drop zone came up so maybe it's
just a little one small guy not on

254
00:21:12,190 --> 00:21:16,690
anybody's list you can add that black
leather that domain to this custom

255
00:21:16,690 --> 00:21:21,540
blacklist and now you're protected even
before it gets out the regular

256
00:21:21,540 --> 00:21:26,680
population so pretty flexible that way
and again because you're updating this

257
00:21:26,680 --> 00:21:33,000
on the master buying zone everything
just replicate south to the recursive

258
00:21:33,000 --> 00:21:38,450
knows without you having to do anything
so you know it may not be 35 seconds but

259
00:21:38,450 --> 00:21:42,750
it's gonna be less than 15 minutes
before you're covered for that and you

260
00:21:42,750 --> 00:21:47,020
have to go to one place to covered off
so I think that's pretty useful

261
00:21:47,020 --> 00:21:51,180
all right over to you for some big data
stuff

262
00:21:51,180 --> 00:21:54,480
data like that word I never really
understood it was until I was in the

263
00:21:54,480 --> 00:22:01,560
database class but its get the self so
historical analysis all of these threat

264
00:22:01,560 --> 00:22:05,510
indicators all this threat intelligence
is a lagging indicator so it doesn't

265
00:22:05,510 --> 00:22:09,640
really matter when you purchase the list
or when you acquire the list of most

266
00:22:09,640 --> 00:22:13,350
people are actively going to that demand
at the time the list is implemented or

267
00:22:13,350 --> 00:22:16,900
the demand is even still up chances are
the campaign might be over its winding

268
00:22:16,900 --> 00:22:20,950
down somebody else got busted and it's
been torn down since then you want the

269
00:22:20,950 --> 00:22:23,270
ability to look back in time since we do

270
00:22:23,270 --> 00:22:28,100
historical analysis allows admins to go
back and query all of the demands that

271
00:22:28,100 --> 00:22:32,810
have been access for the last 30 days
using an updated list so maybe at the

272
00:22:32,810 --> 00:22:36,260
time a specific domain wasn't malicious
cuz it wasn't big enough to get noticed

273
00:22:36,260 --> 00:22:40,300
and then it wound up getting on
somebody's list somebody's radar now it

274
00:22:40,300 --> 00:22:43,830
is malicious but it's too late the
damage is already done somebody in your

275
00:22:43,830 --> 00:22:50,440
environment had access this at some
point when I can tell for sure

276
00:22:50,440 --> 00:22:55,470
so the completion backwards principle is
what this is called and this essentially

277
00:22:55,470 --> 00:22:59,419
goes through and looks at all the
traffic that it happened and it strips

278
00:22:59,419 --> 00:23:02,460
out all the hosts and everything like
that is part of the deduplication it

279
00:23:02,460 --> 00:23:07,529
just does the top level domain so if
somebody access to text on Google I dot

280
00:23:07,529 --> 00:23:11,309
cool C-dot google it doesn't matter its
troops all of them says three requests

281
00:23:11,309 --> 00:23:16,580
were made so it helps in your incident
response and triage process to determine

282
00:23:16,580 --> 00:23:22,350
just how many times a specific domain at
the top level without access the thirty

283
00:23:22,350 --> 00:23:27,460
day window this is a neat stuff that's
good as mentioned that we should read

284
00:23:27,460 --> 00:23:32,759
our blue jeans based on how well they
handle their metrics and and continue to

285
00:23:32,759 --> 00:23:37,049
improve so according to the Verizon data
breach report the median time is two

286
00:23:37,049 --> 00:23:41,480
hundred days to detect a breach but
because we have a thirty day window you

287
00:23:41,480 --> 00:23:45,750
can also go that way down so it ends up
looking pretty pretty decent and

288
00:23:45,750 --> 00:23:49,909
provides good luck forensic lots of
artifacts are so if you have to take

289
00:23:49,909 --> 00:23:53,350
this case a little bit further perhaps
to the local authorities of the

290
00:23:53,350 --> 00:23:58,230
situation might be you actually have
some artifacts to draw from

291
00:23:58,230 --> 00:24:05,299
so as we can see here is a bit of an eye
chart so I apologize we have some

292
00:24:05,299 --> 00:24:11,620
demands that have been accessed now some
of these were malicious $14 malicious

293
00:24:11,620 --> 00:24:15,159
and some of them were deemed
questionable however if you look

294
00:24:15,159 --> 00:24:23,009
Melbourne I T hotkeys parking dot com
wasn't necessarily seen is about demand

295
00:24:23,009 --> 00:24:29,220
and then this free connections are not
judging just there was also handed out

296
00:24:29,220 --> 00:24:33,940
from the same number ninety so you look
at this lol why did these two domains

297
00:24:33,940 --> 00:24:37,570
wiser this correlation between these two
demands one of them was quite why there

298
00:24:37,570 --> 00:24:41,279
wasn't any was headed over from the same
name server so it might be worth some

299
00:24:41,279 --> 00:24:45,509
investigation so now you have a timeline
that you can use from your reporting to

300
00:24:45,509 --> 00:24:52,120
go back into your cart all populate your
timeline searches and then begin to see

301
00:24:52,120 --> 00:24:55,929
how many people had actually access this
domain at any point time

302
00:24:55,929 --> 00:24:58,980
so we've seen here with looking at those
demands in that time frame was only

303
00:24:58,980 --> 00:25:02,649
access to couple times not really a
whole lot on one side or the other so

304
00:25:02,649 --> 00:25:07,610
you can now turn around and make the
assumption perhaps if you so choose to

305
00:25:07,610 --> 00:25:12,019
do so that the user probably fat
fingered something accidentally clicked

306
00:25:12,019 --> 00:25:15,549
on a link that they thought was valid
but it didn't actually go anywhere

307
00:25:15,549 --> 00:25:19,499
militia sense because there is no
further traffic where it was only coming

308
00:25:19,499 --> 00:25:24,210
from one or two hosts it's probably not
a huge deal or maybe you looking for

309
00:25:24,210 --> 00:25:27,740
more billable hours and this is a good
way to kind of cheese down some of that

310
00:25:27,740 --> 00:25:29,720
entirely up to you at that point

311
00:25:29,720 --> 00:25:35,669
surpassing DNS and it stopped just
before this one he brought up a really

312
00:25:35,669 --> 00:25:40,179
good question of a threat intelligence
he says you should always ask vendor why

313
00:25:40,179 --> 00:25:41,720
is this a threat to me

314
00:25:41,720 --> 00:25:45,639
passive DNS really helps to answer that
question because this already went

315
00:25:45,639 --> 00:25:49,570
through your environment passive DNS is
backwards looking so if you're finding

316
00:25:49,570 --> 00:25:54,009
these malicious domains in your port all
the answers already come out of your

317
00:25:54,009 --> 00:26:01,590
environment so this has already it's now
a threat to you so the reason why

318
00:26:01,590 --> 00:26:05,629
possibly in essence useful ease
preserving our operational security if

319
00:26:05,629 --> 00:26:10,779
you have an attack that it's targeting
you may be watching their logs for any

320
00:26:10,779 --> 00:26:15,059
hits from your domain to see if their
attack or their campaign has been

321
00:26:15,059 --> 00:26:18,759
successful they can start to launch into
the next one because you're just looking

322
00:26:18,759 --> 00:26:24,559
at your own environment nobody's the
wiser as to you connected to wearing

323
00:26:24,559 --> 00:26:26,720
you're still getting all the full
information at the time

324
00:26:26,720 --> 00:26:30,799
conversely if the demand has been torn
down the information has been changed or

325
00:26:30,799 --> 00:26:34,059
there just isn't really a lot of other
information out there you guys still

326
00:26:34,059 --> 00:26:37,619
look at the answers so they're really
nice thing about this because it's built

327
00:26:37,619 --> 00:26:41,960
on no sequel allows a lot of free porn
videos so for some reason the parser

328
00:26:41,960 --> 00:26:46,080
stripped out some specific domains for
you know they're in there you go right

329
00:26:46,080 --> 00:26:49,399
to the database layer indiscreet
directly and see all of the information

330
00:26:49,399 --> 00:26:53,669
they came so you're not dropping any
traffic it's just storing and making

331
00:26:53,669 --> 00:26:57,620
itself accessible later on Genesis
really difficult topic

332
00:26:57,620 --> 00:27:05,930
so hazardous market quite kind of smart
I don't know I'm standing on the

333
00:27:05,930 --> 00:27:12,510
shoulders of smart people the guys that
run ISC two guys gave us DHCP and buying

334
00:27:12,510 --> 00:27:18,090
people like Paul V exceed helped
spearhead this particular initiative so

335
00:27:18,090 --> 00:27:23,300
all we did was figure it out and make it
work

336
00:27:23,300 --> 00:27:28,580
that's where we did not invent are easy
but rocks and the reason why is because

337
00:27:28,580 --> 00:27:33,690
DNS clients will believe anything
they're told by their name server and

338
00:27:33,690 --> 00:27:40,660
sometime around by 98 midstream this
result responses own policy thing came

339
00:27:40,660 --> 00:27:46,420
into being and it's great because now we
can lie to the end point but it's good

340
00:27:46,420 --> 00:27:50,950
for them so it's alright it's just they
need to be told something a little

341
00:27:50,950 --> 00:27:55,390
different so like I said the
documentation is pretty sparse there's

342
00:27:55,390 --> 00:28:02,920
not a ton I mean you google how to build
a fine name server yeah there's RPC lot

343
00:28:02,920 --> 00:28:09,220
less and it's somewhat obscure but it's
pretty simple when you break it down

344
00:28:09,220 --> 00:28:16,200
there's two things that it does it's got
the ability to trigger on our content of

345
00:28:16,200 --> 00:28:23,390
the query and on the answer to a query
and then based on those triggers you can

346
00:28:23,390 --> 00:28:28,570
take a punch at different activity her
actions you can just log it let it go

347
00:28:28,570 --> 00:28:34,420
you can drop it like a rock and ore tell
anybody or in our case were actually

348
00:28:34,420 --> 00:28:38,809
redirecting it to something that we can
control so you know it seems kinda

349
00:28:38,809 --> 00:28:43,530
wasteful to just drop it if we can go
through it and get some detail for

350
00:28:43,530 --> 00:28:48,820
further analysis so because it's a still
is on file at its core we can leverage

351
00:28:48,820 --> 00:28:53,880
all the stuff that you get for free
again from the smart guys that I see so

352
00:28:53,880 --> 00:28:58,910
we get zone transfers we get the ability
to rap easy else around it and tie them

353
00:28:58,910 --> 00:29:03,240
to specific IP's and ports and we can
even sign that transfer with the

354
00:29:03,240 --> 00:29:05,190
cryptographic hash so

355
00:29:05,190 --> 00:29:09,330
pretty confident that you're getting
that notification from the genuine

356
00:29:09,330 --> 00:29:16,800
master server not a bad one so that was
part of this concern it's really good

357
00:29:16,800 --> 00:29:21,650
it's really fast it'll redirect you to
somebody else right away as the bad guy

358
00:29:21,650 --> 00:29:26,520
gets a hold of your list well thank you
for playing along you just sped up the

359
00:29:26,520 --> 00:29:32,380
attack so this list Hegarty becomes a
very important thing there are few

360
00:29:32,380 --> 00:29:36,600
commercial services out there that offer
the stuff in our view thread in tel

361
00:29:36,600 --> 00:29:41,760
aviv's an RPC for met when I looked into
it looked like was geared more towards

362
00:29:41,760 --> 00:29:44,340
large providers and not so much

363
00:29:44,340 --> 00:29:49,970
small one man to man three women armies
you know it's great to see some women in

364
00:29:49,970 --> 00:29:56,080
these toxins and I think this is a test
to see women insecurity about time we

365
00:29:56,080 --> 00:30:03,530
need all points of view but if you're
curious about the commercial stuff that

366
00:30:03,530 --> 00:30:14,850
s an SRP o.k so when you look at as our
PCs on file its pretty pretty

367
00:30:14,850 --> 00:30:18,890
conventional you did this this is pretty
cool you can shoot at the back of the

368
00:30:18,890 --> 00:30:19,730
screen

369
00:30:19,730 --> 00:30:26,960
alright who knew science science rocks
ok so that stuff at the top if you've

370
00:30:26,960 --> 00:30:31,200
ever worked with DNS that's your
standard time live origin statements and

371
00:30:31,200 --> 00:30:36,040
all the rest but unlike the conventional
guidance you're gonna find out how to

372
00:30:36,040 --> 00:30:41,390
build a single when you'd normally build
it and claim authority and that song

373
00:30:41,390 --> 00:30:46,100
file statement that's fine dreams on
master you have to declare every single

374
00:30:46,100 --> 00:30:50,810
authoritative song even if they're all
pointing to the same darn going nowhere

375
00:30:50,810 --> 00:30:52,290
file

376
00:30:52,290 --> 00:30:59,730
well that's great if you got two dozen
but try to it with 13,000 ok five

377
00:30:59,730 --> 00:31:06,420
minutes later find highly reloads using
RPC it takes a few seconds to reload and

378
00:31:06,420 --> 00:31:10,460
the cut another technology that we
didn't even go down because it was good

379
00:31:10,460 --> 00:31:14,120
enough it's called mapping they're
saying that will scale out into the

380
00:31:14,120 --> 00:31:18,790
billions so you could probably extend
this to do funky things like

381
00:31:18,790 --> 00:31:23,000
not just bad domains but how about
websites that I don't want people going

382
00:31:23,000 --> 00:31:25,120
there's open source

383
00:31:25,120 --> 00:31:28,930
adult content that stuff that you can
throw in here square boxes you could

384
00:31:28,930 --> 00:31:33,720
probably cut that down and fired in here
maybe even send them to a secondary

385
00:31:33,720 --> 00:31:37,650
server that says yeah you shouldn't be
here but we're not going to come visit

386
00:31:37,650 --> 00:31:46,500
your desk or work they do

387
00:31:46,500 --> 00:31:55,370
never walked a few people out ok so
regardless of how you're in point gets

388
00:31:55,370 --> 00:32:00,480
directed their PR team needs the
information about that event to divine

389
00:32:00,480 --> 00:32:04,830
the severity of the event again back to
these elusive security metrics but

390
00:32:04,830 --> 00:32:10,580
sampling it down to users making a
hundred connections too bad places is

391
00:32:10,580 --> 00:32:15,850
vastly different in my opinion that a
hundred users making connections that

392
00:32:15,850 --> 00:32:23,260
places as well that's my opinion I'm
pretty sure I saw some heads nodding so

393
00:32:23,260 --> 00:32:27,800
I think we're there but if you've got a
tool that simply can't connections too

394
00:32:27,800 --> 00:32:32,170
bad place so I've got two hundred the
sky's falling let's get a 71 ticket

395
00:32:32,170 --> 00:32:35,760
going you could be spending a lot of
cycles chasing down to people with that

396
00:32:35,760 --> 00:32:40,790
Sheen's and conversely you could say
it's only 200 resetter threshold the

397
00:32:40,790 --> 00:32:44,160
2007 bad guys only called twice a day

398
00:32:44,160 --> 00:32:48,570
you have a hundred people infected but
was under the metrics over good happy

399
00:32:48,570 --> 00:32:54,000
for you know we need that extra insight
like added mentioned you got to do the

400
00:32:54,000 --> 00:32:58,720
analysis are the numbers so this gives
you that canary server legacy it

401
00:32:58,720 --> 00:33:04,170
captures everything we saw in web page
so even if the user's didn't report go

402
00:33:04,170 --> 00:33:11,700
back so one of the things that I like
about this was with the elasticsearch in

403
00:33:11,700 --> 00:33:18,500
the log / underpinnings we built a
parser to take this flat ugly RPC log

404
00:33:18,500 --> 00:33:23,500
comes up fine they made us the tools
they didn't say it's going to be pretty

405
00:33:23,500 --> 00:33:30,740
saw the log is not friendly us and we
were able to take the build a

406
00:33:30,740 --> 00:33:35,870
are certain breeds this stuff and breaks
out elements that we found interesting

407
00:33:35,870 --> 00:33:40,500
and you can convert them into
visualization so again the concept of

408
00:33:40,500 --> 00:33:46,300
using a bind you do says I can say if
you come from that IP address

409
00:33:46,300 --> 00:33:50,940
you're coming from Michigan and if
you're coming from that IP address here

410
00:33:50,940 --> 00:33:56,150
coming from the Ontario office and that
address that's the Denver offers lots of

411
00:33:56,150 --> 00:34:00,990
people are small shops and you're
responsible for three or four locations

412
00:34:00,990 --> 00:34:06,960
well this allows you to say where it
happens so that middle middle blue thing

413
00:34:06,960 --> 00:34:11,220
in the doughnut there the middle blue
line says this actually only happen if

414
00:34:11,220 --> 00:34:15,240
one spot so good I'm not looking at the
other two it only happened in Denver

415
00:34:15,240 --> 00:34:22,659
Post Denver people we're just not
getting through the universe like

416
00:34:22,659 --> 00:34:32,000
Calgary actually just a snowy try but
then you look at the DEC string around

417
00:34:32,000 --> 00:34:37,060
there where we've got all these
different little slices that shows that

418
00:34:37,060 --> 00:34:43,679
they were asking for individual domains
not a hundred request to the same domain

419
00:34:43,679 --> 00:34:48,190
but our request hundred different
domains so now we're probably dealing

420
00:34:48,190 --> 00:34:51,850
with something that's using some kind of
domain generating hour or something like

421
00:34:51,850 --> 00:34:52,830
that

422
00:34:52,830 --> 00:34:56,389
the charts and graphs are good they keep
the management happy you know you must

423
00:34:56,389 --> 00:35:00,190
be working hard look at all those
numbers but when you're the analyst

424
00:35:00,190 --> 00:35:04,540
you're gonna have to drill down to
single events and if you've ever work

425
00:35:04,540 --> 00:35:09,540
was longer ArcSight a lot of these other
tools this is you know cabanas just like

426
00:35:09,540 --> 00:35:14,280
that you know even make it must be
mandatory that those bars in the middle

427
00:35:14,280 --> 00:35:20,880
or green or blue that seems to be the
only colors they come in and again we

428
00:35:20,880 --> 00:35:25,980
built parsers out because commanded as
pretty good with tax and stuff like that

429
00:35:25,980 --> 00:35:31,230
but log data your mileage may vary and
we are funding was doing weird things

430
00:35:31,230 --> 00:35:35,840
and truncating stuff reports are looking
weird so we actually had the build-out

431
00:35:35,840 --> 00:35:42,290
custom harvesters but we've done it for
passive uns uns RPZ and the nice thing

432
00:35:42,290 --> 00:35:43,490
is that all these little

433
00:35:43,490 --> 00:35:48,020
elements like the IP addresses of the
authoritative name servers and the

434
00:35:48,020 --> 00:35:53,010
actual domain name and the answers are
all that they're broken out the type of

435
00:35:53,010 --> 00:35:57,630
DNS query was it attacks cause of a
CNAME those can all be used

436
00:35:57,630 --> 00:36:02,570
sets a breakout of you so instead of
looking at a row log or worse

437
00:36:02,570 --> 00:36:07,660
logging on to three or four name servers
and cat all-out typing at the auction

438
00:36:07,660 --> 00:36:13,580
said I think that's cool but it really
is to take all of that and now you gotta

439
00:36:13,580 --> 00:36:18,950
suck at all that this is all in one view
and it's fast and again we just don't

440
00:36:18,950 --> 00:36:24,020
have time to do a lot of stuff so we can
come to that conclusion real fast that

441
00:36:24,020 --> 00:36:29,869
it's not a big deal ur my goodness
that's where we've got that so we think

442
00:36:29,869 --> 00:36:34,670
we've covered off a fair bit they're so
close to that just jump into the

443
00:36:34,670 --> 00:36:41,170
reporting so the reporting side of
things again for the console recusing

444
00:36:41,170 --> 00:36:46,340
cabana with elastic search in lockstep
to go ahead and parts of but at some

445
00:36:46,340 --> 00:36:50,960
point all of your data and up in an
Excel spreadsheet I think that's just

446
00:36:50,960 --> 00:36:54,810
sort of par for the course so it's
really important to be able to talk that

447
00:36:54,810 --> 00:37:00,900
day too early so we did again can you
tell we're not web developers this is

448
00:37:00,900 --> 00:37:04,560
sort of the best we could do if
anybody's willing to take rocket making

449
00:37:04,560 --> 00:37:13,130
it look nicer have full features come
see us we may see if anyone wants

450
00:37:13,130 --> 00:37:18,840
exposure so in this area you can see a
daily report get stomped and these are

451
00:37:18,840 --> 00:37:22,200
all of the domains that had been
accessed accounts everything like that

452
00:37:22,200 --> 00:37:26,250
and you can actually just go ahead and
download that I'm sorry to a CSV file

453
00:37:26,250 --> 00:37:29,700
actually looks pretty easy to work with
so we can see the top to Google and

454
00:37:29,700 --> 00:37:30,609
Facebook

455
00:37:30,609 --> 00:37:34,170
we don't really care too much about
those maybe from a productivity

456
00:37:34,170 --> 00:37:38,010
standpoint but that's not what we're
here to do the column and determines how

457
00:37:38,010 --> 00:37:42,280
many times those domains were accessed
and then calling see will tell you the

458
00:37:42,280 --> 00:37:47,380
type of request that were made and then
call Andy will tell you how many times

459
00:37:47,380 --> 00:37:51,590
it's been requested the last 10 days and
you will finally tell you when the first

460
00:37:51,590 --> 00:37:56,900
request started showing up so the first
two are not particularly interested in

461
00:37:56,900 --> 00:38:01,160
so we can likely ignore that but just
before 2 dot ca

462
00:38:01,160 --> 00:38:04,710
well that's kinda curious because we're
seeing an awful lot of weird DNS traffic

463
00:38:04,710 --> 00:38:10,580
happen a whole lot and it's only really
been accessed very small amount in the

464
00:38:10,580 --> 00:38:18,430
last 10 days so maybe take a guess of
why that might be a bad thing that's

465
00:38:18,430 --> 00:38:23,600
early Sunday morning I i get it it's
essentially a covert channel is what was

466
00:38:23,600 --> 00:38:26,319
created here now this is all for the
purposes of testing this was done on

467
00:38:26,320 --> 00:38:30,020
purpose but we start to see a lot of
this weirdness traffic going out of our

468
00:38:30,020 --> 00:38:34,170
environment and that point some red flag
should be going up and some

469
00:38:34,170 --> 00:38:43,880
investigation should take place so it
seems like murphy's law when you're in

470
00:38:43,880 --> 00:38:46,910
the middle of an incident that's when
you find out you don't have all the

471
00:38:46,910 --> 00:38:53,060
events coming from the event source or
more likely yeah that hasn't worked for

472
00:38:53,060 --> 00:39:00,580
about six weeks so you got no logs at
all so I think what when we commissioned

473
00:39:00,580 --> 00:39:05,210
stuff sometimes we actually take that
final step and actually validate that it

474
00:39:05,210 --> 00:39:09,760
works as intended you know run and map
and he might yes we're all set it apart

475
00:39:09,760 --> 00:39:16,240
skin next but we never go back and check
so you know they have fire drills in

476
00:39:16,240 --> 00:39:20,310
large buildings couple of times a year
to make sure that the alarms went off

477
00:39:20,310 --> 00:39:24,190
and people knew that that's where the
exit was and stuff we should be doing

478
00:39:24,190 --> 00:39:28,980
the same sort of thing so came up with
this concept up we need to first I

479
00:39:28,980 --> 00:39:34,360
needed to replicate a covert channel so
I installed Ron votes from school

480
00:39:34,360 --> 00:39:38,590
securities DNS cut to interest earned it
lives but also wanted to make sure my

481
00:39:38,590 --> 00:39:43,230
RPC stuff was working right with a
domain generating algorithm so I wrote

482
00:39:43,230 --> 00:39:48,870
one kinda cool you go hey we can text
till they do with this to hey we put in

483
00:39:48,870 --> 00:39:54,460
your circle thing and get creative about
stuff that you could do with a leading

484
00:39:54,460 --> 00:39:58,610
traffic that simulates what an
attacker's kind of red teaming your own

485
00:39:58,610 --> 00:40:03,890
stuff with your own data and now you can
start writing reports and maybe even

486
00:40:03,890 --> 00:40:09,780
triggering alarms based on ya if that
ever happens somebody's up to this

487
00:40:09,780 --> 00:40:15,530
we want to know about that well since
you wrote it in a script can run that

488
00:40:15,530 --> 00:40:20,500
again next quarter make sure the alarm
still goes up if you're really nasty you

489
00:40:20,500 --> 00:40:24,290
could actually tester blue team and see
if they actually respond to the alarm

490
00:40:24,290 --> 00:40:29,790
going since it's probably the one man
are two-person army is not a lot of

491
00:40:29,790 --> 00:40:38,580
sport yeah yeah that's quite the same
americorps so how this works underneath

492
00:40:38,580 --> 00:40:43,590
the magic happens here but clouds so
you're Bossa believe that that's how

493
00:40:43,590 --> 00:40:48,040
great this was supposed to be a simple
little thing called and I think we've

494
00:40:48,040 --> 00:40:52,510
got seven or eight boxes going here so
it got a little out of hand but the

495
00:40:52,510 --> 00:40:57,130
point of building this out in a very big
distributed matter was to make sure that

496
00:40:57,130 --> 00:41:02,570
it could cause more than a few times
I've seen outside the work OK on one box

497
00:41:02,570 --> 00:41:06,590
but the minute you start to spread
things out things start to fail right so

498
00:41:06,590 --> 00:41:13,060
it's all in the white paper on which
boxes do what essentially we're getting

499
00:41:13,060 --> 00:41:18,910
passive uns other the horrors got word
DNS coming out of use recursive notes

500
00:41:18,910 --> 00:41:23,960
and is AJ mention because we've got so
many almost nothing will break but the

501
00:41:23,960 --> 00:41:29,300
easy part that we don't really get to
year is all you gotta do to turn this on

502
00:41:29,300 --> 00:41:33,810
in your environment is going to your
Active Directory domain controllers and

503
00:41:33,810 --> 00:41:38,620
say by the way instead of forwarding all
your DNS requests out to a local ISP

504
00:41:38,620 --> 00:41:43,930
what you've been doing for years senator
to these boxes that I can if it doesn't

505
00:41:43,930 --> 00:41:48,800
work send it back to the home plate and
nobody's the wiser you want to try it

506
00:41:48,800 --> 00:41:53,000
with 180 because you've got six you just
want to do a soft launch see what you

507
00:41:53,000 --> 00:41:58,480
get there you go you can keep an eye on
the same scale up scale backwards it's

508
00:41:58,480 --> 00:42:04,750
all built on clout so you know you don't
need to get the network guys or anything

509
00:42:04,750 --> 00:42:08,900
involved and clouds kind of expensive
but the one thing that is cool did you

510
00:42:08,900 --> 00:42:14,510
get your internet for free so you've got
public IP addresses and lots of

511
00:42:14,510 --> 00:42:18,530
bandwidth and no grappling with the
network team so it's actually kind of

512
00:42:18,530 --> 00:42:19,330
useful

513
00:42:19,330 --> 00:42:26,620
so if you want to build her own there's
a lot to do this but it was difficult to

514
00:42:26,620 --> 00:42:33,270
pull this off so as I was going through
this is this is this is awkward so what

515
00:42:33,270 --> 00:42:37,320
we did was we built how to get repo that
has all of the different components

516
00:42:37,320 --> 00:42:43,970
built out so that you run menus scripts
things like that and you'll build out

517
00:42:43,970 --> 00:42:52,320
the various elements and I'm not sure
actually gonna get demo it's pretty

518
00:42:52,320 --> 00:43:00,110
straight up you log in and it'll draw
down various tools in a folder see

519
00:43:00,110 --> 00:43:04,390
everything that's there built out
probably got about 25 30 different

520
00:43:04,390 --> 00:43:10,540
programs and scripts and we're working
on man you got a buddy back home who's

521
00:43:10,540 --> 00:43:15,470
exceptionally good at finding the one
input value that you never would have

522
00:43:15,470 --> 00:43:20,850
thought anybody put in your stuff so
gonna let him blow it all up again from

523
00:43:20,850 --> 00:43:26,550
scratch and then we'll go forward and
put together the full blown cookbook so

524
00:43:26,550 --> 00:43:33,620
area so just just everybody knows we
will make this presentation available

525
00:43:33,620 --> 00:43:39,370
including the demo on the menu driven
programming works it will be uploaded to

526
00:43:39,370 --> 00:43:45,390
our marketing web page after this so we
just didn't want to tip her hand we like

527
00:43:45,390 --> 00:43:49,840
surprises too so the design summary
essentially with this is designed to

528
00:43:49,840 --> 00:43:54,700
bridge gaps between your identification
and your containment strategies during

529
00:43:54,700 --> 00:43:58,750
incident response whichever methodology
you subscribe to there's always a stupor

530
00:43:58,750 --> 00:44:03,540
steps the idea here's it's the sort of
clothes that and make things a little

531
00:44:03,540 --> 00:44:07,830
bit easier for you because it's
leveraging open-source cloud-based

532
00:44:07,830 --> 00:44:12,220
infrastructure you can do it however you
want if you prefer to use a different

533
00:44:12,220 --> 00:44:18,410
brand of no sequel to your boots if you
aren't super fun of engine X building on

534
00:44:18,410 --> 00:44:21,650
left if you have a lot of Microsoft
licenses do whatever you'd like to do

535
00:44:21,650 --> 00:44:26,170
that so it's really flexible in that
sense and we're providing you the code

536
00:44:26,170 --> 00:44:30,470
in the ability to start building this on
your own and we'll make it available if

537
00:44:30,470 --> 00:44:31,740
you want to connect to

538
00:44:31,740 --> 00:44:37,540
our version of it it's also enough so
we're pretty flexible I feel like in

539
00:44:37,540 --> 00:44:41,920
another life if I was easier and more
intelligent while he would have been my

540
00:44:41,920 --> 00:44:47,790
spirit animal I really really identify
with him in a sense that if I really

541
00:44:47,790 --> 00:44:51,820
didn't care about my job in whatever way
we do it I would probably really embody

542
00:44:51,820 --> 00:44:56,450
everything he's doing we get it or not
cause him not everybody's in favor of

543
00:44:56,450 --> 00:44:59,890
putting all their information in the
data center they don't control it makes

544
00:44:59,890 --> 00:45:00,970
perfect sense

545
00:45:00,970 --> 00:45:05,720
despite all that we're still not quite
sure we get it to view this as you can

546
00:45:05,720 --> 00:45:08,240
stand it up inside your own
infrastructure you can put it all on a

547
00:45:08,240 --> 00:45:12,369
single physical server if you really
want to but the idea was we wanted to

548
00:45:12,369 --> 00:45:17,210
make it distributed highly available and
easier to access without costing a lot

549
00:45:17,210 --> 00:45:22,670
of money or resources so that's why the
car camera but if you are really forced

550
00:45:22,670 --> 00:45:28,350
to stand up your recursion recursive
know it's an Indian see what your sack

551
00:45:28,350 --> 00:45:31,750
somewhere in your environment everything
phoning home through firewalls and

552
00:45:31,750 --> 00:45:37,100
everything you control up to you when I
leave the house I know I locked the door

553
00:45:37,100 --> 00:45:42,869
but I was working I hope I didn't forget
to lock the door and that's why I work

554
00:45:42,869 --> 00:45:47,070
from home now so that I don't have to
worry about that but throughout the

555
00:45:47,070 --> 00:45:51,300
whole software development lifecycle
security was really paramount we made

556
00:45:51,300 --> 00:45:55,000
sure that whatever we were developing
and releasing into the project was

557
00:45:55,000 --> 00:45:59,700
secure so it goes to show you that you
can develop anything in a secure manner

558
00:45:59,700 --> 00:46:03,190
full disclosure it did take longer
because we had to make sure things were

559
00:46:03,190 --> 00:46:07,460
secure first before uploading and
testing and this won't connect because

560
00:46:07,460 --> 00:46:13,930
of this weird we had those same issues
however it's a lot easier to do it and

561
00:46:13,930 --> 00:46:18,510
then implement it right away as opposed
to build it go home we didn't think

562
00:46:18,510 --> 00:46:21,810
about security have to read back to
square one securing all this and

563
00:46:21,810 --> 00:46:25,470
reaching all of your soccer so that it
works so in the end it doesn't up saving

564
00:46:25,470 --> 00:46:30,930
time doesn't mean it isn't + tree so how
do we keep consistency will like we said

565
00:46:30,930 --> 00:46:35,220
we haven't yet hope you can run up and
grab the scripts and speed up the new

566
00:46:35,220 --> 00:46:42,109
server before lunchtime and because it's
all scripted and semi-automated you're

567
00:46:42,109 --> 00:46:44,930
getting the same development

568
00:46:44,930 --> 00:46:51,300
same bills every time so as we meet
changers they get uploaded to get home

569
00:46:51,300 --> 00:46:56,790
and you can go ahead and they're so
monitoring overly quick we did think

570
00:46:56,790 --> 00:47:00,589
about monitoring infrastructure and
application layer used not just because

571
00:47:00,589 --> 00:47:05,010
we're cheap and it does Linux monitoring
quite well these are all Linux based

572
00:47:05,010 --> 00:47:10,040
environments so we wanted to make sure
that was well thought out the service

573
00:47:10,040 --> 00:47:13,380
this morning we're not gonna go over
this essentially each server has

574
00:47:13,380 --> 00:47:16,740
processes that have to be monitored
again will make this available so if you

575
00:47:16,740 --> 00:47:20,930
are standing up your own for some of the
stuff you pay attention to

576
00:47:20,930 --> 00:47:23,650
so infrastructure and procurement know
we have questions of why did you pick

577
00:47:23,650 --> 00:47:27,700
this technology and not that tackle you
know why did you go with elastics third

578
00:47:27,700 --> 00:47:32,809
elasticsearch instead of something else
well you pick technologies that are open

579
00:47:32,809 --> 00:47:37,780
source that have a good community and
have a good reputation so if it seems

580
00:47:37,780 --> 00:47:42,619
like technology doesn't really have a
lot of community are backing putting

581
00:47:42,619 --> 00:47:46,380
your eggs in that basket might be
dangerous if all the sudden nobody

582
00:47:46,380 --> 00:47:50,540
decides to know how to use it your all
of a sudden only guy who can maintain

583
00:47:50,540 --> 00:47:54,770
this thing three job security but it
also means you can move anywhere so we

584
00:47:54,770 --> 00:47:58,440
wanted to keep things really open source
with a lot of white community support

585
00:47:58,440 --> 00:48:03,980
the future planned out again because we
have to accelerate some developments

586
00:48:03,980 --> 00:48:07,150
things had to get dropped off so system
and application monitoring are quite

587
00:48:07,150 --> 00:48:13,339
still working on that web based menu
driven so instead of going into the

588
00:48:13,339 --> 00:48:17,760
command line and running your stuff we
like the command line but not everybody

589
00:48:17,760 --> 00:48:21,579
likes you can actually go right to web
page that were planning to build and

590
00:48:21,579 --> 00:48:27,490
hopefully make it look better than we
normally do and also can be used for

591
00:48:27,490 --> 00:48:31,809
file integrity monarchs that becomes
pretty important to maintain your file

592
00:48:31,809 --> 00:48:35,069
integrity your list integrity to know
that stuff isn't getting dropping the

593
00:48:35,069 --> 00:48:40,240
blacklist in the event that those
service get on an in-depth documentation

594
00:48:40,240 --> 00:48:40,910
again

595
00:48:40,910 --> 00:48:44,059
somethings had to get proper
documentation is always the first one to

596
00:48:44,059 --> 00:48:48,329
go so we have to really improve that
because we have now isn't really

597
00:48:48,329 --> 00:48:49,840
anything to write home about

598
00:48:49,840 --> 00:48:54,050
and we do have a public-facing wiki on
the way which will help with

599
00:48:54,050 --> 00:48:58,690
contributions so that'll be really
useful for other people who want to

600
00:48:58,690 --> 00:49:04,140
assist against open-source people can
help almost done here is the call to

601
00:49:04,140 --> 00:49:08,140
action we hope that MSPs and ISPs can
implement this as a service without

602
00:49:08,140 --> 00:49:13,430
adding extra cost to consumers are two
guys and a shock and we did this there's

603
00:49:13,430 --> 00:49:17,400
no reason why major telcos cannot do
this as a DNS service line item and

604
00:49:17,400 --> 00:49:20,770
frankly it could be for free because it
doesn't cost anything to build the

605
00:49:20,770 --> 00:49:26,220
maintenance is very cheap really nice n
Easy we need people for Dana now

606
00:49:26,220 --> 00:49:29,430
obviously can't connect to it but if
you're interested in partaking in a

607
00:49:29,430 --> 00:49:33,560
project in any way will have her contact
information to reach out we are

608
00:49:33,560 --> 00:49:37,660
interested in scaling up and seeing if
this really goes to 11 we envision it

609
00:49:37,660 --> 00:49:43,590
does not quite sure and frankly if
anybody has contributions things i would

610
00:49:43,590 --> 00:49:48,440
like to add you just all that stuff is
really useful really interested enough

611
00:49:48,440 --> 00:49:54,180
so any notes you can develop securely
anybody who says you can't think is

612
00:49:54,180 --> 00:49:58,220
lying to you in this is proof positive
because we develop security again

613
00:49:58,220 --> 00:50:03,010
frustrating but still you're open source
mileage may vary much fewer that

614
00:50:03,010 --> 00:50:07,480
obviously trying to help you any way you
can if you're standing us up on your own

615
00:50:07,480 --> 00:50:11,340
you running into some issues don't
hesitate to reach out and will be more

616
00:50:11,340 --> 00:50:16,770
than willing to help out some special
thanks to early in her continued love

617
00:50:16,770 --> 00:50:20,170
and support the curly-haired many cycles
we heard marcia for learning a lot of

618
00:50:20,170 --> 00:50:24,360
housework and a lot of other people in
our lives it really hope that this

619
00:50:24,360 --> 00:50:30,610
project on some of the attesting to
confer accepting are talking and

620
00:50:30,610 --> 00:50:34,030
accelerating our times faster than we
could have thought thank you for

621
00:50:34,030 --> 00:50:39,040
everybody for coming this was more than
I think any of us expected and really

622
00:50:39,040 --> 00:50:42,250
all the Greek researchers who helped
develop these solutions so that we can

623
00:50:42,250 --> 00:50:48,930
come together in turn it into a cohesive
unit and questions

624
00:50:48,930 --> 00:50:54,299
guy next to the clown what is that
that's that's awful

625
00:50:54,299 --> 00:51:09,900
training

626
00:51:09,900 --> 00:51:22,309
such a Kaiser

627
00:51:22,309 --> 00:51:37,299
yeah yeah yeah sorry so eighty obviously
is everywhere and if you've ever looked

628
00:51:37,299 --> 00:51:41,390
at a Windows Active Directory law gets
huge in full of all kinds of stuff about

629
00:51:41,390 --> 00:51:47,079
the local directory we wanted to slice
that 8022 get in the middle of that

630
00:51:47,079 --> 00:51:50,479
attack chain most of your attackers
hopefully we're going to have an Active

631
00:51:50,479 --> 00:51:55,009
Directory DNS record there on the
outside so this really just grabs the

632
00:51:55,009 --> 00:51:59,509
recursive stuff that leisure environment
and we took it there and push that back

633
00:51:59,509 --> 00:52:04,769
in that's how we get around it and we
use the source address of where that

634
00:52:04,769 --> 00:52:06,349
came from

635
00:52:06,349 --> 00:52:16,529
to push you back to the designated
canary server ok well thank you guys SO

636
00:52:16,529 --> 00:52:22,970
much for coming out and

637
00:52:22,970 --> 00:52:28,600
we we've got a new Twitter handle our
first tweet in a few minutes

