1
00:00:00,000 --> 00:00:19,420
ok so still clocking at started don't
wanna run over the next speaker this is

2
00:00:19,420 --> 00:00:25,380
my first talked a conference like this
very excited to be here and this is the

3
00:00:25,380 --> 00:00:29,599
human interface device attack better
research and development I'm Alex Eagle

4
00:00:29,599 --> 00:00:35,210
I came out here from California and some
people out in Texas who wanna don't jump

5
00:00:35,210 --> 00:00:39,920
to build a wall this way so I thought
that was kind of funny I just graduated

6
00:00:39,920 --> 00:00:42,399
with bachelors in computer science

7
00:00:42,399 --> 00:00:49,140
i'm looking for work that's my twitter
handle my email address my PGP key I did

8
00:00:49,140 --> 00:00:55,030
undergraduate research under Muhammad
Hussain at Cal Poly Pomona it's a pretty

9
00:00:55,030 --> 00:00:59,600
good school I really like it is
definitely best part about it the way I

10
00:00:59,600 --> 00:01:03,629
got into information security I wasn't
sure what I want to do with my degree

11
00:01:03,629 --> 00:01:07,200
initially I thought I was going to go to
law school after be a technological

12
00:01:07,200 --> 00:01:11,020
intellectual property lawyer but
Raytheon did a really really good talk

13
00:01:11,020 --> 00:01:16,040
to my school with some live Metasploit
demos and I was hooked right away so I

14
00:01:16,040 --> 00:01:20,659
went to black hat in 2013 and took Dave
kennedy's secret pen testing techniques

15
00:01:20,659 --> 00:01:26,530
class and it was a really great
experience we got to see some really

16
00:01:26,530 --> 00:01:27,409
cool stuff

17
00:01:27,409 --> 00:01:31,799
the binaries you teensy was great we did
the Java applet tack and things like

18
00:01:31,799 --> 00:01:32,700
that

19
00:01:32,700 --> 00:01:35,790
PowerShell injection is currently my
favorite technique but actually my

20
00:01:35,790 --> 00:01:39,689
favorite part of the class was that
PowerShell injection wasn't working he

21
00:01:39,689 --> 00:01:40,650
said it worked

22
00:01:40,650 --> 00:01:45,170
week before the class and then microsoft
did something that broke it through nine

23
00:01:45,170 --> 00:01:49,880
hours and he just took it as like a
personal offense and he fixed seven out

24
00:01:49,880 --> 00:01:54,009
of nine bucks over lunch time to step
away furiously typing through screens

25
00:01:54,009 --> 00:02:00,119
less and less less than right I just
thought that was so amazing this is a

26
00:02:00,119 --> 00:02:05,240
quote from Michael Western Burn Notice
says social show someone what they can't

27
00:02:05,240 --> 00:02:10,129
have to give it to them too easy and
they want appreciated the key is giving

28
00:02:10,129 --> 00:02:13,660
them just enough of a taste that all
they want is more that's a key concept

29
00:02:13,660 --> 00:02:16,599
and social engineering and also you know
I had that tastes and I was really

30
00:02:16,599 --> 00:02:22,400
hooked so one of the things I thought
was the coolest that he mentioned was

31
00:02:22,400 --> 00:02:27,250
the program will human interface device
Universal Serial Bus keyboard dongle

32
00:02:27,250 --> 00:02:32,800
engine caused it but for short he did a
really great talk on it and it uses a

33
00:02:32,800 --> 00:02:38,260
teensy Arduino board to emulate a mouse
or keyboard human interface device you

34
00:02:38,260 --> 00:02:41,060
gain arbitrary code execution on the
system

35
00:02:41,060 --> 00:02:45,090
see news out for bioenergy teensy
PowerShell injection you can write

36
00:02:45,090 --> 00:02:47,599
Cryptologic cabranes basically whatever
you want

37
00:02:47,599 --> 00:02:52,060
will run on the system as though the
user's typing these commands themselves

38
00:02:52,060 --> 00:02:57,879
so some people like to do more noisy
things some people like to do more

39
00:02:57,879 --> 00:03:03,360
silence stuff and I'm a big fan of
silent intelligence-gathering have a

40
00:03:03,360 --> 00:03:07,760
friend who was a big fan of the sr-71
for a long long time

41
00:03:07,760 --> 00:03:10,519
went to work for northrup and he was
like you know if you think about it

42
00:03:10,519 --> 00:03:16,330
sr-71 is it's just a big flying camera
as like while the you too you know it

43
00:03:16,330 --> 00:03:20,709
spotted the nuclear missiles going up in
cuba before their operational and

44
00:03:20,709 --> 00:03:26,200
there's no sort of you know attack after
the fact after setup that can how way

45
00:03:26,200 --> 00:03:29,959
that intelligence gathering in advance
so right now you hear a lot of talks

46
00:03:29,959 --> 00:03:33,840
about people maintaining persistence and
networks for years and knowing what your

47
00:03:33,840 --> 00:03:37,720
enemy is gonna do before they do it
consistently i think is the best

48
00:03:37,720 --> 00:03:43,739
possible outcome of the stack so why
some say using human interface device

49
00:03:43,739 --> 00:03:48,840
there are a lot of different ways to get
in I do it because I just think it's the

50
00:03:48,840 --> 00:03:54,150
coolest Abraham Maslow is a psychologist
who's come up with a lot of cool stuff

51
00:03:54,150 --> 00:03:58,349
and he has this concept of self
actualization not everyone has their own

52
00:03:58,349 --> 00:04:02,650
in a in her talent and

53
00:04:02,650 --> 00:04:08,849
fulfilling that goal is the ultimate way
to achieve happiness as a human being to

54
00:04:08,849 --> 00:04:13,430
Dave Kennedy says sometimes in Prentiss
you only get one shot so if you're

55
00:04:13,430 --> 00:04:17,060
trying to establish a foothold need you
like a bad phishing email with broken

56
00:04:17,060 --> 00:04:20,669
English or something like that sometimes
I will put people on alert and it's

57
00:04:20,669 --> 00:04:26,350
harder to get in and so one of the
things he mentioned at this talk is that

58
00:04:26,350 --> 00:04:30,940
they sent out three keyboards and they
got nine shells back because they bought

59
00:04:30,940 --> 00:04:37,460
the fanciest keyboards they could find
put teens and sent them out and not only

60
00:04:37,460 --> 00:04:42,360
did I T department staff who sent them
to plug them in thinking they'd won a

61
00:04:42,360 --> 00:04:47,430
survey they'd never entered in but other
people would take these keyboards and

62
00:04:47,430 --> 00:04:51,479
plug them into their own computers just
because you have flashlights are cool

63
00:04:51,479 --> 00:04:57,250
and so they got more shells back then
keyboards they sent out so normally a

64
00:04:57,250 --> 00:05:01,580
300 percent success rates pretty good
the sky had a 300 percent failure rate

65
00:05:01,580 --> 00:05:08,889
is a doctor who managed to kill three
people to amputation so the main reason

66
00:05:08,889 --> 00:05:13,990
you'd use any sort of social engineer
attack is humans Chris and Dave say that

67
00:05:13,990 --> 00:05:18,930
humans are the eight-player the OSI
model and the most vulnerable and you'll

68
00:05:18,930 --> 00:05:24,340
see consistently that systems are
getting hard and people are generally

69
00:05:24,340 --> 00:05:30,520
remain the same so these are too kind of
chemical facts that I think a really

70
00:05:30,520 --> 00:05:34,810
interesting because it's important to
remember that humans no matter how smart

71
00:05:34,810 --> 00:05:39,370
are educated you are you still have the
same chemicals in your brain as everyone

72
00:05:39,370 --> 00:05:45,180
else so dave is a huge fan of hugs and
hugs that lasts over 20 seconds it will

73
00:05:45,180 --> 00:05:50,340
release oxytocin in your brain which
some people call the cuddle chemical and

74
00:05:50,340 --> 00:05:55,030
will not really trust this person more
and feel you know closer to them and

75
00:05:55,030 --> 00:05:57,840
then this is something i think is really
interesting which is actually the

76
00:05:57,840 --> 00:06:04,360
molecular structure structure of tears
are different based on wire crying

77
00:06:04,360 --> 00:06:11,210
so there are two ways to be fooled one
has to believe what isn't true and the

78
00:06:11,210 --> 00:06:16,860
others refused to accept what is true
and so I think in a lot of social

79
00:06:16,860 --> 00:06:21,219
engineering attacks in the high retire
the academic lab lot of people say

80
00:06:21,219 --> 00:06:25,979
default nine but one of the stories that
I found really interesting is there is a

81
00:06:25,979 --> 00:06:28,889
girl who's working the front desk at a
hotel

82
00:06:28,889 --> 00:06:34,150
second year in college hrt you know just
trying to get some experience and

83
00:06:34,150 --> 00:06:39,000
paycheck and this guy comes in and he
says I'm Regional Sales manner

84
00:06:39,000 --> 00:06:43,330
manager for the hotel I need to get you
need to get your manager and one speak

85
00:06:43,330 --> 00:06:47,379
with him and the hotel had a policy that
one person always had to be at the front

86
00:06:47,379 --> 00:06:49,289
desk to answer the phone

87
00:06:49,289 --> 00:06:54,240
obviously our situation and monitor to
the computer and so she said no I can't

88
00:06:54,240 --> 00:06:57,729
do that I have to stay here and he was
like you don't get your manager right

89
00:06:57,729 --> 00:07:03,930
now I'm gonna get you fired and she was
like sorry I can't and he basically went

90
00:07:03,930 --> 00:07:10,750
to the president hotel chain is like if
you don't fire this you know pay by the

91
00:07:10,750 --> 00:07:14,199
hour employee I'm gonna quit and was one
of those people who the keynote speaker

92
00:07:14,199 --> 00:07:18,500
is talking about it was really valuable
because of his connections and so they

93
00:07:18,500 --> 00:07:22,479
could lose potentially millions of
dollars in conference contracts and

94
00:07:22,479 --> 00:07:27,339
possibly even like a celebrity boycott
on LA which horrible so she got fired

95
00:07:27,339 --> 00:07:31,310
that's one of those situations where
doing the right thing falling company

96
00:07:31,310 --> 00:07:35,889
policy and you know not just believing
what she was told didn't work out for

97
00:07:35,889 --> 00:07:41,889
her so a lot of times as Manchester's
hackers social engineers we don't see

98
00:07:41,889 --> 00:07:48,800
the scenario we're not believing what
we're saying works out very poorly if it

99
00:07:48,800 --> 00:07:51,629
had been a penthouse or something like
that she probably still would have kept

100
00:07:51,629 --> 00:07:55,560
her job and it wouldn't hurt as much as
not listen this guy who actually was the

101
00:07:55,560 --> 00:08:02,270
Regional Sales Manager this is another
it's a quote from Patrick Rothfuss who

102
00:08:02,270 --> 00:08:06,469
wrote the killer Chronicles and they're
great set of books and he said too much

103
00:08:06,469 --> 00:08:11,560
truth confuses facts too much honesty
makes you sound insincere at something I

104
00:08:11,560 --> 00:08:15,229
really believe if you tell the whole
truth and nothing but the truth all the

105
00:08:15,229 --> 00:08:17,449
time people are less likely to believe
you

106
00:08:17,449 --> 00:08:23,360
then if you catch the truth haha true
soul I mark twain's it's easier for

107
00:08:23,360 --> 00:08:27,249
people then convince them they have been
fooled there are plenty of people who

108
00:08:27,249 --> 00:08:31,629
will plug back toward mouse or keyboard
into their computer no problem won't

109
00:08:31,629 --> 00:08:35,880
believe that mice and keyboards are
back-door I've actually got into

110
00:08:35,880 --> 00:08:39,870
arguments with people who are graduating
computer science Ruiz who will tell me

111
00:08:39,870 --> 00:08:42,289
and I'm sure that all of you

112
00:08:42,289 --> 00:08:49,820
microsoft office file formats are always
safe to open henry's rule is that anyone

113
00:08:49,820 --> 00:08:53,990
is willing to give you something for
whatever it is they're hungry for so in

114
00:08:53,990 --> 00:08:57,120
order to get some to accept this mouse
or keyboard a lot of times are trying to

115
00:08:57,120 --> 00:09:01,660
figure out you know makes them tick and
how you can get them to accept this

116
00:09:01,660 --> 00:09:09,110
device and so Abraham Maslow the
psychiatrist I quoted earlier he has

117
00:09:09,110 --> 00:09:16,300
this pyramid of needs and so the bottom
forty calls deficiency needs and the top

118
00:09:16,300 --> 00:09:21,730
one is the concept of self actualization
I mentioned earlier we're kind of doing

119
00:09:21,730 --> 00:09:26,490
your life's purpose is what gives you
ultimate fulfillment and so if you can

120
00:09:26,490 --> 00:09:31,850
find any one of these needs that's not
being met by an employee it's a lot

121
00:09:31,850 --> 00:09:36,110
easier to manipulate them there are a
lot of companies who barely meet the

122
00:09:36,110 --> 00:09:40,529
bottom two needs and almost no company
has any sort of emphasis on helping

123
00:09:40,529 --> 00:09:45,500
their employees achieve self
actualization so it's my opinion that

124
00:09:45,500 --> 00:09:48,819
most people they really don't care that
much about what happens to their company

125
00:09:48,819 --> 00:09:55,970
this is a little bit more elaborated
hierarchy of needs but I'll start was

126
00:09:55,970 --> 00:10:00,699
really funny because you had WiFi the
bottom is like a basic human need now

127
00:10:00,699 --> 00:10:04,639
and of course when I move into a new
apartment I don't always run a wireless

128
00:10:04,639 --> 00:10:08,420
network but the first thing I setup the
router keyboard and I spent a few hours

129
00:10:08,420 --> 00:10:15,290
just not doing anything else relax and
putting all my stuff inside and so you

130
00:10:15,290 --> 00:10:18,850
know there are increasingly companies
that will offer WiFi in the lobby and

131
00:10:18,850 --> 00:10:23,720
things like that and you know if you
don't let them access your wireless

132
00:10:23,720 --> 00:10:27,220
network they'll act like you know you
didnt denied a starving man food

133
00:10:27,220 --> 00:10:33,740
so this is a tweet by someone where they
said they had to target employee if they

134
00:10:33,740 --> 00:10:37,970
can open a camera before they buy it he
said he wouldn't care if they killed

135
00:10:37,970 --> 00:10:42,089
someone in front of them and I think
that's really standard for a lot of

136
00:10:42,089 --> 00:10:47,009
companies there are several you know
people I know who work at the fence

137
00:10:47,009 --> 00:10:50,839
contractors and things like that and
their stances you know I'm here I'm

138
00:10:50,839 --> 00:10:54,550
doing my job its corporate environment I
don't really like it and they could care

139
00:10:54,550 --> 00:11:00,939
less if I got hit by a bus so this i
think is a good example I don't know if

140
00:11:00,939 --> 00:11:07,170
you guys know that the whammy gain there
is a guy who figure out the pattern and

141
00:11:07,170 --> 00:11:11,110
he basically what I think something like
a hundred and twenty four thousand

142
00:11:11,110 --> 00:11:15,959
dollars or something like that in a time
when the average winnings $14,000 but I

143
00:11:15,959 --> 00:11:20,420
think it's really interesting that they
noted that the show's contestants

144
00:11:20,420 --> 00:11:24,649
supervise the one who normally selects
which contestants go on and which don't

145
00:11:24,649 --> 00:11:28,050
he didn't get a good feeling from the
skies we didn't want to put on a show

146
00:11:28,050 --> 00:11:34,000
and his boss overruled him so it's
important to kind of trust your

147
00:11:34,000 --> 00:11:38,449
instincts Chris had Maggie says a lot of
times when you feel that this question

148
00:11:38,449 --> 00:11:41,420
about someone you can't really put your
finger on its because what they're

149
00:11:41,420 --> 00:11:47,309
saying doesn't match their body language
and then also this guy in the future

150
00:11:47,309 --> 00:11:50,389
he'll probably be more like leaders put
someone on the show so he doesn't get

151
00:11:50,389 --> 00:11:56,000
overruled by his boss can I can be
embarrassing this guy is someone who's

152
00:11:56,000 --> 00:12:00,449
not in the security industry and he's a
true no scam artists but I think he ran

153
00:12:00,449 --> 00:12:05,029
one of the most interesting social
enduring scams you want to call it that

154
00:12:05,029 --> 00:12:12,240
he started a self-defense cool and said
he was an ex-navy seal he had discharge

155
00:12:12,240 --> 00:12:17,319
papers that listed among the awards to
medal of honors which hasn't happened

156
00:12:17,319 --> 00:12:22,149
since world war one is pretty easy to
verify that hasn't but this lady our

157
00:12:22,149 --> 00:12:27,870
Roberts who was a Navy vet didn't even
think to verify that she quit her job to

158
00:12:27,870 --> 00:12:32,639
doctors gave him a hundred and fifty
thousand dollars to start a private

159
00:12:32,639 --> 00:12:34,510
military contracts

160
00:12:34,510 --> 00:12:41,700
contracting company with them and nobody
was suspicious until he said that he had

161
00:12:41,700 --> 00:12:46,590
a contract guarding a construction site
in burundi and they traveled out there

162
00:12:46,590 --> 00:12:50,800
and then he started acting like he's
never been in a war zone before so does

163
00:12:50,800 --> 00:12:55,850
anyone wanna give me $1,000,000 and come
to South Sudan with me I think that

164
00:12:55,850 --> 00:13:00,660
would probably be the worst situation
realize you've been modest camera on you

165
00:13:00,660 --> 00:13:04,710
is when your actual real physical danger
and one of the worst places in the world

166
00:13:04,710 --> 00:13:12,710
in a simple Wikipedia search would have
saved them from doing that but people

167
00:13:12,710 --> 00:13:19,460
they don't verify they trust they don't
verify so kevin Mitnick says all anyone

168
00:13:19,460 --> 00:13:22,820
needs to do is set up a website selling
product at twenty percent of market

169
00:13:22,820 --> 00:13:26,850
price and people are going to be tricked
in writing the credit card numbers so

170
00:13:26,850 --> 00:13:31,750
that is kind of the lowest hanging fruit
and I recommend using the HID attack

171
00:13:31,750 --> 00:13:37,460
vector a little bit higher hang through
this is something I thought that was

172
00:13:37,460 --> 00:13:40,540
really interesting and that the
government put out a bunch security

173
00:13:40,540 --> 00:13:45,700
videos they use mitnick in the video and
they just they covered his eyes and they

174
00:13:45,700 --> 00:13:52,070
didn't alter his voice at all so
instantly recognizable who it is I saw

175
00:13:52,070 --> 00:13:55,860
anyone who wants to use the computer
they need some way to interface with

176
00:13:55,860 --> 00:14:00,880
computer mouse keyboard joystick
whatever this kind of funny and it

177
00:14:00,880 --> 00:14:06,170
doesn't find the keyboard and tells you
to press keys you know to continue so

178
00:14:06,170 --> 00:14:10,740
anyone who doesn't have a working
keyboard or if it's broken or even a few

179
00:14:10,740 --> 00:14:17,380
more flashing lights ninety percent of
time they're gonna plug it in one thing

180
00:14:17,380 --> 00:14:21,670
about social engineering entire
profiling so this says once brush fire

181
00:14:21,670 --> 00:14:25,140
was kidnapped and taken out the country
is kidnappers got picked up and charged

182
00:14:25,140 --> 00:14:30,290
with violation abuse cryptography export
lots and these are two tweets by Chris

183
00:14:30,290 --> 00:14:34,560
Dickerson who is on the panel recently
people have been trying to run scams on

184
00:14:34,560 --> 00:14:39,590
him and he steals their TeamViewer
session ID and password so if you're

185
00:14:39,590 --> 00:14:43,530
running a social engineer attack trying
to make sure you know who your social

186
00:14:43,530 --> 00:14:46,470
engineering don't try it on Chris
niggers in her

187
00:14:46,470 --> 00:14:51,070
you know kevin Mitnick people try and
run the Mac sauce can kevin Mitnick all

188
00:14:51,070 --> 00:14:55,040
the time and if you're doing something
like this and like I'm gonna run a prank

189
00:14:55,040 --> 00:14:59,550
and then turns out the kids like the son
of an FBI agent investigation is not

190
00:14:59,550 --> 00:15:04,550
good she really want to know what you're
doing and this one I kinda have there

191
00:15:04,550 --> 00:15:09,400
because there's no accounting for acts
of God this is a security camera picture

192
00:15:09,400 --> 00:15:15,970
where birds happens people right in
front license plate so I went and I i

193
00:15:15,970 --> 00:15:20,700
replicated the team's attack that Adrian
had done previously and I was super

194
00:15:20,700 --> 00:15:26,080
proud to the server Summerfield black at
school and I took it into my professor's

195
00:15:26,080 --> 00:15:30,700
office I was like alright this can be my
research project and what he said was

196
00:15:30,700 --> 00:15:35,800
replication does not count as research
into anything new I had to do something

197
00:15:35,800 --> 00:15:38,280
new but at the time

198
00:15:38,280 --> 00:15:43,800
Bluetooth and mobile attacks were really
all the rage and so he asked can I

199
00:15:43,800 --> 00:15:48,470
convert the stacked Bluetooth so
initially what I want to do is I want to

200
00:15:48,470 --> 00:15:52,730
basically take a big black and a new
purchase one for power source in like a

201
00:15:52,730 --> 00:15:56,380
shoebox and walk around in breaking that
every Bluetooth connection I could find

202
00:15:56,380 --> 00:16:01,600
inject binary two teens your PowerShell
injection are longer keystrokes and and

203
00:16:01,600 --> 00:16:05,680
no walk by the officers known everyone
that doesn't work out

204
00:16:05,680 --> 00:16:11,420
booted use something called secure
simple pairing which means that the

205
00:16:11,420 --> 00:16:15,900
traffic is encrypted and unless you
observe the parent process it's almost

206
00:16:15,900 --> 00:16:22,130
impossible to break into an existing
connection it's as feasible has brute

207
00:16:22,130 --> 00:16:28,630
forcing any other type of a subscription
so then we moved back into supply our

208
00:16:28,630 --> 00:16:34,050
own Trojan human interface device and
what we found essentially as we took a

209
00:16:34,050 --> 00:16:37,950
Bluetooth keyboard and just put it in
CNN you couldn't interact with the

210
00:16:37,950 --> 00:16:43,680
pre-existing Bluetooth transmitter in
the keyboard so we could either take a

211
00:16:43,680 --> 00:16:47,880
ps2 keyboard and rip everything out and
in better own transmitter our own teensy

212
00:16:47,880 --> 00:16:52,560
and transmit the keystrokes true that or
we can write a driver for Bluetooth

213
00:16:52,560 --> 00:16:55,300
keyboard to use its existing adapter

214
00:16:55,300 --> 00:17:01,769
so the hardware route turned out to be a
little easier and our first attempt we

215
00:17:01,769 --> 00:17:06,110
counted rude I like this to see if it
would work we found out that with

216
00:17:06,110 --> 00:17:10,000
Bluetooth you could pair as either a
mouse or keyboard you compare the

217
00:17:10,000 --> 00:17:16,589
straight HID device so if you put in a
mouse you couldn't inject keystrokes so

218
00:17:16,589 --> 00:17:22,610
we basically had to do with the keyboard
so we took an Arduino leopard and a

219
00:17:22,610 --> 00:17:27,490
Bluetooth transmitter and we put them
together and you can solve this new

220
00:17:27,490 --> 00:17:30,070
keyboard there are a lot of keyboards
now that they sell that have two

221
00:17:30,070 --> 00:17:36,130
separate hubs and so we injected
keystrokes and you can do by argentines

222
00:17:36,130 --> 00:17:39,380
your PowerShell injection through this I
thought this was really interesting

223
00:17:39,380 --> 00:17:45,460
though because my dad wrote this message
when he helped me a lot of soldering

224
00:17:45,460 --> 00:17:50,730
work and things like that and 65 just
retired and he wrote hello this is the

225
00:17:50,730 --> 00:17:54,750
best thing I've done so far so after you
know over 40 years in the industry

226
00:17:54,750 --> 00:17:58,550
thought this kind of attack was the
coolest thing you've ever done and I

227
00:17:58,550 --> 00:18:02,280
thought that was really cool so that's
part of why I'm hoping you know to make

228
00:18:02,280 --> 00:18:06,090
it my life's work so I can always think
I'm doing something cool instead of just

229
00:18:06,090 --> 00:18:10,110
kind of feeling like I wrote outlook
plugins my whole life but I got paid

230
00:18:10,110 --> 00:18:16,440
whatever that's what he did for a long
time around one was a success and one of

231
00:18:16,440 --> 00:18:19,800
the things that I thought was really
cool is you right now you see network

232
00:18:19,800 --> 00:18:24,110
traffic analysis increasing a lot and so
those keyboards with to hug you can

233
00:18:24,110 --> 00:18:29,350
actually saw her in the the teensy are
any Arduino and the Bluetooth

234
00:18:29,350 --> 00:18:34,780
transmitter but they also make little
hardware level keyloggers that will

235
00:18:34,780 --> 00:18:39,540
intercept the electrical signals and
then you can input you can solder nasty

236
00:18:39,540 --> 00:18:44,620
card also and so you could have the
Bluetooth keyboard operate totally

237
00:18:44,620 --> 00:18:48,380
normally with no sort of you know
software running on the system no

238
00:18:48,380 --> 00:18:53,559
network traffic analysis and as long as
you can retrieve the sdcard at some

239
00:18:53,559 --> 00:18:56,669
point from the keyboard I think the
ideal way to do this would be something

240
00:18:56,669 --> 00:18:59,960
like send them a recall notice for the
keyboard hope they just send it back to

241
00:18:59,960 --> 00:19:04,530
you then they'll be none the wiser

242
00:19:04,530 --> 00:19:08,500
so i really wanna do it with the Windows
driver framework I think the hardware

243
00:19:08,500 --> 00:19:14,900
stuff is really cool but I love pure
software the Windows kernel-mode driver

244
00:19:14,900 --> 00:19:18,740
framework obviously it's really powerful
to have rings your direct memory access

245
00:19:18,740 --> 00:19:24,070
the pier software development means that
there's no traces little evidence so

246
00:19:24,070 --> 00:19:27,400
here you know if they do break the
keyboard or open it up for any reason

247
00:19:27,400 --> 00:19:31,270
obviously we'll see that there's a bunch
of stuff inside it a lot of people don't

248
00:19:31,270 --> 00:19:37,960
know that it's not supposed to be there
but some people well and also in our

249
00:19:37,960 --> 00:19:43,010
case you know we have to solder it on
each time in for the mouse we went

250
00:19:43,010 --> 00:19:47,030
through three mice before we completed
out one and I think in the future will

251
00:19:47,030 --> 00:19:51,950
be able to possibly do it one by one
without any errors but it still takes a

252
00:19:51,950 --> 00:19:56,450
lot more time than if you have a working
device driver and you can / on in like

253
00:19:56,450 --> 00:20:02,810
10 keyboards in an hour or something
like that and some allow kevin Mitnick

254
00:20:02,810 --> 00:20:06,990
did something like this there's a shout
out to the ocean which I like but he

255
00:20:06,990 --> 00:20:12,970
also talks about he bought an HP printer
he made a printer driver put on CD with

256
00:20:12,970 --> 00:20:17,600
the HP logo on it went to a company said
hey I'm with the HP early adopter

257
00:20:17,600 --> 00:20:22,140
program gave and gave him the driver
told them how important it was to

258
00:20:22,140 --> 00:20:27,200
install the driver because of debugging
purposes and of course you know they put

259
00:20:27,200 --> 00:20:30,440
the print right on their network they
installed The Truman Show driver and he

260
00:20:30,440 --> 00:20:36,640
was in the Windows driver framework is
separating user-mode driver framework in

261
00:20:36,640 --> 00:20:41,210
the kernel mode driver framework object
drivers run individual devices will

262
00:20:41,210 --> 00:20:46,970
filter drivers will interact with all
devices at the type and they reside on

263
00:20:46,970 --> 00:20:52,370
the system so ideally you want to put a
kernel mode filter driver on their

264
00:20:52,370 --> 00:20:56,290
system and then even if they switch
keyboards later on as long as that

265
00:20:56,290 --> 00:21:00,300
drivers stores eyes on their system
you'll have no access or whatever it is

266
00:21:00,300 --> 00:21:04,880
you design the driver to do the winners
driver framework is built on top of the

267
00:21:04,880 --> 00:21:07,650
Windows driver model which is more
complicated

268
00:21:07,650 --> 00:21:11,790
devalued but it still exists completely
and with the Windows driver model you

269
00:21:11,790 --> 00:21:15,440
can do things like direct power
management things like that so if you

270
00:21:15,440 --> 00:21:20,900
wanted to try and rider computer like
some people may bad USB the do that you

271
00:21:20,900 --> 00:21:23,700
need to use the Windows driver model
some hoping to get better than Windows

272
00:21:23,700 --> 00:21:27,590
driver framework and then also learned
the older Windows driver model which a

273
00:21:27,590 --> 00:21:33,470
lot of people now just completely ignore
because of the framework on top of it so

274
00:21:33,470 --> 00:21:38,000
this is the windows architecture and
iron seek but its separate into user

275
00:21:38,000 --> 00:21:43,370
mode in kernel mode and this is a big
distinction user mode drivers are a lot

276
00:21:43,370 --> 00:21:46,760
less powerful there's a lot of things
you can only access in the current space

277
00:21:46,760 --> 00:21:50,610
if you guys haven't seen 0 steiner's
talks I'd definitely recommend checking

278
00:21:50,610 --> 00:21:57,700
them out so this is an overview of the
user-mode driver framework and basically

279
00:21:57,700 --> 00:22:00,910
just what I want you know is that
everything up here is done in user mode

280
00:22:00,910 --> 00:22:06,360
and then there's some calls down below
and then if you look at the kernel

281
00:22:06,360 --> 00:22:11,420
system drivers there's the application
in the Windows API and user mode and

282
00:22:11,420 --> 00:22:15,670
then all that's exposed to the user mode
is that Windows API they have no sort of

283
00:22:15,670 --> 00:22:20,040
insight into the actual functionality
the driver so Jason see its who wrote

284
00:22:20,040 --> 00:22:24,640
the great how Python and black hat
Python books in those books he knows

285
00:22:24,640 --> 00:22:28,980
specifically the importance of using an
appropriately privilege departure so if

286
00:22:28,980 --> 00:22:32,570
you're running antivirus software in
like a user mode or something like that

287
00:22:32,570 --> 00:22:38,820
it is completely incapable of detecting
what's going on in the kernel space an

288
00:22:38,820 --> 00:22:43,340
unverified direct memory access driver
you could actually used to just over

289
00:22:43,340 --> 00:22:49,720
right parts of the colonel and they
would be none none the wiser so this is

290
00:22:49,720 --> 00:22:53,650
Corey hagen he went to my school he
works at Sony now he's a game developer

291
00:22:53,650 --> 00:22:57,630
and he's the one who really talking
about interrupts and how they work so I

292
00:22:57,630 --> 00:23:01,830
wanted to give him little shot out here
but the interrupt request protocol

293
00:23:01,830 --> 00:23:07,100
interrupts are a fundamental concept in
computer science and extremely important

294
00:23:07,100 --> 00:23:13,130
in no task management scheduling the
interrupt request level is basically how

295
00:23:13,130 --> 00:23:18,490
it gives priority to interrupts nor
Ganapathy was the architect of Windows I

296
00:23:18,490 --> 00:23:22,870
O for a long time in the evolution
window IO he talks about how prior to

297
00:23:22,870 --> 00:23:23,580
Vista

298
00:23:23,580 --> 00:23:27,300
there was only one level of interrupt
their all kernel system interrupts and

299
00:23:27,300 --> 00:23:30,950
that's why if a regular process froze a
lot of times you have to totally restart

300
00:23:30,950 --> 00:23:36,040
the computer so keystrokes and mouse
clicks they issue interrupts I believe

301
00:23:36,040 --> 00:23:43,090
they have a higher IQ level of one and
it goes I believe from 0 to seven so I

302
00:23:43,090 --> 00:23:48,160
found this little while ago small kernel
rootkits called Phoenix kit which lives

303
00:23:48,160 --> 00:23:52,610
in higher P layer and notes those
interrupts that are sent by the keyboard

304
00:23:52,610 --> 00:23:57,810
before they reach the actual program and
so will do key logging their it

305
00:23:57,810 --> 00:24:01,780
generates a dot system adopt reginald
you get those on the system

306
00:24:01,780 --> 00:24:08,780
know you have full access to do whatever
you want the source code for this route

307
00:24:08,780 --> 00:24:12,080
did I highly recommend you take a look
at it if you're interested in this type

308
00:24:12,080 --> 00:24:17,560
of stuff it's absolutely beautiful and I
showed it to several people in the

309
00:24:17,560 --> 00:24:21,670
graduate level security class you have
experience with C and C++

310
00:24:21,670 --> 00:24:26,310
like it looks good but I just don't have
enough experience with the win32 native

311
00:24:26,310 --> 00:24:31,210
API is truly tell you what it does so
anyone who can you know part by part

312
00:24:31,210 --> 00:24:36,610
time exactly what this kid is doing all
of you for every but this is where it

313
00:24:36,610 --> 00:24:41,660
lives so there's the device object as
the driver object as the original

314
00:24:41,660 --> 00:24:46,310
interrupt request protocol handler and
the rootkit code is kinda resides in

315
00:24:46,310 --> 00:24:50,440
there and everything that supposed to be
routed to the IRP handlers routed

316
00:24:50,440 --> 00:24:54,560
through the rootkit and he uses some
code from clandestine use key logger

317
00:24:54,560 --> 00:25:00,050
rootkit 22 log all of those on the
system and has some very cool

318
00:25:00,050 --> 00:25:06,040
obfuscation techniques as well so one of
the reasons we can write our own drivers

319
00:25:06,040 --> 00:25:11,780
is the way the driver model works I
don't know if anyone hears familiar with

320
00:25:11,780 --> 00:25:16,790
like interfaces and how overrides work
in computer science but basically

321
00:25:16,790 --> 00:25:21,070
generic driver which establishes the
function calls and things like that

322
00:25:21,070 --> 00:25:27,080
there's set function out there so any
mouse or keyboard that you plug in it

323
00:25:27,080 --> 00:25:32,200
will start and any USB device indeed
will start working with that basic

324
00:25:32,200 --> 00:25:35,500
driver and then there can be a specific
driver

325
00:25:35,500 --> 00:25:39,920
which can be written by Microsoft or an
independent hardware vendor and that

326
00:25:39,920 --> 00:25:44,630
driver will also be installed on systems
and most of the time what you're doing

327
00:25:44,630 --> 00:25:49,230
is you're overriding the functions of
the generic driver and so here you can

328
00:25:49,230 --> 00:25:56,080
add a little extra installing drivers on
systems when you plug something in his

329
00:25:56,080 --> 00:26:00,700
very standard it happened on iplug my
USB device here to put the stock on this

330
00:26:00,700 --> 00:26:01,640
computer

331
00:26:01,640 --> 00:26:06,310
happens when you put an extremely
doctors happens when you set up the

332
00:26:06,310 --> 00:26:10,640
Arduino environment it happens when you
plug in a new mouse and when things are

333
00:26:10,640 --> 00:26:14,500
really love about Razer is they started
doing this thing where you plug it in

334
00:26:14,500 --> 00:26:18,850
and you get this popup and if you
clicked install it would retrieve

335
00:26:18,850 --> 00:26:22,100
software from the web it would install
it and then we'll ask you to enter your

336
00:26:22,100 --> 00:26:27,820
credentials so we might be seeing users
conditioned to expect when a mouse or

337
00:26:27,820 --> 00:26:32,620
keyboard is plugged into their computer
to retrieve and install something from

338
00:26:32,620 --> 00:26:35,960
the internet and then enter credentials
in there and obviously for this attack

339
00:26:35,960 --> 00:26:37,940
that would be golden

340
00:26:37,940 --> 00:26:45,430
there are steps being taken to prevent
these types of tax driver signing has

341
00:26:45,430 --> 00:26:51,380
been tightened down a lot in Windows 10
and they're doing like a centralized

342
00:26:51,380 --> 00:26:56,820
signing type thing this is bad for this
attack but it's also bad for a lot of

343
00:26:56,820 --> 00:26:57,950
users

344
00:26:57,950 --> 00:27:04,870
this is an external adapter it no longer
works with Windows 10 this is I was

345
00:27:04,870 --> 00:27:08,250
trying to upgrade a computer to Windows
tan and it was absolutely incompatible

346
00:27:08,250 --> 00:27:14,010
da previous drivers have a friend who
successfully upgraded to Windows 10 with

347
00:27:14,010 --> 00:27:17,910
the Toshiba laptop but the built-in
keyboard it no longer recognizes that

348
00:27:17,910 --> 00:27:22,200
driver so you can type on earning
obviously not very counterproductive for

349
00:27:22,200 --> 00:27:25,440
him and he would rather have this
keystrokes logs she's not really doing

350
00:27:25,440 --> 00:27:30,540
anything that important then not be able
to use his computer anymore so sometimes

351
00:27:30,540 --> 00:27:35,170
you know security restrictions they have
downsides Barack to still work in

352
00:27:35,170 --> 00:27:39,280
progress I'm working on creating that
direct memory access driver to do these

353
00:27:39,280 --> 00:27:45,400
types of things and this was just
recently a firmware over right thing

354
00:27:45,400 --> 00:27:49,830
that fire discovered on Cisco routers
and what was really notable here for me

355
00:27:49,830 --> 00:27:52,590
is that you weren't supposed to be over

356
00:27:52,590 --> 00:27:57,670
able to overwrite the firmware on these
riders but there were certain flags that

357
00:27:57,670 --> 00:28:00,570
you could overwrite and once you over
wrote those flags you could then

358
00:28:00,570 --> 00:28:08,790
override the firmware so this is one of
the great stories where spock gives JFK

359
00:28:08,790 --> 00:28:13,730
cab ride and takes like a genuine
interest in him and it's really great

360
00:28:13,730 --> 00:28:17,220
story should read it if you got the
opportunity but he said lots of

361
00:28:17,220 --> 00:28:20,460
competition your business just like in
mind and then he gave me this just

362
00:28:20,460 --> 00:28:23,020
remember there's always room for one
more good one

363
00:28:23,020 --> 00:28:27,900
words to live by and I did so I'm hoping
to get better at this be good at this

364
00:28:27,900 --> 00:28:30,800
and I'm hoping there's a place for means
thank you

