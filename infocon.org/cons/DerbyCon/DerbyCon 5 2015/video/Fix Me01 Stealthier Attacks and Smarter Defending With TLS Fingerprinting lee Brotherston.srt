1
00:00:00,000 --> 00:00:36,000
afternoon

2
00:00:36,000 --> 00:00:42,980
attacks and smarter defending
fingerprinting nominee for the award the

3
00:00:42,980 --> 00:00:48,460
least funny type of Derby Conn ever the
other equally on funny but true title is

4
00:00:48,460 --> 00:00:54,559
zero mouth almost zero crypto TLS talk
if you are after some kind of DJB town

5
00:00:54,559 --> 00:00:58,400
of elliptic curves with calculus and
stock you're probably going to be

6
00:00:58,400 --> 00:01:03,050
disappointed I don't do the pic map
thing but if you want protocol analysis

7
00:01:03,050 --> 00:01:06,450
and that sort of thing then hopefully
this is more for you

8
00:01:06,450 --> 00:01:11,899
the genders really to do a quickie Las
primer for people that are not they are

9
00:01:11,899 --> 00:01:16,750
multilateral years if you are doesn't
matter is pretty quick delivery beyond

10
00:01:16,750 --> 00:01:21,789
finger taylor's fingerprinting as a
whole to handle section on attacker and

11
00:01:21,789 --> 00:01:26,470
defender scenarios and then he wasn't
all so that people can go and play with

12
00:01:26,470 --> 00:01:32,899
the stuff themselves before we start to
mention I use https along as an example

13
00:01:32,899 --> 00:01:38,160
when I'm working through these things
but it's not HTTPS talk advice equally

14
00:01:38,160 --> 00:01:44,110
to other tlass enable protocols this is
really just because everyone understands

15
00:01:44,110 --> 00:01:48,670
browsers pretty well so he's example for
most people to grasp the other thing is

16
00:01:48,670 --> 00:01:52,689
when I talk about various signatures and
what you can do with them

17
00:01:52,689 --> 00:01:57,460
none of these hypotheticals are all been
done so if I say you could be at X I

18
00:01:57,460 --> 00:02:02,030
have already fingerprinted aspects it is
possible is not just a lab type scenario

19
00:02:02,030 --> 00:02:07,770
so why not said a quick deal as Prime
trilogy is what we really mean when

20
00:02:07,770 --> 00:02:11,420
everyone says Asus out and if you really
mean necessarily should not be in this

21
00:02:11,420 --> 00:02:14,790
talk we should be at your office getting
a sellout of your environment moving to

22
00:02:14,790 --> 00:02:21,650
tell us and you can watch the recording
and then catch up on this but people use

23
00:02:21,650 --> 00:02:25,459
TLS encryption is a phrase if it's an
algorithm and its not an encryption

24
00:02:25,459 --> 00:02:29,360
algorithm its approach called used to
determine which cryptographic algorithm

25
00:02:29,360 --> 00:02:32,760
amongst other things are going to use
its great for fingerprints because it

26
00:02:32,760 --> 00:02:34,019
doesn't get mangled by now

27
00:02:34,019 --> 00:02:38,410
proxies files or anything is completely
payload based it doesn't use TCP header

28
00:02:38,410 --> 00:02:41,940
right the headers so it doesn't matter
what your networking equipment does it

29
00:02:41,940 --> 00:02:45,970
stays intact and this is being managed

30
00:02:45,970 --> 00:02:50,430
so the most common uses HTTPS he got a
browser on a web server and they want to

31
00:02:50,430 --> 00:02:53,870
talk to each other and that would be
fine if you just had one browser in the

32
00:02:53,870 --> 00:02:56,830
world and one web server in the world
they could have a predefined set of

33
00:02:56,830 --> 00:02:59,840
crypto algorithms that use and use them
but that's not the case

34
00:02:59,840 --> 00:03:04,660
the web server has to interact with more
than one type of browser and so they

35
00:03:04,660 --> 00:03:08,230
need to find a common ground in what the
capabilities are and they certainly will

36
00:03:08,230 --> 00:03:13,590
tell us they exchanged their
capabilities and turning the best one

37
00:03:13,590 --> 00:03:17,460
that they can both use similarly there
are other web service in the world so

38
00:03:17,460 --> 00:03:21,090
the client's need to be able to adapt to
what certainly talking to when you visit

39
00:03:21,090 --> 00:03:25,370
a website you don't know in advance what
web service at on so they constantly

40
00:03:25,370 --> 00:03:29,010
have to negotiate for each connection
and of course there's plenty of other

41
00:03:29,010 --> 00:03:34,160
browsers to make this more complex and
you start seeing from diagrammed it gets

42
00:03:34,160 --> 00:03:38,230
a mess of different possibilities and
different options even just using the

43
00:03:38,230 --> 00:03:43,350
mainstream browsers there's no all
browsers in here there's no old versions

44
00:03:43,350 --> 00:03:47,530
of these browsers there's no command
line stuff so you can imagine the number

45
00:03:47,530 --> 00:03:53,190
of permutations that must be so how does
it work well you quickly used here last

46
00:03:53,190 --> 00:03:58,700
books crypto ferries appear be sprinkled
magical crypto dust everything becomes

47
00:03:58,700 --> 00:04:03,459
secure government surveillance go dark
dystopian future is avoided and we can

48
00:04:03,459 --> 00:04:07,580
all go home have a nice drink and chill
out unfortunately the reality slightly

49
00:04:07,580 --> 00:04:11,650
more mundane and what actually happens
is you have an exchange of hello packets

50
00:04:11,650 --> 00:04:17,280
whereby the client's explained to each
other better word what their

51
00:04:17,280 --> 00:04:21,080
capabilities are what cipher suites they
support compression they support that

52
00:04:21,080 --> 00:04:26,300
kind of thing as key exchange which is
shockingly exchanging keys cryptographic

53
00:04:26,300 --> 00:04:30,479
key material and there's options to
change the cipher spec halfway through

54
00:04:30,479 --> 00:04:34,290
so they can renegotiate different
different settings and then you got the

55
00:04:34,290 --> 00:04:38,810
encrypted data so what from this is
useful to us well we're looking at

56
00:04:38,810 --> 00:04:43,940
Taylors clients so really suffering the
service kind of points we don't want

57
00:04:43,940 --> 00:04:46,979
anything encrypted cause like I
mentioned I'm not the JB and I can't do

58
00:04:46,979 --> 00:04:51,100
anything clever with encrypted data on
that and we don't want to try and key

59
00:04:51,100 --> 00:04:54,729
exchange because the key is done
properly is going to be unique to

60
00:04:54,729 --> 00:04:56,810
sessions so it's points the finger

61
00:04:56,810 --> 00:05:01,830
which only releases decline hello packet
which is really convenient to because

62
00:05:01,830 --> 00:05:05,830
that's the first back you ever getting a
teller transaction see the earliest

63
00:05:05,830 --> 00:05:15,720
possible opportunity in the session so
this is our primary the way let's talk

64
00:05:15,720 --> 00:05:20,040
about fingerprints so first of all why
clients as opposed to service

65
00:05:20,040 --> 00:05:24,630
well service you can actively
fingerprint you can connect to a server

66
00:05:24,630 --> 00:05:30,229
and drove it and determine what is you
can't with a client caused by default

67
00:05:30,229 --> 00:05:33,960
it's a client it's not listening you
can't product you have to wait for it to

68
00:05:33,960 --> 00:05:39,010
be putting something else before you can
determine what it is certainly a server

69
00:05:39,010 --> 00:05:43,110
announces what it is anyway if anyone's
ever connected to an SMTP server web

70
00:05:43,110 --> 00:05:46,240
server anything like that but just
screamed the software that's being used

71
00:05:46,240 --> 00:05:52,080
across the banner there's no real meet
several ways to say

72
00:05:52,080 --> 00:05:56,720
books and the next time you connect to
it it's still an Apache books you don't

73
00:05:56,720 --> 00:06:00,410
really need to determine things on a per
connection basis if you're attacking the

74
00:06:00,410 --> 00:06:05,320
client uses going to open IE or Firefox
or Chrome so you don't know one TCP

75
00:06:05,320 --> 00:06:09,320
connection to another what it is even if
you profile them once that doesn't

76
00:06:09,320 --> 00:06:14,229
matter two seconds later and finally
because of this service a much more

77
00:06:14,229 --> 00:06:19,240
configurable one finds with regards to
tell us if the server is been modified

78
00:06:19,240 --> 00:06:21,960
and it no longer matches our
fingerprints the much more difficult to

79
00:06:21,960 --> 00:06:26,419
fingerprint from retailers expect
clients however don't get modified is

80
00:06:26,419 --> 00:06:30,550
often how many people have logged into
their browser and and she removed

81
00:06:30,550 --> 00:06:34,460
supported sites we actually probably are
some but there are not many people

82
00:06:34,460 --> 00:06:41,720
generally sleep tight street from the
browser so let's get to where we started

83
00:06:41,720 --> 00:06:45,650
and hopefully that will illustrate where
I'm going to do this

84
00:06:45,650 --> 00:06:50,450
back at the year end of last year then
over bundled superfish

85
00:06:50,450 --> 00:06:55,760
got busted again today but they busted a
bundle superfish

86
00:06:55,760 --> 00:07:00,490
in with a bunch of their lap and rooftop
is out there that was meant to be

87
00:07:00,490 --> 00:07:04,360
helping with us to sell books actually
man enabling SSL and there's been a

88
00:07:04,360 --> 00:07:08,080
bunch of the tools that will discovered
around the same time and everyone was

89
00:07:08,080 --> 00:07:08,889
worrying about them

90
00:07:08,889 --> 00:07:13,969
and we have headlines like this we're
just talking about how the certificate

91
00:07:13,969 --> 00:07:18,120
dropped onto the machines in various
ways and have been installed as a stiff

92
00:07:18,120 --> 00:07:26,330
thority allowing the average to go and
re-signed connections as their own and

93
00:07:26,330 --> 00:07:30,180
then people when crack growth and could
sign whatever they liked and that's a

94
00:07:30,180 --> 00:07:35,069
typical fourteen attackers clients that
the certificate was only part of it you

95
00:07:35,069 --> 00:07:39,060
could see other things that the
application was doing with my hardcore

96
00:07:39,060 --> 00:07:41,500
lecturing to love netstat

97
00:07:41,500 --> 00:07:46,150
you can look at the processes you can
see that there were two processes the

98
00:07:46,150 --> 00:07:47,120
talk to each other

99
00:07:47,120 --> 00:07:50,990
entirely on localhost and then one of
those processes goes and talks to the

100
00:07:50,990 --> 00:07:55,250
internet now if you look at what those
are

101
00:07:55,250 --> 00:08:02,289
its process number 408 pool and 3388 so
using my other league hacks going to

102
00:08:02,289 --> 00:08:07,759
love task man you can look at 338 thats
Internet Explorer that's the one talking

103
00:08:07,759 --> 00:08:12,729
on localhost the one hitting all the
websites is quiet that's because what's

104
00:08:12,729 --> 00:08:17,960
happened is in in these cases are
talking genius box same sort of thing as

105
00:08:17,960 --> 00:08:23,900
the others is the kind of sexy has
through one means or another

106
00:08:23,900 --> 00:08:28,979
cooking connections to browse proxy
settings or whatever was told it to

107
00:08:28,979 --> 00:08:35,399
connect to it and then it connects out
to the internet you can also take a hint

108
00:08:35,399 --> 00:08:38,769
when you look at its installed directory
that it might be doing something with

109
00:08:38,769 --> 00:08:45,170
Telus is got things for making stickers
so we know he's doing something with TLS

110
00:08:45,170 --> 00:08:49,110
and we know the Browns connecting to it
and the browsers and getting errors

111
00:08:49,110 --> 00:08:55,680
because likes to fish it has addresses
in the CIA store and that means that it

112
00:08:55,680 --> 00:09:00,000
can re-sign anything it wants but that
also means is that no traffic from IE is

113
00:09:00,000 --> 00:09:04,089
hitting the Internet it stops there the
fine is not boarded and the client makes

114
00:09:04,089 --> 00:09:10,570
its own connection out that means that
whatever occurs on the network from his

115
00:09:10,570 --> 00:09:15,660
perspective is purely about the client
and actually nothing to do with so if we

116
00:09:15,660 --> 00:09:20,269
take a packet them unaffected Lenovo
laptop and inflicted one and put them

117
00:09:20,269 --> 00:09:21,400
side by side

118
00:09:21,400 --> 00:09:26,590
we can see that they're not the same
even a cursory glance they support a

119
00:09:26,590 --> 00:09:30,940
completely different number of cipher
suites restart preferential site this

120
00:09:30,940 --> 00:09:34,250
week is a completely different one
they're not even using the same version

121
00:09:34,250 --> 00:09:37,530
of tail acts so they're pretty distinct
from each other when you look at them

122
00:09:37,530 --> 00:09:42,770
side by side like that and that's on the
same machine that means that you can

123
00:09:42,770 --> 00:09:49,550
drive fingerprint these are in a bunch
of assets in the in the Taylor's header

124
00:09:49,550 --> 00:09:54,200
and I can go and look for which I did I
really just not rule looking to take

125
00:09:54,200 --> 00:09:58,710
their stuff on the wire is useful for
system admins because as system

126
00:09:58,710 --> 00:10:03,060
administrator doesn't necessarily have
access to the point where in a world

127
00:10:03,060 --> 00:10:06,180
where people can bring their own devices
in and the enterprise doesn't

128
00:10:06,180 --> 00:10:10,020
necessarily have access to look at the
price you might not have access to the

129
00:10:10,020 --> 00:10:15,950
server so really you don't have an idea
as to whether someone is super efficient

130
00:10:15,950 --> 00:10:22,750
elected for example or any of the others
without having access to be employed by

131
00:10:22,750 --> 00:10:25,880
slipping on the network and alerting
them this way

132
00:10:25,880 --> 00:10:30,110
detected using your existing
infrastructure even this guy whoever he

133
00:10:30,110 --> 00:10:35,100
is seen to be quite impressed with it so
let's expand a little bit because it

134
00:10:35,100 --> 00:10:41,740
works so far the ruling made only worked
on the surface of the problem is that if

135
00:10:41,740 --> 00:10:45,760
you look at site for sweets chrome
version 45 and Firefox version 37 look

136
00:10:45,760 --> 00:10:50,280
the same as each other and they both the
same as Thunderbird version 38 so you

137
00:10:50,280 --> 00:10:53,450
start to get collisions impact of the
first hundred and fifty signatures are

138
00:10:53,450 --> 00:10:56,930
collected I would have only had seventy
five unique ones about stuff like this

139
00:10:56,930 --> 00:11:02,520
week's like I started so we need to look
a little bit more of what we can do we

140
00:11:02,520 --> 00:11:07,860
decline hello packet

141
00:11:07,860 --> 00:11:14,410
so this is a standard header from a
client doesn't represent the the sizes

142
00:11:14,410 --> 00:11:18,110
of the book seize don't represent the
size of the fields but it is the

143
00:11:18,110 --> 00:11:24,000
ordering so this blog here is fixed
location you can find it really easily

144
00:11:24,000 --> 00:11:27,200
with no computation there at standard
offsets from the beginning of the paler

145
00:11:27,200 --> 00:11:34,540
this section is mostly fixed ish because
it depends on the size of the show

146
00:11:34,540 --> 00:11:40,279
SessionID but once you can't relate to
the session IV then it's an easy offset

147
00:11:40,279 --> 00:11:45,610
the and extensions you actually have to
pass properly because extensions each

148
00:11:45,610 --> 00:11:49,070
have a link to their own and you have to
find the length of an extension of up to

149
00:11:49,070 --> 00:11:52,750
the next extension to find the length
that thought to the next and so on so

150
00:11:52,750 --> 00:11:58,329
that's a slightly more CPU intensive but
it's still not that so what's useful in

151
00:11:58,329 --> 00:12:03,200
here we don't use any of these links as
because we know the length we've got the

152
00:12:03,200 --> 00:12:04,329
date already

153
00:12:04,329 --> 00:12:11,120
those are just there to navigate with
packing when you're grabbing it do the

154
00:12:11,120 --> 00:12:15,890
SessionID because the SessionID is
shockingly unique to the session and we

155
00:12:15,890 --> 00:12:23,209
really don't care and Brandon is well
it's random so again I don't care really

156
00:12:23,209 --> 00:12:26,940
useful extensions add a load of
extensibility on top of what's already

157
00:12:26,940 --> 00:12:32,100
inside Taylor for example there's a
server header to put the hosts in the

158
00:12:32,100 --> 00:12:35,959
clear conclusion that was secret when
you're browsing the web site and that's

159
00:12:35,959 --> 00:12:40,610
to allow the hosting of multiple
websites on a single IP address each

160
00:12:40,610 --> 00:12:44,290
with their own a cell so he can return
the serb before you get to the crypto

161
00:12:44,290 --> 00:12:50,329
resent the rights and that way you can
do the equivalent of the jump TTP 12 1.1

162
00:12:50,329 --> 00:12:57,329
the V hosting but we are also being able
to check the order of things is

163
00:12:57,329 --> 00:13:01,660
incredibly important so we look those in
the fingerprints to extensional slowed

164
00:13:01,660 --> 00:13:05,470
in a different order but different
browsers there is no r/c defining the

165
00:13:05,470 --> 00:13:11,329
ordeal of them in similarly the
cryptographic algorithms listed in a

166
00:13:11,329 --> 00:13:14,399
preferential order the compression
algorithms are listed in a preferential

167
00:13:14,399 --> 00:13:19,180
order so by looking to the order not
just the capabilities we get another

168
00:13:19,180 --> 00:13:19,810
level of crime

169
00:13:19,810 --> 00:13:24,880
clarity on the fingerprint let's
actually talk about creating a

170
00:13:24,880 --> 00:13:30,000
fingerprint well I need to get some
sample data so I sniffed a few of my own

171
00:13:30,000 --> 00:13:34,730
clients and they think but I needed to
get a bit more days in there so I

172
00:13:34,730 --> 00:13:39,540
realized there are websites out there
who are dedicated to doing regression

173
00:13:39,540 --> 00:13:43,320
testing for web developers you might
peace or CSS and you know it works in

174
00:13:43,320 --> 00:13:47,000
the last 30 versions of Firefox and 20
versions or chrome or whatever but you

175
00:13:47,000 --> 00:13:52,220
don't know what's going on over there
are services that will go and buy a 30

176
00:13:52,220 --> 00:13:56,270
40 50 browse the web site they will take
us a little jpg screenshot and email

177
00:13:56,270 --> 00:14:02,740
them to you conceive you wrote some
horrible CSS the broke life to the great

178
00:14:02,740 --> 00:14:06,610
thing about that is they have completely
honest user agent strings so I can put

179
00:14:06,610 --> 00:14:10,070
them on my web server that sniffing
absolutely everything and correlate the

180
00:14:10,070 --> 00:14:13,710
fingerprints are generated against
fingerprints against there use ratings

181
00:14:13,710 --> 00:14:16,760
provided and I instantly feel like a
whole bunch of fingerprints like a news

182
00:14:16,760 --> 00:14:22,370
story like this this is Dropbox there's
nothing particularly special about

183
00:14:22,370 --> 00:14:25,690
dropouts in this case and it's the
shortest fingerprints I can get it on a

184
00:14:25,690 --> 00:14:32,950
slide easily story in JSON it's fairly
human-readable there are a bunch of

185
00:14:32,950 --> 00:14:38,610
liberia's deposit things like 590 please
so it's it's really useful for people to

186
00:14:38,610 --> 00:14:43,870
use and transform into other forms and
the server names in not because we use

187
00:14:43,870 --> 00:14:47,260
it for fingerprinting because that would
just get us back to a situation that's

188
00:14:47,260 --> 00:14:51,830
why blacklisting which will come to in a
minute but the finger pointing toward I

189
00:14:51,830 --> 00:14:56,500
wrote named Julie because when you
generated a ton of fingerprints and

190
00:14:56,500 --> 00:14:59,470
you're trying to work out which goes
with which client this helps you back

191
00:14:59,470 --> 00:15:06,510
together also I'm worried about the
application I don't know all the Taylor

192
00:15:06,510 --> 00:15:12,250
said they will protocols like HTTP and
I'm a pessimist and DPS or whatever but

193
00:15:12,250 --> 00:15:16,100
there are there are plenty of Google's
out there I don't know so I want to be

194
00:15:16,100 --> 00:15:20,630
able to spot a lesson at the ports also
if anybody has ever worked in a large

195
00:15:20,630 --> 00:15:24,089
corporate environment you'll notice
cannot on the one that uses the

196
00:15:24,089 --> 00:15:27,880
universal filed by passport to get your
personal book so you can do what you

197
00:15:27,880 --> 00:15:30,620
want on the internet instead of going
through company proxy

198
00:15:30,620 --> 00:15:35,780
and this demonstrates my point that
people are not looking for a cessation

199
00:15:35,780 --> 00:15:40,320
port 443 in a largely ignoring 443 cuz
it's just encrypted

200
00:15:40,320 --> 00:15:44,790
hackers don't listen to Aiyana's
guidance on board members either so your

201
00:15:44,790 --> 00:15:47,990
actual training data but not necessarily
dropping it straight on the poor you

202
00:15:47,990 --> 00:15:54,530
think it is blocking it may not be
enough so my goals are to detect

203
00:15:54,530 --> 00:15:59,080
taylor's traffic and fingerprint on any
port to do it completely state loosely

204
00:15:59,080 --> 00:16:03,830
because tracking TCP sessions and and
that sort of thing can be quite

205
00:16:03,830 --> 00:16:10,210
intensive computation asymmetric as we
talk about large networks these days so

206
00:16:10,210 --> 00:16:13,880
I don't want to have to see both halves
of the conversation and wanted to be

207
00:16:13,880 --> 00:16:17,240
fairly low cost in terms of CPU memory
and storage and I'll come to the storage

208
00:16:17,240 --> 00:16:22,270
thing in a minute to be keeping all this
low we should get high detection rates

209
00:16:22,270 --> 00:16:26,970
more accurate detection rates and not
need quite such the harbor to drive it

210
00:16:26,970 --> 00:16:32,040
so the detective Taylor something we
can't meet the fingerprint tell us as a

211
00:16:32,040 --> 00:16:40,250
whole before we move into acts so this
these RBP air filter anyone who uses TCP

212
00:16:40,250 --> 00:16:46,760
double steal or something we'll know
these two checks on two bites and the

213
00:16:46,760 --> 00:16:50,630
first one checks that it is a packet
that identifies itself as a TLS

214
00:16:50,630 --> 00:16:55,200
handshake packet and the second check
checks that it's a client hello within

215
00:16:55,200 --> 00:16:59,100
that like it's a pretty high rate of
detection on its own but we can get a

216
00:16:59,100 --> 00:17:06,339
bit that we take this one by here and
it's the first of a two by value for the

217
00:17:06,340 --> 00:17:12,680
TLS solution if the first point is that
23 that will get you all TLS because the

218
00:17:12,680 --> 00:17:14,620
various versions at a less

219
00:17:14,620 --> 00:17:18,960
11 going to use the second bite to
differentiate so this one gets you will

220
00:17:18,960 --> 00:17:22,930
tell us a bit in blue is if you're a
masochist that gets us there will be

221
00:17:22,930 --> 00:17:27,480
three and that's just horrible I would
rather recommend alert on his cell b3

222
00:17:27,480 --> 00:17:28,940
being in your environment

223
00:17:28,940 --> 00:17:35,110
panic about that and don't put that in
this and we do the same again the TLS

224
00:17:35,110 --> 00:17:36,880
record version

225
00:17:36,880 --> 00:17:45,970
by just checking for bites with no
horrible offsets the past some no CPU

226
00:17:45,970 --> 00:17:51,650
computation legacy right down to pretty
much detecting tell us as a whole

227
00:17:51,650 --> 00:17:58,530
on every port your new real CPU
bottleneck is gonna be being able to

228
00:17:58,530 --> 00:18:02,730
drive the network on fast enough for the
over-all packet filtering to to apply

229
00:18:02,730 --> 00:18:07,610
the filter you can also shrink you'll
throughput down by adding a fifth check

230
00:18:07,610 --> 00:18:13,130
because there is a bite for these
SessionID like if the SessionID length

231
00:18:13,130 --> 00:18:19,330
30 I either is no SessionID then that
means it's the first packet in a TCP

232
00:18:19,330 --> 00:18:22,870
stream so you only get capture one
packet per stream as opposed to the

233
00:18:22,870 --> 00:18:27,920
subsequent negotiations and that way you
can you contribute stories right down

234
00:18:27,920 --> 00:18:33,780
just get one packet to examine forestry
is removed blue because we don't want a

235
00:18:33,780 --> 00:18:38,700
cell b3 that's the filter you want to
apply and it's pretty low CPU cores to

236
00:18:38,700 --> 00:18:42,080
talk about storage of attention

237
00:18:42,080 --> 00:18:46,170
the reason I mention storage is that if
you want to get use of this this is one

238
00:18:46,170 --> 00:18:50,250
of those things where you probably want
to harvest data all the time and then go

239
00:18:50,250 --> 00:18:54,580
back and analyze sort of signals
intelligence style if you can because if

240
00:18:54,580 --> 00:18:57,590
you have an event happen you might want
to look at what happened yesterday

241
00:18:57,590 --> 00:19:05,990
phyllis was so I did some analysis to
see id take a mixed traffic and tactical

242
00:19:05,990 --> 00:19:10,600
command for help around my home network
so it's mixed traffic is still less

243
00:19:10,600 --> 00:19:16,410
traffic its iPads it's you know whatever
things and cannot determine it because

244
00:19:16,410 --> 00:19:20,830
actually downing downloading binary from
http is one of the biggest ways to

245
00:19:20,830 --> 00:19:31,430
trigger false positive so well I'm
tilted 99.6% of packets were useless so

246
00:19:31,430 --> 00:19:36,770
implementing the first check it down to
just under three percent being useless

247
00:19:36,770 --> 00:19:42,440
the third check as you can see 100 5%
and I had a hundred percent success rate

248
00:19:42,440 --> 00:19:45,320
with no false positives when I
implemented all four of those checks

249
00:19:45,320 --> 00:19:49,200
that's not to say that I'm planned but
in that eight gigs of data

250
00:19:49,200 --> 00:19:53,720
I didn't have anything and in subsequent
tests too I haven't been false positives

251
00:19:53,720 --> 00:20:00,360
additionally it saves on the storage
tank exact data when saved to pick out

252
00:20:00,360 --> 00:20:05,590
with that filter went under 20 megs
which compared to eight gigs is not much

253
00:20:05,590 --> 00:20:09,630
data if you implement that fistfight
checked when you look back it becomes

254
00:20:09,630 --> 00:20:15,630
five point four MECs does look like full
floppy disks regular update to the

255
00:20:15,630 --> 00:20:21,340
printing which I don't think he's
particularly bad going so moving on

256
00:20:21,340 --> 00:20:25,659
there are a couple of floors that are
worth discussing before we get into a

257
00:20:25,659 --> 00:20:30,460
year before they actually looking at it
and one of these that obviously people

258
00:20:30,460 --> 00:20:36,850
are going to think what if I'm moving to
evade this is a sensible and obviously

259
00:20:36,850 --> 00:20:43,000
is possible because the client controls
its own Klein Klein hello packet there

260
00:20:43,000 --> 00:20:46,630
are a couple of gotchas however to
modify your fingerprint you have to

261
00:20:46,630 --> 00:20:49,850
modify the Hello packet and modify the
Hello packet means that you are

262
00:20:49,850 --> 00:20:53,269
announcing a different set of
capabilities to the world if you're

263
00:20:53,269 --> 00:20:56,519
announcing new capabilities you have to
be prepared to the server on the other

264
00:20:56,519 --> 00:21:00,130
end is going to call on those see you
need to actually have those capabilities

265
00:21:00,130 --> 00:21:04,130
similarly if you're removing some to
make sure they're not in the fingerprint

266
00:21:04,130 --> 00:21:09,010
that could cause you problems because
you may be lowering save a cipher suites

267
00:21:09,010 --> 00:21:14,480
that you use to a week 11 additionally
if you're using a library as opposed to

268
00:21:14,480 --> 00:21:20,059
coding your own DLs interactions in May
abstract a lot of this from you you can

269
00:21:20,059 --> 00:21:24,049
choose cyber sweets most of the time
with libraries but I don't see many to

270
00:21:24,049 --> 00:21:33,720
choose the order the closure extensions
in for example the other thing

271
00:21:33,720 --> 00:21:39,190
fingerprint clearance so if to clients
look exactly the same from a fingerprint

272
00:21:39,190 --> 00:21:44,790
perspective they cannot look they cannot
be differentiated when you're analyzing

273
00:21:44,790 --> 00:21:49,580
them because you can't tell which it is
because it has the same fingerprint and

274
00:21:49,580 --> 00:21:53,830
the definitive answer on whether this
happens in this is sort of ish maybe

275
00:21:53,830 --> 00:22:00,250
kind of because what happens is I think
it multiple fingerprint collisions where

276
00:22:00,250 --> 00:22:04,390
I can differentiate declines from each
other but then I noticed that although

277
00:22:04,390 --> 00:22:08,150
very with the same fingerprint in
different acts under the hood they were

278
00:22:08,150 --> 00:22:13,440
the same thing so if you look at Absa
particularly on cellular devices you

279
00:22:13,440 --> 00:22:15,990
have multiple routes that we have the
same fingerprint but then you'll find

280
00:22:15,990 --> 00:22:20,270
out what's really happening is they have
embedded Way bit in each one so it's

281
00:22:20,270 --> 00:22:25,440
actually from a technology perspective
it is the same client and that's

282
00:22:25,440 --> 00:22:27,860
important because they are the same
client in terms of what they're

283
00:22:27,860 --> 00:22:31,940
vulnerable to what they're not
vulnerable to come to a second but if

284
00:22:31,940 --> 00:22:36,260
the vulnerable to the same things them
from an attacker's perspective I don't

285
00:22:36,260 --> 00:22:41,920
have a different lines from a defensive
perspective you may be a little more but

286
00:22:41,920 --> 00:22:44,920
you can still differentiate them from IP
addresses and things like that little

287
00:22:44,920 --> 00:22:49,080
bit more easily so there's good examples
'cause that's way more fun to me what

288
00:22:49,080 --> 00:22:55,020
about this let's talk defender stuff any
woman's defense in a network has

289
00:22:55,020 --> 00:22:59,040
probably seen lists like this it's been
forever exporting flows down its

290
00:22:59,040 --> 00:23:04,320
firewall logs proxy logs in a prepared
addresses the talking to each other

291
00:23:04,320 --> 00:23:06,950
you probably have an idea about the
connections and you may even be

292
00:23:06,950 --> 00:23:11,180
monitoring some critics protocols but a
lot of the time you don't really know

293
00:23:11,180 --> 00:23:14,490
these connections are one of them might
be suspicious

294
00:23:14,490 --> 00:23:19,230
see my current ECB dumping on the packet
sniffer you can see the full 443 and you

295
00:23:19,230 --> 00:23:23,760
can see that it's a garbled mess inside
so the only possible conclusion is that

296
00:23:23,760 --> 00:23:29,960
it's probably your users web browsing
and command in the middle ear or

297
00:23:29,960 --> 00:23:33,590
something like that trying to determine
the content but most people are not

298
00:23:33,590 --> 00:23:38,510
doing that you could do with key
material derived from the client or the

299
00:23:38,510 --> 00:23:43,850
server to secretly package but again we
don't have access to those you could

300
00:23:43,850 --> 00:23:45,389
check against IP blacklist

301
00:23:45,389 --> 00:23:50,659
this is Alex Pinto provided and if you
want more data and more same review of

302
00:23:50,659 --> 00:23:56,690
this what she's talked also this is the
rate of change of data in black lists

303
00:23:56,690 --> 00:24:01,629
each of these buses a day you can see
the blacklists do not remain static they

304
00:24:01,629 --> 00:24:05,679
change every day if your blacklist is
not updated as often as the published

305
00:24:05,679 --> 00:24:10,079
blacklist you're probably out of date
this also includes they to being removed

306
00:24:10,079 --> 00:24:14,059
from blacklist so you might be
incorrectly flagging thing similarly you

307
00:24:14,059 --> 00:24:18,570
don't know how long before things appear
on a blacklist so what they are useful

308
00:24:18,570 --> 00:24:22,859
you can't guarantee that you're catching
everything this way the thing I like

309
00:24:22,859 --> 00:24:28,109
about the Taylors fingerprinting is that
people don't tend to update how the

310
00:24:28,109 --> 00:24:33,379
character is set up that regularly even
the big browsers with their regular

311
00:24:33,379 --> 00:24:37,829
releases have the same crypto between
versions or other time and when I looked

312
00:24:37,829 --> 00:24:43,589
at malware it never really changed its
critics acknowledges and black list

313
00:24:43,589 --> 00:24:48,229
includes internal traffic of course
either they only look at things like but

314
00:24:48,229 --> 00:24:54,919
net control and command control but
service was looking at least again you

315
00:24:54,919 --> 00:24:58,329
probably do a few things looking who is
look at the intense records and you can

316
00:24:58,329 --> 00:25:01,829
determine what a bunch of these are some
of them might scream bad the unknown

317
00:25:01,829 --> 00:25:08,889
connection to an SSH d the IOC session
but what about this host 10:54 10 399

318
00:25:08,889 --> 00:25:14,139
you can see it has what appears to be an
HTTPS sessions SharePoint and an HTTPS

319
00:25:14,139 --> 00:25:17,909
sessions at Amazon Web Services which
says nothing because the entire internet

320
00:25:17,909 --> 00:25:23,789
on Amazon Web Services retailers
fingerprinted and see that it's icy MITM

321
00:25:23,789 --> 00:25:27,859
proxies connecting SharePoint maybe
there's someone attacking another client

322
00:25:27,859 --> 00:25:31,049
on your network man in the middle of the
connection and grabbing the documents

323
00:25:31,049 --> 00:25:36,039
all the credentials as they go past what
about the Amazon Web Services well if

324
00:25:36,039 --> 00:25:39,459
you think a print as a torrent link to
the Tor network may be late to be

325
00:25:39,459 --> 00:25:43,359
natural straight export traded that the
just pulling up SharePoint with some

326
00:25:43,359 --> 00:25:48,739
context this makes things a slightly
different view on this anomaly detection

327
00:25:48,739 --> 00:25:53,940
in the people have a really controlled
environment you can work with the other

328
00:25:53,940 --> 00:25:56,730
way just detect things that you think
might be troublesome

329
00:25:56,730 --> 00:26:01,130
if you have a corporate image and
everyone uses one version of one browser

330
00:26:01,130 --> 00:26:04,809
all the time or just a couple of
browsers you can have fingerprints for

331
00:26:04,809 --> 00:26:08,429
your known corporate tool that everyone
uses anything else

332
00:26:08,429 --> 00:26:11,660
presumably back you don't even need to
think about what it is

333
00:26:11,660 --> 00:26:18,730
use language like you should be going to
look at and have a look

334
00:26:18,730 --> 00:26:22,440
defenders point of view it's not just
about all the hacking you don't need to

335
00:26:22,440 --> 00:26:25,370
be looking at hacking tools and picking
them out there are a couple of other

336
00:26:25,370 --> 00:26:30,410
things on your network you probably
don't want to see like that

337
00:26:30,410 --> 00:26:36,360
Java for example has a fingerprint when
it goes to update itself from the web

338
00:26:36,360 --> 00:26:37,929
server on the Internet

339
00:26:37,929 --> 00:26:42,990
also any after road has compiled in job
will have the job fingerprint secret

340
00:26:42,990 --> 00:26:46,299
spot someone using Java if you have an
environment where you about that because

341
00:26:46,299 --> 00:26:53,400
you might have tools that are against
corporate policy despite being fined in

342
00:26:53,400 --> 00:26:54,360
their own right

343
00:26:54,360 --> 00:26:57,520
you may not want them in your
environment depending on what it is you

344
00:26:57,520 --> 00:27:01,900
may have tools that you just don't want
to talk to the Internet directly there

345
00:27:01,900 --> 00:27:05,630
is a really nice security tools that are
great in the hands of your scrutiny but

346
00:27:05,630 --> 00:27:08,590
when they come from the finance
department and appointing a box you're

347
00:27:08,590 --> 00:27:14,260
probably less pleased about them you
probably also have things do you expect

348
00:27:14,260 --> 00:27:18,360
humans to interact with so when you
start seeing scripts interacting with

349
00:27:18,360 --> 00:27:21,690
them then that's probably a sign you got
some kind of issue you need to address

350
00:27:21,690 --> 00:27:27,610
and all these signatures are in the
database and I'm gonna give you the end

351
00:27:27,610 --> 00:27:34,559
so attacked her attackers a lonely man
in the middle when it comes to Taylor's

352
00:27:34,559 --> 00:27:40,570
because possibly doing something with
Taylor's doesn't have a whole bunch of

353
00:27:40,570 --> 00:27:45,190
ways to get in the middle and it depends
on who the person is so it depends where

354
00:27:45,190 --> 00:27:49,549
they are how well they are technical
capabilities that kind of thing you'll

355
00:27:49,549 --> 00:27:52,710
notice peas in a very different place to
man in the middle you as opposed to

356
00:27:52,710 --> 00:27:57,419
someone who's on your network during UPS
moving for example then you can do the

357
00:27:57,419 --> 00:28:01,740
whole oh my god nation states BGP
hijacking and all that stuff there are

358
00:28:01,740 --> 00:28:04,000
two ways but either way

359
00:28:04,000 --> 00:28:09,120
beginning in the middle and actively
interested in traffic modifying traffic

360
00:28:09,120 --> 00:28:10,020
blocking traffic

361
00:28:10,020 --> 00:28:14,200
this list is not exhaustive but it does
give you a flavour of the different ways

362
00:28:14,200 --> 00:28:19,200
so what i'll be attacks on Taylor's
lawyer claimed the three groups you

363
00:28:19,200 --> 00:28:23,310
can't a client that's known to have
weaknesses so the client doesn't check

364
00:28:23,310 --> 00:28:28,040
certificates as certificate training
issues it supports weak ciphers crack

365
00:28:28,040 --> 00:28:32,630
whatever their attacks against Hitler
slobodan frameworks they have coding

366
00:28:32,630 --> 00:28:38,740
issues they have before overflows
whatever they they they do not check

367
00:28:38,740 --> 00:28:42,990
things properly things like are pleased
with his bounds checking issues I know

368
00:28:42,990 --> 00:28:48,540
that's a service but these example and
then the other one is CIA issues you

369
00:28:48,540 --> 00:28:52,240
climb spine everything works fine in the
technology level but it trusts the CIA

370
00:28:52,240 --> 00:28:56,550
thats wrobel been hacked and so robust
it would still be effective against

371
00:28:56,550 --> 00:29:01,670
climb the enemy the attacker is of
course the perfectly functioning client

372
00:29:01,670 --> 00:29:05,930
flags a big error saying someone's
attacking me and raises the alarm this

373
00:29:05,930 --> 00:29:09,020
is what we're trying to avoid especially
in many of those man in the middle of

374
00:29:09,020 --> 00:29:13,830
situations where a single person has
been targeted this wholesale man in the

375
00:29:13,830 --> 00:29:17,890
middle against entire network if your
pen testing a distal a new man in the

376
00:29:17,890 --> 00:29:21,110
middle of the oldest of land you gonna
get a mix of clients you don't want that

377
00:29:21,110 --> 00:29:28,200
coming up and setting the alarm I miss
you defended you do what so let's look

378
00:29:28,200 --> 00:29:32,890
at standard Windows host and see what we
can do sorry no that's not a standard

379
00:29:32,890 --> 00:29:41,370
Windows a look at a standard Windows
host and see what we can do so what does

380
00:29:41,370 --> 00:29:49,870
he do well we can see this user has a
few browsers I don't know one URL to the

381
00:29:49,870 --> 00:29:53,560
next which browser is going to be
connecting if I have a chrome

382
00:29:53,560 --> 00:29:57,410
vulnerability and I drop it on Firefox
I'm gonna get no that's not very

383
00:29:57,410 --> 00:30:03,450
stealthy so I mean to drop it on the
browser that I want they will have a

384
00:30:03,450 --> 00:30:07,960
bunch of the tools on this book these
tools to create the US Naval sessions

385
00:30:07,960 --> 00:30:13,700
and that's you know they could be things
that I want to avoid the things I want

386
00:30:13,700 --> 00:30:17,100
to attack and this is just from a random
screenshot found on Google Images

387
00:30:17,100 --> 00:30:20,960
there's a bunch more on most people's
boxes

388
00:30:20,960 --> 00:30:27,520
so very well this in mind is the example
Google reported that there was a CIA

389
00:30:27,520 --> 00:30:35,470
there had gone rogue I want guests on a
better word issues too because they

390
00:30:35,470 --> 00:30:36,350
cannot be trusted

391
00:30:36,350 --> 00:30:41,630
they shoot the morning and so they
pulled it from Chrome as you would do to

392
00:30:41,630 --> 00:30:46,159
get the advantage over other people so
in this situation I i'm knowledgeable of

393
00:30:46,159 --> 00:30:50,409
this attack and I want to attack people
when I don't want to attack chrome

394
00:30:50,409 --> 00:30:52,990
because Google has just announced to me
that they're going to set up alerts when

395
00:30:52,990 --> 00:30:59,289
I do so have the client on man in the
middle ring through whatever DNS

396
00:30:59,289 --> 00:31:01,440
spoofing off spoofing or something

397
00:31:01,440 --> 00:31:05,120
the client doesn't TCP handshake with me
great I don't have to do anything

398
00:31:05,120 --> 00:31:10,270
without just maintain the handshake and
they said decline hello back it to me I

399
00:31:10,270 --> 00:31:16,539
run my finger printing its Safari Safari
Zone mine own bad database so I just

400
00:31:16,539 --> 00:31:21,059
would like a port forward i doing TCP
handshake of my own for the client hello

401
00:31:21,059 --> 00:31:24,630
packet onto the evil server and then
just passed package backwards and ports

402
00:31:24,630 --> 00:31:29,830
and that can be what everyone can be an
existing to like MITM proxy Metasploit

403
00:31:29,830 --> 00:31:36,020
or whatever else I'm using to attack it
and it can be on local who's the next

404
00:31:36,020 --> 00:31:40,990
connection comes in and has grown so I
bought it to wherever it was connecting

405
00:31:40,990 --> 00:31:45,120
to originally because I have the
destination IP address cuz that's in the

406
00:31:45,120 --> 00:31:50,590
IP header from any connected to me this
way I can still use the Chrome user

407
00:31:50,590 --> 00:31:56,630
never hits my exploit and never played
it up I never see this instead I think

408
00:31:56,630 --> 00:32:02,260
this is a little before I wrote all it
does is it listens for connections and

409
00:32:02,260 --> 00:32:07,179
boards to a different location dependent
on fingerprint it's or chrome and send

410
00:32:07,179 --> 00:32:17,659
it to the real Google it's all so Safari
and it sent it to the real Google they

411
00:32:17,659 --> 00:32:21,529
look at the next defender example you
can do fingerprint to find routing

412
00:32:21,529 --> 00:32:25,210
that's pretty much the same as well as
described just now but from a defensive

413
00:32:25,210 --> 00:32:26,049
point of view

414
00:32:26,049 --> 00:32:30,899
same again I place something in front of
my servers much like a reverse proxy

415
00:32:30,899 --> 00:32:33,700
gives the handshake

416
00:32:33,700 --> 00:32:38,490
and then I see my server is expecting
humans to come look at it it's a

417
00:32:38,490 --> 00:32:44,110
connection from Goa lang so I can gather
whatever internet once about what this

418
00:32:44,110 --> 00:32:48,139
person is doing and my real server
doesn't get touched by them when I get a

419
00:32:48,139 --> 00:32:51,919
crime connection however that get sent
to my real Server Pages get served and

420
00:32:51,919 --> 00:32:59,230
everything works soviet next attack a
level and the forensics the scenario is

421
00:32:59,230 --> 00:33:02,950
overly looked at my targets are prepared
on my exploits I'm ready I know who

422
00:33:02,950 --> 00:33:06,289
might who I'm attacking in the network
and I may even a drop the first-stage

423
00:33:06,289 --> 00:33:11,100
malware and phishing link but
essentially would have done these are

424
00:33:11,100 --> 00:33:15,490
set myself up so that the bypass the
firewall and waiting for the day to

425
00:33:15,490 --> 00:33:18,539
connect out from the network to meet and
I'm listening

426
00:33:18,539 --> 00:33:23,159
meanwhile back in inside the
organization

427
00:33:23,159 --> 00:33:28,330
these new key security defender guy has
spotted the euro and then using the

428
00:33:28,330 --> 00:33:32,299
standard tactic of using W get with the
modified user agent to appear to be I E

429
00:33:32,299 --> 00:33:39,880
72 come grab the sample more aware of my
books which is works all over the time

430
00:33:39,880 --> 00:33:45,419
because generally can't tell but if you
hosting malware on an HTTPS books tell

431
00:33:45,419 --> 00:33:51,830
us enabled you can Fordow get signature
to a seemingly innocuous server and you

432
00:33:51,830 --> 00:33:57,419
can send I seventy or attack server and
therefore the defense personal our

433
00:33:57,419 --> 00:34:02,880
analysts doesn't have this sample and
doesn't know you drop that stuff and

434
00:34:02,880 --> 00:34:08,520
then on the defense side you can do
fingerprint canaries we have margins

435
00:34:08,520 --> 00:34:13,280
platforms these days people in Netflix
and applications like FaceTime and

436
00:34:13,280 --> 00:34:16,389
blackberry messenger manage their entire
infrastructure so that they are in the

437
00:34:16,389 --> 00:34:20,329
service they own all the API endpoints
and they write the application it may

438
00:34:20,329 --> 00:34:24,369
not be on their infrastructure but is
there around they don't have third party

439
00:34:24,369 --> 00:34:30,520
apps so if you run a network like this
you could have been as you know when

440
00:34:30,520 --> 00:34:35,440
it's going to change and you know is you
don't necessarily have to do anything

441
00:34:35,440 --> 00:34:39,040
about it when you see a different thing
to bring come in it could be someone man

442
00:34:39,040 --> 00:34:41,950
in the middle of it could be someone
attacking you deliberately manning the

443
00:34:41,950 --> 00:34:45,800
man in the middle of cells using
something like the sweet for example

444
00:34:45,800 --> 00:34:49,990
or it could be a customer being man in
the middle either way you could detect

445
00:34:49,990 --> 00:34:55,310
and you can react to it and deal with it
and of course no talk about man in the

446
00:34:55,310 --> 00:34:59,160
middle in attacking would be complete
without the oh my god nation state

447
00:34:59,160 --> 00:35:06,450
attackers are coming up and some of that
might be useful to them in a phenom

448
00:35:06,450 --> 00:35:13,450
animal in things as usual if they see me
your Skype user use a particular IRC

449
00:35:13,450 --> 00:35:18,190
client or something they make you do
something useful to go in for further

450
00:35:18,190 --> 00:35:19,310
information

451
00:35:19,310 --> 00:35:23,140
some apps are only available when OS so
that signature tell them what OSU's or

452
00:35:23,140 --> 00:35:27,450
some other attack if they see that you
are using a particular gambling out they

453
00:35:27,450 --> 00:35:33,190
might have a gambling problem that they
could blackmail you for and in fact

454
00:35:33,190 --> 00:35:38,990
today in the press there was common
police came out where the UK GCHQ

455
00:35:38,990 --> 00:35:43,090
analyzing people's porn habits amongst
other things

456
00:35:43,090 --> 00:35:47,790
by looking at this you get a lot more
information if you're doing wholesale

457
00:35:47,790 --> 00:35:51,100
interception like that you could
essentially done a lot of information

458
00:35:51,100 --> 00:35:56,190
about people and an honorable mention
goes to honey honey pots crucial doing

459
00:35:56,190 --> 00:36:01,440
but I don't use the web threat
intelligence if you put your passing

460
00:36:01,440 --> 00:36:05,990
stool on https instead of HTTP you don't
just know what one bility someone is

461
00:36:05,990 --> 00:36:09,500
exploiting you know what they're
exploiting it with you if you were

462
00:36:09,500 --> 00:36:13,620
looking at groups and attribution being
able to say that this group not only is

463
00:36:13,620 --> 00:36:17,430
this exploit but they did it from some
movie script releases a lot more than

464
00:36:17,430 --> 00:36:21,680
they just you see these whatever and
even unknown fingerprints are good

465
00:36:21,680 --> 00:36:26,400
because the same unknown fingerprint
would mean reused codebase most likely

466
00:36:26,400 --> 00:36:29,710
and if you look at any of the
attribution stuff that's going on with

467
00:36:29,710 --> 00:36:34,250
malware reason code is a pretty common
thing he could do a set amount of

468
00:36:34,250 --> 00:36:37,890
attribution just from the fingerprint
without actually looking at what they

469
00:36:37,890 --> 00:36:44,270
did on the books so let's move to tools
calls it the funds that doesn't fit in a

470
00:36:44,270 --> 00:36:48,000
lab and is great for me to talk about it
but it doesn't really help you guys do

471
00:36:48,000 --> 00:36:50,410
anything so

472
00:36:50,410 --> 00:36:57,609
I'm releasing couple of tools people to
use this one is fingerprinted us it's a

473
00:36:57,609 --> 00:37:04,140
packet sniffer / pcap file reader if you
don't trust my tools running on that

474
00:37:04,140 --> 00:37:08,450
work you can capture them your own way
for you to pick up for it at this it

475
00:37:08,450 --> 00:37:13,490
does that cross party lines the Texans
though it will match signatures like you

476
00:37:13,490 --> 00:37:14,710
can see on the screen

477
00:37:14,710 --> 00:37:17,869
got a bunch of things saying there's a
torrent link there's much there's

478
00:37:17,869 --> 00:37:22,960
thunder bird whatever talking to these
house they all look at server name and

479
00:37:22,960 --> 00:37:26,780
play out the Taylor said Apple you and
tell you what it was connecting to not

480
00:37:26,780 --> 00:37:30,140
just from DNS but from the actual
hostname which gives you a lot more idea

481
00:37:30,140 --> 00:37:37,170
about what it it's so that's hopefully
useful the other one is a fingerprint

482
00:37:37,170 --> 00:37:42,119
apt which is just a pipe on script but
it takes that Jason file and it would

483
00:37:42,119 --> 00:37:47,950
sit in a number of different ways this
is a C struct so if you write C code and

484
00:37:47,950 --> 00:37:52,430
is probably changeable to other
languages that I don't know you can use

485
00:37:52,430 --> 00:37:56,450
it to put fingerprints in yourself so
apps can sell fingerprint incoming

486
00:37:56,450 --> 00:38:00,720
connections this was a fingerprint
showdown who counties can buy books all

487
00:38:00,720 --> 00:38:04,079
those packets nothing but it worked out
quite nicely because now I know all the

488
00:38:04,079 --> 00:38:11,289
notes are when they keep reconnecting
the next one is an IDS output its Sarah

489
00:38:11,289 --> 00:38:15,859
Carter and snore output this is probably
most useful to people because if you

490
00:38:15,859 --> 00:38:21,339
have existing ideas infrastructure you
can use this to push signatures hour and

491
00:38:21,339 --> 00:38:25,619
you don't even need to run any code of
mine you can have your ideas alert you

492
00:38:25,619 --> 00:38:30,779
when you see specific things you don't
like the look of its a bit funny looking

493
00:38:30,779 --> 00:38:36,809
because most ideas don't have support
for the various fields inside the SSL

494
00:38:36,809 --> 00:38:40,549
stream so I had to drive them myself so
you've got all these distance and bike

495
00:38:40,549 --> 00:38:45,630
jump rings to manage audio cassettes and
get there this is actually pretty short

496
00:38:45,630 --> 00:38:47,160
signature

497
00:38:47,160 --> 00:38:52,520
some of them are a little bit long and
if anyone tries it has issues before

498
00:38:52,520 --> 00:38:56,859
using slaw take a look at your main
config alike supreme and Alexis lol so

499
00:38:56,859 --> 00:39:00,690
it doesn't look like it did by the time
against the rules which is so little

500
00:39:00,690 --> 00:39:01,349
pool

501
00:39:01,349 --> 00:39:06,799
and the final output from this 110
second-to-last is there anyone from

502
00:39:06,799 --> 00:39:13,009
single intelligence here that submitting
it know if you were to admit to being in

503
00:39:13,009 --> 00:39:17,849
signals in its again I did excuse core
output so that you can go and attack

504
00:39:17,849 --> 00:39:22,269
everyone on the network to it's actually
the least reliable of the signatures I

505
00:39:22,269 --> 00:39:30,999
don't know what to do with it was too
late standardization because when you do

506
00:39:30,999 --> 00:39:33,869
you think you print it stores some of
your personal data in there like the

507
00:39:33,869 --> 00:39:36,950
service connecting to show you what the
street that out before you go and

508
00:39:36,950 --> 00:39:40,960
publish it to someone else rather than
it being in your sample your cooking it

509
00:39:40,960 --> 00:39:48,759
does indeed you and that's kind of the
way back machine bought archive my

510
00:39:48,759 --> 00:39:55,829
machine it matched the same as Jabba
through I kind of had a raging flip out

511
00:39:55,829 --> 00:40:03,819
like a moment because I thought I was
getting bad fingerprint collisions were

512
00:40:03,819 --> 00:40:08,529
coming my way and I got down like a bad
run a whole but it turns out thanks to

513
00:40:08,529 --> 00:40:15,249
the mothers have given in Java and I
completely corrected fingerprints after

514
00:40:15,249 --> 00:40:21,069
all so this brings it when I saw the
little point that you can use this to

515
00:40:21,069 --> 00:40:27,279
determine the lineage about compiled
outs less scripted star and certain

516
00:40:27,279 --> 00:40:32,430
things like going in Java sort of nine
between area have very specific

517
00:40:32,430 --> 00:40:40,989
signatures I was just for PHP Python
movie it's very useful for being able to

518
00:40:40,989 --> 00:40:43,890
determine when someone's attacking you
know just what they're doing but what

519
00:40:43,890 --> 00:40:50,719
they're using to do it finally I'm
releasing the fingerprint database

520
00:40:50,719 --> 00:40:56,099
itself it's far from comprehensive but
it does have a lot of things probably

521
00:40:56,099 --> 00:41:00,729
got about a hundred and fifty signatures
in the main file which includes browsers

522
00:41:00,729 --> 00:41:09,739
email clients web of connections IRC
clients a gambling at Java duty less and

523
00:41:09,739 --> 00:41:10,990
bunch of other stuff

524
00:41:10,990 --> 00:41:17,260
there is a little while with Matt 250
ish signatures long delay separated out

525
00:41:17,260 --> 00:41:21,980
if you've ever used the SSL labs
difficult checker it throws some

526
00:41:21,980 --> 00:41:25,850
ridiculous number of tests and generates
two hundred and fifty unique signatures

527
00:41:25,850 --> 00:41:31,640
are you may want to exclude that as well
as separated it but if you're interested

528
00:41:31,640 --> 00:41:38,119
in people scanning you that might be of
use so we get to the demo but inevitably

529
00:41:38,119 --> 00:41:45,940
fails because it's a demo so I was going
to attack them I was going to show you

530
00:41:45,940 --> 00:41:51,430
the googles and then I thought well this
is the Fixit track its defensive more

531
00:41:51,430 --> 00:41:56,880
than offensive so you don't know that
the sides watching to Google's not error

532
00:41:56,880 --> 00:42:00,930
is not really a very exciting done so
well as you do this for the duration of

533
00:42:00,930 --> 00:42:05,619
this talk I had a listener running on
this machine 443 and have been running

534
00:42:05,619 --> 00:42:09,670
my fingerprints on it in the hope that
some malicious person is scanning the

535
00:42:09,670 --> 00:42:13,680
network and I can fingerprint scanning
me and that can be my really exciting

536
00:42:13,680 --> 00:42:34,789
dominant so let me just break out of
this recession and find so so

537
00:42:34,789 --> 00:42:39,189
so will you be my laptop in the
background going connecting out and

538
00:42:39,189 --> 00:42:42,859
doing a bunch of things as well as
people fingerprinting me that that would

539
00:42:42,859 --> 00:42:48,259
show really things in there because it's
got to take some for things like this

540
00:42:48,259 --> 00:42:54,400
point just to show you how it works out
creates and data so far as to curl the

541
00:42:54,400 --> 00:43:08,669
HTTPS interface of Google then here it
matched girl pretty quickly and did most

542
00:43:08,669 --> 00:43:22,309
of it aligns let me just put this back
no not now I am okay so that's what

543
00:43:22,309 --> 00:43:22,809
failed them

544
00:43:22,809 --> 00:43:27,359
predicted that with a 10 screen so
what's next

545
00:43:27,359 --> 00:43:31,969
I'd like to hear back from the community
on stuff I would love if people wanted

546
00:43:31,969 --> 00:43:36,269
to contribute signatures check things
out of gas hob fix my awful code to make

547
00:43:36,269 --> 00:43:41,339
it better for get into a cool thing
whatever help write new tools I would

548
00:43:41,339 --> 00:43:44,900
love to see this is like an Apache or
nginx module or something like that to

549
00:43:44,900 --> 00:43:50,059
treat clients typically negatively
instead of having to use slippers so if

550
00:43:50,059 --> 00:43:55,539
you want to be involved this is where is
the Taurus SHO drool on

551
00:43:55,539 --> 00:44:01,109
repository hope I foresee this Twitter
accounts if anyone wants to interact

552
00:44:01,109 --> 00:44:05,979
with me the slides Rome slideshow and
the blog post on the bottom is like a

553
00:44:05,979 --> 00:44:12,619
mini white paper outlines the technical
details of this without me willingly

554
00:44:12,619 --> 00:44:17,699
giving silly examples and we think some
random observations wrapping up

555
00:44:17,699 --> 00:44:26,900
OpenSSL Swiss assumed to be to have some
reason which I can see horrible the most

556
00:44:26,900 --> 00:44:30,999
popular extensions being used or
elliptic curves and signature algorithms

557
00:44:30,999 --> 00:44:35,299
for the elliptic curves which is why the
extensions that I do with differently

558
00:44:35,299 --> 00:44:39,170
which are neglected to mention

559
00:44:39,170 --> 00:44:43,180
I do a load of policy on extensions to
you'll see that the technical writer

560
00:44:43,180 --> 00:44:49,099
sorry and the other thing is everyone
when Snowden released a list of what he

561
00:44:49,099 --> 00:44:54,839
did said about never trusting missed
again mister P 256 and this to be 571

562
00:44:54,839 --> 00:45:00,329
curbs account for 98% of the
preferential kurds senior clients i've

563
00:45:00,329 --> 00:45:00,990
seen

564
00:45:00,990 --> 00:45:03,710
so all these don't trust this stuff
doesn't seem to have filtered down to

565
00:45:03,710 --> 00:45:10,319
the client is still seems to be fully
trusted and that is what I had if anyone

566
00:45:10,319 --> 00:45:13,589
wants to ask any questions that would be
great on hero comes to feel free to stop

567
00:45:13,589 --> 00:45:15,790
me otherwise likes

