1
00:00:00,040 --> 00:00:04,690
for that but alright so my name is
crypto so I'm going to present to you

2
00:00:04,690 --> 00:00:11,349
guys some research I did on hacking into
it at 2:15 94 networks but first a

3
00:00:11,349 --> 00:00:15,790
little bit about myself there is much
better handle there's my email there's

4
00:00:15,790 --> 00:00:18,700
my get home you're probably gonna wanna
check out at least one of those things

5
00:00:18,700 --> 00:00:24,490
by then to the talk and into race cars
next let's do I actually just got back

6
00:00:24,490 --> 00:00:29,650
from doing 24 hours and lemons last week
in Kershaw and if you know anything

7
00:00:29,650 --> 00:00:35,420
about that you raised shitty cars fast
and I work for Dept 13 I actually just

8
00:00:35,420 --> 00:00:41,840
quit my job and now working there full
time that's my startup so many of you do

9
00:00:41,840 --> 00:00:46,600
RAF for exploitation my mom drop me a
line again

10
00:00:46,600 --> 00:00:54,730
email now I'm kinda fast as I got about
30 slides and thinking only 15 minutes

11
00:00:54,730 --> 00:00:59,239
so I wanted everybody to have time for
questions and by the way what the street

12
00:00:59,239 --> 00:01:02,680
this more like Shahrukh Khan and you got
something to say just raise your hand on

13
00:01:02,680 --> 00:01:11,630
call you out and we can keep the kind of
a discussion shut up so first we gonna

14
00:01:11,630 --> 00:01:17,810
talk about what it is we're gonna talk
about how we talked 28215 not for us

15
00:01:17,810 --> 00:01:22,930
going to discuss the relation to that as
well as some other protocols that use to

16
00:01:22,930 --> 00:01:29,440
250 not for we're gonna go in depth into
the encryption mechanism that uses and

17
00:01:29,440 --> 00:01:34,820
I'm gonna follow that up with exploits
in attacks in the MAC layer which is it

18
00:01:34,820 --> 00:01:40,659
a 250 now for and then I'm going to or I
was going to demonstrate the maximum

19
00:01:40,659 --> 00:01:46,040
security system by smart things by it I
discovered when I got here that my hobby

20
00:01:46,040 --> 00:01:50,170
no longer wishes to talk to the light
switch which is pretty integral to

21
00:01:50,170 --> 00:01:54,540
demonstrate to a roomful of people that
your exploits working so

22
00:01:54,540 --> 00:01:58,580
maybe some other time but I do have a
video of it working so you'll have to

23
00:01:58,580 --> 00:02:02,520
take me on faith and so you can get home
and do it yourself because I'm gonna

24
00:02:02,520 --> 00:02:12,910
drop some tools for that ok wow it a 215
948 @ 2:59 for his the MAC layer and a

25
00:02:12,910 --> 00:02:22,930
sandwich of direct sequence spread
spectrum or QSR QPSK file layer and the

26
00:02:22,930 --> 00:02:28,170
ZigBee networking layer on top of it so
basically it's just the MAC layer in the

27
00:02:28,170 --> 00:02:33,990
standard OSI model runs addressing at a
low level right after the final layer

28
00:02:33,990 --> 00:02:39,290
and this is important because if you
find exploit in attitude 15 now for

29
00:02:39,290 --> 00:02:43,030
you've got an exploit and several
different protocols that use it

30
00:02:43,030 --> 00:02:48,700
including ZigBee six lo pan wireless
heart lightweight match so if you can

31
00:02:48,700 --> 00:02:57,010
get it kinda underlayer you've got more
access more things you can do this is

32
00:02:57,010 --> 00:03:02,570
this protocol stack and this is just a
good charge that want to destroy near

33
00:03:02,570 --> 00:03:07,800
CIA's can get a understanding of why
each portion of it does designee

34
00:03:07,800 --> 00:03:13,400
alliance is responsible for the
application layer down 22 the fire but

35
00:03:13,400 --> 00:03:18,519
they implement the attitude 15
outsourced back and they have the option

36
00:03:18,519 --> 00:03:22,930
to implement portions of it or all of it
or whatever it's true the available for

37
00:03:22,930 --> 00:03:26,739
anyone to use which is why it's so
popular with special with like the low

38
00:03:26,739 --> 00:03:34,670
rate devices and yeah that sums up
that's like

39
00:03:34,670 --> 00:03:49,950
so what is it be when you play yet is it
is named after bees because of the way

40
00:03:49,950 --> 00:03:53,989
that they do it to say hi to each other
and there's like a four-step handshake

41
00:03:53,989 --> 00:03:58,459
process associate to the network which
is known as the wiggle so they for some

42
00:03:58,459 --> 00:04:01,900
reason decided that was cool and named
it after bees

43
00:04:01,900 --> 00:04:06,810
it is currently found in factories
despite anything that needs a

44
00:04:06,810 --> 00:04:11,069
distributed sensor network
battery-powered mesh networking and

45
00:04:11,069 --> 00:04:14,830
especially in home automation and
security devices

46
00:04:14,830 --> 00:04:19,260
basically anytime you need a route
network around an unmovable object it's

47
00:04:19,260 --> 00:04:23,790
a good choice to use it be especially if
you're in like a remote area or you

48
00:04:23,790 --> 00:04:28,070
don't need to push that much doubt over
the line or something like that so it's

49
00:04:28,070 --> 00:04:32,950
found in a lot of different application
medical is is also on its in a lot of

50
00:04:32,950 --> 00:04:41,320
different shit and hacking now that's
real fuckin need oh so by the way just

51
00:04:41,320 --> 00:04:46,440
as an act as a quick aside XP not excuse
are created equal

52
00:04:46,440 --> 00:04:51,250
not all taxpayers do ZigBee some
expertise they implement 8259 for later

53
00:04:51,250 --> 00:04:55,340
but they have their own proprietary
protocol on top of them so if you're

54
00:04:55,340 --> 00:04:56,320
looking to get into

55
00:04:56,320 --> 00:05:04,090
ZigBee research and not attitude 15 54
research you should be aware of that ok

56
00:05:04,090 --> 00:05:09,440
so right now we know what it is 259 for
his the MAC layer in the sandwich of

57
00:05:09,440 --> 00:05:15,039
ZigBee and radio fileflyer we know where
can be found hospitals home automation

58
00:05:15,039 --> 00:05:21,200
environmental control all that kind of
good stuff we know who uses it because

59
00:05:21,200 --> 00:05:27,150
why it's used and now we need to know
how to interact with it and this is kind

60
00:05:27,150 --> 00:05:31,210
of where I think most people in the
communities struggle because I think

61
00:05:31,210 --> 00:05:35,169
everybody in here knew what he was
before they came in they probably have

62
00:05:35,169 --> 00:05:40,180
heard of any 259 for before but you've
probably never had to audit a network or

63
00:05:40,180 --> 00:05:41,969
you may not know where to begin

64
00:05:41,969 --> 00:05:46,379
and that's I think the most important
part of this talk besides the exploits

65
00:05:46,379 --> 00:05:50,759
I'll be dropping cuz you need to know
how to run their exploits right well

66
00:05:50,759 --> 00:05:54,969
there's turns out you got a couple of
options when you wanna just sniffing at

67
00:05:54,969 --> 00:06:00,059
work and so far the best and most
expensive option is this thing called

68
00:06:00,059 --> 00:06:06,919
siwell sniffer and this is it's a pretty
small device runs off a USB power from

69
00:06:06,919 --> 00:06:11,389
your computer plugged into the Ethernet
port and encapsulate ZigBee frames

70
00:06:11,389 --> 00:06:15,829
inside of Ethernet frames and puts that
around UDP and send it to your computer

71
00:06:15,829 --> 00:06:21,449
and so Wireshark picks up on it says
this will be my inside of you and just

72
00:06:21,449 --> 00:06:26,279
displays that to you in real quick
actually show you an example of this

73
00:06:26,279 --> 00:06:37,379
working and wants to display up there
apparently ok so in your opens never

74
00:06:37,379 --> 00:06:39,629
once you plug it in you

75
00:06:39,629 --> 00:06:45,389
finds itself its own IP address of 10 10
10 to you just go to it and say hey I

76
00:06:45,389 --> 00:06:50,239
want to change my radio settings and you
can go into the channel you want and it

77
00:06:50,239 --> 00:06:55,259
does everything that does Chinese
european-american and the 2.4 gigahertz

78
00:06:55,259 --> 00:07:00,899
isn bands so that you can take this
around the world and be good is the

79
00:07:00,899 --> 00:07:05,800
single best option for sniffing ZigBee
network sites out there it works

80
00:07:05,800 --> 00:07:09,339
a hundred percent of the time it's a
good reference implementation of

81
00:07:09,339 --> 00:07:16,129
sniffing and I won't break and literally
all you do is you say run and it starts

82
00:07:16,129 --> 00:07:21,349
shutting packets down the link to
Wireshark and this is a live feed of the

83
00:07:21,349 --> 00:07:27,350
network here at the hotel which is a
lightweight mesh

84
00:07:27,350 --> 00:07:36,430
guess that's only good for 8259 for its
a specialized chips in there now you

85
00:07:36,430 --> 00:07:41,720
could use GNU Radio that's totally an
option if you would like to spend one

86
00:07:41,720 --> 00:07:46,340
month it's going to take you to compile
it like I did then go ahead there's a

87
00:07:46,340 --> 00:07:52,520
guy named Bastien blows so who created a
fork of GNU Radio that allows you to use

88
00:07:52,520 --> 00:07:58,810
like you SRP one or whatever other STR
is compatible with any radio to sniff

89
00:07:58,810 --> 00:08:03,410
using GNU Radio but like I said it's a
total bitch to get working and you know

90
00:08:03,410 --> 00:08:07,070
that they tend to require more computing
power think this is a little bit more

91
00:08:07,070 --> 00:08:10,330
mobile and it's actually cheaper than
getting all that stuff set up together

92
00:08:10,330 --> 00:08:14,310
especially when you consider that amount
of time it takes to get everything ready

93
00:08:14,310 --> 00:08:22,830
now plus only Jeanne radio
implementation for me that I know of

94
00:08:22,830 --> 00:08:33,080
only does 2.4 and this does all of the
different bands so

95
00:08:33,080 --> 00:08:37,840
expensive option that costs about 250
euros by the way which is a checks last

96
00:08:37,840 --> 00:08:43,760
night's about roughly $286 American I
don't know what the Canadian as an owner

97
00:08:43,760 --> 00:08:48,170
but your cheap option is this

98
00:08:48,170 --> 00:08:55,300
AVR Raven dongle and a bra on not that
you can see it but it's about this big

99
00:08:55,300 --> 00:09:00,070
it's cheap it's 40 bucks you get it
directly from AVR on their webstore

100
00:09:00,070 --> 00:09:06,460
electronics are any of those locations
and for $40 you get a 2.4 gigahertz

101
00:09:06,460 --> 00:09:12,650
chipset that you can flash with killer
beyond it and killer bee is the thing

102
00:09:12,650 --> 00:09:16,850
that gives us our injection capability I
don't know if you guys like remember in

103
00:09:16,850 --> 00:09:20,760
the bad old days where you had to be
like you know this wireless card I have

104
00:09:20,760 --> 00:09:24,610
doesn't have an injection driver I can't
I can't run aircraft on I gotta go buy

105
00:09:24,610 --> 00:09:25,400
another one

106
00:09:25,400 --> 00:09:31,490
well this is still kind of in that same
maturity level so you have to get stuff

107
00:09:31,490 --> 00:09:34,900
that you know you can inject packets
onto and in order to do that you have to

108
00:09:34,900 --> 00:09:41,680
flash the firmware using a JTAG flasher
onto the DVR Raven has a little tiny

109
00:09:41,680 --> 00:09:49,620
gtech her on it and they tell you that
you need to have a specialized ETag nice

110
00:09:49,620 --> 00:09:56,660
mark 3 in order to flash it on there in
the cost about $350 I said that and i

111
00:09:56,660 --> 00:10:03,440
got one of these nights as a navy or red
dragon programmer has about 65 bucks so

112
00:10:03,440 --> 00:10:08,190
like your bare minimum entry into this
like to flash the card to get killer be

113
00:10:08,190 --> 00:10:13,230
on there and start injecting packets on
to a network is $105 I mean it's not a

114
00:10:13,230 --> 00:10:16,640
little bit of money but it's probably
more accessible to everybody in this

115
00:10:16,640 --> 00:10:21,450
room than buying a software-defined
radio or trying to buy one and say well

116
00:10:21,450 --> 00:10:29,660
as snipers so the steps for that pretty
simple actually got a guide on the

117
00:10:29,660 --> 00:10:34,680
killer bee framework which you can go to
a kill by River loop security and where

118
00:10:34,680 --> 00:10:39,760
my fork of it and they tell you just do
you put some jumper cables in there you

119
00:10:39,760 --> 00:10:45,380
just make sure they match you would text
file into AVR did you flash it profit

120
00:10:45,380 --> 00:10:48,750
done like it did the light turns yellow
you're good to go

121
00:10:48,750 --> 00:10:51,790
it takes it takes about 10 minutes and
most of the ten minutes is making sure

122
00:10:51,790 --> 00:10:58,310
you didn't like shoved the jumper cables
and so they're they're touching right as

123
00:10:58,310 --> 00:11:01,160
everybody track and so far any questions

124
00:11:01,160 --> 00:11:07,040
Simon is separate and encryption and I
like this image because it kinda

125
00:11:07,040 --> 00:11:13,500
represents some some of what happens in
ZigBee that's a run lock lock your car

126
00:11:13,500 --> 00:11:18,860
door and then put this run like around
it but I haven't RFID enabled system so

127
00:11:18,860 --> 00:11:24,640
what the fuck would that do for me and
he has some interesting characteristics

128
00:11:24,640 --> 00:11:30,810
to it that will go go over and go left
to raise your hand if any of the

129
00:11:30,810 --> 00:11:32,290
following is true

130
00:11:32,290 --> 00:11:42,920
pineapples are just delicious fruit wifi
secure because AES encryption does not

131
00:11:42,920 --> 00:11:46,160
equal security before a couple of
different reasons

132
00:11:46,160 --> 00:11:50,110
number one source informs his key
distribution like this is this is a

133
00:11:50,110 --> 00:11:55,120
problem he known about since wpa2 right
it's really fucking difficult to get

134
00:11:55,120 --> 00:11:59,500
your users sticky and then rotate the
key and make it so insecure and by the

135
00:11:59,500 --> 00:12:02,000
way when you give the key to somebody
you know they can give the keys to

136
00:12:02,000 --> 00:12:04,580
somebody else like you have no control
over it

137
00:12:04,580 --> 00:12:09,350
that's why they made wpa2 enterprise
right and that still has problems in

138
00:12:09,350 --> 00:12:16,710
fact by not having enterprise you just
have whatever you like you can touch

139
00:12:16,710 --> 00:12:21,380
basically so there's no good way for you
to load keys and distribute keys and

140
00:12:21,380 --> 00:12:27,140
rotate keys and ZigBee they do have a
couple different mechanisms for ZigBee

141
00:12:27,140 --> 00:12:34,240
coordinators to become key repositories
but in practice it doesn't work so great

142
00:12:34,240 --> 00:12:35,779
on the residential side

143
00:12:35,779 --> 00:12:39,329
and it doesn't matter anyway because
we're dealing with battery-powered

144
00:12:39,329 --> 00:12:42,499
devices that you're putting out in the
field and you know maybe they're on the

145
00:12:42,499 --> 00:12:46,160
side of a building or something someone
can come along just like steel it dumped

146
00:12:46,160 --> 00:12:49,360
the flash chip and then you've got
you've got the network key like you can

147
00:12:49,360 --> 00:12:53,749
join to it now so that doesn't it's not
really agree barrier for entry when I

148
00:12:53,749 --> 00:12:57,839
can just steal the device some high as
some like high assurance devices will

149
00:12:57,839 --> 00:13:03,639
have like a glass or plastic on as he
can do that is easily but come on like

150
00:13:03,639 --> 00:13:10,639
you just take some acid and get that she
also does not always encrypt all layers

151
00:13:10,639 --> 00:13:17,499
has support for Anna keeps saying what I
mean his 8215 up for that matter claire

152
00:13:17,499 --> 00:13:23,790
has the ability to be a yes encrypted
but it is very very rarely enabled for

153
00:13:23,790 --> 00:13:29,370
whatever reason and it's now almost
never enabled in ZigBee residential mood

154
00:13:29,370 --> 00:13:35,189
and city residential mood is consumer
devices so they only down the encrypted

155
00:13:35,189 --> 00:13:41,199
the ZigBee network where in fact so you
can fuck with 8250 now for all day long

156
00:13:41,199 --> 00:13:45,110
without any repercussions after worrying
about any of the security is on your

157
00:13:45,110 --> 00:13:50,720
touching a consumer device also beacons
aren't encrypted and it's kind of dumb

158
00:13:50,720 --> 00:13:57,019
because you can do Carmo despite attacks
stories and if you join a encrypted

159
00:13:57,019 --> 00:14:01,750
network but say that you don't support
encryption and network allows you to

160
00:14:01,750 --> 00:14:13,339
join it will give you the key in the
clear I don't know why so what if it is

161
00:14:13,339 --> 00:14:17,379
encrypted when you get there by the way
that last part is like that that's why I

162
00:14:17,379 --> 00:14:22,649
had the picture of the run locke says
that's just fucking dumb so what if it

163
00:14:22,649 --> 00:14:27,679
is encrypted well you could spam beacons
with matching can ID's and the network

164
00:14:27,679 --> 00:14:33,709
will barf you can speed spoof begins of
order intermediate pan ideas and pick up

165
00:14:33,709 --> 00:14:36,499
orphans and so like when

166
00:14:36,499 --> 00:14:40,790
coordinator did which is analogous to
the base station

167
00:14:40,790 --> 00:14:45,880
wifi when they have to change their
network IDs they have to go out to every

168
00:14:45,880 --> 00:14:50,580
single device in currently connected
ZigBee network and say hey I'm changing

169
00:14:50,580 --> 00:14:55,130
you gotta change with me and if you do
it fast enough like shit will just drop

170
00:14:55,130 --> 00:15:00,450
off and start me like I was here now
what's going on so you could potentially

171
00:15:00,450 --> 00:15:05,670
pick up anything that's been or friend
using spoofed weekends and you didn't

172
00:15:05,670 --> 00:15:10,670
have to deal with any encryption at all
throughout this process and also you can

173
00:15:10,670 --> 00:15:13,320
still see the Mad Hatter's so you can
determine some information about the

174
00:15:13,320 --> 00:15:17,520
network and as sentences interesting
because the Department of Homeland

175
00:15:17,520 --> 00:15:24,770
Security Commission to paper on how to
secure the inside of critical

176
00:15:24,770 --> 00:15:29,560
infrastructure and there's a line inside
of the paper is as if you encrypt at the

177
00:15:29,560 --> 00:15:34,210
MAC layer if you encrypt it a 250 not
for that accurate i cant see anything it

178
00:15:34,210 --> 00:15:39,250
can even see who's talking away as
patently fucking false because this is

179
00:15:39,250 --> 00:15:43,950
what encrypted zinc oxide encrypted it
in 1504 looks like only thing it's

180
00:15:43,950 --> 00:15:51,240
encrypted is the frame payload for the
max rain and it like that could be like

181
00:15:51,240 --> 00:15:55,230
a command but look at all the other
stuff that's only got a message

182
00:15:55,230 --> 00:16:00,360
integrity code applied to it so you you
know who's talking the way and you can

183
00:16:00,360 --> 00:16:09,350
actually get a general idea based off
the packet size like what's going on

184
00:16:09,350 --> 00:16:13,260
I guess said you can still see who's
talking up an idea which is important

185
00:16:13,260 --> 00:16:18,900
for performing one of my attacks going
you can't see is basically anything

186
00:16:18,900 --> 00:16:22,690
other than an acknowledgement frame
which is important because you can still

187
00:16:22,690 --> 00:16:26,390
spoof somebody something that's not
there by just asking packets and

188
00:16:26,390 --> 00:16:33,610
redirected to it and weekends like I
said you never gonna run into this

189
00:16:33,610 --> 00:16:39,080
problem generally speaking when you do
10 tests on attitude $15 for because now

190
00:16:39,080 --> 00:16:43,060
I can Christians not typically enabled
vendors don't want that extra step of

191
00:16:43,060 --> 00:16:46,400
having to plug in every single device at
the user wants to connect to their home

192
00:16:46,400 --> 00:16:51,400
automation network and regulators
considered protected the important shit

193
00:16:51,400 --> 00:16:57,680
right is so you can see these 8259 for
command frames coming by but when they

194
00:16:57,680 --> 00:17:01,750
have designee encryption turned on you
like I know it's a light bulb I know

195
00:17:01,750 --> 00:17:07,780
it's ending the turn on command but I
can't I can't send that to it but you

196
00:17:07,780 --> 00:17:14,350
can do other shit so we got through half
of the battle which is which is knowing

197
00:17:14,350 --> 00:17:22,740
stuff the other half is ready lasers and
blue blazers I'm told what's going into

198
00:17:22,740 --> 00:17:27,500
some of the attacks and I'm actually
like my time so there's a lot of time

199
00:17:27,500 --> 00:17:33,860
for questions some of these attacks I
have implemented inside of the killer

200
00:17:33,860 --> 00:17:39,480
bee attacks we maintain a fork which is
currently like 23 commits ahead of me

201
00:17:39,480 --> 00:17:47,040
sweet and they're in the process of
approving my request so if you go to get

202
00:17:47,040 --> 00:17:52,470
help dot com slash crypto US / killer
bee you can go see these attacks that

203
00:17:52,470 --> 00:17:55,890
have implemented before they've been
accepted into Maine

204
00:17:55,890 --> 00:18:00,740
and get a good sense of what's going on
I'm still working on a couple of other

205
00:18:00,740 --> 00:18:07,680
things which all talk about it and you
keep hearing me talk about the command

206
00:18:07,680 --> 00:18:12,410
frame in the command frames the types
are there there God for you

207
00:18:12,410 --> 00:18:16,570
for attacking as a network there are
nine total right now there are some

208
00:18:16,570 --> 00:18:21,600
reserved slots obviously nines on a big
number you got associations dis

209
00:18:21,600 --> 00:18:27,100
associations Association responses data
requests span I D conflict notifications

210
00:18:27,100 --> 00:18:31,860
orphan notifications beacon requests
coordinator realignment requests and

211
00:18:31,860 --> 00:18:33,440
guarantee times on request

212
00:18:33,440 --> 00:18:37,990
what kind of drill down into these days
they're pretty important Association

213
00:18:37,990 --> 00:18:42,690
request abuse make a shit ton of
associations to advise and wait for it

214
00:18:42,690 --> 00:18:46,880
to fall off a these days in a powerful
devices routers are not powerful they

215
00:18:46,880 --> 00:18:52,290
don't need to be right a lot of them and
just have some danky you know arm I am

216
00:18:52,290 --> 00:18:56,890
x6 device in there I mean it's faster
than in the midst of ice maybe but you

217
00:18:56,890 --> 00:19:02,680
can still overwhelmed there's a lot of
shit going on the network to so you got

218
00:19:02,680 --> 00:19:07,840
Association response you can join a
device talent that that shit went well

219
00:19:07,840 --> 00:19:11,090
and it didn't so it still thinks it's
connected to something when it really

220
00:19:11,090 --> 00:19:16,080
didn't have fell off there's
disassociation notify which is

221
00:19:16,080 --> 00:19:21,200
airdrop so you know you can kick it off
I've actually seen interesting enough if

222
00:19:21,200 --> 00:19:25,340
you remember when I said that you're not
obligated to implement the full 8259

223
00:19:25,340 --> 00:19:30,030
force packed a lot of people they don't
implement disassociation notify I know

224
00:19:30,030 --> 00:19:33,360
for a fact that I've never seen a
disassociation requests come from a

225
00:19:33,360 --> 00:19:37,230
smart things device so that they
probably just don't have that part of

226
00:19:37,230 --> 00:19:41,030
this back enabled because why would you
need to tell something I need to go away

227
00:19:41,030 --> 00:19:47,400
it's part of your home network it should
never be off the network there's data

228
00:19:47,400 --> 00:19:52,010
request which is actually that is
required for part of the joint process

229
00:19:52,010 --> 00:19:57,490
you can overwork a battery-powered
devices in that and typically the

230
00:19:57,490 --> 00:20:01,530
battery life on using the device is
going to be somewhere around like couple

231
00:20:01,530 --> 00:20:06,010
mines a year to year something like that
is really

232
00:20:06,010 --> 00:20:14,270
low power low duty cycle in fact you can
only transmit 250 kbps over so you can't

233
00:20:14,270 --> 00:20:19,730
even do fucking video you could barely
do audio so these devices are not

234
00:20:19,730 --> 00:20:23,680
powerful and that's by design because
they don't want to be running out into

235
00:20:23,680 --> 00:20:29,140
the field every week to change a triple
A battery or some shit like that so if

236
00:20:29,140 --> 00:20:33,430
you constantly poll something for dad
it's gonna let you know you're gonna

237
00:20:33,430 --> 00:20:37,340
drain the device in the back she had
issues where as I'm doing my attacks

238
00:20:37,340 --> 00:20:42,010
like this door sensor was blasting me
that these quite triple A batteries for

239
00:20:42,010 --> 00:20:51,550
like a year why my down 21 percent after
six months you also have conflict

240
00:20:51,550 --> 00:20:57,190
notifications which say hey I'm on the
edge of the network node your your

241
00:20:57,190 --> 00:21:03,290
further in geographically speaking and I
detected that there is another network

242
00:21:03,290 --> 00:21:08,950
out there that's sharing the same pan I
D number a nap an idea on ZigBee is the

243
00:21:08,950 --> 00:21:17,400
SSID now just a society in wifi so if
there is an SSID conflict in wifi that

244
00:21:17,400 --> 00:21:23,660
doesn't create as much problems by on
ZigBee it does so the device will say

245
00:21:23,660 --> 00:21:30,720
hey I saw a packet and match your I D
you should change your your network I D

246
00:21:30,720 --> 00:21:36,530
and then cordero go okay I'll do that
and then reconfigure the network using

247
00:21:36,530 --> 00:21:40,480
those coordinator realignment packets it
says hey here's my new channel here's my

248
00:21:40,480 --> 00:21:48,230
new pet a pain I D then there's orphan
notifications orphan notifications are

249
00:21:48,230 --> 00:21:53,850
win a device falls off the network it
will say hey I haven't heard from my

250
00:21:53,850 --> 00:21:58,270
coordinator in a while I'm going to do
something about this when I broadcasts

251
00:21:58,270 --> 00:22:02,990
out constantly that I am falling off the
network and i'm looking for a

252
00:22:02,990 --> 00:22:07,850
coordinator realignment packet please
send it to me please send it to me and

253
00:22:07,850 --> 00:22:13,380
actually we can go over to our

254
00:22:13,380 --> 00:22:26,759
handy dandy say whoa sniffer weekend

255
00:22:26,759 --> 00:22:30,869
see that there's a couple of devices
that are on the hotel's network right

256
00:22:30,869 --> 00:22:48,729
now that are orphaned come on break here
we see that the extended source says

257
00:22:48,729 --> 00:22:54,070
it's an ass out boi lock and might be
interesting for a number of reasons but

258
00:22:54,070 --> 00:23:02,109
if you think about it man I hope that
doesn't fail closed but the other

259
00:23:02,109 --> 00:23:05,599
problem is if I did send that a
coordinator realignment packet probably

260
00:23:05,599 --> 00:23:13,629
ok sure I'll take that and so if I send
it that that packet I can tell the

261
00:23:13,629 --> 00:23:17,089
change channel change pan ID's and
someone's got to actually physically

262
00:23:17,089 --> 00:23:19,499
come up to the lock open it up

263
00:23:19,499 --> 00:23:23,440
reset the lac rejoin into the network
like this is not it is a non-trivial

264
00:23:23,440 --> 00:23:27,829
process if I reconfigured this device
someone would have to touch so imagine

265
00:23:27,829 --> 00:23:32,299
if you did that turn important sensor
network that fell off that was supposed

266
00:23:32,299 --> 00:23:36,599
to be coming back are you jammed into it
sent out or for notifications using just

267
00:23:36,599 --> 00:23:42,909
like a typical energy jamming you can do
so you know that maybe not a lot of

268
00:23:42,909 --> 00:23:46,339
damage but you could cause annoyance by
having a technician come out there and

269
00:23:46,339 --> 00:23:47,489
have to fix it

270
00:23:47,489 --> 00:23:52,619
there's a lot of locks by the way
looking for more offense and just kind

271
00:23:52,619 --> 00:24:03,609
of twitching try not to do anything I
one of the tools will get to that ok so

272
00:24:03,609 --> 00:24:09,099
then we have a beacon request and again
it's the same thing as a wifi began its

273
00:24:09,099 --> 00:24:14,479
got up and I D and what will happen is
you'll see a beacon requests come out

274
00:24:14,479 --> 00:24:19,449
and you'll see a beacon response and it
became responsible here is my man I D

275
00:24:19,449 --> 00:24:23,569
number you should join me and then that
kinda is the impetus to start the

276
00:24:23,569 --> 00:24:28,259
Association process so since these
aren't encrypted like this is tremendous

277
00:24:28,259 --> 00:24:29,219
point-man

278
00:24:29,219 --> 00:24:32,779
plain and simple and I'm actually
working on that right now who last night

279
00:24:32,779 --> 00:24:34,870
going to a party I was coming that up

280
00:24:34,870 --> 00:24:40,210
so I'm hoping that may be released by
the end of next week we'll see question

281
00:24:40,210 --> 00:24:45,680
mark so that could be useful for a
number of reasons because like I said if

282
00:24:45,680 --> 00:24:49,620
you sent it there realignment came and
got into your network or it's like

283
00:24:49,620 --> 00:24:53,020
somebody's trying to set up a network
and you just made it join your network

284
00:24:53,020 --> 00:24:57,360
MANET be really fucking annoying can get
their shit the work is joining my

285
00:24:57,360 --> 00:25:01,809
network before it ever joins euros and
since my my codes Purpose Driven just

286
00:25:01,809 --> 00:25:03,660
respond as fast as possible

287
00:25:03,660 --> 00:25:06,890
your corner doesn't get a chance

288
00:25:06,890 --> 00:25:11,890
alright so we also have those
coordinator realignment frames I was

289
00:25:11,890 --> 00:25:16,450
talking about they allow you to change
the channel or the pan idea of a target

290
00:25:16,450 --> 00:25:21,080
device generally speaking you need to
send these out when the devices in a

291
00:25:21,080 --> 00:25:25,130
state to receive it so you can't just go
I'm gonna configure all of you

292
00:25:25,130 --> 00:25:31,390
motherfuckers but at least in my my
experience that hasn't worked they do

293
00:25:31,390 --> 00:25:36,050
have a ZigBee way of doing this and
layer 3 so it depends on whether or not

294
00:25:36,050 --> 00:25:40,640
a year network that you're attacking
supports to 259 for mechanism of during

295
00:25:40,640 --> 00:25:44,440
the realignment or maybe they have
something going on in to see you later I

296
00:25:44,440 --> 00:25:49,790
know not enough about that specific
package I think that's definitely a

297
00:25:49,790 --> 00:25:55,510
direction further research should be
performed in and I think there's

298
00:25:55,510 --> 00:26:00,320
definitely some gold in them there hills
and then finally there's a guaranteed

299
00:26:00,320 --> 00:26:05,700
time song requests and this is important
because he can enable networks they have

300
00:26:05,700 --> 00:26:11,130
a weekend that goes out whether or not
someone requests one that has certain

301
00:26:11,130 --> 00:26:16,250
information in it called guarantee in
time slide and the guaranteed time so I

302
00:26:16,250 --> 00:26:20,610
allocate a portion of the network which
is normally carrier sense multiple

303
00:26:20,610 --> 00:26:26,279
access collision avoidance and turns it
into like you talk it at this time

304
00:26:26,279 --> 00:26:29,840
so if you fill all those slots by the
way there for their first come first

305
00:26:29,840 --> 00:26:33,559
serve if you fill the slots many other
things that are supposed to be like

306
00:26:33,559 --> 00:26:37,799
speaking at correct timed intervals
won't get the chance to because the

307
00:26:37,799 --> 00:26:47,739
slots are filled so they're fucked so I
don't have a tool for guaranteed times I

308
00:26:47,739 --> 00:26:53,139
request yet because I don't really see
too many devices using it but I that's

309
00:26:53,139 --> 00:27:01,089
because I haven't taken a look at any
critical infrastructure things yet ok so

310
00:27:01,089 --> 00:27:06,669
again this is what Association flood
looks like an attacker indicates the

311
00:27:06,669 --> 00:27:11,269
target coordinator with the many clients
that are crashes or losses legitimate

312
00:27:11,269 --> 00:27:15,599
clients as a bonus you could respond to
all the packets directed to fake

313
00:27:15,599 --> 00:27:20,950
addresses with active force a
coordinator to hold fake clients so if

314
00:27:20,950 --> 00:27:25,200
they try to drop things by checking to
see if they back packets recently then

315
00:27:25,200 --> 00:27:31,629
you can continue to for it as I
disassociation which is airdrop again

316
00:27:31,629 --> 00:27:37,049
this is kinda hit or miss in my
experience but the tool exists key

317
00:27:37,049 --> 00:27:41,889
recovery attack using a network device
that does not support encryption joining

318
00:27:41,889 --> 00:27:46,839
its encrypted network which is allowing
a encrypted device to join to it will

319
00:27:46,839 --> 00:27:53,239
get you the password can I D conflict
attack and we we kind of brush up

320
00:27:53,239 --> 00:27:57,009
against this month earlier if you send
up an idea conflict notification the

321
00:27:57,009 --> 00:28:01,809
coordinator must rely on the network and
has to touch every single device if you

322
00:28:01,809 --> 00:28:06,729
do that very fast and you're dealing
with very slow devices

323
00:28:06,729 --> 00:28:10,809
some of them will stop working and
that's what I'm going to show you a

324
00:28:10,809 --> 00:28:16,190
little bit later you can also just do a
forced pan I D conflict attack where you

325
00:28:16,190 --> 00:28:21,539
just makin deacons that matched up an
idea of the coordinator and now you

326
00:28:21,539 --> 00:28:26,359
don't have to tell the coordinator that
you detected a man I D conflict you can

327
00:28:26,359 --> 00:28:30,649
just say there is a plan I D conflict
you must change now and it will work

328
00:28:30,649 --> 00:28:32,720
perfectly

329
00:28:32,720 --> 00:28:38,480
this this causes any networks to flip
the fuck out especially smart things

330
00:28:38,480 --> 00:28:44,659
smart things devices what will happen is
the network will degrade the devices

331
00:28:44,659 --> 00:28:48,870
will fall off the corner will continue
to work because the coordinators still

332
00:28:48,870 --> 00:28:55,210
on the internet still responding to
commands on the smart things device and

333
00:28:55,210 --> 00:28:59,130
your phone will not tell you that
anything is wrong

334
00:28:59,130 --> 00:29:02,610
meanwhile I'm walking into your front
door because the motion sensor is broken

335
00:29:02,610 --> 00:29:07,100
you don't have any door detection and
nothing on your lights are turning on

336
00:29:07,100 --> 00:29:10,630
your alarms aren't working and then I
shut the door when I'm done robbing you

337
00:29:10,630 --> 00:29:13,370
and then your device had stopped doing
attack

338
00:29:13,370 --> 00:29:18,470
network heals itself devices issue
beacon requests they do go through the

339
00:29:18,470 --> 00:29:24,150
Association process again they joined
back nothing happened so we really are

340
00:29:24,150 --> 00:29:27,970
on the attack steal your shit stop
running attack nothing happens you just

341
00:29:27,970 --> 00:29:35,370
come home to an empty house there's also
false or if an attack where you can say

342
00:29:35,370 --> 00:29:40,610
hey this device dropped off the network
i'm looking for a realigning frame in a

343
00:29:40,610 --> 00:29:44,820
chance to confuse the coordinator I
haven't seen this actually work yet but

344
00:29:44,820 --> 00:29:48,309
again I've only tested a couple of
different manufacturers to put the two

345
00:29:48,309 --> 00:29:54,330
out there just to see if maybe we get a
win somehow and there's also malicious

346
00:29:54,330 --> 00:29:55,870
acknowledgments

347
00:29:55,870 --> 00:30:00,530
is an area of research that's
particularly interesting and TCP where

348
00:30:00,530 --> 00:30:05,919
you can kind of just limp a connection
along well you can do the same thing

349
00:30:05,919 --> 00:30:09,159
here you can when the connection along
even if the device isn't there anymore

350
00:30:09,159 --> 00:30:15,470
and making sure that things seem ok
south will start breaking but it won't

351
00:30:15,470 --> 00:30:21,190
have technically disassociated from the
network and there's also this pretty

352
00:30:21,190 --> 00:30:27,330
interesting attack using the crypto so
for crypto enable networks you can send

353
00:30:27,330 --> 00:30:32,380
junk frames with interment encounters
which will cause the device to process

354
00:30:32,380 --> 00:30:33,429
the mic

355
00:30:33,429 --> 00:30:35,200
message integrity code

356
00:30:35,200 --> 00:30:39,860
and then drop the frame well when you
talk about a battery-powered device even

357
00:30:39,860 --> 00:30:45,049
if you have a specialized a yes
extensions on whatever microprocessor

358
00:30:45,049 --> 00:30:48,380
you've got in that little thing you know
I just don't burning a lot of battery

359
00:30:48,380 --> 00:30:52,769
power to get that checked so if you're
just constantly sending a bad packets

360
00:30:52,769 --> 00:30:56,750
it's got a holiday I it's just going to
get its gonna heat up and drop off when

361
00:30:56,750 --> 00:31:00,840
it runs out of battery power and there's
been some academic papers that suggests

362
00:31:00,840 --> 00:31:04,639
that you can run a battery-powered
device that is supposed to last one year

363
00:31:04,639 --> 00:31:12,070
down to 24 hours by using this attack so
here's where I would give a

364
00:31:12,070 --> 00:31:17,130
demonstration if I had a working in
person one however apparently performed

365
00:31:17,130 --> 00:31:21,570
by sacrificing correctly and did not
help her at Cloud appropriately and

366
00:31:21,570 --> 00:31:26,549
hooded figures have denied my past so I
will instead attempts to use the video

367
00:31:26,549 --> 00:31:43,180
that I have prepared showed up

368
00:31:43,180 --> 00:31:54,940
ok so this is these things have opened
up there's actually a shit ton of her

369
00:31:54,940 --> 00:31:58,660
son therefore stop I just haven't gotten
around to looking at this is a motion

370
00:31:58,660 --> 00:32:04,560
detector for Smart Hub for smart things
rather and this is the wall plug that

371
00:32:04,560 --> 00:32:08,550
they use and these are two killer bee
dongles which are about to run the

372
00:32:08,550 --> 00:32:17,230
software created it works

373
00:32:17,230 --> 00:32:27,740
general sarnoff everything ok so it
works in a run the attack which is going

374
00:32:27,740 --> 00:32:28,840
to spam

375
00:32:28,840 --> 00:32:35,330
fake beacons towards the smart things
device very high rate you can see there

376
00:32:35,330 --> 00:32:40,090
on the left with the Wireshark capture
its just a shit ton of beacons and I'm

377
00:32:40,090 --> 00:32:44,790
gonna flip over the device again after
about a minute and doing the attack and

378
00:32:44,790 --> 00:32:55,860
it won't work and no worky and I

379
00:32:55,860 --> 00:32:59,420
didn't get any notifications on my phone
I guess it did a shit job of showing

380
00:32:59,420 --> 00:33:06,820
that but they all say malformed packet
because I had a bug which absence fixed

381
00:33:06,820 --> 00:33:27,380
but there you go now you can rob people
don't do that so that's a good question

382
00:33:27,380 --> 00:33:32,610
900 megahertz obviously goes a little
different than 2.4 but because of the

383
00:33:32,610 --> 00:33:39,020
low signal rate and low crammed you can
go a little bit further with israeli

384
00:33:39,020 --> 00:33:44,110
without getting so much data air so it
covers basically a house a block

385
00:33:44,110 --> 00:33:50,960
depending on a lot of different factors
but I'm also not an RAF engineer so but

386
00:33:50,960 --> 00:33:55,059
it also depends on your broadcast power
so if you wanna just and that shit up

387
00:33:55,059 --> 00:34:21,730
go farm an additional questions please
we've got plenty of time

388
00:34:21,730 --> 00:34:26,340
she was do you have coordination issues
with multiple ZigBee networks being set

389
00:34:26,340 --> 00:34:36,000
up at the same time yes so if you're
trying to discover device at the same

390
00:34:36,000 --> 00:34:39,810
time as someone else and you're trying
to connect a device you may have an

391
00:34:39,810 --> 00:34:43,490
issue where it joins two different
coordinated then maybe the one you

392
00:34:43,490 --> 00:34:48,830
intended that is more of an issue I
think with the consumer level devices

393
00:34:48,830 --> 00:34:53,260
where they're supposed to be using your
home so the chances of you running into

394
00:34:53,260 --> 00:34:57,720
a hostile environment the another
coordinator searching in the exact same

395
00:34:57,720 --> 00:35:03,100
time within broadcast distance is pretty
low inside of the

396
00:35:03,100 --> 00:35:07,240
critical infrastructure world-scale us
up like that you can actually configure

397
00:35:07,240 --> 00:35:11,770
each device separately from the get go
to use this coordinator dis network

398
00:35:11,770 --> 00:35:19,960
address this encryption key so yes for
consumer devices no forum or the

399
00:35:19,960 --> 00:35:41,760
specialized stuff

400
00:35:41,760 --> 00:35:48,570
to mine I've never even thought about
that question is so it's really good

401
00:35:48,570 --> 00:35:54,410
question I don't know I would imagine
that because of the mesh networking

402
00:35:54,410 --> 00:35:58,140
characteristics of ZigBee you can get
that he'll pretty quickly just by using

403
00:35:58,140 --> 00:36:02,940
multiple coordinators and multiple
devices able to route messages for other

404
00:36:02,940 --> 00:36:07,160
people but that's at that point we're
talking more of a mesh network and less

405
00:36:07,160 --> 00:36:14,960
of an idiot 2:15 94 issue so I think
that is solved but a higher layers and I

406
00:36:14,960 --> 00:36:19,950
wouldn't know how you would do it just
with a view to $15 for so actually

407
00:36:19,950 --> 00:36:29,280
that's a good question I look into that
one more time

408
00:36:29,280 --> 00:36:35,750
protocol she is instead well don't use
Bluetooth Low Energy it's even worse

409
00:36:35,750 --> 00:36:46,680
don't use you waive its proprietary I
would say you ZigBee her seasoning use

410
00:36:46,680 --> 00:36:52,360
it at 2:59 for why encrypt at the MAC
layer because it's like when I first was

411
00:36:52,360 --> 00:36:55,830
reading this because I hate this is
actually pretty secure like there there

412
00:36:55,830 --> 00:37:00,010
are problems with it but they're not
insurmountable and as long as you are

413
00:37:00,010 --> 00:37:04,000
increasing at the MAC layer your kind of
glossing over a lot of the other issues

414
00:37:04,000 --> 00:37:11,140
you might have so I would say use ZigBee
encrypted the MAC layer further

415
00:37:11,140 --> 00:37:24,680
questions so you can use EB war drive
from the killer be sweet to just go

416
00:37:24,680 --> 00:37:30,000
around in use one of the dongles or even
the same way as an effort to just look

417
00:37:30,000 --> 00:37:33,910
for ZigBee networks as far as what you
would do with that information

418
00:37:33,910 --> 00:37:38,380
Praetorian actually strapped one of the
dongles onto the bottom of a drone flew

419
00:37:38,380 --> 00:37:40,069
around the city for a while

420
00:37:40,069 --> 00:37:44,809
just a sort of catalog all the different
devices found a lot of television's

421
00:37:44,809 --> 00:37:49,829
don't know why Sunnis decided that was a
good idea but nonetheless that is what

422
00:37:49,829 --> 00:37:57,130
happens so you can go around just fuck
wish I imagine if you do that towards a

423
00:37:57,130 --> 00:38:02,209
nuclear power plant and you might run
into some issues actually that reminds

424
00:38:02,209 --> 00:38:08,779
me I should probably not to you my
password but show you some of the stuff

425
00:38:08,779 --> 00:38:40,269
that's in not that you know you're going
to be able to read any of it Jesus I can

426
00:38:40,269 --> 00:38:49,150
I know all here and we're using the show
no internets in a run

427
00:38:49,150 --> 00:38:56,910
so it's really fucking hard to read but
inside of killer bees we have

428
00:38:56,910 --> 00:39:04,099
GB were drivers ed stoneware Zeb
Wireshark and ZEB finds all utilities

429
00:39:04,099 --> 00:39:08,559
which you can do to used to do fox
hunting and and and the like I

430
00:39:08,559 --> 00:39:15,819
especially recommend just using CBO
Wireshark or as EB find the Z be fined

431
00:39:15,819 --> 00:39:21,529
inside of the killer bees sweet does not
work unless you're using my fork in

432
00:39:21,529 --> 00:39:35,529
which case I have bug bug fix dead but
there are also utilities for doing I see

433
00:39:35,529 --> 00:39:45,660
hear or notifications conflicts was
realignment spoofing there's see here

434
00:39:45,660 --> 00:39:51,069
weekends Association floods
disassociation floods and just doing

435
00:39:51,069 --> 00:39:58,200
nothing and the killer be sweet also has
pretty good tools for pulling out

436
00:39:58,200 --> 00:40:02,630
network keys from any sniffs traffic as
well

437
00:40:02,630 --> 00:40:25,029
further questions your bed and that's
the process

438
00:40:25,029 --> 00:40:29,660
900 megahertz chip then do the 2.4
gigahertz signal some of them have

439
00:40:29,660 --> 00:40:35,740
multiple radios and other wing cub by
the way the wing cub super awesome

440
00:40:35,740 --> 00:40:42,630
utility for getting started into because
it is very easily routed and has some

441
00:40:42,630 --> 00:40:50,210
utilities on there that you can use to
directly interface with Lutron kid and

442
00:40:50,210 --> 00:40:57,160
Bluetooth so they that specific device
has many radios having a total of six

443
00:40:57,160 --> 00:41:14,750
so including z-wave and here's why

444
00:41:14,750 --> 00:41:20,490
generally speaking unless you're hacking
a coordinator and you managed to pop it

445
00:41:20,490 --> 00:41:25,710
which by the way I miss my taxes doses
generally it's enough by if you did

446
00:41:25,710 --> 00:41:31,309
manage to pop the device if it was a
coordinator you could get a shell from

447
00:41:31,309 --> 00:41:36,410
from Linux they generate from Linux
right but if you pop a reduced function

448
00:41:36,410 --> 00:41:42,109
device just like some battery-powered no
doubt there you will be on it basically

449
00:41:42,109 --> 00:41:47,260
a pic AVR something like that so you're
not gonna have a whole ton of processing

450
00:41:47,260 --> 00:42:05,980
power it's basically an Arduino

451
00:42:05,980 --> 00:42:13,640
bridge into Ethernet so you can talk to
using your browser's something right so

452
00:42:13,640 --> 00:42:17,600
it's a yeah there there's definitely a
way for you to pay the intrinsic network

453
00:42:17,600 --> 00:42:35,660
into like Ethernet LAN hundreds of times
the stuff will be inside of your

454
00:42:35,660 --> 00:42:40,250
building but as environmental control
door control that kind of stuff I've

455
00:42:40,250 --> 00:42:44,660
seen entire hotels where everything is
it be enabled from the freaking

456
00:42:44,660 --> 00:42:49,220
thermostat to the damn lock on the door
and I've even seen that software run on

457
00:42:49,220 --> 00:43:03,670
the point of sale system fun fact any
additional questions ok well then I

458
00:43:03,670 --> 00:43:07,119
think I can end a little bit early so
here we go

