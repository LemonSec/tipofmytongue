1
00:00:39,680 --> 00:00:42,719
[Music]

2
00:00:42,980 --> 00:00:47,730
all right everybody I'm gonna get

3
00:00:44,820 --> 00:00:49,230
started thank you so much for coming out

4
00:00:47,730 --> 00:00:50,849
today this is testing endpoint

5
00:00:49,230 --> 00:00:53,760
protection how anyone can bypass

6
00:00:50,850 --> 00:00:56,309
next-gen AV and if my voice is a little

7
00:00:53,760 --> 00:00:57,899
hoarse I apologize I was screaming

8
00:00:56,309 --> 00:01:00,358
loudly along with sublime last night

9
00:00:57,899 --> 00:01:01,980
anybody else at 10:00 last night yeah

10
00:01:00,359 --> 00:01:06,240
it's awesome right

11
00:01:01,980 --> 00:01:09,630
great show all right thanks so just a

12
00:01:06,240 --> 00:01:11,580
quick overview of the talk I'll give you

13
00:01:09,630 --> 00:01:13,830
a little background on Who I am

14
00:01:11,580 --> 00:01:16,830
background on how this talk came to be

15
00:01:13,830 --> 00:01:18,810
our testing methodology the results of

16
00:01:16,830 --> 00:01:21,150
our testing and then a conclusion some

17
00:01:18,810 --> 00:01:23,729
QA but as I was putting this talk

18
00:01:21,150 --> 00:01:25,590
together I realized that I really missed

19
00:01:23,729 --> 00:01:29,009
the boat on the title it really should

20
00:01:25,590 --> 00:01:31,890
have been you can bypass next-gen AV you

21
00:01:29,009 --> 00:01:33,659
can bypass all right I won't torture you

22
00:01:31,890 --> 00:01:36,630
with that

23
00:01:33,659 --> 00:01:38,189
so I'm cami GE I'm principal InfoSec

24
00:01:36,630 --> 00:01:41,460
Architect at Dick's Sporting Goods

25
00:01:38,189 --> 00:01:43,079
I love passwords and get requests poorly

26
00:01:41,460 --> 00:01:46,649
handled sessions long walks on the

27
00:01:43,079 --> 00:01:48,990
schema I get about 20 years in the game

28
00:01:46,649 --> 00:01:52,439
I'm in in real life graybeard as you can

29
00:01:48,990 --> 00:01:54,360
see and I'm kind of a rover with

30
00:01:52,439 --> 00:01:57,809
application security background network

31
00:01:54,360 --> 00:02:03,658
background and architecture and design I

32
00:01:57,810 --> 00:02:05,310
do not spend my day dropping payloads on

33
00:02:03,659 --> 00:02:07,799
endpoints and trying to get shelves

34
00:02:05,310 --> 00:02:10,140
that's not what I do this was kind of

35
00:02:07,799 --> 00:02:12,270
outside my wheelhouse for this

36
00:02:10,139 --> 00:02:13,319
particular stuff and that's what I hope

37
00:02:12,270 --> 00:02:17,220
makes it a little more

38
00:02:13,319 --> 00:02:20,250
interesting and a little bit noisy I've

39
00:02:17,220 --> 00:02:23,700
done some talking for sans besides IC

40
00:02:20,250 --> 00:02:25,890
squared misses my fourth time and final

41
00:02:23,700 --> 00:02:29,159
time speaking at Derby con and that

42
00:02:25,890 --> 00:02:32,099
makes me sad but all this slide is to

43
00:02:29,159 --> 00:02:35,420
tell you that I've seen some things I've

44
00:02:32,099 --> 00:02:35,420
seen things that can't be unseen

45
00:02:35,510 --> 00:02:41,659
that's you know if you do this long

46
00:02:38,159 --> 00:02:41,659
enough you won't make that same face

47
00:02:41,900 --> 00:02:49,530
this is information security at Dick's

48
00:02:44,370 --> 00:02:54,060
Sporting Goods you're just trying to you

49
00:02:49,530 --> 00:02:55,590
know live the brand stay healthy and

50
00:02:54,060 --> 00:02:59,359
you're fighting invisible bad guys you

51
00:02:55,590 --> 00:03:03,269
don't know where they are all right

52
00:02:59,359 --> 00:03:06,239
so the background on how we got here so

53
00:03:03,269 --> 00:03:09,060
we were evaluating next-gen AV solutions

54
00:03:06,239 --> 00:03:11,040
because reasons we found our existing

55
00:03:09,060 --> 00:03:14,220
solution was insufficient in the number

56
00:03:11,040 --> 00:03:17,310
of ways so we decided to you know go

57
00:03:14,220 --> 00:03:20,099
another direction and we got from RC so

58
00:03:17,310 --> 00:03:22,199
a make sure it's good directive he

59
00:03:20,099 --> 00:03:24,149
really wanted to give us the time to

60
00:03:22,199 --> 00:03:27,419
make sure that it's decent and can do

61
00:03:24,150 --> 00:03:29,340
the right stuff you know it was a team

62
00:03:27,419 --> 00:03:31,889
effort with buy-in from management which

63
00:03:29,340 --> 00:03:34,169
i think is rare and that's why I wanted

64
00:03:31,889 --> 00:03:37,049
to give this talk because I think few

65
00:03:34,169 --> 00:03:39,810
organizations the size of ours have the

66
00:03:37,049 --> 00:03:41,790
opportunity to really do a good deep

67
00:03:39,810 --> 00:03:44,669
dive on the solutions that they're gonna

68
00:03:41,790 --> 00:03:46,459
be you know implementing and choosing

69
00:03:44,669 --> 00:03:48,720
and spending a lot of money for so

70
00:03:46,459 --> 00:03:51,720
that's that's why I wanted to come here

71
00:03:48,720 --> 00:03:53,489
and talk to you today and one of the

72
00:03:51,720 --> 00:03:55,199
things that we really want to do is try

73
00:03:53,489 --> 00:03:57,419
to cut through the noise how do we cut

74
00:03:55,199 --> 00:03:59,609
through the noise well let's define

75
00:03:57,419 --> 00:04:01,889
noise I'm sure you're familiar with some

76
00:03:59,609 --> 00:04:04,680
of this stuff machine learning in AI

77
00:04:01,889 --> 00:04:06,239
right who hasn't heard that about every

78
00:04:04,680 --> 00:04:09,180
single security solution that's being

79
00:04:06,239 --> 00:04:12,150
sold to us today right firewalls do it

80
00:04:09,180 --> 00:04:15,060
sim solutions do it and point protection

81
00:04:12,150 --> 00:04:17,579
products do it so you know this is this

82
00:04:15,060 --> 00:04:19,349
is a set of words that kind of make the

83
00:04:17,579 --> 00:04:23,789
hair on the back of my neck stand up

84
00:04:19,349 --> 00:04:26,340
because everybody seems to have it so

85
00:04:23,789 --> 00:04:26,789
some of these were quotes that I pulled

86
00:04:26,340 --> 00:04:29,479
directly

87
00:04:26,790 --> 00:04:31,980
off of some of these vendors websites so

88
00:04:29,480 --> 00:04:35,000
99.95 percent effective

89
00:04:31,980 --> 00:04:38,130
that sounds pretty darn effective right

90
00:04:35,000 --> 00:04:40,290
all threat vectors you cover all threat

91
00:04:38,130 --> 00:04:42,690
vectors wow you know all the threat

92
00:04:40,290 --> 00:04:43,950
vectors that's impressive

93
00:04:42,690 --> 00:04:48,000
I didn't know anybody knew all the

94
00:04:43,950 --> 00:04:49,219
threat vectors advanced threat actors in

95
00:04:48,000 --> 00:04:52,370
nation-state attacks

96
00:04:49,220 --> 00:04:56,010
okay that's that's a pretty wide-ranging

97
00:04:52,370 --> 00:04:59,580
bold statement about some serious people

98
00:04:56,010 --> 00:05:02,250
with a lot of money and the vendor

99
00:04:59,580 --> 00:05:04,440
guided demos will always work that's the

100
00:05:02,250 --> 00:05:07,290
thing if you have a vendor that wants to

101
00:05:04,440 --> 00:05:08,820
guide you through a POC it's almost

102
00:05:07,290 --> 00:05:13,260
guaranteed that it's going to work the

103
00:05:08,820 --> 00:05:14,640
way the vendor expects now this is what

104
00:05:13,260 --> 00:05:18,810
it looks like when a vendor detects

105
00:05:14,640 --> 00:05:20,789
malware they provided to you they're

106
00:05:18,810 --> 00:05:26,220
essentially given themselves a high-five

107
00:05:20,790 --> 00:05:31,440
you know like hey we the thing that we

108
00:05:26,220 --> 00:05:35,250
told you we were gonna block you know so

109
00:05:31,440 --> 00:05:36,990
about the methodology we you know I've

110
00:05:35,250 --> 00:05:39,660
tried to kind of put this into four

111
00:05:36,990 --> 00:05:42,120
groups the first was using the atomic

112
00:05:39,660 --> 00:05:44,310
red team tests which I asked actually

113
00:05:42,120 --> 00:05:46,500
got from one Ryan Bullock who I saw a

114
00:05:44,310 --> 00:05:49,860
walk in he's here somewhere areas

115
00:05:46,500 --> 00:05:52,140
Ryan suggested that we use this for as a

116
00:05:49,860 --> 00:05:55,350
part of this testing and it actually let

117
00:05:52,140 --> 00:05:57,150
us see some really interesting stuff and

118
00:05:55,350 --> 00:06:00,060
then we went out and snagged some real

119
00:05:57,150 --> 00:06:01,890
actual malware so let's take stuff

120
00:06:00,060 --> 00:06:04,200
that's infecting people right now and

121
00:06:01,890 --> 00:06:07,260
see if this next-gen a/v stuff will

122
00:06:04,200 --> 00:06:09,440
actually block it and then we kind of

123
00:06:07,260 --> 00:06:12,810
lumped this into all in one category

124
00:06:09,440 --> 00:06:14,490
potentially unwanted programs adware and

125
00:06:12,810 --> 00:06:15,900
coin miners they're all kind of these

126
00:06:14,490 --> 00:06:17,310
annoying things that you don't

127
00:06:15,900 --> 00:06:19,650
necessarily want in the environment

128
00:06:17,310 --> 00:06:21,780
they're not really gonna do a ton of bad

129
00:06:19,650 --> 00:06:23,549
things but you don't want them in the

130
00:06:21,780 --> 00:06:27,000
environment anyway so we should detect

131
00:06:23,550 --> 00:06:29,700
and block them if we can and then custom

132
00:06:27,000 --> 00:06:33,330
payloads of varying obscurity which is

133
00:06:29,700 --> 00:06:35,520
monkey armed with github okay so we're

134
00:06:33,330 --> 00:06:37,469
just talking about you know some

135
00:06:35,520 --> 00:06:40,260
payloads that are generated out of a

136
00:06:37,470 --> 00:06:40,889
couple different frameworks and calling

137
00:06:40,260 --> 00:06:42,930
back to us or

138
00:06:40,889 --> 00:06:48,800
that we control and let's see how these

139
00:06:42,930 --> 00:06:51,479
things behave so let's talk about prep

140
00:06:48,800 --> 00:06:55,080
do not test on your production network

141
00:06:51,479 --> 00:06:56,758
or endpoints as that's number one I know

142
00:06:55,080 --> 00:06:58,409
it's really exciting to try to dig into

143
00:06:56,759 --> 00:07:00,509
something like this you're ready to

144
00:06:58,409 --> 00:07:03,060
party you know you're ready to go and

145
00:07:00,509 --> 00:07:04,999
and then you install ransomware all

146
00:07:03,060 --> 00:07:12,090
across your network and everything's bad

147
00:07:04,999 --> 00:07:14,729
so don't test and prod use some VMs some

148
00:07:12,090 --> 00:07:16,679
throw away boxes and have a test network

149
00:07:14,729 --> 00:07:18,810
that's not connected to anything

150
00:07:16,680 --> 00:07:20,699
important you know put it off on an

151
00:07:18,810 --> 00:07:23,629
island this is this is really dangerous

152
00:07:20,699 --> 00:07:28,050
stuff when you start playing with it

153
00:07:23,629 --> 00:07:30,300
so atomic Red Team so what this is if

154
00:07:28,050 --> 00:07:33,810
you're not familiar it maps to the miter

155
00:07:30,300 --> 00:07:37,080
attack framework and it's about 200

156
00:07:33,810 --> 00:07:38,699
tests across Windows Mac OS and Linux so

157
00:07:37,080 --> 00:07:39,719
you can give I'm not going to go into a

158
00:07:38,699 --> 00:07:40,979
minor attack framework I'm sure

159
00:07:39,719 --> 00:07:43,110
everybody has heard out a hundred times

160
00:07:40,979 --> 00:07:45,779
at this point but it's you know just

161
00:07:43,110 --> 00:07:48,960
kind of an outline of tactics and

162
00:07:45,779 --> 00:07:50,879
techniques behaviors not signatures so

163
00:07:48,960 --> 00:07:53,609
we're interested in detecting the actual

164
00:07:50,879 --> 00:07:56,370
behavior the technique that an attacker

165
00:07:53,610 --> 00:07:58,139
might use and it's under active

166
00:07:56,370 --> 00:07:59,729
development there's lots of the tests

167
00:07:58,139 --> 00:08:01,379
that are still needed I think there's

168
00:07:59,729 --> 00:08:04,469
there's probably another 200 that still

169
00:08:01,379 --> 00:08:06,539
need to be mapped out to an actual test

170
00:08:04,469 --> 00:08:08,580
so if anybody wants to take a look and

171
00:08:06,539 --> 00:08:13,860
contribute I think that that's a great

172
00:08:08,580 --> 00:08:16,020
place to contribute these are the

173
00:08:13,860 --> 00:08:19,680
overall like high-level things that that

174
00:08:16,020 --> 00:08:22,378
the the atomic right team tests map to

175
00:08:19,680 --> 00:08:25,680
you see things like persistence lateral

176
00:08:22,379 --> 00:08:28,379
movement data exfiltration initial

177
00:08:25,680 --> 00:08:30,509
access all this stuff and that's all

178
00:08:28,379 --> 00:08:33,269
really good but for our purposes we were

179
00:08:30,509 --> 00:08:35,159
really just interested in these four

180
00:08:33,269 --> 00:08:37,500
things we weren't really digging into

181
00:08:35,159 --> 00:08:38,968
much if the if the solution could detect

182
00:08:37,500 --> 00:08:40,409
data exfil

183
00:08:38,969 --> 00:08:43,320
were really interested you know can

184
00:08:40,409 --> 00:08:45,540
attacker gain a foothold can they get

185
00:08:43,320 --> 00:08:48,480
their code to execute can they elevate

186
00:08:45,540 --> 00:08:50,969
their privileges you know that that sort

187
00:08:48,480 --> 00:08:52,829
of thing can they dump credentials those

188
00:08:50,970 --> 00:08:55,009
are those were the most important things

189
00:08:52,829 --> 00:08:58,170
for us

190
00:08:55,009 --> 00:09:00,720
and so some of the results most of these

191
00:08:58,170 --> 00:09:03,360
were detected by all the vendors that we

192
00:09:00,720 --> 00:09:06,000
we've chose in just a little bit on that

193
00:09:03,360 --> 00:09:08,459
we had started with a list of five

194
00:09:06,000 --> 00:09:11,310
different solutions we don't let that

195
00:09:08,459 --> 00:09:13,349
down to two top contenders and then

196
00:09:11,310 --> 00:09:16,920
proceeded with testing against those top

197
00:09:13,350 --> 00:09:21,209
two I'm not naming names because NDA and

198
00:09:16,920 --> 00:09:22,920
that's yes you know but you know maybe

199
00:09:21,209 --> 00:09:27,569
if you catch me down the lobby

200
00:09:22,920 --> 00:09:31,439
I like Knob Creek that tends to loosen

201
00:09:27,569 --> 00:09:34,019
me up a little bit one one in particular

202
00:09:31,439 --> 00:09:35,069
did that did not get caught was

203
00:09:34,019 --> 00:09:37,019
squiggly-doo

204
00:09:35,069 --> 00:09:40,439
which if you're unfamiliar this was a

205
00:09:37,019 --> 00:09:43,920
term coined by Casey Smith also known as

206
00:09:40,439 --> 00:09:47,040
sub T back in 2016 and it's basically

207
00:09:43,920 --> 00:09:49,769
this where you're using register for 32

208
00:09:47,040 --> 00:09:53,279
X e to call out to the Internet

209
00:09:49,769 --> 00:09:56,579
pull down some a payload and then

210
00:09:53,279 --> 00:10:01,170
execute it passing it to the scrub BJ

211
00:09:56,579 --> 00:10:05,638
DLL so in this case pointed to a github

212
00:10:01,170 --> 00:10:09,120
hosted SCT file that launched cow XE so

213
00:10:05,639 --> 00:10:10,680
harmless exe right but the behavior was

214
00:10:09,120 --> 00:10:13,920
weird you shouldn't really see this in

215
00:10:10,680 --> 00:10:16,910
your environment too much okay and it

216
00:10:13,920 --> 00:10:20,250
ran and that was surprising to me and

217
00:10:16,910 --> 00:10:26,600
the vendor response was well cap dot exe

218
00:10:20,250 --> 00:10:26,600
is not malicious so

219
00:10:28,110 --> 00:10:34,080
try to take that in a little bit took

220
00:10:30,860 --> 00:10:36,420
took a drink of my coffee and said okay

221
00:10:34,080 --> 00:10:39,120
so it sounds like you're relying on a

222
00:10:36,420 --> 00:10:42,990
signature or a hash or reputation score

223
00:10:39,120 --> 00:10:44,910
as opposed to a TTP or behavior right so

224
00:10:42,990 --> 00:10:48,390
that's horrible response it's damaged

225
00:10:44,910 --> 00:10:51,120
goods do not accept and we were able to

226
00:10:48,390 --> 00:10:53,730
have some additional bypass success with

227
00:10:51,120 --> 00:10:55,500
obfuscation just putting you know some

228
00:10:53,730 --> 00:11:00,920
odd characters into the command line and

229
00:10:55,500 --> 00:11:04,950
and it goes right past so let's move on

230
00:11:00,920 --> 00:11:06,719
real malware so where does one get real

231
00:11:04,950 --> 00:11:08,220
malware first of all well there's

232
00:11:06,720 --> 00:11:10,829
actually a lot of places you can do it

233
00:11:08,220 --> 00:11:16,320
one excellent source of malware for us

234
00:11:10,829 --> 00:11:18,149
was our email gateway lots of stuff

235
00:11:16,320 --> 00:11:19,680
coming in there and it's actually

236
00:11:18,149 --> 00:11:22,079
getting blocked you know but then it's

237
00:11:19,680 --> 00:11:24,420
there in a nice preserved place for you

238
00:11:22,079 --> 00:11:29,130
to pull it down and then you know run it

239
00:11:24,420 --> 00:11:31,579
against your your off network VMs repos

240
00:11:29,130 --> 00:11:35,550
there's actually a thing called the zoo

241
00:11:31,579 --> 00:11:36,989
which you can it's a github repo and you

242
00:11:35,550 --> 00:11:38,459
can pull the thing down and it has all

243
00:11:36,990 --> 00:11:41,430
kinds of malware samples that you can

244
00:11:38,459 --> 00:11:43,680
test against it's a little bit stale so

245
00:11:41,430 --> 00:11:46,170
email gateways actually a lot better in

246
00:11:43,680 --> 00:11:48,660
that respect we used one that was that

247
00:11:46,170 --> 00:11:50,310
was somewhat somebody had tweeted out

248
00:11:48,660 --> 00:11:52,589
and he actually had a really fantastic

249
00:11:50,310 --> 00:11:54,329
list of very fresh malware but it's

250
00:11:52,589 --> 00:11:55,950
offline now and I don't know what

251
00:11:54,329 --> 00:11:59,219
happened to it so unfortunately I can't

252
00:11:55,950 --> 00:12:02,100
include it here and then some of the

253
00:11:59,220 --> 00:12:04,079
analysis tools like any run and hybrid

254
00:12:02,100 --> 00:12:06,270
analysis you can actually get copies

255
00:12:04,079 --> 00:12:08,130
from them as well which is super helpful

256
00:12:06,270 --> 00:12:13,260
you know if you want to do actually go

257
00:12:08,130 --> 00:12:14,970
through with all this so the results we

258
00:12:13,260 --> 00:12:17,970
had about a hundred percent detection

259
00:12:14,970 --> 00:12:21,870
rate on this stuff now our samples were

260
00:12:17,970 --> 00:12:24,420
days and weeks old so you know you would

261
00:12:21,870 --> 00:12:26,690
it's almost expected I mean it's not

262
00:12:24,420 --> 00:12:29,339
surprising because you're AI people

263
00:12:26,690 --> 00:12:32,820
should have machine learned written a

264
00:12:29,339 --> 00:12:35,579
signature for this already you know you

265
00:12:32,820 --> 00:12:37,829
would expect it if it was you know some

266
00:12:35,579 --> 00:12:40,050
kind of ransomware that was released a

267
00:12:37,829 --> 00:12:41,939
week ago that that by now these new

268
00:12:40,050 --> 00:12:46,599
solutions would be able to pick it up

269
00:12:41,940 --> 00:12:48,670
and he did so then we moved on to the

270
00:12:46,600 --> 00:12:51,130
potentially unwanted programs and stuff

271
00:12:48,670 --> 00:12:54,219
these are easy to find because everyone

272
00:12:51,130 --> 00:12:57,910
wants to give you one they're super

273
00:12:54,220 --> 00:12:59,620
excited to give them to you so they're

274
00:12:57,910 --> 00:13:01,630
not again not super malicious but

275
00:12:59,620 --> 00:13:03,370
they're not super helpful either

276
00:13:01,630 --> 00:13:06,280
and still worth it still worth

277
00:13:03,370 --> 00:13:08,740
mitigating you know again this is this

278
00:13:06,280 --> 00:13:12,069
is just adware stuff you know coin

279
00:13:08,740 --> 00:13:14,440
miners that sort of thing I was a little

280
00:13:12,070 --> 00:13:16,810
bit hit or miss on detection and

281
00:13:14,440 --> 00:13:18,910
prevention the one place where where

282
00:13:16,810 --> 00:13:21,640
everything seemed to struggle was

283
00:13:18,910 --> 00:13:23,110
in-browser coin miners and I think

284
00:13:21,640 --> 00:13:25,449
that's why you see the the browser

285
00:13:23,110 --> 00:13:27,730
vendors starting to move towards like

286
00:13:25,450 --> 00:13:30,580
Firefox just made did a release where

287
00:13:27,730 --> 00:13:32,230
they're actually blocking coin miners in

288
00:13:30,580 --> 00:13:32,950
the browser which is the right place to

289
00:13:32,230 --> 00:13:34,840
do it

290
00:13:32,950 --> 00:13:36,550
you know maybe these solutions aren't

291
00:13:34,840 --> 00:13:38,500
digging into the browser process deep

292
00:13:36,550 --> 00:13:40,329
enough to be able to say okay browsers

293
00:13:38,500 --> 00:13:43,720
doing something shouldn't be doing a

294
00:13:40,330 --> 00:13:45,820
coin miner might spike a CPU in the same

295
00:13:43,720 --> 00:13:48,610
way that a flash application might you

296
00:13:45,820 --> 00:13:50,530
know so but it was it was definitely a

297
00:13:48,610 --> 00:13:52,810
challenge and weirdly the previous gen

298
00:13:50,530 --> 00:13:54,579
AV a signature-based AV was actually a

299
00:13:52,810 --> 00:13:56,319
little bit better detecting the

300
00:13:54,580 --> 00:14:00,940
installers for this stuff for whatever

301
00:13:56,320 --> 00:14:04,810
reason okay so now we move on to the

302
00:14:00,940 --> 00:14:07,300
good stuff the custom payloads so the

303
00:14:04,810 --> 00:14:09,790
goals were again just to recap we're

304
00:14:07,300 --> 00:14:12,160
trying to successfully execute a stage

305
00:14:09,790 --> 00:14:14,160
or payload that then calls back and

306
00:14:12,160 --> 00:14:17,230
gives you interpreter show

307
00:14:14,160 --> 00:14:20,650
escalate privileges with get system and

308
00:14:17,230 --> 00:14:23,620
then dump creds using me me cats like

309
00:14:20,650 --> 00:14:25,480
nothing you know nation-state here

310
00:14:23,620 --> 00:14:27,370
nothing super advanced this is all very

311
00:14:25,480 --> 00:14:29,890
straightforward and I apologize if we

312
00:14:27,370 --> 00:14:31,630
got any red teamers in here you know

313
00:14:29,890 --> 00:14:33,730
this is standard stuff for you guys all

314
00:14:31,630 --> 00:14:35,950
day I totally understand cement for blue

315
00:14:33,730 --> 00:14:39,400
teamers who just want to test their end

316
00:14:35,950 --> 00:14:42,620
point solution you know so I fired up my

317
00:14:39,400 --> 00:14:46,160
instance of Cali link ox

318
00:14:42,620 --> 00:14:50,300
I love that thing

319
00:14:46,160 --> 00:14:53,990
and went to town so we did some vanilla

320
00:14:50,300 --> 00:14:56,630
ms venom some evasion frameworks that I

321
00:14:53,990 --> 00:14:59,420
was able to dig up on github and then

322
00:14:56,630 --> 00:15:01,900
some other newer style attacks that have

323
00:14:59,420 --> 00:15:04,790
been discussed here in the last year -

324
00:15:01,900 --> 00:15:07,189
using PowerShell and c-sharp and that

325
00:15:04,790 --> 00:15:09,589
sort of thing and it was nothing I wrote

326
00:15:07,190 --> 00:15:14,480
again monkey armed with github right

327
00:15:09,590 --> 00:15:15,500
here so with MS venom it's for those

328
00:15:14,480 --> 00:15:18,950
that aren't familiar it's part of

329
00:15:15,500 --> 00:15:22,370
Metasploit it replaced MSF payload and

330
00:15:18,950 --> 00:15:25,070
MSF in code in 2016 it lets you create

331
00:15:22,370 --> 00:15:27,290
various payloads with an encoder and you

332
00:15:25,070 --> 00:15:28,700
can even like combine an exe with some

333
00:15:27,290 --> 00:15:30,770
of the stuff that with the payloads it

334
00:15:28,700 --> 00:15:32,750
creates so you can take a legitimate exe

335
00:15:30,770 --> 00:15:35,870
notepad dot exe something like that and

336
00:15:32,750 --> 00:15:38,540
insert a malicious payload into it and

337
00:15:35,870 --> 00:15:41,300
we were really concentrating on reverse

338
00:15:38,540 --> 00:15:42,469
TCP and HTTP payloads because if you get

339
00:15:41,300 --> 00:15:44,510
the person to double click the thing

340
00:15:42,470 --> 00:15:49,550
it's gonna call back to you and then you

341
00:15:44,510 --> 00:15:52,160
can go to town on on your next steps so

342
00:15:49,550 --> 00:15:54,680
some of the evasion frameworks that we

343
00:15:52,160 --> 00:15:56,270
tested as well veil evasion is pretty

344
00:15:54,680 --> 00:16:00,349
well known it's been around for a while

345
00:15:56,270 --> 00:16:03,020
not super super obscure phantom evasion

346
00:16:00,350 --> 00:16:04,520
was another one that was interesting

347
00:16:03,020 --> 00:16:07,040
because it's under active development

348
00:16:04,520 --> 00:16:09,260
there was new versions coming out as we

349
00:16:07,040 --> 00:16:10,790
were testing which was great because

350
00:16:09,260 --> 00:16:11,930
when we test one version and then all of

351
00:16:10,790 --> 00:16:14,120
a sudden a new one would come out and

352
00:16:11,930 --> 00:16:18,500
test that one and oops

353
00:16:14,120 --> 00:16:20,630
bypass something magic unicorn which is

354
00:16:18,500 --> 00:16:23,210
a trusted SEC product mr. Dave Kennedy

355
00:16:20,630 --> 00:16:26,090
talks about this a lot about how when he

356
00:16:23,210 --> 00:16:28,340
changes it Microsoft immediately somehow

357
00:16:26,090 --> 00:16:31,940
magically comes out with an update for

358
00:16:28,340 --> 00:16:34,760
defender I found this one called the fat

359
00:16:31,940 --> 00:16:38,360
rat which I had never ever heard of it

360
00:16:34,760 --> 00:16:42,790
any talk anywhere and this was really

361
00:16:38,360 --> 00:16:46,010
like a interesting kind of front end for

362
00:16:42,790 --> 00:16:48,140
MSF venom where you could go through and

363
00:16:46,010 --> 00:16:50,240
you know choose the type of payload that

364
00:16:48,140 --> 00:16:51,410
you wanted to do you know like what kind

365
00:16:50,240 --> 00:16:53,630
of callback you would want or whatever

366
00:16:51,410 --> 00:16:56,260
and then it would just go out and do all

367
00:16:53,630 --> 00:16:57,930
kinds of different encoder

368
00:16:56,260 --> 00:16:59,650
it would do you know all sorts of

369
00:16:57,930 --> 00:17:03,400
obfuscation just ride through the

370
00:16:59,650 --> 00:17:05,379
different MSF venom encoders a bunch of

371
00:17:03,400 --> 00:17:07,569
different times like so it was just kind

372
00:17:05,380 --> 00:17:09,760
of automating doing that kind of stuff

373
00:17:07,569 --> 00:17:13,349
manually and it was interesting and

374
00:17:09,760 --> 00:17:16,150
successful and in a couple cases and

375
00:17:13,349 --> 00:17:18,429
then I also found shelter which is

376
00:17:16,150 --> 00:17:21,100
there's a free version of shelter out

377
00:17:18,430 --> 00:17:25,240
there but then there is also a paid for

378
00:17:21,099 --> 00:17:27,698
pro version but we didn't do the the pro

379
00:17:25,240 --> 00:17:30,100
version because again monkey arm of

380
00:17:27,699 --> 00:17:32,230
github right monkeys don't have money we

381
00:17:30,100 --> 00:17:34,270
just want to go out there to see what we

382
00:17:32,230 --> 00:17:38,590
could do without paying for for

383
00:17:34,270 --> 00:17:40,780
something fancy and then some of the

384
00:17:38,590 --> 00:17:43,209
other stuff that's out there not

385
00:17:40,780 --> 00:17:47,110
PowerShell and NPS payload this is a Ben

386
00:17:43,210 --> 00:17:48,910
10 thing these you know not not

387
00:17:47,110 --> 00:17:50,530
PowerShell is essentially an exe that is

388
00:17:48,910 --> 00:17:52,330
not PowerShell but you can feed it

389
00:17:50,530 --> 00:17:55,600
PowerShell commands and it'll interpret

390
00:17:52,330 --> 00:17:58,240
it and do things for you sharp cradle

391
00:17:55,600 --> 00:17:59,860
which is an interesting kind of way

392
00:17:58,240 --> 00:18:02,590
if you it's really like a post

393
00:17:59,860 --> 00:18:04,030
exploitation thing so we weren't you

394
00:18:02,590 --> 00:18:06,070
know we assumed we're already on the box

395
00:18:04,030 --> 00:18:08,410
and we could get sharp cradle there and

396
00:18:06,070 --> 00:18:10,810
sharp cradle go out and download c-sharp

397
00:18:08,410 --> 00:18:13,990
binaries and execute them on the

398
00:18:10,810 --> 00:18:16,480
endpoint net PE loader same kind of

399
00:18:13,990 --> 00:18:19,750
thing post exploitation and sharp

400
00:18:16,480 --> 00:18:21,820
attacks sharp sploit which is more of a

401
00:18:19,750 --> 00:18:24,360
recon type of tool but it gives you like

402
00:18:21,820 --> 00:18:26,919
some really heavy duty recon

403
00:18:24,360 --> 00:18:28,659
capabilities so you know you're not

404
00:18:26,920 --> 00:18:30,160
actually gonna pop the box but you might

405
00:18:28,660 --> 00:18:31,780
get a really good idea what's going on

406
00:18:30,160 --> 00:18:33,670
in the environment definitely not a

407
00:18:31,780 --> 00:18:35,710
normal thing to have there so wanted to

408
00:18:33,670 --> 00:18:42,160
include it in the testing just to see if

409
00:18:35,710 --> 00:18:46,810
it got detected oh man I'm really moving

410
00:18:42,160 --> 00:18:51,220
here okay so results of the custom

411
00:18:46,810 --> 00:18:55,480
payloads we did about 62 generated and

412
00:18:51,220 --> 00:18:57,730
tested they range from Exe s2h tas the

413
00:18:55,480 --> 00:18:59,500
office documents with malicious macros

414
00:18:57,730 --> 00:19:01,720
all the kinds of things that you would

415
00:18:59,500 --> 00:19:04,360
expect to see an attacker throw at you

416
00:19:01,720 --> 00:19:07,120
and sorry not sorry

417
00:19:04,360 --> 00:19:08,229
Red Team if I burned your stuff I hope I

418
00:19:07,120 --> 00:19:09,879
didn't burn your stuff because you

419
00:19:08,230 --> 00:19:12,130
should have better

420
00:19:09,880 --> 00:19:13,750
you should not be using the generic

421
00:19:12,130 --> 00:19:15,100
stuff that's sitting out on github you

422
00:19:13,750 --> 00:19:19,660
should have your own secret sauce and

423
00:19:15,100 --> 00:19:22,389
you know again orangutan armed with

424
00:19:19,660 --> 00:19:25,539
github I thought this was interesting

425
00:19:22,390 --> 00:19:28,059
this was a screenshot that came from the

426
00:19:25,539 --> 00:19:30,669
fat rat where they're like don't upload

427
00:19:28,059 --> 00:19:33,370
the virus total well but that's not a

428
00:19:30,669 --> 00:19:35,500
security control like I'm gonna I'm not

429
00:19:33,370 --> 00:19:36,909
I didn't upload the virus Toto I put it

430
00:19:35,500 --> 00:19:39,610
on an end point that uploaded it to

431
00:19:36,910 --> 00:19:40,960
their AI machine learning cloud and you

432
00:19:39,610 --> 00:19:47,020
know they ended up right in a detection

433
00:19:40,960 --> 00:19:49,900
for it or something like that so of the

434
00:19:47,020 --> 00:19:52,210
62 we had about 40 percent that bypassed

435
00:19:49,900 --> 00:19:52,659
the previous gen antivirus and we're

436
00:19:52,210 --> 00:19:53,980
done here

437
00:19:52,659 --> 00:19:56,620
there's there's nothing else to really

438
00:19:53,980 --> 00:19:59,320
dig into once that thing executed it

439
00:19:56,620 --> 00:20:01,330
called back previous gen AV isn't doing

440
00:19:59,320 --> 00:20:03,220
anything else it's it doesn't care if

441
00:20:01,330 --> 00:20:05,678
you get system on the box it doesn't

442
00:20:03,220 --> 00:20:07,720
care if you move laterally or dumb

443
00:20:05,679 --> 00:20:10,150
credentials right if that process is now

444
00:20:07,720 --> 00:20:12,549
running and it's going to do whatever

445
00:20:10,150 --> 00:20:16,960
you want it to do because the signature

446
00:20:12,549 --> 00:20:19,030
was missed about 20% of the detected

447
00:20:16,960 --> 00:20:21,580
payload still executed which was

448
00:20:19,030 --> 00:20:22,510
interesting so even in some cases there

449
00:20:21,580 --> 00:20:25,480
was a detection

450
00:20:22,510 --> 00:20:30,220
there was no prevention or anything to

451
00:20:25,480 --> 00:20:33,159
actually stop moving forward by 4 out of

452
00:20:30,220 --> 00:20:36,730
15 detected at the privilege escalation

453
00:20:33,159 --> 00:20:40,480
or process injection layer so you know

454
00:20:36,730 --> 00:20:42,549
either when we tried to elevate prism or

455
00:20:40,480 --> 00:20:44,620
if we tried to inject into another

456
00:20:42,549 --> 00:20:47,590
process you know to make it you know

457
00:20:44,620 --> 00:20:49,239
inject into explorer.exe or some some

458
00:20:47,590 --> 00:20:52,928
other process that's normally running on

459
00:20:49,240 --> 00:20:57,520
the box 4 out of 15 got detected at that

460
00:20:52,929 --> 00:21:01,990
point which was interesting we had a an

461
00:20:57,520 --> 00:21:05,110
average of 5 bypasses 8% per next-gen AV

462
00:21:01,990 --> 00:21:08,340
vendor so that's that's a little

463
00:21:05,110 --> 00:21:11,500
different than 99.95%

464
00:21:08,340 --> 00:21:16,360
that's it was it was actually pretty

465
00:21:11,500 --> 00:21:19,659
surprising and not not great it's not

466
00:21:16,360 --> 00:21:22,370
perfect for sure the the most successful

467
00:21:19,659 --> 00:21:25,580
payload was n PS payload

468
00:21:22,370 --> 00:21:28,010
which is about two years old so for

469
00:21:25,580 --> 00:21:30,350
whatever reason you know folks haven't

470
00:21:28,010 --> 00:21:32,710
poked around on github enough or just

471
00:21:30,350 --> 00:21:35,809
don't know about Benton or trusted SEC

472
00:21:32,710 --> 00:21:39,860
this was an extremely successful payload

473
00:21:35,809 --> 00:21:43,970
it got past all of them and detection z'

474
00:21:39,860 --> 00:21:45,649
took between 24 and 48 hours for a

475
00:21:43,970 --> 00:21:48,799
detection and Prevention to be written

476
00:21:45,650 --> 00:21:51,169
by the vendor now and I say in POC mode

477
00:21:48,799 --> 00:21:52,400
so what that means is while we were

478
00:21:51,169 --> 00:21:54,919
doing our POC s

479
00:21:52,400 --> 00:21:57,799
the vendors were watching their

480
00:21:54,919 --> 00:22:00,440
computers very closely watching what was

481
00:21:57,799 --> 00:22:02,090
going on you know very very interested

482
00:22:00,440 --> 00:22:04,190
in what we were doing because we were

483
00:22:02,090 --> 00:22:06,799
you know taking a much deeper dive than

484
00:22:04,190 --> 00:22:08,120
most of their customers were and then

485
00:22:06,799 --> 00:22:11,299
you know when they would see something

486
00:22:08,120 --> 00:22:15,590
suddenly a prevention would be written

487
00:22:11,299 --> 00:22:18,950
and in place so you know it's it's it's

488
00:22:15,590 --> 00:22:21,139
not clear if this is a real life type of

489
00:22:18,950 --> 00:22:23,120
situation you know if we weren't in in

490
00:22:21,140 --> 00:22:25,039
POC mode if we weren't under the

491
00:22:23,120 --> 00:22:28,340
microscope and then watching our every

492
00:22:25,039 --> 00:22:30,620
move would their detection x' be written

493
00:22:28,340 --> 00:22:33,199
so quickly or would it take a longer

494
00:22:30,620 --> 00:22:34,939
amount of time this stuff to say and and

495
00:22:33,200 --> 00:22:40,070
that's that's one question that that i

496
00:22:34,940 --> 00:22:42,200
don't think we can really answer so this

497
00:22:40,070 --> 00:22:44,149
was the expectation you know I thought

498
00:22:42,200 --> 00:22:47,929
this was going to be like an almost

499
00:22:44,149 --> 00:22:49,760
impossible thing to do you know this is

500
00:22:47,929 --> 00:22:52,370
this stuff is gets a lot of marketing

501
00:22:49,760 --> 00:22:54,710
all that but the reality was you know

502
00:22:52,370 --> 00:22:56,649
basically just walked right out onto

503
00:22:54,710 --> 00:23:04,780
github

504
00:22:56,650 --> 00:23:09,730
open fire and laid waste so that's that

505
00:23:04,780 --> 00:23:11,200
was definitely not expected so I

506
00:23:09,730 --> 00:23:13,059
apologize I've been really hustling here

507
00:23:11,200 --> 00:23:16,650
but we're only 20 minutes in and we're

508
00:23:13,059 --> 00:23:19,680
getting towards the end some conclusions

509
00:23:16,650 --> 00:23:23,830
let's talk about this one 99.95%

510
00:23:19,680 --> 00:23:27,070
effective check they get that one

511
00:23:23,830 --> 00:23:29,530
because numbers are interesting if your

512
00:23:27,070 --> 00:23:32,639
sample set is 20 years worth of malware

513
00:23:29,530 --> 00:23:35,379
the 99.95% effective

514
00:23:32,640 --> 00:23:37,600
isn't easy not easy but it's a pretty

515
00:23:35,380 --> 00:23:40,540
easy thing to hit I mean there's so much

516
00:23:37,600 --> 00:23:43,090
malware over the last 20 years right so

517
00:23:40,540 --> 00:23:45,520
that number can be adjusted now if they

518
00:23:43,090 --> 00:23:48,040
came along and said well 99.95%

519
00:23:45,520 --> 00:23:50,410
effective in the last five years or in

520
00:23:48,040 --> 00:23:52,899
the last year that means a lot more

521
00:23:50,410 --> 00:23:55,150
because now we're drinking down the

522
00:23:52,900 --> 00:23:56,950
window and saying well you know more

523
00:23:55,150 --> 00:23:58,450
modern we're only looking at the modern

524
00:23:56,950 --> 00:24:01,290
stuff you know things like ransomware

525
00:23:58,450 --> 00:24:04,570
which didn't exist in the 90s you know

526
00:24:01,290 --> 00:24:09,360
so but they do get to make this claim so

527
00:24:04,570 --> 00:24:12,909
all right check mark all threat vectors

528
00:24:09,360 --> 00:24:15,129
all right no you don't get to make that

529
00:24:12,910 --> 00:24:19,420
one because you didn't think about this

530
00:24:15,130 --> 00:24:21,550
threat vector monkey with github yeah

531
00:24:19,420 --> 00:24:24,850
advanced threat actors and nation-state

532
00:24:21,550 --> 00:24:26,919
attacks that's that's a dangerous one

533
00:24:24,850 --> 00:24:30,459
it's a bold statement I'm not gonna say

534
00:24:26,920 --> 00:24:33,880
that that it's not true because I don't

535
00:24:30,460 --> 00:24:36,700
know you know we haven't as far as I'm

536
00:24:33,880 --> 00:24:40,830
aware seen any nation-state attacks you

537
00:24:36,700 --> 00:24:43,420
know in our POC environment and you know

538
00:24:40,830 --> 00:24:45,340
maybe you do but it's it's a really

539
00:24:43,420 --> 00:24:48,990
tough one to prove I'm just thinking

540
00:24:45,340 --> 00:24:51,909
it's a pretty bold statement because

541
00:24:48,990 --> 00:24:55,929
nation-state attackers have zero day

542
00:24:51,910 --> 00:24:57,730
exploits eternal blue the recent stuff

543
00:24:55,929 --> 00:25:00,790
that came out about the the smartphones

544
00:24:57,730 --> 00:25:02,770
that were you know for two years owning

545
00:25:00,790 --> 00:25:04,920
iOS and Android devices all across the

546
00:25:02,770 --> 00:25:07,480
board that was a nation-state attack and

547
00:25:04,920 --> 00:25:09,790
so you know if you had one of these next

548
00:25:07,480 --> 00:25:10,330
gen AV vendors out there maybe your

549
00:25:09,790 --> 00:25:14,139
phone would

550
00:25:10,330 --> 00:25:15,820
protecting I don't know oh yeah and I

551
00:25:14,140 --> 00:25:18,130
have a note here it says ninety-nine

552
00:25:15,820 --> 00:25:21,010
five ninety-nine point nine five percent

553
00:25:18,130 --> 00:25:24,790
of uptime still means twenty two minutes

554
00:25:21,010 --> 00:25:28,060
of downtime per month so just to talk

555
00:25:24,790 --> 00:25:31,090
about those interesting numbers again so

556
00:25:28,060 --> 00:25:32,740
as as far as the vendor claims and what

557
00:25:31,090 --> 00:25:36,399
they say this stuff could actually do

558
00:25:32,740 --> 00:25:39,460
yeah this is not fine like you can't say

559
00:25:36,400 --> 00:25:44,920
these things without you know some real

560
00:25:39,460 --> 00:25:46,480
good information to back it up so it's

561
00:25:44,920 --> 00:25:48,220
definitely better than previous

562
00:25:46,480 --> 00:25:50,620
generation right it's definitely better

563
00:25:48,220 --> 00:25:53,380
than then a signature based AV we can

564
00:25:50,620 --> 00:25:57,489
say that absolutely for sure without a

565
00:25:53,380 --> 00:25:59,380
doubt it does rely on signatures in some

566
00:25:57,490 --> 00:26:01,540
cases I showed you the squiggly-doo

567
00:25:59,380 --> 00:26:04,750
thing right that was absolutely a

568
00:26:01,540 --> 00:26:05,860
signature based detection you know they

569
00:26:04,750 --> 00:26:08,800
were they were not looking at the

570
00:26:05,860 --> 00:26:13,570
behavior there and you know hash is our

571
00:26:08,800 --> 00:26:15,820
signature global local prevalence can

572
00:26:13,570 --> 00:26:18,189
kind of be a signature so yeah the

573
00:26:15,820 --> 00:26:19,750
machine learning AI stuff you know I

574
00:26:18,190 --> 00:26:23,700
think they're getting ahead of

575
00:26:19,750 --> 00:26:29,170
themselves a little bit by claiming that

576
00:26:23,700 --> 00:26:30,490
but that's just my opinion man when it

577
00:26:29,170 --> 00:26:33,220
comes down to it there is no

578
00:26:30,490 --> 00:26:35,260
substitution for good logging high

579
00:26:33,220 --> 00:26:37,450
signal correlation and skilled thread

580
00:26:35,260 --> 00:26:40,060
hunters period there's no machine

581
00:26:37,450 --> 00:26:42,730
learning that is going to go and and be

582
00:26:40,060 --> 00:26:46,000
able to chain together a bunch of events

583
00:26:42,730 --> 00:26:47,860
and say oh that's an attack and that's

584
00:26:46,000 --> 00:26:49,120
that's just what it comes down to it now

585
00:26:47,860 --> 00:26:51,820
the good thing is that some of these

586
00:26:49,120 --> 00:26:54,070
next gen AV and EDR vendors they

587
00:26:51,820 --> 00:26:56,110
actually do have a human component that

588
00:26:54,070 --> 00:26:58,840
comes with it in the form of either an

589
00:26:56,110 --> 00:27:01,750
MS SP service where you have you know

590
00:26:58,840 --> 00:27:03,600
third party eyes on glass or you know

591
00:27:01,750 --> 00:27:07,180
something that gets flagged as

592
00:27:03,600 --> 00:27:09,730
suspicious and then flag to a human to

593
00:27:07,180 --> 00:27:12,160
go do the analysis and we saw this in in

594
00:27:09,730 --> 00:27:14,380
a few cases in our testing where we get

595
00:27:12,160 --> 00:27:16,510
past them and then all it would end up

596
00:27:14,380 --> 00:27:19,060
in a queue of you know things to look at

597
00:27:16,510 --> 00:27:21,920
and then the next day we'd have a

598
00:27:19,060 --> 00:27:23,570
detection and and you know an alerts

599
00:27:21,920 --> 00:27:26,000
hey we think something bad happened here

600
00:27:23,570 --> 00:27:29,600
so that's good it's that it's it's a

601
00:27:26,000 --> 00:27:31,610
good approach for sure and the enhanced

602
00:27:29,600 --> 00:27:34,490
logging that you get from some of these

603
00:27:31,610 --> 00:27:36,490
tools can help you build better alerts

604
00:27:34,490 --> 00:27:39,290
and better detection 'z which is great

605
00:27:36,490 --> 00:27:40,160
so that that's you know that's

606
00:27:39,290 --> 00:27:42,170
definitely it

607
00:27:40,160 --> 00:27:44,390
you know might help you do things like

608
00:27:42,170 --> 00:27:50,270
not deploy additional endpoint agents

609
00:27:44,390 --> 00:27:51,620
for more deeper logging and doing this

610
00:27:50,270 --> 00:27:53,870
type of testing can really help you

611
00:27:51,620 --> 00:27:55,669
understand your weaknesses and help you

612
00:27:53,870 --> 00:27:58,340
understand you know issues with the

613
00:27:55,670 --> 00:28:00,320
products that you might own the reason

614
00:27:58,340 --> 00:28:02,149
we you know kind of wanted to put the

615
00:28:00,320 --> 00:28:03,530
the methodology out there is so that you

616
00:28:02,150 --> 00:28:07,070
can go back to your own environment and

617
00:28:03,530 --> 00:28:08,300
do your own testing and see how well the

618
00:28:07,070 --> 00:28:10,700
products that you have implemented

619
00:28:08,300 --> 00:28:15,350
actually do you can follow this exact

620
00:28:10,700 --> 00:28:16,610
same path that we did and you know see

621
00:28:15,350 --> 00:28:18,379
see what's out there so you can see

622
00:28:16,610 --> 00:28:20,750
where your problems are and where where

623
00:28:18,380 --> 00:28:22,100
you might have gaps and you know if you

624
00:28:20,750 --> 00:28:24,320
do know that there's a particular

625
00:28:22,100 --> 00:28:25,820
weakness in this product and you can be

626
00:28:24,320 --> 00:28:30,560
on the lookout for things that are going

627
00:28:25,820 --> 00:28:34,040
after that weakness so again I didn't

628
00:28:30,560 --> 00:28:37,159
write any of the the stuff that was that

629
00:28:34,040 --> 00:28:39,920
presented here you can get references to

630
00:28:37,160 --> 00:28:42,320
all the github repos and all the people

631
00:28:39,920 --> 00:28:44,480
who worked on those repos you know

632
00:28:42,320 --> 00:28:46,879
please go here and and give them the

633
00:28:44,480 --> 00:28:48,050
proper amount of love because of the

634
00:28:46,880 --> 00:28:50,030
fact that this stuff is sitting out

635
00:28:48,050 --> 00:28:52,370
there for anybody to pull down and mess

636
00:28:50,030 --> 00:28:55,010
around with was extremely helpful for us

637
00:28:52,370 --> 00:28:57,439
it made us you know make sure that we

638
00:28:55,010 --> 00:29:00,050
made a good decision about our products

639
00:28:57,440 --> 00:29:03,470
and about what we were about to spend a

640
00:29:00,050 --> 00:29:07,730
ton of money on so definitely check that

641
00:29:03,470 --> 00:29:09,980
out if you can and there is no I in team

642
00:29:07,730 --> 00:29:12,050
I just want to give a shout out to my

643
00:29:09,980 --> 00:29:14,090
team members back at Dick's Sporting

644
00:29:12,050 --> 00:29:17,690
Goods who helped participate in the

645
00:29:14,090 --> 00:29:24,730
testing and get all this stuff done you

646
00:29:17,690 --> 00:29:24,730
know and uh question time sir

647
00:29:28,639 --> 00:29:33,658
so the question is was there a clear

648
00:29:31,080 --> 00:29:38,249
winner and I will say yes for us there

649
00:29:33,659 --> 00:29:40,950
was they and it was really because of

650
00:29:38,249 --> 00:29:43,649
the human component that I talked about

651
00:29:40,950 --> 00:29:46,139
they had a human component that was

652
00:29:43,649 --> 00:29:48,928
looking at anomalies digging deeper on

653
00:29:46,139 --> 00:29:51,449
things you know that looked weird what

654
00:29:48,929 --> 00:29:58,309
got passed but then we're flagged later

655
00:29:51,450 --> 00:29:58,309
as you know why did you get passed sir

656
00:30:00,019 --> 00:30:04,679
question is did we include non Windows

657
00:30:02,369 --> 00:30:06,749
operating systems and we did yeah we had

658
00:30:04,679 --> 00:30:23,340
a combination of Windows Mac and Linux

659
00:30:06,749 --> 00:30:25,200
than various flavors of Linux sir yeah

660
00:30:23,340 --> 00:30:27,570
the question was did we make any

661
00:30:25,200 --> 00:30:29,549
configuration changes around more

662
00:30:27,570 --> 00:30:32,610
advanced more aggressive scanning versus

663
00:30:29,549 --> 00:30:34,519
less aggressive and yes we did try to

664
00:30:32,610 --> 00:30:37,559
bump up into the most aggressive

665
00:30:34,519 --> 00:30:38,549
detections for all of them just to

666
00:30:37,559 --> 00:30:42,740
really put these things through their

667
00:30:38,549 --> 00:30:42,740
paces yes

668
00:30:55,600 --> 00:31:00,520
so the question was around the recent

669
00:30:58,210 --> 00:31:04,410
silence bypass by making it look like a

670
00:31:00,520 --> 00:31:08,170
game that came out after we were done

671
00:31:04,410 --> 00:31:10,360
but I know it wouldn't have impacted our

672
00:31:08,170 --> 00:31:14,400
testing because we didn't test that

673
00:31:10,360 --> 00:31:18,459
product yes

674
00:31:14,400 --> 00:31:21,190
did we have false positives yes but they

675
00:31:18,460 --> 00:31:23,559
were relatively low which was good

676
00:31:21,190 --> 00:31:25,000
they're just you know you find out what

677
00:31:23,559 --> 00:31:26,530
all the weird things are in your

678
00:31:25,000 --> 00:31:29,760
environment when you start doing stuff

679
00:31:26,530 --> 00:31:32,080
like this and we had a couple processes

680
00:31:29,760 --> 00:31:36,160
that you know we're totally normal for

681
00:31:32,080 --> 00:31:37,449
us but you know the a lot of the

682
00:31:36,160 --> 00:31:38,919
products that we tested you kind of were

683
00:31:37,450 --> 00:31:42,160
like what is what is going on here this

684
00:31:38,919 --> 00:31:44,470
looks shifty so to get those false

685
00:31:42,160 --> 00:31:46,390
positives turned down you either had to

686
00:31:44,470 --> 00:31:48,010
contact the vendor themselves and say

687
00:31:46,390 --> 00:31:49,330
hey this is completely normal for our

688
00:31:48,010 --> 00:31:51,250
environment even though it looks like

689
00:31:49,330 --> 00:31:53,980
weird behavior or you could flag them

690
00:31:51,250 --> 00:32:02,410
yourself and say not you this is this is

691
00:31:53,980 --> 00:32:04,690
normal no we were we were just purely

692
00:32:02,410 --> 00:32:05,919
testing this stuff quite sorry the

693
00:32:04,690 --> 00:32:08,080
question was did we have anything

694
00:32:05,919 --> 00:32:08,790
additional like app white listing and no

695
00:32:08,080 --> 00:32:21,040
we did not

696
00:32:08,790 --> 00:32:22,629
yes question is did we was there

697
00:32:21,040 --> 00:32:25,389
anything that we feel like we should

698
00:32:22,630 --> 00:32:29,860
have tested that we did not after the

699
00:32:25,390 --> 00:32:32,710
fact and I don't think so

700
00:32:29,860 --> 00:32:34,659
I mean the thing about it is like even

701
00:32:32,710 --> 00:32:37,870
though we did have a lot of time to go

702
00:32:34,660 --> 00:32:39,700
after this stuff and you know really dig

703
00:32:37,870 --> 00:32:42,850
into it pretty deep we did have a time

704
00:32:39,700 --> 00:32:46,630
box we were up against renewal of the

705
00:32:42,850 --> 00:32:48,879
previous solution and plus we have other

706
00:32:46,630 --> 00:32:51,070
work to do I mean it comes down to it so

707
00:32:48,880 --> 00:32:52,990
if we could have had more time I think

708
00:32:51,070 --> 00:32:54,820
that we would have tested more things we

709
00:32:52,990 --> 00:32:57,700
would have found more weird payloads you

710
00:32:54,820 --> 00:33:01,830
know to throw out there but now wait

711
00:32:57,700 --> 00:33:01,830
unfortunately yes

712
00:33:11,170 --> 00:33:15,800
we we were looking for so we were

713
00:33:13,610 --> 00:33:18,889
assuming okay mail gateway caught it but

714
00:33:15,800 --> 00:33:21,800
can the end point solution catch it so

715
00:33:18,890 --> 00:33:24,440
we took you know some some pretty fresh

716
00:33:21,800 --> 00:33:28,100
stuff you know things that were only a

717
00:33:24,440 --> 00:33:30,140
couple days old max and then ran it ran

718
00:33:28,100 --> 00:33:33,110
it as if the mail gateway wasn't there

719
00:33:30,140 --> 00:33:35,330
like as if somebody had for example gone

720
00:33:33,110 --> 00:33:50,719
to a webmail and they came in to him via

721
00:33:35,330 --> 00:33:58,730
webmail downloaded click boom yeah they

722
00:33:50,720 --> 00:34:00,380
were online yeah that's correct yet so

723
00:33:58,730 --> 00:34:02,300
the question was that you know what did

724
00:34:00,380 --> 00:34:03,530
we have the system's online so that they

725
00:34:02,300 --> 00:34:06,860
could communicate with their cloud

726
00:34:03,530 --> 00:34:08,300
intelligence platform and we did we and

727
00:34:06,860 --> 00:34:11,418
we wanted to be a little bit fair about

728
00:34:08,300 --> 00:34:14,149
it and say ok you know if the solution

729
00:34:11,418 --> 00:34:17,259
is operating as intended could we bypass

730
00:34:14,149 --> 00:34:17,259
it yes

731
00:34:30,268 --> 00:34:35,109
right so the question was did we would

732
00:34:32,949 --> 00:34:37,928
do anything to attack the system in such

733
00:34:35,109 --> 00:34:41,078
a way to cripple the the endpoint

734
00:34:37,929 --> 00:34:42,639
protection solution and answer there is

735
00:34:41,079 --> 00:34:45,789
no I know that there was a talk

736
00:34:42,639 --> 00:34:48,309
yesterday on next-gen AV where they did

737
00:34:45,789 --> 00:34:50,980
do that they would do things like you

738
00:34:48,309 --> 00:34:52,720
know change permissions on folders or

739
00:34:50,980 --> 00:34:54,039
disconnect from cloud you know

740
00:34:52,719 --> 00:34:55,899
disconnect the system so it couldn't

741
00:34:54,039 --> 00:34:57,369
talk to its cloud intelligence and that

742
00:34:55,899 --> 00:35:00,190
sort of thing and we did not do that

743
00:34:57,369 --> 00:35:02,710
that testing but that talk from

744
00:35:00,190 --> 00:35:04,089
yesterday is online right now and if

745
00:35:02,710 --> 00:35:05,529
you're interested I would definitely

746
00:35:04,089 --> 00:35:09,029
recommend taking a look because those

747
00:35:05,529 --> 00:35:09,029
guys did that kind of testing for sure

748
00:35:21,509 --> 00:35:27,880
so yeah question around the the test

749
00:35:24,309 --> 00:35:29,829
environment did we try to mimic the the

750
00:35:27,880 --> 00:35:31,299
environment that we already use the the

751
00:35:29,829 --> 00:35:33,700
images that we already used the answer

752
00:35:31,299 --> 00:35:35,380
there's yes yeah we wanted to to you

753
00:35:33,700 --> 00:35:41,069
know test against things that look like

754
00:35:35,380 --> 00:35:41,069
what we use absolutely yes in the back

755
00:35:44,609 --> 00:35:50,589
question is did we automate the testing

756
00:35:47,319 --> 00:35:53,288
in any way not the actual execution of

757
00:35:50,589 --> 00:35:56,049
payloads itself but generation of

758
00:35:53,289 --> 00:35:58,269
payloads I did run a cut you know write

759
00:35:56,049 --> 00:36:01,440
a couple simple scripts just to like

760
00:35:58,269 --> 00:36:06,758
automate all types of a particular

761
00:36:01,440 --> 00:36:08,200
reverse HTTP payload for example like

762
00:36:06,759 --> 00:36:10,420
run it through all these different types

763
00:36:08,200 --> 00:36:12,160
of obfuscation just so you know it was

764
00:36:10,420 --> 00:36:20,410
like quick and dirty here's twenty

765
00:36:12,160 --> 00:36:22,989
payloads real quick picture yes standard

766
00:36:20,410 --> 00:36:24,848
user yeah yeah question was it was it

767
00:36:22,989 --> 00:36:26,499
was a user standard or administrative

768
00:36:24,849 --> 00:36:28,470
and we were just going after standard

769
00:36:26,499 --> 00:36:30,819
users and then trying to elevate up to

770
00:36:28,470 --> 00:36:35,249
you know an administrator of our system

771
00:36:30,819 --> 00:36:35,249
type account yes

772
00:36:41,910 --> 00:36:47,290
yeah question is did we test containment

773
00:36:45,310 --> 00:36:48,549
which a lot of these new solutions have

774
00:36:47,290 --> 00:36:50,050
where you know you're essentially

775
00:36:48,550 --> 00:36:51,550
disconnecting it from the network and

776
00:36:50,050 --> 00:36:53,830
now can only communicate with the

777
00:36:51,550 --> 00:36:56,740
central cloud thing and we did test that

778
00:36:53,830 --> 00:37:00,150
out and those those were successful even

779
00:36:56,740 --> 00:37:02,589
in a situation where we bypassed because

780
00:37:00,150 --> 00:37:04,690
you know the the the the system's

781
00:37:02,590 --> 00:37:06,820
already the system's infected but you

782
00:37:04,690 --> 00:37:08,200
haven't we didn't tell it all right

783
00:37:06,820 --> 00:37:10,330
killed communications with the cloud

784
00:37:08,200 --> 00:37:12,399
like we didn't go you know to that next

785
00:37:10,330 --> 00:37:15,850
step we're still be able to contain even

786
00:37:12,400 --> 00:37:18,390
though we had system on the box yes

787
00:37:15,850 --> 00:37:18,390
white hat

788
00:37:20,490 --> 00:37:26,169
did we map successes and failure to

789
00:37:22,900 --> 00:37:29,620
mitre no we didn't the the majority of

790
00:37:26,170 --> 00:37:32,140
our successes fell into those four

791
00:37:29,620 --> 00:37:36,130
categories from the mitre attack

792
00:37:32,140 --> 00:37:39,370
framework and so we considered a success

793
00:37:36,130 --> 00:37:49,330
if we hit all four of those so it kind

794
00:37:39,370 --> 00:37:50,770
of you know anybody else yes how much

795
00:37:49,330 --> 00:37:54,759
time do we have for a test like that and

796
00:37:50,770 --> 00:38:01,050
it was about two weeks per product is

797
00:37:54,760 --> 00:38:01,050
that right yeah yes

798
00:38:05,710 --> 00:38:12,710
that's a good question question is uh

799
00:38:09,819 --> 00:38:16,339
does our NDA expire at any time I will

800
00:38:12,710 --> 00:38:18,079
check with our legal team yeah it's it's

801
00:38:16,339 --> 00:38:19,490
unfortunate that they place that kind of

802
00:38:18,079 --> 00:38:21,410
restraint you know because you've seen

803
00:38:19,490 --> 00:38:24,430
other situations where you know I think

804
00:38:21,410 --> 00:38:28,029
there was a guy who had bypassed

805
00:38:24,430 --> 00:38:30,919
Sentinel 1 and they he actually got sued

806
00:38:28,030 --> 00:38:33,530
you know or some you know some legal

807
00:38:30,920 --> 00:38:34,940
action was taken against him you know

808
00:38:33,530 --> 00:38:37,250
was like well this is not part of the

809
00:38:34,940 --> 00:38:39,410
license and by the way how did you get a

810
00:38:37,250 --> 00:38:41,750
copy of this and and you know he he

811
00:38:39,410 --> 00:38:45,109
wasn't under NDA but somehow had a copy

812
00:38:41,750 --> 00:39:01,130
of the software which requires you to be

813
00:38:45,109 --> 00:39:04,130
under NDA so yes so yeah the question is

814
00:39:01,130 --> 00:39:07,369
you know the vendors were watching what

815
00:39:04,130 --> 00:39:09,200
additional type of I guess watching were

816
00:39:07,369 --> 00:39:10,970
they were doing while we were doing the

817
00:39:09,200 --> 00:39:13,399
POC so that's a good one

818
00:39:10,970 --> 00:39:15,020
because it reminds me of a particular

819
00:39:13,400 --> 00:39:18,290
request I got from one of those vendors

820
00:39:15,020 --> 00:39:21,259
where we bypassed their solution got

821
00:39:18,290 --> 00:39:25,759
system dump creds me me cat successful

822
00:39:21,260 --> 00:39:28,190
and they said well could you here's

823
00:39:25,760 --> 00:39:31,160
here's this additional logging tool can

824
00:39:28,190 --> 00:39:32,660
you run this and then run that again so

825
00:39:31,160 --> 00:39:35,359
that's the kind of support they were

826
00:39:32,660 --> 00:39:37,848
giving us you know they were because you

827
00:39:35,359 --> 00:39:39,470
know if a successful attack happens

828
00:39:37,849 --> 00:39:40,940
you're not gonna you're not gonna give

829
00:39:39,470 --> 00:39:42,109
it you know give it to your customer and

830
00:39:40,940 --> 00:39:43,880
be like hey can you give us additional

831
00:39:42,109 --> 00:39:45,440
logs so we can write a detection you

832
00:39:43,880 --> 00:39:47,450
know so it was kind of down to that

833
00:39:45,440 --> 00:39:49,190
level as far as you know how closely

834
00:39:47,450 --> 00:39:50,689
otherwise they were watching I mean we

835
00:39:49,190 --> 00:39:53,420
know that they were they were watching

836
00:39:50,690 --> 00:39:56,270
very closely because we were having you

837
00:39:53,420 --> 00:39:58,849
know almost twice weekly calls with them

838
00:39:56,270 --> 00:40:01,280
you know and they were constantly asking

839
00:39:58,849 --> 00:40:02,869
how are things going you know and when I

840
00:40:01,280 --> 00:40:06,380
would get on the phone they were didn't

841
00:40:02,869 --> 00:40:10,930
like talking to me and that's that's

842
00:40:06,380 --> 00:40:10,930
that's how you know yeah

843
00:40:13,230 --> 00:40:19,150
so it was it was really just once we got

844
00:40:16,240 --> 00:40:22,689
meterpreter shell migrate into another

845
00:40:19,150 --> 00:40:25,480
process that was all I was doing and it

846
00:40:22,690 --> 00:40:26,860
was you know on the payloads that got

847
00:40:25,480 --> 00:40:28,510
bypassed it was most of the time

848
00:40:26,860 --> 00:40:34,410
successful there was four out of 15

849
00:40:28,510 --> 00:40:34,410
where we got caught out as we did that

850
00:40:35,370 --> 00:40:46,900
yes so the question is did the vendors

851
00:40:45,550 --> 00:40:48,910
threaten legal action because of what we

852
00:40:46,900 --> 00:40:50,920
were doing no because we kind of laid

853
00:40:48,910 --> 00:40:52,660
the groundwork upfront we're we've told

854
00:40:50,920 --> 00:40:55,480
them right out of the gate so like look

855
00:40:52,660 --> 00:40:57,339
guys we're gonna do a very deep amount

856
00:40:55,480 --> 00:40:58,750
of testing on our own systems so it's

857
00:40:57,340 --> 00:41:00,670
not like we're attacking somebody else

858
00:40:58,750 --> 00:41:02,830
the system we don't own we're really

859
00:41:00,670 --> 00:41:05,710
attacking our own systems to test the

860
00:41:02,830 --> 00:41:10,710
the you know efficacy of their products

861
00:41:05,710 --> 00:41:10,710
and they were good with at the beginning

862
00:41:14,130 --> 00:41:17,130
yeah

863
00:41:25,440 --> 00:41:29,440
so question is did they know I was going

864
00:41:28,300 --> 00:41:31,420
to get up here today and talk about

865
00:41:29,440 --> 00:41:34,630
next-gen av you know not being perfect

866
00:41:31,420 --> 00:41:37,240
no we didn't talk about publishing

867
00:41:34,630 --> 00:41:38,680
results or anything like that the NDA

868
00:41:37,240 --> 00:41:40,990
says you know he can't talk about

869
00:41:38,680 --> 00:41:45,430
specifics around our products I haven't

870
00:41:40,990 --> 00:41:47,589
done that so that's that's really where

871
00:41:45,430 --> 00:41:57,819
I thought it was you know we're still

872
00:41:47,590 --> 00:41:59,500
within our box anybody else a lot of

873
00:41:57,820 --> 00:42:00,730
great questions and I thank you so much

874
00:41:59,500 --> 00:42:02,440
for them and I thank you for coming in

875
00:42:00,730 --> 00:42:02,830
here today have a great third week on

876
00:42:02,440 --> 00:42:09,730
everyone

877
00:42:02,830 --> 00:42:09,730
[Applause]

