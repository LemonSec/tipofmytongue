1
00:00:06,400 --> 00:00:10,079
[Applause]

2
00:00:31,440 --> 00:00:38,790
okay okay I don't want to accidentally

3
00:00:35,910 --> 00:00:41,489
touch it can people hear me okay what a

4
00:00:38,790 --> 00:00:43,350
time to be alive thank you all for

5
00:00:41,489 --> 00:00:45,209
coming to my presentation I'm really

6
00:00:43,350 --> 00:00:47,640
looking forward to it this has been

7
00:00:45,210 --> 00:00:51,030
research that I've been thinking about

8
00:00:47,640 --> 00:00:52,980
working on for the last year too and and

9
00:00:51,030 --> 00:00:54,780
just to get things started really the

10
00:00:52,980 --> 00:00:57,690
point of this presentation is sigmund

11
00:00:54,780 --> 00:00:59,370
you all the audience that emotional

12
00:00:57,690 --> 00:01:01,349
intelligence and the understanding of

13
00:00:59,370 --> 00:01:03,390
human behavior makes for better

14
00:01:01,350 --> 00:01:05,790
technical people right we can become

15
00:01:03,390 --> 00:01:08,430
better Red Team operators and we can

16
00:01:05,790 --> 00:01:11,250
maybe we can become better penetration

17
00:01:08,430 --> 00:01:13,350
testers if we understand behavioral

18
00:01:11,250 --> 00:01:17,250
science there's not really a need to

19
00:01:13,350 --> 00:01:19,979
constantly reinvent the wheel so here's

20
00:01:17,250 --> 00:01:22,259
the the classs the classic slide of Who

21
00:01:19,979 --> 00:01:23,640
am I and this is going to be kind of a

22
00:01:22,259 --> 00:01:27,119
theme throughout the presentation

23
00:01:23,640 --> 00:01:29,009
because who I am to convince you guys to

24
00:01:27,119 --> 00:01:31,500
listen to me about the red teaming stuff

25
00:01:29,009 --> 00:01:34,500
I'm a consultant at Specter ops I

26
00:01:31,500 --> 00:01:37,289
primarily focus on red teaming adversary

27
00:01:34,500 --> 00:01:39,349
simulation network penetration testing

28
00:01:37,289 --> 00:01:42,390
and kind of everything under that

29
00:01:39,349 --> 00:01:45,000
umbrella I have a background in Incident

30
00:01:42,390 --> 00:01:47,520
Response but that's not really been my

31
00:01:45,000 --> 00:01:49,050
focus the last year or two I've been

32
00:01:47,520 --> 00:01:50,759
consulting for about three years and

33
00:01:49,050 --> 00:01:53,360
working at spec drops for one and it's

34
00:01:50,759 --> 00:01:57,240
always kind of been under this broad

35
00:01:53,360 --> 00:01:59,640
adversary simulation type of work I'm

36
00:01:57,240 --> 00:02:01,738
also a behavioral science enthusiast I

37
00:01:59,640 --> 00:02:04,979
say enthusiast because I'm definitely

38
00:02:01,739 --> 00:02:08,550
not an expert I I read a lot of books

39
00:02:04,979 --> 00:02:11,940
and I I mean I I really enjoy taking my

40
00:02:08,550 --> 00:02:14,220
abstract ideas from the the behavioral

41
00:02:11,940 --> 00:02:16,709
science books and being able to apply

42
00:02:14,220 --> 00:02:18,690
them to my red team operations that's

43
00:02:16,709 --> 00:02:21,630
what gets me really excited about going

44
00:02:18,690 --> 00:02:23,849
to work and it's it's the constant I

45
00:02:21,630 --> 00:02:25,950
have a hypothesis and then I can go test

46
00:02:23,849 --> 00:02:28,769
it and see is this actually applicable

47
00:02:25,950 --> 00:02:30,599
to other domains and I wouldn't be

48
00:02:28,770 --> 00:02:33,810
giving this presentation if I came to

49
00:02:30,599 --> 00:02:35,760
the conclusion that it's not relevant

50
00:02:33,810 --> 00:02:38,700
guess what it is certain themes are

51
00:02:35,760 --> 00:02:41,700
pervasive across humanity and we can

52
00:02:38,700 --> 00:02:43,410
learn a lot from them and one thing that

53
00:02:41,700 --> 00:02:44,459
I've really been thinking about a lot

54
00:02:43,410 --> 00:02:47,250
especially

55
00:02:44,460 --> 00:02:48,540
the past year is computers take on the

56
00:02:47,250 --> 00:02:52,290
biases of their owners

57
00:02:48,540 --> 00:02:54,030
right but what does that mean for us as

58
00:02:52,290 --> 00:02:56,220
red teamers what does that mean for

59
00:02:54,030 --> 00:02:58,320
adversary simulation because if

60
00:02:56,220 --> 00:03:00,990
computers take on the biases of their

61
00:02:58,320 --> 00:03:03,420
owners and that means that all of my my

62
00:03:00,990 --> 00:03:06,650
free time spent reading these books is

63
00:03:03,420 --> 00:03:09,420
relevant I can take the same type of

64
00:03:06,650 --> 00:03:11,850
attack vectors or the same exploitation

65
00:03:09,420 --> 00:03:13,980
techniques and see if they apply to the

66
00:03:11,850 --> 00:03:18,060
underlying principles of how we exploit

67
00:03:13,980 --> 00:03:20,820
stuff one thing that I want to start off

68
00:03:18,060 --> 00:03:24,180
with is who I'm not just to make sure

69
00:03:20,820 --> 00:03:26,970
that everyone here is here for the right

70
00:03:24,180 --> 00:03:28,950
reason when I submitted this talk back

71
00:03:26,970 --> 00:03:32,550
in March I I thought of myself as a

72
00:03:28,950 --> 00:03:34,649
social engineer and I realized that that

73
00:03:32,550 --> 00:03:36,800
was the best social engineering I ever

74
00:03:34,650 --> 00:03:39,450
did like the biggest have the biggest

75
00:03:36,800 --> 00:03:40,950
social engineering job I did was to

76
00:03:39,450 --> 00:03:43,440
convince myself that I'm a social

77
00:03:40,950 --> 00:03:45,000
engineer because I look different and

78
00:03:43,440 --> 00:03:48,420
you know what that's not a really good

79
00:03:45,000 --> 00:03:50,370
reason to be a social engineer a social

80
00:03:48,420 --> 00:03:52,890
engineer has a lot of different

81
00:03:50,370 --> 00:03:54,600
characteristics actually yesterday I

82
00:03:52,890 --> 00:03:57,149
went over to the social engineering

83
00:03:54,600 --> 00:04:00,049
village and I asked a few people okay

84
00:03:57,150 --> 00:04:02,910
what makes a strong social engineer and

85
00:04:00,050 --> 00:04:05,120
I loved the first answer because it was

86
00:04:02,910 --> 00:04:07,560
concise and the answer was empathy and

87
00:04:05,120 --> 00:04:09,390
now I'm starting to doubt whether I'm a

88
00:04:07,560 --> 00:04:11,670
social engineering wizard or not because

89
00:04:09,390 --> 00:04:14,010
I like to think I'm empathetic but there

90
00:04:11,670 --> 00:04:16,159
is a continuous doubt that I have about

91
00:04:14,010 --> 00:04:19,829
all of my strengths and my weaknesses

92
00:04:16,160 --> 00:04:21,480
I'm also not a security expert I don't

93
00:04:19,829 --> 00:04:22,740
think I'm a social engineering expert

94
00:04:21,480 --> 00:04:25,020
and I definitely don't think I'm a

95
00:04:22,740 --> 00:04:27,360
security expert but there's a lot of

96
00:04:25,020 --> 00:04:30,659
power to be able to say that I am NOT an

97
00:04:27,360 --> 00:04:33,120
expert in in something I think that

98
00:04:30,660 --> 00:04:36,270
being an expert gets in the way of our

99
00:04:33,120 --> 00:04:38,370
drive to seek out the truth right we get

100
00:04:36,270 --> 00:04:41,760
seduced into thinking that we know what

101
00:04:38,370 --> 00:04:44,520
what is going on when really we we might

102
00:04:41,760 --> 00:04:47,130
not and that overconfidence is what we

103
00:04:44,520 --> 00:04:49,229
are exploiting in insecurity systems

104
00:04:47,130 --> 00:04:50,760
it's what we're exploiting when we're

105
00:04:49,230 --> 00:04:54,090
interacting with people and it's

106
00:04:50,760 --> 00:04:56,370
something to be very skeptical of I am

107
00:04:54,090 --> 00:04:58,080
giving a presentation right now with

108
00:04:56,370 --> 00:05:00,090
things that will go into South LA

109
00:04:58,080 --> 00:05:02,128
like windows authentication and just

110
00:05:00,090 --> 00:05:03,659
looking at the crowd I know there's

111
00:05:02,129 --> 00:05:06,569
people out there that know more about

112
00:05:03,659 --> 00:05:07,860
this than I do I know that in this crowd

113
00:05:06,569 --> 00:05:10,919
there's people that know more about

114
00:05:07,860 --> 00:05:13,110
behavioral science but the reason why

115
00:05:10,919 --> 00:05:14,909
I'm giving this talk is because of my

116
00:05:13,110 --> 00:05:17,240
ability to connect the dots and I think

117
00:05:14,909 --> 00:05:20,699
that's something that I am an expert in

118
00:05:17,240 --> 00:05:22,800
so another Who am I slide more than

119
00:05:20,699 --> 00:05:24,840
anything I'm a product of my community I

120
00:05:22,800 --> 00:05:28,139
graduated from the University of Miami

121
00:05:24,840 --> 00:05:29,878
about three years ago and I wouldn't be

122
00:05:28,139 --> 00:05:32,069
here if I didn't surround myself with

123
00:05:29,879 --> 00:05:34,849
great people and follow great people on

124
00:05:32,069 --> 00:05:37,710
Twitter probably the most relevant

125
00:05:34,849 --> 00:05:40,889
pieces of work to this presentation

126
00:05:37,710 --> 00:05:42,419
would be an ace up the sleeve by well

127
00:05:40,889 --> 00:05:45,150
Schrader Andy Robbins and Lee

128
00:05:42,419 --> 00:05:48,289
Christensen and security professionals

129
00:05:45,150 --> 00:05:52,440
the the plumbers of trust from Peter

130
00:05:48,289 --> 00:05:54,479
cockta and that was from a 2012 Troopers

131
00:05:52,440 --> 00:05:56,580
conference and then on the behavioral

132
00:05:54,479 --> 00:05:59,340
science side it's Daniel Kahneman

133
00:05:56,580 --> 00:06:01,289
Thinking Fast and Slow that was actually

134
00:05:59,340 --> 00:06:03,138
my my first introduction to behavioral

135
00:06:01,289 --> 00:06:06,930
science I'm a college professor

136
00:06:03,139 --> 00:06:09,000
suggested that I read it and then Nassim

137
00:06:06,930 --> 00:06:12,900
Nicholas Taleb book fooled by randomness

138
00:06:09,000 --> 00:06:15,839
and also algorithms slip by by Brian

139
00:06:12,900 --> 00:06:18,299
Christian and Tom Griffiths so I think

140
00:06:15,839 --> 00:06:20,250
that all of us sitting here are just

141
00:06:18,300 --> 00:06:22,199
products of our community right we're

142
00:06:20,250 --> 00:06:24,270
all learning from each other and we're

143
00:06:22,199 --> 00:06:25,860
taking the knowledge of the people that

144
00:06:24,270 --> 00:06:27,750
were surrounded with and we're building

145
00:06:25,860 --> 00:06:31,110
on those ideas right it's that constant

146
00:06:27,750 --> 00:06:32,669
improvement and for me I hope that the

147
00:06:31,110 --> 00:06:34,969
next time I gave a conference talk I

148
00:06:32,669 --> 00:06:38,520
have even more extremely influential

149
00:06:34,969 --> 00:06:39,830
pieces particularly probably from those

150
00:06:38,520 --> 00:06:42,389
in this crowd

151
00:06:39,830 --> 00:06:44,580
so this talk title is called practical

152
00:06:42,389 --> 00:06:45,900
heuristic exploitation and the first

153
00:06:44,580 --> 00:06:49,500
thing I want to get across is that

154
00:06:45,900 --> 00:06:51,779
heuristics are not bad right it sounds

155
00:06:49,500 --> 00:06:54,870
bad from the title but here is six

156
00:06:51,779 --> 00:06:57,150
they're not good or bad they just are

157
00:06:54,870 --> 00:07:00,389
right here a six is something that

158
00:06:57,150 --> 00:07:01,799
humanity has learned to deal with and we

159
00:07:00,389 --> 00:07:04,020
have to deal with it because we're

160
00:07:01,800 --> 00:07:05,460
making so many decisions every day we

161
00:07:04,020 --> 00:07:09,839
want to be able to think fast

162
00:07:05,460 --> 00:07:11,789
to define a heuristic which probably not

163
00:07:09,839 --> 00:07:14,850
all of you know what here it is

164
00:07:11,790 --> 00:07:17,400
it's mostly just a mental shortcut or an

165
00:07:14,850 --> 00:07:19,230
algorithmic shortcut so we don't always

166
00:07:17,400 --> 00:07:21,989
need to be perfect when we're making

167
00:07:19,230 --> 00:07:24,840
decisions especially because we're

168
00:07:21,990 --> 00:07:27,090
incentivized by speed right so often

169
00:07:24,840 --> 00:07:30,090
we'll trade completeness accuracy and

170
00:07:27,090 --> 00:07:32,729
precision for speed right because we

171
00:07:30,090 --> 00:07:35,340
want to be quickly moving forward we can

172
00:07:32,730 --> 00:07:37,230
see this in the way that algorithms work

173
00:07:35,340 --> 00:07:39,150
so if you think of a bubble sort that

174
00:07:37,230 --> 00:07:41,610
takes a very long time and it's pretty

175
00:07:39,150 --> 00:07:44,940
inefficient or we have quicksort which

176
00:07:41,610 --> 00:07:47,520
is pretty fast for a lot of inputs but

177
00:07:44,940 --> 00:07:50,340
regardless of if it's a person thinking

178
00:07:47,520 --> 00:07:52,409
about what they're going to do that day

179
00:07:50,340 --> 00:07:56,580
or how we're setting up our algorithms

180
00:07:52,410 --> 00:07:58,680
we want to incentivize speed or devs

181
00:07:56,580 --> 00:08:00,630
have been incentivized by speed by

182
00:07:58,680 --> 00:08:02,880
people that create applications are

183
00:08:00,630 --> 00:08:04,620
incentivized by speed we want really

184
00:08:02,880 --> 00:08:06,870
quick interactions and we want to be

185
00:08:04,620 --> 00:08:09,270
able to connect ideas quickly and we use

186
00:08:06,870 --> 00:08:11,370
heuristics to do that so they're not bad

187
00:08:09,270 --> 00:08:13,320
but because they're not always always

188
00:08:11,370 --> 00:08:16,320
accurate that means that they can be

189
00:08:13,320 --> 00:08:19,409
exploited so one example I want to give

190
00:08:16,320 --> 00:08:21,840
to try to give an example of heuristics

191
00:08:19,410 --> 00:08:25,140
and how we think about them is how we

192
00:08:21,840 --> 00:08:29,010
recall a memory so if you think about

193
00:08:25,140 --> 00:08:31,110
what you had for lunch for lunch I had

194
00:08:29,010 --> 00:08:34,229
leftovers from dinner two nights ago it

195
00:08:31,110 --> 00:08:36,419
was awesome but I I can't remember what

196
00:08:34,229 --> 00:08:38,220
I had for lunch two weeks ago so things

197
00:08:36,419 --> 00:08:41,669
that are really recent stay in our

198
00:08:38,220 --> 00:08:44,580
memory right and another thing that that

199
00:08:41,669 --> 00:08:47,550
drives how easily is how easily it is to

200
00:08:44,580 --> 00:08:49,200
index in memory is things that happened

201
00:08:47,550 --> 00:08:52,290
often or things that you've heard often

202
00:08:49,200 --> 00:08:54,240
so a ninth-grade bio I learned that

203
00:08:52,290 --> 00:08:56,250
mitochondria is the powerhouse of the

204
00:08:54,240 --> 00:08:58,260
cell and I still remember that that's

205
00:08:56,250 --> 00:09:00,720
something that still I think about all

206
00:08:58,260 --> 00:09:02,520
the time and that's ridiculous but it's

207
00:09:00,720 --> 00:09:04,650
just because I heard it so many times

208
00:09:02,520 --> 00:09:05,760
like mitochondria is the powerhouse of

209
00:09:04,650 --> 00:09:09,569
the cell mitochondria is the powerhouse

210
00:09:05,760 --> 00:09:12,150
of the cell and also very interesting

211
00:09:09,570 --> 00:09:14,810
things are stuff that I remember right

212
00:09:12,150 --> 00:09:19,410
huge times in my life like I remember

213
00:09:14,810 --> 00:09:21,989
getting a Red Bull vodka spilled on me

214
00:09:19,410 --> 00:09:25,160
when I was walking to work my favorite I

215
00:09:21,990 --> 00:09:26,810
was walking to work during my internship

216
00:09:25,160 --> 00:09:28,699
that's a pretty obscure moment when you

217
00:09:26,810 --> 00:09:30,739
think about it it was a few years ago

218
00:09:28,699 --> 00:09:33,290
but it had a large impact on me because

219
00:09:30,740 --> 00:09:35,120
it was interesting and there's ways in

220
00:09:33,290 --> 00:09:38,360
computers that we can also see how the

221
00:09:35,120 --> 00:09:40,069
same heuristics apply so I very broad

222
00:09:38,360 --> 00:09:42,589
level as well if we think of browser

223
00:09:40,069 --> 00:09:45,229
caching right browser caching is taking

224
00:09:42,589 --> 00:09:47,689
advantage of temporary storage locations

225
00:09:45,230 --> 00:09:51,319
on your computer it's saving things like

226
00:09:47,689 --> 00:09:54,649
HTML CSS stylesheets JavaScript scripts

227
00:09:51,319 --> 00:09:56,719
images kind of all that jazz and the

228
00:09:54,649 --> 00:09:58,759
point is is to be able to reduce

229
00:09:56,720 --> 00:10:01,540
bandwidth on both the user and the

230
00:09:58,759 --> 00:10:04,639
server and allow the page to load faster

231
00:10:01,540 --> 00:10:06,439
so browser caching is a broad example

232
00:10:04,639 --> 00:10:08,389
but there's been a few different

233
00:10:06,439 --> 00:10:11,899
presentations about things like D

234
00:10:08,389 --> 00:10:15,500
popping and how saving specific file

235
00:10:11,899 --> 00:10:19,550
locations can help incentivize speed for

236
00:10:15,500 --> 00:10:22,129
credential access like I've mentioned

237
00:10:19,550 --> 00:10:25,069
before heuristics are to help us think

238
00:10:22,129 --> 00:10:26,750
really quickly and to give all of you an

239
00:10:25,069 --> 00:10:29,839
example of how we're thinking really

240
00:10:26,750 --> 00:10:32,810
quickly we make about 35,000 decisions a

241
00:10:29,839 --> 00:10:34,880
day you all decided to walk into this

242
00:10:32,810 --> 00:10:37,430
talk I'm thinking that there might be

243
00:10:34,880 --> 00:10:39,259
something worth learning out of it or or

244
00:10:37,430 --> 00:10:40,910
you know me and want to support me but

245
00:10:39,259 --> 00:10:43,550
still that's a decision and think about

246
00:10:40,910 --> 00:10:45,649
how many decisions led up to that it's

247
00:10:43,550 --> 00:10:46,910
ok am I going to be late is there

248
00:10:45,649 --> 00:10:49,130
another talk that's better is there

249
00:10:46,910 --> 00:10:50,839
something more relevant to my field you

250
00:10:49,130 --> 00:10:53,089
can also think of how you wake up in the

251
00:10:50,839 --> 00:10:54,860
morning right when you wake up in the

252
00:10:53,089 --> 00:10:57,350
morning and you roll out of bed and you

253
00:10:54,860 --> 00:10:59,000
decide what to wear and you decide am I

254
00:10:57,350 --> 00:11:01,339
going to eat breakfast well I have tea

255
00:10:59,000 --> 00:11:03,259
well I have coffee all these decisions

256
00:11:01,339 --> 00:11:05,600
are compounding right they keep on

257
00:11:03,259 --> 00:11:07,759
adding up and if we don't automate them

258
00:11:05,600 --> 00:11:10,819
we're not going to going to ever be able

259
00:11:07,759 --> 00:11:13,009
to make a decision and we use these

260
00:11:10,819 --> 00:11:15,709
these patterns to help us better

261
00:11:13,009 --> 00:11:18,949
understand how we're going to automate

262
00:11:15,709 --> 00:11:21,888
these decisions and so like this slide

263
00:11:18,949 --> 00:11:23,959
says we make 35,000 sons a day but I

264
00:11:21,889 --> 00:11:27,379
would I would further that and say we

265
00:11:23,959 --> 00:11:30,018
make 35,000 predictions a day every

266
00:11:27,379 --> 00:11:31,970
decision that we make is a prediction

267
00:11:30,019 --> 00:11:34,160
about the future you guys walked it into

268
00:11:31,970 --> 00:11:36,980
the sock because you thought it might be

269
00:11:34,160 --> 00:11:38,020
worthwhile well let's see if it is later

270
00:11:36,980 --> 00:11:41,440
on

271
00:11:38,020 --> 00:11:42,850
but but also when you're waking up in

272
00:11:41,440 --> 00:11:45,070
the morning you're deciding what to wear

273
00:11:42,850 --> 00:11:45,850
you're thinking this is appropriate for

274
00:11:45,070 --> 00:11:47,230
the workplace

275
00:11:45,850 --> 00:11:49,089
or you're going out at night this is

276
00:11:47,230 --> 00:11:50,709
appropriate for this these are all small

277
00:11:49,089 --> 00:11:53,500
predictions and they're constantly

278
00:11:50,709 --> 00:11:56,170
compounding on each other and these

279
00:11:53,500 --> 00:11:58,480
decisions aren't always right in fact a

280
00:11:56,170 --> 00:12:00,370
lot of times when we have a little bit

281
00:11:58,480 --> 00:12:02,589
more of a complex problem or or we're

282
00:12:00,370 --> 00:12:04,899
thinking really deeply like when I'm

283
00:12:02,589 --> 00:12:08,589
doing math and I remember whenever I do

284
00:12:04,899 --> 00:12:10,360
math because it's it's hard or whenever

285
00:12:08,589 --> 00:12:12,580
we're doing a new task we have to think

286
00:12:10,360 --> 00:12:14,470
about it a little bit longer and those

287
00:12:12,580 --> 00:12:17,290
are the decisions that we remember from

288
00:12:14,470 --> 00:12:19,510
the day but all the unconscious ones the

289
00:12:17,290 --> 00:12:21,189
ones that are below the surface that's

290
00:12:19,510 --> 00:12:23,380
what I want to focus on it's not the

291
00:12:21,190 --> 00:12:26,740
novel step it's what we've automated in

292
00:12:23,380 --> 00:12:28,480
our own lives so there's an in

293
00:12:26,740 --> 00:12:31,000
behavioral science there's a concept of

294
00:12:28,480 --> 00:12:33,630
thrashing right this is when you have so

295
00:12:31,000 --> 00:12:35,860
many decisions going on all the time and

296
00:12:33,630 --> 00:12:38,740
you're constantly being given new

297
00:12:35,860 --> 00:12:40,839
information and I want to point out that

298
00:12:38,740 --> 00:12:44,350
more information does not necessarily

299
00:12:40,839 --> 00:12:46,149
mean better signal more information can

300
00:12:44,350 --> 00:12:48,310
actually be harmful if you don't have a

301
00:12:46,149 --> 00:12:49,899
reason for it I recently changed my

302
00:12:48,310 --> 00:12:51,609
twitter handle to quell the noise

303
00:12:49,899 --> 00:12:54,100
because I thought it sounded like kill

304
00:12:51,610 --> 00:12:56,680
the noise a little bit and that's

305
00:12:54,100 --> 00:12:59,500
because I realized how much noise I was

306
00:12:56,680 --> 00:13:02,410
inputting all of the time right so I

307
00:12:59,500 --> 00:13:04,450
want to increase signal without

308
00:13:02,410 --> 00:13:05,699
increasing noise because I won't be able

309
00:13:04,450 --> 00:13:08,200
to make a decision

310
00:13:05,700 --> 00:13:11,310
during my assessments as a Red Team

311
00:13:08,200 --> 00:13:13,750
operator I can see myself thrash right I

312
00:13:11,310 --> 00:13:15,939
join a network out right after gaining

313
00:13:13,750 --> 00:13:18,550
initial access and I will sometimes get

314
00:13:15,940 --> 00:13:22,930
paralyzed by the idea of there is so

315
00:13:18,550 --> 00:13:25,359
much stuff out there Wow okay what now

316
00:13:22,930 --> 00:13:27,370
because there's so much to look at do I

317
00:13:25,360 --> 00:13:29,560
do I start looking at processes what

318
00:13:27,370 --> 00:13:32,260
processes should I look for what do I do

319
00:13:29,560 --> 00:13:35,199
and during these times of thrashing it's

320
00:13:32,260 --> 00:13:37,779
important to identify what tools that we

321
00:13:35,200 --> 00:13:39,370
have to better to help us be better

322
00:13:37,779 --> 00:13:42,730
operators and to actually move forward

323
00:13:39,370 --> 00:13:44,410
the tool that I use it was created by

324
00:13:42,730 --> 00:13:47,350
will Schrader and Lee Christensen on

325
00:13:44,410 --> 00:13:48,939
seatbelt I go to the experts and I asked

326
00:13:47,350 --> 00:13:50,880
them okay what do they think is

327
00:13:48,940 --> 00:13:52,890
important right

328
00:13:50,880 --> 00:13:54,780
and what do they think is actually worth

329
00:13:52,890 --> 00:13:57,120
looking into seatbelts a great

330
00:13:54,780 --> 00:14:00,329
situational awareness tool and it helps

331
00:13:57,120 --> 00:14:01,950
me then start deciding okay here is

332
00:14:00,330 --> 00:14:03,600
actually what I'm gonna start looking at

333
00:14:01,950 --> 00:14:05,250
because there are experts who have been

334
00:14:03,600 --> 00:14:08,040
looking at this they think it's

335
00:14:05,250 --> 00:14:10,020
important and if I take what the experts

336
00:14:08,040 --> 00:14:11,880
things think are important and I start

337
00:14:10,020 --> 00:14:13,949
breaking it down of why do they think

338
00:14:11,880 --> 00:14:19,020
it's important I can become a better

339
00:14:13,950 --> 00:14:21,750
operator faster so also on the same kind

340
00:14:19,020 --> 00:14:24,480
of lens of thrashing think about how

341
00:14:21,750 --> 00:14:27,180
much data is generated on network today

342
00:14:24,480 --> 00:14:30,840
and this goes back into the NIC the the

343
00:14:27,180 --> 00:14:32,670
signal versus kind of dilemma of we want

344
00:14:30,840 --> 00:14:34,260
to we want to be getting all of the

345
00:14:32,670 --> 00:14:36,180
alerts we want to be getting all of the

346
00:14:34,260 --> 00:14:38,520
information but we don't want to get

347
00:14:36,180 --> 00:14:40,170
overwhelmed with alert fatigue right we

348
00:14:38,520 --> 00:14:43,860
want to actually be getting a more

349
00:14:40,170 --> 00:14:45,860
signal and and when we consume less we

350
00:14:43,860 --> 00:14:50,010
can distinguish between relevant and

351
00:14:45,860 --> 00:14:51,900
irrelevant information better more

352
00:14:50,010 --> 00:14:54,330
information can be harmful if there's no

353
00:14:51,900 --> 00:14:56,520
reason for it and this is why I've a lot

354
00:14:54,330 --> 00:14:59,100
of sympathy or empathy for incident

355
00:14:56,520 --> 00:15:01,770
responders I think that it must be so

356
00:14:59,100 --> 00:15:04,920
difficult to go through hundreds or

357
00:15:01,770 --> 00:15:07,110
thousands of alerts of things that are

358
00:15:04,920 --> 00:15:09,839
malicious activity and figure out okay

359
00:15:07,110 --> 00:15:11,940
what's really malicious activity because

360
00:15:09,840 --> 00:15:15,630
I know there must be a set like a

361
00:15:11,940 --> 00:15:18,750
subconscious and even a way that they're

362
00:15:15,630 --> 00:15:20,790
thinking about it and I know that I can

363
00:15:18,750 --> 00:15:22,890
exploit that as well right if if I

364
00:15:20,790 --> 00:15:25,260
wanted I want to be doing the most noise

365
00:15:22,890 --> 00:15:28,650
prone alerts because they're the most

366
00:15:25,260 --> 00:15:31,110
likely to overlook those so the way that

367
00:15:28,650 --> 00:15:34,680
we can scale our assumptions are with

368
00:15:31,110 --> 00:15:37,350
groups so we grew people all the time so

369
00:15:34,680 --> 00:15:39,689
you like stereotyping that's bad right

370
00:15:37,350 --> 00:15:41,280
but everyone does it and we need to do

371
00:15:39,690 --> 00:15:44,160
it because we need to be able to group

372
00:15:41,280 --> 00:15:47,069
objects into a certain way to be able to

373
00:15:44,160 --> 00:15:49,469
advance humanity and I mean Syria is a

374
00:15:47,070 --> 00:15:52,380
very negative example to give but

375
00:15:49,470 --> 00:15:55,380
without groups and and without being

376
00:15:52,380 --> 00:15:57,450
able to put people into these different

377
00:15:55,380 --> 00:15:59,580
areas we wouldn't be able to move

378
00:15:57,450 --> 00:16:02,310
forward as quickly like if you're if

379
00:15:59,580 --> 00:16:04,259
you're trying to make a judgment about a

380
00:16:02,310 --> 00:16:05,790
group that's a lot faster than

381
00:16:04,259 --> 00:16:09,419
you know to do it about each individual

382
00:16:05,790 --> 00:16:13,079
person and then in Active Directory we

383
00:16:09,419 --> 00:16:15,269
also use groups funfact and in groups in

384
00:16:13,079 --> 00:16:17,608
Active Directory system and

385
00:16:15,269 --> 00:16:20,129
administrators use them to manage access

386
00:16:17,609 --> 00:16:23,009
controls across massive organizations

387
00:16:20,129 --> 00:16:25,019
without groups and grouping there is no

388
00:16:23,009 --> 00:16:28,739
way that we would actually be able to

389
00:16:25,019 --> 00:16:31,229
leverage or have any insight into all of

390
00:16:28,739 --> 00:16:33,600
the different computer behavior so as a

391
00:16:31,229 --> 00:16:35,129
really quick overview this is very much

392
00:16:33,600 --> 00:16:37,079
oversimplified and we'll dive a lot

393
00:16:35,129 --> 00:16:39,239
deeper but for those of you that aren't

394
00:16:37,079 --> 00:16:42,029
familiar with Active Directory the basic

395
00:16:39,239 --> 00:16:43,589
schema is that we have users that are

396
00:16:42,029 --> 00:16:45,749
members of groups and users have

397
00:16:43,589 --> 00:16:48,539
sessions on computers and computers are

398
00:16:45,749 --> 00:16:50,819
met also members of groups but all of

399
00:16:48,539 --> 00:16:53,339
these are different relationships right

400
00:16:50,819 --> 00:16:56,429
and we have a ton of relationships

401
00:16:53,339 --> 00:16:59,629
within large corporate environments at

402
00:16:56,429 --> 00:17:02,249
my company we will do red teams on

403
00:16:59,629 --> 00:17:04,110
organizations with like fortune 100

404
00:17:02,249 --> 00:17:06,470
companies and if you think about how

405
00:17:04,109 --> 00:17:08,219
many relationships are within those

406
00:17:06,470 --> 00:17:11,850
that's when it starts getting a little

407
00:17:08,220 --> 00:17:13,620
bit dicey and and this quote is one of

408
00:17:11,849 --> 00:17:16,079
my favorite out of books that I've read

409
00:17:13,619 --> 00:17:18,299
because I think it takes the the

410
00:17:16,079 --> 00:17:20,158
problems of Active Directory and it

411
00:17:18,299 --> 00:17:22,769
really I mean it I'll just read the

412
00:17:20,159 --> 00:17:24,360
quote we do not need to be rational and

413
00:17:22,769 --> 00:17:27,510
scientific when it comes to the details

414
00:17:24,359 --> 00:17:30,600
of our daily life only in those that can

415
00:17:27,510 --> 00:17:32,250
harm us and threaten our survival so all

416
00:17:30,600 --> 00:17:34,918
of these relationships and Active

417
00:17:32,250 --> 00:17:36,389
Directory we need them but when they're

418
00:17:34,919 --> 00:17:39,090
harmful we need to be able to identify

419
00:17:36,389 --> 00:17:40,590
them and there are other tops there's

420
00:17:39,090 --> 00:17:42,570
one right after mine about bloodhound

421
00:17:40,590 --> 00:17:45,059
that can that can help show you how to

422
00:17:42,570 --> 00:17:47,519
identify those relationships but just

423
00:17:45,059 --> 00:17:49,889
the knowledge of that and the knowledge

424
00:17:47,519 --> 00:17:51,330
of we need a certain amount of

425
00:17:49,889 --> 00:17:52,979
relationships but the bad ones are

426
00:17:51,330 --> 00:17:54,928
really bad that's what I'm going to be

427
00:17:52,980 --> 00:17:56,370
focusing on today so if you want to

428
00:17:54,929 --> 00:17:58,529
actually start exploiting these

429
00:17:56,370 --> 00:17:59,939
relationships my first advice is to go

430
00:17:58,529 --> 00:18:01,980
to bloodhound the talk that's right

431
00:17:59,940 --> 00:18:03,779
after mine it's in tracked too

432
00:18:01,980 --> 00:18:06,000
so what this does is it reveals the

433
00:18:03,779 --> 00:18:08,039
hidden and often unintended

434
00:18:06,000 --> 00:18:10,309
relationships within an Active Directory

435
00:18:08,039 --> 00:18:14,100
environment in this example right here

436
00:18:10,309 --> 00:18:15,710
it's taking the user I'm gonna mess this

437
00:18:14,100 --> 00:18:19,639
up s man

438
00:18:15,710 --> 00:18:22,309
sir look at internal dot local and it's

439
00:18:19,640 --> 00:18:24,380
trying to find the path to domain admins

440
00:18:22,309 --> 00:18:26,000
right we want to see we want to get a

441
00:18:24,380 --> 00:18:28,340
better understanding of all of the

442
00:18:26,000 --> 00:18:31,039
relationships within Active Directory

443
00:18:28,340 --> 00:18:33,230
to see how do we get from where we are

444
00:18:31,039 --> 00:18:36,770
to where we want to go and what is a

445
00:18:33,230 --> 00:18:39,620
path of least resistance at Specter ups

446
00:18:36,770 --> 00:18:43,100
we've seen companies with more than 55

447
00:18:39,620 --> 00:18:45,860
million abusable relationships to put

448
00:18:43,100 --> 00:18:47,689
that into to try to add context to that

449
00:18:45,860 --> 00:18:50,149
statement I don't think I've ever

450
00:18:47,690 --> 00:18:51,620
counted to a thousand ever I don't think

451
00:18:50,149 --> 00:18:54,678
I've ever counted that high because it

452
00:18:51,620 --> 00:18:56,239
takes a long time 50 mi 55 million I've

453
00:18:54,679 --> 00:18:57,830
definitely never counted to a million

454
00:18:56,240 --> 00:19:01,190
and I know that I've definitely never

455
00:18:57,830 --> 00:19:04,580
counted to 55 million and that amount

456
00:19:01,190 --> 00:19:07,100
it's like it's hard to even comprehend

457
00:19:04,580 --> 00:19:08,960
how many abusable relationships there

458
00:19:07,100 --> 00:19:11,230
are when we when we can't even

459
00:19:08,960 --> 00:19:13,610
contextualize what that number means

460
00:19:11,230 --> 00:19:16,159
right so so all of these different

461
00:19:13,610 --> 00:19:18,020
groups and all of these different

462
00:19:16,159 --> 00:19:19,820
computers and how it's all kind of

463
00:19:18,020 --> 00:19:22,760
intertwined we need to start thinking

464
00:19:19,820 --> 00:19:25,158
about okay when we're creating these

465
00:19:22,760 --> 00:19:27,860
trust relationships what does that mean

466
00:19:25,159 --> 00:19:31,010
right and what trust dependencies exist

467
00:19:27,860 --> 00:19:33,949
for each relationship how is how are

468
00:19:31,010 --> 00:19:37,820
they assessed and the way that I did

469
00:19:33,950 --> 00:19:40,580
that was from Peter koftas 2012 troopers

470
00:19:37,820 --> 00:19:44,840
talk about trust heuristics and and how

471
00:19:40,580 --> 00:19:46,730
Trust can be used to and how basic trust

472
00:19:44,840 --> 00:19:48,408
fundamentals can apply to security

473
00:19:46,730 --> 00:19:50,899
topics so I'm going to be applying this

474
00:19:48,409 --> 00:19:52,880
to Active Directory and Kerberos but as

475
00:19:50,899 --> 00:19:54,678
a basic overview I'll be covering

476
00:19:52,880 --> 00:19:57,080
consensus based trust knowledge based

477
00:19:54,679 --> 00:19:59,659
trust policy based trust control based

478
00:19:57,080 --> 00:20:01,070
trust and not authoritative trust and I

479
00:19:59,659 --> 00:20:02,020
think it's best to just dive right into

480
00:20:01,070 --> 00:20:04,610
it

481
00:20:02,020 --> 00:20:06,408
consensus based trust I trust you

482
00:20:04,610 --> 00:20:09,110
because everybody else seems to trust

483
00:20:06,409 --> 00:20:12,380
you well why do companies use Active

484
00:20:09,110 --> 00:20:14,750
Directory it's known to have problem

485
00:20:12,380 --> 00:20:16,850
it's known to have issues but really

486
00:20:14,750 --> 00:20:19,039
everybody uses Active Directory if I

487
00:20:16,850 --> 00:20:20,719
think about the amount of fortune 500

488
00:20:19,039 --> 00:20:22,520
companies that don't use it Active

489
00:20:20,720 --> 00:20:24,200
Directory I can think of one off the top

490
00:20:22,520 --> 00:20:26,389
of my head I'm sure there's a few others

491
00:20:24,200 --> 00:20:28,220
but people look to their competitors

492
00:20:26,389 --> 00:20:28,809
right and they look to you what is the

493
00:20:28,220 --> 00:20:30,909
industry

494
00:20:28,809 --> 00:20:33,580
and 'red that's consensus-based trust

495
00:20:30,909 --> 00:20:37,240
okay and then for knowledge-based trust

496
00:20:33,580 --> 00:20:39,820
I trust you because I know you and I

497
00:20:37,240 --> 00:20:41,919
trust myself well that's our own

498
00:20:39,820 --> 00:20:44,320
implementations of Active Directory I

499
00:20:41,919 --> 00:20:46,509
think that Active Directory it's pretty

500
00:20:44,320 --> 00:20:49,990
secure there have been a few major

501
00:20:46,509 --> 00:20:51,669
issues that people like Lea Christensen

502
00:20:49,990 --> 00:20:54,610
has come out with and has really

503
00:20:51,669 --> 00:20:57,580
disrupted how Active Directory works and

504
00:20:54,610 --> 00:20:59,860
problems within it but overall it has so

505
00:20:57,580 --> 00:21:02,590
much exposure that it's a pretty good

506
00:20:59,860 --> 00:21:04,539
system the problem is is when you start

507
00:21:02,590 --> 00:21:07,889
changing Active Directory right the

508
00:21:04,539 --> 00:21:07,889
problem is is once you start

509
00:21:12,810 --> 00:21:18,240
making your modifications and that's

510
00:21:15,390 --> 00:21:20,640
really the the trust heuristic of overly

511
00:21:18,240 --> 00:21:22,970
trusting yourself every single Active

512
00:21:20,640 --> 00:21:25,860
Directory environment has its nuances

513
00:21:22,970 --> 00:21:27,990
for policy based trust I trust you

514
00:21:25,860 --> 00:21:30,000
because a policy says I should trust you

515
00:21:27,990 --> 00:21:32,730
what immediately comes to mind is group

516
00:21:30,000 --> 00:21:35,610
policy right and how GPO group policy

517
00:21:32,730 --> 00:21:38,780
objects is implemented the first thing

518
00:21:35,610 --> 00:21:41,429
is just the very simple one of geji geji

519
00:21:38,780 --> 00:21:43,740
GPP password when passwords are just

520
00:21:41,430 --> 00:21:47,430
embedded into group policy and that's an

521
00:21:43,740 --> 00:21:49,230
easy way to easy win right there but but

522
00:21:47,430 --> 00:21:51,330
something I find a lot more interesting

523
00:21:49,230 --> 00:21:53,910
is how group policies actually being

524
00:21:51,330 --> 00:21:56,429
implemented right how is group policy

525
00:21:53,910 --> 00:21:58,680
getting pushed down and and one is group

526
00:21:56,430 --> 00:22:01,250
policy being applied and it's being

527
00:21:58,680 --> 00:22:05,040
applied by the lastin first-out

528
00:22:01,250 --> 00:22:07,320
group policy can do everything right it

529
00:22:05,040 --> 00:22:09,389
can do everything for setting access

530
00:22:07,320 --> 00:22:11,730
controls it can also do everything for

531
00:22:09,390 --> 00:22:13,800
exploiting different controls and the

532
00:22:11,730 --> 00:22:16,680
problem is is everything can't be top of

533
00:22:13,800 --> 00:22:18,659
mind we can't have everything be the

534
00:22:16,680 --> 00:22:20,400
most important piece and that's why we

535
00:22:18,660 --> 00:22:20,700
have different layers of how it's being

536
00:22:20,400 --> 00:22:23,430
done

537
00:22:20,700 --> 00:22:23,910
and for group policy it's lastin

538
00:22:23,430 --> 00:22:25,770
first-out

539
00:22:23,910 --> 00:22:29,400
but it gets really confusing for

540
00:22:25,770 --> 00:22:31,440
auditing I pulled these examples from

541
00:22:29,400 --> 00:22:33,300
Andy Robbins blog there's a reference

542
00:22:31,440 --> 00:22:35,580
down there you can check it out once I

543
00:22:33,300 --> 00:22:39,090
release this but here are different

544
00:22:35,580 --> 00:22:41,879
examples of one group policy can be

545
00:22:39,090 --> 00:22:44,129
abuse right so the first one what it

546
00:22:41,880 --> 00:22:46,290
what an abuse is you can add a new local

547
00:22:44,130 --> 00:22:48,930
admin account for the second one you can

548
00:22:46,290 --> 00:22:51,629
grant a user the right to log on via RT

549
00:22:48,930 --> 00:22:54,030
p SED but i like change SD debug

550
00:22:51,630 --> 00:22:57,180
privilege and all that stuff and there's

551
00:22:54,030 --> 00:22:59,190
a lot of research by other people that

552
00:22:57,180 --> 00:23:01,140
have already been going into this but

553
00:22:59,190 --> 00:23:03,300
what i want to point out is this is

554
00:23:01,140 --> 00:23:05,460
because we are trusting this policy and

555
00:23:03,300 --> 00:23:07,980
should we right should we be always

556
00:23:05,460 --> 00:23:09,990
trusting that policy there are

557
00:23:07,980 --> 00:23:12,390
unintended opportunities and

558
00:23:09,990 --> 00:23:15,330
consequences through trust inheritance

559
00:23:12,390 --> 00:23:16,440
we need trust inheritance because we

560
00:23:15,330 --> 00:23:18,990
would never be able to make a decision

561
00:23:16,440 --> 00:23:20,370
right we wouldn't be able to topple

562
00:23:18,990 --> 00:23:22,110
things on top we wouldn't be able to

563
00:23:20,370 --> 00:23:25,429
learn from each other and be able to

564
00:23:22,110 --> 00:23:28,129
advance security and

565
00:23:25,430 --> 00:23:32,240
as quickly as possible but there are

566
00:23:28,130 --> 00:23:34,850
definitely consequences one of one of

567
00:23:32,240 --> 00:23:37,310
the the kind of consequences is how

568
00:23:34,850 --> 00:23:39,919
Kerberos has been implemented in the

569
00:23:37,310 --> 00:23:42,679
exploitation within that a control based

570
00:23:39,920 --> 00:23:44,630
trust there is a control that enforces

571
00:23:42,680 --> 00:23:47,330
your behavior and I trust this control

572
00:23:44,630 --> 00:23:50,750
what immediately came to mind for me was

573
00:23:47,330 --> 00:23:53,149
a Kerberos protocol do people in this

574
00:23:50,750 --> 00:23:56,810
room trust Kerberos I don't know it's

575
00:23:53,150 --> 00:23:59,960
it's a it's an MIT protocol that came

576
00:23:56,810 --> 00:24:01,879
out in the 1970s and when we think about

577
00:23:59,960 --> 00:24:04,160
all of the different derbycon

578
00:24:01,880 --> 00:24:06,860
talks that about been about Kerberos and

579
00:24:04,160 --> 00:24:08,330
how it can be exploited I'm sure people

580
00:24:06,860 --> 00:24:12,139
will start to question themselves

581
00:24:08,330 --> 00:24:14,840
I made a graphic here about how I think

582
00:24:12,140 --> 00:24:17,360
about the Kerberos trust pipeline so

583
00:24:14,840 --> 00:24:19,550
step one is authentication service sends

584
00:24:17,360 --> 00:24:21,469
a request to a domain controller step

585
00:24:19,550 --> 00:24:24,139
two authentication service gets a reply

586
00:24:21,470 --> 00:24:27,110
from a DC that contains a ticket

587
00:24:24,140 --> 00:24:28,910
granting ticket which is tjt if the

588
00:24:27,110 --> 00:24:32,750
authentication is successful it's

589
00:24:28,910 --> 00:24:36,050
getting encrypted encoded by the by the

590
00:24:32,750 --> 00:24:40,370
krbtgt hash and then step three a TGT

591
00:24:36,050 --> 00:24:43,159
request is sent with the sorry it's it's

592
00:24:40,370 --> 00:24:45,500
sent with the user CGT and then for the

593
00:24:43,160 --> 00:24:47,510
TGS reply okay except for a ticket

594
00:24:45,500 --> 00:24:49,160
granting service ticket is sent

595
00:24:47,510 --> 00:24:50,810
containing a service ticket so that's

596
00:24:49,160 --> 00:24:52,790
moving really fast we will have other

597
00:24:50,810 --> 00:24:55,610
slides about it but that's a very

598
00:24:52,790 --> 00:24:57,740
high-level view so that's the protocol

599
00:24:55,610 --> 00:24:59,959
and if you think about okay well what

600
00:24:57,740 --> 00:25:02,090
dependencies on this protocol could be

601
00:24:59,960 --> 00:25:03,340
exploited I think we can all think of

602
00:25:02,090 --> 00:25:08,179
some right off the top of our head

603
00:25:03,340 --> 00:25:10,610
golden ticket silver ticket over pass

604
00:25:08,180 --> 00:25:13,370
the hash right so then we get into the

605
00:25:10,610 --> 00:25:15,469
authoritative trust yes the authority

606
00:25:13,370 --> 00:25:18,709
said that I can trust you and I trust

607
00:25:15,470 --> 00:25:21,350
this at or I trust this authority PG T's

608
00:25:18,710 --> 00:25:24,260
and service tickets so here's another

609
00:25:21,350 --> 00:25:27,679
diagram pretty similar but here's what's

610
00:25:24,260 --> 00:25:30,440
actually being sent over B and then with

611
00:25:27,680 --> 00:25:32,330
a purpose and why so the user hash is

612
00:25:30,440 --> 00:25:35,150
sent to a domain controller for the

613
00:25:32,330 --> 00:25:38,669
purpose of getting a TGT that D GT is

614
00:25:35,150 --> 00:25:41,910
encoded with a krbtgt hash and then

615
00:25:38,670 --> 00:25:44,280
once the the validated user request

616
00:25:41,910 --> 00:25:46,679
access to a computer or its resource on

617
00:25:44,280 --> 00:25:48,480
the DC will send back a service ticket

618
00:25:46,679 --> 00:25:52,440
that is encoded with a server hash and

619
00:25:48,480 --> 00:25:54,690
then that service ticket is sent with is

620
00:25:52,440 --> 00:25:56,820
sent for authentication right so

621
00:25:54,690 --> 00:25:59,580
breaking down into this trust pipeline

622
00:25:56,820 --> 00:26:01,470
to see what part of the pipeline are we

623
00:25:59,580 --> 00:26:04,290
actually exploiting because to get

624
00:26:01,470 --> 00:26:07,020
actual authentication to a resource like

625
00:26:04,290 --> 00:26:09,120
a file share you need to go through this

626
00:26:07,020 --> 00:26:11,550
entire process and if you can compromise

627
00:26:09,120 --> 00:26:14,610
any part of the pipes that means that

628
00:26:11,550 --> 00:26:18,000
you know what you you've done it you

629
00:26:14,610 --> 00:26:21,510
hacked it congratulations so for over

630
00:26:18,000 --> 00:26:23,130
passed the hash in this diagram what I'm

631
00:26:21,510 --> 00:26:26,100
trying to show is if you can compromise

632
00:26:23,130 --> 00:26:28,380
the user hash you can get a TGT that's

633
00:26:26,100 --> 00:26:31,770
awesome right and there's four different

634
00:26:28,380 --> 00:26:34,020
and overall like encryption types and

635
00:26:31,770 --> 00:26:36,780
and usually you would want to be using

636
00:26:34,020 --> 00:26:41,370
AES 256 since it's the most normal but

637
00:26:36,780 --> 00:26:44,040
often we'll use rc4 and I mean this this

638
00:26:41,370 --> 00:26:46,770
is also called passed the key if you

639
00:26:44,040 --> 00:26:49,020
want to actually go out and do over pass

640
00:26:46,770 --> 00:26:50,790
the hash I'm and kind of use it in your

641
00:26:49,020 --> 00:26:53,190
environment I would highly suggest the

642
00:26:50,790 --> 00:26:55,889
tool Rubeus it was created by well

643
00:26:53,190 --> 00:26:58,470
Schroeder a link that github here I'm

644
00:26:55,890 --> 00:27:01,020
not going to go through how to use Ruby

645
00:26:58,470 --> 00:27:03,600
as for the next two because I think the

646
00:27:01,020 --> 00:27:05,010
documentation online is is much more is

647
00:27:03,600 --> 00:27:07,260
much better than what I could do myself

648
00:27:05,010 --> 00:27:10,010
but this is how you would be taking

649
00:27:07,260 --> 00:27:13,320
advantage of the authoritative trust

650
00:27:10,010 --> 00:27:15,120
assumption in and heuristic in Golden

651
00:27:13,320 --> 00:27:17,790
Tickets what's happening is you're using

652
00:27:15,120 --> 00:27:19,830
the krbtgt to forge ticket granting

653
00:27:17,790 --> 00:27:22,260
ticket right so if you look at step

654
00:27:19,830 --> 00:27:24,480
number two that's being sent over if you

655
00:27:22,260 --> 00:27:26,879
can compromise that and you can get and

656
00:27:24,480 --> 00:27:31,620
you can forge your own TG T's that's

657
00:27:26,880 --> 00:27:33,960
awesome and yeah that's just awesome and

658
00:27:31,620 --> 00:27:36,449
then for silver tickets what's going on

659
00:27:33,960 --> 00:27:39,450
is since the TGT is only protected by

660
00:27:36,450 --> 00:27:42,540
the hash of the Kerberos ticket granting

661
00:27:39,450 --> 00:27:45,090
service krbtgt this hash if this hash is

662
00:27:42,540 --> 00:27:49,139
compromised in any way it can be forged

663
00:27:45,090 --> 00:27:51,240
right oh I'm so sorry I was ok

664
00:27:49,140 --> 00:27:52,050
moving forward the best part about a

665
00:27:51,240 --> 00:27:54,210
silver ticket

666
00:27:52,050 --> 00:27:56,040
is there's no traffic to the domain

667
00:27:54,210 --> 00:27:58,260
controller since it's harder to detect

668
00:27:56,040 --> 00:28:00,629
but it's still we have that

669
00:27:58,260 --> 00:28:04,080
authoritative trust that's being sent

670
00:28:00,630 --> 00:28:06,090
forward and and what I want to really

671
00:28:04,080 --> 00:28:09,990
get across is for all these different

672
00:28:06,090 --> 00:28:12,480
trust domains Trust is contextual right

673
00:28:09,990 --> 00:28:16,230
so you need it you need certain amount

674
00:28:12,480 --> 00:28:17,910
of context about the environment to know

675
00:28:16,230 --> 00:28:20,310
whether you can actually apply these

676
00:28:17,910 --> 00:28:22,740
different things there might be AI there

677
00:28:20,310 --> 00:28:25,050
might be different things that will

678
00:28:22,740 --> 00:28:26,580
hinder your way of being able to exploit

679
00:28:25,050 --> 00:28:29,550
this we need to understand the

680
00:28:26,580 --> 00:28:31,439
environment when we are creating fake

681
00:28:29,550 --> 00:28:33,240
silver and golden tickets we're really

682
00:28:31,440 --> 00:28:35,400
using real tickets and hashes to

683
00:28:33,240 --> 00:28:38,040
authenticate the resources it's all

684
00:28:35,400 --> 00:28:39,930
based on real stuff that we trust but

685
00:28:38,040 --> 00:28:42,330
with that we can do malicious things and

686
00:28:39,930 --> 00:28:44,810
and what I would argue is that with a

687
00:28:42,330 --> 00:28:46,770
very strong narrative we can create that

688
00:28:44,810 --> 00:28:50,040
context right we can create that

689
00:28:46,770 --> 00:28:51,720
contextual environment what narratives

690
00:28:50,040 --> 00:28:54,960
ooh as they get in the way of our

691
00:28:51,720 --> 00:28:57,240
ability to think critically what first

692
00:28:54,960 --> 00:28:59,310
comes to mind for that is the illusory

693
00:28:57,240 --> 00:29:01,230
truth effect right in the illusory truth

694
00:28:59,310 --> 00:29:03,300
effect is when you keep on hearing the

695
00:29:01,230 --> 00:29:06,000
same thing over and over and it changes

696
00:29:03,300 --> 00:29:08,940
your perception of stuff language is

697
00:29:06,000 --> 00:29:11,190
infectious it's like a virus and I like

698
00:29:08,940 --> 00:29:12,780
using the word virus because a virus

699
00:29:11,190 --> 00:29:14,730
goes viral right you can have a

700
00:29:12,780 --> 00:29:16,500
bacterial virus that goes around to all

701
00:29:14,730 --> 00:29:18,600
these different people you can also have

702
00:29:16,500 --> 00:29:20,010
a computer virus that goes around to all

703
00:29:18,600 --> 00:29:22,590
these different computers but it's

704
00:29:20,010 --> 00:29:24,720
something that is pervasive not just in

705
00:29:22,590 --> 00:29:28,199
language but across all the different

706
00:29:24,720 --> 00:29:31,110
domains I'm gonna show a case study here

707
00:29:28,200 --> 00:29:33,510
where the the synopsis was someone was

708
00:29:31,110 --> 00:29:36,899
asking to cut in front of other people

709
00:29:33,510 --> 00:29:38,430
during what there's a long line to make

710
00:29:36,900 --> 00:29:40,230
Xerox copies and someone was trying to

711
00:29:38,430 --> 00:29:42,750
cut in front of other people so in the

712
00:29:40,230 --> 00:29:45,080
first case someone said excuse me I have

713
00:29:42,750 --> 00:29:47,790
five pages may use a Xerox machine and

714
00:29:45,080 --> 00:29:50,070
60% of people let that person cut in

715
00:29:47,790 --> 00:29:52,230
front of them the second case was excuse

716
00:29:50,070 --> 00:29:54,840
me I have five pages may I use a Xerox

717
00:29:52,230 --> 00:29:56,940
machine because I'm in a rush and I want

718
00:29:54,840 --> 00:29:57,810
to add this one added legitimate

719
00:29:56,940 --> 00:29:59,820
justification

720
00:29:57,810 --> 00:30:01,590
ninety four percent of people let that

721
00:29:59,820 --> 00:30:04,409
person cut in front of them and the last

722
00:30:01,590 --> 00:30:05,490
one excuse me I have five pages may I

723
00:30:04,410 --> 00:30:07,230
use a Xerox machine

724
00:30:05,490 --> 00:30:10,080
and because I have some copies to make

725
00:30:07,230 --> 00:30:12,690
this added no justification decided no

726
00:30:10,080 --> 00:30:16,050
argument this decided nothing except for

727
00:30:12,690 --> 00:30:20,280
more words right and and actually 93% of

728
00:30:16,050 --> 00:30:22,050
people said I'm said you know what

729
00:30:20,280 --> 00:30:24,149
that's fine cut in front of me but we

730
00:30:22,050 --> 00:30:26,340
can see that language just adding more

731
00:30:24,150 --> 00:30:30,780
words can shape the way that we think

732
00:30:26,340 --> 00:30:33,449
about reality right our world is created

733
00:30:30,780 --> 00:30:35,490
modified and skewed with words and

734
00:30:33,450 --> 00:30:38,160
that's really important when you think

735
00:30:35,490 --> 00:30:40,740
about how computers take on the biases

736
00:30:38,160 --> 00:30:43,080
of their owners right if computers take

737
00:30:40,740 --> 00:30:45,150
on the biases of their owners then we

738
00:30:43,080 --> 00:30:48,210
can use narrative and context to be

739
00:30:45,150 --> 00:30:50,179
better red teamers so let's kind of go

740
00:30:48,210 --> 00:30:53,580
back to the beginning and think about

741
00:30:50,179 --> 00:30:54,990
Red Team operations ok I started as I

742
00:30:53,580 --> 00:30:56,760
started this presentation

743
00:30:54,990 --> 00:30:59,370
saying that I'm a Red Team operator and

744
00:30:56,760 --> 00:31:00,960
I like my job because I get to take

745
00:30:59,370 --> 00:31:05,760
these high-level concepts and then

746
00:31:00,960 --> 00:31:08,160
really apply them to to my work so so

747
00:31:05,760 --> 00:31:11,250
going through what a day in the life is

748
00:31:08,160 --> 00:31:13,470
as a concealed not Specter ops the first

749
00:31:11,250 --> 00:31:15,990
thing I'm doing during a red team

750
00:31:13,470 --> 00:31:17,820
operation is I'm preparing for initial

751
00:31:15,990 --> 00:31:19,740
access right I don't have any access to

752
00:31:17,820 --> 00:31:23,100
the environment I'm trying to think of

753
00:31:19,740 --> 00:31:25,200
creative ways to to get in and I'm gonna

754
00:31:23,100 --> 00:31:27,809
use examples from physicals and and

755
00:31:25,200 --> 00:31:30,179
phishing campaigns but when I fish users

756
00:31:27,809 --> 00:31:31,020
I need to set up realistic and probable

757
00:31:30,179 --> 00:31:33,360
campaigns

758
00:31:31,020 --> 00:31:35,490
I need a leverage assumptions and

759
00:31:33,360 --> 00:31:37,709
assumptions ask you me it's it's

760
00:31:35,490 --> 00:31:41,130
fantastic to let a user create

761
00:31:37,710 --> 00:31:42,900
rationality behind that so so the

762
00:31:41,130 --> 00:31:45,630
example from the behavioral science that

763
00:31:42,900 --> 00:31:47,370
I want to give it's a pretty famous on

764
00:31:45,630 --> 00:31:49,260
case study called the Linda problem and

765
00:31:47,370 --> 00:31:51,149
if anyone here is named Linda I

766
00:31:49,260 --> 00:31:53,970
apologize my mother's name is named

767
00:31:51,150 --> 00:31:56,910
Linda but it's it's just the name of the

768
00:31:53,970 --> 00:31:59,700
study so Linda is 31 years old single

769
00:31:56,910 --> 00:32:02,040
outspoken and very bright she majored in

770
00:31:59,700 --> 00:32:03,360
philosophy as a student she was deeply

771
00:32:02,040 --> 00:32:06,360
concerned with issues of discrimination

772
00:32:03,360 --> 00:32:08,969
and social justice and also participated

773
00:32:06,360 --> 00:32:10,830
in anti-nuclear demonstrations so ask

774
00:32:08,970 --> 00:32:13,470
yourself what is more likely that

775
00:32:10,830 --> 00:32:15,899
Linda's a bank teller or that Linda's

776
00:32:13,470 --> 00:32:18,870
more Bank is a bank teller and is active

777
00:32:15,900 --> 00:32:19,370
in the feminist heuristic so the correct

778
00:32:18,870 --> 00:32:21,649
answer

779
00:32:19,370 --> 00:32:23,719
is one Lynda's a bank teller because if

780
00:32:21,650 --> 00:32:25,640
Linda was a bank teller and active in

781
00:32:23,720 --> 00:32:28,580
the feminist movement that would be a

782
00:32:25,640 --> 00:32:31,670
broader circle right so this is an

783
00:32:28,580 --> 00:32:33,760
example of the conjunction fallacy aka

784
00:32:31,670 --> 00:32:36,860
the probability of two events occurring

785
00:32:33,760 --> 00:32:38,600
is always going to be less than or equal

786
00:32:36,860 --> 00:32:41,659
to the probability of either one

787
00:32:38,600 --> 00:32:44,449
occurring alone when this when this

788
00:32:41,660 --> 00:32:46,280
study was done 80% of respondents said

789
00:32:44,450 --> 00:32:48,290
the latter said that said the second one

790
00:32:46,280 --> 00:32:50,930
and this is really impactful because the

791
00:32:48,290 --> 00:32:52,610
people in that study were graduate

792
00:32:50,930 --> 00:32:54,260
students at UC Berkeley studying

793
00:32:52,610 --> 00:32:56,659
behavioral science they were they were

794
00:32:54,260 --> 00:33:01,000
regular mom-and-pop mom-and-pop type

795
00:32:56,660 --> 00:33:03,740
people but still everyone shows the more

796
00:33:01,000 --> 00:33:06,140
not the more probable one but the more

797
00:33:03,740 --> 00:33:08,180
plausible option right it makes more

798
00:33:06,140 --> 00:33:10,340
sense for Linda to be in the second

799
00:33:08,180 --> 00:33:12,760
group instead of the first group and and

800
00:33:10,340 --> 00:33:16,340
we have a huge confusion between

801
00:33:12,760 --> 00:33:18,129
plausibility and probability um so then

802
00:33:16,340 --> 00:33:21,590
when we start Oh

803
00:33:18,130 --> 00:33:23,840
so to summarize the representativeness

804
00:33:21,590 --> 00:33:25,899
heuristic I'm kind of full that when

805
00:33:23,840 --> 00:33:28,250
when judging a new event people will pay

806
00:33:25,900 --> 00:33:30,230
more attention to the degree of

807
00:33:28,250 --> 00:33:33,980
similarity to other events than the

808
00:33:30,230 --> 00:33:35,810
actual probability so then when we think

809
00:33:33,980 --> 00:33:38,990
about okay how do I want a better fishy

810
00:33:35,810 --> 00:33:40,310
user we need very plausible fishing

811
00:33:38,990 --> 00:33:42,560
events and we also want really

812
00:33:40,310 --> 00:33:46,190
interesting fishing events you can make

813
00:33:42,560 --> 00:33:47,960
anything interesting and and the way

814
00:33:46,190 --> 00:33:50,360
that you make people but the way that

815
00:33:47,960 --> 00:33:53,780
you avoid kind of getting put into the

816
00:33:50,360 --> 00:33:56,120
people won't click my my link is by

817
00:33:53,780 --> 00:33:58,070
making yourself not a villain and people

818
00:33:56,120 --> 00:34:00,409
have a tendency to manufacture villains

819
00:33:58,070 --> 00:34:02,870
all over the place but when we ask

820
00:34:00,410 --> 00:34:05,150
ourselves who are the villains the

821
00:34:02,870 --> 00:34:07,820
answer is the the villains are people

822
00:34:05,150 --> 00:34:09,620
that are not like us or people that we

823
00:34:07,820 --> 00:34:12,730
know or people that we comprehend the

824
00:34:09,620 --> 00:34:15,620
villains are kind of the others right I

825
00:34:12,730 --> 00:34:17,750
was really surprised I took a trip over

826
00:34:15,620 --> 00:34:20,299
to Tokyo and I'm standing there in the

827
00:34:17,750 --> 00:34:22,370
airport and I kind of have this resting

828
00:34:20,300 --> 00:34:24,260
confused face and I was confused I had

829
00:34:22,370 --> 00:34:25,969
no idea where to go and a group of

830
00:34:24,260 --> 00:34:27,830
British girls came up to me and they

831
00:34:25,969 --> 00:34:29,779
were asking for directions because they

832
00:34:27,830 --> 00:34:31,790
could tell I was also confused a few

833
00:34:29,780 --> 00:34:32,330
minutes later I'm a Japanese man who had

834
00:34:31,790 --> 00:34:33,949
been standing

835
00:34:32,330 --> 00:34:36,170
there the entire time understood English

836
00:34:33,949 --> 00:34:38,439
he came over and told us how to get to

837
00:34:36,170 --> 00:34:42,320
where we need to go it makes zero sense

838
00:34:38,440 --> 00:34:45,139
why the the girls approached me and not

839
00:34:42,320 --> 00:34:46,640
the actual local right because I don't

840
00:34:45,139 --> 00:34:49,429
know what's going on and and when I

841
00:34:46,639 --> 00:34:51,679
travel abroad I find that usually it's

842
00:34:49,429 --> 00:34:53,929
Canadians Australians people from the UK

843
00:34:51,679 --> 00:34:56,259
that are asking for my recommendations

844
00:34:53,929 --> 00:34:58,910
instead of asking for the local rec

845
00:34:56,260 --> 00:35:01,130
recommendations because people are more

846
00:34:58,910 --> 00:35:04,009
trusting of people that they recognise

847
00:35:01,130 --> 00:35:06,860
and that's crazy so then when we start

848
00:35:04,010 --> 00:35:07,940
thinking about who do we want to fish or

849
00:35:06,860 --> 00:35:10,910
how do we want to break into a building

850
00:35:07,940 --> 00:35:15,200
we've got it we got to take who we are

851
00:35:10,910 --> 00:35:17,089
and create that context by by acting

852
00:35:15,200 --> 00:35:20,540
right and finding our inner threat actor

853
00:35:17,090 --> 00:35:23,240
um and and the goal for that is to

854
00:35:20,540 --> 00:35:26,630
create plausibility for things that

855
00:35:23,240 --> 00:35:29,450
might occur right and I I personally

856
00:35:26,630 --> 00:35:32,270
love finding my inner threat actor so

857
00:35:29,450 --> 00:35:34,339
when I think about who I am I need to

858
00:35:32,270 --> 00:35:37,370
think about who do people think I am

859
00:35:34,340 --> 00:35:40,460
there are certain things like my DNA or

860
00:35:37,370 --> 00:35:42,200
my genes that I can't change I'm 24

861
00:35:40,460 --> 00:35:43,940
years old my skin colour is a certain

862
00:35:42,200 --> 00:35:45,560
way my hair is this I guess I could cut

863
00:35:43,940 --> 00:35:47,420
my hair but there's certain

864
00:35:45,560 --> 00:35:49,220
characteristics that I can't get away

865
00:35:47,420 --> 00:35:51,350
from like my ancestral history these are

866
00:35:49,220 --> 00:35:53,270
these are set in stone but things like

867
00:35:51,350 --> 00:35:55,839
genes which I'm not wearing today

868
00:35:53,270 --> 00:36:00,290
because no pants are the best pants

869
00:35:55,840 --> 00:36:02,540
jeans the the clothing I can I can

870
00:36:00,290 --> 00:36:04,940
change right I can create plausibility

871
00:36:02,540 --> 00:36:07,640
based on what I'm wearing so during a

872
00:36:04,940 --> 00:36:09,320
physical test I think I can change my

873
00:36:07,640 --> 00:36:12,620
clothes and have people perceive me

874
00:36:09,320 --> 00:36:14,330
differently and this is tested in ubers

875
00:36:12,620 --> 00:36:17,240
ubers are the best place to test

876
00:36:14,330 --> 00:36:20,120
physical appearances so if I wear jeans

877
00:36:17,240 --> 00:36:21,709
I can look like an intern if I wear just

878
00:36:20,120 --> 00:36:23,359
regular kind of business clothes I can

879
00:36:21,710 --> 00:36:25,100
be an accountant and if I wear high

880
00:36:23,360 --> 00:36:27,320
heels and a dress I can be an attorney

881
00:36:25,100 --> 00:36:28,970
and and the reason why I picked these

882
00:36:27,320 --> 00:36:31,070
roles or these are all roles I've been

883
00:36:28,970 --> 00:36:33,439
in the past right I've been an intern

884
00:36:31,070 --> 00:36:36,260
I've been in accounting and I've been a

885
00:36:33,440 --> 00:36:38,360
GD PR consultant so what I'm trying to

886
00:36:36,260 --> 00:36:39,890
do is I'm trying to fish myself right

887
00:36:38,360 --> 00:36:42,620
I'm trying to I'm trying to fish people

888
00:36:39,890 --> 00:36:44,390
like me because I know I would trust me

889
00:36:42,620 --> 00:36:45,890
right like I think if I was a

890
00:36:44,390 --> 00:36:48,620
trustworthy person

891
00:36:45,890 --> 00:36:50,720
so then I think about who I was and what

892
00:36:48,620 --> 00:36:52,460
if I'm an intern I was doing checklist

893
00:36:50,720 --> 00:36:54,200
all the time of how was your internship

894
00:36:52,460 --> 00:36:56,150
experience I'm sending accountant

895
00:36:54,200 --> 00:36:58,580
spreadsheets accountants love

896
00:36:56,150 --> 00:36:59,690
spreadsheets and macros I can not check

897
00:36:58,580 --> 00:37:02,150
that point across enough

898
00:36:59,690 --> 00:37:04,550
I'm as GPR consultant I remember what

899
00:37:02,150 --> 00:37:06,320
was really impactful when we are dealing

900
00:37:04,550 --> 00:37:09,160
with clients and sending them oh my gosh

901
00:37:06,320 --> 00:37:11,810
you guys you just had this really bad

902
00:37:09,160 --> 00:37:14,240
you have like a lawsuit coming up and

903
00:37:11,810 --> 00:37:16,880
creating these stories based off stuff

904
00:37:14,240 --> 00:37:18,859
that I know is true right I'm fishing

905
00:37:16,880 --> 00:37:21,650
people just like me and I'm taking my

906
00:37:18,860 --> 00:37:25,010
background to go better that so let's

907
00:37:21,650 --> 00:37:26,930
say I get I fish someone I have initial

908
00:37:25,010 --> 00:37:30,380
access and I got a user with limited

909
00:37:26,930 --> 00:37:33,169
privileges so then what can I do well I

910
00:37:30,380 --> 00:37:35,180
don't want to just start running crazy

911
00:37:33,170 --> 00:37:36,530
PowerShell all over the place I want to

912
00:37:35,180 --> 00:37:38,899
get a better idea of what's actually

913
00:37:36,530 --> 00:37:41,420
going on I don't want to be loud

914
00:37:38,900 --> 00:37:43,670
I might browse some file shares and find

915
00:37:41,420 --> 00:37:45,680
out kind of what's on there I might get

916
00:37:43,670 --> 00:37:49,220
access to their email if I'm lucky maybe

917
00:37:45,680 --> 00:37:50,480
I'll set persistence but but really I

918
00:37:49,220 --> 00:37:52,640
what I want them to start thinking about

919
00:37:50,480 --> 00:37:54,710
its prospect theory right I want to

920
00:37:52,640 --> 00:37:57,170
think about the risk that I'm willing to

921
00:37:54,710 --> 00:38:00,080
take to go better this stuff right

922
00:37:57,170 --> 00:38:02,090
because from outside the environment I

923
00:38:00,080 --> 00:38:04,069
have a there's not that much risk

924
00:38:02,090 --> 00:38:06,020
there's I can't get lower than outside

925
00:38:04,070 --> 00:38:07,850
the environment but once I'm inside I'm

926
00:38:06,020 --> 00:38:09,800
starting to get a little bit riskier I

927
00:38:07,850 --> 00:38:11,420
need to think about I could lose access

928
00:38:09,800 --> 00:38:13,460
and I don't want to do that I need to be

929
00:38:11,420 --> 00:38:15,140
a little bit more selphie ER and as the

930
00:38:13,460 --> 00:38:17,240
the project progresses and as time

931
00:38:15,140 --> 00:38:20,029
progresses I need to take prospect

932
00:38:17,240 --> 00:38:23,330
theory and start applying that to my red

933
00:38:20,030 --> 00:38:26,000
team operations of okay I keep on moving

934
00:38:23,330 --> 00:38:27,620
forward I need to get I need to be more

935
00:38:26,000 --> 00:38:31,970
and more cautious because I have more

936
00:38:27,620 --> 00:38:34,609
and more to lose and so humanity tends

937
00:38:31,970 --> 00:38:36,589
to focus unknown variables and we

938
00:38:34,610 --> 00:38:38,630
underestimate the impact of chance and

939
00:38:36,590 --> 00:38:40,100
chaos and environments so when I first

940
00:38:38,630 --> 00:38:41,690
started looking at okay what do I

941
00:38:40,100 --> 00:38:44,420
actually want to exploit what do I

942
00:38:41,690 --> 00:38:47,300
actually want to go after it's I want to

943
00:38:44,420 --> 00:38:49,010
go after things that maybe not everyone

944
00:38:47,300 --> 00:38:51,170
has looked at but I don't want to do is

945
00:38:49,010 --> 00:38:52,910
go look at Microsoft sign tools I don't

946
00:38:51,170 --> 00:38:54,320
want to go look at Microsoft stuff

947
00:38:52,910 --> 00:38:57,410
because those are usually pretty

948
00:38:54,320 --> 00:38:59,660
hardened I want to go target custom is

949
00:38:57,410 --> 00:39:03,080
customization and fragility

950
00:38:59,660 --> 00:39:04,540
in said environments so I'm going back

951
00:39:03,080 --> 00:39:08,240
to seat belt as a way to identify

952
00:39:04,540 --> 00:39:09,350
fragility they created a module where

953
00:39:08,240 --> 00:39:11,240
they're looking for non-standard

954
00:39:09,350 --> 00:39:14,360
Microsoft processes and non-standard

955
00:39:11,240 --> 00:39:16,520
services to find ways that maybe you can

956
00:39:14,360 --> 00:39:18,920
backdoor and executable with the Nspire

957
00:39:16,520 --> 00:39:20,840
or something along those lines right but

958
00:39:18,920 --> 00:39:22,850
we're looking for things that haven't

959
00:39:20,840 --> 00:39:27,710
been looked at by nearly as many people

960
00:39:22,850 --> 00:39:30,290
as these are these services so let's say

961
00:39:27,710 --> 00:39:32,960
from there I'm able to get a valid local

962
00:39:30,290 --> 00:39:33,680
admin credential what what can what

963
00:39:32,960 --> 00:39:35,510
can't I do

964
00:39:33,680 --> 00:39:37,040
um so the first thing I'm going to want

965
00:39:35,510 --> 00:39:38,690
to do is go through the situational

966
00:39:37,040 --> 00:39:39,230
awareness checks again and I want to see

967
00:39:38,690 --> 00:39:41,840
okay

968
00:39:39,230 --> 00:39:43,430
now do I have any more insight because

969
00:39:41,840 --> 00:39:46,430
more information is valuable without

970
00:39:43,430 --> 00:39:48,140
creating too much noise and and maybe I

971
00:39:46,430 --> 00:39:50,180
can go login to other machines and see

972
00:39:48,140 --> 00:39:51,710
what's running there but before I move

973
00:39:50,180 --> 00:39:54,770
forward I need to start understanding

974
00:39:51,710 --> 00:39:59,180
the context of okay what user did I

975
00:39:54,770 --> 00:40:01,190
compromised and I mean at what level so

976
00:39:59,180 --> 00:40:04,520
so going back to the physical example of

977
00:40:01,190 --> 00:40:06,560
as an intern I have low privileges but I

978
00:40:04,520 --> 00:40:09,740
I can do a lot of stuff right I can go

979
00:40:06,560 --> 00:40:11,330
walk up to people I can go ask him hey I

980
00:40:09,740 --> 00:40:14,149
need directions and maybe I'll clone

981
00:40:11,330 --> 00:40:16,130
their badge and but as an attorney I

982
00:40:14,150 --> 00:40:17,240
can't really go around asking for

983
00:40:16,130 --> 00:40:19,670
directions because it doesn't make that

984
00:40:17,240 --> 00:40:21,529
much sense as an attorney I would go and

985
00:40:19,670 --> 00:40:24,200
say hey I need you to plug in this USB

986
00:40:21,530 --> 00:40:26,060
Drive or our company's going to go

987
00:40:24,200 --> 00:40:28,879
bankrupt right it's taking that context

988
00:40:26,060 --> 00:40:31,759
and being able to better apply it and

989
00:40:28,880 --> 00:40:34,910
then for understanding context and

990
00:40:31,760 --> 00:40:37,430
privileges within within processes

991
00:40:34,910 --> 00:40:39,529
there's we have low integrity medium to

992
00:40:37,430 --> 00:40:41,509
integrity and high integrity and this

993
00:40:39,530 --> 00:40:44,480
this is really important for deciding

994
00:40:41,510 --> 00:40:48,590
what we can and what we can't do right

995
00:40:44,480 --> 00:40:51,710
so for for a medium integrity process we

996
00:40:48,590 --> 00:40:52,910
want to we will get a UI approval prompt

997
00:40:51,710 --> 00:40:55,040
and that's something that we don't want

998
00:40:52,910 --> 00:40:57,319
them that we don't want to do we want to

999
00:40:55,040 --> 00:40:59,560
move into a high integrity process by

1000
00:40:57,320 --> 00:41:01,670
doing things like making tokens and

1001
00:40:59,560 --> 00:41:04,670
moving that way so that we can interact

1002
00:41:01,670 --> 00:41:06,920
with alsace and other restricted actions

1003
00:41:04,670 --> 00:41:10,490
but it's still taking that overall

1004
00:41:06,920 --> 00:41:11,870
concept of context and saying okay we

1005
00:41:10,490 --> 00:41:12,680
can see this and we can better

1006
00:41:11,870 --> 00:41:15,078
understand

1007
00:41:12,680 --> 00:41:17,649
and what to go after if we understand

1008
00:41:15,079 --> 00:41:21,559
what context is and what context isn't

1009
00:41:17,650 --> 00:41:23,900
so one one concept that I really enjoy

1010
00:41:21,559 --> 00:41:26,660
is Red Team analytics and it's a point

1011
00:41:23,900 --> 00:41:29,900
it's employing tradecraft that will give

1012
00:41:26,660 --> 00:41:32,240
the best appearance of blending in with

1013
00:41:29,900 --> 00:41:35,990
what you determined to be the most noise

1014
00:41:32,240 --> 00:41:38,359
prone events so noise and bias are

1015
00:41:35,990 --> 00:41:40,640
pretty different people are aware of

1016
00:41:38,359 --> 00:41:42,859
noise but they really under s the impact

1017
00:41:40,640 --> 00:41:45,470
of what it has so there is a study done

1018
00:41:42,859 --> 00:41:46,819
where people think that ten percent of

1019
00:41:45,470 --> 00:41:48,828
the events that they're taking in is

1020
00:41:46,819 --> 00:41:51,170
noise where really it was 50 percent and

1021
00:41:48,829 --> 00:41:54,200
that's crazy so when we're when we are

1022
00:41:51,170 --> 00:41:56,240
trying to go move around a network we

1023
00:41:54,200 --> 00:41:58,129
want to blend in with the noisy because

1024
00:41:56,240 --> 00:42:01,129
system administrators are also under

1025
00:41:58,130 --> 00:42:02,960
estimating the impact that noise has and

1026
00:42:01,130 --> 00:42:04,430
then there's the caveat of if you don't

1027
00:42:02,960 --> 00:42:06,200
want to do stuff that will get you

1028
00:42:04,430 --> 00:42:08,328
caught right you want to you don't want

1029
00:42:06,200 --> 00:42:10,730
to do known malicious noise prone events

1030
00:42:08,329 --> 00:42:14,089
and that's that's just moving along with

1031
00:42:10,730 --> 00:42:15,829
the the constant cycle of the red team

1032
00:42:14,089 --> 00:42:18,230
gets better the blue team gets better

1033
00:42:15,829 --> 00:42:20,420
but finding those noise prone activities

1034
00:42:18,230 --> 00:42:22,730
and kind of living off the land right

1035
00:42:20,420 --> 00:42:24,920
that concept of what are people what are

1036
00:42:22,730 --> 00:42:27,170
people doing every day we want to use

1037
00:42:24,920 --> 00:42:29,539
that in addition to our context right we

1038
00:42:27,170 --> 00:42:31,099
want to improve our context by living

1039
00:42:29,539 --> 00:42:34,970
off the land and following noise

1040
00:42:31,099 --> 00:42:38,720
productivities so I created this slide

1041
00:42:34,970 --> 00:42:41,439
for more to think about how the the

1042
00:42:38,720 --> 00:42:44,750
incident response team is thinking about

1043
00:42:41,440 --> 00:42:46,579
everything so with more experience we

1044
00:42:44,750 --> 00:42:49,400
can better predict outcomes with less

1045
00:42:46,579 --> 00:42:52,069
information and because of that the

1046
00:42:49,400 --> 00:42:53,930
perception of normality and context is

1047
00:42:52,069 --> 00:42:57,049
created through experience in the field

1048
00:42:53,930 --> 00:42:59,390
so if we are trying to tie into those

1049
00:42:57,049 --> 00:43:02,180
noise prone events or we're trying to

1050
00:42:59,390 --> 00:43:04,009
tie into alerts that we know that the

1051
00:43:02,180 --> 00:43:06,078
security operations team is getting all

1052
00:43:04,010 --> 00:43:08,990
the time they're more likely to overlook

1053
00:43:06,079 --> 00:43:12,619
them right my first job I was doing

1054
00:43:08,990 --> 00:43:15,529
level 1 & 2 responding for for a large

1055
00:43:12,619 --> 00:43:18,529
company and at some point one of my

1056
00:43:15,529 --> 00:43:19,760
seniors and our managers told me hey you

1057
00:43:18,529 --> 00:43:22,160
know what you don't have to worry about

1058
00:43:19,760 --> 00:43:23,900
this alert right this alert it's popping

1059
00:43:22,160 --> 00:43:25,730
up every day just don't worry about it

1060
00:43:23,900 --> 00:43:26,599
those are the types of events that I

1061
00:43:25,730 --> 00:43:28,910
want to blend in

1062
00:43:26,599 --> 00:43:30,979
right I want to take advantage of all

1063
00:43:28,910 --> 00:43:33,379
this experience and knowledge that

1064
00:43:30,979 --> 00:43:35,779
incident responders have really have

1065
00:43:33,380 --> 00:43:38,299
surmised over there over there years I

1066
00:43:35,779 --> 00:43:40,869
think that this is also where kind of

1067
00:43:38,299 --> 00:43:43,130
the the perpetual beginners like myself

1068
00:43:40,869 --> 00:43:44,930
really thrive because we don't

1069
00:43:43,130 --> 00:43:46,940
understand what these rules mean we

1070
00:43:44,930 --> 00:43:49,489
don't have the context yet we don't have

1071
00:43:46,940 --> 00:43:51,140
the experience and we're going and we do

1072
00:43:49,489 --> 00:43:54,739
a deeper dive as you what's actually

1073
00:43:51,140 --> 00:43:57,319
going on so at the bottom a new

1074
00:43:54,739 --> 00:43:59,900
experience happens our brain indexes

1075
00:43:57,319 --> 00:44:02,749
that event and now we have it adjusted

1076
00:43:59,900 --> 00:44:05,720
and over confident understanding of the

1077
00:44:02,749 --> 00:44:08,538
world we can only see what we see and

1078
00:44:05,720 --> 00:44:10,640
the real the real impactful Seth is what

1079
00:44:08,539 --> 00:44:14,180
we don't see right is what's not there

1080
00:44:10,640 --> 00:44:17,900
so if you think about this looking for

1081
00:44:14,180 --> 00:44:20,509
antivirus if we see that a certain EDR

1082
00:44:17,900 --> 00:44:23,660
product is there is that as important as

1083
00:44:20,509 --> 00:44:26,180
knowing that no EDR product is there I

1084
00:44:23,660 --> 00:44:29,029
mean you decide there's a lot of ways to

1085
00:44:26,180 --> 00:44:31,940
go about that and then moving forward

1086
00:44:29,029 --> 00:44:33,979
with this overall red team attack path

1087
00:44:31,940 --> 00:44:37,729
now I'm running as a high privilege user

1088
00:44:33,979 --> 00:44:40,308
that's awesome what can I do and that's

1089
00:44:37,729 --> 00:44:43,879
kind of now I can touch Elsa so I'll

1090
00:44:40,309 --> 00:44:45,680
start doing that that that process what

1091
00:44:43,880 --> 00:44:47,539
I used to do was run proc down that was

1092
00:44:45,680 --> 00:44:50,328
like my first success my first red team

1093
00:44:47,539 --> 00:44:52,549
I ran proc dump about 60 times and it

1094
00:44:50,329 --> 00:44:54,829
was awesome it was 2017 and they was not

1095
00:44:52,549 --> 00:44:57,140
getting flagged but now pretty much

1096
00:44:54,829 --> 00:44:59,660
everyone knows it's probably bad

1097
00:44:57,140 --> 00:45:02,328
the sysinternals toolkit questionable it

1098
00:44:59,660 --> 00:45:04,848
could be used or it could be bad but it

1099
00:45:02,329 --> 00:45:06,680
depends on the context so why is proc

1100
00:45:04,849 --> 00:45:08,690
dump bad it's bad because it touches

1101
00:45:06,680 --> 00:45:10,308
else ass and if you look at what

1102
00:45:08,690 --> 00:45:12,440
minicabs is doing and if you look at

1103
00:45:10,309 --> 00:45:14,269
everything under the hood of why things

1104
00:45:12,440 --> 00:45:17,930
are actually bad we get a better

1105
00:45:14,269 --> 00:45:20,660
understanding of ok how can we go take

1106
00:45:17,930 --> 00:45:23,749
this and manipulate it a little bit to

1107
00:45:20,660 --> 00:45:25,399
go do other bad things so if I took

1108
00:45:23,749 --> 00:45:27,288
something like proc dump and for this

1109
00:45:25,400 --> 00:45:29,299
example I just used seatbelt again and

1110
00:45:27,289 --> 00:45:33,890
all I did was change the names right I

1111
00:45:29,299 --> 00:45:35,900
changed it to cinturón just nice my

1112
00:45:33,890 --> 00:45:37,848
great Spanish coming out but just

1113
00:45:35,900 --> 00:45:39,980
obvious getting a little bit if that if

1114
00:45:37,849 --> 00:45:43,520
seat bill gets alerted and this does

1115
00:45:39,980 --> 00:45:45,590
that's bad and what teams on both the

1116
00:45:43,520 --> 00:45:48,259
offensive and the defensive need to do

1117
00:45:45,590 --> 00:45:50,180
is focus on the overall behavior you

1118
00:45:48,260 --> 00:45:52,220
want to focus on the overall context and

1119
00:45:50,180 --> 00:45:54,980
not just the tools and signatures right

1120
00:45:52,220 --> 00:45:56,868
that's how we make for for better for

1121
00:45:54,980 --> 00:45:59,060
better red teamers that's how we make

1122
00:45:56,869 --> 00:46:02,240
better blue teamers we want to focus on

1123
00:45:59,060 --> 00:46:06,230
behavior and context and not just the

1124
00:46:02,240 --> 00:46:08,509
the hard indicators so let's say part 5

1125
00:46:06,230 --> 00:46:11,600
I compromise the credentials of a domain

1126
00:46:08,510 --> 00:46:13,070
admin what can't I do this is something

1127
00:46:11,600 --> 00:46:15,290
that I've done on an on and off when I

1128
00:46:13,070 --> 00:46:17,300
was very tired not a great not a great

1129
00:46:15,290 --> 00:46:18,800
career moment but I started browsing

1130
00:46:17,300 --> 00:46:21,260
some file shares I was just thinking oh

1131
00:46:18,800 --> 00:46:23,359
whatever I'm an of course that gets

1132
00:46:21,260 --> 00:46:25,220
caught because domain admins don't

1133
00:46:23,359 --> 00:46:27,590
browse file shares right especially in

1134
00:46:25,220 --> 00:46:31,580
like as a high privilege user they're

1135
00:46:27,590 --> 00:46:33,260
like they're like the c-level executive

1136
00:46:31,580 --> 00:46:35,480
going around and asking for directions

1137
00:46:33,260 --> 00:46:38,750
around a building that doesn't make any

1138
00:46:35,480 --> 00:46:40,790
sense right there they're the most

1139
00:46:38,750 --> 00:46:43,760
watched users and we need to take that

1140
00:46:40,790 --> 00:46:45,590
context and apply that to ok maybe this

1141
00:46:43,760 --> 00:46:47,690
was this would work if I was running in

1142
00:46:45,590 --> 00:46:50,380
a medium integrity or a low integrity

1143
00:46:47,690 --> 00:46:54,619
process but definitely not a high one

1144
00:46:50,380 --> 00:46:56,869
and and to to kind of summarize this

1145
00:46:54,619 --> 00:46:59,090
entire presentation because I know we've

1146
00:46:56,869 --> 00:47:00,320
gone through a lot of different topics

1147
00:46:59,090 --> 00:47:02,720
and we've moved them through them very

1148
00:47:00,320 --> 00:47:05,000
quickly what I really want to get across

1149
00:47:02,720 --> 00:47:07,609
to you is that computers take on the

1150
00:47:05,000 --> 00:47:09,890
biases of of their owners right and and

1151
00:47:07,609 --> 00:47:12,500
I want you to question what does that

1152
00:47:09,890 --> 00:47:14,660
mean for security and that we can learn

1153
00:47:12,500 --> 00:47:17,210
from other fields like behavioral

1154
00:47:14,660 --> 00:47:19,220
science and and even not just behavioral

1155
00:47:17,210 --> 00:47:21,800
science that's just my interest whatever

1156
00:47:19,220 --> 00:47:24,319
your interests are go out and see what

1157
00:47:21,800 --> 00:47:25,820
you can apply to information security

1158
00:47:24,320 --> 00:47:27,830
and see if you can go learn something

1159
00:47:25,820 --> 00:47:31,160
from that right because certain themes

1160
00:47:27,830 --> 00:47:32,840
are pervasive across domains and the

1161
00:47:31,160 --> 00:47:35,089
security industry is really good at

1162
00:47:32,840 --> 00:47:38,030
identifying patterns but identifying

1163
00:47:35,090 --> 00:47:39,590
patterns can lead to overconfidence

1164
00:47:38,030 --> 00:47:42,200
right if you see a pond you're like ok

1165
00:47:39,590 --> 00:47:44,000
this is a pattern and now we're only

1166
00:47:42,200 --> 00:47:46,430
going to go look for this you leave

1167
00:47:44,000 --> 00:47:49,490
yourself open to vulnerability so

1168
00:47:46,430 --> 00:47:51,200
instead I hope that you all encouraged

1169
00:47:49,490 --> 00:47:53,479
skepticism and the way that you're

1170
00:47:51,200 --> 00:47:54,290
currently doing things right I'm instead

1171
00:47:53,480 --> 00:47:56,750
of just using

1172
00:47:54,290 --> 00:48:00,110
to go to go out and execute and go out

1173
00:47:56,750 --> 00:48:02,540
and and and do that be ask yourself why

1174
00:48:00,110 --> 00:48:06,650
right likewise is actually happening why

1175
00:48:02,540 --> 00:48:08,960
is this making sense because because

1176
00:48:06,650 --> 00:48:12,290
being skeptical is is a way to advance

1177
00:48:08,960 --> 00:48:14,780
your career and also it's a way to move

1178
00:48:12,290 --> 00:48:16,790
things forward also encouraging the

1179
00:48:14,780 --> 00:48:18,590
learning mindset of even people that

1180
00:48:16,790 --> 00:48:20,480
have been in this field for 20 years

1181
00:48:18,590 --> 00:48:23,690
have things to learn from the noobs

1182
00:48:20,480 --> 00:48:26,600
and it's it's constantly trying to get

1183
00:48:23,690 --> 00:48:29,150
better the same way that cognitive

1184
00:48:26,600 --> 00:48:31,069
kindness and ways to make decisions

1185
00:48:29,150 --> 00:48:33,560
really easy for ourselves can also be

1186
00:48:31,070 --> 00:48:36,710
computational kindness right and ways to

1187
00:48:33,560 --> 00:48:38,299
make decisions easier for an incident

1188
00:48:36,710 --> 00:48:40,880
response team or a red team right

1189
00:48:38,300 --> 00:48:43,160
leveraging tools like seatbelt and then

1190
00:48:40,880 --> 00:48:45,830
we should be aware of overconfidence and

1191
00:48:43,160 --> 00:48:48,140
also simplification right things are

1192
00:48:45,830 --> 00:48:50,779
complex things are difficult things are

1193
00:48:48,140 --> 00:48:52,670
hard if we oversimplify them we're going

1194
00:48:50,780 --> 00:48:54,770
to become overconfident in them that's

1195
00:48:52,670 --> 00:48:57,620
why I think be an expert gets in the way

1196
00:48:54,770 --> 00:48:58,880
of our Drive of our way to really seek

1197
00:48:57,620 --> 00:49:01,040
out the truth

1198
00:48:58,880 --> 00:49:03,290
we can't afford to rely on fragile

1199
00:49:01,040 --> 00:49:05,300
perspectives like setting ceilings and

1200
00:49:03,290 --> 00:49:07,490
rational thinking we really need to

1201
00:49:05,300 --> 00:49:11,240
think about okay what's actually going

1202
00:49:07,490 --> 00:49:13,250
on security is hard also we should be

1203
00:49:11,240 --> 00:49:15,890
aware of narratives especially personal

1204
00:49:13,250 --> 00:49:17,750
narratives a little backwards personal

1205
00:49:15,890 --> 00:49:20,029
narratives because we are a lot more

1206
00:49:17,750 --> 00:49:22,040
than who we define ourselves as right

1207
00:49:20,030 --> 00:49:23,720
like if I'm if I think about how I break

1208
00:49:22,040 --> 00:49:25,730
into a building and looking at how other

1209
00:49:23,720 --> 00:49:28,100
people perceive me I also need to look

1210
00:49:25,730 --> 00:49:30,350
at how I perceive me and break down that

1211
00:49:28,100 --> 00:49:34,220
narrative and really push myself forward

1212
00:49:30,350 --> 00:49:35,870
in my research and also the way that I

1213
00:49:34,220 --> 00:49:37,069
interact with people and I think the

1214
00:49:35,870 --> 00:49:40,100
most important one is be aware of

1215
00:49:37,070 --> 00:49:43,280
metaphors metaphors are behavioral

1216
00:49:40,100 --> 00:49:45,460
shortcuts metaphors and analogies are

1217
00:49:43,280 --> 00:49:48,110
ways to simplify things and

1218
00:49:45,460 --> 00:49:50,000
oversimplification is bad right so when

1219
00:49:48,110 --> 00:49:51,830
were using metaphors what we're doing is

1220
00:49:50,000 --> 00:49:55,850
creating mental shortcuts and we're just

1221
00:49:51,830 --> 00:49:57,770
simplifying Security's complex and and

1222
00:49:55,850 --> 00:50:00,920
we should always try to encourage

1223
00:49:57,770 --> 00:50:06,590
rational thinking I don't know if I have

1224
00:50:00,920 --> 00:50:09,710
time for for questions but oh I don't so

1225
00:50:06,590 --> 00:50:11,120
so if you have any if you have any

1226
00:50:09,710 --> 00:50:15,170
questions feel free to reach out to me

1227
00:50:11,120 --> 00:50:16,370
after yeah my contact informations there

1228
00:50:15,170 --> 00:50:17,790
and I'll be around the conference but

1229
00:50:16,370 --> 00:50:20,650
thank you very much for attending

1230
00:50:17,790 --> 00:50:20,650
[Applause]

