1
00:00:00,030 --> 00:00:06,060
so we're gonna get started Oh derbycon

2
00:00:04,130 --> 00:00:11,910
tell me this isn't the best conference

3
00:00:06,060 --> 00:00:13,110
in the world yeah by the I the absolute

4
00:00:11,910 --> 00:00:17,520
privilege of giving my very first

5
00:00:13,110 --> 00:00:18,779
InfoSec talk at Derby con 4 and it is my

6
00:00:17,520 --> 00:00:20,759
absolute pleasure to be here before in

7
00:00:18,779 --> 00:00:24,080
my own review before you but you all are

8
00:00:20,760 --> 00:00:27,210
here for a naked look at my methodology

9
00:00:24,080 --> 00:00:30,869
so Who am I and why do you care just

10
00:00:27,210 --> 00:00:34,350
really briefly my name is Jason lang I

11
00:00:30,869 --> 00:00:36,780
am a proud trust asset consultant I get

12
00:00:34,350 --> 00:00:38,760
to do fun things like like red teaming

13
00:00:36,780 --> 00:00:40,559
and all kinds of function in against my

14
00:00:38,760 --> 00:00:42,089
clients networks it's all authorized of

15
00:00:40,559 --> 00:00:44,309
course they they sign the statement of

16
00:00:42,090 --> 00:00:45,360
work but you find me on Twitter my

17
00:00:44,309 --> 00:00:46,680
hobbies absolutely nothing to do with

18
00:00:45,360 --> 00:00:49,019
information security because I got

19
00:00:46,680 --> 00:00:51,300
unplug just like everyone else so let's

20
00:00:49,020 --> 00:00:53,129
talk about what this talk is about what

21
00:00:51,300 --> 00:00:55,890
this talk is not about first of all I

22
00:00:53,129 --> 00:00:58,019
want to give you an unrestricted look at

23
00:00:55,890 --> 00:00:59,550
one red teamers consultants methodology

24
00:00:58,020 --> 00:01:01,320
again I'm a consultant this is important

25
00:00:59,550 --> 00:01:03,930
understand and the reason why I'm

26
00:01:01,320 --> 00:01:05,220
putting this out there is because red

27
00:01:03,930 --> 00:01:07,200
teaming in the consultant world

28
00:01:05,220 --> 00:01:08,850
differs from red teaming in the internal

29
00:01:07,200 --> 00:01:10,080
world and so if you're an internal red

30
00:01:08,850 --> 00:01:11,220
teamer I need you to understand that

31
00:01:10,080 --> 00:01:13,470
your mileage is gonna vary a little bit

32
00:01:11,220 --> 00:01:14,970
on this okay you know I'm gonna do my

33
00:01:13,470 --> 00:01:17,640
best to make it as applicable as I can

34
00:01:14,970 --> 00:01:23,070
however understand that you're getting

35
00:01:17,640 --> 00:01:25,740
this from the perspective of somebody

36
00:01:23,070 --> 00:01:27,600
who has to operate on say and from a red

37
00:01:25,740 --> 00:01:29,729
team your perspective save six to a

38
00:01:27,600 --> 00:01:31,229
tweet okay as opposed to an internal red

39
00:01:29,729 --> 00:01:32,548
teamer your operations can go a lot

40
00:01:31,229 --> 00:01:34,350
longer alright unfortunately I don't

41
00:01:32,549 --> 00:01:36,869
have that luxury to be fantastic but it

42
00:01:34,350 --> 00:01:39,539
is what it is okay to foster learning by

43
00:01:36,869 --> 00:01:41,040
example and failure as well as to drop

44
00:01:39,540 --> 00:01:42,659
some some handy stuff these stuff that I

45
00:01:41,040 --> 00:01:44,610
think is handy but it's important to

46
00:01:42,659 --> 00:01:45,659
understand the perspective that this

47
00:01:44,610 --> 00:01:47,009
talk is coming from it I'm just gonna

48
00:01:45,659 --> 00:01:49,560
give you just a little bit of high-level

49
00:01:47,009 --> 00:01:51,090
context in terms of red teaming in terms

50
00:01:49,560 --> 00:01:51,990
of target maturity when I say rate team

51
00:01:51,090 --> 00:01:53,009
I'm not talking about a pen test

52
00:01:51,990 --> 00:01:55,559
mouthing about a vulnerability

53
00:01:53,009 --> 00:01:57,990
assessment I'm talking generally right

54
00:01:55,560 --> 00:02:00,149
about here okay so when we talk about a

55
00:01:57,990 --> 00:02:02,610
red team I am making a few assumptions

56
00:02:00,149 --> 00:02:04,259
about my my target a few assumptions

57
00:02:02,610 --> 00:02:05,939
about my client and some of those

58
00:02:04,259 --> 00:02:07,380
assumptions might be for example that

59
00:02:05,939 --> 00:02:09,989
you already have centralized logging if

60
00:02:07,380 --> 00:02:11,549
you don't have a a sim and you're just

61
00:02:09,989 --> 00:02:12,500
kind of you know oh yeah we want a

62
00:02:11,550 --> 00:02:14,420
routine because

63
00:02:12,500 --> 00:02:16,400
Max's Red Team and it's all sexy now

64
00:02:14,420 --> 00:02:17,720
hold on let's actually talk about what

65
00:02:16,400 --> 00:02:19,040
you have going what you don't have going

66
00:02:17,720 --> 00:02:20,510
in your network and then we'll see if

67
00:02:19,040 --> 00:02:22,579
your if you're in the right position for

68
00:02:20,510 --> 00:02:23,840
red team and the reason why we do that

69
00:02:22,580 --> 00:02:24,350
is because we don't want you to waste

70
00:02:23,840 --> 00:02:26,270
your money

71
00:02:24,350 --> 00:02:27,799
hybrid teams can be costly all right in

72
00:02:26,270 --> 00:02:30,140
fact they are costly Who am I kidding so

73
00:02:27,800 --> 00:02:31,760
I I do not want you to be wasting your

74
00:02:30,140 --> 00:02:32,989
money unnecessarily if you're not ready

75
00:02:31,760 --> 00:02:34,820
for that kind of engagement because the

76
00:02:32,990 --> 00:02:36,890
worst feeling for me as a consultant is

77
00:02:34,820 --> 00:02:38,329
to go into your network there's all

78
00:02:36,890 --> 00:02:39,529
kinds of vulnerabilities we get da in

79
00:02:38,330 --> 00:02:41,750
the first day and it's six week

80
00:02:39,530 --> 00:02:43,340
engagement we're just like that's not

81
00:02:41,750 --> 00:02:45,110
the best use of your time or your money

82
00:02:43,340 --> 00:02:47,150
okay so we're making certain assumptions

83
00:02:45,110 --> 00:02:48,800
here but in terms of the difference

84
00:02:47,150 --> 00:02:50,420
between penetration testing red team and

85
00:02:48,800 --> 00:02:52,640
things like that there is a key

86
00:02:50,420 --> 00:02:55,309
difference and the key difference is the

87
00:02:52,640 --> 00:02:56,929
ability to slow down and I need to state

88
00:02:55,310 --> 00:02:58,760
that a little more emphatically because

89
00:02:56,930 --> 00:03:00,590
this was a difficult lesson for me to

90
00:02:58,760 --> 00:03:02,359
learn I came from the pen testing world

91
00:03:00,590 --> 00:03:05,209
I I mean first of all how many red

92
00:03:02,360 --> 00:03:07,370
teamers here it's yours but there's like

93
00:03:05,209 --> 00:03:15,709
20% of you how many of you blue teamers

94
00:03:07,370 --> 00:03:17,660
get out okay so I I came from a

95
00:03:15,709 --> 00:03:19,489
penetration testing role all right where

96
00:03:17,660 --> 00:03:21,019
a pen test was a week long you could

97
00:03:19,489 --> 00:03:22,430
send three phishing campaigns in that

98
00:03:21,019 --> 00:03:23,660
week and still get to Maine mmm by the

99
00:03:22,430 --> 00:03:26,120
end of the week and those days are long

100
00:03:23,660 --> 00:03:28,040
long gone all right so now in a Red Team

101
00:03:26,120 --> 00:03:29,630
now it's like command paralysis where

102
00:03:28,040 --> 00:03:30,380
I'm afraid to type anything because I'm

103
00:03:29,630 --> 00:03:32,510
gonna get caught

104
00:03:30,380 --> 00:03:35,660
all right so the the point of this of

105
00:03:32,510 --> 00:03:37,040
this talk is to well give you some

106
00:03:35,660 --> 00:03:38,600
perspectives and some insights and

107
00:03:37,040 --> 00:03:39,709
stories about failure and some successes

108
00:03:38,600 --> 00:03:42,170
some things that you can use in your

109
00:03:39,709 --> 00:03:43,970
network but why why this talk for those

110
00:03:42,170 --> 00:03:45,170
of you to raise your hand and you're

111
00:03:43,970 --> 00:03:48,250
like yeah I'm already a red team or you

112
00:03:45,170 --> 00:03:50,929
know why am I here why why you care uh

113
00:03:48,250 --> 00:03:52,640
let me put you this way some of the the

114
00:03:50,930 --> 00:03:55,130
best talks that I attend and the most

115
00:03:52,640 --> 00:03:57,890
valuable talks to me are the ones where

116
00:03:55,130 --> 00:03:59,480
I go and and I'm not I'm not expecting

117
00:03:57,890 --> 00:04:00,920
to have you know that just his grand

118
00:03:59,480 --> 00:04:04,190
unveiling of knowledge what I'm

119
00:04:00,920 --> 00:04:05,869
expecting is to pick up about 10 to 20

120
00:04:04,190 --> 00:04:07,070
percent new knowledge all right if

121
00:04:05,870 --> 00:04:08,989
you're a red team and you've been doing

122
00:04:07,070 --> 00:04:09,950
this for a while chances are the vast

123
00:04:08,989 --> 00:04:12,290
majority of what you're gonna see in

124
00:04:09,950 --> 00:04:13,790
this deck you already know okay there's

125
00:04:12,290 --> 00:04:15,500
a guy I was talking to OD Lee he was

126
00:04:13,790 --> 00:04:18,469
hoping this talk was about assembly I'm

127
00:04:15,500 --> 00:04:19,728
sorry man it's not okay but that's like

128
00:04:18,470 --> 00:04:24,050
I don't know next door or something but

129
00:04:19,728 --> 00:04:25,039
if that is is where you're at I want to

130
00:04:24,050 --> 00:04:26,450
give you a little bit of hope because

131
00:04:25,039 --> 00:04:27,650
the the point of this talk is

132
00:04:26,450 --> 00:04:28,969
to maybe steer you in a slightly

133
00:04:27,650 --> 00:04:30,380
different direct in slightly different

134
00:04:28,970 --> 00:04:32,060
direction or maybe change how you think

135
00:04:30,380 --> 00:04:34,640
just a little bit about red teaming and

136
00:04:32,060 --> 00:04:36,380
give you an additional 5% an additional

137
00:04:34,640 --> 00:04:37,729
10% on top of your methodology that

138
00:04:36,380 --> 00:04:40,340
might make you a better red teamer

139
00:04:37,730 --> 00:04:42,620
that's the whole focus of this okay all

140
00:04:40,340 --> 00:04:43,820
right so what's the agenda and it was

141
00:04:42,620 --> 00:04:45,650
about well I'm gonna break this down

142
00:04:43,820 --> 00:04:47,180
very much like I would break down a

143
00:04:45,650 --> 00:04:48,440
standard red team engagement we're going

144
00:04:47,180 --> 00:04:50,030
to talk about what happens before the

145
00:04:48,440 --> 00:04:52,670
engagement the external portion the

146
00:04:50,030 --> 00:04:54,710
internal portion the social engineering

147
00:04:52,670 --> 00:04:55,880
and then finally the reporting looks a

148
00:04:54,710 --> 00:04:57,799
lot like a pen test but I'm gonna break

149
00:04:55,880 --> 00:04:59,540
it down from a red teaming standpoint by

150
00:04:57,800 --> 00:05:00,290
the way these are not my animations just

151
00:04:59,540 --> 00:05:02,780
FYI

152
00:05:00,290 --> 00:05:04,280
all right so every section that we're

153
00:05:02,780 --> 00:05:07,010
gonna talk about I'm going to include

154
00:05:04,280 --> 00:05:08,479
core principles whether it's the pre

155
00:05:07,010 --> 00:05:09,920
engagement whether it's the reporting

156
00:05:08,480 --> 00:05:11,990
I'm going to give you red team core

157
00:05:09,920 --> 00:05:13,580
principles this is not just a tools talk

158
00:05:11,990 --> 00:05:15,050
okay and one of the worst things I could

159
00:05:13,580 --> 00:05:16,520
do for you is just to drop a bunch of

160
00:05:15,050 --> 00:05:17,870
tools and then turn you loose that

161
00:05:16,520 --> 00:05:19,849
doesn't help anyone it doesn't help your

162
00:05:17,870 --> 00:05:22,100
clients alright so from from the

163
00:05:19,850 --> 00:05:23,660
standpoint of methodology one of the

164
00:05:22,100 --> 00:05:25,340
best things that I can do is give you

165
00:05:23,660 --> 00:05:27,380
sound principles or at least what I

166
00:05:25,340 --> 00:05:28,669
think are my sound principles you might

167
00:05:27,380 --> 00:05:30,230
look at me and be like you're all wrong

168
00:05:28,670 --> 00:05:32,740
and that's fine you're entitled your

169
00:05:30,230 --> 00:05:35,840
opinion and I have the microphone so

170
00:05:32,740 --> 00:05:37,370
number one adversary simulation not

171
00:05:35,840 --> 00:05:38,900
necessarily emulation what's the

172
00:05:37,370 --> 00:05:40,700
difference when I go into a target

173
00:05:38,900 --> 00:05:42,109
Network I'm simulating an adversary

174
00:05:40,700 --> 00:05:44,060
which means generally speaking I can

175
00:05:42,110 --> 00:05:47,990
choose the path adversary emulation

176
00:05:44,060 --> 00:05:50,480
means I'm emulating a PT X X okay and

177
00:05:47,990 --> 00:05:53,000
that's generally not in at least not in

178
00:05:50,480 --> 00:05:55,760
my opinion the best value because if I

179
00:05:53,000 --> 00:05:57,890
can simulate an adversary I can tailor

180
00:05:55,760 --> 00:05:59,420
the attacks based on the vertical I can

181
00:05:57,890 --> 00:06:00,710
tailor the attacks based on the client I

182
00:05:59,420 --> 00:06:02,450
can tailor the attacks based on their

183
00:06:00,710 --> 00:06:04,520
maturity I can do those things instead

184
00:06:02,450 --> 00:06:08,030
of being kind of locked in to this box

185
00:06:04,520 --> 00:06:11,479
of a specific adversary number two the

186
00:06:08,030 --> 00:06:15,559
goal is data trophy systems not domain

187
00:06:11,480 --> 00:06:18,020
admin it if the goal is domain admin it

188
00:06:15,560 --> 00:06:19,790
shouldn't be and if I ever go for domain

189
00:06:18,020 --> 00:06:21,530
admin on a red team it is only as a

190
00:06:19,790 --> 00:06:23,210
stepping stone to get where I need to be

191
00:06:21,530 --> 00:06:24,950
all right one of the things I always

192
00:06:23,210 --> 00:06:26,630
asked her in the kickoff is give me a

193
00:06:24,950 --> 00:06:28,789
system give me an application give me

194
00:06:26,630 --> 00:06:30,140
some piece of data that means something

195
00:06:28,790 --> 00:06:31,820
to you and would put you in the news if

196
00:06:30,140 --> 00:06:33,140
it walked out the door and that changes

197
00:06:31,820 --> 00:06:36,099
things nobody ever says domain admin to

198
00:06:33,140 --> 00:06:38,599
that ever okay so that that is the goal

199
00:06:36,100 --> 00:06:40,340
emphasizing stealth over speed there are

200
00:06:38,600 --> 00:06:42,290
certain tools that I do not use on

201
00:06:40,340 --> 00:06:43,820
team any longer it's not their bad tools

202
00:06:42,290 --> 00:06:45,830
and I do call out certain tools in this

203
00:06:43,820 --> 00:06:47,780
talk it's not they're bad it's just that

204
00:06:45,830 --> 00:06:49,609
for the purpose of a red team it's a

205
00:06:47,780 --> 00:06:51,020
it's it's not the best fit maybe they're

206
00:06:49,610 --> 00:06:52,250
a little too fast maybe they're a little

207
00:06:51,020 --> 00:06:55,580
too well-known maybe there's too many

208
00:06:52,250 --> 00:06:57,889
signatures etc speed is not the emphasis

209
00:06:55,580 --> 00:06:59,870
stealth usually is the emphasis all

210
00:06:57,889 --> 00:07:01,520
right active defense I do encourage it

211
00:06:59,870 --> 00:07:04,880
so for example if I'm gonna send a fish

212
00:07:01,520 --> 00:07:06,799
I want to see the actual response of my

213
00:07:04,880 --> 00:07:08,419
client all right and I will encourage it

214
00:07:06,800 --> 00:07:09,680
to a point in other words if there's

215
00:07:08,419 --> 00:07:11,479
like all right you're coming from trust

216
00:07:09,680 --> 00:07:13,310
sex IPS we're gonna block everything and

217
00:07:11,479 --> 00:07:15,500
if they ask me for a status update I'm

218
00:07:13,310 --> 00:07:16,729
like all right I I got in my connection

219
00:07:15,500 --> 00:07:18,979
is coming from here and they just shut

220
00:07:16,729 --> 00:07:22,039
everything down okay hold on wait we do

221
00:07:18,979 --> 00:07:24,169
need to suspend realism to a certain

222
00:07:22,040 --> 00:07:26,000
degree because I only have so much time

223
00:07:24,169 --> 00:07:28,219
here all right so you kind of have to

224
00:07:26,000 --> 00:07:29,889
bear with me in that in that part the

225
00:07:28,220 --> 00:07:35,389
scope should be as open as possible

226
00:07:29,889 --> 00:07:38,240
including physical you know maybe it

227
00:07:35,389 --> 00:07:39,949
should be cuz it works really well okay

228
00:07:38,240 --> 00:07:41,870
cuz lots of people get in with physical

229
00:07:39,949 --> 00:07:43,100
it works alright and this is red team

230
00:07:41,870 --> 00:07:44,450
not black team we're not gonna we're not

231
00:07:43,100 --> 00:07:46,850
gonna kidnap you so I mean we're just

232
00:07:44,450 --> 00:07:48,020
talking about you know we're just

233
00:07:46,850 --> 00:07:49,700
talking about getting a device in the

234
00:07:48,020 --> 00:07:51,620
network this is it's not a big deal okay

235
00:07:49,700 --> 00:07:53,240
so you know let's expand the horizons a

236
00:07:51,620 --> 00:07:54,860
little bit it's gonna be fine and then

237
00:07:53,240 --> 00:07:57,889
last there should always be a tip your

238
00:07:54,860 --> 00:08:00,020
hand moment and and sometimes I'll ask

239
00:07:57,889 --> 00:08:01,639
my clients hey is it okay I got

240
00:08:00,020 --> 00:08:03,200
persistent access I achieved trophies

241
00:08:01,639 --> 00:08:05,690
one and two is it okay if I start making

242
00:08:03,200 --> 00:08:06,950
some noise no we we don't want to make

243
00:08:05,690 --> 00:08:08,900
any noise well why not

244
00:08:06,950 --> 00:08:11,659
well because I'm on the Audit Committee

245
00:08:08,900 --> 00:08:14,900
and the InfoSec committee doesn't know

246
00:08:11,660 --> 00:08:16,820
that we're doing this then like okay um

247
00:08:14,900 --> 00:08:18,710
it would be better if we did because

248
00:08:16,820 --> 00:08:19,880
that way they you know I could kind of

249
00:08:18,710 --> 00:08:21,109
coach them through some of the incident

250
00:08:19,880 --> 00:08:22,580
response we could take a look at that I

251
00:08:21,110 --> 00:08:24,770
could report on it'd be better for you

252
00:08:22,580 --> 00:08:26,659
as an auditor but anyways there should

253
00:08:24,770 --> 00:08:29,419
always be a moment in the red team where

254
00:08:26,660 --> 00:08:31,610
the I lay the hand down everyone sees

255
00:08:29,419 --> 00:08:34,309
what's going on we deconstruct the

256
00:08:31,610 --> 00:08:36,529
entire path and then put together solid

257
00:08:34,309 --> 00:08:39,949
defenses based on that all right so

258
00:08:36,529 --> 00:08:42,650
before the engagement even starts core

259
00:08:39,950 --> 00:08:44,600
principles on on the pre engagement

260
00:08:42,650 --> 00:08:47,000
cycle I steer the clients towards open

261
00:08:44,600 --> 00:08:48,680
of a scope as possible which I talked

262
00:08:47,000 --> 00:08:52,070
about clearly defined what can be done

263
00:08:48,680 --> 00:08:53,630
versus what will be done nod your head

264
00:08:52,070 --> 00:08:54,140
to this if you're a red team are you

265
00:08:53,630 --> 00:08:56,210
under

266
00:08:54,140 --> 00:08:57,949
and this pain because what goes into the

267
00:08:56,210 --> 00:09:01,810
statement of work is something like we

268
00:08:57,950 --> 00:09:05,120
may do things like physical intrusion

269
00:09:01,810 --> 00:09:06,920
wireless social engineering internal

270
00:09:05,120 --> 00:09:08,540
testing external testing and the client

271
00:09:06,920 --> 00:09:12,380
looks at this and they're like oh man I

272
00:09:08,540 --> 00:09:14,810
could all this not necessarily we will

273
00:09:12,380 --> 00:09:17,450
do what we have to do including these

274
00:09:14,810 --> 00:09:19,699
things if necessary and so I'm always

275
00:09:17,450 --> 00:09:21,470
defining that in other words if I call

276
00:09:19,700 --> 00:09:23,630
pay user ask for password single-factor

277
00:09:21,470 --> 00:09:25,160
my a my way in through VPN I don't have

278
00:09:23,630 --> 00:09:27,470
to fish you I don't have to Wireless

279
00:09:25,160 --> 00:09:30,500
that's you okay so I always define what

280
00:09:27,470 --> 00:09:32,480
I can do versus what I will do said an

281
00:09:30,500 --> 00:09:34,520
assumed breach target date this in my

282
00:09:32,480 --> 00:09:36,020
opinion that this is best practice and

283
00:09:34,520 --> 00:09:39,140
the reason being is I've only ever had

284
00:09:36,020 --> 00:09:40,819
one client one where I've said hey can

285
00:09:39,140 --> 00:09:42,470
we talk about a date for when we cut

286
00:09:40,820 --> 00:09:44,000
over to assume breach scenario soon

287
00:09:42,470 --> 00:09:46,370
breaches really when we just pivot to an

288
00:09:44,000 --> 00:09:48,260
insider's perspective and the client was

289
00:09:46,370 --> 00:09:49,790
like no you're gonna fish and you're

290
00:09:48,260 --> 00:09:51,530
gonna fish and you're gonna fish until

291
00:09:49,790 --> 00:09:52,640
you can't fish anymore and I'm like

292
00:09:51,530 --> 00:09:54,380
alright fine

293
00:09:52,640 --> 00:09:55,880
so I spent four weeks fishing I didn't

294
00:09:54,380 --> 00:09:57,110
get in and now with ham an empty report

295
00:09:55,880 --> 00:09:58,640
I'm like I fished you won

296
00:09:57,110 --> 00:10:00,920
congratulations secure check the Box

297
00:09:58,640 --> 00:10:02,660
move on but they're not right and that's

298
00:10:00,920 --> 00:10:05,270
that's a problem so we're always trying

299
00:10:02,660 --> 00:10:08,360
to set that that assume breach date all

300
00:10:05,270 --> 00:10:12,110
right and then I am not ashamed to admit

301
00:10:08,360 --> 00:10:14,660
this all right I asked for the clients

302
00:10:12,110 --> 00:10:17,000
lockout policy not necessarily a minimum

303
00:10:14,660 --> 00:10:18,620
password length okay but I asked for the

304
00:10:17,000 --> 00:10:20,060
lockout policy well why would I do that

305
00:10:18,620 --> 00:10:21,500
all right specifically those attributes

306
00:10:20,060 --> 00:10:22,939
whether they're setting Active Directory

307
00:10:21,500 --> 00:10:24,350
where they're simply a password filter

308
00:10:22,940 --> 00:10:25,850
whether it's of you know a third party

309
00:10:24,350 --> 00:10:28,220
product doesn't matter I asked for that

310
00:10:25,850 --> 00:10:29,900
because chances are if I'm not gonna see

311
00:10:28,220 --> 00:10:32,180
chances are you brute force on a red

312
00:10:29,900 --> 00:10:33,470
team right you brute force on a red team

313
00:10:32,180 --> 00:10:35,060
you brute force on a red team what's the

314
00:10:33,470 --> 00:10:36,500
first thing we do we look for a sure we

315
00:10:35,060 --> 00:10:38,359
look for oh through 65 we look for

316
00:10:36,500 --> 00:10:40,190
bootable services okay and so

317
00:10:38,360 --> 00:10:41,360
understanding what their lockout policy

318
00:10:40,190 --> 00:10:42,620
is you're saving them headaches and

319
00:10:41,360 --> 00:10:44,390
you're saving yourself a black eye

320
00:10:42,620 --> 00:10:46,850
all right in terms of like my average

321
00:10:44,390 --> 00:10:48,770
rate if they refuse to tell me I'll

322
00:10:46,850 --> 00:10:51,440
generally do about one every four hours

323
00:10:48,770 --> 00:10:53,270
and maybe that's slow maybe that's fast

324
00:10:51,440 --> 00:10:54,860
I'm not entirely sure and I'm trying to

325
00:10:53,270 --> 00:10:56,270
take it easy and not lock anyone out you

326
00:10:54,860 --> 00:10:57,770
guys make her way fast you may go way

327
00:10:56,270 --> 00:10:59,420
slower but that's what I do when I

328
00:10:57,770 --> 00:11:01,550
haven't had any lockouts at least in

329
00:10:59,420 --> 00:11:04,069
recent memory so but again on the

330
00:11:01,550 --> 00:11:06,229
kickoff call I kick I asked that

331
00:11:04,070 --> 00:11:08,189
question all right so the question when

332
00:11:06,230 --> 00:11:10,809
is the red team engagement actually

333
00:11:08,189 --> 00:11:13,329
is it on the kickoff call is that when

334
00:11:10,809 --> 00:11:15,819
you start euro sent the answers at least

335
00:11:13,329 --> 00:11:17,529
to me is the minute I get the the

336
00:11:15,819 --> 00:11:19,779
assignment email from project manager

337
00:11:17,529 --> 00:11:22,629
the very moment I do that I'm out on

338
00:11:19,779 --> 00:11:23,679
LinkedIn why because it's the best all

339
00:11:22,629 --> 00:11:25,809
right go to LinkedIn

340
00:11:23,679 --> 00:11:27,339
you must have a recon account by now in

341
00:11:25,809 --> 00:11:29,110
other words an account that is not

342
00:11:27,339 --> 00:11:31,269
associated to your real account that is

343
00:11:29,110 --> 00:11:33,429
not connected to your real account right

344
00:11:31,269 --> 00:11:33,970
you your your accounts are separate I

345
00:11:33,429 --> 00:11:35,980
sure hope so

346
00:11:33,970 --> 00:11:38,439
all right I said a repeating task to add

347
00:11:35,980 --> 00:11:40,600
connections and I do this frequently

348
00:11:38,439 --> 00:11:41,860
about once a month I go out to LinkedIn

349
00:11:40,600 --> 00:11:42,910
I click the network button and I start

350
00:11:41,860 --> 00:11:44,379
he and connecting that connect and I'm

351
00:11:42,910 --> 00:11:46,230
gonna give you a shortcut for that all

352
00:11:44,379 --> 00:11:48,399
right and it's easy it's great because

353
00:11:46,230 --> 00:11:49,749
well I can't say what dad's against

354
00:11:48,399 --> 00:11:54,549
linkedin's Terms of Service in fact it's

355
00:11:49,749 --> 00:11:56,199
impossible to scrape LinkedIn all right

356
00:11:54,549 --> 00:11:59,079
it's number one you built decent profile

357
00:11:56,199 --> 00:12:02,410
be thorough okay this is not the time to

358
00:11:59,079 --> 00:12:05,109
be restrained in in your personality or

359
00:12:02,410 --> 00:12:06,759
in yourself you choose attributes about

360
00:12:05,110 --> 00:12:10,149
your fake persona that you think are

361
00:12:06,759 --> 00:12:10,629
going to be attractive to your target

362
00:12:10,149 --> 00:12:13,660
audience

363
00:12:10,629 --> 00:12:15,699
intent okay number two you click my

364
00:12:13,660 --> 00:12:17,469
network you click my network you see

365
00:12:15,699 --> 00:12:18,910
something like this all right you see

366
00:12:17,470 --> 00:12:20,589
those connect buttons this is the best

367
00:12:18,910 --> 00:12:22,420
part of LinkedIn so good man you guys

368
00:12:20,589 --> 00:12:23,709
gonna love this all right you scroll all

369
00:12:22,420 --> 00:12:26,199
the way down and fill up the page and

370
00:12:23,709 --> 00:12:28,089
then you scroll all the way down again

371
00:12:26,199 --> 00:12:30,819
and you scroll the way down LinkedIn

372
00:12:28,089 --> 00:12:32,110
does this Ajax thing we're like as you

373
00:12:30,819 --> 00:12:33,878
keep scrolling it keeps adding

374
00:12:32,110 --> 00:12:34,929
connections right yeah you did this guy

375
00:12:33,879 --> 00:12:36,459
who's laughing he knows exactly I'm

376
00:12:34,929 --> 00:12:38,230
gonna do all right you keep filling the

377
00:12:36,459 --> 00:12:40,268
page and you keep filling the page I'm

378
00:12:38,230 --> 00:12:42,670
talking like a thousand of these things

379
00:12:40,269 --> 00:12:44,889
you scroll fix up your coffee this is

380
00:12:42,670 --> 00:12:46,059
great all right and then you open up

381
00:12:44,889 --> 00:12:50,619
browser tip tools you run that little

382
00:12:46,059 --> 00:12:52,329
chunk of JavaScript code you connect to

383
00:12:50,619 --> 00:12:53,919
like a thousand people connect to start

384
00:12:52,329 --> 00:12:54,719
rolling in you do a dance cuz you're

385
00:12:53,919 --> 00:12:57,850
awesome

386
00:12:54,720 --> 00:13:01,899
all right so LinkedIn do it do it today

387
00:12:57,850 --> 00:13:05,049
domains I age my domains for a long time

388
00:13:01,899 --> 00:13:08,049
sometimes months sometimes days but

389
00:13:05,049 --> 00:13:09,339
mostly months all right and and the

390
00:13:08,049 --> 00:13:10,899
reason being is because there are really

391
00:13:09,339 --> 00:13:12,489
good security controls like domain tools

392
00:13:10,899 --> 00:13:14,319
out there that will take into account

393
00:13:12,489 --> 00:13:15,309
the age of domains when you are sending

394
00:13:14,319 --> 00:13:16,449
your phishing campaign are on your

395
00:13:15,309 --> 00:13:18,519
callback domain and that'll be a red

396
00:13:16,449 --> 00:13:20,529
flag so get a hold of some good domains

397
00:13:18,519 --> 00:13:21,850
and start the aging process like a fine

398
00:13:20,529 --> 00:13:23,110
wine or a good cheese you

399
00:13:21,850 --> 00:13:25,209
just want those aged friend good long

400
00:13:23,110 --> 00:13:27,670
time it did they just taste better okay

401
00:13:25,209 --> 00:13:29,469
reusable if possible some some groups

402
00:13:27,670 --> 00:13:30,939
burn all the domains this is burned to

403
00:13:29,470 --> 00:13:32,019
the ground and then they start over in

404
00:13:30,940 --> 00:13:33,699
the buy new domains where they go with

405
00:13:32,019 --> 00:13:35,259
expired domains and that's great and and

406
00:13:33,699 --> 00:13:36,519
if that works and you're you're doing

407
00:13:35,259 --> 00:13:38,440
that that's awesome and I'm like why

408
00:13:36,519 --> 00:13:40,360
ruin a good thing if you have an awesome

409
00:13:38,440 --> 00:13:42,870
domain and it doesn't get caught keep

410
00:13:40,360 --> 00:13:45,430
using it and so I go out and I check

411
00:13:42,870 --> 00:13:47,230
I'll - oh I check check point I check

412
00:13:45,430 --> 00:13:48,880
force point I check McAfee blue code I

413
00:13:47,230 --> 00:13:50,949
check those places to make sure that my

414
00:13:48,880 --> 00:13:54,180
domains are still healthy healthy

415
00:13:50,949 --> 00:13:57,880
because they're in the health category

416
00:13:54,180 --> 00:13:58,989
client name - portal com is not okay do

417
00:13:57,880 --> 00:14:00,759
not put your client I'm in the domain

418
00:13:58,990 --> 00:14:02,800
anymore why because at least the vast

419
00:14:00,759 --> 00:14:05,350
majority clients that I test they have

420
00:14:02,800 --> 00:14:07,810
services that that send an email to

421
00:14:05,350 --> 00:14:09,550
security saying Jason registered a

422
00:14:07,810 --> 00:14:11,609
domain that has your name on it so block

423
00:14:09,550 --> 00:14:14,139
it and then block him and he's bad so

424
00:14:11,610 --> 00:14:16,300
normally i if i want to put my client

425
00:14:14,139 --> 00:14:18,490
name anywhere i will put it in the

426
00:14:16,300 --> 00:14:19,870
tertiary level domain the third one over

427
00:14:18,490 --> 00:14:21,940
not not the secondary level yet the

428
00:14:19,870 --> 00:14:23,920
tertiary level so client dot help -

429
00:14:21,940 --> 00:14:25,569
portal comm normal do that but just FYI

430
00:14:23,920 --> 00:14:28,540
be careful because search transparency

431
00:14:25,569 --> 00:14:31,120
logs can burn you on this and if you use

432
00:14:28,540 --> 00:14:34,719
multiple clients tied to the same domain

433
00:14:31,120 --> 00:14:36,370
this is generally a bad idea so be very

434
00:14:34,720 --> 00:14:38,259
very cautious with putting your dome or

435
00:14:36,370 --> 00:14:40,959
your client name in the domain much

436
00:14:38,259 --> 00:14:43,060
rather have domains that are that are

437
00:14:40,959 --> 00:14:45,579
more reusable more widely open and not

438
00:14:43,060 --> 00:14:47,290
associated directly to a client okay see

439
00:14:45,579 --> 00:14:49,060
to efficient domains never overlap this

440
00:14:47,290 --> 00:14:51,519
one is kind of obvious but I just ate it

441
00:14:49,060 --> 00:14:53,768
I might burn through five or ten domains

442
00:14:51,519 --> 00:14:55,660
on an engagement of the payloads going

443
00:14:53,769 --> 00:14:57,759
one place persistence is going another

444
00:14:55,660 --> 00:14:59,949
place c2 short long going different

445
00:14:57,759 --> 00:15:02,050
places you know so just keep those

446
00:14:59,949 --> 00:15:04,300
things separate and then I submit

447
00:15:02,050 --> 00:15:05,829
domains like I said I gave this list

448
00:15:04,300 --> 00:15:07,420
Palo Alto Blue Coat checkpoint McAfee

449
00:15:05,829 --> 00:15:09,008
those are kind of the top four and the

450
00:15:07,420 --> 00:15:11,469
magic categories that I'm shooting for

451
00:15:09,009 --> 00:15:13,870
is health financial and government

452
00:15:11,470 --> 00:15:15,250
well why those three okay though and in

453
00:15:13,870 --> 00:15:17,649
fact I was working with one of my

454
00:15:15,250 --> 00:15:19,209
fortune small number clients that told

455
00:15:17,649 --> 00:15:21,100
me about these magic three categories

456
00:15:19,209 --> 00:15:22,779
and and they said these are the three

457
00:15:21,100 --> 00:15:24,970
that you want to get if you can get in

458
00:15:22,779 --> 00:15:28,000
any one of those you are golden well why

459
00:15:24,970 --> 00:15:30,670
is that well in fact on Palo Alto's

460
00:15:28,000 --> 00:15:32,740
best practices website for SSL based

461
00:15:30,670 --> 00:15:35,770
based encryption their number one wreck

462
00:15:32,740 --> 00:15:37,860
Commendation is do not decrypt health

463
00:15:35,770 --> 00:15:41,230
finance government military and shopping

464
00:15:37,860 --> 00:15:43,089
why would that be HIPAA PII pan data

465
00:15:41,230 --> 00:15:45,370
nobody wants to see that you certainly

466
00:15:43,089 --> 00:15:47,080
watch a Palo Alto inside your PCI scope

467
00:15:45,370 --> 00:15:48,850
you don't want people the defenders

468
00:15:47,080 --> 00:15:50,020
don't want to be anywhere near that awed

469
00:15:48,850 --> 00:15:53,320
it doesn't want to be anywhere near that

470
00:15:50,020 --> 00:15:56,380
so all that stuff gets left I encrypted

471
00:15:53,320 --> 00:15:59,320
and it's good you know like I said

472
00:15:56,380 --> 00:16:02,200
healthy domains we like that all right

473
00:15:59,320 --> 00:16:04,089
tools I'm not gonna get too much into

474
00:16:02,200 --> 00:16:05,170
tools but I will give you this slide and

475
00:16:04,089 --> 00:16:07,540
of course I will make these slides

476
00:16:05,170 --> 00:16:09,849
available on Twitter so you can you can

477
00:16:07,540 --> 00:16:11,069
take pictures or you can just follow me

478
00:16:09,850 --> 00:16:14,020
on Twitter now I'll drop them out there

479
00:16:11,070 --> 00:16:15,910
tools for a passive recon hard cider

480
00:16:14,020 --> 00:16:19,060
that was made by Jason Ashton at trust

481
00:16:15,910 --> 00:16:22,600
SEC amass for certificate transparency I

482
00:16:19,060 --> 00:16:24,729
use tool that I wrote sir SH - parse PI

483
00:16:22,600 --> 00:16:27,430
meta is good for searching metadata get

484
00:16:24,730 --> 00:16:29,200
up searching with truffle hog or repo

485
00:16:27,430 --> 00:16:33,189
scanner or you can just send a NAT

486
00:16:29,200 --> 00:16:34,720
request to hacking LZ he is he's the

487
00:16:33,190 --> 00:16:36,130
person who knows like you just find

488
00:16:34,720 --> 00:16:37,990
anything on github so feel free to hit

489
00:16:36,130 --> 00:16:39,880
him up and then authenticated LinkedIn

490
00:16:37,990 --> 00:16:42,010
scraping for contents you could use a

491
00:16:39,880 --> 00:16:42,939
LinkedIn there and then Google dorks for

492
00:16:42,010 --> 00:16:45,310
everything else and these are some of my

493
00:16:42,940 --> 00:16:46,510
favorite google dorks i love these the

494
00:16:45,310 --> 00:16:47,859
top one you know you're looking for

495
00:16:46,510 --> 00:16:49,689
amazon you're looking for you know

496
00:16:47,860 --> 00:16:51,579
pastebin things like that the bottom one

497
00:16:49,690 --> 00:16:52,839
is my favorite because service that's

498
00:16:51,579 --> 00:16:55,120
people and help this people generally

499
00:16:52,839 --> 00:16:56,350
hit their job and so they want out as

500
00:16:55,120 --> 00:16:57,820
soon as possible through this is gonna

501
00:16:56,350 --> 00:17:00,310
litter their profile with all kinds of

502
00:16:57,820 --> 00:17:04,209
awesome information so definitely one of

503
00:17:00,310 --> 00:17:06,550
my favorites breach data breach data is

504
00:17:04,209 --> 00:17:08,290
a treasure trove of information the

505
00:17:06,550 --> 00:17:10,300
email format the pastor format new user

506
00:17:08,290 --> 00:17:11,678
passwords i group these by countin and

507
00:17:10,300 --> 00:17:13,448
throw them in the report very very

508
00:17:11,679 --> 00:17:14,800
helpful and if you're not sure where to

509
00:17:13,449 --> 00:17:18,100
get started if you haven't gone down

510
00:17:14,800 --> 00:17:19,419
this road there are people in in the

511
00:17:18,099 --> 00:17:20,938
place where i work I'm not sure if Hans

512
00:17:19,420 --> 00:17:22,900
is here but he has done a tremendous

513
00:17:20,939 --> 00:17:24,280
it's incredible what that guy's done

514
00:17:22,900 --> 00:17:26,050
with password breach data and crack and

515
00:17:24,280 --> 00:17:28,928
stuff like that it is very very useful

516
00:17:26,050 --> 00:17:30,129
to a red teaming organization to have

517
00:17:28,929 --> 00:17:35,290
that kind of data so if you're not sure

518
00:17:30,130 --> 00:17:36,340
where to go well there's a I'll get you

519
00:17:35,290 --> 00:17:40,990
stare don't say an every day anything

520
00:17:36,340 --> 00:17:42,340
good for you alright external now we

521
00:17:40,990 --> 00:17:43,630
starting to fun stuff right core

522
00:17:42,340 --> 00:17:46,199
principles on the external just a little

523
00:17:43,630 --> 00:17:48,720
bit I always root out to directory

524
00:17:46,200 --> 00:17:50,490
the external perspective never internal

525
00:17:48,720 --> 00:17:52,050
and always through VPN if you get

526
00:17:50,490 --> 00:17:53,400
internal access if I get internal lag

527
00:17:52,050 --> 00:17:54,300
this is my methodology not yours if I

528
00:17:53,400 --> 00:17:56,520
get internal access

529
00:17:54,300 --> 00:17:58,649
I do not Groot Active Directory with one

530
00:17:56,520 --> 00:17:59,810
exception that might be curb root which

531
00:17:58,650 --> 00:18:04,560
is going to throw a different event ID

532
00:17:59,810 --> 00:18:05,909
47 71 as opposed to 46 24 in in the log

533
00:18:04,560 --> 00:18:08,280
don't quote me on that but I do know

534
00:18:05,910 --> 00:18:10,770
that Kerberos brooding is a different

535
00:18:08,280 --> 00:18:12,990
event ID than like auntie LAN brooding

536
00:18:10,770 --> 00:18:14,580
or things like that so that is still a

537
00:18:12,990 --> 00:18:16,350
reasonably new technique otherwise I do

538
00:18:14,580 --> 00:18:19,139
not brew it after directory from the

539
00:18:16,350 --> 00:18:20,550
internal perspective number two and your

540
00:18:19,140 --> 00:18:22,080
mouse is gonna vary on this one maybe

541
00:18:20,550 --> 00:18:24,450
you're a web app genius and that's

542
00:18:22,080 --> 00:18:26,189
awesome but generally speaking from a

543
00:18:24,450 --> 00:18:28,140
consultants perspective when I'm when

544
00:18:26,190 --> 00:18:30,690
I'm unlimited time Web Apps are not

545
00:18:28,140 --> 00:18:33,510
necessarily my focus I will look at your

546
00:18:30,690 --> 00:18:35,640
web apps however it's not from a web app

547
00:18:33,510 --> 00:18:37,650
testing perspective and Trust like we

548
00:18:35,640 --> 00:18:39,300
have an amazing group of web app testers

549
00:18:37,650 --> 00:18:41,280
and that's all they do they don't do red

550
00:18:39,300 --> 00:18:43,020
teaming and what I might do is bring in

551
00:18:41,280 --> 00:18:45,240
somebody with that specialty on to the

552
00:18:43,020 --> 00:18:46,860
red team at least for that engagement to

553
00:18:45,240 --> 00:18:48,600
look at those web apps but it's not

554
00:18:46,860 --> 00:18:50,399
necessarily my specialty because they've

555
00:18:48,600 --> 00:18:51,959
grown extremely complex in my opinion so

556
00:18:50,400 --> 00:18:55,470
not necessarily the thing that I'm most

557
00:18:51,960 --> 00:18:56,730
gravitating towards and I do make

558
00:18:55,470 --> 00:18:57,720
liberal use of credential stuffing if

559
00:18:56,730 --> 00:19:00,090
you're not familiar with that we're back

560
00:18:57,720 --> 00:19:01,710
to bat password breach data get a hold

561
00:19:00,090 --> 00:19:04,860
of those credentials and start trying

562
00:19:01,710 --> 00:19:07,140
them I one of my targets this is an

563
00:19:04,860 --> 00:19:09,780
assessment two weeks ago I went and took

564
00:19:07,140 --> 00:19:12,930
their brand name it was a popular brand

565
00:19:09,780 --> 00:19:14,730
name and grabbed the credentials from my

566
00:19:12,930 --> 00:19:17,100
password breach store and threw a mat at

567
00:19:14,730 --> 00:19:19,610
their website 350 valid credentials just

568
00:19:17,100 --> 00:19:23,760
like that so it does work very very well

569
00:19:19,610 --> 00:19:26,040
active recon these are our do it aqua

570
00:19:23,760 --> 00:19:27,690
tone through search and map typical

571
00:19:26,040 --> 00:19:29,490
tools that you would use in a Red Team

572
00:19:27,690 --> 00:19:31,500
engagement but just understand and

573
00:19:29,490 --> 00:19:34,560
thanks to I think Scott pointed this out

574
00:19:31,500 --> 00:19:35,850
for like the end map user agent that can

575
00:19:34,560 --> 00:19:36,960
bite you because if you didn't know this

576
00:19:35,850 --> 00:19:37,530
and I didn't know this until a little

577
00:19:36,960 --> 00:19:40,410
while ago

578
00:19:37,530 --> 00:19:42,210
nmap has its own user agent and it has n

579
00:19:40,410 --> 00:19:44,640
map in the user agent so talk about

580
00:19:42,210 --> 00:19:45,900
getting blocked right away you can

581
00:19:44,640 --> 00:19:49,440
actually change that with us with a

582
00:19:45,900 --> 00:19:51,090
script parameter if you use I don't now

583
00:19:49,440 --> 00:19:53,670
you can't see it but if it's dish - -

584
00:19:51,090 --> 00:19:55,169
script args and then you can paste in

585
00:19:53,670 --> 00:19:58,470
the the user agent that you want to see

586
00:19:55,170 --> 00:19:59,580
and if you're interested I wrapped all

587
00:19:58,470 --> 00:20:01,590
this into a tool

588
00:19:59,580 --> 00:20:04,649
that that I used on my engagements

589
00:20:01,590 --> 00:20:07,619
called initial recon that it fires a

590
00:20:04,649 --> 00:20:09,330
mass at front hires a LinkedIn scraper

591
00:20:07,619 --> 00:20:12,480
fires metadata scraper fires all that

592
00:20:09,330 --> 00:20:14,279
stuff and the code sections are up there

593
00:20:12,480 --> 00:20:16,080
if you want to get them I get up it's

594
00:20:14,279 --> 00:20:17,429
helpful at least I think it's helpful

595
00:20:16,080 --> 00:20:19,139
it's good for my methodology might not

596
00:20:17,429 --> 00:20:20,399
work for you if you don't have something

597
00:20:19,139 --> 00:20:22,918
like this it'll be a good thing to get

598
00:20:20,399 --> 00:20:25,258
you started and then lastly on the

599
00:20:22,919 --> 00:20:28,860
external part ntlm brooding is still

600
00:20:25,259 --> 00:20:31,230
super hot office 365 exchange Skype link

601
00:20:28,860 --> 00:20:33,299
a good place for testing what a client

602
00:20:31,230 --> 00:20:33,749
has is a test connector via Microsoft

603
00:20:33,299 --> 00:20:36,059
com

604
00:20:33,749 --> 00:20:39,119
otherwise I will go out to Outlook

605
00:20:36,059 --> 00:20:40,678
Microsoft com put in admin at target.com

606
00:20:39,119 --> 00:20:42,178
and I'll get redirected to whatever

607
00:20:40,679 --> 00:20:44,609
their ad FS instances and that's always

608
00:20:42,179 --> 00:20:46,320
really helpful speaking of ad FS

609
00:20:44,609 --> 00:20:48,359
these links were dropped at Troopers 19

610
00:20:46,320 --> 00:20:49,830
these are some less obvious sources

611
00:20:48,359 --> 00:20:54,840
friend teal and burning so if you go to

612
00:20:49,830 --> 00:20:57,269
like a TFS target comm and then and and

613
00:20:54,840 --> 00:20:58,949
that those are valid URLs so that that a

614
00:20:57,269 --> 00:21:01,919
TFS is a valid domain taking you to an

615
00:20:58,950 --> 00:21:05,009
ad FS instance those you are eyes I'm

616
00:21:01,919 --> 00:21:08,940
blaze reporting at my screen those your

617
00:21:05,009 --> 00:21:10,739
eyes at the very bottom are open ntlm

618
00:21:08,940 --> 00:21:14,940
portals so you can send your brute-force

619
00:21:10,739 --> 00:21:18,320
attacks they're very very helpful social

620
00:21:14,940 --> 00:21:20,429
engineering does everyone loves a bob

621
00:21:18,320 --> 00:21:23,249
core principles and social engineering

622
00:21:20,429 --> 00:21:30,619
fishing this is how I get around proof

623
00:21:23,249 --> 00:21:33,809
point in fact I went for point is good

624
00:21:30,619 --> 00:21:36,509
at it's probably very it's probably very

625
00:21:33,809 --> 00:21:38,070
very good at stopping a lot of spam but

626
00:21:36,509 --> 00:21:39,539
if you are going to be targeted and this

627
00:21:38,070 --> 00:21:41,879
is true of a lot of controls right yeah

628
00:21:39,539 --> 00:21:43,980
as red team as we understand this the I

629
00:21:41,879 --> 00:21:45,629
never as much as I dog I'm like

630
00:21:43,980 --> 00:21:47,369
antivirus I never told my clients to

631
00:21:45,629 --> 00:21:49,350
uninstall it because it serves a very

632
00:21:47,369 --> 00:21:50,939
very good purpose which is blocking like

633
00:21:49,350 --> 00:21:52,649
kamat commodity malware achmadi

634
00:21:50,940 --> 00:21:54,330
ransomware that kind of stuff it does

635
00:21:52,649 --> 00:21:54,840
serve a good purpose Proofpoint serves a

636
00:21:54,330 --> 00:21:57,178
good purpose

637
00:21:54,840 --> 00:21:58,350
it just doesn't serve the purpose when

638
00:21:57,179 --> 00:22:00,809
i'm sending the email and here's how

639
00:21:58,350 --> 00:22:04,619
that works you send five at five emails

640
00:22:00,809 --> 00:22:06,359
max at a time all bcc'd works great with

641
00:22:04,619 --> 00:22:09,178
fifteen minutes in between sends and I

642
00:22:06,359 --> 00:22:11,939
send from office 365 a little caveat

643
00:22:09,179 --> 00:22:12,720
there when you log in to office 365 to

644
00:22:11,940 --> 00:22:14,400
send your fish

645
00:22:12,720 --> 00:22:16,590
the IP that you are connecting from gets

646
00:22:14,400 --> 00:22:18,060
put into the headers of that message so

647
00:22:16,590 --> 00:22:21,600
be sure you are connecting from a VPN

648
00:22:18,060 --> 00:22:23,940
tunnel okay send links not attachments

649
00:22:21,600 --> 00:22:24,629
you do those things and you just kind of

650
00:22:23,940 --> 00:22:26,190
take it slow

651
00:22:24,630 --> 00:22:27,630
you're not blasting out 100 emails a

652
00:22:26,190 --> 00:22:31,740
time you're not gonna make worries about

653
00:22:27,630 --> 00:22:33,750
Brooklyn I lead off with my my latest

654
00:22:31,740 --> 00:22:35,640
tradecraft and then I downgrade as I get

655
00:22:33,750 --> 00:22:38,010
a feel for the target environment okay

656
00:22:35,640 --> 00:22:39,450
so if you have like all custom c2 and

657
00:22:38,010 --> 00:22:41,160
you're just shiz you're all this hot

658
00:22:39,450 --> 00:22:42,960
stuff but you know there's like

659
00:22:41,160 --> 00:22:44,940
PowerShell version 2 in the environment

660
00:22:42,960 --> 00:22:45,990
don't necessarily burn all the stuff

661
00:22:44,940 --> 00:22:49,560
that you spend a lot of time writing

662
00:22:45,990 --> 00:22:51,510
okay adjust your attack path to the

663
00:22:49,560 --> 00:22:53,070
maturity of the client right because if

664
00:22:51,510 --> 00:22:54,390
you're so far ahead of them you might be

665
00:22:53,070 --> 00:22:56,610
giving them things that they can't

666
00:22:54,390 --> 00:22:58,650
necessarily remediate at least not in

667
00:22:56,610 --> 00:23:01,229
any meaningful fashion if they even

668
00:22:58,650 --> 00:23:03,570
understand it so point being is adjust

669
00:23:01,230 --> 00:23:05,910
your that your turn that dial back I

670
00:23:03,570 --> 00:23:07,110
guess if you will to compensate for

671
00:23:05,910 --> 00:23:08,730
their sensitivity and eventually

672
00:23:07,110 --> 00:23:11,070
eventually your clients will all pace

673
00:23:08,730 --> 00:23:12,840
you and you'll be like shoot this I gave

674
00:23:11,070 --> 00:23:14,189
you everything I had and you caught me I

675
00:23:12,840 --> 00:23:15,629
fish tonight fish tonight fish and you

676
00:23:14,190 --> 00:23:19,380
caught me and that's kind of a good

677
00:23:15,630 --> 00:23:20,880
place for them for them to be alright

678
00:23:19,380 --> 00:23:22,410
and once again eventually pivot to

679
00:23:20,880 --> 00:23:24,120
assume breach I do this about 50% away

680
00:23:22,410 --> 00:23:25,710
through the engagement time that's a six

681
00:23:24,120 --> 00:23:27,270
week engagement it'll generally be about

682
00:23:25,710 --> 00:23:30,780
two and a half weeks maybe three weeks

683
00:23:27,270 --> 00:23:32,550
maybe two weeks going into that just

684
00:23:30,780 --> 00:23:33,720
because that provides better value

685
00:23:32,550 --> 00:23:36,360
provides a better value for the client

686
00:23:33,720 --> 00:23:37,560
and you know what if you're done

687
00:23:36,360 --> 00:23:39,419
evaluating the perimeter then you're

688
00:23:37,560 --> 00:23:41,960
done evaluating the perimeter so some

689
00:23:39,420 --> 00:23:45,030
move on infrastructure automation

690
00:23:41,960 --> 00:23:46,650
automation is getting to be or actually

691
00:23:45,030 --> 00:23:47,910
infrastructure building it up and

692
00:23:46,650 --> 00:23:49,470
tearing it down is getting to be a pain

693
00:23:47,910 --> 00:23:50,610
especially when you need different

694
00:23:49,470 --> 00:23:52,710
servers for everything and whether

695
00:23:50,610 --> 00:23:54,870
you're doing AWS or whether you're doing

696
00:23:52,710 --> 00:23:57,840
a sure were they doing on Prem what I do

697
00:23:54,870 --> 00:23:58,770
is I use ansible if you follow me on

698
00:23:57,840 --> 00:24:00,300
Twitter for any length of time you know

699
00:23:58,770 --> 00:24:01,800
I'm kind of an Ansel junky I just gave a

700
00:24:00,300 --> 00:24:04,050
class pretty much under Hansel Bowles is

701
00:24:01,800 --> 00:24:06,240
you know ton of fun but what answer was

702
00:24:04,050 --> 00:24:08,040
just really really brief primer it's an

703
00:24:06,240 --> 00:24:10,050
open source platform put out by Red Hat

704
00:24:08,040 --> 00:24:11,520
maintained by Red Hat that gives you

705
00:24:10,050 --> 00:24:13,919
really saw configuration management and

706
00:24:11,520 --> 00:24:15,990
application deployment purposes it uses

707
00:24:13,920 --> 00:24:18,390
the ammo files it's really easy to get

708
00:24:15,990 --> 00:24:19,800
into even if you've never coded it if

709
00:24:18,390 --> 00:24:21,360
you're not even coding any ammo you're

710
00:24:19,800 --> 00:24:24,180
just like typing in the animal it's it's

711
00:24:21,360 --> 00:24:25,800
really really straightforward there's no

712
00:24:24,180 --> 00:24:26,660
agent it's totally agent list you need

713
00:24:25,800 --> 00:24:28,430
Association pie

714
00:24:26,660 --> 00:24:30,500
that's it if you can get Python on the

715
00:24:28,430 --> 00:24:32,030
target you can even even have to have

716
00:24:30,500 --> 00:24:34,040
Python target you can use ansible to

717
00:24:32,030 --> 00:24:36,590
install Python on the target which is

718
00:24:34,040 --> 00:24:38,450
fantastic and then modules make up the

719
00:24:36,590 --> 00:24:40,639
functionality so for example these are

720
00:24:38,450 --> 00:24:45,200
some these are some tasks that are

721
00:24:40,640 --> 00:24:46,940
inside my create c2v2 server playbook so

722
00:24:45,200 --> 00:24:48,560
the name of the task cloning a packet

723
00:24:46,940 --> 00:24:51,230
installing a packet cloning carbon copy

724
00:24:48,560 --> 00:24:52,580
etc etc the modules that we're using so

725
00:24:51,230 --> 00:24:54,290
in this case the module is called git

726
00:24:52,580 --> 00:24:56,120
command and then get I'm calling the get

727
00:24:54,290 --> 00:24:57,530
module twice and then I'm passing the

728
00:24:56,120 --> 00:24:58,850
argument it's actually really really

729
00:24:57,530 --> 00:25:00,470
straightforward then once you have all

730
00:24:58,850 --> 00:25:01,129
that put together you run it inside a

731
00:25:00,470 --> 00:25:03,170
playbook

732
00:25:01,130 --> 00:25:05,150
so in this case I'm running the new c2

733
00:25:03,170 --> 00:25:06,530
server playbook against the host file

734
00:25:05,150 --> 00:25:08,330
and it goes out and builds all my stuff

735
00:25:06,530 --> 00:25:10,490
ansible is multi-threaded so you can run

736
00:25:08,330 --> 00:25:12,230
this against five c2 service at once and

737
00:25:10,490 --> 00:25:13,850
they all get billed out the exact same

738
00:25:12,230 --> 00:25:15,560
way to the desired state configuration

739
00:25:13,850 --> 00:25:17,600
that you're looking for really really

740
00:25:15,560 --> 00:25:19,190
really good tool if you want to geek out

741
00:25:17,600 --> 00:25:22,669
about that I'll be happy to do that with

742
00:25:19,190 --> 00:25:25,460
you and the macros chat and attachments

743
00:25:22,670 --> 00:25:27,770
for sending payloads safe payloads

744
00:25:25,460 --> 00:25:29,630
generally speaking a modified cactus

745
00:25:27,770 --> 00:25:31,129
torch will is reasonably safe in terms

746
00:25:29,630 --> 00:25:32,080
of getting in the door if you're looking

747
00:25:31,130 --> 00:25:35,090
to get code execution immediately

748
00:25:32,080 --> 00:25:37,010
otherwise safer might be registry only

749
00:25:35,090 --> 00:25:39,050
mods so for example if you're looking to

750
00:25:37,010 --> 00:25:41,420
land with like persistence or something

751
00:25:39,050 --> 00:25:43,730
along those lines registry key mods are

752
00:25:41,420 --> 00:25:44,900
generally very safe we've it we have yet

753
00:25:43,730 --> 00:25:48,380
to be caught yet on that at least as far

754
00:25:44,900 --> 00:25:50,600
as I know VB is stomping and evil Clippy

755
00:25:48,380 --> 00:25:52,010
the Walmart folks they did a great job

756
00:25:50,600 --> 00:25:53,840
Herald in his team did a great job on

757
00:25:52,010 --> 00:25:55,510
this evil Clippy the outflank guys I

758
00:25:53,840 --> 00:25:57,889
know this is Stan's work primarily

759
00:25:55,510 --> 00:25:59,210
fantastic tools that we all use that or

760
00:25:57,890 --> 00:26:00,890
they're really really good in terms of

761
00:25:59,210 --> 00:26:03,530
making those macros even more evil and

762
00:26:00,890 --> 00:26:05,360
less detectable and that's we want and

763
00:26:03,530 --> 00:26:07,129
then lastly a template injection which

764
00:26:05,360 --> 00:26:08,360
I'm a huge fan of template injection is

765
00:26:07,130 --> 00:26:11,210
great because you can actually send a

766
00:26:08,360 --> 00:26:13,159
doc X in the door and then when the user

767
00:26:11,210 --> 00:26:17,390
opens that doc X it goes out and pulls

768
00:26:13,160 --> 00:26:20,330
in the doc M or the dot gif or whatever

769
00:26:17,390 --> 00:26:22,400
and it all works great okay so really

770
00:26:20,330 --> 00:26:24,260
that evil template give is just a doc M

771
00:26:22,400 --> 00:26:26,000
that's hosting on my web server it pulls

772
00:26:24,260 --> 00:26:27,830
the template in the user gets prompted

773
00:26:26,000 --> 00:26:29,570
they click enable content and then you

774
00:26:27,830 --> 00:26:31,909
get your shell or Y or Z or whatever is

775
00:26:29,570 --> 00:26:32,840
you're looking for all right as you

776
00:26:31,910 --> 00:26:35,150
information protection

777
00:26:32,840 --> 00:26:37,459
oddvar and hans give a fantastic talk on

778
00:26:35,150 --> 00:26:40,330
this yesterday leverages though office

779
00:26:37,460 --> 00:26:42,730
365's rms to encrypt the office

780
00:26:40,330 --> 00:26:44,439
document to specific recipients which is

781
00:26:42,730 --> 00:26:45,820
really cool it's impossible for

782
00:26:44,440 --> 00:26:48,159
defenders and sandbox is to evaluate

783
00:26:45,820 --> 00:26:51,129
without the users credentials need to

784
00:26:48,159 --> 00:26:53,500
read that again when you send an AIP

785
00:26:51,130 --> 00:26:56,830
encrypted document and it reaches their

786
00:26:53,500 --> 00:26:59,320
environment and and the users like this

787
00:26:56,830 --> 00:27:00,908
is spam and they forward it if they can

788
00:26:59,320 --> 00:27:03,158
if you haven't marked the do not forward

789
00:27:00,909 --> 00:27:04,870
box if they if they forward it over to

790
00:27:03,159 --> 00:27:06,220
security secur is gonna open it they're

791
00:27:04,870 --> 00:27:06,850
gonna be like I can't open this it's

792
00:27:06,220 --> 00:27:08,320
encrypted

793
00:27:06,850 --> 00:27:09,549
I need your password and you just be

794
00:27:08,320 --> 00:27:11,799
like I'm never supposed to give you my

795
00:27:09,549 --> 00:27:16,690
password secures me like I need your pet

796
00:27:11,799 --> 00:27:18,970
and freak-outs great does not require

797
00:27:16,690 --> 00:27:20,470
your target to have office 365 you can

798
00:27:18,970 --> 00:27:22,840
send this to a gmail account and let's

799
00:27:20,470 --> 00:27:25,720
get prompted to an installation here's

800
00:27:22,840 --> 00:27:28,389
what it looks like you you install the

801
00:27:25,720 --> 00:27:30,760
Azure information protection agent you

802
00:27:28,389 --> 00:27:33,389
go out to protect it you select the

803
00:27:30,760 --> 00:27:34,570
email address your targets email address

804
00:27:33,389 --> 00:27:36,428
sorry

805
00:27:34,570 --> 00:27:38,139
that's permissions can you guys even see

806
00:27:36,429 --> 00:27:40,320
that yeah you can't okay you can you

807
00:27:38,139 --> 00:27:42,639
selected permissions this case view only

808
00:27:40,320 --> 00:27:44,260
you put in the target's email address

809
00:27:42,639 --> 00:27:46,360
and then if you're feeling if you're

810
00:27:44,260 --> 00:27:49,059
feeling especially naughty you specify

811
00:27:46,360 --> 00:27:50,408
an expiration which is just great you

812
00:27:49,059 --> 00:27:51,908
know cuz like if you only want that fish

813
00:27:50,409 --> 00:27:54,399
to be live for 24 hours

814
00:27:51,909 --> 00:27:57,210
then you can just put in 24 hours and

815
00:27:54,399 --> 00:28:00,479
send to me after 24 hours it's gone like

816
00:27:57,210 --> 00:28:02,740
Mission Impossible stuff self-destruct

817
00:28:00,480 --> 00:28:05,289
alright so as your information

818
00:28:02,740 --> 00:28:06,580
protection watch this talk I got a look

819
00:28:05,289 --> 00:28:07,779
in there right for this this this talk

820
00:28:06,580 --> 00:28:11,789
happened yesterday those guys did a

821
00:28:07,779 --> 00:28:16,870
fantastic job and then the internal side

822
00:28:11,789 --> 00:28:19,720
really work it's fun right core

823
00:28:16,870 --> 00:28:22,029
principles on the internal on a red team

824
00:28:19,720 --> 00:28:23,649
this is what I'm prioritized once I get

825
00:28:22,029 --> 00:28:25,659
access into the target environment I'm

826
00:28:23,649 --> 00:28:31,029
not just invoke masked me me catching

827
00:28:25,659 --> 00:28:32,889
everything alright as fun as that is who

828
00:28:31,029 --> 00:28:34,690
isn't like treads just raining back in

829
00:28:32,889 --> 00:28:37,120
ok but seriously though cookies

830
00:28:34,690 --> 00:28:39,279
bookmarks file shares SharePoint

831
00:28:37,120 --> 00:28:40,899
remember the ability to slow down what

832
00:28:39,279 --> 00:28:42,940
are you doing with this step you're

833
00:28:40,899 --> 00:28:45,370
gaining valuable knowledge about the

834
00:28:42,940 --> 00:28:47,230
targets environment ok you're not just

835
00:28:45,370 --> 00:28:48,969
you know spraying and praying your

836
00:28:47,230 --> 00:28:51,070
you're looking for things that are of

837
00:28:48,970 --> 00:28:53,080
value because how many times on red

838
00:28:51,070 --> 00:28:53,710
teams have you found documents that have

839
00:28:53,080 --> 00:28:55,330
career

840
00:28:53,710 --> 00:28:57,460
documents that have Network diagrams

841
00:28:55,330 --> 00:28:59,289
document said have sensitive data open

842
00:28:57,460 --> 00:29:01,510
file shares that have sensitive data do

843
00:28:59,289 --> 00:29:03,280
spend the time in that due diligence you

844
00:29:01,510 --> 00:29:05,559
might be able to achieve the trophies

845
00:29:03,280 --> 00:29:07,270
just with that you necessarily have to

846
00:29:05,559 --> 00:29:09,160
be moving laterally and why move

847
00:29:07,270 --> 00:29:10,418
laterally if you don't have to that's

848
00:29:09,160 --> 00:29:12,190
one of the noises things you could do in

849
00:29:10,419 --> 00:29:14,289
the target network so if you have the

850
00:29:12,190 --> 00:29:16,090
right access to those data stores use

851
00:29:14,289 --> 00:29:17,910
that access and accomplish the goal

852
00:29:16,090 --> 00:29:20,760
because that's what an attacker would do

853
00:29:17,910 --> 00:29:24,340
that's what I would attack all right

854
00:29:20,760 --> 00:29:26,049
Kerberos thing I love it I love it but I

855
00:29:24,340 --> 00:29:27,100
got to dial it back okay you got it you

856
00:29:26,049 --> 00:29:28,929
got to pull the reigns back on a

857
00:29:27,100 --> 00:29:31,449
Kerberos if you're just firing get users

858
00:29:28,929 --> 00:29:33,520
SP ends all right from a packet then

859
00:29:31,450 --> 00:29:35,620
what's happening is you're sending those

860
00:29:33,520 --> 00:29:37,450
events to Active Directory a ton of them

861
00:29:35,620 --> 00:29:39,189
and if the defender is on top of it

862
00:29:37,450 --> 00:29:41,409
they've written a threshold alert so

863
00:29:39,190 --> 00:29:44,799
anything more than I don't know what

864
00:29:41,409 --> 00:29:46,630
four or five I mean a day if ever so in

865
00:29:44,799 --> 00:29:49,179
my case generally speaking I'll start

866
00:29:46,630 --> 00:29:51,370
out no more than one an hour and that's

867
00:29:49,179 --> 00:29:52,419
after doing research on the account okay

868
00:29:51,370 --> 00:29:54,760
now this is obviously assuming

869
00:29:52,419 --> 00:29:55,780
credential access okay but you're doing

870
00:29:54,760 --> 00:29:57,789
the research on the account to see if

871
00:29:55,780 --> 00:29:59,830
it's even a viable target all right and

872
00:29:57,789 --> 00:30:01,629
when I choose Kerberos IDs the Kerberos

873
00:29:59,830 --> 00:30:02,080
I'm not going for domain AB okay true

874
00:30:01,630 --> 00:30:04,330
story

875
00:30:02,080 --> 00:30:06,789
I was I was Kerberos ting user accounts

876
00:30:04,330 --> 00:30:07,899
and actually I shouldn't said I was

877
00:30:06,789 --> 00:30:09,340
doing reconnaissance against user

878
00:30:07,900 --> 00:30:11,500
accounts that had service principle

879
00:30:09,340 --> 00:30:13,330
names and it was like all all the

880
00:30:11,500 --> 00:30:14,919
account names were like SVC underscore

881
00:30:13,330 --> 00:30:17,439
every single one and then there was one

882
00:30:14,919 --> 00:30:19,470
that was John Smith like J Smith right

883
00:30:17,440 --> 00:30:23,169
and in the description it said InfoSec

884
00:30:19,470 --> 00:30:24,640
come on oh that's and so I sent emailed

885
00:30:23,169 --> 00:30:30,309
my content like this is a honeypot he's

886
00:30:24,640 --> 00:30:31,929
like yeah great alright so I was

887
00:30:30,309 --> 00:30:34,059
actually chatting with a with a friend

888
00:30:31,929 --> 00:30:36,820
of mine about this last night about how

889
00:30:34,059 --> 00:30:38,740
to do like Kerberos deception make

890
00:30:36,820 --> 00:30:40,539
twenty accounts and make them all with

891
00:30:38,740 --> 00:30:42,429
different user IDs and then if you want

892
00:30:40,539 --> 00:30:44,530
to be really evil in your twenty fake

893
00:30:42,429 --> 00:30:46,270
accounts that you have disabled with or

894
00:30:44,530 --> 00:30:48,010
that you have enabled with ridiculously

895
00:30:46,270 --> 00:30:49,900
long passwords that will never crack go

896
00:30:48,010 --> 00:30:51,309
ahead and make your J Smith user account

897
00:30:49,900 --> 00:30:53,049
because the attacker is gonna show if

898
00:30:51,309 --> 00:30:54,370
you like out that's honeypot I'm not

899
00:30:53,049 --> 00:30:56,168
gonna grab that one and they're gonna

900
00:30:54,370 --> 00:30:59,429
grab the rest that's like pure evil but

901
00:30:56,169 --> 00:31:02,670
this is a red team talk shoot okay

902
00:30:59,430 --> 00:31:04,590
I do purple teams - it's fun all right

903
00:31:02,670 --> 00:31:06,300
initial landing callback of 5 to 30

904
00:31:04,590 --> 00:31:08,070
minutes depending on the time that I

905
00:31:06,300 --> 00:31:10,740
have and the sophistication of the

906
00:31:08,070 --> 00:31:13,500
target ok so there are some times when

907
00:31:10,740 --> 00:31:15,930
it is fine to just throw the barn doors

908
00:31:13,500 --> 00:31:17,940
open so to speak and like go full

909
00:31:15,930 --> 00:31:19,320
interactive mode on your beacon okay but

910
00:31:17,940 --> 00:31:20,550
that's after you've done a little bit of

911
00:31:19,320 --> 00:31:22,500
analysis that's after you've had your

912
00:31:20,550 --> 00:31:23,879
shell for a little bit and you know you

913
00:31:22,500 --> 00:31:25,290
maybe you've downloaded some stuff

914
00:31:23,880 --> 00:31:26,309
you're taking your time for a day or two

915
00:31:25,290 --> 00:31:28,440
it's not a big deal

916
00:31:26,309 --> 00:31:29,700
slow down and then once you've figured

917
00:31:28,440 --> 00:31:31,679
out that they're not catching on to your

918
00:31:29,700 --> 00:31:35,370
c2 then yeah full interactive because

919
00:31:31,679 --> 00:31:37,500
that's the best all right I test all my

920
00:31:35,370 --> 00:31:39,449
commands in my lab before firing live at

921
00:31:37,500 --> 00:31:42,059
least as much as I can ok just a little

922
00:31:39,450 --> 00:31:45,300
bit of a word about my lab I went out to

923
00:31:42,059 --> 00:31:46,559
ebay I bought at Dell our 710 $500 ok we

924
00:31:45,300 --> 00:31:47,970
have an Emma stand license which I

925
00:31:46,559 --> 00:31:50,580
imagine a lot of you probably do and I

926
00:31:47,970 --> 00:31:52,860
built full Active Directory lab ok I

927
00:31:50,580 --> 00:31:55,550
installed the fantastic the one and only

928
00:31:52,860 --> 00:31:59,309
Splunk through hunting app bye-bye Olaf

929
00:31:55,550 --> 00:32:01,379
sis Mon and Windows Defender and and I

930
00:31:59,309 --> 00:32:04,230
configured all this and and it's it's I

931
00:32:01,380 --> 00:32:07,350
cannot tell you the amount of times that

932
00:32:04,230 --> 00:32:09,540
I have used my lab on the engagement to

933
00:32:07,350 --> 00:32:12,000
produce better results say for example

934
00:32:09,540 --> 00:32:20,639
this I don't I hope you guys can see

935
00:32:12,000 --> 00:32:23,370
that so this is my shoot that's not open

936
00:32:20,640 --> 00:32:26,580
nope alright use empty my word for it so

937
00:32:23,370 --> 00:32:28,770
this is all the window systems in my

938
00:32:26,580 --> 00:32:30,389
environment and what I'm doing is I'm

939
00:32:28,770 --> 00:32:32,160
looking at the system on event logs to

940
00:32:30,390 --> 00:32:34,200
see which processes are establishing

941
00:32:32,160 --> 00:32:35,880
connections out to the internet and on

942
00:32:34,200 --> 00:32:37,770
what frequency well why would this be

943
00:32:35,880 --> 00:32:39,480
useful because as a red teamer if I can

944
00:32:37,770 --> 00:32:41,790
get into one of those processes well

945
00:32:39,480 --> 00:32:44,309
that's that's more real looking right

946
00:32:41,790 --> 00:32:45,690
and so do that take that step of

947
00:32:44,309 --> 00:32:47,340
investing in the Splunk license

948
00:32:45,690 --> 00:32:49,320
seriously all you have to do is go out

949
00:32:47,340 --> 00:32:51,059
to spunks website and request the

950
00:32:49,320 --> 00:32:52,590
developer license right the the free

951
00:32:51,059 --> 00:32:54,270
license is 500 Meg's the developer

952
00:32:52,590 --> 00:32:55,889
license is 10 gigs a day and they'll

953
00:32:54,270 --> 00:32:57,690
give it to you because Long's awesome

954
00:32:55,890 --> 00:32:59,190
like that ok so go out there request

955
00:32:57,690 --> 00:33:00,840
that license is valid for six months and

956
00:32:59,190 --> 00:33:02,370
then you can import all the stuff and do

957
00:33:00,840 --> 00:33:04,199
your own research on this because this

958
00:33:02,370 --> 00:33:05,459
is what the defense is saying and once

959
00:33:04,200 --> 00:33:07,020
you know if the defense is sitting is

960
00:33:05,460 --> 00:33:09,000
saying you know how to manipulate it

961
00:33:07,020 --> 00:33:10,139
okay you know how to work around it and

962
00:33:09,000 --> 00:33:13,230
then you know how to help them with it

963
00:33:10,140 --> 00:33:17,250
all right tools let's get into a little

964
00:33:13,230 --> 00:33:18,059
bit of tooling on a red team okay so I'm

965
00:33:17,250 --> 00:33:19,980
gonna divide the room

966
00:33:18,059 --> 00:33:23,668
alright brace yourself this is what I

967
00:33:19,980 --> 00:33:26,190
almost never use on a red team crack map

968
00:33:23,669 --> 00:33:27,059
exec much as I love it I love it or

969
00:33:26,190 --> 00:33:29,220
cello you're awesome

970
00:33:27,059 --> 00:33:31,020
okay I love it internal brooding like I

971
00:33:29,220 --> 00:33:32,280
said I don't do it curb route might be

972
00:33:31,020 --> 00:33:34,168
an exception there if I think their

973
00:33:32,280 --> 00:33:36,178
defense is not going to catch that power

974
00:33:34,169 --> 00:33:37,679
sploit I've generally do not run much

975
00:33:36,179 --> 00:33:39,000
for PowerShell unless it's something

976
00:33:37,679 --> 00:33:40,740
that I've wrote that I know from a

977
00:33:39,000 --> 00:33:43,620
sysadmin perspective is relatively inert

978
00:33:40,740 --> 00:33:45,150
for example coring active directory I'm

979
00:33:43,620 --> 00:33:47,309
not gonna use Power View I will do

980
00:33:45,150 --> 00:33:49,970
something that I've written myself okay

981
00:33:47,309 --> 00:33:52,860
tools that I sometimes use on a red team

982
00:33:49,970 --> 00:33:54,809
bloodhound depending on the switches

983
00:33:52,860 --> 00:33:56,100
thank you to Scott and the bloodhound

984
00:33:54,809 --> 00:33:57,840
crew for pulling me up to speed there

985
00:33:56,100 --> 00:33:59,909
and not getting caught mess boy

986
00:33:57,840 --> 00:34:03,990
auxiliary modules are still fantastic to

987
00:33:59,910 --> 00:34:05,429
run run slowly modified me me cats and

988
00:34:03,990 --> 00:34:07,410
it's and by the way I don't mean like

989
00:34:05,429 --> 00:34:09,780
logon passwords please do not run that

990
00:34:07,410 --> 00:34:11,280
on your under my team please don't do

991
00:34:09,780 --> 00:34:13,619
that please don't start flipping the W

992
00:34:11,280 --> 00:34:15,119
digest keys don't do that you know just

993
00:34:13,619 --> 00:34:16,770
kind of pull back the reins on that

994
00:34:15,119 --> 00:34:18,929
because maybe Katz has so much more to

995
00:34:16,770 --> 00:34:21,690
offer than just log on passwords Carlos

996
00:34:18,929 --> 00:34:23,970
gave an incredible 2-day training on

997
00:34:21,690 --> 00:34:25,830
that just on me me cats like Mew cats

998
00:34:23,969 --> 00:34:27,209
and Kiki oh that's all it was okay and

999
00:34:25,830 --> 00:34:28,770
then cobalt strike obviously I'm not

1000
00:34:27,210 --> 00:34:30,899
running anything stock everything's

1001
00:34:28,770 --> 00:34:32,699
gonna be all modified malleable profiles

1002
00:34:30,899 --> 00:34:33,960
things like that okay and when I'm model

1003
00:34:32,699 --> 00:34:36,060
first FYI when I modify

1004
00:34:33,960 --> 00:34:38,750
my COBOL straight profile I go out to

1005
00:34:36,060 --> 00:34:41,639
rafts blog and I grab every single

1006
00:34:38,750 --> 00:34:43,800
attribute that I have and modify every

1007
00:34:41,639 --> 00:34:45,720
single one okay so I will go out to and

1008
00:34:43,800 --> 00:34:47,730
I will make an authenticated call out to

1009
00:34:45,719 --> 00:34:50,279
a service that I sign up for okay so

1010
00:34:47,730 --> 00:34:52,918
like me personally I like health so for

1011
00:34:50,280 --> 00:34:53,849
example like my an old health insurance

1012
00:34:52,918 --> 00:34:55,440
provider or something like that that I

1013
00:34:53,849 --> 00:34:57,570
might still have an account for fire up

1014
00:34:55,440 --> 00:34:59,940
burp grab all that traffic and then I

1015
00:34:57,570 --> 00:35:02,970
configure the gets the posts the stagers

1016
00:34:59,940 --> 00:35:04,680
all to look very very close to that I do

1017
00:35:02,970 --> 00:35:06,899
not rely on automated tools for that I

1018
00:35:04,680 --> 00:35:08,819
liked I like handcrafted artisanal

1019
00:35:06,900 --> 00:35:11,730
farm-to-table malleable profiles that

1020
00:35:08,820 --> 00:35:18,510
way so that's how I like to do it okay

1021
00:35:11,730 --> 00:35:20,190
and then what I always use all right I'm

1022
00:35:18,510 --> 00:35:21,599
pretty much every engagement I'm gonna

1023
00:35:20,190 --> 00:35:23,010
be using these things all right I'm

1024
00:35:21,599 --> 00:35:24,630
gonna be using a socks proxy I'm gonna

1025
00:35:23,010 --> 00:35:26,250
be using proxy chains I'm gonna be using

1026
00:35:24,630 --> 00:35:30,420
LDAP search Kerberos manipulation and

1027
00:35:26,250 --> 00:35:33,089
literally anything from dirty on okay

1028
00:35:30,420 --> 00:35:35,070
however understand that those tools are

1029
00:35:33,089 --> 00:35:37,500
gonna be modified alright even in packet

1030
00:35:35,070 --> 00:35:39,720
and packet is fantastic impacted is one

1031
00:35:37,500 --> 00:35:41,400
of my favorite toolkits of all time I

1032
00:35:39,720 --> 00:35:43,348
just love it okay but I will still

1033
00:35:41,400 --> 00:35:45,180
modify it why because the defense can

1034
00:35:43,349 --> 00:35:46,589
see this stuff all right they can

1035
00:35:45,180 --> 00:35:48,450
actually see the parent process chain

1036
00:35:46,589 --> 00:35:49,349
when I fire W my exec that is what

1037
00:35:48,450 --> 00:35:52,319
they're seeing on the command line

1038
00:35:49,349 --> 00:35:55,020
they're seeing cmd.exe slash capital q

1039
00:35:52,320 --> 00:35:57,180
/c echo blah blah blah and it just looks

1040
00:35:55,020 --> 00:35:58,530
bad it looks like somebody just barked

1041
00:35:57,180 --> 00:36:00,180
all over the command line it's horrible

1042
00:35:58,530 --> 00:36:01,830
okay and it sticks out like a sore thumb

1043
00:36:00,180 --> 00:36:03,810
if you know what to look for

1044
00:36:01,830 --> 00:36:07,140
alright and so what will I do I'll go

1045
00:36:03,810 --> 00:36:09,690
into the script and I will modify the

1046
00:36:07,140 --> 00:36:11,400
the command switches if I'm feeling

1047
00:36:09,690 --> 00:36:14,040
adventurous I'll try and modify the

1048
00:36:11,400 --> 00:36:15,690
communications okay but I will change

1049
00:36:14,040 --> 00:36:17,580
every almost everything that I can

1050
00:36:15,690 --> 00:36:18,900
change about the tool all right and

1051
00:36:17,580 --> 00:36:20,759
here's the good news about that as a red

1052
00:36:18,900 --> 00:36:23,220
teamer what that will do is that will

1053
00:36:20,760 --> 00:36:25,260
lead you to writing better detections

1054
00:36:23,220 --> 00:36:27,299
for your own stuff for example I wrote

1055
00:36:25,260 --> 00:36:29,339
this for impacting this is spun query

1056
00:36:27,300 --> 00:36:31,140
that detects about three or four

1057
00:36:29,339 --> 00:36:33,810
impacted tools that are just you know

1058
00:36:31,140 --> 00:36:35,339
stock and that's great because if I can

1059
00:36:33,810 --> 00:36:37,140
detect it then I know what I can change

1060
00:36:35,339 --> 00:36:38,400
and this is the the greater loop that I

1061
00:36:37,140 --> 00:36:41,220
think he blogged about or talked about

1062
00:36:38,400 --> 00:36:42,270
right you you write better detection so

1063
00:36:41,220 --> 00:36:44,279
you know what you have to change you can

1064
00:36:42,270 --> 00:36:46,230
write better tools all right and that

1065
00:36:44,280 --> 00:36:47,340
loop is priceless as a red teamer if

1066
00:36:46,230 --> 00:36:48,810
you're not doing that

1067
00:36:47,340 --> 00:36:50,100
if you're not modifying tools and then

1068
00:36:48,810 --> 00:36:51,810
the writing detections for that so you

1069
00:36:50,100 --> 00:36:53,940
can change the tool you're missing out

1070
00:36:51,810 --> 00:36:55,620
on actually a lot of fun it's a lot of

1071
00:36:53,940 --> 00:36:57,480
fun because that why do we do red

1072
00:36:55,620 --> 00:36:59,370
teaming it's a puzzle right why do blue

1073
00:36:57,480 --> 00:37:01,140
teamers blue well it's a puzzle we like

1074
00:36:59,370 --> 00:37:02,670
we like to solve puzzles all right and

1075
00:37:01,140 --> 00:37:03,839
this is a really fun puzzle and a really

1076
00:37:02,670 --> 00:37:06,330
fun challenge to solve so I encourage

1077
00:37:03,840 --> 00:37:08,400
you to give a shot okay even if you're

1078
00:37:06,330 --> 00:37:09,930
low privileged on a target there's still

1079
00:37:08,400 --> 00:37:11,610
some awesome stuff that you can do that

1080
00:37:09,930 --> 00:37:12,600
involves me me cats okay if you're

1081
00:37:11,610 --> 00:37:13,980
reasonably certain that you're not gonna

1082
00:37:12,600 --> 00:37:15,089
get caught you can run me me cast it's

1083
00:37:13,980 --> 00:37:16,710
not going to target else ass because

1084
00:37:15,090 --> 00:37:19,440
you're not running log on passwords

1085
00:37:16,710 --> 00:37:21,630
which you are running is DP API to hit

1086
00:37:19,440 --> 00:37:23,040
the chrome process okay so you make a

1087
00:37:21,630 --> 00:37:24,900
copy of the login data because that's

1088
00:37:23,040 --> 00:37:26,850
where the the plaintext and it's not

1089
00:37:24,900 --> 00:37:29,310
plain taps is DP API so that's where the

1090
00:37:26,850 --> 00:37:31,410
current roles are stored you make a copy

1091
00:37:29,310 --> 00:37:33,240
and then you fire me me cats at it and

1092
00:37:31,410 --> 00:37:34,890
you can pull plaintext credentials back

1093
00:37:33,240 --> 00:37:36,540
and when I say plain to exercise I

1094
00:37:34,890 --> 00:37:37,859
should say decrypted okay you pull those

1095
00:37:36,540 --> 00:37:39,360
krandalls back to the screen and

1096
00:37:37,860 --> 00:37:41,490
whatever the user has stored in chrome

1097
00:37:39,360 --> 00:37:42,990
you now have access to sometimes it's a

1098
00:37:41,490 --> 00:37:44,700
lot of personal stuff all right but

1099
00:37:42,990 --> 00:37:46,410
sometimes it's a lot of corporate stuff

1100
00:37:44,700 --> 00:37:48,149
especially if they have chrome rolled

1101
00:37:46,410 --> 00:37:49,680
out so there's very very useful to do

1102
00:37:48,150 --> 00:37:52,260
that and you can do it as a little

1103
00:37:49,680 --> 00:37:53,700
privileged user if you do not want to

1104
00:37:52,260 --> 00:37:55,740
fire me me cats in the targets memory

1105
00:37:53,700 --> 00:37:58,620
understandable you save off the cookies

1106
00:37:55,740 --> 00:38:01,470
file or the login datas file you acquire

1107
00:37:58,620 --> 00:38:03,390
the users password and I mean this it's

1108
00:38:01,470 --> 00:38:04,830
not not too hard to do red teamers right

1109
00:38:03,390 --> 00:38:06,810
my last engagement my physical guy

1110
00:38:04,830 --> 00:38:08,310
called up someone it was like hey I'm

1111
00:38:06,810 --> 00:38:10,710
closing on helpdesk tickets do you have

1112
00:38:08,310 --> 00:38:12,210
any open ones and like ah the printer I

1113
00:38:10,710 --> 00:38:13,890
hate the printer blah blah blah just

1114
00:38:12,210 --> 00:38:15,390
went on and on about the printer my guy

1115
00:38:13,890 --> 00:38:16,980
was like yeah the printers are awful

1116
00:38:15,390 --> 00:38:18,420
here and you know it's not a big deal

1117
00:38:16,980 --> 00:38:19,740
but I will take care of all that for you

1118
00:38:18,420 --> 00:38:20,280
I just have to verify you are who you

1119
00:38:19,740 --> 00:38:22,830
say you are

1120
00:38:20,280 --> 00:38:25,020
oh yeah sure my password password 1 2 3

1121
00:38:22,830 --> 00:38:26,850
it's it's actually not that hard easy

1122
00:38:25,020 --> 00:38:29,820
password alright follow steps here for

1123
00:38:26,850 --> 00:38:33,060
decrypting the use of DP API keys and

1124
00:38:29,820 --> 00:38:35,880
here is on wills blog here this was a

1125
00:38:33,060 --> 00:38:37,590
ton of fun I his entire blog went

1126
00:38:35,880 --> 00:38:40,050
through it step by step and learned a

1127
00:38:37,590 --> 00:38:41,580
ton about DP API I would strongly

1128
00:38:40,050 --> 00:38:45,590
encourage you to do that it's a it's a

1129
00:38:41,580 --> 00:38:48,810
worthwhile exercise to do ok persistence

1130
00:38:45,590 --> 00:38:52,050
and and movement for persistence

1131
00:38:48,810 --> 00:38:55,320
honestly just really anything that's on

1132
00:38:52,050 --> 00:38:57,660
hex the corns website you just target HK

1133
00:38:55,320 --> 00:38:59,070
Cu and there's all kinds of just

1134
00:38:57,660 --> 00:39:00,690
fantastic stuff some of it is like

1135
00:38:59,070 --> 00:39:03,599
really third-party

1136
00:39:00,690 --> 00:39:06,690
civic some of it is fantastic that that

1137
00:39:03,599 --> 00:39:08,510
I that I love using so if you're not an

1138
00:39:06,690 --> 00:39:11,040
avid reader of hexa corn you should be

1139
00:39:08,510 --> 00:39:12,720
common DLL hijacking there's a fantastic

1140
00:39:11,040 --> 00:39:14,940
talk that was given I think this morning

1141
00:39:12,720 --> 00:39:16,980
about comm hijacking I really went into

1142
00:39:14,940 --> 00:39:18,960
the nuts and bolts of it and even how to

1143
00:39:16,980 --> 00:39:20,310
weaponize it with a calm proxy and that

1144
00:39:18,960 --> 00:39:21,540
is that's super important otherwise

1145
00:39:20,310 --> 00:39:23,880
you're going to fubar the environment

1146
00:39:21,540 --> 00:39:26,430
proc monitors your is your absolute best

1147
00:39:23,880 --> 00:39:28,829
friend there Wow even got a bullet point

1148
00:39:26,430 --> 00:39:30,810
on comm proxy okay so read the article

1149
00:39:28,829 --> 00:39:33,810
from from leo he did an incredible job

1150
00:39:30,810 --> 00:39:35,609
on that and what will get you into proc

1151
00:39:33,810 --> 00:39:37,859
saying calm calls so you don't break the

1152
00:39:35,609 --> 00:39:39,540
system because truthfully come hijacking

1153
00:39:37,859 --> 00:39:41,910
well it's cool and say it's it's sexy it

1154
00:39:39,540 --> 00:39:43,710
can be a little risky to do on a target

1155
00:39:41,910 --> 00:39:46,348
environment because you can trash the

1156
00:39:43,710 --> 00:39:48,540
system if you pick the wrong class ID so

1157
00:39:46,349 --> 00:39:49,950
do your testing use a comm proxy and

1158
00:39:48,540 --> 00:39:53,569
you're in a much safer position for

1159
00:39:49,950 --> 00:39:55,980
weaponization alright and then blend in

1160
00:39:53,569 --> 00:39:59,009
blending in that's kind of more of an

1161
00:39:55,980 --> 00:40:00,569
art than a science right so like this

1162
00:39:59,010 --> 00:40:02,670
and this is again where Splunk is

1163
00:40:00,569 --> 00:40:05,550
amazing so we talked about blending in

1164
00:40:02,670 --> 00:40:06,990
so on a target system that's runs Splunk

1165
00:40:05,550 --> 00:40:09,960
universe before i'm gonna pick on spawn

1166
00:40:06,990 --> 00:40:11,790
for just a minute okay the these sub

1167
00:40:09,960 --> 00:40:13,770
processes for Splunk like spunk -

1168
00:40:11,790 --> 00:40:15,690
powershell and spunk - a-team on and

1169
00:40:13,770 --> 00:40:20,009
spunk - in that mod they run every

1170
00:40:15,690 --> 00:40:21,750
minute they pollute the the security log

1171
00:40:20,010 --> 00:40:25,020
with 46 eighty eight's that meet that

1172
00:40:21,750 --> 00:40:27,270
that kick off this starting process okay

1173
00:40:25,020 --> 00:40:30,509
so if this process is running all the

1174
00:40:27,270 --> 00:40:32,759
time all the time it's kind of a safe

1175
00:40:30,510 --> 00:40:35,970
bet kind of it's safer than not doing

1176
00:40:32,760 --> 00:40:38,790
it's kind of a safe bet that if you take

1177
00:40:35,970 --> 00:40:40,770
your naughty process and make it one of

1178
00:40:38,790 --> 00:40:42,869
those processes that have probably been

1179
00:40:40,770 --> 00:40:45,119
excluded from Splunk congestion then

1180
00:40:42,869 --> 00:40:46,800
chances are you're a little bit safer

1181
00:40:45,119 --> 00:40:49,470
alright you're not gonna get caught at

1182
00:40:46,800 --> 00:40:51,510
least not as fast okay and so now

1183
00:40:49,470 --> 00:40:52,709
obviously I'm picking on spunk here you

1184
00:40:51,510 --> 00:40:54,990
need to have an race to do this stuff I

1185
00:40:52,710 --> 00:40:55,980
mean I'm I'm not gonna be s you you know

1186
00:40:54,990 --> 00:40:57,240
in order to do this kind of stuff you

1187
00:40:55,980 --> 00:40:58,800
have to have an admin presence on the

1188
00:40:57,240 --> 00:41:00,868
system because spunk actually did a good

1189
00:40:58,800 --> 00:41:02,460
job locking down the privileges on their

1190
00:41:00,869 --> 00:41:04,380
target directory but the point is is

1191
00:41:02,460 --> 00:41:06,720
that if you see processes running

1192
00:41:04,380 --> 00:41:07,500
continuously on a target system find one

1193
00:41:06,720 --> 00:41:09,359
of those processes

1194
00:41:07,500 --> 00:41:11,670
stick your payload into that directory

1195
00:41:09,359 --> 00:41:12,990
rename it or just call it that name in

1196
00:41:11,670 --> 00:41:15,040
another directory because if they're

1197
00:41:12,990 --> 00:41:17,470
excluding that process only by

1198
00:41:15,040 --> 00:41:18,190
name and not by path you you're not

1199
00:41:17,470 --> 00:41:21,520
gonna get caught

1200
00:41:18,190 --> 00:41:23,200
all right deal a hijacking still awesome

1201
00:41:21,520 --> 00:41:24,310
I sat down I opened a proc Mon I just

1202
00:41:23,200 --> 00:41:27,009
kind of monkey with spunk for a little

1203
00:41:24,310 --> 00:41:28,480
bit and there's like there's like a ton

1204
00:41:27,010 --> 00:41:29,650
of calls in the spunk Universal

1205
00:41:28,480 --> 00:41:31,630
forwarder where's its name mouth found

1206
00:41:29,650 --> 00:41:33,280
and you can just kind of you know pick

1207
00:41:31,630 --> 00:41:34,930
your deal all poison and just mess with

1208
00:41:33,280 --> 00:41:36,340
it again you need ever right for this so

1209
00:41:34,930 --> 00:41:37,660
I mean it's you know your mouth as my

1210
00:41:36,340 --> 00:41:39,640
very but point being is that deal

1211
00:41:37,660 --> 00:41:42,759
hijacking is still very valid and

1212
00:41:39,640 --> 00:41:44,680
because the it's not like cmd.exe

1213
00:41:42,760 --> 00:41:46,390
calling this process it's a legitimate

1214
00:41:44,680 --> 00:41:48,339
process that's probably been whitelisted

1215
00:41:46,390 --> 00:41:50,589
calling that you're probably safer to do

1216
00:41:48,340 --> 00:41:54,310
that so difficult to detect okay come

1217
00:41:50,590 --> 00:41:57,700
hijack in just a little bit this was fun

1218
00:41:54,310 --> 00:42:01,390
the the the si host process anyone know

1219
00:41:57,700 --> 00:42:04,180
what the si host process does see so the

1220
00:42:01,390 --> 00:42:08,170
SI host process in Windows 7 and Windows

1221
00:42:04,180 --> 00:42:11,529
10 is responsible for looking at Windows

1222
00:42:08,170 --> 00:42:14,020
activation status and so right when when

1223
00:42:11,530 --> 00:42:15,220
we were when we were giving our blackhat

1224
00:42:14,020 --> 00:42:19,150
training two years ago we were using a

1225
00:42:15,220 --> 00:42:20,049
Windows 7 image and I I kind of I turned

1226
00:42:19,150 --> 00:42:21,550
the students loose for the comm

1227
00:42:20,050 --> 00:42:22,930
hijacking modular I'm like I just find

1228
00:42:21,550 --> 00:42:24,730
something awesome just go to town

1229
00:42:22,930 --> 00:42:25,960
because they get super excited and they

1230
00:42:24,730 --> 00:42:28,260
tell me what the class that these are

1231
00:42:25,960 --> 00:42:30,490
it's great don't tell them that okay so

1232
00:42:28,260 --> 00:42:32,020
but then what they do is they find

1233
00:42:30,490 --> 00:42:34,600
something like this in the si hos

1234
00:42:32,020 --> 00:42:37,390
process okay name not found and and they

1235
00:42:34,600 --> 00:42:39,670
stick a comm hijack in there well what

1236
00:42:37,390 --> 00:42:41,529
happens that when Windows boots up you

1237
00:42:39,670 --> 00:42:42,520
ever use the trial version of Windows as

1238
00:42:41,530 --> 00:42:43,840
always says in the lower right hand

1239
00:42:42,520 --> 00:42:45,880
corner says you know you must activate

1240
00:42:43,840 --> 00:42:47,650
Windows right so a student came up to me

1241
00:42:45,880 --> 00:42:48,940
all excited and he's like hey I found

1242
00:42:47,650 --> 00:42:50,920
this comma hijacking this pro in this

1243
00:42:48,940 --> 00:42:52,390
process called si host and I really know

1244
00:42:50,920 --> 00:42:56,290
what it does but I don't get prompted to

1245
00:42:52,390 --> 00:42:58,569
activate Windows anymore uh I was like

1246
00:42:56,290 --> 00:42:59,800
are you kidding me and I went over to

1247
00:42:58,570 --> 00:43:02,140
his system and sure enough the message

1248
00:42:59,800 --> 00:43:03,580
was gone and and so I was like alright

1249
00:43:02,140 --> 00:43:05,680
well I was it's Windows 7 you could

1250
00:43:03,580 --> 00:43:08,230
hijack anything in Windows 7 right so so

1251
00:43:05,680 --> 00:43:10,720
we changed over to Windows 10 for for a

1252
00:43:08,230 --> 00:43:12,090
black hat a month ago and and I told the

1253
00:43:10,720 --> 00:43:15,009
story and a students up to me is like

1254
00:43:12,090 --> 00:43:17,110
still works in Windows 10 I still do it

1255
00:43:15,010 --> 00:43:22,120
and I was like sweet free windows right

1256
00:43:17,110 --> 00:43:26,540
you know that's great alright so

1257
00:43:22,120 --> 00:43:30,330
reporting all right

1258
00:43:26,540 --> 00:43:31,650
Hey reporting communication okay

1259
00:43:30,330 --> 00:43:34,190
I'm gonna divide the room a little bit

1260
00:43:31,650 --> 00:43:38,480
once again it's my methodology all right

1261
00:43:34,190 --> 00:43:41,970
on status updates to clients use caution

1262
00:43:38,480 --> 00:43:44,670
okay this can bite you and it has bitten

1263
00:43:41,970 --> 00:43:47,009
us a lot all right and that's not to say

1264
00:43:44,670 --> 00:43:50,880
that you should lie I am NOT saying that

1265
00:43:47,010 --> 00:43:53,130
what I am saying is that you need to

1266
00:43:50,880 --> 00:43:55,770
take a us on the client because some

1267
00:43:53,130 --> 00:43:57,359
clients are amazing and some want to win

1268
00:43:55,770 --> 00:43:58,710
and that's not the point of the

1269
00:43:57,359 --> 00:43:59,910
engagement it's not for the red team to

1270
00:43:58,710 --> 00:44:01,650
win it's not for the blue team to win

1271
00:43:59,910 --> 00:44:03,029
right it's the test controls and make

1272
00:44:01,650 --> 00:44:05,060
recommendations based on your findings

1273
00:44:03,030 --> 00:44:08,369
all right this is it's not necessarily a

1274
00:44:05,060 --> 00:44:10,440
game or a contest all right and so when

1275
00:44:08,369 --> 00:44:12,180
I share status updates if I think that

1276
00:44:10,440 --> 00:44:14,160
my client is gonna snipe me with this

1277
00:44:12,180 --> 00:44:15,000
I'll just be like yeah you know we had a

1278
00:44:14,160 --> 00:44:16,680
great weekend

1279
00:44:15,000 --> 00:44:18,390
ransom port scanning and you know I've

1280
00:44:16,680 --> 00:44:19,319
seen a lot of great controls and you

1281
00:44:18,390 --> 00:44:21,259
know normally that's just kind of a

1282
00:44:19,320 --> 00:44:23,369
response and needs to go back to a

1283
00:44:21,260 --> 00:44:25,470
committee or something like that if I

1284
00:44:23,369 --> 00:44:29,460
can tell the client loves security and

1285
00:44:25,470 --> 00:44:30,689
wants either wants us to find new attack

1286
00:44:29,460 --> 00:44:32,040
paths or things like that I'll tell them

1287
00:44:30,690 --> 00:44:33,599
everything that we're doing but the

1288
00:44:32,040 --> 00:44:35,369
point being is that I use caution I

1289
00:44:33,599 --> 00:44:38,330
don't just go into it like well ran me

1290
00:44:35,369 --> 00:44:41,700
me cats got da you know it's like I

1291
00:44:38,330 --> 00:44:43,890
don't necessarily do that all right in

1292
00:44:41,700 --> 00:44:45,960
the report that is where everything goes

1293
00:44:43,890 --> 00:44:48,330
everything and by everything I mean

1294
00:44:45,960 --> 00:44:50,099
everything especially in the narrative

1295
00:44:48,330 --> 00:44:52,140
because when working with clients and

1296
00:44:50,099 --> 00:44:53,550
doing a red team this is not you know

1297
00:44:52,140 --> 00:44:55,259
your Grandpa's pen test where it's just

1298
00:44:53,550 --> 00:44:57,000
like okay take findings give to audit

1299
00:44:55,260 --> 00:44:58,260
committee I take things that give them

1300
00:44:57,000 --> 00:44:59,580
to the engineer and then the engineer

1301
00:44:58,260 --> 00:45:01,530
does that it's not it's not that

1302
00:44:59,580 --> 00:45:03,630
generally speaking and doing red team's

1303
00:45:01,530 --> 00:45:07,260
you're working with interested clients

1304
00:45:03,630 --> 00:45:08,640
okay and so the in my experience the

1305
00:45:07,260 --> 00:45:10,349
findings are important but they're

1306
00:45:08,640 --> 00:45:12,089
important from an audit perspective the

1307
00:45:10,349 --> 00:45:14,099
the security team who wants the

1308
00:45:12,089 --> 00:45:15,720
narrative that's what they want and they

1309
00:45:14,099 --> 00:45:18,000
want everything spelled out and they

1310
00:45:15,720 --> 00:45:19,950
should and I encourage security teams to

1311
00:45:18,000 --> 00:45:21,510
actively break down every part of the

1312
00:45:19,950 --> 00:45:22,560
engagement because that that's which

1313
00:45:21,510 --> 00:45:25,560
should be done to develop better

1314
00:45:22,560 --> 00:45:27,810
detection and so do not withhold the

1315
00:45:25,560 --> 00:45:29,549
secret sauce in the report

1316
00:45:27,810 --> 00:45:31,710
please don't okay gives everyone a black

1317
00:45:29,550 --> 00:45:33,089
guy don't do it all right findings I

1318
00:45:31,710 --> 00:45:34,770
tell my clients this out of the gate

1319
00:45:33,089 --> 00:45:37,529
every single time we kick off a red team

1320
00:45:34,770 --> 00:45:39,970
do I'm not gonna give you an ssl fine oh

1321
00:45:37,530 --> 00:45:42,130
no SSL version two I'm

1322
00:45:39,970 --> 00:45:44,410
not gonna do that okay unless I unless I

1323
00:45:42,130 --> 00:45:46,180
actively exploited somehow alright at

1324
00:45:44,410 --> 00:45:47,618
the findings that I can that I'm going

1325
00:45:46,180 --> 00:45:50,140
to give are probably going to be fewer

1326
00:45:47,619 --> 00:45:52,359
in number higher in quality and but what

1327
00:45:50,140 --> 00:45:54,790
I mean by that is they are going to be

1328
00:45:52,359 --> 00:45:56,590
directly connected to the path of

1329
00:45:54,790 --> 00:45:59,290
exploitation or the path of compromise

1330
00:45:56,590 --> 00:46:01,119
okay so that's that's my personal

1331
00:45:59,290 --> 00:46:02,950
methodology for giving findings so far

1332
00:46:01,119 --> 00:46:05,440
it's worked very well all right and then

1333
00:46:02,950 --> 00:46:07,689
consultants this is the best seriously

1334
00:46:05,440 --> 00:46:09,880
if you're not doing this if you're just

1335
00:46:07,690 --> 00:46:11,290
shipping a report and then moving on or

1336
00:46:09,880 --> 00:46:13,030
it's an ear steak house okay you're

1337
00:46:11,290 --> 00:46:15,970
you're you're you're doing it wrong

1338
00:46:13,030 --> 00:46:17,560
alright the best moments are when you

1339
00:46:15,970 --> 00:46:20,470
followup with the defense and the way

1340
00:46:17,560 --> 00:46:22,390
that I always end my my last call with

1341
00:46:20,470 --> 00:46:24,250
the cut with with my client is I use a

1342
00:46:22,390 --> 00:46:26,529
system like this I will never ever leave

1343
00:46:24,250 --> 00:46:28,090
you hanging out on a limb if you have

1344
00:46:26,530 --> 00:46:29,740
questions about the report if something

1345
00:46:28,090 --> 00:46:30,880
isn't answered if somebody puts your

1346
00:46:29,740 --> 00:46:31,839
feet to the fire they want to know how

1347
00:46:30,880 --> 00:46:33,910
Jason did this or this

1348
00:46:31,840 --> 00:46:35,740
just call me call text signal email

1349
00:46:33,910 --> 00:46:36,759
anything and I will be there I will get

1350
00:46:35,740 --> 00:46:39,040
on the phone with schedule a meeting

1351
00:46:36,760 --> 00:46:41,440
I've flown out to clients and then in

1352
00:46:39,040 --> 00:46:43,540
person debriefs point being is that

1353
00:46:41,440 --> 00:46:45,790
always be there for the defense and when

1354
00:46:43,540 --> 00:46:47,380
you do that report read out and and you

1355
00:46:45,790 --> 00:46:49,089
start to see the light bulbs go on there

1356
00:46:47,380 --> 00:46:51,550
is no feeling there there is no shell

1357
00:46:49,089 --> 00:46:54,970
that produces that kind of high okay so

1358
00:46:51,550 --> 00:46:56,980
do not withhold when it comes to giving

1359
00:46:54,970 --> 00:46:58,480
the defense all of the goods that you

1360
00:46:56,980 --> 00:47:01,270
have because that's that's frankly what

1361
00:46:58,480 --> 00:47:03,480
you're being paid to do okay that's it

1362
00:47:01,270 --> 00:47:03,480
folks

1363
00:47:04,060 --> 00:47:06,449
[Applause]

