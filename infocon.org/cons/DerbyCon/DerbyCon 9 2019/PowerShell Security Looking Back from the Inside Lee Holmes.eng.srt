1
00:00:00,000 --> 00:00:08,370
the unofficial closing ceremonies of the

2
00:00:03,810 --> 00:00:10,160
unofficial derbycon security con so this

3
00:00:08,370 --> 00:00:12,018
is going to be a bit of an interesting

4
00:00:10,160 --> 00:00:14,730
discussion it's a different presentation

5
00:00:12,019 --> 00:00:17,759
than we've used to having it at most

6
00:00:14,730 --> 00:00:22,800
security conference talks this is going

7
00:00:17,760 --> 00:00:25,320
to be a retrospective and it's one that

8
00:00:22,800 --> 00:00:29,760
I feel really privileged in in joining

9
00:00:25,320 --> 00:00:34,590
you all in its a retrospective because

10
00:00:29,760 --> 00:00:38,520
this year puts a bow on the wonderful

11
00:00:34,590 --> 00:00:40,559
thing that is Derby con Derby con has

12
00:00:38,520 --> 00:00:44,280
changed the lives of thousands of people

13
00:00:40,559 --> 00:00:46,410
and I know for a fact that each year

14
00:00:44,280 --> 00:00:48,649
that I've come has made me a better

15
00:00:46,410 --> 00:00:48,648
person

16
00:00:49,280 --> 00:00:56,610
in 2010 Dave and win Fang went to Vegas

17
00:00:55,469 --> 00:01:02,430
with a message

18
00:00:56,610 --> 00:01:04,938
PowerShell oh my god it's amazing this

19
00:01:02,430 --> 00:01:08,490
was for all intents and purposes

20
00:01:04,938 --> 00:01:11,130
derbycon zero this was a slide from

21
00:01:08,490 --> 00:01:16,320
their talk introducing derbycon one

22
00:01:11,130 --> 00:01:18,390
which is upcoming in the nine years

23
00:01:16,320 --> 00:01:20,699
since Derby con has become the

24
00:01:18,390 --> 00:01:23,640
unofficial powershell security

25
00:01:20,700 --> 00:01:25,500
conference and as the good parts of this

26
00:01:23,640 --> 00:01:29,759
industry have become aware of power

27
00:01:25,500 --> 00:01:34,470
shells novelty so have the bad this has

28
00:01:29,759 --> 00:01:36,570
been a very interesting decade so as a

29
00:01:34,470 --> 00:01:38,850
fitting close to the unofficial

30
00:01:36,570 --> 00:01:40,740
powershell security conference we're

31
00:01:38,850 --> 00:01:43,199
going to take a journey and look back

32
00:01:40,740 --> 00:01:44,309
from the inside you've all seen all the

33
00:01:43,200 --> 00:01:45,950
stuff from the outside but we're going

34
00:01:44,310 --> 00:01:48,090
to take a look back from the inside

35
00:01:45,950 --> 00:01:50,670
you're going to find out about when we

36
00:01:48,090 --> 00:01:55,579
laughed when we cried we've got a chance

37
00:01:50,670 --> 00:01:55,579
to share some I five s right

38
00:01:57,580 --> 00:02:04,420
but this is not only a retrospective

39
00:02:00,810 --> 00:02:07,360
there are three main themes that I think

40
00:02:04,420 --> 00:02:10,270
have made the underpinnings of this

41
00:02:07,360 --> 00:02:13,110
amazing time and these things give me

42
00:02:10,270 --> 00:02:13,110
hope for the future

43
00:02:14,100 --> 00:02:21,600
optimism wins be open and enjoy the

44
00:02:19,420 --> 00:02:21,600
journey

45
00:02:25,240 --> 00:02:31,660
you probably don't recognize this guy

46
00:02:27,750 --> 00:02:36,640
but you might in 30 years

47
00:02:31,660 --> 00:02:38,740
this is my dad by the way when I asked

48
00:02:36,640 --> 00:02:40,660
if I could include a OPSEC and stuff if

49
00:02:38,740 --> 00:02:43,360
I could include a picture of him at a

50
00:02:40,660 --> 00:02:50,019
conference he's like yeah sure he sends

51
00:02:43,360 --> 00:02:52,870
me this so when I was a kid I got

52
00:02:50,020 --> 00:02:55,090
seriously interested in computers at

53
00:02:52,870 --> 00:02:58,090
some point my dad's work let him take

54
00:02:55,090 --> 00:03:00,190
out a interest-free loan on one at the

55
00:02:58,090 --> 00:03:03,370
time was a very very expensive personal

56
00:03:00,190 --> 00:03:07,240
computer so I started getting interested

57
00:03:03,370 --> 00:03:09,550
in bulletin boards and my dad wanting to

58
00:03:07,240 --> 00:03:10,150
support my interest in computers we had

59
00:03:09,550 --> 00:03:12,250
an agreement

60
00:03:10,150 --> 00:03:15,280
I could run the bulletin board from 9

61
00:03:12,250 --> 00:03:17,410
p.m. until 7 a.m. I was thinking about

62
00:03:15,280 --> 00:03:19,420
it this week like I've never seen my

63
00:03:17,410 --> 00:03:21,549
daughter wake up at 7 a.m. but whatever

64
00:03:19,420 --> 00:03:23,500
I did it with enough time to turn it all

65
00:03:21,550 --> 00:03:26,500
down we'd get the occasional straight

66
00:03:23,500 --> 00:03:28,860
call but it it all worked out bulletin

67
00:03:26,500 --> 00:03:32,320
boards are what got me interested in

68
00:03:28,860 --> 00:03:34,510
security you had this strange new world

69
00:03:32,320 --> 00:03:37,060
of bulletin boards all these kind of

70
00:03:34,510 --> 00:03:39,549
people exploring the the magic in the

71
00:03:37,060 --> 00:03:43,440
edge cases in what we knew at that time

72
00:03:39,550 --> 00:03:43,440
were these new things called computers

73
00:03:44,620 --> 00:03:49,189
at one point I remember talking to my

74
00:03:47,659 --> 00:03:52,489
dad about this cool thing I was learning

75
00:03:49,189 --> 00:03:54,620
about called batch files so I tried I

76
00:03:52,489 --> 00:03:56,090
tried to explain it try to explain it

77
00:03:54,620 --> 00:04:00,200
and he was having a hard time getting it

78
00:03:56,090 --> 00:04:01,700
and you know it's like I don't know

79
00:04:00,200 --> 00:04:04,429
maybe he's age difference or something

80
00:04:01,700 --> 00:04:08,569
like that but one thing I did know for a

81
00:04:04,430 --> 00:04:10,310
fact he worked like crazy he had an

82
00:04:08,569 --> 00:04:14,179
amazing work ethic and he switched

83
00:04:10,310 --> 00:04:16,339
careers when he was like 50 one of the

84
00:04:14,180 --> 00:04:19,579
jobs he got was working maintenance at a

85
00:04:16,339 --> 00:04:21,560
community center and so one of the first

86
00:04:19,579 --> 00:04:24,320
jobs he had at the community center was

87
00:04:21,560 --> 00:04:27,500
waxing the floors and you've all seen

88
00:04:24,320 --> 00:04:29,659
what a what a gym floor and a community

89
00:04:27,500 --> 00:04:33,410
center looks like it's you know cloudy

90
00:04:29,660 --> 00:04:36,710
bumpy and thick so he started just doing

91
00:04:33,410 --> 00:04:38,419
the best he could and after a few months

92
00:04:36,710 --> 00:04:40,070
went by he started sharing pictures of

93
00:04:38,419 --> 00:04:43,219
these things and they were like they

94
00:04:40,070 --> 00:04:45,710
were just like perfect quality TV

95
00:04:43,220 --> 00:04:51,800
quality basketball courts he just took

96
00:04:45,710 --> 00:04:53,060
pride in everything he did so he started

97
00:04:51,800 --> 00:04:56,240
the best he could and learned more from

98
00:04:53,060 --> 00:04:58,550
it every week after a while after that

99
00:04:56,240 --> 00:05:02,330
he got a job at Kentucky Fried Chicken

100
00:04:58,550 --> 00:05:04,400
and again he went in there and he was

101
00:05:02,330 --> 00:05:06,260
kind of shocked at how that the kids

102
00:05:04,400 --> 00:05:08,239
were just really not keeping up with the

103
00:05:06,260 --> 00:05:10,400
quality that that you would expect in a

104
00:05:08,240 --> 00:05:11,599
job like this so he started doing

105
00:05:10,400 --> 00:05:13,969
everything he could he started

106
00:05:11,599 --> 00:05:15,889
freshening the oils making sure that the

107
00:05:13,970 --> 00:05:18,220
maintenance stuff was kept up on the

108
00:05:15,889 --> 00:05:20,900
right things he started really following

109
00:05:18,220 --> 00:05:22,760
very literal instructions that come from

110
00:05:20,900 --> 00:05:24,760
corporate office on how to cook chicken

111
00:05:22,760 --> 00:05:28,330
properly

112
00:05:24,760 --> 00:05:30,280
and after a while of this he started

113
00:05:28,330 --> 00:05:33,400
doing amazing things so he would plan

114
00:05:30,280 --> 00:05:36,489
these big batches to arrive just in time

115
00:05:33,400 --> 00:05:38,380
for these big P crushes and he figured

116
00:05:36,490 --> 00:05:39,730
it out enough so that there was just

117
00:05:38,380 --> 00:05:42,909
enough chicken so that there wasn't a

118
00:05:39,730 --> 00:05:46,150
time wasted at the end to now cause bad

119
00:05:42,910 --> 00:05:48,490
chicken for the next people all of these

120
00:05:46,150 --> 00:05:51,429
people in all of these rushes had the

121
00:05:48,490 --> 00:05:53,310
best freshest crispest juiciest chicken

122
00:05:51,430 --> 00:05:58,870
I've ever had

123
00:05:53,310 --> 00:06:00,330
it was amazing after that he started

124
00:05:58,870 --> 00:06:04,030
working maintenance at a big University

125
00:06:00,330 --> 00:06:06,159
and he started treating all those

126
00:06:04,030 --> 00:06:09,000
buildings at those universities like

127
00:06:06,160 --> 00:06:11,680
there there is a second set of children

128
00:06:09,000 --> 00:06:14,320
and one of the things he did as part of

129
00:06:11,680 --> 00:06:16,060
this was he just made sure that every

130
00:06:14,320 --> 00:06:21,490
time he went somewhere he did one little

131
00:06:16,060 --> 00:06:23,380
thing so he had to go from you know go

132
00:06:21,490 --> 00:06:24,940
from the tool shed to the dorms

133
00:06:23,380 --> 00:06:27,100
he'd makes sure if he saw a little

134
00:06:24,940 --> 00:06:29,040
sagging power faceplate somewhere down

135
00:06:27,100 --> 00:06:31,000
there he'd tighten it up along the way

136
00:06:29,040 --> 00:06:33,070
he had to go take out the garbage

137
00:06:31,000 --> 00:06:36,220
somewhere well he replaced a lightbulb

138
00:06:33,070 --> 00:06:38,440
along the way so after time went on it

139
00:06:36,220 --> 00:06:40,780
but this these things started being in

140
00:06:38,440 --> 00:06:42,730
clinically good shape you know he could

141
00:06:40,780 --> 00:06:45,340
walk through the halls and push open a

142
00:06:42,730 --> 00:06:49,080
door with one finger because that's all

143
00:06:45,340 --> 00:06:49,080
it required to do its job right

144
00:06:50,949 --> 00:06:56,650
now when it came to his intellectual

145
00:06:52,719 --> 00:06:59,919
curiosity one thing he loved to do was

146
00:06:56,650 --> 00:07:02,438
scan books into his computer so this was

147
00:06:59,919 --> 00:07:04,779
the day the early days of OCR where you

148
00:07:02,439 --> 00:07:09,039
had to spend days swiping down every

149
00:07:04,779 --> 00:07:10,719
page phase correcting errors but he did

150
00:07:09,039 --> 00:07:13,568
it and when he did it and he was done he

151
00:07:10,719 --> 00:07:15,039
had this folder full of these electronic

152
00:07:13,569 --> 00:07:17,139
documents and he loved it

153
00:07:15,039 --> 00:07:18,639
he said he could scan through and search

154
00:07:17,139 --> 00:07:20,949
through all of the stuff of all of his

155
00:07:18,639 --> 00:07:23,740
library and it was like having the

156
00:07:20,949 --> 00:07:26,020
universe at his fingertips he loved it

157
00:07:23,740 --> 00:07:27,610
so anyways this is the guy that I was

158
00:07:26,020 --> 00:07:31,330
having a hard time explaining batch

159
00:07:27,610 --> 00:07:33,099
files to so it's very clear that the

160
00:07:31,330 --> 00:07:35,859
topic was a lot more complicated than I

161
00:07:33,099 --> 00:07:38,139
thought it was and I wasn't a good

162
00:07:35,860 --> 00:07:41,710
enough communicator at that time to get

163
00:07:38,139 --> 00:07:43,750
the concepts through so anyways I kept

164
00:07:41,710 --> 00:07:48,008
up with computers I took them through

165
00:07:43,750 --> 00:07:51,819
high school and university which landed

166
00:07:48,009 --> 00:07:58,150
me at Microsoft my first job was at

167
00:07:51,819 --> 00:08:03,819
Encarta oh man you're like hey be

168
00:07:58,150 --> 00:08:05,859
smarter by now I thought I was going to

169
00:08:03,819 --> 00:08:09,580
be a genius working on an encyclopedia

170
00:08:05,860 --> 00:08:12,539
all day but the thing is you work so

171
00:08:09,580 --> 00:08:14,979
much on on like the code in the HTML

172
00:08:12,539 --> 00:08:16,330
that you just don't have those extra

173
00:08:14,979 --> 00:08:22,060
couple hours to spend reading

174
00:08:16,330 --> 00:08:24,580
encyclopedia articles all day but I did

175
00:08:22,060 --> 00:08:26,710
gain one skill I did work on the

176
00:08:24,580 --> 00:08:29,289
integration with the MSN homepage like

177
00:08:26,710 --> 00:08:34,019
all the time so I became a leading

178
00:08:29,289 --> 00:08:41,049
expert on celebrity pop culture

179
00:08:34,019 --> 00:08:43,360
spoiler alert he did so see that login

180
00:08:41,049 --> 00:08:45,729
button at the top that was the part that

181
00:08:43,360 --> 00:08:47,890
I mostly worked on it was the login

182
00:08:45,730 --> 00:08:52,450
flows and all the stuff related to that

183
00:08:47,890 --> 00:08:55,360
infrastructure we had you know tons and

184
00:08:52,450 --> 00:08:58,240
tons of asp.net XML the whole

185
00:08:55,360 --> 00:09:00,370
encyclopedia was backed by XML we had to

186
00:08:58,240 --> 00:09:04,000
write XSLT which is this brutal language

187
00:09:00,370 --> 00:09:08,740
to convert XML into HTML it was it was

188
00:09:04,000 --> 00:09:10,060
really interesting thing and of course

189
00:09:08,740 --> 00:09:12,220
in Encarta there was a lot of

190
00:09:10,060 --> 00:09:15,550
operational duty right it was a website

191
00:09:12,220 --> 00:09:18,399
in the early days and we ran in Carta on

192
00:09:15,550 --> 00:09:20,949
about 31 servers you might be thinking

193
00:09:18,399 --> 00:09:25,360
31 servers that sounds like amateur hour

194
00:09:20,950 --> 00:09:27,269
doesn't it so for some perspective if

195
00:09:25,360 --> 00:09:31,300
you take a look at Stack Overflow in

196
00:09:27,269 --> 00:09:36,070
2014 they ran their entire production

197
00:09:31,300 --> 00:09:37,599
workload on eight servers has changed a

198
00:09:36,070 --> 00:09:39,970
little bit since then

199
00:09:37,600 --> 00:09:42,160
but not by much they're one of the top

200
00:09:39,970 --> 00:09:44,649
serving traffic websites in the world

201
00:09:42,160 --> 00:09:47,529
and they handle it in you know a dozen

202
00:09:44,649 --> 00:09:49,120
or so servers it's a bit more with

203
00:09:47,529 --> 00:09:51,100
redundancy and whatever but in terms of

204
00:09:49,120 --> 00:09:56,880
the core workload it's pretty amazing

205
00:09:51,100 --> 00:09:59,380
how much you can do with little and so

206
00:09:56,880 --> 00:10:00,670
we kind of dealt with these issues of

207
00:09:59,380 --> 00:10:02,740
doing a lot with a little

208
00:10:00,670 --> 00:10:05,290
in Encarta so one of the things that in

209
00:10:02,740 --> 00:10:07,420
card I had was this really interesting

210
00:10:05,290 --> 00:10:10,990
kind of camel hump shape of traffic and

211
00:10:07,420 --> 00:10:13,390
so you'd have one hump at around 3

212
00:10:10,990 --> 00:10:15,100
o'clock p.m. and that kind of makes

213
00:10:13,390 --> 00:10:16,360
sense that's when all the kiddos are

214
00:10:15,100 --> 00:10:19,029
coming home from school doing their

215
00:10:16,360 --> 00:10:20,860
homework working on the encyclopedia but

216
00:10:19,029 --> 00:10:25,070
then you had another one that was at

217
00:10:20,860 --> 00:10:26,460
like 10:00 a.m. any idea why

218
00:10:25,070 --> 00:10:29,070
[Music]

219
00:10:26,460 --> 00:10:32,130
good guesses it wasn't Europe it wasn't

220
00:10:29,070 --> 00:10:33,950
lunch this is when all the parents would

221
00:10:32,130 --> 00:10:36,000
come home after dropping off their kids

222
00:10:33,950 --> 00:10:38,250
finally have some me time

223
00:10:36,000 --> 00:10:40,200
I have the chance to read through the

224
00:10:38,250 --> 00:10:43,500
encyclopedia and learn about stuff that

225
00:10:40,200 --> 00:10:44,640
interested them these were lifelong

226
00:10:43,500 --> 00:10:47,899
learners and it's something that

227
00:10:44,640 --> 00:10:47,899
impresses me to this day

228
00:10:47,959 --> 00:10:53,369
so balancing these two bimodal humps of

229
00:10:51,029 --> 00:10:56,370
traffic it was just it's Costin juggling

230
00:10:53,370 --> 00:10:59,370
act we would do things like co-locate

231
00:10:56,370 --> 00:11:01,440
the version of the UK version with the

232
00:10:59,370 --> 00:11:02,910
Japanese version so that the humps would

233
00:11:01,440 --> 00:11:05,339
arrive at different times and all this

234
00:11:02,910 --> 00:11:07,079
kind of stuff we could have of course

235
00:11:05,339 --> 00:11:09,330
put all of the content on although the

236
00:11:07,080 --> 00:11:12,180
servers and had just hundreds and

237
00:11:09,330 --> 00:11:14,250
hundreds of more servers because just

238
00:11:12,180 --> 00:11:15,899
the the disk overhead of all that

239
00:11:14,250 --> 00:11:19,290
localized content would have just cost

240
00:11:15,899 --> 00:11:21,450
just so many servers but we didn't what

241
00:11:19,290 --> 00:11:23,819
we worked on was optimization and this

242
00:11:21,450 --> 00:11:26,279
worked out really well but in getting

243
00:11:23,820 --> 00:11:27,750
interested in automation it was really

244
00:11:26,279 --> 00:11:30,209
clear to me that what I dreamt was

245
00:11:27,750 --> 00:11:32,070
automation at scale and what I later

246
00:11:30,209 --> 00:11:34,279
realized was something more like the

247
00:11:32,070 --> 00:11:34,279
cloud

248
00:11:35,230 --> 00:11:41,410
so while I was editing part uh there was

249
00:11:38,540 --> 00:11:44,149
this story on a website called slash dot

250
00:11:41,410 --> 00:11:46,459
and it was super cool I was reading

251
00:11:44,149 --> 00:11:48,560
slash shot and it's like hey there's a

252
00:11:46,459 --> 00:11:50,689
new show command shell coming out of

253
00:11:48,560 --> 00:11:53,300
Microsoft and as a quote what a rumor

254
00:11:50,689 --> 00:11:55,189
and it was like hold on a second I work

255
00:11:53,300 --> 00:11:58,490
at Microsoft I don't have to just read a

256
00:11:55,189 --> 00:12:00,439
slash top for rumors anymore so I

257
00:11:58,490 --> 00:12:02,720
reached out internally at Microsoft and

258
00:12:00,439 --> 00:12:05,240
I got ahold of this this thing and it

259
00:12:02,720 --> 00:12:08,899
was called monad and it was pretty cool

260
00:12:05,240 --> 00:12:11,449
it was super rough at the time it didn't

261
00:12:08,899 --> 00:12:13,850
have any commands to clear the screen it

262
00:12:11,449 --> 00:12:15,920
had one help file and that was I'm

263
00:12:13,850 --> 00:12:17,240
pretty sure was I copy and pasted from

264
00:12:15,920 --> 00:12:20,449
women or something just to show that

265
00:12:17,240 --> 00:12:22,009
there could be hope but at the time I

266
00:12:20,449 --> 00:12:24,378
saw how important this thing was going

267
00:12:22,009 --> 00:12:26,660
to be even at the very early stages I

268
00:12:24,379 --> 00:12:32,060
realize this is a thing that was going

269
00:12:26,660 --> 00:12:34,639
to change the world so I decided I need

270
00:12:32,060 --> 00:12:36,859
to join this team and at Microsoft at

271
00:12:34,639 --> 00:12:39,829
the time changing jobs used to be so

272
00:12:36,860 --> 00:12:41,689
scary things have changed in like

273
00:12:39,829 --> 00:12:47,599
incredibly good ways but they used to be

274
00:12:41,689 --> 00:12:49,519
brutal so for no real good reason the

275
00:12:47,600 --> 00:12:52,399
system the the performance management

276
00:12:49,519 --> 00:12:55,250
system was hyper competitive so it would

277
00:12:52,399 --> 00:12:57,290
happen was all managers were forced to

278
00:12:55,250 --> 00:13:00,079
rank all of their employees in a stack

279
00:12:57,290 --> 00:13:02,660
from worst to best this is gonna sound

280
00:13:00,079 --> 00:13:04,130
brutal and changed and it was brutal and

281
00:13:02,660 --> 00:13:07,459
what would happen is they had to force

282
00:13:04,130 --> 00:13:11,060
to allocate all of the rewards strictly

283
00:13:07,459 --> 00:13:13,099
according to that ranking reward the

284
00:13:11,060 --> 00:13:16,518
people at the top and work on letting go

285
00:13:13,100 --> 00:13:18,259
the people at the bottom like it again

286
00:13:16,519 --> 00:13:20,540
it's changed but that was what it was

287
00:13:18,259 --> 00:13:21,949
like at the time so if you were somebody

288
00:13:20,540 --> 00:13:24,199
that was looking for a new job and the

289
00:13:21,949 --> 00:13:26,120
manager knew but just think about how

290
00:13:24,199 --> 00:13:28,250
brutal this was it was of course brutal

291
00:13:26,120 --> 00:13:30,610
on employees but also think about the

292
00:13:28,250 --> 00:13:33,050
perverse incentive it puts on management

293
00:13:30,610 --> 00:13:34,220
so if they knew somebody wasn't happy

294
00:13:33,050 --> 00:13:35,899
and was looking for a new job

295
00:13:34,220 --> 00:13:37,779
of course what they're gonna do is like

296
00:13:35,899 --> 00:13:39,740
well then that person is the worst

297
00:13:37,779 --> 00:13:42,100
because the people who are staying are

298
00:13:39,740 --> 00:13:44,600
the ones that I want to keep on

299
00:13:42,100 --> 00:13:48,140
so that may looking for new jobs really

300
00:13:44,600 --> 00:13:50,149
hard but imagine it getting worse at

301
00:13:48,140 --> 00:13:53,750
Microsoft you had to ask permission

302
00:13:50,149 --> 00:13:55,190
before hiring for a new job and so what

303
00:13:53,750 --> 00:13:57,649
you had to do what people would do as a

304
00:13:55,190 --> 00:13:59,180
risk mitigation strategy is they would

305
00:13:57,649 --> 00:14:01,190
say can I have permission to interview

306
00:13:59,180 --> 00:14:02,270
and they're like this is basically my

307
00:14:01,190 --> 00:14:03,830
going-away party

308
00:14:02,270 --> 00:14:06,589
and then they would interview for like

309
00:14:03,830 --> 00:14:08,540
dozens of jobs because if just the hope

310
00:14:06,589 --> 00:14:09,860
that at least one of them will stick and

311
00:14:08,540 --> 00:14:14,990
they're not gonna get totally smoked

312
00:14:09,860 --> 00:14:18,920
that next year solely not being a smart

313
00:14:14,990 --> 00:14:22,370
person but a passionate person applied

314
00:14:18,920 --> 00:14:23,699
for one interview got one job and that

315
00:14:22,370 --> 00:14:26,859
was with the Monad gene

316
00:14:23,700 --> 00:14:26,859
[Music]

317
00:14:27,630 --> 00:14:32,819
so when I joined the team at that point

318
00:14:30,660 --> 00:14:36,480
there was a security engineer who was

319
00:14:32,819 --> 00:14:38,430
just working on leaving the team we were

320
00:14:36,480 --> 00:14:41,459
just starting to do some security work

321
00:14:38,430 --> 00:14:44,758
at the time and in the team knowing my

322
00:14:41,459 --> 00:14:46,560
security background said hey do you want

323
00:14:44,759 --> 00:14:47,970
to do security for this new thing and I

324
00:14:46,560 --> 00:14:51,930
was like hell yeah this is gonna be

325
00:14:47,970 --> 00:14:53,660
awesome so he focused on PowerShell

326
00:14:51,930 --> 00:14:56,160
security from the very very beginning

327
00:14:53,660 --> 00:14:58,259
because we knew that security was going

328
00:14:56,160 --> 00:15:00,839
to be important who has seen the impact

329
00:14:58,259 --> 00:15:03,360
of things like Melissa and I love you I

330
00:15:00,839 --> 00:15:06,149
love you and I love you we have seen the

331
00:15:03,360 --> 00:15:09,509
impact of these things so we set out

332
00:15:06,149 --> 00:15:11,370
about to do was from the outset start to

333
00:15:09,509 --> 00:15:13,920
do some security functionality to work

334
00:15:11,370 --> 00:15:16,529
on limiting it so we talked with the

335
00:15:13,920 --> 00:15:19,439
folks that did CMD the folks that did BB

336
00:15:16,529 --> 00:15:21,660
script the folks that did software

337
00:15:19,440 --> 00:15:22,980
restriction policies and windows we of

338
00:15:21,660 --> 00:15:26,130
course looked at all of the security

339
00:15:22,980 --> 00:15:27,720
best practices in UNIX and what would

340
00:15:26,130 --> 00:15:30,420
happen is you talk to so many of these

341
00:15:27,720 --> 00:15:32,250
people and they'd go what are you

342
00:15:30,420 --> 00:15:37,469
talking about like once somebody gets

343
00:15:32,250 --> 00:15:39,360
rude is game over but we knew that we've

344
00:15:37,470 --> 00:15:41,639
seen the impact of these things we

345
00:15:39,360 --> 00:15:43,259
couldn't accept that somebody getting

346
00:15:41,639 --> 00:15:46,010
root meant game over we had to do

347
00:15:43,259 --> 00:15:49,320
something what would you do

348
00:15:46,010 --> 00:15:49,319
[Music]

349
00:15:50,090 --> 00:15:56,000
so we invested anyways we associated

350
00:15:53,510 --> 00:15:57,950
PowerShell scripts with notepad so that

351
00:15:56,000 --> 00:16:01,430
people mistakingly double clicking don't

352
00:15:57,950 --> 00:16:04,550
launch one we associated PowerShell with

353
00:16:01,430 --> 00:16:07,729
the API in Windows that marks them as

354
00:16:04,550 --> 00:16:08,990
dangers and untrusted so for example

355
00:16:07,730 --> 00:16:11,390
when you can't attach one of these

356
00:16:08,990 --> 00:16:13,160
things in Outlook that's why it gets

357
00:16:11,390 --> 00:16:14,900
stripped that's why it gets stripped

358
00:16:13,160 --> 00:16:17,860
from mail flows all these kind of things

359
00:16:14,900 --> 00:16:23,329
if you knew that that API existed right

360
00:16:17,860 --> 00:16:26,480
neither did most of Microsoft we also

361
00:16:23,330 --> 00:16:27,830
worked on things like logging right like

362
00:16:26,480 --> 00:16:30,020
no other shell had really brought in

363
00:16:27,830 --> 00:16:31,370
logging you brought in a bunch not as

364
00:16:30,020 --> 00:16:35,120
good as we made it but we did bring in a

365
00:16:31,370 --> 00:16:39,140
bunch now execution policies are like

366
00:16:35,120 --> 00:16:41,780
the great punching bag of of monads

367
00:16:39,140 --> 00:16:47,480
security and I've realized since then

368
00:16:41,780 --> 00:16:49,339
that that was a very myopic view so to

369
00:16:47,480 --> 00:16:52,760
realize what execution policies are all

370
00:16:49,340 --> 00:16:54,920
about think about chmod on UNIX you're

371
00:16:52,760 --> 00:16:57,500
used to you get a script make it

372
00:16:54,920 --> 00:16:59,030
executable run it that's like good and

373
00:16:57,500 --> 00:17:02,630
you forget it sometimes and you like

374
00:16:59,030 --> 00:17:04,700
both stupid and you enable it but what

375
00:17:02,630 --> 00:17:06,020
you can do is realize that what if we

376
00:17:04,700 --> 00:17:08,240
could improve this a little bit by

377
00:17:06,020 --> 00:17:10,970
saying if it's signed by a trusted

378
00:17:08,240 --> 00:17:12,410
publisher well then let that thing run

379
00:17:10,970 --> 00:17:14,930
automatically it's meant to be

380
00:17:12,410 --> 00:17:17,240
executable so we took something that was

381
00:17:14,930 --> 00:17:18,650
a best practice in UNIX and tried to

382
00:17:17,240 --> 00:17:21,800
make it something that was maybe a bit

383
00:17:18,650 --> 00:17:24,890
more usable on Windows but what I

384
00:17:21,800 --> 00:17:26,480
realized in the years since that this

385
00:17:24,890 --> 00:17:28,880
has been an even better security

386
00:17:26,480 --> 00:17:30,710
improvement and we even realized because

387
00:17:28,880 --> 00:17:32,360
the folks that we laugh at that have

388
00:17:30,710 --> 00:17:34,190
done all signed execution policy

389
00:17:32,360 --> 00:17:37,520
thinking that there is security control

390
00:17:34,190 --> 00:17:39,380
are way ahead of the field when it comes

391
00:17:37,520 --> 00:17:41,330
to implementing application whitelisting

392
00:17:39,380 --> 00:17:43,580
they already know how to sign things

393
00:17:41,330 --> 00:17:45,230
they probably have the idea of what a

394
00:17:43,580 --> 00:17:47,510
trusted image looks like they're

395
00:17:45,230 --> 00:17:49,970
auditing these things so all of the

396
00:17:47,510 --> 00:17:52,160
skills that somebody built building what

397
00:17:49,970 --> 00:17:54,770
we're treating as a punching bag has put

398
00:17:52,160 --> 00:17:58,100
them way ahead of the field I think is a

399
00:17:54,770 --> 00:18:00,990
really really interesting perspective

400
00:17:58,100 --> 00:18:02,969
so we just didn't accept that root meant

401
00:18:00,990 --> 00:18:06,270
game over we had optimism that we could

402
00:18:02,970 --> 00:18:08,850
do something and just when we were

403
00:18:06,270 --> 00:18:11,310
starting to feel proud of ourselves we

404
00:18:08,850 --> 00:18:14,300
heard the early rumblings of the first

405
00:18:11,310 --> 00:18:14,300
Vista virus

406
00:18:14,750 --> 00:18:22,230
so on August 4th 2005 one of our MVPs

407
00:18:19,860 --> 00:18:23,959
let us know about this rumblings going

408
00:18:22,230 --> 00:18:26,550
around them the Internet

409
00:18:23,960 --> 00:18:28,590
the first Vista virus and this thing was

410
00:18:26,550 --> 00:18:31,110
incredibly simple you can basically see

411
00:18:28,590 --> 00:18:33,120
the code there it was an M SH script

412
00:18:31,110 --> 00:18:37,169
that would append itself to the end of

413
00:18:33,120 --> 00:18:39,540
MS age scripts and that's basically it

414
00:18:37,170 --> 00:18:42,650
like okay scripting language can manage

415
00:18:39,540 --> 00:18:47,129
text files like News at 11:00

416
00:18:42,650 --> 00:18:49,350
but the thing is Adam bar he was a

417
00:18:47,130 --> 00:18:50,910
security researcher a security program

418
00:18:49,350 --> 00:18:55,530
manager that I worked with at the time

419
00:18:50,910 --> 00:18:58,980
we realized that this was in Vista which

420
00:18:55,530 --> 00:19:02,280
was newly in beta and you know that was

421
00:18:58,980 --> 00:19:03,809
going to make news so what we did is we

422
00:19:02,280 --> 00:19:06,720
went back and we put up a blog post

423
00:19:03,809 --> 00:19:08,910
prepared a blog post about this virus

424
00:19:06,720 --> 00:19:10,530
talking about all the security controls

425
00:19:08,910 --> 00:19:12,780
would it really meant that you had to

426
00:19:10,530 --> 00:19:16,940
explicitly pone yourself before I could

427
00:19:12,780 --> 00:19:16,940
continue on and we waited

428
00:19:17,070 --> 00:19:23,050
we knew that this was going to be a big

429
00:19:19,600 --> 00:19:25,830
mark black mark on PowerShell security

430
00:19:23,050 --> 00:19:30,730
if we did nothing about it

431
00:19:25,830 --> 00:19:32,620
so sure enough is hit slash dot so for

432
00:19:30,730 --> 00:19:34,270
any of you unfamiliar with slash taught

433
00:19:32,620 --> 00:19:38,590
at the time it was huge

434
00:19:34,270 --> 00:19:42,400
so think hacker news but full of like

435
00:19:38,590 --> 00:19:45,909
rabidly antimicrobial full of a bunch of

436
00:19:42,400 --> 00:19:51,010
blowhards that I think they know just

437
00:19:45,910 --> 00:19:53,740
think this is fine you get it so sure

438
00:19:51,010 --> 00:19:57,370
enough it hit slash dot and a front page

439
00:19:53,740 --> 00:19:59,470
no less so he jumped on it put up a

440
00:19:57,370 --> 00:20:02,590
comment right away that was like hey

441
00:19:59,470 --> 00:20:05,950
this happened here's a blog post talking

442
00:20:02,590 --> 00:20:07,780
about it it got uploaded quickly and it

443
00:20:05,950 --> 00:20:10,300
was amazing that the the traditional

444
00:20:07,780 --> 00:20:16,540
anti Microsoft rhetoric was surprisingly

445
00:20:10,300 --> 00:20:21,360
gone people are able to read and have

446
00:20:16,540 --> 00:20:21,360
smart education it felt good

447
00:20:22,559 --> 00:20:27,160
so that day that was a good day went

448
00:20:25,240 --> 00:20:28,960
home being like save the world a little

449
00:20:27,160 --> 00:20:31,840
bit today / shot was happy about

450
00:20:28,960 --> 00:20:37,390
Microsoft like nothing else but the

451
00:20:31,840 --> 00:20:39,760
following day was not in perhaps the

452
00:20:37,390 --> 00:20:42,490
worst example of a Microsoft cell phone

453
00:20:39,760 --> 00:20:44,800
I've ever seen some folks tried to do

454
00:20:42,490 --> 00:20:50,470
damage control to protect the good name

455
00:20:44,800 --> 00:20:52,870
that was Windows Vista the news cycle

456
00:20:50,470 --> 00:20:54,520
had already run its course and it really

457
00:20:52,870 --> 00:20:56,770
ended up on a good note they had pulled

458
00:20:54,520 --> 00:21:00,910
good quotes for my blog and it really

459
00:20:56,770 --> 00:21:04,110
felt like things were done but let's

460
00:21:00,910 --> 00:21:07,750
just say that didn't work out so well

461
00:21:04,110 --> 00:21:10,178
this thing also hit the front page the

462
00:21:07,750 --> 00:21:12,610
media storm caused by this cellphone was

463
00:21:10,179 --> 00:21:15,130
just it just was stupid it was years

464
00:21:12,610 --> 00:21:17,290
inside of Microsoft when I stopped

465
00:21:15,130 --> 00:21:18,670
hearing the term like hey was it monad

466
00:21:17,290 --> 00:21:23,110
removed from Vista because it gets

467
00:21:18,670 --> 00:21:24,520
viruses like it was so bad but it was

468
00:21:23,110 --> 00:21:27,639
clear that what was starting to happen

469
00:21:24,520 --> 00:21:29,559
was that we had done such a good job at

470
00:21:27,640 --> 00:21:33,100
locking down the entry points of an

471
00:21:29,559 --> 00:21:35,519
attack that we were pretty happy with

472
00:21:33,100 --> 00:21:39,070
what was going on

473
00:21:35,519 --> 00:21:43,570
so Monad officially shipped as Windows

474
00:21:39,070 --> 00:21:46,499
PowerShell in November of 2006 it first

475
00:21:43,570 --> 00:21:49,509
shipped as a part of the Windows SDK

476
00:21:46,499 --> 00:21:52,419
literally Windows SDK opt into

477
00:21:49,509 --> 00:21:54,730
PowerShell they also then came as a

478
00:21:52,419 --> 00:21:56,980
standalone download and then finally as

479
00:21:54,730 --> 00:22:00,730
a built-in component in Windows 7 in

480
00:21:56,980 --> 00:22:03,039
2009 funny thing about it being part of

481
00:22:00,730 --> 00:22:04,419
the Windows SDK so it was a different

482
00:22:03,039 --> 00:22:06,700
team who put together the Windows SDK

483
00:22:04,419 --> 00:22:09,899
and at some point we had a bug report

484
00:22:06,700 --> 00:22:13,179
that if you uninstalled the Windows SDK

485
00:22:09,899 --> 00:22:14,889
PowerShell still stayed there and so we

486
00:22:13,179 --> 00:22:16,360
reached out and asked about it and they

487
00:22:14,889 --> 00:22:18,459
kind of like blink then they looked at

488
00:22:16,360 --> 00:22:22,600
us and they're like why would anybody

489
00:22:18,460 --> 00:22:33,309
want to remove PowerShell my kind of

490
00:22:22,600 --> 00:22:35,320
team so in around 2009 or 2010 attacker

491
00:22:33,309 --> 00:22:37,799
started coming in from the side they

492
00:22:35,320 --> 00:22:41,320
would explain something that was weaker

493
00:22:37,799 --> 00:22:43,119
for example a macro in a document that

494
00:22:41,320 --> 00:22:44,710
was packed into a zip file that was

495
00:22:43,119 --> 00:22:48,100
password protected or something like

496
00:22:44,710 --> 00:22:49,869
that or I kid you not raw scripts being

497
00:22:48,100 --> 00:22:51,639
shared over the Kazaa file sharing

498
00:22:49,869 --> 00:22:53,080
network like ok I'm going to download

499
00:22:51,639 --> 00:22:56,789
something over a peer-to-peer networking

500
00:22:53,080 --> 00:22:56,789
and double-click it alright

501
00:22:56,880 --> 00:23:01,889
but UNIX has always had this philosophy

502
00:22:59,340 --> 00:23:04,759
of like no duh root but we just had to

503
00:23:01,889 --> 00:23:07,769
move past that these are real people

504
00:23:04,759 --> 00:23:10,409
sitting at real computers with real

505
00:23:07,769 --> 00:23:13,409
children and their dogs wrapped around

506
00:23:10,409 --> 00:23:17,120
their feet we knew we had to do

507
00:23:13,409 --> 00:23:17,120
something what would you do

508
00:23:19,500 --> 00:23:24,389
so all of this here as security geeks

509
00:23:22,110 --> 00:23:28,229
we've had a love for cool technology

510
00:23:24,389 --> 00:23:30,899
cool tools and fun new things as a

511
00:23:28,230 --> 00:23:34,320
security person myself I had marveled at

512
00:23:30,899 --> 00:23:37,768
the incredible use of Hera shell for

513
00:23:34,320 --> 00:23:40,110
just random security tooling like this

514
00:23:37,769 --> 00:23:42,870
is an example of a Bing sweep of a Class

515
00:23:40,110 --> 00:23:45,899
C Network that finishes in 500

516
00:23:42,870 --> 00:23:48,168
milliseconds this is the kind of thing

517
00:23:45,899 --> 00:23:51,299
that you're used to seeing now at at

518
00:23:48,169 --> 00:23:54,419
Carlos Esprit Carlos Perez's classes and

519
00:23:51,299 --> 00:23:58,440
stuff like that but at the time I have

520
00:23:54,419 --> 00:24:00,120
spent like five years wondering why

521
00:23:58,440 --> 00:24:05,700
isn't the rest of the world figure this

522
00:24:00,120 --> 00:24:12,928
out well turns out in 2010 we finally

523
00:24:05,700 --> 00:24:16,559
got first contact so we had a researcher

524
00:24:12,929 --> 00:24:19,559
reach out from a Fortune 1000 company

525
00:24:16,559 --> 00:24:21,918
and he was deeply investigating an

526
00:24:19,559 --> 00:24:24,928
assumed breach model of their appliance

527
00:24:21,919 --> 00:24:27,960
if an attacker got in they wanted to

528
00:24:24,929 --> 00:24:29,490
limit what they could do they were doing

529
00:24:27,960 --> 00:24:32,510
stuff to harden their appliance that's

530
00:24:29,490 --> 00:24:35,039
really really rare to see

531
00:24:32,510 --> 00:24:38,700
we've been down this road a lot at

532
00:24:35,039 --> 00:24:43,110
Microsoft with Xbox as your stack data

533
00:24:38,700 --> 00:24:45,019
box as your sphere but it's amazing to

534
00:24:43,110 --> 00:24:47,699
see other companies put this much effort

535
00:24:45,019 --> 00:24:53,100
into what most most in the community

536
00:24:47,700 --> 00:24:56,279
today disparage as IOT that researcher

537
00:24:53,100 --> 00:25:01,500
you might recognize him hey Dave you

538
00:24:56,279 --> 00:25:03,659
rock it was it was great working with

539
00:25:01,500 --> 00:25:06,870
them he was literally the first

540
00:25:03,659 --> 00:25:08,519
researcher into PowerShell so there were

541
00:25:06,870 --> 00:25:09,779
a couple things that were off the mark

542
00:25:08,519 --> 00:25:11,820
you heat when he reached out there was a

543
00:25:09,779 --> 00:25:15,299
couple things we that you know we helped

544
00:25:11,820 --> 00:25:17,370
him out with a code review and to be

545
00:25:15,299 --> 00:25:22,260
honest there were some harsh words that

546
00:25:17,370 --> 00:25:27,870
were shared vine shell in CMD instead of

547
00:25:22,260 --> 00:25:30,408
PowerShell you and so on but the message

548
00:25:27,870 --> 00:25:33,389
of his truck was a hundred percent true

549
00:25:30,409 --> 00:25:34,529
this is the Dave that we all know and

550
00:25:33,389 --> 00:25:37,500
love and I just didn't know it at the

551
00:25:34,529 --> 00:25:41,940
time there is nothing you can do about a

552
00:25:37,500 --> 00:25:43,950
sufficiently powerful tool and you can't

553
00:25:41,940 --> 00:25:46,590
control that somebody's gonna do when

554
00:25:43,950 --> 00:25:48,539
they wield it so rather than going down

555
00:25:46,590 --> 00:25:49,918
the unfortunate industry standard of

556
00:25:48,539 --> 00:25:52,340
trying to squash the research we

557
00:25:49,919 --> 00:25:52,340
listened

558
00:25:53,140 --> 00:26:01,600
we welcomed it his talk happened you've

559
00:25:58,120 --> 00:26:06,100
all seen it it was awesome at Microsoft

560
00:26:01,600 --> 00:26:07,990
at this time was Big Dave Big Dave and

561
00:26:06,100 --> 00:26:11,379
Microsoft at the time we were very very

562
00:26:07,990 --> 00:26:15,520
busy working on Windows 8 security wise

563
00:26:11,380 --> 00:26:18,490
a huge feature of of security at the

564
00:26:15,520 --> 00:26:23,860
time was Windows on arm also known as

565
00:26:18,490 --> 00:26:25,929
Windows RT this was the goal of offering

566
00:26:23,860 --> 00:26:28,270
a Microsoft device that was a much more

567
00:26:25,929 --> 00:26:30,059
media and app focused thing so it was

568
00:26:28,270 --> 00:26:32,530
super lockdown and that was it

569
00:26:30,059 --> 00:26:34,178
the the picture you see at the bottom

570
00:26:32,530 --> 00:26:36,280
right there that's the first time that

571
00:26:34,179 --> 00:26:40,750
PowerShell ever booted on the ARM

572
00:26:36,280 --> 00:26:42,100
architecture that was magic so security

573
00:26:40,750 --> 00:26:45,220
why is this brought in some really

574
00:26:42,100 --> 00:26:47,620
awesome features like device guard which

575
00:26:45,220 --> 00:26:49,840
is a windows wide API that any

576
00:26:47,620 --> 00:26:52,178
application can query to figure out the

577
00:26:49,840 --> 00:26:54,280
current system lockdown mode and also

578
00:26:52,179 --> 00:26:57,520
determine the trust level of any file in

579
00:26:54,280 --> 00:26:59,770
the system it also brought in constrain

580
00:26:57,520 --> 00:27:02,260
language a version of the powerful

581
00:26:59,770 --> 00:27:04,450
language that made sure that only trust

582
00:27:02,260 --> 00:27:06,370
his scripts could run the kind of API is

583
00:27:04,450 --> 00:27:08,290
like dotnet scripting and things like

584
00:27:06,370 --> 00:27:12,250
that that we were seeing attacker is

585
00:27:08,290 --> 00:27:14,530
becoming increasingly fond of so despite

586
00:27:12,250 --> 00:27:17,110
Windows RT being relatively short-lived

587
00:27:14,530 --> 00:27:19,299
the security features that we added to

588
00:27:17,110 --> 00:27:20,709
Windows and PowerShell at the time they

589
00:27:19,299 --> 00:27:24,660
live on and they helped protect some

590
00:27:20,710 --> 00:27:24,660
seriously high security systems

591
00:27:26,300 --> 00:27:32,850
so starting around early 2013 we started

592
00:27:30,540 --> 00:27:36,510
to see an uptick of PowerShell being

593
00:27:32,850 --> 00:27:37,889
used for malice attacks weren't coming

594
00:27:36,510 --> 00:27:41,730
through the front door because we had

595
00:27:37,890 --> 00:27:43,350
locked all that stuff down but also we

596
00:27:41,730 --> 00:27:46,560
were seeing that internal red team's

597
00:27:43,350 --> 00:27:48,439
like office 365 had been investigating

598
00:27:46,560 --> 00:27:52,889
PowerShell as a post exploitation

599
00:27:48,440 --> 00:27:54,870
vehicle for a little while so Geoffrey

600
00:27:52,890 --> 00:27:57,840
and I we started putting our heads

601
00:27:54,870 --> 00:27:59,760
together while you can't force a

602
00:27:57,840 --> 00:28:02,550
powerful tool to be used only how you

603
00:27:59,760 --> 00:28:04,410
want it to be used you can be absolutely

604
00:28:02,550 --> 00:28:08,490
sure that you're tilting the playing

605
00:28:04,410 --> 00:28:10,230
field on behalf of defenders we first

606
00:28:08,490 --> 00:28:13,740
called this work the PowerShell slime

607
00:28:10,230 --> 00:28:15,590
trail and I realize in an attacker

608
00:28:13,740 --> 00:28:18,630
leaves a trail of slime wherever they go

609
00:28:15,590 --> 00:28:20,129
it's a fun term that what I realized

610
00:28:18,630 --> 00:28:23,310
later with the term of security

611
00:28:20,130 --> 00:28:25,080
transparency really really highlighted

612
00:28:23,310 --> 00:28:31,560
that we were trying to do a lot more

613
00:28:25,080 --> 00:28:34,020
effectively and a lot more presentation

614
00:28:31,560 --> 00:28:36,169
started coming started exploring the the

615
00:28:34,020 --> 00:28:38,370
crazy power of this baby rebuilt and

616
00:28:36,170 --> 00:28:40,980
away and it was kind of feeling like he

617
00:28:38,370 --> 00:28:43,199
was getting harder every day but we did

618
00:28:40,980 --> 00:28:46,710
we kept on listening and it was those

619
00:28:43,200 --> 00:28:49,890
days we realized how genuinely good the

620
00:28:46,710 --> 00:28:52,170
core of this community is I've had many

621
00:28:49,890 --> 00:28:54,000
discussions with many of you and I feel

622
00:28:52,170 --> 00:28:57,680
truly fortunate as some real and

623
00:28:54,000 --> 00:28:57,680
long-lasting friendships have formed

624
00:28:58,270 --> 00:29:03,230
so seeing these attacks and we started

625
00:29:01,430 --> 00:29:05,900
analyzing the core of what made them

626
00:29:03,230 --> 00:29:08,540
tick and so we started working on

627
00:29:05,900 --> 00:29:10,490
features to not only mitigate them but

628
00:29:08,540 --> 00:29:13,550
turn them into an advantage for the blue

629
00:29:10,490 --> 00:29:17,980
team if an attacker is going to use

630
00:29:13,550 --> 00:29:17,980
PowerShell let's make them regret it

631
00:29:19,099 --> 00:29:26,579
in March of 2014 we checked in the first

632
00:29:23,399 --> 00:29:28,139
stages of PowerShell transparency this

633
00:29:26,579 --> 00:29:30,959
is what a check in mail looks like on

634
00:29:28,139 --> 00:29:34,199
the team at the time look at all that

635
00:29:30,959 --> 00:29:35,969
nice blue console colors is fun over the

636
00:29:34,200 --> 00:29:37,979
next six months we continue to

637
00:29:35,969 --> 00:29:40,769
continually like refine and work on the

638
00:29:37,979 --> 00:29:43,829
feature add additional features refine

639
00:29:40,769 --> 00:29:45,599
the functionality getting the core

640
00:29:43,829 --> 00:29:47,849
PowerShell stuff was pretty much

641
00:29:45,599 --> 00:29:49,619
straight engineering it was challenging

642
00:29:47,849 --> 00:29:51,958
engineering but straight Engineering

643
00:29:49,619 --> 00:29:53,849
once we knew what we wanted to do there

644
00:29:51,959 --> 00:29:56,789
are other things that we added like MC

645
00:29:53,849 --> 00:29:58,739
the anti-malware scan interface which

646
00:29:56,789 --> 00:30:01,259
required a lot more engagement across

647
00:29:58,739 --> 00:30:04,679
all of Microsoft that was working with

648
00:30:01,259 --> 00:30:07,529
Windows Defender the vbscript team

649
00:30:04,679 --> 00:30:09,690
PowerShell of course it felt like doing

650
00:30:07,529 --> 00:30:12,379
like a continuous walking tour of all

651
00:30:09,690 --> 00:30:12,379
the Microsoft

652
00:30:12,680 --> 00:30:17,820
somewhat coincidentally many of the

653
00:30:15,390 --> 00:30:19,830
finishing touches of the slime trail and

654
00:30:17,820 --> 00:30:23,100
powershell transparency we're getting

655
00:30:19,830 --> 00:30:28,560
polished off at the very very same time

656
00:30:23,100 --> 00:30:30,780
as derbycon 4 and then the skids started

657
00:30:28,560 --> 00:30:36,200
coming

658
00:30:30,780 --> 00:30:39,600
I want to talk to you about emotionally

659
00:30:36,200 --> 00:30:41,720
the lowest I've been in my professional

660
00:30:39,600 --> 00:30:41,719
career

661
00:30:41,810 --> 00:30:49,020
on April 9th 2014 words started going

662
00:30:46,860 --> 00:30:52,260
about around about posh coder so this

663
00:30:49,020 --> 00:30:55,020
was a new kind of ransomware like most

664
00:30:52,260 --> 00:30:58,920
is started with with macros and stuff

665
00:30:55,020 --> 00:31:01,020
like that but unlike most it used

666
00:30:58,920 --> 00:31:04,890
PowerShell as its delivery vehicle for

667
00:31:01,020 --> 00:31:07,139
the actual encryption so the news was

668
00:31:04,890 --> 00:31:08,880
really really sparse and scarce at the

669
00:31:07,140 --> 00:31:11,450
time but there was this one forum on

670
00:31:08,880 --> 00:31:14,160
bleeping computer that was active the

671
00:31:11,450 --> 00:31:17,070
folks there had discovered it and they

672
00:31:14,160 --> 00:31:19,830
had done so much work investigating it

673
00:31:17,070 --> 00:31:22,470
it went on for pages and pages and I

674
00:31:19,830 --> 00:31:29,710
read every single one

675
00:31:22,470 --> 00:31:32,580
and one of them stopped my heart it's

676
00:31:29,710 --> 00:31:37,299
hard to explain how this felt

677
00:31:32,580 --> 00:31:39,610
we have spent the last decade and tens

678
00:31:37,299 --> 00:31:43,840
of millions of dollars making a tool to

679
00:31:39,610 --> 00:31:45,879
make people's lives better I can't count

680
00:31:43,840 --> 00:31:47,350
the number of people that have come out

681
00:31:45,880 --> 00:31:49,690
and said power shells made their life

682
00:31:47,350 --> 00:31:52,299
better or that got them a promotion or

683
00:31:49,690 --> 00:31:53,860
that changed their business or that

684
00:31:52,299 --> 00:31:56,530
literally changed their life for the

685
00:31:53,860 --> 00:31:58,659
better but that day and the days that

686
00:31:56,530 --> 00:32:03,010
followed it I really wish I could rewind

687
00:31:58,660 --> 00:32:06,010
time I know I shouldn't feel this way

688
00:32:03,010 --> 00:32:08,559
but I did I just did like nobody blames

689
00:32:06,010 --> 00:32:10,540
the inventors of the C programming

690
00:32:08,559 --> 00:32:12,580
language for being responsible for

691
00:32:10,540 --> 00:32:20,830
almost 100 percent of the malware out

692
00:32:12,580 --> 00:32:25,059
there and they've never done anything to

693
00:32:20,830 --> 00:32:26,949
do anything about it the seminal book on

694
00:32:25,059 --> 00:32:29,139
the most influential programming

695
00:32:26,950 --> 00:32:38,950
language of our time mentions the word

696
00:32:29,140 --> 00:32:42,010
security once and it's a coincidence

697
00:32:38,950 --> 00:32:44,500
I know I shouldn't feel this way but I

698
00:32:42,010 --> 00:32:50,890
did and it's a bitter pill that as you

699
00:32:44,500 --> 00:32:54,610
can tell still hits me to this day on

700
00:32:50,890 --> 00:32:56,710
June 9th 2015 we published a huge

701
00:32:54,610 --> 00:33:00,629
milestone in the journey of PowerShell

702
00:32:56,710 --> 00:33:03,130
security PowerShell loves the blue team

703
00:33:00,630 --> 00:33:06,040
in it we were able to describe an

704
00:33:03,130 --> 00:33:08,220
amazing detail all of the amazing work

705
00:33:06,040 --> 00:33:11,260
we've been doing for almost two years

706
00:33:08,220 --> 00:33:13,980
script lock logging protected event

707
00:33:11,260 --> 00:33:17,620
logging constrain language mode

708
00:33:13,980 --> 00:33:19,770
automatic transcription we didn't try to

709
00:33:17,620 --> 00:33:23,020
squash any of this research we listened

710
00:33:19,770 --> 00:33:24,930
all we could do is be honest yes the

711
00:33:23,020 --> 00:33:28,410
environment out there is hostile and

712
00:33:24,930 --> 00:33:31,300
here's what we've done about it

713
00:33:28,410 --> 00:33:33,580
you can't control what somebody will do

714
00:33:31,300 --> 00:33:37,510
with a sufficiently power ship powerful

715
00:33:33,580 --> 00:33:39,310
tool but you can be 100% sure that

716
00:33:37,510 --> 00:33:41,610
you're placing the blue team on equal

717
00:33:39,310 --> 00:33:41,610
footing

718
00:33:41,950 --> 00:33:46,850
for some perspective you've probably

719
00:33:44,510 --> 00:33:48,680
seen CVEs issued as part of Windows

720
00:33:46,850 --> 00:33:51,949
updates about you know PowerShell

721
00:33:48,680 --> 00:33:54,680
vulnerabilities and stuff but what most

722
00:33:51,950 --> 00:33:57,260
don't realize that almost 100% of these

723
00:33:54,680 --> 00:33:59,750
are in a feature that isn't a

724
00:33:57,260 --> 00:34:01,879
traditional security boundary these are

725
00:33:59,750 --> 00:34:04,910
things that were patching in things like

726
00:34:01,880 --> 00:34:09,190
security transparency which literally no

727
00:34:04,910 --> 00:34:12,020
other show or runtime out there has a

728
00:34:09,190 --> 00:34:16,639
Nevada say hats off to the folks at

729
00:34:12,020 --> 00:34:19,399
specter ops Lee and will are upstairs

730
00:34:16,639 --> 00:34:21,350
right now giving a talk Spectre ops

731
00:34:19,399 --> 00:34:23,810
folks are supporting them they've been a

732
00:34:21,350 --> 00:34:26,029
great great partner in this journey and

733
00:34:23,810 --> 00:34:30,799
many many these findings are because of

734
00:34:26,030 --> 00:34:32,810
them and they've been great partners the

735
00:34:30,800 --> 00:34:35,720
same day that we published PowerShell

736
00:34:32,810 --> 00:34:38,630
loves the blue team we also published a

737
00:34:35,719 --> 00:34:41,770
major related infrastructure investment

738
00:34:38,630 --> 00:34:43,820
we made in Windows the new MC interface

739
00:34:41,770 --> 00:34:47,530
this is something that is open to all

740
00:34:43,820 --> 00:34:51,710
applications and all antivirus vendors

741
00:34:47,530 --> 00:34:54,710
what other operating system has an API

742
00:34:51,710 --> 00:34:56,629
that any application can call into to

743
00:34:54,710 --> 00:35:00,950
determine if dynamic content is still

744
00:34:56,629 --> 00:35:05,080
safe and that any antivirus vendor can

745
00:35:00,950 --> 00:35:05,080
listen to and use to enrich their data

746
00:35:05,650 --> 00:35:12,400
at Derby con 5 in 2015 I got the chance

747
00:35:10,640 --> 00:35:15,950
to start talking about some of these

748
00:35:12,400 --> 00:35:19,339
awesome challenges and these changes in

749
00:35:15,950 --> 00:35:20,899
these defensive improvements I also

750
00:35:19,339 --> 00:35:23,299
submitted talks about these two black

751
00:35:20,900 --> 00:35:26,359
hat and DEF CON neither of which were

752
00:35:23,300 --> 00:35:30,609
accepted this is just another example of

753
00:35:26,359 --> 00:35:30,609
Derby con being way ahead of the field

754
00:35:31,610 --> 00:35:41,030
the next year derbycon 6 in 2016 the

755
00:35:38,150 --> 00:35:43,070
looming impact of security transparency

756
00:35:41,030 --> 00:35:46,610
in PowerShell was starting to become

757
00:35:43,070 --> 00:35:49,430
clear Geoffrey and I were honored to

758
00:35:46,610 --> 00:35:52,700
give Derby Khan's keynote that year with

759
00:35:49,430 --> 00:35:58,430
the Philly theme of collaboration the

760
00:35:52,700 --> 00:36:00,770
future and us it's hard to overstate how

761
00:35:58,430 --> 00:36:03,339
important collaboration has been in this

762
00:36:00,770 --> 00:36:06,860
incredible journey

763
00:36:03,340 --> 00:36:09,650
Microsoft has a lot of passion in this

764
00:36:06,860 --> 00:36:12,260
specific area but this kind of

765
00:36:09,650 --> 00:36:14,750
interaction is exactly the kind of

766
00:36:12,260 --> 00:36:18,650
culture that I value the most about this

767
00:36:14,750 --> 00:36:21,500
part of the InfoSec community I consider

768
00:36:18,650 --> 00:36:23,030
it a rare and unique pleasure to be part

769
00:36:21,500 --> 00:36:26,270
of a company that can care this deeply

770
00:36:23,030 --> 00:36:28,550
about security and then also participate

771
00:36:26,270 --> 00:36:33,259
with the community so authentically and

772
00:36:28,550 --> 00:36:34,190
as part of the community I want to do a

773
00:36:33,260 --> 00:36:37,250
little bit of audience participation

774
00:36:34,190 --> 00:36:39,590
here hands up and keep them up if you

775
00:36:37,250 --> 00:36:41,540
have submitted a security concern about

776
00:36:39,590 --> 00:36:45,650
PowerShell to us please raise your hand

777
00:36:41,540 --> 00:36:47,920
if you've submitted a CVE or my nsrc

778
00:36:45,650 --> 00:36:50,990
case to us please raise your hand if

779
00:36:47,920 --> 00:36:53,870
you've blogged about PowerShell security

780
00:36:50,990 --> 00:36:55,669
best practices please raise your hand if

781
00:36:53,870 --> 00:36:57,529
you've tweeted to help customers

782
00:36:55,670 --> 00:37:00,140
understand the impact of security please

783
00:36:57,530 --> 00:37:02,240
raise your hand if you've helped people

784
00:37:00,140 --> 00:37:03,500
in your company understand the impact of

785
00:37:02,240 --> 00:37:04,870
security and how to secure it more

786
00:37:03,500 --> 00:37:07,640
please raise your hand

787
00:37:04,870 --> 00:37:11,259
 you guys are amazing you are what

788
00:37:07,640 --> 00:37:19,049
makes this industry tick thank you

789
00:37:11,260 --> 00:37:19,050
[Laughter]

790
00:37:20,060 --> 00:37:26,210
also that year one of the presentations

791
00:37:23,150 --> 00:37:30,470
blew my mind Nick Carr met dunwood he

792
00:37:26,210 --> 00:37:32,660
presented a no easy breach for me this

793
00:37:30,470 --> 00:37:34,970
was incredible they were doing incident

794
00:37:32,660 --> 00:37:38,450
response at a company with a hundred

795
00:37:34,970 --> 00:37:41,959
thousand servers ten of these per day

796
00:37:38,450 --> 00:37:44,299
were getting popped so like really in

797
00:37:41,960 --> 00:37:47,150
your head try to think about that as a

798
00:37:44,300 --> 00:37:49,010
defender if you knew that one of these

799
00:37:47,150 --> 00:37:50,090
servers that had just been popped and

800
00:37:49,010 --> 00:37:52,790
you knew this was like this was

801
00:37:50,090 --> 00:37:53,930
literally nation-state apt if you knew

802
00:37:52,790 --> 00:37:56,750
that one of these servers had been

803
00:37:53,930 --> 00:37:59,600
popped and it's your job to extract the

804
00:37:56,750 --> 00:38:02,990
tools the techniques the processes were

805
00:37:59,600 --> 00:38:04,310
they going next what does this mean like

806
00:38:02,990 --> 00:38:08,180
I don't know how you get out of this

807
00:38:04,310 --> 00:38:11,840
without a week of forensics on the

808
00:38:08,180 --> 00:38:14,500
machine for most things at this scale

809
00:38:11,840 --> 00:38:19,430
you're talking about a team of full-time

810
00:38:14,500 --> 00:38:21,200
70 people just to keep up I don't know

811
00:38:19,430 --> 00:38:25,520
if you got more cash than I deal with

812
00:38:21,200 --> 00:38:27,620
this that's gonna be a hard time but

813
00:38:25,520 --> 00:38:30,110
because Nick and Matt had heard about

814
00:38:27,620 --> 00:38:33,200
PowerShell security transparency they

815
00:38:30,110 --> 00:38:35,320
did one thing they upgraded the version

816
00:38:33,200 --> 00:38:39,970
of PowerShell across the environment

817
00:38:35,320 --> 00:38:43,190
turned on all the logging and guess what

818
00:38:39,970 --> 00:38:45,950
this turns the entire tool chain into an

819
00:38:43,190 --> 00:38:49,040
open-source investigation attackers had

820
00:38:45,950 --> 00:38:51,259
been using Python batch files PowerShell

821
00:38:49,040 --> 00:38:54,740
you name it anything that's on the most

822
00:38:51,260 --> 00:38:57,610
fun machine but because of this security

823
00:38:54,740 --> 00:39:00,020
transparency they were able to extract

824
00:38:57,610 --> 00:39:02,480
everything that they were doing just

825
00:39:00,020 --> 00:39:05,990
because of this one tool as long as they

826
00:39:02,480 --> 00:39:08,020
were using PowerShell that finally broke

827
00:39:05,990 --> 00:39:10,580
open the case and they were able to

828
00:39:08,020 --> 00:39:13,490
remediate the environment and and say

829
00:39:10,580 --> 00:39:16,200
the customers it's just incredible what

830
00:39:13,490 --> 00:39:18,959
security transparency can do

831
00:39:16,200 --> 00:39:21,689
that year we also introduced just enough

832
00:39:18,960 --> 00:39:24,059
administration a just an amazing

833
00:39:21,690 --> 00:39:27,150
foundational technology that lets you

834
00:39:24,059 --> 00:39:29,099
give people access to manage aspects of

835
00:39:27,150 --> 00:39:30,869
sensitive servers without having them

836
00:39:29,099 --> 00:39:37,410
access the entire sensitive servers

837
00:39:30,869 --> 00:39:39,900
themselves so that's been a long time at

838
00:39:37,410 --> 00:39:42,240
Derby constant aware of this stuff but

839
00:39:39,900 --> 00:39:46,380
meanwhile the rest of the world was

840
00:39:42,240 --> 00:39:47,759
starting to catch on DEFCON 24 was like

841
00:39:46,380 --> 00:39:50,510
music to my ears

842
00:39:47,760 --> 00:39:54,450
I attended probably half a dozen

843
00:39:50,510 --> 00:39:57,420
presentations calling out the quickly

844
00:39:54,450 --> 00:40:01,649
dwindling utility of PowerShell as a

845
00:39:57,420 --> 00:40:03,809
post exploitation language still no

846
00:40:01,650 --> 00:40:07,500
talks from the PowerShell team we tried

847
00:40:03,809 --> 00:40:09,450
but people were starting to really point

848
00:40:07,500 --> 00:40:15,150
out what the Derby con crowd had been

849
00:40:09,450 --> 00:40:16,770
realizing all along and then 2017 rolled

850
00:40:15,150 --> 00:40:20,250
around and I guess you could call it a

851
00:40:16,770 --> 00:40:22,530
case of be careful what you wish for for

852
00:40:20,250 --> 00:40:23,099
some time I had been riding daniel

853
00:40:22,530 --> 00:40:28,140
Bohannon

854
00:40:23,099 --> 00:40:30,380
Deebo on invoke obfuscation yeah he's a

855
00:40:28,140 --> 00:40:30,379
good guy

856
00:40:31,099 --> 00:40:35,579
invoke obfuscation so here's the

857
00:40:33,180 --> 00:40:37,589
background invoke obfuscation pointed

858
00:40:35,579 --> 00:40:40,349
out a danger that mandiant was seeing

859
00:40:37,589 --> 00:40:43,859
every single day for me remediating

860
00:40:40,349 --> 00:40:46,859
actual customers they were seeing the

861
00:40:43,859 --> 00:40:48,779
fact that obfuscated signatures were

862
00:40:46,859 --> 00:40:50,670
just ripping through the defense's that

863
00:40:48,780 --> 00:40:53,640
people had written because they weren't

864
00:40:50,670 --> 00:40:56,119
aware of the capabilities of obfuscated

865
00:40:53,640 --> 00:40:56,118
PowerShell

866
00:40:56,130 --> 00:41:02,680
my only issue is that he was right he

867
00:41:00,160 --> 00:41:05,319
was right and the industry did not have

868
00:41:02,680 --> 00:41:10,419
the right amount of defensive tooling to

869
00:41:05,320 --> 00:41:13,300
make this change so one interesting fact

870
00:41:10,420 --> 00:41:17,890
so most antivirus that uses MC has a

871
00:41:13,300 --> 00:41:20,680
pretty good handle on invoke obfuscation

872
00:41:17,890 --> 00:41:22,750
code but the issue is that there's a

873
00:41:20,680 --> 00:41:24,640
bunch of melt anti-malware engines out

874
00:41:22,750 --> 00:41:28,720
there that haven't yet understood how to

875
00:41:24,640 --> 00:41:31,029
use MC data stream and this is a

876
00:41:28,720 --> 00:41:33,910
honestly a time for some real talk with

877
00:41:31,030 --> 00:41:36,910
your antivirus vendors if they're not

878
00:41:33,910 --> 00:41:39,490
listening to the EMC data stream then

879
00:41:36,910 --> 00:41:43,720
their lack of interest is causing you

880
00:41:39,490 --> 00:41:46,209
real actual risk so we set out to make a

881
00:41:43,720 --> 00:41:47,830
tool kit that based on the kind of a

882
00:41:46,210 --> 00:41:49,810
bare minimum of being able to collect

883
00:41:47,830 --> 00:41:55,060
event logs from windows could help you

884
00:41:49,810 --> 00:41:57,070
detect obfuscated code at scale it turns

885
00:41:55,060 --> 00:41:59,470
out that PowerShell is pretty freakin

886
00:41:57,070 --> 00:42:01,030
awesome for Blue Team tools we wouldn't

887
00:41:59,470 --> 00:42:04,750
know right Emma

888
00:42:01,030 --> 00:42:08,530
we did a ton of work and artisanally

889
00:42:04,750 --> 00:42:11,830
handled revoke obfuscation later that

890
00:42:08,530 --> 00:42:13,870
year so that year I also realized I

891
00:42:11,830 --> 00:42:15,880
needed to do a bunch of work to

892
00:42:13,870 --> 00:42:17,920
summarize a bunch of this incredible

893
00:42:15,880 --> 00:42:20,230
security work into something more

894
00:42:17,920 --> 00:42:23,110
all-encompassing so I put together

895
00:42:20,230 --> 00:42:26,860
defending against PowerShell attacks and

896
00:42:23,110 --> 00:42:31,090
in somewhat of a curse of Fortune had to

897
00:42:26,860 --> 00:42:33,640
tux accepted at blackhat - at Def Con -

898
00:42:31,090 --> 00:42:35,260
at Derby con Microsoft's blue hat and an

899
00:42:33,640 --> 00:42:39,250
internal Microsoft machine learning

900
00:42:35,260 --> 00:42:40,660
conference that was kind of harsh so it

901
00:42:39,250 --> 00:42:44,500
turns out there is a way to get a

902
00:42:40,660 --> 00:42:47,379
defensive talking to DEFCON just to me

903
00:42:44,500 --> 00:42:49,810
to talk about offense you bet I do but

904
00:42:47,380 --> 00:42:54,880
then spend 90% of the time talking about

905
00:42:49,810 --> 00:42:57,840
how to defend you gotta do what you

906
00:42:54,880 --> 00:43:00,340
gotta do right hack all the things

907
00:42:57,840 --> 00:43:04,420
presenting with Devo at blackhat was was

908
00:43:00,340 --> 00:43:07,040
funny at blackhat you know the cameraman

909
00:43:04,420 --> 00:43:09,140
kept on trying to pan between us

910
00:43:07,040 --> 00:43:11,000
during her back and forth and like since

911
00:43:09,140 --> 00:43:13,009
he's this huge gladiator guy

912
00:43:11,000 --> 00:43:15,589
the cameraman kept on like whizzing

913
00:43:13,010 --> 00:43:23,990
right over my head or doing like slow

914
00:43:15,589 --> 00:43:26,630
dramatic pans right at his beard but

915
00:43:23,990 --> 00:43:29,240
looking back it really is amazing what

916
00:43:26,630 --> 00:43:30,740
security transparency can do and one

917
00:43:29,240 --> 00:43:33,379
view that I thought has always been

918
00:43:30,740 --> 00:43:36,770
really useful to to put this in context

919
00:43:33,380 --> 00:43:38,420
is mitre this is just one way to catalog

920
00:43:36,770 --> 00:43:40,509
the different components event of an

921
00:43:38,420 --> 00:43:43,099
attack but I think it's a useful one

922
00:43:40,510 --> 00:43:46,670
PowerShell is of course a potential

923
00:43:43,099 --> 00:43:48,740
component of an attack but since the

924
00:43:46,670 --> 00:43:51,589
beginning hearing about PowerShell being

925
00:43:48,740 --> 00:43:55,720
used for malice we invested a ton in

926
00:43:51,589 --> 00:43:55,720
security features that nobody else has

927
00:43:57,280 --> 00:44:03,920
and another thing is we at Microsoft

928
00:44:01,099 --> 00:44:08,530
started investing a ton and to these

929
00:44:03,920 --> 00:44:12,890
security signals so in December of 2018

930
00:44:08,530 --> 00:44:15,260
mitre evaluated several EDR solutions by

931
00:44:12,890 --> 00:44:19,299
mapping techniques from apt 3 which is

932
00:44:15,260 --> 00:44:21,950
boron into the mitre attack framework

933
00:44:19,300 --> 00:44:25,910
defender ATP which is Microsoft solution

934
00:44:21,950 --> 00:44:28,009
did very very well to start ATP crushed

935
00:44:25,910 --> 00:44:30,290
it at the scripting category just a

936
00:44:28,010 --> 00:44:32,240
perfect example of being aware of

937
00:44:30,290 --> 00:44:34,339
security transparency and I'm proud of

938
00:44:32,240 --> 00:44:37,270
that but that's not what makes me the

939
00:44:34,339 --> 00:44:39,950
proudest but makes me the proudest is

940
00:44:37,270 --> 00:44:43,970
that when you dig into all of the

941
00:44:39,950 --> 00:44:46,970
categories unrelated to PowerShell the

942
00:44:43,970 --> 00:44:49,000
attack framework lit up like a Christmas

943
00:44:46,970 --> 00:44:49,000
tree

944
00:44:49,080 --> 00:44:55,600
frequently due to his powershell

945
00:44:51,520 --> 00:44:57,850
intelligence so of the 54 attack

946
00:44:55,600 --> 00:45:02,890
categories that were evaluated by this

947
00:44:57,850 --> 00:45:04,720
by this set fully 36 of them benefited

948
00:45:02,890 --> 00:45:08,740
from this powershell security

949
00:45:04,720 --> 00:45:11,319
transparency i manually reviewed every

950
00:45:08,740 --> 00:45:13,870
single one of them and if the attacker

951
00:45:11,320 --> 00:45:16,360
had limited themselves to Python or Perl

952
00:45:13,870 --> 00:45:17,700
or VB script or something else the story

953
00:45:16,360 --> 00:45:20,740
might have been a little bit different

954
00:45:17,700 --> 00:45:22,509
but they didn't and they fell right into

955
00:45:20,740 --> 00:45:28,359
the honeypot of even building over the

956
00:45:22,510 --> 00:45:30,280
past couple years I really loved the way

957
00:45:28,360 --> 00:45:34,240
that Chris Thompson from IBM's

958
00:45:30,280 --> 00:45:36,820
x-force read put this at DEFCON 25 when

959
00:45:34,240 --> 00:45:38,649
PowerShell first came out red teamers

960
00:45:36,820 --> 00:45:41,470
started they hurled it as the best thing

961
00:45:38,650 --> 00:45:45,010
ever to happen in pen testing but only

962
00:45:41,470 --> 00:45:48,009
three years after the first check-in of

963
00:45:45,010 --> 00:45:51,450
PowerShell security transparency the

964
00:45:48,010 --> 00:45:51,450
tune had changed completely

965
00:45:54,890 --> 00:46:00,680
now I want to reflect back on that grief

966
00:45:57,440 --> 00:46:03,470
I felt when that one guy and that one

967
00:46:00,680 --> 00:46:05,410
forum lost all of his family photos to

968
00:46:03,470 --> 00:46:09,049
ransomware

969
00:46:05,410 --> 00:46:10,629
once MC started to come out I started to

970
00:46:09,050 --> 00:46:12,920
feel a new sense of hope

971
00:46:10,630 --> 00:46:15,470
defender already has dozens of

972
00:46:12,920 --> 00:46:17,710
techniques to detect capabilities and

973
00:46:15,470 --> 00:46:21,529
behavior whether something is malicious

974
00:46:17,710 --> 00:46:22,910
but until the advent of MC applications

975
00:46:21,530 --> 00:46:25,430
were unable to collaborate with

976
00:46:22,910 --> 00:46:29,450
antivirus to evaluate the safety of

977
00:46:25,430 --> 00:46:31,160
dynamic content after MC came out we

978
00:46:29,450 --> 00:46:34,310
started to see it block malware that

979
00:46:31,160 --> 00:46:36,259
would have otherwise succeeded slowly at

980
00:46:34,310 --> 00:46:38,840
first but each one matters

981
00:46:36,260 --> 00:46:41,620
each detection represents a person

982
00:46:38,840 --> 00:46:45,230
that's still gonna have their photos

983
00:46:41,620 --> 00:46:47,540
it's a person who is not gonna have

984
00:46:45,230 --> 00:46:52,720
their accounts drained by a banking

985
00:46:47,540 --> 00:46:55,250
Trojan these represent real people I

986
00:46:52,720 --> 00:46:58,100
took a look before coming to Derby con

987
00:46:55,250 --> 00:47:01,850
and MC based detections are blocking and

988
00:46:58,100 --> 00:47:04,670
they're blocking a lot it's just such an

989
00:47:01,850 --> 00:47:06,860
inspiring graph but what gives me hope

990
00:47:04,670 --> 00:47:08,690
and gives me faith in the power of the

991
00:47:06,860 --> 00:47:11,930
defensive side of this industry is the

992
00:47:08,690 --> 00:47:18,680
scale I did some legwork so that I could

993
00:47:11,930 --> 00:47:20,629
share this with you 10 million of these

994
00:47:18,680 --> 00:47:25,970
encounters per month are being blocked

995
00:47:20,630 --> 00:47:29,750
by MC not just in PowerShell in.net who

996
00:47:25,970 --> 00:47:32,899
is implemented MC in office 10 million

997
00:47:29,750 --> 00:47:34,100
people not becoming part of a botnet 10

998
00:47:32,900 --> 00:47:36,050
million people with their precious

999
00:47:34,100 --> 00:47:40,040
memories and documents this is your

1000
00:47:36,050 --> 00:47:41,450
family this is my family they're looking

1001
00:47:40,040 --> 00:47:44,120
at the retirement nest eggs because

1002
00:47:41,450 --> 00:47:47,000
they're still there and this is just

1003
00:47:44,120 --> 00:47:49,040
defender MC is an open windows interface

1004
00:47:47,000 --> 00:47:51,380
that any security vendor can opt into

1005
00:47:49,040 --> 00:47:55,100
and many have chosen so this number is

1006
00:47:51,380 --> 00:47:57,050
even higher it's just incredible so I

1007
00:47:55,100 --> 00:47:59,089
wanted to close up talking back about my

1008
00:47:57,050 --> 00:48:01,190
dad

1009
00:47:59,090 --> 00:48:02,720
it turns out that it wasn't our age

1010
00:48:01,190 --> 00:48:04,720
difference that was causing him to have

1011
00:48:02,720 --> 00:48:15,740
a hard time understanding batch files

1012
00:48:04,720 --> 00:48:17,620
but I only found later exactly why well

1013
00:48:15,740 --> 00:48:21,200
that database of his a kept on growing

1014
00:48:17,620 --> 00:48:25,549
but he put my book into it he got it off

1015
00:48:21,200 --> 00:48:27,350
BitTorrent she now loves PowerShell and

1016
00:48:25,550 --> 00:48:29,930
he's one of the most advanced users of

1017
00:48:27,350 --> 00:48:32,810
regular expressions I've ever met he

1018
00:48:29,930 --> 00:48:35,270
uses it to parse gigabytes of XML to do

1019
00:48:32,810 --> 00:48:38,960
word frequency analysis clustering

1020
00:48:35,270 --> 00:48:40,840
grouping Lucene index searches part of

1021
00:48:38,960 --> 00:48:43,070
speech tagging with the bril tagger

1022
00:48:40,840 --> 00:48:45,740
information extraction and anything else

1023
00:48:43,070 --> 00:48:47,510
you can imagine in just a few seconds

1024
00:48:45,740 --> 00:48:49,640
he's able to search all of wikipedia

1025
00:48:47,510 --> 00:48:51,680
with the fidelity that you just cannot

1026
00:48:49,640 --> 00:48:55,520
get from a general-purpose search engine

1027
00:48:51,680 --> 00:48:57,560
like Bing Google or even Wikipedia he

1028
00:48:55,520 --> 00:48:59,480
retired years ago but he's still

1029
00:48:57,560 --> 00:49:03,980
exploring every day he's one of these

1030
00:48:59,480 --> 00:49:06,470
lifelong learners and that's what gives

1031
00:49:03,980 --> 00:49:09,560
me hope we work together as a community

1032
00:49:06,470 --> 00:49:12,649
as defenders of both the red team and

1033
00:49:09,560 --> 00:49:15,650
the blue team variety it's our turf and

1034
00:49:12,650 --> 00:49:18,410
we can set the rules when we work

1035
00:49:15,650 --> 00:49:22,660
together we can return technology to the

1036
00:49:18,410 --> 00:49:22,660
people that deserve it thank you

1037
00:49:29,400 --> 00:49:32,539
[Applause]

