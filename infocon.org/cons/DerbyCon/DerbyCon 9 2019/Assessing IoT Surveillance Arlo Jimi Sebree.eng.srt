1
00:00:00,030 --> 00:00:05,850
cool how's it going everyone I'm Jimmy

2
00:00:02,520 --> 00:00:09,059
uh I know in the program it says IOT

3
00:00:05,850 --> 00:00:10,950
assessing IOT surveillance as this talk

4
00:00:09,059 --> 00:00:12,629
kind of progressed it turned into more

5
00:00:10,950 --> 00:00:15,450
just meat taking apart the our low

6
00:00:12,630 --> 00:00:17,640
security cameras and base station I am

7
00:00:15,450 --> 00:00:19,859
gonna talk about the process I followed

8
00:00:17,640 --> 00:00:21,510
taking these apart so this is gonna be a

9
00:00:19,859 --> 00:00:24,689
pretty beginner an intermediate level

10
00:00:21,510 --> 00:00:26,460
talk I think there's a huge lack of

11
00:00:24,689 --> 00:00:28,740
presentations that go through like

12
00:00:26,460 --> 00:00:31,050
actually tearing down devices and the

13
00:00:28,740 --> 00:00:32,879
thought process of someone like actually

14
00:00:31,050 --> 00:00:35,160
doing this I see a lot of beginners told

15
00:00:32,880 --> 00:00:37,590
over and over again just pick a target

16
00:00:35,160 --> 00:00:39,120
and try harder I don't see that as being

17
00:00:37,590 --> 00:00:42,420
very helpful so hopefully this gives

18
00:00:39,120 --> 00:00:44,250
someone more insight into how to

19
00:00:42,420 --> 00:00:48,690
actually like take one of their devices

20
00:00:44,250 --> 00:00:50,940
and start going at it this presentation

21
00:00:48,690 --> 00:00:52,800
was put together like a month or two ago

22
00:00:50,940 --> 00:00:54,690
and I haven't looked at a sense this is

23
00:00:52,800 --> 00:00:56,940
my second presentation of the weekend so

24
00:00:54,690 --> 00:01:00,089
I apologize for any repetition or

25
00:00:56,940 --> 00:01:01,320
stumbling over this I do because the

26
00:01:00,090 --> 00:01:04,040
order of these slides is as much a

27
00:01:01,320 --> 00:01:08,369
surprise to me as it is to you so

28
00:01:04,040 --> 00:01:09,840
hopefully we get going on that a little

29
00:01:08,369 --> 00:01:13,229
bit about me I'm a security researcher

30
00:01:09,840 --> 00:01:14,729
at tenable thanks to them for you know

31
00:01:13,229 --> 00:01:17,580
like letting me do those kind of stuff

32
00:01:14,729 --> 00:01:19,920
for my day job it's really all you need

33
00:01:17,580 --> 00:01:22,798
to know about me these are my dogs this

34
00:01:19,920 --> 00:01:24,659
is my cat he's the favorite all of this

35
00:01:22,799 --> 00:01:27,509
is irrelevant to the talk so I'm just

36
00:01:24,659 --> 00:01:29,130
gonna go ahead and get moving on a

37
00:01:27,509 --> 00:01:31,530
little bit about we're gonna talk about

38
00:01:29,130 --> 00:01:34,350
this talk is not gonna last the full 50

39
00:01:31,530 --> 00:01:36,869
minutes since its beginner oriented like

40
00:01:34,350 --> 00:01:38,610
I see a lot of people kind of drone on

41
00:01:36,869 --> 00:01:40,740
and on and fall asleep but for talks

42
00:01:38,610 --> 00:01:44,250
that actually last the full length

43
00:01:40,740 --> 00:01:46,850
especially like post-lunch coma and most

44
00:01:44,250 --> 00:01:49,140
of you look hungover from last night so

45
00:01:46,850 --> 00:01:52,380
I'm gonna talk a little bit about like

46
00:01:49,140 --> 00:01:55,680
past surveillance systems more recent

47
00:01:52,380 --> 00:01:57,329
trends and surveillance systems for IOT

48
00:01:55,680 --> 00:02:00,090
devices and like the cheaper stuff that

49
00:01:57,329 --> 00:02:02,070
we see everywhere these days then talk

50
00:02:00,090 --> 00:02:07,409
about the actual research process I took

51
00:02:02,070 --> 00:02:10,590
taking apart the arlo cameras so past

52
00:02:07,409 --> 00:02:13,600
surveillance systems we're talking 5 10

53
00:02:10,590 --> 00:02:16,490
15 even 20 years ago

54
00:02:13,600 --> 00:02:18,549
wireless cheap cameras haven't really

55
00:02:16,490 --> 00:02:21,830
been mainstream up until the last like

56
00:02:18,550 --> 00:02:23,930
maybe five or six years it used to be

57
00:02:21,830 --> 00:02:26,690
anytime you went to like a gas station

58
00:02:23,930 --> 00:02:30,080
or a small convenience store it would

59
00:02:26,690 --> 00:02:32,959
cost like five six thousand dollars just

60
00:02:30,080 --> 00:02:35,000
to run a single CCTV not only that you

61
00:02:32,959 --> 00:02:37,430
can actually buy that equipment or you

62
00:02:35,000 --> 00:02:39,290
couldn't at the time yourself you have

63
00:02:37,430 --> 00:02:41,930
to call someone and have them install it

64
00:02:39,290 --> 00:02:44,920
and then set up your VHS player and TV

65
00:02:41,930 --> 00:02:47,269
in the back to actually monitor it so

66
00:02:44,920 --> 00:02:49,339
none of this was actually accessible to

67
00:02:47,269 --> 00:02:51,019
everyday consumers I remember when I

68
00:02:49,340 --> 00:02:53,900
worked at like Cold Stone Creamery as a

69
00:02:51,019 --> 00:02:55,280
Creamery as a teenager any time we

70
00:02:53,900 --> 00:02:57,290
needed to monitor the security feeds we

71
00:02:55,280 --> 00:02:59,569
had to call an external company yet even

72
00:02:57,290 --> 00:03:02,179
today for enterprises you can't actually

73
00:02:59,569 --> 00:03:03,319
go out and buy this stuff yourself you

74
00:03:02,180 --> 00:03:05,180
have to contact a third-party

75
00:03:03,319 --> 00:03:07,850
distributor have them come and install

76
00:03:05,180 --> 00:03:09,019
it and then if you ever want to update

77
00:03:07,850 --> 00:03:10,190
that software you have to call them

78
00:03:09,019 --> 00:03:12,380
again they charge you like a ten

79
00:03:10,190 --> 00:03:14,720
thousand dollar fee just to update it so

80
00:03:12,380 --> 00:03:17,329
a lot of this equipment was very old

81
00:03:14,720 --> 00:03:20,660
very much hard wired connections that

82
00:03:17,329 --> 00:03:22,670
you had to run cable for not really the

83
00:03:20,660 --> 00:03:24,709
most consumer friendly so you didn't see

84
00:03:22,670 --> 00:03:27,760
security cameras on you know people's

85
00:03:24,709 --> 00:03:27,760
doorbells like you do today

86
00:03:27,890 --> 00:03:34,429
moving into like the present time the

87
00:03:31,519 --> 00:03:36,019
stuff got really really popular devices

88
00:03:34,430 --> 00:03:38,900
are now only a couple hundred bucks

89
00:03:36,019 --> 00:03:43,459
they're pretty much accessible

90
00:03:38,900 --> 00:03:46,430
everywhere in terms of new functionality

91
00:03:43,459 --> 00:03:47,989
there's nothing new the devices that

92
00:03:46,430 --> 00:03:51,010
existed five years ago exist today

93
00:03:47,989 --> 00:03:53,900
there's just shitload more of them

94
00:03:51,010 --> 00:03:54,290
mostly because they're only a hundred

95
00:03:53,900 --> 00:03:56,209
bucks

96
00:03:54,290 --> 00:03:57,950
200 bucks for an entire kit of two or

97
00:03:56,209 --> 00:04:00,970
three cameras to assess your entire

98
00:03:57,950 --> 00:04:04,010
property they're all Wireless they're

99
00:04:00,970 --> 00:04:08,989
easy enough to set up that my mother can

100
00:04:04,010 --> 00:04:11,000
do it so that's saying something and as

101
00:04:08,989 --> 00:04:12,230
proof that they're everywhere both

102
00:04:11,000 --> 00:04:14,359
neighbors on either side of me in our

103
00:04:12,230 --> 00:04:15,530
new house have simply saved cameras the

104
00:04:14,359 --> 00:04:18,109
guy down the street has an entire

105
00:04:15,530 --> 00:04:19,608
bippity setup I have Arlo the neighbor

106
00:04:18,108 --> 00:04:22,099
across the street uses the blink

107
00:04:19,608 --> 00:04:23,570
security cameras I can't think of anyone

108
00:04:22,099 --> 00:04:26,469
that doesn't have a ring doorbell

109
00:04:23,570 --> 00:04:30,760
monitor anymore so these things are

110
00:04:26,470 --> 00:04:32,500
very prevalent in our everyday lives now

111
00:04:30,760 --> 00:04:35,260
targeting our low why did I pick Carlo

112
00:04:32,500 --> 00:04:37,420
well I need his security camera it was

113
00:04:35,260 --> 00:04:39,880
Black Friday so I bought one of these

114
00:04:37,420 --> 00:04:44,410
that's really the entire story of how I

115
00:04:39,880 --> 00:04:46,450
picked this it also is really popular

116
00:04:44,410 --> 00:04:48,400
and there wasn't much research on it so

117
00:04:46,450 --> 00:04:50,740
I saw an opportunity there just to kind

118
00:04:48,400 --> 00:04:54,760
of start taking this apart the last

119
00:04:50,740 --> 00:04:56,320
published stuff was back in 2015 up

120
00:04:54,760 --> 00:04:59,830
until I started taking over these and

121
00:04:56,320 --> 00:05:02,110
there were only two CVEs which is kind

122
00:04:59,830 --> 00:05:05,200
of odd for a big company like net year

123
00:05:02,110 --> 00:05:07,300
to only have two CVEs for one other like

124
00:05:05,200 --> 00:05:08,860
biggest products so I was kind of

125
00:05:07,300 --> 00:05:10,240
curious what was going on there did they

126
00:05:08,860 --> 00:05:14,230
actually put a lot of money into

127
00:05:10,240 --> 00:05:15,360
securing these devices or like was there

128
00:05:14,230 --> 00:05:17,350
something else going on and

129
00:05:15,360 --> 00:05:19,390
unfortunately I can't actually talk

130
00:05:17,350 --> 00:05:20,680
about that something else but if you

131
00:05:19,390 --> 00:05:25,229
look at our disclosure timeline you'll

132
00:05:20,680 --> 00:05:25,230
get a big hint of what's going on there

133
00:05:25,800 --> 00:05:30,700
so first taking apart the device after

134
00:05:28,900 --> 00:05:33,039
you buy it take it out of the box all it

135
00:05:30,700 --> 00:05:37,300
is little base station camera some

136
00:05:33,040 --> 00:05:38,740
cables in order to play with it all

137
00:05:37,300 --> 00:05:41,680
there's a web application which is flash

138
00:05:38,740 --> 00:05:43,240
based so don't use it but the mobile

139
00:05:41,680 --> 00:05:47,890
apps are actually pretty solid and

140
00:05:43,240 --> 00:05:50,020
pretty easy to use it really is as easy

141
00:05:47,890 --> 00:05:53,650
as plugging and pressing the sync

142
00:05:50,020 --> 00:05:55,060
buttons and letting it go as soon as you

143
00:05:53,650 --> 00:05:57,219
turn everything on and sync it it's

144
00:05:55,060 --> 00:06:00,490
working very well very high-quality

145
00:05:57,220 --> 00:06:05,080
images the motion detection was pretty

146
00:06:00,490 --> 00:06:06,820
flawless and it does something

147
00:06:05,080 --> 00:06:08,859
interesting that I hadn't seen in many

148
00:06:06,820 --> 00:06:10,930
of these devices before it actually does

149
00:06:08,860 --> 00:06:13,570
all the network segmentation for you as

150
00:06:10,930 --> 00:06:16,780
security practitioners we tend to have

151
00:06:13,570 --> 00:06:19,000
this you know mantra of put it on its

152
00:06:16,780 --> 00:06:21,429
own VLAN or make sure it's not on your

153
00:06:19,000 --> 00:06:23,350
main network the base station here

154
00:06:21,430 --> 00:06:25,540
actually does that for you it segregates

155
00:06:23,350 --> 00:06:29,050
all of the cameras onto their own little

156
00:06:25,540 --> 00:06:31,080
wireless network so obviously still put

157
00:06:29,050 --> 00:06:34,169
your base station on its own VLAN but

158
00:06:31,080 --> 00:06:37,710
it'll handle all of the actual like

159
00:06:34,169 --> 00:06:37,710
segmenting for you

160
00:06:37,900 --> 00:06:43,150
it does sync via WPS one thing I don't

161
00:06:40,449 --> 00:06:45,520
mention in the talk we all kind of roll

162
00:06:43,150 --> 00:06:46,688
our eyes when we see WPS but they did a

163
00:06:45,520 --> 00:06:49,240
good job and have all of the

164
00:06:46,689 --> 00:06:51,909
brute-forcing stuff disabled so it is

165
00:06:49,240 --> 00:06:53,740
actually pretty solid and they have some

166
00:06:51,909 --> 00:06:56,379
Mac filtering which easy enough to

167
00:06:53,740 --> 00:06:58,389
bypass but for the typical user you can

168
00:06:56,379 --> 00:06:59,650
only pair Barlowe cameras with it it

169
00:06:58,389 --> 00:07:01,419
will eventually kick you off if you

170
00:06:59,650 --> 00:07:06,669
don't have like a net year registered

171
00:07:01,419 --> 00:07:08,529
mac address so before I actually dig

172
00:07:06,669 --> 00:07:11,109
into the device myself I wanted to look

173
00:07:08,529 --> 00:07:12,819
at what was published before me the only

174
00:07:11,110 --> 00:07:15,460
information out there aside from like a

175
00:07:12,819 --> 00:07:20,499
few tear downs on Chinese websites or

176
00:07:15,460 --> 00:07:23,498
like the SEC ID dot IO tear down images

177
00:07:20,499 --> 00:07:26,050
where two things from new sky security

178
00:07:23,499 --> 00:07:27,669
they really had three big

179
00:07:26,050 --> 00:07:30,520
vulnerabilities they published but only

180
00:07:27,669 --> 00:07:34,599
two of them were assigned CDs and it

181
00:07:30,520 --> 00:07:36,818
dealt with password flaws so when you

182
00:07:34,599 --> 00:07:38,949
originally bought the device if you

183
00:07:36,819 --> 00:07:40,659
reset it after the initial setup it

184
00:07:38,949 --> 00:07:42,819
would just reset that internal Wi-Fi

185
00:07:40,659 --> 00:07:44,710
password to one two three four five six

186
00:07:42,819 --> 00:07:46,659
seven eight and then anyone could

187
00:07:44,710 --> 00:07:50,919
connect to that Wi-Fi network and start

188
00:07:46,659 --> 00:07:52,539
man and milling your cameras so when

189
00:07:50,919 --> 00:07:54,818
they reported that Netgear their fix was

190
00:07:52,539 --> 00:07:56,409
to make it very predictable it was

191
00:07:54,819 --> 00:07:59,919
literally a word list on the device that

192
00:07:56,409 --> 00:08:01,629
you could connect to and like all they

193
00:07:59,919 --> 00:08:05,258
did was pull a random word from that

194
00:08:01,629 --> 00:08:06,729
file and that was the password so if you

195
00:08:05,259 --> 00:08:08,349
had access to that file you could still

196
00:08:06,729 --> 00:08:14,378
connect to any network just by trying

197
00:08:08,349 --> 00:08:16,180
all of the passwords after going through

198
00:08:14,379 --> 00:08:17,680
their information I'll talk about the

199
00:08:16,180 --> 00:08:21,430
manna milling they did on the camera

200
00:08:17,680 --> 00:08:23,919
networks here in a little bit I kind of

201
00:08:21,430 --> 00:08:32,289
want to take a look at what our actual

202
00:08:23,919 --> 00:08:33,789
external attack surface is scanning the

203
00:08:32,289 --> 00:08:36,189
device externally there's only a single

204
00:08:33,789 --> 00:08:39,519
port open 5061

205
00:08:36,190 --> 00:08:41,469
that's for encrypted sip traffic which

206
00:08:39,519 --> 00:08:46,000
is typically used by like voice over IP

207
00:08:41,469 --> 00:08:47,260
network phones unfortunately there's not

208
00:08:46,000 --> 00:08:49,660
a lot that can be done with that port

209
00:08:47,260 --> 00:08:53,350
I'll mention that again at the end of

210
00:08:49,660 --> 00:08:54,010
the presentation we know all

211
00:08:53,350 --> 00:08:56,950
communication

212
00:08:54,010 --> 00:08:59,110
happens the Wi-Fi there's no other

213
00:08:56,950 --> 00:09:01,000
radios or antennas all devices we can

214
00:08:59,110 --> 00:09:03,190
tell that one by looking at the hardware

215
00:09:01,000 --> 00:09:07,630
and two by seeing what the device is

216
00:09:03,190 --> 00:09:09,160
registered with yeah FCC under and then

217
00:09:07,630 --> 00:09:11,410
there's the obvious cloud connection

218
00:09:09,160 --> 00:09:13,480
these are always on devices in order to

219
00:09:11,410 --> 00:09:15,189
actually access your camera streams you

220
00:09:13,480 --> 00:09:17,440
have to go through Arlo everything goes

221
00:09:15,190 --> 00:09:21,700
to them I think we're all familiar with

222
00:09:17,440 --> 00:09:25,690
that process by now looking at the

223
00:09:21,700 --> 00:09:27,190
device taking it apart there's a couple

224
00:09:25,690 --> 00:09:29,500
of antennas through a couple of shield

225
00:09:27,190 --> 00:09:31,480
cans that cover the you know wireless

226
00:09:29,500 --> 00:09:34,840
components to prevent interference then

227
00:09:31,480 --> 00:09:38,560
there's this magical thing here that's

228
00:09:34,840 --> 00:09:40,510
an open serial port on the device with

229
00:09:38,560 --> 00:09:43,420
no other protections there's nothing

230
00:09:40,510 --> 00:09:46,630
funny about it it conforms to the SPI

231
00:09:43,420 --> 00:09:49,780
spec directly so all you got to do is

232
00:09:46,630 --> 00:09:52,720
just you know connect to it and what

233
00:09:49,780 --> 00:09:54,370
prior research to me did was connect to

234
00:09:52,720 --> 00:09:56,740
this and it drops a roof shell no

235
00:09:54,370 --> 00:09:58,630
authentication no nothing unfortunately

236
00:09:56,740 --> 00:10:03,520
for me these devices have been updated

237
00:09:58,630 --> 00:10:04,780
since then I'll talk more about actually

238
00:10:03,520 --> 00:10:06,730
connecting that and how I wound up

239
00:10:04,780 --> 00:10:08,290
getting access here in just a second

240
00:10:06,730 --> 00:10:10,690
but let's review the attack surface

241
00:10:08,290 --> 00:10:12,430
really quick since I'm looking at

242
00:10:10,690 --> 00:10:13,900
primarily the base station since the

243
00:10:12,430 --> 00:10:17,410
cameras aren't exposed on your own

244
00:10:13,900 --> 00:10:20,100
network there's that sip interface port

245
00:10:17,410 --> 00:10:22,839
we'll talk about again later there are

246
00:10:20,100 --> 00:10:25,390
binaries that we can hopefully get to

247
00:10:22,840 --> 00:10:27,250
through the serial interface there's the

248
00:10:25,390 --> 00:10:29,020
internal network and then the actual

249
00:10:27,250 --> 00:10:30,610
networking components the device so it's

250
00:10:29,020 --> 00:10:37,569
a pretty lockdown attack surface there's

251
00:10:30,610 --> 00:10:40,240
not a lot we can really do with this so

252
00:10:37,570 --> 00:10:43,390
new sky security did write up their pin

253
00:10:40,240 --> 00:10:45,220
out after figuring these out I'm a big

254
00:10:43,390 --> 00:10:46,810
fan of trust but verify when it comes to

255
00:10:45,220 --> 00:10:47,980
hardware especially since there are

256
00:10:46,810 --> 00:10:51,130
several different models of the base

257
00:10:47,980 --> 00:10:53,710
station when Netgear actually acquired

258
00:10:51,130 --> 00:10:55,570
Arlo there was these old like tacky

259
00:10:53,710 --> 00:10:58,920
plastic round hubs that they used

260
00:10:55,570 --> 00:11:04,780
nowadays they're less than glamorous

261
00:10:58,920 --> 00:11:06,979
plastic mat hubs so the hardware is more

262
00:11:04,780 --> 00:11:08,449
or less the same

263
00:11:06,980 --> 00:11:11,350
just in case they changed the pan out

264
00:11:08,450 --> 00:11:13,220
it's helpful to figure this out yourself

265
00:11:11,350 --> 00:11:14,540
not going to go through the process of

266
00:11:13,220 --> 00:11:15,829
figuring out the pin out I do have a

267
00:11:14,540 --> 00:11:20,660
write-up separate from this talk that

268
00:11:15,829 --> 00:11:22,339
you can use to find find that but once

269
00:11:20,660 --> 00:11:26,180
you figure out the pin out and solder up

270
00:11:22,339 --> 00:11:27,170
you can connect to it if your connection

271
00:11:26,180 --> 00:11:29,540
is right when you boot up the vise

272
00:11:27,170 --> 00:11:34,040
you'll start getting a bunch of boot

273
00:11:29,540 --> 00:11:36,290
logs and output will come to this slide

274
00:11:34,040 --> 00:11:38,839
again later but you can see all of the

275
00:11:36,290 --> 00:11:40,930
mounted memory addresses from like the

276
00:11:38,839 --> 00:11:43,760
flash chips they're so like zero to

277
00:11:40,930 --> 00:11:45,920
8,000 or 80,000 it's like the boot

278
00:11:43,760 --> 00:11:48,220
partition then you've got some nvram

279
00:11:45,920 --> 00:11:50,839
you've got the route FS whatnot

280
00:11:48,220 --> 00:11:53,029
unfortunately after it boots you've got

281
00:11:50,839 --> 00:11:57,199
some authentication this was not present

282
00:11:53,029 --> 00:11:59,360
in any other research that I found it

283
00:11:57,199 --> 00:12:01,250
was just like a busybox login prompt

284
00:11:59,360 --> 00:12:03,380
that didn't accept anything there was no

285
00:12:01,250 --> 00:12:07,149
single user mode I could do it into so I

286
00:12:03,380 --> 00:12:10,130
did figure out a way around that if you

287
00:12:07,149 --> 00:12:11,120
you know control see when things booting

288
00:12:10,130 --> 00:12:13,699
up you can actually access the

289
00:12:11,120 --> 00:12:15,470
bootloader this thing uses the CFE or

290
00:12:13,699 --> 00:12:17,719
common firmware environment bootloader

291
00:12:15,470 --> 00:12:21,740
pretty common among most Netgear and

292
00:12:17,720 --> 00:12:24,410
like home consumer routing devices and

293
00:12:21,740 --> 00:12:26,420
you can use it to show all of the

294
00:12:24,410 --> 00:12:29,510
connected flash devices you can monitor

295
00:12:26,420 --> 00:12:32,209
like nvram values just kind of pull

296
00:12:29,510 --> 00:12:37,189
things apart and try to see what's going

297
00:12:32,209 --> 00:12:41,329
on so they had the special values called

298
00:12:37,190 --> 00:12:44,899
UART username and you our password just

299
00:12:41,329 --> 00:12:47,180
written like this in the NVRAM these

300
00:12:44,899 --> 00:12:51,649
look like base64 values that decode to

301
00:12:47,180 --> 00:12:53,719
md5 hashes they are not so had to come

302
00:12:51,649 --> 00:12:56,779
up with a different way to do it

303
00:12:53,720 --> 00:12:59,390
see if he has a safe command if you have

304
00:12:56,779 --> 00:13:01,640
a TFTP network or server on your network

305
00:12:59,390 --> 00:13:04,519
you can use the save command to transfer

306
00:13:01,640 --> 00:13:08,980
arbitrary memory from the device or any

307
00:13:04,519 --> 00:13:14,779
flash region to your own home server so

308
00:13:08,980 --> 00:13:16,100
once you have these memory regions you

309
00:13:14,779 --> 00:13:18,140
can just write them to your own server

310
00:13:16,100 --> 00:13:20,420
and then have the firmware that way a

311
00:13:18,140 --> 00:13:22,519
lot of vendors will disable this

312
00:13:20,420 --> 00:13:25,449
feature in their bootloader Arlo does

313
00:13:22,519 --> 00:13:27,680
not so after we get that and run strings

314
00:13:25,450 --> 00:13:29,630
they literally have the decryption

315
00:13:27,680 --> 00:13:33,199
routines in plain text in the firmware

316
00:13:29,630 --> 00:13:36,380
image so the username and password is

317
00:13:33,200 --> 00:13:37,510
just ng root and ng base and you're good

318
00:13:36,380 --> 00:13:40,760
to go

319
00:13:37,510 --> 00:13:46,279
so all you do is have to login we now

320
00:13:40,760 --> 00:13:49,730
have a root access to the device so once

321
00:13:46,279 --> 00:13:52,519
we're in the filesystem is pretty simple

322
00:13:49,730 --> 00:13:54,860
there's not really a ton on it there are

323
00:13:52,519 --> 00:13:57,560
a few like configuration commands we can

324
00:13:54,860 --> 00:14:00,529
use and run just to get like version

325
00:13:57,560 --> 00:14:02,810
information network information there is

326
00:14:00,529 --> 00:14:04,670
an HTTP interface that's disabled by

327
00:14:02,810 --> 00:14:06,290
default but the username and password if

328
00:14:04,670 --> 00:14:07,910
you happen to enable it as just admin

329
00:14:06,290 --> 00:14:14,779
and password

330
00:14:07,910 --> 00:14:16,730
super secure and then there's the WPA

331
00:14:14,779 --> 00:14:19,610
key which is encrypted in the via nvram

332
00:14:16,730 --> 00:14:26,899
and very difficult to decrypt just based

333
00:14:19,610 --> 00:14:30,680
on its length and I'll mention that key

334
00:14:26,899 --> 00:14:32,290
here again in a minute but taking a look

335
00:14:30,680 --> 00:14:34,430
at the service is running on the device

336
00:14:32,290 --> 00:14:36,560
this light isn't super helpful because

337
00:14:34,430 --> 00:14:38,209
it's just a jumble of addresses but we

338
00:14:36,560 --> 00:14:40,250
can see that there's only one service

339
00:14:38,209 --> 00:14:41,750
listening globally and then everything

340
00:14:40,250 --> 00:14:43,430
else happens to be listening on the

341
00:14:41,750 --> 00:14:47,649
internal network interface that we can't

342
00:14:43,430 --> 00:14:47,649
access without being on that network

343
00:14:47,920 --> 00:14:52,250
looking at like what bye

344
00:14:50,510 --> 00:14:55,040
or what processes are actually running

345
00:14:52,250 --> 00:14:57,860
that run on these ports there's VZ

346
00:14:55,040 --> 00:14:59,899
daemon X Agent X agent watchdog the X

347
00:14:57,860 --> 00:15:02,000
agent stuff totally irrelevant all it

348
00:14:59,899 --> 00:15:03,620
does is monitor to make sure the rest of

349
00:15:02,000 --> 00:15:07,779
the like VZ daemon is running correctly

350
00:15:03,620 --> 00:15:07,779
if it's not it just reboots the device

351
00:15:08,269 --> 00:15:13,310
there's the SIP interface that I keep

352
00:15:10,459 --> 00:15:15,589
talking about I hate it I have no idea

353
00:15:13,310 --> 00:15:19,550
what it does still again I'll keep

354
00:15:15,589 --> 00:15:23,630
talking about that later there's these

355
00:15:19,550 --> 00:15:25,069
internal stuff port 4040 140 200 they

356
00:15:23,630 --> 00:15:26,899
are only listening on the internal

357
00:15:25,069 --> 00:15:30,589
network they're what the cameras use to

358
00:15:26,899 --> 00:15:32,569
connect to the base station that's what

359
00:15:30,589 --> 00:15:34,440
all the video streams audio feeds will

360
00:15:32,569 --> 00:15:36,910
actually go over

361
00:15:34,440 --> 00:15:39,100
then it's listening internally on port

362
00:15:36,910 --> 00:15:43,110
80 which was weird because the cameras

363
00:15:39,100 --> 00:15:45,610
never touched this port as it turns out

364
00:15:43,110 --> 00:15:48,010
this is running a like hidden

365
00:15:45,610 --> 00:15:51,370
administrative console it's got an inner

366
00:15:48,010 --> 00:15:54,689
it's got three little API commands one

367
00:15:51,370 --> 00:15:57,370
is file one is pass-through and one is

368
00:15:54,690 --> 00:15:58,860
version version just spits out model

369
00:15:57,370 --> 00:16:00,880
information on the device but

370
00:15:58,860 --> 00:16:03,670
pass-through and file allow you to

371
00:16:00,880 --> 00:16:05,830
download and upload arbitrary files to

372
00:16:03,670 --> 00:16:07,870
the device since beezy daemon contains

373
00:16:05,830 --> 00:16:10,000
all functionality for the device it'll

374
00:16:07,870 --> 00:16:12,670
periodically run ping just to check the

375
00:16:10,000 --> 00:16:15,030
like network access isn't working so if

376
00:16:12,670 --> 00:16:17,079
you overwrite ping with your own file

377
00:16:15,030 --> 00:16:22,720
because you have root access you now

378
00:16:17,080 --> 00:16:24,760
have full execution on the device moving

379
00:16:22,720 --> 00:16:25,870
a little bit quick here but I'm just

380
00:16:24,760 --> 00:16:29,380
gonna go ahead and start jumping into

381
00:16:25,870 --> 00:16:33,520
summary of the findings we've got

382
00:16:29,380 --> 00:16:36,689
insufficient UART protection so really

383
00:16:33,520 --> 00:16:39,880
not the biggest deal in the world but

384
00:16:36,690 --> 00:16:41,830
it's very helpful for the home routing

385
00:16:39,880 --> 00:16:43,390
community or home automation communities

386
00:16:41,830 --> 00:16:45,910
to be able to kind of connect to these

387
00:16:43,390 --> 00:16:47,860
devices read the configs themselves one

388
00:16:45,910 --> 00:16:49,300
thing I see on Arlo forums a lot is the

389
00:16:47,860 --> 00:16:51,310
range of the base station is really

390
00:16:49,300 --> 00:16:53,920
really short so if you have a long

391
00:16:51,310 --> 00:16:56,800
shotgun home or just a large property

392
00:16:53,920 --> 00:16:59,410
you can't really run that many cameras

393
00:16:56,800 --> 00:17:00,550
too far away but if you have access to

394
00:16:59,410 --> 00:17:01,900
the configs and you can get your

395
00:17:00,550 --> 00:17:04,000
password you can set up your own range

396
00:17:01,900 --> 00:17:06,910
extenders that are low still doesn't

397
00:17:04,000 --> 00:17:08,170
provide themselves it helps you just you

398
00:17:06,910 --> 00:17:14,020
know expand your environment a little

399
00:17:08,170 --> 00:17:16,420
bit there were a lot of plain text

400
00:17:14,020 --> 00:17:17,650
passwords in there there were I don't

401
00:17:16,420 --> 00:17:19,209
have them all listed here and the

402
00:17:17,650 --> 00:17:22,209
corresponding blog post I have them all

403
00:17:19,209 --> 00:17:25,810
spelled out for you but like let's and

404
00:17:22,209 --> 00:17:27,699
let's at flats and guest and gear UCP

405
00:17:25,810 --> 00:17:29,919
your guy your dog some of those are

406
00:17:27,699 --> 00:17:31,420
already public but some of them no idea

407
00:17:29,920 --> 00:17:35,350
what they go to but there are a bunch of

408
00:17:31,420 --> 00:17:38,260
pppoe services that go on since I don't

409
00:17:35,350 --> 00:17:40,480
own those or access them I didn't try to

410
00:17:38,260 --> 00:17:43,390
do like push any further since this was

411
00:17:40,480 --> 00:17:46,480
you know company related research if

412
00:17:43,390 --> 00:17:47,740
anyone wants to look at that feel free

413
00:17:46,480 --> 00:17:50,770
but please tell me if you

414
00:17:47,740 --> 00:17:52,570
actually find anything through the

415
00:17:50,770 --> 00:17:55,360
disclosure process Netgear and Arlo said

416
00:17:52,570 --> 00:17:59,678
they didn't do anything take that for

417
00:17:55,360 --> 00:18:01,449
what you will the main finding I found

418
00:17:59,679 --> 00:18:03,850
though is there was a big Network miss

419
00:18:01,450 --> 00:18:07,420
configuration that internal network if

420
00:18:03,850 --> 00:18:10,780
you specify the main router as or like

421
00:18:07,420 --> 00:18:14,200
the main interface as you're like

422
00:18:10,780 --> 00:18:16,330
gateway you can access that internal

423
00:18:14,200 --> 00:18:19,420
network since the entire base station is

424
00:18:16,330 --> 00:18:22,030
based on a previously released netgear

425
00:18:19,420 --> 00:18:24,460
wireless extender it's still just a

426
00:18:22,030 --> 00:18:27,370
router itself so you can ping the

427
00:18:24,460 --> 00:18:29,140
cameras you can access those internal

428
00:18:27,370 --> 00:18:30,639
administrative consoles so if you're on

429
00:18:29,140 --> 00:18:33,900
the same land as the base station you

430
00:18:30,640 --> 00:18:33,900
now have a root access on the device

431
00:18:34,770 --> 00:18:39,940
just kind of as proof of that just

432
00:18:37,320 --> 00:18:42,790
specifying my routing table to go to

433
00:18:39,940 --> 00:18:46,330
that internal interface from LAN I can

434
00:18:42,790 --> 00:18:51,730
access the syslog and just view anything

435
00:18:46,330 --> 00:18:53,649
on the device mainland million cameras

436
00:18:51,730 --> 00:18:55,030
all configs passed on that internal

437
00:18:53,650 --> 00:18:56,800
network since it's a Wi-Fi network

438
00:18:55,030 --> 00:18:57,790
that's pretty hard to connect to if you

439
00:18:56,800 --> 00:19:01,210
don't have the password

440
00:18:57,790 --> 00:19:03,280
Arlo assumes everything there is safe so

441
00:19:01,210 --> 00:19:05,170
everything is sent in plaintext video is

442
00:19:03,280 --> 00:19:08,290
not encrypted if you man in the middle

443
00:19:05,170 --> 00:19:10,230
it's just an RTSP stream so you can live

444
00:19:08,290 --> 00:19:14,950
stream any video from any of the cameras

445
00:19:10,230 --> 00:19:17,110
I didn't want to include the picture

446
00:19:14,950 --> 00:19:19,270
here just because it's obfuscated and

447
00:19:17,110 --> 00:19:25,600
like I didn't want my own home stuff

448
00:19:19,270 --> 00:19:28,809
broadcast publicly also in the image all

449
00:19:25,600 --> 00:19:31,360
of our lows private keys for firmware

450
00:19:28,809 --> 00:19:34,149
encryption and decryption are included

451
00:19:31,360 --> 00:19:35,770
within the binaries on the device so if

452
00:19:34,150 --> 00:19:38,050
anyone wants to download their firmware

453
00:19:35,770 --> 00:19:40,389
like it's all there you can use these to

454
00:19:38,050 --> 00:19:43,120
decrypt it none of these have been

455
00:19:40,390 --> 00:19:47,800
previously released except in a couple

456
00:19:43,120 --> 00:19:49,899
of blog posts I've made the disclosure

457
00:19:47,800 --> 00:19:51,850
process this was one of the longer

458
00:19:49,900 --> 00:19:54,550
disclosures I've ever done that was I

459
00:19:51,850 --> 00:19:57,370
know you can't really read that but more

460
00:19:54,550 --> 00:19:59,620
or less I disclosed in March and then

461
00:19:57,370 --> 00:20:01,639
had multiple weekly follow ups with the

462
00:19:59,620 --> 00:20:04,039
vendor there was a lot of back

463
00:20:01,639 --> 00:20:06,498
fourth than a lot of silence from the

464
00:20:04,039 --> 00:20:07,879
vendor then a lot of back-and-forth then

465
00:20:06,499 --> 00:20:10,309
finally they're like we're working I

466
00:20:07,879 --> 00:20:12,259
we're working on it so we waited and

467
00:20:10,309 --> 00:20:15,499
then we finally published after they

468
00:20:12,259 --> 00:20:18,079
like surprise released on us that being

469
00:20:15,499 --> 00:20:21,019
said they did a great job

470
00:20:18,079 --> 00:20:22,999
they actually patched the issues the

471
00:20:21,019 --> 00:20:25,070
UART stuff they can't fix without

472
00:20:22,999 --> 00:20:27,829
recalling devices so that's still a

473
00:20:25,070 --> 00:20:30,678
problem but in general they actually did

474
00:20:27,829 --> 00:20:32,209
a really good job especially since the

475
00:20:30,679 --> 00:20:36,349
device in general the attack surface is

476
00:20:32,209 --> 00:20:41,239
pretty limited yeah now getting to that

477
00:20:36,349 --> 00:20:43,609
sip interface my fury is this sip

478
00:20:41,239 --> 00:20:46,159
interface is for the doorbell cameras

479
00:20:43,609 --> 00:20:49,639
and microphones I can tell from the

480
00:20:46,159 --> 00:20:51,049
mobile app that it may have been used

481
00:20:49,639 --> 00:20:53,809
for device enrollment at one point in

482
00:20:51,049 --> 00:20:56,450
time it doesn't appear to anymore but

483
00:20:53,809 --> 00:21:00,168
within the mobile app the passwords for

484
00:20:56,450 --> 00:21:02,509
the actual sip console are hard-coded so

485
00:21:00,169 --> 00:21:05,719
the username and password are just one

486
00:21:02,509 --> 00:21:07,099
zero two five for both so if anyone has

487
00:21:05,719 --> 00:21:09,979
one of the doorbells and wants to try

488
00:21:07,099 --> 00:21:13,070
connecting to it with any of the pj sip

489
00:21:09,979 --> 00:21:16,389
utilities please do because i'm really

490
00:21:13,070 --> 00:21:16,389
curious to know if they actually work

491
00:21:16,570 --> 00:21:21,529
other things that could be looked at the

492
00:21:19,519 --> 00:21:23,989
clock muezzin communications they do

493
00:21:21,529 --> 00:21:25,789
certificate pinning and verification

494
00:21:23,989 --> 00:21:27,289
everything very very well it's all very

495
00:21:25,789 --> 00:21:30,589
well handled

496
00:21:27,289 --> 00:21:33,919
i didn't try to do any testing on the

497
00:21:30,589 --> 00:21:35,178
cloud networks myself i just really

498
00:21:33,919 --> 00:21:42,229
don't like touching things that i don't

499
00:21:35,179 --> 00:21:44,690
own if you do please let me know any of

500
00:21:42,229 --> 00:21:47,089
their extra credentials no idea what

501
00:21:44,690 --> 00:21:49,909
they do still so if anyone wants to take

502
00:21:47,089 --> 00:21:55,369
those and go forward that's all fair

503
00:21:49,909 --> 00:21:58,070
game again the goal of this talk was

504
00:21:55,369 --> 00:21:59,749
more talking about like my process of

505
00:21:58,070 --> 00:22:01,908
like what did i look at what did i find

506
00:21:59,749 --> 00:22:04,609
important and kind of walk through in

507
00:22:01,909 --> 00:22:07,539
terms of security posture this is one of

508
00:22:04,609 --> 00:22:10,309
the better devices i've looked at i

509
00:22:07,539 --> 00:22:13,039
expected this to be like a really easy

510
00:22:10,309 --> 00:22:13,908
target with like cds just to fall out as

511
00:22:13,039 --> 00:22:15,510
I choked it

512
00:22:13,909 --> 00:22:18,330
unfortunately that wasn't that

513
00:22:15,510 --> 00:22:19,830
the case the biggest downside with this

514
00:22:18,330 --> 00:22:21,510
kind of stuff for me is I don't like the

515
00:22:19,830 --> 00:22:23,460
always on always connected devices I

516
00:22:21,510 --> 00:22:26,250
don't like my data going somewhere out

517
00:22:23,460 --> 00:22:29,370
of my control that being said it's cheap

518
00:22:26,250 --> 00:22:30,360
and very easy for consumers to use so

519
00:22:29,370 --> 00:22:34,409
there's a little bit of give and take

520
00:22:30,360 --> 00:22:37,110
there in terms of non security related

521
00:22:34,410 --> 00:22:38,910
stuff it's great that we can like

522
00:22:37,110 --> 00:22:40,500
contribute to like the open source

523
00:22:38,910 --> 00:22:42,030
routing communities by releasing the

524
00:22:40,500 --> 00:22:44,940
decryption keys so they can modify this

525
00:22:42,030 --> 00:22:46,260
firmware and hopefully make it a little

526
00:22:44,940 --> 00:22:48,870
bit better and more accessible in terms

527
00:22:46,260 --> 00:22:53,129
of more control over like your

528
00:22:48,870 --> 00:22:56,959
information I kind of blitz through all

529
00:22:53,130 --> 00:22:56,960
of that so are there any questions

530
00:23:07,010 --> 00:23:13,470
that's an automatic process so since

531
00:23:09,810 --> 00:23:15,030
they're always on if you the camera

532
00:23:13,470 --> 00:23:16,980
pings out constantly to check for

533
00:23:15,030 --> 00:23:18,720
updates as soon as it sees one it will

534
00:23:16,980 --> 00:23:21,690
like download the update and bring it

535
00:23:18,720 --> 00:23:22,890
back all of that process is very well

536
00:23:21,690 --> 00:23:24,180
pinned and secure

537
00:23:22,890 --> 00:23:26,040
I couldn't man in the middle of it I

538
00:23:24,180 --> 00:23:32,000
couldn't do anything to kind of like

539
00:23:26,040 --> 00:23:34,930
intercept those updates anyone else

540
00:23:32,000 --> 00:23:39,309
awesome well thanks for your time

541
00:23:34,930 --> 00:23:39,309
[Applause]

