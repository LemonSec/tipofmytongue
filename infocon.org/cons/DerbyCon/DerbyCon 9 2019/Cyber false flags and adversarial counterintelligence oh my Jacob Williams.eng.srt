1
00:00:23,260 --> 00:00:28,300
I spoiled by the oh no ffs which I just

2
00:00:25,810 --> 00:00:30,549
assumed it was on hey there we go okay

3
00:00:28,300 --> 00:00:31,960
so uh we'll get started here my name is

4
00:00:30,550 --> 00:00:33,970
Jake Williams we're gonna be covering

5
00:00:31,960 --> 00:00:36,250
cyber false flags and adversarial

6
00:00:33,970 --> 00:00:39,910
counterintelligence right so lots of fun

7
00:00:36,250 --> 00:00:42,220
here the the lawyer had some fun with

8
00:00:39,910 --> 00:00:43,839
the talk right before so there are a

9
00:00:42,220 --> 00:00:45,489
couple of tools I wanted to release

10
00:00:43,840 --> 00:00:48,460
luckily they weren't in the show notes

11
00:00:45,489 --> 00:00:49,720
there all right so but look for those in

12
00:00:48,460 --> 00:00:51,400
the coming weeks once we get the

13
00:00:49,720 --> 00:00:53,170
legalese worked out around those right

14
00:00:51,400 --> 00:00:56,199
so in case you're curious I don't like

15
00:00:53,170 --> 00:00:58,300
lawyers anyway so Who am I all right so

16
00:00:56,200 --> 00:01:01,120
I found her rendition InfoSec I actually

17
00:00:58,300 --> 00:01:03,730
work with a firm called ions I'm a GSE

18
00:01:01,120 --> 00:01:05,619
with a jack I'm not a CISSP at all but

19
00:01:03,730 --> 00:01:08,200
I'm a prolific InfoSec Twitter shit

20
00:01:05,619 --> 00:01:10,390
poster formally endorsed by the shadow

21
00:01:08,200 --> 00:01:13,450
brokers I'm on the rally security pod

22
00:01:10,390 --> 00:01:14,860
podcast as a co-host of course the good

23
00:01:13,450 --> 00:01:16,270
old shadow brokers folks there I mean

24
00:01:14,860 --> 00:01:19,380
not a subtle thing or anything

25
00:01:16,270 --> 00:01:21,250
I love pen test forensics and then CT I

26
00:01:19,380 --> 00:01:23,020
absolutely dislike people who call

27
00:01:21,250 --> 00:01:25,540
themselves thought leaders right I can't

28
00:01:23,020 --> 00:01:27,340
stand that and blockchain for goodness

29
00:01:25,540 --> 00:01:29,500
sakes leave it in crypto and that's it

30
00:01:27,340 --> 00:01:31,660
all right so the agenda let's talk about

31
00:01:29,500 --> 00:01:33,310
false flag case studies as well as some

32
00:01:31,660 --> 00:01:36,069
techniques that you can use to do your

33
00:01:33,310 --> 00:01:37,690
own cyber false flags the case study

34
00:01:36,069 --> 00:01:39,009
thing is the is it really happening in

35
00:01:37,690 --> 00:01:41,709
the field and we get this question a lot

36
00:01:39,009 --> 00:01:44,050
I'm an answer is yes absolutely it's

37
00:01:41,709 --> 00:01:46,539
happening unfortunately I think it's

38
00:01:44,050 --> 00:01:48,729
probably happening a lot more than we

39
00:01:46,539 --> 00:01:49,959
know about specifically because I think

40
00:01:48,729 --> 00:01:52,149
they're probably successful in a lot of

41
00:01:49,959 --> 00:01:54,459
cases right - we do a lot of incident

42
00:01:52,149 --> 00:01:56,679
responsive rendition and in a lot of

43
00:01:54,459 --> 00:01:58,270
cases we get a chance to do second

44
00:01:56,679 --> 00:02:00,310
incident response or anything and that's

45
00:01:58,270 --> 00:02:02,020
kind of like second meal actually not a

46
00:02:00,310 --> 00:02:04,330
lot not all like second meal it's kind

47
00:02:02,020 --> 00:02:07,119
of like coming in behind a another firm

48
00:02:04,330 --> 00:02:08,679
and get a chance to mop up kind of thing

49
00:02:07,119 --> 00:02:11,110
and and we get a chance to read a lot of

50
00:02:08,679 --> 00:02:13,750
reports and see some really really bad

51
00:02:11,110 --> 00:02:16,030
conclusions we're single indicators in

52
00:02:13,750 --> 00:02:18,490
many cases are used to do attribution

53
00:02:16,030 --> 00:02:19,599
which is a really bad plan you really

54
00:02:18,490 --> 00:02:21,370
shouldn't do that right we're going to

55
00:02:19,599 --> 00:02:23,859
talk about why throughout this

56
00:02:21,370 --> 00:02:26,020
throughout this talk talk about copying

57
00:02:23,860 --> 00:02:27,640
so my actor TTP's talk about the rich

58
00:02:26,020 --> 00:02:29,230
header which is pretty awesome if you're

59
00:02:27,640 --> 00:02:31,659
not familiar with it will we discuss it

60
00:02:29,230 --> 00:02:32,619
here as well as encryption keys this is

61
00:02:31,659 --> 00:02:35,890
something that we've seen used

62
00:02:32,620 --> 00:02:36,670
repeatedly for attribution and again

63
00:02:35,890 --> 00:02:38,799
just just a bad

64
00:02:36,670 --> 00:02:40,540
plan overall we'll talk about as well

65
00:02:38,800 --> 00:02:42,550
and not being useful idiot Aryan if

66
00:02:40,540 --> 00:02:44,890
you're not familiar with this term UI or

67
00:02:42,550 --> 00:02:46,660
useful idiot I think this is originally

68
00:02:44,890 --> 00:02:49,660
attributed back to Lenin although it's

69
00:02:46,660 --> 00:02:51,250
it's not entirely a you know salute you

70
00:02:49,660 --> 00:02:53,950
know solidly attributed back there but

71
00:02:51,250 --> 00:02:57,160
basically the idea there is somebody who

72
00:02:53,950 --> 00:03:01,269
is not necessarily being paid or or

73
00:02:57,160 --> 00:03:03,910
coerced necessarily to push a basically

74
00:03:01,270 --> 00:03:05,800
push a narrative but somebody who falls

75
00:03:03,910 --> 00:03:08,109
for the narrative and in in their

76
00:03:05,800 --> 00:03:10,120
basically workings and it basically

77
00:03:08,110 --> 00:03:12,550
advances that right so basically if you

78
00:03:10,120 --> 00:03:14,260
fall for that false flag and then come

79
00:03:12,550 --> 00:03:16,209
back and say but science I'm doing

80
00:03:14,260 --> 00:03:17,470
forensics and I see all these friends of

81
00:03:16,209 --> 00:03:19,630
garter fax and that's why it's

82
00:03:17,470 --> 00:03:23,350
definitely Russia or definitely China or

83
00:03:19,630 --> 00:03:24,549
insert bad actor here and or the US for

84
00:03:23,350 --> 00:03:26,859
that matter I guess we could be a bad

85
00:03:24,550 --> 00:03:28,209
actor as well depending on well the day

86
00:03:26,860 --> 00:03:29,530
of the week as well as what part of the

87
00:03:28,209 --> 00:03:31,630
world you're in and then a couple of

88
00:03:29,530 --> 00:03:33,100
closing thoughts right so we'll start

89
00:03:31,630 --> 00:03:35,440
off with that case studies and cyber

90
00:03:33,100 --> 00:03:36,700
false flags and so the first one I want

91
00:03:35,440 --> 00:03:39,550
to talk about here is the ISIS Ling

92
00:03:36,700 --> 00:03:40,600
cyber caliphate in 2014 there was a

93
00:03:39,550 --> 00:03:42,940
group that emerged a into cyber

94
00:03:40,600 --> 00:03:44,709
caliphate they began hacking a number of

95
00:03:42,940 --> 00:03:46,150
US CENTCOM social media accounts they

96
00:03:44,709 --> 00:03:49,209
actually took over centcom's YouTube

97
00:03:46,150 --> 00:03:51,100
account which was mildly not funny as it

98
00:03:49,209 --> 00:03:53,170
turns out they posted actually some

99
00:03:51,100 --> 00:03:55,510
really nasty videos of soldiers getting

100
00:03:53,170 --> 00:03:56,798
blown up and again bear in mind yeah

101
00:03:55,510 --> 00:03:57,910
this is the thing that CENTCOM is

102
00:03:56,799 --> 00:03:59,920
sharing on Facebook

103
00:03:57,910 --> 00:04:02,290
spouses back home or you know basically

104
00:03:59,920 --> 00:04:04,208
tuning into this to see new basically

105
00:04:02,290 --> 00:04:06,760
news about you know their loved ones in

106
00:04:04,209 --> 00:04:10,060
the field and all of a sudden you know

107
00:04:06,760 --> 00:04:11,769
Isis or Isis well believe to the ISIS

108
00:04:10,060 --> 00:04:13,570
the cyber caliphate takes this over and

109
00:04:11,769 --> 00:04:15,130
starts posting some some pretty

110
00:04:13,570 --> 00:04:16,959
horrendous stuff right some pretty

111
00:04:15,130 --> 00:04:18,430
horrendous propaganda nothing to do with

112
00:04:16,959 --> 00:04:20,709
Russia by the way a hundred percent to

113
00:04:18,430 --> 00:04:22,210
do with Isis right so pretty strong link

114
00:04:20,709 --> 00:04:24,940
there right one they came out and said

115
00:04:22,210 --> 00:04:27,099
hey we're is right now look we all fall

116
00:04:24,940 --> 00:04:29,440
for a lot of these that were hardwired

117
00:04:27,100 --> 00:04:31,690
right in a lot of cases for cognitive

118
00:04:29,440 --> 00:04:33,160
biases as well some logical fallacies

119
00:04:31,690 --> 00:04:35,830
and and what we fell into here is a

120
00:04:33,160 --> 00:04:37,900
confirmation bias right of course again

121
00:04:35,830 --> 00:04:39,700
they came out and said I understand why

122
00:04:37,900 --> 00:04:42,280
they came out and said were isolated

123
00:04:39,700 --> 00:04:44,349
like Isis like things sorry you know

124
00:04:42,280 --> 00:04:45,880
showing Isis propaganda videos and

125
00:04:44,350 --> 00:04:47,890
showing soldiers getting blown up and

126
00:04:45,880 --> 00:04:49,360
and they docked thousands of military

127
00:04:47,890 --> 00:04:51,400
members including some home addresses

128
00:04:49,360 --> 00:04:53,860
they released a ton of troop movement

129
00:04:51,400 --> 00:04:55,239
data unit rosters etc most of what they

130
00:04:53,860 --> 00:04:57,820
released as it turns out under

131
00:04:55,240 --> 00:05:00,550
investigation later we determined was

132
00:04:57,820 --> 00:05:02,919
basically the u.s. determined was

133
00:05:00,550 --> 00:05:04,419
already probably publicly available

134
00:05:02,919 --> 00:05:05,890
through other leaks right so the

135
00:05:04,419 --> 00:05:07,990
Russians didn't even work very hard on

136
00:05:05,890 --> 00:05:09,430
this but it doesn't really matter at the

137
00:05:07,990 --> 00:05:11,680
end of the day it still looked really

138
00:05:09,430 --> 00:05:14,020
bad at the time right I guess looks

139
00:05:11,680 --> 00:05:15,340
really bad still regardless and 2015

140
00:05:14,020 --> 00:05:16,870
though that they took it a step further

141
00:05:15,340 --> 00:05:20,260
and the cyber caliphate took down

142
00:05:16,870 --> 00:05:21,669
france's tv5 monde a they took them off

143
00:05:20,260 --> 00:05:23,169
the air they actually the destructive

144
00:05:21,669 --> 00:05:24,219
cyber attack and this is probably where

145
00:05:23,169 --> 00:05:26,650
they went a couple of steps too far

146
00:05:24,220 --> 00:05:28,599
right and i say too far because up to

147
00:05:26,650 --> 00:05:30,549
this point there was some suspicion that

148
00:05:28,599 --> 00:05:32,050
this might not be isis but but nobody

149
00:05:30,550 --> 00:05:34,270
really had any proof right it was kind

150
00:05:32,050 --> 00:05:35,979
of a you know one analyst says well this

151
00:05:34,270 --> 00:05:37,750
is a little too brazen it doesn't really

152
00:05:35,979 --> 00:05:40,060
look like isis and it looks like it

153
00:05:37,750 --> 00:05:41,590
could be propaganda and when you think

154
00:05:40,060 --> 00:05:43,030
propaganda let's just be fair right i

155
00:05:41,590 --> 00:05:44,919
mean i'm gonna say i have a confirmation

156
00:05:43,030 --> 00:05:46,330
bias towards russia of course that might

157
00:05:44,919 --> 00:05:47,770
have something to do with my past as

158
00:05:46,330 --> 00:05:50,650
well you know where they kind of outed

159
00:05:47,770 --> 00:05:52,930
me and and whatever but alas you know

160
00:05:50,650 --> 00:05:54,609
these here's we think about this right

161
00:05:52,930 --> 00:05:56,620
with these these whole indicators here

162
00:05:54,610 --> 00:05:58,630
when they came in and hacked the french

163
00:05:56,620 --> 00:06:00,789
TV station and performed the destructive

164
00:05:58,630 --> 00:06:02,200
cyber attack this is the point where we

165
00:06:00,789 --> 00:06:04,450
can really step back and start doing

166
00:06:02,200 --> 00:06:06,729
Incident Response and now this is where

167
00:06:04,450 --> 00:06:08,500
it's hard to pull off a convincing cyber

168
00:06:06,729 --> 00:06:10,630
false flag right you can do a few things

169
00:06:08,500 --> 00:06:12,010
well but doing everything well is pretty

170
00:06:10,630 --> 00:06:13,479
impossible and that that's one of the

171
00:06:12,010 --> 00:06:15,400
points we're gonna touch on today is

172
00:06:13,479 --> 00:06:18,460
that if you're doing good

173
00:06:15,400 --> 00:06:20,440
full wholesome forensics right wholesome

174
00:06:18,460 --> 00:06:21,969
forensics you're likely to uncover the

175
00:06:20,440 --> 00:06:24,250
false flag now if you're relying on one

176
00:06:21,970 --> 00:06:25,659
or two indicators in isolation this is

177
00:06:24,250 --> 00:06:27,400
where you're likely to trip up and

178
00:06:25,659 --> 00:06:29,349
become that you I right that we talked

179
00:06:27,400 --> 00:06:30,669
about a minute ago here this was an

180
00:06:29,349 --> 00:06:32,620
excellent false flag attack though

181
00:06:30,669 --> 00:06:34,450
because people had been saying for some

182
00:06:32,620 --> 00:06:36,280
time hey Isis is gonna do badness

183
00:06:34,450 --> 00:06:37,659
they're gonna enter the cyber domain and

184
00:06:36,280 --> 00:06:39,159
we can't believe they're not already

185
00:06:37,659 --> 00:06:41,469
here and sure enough then they showed up

186
00:06:39,159 --> 00:06:42,760
and peer like yes they're here right and

187
00:06:41,470 --> 00:06:44,409
again I think there was a lot of

188
00:06:42,760 --> 00:06:46,719
confirmation bias that played into this

189
00:06:44,409 --> 00:06:48,610
and roll forward here or kind of

190
00:06:46,720 --> 00:06:50,409
parallel give or take in the same time

191
00:06:48,610 --> 00:06:51,820
period we see the Sony hack alright and

192
00:06:50,409 --> 00:06:53,320
so North Korea attempted to hide behind

193
00:06:51,820 --> 00:06:55,930
a hack to this group when they targeted

194
00:06:53,320 --> 00:06:57,550
Sony in November 2014 the US government

195
00:06:55,930 --> 00:06:59,830
came back and said no no was definitely

196
00:06:57,550 --> 00:07:01,480
a Democratic People's Republic of Korea

197
00:06:59,830 --> 00:07:04,060
by the way why is

198
00:07:01,480 --> 00:07:06,010
precisely that everybody who seems to be

199
00:07:04,060 --> 00:07:07,450
a communist regime once use democratic

200
00:07:06,010 --> 00:07:08,860
in their and their name there I never

201
00:07:07,450 --> 00:07:10,930
understood that but rock on

202
00:07:08,860 --> 00:07:12,970
regardless here the Democratic People's

203
00:07:10,930 --> 00:07:14,590
Republic of Korea hackers there they've

204
00:07:12,970 --> 00:07:17,020
repeatedly called themselves different

205
00:07:14,590 --> 00:07:19,780
activist groups now this is barely

206
00:07:17,020 --> 00:07:21,070
convincing although right you know we

207
00:07:19,780 --> 00:07:23,500
start coming in I talked about our

208
00:07:21,070 --> 00:07:25,270
hardwired to want to basically to want

209
00:07:23,500 --> 00:07:27,730
to see you know some of these cognitive

210
00:07:25,270 --> 00:07:29,620
biases and logical fallacies and and we

211
00:07:27,730 --> 00:07:31,090
are also it turns out very there's lots

212
00:07:29,620 --> 00:07:32,470
of studies on this we were really

213
00:07:31,090 --> 00:07:35,200
hardwired to want a good conspiracy

214
00:07:32,470 --> 00:07:36,760
right and so this plays into this as it

215
00:07:35,200 --> 00:07:38,469
turns out there are still people that

216
00:07:36,760 --> 00:07:40,990
argue that this was a hacktivist group

217
00:07:38,470 --> 00:07:42,310
despite all evidence to the contrary I

218
00:07:40,990 --> 00:07:43,990
mean and it's because they hide behind

219
00:07:42,310 --> 00:07:45,760
hacktivists groups and they have

220
00:07:43,990 --> 00:07:47,590
consistently most these hacktivists

221
00:07:45,760 --> 00:07:49,420
though very interestingly have never

222
00:07:47,590 --> 00:07:51,219
been heard from before or since that

223
00:07:49,420 --> 00:07:52,990
they're kind of one operation activist

224
00:07:51,220 --> 00:07:54,610
groups as if they they like come

225
00:07:52,990 --> 00:07:55,540
together right like wonder twin powers

226
00:07:54,610 --> 00:07:56,890
activate

227
00:07:55,540 --> 00:07:59,140
right and they come together and then

228
00:07:56,890 --> 00:08:00,969
and then never seen from a never seen or

229
00:07:59,140 --> 00:08:02,409
heard from again which is just really

230
00:08:00,970 --> 00:08:04,300
interesting but the guardians of peace

231
00:08:02,410 --> 00:08:06,820
was one of the names they're the who is

232
00:08:04,300 --> 00:08:08,230
team this was really cool cuz the well

233
00:08:06,820 --> 00:08:10,180
not cool if you were one of the victims

234
00:08:08,230 --> 00:08:11,890
but but the splash screen that came up

235
00:08:10,180 --> 00:08:13,690
when they basically worked the boxes

236
00:08:11,890 --> 00:08:15,340
there when they were basically wiping

237
00:08:13,690 --> 00:08:18,040
the drive so the one that popped up came

238
00:08:15,340 --> 00:08:19,239
up and said who is who is right which

239
00:08:18,040 --> 00:08:21,340
was kind of neat I mean it was a neat

240
00:08:19,240 --> 00:08:22,810
play on English there but alas other

241
00:08:21,340 --> 00:08:24,280
than a romantic cyber army is yet

242
00:08:22,810 --> 00:08:26,650
another one of their one of their little

243
00:08:24,280 --> 00:08:28,479
hacking teams there then we were all

244
00:08:26,650 --> 00:08:30,489
forward to 2018 and we see the Olympic

245
00:08:28,480 --> 00:08:32,380
destroyer Olympic destroyer Mauer gets

246
00:08:30,490 --> 00:08:34,240
deployed during the 2018 Olympics in

247
00:08:32,380 --> 00:08:36,099
Seoul all right and again I'm looking at

248
00:08:34,240 --> 00:08:38,260
a confirmation bias yours is probably

249
00:08:36,099 --> 00:08:40,030
what's going on because we quickly

250
00:08:38,260 --> 00:08:42,400
attributed its North Korea won because

251
00:08:40,030 --> 00:08:43,780
well there were a lot of indicators that

252
00:08:42,400 --> 00:08:45,939
kind of pointed there right first off

253
00:08:43,780 --> 00:08:47,439
you know the north and the south you may

254
00:08:45,940 --> 00:08:50,200
have heard aren't exactly getting along

255
00:08:47,440 --> 00:08:51,760
and and so you know also you know they

256
00:08:50,200 --> 00:08:54,280
they had the whole well there are lots

257
00:08:51,760 --> 00:08:55,660
of indicators in the PE header that tied

258
00:08:54,280 --> 00:08:58,689
it back to the portable executable

259
00:08:55,660 --> 00:09:01,089
header tied it back to other North

260
00:08:58,690 --> 00:09:03,040
Korean malware rule forward though

261
00:09:01,090 --> 00:09:05,410
researchers noticed some coding

262
00:09:03,040 --> 00:09:07,449
similarities right so as you dive deeper

263
00:09:05,410 --> 00:09:08,980
than the header there are some coding

264
00:09:07,450 --> 00:09:11,290
similarities to some Russian malware

265
00:09:08,980 --> 00:09:12,850
nothing conclusive right because when we

266
00:09:11,290 --> 00:09:14,380
talk about similarities at the end of

267
00:09:12,850 --> 00:09:15,329
the day right ed SCOTUS I think very

268
00:09:14,380 --> 00:09:17,730
famously said

269
00:09:15,329 --> 00:09:19,258
right that if he wanted to emulate the

270
00:09:17,730 --> 00:09:21,299
US government he would just pull apart

271
00:09:19,259 --> 00:09:22,889
Stuxnet and basically use techniques

272
00:09:21,299 --> 00:09:25,139
from Stuxnet and that would literally be

273
00:09:22,889 --> 00:09:26,850
it people would forever say that was the

274
00:09:25,139 --> 00:09:28,679
US government and I don't debate that

275
00:09:26,850 --> 00:09:30,720
right I think the people would would

276
00:09:28,679 --> 00:09:32,670
largely latch on to that regardless here

277
00:09:30,720 --> 00:09:34,980
nothing really conclusive you know again

278
00:09:32,670 --> 00:09:36,540
a good technique is a good technique the

279
00:09:34,980 --> 00:09:37,920
problem here is they sucked at

280
00:09:36,540 --> 00:09:39,899
tradecraft because researchers

281
00:09:37,920 --> 00:09:42,179
discovered that the malware had been

282
00:09:39,899 --> 00:09:43,579
uploaded two weeks before to a scanning

283
00:09:42,179 --> 00:09:45,689
service in Eastern Europe and the

284
00:09:43,579 --> 00:09:47,189
scanning service as a matter of fact

285
00:09:45,689 --> 00:09:52,199
when they upload it and uploaded it with

286
00:09:47,189 --> 00:09:54,209
the name olympia x EO o ym p exe and the

287
00:09:52,199 --> 00:09:56,219
PE header the artifacts and the PIAT are

288
00:09:54,209 --> 00:09:58,319
specifically the rich header right it

289
00:09:56,220 --> 00:09:59,670
turns out a hundred percent aligned with

290
00:09:58,319 --> 00:10:01,139
russian malware so basically they

291
00:09:59,670 --> 00:10:02,639
uploaded the scanning service to make

292
00:10:01,139 --> 00:10:05,489
sure that it wasn't gonna get caught by

293
00:10:02,639 --> 00:10:07,529
antivirus right validated that two weeks

294
00:10:05,489 --> 00:10:09,149
before they deployed it went back did

295
00:10:07,529 --> 00:10:11,009
their anti forensics Corrections right

296
00:10:09,149 --> 00:10:12,569
so this is an op sec slip-up as is the

297
00:10:11,009 --> 00:10:15,420
reason that we can conclusively or

298
00:10:12,569 --> 00:10:17,610
fairly conclusively say now now look i

299
00:10:15,420 --> 00:10:19,799
say conclusively because you know in the

300
00:10:17,610 --> 00:10:22,169
whole like fashion a hat out of aluminum

301
00:10:19,799 --> 00:10:24,540
foil world right we could possibly have

302
00:10:22,169 --> 00:10:26,910
a case where the north koreans right

303
00:10:24,540 --> 00:10:29,429
pivoted through a eastern european box

304
00:10:26,910 --> 00:10:31,230
with different rich headers and and then

305
00:10:29,429 --> 00:10:33,689
uploaded there to kind of plant that

306
00:10:31,230 --> 00:10:35,129
seed right but but i think all things

307
00:10:33,689 --> 00:10:37,259
being equal I think it probably looks a

308
00:10:35,129 --> 00:10:38,279
lot more Russian the North Korean it

309
00:10:37,259 --> 00:10:40,079
looks like they had intentionally

310
00:10:38,279 --> 00:10:41,850
replaced that rich header which is a

311
00:10:40,079 --> 00:10:43,378
piece of the portable executable header

312
00:10:41,850 --> 00:10:45,809
that we use for attribution in some

313
00:10:43,379 --> 00:10:48,239
cases before the binary got deployed

314
00:10:45,809 --> 00:10:50,069
right so so again not a hundred percent

315
00:10:48,239 --> 00:10:52,290
conclusive but looks pretty bad that

316
00:10:50,069 --> 00:10:53,849
it's probably Russia right and I would

317
00:10:52,290 --> 00:10:56,459
be remiss not to talk about the u.s.

318
00:10:53,850 --> 00:10:57,839
here right because the vault seven dumps

319
00:10:56,459 --> 00:10:59,609
on WikiLeaks and I have to be very

320
00:10:57,839 --> 00:11:02,509
careful and call this allegedly from the

321
00:10:59,610 --> 00:11:05,040
CIA document a program called umbrage

322
00:11:02,509 --> 00:11:06,929
many believe that this program was used

323
00:11:05,040 --> 00:11:08,790
to create US government malware that

324
00:11:06,929 --> 00:11:11,579
would be confused for commodity malware

325
00:11:08,790 --> 00:11:13,799
or tools used by other state actors

326
00:11:11,579 --> 00:11:16,258
right now again you can debate the

327
00:11:13,799 --> 00:11:17,999
authenticity of the WikiLeaks dumps at

328
00:11:16,259 --> 00:11:20,339
the end of the day whether they came

329
00:11:17,999 --> 00:11:22,799
from the CIA or not there are folks out

330
00:11:20,339 --> 00:11:24,779
there today who largely believed that

331
00:11:22,799 --> 00:11:27,299
this Umbridge program is evidence that

332
00:11:24,779 --> 00:11:29,130
the u.s. is engaged in cyber false flag

333
00:11:27,299 --> 00:11:30,600
operations as well right

334
00:11:29,130 --> 00:11:32,070
that's really the takeaway here

335
00:11:30,600 --> 00:11:34,560
regardless of your belief along those

336
00:11:32,070 --> 00:11:36,510
lines roll forward again we're looking

337
00:11:34,560 --> 00:11:38,040
at 2016 here actually backing up a

338
00:11:36,510 --> 00:11:40,439
little bit technically from the vault

339
00:11:38,040 --> 00:11:42,810
seven done in 2016 you probably know

340
00:11:40,440 --> 00:11:44,190
about Gucci for two or gusoff or two or

341
00:11:42,810 --> 00:11:47,099
whatever I'm not gonna argue the dudes

342
00:11:44,190 --> 00:11:48,840
the pronunciation here but dropped in

343
00:11:47,100 --> 00:11:51,450
number of documents that claim to be

344
00:11:48,840 --> 00:11:53,400
stolen from the DNC and they claim to be

345
00:11:51,450 --> 00:11:55,050
100% authentic documents of course they

346
00:11:53,400 --> 00:11:57,540
would never modify anything before they

347
00:11:55,050 --> 00:12:00,300
leap that data I mean why would they

348
00:11:57,540 --> 00:12:02,520
right but as it turns out the document

349
00:12:00,300 --> 00:12:03,660
metadata clearly indicates the documents

350
00:12:02,520 --> 00:12:05,790
were modified it took me about three

351
00:12:03,660 --> 00:12:07,740
minutes to see this because I'm pretty

352
00:12:05,790 --> 00:12:09,660
sure that at the DNC they weren't

353
00:12:07,740 --> 00:12:12,180
running quest Diagnostics as the company

354
00:12:09,660 --> 00:12:14,640
and Ernesto Che probably was not the

355
00:12:12,180 --> 00:12:15,989
person authoring the document train so

356
00:12:14,640 --> 00:12:19,340
quick Google search will tell you that

357
00:12:15,990 --> 00:12:22,830
you know he's a very popular communist

358
00:12:19,340 --> 00:12:24,540
communist sympathizer there as well as

359
00:12:22,830 --> 00:12:26,220
some really interesting metadata here I

360
00:12:24,540 --> 00:12:28,829
would question whether or not anybody at

361
00:12:26,220 --> 00:12:31,740
the DNC is typing in Cyrillic as their

362
00:12:28,830 --> 00:12:33,270
default code page again now I can't tell

363
00:12:31,740 --> 00:12:34,920
you about the data underline in the

364
00:12:33,270 --> 00:12:36,480
documents right I'm not making any

365
00:12:34,920 --> 00:12:38,579
judgment about that whatsoever I want to

366
00:12:36,480 --> 00:12:40,350
be very very clear about that what I can

367
00:12:38,580 --> 00:12:42,660
say is that the document metadata is not

368
00:12:40,350 --> 00:12:44,610
consistent with data that was stolen

369
00:12:42,660 --> 00:12:47,610
directly from the basically stolen

370
00:12:44,610 --> 00:12:48,990
directly from the the DNC right now some

371
00:12:47,610 --> 00:12:50,940
people have pointed to this and said hey

372
00:12:48,990 --> 00:12:52,770
that was horrible tradecraft by the

373
00:12:50,940 --> 00:12:54,330
Russians right now I think we've got

374
00:12:52,770 --> 00:12:55,890
enough evidence in the totality of

375
00:12:54,330 --> 00:12:58,020
evidence right to say that this was

376
00:12:55,890 --> 00:12:59,460
probably the Russians right of course

377
00:12:58,020 --> 00:13:01,410
there are lots of people were in tinfoil

378
00:12:59,460 --> 00:13:02,640
hats about that as well if you if you

379
00:13:01,410 --> 00:13:04,800
doubt there's actually a whole website

380
00:13:02,640 --> 00:13:08,760
dedicated to this right proving me wrong

381
00:13:04,800 --> 00:13:11,250
100% I named g2 space right and if you

382
00:13:08,760 --> 00:13:12,780
are ever feeling like hey I want to dive

383
00:13:11,250 --> 00:13:14,460
into the rabbit hole and see how far

384
00:13:12,780 --> 00:13:17,250
insanity goes just open up a web browser

385
00:13:14,460 --> 00:13:19,980
type g2 dot space and you will read all

386
00:13:17,250 --> 00:13:21,510
kinds of forensics air quotes right and

387
00:13:19,980 --> 00:13:23,390
you can see all kinds of service

388
00:13:21,510 --> 00:13:25,350
gentleman named Adam Carter right who

389
00:13:23,390 --> 00:13:28,410
publishes this and there's another

390
00:13:25,350 --> 00:13:30,690
unnamed person named quote forensic ATAR

391
00:13:28,410 --> 00:13:32,550
who does a lot of does a lot of

392
00:13:30,690 --> 00:13:34,560
publication there and it makes a lot

393
00:13:32,550 --> 00:13:36,689
makes lots of leaps to conclusions right

394
00:13:34,560 --> 00:13:38,280
like in one case they're very convinced

395
00:13:36,690 --> 00:13:41,100
that it must be an inside hack and not

396
00:13:38,280 --> 00:13:42,810
the Russians because nobody has a

397
00:13:41,100 --> 00:13:44,430
basically in order for the

398
00:13:42,810 --> 00:13:46,199
ants for speeds that they conclude or

399
00:13:44,430 --> 00:13:47,880
ain't with download speeds your download

400
00:13:46,200 --> 00:13:50,520
speed would have to be greater than 100

401
00:13:47,880 --> 00:13:51,660
Meg's at the DNC all right they would

402
00:13:50,520 --> 00:13:53,279
have to have an internet pipe greater

403
00:13:51,660 --> 00:13:55,829
than 100 Meg's all right I mean I have

404
00:13:53,279 --> 00:13:58,200
gigabit fiber to my house right I'm not

405
00:13:55,830 --> 00:13:59,760
I mean neat it's cool right I guess like

406
00:13:58,200 --> 00:14:01,230
if you were trying to dispel you know

407
00:13:59,760 --> 00:14:03,150
and you're like trying to try to kick

408
00:14:01,230 --> 00:14:05,460
some rumors in here and seed some you

409
00:14:03,150 --> 00:14:07,230
know or sow some seeds of doubt that

410
00:14:05,460 --> 00:14:09,210
would probably work like if all if

411
00:14:07,230 --> 00:14:11,460
everybody around you like was on DSL but

412
00:14:09,210 --> 00:14:13,350
but we're not right and so nor were we

413
00:14:11,460 --> 00:14:14,700
in 2016 and I'm positive DNC

414
00:14:13,350 --> 00:14:16,350
headquarters had some better a better

415
00:14:14,700 --> 00:14:18,210
documents here this one was really

416
00:14:16,350 --> 00:14:21,990
convincing though because that was last

417
00:14:18,210 --> 00:14:24,000
modified by outcomes and you'll notice

418
00:14:21,990 --> 00:14:26,220
here that I had a total at a time of two

419
00:14:24,000 --> 00:14:29,610
minutes but they managed to type 231

420
00:14:26,220 --> 00:14:31,350
pages right and I type fast but I don't

421
00:14:29,610 --> 00:14:33,240
type that fast right now this particular

422
00:14:31,350 --> 00:14:34,470
document there was a lot made in the

423
00:14:33,240 --> 00:14:35,940
news about this and I'm not gonna go

424
00:14:34,470 --> 00:14:37,980
political here but this was the Trump

425
00:14:35,940 --> 00:14:40,440
opposition research that was released by

426
00:14:37,980 --> 00:14:42,210
the DNC right now there was a lot made

427
00:14:40,440 --> 00:14:44,220
to do about this live where there oh my

428
00:14:42,210 --> 00:14:45,690
gosh you know first the the Republicans

429
00:14:44,220 --> 00:14:47,130
talked about Democrats talked about it

430
00:14:45,690 --> 00:14:49,020
but again the authenticity on the side

431
00:14:47,130 --> 00:14:50,430
of that was well we can't really say

432
00:14:49,020 --> 00:14:52,740
anything about the authenticity the

433
00:14:50,430 --> 00:14:54,150
documentary whether or not whether or

434
00:14:52,740 --> 00:14:55,710
not was caught well I'll tell you for

435
00:14:54,150 --> 00:14:58,230
sure is copied and pasted I mean nobody

436
00:14:55,710 --> 00:14:59,400
typed 231 pages in you know in two

437
00:14:58,230 --> 00:15:00,960
minutes all right that just didn't

438
00:14:59,400 --> 00:15:04,280
happen but her regardless

439
00:15:00,960 --> 00:15:06,990
still alas this one's my favorite though

440
00:15:04,280 --> 00:15:09,120
2017 we had ukrainian citizens actually

441
00:15:06,990 --> 00:15:11,730
doing their own false flag operations

442
00:15:09,120 --> 00:15:13,560
forget apt this is post not Pecha right

443
00:15:11,730 --> 00:15:15,870
so for those that don't know not Pecha

444
00:15:13,560 --> 00:15:18,150
was actually deployed using a piece of

445
00:15:15,870 --> 00:15:20,400
software called me doc and basically

446
00:15:18,150 --> 00:15:22,020
they abuse the the russians abused the

447
00:15:20,400 --> 00:15:24,060
update mechanism for this for the

448
00:15:22,020 --> 00:15:25,980
software lots of background here me talk

449
00:15:24,060 --> 00:15:28,680
is used for filing taxes and they have

450
00:15:25,980 --> 00:15:31,800
about a 70% in ukraine you can only use

451
00:15:28,680 --> 00:15:33,569
this basically this software or one of

452
00:15:31,800 --> 00:15:35,099
two pieces of software one was ukrainian

453
00:15:33,570 --> 00:15:36,630
they enjoyed about a 70 percent market

454
00:15:35,100 --> 00:15:38,459
share there were this russian and they

455
00:15:36,630 --> 00:15:40,410
enjoyed about a 30 percent market share

456
00:15:38,459 --> 00:15:42,270
the Ukrainians basically said hey this

457
00:15:40,410 --> 00:15:44,310
is the last year you can use the Russian

458
00:15:42,270 --> 00:15:46,529
software to file your business taxes

459
00:15:44,310 --> 00:15:48,150
right and then not Pecha happened right

460
00:15:46,529 --> 00:15:50,070
now I'm not saying that that was the

461
00:15:48,150 --> 00:15:51,600
only motive for it right but certainly

462
00:15:50,070 --> 00:15:53,130
there's some signaling going on there

463
00:15:51,600 --> 00:15:54,900
but because of the whole tax

464
00:15:53,130 --> 00:15:55,920
interruption thing they kind of step

465
00:15:54,900 --> 00:15:56,910
back and said look you know we

466
00:15:55,920 --> 00:15:59,339
understand files

467
00:15:56,910 --> 00:16:00,930
destroyed and obviously need more time

468
00:15:59,340 --> 00:16:02,940
to deal with this so if you were hit

469
00:16:00,930 --> 00:16:04,979
with not Pecha right and you have a

470
00:16:02,940 --> 00:16:06,630
credible like police report that shows

471
00:16:04,980 --> 00:16:08,040
you were hit with not Pecha cuz they

472
00:16:06,630 --> 00:16:09,870
would come out and look and see like the

473
00:16:08,040 --> 00:16:11,939
splash screen you know that that you

474
00:16:09,870 --> 00:16:13,800
were all basically toast and anyway so

475
00:16:11,940 --> 00:16:16,680
this enterprising ukrainian businessman

476
00:16:13,800 --> 00:16:18,839
he's like hey cool i can actually get a

477
00:16:16,680 --> 00:16:20,520
copy of not Pecha and in fact myself

478
00:16:18,840 --> 00:16:22,530
right he didn't actually get infected

479
00:16:20,520 --> 00:16:24,420
originally but he infected himself to

480
00:16:22,530 --> 00:16:26,130
basically get a delay as walls to

481
00:16:24,420 --> 00:16:27,750
destroy documents right that would have

482
00:16:26,130 --> 00:16:29,310
been and basically if you got those

483
00:16:27,750 --> 00:16:30,900
documents destroyed and had no backups

484
00:16:29,310 --> 00:16:32,819
they gave you some leniency around a lot

485
00:16:30,900 --> 00:16:34,590
of rights he was like oh yeah no problem

486
00:16:32,820 --> 00:16:36,330
i'll just destroyed then he uploaded

487
00:16:34,590 --> 00:16:37,920
descendant I think it was send space or

488
00:16:36,330 --> 00:16:39,990
send file something along those lines a

489
00:16:37,920 --> 00:16:41,819
cloud file-sharing service and published

490
00:16:39,990 --> 00:16:43,920
on his blog instructions for how you two

491
00:16:41,820 --> 00:16:45,840
could get a delay in filing your taxes

492
00:16:43,920 --> 00:16:48,000
right by false flagging yourself as

493
00:16:45,840 --> 00:16:50,310
Russian attackers right and again like

494
00:16:48,000 --> 00:16:52,500
it's funny it's kind of laughable in the

495
00:16:50,310 --> 00:16:54,180
sense that wow I can't believe somebody

496
00:16:52,500 --> 00:16:55,590
did that but but at the same time it

497
00:16:54,180 --> 00:16:57,300
lost race this is not just a

498
00:16:55,590 --> 00:16:59,100
nation-state level kind of thing right

499
00:16:57,300 --> 00:17:01,140
I'm and I would argue that there are

500
00:16:59,100 --> 00:17:02,520
probably countless other examples of

501
00:17:01,140 --> 00:17:04,800
this out there that we don't know about

502
00:17:02,520 --> 00:17:06,569
right I don't mean this specifically but

503
00:17:04,800 --> 00:17:08,280
but people doing weird you know

504
00:17:06,569 --> 00:17:10,230
individuals doing weird false flag

505
00:17:08,280 --> 00:17:11,849
operations for different motivations

506
00:17:10,230 --> 00:17:12,900
right so sock about some of the

507
00:17:11,849 --> 00:17:15,119
techniques I want to start with some

508
00:17:12,900 --> 00:17:16,200
disclaimers because lawyers right none

509
00:17:15,119 --> 00:17:17,729
of this is something that we don't

510
00:17:16,200 --> 00:17:20,220
suspect attackers have already done in

511
00:17:17,730 --> 00:17:22,380
intrusions III did one talk one time

512
00:17:20,220 --> 00:17:24,329
before and released a tool set around

513
00:17:22,380 --> 00:17:25,800
anti forensics and I got so much hate

514
00:17:24,329 --> 00:17:28,379
mail it was ridiculous look if you're in

515
00:17:25,800 --> 00:17:29,730
forensics I'm sorry right definitely

516
00:17:28,380 --> 00:17:31,200
we're going to talk about some stuff I

517
00:17:29,730 --> 00:17:32,940
have no doubt that after we talk about

518
00:17:31,200 --> 00:17:36,330
this we will see more of this in the

519
00:17:32,940 --> 00:17:38,910
wild right but the fact that we see more

520
00:17:36,330 --> 00:17:40,949
of it in the wild does not mean does not

521
00:17:38,910 --> 00:17:43,050
mean that more of it is happening in the

522
00:17:40,950 --> 00:17:44,730
wild let's be very clear about that

523
00:17:43,050 --> 00:17:46,500
what it means is that we're seeing more

524
00:17:44,730 --> 00:17:48,930
of it in many cases that's because our

525
00:17:46,500 --> 00:17:50,910
eyes are open to us right so don't send

526
00:17:48,930 --> 00:17:52,860
me hate mail don't firebomb my office

527
00:17:50,910 --> 00:17:54,480
don't whatever right number two I'm not

528
00:17:52,860 --> 00:17:55,860
a lawyer I'm not your lawyer talk to

529
00:17:54,480 --> 00:17:58,260
yours before doing any of this I'm

530
00:17:55,860 --> 00:18:00,540
thankful I did because he said hold off

531
00:17:58,260 --> 00:18:02,250
on releasing to tools right so once we

532
00:18:00,540 --> 00:18:04,080
get the legalese set around those we

533
00:18:02,250 --> 00:18:06,030
will get those released and out before

534
00:18:04,080 --> 00:18:07,560
false flag and red team operation talk

535
00:18:06,030 --> 00:18:10,690
to the customer because this may not be

536
00:18:07,560 --> 00:18:13,539
cool with them at all right

537
00:18:10,690 --> 00:18:17,559
IIIi will share a horror story around

538
00:18:13,539 --> 00:18:20,080
this where we were actively engaged in a

539
00:18:17,559 --> 00:18:22,749
penetration test and we were false

540
00:18:20,080 --> 00:18:23,978
flagging something and one person there

541
00:18:22,749 --> 00:18:25,809
knew that we were false like and I

542
00:18:23,979 --> 00:18:27,460
actually asked us to I said a pen test

543
00:18:25,809 --> 00:18:30,099
it was really an adversary emulation Red

544
00:18:27,460 --> 00:18:34,169
Team they asked us specifically to

545
00:18:30,099 --> 00:18:36,399
emulate apt 22 and we did a lot and

546
00:18:34,169 --> 00:18:38,499
somebody caught us and there were only

547
00:18:36,399 --> 00:18:40,299
two people in the organization in the

548
00:18:38,499 --> 00:18:42,729
know and only one of them knew that we

549
00:18:40,299 --> 00:18:44,499
were emulating apt 22 and they kicked

550
00:18:42,729 --> 00:18:46,059
off an incident response and engaged a

551
00:18:44,499 --> 00:18:51,609
third party who concluded that we were

552
00:18:46,059 --> 00:18:53,580
apt 22 at great expense and when that

553
00:18:51,609 --> 00:18:55,960
out brief occurred and no one was happy

554
00:18:53,580 --> 00:18:58,599
we do not consult with that customer

555
00:18:55,960 --> 00:19:01,479
anymore not our choice there's they were

556
00:18:58,599 --> 00:19:03,908
not happy to say the least talk to

557
00:19:01,479 --> 00:19:05,289
people a lot right we have different

558
00:19:03,909 --> 00:19:06,820
procedures in place today as you can

559
00:19:05,289 --> 00:19:08,679
imagine there's no such thing as a

560
00:19:06,820 --> 00:19:10,749
perfect false flag operation you need to

561
00:19:08,679 --> 00:19:12,519
know how to do real forensics PB f

562
00:19:10,749 --> 00:19:14,320
stands for push-button forensic aiding

563
00:19:12,519 --> 00:19:15,849
and that is what the vast majority of

564
00:19:14,320 --> 00:19:17,349
the people out there that we see doing

565
00:19:15,849 --> 00:19:19,418
and they they that's basically what they

566
00:19:17,349 --> 00:19:21,070
do right they they press a button and it

567
00:19:19,419 --> 00:19:22,629
prints a report and that's pretty much

568
00:19:21,070 --> 00:19:24,340
all that happened on the machine if

569
00:19:22,629 --> 00:19:26,498
that's what you're doing you absolutely

570
00:19:24,340 --> 00:19:27,820
may be susceptible this right if you're

571
00:19:26,499 --> 00:19:29,710
doing real forensics for your

572
00:19:27,820 --> 00:19:31,479
correlating artifacts using that gray

573
00:19:29,710 --> 00:19:33,639
matter between your ears all right that

574
00:19:31,479 --> 00:19:36,489
keyboard to chair interface that's where

575
00:19:33,639 --> 00:19:37,869
the rubber meets the road so let's talk

576
00:19:36,489 --> 00:19:39,489
about some of the false flagging

577
00:19:37,869 --> 00:19:40,678
techniques we use number one sharing

578
00:19:39,489 --> 00:19:42,759
infrastructure with the attacker

579
00:19:40,679 --> 00:19:44,200
attackers really only have three ways to

580
00:19:42,759 --> 00:19:45,999
obtain a command and control server

581
00:19:44,200 --> 00:19:47,619
number one deploy it in their own IP

582
00:19:45,999 --> 00:19:49,419
ranges this is dumb

583
00:19:47,619 --> 00:19:53,139
they generally don't do this although

584
00:19:49,419 --> 00:19:55,119
although it is ridiculously convincing

585
00:19:53,139 --> 00:19:57,219
when they do because when they do and

586
00:19:55,119 --> 00:19:59,830
we've seen this right people come back

587
00:19:57,220 --> 00:20:01,659
and like no nation-state attacker we're

588
00:19:59,830 --> 00:20:03,460
just come from their home IP range and

589
00:20:01,659 --> 00:20:05,169
then people argue about like we see

590
00:20:03,460 --> 00:20:06,820
direct traffic coming out of Iran and

591
00:20:05,169 --> 00:20:08,769
they're like that can't be Iran Iran

592
00:20:06,820 --> 00:20:10,799
wouldn't be that's stupid and I'm I have

593
00:20:08,769 --> 00:20:13,659
lots of evidence that Iran is indeed

594
00:20:10,799 --> 00:20:17,200
Iran please don't hack us that Iran is

595
00:20:13,659 --> 00:20:18,759
indeed in some cases Iranian operations

596
00:20:17,200 --> 00:20:21,070
and others for that matter let's not

597
00:20:18,759 --> 00:20:22,479
pick on Iran have been that bad right so

598
00:20:21,070 --> 00:20:24,428
that could be the case we could also

599
00:20:22,479 --> 00:20:26,110
lease IP space for a virtual

600
00:20:24,429 --> 00:20:27,850
it's server farm we could compromise

601
00:20:26,110 --> 00:20:29,619
vulnerable hosted applications like

602
00:20:27,850 --> 00:20:31,059
Joomla or Drupal or WordPress and I'm

603
00:20:29,619 --> 00:20:32,320
told now that if you just look at Joomla

604
00:20:31,059 --> 00:20:35,230
the wrong way it falls over

605
00:20:32,320 --> 00:20:36,908
but regardless look the latter of these

606
00:20:35,230 --> 00:20:38,649
obvious is not appropriate for red team

607
00:20:36,909 --> 00:20:40,330
operations because you probably don't

608
00:20:38,649 --> 00:20:42,340
want to come in a felony to deliver a

609
00:20:40,330 --> 00:20:44,470
better red team assessment right that's

610
00:20:42,340 --> 00:20:46,240
that's just a bad plan right but

611
00:20:44,470 --> 00:20:47,950
attackers do share infrastructure right

612
00:20:46,240 --> 00:20:49,299
so the idea that attacker is known is

613
00:20:47,950 --> 00:20:50,830
it's kind of laughable

614
00:20:49,299 --> 00:20:52,570
we've got documented evidence of this

615
00:20:50,830 --> 00:20:54,009
and our own investigations but something

616
00:20:52,570 --> 00:20:56,860
I can talk about publicly or we can

617
00:20:54,009 --> 00:20:58,389
point to publicly I'm actually was

618
00:20:56,860 --> 00:21:00,129
brought out of a Kaspersky report

619
00:20:58,389 --> 00:21:01,809
because first you talked about this

620
00:21:00,129 --> 00:21:03,699
machine they call the magnet of threats

621
00:21:01,809 --> 00:21:05,168
right because this is actually one of

622
00:21:03,700 --> 00:21:07,419
the first places they found the equation

623
00:21:05,169 --> 00:21:10,269
group which is largely believed to be

624
00:21:07,419 --> 00:21:11,860
the the US US government basically with

625
00:21:10,269 --> 00:21:14,230
this equation group they also found

626
00:21:11,860 --> 00:21:16,110
flame they found animal form which is

627
00:21:14,230 --> 00:21:18,580
France they found credo which is Spain

628
00:21:16,110 --> 00:21:20,709
Tortola which is Russia right so we're

629
00:21:18,580 --> 00:21:23,408
looking at now a total of six different

630
00:21:20,710 --> 00:21:25,299
apt groups minimum six different apt

631
00:21:23,409 --> 00:21:26,830
groups on a single machine attack or

632
00:21:25,299 --> 00:21:28,809
share infrastructure right document and

633
00:21:26,830 --> 00:21:31,029
evidence of this no question right now

634
00:21:28,809 --> 00:21:32,830
weathers infrastructure redirection

635
00:21:31,029 --> 00:21:34,869
infrastructure or targets I suspect this

636
00:21:32,830 --> 00:21:37,299
is probably an end target but regardless

637
00:21:34,869 --> 00:21:38,619
still reasonable it's still a reasonable

638
00:21:37,299 --> 00:21:40,600
you know piece of proof that we can

639
00:21:38,619 --> 00:21:42,399
point to and say we've seen this occur

640
00:21:40,600 --> 00:21:43,959
right so we've seen it occur again I've

641
00:21:42,399 --> 00:21:45,850
got countless other examples of this

642
00:21:43,960 --> 00:21:47,769
that I I can't share specifically

643
00:21:45,850 --> 00:21:49,330
sometimes attackers are aware of each

644
00:21:47,769 --> 00:21:51,129
other we believe other times they're not

645
00:21:49,330 --> 00:21:52,990
on one case we actually saw two

646
00:21:51,129 --> 00:21:54,759
attackers well actually three attackers

647
00:21:52,990 --> 00:21:56,619
on the same machine two of them were

648
00:21:54,759 --> 00:21:58,809
aware of each other one of them was

649
00:21:56,619 --> 00:22:00,668
unaware of the other two entirely so

650
00:21:58,809 --> 00:22:02,860
which was kind of weird but and the two

651
00:22:00,669 --> 00:22:04,210
appear to be unaware of the third right

652
00:22:02,860 --> 00:22:06,668
so it was a very very weird relationship

653
00:22:04,210 --> 00:22:07,869
there we know that the two are aware of

654
00:22:06,669 --> 00:22:10,330
each other because they were passing

655
00:22:07,869 --> 00:22:12,309
each other notes and so one of them

656
00:22:10,330 --> 00:22:13,899
actually argued with the other these

657
00:22:12,309 --> 00:22:16,210
were not nation-state actors obviously

658
00:22:13,899 --> 00:22:17,830
at least the two but argued with and I

659
00:22:16,210 --> 00:22:19,419
one of the notes was just absolutely

660
00:22:17,830 --> 00:22:21,730
awesome I will never work this forensics

661
00:22:19,419 --> 00:22:23,409
case again I'm certain where it said if

662
00:22:21,730 --> 00:22:25,090
you don't get off I know who you are I

663
00:22:23,409 --> 00:22:27,129
know where you live if you don't get off

664
00:22:25,090 --> 00:22:29,199
this box I will call the FBI and report

665
00:22:27,129 --> 00:22:30,998
you and I'm dying to know how that call

666
00:22:29,200 --> 00:22:32,499
was gonna go right we were like so I

667
00:22:30,999 --> 00:22:34,929
hacked a machine and there's another

668
00:22:32,499 --> 00:22:36,369
hacker there and he won't get off and so

669
00:22:34,929 --> 00:22:38,200
I'd like you to go arrest him if you

670
00:22:36,369 --> 00:22:39,668
could for you know I don't work

671
00:22:38,200 --> 00:22:43,090
with the FBI but I'm pretty sure that

672
00:22:39,669 --> 00:22:44,739
doesn't it doesn't fly all right so look

673
00:22:43,090 --> 00:22:46,209
obviously you can't go hack somebody

674
00:22:44,739 --> 00:22:48,850
else's server but you could buy

675
00:22:46,210 --> 00:22:50,769
infrastructure right so you know now

676
00:22:48,850 --> 00:22:52,359
whether or not this is this is effective

677
00:22:50,769 --> 00:22:53,980
simply to come from another country I'm

678
00:22:52,359 --> 00:22:57,070
just acting hoarse because because norse

679
00:22:53,980 --> 00:22:59,200
attributed all of the ICS scanning to

680
00:22:57,070 --> 00:23:01,359
iran based solely on IP addresses now

681
00:22:59,200 --> 00:23:04,989
now look norse i don't want to kick a

682
00:23:01,359 --> 00:23:06,699
good i don't want to kick a a CT now you

683
00:23:04,989 --> 00:23:08,200
know I came to say CT I I don't want to

684
00:23:06,700 --> 00:23:10,029
kick a defunct company while they're

685
00:23:08,200 --> 00:23:11,859
down but look at the end of the day

686
00:23:10,029 --> 00:23:13,929
right obviously they made some mistakes

687
00:23:11,859 --> 00:23:16,359
here but but TLDR they're not the only

688
00:23:13,929 --> 00:23:19,389
ones right we regularly see attribution

689
00:23:16,359 --> 00:23:20,830
performed largely on IP addresses and so

690
00:23:19,389 --> 00:23:23,649
the question is how do I go get

691
00:23:20,830 --> 00:23:25,989
infrastructure in some I don't say weird

692
00:23:23,649 --> 00:23:28,029
country but some non-standard country

693
00:23:25,989 --> 00:23:30,070
right I can go on AWS and I can go and

694
00:23:28,029 --> 00:23:33,700
get the infrastructure in Singapore or

695
00:23:30,070 --> 00:23:35,230
Japan or the US or the UK right but like

696
00:23:33,700 --> 00:23:38,200
if I want to go get something in Iran it

697
00:23:35,230 --> 00:23:41,230
turns out no problem because WH t.o.p

698
00:23:38,200 --> 00:23:42,879
has a listening / 2100 VPS providers

699
00:23:41,230 --> 00:23:45,279
around the world many in really really

700
00:23:42,879 --> 00:23:47,019
interesting locations like well Iran and

701
00:23:45,279 --> 00:23:49,389
it turns out it is ridiculously easy to

702
00:23:47,019 --> 00:23:51,669
buy one I've done this repeatedly as

703
00:23:49,389 --> 00:23:53,889
we've done adversary emulation right now

704
00:23:51,669 --> 00:23:55,840
I want to be very clear if you go lease

705
00:23:53,889 --> 00:23:58,899
a server in Iran you should not be

706
00:23:55,840 --> 00:24:00,999
putting your tools or exfil or literally

707
00:23:58,899 --> 00:24:02,949
anything on that's right this thing is a

708
00:24:00,999 --> 00:24:04,659
redirector only where you're pushing an

709
00:24:02,950 --> 00:24:07,869
encrypted tunnel through this bad boy

710
00:24:04,659 --> 00:24:10,029
right and that is it and I mean it

711
00:24:07,869 --> 00:24:11,769
right but it does create a convincing

712
00:24:10,029 --> 00:24:13,239
really does create a convincing and

713
00:24:11,769 --> 00:24:14,649
convincing threat here right we've had

714
00:24:13,239 --> 00:24:16,929
folks how many folks in here do

715
00:24:14,649 --> 00:24:20,229
pentesting or red teaming a few yeah

716
00:24:16,929 --> 00:24:21,700
right I consistently had people like we

717
00:24:20,230 --> 00:24:23,440
didn't see you because you came from the

718
00:24:21,700 --> 00:24:24,850
US how many folks have heard this one

719
00:24:23,440 --> 00:24:27,940
before right we're looking for Chinese

720
00:24:24,850 --> 00:24:29,619
IP addresses I'm like wow okay well

721
00:24:27,940 --> 00:24:31,179
that's all it takes okay good to go and

722
00:24:29,619 --> 00:24:33,369
don't tell your attacker that right but

723
00:24:31,179 --> 00:24:34,720
but alas right if you need to threat

724
00:24:33,369 --> 00:24:36,789
model that all right if somebody says

725
00:24:34,720 --> 00:24:38,320
that and they're like hey we would have

726
00:24:36,789 --> 00:24:40,509
seen you if you came from a Chinese IP

727
00:24:38,320 --> 00:24:42,489
and you want to be like hold my beer

728
00:24:40,509 --> 00:24:47,019
right you totally can all right you

729
00:24:42,489 --> 00:24:49,149
totally can and very cheaply as it turns

730
00:24:47,019 --> 00:24:50,529
out let's talk about faking personas

731
00:24:49,149 --> 00:24:51,820
right so this is another thing that we

732
00:24:50,529 --> 00:24:53,590
do quite a bit

733
00:24:51,820 --> 00:24:55,419
and attackers use these supporter

734
00:24:53,590 --> 00:24:56,860
networks when they create personas Dell

735
00:24:55,420 --> 00:24:58,810
SecureWorks actually put this one

736
00:24:56,860 --> 00:25:00,340
together here and you'll notice what's

737
00:24:58,810 --> 00:25:02,440
happening here effectively is they have

738
00:25:00,340 --> 00:25:04,540
these core personas they also have what

739
00:25:02,440 --> 00:25:06,190
they call supporter personas or I say

740
00:25:04,540 --> 00:25:07,480
what they call what we call at least in

741
00:25:06,190 --> 00:25:10,300
the cyber threat intelligence field

742
00:25:07,480 --> 00:25:13,000
supporter personas and so here we would

743
00:25:10,300 --> 00:25:14,649
basically use these effectively to or

744
00:25:13,000 --> 00:25:15,520
they use these effectively so they you

745
00:25:14,650 --> 00:25:18,160
know when you get a LinkedIn invitation

746
00:25:15,520 --> 00:25:19,629
or Twitter invite or something I'll tell

747
00:25:18,160 --> 00:25:21,640
you know the first things I do I check

748
00:25:19,630 --> 00:25:23,710
like how old is the account alright and

749
00:25:21,640 --> 00:25:25,450
then are they followed by anybody or I

750
00:25:23,710 --> 00:25:27,100
mean ideally they're like followed by

751
00:25:25,450 --> 00:25:28,870
somebody I know or connected to somebody

752
00:25:27,100 --> 00:25:30,939
I know but absent that like the raw

753
00:25:28,870 --> 00:25:32,169
number people they're followed by tells

754
00:25:30,940 --> 00:25:34,690
me something if you're like a Twitter

755
00:25:32,170 --> 00:25:36,940
egg who's got like zero followers or one

756
00:25:34,690 --> 00:25:38,260
follower I'm probably like out right I'm

757
00:25:36,940 --> 00:25:40,420
probably like in that mode of what yeah

758
00:25:38,260 --> 00:25:41,800
right as a matter of fact now Twitter

759
00:25:40,420 --> 00:25:43,410
with the quality filter just won't even

760
00:25:41,800 --> 00:25:46,389
show it to me but you get the idea right

761
00:25:43,410 --> 00:25:47,710
you know here if we're looking at this

762
00:25:46,390 --> 00:25:49,330
what they're doing here effectively is

763
00:25:47,710 --> 00:25:51,070
propping up these personas with all

764
00:25:49,330 --> 00:25:52,689
these supporter accounts and if you've

765
00:25:51,070 --> 00:25:54,280
identified one of these networks and if

766
00:25:52,690 --> 00:25:56,470
you work in in cyber threat intelligence

767
00:25:54,280 --> 00:25:58,750
or red teaming you probably have already

768
00:25:56,470 --> 00:25:59,980
at least in the CTI side you have and

769
00:25:58,750 --> 00:26:01,930
and if you work in a red team you

770
00:25:59,980 --> 00:26:04,600
probably have access to a CTI team or

771
00:26:01,930 --> 00:26:07,090
just google it right um grab one of

772
00:26:04,600 --> 00:26:09,370
these personas and literally become a

773
00:26:07,090 --> 00:26:10,659
new supporter account right now bear in

774
00:26:09,370 --> 00:26:12,459
mind they're not gonna follow you back

775
00:26:10,660 --> 00:26:14,080
alright but that's not really important

776
00:26:12,460 --> 00:26:15,670
one you're kind of doing them a favor

777
00:26:14,080 --> 00:26:17,620
and this is why I talk to a lawyer right

778
00:26:15,670 --> 00:26:19,960
because you're now kind of propping them

779
00:26:17,620 --> 00:26:22,120
up and in you know an investigation and

780
00:26:19,960 --> 00:26:23,440
well an investigation in an operation

781
00:26:22,120 --> 00:26:25,659
right you're actually increasing their

782
00:26:23,440 --> 00:26:27,940
legitimacy this is why I say talk to a

783
00:26:25,660 --> 00:26:30,040
lawyer be smart about this right but but

784
00:26:27,940 --> 00:26:31,420
again if you're looking here right if we

785
00:26:30,040 --> 00:26:32,860
follow these folks it doesn't really

786
00:26:31,420 --> 00:26:35,080
matter whether or not they follow us

787
00:26:32,860 --> 00:26:37,510
back because again right these are known

788
00:26:35,080 --> 00:26:40,060
personas at this point for a ape

789
00:26:37,510 --> 00:26:41,800
specific threat group in operation in

790
00:26:40,060 --> 00:26:44,560
the middle well technically North Africa

791
00:26:41,800 --> 00:26:45,730
and the Middle East right so another

792
00:26:44,560 --> 00:26:47,889
thing that we see a lot is the threat

793
00:26:45,730 --> 00:26:49,810
actors regular use free email services

794
00:26:47,890 --> 00:26:51,340
like Yahoo yeah they still exist train

795
00:26:49,810 --> 00:26:52,780
every time they're in the news like I

796
00:26:51,340 --> 00:26:54,730
saw yesterday they had a big outer shame

797
00:26:52,780 --> 00:26:56,649
you notice this they're like outage

798
00:26:54,730 --> 00:26:58,030
impacted and I was waiting for the

799
00:26:56,650 --> 00:26:59,590
number right like is the number like

800
00:26:58,030 --> 00:27:01,090
tens of people all right and it turns

801
00:26:59,590 --> 00:27:03,550
out now it still was hundreds of

802
00:27:01,090 --> 00:27:04,959
thousands of people right but but alas a

803
00:27:03,550 --> 00:27:05,520
lot of these attackers you saw who

804
00:27:04,960 --> 00:27:08,100
obviously

805
00:27:05,520 --> 00:27:09,570
Gmail protonmail is common there are a

806
00:27:08,100 --> 00:27:12,090
few others out there and but these free

807
00:27:09,570 --> 00:27:13,470
email addresses if you register will

808
00:27:12,090 --> 00:27:15,000
look like email address through one of

809
00:27:13,470 --> 00:27:17,190
these you will absolutely create

810
00:27:15,000 --> 00:27:19,230
confusion among analysts we live to make

811
00:27:17,190 --> 00:27:21,630
connections we live to make links right

812
00:27:19,230 --> 00:27:23,970
to link stuff together in fact in the

813
00:27:21,630 --> 00:27:26,400
San CTI course we talk about link

814
00:27:23,970 --> 00:27:27,570
analysis quite a bit and I'll just

815
00:27:26,400 --> 00:27:28,800
mention here again that that is

816
00:27:27,570 --> 00:27:30,540
something that we do consistently

817
00:27:28,800 --> 00:27:32,970
whether you know it's commercial or

818
00:27:30,540 --> 00:27:34,889
government CTI people are creatures of

819
00:27:32,970 --> 00:27:37,470
habit your attackers are no different

820
00:27:34,890 --> 00:27:38,940
right they they do gravitate to common

821
00:27:37,470 --> 00:27:40,920
naming schemes for this stuff if you

822
00:27:38,940 --> 00:27:42,720
identified one of those and you create

823
00:27:40,920 --> 00:27:45,210
infrastructure or create email addresses

824
00:27:42,720 --> 00:27:46,950
with those you will create a pretty

825
00:27:45,210 --> 00:27:48,720
convincing false flag now

826
00:27:46,950 --> 00:27:51,330
now convincing meaning you know a single

827
00:27:48,720 --> 00:27:53,190
data point right and obviously right it

828
00:27:51,330 --> 00:27:54,780
has to be something that can well that

829
00:27:53,190 --> 00:27:56,370
your CTI analysts are gonna be able to

830
00:27:54,780 --> 00:27:57,870
make the connection on right you know

831
00:27:56,370 --> 00:27:59,939
there's always this how obvious do you

832
00:27:57,870 --> 00:28:01,139
make it versus like how not obvious do

833
00:27:59,940 --> 00:28:03,060
you make it right because if it's too

834
00:28:01,140 --> 00:28:05,040
obvious it's not too obvious all right

835
00:28:03,060 --> 00:28:06,090
but it's not obvious enough the analysts

836
00:28:05,040 --> 00:28:07,620
on the other side may not make the

837
00:28:06,090 --> 00:28:08,730
connection and your ruse is no good

838
00:28:07,620 --> 00:28:09,449
you've done a bunch of work for nothing

839
00:28:08,730 --> 00:28:11,910
right

840
00:28:09,450 --> 00:28:13,050
but alas again if this sounds too simple

841
00:28:11,910 --> 00:28:15,090
to work I'm just gonna tell you right

842
00:28:13,050 --> 00:28:16,620
off the bat we have seen this we have

843
00:28:15,090 --> 00:28:18,300
used this and people have fallen for

844
00:28:16,620 --> 00:28:20,610
consistently and we've had to go back

845
00:28:18,300 --> 00:28:21,810
and say hey this is really us and they

846
00:28:20,610 --> 00:28:23,909
were like how would I have known that

847
00:28:21,810 --> 00:28:25,440
and the answer is you wouldn't right you

848
00:28:23,910 --> 00:28:26,940
literally then have to take this one

849
00:28:25,440 --> 00:28:28,830
indicator you have to look at the

850
00:28:26,940 --> 00:28:30,420
totality the evidence and again we'll

851
00:28:28,830 --> 00:28:33,629
talk more about that as we close out the

852
00:28:30,420 --> 00:28:35,250
talk today same goes for infrastructure

853
00:28:33,630 --> 00:28:38,910
like blog hosting or in social media

854
00:28:35,250 --> 00:28:40,860
user names etc goocher for 2.0 obviously

855
00:28:38,910 --> 00:28:42,840
as the name implies was not the first

856
00:28:40,860 --> 00:28:45,689
right he was the sequel to the original

857
00:28:42,840 --> 00:28:47,399
grew chipper right and you know we could

858
00:28:45,690 --> 00:28:50,640
for instance try and capitalize on that

859
00:28:47,400 --> 00:28:52,800
right I'll tell you if the gucchy 4 3.0

860
00:28:50,640 --> 00:28:55,380
or 4.0 comes out I'm gonna immediately

861
00:28:52,800 --> 00:28:56,940
think Russia right it's gonna be an

862
00:28:55,380 --> 00:28:58,410
anchoring bias of mine I'm gonna try to

863
00:28:56,940 --> 00:29:00,300
make that connection now I'm gonna be

864
00:28:58,410 --> 00:29:02,670
honest I would also have in the back of

865
00:29:00,300 --> 00:29:03,930
my mind possible false flag this is the

866
00:29:02,670 --> 00:29:06,300
problem by the way is once you start

867
00:29:03,930 --> 00:29:08,370
considering is this a false flag you can

868
00:29:06,300 --> 00:29:10,290
drive yourself nuts right because you

869
00:29:08,370 --> 00:29:12,030
can be like well maybe they did that so

870
00:29:10,290 --> 00:29:13,620
I think it was a false flag or and then

871
00:29:12,030 --> 00:29:15,030
you might be like well maybe they did

872
00:29:13,620 --> 00:29:16,979
that thinking that I think it was a

873
00:29:15,030 --> 00:29:18,610
false flag and then you can you know you

874
00:29:16,980 --> 00:29:20,200
got like eight steps removed it

875
00:29:18,610 --> 00:29:22,299
it gets absolutely nuts right it's like

876
00:29:20,200 --> 00:29:25,419
beautiful mine home edition right anyway

877
00:29:22,299 --> 00:29:27,940
so look as we come back here Gucci 43.0

878
00:29:25,419 --> 00:29:29,769
interesting note here when I was doing a

879
00:29:27,940 --> 00:29:31,529
talk two years ago in the DNC hack I

880
00:29:29,769 --> 00:29:34,059
went to register Gucci for three top

881
00:29:31,529 --> 00:29:35,950
wordpress.com he actually released a

882
00:29:34,059 --> 00:29:37,750
bunch of his stuff at Gucci virtu dot

883
00:29:35,950 --> 00:29:39,820
wordpress.com I couldn't get it then but

884
00:29:37,750 --> 00:29:42,940
I do have Gucci over for I'm and have

885
00:29:39,820 --> 00:29:46,210
shirtless Putin shirtless Putin riding a

886
00:29:42,940 --> 00:29:47,890
shark right so outstanding anyway so

887
00:29:46,210 --> 00:29:50,140
messin with compiled times this is

888
00:29:47,890 --> 00:29:52,210
another big one here the porter blocks

889
00:29:50,140 --> 00:29:54,340
acute able header the PE format turns

890
00:29:52,210 --> 00:29:56,440
out in the header actually has an

891
00:29:54,340 --> 00:29:59,379
embedded timestamp right the embedded

892
00:29:56,440 --> 00:30:01,240
timestamp is in UTC right so there's no

893
00:29:59,380 --> 00:30:03,639
time no time zone associated with this

894
00:30:01,240 --> 00:30:06,269
now I'll mention here that we have

895
00:30:03,639 --> 00:30:09,070
observed in the past that traditionally

896
00:30:06,269 --> 00:30:10,960
operators or attackers or hackers work

897
00:30:09,070 --> 00:30:12,879
whatever hours the target happens to be

898
00:30:10,960 --> 00:30:15,429
up but your developers typically work a

899
00:30:12,880 --> 00:30:17,950
a nine ish to five ish kind of office

900
00:30:15,429 --> 00:30:20,380
hours schedule now one piece of malware

901
00:30:17,950 --> 00:30:22,149
one tool recovered from the attacker is

902
00:30:20,380 --> 00:30:24,370
not enough to mess with compiled times

903
00:30:22,149 --> 00:30:25,809
not up to understand you know is this

904
00:30:24,370 --> 00:30:27,580
just an isolated event

905
00:30:25,809 --> 00:30:29,230
you know this compile time but if I get

906
00:30:27,580 --> 00:30:31,449
enough of these if I've got a group of

907
00:30:29,230 --> 00:30:32,919
tools for an attacker either over an

908
00:30:31,450 --> 00:30:34,929
intrusion where you find 20 or 30

909
00:30:32,919 --> 00:30:37,419
different tools deployed or you know in

910
00:30:34,929 --> 00:30:39,039
the case of a long-standing campaign all

911
00:30:37,419 --> 00:30:40,659
right a number of other tools here we

912
00:30:39,039 --> 00:30:42,700
can start plotting these on a map and

913
00:30:40,659 --> 00:30:44,409
kind of look at what time zone do these

914
00:30:42,700 --> 00:30:46,299
align with office hours and now you're

915
00:30:44,409 --> 00:30:47,679
not gonna pinpoint a time zone with us I

916
00:30:46,299 --> 00:30:49,779
want to be very very clear about that

917
00:30:47,679 --> 00:30:51,700
but generally you can cut out about a

918
00:30:49,779 --> 00:30:53,590
little over 60 percent of the map right

919
00:30:51,700 --> 00:30:55,690
give or take with the and the cluster

920
00:30:53,590 --> 00:30:57,158
will point you into three or four time

921
00:30:55,690 --> 00:30:59,620
zones really kind in the center of that

922
00:30:57,159 --> 00:31:00,940
cluster right so so again not a hundred

923
00:30:59,620 --> 00:31:03,129
percent convincing but I want to be very

924
00:31:00,940 --> 00:31:04,360
clear this is stupid easy to change you

925
00:31:03,130 --> 00:31:07,090
can do this at home with a hex editor

926
00:31:04,360 --> 00:31:08,740
requires zero work right well obviously

927
00:31:07,090 --> 00:31:10,720
the work to change over the hex editor

928
00:31:08,740 --> 00:31:12,039
but I mean not rocket science kind of

929
00:31:10,720 --> 00:31:14,440
thing here this is not nation state

930
00:31:12,039 --> 00:31:16,629
level stuff I wanna mention RTP logs

931
00:31:14,440 --> 00:31:18,820
this is another big one that that we see

932
00:31:16,630 --> 00:31:20,980
again and again and again and I'm pretty

933
00:31:18,820 --> 00:31:22,779
convinced on at least two occasions and

934
00:31:20,980 --> 00:31:26,320
attackers uses to false-flag us

935
00:31:22,779 --> 00:31:28,600
RTP logs when an attacker logs into or

936
00:31:26,320 --> 00:31:30,490
uses RTP to log on a target they leave

937
00:31:28,600 --> 00:31:32,110
behind their machine name in most cases

938
00:31:30,490 --> 00:31:34,360
and domain name is part of the

939
00:31:32,110 --> 00:31:35,709
login right now I say in most cases I

940
00:31:34,360 --> 00:31:37,449
don't have time to dive into the details

941
00:31:35,710 --> 00:31:39,549
of RDP forensics that could be a whole

942
00:31:37,450 --> 00:31:41,200
talk on its own but I'll mention here

943
00:31:39,549 --> 00:31:42,730
the RTP logs are interesting because

944
00:31:41,200 --> 00:31:44,620
they have a much longer lifespan the

945
00:31:42,730 --> 00:31:46,360
security of that logs right security

946
00:31:44,620 --> 00:31:47,469
event logs tend to roll over on most

947
00:31:46,360 --> 00:31:50,649
machines depending on login

948
00:31:47,470 --> 00:31:53,620
configuration every 30 to 60 ish days my

949
00:31:50,650 --> 00:31:55,420
RDP logs on a typical workstation tend

950
00:31:53,620 --> 00:31:57,669
to have about a year to two year

951
00:31:55,420 --> 00:32:00,640
lifespan right so these things live a

952
00:31:57,670 --> 00:32:02,260
lot longer as it turns out and so by

953
00:32:00,640 --> 00:32:04,000
simply making an RDP connection and I

954
00:32:02,260 --> 00:32:05,770
can do that by redirecting through

955
00:32:04,000 --> 00:32:07,870
infrastructure that I already own inside

956
00:32:05,770 --> 00:32:10,450
the target I can leave behind a host

957
00:32:07,870 --> 00:32:11,830
name or a domain name that I would like

958
00:32:10,450 --> 00:32:13,690
you to correlate and again I can pull

959
00:32:11,830 --> 00:32:16,059
this from an existing CTI report and

960
00:32:13,690 --> 00:32:19,179
people again I'm positive will gravitate

961
00:32:16,059 --> 00:32:20,410
towards gravitate towards the well what

962
00:32:19,179 --> 00:32:21,580
we're trying to get there now I'll

963
00:32:20,410 --> 00:32:23,620
mention here and this is really really

964
00:32:21,580 --> 00:32:25,928
slick in a lot of situations and this is

965
00:32:23,620 --> 00:32:28,540
due to actually Noa Network level

966
00:32:25,929 --> 00:32:30,190
authentication logs get created just by

967
00:32:28,540 --> 00:32:32,740
connecting right now this a lot of this

968
00:32:30,190 --> 00:32:34,960
depends on your settings on your machine

969
00:32:32,740 --> 00:32:37,360
but if you have open NLA enabled right

970
00:32:34,960 --> 00:32:39,850
basically where it's like an LA without

971
00:32:37,360 --> 00:32:42,030
authentication effectively right NLA is

972
00:32:39,850 --> 00:32:44,409
gonna log that domain name and hosting

973
00:32:42,030 --> 00:32:46,660
before the attack literally just when a

974
00:32:44,410 --> 00:32:48,700
login screen pops up not when they

975
00:32:46,660 --> 00:32:50,830
actually login and this leads all kinds

976
00:32:48,700 --> 00:32:53,110
of bad forensics conclusions down the

977
00:32:50,830 --> 00:32:54,610
road there all right so talk about rich

978
00:32:53,110 --> 00:32:56,649
headers as well or and I mentioned this

979
00:32:54,610 --> 00:32:58,360
early early on when we talked about

980
00:32:56,650 --> 00:33:00,940
Olympic destroyer all right so with the

981
00:32:58,360 --> 00:33:02,709
rich headers basically this is varying

982
00:33:00,940 --> 00:33:04,780
the very very early portion on the PE

983
00:33:02,710 --> 00:33:06,610
header so actually right after the this

984
00:33:04,780 --> 00:33:08,410
program cannot be run in DOS mode right

985
00:33:06,610 --> 00:33:10,809
we're all familiar with like the mg D

986
00:33:08,410 --> 00:33:11,950
right mark zubowski there I would love

987
00:33:10,809 --> 00:33:14,168
to be marked by the way can you imagine

988
00:33:11,950 --> 00:33:15,580
going into a you know going into an

989
00:33:14,169 --> 00:33:17,080
interview right and they're like do you

990
00:33:15,580 --> 00:33:19,030
have any qualifications you like do you

991
00:33:17,080 --> 00:33:21,220
have a hex editor what a mic drop kind

992
00:33:19,030 --> 00:33:22,928
of moment there all right and turns out

993
00:33:21,220 --> 00:33:24,610
that if you actually look in the other

994
00:33:22,929 --> 00:33:25,809
reason we call this the rich header it

995
00:33:24,610 --> 00:33:28,959
was actually written by a gentleman

996
00:33:25,809 --> 00:33:30,520
unsurprisingly named rich and it turns

997
00:33:28,960 --> 00:33:32,110
out that if you look in your PE header

998
00:33:30,520 --> 00:33:33,790
scroll down a little bit further past

999
00:33:32,110 --> 00:33:36,399
this program cannot be run in DOS mode

1000
00:33:33,790 --> 00:33:38,830
you'll see the letters RI CH capital R

1001
00:33:36,400 --> 00:33:41,190
lowercase I CH and it turns out that

1002
00:33:38,830 --> 00:33:43,750
that data that's in there right it's a

1003
00:33:41,190 --> 00:33:45,850
lot of data I'm bad math I think we're

1004
00:33:43,750 --> 00:33:47,049
looking at 80 bytes 80 or 90

1005
00:33:45,850 --> 00:33:49,178
I can't remember right off the top of my

1006
00:33:47,049 --> 00:33:50,918
head regardless here that has all the

1007
00:33:49,179 --> 00:33:53,110
tool chain information that was used to

1008
00:33:50,919 --> 00:33:55,390
go build the executable the specific

1009
00:33:53,110 --> 00:33:56,889
compiler version and the specific linker

1010
00:33:55,390 --> 00:33:59,410
versions as well as the number of input

1011
00:33:56,890 --> 00:34:00,760
files passed to basically pass to that

1012
00:33:59,410 --> 00:34:03,370
pass to the compiler

1013
00:34:00,760 --> 00:34:05,320
this is absolutely epic it's awesome now

1014
00:34:03,370 --> 00:34:07,570
I'll mention any of the dotnet Ming W

1015
00:34:05,320 --> 00:34:09,250
and GCC don't include the rich header

1016
00:34:07,570 --> 00:34:10,569
this by itself is interesting right

1017
00:34:09,250 --> 00:34:12,699
because when I see one that doesn't have

1018
00:34:10,570 --> 00:34:14,169
a rich header I kind of step back and

1019
00:34:12,699 --> 00:34:15,939
I'm like cool I used to just be

1020
00:34:14,168 --> 00:34:18,668
Microsoft compilers Intel compiler

1021
00:34:15,940 --> 00:34:19,990
started doing this as well now I mention

1022
00:34:18,668 --> 00:34:21,460
here that a large number of tools out

1023
00:34:19,989 --> 00:34:23,979
there already decode these for you now

1024
00:34:21,460 --> 00:34:25,780
Microsoft does not publish a list of

1025
00:34:23,980 --> 00:34:27,369
when you see this compiler ID basically

1026
00:34:25,780 --> 00:34:29,889
it's a four byte so he's a 2-byte

1027
00:34:27,369 --> 00:34:31,510
compiler ID when you see that two byte

1028
00:34:29,889 --> 00:34:33,040
compiler ID they don't tell you like

1029
00:34:31,510 --> 00:34:35,020
what that is there's no like reverse

1030
00:34:33,040 --> 00:34:36,790
lookup for that Microsoft holds that

1031
00:34:35,020 --> 00:34:39,668
close to the vest right now they had a

1032
00:34:36,790 --> 00:34:41,139
leak of some tools gosh what almost 10

1033
00:34:39,668 --> 00:34:42,730
years ago so like everything before

1034
00:34:41,139 --> 00:34:44,980
that's known but like everything the

1035
00:34:42,730 --> 00:34:46,510
last 10 or 12 years isn't and so there's

1036
00:34:44,980 --> 00:34:47,679
a lot of guessing going on around that

1037
00:34:46,510 --> 00:34:49,629
but I'll mention that when a developer

1038
00:34:47,679 --> 00:34:51,490
gets a tool chain in place they

1039
00:34:49,629 --> 00:34:52,868
generally don't mess with it because you

1040
00:34:51,489 --> 00:34:54,879
also may have to make code changes

1041
00:34:52,869 --> 00:34:56,649
really to fix and fix a lot of this

1042
00:34:54,879 --> 00:34:58,630
stuff right and so so I'll mention like

1043
00:34:56,649 --> 00:35:00,970
that the the attackers here know this

1044
00:34:58,630 --> 00:35:02,440
obviously we saw the Russians actually

1045
00:35:00,970 --> 00:35:04,209
replaced the rich header with Olympic

1046
00:35:02,440 --> 00:35:05,950
destroyer and that's actually what led

1047
00:35:04,210 --> 00:35:07,990
to the early attribution in North Korea

1048
00:35:05,950 --> 00:35:09,700
I'll also mention that and I'm totally

1049
00:35:07,990 --> 00:35:11,770
gonna butcher this dude's name but Moxon

1050
00:35:09,700 --> 00:35:13,180
doback published a paper this year in

1051
00:35:11,770 --> 00:35:14,350
the sands reading room and it is

1052
00:35:13,180 --> 00:35:16,419
phenomenal

1053
00:35:14,350 --> 00:35:17,710
I absolutely if he had come to me with

1054
00:35:16,420 --> 00:35:20,470
this hypothesis I'd have bet money

1055
00:35:17,710 --> 00:35:22,450
against it but he can actually reliably

1056
00:35:20,470 --> 00:35:24,189
detect reasonably reliably detect

1057
00:35:22,450 --> 00:35:25,990
malware using nothing but the rich

1058
00:35:24,190 --> 00:35:28,119
header alright so looking at like a

1059
00:35:25,990 --> 00:35:30,700
clean data set and a malware data set he

1060
00:35:28,119 --> 00:35:32,320
is better than average programmatically

1061
00:35:30,700 --> 00:35:33,819
detecting right so now I'm not saying I

1062
00:35:32,320 --> 00:35:35,890
want to replace antivirus this dude's

1063
00:35:33,820 --> 00:35:37,330
technique great but but it is a really

1064
00:35:35,890 --> 00:35:38,618
interesting technique highly recommend

1065
00:35:37,330 --> 00:35:40,119
that you go download this obviously I'll

1066
00:35:38,619 --> 00:35:42,040
upload these slides and tweet out a link

1067
00:35:40,119 --> 00:35:44,500
to these and whatever so I got typed

1068
00:35:42,040 --> 00:35:46,240
URLs right so when you type a URL not

1069
00:35:44,500 --> 00:35:49,270
when you click a link but when you type

1070
00:35:46,240 --> 00:35:51,399
URL into Explorer or edge I would use

1071
00:35:49,270 --> 00:35:52,750
Internet Explorer edge but usually the

1072
00:35:51,400 --> 00:35:53,859
answer is that you're logged on to a

1073
00:35:52,750 --> 00:35:56,140
server and you know have anything else

1074
00:35:53,859 --> 00:35:58,509
installed honestly right and so you pop

1075
00:35:56,140 --> 00:35:59,640
up in that server there or pop up and

1076
00:35:58,510 --> 00:36:01,710
Explorer on the server

1077
00:35:59,640 --> 00:36:02,970
I'll mention here that attackers often

1078
00:36:01,710 --> 00:36:04,770
when they already pee onto a machine

1079
00:36:02,970 --> 00:36:07,140
will open Internet Explorer and paste in

1080
00:36:04,770 --> 00:36:08,640
the URL all right now in many cases when

1081
00:36:07,140 --> 00:36:10,140
they're already peed on right so think

1082
00:36:08,640 --> 00:36:12,210
about like your ashore instances we have

1083
00:36:10,140 --> 00:36:14,279
RDP expose the Internet the attacker

1084
00:36:12,210 --> 00:36:16,500
manages to compromise credentials or

1085
00:36:14,280 --> 00:36:18,540
uses blue keep or by the way did anybody

1086
00:36:16,500 --> 00:36:20,250
see blue keep there's an actual exploit

1087
00:36:18,540 --> 00:36:23,820
released for that Metasploit as of today

1088
00:36:20,250 --> 00:36:25,950
like this afternoon yeah nasty anyway so

1089
00:36:23,820 --> 00:36:27,210
so alas they blue keep on or whatever if

1090
00:36:25,950 --> 00:36:29,069
you're not patched for blue keep at this

1091
00:36:27,210 --> 00:36:31,470
point you almost deserve it but anyway

1092
00:36:29,070 --> 00:36:32,940
look bottom line there then we go look

1093
00:36:31,470 --> 00:36:34,589
at the typed URLs here's what the

1094
00:36:32,940 --> 00:36:36,570
structure looks like right and you'll

1095
00:36:34,590 --> 00:36:38,430
notice here you are l1 and again these

1096
00:36:36,570 --> 00:36:40,560
are gonna one-up with every URL and I'll

1097
00:36:38,430 --> 00:36:42,330
mention here that if the key gets

1098
00:36:40,560 --> 00:36:44,759
deleted we know the numbers restart at

1099
00:36:42,330 --> 00:36:46,470
one sometimes they aged off rain

1100
00:36:44,760 --> 00:36:49,500
sometimes you do this through clearing

1101
00:36:46,470 --> 00:36:51,540
history other times anti forensics tools

1102
00:36:49,500 --> 00:36:54,000
like ccleaner or like my mom calls it

1103
00:36:51,540 --> 00:36:56,100
cleaner are used whatever the case is

1104
00:36:54,000 --> 00:36:57,930
their bottom line here is with some

1105
00:36:56,100 --> 00:37:00,210
surgery and by using this this

1106
00:36:57,930 --> 00:37:02,730
incredibly awesome reg command we're

1107
00:37:00,210 --> 00:37:04,200
able to go in and add in this domain and

1108
00:37:02,730 --> 00:37:06,990
if you don't recognize this one this is

1109
00:37:04,200 --> 00:37:09,240
a known Russian c2 domain I brought to

1110
00:37:06,990 --> 00:37:10,649
you by n kick this is one of those

1111
00:37:09,240 --> 00:37:13,339
included in the Grizzlies step report

1112
00:37:10,650 --> 00:37:15,930
right now B III FC black energy three

1113
00:37:13,340 --> 00:37:17,240
probably a little too obvious right I'd

1114
00:37:15,930 --> 00:37:19,470
probably want to use one of their known

1115
00:37:17,240 --> 00:37:21,330
executable names right but but again

1116
00:37:19,470 --> 00:37:22,919
this is the kind of thing that we plant

1117
00:37:21,330 --> 00:37:24,690
and I'm gonna be honest

1118
00:37:22,920 --> 00:37:26,400
nine out of ten forensic investigators

1119
00:37:24,690 --> 00:37:28,080
are gonna look at this and say one this

1120
00:37:26,400 --> 00:37:30,000
URL was typed in well that's not

1121
00:37:28,080 --> 00:37:32,190
necessarily the case let's be very clear

1122
00:37:30,000 --> 00:37:34,380
about this what we can say is that

1123
00:37:32,190 --> 00:37:38,010
there's a registry Qian typed URLs that

1124
00:37:34,380 --> 00:37:39,930
normally correlates to a user typing or

1125
00:37:38,010 --> 00:37:44,609
pasting URL into Explorer we have to be

1126
00:37:39,930 --> 00:37:45,990
really careful language but this is

1127
00:37:44,609 --> 00:37:47,730
where things get really cool because if

1128
00:37:45,990 --> 00:37:49,169
I really wanted to drag somebody down a

1129
00:37:47,730 --> 00:37:51,090
rabbit hole and I thought they were

1130
00:37:49,170 --> 00:37:53,460
gonna involve law enforcement nation

1131
00:37:51,090 --> 00:37:55,410
state II kind of stuff right I might go

1132
00:37:53,460 --> 00:37:57,630
register like a file-sharing account

1133
00:37:55,410 --> 00:38:00,600
like Dropbox for instance right and then

1134
00:37:57,630 --> 00:38:01,980
actually use a known bad tool name right

1135
00:38:00,600 --> 00:38:05,460
that's another Russian tool name there

1136
00:38:01,980 --> 00:38:09,060
and apt 28 specifically and then this

1137
00:38:05,460 --> 00:38:11,040
year this is a unique identifier Dropbox

1138
00:38:09,060 --> 00:38:13,140
used to actually include with the share

1139
00:38:11,040 --> 00:38:14,700
links a user ID here and it

1140
00:38:13,140 --> 00:38:16,558
a numeric user ID and they've stopped

1141
00:38:14,700 --> 00:38:18,240
doing that that's that's actually great

1142
00:38:16,559 --> 00:38:20,190
for a privacy perspective right because

1143
00:38:18,240 --> 00:38:23,069
now we can't correlate that multiple

1144
00:38:20,190 --> 00:38:25,289
share links belong to the same user that

1145
00:38:23,069 --> 00:38:27,329
said still with subpoena power you can

1146
00:38:25,289 --> 00:38:29,279
go back to Dropbox and they can come

1147
00:38:27,329 --> 00:38:30,450
back and tell you the user that that did

1148
00:38:29,279 --> 00:38:32,579
this now I want you to back up another

1149
00:38:30,450 --> 00:38:34,589
step here and think about if you had

1150
00:38:32,579 --> 00:38:37,230
already used a look-alike email address

1151
00:38:34,589 --> 00:38:38,549
right to register this and you can see

1152
00:38:37,230 --> 00:38:39,930
how light you can start putting stuff

1153
00:38:38,549 --> 00:38:41,519
together and all the sudden now it's not

1154
00:38:39,930 --> 00:38:43,190
one artifact it's multiple artifacts

1155
00:38:41,519 --> 00:38:45,538
right the email address used to register

1156
00:38:43,190 --> 00:38:47,519
correlates to you know correlates to

1157
00:38:45,539 --> 00:38:49,260
Russia the download name does write the

1158
00:38:47,519 --> 00:38:51,359
maybe the account name used here with

1159
00:38:49,260 --> 00:38:53,010
Dropbox etc all right now again not

1160
00:38:51,359 --> 00:38:54,538
picking on Russia specifically just kind

1161
00:38:53,010 --> 00:38:56,579
of thrown that out there is a you know

1162
00:38:54,539 --> 00:38:59,160
maybe blame it on Russia or not whatever

1163
00:38:56,579 --> 00:39:00,900
right bottom line as we forward on here

1164
00:38:59,160 --> 00:39:03,480
word wheel query is another great one

1165
00:39:00,900 --> 00:39:05,849
word wheel query stores search terms

1166
00:39:03,480 --> 00:39:07,140
using the Explorer UI now this is where

1167
00:39:05,849 --> 00:39:09,359
I wanna pick on China because I'm gonna

1168
00:39:07,140 --> 00:39:11,308
say China loves RDP if you look at their

1169
00:39:09,359 --> 00:39:13,740
tools some of their tools specifically

1170
00:39:11,309 --> 00:39:15,720
have RDP redirection built into them

1171
00:39:13,740 --> 00:39:17,069
like they can do generic TCP redirection

1172
00:39:15,720 --> 00:39:19,680
but in case you don't even know what

1173
00:39:17,069 --> 00:39:21,930
port RDP is on like you can't type 3389

1174
00:39:19,680 --> 00:39:23,730
reliably they have a separate function

1175
00:39:21,930 --> 00:39:26,009
built into some of their malware just to

1176
00:39:23,730 --> 00:39:27,930
redirect RDP it literally does you know

1177
00:39:26,009 --> 00:39:30,690
basically wraps that other piece to

1178
00:39:27,930 --> 00:39:32,339
redirect 3389 but in a lot of cases here

1179
00:39:30,690 --> 00:39:34,589
they're gonna go do a search right in

1180
00:39:32,339 --> 00:39:37,680
the GUI and when they do that search in

1181
00:39:34,589 --> 00:39:39,180
the GUI ouch right so what does that

1182
00:39:37,680 --> 00:39:40,980
actually look like well it turns out

1183
00:39:39,180 --> 00:39:42,538
here it's actually encoded all right and

1184
00:39:40,980 --> 00:39:44,640
I've actually heard investigators come

1185
00:39:42,539 --> 00:39:46,680
back and say well we know that's better

1186
00:39:44,640 --> 00:39:48,990
because it's encoded my friends this is

1187
00:39:46,680 --> 00:39:51,390
not encoding my goodness I mean this is

1188
00:39:48,990 --> 00:39:53,519
ASCII codes right with a null byte this

1189
00:39:51,390 --> 00:39:55,618
is little-endian unicode right that's

1190
00:39:53,519 --> 00:39:57,180
all it is and so you can see here

1191
00:39:55,619 --> 00:39:59,339
effectively that we can go in and

1192
00:39:57,180 --> 00:40:00,839
replace sorry let's say for instance

1193
00:39:59,339 --> 00:40:02,220
that i wanted to replace what was

1194
00:40:00,839 --> 00:40:04,920
originally a search for the word nothing

1195
00:40:02,220 --> 00:40:06,480
with a search for top secret right now

1196
00:40:04,920 --> 00:40:08,339
this is really really attractive because

1197
00:40:06,480 --> 00:40:09,900
the attackers one of the hardest things

1198
00:40:08,339 --> 00:40:12,058
we have with attackers is trying to

1199
00:40:09,900 --> 00:40:14,339
infer intent right and of course here

1200
00:40:12,059 --> 00:40:16,349
we're trying to plant a seed about what

1201
00:40:14,339 --> 00:40:18,240
was the attacker looking for right now

1202
00:40:16,349 --> 00:40:20,130
if you are going to steal something and

1203
00:40:18,240 --> 00:40:21,419
you wanted to point them away from that

1204
00:40:20,130 --> 00:40:23,099
thing you're stealing and point them

1205
00:40:21,420 --> 00:40:25,109
somewhere else I think this is a great

1206
00:40:23,099 --> 00:40:26,510
way to do it I hate to tell you like a

1207
00:40:25,109 --> 00:40:28,100
couple of years ago I had a

1208
00:40:26,510 --> 00:40:31,160
totally fallen for this all right so

1209
00:40:28,100 --> 00:40:33,049
anyway talk about recent docs right so

1210
00:40:31,160 --> 00:40:35,299
for logged into the GUI again RDP

1211
00:40:33,050 --> 00:40:36,860
consider opening a few documents that

1212
00:40:35,300 --> 00:40:38,090
you're not remotely interested in this

1213
00:40:36,860 --> 00:40:39,680
is actually gonna create a bunch of

1214
00:40:38,090 --> 00:40:41,960
linked files which you can also fake

1215
00:40:39,680 --> 00:40:43,220
with PowerShell right again these show

1216
00:40:41,960 --> 00:40:44,690
up in recent Docs and a bunch of

1217
00:40:43,220 --> 00:40:46,879
registry keys I don't have time to cover

1218
00:40:44,690 --> 00:40:48,620
here either talk about artifacts of

1219
00:40:46,880 --> 00:40:50,450
execution alright and I'm gonna die I'm

1220
00:40:48,620 --> 00:40:52,100
gonna blow through this right because

1221
00:40:50,450 --> 00:40:54,710
time we've got a lot of stuff to cover

1222
00:40:52,100 --> 00:40:57,319
still we've got prefetch shim cache AM

1223
00:40:54,710 --> 00:41:00,020
cache and user assists and prefetch it

1224
00:40:57,320 --> 00:41:01,790
turns out here is not enabled typically

1225
00:41:00,020 --> 00:41:03,710
when we have SSD machines this one's

1226
00:41:01,790 --> 00:41:05,600
becoming a little bit less reliable for

1227
00:41:03,710 --> 00:41:07,850
us to do but it turns out there's the

1228
00:41:05,600 --> 00:41:10,160
machine name is not coded in the

1229
00:41:07,850 --> 00:41:11,569
prefetch file at all right so the

1230
00:41:10,160 --> 00:41:13,879
prefetch file doesn't code the machine

1231
00:41:11,570 --> 00:41:16,040
name at all what they do code in is the

1232
00:41:13,880 --> 00:41:18,110
MFT and USN references as well as a

1233
00:41:16,040 --> 00:41:19,880
volume serial number but what this means

1234
00:41:18,110 --> 00:41:21,830
is that if you're not paying attention

1235
00:41:19,880 --> 00:41:23,900
and by the way most of our tools don't

1236
00:41:21,830 --> 00:41:25,400
extract this information right many of

1237
00:41:23,900 --> 00:41:26,540
our tools don't extract this information

1238
00:41:25,400 --> 00:41:27,410
and so if you're not paying attention

1239
00:41:26,540 --> 00:41:28,940
even if they do

1240
00:41:27,410 --> 00:41:31,339
are you actually comparing the volume

1241
00:41:28,940 --> 00:41:33,080
serial number right with the most people

1242
00:41:31,340 --> 00:41:35,060
again or not the tools certainly are not

1243
00:41:33,080 --> 00:41:37,430
automatically doing that and so again

1244
00:41:35,060 --> 00:41:38,990
here if we create a prefetch file on our

1245
00:41:37,430 --> 00:41:40,910
machine we can then upload that and

1246
00:41:38,990 --> 00:41:43,129
indicate that something was executed

1247
00:41:40,910 --> 00:41:44,839
that in fact really wasn't with shim

1248
00:41:43,130 --> 00:41:47,390
cache shim cache is another great

1249
00:41:44,840 --> 00:41:49,130
artifact of execution again this doesn't

1250
00:41:47,390 --> 00:41:50,990
necessarily indicate the executables run

1251
00:41:49,130 --> 00:41:53,060
but it does store the last right time in

1252
00:41:50,990 --> 00:41:54,410
the full path of the file another big

1253
00:41:53,060 --> 00:41:55,970
one here right now I mentioned shim

1254
00:41:54,410 --> 00:41:58,490
cache is only written to the registry

1255
00:41:55,970 --> 00:42:00,109
during shutdown tools exist to go

1256
00:41:58,490 --> 00:42:02,509
extract it from memory but they are less

1257
00:42:00,110 --> 00:42:04,160
commonly used by investigators I'll

1258
00:42:02,510 --> 00:42:05,720
mention that AM cache stores the full

1259
00:42:04,160 --> 00:42:08,060
path the executable and a sha-1 hash

1260
00:42:05,720 --> 00:42:09,830
this is another great one here right now

1261
00:42:08,060 --> 00:42:12,590
I technically have to go run this but

1262
00:42:09,830 --> 00:42:14,600
but picture this I go upload a piece of

1263
00:42:12,590 --> 00:42:17,360
malware a pen testing tool whatever that

1264
00:42:14,600 --> 00:42:19,009
looks totally like a PT 22 right it

1265
00:42:17,360 --> 00:42:22,010
doesn't get flagged I uploaded a virus

1266
00:42:19,010 --> 00:42:24,050
total you later go run AM cache parser

1267
00:42:22,010 --> 00:42:26,000
right you see the sha-1 go over to VT I

1268
00:42:24,050 --> 00:42:27,770
download the copy of it cuz it's no

1269
00:42:26,000 --> 00:42:29,120
longer on the machine alright download

1270
00:42:27,770 --> 00:42:31,820
the copy I see a bunch of strings that

1271
00:42:29,120 --> 00:42:33,770
relate to a PT 22 game on right and

1272
00:42:31,820 --> 00:42:36,560
again we're looking confirmation bias

1273
00:42:33,770 --> 00:42:38,060
here finally artifacts of execution

1274
00:42:36,560 --> 00:42:40,190
where the user assessed right so user

1275
00:42:38,060 --> 00:42:42,440
assist is basically looking at

1276
00:42:40,190 --> 00:42:43,579
that is double-clicked or run from the

1277
00:42:42,440 --> 00:42:45,470
GUI right so if you're running from the

1278
00:42:43,579 --> 00:42:47,869
command line you don't actually get a

1279
00:42:45,470 --> 00:42:49,368
user assist key put in place you do get

1280
00:42:47,869 --> 00:42:50,839
a run count with this but we're less

1281
00:42:49,369 --> 00:42:52,910
interested in the forensics side of this

1282
00:42:50,839 --> 00:42:55,099
then again bear in mind is sitting right

1283
00:42:52,910 --> 00:42:57,470
here an end to user dot that it's rot13

1284
00:42:55,099 --> 00:43:00,050
encoded which again it's not yeah its

1285
00:42:57,470 --> 00:43:01,790
rot13 right so it's a game on what about

1286
00:43:00,050 --> 00:43:03,410
encryption keys right so encryption keys

1287
00:43:01,790 --> 00:43:04,880
or easily recovered from powershell

1288
00:43:03,410 --> 00:43:06,890
scripts and look attackers love

1289
00:43:04,880 --> 00:43:08,420
powershell right we've seen a lot of

1290
00:43:06,890 --> 00:43:10,578
this obviously you can recover these

1291
00:43:08,420 --> 00:43:12,470
from other malware as well compiled

1292
00:43:10,579 --> 00:43:14,540
malware but I'll mention when we go use

1293
00:43:12,470 --> 00:43:15,950
keys for attribution you want to examine

1294
00:43:14,540 --> 00:43:18,349
whether or not the algorithm is

1295
00:43:15,950 --> 00:43:20,629
symmetric or asymmetric symmetric keys

1296
00:43:18,349 --> 00:43:22,700
are trivial to reuse right because the

1297
00:43:20,630 --> 00:43:25,130
same key encrypts and decrypts right so

1298
00:43:22,700 --> 00:43:26,960
I could use a key that the attacker has

1299
00:43:25,130 --> 00:43:28,700
used previously and again I've seen

1300
00:43:26,960 --> 00:43:30,470
malware reverse engineers as well as

1301
00:43:28,700 --> 00:43:32,060
your rules for that matter that match on

1302
00:43:30,470 --> 00:43:34,129
the file and then go there like oh

1303
00:43:32,060 --> 00:43:36,049
that's definitely fancy beer definitely

1304
00:43:34,130 --> 00:43:38,060
is not the word we want to use there all

1305
00:43:36,050 --> 00:43:39,470
right so want to be very very careful

1306
00:43:38,060 --> 00:43:42,078
about that now with asymmetric we only

1307
00:43:39,470 --> 00:43:43,640
have one side of the key pair now we

1308
00:43:42,079 --> 00:43:45,770
evaluate evidence for attribution we

1309
00:43:43,640 --> 00:43:47,029
value symmetric keys far more highly if

1310
00:43:45,770 --> 00:43:49,550
it hasn't been published in the CTI

1311
00:43:47,030 --> 00:43:51,470
report because well are the attackers

1312
00:43:49,550 --> 00:43:54,079
really gonna fake it how well-known is

1313
00:43:51,470 --> 00:43:55,819
it right now look the false flag side of

1314
00:43:54,079 --> 00:43:57,650
this I do want to be published in a CGI

1315
00:43:55,819 --> 00:43:59,359
report I want it to be obvious for the

1316
00:43:57,650 --> 00:44:01,940
investigator I want them to make that

1317
00:43:59,359 --> 00:44:03,770
connection make that link right so on

1318
00:44:01,940 --> 00:44:06,109
the asymmetric side I'll mention here

1319
00:44:03,770 --> 00:44:07,550
you can still use those false flag just

1320
00:44:06,109 --> 00:44:08,960
have to realize everything your

1321
00:44:07,550 --> 00:44:11,839
exfilling you can't actually look at

1322
00:44:08,960 --> 00:44:13,730
later right well I take that back there

1323
00:44:11,839 --> 00:44:16,460
were some folks at blackhat some crypto

1324
00:44:13,730 --> 00:44:18,440
clowns that can break RSA or at least

1325
00:44:16,460 --> 00:44:19,099
they claimed they can break RSA and

1326
00:44:18,440 --> 00:44:20,599
we'll see

1327
00:44:19,099 --> 00:44:21,859
I hope they can't because I'll be

1328
00:44:20,599 --> 00:44:25,369
shaving my head and doing some other

1329
00:44:21,859 --> 00:44:26,930
stuff there but anyway so let's close it

1330
00:44:25,369 --> 00:44:29,569
out here don't be useful idiot right

1331
00:44:26,930 --> 00:44:31,790
look bottom line don't become fixated on

1332
00:44:29,569 --> 00:44:34,460
a single artifact right I've covered a

1333
00:44:31,790 --> 00:44:36,140
bunch here I've only scratched literally

1334
00:44:34,460 --> 00:44:38,960
just scratched the surface we

1335
00:44:36,140 --> 00:44:40,310
brainstormed a ton of other stuff a ton

1336
00:44:38,960 --> 00:44:42,470
of other stuff that we could have put in

1337
00:44:40,310 --> 00:44:44,750
this presentation lawyers took a couple

1338
00:44:42,470 --> 00:44:47,810
things out of the presentation anyway

1339
00:44:44,750 --> 00:44:49,940
alas look bottom line actively avoid

1340
00:44:47,810 --> 00:44:51,799
anchoring on a single artifact to

1341
00:44:49,940 --> 00:44:54,309
attribute the intrusion we have to look

1342
00:44:51,800 --> 00:44:56,900
at the totality of the evidence

1343
00:44:54,309 --> 00:44:58,940
treat any potential false flag like any

1344
00:44:56,900 --> 00:45:00,349
other potential anti forensic activity

1345
00:44:58,940 --> 00:45:02,569
we always talk about hunting the

1346
00:45:00,349 --> 00:45:04,430
negative space look for what's not there

1347
00:45:02,569 --> 00:45:06,319
right event log deletion has become a

1348
00:45:04,430 --> 00:45:08,538
very common thing today with the release

1349
00:45:06,319 --> 00:45:10,038
of the shadow brokers tools consistently

1350
00:45:08,539 --> 00:45:12,499
we see people using that we've seen

1351
00:45:10,039 --> 00:45:14,150
people repurpose those tools these are

1352
00:45:12,499 --> 00:45:15,680
again it's something that we're seeing

1353
00:45:14,150 --> 00:45:17,690
consistently now that we didn't use to

1354
00:45:15,680 --> 00:45:19,578
see what I will say is most people suck

1355
00:45:17,690 --> 00:45:21,380
at deleting event logs they delete like

1356
00:45:19,579 --> 00:45:23,690
the one that has their actual user name

1357
00:45:21,380 --> 00:45:25,759
in it so there's a log on but there's no

1358
00:45:23,690 --> 00:45:27,710
sorry they delete the log on but they

1359
00:45:25,759 --> 00:45:30,769
forget to delete the log off right this

1360
00:45:27,710 --> 00:45:33,140
is huge right so that's one for us look

1361
00:45:30,769 --> 00:45:34,640
for anomalies again right so chains of

1362
00:45:33,140 --> 00:45:36,799
things that should be there and you're

1363
00:45:34,640 --> 00:45:38,690
missing a few of them or a few of them

1364
00:45:36,799 --> 00:45:40,759
look weirdly inserted sometimes

1365
00:45:38,690 --> 00:45:42,380
knowledge that a false flag was

1366
00:45:40,759 --> 00:45:44,089
attempted is good enough without knowing

1367
00:45:42,380 --> 00:45:46,549
needing to know specifically what

1368
00:45:44,089 --> 00:45:47,210
happened all right and then the Devils

1369
00:45:46,549 --> 00:45:49,069
in the details

1370
00:45:47,210 --> 00:45:50,720
little things like incorrect volume

1371
00:45:49,069 --> 00:45:53,660
serial numbers and prefetch I mentioned

1372
00:45:50,720 --> 00:45:55,160
this specifically this can really point

1373
00:45:53,660 --> 00:45:56,899
to planted evidence and I got to tell

1374
00:45:55,160 --> 00:45:59,779
you at the point that we see that we are

1375
00:45:56,900 --> 00:46:01,249
deep dive in every individual artifact

1376
00:45:59,779 --> 00:46:03,339
on the machine this is gonna be a very

1377
00:46:01,249 --> 00:46:05,839
expensive very complex investigation

1378
00:46:03,339 --> 00:46:08,390
because it has to be if you want ground

1379
00:46:05,839 --> 00:46:09,710
truth right secondarily I'll mention

1380
00:46:08,390 --> 00:46:11,058
that all too often during incident

1381
00:46:09,710 --> 00:46:13,190
response and even forensics were

1382
00:46:11,059 --> 00:46:15,049
processing way too much data to go

1383
00:46:13,190 --> 00:46:17,509
validate every field of every artifact

1384
00:46:15,049 --> 00:46:19,220
right time is not on our side right if

1385
00:46:17,509 --> 00:46:20,630
you're using EDR system out there today

1386
00:46:19,220 --> 00:46:22,519
you know all about this right rear

1387
00:46:20,630 --> 00:46:24,170
querying tens of thousands or hundreds

1388
00:46:22,519 --> 00:46:25,700
of thousands of machines looking

1389
00:46:24,170 --> 00:46:28,039
literally for that needle in a haystack

1390
00:46:25,700 --> 00:46:31,038
right and now that we have attackers

1391
00:46:28,039 --> 00:46:33,109
that we know are actively trying to mess

1392
00:46:31,039 --> 00:46:34,970
with our forensics and perform an t well

1393
00:46:33,109 --> 00:46:37,369
not just anti forensics but false-flag

1394
00:46:34,970 --> 00:46:38,720
forensics right again I want you to

1395
00:46:37,369 --> 00:46:40,099
think about how much more difficult it

1396
00:46:38,720 --> 00:46:41,930
is now you're not a hunting for a needle

1397
00:46:40,099 --> 00:46:44,089
in a haystack you may be hunting for a

1398
00:46:41,930 --> 00:46:45,799
piece of hay in a haystack right the

1399
00:46:44,089 --> 00:46:47,180
reality is that false flags are going to

1400
00:46:45,799 --> 00:46:48,769
become more common they're going to

1401
00:46:47,180 --> 00:46:51,288
become more sophisticated and our

1402
00:46:48,769 --> 00:46:53,238
forensics tools have to improve so I'll

1403
00:46:51,289 --> 00:46:55,819
drop a couple of key takeaways here we

1404
00:46:53,239 --> 00:46:57,829
brainstormed way more false flag attacks

1405
00:46:55,819 --> 00:46:59,779
than we had time to present in the

1406
00:46:57,829 --> 00:47:01,489
presentation most of the techniques we

1407
00:46:59,779 --> 00:47:03,410
presented today are wicked easy to

1408
00:47:01,489 --> 00:47:05,299
implement nothing that we discussed

1409
00:47:03,410 --> 00:47:06,828
requires nation state level funding the

1410
00:47:05,299 --> 00:47:07,940
most expensive thing that we discussed

1411
00:47:06,829 --> 00:47:09,740
was buying infrastruc

1412
00:47:07,940 --> 00:47:11,120
in another country and look let's be

1413
00:47:09,740 --> 00:47:12,919
honest we're gonna buy infrastructure

1414
00:47:11,120 --> 00:47:14,540
anyway there's just a little bit added

1415
00:47:12,920 --> 00:47:16,340
level of complication they're getting

1416
00:47:14,540 --> 00:47:17,840
the currency conversion and maybe get

1417
00:47:16,340 --> 00:47:19,550
that call from Amex but they're like hey

1418
00:47:17,840 --> 00:47:23,300
did you really authorize the charge on

1419
00:47:19,550 --> 00:47:24,890
Iran right which does happen anyway by

1420
00:47:23,300 --> 00:47:27,620
the way how ironic that American Express

1421
00:47:24,890 --> 00:47:29,990
is accepted by Iranian VPSs but whatever

1422
00:47:27,620 --> 00:47:31,819
anyway I'm look be on the lookout for a

1423
00:47:29,990 --> 00:47:33,919
potential false Flags trust your gut

1424
00:47:31,820 --> 00:47:36,800
right if you something feels wrong trust

1425
00:47:33,920 --> 00:47:39,440
your gut it's unlikely the attackers can

1426
00:47:36,800 --> 00:47:41,900
fake artifacts I'm sorry that they both

1427
00:47:39,440 --> 00:47:43,730
taking artifacts that are basically

1428
00:47:41,900 --> 00:47:45,050
displayed by the tools all right so

1429
00:47:43,730 --> 00:47:47,120
basically what we're looking at here is

1430
00:47:45,050 --> 00:47:49,010
attackers are likely to go fake stuff

1431
00:47:47,120 --> 00:47:50,299
that's not being displayed automatically

1432
00:47:49,010 --> 00:47:52,010
they know what our forensic tools are

1433
00:47:50,300 --> 00:47:53,390
the good ones you have to come know the

1434
00:47:52,010 --> 00:47:54,950
internals right this is what separates

1435
00:47:53,390 --> 00:47:56,779
the Joes from the pros at the end of the

1436
00:47:54,950 --> 00:47:58,189
day and look demand better from your

1437
00:47:56,780 --> 00:48:00,170
forensic tool developers that that's

1438
00:47:58,190 --> 00:48:01,520
really the only way to go because I'm

1439
00:48:00,170 --> 00:48:03,080
not gonna mention any forensic tool

1440
00:48:01,520 --> 00:48:05,450
names here I would love to I don't want

1441
00:48:03,080 --> 00:48:07,730
to get sued but there are some out there

1442
00:48:05,450 --> 00:48:09,890
that are horrendously bad and they are

1443
00:48:07,730 --> 00:48:11,570
not correlating data appropriately we

1444
00:48:09,890 --> 00:48:13,129
have some major commercial forensic

1445
00:48:11,570 --> 00:48:15,200
platforms that are still not parsing the

1446
00:48:13,130 --> 00:48:16,460
master file table correctly and I've got

1447
00:48:15,200 --> 00:48:17,930
good evidence of that right some of the

1448
00:48:16,460 --> 00:48:19,850
whole major conferences that I've spoken

1449
00:48:17,930 --> 00:48:21,980
at and go look at my bio right but but

1450
00:48:19,850 --> 00:48:24,049
alas all I'm saying is all right that it

1451
00:48:21,980 --> 00:48:25,370
like Wow and so if we're not doing

1452
00:48:24,050 --> 00:48:28,400
simple stuff like that

1453
00:48:25,370 --> 00:48:30,170
imagine how bad this is gonna be with

1454
00:48:28,400 --> 00:48:32,000
that I'm gonna go and close I think

1455
00:48:30,170 --> 00:48:34,310
we've got like one minute for questions

1456
00:48:32,000 --> 00:48:35,490
but otherwise catch me in the hall thank

1457
00:48:34,310 --> 00:48:41,119
you very much

1458
00:48:35,490 --> 00:48:42,959
[Applause]

1459
00:48:41,119 --> 00:48:44,339
and like I said I'll make these slides

1460
00:48:42,960 --> 00:48:45,779
available to weed out a link to these

1461
00:48:44,339 --> 00:48:48,750
later today I'm Matt Ward Jake on

1462
00:48:45,779 --> 00:48:50,760
Twitter if you don't want to uh so if

1463
00:48:48,750 --> 00:48:51,900
you want but you want to grab a copy

1464
00:48:50,760 --> 00:48:53,609
these again like I said I'll make them

1465
00:48:51,900 --> 00:48:56,930
available and they'll be a tweeted out

1466
00:48:53,609 --> 00:48:56,930
so anyway thanks much

