1
00:00:01,280 --> 00:00:06,930
all right cool so this is defeating

2
00:00:04,920 --> 00:00:08,879
next-gen AV and EDR using old tricks on

3
00:00:06,930 --> 00:00:14,129
new dogs these roam Twinkies I'm

4
00:00:08,880 --> 00:00:18,990
graphics so the obligatory bio my name

5
00:00:14,130 --> 00:00:21,210
is Nick layman at graphics on Twitter 10

6
00:00:18,990 --> 00:00:24,839
plus years in InfoSec mostly doing rent

7
00:00:21,210 --> 00:00:27,720
II mean I do see CDC Red Team for the

8
00:00:24,840 --> 00:00:32,430
Wisconsin C CDC as well as Midwest

9
00:00:27,720 --> 00:00:36,180
regionals they won last night yep

10
00:00:32,430 --> 00:00:39,000
hey wins win also a local city SEC

11
00:00:36,180 --> 00:00:41,070
organizer or dis organizer as the case

12
00:00:39,000 --> 00:00:42,989
may be and I'm also a Girl Scout leader

13
00:00:41,070 --> 00:00:44,789
ah my daughter who's in the front row

14
00:00:42,989 --> 00:00:47,099
here will be around after the talk to

15
00:00:44,789 --> 00:00:52,620
take some cookie orders I expect cookie

16
00:00:47,100 --> 00:00:54,690
orders from everybody I'm Steve eyes and

17
00:00:52,620 --> 00:00:58,260
I go by the handle drum Twinkies long

18
00:00:54,690 --> 00:01:00,959
story behind that ask me later red

19
00:00:58,260 --> 00:01:05,759
teamer understand red teamer in disguise

20
00:01:00,960 --> 00:01:10,229
on all things malware collecting

21
00:01:05,760 --> 00:01:13,860
creating and reversing turn ons

22
00:01:10,229 --> 00:01:20,250
vilest malware w my persistence and i

23
00:01:13,860 --> 00:01:23,009
have four daughters and a shotgun so a

24
00:01:20,250 --> 00:01:24,869
couple disclaimers first off we are not

25
00:01:23,009 --> 00:01:27,150
here in any official capacity of our

26
00:01:24,869 --> 00:01:29,070
company or a company our accompany

27
00:01:27,150 --> 00:01:30,750
neither can condone nor condemns the

28
00:01:29,070 --> 00:01:31,979
information we are about to present the

29
00:01:30,750 --> 00:01:33,509
views and opinions expressed in this

30
00:01:31,979 --> 00:01:35,970
presentation are not necessarily the

31
00:01:33,509 --> 00:01:37,200
views and opinions of our company this

32
00:01:35,970 --> 00:01:39,060
talk cannot be combined with any other

33
00:01:37,200 --> 00:01:40,890
offer or promotion no cash value void

34
00:01:39,060 --> 00:01:44,430
where prohibited by law offer expires 1

35
00:01:40,890 --> 00:01:48,060
1 1970 TLDR our company is wish they had

36
00:01:44,430 --> 00:01:49,470
our swagger disclaimer number two this

37
00:01:48,060 --> 00:01:51,270
talk is not focused on obtaining

38
00:01:49,470 --> 00:01:53,759
privilege escalation it is assumed that

39
00:01:51,270 --> 00:01:56,039
there are any number of paths to elevate

40
00:01:53,759 --> 00:01:57,479
to the required access through gaps in

41
00:01:56,040 --> 00:01:59,280
security controls unpatched OS

42
00:01:57,479 --> 00:02:00,390
vulnerabilities or overly permissive

43
00:01:59,280 --> 00:02:02,040
user accounts

44
00:02:00,390 --> 00:02:04,409
basically we're here to talk about

45
00:02:02,040 --> 00:02:06,149
killing a b and e dr well just assume

46
00:02:04,409 --> 00:02:08,340
for this talk that everyone is rocky and

47
00:02:06,149 --> 00:02:11,670
local admin by default you know like in

48
00:02:08,340 --> 00:02:15,310
the railroad TL DR we're going to focus

49
00:02:11,670 --> 00:02:19,269
on disabling a B&E d are not proof

50
00:02:15,310 --> 00:02:20,920
so the agenda for today background

51
00:02:19,270 --> 00:02:23,660
invasion is hard

52
00:02:20,920 --> 00:02:27,589
the trouble with cloud dependent a INE

53
00:02:23,660 --> 00:02:30,250
in in a needy are hitting the easy

54
00:02:27,590 --> 00:02:33,080
button silly things vendors do

55
00:02:30,250 --> 00:02:35,270
conclusions and questions / drinks well

56
00:02:33,080 --> 00:02:37,790
we'll be drinking the entire time you

57
00:02:35,270 --> 00:02:38,290
can get drinks later so a little bit of

58
00:02:37,790 --> 00:02:40,340
background

59
00:02:38,290 --> 00:02:43,299
yeah I'm not reading that if you want to

60
00:02:40,340 --> 00:02:43,300
I'll sit here for a minute

61
00:02:49,720 --> 00:02:58,220
all right so EDR software 101 endpoint

62
00:02:54,799 --> 00:03:01,610
detection response monitors processes

63
00:02:58,220 --> 00:03:03,890
network traffic memory sometimes feeds

64
00:03:01,610 --> 00:03:08,720
giant database for analytics and

65
00:03:03,890 --> 00:03:11,768
baseline stuff continuous modern airy

66
00:03:08,720 --> 00:03:16,370
monitoring of endpoints for anomalies

67
00:03:11,769 --> 00:03:19,340
all right endpoint detection and report

68
00:03:16,370 --> 00:03:23,320
is what we've seen there's really no

69
00:03:19,340 --> 00:03:23,320
response so it's the paul blart of a be

70
00:03:25,420 --> 00:03:41,179
bigger baseline better alerting mostly

71
00:03:29,470 --> 00:03:45,260
EDR is not a B next-gen AV 101 okay you

72
00:03:41,180 --> 00:03:47,600
guys already see the punch line old AV

73
00:03:45,260 --> 00:03:49,670
makes decisions based on file signatures

74
00:03:47,600 --> 00:03:52,549
in a really really big and process

75
00:03:49,670 --> 00:03:56,268
intensive database next Rene V looks at

76
00:03:52,549 --> 00:03:58,819
process behavior all day V long resource

77
00:03:56,269 --> 00:04:01,540
intensive file scans next-gen Navy

78
00:03:58,819 --> 00:04:04,670
behavioral analysis exploit detection

79
00:04:01,540 --> 00:04:07,190
application whitelisting and more old AV

80
00:04:04,670 --> 00:04:10,760
is a pain in the ass ton install see

81
00:04:07,190 --> 00:04:12,410
John McAfee stew toriel next-gen AV as

82
00:04:10,760 --> 00:04:19,399
it turns out is a lot easier to kill

83
00:04:12,410 --> 00:04:20,839
than John McAfee so before we get

84
00:04:19,399 --> 00:04:23,000
started and now that we have an

85
00:04:20,839 --> 00:04:26,210
understanding of what next-gen AV & EDR

86
00:04:23,000 --> 00:04:27,139
is I I want to give a shout out to a

87
00:04:26,210 --> 00:04:30,479
couple of

88
00:04:27,139 --> 00:04:32,880
people that have actually springboarded

89
00:04:30,480 --> 00:04:35,220
this research most importantly is Chris

90
00:04:32,880 --> 00:04:41,790
Thompson from x-force read he gave a

91
00:04:35,220 --> 00:04:43,440
talk at blackhat Europe in 2017 so URLs

92
00:04:41,790 --> 00:04:45,150
are there I'm will have the slides after

93
00:04:43,440 --> 00:04:51,389
that after the presentation if you need

94
00:04:45,150 --> 00:04:53,280
them to also basically we took hist week

95
00:04:51,389 --> 00:04:57,240
ripped from his work and then kind of

96
00:04:53,280 --> 00:05:00,210
expanded on it also mb/sec has had a

97
00:04:57,240 --> 00:05:03,479
couple of blog posts on kicking kicking

98
00:05:00,210 --> 00:05:07,739
silence and the teeth and especially

99
00:05:03,479 --> 00:05:10,950
thank you - evil Dobby for and he's over

100
00:05:07,740 --> 00:05:15,350
there say yeah

101
00:05:10,950 --> 00:05:19,770
for being a crowd strike test subject

102
00:05:15,350 --> 00:05:22,290
also shout-out to Specter ops for the

103
00:05:19,770 --> 00:05:29,880
work that they've done on Ackles decals

104
00:05:22,290 --> 00:05:31,380
cases so throughout all the research

105
00:05:29,880 --> 00:05:35,630
that we were doing when when we were

106
00:05:31,380 --> 00:05:38,580
looking to kind of dive into this realm

107
00:05:35,630 --> 00:05:41,340
we saw so many people doing invasion the

108
00:05:38,580 --> 00:05:44,729
invasion is hard and you unusual

109
00:05:41,340 --> 00:05:46,969
behavior is flagged risky windows API

110
00:05:44,729 --> 00:05:48,750
calls are almost always monitored

111
00:05:46,970 --> 00:05:51,000
PowerShell is watched like a hawk

112
00:05:48,750 --> 00:05:53,400
especially with now that it's got a MSI

113
00:05:51,000 --> 00:05:55,110
in it it's it's it's becoming more and

114
00:05:53,400 --> 00:05:56,630
more useless at least from an attacker

115
00:05:55,110 --> 00:05:58,979
standpoint

116
00:05:56,630 --> 00:06:00,419
not to say that it is completely useless

117
00:05:58,979 --> 00:06:02,990
I know that there are those edge cases

118
00:06:00,419 --> 00:06:05,270
where you can still get around things

119
00:06:02,990 --> 00:06:07,620
let's say the same thing with else ask

120
00:06:05,270 --> 00:06:12,389
memory contact if you'd be even trying

121
00:06:07,620 --> 00:06:15,240
to touch it it'll alert hours and hours

122
00:06:12,389 --> 00:06:18,720
of coding and testing can be burned in

123
00:06:15,240 --> 00:06:20,280
seconds which is really frustrating in

124
00:06:18,720 --> 00:06:23,370
that and that that's that's basically

125
00:06:20,280 --> 00:06:27,450
where we where we started to veer off

126
00:06:23,370 --> 00:06:28,880
into rather than evading and as you'll

127
00:06:27,450 --> 00:06:31,139
see in a minute

128
00:06:28,880 --> 00:06:36,240
we just found a better solution is to

129
00:06:31,139 --> 00:06:37,720
just turn it off so here's our recipe

130
00:06:36,240 --> 00:06:42,760
for success

131
00:06:37,720 --> 00:06:46,600
no Little John you need a half cup of

132
00:06:42,760 --> 00:06:49,870
cutoff coms so if the EDR can't see Cu

133
00:06:46,600 --> 00:06:54,370
threats and it has no rate and has no

134
00:06:49,870 --> 00:07:00,340
way to report it did it happen 25 grams

135
00:06:54,370 --> 00:07:01,720
of mimic user land activities if it

136
00:07:00,340 --> 00:07:07,780
looks like a user and smells like a user

137
00:07:01,720 --> 00:07:11,140
it must be a user 1.75 liters of kill

138
00:07:07,780 --> 00:07:14,020
the processes and services two dashes of

139
00:07:11,140 --> 00:07:16,270
fight dirty and three point three

140
00:07:14,020 --> 00:07:19,359
repeating ounces of force them to get

141
00:07:16,270 --> 00:07:22,870
better we've we've talked to a couple of

142
00:07:19,360 --> 00:07:29,590
vendors on this and really only only

143
00:07:22,870 --> 00:07:31,170
Microsoft was good good good on picks in

144
00:07:29,590 --> 00:07:34,719
some of the issues that we that we found

145
00:07:31,170 --> 00:07:37,090
we did have some push in Poland and and

146
00:07:34,720 --> 00:07:39,400
we did have a couple of bug reports that

147
00:07:37,090 --> 00:07:42,929
did eventually get fixed but it took a

148
00:07:39,400 --> 00:07:42,929
lot longer than we originally expected

149
00:07:43,500 --> 00:07:49,680
all right the trouble with cloud EDR

150
00:07:49,740 --> 00:07:56,250
cloud cloud dependent EDR requires a

151
00:07:52,810 --> 00:08:00,100
network can't call home can't report so

152
00:07:56,250 --> 00:08:03,370
basically you can take methods as a

153
00:08:00,100 --> 00:08:05,140
firewall you can basically block

154
00:08:03,370 --> 00:08:06,880
everything that goes out to Microsoft if

155
00:08:05,140 --> 00:08:10,000
you're dealing with ATP or other if you

156
00:08:06,880 --> 00:08:11,800
haven't know where it's EC is or just

157
00:08:10,000 --> 00:08:13,510
turn off the network device while you're

158
00:08:11,800 --> 00:08:17,620
doing your dirty beads know what's gonna

159
00:08:13,510 --> 00:08:21,750
get reported and bill it's all over and

160
00:08:17,620 --> 00:08:21,750
or if you just try it uninstalling it

161
00:08:23,669 --> 00:08:30,130
for Microsoft basically if you block

162
00:08:26,980 --> 00:08:35,560
anything all Microsoft or usually over

163
00:08:30,130 --> 00:08:37,270
four four four three interface you're

164
00:08:35,559 --> 00:08:39,909
pretty much cold you're not gonna get

165
00:08:37,270 --> 00:08:43,329
that recording whatever you're gonna do

166
00:08:39,909 --> 00:08:48,010
is they're going to run silently you're

167
00:08:43,330 --> 00:08:51,839
good cut up the brain in the body dies

168
00:08:48,010 --> 00:08:53,800
so with all that communication gone

169
00:08:51,839 --> 00:08:56,410
nothing forward to report nothing

170
00:08:53,800 --> 00:08:59,400
forward to do this is also true of your

171
00:08:56,410 --> 00:09:01,719
abs as well some of them require

172
00:08:59,400 --> 00:09:03,670
especially AI some of them require some

173
00:09:01,720 --> 00:09:05,560
sort of cloud analytics and when they

174
00:09:03,670 --> 00:09:07,990
don't have that analytics to depend on

175
00:09:05,560 --> 00:09:10,209
they become rather dominate they

176
00:09:07,990 --> 00:09:14,200
basically fall back to the old style

177
00:09:10,210 --> 00:09:15,760
hash value type eighties so thought that

178
00:09:14,200 --> 00:09:19,330
communications they're not quite as

179
00:09:15,760 --> 00:09:21,730
smart some of them silence in particular

180
00:09:19,330 --> 00:09:23,530
can run an offline mode be rather

181
00:09:21,730 --> 00:09:30,970
impressive at times but there are ways

182
00:09:23,530 --> 00:09:34,380
around that as well so who here knows a

183
00:09:30,970 --> 00:09:38,200
lot about WMI liars

184
00:09:34,380 --> 00:09:41,950
[Laughter]

185
00:09:38,200 --> 00:09:44,410
be honest WMI is a giant black box for

186
00:09:41,950 --> 00:09:46,000
most people that is where the sweetness

187
00:09:44,410 --> 00:09:47,920
is that's where a lot of malware is

188
00:09:46,000 --> 00:09:48,720
hanging out that's where a lot of stuff

189
00:09:47,920 --> 00:09:52,329
is happening

190
00:09:48,720 --> 00:09:54,910
WMI is a lot of the queries are not

191
00:09:52,330 --> 00:09:56,440
watched a lot of the recon is not

192
00:09:54,910 --> 00:09:57,969
launched in W my you can get away with a

193
00:09:56,440 --> 00:10:00,270
lot of stuff there you can get a lot of

194
00:09:57,970 --> 00:10:03,490
information off a machine with WMI

195
00:10:00,270 --> 00:10:05,140
probably not going to get seen and you

196
00:10:03,490 --> 00:10:07,680
can manipulate a lot of stuff with WMI

197
00:10:05,140 --> 00:10:12,160
and you can hit an entire organization

198
00:10:07,680 --> 00:10:20,560
over w my all at once so considered that

199
00:10:12,160 --> 00:10:22,780
consider that unmanaged code so when

200
00:10:20,560 --> 00:10:25,119
we're dealing with a eyes we've

201
00:10:22,780 --> 00:10:27,040
basically come to the conclusion if

202
00:10:25,120 --> 00:10:30,700
you're using managed code such as dotnet

203
00:10:27,040 --> 00:10:32,589
or C sharp or other interpreted

204
00:10:30,700 --> 00:10:34,680
languages the AI usually has a pretty

205
00:10:32,589 --> 00:10:38,350
good idea of what's gonna happen before

206
00:10:34,680 --> 00:10:40,390
it executes however if you're writing

207
00:10:38,350 --> 00:10:42,250
something in C and you don't call any

208
00:10:40,390 --> 00:10:44,439
libraries that don't do any includes if

209
00:10:42,250 --> 00:10:45,430
you roll it all your own pretty good

210
00:10:44,440 --> 00:10:47,440
chance it's not going to know what's

211
00:10:45,430 --> 00:10:50,020
gonna happen and it's gonna run whatever

212
00:10:47,440 --> 00:10:53,230
you're gonna run not knowing anything

213
00:10:50,020 --> 00:10:54,699
it's just gonna it really doesn't get to

214
00:10:53,230 --> 00:10:56,320
that depth the cold level is going to

215
00:10:54,700 --> 00:11:01,089
look at the screen

216
00:10:56,320 --> 00:11:03,459
the API your libraries but you're not

217
00:11:01,089 --> 00:11:16,089
doing any of that it's gonna be rather

218
00:11:03,459 --> 00:11:17,790
blind yeah real quick one thing that I

219
00:11:16,089 --> 00:11:21,850
wanted to point out on this slide is

220
00:11:17,790 --> 00:11:25,209
silent Trinity by by bleeder is testing

221
00:11:21,850 --> 00:11:28,540
the boundaries of what can be caught

222
00:11:25,209 --> 00:11:29,768
using dotnet framework we highly

223
00:11:28,540 --> 00:11:32,860
recommend checking it out if you haven't

224
00:11:29,769 --> 00:11:35,470
yet there's there's a lot of things that

225
00:11:32,860 --> 00:11:39,540
you can do with ironpython that you

226
00:11:35,470 --> 00:11:42,279
can't do with c-sharp and that and that

227
00:11:39,540 --> 00:11:45,959
specifically leads into the next slide

228
00:11:42,279 --> 00:11:48,759
with alternative register n keys or

229
00:11:45,959 --> 00:11:51,638
adding null terminators to to the Reg

230
00:11:48,759 --> 00:11:54,190
keys so you hide them one of the things

231
00:11:51,639 --> 00:11:57,130
that I pod in my testing was that using

232
00:11:54,190 --> 00:11:59,709
ironpython you can actually put in a

233
00:11:57,130 --> 00:12:01,290
reginal key and it's not going to throw

234
00:11:59,709 --> 00:12:03,910
that error when you go back you in

235
00:12:01,290 --> 00:12:06,550
regedit which i thought was actually

236
00:12:03,910 --> 00:12:07,959
kind of interesting so much so that I

237
00:12:06,550 --> 00:12:09,399
had to actually double check a couple

238
00:12:07,959 --> 00:12:13,779
times to make sure that it actually was

239
00:12:09,399 --> 00:12:18,040
added to the registry but we know that

240
00:12:13,779 --> 00:12:20,110
run keys have been burned although null

241
00:12:18,040 --> 00:12:23,410
byte reg registry values are sometimes

242
00:12:20,110 --> 00:12:25,540
still overlooked but you can't you can

243
00:12:23,410 --> 00:12:26,860
still detect them and regedit when you

244
00:12:25,540 --> 00:12:32,529
throw that error saying oh well we

245
00:12:26,860 --> 00:12:34,269
couldn't read this value and sometimes

246
00:12:32,529 --> 00:12:35,319
you might be able to just hijack and

247
00:12:34,269 --> 00:12:37,000
overwrite the existing

248
00:12:35,319 --> 00:12:46,120
start up binary and you don't even need

249
00:12:37,000 --> 00:12:48,069
to mess with the registry okay so

250
00:12:46,120 --> 00:12:50,500
fighting dirty so killing the running

251
00:12:48,069 --> 00:12:53,019
process stopper delete the service

252
00:12:50,500 --> 00:12:56,290
overwrite fold or binary driver with

253
00:12:53,019 --> 00:12:57,519
garbage so if you have a protective

254
00:12:56,290 --> 00:12:59,079
process light or you have some other

255
00:12:57,519 --> 00:13:03,189
stuff that are stopping from touching

256
00:12:59,079 --> 00:13:05,920
the folders in the piles headers right

257
00:13:03,189 --> 00:13:07,660
off the file using the low level editor

258
00:13:05,920 --> 00:13:08,920
a hex editor make the pile on notable

259
00:13:07,660 --> 00:13:10,480
move that machine

260
00:13:08,920 --> 00:13:13,449
build a service it's not going to start

261
00:13:10,480 --> 00:13:18,100
up again you're a B is not going as you

262
00:13:13,449 --> 00:13:19,420
please and then of course we have apples

263
00:13:18,100 --> 00:13:21,369
tackles and I cats

264
00:13:19,420 --> 00:13:24,699
is anybody considered just take

265
00:13:21,369 --> 00:13:31,720
ownership of it and change the Apple

266
00:13:24,699 --> 00:13:35,069
you'd be surprised what you can do so oh

267
00:13:31,720 --> 00:13:39,579
sorry you need to speak up so uh

268
00:13:35,069 --> 00:13:43,829
basically in the last slide up there we

269
00:13:39,579 --> 00:13:48,399
go so now we're not advocating

270
00:13:43,829 --> 00:13:51,549
destruction of data but what we say

271
00:13:48,399 --> 00:13:53,619
fight dirty if you have to force a sis

272
00:13:51,549 --> 00:13:58,389
at system admin to go back in and

273
00:13:53,619 --> 00:14:00,850
reinstall one of these EDRs or next-gen

274
00:13:58,389 --> 00:14:02,049
abies that's going to piss them no off -

275
00:14:00,850 --> 00:14:03,519
no in and that's going to force them to

276
00:14:02,049 --> 00:14:13,149
go to the vendor and say hey why don't

277
00:14:03,519 --> 00:14:14,169
you fix this so force this this is also

278
00:14:13,149 --> 00:14:16,269
going to force them to get better it's

279
00:14:14,169 --> 00:14:18,160
going to hold them accountable honestly

280
00:14:16,269 --> 00:14:21,040
this is something that traditional Navy

281
00:14:18,160 --> 00:14:24,368
has been doing for years I've tried I've

282
00:14:21,040 --> 00:14:25,899
tried with Sophos and the only way I was

283
00:14:24,369 --> 00:14:28,179
able to actually disable or uninstall it

284
00:14:25,899 --> 00:14:30,040
was to reboot into safe mode so the

285
00:14:28,179 --> 00:14:32,199
kernel mode driver won't wouldn't load

286
00:14:30,040 --> 00:14:34,839
and that was the only way I was able to

287
00:14:32,199 --> 00:14:37,149
mess with it and remove it this is

288
00:14:34,839 --> 00:14:40,899
something that can be that can be fixed

289
00:14:37,149 --> 00:14:42,910
and while next-gen AV is very good at

290
00:14:40,899 --> 00:14:45,579
what it does it's not very good at

291
00:14:42,910 --> 00:14:50,709
protecting itself yes we can make it

292
00:14:45,579 --> 00:14:52,179
better so we also know no more

293
00:14:50,709 --> 00:14:56,498
PowerShell everybody's going to C sharp

294
00:14:52,179 --> 00:14:58,149
everybody's going to C++ native but

295
00:14:56,499 --> 00:15:03,519
native commands are really all you need

296
00:14:58,149 --> 00:15:08,439
you can do so much more with a small

297
00:15:03,519 --> 00:15:11,439
batch script and not get detected then

298
00:15:08,439 --> 00:15:13,858
you can with a few hundred lines of

299
00:15:11,439 --> 00:15:13,858
c-sharp

300
00:15:14,280 --> 00:15:20,709
so we found that for all that cool

301
00:15:18,550 --> 00:15:23,890
high-tech machine learning AI blockchain

302
00:15:20,710 --> 00:15:25,720
buzzy buzzy where D where D features not

303
00:15:23,890 --> 00:15:30,040
a bug value-added protection mechanism

304
00:15:25,720 --> 00:15:33,040
whatever they had some very low level

305
00:15:30,040 --> 00:15:35,410
and very highly exploitable chinks in

306
00:15:33,040 --> 00:15:38,680
the armor now when I say this I mean

307
00:15:35,410 --> 00:15:41,620
that this is true of every EDR an action

308
00:15:38,680 --> 00:15:47,859
nav that we were able to test including

309
00:15:41,620 --> 00:15:51,340
ATP until recently we haven't finished

310
00:15:47,860 --> 00:15:53,770
researching one particular vendor which

311
00:15:51,340 --> 00:15:55,300
is carbon black but we're hoping to do

312
00:15:53,770 --> 00:15:59,439
that and maybe maybe we'll do a blog

313
00:15:55,300 --> 00:16:03,870
post about it so how is this all

314
00:15:59,440 --> 00:16:07,690
possible you asked I'm sorry

315
00:16:03,870 --> 00:16:10,990
and our mouths ranked at least knows

316
00:16:07,690 --> 00:16:14,110
this because they've been told about it

317
00:16:10,990 --> 00:16:15,790
by their customers a friend a friend of

318
00:16:14,110 --> 00:16:18,400
mine actually sent me this screenshot

319
00:16:15,790 --> 00:16:22,959
from their customer service from their

320
00:16:18,400 --> 00:16:24,400
customer forums talking about how all

321
00:16:22,960 --> 00:16:29,530
you need to do is just go in and delete

322
00:16:24,400 --> 00:16:32,439
the files files and your gold now first

323
00:16:29,530 --> 00:16:34,959
off good on CrowdStrike for getting a

324
00:16:32,440 --> 00:16:38,860
protective process light process now who

325
00:16:34,960 --> 00:16:42,580
here knows what a ppl processes okay

326
00:16:38,860 --> 00:16:45,880
only a couple ppl is basically it's a

327
00:16:42,580 --> 00:16:48,120
protected process in the kernel it loads

328
00:16:45,880 --> 00:16:53,710
through an early early anti-malware

329
00:16:48,120 --> 00:16:55,120
driver and gets loaded with extra

330
00:16:53,710 --> 00:16:57,880
protections from the kernel basically

331
00:16:55,120 --> 00:16:59,140
even a system you can't stop the process

332
00:16:57,880 --> 00:17:02,370
you can't turn it off

333
00:16:59,140 --> 00:17:02,370
you can't delete the service

334
00:17:02,690 --> 00:17:09,860
and so but but for this particular

335
00:17:07,150 --> 00:17:11,270
instance they know that they have the

336
00:17:09,859 --> 00:17:14,658
gaps in the file system and this was as

337
00:17:11,270 --> 00:17:20,809
of June I'm sorry July of this year that

338
00:17:14,659 --> 00:17:22,789
they at least knew about it so but

339
00:17:20,809 --> 00:17:25,039
however in some some instances even

340
00:17:22,789 --> 00:17:27,980
local admin or system isn't allowed to

341
00:17:25,039 --> 00:17:31,010
mess with the file system or or even the

342
00:17:27,980 --> 00:17:32,710
registry in this case so well what are

343
00:17:31,010 --> 00:17:35,539
we to do

344
00:17:32,710 --> 00:17:37,760
luckily Microsoft was nice enough to

345
00:17:35,539 --> 00:17:39,890
include a special privilege to help us

346
00:17:37,760 --> 00:17:42,710
out with that and this privilege is

347
00:17:39,890 --> 00:17:47,320
enabled by default for all local

348
00:17:42,710 --> 00:17:47,320
administrators it's the take ownership

349
00:17:47,679 --> 00:17:56,150
privilege so take ownership of files or

350
00:17:52,520 --> 00:17:57,980
other objects this security setting

351
00:17:56,150 --> 00:18:00,380
determines which users can take

352
00:17:57,980 --> 00:18:02,419
ownership of ASIC any securable object

353
00:18:00,380 --> 00:18:05,510
in the system including Active Directory

354
00:18:02,419 --> 00:18:08,299
objects files and folders printers

355
00:18:05,510 --> 00:18:11,289
registry keys processes and threads what

356
00:18:08,299 --> 00:18:15,559
they leave out here is service objects

357
00:18:11,289 --> 00:18:16,429
caution assigning this user right can be

358
00:18:15,559 --> 00:18:18,980
a security risk

359
00:18:16,429 --> 00:18:21,559
since owners of objects have full

360
00:18:18,980 --> 00:18:24,880
control of them only assign this user

361
00:18:21,559 --> 00:18:28,428
right to trusted users default as admins

362
00:18:24,880 --> 00:18:32,929
so think about that for a second any

363
00:18:28,429 --> 00:18:35,440
object any securable object you can take

364
00:18:32,929 --> 00:18:38,030
ownership of if you're a local head

365
00:18:35,440 --> 00:18:40,070
including active directory including

366
00:18:38,030 --> 00:18:42,830
registry including service including

367
00:18:40,070 --> 00:18:46,220
processes and once you have ownership of

368
00:18:42,830 --> 00:18:50,270
it you have full control over it whoa

369
00:18:46,220 --> 00:18:57,590
that was a lot so and any anything with

370
00:18:50,270 --> 00:18:59,389
Akal has an owner all right let's look

371
00:18:57,590 --> 00:19:02,199
and see what that looks like so this is

372
00:18:59,390 --> 00:19:06,470
what we call so easy even HR can do it

373
00:19:02,200 --> 00:19:07,909
we had when we were doing this we were

374
00:19:06,470 --> 00:19:12,140
talking about the evasion part earlier

375
00:19:07,909 --> 00:19:13,700
we found that basically there's there's

376
00:19:12,140 --> 00:19:16,010
a much easier way to do this instead of

377
00:19:13,700 --> 00:19:16,340
trying to evade let's just go after the

378
00:19:16,010 --> 00:19:17,929
AV

379
00:19:16,340 --> 00:19:20,899
let's make it go away and here's what we

380
00:19:17,929 --> 00:19:24,490
did so we took this take own process and

381
00:19:20,900 --> 00:19:26,690
we looked at I cackles one-liners and

382
00:19:24,490 --> 00:19:28,669
putting them into some bad files and we

383
00:19:26,690 --> 00:19:31,220
just played around to see what what we

384
00:19:28,669 --> 00:19:33,440
could do so right here we have some camp

385
00:19:31,220 --> 00:19:35,630
commands right here so in this case this

386
00:19:33,440 --> 00:19:38,240
is Windows Defender advanced threat

387
00:19:35,630 --> 00:19:41,169
protection that first line up there is

388
00:19:38,240 --> 00:19:44,929
to take ownership of the directory

389
00:19:41,169 --> 00:19:46,760
prior to this recently you could take

390
00:19:44,929 --> 00:19:49,520
ownership of that entire directory and

391
00:19:46,760 --> 00:19:52,370
then of course set the I cackled to

392
00:19:49,520 --> 00:19:53,750
grant everyone and then of course you

393
00:19:52,370 --> 00:19:56,539
could rename it and delete it and do

394
00:19:53,750 --> 00:19:57,860
whatever you want with it however that

395
00:19:56,539 --> 00:19:59,539
was kind of a long process you'd have to

396
00:19:57,860 --> 00:20:00,979
reboot first before he could rename it

397
00:19:59,539 --> 00:20:02,600
because it was a protected process light

398
00:20:00,980 --> 00:20:05,570
so he still can't shut it down but you

399
00:20:02,600 --> 00:20:06,830
have control the X YZ now you can rename

400
00:20:05,570 --> 00:20:08,720
them so they're not going to start back

401
00:20:06,830 --> 00:20:10,149
up or you could just delete them there's

402
00:20:08,720 --> 00:20:13,429
all kinds of things that you could do

403
00:20:10,149 --> 00:20:17,029
but what if this other line down here

404
00:20:13,429 --> 00:20:18,890
what if we just set system deny you know

405
00:20:17,029 --> 00:20:20,450
now we don't have to rename it now we

406
00:20:18,890 --> 00:20:22,220
don't have to do anything with it now

407
00:20:20,450 --> 00:20:24,559
just when it comes back up after the

408
00:20:22,220 --> 00:20:26,270
first reboot that's gonna happen it

409
00:20:24,559 --> 00:20:32,240
can't touch it system can't touch it so

410
00:20:26,270 --> 00:20:35,240
or use the VI cackled against it so most

411
00:20:32,240 --> 00:20:37,220
recently Microsoft apparently has heard

412
00:20:35,240 --> 00:20:38,539
this discussion or has heard us because

413
00:20:37,220 --> 00:20:42,590
we've spoken to them and let them know

414
00:20:38,539 --> 00:20:45,500
about this they did in fact harden these

415
00:20:42,590 --> 00:20:47,178
directories so you can no longer take

416
00:20:45,500 --> 00:20:49,039
ownership not even as system so if

417
00:20:47,179 --> 00:20:51,440
you're looking here at the screen you

418
00:20:49,039 --> 00:20:53,779
see the Who am I I'm NT authority system

419
00:20:51,440 --> 00:20:56,360
when I try and do the take ownership it

420
00:20:53,779 --> 00:21:00,350
just says access denied so even as local

421
00:20:56,360 --> 00:21:04,850
admin even as system nothing cool right

422
00:21:00,350 --> 00:21:08,980
you know they're they're learning and

423
00:21:04,850 --> 00:21:12,830
then of course silly things vendors do

424
00:21:08,980 --> 00:21:17,809
so Windows Defender has hardened their

425
00:21:12,830 --> 00:21:20,389
directories but all you need to do is

426
00:21:17,809 --> 00:21:22,279
flip a bit on a registry key just as

427
00:21:20,390 --> 00:21:26,980
local admin it is protected up to local

428
00:21:22,279 --> 00:21:29,160
admin and Windows Defender is disabled

429
00:21:26,980 --> 00:21:37,590
all you need is that reg

430
00:21:29,160 --> 00:21:39,780
and you're done got your picture alright

431
00:21:37,590 --> 00:21:41,550
so in addition to the vulnerable areas

432
00:21:39,780 --> 00:21:43,950
that we've just discussed there are also

433
00:21:41,550 --> 00:21:45,600
some silly things that vendors do which

434
00:21:43,950 --> 00:21:47,040
also helped us accomplish the goal of

435
00:21:45,600 --> 00:21:50,639
just turning off the protection

436
00:21:47,040 --> 00:21:53,820
mechanisms Silas did a couple of these

437
00:21:50,640 --> 00:21:57,050
now rom Twinkies and I we wrote a blog

438
00:21:53,820 --> 00:21:59,460
on this on this failed in particular

439
00:21:57,050 --> 00:22:00,600
complete with a POC script yes its

440
00:21:59,460 --> 00:22:02,040
PowerShell and we said not to use

441
00:22:00,600 --> 00:22:03,600
PowerShell but we're confident your

442
00:22:02,040 --> 00:22:08,159
ability to mimic these actions and other

443
00:22:03,600 --> 00:22:10,520
automated ways specifically we were

444
00:22:08,160 --> 00:22:13,440
taking a look at the silence SBC's

445
00:22:10,520 --> 00:22:17,879
executable service or a service binary

446
00:22:13,440 --> 00:22:19,470
and I was trying to figure out what how

447
00:22:17,880 --> 00:22:20,910
does it work I mean what can we do is

448
00:22:19,470 --> 00:22:22,680
there like a is there a help menu or

449
00:22:20,910 --> 00:22:26,570
something so I was just throwing some

450
00:22:22,680 --> 00:22:29,370
you know silence as we see that exe stop

451
00:22:26,570 --> 00:22:31,409
you know and it didn't like it but it

452
00:22:29,370 --> 00:22:34,469
was it helped me out with a nice little

453
00:22:31,410 --> 00:22:35,850
help message and I'm not sure if you

454
00:22:34,470 --> 00:22:40,320
guys can actually read that read the

455
00:22:35,850 --> 00:22:42,949
screen but it gave me a couple of flakes

456
00:22:40,320 --> 00:22:44,700
that I could use one of them wants - I

457
00:22:42,950 --> 00:22:47,760
the other one was a little bit more

458
00:22:44,700 --> 00:22:50,300
interesting that was - you and it says

459
00:22:47,760 --> 00:22:54,150
removes the window service if installed

460
00:22:50,300 --> 00:22:56,159
now my version of silence had an

461
00:22:54,150 --> 00:22:57,450
uninstall token which of course the

462
00:22:56,160 --> 00:23:01,560
desktop team wouldn't give me the

463
00:22:57,450 --> 00:23:03,360
uninstall token for so I was like well

464
00:23:01,560 --> 00:23:04,470
maybe it's gonna ask me if the young

465
00:23:03,360 --> 00:23:09,590
install token or maybe it's gonna

466
00:23:04,470 --> 00:23:14,250
require it as a command line option soap

467
00:23:09,590 --> 00:23:16,260
honest uninstallation succeeded so the

468
00:23:14,250 --> 00:23:19,740
service was still running so it would

469
00:23:16,260 --> 00:23:23,280
still require a reboot but it was now

470
00:23:19,740 --> 00:23:25,650
disabled and upon reboot you could just

471
00:23:23,280 --> 00:23:27,780
go to town and and do whatever you could

472
00:23:25,650 --> 00:23:29,220
you could plant your malware or plant

473
00:23:27,780 --> 00:23:29,550
your payload wait for it wait for it to

474
00:23:29,220 --> 00:23:32,040
reboot

475
00:23:29,550 --> 00:23:33,750
you know because Windows never shits the

476
00:23:32,040 --> 00:23:37,620
bed and you need to reboot it like once

477
00:23:33,750 --> 00:23:40,620
a week so we actually reported this to

478
00:23:37,620 --> 00:23:42,129
silence and and they they said oh well

479
00:23:40,620 --> 00:23:43,959
that that's you know

480
00:23:42,130 --> 00:23:45,160
that's group that's great well we'll

481
00:23:43,960 --> 00:23:49,210
take it under advisement we'll look at

482
00:23:45,160 --> 00:23:52,360
it as a feature enhancement and and they

483
00:23:49,210 --> 00:23:53,620
did they did fix it so fixed an issue

484
00:23:52,360 --> 00:23:55,860
where the silent service could be

485
00:23:53,620 --> 00:24:01,418
uninstalled on Windows

486
00:23:55,860 --> 00:24:02,428
so as of silence version 1520 you can no

487
00:24:01,419 --> 00:24:10,720
longer do that

488
00:24:02,429 --> 00:24:13,600
however they added some more flags so

489
00:24:10,720 --> 00:24:18,250
you can now register unregister enable

490
00:24:13,600 --> 00:24:22,030
and disable silence within the windows

491
00:24:18,250 --> 00:24:24,789
Security Center so I was like okay this

492
00:24:22,030 --> 00:24:27,870
is kind of cool now full disclosure you

493
00:24:24,789 --> 00:24:30,309
do need to be actually at system level

494
00:24:27,870 --> 00:24:32,379
so you need to be the authority system

495
00:24:30,309 --> 00:24:37,899
in order to actually get access to this

496
00:24:32,380 --> 00:24:41,559
particular help menu and these flags so

497
00:24:37,900 --> 00:24:43,929
I started playing with it like okay I'll

498
00:24:41,559 --> 00:24:53,879
disable I'll on register I'll disable

499
00:24:43,929 --> 00:24:56,559
I'll register and lo hold they you know

500
00:24:53,880 --> 00:24:58,360
see this pop-up virus in threat

501
00:24:56,559 --> 00:25:00,760
protection check virus protection

502
00:24:58,360 --> 00:25:05,199
Windows Defender antivirus and silence

503
00:25:00,760 --> 00:25:08,289
protect are both turned off please quick

504
00:25:05,200 --> 00:25:12,190
to see installed antivirus apps we

505
00:25:08,289 --> 00:25:16,419
didn't actually have that but in

506
00:25:12,190 --> 00:25:19,780
addition to these these kind of

507
00:25:16,419 --> 00:25:22,419
oversights that helped me as the

508
00:25:19,780 --> 00:25:24,129
attacker there were a couple of other

509
00:25:22,419 --> 00:25:29,590
gaps and and I want to actually go

510
00:25:24,130 --> 00:25:32,289
through those real quick and we got time

511
00:25:29,590 --> 00:25:40,020
I'm gonna tempt the demo gods with a

512
00:25:32,289 --> 00:25:40,020
couple of live demos here so

513
00:25:47,539 --> 00:26:11,210
bear with me for just a moment just can

514
00:26:04,470 --> 00:26:23,510
you see okay hold on a second hold this

515
00:26:11,210 --> 00:26:23,510
quick cold my beer can we

516
00:26:34,310 --> 00:26:41,020
[Music]

517
00:26:37,380 --> 00:26:42,280
and this would be tempting demo gods

518
00:26:41,020 --> 00:26:48,820
there we go

519
00:26:42,280 --> 00:26:50,560
all right I can see it alright so this

520
00:26:48,820 --> 00:26:52,300
is the latest version that I was able to

521
00:26:50,560 --> 00:26:59,679
get ahold of which is silence

522
00:26:52,300 --> 00:27:04,300
15:30 so a couple of things with regards

523
00:26:59,680 --> 00:27:07,210
to the protection of registry objects

524
00:27:04,300 --> 00:27:12,250
file system objects and and surface

525
00:27:07,210 --> 00:27:14,320
objects one of the things that we have

526
00:27:12,250 --> 00:27:15,970
here is the okay so this is the service

527
00:27:14,320 --> 00:27:18,370
so

528
00:27:15,970 --> 00:27:21,040
hklm system concurrent control set

529
00:27:18,370 --> 00:27:24,429
services silence SVC this is the

530
00:27:21,040 --> 00:27:26,560
registry key that tells windows that

531
00:27:24,430 --> 00:27:28,930
this is a service this is what you run

532
00:27:26,560 --> 00:27:31,480
this is how you run it this is you know

533
00:27:28,930 --> 00:27:39,180
everything that you put into the the

534
00:27:31,480 --> 00:27:40,750
services UI gets populated in here and

535
00:27:39,180 --> 00:27:43,780
additionally there's there's some

536
00:27:40,750 --> 00:27:46,570
security that you have here which this

537
00:27:43,780 --> 00:27:50,320
is where your security SD dl gets put in

538
00:27:46,570 --> 00:27:53,260
in in binary and honestly I'm not really

539
00:27:50,320 --> 00:27:58,210
concerned with this but if we delete if

540
00:27:53,260 --> 00:28:02,590
we delete this registry key we no longer

541
00:27:58,210 --> 00:28:05,080
have a service but hold it says cannot

542
00:28:02,590 --> 00:28:10,810
delete silence SVC service error while

543
00:28:05,080 --> 00:28:11,970
deleting key so what do we do let's take

544
00:28:10,810 --> 00:28:14,500
a look at the permissions okay so

545
00:28:11,970 --> 00:28:17,620
administrator oh well he he can only

546
00:28:14,500 --> 00:28:19,860
read let's go ahead and change the

547
00:28:17,620 --> 00:28:19,860
ownership

548
00:28:32,990 --> 00:29:07,140
well that took in this is why a doing

549
00:29:01,140 --> 00:29:10,160
live demos let's go ahead and

550
00:29:07,140 --> 00:29:10,160
double-check our permission

551
00:29:11,990 --> 00:29:22,110
well I think we're gonna okay so I know

552
00:29:17,670 --> 00:29:24,380
I so give a full permission here well

553
00:29:22,110 --> 00:29:24,379
control

554
00:29:37,020 --> 00:29:50,710
all right so there we go that I took out

555
00:29:41,590 --> 00:29:57,699
the registry key and when we reboot all

556
00:29:50,710 --> 00:29:59,169
this so as you're looking at all this

557
00:29:57,700 --> 00:30:02,020
and what we're doing imagine being able

558
00:29:59,169 --> 00:30:07,450
to do this by a WMI to an entire network

559
00:30:02,020 --> 00:30:09,280
all at once just let that sink in for a

560
00:30:07,450 --> 00:30:12,730
moment as to how fast you could bring

561
00:30:09,280 --> 00:30:15,389
down an entire an entire network of

562
00:30:12,730 --> 00:30:15,390
protection

563
00:30:25,000 --> 00:30:41,690
Microsoft is updating don't close it so

564
00:30:40,370 --> 00:30:48,199
how many are having a good time into

565
00:30:41,690 --> 00:30:52,130
every kind yeah make it a good one last

566
00:30:48,200 --> 00:30:55,540
one so let's all have a good time and

567
00:30:52,130 --> 00:30:55,540
also make sure to give Dave a big hug

568
00:30:58,870 --> 00:31:03,949
just from my perspective this has been a

569
00:31:01,370 --> 00:31:05,899
tremendous privilege to be able to

570
00:31:03,950 --> 00:31:09,410
attend Derby Khan's I've learned a lot

571
00:31:05,900 --> 00:31:11,330
from other people speaking so if you

572
00:31:09,410 --> 00:31:13,100
guys got good stuff to share consider

573
00:31:11,330 --> 00:31:14,960
speaking yourself and putting yourself

574
00:31:13,100 --> 00:31:16,490
out there there's a lot of us that have

575
00:31:14,960 --> 00:31:19,370
information that you can help the rest

576
00:31:16,490 --> 00:31:20,960
of us it's just not the next therapy

577
00:31:19,370 --> 00:31:23,719
kind of course but there are other

578
00:31:20,960 --> 00:31:36,850
conferences out there so you know share

579
00:31:23,720 --> 00:31:39,230
what you know Spotted Cow New Glarus

580
00:31:36,850 --> 00:31:41,530
yeah but we're from Wisconsin so it's

581
00:31:39,230 --> 00:31:41,530
like water

582
00:31:42,790 --> 00:31:51,800
yeah we'll drink anything and again all

583
00:31:47,510 --> 00:31:57,170
right so we rebooted yeah we're still

584
00:31:51,800 --> 00:32:00,050
loading up here get some music or

585
00:31:57,170 --> 00:32:02,600
something all right so it says

586
00:32:00,050 --> 00:32:06,379
connecting to service so the silence

587
00:32:02,600 --> 00:32:09,050
protect Trey still opens and is still

588
00:32:06,380 --> 00:32:12,020
there but the service is now gone it's

589
00:32:09,050 --> 00:32:14,990
it's been deleted so it'll look like

590
00:32:12,020 --> 00:32:18,080
it's still there and it'll it'll show up

591
00:32:14,990 --> 00:32:20,990
that little little icon but you try to

592
00:32:18,080 --> 00:32:25,189
run something it'll letter through the

593
00:32:20,990 --> 00:32:28,640
services is gone that that's the brains

594
00:32:25,190 --> 00:32:31,070
and and the the action behind silence so

595
00:32:28,640 --> 00:32:34,240
I'm gonna do another one more silence

596
00:32:31,070 --> 00:32:34,240
demo so

597
00:32:38,330 --> 00:32:50,360
where the hell are you man this is what

598
00:32:47,429 --> 00:32:50,360
I get for leaving discord up

599
00:32:56,240 --> 00:33:04,679
alright so alright hold this again now

600
00:33:03,090 --> 00:33:06,750
I'm going to show you a magic trick of

601
00:33:04,679 --> 00:33:09,120
uninstalling silence that requires an

602
00:33:06,750 --> 00:33:11,039
uninstalled token without the uninstall

603
00:33:09,120 --> 00:33:15,120
token because again desktop support did

604
00:33:11,039 --> 00:33:16,340
not give me the uninstall token quick

605
00:33:15,120 --> 00:33:18,719
everyone out there with this slack

606
00:33:16,340 --> 00:33:21,199
handle send them something right now for

607
00:33:18,720 --> 00:33:21,200
some entertainment

608
00:33:35,590 --> 00:33:42,639
[Laughter]

609
00:33:38,200 --> 00:33:42,639
thank you that made my day

610
00:34:00,080 --> 00:34:03,960
[Laughter]

611
00:34:13,589 --> 00:34:29,699
god I love you guys thank you wait how

612
00:34:27,129 --> 00:34:29,699
do we kill slash

613
00:34:47,159 --> 00:34:49,600
just to show you there's nothing on my

614
00:34:49,090 --> 00:35:09,850
sleeve

615
00:34:49,600 --> 00:35:23,049
I love you Matt welcome to Cosco I love

616
00:35:09,850 --> 00:35:25,150
you alright so we have the uninstall

617
00:35:23,050 --> 00:35:37,530
token it's not letting me uninstall it

618
00:35:25,150 --> 00:35:37,530
oh no no token what are you gonna do all

619
00:35:40,740 --> 00:35:45,160
right so you see all this gibberish here

620
00:35:43,000 --> 00:36:00,310
silent zero silence once I wants to this

621
00:35:45,160 --> 00:36:06,210
is actually your uninstall token aren't

622
00:36:00,310 --> 00:36:10,240
you guys glad you said now yep

623
00:36:06,210 --> 00:36:12,040
alright so current owner system we're

624
00:36:10,240 --> 00:36:14,879
still local admin so we can always

625
00:36:12,040 --> 00:36:14,880
change it to administrators

626
00:36:21,589 --> 00:36:41,390
entice with my mojo man all right

627
00:36:37,319 --> 00:36:41,390
so we're now we've now have full control

628
00:36:45,829 --> 00:36:58,430
all we need to do is null out these

629
00:36:49,230 --> 00:36:58,430
particular oh I didn't recurse it sorry

630
00:37:47,490 --> 00:38:16,100
and now we go back and there we go

631
00:38:23,750 --> 00:38:33,450
that's 2 DS so you may think that I'm

632
00:38:31,470 --> 00:38:36,500
picking on silence but silence isn't the

633
00:38:33,450 --> 00:38:39,299
only vendor that has these gaps

634
00:38:36,500 --> 00:38:43,460
CrowdStrike as well

635
00:38:39,300 --> 00:38:45,720
all right upgrade let me see your laptop

636
00:38:43,460 --> 00:38:47,300
all right so we're gonna do another live

637
00:38:45,720 --> 00:38:52,140
demo with CrowdStrike

638
00:38:47,300 --> 00:38:54,750
and in this one now keep in mind

639
00:38:52,140 --> 00:38:57,660
CrowdStrike does have a ppl process so

640
00:38:54,750 --> 00:38:58,950
you need to reboot in order to actually

641
00:38:57,660 --> 00:39:03,080
clear it out because even a system

642
00:38:58,950 --> 00:39:06,230
you're not able to stop the process

643
00:39:03,080 --> 00:39:06,230
thanks sunny

644
00:39:18,140 --> 00:39:29,750
listen you have an HDMI right giggity

645
00:39:50,359 --> 00:40:12,720
alright let me just make this clear this

646
00:39:52,920 --> 00:40:14,609
is not my laptop so hopefully by giving

647
00:40:12,720 --> 00:40:16,470
some of these discussions and raising

648
00:40:14,609 --> 00:40:19,558
these awarenesses we're hoping that

649
00:40:16,470 --> 00:40:20,640
these vendors are going to start doing a

650
00:40:19,559 --> 00:40:22,770
little more protection of their file

651
00:40:20,640 --> 00:40:26,490
systems and not just protecting their

652
00:40:22,770 --> 00:40:28,440
processes I mean the a/b is busy

653
00:40:26,490 --> 00:40:29,279
watching you every other process to make

654
00:40:28,440 --> 00:40:31,200
sure nothing bad is happening

655
00:40:29,280 --> 00:40:34,940
unfortunately it's not very busy

656
00:40:31,200 --> 00:40:37,890
watching itself or protecting itself so

657
00:40:34,940 --> 00:40:42,240
we want to see just a little bit more of

658
00:40:37,890 --> 00:40:44,520
that self protection when you think

659
00:40:42,240 --> 00:40:46,348
about AI and what's coming down the road

660
00:40:44,520 --> 00:40:48,569
it's gonna be harder and harder and

661
00:40:46,349 --> 00:40:50,040
harder to slip by with evasion attackers

662
00:40:48,569 --> 00:40:53,220
are you just gonna pivot to attacking

663
00:40:50,040 --> 00:40:57,599
the a/v itself so we think this is

664
00:40:53,220 --> 00:41:00,598
something so one thing that I want to

665
00:40:57,599 --> 00:41:01,950
point out here is as opposed to the

666
00:41:00,599 --> 00:41:04,079
other services that we looked at in the

667
00:41:01,950 --> 00:41:06,210
registry one of the things that we see

668
00:41:04,079 --> 00:41:09,869
now is this launched protective edge

669
00:41:06,210 --> 00:41:12,630
value this tells us what type of ppl Pro

670
00:41:09,869 --> 00:41:13,099
or protect a process to run as so number

671
00:41:12,630 --> 00:41:16,200
three

672
00:41:13,099 --> 00:41:21,030
ppl process this is the anti-malware

673
00:41:16,200 --> 00:41:22,379
on ppl process so now keep in mind I

674
00:41:21,030 --> 00:41:32,490
haven't I haven't taken ownership of

675
00:41:22,380 --> 00:41:38,069
anything yet so they don't even protect

676
00:41:32,490 --> 00:41:39,750
the registry key from admin and I I know

677
00:41:38,069 --> 00:41:41,369
this is probably an oversight and you

678
00:41:39,750 --> 00:41:43,410
know something that I'm sure that it is

679
00:41:41,369 --> 00:41:45,690
easy to fix within the kernel mode

680
00:41:43,410 --> 00:41:48,450
drivers and and that that's where this

681
00:41:45,690 --> 00:41:50,430
new - needs to be built-in - because

682
00:41:48,450 --> 00:41:53,520
then even a system you can't change it

683
00:41:50,430 --> 00:41:55,410
you can't mess with it and and again

684
00:41:53,520 --> 00:41:57,779
traditional AV

685
00:41:55,410 --> 00:41:59,700
I haven't I have an issue doing the same

686
00:41:57,779 --> 00:42:01,289
stuff to them so I know that it's

687
00:41:59,700 --> 00:42:03,569
possible I know that they can get better

688
00:42:01,289 --> 00:42:06,059
and I want them to get better because

689
00:42:03,569 --> 00:42:07,259
honestly I think the product as itself

690
00:42:06,059 --> 00:42:09,539
is awesome

691
00:42:07,259 --> 00:42:11,009
it really stops a lot of stuff that

692
00:42:09,539 --> 00:42:13,769
traditionally be the signature based a

693
00:42:11,009 --> 00:42:14,700
bee doesn't but we want them to get

694
00:42:13,769 --> 00:42:17,220
better we need them to get better

695
00:42:14,700 --> 00:42:19,319
because I don't know about you guys I am

696
00:42:17,220 --> 00:42:21,899
in the process of working myself out of

697
00:42:19,319 --> 00:42:24,480
a job I want them to be so good that I

698
00:42:21,900 --> 00:42:27,990
don't have a job anymore I can go and do

699
00:42:24,480 --> 00:42:31,529
construction flip burgers whatever but

700
00:42:27,990 --> 00:42:34,828
you know that that's that should be the

701
00:42:31,529 --> 00:42:36,869
eventual goal of this to have everything

702
00:42:34,829 --> 00:42:40,279
so good that we no longer have jobs we

703
00:42:36,869 --> 00:42:43,349
don't need to be InfoSec anymore

704
00:42:40,279 --> 00:42:45,930
so again currently running protective

705
00:42:43,349 --> 00:42:49,980
process light sorry I'm cutting in and

706
00:42:45,930 --> 00:42:52,259
out let's just make sure that the

707
00:42:49,980 --> 00:42:54,349
delicate service is running yep sure

708
00:42:52,259 --> 00:42:54,349
enough

709
00:43:08,730 --> 00:43:16,950
hey homie what's your password is that

710
00:43:14,289 --> 00:43:16,950
with one or two L's

711
00:43:37,720 --> 00:43:57,279
all right so as we're rebooting anybody

712
00:43:45,010 --> 00:44:11,950
have any questions so far no please

713
00:43:57,280 --> 00:44:13,840
don't call me yes I honestly don't know

714
00:44:11,950 --> 00:44:18,750
I haven't actually had access to a

715
00:44:13,840 --> 00:44:18,750
teepee in time here

716
00:44:20,550 --> 00:44:44,290
everybody knows your name

717
00:44:22,180 --> 00:44:53,080
you've been taxed alright alright so

718
00:44:44,290 --> 00:44:57,360
let's take a look and nope no more

719
00:44:53,080 --> 00:44:57,360
CrowdStrike service no Elkin service

720
00:44:58,900 --> 00:45:03,960
[Applause]

721
00:45:00,780 --> 00:45:03,960
thanks Tony

722
00:45:04,900 --> 00:45:07,200
yep

723
00:45:15,240 --> 00:45:20,470
all right so the question is what if you

724
00:45:18,460 --> 00:45:24,220
are on a production server and you can't

725
00:45:20,470 --> 00:45:25,509
reboot do you think the real bad guys

726
00:45:24,220 --> 00:45:28,109
are going to care if you can't reboot a

727
00:45:25,510 --> 00:45:28,109
production server

728
00:45:29,369 --> 00:45:34,960
well III I understand but I mean the

729
00:45:33,130 --> 00:45:38,410
whole idea here is to act like the real

730
00:45:34,960 --> 00:45:39,520
bad guys that's the only way they're

731
00:45:38,410 --> 00:45:41,710
gonna get better if you put if you put

732
00:45:39,520 --> 00:45:44,380
constraints on what you can on can't and

733
00:45:41,710 --> 00:45:46,359
what can and cannot do and I'm not

734
00:45:44,380 --> 00:45:48,130
saying to go and destroy data I'm not

735
00:45:46,359 --> 00:45:51,098
saying you know cost cost a company

736
00:45:48,130 --> 00:45:54,310
millions of dollars a minute for for

737
00:45:51,099 --> 00:45:57,070
downtime but you know hold all the

738
00:45:54,310 --> 00:45:59,740
vendors accountable I mean yes you yes

739
00:45:57,070 --> 00:46:02,290
I'm sure if you're on a test and you try

740
00:45:59,740 --> 00:46:03,970
this and you take down a server you're

741
00:46:02,290 --> 00:46:07,660
gonna you're you're gonna have some

742
00:46:03,970 --> 00:46:09,520
talking to but in a controlled

743
00:46:07,660 --> 00:46:11,500
environment proving that this can be

744
00:46:09,520 --> 00:46:13,329
done and not only proving that it can be

745
00:46:11,500 --> 00:46:17,920
done but proving that it can be

746
00:46:13,329 --> 00:46:23,520
prevented I think is I think is the more

747
00:46:17,920 --> 00:46:23,520
valuable takeaway here yes

748
00:46:36,570 --> 00:46:42,520
so you know any large corporation just

749
00:46:40,210 --> 00:46:44,260
imagine how many machines make it down

750
00:46:42,520 --> 00:46:46,150
at any given time and when they haven't

751
00:46:44,260 --> 00:46:47,080
checked in to be quite honest that's not

752
00:46:46,150 --> 00:46:50,230
unusual

753
00:46:47,080 --> 00:46:51,910
it doesn't look unusual you may you have

754
00:46:50,230 --> 00:46:53,440
a hundred thousand endpoints you might

755
00:46:51,910 --> 00:46:55,839
have ten thousand of them not checking

756
00:46:53,440 --> 00:46:57,610
in either because they're off or there's

757
00:46:55,840 --> 00:47:00,700
some sort of malfunction in the software

758
00:46:57,610 --> 00:47:02,740
so to be honest that reporting it's kind

759
00:47:00,700 --> 00:47:04,149
of noisy and really is a lot of false

760
00:47:02,740 --> 00:47:23,799
positives there you'll never see that in

761
00:47:04,150 --> 00:47:26,770
the noise any more questions yes well

762
00:47:23,800 --> 00:47:28,300
you may want to track 4670 events that's

763
00:47:26,770 --> 00:47:30,070
going to tell you when any object is

764
00:47:28,300 --> 00:47:32,350
taking control of or any Ackles are

765
00:47:30,070 --> 00:47:35,170
changed that's a good start of course if

766
00:47:32,350 --> 00:47:36,670
somebody kills the network as they're

767
00:47:35,170 --> 00:47:40,000
doing it you may not see it before it's

768
00:47:36,670 --> 00:47:41,980
all over but definitely that's a good

769
00:47:40,000 --> 00:47:44,230
start system on is also pretty good at

770
00:47:41,980 --> 00:47:46,690
seeing some of this stuff it's tracking

771
00:47:44,230 --> 00:47:48,550
it hopefully it gets out to your sim and

772
00:47:46,690 --> 00:48:10,060
you might see some of that as it's

773
00:47:48,550 --> 00:48:14,110
happening yes right right oh there's

774
00:48:10,060 --> 00:48:16,450
also many escalations and ways to get

775
00:48:14,110 --> 00:48:17,860
Edmond even when you're not local admin

776
00:48:16,450 --> 00:48:19,720
available there's zero days and all

777
00:48:17,860 --> 00:48:21,750
kinds of stuff they're out there all the

778
00:48:19,720 --> 00:48:21,750
time

