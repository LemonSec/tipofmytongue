1
00:00:00,000 --> 00:00:06,390
talking about Incident Response on Mac

2
00:00:01,680 --> 00:00:08,280
OS this is a pretty big topic it's very

3
00:00:06,390 --> 00:00:11,969
you know a very very deep topic and

4
00:00:08,280 --> 00:00:13,768
we've only got you know 4550 minutes so

5
00:00:11,969 --> 00:00:17,580
you know we're not going to be going

6
00:00:13,769 --> 00:00:20,520
really in-depth here but it we're gonna

7
00:00:17,580 --> 00:00:24,839
look at some very specific examples from

8
00:00:20,520 --> 00:00:28,590
actual malware as part of it so let's go

9
00:00:24,840 --> 00:00:31,140
ahead and dive in before we get started

10
00:00:28,590 --> 00:00:35,100
just a little bit about myself my name's

11
00:00:31,140 --> 00:00:37,910
Thomas Reed I work for malwarebytes I do

12
00:00:35,100 --> 00:00:43,079
a lot of threat research I've been doing

13
00:00:37,910 --> 00:00:45,929
I've been a Mac user since 1984 and I've

14
00:00:43,079 --> 00:00:51,059
been doing Mac threat research for over

15
00:00:45,930 --> 00:00:57,300
a decade now so I've seen a lot of

16
00:00:51,059 --> 00:00:59,129
things over the years you can feel free

17
00:00:57,300 --> 00:01:00,660
if you if you have any questions or

18
00:00:59,129 --> 00:01:02,489
anything after this if we don't have

19
00:01:00,660 --> 00:01:04,860
time for questions or if you don't have

20
00:01:02,489 --> 00:01:07,280
time to get yours answered feel free to

21
00:01:04,860 --> 00:01:10,229
hit me up on Twitter or email whatever

22
00:01:07,280 --> 00:01:14,159
and just so you know I there is a link

23
00:01:10,229 --> 00:01:15,390
to the slides on the last slide so you

24
00:01:14,159 --> 00:01:20,580
don't have to take pictures of

25
00:01:15,390 --> 00:01:24,080
everything so just a little intro here

26
00:01:20,580 --> 00:01:27,600
what we're talking about is not

27
00:01:24,080 --> 00:01:31,710
forensics so we're not talking about

28
00:01:27,600 --> 00:01:34,199
collecting data for the purpose of you

29
00:01:31,710 --> 00:01:37,649
know criminal investigations or any

30
00:01:34,200 --> 00:01:39,810
other kind of legal proceedings if you

31
00:01:37,650 --> 00:01:41,189
want to do that sort of thing you you

32
00:01:39,810 --> 00:01:44,070
really want to make sure that you have

33
00:01:41,189 --> 00:01:46,139
you know very good and complete data and

34
00:01:44,070 --> 00:01:48,148
that it can stand the test of time so

35
00:01:46,140 --> 00:01:50,640
you have to get everything you're gonna

36
00:01:48,149 --> 00:01:52,560
need because maybe it's gonna be a year

37
00:01:50,640 --> 00:01:56,130
from now when you finally actually need

38
00:01:52,560 --> 00:01:58,619
to use it and if you need that sort of

39
00:01:56,130 --> 00:02:00,929
thing I recommend using some kind of a

40
00:01:58,619 --> 00:02:03,420
professional company to do it there are

41
00:02:00,930 --> 00:02:04,829
a lot of good very good companies out

42
00:02:03,420 --> 00:02:09,628
there that will provide you the tools

43
00:02:04,829 --> 00:02:11,970
and the expertise that you need so what

44
00:02:09,628 --> 00:02:13,959
we're talking about is more on the side

45
00:02:11,970 --> 00:02:16,120
of you know IR so

46
00:02:13,959 --> 00:02:19,060
you have a machine you think it's

47
00:02:16,120 --> 00:02:21,519
infected you know maybe this machine is

48
00:02:19,060 --> 00:02:23,829
new to your environment maybe it's a

49
00:02:21,519 --> 00:02:25,989
friend's machine it doesn't have

50
00:02:23,829 --> 00:02:27,700
antivirus doesn't have any kind of

51
00:02:25,989 --> 00:02:29,290
monitoring software or anything like

52
00:02:27,700 --> 00:02:33,250
that you want to figure out what

53
00:02:29,290 --> 00:02:35,108
happened you know is it infected if so

54
00:02:33,250 --> 00:02:37,299
what did it do you know what did the

55
00:02:35,109 --> 00:02:39,639
Malheur do where is the malware

56
00:02:37,299 --> 00:02:41,170
installed is it you know exfiltrating

57
00:02:39,639 --> 00:02:43,180
data you know that sort of stuff

58
00:02:41,170 --> 00:02:46,208
so that's what you want to find out and

59
00:02:43,180 --> 00:02:48,849
this is a much more short-term goal and

60
00:02:46,209 --> 00:02:50,739
if you have physical access or remote

61
00:02:48,849 --> 00:02:53,168
access to the machine which you would

62
00:02:50,739 --> 00:02:55,989
need for this sort of thing then you can

63
00:02:53,169 --> 00:03:00,519
always collect more data later if you

64
00:02:55,989 --> 00:03:03,819
don't get everything so how do we

65
00:03:00,519 --> 00:03:06,609
collect IR data I've got a list here of

66
00:03:03,819 --> 00:03:08,858
some different scripts the first one

67
00:03:06,609 --> 00:03:12,700
they're picked that's one that I created

68
00:03:08,859 --> 00:03:14,469
recently put it up on github it's a

69
00:03:12,700 --> 00:03:16,599
bunch of Python scripts built to be

70
00:03:14,469 --> 00:03:18,400
extensible so you can write your own

71
00:03:16,599 --> 00:03:22,448
modules for it if you don't like what I

72
00:03:18,400 --> 00:03:24,760
did but you know there are a lot of

73
00:03:22,449 --> 00:03:27,010
other really really good tools and they

74
00:03:24,760 --> 00:03:27,698
all have different strengths and

75
00:03:27,010 --> 00:03:31,328
weaknesses

76
00:03:27,699 --> 00:03:33,879
so I encourage you to explore so these

77
00:03:31,329 --> 00:03:37,049
are some other good options here OS x

78
00:03:33,879 --> 00:03:40,659
collector and auto Mac tick

79
00:03:37,049 --> 00:03:43,989
however you say that and then those are

80
00:03:40,659 --> 00:03:46,328
more on the incident response side there

81
00:03:43,989 --> 00:03:49,659
are also a number of good proactive

82
00:03:46,329 --> 00:03:51,669
tools that can monitor and log and you

83
00:03:49,659 --> 00:03:53,470
know take that data and upload it into

84
00:03:51,669 --> 00:03:57,849
something like Splunk so that you can

85
00:03:53,470 --> 00:03:59,829
monitor for suspicious behaviors Ritchie

86
00:03:57,849 --> 00:04:03,548
Cyrus has got a really good one he

87
00:03:59,829 --> 00:04:05,829
released recently called Venator also OS

88
00:04:03,549 --> 00:04:08,889
query is really really good at this kind

89
00:04:05,829 --> 00:04:11,829
of stuff so you can actually avoid

90
00:04:08,889 --> 00:04:14,169
having to do some of this IR stuff if

91
00:04:11,829 --> 00:04:16,840
you have a proactive monitoring system

92
00:04:14,169 --> 00:04:20,590
in place but for the purpose of this

93
00:04:16,839 --> 00:04:22,150
talk we're assuming you don't so I'm

94
00:04:20,589 --> 00:04:24,159
going to kind of breeze through this

95
00:04:22,150 --> 00:04:27,190
quickly so we have time to look at the

96
00:04:24,159 --> 00:04:27,909
more fun stuff here so I'm going to just

97
00:04:27,190 --> 00:04:30,550
look

98
00:04:27,909 --> 00:04:31,930
some of the basics of my tool just so

99
00:04:30,550 --> 00:04:34,330
that you know what we're looking at

100
00:04:31,930 --> 00:04:36,189
we're gonna after we're done with this

101
00:04:34,330 --> 00:04:38,590
we're gonna look at four examples of

102
00:04:36,189 --> 00:04:41,279
actual malware and the data collected

103
00:04:38,590 --> 00:04:45,248
and how we can figure out what happened

104
00:04:41,279 --> 00:04:48,460
so you can see here there's a screenshot

105
00:04:45,249 --> 00:04:50,319
of some of the data that my tool

106
00:04:48,460 --> 00:04:53,919
collects it collects a whole bunch of

107
00:04:50,319 --> 00:04:57,599
aggregated data in some text files as

108
00:04:53,919 --> 00:05:00,520
well as a dump of some system logs and

109
00:04:57,599 --> 00:05:02,349
some artifacts from the system so it'll

110
00:05:00,520 --> 00:05:06,250
actually grab some of the files things

111
00:05:02,349 --> 00:05:09,128
like browser extensions your bash

112
00:05:06,250 --> 00:05:11,199
history you know that sort of thing and

113
00:05:09,129 --> 00:05:12,729
it collects it you know a whole bunch of

114
00:05:11,199 --> 00:05:17,620
this stuff that you can refer back to

115
00:05:12,729 --> 00:05:21,039
when you're doing ir so a few specifics

116
00:05:17,620 --> 00:05:23,680
here it's got a basic info file that

117
00:05:21,039 --> 00:05:25,210
collects just a lot of very basic

118
00:05:23,680 --> 00:05:29,529
information you know time and date that

119
00:05:25,210 --> 00:05:33,878
you ran the the collection list of users

120
00:05:29,529 --> 00:05:36,159
on the system logins you know what's you

121
00:05:33,879 --> 00:05:39,699
know which security measures are turned

122
00:05:36,159 --> 00:05:42,610
on or off you know things like is File

123
00:05:39,699 --> 00:05:45,039
Vault enabled is system integrity

124
00:05:42,610 --> 00:05:51,009
protection turned on or off that sort of

125
00:05:45,039 --> 00:05:53,849
thing there's also a file that where I

126
00:05:51,009 --> 00:05:57,729
enumerate all the files on the system

127
00:05:53,849 --> 00:05:59,860
with a limit it does not actually dive

128
00:05:57,729 --> 00:06:01,899
into any directories that are protected

129
00:05:59,860 --> 00:06:06,009
by system integrity protection because

130
00:06:01,899 --> 00:06:08,020
in theory those locations are immutable

131
00:06:06,009 --> 00:06:09,819
you know you should not be able to

132
00:06:08,020 --> 00:06:14,680
modify them unless there's some kind of

133
00:06:09,819 --> 00:06:16,360
a vulnerability or sip is turned off but

134
00:06:14,680 --> 00:06:20,199
the most important information in here

135
00:06:16,360 --> 00:06:22,810
is really just the paths and the various

136
00:06:20,199 --> 00:06:28,360
time stamps created modified and

137
00:06:22,810 --> 00:06:31,180
accessed there's also a lot of

138
00:06:28,360 --> 00:06:33,310
information about persistence this is

139
00:06:31,180 --> 00:06:36,430
really key information when you're

140
00:06:33,310 --> 00:06:39,490
trying to analyze a malware infection

141
00:06:36,430 --> 00:06:40,600
because almost all malware wants

142
00:06:39,490 --> 00:06:42,910
persistence there are

143
00:06:40,600 --> 00:06:45,550
some exceptions not all malware does

144
00:06:42,910 --> 00:06:48,130
like there has been ransomware in the

145
00:06:45,550 --> 00:06:50,380
past that did not stay persistent it

146
00:06:48,130 --> 00:06:52,360
just did you know it's encryption and

147
00:06:50,380 --> 00:06:56,500
then it was done doesn't care about

148
00:06:52,360 --> 00:06:58,360
persistence but 99 times out of 100 it

149
00:06:56,500 --> 00:07:00,970
wants persistence and when you look at

150
00:06:58,360 --> 00:07:05,320
all these different means of persistence

151
00:07:00,970 --> 00:07:07,960
you can catch a lot of things and some

152
00:07:05,320 --> 00:07:09,700
of these are fairly straightforward

153
00:07:07,960 --> 00:07:11,799
things that everybody's going to know to

154
00:07:09,700 --> 00:07:15,310
look for and others are kind of a little

155
00:07:11,800 --> 00:07:19,000
sneakier so things that we haven't

156
00:07:15,310 --> 00:07:21,160
actually seen malware doing but it

157
00:07:19,000 --> 00:07:25,900
always could happen like for example

158
00:07:21,160 --> 00:07:28,330
adding some malicious commands to to say

159
00:07:25,900 --> 00:07:31,409
your bash profile so that it gets run

160
00:07:28,330 --> 00:07:33,940
every time you launch the terminal

161
00:07:31,410 --> 00:07:38,200
nobody's done that yet but it could

162
00:07:33,940 --> 00:07:41,020
always happen we also want to look at

163
00:07:38,200 --> 00:07:43,479
browser history so the script will

164
00:07:41,020 --> 00:07:47,890
collect browser histories from Chrome

165
00:07:43,480 --> 00:07:50,950
and Firefox and of course Safari it will

166
00:07:47,890 --> 00:07:54,969
also collect a from a database called

167
00:07:50,950 --> 00:07:56,770
quarantine events this one is actually a

168
00:07:54,970 --> 00:07:58,840
database every time you download

169
00:07:56,770 --> 00:08:02,830
something that might have executable

170
00:07:58,840 --> 00:08:06,250
code a zip file an installer package a

171
00:08:02,830 --> 00:08:08,109
dmg file anything along those lines it's

172
00:08:06,250 --> 00:08:10,540
going to be quarantined and it's gonna

173
00:08:08,110 --> 00:08:13,120
go into this database and so you can

174
00:08:10,540 --> 00:08:15,040
figure out if something malicious got

175
00:08:13,120 --> 00:08:17,320
downloaded you might be able to find the

176
00:08:15,040 --> 00:08:22,180
direct link right to where it came from

177
00:08:17,320 --> 00:08:25,360
in this database install history is

178
00:08:22,180 --> 00:08:27,670
another good one you know a lot of real

179
00:08:25,360 --> 00:08:31,090
malware is not going to use an installer

180
00:08:27,670 --> 00:08:34,840
package but it's not unheard of it can

181
00:08:31,090 --> 00:08:37,990
happen and there's a lot of stuff like

182
00:08:34,840 --> 00:08:40,030
adware and pups that use install our

183
00:08:37,990 --> 00:08:43,000
packages extensively so you can track

184
00:08:40,030 --> 00:08:45,900
that kind of stuff using this the the

185
00:08:43,000 --> 00:08:45,900
install history

186
00:08:46,800 --> 00:08:52,170
process info is obviously going to be

187
00:08:49,529 --> 00:08:55,050
really important here there's a lot of

188
00:08:52,170 --> 00:08:59,430
information you can get just from the PS

189
00:08:55,050 --> 00:09:01,380
and L SOF commands in the terminal

190
00:08:59,430 --> 00:09:03,540
you know PS can give you some really key

191
00:09:01,380 --> 00:09:06,269
information not just process ID but

192
00:09:03,540 --> 00:09:09,389
parent process ID so you can use that to

193
00:09:06,269 --> 00:09:12,350
sort of build a chain of you know the

194
00:09:09,389 --> 00:09:15,690
process calls you know this malware

195
00:09:12,350 --> 00:09:18,870
process has called this other one which

196
00:09:15,690 --> 00:09:21,060
lets you connect some dots and then L

197
00:09:18,870 --> 00:09:24,209
sof lets you see things like what files

198
00:09:21,060 --> 00:09:26,459
have been accessed or are being accessed

199
00:09:24,209 --> 00:09:29,388
by the the malware what network

200
00:09:26,459 --> 00:09:31,560
connections are open or being attempted

201
00:09:29,389 --> 00:09:34,790
you know all kinds of good information

202
00:09:31,560 --> 00:09:37,800
like that this is really key information

203
00:09:34,790 --> 00:09:41,339
and interestingly I gave a talk about

204
00:09:37,800 --> 00:09:43,889
this earlier this year and just by pure

205
00:09:41,339 --> 00:09:47,279
happenstance this was right after the

206
00:09:43,889 --> 00:09:48,660
whole zoom thing hit the news and we

207
00:09:47,279 --> 00:09:52,380
were looking through some data and I was

208
00:09:48,660 --> 00:09:55,639
like oh look at this there's a zoom

209
00:09:52,380 --> 00:09:58,050
opener process listening on a port

210
00:09:55,639 --> 00:10:00,600
wonder what that is you know of course

211
00:09:58,050 --> 00:10:03,540
it's the that hidden little webserver

212
00:10:00,600 --> 00:10:09,180
that zooms so nicely installed on all

213
00:10:03,540 --> 00:10:10,769
Mac's there's also a file that will

214
00:10:09,180 --> 00:10:13,529
outline a whole bunch of suspicious

215
00:10:10,769 --> 00:10:16,500
behaviors things like you know processes

216
00:10:13,529 --> 00:10:21,000
running from the temp folder or from a

217
00:10:16,500 --> 00:10:24,300
hidden location or you know things like

218
00:10:21,000 --> 00:10:28,170
a launch agent or daemon plist that's

219
00:10:24,300 --> 00:10:31,430
named comm dot Apple that doesn't really

220
00:10:28,170 --> 00:10:35,069
belong to Apple that's a very common

221
00:10:31,430 --> 00:10:37,859
trick that malware authors use and you

222
00:10:35,069 --> 00:10:40,529
can see here zoom got flagged again in

223
00:10:37,860 --> 00:10:42,899
my collection here because this nice

224
00:10:40,529 --> 00:10:47,819
little web server was running out of a

225
00:10:42,899 --> 00:10:49,709
hidden location so zoom was a wonderful

226
00:10:47,819 --> 00:10:54,870
example when I was when I was given this

227
00:10:49,709 --> 00:10:56,609
class earlier this year so all that out

228
00:10:54,870 --> 00:10:59,790
of the way let's take a look at some

229
00:10:56,610 --> 00:11:01,380
very specific examples so what I did

230
00:10:59,790 --> 00:11:04,949
as I took four different pieces of

231
00:11:01,380 --> 00:11:08,550
recent relevant malware an interesting

232
00:11:04,949 --> 00:11:11,550
malware and I detonated them on a test

233
00:11:08,550 --> 00:11:14,069
system collected all the data so we

234
00:11:11,550 --> 00:11:16,649
could see exactly what it was doing and

235
00:11:14,070 --> 00:11:20,310
then what we'll talk about is how you

236
00:11:16,649 --> 00:11:24,089
trace exactly what happened and how how

237
00:11:20,310 --> 00:11:29,430
it happened so to start with we'll start

238
00:11:24,089 --> 00:11:32,339
out with wire net this is also known as

239
00:11:29,430 --> 00:11:34,170
net wire or net weird it's been around

240
00:11:32,339 --> 00:11:37,620
for a while

241
00:11:34,170 --> 00:11:38,790
but it was recently used in an attack

242
00:11:37,620 --> 00:11:40,110
against coinbase

243
00:11:38,790 --> 00:11:43,740
and some other cryptocurrencies

244
00:11:40,110 --> 00:11:46,230
companies through a Firefox zero-day

245
00:11:43,740 --> 00:11:49,320
than I'm sure you guys heard about this

246
00:11:46,230 --> 00:11:51,510
is the first time this kind of thing has

247
00:11:49,320 --> 00:11:53,310
happened on a Mac in awhile where we had

248
00:11:51,510 --> 00:11:56,850
a vulnerability drop something on the

249
00:11:53,310 --> 00:11:59,849
system through a zero-day so this is

250
00:11:56,850 --> 00:12:01,740
pretty interesting and prior to this net

251
00:11:59,850 --> 00:12:03,620
wire or wire net whatever you want to

252
00:12:01,740 --> 00:12:10,709
call it had not been seen since about

253
00:12:03,620 --> 00:12:14,190
2014 so on my system I infected with

254
00:12:10,709 --> 00:12:15,869
wire net the first place I typically

255
00:12:14,190 --> 00:12:18,660
will go to look is in you know

256
00:12:15,870 --> 00:12:20,250
suspicious behaviors because that's if

257
00:12:18,660 --> 00:12:22,410
there's something in there it's it's

258
00:12:20,250 --> 00:12:25,410
really interesting to look at sometimes

259
00:12:22,410 --> 00:12:29,310
it's not necessarily malicious like zoom

260
00:12:25,410 --> 00:12:32,610
stuff but very often you're gonna find

261
00:12:29,310 --> 00:12:35,160
malicious stuff in there so in this

262
00:12:32,610 --> 00:12:37,170
example we see that there is a

263
00:12:35,160 --> 00:12:40,500
suspicious process running out of a

264
00:12:37,170 --> 00:12:42,240
hidden folder named defaults that dot at

265
00:12:40,500 --> 00:12:46,560
the beginning on Mac OS means that

266
00:12:42,240 --> 00:12:48,540
folder is hidden from the user and we

267
00:12:46,560 --> 00:12:52,979
can see that that process is running

268
00:12:48,540 --> 00:12:57,180
with process ID of 529 we can also see

269
00:12:52,980 --> 00:12:59,730
there's a suspicious user launched agent

270
00:12:57,180 --> 00:13:03,569
we don't know why it's been flagged as

271
00:12:59,730 --> 00:13:05,699
as suspicious right now you know it the

272
00:13:03,569 --> 00:13:08,040
calm Mac thing does look a little

273
00:13:05,699 --> 00:13:13,380
suspicious but that's not necessarily

274
00:13:08,040 --> 00:13:13,560
bad so and we also don't know if these

275
00:13:13,380 --> 00:13:18,930
are

276
00:13:13,560 --> 00:13:21,900
related now fortunately the scripts also

277
00:13:18,930 --> 00:13:24,060
will collect all these launch agent and

278
00:13:21,900 --> 00:13:25,740
Damon P lists so you'll have those

279
00:13:24,060 --> 00:13:28,229
available you can go and refer to them

280
00:13:25,740 --> 00:13:30,240
so you just grab that file at comm Matt

281
00:13:28,230 --> 00:13:30,570
got host up P list and see what's in

282
00:13:30,240 --> 00:13:34,589
there

283
00:13:30,570 --> 00:13:36,480
and right away you can see why that was

284
00:13:34,589 --> 00:13:38,220
flagged as suspicious as well because

285
00:13:36,480 --> 00:13:40,589
it's running something from a hidden

286
00:13:38,220 --> 00:13:43,800
folder from that default dot defaults

287
00:13:40,589 --> 00:13:46,620
folder and you can see again here that

288
00:13:43,800 --> 00:13:51,359
it is responsible for that finder that

289
00:13:46,620 --> 00:13:55,260
hidden finder process which is obviously

290
00:13:51,360 --> 00:13:57,990
meant to mimic the the finder app for

291
00:13:55,260 --> 00:14:01,920
Mac OS but it isn't really because that

292
00:13:57,990 --> 00:14:04,320
doesn't run out of a user folder so we

293
00:14:01,920 --> 00:14:07,650
want to find out a little bit more a

294
00:14:04,320 --> 00:14:10,080
good place to go is the the file info

295
00:14:07,650 --> 00:14:11,930
all that you know enumeration of all the

296
00:14:10,080 --> 00:14:14,820
different files on the system and

297
00:14:11,930 --> 00:14:17,430
that'll give us information about when

298
00:14:14,820 --> 00:14:19,350
those files were created when they were

299
00:14:17,430 --> 00:14:24,420
dropped on the system and you can see

300
00:14:19,350 --> 00:14:27,839
that they were created at about 8:20

301
00:14:24,420 --> 00:14:32,280
6:00 p.m. so that's good information

302
00:14:27,839 --> 00:14:35,339
that's UTC not local time which is I try

303
00:14:32,280 --> 00:14:37,890
to get everything in UTC as much as

304
00:14:35,339 --> 00:14:40,680
possible because then you don't have to

305
00:14:37,890 --> 00:14:43,680
worry about where was this machine you

306
00:14:40,680 --> 00:14:45,510
know is it what time zone is it in you

307
00:14:43,680 --> 00:14:47,459
know how does this relate to the time

308
00:14:45,510 --> 00:14:49,980
zone or this other machine that may have

309
00:14:47,460 --> 00:14:54,300
been on the same you know may have been

310
00:14:49,980 --> 00:14:58,140
also affected so UTC is a good thing to

311
00:14:54,300 --> 00:15:00,089
have so now we can go and we can look a

312
00:14:58,140 --> 00:15:02,459
little more in-depth look at the the

313
00:15:00,089 --> 00:15:04,950
processes and we find something very

314
00:15:02,459 --> 00:15:07,079
interesting in the network activity we

315
00:15:04,950 --> 00:15:09,270
see that the finder process has a

316
00:15:07,080 --> 00:15:12,330
network connection open to some IP

317
00:15:09,270 --> 00:15:14,790
address and we could go and look that up

318
00:15:12,330 --> 00:15:18,230
if you went we'll look that up now you

319
00:15:14,790 --> 00:15:21,719
would find information about wire net

320
00:15:18,230 --> 00:15:24,060
but you might not actually find anything

321
00:15:21,720 --> 00:15:26,610
at the time if it's an unknown thread if

322
00:15:24,060 --> 00:15:28,589
it's something nobody's ever seen before

323
00:15:26,610 --> 00:15:34,079
but it does give you a nice piece of

324
00:15:28,589 --> 00:15:36,779
information so what else can we do well

325
00:15:34,079 --> 00:15:39,689
we've got the date and time that the

326
00:15:36,779 --> 00:15:41,639
files were created so it's probably a

327
00:15:39,690 --> 00:15:44,399
good idea to take a look at the logs and

328
00:15:41,639 --> 00:15:47,730
see what else interesting happened

329
00:15:44,399 --> 00:15:51,470
around that time so you can see here I

330
00:15:47,730 --> 00:15:56,310
used log Show which you know with these

331
00:15:51,470 --> 00:15:58,079
new unified logs on Mac OS they're kind

332
00:15:56,310 --> 00:16:00,869
of a pain in the butt they're not just

333
00:15:58,079 --> 00:16:03,989
plain text log files anymore like you

334
00:16:00,870 --> 00:16:07,649
would expect on UNIX they're binary logs

335
00:16:03,990 --> 00:16:10,829
a lot of the data is is not really

336
00:16:07,649 --> 00:16:13,019
readable so you have to use log the log

337
00:16:10,829 --> 00:16:17,519
command in the terminal to actually read

338
00:16:13,019 --> 00:16:20,610
this data and so what this command does

339
00:16:17,519 --> 00:16:25,170
is actually shows the you know output of

340
00:16:20,610 --> 00:16:28,649
the logs from a specific time frame so

341
00:16:25,170 --> 00:16:33,029
from what is this about five seconds

342
00:16:28,649 --> 00:16:34,740
bracketing that creation time and we can

343
00:16:33,029 --> 00:16:36,540
see something very interesting here we

344
00:16:34,740 --> 00:16:39,360
see that there was something called

345
00:16:36,540 --> 00:16:42,360
finder app that was running from the

346
00:16:39,360 --> 00:16:44,459
Downloads folder it was executed from

347
00:16:42,360 --> 00:16:49,319
the Downloads folder during that time

348
00:16:44,459 --> 00:16:51,119
period so that's most likely where the

349
00:16:49,319 --> 00:16:53,760
infection came from how it got on the

350
00:16:51,120 --> 00:16:56,250
system now I should say here that we

351
00:16:53,760 --> 00:17:00,360
don't know exactly where this Firefox

352
00:16:56,250 --> 00:17:03,569
zero-day dropped the files it probably

353
00:17:00,360 --> 00:17:05,189
was not in the Downloads folder but you

354
00:17:03,569 --> 00:17:10,349
would have been able to see wherever it

355
00:17:05,189 --> 00:17:12,650
was through the logs here so you'd be

356
00:17:10,349 --> 00:17:17,069
able to tell where it came from

357
00:17:12,650 --> 00:17:19,409
and so we can go and we can look at that

358
00:17:17,069 --> 00:17:21,658
download that finder dot app in the

359
00:17:19,409 --> 00:17:23,970
Downloads folder see when it was created

360
00:17:21,659 --> 00:17:27,659
which is you know it gives you more

361
00:17:23,970 --> 00:17:29,460
information about the timeline and this

362
00:17:27,659 --> 00:17:31,590
one's pretty simple so that's that's

363
00:17:29,460 --> 00:17:34,140
pretty much the timeline here you have

364
00:17:31,590 --> 00:17:38,870
that you know that the file was created

365
00:17:34,140 --> 00:17:41,710
on at 8:24 p.m.

366
00:17:38,870 --> 00:17:46,129
you know that a couple minutes later

367
00:17:41,710 --> 00:17:49,309
that it was launched and then this other

368
00:17:46,130 --> 00:17:52,610
this finder app in the the user folder

369
00:17:49,309 --> 00:17:54,980
was created in reality what this malware

370
00:17:52,610 --> 00:18:00,049
was doing was just copying or moving

371
00:17:54,980 --> 00:18:03,350
that finder app into that folder and the

372
00:18:00,049 --> 00:18:05,900
launch agent was created so that's when

373
00:18:03,350 --> 00:18:08,090
everything happened and then at the time

374
00:18:05,900 --> 00:18:10,400
when we collected our data we could see

375
00:18:08,090 --> 00:18:14,209
that there was a network connection that

376
00:18:10,400 --> 00:18:16,700
was actively open and if you wanted to

377
00:18:14,210 --> 00:18:19,070
if you were at the machine at this time

378
00:18:16,700 --> 00:18:20,929
and you see that then you could go in

379
00:18:19,070 --> 00:18:23,629
there and do some more you know digging

380
00:18:20,929 --> 00:18:25,940
maybe you know sniff the you know the

381
00:18:23,630 --> 00:18:29,419
packets do a network capture that sort

382
00:18:25,940 --> 00:18:31,130
of thing and get more information about

383
00:18:29,419 --> 00:18:34,659
what was going on there and what was

384
00:18:31,130 --> 00:18:37,970
going out over that network connection

385
00:18:34,659 --> 00:18:42,169
so next one we're gonna look at is one

386
00:18:37,970 --> 00:18:45,190
called mok's now this again is related

387
00:18:42,169 --> 00:18:47,779
to the firefox zero-day attack because

388
00:18:45,190 --> 00:18:49,789
the attackers didn't just drop one piece

389
00:18:47,779 --> 00:18:52,549
of malware on me the macs that they

390
00:18:49,789 --> 00:18:54,799
compromised they dropped two so the

391
00:18:52,549 --> 00:18:58,429
first of those was wire net the second

392
00:18:54,799 --> 00:19:01,399
one was mok's Mokes is another somewhat

393
00:18:58,429 --> 00:19:04,640
old one we hadn't seen that one in the

394
00:19:01,399 --> 00:19:08,090
wild since 2016 so it's not quite as old

395
00:19:04,640 --> 00:19:14,720
as wire net but it still it's still

396
00:19:08,090 --> 00:19:16,668
older in in terms of malware and so

397
00:19:14,720 --> 00:19:22,039
let's take a look this one's a little

398
00:19:16,669 --> 00:19:24,049
bit more interesting so idle I started

399
00:19:22,039 --> 00:19:26,059
out looking in the suspicious behaviors

400
00:19:24,049 --> 00:19:27,710
file and didn't really see anything

401
00:19:26,059 --> 00:19:31,490
there there wasn't anything of interest

402
00:19:27,710 --> 00:19:34,130
so my next place that I will always go

403
00:19:31,490 --> 00:19:36,350
to look his persistence and so if I look

404
00:19:34,130 --> 00:19:39,070
in the the persistence information I

405
00:19:36,350 --> 00:19:43,459
immediately notice that there's a launch

406
00:19:39,070 --> 00:19:46,279
agent named store account D dot P list

407
00:19:43,460 --> 00:19:49,309
this is a user launch agent it's in user

408
00:19:46,279 --> 00:19:51,169
land not a system launch agent which is

409
00:19:49,309 --> 00:19:52,549
suspicious because this looks like it's

410
00:19:51,169 --> 00:19:54,649
something to do with

411
00:19:52,549 --> 00:19:56,299
you know seems like maybe it's

412
00:19:54,649 --> 00:20:00,498
pretending it's something to do with the

413
00:19:56,299 --> 00:20:02,869
AppStore it also doesn't have the right

414
00:20:00,499 --> 00:20:06,320
name because a launch agent or Damon P

415
00:20:02,869 --> 00:20:10,309
list is gonna it should be named comm

416
00:20:06,320 --> 00:20:14,239
dot company name dot program name not P

417
00:20:10,309 --> 00:20:16,099
list or something along those lines not

418
00:20:14,239 --> 00:20:18,289
everybody follows that rule like they

419
00:20:16,099 --> 00:20:20,619
should so just because it doesn't

420
00:20:18,289 --> 00:20:22,999
doesn't immediately mean that it's bad

421
00:20:20,619 --> 00:20:27,439
but it's definitely something we want to

422
00:20:22,999 --> 00:20:29,599
look at so we're gonna go grab that file

423
00:20:27,440 --> 00:20:32,619
out of the artifacts folder and take a

424
00:20:29,599 --> 00:20:35,658
look and we noticed that it's running

425
00:20:32,619 --> 00:20:38,299
something called Store account D out of

426
00:20:35,659 --> 00:20:42,709
a folder in the user folder called App

427
00:20:38,299 --> 00:20:45,200
Store that's immediately you know

428
00:20:42,709 --> 00:20:47,419
there's nothing good about that it's

429
00:20:45,200 --> 00:20:49,489
pretending to be the App Store but the

430
00:20:47,419 --> 00:20:51,979
legit app store or processes would be

431
00:20:49,489 --> 00:20:55,609
running out of system directories not

432
00:20:51,979 --> 00:20:57,289
the user folder so we know you know at

433
00:20:55,609 --> 00:20:58,539
this point there's nothing good about

434
00:20:57,289 --> 00:21:01,158
that

435
00:20:58,539 --> 00:21:04,609
so let's dig a little deeper and look in

436
00:21:01,159 --> 00:21:07,729
the processes data and we can get the

437
00:21:04,609 --> 00:21:12,789
process ID which is 495 we see the

438
00:21:07,729 --> 00:21:15,889
parent process ID is 1 which is launch D

439
00:21:12,789 --> 00:21:18,320
that is the parent process for just

440
00:21:15,889 --> 00:21:20,928
about everything and certainly it's the

441
00:21:18,320 --> 00:21:24,439
parent process or something loaded via a

442
00:21:20,929 --> 00:21:27,169
launch agent so makes a lot of sense

443
00:21:24,440 --> 00:21:29,690
that that's totally logical we can also

444
00:21:27,169 --> 00:21:34,339
see that it was launched at 5:34 p.m.

445
00:21:29,690 --> 00:21:35,839
local time local times a little bit of a

446
00:21:34,339 --> 00:21:39,678
problem because we want everything in

447
00:21:35,839 --> 00:21:41,989
UTC right so and maybe we don't know

448
00:21:39,679 --> 00:21:46,429
what time zone this machine was in so

449
00:21:41,989 --> 00:21:50,059
what do we do here fortunately that

450
00:21:46,429 --> 00:21:52,700
basic info file we mentioned earlier the

451
00:21:50,059 --> 00:21:55,969
very first line in there tells you when

452
00:21:52,700 --> 00:21:59,119
the collection was done and it gives a

453
00:21:55,969 --> 00:22:02,299
date and a time both in local time and

454
00:21:59,119 --> 00:22:04,309
in UTC so that's your map you can use

455
00:22:02,299 --> 00:22:06,379
that to map whatever you know any of

456
00:22:04,309 --> 00:22:09,710
these local time values that you might

457
00:22:06,380 --> 00:22:15,669
get into UTC so we can see that this

458
00:22:09,710 --> 00:22:18,470
actually happened at what's 734 p.m. UTC

459
00:22:15,669 --> 00:22:22,640
so that will that will help us match up

460
00:22:18,470 --> 00:22:24,710
with the other UTC times will have so

461
00:22:22,640 --> 00:22:28,160
now we can go back and look in file info

462
00:22:24,710 --> 00:22:31,190
and we can see when these files were

463
00:22:28,160 --> 00:22:34,490
created you can see that they were

464
00:22:31,190 --> 00:22:41,720
created and you know same time as you

465
00:22:34,490 --> 00:22:44,690
know 734 p.m. UTC so we can also look

466
00:22:41,720 --> 00:22:47,840
for network activity here and we see

467
00:22:44,690 --> 00:22:51,919
that at the time we did the data capture

468
00:22:47,840 --> 00:22:54,500
that there was a connection that was

469
00:22:51,919 --> 00:22:56,210
being it had been attempted to an IP

470
00:22:54,500 --> 00:22:59,510
address but there had not been a

471
00:22:56,210 --> 00:23:03,260
response yet so we know that it's trying

472
00:22:59,510 --> 00:23:05,629
to contact some server but it hasn't

473
00:23:03,260 --> 00:23:07,900
heard back yet possibly because that

474
00:23:05,630 --> 00:23:11,150
server has been taken offline already

475
00:23:07,900 --> 00:23:13,539
which would make sense since this was

476
00:23:11,150 --> 00:23:15,860
existing malware that had already been

477
00:23:13,539 --> 00:23:21,950
detected and was known about in the wild

478
00:23:15,860 --> 00:23:24,979
so we can also look at what's going on

479
00:23:21,950 --> 00:23:28,820
with the file activity and we see in

480
00:23:24,980 --> 00:23:33,700
this case that there is a zero byte file

481
00:23:28,820 --> 00:23:37,210
with a a long cryptic name that's open

482
00:23:33,700 --> 00:23:39,590
we don't really know why at this point

483
00:23:37,210 --> 00:23:41,330
you know we might suspect that this is

484
00:23:39,590 --> 00:23:43,850
some kind of a marker file

485
00:23:41,330 --> 00:23:45,918
maybe that name has some encoded

486
00:23:43,850 --> 00:23:50,600
information in it somehow we don't know

487
00:23:45,919 --> 00:23:53,950
what that might be but we'd start having

488
00:23:50,600 --> 00:23:59,090
some suspicions about that at this point

489
00:23:53,950 --> 00:24:01,549
now in reality we know because we know

490
00:23:59,090 --> 00:24:04,280
about Mokes we know that what that file

491
00:24:01,549 --> 00:24:06,830
actually is is it is a marker and it

492
00:24:04,280 --> 00:24:09,110
indicates which variant of Mokes

493
00:24:06,830 --> 00:24:11,120
is installed on the system there are a

494
00:24:09,110 --> 00:24:14,750
whole bunch of different name variants

495
00:24:11,120 --> 00:24:17,149
so store account D in an app store

496
00:24:14,750 --> 00:24:19,630
folder is one of them they're all it

497
00:24:17,150 --> 00:24:21,850
also has other processes

498
00:24:19,630 --> 00:24:23,950
with other names you know things that

499
00:24:21,850 --> 00:24:26,290
try to make the user think that it's

500
00:24:23,950 --> 00:24:29,490
related to the dock or that it's related

501
00:24:26,290 --> 00:24:34,690
to you know other legitimate Mac OS

502
00:24:29,490 --> 00:24:36,460
processes and that string whatever data

503
00:24:34,690 --> 00:24:39,430
is encoded there it tells it which

504
00:24:36,460 --> 00:24:42,070
variant that is what we wouldn't know

505
00:24:39,430 --> 00:24:45,730
that at this point so it's just a neat

506
00:24:42,070 --> 00:24:49,210
thing to know about so we can go and we

507
00:24:45,730 --> 00:24:52,120
can see when that file was created if

508
00:24:49,210 --> 00:24:53,860
this were something else like if this

509
00:24:52,120 --> 00:24:55,659
were some file that maybe was being

510
00:24:53,860 --> 00:24:57,639
filled up with data we could you know

511
00:24:55,660 --> 00:24:59,050
this would be really useful information

512
00:24:57,640 --> 00:25:01,690
we could see when it started collecting

513
00:24:59,050 --> 00:25:05,290
data we could see when it had been

514
00:25:01,690 --> 00:25:07,090
accessed that sort of thing so we we

515
00:25:05,290 --> 00:25:11,230
could get a little bit more clear

516
00:25:07,090 --> 00:25:16,600
picture of exactly what time frame that

517
00:25:11,230 --> 00:25:19,570
file had been active for we also like we

518
00:25:16,600 --> 00:25:21,730
did with with wire net we want to go and

519
00:25:19,570 --> 00:25:23,950
look in the logs and see what else might

520
00:25:21,730 --> 00:25:27,220
have happened around the time that these

521
00:25:23,950 --> 00:25:32,080
files were being created so we search

522
00:25:27,220 --> 00:25:34,810
for a within a what is that a 10-second

523
00:25:32,080 --> 00:25:39,370
window this time and we see that there

524
00:25:34,810 --> 00:25:41,470
was something called Mac some executable

525
00:25:39,370 --> 00:25:46,479
called Mac that was run from the user

526
00:25:41,470 --> 00:25:50,110
folder which that's suspicious yeah it's

527
00:25:46,480 --> 00:25:53,440
you would not expect to see that and we

528
00:25:50,110 --> 00:25:56,129
can see what time that happened we can

529
00:25:53,440 --> 00:25:59,680
see what process ID it was launched with

530
00:25:56,130 --> 00:26:03,070
so let's get more information about that

531
00:25:59,680 --> 00:26:04,930
we can go and we can find out that that

532
00:26:03,070 --> 00:26:07,030
file was actually it's still on the

533
00:26:04,930 --> 00:26:11,260
system at the time that we did our

534
00:26:07,030 --> 00:26:15,760
capture and that it was created at 7:32

535
00:26:11,260 --> 00:26:18,580
p.m. that's probably where the malware

536
00:26:15,760 --> 00:26:20,320
came from now again we don't know where

537
00:26:18,580 --> 00:26:22,480
this file would have been dumped by the

538
00:26:20,320 --> 00:26:23,800
Firefox zero-day we just know it was

539
00:26:22,480 --> 00:26:27,880
dumped on the system somewhere and

540
00:26:23,800 --> 00:26:30,178
executed user folder which might be a

541
00:26:27,880 --> 00:26:33,389
reasonable location and all

542
00:26:30,179 --> 00:26:35,070
temp folder might also you know but for

543
00:26:33,389 --> 00:26:36,928
the purpose of this demo it doesn't

544
00:26:35,070 --> 00:26:41,460
really matter we'd be able to tell where

545
00:26:36,929 --> 00:26:44,159
that file was and so we can reconstruct

546
00:26:41,460 --> 00:26:46,409
the timeline here we see that the file

547
00:26:44,159 --> 00:26:48,659
the initial dropper was created on the

548
00:26:46,409 --> 00:26:53,460
system we can see what time it was

549
00:26:48,659 --> 00:26:56,100
launched just you know a little more

550
00:26:53,460 --> 00:26:57,179
than a minute later in the real world

551
00:26:56,100 --> 00:26:59,459
that probably wouldn't have been a

552
00:26:57,179 --> 00:27:02,070
minute you know that that minute was how

553
00:26:59,460 --> 00:27:06,029
long it took me to between copying the

554
00:27:02,070 --> 00:27:08,428
file in place to launching it so and

555
00:27:06,029 --> 00:27:11,179
then just seconds later we see that it

556
00:27:08,429 --> 00:27:15,779
had created store account D and the the

557
00:27:11,179 --> 00:27:17,639
launch agent plist file we see a look

558
00:27:15,779 --> 00:27:19,619
just shortly after that that the marker

559
00:27:17,639 --> 00:27:21,809
file was created and you know again if

560
00:27:19,619 --> 00:27:24,720
that were some exfiltration data file

561
00:27:21,809 --> 00:27:27,090
that was being created we could see when

562
00:27:24,720 --> 00:27:30,360
it was created when it was continuing to

563
00:27:27,090 --> 00:27:33,389
be accessed and get sort of a window of

564
00:27:30,360 --> 00:27:35,668
time and then at the time we did our

565
00:27:33,389 --> 00:27:37,469
data collection we can see there was

566
00:27:35,669 --> 00:27:42,539
that network connection that was still

567
00:27:37,470 --> 00:27:45,029
waiting a response all right so the next

568
00:27:42,539 --> 00:27:47,759
one is unrelated to the the firefox

569
00:27:45,029 --> 00:27:50,999
zero-day now so it's one called bird

570
00:27:47,759 --> 00:27:52,499
miner I think you probably know right

571
00:27:50,999 --> 00:27:55,769
away just from the name it's a

572
00:27:52,499 --> 00:27:57,600
cryptocurrency miner so I am spoiling a

573
00:27:55,769 --> 00:28:00,570
little bit of the details for you here

574
00:27:57,600 --> 00:28:03,600
but I could I couldn't have hidden it

575
00:28:00,570 --> 00:28:07,490
without hiding like all detail above

576
00:28:03,600 --> 00:28:11,009
even the name so this was actually

577
00:28:07,490 --> 00:28:13,529
distributed through a whole bunch of

578
00:28:11,009 --> 00:28:16,200
pirated audio software that was being

579
00:28:13,529 --> 00:28:19,049
distributed through a crack site so

580
00:28:16,200 --> 00:28:23,190
people would go there they download you

581
00:28:19,049 --> 00:28:25,590
know some pirated audio app and they

582
00:28:23,190 --> 00:28:27,809
install it on their system they actually

583
00:28:25,590 --> 00:28:30,720
get the app so they get the you know

584
00:28:27,809 --> 00:28:32,999
they get their free cracked audio app

585
00:28:30,720 --> 00:28:38,170
but they get a little extra something in

586
00:28:32,999 --> 00:28:40,330
in addition yeah well yeah

587
00:28:38,170 --> 00:28:43,179
this was he said note and there's no

588
00:28:40,330 --> 00:28:48,939
such thing as a free meal but the guy

589
00:28:43,179 --> 00:28:52,179
they did get something for free now this

590
00:28:48,940 --> 00:28:54,460
also uses a very interesting obfuscation

591
00:28:52,179 --> 00:29:00,730
technique that we're gonna we're gonna

592
00:28:54,460 --> 00:29:02,650
figure out here so once again we start

593
00:29:00,730 --> 00:29:04,870
with suspicious processes and we see

594
00:29:02,650 --> 00:29:08,860
nothing so we go to our fallback which

595
00:29:04,870 --> 00:29:12,189
is persistence and right away the any of

596
00:29:08,860 --> 00:29:14,139
these three weird launched daemons hit

597
00:29:12,190 --> 00:29:16,600
you in the face practically I mean you

598
00:29:14,140 --> 00:29:20,620
don't see words like this typically on a

599
00:29:16,600 --> 00:29:24,790
Mac OS system comm dot heater owner ax

600
00:29:20,620 --> 00:29:26,159
dot P list one called Mukden and one

601
00:29:24,790 --> 00:29:29,590
called tang

602
00:29:26,160 --> 00:29:33,130
those don't look legit at all so of

603
00:29:29,590 --> 00:29:35,590
course we're gonna dig into those and we

604
00:29:33,130 --> 00:29:39,790
we look at those and we see that the

605
00:29:35,590 --> 00:29:42,490
first to launch processes out of sort of

606
00:29:39,790 --> 00:29:46,809
randomly named folders so one of them

607
00:29:42,490 --> 00:29:50,799
launches a process called a HT from a

608
00:29:46,809 --> 00:29:54,340
folder named per P er another one

609
00:29:50,799 --> 00:29:57,400
launches something called full gora out

610
00:29:54,340 --> 00:30:00,939
of a folder named Q so not at all

611
00:29:57,400 --> 00:30:02,500
suspicious right and then the third one

612
00:30:00,940 --> 00:30:07,260
actually launches something that was

613
00:30:02,500 --> 00:30:10,150
placed in user local been called a GN so

614
00:30:07,260 --> 00:30:12,280
lots more things to look at here we're

615
00:30:10,150 --> 00:30:15,040
getting a lot of data lots of things to

616
00:30:12,280 --> 00:30:17,379
find out about so if we look in

617
00:30:15,040 --> 00:30:21,100
processes we can track a bunch of this

618
00:30:17,380 --> 00:30:23,169
stuff down we can see process IDs for

619
00:30:21,100 --> 00:30:26,678
all three of those things and we can see

620
00:30:23,169 --> 00:30:30,669
that they were all run by bash so

621
00:30:26,679 --> 00:30:34,330
whatever they are you know that they it

622
00:30:30,669 --> 00:30:37,720
looks like they're bash scripts we can

623
00:30:34,330 --> 00:30:39,668
also see what time they were launched in

624
00:30:37,720 --> 00:30:43,840
local time and of course we can go back

625
00:30:39,669 --> 00:30:47,309
to basic info and map that to UTC so we

626
00:30:43,840 --> 00:30:50,439
know that this was 11:30 6:00 a.m. UTC

627
00:30:47,309 --> 00:30:51,700
and we can see that a GN was actually

628
00:30:50,440 --> 00:30:54,100
launched just a few minutes

629
00:30:51,700 --> 00:30:59,769
later for some reason we don't know why

630
00:30:54,100 --> 00:31:02,260
yet we can also if we keep digging

631
00:30:59,769 --> 00:31:04,360
around in processes so we can't what we

632
00:31:02,260 --> 00:31:06,760
can do is we can take those process IDs

633
00:31:04,360 --> 00:31:10,059
we got for those three processes and

634
00:31:06,760 --> 00:31:13,330
search for those and we can find a look

635
00:31:10,059 --> 00:31:14,580
these are all parent processes of

636
00:31:13,330 --> 00:31:18,789
something else

637
00:31:14,580 --> 00:31:21,340
so a HT is a parent process of something

638
00:31:18,789 --> 00:31:25,269
called per PE our name just like the

639
00:31:21,340 --> 00:31:27,610
folder that that we saw full gora is a

640
00:31:25,269 --> 00:31:30,909
parent process of something called queue

641
00:31:27,610 --> 00:31:36,120
again just like that folder and a Jian

642
00:31:30,909 --> 00:31:40,029
is a parent process of sleep so

643
00:31:36,120 --> 00:31:43,090
something must be you know recurring

644
00:31:40,029 --> 00:31:44,919
here and it's it's you know something

645
00:31:43,090 --> 00:31:48,549
happens and then it sleeps and then

646
00:31:44,919 --> 00:31:50,830
happens again and then sleeps if you

647
00:31:48,549 --> 00:31:54,100
look at the launch agent or the lunch

648
00:31:50,830 --> 00:31:56,970
daemon files you'll find that what's

649
00:31:54,100 --> 00:32:01,149
actually happening here for a Jian is

650
00:31:56,970 --> 00:32:05,320
the lunch daemon will launch it and then

651
00:32:01,149 --> 00:32:08,080
exit after it sleeps but because the

652
00:32:05,320 --> 00:32:09,490
launch daemon has a keepalive property

653
00:32:08,080 --> 00:32:13,000
it means that as soon as the process

654
00:32:09,490 --> 00:32:16,299
exits it's gonna relaunch so basically

655
00:32:13,000 --> 00:32:20,679
it just it launches does its thing and

656
00:32:16,299 --> 00:32:23,590
then sleeps and then exits and then goes

657
00:32:20,679 --> 00:32:26,409
back around again it launches so this is

658
00:32:23,590 --> 00:32:35,230
kind of a way of running this process on

659
00:32:26,409 --> 00:32:39,730
a periodic basis so if we look at her

660
00:32:35,230 --> 00:32:41,830
and Q both of those processes seem to be

661
00:32:39,730 --> 00:32:45,190
using a significant amount of processor

662
00:32:41,830 --> 00:32:47,139
time so in this case this was just a

663
00:32:45,190 --> 00:32:49,840
demo so it's not like they were sitting

664
00:32:47,139 --> 00:32:53,110
there for weeks in this case they were

665
00:32:49,840 --> 00:32:56,350
sitting there for seven minutes before I

666
00:32:53,110 --> 00:32:58,330
did the data collection and in that

667
00:32:56,350 --> 00:33:02,769
seven minutes they each were using about

668
00:32:58,330 --> 00:33:05,540
five minutes and almost twenty seconds

669
00:33:02,769 --> 00:33:08,040
worth of processor time

670
00:33:05,540 --> 00:33:10,649
in a seven-minute time period that's

671
00:33:08,040 --> 00:33:13,040
probably not that significant it could

672
00:33:10,650 --> 00:33:15,660
have been doing something you know like

673
00:33:13,040 --> 00:33:18,300
initializing something we don't know but

674
00:33:15,660 --> 00:33:20,760
if you observe this over time that would

675
00:33:18,300 --> 00:33:22,770
continue that processor time would keep

676
00:33:20,760 --> 00:33:24,690
going up and that would be an indication

677
00:33:22,770 --> 00:33:27,540
that this is probably a crypto minor

678
00:33:24,690 --> 00:33:30,600
right so we're starting to get this idea

679
00:33:27,540 --> 00:33:37,550
that maybe maybe this is mining some

680
00:33:30,600 --> 00:33:41,790
kind of cryptocurrency we can also see

681
00:33:37,550 --> 00:33:44,639
from process the processed data it

682
00:33:41,790 --> 00:33:47,850
actually gives us all the arguments that

683
00:33:44,640 --> 00:33:49,950
these these two processes were launched

684
00:33:47,850 --> 00:33:52,070
with and there's something very

685
00:33:49,950 --> 00:33:56,190
interesting there it's got all these

686
00:33:52,070 --> 00:34:00,540
command-line arguments here and these

687
00:33:56,190 --> 00:34:02,100
look kind of interesting so first thing

688
00:34:00,540 --> 00:34:04,110
you'd probably want to do is take this

689
00:34:02,100 --> 00:34:07,110
information and go look it up on Google

690
00:34:04,110 --> 00:34:09,870
right or some search engine and if you

691
00:34:07,110 --> 00:34:12,418
do that if you take Excel equals h VF

692
00:34:09,870 --> 00:34:14,009
and search for that on Google the first

693
00:34:12,418 --> 00:34:17,339
five hits you're gonna get or for

694
00:34:14,010 --> 00:34:22,669
something called Q mu and it turns out

695
00:34:17,340 --> 00:34:26,880
that's a Linux virtual machine so

696
00:34:22,668 --> 00:34:29,399
something here is running Q mu and it's

697
00:34:26,880 --> 00:34:34,740
a it's running a Linux system in

698
00:34:29,399 --> 00:34:38,159
emulation which is very interesting and

699
00:34:34,739 --> 00:34:41,219
that means that these files sterk her

700
00:34:38,159 --> 00:34:46,940
arias and can qi that are being passed

701
00:34:41,219 --> 00:34:50,549
as parameters those are probably VMs and

702
00:34:46,940 --> 00:34:52,200
if you actually go and look in the in

703
00:34:50,550 --> 00:34:58,140
the file info you'll see they're fairly

704
00:34:52,199 --> 00:35:00,750
large files now at this point we we're

705
00:34:58,140 --> 00:35:04,020
pretty sure they probably are crypto

706
00:35:00,750 --> 00:35:07,410
miners but we don't have 100% certain

707
00:35:04,020 --> 00:35:09,990
evidence but if you can get access to

708
00:35:07,410 --> 00:35:11,430
that system if you still have the access

709
00:35:09,990 --> 00:35:13,950
and can still go back and collect

710
00:35:11,430 --> 00:35:17,069
additional files you can grab those

711
00:35:13,950 --> 00:35:17,770
files you can launch them in your own

712
00:35:17,070 --> 00:35:22,210
instance

713
00:35:17,770 --> 00:35:24,700
of QE mu and take a look inside and if

714
00:35:22,210 --> 00:35:27,100
you do that you'll find that the boot

715
00:35:24,700 --> 00:35:30,460
local dot sh file in that will those two

716
00:35:27,100 --> 00:35:32,529
Linux systems has this code in it and

717
00:35:30,460 --> 00:35:35,910
you'll see the very last line there says

718
00:35:32,530 --> 00:35:40,090
XM rig which is a popular open-source

719
00:35:35,910 --> 00:35:47,620
crypto minor so there's our smoking gun

720
00:35:40,090 --> 00:35:50,950
this is definitely a crypto minor now we

721
00:35:47,620 --> 00:35:55,480
can also find out where this is trying

722
00:35:50,950 --> 00:35:59,919
to communicate to so we can look at the

723
00:35:55,480 --> 00:36:02,620
network info from LSO F and we see per

724
00:35:59,920 --> 00:36:06,550
and Q both have connections open to a

725
00:36:02,620 --> 00:36:10,839
sub domain of in jlla however you say

726
00:36:06,550 --> 00:36:12,940
that net which is some hosting service

727
00:36:10,840 --> 00:36:17,020
I'm not sure if it's a legit hosting

728
00:36:12,940 --> 00:36:20,620
service that was being abused or if it

729
00:36:17,020 --> 00:36:24,070
was you know totally malicious from the

730
00:36:20,620 --> 00:36:26,259
start but we can see the domain name and

731
00:36:24,070 --> 00:36:28,930
we can see the IP address the IP address

732
00:36:26,260 --> 00:36:31,180
is actually listed there but if you

733
00:36:28,930 --> 00:36:33,669
don't trust that the IP address in that

734
00:36:31,180 --> 00:36:36,279
domain you can just do a you know a

735
00:36:33,670 --> 00:36:42,910
lookup and find that's actually the

736
00:36:36,280 --> 00:36:45,130
correct IP address and then you can see

737
00:36:42,910 --> 00:36:47,710
you can look into the file info and see

738
00:36:45,130 --> 00:36:50,620
when all these files were created and we

739
00:36:47,710 --> 00:36:58,450
can see that the HT and fulgor files

740
00:36:50,620 --> 00:37:01,390
were created on at 11:36 a.m. we don't

741
00:36:58,450 --> 00:37:04,689
have any data on when that ægean file

742
00:37:01,390 --> 00:37:06,250
was created unfortunately so if you

743
00:37:04,690 --> 00:37:09,550
remember earlier I told you that this

744
00:37:06,250 --> 00:37:13,230
file and my script actually skips any

745
00:37:09,550 --> 00:37:17,130
directories that are protected by sip

746
00:37:13,230 --> 00:37:19,060
user is protected by sip and

747
00:37:17,130 --> 00:37:20,860
unfortunately that means the whole

748
00:37:19,060 --> 00:37:22,690
directory gets skipped even though there

749
00:37:20,860 --> 00:37:24,310
are some directories under it that are

750
00:37:22,690 --> 00:37:28,030
not protected by sip

751
00:37:24,310 --> 00:37:29,730
so not the end of the world especially

752
00:37:28,030 --> 00:37:31,830
if you have ax

753
00:37:29,730 --> 00:37:35,580
the system and could go back and grab

754
00:37:31,830 --> 00:37:36,990
the data that you missed but you know

755
00:37:35,580 --> 00:37:38,549
maybe it's something that needs to be

756
00:37:36,990 --> 00:37:42,779
looked into at some point in the future

757
00:37:38,550 --> 00:37:45,869
for an improvement to the script we can

758
00:37:42,780 --> 00:37:48,960
also see when the the VM files ster

759
00:37:45,869 --> 00:37:54,300
curious and kaanchi were created they

760
00:37:48,960 --> 00:37:57,510
were created at 11:38 a.m. and finally

761
00:37:54,300 --> 00:37:59,100
we can look at the installs file and and

762
00:37:57,510 --> 00:38:01,530
that's got some interesting information

763
00:37:59,100 --> 00:38:05,250
it looks like something called Valhalla

764
00:38:01,530 --> 00:38:07,940
vintage verb was installed that's an

765
00:38:05,250 --> 00:38:11,010
interesting name but it is actually

766
00:38:07,940 --> 00:38:14,550
apparently a legitimate audio program

767
00:38:11,010 --> 00:38:18,060
that had been cracked by somebody and

768
00:38:14,550 --> 00:38:19,590
put up on this piracy site so this was

769
00:38:18,060 --> 00:38:22,080
installed and we can see that it was

770
00:38:19,590 --> 00:38:27,080
installed at 11:36 a.m. and a little bit

771
00:38:22,080 --> 00:38:29,759
before all this bad stuff was happening

772
00:38:27,080 --> 00:38:31,529
now we probably want to look and find

773
00:38:29,760 --> 00:38:33,990
out where this came from

774
00:38:31,530 --> 00:38:35,640
so we can look at the history the

775
00:38:33,990 --> 00:38:40,470
browser history files and we see in

776
00:38:35,640 --> 00:38:45,118
Safari that this site called VST

777
00:38:40,470 --> 00:38:49,319
cracked.com was visited 1131 just a few

778
00:38:45,119 --> 00:38:52,290
minutes before Valhalla vintage verb was

779
00:38:49,320 --> 00:38:55,380
installed so that's probably where this

780
00:38:52,290 --> 00:38:57,900
came from we don't know whether there's

781
00:38:55,380 --> 00:39:02,700
no smoking gun yet but it's it's a

782
00:38:57,900 --> 00:39:06,240
pretty good bet so what I'd really want

783
00:39:02,700 --> 00:39:08,700
to do is look in the downloads info the

784
00:39:06,240 --> 00:39:10,649
the information from that quarantine

785
00:39:08,700 --> 00:39:14,879
events database because that could tell

786
00:39:10,650 --> 00:39:16,590
me the exact URL that that dot pkg

787
00:39:14,880 --> 00:39:18,840
installer file was downloaded from

788
00:39:16,590 --> 00:39:22,890
because that should be in the quarantine

789
00:39:18,840 --> 00:39:25,140
events database unfortunately it's not

790
00:39:22,890 --> 00:39:29,368
in there the last entry is in there is

791
00:39:25,140 --> 00:39:32,759
for Firefox and it's that that's

792
00:39:29,369 --> 00:39:34,410
definitely not it so unfortunately the

793
00:39:32,760 --> 00:39:36,450
problem with this quarantine events

794
00:39:34,410 --> 00:39:40,649
database is that it is extremely

795
00:39:36,450 --> 00:39:42,480
unreliable for Safari for I don't know

796
00:39:40,650 --> 00:39:45,000
what reasons

797
00:39:42,480 --> 00:39:47,670
if you download a file in in Firefox or

798
00:39:45,000 --> 00:39:49,740
Chrome it'll immediately go into that

799
00:39:47,670 --> 00:39:54,450
database if you download something in

800
00:39:49,740 --> 00:39:56,029
Safari it could be days or weeks before

801
00:39:54,450 --> 00:40:01,649
it actually makes it into the database

802
00:39:56,030 --> 00:40:03,300
so that means there's kind of a little

803
00:40:01,650 --> 00:40:05,010
hole there where if somebody's

804
00:40:03,300 --> 00:40:08,000
downloading stuff through Safari you may

805
00:40:05,010 --> 00:40:12,540
not be able to actually get the real URL

806
00:40:08,000 --> 00:40:15,900
unfortunately so if we reconstruct the

807
00:40:12,540 --> 00:40:19,500
timeline here we can see that at 11:31

808
00:40:15,900 --> 00:40:21,930
that VST crack site was visited we see

809
00:40:19,500 --> 00:40:26,460
that a few minutes later valhalla

810
00:40:21,930 --> 00:40:30,000
vintage herb was installed which is a

811
00:40:26,460 --> 00:40:32,900
legitimate program but later we you know

812
00:40:30,000 --> 00:40:35,850
just seconds later we see that these

813
00:40:32,900 --> 00:40:40,890
malicious processes were created and

814
00:40:35,850 --> 00:40:44,250
launched and we see that these VM files

815
00:40:40,890 --> 00:40:45,779
were created and opened so that's

816
00:40:44,250 --> 00:40:48,660
definitely not supposed to happen when

817
00:40:45,780 --> 00:40:51,090
you install this program and finally

818
00:40:48,660 --> 00:40:52,980
wait at the time that we collected our

819
00:40:51,090 --> 00:40:54,960
data we can see there was a network

820
00:40:52,980 --> 00:40:58,980
connection open from both of those two

821
00:40:54,960 --> 00:41:01,050
processes so very interesting you know

822
00:40:58,980 --> 00:41:02,940
we got a pretty decent look at what was

823
00:41:01,050 --> 00:41:05,310
going on and this is good information to

824
00:41:02,940 --> 00:41:09,780
help you track down other infected

825
00:41:05,310 --> 00:41:11,850
machines in your environment so the last

826
00:41:09,780 --> 00:41:14,640
one we're gonna look at it's not as

827
00:41:11,850 --> 00:41:18,920
recent but it's interesting because it's

828
00:41:14,640 --> 00:41:21,779
still an ongoing case so fruit fly was a

829
00:41:18,920 --> 00:41:25,050
general-purpose backdoor that was used

830
00:41:21,780 --> 00:41:30,420
to infect Macs for over a decade before

831
00:41:25,050 --> 00:41:33,540
it was discovered and the it was very

832
00:41:30,420 --> 00:41:36,750
very creepy it's the the guy was using

833
00:41:33,540 --> 00:41:40,290
it to record people through the webcam

834
00:41:36,750 --> 00:41:44,130
and through the microphone he's been

835
00:41:40,290 --> 00:41:48,000
accused of among other things creation

836
00:41:44,130 --> 00:41:50,750
of child pornography and fortunately

837
00:41:48,000 --> 00:41:54,080
this guy was actually caught by the FBI

838
00:41:50,750 --> 00:41:56,040
they they got him they got his laptop

839
00:41:54,080 --> 00:41:59,130
all of his hardware

840
00:41:56,040 --> 00:42:01,710
he's currently in prison up in Cleveland

841
00:41:59,130 --> 00:42:03,600
he's still awaiting trial it's been kind

842
00:42:01,710 --> 00:42:06,720
of dragging on for the last couple of

843
00:42:03,600 --> 00:42:12,390
years but the evidence against him is

844
00:42:06,720 --> 00:42:15,390
strong so let's take a look here so

845
00:42:12,390 --> 00:42:17,879
we've got a system it's infected we

846
00:42:15,390 --> 00:42:19,890
don't know what it is yet so we'll look

847
00:42:17,880 --> 00:42:23,430
at suspicious behaviors and right away

848
00:42:19,890 --> 00:42:26,549
we see there's a launch agent in there

849
00:42:23,430 --> 00:42:29,160
called comm client client dot P list but

850
00:42:26,550 --> 00:42:32,940
we don't know why it's suspicious yet so

851
00:42:29,160 --> 00:42:35,430
let's take a look at that file and we

852
00:42:32,940 --> 00:42:37,980
see that it's suspicious because it's

853
00:42:35,430 --> 00:42:41,640
launching a process out of a hidden duck

854
00:42:37,980 --> 00:42:44,160
client file in the user folder so that's

855
00:42:41,640 --> 00:42:48,900
that's highly suspicious that's not

856
00:42:44,160 --> 00:42:54,600
normal behavior we also see that it has

857
00:42:48,900 --> 00:42:56,430
the NS UI element flag set in the P list

858
00:42:54,600 --> 00:43:00,120
file which means that this will not show

859
00:42:56,430 --> 00:43:03,240
up in the doc so that's another sort of

860
00:43:00,120 --> 00:43:06,839
suspicious piece of information so if we

861
00:43:03,240 --> 00:43:08,520
dig a little deeper we look in processes

862
00:43:06,840 --> 00:43:12,620
and we find wait a minute there's no

863
00:43:08,520 --> 00:43:16,860
there's nothing named client running in

864
00:43:12,620 --> 00:43:20,609
the process list so what's going on here

865
00:43:16,860 --> 00:43:23,780
and we can look in persistence again and

866
00:43:20,610 --> 00:43:27,960
there's actually my script will collect

867
00:43:23,780 --> 00:43:30,060
the output of launch control list which

868
00:43:27,960 --> 00:43:34,020
gives you a process ID so we can see

869
00:43:30,060 --> 00:43:38,520
that that launch agent plist launched

870
00:43:34,020 --> 00:43:40,440
something with a process idea of 536 so

871
00:43:38,520 --> 00:43:42,360
we can go back and we can take a look at

872
00:43:40,440 --> 00:43:45,000
processes and we say well there is

873
00:43:42,360 --> 00:43:49,980
something with that process ID but it's

874
00:43:45,000 --> 00:43:52,140
called Java not dot client so what is

875
00:43:49,980 --> 00:43:56,520
this it looks like maybe dot client is

876
00:43:52,140 --> 00:44:00,210
something that's running Java I'm not

877
00:43:56,520 --> 00:44:03,420
sure yet so we dig a little deeper and

878
00:44:00,210 --> 00:44:06,690
look in the file activity here and we

879
00:44:03,420 --> 00:44:09,360
see that for that process ID the file is

880
00:44:06,690 --> 00:44:09,690
actually listed here and the command is

881
00:44:09,360 --> 00:44:14,190
list

882
00:44:09,690 --> 00:44:18,270
Perle so that suggests this is a Perl

883
00:44:14,190 --> 00:44:21,210
script that's running and running Java

884
00:44:18,270 --> 00:44:23,220
and if you actually were able to collect

885
00:44:21,210 --> 00:44:24,930
that file that thought client file and

886
00:44:23,220 --> 00:44:28,379
take a look at it you'd find it is a

887
00:44:24,930 --> 00:44:30,390
perl script with a data section at the

888
00:44:28,380 --> 00:44:33,330
end and in that data section there's a

889
00:44:30,390 --> 00:44:36,779
mock Oh binary there's another perl

890
00:44:33,330 --> 00:44:40,200
script and there's a java class and

891
00:44:36,780 --> 00:44:47,490
these are all extracted by the script

892
00:44:40,200 --> 00:44:49,470
and executed so let's find out when this

893
00:44:47,490 --> 00:44:52,319
file was created on the system we can

894
00:44:49,470 --> 00:44:55,250
look at the file info data for that and

895
00:44:52,320 --> 00:45:03,030
you know it's it's pretty clear it was

896
00:44:55,250 --> 00:45:04,950
about 7:30 8:00 p.m. and we want to find

897
00:45:03,030 --> 00:45:07,470
out where this came from so we take a

898
00:45:04,950 --> 00:45:10,680
look at the install history we look at

899
00:45:07,470 --> 00:45:13,649
the browser history you know we look at

900
00:45:10,680 --> 00:45:15,210
you know everything that we can that

901
00:45:13,650 --> 00:45:20,280
might tell us where this came from and

902
00:45:15,210 --> 00:45:22,800
we find a whole lot of nothing so how do

903
00:45:20,280 --> 00:45:24,980
we you know doesn't look like this was

904
00:45:22,800 --> 00:45:27,270
downloaded and installed by the user

905
00:45:24,980 --> 00:45:35,160
doesn't look like it was probably from a

906
00:45:27,270 --> 00:45:36,930
zero-day maybe maybe not so let's dig a

907
00:45:35,160 --> 00:45:40,170
little deeper if we look at the bash

908
00:45:36,930 --> 00:45:41,759
history then there's something really

909
00:45:40,170 --> 00:45:45,990
interesting there you can see somebody's

910
00:45:41,760 --> 00:45:48,590
doing chmod plus x dot client so

911
00:45:45,990 --> 00:45:50,850
somebody's making it executable

912
00:45:48,590 --> 00:45:53,760
somebody's trying to load it with launch

913
00:45:50,850 --> 00:45:55,770
control they're kind of fumbling around

914
00:45:53,760 --> 00:45:57,780
a bit repeating some of these commands

915
00:45:55,770 --> 00:45:59,870
over and over and then checking the

916
00:45:57,780 --> 00:46:02,480
results and then trying again and

917
00:45:59,870 --> 00:46:07,920
finally they must get it right and

918
00:46:02,480 --> 00:46:09,840
logout and we don't know you know it we

919
00:46:07,920 --> 00:46:12,480
may not know that that was if that was

920
00:46:09,840 --> 00:46:15,810
physical access or remote the logout at

921
00:46:12,480 --> 00:46:19,590
the end though suggests remote so let's

922
00:46:15,810 --> 00:46:22,680
try and find out more about that if we

923
00:46:19,590 --> 00:46:24,030
look in the system logs for that time

924
00:46:22,680 --> 00:46:27,870
period

925
00:46:24,030 --> 00:46:30,210
and we've bracketed about what about 20

926
00:46:27,870 --> 00:46:34,640
seconds here there's something really

927
00:46:30,210 --> 00:46:37,710
interesting there you can see sshd had

928
00:46:34,640 --> 00:46:42,810
it was it had a connection open for user

929
00:46:37,710 --> 00:46:44,760
tests from a local IP address and we can

930
00:46:42,810 --> 00:46:47,220
see what time that happened so somebody

931
00:46:44,760 --> 00:46:51,540
had had used SSH to log into this

932
00:46:47,220 --> 00:46:53,040
machine run a bunch of commands and we

933
00:46:51,540 --> 00:46:55,320
can see that those commands were

934
00:46:53,040 --> 00:46:59,240
responsible for dropping the malware on

935
00:46:55,320 --> 00:47:02,370
the system and this is exactly what

936
00:46:59,240 --> 00:47:05,870
Phillip durch insky the the accused

937
00:47:02,370 --> 00:47:10,440
author of this malware did for 10 years

938
00:47:05,870 --> 00:47:15,089
this technically this is from an FBI

939
00:47:10,440 --> 00:47:17,430
flash document that was TLP amber and as

940
00:47:15,090 --> 00:47:19,560
far as I know still is but somebody put

941
00:47:17,430 --> 00:47:21,240
it up on a website publicly so I don't

942
00:47:19,560 --> 00:47:26,100
feel too bad about giving you a

943
00:47:21,240 --> 00:47:31,740
screenshot so basically this guy was

944
00:47:26,100 --> 00:47:33,870
known to find passwords find credentials

945
00:47:31,740 --> 00:47:37,259
from data breaches and used them to

946
00:47:33,870 --> 00:47:42,600
attack people's computers and get into

947
00:47:37,260 --> 00:47:44,400
him so that that was really interesting

948
00:47:42,600 --> 00:47:48,630
and creepy and a little different than

949
00:47:44,400 --> 00:47:51,690
most malware these days so if we look at

950
00:47:48,630 --> 00:47:53,880
the time line here it's pretty simple we

951
00:47:51,690 --> 00:47:56,910
see there was an SSH connection at a

952
00:47:53,880 --> 00:47:59,250
particular time you see that shortly

953
00:47:56,910 --> 00:48:02,640
after that the dot client file was

954
00:47:59,250 --> 00:48:05,280
created you'll see there was this

955
00:48:02,640 --> 00:48:07,379
interval of time during which all those

956
00:48:05,280 --> 00:48:10,050
commands were being executed trying to

957
00:48:07,380 --> 00:48:13,050
get that client loaded and running

958
00:48:10,050 --> 00:48:14,880
persistently on the system and then

959
00:48:13,050 --> 00:48:17,010
finally at the time of collection we

960
00:48:14,880 --> 00:48:20,400
could see that this Perl script was

961
00:48:17,010 --> 00:48:26,000
running something at least related to

962
00:48:20,400 --> 00:48:29,300
Java on the system persistently so

963
00:48:26,000 --> 00:48:32,510
that's that's pretty good

964
00:48:29,300 --> 00:48:36,150
pretty good information we can use that

965
00:48:32,510 --> 00:48:36,990
that's the conclusion here as I said

966
00:48:36,150 --> 00:48:41,190
this was

967
00:48:36,990 --> 00:48:44,399
a you know very high-level skim over

968
00:48:41,190 --> 00:48:47,160
this topic there's tons more information

969
00:48:44,400 --> 00:48:49,350
I gave a full day workshop on this

970
00:48:47,160 --> 00:48:52,140
earlier this year and even even a full

971
00:48:49,350 --> 00:48:54,390
day is not at all remotely enough time

972
00:48:52,140 --> 00:48:57,390
so I encourage you you know dig into

973
00:48:54,390 --> 00:48:59,910
this yourself please feel free to ask me

974
00:48:57,390 --> 00:49:02,400
questions you can find the slides with

975
00:48:59,910 --> 00:49:06,839
my contact info my github everything

976
00:49:02,400 --> 00:49:10,190
right there I welcome any questions now

977
00:49:06,840 --> 00:49:42,720
or later so anybody have any questions

978
00:49:10,190 --> 00:49:46,260
yeah so for training purposes you can

979
00:49:42,720 --> 00:49:51,240
actually use a VM you can run Mac OS on

980
00:49:46,260 --> 00:49:53,310
a Mac in VMware or parallels but you

981
00:49:51,240 --> 00:49:56,160
could also just get it now get a little

982
00:49:53,310 --> 00:49:58,200
Mac Mini you know hook it up to a

983
00:49:56,160 --> 00:50:02,250
monitor and a keyboard and a mouse and

984
00:49:58,200 --> 00:50:03,930
use that nice thing about the Mac recent

985
00:50:02,250 --> 00:50:06,930
versions of Mac OS have a new file

986
00:50:03,930 --> 00:50:10,740
system called ap FS you can do a

987
00:50:06,930 --> 00:50:12,660
snapshot with AP FS do you know detonate

988
00:50:10,740 --> 00:50:14,700
whatever Molly or malware you want to do

989
00:50:12,660 --> 00:50:16,529
you know do your analysis whatever you

990
00:50:14,700 --> 00:50:19,680
want to do and then just reset it it's

991
00:50:16,530 --> 00:50:23,880
almost like a VM so it's very slick very

992
00:50:19,680 --> 00:50:25,379
nice and of course if you're actually

993
00:50:23,880 --> 00:50:26,460
detonating real malware on it you're

994
00:50:25,380 --> 00:50:28,290
going to want to keep it on an isolated

995
00:50:26,460 --> 00:50:36,170
network so I can't see all your other

996
00:50:28,290 --> 00:50:36,170
stuff any other questions

997
00:50:37,810 --> 00:50:43,480
I think we're about out of time here so

998
00:50:40,900 --> 00:50:46,750
if you do have any other questions feel

999
00:50:43,480 --> 00:50:48,360
free to grab me in the hall or email me

1000
00:50:46,750 --> 00:50:53,689
later thank you

1001
00:50:48,360 --> 00:50:53,689
[Applause]

1002
00:50:54,160 --> 00:50:56,220
you

