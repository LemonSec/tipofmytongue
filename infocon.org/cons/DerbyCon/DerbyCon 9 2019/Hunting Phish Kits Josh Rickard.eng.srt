1
00:00:00,030 --> 00:00:04,759
cool hello everyone my name is Josh

2
00:00:02,129 --> 00:00:07,289
Richard can you hear me okay all right

3
00:00:04,759 --> 00:00:09,210
we're gonna talk about hunting for fish

4
00:00:07,290 --> 00:00:12,030
kits and I'll give you a little bit of

5
00:00:09,210 --> 00:00:24,150
background about myself yes that is oh

6
00:00:12,030 --> 00:00:34,070
you are not seeing that one sec you're

7
00:00:24,150 --> 00:00:36,450
not seeing that yeah all right so yeah

8
00:00:34,070 --> 00:00:38,280
my name is Josh record we're gonna be

9
00:00:36,450 --> 00:00:41,760
talking about hunting for fish kits and

10
00:00:38,280 --> 00:00:43,590
that is me underneath that mask soon but

11
00:00:41,760 --> 00:00:46,500
my background you know I started NIT

12
00:00:43,590 --> 00:00:49,050
went over to you know helped us the

13
00:00:46,500 --> 00:00:51,750
sysadmin door system support disss admin

14
00:00:49,050 --> 00:00:53,730
and went into GFI our digital forensics

15
00:00:51,750 --> 00:00:55,559
and they did that for a while

16
00:00:53,730 --> 00:00:58,529
created a lot of open source tools and

17
00:00:55,559 --> 00:01:01,440
then went to become a product manager at

18
00:00:58,530 --> 00:01:03,750
a phishing defense company idiot now I'm

19
00:01:01,440 --> 00:01:06,780
a security research engineer at swimlane

20
00:01:03,750 --> 00:01:10,229
which is a US or security orchestration

21
00:01:06,780 --> 00:01:12,210
automation response company so totally

22
00:01:10,229 --> 00:01:14,360
enough about me all right let's talk

23
00:01:12,210 --> 00:01:18,658
about how we're actually going to be

24
00:01:14,360 --> 00:01:20,189
hunting fish kids you know before we

25
00:01:18,659 --> 00:01:21,900
actually like huntin we need to

26
00:01:20,189 --> 00:01:24,119
understand what they are right and we

27
00:01:21,900 --> 00:01:27,210
need to have a base baseline of what

28
00:01:24,119 --> 00:01:29,670
these kind of these attacks are so

29
00:01:27,210 --> 00:01:31,589
they're really just a ploy able apps or

30
00:01:29,670 --> 00:01:33,720
deployable templates or applications

31
00:01:31,590 --> 00:01:35,430
that you can just upload to a

32
00:01:33,720 --> 00:01:37,320
compromised host the new house

33
00:01:35,430 --> 00:01:39,930
they're usually contained in like a dot

34
00:01:37,320 --> 00:01:40,798
zip file and they contain a whole bunch

35
00:01:39,930 --> 00:01:42,360
of attributes and we'll go through

36
00:01:40,799 --> 00:01:44,909
there's a little bit but they're really

37
00:01:42,360 --> 00:01:47,970
just a set of tools an attacker can

38
00:01:44,909 --> 00:01:50,310
deploy and also go there I have some

39
00:01:47,970 --> 00:01:52,200
configuration and some other items that

40
00:01:50,310 --> 00:01:53,729
we'll talk about but for the most part

41
00:01:52,200 --> 00:01:57,450
it's just like a template and a whole

42
00:01:53,729 --> 00:01:59,610
bunch of code so you know you can buy

43
00:01:57,450 --> 00:02:01,909
these kits and a lot of these kits are

44
00:01:59,610 --> 00:02:04,770
made by different attackers or groups

45
00:02:01,909 --> 00:02:08,550
then they're sold so this one is

46
00:02:04,770 --> 00:02:10,410
actually fun spam dot tools it's not

47
00:02:08,550 --> 00:02:11,740
buying tor anything so you can go Google

48
00:02:10,410 --> 00:02:15,310
it right now and

49
00:02:11,740 --> 00:02:18,220
go and buy an office 365 kit for $70 and

50
00:02:15,310 --> 00:02:20,170
you know these are kits are they you

51
00:02:18,220 --> 00:02:23,020
know created prepackaged and then other

52
00:02:20,170 --> 00:02:24,850
less technical scammers will actually

53
00:02:23,020 --> 00:02:26,860
use them configure them and start

54
00:02:24,850 --> 00:02:28,359
actually attacking so there's a couple

55
00:02:26,860 --> 00:02:30,490
different aspects where you have you

56
00:02:28,360 --> 00:02:34,120
know that the makers themselves as well

57
00:02:30,490 --> 00:02:37,360
as the actual attackers and so here's an

58
00:02:34,120 --> 00:02:40,050
example this was what August 25th was

59
00:02:37,360 --> 00:02:42,940
updated for an office attachment page

60
00:02:40,050 --> 00:02:45,820
that you can you can fish with through

61
00:02:42,940 --> 00:02:48,460
70 bucks it's weird that they actually

62
00:02:45,820 --> 00:02:51,190
don't take Bitcoin but in this

63
00:02:48,460 --> 00:02:55,140
oh and they do funny thing is they do

64
00:02:51,190 --> 00:03:01,240
have a built-in chat support for this

65
00:02:55,140 --> 00:03:02,049
tool yeah so let's take a look at one

66
00:03:01,240 --> 00:03:04,170
traditional kid

67
00:03:02,050 --> 00:03:06,190
you know everyone sees kind of a PayPal

68
00:03:04,170 --> 00:03:08,339
there's a bunch of you know the big

69
00:03:06,190 --> 00:03:10,570
companies Apple PayPal whatever it is

70
00:03:08,340 --> 00:03:13,060
obviously this is not an actual app

71
00:03:10,570 --> 00:03:16,180
PayPal site it's agent reviewed net

72
00:03:13,060 --> 00:03:18,160
slash login whatever but you know they

73
00:03:16,180 --> 00:03:19,810
have the the traditional feel but once

74
00:03:18,160 --> 00:03:22,870
you actually you know the attacker is

75
00:03:19,810 --> 00:03:24,610
uploaded the zip or this kit then they

76
00:03:22,870 --> 00:03:26,080
just extract it on this page and then

77
00:03:24,610 --> 00:03:29,170
you get a brand new website just like

78
00:03:26,080 --> 00:03:31,600
this but when you actually you know

79
00:03:29,170 --> 00:03:33,880
download that kit as a when you're

80
00:03:31,600 --> 00:03:35,200
hunting you actually you can expand it

81
00:03:33,880 --> 00:03:37,630
and this is kind of the traditional view

82
00:03:35,200 --> 00:03:41,530
you'll see they'll have a whole bunch of

83
00:03:37,630 --> 00:03:44,079
code most common is probably PHP there

84
00:03:41,530 --> 00:03:46,630
is some JavaScript some HTML you know

85
00:03:44,080 --> 00:03:50,500
CSS but for the most part they're just

86
00:03:46,630 --> 00:03:55,329
going to be they love PHP I hate PHP but

87
00:03:50,500 --> 00:03:57,040
you know it works so when they actually

88
00:03:55,330 --> 00:03:58,690
you know I've uploaded this kid and they

89
00:03:57,040 --> 00:04:01,900
have extracted it then they need to

90
00:03:58,690 --> 00:04:05,290
configure it the the user the less

91
00:04:01,900 --> 00:04:07,360
technical scammer as you can see they do

92
00:04:05,290 --> 00:04:09,700
have to configure it and there's nice

93
00:04:07,360 --> 00:04:12,640
comments that they leave which is which

94
00:04:09,700 --> 00:04:14,170
is great but you know the attacker or

95
00:04:12,640 --> 00:04:17,979
the less technical just put in their

96
00:04:14,170 --> 00:04:21,130
email address and and off again but they

97
00:04:17,980 --> 00:04:21,530
also the kit makers themselves and this

98
00:04:21,130 --> 00:04:23,510
has become

99
00:04:21,529 --> 00:04:26,719
way more common I'm seeing is though

100
00:04:23,510 --> 00:04:29,719
actually backdoor those kids so you know

101
00:04:26,720 --> 00:04:32,660
they're selling them to you know some

102
00:04:29,720 --> 00:04:35,480
person in some internet cafe somewhere

103
00:04:32,660 --> 00:04:37,160
and yeah they're actually you know

104
00:04:35,480 --> 00:04:40,340
backdooring by having these obvious

105
00:04:37,160 --> 00:04:44,840
gated encoded strings that that actually

106
00:04:40,340 --> 00:04:47,179
are emails a great example is this the

107
00:04:44,840 --> 00:04:50,630
dole just have this I think it's would

108
00:04:47,180 --> 00:04:55,100
base 64 and then rot and then GZ and

109
00:04:50,630 --> 00:04:57,380
flayed and rot13 and yeah but you know

110
00:04:55,100 --> 00:04:59,570
if you actually decoded this and it's

111
00:04:57,380 --> 00:05:01,820
actually the form questions that were

112
00:04:59,570 --> 00:05:03,710
that were there for the the kit that the

113
00:05:01,820 --> 00:05:06,260
user needed to fill out as well as

114
00:05:03,710 --> 00:05:08,930
they're sending to three different other

115
00:05:06,260 --> 00:05:13,760
email addresses and those are the actual

116
00:05:08,930 --> 00:05:15,410
like kit makers and the it's just really

117
00:05:13,760 --> 00:05:16,849
weird that you have you know three mail

118
00:05:15,410 --> 00:05:18,560
functions that some of this is not

119
00:05:16,850 --> 00:05:21,200
obvious gated sometimes like sometimes

120
00:05:18,560 --> 00:05:22,669
just plain text and they still just they

121
00:05:21,200 --> 00:05:25,789
don't know and they don't they don't

122
00:05:22,669 --> 00:05:28,549
look at it I like I like to think of

123
00:05:25,790 --> 00:05:30,110
this as the scammers are actually

124
00:05:28,550 --> 00:05:33,370
scamming the scammers

125
00:05:30,110 --> 00:05:36,710
it's a weird it's a weird situation

126
00:05:33,370 --> 00:05:38,210
because I just thought this was a weird

127
00:05:36,710 --> 00:05:43,190
photo they had nothing really to do with

128
00:05:38,210 --> 00:05:46,909
it I was googling like oh this is weird

129
00:05:43,190 --> 00:05:49,250
now they have these kids in and they're

130
00:05:46,910 --> 00:05:51,080
you know actually backdooring it so

131
00:05:49,250 --> 00:05:52,700
they'll send off that means they you

132
00:05:51,080 --> 00:05:54,229
know I'm gonna sign up you're going to

133
00:05:52,700 --> 00:05:56,030
pay me seventy dollars I'm going to

134
00:05:54,229 --> 00:05:58,039
download your kid I'm going to configure

135
00:05:56,030 --> 00:05:59,659
it but next time that user clicks on the

136
00:05:58,039 --> 00:06:00,320
link goes and fills out their

137
00:05:59,660 --> 00:06:03,229
information

138
00:06:00,320 --> 00:06:05,360
the kit makers are getting the

139
00:06:03,229 --> 00:06:07,190
information immediately as well as the

140
00:06:05,360 --> 00:06:10,310
configured user so they're really kind

141
00:06:07,190 --> 00:06:12,620
of they're like the the big shark of the

142
00:06:10,310 --> 00:06:16,210
water you know I think they're they're

143
00:06:12,620 --> 00:06:19,039
they're scamming everyone and it's great

144
00:06:16,210 --> 00:06:21,140
so some other attributes is that they

145
00:06:19,039 --> 00:06:23,570
embed images into these so they

146
00:06:21,140 --> 00:06:24,680
purposely don't want to call back to you

147
00:06:23,570 --> 00:06:27,140
know the original site where those

148
00:06:24,680 --> 00:06:28,910
images are hosted but they also have one

149
00:06:27,140 --> 00:06:31,210
compatibility you know a lot of them

150
00:06:28,910 --> 00:06:34,600
will have mobile sites and

151
00:06:31,210 --> 00:06:36,099
they they're very well designed I I

152
00:06:34,600 --> 00:06:39,430
don't want to say well-designed they're

153
00:06:36,100 --> 00:06:41,500
not coding wizards by any means but it's

154
00:06:39,430 --> 00:06:43,360
pretty interesting but they're also like

155
00:06:41,500 --> 00:06:45,009
confirmation pages so when you sign into

156
00:06:43,360 --> 00:06:46,210
paper out but then you need to actually

157
00:06:45,009 --> 00:06:48,400
transfer money and you get the

158
00:06:46,210 --> 00:06:50,049
combination you know sites you don't

159
00:06:48,400 --> 00:06:52,508
have access traditionally to those

160
00:06:50,050 --> 00:06:54,789
images those are all text so they

161
00:06:52,509 --> 00:06:57,039
actually and put those in there just

162
00:06:54,789 --> 00:07:01,150
kind of make it have that full

163
00:06:57,039 --> 00:07:04,630
traditional feel they also include these

164
00:07:01,150 --> 00:07:08,049
htaccess files these are really just a

165
00:07:04,630 --> 00:07:09,940
whole bunch of IP IP Sider blocks that

166
00:07:08,050 --> 00:07:11,770
they'll actually use to block on they'll

167
00:07:09,940 --> 00:07:13,870
keep adding to them and keep adding to

168
00:07:11,770 --> 00:07:16,090
them adding to them but they also like

169
00:07:13,870 --> 00:07:18,009
if your user agent if your Googlebot or

170
00:07:16,090 --> 00:07:20,109
some other BOTS trying to scrape them

171
00:07:18,009 --> 00:07:23,110
they'll actually redirect you to another

172
00:07:20,110 --> 00:07:24,970
site they're pretty efficient but some

173
00:07:23,110 --> 00:07:27,220
of these are thousands and thousands of

174
00:07:24,970 --> 00:07:31,509
lines they just keep adding to there's a

175
00:07:27,220 --> 00:07:34,539
cop I hate you and we'll see that but

176
00:07:31,509 --> 00:07:36,370
they also have a robots.txt so if

177
00:07:34,539 --> 00:07:37,840
anyone's traditional you know web app or

178
00:07:36,370 --> 00:07:40,060
whatever you will actually you have this

179
00:07:37,840 --> 00:07:41,948
just robots that text which basically

180
00:07:40,060 --> 00:07:44,560
blocks access to certain directories or

181
00:07:41,949 --> 00:07:50,699
certain areas plus they'll also use it

182
00:07:44,560 --> 00:07:54,130
for user agent get them redirected and

183
00:07:50,699 --> 00:07:57,190
the funny thing is they also have these

184
00:07:54,130 --> 00:08:01,050
scripts that they call anti-bot or bots

185
00:07:57,190 --> 00:08:04,870
dot php' whatever it is and it this one

186
00:08:01,050 --> 00:08:07,720
which is by the shadows one one eight

187
00:08:04,870 --> 00:08:09,250
group what will actually include they

188
00:08:07,720 --> 00:08:11,259
have six of them but they only actually

189
00:08:09,250 --> 00:08:13,630
include four and they're a huge list of

190
00:08:11,259 --> 00:08:18,669
ip's of very specific IPS they do they

191
00:08:13,630 --> 00:08:21,930
just hate so this is an example of one

192
00:08:18,669 --> 00:08:27,250
of those scripts you can see on line 50

193
00:08:21,930 --> 00:08:29,289
and 62 that they once you are identified

194
00:08:27,250 --> 00:08:31,389
as one of those bots they will send you

195
00:08:29,289 --> 00:08:34,390
a 404 and a nice little message back to

196
00:08:31,389 --> 00:08:36,220
you and you can get around this but it's

197
00:08:34,390 --> 00:08:38,860
pretty funny

198
00:08:36,220 --> 00:08:41,650
all right so they also multi-language

199
00:08:38,860 --> 00:08:43,690
support you know which is pretty

200
00:08:41,650 --> 00:08:45,459
interesting so they're really trying to

201
00:08:43,690 --> 00:08:47,590
make this like a service like like a

202
00:08:45,460 --> 00:08:50,440
traditional you know website which is

203
00:08:47,590 --> 00:08:53,680
really interesting but you know they're

204
00:08:50,440 --> 00:08:58,470
I think on the left is I think that's

205
00:08:53,680 --> 00:09:00,760
mass Spanish in the French in English

206
00:08:58,470 --> 00:09:02,340
but pretty interesting that they have

207
00:09:00,760 --> 00:09:04,810
multi-language

208
00:09:02,340 --> 00:09:07,660
you know again they're not coding

209
00:09:04,810 --> 00:09:10,030
Wizards by any means but sometimes they

210
00:09:07,660 --> 00:09:11,770
kind of impress me a little bit I mean

211
00:09:10,030 --> 00:09:16,000
that hate to use the word impress but

212
00:09:11,770 --> 00:09:18,189
you know like oh good good good job they

213
00:09:16,000 --> 00:09:20,170
actually do credit card validation to

214
00:09:18,190 --> 00:09:22,420
make that determination of what type of

215
00:09:20,170 --> 00:09:24,130
credit card it is on so they can send it

216
00:09:22,420 --> 00:09:26,500
off and have a quick little email

217
00:09:24,130 --> 00:09:28,710
summary of yours the new master cards

218
00:09:26,500 --> 00:09:32,340
you just got or here's the new Amex

219
00:09:28,710 --> 00:09:32,340
pretty pretty cool

220
00:09:33,690 --> 00:09:42,250
vlogs how many here actually have

221
00:09:37,830 --> 00:09:45,610
logging in there tools you should but

222
00:09:42,250 --> 00:09:47,970
not all the time right the great thing

223
00:09:45,610 --> 00:09:52,630
about some of these kits to full logging

224
00:09:47,970 --> 00:09:55,020
meaning what in who and when things were

225
00:09:52,630 --> 00:09:58,510
accessed as well as who entered what

226
00:09:55,020 --> 00:10:00,520
here you can actually see he this is who

227
00:09:58,510 --> 00:10:03,340
lien as my friends drawing it's it's

228
00:10:00,520 --> 00:10:03,970
amazing but you can see that he was

229
00:10:03,340 --> 00:10:07,540
testing

230
00:10:03,970 --> 00:10:10,600
yeah there's his client IP and they just

231
00:10:07,540 --> 00:10:12,730
include that and they leave it there so

232
00:10:10,600 --> 00:10:16,090
this is great information for us and

233
00:10:12,730 --> 00:10:19,300
we'll talk about here's another example

234
00:10:16,090 --> 00:10:22,240
right yeah the IP the the user agent

235
00:10:19,300 --> 00:10:23,770
string the date/time stamp you can

236
00:10:22,240 --> 00:10:26,920
actually see that this is who visited

237
00:10:23,770 --> 00:10:28,480
your site and they'll you know if they

238
00:10:26,920 --> 00:10:30,640
enter credentials will they'll spit

239
00:10:28,480 --> 00:10:35,980
those out so this will be really great

240
00:10:30,640 --> 00:10:38,020
resources for us as you know defense the

241
00:10:35,980 --> 00:10:41,020
best thing of though of all of these

242
00:10:38,020 --> 00:10:42,600
kids is this I mean this should be in

243
00:10:41,020 --> 00:10:46,620
some museum like

244
00:10:42,600 --> 00:10:49,380
this is pure art like a skewer gold-

245
00:10:46,620 --> 00:10:51,750
your you're not appreciating the

246
00:10:49,380 --> 00:10:56,460
trollface and paypal logos I mean this

247
00:10:51,750 --> 00:10:58,080
is this is amazing stuff but the other

248
00:10:56,460 --> 00:10:59,460
great thing about these kids is they'll

249
00:10:58,080 --> 00:11:01,860
leave around these where those leave

250
00:10:59,460 --> 00:11:03,840
around the other malware right and or

251
00:11:01,860 --> 00:11:07,410
tools whatever it is whether it's their

252
00:11:03,840 --> 00:11:10,020
their back-end control panels or actual

253
00:11:07,410 --> 00:11:12,060
you know exploits I've seen you know a

254
00:11:10,020 --> 00:11:15,480
lot of power show which is pretty normal

255
00:11:12,060 --> 00:11:17,520
now but exe is DLLs you know all the way

256
00:11:15,480 --> 00:11:20,880
down to AP case that they'll actually

257
00:11:17,520 --> 00:11:22,380
have downloaded it so depends on you

258
00:11:20,880 --> 00:11:24,450
know what the scope is if you're trying

259
00:11:22,380 --> 00:11:26,790
to do a credential harvesting or you're

260
00:11:24,450 --> 00:11:33,270
trying to actually exploit you know you

261
00:11:26,790 --> 00:11:36,060
may upon some some juicy stuff yeah so

262
00:11:33,270 --> 00:11:38,699
okay great right that's the basis of

263
00:11:36,060 --> 00:11:40,859
what these kits contain there's just a

264
00:11:38,700 --> 00:11:44,280
lot of code they have some interesting

265
00:11:40,860 --> 00:11:46,830
data points that we can actually use but

266
00:11:44,280 --> 00:11:49,199
what do we actually do with this at this

267
00:11:46,830 --> 00:11:51,630
point you know cool we know about this

268
00:11:49,200 --> 00:11:55,680
but one of the biggest things that we

269
00:11:51,630 --> 00:11:59,880
all talk about is TTP's right and TTP's

270
00:11:55,680 --> 00:12:01,770
you know they may not be well if

271
00:11:59,880 --> 00:12:03,120
phishing sites are going to be you know

272
00:12:01,770 --> 00:12:05,610
if you're getting a phishing website

273
00:12:03,120 --> 00:12:08,460
against your organization this is like

274
00:12:05,610 --> 00:12:10,620
true verification that this is an attack

275
00:12:08,460 --> 00:12:13,380
and this is what their exact actually

276
00:12:10,620 --> 00:12:14,790
doing so it's or their tactics or you

277
00:12:13,380 --> 00:12:17,070
know oh hey i'm going to steal your

278
00:12:14,790 --> 00:12:19,349
credentials or a I want to exploit in

279
00:12:17,070 --> 00:12:21,090
your home whatever it is you actually

280
00:12:19,350 --> 00:12:24,870
you know can dive down into those

281
00:12:21,090 --> 00:12:26,190
tactics and or dive into me yeah dive

282
00:12:24,870 --> 00:12:28,230
into this techniques like what do they

283
00:12:26,190 --> 00:12:30,210
what are they doing you know how are

284
00:12:28,230 --> 00:12:32,730
they actually exploiting it are they you

285
00:12:30,210 --> 00:12:33,990
know what's the whole goal of this and

286
00:12:32,730 --> 00:12:35,700
then you get out of the procedures you

287
00:12:33,990 --> 00:12:36,960
can start you know going down hey or

288
00:12:35,700 --> 00:12:38,730
they you know exploiting and your

289
00:12:36,960 --> 00:12:40,740
vulnerability and existing vulnerability

290
00:12:38,730 --> 00:12:42,900
or they trapped in situ so on and so

291
00:12:40,740 --> 00:12:45,000
forth but by identifying this we can

292
00:12:42,900 --> 00:12:46,290
actually use these kit well we can use

293
00:12:45,000 --> 00:12:51,090
these kits to actually start identifying

294
00:12:46,290 --> 00:12:55,160
some of these exploits against us also

295
00:12:51,090 --> 00:12:57,470
the IOC s are not dead in my opinion

296
00:12:55,160 --> 00:13:00,439
as these are still extremely valuable

297
00:12:57,470 --> 00:13:03,740
especially for and I had their active

298
00:13:00,440 --> 00:13:05,570
defense right yeah long term we want

299
00:13:03,740 --> 00:13:09,560
TTP's we want to block the entire

300
00:13:05,570 --> 00:13:12,260
actress but if hits the fan we need

301
00:13:09,560 --> 00:13:13,969
to respond and part of that response is

302
00:13:12,260 --> 00:13:16,220
whether it's you know blocking Happy's

303
00:13:13,970 --> 00:13:18,920
tracking data going hunting whatever it

304
00:13:16,220 --> 00:13:21,020
is you still need to use these IOC's it

305
00:13:18,920 --> 00:13:22,550
so there's some great information some

306
00:13:21,020 --> 00:13:24,560
of these kits like the the kit name

307
00:13:22,550 --> 00:13:26,510
versions so you can actually track that

308
00:13:24,560 --> 00:13:30,079
over time which is really really

309
00:13:26,510 --> 00:13:32,840
interesting um email addresses so yeah a

310
00:13:30,080 --> 00:13:36,080
lot of these are going to be Y and X and

311
00:13:32,840 --> 00:13:38,390
you know a bunch of Gmail lots of gmail

312
00:13:36,080 --> 00:13:40,100
boy you know you can actually track and

313
00:13:38,390 --> 00:13:42,170
solve them keep them for many many years

314
00:13:40,100 --> 00:13:44,360
you can just do a Google search for that

315
00:13:42,170 --> 00:13:47,240
email address and you'll see a pop up in

316
00:13:44,360 --> 00:13:51,530
images of the individuals as well which

317
00:13:47,240 --> 00:13:53,960
is a whole other game but you actually

318
00:13:51,530 --> 00:13:56,000
have logs right how many times you

319
00:13:53,960 --> 00:14:00,050
actually have logs and you can see when

320
00:13:56,000 --> 00:14:02,330
an attacker is actually you know who was

321
00:14:00,050 --> 00:14:04,459
who is getting fished and you can

322
00:14:02,330 --> 00:14:05,990
actually track that information but you

323
00:14:04,460 --> 00:14:07,760
also have a specific you know hosting

324
00:14:05,990 --> 00:14:10,910
providers you can grab detail about okay

325
00:14:07,760 --> 00:14:12,800
is this hos very specific known to have

326
00:14:10,910 --> 00:14:15,140
these certain types of kits or these

327
00:14:12,800 --> 00:14:17,959
certain versions or is it kind of just

328
00:14:15,140 --> 00:14:21,080
random x-ray and then we can actually

329
00:14:17,960 --> 00:14:22,640
you know track all the variants and one

330
00:14:21,080 --> 00:14:25,760
of the big things that we can do is

331
00:14:22,640 --> 00:14:27,890
track the individual you know defensive

332
00:14:25,760 --> 00:14:30,290
measures that they add and to those kids

333
00:14:27,890 --> 00:14:32,300
so if they're trying to block your IP

334
00:14:30,290 --> 00:14:34,430
your crawler your user agent strings

335
00:14:32,300 --> 00:14:36,199
whatever they are you can actually start

336
00:14:34,430 --> 00:14:38,540
tracking and modifying your tools and

337
00:14:36,200 --> 00:14:44,510
and become you know kind of evasive if

338
00:14:38,540 --> 00:14:49,760
you have the history let's go and start

339
00:14:44,510 --> 00:14:51,860
actually catching some kits I would hate

340
00:14:49,760 --> 00:14:55,850
to be of it I mean that it's got to be

341
00:14:51,860 --> 00:14:58,570
everything so a little story though is

342
00:14:55,850 --> 00:15:02,360
I'm going to go in a little soapbox I

343
00:14:58,570 --> 00:15:04,210
wish I actually had one foot okay so

344
00:15:02,360 --> 00:15:07,300
back in like 2004

345
00:15:04,210 --> 00:15:09,850
2015 I open sourced the tool that it

346
00:15:07,300 --> 00:15:12,490
would actually report messages within

347
00:15:09,850 --> 00:15:15,130
outlook near your mailbox to you know

348
00:15:12,490 --> 00:15:16,750
your internal Assad did you know I

349
00:15:15,130 --> 00:15:18,580
worked for a phishing defense company

350
00:15:16,750 --> 00:15:21,190
that we actually made that product and

351
00:15:18,580 --> 00:15:24,970
there they made it and we expanded it to

352
00:15:21,190 --> 00:15:27,610
a huge global audience but my point is

353
00:15:24,970 --> 00:15:29,649
if you do not have your users reporting

354
00:15:27,610 --> 00:15:32,620
phishing messages you need to do this

355
00:15:29,649 --> 00:15:34,060
they there's tons of commercial products

356
00:15:32,620 --> 00:15:35,770
there's tons of open-source product

357
00:15:34,060 --> 00:15:37,569
whatever it is you need to do this

358
00:15:35,770 --> 00:15:40,870
because this is a lot of really cool

359
00:15:37,570 --> 00:15:44,020
information in here will show you its a

360
00:15:40,870 --> 00:15:46,450
typical response to low rate user

361
00:15:44,020 --> 00:15:49,180
reports a message goes to centralized

362
00:15:46,450 --> 00:15:51,100
mailbox we extract the attributes we put

363
00:15:49,180 --> 00:15:54,370
in blocks and firewalls proxies we look

364
00:15:51,100 --> 00:15:56,529
at hashes whatever it is right great I

365
00:15:54,370 --> 00:15:59,110
think there's a huge missing gap that

366
00:15:56,529 --> 00:16:01,270
we're not taking advantage of and this

367
00:15:59,110 --> 00:16:04,420
is where we start actually hunting these

368
00:16:01,270 --> 00:16:05,529
fish kids we get these messages we need

369
00:16:04,420 --> 00:16:08,229
to go and find out as much information

370
00:16:05,529 --> 00:16:10,870
about them as possible

371
00:16:08,230 --> 00:16:12,910
one of the biggest attributes is if they

372
00:16:10,870 --> 00:16:15,220
do have logs you know which one of your

373
00:16:12,910 --> 00:16:17,020
users have actually failed or clicked

374
00:16:15,220 --> 00:16:19,959
and enter that and entered that

375
00:16:17,020 --> 00:16:21,730
information plus you have what kind of

376
00:16:19,959 --> 00:16:23,910
exploit is it you know were they trying

377
00:16:21,730 --> 00:16:26,170
to do a browser were they trying to do

378
00:16:23,910 --> 00:16:29,199
you know credit or alarbus thing

379
00:16:26,170 --> 00:16:31,360
whatever so your scope is already down

380
00:16:29,200 --> 00:16:34,120
further than just like wipe every

381
00:16:31,360 --> 00:16:37,350
machine you know and you you actually

382
00:16:34,120 --> 00:16:39,339
have some great intel that you can use

383
00:16:37,350 --> 00:16:40,750
so when you're actually hunting for

384
00:16:39,339 --> 00:16:42,670
these kits there's a bunch of different

385
00:16:40,750 --> 00:16:44,830
ways you know depending on your scope if

386
00:16:42,670 --> 00:16:47,589
it's just relation you use your own

387
00:16:44,830 --> 00:16:49,089
reported pushing this messages if not

388
00:16:47,589 --> 00:16:51,339
that you want to get some pre-filtered

389
00:16:49,089 --> 00:16:52,750
sources or just rahl sources you know

390
00:16:51,339 --> 00:16:56,079
there's a bunch of them there's open

391
00:16:52,750 --> 00:16:57,910
fish fish tank your own twitter it's

392
00:16:56,079 --> 00:16:59,560
actually a really cool get up called

393
00:16:57,910 --> 00:17:01,569
phishing database you should go check it

394
00:16:59,560 --> 00:17:03,579
out there's a bunch of emails or a bunch

395
00:17:01,570 --> 00:17:06,280
of links in there but then you know if

396
00:17:03,579 --> 00:17:08,709
your scope is more broad and you want to

397
00:17:06,280 --> 00:17:12,220
actually have the raw sources the

398
00:17:08,709 --> 00:17:14,770
internet certificate transparency logs

399
00:17:12,220 --> 00:17:16,630
great you know it's gonna be awesome

400
00:17:14,770 --> 00:17:20,540
if anyone doesn't know what

401
00:17:16,630 --> 00:17:22,790
c2fo is then well let's talk but who is

402
00:17:20,540 --> 00:17:26,569
domain search which is actually all new

403
00:17:22,790 --> 00:17:29,470
domains added to all TLDs as well as

404
00:17:26,569 --> 00:17:32,149
paceman which I call dumpster fire and

405
00:17:29,470 --> 00:17:33,920
web analyzer which is again pretty

406
00:17:32,150 --> 00:17:36,380
similar to domain search and then fire

407
00:17:33,920 --> 00:17:39,650
hole which is like a correlation for

408
00:17:36,380 --> 00:17:41,570
thousands in blacklist all into one nice

409
00:17:39,650 --> 00:17:45,140
fancy list that gets updated like every

410
00:17:41,570 --> 00:17:46,939
two minutes so use those as your sources

411
00:17:45,140 --> 00:17:48,470
it depends on what your scope is so if

412
00:17:46,940 --> 00:17:50,510
your scope is just your use your

413
00:17:48,470 --> 00:17:52,460
messages but if it's beyond you can

414
00:17:50,510 --> 00:17:55,460
actually start correlating and grabbing

415
00:17:52,460 --> 00:17:58,640
some of these lists let's take Twitter

416
00:17:55,460 --> 00:18:00,440
for example there's a lot of hashtags

417
00:17:58,640 --> 00:18:02,840
out there that are used at people that

418
00:18:00,440 --> 00:18:06,050
are actually hunting fish kits will you

419
00:18:02,840 --> 00:18:07,879
know add new kits almost immediately so

420
00:18:06,050 --> 00:18:10,250
our robot driven some of them are you

421
00:18:07,880 --> 00:18:11,300
know real user driven but that there are

422
00:18:10,250 --> 00:18:13,310
different types and the different

423
00:18:11,300 --> 00:18:16,430
formats and all that which is hard to

424
00:18:13,310 --> 00:18:18,020
mess with and some of these hashtags

425
00:18:16,430 --> 00:18:20,090
that I like to search for or is opened

426
00:18:18,020 --> 00:18:23,210
er which we'll talk about but it's open

427
00:18:20,090 --> 00:18:26,389
directory fish kit or fishing kit or

428
00:18:23,210 --> 00:18:29,180
don't use a hash tag there's a bunch of

429
00:18:26,390 --> 00:18:30,830
others as well here's an open directory

430
00:18:29,180 --> 00:18:32,690
everyone's probably seen one he just

431
00:18:30,830 --> 00:18:34,850
probably didn't maybe know that it was

432
00:18:32,690 --> 00:18:37,490
called an open directory but it's

433
00:18:34,850 --> 00:18:40,159
usually a title and in the HTML code the

434
00:18:37,490 --> 00:18:42,350
title will say index oath or contain the

435
00:18:40,160 --> 00:18:45,290
word index oh and it's a directory

436
00:18:42,350 --> 00:18:47,419
listing of all of your sites not all of

437
00:18:45,290 --> 00:18:49,340
them are enabled some on Mar if they are

438
00:18:47,420 --> 00:18:51,080
makes her job a hell of a lot easier but

439
00:18:49,340 --> 00:18:55,040
if they're not we could still do some

440
00:18:51,080 --> 00:18:57,020
simple stuff so one of the biggest thing

441
00:18:55,040 --> 00:18:58,879
with like Twitter and other sources you

442
00:18:57,020 --> 00:19:01,700
need to parse it all down first and

443
00:18:58,880 --> 00:19:03,530
actually take whatever formats that are

444
00:19:01,700 --> 00:19:08,990
seen and actually get it to a standard

445
00:19:03,530 --> 00:19:10,550
across all of those URLs then once we

446
00:19:08,990 --> 00:19:12,710
actually have that gyro then we begin

447
00:19:10,550 --> 00:19:15,409
our scraping you know using pipe I'd

448
00:19:12,710 --> 00:19:19,400
personally in a project so I'll show but

449
00:19:15,410 --> 00:19:21,890
I use you know Python requests as well

450
00:19:19,400 --> 00:19:23,900
as beautiful soup and mechanized and

451
00:19:21,890 --> 00:19:25,610
there's a few other you know packages

452
00:19:23,900 --> 00:19:28,000
and libraries that you can use but the

453
00:19:25,610 --> 00:19:31,719
whole point is requests the content

454
00:19:28,000 --> 00:19:34,390
ignore any try to ignore any errors as

455
00:19:31,720 --> 00:19:37,660
much as possible just just don't trust

456
00:19:34,390 --> 00:19:39,850
that they're saying 404 and download the

457
00:19:37,660 --> 00:19:42,580
content as much as possible parse the

458
00:19:39,850 --> 00:19:45,790
content look for any a or href HTML tags

459
00:19:42,580 --> 00:19:49,090
find any of those relative paths meaning

460
00:19:45,790 --> 00:19:51,159
and you serve your an H href you'll have

461
00:19:49,090 --> 00:19:53,110
a folder pass add them to a master list

462
00:19:51,160 --> 00:19:55,540
and then just start adding dot zip to

463
00:19:53,110 --> 00:19:57,760
each one of those as you expand and just

464
00:19:55,540 --> 00:19:59,470
keep doing this recursively across every

465
00:19:57,760 --> 00:20:01,180
page that you encounter on that site and

466
00:19:59,470 --> 00:20:03,430
then you just request content and you

467
00:20:01,180 --> 00:20:07,000
just keep going back and back back or

468
00:20:03,430 --> 00:20:10,090
back and forth so this is an example of

469
00:20:07,000 --> 00:20:12,550
finding and generating parts pass sorry

470
00:20:10,090 --> 00:20:14,439
is the identify that route download the

471
00:20:12,550 --> 00:20:16,120
content but we're really just looking

472
00:20:14,440 --> 00:20:18,130
through and you can see kind of in this

473
00:20:16,120 --> 00:20:20,439
gift that you know we're just expanding

474
00:20:18,130 --> 00:20:22,450
paths based on relative links that we

475
00:20:20,440 --> 00:20:24,870
found and just keep going down that down

476
00:20:22,450 --> 00:20:24,870
that loop

477
00:20:26,280 --> 00:20:32,649
alright so tons of Technology rape we

478
00:20:30,760 --> 00:20:35,680
all have it anyone loves sponge about I

479
00:20:32,650 --> 00:20:39,430
love sponge web as an adult now if I

480
00:20:35,680 --> 00:20:43,480
actually have a new daughter yeah yeah

481
00:20:39,430 --> 00:20:47,800
we love watching it alright so there's

482
00:20:43,480 --> 00:20:50,380
tons of open source tools out there yeah

483
00:20:47,800 --> 00:20:53,980
it's pretty good yeah phishing catcher

484
00:20:50,380 --> 00:20:57,700
so is a good word fishing kit hunter was

485
00:20:53,980 --> 00:21:00,880
another tool as well as stock fish fish

486
00:20:57,700 --> 00:21:02,740
collect material and fish finder there's

487
00:21:00,880 --> 00:21:06,880
tons of them on github but actually well

488
00:21:02,740 --> 00:21:08,860
you you know begin hunting I do you know

489
00:21:06,880 --> 00:21:10,630
these are great tools that used some of

490
00:21:08,860 --> 00:21:13,120
them I've used bits of pieces of them

491
00:21:10,630 --> 00:21:15,880
but I wanted to actually introduce a new

492
00:21:13,120 --> 00:21:19,389
tool that I'm releasing it's not a

493
00:21:15,880 --> 00:21:21,760
hundred percent done there are some

494
00:21:19,390 --> 00:21:24,640
errors right now so I plan on fixing it

495
00:21:21,760 --> 00:21:27,250
this weekend and next week but this will

496
00:21:24,640 --> 00:21:28,420
be available and it is one command that

497
00:21:27,250 --> 00:21:30,370
you would have to run it's called docker

498
00:21:28,420 --> 00:21:33,430
compose up turn that familiar with

499
00:21:30,370 --> 00:21:35,379
docker but each one is one's called

500
00:21:33,430 --> 00:21:37,540
spotter and spotter is going out and

501
00:21:35,380 --> 00:21:39,760
actually try based on a configuration

502
00:21:37,540 --> 00:21:41,590
file like mo config we

503
00:21:39,760 --> 00:21:44,440
and pool from all these sources plus

504
00:21:41,590 --> 00:21:47,050
I'll continue to add more and what it

505
00:21:44,440 --> 00:21:49,690
does is say ok this is a URL I'm gonna

506
00:21:47,050 --> 00:21:52,120
go and put it in a MongoDB a document

507
00:21:49,690 --> 00:21:54,370
called spotted and as well as put it

508
00:21:52,120 --> 00:21:57,790
into trum which is a RabbitMQ if

509
00:21:54,370 --> 00:21:59,530
anyone's interested and queues and then

510
00:21:57,790 --> 00:22:01,659
troller is the one that actually pulls

511
00:21:59,530 --> 00:22:04,629
from that queue and it expands

512
00:22:01,660 --> 00:22:07,990
vertically horizontally set of images

513
00:22:04,630 --> 00:22:11,710
that will actually go out and roll I am

514
00:22:07,990 --> 00:22:14,560
adding a tour support as another

515
00:22:11,710 --> 00:22:17,440
container as well as it rotates URLs

516
00:22:14,560 --> 00:22:18,760
user agent strings it rotates a whole

517
00:22:17,440 --> 00:22:21,400
bunch there's a bunch of features in it

518
00:22:18,760 --> 00:22:23,440
but then anything that it actually finds

519
00:22:21,400 --> 00:22:26,800
will go and put it into guts which is a

520
00:22:23,440 --> 00:22:29,050
document as well and that document will

521
00:22:26,800 --> 00:22:32,800
be all the actual raw or findings the

522
00:22:29,050 --> 00:22:34,300
the zips the exe is the the good thing

523
00:22:32,800 --> 00:22:36,850
about trawler is that you actually be

524
00:22:34,300 --> 00:22:39,490
able to specify the extensions so

525
00:22:36,850 --> 00:22:42,280
whether that's you know dot log no

526
00:22:39,490 --> 00:22:44,770
extension dot txt but let's say you want

527
00:22:42,280 --> 00:22:46,780
to ignore all HTML and PHP files if you

528
00:22:44,770 --> 00:22:48,879
don't want it download this then you

529
00:22:46,780 --> 00:22:51,730
just set them up there right now is like

530
00:22:48,880 --> 00:22:54,040
20 or something like that extensions

531
00:22:51,730 --> 00:22:58,440
that I support but you can add more just

532
00:22:54,040 --> 00:23:01,180
by adding it to a competi so that's it

533
00:22:58,440 --> 00:23:02,890
this is you know talking about fish kit

534
00:23:01,180 --> 00:23:05,260
hopefully a tool will be useful if you

535
00:23:02,890 --> 00:23:08,440
have any questions let me know you can

536
00:23:05,260 --> 00:23:10,620
reach me on Twitter get help I have my

537
00:23:08,440 --> 00:23:14,290
personal vlog let's automate that it and

538
00:23:10,620 --> 00:23:16,530
my work blog and that's where the code

539
00:23:14,290 --> 00:23:16,530
will be

540
00:23:26,040 --> 00:23:35,879
Dominus thank you

