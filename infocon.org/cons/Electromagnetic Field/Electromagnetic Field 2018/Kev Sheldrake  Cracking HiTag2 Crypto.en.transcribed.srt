1
00:00:00,770 --> 00:00:07,048
everybody<font color="#E5E5E5"> stage be like to welcome</font><font color="#CCCCCC"> keV</font>

2
00:00:05,339 --> 00:00:09,980
Sheldrake<font color="#CCCCCC"> who will talk</font><font color="#E5E5E5"> about cracking</font>

3
00:00:07,049 --> 00:00:13,039
hi tag<font color="#E5E5E5"> to</font><font color="#CCCCCC"> crypto hello</font>

4
00:00:09,980 --> 00:00:13,039
[Music]

5
00:00:14,839 --> 00:00:21,900
so it's been<font color="#E5E5E5"> quite an exciting day I I</font>

6
00:00:17,910 --> 00:00:23,698
spoke<font color="#CCCCCC"> up Graham</font><font color="#E5E5E5"> I spoke</font><font color="#CCCCCC"> about ha</font>

7
00:00:21,900 --> 00:00:26,759
<font color="#CCCCCC">password in the other</font><font color="#E5E5E5"> tent when I was</font>

8
00:00:23,699 --> 00:00:28,230
very<font color="#E5E5E5"> very sober and</font><font color="#CCCCCC"> or like I said I'll</font>

9
00:00:26,760 --> 00:00:30,720
be<font color="#E5E5E5"> sitting in the Sun drinking ever</font>

10
00:00:28,230 --> 00:00:34,050
since so I am going<font color="#CCCCCC"> to go through this</font>

11
00:00:30,720 --> 00:00:36,000
quickly<font color="#CCCCCC"> and I'm only going to talk about</font>

12
00:00:34,050 --> 00:00:37,760
some<font color="#E5E5E5"> of the content that's normally in</font>

13
00:00:36,000 --> 00:00:40,230
this talk because<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> limited</font>

14
00:00:37,760 --> 00:00:42,120
<font color="#CCCCCC">opportunities to the limited lengths</font>

15
00:00:40,230 --> 00:00:44,489
that<font color="#E5E5E5"> we have to speaker but if you do</font>

16
00:00:42,120 --> 00:00:46,050
have any interest or you want to ask

17
00:00:44,489 --> 00:00:48,480
<font color="#CCCCCC">questions or</font><font color="#E5E5E5"> you want to just like come</font>

18
00:00:46,050 --> 00:00:50,218
hang<font color="#E5E5E5"> out I will be outside</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> bar</font><font color="#CCCCCC"> buy</font>

19
00:00:48,480 --> 00:00:53,129
me a<font color="#E5E5E5"> beer you can ask anything you like</font>

20
00:00:50,219 --> 00:00:55,440
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I will demonstrate every like crack</font>

21
00:00:53,129 --> 00:00:57,870
that<font color="#E5E5E5"> I don't happen</font><font color="#CCCCCC"> to have in this talk</font>

22
00:00:55,440 --> 00:00:59,699
then but you have taught<font color="#CCCCCC"> me a bit to get</font>

23
00:00:57,870 --> 00:01:01,769
<font color="#CCCCCC">so</font><font color="#E5E5E5"> at that point I'm going to talk about</font>

24
00:00:59,699 --> 00:01:05,099
how<font color="#E5E5E5"> to talk to crypto this is me I work</font>

25
00:01:01,770 --> 00:01:06,740
in cyber<font color="#CCCCCC"> I do interesting things with</font>

26
00:01:05,099 --> 00:01:09,600
<font color="#E5E5E5">crypto and RFID</font>

27
00:01:06,740 --> 00:01:12,990
so the first question<font color="#E5E5E5"> is why do we copy</font>

28
00:01:09,600 --> 00:01:16,380
RFID types at 125 kilohertz<font color="#E5E5E5"> so for those</font>

29
00:01:12,990 --> 00:01:18,960
that don't<font color="#E5E5E5"> know RFID exists</font><font color="#CCCCCC"> into low</font>

30
00:01:16,380 --> 00:01:21,060
frequencies 125 kilohertz high frequency

31
00:01:18,960 --> 00:01:25,649
is thirteen point five six megahertz<font color="#CCCCCC"> and</font>

32
00:01:21,060 --> 00:01:28,170
very high frequency is 866<font color="#E5E5E5"> megahertz or</font>

33
00:01:25,650 --> 00:01:31,170
<font color="#E5E5E5">for 33 megahertz to anyone where you</font>

34
00:01:28,170 --> 00:01:33,420
live<font color="#CCCCCC"> so why do</font><font color="#E5E5E5"> we care about 125</font>

35
00:01:31,170 --> 00:01:35,430
kilohertz<font color="#E5E5E5"> RFID which are basically quite</font>

36
00:01:33,420 --> 00:01:36,840
old<font color="#CCCCCC"> as a technology and they go</font><font color="#E5E5E5"> out of</font>

37
00:01:35,430 --> 00:01:38,729
<font color="#E5E5E5">fashion they're disappearing it's</font>

38
00:01:36,840 --> 00:01:42,420
because<font color="#CCCCCC"> they're used to protect things</font>

39
00:01:38,729 --> 00:01:44,610
that are far more<font color="#CCCCCC"> valuable than</font><font color="#E5E5E5"> the</font>

40
00:01:42,420 --> 00:01:48,090
amount<font color="#E5E5E5"> of money it costs</font><font color="#CCCCCC"> to break it and</font>

41
00:01:44,610 --> 00:01:50,970
most 125 kilohertz RFID tags are rubbish

42
00:01:48,090 --> 00:01:52,290
but the ones I'm<font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about are less</font>

43
00:01:50,970 --> 00:01:54,509
rubbish but they're still rubbish

44
00:01:52,290 --> 00:01:56,520
unfortunately<font color="#CCCCCC"> they're also used to</font>

45
00:01:54,509 --> 00:02:00,299
<font color="#E5E5E5">protect the to implement the car</font>

46
00:01:56,520 --> 00:02:02,340
<font color="#E5E5E5">immobilizer in most cars I've since been</font>

47
00:02:00,299 --> 00:02:04,710
contacted from giving<font color="#E5E5E5"> these</font><font color="#CCCCCC"> twelve by</font>

48
00:02:02,340 --> 00:02:07,459
<font color="#CCCCCC">Audi and Nissan because apparently</font>

49
00:02:04,710 --> 00:02:10,299
<font color="#E5E5E5">they're using that technology who knows</font>

50
00:02:07,459 --> 00:02:12,440
<font color="#E5E5E5">so normal RFID</font>

51
00:02:10,300 --> 00:02:14,840
<font color="#CCCCCC">525 kilohertz looks like this it</font>

52
00:02:12,440 --> 00:02:16,069
transmits a single page of<font color="#E5E5E5"> data over and</font>

53
00:02:14,840 --> 00:02:18,170
over and<font color="#CCCCCC"> over again whenever</font><font color="#E5E5E5"> it's</font>

54
00:02:16,069 --> 00:02:20,200
powered up<font color="#E5E5E5"> and started that single page</font>

55
00:02:18,170 --> 00:02:23,510
of<font color="#E5E5E5"> data is a synchronization pattern</font>

56
00:02:20,200 --> 00:02:25,280
<font color="#CCCCCC">which they</font><font color="#E5E5E5"> read and the tag both know</font>

57
00:02:23,510 --> 00:02:26,540
<font color="#E5E5E5">and when the reader detects that</font>

58
00:02:25,280 --> 00:02:28,010
synchronization pattern it reads

59
00:02:26,540 --> 00:02:30,260
whatever bits come afterwards and turns

60
00:02:28,010 --> 00:02:31,970
<font color="#E5E5E5">that into a number and that is the</font>

61
00:02:30,260 --> 00:02:34,579
<font color="#CCCCCC">number they then use to make access</font>

62
00:02:31,970 --> 00:02:37,190
control<font color="#E5E5E5"> decisions</font><font color="#CCCCCC"> clearly you can copy</font>

63
00:02:34,580 --> 00:02:38,900
these easily<font color="#E5E5E5"> by just</font><font color="#CCCCCC"> emanating a field</font>

64
00:02:37,190 --> 00:02:41,359
<font color="#CCCCCC">one hundred of K and seeing what number</font>

65
00:02:38,900 --> 00:02:43,430
<font color="#E5E5E5">comes out write it down and then</font><font color="#CCCCCC"> program</font>

66
00:02:41,360 --> 00:02:46,660
that to<font color="#E5E5E5"> another tag by it so it's so</font>

67
00:02:43,430 --> 00:02:49,970
<font color="#CCCCCC">they've their trouble to break an</font>

68
00:02:46,660 --> 00:02:51,470
electromagnetic sort of spectrum basis

69
00:02:49,970 --> 00:02:54,700
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is kind of how</font><font color="#E5E5E5"> it looks the reader</font>

70
00:02:51,470 --> 00:02:57,050
emanates field<font color="#CCCCCC"> the tag has no battery it</font>

71
00:02:54,700 --> 00:03:00,260
absorbs its power from the<font color="#E5E5E5"> field and</font>

72
00:02:57,050 --> 00:03:03,440
then it<font color="#CCCCCC"> damps that field on and off in a</font>

73
00:03:00,260 --> 00:03:04,970
pattern to signal<font color="#CCCCCC"> information to the</font>

74
00:03:03,440 --> 00:03:06,650
reader<font color="#E5E5E5"> and if the reader wants to</font>

75
00:03:04,970 --> 00:03:08,330
<font color="#E5E5E5">transmit information to the tags such as</font>

76
00:03:06,650 --> 00:03:10,400
I want you to write<font color="#E5E5E5"> this page with a</font>

77
00:03:08,330 --> 00:03:13,670
<font color="#E5E5E5">particular value</font><font color="#CCCCCC"> then it dumps the field</font>

78
00:03:10,400 --> 00:03:17,030
in a particular way as well<font color="#E5E5E5"> the way that</font>

79
00:03:13,670 --> 00:03:23,268
they<font color="#E5E5E5"> dump the field is one of these</font>

80
00:03:17,030 --> 00:03:26,420
<font color="#E5E5E5">types of keying modulations and possibly</font>

81
00:03:23,269 --> 00:03:27,980
encoded with<font color="#E5E5E5"> Manchester by phase or not</font>

82
00:03:26,420 --> 00:03:30,679
as the case<font color="#E5E5E5"> may be I'm not going to talk</font>

83
00:03:27,980 --> 00:03:33,078
<font color="#E5E5E5">about this anymore</font><font color="#CCCCCC"> the many many months</font>

84
00:03:30,680 --> 00:03:34,430
<font color="#E5E5E5">that</font><font color="#CCCCCC"> I spent looking at</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> technology</font>

85
00:03:33,079 --> 00:03:36,650
are<font color="#E5E5E5"> to learn</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of this stuff and</font>

86
00:03:34,430 --> 00:03:40,609
<font color="#E5E5E5">know this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> interesting to</font><font color="#CCCCCC"> the the</font>

87
00:03:36,650 --> 00:03:43,700
crypto<font color="#E5E5E5"> world yes it's very</font><font color="#CCCCCC"> interesting</font>

88
00:03:40,609 --> 00:03:46,700
if you care about radio<font color="#CCCCCC"> and I did at</font><font color="#E5E5E5"> the</font>

89
00:03:43,700 --> 00:03:48,170
start<font color="#E5E5E5"> this project so happily</font><font color="#CCCCCC"> talk about</font>

90
00:03:46,700 --> 00:03:49,220
it but<font color="#CCCCCC"> honestly the crypto is much more</font>

91
00:03:48,170 --> 00:03:53,298
interesting so we're going<font color="#E5E5E5"> to skip this</font>

92
00:03:49,220 --> 00:03:56,060
bit<font color="#CCCCCC"> so if we wanted secure 125 kilohertz</font>

93
00:03:53,299 --> 00:03:57,829
<font color="#E5E5E5">RFID what we'd want is two-way comms</font><font color="#CCCCCC"> and</font>

94
00:03:56,060 --> 00:04:00,590
we'd want some sort of authentication

95
00:03:57,829 --> 00:04:02,750
<font color="#E5E5E5">and there's some sort of encryption</font><font color="#CCCCCC"> such</font>

96
00:04:00,590 --> 00:04:05,959
that you couldn't replay the<font color="#E5E5E5"> comms and</font>

97
00:04:02,750 --> 00:04:08,660
<font color="#E5E5E5">you can copy the tags easily that's kind</font>

98
00:04:05,959 --> 00:04:12,829
of<font color="#E5E5E5"> the goal so I'm going to talk</font><font color="#CCCCCC"> about</font>

99
00:04:08,660 --> 00:04:13,730
<font color="#E5E5E5">high tag</font><font color="#CCCCCC"> two which is one of</font><font color="#E5E5E5"> these not</font>

100
00:04:12,829 --> 00:04:15,440
<font color="#E5E5E5">that it makes any</font><font color="#CCCCCC"> difference because</font>

101
00:04:13,730 --> 00:04:18,950
<font color="#E5E5E5">that's the standard ISO card but it's</font>

102
00:04:15,440 --> 00:04:20,298
high tag<font color="#E5E5E5"> 2 which is the technology</font><font color="#CCCCCC"> si in</font>

103
00:04:18,950 --> 00:04:22,940
<font color="#E5E5E5">you're probably in your car immobilizer</font>

104
00:04:20,298 --> 00:04:23,880
<font color="#E5E5E5">and possibly in the tags that let you</font>

105
00:04:22,940 --> 00:04:27,810
into the<font color="#CCCCCC"> building</font>

106
00:04:23,880 --> 00:04:29,460
you<font color="#E5E5E5"> working in password mode and in</font>

107
00:04:27,810 --> 00:04:31,380
crypto<font color="#E5E5E5"> mode you might note from the</font>

108
00:04:29,460 --> 00:04:33,690
contents<font color="#E5E5E5"> I'll talk about</font><font color="#CCCCCC"> passwords</font>

109
00:04:31,380 --> 00:04:35,730
very very<font color="#E5E5E5"> very small amount of time</font><font color="#CCCCCC"> and</font>

110
00:04:33,690 --> 00:04:37,170
<font color="#E5E5E5">I'll talk about crypto mode a large</font>

111
00:04:35,730 --> 00:04:40,020
amount of time<font color="#E5E5E5"> that's because password</font>

112
00:04:37,170 --> 00:04:42,240
<font color="#E5E5E5">mode is rubbish as we're about to see so</font>

113
00:04:40,020 --> 00:04:44,640
what I<font color="#E5E5E5"> won't be</font><font color="#CCCCCC"> talking about is</font>

114
00:04:42,240 --> 00:04:48,240
<font color="#E5E5E5">everything else and and specifically</font>

115
00:04:44,640 --> 00:04:51,360
cars but come and<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to me later</font><font color="#E5E5E5"> if</font>

116
00:04:48,240 --> 00:04:53,070
you<font color="#CCCCCC"> want to know</font><font color="#E5E5E5"> more so it all started</font>

117
00:04:51,360 --> 00:04:55,920
with an<font color="#CCCCCC"> academic paper</font><font color="#E5E5E5"> basically we had</font>

118
00:04:53,070 --> 00:04:58,710
a job<font color="#E5E5E5"> where which</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> involved breaking</font>

119
00:04:55,920 --> 00:05:02,010
into buildings by copying RFID tags<font color="#E5E5E5"> and</font>

120
00:04:58,710 --> 00:05:05,880
one of my colleagues said I think this

121
00:05:02,010 --> 00:05:07,080
academic<font color="#E5E5E5"> paper it says a lot about</font><font color="#CCCCCC"> the</font>

122
00:05:05,880 --> 00:05:08,250
sort of<font color="#E5E5E5"> system</font><font color="#CCCCCC"> that we're looking at</font>

123
00:05:07,080 --> 00:05:09,570
breaking<font color="#E5E5E5"> would you like to have a look</font>

124
00:05:08,250 --> 00:05:11,010
<font color="#CCCCCC">at it and</font><font color="#E5E5E5"> could you implement the stuff</font>

125
00:05:09,570 --> 00:05:12,750
that they're<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about and this is</font>

126
00:05:11,010 --> 00:05:15,330
the<font color="#E5E5E5"> academic paper it's called</font><font color="#CCCCCC"> going</font>

127
00:05:12,750 --> 00:05:17,370
<font color="#E5E5E5">through here</font><font color="#CCCCCC"> in 360 seconds</font><font color="#E5E5E5"> hijacking</font>

128
00:05:15,330 --> 00:05:20,219
with high<font color="#E5E5E5"> time to buy</font><font color="#CCCCCC"> food alt Garcia</font>

129
00:05:17,370 --> 00:05:24,050
and<font color="#CCCCCC"> Blache and I've met</font><font color="#E5E5E5"> Flavia Garcia</font>

130
00:05:20,220 --> 00:05:26,580
<font color="#CCCCCC">he's a lovely man very Italian</font><font color="#E5E5E5"> and the</font>

131
00:05:24,050 --> 00:05:28,620
the stuff they did is is<font color="#CCCCCC"> awesome it's</font>

132
00:05:26,580 --> 00:05:29,490
very very clever mathematics<font color="#E5E5E5"> it's very</font>

133
00:05:28,620 --> 00:05:32,160
hard<font color="#E5E5E5"> to understand</font>

134
00:05:29,490 --> 00:05:34,320
they wrote code to implement three

135
00:05:32,160 --> 00:05:36,720
attacks in<font color="#E5E5E5"> this paper when they produced</font>

136
00:05:34,320 --> 00:05:39,719
the paper in 2012 and then never

137
00:05:36,720 --> 00:05:42,750
<font color="#CCCCCC">released their code</font><font color="#E5E5E5"> and for five years</font>

138
00:05:39,720 --> 00:05:44,880
<font color="#E5E5E5">no one had written that code and people</font>

139
00:05:42,750 --> 00:05:46,710
<font color="#E5E5E5">were asking for it on the RFID forms and</font>

140
00:05:44,880 --> 00:05:48,390
that's<font color="#E5E5E5"> why we decided</font><font color="#CCCCCC"> that we should</font>

141
00:05:46,710 --> 00:05:51,960
<font color="#CCCCCC">write that</font><font color="#E5E5E5"> code and release it which is</font>

142
00:05:48,390 --> 00:05:54,030
what we've kind of done so<font color="#CCCCCC"> high tag</font><font color="#E5E5E5"> -</font>

143
00:05:51,960 --> 00:05:55,200
what<font color="#CCCCCC"> does the high tag - tag kind of</font>

144
00:05:54,030 --> 00:05:56,849
look<font color="#CCCCCC"> like well it kind of</font><font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like</font>

145
00:05:55,200 --> 00:05:58,950
this if you drop<font color="#E5E5E5"> it into acetone and</font>

146
00:05:56,850 --> 00:06:03,000
then magnify<font color="#E5E5E5"> it with a child's</font>

147
00:05:58,950 --> 00:06:06,030
microscope so for the for the sake of a

148
00:06:03,000 --> 00:06:08,910
pound for the acetone perhaps in 30

149
00:06:06,030 --> 00:06:11,460
pounds for<font color="#E5E5E5"> the microscope and 700 pounds</font>

150
00:06:08,910 --> 00:06:14,790
<font color="#E5E5E5">for a decent SLR you can get photos like</font>

151
00:06:11,460 --> 00:06:18,599
this as well and in the bottom<font color="#CCCCCC"> right one</font>

152
00:06:14,790 --> 00:06:20,760
it does actually say<font color="#E5E5E5"> HT - which say it</font>

153
00:06:18,600 --> 00:06:22,650
means<font color="#CCCCCC"> high</font><font color="#E5E5E5"> tag - and if you looked</font>

154
00:06:20,760 --> 00:06:23,880
closer it would<font color="#E5E5E5"> say micron which the</font>

155
00:06:22,650 --> 00:06:26,310
<font color="#E5E5E5">people who originally made it and</font>

156
00:06:23,880 --> 00:06:30,210
stamped<font color="#E5E5E5"> the silicon that Phillips then</font>

157
00:06:26,310 --> 00:06:33,479
bought that XP was rebranded<font color="#E5E5E5"> - but this</font>

158
00:06:30,210 --> 00:06:35,070
<font color="#E5E5E5">is largely pointless it's just fun what</font>

159
00:06:33,479 --> 00:06:37,169
a<font color="#CCCCCC"> high-tech who really looks like</font><font color="#E5E5E5"> is</font>

160
00:06:35,070 --> 00:06:38,169
this<font color="#CCCCCC"> this is logically</font><font color="#E5E5E5"> what it looks</font>

161
00:06:37,169 --> 00:06:40,448
like

162
00:06:38,169 --> 00:06:43,119
there's eight pages of<font color="#E5E5E5"> 32 bits of</font><font color="#CCCCCC"> data</font>

163
00:06:40,449 --> 00:06:45,520
<font color="#E5E5E5">so the first page is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> UID that is</font>

164
00:06:43,119 --> 00:06:49,949
stamped into<font color="#E5E5E5"> it in the factory</font><font color="#CCCCCC"> and is</font>

165
00:06:45,520 --> 00:06:52,479
not changeable<font color="#CCCCCC"> you can buy Chinese</font>

166
00:06:49,949 --> 00:06:55,719
<font color="#CCCCCC">high-tech two tags where you can</font><font color="#E5E5E5"> change</font>

167
00:06:52,479 --> 00:06:57,279
the page<font color="#E5E5E5"> zero data but typically the</font>

168
00:06:55,719 --> 00:06:59,199
vast<font color="#CCCCCC"> majority in the world that you</font><font color="#E5E5E5"> will</font>

169
00:06:57,279 --> 00:07:01,649
see you<font color="#CCCCCC"> can't and it doesn't matter</font>

170
00:06:59,199 --> 00:07:05,919
<font color="#E5E5E5">because it's not important to the crypto</font>

171
00:07:01,649 --> 00:07:08,020
<font color="#E5E5E5">pages 1</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> &</font><font color="#CCCCCC"> 3 contain secrets</font><font color="#E5E5E5"> which is</font>

172
00:07:05,919 --> 00:07:12,729
why<font color="#CCCCCC"> they've read</font><font color="#E5E5E5"> pages 4 to 7 contain</font>

173
00:07:08,020 --> 00:07:15,279
user data<font color="#E5E5E5"> such as this uses</font><font color="#CCCCCC"> IIED within</font>

174
00:07:12,729 --> 00:07:21,039
the system<font color="#E5E5E5"> which the system then</font><font color="#CCCCCC"> makes</font>

175
00:07:15,279 --> 00:07:23,110
access control decisions<font color="#CCCCCC"> over so whether</font>

176
00:07:21,039 --> 00:07:25,330
you're<font color="#CCCCCC"> in password or crypto mode</font><font color="#E5E5E5"> the</font>

177
00:07:23,110 --> 00:07:27,219
whole<font color="#E5E5E5"> system resides on shared secrets</font>

178
00:07:25,330 --> 00:07:28,568
<font color="#E5E5E5">now it would be lovely if there was</font>

179
00:07:27,219 --> 00:07:30,610
enough processing power<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> a</font>

180
00:07:28,569 --> 00:07:33,099
<font color="#CCCCCC">symmetric crypto in these kind of</font><font color="#E5E5E5"> things</font>

181
00:07:30,610 --> 00:07:35,800
but there's not<font color="#E5E5E5"> because at 125 kilohertz</font>

182
00:07:33,099 --> 00:07:37,779
it just<font color="#E5E5E5"> isn't the power to do these kind</font>

183
00:07:35,800 --> 00:07:39,490
of<font color="#E5E5E5"> things</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> therefore you</font><font color="#CCCCCC"> have to</font><font color="#E5E5E5"> do</font>

184
00:07:37,779 --> 00:07:41,619
symmetric encryption and if you do

185
00:07:39,490 --> 00:07:43,749
symmetric encryption then you<font color="#CCCCCC"> basically</font>

186
00:07:41,619 --> 00:07:46,689
<font color="#E5E5E5">have to share the secrets and that what</font>

187
00:07:43,749 --> 00:07:49,330
that<font color="#E5E5E5"> really means in practice</font><font color="#CCCCCC"> is that if</font>

188
00:07:46,689 --> 00:07:52,930
you have a<font color="#E5E5E5"> system with a thousand doors</font>

189
00:07:49,330 --> 00:07:55,300
<font color="#E5E5E5">and 10,000 users with tags that can open</font>

190
00:07:52,930 --> 00:07:58,240
<font color="#E5E5E5">those doors</font><font color="#CCCCCC"> or a subset of those doors</font>

191
00:07:55,300 --> 00:08:00,189
<font color="#E5E5E5">then every door reader and every tag has</font>

192
00:07:58,240 --> 00:08:01,659
the same secret<font color="#E5E5E5"> within it and you only</font>

193
00:08:00,189 --> 00:08:03,399
have<font color="#E5E5E5"> to compromise one bit</font><font color="#CCCCCC"> of that</font>

194
00:08:01,659 --> 00:08:04,869
system<font color="#E5E5E5"> to</font><font color="#CCCCCC"> access the secret and then</font><font color="#E5E5E5"> you</font>

195
00:08:03,399 --> 00:08:08,379
can<font color="#CCCCCC"> compromise</font><font color="#E5E5E5"> the rest of the system</font>

196
00:08:04,869 --> 00:08:11,889
really really<font color="#CCCCCC"> quickly so this</font><font color="#E5E5E5"> is kind of</font>

197
00:08:08,379 --> 00:08:14,439
fundamentally bad as security goes in

198
00:08:11,889 --> 00:08:16,360
<font color="#E5E5E5">terms of access</font><font color="#CCCCCC"> control</font><font color="#E5E5E5"> when you move</font>

199
00:08:14,439 --> 00:08:18,759
into the<font color="#E5E5E5"> worlds of</font><font color="#CCCCCC"> 13 point 5 6 Meg's</font>

200
00:08:16,360 --> 00:08:19,869
and<font color="#E5E5E5"> you you look at so there's far</font><font color="#CCCCCC"> evie</font>

201
00:08:18,759 --> 00:08:22,089
twos and things<font color="#E5E5E5"> like that</font>

202
00:08:19,869 --> 00:08:24,279
these problems don't really exist<font color="#E5E5E5"> in</font>

203
00:08:22,089 --> 00:08:27,430
this<font color="#E5E5E5"> kind of form and things are much</font>

204
00:08:24,279 --> 00:08:29,079
much<font color="#E5E5E5"> better</font><font color="#CCCCCC"> but if you were to look</font><font color="#E5E5E5"> at</font>

205
00:08:27,430 --> 00:08:31,269
another crypto system whatever<font color="#E5E5E5"> it</font>

206
00:08:29,079 --> 00:08:33,938
<font color="#E5E5E5">happens</font><font color="#CCCCCC"> to be and you found that</font><font color="#E5E5E5"> kind of</font>

207
00:08:31,269 --> 00:08:35,198
<font color="#E5E5E5">signature then you your</font><font color="#CCCCCC"> lambo should</font>

208
00:08:33,938 --> 00:08:36,789
<font color="#E5E5E5">ring you</font><font color="#CCCCCC"> should start to</font><font color="#E5E5E5"> think well I</font>

209
00:08:35,198 --> 00:08:38,318
could<font color="#CCCCCC"> probably just</font><font color="#E5E5E5"> compromise this tiny</font>

210
00:08:36,789 --> 00:08:40,208
<font color="#E5E5E5">a</font><font color="#CCCCCC"> bit of this</font><font color="#E5E5E5"> and then I could own the</font>

211
00:08:38,318 --> 00:08:41,948
whole thing<font color="#CCCCCC"> and a compromise a tiny bit</font>

212
00:08:40,208 --> 00:08:44,109
of<font color="#CCCCCC"> it really</font><font color="#E5E5E5"> means all right I just</font><font color="#CCCCCC"> need</font>

213
00:08:41,948 --> 00:08:48,040
<font color="#CCCCCC">to steal something and take it</font><font color="#E5E5E5"> apart</font>

214
00:08:44,110 --> 00:08:50,050
which<font color="#E5E5E5"> is kind of what I did so password</font>

215
00:08:48,040 --> 00:08:50,890
mode I thought we were really quickly so

216
00:08:50,050 --> 00:08:53,620
the

217
00:08:50,890 --> 00:08:56,110
the reader in passive abode constantly

218
00:08:53,620 --> 00:08:58,750
emanates<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bone-weary</font><font color="#E5E5E5"> pattern 1</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> 0 0</font>

219
00:08:56,110 --> 00:09:01,420
<font color="#E5E5E5">0 using pulse width modulation</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

220
00:08:58,750 --> 00:09:03,550
field<font color="#E5E5E5"> and when a tag enters the field</font>

221
00:09:01,420 --> 00:09:06,089
<font color="#E5E5E5">and powers up it sees that and it</font>

222
00:09:03,550 --> 00:09:09,339
responds<font color="#CCCCCC"> with</font><font color="#E5E5E5"> its UID value on page 0</font>

223
00:09:06,090 --> 00:09:12,640
<font color="#E5E5E5">the reader then sends page 1 in clear</font>

224
00:09:09,340 --> 00:09:14,890
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> the system password</font><font color="#E5E5E5"> and the tag</font>

225
00:09:12,640 --> 00:09:17,770
responds with<font color="#E5E5E5"> the tag password page 3 in</font>

226
00:09:14,890 --> 00:09:19,780
clear and then the reader<font color="#E5E5E5"> talks to it in</font>

227
00:09:17,770 --> 00:09:21,160
clear<font color="#CCCCCC"> and the tag responds</font><font color="#E5E5E5"> in clear</font>

228
00:09:19,780 --> 00:09:22,839
<font color="#E5E5E5">right now so if you can</font><font color="#CCCCCC"> eavesdrop on</font>

229
00:09:21,160 --> 00:09:25,150
<font color="#E5E5E5">that you can get all the</font><font color="#CCCCCC"> passwords right</font>

230
00:09:22,840 --> 00:09:26,290
<font color="#CCCCCC">so password mode</font><font color="#E5E5E5"> is awful</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> not</font>

231
00:09:25,150 --> 00:09:29,350
going<font color="#CCCCCC"> to talk</font><font color="#E5E5E5"> about that anymore in this</font>

232
00:09:26,290 --> 00:09:31,089
talk<font color="#E5E5E5"> crypto mode however starts with the</font>

233
00:09:29,350 --> 00:09:33,130
same thing so<font color="#E5E5E5"> basically your system can</font>

234
00:09:31,090 --> 00:09:35,560
be either<font color="#E5E5E5"> in password mode or crypto</font>

235
00:09:33,130 --> 00:09:37,840
mode it can't be a<font color="#CCCCCC"> hybrid so in crypto</font>

236
00:09:35,560 --> 00:09:39,880
mode it's emanating 1 1 0 0 0<font color="#E5E5E5"> the same</font>

237
00:09:37,840 --> 00:09:43,390
pattern<font color="#E5E5E5"> in pull through</font><font color="#CCCCCC"> it's modulation</font>

238
00:09:39,880 --> 00:09:45,250
<font color="#E5E5E5">and</font><font color="#CCCCCC"> the tag responds with</font><font color="#E5E5E5"> its UID</font><font color="#CCCCCC"> in</font>

239
00:09:43,390 --> 00:09:47,680
clear<font color="#E5E5E5"> because there's no</font><font color="#CCCCCC"> established</font>

240
00:09:45,250 --> 00:09:49,990
creds at that point but<font color="#E5E5E5"> at</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> point</font>

241
00:09:47,680 --> 00:09:51,880
<font color="#E5E5E5">things</font><font color="#CCCCCC"> acedia the the encryption system</font>

242
00:09:49,990 --> 00:09:54,160
exists and the reader sends the

243
00:09:51,880 --> 00:09:56,500
encrypted<font color="#E5E5E5"> nonce and the encrypted</font>

244
00:09:54,160 --> 00:09:58,510
<font color="#CCCCCC">challenge response value</font><font color="#E5E5E5"> to the tag the</font>

245
00:09:56,500 --> 00:10:00,040
tag responds with an encrypted page<font color="#E5E5E5"> 3</font>

246
00:09:58,510 --> 00:10:01,930
there<font color="#CCCCCC"> was the reader can</font><font color="#E5E5E5"> then send</font>

247
00:10:00,040 --> 00:10:03,250
encrypted commands<font color="#E5E5E5"> and her can then</font>

248
00:10:01,930 --> 00:10:05,079
respond<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the encrypted responses</font>

249
00:10:03,250 --> 00:10:07,810
right so the whole thing<font color="#E5E5E5"> is much more</font>

250
00:10:05,080 --> 00:10:10,620
<font color="#E5E5E5">encrypted</font><font color="#CCCCCC"> this is kind of how</font><font color="#E5E5E5"> it looks</font>

251
00:10:07,810 --> 00:10:13,329
<font color="#CCCCCC">in terms</font><font color="#E5E5E5"> of what data is needed where</font>

252
00:10:10,620 --> 00:10:15,250
the reader has the key and the<font color="#CCCCCC"> nonce and</font>

253
00:10:13,330 --> 00:10:18,280
<font color="#E5E5E5">receives</font><font color="#CCCCCC"> UID from the tag and from that</font>

254
00:10:15,250 --> 00:10:21,040
<font color="#CCCCCC">it seeds and randomizes its PRNG equally</font>

255
00:10:18,280 --> 00:10:23,350
the tag has the same data<font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses that</font>

256
00:10:21,040 --> 00:10:25,810
to seed and<font color="#E5E5E5"> randomize its PRNG</font>

257
00:10:23,350 --> 00:10:28,300
and then both<font color="#CCCCCC"> PRN</font><font color="#E5E5E5"> G's end up being</font>

258
00:10:25,810 --> 00:10:30,670
<font color="#CCCCCC">exactly the</font><font color="#E5E5E5"> same position</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> exactly</font>

259
00:10:28,300 --> 00:10:32,349
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same state this is a key thing that</font>

260
00:10:30,670 --> 00:10:35,650
<font color="#E5E5E5">I keep forgetting to say when I give</font>

261
00:10:32,350 --> 00:10:37,510
this<font color="#E5E5E5"> talk but if the</font><font color="#CCCCCC"> PIO energies are</font>

262
00:10:35,650 --> 00:10:39,459
exactly<font color="#CCCCCC"> at exactly the same position</font>

263
00:10:37,510 --> 00:10:42,390
seeded<font color="#CCCCCC"> with and randomized with the same</font>

264
00:10:39,460 --> 00:10:45,550
data<font color="#CCCCCC"> they will</font><font color="#E5E5E5"> then check out the same</font>

265
00:10:42,390 --> 00:10:46,750
randomized binary stream<font color="#CCCCCC"> ok and that's</font>

266
00:10:45,550 --> 00:10:49,060
important because<font color="#E5E5E5"> that's how you use</font>

267
00:10:46,750 --> 00:10:50,980
them<font color="#E5E5E5"> in a stream cipher so for example</font>

268
00:10:49,060 --> 00:10:53,530
if the reader wanted to encrypt some

269
00:10:50,980 --> 00:10:56,140
data to<font color="#E5E5E5"> send to the tag it would say I</font>

270
00:10:53,530 --> 00:10:58,930
<font color="#E5E5E5">would have encrypt 32 bits of data</font>

271
00:10:56,140 --> 00:11:03,040
I'll get 32 bits of randomness from<font color="#E5E5E5"> my</font>

272
00:10:58,930 --> 00:11:04,839
<font color="#E5E5E5">PNG and XOR that with my data and send</font>

273
00:11:03,040 --> 00:11:07,870
it to<font color="#E5E5E5"> the tag and the tag</font>

274
00:11:04,840 --> 00:11:10,480
go<font color="#E5E5E5"> to its PRNG and go</font><font color="#CCCCCC"> I want 32 bits of</font>

275
00:11:07,870 --> 00:11:12,520
<font color="#E5E5E5">data</font><font color="#CCCCCC"> and it would get the same 32 bits</font>

276
00:11:10,480 --> 00:11:14,830
<font color="#E5E5E5">that the reader got because they're in</font>

277
00:11:12,520 --> 00:11:16,120
the same state<font color="#E5E5E5"> it can then XOR that with</font>

278
00:11:14,830 --> 00:11:18,430
the date<font color="#E5E5E5"> where it's received and</font><font color="#CCCCCC"> that</font>

279
00:11:16,120 --> 00:11:21,010
will give<font color="#CCCCCC"> it back</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> plaintext</font><font color="#E5E5E5"> this is</font>

280
00:11:18,430 --> 00:11:22,239
a key thing to<font color="#CCCCCC"> how this attack</font><font color="#E5E5E5"> or the</font>

281
00:11:21,010 --> 00:11:25,300
first<font color="#E5E5E5"> attack that I'm going to talk</font>

282
00:11:22,240 --> 00:11:27,610
about<font color="#E5E5E5"> works so stream ciphers if</font><font color="#CCCCCC"> you</font>

283
00:11:25,300 --> 00:11:30,579
aren't aware<font color="#E5E5E5"> are basically</font><font color="#CCCCCC"> exo-m with</font><font color="#E5E5E5"> a</font>

284
00:11:27,610 --> 00:11:33,220
<font color="#CCCCCC">Pat stream</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> verses</font><font color="#E5E5E5"> are rubbish they're</font>

285
00:11:30,580 --> 00:11:35,590
<font color="#E5E5E5">awful please don't use them don't take</font>

286
00:11:33,220 --> 00:11:39,430
any of this as examples<font color="#E5E5E5"> of ways you</font>

287
00:11:35,590 --> 00:11:41,230
<font color="#CCCCCC">should build systems but the the amateur</font>

288
00:11:39,430 --> 00:11:43,150
cryptographer sat next to you will tell

289
00:11:41,230 --> 00:11:47,530
you<font color="#E5E5E5"> that the only secure cipher in the</font>

290
00:11:43,150 --> 00:11:49,260
world is a one-time pad and it's not

291
00:11:47,530 --> 00:11:54,370
<font color="#E5E5E5">because it has no integrity protection</font>

292
00:11:49,260 --> 00:11:57,280
<font color="#CCCCCC">so</font><font color="#E5E5E5"> I can own the one-time pad</font><font color="#CCCCCC"> and with</font>

293
00:11:54,370 --> 00:11:58,660
certain caveats<font color="#E5E5E5"> anyway let's talk about</font>

294
00:11:57,280 --> 00:12:01,839
the<font color="#E5E5E5"> hi-tech to pure energy and</font>

295
00:11:58,660 --> 00:12:03,189
<font color="#CCCCCC">encryption so the high</font><font color="#E5E5E5"> tech to pure</font>

296
00:12:01,840 --> 00:12:05,560
energy<font color="#E5E5E5"> is based on a linear feedback</font>

297
00:12:03,190 --> 00:12:07,420
shift register that<font color="#E5E5E5"> is 48 bits wide and</font>

298
00:12:05,560 --> 00:12:09,670
it is initially<font color="#E5E5E5"> seeded with the 32 bit</font>

299
00:12:07,420 --> 00:12:12,040
you read which is<font color="#E5E5E5"> from the page</font><font color="#CCCCCC"> zero of</font>

300
00:12:09,670 --> 00:12:13,540
the tag and the first 16 bits of the key

301
00:12:12,040 --> 00:12:19,930
which<font color="#E5E5E5"> obviously the tag and the reader</font>

302
00:12:13,540 --> 00:12:22,780
both know next up the reader in invents

303
00:12:19,930 --> 00:12:24,040
a nonce<font color="#E5E5E5"> a 32 bit value which is could</font><font color="#CCCCCC"> be</font>

304
00:12:22,780 --> 00:12:26,050
<font color="#E5E5E5">properly random it should be probably</font>

305
00:12:24,040 --> 00:12:27,939
<font color="#E5E5E5">random and it</font><font color="#CCCCCC"> excells that</font><font color="#E5E5E5"> with the</font>

306
00:12:26,050 --> 00:12:30,219
upper 32 bits<font color="#E5E5E5"> of the key and then it</font>

307
00:12:27,940 --> 00:12:33,970
<font color="#CCCCCC">pushes that in one bit of time into the</font>

308
00:12:30,220 --> 00:12:37,270
lfsr<font color="#E5E5E5"> as it extracts bits of output from</font>

309
00:12:33,970 --> 00:12:40,180
the lfsr those bits it extracts from<font color="#E5E5E5"> the</font>

310
00:12:37,270 --> 00:12:41,949
lfsr<font color="#E5E5E5"> it uses to encrypt the nonce by</font>

311
00:12:40,180 --> 00:12:44,170
<font color="#E5E5E5">echoing each bit of the odds with the</font>

312
00:12:41,950 --> 00:12:46,150
next bit of<font color="#E5E5E5"> the output from the lfsr</font>

313
00:12:44,170 --> 00:12:50,319
which<font color="#CCCCCC"> creates</font><font color="#E5E5E5"> the encrypted nonce which</font>

314
00:12:46,150 --> 00:12:52,420
it<font color="#CCCCCC"> then sends to the tag the tag can</font>

315
00:12:50,320 --> 00:12:54,010
then do the<font color="#E5E5E5"> same</font><font color="#CCCCCC"> thing so</font><font color="#E5E5E5"> it gets the</font>

316
00:12:52,420 --> 00:12:55,630
output<font color="#E5E5E5"> from its</font><font color="#CCCCCC"> PRNG</font>

317
00:12:54,010 --> 00:12:57,970
<font color="#E5E5E5">XOR that with</font><font color="#CCCCCC"> your plethora two</font><font color="#E5E5E5"> bits</font><font color="#CCCCCC"> of</font>

318
00:12:55,630 --> 00:12:59,320
<font color="#E5E5E5">the key and XOR that with the 32 bits of</font>

319
00:12:57,970 --> 00:13:00,580
the<font color="#E5E5E5"> encrypted not so of course you can't</font>

320
00:12:59,320 --> 00:13:02,320
do that<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> outside because you</font>

321
00:13:00,580 --> 00:13:03,760
don't<font color="#E5E5E5"> have 30 bits of</font><font color="#CCCCCC"> output for the</font><font color="#E5E5E5"> PNG</font>

322
00:13:02,320 --> 00:13:05,650
<font color="#E5E5E5">so you only have one bit</font><font color="#CCCCCC"> of output</font>

323
00:13:03,760 --> 00:13:07,810
<font color="#E5E5E5">that's this particular moment</font><font color="#CCCCCC"> in time</font>

324
00:13:05,650 --> 00:13:10,600
<font color="#E5E5E5">because you only have one state</font><font color="#CCCCCC"> that you</font>

325
00:13:07,810 --> 00:13:14,400
<font color="#CCCCCC">know so you take the first bit of</font><font color="#E5E5E5"> output</font>

326
00:13:10,600 --> 00:13:17,020
<font color="#E5E5E5">from your lfsr PNG XOR that with the</font>

327
00:13:14,400 --> 00:13:18,339
<font color="#E5E5E5">sixteenth bit of the key the first bit</font>

328
00:13:17,020 --> 00:13:19,870
of the<font color="#CCCCCC"> upper half</font><font color="#E5E5E5"> of the key</font>

329
00:13:18,339 --> 00:13:22,029
and<font color="#CCCCCC"> XO that were the</font><font color="#E5E5E5"> first bit of the</font>

330
00:13:19,870 --> 00:13:25,240
encrypted<font color="#E5E5E5"> nonce which will decrypt that</font>

331
00:13:22,029 --> 00:13:27,160
bit of the<font color="#E5E5E5"> nonce</font><font color="#CCCCCC"> exhort</font><font color="#E5E5E5"> with the key</font>

332
00:13:25,240 --> 00:13:29,620
which is<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> value that</font><font color="#E5E5E5"> you need to</font>

333
00:13:27,160 --> 00:13:31,269
push into the lfsr<font color="#E5E5E5"> so then pushes that</font>

334
00:13:29,620 --> 00:13:33,459
value in which shifts the<font color="#CCCCCC"> hole of an</font>

335
00:13:31,269 --> 00:13:36,939
lfsr by one<font color="#E5E5E5"> bit at which point you</font><font color="#CCCCCC"> can</font>

336
00:13:33,459 --> 00:13:39,008
<font color="#CCCCCC">then generate the</font><font color="#E5E5E5"> next bit of output XOR</font>

337
00:13:36,939 --> 00:13:40,509
that with the next bit of<font color="#E5E5E5"> the key XOR</font>

338
00:13:39,009 --> 00:13:42,759
that with the next<font color="#E5E5E5"> bit of the encrypted</font>

339
00:13:40,509 --> 00:13:44,410
<font color="#E5E5E5">nonce to decrypt it XOR</font><font color="#CCCCCC"> with the key</font>

340
00:13:42,759 --> 00:13:46,899
which happens to be<font color="#E5E5E5"> the value</font><font color="#CCCCCC"> that you</font>

341
00:13:44,410 --> 00:13:48,550
then push in it's a really neat scheme

342
00:13:46,899 --> 00:13:50,769
and when you've<font color="#CCCCCC"> done</font><font color="#E5E5E5"> it all both the</font>

343
00:13:48,550 --> 00:13:54,490
<font color="#CCCCCC">reader and</font><font color="#E5E5E5"> the tag end up in exactly the</font>

344
00:13:50,769 --> 00:13:57,579
same<font color="#E5E5E5"> state it's not secure but I really</font>

345
00:13:54,490 --> 00:14:00,220
<font color="#E5E5E5">like it it's kind of cool all right</font><font color="#CCCCCC"> it's</font>

346
00:13:57,579 --> 00:14:01,989
like how did<font color="#E5E5E5"> decrypt and seed your lfsr</font>

347
00:14:00,220 --> 00:14:07,660
<font color="#E5E5E5">at the same time it's like this it's a</font>

348
00:14:01,990 --> 00:14:09,550
neat thing<font color="#E5E5E5"> it's just not secure okay</font><font color="#CCCCCC"> for</font>

349
00:14:07,660 --> 00:14:11,110
<font color="#E5E5E5">really complicated mathematical reasons</font>

350
00:14:09,550 --> 00:14:15,309
that I can't even go into in this talk

351
00:14:11,110 --> 00:14:17,139
<font color="#CCCCCC">but it is but</font><font color="#E5E5E5"> it's not so good I will</font>

352
00:14:15,309 --> 00:14:18,490
say if you're<font color="#E5E5E5"> interested by the time I</font>

353
00:14:17,139 --> 00:14:19,899
get<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> end of this I'll</font><font color="#CCCCCC"> be putting</font>

354
00:14:18,490 --> 00:14:23,769
<font color="#E5E5E5">you at a github where you can find all</font>

355
00:14:19,899 --> 00:14:25,779
the other<font color="#E5E5E5"> code right other attacks</font><font color="#CCCCCC"> that</font>

356
00:14:23,769 --> 00:14:27,819
<font color="#E5E5E5">I've implemented</font><font color="#CCCCCC"> from the academic</font>

357
00:14:25,779 --> 00:14:30,069
papers<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I say none of this is my</font>

358
00:14:27,819 --> 00:14:31,809
invention I've literally just<font color="#CCCCCC"> coded up</font>

359
00:14:30,069 --> 00:14:34,509
what they've said in maths<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Turnitin</font>

360
00:14:31,809 --> 00:14:37,240
<font color="#CCCCCC">see right but other attacks use that</font>

361
00:14:34,509 --> 00:14:40,749
fact to completely break the crypto

362
00:14:37,240 --> 00:14:42,910
really really quickly<font color="#E5E5E5"> so it is worth</font>

363
00:14:40,749 --> 00:14:44,259
bearing<font color="#E5E5E5"> in mind anyway so after the tag</font>

364
00:14:42,910 --> 00:14:46,749
<font color="#E5E5E5">and the read we've got to that state</font>

365
00:14:44,259 --> 00:14:48,370
<font color="#E5E5E5">they have no more randomization or</font>

366
00:14:46,749 --> 00:14:50,139
seeding information they need<font color="#CCCCCC"> to</font>

367
00:14:48,370 --> 00:14:53,410
continually be able to shift through<font color="#E5E5E5"> the</font>

368
00:14:50,139 --> 00:14:55,929
<font color="#E5E5E5">lfsr and invent new bits that get pushed</font>

369
00:14:53,410 --> 00:14:58,689
in as the thing ships<font color="#E5E5E5"> well they use the</font>

370
00:14:55,929 --> 00:15:01,480
feedback function<font color="#CCCCCC"> l to generate the new</font>

371
00:14:58,689 --> 00:15:02,699
bit so it takes the lfsr state and

372
00:15:01,480 --> 00:15:05,949
generates one bit

373
00:15:02,699 --> 00:15:07,779
and so when you encrypt<font color="#E5E5E5"> it kind of looks</font>

374
00:15:05,949 --> 00:15:08,410
like this<font color="#CCCCCC"> literally you get output for</font>

375
00:15:07,779 --> 00:15:10,179
the<font color="#CCCCCC"> PRNG</font>

376
00:15:08,410 --> 00:15:12,429
XOR that with your data and<font color="#CCCCCC"> that</font>

377
00:15:10,179 --> 00:15:14,160
<font color="#E5E5E5">produces the encrypted data</font><font color="#CCCCCC"> that's a</font>

378
00:15:12,429 --> 00:15:16,929
<font color="#E5E5E5">it's a it's a stream cipher and the</font>

379
00:15:14,160 --> 00:15:19,629
<font color="#CCCCCC">receiver can do exactly</font><font color="#E5E5E5"> the same thing</font>

380
00:15:16,929 --> 00:15:21,670
<font color="#E5E5E5">the function</font><font color="#CCCCCC"> L will produce exactly the</font>

381
00:15:19,629 --> 00:15:23,019
same stream of bits based on the state

382
00:15:21,670 --> 00:15:25,569
<font color="#CCCCCC">that you started with so it gets the</font>

383
00:15:23,019 --> 00:15:27,339
same<font color="#CCCCCC"> PNG</font><font color="#E5E5E5"> output</font><font color="#CCCCCC"> it can XOR that with the</font>

384
00:15:25,569 --> 00:15:29,139
encrypted data that you've just received

385
00:15:27,339 --> 00:15:30,490
<font color="#E5E5E5">and that will return it back</font><font color="#CCCCCC"> to the</font>

386
00:15:29,139 --> 00:15:31,810
plaintext<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then you have the</font>

387
00:15:30,490 --> 00:15:34,449
plaintext<font color="#CCCCCC"> data</font>

388
00:15:31,810 --> 00:15:37,029
the feedback<font color="#E5E5E5"> function if</font><font color="#CCCCCC"> you care looks</font>

389
00:15:34,449 --> 00:15:40,540
like this is literally the XOR<font color="#CCCCCC"> of</font><font color="#E5E5E5"> 16</font>

390
00:15:37,029 --> 00:15:43,689
bits of the<font color="#E5E5E5"> lfsr so the lfsr</font><font color="#CCCCCC"> is 48 bits</font>

391
00:15:40,540 --> 00:15:45,160
<font color="#CCCCCC">wide it takes</font><font color="#E5E5E5"> 16 of those XOR them all</font>

392
00:15:43,689 --> 00:15:46,748
together and<font color="#CCCCCC"> that</font><font color="#E5E5E5"> produces one bit of</font>

393
00:15:45,160 --> 00:15:48,519
<font color="#CCCCCC">output</font><font color="#E5E5E5"> that is</font><font color="#CCCCCC"> the new bit that gets</font>

394
00:15:46,749 --> 00:15:51,399
shifted in so if you<font color="#E5E5E5"> don't know the</font>

395
00:15:48,519 --> 00:15:52,870
entire<font color="#E5E5E5"> lfsr state there's a good chance</font>

396
00:15:51,399 --> 00:15:57,189
you<font color="#E5E5E5"> don't know the new bit that's</font>

397
00:15:52,870 --> 00:15:59,740
getting pushed in and the output of the

398
00:15:57,189 --> 00:16:01,449
lfsr<font color="#CCCCCC"> the</font><font color="#E5E5E5"> PNG is not just a bit that</font>

399
00:15:59,740 --> 00:16:03,339
falls off the<font color="#E5E5E5"> right-hand side when you</font>

400
00:16:01,449 --> 00:16:05,920
push<font color="#E5E5E5"> it through</font><font color="#CCCCCC"> it's actually generated</font>

401
00:16:03,339 --> 00:16:07,749
with a filter<font color="#CCCCCC"> function and that</font><font color="#E5E5E5"> thought</font>

402
00:16:05,920 --> 00:16:09,579
<font color="#CCCCCC">of function is based on functions a</font><font color="#E5E5E5"> B</font>

403
00:16:07,749 --> 00:16:12,100
and<font color="#E5E5E5"> C in this kind of arrangement so</font>

404
00:16:09,579 --> 00:16:15,219
fill functions a and<font color="#E5E5E5"> B take four bits</font>

405
00:16:12,100 --> 00:16:18,730
each from the lfsr<font color="#E5E5E5"> and produce one bit</font>

406
00:16:15,220 --> 00:16:20,589
of output<font color="#E5E5E5"> and those</font><font color="#CCCCCC"> five single bits of</font>

407
00:16:18,730 --> 00:16:22,269
output get pushed into function<font color="#E5E5E5"> C and</font>

408
00:16:20,589 --> 00:16:24,939
<font color="#E5E5E5">that produces one bit of</font><font color="#CCCCCC"> output</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font>

409
00:16:22,269 --> 00:16:28,389
<font color="#E5E5E5">is your</font><font color="#CCCCCC"> output each of functions eight</font><font color="#E5E5E5"> B</font>

410
00:16:24,939 --> 00:16:30,160
and<font color="#E5E5E5"> C are biased</font><font color="#CCCCCC"> 5050 which means if you</font>

411
00:16:28,389 --> 00:16:31,839
<font color="#E5E5E5">don't know the input you can't predict</font>

412
00:16:30,160 --> 00:16:33,969
the output<font color="#E5E5E5"> with any confidence either</font>

413
00:16:31,839 --> 00:16:37,329
way there's a<font color="#E5E5E5"> 50% chance of getting</font><font color="#CCCCCC"> a 1</font>

414
00:16:33,970 --> 00:16:39,189
<font color="#CCCCCC">or 50% chance of</font><font color="#E5E5E5"> getting a 0 so looking</font>

415
00:16:37,329 --> 00:16:41,500
at that<font color="#E5E5E5"> you'd think yeah that seems</font>

416
00:16:39,189 --> 00:16:43,360
pretty cool<font color="#E5E5E5"> pretty pretty secure right</font>

417
00:16:41,500 --> 00:16:43,809
you know how could<font color="#E5E5E5"> you guess this sort</font>

418
00:16:43,360 --> 00:16:45,459
of stuff

419
00:16:43,809 --> 00:16:48,639
well you look at some of<font color="#CCCCCC"> the other</font>

420
00:16:45,459 --> 00:16:50,290
attacks<font color="#CCCCCC"> Dave those academics are quite</font>

421
00:16:48,639 --> 00:16:53,199
clever<font color="#E5E5E5"> there's ways of breaking these</font>

422
00:16:50,290 --> 00:16:54,849
<font color="#E5E5E5">things that I've implemented you can</font>

423
00:16:53,199 --> 00:16:57,430
look read the<font color="#E5E5E5"> C to understand how it</font>

424
00:16:54,850 --> 00:17:00,579
<font color="#E5E5E5">works so if we go</font><font color="#CCCCCC"> back to</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> slide</font><font color="#E5E5E5"> about</font>

425
00:16:57,430 --> 00:17:03,459
how crypto<font color="#E5E5E5"> Mode worked it sends the</font>

426
00:17:00,579 --> 00:17:05,049
start off the tag responds with<font color="#E5E5E5"> its UID</font>

427
00:17:03,459 --> 00:17:05,970
<font color="#E5E5E5">the reader sends the encrypted knowledge</font>

428
00:17:05,049 --> 00:17:07,599
so he sends the encrypted

429
00:17:05,970 --> 00:17:09,370
<font color="#CCCCCC">challenge-response</font><font color="#E5E5E5"> value the tag</font>

430
00:17:07,599 --> 00:17:12,069
responds with its encrypted password and

431
00:17:09,369 --> 00:17:13,569
then<font color="#E5E5E5"> the reader sends encrypted commands</font>

432
00:17:12,069 --> 00:17:17,319
and the tag responds with the<font color="#E5E5E5"> encrypted</font>

433
00:17:13,569 --> 00:17:21,428
responses<font color="#CCCCCC"> so let's look</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> hi tag two</font>

434
00:17:17,319 --> 00:17:23,470
cards<font color="#CCCCCC"> a high-tech two command is only 5</font>

435
00:17:21,429 --> 00:17:25,689
bits long the first two bits determine

436
00:17:23,470 --> 00:17:29,020
which commander is from read read page

437
00:17:25,689 --> 00:17:31,450
rewrite page will halt<font color="#E5E5E5"> and the following</font>

438
00:17:29,020 --> 00:17:32,770
<font color="#CCCCCC">three bits determine which page of</font><font color="#E5E5E5"> data</font>

439
00:17:31,450 --> 00:17:36,010
we care about<font color="#E5E5E5"> so if we're trying to read</font>

440
00:17:32,770 --> 00:17:37,330
a page or<font color="#E5E5E5"> write a page those</font><font color="#CCCCCC"> three bits</font>

441
00:17:36,010 --> 00:17:39,760
will tell you which page we care about

442
00:17:37,330 --> 00:17:41,559
read page inverted is essentially read

443
00:17:39,760 --> 00:17:44,960
page but every bit that<font color="#E5E5E5"> comes back is</font>

444
00:17:41,559 --> 00:17:48,799
inverted<font color="#E5E5E5"> fair</font><font color="#CCCCCC"> enough and halt</font>

445
00:17:44,960 --> 00:17:50,630
<font color="#CCCCCC">to tag off until it leaves the RF field</font>

446
00:17:48,799 --> 00:17:53,629
and comes back into<font color="#E5E5E5"> it again</font><font color="#CCCCCC"> and the</font>

447
00:17:50,630 --> 00:17:55,520
reason<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> a use case of</font>

448
00:17:53,630 --> 00:17:58,399
<font color="#CCCCCC">where</font><font color="#E5E5E5"> that's usually used I should say</font>

449
00:17:55,520 --> 00:18:01,820
is in Las<font color="#E5E5E5"> Vegas casinos where every chip</font>

450
00:17:58,399 --> 00:18:06,260
has one of these<font color="#E5E5E5"> tags inside it and the</font>

451
00:18:01,820 --> 00:18:08,629
entire<font color="#CCCCCC"> table is circulated by an</font><font color="#E5E5E5"> rfid</font>

452
00:18:06,260 --> 00:18:10,460
field<font color="#E5E5E5"> and therefore they can track every</font>

453
00:18:08,630 --> 00:18:15,200
tag being on the table<font color="#CCCCCC"> or not on the</font>

454
00:18:10,460 --> 00:18:18,020
<font color="#E5E5E5">table so when you set your field up and</font>

455
00:18:15,200 --> 00:18:21,380
you kind of go start off<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first or</font>

456
00:18:18,020 --> 00:18:23,270
fastest or loudest<font color="#E5E5E5"> tag will respond and</font>

457
00:18:21,380 --> 00:18:25,070
<font color="#E5E5E5">that'll be the one that the field hears</font>

458
00:18:23,270 --> 00:18:27,110
and then the field will then communicate

459
00:18:25,070 --> 00:18:28,279
with<font color="#E5E5E5"> that one or all the other tags will</font>

460
00:18:27,110 --> 00:18:29,750
ignore the communications because<font color="#E5E5E5"> they</font>

461
00:18:28,279 --> 00:18:31,490
don't meet the<font color="#E5E5E5"> integrity checks that</font>

462
00:18:29,750 --> 00:18:33,080
I'll come to in a minute<font color="#CCCCCC"> and when it's</font>

463
00:18:31,490 --> 00:18:35,390
<font color="#CCCCCC">finished talking</font><font color="#E5E5E5"> to that tag it then</font>

464
00:18:33,080 --> 00:18:37,370
<font color="#CCCCCC">sense</font><font color="#E5E5E5"> the whole command which shuts that</font>

465
00:18:35,390 --> 00:18:39,590
tag down while it's still in the field

466
00:18:37,370 --> 00:18:42,830
<font color="#E5E5E5">and then it does a start off and the</font>

467
00:18:39,590 --> 00:18:45,860
next loudest<font color="#E5E5E5"> or closest</font><font color="#CCCCCC"> door or noisiest</font>

468
00:18:42,830 --> 00:18:47,330
tag will respond<font color="#E5E5E5"> and it will talk to</font>

469
00:18:45,860 --> 00:18:48,799
that<font color="#E5E5E5"> one and it can cycle through</font><font color="#CCCCCC"> all</font>

470
00:18:47,330 --> 00:18:51,350
<font color="#E5E5E5">the tags within the field so</font><font color="#CCCCCC"> you can</font>

471
00:18:48,799 --> 00:18:53,389
talk to multiple<font color="#CCCCCC"> tags</font><font color="#E5E5E5"> within</font><font color="#CCCCCC"> a single</font>

472
00:18:51,350 --> 00:18:58,279
<font color="#CCCCCC">field using this because you can halt</font>

473
00:18:53,390 --> 00:19:00,020
<font color="#CCCCCC">the loudest ones first I mean so if you</font>

474
00:18:58,279 --> 00:19:02,860
want to<font color="#E5E5E5"> use this in a</font><font color="#CCCCCC"> really hostile</font>

475
00:19:00,020 --> 00:19:06,710
environment take<font color="#E5E5E5"> is Las Vegas</font>

476
00:19:02,860 --> 00:19:08,629
apparently they use this stuff now<font color="#E5E5E5"> so</font>

477
00:19:06,710 --> 00:19:11,539
<font color="#CCCCCC">high-tech two commands are five bits</font>

478
00:19:08,630 --> 00:19:13,100
long<font color="#CCCCCC"> but in actual fact in a practical</font>

479
00:19:11,539 --> 00:19:15,200
level when you send them they're

480
00:19:13,100 --> 00:19:18,110
<font color="#CCCCCC">actually ten bits</font><font color="#E5E5E5"> long so it's the first</font>

481
00:19:15,200 --> 00:19:21,110
five bits<font color="#E5E5E5"> followed by that five bits</font>

482
00:19:18,110 --> 00:19:24,918
inverted so a<font color="#CCCCCC"> 0 goes to a 1 1 goes to 0</font>

483
00:19:21,110 --> 00:19:28,070
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so 1 0 1</font><font color="#E5E5E5"> 1 1 inverted becomes 0 1</font>

484
00:19:24,919 --> 00:19:30,289
0 0 0<font color="#E5E5E5"> and</font><font color="#CCCCCC"> so actual command</font><font color="#E5E5E5"> the minimum</font>

485
00:19:28,070 --> 00:19:32,539
size it can really be<font color="#CCCCCC"> is</font><font color="#E5E5E5"> 10 bits this</font>

486
00:19:30,289 --> 00:19:34,850
provides<font color="#CCCCCC"> integrity check in now</font><font color="#E5E5E5"> if</font>

487
00:19:32,539 --> 00:19:37,940
you're<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to read a table</font><font color="#E5E5E5"> or maybe</font>

488
00:19:34,850 --> 00:19:40,399
<font color="#E5E5E5">we're front of write a page and the</font>

489
00:19:37,940 --> 00:19:42,230
<font color="#CCCCCC">right page command</font><font color="#E5E5E5"> gets corrupted and</font>

490
00:19:40,399 --> 00:19:44,418
you accidentally write<font color="#E5E5E5"> the wrong page</font>

491
00:19:42,230 --> 00:19:48,169
that could<font color="#E5E5E5"> be quite</font><font color="#CCCCCC"> devastating in some</font>

492
00:19:44,419 --> 00:19:50,390
kind<font color="#CCCCCC"> of industrial situation so with</font>

493
00:19:48,169 --> 00:19:52,520
this the same bit would have to be like

494
00:19:50,390 --> 00:19:54,980
corrupted in<font color="#E5E5E5"> the first 5 bits and the</font>

495
00:19:52,520 --> 00:19:56,870
second<font color="#CCCCCC"> 5 bits for it to pass</font><font color="#E5E5E5"> the</font>

496
00:19:54,980 --> 00:19:58,759
<font color="#E5E5E5">integrity check they basically checks</font>

497
00:19:56,870 --> 00:20:01,958
that each block<font color="#E5E5E5"> needs to be the</font>

498
00:19:58,759 --> 00:20:04,399
verse of the<font color="#CCCCCC"> preceding block right</font><font color="#E5E5E5"> but</font>

499
00:20:01,959 --> 00:20:06,559
extended wise<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> have as many</font><font color="#E5E5E5"> of</font>

500
00:20:04,399 --> 00:20:08,059
these blocks as you like<font color="#E5E5E5"> as long</font><font color="#CCCCCC"> as</font>

501
00:20:06,559 --> 00:20:10,489
<font color="#E5E5E5">every block is the inverse of the</font>

502
00:20:08,059 --> 00:20:12,469
<font color="#E5E5E5">preceding block so you could have</font><font color="#CCCCCC"> 20</font>

503
00:20:10,489 --> 00:20:14,149
blocks<font color="#E5E5E5"> as long as it goes normal inverse</font>

504
00:20:12,469 --> 00:20:17,119
normal inverse normal inverse normal

505
00:20:14,149 --> 00:20:20,359
universe<font color="#E5E5E5"> which apparently adds to the</font>

506
00:20:17,119 --> 00:20:22,968
<font color="#E5E5E5">integrity what it actually does is</font>

507
00:20:20,359 --> 00:20:26,029
creates a hole through<font color="#CCCCCC"> which we can</font>

508
00:20:22,969 --> 00:20:27,919
attack the system<font color="#E5E5E5"> so let's talk about</font>

509
00:20:26,029 --> 00:20:31,429
attacks<font color="#CCCCCC"> and we're going to talk only</font>

510
00:20:27,919 --> 00:20:34,819
about<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first attack</font><font color="#E5E5E5"> but the academic</font>

511
00:20:31,429 --> 00:20:37,279
<font color="#CCCCCC">paper from 2012</font><font color="#E5E5E5"> has three attacks in it</font>

512
00:20:34,819 --> 00:20:40,729
<font color="#E5E5E5">I've implemented all three I'm going to</font>

513
00:20:37,279 --> 00:20:43,940
talk about<font color="#E5E5E5"> the first one</font><font color="#CCCCCC"> the Flavio</font>

514
00:20:40,729 --> 00:20:48,109
Garcia then went on and another<font color="#E5E5E5"> paper in</font>

515
00:20:43,940 --> 00:20:53,479
2016<font color="#E5E5E5"> which has a new attack which</font><font color="#CCCCCC"> is</font>

516
00:20:48,109 --> 00:20:55,779
much faster<font color="#CCCCCC"> vincent Imbler produced a</font>

517
00:20:53,479 --> 00:20:59,119
<font color="#E5E5E5">GPU based attack that took 11 hours</font>

518
00:20:55,779 --> 00:21:01,940
<font color="#CCCCCC">brute-force in 2012</font><font color="#E5E5E5"> and last year</font><font color="#CCCCCC"> Talas</font>

519
00:20:59,119 --> 00:21:03,559
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> French government produced an</font>

520
00:21:01,940 --> 00:21:05,779
optimized version that would work on

521
00:21:03,559 --> 00:21:09,229
Amazon using<font color="#E5E5E5"> multiple GPUs multiple</font>

522
00:21:05,779 --> 00:21:12,259
<font color="#E5E5E5">hosts and I know just got word only</font><font color="#CCCCCC"> last</font>

523
00:21:09,229 --> 00:21:14,239
week<font color="#CCCCCC"> that one of the other</font><font color="#E5E5E5"> authors</font><font color="#CCCCCC"> of</font>

524
00:21:12,259 --> 00:21:15,589
the first paper produced<font color="#E5E5E5"> a new paper</font>

525
00:21:14,239 --> 00:21:18,529
last year<font color="#E5E5E5"> that can attack the whole</font>

526
00:21:15,589 --> 00:21:21,139
thing in like say<font color="#CCCCCC"> 30 seconds</font><font color="#E5E5E5"> or</font>

527
00:21:18,529 --> 00:21:22,669
something<font color="#CCCCCC"> some some incredible another</font>

528
00:21:21,139 --> 00:21:25,158
attack<font color="#CCCCCC"> that I now need to go and read</font>

529
00:21:22,669 --> 00:21:26,959
<font color="#CCCCCC">about just for</font><font color="#E5E5E5"> completeness to satisfy</font>

530
00:21:25,159 --> 00:21:28,159
my OCD<font color="#E5E5E5"> but</font><font color="#CCCCCC"> basically there's lots of</font>

531
00:21:26,959 --> 00:21:30,889
<font color="#E5E5E5">ways of attacking these things</font><font color="#CCCCCC"> I'm going</font>

532
00:21:28,159 --> 00:21:32,599
<font color="#CCCCCC">to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about one the one I want</font><font color="#E5E5E5"> to talk</font>

533
00:21:30,889 --> 00:21:35,149
about is the nonce replay and length

534
00:21:32,599 --> 00:21:37,908
<font color="#CCCCCC">extension for Keith's dream recovery</font>

535
00:21:35,149 --> 00:21:39,799
attack<font color="#E5E5E5"> it's a long sentence but it's</font>

536
00:21:37,909 --> 00:21:42,440
<font color="#E5E5E5">really straightforward</font><font color="#CCCCCC"> honest is</font><font color="#E5E5E5"> we're</font>

537
00:21:39,799 --> 00:21:45,168
going<font color="#CCCCCC"> to replay a nonce several times</font>

538
00:21:42,440 --> 00:21:46,759
<font color="#E5E5E5">and using that we're going to extend</font><font color="#CCCCCC"> the</font>

539
00:21:45,169 --> 00:21:48,709
amount<font color="#E5E5E5"> of</font><font color="#CCCCCC"> keystream that we can recover</font>

540
00:21:46,759 --> 00:21:52,759
<font color="#E5E5E5">until</font><font color="#CCCCCC"> we get enough keystream that we</font>

541
00:21:48,709 --> 00:21:54,440
can<font color="#E5E5E5"> then break the crypto so what you</font>

542
00:21:52,759 --> 00:21:57,409
might<font color="#E5E5E5"> have noticed when we were looking</font>

543
00:21:54,440 --> 00:21:59,749
<font color="#E5E5E5">at how these things work was</font><font color="#CCCCCC"> that all</font>

544
00:21:57,409 --> 00:22:03,109
the entropy<font color="#E5E5E5"> comes from the reader in the</font>

545
00:21:59,749 --> 00:22:05,959
<font color="#E5E5E5">form of the nonce</font><font color="#CCCCCC"> so if you have one tag</font>

546
00:22:03,109 --> 00:22:07,369
one high tag to tag it has a single UID

547
00:22:05,959 --> 00:22:09,769
<font color="#E5E5E5">on it and every time you present that to</font>

548
00:22:07,369 --> 00:22:11,988
<font color="#CCCCCC">a field you'll get the same</font><font color="#E5E5E5"> UID</font><font color="#CCCCCC"> so if</font>

549
00:22:09,769 --> 00:22:12,800
you stick<font color="#CCCCCC"> with one tag that UID is</font><font color="#E5E5E5"> not</font>

550
00:22:11,989 --> 00:22:16,309
going to<font color="#E5E5E5"> change</font>

551
00:22:12,800 --> 00:22:17,809
the key on it equally is not going to

552
00:22:16,309 --> 00:22:21,020
<font color="#E5E5E5">change because</font><font color="#CCCCCC"> it's the same key on the</font>

553
00:22:17,809 --> 00:22:23,210
entire system<font color="#CCCCCC"> and that is again fixed</font><font color="#E5E5E5"> so</font>

554
00:22:21,020 --> 00:22:24,770
nothing<font color="#E5E5E5"> on the tag is generating any</font>

555
00:22:23,210 --> 00:22:26,750
entropy<font color="#E5E5E5"> when you put it in the field</font>

556
00:22:24,770 --> 00:22:29,330
with the reader the reader takes<font color="#E5E5E5"> that in</font>

557
00:22:26,750 --> 00:22:30,800
seeds it and it generates<font color="#E5E5E5"> a nonce and</font>

558
00:22:29,330 --> 00:22:33,260
<font color="#E5E5E5">then it encrypts that nonce and sends it</font>

559
00:22:30,800 --> 00:22:35,090
<font color="#E5E5E5">to the tag and the nonce together with</font>

560
00:22:33,260 --> 00:22:36,140
the key in the UID<font color="#CCCCCC"> it's what's easier</font>

561
00:22:35,090 --> 00:22:39,860
PRNG

562
00:22:36,140 --> 00:22:44,809
right<font color="#E5E5E5"> so the only entropy is that nonce</font>

563
00:22:39,860 --> 00:22:49,250
so if we have a device such as one<font color="#CCCCCC"> of</font>

564
00:22:44,809 --> 00:22:52,250
the<font color="#CCCCCC"> EES perhaps and</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> Fiddler's and we</font>

565
00:22:49,250 --> 00:22:55,400
eavesdrop<font color="#CCCCCC"> on the communications</font><font color="#E5E5E5"> between</font>

566
00:22:52,250 --> 00:22:57,110
a tag<font color="#E5E5E5"> and the reader we could steal</font><font color="#CCCCCC"> an</font>

567
00:22:55,400 --> 00:22:59,030
encrypted<font color="#E5E5E5"> nonce and an encrypted</font>

568
00:22:57,110 --> 00:23:02,360
channels response<font color="#E5E5E5"> value</font><font color="#CCCCCC"> from that one</font>

569
00:22:59,030 --> 00:23:04,730
handshake and then in our little back

570
00:23:02,360 --> 00:23:06,830
<font color="#CCCCCC">smoky room somewhere else we could then</font>

571
00:23:04,730 --> 00:23:08,450
replay that nonce and<font color="#CCCCCC"> challenge/response</font>

572
00:23:06,830 --> 00:23:09,980
value over and over<font color="#E5E5E5"> and over again to</font>

573
00:23:08,450 --> 00:23:12,140
<font color="#E5E5E5">the tag and every time we will play it</font>

574
00:23:09,980 --> 00:23:14,750
the tag would reset to the exact same

575
00:23:12,140 --> 00:23:16,490
<font color="#CCCCCC">position each</font><font color="#E5E5E5"> time the same pure energy</font>

576
00:23:14,750 --> 00:23:19,070
<font color="#E5E5E5">position because it because all the</font>

577
00:23:16,490 --> 00:23:20,630
entropy<font color="#E5E5E5"> comes from that nonce</font><font color="#CCCCCC"> and the</font>

578
00:23:19,070 --> 00:23:23,059
challenges of fonts value just proves

579
00:23:20,630 --> 00:23:27,530
that<font color="#E5E5E5"> the nonce is a valid nonce</font>

580
00:23:23,059 --> 00:23:29,149
essentially<font color="#CCCCCC"> it</font><font color="#E5E5E5"> probably encrypted so if</font>

581
00:23:27,530 --> 00:23:31,220
you<font color="#E5E5E5"> remember that this</font><font color="#CCCCCC"> is the position</font>

582
00:23:29,150 --> 00:23:32,840
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the reader and the tag got into</font>

583
00:23:31,220 --> 00:23:35,750
<font color="#CCCCCC">after</font><font color="#E5E5E5"> they've receded and man demise</font>

584
00:23:32,840 --> 00:23:40,000
<font color="#E5E5E5">then we could</font><font color="#CCCCCC"> create</font><font color="#E5E5E5"> this an emulated</font>

585
00:23:35,750 --> 00:23:42,410
reader and pretend<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be a real reader</font>

586
00:23:40,000 --> 00:23:44,120
<font color="#E5E5E5">because all the reader has</font><font color="#CCCCCC"> to provide is</font>

587
00:23:42,410 --> 00:23:47,660
the<font color="#E5E5E5"> star Earth command which we know</font>

588
00:23:44,120 --> 00:23:49,159
from<font color="#CCCCCC"> this spec</font><font color="#E5E5E5"> the encrypted nonce</font><font color="#CCCCCC"> we</font>

589
00:23:47,660 --> 00:23:50,809
captured the encrypted<font color="#E5E5E5"> cell response</font>

590
00:23:49,160 --> 00:23:52,490
value<font color="#E5E5E5"> we captured and then it will get</font>

591
00:23:50,809 --> 00:23:54,649
<font color="#E5E5E5">back the encrypted page</font><font color="#CCCCCC"> free</font><font color="#E5E5E5"> from the</font>

592
00:23:52,490 --> 00:23:56,840
<font color="#CCCCCC">tag at which</font><font color="#E5E5E5"> point the tag will</font><font color="#CCCCCC"> be in a</font>

593
00:23:54,650 --> 00:23:58,660
particular<font color="#E5E5E5"> state and if we do</font><font color="#CCCCCC"> it again</font>

594
00:23:56,840 --> 00:24:00,949
<font color="#E5E5E5">it'll</font><font color="#CCCCCC"> be in exactly the same state and</font>

595
00:23:58,660 --> 00:24:02,630
<font color="#CCCCCC">however</font><font color="#E5E5E5"> many thousand times we do this</font>

596
00:24:00,950 --> 00:24:05,150
<font color="#E5E5E5">it will be in the same state each time</font>

597
00:24:02,630 --> 00:24:08,150
so for example if we gave<font color="#CCCCCC"> it the</font>

598
00:24:05,150 --> 00:24:11,450
encrypted<font color="#E5E5E5"> nonce</font><font color="#CCCCCC"> of for a eight five</font><font color="#E5E5E5"> B to</font>

599
00:24:08,150 --> 00:24:14,510
<font color="#E5E5E5">DF we might expect that PNG output of</font>

600
00:24:11,450 --> 00:24:17,809
<font color="#CCCCCC">over</font><font color="#E5E5E5"> no one more knows 0 0 0 1 1 1</font><font color="#CCCCCC"> 0 1</font><font color="#E5E5E5"> 0</font>

601
00:24:14,510 --> 00:24:19,580
<font color="#E5E5E5">zu zu right example and each time we</font>

602
00:24:17,809 --> 00:24:21,860
initialize<font color="#CCCCCC"> the tag with that same nonce</font>

603
00:24:19,580 --> 00:24:23,928
we would get that same<font color="#E5E5E5"> PNG output which</font>

604
00:24:21,860 --> 00:24:26,120
is<font color="#E5E5E5"> what is being</font><font color="#CCCCCC"> used to encrypt</font><font color="#E5E5E5"> the</font>

605
00:24:23,929 --> 00:24:28,640
stream of data

606
00:24:26,120 --> 00:24:29,870
it's it's kind of really<font color="#E5E5E5"> important to</font>

607
00:24:28,640 --> 00:24:32,360
<font color="#E5E5E5">understand how the</font><font color="#CCCCCC"> Nantes replay works</font>

608
00:24:29,870 --> 00:24:34,610
was<font color="#E5E5E5"> why I labor that point like so</font>

609
00:24:32,360 --> 00:24:35,959
strongly<font color="#E5E5E5"> so the way we're going to</font>

610
00:24:34,610 --> 00:24:38,270
attack this is we're going to try<font color="#CCCCCC"> and</font>

611
00:24:35,960 --> 00:24:40,130
find the read page<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> command right</font>

612
00:24:38,270 --> 00:24:42,590
because we<font color="#CCCCCC"> know the answer to page Simo</font>

613
00:24:40,130 --> 00:24:44,510
page 0 is the UID<font color="#CCCCCC"> right so we already</font>

614
00:24:42,590 --> 00:24:47,389
know what<font color="#E5E5E5"> answer we</font><font color="#CCCCCC"> should get</font><font color="#E5E5E5"> even</font>

615
00:24:44,510 --> 00:24:48,919
though it'll be encrypted<font color="#CCCCCC"> but if you're</font>

616
00:24:47,390 --> 00:24:51,140
working<font color="#E5E5E5"> for the position of something</font>

617
00:24:48,919 --> 00:24:54,650
<font color="#E5E5E5">you already know</font><font color="#CCCCCC"> attacking it is a lot</font>

618
00:24:51,140 --> 00:24:57,080
easier<font color="#CCCCCC"> now if an encrypted command is 10</font>

619
00:24:54,650 --> 00:24:58,760
bits long because a basic<font color="#CCCCCC"> command has to</font>

620
00:24:57,080 --> 00:24:59,990
<font color="#E5E5E5">be at least 10 bits long and then it</font>

621
00:24:58,760 --> 00:25:02,240
gets encrypted<font color="#E5E5E5"> to random noise</font>

622
00:24:59,990 --> 00:25:04,929
essentially then there's a thousand<font color="#E5E5E5"> 24</font>

623
00:25:02,240 --> 00:25:08,330
possibilities<font color="#E5E5E5"> and I have that there's 16</font>

624
00:25:04,929 --> 00:25:10,850
so you know correct answers<font color="#E5E5E5"> oh</font><font color="#CCCCCC"> oh no</font>

625
00:25:08,330 --> 00:25:14,990
which one will<font color="#CCCCCC"> be the read page 0</font>

626
00:25:10,850 --> 00:25:18,949
<font color="#CCCCCC">command so</font><font color="#E5E5E5"> we could search and search</font>

627
00:25:14,990 --> 00:25:21,500
and<font color="#E5E5E5"> search when you send and like</font>

628
00:25:18,950 --> 00:25:25,340
invalid command<font color="#CCCCCC"> you get this unencrypted</font>

629
00:25:21,500 --> 00:25:29,240
<font color="#E5E5E5">every response of</font><font color="#CCCCCC"> f4 o28 890</font><font color="#E5E5E5"> and it has</font>

630
00:25:25,340 --> 00:25:31,730
to<font color="#E5E5E5"> be unencrypted because the idea</font><font color="#CCCCCC"> is</font>

631
00:25:29,240 --> 00:25:34,159
that the reason it's gone wrong in the

632
00:25:31,730 --> 00:25:35,390
normal use case is because something's

633
00:25:34,159 --> 00:25:36,140
gone wrong with<font color="#E5E5E5"> the encryption if</font>

634
00:25:35,390 --> 00:25:38,179
something's gone wrong with<font color="#E5E5E5"> the</font>

635
00:25:36,140 --> 00:25:40,850
encryption you can't expect the tag to

636
00:25:38,179 --> 00:25:42,890
be able<font color="#E5E5E5"> to decrypt your encrypted error</font>

637
00:25:40,850 --> 00:25:44,689
response<font color="#CCCCCC"> therefore it</font><font color="#E5E5E5"> has to send an</font>

638
00:25:42,890 --> 00:25:47,450
unencrypted error response<font color="#E5E5E5"> value</font><font color="#CCCCCC"> and</font>

639
00:25:44,690 --> 00:25:50,600
it's<font color="#CCCCCC"> always the</font><font color="#E5E5E5"> same number so we can</font>

640
00:25:47,450 --> 00:25:52,850
use<font color="#E5E5E5"> that as a canary</font><font color="#CCCCCC"> in order</font><font color="#E5E5E5"> to work</font>

641
00:25:50,600 --> 00:25:54,049
out<font color="#E5E5E5"> or an Oracle in order to work out</font>

642
00:25:52,850 --> 00:25:56,149
<font color="#E5E5E5">whether we're sending the right commands</font>

643
00:25:54,049 --> 00:25:58,639
<font color="#E5E5E5">on so like one way of attacking this</font>

644
00:25:56,149 --> 00:26:00,020
would be to<font color="#CCCCCC"> we'll actually get a bit</font>

645
00:25:58,640 --> 00:26:04,760
flip but<font color="#E5E5E5"> I said one way of attacking</font>

646
00:26:00,020 --> 00:26:05,690
this would be to send<font color="#CCCCCC"> 1,024</font><font color="#E5E5E5"> all up to</font>

647
00:26:04,760 --> 00:26:07,908
1024

648
00:26:05,690 --> 00:26:10,610
encrypted commands<font color="#CCCCCC"> when</font><font color="#E5E5E5"> after another</font>

649
00:26:07,909 --> 00:26:11,960
cycle through<font color="#E5E5E5"> them until</font><font color="#CCCCCC"> we get</font>

650
00:26:10,610 --> 00:26:13,939
something<font color="#CCCCCC"> that isn't</font><font color="#E5E5E5"> the error response</font>

651
00:26:11,960 --> 00:26:17,210
<font color="#E5E5E5">right which would be the dumb brute</font>

652
00:26:13,940 --> 00:26:19,520
force approach to doing<font color="#E5E5E5"> this</font><font color="#CCCCCC"> so I'm</font>

653
00:26:17,210 --> 00:26:29,640
<font color="#E5E5E5">gonna have a drink because it's been at</font>

654
00:26:19,520 --> 00:26:34,170
least<font color="#E5E5E5"> half an hour I should do</font>

655
00:26:29,640 --> 00:26:36,150
the demo<font color="#CCCCCC"> so this would be dumb right</font>

656
00:26:34,170 --> 00:26:37,590
yeah<font color="#CCCCCC"> you're you</font><font color="#E5E5E5"> can obviously why</font><font color="#CCCCCC"> this</font>

657
00:26:36,150 --> 00:26:40,140
would<font color="#E5E5E5"> be this would</font><font color="#CCCCCC"> be pointless</font>

658
00:26:37,590 --> 00:26:41,549
the reason it's pointless is because<font color="#E5E5E5"> if</font>

659
00:26:40,140 --> 00:26:44,670
<font color="#E5E5E5">you imagine what an encrypted command</font>

660
00:26:41,549 --> 00:26:47,490
<font color="#E5E5E5">will look like we know that F yeah if</font>

661
00:26:44,670 --> 00:26:50,940
the<font color="#E5E5E5"> encrypted command is</font><font color="#CCCCCC"> FA</font><font color="#E5E5E5"> e f g</font><font color="#CCCCCC"> h i j</font>

662
00:26:47,490 --> 00:26:53,250
k l m n as individual bits<font color="#E5E5E5"> we know that</font>

663
00:26:50,940 --> 00:26:57,210
<font color="#CCCCCC">f decrypts to 1 and</font><font color="#E5E5E5"> k</font><font color="#CCCCCC"> decrypts</font><font color="#E5E5E5"> to 0</font>

664
00:26:53,250 --> 00:27:00,660
because<font color="#CCCCCC"> CM 0 has to</font><font color="#E5E5E5"> be a 1 for a read</font>

665
00:26:57,210 --> 00:27:04,410
page command and K has to<font color="#CCCCCC"> be the</font>

666
00:27:00,660 --> 00:27:07,230
encryption<font color="#E5E5E5"> the the inverse of of that</font>

667
00:27:04,410 --> 00:27:09,360
<font color="#CCCCCC">they</font><font color="#E5E5E5"> do the decryption of K has to be in</font>

668
00:27:07,230 --> 00:27:11,669
the inverse of the decryption<font color="#E5E5E5"> of F so we</font>

669
00:27:09,360 --> 00:27:15,299
know those sort<font color="#E5E5E5"> of parameters we know</font>

670
00:27:11,669 --> 00:27:18,150
what they must decrypt<font color="#CCCCCC"> e</font><font color="#E5E5E5"> but equally we</font>

671
00:27:15,299 --> 00:27:21,090
<font color="#E5E5E5">know that the decryption of</font><font color="#CCCCCC"> EG</font><font color="#E5E5E5"> h and i</font>

672
00:27:18,150 --> 00:27:24,809
must be<font color="#E5E5E5"> the inverse of the decryption of</font>

673
00:27:21,090 --> 00:27:28,770
jl m and n right and<font color="#E5E5E5"> we don't know what</font>

674
00:27:24,809 --> 00:27:31,710
the pad is that<font color="#CCCCCC"> we're dealing</font><font color="#E5E5E5"> with but</font>

675
00:27:28,770 --> 00:27:34,830
we are<font color="#CCCCCC"> using</font><font color="#E5E5E5"> the same pad each time so</font>

676
00:27:31,710 --> 00:27:37,950
what we do know is that we<font color="#CCCCCC"> don't have to</font>

677
00:27:34,830 --> 00:27:40,199
care what jl m and n actually<font color="#E5E5E5"> decrypt to</font>

678
00:27:37,950 --> 00:27:44,100
<font color="#E5E5E5">they could decrypt to</font><font color="#CCCCCC"> a random like bit</font>

679
00:27:40,200 --> 00:27:45,570
pan we can search each<font color="#E5E5E5"> eh and</font><font color="#CCCCCC"> i to find</font>

680
00:27:44,100 --> 00:27:48,299
something that<font color="#E5E5E5"> d</font><font color="#CCCCCC"> clips to the</font><font color="#E5E5E5"> same as</font>

681
00:27:45,570 --> 00:27:49,950
that<font color="#E5E5E5"> and that takes four whole bits out</font>

682
00:27:48,299 --> 00:27:51,870
<font color="#CCCCCC">of our search space which reduces our</font>

683
00:27:49,950 --> 00:27:54,330
space to<font color="#E5E5E5"> 2 to the 6 rather than 2 to the</font>

684
00:27:51,870 --> 00:27:57,959
10 which<font color="#E5E5E5"> means our chances</font><font color="#CCCCCC"> of finding</font>

685
00:27:54,330 --> 00:28:02,030
something<font color="#E5E5E5"> will be we will</font><font color="#CCCCCC"> probably</font><font color="#E5E5E5"> need</font>

686
00:27:57,960 --> 00:28:05,730
<font color="#E5E5E5">to send 32 actual requests before</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> hit</font>

687
00:28:02,030 --> 00:28:07,610
<font color="#E5E5E5">an actual success as opposed to 64 so</font>

688
00:28:05,730 --> 00:28:12,780
we've<font color="#CCCCCC"> hardly might work we need to</font><font color="#E5E5E5"> do</font>

689
00:28:07,610 --> 00:28:16,740
honestly<font color="#E5E5E5"> it's cool and it's cryptical</font>

690
00:28:12,780 --> 00:28:18,389
you know<font color="#E5E5E5"> and so we find one valid</font><font color="#CCCCCC"> v</font>

691
00:28:16,740 --> 00:28:19,710
command<font color="#E5E5E5"> right because basically</font><font color="#CCCCCC"> we just</font>

692
00:28:18,390 --> 00:28:21,390
do<font color="#E5E5E5"> that until one</font><font color="#CCCCCC"> of them comes back</font>

693
00:28:19,710 --> 00:28:23,370
with a<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of different response to the</font>

694
00:28:21,390 --> 00:28:25,320
owner<font color="#CCCCCC"> cryptid arrow</font><font color="#E5E5E5"> right now we have</font>

695
00:28:23,370 --> 00:28:26,820
one valid<font color="#CCCCCC"> revive now what we're</font><font color="#E5E5E5"> going to</font>

696
00:28:25,320 --> 00:28:28,799
do<font color="#E5E5E5"> violence search for all the</font><font color="#CCCCCC"> others</font>

697
00:28:26,820 --> 00:28:30,330
<font color="#CCCCCC">we're going to bit flip</font><font color="#E5E5E5"> that to find all</font>

698
00:28:28,799 --> 00:28:32,340
the others<font color="#E5E5E5"> because then we don't have to</font>

699
00:28:30,330 --> 00:28:35,428
<font color="#CCCCCC">actually do any transmission for the</font><font color="#E5E5E5"> RF</font>

700
00:28:32,340 --> 00:28:43,049
is<font color="#E5E5E5"> much quicker</font><font color="#CCCCCC"> so if the one we found</font>

701
00:28:35,429 --> 00:28:48,480
is<font color="#E5E5E5"> efg hijk LMNOP</font><font color="#CCCCCC"> Crips</font>

702
00:28:43,049 --> 00:28:51,629
to read page<font color="#E5E5E5"> four inverted as the actual</font>

703
00:28:48,480 --> 00:28:53,519
<font color="#CCCCCC">plaintext</font><font color="#E5E5E5"> well the first half in the</font>

704
00:28:51,629 --> 00:28:56,459
second half<font color="#CCCCCC"> when they're decrypt it must</font>

705
00:28:53,519 --> 00:28:57,989
be the inverse<font color="#CCCCCC"> of</font><font color="#E5E5E5"> each other because</font>

706
00:28:56,460 --> 00:28:59,970
<font color="#CCCCCC">it's a stream cipher</font>

707
00:28:57,989 --> 00:29:02,669
if you<font color="#E5E5E5"> flip a bit in the encrypted</font>

708
00:28:59,970 --> 00:29:05,940
<font color="#E5E5E5">version it flips the same bit in the</font>

709
00:29:02,669 --> 00:29:07,799
plain<font color="#E5E5E5"> text version which is where all</font>

710
00:29:05,940 --> 00:29:11,759
the integrity<font color="#E5E5E5"> and the insecurities</font><font color="#CCCCCC"> of</font>

711
00:29:07,799 --> 00:29:15,929
one<font color="#CCCCCC"> pad sofa is kind of fall down right</font>

712
00:29:11,759 --> 00:29:18,059
<font color="#E5E5E5">so we could flip the first bit</font><font color="#CCCCCC"> e for</font>

713
00:29:15,929 --> 00:29:19,440
<font color="#CCCCCC">example in this</font><font color="#E5E5E5"> example</font><font color="#CCCCCC"> and in this</font>

714
00:29:18,059 --> 00:29:22,678
<font color="#E5E5E5">example it would flip it from a</font><font color="#CCCCCC"> read</font>

715
00:29:19,440 --> 00:29:24,299
<font color="#CCCCCC">inverted to a read command but if it was</font>

716
00:29:22,679 --> 00:29:28,259
originally read from<font color="#CCCCCC"> I'd it flip</font><font color="#E5E5E5"> it to a</font>

717
00:29:24,299 --> 00:29:29,999
read<font color="#CCCCCC"> a</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> clad okay so it's long</font><font color="#E5E5E5"> but</font>

718
00:29:28,259 --> 00:29:31,529
<font color="#CCCCCC">in order</font><font color="#E5E5E5"> to maintain the integrity we</font>

719
00:29:29,999 --> 00:29:34,679
also have to flip the same bit in the

720
00:29:31,529 --> 00:29:37,230
inverted<font color="#E5E5E5"> half so bit six</font><font color="#CCCCCC"> also has to be</font>

721
00:29:34,679 --> 00:29:40,230
<font color="#E5E5E5">flipped but because of the nature of</font>

722
00:29:37,230 --> 00:29:41,609
stream ciphers<font color="#CCCCCC"> if we flip the bit in</font><font color="#E5E5E5"> the</font>

723
00:29:40,230 --> 00:29:42,929
<font color="#E5E5E5">cipher text we flip the same bit in the</font>

724
00:29:41,609 --> 00:29:45,658
plain<font color="#E5E5E5"> tip so we can do the same thing on</font>

725
00:29:42,929 --> 00:29:48,029
bit<font color="#E5E5E5"> six as well so if we flip</font><font color="#CCCCCC"> bit 0</font><font color="#E5E5E5"> we</font>

726
00:29:45,659 --> 00:29:51,539
also have to flip it sorry<font color="#CCCCCC"> if we</font><font color="#E5E5E5"> flip it</font>

727
00:29:48,029 --> 00:29:53,279
<font color="#E5E5E5">one will softly bit six and it will flip</font>

728
00:29:51,539 --> 00:29:55,109
it from<font color="#E5E5E5"> a read to</font><font color="#CCCCCC"> read inverted or a</font>

729
00:29:53,279 --> 00:29:56,940
read<font color="#E5E5E5"> inverted to a read but either way</font>

730
00:29:55,109 --> 00:30:00,178
what we end up<font color="#E5E5E5"> with</font><font color="#CCCCCC"> is a valid read</font>

731
00:29:56,940 --> 00:30:02,909
command<font color="#E5E5E5"> equally we could flip a bit in</font>

732
00:30:00,179 --> 00:30:05,999
the page bits so if we had read inverted

733
00:30:02,909 --> 00:30:08,340
page four and we flipped bit<font color="#E5E5E5"> five it</font>

734
00:30:05,999 --> 00:30:11,460
would flip it to read inverted page<font color="#E5E5E5"> five</font>

735
00:30:08,340 --> 00:30:13,199
as long<font color="#E5E5E5"> as we also flip bit</font><font color="#CCCCCC"> 10</font><font color="#E5E5E5"> to</font>

736
00:30:11,460 --> 00:30:15,749
<font color="#E5E5E5">maintain the integrity by flipping the</font>

737
00:30:13,200 --> 00:30:16,639
same bit in the second half of the

738
00:30:15,749 --> 00:30:19,169
command

739
00:30:16,639 --> 00:30:22,559
that's really neat so basically given

740
00:30:19,169 --> 00:30:26,100
one actual read command that works<font color="#E5E5E5"> in in</font>

741
00:30:22,559 --> 00:30:29,730
the encrypted<font color="#E5E5E5"> form we can flip it around</font>

742
00:30:26,100 --> 00:30:32,689
<font color="#E5E5E5">until we get all</font><font color="#CCCCCC"> 16 by basically</font><font color="#E5E5E5"> just</font>

743
00:30:29,730 --> 00:30:36,509
<font color="#E5E5E5">building a table</font><font color="#CCCCCC"> it's read for view and</font>

744
00:30:32,690 --> 00:30:38,489
then what we can<font color="#E5E5E5"> do is try every one of</font>

745
00:30:36,509 --> 00:30:41,460
them out<font color="#E5E5E5"> one of them must be read page</font>

746
00:30:38,489 --> 00:30:43,320
<font color="#CCCCCC">zero like not invade and that's the one</font>

747
00:30:41,460 --> 00:30:45,269
we're<font color="#CCCCCC"> looking for so what</font><font color="#E5E5E5"> we'll do is</font>

748
00:30:43,320 --> 00:30:47,908
<font color="#E5E5E5">we'd go</font><font color="#CCCCCC"> around a loop of</font><font color="#E5E5E5"> trying each of</font>

749
00:30:45,269 --> 00:30:49,830
the<font color="#CCCCCC"> 16 up possibilities every time</font><font color="#E5E5E5"> we'll</font>

750
00:30:47,909 --> 00:30:53,070
reset the tag back to the same position

751
00:30:49,830 --> 00:30:54,210
<font color="#E5E5E5">with</font><font color="#CCCCCC"> the same nonce</font><font color="#E5E5E5"> to the same point of</font>

752
00:30:53,070 --> 00:30:56,360
the arc PRNG

753
00:30:54,210 --> 00:31:00,170
and<font color="#E5E5E5"> we're test our guests</font>

754
00:30:56,360 --> 00:31:01,969
and if it's right<font color="#CCCCCC"> we'll store the</font><font color="#E5E5E5"> key</font>

755
00:31:00,170 --> 00:31:03,170
<font color="#E5E5E5">stream that comes back and if it's wrong</font>

756
00:31:01,970 --> 00:31:04,880
we'll just go around<font color="#E5E5E5"> the loop and try</font>

757
00:31:03,170 --> 00:31:06,920
<font color="#E5E5E5">another one and each time we will</font>

758
00:31:04,880 --> 00:31:08,360
reinitialize the<font color="#E5E5E5"> tag because we're</font>

759
00:31:06,920 --> 00:31:12,200
<font color="#CCCCCC">working from the same position</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

760
00:31:08,360 --> 00:31:13,939
<font color="#CCCCCC">PRNG because</font><font color="#E5E5E5"> we're using an emulated</font>

761
00:31:12,200 --> 00:31:16,040
reader that's replaying the same nonce

762
00:31:13,940 --> 00:31:18,920
that if you were playing same launch<font color="#E5E5E5"> you</font>

763
00:31:16,040 --> 00:31:20,389
get the same<font color="#CCCCCC"> P stream back and I repeat</font>

764
00:31:18,920 --> 00:31:22,040
<font color="#E5E5E5">this enough times</font><font color="#CCCCCC"> to hope that</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> gets</font>

765
00:31:20,390 --> 00:31:25,790
boring so you<font color="#E5E5E5"> just understand what I'm</font>

766
00:31:22,040 --> 00:31:28,760
saying at this point<font color="#CCCCCC"> because I'm almost</font>

767
00:31:25,790 --> 00:31:30,620
fearful that I'm saying<font color="#E5E5E5"> stuff and people</font>

768
00:31:28,760 --> 00:31:31,850
<font color="#CCCCCC">are kind of going but why why does that</font>

769
00:31:30,620 --> 00:31:36,439
way it's like<font color="#E5E5E5"> it's not actually</font><font color="#CCCCCC"> that</font>

770
00:31:31,850 --> 00:31:37,820
<font color="#E5E5E5">hard honestly so if we try our guess</font>

771
00:31:36,440 --> 00:31:38,720
right<font color="#CCCCCC"> what we're going to do is we're</font>

772
00:31:37,820 --> 00:31:40,790
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> assume that</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> guess is</font>

773
00:31:38,720 --> 00:31:42,559
correct<font color="#CCCCCC"> where we have a ten bit like</font>

774
00:31:40,790 --> 00:31:45,080
encrypted command<font color="#E5E5E5"> we don't know which</font>

775
00:31:42,559 --> 00:31:46,340
read page will be<font color="#E5E5E5"> put inverted page come</font>

776
00:31:45,080 --> 00:31:50,570
<font color="#E5E5E5">on we have but we're gonna assume it's</font>

777
00:31:46,340 --> 00:31:53,299
repaid<font color="#E5E5E5"> zero right and so we can XOR that</font>

778
00:31:50,570 --> 00:31:55,070
with the plain text<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the repaid zero</font>

779
00:31:53,299 --> 00:31:57,049
command and<font color="#CCCCCC"> that will retrieve the ten</font>

780
00:31:55,070 --> 00:32:00,290
bits of key stream that would be

781
00:31:57,049 --> 00:32:02,299
<font color="#CCCCCC">necessary if our guess was correct</font><font color="#E5E5E5"> when</font>

782
00:32:00,290 --> 00:32:03,559
we've sent<font color="#CCCCCC"> him we get</font><font color="#E5E5E5"> back our 32 bit</font>

783
00:32:02,299 --> 00:32:04,668
response which won't be<font color="#E5E5E5"> the error</font>

784
00:32:03,559 --> 00:32:06,770
<font color="#E5E5E5">response because it would be a valid</font>

785
00:32:04,669 --> 00:32:09,350
<font color="#E5E5E5">read page command or some description</font><font color="#CCCCCC"> we</font>

786
00:32:06,770 --> 00:32:11,840
can<font color="#E5E5E5"> take that read page response</font><font color="#CCCCCC"> and</font>

787
00:32:09,350 --> 00:32:14,870
assume that's<font color="#E5E5E5"> page zero which we know</font>

788
00:32:11,840 --> 00:32:16,399
because<font color="#CCCCCC"> it gets</font><font color="#E5E5E5"> given to us like for</font>

789
00:32:14,870 --> 00:32:17,059
free<font color="#CCCCCC"> in clear at the beginning of the</font>

790
00:32:16,400 --> 00:32:20,390
<font color="#E5E5E5">handshake right</font>

791
00:32:17,059 --> 00:32:22,040
it's the UID<font color="#E5E5E5"> so we can X or whatever</font><font color="#CCCCCC"> we</font>

792
00:32:20,390 --> 00:32:23,929
get back with your<font color="#E5E5E5"> ID and that'll give</font>

793
00:32:22,040 --> 00:32:26,540
us<font color="#E5E5E5"> the next 32 bits</font><font color="#CCCCCC"> of key stream so</font>

794
00:32:23,929 --> 00:32:28,970
we've now got 42 bits of key stream<font color="#E5E5E5"> if</font>

795
00:32:26,540 --> 00:32:30,049
our guess<font color="#CCCCCC"> is correct and if our guess is</font>

796
00:32:28,970 --> 00:32:33,500
incorrect

797
00:32:30,049 --> 00:32:35,780
we've got nonsense<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so somehow</font>

798
00:32:33,500 --> 00:32:38,390
we<font color="#E5E5E5"> need to check if our 42 bits the key</font>

799
00:32:35,780 --> 00:32:41,030
<font color="#E5E5E5">stream is correct or not so what we do</font>

800
00:32:38,390 --> 00:32:44,120
is we<font color="#E5E5E5"> create a</font><font color="#CCCCCC"> repayed 0 command that is</font>

801
00:32:41,030 --> 00:32:46,399
40 bits long<font color="#E5E5E5"> and we do that using that</font>

802
00:32:44,120 --> 00:32:47,870
extended command<font color="#E5E5E5"> definition that we had</font>

803
00:32:46,400 --> 00:32:50,150
earlier the thing that we were going to

804
00:32:47,870 --> 00:32:54,439
attack so<font color="#CCCCCC"> there'll be a read page zero</font>

805
00:32:50,150 --> 00:32:55,309
command<font color="#E5E5E5"> would</font><font color="#CCCCCC"> be 1 1 0 0 0 0 0</font><font color="#E5E5E5"> 1 1 1</font><font color="#CCCCCC"> at</font>

806
00:32:54,440 --> 00:33:00,559
the<font color="#E5E5E5"> very minimum</font>

807
00:32:55,309 --> 00:33:03,770
<font color="#E5E5E5">followed by 1 1 0 0 0 followed by 0 0 0</font>

808
00:33:00,559 --> 00:33:06,320
1 1 etc and over and<font color="#CCCCCC"> over and</font><font color="#E5E5E5"> over again</font>

809
00:33:03,770 --> 00:33:08,120
<font color="#E5E5E5">up until</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> point where you</font><font color="#CCCCCC"> stopped</font>

810
00:33:06,320 --> 00:33:09,909
<font color="#E5E5E5">sending these blocks</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> can make a</font>

811
00:33:08,120 --> 00:33:11,760
<font color="#CCCCCC">40-bit version of this</font>

812
00:33:09,910 --> 00:33:16,630
<font color="#E5E5E5">page</font><font color="#CCCCCC"> zero combined with extreme</font>

813
00:33:11,760 --> 00:33:18,520
integrity<font color="#E5E5E5"> right and then all we do is</font>

814
00:33:16,630 --> 00:33:19,870
XOR that with the first 40 bits of the

815
00:33:18,520 --> 00:33:22,450
<font color="#E5E5E5">keys tune that we think we've generated</font>

816
00:33:19,870 --> 00:33:26,020
<font color="#E5E5E5">to create an encrypted version of that</font>

817
00:33:22,450 --> 00:33:28,330
<font color="#E5E5E5">command and then we send it what we've</font>

818
00:33:26,020 --> 00:33:29,860
<font color="#E5E5E5">realized the tag with the nonce back to</font>

819
00:33:28,330 --> 00:33:32,260
the same point again so it's using<font color="#E5E5E5"> the</font>

820
00:33:29,860 --> 00:33:34,090
<font color="#E5E5E5">came same key stream and then we send</font>

821
00:33:32,260 --> 00:33:36,370
that encrypted pay every page<font color="#CCCCCC"> zero</font>

822
00:33:34,090 --> 00:33:38,110
command<font color="#E5E5E5"> and we either get back the ever</font>

823
00:33:36,370 --> 00:33:40,449
response which means<font color="#CCCCCC"> that when it</font>

824
00:33:38,110 --> 00:33:42,790
decrypted the integrity failed<font color="#E5E5E5"> which</font>

825
00:33:40,450 --> 00:33:45,160
means that we weren't correct<font color="#E5E5E5"> that</font>

826
00:33:42,790 --> 00:33:47,770
<font color="#E5E5E5">wasn't the right command</font><font color="#CCCCCC"> or we</font><font color="#E5E5E5"> get back</font>

827
00:33:45,160 --> 00:33:49,360
a<font color="#E5E5E5"> 32-bit response which isn't the error</font>

828
00:33:47,770 --> 00:33:53,879
response which is essentially the

829
00:33:49,360 --> 00:33:56,469
encryption of page<font color="#E5E5E5"> zero UID</font><font color="#CCCCCC"> that means</font>

830
00:33:53,880 --> 00:33:58,450
at<font color="#E5E5E5"> that point that the</font><font color="#CCCCCC"> first 40 bits of</font>

831
00:33:56,470 --> 00:33:59,980
<font color="#E5E5E5">key stream must be correct and then we</font>

832
00:33:58,450 --> 00:34:02,080
<font color="#E5E5E5">could take the response and exhort with</font>

833
00:33:59,980 --> 00:34:05,050
UID to get back the next<font color="#E5E5E5"> 30 bits a key</font>

834
00:34:02,080 --> 00:34:07,570
<font color="#E5E5E5">stream which basically gives us 72 bits</font>

835
00:34:05,050 --> 00:34:09,850
of key stream that we know from<font color="#E5E5E5"> the</font>

836
00:34:07,570 --> 00:34:13,389
point<font color="#E5E5E5"> that the PRNG was initialized from</font>

837
00:34:09,850 --> 00:34:16,000
<font color="#E5E5E5">the nonce</font><font color="#CCCCCC"> being transmitted and</font><font color="#E5E5E5"> it</font>

838
00:34:13,389 --> 00:34:18,699
completing the handshake<font color="#CCCCCC"> which means</font>

839
00:34:16,000 --> 00:34:23,800
that we can send<font color="#E5E5E5"> that nonce and</font><font color="#CCCCCC"> channels</font>

840
00:34:18,699 --> 00:34:26,290
<font color="#E5E5E5">response value encrypted and</font><font color="#CCCCCC"> no the pad</font>

841
00:34:23,800 --> 00:34:28,900
<font color="#E5E5E5">the the commands and the responses are</font>

842
00:34:26,290 --> 00:34:30,940
being XOR with which means we can do

843
00:34:28,900 --> 00:34:35,200
things<font color="#CCCCCC"> like this where we can</font><font color="#E5E5E5"> basically</font>

844
00:34:30,940 --> 00:34:37,060
read each<font color="#CCCCCC"> page of the</font><font color="#E5E5E5"> tag one by one by</font>

845
00:34:35,199 --> 00:34:39,639
initializing<font color="#E5E5E5"> the tag back to the same</font>

846
00:34:37,060 --> 00:34:42,250
point<font color="#E5E5E5"> and then doing it a different read</font>

847
00:34:39,639 --> 00:34:43,659
page command each time and the way we do

848
00:34:42,250 --> 00:34:45,820
the read page commands<font color="#CCCCCC"> we create the</font>

849
00:34:43,659 --> 00:34:47,859
plain text<font color="#CCCCCC"> version exhort with</font><font color="#E5E5E5"> the first</font>

850
00:34:45,820 --> 00:34:49,510
<font color="#E5E5E5">10 bits of key stream send that to the</font>

851
00:34:47,860 --> 00:34:52,000
tag<font color="#CCCCCC"> and whatever</font><font color="#E5E5E5"> comes back we XOR that</font>

852
00:34:49,510 --> 00:34:54,460
with the next<font color="#CCCCCC"> 32 bits of key stream to</font>

853
00:34:52,000 --> 00:34:56,650
get back the<font color="#CCCCCC"> actual answer</font><font color="#E5E5E5"> which means</font>

854
00:34:54,460 --> 00:34:59,680
that we can then recover<font color="#E5E5E5"> all eight pages</font>

855
00:34:56,650 --> 00:35:01,960
of<font color="#E5E5E5"> the tag and three of those pages</font>

856
00:34:59,680 --> 00:35:03,910
involve the secrets that<font color="#CCCCCC"> we need to know</font>

857
00:35:01,960 --> 00:35:06,040
in<font color="#E5E5E5"> order to be able to talk to any other</font>

858
00:35:03,910 --> 00:35:09,839
tag in the system so it's kind of a

859
00:35:06,040 --> 00:35:13,000
<font color="#E5E5E5">really I think it's a really cool attack</font>

860
00:35:09,840 --> 00:35:14,980
so I implemented it<font color="#E5E5E5"> and the way I</font>

861
00:35:13,000 --> 00:35:17,380
implemented it was I took<font color="#E5E5E5"> our fiddler</font>

862
00:35:14,980 --> 00:35:19,540
made by<font color="#CCCCCC"> aperture Labs</font><font color="#E5E5E5"> which if you don't</font>

863
00:35:17,380 --> 00:35:22,120
<font color="#E5E5E5">know is made of our function and Zach</font>

864
00:35:19,540 --> 00:35:23,290
<font color="#E5E5E5">Franklin</font><font color="#CCCCCC"> and they've made</font><font color="#E5E5E5"> a really nice</font>

865
00:35:22,120 --> 00:35:26,440
bit of<font color="#E5E5E5"> equipment</font>

866
00:35:23,290 --> 00:35:28,270
so if you have a proxmark<font color="#E5E5E5"> which can do</font>

867
00:35:26,440 --> 00:35:30,310
low frequency and<font color="#E5E5E5"> high</font><font color="#CCCCCC"> frequency</font><font color="#E5E5E5"> what</font>

868
00:35:28,270 --> 00:35:32,110
you'll find is that high frequency is

869
00:35:30,310 --> 00:35:34,660
really good<font color="#CCCCCC"> like it actually</font><font color="#E5E5E5"> works</font>

870
00:35:32,110 --> 00:35:37,000
<font color="#E5E5E5">mainly</font><font color="#CCCCCC"> because major bar function</font><font color="#E5E5E5"> vote</font>

871
00:35:34,660 --> 00:35:39,160
the code for that<font color="#E5E5E5"> but when it comes to</font>

872
00:35:37,000 --> 00:35:41,140
<font color="#CCCCCC">low Finke stuff</font><font color="#E5E5E5"> it's not very good at</font>

873
00:35:39,160 --> 00:35:42,790
all well<font color="#E5E5E5"> it keeps crashing especially on</font>

874
00:35:41,140 --> 00:35:45,430
high<font color="#E5E5E5"> tech</font><font color="#CCCCCC"> to doesn't</font><font color="#E5E5E5"> work very well</font>

875
00:35:42,790 --> 00:35:47,650
<font color="#CCCCCC">however</font><font color="#E5E5E5"> they made the</font><font color="#CCCCCC"> our Fiddler's to</font>

876
00:35:45,430 --> 00:35:51,580
kind of plug that gap and and vote the

877
00:35:47,650 --> 00:35:53,560
code for and it's really<font color="#E5E5E5"> good so I went</font>

878
00:35:51,580 --> 00:35:56,200
<font color="#E5E5E5">to the offered</font><font color="#CCCCCC"> loved github page and</font>

879
00:35:53,560 --> 00:35:58,360
they say you can download the IDE<font color="#E5E5E5"> that</font>

880
00:35:56,200 --> 00:36:00,370
you need in<font color="#E5E5E5"> order to edit the firmware</font>

881
00:35:58,360 --> 00:36:03,340
<font color="#E5E5E5">and you can download all of the firmware</font>

882
00:36:00,370 --> 00:36:06,130
<font color="#E5E5E5">from</font><font color="#CCCCCC"> the github</font><font color="#E5E5E5"> and then you can start</font>

883
00:36:03,340 --> 00:36:07,960
writing your<font color="#E5E5E5"> own</font><font color="#CCCCCC"> C which is just</font>

884
00:36:06,130 --> 00:36:09,250
straight for C<font color="#CCCCCC"> you can be through the</font>

885
00:36:07,960 --> 00:36:10,330
code<font color="#CCCCCC"> and kind of</font><font color="#E5E5E5"> go actually this is a</font>

886
00:36:09,250 --> 00:36:13,060
quite understandable it's just

887
00:36:10,330 --> 00:36:14,950
<font color="#CCCCCC">programming like you expect you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> a</font>

888
00:36:13,060 --> 00:36:16,930
<font color="#E5E5E5">normal</font><font color="#CCCCCC"> kind of code and when you</font>

889
00:36:14,950 --> 00:36:19,629
actually want<font color="#E5E5E5"> to transmit or receive</font>

890
00:36:16,930 --> 00:36:21,160
stuff over the RF<font color="#E5E5E5"> you can hunt through</font>

891
00:36:19,630 --> 00:36:22,960
the rest of<font color="#E5E5E5"> the code base and find out</font>

892
00:36:21,160 --> 00:36:25,029
where they've done<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> that</font>

893
00:36:22,960 --> 00:36:26,920
you need<font color="#E5E5E5"> to do and copy and paste their</font>

894
00:36:25,030 --> 00:36:29,680
function calls<font color="#CCCCCC"> into</font><font color="#E5E5E5"> your code and then</font>

895
00:36:26,920 --> 00:36:31,720
<font color="#E5E5E5">the thing just works honestly it's magic</font>

896
00:36:29,680 --> 00:36:33,160
<font color="#CCCCCC">it did not</font><font color="#E5E5E5"> take me that long</font><font color="#CCCCCC"> it took me</font>

897
00:36:31,720 --> 00:36:34,959
<font color="#E5E5E5">longer to understand the maths in the</font>

898
00:36:33,160 --> 00:36:38,140
paper than<font color="#E5E5E5"> it did to</font><font color="#CCCCCC"> at sea</font><font color="#E5E5E5"> to actually</font>

899
00:36:34,960 --> 00:36:41,850
<font color="#E5E5E5">implement this stuff so I've added a</font>

900
00:36:38,140 --> 00:36:44,950
whole<font color="#E5E5E5"> load of commands to our</font><font color="#CCCCCC"> Fiddler's</font>

901
00:36:41,850 --> 00:36:46,779
I've extended their stiff pwn come on so

902
00:36:44,950 --> 00:36:48,069
<font color="#E5E5E5">I can just literally pull out encryption</font>

903
00:36:46,780 --> 00:36:51,540
answers and<font color="#E5E5E5"> challenge response values</font>

904
00:36:48,070 --> 00:36:54,280
<font color="#CCCCCC">I'll</font><font color="#E5E5E5"> create a crack command</font>

905
00:36:51,540 --> 00:36:56,770
<font color="#CCCCCC">attack that I've just talked about a key</font>

906
00:36:54,280 --> 00:36:58,720
stream command for the second attack<font color="#E5E5E5"> a</font>

907
00:36:56,770 --> 00:37:00,790
reader commands<font color="#E5E5E5"> that once you've got the</font>

908
00:36:58,720 --> 00:37:04,779
key you can read any<font color="#E5E5E5"> high tech to card</font>

909
00:37:00,790 --> 00:37:06,610
in that<font color="#E5E5E5"> tag in that system they're clear</font>

910
00:37:04,780 --> 00:37:08,560
store tags counts to all tags it's all

911
00:37:06,610 --> 00:37:09,910
about like weaponizing this kind of

912
00:37:08,560 --> 00:37:11,620
stuff so<font color="#E5E5E5"> you can have</font><font color="#CCCCCC"> it hidden away</font>

913
00:37:09,910 --> 00:37:12,580
with a<font color="#CCCCCC"> battery power to</font><font color="#E5E5E5"> thing rather</font>

914
00:37:11,620 --> 00:37:15,520
<font color="#CCCCCC">than having to carry a laptop around</font>

915
00:37:12,580 --> 00:37:16,960
<font color="#E5E5E5">it's kind of neat</font><font color="#CCCCCC"> and if you were to do</font>

916
00:37:15,520 --> 00:37:18,550
the attack you'd do<font color="#E5E5E5"> something along</font>

917
00:37:16,960 --> 00:37:25,090
these lines<font color="#E5E5E5"> but rather than talk about</font>

918
00:37:18,550 --> 00:37:27,730
<font color="#CCCCCC">it let's do a demo this</font><font color="#E5E5E5"> is the bit that</font>

919
00:37:25,090 --> 00:37:30,330
<font color="#E5E5E5">will fail miserably</font><font color="#CCCCCC"> I might</font><font color="#E5E5E5"> add but</font>

920
00:37:27,730 --> 00:37:30,330
<font color="#E5E5E5">anyway let's try</font>

921
00:37:31,070 --> 00:37:39,200
right so I've<font color="#CCCCCC"> got a couple</font><font color="#E5E5E5"> of terminal</font>

922
00:37:36,140 --> 00:37:40,609
windows<font color="#E5E5E5"> and a whole lot of windows</font>

923
00:37:39,200 --> 00:37:56,089
underneath you don't need to care<font color="#CCCCCC"> about</font>

924
00:37:40,610 --> 00:37:58,790
right<font color="#E5E5E5"> okay so top tip if you're</font><font color="#CCCCCC"> talking</font>

925
00:37:56,090 --> 00:38:04,390
EMF camp<font color="#E5E5E5"> don't sit in the Sun and</font><font color="#CCCCCC"> drink</font>

926
00:37:58,790 --> 00:38:04,390
beer all day it's it's<font color="#E5E5E5"> not the answer</font>

927
00:38:05,470 --> 00:38:11,660
right<font color="#CCCCCC"> so this is</font><font color="#E5E5E5"> an RFID our</font><font color="#CCCCCC"> Fiddler's</font>

928
00:38:09,350 --> 00:38:16,569
and I'm already<font color="#E5E5E5"> in high tech tree mode</font>

929
00:38:11,660 --> 00:38:24,020
<font color="#E5E5E5">so I'm going to put that</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> sniff PWM</font>

930
00:38:16,570 --> 00:38:25,790
I'm gonna clear<font color="#CCCCCC"> it and</font><font color="#E5E5E5"> then in store</font>

931
00:38:24,020 --> 00:38:27,050
mode I<font color="#CCCCCC"> can type</font>

932
00:38:25,790 --> 00:38:32,390
don't worry I'll worry about<font color="#E5E5E5"> that in a</font>

933
00:38:27,050 --> 00:38:36,100
second I just<font color="#CCCCCC"> set up another one over</font>

934
00:38:32,390 --> 00:38:40,879
here<font color="#CCCCCC"> as so I'm</font><font color="#E5E5E5"> gonna create one as a</font>

935
00:38:36,100 --> 00:38:42,650
reader that's the one I've<font color="#CCCCCC"> just kind of</font>

936
00:38:40,880 --> 00:38:52,190
I'm hoping to configure there it's going

937
00:38:42,650 --> 00:38:55,820
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be the eavesdropper it's</font><font color="#E5E5E5"> really funny</font>

938
00:38:52,190 --> 00:39:01,160
trying to type one hand hit but it's

939
00:38:55,820 --> 00:39:03,020
<font color="#E5E5E5">okay honestly we have trust I can</font><font color="#CCCCCC"> tell</font>

940
00:39:01,160 --> 00:39:10,129
we<font color="#E5E5E5"> have faith</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the room this will all</font>

941
00:39:03,020 --> 00:39:12,320
be<font color="#CCCCCC"> superb</font><font color="#E5E5E5"> marvelous right okay so I've</font>

942
00:39:10,130 --> 00:39:16,990
got a fake<font color="#E5E5E5"> reader set up so if we come</font>

943
00:39:12,320 --> 00:39:20,720
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to this one</font><font color="#CCCCCC"> we run a sniff PWM</font>

944
00:39:16,990 --> 00:39:22,759
store<font color="#E5E5E5"> okay so you can see the star auth</font>

945
00:39:20,720 --> 00:39:26,000
commands<font color="#CCCCCC"> the reader is constantly</font>

946
00:39:22,760 --> 00:39:28,790
emanating start off using pulse width

947
00:39:26,000 --> 00:39:30,560
modulation mode of modulation<font color="#E5E5E5"> over the</font>

948
00:39:28,790 --> 00:39:32,870
field right<font color="#E5E5E5"> that means that it's</font>

949
00:39:30,560 --> 00:39:34,460
shouting out<font color="#CCCCCC"> star or star or star</font><font color="#E5E5E5"> or</font>

950
00:39:32,870 --> 00:39:37,040
<font color="#CCCCCC">startles because it's looking</font><font color="#E5E5E5"> for a tag</font>

951
00:39:34,460 --> 00:39:40,780
many many many times second<font color="#E5E5E5"> so I'm going</font>

952
00:39:37,040 --> 00:39:40,779
to<font color="#E5E5E5"> introduce the tag and I'm hoping</font>

953
00:39:41,100 --> 00:39:47,670
hoping we're<font color="#E5E5E5"> gonna manage to read it</font>

954
00:39:43,320 --> 00:39:50,010
hang on there right<font color="#CCCCCC"> so that is that is</font>

955
00:39:47,670 --> 00:39:53,600
<font color="#E5E5E5">kind of reading it most of the time and</font>

956
00:39:50,010 --> 00:39:56,100
what we're capturing will be the

957
00:39:53,600 --> 00:39:57,810
encrypted<font color="#CCCCCC"> notes</font><font color="#E5E5E5"> and encrypted honest</font>

958
00:39:56,100 --> 00:40:01,830
response values assuming that that's

959
00:39:57,810 --> 00:40:06,480
<font color="#E5E5E5">working</font><font color="#CCCCCC"> all right so let's stop that</font><font color="#E5E5E5"> am</font>

960
00:40:01,830 --> 00:40:09,509
I in the right yep<font color="#E5E5E5"> right so let's see</font>

961
00:40:06,480 --> 00:40:19,110
oops<font color="#E5E5E5"> let's see what we've managed to</font>

962
00:40:09,510 --> 00:40:20,520
<font color="#E5E5E5">capture a list</font><font color="#CCCCCC"> l</font><font color="#E5E5E5"> ah there we go</font><font color="#CCCCCC"> right so</font>

963
00:40:19,110 --> 00:40:22,620
we've<font color="#E5E5E5"> we've captured all</font><font color="#CCCCCC"> of these</font>

964
00:40:20,520 --> 00:40:24,120
encrypted<font color="#E5E5E5"> notches and</font><font color="#CCCCCC"> challenge/response</font>

965
00:40:22,620 --> 00:40:26,520
<font color="#E5E5E5">values now you see the ones that</font>

966
00:40:24,120 --> 00:40:28,920
<font color="#CCCCCC">f-f-f-f-f-f-f clear it's an error right</font>

967
00:40:26,520 --> 00:40:31,290
<font color="#E5E5E5">ignore that there's no guarantee</font><font color="#CCCCCC"> the</font>

968
00:40:28,920 --> 00:40:33,390
others will have<font color="#E5E5E5"> been received like</font>

969
00:40:31,290 --> 00:40:37,710
clearly right but we'll<font color="#CCCCCC"> just trust that</font>

970
00:40:33,390 --> 00:40:45,779
it's the case for the time being<font color="#CCCCCC"> so if I</font>

971
00:40:37,710 --> 00:40:49,500
now take<font color="#CCCCCC"> hang on I take</font><font color="#E5E5E5"> the one</font><font color="#CCCCCC"> that's</font>

972
00:40:45,780 --> 00:40:54,000
the fake<font color="#CCCCCC"> reader</font><font color="#E5E5E5"> out of the way and I</font>

973
00:40:49,500 --> 00:40:54,420
just<font color="#CCCCCC"> have I just have this</font><font color="#E5E5E5"> our fiddler</font>

974
00:40:54,000 --> 00:40:56,820
here

975
00:40:54,420 --> 00:40:59,640
and the tag now what I'm<font color="#E5E5E5"> going to do is</font>

976
00:40:56,820 --> 00:41:03,200
place the tag on<font color="#E5E5E5"> the M on the antenna</font>

977
00:40:59,640 --> 00:41:07,470
and<font color="#E5E5E5"> I'm going to try and crack it using</font>

978
00:41:03,200 --> 00:41:10,259
one of<font color="#E5E5E5"> those values right so where's my</font>

979
00:41:07,470 --> 00:41:12,569
cursor<font color="#CCCCCC"> I can take the last word if you</font>

980
00:41:10,260 --> 00:41:14,310
<font color="#CCCCCC">like</font><font color="#E5E5E5"> I can take the first one of this</font>

981
00:41:12,570 --> 00:41:16,590
page if you like<font color="#E5E5E5"> I could take any in</font>

982
00:41:14,310 --> 00:41:18,240
<font color="#E5E5E5">between apart from the ffs ffs' does</font>

983
00:41:16,590 --> 00:41:22,290
someone want<font color="#CCCCCC"> to shout stop and I'll just</font>

984
00:41:18,240 --> 00:41:25,950
pick one at random yeah<font color="#E5E5E5"> that one there</font>

985
00:41:22,290 --> 00:41:29,190
we will<font color="#E5E5E5"> have that pair okay now as a</font>

986
00:41:25,950 --> 00:41:32,330
magician<font color="#E5E5E5"> clearly I will have forced you</font>

987
00:41:29,190 --> 00:41:35,400
to the<font color="#E5E5E5"> only one that works in this list</font>

988
00:41:32,330 --> 00:41:37,049
but honestly<font color="#CCCCCC"> will come back and</font><font color="#E5E5E5"> try</font>

989
00:41:35,400 --> 00:41:39,180
<font color="#CCCCCC">again in a minute with a different one</font>

990
00:41:37,050 --> 00:41:42,570
<font color="#E5E5E5">just to prove</font><font color="#CCCCCC"> that I'm</font><font color="#E5E5E5"> not using magic</font>

991
00:41:39,180 --> 00:41:43,859
<font color="#E5E5E5">and</font><font color="#CCCCCC"> mind-control to trick this right so</font>

992
00:41:42,570 --> 00:41:46,560
what I'm<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> is I'm we're gonna run</font>

993
00:41:43,860 --> 00:41:48,540
the crack command with this particularly

994
00:41:46,560 --> 00:41:50,430
encrypted nonce<font color="#E5E5E5"> and this particularly</font>

995
00:41:48,540 --> 00:41:53,160
encrypted<font color="#E5E5E5"> choice of</font><font color="#CCCCCC"> fonts</font><font color="#E5E5E5"> value that</font>

996
00:41:50,430 --> 00:41:54,680
<font color="#E5E5E5">goes with that nonce right it will get</font>

997
00:41:53,160 --> 00:41:57,680
the UID off the<font color="#CCCCCC"> tag it's</font>

998
00:41:54,680 --> 00:42:01,790
<font color="#E5E5E5">elf it will hunt for a valid read page</font>

999
00:41:57,680 --> 00:42:04,160
command<font color="#CCCCCC"> it will</font><font color="#E5E5E5"> then bit flip and twice</font>

1000
00:42:01,790 --> 00:42:06,259
with them of them out until it finds a

1001
00:42:04,160 --> 00:42:08,690
<font color="#CCCCCC">repayed zero command</font><font color="#E5E5E5"> and then from there</font>

1002
00:42:06,260 --> 00:42:10,730
it will<font color="#E5E5E5"> read the</font><font color="#CCCCCC"> whole of the tags banks</font>

1003
00:42:08,690 --> 00:42:12,980
of memory<font color="#CCCCCC"> right the</font><font color="#E5E5E5"> reason I tell</font><font color="#CCCCCC"> you</font>

1004
00:42:10,730 --> 00:42:15,830
<font color="#E5E5E5">this before I press</font><font color="#CCCCCC"> ENTER</font><font color="#E5E5E5"> is that when I</font>

1005
00:42:12,980 --> 00:42:18,260
tested this in my demo<font color="#CCCCCC"> I first enter and</font>

1006
00:42:15,830 --> 00:42:20,060
it just happened immediately<font color="#E5E5E5"> and people</font>

1007
00:42:18,260 --> 00:42:27,740
<font color="#E5E5E5">won't</font><font color="#CCCCCC"> completes this was</font><font color="#E5E5E5"> actually doing</font>

1008
00:42:20,060 --> 00:42:30,560
magic so really it cannot get you<font color="#E5E5E5"> I okay</font>

1009
00:42:27,740 --> 00:42:32,750
right I just<font color="#CCCCCC"> need to move the it's all</font>

1010
00:42:30,560 --> 00:42:34,310
very see this is a football<font color="#CCCCCC"> we've</font><font color="#E5E5E5"> like</font>

1011
00:42:32,750 --> 00:42:37,340
things that<font color="#E5E5E5"> aren't software it's very</font>

1012
00:42:34,310 --> 00:42:41,299
very sensitive right<font color="#E5E5E5"> let's let's try</font>

1013
00:42:37,340 --> 00:42:48,320
that again<font color="#E5E5E5"> it's such a big</font><font color="#CCCCCC"> build-up</font><font color="#E5E5E5"> for</font>

1014
00:42:41,300 --> 00:42:50,000
such a big<font color="#E5E5E5"> error you hang on hang on got</font>

1015
00:42:48,320 --> 00:42:53,480
<font color="#CCCCCC">wisdom for</font><font color="#E5E5E5"> a sec</font><font color="#CCCCCC"> westward</font><font color="#E5E5E5"> to like take</font>

1016
00:42:50,000 --> 00:42:56,390
the piss oh god<font color="#CCCCCC"> you're for fuck's sake</font>

1017
00:42:53,480 --> 00:43:05,000
man<font color="#CCCCCC"> don't keep that bit on the film will</font>

1018
00:42:56,390 --> 00:43:07,250
<font color="#E5E5E5">you cuz yeah I'm not</font><font color="#CCCCCC"> sure Lee now this</font>

1019
00:43:05,000 --> 00:43:09,050
should<font color="#CCCCCC"> definitely be one</font><font color="#E5E5E5"> for one one</font>

1020
00:43:07,250 --> 00:43:12,310
that<font color="#E5E5E5"> should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> one forty one down there</font>

1021
00:43:09,050 --> 00:43:15,070
that one's still reading in fairness

1022
00:43:12,310 --> 00:43:24,170
<font color="#CCCCCC">honestly that one is</font><font color="#E5E5E5"> still reading I</font>

1023
00:43:15,070 --> 00:43:26,470
know<font color="#E5E5E5"> you've</font><font color="#CCCCCC"> been helpful it's like not</font>

1024
00:43:24,170 --> 00:43:35,440
<font color="#CCCCCC">having two</font><font color="#E5E5E5"> hands it really is like him</font>

1025
00:43:26,470 --> 00:43:39,669
like this is<font color="#E5E5E5"> accessibility</font><font color="#CCCCCC"> errors yes</font><font color="#E5E5E5"> I</font>

1026
00:43:35,440 --> 00:43:39,670
could just hold it

1027
00:43:57,859 --> 00:44:19,130
that one is gone analog electronics is

1028
00:44:17,900 --> 00:44:22,700
so easy<font color="#E5E5E5"> I don't know what you were</font>

1029
00:44:19,130 --> 00:44:24,619
worried about<font color="#E5E5E5"> right</font><font color="#CCCCCC"> said away we need to</font>

1030
00:44:22,700 --> 00:44:26,569
run this command up here<font color="#E5E5E5"> okay</font>

1031
00:44:24,619 --> 00:44:29,359
and and<font color="#E5E5E5"> honestly we will come</font><font color="#CCCCCC"> back if</font>

1032
00:44:26,569 --> 00:44:31,400
this completes super quick<font color="#CCCCCC"> I'll do it</font>

1033
00:44:29,359 --> 00:44:34,130
again<font color="#E5E5E5"> with another pair so you can see</font>

1034
00:44:31,400 --> 00:44:37,489
oh look<font color="#E5E5E5"> at that</font><font color="#CCCCCC"> it's actually searching</font>

1035
00:44:34,130 --> 00:44:42,410
<font color="#CCCCCC">for a read command it's gone off the</font>

1036
00:44:37,489 --> 00:44:45,130
side<font color="#CCCCCC"> of the page I</font><font color="#E5E5E5"> found one and God</font>

1037
00:44:42,410 --> 00:44:53,509
Jesus<font color="#E5E5E5"> that's actually a really good</font><font color="#CCCCCC"> demo</font>

1038
00:44:45,130 --> 00:44:55,700
<font color="#E5E5E5">but there you go and</font><font color="#CCCCCC"> and so you can see</font>

1039
00:44:53,509 --> 00:44:57,859
that<font color="#E5E5E5"> that is definitely a tag that</font><font color="#CCCCCC"> I've</font>

1040
00:44:55,700 --> 00:45:00,968
read<font color="#E5E5E5"> because page 4 says dead beef and</font>

1041
00:44:57,859 --> 00:45:03,650
pages 5<font color="#E5E5E5"> 6 on my office phone number</font>

1042
00:45:00,969 --> 00:45:06,910
feel free to<font color="#CCCCCC"> ring me with all</font><font color="#E5E5E5"> of your</font>

1043
00:45:03,650 --> 00:45:10,459
high tech<font color="#CCCCCC"> to waves but</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> we know that</font>

1044
00:45:06,910 --> 00:45:14,089
<font color="#E5E5E5">we could do things like we could put it</font>

1045
00:45:10,459 --> 00:45:17,660
into<font color="#CCCCCC"> a high tech</font><font color="#E5E5E5"> to reader mode and we</font>

1046
00:45:14,089 --> 00:45:22,910
could use the ink the key that<font color="#CCCCCC"> we can</font>

1047
00:45:17,660 --> 00:45:25,038
pull<font color="#E5E5E5"> out of pages</font><font color="#CCCCCC"> 2 & 1</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> is the</font>

1048
00:45:22,910 --> 00:45:27,769
key<font color="#E5E5E5"> and we run that we</font><font color="#CCCCCC"> could then</font><font color="#E5E5E5"> take</font>

1049
00:45:25,039 --> 00:45:31,459
<font color="#E5E5E5">our other tags which are hidden away</font>

1050
00:45:27,769 --> 00:45:33,439
down<font color="#CCCCCC"> here see we don't</font><font color="#E5E5E5"> have to crack the</font>

1051
00:45:31,459 --> 00:45:38,089
<font color="#CCCCCC">other tags we can just read them you see</font>

1052
00:45:33,440 --> 00:45:42,469
so that<font color="#CCCCCC"> when is a beef face that one is</font>

1053
00:45:38,089 --> 00:45:46,459
feed face and if we read the special tag

1054
00:45:42,469 --> 00:45:49,430
for we notice<font color="#E5E5E5"> that pages wanted to are</font>

1055
00:45:46,459 --> 00:45:51,649
inaccessible<font color="#E5E5E5"> because</font><font color="#CCCCCC"> it's been</font>

1056
00:45:49,430 --> 00:45:56,479
configured<font color="#E5E5E5"> to not give you</font><font color="#CCCCCC"> the content</font>

1057
00:45:51,650 --> 00:45:57,799
<font color="#CCCCCC">sees</font><font color="#E5E5E5"> of pages 1 & 2 which I'm now going</font>

1058
00:45:56,479 --> 00:46:02,149
to flip<font color="#E5E5E5"> back to my size and talk about</font>

1059
00:45:57,799 --> 00:46:04,788
<font color="#E5E5E5">very briefly so that</font><font color="#CCCCCC"> was the demo</font><font color="#E5E5E5"> tag</font>

1060
00:46:02,150 --> 00:46:07,549
cloning<font color="#CCCCCC"> if you know the key</font><font color="#E5E5E5"> and they are</font>

1061
00:46:04,789 --> 00:46:09,589
not protecting the tags<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can just</font>

1062
00:46:07,549 --> 00:46:10,810
read<font color="#CCCCCC"> the tags</font><font color="#E5E5E5"> using that key that is</font>

1063
00:46:09,589 --> 00:46:12,279
provided

1064
00:46:10,810 --> 00:46:14,470
and then once you've read the tag<font color="#CCCCCC"> you</font>

1065
00:46:12,280 --> 00:46:16,990
<font color="#CCCCCC">can</font><font color="#E5E5E5"> write that to another tag the UID</font>

1066
00:46:14,470 --> 00:46:18,850
will be different<font color="#E5E5E5"> but it doesn't matter</font>

1067
00:46:16,990 --> 00:46:20,740
because<font color="#CCCCCC"> the you idea is not used for any</font>

1068
00:46:18,850 --> 00:46:22,450
access control decisions<font color="#E5E5E5"> it's only uses</font>

1069
00:46:20,740 --> 00:46:25,750
of randomization for the<font color="#CCCCCC"> PRNG</font><font color="#E5E5E5"> at the</font>

1070
00:46:22,450 --> 00:46:27,419
start<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> kryptek and you</font><font color="#E5E5E5"> can</font>

1071
00:46:25,750 --> 00:46:29,800
<font color="#E5E5E5">potentially do that at a distance</font>

1072
00:46:27,420 --> 00:46:31,690
<font color="#CCCCCC">although anyone</font><font color="#E5E5E5"> who wants to do</font><font color="#CCCCCC"> it at a</font>

1073
00:46:29,800 --> 00:46:32,290
distance who knows an electronics gain

1074
00:46:31,690 --> 00:46:34,560
touch

1075
00:46:32,290 --> 00:46:36,970
we have money and we'd like<font color="#E5E5E5"> to help</font>

1076
00:46:34,560 --> 00:46:40,390
invite something or<font color="#CCCCCC"> built-in</font><font color="#E5E5E5"> the added</font>

1077
00:46:36,970 --> 00:46:42,390
<font color="#CCCCCC">distance that works</font><font color="#E5E5E5"> so I'll quickly move</font>

1078
00:46:40,390 --> 00:46:46,210
on<font color="#E5E5E5"> to my closing</font><font color="#CCCCCC"> remarks</font>

1079
00:46:42,390 --> 00:46:49,299
this attack is amazing it's<font color="#E5E5E5"> really cool</font>

1080
00:46:46,210 --> 00:46:51,460
not because attacks<font color="#E5E5E5"> attack - or you</font>

1081
00:46:49,300 --> 00:46:54,130
could<font color="#E5E5E5"> use</font><font color="#CCCCCC"> it steal cars but because it's</font>

1082
00:46:51,460 --> 00:46:56,230
a<font color="#E5E5E5"> really neat</font><font color="#CCCCCC"> way of abusing the</font>

1083
00:46:54,130 --> 00:46:57,310
protocol of<font color="#CCCCCC"> the crypto and abusing</font>

1084
00:46:56,230 --> 00:47:00,250
something that people would generally

1085
00:46:57,310 --> 00:47:03,540
<font color="#CCCCCC">think</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> secure to actually</font><font color="#E5E5E5"> retrieve</font>

1086
00:47:00,250 --> 00:47:06,780
all of<font color="#CCCCCC"> the secrets and within the system</font>

1087
00:47:03,540 --> 00:47:08,920
<font color="#E5E5E5">so read the paper it's really clever</font>

1088
00:47:06,780 --> 00:47:12,190
there is hard to read but<font color="#E5E5E5"> you might</font>

1089
00:47:08,920 --> 00:47:14,890
<font color="#E5E5E5">wanna read the code instead but if they</font>

1090
00:47:12,190 --> 00:47:16,840
do<font color="#E5E5E5"> protect the tag then you can't use</font>

1091
00:47:14,890 --> 00:47:19,240
<font color="#CCCCCC">that attack</font><font color="#E5E5E5"> because you don't get pages</font>

1092
00:47:16,840 --> 00:47:20,860
<font color="#E5E5E5">1 or 2 you don't get the key that stops</font>

1093
00:47:19,240 --> 00:47:23,290
you being<font color="#E5E5E5"> out to clone tanks so instead</font>

1094
00:47:20,860 --> 00:47:25,390
you need to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> attacks two or</font><font color="#E5E5E5"> three</font>

1095
00:47:23,290 --> 00:47:27,190
that<font color="#E5E5E5"> come from the same paper or attack</font>

1096
00:47:25,390 --> 00:47:29,319
for that comes<font color="#CCCCCC"> from the later paper or</font>

1097
00:47:27,190 --> 00:47:30,880
<font color="#E5E5E5">five that comes from the early</font><font color="#CCCCCC"> GPO type</font>

1098
00:47:29,320 --> 00:47:32,740
or<font color="#E5E5E5"> six that comes from the late GPU</font>

1099
00:47:30,880 --> 00:47:36,610
attack<font color="#E5E5E5"> so to put this in the context</font>

1100
00:47:32,740 --> 00:47:39,549
attack<font color="#CCCCCC"> - to recover the key takes two</font>

1101
00:47:36,610 --> 00:47:41,620
days<font color="#CCCCCC"> to build a table a minute to get</font>

1102
00:47:39,550 --> 00:47:43,780
<font color="#CCCCCC">keystream off the tag you need a</font><font color="#E5E5E5"> valid</font>

1103
00:47:41,620 --> 00:47:47,680
tag<font color="#E5E5E5"> and then two minutes</font><font color="#CCCCCC"> to search the</font>

1104
00:47:43,780 --> 00:47:49,660
table to find matching key right so if

1105
00:47:47,680 --> 00:47:50,770
you've<font color="#E5E5E5"> got a valid tag attack</font><font color="#CCCCCC"> twos</font>

1106
00:47:49,660 --> 00:47:53,080
<font color="#E5E5E5">really awesome if you haven't got a</font>

1107
00:47:50,770 --> 00:47:55,570
valid tag<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> use attack 3 which</font>

1108
00:47:53,080 --> 00:47:57,670
only attacks the reader<font color="#E5E5E5"> you need to</font>

1109
00:47:55,570 --> 00:47:59,680
spend five minutes collecting values but

1110
00:47:57,670 --> 00:48:01,840
once you've got those values it takes<font color="#CCCCCC"> 16</font>

1111
00:47:59,680 --> 00:48:04,750
minutes on average<font color="#E5E5E5"> to attack the tag on</font>

1112
00:48:01,840 --> 00:48:06,910
my<font color="#E5E5E5"> Mac unoptimized</font><font color="#CCCCCC"> they reckon they can</font>

1113
00:48:04,750 --> 00:48:10,300
<font color="#CCCCCC">do it in</font><font color="#E5E5E5"> six minutes hence going to 360</font>

1114
00:48:06,910 --> 00:48:12,009
seconds<font color="#CCCCCC"> 6 minutes 16 minutes whatever</font><font color="#E5E5E5"> I</font>

1115
00:48:10,300 --> 00:48:13,570
didn't really bother optimizing<font color="#E5E5E5"> that</font>

1116
00:48:12,010 --> 00:48:15,310
attack but<font color="#E5E5E5"> basically if you</font><font color="#CCCCCC"> can get the</font>

1117
00:48:13,570 --> 00:48:17,080
values from<font color="#E5E5E5"> the reader you</font><font color="#CCCCCC"> can attack</font>

1118
00:48:15,310 --> 00:48:20,980
that<font color="#E5E5E5"> really quickly and get</font><font color="#CCCCCC"> the key</font>

1119
00:48:17,080 --> 00:48:24,130
equally attack<font color="#CCCCCC"> 4 takes the same values</font>

1120
00:48:20,980 --> 00:48:26,710
but<font color="#CCCCCC"> you only need about 16 of them may</font>

1121
00:48:24,130 --> 00:48:30,370
you 16 to 32 depending on how many<font color="#E5E5E5"> on</font>

1122
00:48:26,710 --> 00:48:31,930
<font color="#CCCCCC">your random luck or unluckiness</font><font color="#E5E5E5"> because</font>

1123
00:48:30,370 --> 00:48:34,060
it's a fast correlation attack which is

1124
00:48:31,930 --> 00:48:36,100
<font color="#CCCCCC">based on probability</font><font color="#E5E5E5"> and the actual</font>

1125
00:48:34,060 --> 00:48:38,710
<font color="#E5E5E5">attack</font><font color="#CCCCCC"> only takes 45 seconds it's really</font>

1126
00:48:36,100 --> 00:48:40,540
awesome<font color="#E5E5E5"> but you could just take two of</font>

1127
00:48:38,710 --> 00:48:43,180
those pairs of values<font color="#E5E5E5"> and run them</font>

1128
00:48:40,540 --> 00:48:45,550
against attack<font color="#CCCCCC"> five or six</font><font color="#E5E5E5"> attack five</font>

1129
00:48:43,180 --> 00:48:49,029
would take two<font color="#CCCCCC"> hours on average</font><font color="#E5E5E5"> on ec2</font>

1130
00:48:45,550 --> 00:48:52,240
using a<font color="#CCCCCC"> p2x</font><font color="#E5E5E5"> large but if you run it</font>

1131
00:48:49,030 --> 00:48:54,730
against the<font color="#E5E5E5"> P</font><font color="#CCCCCC"> to 8x large on e on Amazon</font>

1132
00:48:52,240 --> 00:48:57,430
which<font color="#CCCCCC"> it's got eight GPUs you can get it</font>

1133
00:48:54,730 --> 00:48:59,950
<font color="#CCCCCC">down to 15 minutes the same code will</font>

1134
00:48:57,430 --> 00:49:02,649
work<font color="#E5E5E5"> over multiple hosts with multiple</font>

1135
00:48:59,950 --> 00:49:04,509
<font color="#E5E5E5">GPUs so you could like have</font><font color="#CCCCCC"> that if</font><font color="#E5E5E5"> you</font>

1136
00:49:02,650 --> 00:49:07,000
had two hosts you could call<font color="#E5E5E5"> it</font><font color="#CCCCCC"> ad for</font>

1137
00:49:04,510 --> 00:49:08,760
house etc<font color="#E5E5E5"> and it all cost the same</font>

1138
00:49:07,000 --> 00:49:11,080
amount<font color="#CCCCCC"> of money</font><font color="#E5E5E5"> which is</font><font color="#CCCCCC"> five dollars</font>

1139
00:49:08,760 --> 00:49:13,920
which is a very cheap way of<font color="#E5E5E5"> attacking</font>

1140
00:49:11,080 --> 00:49:16,630
someone and stealing someone's BMW and

1141
00:49:13,920 --> 00:49:18,400
so the point<font color="#CCCCCC"> that I'd like to</font><font color="#E5E5E5"> make it my</font>

1142
00:49:16,630 --> 00:49:21,190
<font color="#CCCCCC">preferment</font><font color="#E5E5E5"> slide is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we can learn</font>

1143
00:49:18,400 --> 00:49:23,440
<font color="#CCCCCC">lots</font><font color="#E5E5E5"> from academics in the world of</font>

1144
00:49:21,190 --> 00:49:25,330
crypto<font color="#E5E5E5"> right so in the mode of quick in</font>

1145
00:49:23,440 --> 00:49:27,370
the world of like academia they might

1146
00:49:25,330 --> 00:49:28,990
not be the best hackers in the<font color="#CCCCCC"> world</font><font color="#E5E5E5"> we</font>

1147
00:49:27,370 --> 00:49:30,670
might think<font color="#CCCCCC"> that we know more</font><font color="#E5E5E5"> than</font><font color="#CCCCCC"> them</font>

1148
00:49:28,990 --> 00:49:33,100
<font color="#CCCCCC">because we're down and dirty and we're</font>

1149
00:49:30,670 --> 00:49:35,710
messing<font color="#CCCCCC"> with like tools in an attacking</font>

1150
00:49:33,100 --> 00:49:37,450
networks<font color="#E5E5E5"> and they are theorizing in</font>

1151
00:49:35,710 --> 00:49:40,300
their ivory towers<font color="#CCCCCC"> but</font><font color="#E5E5E5"> when it comes to</font>

1152
00:49:37,450 --> 00:49:43,810
crypto<font color="#CCCCCC"> zeros</font><font color="#E5E5E5"> in ivory</font><font color="#CCCCCC"> towers</font><font color="#E5E5E5"> seems to be</font>

1153
00:49:40,300 --> 00:49:45,670
<font color="#E5E5E5">the way to get the answers and I think</font>

1154
00:49:43,810 --> 00:49:47,470
that when they don't provide the tools

1155
00:49:45,670 --> 00:49:50,070
we can take their maths and we can

1156
00:49:47,470 --> 00:49:52,779
implement it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> make our own tools and</font>

1157
00:49:50,070 --> 00:49:54,160
the there must be a lot<font color="#CCCCCC"> of stuff</font><font color="#E5E5E5"> there</font>

1158
00:49:52,780 --> 00:49:56,020
we<font color="#E5E5E5"> haven't even noticed yet because we</font>

1159
00:49:54,160 --> 00:49:57,490
are<font color="#CCCCCC"> just</font><font color="#E5E5E5"> simply not looking there so I</font>

1160
00:49:56,020 --> 00:49:59,320
think we<font color="#E5E5E5"> should look more</font><font color="#CCCCCC"> in the world</font>

1161
00:49:57,490 --> 00:50:01,990
<font color="#E5E5E5">of academia implement more of their</font>

1162
00:49:59,320 --> 00:50:07,630
stuff and scare<font color="#E5E5E5"> everybody with that</font>

1163
00:50:01,990 --> 00:50:10,600
so my final<font color="#CCCCCC"> slide is</font><font color="#E5E5E5"> simply the</font><font color="#CCCCCC"> github</font>

1164
00:50:07,630 --> 00:50:14,290
for<font color="#CCCCCC"> Apache labs Limited which is where</font>

1165
00:50:10,600 --> 00:50:18,180
you can<font color="#E5E5E5"> find the RFID RF</font><font color="#CCCCCC"> our fiddler</font>

1166
00:50:14,290 --> 00:50:21,580
source which has<font color="#E5E5E5"> got all four of the</font>

1167
00:50:18,180 --> 00:50:24,009
first four attacks<font color="#CCCCCC"> and all of the slides</font>

1168
00:50:21,580 --> 00:50:25,990
<font color="#CCCCCC">to explain it and you can find</font><font color="#E5E5E5"> my</font>

1169
00:50:24,010 --> 00:50:28,560
<font color="#CCCCCC">contact me and get in touch</font><font color="#E5E5E5"> if you wish</font>

1170
00:50:25,990 --> 00:50:39,928
thank you<font color="#CCCCCC"> very much</font>

1171
00:50:28,560 --> 00:50:39,929
[Applause]

1172
00:50:45,440 --> 00:51:13,800
<font color="#CCCCCC">hmm I will be drinking more 42 the mics</font>

1173
00:51:11,820 --> 00:51:22,320
not on can you turn on<font color="#E5E5E5"> the mic for the</font>

1174
00:51:13,800 --> 00:51:24,470
audience please try<font color="#E5E5E5"> talking it might</font>

1175
00:51:22,320 --> 00:51:24,470
work

1176
00:51:28,190 --> 00:51:32,599
<font color="#CCCCCC">journalists shout and I'll repeat</font><font color="#E5E5E5"> it oh</font>

1177
00:51:34,640 --> 00:51:37,799
[Music]

1178
00:51:40,280 --> 00:51:43,550
yeah<font color="#E5E5E5"> check</font>

1179
00:51:43,820 --> 00:51:50,720
so obviously stream cyphers based on

1180
00:51:47,520 --> 00:51:55,890
lfsr's are not exactly<font color="#CCCCCC"> state of the art</font>

1181
00:51:50,720 --> 00:51:59,399
but could<font color="#E5E5E5"> we salvage a system like death</font>

1182
00:51:55,890 --> 00:52:04,980
<font color="#E5E5E5">by</font><font color="#CCCCCC"> taking a page out of</font><font color="#E5E5E5"> the blu-ray book</font>

1183
00:51:59,400 --> 00:52:08,070
and<font color="#E5E5E5"> having each tag have multiple say 64</font>

1184
00:52:04,980 --> 00:52:10,500
keys on it<font color="#E5E5E5"> 64 different keys on it so</font>

1185
00:52:08,070 --> 00:52:14,900
when you actually still one of<font color="#CCCCCC"> their</font>

1186
00:52:10,500 --> 00:52:19,410
cards you<font color="#E5E5E5"> can't compromise those 64 keys</font>

1187
00:52:14,900 --> 00:52:24,180
but somehow by clever use of<font color="#E5E5E5"> the other</font>

1188
00:52:19,410 --> 00:52:26,879
keys<font color="#E5E5E5"> you are able</font><font color="#CCCCCC"> to still</font><font color="#E5E5E5"> keep the</font>

1189
00:52:24,180 --> 00:52:28,169
integrity<font color="#E5E5E5"> of the entire system</font><font color="#CCCCCC"> oh you</font>

1190
00:52:26,880 --> 00:52:30,210
think<font color="#E5E5E5"> I mean I've not looked at that</font>

1191
00:52:28,170 --> 00:52:31,890
<font color="#E5E5E5">attack I think adding more keys would</font>

1192
00:52:30,210 --> 00:52:33,780
just give me<font color="#CCCCCC"> more</font><font color="#E5E5E5"> things to attack and</font>

1193
00:52:31,890 --> 00:52:35,790
<font color="#CCCCCC">I'd</font><font color="#E5E5E5"> end up with</font><font color="#CCCCCC"> a bank</font><font color="#E5E5E5"> of 64 keys in the</font>

1194
00:52:33,780 --> 00:52:38,099
dictionary<font color="#CCCCCC"> and then four I could</font>

1195
00:52:35,790 --> 00:52:39,279
probably<font color="#E5E5E5"> use</font><font color="#CCCCCC"> that to attack the rest</font><font color="#E5E5E5"> of</font>

1196
00:52:38,099 --> 00:52:41,500
the system and clay

1197
00:52:39,280 --> 00:52:43,780
all the<font color="#E5E5E5"> tags what you need is integrity</font>

1198
00:52:41,500 --> 00:52:47,560
protections<font color="#CCCCCC"> not</font><font color="#E5E5E5"> officer Katie enough the</font>

1199
00:52:43,780 --> 00:52:49,480
keys<font color="#E5E5E5"> so that's what this tag system</font>

1200
00:52:47,560 --> 00:52:51,549
<font color="#E5E5E5">doesn't provide and</font><font color="#CCCCCC"> what one-time pads</font>

1201
00:52:49,480 --> 00:52:54,040
<font color="#E5E5E5">then stream</font><font color="#CCCCCC"> self is generally don't</font>

1202
00:52:51,550 --> 00:52:58,290
<font color="#E5E5E5">providers is integrity but nowadays we</font>

1203
00:52:54,040 --> 00:53:04,330
have GCM and and various<font color="#CCCCCC"> other you know</font>

1204
00:52:58,290 --> 00:53:09,220
authenticated encryption<font color="#E5E5E5"> so yeah go grab</font>

1205
00:53:04,330 --> 00:53:10,480
you<font color="#E5E5E5"> clearly you were gonna know okay</font>

1206
00:53:09,220 --> 00:53:11,500
you're<font color="#CCCCCC"> probably gonna have to be the</font>

1207
00:53:10,480 --> 00:53:15,460
<font color="#E5E5E5">last one when you set up</font><font color="#CCCCCC"> with an</font>

1208
00:53:11,500 --> 00:53:17,920
<font color="#E5E5E5">expedient</font><font color="#CCCCCC"> just quick question would</font><font color="#E5E5E5"> all</font>

1209
00:53:15,460 --> 00:53:21,970
<font color="#E5E5E5">of that bit</font><font color="#CCCCCC"> flipping</font><font color="#E5E5E5"> of not worked if</font>

1210
00:53:17,920 --> 00:53:23,830
they put like a checksum<font color="#E5E5E5"> instead or CRC</font>

1211
00:53:21,970 --> 00:53:27,339
<font color="#E5E5E5">some like that</font>

1212
00:53:23,830 --> 00:53:30,160
no doesn't<font color="#CCCCCC"> at all</font><font color="#E5E5E5"> no doesn't</font><font color="#CCCCCC"> release all</font>

1213
00:53:27,340 --> 00:53:33,040
<font color="#CCCCCC">the</font><font color="#E5E5E5"> fun little it because at that point</font>

1214
00:53:30,160 --> 00:53:36,819
<font color="#E5E5E5">we where we</font><font color="#CCCCCC"> have the pad that we're</font>

1215
00:53:33,040 --> 00:53:38,380
<font color="#CCCCCC">attacking so it might expand the space</font>

1216
00:53:36,820 --> 00:53:42,220
that we need<font color="#E5E5E5"> to search</font><font color="#CCCCCC"> for them but it</font>

1217
00:53:38,380 --> 00:53:43,840
would<font color="#E5E5E5"> actually solve the problem all</font>

1218
00:53:42,220 --> 00:53:44,109
<font color="#E5E5E5">right</font><font color="#CCCCCC"> I think that's all we</font><font color="#E5E5E5"> have time</font>

1219
00:53:43,840 --> 00:53:48,600
for

1220
00:53:44,110 --> 00:53:48,600
thank you very much<font color="#E5E5E5"> keV thank you</font>

1221
00:53:51,030 --> 00:53:53,090
you

