1
00:00:00,315 --> 00:00:01,599
> So without further ado,  

2
00:00:01,600 --> 00:00:06,160
I'll hand it over to Cybergibbons to talk 
about hacking cruise ships! If you would!

3
00:00:06,160 --> 00:00:07,680
Great, thank you very much for the intro.

4
00:00:12,480 --> 00:00:14,720
Hello people, wonderful people!

5
00:00:14,720 --> 00:00:18,640
Today I'm going to be talking about hacking 
ships. I'm going to talk about how ships work,  

6
00:00:18,640 --> 00:00:22,320
how they're put together. Now this is the first 
time I've done this slide deck - it's a bit of  

7
00:00:22,320 --> 00:00:27,120
a mishmash of two different slide decks so 
it might get a bit crazy at a few points.

8
00:00:28,240 --> 00:00:33,360
So, who am I? Well my name's Andrew 
Tierney, my handle's Cybergibbons.  

9
00:00:33,360 --> 00:00:38,720
I'm a professional penetration tester, which is a 
ridiculous name for someone who tests the security  

10
00:00:38,720 --> 00:00:44,640
of various devices. This is me a few weeks ago 
on a 747 looking at some of the systems on board.  

11
00:00:44,640 --> 00:00:50,960
I lead the hardware team at a company called Pen 
Test Partners - we look at planes, ships, cars,  

12
00:00:50,960 --> 00:00:56,000
IoT hardware, industrial control systems. 
We call ourselves the "weird stuff team."  

13
00:00:56,000 --> 00:00:59,680
We just do all of that kind of 
non-general purpose computer things.

14
00:01:00,480 --> 00:01:03,680
So why can I talk about ships? Well this is me  

15
00:01:04,480 --> 00:01:10,400
16 years ago, I think, give or take - 2006? On 
a container ship in the Suez Canal. I used to  

16
00:01:10,400 --> 00:01:15,280
work on container ships as an engineer - so down 
in the engine room. I did that for a few years.  

17
00:01:16,080 --> 00:01:21,280
So I've got good knowledge of how ships 
work, bringing together the IT side of things  

18
00:01:21,280 --> 00:01:25,520
and the ship side of things allows me to 
really drill into how they work and find  

19
00:01:25,520 --> 00:01:30,640
really interesting vulnerabilities. At the end of 
this, I'm going to show you how i was sat in my  

20
00:01:30,640 --> 00:01:38,160
pants - I'm not actually going to show you that - 
I was sat at home on the sofa with remote control  

21
00:01:38,160 --> 00:01:42,399
of a cruise ship. I could steer a cruise 
ship remotely, so that's where this is going.  

22
00:01:43,840 --> 00:01:47,120
Now all of the work that I mentioned 
here is carried out with permission.  

23
00:01:47,120 --> 00:01:50,480
We were on the cruise ship with 
permission to attack those systems,  

24
00:01:51,040 --> 00:01:53,840
so don't go and do this when you're 
on a cruise. You will get in trouble.

25
00:01:56,560 --> 00:02:02,000
So what is it like working on a ship? Well, this 
is the view out of my cabin when I was a cadet  

26
00:02:02,000 --> 00:02:08,160
on container ships. I worked on kind of 300 
meter, 350 meter long container ships. Back in  

27
00:02:08,160 --> 00:02:13,920
those days they were the biggest container ships 
- they typically held between 6 and 7 thousand  

28
00:02:13,920 --> 00:02:19,920
TEUs - twenty-foot equivalent units - so that's 
half of a normal container that we're used to. So  

29
00:02:19,920 --> 00:02:24,799
it's a lot of containers. You can see there we're 
looking forward from the accommodation - you can  

30
00:02:24,800 --> 00:02:29,200
see all of those containers on the deck. Now most 
people think about container ships, when they go  

31
00:02:29,200 --> 00:02:32,720
past they look at all those containers stacked 
up on the deck and that's all they think of,  

32
00:02:33,600 --> 00:02:36,720
but actually the bulk of 
containers are below the decks  

33
00:02:36,720 --> 00:02:40,240
in the hold. So you take off a hatch 
lid - there's three hatch lids across  

34
00:02:40,240 --> 00:02:44,640
the width of the ship - and down there 
you can fill it up with containers.  

35
00:02:44,640 --> 00:02:50,079
So those are 40 foot equivalent units they fill 
that whole 40 foot gap - a 20 footer is smaller.

36
00:02:52,240 --> 00:02:55,840
On the right hand side there what you can 
see is something called a "bunker barge".  

37
00:02:55,840 --> 00:03:00,240
You obviously have to get your fuel from somewhere 
- now a container ship like this holds about  

38
00:03:00,880 --> 00:03:09,359
10,000 tonnes of what's called heavy fuel oil 
- HFO. Now that - it's expensive - it's $500  

39
00:03:09,360 --> 00:03:15,440
per tonne. So the first time I remember I was 
helping take bunkers - take that fuel on board,  

40
00:03:15,440 --> 00:03:23,680
I did the maths. 10,000 tonnes at $500 a 
tonne is the best part of $5m worth of fuel.  

41
00:03:23,680 --> 00:03:26,560
One little mistake and you 
could cause a real problem.

42
00:03:28,880 --> 00:03:33,280
This is a picture of a container ship that I 
worked on, whilst it was under construction. So  

43
00:03:33,280 --> 00:03:38,720
you can see that cross-section of the ship - how 
deep it goes down in the holds. Down the sides,  

44
00:03:38,720 --> 00:03:43,200
those hollow gaps at the sides - they're tanks 
- they hold ballast water or fuel. And you've  

45
00:03:43,200 --> 00:03:47,760
got a thing called the side passageway that goes 
all the way down at the top, all the way from the  

46
00:03:47,760 --> 00:03:53,760
back to the front and it's quite crazy - you can 
stand in there in heavy weather look down that  

47
00:03:53,760 --> 00:03:58,160
side passageway and, even on a container 
ship this size, you can physically see it  

48
00:03:58,160 --> 00:04:04,240
twisting from side to side and moving up and down. 
Unfortunately, 2006, we didn't have camera phones  

49
00:04:04,240 --> 00:04:09,600
really we didn't carry cameras about with us, so 
I don't have any videos of crazy stuff like this.

50
00:04:11,280 --> 00:04:15,760
So what is it that powers one of these? Well 
it's a really, really, really big engine.  

51
00:04:16,399 --> 00:04:22,640
So it's a two-stroke diesel engine. They're 
huge - they're three, four stories high.  

52
00:04:23,280 --> 00:04:28,799
That red box there is covering one of the exhaust 
valves on one of what we call the "units" - one of  

53
00:04:28,800 --> 00:04:36,800
the cylinders. Now this is a 10RTA96C - 10 
means 10 cylinders. So it's already got 10  

54
00:04:36,800 --> 00:04:43,680
cylinders - it's bigger than most car engines. 
96 means that the bore of the cylinder is 96  

55
00:04:43,680 --> 00:04:50,240
cm across. You can fit in the cylinders, they're 
that big. So these things are absolutely massive  

56
00:04:50,240 --> 00:04:55,000
that huge pipe you see going along the top there - 
the big silver one - that's the exhaust manifold.  

57
00:04:55,840 --> 00:05:01,599
The stroke of one of these as well: 2.4 
meters. The piston goes up and down 2.4 meters.  

58
00:05:03,600 --> 00:05:07,360
When you look up at it from what we call the 
"bottom plate" right down at the bottom of the  

59
00:05:07,360 --> 00:05:11,760
engine room you can see the scale - we've got 
three ladders going up towards the top of that  

60
00:05:11,760 --> 00:05:17,599
engine. Now that big round thing there, you might 
think that's a flywheel underneath there, but it's  

61
00:05:17,600 --> 00:05:22,320
not. It's actually what we call the "turning 
gear" - a massive cog. You use a tiny little  

62
00:05:22,320 --> 00:05:26,719
electric motor to spin the engine round before 
you start it, to make sure it's all lubricated.

63
00:05:28,720 --> 00:05:36,320
Now just to give you an idea of scale - this isn't 
my picture - that's what a banana is in relation  

64
00:05:36,320 --> 00:05:41,760
to one of these. You can see the little guy stood 
on the top there by the exhaust valves. Now these  

65
00:05:41,760 --> 00:05:47,120
engines are really different to normal car engines 
- first off, the crank case is so big that it's  

66
00:05:47,120 --> 00:05:52,880
got ladders inside it. You have to climb inside 
the engine to do some maintenance work - it's  

67
00:05:52,880 --> 00:05:58,800
really slippery and grim. But they're two-stroke - 
what you have to do is you have to pressurise the  

68
00:05:58,800 --> 00:06:04,240
space underneath the piston so you can force air 
in at the bottom and then the exhaust goes out of  

69
00:06:04,240 --> 00:06:09,200
the valve at the top. It's like a two-stroke 
motorbike engine where the crank case is  

70
00:06:09,200 --> 00:06:13,680
pressurised. It's not technically the crank case 
in this situation, but it is quite different.

71
00:06:16,000 --> 00:06:21,520
So what does a piston and a cylinder liner look 
like in one of these? So on the left hand side  

72
00:06:21,520 --> 00:06:27,760
there, you've got a piston. You carry a spare 
piston so you can swap it out. It's absolutely  

73
00:06:27,760 --> 00:06:34,159
massive. On the right hand side you've got a 
cylinder liner. It weighs about nine tonnes  

74
00:06:34,160 --> 00:06:39,360
so these are heavy, heavy things. Again, you carry 
a spare cylinder liner. Those holes you see around  

75
00:06:39,360 --> 00:06:43,840
the bottom - that's where the air gets forced 
into the cylinder to push the exhaust gas out.

76
00:06:46,400 --> 00:06:49,919
Now of course, you have to measure 
to see if the engine gets worn  

77
00:06:49,920 --> 00:06:54,560
so you take the exhaust valve off, which - I 
made it sound like it's simple, it's not that  

78
00:06:54,560 --> 00:07:00,320
simple - and you climb inside the cylinder. You 
use a very long micrometer - it's a stick - and  

79
00:07:00,320 --> 00:07:04,719
you measure the wear on the cylinder. This is 
when one of the ships I was on was being built.

80
00:07:08,240 --> 00:07:14,000
Another crazy thing: those pistons need to be 
kept cool. You need to keep that piston actually  

81
00:07:14,000 --> 00:07:19,040
physically cool. It's not like a car where 
you can just rely on the oil in the crank case  

82
00:07:19,040 --> 00:07:24,400
and the rest of the liner keeping it cool, so 
what actually happens is oil gets sent up the  

83
00:07:24,400 --> 00:07:29,840
middle of the piston rod, sprayed through - I 
think about 56 - nozzles onto the underside of  

84
00:07:29,840 --> 00:07:34,960
the piston and then it drains back down into the 
crank case. Really really cool little system that.

85
00:07:36,240 --> 00:07:40,960
So how do you get the power from the engine 
through to the propeller? It's just one big  

86
00:07:40,960 --> 00:07:45,919
propeller, that's it. Well, you've got a gigantic 
prop shaft, and that is the prop shaft on this  

87
00:07:45,920 --> 00:07:52,400
ship. It's quite long, it's quite thick - I think 
it's about 90 cm across again - a massive, solid  

88
00:07:52,400 --> 00:07:58,239
chunk of metal to carry the power from the main 
engine back to the propeller. And how big is one  

89
00:07:58,240 --> 00:08:04,800
of the propellers? Well, it's about that big. This 
is when one of the ships I was on was in dry dock,  

90
00:08:04,800 --> 00:08:10,240
so you can see the sheer size of this thing -
it's absolutely massive. The edge of that  

91
00:08:10,240 --> 00:08:14,880
propeller actually moves so quickly that you get 
cavitation - little bubbles of steam forming.  

92
00:08:16,320 --> 00:08:20,320
One of the ships I served on, the Southampton, 
actually had a tiny little window in one of the  

93
00:08:20,320 --> 00:08:24,400
ballast tanks when they did a study to 
monitor how that cavitation happened so  

94
00:08:24,400 --> 00:08:27,760
they put a camera in there to watch 
the propeller go round underwater.

95
00:08:30,400 --> 00:08:34,319
Now a weird thing about these these ships 
is the engines don't really go that fast.  

96
00:08:34,960 --> 00:08:41,039
If you're moving a chunk of six tonnes worth 
of piston up and down, moving it two and a  

97
00:08:41,039 --> 00:08:48,079
half metres, you can't move it that quickly. 
So at most they do about 105 revs per minute,  

98
00:08:48,640 --> 00:08:53,600
so very very slow compared to a car engine. 
When you're stood on the top plates and the  

99
00:08:53,600 --> 00:08:58,480
engine's running it will shake you. It pulses 
through your body - it's that kind of frequency.  

100
00:08:59,520 --> 00:09:04,800
Now the other thing is that, if you want to go 
in reverse, you don't have a gearbox. There's  

101
00:09:04,800 --> 00:09:09,920
no gearbox to change your direction. You stop 
the engine, and you turn it round and make it  

102
00:09:09,920 --> 00:09:14,800
go the other way. You literally reverse the 
engine to change direction. So if you need to  

103
00:09:14,800 --> 00:09:22,000
come to an abrupt halt - you're motoring along, 
100 rpm, 25 knots, and you need to stop quickly,  

104
00:09:22,000 --> 00:09:26,320
you need to stop the engine, bring it back in 
the other direction, and try and slow down.

105
00:09:28,720 --> 00:09:32,320
Now how much power do these make? Well, 
it's kind of variable but it's between  

106
00:09:32,320 --> 00:09:37,920
80 megawatts and 120 megawatts, so we're 
talking really, really huge amounts of power.  

107
00:09:38,560 --> 00:09:43,520
This is the power meter on the ship. Now the the 
cool thing is, the way it actually measures how  

108
00:09:43,520 --> 00:09:48,400
much power is developed on the engine is, it's 
got two sensors on the prop shaft - a couple of  

109
00:09:48,400 --> 00:09:53,360
meters apart from each other - and it measures 
how much that 90 centimetre chunk of metal  

110
00:09:53,360 --> 00:09:57,920
twists. It's actually measuring the 
twist in that to work out how much power.  

111
00:09:57,920 --> 00:10:04,319
At this moment in time we're doing 65 revs - quite 
low revs - we're only developing 15 megawatts.  

112
00:10:04,320 --> 00:10:08,480
Not that much power - I say, like 
that's a token amount of power.

113
00:10:10,160 --> 00:10:17,920
How do you start one of these things? Well, 
there's a thousand tons of rotating metal there.  

114
00:10:17,920 --> 00:10:23,839
You can't just turn an electric motor on, like 
in a car. So you start it with compressed air.  

115
00:10:24,400 --> 00:10:32,000
So this is called the start air system. It's 30 
bar, so that's just over 400 psi, give or take.  

116
00:10:32,000 --> 00:10:38,240
This is scary pressures - most air compressors 
kind of top out at about 150 psi. If you make a  

117
00:10:38,240 --> 00:10:43,680
mistake at these pressures, bad things are going 
to happen. Each one of those tanks - the walls  

118
00:10:43,680 --> 00:10:49,359
are huge, huge thickness. But you store that 
air up, and then something like a distributor,  

119
00:10:49,360 --> 00:10:54,000
a pneumatic distributor, admits air into each 
cylinder one by one and starts the engine.

120
00:10:56,480 --> 00:11:01,040
You also need to open and close the 
exhaust valve, and you need to inject fuel.  

121
00:11:01,040 --> 00:11:04,480
So this is on what we call the "middle plates" 
- the kind of middle section of the engine.  

122
00:11:05,200 --> 00:11:10,480
On the outside there - the two big silver pipes 
leading up - they're hydraulic lines, leading  

123
00:11:10,480 --> 00:11:16,320
to the exhaust valves. So they're hydraulically 
actuated - a massive camshaft is rotating around  

124
00:11:16,320 --> 00:11:23,360
underneath pushing hydraulic fluid up there. The 
bit in the middle is the fuel pump: it pushes  

125
00:11:23,920 --> 00:11:29,760
fuel - heated up to about 140 degrees celsius - 
up through a pipe, through to the cylinder head,  

126
00:11:29,760 --> 00:11:32,800
where it gets split into three and 
it goes in through three injectors.  

127
00:11:34,000 --> 00:11:39,440
So this fuel pump covers two units, so you've 
got multiple fuel pumps across the length of  

128
00:11:39,440 --> 00:11:44,720
the engine. Now, normally all of this is done 
automatically - all of it's happening in the  

129
00:11:44,720 --> 00:11:49,920
background by pressing buttons on the bridge - 
but you've got to practice for when systems fail.

130
00:11:52,000 --> 00:11:55,840
So, right in the middle of all of these 
main engines you have some sticks.  

131
00:11:56,560 --> 00:12:02,239
You literally have sticks that control how the 
fuel is admitted to the engine. At the moment you  

132
00:12:02,240 --> 00:12:07,280
can see there we're in "remote control" position, 
but what you can do is you can take it out into  

133
00:12:07,280 --> 00:12:12,240
"run" and "start." So you put it into "run", you 
pull it through to "start" - it will put that  

134
00:12:12,240 --> 00:12:17,520
start air through into the system - you can choose 
"forward" or "astern" - and then, on the right  

135
00:12:17,520 --> 00:12:22,000
hand side, you've got something that controls 
how much fuel is being admitted to the engine.  

136
00:12:22,000 --> 00:12:26,720
So we'd practice this - you call it "riding 
the sticks" - it's really, really challenging.

137
00:12:27,920 --> 00:12:33,760
Normally, that control system is metering how much 
fuel there is - 10 times per revolution - and you  

138
00:12:33,760 --> 00:12:38,800
don't have that ability, so you're sat there 
trying to maintain revolutions. Really, really  

139
00:12:38,800 --> 00:12:43,760
challenging. You've got to wear a headset as well 
- the noise in the engine room is deafening, so  

140
00:12:43,760 --> 00:12:47,600
you've got to wear a headset to get instructions 
from the bridge if they need to change speed.

141
00:12:49,520 --> 00:12:54,960
You remember I said that you need to have that 
pressure in the crankcase to force the fresh  

142
00:12:54,960 --> 00:13:01,680
air into the piston when it's down at the bottom? 
And the way we do that is with turbochargers. So  

143
00:13:01,680 --> 00:13:08,160
these are the turbochargers - that's the exhaust 
side of one of three turbochargers. They're about  

144
00:13:08,160 --> 00:13:14,800
the size of me - so not actually that tall. The 
thing is, though, those turbochargers kind of  

145
00:13:14,800 --> 00:13:20,959
stop working at low speeds - anything below about 
25-30 rpm, they just don't have the exhaust gas  

146
00:13:20,960 --> 00:13:26,080
to generate airflow, so on the left hand side 
we have what's called a "scavenge blower" - it's  

147
00:13:26,080 --> 00:13:31,920
an electric fan that forces air into the 
scavenge space to take up for the turbocharger.  

148
00:13:33,200 --> 00:13:37,120
The noise at this part of the engine room 
is deafening - these are like jet engines,  

149
00:13:37,120 --> 00:13:42,720
essentially - they're massive turbines. You 
wear ear defenders, obviously, but I'd often put  

150
00:13:42,720 --> 00:13:47,840
ear plugs inside the air defenders working 
in these areas just because of the noise.

151
00:13:49,440 --> 00:13:54,480
Now the interesting thing is, your 
turbocharger's got exhaust gas going over it,  

152
00:13:54,480 --> 00:13:57,840
and it will get dirty. I mean, it 
will get filthy - really, really,  

153
00:13:57,840 --> 00:14:03,680
dank. And you need to get that filth off it, so 
what you do is you get crushed walnut shells.  

154
00:14:03,680 --> 00:14:07,920
Literally tiny little bits of crushed walnut 
and you put it in that little green tank,  

155
00:14:07,920 --> 00:14:12,640
you pressurise the little green tank with air, 
and you inject it into the engine - into the  

156
00:14:12,640 --> 00:14:17,520
exhaust - and it will hit the turbine and all 
of the crap will come off. It will fall off,  

157
00:14:17,520 --> 00:14:20,960
and just go through into the exhaust. 
It's a really, really clever idea.

158
00:14:22,160 --> 00:14:26,319
Now, the intake for these - it takes the air from 
the engine room. It just sucks the air in through  

159
00:14:26,320 --> 00:14:30,560
a big filter on the other side, so it's coming 
through the engine room. You get a really weird  

160
00:14:30,560 --> 00:14:35,599
effect called "turbocharger surge" sometimes 
- it's kind of when the amount of air that the  

161
00:14:35,600 --> 00:14:40,000
engine's bringing in doesn't really match up 
with how much the turbocharger's generating,  

162
00:14:40,000 --> 00:14:44,240
and the turbocharger "burps" 
or "coughs", people say.

163
00:14:44,240 --> 00:14:48,800
Now having stood next to one of 
them this big when it coughs...yeah,  

164
00:14:48,800 --> 00:14:52,079
it's a bit more than a cough, 
to be fair. It's a bit scary.

165
00:14:53,520 --> 00:14:58,400
Now the next slide, there's a mild picture of a 
mild injury on it - it's just a red arm really,  

166
00:14:58,400 --> 00:15:04,880
but i thought, just in case. Seafaring's dangerous 
- there's all of this machinery, all of this stuff  

167
00:15:04,880 --> 00:15:10,480
going on round you and accidents happen. And you 
might recognise that picture on the right hand  

168
00:15:10,480 --> 00:15:15,760
side there - it's exactly the same colour - it is, 
well, it's the forward turbocharger off that very  

169
00:15:15,760 --> 00:15:21,520
same ship. I was on board when this happened. This 
is an accident report - essentially the pipe came  

170
00:15:21,520 --> 00:15:29,280
off the front of that tank. 7 bar air hit him with 
the, um, the walnuts. That sounds a bit strange!

171
00:15:30,720 --> 00:15:35,040
It didn't actually look that bad to start with - 
it just looked like his skin was wet - you know,  

172
00:15:35,040 --> 00:15:39,760
like an abrasion, but then over the course of the 
next hour or so he was in real severe pain and we  

173
00:15:39,760 --> 00:15:45,360
actually had to divert to another port to take him 
to hospital. It's a pretty serious accident, that.

174
00:15:47,760 --> 00:15:53,360
Another thing that that ships this size - engines 
this size - have got that's unique is the crank  

175
00:15:53,360 --> 00:15:59,760
case. It's huge - it's this massive space, and 
it's full of a mixture of oil and air. Now the  

176
00:15:59,760 --> 00:16:05,200
problem is, if you get a hot spot - friction on a 
bearing or something like that - it will produce  

177
00:16:05,200 --> 00:16:09,920
an oily mist, and you have something called 
an "oil mist detector", and it sucks in air  

178
00:16:09,920 --> 00:16:14,400
from each one of the units to detect whether 
it's got to explosive quantities in there,  

179
00:16:14,400 --> 00:16:20,959
or an explosive proportion. Because sometimes it 
does blow up - it's sunk ships before. These big  

180
00:16:20,960 --> 00:16:26,400
round doors on the side - they're explosion 
relief valves. If there is an explosion,  

181
00:16:26,400 --> 00:16:31,840
it lets the explosion out but doesn't let air 
back in, so there can't be a secondary explosion.

182
00:16:33,200 --> 00:16:39,120
Now this main engine, it needs power. It needs all 
those pumps, it needs cooling, all of these things  

183
00:16:39,120 --> 00:16:44,960
going on. So you need to generate electricity to 
make the main engine work, and you do that with  

184
00:16:44,960 --> 00:16:52,320
generators. So on this particular ship - the 
green one that we see here - we had four 3.6  

185
00:16:52,320 --> 00:17:01,520
megawatt generators, so just over 14 megawatts of 
power. Quite a lot. They power all of the pumps,  

186
00:17:01,520 --> 00:17:06,639
they power all of the systems on board - it's 
quite a lot of power. But you do have all of  

187
00:17:06,640 --> 00:17:12,079
those ancillary systems: you've got all the pumps, 
so you've got high temperature cooling water which  

188
00:17:12,079 --> 00:17:17,119
transfers heat to low temperature cooling water, 
which transfers it into sea water. You've got lube  

189
00:17:17,119 --> 00:17:22,800
oil systems for the main engine, you've got fuel 
systems. Hundreds of pumps. Fire fighting water.  

190
00:17:24,160 --> 00:17:29,280
Just so much stuff going on. You've also got these 
big heat exchangers which are titanium plates  

191
00:17:29,920 --> 00:17:33,040
stacked together with rubber gaskets 
between them. Sometimes you have to  

192
00:17:33,040 --> 00:17:37,840
open them up and clean them - it's a really, 
really unpleasant job with a pressure washer.  

193
00:17:39,520 --> 00:17:44,320
We've also got to purify the fuel so 
those bulbous things are called fuel  

194
00:17:44,320 --> 00:17:47,919
oil purifiers. They're centrifugal 
purifiers - they spin round at some  

195
00:17:47,920 --> 00:17:53,600
god-awful rpm and they take water and dirt out 
of the fuel so it can be used in the main engine.  

196
00:17:54,560 --> 00:17:58,560
And on the right-hand side my favourite piece 
of engine room equipment: the shit tank.

197
00:18:00,640 --> 00:18:05,040
When you're the junior one on a ship, you 
look after the sewage plant. You're the one  

198
00:18:05,040 --> 00:18:10,960
who deals with everybody else's poo. It's not just 
a tank though - it's actually a digesting plant.  

199
00:18:10,960 --> 00:18:16,160
It takes the sewage in, it digests it, bubbles 
air through it, chlorinates it on the outside,  

200
00:18:16,160 --> 00:18:20,320
and then puts it into the sea. I did actually 
quite like looking after it, to be fair.

201
00:18:22,000 --> 00:18:28,640
The electrical systems on these ships are hugely 
complex. So those generators you saw, they run  

202
00:18:28,640 --> 00:18:35,360
at 6.6 kilovolts. That's a really scary voltage. 
Now the only thing on the ship that actually uses  

203
00:18:35,360 --> 00:18:41,520
voltage at that level is the bow thruster - a 
massive propeller that sits underwater in the  

204
00:18:41,520 --> 00:18:47,120
bow at the front of the ship, that helps you dock. 
Everything else gets dropped down to 440 volts  

205
00:18:47,120 --> 00:18:54,320
like you'd have in most industrial situations. 
Now, the thing is, to get those big generators  

206
00:18:54,320 --> 00:18:59,760
starting - those four 3.6 megawatt generators - 
well they need loads of pumps running as well, so  

207
00:18:59,760 --> 00:19:04,879
you have what's called an emergency generator. Now 
this is a genuinely baby generator - 300 kilowatts  

208
00:19:04,880 --> 00:19:10,800
or so - normally in the accommodation, sometimes 
up forwards, and that will generate enough power  

209
00:19:10,800 --> 00:19:15,760
to compress air, to get pumps starting, to get one 
diesel generator running, which can then bring up  

210
00:19:15,760 --> 00:19:21,200
the other diesel generators, that will then start 
the main engine. If you lose all of those systems  

211
00:19:21,200 --> 00:19:26,160
you have what's called a blackout. You lose all 
electricity. The ship will stop working for a  

212
00:19:26,160 --> 00:19:31,120
few seconds. There's a few battery-backed things 
but nearly everything will stop at that point,  

213
00:19:31,120 --> 00:19:36,239
and if that happens at an inopportune moment - 
the Malacca Straits, the English Channel - you  

214
00:19:36,240 --> 00:19:41,440
lose power, if the main engine stops working, if 
you lose electricity, you don't have a rudder,  

215
00:19:41,440 --> 00:19:46,080
if you're not moving forward, the rudder doesn't 
work. So it's something you really want to avoid.

216
00:19:48,560 --> 00:19:51,440
This is the switchboard room. At the 
left-hand side you've got what's called  

217
00:19:51,440 --> 00:19:56,320
a "mimic panel" - it's all the buttons 
to control that 6.6 kilovolt system.  

218
00:19:56,320 --> 00:20:00,800
On the right-hand side you've got what's called 
a "motor control centre" - it's all contactors  

219
00:20:00,800 --> 00:20:06,000
and the control systems that control all 
the pumps and machines in the engine room.

220
00:20:06,000 --> 00:20:11,760
The 6.6 kilovolt stuff is just scary territory. 
I remember the first voyage I went on we used to  

221
00:20:11,760 --> 00:20:16,000
rack these breakers out, after making sure they 
were dead, just wearing a boiler suit. That was  

222
00:20:16,000 --> 00:20:21,760
it. Well, shoes and stuff as well, but there was 
no specific protection gear. But then there was a  

223
00:20:21,760 --> 00:20:25,920
really serious accident where someone I think 
lost the front part of their arm because they  

224
00:20:25,920 --> 00:20:30,160
racked a breaker out without making sure it was 
isolated, and from that point onwards we had to  

225
00:20:30,160 --> 00:20:35,200
get these crazy suits on - face masks, use loads 
of equipment to make sure we were doing it right.

226
00:20:36,880 --> 00:20:41,440
That's the bow thruster - it's a 6.6 
kilovolt motor normally about two,  

227
00:20:41,440 --> 00:20:45,520
two and a half megawatts, and all it does is move 
water from one side of the ship to the other,  

228
00:20:45,520 --> 00:20:47,840
so you can move the front of the ship in and out.

229
00:20:48,960 --> 00:20:54,160
But the reason for having 14 megawatts of power on 
those generators is actually these things - what  

230
00:20:54,160 --> 00:21:00,000
we call "reefers". Refrigerated cargo. So, when 
you take one of these on board you've got to power  

231
00:21:00,000 --> 00:21:05,520
it - you've got to plug it into the ship. You've 
got to get three-phase power to it. Now for, say,  

232
00:21:05,520 --> 00:21:13,680
the Southampton - a ship I was on - it took 6,000 
TEUs - so 3,000 40-footers - but only 700 of those  

233
00:21:13,680 --> 00:21:18,640
spaces were allowed to be occupied by reefers. So 
they were the ones you could plug the power into.  

234
00:21:19,680 --> 00:21:23,440
It was a hugely time consuming job 
monitoring and keeping them all going.  

235
00:21:24,720 --> 00:21:29,120
Now, I don't know if you saw this a while 
back on Twitter - there was this beer mat:  

236
00:21:29,120 --> 00:21:34,879
"the largest cargo ships can store 745 
million bananas in nearly 15,000 containers".

237
00:21:36,400 --> 00:21:40,400
No, no, this just doesn't make sense. What 
they've done is they've worked out how many  

238
00:21:40,400 --> 00:21:44,880
bananas, if you filled every single 
container on the ship with bananas,  

239
00:21:44,880 --> 00:21:49,120
but there are no ships that can 
take a full 100% banana load.

240
00:21:51,520 --> 00:21:57,840
There's new sequences of words 
happening here. But yeah, ridiculous.

241
00:22:00,480 --> 00:22:05,600
Now, container ships like this operate what's 
called unmanned machinery space or UMS.  

242
00:22:05,600 --> 00:22:09,360
That means, as an engineer, I can 
go to work between eight and five  

243
00:22:09,360 --> 00:22:13,360
and then at five o'clock we put 
it into UMS, and then I can go  

244
00:22:13,920 --> 00:22:18,160
and have my dinner, chill out in the evening 
- unlike the deckies you have to look out the  

245
00:22:18,160 --> 00:22:22,640
window all of the time. So there's loads of 
alarms and things going on in the background.  

246
00:22:24,320 --> 00:22:29,120
This is the alarm signal light that you get - I'm 
sure it's got a better name than that - we just  

247
00:22:29,120 --> 00:22:33,600
call them lights. The top one there - the green 
one - you never want to see that lit. That's a  

248
00:22:33,600 --> 00:22:38,560
lifeboat - that means abandon ship. If you see 
that lit, it's a bit of a game over situation.

249
00:22:39,120 --> 00:22:45,120
The one below it - the cog and the fire - means 
a fire in the machinery space. Again, not great  

250
00:22:45,120 --> 00:22:49,840
to be honest. You don't really want to see that, 
but every now and then it will go off - a bit of  

251
00:22:49,840 --> 00:22:55,520
oily mist, someone will be welding, something like 
that. The one below, it's actually - unfortunately  

252
00:22:55,520 --> 00:23:00,160
I never got any pictures of this - the whole 
engine room can be flooded with CO2 if there's  

253
00:23:00,160 --> 00:23:04,480
a fire. You seal all the doors, you seal 
all the vents, and you dump CO2 into it.  

254
00:23:05,360 --> 00:23:12,240
On this particular ship it had about 120 of those 
massive CO2 bottles, wired up to a huge manifold,  

255
00:23:12,240 --> 00:23:17,200
and it would trigger and fill the space. If you're 
in that space and you see that light come on,  

256
00:23:17,200 --> 00:23:22,800
you've got 15 seconds to get out before it gets 
triggered. You'd obviously try not to trigger it  

257
00:23:22,800 --> 00:23:26,800
with someone in there, but, you know. The 
other one's the cog - a machinery alarm,  

258
00:23:26,800 --> 00:23:30,639
something's not working quite right. The 
telegraph one - that's if you're having  

259
00:23:30,640 --> 00:23:35,840
to ride the sticks on the side of the engine. The 
next one unsurprisingly means the phone's ringing.

260
00:23:38,400 --> 00:23:41,520
Now, when you're in your cabin, when you're 
having dinner, when you're in the bar,  

261
00:23:42,160 --> 00:23:46,640
what you have is panels - alarm panels on 
the walls of those rooms. And you'll go in  

262
00:23:46,640 --> 00:23:50,960
as that duty engineer on watch, who has to 
monitor those alarms that night and they will  

263
00:23:50,960 --> 00:23:56,720
come through to this panel. So if you're having 
lunch and an alarm goes off, you go and have a  

264
00:23:56,720 --> 00:24:02,720
look and it will say something like "header tank 
low level", something like that, and then you'll  

265
00:24:02,720 --> 00:24:05,840
go and investigate it - you'll go back down to 
the engine room and see what the problem is.

266
00:24:07,440 --> 00:24:13,360
Now sometimes, you'd go down to the engine room 
and things would have not gone too well. Something  

267
00:24:13,360 --> 00:24:17,840
bad would be happening. Something to make your 
day unhappy. And there's this big button - well,  

268
00:24:17,840 --> 00:24:20,240
lots of buttons like this you'd 
press - and what that would do,  

269
00:24:20,240 --> 00:24:25,120
is it would alert every single engineer on board 
and alert the bridge that there was a problem.

270
00:24:26,960 --> 00:24:30,640
Now, one of these problems that we 
saw: I got an alarm at lunchtime  

271
00:24:30,640 --> 00:24:36,480
and I go down to the engine room, and inside 
that red square there, water was spraying out.  

272
00:24:36,480 --> 00:24:41,200
That's the high temperature cooling system, 
so we're talking water at over 100 degrees  

273
00:24:41,200 --> 00:24:46,960
celsius - because it's slightly pressurised - 
spraying out of here. Yeah, not a good situation.  

274
00:24:48,480 --> 00:24:53,360
So what had happened was that header tank at the 
top there should normally be full - it's like a  

275
00:24:53,360 --> 00:24:58,320
header tank in any system - we sprung a leak on 
the main engine and that header tank was dropping  

276
00:24:58,320 --> 00:25:04,480
down really, really, rapidly. Now the thing is, 
that high temperature cooling system is shared  

277
00:25:04,480 --> 00:25:09,920
between the diesel generators and the main engine. 
If we lose that high temperature cooling system,  

278
00:25:09,920 --> 00:25:14,960
we lose the main generators, which in turn 
means that we can't get the main engine started.

279
00:25:16,080 --> 00:25:23,280
What we actually did was we got the engine stopped 
very quickly, and we lifted the fuel pump. So what  

280
00:25:23,280 --> 00:25:27,600
you do is you can literally - that big fuel pump 
on the middle plates - you can turn a handle on  

281
00:25:27,600 --> 00:25:31,439
the side of it so that cylinder no longer does 
anything. There was no longer an immediate  

282
00:25:31,440 --> 00:25:36,320
requirement for cooling on that cylinder, so 
we could get underway and then fix the problem.

283
00:25:37,520 --> 00:25:42,879
The other one - and this was the worst few 
weeks of my life, maybe that's a bit of an  

284
00:25:42,880 --> 00:25:49,040
exaggeration - I was asleep in bed at about 
ten past seven in the morning and the general  

285
00:25:49,040 --> 00:25:53,520
alarm sounds, which is, you know - that's when 
someone hits that "assistance required" button.  

286
00:25:54,720 --> 00:26:01,040
Boiler suit on, straight down to the engine 
room, and we've got a real situation. About  

287
00:26:01,040 --> 00:26:05,920
two tonnes of fuel oil had sprayed out the top 
of the main engine all over the engine room.  

288
00:26:05,920 --> 00:26:13,120
There was a fine mist of of oil everywhere, and 
what had happened is this little tiny pipe that  

289
00:26:13,120 --> 00:26:18,239
circulates fuel around the main engine, all of the 
time just to keep it warm - the fuel's got to be  

290
00:26:18,240 --> 00:26:22,560
kept heated up to 140 degrees - it 
just gets circulated around an 8 mm  

291
00:26:22,560 --> 00:26:29,200
line - had come off in the middle of the night 
and dumped two tonnes of fuel across the engine.

292
00:26:30,640 --> 00:26:33,520
So it's sprayed out, it got everywhere.  

293
00:26:34,080 --> 00:26:38,800
It was all the way down at the bottom, all over 
the top plates, all over the bottom plates,  

294
00:26:38,800 --> 00:26:47,840
in the bilges. It took us weeks and a crew of 
about 15 Taiwanese women on board - probably not  

295
00:26:47,840 --> 00:26:52,959
great that we're employing cheap labour like that 
to be honest - to clean the ship, it was crazy.

296
00:26:54,480 --> 00:26:58,080
Right, we're actually on track for 
time, so these are just some of the  

297
00:26:58,080 --> 00:27:02,399
things that people see about ships and 
think "well that's cool". But that was  

298
00:27:02,960 --> 00:27:06,320
16 years ago - I don't do that any 
more, I hack stuff for a living.

299
00:27:06,320 --> 00:27:13,439
So, why hack a ship? Well, I'll be honest with 
you. I saw Speed 2. That's quite a good film.  

300
00:27:13,440 --> 00:27:17,680
You know, essentially someone on board the ship 
hacks the ship. And I think a few of you probably  

301
00:27:17,680 --> 00:27:23,600
last night might have watched Hackers, which 
also involves the plotline of of hacking ships  

302
00:27:23,600 --> 00:27:30,480
remotely. And I don't know if anybody recognises 
that - yes Bugs! - this is so formative in my  

303
00:27:30,480 --> 00:27:36,000
career, it was just such a major influence to me 
when I was a kid. They just got involved with all  

304
00:27:36,000 --> 00:27:40,000
these crazy plots. I don't know if they ever 
did actually get a ship that they could hack.

305
00:27:41,520 --> 00:27:46,160
Now the thing is, when you look at a cruise ship, 
they're really, really complex. They're a hotel,  

306
00:27:46,160 --> 00:27:51,760
they're shops, they're a ship. All these different 
systems, all coming together in one place  

307
00:27:52,480 --> 00:27:57,760
and keeping them secure is really, really 
difficult. Just when you look at the different  

308
00:27:57,760 --> 00:28:02,400
networks on board, you've got TV - everybody wants 
entertainment so you've got a TV network - you've  

309
00:28:02,400 --> 00:28:08,800
got your VoIP phones, the ventilation system, 
the passenger Wi-Fi, the entertainment so that  

310
00:28:08,800 --> 00:28:15,120
you can watch what's going on in the theatre 
in your cabin. You've got CCTV - hundreds,  

311
00:28:15,120 --> 00:28:18,879
possibly even thousands of cameras on board these 
days. You've got your business networks, your  

312
00:28:18,880 --> 00:28:23,840
normal corporate stuff, third parties like the 
shops on board. You've got your control networks,  

313
00:28:23,840 --> 00:28:29,840
the things that make things move, make things do 
things. And you've got safety networks as well.

314
00:28:32,880 --> 00:28:37,600
The thing was, when there was a limited number of 
networks on ships, you had discrete networks: you  

315
00:28:37,600 --> 00:28:42,560
had an individual cable going between the bridge 
and the engine room to do the control systems.  

316
00:28:42,560 --> 00:28:47,360
You'd have a TV cable. You'd have a VoIP cable. 
But the thing is, that takes up lots and lots  

317
00:28:47,360 --> 00:28:53,760
of cabling and space. So ships have done what's 
called "converged networks". So they're using  

318
00:28:53,760 --> 00:28:59,280
VLAN trunks, so they're sending lots and lots 
of different networks down one physical cable.

319
00:29:00,240 --> 00:29:03,840
Now, from an attacker's perspective - from a 
hacker's perspective - that means quite a lot.  

320
00:29:05,600 --> 00:29:09,840
If I just attack that single network - if 
I plug into the tv socket in my room - my  

321
00:29:09,840 --> 00:29:15,520
cabin - I don't get much. I just get access 
to the TV network. However, if I compromise  

322
00:29:15,520 --> 00:29:21,280
the switch that turns those networks into the 
VLAN trunk - or literally just unplug the VLAN  

323
00:29:21,280 --> 00:29:25,840
trunk cable and stick my own machine in it 
- I've got access to all of those networks.

324
00:29:27,600 --> 00:29:31,600
Cruise ships are divided up into what's called 
"fire zones" - they're also watertight as well.  

325
00:29:31,600 --> 00:29:36,080
So they're vertical divisions and this has an 
impact on how you design the networks on them.  

326
00:29:37,120 --> 00:29:41,280
You have what are called "RDPs" - remote 
distribution points - massive network  

327
00:29:41,280 --> 00:29:47,520
switches in each one of those fire zones. And to 
get all of these different signals into the cabins  

328
00:29:47,520 --> 00:29:51,200
you have what are called "cabin switches" 
- so every pair of cabins will have a cabin  

329
00:29:51,200 --> 00:29:56,000
switch that does the TV, the VoIP, the water, 
the lighting - all of those different things.

330
00:29:56,960 --> 00:30:01,040
So they go vertically down the ship, so you 
don't have to make holes going across to carry  

331
00:30:01,040 --> 00:30:06,560
those cables. Split into port and starboard for 
redundancy, but you've also got other things  

332
00:30:06,560 --> 00:30:10,879
connected to it - it's a properly converged 
network. You've got your satellite connection,  

333
00:30:10,880 --> 00:30:15,280
you've got bridge systems, engine room 
systems, all going down those cables.

334
00:30:16,800 --> 00:30:21,440
That's just a patch panel for one of those 
RDPs on a ship. You can see the number of  

335
00:30:21,440 --> 00:30:27,440
cables - it's huge. So we've got a cabin switch, 
and our cabin switch is just outside our cabin,  

336
00:30:28,160 --> 00:30:32,400
so we can physically inspect it. I can open 
up the panel and I can look at that switch.  

337
00:30:33,600 --> 00:30:36,800
We can see it's got a TV connected 
to it, it's got our VoIP phone,  

338
00:30:36,800 --> 00:30:41,280
it's got what we call the "cabin control system" 
that does lighting, HVAC, door, and water.

339
00:30:42,320 --> 00:30:47,760
We've got our other cabin that's also on that 
switch as well. Now, in the passageways you've got  

340
00:30:47,760 --> 00:30:53,840
Wi-Fi access points and CCTV as well, so people 
want to also dangle those off these cabin switches  

341
00:30:53,840 --> 00:30:59,360
as well. Now those black lines on the left hand 
side - they're a trunk - they carry all of these  

342
00:30:59,360 --> 00:31:04,560
different networks which means to me, as an 
attacker, I really want to look at that network.

343
00:31:05,600 --> 00:31:09,919
So what did we do? Well, we unplugged our TV 
and our VoIP phone, so now we've got a cable  

344
00:31:09,920 --> 00:31:15,600
going into our cabin. We then took the cables that 
the TV and the VoIP were on, and we patched them  

345
00:31:15,600 --> 00:31:21,600
into the trunk. We then put our own switch 
in the cabin so we've looped that VLAN trunk  

346
00:31:22,160 --> 00:31:27,440
through the TV and VoIP connections - physical 
connections into our cabin, on our own switch  

347
00:31:27,440 --> 00:31:32,080
and now we can attack those networks at 
will. We can do what we want to them.  

348
00:31:32,080 --> 00:31:36,399
That's the kind of situation we've got there - 
we've opened up that panel and that's that switch.

349
00:31:37,840 --> 00:31:40,159
What can we do with that? 
Well, it turns out quite a lot.  

350
00:31:40,720 --> 00:31:44,800
A lot of the time, the TV systems, no one set 
a password on them. Now imagine if you could  

351
00:31:44,800 --> 00:31:49,200
change the image on every single TV on board 
- you could probably cause widespread panic.

352
00:31:49,200 --> 00:31:52,880
The VoIP phones: no password. 
The Wi-Fi and the CCTV:  

353
00:31:52,880 --> 00:31:59,840
quite often insecure. So in one instance we 
had control over all 800 CCTV cameras on board.

354
00:32:01,120 --> 00:32:06,159
The other thing is the cabin control system: 
now this is really there to save energy. When  

355
00:32:06,160 --> 00:32:10,880
you're not in your cabin, you take your card 
out, the air conditioning and the lights turn  

356
00:32:10,880 --> 00:32:15,360
off. But you can also turn that and flip 
it on its head and attack that system.

357
00:32:17,040 --> 00:32:20,960
Now a weird thing is the way that this system 
works: rather than the cabins connect through  

358
00:32:20,960 --> 00:32:24,640
to a server like we're kind of used to 
with a lot of IoT and things like that,  

359
00:32:24,640 --> 00:32:28,480
the cabin control server connected 
out to the cabins. But that meant,  

360
00:32:29,280 --> 00:32:32,960
as that attacker who's got network 
connectivity through to those,  

361
00:32:32,960 --> 00:32:37,760
we could compromise the cabin control system. 
Now unfortunately the client didn't give us  

362
00:32:37,760 --> 00:32:41,840
permission to do this, but what we wanted to 
do was write something on the side of the ship.

363
00:32:42,560 --> 00:32:42,800
[laughter]

364
00:32:45,280 --> 00:32:48,080
One of the ships we've been on 
actually has this as functionality:  

365
00:32:48,080 --> 00:32:52,560
on the bridge there's a web interface that you 
can draw on the side of the ship. I was really,  

366
00:32:52,560 --> 00:32:57,520
really saddened to find out that on a lot of 
ships when they do this, it's literally: they  

367
00:32:57,520 --> 00:33:01,760
get a chart and they write down which cabin, and 
then they go and turn the lights on in each cabin.

368
00:33:04,880 --> 00:33:05,120
[laughter]

369
00:33:05,120 --> 00:33:06,479
You don't want to see behind the curtain.

370
00:33:07,920 --> 00:33:12,800
Another one that we find really useful on ships 
is the fact that we have physical access to  

371
00:33:12,800 --> 00:33:16,960
this equipment. Now most Cisco switches, most 
Juniper switches, lots of equipment's got a  

372
00:33:16,960 --> 00:33:22,240
console port - a serial console, and when you 
connect to that, you can do a lot of things.  

373
00:33:22,240 --> 00:33:27,040
One of those things is called password recovery 
mode. You can dump the configuration of that  

374
00:33:27,040 --> 00:33:32,399
switch. The thing with a lot of these is they'll 
quite often contain passwords or information that  

375
00:33:32,400 --> 00:33:37,280
can attack other systems. So it's one kind of 
core principle of security: the compromise of  

376
00:33:37,280 --> 00:33:43,680
one device should not lead to the compromise of 
many. But the thing was, was in this instance  

377
00:33:43,680 --> 00:33:48,720
we took the config of our switch and we recovered 
a password - it was encrypted rather than hashed,  

378
00:33:48,720 --> 00:33:54,000
so we could get that password quite easily. It 
was a really good password - good quality - and  

379
00:33:54,000 --> 00:33:58,480
then we thought, well, let's see where it works. 
Is it just this switch or is it lots of them?  

380
00:33:59,120 --> 00:34:03,520
And it turns out actually, that in this 
case it was only one of those RDPs that  

381
00:34:03,520 --> 00:34:06,960
it worked on - someone had forgotten 
to change that password on the RDP.  

382
00:34:07,680 --> 00:34:11,840
But we're now getting to this dangerous position 
where we're starting to get closer and closer  

383
00:34:11,840 --> 00:34:18,040
to these engine room and bridge systems - 
the things that let you control the ship.

384
00:34:18,040 --> 00:34:24,159
Now you remember I said we've got all these 
motors, and we've got the motor control centre.  

385
00:34:24,159 --> 00:34:29,199
They're literally contactors: big relays that turn 
motors on and off. Now if I'm physically stood  

386
00:34:29,199 --> 00:34:34,319
next to them, it doesn't really matter. I can 
just start and stop - I can press those buttons.  

387
00:34:34,320 --> 00:34:38,960
So as a hacker what I want to do is I want to get 
further and further away from them. I want to do  

388
00:34:38,960 --> 00:34:43,600
it from outside the engine room. I want to do 
it from my cabin. I want to do it from my sofa.

389
00:34:45,199 --> 00:34:48,560
Now most traditional control systems 
used to be what we call "air gapped".  

390
00:34:48,560 --> 00:34:53,520
There was no connection from the control systems 
through to the business networks and the internet.  

391
00:34:54,239 --> 00:34:57,919
And the thing is, you come along as an 
attacker - if I can access the contactor,  

392
00:34:57,920 --> 00:35:03,200
I can press a button on it. The motor starts, but 
i'm already there - what's the impact? I could go  

393
00:35:03,200 --> 00:35:08,160
to the PLC - the controller - and do it, or I 
could go to the HMI - the display - and trigger  

394
00:35:08,160 --> 00:35:14,080
something from that perspective, but it's not a 
great attack. The thing is that people add these  

395
00:35:14,080 --> 00:35:19,279
jump boxes - pivots between different networks - 
they want to get data out from the control system  

396
00:35:19,280 --> 00:35:24,240
to the business network. They want to be able to 
monitor things. So we're always looking for them  

397
00:35:24,240 --> 00:35:27,839
because that means that we can start attacking 
them from the business network and the internet.

398
00:35:28,960 --> 00:35:32,640
I'm not sure if Ryan's here - he 
might be. Yes Ryan's there, hi Ryan!  

399
00:35:33,520 --> 00:35:38,160
Ryan said this a few years ago: much of hacking 
is about understanding systems better than those  

400
00:35:38,160 --> 00:35:42,560
who built them and using that knowledge 
to do what is supposed to be "impossible".  

401
00:35:42,560 --> 00:35:46,720
And i often find this on ships. This 
was completely unrelated to ships,  

402
00:35:46,720 --> 00:35:51,520
it was to do with a crypto wallet, but we 
get on those ships and what we want to do  

403
00:35:51,520 --> 00:35:55,360
is we want to understand those systems 
better than the people who built them.

404
00:35:56,560 --> 00:36:01,520
So i'm going to give you a few examples of how 
we've done that. Now, typically we've got this air  

405
00:36:01,520 --> 00:36:07,200
gap - the bridge and engine room systems on one 
side, and then we've got the satellite connecting  

406
00:36:07,200 --> 00:36:10,240
through to the corporate network, you've got 
a crew welfare network so you can browse the  

407
00:36:10,240 --> 00:36:14,080
internet in the evenings, you might have third 
parties on board, but there's a gap between them.  

408
00:36:15,040 --> 00:36:18,960
Now one of the major costs in shipping is fuel: 
you want to make sure your ships are working  

409
00:36:18,960 --> 00:36:24,160
efficiently, so people put remote monitoring 
systems in. They gather things like your speed,  

410
00:36:24,160 --> 00:36:28,240
how much fuel you're consuming, what speed 
the the propellers spinning at. All these  

411
00:36:28,240 --> 00:36:33,279
bits of data. And we could see that there was 
one of these on a ship - we could see it on the  

412
00:36:33,280 --> 00:36:38,240
network - but we didn't know where it physically 
was or what it did, and it took me a long time.

413
00:36:39,680 --> 00:36:44,000
Now, at the top there you've got the 
voyage data recorder - the black box  

414
00:36:44,000 --> 00:36:46,560
of a ship - that's recording 
all of those bits of data,  

415
00:36:46,560 --> 00:36:50,640
but underneath it you've got a panel screwed 
onto the wall - no label or anything like that.  

416
00:36:51,520 --> 00:36:55,920
Eventually I unscrewed that and we 
found this remote monitoring system,  

417
00:36:55,920 --> 00:37:00,720
literally screwed in a panel behind the wall. No 
one on the ship knew where it was or what it did.  

418
00:37:01,760 --> 00:37:05,920
So it's got ethernet coming in one side, it's 
got a connection to the network, which means  

419
00:37:05,920 --> 00:37:10,880
we can access it from afar. On the other side 
it's got serial connections coming into it,  

420
00:37:10,880 --> 00:37:15,520
carrying data from various systems, but you might 
notice something about those connections - there's  

421
00:37:15,520 --> 00:37:19,759
only two wires on each one of them. It's got eight 
different connections but there's only two wires.

422
00:37:20,960 --> 00:37:24,480
Now this is a crucial thing: at that 
point in time we didn't understand  

423
00:37:24,480 --> 00:37:27,680
how that data was getting between the 
bridge systems and the monitoring system,  

424
00:37:28,400 --> 00:37:33,520
but it turns out it was using conventional 
serial: you've got a receive and a transmit pair.  

425
00:37:33,520 --> 00:37:37,120
The thing is with a lot of serial systems 
like this, what you can do, is you can  

426
00:37:37,120 --> 00:37:42,240
just cut one of the lines, so the data's being 
transmitted from the bridge systems through to  

427
00:37:42,240 --> 00:37:47,040
the monitoring system. There is literally no way 
for me to get data back in the other direction.  

428
00:37:47,040 --> 00:37:51,680
So in this case the system was secure. It was 
just confidentiality that would be the worry.

429
00:37:53,600 --> 00:37:56,960
Another one: this was on a container 
ship. We found this little,  

430
00:37:56,960 --> 00:38:02,480
kind of, rugged industrial PC in one of 
the racks and no one knew what it did.  

431
00:38:03,600 --> 00:38:06,880
We plugged a monitor into it - it's often 
the easiest way to find out what's something  

432
00:38:06,880 --> 00:38:11,200
doing - and we noticed it was running some 
software. Again, remote monitoring software,  

433
00:38:12,240 --> 00:38:17,520
but it was using these little things that convert 
between IP and serial. So it's converting between  

434
00:38:17,520 --> 00:38:23,680
that ethernet world - that TCP/IP world - and that 
serial line world. After a lot of digging - and  

435
00:38:23,680 --> 00:38:27,919
I'm talking a lot of digging - we found out 
where it was physically connected. We had one  

436
00:38:27,920 --> 00:38:32,080
of them going through to the bridge systems and 
we had one of them going down to the engine room.  

437
00:38:33,840 --> 00:38:38,400
We looked at the bridge systems and it turned out 
again that they'd cut one of those two lines - it  

438
00:38:38,400 --> 00:38:43,120
was just transmitting position and speed data 
down to the monitoring system - no security  

439
00:38:43,120 --> 00:38:48,880
impact. So we moved on to the one that went down 
to the engine room. I mean, this really was - it  

440
00:38:48,880 --> 00:38:54,560
was a cable going all the way from the server 
room just underneath the bridge 11 decks down  

441
00:38:54,560 --> 00:38:59,840
into the engine room and we had to physically 
trace that cable. It was time consuming.  

442
00:39:00,720 --> 00:39:03,600
But this was using something called Modbus. Now,  

443
00:39:03,600 --> 00:39:09,279
Modbus is a different protocol - you'll notice 
that it says request, reply, request, reply.  

444
00:39:10,000 --> 00:39:13,840
You have to ask for data from the 
other end before it will be sent back.  

445
00:39:14,720 --> 00:39:19,520
What this means is you can't cut one of those 
wires. You've got to have the ability to transmit  

446
00:39:19,520 --> 00:39:25,440
data from one end to the other. Now the thing here 
was, you weren't just able to request the engine  

447
00:39:25,440 --> 00:39:32,320
speed, you're also able to change settings on the 
engine by making requests through to that PLC.

448
00:39:32,320 --> 00:39:35,920
Now, unfortunately we weren't allowed to 
demonstrate exactly what we could do. We think we  

449
00:39:35,920 --> 00:39:40,960
could have stopped the engine and made it operate 
strangely, but again, to do this you'd have to be  

450
00:39:40,960 --> 00:39:48,720
on the ship. but then comes in TeamViewer. 
TeamViewer is everywhere. Now the thing was,  

451
00:39:49,280 --> 00:39:52,480
the shipping company wasn't paying 
for this tracking system anymore,  

452
00:39:53,200 --> 00:39:57,759
so we had a company with TeamViewer access to 
a box that had access to main engine systems  

453
00:39:58,560 --> 00:40:01,680
who there was no commercial relationship 
with. And it was TeamViewer,  

454
00:40:01,680 --> 00:40:06,560
so we had that remote access vector, so we could 
really really cause something serious to happen.

455
00:40:08,400 --> 00:40:14,240
Another one: a generator on an offshore support 
vessel. In there, it had these little yellow  

456
00:40:14,240 --> 00:40:19,759
routers. Now, we could see they only had 
one network port on the bottom of them.  

457
00:40:20,960 --> 00:40:26,160
So it was labeled LAN/WAN. Now this is really 
weird - the idea of one network port going into  

458
00:40:26,160 --> 00:40:30,399
the bottom of a router that's supposed to 
secure something. You can't really properly  

459
00:40:30,400 --> 00:40:36,160
secure something if the network traffic's going 
in and out of the same port. So again we tore  

460
00:40:36,160 --> 00:40:41,359
that ship down, we looked at how it worked, and we 
realised that this router was actually completely  

461
00:40:41,360 --> 00:40:45,920
pointless. If you wanted to try and secure the 
traffic by going through the router, fair enough,  

462
00:40:46,800 --> 00:40:50,960
but we could just set our IP addresses to be 
the same as the controllers on the generators  

463
00:40:51,520 --> 00:40:54,000
and that was it. We could pop those generators.

464
00:40:55,120 --> 00:40:59,200
How did we do that? Well we could do it from 
the cabin. There was little TV boxes in each  

465
00:40:59,200 --> 00:41:03,520
one of the cabins. We unplugged the network 
connection on that, we had direct network access,  

466
00:41:04,400 --> 00:41:08,640
went down into the control room and we could 
see the brand and make of the controllers there.  

467
00:41:09,360 --> 00:41:13,040
A little bit of software downloaded for 
free from the internet and we could now  

468
00:41:13,040 --> 00:41:17,200
open and close the contactors that controlled 
the power coming from those diesel generators.

469
00:41:18,720 --> 00:41:23,600
So on to the cruise ship. Cruise ships' 
bridges are really, really complex now.  

470
00:41:23,600 --> 00:41:27,040
They have something called an ICMS - 
Integrated Control and Monitoring System.  

471
00:41:27,040 --> 00:41:30,880
It's all the screens. It brings together 
all of the systems so you can operate them  

472
00:41:30,880 --> 00:41:36,480
from one central place. You also have something 
called a Safety Management System - the SMS - now  

473
00:41:36,480 --> 00:41:41,200
what this does is, if there's an event on the 
ship that needs evacuation, if there's a fire,  

474
00:41:41,200 --> 00:41:47,040
flooding, you control it from here. It has 
access to the watertight doors, the CCTV,  

475
00:41:47,040 --> 00:41:51,200
aspects of the ICMS system, it 
glues all of those things together.

476
00:41:52,880 --> 00:41:58,160
But this was my goal: these are called azipods. 
They're massive electric motors on the bottom of  

477
00:41:58,160 --> 00:42:04,480
the ship that both steer and control the speed of 
the ship. I wanted to get access to one of those.  

478
00:42:06,480 --> 00:42:10,640
Now we've already secured network access from 
the cabin so i can access some systems that I  

479
00:42:10,640 --> 00:42:15,839
shouldn't be able to. So from my passenger 
cabin I've got access to that core network.  

480
00:42:16,480 --> 00:42:19,120
Now the thing is, I now want to get 
to the safety management system,  

481
00:42:19,760 --> 00:42:26,160
or the ICMS, but how am i going to do that? 
Well, it turns out that when you're evacuating  

482
00:42:26,720 --> 00:42:31,439
a massive cruise ship, you want that information 
not only to be in the safety management centre,  

483
00:42:31,440 --> 00:42:36,080
but to be available to people at muster points. 
People who are involved with the evacuation.  

484
00:42:36,080 --> 00:42:39,600
So they had a series of rugged tablets 
that connected via Wi-Fi through to the  

485
00:42:39,600 --> 00:42:43,839
safety management system to allow it 
to be viewed from wherever on the ship.  

486
00:42:45,600 --> 00:42:50,880
So we had these SMS tablets that access the core 
network and then through to the SMS network.

487
00:42:51,440 --> 00:42:58,080
So how did we get the password for this system? 
Yeah. It's pretty common to find stickers on  

488
00:42:58,080 --> 00:43:02,960
stuff on ships. This wasn't off that particular 
situation, but you can see that. The amusing thing  

489
00:43:02,960 --> 00:43:07,760
was, we told them to make the passwords longer 
on that and, yeah, that's the fix they did.

490
00:43:10,680 --> 00:43:11,680
[laughter]

491
00:43:11,680 --> 00:43:15,680
So we've now got access to the safety 
management system. Floor plans of the ship,  

492
00:43:15,680 --> 00:43:21,040
CCTV, lots of things. We had control over 
the watertight doors, so we could move these  

493
00:43:21,040 --> 00:43:25,040
massive doors that are below the waterline 
that are designed to prevent flooding.  

494
00:43:25,040 --> 00:43:29,920
Quite serious already. So the safety 
management system has been compromised now.

495
00:43:31,600 --> 00:43:35,360
An interesting thing on cruise ships is 
they've got three fire alarms that run  

496
00:43:35,360 --> 00:43:40,720
redundantly, because fire on big ships like 
that is a major threat. If one of them breaks,  

497
00:43:41,520 --> 00:43:44,720
nothing bad is going to happen. If two 
of them break, you've got to go on to  

498
00:43:44,720 --> 00:43:48,399
fire watch - you've got to have people walking 
around the ship making sure nothing's on fire.  

499
00:43:48,400 --> 00:43:52,960
If all of them break, everybody's got to get off 
- all the passengers get off. That's going to be  

500
00:43:52,960 --> 00:43:57,440
a big problem if you're away on a cruise. So we 
thought, let's have a crack at the fire alarm.

501
00:43:58,640 --> 00:44:03,359
Turns out the SMS logged into the 
fire alarm to pull data back from it.  

502
00:44:04,080 --> 00:44:07,840
That password was stored in a 
plaintext file on the SMS system.  

503
00:44:08,480 --> 00:44:13,840
We could log into it and we could actually 
get a VNC remote session onto the fire alarms.

504
00:44:15,760 --> 00:44:20,880
We then looked at the voyage data recorder - 
again, if that breaks, the ship cannot sail.  

505
00:44:20,880 --> 00:44:24,560
So we thought we'd have a look at that. Of 
course the default login from the manual  

506
00:44:24,560 --> 00:44:30,560
worked at the lowest level. We could download a 
configuration file for the voyage data recorder.  

507
00:44:30,560 --> 00:44:34,640
We got a load of password hashes - I'll 
skip over those - those password hashes  

508
00:44:34,640 --> 00:44:38,640
quickly gave us a kind of hidden account 
password. That hidden account through the  

509
00:44:38,640 --> 00:44:43,520
web interface let us edit any file on the 
voyage data recorder - including the shadow  

510
00:44:43,520 --> 00:44:47,120
password file. We edited the shadow 
password file to add our own account,  

511
00:44:47,680 --> 00:44:53,600
and then we were root on the voyage data recorder. 
We could have bricked it, again. Things aren't  

512
00:44:53,600 --> 00:44:57,920
looking great are they? We've caused a lot of 
problems for them so far, but let's make it worse.

513
00:45:01,040 --> 00:45:06,080
The officers wanted to be able to monitor what was 
going on, on the ICMS system, from their cabins.  

514
00:45:06,080 --> 00:45:10,560
So they built a read-only system so the 
officers could connect from their cabins,  

515
00:45:10,560 --> 00:45:15,680
filtered to that network, to connect through 
to the ICMS to view it. But it was a read-only  

516
00:45:15,680 --> 00:45:21,040
view - there was no way, it didn't matter what 
login i gave to the ICMS system, I could not take  

517
00:45:21,040 --> 00:45:27,759
control of anything from that perspective. But the 
problem was, we could do what's called a breakout  

518
00:45:27,760 --> 00:45:32,800
from that ICMS interface we could break out of 
it using the print dialog - it's a really common  

519
00:45:32,800 --> 00:45:38,240
way of doing things - and we're now admin on 
that remote box. So I'm no longer using it  

520
00:45:38,240 --> 00:45:41,680
as it was intended. I'm not using it as 
a monitoring system, I'm using it as a  

521
00:45:41,680 --> 00:45:46,560
normal computer. This is really useful to 
me: I can pivot to other networks from it.

522
00:45:48,160 --> 00:45:51,600
So now we've got control over one 
of these machines within the ICMS  

523
00:45:52,160 --> 00:45:59,040
security domain. Pretty serious at this point. 
The thing was, I wanted to take control of the  

524
00:45:59,040 --> 00:46:05,600
azipods. That was another system and that was 
labelled and marked in diagrams as connected by  

525
00:46:05,600 --> 00:46:10,480
serial. Now the thing with serial is when you've 
got serial connections going between two devices  

526
00:46:10,480 --> 00:46:15,840
like this, if I compromise one endpoint, I 
can't remote desktop into the other end. I  

527
00:46:15,840 --> 00:46:20,960
can't SSH into the other end. I can only send 
serial signals down it. But the thing is,  

528
00:46:20,960 --> 00:46:26,400
lots of ships - again to save wiring - do 
something called serial over IP. They bundle  

529
00:46:26,400 --> 00:46:32,320
lots of serial connections down one physical 
cable. Now the thing is, again, if I just want to  

530
00:46:32,320 --> 00:46:37,200
cause something to happen on a motor, that's fair 
enough. But I want to use it slightly differently.  

531
00:46:38,240 --> 00:46:43,839
So I come along, I compromise that endpoint - the 
machine that I'm on - and now I don't just have to  

532
00:46:43,840 --> 00:46:50,560
send serial down that TCP/IP connection. I can do 
remote desktop. I can do SSH. And I can compromise  

533
00:46:50,560 --> 00:46:55,840
the host at the other side. So we're abusing that 
connection that people thought was serial-only.

534
00:46:56,640 --> 00:47:00,879
The interesting thing was, the diagrams 
really did make out that it was serial.  

535
00:47:00,880 --> 00:47:05,600
It literally - even physically on the box - said 
serial, and then had ethernet coming out of it  

536
00:47:05,600 --> 00:47:10,319
going to ethernet switches. So people thought 
you couldn't really impact those other systems.

537
00:47:11,760 --> 00:47:17,760
So we're now...several remote desktop connections 
deep into this system, but we're on the azipod  

538
00:47:17,760 --> 00:47:22,640
control system now. Again, there was some 
vulnerabilities we had to work at there,  

539
00:47:22,640 --> 00:47:27,520
but we've now got control of that system. 
It's looking quite serious to be honest.  

540
00:47:28,400 --> 00:47:35,280
So yeah, that's me sat there, on the ship, from my 
cabin, able to control the azipods. Not brilliant.

541
00:47:37,360 --> 00:47:40,480
But I'm still on the ship. 
Let's make this really bad.

542
00:47:42,800 --> 00:47:46,640
I was down in the engine control room 
- we've got open access to the ship,  

543
00:47:46,640 --> 00:47:50,560
we can walk about, do what we want - and 
I noticed that the cabin control system,  

544
00:47:51,280 --> 00:47:57,600
which is in a separate control room - the 
hotel control room - had TeamViewer installed.  

545
00:47:58,720 --> 00:48:05,279
And let's just say the password was...not 
great on that session. I did have to be on  

546
00:48:05,280 --> 00:48:09,840
board to get the ID and the password, 
but that meant that the people who  

547
00:48:09,840 --> 00:48:14,960
administer - who performed remote access to the 
cabin control system - also had access to it.  

548
00:48:16,000 --> 00:48:20,640
So we demoed that and you could connect 
remotely. So now we've made things really,  

549
00:48:20,640 --> 00:48:26,080
really quite bad. The cabin control system is 
connected to the internet. So we've compromised  

550
00:48:26,080 --> 00:48:30,240
that. But how are we going to get from the 
cabin control system through to the ICMS?

551
00:48:31,600 --> 00:48:35,759
Well it turns out the cabin control system has 
to adjust how it operates based on things like  

552
00:48:35,760 --> 00:48:41,360
seawater temperature and air temperature. Where 
does it get that from? It gets it from the ICMS.  

553
00:48:42,160 --> 00:48:45,440
So now we've got another connection. 
But what is that connection?  

554
00:48:46,080 --> 00:48:52,799
Well lo and behold it's Modbus again, but it's 
Modbus TCP - it's over an ethernet connection.  

555
00:48:53,360 --> 00:48:57,520
So although normally what's meant to happen is 
you'd say "what temperature is the sea water?"  

556
00:48:57,520 --> 00:49:02,960
you get the temperature of the sea water back. In 
this case we RDP'ed from the cabin control system  

557
00:49:03,600 --> 00:49:06,640
through to the ICMS and we've 
now got remote compromise.

558
00:49:09,600 --> 00:49:16,480
So yeah, completely remotely we were able to 
get onto this cruise ship and take control of  

559
00:49:16,480 --> 00:49:22,400
the azipods. So from the internet, compromise 
the cabin control system using TeamViewer,  

560
00:49:23,120 --> 00:49:29,200
compromise that ICMS remote platform - because 
we know how that works, we can break out of it -  

561
00:49:29,200 --> 00:49:32,319
compromise what's called a pack of 
programmable automation control in  

562
00:49:32,320 --> 00:49:37,360
the engine room - another story for another 
day - and then compromise the azipod system.

563
00:49:39,520 --> 00:49:42,720
So yeah that's the actual screenshot of me,  

564
00:49:43,360 --> 00:49:57,840
on TeamViewer, at home connected to the 
azipod system on a gigantic cruise ship.

565
00:49:59,200 --> 00:49:59,759
[applause]

566
00:49:59,760 --> 00:50:03,120
I did ask if I could actually 
steer it, and they were like  

567
00:50:03,120 --> 00:50:05,120
"I don't think so, that's a little bit dangerous."

568
00:50:07,760 --> 00:50:08,320
Oh well

569
00:50:12,720 --> 00:50:17,600
Is this kind of stuff going to happen? 
We had onboard access for days. In fact,  

570
00:50:17,600 --> 00:50:24,480
we were on board for 22 man-days to work out all 
of this stuff. We found lots of other problems  

571
00:50:24,480 --> 00:50:30,000
but we had inside access, we had diagrams, we 
could unplug stuff, we could trace stuff people  

572
00:50:30,000 --> 00:50:34,880
weren't asking us what we were doing. I think 
the chance of that long chain of exploits ever  

573
00:50:34,880 --> 00:50:39,440
actually occurring by someone who wasn't on board 
- who didn't know the systems - is very low. But  

574
00:50:39,440 --> 00:50:44,160
now our client knows about all of those issues and 
has applied controls to stop them being problems.

575
00:50:45,520 --> 00:50:48,960
Should you go on a cruise?
Not if I'm on it.

576
00:50:50,800 --> 00:50:55,280
Interestingly we've also managed to pay 
for food as the captain in restaurants.  

577
00:50:56,160 --> 00:50:59,440
There's lots of other things we've been able 
to get - free Wi-Fi as well - on certain cruise  

578
00:50:59,440 --> 00:51:06,400
lines they charge a fortune. But no, they're 
safe. I wouldn't go on a cruise personally,  

579
00:51:06,400 --> 00:51:11,520
but i don't think they're going to be hacked. So 
yeah, I was going to talk briefly about how to  

580
00:51:11,520 --> 00:51:16,480
get into information security, but if anybody is 
interested come and grab me afterwards to have a  

581
00:51:16,480 --> 00:51:21,360
chat. I love talking about ships, I love talking 
about hacking, though my voice is going a bit so  

582
00:51:21,360 --> 00:51:33,680
I do hope you enjoyed that, I hope you learned 
something, and enjoy the rest of your EMF Camp.

583
00:51:33,680 --> 00:51:34,105
[applause]

