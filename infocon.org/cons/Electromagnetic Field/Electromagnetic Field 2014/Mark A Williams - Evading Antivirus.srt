1
00:00:09,130 --> 00:00:15,360
as the guys that's better

2
00:00:15,360 --> 00:00:18,400
hopefully the the subtle remain away
long enough for you guys can see the

3
00:00:18,400 --> 00:00:20,380
project a bird if not feel free to

4
00:00:20,380 --> 00:00:24,360
to take a look to avoid my eyes and I
look at the slides from the side that

5
00:00:24,360 --> 00:00:28,029
I'm on and Mark Williams and the
penetration tester and hits talk about

6
00:00:28,029 --> 00:00:29,140
antivirus version

7
00:00:29,140 --> 00:00:32,950
more clearly I'm here to talk about my
ventures and malicious software

8
00:00:32,950 --> 00:00:36,130
I say this because it's not really
antivirus version

9
00:00:36,130 --> 00:00:39,160
I'm not gonna drop any new technique or
anything like that but it's something

10
00:00:39,160 --> 00:00:40,180
I've been working on

11
00:00:40,180 --> 00:00:43,760
but quite a while now in terms of just

12
00:00:43,760 --> 00:00:48,089
seeing what we can do with antivirus
some things we can get away with without

13
00:00:48,090 --> 00:00:48,820
being pained

14
00:00:48,820 --> 00:00:52,170
I am so I'm penetration tester i hack
computers for a living

15
00:00:52,170 --> 00:00:55,270
that's what I do and I have to drop
malicious software and other people's

16
00:00:55,270 --> 00:00:55,920
machines

17
00:00:55,920 --> 00:00:59,950
so Antivirus is something that gets in
my work while on

18
00:00:59,950 --> 00:01:05,350
I started out with this idea that I just
I really like malware

19
00:01:05,349 --> 00:01:08,869
and I want to develop something that can
assist me know on the my day job but am

20
00:01:08,869 --> 00:01:10,780
i learning about how systems work

21
00:01:10,780 --> 00:01:15,680
that's the big thing with anti-virus is
is this black box security thing will

22
00:01:15,680 --> 00:01:18,110
install it world told that we require it

23
00:01:18,110 --> 00:01:21,950
and that is gonna keeper Seth but we
don't really know how it works

24
00:01:21,950 --> 00:01:25,640
my has some buzzwords like segment
signature detection and behavior and

25
00:01:25,640 --> 00:01:26,549
I'll say this but

26
00:01:26,549 --> 00:01:30,679
Marino it even doing anything when it
finds something

27
00:01:30,679 --> 00:01:34,270
and makes a really big deal out there
ninety buyers is like happy look

28
00:01:34,270 --> 00:01:38,089
I found something and it was bad I kept
you said but I don't know that it's

29
00:01:38,090 --> 00:01:38,969
finding everything

30
00:01:38,969 --> 00:01:41,969
and indeed my day job is to kinda sneak
past this

31
00:01:41,969 --> 00:01:45,130
so might venture followed roughly this

32
00:01:45,130 --> 00:01:48,298
a this line here y avait is easy

33
00:01:48,299 --> 00:01:52,030
the penetration tester have to install
the software the tools

34
00:01:52,030 --> 00:01:55,619
that are required to my job but when
actually came to

35
00:01:55,619 --> 00:01:59,969
to learning how to evade and trying to
apply these techniques to try to keep

36
00:01:59,969 --> 00:02:00,369
things

37
00:02:00,369 --> 00:02:04,979
scientific so I wanted to control group
a file that I knew was militias that I

38
00:02:04,979 --> 00:02:07,139
could alter Institue to see if I can get

39
00:02:07,139 --> 00:02:11,400
a known malicious file through antivirus
Anderson techniques in the

40
00:02:11,400 --> 00:02:14,569
the middle Easter kinda common
techniques that anyone who works in

41
00:02:14,569 --> 00:02:16,760
securities probably heard ok maybe tried

42
00:02:16,760 --> 00:02:20,450
is the technique so went through but
writes a new things my man

43
00:02:20,450 --> 00:02:24,709
M this do antivirus version through the
path of least resistance this is to put

44
00:02:24,709 --> 00:02:26,940
the least amount about the impossible

45
00:02:26,940 --> 00:02:30,140
and still ahead on the virus quite

46
00:02:30,140 --> 00:02:33,140
easy for hackers to to get involved in
something and be like

47
00:02:33,140 --> 00:02:37,458
I'm writing polymorphic code makes a
cupola changes every time I run it and

48
00:02:37,459 --> 00:02:40,500
that's great but it's quite a lot better
and it's taking away from me actually

49
00:02:40,500 --> 00:02:41,690
doing my 95

50
00:02:41,690 --> 00:02:45,810
getting access to systems so I started
off with

51
00:02:45,810 --> 00:02:49,349
control execute will my control is the
meet up into

52
00:02:49,349 --> 00:02:53,670
summer temperature is pieces of weather
comes in the framework Metasploit

53
00:02:53,670 --> 00:02:58,109
and it just allows is command access to
a system can upload files download files

54
00:02:58,110 --> 00:03:03,140
excuses mcmahon's I'm using virustotal
as my initial

55
00:03:03,140 --> 00:03:06,488
system to tell me whether I'm being
picked up by and if Arsenal buyers toll

56
00:03:06,489 --> 00:03:08,630
simply a website you upload a file to

57
00:03:08,630 --> 00:03:12,030
else can it looks funny virus and I'll
tell you whether to tax on all

58
00:03:12,030 --> 00:03:15,030
so my initial thing Metasploit

59
00:03:15,030 --> 00:03:18,610
are still didn't actually work out well
well get onto that

60
00:03:18,610 --> 00:03:22,400
so much governors picked up as militias
by 34

61
00:03:22,400 --> 00:03:26,579
a 50 on anti virus that's kinda old
anyway because this is probably the most

62
00:03:26,579 --> 00:03:28,350
malicious executable on the planet

63
00:03:28,350 --> 00:03:33,450
at only picked up by 34 so visions going
quite well so far

64
00:03:33,450 --> 00:03:37,149
try to avoid antivirus and I'm already
evil evaded 17 of them

65
00:03:37,150 --> 00:03:41,660
but this is not controlled group it's my
best line so

66
00:03:41,660 --> 00:03:45,359
when looking at and the bar somewhere
analyzing the antivirus system as

67
00:03:45,359 --> 00:03:46,209
opposed to

68
00:03:46,209 --> 00:03:49,549
the militia software because a lot of
people do malicious software

69
00:03:49,549 --> 00:03:54,000
analysis but not so many people look the
other way we're told about these things

70
00:03:54,000 --> 00:03:57,019
signature detection signature detection
is is simply

71
00:03:57,019 --> 00:04:00,829
the antivirus software is looking at the
execute belies looking for patterns

72
00:04:00,829 --> 00:04:02,959
those previously seen before

73
00:04:02,959 --> 00:04:06,209
those being told the militias an elf
legacies those

74
00:04:06,209 --> 00:04:09,730
behavior analysis is where the antivirus
executes the

75
00:04:09,730 --> 00:04:13,099
I'm code for a short amount of time and
then

76
00:04:13,099 --> 00:04:16,969
watches it they have real now says
doesn't necessarily work a lot of people

77
00:04:16,970 --> 00:04:19,650
think it does it doesn't watch it
through its lifetime

78
00:04:19,649 --> 00:04:24,630
generally speaking this maybe I a
predefined enough time that a watcher

79
00:04:24,630 --> 00:04:24,990
for

80
00:04:24,990 --> 00:04:28,320
and if it does in english is in that
time orders and no militias things

81
00:04:28,320 --> 00:04:30,080
than a fighter

82
00:04:30,080 --> 00:04:33,669
third on in here call past the sample is
a problem that arose

83
00:04:33,670 --> 00:04:37,420
using virustotal virustotal shares
samples

84
00:04:37,420 --> 00:04:40,910
amongst friends severe blow to a control
group Mauer

85
00:04:40,910 --> 00:04:45,360
annual plotted against several minutes
later detection rate has increased

86
00:04:45,360 --> 00:04:48,540
not because they've certainly %uh senora

87
00:04:48,540 --> 00:04:51,810
coding done deep analysis on that caught
the gist said 0

88
00:04:51,810 --> 00:04:55,080
my friends my a but the other

89
00:04:55,080 --> 00:04:59,180
antivirus solution detect this so which
probably should as well

90
00:04:59,180 --> 00:05:03,590
and that but detections quite naive but
can always the debtor

91
00:05:03,590 --> 00:05:07,310
next doing the scientifically whether
collecting all this was flagged by this

92
00:05:07,310 --> 00:05:07,790
number

93
00:05:07,790 --> 00:05:10,930
that kinda debtors stories that ok
because every time I uploaded a

94
00:05:10,930 --> 00:05:11,770
different number

95
00:05:11,770 --> 00:05:15,310
but and immersive Asian is

96
00:05:15,310 --> 00:05:18,600
something not hackers and penetration
testers have done for a long time

97
00:05:18,600 --> 00:05:21,740
and there are tools out there that can
do it for you if you google antivirus

98
00:05:21,740 --> 00:05:22,320
version

99
00:05:22,320 --> 00:05:26,659
of fully undetectable bud develop the
tools I can do this kinda thing for you

100
00:05:26,660 --> 00:05:30,730
these kinda till the close of binary
from hacking group that we've never

101
00:05:30,730 --> 00:05:31,350
heard of

102
00:05:31,350 --> 00:05:34,840
and probably no good thing to run but
this set of tools

103
00:05:34,840 --> 00:05:38,549
are open source to have papers published
on them and they work very very well

104
00:05:38,550 --> 00:05:42,170
the reason that I didn't want to just
use these tools is because

105
00:05:42,170 --> 00:05:45,790
my problem with anti-virus a one of my
problems is that it's a black box and

106
00:05:45,790 --> 00:05:47,120
every know what it does

107
00:05:47,120 --> 00:05:50,800
haven't just immediately take someone
else's code some elses to land apply

108
00:05:50,800 --> 00:05:51,420
that

109
00:05:51,420 --> 00:05:55,070
might work a lot of the time in fact
these tools to work very very well

110
00:05:55,070 --> 00:05:58,770
but it doesn't look all the time trying
to get stuck when I'm stuck and not

111
00:05:58,770 --> 00:05:59,789
really doing my job

112
00:05:59,790 --> 00:06:03,260
so some the stills

113
00:06:03,260 --> 00:06:08,120
implement certain techniques that their
document the most simple technique the

114
00:06:08,120 --> 00:06:08,990
oldest technique

115
00:06:08,990 --> 00:06:13,020
is to simply and caught up a loads and
cutting is taking

116
00:06:13,020 --> 00:06:16,760
some data and representing any different
where that's all it is

117
00:06:16,760 --> 00:06:21,900
a second coat as a tool I can do this
animus a pin code was not designed to do

118
00:06:21,900 --> 00:06:22,710
this at all

119
00:06:22,710 --> 00:06:25,710
is designed to alter shellcode something
completely unrelated

120
00:06:25,710 --> 00:06:28,960
but for small period of time a long time
ago and the suffering caused

121
00:06:28,960 --> 00:06:33,169
did a bed antivirus and so when you
talked penetration test as I talk to

122
00:06:33,170 --> 00:06:35,920
hackers is one of the things they do
they give you this response

123
00:06:35,920 --> 00:06:39,340
why learn about antivirus version all
you need to do is in code

124
00:06:39,340 --> 00:06:43,830
anatoly doesn't work the kinda
disappointed when I tried this

125
00:06:43,830 --> 00:06:47,320
my initial control group I'd 34
detections and that's a good start

126
00:06:47,320 --> 00:06:52,219
when i encoded expecting it to drop it
went well so I got 35 detection some

127
00:06:52,220 --> 00:06:54,490
antivirus division talks not going well
so far

128
00:06:54,490 --> 00:06:59,080
so tell you exactly what not to do so
I'm back to these penetration test as I

129
00:06:59,080 --> 00:06:59,710
know these

130
00:06:59,710 --> 00:07:03,070
these black cock as I said guys Aztec me
to give me

131
00:07:03,070 --> 00:07:06,840
totally sucks the answer I go echoed
mall

132
00:07:06,840 --> 00:07:10,989
just run iterations have the same tool
and indeed you can remember something

133
00:07:10,990 --> 00:07:11,330
code

134
00:07:11,330 --> 00:07:14,440
with some iterations so it is but a
really big number in there

135
00:07:14,440 --> 00:07:20,100
I ago evasion go past wont be down to 33
this progress right

136
00:07:20,100 --> 00:07:23,840
but what I'm thinking right now is this
kinda the wrong approach

137
00:07:23,840 --> 00:07:27,739
but I wanted to continue going through
that foundational is that was already

138
00:07:27,740 --> 00:07:28,960
out there things that will

139
00:07:28,960 --> 00:07:34,099
already online there's no point diving
into a new area of research in San guys

140
00:07:34,100 --> 00:07:37,240
I know what I'm doing I'll take it from
here gotta go through what's already

141
00:07:37,240 --> 00:07:38,210
available out there

142
00:07:38,210 --> 00:07:43,469
but this court session if the car he
dates from one of the developers

143
00:07:43,470 --> 00:07:48,680
all a mess played and he I guess is sick
if setting and I'll see in saying guys I

144
00:07:48,680 --> 00:07:50,200
miss a pin code is in the way forward

145
00:07:50,200 --> 00:07:55,560
so I some good isn't good but those are
the things that we can do

146
00:07:55,560 --> 00:07:59,950
but still sticking with in Metasploit
within using the temperatures my control

147
00:07:59,950 --> 00:08:02,260
group because I haven't advanced past
that stage

148
00:08:02,260 --> 00:08:05,530
the weather and Metasploit works and the
way in

149
00:08:05,530 --> 00:08:09,229
in fact and I something code works as
will take some militia shellcode

150
00:08:09,229 --> 00:08:14,219
and injected into a temp LexA cuba file
problem with doing that

151
00:08:14,220 --> 00:08:18,410
is anti-virus vendors when they're
picking up execute ripples

152
00:08:18,410 --> 00:08:22,740
the kinda put in the little mother as
possible so they do is instead of

153
00:08:22,740 --> 00:08:25,000
looking for malicious behavior it seems

154
00:08:25,000 --> 00:08:28,729
the just pick whatever is easy to write
a signature on sieve

155
00:08:28,729 --> 00:08:31,880
all love the malicious behavior comes
from that spot that comes from a tougher

156
00:08:31,880 --> 00:08:32,219
to

157
00:08:32,219 --> 00:08:35,339
goes into this template 10 just like the
template

158
00:08:35,339 --> 00:08:39,570
and that's in fact what they do so a
blank template from Metasploit will get

159
00:08:39,570 --> 00:08:40,820
forty two hits

160
00:08:40,820 --> 00:08:45,720
42 this is one of the older templates as
x86 template but the fledging

161
00:08:45,720 --> 00:08:48,940
just what is essentially an empty
execute people is there now

162
00:08:48,940 --> 00:08:52,230
but no matter what you do whatever
shellcode you inject is going to use

163
00:08:52,230 --> 00:08:52,850
this template

164
00:08:52,850 --> 00:08:54,790
so one thing that we can do

165
00:08:54,790 --> 00:08:58,650
is just use a custom template or use any
execute plan which we can interject our

166
00:08:58,650 --> 00:08:59,400
own sheltered

167
00:08:59,400 --> 00:09:03,100
this is a new technique but I found that
even though it's an old technique it's

168
00:09:03,100 --> 00:09:04,140
really effective

169
00:09:04,140 --> 00:09:08,980
before hit up 51 but it's tied to
highlight something for me that

170
00:09:08,980 --> 00:09:10,020
antivirus vendors

171
00:09:10,020 --> 00:09:13,540
are also looking for the path of least
resistance the thing I'm trying to do

172
00:09:13,540 --> 00:09:16,849
they're just going with whatever the
easiest way to target these militias

173
00:09:16,850 --> 00:09:17,790
excuses

174
00:09:17,790 --> 00:09:21,860
so maybe incentive doing this crazy new
thing in coming up with like 0 de

175
00:09:21,860 --> 00:09:22,610
technologie

176
00:09:22,610 --> 00:09:26,560
we can just look at what works get as
close as we can to the front lines one

177
00:09:26,560 --> 00:09:27,319
virus

178
00:09:27,320 --> 00:09:31,030
and make a few changes here and there
are few configuration options and

179
00:09:31,030 --> 00:09:31,829
templates

180
00:09:31,830 --> 00:09:37,010
changing the template readers show that
continue on from that and

181
00:09:37,010 --> 00:09:40,189
I thought instead of using a temp legs a
cuban taking I am

182
00:09:40,190 --> 00:09:43,550
a standard executed and ejected shelter
into it doing

183
00:09:43,550 --> 00:09:47,079
a the idea just driving sheltered and
injecting it directly

184
00:09:47,080 --> 00:09:49,990
using virtual a local something like
that in fact there is a place until I

185
00:09:49,990 --> 00:09:50,680
can do this

186
00:09:50,680 --> 00:09:54,189
on are you could do with see literally
just

187
00:09:54,190 --> 00:09:57,300
trail what is essentially a bare-bones
excusable of

188
00:09:57,300 --> 00:10:00,310
has a variable wholesome shellcode now
file at

189
00:10:00,310 --> 00:10:03,439
that show good and it works really
really well my detection wreck and

190
00:10:03,440 --> 00:10:04,140
Antoine

191
00:10:04,140 --> 00:10:08,100
cytokines people has been a trusted us
and saying

192
00:10:08,100 --> 00:10:11,540
aka The Sims this antivirus the vision
thing seems really easy above

193
00:10:11,540 --> 00:10:15,930
already got my detection ret down to
warn using the most missus excusable on

194
00:10:15,930 --> 00:10:18,739
the planet and Ancelotti go back from
that was that

195
00:10:18,740 --> 00:10:22,970
actually virustotal doesn't release can
you execute ball

196
00:10:22,970 --> 00:10:27,350
all that well still looks good when
Assange always come with 51 antivirus

197
00:10:27,350 --> 00:10:27,930
engines

198
00:10:27,930 --> 00:10:31,589
police antivirus engines the not
deploying the whole artillery most the

199
00:10:31,590 --> 00:10:34,440
time they just applying the stock
analysis past the simple parts

200
00:10:34,440 --> 00:10:38,870
so these figures don't appear all Acura
and in fact you can see that if you

201
00:10:38,870 --> 00:10:42,620
I'm three analysts execute will do the
evasion on and then upload it to a

202
00:10:42,620 --> 00:10:44,530
system that actually runs on antivirus

203
00:10:44,530 --> 00:10:48,079
in my detected even the bar stools at
that one so I type

204
00:10:48,080 --> 00:10:54,320
sorry and so my a scientific approach is
failing so far in such that

205
00:10:54,320 --> 00:10:57,890
a control group not all elected and also

206
00:10:57,890 --> 00:11:01,750
the the test guess is that I'm getting
from virus toll are essentially lying to

207
00:11:01,750 --> 00:11:02,020
me

208
00:11:02,020 --> 00:11:06,470
so they need needed to move on from here
and I wanted to get as close as I could

209
00:11:06,470 --> 00:11:10,400
20 virus even though they're black boxes
I wanted to set the environment nope

210
00:11:10,400 --> 00:11:14,189
in such a way that I can extract as much
information as possible from

211
00:11:14,190 --> 00:11:18,310
so the first thing I did was I and so
using the temperature as my control

212
00:11:18,310 --> 00:11:19,010
excusable

213
00:11:19,010 --> 00:11:22,830
I I create my own control and I try to
load in there

214
00:11:22,830 --> 00:11:25,880
as a much malicious behavior

215
00:11:25,880 --> 00:11:30,160
as I code but to do in a modular way
it's essential I could turn on and off

216
00:11:30,160 --> 00:11:33,800
militias functionality in try and work
out which antivirus vendors are picking

217
00:11:33,800 --> 00:11:34,069
up

218
00:11:34,070 --> 00:11:38,300
which things and to how they can get
away with an of a lotta stuff

219
00:11:38,300 --> 00:11:42,339
without being detected and moss to the
antivirus vendors are literally just

220
00:11:42,340 --> 00:11:43,880
still working on signatures

221
00:11:43,880 --> 00:11:47,640
and behavioral analysis is still pretty
naive and not really that good

222
00:11:47,640 --> 00:11:51,540
but I did as I created what was
essentially

223
00:11:51,540 --> 00:11:54,610
real small modular could deploy to a
target system

224
00:11:54,610 --> 00:11:58,780
and I could fire additional modules at
it and what look at how the antivirus

225
00:11:58,780 --> 00:11:59,380
works

226
00:11:59,380 --> 00:12:03,710
essentially what I was building here's
botnet occur at this

227
00:12:03,710 --> 00:12:07,630
shellcode which is executed talk a
system and I can listen to the system

228
00:12:07,630 --> 00:12:08,090
and see

229
00:12:08,090 --> 00:12:13,200
how it reacts in terms of antivirus
system relying on virustotal and saying

230
00:12:13,200 --> 00:12:16,600
okay guys how many anti-virus systems

231
00:12:16,600 --> 00:12:22,030
pick me up I created and network and
systems and Ashley sign with

232
00:12:22,030 --> 00:12:25,920
virtual systems and then moving on from
that during penetration tests testing on

233
00:12:25,920 --> 00:12:30,540
on client systems with this code and I
set up my own Virus Total Environment

234
00:12:30,540 --> 00:12:33,980
and what this allows me to do is Priya

235
00:12:33,980 --> 00:12:37,470
a malicious executable fired at a system
and see if it picks up on all

236
00:12:37,470 --> 00:12:41,190
so siding somethings I I goal her

237
00:12:41,190 --> 00:12:44,300
ago all viruses took source code from
those

238
00:12:44,300 --> 00:12:48,370
II took things that I would want to do
is a penetration tester kinda

239
00:12:48,370 --> 00:12:52,150
naively implemented that some things
like the dumping a password hashes from

240
00:12:52,150 --> 00:12:54,970
a windows box and things like that am

241
00:12:54,970 --> 00:12:58,220
and in fact I use tools like actually
don't Peter Leedham

242
00:12:58,220 --> 00:13:02,460
existing tools and just wrapped them in
implemented them and my to cuba Lennon

243
00:13:02,460 --> 00:13:02,910
watch

244
00:13:02,910 --> 00:13:07,020
how the antivirus system reacted those
detected a played around with that code

245
00:13:07,020 --> 00:13:09,470
in naive ways to see if I could get
aware

246
00:13:09,470 --> 00:13:13,560
with doing the the activity and I found
that for example

247
00:13:13,560 --> 00:13:17,400
dumping Windows hashes the egg
executable is detected as militias

248
00:13:17,400 --> 00:13:20,900
but it's detected the signature is on
the debug messages

249
00:13:20,900 --> 00:13:24,959
which %uh there to tell me if it worked
on all but I know whether it works or

250
00:13:24,960 --> 00:13:28,100
not depending on whether a files created
that contains love the ashes

251
00:13:28,100 --> 00:13:31,380
so I can go in the source code and I can
just remove all the depot functionality

252
00:13:31,380 --> 00:13:34,570
in execute will still fight is it still
works a slider hashes

253
00:13:34,570 --> 00:13:39,400
but the antivirus system doesn't pick me
up anymore so excite reading these test

254
00:13:39,400 --> 00:13:40,910
cases was like okay this

255
00:13:40,910 --> 00:13:44,660
the exceed is something really militias
an antivirus companies are picking me up

256
00:13:44,660 --> 00:13:48,410
so I contacted Smith and device
companies and I told them as I

257
00:13:48,410 --> 00:13:51,469
you guys a kak answer can I see what you
doing here path of least resistance

258
00:13:51,470 --> 00:13:53,940
tough but you missing a lot of malicious
behavior

259
00:13:53,940 --> 00:13:58,160
and they said ok absolutely centers over
some EX series tells when it does we'll

260
00:13:58,160 --> 00:13:58,819
take a look

261
00:13:58,820 --> 00:14:03,090
sent over an EXE and they said okay yeah
I can see that would definitely missing

262
00:14:03,090 --> 00:14:03,460
this

263
00:14:03,460 --> 00:14:07,690
sold is om-d 58 and then will pick that
up from now on

264
00:14:07,690 --> 00:14:13,400
so maybe that's the wrong approach in a
stock in some guys last night the bar

265
00:14:13,400 --> 00:14:13,930
thinking

266
00:14:13,930 --> 00:14:18,569
how can we how can we deal with this so
maybe we should just create 200 execute

267
00:14:18,570 --> 00:14:19,690
balls and just keep sending them

268
00:14:19,690 --> 00:14:23,480
and sitting there gonna keep doing md5
those and how long it sucks and to

269
00:14:23,480 --> 00:14:23,960
develop

270
00:14:23,960 --> 00:14:29,200
am but essentially i I think this is the
closest that I can get to you

271
00:14:29,200 --> 00:14:33,050
I the antivirus frontline's Antivirus is
a black box and thats

272
00:14:33,050 --> 00:14:36,819
generally a bad idea for security we
don't accept this with crypto graffiti

273
00:14:36,820 --> 00:14:37,630
we don't accept

274
00:14:37,630 --> 00:14:41,750
just using secrecy with cryptography so
maybe we shouldn't friendly bars as well

275
00:14:41,750 --> 00:14:43,500
maybe should move towards

276
00:14:43,500 --> 00:14:47,460
more open systems what does that appear

277
00:14:47,460 --> 00:14:51,720
is a system has as many antivirus as I
care to

278
00:14:51,720 --> 00:14:54,940
to deal with and I can simply drop the
X's on the system's

279
00:14:54,940 --> 00:14:58,230
so the lettering here

280
00:14:58,230 --> 00:15:01,410
essentially showing off how the the
botnet functionality works

281
00:15:01,410 --> 00:15:04,620
to the right hand terminal window is a
commanding control center

282
00:15:04,620 --> 00:15:07,630
the left window handles that guey

283
00:15:07,630 --> 00:15:11,170
and in the background there's at twenty
service the whole run

284
00:15:11,170 --> 00:15:13,400
different antivirus system

285
00:15:13,400 --> 00:15:16,970
I for sure this isn't colleagues they're
saying oh how you rapping antivirus to

286
00:15:16,970 --> 00:15:18,570
work out whether it detects your no

287
00:15:18,570 --> 00:15:23,020
and it's really naive a fire a shell a
machine like a command-line access

288
00:15:23,020 --> 00:15:26,740
the icon goes blue as long as I have
access and the checks

289
00:15:26,740 --> 00:15:30,270
every 20 seconds that machine will step
blue

290
00:15:30,270 --> 00:15:33,560
so i cant quite easily deploy these
malicious payloads

291
00:15:33,560 --> 00:15:36,920
and see for detecting of just best only
icon status

292
00:15:36,920 --> 00:15:41,110
blown-up so what I did was I took a love
this malicious behavior and I

293
00:15:41,110 --> 00:15:45,010
kinda try to create my own meet up its
alright went with all the techniques

294
00:15:45,010 --> 00:15:46,400
that I would require

295
00:15:46,400 --> 00:15:50,510
as a penetration tester or as a hacker
to gain complete access to a system

296
00:15:50,510 --> 00:15:54,170
but still trying to implement a naive
way to see antivirus tracks

297
00:15:54,170 --> 00:15:57,890
to go from this I've now got a really
good control its open source because

298
00:15:57,890 --> 00:15:59,069
it's something that I roll

299
00:15:59,070 --> 00:16:02,820
I i understand that quite well and I can
control the entire environment that

300
00:16:02,820 --> 00:16:04,130
these antivirus a running on

301
00:16:04,130 --> 00:16:08,570
and I know whether the the text me or
not so I create an executable which is

302
00:16:08,570 --> 00:16:09,980
just clearly militias

303
00:16:09,980 --> 00:16:14,560
and why does the next demo is the exact
same thing now from this one is trying

304
00:16:14,560 --> 00:16:15,150
to show

305
00:16:15,150 --> 00:16:18,660
what would happen if the user executed
and EXE

306
00:16:18,660 --> 00:16:22,010
that there shouldn't do to set up the
botnet in the same way

307
00:16:22,010 --> 00:16:25,300
but now gonna jump on one of these
machines this machine is virtual

308
00:16:25,300 --> 00:16:28,819
and these is going to execute at

309
00:16:28,820 --> 00:16:32,120
apply look at a confirm email could have
come from USPS me like that

310
00:16:32,120 --> 00:16:36,760
and not execute well as then gonna brute
force the cuss words have all the other

311
00:16:36,760 --> 00:16:38,260
servers on the network

312
00:16:38,260 --> 00:16:42,080
which is really obvious try really silly
passers like I said one

313
00:16:42,080 --> 00:16:45,650
and then if it gains access to that I'll
try and profess go

314
00:16:45,650 --> 00:16:49,140
and fire its shell caught on that box
and get come online access

315
00:16:49,140 --> 00:16:52,170
and I kind of expected this not to
happen

316
00:16:52,170 --> 00:16:55,569
kinda expected that it would be really
obvious militias behavior

317
00:16:55,570 --> 00:17:00,230
and I just wasn't the result I found
some might

318
00:17:00,230 --> 00:17:04,410
idea of getting really close running
virus in taking the path of least

319
00:17:04,410 --> 00:17:05,220
resistance

320
00:17:05,220 --> 00:17:09,130
and getting really close to antivirus
worked in so much that I can Controller

321
00:17:09,130 --> 00:17:12,920
I can't really nice control execute a
bull and I can set up this environment I

322
00:17:12,920 --> 00:17:14,260
can control it really easily

323
00:17:14,260 --> 00:17:17,300
antivirus version isn't that difficult

324
00:17:17,300 --> 00:17:21,889
so wanna come here and show you guys
something really cool sorry tools out

325
00:17:21,890 --> 00:17:22,900
there that can do this

326
00:17:22,900 --> 00:17:26,860
and it's surprisingly easy to get away
with says execute which is

327
00:17:26,859 --> 00:17:30,490
spying on the network brute force is
besides over the network if I is

328
00:17:30,490 --> 00:17:34,350
militias execute balls don't password
hashes and then cracked them locally on

329
00:17:34,350 --> 00:17:35,389
the target box

330
00:17:35,390 --> 00:17:38,950
and the same way that a botnet would do
it says connecting to a

331
00:17:38,950 --> 00:17:40,220
command-and-control server

332
00:17:40,220 --> 00:17:44,420
does a couple a little tricks like it is
stalling code and things like that and

333
00:17:44,420 --> 00:17:48,190
this is actually deployed on the top
left box but if you watch the video

334
00:17:48,190 --> 00:17:51,790
that's pretty much the last box that got
shelled and that's on purpose

335
00:17:51,790 --> 00:17:54,840
you know we're tryna hacking all the
boxes as opposed to a local box

336
00:17:54,840 --> 00:17:58,340
is with ever gonna get detected we don't
want to be in till were taken over some

337
00:17:58,340 --> 00:17:59,189
other machines

338
00:17:59,190 --> 00:18:04,820
what's the my

339
00:18:04,820 --> 00:18:07,950
my talk initially was to to look up the
tools and techniques

340
00:18:07,950 --> 00:18:11,169
that we can move forward with and so
this is the new thing for

341
00:18:11,169 --> 00:18:14,380
antivirus ovation in really the
techniques that are used to is just

342
00:18:14,380 --> 00:18:17,059
common sense getting as much control
over system

343
00:18:17,059 --> 00:18:21,240
as we possibly can and really analyzing
the court to see why are we being

344
00:18:21,240 --> 00:18:21,960
detected

345
00:18:21,960 --> 00:18:25,679
to take some militias code strip it down
to the bare bones

346
00:18:25,679 --> 00:18:28,950
and work out which lines were being
pulled on and then

347
00:18:28,950 --> 00:18:32,020
just also those lines below the times
because

348
00:18:32,020 --> 00:18:35,850
and device companies are going path of
least resistance the writing signatures

349
00:18:35,850 --> 00:18:40,178
for the things that he's the detect so
and the suffering code that that

350
00:18:40,179 --> 00:18:41,919
technique that I showed initially

351
00:18:41,919 --> 00:18:45,290
doesn't work and it doesn't work for

352
00:18:45,290 --> 00:18:48,770
the quite interesting reason that on

353
00:18:48,770 --> 00:18:52,280
with Emma something called all love the
debtor that the antivirus company would

354
00:18:52,280 --> 00:18:52,720
need

355
00:18:52,720 --> 00:18:56,620
to analyze the behavior that execute
Bowl is within the execute boats not

356
00:18:56,620 --> 00:18:58,030
encrypt it or anything like that

357
00:18:58,030 --> 00:19:02,290
is represented in a different way the
antivirus vendors don't file executable

358
00:19:02,290 --> 00:19:03,330
and then watch it

359
00:19:03,330 --> 00:19:06,770
heavy because they don't need to you
because MS a pin code with

360
00:19:06,770 --> 00:19:10,650
the standard encoder has staging code
and they can write a signature

361
00:19:10,650 --> 00:19:14,210
fall a stage incurred and the same sense
that they're a signature for the

362
00:19:14,210 --> 00:19:14,940
template

363
00:19:14,940 --> 00:19:18,240
and if you're right a.m. the public to
cuba trip to

364
00:19:18,240 --> 00:19:21,370
it's that tool that will encrypt execute
balls

365
00:19:21,370 --> 00:19:24,629
that will have staging cut as well isn't
a bystander the just

366
00:19:24,630 --> 00:19:29,120
picking up on the easy signatures which
means we can also do the thing of just

367
00:19:29,120 --> 00:19:30,770
removing those easy signatures

368
00:19:30,770 --> 00:19:34,190
system using buyers toll instead abusing
the chopper to

369
00:19:34,190 --> 00:19:38,990
been coaches real real simple tools and
techniques things are more open source

370
00:19:38,990 --> 00:19:42,470
and kind of pushed antivirus vendors and
said you know where being open were a

371
00:19:42,470 --> 00:19:44,820
betting you'll system through openness
maybe

372
00:19:44,820 --> 00:19:48,870
antivirus should be more open as well so
black box security

373
00:19:48,870 --> 00:19:53,040
is a bad idea and I think maybe and
device is the last thing that we've gone

374
00:19:53,040 --> 00:19:54,559
assistance which is still

375
00:19:54,559 --> 00:19:58,990
black box and we should probably do
something about that's my real quick

376
00:19:58,990 --> 00:20:02,049
talking up kinda blasted through that
far faster than I thought I would

377
00:20:02,049 --> 00:20:09,049
but I'll take questions that

378
00:20:11,789 --> 00:20:17,690
go into the mic G

379
00:20:17,690 --> 00:20:23,419
I'll take them

380
00:20:23,419 --> 00:20:30,419
Mark Noble

381
00:20:31,680 --> 00:20:36,010
I'm sorry last slot but what was and
whether any antivirus which are more

382
00:20:36,010 --> 00:20:37,020
effective than others

383
00:20:37,020 --> 00:20:42,280
un not necessarily in the question I
really got us the law is what is if ever

384
00:20:42,280 --> 00:20:43,129
anti-virus

385
00:20:43,130 --> 00:20:47,650
and my life ever as a tester is probably
not the same as a person's favorite when

386
00:20:47,650 --> 00:20:48,630
they were real security

387
00:20:48,630 --> 00:20:51,760
Alec body bars because it makes my job
easier but

388
00:20:51,760 --> 00:20:57,060
on I really did ya see the content but
the antivirus companies were all picking

389
00:20:57,060 --> 00:21:02,450
the content up as malicious folk bad
reasons but it was all different reasons

390
00:21:02,450 --> 00:21:05,730
so I sighed changing my source code and
and removing those debugging

391
00:21:05,730 --> 00:21:06,480
functionality

392
00:21:06,480 --> 00:21:09,810
it didn't really go from 20 detections
down to zero

393
00:21:09,810 --> 00:21:13,690
a kind of like a line change in a line
change their would drop it down

394
00:21:13,690 --> 00:21:17,630
book on I got very very similar results
from

395
00:21:17,630 --> 00:21:21,390
although the antivirus companies I was
talking to someone about yesterday about

396
00:21:21,390 --> 00:21:25,640
is there really any difference between
the AB companies and she should we

397
00:21:25,640 --> 00:21:26,380
really have

398
00:21:26,380 --> 00:21:30,530
efforts and it brings up really old
questionable ethics

399
00:21:30,530 --> 00:21:34,840
because an antivirus company wanted to
be done the leading

400
00:21:34,840 --> 00:21:39,439
company in that area then they wouldn't
really be very friendly to the other

401
00:21:39,440 --> 00:21:42,450
companies and that the founder sampling
got a signature for all

402
00:21:42,450 --> 00:21:45,820
created this really good behaviour
engine they wouldn't shed a

403
00:21:45,820 --> 00:21:49,919
but in the interest a good security in
everyone being set and that should share

404
00:21:49,920 --> 00:21:50,250
that

405
00:21:50,250 --> 00:21:55,590
the prime solace many IV companies as
you might like to thank

406
00:21:55,590 --> 00:21:58,790
a lot of the engineer archie shepard to
be multiple defenders

407
00:21:58,790 --> 00:22:03,379
yeah that's absolutely true um yellow to
the a lot of the engines are shared

408
00:22:03,380 --> 00:22:04,190
between vendors

409
00:22:04,190 --> 00:22:08,610
on and like a surefire stole share some
polls and it's quite easy to see that

410
00:22:08,610 --> 00:22:11,639
it's almost immediate within a couple
minutes the detection rate increases

411
00:22:11,640 --> 00:22:12,180
hola

412
00:22:12,180 --> 00:22:15,820
so there is sharing between antivirus
companies and

413
00:22:15,820 --> 00:22:18,850
I found similar results for all of the
antivirus companies

414
00:22:18,850 --> 00:22:23,540
and try them all I didn't implement the
51 are still did implemented about 15

415
00:22:23,540 --> 00:22:27,830
shut when she was only about 15 actually
Rocco duffel and they all seem to react

416
00:22:27,830 --> 00:22:32,100
in very very similar where's so the idea
if ever any virus maybe

417
00:22:32,100 --> 00:22:35,120
isn't something that we could have

418
00:22:35,120 --> 00:22:36,780
I'm what about existing

419
00:22:36,780 --> 00:22:40,080
open source are like you had clam AV
clamp yeah

420
00:22:40,080 --> 00:22:44,129
um I think it's not really

421
00:22:44,130 --> 00:22:50,020
on a similar claim heavy is is open
source and and there are open source

422
00:22:50,020 --> 00:22:50,960
security solutions

423
00:22:50,960 --> 00:22:54,800
I think the idea really is on to be more

424
00:22:54,800 --> 00:22:58,840
public about how detection works and
talking to some people

425
00:22:58,840 --> 00:23:03,070
at this conference actually he worked an
antivirus and looking development and is

426
00:23:03,070 --> 00:23:04,919
really cool things that we can do with

427
00:23:04,920 --> 00:23:08,560
with antivirus and behavioral analysis
and virtual engines and things like that

428
00:23:08,560 --> 00:23:10,220
I'm in emulation

429
00:23:10,220 --> 00:23:14,380
the love that doesn't seem to real-world
get implemented and people

430
00:23:14,380 --> 00:23:18,380
a home systems and logical questions to
him so

431
00:23:18,380 --> 00:23:21,940
I think it's not so much just the case
for being open source but it's also

432
00:23:21,940 --> 00:23:23,930
being public about the way that we
operate

433
00:23:23,930 --> 00:23:30,930
the way things work

434
00:23:36,340 --> 00:23:39,990
do you think it's worth the time and
effort to install antivirus officer

435
00:23:39,990 --> 00:23:43,760
as a user not as security research

436
00:23:43,760 --> 00:23:48,260
what's your throat edge in us it's one
of those questions with security it's

437
00:23:48,260 --> 00:23:48,679
like

438
00:23:48,679 --> 00:23:53,059
we can to bed on the virus and doesn't
mean I'm here are some media we should

439
00:23:53,059 --> 00:23:53,740
go where

440
00:23:53,740 --> 00:23:57,830
it does do good things and it does
prevent all samples and things like that

441
00:23:57,830 --> 00:24:03,000
a don't think II did a similar talks
this a little while ago are showed and

442
00:24:03,000 --> 00:24:03,960
divisive Asian

443
00:24:03,960 --> 00:24:07,980
and like a penetration doesn't want me
to show our clients look weak in a bed

444
00:24:07,980 --> 00:24:09,330
and a virus is not scary

445
00:24:09,330 --> 00:24:12,790
and and that with a lot of people's
minds but really we should never rely

446
00:24:12,790 --> 00:24:15,980
want security technique we shouldn't
just rely on

447
00:24:15,980 --> 00:24:19,440
anti-virus so I don't think the
antivirus should go away but I think

448
00:24:19,440 --> 00:24:22,950
there is a lotta room for it to improve
and I think we should push for it to

449
00:24:22,950 --> 00:24:23,400
improve

450
00:24:23,400 --> 00:24:30,400
childhood

451
00:24:32,539 --> 00:24:36,320
malicious software without iris come up
with a head

452
00:24:36,320 --> 00:24:39,870
also question um

453
00:24:39,870 --> 00:24:43,209
I've come across the

454
00:24:43,210 --> 00:24:47,409
working with one plane actually where on
one other things that we do is we look

455
00:24:47,409 --> 00:24:47,870
to see

456
00:24:47,870 --> 00:24:51,699
the have antivirus installed and and a
lot of companies will have antivirus

457
00:24:51,700 --> 00:24:54,950
installed on end-user devices but not
servers and

458
00:24:54,950 --> 00:24:59,720
the coal um efficiency in a salad and a
car slows us down that we don't

459
00:24:59,720 --> 00:25:03,600
runner on and I i was looking at the
cling ons and I

460
00:25:03,600 --> 00:25:07,240
run some missus execute was unnecessary
there were detected so lifelike them in

461
00:25:07,240 --> 00:25:07,780
their poll

462
00:25:07,780 --> 00:25:11,030
as your Donovan parceled he said no we
do

463
00:25:11,030 --> 00:25:14,730
and showed me showed it running with the
little icon saying his flute today

464
00:25:14,730 --> 00:25:18,690
I just wasn't working and as the issue a
playbook security where

465
00:25:18,690 --> 00:25:23,470
we don't really know what it's doing an
excellent night and I find something but

466
00:25:23,470 --> 00:25:26,470
it doesn't find something we have no
idea that is working at all

467
00:25:26,470 --> 00:25:30,450
on I wrote this poem at nine months ago

468
00:25:30,450 --> 00:25:34,049
one antivirus companies picked it up
sense and picked it up for a really old

469
00:25:34,049 --> 00:25:35,389
reason I never falls

470
00:25:35,390 --> 00:25:39,179
I am it didn't pick up any of the
militias activity and if the brute

471
00:25:39,179 --> 00:25:42,280
forcing a council dropping shellcode or
anything like that what did pick it up

472
00:25:42,280 --> 00:25:42,629
on

473
00:25:42,630 --> 00:25:45,690
is the fact that it made itself run on
startup

474
00:25:45,690 --> 00:25:50,470
and it detected the persistence susannah
tacky don't necessarily requires

475
00:25:50,470 --> 00:25:51,659
persistence you might just

476
00:25:51,659 --> 00:25:56,159
wanna dem passwords and then get out
there so 180 vendor 1m who it is

477
00:25:56,159 --> 00:25:59,340
did pick this up but they didn't pick it
up for the the reasons I saw

478
00:25:59,340 --> 00:26:03,330
but the idea of picking up militias
activity without Antivirus is really

479
00:26:03,330 --> 00:26:04,600
something that corporates

480
00:26:04,600 --> 00:26:07,809
corporations should look out because it
can be quite easy

481
00:26:07,809 --> 00:26:11,690
not easy that's unfair but I'm is
something that we can do i mean

482
00:26:11,690 --> 00:26:16,490
so for example um the second video

483
00:26:16,490 --> 00:26:20,169
where we kinda see this exponential
growth where the militias execute well

484
00:26:20,169 --> 00:26:21,100
this brute forcing

485
00:26:21,100 --> 00:26:24,870
with the machines does not essentially
at random and then it deploys the same

486
00:26:24,870 --> 00:26:26,250
hello to that machine

487
00:26:26,250 --> 00:26:29,610
I get this kind of exponential growth
which looks really cool in a video

488
00:26:29,610 --> 00:26:33,320
but that is actually quite detectable
because most use a traffic as we know

489
00:26:33,320 --> 00:26:35,570
goes from and use a device to suffer

490
00:26:35,570 --> 00:26:39,408
something like it eighty percent is
really really rafik like machines to

491
00:26:39,409 --> 00:26:40,360
talk to each other

492
00:26:40,360 --> 00:26:42,870
social network if suddenly all uphill
climb

493
00:26:42,870 --> 00:26:46,840
she means the world battering each
other's login problems probably militias

494
00:26:46,840 --> 00:26:50,449
I've never had to have never had any on
pick up on that but

495
00:26:50,450 --> 00:26:54,100
I guess it's the difference between two
interest or intrusion detection systems

496
00:26:54,100 --> 00:26:54,840
or do we trust

497
00:26:54,840 --> 00:26:58,120
random log tracking you know that my
dear friend in love checking

498
00:26:58,120 --> 00:27:01,909
and some statistics came out recently
from what I've been told

499
00:27:01,910 --> 00:27:05,160
second-hand information that I random
look tracking

500
00:27:05,160 --> 00:27:09,540
is statistically better for security
than intrusion detection systems are

501
00:27:09,540 --> 00:27:12,830
8.5 percent detection rate to 3.5
percent detection

502
00:27:12,830 --> 00:27:16,449
I'm and

503
00:27:16,450 --> 00:27:20,250
also in terms a Linux Windows Mac is a
real difference Ursus

504
00:27:20,250 --> 00:27:25,630
market share um another interesting
thing that people said to me is

505
00:27:25,630 --> 00:27:29,050
poets I'm a Mac and therefore I can get
bonuses

506
00:27:29,050 --> 00:27:33,030
Bernie Mac and I'll write you a virus
you know um

507
00:27:33,030 --> 00:27:36,389
I think again the the issue is just one
of threads in

508
00:27:36,390 --> 00:27:39,470
maybe Mac and Linux get less I am

509
00:27:39,470 --> 00:27:43,750
very very loud now lower spreads across
the internet because there's less if

510
00:27:43,750 --> 00:27:44,870
those boxes

511
00:27:44,870 --> 00:27:49,020
but if you're targeting a specific
company and i wanna say the word APT

512
00:27:49,020 --> 00:27:50,660
here so everyone should take a shoal

513
00:27:50,660 --> 00:27:54,410
at the offer edge in his APT's then
they're probably know the systems that

514
00:27:54,410 --> 00:27:55,480
you need to use

515
00:27:55,480 --> 00:28:01,000
and I find it no more difficult to write
my left ball and Xboxes ID for Windows

516
00:28:01,000 --> 00:28:05,010
in fact I was really really Leslie on
this project and this runs on Linux

517
00:28:05,010 --> 00:28:08,679
because it runs in wine absolutely find
is no problem at all

518
00:28:08,679 --> 00:28:12,380
so on the the

519
00:28:12,380 --> 00:28:15,900
shell part this is running on Windows
machines running on the fires but as you

520
00:28:15,900 --> 00:28:18,059
can see their command-and-control par

521
00:28:18,059 --> 00:28:23,330
is running on Linux but is running into
one and

522
00:28:23,330 --> 00:28:27,409
home

523
00:28:27,410 --> 00:28:29,290
your microphone we can so he only
finished

524
00:28:29,290 --> 00:28:35,000
I is very thing you think that we as n
users can do to open this black box and

525
00:28:35,000 --> 00:28:36,270
as vendors to actually

526
00:28:36,270 --> 00:28:41,309
you know release a little bit more info
um

527
00:28:41,309 --> 00:28:46,600
had very little faith and end-users not
the the problem is with end users

528
00:28:46,600 --> 00:28:51,790
is that is this makes the don't
understand don't care not that feel

529
00:28:51,790 --> 00:28:55,780
things like that and some another
speaker mention the fact that we can

530
00:28:55,780 --> 00:28:57,300
have been users do things

531
00:28:57,300 --> 00:29:00,500
if we implement fear but the problem is
attackers can implement

532
00:29:00,500 --> 00:29:03,820
here as well so the few people I've
talked to a

533
00:29:03,820 --> 00:29:07,830
around camp I mentioned the idea of
phishing attacks and we all know about

534
00:29:07,830 --> 00:29:10,740
phishing attacks in send an email to use
our nothing to do something

535
00:29:10,740 --> 00:29:13,900
and then the really shouldn't do that
and

536
00:29:13,900 --> 00:29:17,559
a wreath rest recent fishing camp and
Iran I

537
00:29:17,559 --> 00:29:21,850
essentially asks users to give me their
passwords and sixty-three percent

538
00:29:21,850 --> 00:29:26,580
abuses did and the reason that I feel
that works is because

539
00:29:26,580 --> 00:29:30,620
I initially asked them to give me the
password and the guys have their

540
00:29:30,620 --> 00:29:33,750
you know hierarchy as the IT Director
please give me the password and send it

541
00:29:33,750 --> 00:29:34,840
to this Hotmail address

542
00:29:34,840 --> 00:29:39,050
and then I sent a secondary email from
finance director saying

543
00:29:39,050 --> 00:29:41,919
some if you haven't fill this Form and
yet please immediately do so or

544
00:29:41,920 --> 00:29:43,040
disciplinary action will

545
00:29:43,040 --> 00:29:46,059
and see you as the issue of on

546
00:29:46,059 --> 00:29:49,670
and uses have to areas in which we were
talking about up

547
00:29:49,670 --> 00:29:53,100
office systems where we're were working
we presume someone else is going to look

548
00:29:53,100 --> 00:29:53,980
after us

549
00:29:53,980 --> 00:29:57,910
and then we've got a home where we've
got a very small attack surface anywhere

550
00:29:57,910 --> 00:30:03,250
so I think um the best thing that an end
user can do

551
00:30:03,250 --> 00:30:06,820
is just pay attention to your machine he
spent a long time on your own machine

552
00:30:06,820 --> 00:30:09,080
even it's an hour deaths so quite a long
time

553
00:30:09,080 --> 00:30:12,949
when it starts doing weird things kinda
gonna know is that

554
00:30:12,950 --> 00:30:18,090
so and I think and uses a limited

555
00:30:18,090 --> 00:30:21,439
the coals knowledge is limited and data
is limited

556
00:30:21,440 --> 00:30:24,760
there are things that we can do is just
keep an eye on our own systems monitor

557
00:30:24,760 --> 00:30:25,379
things

558
00:30:25,380 --> 00:30:29,870
even if it's naive something is wrong I
should tell someone something is wrong

559
00:30:29,870 --> 00:30:32,899
the the Fishing Company around with 63
percent at

560
00:30:32,899 --> 00:30:36,529
eases sent me that password the forty
percent didn't

561
00:30:36,529 --> 00:30:39,789
didn't tell anyone the didn't go that's
a phishing email

562
00:30:39,789 --> 00:30:43,729
I should probably tell some so as end
users in the workplace we can protect

563
00:30:43,729 --> 00:30:44,619
each other

564
00:30:44,619 --> 00:30:48,019
if one of those eases had gone to their
IT department

565
00:30:48,019 --> 00:30:51,820
Security Department said I got a
phishing email the IT department could

566
00:30:51,820 --> 00:30:52,889
have blocked the link

567
00:30:52,889 --> 00:30:56,149
because every male had the same length
and images file that anti phishing

568
00:30:56,149 --> 00:30:57,330
campaign with a failed

569
00:30:57,330 --> 00:31:01,918
maybe got one here so it and we're close
we can look after each other a home we

570
00:31:01,919 --> 00:31:04,320
could just have an appreciation for when
things are going weird

571
00:31:04,320 --> 00:31:10,529
do you think it's feasible to implement

572
00:31:10,529 --> 00:31:14,669
all these advanced detection techniques
and be scanning

573
00:31:14,669 --> 00:31:17,820
in real time as as antivirus dollars

574
00:31:17,820 --> 00:31:21,210
it is there not a

575
00:31:21,210 --> 00:31:25,149
a massive system cost for for running on
if

576
00:31:25,149 --> 00:31:29,820
the kleins I'll already work with don't
install traditional antivirus

577
00:31:29,820 --> 00:31:33,339
because the performance issues or
perceived performance issues

578
00:31:33,339 --> 00:31:37,059
then I would think it would be a hard
sell to tell them to actually need to

579
00:31:37,059 --> 00:31:39,320
install more stuff that's going to work
harder

580
00:31:39,320 --> 00:31:43,009
I think there's a lot to be said about
content a recession in this idea where

581
00:31:43,009 --> 00:31:43,419
we have

582
00:31:43,419 --> 00:31:47,679
virtual environments where we segment on
applications to just

583
00:31:47,679 --> 00:31:51,299
instead of preventing the initial for
hold an attacking

584
00:31:51,299 --> 00:31:54,710
get to simply prevent them having across
the system's

585
00:31:54,710 --> 00:31:58,719
I can be localized with a every
application running in a sandbox

586
00:31:58,719 --> 00:32:03,899
or could be network-wide where and the
worm demo is a naive demo where

587
00:32:03,899 --> 00:32:07,928
the militia software brute force is
those passwords if the one weak

588
00:32:07,929 --> 00:32:08,919
passwords than you

589
00:32:08,919 --> 00:32:13,440
entirely stops that propagation anywhere
so maybe there's not a lot we can do for

590
00:32:13,440 --> 00:32:14,429
Angela foothold

591
00:32:14,429 --> 00:32:17,460
but maybe there's a lot we can do in
terms of monitoring and preventing

592
00:32:17,460 --> 00:32:24,460
propagation

593
00:32:35,270 --> 00:32:39,559
and yet it is true to say we can do more
in terms of behavioral analysis behavior

594
00:32:39,559 --> 00:32:42,500
analysis is probably really hard I don't
write antivirus

595
00:32:42,500 --> 00:32:46,529
and be I think there is probably more we
can do in terms the

596
00:32:46,529 --> 00:32:49,730
on virtualizing systems

597
00:32:49,730 --> 00:32:52,909
and having at better view the way that
the

598
00:32:52,909 --> 00:32:56,250
executed as a running there's a recent
Def Con talk actually where somebody was

599
00:32:56,250 --> 00:32:57,039
talking about that

600
00:32:57,039 --> 00:33:00,620
emulating systems as possible
virtualizing them to get more

601
00:33:00,620 --> 00:33:06,239
view have what's going on so ten years
ago we deploy the high for system across

602
00:33:06,240 --> 00:33:08,039
a sixty thousand users by

603
00:33:08,039 --> 00:33:12,460
arm which got a harp said hey on
individual systems to use by

604
00:33:12,460 --> 00:33:16,320
desktop and server the interesting pic
was we spent by arts

605
00:33:16,320 --> 00:33:21,418
to me on a software we had but we have
to stop travel travel size the thing was

606
00:33:21,419 --> 00:33:22,529
just looking at the logs

607
00:33:22,529 --> 00:33:26,520
the problem with behaving systems is a
actually people to go through to look at

608
00:33:26,520 --> 00:33:27,070
the logs

609
00:33:27,070 --> 00:33:30,120
to the system's cleverly that on but

610
00:33:30,120 --> 00:33:33,489
the the issue with behavioral analysis
as opposed to static analysis

611
00:33:33,490 --> 00:33:37,630
stack analysis is a billion i've seen
this before has previously been

612
00:33:37,630 --> 00:33:42,299
proven to be malicious network on Flickr
with the heavily narcissus the ideas

613
00:33:42,299 --> 00:33:47,168
it doing enough bad so I'm looking for
long something weird happens is like is

614
00:33:47,169 --> 00:33:50,039
that we had enough that it's malicious
or is it just an anomaly

615
00:33:50,039 --> 00:33:53,270
so you're absolutely right with
behavioral analysis there is increased

616
00:33:53,270 --> 00:33:56,960
manpower required or increase processing
power week or shed

617
00:33:56,960 --> 00:34:00,350
the interesting thing is I work as a
penetration tester now and

618
00:34:00,350 --> 00:34:03,709
I've not seen any of our client base big
or small

619
00:34:03,710 --> 00:34:08,310
deploy anything like that our website
does not yet it's a one-off in

620
00:34:08,310 --> 00:34:11,359
ten 10 years ahead testing yeah

621
00:34:11,359 --> 00:34:15,639
on as and history we don't really have
that much difficulty abetting anti-virus

622
00:34:15,639 --> 00:34:17,830
& I find that curiosity

623
00:34:17,830 --> 00:34:23,779
enough to stand in for you guys and say
by doesn't anti-virus look

624
00:34:23,780 --> 00:34:27,109
as a pen tester have what's your view on
to default default

625
00:34:27,109 --> 00:34:30,750
Mitt verses did to bowl tonight as in

626
00:34:30,750 --> 00:34:35,050
if you have a client say an important
server that is highly expose the net

627
00:34:35,050 --> 00:34:38,659
to simply white list all the XE Zee
actually no

628
00:34:38,659 --> 00:34:43,139
should ever be running and anything
saints or something new they can add it

629
00:34:43,139 --> 00:34:44,720
to the white list rather than saying

630
00:34:44,719 --> 00:34:48,009
everything can run and let's hope that
nothing malicious ever comes on here

631
00:34:48,010 --> 00:34:52,090
yeah other problems that kinda security
it's like we had this idea larceny

632
00:34:52,090 --> 00:34:55,540
somebody proposes a solution people
adjustment Picasa and doesn't

633
00:34:55,540 --> 00:34:56,980
necessarily mean that it's bad

634
00:34:56,980 --> 00:35:02,710
bow we should do something to whitelist
execute people still has the issue if if

635
00:35:02,710 --> 00:35:03,680
you inject shellcode

636
00:35:03,680 --> 00:35:07,009
into that process when you're running as
an excuse bill and therefore can get

637
00:35:07,010 --> 00:35:07,800
around it but

638
00:35:07,800 --> 00:35:10,859
if you have the manpower to do that if
you have

639
00:35:10,859 --> 00:35:14,850
a system that scope is narrow enough
that we can whitelist execute

640
00:35:14,850 --> 00:35:16,540
specifically than that totally works

641
00:35:16,540 --> 00:35:23,540
sayin

642
00:35:23,570 --> 00:35:25,130
every office needs right

643
00:35:25,130 --> 00:35:28,730
if you allow weren't you allowed mark
Reis its game I thought so

644
00:35:28,730 --> 00:35:32,690
what listings not gonna be an effective
solution on the side that's true in the

645
00:35:32,690 --> 00:35:34,869
same with dropping shellcode in the
process is anywhere

646
00:35:34,869 --> 00:35:39,270
and it it's not a cure it probably helps
but it's not a cure

647
00:35:39,270 --> 00:35:43,030
it spends at the three edge in is
someone sitting behind

648
00:35:43,030 --> 00:35:46,040
I'm saying on the command and control
server that I can't direct

649
00:35:46,040 --> 00:35:49,470
the shells and I can direct the balls to
do things if the spreading like a worm

650
00:35:49,470 --> 00:35:51,830
spreads and it's just naively I would
stand

651
00:35:51,830 --> 00:35:55,150
maybe does assist I'm do you think

652
00:35:55,150 --> 00:35:58,920
using things like process Hacker like
task managers & you know sandbox and is

653
00:35:58,920 --> 00:36:01,220
at work just on the software level some
boxing

654
00:36:01,220 --> 00:36:05,930
orgy harbors of I'm not gonna suffer
level it does work

655
00:36:05,930 --> 00:36:09,379
and I saw something collection as a
project where someone has implemented

656
00:36:09,380 --> 00:36:11,420
bar stool with in task manager

657
00:36:11,420 --> 00:36:15,140
so if you open task manager hailed by
those XQ will survive stolen

658
00:36:15,140 --> 00:36:19,140
ok mr. stole is now even assured that
previously but again it's something

659
00:36:19,140 --> 00:36:21,618
quite cold said I can quite easily just
fire

660
00:36:21,619 --> 00:36:25,369
execute also but no Sun boxing on is a
really cool thing

661
00:36:25,369 --> 00:36:29,710
in terms of the issue of propagation so
can might be able to jump into that

662
00:36:29,710 --> 00:36:32,330
process are into that small virtualized
instance

663
00:36:32,330 --> 00:36:36,380
but if i cant get outta orbit doesn't
have any interesting permissions than

664
00:36:36,380 --> 00:36:40,270
maybe we give the attack at the initial
for hold

665
00:36:40,270 --> 00:36:47,270
knowing that we can prevent propagation

666
00:36:48,520 --> 00:36:49,740
I think so

667
00:36:49,740 --> 00:36:56,740
maybe depends how much man how you call
now

668
00:36:57,049 --> 00:37:00,220
I I tried to compile a list of militias
behavior

669
00:37:00,220 --> 00:37:04,430
and I stand out with something like
twelve things that I thought would be

670
00:37:04,430 --> 00:37:05,288
malicious like

671
00:37:05,289 --> 00:37:09,230
but dumping password hashes and things
like that and my list now is something

672
00:37:09,230 --> 00:37:11,339
like two hundred and twenty things I can
think of

673
00:37:11,339 --> 00:37:16,569
a malicious on that kinda thing does
work if you can spot and if you have the

674
00:37:16,569 --> 00:37:17,990
ability to go in our look at it

675
00:37:17,990 --> 00:37:22,328
and the problem is some other malware
the activity that it does

676
00:37:22,329 --> 00:37:25,770
is sry doesn't look that militias so the
most simple

677
00:37:25,770 --> 00:37:29,829
on the most simple for holding it up can
have is simply

678
00:37:29,829 --> 00:37:34,760
I and execute well which reads from the
network and pushes it to see indeed a XE

679
00:37:34,760 --> 00:37:38,950
so reading from the network and running
an executable in the system which is

680
00:37:38,950 --> 00:37:39,910
that by default

681
00:37:39,910 --> 00:37:43,049
to spot that behavior is quite difficult

682
00:37:43,049 --> 00:37:46,910
I'm canola met if network packets
immediately coming from the Nokia

683
00:37:46,910 --> 00:37:48,990
immediately pursue sandy to XE then

684
00:37:48,990 --> 00:37:52,450
thats militias for as a human being I
think you would mister

685
00:37:52,450 --> 00:37:57,808
I'm you saying you wanted to advise
companies to open up a little bit about

686
00:37:57,809 --> 00:37:59,279
how they did detection

687
00:37:59,279 --> 00:38:02,430
dissing that carries an increased risk
then militias

688
00:38:02,430 --> 00:38:06,118
individuals could exploit weaknesses
that they see in those

689
00:38:06,119 --> 00:38:10,260
the the parallel that I drew in its a
naive parallel is that a

690
00:38:10,260 --> 00:38:14,789
a cartography where we don't accept
secrecy in the world of cryptography

691
00:38:14,789 --> 00:38:18,770
our algorithms are open but %uh keys in
all and that's the parallel I true to

692
00:38:18,770 --> 00:38:19,640
say that maybe

693
00:38:19,640 --> 00:38:23,038
antivirus should be open because sicky
us security

694
00:38:23,039 --> 00:38:26,900
and I don't generally expect antivirus
companies to go you're right we should

695
00:38:26,900 --> 00:38:28,460
do this because they have

696
00:38:28,460 --> 00:38:31,520
at the wholesale staying down there
where they liked it

697
00:38:31,520 --> 00:38:35,099
spin things to show that they are the
best and i think thats

698
00:38:35,099 --> 00:38:38,910
interesting both an ethics and the way
that it works where people still ask

699
00:38:38,910 --> 00:38:40,549
what if ever antivirus nice

700
00:38:40,549 --> 00:38:45,140
well general sentiment

701
00:38:45,140 --> 00:38:47,490
arm in Europe the net where your

702
00:38:47,490 --> 00:38:50,649
gum base he fine in the user account
passwords

703
00:38:50,650 --> 00:38:53,970
yet with that local user accounts and if
so

704
00:38:53,970 --> 00:38:57,930
have you can't situations where there's
all local account to disable

705
00:38:57,930 --> 00:39:02,149
and you don't like a domain situation
how does that compare

706
00:39:02,150 --> 00:39:05,960
I'm there the reason I i did. this is
because it's quite a common thing as a

707
00:39:05,960 --> 00:39:07,580
penetration tester for us to do

708
00:39:07,580 --> 00:39:10,920
we have physical access to the device
then we condemn the local passwords

709
00:39:10,920 --> 00:39:15,050
local admin password have lots of
machines is a huge risk and lotsa

710
00:39:15,050 --> 00:39:16,280
companies are realize that

711
00:39:16,280 --> 00:39:20,160
um because a lot of companies will
protect domain administrator accounts

712
00:39:20,160 --> 00:39:22,920
and trying to forget about local
administrator accounts

713
00:39:22,920 --> 00:39:27,080
on the progress being made in this area

714
00:39:27,080 --> 00:39:31,230
so I one thing we can do is we conduct
the hashes and then login using past the

715
00:39:31,230 --> 00:39:31,730
hash

716
00:39:31,730 --> 00:39:35,800
wheres that a cracking it we just log in
using it and a recent Mike surpassed

717
00:39:35,800 --> 00:39:39,020
change that so that local admin accounts
I have been added

718
00:39:39,020 --> 00:39:42,040
come looking for the hash only the the
full

719
00:39:42,040 --> 00:39:45,470
I D 500 that works with so progress has
been made

720
00:39:45,470 --> 00:39:49,189
book password reuse is a bad thing and
we know it but still prolific

721
00:39:49,190 --> 00:39:52,350
and look like McCann said they're not
needed initially turned off

722
00:39:52,350 --> 00:39:55,580
in the same sense that anything that is
not needed to be turned off

723
00:39:55,580 --> 00:39:59,569
we reduce our attack surface massively
just but anything's often insulin things

724
00:39:59,570 --> 00:39:59,850
up

725
00:39:59,850 --> 00:40:06,850
notching need

726
00:40:07,880 --> 00:40:11,160
a really good example of something which
is installed on a lotta systems by

727
00:40:11,160 --> 00:40:12,250
default is tom cat

728
00:40:12,250 --> 00:40:15,800
time comes bundled with things and
administers don't necessarily know what

729
00:40:15,800 --> 00:40:16,460
it is but

730
00:40:16,460 --> 00:40:20,670
so my favorite ways to get into a system
is repulsed a he said you don't care

731
00:40:20,670 --> 00:40:21,720
about the vendor

732
00:40:21,720 --> 00:40:25,049
dont virus do you see a difference
between the

733
00:40:25,050 --> 00:40:28,280
the so-called free for per for personal
use and the

734
00:40:28,280 --> 00:40:32,330
professional versions I tried not to

735
00:40:32,330 --> 00:40:36,799
drawer difference between 3n head for
and did not on purpose because I was

736
00:40:36,800 --> 00:40:38,820
curious to see if there would be a
difference

737
00:40:38,820 --> 00:40:42,770
German 925 to see the purple ones
because corporations get that warm fuzzy

738
00:40:42,770 --> 00:40:44,240
feeling when the purchase something

739
00:40:44,240 --> 00:40:47,270
but didn't see that much difference
between

740
00:40:47,270 --> 00:40:52,180
the anti-virus aspect a free impactful I
think the engines were very similar

741
00:40:52,180 --> 00:40:57,540
from my experience when I see is you
tend to death all the free version is

742
00:40:57,540 --> 00:41:00,900
just antivirus for the pet full version
is on the virus & anti spam and filed

743
00:41:00,900 --> 00:41:01,760
its a bundle

744
00:41:01,760 --> 00:41:06,180
kinda 360 security type thing so no I
didn't see a difference between perform

745
00:41:06,180 --> 00:41:13,180
free

746
00:41:14,330 --> 00:41:15,420
I think Adam

747
00:41:15,420 --> 00:41:15,820
thanks guys

