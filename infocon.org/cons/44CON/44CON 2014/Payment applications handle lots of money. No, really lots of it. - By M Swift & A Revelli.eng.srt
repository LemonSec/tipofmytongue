1
00:00:00,030 --> 00:00:03,959
that further adue those of you who eat

2
00:00:03,959 --> 00:00:06,899
alive will have noticed two things first

3
00:00:06,899 --> 00:00:09,240
of all i'm swifty and secondly alberto

4
00:00:09,240 --> 00:00:11,730
isn't here so he sends his apologies

5
00:00:11,730 --> 00:00:15,719
he's unfortunately unable to make the

6
00:00:15,719 --> 00:00:19,050
event last time it's because he almost

7
00:00:19,050 --> 00:00:21,779
died he had a hemorrhage in his carotid

8
00:00:21,779 --> 00:00:23,970
artery this time thankfully it's

9
00:00:23,970 --> 00:00:26,490
life-threatening but unfortunately can't

10
00:00:26,490 --> 00:00:29,250
make it so you're stuck with me I'm

11
00:00:29,250 --> 00:00:33,719
sorry so that said let's move straight

12
00:00:33,719 --> 00:00:36,329
on into it we're going to be covering a

13
00:00:36,329 --> 00:00:39,989
bunch of things I'm going to quickly

14
00:00:39,989 --> 00:00:41,670
talk through what our payment

15
00:00:41,670 --> 00:00:44,190
applications why am i doing this this is

16
00:00:44,190 --> 00:00:45,480
because I'm not talking about retail

17
00:00:45,480 --> 00:00:47,430
banking payments applications where you

18
00:00:47,430 --> 00:00:49,860
log on to your Lloyds by account on you

19
00:00:49,860 --> 00:00:52,770
make a payment for whatever it is you've

20
00:00:52,770 --> 00:00:54,600
bought I'm talking about back-end

21
00:00:54,600 --> 00:00:57,989
systems here things that large companies

22
00:00:57,989 --> 00:01:00,800
used to channel huge amounts of money to

23
00:01:00,800 --> 00:01:04,080
make settlements you'll understand more

24
00:01:04,080 --> 00:01:06,119
about that in a moment we'll then talk

25
00:01:06,119 --> 00:01:07,320
about what are the lines of attack

26
00:01:07,320 --> 00:01:11,970
against these systems we'll talk about

27
00:01:11,970 --> 00:01:15,090
what the standard flaws that we've come

28
00:01:15,090 --> 00:01:17,670
across over the years of dealing with

29
00:01:17,670 --> 00:01:20,340
these systems Alberto is a pen tester

30
00:01:20,340 --> 00:01:23,189
for many years I've worked in banking

31
00:01:23,189 --> 00:01:25,680
for financial industry for about 15

32
00:01:25,680 --> 00:01:28,770
years and then okay it's all very well

33
00:01:28,770 --> 00:01:29,909
talking about what the problems are

34
00:01:29,909 --> 00:01:31,409
we're then going to talk about how to

35
00:01:31,409 --> 00:01:34,530
fix it fixing it is as it turns out not

36
00:01:34,530 --> 00:01:36,600
a trivial exercise is going to take some

37
00:01:36,600 --> 00:01:40,229
time which drops me in to why am I doing

38
00:01:40,229 --> 00:01:43,950
this talk why am i doing it it's because

39
00:01:43,950 --> 00:01:48,659
the security industry generally and even

40
00:01:48,659 --> 00:01:50,430
my colleagues in other financial

41
00:01:50,430 --> 00:01:52,890
institutions in the security area don't

42
00:01:52,890 --> 00:01:54,630
really understand back in systems is

43
00:01:54,630 --> 00:01:57,360
this sort of murky business quasi

44
00:01:57,360 --> 00:01:59,969
accounting whatever type area that's

45
00:01:59,969 --> 00:02:02,640
populated by people who understand about

46
00:02:02,640 --> 00:02:04,409
left hand right hand systems and talk

47
00:02:04,409 --> 00:02:06,030
about Fidesz bureaus and things like

48
00:02:06,030 --> 00:02:09,000
that and frankly it strikes everybody is

49
00:02:09,000 --> 00:02:12,030
a bit odd kind of boring and we've left

50
00:02:12,030 --> 00:02:13,020
it alone

51
00:02:13,020 --> 00:02:15,920
and this is a major problem because

52
00:02:15,920 --> 00:02:19,020
there is unbelievably vast amounts of

53
00:02:19,020 --> 00:02:21,840
money going through these systems you

54
00:02:21,840 --> 00:02:24,000
know you're a a major investment bank

55
00:02:24,000 --> 00:02:26,760
making lots of settlements against

56
00:02:26,760 --> 00:02:28,500
trades especially if you're doing any

57
00:02:28,500 --> 00:02:30,450
kind of algorithmic trading you

58
00:02:30,450 --> 00:02:32,820
potentially in the trillions and are

59
00:02:32,820 --> 00:02:34,230
clearing trillions of dollars through

60
00:02:34,230 --> 00:02:37,500
this a year even a company that doesn't

61
00:02:37,500 --> 00:02:39,930
do that kind of trading but simply is up

62
00:02:39,930 --> 00:02:41,790
just a straight full trading company a

63
00:02:41,790 --> 00:02:42,450
big one

64
00:02:42,450 --> 00:02:44,070
you could be pushing a billion dollars a

65
00:02:44,070 --> 00:02:46,050
day through this payment gateway which

66
00:02:46,050 --> 00:02:48,600
means you've got money flowing back to

67
00:02:48,600 --> 00:02:50,640
you of over a billion dollars because

68
00:02:50,640 --> 00:02:52,530
obviously you've got a margin for profit

69
00:02:52,530 --> 00:02:54,510
in the money that comes back so there's

70
00:02:54,510 --> 00:02:57,150
lots of scope for fingers and the pie

71
00:02:57,150 --> 00:02:59,250
and hiding things volume means

72
00:02:59,250 --> 00:03:04,350
complexity I don't I think the security

73
00:03:04,350 --> 00:03:06,030
industry needs to actually start to

74
00:03:06,030 --> 00:03:07,640
seriously do something about this

75
00:03:07,640 --> 00:03:09,870
because otherwise we'll be in the same

76
00:03:09,870 --> 00:03:11,850
place that retail banking was whatever

77
00:03:11,850 --> 00:03:14,850
it was eight ten years ago where they

78
00:03:14,850 --> 00:03:16,290
started to work out that there were

79
00:03:16,290 --> 00:03:18,450
these people who could man-in-the-middle

80
00:03:18,450 --> 00:03:20,370
the browser and bla bla bla bla and

81
00:03:20,370 --> 00:03:22,110
steal a certain amount of money from

82
00:03:22,110 --> 00:03:24,540
their customers and it started turning

83
00:03:24,540 --> 00:03:26,220
you from being a bit of an annoyance

84
00:03:26,220 --> 00:03:28,140
into you know ten or twenty million

85
00:03:28,140 --> 00:03:29,580
dollars a year we're walking out the

86
00:03:29,580 --> 00:03:31,470
door which they had to make good okay

87
00:03:31,470 --> 00:03:33,930
this is the same scenario it's going to

88
00:03:33,930 --> 00:03:36,630
take years to put proper solutions in

89
00:03:36,630 --> 00:03:38,940
place same as with the retail front end

90
00:03:38,940 --> 00:03:42,930
banking and we're not talking ten or

91
00:03:42,930 --> 00:03:45,500
twenty million dollars here add a zero

92
00:03:45,500 --> 00:03:49,220
at least per company

93
00:03:49,220 --> 00:03:55,950
so landscape so this is just sort of

94
00:03:55,950 --> 00:03:58,530
basic context that you need to keep you

95
00:03:58,530 --> 00:04:00,510
know keep in your mind okay so hold

96
00:04:00,510 --> 00:04:02,340
these thoughts you've got the front

97
00:04:02,340 --> 00:04:05,970
office okay this is generic you do

98
00:04:05,970 --> 00:04:09,300
trading I make a trade with you or you

99
00:04:09,300 --> 00:04:12,120
build widgets and in order to build

100
00:04:12,120 --> 00:04:15,330
widgets you need to buy things or you

101
00:04:15,330 --> 00:04:18,120
need to make us you sell your widgets to

102
00:04:18,120 --> 00:04:19,829
somebody whatever there's a business

103
00:04:19,829 --> 00:04:21,959
process there we don't care it's not

104
00:04:21,959 --> 00:04:24,540
very interesting this is where it starts

105
00:04:24,540 --> 00:04:26,190
to become interesting the

106
00:04:26,190 --> 00:04:32,040
business process requires payments to be

107
00:04:32,040 --> 00:04:35,310
made or purchase orders to be made or

108
00:04:35,310 --> 00:04:37,410
you send somebody a purchase order

109
00:04:37,410 --> 00:04:39,840
saying I want you to give me some an

110
00:04:39,840 --> 00:04:41,790
invoice saying give me some money okay

111
00:04:41,790 --> 00:04:44,910
that will depending on the business go

112
00:04:44,910 --> 00:04:47,190
into some kind of purchase order raising

113
00:04:47,190 --> 00:04:50,360
settlement C type system okay

114
00:04:50,360 --> 00:04:53,220
that's a really good target which we'll

115
00:04:53,220 --> 00:04:55,290
talk about later and if you're in a

116
00:04:55,290 --> 00:04:57,450
trading business so financial trading

117
00:04:57,450 --> 00:04:59,070
business if I go into some trade

118
00:04:59,070 --> 00:05:02,070
reconciliation systems well that's not

119
00:05:02,070 --> 00:05:05,010
so interesting except that you can

120
00:05:05,010 --> 00:05:07,410
suppress your activity for quite some

121
00:05:07,410 --> 00:05:10,290
time there so you will remember you know

122
00:05:10,290 --> 00:05:12,210
bearings and soft jen and all of those

123
00:05:12,210 --> 00:05:14,820
kinds of things where you know some

124
00:05:14,820 --> 00:05:17,880
rogue trader UBS ripped off a company

125
00:05:17,880 --> 00:05:19,440
for huge amounts of money

126
00:05:19,440 --> 00:05:21,180
well they didn't rip off the company

127
00:05:21,180 --> 00:05:22,560
they basically just hid their losses

128
00:05:22,560 --> 00:05:24,480
they did that by fiddling with the

129
00:05:24,480 --> 00:05:28,410
reconciliations so what happens when

130
00:05:28,410 --> 00:05:30,360
you're when you're when your payment

131
00:05:30,360 --> 00:05:33,630
your purchase order payment is about to

132
00:05:33,630 --> 00:05:36,510
happen well it books into the accounting

133
00:05:36,510 --> 00:05:39,150
system into some ledger saying this

134
00:05:39,150 --> 00:05:42,030
money against this counterparty has been

135
00:05:42,030 --> 00:05:43,880
made you know this payment has been made

136
00:05:43,880 --> 00:05:46,620
and it'll also send an instruction of

137
00:05:46,620 --> 00:05:48,090
some kind to some kind of payment

138
00:05:48,090 --> 00:05:49,800
gateway

139
00:05:49,800 --> 00:05:52,830
this might payment gateway covers many

140
00:05:52,830 --> 00:05:55,710
things depending on the company it can

141
00:05:55,710 --> 00:06:02,640
be some kind of literal manual or almost

142
00:06:02,640 --> 00:06:04,380
like a retail bank account where you log

143
00:06:04,380 --> 00:06:07,230
on to the chief accountant logs on to a

144
00:06:07,230 --> 00:06:09,810
an online bank accountant says make this

145
00:06:09,810 --> 00:06:11,690
pay these payments to these standard

146
00:06:11,690 --> 00:06:14,880
counterparties or it will upload some

147
00:06:14,880 --> 00:06:17,340
kind of file generally you know some

148
00:06:17,340 --> 00:06:18,470
clear text file

149
00:06:18,470 --> 00:06:21,419
obviously horribly insecure those those

150
00:06:21,419 --> 00:06:24,780
plain text files uploaded to a bank

151
00:06:24,780 --> 00:06:28,290
they're called EFT 'the electronic fund

152
00:06:28,290 --> 00:06:31,380
transfers I think I don't know why makes

153
00:06:31,380 --> 00:06:33,900
them sound more secure maybe if you're

154
00:06:33,900 --> 00:06:36,419
more serious at one of the big boys

155
00:06:36,419 --> 00:06:38,520
which is obviously where the money lies

156
00:06:38,520 --> 00:06:39,360
hence the

157
00:06:39,360 --> 00:06:45,680
opportunity this payment gateway is a is

158
00:06:45,680 --> 00:06:48,360
basically pumps the money out to a third

159
00:06:48,360 --> 00:06:53,150
party broker effectively Fidesz or swift

160
00:06:53,150 --> 00:06:55,650
by the way that Swift is nothing to do

161
00:06:55,650 --> 00:07:01,610
with me it's just a it's just a name and

162
00:07:01,610 --> 00:07:04,289
you will send them in a structure and

163
00:07:04,289 --> 00:07:07,500
the instruction says move money from

164
00:07:07,500 --> 00:07:09,599
this bank account to those

165
00:07:09,599 --> 00:07:11,580
counterparties over there and hear all

166
00:07:11,580 --> 00:07:13,740
of the payment details and then they

167
00:07:13,740 --> 00:07:15,419
have agreements with all of your banks

168
00:07:15,419 --> 00:07:17,279
they'll send an instruction to all of

169
00:07:17,279 --> 00:07:18,779
those banks and then your banks will

170
00:07:18,779 --> 00:07:20,580
make payment to arbitrary payments to

171
00:07:20,580 --> 00:07:23,430
wherever it happens to be okay you can

172
00:07:23,430 --> 00:07:25,169
probably see where I'm little and going

173
00:07:25,169 --> 00:07:28,080
with here okay you've also got master

174
00:07:28,080 --> 00:07:30,539
data master data is a great place to

175
00:07:30,539 --> 00:07:33,000
play this is where this is the holy

176
00:07:33,000 --> 00:07:36,650
place where you put in this counterparty

177
00:07:36,650 --> 00:07:40,139
his kyc cleared here his bank details

178
00:07:40,139 --> 00:07:43,620
their bank details here's their credit

179
00:07:43,620 --> 00:07:45,029
limit you know all of that kind of

180
00:07:45,029 --> 00:07:47,039
lovely stuff which is just ripe for

181
00:07:47,039 --> 00:07:49,770
playing with and then obviously at the

182
00:07:49,770 --> 00:07:51,180
end of that the money ends up in a bank

183
00:07:51,180 --> 00:07:52,949
which you don't want to play with

184
00:07:52,949 --> 00:07:59,849
because anyway so your opportunity again

185
00:07:59,849 --> 00:08:01,740
this is sort of a bit more background

186
00:08:01,740 --> 00:08:03,839
prong context this is general problems

187
00:08:03,839 --> 00:08:06,889
to the process so how technical fiddling

188
00:08:06,889 --> 00:08:12,180
can be covered up or missed so there are

189
00:08:12,180 --> 00:08:14,009
massive payment and reconciliation

190
00:08:14,009 --> 00:08:16,650
volumes here reconciliation is is a bank

191
00:08:16,650 --> 00:08:18,990
statement comes in and you put that bank

192
00:08:18,990 --> 00:08:20,430
statement into your accounting system

193
00:08:20,430 --> 00:08:22,889
and you do a match I said I'd pay a

194
00:08:22,889 --> 00:08:24,870
million dollars to him I get the

195
00:08:24,870 --> 00:08:26,639
statement back and it said we made a

196
00:08:26,639 --> 00:08:28,849
payment of 1.1 million dollars okay

197
00:08:28,849 --> 00:08:32,309
we're over $100,000 over it's a break

198
00:08:32,309 --> 00:08:34,110
right so many needs to look at that

199
00:08:34,110 --> 00:08:35,820
figure out what the hell happened and

200
00:08:35,820 --> 00:08:37,649
sort it out to get the money back or

201
00:08:37,649 --> 00:08:41,190
whatever okay because you had vast

202
00:08:41,190 --> 00:08:46,730
volumes here it can be difficult to see

203
00:08:46,730 --> 00:08:49,410
their suppression that you can do and

204
00:08:49,410 --> 00:08:52,470
also volumes they're acceptable error

205
00:08:52,470 --> 00:08:55,560
margins okay this is where people can

206
00:08:55,560 --> 00:08:58,620
sneak in under the radar so you hear

207
00:08:58,620 --> 00:09:00,449
about somebody's work for business for

208
00:09:00,449 --> 00:09:03,390
15 years and over the course of time to

209
00:09:03,390 --> 00:09:04,709
feed their gambling habit they've stolen

210
00:09:04,709 --> 00:09:07,020
a million dollars and fed it away and

211
00:09:07,020 --> 00:09:09,029
the horses or something they're doing

212
00:09:09,029 --> 00:09:11,370
various things commonly one of them is

213
00:09:11,370 --> 00:09:14,160
an acceptable margin for error so in a

214
00:09:14,160 --> 00:09:15,959
small company that might be any any

215
00:09:15,959 --> 00:09:18,899
break that's $100 $100 hundred pounds

216
00:09:18,899 --> 00:09:20,790
you don't care it's not worth the effort

217
00:09:20,790 --> 00:09:24,420
of investigating anybody give a care to

218
00:09:24,420 --> 00:09:26,160
guess what an acceptable error break

219
00:09:26,160 --> 00:09:27,990
that you don't bother investigating it's

220
00:09:27,990 --> 00:09:31,980
in a major trading house somewhere

221
00:09:31,980 --> 00:09:33,209
between a hundred to four hundred

222
00:09:33,209 --> 00:09:36,649
thousand dollars less than that

223
00:09:36,649 --> 00:09:38,940
less than that is not worth

224
00:09:38,940 --> 00:09:40,100
investigating

225
00:09:40,100 --> 00:09:45,930
okay human error provide an explanation

226
00:09:45,930 --> 00:09:50,699
that seems logical the currency changed

227
00:09:50,699 --> 00:09:53,279
slightly because I altered it okay

228
00:09:53,279 --> 00:09:55,140
people will look at that explanation

229
00:09:55,140 --> 00:09:57,390
because it's one they know they'll take

230
00:09:57,390 --> 00:10:00,300
it you're done at a monk reconciliation

231
00:10:00,300 --> 00:10:02,370
so I talked about money coming in money

232
00:10:02,370 --> 00:10:04,100
going out and you do a match

233
00:10:04,100 --> 00:10:06,029
normally you know you might do weekly

234
00:10:06,029 --> 00:10:07,140
reconciliations

235
00:10:07,140 --> 00:10:09,750
some companies may even do month daily

236
00:10:09,750 --> 00:10:11,130
but at the end of the month

237
00:10:11,130 --> 00:10:12,899
reconciliation is the big one okay

238
00:10:12,899 --> 00:10:15,959
they never reconcile ask any accountant

239
00:10:15,959 --> 00:10:17,819
talk to anybody who works in finance

240
00:10:17,819 --> 00:10:21,180
they don't reconcile so you have all

241
00:10:21,180 --> 00:10:22,769
sorts of other things going on you have

242
00:10:22,769 --> 00:10:24,540
the crews you know depreciation you have

243
00:10:24,540 --> 00:10:25,709
all sorts other that we'll talk

244
00:10:25,709 --> 00:10:28,769
about later but basically they are

245
00:10:28,769 --> 00:10:33,600
expecting breaks also basically nobody

246
00:10:33,600 --> 00:10:35,370
understands he accounts anyway you'll

247
00:10:35,370 --> 00:10:37,380
find this there is almost nobody in the

248
00:10:37,380 --> 00:10:39,390
company except for one or two people who

249
00:10:39,390 --> 00:10:40,980
actually understand the accounts because

250
00:10:40,980 --> 00:10:43,350
they're they're impenetrable and they

251
00:10:43,350 --> 00:10:45,540
were impenetrable for a reason because

252
00:10:45,540 --> 00:10:46,980
there's all sorts of fancy accounting

253
00:10:46,980 --> 00:10:50,610
techniques that are used to how can I

254
00:10:50,610 --> 00:10:52,350
put it for it they're there for tax

255
00:10:52,350 --> 00:10:55,880
efficiency okay say

256
00:10:55,880 --> 00:11:00,630
nobody does a record manual check nobody

257
00:11:00,630 --> 00:11:02,880
actually goes to each bank account and

258
00:11:02,880 --> 00:11:04,890
says how much money went in how much

259
00:11:04,890 --> 00:11:06,960
money we're in tout let me reconcile

260
00:11:06,960 --> 00:11:09,270
that against my accounting system

261
00:11:09,270 --> 00:11:11,430
let me reconcile that against my payment

262
00:11:11,430 --> 00:11:14,340
gateway all three match everything is

263
00:11:14,340 --> 00:11:17,280
counted for you look at your golden

264
00:11:17,280 --> 00:11:19,350
source of truth which is your accounting

265
00:11:19,350 --> 00:11:22,410
system and all of the feeds come into

266
00:11:22,410 --> 00:11:24,540
that as long as that all works and the

267
00:11:24,540 --> 00:11:26,580
bottom line balance seems to be there

268
00:11:26,580 --> 00:11:29,430
you're good the only people who actually

269
00:11:29,430 --> 00:11:31,830
look at all three a forensic accountants

270
00:11:31,830 --> 00:11:33,060
and those the people who turn up when a

271
00:11:33,060 --> 00:11:34,530
company's gone bust to work out where

272
00:11:34,530 --> 00:11:39,630
the money is okay auditors sorry

273
00:11:39,630 --> 00:11:41,580
I hate auditors it's a it's a peeve of

274
00:11:41,580 --> 00:11:44,660
mine it's it's unnatural I'm sorry but

275
00:11:44,660 --> 00:11:49,950
there you go any of you ever worked in a

276
00:11:49,950 --> 00:11:51,540
company that's been audited will know

277
00:11:51,540 --> 00:11:53,820
that accountants and auditors will come

278
00:11:53,820 --> 00:11:55,530
in they look at processes and look at

279
00:11:55,530 --> 00:11:56,970
procedures they look at evidence to

280
00:11:56,970 --> 00:11:59,130
counts they'll ask you some questions

281
00:11:59,130 --> 00:12:01,470
you'll give them some about how

282
00:12:01,470 --> 00:12:04,410
you secure the process with you know

283
00:12:04,410 --> 00:12:08,040
whatever fits grade-a ESD age bond PCI

284
00:12:08,040 --> 00:12:10,380
blah whatever and put a tick in a box

285
00:12:10,380 --> 00:12:11,910
and we'll come back and pest you next

286
00:12:11,910 --> 00:12:12,920
year

287
00:12:12,920 --> 00:12:20,370
so landscape issues trade wrecks

288
00:12:20,370 --> 00:12:23,520
settlements so of some times you will

289
00:12:23,520 --> 00:12:27,060
see that the settlements engine talks to

290
00:12:27,060 --> 00:12:29,490
a payment gateway directly and sometimes

291
00:12:29,490 --> 00:12:31,920
it does it straight for by broadcasting

292
00:12:31,920 --> 00:12:35,250
messages generally unsigned just a

293
00:12:35,250 --> 00:12:38,450
packet dropped onto the wire off it goes

294
00:12:38,450 --> 00:12:40,680
payment details in there thank you very

295
00:12:40,680 --> 00:12:41,610
much other guests

296
00:12:41,610 --> 00:12:44,010
this is called direct settlements banks

297
00:12:44,010 --> 00:12:45,420
love direct settlements it's really

298
00:12:45,420 --> 00:12:48,870
efficient okay so what could go wrong

299
00:12:48,870 --> 00:12:53,300
there you've also got the actual

300
00:12:53,300 --> 00:12:56,370
payments as you know this area here so

301
00:12:56,370 --> 00:12:58,860
you've got SAP or you've got whatever it

302
00:12:58,860 --> 00:13:01,110
is that you are you're you create your

303
00:13:01,110 --> 00:13:04,230
payment instruction in okay people log

304
00:13:04,230 --> 00:13:06,690
into that through the GUI okay there's

305
00:13:06,690 --> 00:13:07,699
no left hand

306
00:13:07,699 --> 00:13:09,889
and so there's left hand returned

307
00:13:09,889 --> 00:13:12,169
operators very often not two-factor

308
00:13:12,169 --> 00:13:13,910
authentication steal their credentials

309
00:13:13,910 --> 00:13:16,579
luckiness them you create your payment

310
00:13:16,579 --> 00:13:18,739
you approve your payment that payment

311
00:13:18,739 --> 00:13:22,279
goes for payment you're done masturbator

312
00:13:22,279 --> 00:13:23,749
not secured fine creating new

313
00:13:23,749 --> 00:13:26,089
counterparty fiddled with the

314
00:13:26,089 --> 00:13:27,919
counterparty details change the bank

315
00:13:27,919 --> 00:13:31,160
account details you know the world's

316
00:13:31,160 --> 00:13:35,749
your oyster at the server so all this

317
00:13:35,749 --> 00:13:37,730
front-end stuff is too complex because

318
00:13:37,730 --> 00:13:39,859
we're low level guys and gooeys do ahead

319
00:13:39,859 --> 00:13:42,769
in fine go to the server the payment in

320
00:13:42,769 --> 00:13:46,579
the wreck so the payment file itself and

321
00:13:46,579 --> 00:13:48,769
the reconciliation of our that comes

322
00:13:48,769 --> 00:13:50,419
back from the bureau

323
00:13:50,419 --> 00:13:52,609
it's generally written out to a secure

324
00:13:52,609 --> 00:13:56,929
file share in plaintext before being

325
00:13:56,929 --> 00:13:58,879
loaded up into the accounting system all

326
00:13:58,879 --> 00:14:00,980
being created and sent off to the

327
00:14:00,980 --> 00:14:02,779
payment gateway okay

328
00:14:02,779 --> 00:14:07,279
secure file share anybody administrators

329
00:14:07,279 --> 00:14:09,230
you anybody else

330
00:14:09,230 --> 00:14:10,669
you've got straight access to that

331
00:14:10,669 --> 00:14:13,149
private keys generally lying around

332
00:14:13,149 --> 00:14:15,379
assuming that they're even use a private

333
00:14:15,379 --> 00:14:16,699
key and it's not some one of these

334
00:14:16,699 --> 00:14:18,529
plaintext dfts or something like that

335
00:14:18,529 --> 00:14:20,959
therefore you can steal that and you can

336
00:14:20,959 --> 00:14:22,699
just create any payment file you like

337
00:14:22,699 --> 00:14:25,429
and sign it and it's legitimate and the

338
00:14:25,429 --> 00:14:28,339
bureau will pay it well you could just

339
00:14:28,339 --> 00:14:31,399
go straight to the database because the

340
00:14:31,399 --> 00:14:34,509
payments probably in the database as a

341
00:14:34,509 --> 00:14:36,980
this payment has been authorized to this

342
00:14:36,980 --> 00:14:39,589
counterparty for this much money fine

343
00:14:39,589 --> 00:14:41,929
change change a few rows in the database

344
00:14:41,929 --> 00:14:46,879
a few columns play around okay I'm

345
00:14:46,879 --> 00:14:51,189
making payment to you well maybe not

346
00:14:51,189 --> 00:14:53,809
obviously none of this stuff is security

347
00:14:53,809 --> 00:14:56,749
security in memory nothing none of it I

348
00:14:56,749 --> 00:15:00,579
have not seen a single payment gateway

349
00:15:00,579 --> 00:15:03,350
counting system financial suit nothing

350
00:15:03,350 --> 00:15:06,579
I've ever seen as actually secured

351
00:15:06,579 --> 00:15:09,649
against memory attacks but on the other

352
00:15:09,649 --> 00:15:12,859
hand why bother is just no need if

353
00:15:12,859 --> 00:15:14,089
you're going there you're looking in the

354
00:15:14,089 --> 00:15:16,429
wrong place and then you've got the

355
00:15:16,429 --> 00:15:18,169
payment gateway itself okay

356
00:15:18,169 --> 00:15:20,500
signing in crypto generally happen

357
00:15:20,500 --> 00:15:22,480
which means that obviously you can be

358
00:15:22,480 --> 00:15:24,670
arbitrarily messing with anything up

359
00:15:24,670 --> 00:15:27,060
until it gets there once it's there

360
00:15:27,060 --> 00:15:30,160
because the signing of the encryption

361
00:15:30,160 --> 00:15:31,420
actually happened there obviously if

362
00:15:31,420 --> 00:15:32,650
you've broken into that you can make

363
00:15:32,650 --> 00:15:34,210
your changes to the payment files there

364
00:15:34,210 --> 00:15:35,460
too okay

365
00:15:35,460 --> 00:15:37,900
the private keys on was certainly just

366
00:15:37,900 --> 00:15:40,570
lying around there anyway so you've got

367
00:15:40,570 --> 00:15:43,380
the same problem we just talked about so

368
00:15:43,380 --> 00:15:45,670
I've been talking about payment files

369
00:15:45,670 --> 00:15:47,680
for what the hell's of payment files say

370
00:15:47,680 --> 00:15:50,350
you've got an NT 101 this is the

371
00:15:50,350 --> 00:15:52,360
international standard way of saying

372
00:15:52,360 --> 00:15:55,510
payment file which that's not me is it

373
00:15:55,510 --> 00:16:00,040
that good which means which is something

374
00:16:00,040 --> 00:16:02,890
that Swift or Fidesz these big bureaus

375
00:16:02,890 --> 00:16:05,530
use and banks will use to send money

376
00:16:05,530 --> 00:16:09,160
about and then you have the MT 940 which

377
00:16:09,160 --> 00:16:11,170
is basically the statement file so the

378
00:16:11,170 --> 00:16:12,820
thing that you match against all of your

379
00:16:12,820 --> 00:16:15,490
payments so you you make your payments

380
00:16:15,490 --> 00:16:17,830
your accounting system has logged the

381
00:16:17,830 --> 00:16:21,010
pins you make you get a 9th MT 940 which

382
00:16:21,010 --> 00:16:24,130
will be sucked up and to some extent

383
00:16:24,130 --> 00:16:25,960
automatically matched in your accounting

384
00:16:25,960 --> 00:16:27,100
system ok

385
00:16:27,100 --> 00:16:31,210
so for example that's the unique

386
00:16:31,210 --> 00:16:33,190
reference so you know that that this

387
00:16:33,190 --> 00:16:37,180
particular payment matches is is for

388
00:16:37,180 --> 00:16:38,800
this particular line in your bank

389
00:16:38,800 --> 00:16:41,500
statement that's for how much it is so

390
00:16:41,500 --> 00:16:46,450
1.3 million dollars in this case and pay

391
00:16:46,450 --> 00:16:50,140
to that bank and pay that accountant

392
00:16:50,140 --> 00:16:54,570
name ok so security services of account

393
00:16:54,570 --> 00:16:57,130
whatever it is by the way these have

394
00:16:57,130 --> 00:17:00,790
been changed so you know feel free to

395
00:17:00,790 --> 00:17:02,530
try and make a payment to it but you

396
00:17:02,530 --> 00:17:05,230
know you're not gonna have much joy so

397
00:17:05,230 --> 00:17:08,050
pay to that bank here's the details that

398
00:17:08,050 --> 00:17:09,940
much money and that's how you match it

399
00:17:09,940 --> 00:17:12,400
because it's very handy that you have

400
00:17:12,400 --> 00:17:14,290
you do have this unique reference so you

401
00:17:14,290 --> 00:17:16,569
can match them so if you do fiddle with

402
00:17:16,569 --> 00:17:19,180
this amount of money out you can also

403
00:17:19,180 --> 00:17:22,800
change it in the statement coming back

404
00:17:22,800 --> 00:17:27,160
warning first hint of why this becomes

405
00:17:27,160 --> 00:17:29,500
difficult these formats are

406
00:17:29,500 --> 00:17:31,120
international standard which of course

407
00:17:31,120 --> 00:17:33,890
means that they vary by bank

408
00:17:33,890 --> 00:17:38,360
so those numbers say line 30 to be line

409
00:17:38,360 --> 00:17:40,370
21 there's a pretty standard pretty much

410
00:17:40,370 --> 00:17:46,880
everybody fit uses that but the the more

411
00:17:46,880 --> 00:17:49,040
make up of the file the spacing the line

412
00:17:49,040 --> 00:17:51,890
references that's right at the spacing

413
00:17:51,890 --> 00:17:55,700
and various other things do change this

414
00:17:55,700 --> 00:17:57,950
can MIT will make for a parsing

415
00:17:57,950 --> 00:18:00,200
nightmare when you go off to try and fix

416
00:18:00,200 --> 00:18:03,620
this later also these these these files

417
00:18:03,620 --> 00:18:05,630
are huge okay there have all sorts of

418
00:18:05,630 --> 00:18:07,730
fields in them these are just some of

419
00:18:07,730 --> 00:18:09,140
the more interesting ones for the

420
00:18:09,140 --> 00:18:12,700
purposes of what we're talking about so

421
00:18:12,700 --> 00:18:17,720
okay starting to get into how people

422
00:18:17,720 --> 00:18:21,650
screw it up before we talk about what to

423
00:18:21,650 --> 00:18:32,780
do so straight from manual payment farm

424
00:18:32,780 --> 00:18:34,910
processing and this is the this is an

425
00:18:34,910 --> 00:18:37,820
example of the manual that is created by

426
00:18:37,820 --> 00:18:39,620
somebody who is talking about how they

427
00:18:39,620 --> 00:18:41,450
secure their payment process okay

428
00:18:41,450 --> 00:18:43,460
so the files are automatically stored in

429
00:18:43,460 --> 00:18:46,460
a predefined folder user accesses folder

430
00:18:46,460 --> 00:18:49,790
should be limited yeah good start the

431
00:18:49,790 --> 00:18:51,740
some bank account is an example of a

432
00:18:51,740 --> 00:18:53,299
hash total which can be used to check

433
00:18:53,299 --> 00:18:55,640
the integrity the data okay so they've

434
00:18:55,640 --> 00:18:58,970
got that idea great but it's a hash and

435
00:18:58,970 --> 00:19:00,860
this is a common problem you will see

436
00:19:00,860 --> 00:19:02,750
everywhere people don't understand

437
00:19:02,750 --> 00:19:05,870
hashing versus cryptographic signing

438
00:19:05,870 --> 00:19:08,150
they think they're the same obviously

439
00:19:08,150 --> 00:19:12,830
they're not transport to the payment

440
00:19:12,830 --> 00:19:17,630
file FTP or SFTP the file is often

441
00:19:17,630 --> 00:19:19,610
directly read from the account subfolder

442
00:19:19,610 --> 00:19:21,799
ie you have a piece of shitty code that

443
00:19:21,799 --> 00:19:25,630
dives into this this this shared folder

444
00:19:25,630 --> 00:19:28,250
has hard-coded credentials grab

445
00:19:28,250 --> 00:19:29,750
something does something and off it goes

446
00:19:29,750 --> 00:19:34,370
okay so you go off to your your your

447
00:19:34,370 --> 00:19:37,040
payment file processing manual wherever

448
00:19:37,040 --> 00:19:38,630
you are aware of your auditing or

449
00:19:38,630 --> 00:19:41,179
wherever your pen testing you read the

450
00:19:41,179 --> 00:19:44,059
user garden it says hack me here here

451
00:19:44,059 --> 00:19:47,840
and here so this is a standard

452
00:19:47,840 --> 00:19:52,090
process this is a real one but you know

453
00:19:52,090 --> 00:19:54,650
I've seen this in many places and those

454
00:19:54,650 --> 00:19:56,179
of you who are pen testers who have

455
00:19:56,179 --> 00:19:59,150
tested this kind of stuff will have seen

456
00:19:59,150 --> 00:19:59,870
this before

457
00:19:59,870 --> 00:20:01,789
how'd you drink create the payment file

458
00:20:01,789 --> 00:20:06,169
well you echo the password GPG to make

459
00:20:06,169 --> 00:20:08,299
your file so obviously the passwords

460
00:20:08,299 --> 00:20:11,330
just lying around and the file is too so

461
00:20:11,330 --> 00:20:12,710
do whatever you like

462
00:20:12,710 --> 00:20:15,140
upload it they happily they usefully

463
00:20:15,140 --> 00:20:17,080
give you the upload credentials as well

464
00:20:17,080 --> 00:20:20,480
and then you copy the outgoing payment

465
00:20:20,480 --> 00:20:24,590
file to somewhere else so do what you

466
00:20:24,590 --> 00:20:26,870
like create what you like and then you

467
00:20:26,870 --> 00:20:30,169
can also remember to UM to put

468
00:20:30,169 --> 00:20:31,520
everything back the way it should have

469
00:20:31,520 --> 00:20:34,700
been in the payment farm that's over

470
00:20:34,700 --> 00:20:35,899
there that gets sucked into the

471
00:20:35,899 --> 00:20:37,610
accounting system as the record or for

472
00:20:37,610 --> 00:20:40,460
the money that went out and then exactly

473
00:20:40,460 --> 00:20:44,770
the same on the on the statement side

474
00:20:44,770 --> 00:20:48,679
FTP go to here here's the password thank

475
00:20:48,679 --> 00:20:51,020
you very much decrypt the file using

476
00:20:51,020 --> 00:20:54,260
this password and then put it over there

477
00:20:54,260 --> 00:20:59,600
so you can go straight to that file edit

478
00:20:59,600 --> 00:21:02,120
is up to what it is that they thought

479
00:21:02,120 --> 00:21:04,850
they made the payment for complete

480
00:21:04,850 --> 00:21:06,590
suppression you can keep that ball

481
00:21:06,590 --> 00:21:12,190
rolling for a bit so lines of attack

482
00:21:12,190 --> 00:21:14,110
oops

483
00:21:14,110 --> 00:21:17,140
basic lines of attack bit of a recap

484
00:21:17,140 --> 00:21:19,669
manual payments of course you can steal

485
00:21:19,669 --> 00:21:21,559
the bank creds same as you do in retail

486
00:21:21,559 --> 00:21:24,740
banking from the poor old end-user and

487
00:21:24,740 --> 00:21:28,010
just transfer cash reconciliation is for

488
00:21:28,010 --> 00:21:30,649
new this is more difficult there's a

489
00:21:30,649 --> 00:21:33,740
direct banking interface do the same you

490
00:21:33,740 --> 00:21:35,690
can mess with a payment file correct the

491
00:21:35,690 --> 00:21:37,309
reconciliation statement as we just

492
00:21:37,309 --> 00:21:40,370
talked about and if it's you know Fidesz

493
00:21:40,370 --> 00:21:42,350
or swift so it's nicely encrypted and

494
00:21:42,350 --> 00:21:45,140
what have you you can just grab it

495
00:21:45,140 --> 00:21:47,299
before a gets signed for the decryption

496
00:21:47,299 --> 00:21:51,110
and verification slightly less basic

497
00:21:51,110 --> 00:21:53,210
second hand fraud so as we said you can

498
00:21:53,210 --> 00:21:54,980
steal the authentication details from

499
00:21:54,980 --> 00:21:56,960
the left hand right hand officers a bit

500
00:21:56,960 --> 00:21:58,190
more difficult if they're using

501
00:21:58,190 --> 00:22:01,210
two-factor authentication but in

502
00:22:01,210 --> 00:22:04,779
you'll know their ways around that more

503
00:22:04,779 --> 00:22:07,510
difficult so you could use the ways

504
00:22:07,510 --> 00:22:11,380
around that but why bother instead just

505
00:22:11,380 --> 00:22:13,539
change the customer details and change

506
00:22:13,539 --> 00:22:14,770
back later

507
00:22:14,770 --> 00:22:17,230
internal collusion well why we talk

508
00:22:17,230 --> 00:22:19,029
about internal collusion that's just two

509
00:22:19,029 --> 00:22:20,620
accountants getting together and making

510
00:22:20,620 --> 00:22:23,049
an agreement because this isn't just

511
00:22:23,049 --> 00:22:26,220
about evil wicked hackers stealing money

512
00:22:26,220 --> 00:22:30,039
this is also about end-to-end securing

513
00:22:30,039 --> 00:22:32,799
the crisis against everybody and as we

514
00:22:32,799 --> 00:22:37,120
know most theft most fraud is actually

515
00:22:37,120 --> 00:22:40,419
internal employees and people who work

516
00:22:40,419 --> 00:22:43,600
in the finance area so whatever solution

517
00:22:43,600 --> 00:22:45,669
you put in place and I talk about what

518
00:22:45,669 --> 00:22:47,890
has to be able to deal with internal

519
00:22:47,890 --> 00:22:49,539
collusion if you turn up and you just

520
00:22:49,539 --> 00:22:51,250
say we can defend you against wicked

521
00:22:51,250 --> 00:22:53,350
hackers like this you're not going to

522
00:22:53,350 --> 00:22:55,480
get buy-in because they know that most

523
00:22:55,480 --> 00:22:57,520
of the money is not Russian crime gangs

524
00:22:57,520 --> 00:22:59,890
but is joke he worked in accounts for

525
00:22:59,890 --> 00:23:03,909
the last 20 years direct change to the

526
00:23:03,909 --> 00:23:06,070
data base fiddle with account with the

527
00:23:06,070 --> 00:23:08,169
master details changed the counterparty

528
00:23:08,169 --> 00:23:10,659
details blah blah blah ok external

529
00:23:10,659 --> 00:23:13,320
partners in fraud so will pay whatever

530
00:23:13,320 --> 00:23:16,830
you on the inside can suppress the wreck

531
00:23:16,830 --> 00:23:19,240
they on the outside can break in and

532
00:23:19,240 --> 00:23:21,789
steal the money you can keep that

533
00:23:21,789 --> 00:23:24,580
rolling for a long time so again your

534
00:23:24,580 --> 00:23:26,760
solution has to be able to deal with

535
00:23:26,760 --> 00:23:29,559
collusion internal versus external as

536
00:23:29,559 --> 00:23:32,559
well this one is funny

537
00:23:32,559 --> 00:23:36,279
so operate your accuracy reports people

538
00:23:36,279 --> 00:23:39,070
know their operators some operators are

539
00:23:39,070 --> 00:23:42,789
better than others and this is just an

540
00:23:42,789 --> 00:23:44,830
example of the sorts of thing tricks you

541
00:23:44,830 --> 00:23:46,480
can play in things you that you can do

542
00:23:46,480 --> 00:23:51,279
in order to mislead people who are

543
00:23:51,279 --> 00:23:55,110
trying to understand what hell happened

544
00:23:56,730 --> 00:24:02,860
you make all of the incorrect payments

545
00:24:02,860 --> 00:24:05,810
against the user ID of the most

546
00:24:05,810 --> 00:24:09,290
incompetent operator they're going to

547
00:24:09,290 --> 00:24:11,300
assume that it was him being incompetent

548
00:24:11,300 --> 00:24:16,880
or stupid as usual I won't talk through

549
00:24:16,880 --> 00:24:20,440
all of these but you get the idea okay

550
00:24:20,440 --> 00:24:23,510
if you want to be serious about

551
00:24:23,510 --> 00:24:26,860
suppressing the the payment breaks

552
00:24:26,860 --> 00:24:29,240
hiding your tracks for long enough to

553
00:24:29,240 --> 00:24:31,490
steal really serious money as opposed to

554
00:24:31,490 --> 00:24:34,280
just serious money you need to get into

555
00:24:34,280 --> 00:24:36,850
all sorts of Accountancy tricks

556
00:24:36,850 --> 00:24:39,410
these things aren't generally as complex

557
00:24:39,410 --> 00:24:45,710
as you think and they also can be useful

558
00:24:45,710 --> 00:24:48,860
in justice you know free up cash in

559
00:24:48,860 --> 00:24:50,630
order to then steal it and then suppress

560
00:24:50,630 --> 00:24:52,790
it in the accounts so you change

561
00:24:52,790 --> 00:24:54,920
interest rates on a loan there's some

562
00:24:54,920 --> 00:24:57,770
spare cash that is now hanging around

563
00:24:57,770 --> 00:25:00,230
fine move it off to the grand Caymans

564
00:25:00,230 --> 00:25:02,540
wherever it is that you have your your

565
00:25:02,540 --> 00:25:05,420
dodgy bank account make up a credit for

566
00:25:05,420 --> 00:25:08,240
another part of the company then aside

567
00:25:08,240 --> 00:25:10,610
from that money of somewhere else and

568
00:25:10,610 --> 00:25:12,680
then when their money's gone obviously

569
00:25:12,680 --> 00:25:14,060
you make that out as a loan into a

570
00:25:14,060 --> 00:25:15,890
different part of the company so the

571
00:25:15,890 --> 00:25:17,930
money came in the money went out it's

572
00:25:17,930 --> 00:25:20,120
all good except that it's actually over

573
00:25:20,120 --> 00:25:24,890
there or not over there so this is the

574
00:25:24,890 --> 00:25:26,900
gold standard this is how a Tier one

575
00:25:26,900 --> 00:25:30,140
investment bank does it I don't know if

576
00:25:30,140 --> 00:25:32,780
you can really see that but up at the

577
00:25:32,780 --> 00:25:35,050
top you've got your Fidesz Bureau and

578
00:25:35,050 --> 00:25:39,380
you know you're uploading your MT 101

579
00:25:39,380 --> 00:25:42,670
you've got your payment system here and

580
00:25:42,670 --> 00:25:47,600
paint a member there I can't read that

581
00:25:47,600 --> 00:25:51,200
either okay let's do it over here you've

582
00:25:51,200 --> 00:25:53,780
got your will the mouse work yep there

583
00:25:53,780 --> 00:25:55,820
we go so you've got encrypted payment

584
00:25:55,820 --> 00:25:58,520
file over here the encryption is

585
00:25:58,520 --> 00:25:59,870
actually happening on a hardware

586
00:25:59,870 --> 00:26:01,850
security module so the keys can't be

587
00:26:01,850 --> 00:26:04,550
moved off it users authenticate against

588
00:26:04,550 --> 00:26:06,440
the active directory you've got your

589
00:26:06,440 --> 00:26:09,050
users on your your your systems over

590
00:26:09,050 --> 00:26:11,060
here that login you know they use

591
00:26:11,060 --> 00:26:12,470
two-factor authentication it

592
00:26:12,470 --> 00:26:14,600
authenticates against your RSA server

593
00:26:14,600 --> 00:26:15,310
over here

594
00:26:15,310 --> 00:26:17,380
payment is structures are sent between

595
00:26:17,380 --> 00:26:19,720
your back-end system so your accountancy

596
00:26:19,720 --> 00:26:21,310
system or whatever and your payment

597
00:26:21,310 --> 00:26:24,400
module here it all goes into a database

598
00:26:24,400 --> 00:26:27,160
you know this looks quite good as an

599
00:26:27,160 --> 00:26:28,990
architectural diagram but everything

600
00:26:28,990 --> 00:26:30,940
we've just talked about pretty much

601
00:26:30,940 --> 00:26:33,790
still applies oli the accountancy tricks

602
00:26:33,790 --> 00:26:37,420
that we talked about work so all the

603
00:26:37,420 --> 00:26:40,570
suppression works the database how are

604
00:26:40,570 --> 00:26:42,700
the payment and a counterparty data

605
00:26:42,700 --> 00:26:45,100
stored in the prior to payment

606
00:26:45,100 --> 00:26:47,140
generation they're in the database

607
00:26:47,140 --> 00:26:48,700
okay who's got access to the database

608
00:26:48,700 --> 00:26:50,560
anybody with the credentials is the

609
00:26:50,560 --> 00:26:53,100
database even encrypted probably not

610
00:26:53,100 --> 00:26:56,200
how's the authentication to this you

611
00:26:56,200 --> 00:26:58,420
know to the backend ERP state system

612
00:26:58,420 --> 00:27:00,430
over here secured where the payment

613
00:27:00,430 --> 00:27:02,260
instructions are generated before they

614
00:27:02,260 --> 00:27:05,530
get to this payment gateway probably not

615
00:27:05,530 --> 00:27:07,630
particularly well so we've still got

616
00:27:07,630 --> 00:27:12,220
that this hasn't really solved any

617
00:27:12,220 --> 00:27:14,320
problems but initially it does look

618
00:27:14,320 --> 00:27:21,280
quite good so there is various standard

619
00:27:21,280 --> 00:27:23,790
problems and then we'll talk through

620
00:27:23,790 --> 00:27:26,710
we'll talk through how to actually fix

621
00:27:26,710 --> 00:27:31,060
this so here's an example this this I'm

622
00:27:31,060 --> 00:27:33,670
sorry but again auditors it's it's a

623
00:27:33,670 --> 00:27:35,830
particular weakness of mine so this is a

624
00:27:35,830 --> 00:27:38,170
genuine email exchange that I once had

625
00:27:38,170 --> 00:27:40,030
with somebody at one of the big five

626
00:27:40,030 --> 00:27:44,590
when I was saying so you have I've come

627
00:27:44,590 --> 00:27:46,060
into this company we've built the

628
00:27:46,060 --> 00:27:49,360
systems here explain to me how this is

629
00:27:49,360 --> 00:27:52,000
secured because they work they were they

630
00:27:52,000 --> 00:27:53,770
were actually building the system as

631
00:27:53,770 --> 00:27:56,830
part of a consultancy gig so they were

632
00:27:56,830 --> 00:27:59,320
explaining the security so as they can

633
00:27:59,320 --> 00:28:01,240
say it's hard to do this because

634
00:28:01,240 --> 00:28:03,220
somebody needs to know the password and

635
00:28:03,220 --> 00:28:04,840
they need to have access to the private

636
00:28:04,840 --> 00:28:08,320
key and the password is only known to

637
00:28:08,320 --> 00:28:11,200
people in this is the shared password is

638
00:28:11,200 --> 00:28:12,640
only known to people in this particular

639
00:28:12,640 --> 00:28:15,520
team and the private key is stored on a

640
00:28:15,520 --> 00:28:20,040
controlled shared environment so

641
00:28:20,509 --> 00:28:23,149
this one was a this one is an absolute

642
00:28:23,149 --> 00:28:26,600
Perla so I was we were building a SAP

643
00:28:26,600 --> 00:28:30,739
system for a mine and we needed to sync

644
00:28:30,739 --> 00:28:36,259
it with an external HR system so ok fine

645
00:28:36,259 --> 00:28:39,320
data privacy blah blah blah how do we

646
00:28:39,320 --> 00:28:41,929
secure the data going out from this

647
00:28:41,929 --> 00:28:44,029
between the SAP system to the HR system

648
00:28:44,029 --> 00:28:47,179
and Mac again so fine talk to me

649
00:28:47,179 --> 00:28:49,309
Hashem crypto this that the other is

650
00:28:49,309 --> 00:28:50,840
like yeah yeah not a problem

651
00:28:50,840 --> 00:28:52,309
I've done this before I've implemented

652
00:28:52,309 --> 00:28:55,489
this for banks ok why am I telling you

653
00:28:55,489 --> 00:28:55,879
this

654
00:28:55,879 --> 00:28:59,149
this and people like him on SAP

655
00:28:59,149 --> 00:29:02,619
systems have done this kind of stupidity

656
00:29:02,619 --> 00:29:08,929
with SAP the golden whatever the golden

657
00:29:08,929 --> 00:29:12,109
system took making payments to banks and

658
00:29:12,109 --> 00:29:14,299
transferring payment details so in this

659
00:29:14,299 --> 00:29:16,749
case his idea of a hash total was

660
00:29:16,749 --> 00:29:18,950
multiply each account number for the

661
00:29:18,950 --> 00:29:20,929
respective some some more results and

662
00:29:20,929 --> 00:29:22,549
take the twenty two most significant

663
00:29:22,549 --> 00:29:27,249
digits so first of all again it's a hash

664
00:29:27,249 --> 00:29:30,019
it's a bad hash it's an appalling ly bad

665
00:29:30,019 --> 00:29:32,389
hash but it's still a hash it's not the

666
00:29:32,389 --> 00:29:36,409
cryptographic signature so easy to

667
00:29:36,409 --> 00:29:38,659
change easy to predict

668
00:29:38,659 --> 00:29:40,759
encryption this one this one was even

669
00:29:40,759 --> 00:29:43,249
better this one is fantastic so he

670
00:29:43,249 --> 00:29:45,019
explained what he did he generated a

671
00:29:45,019 --> 00:29:47,539
very long key which was I don't know 20

672
00:29:47,539 --> 00:29:50,179
characters or something from each

673
00:29:50,179 --> 00:29:54,619
payment file you iterate by a given

674
00:29:54,619 --> 00:29:56,989
number that's entirely predictable and

675
00:29:56,989 --> 00:29:59,950
then his the cipher that he used was

676
00:29:59,950 --> 00:30:03,049
something that literally a 500 year old

677
00:30:03,049 --> 00:30:07,009
cipher the Charles Babbage broke almost

678
00:30:07,009 --> 00:30:10,460
200 years ago publicly in I think in the

679
00:30:10,460 --> 00:30:12,499
times he wrote a letter to the times in

680
00:30:12,499 --> 00:30:19,190
response to a challenge yeah so this is

681
00:30:19,190 --> 00:30:23,220
the kind of nonsense that's out there so

682
00:30:23,220 --> 00:30:26,430
that's all very amusing how do we fix it

683
00:30:26,430 --> 00:30:30,230
so you fix it by focusing on this area

684
00:30:30,230 --> 00:30:34,140
because that's that's where that's what

685
00:30:34,140 --> 00:30:36,330
you've got to deal with okay if you can

686
00:30:36,330 --> 00:30:38,850
sort out that you've stopped people

687
00:30:38,850 --> 00:30:40,860
covering their tracks and you've stopped

688
00:30:40,860 --> 00:30:42,690
the ability to make arbitrary payments

689
00:30:42,690 --> 00:30:45,000
so generally the way the process works

690
00:30:45,000 --> 00:30:48,450
is user a says I would like to pay raise

691
00:30:48,450 --> 00:30:50,280
a purchase order to make a payment for a

692
00:30:50,280 --> 00:30:54,060
hundred widgets to company acts user B

693
00:30:54,060 --> 00:30:56,640
logs into the system sees the payment

694
00:30:56,640 --> 00:30:59,040
request purchase order request he

695
00:30:59,040 --> 00:31:02,240
approves it uses C logs into the system

696
00:31:02,240 --> 00:31:05,070
he goes that looks appropriate it's

697
00:31:05,070 --> 00:31:06,840
within the signing limit I can see it's

698
00:31:06,840 --> 00:31:08,940
been validly approved I release it and

699
00:31:08,940 --> 00:31:11,430
user D does a finalization process which

700
00:31:11,430 --> 00:31:13,530
is basically the automatic the MT

701
00:31:13,530 --> 00:31:16,020
one-on-one is automatically created so

702
00:31:16,020 --> 00:31:18,480
you've got you know never mind left hand

703
00:31:18,480 --> 00:31:19,560
right hand control you've got four

704
00:31:19,560 --> 00:31:25,320
people in the process well remember when

705
00:31:25,320 --> 00:31:27,810
a user creates and approves a payment so

706
00:31:27,810 --> 00:31:29,220
all of these four people have done their

707
00:31:29,220 --> 00:31:30,570
thing all you're doing is you're writing

708
00:31:30,570 --> 00:31:32,220
some rows into a database that can be

709
00:31:32,220 --> 00:31:34,560
played with okay the MT one and one is

710
00:31:34,560 --> 00:31:36,090
created and it's stored some are in

711
00:31:36,090 --> 00:31:39,949
plain text blah blah blah okay

712
00:31:45,870 --> 00:31:51,700
so basic idea in time trying to secure

713
00:31:51,700 --> 00:31:56,350
it user a creates a payment fine the

714
00:31:56,350 --> 00:31:57,670
payments signed it is probably the

715
00:31:57,670 --> 00:31:58,990
private key associated with that user

716
00:31:58,990 --> 00:32:04,060
user B checks it you take that previous

717
00:32:04,060 --> 00:32:07,630
payment and private key you then stamp

718
00:32:07,630 --> 00:32:09,880
the whole thing with users B private key

719
00:32:09,880 --> 00:32:12,700
user C goes in and we approve zit or

720
00:32:12,700 --> 00:32:15,550
validates it or whatever against so you

721
00:32:15,550 --> 00:32:17,640
take the payment the payment request

722
00:32:17,640 --> 00:32:19,990
wrapped up in the to private keys and

723
00:32:19,990 --> 00:32:21,070
you iterate again you put another

724
00:32:21,070 --> 00:32:23,110
private key read it okay so that way you

725
00:32:23,110 --> 00:32:25,840
go end-to-end continuity okay you get

726
00:32:25,840 --> 00:32:30,060
the idea so actually that could work so

727
00:32:30,060 --> 00:32:32,650
first thing you think is well all we do

728
00:32:32,650 --> 00:32:34,930
is how do we do it we just you've got

729
00:32:34,930 --> 00:32:36,640
the payment request in the database and

730
00:32:36,640 --> 00:32:38,980
you just have the user ID and you put

731
00:32:38,980 --> 00:32:40,420
that signature there and then at the end

732
00:32:40,420 --> 00:32:41,800
of it you unwrap your tool and it's all

733
00:32:41,800 --> 00:32:45,100
sorted okay see this sounds like a

734
00:32:45,100 --> 00:32:48,210
trivial problem to solve unfortunately

735
00:32:48,210 --> 00:32:51,520
as soon as you get into the reality it

736
00:32:51,520 --> 00:32:55,420
becomes rather more complex so this is

737
00:32:55,420 --> 00:32:57,970
all we're dealing with relational

738
00:32:57,970 --> 00:33:02,290
databases here not nice flat tables so

739
00:33:02,290 --> 00:33:05,100
you've got the MT 101 information

740
00:33:05,100 --> 00:33:08,470
details so I'm the sending instruction

741
00:33:08,470 --> 00:33:11,800
to this bank with you know to make a

742
00:33:11,800 --> 00:33:14,710
payment to you know whoever that whoever

743
00:33:14,710 --> 00:33:17,620
the person is this is the recipient

744
00:33:17,620 --> 00:33:19,330
these are the transaction details blah

745
00:33:19,330 --> 00:33:23,590
the MT 101 itself will have who is the

746
00:33:23,590 --> 00:33:28,140
servicing institution staff okay and

747
00:33:28,140 --> 00:33:31,480
you'll have multiples of those relate to

748
00:33:31,480 --> 00:33:34,960
each recipient and each recipient will

749
00:33:34,960 --> 00:33:37,300
have many transactions associated with

750
00:33:37,300 --> 00:33:39,490
them so you've got many to many and many

751
00:33:39,490 --> 00:33:42,010
to many relationships going on here so

752
00:33:42,010 --> 00:33:44,140
just writing a few rows into a database

753
00:33:44,140 --> 00:33:47,310
isn't going to work also it gets worse

754
00:33:47,310 --> 00:33:51,910
because each

755
00:33:51,910 --> 00:33:54,740
the payment approval process will go in

756
00:33:54,740 --> 00:33:56,450
various different ways you don't always

757
00:33:56,450 --> 00:33:59,240
have person a person BC of the date who

758
00:33:59,240 --> 00:34:01,460
approve it it might be a B or C can

759
00:34:01,460 --> 00:34:02,620
approve step 1

760
00:34:02,620 --> 00:34:07,640
BCD can approve step 2 AC any you know

761
00:34:07,640 --> 00:34:09,710
step 3 as long as they're mutually

762
00:34:09,710 --> 00:34:15,110
exclusive and it turns into a big mess

763
00:34:15,110 --> 00:34:16,520
if you try and do it at the database

764
00:34:16,520 --> 00:34:19,699
level plus also who's going to sign it

765
00:34:19,699 --> 00:34:25,699
well and this gets into where do you

766
00:34:25,699 --> 00:34:28,730
store the keys because if all you're

767
00:34:28,730 --> 00:34:30,380
doing is your payment apps talking to

768
00:34:30,380 --> 00:34:35,780
we're over the key is you you haven't

769
00:34:35,780 --> 00:34:38,659
solved the collusion problem look at

770
00:34:38,659 --> 00:34:41,090
that and we'll talk about why this is

771
00:34:41,090 --> 00:34:43,429
why you need this thing in the middle

772
00:34:43,429 --> 00:34:46,040
later but basically that you need

773
00:34:46,040 --> 00:34:50,030
something as a broker in order to

774
00:34:50,030 --> 00:34:52,760
provide IT segregation as well as the

775
00:34:52,760 --> 00:34:57,920
business segregation HSN subnet so what

776
00:34:57,920 --> 00:35:02,000
what is this HSM thing so hardware

777
00:35:02,000 --> 00:35:06,110
security module it's a piece of embedded

778
00:35:06,110 --> 00:35:06,680
kit

779
00:35:06,680 --> 00:35:09,020
it's tamper resistant you fiddle with it

780
00:35:09,020 --> 00:35:10,760
you try and leave or you know open it up

781
00:35:10,760 --> 00:35:14,330
to take the disks at zeroes itself all

782
00:35:14,330 --> 00:35:16,070
keys are stored in hardware you can't

783
00:35:16,070 --> 00:35:21,080
export the keys it's it does everything

784
00:35:21,080 --> 00:35:23,720
it even will produce you vast quality

785
00:35:23,720 --> 00:35:26,000
quantities of really high-quality random

786
00:35:26,000 --> 00:35:29,840
numbers they're really cool and they're

787
00:35:29,840 --> 00:35:34,420
properly properly secured ok

788
00:35:35,150 --> 00:35:38,900
they've come basically out of the

789
00:35:38,900 --> 00:35:41,960
military out of out of government type

790
00:35:41,960 --> 00:35:44,810
areas you authenticate to this you have

791
00:35:44,810 --> 00:35:47,450
a you know you have a secondary token

792
00:35:47,450 --> 00:35:49,820
this itself is effectively a secondary

793
00:35:49,820 --> 00:35:51,980
token that establishes the fact that you

794
00:35:51,980 --> 00:35:54,680
can even open an SSH Channel to it and

795
00:35:54,680 --> 00:35:57,370
then when in order to do any kind of

796
00:35:57,370 --> 00:36:00,260
operation on the HSM so to create keys

797
00:36:00,260 --> 00:36:02,270
whatever again you've got to go through

798
00:36:02,270 --> 00:36:04,250
the whole authentication and whatever

799
00:36:04,250 --> 00:36:04,910
process

800
00:36:04,910 --> 00:36:08,810
this thing again how do I know that it's

801
00:36:08,810 --> 00:36:10,820
used by soldiers and tanks a Russian guy

802
00:36:10,820 --> 00:36:12,950
who works in our office where we were

803
00:36:12,950 --> 00:36:14,720
first got these and played around with

804
00:36:14,720 --> 00:36:15,110
it

805
00:36:15,110 --> 00:36:16,820
we're going copies things a bit clunky

806
00:36:16,820 --> 00:36:19,160
said yeah yeah you did in a Russian

807
00:36:19,160 --> 00:36:20,690
accent which I won't try and you know

808
00:36:20,690 --> 00:36:23,450
but yeah he said basically said yeah we

809
00:36:23,450 --> 00:36:25,490
had these two we use they're used in

810
00:36:25,490 --> 00:36:27,320
tanks and you use them to initialize

811
00:36:27,320 --> 00:36:29,450
radio communications so they're properly

812
00:36:29,450 --> 00:36:31,100
secured because each tank is worth a lot

813
00:36:31,100 --> 00:36:32,630
of money and you've got 20 them in a

814
00:36:32,630 --> 00:36:34,520
battle group you know that's a lot of

815
00:36:34,520 --> 00:36:36,140
destructive power that you really need

816
00:36:36,140 --> 00:36:37,820
to be pointed in the right direction

817
00:36:37,820 --> 00:36:42,860
okay so yeah one your HSM comes and

818
00:36:42,860 --> 00:36:44,150
you've got this thing that you look like

819
00:36:44,150 --> 00:36:45,860
you could be to dragon to death with

820
00:36:45,860 --> 00:36:47,900
it's because it's not designed for use

821
00:36:47,900 --> 00:36:49,610
by soft fingered little people in the

822
00:36:49,610 --> 00:36:51,220
office okay

823
00:36:51,220 --> 00:36:56,540
so that said you now have this brokering

824
00:36:56,540 --> 00:37:01,070
thing so how does it work up here you

825
00:37:01,070 --> 00:37:04,520
have your DVD Mouse yep excellent you've

826
00:37:04,520 --> 00:37:05,870
got your creator you prove your

827
00:37:05,870 --> 00:37:07,130
finalizer so you've got your business

828
00:37:07,130 --> 00:37:09,880
segregation here okay

829
00:37:09,880 --> 00:37:14,750
this payment signing a request each each

830
00:37:14,750 --> 00:37:16,820
time this person does something goes to

831
00:37:16,820 --> 00:37:20,030
here this crypto web service basically

832
00:37:20,030 --> 00:37:23,750
brokers you've got your administrators

833
00:37:23,750 --> 00:37:26,810
here so you've got on the HSM you've got

834
00:37:26,810 --> 00:37:30,710
your HSM your HSM dudes to manage the

835
00:37:30,710 --> 00:37:33,680
HSM but have access to anything else the

836
00:37:33,680 --> 00:37:36,410
admins who associate the keys that the

837
00:37:36,410 --> 00:37:40,370
user has in the HSM with the with with

838
00:37:40,370 --> 00:37:43,610
the individual user and you've got your

839
00:37:43,610 --> 00:37:46,010
ad admins who administer the Active

840
00:37:46,010 --> 00:37:48,890
Directory who put this person in the

841
00:37:48,890 --> 00:37:51,020
creators group this person the finalizes

842
00:37:51,020 --> 00:37:52,430
group in this person in the approvers

843
00:37:52,430 --> 00:37:54,800
group okay so now you have some nice

844
00:37:54,800 --> 00:37:57,950
segregation here as well so you need to

845
00:37:57,950 --> 00:38:00,680
have collusion between this guy this guy

846
00:38:00,680 --> 00:38:04,930
this guy in order to do IT trickery and

847
00:38:04,930 --> 00:38:08,420
collusion between those guys all of them

848
00:38:08,420 --> 00:38:13,130
in order to make a make a dodgy payment

849
00:38:13,130 --> 00:38:15,260
because basically they're saying I will

850
00:38:15,260 --> 00:38:17,180
create a fictitious counterparty you

851
00:38:17,180 --> 00:38:18,070
will approve it

852
00:38:18,070 --> 00:38:19,600
and then you will finalize and release

853
00:38:19,600 --> 00:38:21,250
it and they all say excellent

854
00:38:21,250 --> 00:38:22,750
except of course they won't because they

855
00:38:22,750 --> 00:38:24,640
know they'll be caught unless they're

856
00:38:24,640 --> 00:38:25,270
really stupid

857
00:38:25,270 --> 00:38:26,590
in which case they'll do it and then

858
00:38:26,590 --> 00:38:32,230
they'll be caught so great but still

859
00:38:32,230 --> 00:38:34,090
what the hell are we signing because we

860
00:38:34,090 --> 00:38:37,170
just said we can't just put we can't add

861
00:38:37,170 --> 00:38:40,690
signing keys straight into the database

862
00:38:40,690 --> 00:38:43,000
so effect what you're actually doing is

863
00:38:43,000 --> 00:38:45,430
each time you sign something you're

864
00:38:45,430 --> 00:38:50,230
creating part to the MT 101 okay so what

865
00:38:50,230 --> 00:38:52,180
you're doing is you've got some evil

866
00:38:52,180 --> 00:38:54,540
piece of XML of which this is a

867
00:38:54,540 --> 00:38:58,000
butchered example anybody ever posted

868
00:38:58,000 --> 00:39:00,070
XML into Excel

869
00:39:00,070 --> 00:39:01,720
that's right into PowerPoint it's

870
00:39:01,720 --> 00:39:04,750
amazing Microsoft recognizes it as XML

871
00:39:04,750 --> 00:39:06,550
and then tries to interpret it which

872
00:39:06,550 --> 00:39:09,400
means that I actually had I eventually

873
00:39:09,400 --> 00:39:12,580
had to edit it somewhere else and then

874
00:39:12,580 --> 00:39:15,370
paste it in as a bit mad because it was

875
00:39:15,370 --> 00:39:18,690
just too much hassle to edit it in here

876
00:39:18,690 --> 00:39:21,940
anyway so you get the idea you're you're

877
00:39:21,940 --> 00:39:25,180
actually not playing with the rows in

878
00:39:25,180 --> 00:39:27,610
the database each time you do your

879
00:39:27,610 --> 00:39:29,560
signing and you're wrapping for each

880
00:39:29,560 --> 00:39:32,050
part of the process you're sending a

881
00:39:32,050 --> 00:39:34,510
blob of XML over it gets signed to get

882
00:39:34,510 --> 00:39:36,820
stored somewhere okay generally in the

883
00:39:36,820 --> 00:39:39,100
basically in the database but stored as

884
00:39:39,100 --> 00:39:43,540
XML so how does it work create person

885
00:39:43,540 --> 00:39:46,480
one goes to sign something it goes to

886
00:39:46,480 --> 00:39:50,110
request the payment details XML comes to

887
00:39:50,110 --> 00:39:52,840
here it gets signed and then it goes

888
00:39:52,840 --> 00:39:55,180
back with the first signature then

889
00:39:55,180 --> 00:39:57,490
second person does it at the XML with

890
00:39:57,490 --> 00:39:59,020
wrapped in the first signature comes

891
00:39:59,020 --> 00:40:01,360
over second signature gets attached boom

892
00:40:01,360 --> 00:40:04,270
boom boom and so on and finally the

893
00:40:04,270 --> 00:40:05,860
whole thing's done somebody goes to

894
00:40:05,860 --> 00:40:08,920
release it your XML blob with all three

895
00:40:08,920 --> 00:40:11,080
signatures goes over this thing then

896
00:40:11,080 --> 00:40:14,520
goes yep everything's fine by the way

897
00:40:14,520 --> 00:40:18,580
you should make sure you include some

898
00:40:18,580 --> 00:40:20,290
kind of two-factor authentication here

899
00:40:20,290 --> 00:40:22,780
so this thing needs to be able to talk

900
00:40:22,780 --> 00:40:26,410
to your in our case RSA server so it can

901
00:40:26,410 --> 00:40:28,330
verify that the to fracture

902
00:40:28,330 --> 00:40:30,570
authentication details that we

903
00:40:30,570 --> 00:40:33,900
along with the XML so embedded in the

904
00:40:33,900 --> 00:40:36,570
XML they get sent over are actually

905
00:40:36,570 --> 00:40:40,400
legitimate so this is the person who did

906
00:40:40,400 --> 00:40:43,140
create it they did sign it the other

907
00:40:43,140 --> 00:40:45,930
secure ID details match up so you know

908
00:40:45,930 --> 00:40:48,690
it really was them who created it it

909
00:40:48,690 --> 00:40:50,220
really was what they created

910
00:40:50,220 --> 00:40:51,840
delivered them all the way down the line

911
00:40:51,840 --> 00:40:55,500
so hey it might work database

912
00:40:55,500 --> 00:40:57,260
administrators can't modify the data

913
00:40:57,260 --> 00:40:59,700
files protected from the moment the

914
00:40:59,700 --> 00:41:01,730
first person puts in the payment request

915
00:41:01,730 --> 00:41:05,490
okay you can't just add yourself to one

916
00:41:05,490 --> 00:41:07,260
group you've got to add yourself to all

917
00:41:07,260 --> 00:41:12,180
sorts of others job done no because what

918
00:41:12,180 --> 00:41:17,310
have we forgotten if you route the the

919
00:41:17,310 --> 00:41:21,570
the highly secured and you needs to be

920
00:41:21,570 --> 00:41:22,740
highly secure but if you route the

921
00:41:22,740 --> 00:41:25,800
highly secured brokering service here

922
00:41:25,800 --> 00:41:29,840
you can obviously take all of this stuff

923
00:41:29,840 --> 00:41:34,920
submit a different MT 101 or intercept

924
00:41:34,920 --> 00:41:38,250
it on the way back and you know or if it

925
00:41:38,250 --> 00:41:46,440
goes to payment so yeah you need to you

926
00:41:46,440 --> 00:41:48,360
need to think about it a bit more so

927
00:41:48,360 --> 00:41:52,140
what do you do you don't create the MT

928
00:41:52,140 --> 00:41:56,070
101 send it over that XML okay well you

929
00:41:56,070 --> 00:41:57,390
do create the mq one-on-one but you

930
00:41:57,390 --> 00:41:59,730
don't send an MT 101 back there are

931
00:41:59,730 --> 00:42:02,250
various ways of doing it this is the way

932
00:42:02,250 --> 00:42:07,680
we chose what we chose to do is XML

933
00:42:07,680 --> 00:42:09,210
comes here this strips off all the

934
00:42:09,210 --> 00:42:12,420
signatures verifies the RSA as well as

935
00:42:12,420 --> 00:42:14,580
as in the two-factor authentication as

936
00:42:14,580 --> 00:42:16,620
well as the the actual cryptographic

937
00:42:16,620 --> 00:42:20,010
signatures creates the MT the MT one and

938
00:42:20,010 --> 00:42:23,250
once created and then it gets sent to

939
00:42:23,250 --> 00:42:26,070
the HSN the HSN signs it and then the

940
00:42:26,070 --> 00:42:29,640
signature not the MT wanna want but this

941
00:42:29,640 --> 00:42:31,560
signature is sent back to the payment

942
00:42:31,560 --> 00:42:33,690
application there is now some code on

943
00:42:33,690 --> 00:42:35,610
the payment application that dives into

944
00:42:35,610 --> 00:42:38,820
the database grabs back the XML which is

945
00:42:38,820 --> 00:42:41,660
all nicely signed

946
00:42:41,770 --> 00:42:45,220
creates unwraps it all creates the m2

947
00:42:45,220 --> 00:42:49,990
101 the signature is just sign against

948
00:42:49,990 --> 00:42:53,619
the public key ok so again you can you

949
00:42:53,619 --> 00:42:55,300
can you can verify the signature to

950
00:42:55,300 --> 00:42:56,440
strip it off and you would left with a

951
00:42:56,440 --> 00:42:59,109
hash if that hash is the same as the

952
00:42:59,109 --> 00:43:01,780
resultant hash from the signature that's

953
00:43:01,780 --> 00:43:04,240
sent back you know that the MT 1 and 1

954
00:43:04,240 --> 00:43:05,680
that you've just generated from your

955
00:43:05,680 --> 00:43:08,890
payment application is the same as the

956
00:43:08,890 --> 00:43:10,800
one that got signed over here

957
00:43:10,800 --> 00:43:16,990
so what do you do as per line wherever

958
00:43:16,990 --> 00:43:21,819
it is line 6 the application then takes

959
00:43:21,819 --> 00:43:23,619
the m2 one on one it's just generated

960
00:43:23,619 --> 00:43:25,240
which in noses the same as who on the

961
00:43:25,240 --> 00:43:28,059
goths and it takes the signature it's

962
00:43:28,059 --> 00:43:33,940
been sent by the hsm it takes recipients

963
00:43:33,940 --> 00:43:36,309
public key calls it all the GPG and then

964
00:43:36,309 --> 00:43:39,300
sends it off now you might be wondering

965
00:43:39,300 --> 00:43:41,859
work widely bothered why don't we just

966
00:43:41,859 --> 00:43:44,609
generate the MT 101 attach the cert

967
00:43:44,609 --> 00:43:47,650
sensory signature set it off and if they

968
00:43:47,650 --> 00:43:49,299
don't match because somebody's fiddle

969
00:43:49,299 --> 00:43:51,270
with it along the way does automatic as

970
00:43:51,270 --> 00:43:54,010
the signature won't match and Fidesz or

971
00:43:54,010 --> 00:43:55,510
swift or whoever it is will bounce it

972
00:43:55,510 --> 00:43:57,609
well we don't do that simply because

973
00:43:57,609 --> 00:44:00,790
we'd like to know about the fact that we

974
00:44:00,790 --> 00:44:03,250
have a problem just probably actually we

975
00:44:03,250 --> 00:44:04,660
screwed up the code rather than

976
00:44:04,660 --> 00:44:06,960
somebody's deferral trying to defraud us

977
00:44:06,960 --> 00:44:10,720
before we send it off to fillers so

978
00:44:10,720 --> 00:44:12,670
we're just doing that not as a security

979
00:44:12,670 --> 00:44:14,440
check but just as an application code

980
00:44:14,440 --> 00:44:19,690
check ok so there are some extra steps

981
00:44:19,690 --> 00:44:22,990
you can make so you'll notice that we

982
00:44:22,990 --> 00:44:25,329
haven't talked about bringing back the

983
00:44:25,329 --> 00:44:28,349
resultant statement for the MT and 940

984
00:44:28,349 --> 00:44:33,280
and unencrypted in that using the HSM

985
00:44:33,280 --> 00:44:37,660
infrastructure and then being absolutely

986
00:44:37,660 --> 00:44:39,730
certain that the statement far we get

987
00:44:39,730 --> 00:44:41,920
back hasn't had some kind of suppression

988
00:44:41,920 --> 00:44:43,990
done to it and as is then being up

989
00:44:43,990 --> 00:44:47,859
before it's uploaded we walked through a

990
00:44:47,859 --> 00:44:51,880
lot of scenarios where we ended up was

991
00:44:51,880 --> 00:44:55,150
um was concluding that as long as we act

992
00:44:55,150 --> 00:44:56,800
solutely certain end-to-end about the

993
00:44:56,800 --> 00:45:01,000
pavement file it's not really worth

994
00:45:01,000 --> 00:45:02,920
doing the same with the statement file

995
00:45:02,920 --> 00:45:08,890
on the way back it may be there are some

996
00:45:08,890 --> 00:45:10,690
circumstances you could potentially

997
00:45:10,690 --> 00:45:12,340
imagine with all sorts of inter you know

998
00:45:12,340 --> 00:45:14,760
with all sorts of internal collusion

999
00:45:14,760 --> 00:45:19,120
where somebody is also so internal

1000
00:45:19,120 --> 00:45:20,740
collusion that happens before the whole

1001
00:45:20,740 --> 00:45:23,080
process starts or alternatively during

1002
00:45:23,080 --> 00:45:25,000
the process people know that they're

1003
00:45:25,000 --> 00:45:28,660
approving of fraudulent request in which

1004
00:45:28,660 --> 00:45:31,720
case may be then suppressing it would be

1005
00:45:31,720 --> 00:45:34,000
useful but on the other hand the people

1006
00:45:34,000 --> 00:45:36,280
who are doing that probably have access

1007
00:45:36,280 --> 00:45:38,170
to the accounting system anyway at least

1008
00:45:38,170 --> 00:45:40,090
one of them does so they can suppress it

1009
00:45:40,090 --> 00:45:42,300
in the system okay through the

1010
00:45:42,300 --> 00:45:44,440
authentication details they have so I

1011
00:45:44,440 --> 00:45:46,750
don't think doing the same thing with

1012
00:45:46,750 --> 00:45:48,820
the statement farm buys you a lot but if

1013
00:45:48,820 --> 00:45:50,620
you want to argue about it I'm up for it

1014
00:45:50,620 --> 00:45:52,960
and we'll do it at the bar later so some

1015
00:45:52,960 --> 00:45:57,250
takeaways payments HAP's are everywhere

1016
00:45:57,250 --> 00:45:59,890
in all big organizations they handle

1017
00:45:59,890 --> 00:46:01,690
huge amounts of money and they're

1018
00:46:01,690 --> 00:46:03,820
generally secured leghorns

1019
00:46:03,820 --> 00:46:06,510
so why did I give us the crypto comedy

1020
00:46:06,510 --> 00:46:10,420
stuff earlier because it's funny but

1021
00:46:10,420 --> 00:46:13,090
seriously the people who genuinely work

1022
00:46:13,090 --> 00:46:14,380
on those backend systems do not

1023
00:46:14,380 --> 00:46:16,570
understand security that any melimeli

1024
00:46:16,570 --> 00:46:19,390
understand IT okay financial system

1025
00:46:19,390 --> 00:46:22,960
vendors SAP no you know Microsoft in a

1026
00:46:22,960 --> 00:46:24,790
vision dynamics you know all of these

1027
00:46:24,790 --> 00:46:28,780
people they know they're yup he's really

1028
00:46:28,780 --> 00:46:33,390
well but they do not seem to understand

1029
00:46:33,690 --> 00:46:36,670
how the backend systems should be

1030
00:46:36,670 --> 00:46:38,860
implemented and what to do about it

1031
00:46:38,860 --> 00:46:40,960
just let every payment application I've

1032
00:46:40,960 --> 00:46:43,330
ever come across has been vulnerable I

1033
00:46:43,330 --> 00:46:46,000
know I have friends who Penta who's

1034
00:46:46,000 --> 00:46:47,710
basically Penn tested every single

1035
00:46:47,710 --> 00:46:49,830
financial organization in the UK and

1036
00:46:49,830 --> 00:46:52,420
said that they've seen similar horror

1037
00:46:52,420 --> 00:46:54,130
stories during out throughout their

1038
00:46:54,130 --> 00:46:57,580
career so why don't we hear about thefts

1039
00:46:57,580 --> 00:47:00,640
well we've all heard rumors of this or

1040
00:47:00,640 --> 00:47:03,700
that okay but I mean nothing big nothing

1041
00:47:03,700 --> 00:47:06,640
that I've ever been able substantiate so

1042
00:47:06,640 --> 00:47:08,950
my feeling is is it's just because

1043
00:47:08,950 --> 00:47:10,720
this is an area that's just not well

1044
00:47:10,720 --> 00:47:12,460
enough understood by the people who

1045
00:47:12,460 --> 00:47:14,109
actually go after this kind of thing

1046
00:47:14,109 --> 00:47:15,059
seriously

1047
00:47:15,059 --> 00:47:17,829
so I don't know who we paranoid about

1048
00:47:17,829 --> 00:47:19,480
today is it Russian crime gangs or

1049
00:47:19,480 --> 00:47:22,089
whatever I don't know but whoever it is

1050
00:47:22,089 --> 00:47:23,499
were paranoid about today doesn't

1051
00:47:23,499 --> 00:47:25,180
understand this area well enough but

1052
00:47:25,180 --> 00:47:29,859
they will okay um so those of you who

1053
00:47:29,859 --> 00:47:34,150
work for a bank or do consulting go from

1054
00:47:34,150 --> 00:47:38,170
looking for this and fix it okay it's a

1055
00:47:38,170 --> 00:47:39,970
bit of an interesting that problem to

1056
00:47:39,970 --> 00:47:45,549
solve and my other bet pet bugbear my

1057
00:47:45,549 --> 00:47:48,730
apologies for the minor rant anybody in

1058
00:47:48,730 --> 00:47:50,079
the security industry who says they

1059
00:47:50,079 --> 00:47:51,940
can't get budget to do things I do I

1060
00:47:51,940 --> 00:47:54,279
just don't understand you cannot get

1061
00:47:54,279 --> 00:47:55,599
budget to do things it's because you're

1062
00:47:55,599 --> 00:47:58,589
fixing the wrong problem okay this is an

1063
00:47:58,589 --> 00:48:00,460
absolute business problem it's about

1064
00:48:00,460 --> 00:48:01,930
peer now it's about money it's about

1065
00:48:01,930 --> 00:48:04,779
fraud okay it's a problem that needs to

1066
00:48:04,779 --> 00:48:08,190
be fixed and if you can't sell this then

1067
00:48:08,190 --> 00:48:11,289
well you're either working for a very

1068
00:48:11,289 --> 00:48:13,089
strange organization or the very strange

1069
00:48:13,089 --> 00:48:16,690
priorities all the problems not with the

1070
00:48:16,690 --> 00:48:19,180
problem is not with the organization so

1071
00:48:19,180 --> 00:48:23,680
that said we have ten minutes left maybe

1072
00:48:23,680 --> 00:48:26,349
my watch is a mechanical Swiss watch

1073
00:48:26,349 --> 00:48:27,670
which means it's completely inaccurate

1074
00:48:27,670 --> 00:48:30,759
so with whatever time we've got left

1075
00:48:30,759 --> 00:48:34,109
do I have any questions

1076
00:48:41,380 --> 00:48:44,320
I am not aware of any solution of the

1077
00:48:44,320 --> 00:48:47,130
chef that does this

1078
00:48:58,089 --> 00:49:00,680
they I think the problem is is all

1079
00:49:00,680 --> 00:49:03,849
back-end systems generally a legacy to

1080
00:49:03,849 --> 00:49:08,480
some extent or other so you can buy

1081
00:49:08,480 --> 00:49:11,000
standard components like the HSMs

1082
00:49:11,000 --> 00:49:14,000
okay but it's then a case of writing

1083
00:49:14,000 --> 00:49:18,740
code to glue it all together you're

1084
00:49:18,740 --> 00:49:21,789
gonna have to put code on your payment

1085
00:49:21,789 --> 00:49:26,240
payment on your payment gateway and all

1086
00:49:26,240 --> 00:49:28,460
your ERP which is often the same thing

1087
00:49:28,460 --> 00:49:30,230
you're gonna have to have code there so

1088
00:49:30,230 --> 00:49:31,940
maybe you can have some standard

1089
00:49:31,940 --> 00:49:34,940
libraries but the other problem of

1090
00:49:34,940 --> 00:49:36,950
course as I said is depending on which

1091
00:49:36,950 --> 00:49:38,690
bank you're dealing with in which which

1092
00:49:38,690 --> 00:49:42,470
Bureau the EFT or even the MT one and

1093
00:49:42,470 --> 00:49:44,089
one will not be standard they'll all be

1094
00:49:44,089 --> 00:49:45,740
different so you'll have a whole load of

1095
00:49:45,740 --> 00:49:47,960
configuration and changes you're going

1096
00:49:47,960 --> 00:49:52,160
to need to do so it's not a plug it in

1097
00:49:52,160 --> 00:49:55,819
and and go away solution there's you

1098
00:49:55,819 --> 00:49:58,760
could probably package up something and

1099
00:49:58,760 --> 00:50:02,420
best practice yes but the DRA you know

1100
00:50:02,420 --> 00:50:05,359
just drop it in into works.i I don't

1101
00:50:05,359 --> 00:50:07,779
think so

1102
00:50:11,070 --> 00:50:14,070
I'm not sure if anybody's many people

1103
00:50:14,070 --> 00:50:16,410
are building it from scratch I don't

1104
00:50:16,410 --> 00:50:17,880
think many people are I think many

1105
00:50:17,880 --> 00:50:19,770
people are just ignoring the problem

1106
00:50:19,770 --> 00:50:22,970
because they don't know that it's there

1107
00:50:28,520 --> 00:50:31,530
you could you could undoubtedly create a

1108
00:50:31,530 --> 00:50:34,140
best practice guide around it there are

1109
00:50:34,140 --> 00:50:36,000
best practice guides out around it right

1110
00:50:36,000 --> 00:50:38,460
now but it's they say useless things

1111
00:50:38,460 --> 00:50:41,040
like you know secured shared area should

1112
00:50:41,040 --> 00:50:44,960
be you know secured that kind of thing

1113
00:50:48,170 --> 00:50:51,440
which one

1114
00:50:55,670 --> 00:51:05,839
this one yes yes

1115
00:51:32,270 --> 00:51:36,780
that that that's fine you just need to

1116
00:51:36,780 --> 00:51:38,789
make sure that your payment out or

1117
00:51:38,789 --> 00:51:41,010
you're up here whatever it is has some

1118
00:51:41,010 --> 00:51:43,440
code in it that makes sure that even if

1119
00:51:43,440 --> 00:51:45,329
exactly the same people are in the

1120
00:51:45,329 --> 00:51:47,069
Creator approve of the finalize a group

1121
00:51:47,069 --> 00:51:51,000
that whoever is going through process

1122
00:51:51,000 --> 00:51:52,349
you know going through this process

1123
00:51:52,349 --> 00:51:55,500
you've got a minimum of two different

1124
00:51:55,500 --> 00:51:57,510
people for each of the four those three

1125
00:51:57,510 --> 00:52:02,609
steps which is it this is a common thing

1126
00:52:02,609 --> 00:52:04,530
because if you've got a small branch

1127
00:52:04,530 --> 00:52:07,619
office in and a Lou Amdur or something

1128
00:52:07,619 --> 00:52:10,170
then you're not going to have many

1129
00:52:10,170 --> 00:52:11,760
people who work in the accountancy side

1130
00:52:11,760 --> 00:52:14,160
so you will have one or two people so

1131
00:52:14,160 --> 00:52:16,740
again that that's why you just need to

1132
00:52:16,740 --> 00:52:18,839
build in that differentiation logic

1133
00:52:18,839 --> 00:52:21,000
there rather than having all of these

1134
00:52:21,000 --> 00:52:22,710
people in this group and they can never

1135
00:52:22,710 --> 00:52:24,450
be in the other groups because as you

1136
00:52:24,450 --> 00:52:27,078
say that won't work

1137
00:52:44,220 --> 00:52:46,140
yeah if you don't have your mover

1138
00:52:46,140 --> 00:52:48,390
process sorted out then they're going to

1139
00:52:48,390 --> 00:52:50,880
bring the bring their you know their

1140
00:52:50,880 --> 00:52:57,410
rights with them any other questions yes

1141
00:53:00,829 --> 00:53:04,500
well you've effectively well you need

1142
00:53:04,500 --> 00:53:08,010
one for for your what RSA wherever

1143
00:53:08,010 --> 00:53:10,380
that's gone you need one for obviously

1144
00:53:10,380 --> 00:53:12,980
for RSA

1145
00:53:30,200 --> 00:53:32,599
so I'm not sure I felt like probably

1146
00:53:32,599 --> 00:53:34,070
because I didn't hear said could you say

1147
00:53:34,070 --> 00:53:41,859
that again yeah

1148
00:53:51,390 --> 00:53:55,109
um I don't know I'm not not having

1149
00:53:55,109 --> 00:53:57,660
thought about it in great detail I'd say

1150
00:53:57,660 --> 00:54:00,270
probably not because as long as the HSM

1151
00:54:00,270 --> 00:54:02,309
has signed it you know that it's seen

1152
00:54:02,309 --> 00:54:05,150
and signed it at exactly what time

1153
00:54:05,150 --> 00:54:08,670
you're probably less worried about on

1154
00:54:08,670 --> 00:54:11,130
the but that's assuming you're signing

1155
00:54:11,130 --> 00:54:13,799
with an HSM so you know that the the

1156
00:54:13,799 --> 00:54:15,960
private key is well introduced cured if

1157
00:54:15,960 --> 00:54:18,059
you haven't well in truly secure that

1158
00:54:18,059 --> 00:54:19,440
private key because you're too cheap to

1159
00:54:19,440 --> 00:54:21,510
buy an HSM there's something like that

1160
00:54:21,510 --> 00:54:41,609
is probably useful sorry just to just

1161
00:54:41,609 --> 00:54:43,410
repeat the question um

1162
00:54:43,410 --> 00:54:47,880
oh they get here cloud player have a

1163
00:54:47,880 --> 00:54:50,250
project called Red October and that's

1164
00:54:50,250 --> 00:54:52,079
for key delegation you need two or more

1165
00:54:52,079 --> 00:54:54,270
Sunny's sign-off encryption and

1166
00:54:54,270 --> 00:54:56,069
decryption sounds like something you

1167
00:54:56,069 --> 00:54:57,240
might be able to repurpose for the

1168
00:54:57,240 --> 00:55:00,359
crypto web service potentially remember

1169
00:55:00,359 --> 00:55:02,460
the quick crypto web services more than

1170
00:55:02,460 --> 00:55:04,470
just about associating keys with users

1171
00:55:04,470 --> 00:55:07,680
it's also about being part of the

1172
00:55:07,680 --> 00:55:13,289
process of of stripping and creating MT

1173
00:55:13,289 --> 00:55:16,380
101 in order to then send the MA HSM to

1174
00:55:16,380 --> 00:55:19,170
sign because the HSM is you can't fiddle

1175
00:55:19,170 --> 00:55:20,730
with the code there in order to get it

1176
00:55:20,730 --> 00:55:23,579
to to do any interpretation or munching

1177
00:55:23,579 --> 00:55:27,089
of an empty of data into this XML or

1178
00:55:27,089 --> 00:55:29,910
whatever into an MT 101 so something has

1179
00:55:29,910 --> 00:55:32,430
to do that but clearly it can't be a

1180
00:55:32,430 --> 00:55:34,589
payment gateway cause otherwise what the

1181
00:55:34,589 --> 00:55:37,069
hell's the point

1182
00:55:38,970 --> 00:55:44,980
any other questions thank you for being

1183
00:55:44,980 --> 00:55:46,720
an active audience and I will

1184
00:55:46,720 --> 00:55:49,120
undoubtedly see some of you around thank

1185
00:55:49,120 --> 00:55:49,280
you

1186
00:55:49,280 --> 00:55:55,209
[Applause]

