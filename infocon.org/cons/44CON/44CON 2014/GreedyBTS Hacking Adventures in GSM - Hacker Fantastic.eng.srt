1
00:00:00,089 --> 00:00:02,129
thank you for for coming to my talk this

2
00:00:02,129 --> 00:00:05,250
is greedy BTS which is some adventures

3
00:00:05,250 --> 00:00:10,080
in GSM hacking so yeah just quickly and

4
00:00:10,080 --> 00:00:11,840
start off by running through the agenda

5
00:00:11,840 --> 00:00:13,679
first of all should give an introduction

6
00:00:13,679 --> 00:00:17,820
to Who I am and then we'll go through an

7
00:00:17,820 --> 00:00:21,060
overview of 2.5 G mobile environments

8
00:00:21,060 --> 00:00:24,210
will discuss cellular diagnostics and

9
00:00:24,210 --> 00:00:27,359
tools we'll also cover security

10
00:00:27,359 --> 00:00:30,449
weaknesses within GSM and then we're

11
00:00:30,449 --> 00:00:32,219
also going to look at how to build an

12
00:00:32,219 --> 00:00:34,980
open-source 2.5 g simulation environment

13
00:00:34,980 --> 00:00:37,920
for doing technical analysis in and then

14
00:00:37,920 --> 00:00:39,239
we're going to look at how we can use

15
00:00:39,239 --> 00:00:41,190
that environment to implement attacks

16
00:00:41,190 --> 00:00:44,879
against gsm environments and then we'll

17
00:00:44,879 --> 00:00:47,489
do a demonstration of an attack tool

18
00:00:47,489 --> 00:00:49,710
greedy BTS which i've created for the

19
00:00:49,710 --> 00:00:53,300
purposes of targeting 2.5 g environments

20
00:00:53,300 --> 00:00:55,800
so my background is as a penetration

21
00:00:55,800 --> 00:00:57,300
tester i've been a penetration tester

22
00:00:57,300 --> 00:00:59,719
for around the last sort of ten years

23
00:00:59,719 --> 00:01:02,370
and I've been avidly researching

24
00:01:02,370 --> 00:01:05,459
computer security topics and have

25
00:01:05,459 --> 00:01:06,810
published a number of exploits and

26
00:01:06,810 --> 00:01:08,820
vulnerabilities and I've got a strong

27
00:01:08,820 --> 00:01:11,689
interest in radio and embedded systems

28
00:01:11,689 --> 00:01:14,850
so first of all I'd like to give a bit

29
00:01:14,850 --> 00:01:18,299
of an overview of GSM and what it is

30
00:01:18,299 --> 00:01:19,590
from a technical perspective so this

31
00:01:19,590 --> 00:01:21,570
because a little bit in depth and

32
00:01:21,570 --> 00:01:23,729
technical but it's necessary background

33
00:01:23,729 --> 00:01:26,189
understanding to realize how the attack

34
00:01:26,189 --> 00:01:29,040
tools do what they do so it was

35
00:01:29,040 --> 00:01:32,549
introduced in June 2008 and I know sorry

36
00:01:32,549 --> 00:01:34,590
on June 2008 there was around 2.9

37
00:01:34,590 --> 00:01:37,020
billion subscribers who were using GSM

38
00:01:37,020 --> 00:01:39,930
and it replaced the total access

39
00:01:39,930 --> 00:01:42,210
communication system in the UK which was

40
00:01:42,210 --> 00:01:45,600
the older legacy analog environment

41
00:01:45,600 --> 00:01:47,340
which was vulnerable to snarfing where

42
00:01:47,340 --> 00:01:49,439
people would take ES ends and mins and

43
00:01:49,439 --> 00:01:52,110
reprogram them into phones for cloning

44
00:01:52,110 --> 00:01:53,119
users bills

45
00:01:53,119 --> 00:01:55,649
so it's a european-wide standard which

46
00:01:55,649 --> 00:01:57,780
was started in 1982 by a group special

47
00:01:57,780 --> 00:02:00,630
mobile and that has security features in

48
00:02:00,630 --> 00:02:03,509
it that were introduced to prevent

49
00:02:03,509 --> 00:02:04,830
you know the losses that they were

50
00:02:04,830 --> 00:02:06,990
sustaining on the mobile phone companies

51
00:02:06,990 --> 00:02:11,430
due to wide range of fraud GPRS was

52
00:02:11,430 --> 00:02:13,380
created to work within the GSM standards

53
00:02:13,380 --> 00:02:16,580
and addressed the data needs for the

54
00:02:16,580 --> 00:02:19,530
always-on connectivity which had a high

55
00:02:19,530 --> 00:02:22,620
price of constantly dialing up over the

56
00:02:22,620 --> 00:02:24,810
existing GSM standard and that's how you

57
00:02:24,810 --> 00:02:28,980
got the 2.5 g environment UMTS and LTE

58
00:02:28,980 --> 00:02:30,569
our third and fourth generation networks

59
00:02:30,569 --> 00:02:33,569
which were now widely on the air and we

60
00:02:33,569 --> 00:02:36,030
still have 2.5 g within those

61
00:02:36,030 --> 00:02:38,190
environments for legacy purposes and as

62
00:02:38,190 --> 00:02:38,760
fallbacks

63
00:02:38,760 --> 00:02:41,910
so I wondered how vulnerable 2.5 g

64
00:02:41,910 --> 00:02:43,620
networks and GSM communications are

65
00:02:43,620 --> 00:02:47,810
today so this is an overview of the 2g

66
00:02:47,810 --> 00:02:51,120
GSM architecture we can see here that

67
00:02:51,120 --> 00:02:54,720
the mobile station or Mei is your mobile

68
00:02:54,720 --> 00:02:57,299
phone and an ID consists of the mobile

69
00:02:57,299 --> 00:02:59,940
equipment and the SIM card and then this

70
00:02:59,940 --> 00:03:02,850
is the link to the BSS which provides

71
00:03:02,850 --> 00:03:04,620
the air interface between the network

72
00:03:04,620 --> 00:03:07,080
and the phone and that's the base

73
00:03:07,080 --> 00:03:09,090
station subsystem which comprises of the

74
00:03:09,090 --> 00:03:10,350
base station controller and base

75
00:03:10,350 --> 00:03:12,510
transceiver system there is the network

76
00:03:12,510 --> 00:03:14,100
switching subsystem which provides

77
00:03:14,100 --> 00:03:16,590
authentication identity billing and more

78
00:03:16,590 --> 00:03:19,530
and that's basically what a 2g

79
00:03:19,530 --> 00:03:23,489
environment looks like by itself and so

80
00:03:23,489 --> 00:03:26,070
a mobile station which is your your

81
00:03:26,070 --> 00:03:28,560
typical cell phone it has an

82
00:03:28,560 --> 00:03:30,540
international mobile station Equipment

83
00:03:30,540 --> 00:03:33,930
Identity otherwise known as an IMEI and

84
00:03:33,930 --> 00:03:35,579
that contains uniquely identifiable

85
00:03:35,579 --> 00:03:38,790
information on your device you also have

86
00:03:38,790 --> 00:03:40,019
a sim card which contains your

87
00:03:40,019 --> 00:03:42,690
subscriber information your sims card

88
00:03:42,690 --> 00:03:44,400
contains what's known as an mg or

89
00:03:44,400 --> 00:03:46,549
international mobile subscriber identity

90
00:03:46,549 --> 00:03:49,200
and this starts with a mobile country

91
00:03:49,200 --> 00:03:51,209
code which is three digits a mobile

92
00:03:51,209 --> 00:03:52,829
network code which is two digits and

93
00:03:52,829 --> 00:03:54,660
then your mobile subscriber identity

94
00:03:54,660 --> 00:03:56,670
it's an identification number which can

95
00:03:56,670 --> 00:03:58,650
be up to ten digits and is otherwise

96
00:03:58,650 --> 00:04:01,049
known as an MS in the SIM card also

97
00:04:01,049 --> 00:04:03,600
holds encryption keys which are used for

98
00:04:03,600 --> 00:04:06,359
air encryption and authentication and

99
00:04:06,359 --> 00:04:08,010
the phone itself contains a baseband

100
00:04:08,010 --> 00:04:10,260
processor and real-time operating system

101
00:04:10,260 --> 00:04:13,140
and for use by GSM and it's essentially

102
00:04:13,140 --> 00:04:17,760
just a radio device so the SIM card what

103
00:04:17,760 --> 00:04:19,320
is the SIM card basically the SIM card

104
00:04:19,320 --> 00:04:23,220
is described in gsm xi dot 14 and it's

105
00:04:23,220 --> 00:04:24,780
known as the subscriber identity module

106
00:04:24,780 --> 00:04:28,530
which stores both the MZ and ki KI the

107
00:04:28,530 --> 00:04:29,970
ki key is needed for network

108
00:04:29,970 --> 00:04:32,220
authentication and also air encryption

109
00:04:32,220 --> 00:04:35,010
you can get programmable cards which can

110
00:04:35,010 --> 00:04:37,680
be used with a writable ki key or you

111
00:04:37,680 --> 00:04:39,599
can buy GSM test cards with a writable

112
00:04:39,599 --> 00:04:42,240
ki key and for being able to write that

113
00:04:42,240 --> 00:04:43,950
ki KI value in if you want to do

114
00:04:43,950 --> 00:04:46,470
authentication and this diagram here

115
00:04:46,470 --> 00:04:49,020
shows how you can actually use a pic

116
00:04:49,020 --> 00:04:52,710
microcontroller and implement a SIM card

117
00:04:52,710 --> 00:04:55,650
for GSM purposes on top of the picture

118
00:04:55,650 --> 00:04:59,490
so that basically this comes down to iso

119
00:04:59,490 --> 00:05:01,020
seven eight one six which defines the

120
00:05:01,020 --> 00:05:03,690
physical smart card standard it then

121
00:05:03,690 --> 00:05:06,000
implements a sim toolkit or somatic

122
00:05:06,000 --> 00:05:08,310
asian toolkit which is implemented by

123
00:05:08,310 --> 00:05:11,610
the smart card the gsm application which

124
00:05:11,610 --> 00:05:13,800
sits on top of that is what implements

125
00:05:13,800 --> 00:05:17,580
the authentication apd use and so some

126
00:05:17,580 --> 00:05:19,590
known weaknesses within smart cards was

127
00:05:19,590 --> 00:05:21,720
comp one to eight version one which was

128
00:05:21,720 --> 00:05:24,690
an encryption algorithm that was found

129
00:05:24,690 --> 00:05:27,090
to be flawed and essentially that was

130
00:05:27,090 --> 00:05:28,800
because of a stop condition that allowed

131
00:05:28,800 --> 00:05:30,960
for the brute-force attack to be

132
00:05:30,960 --> 00:05:33,390
leveraged against the SIM card to

133
00:05:33,390 --> 00:05:35,610
disclose the ki key over a period of

134
00:05:35,610 --> 00:05:38,370
time that can take a 12 to 24 hour

135
00:05:38,370 --> 00:05:40,740
period and requires physical access to

136
00:05:40,740 --> 00:05:43,409
the SIM card and now it's been replaced

137
00:05:43,409 --> 00:05:45,780
by comp one to eight version three which

138
00:05:45,780 --> 00:05:48,240
is much more widely used and the comp 1

139
00:05:48,240 --> 00:05:51,060
to 8 version one is fairly rare and you

140
00:05:51,060 --> 00:05:52,710
can find chinese vendors who will sell

141
00:05:52,710 --> 00:05:55,680
the cheap comp 1 to 8 version one multi

142
00:05:55,680 --> 00:05:57,870
sim card cards and cloners which are

143
00:05:57,870 --> 00:06:00,030
essentially made for making a backup of

144
00:06:00,030 --> 00:06:02,219
your sim card and there's also the Osmo

145
00:06:02,219 --> 00:06:04,620
comm sim trace utility which is worth a

146
00:06:04,620 --> 00:06:06,539
mention because you can essentially

147
00:06:06,539 --> 00:06:08,820
man-in-the-middle and trace the apdu

148
00:06:08,820 --> 00:06:10,740
activity between a handset and a SIM

149
00:06:10,740 --> 00:06:14,219
card and the tht have also have a sim

150
00:06:14,219 --> 00:06:16,409
toolkit research group that contains a

151
00:06:16,409 --> 00:06:18,330
lot more information on SIM cards and

152
00:06:18,330 --> 00:06:20,320
SIM card vulnerabilities

153
00:06:20,320 --> 00:06:22,520
this talks not really about that it's

154
00:06:22,520 --> 00:06:25,190
more about the base transceiver system

155
00:06:25,190 --> 00:06:28,850
or BTS so it's more looking at the

156
00:06:28,850 --> 00:06:30,620
transmitter and receiver equipment such

157
00:06:30,620 --> 00:06:33,530
as the antennas and amplifiers a BTS has

158
00:06:33,530 --> 00:06:35,900
components for doing DSP and digital

159
00:06:35,900 --> 00:06:38,090
signal processing it contains functions

160
00:06:38,090 --> 00:06:40,420
for radio resource management and

161
00:06:40,420 --> 00:06:44,000
provides the air or um interface to AMS

162
00:06:44,000 --> 00:06:46,310
or mobile phone and this is part of a

163
00:06:46,310 --> 00:06:48,500
typical cell tower that's used by GSM

164
00:06:48,500 --> 00:06:51,110
environments and the BTS provides the

165
00:06:51,110 --> 00:06:53,120
radio signaling between the network and

166
00:06:53,120 --> 00:06:55,220
the phone inside the base station

167
00:06:55,220 --> 00:06:56,450
subsystem there is an additional

168
00:06:56,450 --> 00:06:57,860
component which is the base station

169
00:06:57,860 --> 00:06:59,900
controller and which provides your logic

170
00:06:59,900 --> 00:07:02,000
and intelligence for actually

171
00:07:02,000 --> 00:07:05,320
implementing the gsm communications so

172
00:07:05,320 --> 00:07:08,590
radio and cellular so basically the GSM

173
00:07:08,590 --> 00:07:10,900
spectrum has a chunk of the

174
00:07:10,900 --> 00:07:12,710
electromagnetic spectrum and it's

175
00:07:12,710 --> 00:07:14,810
divided up into uplink and downlink

176
00:07:14,810 --> 00:07:16,850
channels and this table here actually

177
00:07:16,850 --> 00:07:18,890
shows you the different bands that are

178
00:07:18,890 --> 00:07:22,360
assigned for 2g GSM use and then the

179
00:07:22,360 --> 00:07:25,730
arfcn is the absolute radio frequency

180
00:07:25,730 --> 00:07:28,010
channel number and the way that works is

181
00:07:28,010 --> 00:07:30,260
essentially the the spectrum is divided

182
00:07:30,260 --> 00:07:32,120
up into channels and these channels are

183
00:07:32,120 --> 00:07:34,960
assigned a unique number that the GSM

184
00:07:34,960 --> 00:07:38,810
can use and the cellular networking is

185
00:07:38,810 --> 00:07:41,210
used by different spatial areas or space

186
00:07:41,210 --> 00:07:43,610
space division multiple access and this

187
00:07:43,610 --> 00:07:45,740
essentially allows us to use one

188
00:07:45,740 --> 00:07:47,840
frequency in one area and then use a

189
00:07:47,840 --> 00:07:49,280
different frequency in another area and

190
00:07:49,280 --> 00:07:51,230
then reuse the same frequency elsewhere

191
00:07:51,230 --> 00:07:53,780
by dividing the the environment up into

192
00:07:53,780 --> 00:07:57,620
different spaces at the physical layer

193
00:07:57,620 --> 00:08:01,220
the physical layer zero you actually

194
00:08:01,220 --> 00:08:03,680
have this layer one story you actually

195
00:08:03,680 --> 00:08:06,560
have this waterfall views of what I

196
00:08:06,560 --> 00:08:08,990
absolutely do frequency channel air FCN

197
00:08:08,990 --> 00:08:11,540
looks like so on the left hand side here

198
00:08:11,540 --> 00:08:14,060
this is what a GSM downlink looks like

199
00:08:14,060 --> 00:08:17,960
and on the right we have a GSM uplink

200
00:08:17,960 --> 00:08:20,840
and this is divided up into two hundred

201
00:08:20,840 --> 00:08:23,330
kilohertz channels which is then split

202
00:08:23,330 --> 00:08:26,150
into time division multiple access slots

203
00:08:26,150 --> 00:08:27,680
so you have time slots within these

204
00:08:27,680 --> 00:08:29,420
channels that are assigned resources and

205
00:08:29,420 --> 00:08:31,460
there are different bursts which they

206
00:08:31,460 --> 00:08:32,260
then Inc

207
00:08:32,260 --> 00:08:35,409
within or modulated within this this

208
00:08:35,409 --> 00:08:41,080
this this this this radio space so GSM

209
00:08:41,080 --> 00:08:43,179
communicates as I mentioned with time

210
00:08:43,179 --> 00:08:45,100
division multiple access or frequency

211
00:08:45,100 --> 00:08:47,020
division multiple access which is TDMA

212
00:08:47,020 --> 00:08:49,780
and FDMA principals this here we shows

213
00:08:49,780 --> 00:08:52,120
the spatial division multiple access

214
00:08:52,120 --> 00:08:54,460
that's being used to give this you can

215
00:08:54,460 --> 00:08:56,110
use one frequency in one area and then

216
00:08:56,110 --> 00:08:57,430
we can see that we can reuse it in

217
00:08:57,430 --> 00:09:00,040
another area by dividing up the space

218
00:09:00,040 --> 00:09:02,830
used for the frequency the traffic is

219
00:09:02,830 --> 00:09:05,020
transmitted as bursts and the modulation

220
00:09:05,020 --> 00:09:06,960
is using gaussian minimum shift keying

221
00:09:06,960 --> 00:09:08,980
gaussian minimum shift keying is a

222
00:09:08,980 --> 00:09:10,990
variant of frequency shift keying which

223
00:09:10,990 --> 00:09:12,610
has been designed to reduce the

224
00:09:12,610 --> 00:09:15,610
bandwidth and that's required and so it

225
00:09:15,610 --> 00:09:17,020
dies then known as minimum shift keying

226
00:09:17,020 --> 00:09:18,640
and then it's applied with a Gorge and

227
00:09:18,640 --> 00:09:20,580
bandpass to further optimize it for

228
00:09:20,580 --> 00:09:27,010
spatial use so the actual network

229
00:09:27,010 --> 00:09:29,770
switching subsystem which is the the

230
00:09:29,770 --> 00:09:32,020
more of the back-end environment and we

231
00:09:32,020 --> 00:09:34,330
have the the network components that are

232
00:09:34,330 --> 00:09:36,040
usually not accessible or visible to an

233
00:09:36,040 --> 00:09:37,420
attacker they are the mobile switching

234
00:09:37,420 --> 00:09:40,240
center or MSC the home locality register

235
00:09:40,240 --> 00:09:42,190
and visitor locality register which can

236
00:09:42,190 --> 00:09:44,260
be looked at as forms of databases and

237
00:09:44,260 --> 00:09:46,690
the equipment identity registrar a IR

238
00:09:46,690 --> 00:09:49,780
and so these handle information on the

239
00:09:49,780 --> 00:09:52,420
subscriber and they hold things like the

240
00:09:52,420 --> 00:09:55,060
MZ values encryption keys and then

241
00:09:55,060 --> 00:09:56,710
back-end processes will do things like

242
00:09:56,710 --> 00:09:59,980
billing and charging for against a user

243
00:09:59,980 --> 00:10:02,620
who's placing calls it's also where the

244
00:10:02,620 --> 00:10:04,210
call switching and routing takes place

245
00:10:04,210 --> 00:10:05,920
when you're connecting to other networks

246
00:10:05,920 --> 00:10:08,380
so for instance connecting to a packets

247
00:10:08,380 --> 00:10:10,750
a public switch telephone network would

248
00:10:10,750 --> 00:10:12,610
all be performed in the network

249
00:10:12,610 --> 00:10:17,290
switching subsystem GSM is divided into

250
00:10:17,290 --> 00:10:19,030
what's known as logical channels to

251
00:10:19,030 --> 00:10:20,440
allow for signaling between the handset

252
00:10:20,440 --> 00:10:22,300
and network and there's a defined

253
00:10:22,300 --> 00:10:24,010
traffic channel which has full rate and

254
00:10:24,010 --> 00:10:26,290
half rate channels available as traffic

255
00:10:26,290 --> 00:10:29,290
control channels be full rate and half

256
00:10:29,290 --> 00:10:31,620
rate or BM and LM and there are also

257
00:10:31,620 --> 00:10:34,810
signaling channels known as DM and a lot

258
00:10:34,810 --> 00:10:35,980
of the weaknesses that have been found

259
00:10:35,980 --> 00:10:38,080
in GSM today are due to this problem of

260
00:10:38,080 --> 00:10:40,480
in-band signaling which is essentially

261
00:10:40,480 --> 00:10:41,620
the mobile station and the base

262
00:10:41,620 --> 00:10:43,520
transceiver station a signaling

263
00:10:43,520 --> 00:10:46,550
within it within the same channels that

264
00:10:46,550 --> 00:10:49,070
they're using to sort of manage so there

265
00:10:49,070 --> 00:10:50,420
they're divided up logically into

266
00:10:50,420 --> 00:10:51,200
different channels but they're

267
00:10:51,200 --> 00:10:53,870
accessible to the mobile phone and it's

268
00:10:53,870 --> 00:10:55,339
this same class of vulnerability that

269
00:10:55,339 --> 00:10:57,110
allowed freako blue boxes to function

270
00:10:57,110 --> 00:10:59,000
and has been responsible for format

271
00:10:59,000 --> 00:11:01,790
string attacks and it's also basically

272
00:11:01,790 --> 00:11:04,010
when management capability is accessible

273
00:11:04,010 --> 00:11:06,410
it's got the potential for subvert um so

274
00:11:06,410 --> 00:11:07,730
anywhere where you can get access to

275
00:11:07,730 --> 00:11:09,200
management information if you've got a

276
00:11:09,200 --> 00:11:12,950
potential to exploit it so the various

277
00:11:12,950 --> 00:11:15,020
channel logical channels that are

278
00:11:15,020 --> 00:11:16,910
created we have the broadcast channel

279
00:11:16,910 --> 00:11:18,680
now the broadcast channel is used by a

280
00:11:18,680 --> 00:11:20,600
mobile stations who synchronize the

281
00:11:20,600 --> 00:11:22,430
oscillator and frequency with the base

282
00:11:22,430 --> 00:11:24,170
transceiver system so that they're able

283
00:11:24,170 --> 00:11:26,480
to communicate more accurately and

284
00:11:26,480 --> 00:11:29,000
encode information and speak to each

285
00:11:29,000 --> 00:11:31,880
other the BCH consists of sub channels

286
00:11:31,880 --> 00:11:33,260
that assist with that process which

287
00:11:33,260 --> 00:11:34,910
includes the broadcast channel the

288
00:11:34,910 --> 00:11:36,410
frequency correction Channel and the

289
00:11:36,410 --> 00:11:38,750
synchronization channels the channels

290
00:11:38,750 --> 00:11:40,670
are used during the preliminary station

291
00:11:40,670 --> 00:11:43,010
of a mobile station being powered on and

292
00:11:43,010 --> 00:11:44,540
they're integral power of what we would

293
00:11:44,540 --> 00:11:47,540
all refer to as getting a signal so

294
00:11:47,540 --> 00:11:49,640
there's also the common control channel

295
00:11:49,640 --> 00:11:50,990
the common control channel is used by a

296
00:11:50,990 --> 00:11:52,880
mobile station and BTS for communicating

297
00:11:52,880 --> 00:11:55,160
requests and resources and it's

298
00:11:55,160 --> 00:11:57,410
essentially used for making a request to

299
00:11:57,410 --> 00:11:59,330
say I want to make a phone call so it

300
00:11:59,330 --> 00:12:00,950
makes a random access channel request

301
00:12:00,950 --> 00:12:02,390
and then there's the access grant

302
00:12:02,390 --> 00:12:03,650
channel or paging channel and

303
00:12:03,650 --> 00:12:05,290
notification channel and it's used for

304
00:12:05,290 --> 00:12:08,450
notifying the mobile station and asking

305
00:12:08,450 --> 00:12:10,610
and requesting for resources and there

306
00:12:10,610 --> 00:12:12,560
is also the temporary mobile subscriber

307
00:12:12,560 --> 00:12:14,180
identity which is used to help prevent

308
00:12:14,180 --> 00:12:16,850
the tracking of a GSM user and that can

309
00:12:16,850 --> 00:12:18,709
be frequently changed by the mobile they

310
00:12:18,709 --> 00:12:20,810
buy the BTS and usually has a

311
00:12:20,810 --> 00:12:22,400
configurable lifetime so it's assigned

312
00:12:22,400 --> 00:12:23,720
to you and eventually will expire and

313
00:12:23,720 --> 00:12:26,630
you'll be given a new one there is the

314
00:12:26,630 --> 00:12:29,540
dedicated control channels the DC CH and

315
00:12:29,540 --> 00:12:31,190
its associated sub channel which is used

316
00:12:31,190 --> 00:12:33,589
for authentication cipher selection and

317
00:12:33,589 --> 00:12:35,720
signaling of call completion and this

318
00:12:35,720 --> 00:12:37,880
has a breakdown of you know dedicated

319
00:12:37,880 --> 00:12:40,339
control associated control slow

320
00:12:40,339 --> 00:12:41,959
associated control fast associated

321
00:12:41,959 --> 00:12:45,320
controlled and these basically are used

322
00:12:45,320 --> 00:12:47,209
for this authentication selection and

323
00:12:47,209 --> 00:12:49,070
signaling and that the call has been

324
00:12:49,070 --> 00:12:51,800
terminated so the attacker can actually

325
00:12:51,800 --> 00:12:53,790
exploit GSM signalling weaknesses

326
00:12:53,790 --> 00:12:56,580
access subscribers mobile usage and

327
00:12:56,580 --> 00:12:57,510
we're gonna look at this in a little

328
00:12:57,510 --> 00:13:00,540
more detail but first I just wanted to

329
00:13:00,540 --> 00:13:02,190
talk a little bit about the over-the-air

330
00:13:02,190 --> 00:13:04,410
encryption so there are several

331
00:13:04,410 --> 00:13:05,940
over-the-air encryption algorithms that

332
00:13:05,940 --> 00:13:08,460
exist and they're used to encrypt some

333
00:13:08,460 --> 00:13:11,010
of the GSM data that goes in those

334
00:13:11,010 --> 00:13:12,570
channels it's not all of them so for

335
00:13:12,570 --> 00:13:13,830
instance things like the traffic channel

336
00:13:13,830 --> 00:13:15,780
and voice communication typically going

337
00:13:15,780 --> 00:13:18,900
to be encrypted so there's a 5/1 which

338
00:13:18,900 --> 00:13:20,190
has been publicly broken you can

339
00:13:20,190 --> 00:13:22,200
download rainbow tables for it there's a

340
00:13:22,200 --> 00:13:24,480
5/2 which is essentially no security

341
00:13:24,480 --> 00:13:27,180
whatsoever and then there's the a 5/3

342
00:13:27,180 --> 00:13:29,460
which is the kazumi cipher which is

343
00:13:29,460 --> 00:13:30,480
vulnerable to a number of

344
00:13:30,480 --> 00:13:32,400
man-in-the-middle attacks but it's not

345
00:13:32,400 --> 00:13:33,930
yet been publicly broken when applied in

346
00:13:33,930 --> 00:13:36,630
GSM there's also a three and a eight

347
00:13:36,630 --> 00:13:38,220
which is used during the authentication

348
00:13:38,220 --> 00:13:41,190
process and as is widely known an

349
00:13:41,190 --> 00:13:42,870
attacker can attempt to passively

350
00:13:42,870 --> 00:13:44,310
analyze traffic looking for weak

351
00:13:44,310 --> 00:13:46,110
encryption or perform man-in-the-middle

352
00:13:46,110 --> 00:13:48,510
attacks against subscribers mobile phone

353
00:13:48,510 --> 00:13:52,230
and base transceiver station so there's

354
00:13:52,230 --> 00:13:54,000
also now the general packet radio

355
00:13:54,000 --> 00:13:56,010
service general packet radio service or

356
00:13:56,010 --> 00:13:56,700
GPRS

357
00:13:56,700 --> 00:14:00,210
is what makes a 2g GSM environment 2.5 G

358
00:14:00,210 --> 00:14:03,030
it makes use of existing GSM concepts

359
00:14:03,030 --> 00:14:05,550
such as time slots and introduces two

360
00:14:05,550 --> 00:14:07,350
new components into the original GSM

361
00:14:07,350 --> 00:14:09,000
architecture which is the subscriber

362
00:14:09,000 --> 00:14:12,780
GPRS service node or sgsn and Gateway

363
00:14:12,780 --> 00:14:16,950
GPRS service node or G GSM it adds a

364
00:14:16,950 --> 00:14:19,050
packet control unit to the base station

365
00:14:19,050 --> 00:14:22,050
subsystem and then basically data is

366
00:14:22,050 --> 00:14:25,440
then sent in these PCU frames and it

367
00:14:25,440 --> 00:14:27,480
introduces new radio resource protocol

368
00:14:27,480 --> 00:14:29,370
management which is separate to what's

369
00:14:29,370 --> 00:14:32,220
being used by GSM and on top of that it

370
00:14:32,220 --> 00:14:34,260
builds the radio link control and media

371
00:14:34,260 --> 00:14:36,750
access control for allowing packet data

372
00:14:36,750 --> 00:14:40,010
to be sent within the GSM time slots

373
00:14:40,010 --> 00:14:44,130
okay so that's kind of a bit of detailed

374
00:14:44,130 --> 00:14:47,460
technical overview of the background 42

375
00:14:47,460 --> 00:14:50,760
5.5 G and so what I'd like to do now is

376
00:14:50,760 --> 00:14:51,930
just sort of give you an overview of

377
00:14:51,930 --> 00:14:53,850
some of the tools that you would use to

378
00:14:53,850 --> 00:14:56,370
begin analyzing a cellular environment

379
00:14:56,370 --> 00:14:59,430
so the first tool I would look at is the

380
00:14:59,430 --> 00:15:01,950
nokia net monitor so Nokia shipped a

381
00:15:01,950 --> 00:15:03,750
diagnostic tool in early phones

382
00:15:03,750 --> 00:15:04,370
particular

383
00:15:04,370 --> 00:15:07,610
here shown the Nokia 3310 that you can

384
00:15:07,610 --> 00:15:10,100
enable a hidden option called net

385
00:15:10,100 --> 00:15:12,380
monitor and this basically allows you to

386
00:15:12,380 --> 00:15:14,029
perform things like absolute radio

387
00:15:14,029 --> 00:15:15,830
frequency channel number identification

388
00:15:15,830 --> 00:15:18,440
that you're connected to it'll show you

389
00:15:18,440 --> 00:15:20,450
things like the channel that you're on

390
00:15:20,450 --> 00:15:22,670
so here we can see the common control

391
00:15:22,670 --> 00:15:24,970
channel you can also do things like

392
00:15:24,970 --> 00:15:27,020
capture the uplink traffic that's being

393
00:15:27,020 --> 00:15:28,220
sent through your phone

394
00:15:28,220 --> 00:15:30,260
it's basically a very cool feature of Na

395
00:15:30,260 --> 00:15:32,600
kuren quite widely used and because of

396
00:15:32,600 --> 00:15:34,940
its versatility even within the mobile

397
00:15:34,940 --> 00:15:36,730
providers themselves

398
00:15:36,730 --> 00:15:39,440
there's also dedicated test Hardware now

399
00:15:39,440 --> 00:15:41,540
I spend a lot of time on eBay trying to

400
00:15:41,540 --> 00:15:44,900
find test hardware for gsm and here's an

401
00:15:44,900 --> 00:15:47,660
example of a GSM analyst analyzer I

402
00:15:47,660 --> 00:15:49,910
purchased and the prices can wear it

403
00:15:49,910 --> 00:15:51,620
vary quite widely you can get things

404
00:15:51,620 --> 00:15:53,180
that cost a few hundred pounds the

405
00:15:53,180 --> 00:15:54,290
things that cost in the tens of

406
00:15:54,290 --> 00:15:56,270
thousands and they're actually not very

407
00:15:56,270 --> 00:15:58,010
well featured they're quite restrictive

408
00:15:58,010 --> 00:16:01,220
they the cost can be quite high if you

409
00:16:01,220 --> 00:16:02,390
try to contact the people who

410
00:16:02,390 --> 00:16:03,680
manufacture the hardware they're

411
00:16:03,680 --> 00:16:04,760
generally not going to help you unless

412
00:16:04,760 --> 00:16:07,220
you you know you're a large large-scale

413
00:16:07,220 --> 00:16:10,520
monopoly and actually open source tools

414
00:16:10,520 --> 00:16:12,650
are a lot more flexible these days you

415
00:16:12,650 --> 00:16:13,970
can do a lot more with some of the open

416
00:16:13,970 --> 00:16:16,850
source stuff that's available so one of

417
00:16:16,850 --> 00:16:18,589
those open source tools is the Osmo comm

418
00:16:18,589 --> 00:16:21,890
BB that allows you to write tools

419
00:16:21,890 --> 00:16:23,360
essentially for a mobile stations

420
00:16:23,360 --> 00:16:27,380
baseband for instance the Calypso Texas

421
00:16:27,380 --> 00:16:28,910
Instruments chip which was leaked and

422
00:16:28,910 --> 00:16:30,980
they have essentially reverse engineered

423
00:16:30,980 --> 00:16:33,230
that and been able to rambu their own

424
00:16:33,230 --> 00:16:34,760
utilities on there so that they can get

425
00:16:34,760 --> 00:16:36,890
access to the baseband and implement

426
00:16:36,890 --> 00:16:38,690
pretty much anything you want there's

427
00:16:38,690 --> 00:16:40,370
are a number of useful Diagnostics tools

428
00:16:40,370 --> 00:16:43,180
already available that you can download

429
00:16:43,180 --> 00:16:45,980
and you can extend the code to visually

430
00:16:45,980 --> 00:16:49,000
represent the you know the GSM spectrum

431
00:16:49,000 --> 00:16:51,680
with only a 30-pound phone so here on

432
00:16:51,680 --> 00:16:53,990
the on the right of the screen this is

433
00:16:53,990 --> 00:16:56,660
actually a new plot where it's taken

434
00:16:56,660 --> 00:16:59,060
power measurements of all the GSM

435
00:16:59,060 --> 00:17:01,160
channels within the gsm 900 band and

436
00:17:01,160 --> 00:17:03,500
then just visually represents them and

437
00:17:03,500 --> 00:17:04,520
although it doesn't do it in real-time

438
00:17:04,520 --> 00:17:05,869
you can just sort of capture these

439
00:17:05,869 --> 00:17:07,099
measurements and you can actually view

440
00:17:07,099 --> 00:17:08,660
it and see what the spectrum looks like

441
00:17:08,660 --> 00:17:10,609
sort of like a spectrum analyzer but

442
00:17:10,609 --> 00:17:12,819
just for the gsm channels and use

443
00:17:12,819 --> 00:17:16,040
there's also GSM tap which is useful for

444
00:17:16,040 --> 00:17:16,809
debug

445
00:17:16,809 --> 00:17:19,388
the radio interface you can access that

446
00:17:19,388 --> 00:17:21,309
through these open-source tools

447
00:17:21,309 --> 00:17:23,378
it'll encapsulate the radio frequency

448
00:17:23,378 --> 00:17:25,569
information and transmit it within UDP

449
00:17:25,569 --> 00:17:27,819
encapsulated packets and it allows us to

450
00:17:27,819 --> 00:17:31,029
see the or air interface from either the

451
00:17:31,029 --> 00:17:32,799
base transceiver station or the MS

452
00:17:32,799 --> 00:17:35,080
mobile station depending on where abouts

453
00:17:35,080 --> 00:17:37,090
you position it in the environment and

454
00:17:37,090 --> 00:17:39,669
it's quite a useful capability when

455
00:17:39,669 --> 00:17:40,840
you're trying to analyze GSM

456
00:17:40,840 --> 00:17:42,220
environments to see what is actually

457
00:17:42,220 --> 00:17:44,759
being sent in the signaling channels

458
00:17:44,759 --> 00:17:48,070
there's also air probe air probe is a

459
00:17:48,070 --> 00:17:50,679
utility that's designed for essentially

460
00:17:50,679 --> 00:17:53,470
capturing the the radio spectrum of a

461
00:17:53,470 --> 00:17:54,929
GSM arfcn

462
00:17:54,929 --> 00:17:57,940
and it's a toolkit for analyzing the

463
00:17:57,940 --> 00:17:59,590
bursts and performing decoding of it

464
00:17:59,590 --> 00:18:01,360
that all then fire it back out and GSM

465
00:18:01,360 --> 00:18:03,249
tap and you can actually see what's

466
00:18:03,249 --> 00:18:04,600
going on over the air is a kind of

467
00:18:04,600 --> 00:18:06,730
passive sniffer you can do this with a

468
00:18:06,730 --> 00:18:10,179
20-pound Realtek SDR dongle it's purely

469
00:18:10,179 --> 00:18:11,769
passive and it allows for identification

470
00:18:11,769 --> 00:18:13,899
of call requests teach the traffic

471
00:18:13,899 --> 00:18:15,759
channel which should use encryption and

472
00:18:15,759 --> 00:18:18,580
then you can use kraken with the the

473
00:18:18,580 --> 00:18:20,830
rainbow tables rad51 if you come across

474
00:18:20,830 --> 00:18:23,080
that and to essentially decrypt

475
00:18:23,080 --> 00:18:26,590
information and Wireshark can pass the

476
00:18:26,590 --> 00:18:28,840
information of these cell Diagnostics

477
00:18:28,840 --> 00:18:32,139
tools out okay so these are the kind of

478
00:18:32,139 --> 00:18:33,720
utilities that are available for you for

479
00:18:33,720 --> 00:18:35,740
doing as you would do any kind of

480
00:18:35,740 --> 00:18:37,299
network assessment really just for

481
00:18:37,299 --> 00:18:39,039
enumeration and assessment and trying to

482
00:18:39,039 --> 00:18:41,830
learn what the environment looks like so

483
00:18:41,830 --> 00:18:42,759
we're going to talk now a little bit

484
00:18:42,759 --> 00:18:44,200
about some of the weaknesses there in

485
00:18:44,200 --> 00:18:47,049
GSM so the mobile station power run

486
00:18:47,049 --> 00:18:49,119
process is when you power on your phone

487
00:18:49,119 --> 00:18:50,559
for the first time this is essentially

488
00:18:50,559 --> 00:18:52,299
what your phone does it'll start a

489
00:18:52,299 --> 00:18:54,369
search for the broadcast channel of

490
00:18:54,369 --> 00:18:56,559
carriers by performing radios signal

491
00:18:56,559 --> 00:18:58,299
strength indicator measurements it will

492
00:18:58,299 --> 00:18:59,769
perform these power measurements by

493
00:18:59,769 --> 00:19:01,509
walking across all of the channels that

494
00:19:01,509 --> 00:19:03,549
are assigned for the GSM band and after

495
00:19:03,549 --> 00:19:06,009
it's identified a broadcast channel

496
00:19:06,009 --> 00:19:07,570
it'll probe for the presence of the

497
00:19:07,570 --> 00:19:09,490
frequency correction channel the phone

498
00:19:09,490 --> 00:19:11,019
will then sync and obtain information

499
00:19:11,019 --> 00:19:13,480
from the BTS about the network that it's

500
00:19:13,480 --> 00:19:16,029
trying to access and it will it will

501
00:19:16,029 --> 00:19:17,980
then know know at this point whether or

502
00:19:17,980 --> 00:19:19,659
not it should start name monitoring the

503
00:19:19,659 --> 00:19:20,980
neighboring cells are trying to connect

504
00:19:20,980 --> 00:19:22,840
to that Network if the cell has

505
00:19:22,840 --> 00:19:24,780
identified itself in a probe

506
00:19:24,780 --> 00:19:27,270
away and essentially this this whole

507
00:19:27,270 --> 00:19:29,820
processes or unauthenticated and it's

508
00:19:29,820 --> 00:19:31,560
essentially what's being exploited by md

509
00:19:31,560 --> 00:19:34,050
capture devices and fake BTS attack

510
00:19:34,050 --> 00:19:38,130
tools so to do this md capturing

511
00:19:38,130 --> 00:19:39,810
detection it's quite easy during a

512
00:19:39,810 --> 00:19:42,420
public land network mobile search or PL

513
00:19:42,420 --> 00:19:44,370
n ms it's quite trivial in fact your

514
00:19:44,370 --> 00:19:45,630
phone will do this the first time you

515
00:19:45,630 --> 00:19:46,950
turn it on or when it's lost signal

516
00:19:46,950 --> 00:19:49,800
completely so it's only performed during

517
00:19:49,800 --> 00:19:52,350
that point though after it's got signal

518
00:19:52,350 --> 00:19:53,730
it will monitor the surrounding

519
00:19:53,730 --> 00:19:56,250
environment for what's known as path

520
00:19:56,250 --> 00:19:58,440
loss criterion and research resection

521
00:19:58,440 --> 00:20:00,570
criterion which is these value c1 and c2

522
00:20:00,570 --> 00:20:03,000
they're dynamic variables that are taken

523
00:20:03,000 --> 00:20:05,040
by the phone to determine if a cell

524
00:20:05,040 --> 00:20:07,410
nearby to it has actual better radio

525
00:20:07,410 --> 00:20:10,110
conditions for it it dynamically keeps

526
00:20:10,110 --> 00:20:11,940
taking these variables and if it finds

527
00:20:11,940 --> 00:20:13,950
that the cell next to it in adjacent

528
00:20:13,950 --> 00:20:16,110
that's been decoded from when it's

529
00:20:16,110 --> 00:20:19,350
synced with the BTS it will join that

530
00:20:19,350 --> 00:20:21,480
cellular environment if you manipulate

531
00:20:21,480 --> 00:20:23,550
those two values you can force the

532
00:20:23,550 --> 00:20:25,590
mobile station to join the BTS without

533
00:20:25,590 --> 00:20:27,870
requiring the form to perform without

534
00:20:27,870 --> 00:20:30,210
requiring the phone to power on and

535
00:20:30,210 --> 00:20:33,600
power off and during this request during

536
00:20:33,600 --> 00:20:35,520
this location update request you can

537
00:20:35,520 --> 00:20:38,970
actually request the IMEI from the phone

538
00:20:38,970 --> 00:20:40,290
which is the unique number to identify

539
00:20:40,290 --> 00:20:44,850
that handset so when we're looking at

540
00:20:44,850 --> 00:20:47,130
the IMEI we can essentially look at this

541
00:20:47,130 --> 00:20:49,590
as a device fingerprint this table here

542
00:20:49,590 --> 00:20:51,810
shows how an eye on the eye is actually

543
00:20:51,810 --> 00:20:54,330
broken up it contains a type allocation

544
00:20:54,330 --> 00:20:58,020
code at the first six six digits and six

545
00:20:58,020 --> 00:21:00,210
to eight digits and which starts with

546
00:21:00,210 --> 00:21:02,640
two digit reporting body identifier now

547
00:21:02,640 --> 00:21:05,880
the reporting body identifier is what's

548
00:21:05,880 --> 00:21:07,460
used to determine the country which

549
00:21:07,460 --> 00:21:11,340
authorized or allowed this device to be

550
00:21:11,340 --> 00:21:13,050
used so it will say whether it was the

551
00:21:13,050 --> 00:21:16,350
United States China or England and the

552
00:21:16,350 --> 00:21:18,200
remaining six digits will identify the

553
00:21:18,200 --> 00:21:20,280
vendor who was actually produced the

554
00:21:20,280 --> 00:21:23,370
device so as this IMEI shows here we can

555
00:21:23,370 --> 00:21:26,610
see that the first six values are o 1 3

556
00:21:26,610 --> 00:21:30,570
0 35 so we know that 0 1 is going to be

557
00:21:30,570 --> 00:21:32,190
the United States so it gives us the

558
00:21:32,190 --> 00:21:33,740
United States and then we know

559
00:21:33,740 --> 00:21:36,020
the the manufacturer of this device

560
00:21:36,020 --> 00:21:37,370
would be Apple and in fact we can

561
00:21:37,370 --> 00:21:38,450
actually nail it down to a specific

562
00:21:38,450 --> 00:21:41,330
model of an Apple phone now it's very

563
00:21:41,330 --> 00:21:42,679
rare that these values are going to be

564
00:21:42,679 --> 00:21:44,360
spoofed unless it's an attacker who's in

565
00:21:44,360 --> 00:21:45,980
the environment so if you collect an

566
00:21:45,980 --> 00:21:47,480
IMEI it's quite likely that you're going

567
00:21:47,480 --> 00:21:49,760
to have a fairly accurate idea of what

568
00:21:49,760 --> 00:21:52,039
that device is as these are rarely

569
00:21:52,039 --> 00:21:55,159
changed and once you know one then you

570
00:21:55,159 --> 00:21:57,580
can be able to use that again and again

571
00:21:57,580 --> 00:22:00,980
so the location update request this is

572
00:22:00,980 --> 00:22:02,960
what essentially is occurring over the

573
00:22:02,960 --> 00:22:05,750
air and we can see here that the mobile

574
00:22:05,750 --> 00:22:07,490
phone is doing what's known as an mg

575
00:22:07,490 --> 00:22:08,840
attached it's saying that high on this

576
00:22:08,840 --> 00:22:10,850
mobile subscriber I want to connect to

577
00:22:10,850 --> 00:22:13,279
the environment and then the BTS

578
00:22:13,279 --> 00:22:14,809
environment it's also requesting that

579
00:22:14,809 --> 00:22:16,640
back down from it and saying okay I also

580
00:22:16,640 --> 00:22:18,679
want your equipment identifier and we

581
00:22:18,679 --> 00:22:20,899
can see here that the subscriber in this

582
00:22:20,899 --> 00:22:22,880
case is sending his equipment identifier

583
00:22:22,880 --> 00:22:26,570
is leaked leaked leaked so what an

584
00:22:26,570 --> 00:22:29,330
attacker would need to do is clone a BTS

585
00:22:29,330 --> 00:22:31,789
to be able to actually do an attack and

586
00:22:31,789 --> 00:22:33,110
exploit this condition we're going to

587
00:22:33,110 --> 00:22:34,789
need to simulate certain conditions to

588
00:22:34,789 --> 00:22:37,340
get a mobile station onto our fake

589
00:22:37,340 --> 00:22:38,929
environment so we're going to need to

590
00:22:38,929 --> 00:22:40,940
locate the mobile country code and the

591
00:22:40,940 --> 00:22:42,710
mobile network code of the target phone

592
00:22:42,710 --> 00:22:44,630
provider and all their roaming

593
00:22:44,630 --> 00:22:47,059
agreements so for instance if your phone

594
00:22:47,059 --> 00:22:48,529
allows you to roam to one of the network

595
00:22:48,529 --> 00:22:50,120
we could also try to spoof that network

596
00:22:50,120 --> 00:22:52,370
and then we're also going to need to

597
00:22:52,370 --> 00:22:54,620
identify the neighbor absolute radio

598
00:22:54,620 --> 00:22:56,630
frequency Channel and that's being used

599
00:22:56,630 --> 00:22:58,850
by the mobile station by performing our

600
00:22:58,850 --> 00:23:01,520
own pl- lochley in the environment which

601
00:23:01,520 --> 00:23:03,649
we want to target and so we would then

602
00:23:03,649 --> 00:23:06,710
create a BTS using and the values that

603
00:23:06,710 --> 00:23:09,230
we've obtained by doing that and any

604
00:23:09,230 --> 00:23:10,640
other parameters that we might want such

605
00:23:10,640 --> 00:23:12,649
as color coding and similar to match a

606
00:23:12,649 --> 00:23:15,559
weak signal that's available to that of

607
00:23:15,559 --> 00:23:17,270
it to that particular subscriber and

608
00:23:17,270 --> 00:23:19,159
we're going to try and pick the weakest

609
00:23:19,159 --> 00:23:21,110
signal so that we reduce interference so

610
00:23:21,110 --> 00:23:22,940
that we're going to essentially look

611
00:23:22,940 --> 00:23:24,649
like a good neighboring cell the phone's

612
00:23:24,649 --> 00:23:26,000
going to attempt to join it but wouldn't

613
00:23:26,000 --> 00:23:27,440
actually be trying to join the original

614
00:23:27,440 --> 00:23:29,450
cell as we would be broadcasting on the

615
00:23:29,450 --> 00:23:32,360
same frequency and this creates an

616
00:23:32,360 --> 00:23:34,490
environment where a target who is in

617
00:23:34,490 --> 00:23:36,620
close physical proximity to the BTS

618
00:23:36,620 --> 00:23:39,409
and will trigger celery selection and as

619
00:23:39,409 --> 00:23:40,820
the mobile station will essentially see

620
00:23:40,820 --> 00:23:43,820
this better environment so the cell

621
00:23:43,820 --> 00:23:45,049
Diagnostics tools that we discussed

622
00:23:45,049 --> 00:23:46,220
before

623
00:23:46,220 --> 00:23:47,720
what you would use to obtain these

624
00:23:47,720 --> 00:23:49,669
parameters to create that environment in

625
00:23:49,669 --> 00:23:53,390
a physical locality of your target so

626
00:23:53,390 --> 00:23:56,330
osmocon BB is pretty flexible tile tool

627
00:23:56,330 --> 00:23:58,909
you could also use new radio or GSM

628
00:23:58,909 --> 00:24:02,150
receiver and to perform this it includes

629
00:24:02,150 --> 00:24:03,860
a monitor command that allows you to

630
00:24:03,860 --> 00:24:06,650
view the bar graph and the transmission

631
00:24:06,650 --> 00:24:09,140
strength of the surrounding neighbor

632
00:24:09,140 --> 00:24:10,940
cells so we can see here this serving

633
00:24:10,940 --> 00:24:13,309
current arfcn and we can see the

634
00:24:13,309 --> 00:24:16,070
neighboring cells and we can see the the

635
00:24:16,070 --> 00:24:18,289
locality area code for these particular

636
00:24:18,289 --> 00:24:20,539
cells and so what we would do is we

637
00:24:20,539 --> 00:24:21,830
would pick one with a particularly weak

638
00:24:21,830 --> 00:24:23,990
signal and we would take the same values

639
00:24:23,990 --> 00:24:26,900
and punch them into our into our spoofed

640
00:24:26,900 --> 00:24:31,309
BTS there is also random access channel

641
00:24:31,309 --> 00:24:33,380
and timsy paging requests now these can

642
00:24:33,380 --> 00:24:35,030
be performed by a mobile station or a

643
00:24:35,030 --> 00:24:35,750
mobile phone

644
00:24:35,750 --> 00:24:37,789
trying to attack a cell tower and

645
00:24:37,789 --> 00:24:39,950
essentially because we have a number of

646
00:24:39,950 --> 00:24:42,110
time slots and there's a finite amount

647
00:24:42,110 --> 00:24:44,090
of resource available to subscribers on

648
00:24:44,090 --> 00:24:46,340
gsm an attacker could continually

649
00:24:46,340 --> 00:24:48,559
request these resources by constantly

650
00:24:48,559 --> 00:24:50,659
making demands for time slot so it's

651
00:24:50,659 --> 00:24:51,770
constant making demands say I want to

652
00:24:51,770 --> 00:24:53,539
make a call at 1 mile but not making use

653
00:24:53,539 --> 00:24:55,280
of those resources until all of the

654
00:24:55,280 --> 00:24:57,289
resources are consumed and there's also

655
00:24:57,289 --> 00:24:59,000
the temporary mobile subscriber identity

656
00:24:59,000 --> 00:25:00,890
which is vulnerable to a race condition

657
00:25:00,890 --> 00:25:03,470
and when the cell tower is paging and

658
00:25:03,470 --> 00:25:05,809
saying hey where's this mobile phone you

659
00:25:05,809 --> 00:25:07,549
could answer that page and say I'm here

660
00:25:07,549 --> 00:25:08,929
and then of course it will try to

661
00:25:08,929 --> 00:25:10,700
communicate with you without passing

662
00:25:10,700 --> 00:25:12,740
additional information back to the

663
00:25:12,740 --> 00:25:14,240
original phone who when it answers the

664
00:25:14,240 --> 00:25:16,070
page won't it won't get there because

665
00:25:16,070 --> 00:25:17,870
you've raced the condition for the

666
00:25:17,870 --> 00:25:21,110
response and both of these attacks can

667
00:25:21,110 --> 00:25:24,020
be implemented in Oslo Kombi B and they

668
00:25:24,020 --> 00:25:26,450
both can be used to perform a denial of

669
00:25:26,450 --> 00:25:28,130
service of a cell tower you can

670
00:25:28,130 --> 00:25:29,600
essentially consume the resources on it

671
00:25:29,600 --> 00:25:31,370
so that people are unable to make calls

672
00:25:31,370 --> 00:25:35,720
or send texts so downgrade and jamming

673
00:25:35,720 --> 00:25:37,909
so it's kind of known that in the event

674
00:25:37,909 --> 00:25:41,330
that the newer networks 3G and 4G become

675
00:25:41,330 --> 00:25:42,950
unavailable your phone will still revert

676
00:25:42,950 --> 00:25:44,809
back and obtain a signal however it can

677
00:25:44,809 --> 00:25:47,809
so it all go back to 2.5 G so these

678
00:25:47,809 --> 00:25:49,520
environments can be jammed you can

679
00:25:49,520 --> 00:25:52,280
downgrade and force a connection and I

680
00:25:52,280 --> 00:25:54,440
had some though the fortunate to spend a

681
00:25:54,440 --> 00:25:55,970
bit of time in Asia where seemingly

682
00:25:55,970 --> 00:25:57,670
illegal devices are available on

683
00:25:57,670 --> 00:26:00,280
most every market bazaar and I was able

684
00:26:00,280 --> 00:26:01,750
to take some of these devices and have a

685
00:26:01,750 --> 00:26:03,880
look and see how they actually worked so

686
00:26:03,880 --> 00:26:06,400
this this here on the right is a jammer

687
00:26:06,400 --> 00:26:08,230
which has since been disabled and

688
00:26:08,230 --> 00:26:11,020
rendered inoperable but the concept

689
00:26:11,020 --> 00:26:12,460
behind it is that you would overpower

690
00:26:12,460 --> 00:26:14,260
the analog components of a radio with a

691
00:26:14,260 --> 00:26:16,180
stronger signal to essentially force

692
00:26:16,180 --> 00:26:18,760
that radio to not function because it

693
00:26:18,760 --> 00:26:20,590
couldn't get the communication out to

694
00:26:20,590 --> 00:26:23,170
the signal it was intended the protocols

695
00:26:23,170 --> 00:26:24,580
that are used in newer networks are

696
00:26:24,580 --> 00:26:27,190
intended to address this by the fact

697
00:26:27,190 --> 00:26:28,720
that they want to be more resilient to

698
00:26:28,720 --> 00:26:31,840
general noise or sawtooth jamming for

699
00:26:31,840 --> 00:26:33,670
instance just jamming a signal and

700
00:26:33,670 --> 00:26:36,220
trying to overload it and from what I

701
00:26:36,220 --> 00:26:37,720
looked at were in terms of these jammers

702
00:26:37,720 --> 00:26:38,800
there aren't really any that are

703
00:26:38,800 --> 00:26:40,720
suitable for researchers or testing

704
00:26:40,720 --> 00:26:42,670
purposes and if you want to simulate

705
00:26:42,670 --> 00:26:45,460
their their use you can just disable the

706
00:26:45,460 --> 00:26:48,100
4G and 3G because the wireless and slag

707
00:26:48,100 --> 00:26:49,810
Rafi acts in the UK would really forbid

708
00:26:49,810 --> 00:26:52,240
the use of these and the devices

709
00:26:52,240 --> 00:26:54,840
themselves are not really designed for

710
00:26:54,840 --> 00:26:56,680
electromagnetic compatibility their

711
00:26:56,680 --> 00:26:59,830
whole purpose is to overload frequencies

712
00:26:59,830 --> 00:27:01,890
and essentially jam up the spectrum so

713
00:27:01,890 --> 00:27:04,750
they have really no practical uses

714
00:27:04,750 --> 00:27:07,360
researchers or for trying to understand

715
00:27:07,360 --> 00:27:08,590
how these works other than the fact that

716
00:27:08,590 --> 00:27:10,810
they exist and if you were you know

717
00:27:10,810 --> 00:27:12,790
criminally minded then perhaps you might

718
00:27:12,790 --> 00:27:15,700
need to use these in the wild but as I

719
00:27:15,700 --> 00:27:17,620
say it's not really advised here in the

720
00:27:17,620 --> 00:27:22,590
UK and certainly their use is illegal so

721
00:27:22,590 --> 00:27:24,630
why don't we talk about now is

722
00:27:24,630 --> 00:27:30,730
simulation of a 2.5 g environment using

723
00:27:30,730 --> 00:27:32,320
a widely available open source software

724
00:27:32,320 --> 00:27:37,180
so open BTS is a an open source project

725
00:27:37,180 --> 00:27:39,700
created by range networks and they

726
00:27:39,700 --> 00:27:43,120
basically implements a GSM environment

727
00:27:43,120 --> 00:27:46,030
and also supports now a mini sgsn so you

728
00:27:46,030 --> 00:27:48,340
can implement packet radio and this is

729
00:27:48,340 --> 00:27:50,710
essentially its network architecture a

730
00:27:50,710 --> 00:27:52,270
lot of the components that you would

731
00:27:52,270 --> 00:27:54,460
find within a typical gsm environment

732
00:27:54,460 --> 00:27:56,910
are being replaced by the sequel Lite

733
00:27:56,910 --> 00:27:59,200
databases so you have a for instance a

734
00:27:59,200 --> 00:28:01,060
database for authentication via a

735
00:28:01,060 --> 00:28:03,040
component called support

736
00:28:03,040 --> 00:28:05,350
sip author if you have this store

737
00:28:05,350 --> 00:28:07,810
messaging queue for passing information

738
00:28:07,810 --> 00:28:09,460
and a lot of the

739
00:28:09,460 --> 00:28:11,290
the environment is then configured using

740
00:28:11,290 --> 00:28:15,070
sip and you have this PBX capability for

741
00:28:15,070 --> 00:28:17,020
any kind of call routing or additional

742
00:28:17,020 --> 00:28:18,280
information that you might want to do

743
00:28:18,280 --> 00:28:20,170
and you can then have your subscriber

744
00:28:20,170 --> 00:28:22,900
rest registry or your HLR essentially

745
00:28:22,900 --> 00:28:25,750
within your PBX so you could assign

746
00:28:25,750 --> 00:28:29,590
users phone numbers and the like and so

747
00:28:29,590 --> 00:28:32,950
I made use of open BTS and the way that

748
00:28:32,950 --> 00:28:36,460
I did it was I got myself a US RPE 100

749
00:28:36,460 --> 00:28:39,850
now the US RPE 100 is essentially a

750
00:28:39,850 --> 00:28:43,570
standalone embedded USRP it's it's an

751
00:28:43,570 --> 00:28:45,580
SDR that contains a gun stacks of arrow

752
00:28:45,580 --> 00:28:47,800
which is a computer on module which is

753
00:28:47,800 --> 00:28:50,410
essentially keeps a cortex a8 ARM

754
00:28:50,410 --> 00:28:54,460
processor with DSP and an FPGA for

755
00:28:54,460 --> 00:28:56,890
performing more you know focus on the

756
00:28:56,890 --> 00:29:00,250
DSP as well I put in the SPX thatr board

757
00:29:00,250 --> 00:29:02,440
which gives from 400 megahertz to 4.4

758
00:29:02,440 --> 00:29:04,870
gigahertz and it's essentially a 100

759
00:29:04,870 --> 00:29:06,540
milliwatt SDR so it's not very powerful

760
00:29:06,540 --> 00:29:09,160
but it's it's it's useful for kind of

761
00:29:09,160 --> 00:29:10,840
doing low powered tests and certainly

762
00:29:10,840 --> 00:29:12,790
could fill a small environment like this

763
00:29:12,790 --> 00:29:16,180
room and you could then use the GPS do

764
00:29:16,180 --> 00:29:18,760
kit or the clock tamer to provide a

765
00:29:18,760 --> 00:29:20,770
accurate clock in line with the GSM

766
00:29:20,770 --> 00:29:22,780
standards so that mobile stations will

767
00:29:22,780 --> 00:29:24,940
essentially attempt to camp with and

768
00:29:24,940 --> 00:29:26,920
able to correct their oscillator to be

769
00:29:26,920 --> 00:29:30,490
matching the the radio environment and

770
00:29:30,490 --> 00:29:33,190
camp on it and SS research provide a an

771
00:29:33,190 --> 00:29:36,010
angstrom Linux image built with new

772
00:29:36,010 --> 00:29:37,750
radio three point six point four point

773
00:29:37,750 --> 00:29:40,000
one so I got this because I thought it'd

774
00:29:40,000 --> 00:29:42,580
be really cool to have a BTS that was

775
00:29:42,580 --> 00:29:44,110
fully embedded that I could use to start

776
00:29:44,110 --> 00:29:45,430
launching attacks so I could put it in a

777
00:29:45,430 --> 00:29:48,550
backpack or stick it in an office

778
00:29:48,550 --> 00:29:50,950
environment and just target people and

779
00:29:50,950 --> 00:29:52,660
then go away and then and log into it so

780
00:29:52,660 --> 00:29:54,040
I didn't need a big computer or anything

781
00:29:54,040 --> 00:29:57,760
else alongside it and I also found out

782
00:29:57,760 --> 00:29:59,860
that I would have to find some way of

783
00:29:59,860 --> 00:30:01,210
doing the development of this without

784
00:30:01,210 --> 00:30:03,360
causing interference to the surrounding

785
00:30:03,360 --> 00:30:05,320
electromagnetic spectrum or the RF

786
00:30:05,320 --> 00:30:08,040
environment so I obtained

787
00:30:08,040 --> 00:30:10,270
electromagnetic shielding or RF

788
00:30:10,270 --> 00:30:12,040
shielding which is essentially this

789
00:30:12,040 --> 00:30:15,340
large box here and that provides a like

790
00:30:15,340 --> 00:30:16,810
essentially a filter a frequency

791
00:30:16,810 --> 00:30:19,780
attenuation for a chunk of the radio

792
00:30:19,780 --> 00:30:20,970
spectrum

793
00:30:20,970 --> 00:30:22,500
and they are so put on the front of the

794
00:30:22,500 --> 00:30:24,930
radio a 50 ohms load so that when the

795
00:30:24,930 --> 00:30:26,550
energy that's being radiated out of the

796
00:30:26,550 --> 00:30:28,830
radio is actually just being absorbed by

797
00:30:28,830 --> 00:30:31,110
this on loads and isn't being radiated

798
00:30:31,110 --> 00:30:33,060
as effectively as it would if it was in

799
00:30:33,060 --> 00:30:35,550
a band matched antenna and then I put a

800
00:30:35,550 --> 00:30:38,310
receiving antenna on there for 900

801
00:30:38,310 --> 00:30:39,930
megahertz because I still wanted to hear

802
00:30:39,930 --> 00:30:41,460
the phone's I just didn't want to have a

803
00:30:41,460 --> 00:30:43,410
high-powered transmission or you know I

804
00:30:43,410 --> 00:30:44,850
wanted to be able to isolate what I was

805
00:30:44,850 --> 00:30:47,190
doing from the rest of the world

806
00:30:47,190 --> 00:30:49,200
another good bit of advice about when

807
00:30:49,200 --> 00:30:50,460
you're doing this is to put a spectrum

808
00:30:50,460 --> 00:30:53,130
analyzer outside of the environment and

809
00:30:53,130 --> 00:30:55,050
also one inside of it so you can see if

810
00:30:55,050 --> 00:30:56,250
there's any signal leakage from

811
00:30:56,250 --> 00:30:58,530
surrounding environment and then you can

812
00:30:58,530 --> 00:30:59,790
shut your experiments down should

813
00:30:59,790 --> 00:31:03,600
anything appear to leak this is a graph

814
00:31:03,600 --> 00:31:04,980
I have some help with some radio

815
00:31:04,980 --> 00:31:06,240
engineer friends that essentially shows

816
00:31:06,240 --> 00:31:09,900
you the frequency attenuation and

817
00:31:09,900 --> 00:31:11,850
essentially this particular device is

818
00:31:11,850 --> 00:31:13,800
fairly effective in the sub gigahertz

819
00:31:13,800 --> 00:31:16,500
range so not just for GSM but in general

820
00:31:16,500 --> 00:31:18,210
if you're interested in software-defined

821
00:31:18,210 --> 00:31:21,060
radio and targeting data networks and

822
00:31:21,060 --> 00:31:23,400
the like you can actually isolate things

823
00:31:23,400 --> 00:31:25,620
around from one gigahertz down to about

824
00:31:25,620 --> 00:31:27,680
DC and then essentially you can see

825
00:31:27,680 --> 00:31:31,170
what's what's being leaked at the higher

826
00:31:31,170 --> 00:31:36,630
ranges so now to get onto actual

827
00:31:36,630 --> 00:31:39,330
implementation of GSM attacks so greedy

828
00:31:39,330 --> 00:31:42,390
BTS is a firmware image which you can

829
00:31:42,390 --> 00:31:45,840
then install inside of a u.s. RPE 100

830
00:31:45,840 --> 00:31:47,820
and I spent a lot of time trying to

831
00:31:47,820 --> 00:31:49,230
rebuild the angst wrong image from

832
00:31:49,230 --> 00:31:51,600
scratch and with limited success so I

833
00:31:51,600 --> 00:31:53,130
essentially what I did was I took the

834
00:31:53,130 --> 00:31:56,190
stock image and then cross-compiled new

835
00:31:56,190 --> 00:31:58,770
kernel images and additional packages in

836
00:31:58,770 --> 00:32:00,390
there because a lot of the estus

837
00:32:00,390 --> 00:32:02,730
packages are lacking support for sort of

838
00:32:02,730 --> 00:32:05,010
sequel like databases ODBC and it's

839
00:32:05,010 --> 00:32:07,020
really kind of been developed more as a

840
00:32:07,020 --> 00:32:09,720
proof of concept that you could do an

841
00:32:09,720 --> 00:32:11,820
embedded base transceiver or similar

842
00:32:11,820 --> 00:32:15,300
with it I also built open BTS 5.0 and

843
00:32:15,300 --> 00:32:18,270
2.8 with mini sgsn or packet radio

844
00:32:18,270 --> 00:32:20,760
support and I had a couple of issues

845
00:32:20,760 --> 00:32:22,590
because there's a lack of support for

846
00:32:22,590 --> 00:32:23,880
the e-series

847
00:32:23,880 --> 00:32:26,460
in the open BTS branch so I had to make

848
00:32:26,460 --> 00:32:28,170
some patches and fix things within the

849
00:32:28,170 --> 00:32:30,509
code I also

850
00:32:30,509 --> 00:32:32,339
started to weaponize the open BTS

851
00:32:32,339 --> 00:32:34,859
environment itself so open BTS is

852
00:32:34,859 --> 00:32:37,529
designed for running an open gsm network

853
00:32:37,529 --> 00:32:38,729
but it's really good because it's really

854
00:32:38,729 --> 00:32:41,219
noisy and so if your target you know

855
00:32:41,219 --> 00:32:42,929
picks up his phone and it says oh hey

856
00:32:42,929 --> 00:32:44,249
welcome to your testing room and you

857
00:32:44,249 --> 00:32:45,419
know they're immediately gonna will be

858
00:32:45,419 --> 00:32:47,039
aware that there something is not quite

859
00:32:47,039 --> 00:32:48,359
right with their phone so I made some

860
00:32:48,359 --> 00:32:50,459
patches to that and such as removing

861
00:32:50,459 --> 00:32:52,409
welcome messages removing functionality

862
00:32:52,409 --> 00:32:53,940
which might alert a user to the fact

863
00:32:53,940 --> 00:32:55,349
that they are not connected to their

864
00:32:55,349 --> 00:32:57,149
normal network and then I've also

865
00:32:57,149 --> 00:32:59,729
increased logging in things like the l3

866
00:32:59,729 --> 00:33:01,829
mobility management for events so that I

867
00:33:01,829 --> 00:33:04,259
can more accurately track what's going

868
00:33:04,259 --> 00:33:07,049
on over-the-air for performing attacks

869
00:33:07,049 --> 00:33:09,149
and I also turned off the SDS ends

870
00:33:09,149 --> 00:33:11,459
firewalls for GPRS attacks so that the

871
00:33:11,459 --> 00:33:13,589
BTS itself can begin targeting by a

872
00:33:13,589 --> 00:33:16,169
packet radio any mobile devices that

873
00:33:16,169 --> 00:33:18,779
it's seen and I configured the Astrix

874
00:33:18,779 --> 00:33:20,699
environment to have full real-time

875
00:33:20,699 --> 00:33:22,949
support and automatic logging of any

876
00:33:22,949 --> 00:33:24,839
traffic via the functionalities like

877
00:33:24,839 --> 00:33:28,409
monitor I then added a console script

878
00:33:28,409 --> 00:33:30,569
for interacting with the various

879
00:33:30,569 --> 00:33:34,079
back-end components of the BTS so for

880
00:33:34,079 --> 00:33:36,329
instance having a you know the HLR or

881
00:33:36,329 --> 00:33:37,739
the ability to add a subscriber

882
00:33:37,739 --> 00:33:40,079
dynamically and then I integrated a

883
00:33:40,079 --> 00:33:42,059
number of databases for fingerprinting

884
00:33:42,059 --> 00:33:43,289
devices as and when they're seen

885
00:33:43,289 --> 00:33:46,619
over-the-air and then also for assisting

886
00:33:46,619 --> 00:33:50,509
you in cloning a cellular environment

887
00:33:50,539 --> 00:33:53,519
essentially this is what is shown to the

888
00:33:53,519 --> 00:33:57,179
user when you you launch the greedy DTS

889
00:33:57,179 --> 00:33:58,949
application you can access it via a

890
00:33:58,949 --> 00:34:00,959
console it shows you the current

891
00:34:00,959 --> 00:34:02,549
configuration for the cell it gives you

892
00:34:02,549 --> 00:34:05,459
the various radio power and that exists

893
00:34:05,459 --> 00:34:07,259
there and can set up everything

894
00:34:07,259 --> 00:34:09,329
automatically so because it's an

895
00:34:09,329 --> 00:34:11,789
embedded device everything is

896
00:34:11,789 --> 00:34:12,869
automatically configured you just

897
00:34:12,869 --> 00:34:14,159
install the stock image inside the

898
00:34:14,159 --> 00:34:15,509
device and everything's running for you

899
00:34:15,509 --> 00:34:17,879
all of the useful events that are handy

900
00:34:17,879 --> 00:34:19,469
for an attacker are sent to greedy BTS

901
00:34:19,469 --> 00:34:21,690
log and so these are logged then and

902
00:34:21,690 --> 00:34:24,179
accessed by the console application and

903
00:34:24,179 --> 00:34:25,889
it can dynamically provision a phone

904
00:34:25,889 --> 00:34:28,168
based on either the in Z so if we know

905
00:34:28,168 --> 00:34:29,750
the subscribers identity or

906
00:34:29,750 --> 00:34:33,539
alternatively the IMEI so if I know you

907
00:34:33,539 --> 00:34:34,829
know perhaps your IMEI from an

908
00:34:34,829 --> 00:34:36,690
application or I punch star hash oh six

909
00:34:36,690 --> 00:34:38,909
hash into your phone and then I can

910
00:34:38,909 --> 00:34:40,109
basically begin to target you

911
00:34:40,109 --> 00:34:42,929
specifically and nobody but you and also

912
00:34:42,929 --> 00:34:43,679
because

913
00:34:43,679 --> 00:34:45,659
these these I me eyes can be used to

914
00:34:45,659 --> 00:34:47,340
identify vendors I can also say well I'm

915
00:34:47,340 --> 00:34:49,440
only interested in getting Samsung

916
00:34:49,440 --> 00:34:51,330
Galaxy devices or I'm only interested in

917
00:34:51,330 --> 00:34:54,330
communicating with Apple iPhones and

918
00:34:54,330 --> 00:34:57,120
this allows me to essentially pick

919
00:34:57,120 --> 00:34:59,430
specific classes of devices or people

920
00:34:59,430 --> 00:35:01,950
and that I'm interested in I then built

921
00:35:01,950 --> 00:35:03,660
a number of useful utilities with into

922
00:35:03,660 --> 00:35:05,850
the firmware such as air probe various

923
00:35:05,850 --> 00:35:08,340
dosmo tools I added support for packet

924
00:35:08,340 --> 00:35:10,440
analysis t-shirt TCP dump and the peek

925
00:35:10,440 --> 00:35:13,800
app and the CVR records from Asterix and

926
00:35:13,800 --> 00:35:17,610
the smq I used to keep a recording of

927
00:35:17,610 --> 00:35:19,380
you know any subscriber communications

928
00:35:19,380 --> 00:35:20,580
attempt so once you actually give

929
00:35:20,580 --> 00:35:22,770
someone service it'll automatically

930
00:35:22,770 --> 00:35:24,120
record information about what they're

931
00:35:24,120 --> 00:35:26,820
trying to do and I then added for

932
00:35:26,820 --> 00:35:30,060
Asterix users you can essentially change

933
00:35:30,060 --> 00:35:31,830
and do things in Asterix so if you want

934
00:35:31,830 --> 00:35:33,690
to give them connectedly to the PSTN so

935
00:35:33,690 --> 00:35:34,770
that when they make a phone call you can

936
00:35:34,770 --> 00:35:36,330
actually connect it to the target

937
00:35:36,330 --> 00:35:39,030
destination or you know other amusing

938
00:35:39,030 --> 00:35:40,650
feats that you can think of with Asterix

939
00:35:40,650 --> 00:35:45,570
and the I also added the GPRS so that's

940
00:35:45,570 --> 00:35:47,700
automatically configured if you give the

941
00:35:47,700 --> 00:35:48,900
embedded device an internet connection

942
00:35:48,900 --> 00:35:50,880
it will automatically set up the GPRS

943
00:35:50,880 --> 00:35:52,610
and it will automatically give the phone

944
00:35:52,610 --> 00:35:55,890
GPRS if it's capable and asks for it and

945
00:35:55,890 --> 00:35:57,900
as an example for what we could do with

946
00:35:57,900 --> 00:35:59,730
packet radio I added a background

947
00:35:59,730 --> 00:36:02,100
exploit that just systematically waits

948
00:36:02,100 --> 00:36:04,500
for devices that match an apple iphone

949
00:36:04,500 --> 00:36:07,050
and then it will attempt to use exploits

950
00:36:07,050 --> 00:36:08,760
to compromise that mobile station and

951
00:36:08,760 --> 00:36:10,560
exfiltrate the data back to the embedded

952
00:36:10,560 --> 00:36:12,450
device so that I can browse through

953
00:36:12,450 --> 00:36:14,400
their phone book or text messages and

954
00:36:14,400 --> 00:36:16,260
the exploit it's not particularly

955
00:36:16,260 --> 00:36:17,970
sophisticated it's quite a slow attack

956
00:36:17,970 --> 00:36:20,760
to do so it's just there just as a kind

957
00:36:20,760 --> 00:36:22,470
of proof of concept you could attack for

958
00:36:22,470 --> 00:36:24,390
instance the mobile browser or other

959
00:36:24,390 --> 00:36:25,830
components but you need to be aware that

960
00:36:25,830 --> 00:36:28,470
attacking over GPRS is kind of a slow

961
00:36:28,470 --> 00:36:30,660
and a slow process and can take some

962
00:36:30,660 --> 00:36:33,300
time and greedy BTS is essentially

963
00:36:33,300 --> 00:36:35,640
designed to be used against a particular

964
00:36:35,640 --> 00:36:38,010
target it's only it's an embedded device

965
00:36:38,010 --> 00:36:39,930
it's got a you know there's a you're not

966
00:36:39,930 --> 00:36:41,370
gonna be able to get 500 users making

967
00:36:41,370 --> 00:36:42,960
phone calls through it and but you know

968
00:36:42,960 --> 00:36:44,570
for instance picking one or two people

969
00:36:44,570 --> 00:36:46,980
and then monitoring what they do

970
00:36:46,980 --> 00:36:48,840
whatever text messages they're sending

971
00:36:48,840 --> 00:36:49,980
whatever phone calls they're making

972
00:36:49,980 --> 00:36:51,750
whatever internet sites they're trying

973
00:36:51,750 --> 00:36:52,539
to browse on their side

974
00:36:52,539 --> 00:36:54,069
and then on their phone and then

975
00:36:54,069 --> 00:36:55,599
actually trying to attack their phone

976
00:36:55,599 --> 00:36:57,369
should that should they be in the

977
00:36:57,369 --> 00:36:59,529
vicinity of the device and so for

978
00:36:59,529 --> 00:37:01,029
instance you can imagine if you you're

979
00:37:01,029 --> 00:37:03,369
interested in target getting the CEO or

980
00:37:03,369 --> 00:37:05,739
you know a fortune 500 company and you

981
00:37:05,739 --> 00:37:07,509
pick on a particular individual and you

982
00:37:07,509 --> 00:37:09,669
place this device in his office you know

983
00:37:09,669 --> 00:37:11,140
you're gonna have a large period of time

984
00:37:11,140 --> 00:37:12,039
where you're gonna be able to actually

985
00:37:12,039 --> 00:37:14,229
extract information from their phone and

986
00:37:14,229 --> 00:37:16,150
and profile that individual and their

987
00:37:16,150 --> 00:37:17,979
and their habits and it's also it's

988
00:37:17,979 --> 00:37:19,419
Linux so you can you know do whatever

989
00:37:19,419 --> 00:37:22,630
you want on top of that this is the the

990
00:37:22,630 --> 00:37:24,759
help screen or the console and that's

991
00:37:24,759 --> 00:37:26,739
provided by Gucci VCS and this

992
00:37:26,739 --> 00:37:28,719
implements a number of commands that are

993
00:37:28,719 --> 00:37:31,029
used for the assistance of targeting a

994
00:37:31,029 --> 00:37:33,279
particular individual and and doing this

995
00:37:33,279 --> 00:37:36,069
over the kind of attacks and then

996
00:37:36,069 --> 00:37:37,989
essentially what we can do is we can set

997
00:37:37,989 --> 00:37:40,390
things based on regular expressions and

998
00:37:40,390 --> 00:37:42,189
we can also you know run tools like your

999
00:37:42,189 --> 00:37:44,109
fingerprint tool here so we can actually

1000
00:37:44,109 --> 00:37:46,150
see what kind of devices we've seen over

1001
00:37:46,150 --> 00:37:48,400
the air and we can also then as well see

1002
00:37:48,400 --> 00:37:50,289
the output of our any of our kind of

1003
00:37:50,289 --> 00:37:52,839
exploits that are being run and then

1004
00:37:52,839 --> 00:37:53,890
it's also got tools for you know

1005
00:37:53,890 --> 00:37:55,539
shutting down and terminating and the

1006
00:37:55,539 --> 00:37:58,269
like so a quick mention on as I

1007
00:37:58,269 --> 00:38:00,729
mentioned before about GPRS it actually

1008
00:38:00,729 --> 00:38:03,249
can take quite a while to exploit things

1009
00:38:03,249 --> 00:38:06,130
or inject traffic because you sacrifice

1010
00:38:06,130 --> 00:38:09,189
the ability to make calls because GSM

1011
00:38:09,189 --> 00:38:10,929
and GPRS are making use of the same time

1012
00:38:10,929 --> 00:38:12,880
slot so the more data throughput you

1013
00:38:12,880 --> 00:38:14,229
have the less capability you have to

1014
00:38:14,229 --> 00:38:17,469
make calls calls so you have to make a

1015
00:38:17,469 --> 00:38:19,900
balance between how much traffic you

1016
00:38:19,900 --> 00:38:21,909
want to be able to be put through and as

1017
00:38:21,909 --> 00:38:24,039
an example when I got the the iPhone

1018
00:38:24,039 --> 00:38:26,140
exploit to work which was basically just

1019
00:38:26,140 --> 00:38:28,419
trying to SSH into an iPhone that's been

1020
00:38:28,419 --> 00:38:30,009
jailbroken and hasn't had the passwords

1021
00:38:30,009 --> 00:38:32,019
changed and then essentially that will

1022
00:38:32,019 --> 00:38:33,939
go in and just grab the SMS grab the

1023
00:38:33,939 --> 00:38:35,739
context on the address book and store it

1024
00:38:35,739 --> 00:38:37,419
and just that process alone can take up

1025
00:38:37,419 --> 00:38:42,519
to five minutes so if you want greedy

1026
00:38:42,519 --> 00:38:44,799
BTS you need an eight gigabyte microSD

1027
00:38:44,799 --> 00:38:47,619
card you can basically just download it

1028
00:38:47,619 --> 00:38:50,469
from this URL here it's open SSL

1029
00:38:50,469 --> 00:38:52,749
encrypted if you do want it and you're

1030
00:38:52,749 --> 00:38:54,669
you know interested in researching GSM

1031
00:38:54,669 --> 00:38:56,499
environments and I'm more than happy to

1032
00:38:56,499 --> 00:38:58,749
share it with you just get in touch with

1033
00:38:58,749 --> 00:39:00,600
me for the password and

1034
00:39:00,600 --> 00:39:01,770
reason behind that is that when I

1035
00:39:01,770 --> 00:39:03,780
started to discuss the things that I was

1036
00:39:03,780 --> 00:39:05,610
looking at in February of this year on

1037
00:39:05,610 --> 00:39:08,160
the various mailing lists I had a number

1038
00:39:08,160 --> 00:39:10,230
of well-known security researchers who

1039
00:39:10,230 --> 00:39:12,870
emailed me that weren't really against

1040
00:39:12,870 --> 00:39:14,070
the facts of creating an image and

1041
00:39:14,070 --> 00:39:16,140
making it available just more about

1042
00:39:16,140 --> 00:39:18,720
trying to keep an eye on not sharing it

1043
00:39:18,720 --> 00:39:20,580
with anyone on the world who just feels

1044
00:39:20,580 --> 00:39:21,690
like tapping somebody's phone

1045
00:39:21,690 --> 00:39:24,090
arbitrarily so if you do want what I've

1046
00:39:24,090 --> 00:39:25,470
written that's cool if you want to make

1047
00:39:25,470 --> 00:39:26,460
it yourself there's enough information

1048
00:39:26,460 --> 00:39:28,650
here for you to go away and do that but

1049
00:39:28,650 --> 00:39:30,450
certainly just drop me an email and tell

1050
00:39:30,450 --> 00:39:33,080
me who you are and why you want it

1051
00:39:33,080 --> 00:39:35,790
having said that if you are interested

1052
00:39:35,790 --> 00:39:38,850
in GSM and there's a peak at trace of

1053
00:39:38,850 --> 00:39:41,580
GSM over-the-air so I captured a

1054
00:39:41,580 --> 00:39:45,060
downlink and an uplink and also the

1055
00:39:45,060 --> 00:39:46,470
information that's coming from a SIM

1056
00:39:46,470 --> 00:39:49,260
card and store that in a pcap file so

1057
00:39:49,260 --> 00:39:50,640
you can essentially just download this

1058
00:39:50,640 --> 00:39:51,480
d-cup file

1059
00:39:51,480 --> 00:39:53,790
get yourself a good book and have a read

1060
00:39:53,790 --> 00:39:55,560
through and actually see what goes on

1061
00:39:55,560 --> 00:39:57,120
over-the-air on an uplink and a downlink

1062
00:39:57,120 --> 00:39:59,430
cover of a mobile station so you can put

1063
00:39:59,430 --> 00:40:01,980
it there for review and also as an

1064
00:40:01,980 --> 00:40:04,140
alternative if you wanted to go away and

1065
00:40:04,140 --> 00:40:05,330
start implementing this stuff yourself

1066
00:40:05,330 --> 00:40:07,440
there are things like the BeagleBone

1067
00:40:07,440 --> 00:40:09,960
black or a nano BTS or b200 you could

1068
00:40:09,960 --> 00:40:11,820
actually do this thing now for a couple

1069
00:40:11,820 --> 00:40:13,620
of hundred pounds it's nowhere near the

1070
00:40:13,620 --> 00:40:15,120
thousands it used to cost a couple of

1071
00:40:15,120 --> 00:40:17,790
years ago so that's really why I wanted

1072
00:40:17,790 --> 00:40:19,620
to do this talk was just to show that we

1073
00:40:19,620 --> 00:40:21,900
can essentially the cost point of doing

1074
00:40:21,900 --> 00:40:23,100
these kinds of attacks is decreasing

1075
00:40:23,100 --> 00:40:25,920
quite rapidly and the amount of security

1076
00:40:25,920 --> 00:40:27,900
controls the protections just hasn't

1077
00:40:27,900 --> 00:40:29,760
changed the vulnerabilities that are

1078
00:40:29,760 --> 00:40:32,220
being exploited by in this way and we

1079
00:40:32,220 --> 00:40:33,600
have very little defense there are very

1080
00:40:33,600 --> 00:40:35,070
few phones actually will alert you when

1081
00:40:35,070 --> 00:40:36,540
somebody's trying to do this and it's

1082
00:40:36,540 --> 00:40:39,120
fairly transparent to the user and we

1083
00:40:39,120 --> 00:40:40,890
can also try to attack them by you know

1084
00:40:40,890 --> 00:40:44,970
traditional IP based attacks so okay

1085
00:40:44,970 --> 00:40:46,400
what I want to do now is essentially

1086
00:40:46,400 --> 00:40:50,250
demonstrate greedy BTS by putting a

1087
00:40:50,250 --> 00:40:52,710
couple of devices inside of this Faraday

1088
00:40:52,710 --> 00:40:57,050
cage and showing it being targeted

1089
00:41:22,200 --> 00:41:26,049
okay so this is the the serial console

1090
00:41:26,049 --> 00:41:28,900
on the embedded device essentially we've

1091
00:41:28,900 --> 00:41:30,579
got a USB connection that feeds into

1092
00:41:30,579 --> 00:41:32,140
this this box but everything is actually

1093
00:41:32,140 --> 00:41:34,450
being run is on site on the actual arm

1094
00:41:34,450 --> 00:41:37,539
arm device itself so if we were to login

1095
00:41:37,539 --> 00:41:39,519
to this device we can essentially just

1096
00:41:39,519 --> 00:41:42,039
have a quick look at the IP address as

1097
00:41:42,039 --> 00:41:43,509
well so it's running as a sage by

1098
00:41:43,509 --> 00:41:45,670
default and we've got here a couple of

1099
00:41:45,670 --> 00:41:47,259
helper scripts and utilities that are

1100
00:41:47,259 --> 00:41:48,789
designed for assisting us with these

1101
00:41:48,789 --> 00:41:51,640
attacks we've also got here the IP omen

1102
00:41:51,640 --> 00:41:53,400
exploit that we're using for

1103
00:41:53,400 --> 00:41:55,839
automatically trying to attack a target

1104
00:41:55,839 --> 00:41:59,440
iPhone and if we just sort of SSH in as

1105
00:41:59,440 --> 00:42:01,589
well

1106
00:42:14,270 --> 00:42:17,070
okay so essentially by running this

1107
00:42:17,070 --> 00:42:19,110
launch script it will load all of the

1108
00:42:19,110 --> 00:42:21,210
components that are necessary for us to

1109
00:42:21,210 --> 00:42:23,190
begin simulating and targeting the

1110
00:42:23,190 --> 00:42:25,560
attacks and we get here our current cell

1111
00:42:25,560 --> 00:42:27,720
configuration the setup for the various

1112
00:42:27,720 --> 00:42:28,410
radio powr

1113
00:42:28,410 --> 00:42:30,780
and it'll take a minute or so before we

1114
00:42:30,780 --> 00:42:33,840
get GPRS connection and essentially all

1115
00:42:33,840 --> 00:42:36,480
that's doing is setting up a virtual ton

1116
00:42:36,480 --> 00:42:38,550
interface and giving it IP and

1117
00:42:38,550 --> 00:42:40,320
essentially connecting that to the RF

1118
00:42:40,320 --> 00:42:41,700
side of things and then routing it out

1119
00:42:41,700 --> 00:42:45,300
by resinate so you've basically got your

1120
00:42:45,300 --> 00:42:49,910
GPRS accessible over-the-air to a phone

1121
00:42:50,210 --> 00:42:54,090
the priority messages that are there is

1122
00:42:54,090 --> 00:42:57,420
essentially I'm trying to increase the

1123
00:42:57,420 --> 00:42:59,160
amount of processing that can be done on

1124
00:42:59,160 --> 00:43:01,110
the embedded device for the the radio

1125
00:43:01,110 --> 00:43:03,360
side of things so everything runs a

1126
00:43:03,360 --> 00:43:05,280
little bit slowly but that's essentially

1127
00:43:05,280 --> 00:43:07,200
so that and the phones themselves can be

1128
00:43:07,200 --> 00:43:09,090
targeted a little bit better and I can

1129
00:43:09,090 --> 00:43:10,680
sacrifice a little speed in how long it

1130
00:43:10,680 --> 00:43:12,150
takes to punch in a command for more

1131
00:43:12,150 --> 00:43:15,560
reliability over-the-air

1132
00:43:54,120 --> 00:43:57,640
okay so this is our console interface

1133
00:43:57,640 --> 00:44:00,070
that provides us with the the easy way

1134
00:44:00,070 --> 00:44:01,780
of configuring these kind of

1135
00:44:01,780 --> 00:44:03,670
environments for doing targeted attacks

1136
00:44:03,670 --> 00:44:08,830
or analysis of GPRS so one of the things

1137
00:44:08,830 --> 00:44:10,390
that we would like to do is first of all

1138
00:44:10,390 --> 00:44:11,320
we're probably going to want to

1139
00:44:11,320 --> 00:44:12,880
configure our cellular environment to

1140
00:44:12,880 --> 00:44:15,100
match something which the mobile foot

1141
00:44:15,100 --> 00:44:16,750
device or device under assessment for

1142
00:44:16,750 --> 00:44:20,320
security analysis purposes we would for

1143
00:44:20,320 --> 00:44:23,650
instance need the MCC mmm C so if we

1144
00:44:23,650 --> 00:44:25,570
punch in list we can actually list all

1145
00:44:25,570 --> 00:44:28,420
of the various countries mobile country

1146
00:44:28,420 --> 00:44:31,120
codes and we could also then do a cell

1147
00:44:31,120 --> 00:44:33,250
phone and actually show them for

1148
00:44:33,250 --> 00:44:34,780
particular countries so if we punched in

1149
00:44:34,780 --> 00:44:37,090
the UK we can actually see all of the

1150
00:44:37,090 --> 00:44:38,610
necessary codes that we would need for

1151
00:44:38,610 --> 00:44:40,810
you know at spoofing a particular

1152
00:44:40,810 --> 00:44:44,050
provider or operator in the UK we could

1153
00:44:44,050 --> 00:44:47,590
also do cell find and search by country

1154
00:44:47,590 --> 00:44:49,030
so for instance if I was to punch in

1155
00:44:49,030 --> 00:44:50,380
Belize because I feel like the in the

1156
00:44:50,380 --> 00:44:53,050
NSA today and then I could like list the

1157
00:44:53,050 --> 00:44:54,790
the countries that the the operators in

1158
00:44:54,790 --> 00:44:57,340
Belize and set my BTS configuration up

1159
00:44:57,340 --> 00:44:59,980
to match those so I would set myself

1160
00:44:59,980 --> 00:45:01,810
configure and in this case I'm gonna

1161
00:45:01,810 --> 00:45:04,600
spoof a well-known provider here and

1162
00:45:04,600 --> 00:45:06,870
essentially set it up so that's

1163
00:45:06,870 --> 00:45:09,490
simulating that that's so that I can

1164
00:45:09,490 --> 00:45:11,890
access the subscribers for an Android

1165
00:45:11,890 --> 00:45:14,770
and iOS device which I have inside of

1166
00:45:14,770 --> 00:45:16,780
the Faraday cage and it's important to

1167
00:45:16,780 --> 00:45:18,730
point out that everything that's going

1168
00:45:18,730 --> 00:45:21,220
on is going on o solely with inside of

1169
00:45:21,220 --> 00:45:23,680
this environment and isn't actually

1170
00:45:23,680 --> 00:45:29,140
affecting anything else around it so we

1171
00:45:29,140 --> 00:45:30,040
have a couple of commands that are

1172
00:45:30,040 --> 00:45:33,310
available here and surprised that that's

1173
00:45:33,310 --> 00:45:38,950
actually shown okay so and I'm just

1174
00:45:38,950 --> 00:45:42,720
going to quickly go into here

1175
00:45:49,640 --> 00:45:52,680
okay and so essentially we've got this

1176
00:45:52,680 --> 00:45:55,260
this Android phone which is powered up

1177
00:45:55,260 --> 00:45:58,260
in the environment and the greedy BTS

1178
00:45:58,260 --> 00:46:03,090
has identified the phone's IMEI and the

1179
00:46:03,090 --> 00:46:04,800
subscriber identity but at this point in

1180
00:46:04,800 --> 00:46:06,720
time I haven't actually given them any

1181
00:46:06,720 --> 00:46:08,610
service so I'm gonna go ahead and just

1182
00:46:08,610 --> 00:46:10,920
sort of leave that for now it could take

1183
00:46:10,920 --> 00:46:12,570
a while eventually because it'll sort of

1184
00:46:12,570 --> 00:46:14,760
timeout and wait and then redo things so

1185
00:46:14,760 --> 00:46:18,030
we might reboot it but if we were to

1186
00:46:18,030 --> 00:46:20,010
look at the additional commands that we

1187
00:46:20,010 --> 00:46:21,090
have here we could look at dump

1188
00:46:21,090 --> 00:46:23,130
Association and what this allows us to

1189
00:46:23,130 --> 00:46:24,300
do is it allows us to make the

1190
00:46:24,300 --> 00:46:27,270
Association by the Android phone is

1191
00:46:27,270 --> 00:46:28,830
connected to this particular subscriber

1192
00:46:28,830 --> 00:46:31,140
so one of the things that I can now do

1193
00:46:31,140 --> 00:46:32,820
is I know that this you this subscriber

1194
00:46:32,820 --> 00:46:34,380
matches this Equipment Identity number

1195
00:46:34,380 --> 00:46:36,330
so I could actually begin to provide

1196
00:46:36,330 --> 00:46:40,770
service based on the IMEI so one of the

1197
00:46:40,770 --> 00:46:41,940
things that I will do and I'm going to

1198
00:46:41,940 --> 00:46:45,840
kick this off now because it can take a

1199
00:46:45,840 --> 00:46:48,800
while is essentially punch in an IMEI

1200
00:46:48,800 --> 00:46:51,600
and earlier on we use the IMEI of an

1201
00:46:51,600 --> 00:46:53,940
iPhone as an example so basically what

1202
00:46:53,940 --> 00:46:56,010
greedy BTS will do with this regex is it

1203
00:46:56,010 --> 00:46:57,690
will sit there and wait and whenever it

1204
00:46:57,690 --> 00:46:59,400
sees an iPhone it will work out a free

1205
00:46:59,400 --> 00:47:01,200
extension and it will find the

1206
00:47:01,200 --> 00:47:02,670
subscriber identity and then it will

1207
00:47:02,670 --> 00:47:04,440
automatically give that user service

1208
00:47:04,440 --> 00:47:06,090
because it's matching the fact that it's

1209
00:47:06,090 --> 00:47:08,160
a known iPhone so what I'll do now is

1210
00:47:08,160 --> 00:47:10,200
I'll just power the iPhone and let it

1211
00:47:10,200 --> 00:47:12,600
automatically join and be provisioned oh

1212
00:47:12,600 --> 00:47:15,270
and just to show that it's not if I was

1213
00:47:15,270 --> 00:47:17,490
to punch in show service the show

1214
00:47:17,490 --> 00:47:19,170
service command shows us all of the

1215
00:47:19,170 --> 00:47:20,670
users that exist currently in the

1216
00:47:20,670 --> 00:47:22,920
database and their extension number if

1217
00:47:22,920 --> 00:47:25,730
we want to dial them

1218
00:48:00,550 --> 00:48:05,410
okay so for instance at this point in

1219
00:48:05,410 --> 00:48:07,660
time as well we can go ahead and give

1220
00:48:07,660 --> 00:48:10,600
service to this user we could just add

1221
00:48:10,600 --> 00:48:12,850
them into the database at this point and

1222
00:48:12,850 --> 00:48:14,230
then give them a kind of hard-coded

1223
00:48:14,230 --> 00:48:16,570
extension and what we could have done is

1224
00:48:16,570 --> 00:48:18,460
we could also have used a number of the

1225
00:48:18,460 --> 00:48:20,170
other commands such as the watch service

1226
00:48:20,170 --> 00:48:21,400
we could have given the regular

1227
00:48:21,400 --> 00:48:23,590
expression to provision images and what

1228
00:48:23,590 --> 00:48:24,850
we could do there is we could say okay

1229
00:48:24,850 --> 00:48:26,800
well I want to provide everyone who's

1230
00:48:26,800 --> 00:48:28,660
got a Chinese phone in the area I'm you

1231
00:48:28,660 --> 00:48:30,370
know I want to give them access so

1232
00:48:30,370 --> 00:48:31,720
anyone I know who's on a Chinese

1233
00:48:31,720 --> 00:48:33,190
provided with a roaming agreement I

1234
00:48:33,190 --> 00:48:33,700
could just

1235
00:48:33,700 --> 00:48:36,400
I am provision them or for instance you

1236
00:48:36,400 --> 00:48:38,500
know a particular network operator or we

1237
00:48:38,500 --> 00:48:41,050
could provide them so in this case we'll

1238
00:48:41,050 --> 00:48:43,390
just basically automatically set them up

1239
00:48:43,390 --> 00:48:45,220
and provide them and I'll also provide

1240
00:48:45,220 --> 00:48:47,200
this and we can see now there's two

1241
00:48:47,200 --> 00:48:49,780
subscribers in the database basically

1242
00:48:49,780 --> 00:48:52,390
what's happened is it's identified the

1243
00:48:52,390 --> 00:48:56,170
the iPhone user based on the IMEI when

1244
00:48:56,170 --> 00:48:58,300
it's attempted to synchronize with the

1245
00:48:58,300 --> 00:49:00,430
BTS and then it's automatically

1246
00:49:00,430 --> 00:49:02,620
provisioned it into the the database for

1247
00:49:02,620 --> 00:49:06,000
us and we have here the - so we've got

1248
00:49:06,000 --> 00:49:09,460
dump associations so we can see here

1249
00:49:09,460 --> 00:49:13,060
we've got two devices and two

1250
00:49:13,060 --> 00:49:14,320
subscribers now one of the things that

1251
00:49:14,320 --> 00:49:16,060
I'll do is I'll run the output of the

1252
00:49:16,060 --> 00:49:17,680
fingerprint command the fingerprint

1253
00:49:17,680 --> 00:49:18,880
command will basically look up the

1254
00:49:18,880 --> 00:49:20,080
information from the equipment

1255
00:49:20,080 --> 00:49:22,630
identifier and tell me information about

1256
00:49:22,630 --> 00:49:24,970
what kind of phone it is so I know here

1257
00:49:24,970 --> 00:49:28,120
that I've got a HTC Wildfire and I've

1258
00:49:28,120 --> 00:49:31,120
got a I phone for s both within the

1259
00:49:31,120 --> 00:49:35,160
environment and both should have service

1260
00:50:39,620 --> 00:50:43,350
so I'm just hoping that the iPhone is

1261
00:50:43,350 --> 00:50:46,190
going to come back alive

1262
00:51:19,810 --> 00:51:24,170
so I forgot to restart the the BTS when

1263
00:51:24,170 --> 00:51:28,340
I changed the configuration so okay so

1264
00:51:28,340 --> 00:51:31,490
essentially now we can see the iPhone is

1265
00:51:31,490 --> 00:51:33,860
online and it's got a GP RS connection

1266
00:51:33,860 --> 00:51:35,180
it's now dropped offline

1267
00:51:35,180 --> 00:51:37,640
hopefully okay so it's basically coming

1268
00:51:37,640 --> 00:51:39,320
back on on to the air it's got a GPRS

1269
00:51:39,320 --> 00:51:41,690
connection and if that user was to

1270
00:51:41,690 --> 00:51:43,330
attempt to browse out to some website

1271
00:51:43,330 --> 00:51:45,380
they would essentially see a kind of

1272
00:51:45,380 --> 00:51:48,590
loading page and what I'm going to do

1273
00:51:48,590 --> 00:51:51,050
now is I'm just gonna make a phone call

1274
00:51:51,050 --> 00:51:54,590
using the other device make a phone call

1275
00:51:54,590 --> 00:51:58,870
to the number so 600 I guess

1276
00:52:14,160 --> 00:52:16,380
okay so if I just leave that user making

1277
00:52:16,380 --> 00:52:18,680
a phone call

1278
00:52:33,800 --> 00:52:36,469
[Music]

1279
00:52:36,469 --> 00:52:40,559
okay so essentially if we were to look

1280
00:52:40,559 --> 00:52:43,559
in the call recordings directory and the

1281
00:52:43,559 --> 00:52:45,059
phone call that the users made has

1282
00:52:45,059 --> 00:52:46,650
automatically been recorded which also

1283
00:52:46,650 --> 00:52:49,319
includes the the content of what they're

1284
00:52:49,319 --> 00:52:51,650
accessing

1285
00:53:14,060 --> 00:53:17,060
so we're just going to basically copy

1286
00:53:17,060 --> 00:53:19,010
that material off off the device so that

1287
00:53:19,010 --> 00:53:23,380
we can can access it

1288
00:53:31,220 --> 00:53:36,540
okay so essentially this is what the

1289
00:53:36,540 --> 00:53:37,920
user would have heard when they were

1290
00:53:37,920 --> 00:53:39,300
trying to make a phone call

1291
00:53:39,300 --> 00:53:40,980
which is Rick Astley's never gonna give

1292
00:53:40,980 --> 00:53:44,609
you up so anytime somebody tried to make

1293
00:53:44,609 --> 00:53:46,770
a phone call within the the area that

1294
00:53:46,770 --> 00:53:48,210
you're affected you can sort of redirect

1295
00:53:48,210 --> 00:53:49,589
them with Asterix and obviously that

1296
00:53:49,589 --> 00:53:51,030
kind of opens itself to all kinds of

1297
00:53:51,030 --> 00:53:54,480
hilarity and so yeah but on a more

1298
00:53:54,480 --> 00:53:55,920
serious note you know I could have quite

1299
00:53:55,920 --> 00:53:58,950
easily spoofed a bank and then said okay

1300
00:53:58,950 --> 00:54:01,410
please enter your 16 digit card number

1301
00:54:01,410 --> 00:54:03,690
before I authorize you and spoofed

1302
00:54:03,690 --> 00:54:06,000
another kind of telephone IBF prompt or

1303
00:54:06,000 --> 00:54:08,820
similar and then automatically recorded

1304
00:54:08,820 --> 00:54:11,839
that information as well

1305
00:54:18,210 --> 00:54:22,140
okay so this is the IP traffic that's

1306
00:54:22,140 --> 00:54:25,560
going over the the RF interface as well

1307
00:54:25,560 --> 00:54:27,720
so this is the iPhone trying to

1308
00:54:27,720 --> 00:54:30,330
communicate out to various websites and

1309
00:54:30,330 --> 00:54:31,680
basically what's happening here is we're

1310
00:54:31,680 --> 00:54:33,450
just we're just provisioning it and

1311
00:54:33,450 --> 00:54:34,830
giving it IP and then just routing it

1312
00:54:34,830 --> 00:54:37,440
through our usual outbound internet

1313
00:54:37,440 --> 00:54:39,000
connection and from here we can do

1314
00:54:39,000 --> 00:54:40,440
things like traffic analysis we can

1315
00:54:40,440 --> 00:54:42,630
start to record look for session cookies

1316
00:54:42,630 --> 00:54:44,480
any kind of plaintext information leaks

1317
00:54:44,480 --> 00:54:47,160
anything that we really want to find in

1318
00:54:47,160 --> 00:54:49,980
the in the phone or the traffic is

1319
00:54:49,980 --> 00:54:51,300
pretty much exposed to us so this is

1320
00:54:51,300 --> 00:54:54,060
almost like attacking a device on an

1321
00:54:54,060 --> 00:54:56,460
insecure Wi-Fi environment and what's

1322
00:54:56,460 --> 00:54:57,870
bad about this is if you actually look

1323
00:54:57,870 --> 00:55:01,770
at the phone there's there's like no

1324
00:55:01,770 --> 00:55:06,120
alerting whatsoever it's it's just just

1325
00:55:06,120 --> 00:55:08,640
like like your phone normally looks and

1326
00:55:08,640 --> 00:55:11,520
you can essentially then begin using the

1327
00:55:11,520 --> 00:55:14,160
the IP interface or the IP address and

1328
00:55:14,160 --> 00:55:15,720
we can start trying to leverage attacks

1329
00:55:15,720 --> 00:55:19,470
against traditional mobile services and

1330
00:55:19,470 --> 00:55:23,640
browsers and the like so if I run this

1331
00:55:23,640 --> 00:55:24,210
show

1332
00:55:24,210 --> 00:55:28,020
iPhone command okay I was worried that

1333
00:55:28,020 --> 00:55:29,730
this might not work now basically it's

1334
00:55:29,730 --> 00:55:31,560
temperamental to get the exploits to go

1335
00:55:31,560 --> 00:55:34,110
but basically what this does is it will

1336
00:55:34,110 --> 00:55:36,570
sit in the background and every time it

1337
00:55:36,570 --> 00:55:39,540
sees an IP packet requests coming for

1338
00:55:39,540 --> 00:55:41,340
Apple comm it will essentially try to

1339
00:55:41,340 --> 00:55:42,750
log in to the device and if it's

1340
00:55:42,750 --> 00:55:44,220
jailbroken and hasn't had the default

1341
00:55:44,220 --> 00:55:46,830
credentials changed it will log in and

1342
00:55:46,830 --> 00:55:48,870
extract the address book the SMS and the

1343
00:55:48,870 --> 00:55:51,480
the photos from the device store them

1344
00:55:51,480 --> 00:55:53,610
within greedy BTS so that I can recover

1345
00:55:53,610 --> 00:55:54,210
them later

1346
00:55:54,210 --> 00:55:56,750
you could also try to use the Android

1347
00:55:56,750 --> 00:55:59,100
JavaScript interface by injecting that

1348
00:55:59,100 --> 00:56:02,700
into into a web browsing session and but

1349
00:56:02,700 --> 00:56:04,500
the the one thing I'll say is it does

1350
00:56:04,500 --> 00:56:06,060
take a significant amount of time I mean

1351
00:56:06,060 --> 00:56:08,160
for instance to extract a couple of

1352
00:56:08,160 --> 00:56:10,410
photos can take several hours because of

1353
00:56:10,410 --> 00:56:11,760
these speeds at which you're operating

1354
00:56:11,760 --> 00:56:14,220
it's not such a big deal if you place a

1355
00:56:14,220 --> 00:56:15,930
device like this inside of a target's

1356
00:56:15,930 --> 00:56:17,580
home environment or their office

1357
00:56:17,580 --> 00:56:18,750
environment or an area where they're

1358
00:56:18,750 --> 00:56:21,690
going to spend a lot of time and then

1359
00:56:21,690 --> 00:56:23,940
hopefully we'll just see so it's it's

1360
00:56:23,940 --> 00:56:25,890
okay so here we can see that it says the

1361
00:56:25,890 --> 00:56:27,830
host is alive so it sent a ping packet

1362
00:56:27,830 --> 00:56:30,020
got the host being alive and then it's

1363
00:56:30,020 --> 00:56:31,580
going to essentially try to do this

1364
00:56:31,580 --> 00:56:34,430
SSH login and that will just continually

1365
00:56:34,430 --> 00:56:35,720
run in the background so every time it

1366
00:56:35,720 --> 00:56:36,890
sees an iDevice it will just

1367
00:56:36,890 --> 00:56:38,570
systematically keep trying this exploit

1368
00:56:38,570 --> 00:56:43,550
against it I guess we can leave that

1369
00:56:43,550 --> 00:56:45,320
running there for now just to see if it

1370
00:56:45,320 --> 00:56:49,940
actually completes and I'll get to the

1371
00:56:49,940 --> 00:56:52,600
conclusion

1372
00:57:01,450 --> 00:57:04,169
there you go

1373
00:57:05,720 --> 00:57:10,730
okay so this is kind of basically the

1374
00:57:10,730 --> 00:57:12,380
conclusions that I wanted to make from

1375
00:57:12,380 --> 00:57:14,120
this is that the information that sent

1376
00:57:14,120 --> 00:57:15,680
over your mobile phone is probably not

1377
00:57:15,680 --> 00:57:18,020
as secure as you think it might be and

1378
00:57:18,020 --> 00:57:20,990
the fact that gsm attacks have been

1379
00:57:20,990 --> 00:57:22,790
around for some time we still have very

1380
00:57:22,790 --> 00:57:24,920
little in the way of defensive

1381
00:57:24,920 --> 00:57:27,230
mechanisms that are widely used the ones

1382
00:57:27,230 --> 00:57:29,420
that are in use are really more aimed at

1383
00:57:29,420 --> 00:57:32,060
power users or people that are very

1384
00:57:32,060 --> 00:57:34,520
technologically minded they also require

1385
00:57:34,520 --> 00:57:36,590
active use and not all of them are going

1386
00:57:36,590 --> 00:57:37,520
to be very effective

1387
00:57:37,520 --> 00:57:40,400
the only real surefire guaranteed way of

1388
00:57:40,400 --> 00:57:41,870
detecting if someone is intercepting is

1389
00:57:41,870 --> 00:57:44,000
is to make one call on your original

1390
00:57:44,000 --> 00:57:46,010
network test if encryption is there and

1391
00:57:46,010 --> 00:57:47,870
then make a call on the fake environment

1392
00:57:47,870 --> 00:57:49,040
and then see whether encryption was

1393
00:57:49,040 --> 00:57:50,990
turned off or not and that only really

1394
00:57:50,990 --> 00:57:52,490
works if someone's interested in your

1395
00:57:52,490 --> 00:57:54,260
call content they could also be trying

1396
00:57:54,260 --> 00:57:55,700
to get access to your data which is

1397
00:57:55,700 --> 00:57:57,470
using a different encryption which is

1398
00:57:57,470 --> 00:57:58,760
going to be using different protocols

1399
00:57:58,760 --> 00:58:00,740
within that and it's still going to

1400
00:58:00,740 --> 00:58:01,940
still going to essentially expose

1401
00:58:01,940 --> 00:58:03,860
information that you may not have

1402
00:58:03,860 --> 00:58:06,350
thought you were exposing if you're

1403
00:58:06,350 --> 00:58:08,270
sending sensitive information such as

1404
00:58:08,270 --> 00:58:10,700
usernames passwords or other material

1405
00:58:10,700 --> 00:58:11,840
then I would consider not using the

1406
00:58:11,840 --> 00:58:14,360
wireless technology horse messenger

1407
00:58:14,360 --> 00:58:17,450
sometimes works or you you could

1408
00:58:17,450 --> 00:58:19,210
basically yeah send it in another way

1409
00:58:19,210 --> 00:58:21,620
and an attacker could basically use

1410
00:58:21,620 --> 00:58:23,240
these environments to launch attacks

1411
00:58:23,240 --> 00:58:25,010
against your mobile device without you

1412
00:58:25,010 --> 00:58:27,770
being aware and that we really do need

1413
00:58:27,770 --> 00:58:30,800
to push on for increased baseband

1414
00:58:30,800 --> 00:58:32,480
security enhancements and access to

1415
00:58:32,480 --> 00:58:34,850
cellular data so my email address and

1416
00:58:34,850 --> 00:58:37,820
context is here I'm going to open up for

1417
00:58:37,820 --> 00:58:40,550
a few questions now and I just wanted to

1418
00:58:40,550 --> 00:58:42,920
very quickly say thank you to all the

1419
00:58:42,920 --> 00:58:44,900
people that are in out there doing open

1420
00:58:44,900 --> 00:58:46,880
source and general security research

1421
00:58:46,880 --> 00:58:48,680
communities in making these kinds of

1422
00:58:48,680 --> 00:58:49,970
environments and tools and things more

1423
00:58:49,970 --> 00:58:52,400
accessible so that I could look at the

1424
00:58:52,400 --> 00:58:54,500
impacts and effects of them within a

1425
00:58:54,500 --> 00:58:56,480
kind of contained environment and in

1426
00:58:56,480 --> 00:58:58,850
particular a note to NWR labs who and I

1427
00:58:58,850 --> 00:59:00,980
started doing some of this research when

1428
00:59:00,980 --> 00:59:03,050
I was working there and then also the

1429
00:59:03,050 --> 00:59:04,730
Osmo comm and range network guys who

1430
00:59:04,730 --> 00:59:06,500
have been pretty awesome in some of the

1431
00:59:06,500 --> 00:59:10,090
tools and utilities that they've created

1432
00:59:10,380 --> 00:59:20,989
[Applause]

