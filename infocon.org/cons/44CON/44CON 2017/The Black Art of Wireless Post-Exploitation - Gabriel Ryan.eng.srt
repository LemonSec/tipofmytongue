1
00:00:00,199 --> 00:00:06,120
<font color="#CCCCCC">all right</font><font color="#E5E5E5"> so show of hands he wants to</font>

2
00:00:03,120 --> 00:00:09,480
<font color="#E5E5E5">get</font><font color="#CCCCCC"> started</font><font color="#E5E5E5"> like right now okay cool</font>

3
00:00:06,120 --> 00:00:11,309
<font color="#CCCCCC">cool</font><font color="#E5E5E5"> good stuff so my name is</font><font color="#CCCCCC"> Gabriel</font>

4
00:00:09,480 --> 00:00:13,049
Ryan I'm a security engineer at Gotham

5
00:00:11,309 --> 00:00:13,649
digital science<font color="#E5E5E5"> our New York office not</font>

6
00:00:13,049 --> 00:00:17,279
<font color="#E5E5E5">the London office</font>

7
00:00:13,650 --> 00:00:18,390
I don't think itself but<font color="#E5E5E5"> so a couple new</font>

8
00:00:17,279 --> 00:00:20,279
<font color="#CCCCCC">things in</font><font color="#E5E5E5"> this presentation we're gonna</font>

9
00:00:18,390 --> 00:00:22,410
be talking about hostile portal attacks

10
00:00:20,279 --> 00:00:23,880
<font color="#E5E5E5">which</font><font color="#CCCCCC"> it's a it's like</font><font color="#E5E5E5"> a variation</font><font color="#CCCCCC"> of a</font>

11
00:00:22,410 --> 00:00:25,470
<font color="#E5E5E5">row BP attack which lets you steal</font>

12
00:00:23,880 --> 00:00:27,210
Active Directory<font color="#CCCCCC"> consoles without direct</font>

13
00:00:25,470 --> 00:00:28,470
network<font color="#E5E5E5"> access and we're also going to</font>

14
00:00:27,210 --> 00:00:30,900
look at indirect<font color="#CCCCCC"> wireless pivots which</font>

15
00:00:28,470 --> 00:00:32,098
is a way<font color="#CCCCCC"> of</font><font color="#E5E5E5"> using Rho VP attacks</font><font color="#CCCCCC"> to as</font>

16
00:00:30,900 --> 00:00:34,620
part of a kill chain that can<font color="#E5E5E5"> let you</font>

17
00:00:32,098 --> 00:00:37,199
<font color="#CCCCCC">buy passport based access controls on</font>

18
00:00:34,620 --> 00:00:38,669
<font color="#E5E5E5">wireless</font><font color="#CCCCCC"> networks so before we talk</font>

19
00:00:37,200 --> 00:00:40,230
about<font color="#E5E5E5"> anything any of this we actually</font>

20
00:00:38,670 --> 00:00:41,190
<font color="#CCCCCC">have to</font><font color="#E5E5E5"> make like an obligatory kind of</font>

21
00:00:40,230 --> 00:00:44,610
stop and talk<font color="#E5E5E5"> about</font>

22
00:00:41,190 --> 00:00:46,739
wpa2 EAP<font color="#CCCCCC"> you know so we're gonna blaze</font>

23
00:00:44,610 --> 00:00:48,030
<font color="#E5E5E5">through this because</font><font color="#CCCCCC"> we don't have to</font>

24
00:00:46,739 --> 00:00:49,800
too much<font color="#E5E5E5"> time but you</font><font color="#CCCCCC"> know before</font>

25
00:00:48,030 --> 00:00:51,270
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about wpa2 EAP we also have to</font>

26
00:00:49,800 --> 00:00:52,589
talk<font color="#E5E5E5"> about</font><font color="#CCCCCC"> Rho VP</font><font color="#E5E5E5"> attacks because that's</font>

27
00:00:51,270 --> 00:00:54,930
traditionally the method you'd use<font color="#CCCCCC"> for</font>

28
00:00:52,590 --> 00:00:56,160
attacking<font color="#E5E5E5"> these types of networks so Rho</font>

29
00:00:54,930 --> 00:00:57,510
<font color="#E5E5E5">VP attacks they're pretty much the bread</font>

30
00:00:56,160 --> 00:00:59,459
and<font color="#E5E5E5"> butter of modern wireless</font>

31
00:00:57,510 --> 00:01:00,449
penetration tests using<font color="#E5E5E5"> for stealthy</font>

32
00:00:59,460 --> 00:01:01,739
man-in-the-middle attacks you can use

33
00:01:00,449 --> 00:01:04,018
them<font color="#CCCCCC"> for</font><font color="#E5E5E5"> stealing radius credentials all</font>

34
00:01:01,739 --> 00:01:06,479
kinds of cool stuff<font color="#E5E5E5"> the most basic form</font>

35
00:01:04,019 --> 00:01:07,890
<font color="#CCCCCC">is known as an evil twin attack</font><font color="#E5E5E5"> and the</font>

36
00:01:06,479 --> 00:01:10,979
way that it works if<font color="#E5E5E5"> you see here we</font>

37
00:01:07,890 --> 00:01:11,880
have<font color="#CCCCCC"> this you know this diagram</font><font color="#E5E5E5"> and you</font>

38
00:01:10,979 --> 00:01:13,710
know you<font color="#E5E5E5"> notice you have</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> these</font>

39
00:01:11,880 --> 00:01:15,630
devices<font color="#CCCCCC"> in</font><font color="#E5E5E5"> are connected this access</font>

40
00:01:13,710 --> 00:01:19,048
point<font color="#CCCCCC"> that's operating with</font><font color="#E5E5E5"> the BS the</font>

41
00:01:15,630 --> 00:01:20,610
SSID<font color="#E5E5E5"> 44</font><font color="#CCCCCC"> con Wi-Fi on channel 6 so if an</font>

42
00:01:19,049 --> 00:01:22,350
attacker were to<font color="#E5E5E5"> create you know his or</font>

43
00:01:20,610 --> 00:01:24,299
her<font color="#CCCCCC"> own you</font><font color="#E5E5E5"> know hotspot with the same</font>

44
00:01:22,350 --> 00:01:25,350
<font color="#CCCCCC">es ID</font><font color="#E5E5E5"> the question is how would these</font>

45
00:01:24,299 --> 00:01:27,659
devices be able to tell the difference

46
00:01:25,350 --> 00:01:29,339
<font color="#CCCCCC">between</font><font color="#E5E5E5"> the legitimate</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> point and</font>

47
00:01:27,659 --> 00:01:30,810
<font color="#E5E5E5">the attackers access point and actually</font>

48
00:01:29,340 --> 00:01:32,310
<font color="#E5E5E5">really</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> boils</font><font color="#CCCCCC"> down to a competition</font>

49
00:01:30,810 --> 00:01:35,040
between signal strength<font color="#E5E5E5"> and</font><font color="#CCCCCC"> signal to</font>

50
00:01:32,310 --> 00:01:36,360
<font color="#E5E5E5">note and</font><font color="#CCCCCC"> signal-to-noise ratio so if the</font>

51
00:01:35,040 --> 00:01:38,549
attacker is<font color="#E5E5E5"> able to</font><font color="#CCCCCC"> overpower the</font>

52
00:01:36,360 --> 00:01:39,450
legitimate<font color="#E5E5E5"> explain that way the the</font>

53
00:01:38,549 --> 00:01:41,460
devices<font color="#E5E5E5"> work should</font><font color="#CCCCCC"> drop their</font>

54
00:01:39,450 --> 00:01:42,530
associations with the<font color="#E5E5E5"> legitimate access</font>

55
00:01:41,460 --> 00:01:45,630
<font color="#E5E5E5">point and connect to the attacker</font>

56
00:01:42,530 --> 00:01:46,920
<font color="#E5E5E5">causing him and the middle so I mean</font>

57
00:01:45,630 --> 00:01:47,750
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> a new attack I</font><font color="#CCCCCC"> mean</font><font color="#E5E5E5"> this is</font>

58
00:01:46,920 --> 00:01:49,649
<font color="#CCCCCC">something</font><font color="#E5E5E5"> that's been around since</font>

59
00:01:47,750 --> 00:01:51,479
probably before the<font color="#E5E5E5"> earliest</font><font color="#CCCCCC"> reference</font>

60
00:01:49,649 --> 00:01:53,850
that<font color="#E5E5E5"> I could find to it which was this</font>

61
00:01:51,479 --> 00:01:57,149
this<font color="#CCCCCC"> Wireless LAN</font><font color="#E5E5E5"> security fact by</font>

62
00:01:53,850 --> 00:01:59,189
CW<font color="#E5E5E5"> Klaus back in 2002 in 2003 you know</font>

63
00:01:57,149 --> 00:02:01,560
the<font color="#E5E5E5"> the infamous asleep came out was</font>

64
00:01:59,189 --> 00:02:03,479
built by Josh right<font color="#E5E5E5"> 2004 he started to</font>

65
00:02:01,560 --> 00:02:05,460
seek armed attacks<font color="#E5E5E5"> it's a new variation</font>

66
00:02:03,479 --> 00:02:07,890
<font color="#CCCCCC">of the rogue ap attack</font><font color="#E5E5E5"> and that was a</font>

67
00:02:05,460 --> 00:02:09,239
<font color="#E5E5E5">dino des</font><font color="#CCCCCC"> Eaux V and Shane McCauley</font><font color="#E5E5E5"> 2008</font>

68
00:02:07,890 --> 00:02:11,730
you actually<font color="#E5E5E5"> starts seeing free radius</font>

69
00:02:09,239 --> 00:02:13,950
WP which is<font color="#E5E5E5"> this tool it was released by</font>

70
00:02:11,730 --> 00:02:15,569
<font color="#E5E5E5">Tritan</font><font color="#CCCCCC"> brentano</font><font color="#E5E5E5"> wits and this is when</font>

71
00:02:13,950 --> 00:02:18,869
you start<font color="#CCCCCC"> seeing real VP attacks used as</font>

72
00:02:15,569 --> 00:02:20,640
a<font color="#E5E5E5"> method of breaching wpa2 EAP networks</font>

73
00:02:18,870 --> 00:02:22,890
<font color="#E5E5E5">you know and then you know finally in</font>

74
00:02:20,640 --> 00:02:24,779
<font color="#E5E5E5">2014</font><font color="#CCCCCC"> you have the improved karma attacks</font>

75
00:02:22,890 --> 00:02:26,909
<font color="#E5E5E5">by</font><font color="#CCCCCC"> Dom</font><font color="#E5E5E5"> Wahine Devilliers from sense</font><font color="#CCCCCC"> post</font>

76
00:02:24,780 --> 00:02:28,140
<font color="#CCCCCC">and you know that by this point</font><font color="#E5E5E5"> in karma</font>

77
00:02:26,909 --> 00:02:30,480
attacks<font color="#E5E5E5"> we become less</font><font color="#CCCCCC"> effective so they</font>

78
00:02:28,140 --> 00:02:33,238
were able<font color="#E5E5E5"> to kind of you know</font><font color="#CCCCCC"> bypass 11</font>

79
00:02:30,480 --> 00:02:34,470
mitigations that client devices had had

80
00:02:33,239 --> 00:02:35,940
developed<font color="#E5E5E5"> over the years and make them</font>

81
00:02:34,470 --> 00:02:38,700
more effective again<font color="#E5E5E5"> and actually very</font>

82
00:02:35,940 --> 00:02:41,280
<font color="#E5E5E5">recently 2017 we had the lure</font><font color="#CCCCCC"> 10 attack</font>

83
00:02:38,700 --> 00:02:42,450
by the guy here<font color="#CCCCCC"> at Wi-Fi Fisher that's a</font>

84
00:02:41,280 --> 00:02:45,720
pretty cool<font color="#E5E5E5"> tool she go check that</font><font color="#CCCCCC"> out</font>

85
00:02:42,450 --> 00:02:48,599
too<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that exploits the Wi-Fi sense</font>

86
00:02:45,720 --> 00:02:49,920
capability<font color="#E5E5E5"> that's built into you know we</font>

87
00:02:48,599 --> 00:02:51,209
<font color="#CCCCCC">dose and the cool thing about that</font>

88
00:02:49,920 --> 00:02:52,858
attack is<font color="#CCCCCC"> that Microsoft</font><font color="#E5E5E5"> doesn't seem to</font>

89
00:02:51,209 --> 00:02:55,920
care<font color="#CCCCCC"> about it so it's gonna be</font><font color="#E5E5E5"> around</font>

90
00:02:52,859 --> 00:02:57,629
for a<font color="#CCCCCC"> while</font><font color="#E5E5E5"> so but the common trend here</font>

91
00:02:55,920 --> 00:02:58,768
is<font color="#E5E5E5"> that with all these attacks they kind</font>

92
00:02:57,629 --> 00:02:59,760
of fall into two categories no rogue

93
00:02:58,769 --> 00:03:03,090
<font color="#CCCCCC">eight-piece</font><font color="#E5E5E5"> actually had traditionally</font>

94
00:02:59,760 --> 00:03:04,858
<font color="#E5E5E5">been used as a method</font><font color="#CCCCCC"> of stealing</font>

95
00:03:03,090 --> 00:03:07,470
credentials<font color="#E5E5E5"> via man the middle attack or</font>

96
00:03:04,859 --> 00:03:09,030
they've been<font color="#E5E5E5"> used for breaching EAP</font>

97
00:03:07,470 --> 00:03:09,930
networks we're gonna<font color="#E5E5E5"> just look a little</font>

98
00:03:09,030 --> 00:03:11,430
different here<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> gonna talk</font><font color="#CCCCCC"> about</font>

99
00:03:09,930 --> 00:03:16,889
<font color="#CCCCCC">about rogue</font><font color="#E5E5E5"> ap it's actually means a</font>

100
00:03:11,430 --> 00:03:18,690
lateral movement so<font color="#E5E5E5"> you know just a</font>

101
00:03:16,889 --> 00:03:20,459
<font color="#CCCCCC">little more background information</font><font color="#E5E5E5"> for</font>

102
00:03:18,690 --> 00:03:22,650
<font color="#CCCCCC">those of you who are intimately familiar</font>

103
00:03:20,459 --> 00:03:24,510
<font color="#E5E5E5">with EAP aka extensible authentication</font>

104
00:03:22,650 --> 00:03:25,769
protocol<font color="#CCCCCC"> I know this</font><font color="#E5E5E5"> a little bit of</font>

105
00:03:24,510 --> 00:03:27,510
simplification we're gonna go<font color="#E5E5E5"> more in</font>

106
00:03:25,769 --> 00:03:29,250
<font color="#E5E5E5">depth in a second</font><font color="#CCCCCC"> but logically</font>

107
00:03:27,510 --> 00:03:31,260
authentication occurs when<font color="#CCCCCC"> you're talk</font>

108
00:03:29,250 --> 00:03:34,019
about EAP we're gonna be<font color="#E5E5E5"> focusing by the</font>

109
00:03:31,260 --> 00:03:36,388
way on EEP EEP EEP and<font color="#E5E5E5"> EPT TLS</font><font color="#CCCCCC"> for this</font>

110
00:03:34,019 --> 00:03:38,010
talk<font color="#E5E5E5"> primarily so</font><font color="#CCCCCC"> if eep eep eep in the</font>

111
00:03:36,389 --> 00:03:40,620
apt TLS<font color="#E5E5E5"> authentication occurs between</font>

112
00:03:38,010 --> 00:03:43,440
<font color="#E5E5E5">the supplicant and the and also the</font>

113
00:03:40,620 --> 00:03:44,669
authentication<font color="#CCCCCC"> server</font><font color="#E5E5E5"> and and you kind</font>

114
00:03:43,440 --> 00:03:46,739
of have<font color="#E5E5E5"> this</font><font color="#CCCCCC"> situation</font><font color="#E5E5E5"> that looks like</font>

115
00:03:44,669 --> 00:03:48,480
<font color="#E5E5E5">this right you have this client also</font>

116
00:03:46,739 --> 00:03:50,010
known as the supplicant<font color="#CCCCCC"> that's that's</font>

117
00:03:48,480 --> 00:03:51,599
your wireless device and it's<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> send</font>

118
00:03:50,010 --> 00:03:52,858
an authentication<font color="#E5E5E5"> request to the other</font>

119
00:03:51,599 --> 00:03:53,790
<font color="#E5E5E5">indication server that's your radius</font>

120
00:03:52,859 --> 00:03:55,319
server that's running somewhere in your

121
00:03:53,790 --> 00:03:57,090
network the radius<font color="#E5E5E5"> server then will</font>

122
00:03:55,319 --> 00:03:58,918
respond with an x.509 certificate and

123
00:03:57,090 --> 00:04:00,690
the idea here is<font color="#CCCCCC"> that the</font><font color="#E5E5E5"> excellent</font><font color="#CCCCCC"> 5:09</font>

124
00:03:58,919 --> 00:04:03,660
<font color="#E5E5E5">certificate is used to prove the</font>

125
00:04:00,690 --> 00:04:05,220
<font color="#CCCCCC">identity of the authentication server to</font>

126
00:04:03,660 --> 00:04:06,959
the client<font color="#CCCCCC"> so at this point if the</font>

127
00:04:05,220 --> 00:04:09,480
client actually accepts a certificate a

128
00:04:06,959 --> 00:04:10,739
<font color="#E5E5E5">secure tiles established and you</font><font color="#CCCCCC"> move on</font>

129
00:04:09,480 --> 00:04:11,910
<font color="#CCCCCC">from the outer authentication which is</font>

130
00:04:10,739 --> 00:04:13,949
where we were before<font color="#E5E5E5"> at the inner</font>

131
00:04:11,910 --> 00:04:15,000
authentication<font color="#E5E5E5"> which is where he</font><font color="#CCCCCC"> started</font>

132
00:04:13,949 --> 00:04:16,260
seeing<font color="#E5E5E5"> you know the credentials passed</font>

133
00:04:15,000 --> 00:04:20,010
back and<font color="#E5E5E5"> forth and</font><font color="#CCCCCC"> that happens through</font>

134
00:04:16,260 --> 00:04:21,839
<font color="#CCCCCC">the secure tunnel now</font><font color="#E5E5E5"> the reason why</font>

135
00:04:20,010 --> 00:04:23,610
<font color="#E5E5E5">they're there is a secure</font><font color="#CCCCCC"> tunnel in the</font>

136
00:04:21,839 --> 00:04:24,859
first place is because without<font color="#E5E5E5"> it</font>

137
00:04:23,610 --> 00:04:26,569
<font color="#E5E5E5">remember that</font><font color="#CCCCCC"> you know</font>

138
00:04:24,860 --> 00:04:28,189
using EAP is<font color="#E5E5E5"> an authentication mechanism</font>

139
00:04:26,569 --> 00:04:30,050
to provide access to the WPA

140
00:04:28,189 --> 00:04:31,460
capabilities of the network<font color="#E5E5E5"> that means</font>

141
00:04:30,050 --> 00:04:33,289
that before<font color="#E5E5E5"> you complete</font><font color="#CCCCCC"> that EAP</font>

142
00:04:31,460 --> 00:04:34,489
authentication process<font color="#E5E5E5"> everything is</font>

143
00:04:33,289 --> 00:04:36,680
still basically happening<font color="#E5E5E5"> over up in</font>

144
00:04:34,490 --> 00:04:38,629
Wi-Fi<font color="#CCCCCC"> so I mean that's</font><font color="#E5E5E5"> a problem because</font>

145
00:04:36,680 --> 00:04:40,039
without that secure<font color="#E5E5E5"> tunnel you can just</font>

146
00:04:38,629 --> 00:04:42,740
snip<font color="#CCCCCC"> you'd be able to just sniff that</font>

147
00:04:40,039 --> 00:04:44,330
that whole process off<font color="#E5E5E5"> passively and and</font>

148
00:04:42,740 --> 00:04:46,030
and crack credentials offline in fact

149
00:04:44,330 --> 00:04:48,469
legacy implementations of EAP

150
00:04:46,030 --> 00:04:52,250
<font color="#CCCCCC">specifically ones that used</font><font color="#E5E5E5"> you PMD</font><font color="#CCCCCC"> five</font>

151
00:04:48,469 --> 00:04:54,080
<font color="#CCCCCC">were very susceptible to this so the</font>

152
00:04:52,250 --> 00:04:56,330
complete picture<font color="#CCCCCC"> you know we</font><font color="#E5E5E5"> kind of</font>

153
00:04:54,080 --> 00:04:57,800
looked<font color="#CCCCCC"> at the overview</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> AP you have a</font>

154
00:04:56,330 --> 00:04:59,810
supplicant<font color="#CCCCCC"> or the wireless device</font>

155
00:04:57,800 --> 00:05:01,520
yeah the authentication server<font color="#CCCCCC"> but then</font>

156
00:04:59,810 --> 00:05:02,900
you also<font color="#E5E5E5"> have the access point but which</font>

157
00:05:01,520 --> 00:05:05,479
in the<font color="#E5E5E5"> RFC is us to find us the</font>

158
00:05:02,900 --> 00:05:07,128
Authenticator and and and the<font color="#CCCCCC"> goal of</font>

159
00:05:05,479 --> 00:05:08,419
the the role<font color="#CCCCCC"> of the access point is to</font>

160
00:05:07,129 --> 00:05:09,590
serve as an<font color="#E5E5E5"> intermediary because you</font>

161
00:05:08,419 --> 00:05:11,628
know that the<font color="#CCCCCC"> supplicant can only speak</font>

162
00:05:09,590 --> 00:05:12,710
layer 2 and the<font color="#E5E5E5"> radius server needs to</font>

163
00:05:11,629 --> 00:05:14,509
<font color="#E5E5E5">be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> speak radius which is up</font><font color="#E5E5E5"> on</font>

164
00:05:12,710 --> 00:05:16,430
layer<font color="#E5E5E5"> 7</font><font color="#CCCCCC"> say this access point that's</font>

165
00:05:14,509 --> 00:05:18,169
<font color="#CCCCCC">kind of in between and</font><font color="#E5E5E5"> and passing all</font>

166
00:05:16,430 --> 00:05:20,449
this stuff back and<font color="#CCCCCC"> forth</font><font color="#E5E5E5"> remember this</font>

167
00:05:18,169 --> 00:05:21,620
is an open access point so<font color="#CCCCCC"> the complete</font>

168
00:05:20,449 --> 00:05:25,009
diagram<font color="#E5E5E5"> should really look</font><font color="#CCCCCC"> like this</font>

169
00:05:21,620 --> 00:05:28,159
right so the problem<font color="#CCCCCC"> with</font><font color="#E5E5E5"> this situation</font>

170
00:05:25,009 --> 00:05:29,779
remember is that is that<font color="#CCCCCC"> remember we</font>

171
00:05:28,159 --> 00:05:31,250
mentioned that open access points are

172
00:05:29,779 --> 00:05:34,370
susceptible to evil twin attacks or

173
00:05:31,250 --> 00:05:36,979
rogue ap attacks in general so in in

174
00:05:34,370 --> 00:05:39,050
<font color="#E5E5E5">this case we have the the x.509</font>

175
00:05:36,979 --> 00:05:40,699
certificate<font color="#E5E5E5"> if an attacker is</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

176
00:05:39,050 --> 00:05:42,319
use an evil twin attack but this time

177
00:05:40,699 --> 00:05:46,039
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> doing it with</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> open access</font>

178
00:05:42,319 --> 00:05:48,259
point they clone a a wpa2 EAP network

179
00:05:46,039 --> 00:05:50,000
that uses p-party TLS or something

180
00:05:48,259 --> 00:05:52,550
<font color="#E5E5E5">before that</font>

181
00:05:50,000 --> 00:05:54,139
what will<font color="#E5E5E5"> happen is that the the victim</font>

182
00:05:52,550 --> 00:05:55,610
<font color="#E5E5E5">client device will be forced again to</font>

183
00:05:54,139 --> 00:05:56,870
the attacker<font color="#E5E5E5"> they'll send it</font><font color="#CCCCCC"> out then</font>

184
00:05:55,610 --> 00:05:58,219
<font color="#CCCCCC">occation</font><font color="#E5E5E5"> request to the attacker and</font><font color="#CCCCCC"> the</font>

185
00:05:56,870 --> 00:06:00,020
attacker<font color="#E5E5E5"> then responds with</font><font color="#CCCCCC"> either like</font>

186
00:05:58,219 --> 00:06:01,729
a like something they use a rogue state

187
00:06:00,020 --> 00:06:03,378
<font color="#E5E5E5">CA to create a</font><font color="#CCCCCC"> certificate or self</font>

188
00:06:01,729 --> 00:06:04,099
signed certificate<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> gets</font><font color="#E5E5E5"> sent</font>

189
00:06:03,379 --> 00:06:06,289
back<font color="#E5E5E5"> to the client</font>

190
00:06:04,099 --> 00:06:08,210
now something at this<font color="#CCCCCC"> point it's pretty</font>

191
00:06:06,289 --> 00:06:10,938
much up to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> client to either</font><font color="#E5E5E5"> accept</font>

192
00:06:08,210 --> 00:06:12,500
or<font color="#E5E5E5"> reject the the cert if the</font><font color="#CCCCCC"> scientist</font>

193
00:06:10,939 --> 00:06:14,060
that<font color="#E5E5E5"> the client rejects the cert</font>

194
00:06:12,500 --> 00:06:16,430
everything is good but the<font color="#CCCCCC"> problem is</font>

195
00:06:14,060 --> 00:06:18,979
that<font color="#CCCCCC"> that</font><font color="#E5E5E5"> often doesn't</font><font color="#CCCCCC"> happen</font><font color="#E5E5E5"> so if the</font>

196
00:06:16,430 --> 00:06:20,330
<font color="#CCCCCC">client accepts</font><font color="#E5E5E5"> that x.509 certificate it</font>

197
00:06:18,979 --> 00:06:22,128
<font color="#CCCCCC">actually will proceed to perform</font><font color="#E5E5E5"> that</font>

198
00:06:20,330 --> 00:06:23,568
<font color="#CCCCCC">intern authentication through that</font>

199
00:06:22,129 --> 00:06:25,370
<font color="#E5E5E5">secured tunnel with</font><font color="#CCCCCC"> the attacker</font><font color="#E5E5E5"> and</font>

200
00:06:23,569 --> 00:06:26,719
that gives the the attacker a challenge

201
00:06:25,370 --> 00:06:29,240
in response to can be<font color="#CCCCCC"> tracked offline to</font>

202
00:06:26,719 --> 00:06:30,379
obtain<font color="#CCCCCC"> read</font><font color="#E5E5E5"> his credentials once</font><font color="#CCCCCC"> again</font>

203
00:06:29,240 --> 00:06:34,259
this is<font color="#E5E5E5"> not a new attack this has</font>

204
00:06:30,379 --> 00:06:37,930
existed<font color="#CCCCCC"> since 2008 and and</font>

205
00:06:34,259 --> 00:06:39,550
so it's pretty widespread<font color="#E5E5E5"> so to make</font>

206
00:06:37,930 --> 00:06:41,169
matters<font color="#CCCCCC"> worse right it's not just the</font>

207
00:06:39,550 --> 00:06:44,199
the<font color="#E5E5E5"> inter authentication protocol used</font>

208
00:06:41,169 --> 00:06:46,710
by EAP<font color="#CCCCCC"> peope it is MS Chaffee</font><font color="#E5E5E5"> - and</font>

209
00:06:44,199 --> 00:06:50,560
anyone here familiar with<font color="#CCCCCC"> MS</font><font color="#E5E5E5"> Chaffee -</font>

210
00:06:46,710 --> 00:06:51,789
all right well it's it's it's<font color="#CCCCCC"> absolutely</font>

211
00:06:50,560 --> 00:06:52,660
wonderful it's wonderful - wonderful<font color="#E5E5E5"> -</font>

212
00:06:51,789 --> 00:06:54,789
<font color="#E5E5E5">wonderful and the reason why it's</font>

213
00:06:52,660 --> 00:06:56,500
<font color="#CCCCCC">wonderful is that so I mean you could</font>

214
00:06:54,789 --> 00:06:58,060
<font color="#CCCCCC">just go</font><font color="#E5E5E5"> about the traditional way that</font>

215
00:06:56,500 --> 00:06:59,440
you'd crack these<font color="#CCCCCC"> challenged with</font><font color="#E5E5E5"> the</font>

216
00:06:58,060 --> 00:07:01,449
<font color="#E5E5E5">mschap you to challenge</font><font color="#CCCCCC"> a response</font><font color="#E5E5E5"> that</font>

217
00:06:59,440 --> 00:07:02,650
you capture using<font color="#CCCCCC"> this attack is using a</font>

218
00:07:01,449 --> 00:07:03,610
dictionary<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> so you just kind of</font>

219
00:07:02,650 --> 00:07:04,750
keep iterating through a bunch<font color="#CCCCCC"> of</font>

220
00:07:03,610 --> 00:07:06,400
passwords<font color="#E5E5E5"> until you find one that works</font>

221
00:07:04,750 --> 00:07:08,530
<font color="#E5E5E5">the problem is that's slow it's like you</font>

222
00:07:06,400 --> 00:07:09,940
know cracking<font color="#E5E5E5"> a</font><font color="#CCCCCC"> PSK Network where</font><font color="#E5E5E5"> you</font>

223
00:07:08,530 --> 00:07:11,049
kind of<font color="#E5E5E5"> have to sequentially try a bunch</font>

224
00:07:09,940 --> 00:07:13,800
of<font color="#E5E5E5"> things and if you have a really long</font>

225
00:07:11,050 --> 00:07:15,490
password<font color="#CCCCCC"> it could almost be unfeasible</font>

226
00:07:13,800 --> 00:07:18,039
<font color="#E5E5E5">fortunately or unfortunately depending</font>

227
00:07:15,490 --> 00:07:19,479
on your perspective<font color="#CCCCCC"> Ms Jaffe</font><font color="#E5E5E5"> - is also</font>

228
00:07:18,039 --> 00:07:21,880
vulnerable to divide and<font color="#CCCCCC"> conquer attack</font>

229
00:07:19,479 --> 00:07:24,070
<font color="#E5E5E5">Moxie Marlinspike</font><font color="#CCCCCC"> it's Marlinspike and</font>

230
00:07:21,880 --> 00:07:25,479
<font color="#E5E5E5">David Holton back in 2012</font><font color="#CCCCCC"> they</font>

231
00:07:24,070 --> 00:07:27,759
discovered the MS<font color="#CCCCCC"> Jeffy - actually is</font>

232
00:07:25,479 --> 00:07:29,560
the<font color="#E5E5E5"> same</font><font color="#CCCCCC"> 3des encryption then CLM v1</font>

233
00:07:27,759 --> 00:07:32,080
<font color="#CCCCCC">uses so</font><font color="#E5E5E5"> you can reduce it</font><font color="#CCCCCC"> to 56 bits of</font>

234
00:07:29,560 --> 00:07:33,099
<font color="#E5E5E5">encryption and with the right if you</font>

235
00:07:32,080 --> 00:07:34,449
<font color="#E5E5E5">shift your goal from instead of</font>

236
00:07:33,099 --> 00:07:36,580
recovering the<font color="#E5E5E5"> plaintext password to</font>

237
00:07:34,449 --> 00:07:40,599
recovering<font color="#CCCCCC"> the password equivalent NT</font>

238
00:07:36,580 --> 00:07:41,698
hash and<font color="#E5E5E5"> and use the the right</font><font color="#CCCCCC"> you know</font>

239
00:07:40,599 --> 00:07:44,050
<font color="#E5E5E5">usually</font><font color="#CCCCCC"> use like</font><font color="#E5E5E5"> proper a proper</font>

240
00:07:41,699 --> 00:07:45,940
<font color="#CCCCCC">fpga-based</font><font color="#E5E5E5"> cracking rig that's</font>

241
00:07:44,050 --> 00:07:48,460
<font color="#E5E5E5">sufficiently powerful you can</font><font color="#CCCCCC"> actually</font>

242
00:07:45,940 --> 00:07:49,740
achieve 100% success rate in cracking

243
00:07:48,460 --> 00:07:53,020
<font color="#E5E5E5">these things in less than 24 hours</font>

244
00:07:49,740 --> 00:07:54,780
<font color="#CCCCCC">actually funny fun fact</font><font color="#E5E5E5"> anyone here</font>

245
00:07:53,020 --> 00:07:56,948
familiar with<font color="#E5E5E5"> cloud cracker</font><font color="#CCCCCC"> remember it</font>

246
00:07:54,780 --> 00:07:58,210
<font color="#E5E5E5">yeah it's it's been superseded by</font>

247
00:07:56,949 --> 00:07:59,949
cracked<font color="#CCCCCC"> Auto sage but the folks that</font>

248
00:07:58,210 --> 00:08:02,530
<font color="#CCCCCC">crack Titus H will actually like crack</font>

249
00:07:59,949 --> 00:08:04,180
<font color="#E5E5E5">em as chappy - challenging responses for</font>

250
00:08:02,530 --> 00:08:08,638
free<font color="#E5E5E5"> within 24 hours because it's just</font>

251
00:08:04,180 --> 00:08:10,599
<font color="#CCCCCC">not a big</font><font color="#E5E5E5"> deal to them so quick demo of</font>

252
00:08:08,639 --> 00:08:11,440
of just<font color="#E5E5E5"> like what when these attacks</font>

253
00:08:10,599 --> 00:08:13,389
<font color="#E5E5E5">would look like</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> the attackers</font>

254
00:08:11,440 --> 00:08:16,570
perspective you have the attacker like

255
00:08:13,389 --> 00:08:18,370
is<font color="#CCCCCC"> is</font><font color="#E5E5E5"> creating this world</font><font color="#CCCCCC"> AP</font><font color="#E5E5E5"> and you're</font>

256
00:08:16,570 --> 00:08:20,949
gonna see a client device

257
00:08:18,370 --> 00:08:28,330
associate or<font color="#CCCCCC"> it simplify thank you</font><font color="#E5E5E5"> in a</font>

258
00:08:20,949 --> 00:08:29,979
second<font color="#E5E5E5"> and</font><font color="#CCCCCC"> yeah there we go and in a few</font>

259
00:08:28,330 --> 00:08:31,449
seconds<font color="#E5E5E5"> what you're gonna see is they're</font>

260
00:08:29,979 --> 00:08:33,909
gonna see an EP<font color="#CCCCCC"> Challenger response</font>

261
00:08:31,449 --> 00:08:36,010
right there as well as the<font color="#CCCCCC"> username it's</font>

262
00:08:33,909 --> 00:08:37,289
<font color="#CCCCCC">the EAP identity</font><font color="#E5E5E5"> it's gonna show up on</font>

263
00:08:36,010 --> 00:08:40,718
the<font color="#E5E5E5"> screen and that's the attacker</font>

264
00:08:37,289 --> 00:08:42,880
capturing that so I mean<font color="#E5E5E5"> this is a</font>

265
00:08:40,719 --> 00:08:44,620
pretty<font color="#E5E5E5"> old attack there there wasn't a</font>

266
00:08:42,880 --> 00:08:46,630
remediation<font color="#CCCCCC"> introduced to kind of</font><font color="#E5E5E5"> deal</font>

267
00:08:44,620 --> 00:08:48,080
with<font color="#CCCCCC"> this</font><font color="#E5E5E5"> and this was</font><font color="#CCCCCC"> EAP TLS</font><font color="#E5E5E5"> or I'm</font>

268
00:08:46,630 --> 00:08:49,640
<font color="#E5E5E5">sorry EAP TLS</font>

269
00:08:48,080 --> 00:08:50,690
and<font color="#CCCCCC"> you PT LS it's like really good</font>

270
00:08:49,640 --> 00:08:53,449
<font color="#CCCCCC">because it uses mutual authentication</font>

271
00:08:50,690 --> 00:08:55,640
using x.509 certificates for the outer

272
00:08:53,450 --> 00:08:56,720
authentication layer and and and and

273
00:08:55,640 --> 00:08:58,250
this you know<font color="#E5E5E5"> makes it really really</font>

274
00:08:56,720 --> 00:08:59,540
strong because<font color="#CCCCCC"> you know it kind of stops</font>

275
00:08:58,250 --> 00:09:02,450
those rogue<font color="#E5E5E5"> ap attacks dead in their</font>

276
00:08:59,540 --> 00:09:03,709
tracks unfortunately any any network

277
00:09:02,450 --> 00:09:06,230
administrators or recovering network

278
00:09:03,710 --> 00:09:06,590
<font color="#E5E5E5">administrators out there any show of</font>

279
00:09:06,230 --> 00:09:10,940
hands

280
00:09:06,590 --> 00:09:13,520
none<font color="#E5E5E5"> okay well so I mean the thing</font><font color="#CCCCCC"> about</font>

281
00:09:10,940 --> 00:09:15,080
like<font color="#E5E5E5"> ap TLS is it turned out to be</font>

282
00:09:13,520 --> 00:09:16,760
wildly unpopular<font color="#E5E5E5"> because you have to</font>

283
00:09:15,080 --> 00:09:19,670
<font color="#E5E5E5">have a search that you install</font><font color="#CCCCCC"> on every</font>

284
00:09:16,760 --> 00:09:21,710
<font color="#E5E5E5">single device on the network and you</font>

285
00:09:19,670 --> 00:09:23,510
<font color="#CCCCCC">know that's actually</font><font color="#E5E5E5"> like you know kind</font>

286
00:09:21,710 --> 00:09:24,740
of a pain to<font color="#E5E5E5"> do and it's even worse if</font>

287
00:09:23,510 --> 00:09:26,420
you're<font color="#E5E5E5"> like dealing with like an</font>

288
00:09:24,740 --> 00:09:30,140
industrial setting<font color="#E5E5E5"> or you're dealing</font>

289
00:09:26,420 --> 00:09:32,380
with a like a<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> like a like like</font>

290
00:09:30,140 --> 00:09:34,760
a hospital<font color="#CCCCCC"> and you have devices</font><font color="#E5E5E5"> where</font>

291
00:09:32,380 --> 00:09:37,010
they may<font color="#E5E5E5"> not</font><font color="#CCCCCC"> even be compatible a client</font>

292
00:09:34,760 --> 00:09:38,330
or<font color="#CCCCCC"> a service authentication so what it</font>

293
00:09:37,010 --> 00:09:40,100
<font color="#CCCCCC">does is it introduces</font><font color="#E5E5E5"> this classic</font>

294
00:09:38,330 --> 00:09:41,600
security<font color="#E5E5E5"> versus convenience scenario</font>

295
00:09:40,100 --> 00:09:43,880
where you know you kind of have as a

296
00:09:41,600 --> 00:09:47,000
network administrator<font color="#CCCCCC"> you're kind of</font>

297
00:09:43,880 --> 00:09:48,800
forced<font color="#E5E5E5"> to choose</font><font color="#CCCCCC"> between you know a</font>

298
00:09:47,000 --> 00:09:51,080
<font color="#E5E5E5">really secure authentication mechanism</font>

299
00:09:48,800 --> 00:09:52,750
the form of<font color="#E5E5E5"> EAP TLS</font><font color="#CCCCCC"> but it's also like</font>

300
00:09:51,080 --> 00:09:55,940
<font color="#CCCCCC">really difficult to use</font><font color="#E5E5E5"> or a really</font>

301
00:09:52,750 --> 00:09:57,800
insecure<font color="#CCCCCC"> up indication mechanism and the</font>

302
00:09:55,940 --> 00:10:00,410
form of eep eep eep but it's it's<font color="#E5E5E5"> it's</font>

303
00:09:57,800 --> 00:10:01,640
kind<font color="#CCCCCC"> of easier you know so naturally</font>

304
00:10:00,410 --> 00:10:02,480
this creates like a market<font color="#CCCCCC"> gap</font><font color="#E5E5E5"> you know</font>

305
00:10:01,640 --> 00:10:03,770
<font color="#CCCCCC">where you have</font><font color="#E5E5E5"> all these like you know</font>

306
00:10:02,480 --> 00:10:05,450
<font color="#CCCCCC">vendors that start</font><font color="#E5E5E5"> crawling out of the</font>

307
00:10:03,770 --> 00:10:07,880
woodwork<font color="#E5E5E5"> to</font><font color="#CCCCCC"> sell you this magic bullet</font>

308
00:10:05,450 --> 00:10:09,740
that can be used<font color="#E5E5E5"> to compensate for the</font>

309
00:10:07,880 --> 00:10:10,430
security issues introduced by<font color="#CCCCCC"> EPP bin</font>

310
00:10:09,740 --> 00:10:12,710
<font color="#E5E5E5">eap-tls</font>

311
00:10:10,430 --> 00:10:16,010
<font color="#E5E5E5">but are also easy to use and the current</font>

312
00:10:12,710 --> 00:10:17,690
<font color="#CCCCCC">of the current</font><font color="#E5E5E5"> trend in</font><font color="#CCCCCC"> that in that</font>

313
00:10:16,010 --> 00:10:20,150
<font color="#CCCCCC">area is to focus</font><font color="#E5E5E5"> on breach containment</font>

314
00:10:17,690 --> 00:10:21,560
<font color="#E5E5E5">instead of you know</font><font color="#CCCCCC"> trying to stop it</font>

315
00:10:20,150 --> 00:10:23,510
the attacker from actually gaining<font color="#CCCCCC"> ask</font>

316
00:10:21,560 --> 00:10:25,339
<font color="#E5E5E5">to the network you said kind of give up</font>

317
00:10:23,510 --> 00:10:26,600
on that and<font color="#E5E5E5"> and focus on making</font><font color="#CCCCCC"> sure</font>

318
00:10:25,340 --> 00:10:29,600
they can't do any damage<font color="#CCCCCC"> once they're</font>

319
00:10:26,600 --> 00:10:31,280
<font color="#E5E5E5">already on your network so the question</font>

320
00:10:29,600 --> 00:10:33,410
we're gonna<font color="#E5E5E5"> try to answer today is</font>

321
00:10:31,280 --> 00:10:36,220
<font color="#E5E5E5">whether this actually works</font><font color="#CCCCCC"> and we're</font>

322
00:10:33,410 --> 00:10:38,319
gonna<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of explore</font><font color="#E5E5E5"> that in depth and</font>

323
00:10:36,220 --> 00:10:41,540
before<font color="#E5E5E5"> continue I have</font><font color="#CCCCCC"> a nice</font><font color="#E5E5E5"> little</font>

324
00:10:38,320 --> 00:10:44,920
cartoon for you just a<font color="#E5E5E5"> foreshadowing of</font>

325
00:10:41,540 --> 00:10:47,649
things<font color="#CCCCCC"> to come</font>

326
00:10:44,920 --> 00:10:50,019
right so the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most popular approach</font>

327
00:10:47,649 --> 00:10:52,209
to breach containment<font color="#E5E5E5"> is is the use</font><font color="#CCCCCC"> of a</font>

328
00:10:50,019 --> 00:10:53,439
network access control appliance<font color="#E5E5E5"> you</font>

329
00:10:52,209 --> 00:10:54,758
know so that the way<font color="#E5E5E5"> that this is</font><font color="#CCCCCC"> gonna</font>

330
00:10:53,439 --> 00:10:56,349
<font color="#CCCCCC">work is that you have this this</font><font color="#E5E5E5"> hardware</font>

331
00:10:54,759 --> 00:10:58,059
appliance<font color="#CCCCCC"> that</font><font color="#E5E5E5"> as soon as the device is</font>

332
00:10:56,350 --> 00:10:59,470
<font color="#E5E5E5">added</font><font color="#CCCCCC"> to the network it distinguishes</font>

333
00:10:58,059 --> 00:11:03,669
between<font color="#E5E5E5"> unauthorized and authorized</font>

334
00:10:59,470 --> 00:11:05,049
endpoints<font color="#E5E5E5"> and you know so a new end</font>

335
00:11:03,669 --> 00:11:06,459
points out<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> network the</font><font color="#CCCCCC"> nak is</font>

336
00:11:05,049 --> 00:11:07,899
<font color="#CCCCCC">gonna do something to it to figure out</font>

337
00:11:06,459 --> 00:11:09,518
you know<font color="#E5E5E5"> if it's allowed there or not</font>

338
00:11:07,899 --> 00:11:10,929
<font color="#E5E5E5">and if it's not allowed there it's gonna</font>

339
00:11:09,519 --> 00:11:11,980
be<font color="#E5E5E5"> placed you know in a quarantine VLAN</font>

340
00:11:10,929 --> 00:11:14,199
or<font color="#E5E5E5"> it's gonna block the port or do</font>

341
00:11:11,980 --> 00:11:16,119
<font color="#E5E5E5">something of that nature there's two</font>

342
00:11:14,199 --> 00:11:18,488
<font color="#CCCCCC">different varieties of</font><font color="#E5E5E5"> nack that usually</font>

343
00:11:16,119 --> 00:11:19,929
we've seen and you know the first<font color="#CCCCCC"> is the</font>

344
00:11:18,489 --> 00:11:21,879
agent based enact<font color="#E5E5E5"> an agent based</font><font color="#CCCCCC"> nack</font>

345
00:11:19,929 --> 00:11:23,499
it's a software<font color="#CCCCCC"> component called an</font>

346
00:11:21,879 --> 00:11:24,850
agent that<font color="#E5E5E5"> is installed on every single</font>

347
00:11:23,499 --> 00:11:26,290
<font color="#CCCCCC">authorized device on the network</font><font color="#E5E5E5"> and you</font>

348
00:11:24,850 --> 00:11:28,089
<font color="#CCCCCC">know this agent communicates at the</font>

349
00:11:26,290 --> 00:11:29,769
brain of the neck and and and and

350
00:11:28,089 --> 00:11:31,239
reports back details about what's going

351
00:11:29,769 --> 00:11:33,129
<font color="#E5E5E5">on inside the network endpoint it does</font>

352
00:11:31,239 --> 00:11:34,059
like deep<font color="#E5E5E5"> internal checks and it's</font>

353
00:11:33,129 --> 00:11:35,230
actually really<font color="#CCCCCC"> effective but</font>

354
00:11:34,059 --> 00:11:37,299
<font color="#CCCCCC">unfortunately you also</font><font color="#E5E5E5"> have a situation</font>

355
00:11:35,230 --> 00:11:38,350
<font color="#E5E5E5">where</font><font color="#CCCCCC"> to install something</font><font color="#E5E5E5"> on everything</font>

356
00:11:37,299 --> 00:11:39,999
on<font color="#E5E5E5"> your network in order</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get this to</font>

357
00:11:38,350 --> 00:11:42,339
work<font color="#CCCCCC"> so it's nearly impractical as EAP</font>

358
00:11:39,999 --> 00:11:44,169
<font color="#CCCCCC">TLS</font><font color="#E5E5E5"> and then we have agent</font><font color="#CCCCCC"> list in</font>

359
00:11:42,339 --> 00:11:45,069
<font color="#CCCCCC">action</font><font color="#E5E5E5"> the other side of things and the</font>

360
00:11:44,169 --> 00:11:46,689
thing about agent listen<font color="#E5E5E5"> acts they're</font>

361
00:11:45,069 --> 00:11:47,949
<font color="#E5E5E5">they're they're completely external</font><font color="#CCCCCC"> they</font>

362
00:11:46,689 --> 00:11:49,719
use passive fingerprinting active

363
00:11:47,949 --> 00:11:51,279
<font color="#E5E5E5">scanning stuff like that</font><font color="#CCCCCC"> to kind of</font>

364
00:11:49,720 --> 00:11:53,230
externally try to<font color="#E5E5E5"> validate whether or</font>

365
00:11:51,279 --> 00:11:55,179
not a network<font color="#E5E5E5"> endpoints allowed to be</font>

366
00:11:53,230 --> 00:11:56,230
there or not<font color="#E5E5E5"> and because</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this there's</font>

367
00:11:55,179 --> 00:11:59,139
there's no need<font color="#CCCCCC"> to have software</font>

368
00:11:56,230 --> 00:12:00,549
installed on<font color="#E5E5E5"> the on each</font><font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> it's</font>

369
00:11:59,139 --> 00:12:02,079
easier deploy than an<font color="#CCCCCC"> agent</font><font color="#E5E5E5"> based</font><font color="#CCCCCC"> act</font>

370
00:12:00,549 --> 00:12:03,669
but it's<font color="#CCCCCC"> also unable</font><font color="#E5E5E5"> to examine the</font>

371
00:12:02,079 --> 00:12:05,138
internals<font color="#CCCCCC"> of network components so</font><font color="#E5E5E5"> you</font>

372
00:12:03,669 --> 00:12:07,660
can bypass<font color="#E5E5E5"> these things usually</font><font color="#CCCCCC"> by</font>

373
00:12:05,139 --> 00:12:08,799
masquerading as an<font color="#E5E5E5"> authorized device so</font>

374
00:12:07,660 --> 00:12:10,389
this kind of<font color="#CCCCCC"> brings</font><font color="#E5E5E5"> us back to the same</font>

375
00:12:08,799 --> 00:12:11,679
dilemma<font color="#E5E5E5"> that we saw before</font><font color="#CCCCCC"> you know</font>

376
00:12:10,389 --> 00:12:13,089
you're dealing<font color="#CCCCCC"> with</font><font color="#E5E5E5"> in security versus</font>

377
00:12:11,679 --> 00:12:15,160
<font color="#CCCCCC">in practicality you can choose the the</font>

378
00:12:13,089 --> 00:12:16,419
<font color="#E5E5E5">secure agent based</font><font color="#CCCCCC"> nak</font><font color="#E5E5E5"> or you can choose</font>

379
00:12:15,160 --> 00:12:19,540
<font color="#E5E5E5">the not so secure but easy to deploy</font>

380
00:12:16,419 --> 00:12:20,470
<font color="#E5E5E5">agentless nak which in turn you know</font>

381
00:12:19,540 --> 00:12:22,509
back<font color="#CCCCCC"> to square one</font>

382
00:12:20,470 --> 00:12:24,339
crates<font color="#E5E5E5"> on the market cap</font><font color="#CCCCCC"> you know you</font>

383
00:12:22,509 --> 00:12:26,470
<font color="#CCCCCC">you have this high demand</font><font color="#E5E5E5"> for a solution</font>

384
00:12:24,339 --> 00:12:28,119
<font color="#E5E5E5">that</font><font color="#CCCCCC"> offers the deep</font><font color="#E5E5E5"> interior</font><font color="#CCCCCC"> Gatien</font>

385
00:12:26,470 --> 00:12:30,699
capabilities<font color="#E5E5E5"> as an agent based nak both</font>

386
00:12:28,119 --> 00:12:33,160
add all that<font color="#E5E5E5"> additional overhead so you</font>

387
00:12:30,699 --> 00:12:35,109
know this<font color="#E5E5E5"> kind of gave rise to</font><font color="#CCCCCC"> to the so</font>

388
00:12:33,160 --> 00:12:36,730
<font color="#CCCCCC">called next generation nak which</font><font color="#E5E5E5"> is kind</font>

389
00:12:35,110 --> 00:12:37,899
of<font color="#E5E5E5"> attempts to be both worlds you know</font>

390
00:12:36,730 --> 00:12:40,329
<font color="#CCCCCC">there are a</font><font color="#E5E5E5"> few really interesting</font>

391
00:12:37,899 --> 00:12:41,619
<font color="#CCCCCC">examples of how to do this</font><font color="#E5E5E5"> I had one in</font>

392
00:12:40,329 --> 00:12:44,649
mine<font color="#CCCCCC"> that I kind of wanted</font><font color="#E5E5E5"> to bring as a</font>

393
00:12:41,619 --> 00:12:45,970
demonstration<font color="#CCCCCC"> I actually might have been</font>

394
00:12:44,649 --> 00:12:47,139
a bit naive of me<font color="#E5E5E5"> but I actually opened</font>

395
00:12:45,970 --> 00:12:48,519
a helpdesk<font color="#E5E5E5"> ticket at work to see if I</font>

396
00:12:47,139 --> 00:12:51,419
<font color="#E5E5E5">could borrow one from the IT department</font>

397
00:12:48,519 --> 00:12:53,649
and you can kind of guess how<font color="#CCCCCC"> that went</font>

398
00:12:51,419 --> 00:12:54,549
and then<font color="#E5E5E5"> also legal found out about it</font>

399
00:12:53,649 --> 00:12:56,619
<font color="#CCCCCC">was</font><font color="#E5E5E5"> like dude we got to be venture</font>

400
00:12:54,549 --> 00:12:58,640
neutral here<font color="#E5E5E5"> it's not good so we're</font>

401
00:12:56,619 --> 00:13:00,740
going<font color="#E5E5E5"> to refer to this as vendor</font>

402
00:12:58,640 --> 00:13:02,120
and and and<font color="#E5E5E5"> because I mean I guess right</font>

403
00:13:00,740 --> 00:13:03,230
the goal here is<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the leghole adding</font>

404
00:13:02,120 --> 00:13:06,440
particular vendor in particular I<font color="#CCCCCC"> don't</font>

405
00:13:03,230 --> 00:13:07,700
like hair<font color="#E5E5E5"> play it's a more to illustrate</font>

406
00:13:06,440 --> 00:13:10,010
a<font color="#E5E5E5"> point of just how difficult is to try</font>

407
00:13:07,700 --> 00:13:12,140
<font color="#E5E5E5">to bridge</font><font color="#CCCCCC"> that gap</font><font color="#E5E5E5"> between you know like</font>

408
00:13:10,010 --> 00:13:13,430
convenience versus security<font color="#E5E5E5"> so you know</font>

409
00:13:12,140 --> 00:13:16,370
one interesting<font color="#CCCCCC"> example is advice that</font>

410
00:13:13,430 --> 00:13:17,899
<font color="#E5E5E5">uses</font><font color="#CCCCCC"> WMI to interrogate</font><font color="#E5E5E5"> new devices as</font>

411
00:13:16,370 --> 00:13:20,089
they're<font color="#E5E5E5"> added</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the network and and and</font>

412
00:13:17,899 --> 00:13:21,440
<font color="#E5E5E5">this allows it to perform</font>

413
00:13:20,089 --> 00:13:23,899
internal checks without<font color="#E5E5E5"> using an agent</font>

414
00:13:21,440 --> 00:13:26,089
<font color="#E5E5E5">which</font><font color="#CCCCCC"> is pretty</font><font color="#E5E5E5"> cool but the way that it</font>

415
00:13:23,899 --> 00:13:29,750
<font color="#CCCCCC">does this is it authenticates with with</font>

416
00:13:26,089 --> 00:13:31,100
with all<font color="#E5E5E5"> network in</font><font color="#CCCCCC"> endpoints / SMB</font>

417
00:13:29,750 --> 00:13:33,110
using a single<font color="#E5E5E5"> administrative service</font>

418
00:13:31,100 --> 00:13:35,390
account<font color="#E5E5E5"> this the service accounts given</font>

419
00:13:33,110 --> 00:13:36,740
remote login privileges<font color="#E5E5E5"> usually as a DEA</font>

420
00:13:35,390 --> 00:13:38,510
account or<font color="#E5E5E5"> something similar to</font>

421
00:13:36,740 --> 00:13:40,399
<font color="#CCCCCC">everything on the network at the group</font>

422
00:13:38,510 --> 00:13:42,140
policy<font color="#E5E5E5"> level and</font><font color="#CCCCCC"> this allows the device</font>

423
00:13:40,399 --> 00:13:45,200
<font color="#CCCCCC">to to</font><font color="#E5E5E5"> perform deep interrogations and</font>

424
00:13:42,140 --> 00:13:47,810
it's still<font color="#E5E5E5"> pretty easy to deploy anyone</font>

425
00:13:45,200 --> 00:13:49,100
see a problem<font color="#E5E5E5"> with this yet</font><font color="#CCCCCC"> ya know</font><font color="#E5E5E5"> I</font>

426
00:13:47,810 --> 00:13:51,589
love seeing these<font color="#E5E5E5"> things on Penn's house</font>

427
00:13:49,100 --> 00:13:52,880
believe me<font color="#CCCCCC"> they're it's time to go</font><font color="#E5E5E5"> home</font>

428
00:13:51,589 --> 00:13:54,410
you know<font color="#E5E5E5"> it's so that like the thing is</font>

429
00:13:52,880 --> 00:13:56,300
a it<font color="#E5E5E5"> creates a single point of failure</font>

430
00:13:54,410 --> 00:13:57,500
<font color="#CCCCCC">where you know this device is gonna</font>

431
00:13:56,300 --> 00:13:59,269
<font color="#E5E5E5">attempt to</font><font color="#CCCCCC"> authenticate with any new</font>

432
00:13:57,500 --> 00:14:01,010
<font color="#CCCCCC">employee</font><font color="#E5E5E5"> this place on network using</font><font color="#CCCCCC"> the</font>

433
00:13:59,269 --> 00:14:03,020
special service account<font color="#CCCCCC"> and what this</font>

434
00:14:01,010 --> 00:14:04,490
does is you<font color="#E5E5E5"> have a device that's</font><font color="#CCCCCC"> sitting</font>

435
00:14:03,020 --> 00:14:07,579
<font color="#CCCCCC">God Mode hashes to</font><font color="#E5E5E5"> any new device it's</font>

436
00:14:04,490 --> 00:14:09,829
added to<font color="#E5E5E5"> the network so I mean the most</font>

437
00:14:07,579 --> 00:14:12,829
obvious<font color="#E5E5E5"> risk this introduces since its</font>

438
00:14:09,829 --> 00:14:14,120
using<font color="#E5E5E5"> ntlm is an SMB relay attack</font>

439
00:14:12,829 --> 00:14:15,439
because if you want to like<font color="#CCCCCC"> you know</font>

440
00:14:14,120 --> 00:14:16,760
pivot into something you<font color="#E5E5E5"> just join the</font>

441
00:14:15,440 --> 00:14:17,779
network wait for this thing to<font color="#E5E5E5"> talk try</font>

442
00:14:16,760 --> 00:14:19,760
to authenticate<font color="#CCCCCC"> with you to check out</font>

443
00:14:17,779 --> 00:14:21,200
<font color="#E5E5E5">check you out and then you just reload</font>

444
00:14:19,760 --> 00:14:23,060
<font color="#CCCCCC">that relay that</font><font color="#E5E5E5"> authentication attempts</font>

445
00:14:21,200 --> 00:14:24,709
to whatever you<font color="#E5E5E5"> want to pivot into and</font>

446
00:14:23,060 --> 00:14:26,449
of course you know you can mitigate that

447
00:14:24,709 --> 00:14:28,099
<font color="#CCCCCC">by deploying SMB sonic it's worth</font>

448
00:14:26,450 --> 00:14:29,660
mentioning that SMB signings disabled by

449
00:14:28,100 --> 00:14:31,430
default<font color="#CCCCCC"> on everything</font><font color="#E5E5E5"> but the domain</font>

450
00:14:29,660 --> 00:14:33,709
controller reasoning for<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think is</font>

451
00:14:31,430 --> 00:14:35,359
probably<font color="#E5E5E5"> because group policies actually</font>

452
00:14:33,709 --> 00:14:36,589
<font color="#E5E5E5">downloaded over SMB so I think that's</font>

453
00:14:35,360 --> 00:14:39,050
like where Microsoft drives the lawn is

454
00:14:36,589 --> 00:14:40,459
like no we can't<font color="#CCCCCC"> do</font><font color="#E5E5E5"> that but this even</font>

455
00:14:39,050 --> 00:14:42,260
if you<font color="#E5E5E5"> enable SMB something across the</font>

456
00:14:40,459 --> 00:14:44,089
<font color="#E5E5E5">board it doesn't address the issue of</font>

457
00:14:42,260 --> 00:14:46,490
having hashes sent<font color="#E5E5E5"> directly to untrusted</font>

458
00:14:44,089 --> 00:14:48,709
<font color="#E5E5E5">end points so</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> interestingly</font>

459
00:14:46,490 --> 00:14:51,649
enough<font color="#E5E5E5"> you know the this vendor</font><font color="#CCCCCC"> also</font>

460
00:14:48,709 --> 00:14:52,969
like<font color="#CCCCCC"> they provide you with with a piece</font>

461
00:14:51,649 --> 00:14:56,510
of<font color="#E5E5E5"> software</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can install on</font>

462
00:14:52,970 --> 00:14:58,850
<font color="#CCCCCC">network endpoints to kind of act as to</font>

463
00:14:56,510 --> 00:14:59,959
kind of remediate<font color="#CCCCCC"> this issue</font><font color="#E5E5E5"> but this is</font>

464
00:14:58,850 --> 00:15:01,760
starting<font color="#CCCCCC"> to sound a lot like</font><font color="#E5E5E5"> an agent</font>

465
00:14:59,959 --> 00:15:02,869
<font color="#E5E5E5">and considering this chief selling point</font>

466
00:15:01,760 --> 00:15:05,060
of<font color="#E5E5E5"> this thing is</font><font color="#CCCCCC"> that no agent is</font>

467
00:15:02,870 --> 00:15:07,430
required and I feel like we're just kind

468
00:15:05,060 --> 00:15:08,959
<font color="#CCCCCC">of back</font><font color="#E5E5E5"> to square one so I mean the</font>

469
00:15:07,430 --> 00:15:10,430
<font color="#CCCCCC">reason why I</font><font color="#E5E5E5"> just use this example is it</font>

470
00:15:08,959 --> 00:15:11,359
really you<font color="#E5E5E5"> know it's it's clearly</font>

471
00:15:10,430 --> 00:15:11,569
<font color="#CCCCCC">well-thought-out there's a</font><font color="#E5E5E5"> lot of</font>

472
00:15:11,360 --> 00:15:12,860
thought

473
00:15:11,570 --> 00:15:13,940
put<font color="#E5E5E5"> into this but it also illustrates</font>

474
00:15:12,860 --> 00:15:16,100
that<font color="#E5E5E5"> there really is no magic</font><font color="#CCCCCC"> bullet</font>

475
00:15:13,940 --> 00:15:18,170
<font color="#CCCCCC">when it comes to security</font><font color="#E5E5E5"> you know</font>

476
00:15:16,100 --> 00:15:21,440
security<font color="#E5E5E5"> with convenience is totally a</font>

477
00:15:18,170 --> 00:15:23,030
paradox most the time so another another

478
00:15:21,440 --> 00:15:24,230
<font color="#E5E5E5">interesting security control right that</font>

479
00:15:23,030 --> 00:15:26,540
you see on<font color="#CCCCCC"> wireless networks is</font><font color="#E5E5E5"> client</font>

480
00:15:24,230 --> 00:15:28,850
isolation<font color="#CCCCCC"> you know you can you see that</font>

481
00:15:26,540 --> 00:15:30,020
some wired networks<font color="#CCCCCC"> - but it gets</font>

482
00:15:28,850 --> 00:15:33,260
<font color="#CCCCCC">interesting when we talk about wireless</font>

483
00:15:30,020 --> 00:15:34,880
<font color="#E5E5E5">client isolation because well more about</font>

484
00:15:33,260 --> 00:15:36,260
that<font color="#E5E5E5"> in a second so</font><font color="#CCCCCC"> wireless client a</font>

485
00:15:34,880 --> 00:15:38,090
<font color="#E5E5E5">client isolation the ideas that you</font>

486
00:15:36,260 --> 00:15:39,920
prevent wireless clients from

487
00:15:38,090 --> 00:15:41,120
communicating with one<font color="#E5E5E5"> another it's</font>

488
00:15:39,920 --> 00:15:42,709
<font color="#E5E5E5">often</font><font color="#CCCCCC"> use a</font><font color="#E5E5E5"> security control especially</font>

489
00:15:41,120 --> 00:15:43,850
<font color="#E5E5E5">on open networks you know it's you get</font>

490
00:15:42,710 --> 00:15:46,550
everyone to play nice<font color="#CCCCCC"> and not like</font>

491
00:15:43,850 --> 00:15:48,590
attack one another<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> way to' 2.11</font>

492
00:15:46,550 --> 00:15:50,089
supposed to work<font color="#E5E5E5"> is that the AP is</font>

493
00:15:48,590 --> 00:15:51,710
supposed to communicate<font color="#E5E5E5"> with with</font><font color="#CCCCCC"> it's</font>

494
00:15:50,090 --> 00:15:53,450
supposed to mediate on communication on

495
00:15:51,710 --> 00:15:55,250
the network so in theory<font color="#E5E5E5"> this means it</font>

496
00:15:53,450 --> 00:15:57,020
<font color="#E5E5E5">means client isolation should work you</font>

497
00:15:55,250 --> 00:15:59,570
know we have<font color="#CCCCCC"> this diagram here</font><font color="#E5E5E5"> and if</font><font color="#CCCCCC"> we</font>

498
00:15:57,020 --> 00:16:01,819
<font color="#E5E5E5">have this this this one laptop laptop</font>

499
00:15:59,570 --> 00:16:03,650
tries to send<font color="#E5E5E5"> like a bunch of</font><font color="#CCCCCC"> nasty</font>

500
00:16:01,820 --> 00:16:04,880
stuff<font color="#CCCCCC"> to this other laptop the idea is</font>

501
00:16:03,650 --> 00:16:06,530
that<font color="#E5E5E5"> you know it has</font><font color="#CCCCCC"> to go through</font><font color="#E5E5E5"> the</font>

502
00:16:04,880 --> 00:16:08,000
<font color="#E5E5E5">AP first the AP you can just look oh</font>

503
00:16:06,530 --> 00:16:09,020
yeah this packet<font color="#E5E5E5"> is not going toward the</font>

504
00:16:08,000 --> 00:16:10,790
<font color="#E5E5E5">distribution</font><font color="#CCCCCC"> system or from</font><font color="#E5E5E5"> the</font>

505
00:16:09,020 --> 00:16:13,100
distribution<font color="#E5E5E5"> system</font><font color="#CCCCCC"> screw it now I'm</font>

506
00:16:10,790 --> 00:16:16,040
going<font color="#CCCCCC"> to I'm gonna drop the packet</font><font color="#E5E5E5"> but</font>

507
00:16:13,100 --> 00:16:17,270
the problem is<font color="#E5E5E5"> that you know when we're</font>

508
00:16:16,040 --> 00:16:18,860
<font color="#CCCCCC">talking about a wireless network client</font>

509
00:16:17,270 --> 00:16:20,870
isolations a logical control<font color="#CCCCCC"> it's not a</font>

510
00:16:18,860 --> 00:16:22,370
physical<font color="#E5E5E5"> control you know the question</font>

511
00:16:20,870 --> 00:16:23,660
<font color="#E5E5E5">is how do you prevent radio transceivers</font>

512
00:16:22,370 --> 00:16:25,610
from communicating<font color="#E5E5E5"> with one another</font><font color="#CCCCCC"> a</font>

513
00:16:23,660 --> 00:16:28,040
really awesome<font color="#E5E5E5"> researcher he's no longer</font>

514
00:16:25,610 --> 00:16:30,080
with<font color="#E5E5E5"> us</font><font color="#CCCCCC"> unfortunately</font><font color="#E5E5E5"> but back in 2005</font>

515
00:16:28,040 --> 00:16:32,420
Cedric<font color="#CCCCCC"> Blanchard his answer</font><font color="#E5E5E5"> to this</font>

516
00:16:30,080 --> 00:16:33,910
question was well you<font color="#E5E5E5"> can't and he</font>

517
00:16:32,420 --> 00:16:36,949
developed<font color="#CCCCCC"> this tool called</font><font color="#E5E5E5"> Wi-Fi tap</font>

518
00:16:33,910 --> 00:16:40,219
<font color="#E5E5E5">that you know that</font><font color="#CCCCCC"> kind of allows you to</font>

519
00:16:36,950 --> 00:16:41,810
<font color="#CCCCCC">bypass client isolation</font><font color="#E5E5E5"> this was later</font>

520
00:16:40,220 --> 00:16:46,310
<font color="#E5E5E5">revived by Oliver Lavery from</font><font color="#CCCCCC"> Gotham's</font>

521
00:16:41,810 --> 00:16:48,410
<font color="#CCCCCC">old science it's</font><font color="#E5E5E5"> way before my</font><font color="#CCCCCC"> time but</font>

522
00:16:46,310 --> 00:16:50,449
yeah the way that<font color="#E5E5E5"> Wi-Fi tab works is it</font>

523
00:16:48,410 --> 00:16:52,040
reads packets<font color="#CCCCCC"> from the AP</font><font color="#E5E5E5"> using a modern</font>

524
00:16:50,450 --> 00:16:54,350
<font color="#E5E5E5">mode Wi-Fi interface and then just</font>

525
00:16:52,040 --> 00:16:56,300
injects response to<font color="#E5E5E5"> those packets as if</font>

526
00:16:54,350 --> 00:16:59,690
it came<font color="#E5E5E5"> from the AP it's it's actually</font>

527
00:16:56,300 --> 00:17:01,010
really<font color="#E5E5E5"> simple you know and it even gives</font>

528
00:16:59,690 --> 00:17:03,440
you<font color="#E5E5E5"> like a nice little ton tap device</font>

529
00:17:01,010 --> 00:17:04,520
that you can<font color="#CCCCCC"> use to that</font><font color="#E5E5E5"> it bridges with</font>

530
00:17:03,440 --> 00:17:05,630
the<font color="#E5E5E5"> modern mode interface so you can</font>

531
00:17:04,520 --> 00:17:07,369
actually<font color="#E5E5E5"> interact</font><font color="#CCCCCC"> with a</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> without</font>

532
00:17:05,630 --> 00:17:09,980
even being associated<font color="#E5E5E5"> with it so it's</font>

533
00:17:07,369 --> 00:17:11,239
pretty cool<font color="#E5E5E5"> there's some there's some</font>

534
00:17:09,980 --> 00:17:12,770
later tools that<font color="#E5E5E5"> kind of like build off</font>

535
00:17:11,240 --> 00:17:14,689
<font color="#CCCCCC">of this aircrack</font><font color="#E5E5E5"> suite for example has</font>

536
00:17:12,770 --> 00:17:15,889
<font color="#CCCCCC">ayrton ng which supports</font><font color="#E5E5E5"> web you can do</font>

537
00:17:14,689 --> 00:17:18,290
these<font color="#CCCCCC"> attacks with web</font>

538
00:17:15,890 --> 00:17:20,089
it also has tea cup<font color="#CCCCCC"> tea captain ng it's</font>

539
00:17:18,290 --> 00:17:22,399
a little slower but it still works and

540
00:17:20,089 --> 00:17:24,079
and and you can do<font color="#E5E5E5"> this attack with</font><font color="#CCCCCC"> wp1</font>

541
00:17:22,400 --> 00:17:24,770
reasoning for<font color="#E5E5E5"> this by the reason for</font>

542
00:17:24,079 --> 00:17:27,680
<font color="#E5E5E5">this by the way</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> that</font>

543
00:17:24,770 --> 00:17:29,750
WPA<font color="#E5E5E5"> one was kind of developed and kind</font>

544
00:17:27,680 --> 00:17:31,730
<font color="#CCCCCC">of hastily as a response to</font><font color="#E5E5E5"> the the the</font>

545
00:17:29,750 --> 00:17:33,860
vulnerabilities found<font color="#E5E5E5"> in WEP so it's</font>

546
00:17:31,730 --> 00:17:37,670
basically like<font color="#E5E5E5"> web but like with</font>

547
00:17:33,860 --> 00:17:38,979
bandages<font color="#E5E5E5"> all over it so there's like</font>

548
00:17:37,670 --> 00:17:41,060
some theoretical attacks that<font color="#E5E5E5"> apparently</font>

549
00:17:38,980 --> 00:17:43,490
supposedly could<font color="#E5E5E5"> use them against wpa2</font>

550
00:17:41,060 --> 00:17:45,440
<font color="#CCCCCC">whole one day what whole 196 comes to</font>

551
00:17:43,490 --> 00:17:47,000
mind<font color="#CCCCCC"> but it's really debatable whether</font>

552
00:17:45,440 --> 00:17:47,930
these<font color="#E5E5E5"> actually work but for the second</font>

553
00:17:47,000 --> 00:17:50,210
being thorough just kind<font color="#CCCCCC"> of throwing</font>

554
00:17:47,930 --> 00:17:54,320
<font color="#E5E5E5">them in there as well here's just kind</font>

555
00:17:50,210 --> 00:17:56,780
of<font color="#E5E5E5"> a demo of a Wi-Fi Wi-Fi tap doing its</font>

556
00:17:54,320 --> 00:17:58,100
thing<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is really really small on my</font>

557
00:17:56,780 --> 00:17:59,060
screen so<font color="#CCCCCC"> if it</font><font color="#E5E5E5"> looks a</font><font color="#CCCCCC"> little choppy on</font>

558
00:17:58,100 --> 00:18:02,360
yours

559
00:17:59,060 --> 00:18:06,320
apologize<font color="#CCCCCC"> for that</font><font color="#E5E5E5"> but so like in the</font>

560
00:18:02,360 --> 00:18:08,810
top right here we have<font color="#CCCCCC"> a a terminal</font>

561
00:18:06,320 --> 00:18:10,129
that's that's bound to<font color="#E5E5E5"> to a VM that's</font>

562
00:18:08,810 --> 00:18:11,629
<font color="#CCCCCC">gonna host an access point for us we're</font>

563
00:18:10,130 --> 00:18:12,800
going<font color="#E5E5E5"> to start the access point and this</font>

564
00:18:11,630 --> 00:18:15,110
<font color="#CCCCCC">is</font><font color="#E5E5E5"> the terminal right here is bound to</font>

565
00:18:12,800 --> 00:18:15,919
<font color="#CCCCCC">our host operating system and we're</font>

566
00:18:15,110 --> 00:18:18,469
going<font color="#E5E5E5"> to we're</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> do something</font>

567
00:18:15,920 --> 00:18:19,760
<font color="#E5E5E5">with that and then this is another VM on</font>

568
00:18:18,470 --> 00:18:23,240
the left here this this terminal<font color="#CCCCCC"> here</font>

569
00:18:19,760 --> 00:18:26,870
and<font color="#E5E5E5"> that's going to be a yet another VM</font>

570
00:18:23,240 --> 00:18:28,940
<font color="#E5E5E5">that's gonna be our victim so here we're</font>

571
00:18:26,870 --> 00:18:31,090
associating with the with a I'm sorry

572
00:18:28,940 --> 00:18:33,200
<font color="#CCCCCC">that's one on the left's Camaro attacker</font>

573
00:18:31,090 --> 00:18:37,939
we've<font color="#E5E5E5"> just associated with</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> network</font>

574
00:18:33,200 --> 00:18:39,980
<font color="#E5E5E5">this</font><font color="#CCCCCC"> open network</font><font color="#E5E5E5"> using our our our host</font>

575
00:18:37,940 --> 00:18:41,720
operating system<font color="#CCCCCC"> and now</font><font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> set</font>

576
00:18:39,980 --> 00:18:44,630
a bunch of we're<font color="#E5E5E5"> gonna send five ICMP</font>

577
00:18:41,720 --> 00:18:46,790
requests from<font color="#CCCCCC"> our host operating system</font>

578
00:18:44,630 --> 00:18:48,650
<font color="#E5E5E5">to this access</font><font color="#CCCCCC"> point as you see we get</font>

579
00:18:46,790 --> 00:18:51,530
five five ICMP replies and that's

580
00:18:48,650 --> 00:18:53,810
<font color="#E5E5E5">expected so over here we're gonna start</font>

581
00:18:51,530 --> 00:18:55,070
<font color="#CCCCCC">a tool called Wi-Fi ping and Wi-Fi ping</font>

582
00:18:53,810 --> 00:18:56,600
it's just a<font color="#E5E5E5"> modified version of Wi-Fi</font>

583
00:18:55,070 --> 00:18:58,639
tap that it's a it's a cool

584
00:18:56,600 --> 00:19:00,139
<font color="#E5E5E5">proof-of-concept</font><font color="#CCCCCC"> tool that you know it's</font>

585
00:18:58,640 --> 00:19:03,860
<font color="#E5E5E5">really simple it all it does is</font><font color="#CCCCCC"> it</font>

586
00:19:00,140 --> 00:19:05,780
<font color="#CCCCCC">anytime that it</font><font color="#E5E5E5"> sniffs a an ICMP</font>

587
00:19:03,860 --> 00:19:07,879
requests<font color="#E5E5E5"> on the target</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> it just</font>

588
00:19:05,780 --> 00:19:12,710
responds with injects an ICMP response

589
00:19:07,880 --> 00:19:14,510
so as we as we<font color="#E5E5E5"> run this thing notice how</font>

590
00:19:12,710 --> 00:19:16,610
<font color="#E5E5E5">he run it a second time but instead</font><font color="#CCCCCC"> of</font>

591
00:19:14,510 --> 00:19:18,280
<font color="#CCCCCC">getting the expected</font><font color="#E5E5E5"> five responses we</font>

592
00:19:16,610 --> 00:19:20,240
actually get<font color="#CCCCCC"> 10 even though we only sent</font>

593
00:19:18,280 --> 00:19:21,410
<font color="#E5E5E5">we only sent five I've seen three</font>

594
00:19:20,240 --> 00:19:22,790
requests<font color="#E5E5E5"> so that's just an</font><font color="#CCCCCC"> example of</font>

595
00:19:21,410 --> 00:19:24,500
<font color="#CCCCCC">kind of a proof-of-concept that shows</font>

596
00:19:22,790 --> 00:19:26,540
that you know client isolation just

597
00:19:24,500 --> 00:19:29,480
<font color="#E5E5E5">doesn't really matter if you if you have</font>

598
00:19:26,540 --> 00:19:30,770
an open Wi-Fi network so food for

599
00:19:29,480 --> 00:19:31,880
thought<font color="#CCCCCC"> you know I we've been talking</font>

600
00:19:30,770 --> 00:19:35,150
<font color="#CCCCCC">about</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> whether</font><font color="#E5E5E5"> or not it's</font><font color="#CCCCCC"> possible</font>

601
00:19:31,880 --> 00:19:36,500
<font color="#E5E5E5">to see it's actually contain an attack</font>

602
00:19:35,150 --> 00:19:37,640
directly so attacker gets<font color="#E5E5E5"> on the network</font>

603
00:19:36,500 --> 00:19:38,230
<font color="#E5E5E5">and you media are able to do something</font>

604
00:19:37,640 --> 00:19:40,270
to prevent

605
00:19:38,230 --> 00:19:41,650
<font color="#E5E5E5">that's from proceeding any further</font><font color="#CCCCCC"> but I</font>

606
00:19:40,270 --> 00:19:43,560
feel<font color="#E5E5E5"> like this is this is</font><font color="#CCCCCC"> kind of</font>

607
00:19:41,650 --> 00:19:45,790
<font color="#E5E5E5">missing the point</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> and here's why</font><font color="#CCCCCC"> so</font>

608
00:19:43,560 --> 00:19:47,830
<font color="#CCCCCC">the role of</font><font color="#E5E5E5"> knack in containing a</font>

609
00:19:45,790 --> 00:19:49,300
wireless<font color="#CCCCCC"> breech is is to prevent</font><font color="#E5E5E5"> an</font>

610
00:19:47,830 --> 00:19:50,860
attacker<font color="#E5E5E5"> from accessing sensitive</font>

611
00:19:49,300 --> 00:19:53,020
resource you know<font color="#E5E5E5"> app or</font><font color="#CCCCCC"> sensitive</font>

612
00:19:50,860 --> 00:19:54,459
resources<font color="#CCCCCC"> after the breach occurs you</font>

613
00:19:53,020 --> 00:19:56,410
know<font color="#E5E5E5"> and and and the way that it does</font>

614
00:19:54,460 --> 00:19:58,210
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is that when unauthorized</font><font color="#E5E5E5"> network</font>

615
00:19:56,410 --> 00:19:59,860
at<font color="#E5E5E5"> one an unauthorized endpoints</font>

616
00:19:58,210 --> 00:20:01,390
detected on the<font color="#E5E5E5"> network you know one of</font>

617
00:19:59,860 --> 00:20:02,320
two actions is<font color="#CCCCCC"> gonna be taken either the</font>

618
00:20:01,390 --> 00:20:04,420
endpoints gonna be placed in a

619
00:20:02,320 --> 00:20:08,800
quarantine VLAN<font color="#CCCCCC"> or the port is gonna be</font>

620
00:20:04,420 --> 00:20:10,240
blocked off completely it's so like

621
00:20:08,800 --> 00:20:11,800
essentially violating access control

622
00:20:10,240 --> 00:20:13,390
policies this<font color="#CCCCCC"> is gonna cause the nack</font>

623
00:20:11,800 --> 00:20:14,800
tomb and impose some<font color="#CCCCCC"> kind of restriction</font>

624
00:20:13,390 --> 00:20:16,210
<font color="#E5E5E5">in a wired</font><font color="#CCCCCC"> network this</font><font color="#E5E5E5"> is gonna be a</font>

625
00:20:14,800 --> 00:20:17,770
physical<font color="#E5E5E5"> restriction so it's pretty</font>

626
00:20:16,210 --> 00:20:19,840
<font color="#CCCCCC">solid</font><font color="#E5E5E5"> but in a wireless network this can</font>

627
00:20:17,770 --> 00:20:21,280
only be<font color="#CCCCCC"> a logical restriction much like</font>

628
00:20:19,840 --> 00:20:23,740
what<font color="#E5E5E5"> we just saw with Wi-Fi tab and</font>

629
00:20:21,280 --> 00:20:25,060
client isolation so the kind<font color="#CCCCCC"> of drive</font>

630
00:20:23,740 --> 00:20:26,530
this point home let's imagine a pretty

631
00:20:25,060 --> 00:20:29,950
typical<font color="#E5E5E5"> scenario if you're doing a</font>

632
00:20:26,530 --> 00:20:31,600
wireless pen test<font color="#E5E5E5"> you know you've</font><font color="#CCCCCC"> you're</font>

633
00:20:29,950 --> 00:20:34,270
really cocky you've reached this this

634
00:20:31,600 --> 00:20:35,260
this wpa2<font color="#E5E5E5"> EAP</font><font color="#CCCCCC"> networks it's using p p--</font>

635
00:20:34,270 --> 00:20:36,280
and you're<font color="#E5E5E5"> like yeah</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> on the network</font>

636
00:20:35,260 --> 00:20:38,440
and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> you find yourself in a</font>

637
00:20:36,280 --> 00:20:39,490
quarantine VLAN<font color="#E5E5E5"> you know and and let's</font>

638
00:20:38,440 --> 00:20:42,130
say you're<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> present us</font>

639
00:20:39,490 --> 00:20:43,660
<font color="#E5E5E5">to a client as a present as a problem</font>

640
00:20:42,130 --> 00:20:46,180
<font color="#E5E5E5">but they're like yeah but we have this</font>

641
00:20:43,660 --> 00:20:48,040
knack in place<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> know why do we</font>

642
00:20:46,180 --> 00:20:49,810
<font color="#E5E5E5">need to secure this because you know any</font>

643
00:20:48,040 --> 00:20:51,399
attacker that's gonna<font color="#E5E5E5"> get onto the</font>

644
00:20:49,810 --> 00:20:53,230
<font color="#E5E5E5">network is just gonna be quarantined</font>

645
00:20:51,400 --> 00:20:54,880
like this and you know as an attacker

646
00:20:53,230 --> 00:20:56,560
you you<font color="#E5E5E5"> probably want to be able to it's</font>

647
00:20:54,880 --> 00:20:57,730
<font color="#E5E5E5">true</font><font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> its attacker your whole goal</font>

648
00:20:56,560 --> 00:20:59,440
is<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> access to like the sensitive</font>

649
00:20:57,730 --> 00:21:02,230
resources<font color="#E5E5E5"> that happen to be on this</font>

650
00:20:59,440 --> 00:21:03,400
restricted VLAN over here so you know

651
00:21:02,230 --> 00:21:06,340
the question<font color="#CCCCCC"> is how do</font><font color="#E5E5E5"> we get out of</font>

652
00:21:03,400 --> 00:21:08,740
<font color="#E5E5E5">this situation</font><font color="#CCCCCC"> and this is where we</font>

653
00:21:06,340 --> 00:21:10,270
start introducing<font color="#E5E5E5"> these new attacks</font><font color="#CCCCCC"> so</font>

654
00:21:08,740 --> 00:21:12,130
the first<font color="#CCCCCC"> we're gonna talk</font><font color="#E5E5E5"> about it's</font>

655
00:21:10,270 --> 00:21:13,540
called<font color="#E5E5E5"> a hostile portal attack and you</font>

656
00:21:12,130 --> 00:21:15,220
know this allows you to steal ad creds

657
00:21:13,540 --> 00:21:16,659
without direct network network<font color="#CCCCCC"> access so</font>

658
00:21:15,220 --> 00:21:18,490
it's kind of<font color="#CCCCCC"> the jumping-off</font><font color="#E5E5E5"> point for</font>

659
00:21:16,660 --> 00:21:20,830
what we're gonna do to<font color="#CCCCCC"> resolve</font><font color="#E5E5E5"> that</font>

660
00:21:18,490 --> 00:21:22,270
scenario<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> have to read a review a</font>

661
00:21:20,830 --> 00:21:24,550
<font color="#E5E5E5">couple things before</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> kind of explain</font>

662
00:21:22,270 --> 00:21:26,800
how it works<font color="#E5E5E5"> it's really a combination</font>

663
00:21:24,550 --> 00:21:28,960
of two things<font color="#CCCCCC"> one is a redirect SMB so</font>

664
00:21:26,800 --> 00:21:30,879
in a redirect<font color="#E5E5E5"> SMB attack the</font><font color="#CCCCCC"> idea is</font>

665
00:21:28,960 --> 00:21:33,250
that<font color="#E5E5E5"> you you you either coerce or you</font>

666
00:21:30,880 --> 00:21:35,500
trick a user<font color="#E5E5E5"> into actually seeing an</font>

667
00:21:33,250 --> 00:21:36,910
HTTP endpoint<font color="#E5E5E5"> and you know this HTTP</font>

668
00:21:35,500 --> 00:21:38,500
<font color="#E5E5E5">server specially configured so</font><font color="#CCCCCC"> that all</font>

669
00:21:36,910 --> 00:21:40,210
it does<font color="#E5E5E5"> is it redirects everything that</font>

670
00:21:38,500 --> 00:21:42,280
it receives<font color="#E5E5E5"> to</font><font color="#CCCCCC"> an SMB share in the</font>

671
00:21:40,210 --> 00:21:43,780
attackers machine and and what this<font color="#E5E5E5"> will</font>

672
00:21:42,280 --> 00:21:46,420
<font color="#E5E5E5">do is</font><font color="#CCCCCC"> that it</font><font color="#E5E5E5"> will actually trigger it</font>

673
00:21:43,780 --> 00:21:47,920
will cause the<font color="#CCCCCC"> victim</font><font color="#E5E5E5"> to attempt ntlm</font>

674
00:21:46,420 --> 00:21:49,690
authentication with the attacker<font color="#E5E5E5"> in</font>

675
00:21:47,920 --> 00:21:50,570
order to actually<font color="#E5E5E5"> that resource so the</font>

676
00:21:49,690 --> 00:21:52,220
the

677
00:21:50,570 --> 00:21:54,110
the victim<font color="#E5E5E5"> actresses the the HTTP</font>

678
00:21:52,220 --> 00:21:57,170
endpoint<font color="#E5E5E5"> gets redirected to an SMB share</font>

679
00:21:54,110 --> 00:21:58,429
and now you have their hashes<font color="#CCCCCC"> there's a</font>

680
00:21:57,170 --> 00:22:01,070
<font color="#CCCCCC">variation</font><font color="#E5E5E5"> to this that instead</font><font color="#CCCCCC"> of</font>

681
00:21:58,430 --> 00:22:02,540
<font color="#E5E5E5">redirecting to to an SNS and</font><font color="#CCCCCC"> be sure on</font>

682
00:22:01,070 --> 00:22:04,280
your<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> you redirect to a</font>

683
00:22:02,540 --> 00:22:05,720
<font color="#CCCCCC">non-existent SMB share and</font><font color="#E5E5E5"> then that</font>

684
00:22:04,280 --> 00:22:07,820
<font color="#E5E5E5">lets allows you to run responder in the</font>

685
00:22:05,720 --> 00:22:09,800
background because<font color="#E5E5E5"> if it will actually</font>

686
00:22:07,820 --> 00:22:12,980
<font color="#CCCCCC">you know because it's</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> existing SMB</font>

687
00:22:09,800 --> 00:22:14,750
share the<font color="#CCCCCC"> NetBIOS steps to</font><font color="#E5E5E5"> actually fall</font>

688
00:22:12,980 --> 00:22:16,670
back to element<font color="#CCCCCC"> RMB TNS and you can do</font>

689
00:22:14,750 --> 00:22:17,930
<font color="#E5E5E5">element</font><font color="#CCCCCC"> art and</font><font color="#E5E5E5"> betina's poisoning so</font>

690
00:22:16,670 --> 00:22:19,070
this is a really fast way to get hashes

691
00:22:17,930 --> 00:22:20,870
unfortunately<font color="#E5E5E5"> also</font><font color="#CCCCCC"> requires social</font>

692
00:22:19,070 --> 00:22:22,879
<font color="#E5E5E5">engineering you</font><font color="#CCCCCC"> have to get the the the</font>

693
00:22:20,870 --> 00:22:25,250
victim<font color="#CCCCCC"> to access this resource in the</font>

694
00:22:22,880 --> 00:22:29,150
first place<font color="#E5E5E5"> so we're about five percent</font>

695
00:22:25,250 --> 00:22:30,290
<font color="#E5E5E5">to our</font><font color="#CCCCCC"> escape attempt so the neck the</font>

696
00:22:29,150 --> 00:22:32,300
next<font color="#E5E5E5"> thing we're gonna combine with this</font>

697
00:22:30,290 --> 00:22:33,320
is is a captive portal<font color="#E5E5E5"> you know captive</font>

698
00:22:32,300 --> 00:22:34,899
portals are traditionally used<font color="#CCCCCC"> to</font>

699
00:22:33,320 --> 00:22:37,550
<font color="#E5E5E5">restrict access to open Wi-Fi networks</font>

700
00:22:34,900 --> 00:22:38,720
<font color="#E5E5E5">and the way that they work is</font><font color="#CCCCCC"> that you</font>

701
00:22:37,550 --> 00:22:40,840
know<font color="#E5E5E5"> all DNS queries are going to be</font>

702
00:22:38,720 --> 00:22:43,850
resolved to the captive portal page and

703
00:22:40,840 --> 00:22:45,320
additionally<font color="#E5E5E5"> if you you know</font><font color="#CCCCCC"> want to</font>

704
00:22:43,850 --> 00:22:47,270
prevent<font color="#E5E5E5"> people from just specifying</font>

705
00:22:45,320 --> 00:22:48,980
their own<font color="#CCCCCC"> dns server</font><font color="#E5E5E5"> you can redirect</font>

706
00:22:47,270 --> 00:22:50,240
the<font color="#CCCCCC"> inest</font><font color="#E5E5E5"> traffic to your</font><font color="#CCCCCC"> DNS server</font><font color="#E5E5E5"> so</font>

707
00:22:48,980 --> 00:22:51,650
<font color="#CCCCCC">that they have to</font><font color="#E5E5E5"> use your</font><font color="#CCCCCC"> dns server</font>

708
00:22:50,240 --> 00:22:52,610
and if you<font color="#E5E5E5"> really want to be you know</font>

709
00:22:51,650 --> 00:22:54,740
really<font color="#E5E5E5"> thorough about it you you</font>

710
00:22:52,610 --> 00:22:58,280
<font color="#CCCCCC">redirect</font><font color="#E5E5E5"> all HTTP traffic to the captive</font>

711
00:22:54,740 --> 00:23:00,080
portal as<font color="#E5E5E5"> well so a hostile portal</font>

712
00:22:58,280 --> 00:23:01,940
<font color="#E5E5E5">attack kind of combines all this stuff</font>

713
00:23:00,080 --> 00:23:04,040
and it's based on the redirect<font color="#E5E5E5"> S&B and</font>

714
00:23:01,940 --> 00:23:07,430
what it does is that<font color="#E5E5E5"> it you first force</font>

715
00:23:04,040 --> 00:23:09,620
the<font color="#E5E5E5"> victim to associate with you you</font>

716
00:23:07,430 --> 00:23:11,840
know as using a rogue ap attack and then

717
00:23:09,620 --> 00:23:13,729
<font color="#E5E5E5">you use a specially modified captive</font>

718
00:23:11,840 --> 00:23:16,070
portal<font color="#E5E5E5"> instead of redirecting to a</font><font color="#CCCCCC"> login</font>

719
00:23:13,730 --> 00:23:18,770
page<font color="#CCCCCC"> he redirects an SMB server</font><font color="#E5E5E5"> on share</font>

720
00:23:16,070 --> 00:23:20,480
on<font color="#E5E5E5"> your machine</font><font color="#CCCCCC"> so the the whole</font><font color="#E5E5E5"> process</font>

721
00:23:18,770 --> 00:23:22,100
what winds up happening<font color="#E5E5E5"> is the victims</font>

722
00:23:20,480 --> 00:23:23,240
forced<font color="#E5E5E5"> to connect to you and then</font>

723
00:23:22,100 --> 00:23:24,679
they're immediately redirected to your

724
00:23:23,240 --> 00:23:26,360
rogue<font color="#CCCCCC"> S&B</font><font color="#E5E5E5"> server and they send you</font>

725
00:23:24,680 --> 00:23:29,450
hashes it kind<font color="#E5E5E5"> of happens a quick</font>

726
00:23:26,360 --> 00:23:30,949
<font color="#E5E5E5">succession like that so for an</font><font color="#CCCCCC"> example</font>

727
00:23:29,450 --> 00:23:32,360
of<font color="#E5E5E5"> this working</font><font color="#CCCCCC"> I'm going to demonstrate</font>

728
00:23:30,950 --> 00:23:33,620
<font color="#E5E5E5">this is on an open</font><font color="#CCCCCC"> network at first</font>

729
00:23:32,360 --> 00:23:35,510
there's a couple<font color="#E5E5E5"> more steps involved</font><font color="#CCCCCC"> at</font>

730
00:23:33,620 --> 00:23:39,800
doing this with EAP so we're<font color="#E5E5E5"> gonna do</font>

731
00:23:35,510 --> 00:23:41,780
that next but<font color="#E5E5E5"> you know we see here we've</font>

732
00:23:39,800 --> 00:23:44,030
<font color="#CCCCCC">just sent or sending</font><font color="#E5E5E5"> a few</font><font color="#CCCCCC"> DL packets</font>

733
00:23:41,780 --> 00:23:46,040
this<font color="#E5E5E5"> will cause the actually let me back</font>

734
00:23:44,030 --> 00:23:47,960
<font color="#CCCCCC">up a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> so up</font><font color="#E5E5E5"> here we have the</font>

735
00:23:46,040 --> 00:23:49,639
eternal corresponding to the<font color="#E5E5E5"> legitimate</font>

736
00:23:47,960 --> 00:23:51,290
access<font color="#E5E5E5"> point and over here we have the</font>

737
00:23:49,640 --> 00:23:52,670
attacker<font color="#E5E5E5"> and over here we have</font><font color="#CCCCCC"> another</font>

738
00:23:51,290 --> 00:23:54,020
virtual machine named Jenkins

739
00:23:52,670 --> 00:23:57,500
<font color="#E5E5E5">I think that's Jenkins that's Jenkins</font>

740
00:23:54,020 --> 00:23:59,750
<font color="#CCCCCC">okay that is going to be our victim so</font>

741
00:23:57,500 --> 00:24:01,850
the victim is currently associated with

742
00:23:59,750 --> 00:24:03,890
this this network up here we're gonna

743
00:24:01,850 --> 00:24:07,969
we're<font color="#E5E5E5"> gonna create we're</font>

744
00:24:03,890 --> 00:24:10,280
a<font color="#CCCCCC"> rogue a peon</font><font color="#E5E5E5"> we're also going to</font><font color="#CCCCCC"> Diop</font>

745
00:24:07,970 --> 00:24:11,600
this particular bssid<font color="#CCCCCC"> which is going</font><font color="#E5E5E5"> to</font>

746
00:24:10,280 --> 00:24:13,940
<font color="#E5E5E5">cause this clients who are over to the</font>

747
00:24:11,600 --> 00:24:16,639
attacker<font color="#E5E5E5"> as we see here with it starting</font>

748
00:24:13,940 --> 00:24:18,590
<font color="#E5E5E5">to the authentication</font><font color="#CCCCCC"> process and its</font>

749
00:24:16,640 --> 00:24:20,059
associated with<font color="#E5E5E5"> our access point now and</font>

750
00:24:18,590 --> 00:24:22,580
now we just<font color="#CCCCCC"> open</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> ie</font>

751
00:24:20,059 --> 00:24:24,799
and now we have these hashes right there

752
00:24:22,580 --> 00:24:27,350
<font color="#E5E5E5">so the whole thing actually just you</font>

753
00:24:24,799 --> 00:24:28,580
know it's<font color="#E5E5E5"> pretty fast</font><font color="#CCCCCC"> and interesting</font>

754
00:24:27,350 --> 00:24:29,780
<font color="#CCCCCC">people think about internet explorer by</font>

755
00:24:28,580 --> 00:24:31,790
the way you<font color="#E5E5E5"> notice how like every time</font>

756
00:24:29,780 --> 00:24:33,770
<font color="#CCCCCC">you're we were typing in something in</font>

757
00:24:31,790 --> 00:24:34,790
<font color="#E5E5E5">the address bar it would kind of capture</font>

758
00:24:33,770 --> 00:24:36,889
the<font color="#E5E5E5"> hashes over and over again that's</font>

759
00:24:34,790 --> 00:24:38,450
<font color="#CCCCCC">because most</font><font color="#E5E5E5"> browsers will do like a</font>

760
00:24:36,890 --> 00:24:40,280
lookup request to some website to

761
00:24:38,450 --> 00:24:41,360
autocomplete<font color="#E5E5E5"> so you can just end up</font>

762
00:24:40,280 --> 00:24:43,490
<font color="#CCCCCC">caption the same thing over</font><font color="#E5E5E5"> and over</font>

763
00:24:41,360 --> 00:24:45,199
again that way anyways<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> pretty</font>

764
00:24:43,490 --> 00:24:47,179
<font color="#E5E5E5">cool but we really won't be able to do</font>

765
00:24:45,200 --> 00:24:48,230
with WPA EAP networks because that's the

766
00:24:47,179 --> 00:24:51,650
<font color="#CCCCCC">scenario that we're trying</font><font color="#E5E5E5"> to address</font>

767
00:24:48,230 --> 00:24:53,960
<font color="#E5E5E5">here</font><font color="#CCCCCC"> so in most cases WPA EEP</font><font color="#E5E5E5"> we're</font>

768
00:24:51,650 --> 00:24:55,880
talking about<font color="#E5E5E5"> EAP TLS and EAP peep</font>

769
00:24:53,960 --> 00:24:57,890
<font color="#E5E5E5">both USM is</font><font color="#CCCCCC"> chappy 2 for</font><font color="#E5E5E5"> inter</font>

770
00:24:55,880 --> 00:25:00,380
authentication<font color="#E5E5E5"> for if he</font><font color="#CCCCCC"> people Spruance</font>

771
00:24:57,890 --> 00:25:01,970
<font color="#E5E5E5">guarantee ibm's</font><font color="#CCCCCC"> chappy</font><font color="#E5E5E5"> to you Pete EAP</font>

772
00:25:00,380 --> 00:25:03,320
TLS you actually have some more<font color="#CCCCCC"> choices</font>

773
00:25:01,970 --> 00:25:06,110
but the strongest one out there is

774
00:25:03,320 --> 00:25:08,450
<font color="#CCCCCC">Emma's</font><font color="#E5E5E5"> chappy</font><font color="#CCCCCC"> 2 so that's the one we're</font>

775
00:25:06,110 --> 00:25:10,070
gonna worry about<font color="#E5E5E5"> so the thing about</font>

776
00:25:08,450 --> 00:25:11,809
Emma's<font color="#CCCCCC"> chef e2 is it's actually a mutual</font>

777
00:25:10,070 --> 00:25:14,178
authentication protocol you know<font color="#E5E5E5"> that at</font>

778
00:25:11,809 --> 00:25:16,428
the very<font color="#E5E5E5"> end</font><font color="#CCCCCC"> it's at the</font><font color="#E5E5E5"> very end of</font>

779
00:25:14,179 --> 00:25:17,419
<font color="#CCCCCC">that authentication</font><font color="#E5E5E5"> process the radius</font>

780
00:25:16,429 --> 00:25:19,820
server<font color="#E5E5E5"> is</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to have to prove</font>

781
00:25:17,419 --> 00:25:22,010
knowledge<font color="#E5E5E5"> of the supplicants password or</font>

782
00:25:19,820 --> 00:25:24,590
<font color="#E5E5E5">the client devices password in order</font><font color="#CCCCCC"> for</font>

783
00:25:22,010 --> 00:25:25,879
the internet<font color="#CCCCCC"> occation to succeed so i</font>

784
00:25:24,590 --> 00:25:27,260
mean<font color="#E5E5E5"> that this this is kind</font><font color="#CCCCCC"> of bad</font>

785
00:25:25,880 --> 00:25:28,460
because<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know although as an attacker</font>

786
00:25:27,260 --> 00:25:30,590
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know we can force the victim</font><font color="#E5E5E5"> to</font>

787
00:25:28,460 --> 00:25:32,780
authenticate with us<font color="#E5E5E5"> using</font><font color="#CCCCCC"> a rogue</font><font color="#E5E5E5"> ap</font>

788
00:25:30,590 --> 00:25:35,030
attack and that<font color="#E5E5E5"> lets us steal steal</font>

789
00:25:32,780 --> 00:25:38,330
radius credentials<font color="#CCCCCC"> we're still going</font><font color="#E5E5E5"> to</font>

790
00:25:35,030 --> 00:25:41,149
or hashes<font color="#CCCCCC"> that what can</font><font color="#E5E5E5"> be used to to to</font>

791
00:25:38,330 --> 00:25:42,350
get radius credentials<font color="#E5E5E5"> you know we're</font>

792
00:25:41,150 --> 00:25:43,940
<font color="#E5E5E5">still</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to fail that final stage of</font>

793
00:25:42,350 --> 00:25:45,168
the authentication process<font color="#E5E5E5"> and the</font>

794
00:25:43,940 --> 00:25:46,549
clients not<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> fully associate</font>

795
00:25:45,169 --> 00:25:47,840
with our network<font color="#E5E5E5"> and considering that</font>

796
00:25:46,549 --> 00:25:49,309
<font color="#E5E5E5">you know most of the interesting stuff</font>

797
00:25:47,840 --> 00:25:51,260
<font color="#CCCCCC">that you can do with rogue</font><font color="#E5E5E5"> ap attacks</font>

798
00:25:49,309 --> 00:25:53,270
<font color="#E5E5E5">other than stealing radius credentials</font>

799
00:25:51,260 --> 00:25:55,220
require that full<font color="#CCCCCC"> Association this is a</font>

800
00:25:53,270 --> 00:25:57,410
problem<font color="#E5E5E5"> so there are a couple of</font>

801
00:25:55,220 --> 00:26:01,190
solutions<font color="#E5E5E5"> to this the first you know the</font>

802
00:25:57,410 --> 00:26:02,900
<font color="#CCCCCC">first</font><font color="#E5E5E5"> solution is actually it's finally</font>

803
00:26:01,190 --> 00:26:04,880
<font color="#CCCCCC">ER</font><font color="#E5E5E5"> by by Dom white and de</font><font color="#CCCCCC"> villiers once</font>

804
00:26:02,900 --> 00:26:06,440
again in<font color="#E5E5E5"> 2014 and this is the auto crack</font>

805
00:26:04,880 --> 00:26:08,150
and AD technique this works<font color="#E5E5E5"> pretty well</font>

806
00:26:06,440 --> 00:26:09,890
with weak radius<font color="#E5E5E5"> crypt and passwords and</font>

807
00:26:08,150 --> 00:26:11,090
if you have strong radius passwords you

808
00:26:09,890 --> 00:26:13,460
just crack<font color="#E5E5E5"> them offline to finish the</font>

809
00:26:11,090 --> 00:26:16,340
attack<font color="#E5E5E5"> later we'll talk about both</font><font color="#CCCCCC"> both</font>

810
00:26:13,460 --> 00:26:18,950
options right<font color="#CCCCCC"> kind of sequentially</font>

811
00:26:16,340 --> 00:26:20,389
so you know we're<font color="#CCCCCC"> looking here</font><font color="#E5E5E5"> this</font>

812
00:26:18,950 --> 00:26:22,670
diagram<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> represents the final</font>

813
00:26:20,390 --> 00:26:24,260
stage of the<font color="#E5E5E5"> MS</font><font color="#CCCCCC"> Chaffee to</font>

814
00:26:22,670 --> 00:26:25,670
authentication process<font color="#E5E5E5"> from the</font>

815
00:26:24,260 --> 00:26:26,930
<font color="#CCCCCC">perspective of an attacker so the</font>

816
00:26:25,670 --> 00:26:28,940
attacker is probably be running hostapd

817
00:26:26,930 --> 00:26:30,340
<font color="#CCCCCC">as a radius server</font><font color="#E5E5E5"> and the way this is</font>

818
00:26:28,940 --> 00:26:32,600
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to work is that you know the</font>

819
00:26:30,340 --> 00:26:34,129
victim is going<font color="#CCCCCC"> to send</font><font color="#E5E5E5"> the attackers</font>

820
00:26:32,600 --> 00:26:37,490
radius server hostapd

821
00:26:34,130 --> 00:26:40,190
that that challenge<font color="#CCCCCC"> response but</font><font color="#E5E5E5"> you</font>

822
00:26:37,490 --> 00:26:42,380
know at that<font color="#E5E5E5"> point the hostapd is going</font>

823
00:26:40,190 --> 00:26:43,700
to evaluate<font color="#E5E5E5"> would normally evaluate you</font>

824
00:26:42,380 --> 00:26:45,710
know<font color="#E5E5E5"> whether or not this valid response</font>

825
00:26:43,700 --> 00:26:46,940
or not and then<font color="#E5E5E5"> what it's going to do in</font>

826
00:26:45,710 --> 00:26:48,800
order<font color="#CCCCCC"> to</font><font color="#E5E5E5"> try to come you know</font>

827
00:26:46,940 --> 00:26:50,540
authenticate with<font color="#E5E5E5"> the victim that that</font>

828
00:26:48,800 --> 00:26:52,220
mutual<font color="#E5E5E5"> authentication there it's going</font>

829
00:26:50,540 --> 00:26:54,920
<font color="#E5E5E5">to attempt</font><font color="#CCCCCC"> to load Eve the password</font><font color="#E5E5E5"> or</font>

830
00:26:52,220 --> 00:26:56,270
the password<font color="#E5E5E5"> or</font><font color="#CCCCCC"> the or</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> NT hash the</font>

831
00:26:54,920 --> 00:26:58,550
password which is<font color="#CCCCCC"> passed or equivalent</font>

832
00:26:56,270 --> 00:27:01,220
from the EAP user file the EAP user file

833
00:26:58,550 --> 00:27:02,570
is like a it's like a<font color="#E5E5E5"> really simple it's</font>

834
00:27:01,220 --> 00:27:04,010
kind of like a simplistic database it's

835
00:27:02,570 --> 00:27:06,110
like a text file<font color="#CCCCCC"> that's used by hostapd</font>

836
00:27:04,010 --> 00:27:07,970
<font color="#E5E5E5">as a database that has information about</font>

837
00:27:06,110 --> 00:27:09,290
users and<font color="#E5E5E5"> their credentials</font><font color="#CCCCCC"> and stuff so</font>

838
00:27:07,970 --> 00:27:11,330
<font color="#E5E5E5">it's gonna attempt to load this this</font>

839
00:27:09,290 --> 00:27:12,800
this password<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> EAP</font><font color="#E5E5E5"> user file and</font>

840
00:27:11,330 --> 00:27:14,240
then use that to construct<font color="#E5E5E5"> an</font>

841
00:27:12,800 --> 00:27:15,379
authentication response that it sends<font color="#CCCCCC"> to</font>

842
00:27:14,240 --> 00:27:17,750
the victim along with the authentication

843
00:27:15,380 --> 00:27:19,520
success message<font color="#E5E5E5"> of course what's</font><font color="#CCCCCC"> going</font>

844
00:27:17,750 --> 00:27:20,750
<font color="#CCCCCC">to happen if we're using</font><font color="#E5E5E5"> this attack to</font>

845
00:27:19,520 --> 00:27:22,550
steal<font color="#E5E5E5"> rated scratches in the first place</font>

846
00:27:20,750 --> 00:27:24,680
we're<font color="#E5E5E5"> not gonna have the</font><font color="#CCCCCC"> user's password</font>

847
00:27:22,550 --> 00:27:26,330
<font color="#CCCCCC">our NT hash to the password in the EAP</font>

848
00:27:24,680 --> 00:27:29,480
user file<font color="#E5E5E5"> so this is where things are</font>

849
00:27:26,330 --> 00:27:31,429
<font color="#E5E5E5">going to start to break</font><font color="#CCCCCC"> down so with an</font>

850
00:27:29,480 --> 00:27:33,380
auto crack and an attack the way that it

851
00:27:31,430 --> 00:27:34,910
works is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you you know when</font><font color="#CCCCCC"> you</font>

852
00:27:33,380 --> 00:27:36,170
receive<font color="#CCCCCC"> that challenge response instead</font>

853
00:27:34,910 --> 00:27:37,880
<font color="#E5E5E5">of you know immediately trying to load</font>

854
00:27:36,170 --> 00:27:39,590
the password<font color="#E5E5E5"> from the EAP user file you</font>

855
00:27:37,880 --> 00:27:40,910
said just say you know screw it<font color="#CCCCCC"> and just</font>

856
00:27:39,590 --> 00:27:42,530
send<font color="#CCCCCC"> the thing off to a cracking rig</font>

857
00:27:40,910 --> 00:27:44,300
immediately<font color="#E5E5E5"> and then you know hopefully</font>

858
00:27:42,530 --> 00:27:46,240
<font color="#E5E5E5">you remember that</font><font color="#CCCCCC"> Emma's chapter two</font><font color="#E5E5E5"> can</font>

859
00:27:44,300 --> 00:27:48,080
<font color="#E5E5E5">be can</font><font color="#CCCCCC"> be cracked pretty quickly</font>

860
00:27:46,240 --> 00:27:49,640
<font color="#E5E5E5">hopefully what's gonna</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> gonna happen</font>

861
00:27:48,080 --> 00:27:50,899
<font color="#CCCCCC">if it's a weak enough password you</font>

862
00:27:49,640 --> 00:27:53,060
should<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to crack it</font><font color="#CCCCCC"> within a</font><font color="#E5E5E5"> few</font>

863
00:27:50,900 --> 00:27:54,830
seconds<font color="#E5E5E5"> and then you just append it you</font>

864
00:27:53,060 --> 00:27:57,710
know slap<font color="#E5E5E5"> it on the end of that that EAP</font>

865
00:27:54,830 --> 00:27:59,000
user file and then<font color="#CCCCCC"> what'll happen</font><font color="#E5E5E5"> there</font>

866
00:27:57,710 --> 00:28:00,020
is a host a beauty<font color="#E5E5E5"> will will actually</font>

867
00:27:59,000 --> 00:28:02,090
load the<font color="#E5E5E5"> password that you've just</font>

868
00:28:00,020 --> 00:28:03,230
cracked and you use that<font color="#CCCCCC"> to construct</font>

869
00:28:02,090 --> 00:28:04,820
the authentication response<font color="#E5E5E5"> and</font>

870
00:28:03,230 --> 00:28:06,650
everything just gets sent off<font color="#E5E5E5"> to the</font>

871
00:28:04,820 --> 00:28:07,879
victim and the attack<font color="#CCCCCC"> succeeds it may</font>

872
00:28:06,650 --> 00:28:09,050
not<font color="#CCCCCC"> work the first time</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you may have</font>

873
00:28:07,880 --> 00:28:10,640
<font color="#E5E5E5">to kind of rinse and repeat the attack a</font>

874
00:28:09,050 --> 00:28:12,649
<font color="#E5E5E5">couple times until it finally cracks it</font>

875
00:28:10,640 --> 00:28:15,020
in enough time<font color="#CCCCCC"> but but it should work</font>

876
00:28:12,650 --> 00:28:16,010
<font color="#CCCCCC">with weak passwords for stronger</font>

877
00:28:15,020 --> 00:28:18,500
passwords that's not going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> work</font>

878
00:28:16,010 --> 00:28:20,090
<font color="#CCCCCC">though because it just</font><font color="#E5E5E5"> the timing is not</font>

879
00:28:18,500 --> 00:28:23,420
<font color="#CCCCCC">going to line up</font><font color="#E5E5E5"> so your second option</font>

880
00:28:20,090 --> 00:28:24,980
<font color="#E5E5E5">yeah we really have to just crack</font><font color="#CCCCCC"> it</font>

881
00:28:23,420 --> 00:28:26,600
traditionally and then come back<font color="#E5E5E5"> and</font>

882
00:28:24,980 --> 00:28:28,400
<font color="#CCCCCC">finish the attack later that's actually</font>

883
00:28:26,600 --> 00:28:29,750
not that bad<font color="#E5E5E5"> though</font><font color="#CCCCCC"> you know the only</font>

884
00:28:28,400 --> 00:28:32,030
<font color="#E5E5E5">caveat that you're dealing here with top</font>

885
00:28:29,750 --> 00:28:33,260
dealing with<font color="#E5E5E5"> here is time and remember</font>

886
00:28:32,030 --> 00:28:34,820
that with<font color="#CCCCCC"> with a</font><font color="#E5E5E5"> divide-and-conquer</font>

887
00:28:33,260 --> 00:28:37,670
attack you can you can crack these these

888
00:28:34,820 --> 00:28:38,840
hashes<font color="#E5E5E5"> fairly efficiently so here's</font>

889
00:28:37,670 --> 00:28:43,130
here's<font color="#E5E5E5"> how this would work with the auto</font>

890
00:28:38,840 --> 00:28:45,830
auto crack and<font color="#CCCCCC"> AD attack and we're gonna</font>

891
00:28:43,130 --> 00:28:49,310
<font color="#E5E5E5">use a fantastically fantastically weak</font>

892
00:28:45,830 --> 00:28:50,750
password for this so it's going<font color="#E5E5E5"> to look</font>

893
00:28:49,310 --> 00:28:54,580
<font color="#E5E5E5">a lot like it was before</font><font color="#CCCCCC"> we have the</font>

894
00:28:50,750 --> 00:28:56,510
attacker here<font color="#E5E5E5"> victim here or I'm sorry</font>

895
00:28:54,580 --> 00:29:00,800
target<font color="#E5E5E5"> access point here and we also</font>

896
00:28:56,510 --> 00:29:03,590
<font color="#E5E5E5">have the victim here so as before we've</font>

897
00:29:00,800 --> 00:29:06,500
just D off the the the victim<font color="#E5E5E5"> and and</font>

898
00:29:03,590 --> 00:29:08,300
they've roamed<font color="#E5E5E5"> over to our legitimate</font>

899
00:29:06,500 --> 00:29:10,700
access<font color="#E5E5E5"> point here we've captured the</font>

900
00:29:08,300 --> 00:29:12,230
<font color="#CCCCCC">Challenger response and then just kind</font>

901
00:29:10,700 --> 00:29:14,450
<font color="#CCCCCC">of as normal</font><font color="#E5E5E5"> we're going to you know</font>

902
00:29:12,230 --> 00:29:16,400
<font color="#E5E5E5">open up</font><font color="#CCCCCC"> ie and watch you</font><font color="#E5E5E5"> know that's can</font>

903
00:29:14,450 --> 00:29:19,940
generate HTTP traffic<font color="#E5E5E5"> which gives us</font>

904
00:29:16,400 --> 00:29:21,950
more hashes<font color="#E5E5E5"> so</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> this attack gets you</font>

905
00:29:19,940 --> 00:29:23,300
is lots and lots of ntlm hashes you

906
00:29:21,950 --> 00:29:25,370
<font color="#E5E5E5">actually get similar</font><font color="#CCCCCC"> results that you</font>

907
00:29:23,300 --> 00:29:26,750
would get<font color="#E5E5E5"> with your using element</font><font color="#CCCCCC"> RMB</font>

908
00:29:25,370 --> 00:29:28,250
<font color="#CCCCCC">TNS poisoning there are few key</font>

909
00:29:26,750 --> 00:29:29,750
advantages here<font color="#CCCCCC"> namely that in</font><font color="#E5E5E5"> the first</font>

910
00:29:28,250 --> 00:29:30,680
<font color="#E5E5E5">place</font><font color="#CCCCCC"> no direct network access is</font>

911
00:29:29,750 --> 00:29:32,660
required<font color="#CCCCCC"> you don't really have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> go</font>

912
00:29:30,680 --> 00:29:34,280
plug<font color="#E5E5E5"> into a jack</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> this to work</font><font color="#CCCCCC"> and</font>

913
00:29:32,660 --> 00:29:35,480
<font color="#CCCCCC">also you're not</font><font color="#E5E5E5"> limited to a local</font>

914
00:29:34,280 --> 00:29:36,920
subnet you can get everything<font color="#E5E5E5"> that's</font>

915
00:29:35,480 --> 00:29:38,090
connected<font color="#CCCCCC"> to the wireless</font><font color="#E5E5E5"> network it's</font>

916
00:29:36,920 --> 00:29:39,890
also not<font color="#E5E5E5"> a passive attack you're not</font>

917
00:29:38,090 --> 00:29:41,959
waiting<font color="#E5E5E5"> for broadcast requests to start</font>

918
00:29:39,890 --> 00:29:44,750
<font color="#E5E5E5">appearing on the network so back</font><font color="#CCCCCC"> to our</font>

919
00:29:41,960 --> 00:29:46,070
scenario we can<font color="#E5E5E5"> build off of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> the</font>

920
00:29:44,750 --> 00:29:47,330
hostile portal attack to do something

921
00:29:46,070 --> 00:29:50,330
called an indirect<font color="#E5E5E5"> wireless pivot and</font>

922
00:29:47,330 --> 00:29:52,610
<font color="#CCCCCC">you know this</font><font color="#E5E5E5"> is where we use a rogue ap</font>

923
00:29:50,330 --> 00:29:54,439
attack to bypass<font color="#CCCCCC"> that port port</font><font color="#E5E5E5"> based</font>

924
00:29:52,610 --> 00:29:57,409
access control<font color="#CCCCCC"> that kind of got us</font><font color="#E5E5E5"> stuck</font>

925
00:29:54,440 --> 00:29:59,240
earlier<font color="#E5E5E5"> so here we are</font><font color="#CCCCCC"> in our scenario</font>

926
00:29:57,410 --> 00:30:00,890
<font color="#CCCCCC">from</font><font color="#E5E5E5"> earlier right and you know notice</font>

927
00:29:59,240 --> 00:30:02,990
here<font color="#CCCCCC"> that we're on this</font><font color="#E5E5E5"> this quarantine</font>

928
00:30:00,890 --> 00:30:05,300
VLAN and there but<font color="#E5E5E5"> there's also a victim</font>

929
00:30:02,990 --> 00:30:07,430
device on this restricted VLAN<font color="#E5E5E5"> and where</font>

930
00:30:05,300 --> 00:30:09,350
we want to<font color="#E5E5E5"> where we want to get to so</font>

931
00:30:07,430 --> 00:30:10,730
assume<font color="#CCCCCC"> that we have two two network</font>

932
00:30:09,350 --> 00:30:12,679
interfaces<font color="#CCCCCC"> and</font><font color="#E5E5E5"> our first network</font>

933
00:30:10,730 --> 00:30:14,840
interfaces is currently a interface is

934
00:30:12,680 --> 00:30:16,010
currently associated<font color="#E5E5E5"> with the target</font>

935
00:30:14,840 --> 00:30:17,120
<font color="#CCCCCC">network and that's</font><font color="#E5E5E5"> that's the one that</font>

936
00:30:16,010 --> 00:30:20,690
<font color="#E5E5E5">has the</font><font color="#CCCCCC"> IP address on this quarantine</font>

937
00:30:17,120 --> 00:30:23,260
VLAN if we use the second interface<font color="#CCCCCC"> to</font>

938
00:30:20,690 --> 00:30:25,520
force that that victim device to

939
00:30:23,260 --> 00:30:28,550
associate with<font color="#E5E5E5"> us you know using a rogue</font>

940
00:30:25,520 --> 00:30:30,230
ap attack<font color="#E5E5E5"> if we then perform a hostile</font>

941
00:30:28,550 --> 00:30:32,149
portal attack<font color="#E5E5E5"> that'll get us NC</font><font color="#CCCCCC"> LM</font>

942
00:30:30,230 --> 00:30:34,490
hashes you know we then crack those

943
00:30:32,150 --> 00:30:35,870
<font color="#E5E5E5">hashes offline you know pick up where we</font>

944
00:30:34,490 --> 00:30:37,190
<font color="#CCCCCC">left</font><font color="#E5E5E5"> off we might have to go</font><font color="#CCCCCC"> back and</font>

945
00:30:35,870 --> 00:30:39,889
repeat the step where we get the victim

946
00:30:37,190 --> 00:30:41,300
<font color="#CCCCCC">to associate</font><font color="#E5E5E5"> us with us whatever but</font>

947
00:30:39,890 --> 00:30:42,020
then at that point<font color="#E5E5E5"> you can you can use</font>

948
00:30:41,300 --> 00:30:43,879
the<font color="#CCCCCC"> the</font>

949
00:30:42,020 --> 00:30:45,139
that that access to place a<font color="#E5E5E5"> time payload</font>

950
00:30:43,880 --> 00:30:46,610
like a scheduled<font color="#E5E5E5"> task or something</font><font color="#CCCCCC"> like</font>

951
00:30:45,140 --> 00:30:47,630
<font color="#CCCCCC">that on</font><font color="#E5E5E5"> the victim and what this time</font>

952
00:30:46,610 --> 00:30:48,979
payload is going to do is it's going<font color="#CCCCCC"> to</font>

953
00:30:47,630 --> 00:30:51,080
execute<font color="#E5E5E5"> after</font><font color="#CCCCCC"> a certain period of</font><font color="#E5E5E5"> time</font>

954
00:30:48,980 --> 00:30:52,190
<font color="#CCCCCC">and send a reverse shell back to our</font>

955
00:30:51,080 --> 00:30:53,600
first network interface which<font color="#CCCCCC"> is</font>

956
00:30:52,190 --> 00:30:56,570
currently sitting<font color="#E5E5E5"> on the quarantine VLAN</font>

957
00:30:53,600 --> 00:30:58,070
at that point we<font color="#E5E5E5"> stop our rogue ap</font><font color="#CCCCCC"> this</font>

958
00:30:56,570 --> 00:31:00,080
allows the victim device to reassociate

959
00:30:58,070 --> 00:31:01,820
<font color="#CCCCCC">with a target</font><font color="#E5E5E5"> network it's still an</font>

960
00:31:00,080 --> 00:31:03,080
authorized device<font color="#E5E5E5"> so it's going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

961
00:31:01,820 --> 00:31:04,520
moved<font color="#E5E5E5"> over by the</font><font color="#CCCCCC"> neck to the</font><font color="#E5E5E5"> restricted</font>

962
00:31:03,080 --> 00:31:05,929
VLAN<font color="#CCCCCC"> and we just wait for</font><font color="#E5E5E5"> the reverse</font>

963
00:31:04,520 --> 00:31:07,420
<font color="#E5E5E5">shell and this could be the best</font><font color="#CCCCCC"> knack</font>

964
00:31:05,930 --> 00:31:09,440
in the world and it wouldn't<font color="#CCCCCC"> even matter</font>

965
00:31:07,420 --> 00:31:10,730
<font color="#E5E5E5">so I mean that that</font><font color="#CCCCCC"> involves the</font>

966
00:31:09,440 --> 00:31:11,810
password cracking so I mean a<font color="#E5E5E5"> more</font>

967
00:31:10,730 --> 00:31:13,460
efficient approach<font color="#E5E5E5"> would be to use</font><font color="#CCCCCC"> an</font>

968
00:31:11,810 --> 00:31:14,480
<font color="#CCCCCC">SMP</font><font color="#E5E5E5"> real attack of course there's a</font>

969
00:31:13,460 --> 00:31:15,950
<font color="#CCCCCC">little more conditions here we need to</font>

970
00:31:14,480 --> 00:31:18,440
<font color="#E5E5E5">victim devices at this point because</font>

971
00:31:15,950 --> 00:31:22,160
reflection hasn't worked since<font color="#CCCCCC"> MS zero</font>

972
00:31:18,440 --> 00:31:23,780
eight zero six eight I<font color="#E5E5E5"> believe but if we</font>

973
00:31:22,160 --> 00:31:26,510
<font color="#E5E5E5">we forced both of these devices to</font>

974
00:31:23,780 --> 00:31:28,250
connect to us and then we instead<font color="#E5E5E5"> of</font>

975
00:31:26,510 --> 00:31:30,650
simply using the<font color="#CCCCCC"> hostile portal attacks</font>

976
00:31:28,250 --> 00:31:32,390
you capture ntlm hashes we instead

977
00:31:30,650 --> 00:31:35,030
<font color="#E5E5E5">perform a relay attack from one to the</font>

978
00:31:32,390 --> 00:31:36,710
other to<font color="#E5E5E5"> execute that time payload and</font>

979
00:31:35,030 --> 00:31:38,450
<font color="#E5E5E5">then just allow the the victim devices</font>

980
00:31:36,710 --> 00:31:39,440
to<font color="#CCCCCC"> read associate the target network we</font>

981
00:31:38,450 --> 00:31:44,240
<font color="#CCCCCC">could still get</font><font color="#E5E5E5"> the reverse cell that</font>

982
00:31:39,440 --> 00:31:46,580
way so here's a here's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> fantastic</font>

983
00:31:44,240 --> 00:31:52,190
<font color="#CCCCCC">little demo of how this would kind of</font>

984
00:31:46,580 --> 00:31:53,600
play out<font color="#E5E5E5"> it was really hard</font><font color="#CCCCCC"> to so we're</font>

985
00:31:52,190 --> 00:31:55,850
gonna<font color="#E5E5E5"> have our two victim devices are</font>

986
00:31:53,600 --> 00:31:57,740
<font color="#E5E5E5">going to be over here and we're gonna</font>

987
00:31:55,850 --> 00:31:59,030
<font color="#E5E5E5">have</font><font color="#CCCCCC"> our attacker attacking machine</font><font color="#E5E5E5"> it's</font>

988
00:31:57,740 --> 00:32:00,770
<font color="#E5E5E5">gonna be on the right the bottom right</font>

989
00:31:59,030 --> 00:32:02,600
of the network and our bottom right of

990
00:32:00,770 --> 00:32:05,510
the screen<font color="#E5E5E5"> screen and then over</font><font color="#CCCCCC"> on the</font>

991
00:32:02,600 --> 00:32:07,939
<font color="#CCCCCC">left we're</font><font color="#E5E5E5"> gonna have our legitimate</font>

992
00:32:05,510 --> 00:32:09,140
access<font color="#E5E5E5"> point and also another terminal</font>

993
00:32:07,940 --> 00:32:11,870
<font color="#CCCCCC">that's gonna send the alpaca so right</font>

994
00:32:09,140 --> 00:32:14,980
now we're forcing the victim devices to

995
00:32:11,870 --> 00:32:17,840
associate with<font color="#E5E5E5"> our rogue access point by</font>

996
00:32:14,980 --> 00:32:21,280
getting them to<font color="#E5E5E5"> roam using DL packets</font>

997
00:32:17,840 --> 00:32:23,030
<font color="#E5E5E5">and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> just do that with both of them</font>

998
00:32:21,280 --> 00:32:26,360
and<font color="#E5E5E5"> then when they're both associated</font>

999
00:32:23,030 --> 00:32:30,260
<font color="#E5E5E5">with us it's kind of doing</font><font color="#CCCCCC"> its thing</font>

1000
00:32:26,360 --> 00:32:32,530
there see we have one and we should<font color="#CCCCCC"> have</font>

1001
00:32:30,260 --> 00:32:34,280
the<font color="#E5E5E5"> other one like any second now so</font>

1002
00:32:32,530 --> 00:32:36,440
<font color="#CCCCCC">assume that</font><font color="#E5E5E5"> you see here we're actually</font>

1003
00:32:34,280 --> 00:32:38,899
using<font color="#E5E5E5"> Empire to pull this off anyone</font>

1004
00:32:36,440 --> 00:32:40,460
here used Empire<font color="#CCCCCC"> before</font><font color="#E5E5E5"> all right</font>

1005
00:32:38,900 --> 00:32:42,200
<font color="#CCCCCC">few hands</font><font color="#E5E5E5"> for those of you have</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> it</font>

1006
00:32:40,460 --> 00:32:43,370
<font color="#E5E5E5">you could</font><font color="#CCCCCC"> just think about it</font><font color="#E5E5E5"> this is</font>

1007
00:32:42,200 --> 00:32:44,660
technically false I think the creators

1008
00:32:43,370 --> 00:32:47,239
of<font color="#E5E5E5"> Empire would probably get mad</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> for</font>

1009
00:32:44,660 --> 00:32:48,530
<font color="#CCCCCC">saying this but it's a you can you can</font>

1010
00:32:47,240 --> 00:32:49,670
for this for the sake of this demo you

1011
00:32:48,530 --> 00:32:53,270
<font color="#E5E5E5">can think about it as</font><font color="#CCCCCC"> like Metasploit</font>

1012
00:32:49,670 --> 00:32:55,260
with<font color="#CCCCCC"> power cell so we're gonna get</font><font color="#E5E5E5"> the</font>

1013
00:32:53,270 --> 00:32:58,490
IP address of one of these

1014
00:32:55,260 --> 00:33:00,570
of one of<font color="#CCCCCC"> these</font><font color="#E5E5E5"> victims of Isis and</font>

1015
00:32:58,490 --> 00:33:02,669
we're going<font color="#E5E5E5"> to just copy paste it and</font>

1016
00:33:00,570 --> 00:33:03,990
feed it<font color="#CCCCCC"> to our</font><font color="#E5E5E5"> SMB relay server and you</font>

1017
00:33:02,669 --> 00:33:05,760
see this<font color="#E5E5E5"> this big chunk of basically</font>

1018
00:33:03,990 --> 00:33:07,950
<font color="#CCCCCC">four code that's our payload</font><font color="#E5E5E5"> and our SMB</font>

1019
00:33:05,760 --> 00:33:09,929
relay server<font color="#E5E5E5"> one that SMB real attack is</font>

1020
00:33:07,950 --> 00:33:11,490
<font color="#E5E5E5">it's triggered it's gonna actually it's</font>

1021
00:33:09,929 --> 00:33:13,470
gonna execute that that<font color="#E5E5E5"> payload on the</font>

1022
00:33:11,490 --> 00:33:15,150
victim so we<font color="#E5E5E5"> start</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> the SMB relay</font>

1023
00:33:13,470 --> 00:33:17,220
server and then we<font color="#E5E5E5"> generate some HTTP</font>

1024
00:33:15,150 --> 00:33:19,740
traffic on this<font color="#CCCCCC"> victim up in the top</font>

1025
00:33:17,220 --> 00:33:21,360
right<font color="#E5E5E5"> so we just do that but just kind</font>

1026
00:33:19,740 --> 00:33:22,169
of typing some stuff in the browser<font color="#E5E5E5"> all</font>

1027
00:33:21,360 --> 00:33:24,209
right now you see<font color="#E5E5E5"> all this activity</font>

1028
00:33:22,169 --> 00:33:26,190
<font color="#E5E5E5">there that's the SMB relay server doing</font>

1029
00:33:24,210 --> 00:33:28,530
its thing<font color="#CCCCCC"> and you know pretty soon</font><font color="#E5E5E5"> at</font>

1030
00:33:26,190 --> 00:33:32,780
some point soon we<font color="#CCCCCC"> should see a connect</font>

1031
00:33:28,530 --> 00:33:34,980
back from our initial our initial agent

1032
00:33:32,780 --> 00:33:38,428
and we see that<font color="#E5E5E5"> that green thing there</font>

1033
00:33:34,980 --> 00:33:39,690
<font color="#E5E5E5">okay so now at this</font><font color="#CCCCCC"> stage</font><font color="#E5E5E5"> you know both</font>

1034
00:33:38,429 --> 00:33:41,910
these devices<font color="#CCCCCC"> are still connected to our</font>

1035
00:33:39,690 --> 00:33:46,080
rogue access point<font color="#CCCCCC"> but we have we now</font>

1036
00:33:41,910 --> 00:33:47,850
have a essentially a shell on one of

1037
00:33:46,080 --> 00:33:50,520
<font color="#E5E5E5">these devices so let's find out you know</font>

1038
00:33:47,850 --> 00:33:54,149
which shell we're actually<font color="#E5E5E5"> looking at</font>

1039
00:33:50,520 --> 00:33:55,980
here<font color="#CCCCCC"> I'm gonna if we do a shell Who am I</font>

1040
00:33:54,150 --> 00:33:57,600
we see we have<font color="#E5E5E5"> anti-authority system</font>

1041
00:33:55,980 --> 00:33:59,760
privileges we do a shell

1042
00:33:57,600 --> 00:34:02,969
<font color="#E5E5E5">hostname that's gonna tell us</font><font color="#CCCCCC"> which</font>

1043
00:33:59,760 --> 00:34:04,980
these two devices were<font color="#CCCCCC"> connected to it</font>

1044
00:34:02,970 --> 00:34:06,960
looks like we're connected<font color="#CCCCCC"> to</font><font color="#E5E5E5"> two</font>

1045
00:34:04,980 --> 00:34:09,869
<font color="#CCCCCC">jenkins</font><font color="#E5E5E5"> so we're this guy open the</font><font color="#CCCCCC"> top</font>

1046
00:34:06,960 --> 00:34:13,639
left<font color="#E5E5E5"> and</font><font color="#CCCCCC"> at this point</font><font color="#E5E5E5"> we're just gonna</font>

1047
00:34:09,869 --> 00:34:15,659
use this<font color="#E5E5E5"> as the</font><font color="#CCCCCC"> scheduled</font><font color="#E5E5E5"> task</font><font color="#CCCCCC"> module</font><font color="#E5E5E5"> to</font>

1048
00:34:13,639 --> 00:34:18,060
execute<font color="#E5E5E5"> another reverse shell but this</font>

1049
00:34:15,659 --> 00:34:19,139
time back to our first interface<font color="#E5E5E5"> that's</font>

1050
00:34:18,060 --> 00:34:21,090
stuck<font color="#E5E5E5"> on that corn TVland</font>

1051
00:34:19,139 --> 00:34:23,700
after a set<font color="#CCCCCC"> period of time</font><font color="#E5E5E5"> we're gonna</font>

1052
00:34:21,090 --> 00:34:31,109
say two minutes<font color="#CCCCCC"> in the future</font><font color="#E5E5E5"> and you're</font>

1053
00:34:23,699 --> 00:34:32,069
just gonna set that<font color="#E5E5E5"> up here</font><font color="#CCCCCC"> so it's also</font>

1054
00:34:31,109 --> 00:34:33,359
recording<font color="#E5E5E5"> that something really</font>

1055
00:34:32,070 --> 00:34:35,010
interesting happened and that<font color="#E5E5E5"> was that</font>

1056
00:34:33,359 --> 00:34:37,290
<font color="#CCCCCC">you know being a dirtbike aynd of like</font><font color="#E5E5E5"> I</font>

1057
00:34:35,010 --> 00:34:40,710
actually forgot to attach<font color="#E5E5E5"> the virtual</font>

1058
00:34:37,290 --> 00:34:43,230
USB interface for the the upstream<font color="#E5E5E5"> Nick</font>

1059
00:34:40,710 --> 00:34:45,090
<font color="#E5E5E5">the one that's on the restricted VLAN to</font>

1060
00:34:43,230 --> 00:34:46,980
the attacker<font color="#E5E5E5"> attacking virtual machine</font>

1061
00:34:45,090 --> 00:34:48,179
<font color="#E5E5E5">you know so like I was like oh man I'm</font>

1062
00:34:46,980 --> 00:34:51,330
gonna<font color="#E5E5E5"> have to like rerecord everything</font>

1063
00:34:48,179 --> 00:34:52,619
so you<font color="#CCCCCC"> know III reattached it and you're</font>

1064
00:34:51,330 --> 00:34:53,580
gonna see this<font color="#E5E5E5"> in a second but then</font>

1065
00:34:52,619 --> 00:34:55,950
something<font color="#E5E5E5"> really</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> and</font>

1066
00:34:53,580 --> 00:34:57,149
interesting happened<font color="#CCCCCC"> actually it</font>

1067
00:34:55,949 --> 00:34:59,730
<font color="#CCCCCC">actually did succeed anyways and</font><font color="#E5E5E5"> the</font>

1068
00:34:57,149 --> 00:35:02,700
reason<font color="#E5E5E5"> for this is that I'd set 160</font>

1069
00:34:59,730 --> 00:35:06,020
retries on on the<font color="#CCCCCC"> on that</font><font color="#E5E5E5"> reverse shell</font>

1070
00:35:02,700 --> 00:35:07,910
so when<font color="#E5E5E5"> I when I</font>

1071
00:35:06,020 --> 00:35:11,690
when<font color="#E5E5E5"> I reattached it and you're gonna</font>

1072
00:35:07,910 --> 00:35:13,009
see<font color="#E5E5E5"> that kind of happen and you</font><font color="#CCCCCC"> probably</font>

1073
00:35:11,690 --> 00:35:14,150
<font color="#E5E5E5">want</font><font color="#CCCCCC"> to sit see I'm actually moving</font><font color="#E5E5E5"> my</font>

1074
00:35:13,010 --> 00:35:16,450
mouse around<font color="#CCCCCC"> close so</font><font color="#E5E5E5"> board is waiting</font>

1075
00:35:14,150 --> 00:35:21,190
<font color="#CCCCCC">for the scheduled tasks to happen</font>

1076
00:35:16,450 --> 00:35:23,629
yeah I'm sparing you<font color="#CCCCCC"> the agony</font><font color="#E5E5E5"> of that</font>

1077
00:35:21,190 --> 00:35:24,800
that's where I'm like<font color="#E5E5E5"> this is kind of</font>

1078
00:35:23,630 --> 00:35:29,510
<font color="#E5E5E5">like the oh moment here where I'm</font>

1079
00:35:24,800 --> 00:35:32,869
like yeah<font color="#E5E5E5"> whoops but at this point you</font>

1080
00:35:29,510 --> 00:35:34,220
know you see I start clearing the start

1081
00:35:32,869 --> 00:35:35,600
clearing of my terminals and<font color="#E5E5E5"> stuff like</font>

1082
00:35:34,220 --> 00:35:37,549
that to get ready<font color="#E5E5E5"> to just redo all this</font>

1083
00:35:35,600 --> 00:35:38,720
stuff I go back here start to type back

1084
00:35:37,550 --> 00:35:40,190
to get<font color="#E5E5E5"> back to the main menu of</font><font color="#CCCCCC"> Empire</font>

1085
00:35:38,720 --> 00:35:41,720
<font color="#E5E5E5">no</font><font color="#CCCCCC"> away</font><font color="#E5E5E5"> that screen thing down there</font><font color="#CCCCCC"> oh</font>

1086
00:35:40,190 --> 00:35:43,490
wait it<font color="#CCCCCC"> actually did work and what</font>

1087
00:35:41,720 --> 00:35:44,779
happened was that<font color="#CCCCCC"> you know despite</font><font color="#E5E5E5"> the</font>

1088
00:35:43,490 --> 00:35:47,149
<font color="#E5E5E5">fact that the network interface wasn't</font>

1089
00:35:44,780 --> 00:35:49,070
connected<font color="#CCCCCC"> because</font><font color="#E5E5E5"> there 160 retries it</font>

1090
00:35:47,150 --> 00:35:50,600
on there<font color="#CCCCCC"> it kept just kind</font><font color="#E5E5E5"> of dogged lis</font>

1091
00:35:49,070 --> 00:35:52,070
trying to connect back<font color="#E5E5E5"> to you</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

1092
00:35:50,600 --> 00:35:54,730
every now and then I try<font color="#CCCCCC"> to connect back</font>

1093
00:35:52,070 --> 00:35:57,590
<font color="#E5E5E5">to to the power the the</font><font color="#CCCCCC"> Empire listener</font>

1094
00:35:54,730 --> 00:35:58,670
on the restricted VLAN so I kind of

1095
00:35:57,590 --> 00:35:59,600
thought<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was cool</font><font color="#CCCCCC"> so I kind of left</font>

1096
00:35:58,670 --> 00:36:01,190
it<font color="#E5E5E5"> in there because it kind of</font>

1097
00:35:59,600 --> 00:36:02,839
<font color="#CCCCCC">illustrates a good point about like good</font>

1098
00:36:01,190 --> 00:36:04,250
malware<font color="#E5E5E5"> is that you know</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> if you</font>

1099
00:36:02,840 --> 00:36:05,780
<font color="#E5E5E5">can't get that initial reverse shell or</font>

1100
00:36:04,250 --> 00:36:07,070
even if you can't you know<font color="#CCCCCC"> like there's</font>

1101
00:36:05,780 --> 00:36:10,369
maybe some restrictions that prevent you

1102
00:36:07,070 --> 00:36:12,940
from sending<font color="#CCCCCC"> traffic from</font><font color="#E5E5E5"> the from the</font>

1103
00:36:10,369 --> 00:36:15,020
restricted VLAN to the quarantine VLAN

1104
00:36:12,940 --> 00:36:16,850
there are the<font color="#E5E5E5"> things you can do and and</font>

1105
00:36:15,020 --> 00:36:21,020
and and you<font color="#CCCCCC"> may be able</font><font color="#E5E5E5"> to do some</font>

1106
00:36:16,850 --> 00:36:23,060
<font color="#E5E5E5">damage anyways so the equivalent</font>

1107
00:36:21,020 --> 00:36:24,560
technique<font color="#E5E5E5"> in a while in a wired network</font>

1108
00:36:23,060 --> 00:36:26,420
would<font color="#E5E5E5"> be like literally going up to a</font>

1109
00:36:24,560 --> 00:36:28,130
switch just unplugging an authorized

1110
00:36:26,420 --> 00:36:29,359
<font color="#E5E5E5">electrical switch plugging it into your</font>

1111
00:36:28,130 --> 00:36:30,950
<font color="#CCCCCC">own network where you can attack it for</font>

1112
00:36:29,359 --> 00:36:33,109
a while and then plugging<font color="#E5E5E5"> it back into</font>

1113
00:36:30,950 --> 00:36:34,580
the network<font color="#CCCCCC"> and the reason why this</font>

1114
00:36:33,109 --> 00:36:36,380
works<font color="#E5E5E5"> is that you know pork-based access</font>

1115
00:36:34,580 --> 00:36:37,700
controls<font color="#E5E5E5"> they rely on the assumption</font>

1116
00:36:36,380 --> 00:36:39,040
<font color="#CCCCCC">that the physical layer can</font><font color="#E5E5E5"> be trusted</font>

1117
00:36:37,700 --> 00:36:42,049
<font color="#CCCCCC">in a</font><font color="#E5E5E5"> wireless network</font>

1118
00:36:39,040 --> 00:36:43,190
wpa2<font color="#E5E5E5"> ap is the means through which the</font>

1119
00:36:42,050 --> 00:36:44,930
integrity<font color="#E5E5E5"> of the physical layer is</font>

1120
00:36:43,190 --> 00:36:48,350
protected and if you're using a weak

1121
00:36:44,930 --> 00:36:49,850
form of wpa2 EAP<font color="#CCCCCC"> this means that</font>

1122
00:36:48,350 --> 00:36:51,290
attacker can actually freely control<font color="#E5E5E5"> the</font>

1123
00:36:49,850 --> 00:36:53,630
physical<font color="#CCCCCC"> layer using</font><font color="#E5E5E5"> rogue ap attacks</font>

1124
00:36:51,290 --> 00:36:56,900
<font color="#E5E5E5">and this completely renders</font><font color="#CCCCCC"> port-based</font>

1125
00:36:53,630 --> 00:36:59,150
<font color="#E5E5E5">nak mechanisms useless you know so what</font>

1126
00:36:56,900 --> 00:37:00,440
this<font color="#E5E5E5"> demonstrates</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> first thing that</font>

1127
00:36:59,150 --> 00:37:02,810
<font color="#CCCCCC">this demonstrates</font><font color="#E5E5E5"> is that</font><font color="#CCCCCC"> port-based</font>

1128
00:37:00,440 --> 00:37:05,210
<font color="#CCCCCC">nack mechanisms don't really</font><font color="#E5E5E5"> effectively</font>

1129
00:37:02,810 --> 00:37:07,880
mitigate the risk<font color="#E5E5E5"> presented by weak wpa2</font>

1130
00:37:05,210 --> 00:37:09,830
<font color="#E5E5E5">EAP implementations and it also</font>

1131
00:37:07,880 --> 00:37:11,600
demonstrates<font color="#CCCCCC"> that adding port-based</font><font color="#E5E5E5"> nak</font>

1132
00:37:09,830 --> 00:37:13,609
mechanisms to a<font color="#E5E5E5"> wireless network</font><font color="#CCCCCC"> it</font>

1133
00:37:11,600 --> 00:37:15,560
doesn't make the use of<font color="#E5E5E5"> EAP TLS or EAP</font>

1134
00:37:13,609 --> 00:37:16,759
<font color="#CCCCCC">PEEP any less inappropriate if the</font>

1135
00:37:15,560 --> 00:37:18,180
network<font color="#E5E5E5"> in question it's used to grant</font>

1136
00:37:16,760 --> 00:37:20,440
access<font color="#E5E5E5"> to sensitive information</font>

1137
00:37:18,180 --> 00:37:21,669
so I'm gonna<font color="#E5E5E5"> make you know before we</font>

1138
00:37:20,440 --> 00:37:24,640
kind<font color="#E5E5E5"> of wrap this up gonna make one</font><font color="#CCCCCC"> last</font>

1139
00:37:21,670 --> 00:37:26,109
kind<font color="#E5E5E5"> of ditch case for eap-tls</font><font color="#CCCCCC"> you know</font>

1140
00:37:24,640 --> 00:37:27,430
if you tell<font color="#E5E5E5"> us actually it's not that</font><font color="#CCCCCC"> as</font>

1141
00:37:26,109 --> 00:37:28,690
bad as it<font color="#CCCCCC"> used to be you can use group</font>

1142
00:37:27,430 --> 00:37:31,089
<font color="#CCCCCC">policy to configure a toe to toe on</font>

1143
00:37:28,690 --> 00:37:32,559
<font color="#CCCCCC">ex-clients and your best</font><font color="#E5E5E5"> option is</font><font color="#CCCCCC"> just</font>

1144
00:37:31,089 --> 00:37:34,750
<font color="#E5E5E5">to use an internal you like a private</font><font color="#CCCCCC"> CA</font>

1145
00:37:32,559 --> 00:37:36,819
and leverage a B as much as<font color="#CCCCCC"> possible to</font>

1146
00:37:34,750 --> 00:37:38,650
deploy<font color="#CCCCCC"> apt LS</font><font color="#E5E5E5"> if you have BYOD devices</font>

1147
00:37:36,819 --> 00:37:40,119
that you have<font color="#CCCCCC"> to worry about you</font><font color="#E5E5E5"> can</font>

1148
00:37:38,650 --> 00:37:43,509
address<font color="#E5E5E5"> that most the time using a solid</font>

1149
00:37:40,119 --> 00:37:44,950
MDM or BYOD<font color="#E5E5E5"> onboarding solution and you</font>

1150
00:37:43,509 --> 00:37:46,180
know if you're<font color="#CCCCCC"> really desperate I guess</font>

1151
00:37:44,950 --> 00:37:48,038
you can even use let's encrypt although

1152
00:37:46,180 --> 00:37:49,089
<font color="#CCCCCC">even on let's encrypt let's encrypt so</font>

1153
00:37:48,039 --> 00:37:50,289
<font color="#E5E5E5">website and the part of the</font>

1154
00:37:49,089 --> 00:37:51,519
documentation<font color="#E5E5E5"> where they where</font><font color="#CCCCCC"> they talk</font>

1155
00:37:50,289 --> 00:37:52,930
<font color="#CCCCCC">about</font><font color="#E5E5E5"> doing it that</font><font color="#CCCCCC"> way they have this</font>

1156
00:37:51,519 --> 00:37:54,250
big disclaimer<font color="#E5E5E5"> that</font><font color="#CCCCCC"> says we don't think</font>

1157
00:37:52,930 --> 00:37:57,279
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> a good</font><font color="#E5E5E5"> idea but if you wanted to</font>

1158
00:37:54,250 --> 00:37:59,289
<font color="#CCCCCC">do it here's how so you do have options</font>

1159
00:37:57,279 --> 00:37:59,710
available to<font color="#E5E5E5"> you so just</font><font color="#CCCCCC"> some closing</font>

1160
00:37:59,289 --> 00:38:01,720
thoughts

1161
00:37:59,710 --> 00:38:03,400
<font color="#CCCCCC">just because</font><font color="#E5E5E5"> wireless wired networks</font>

1162
00:38:01,720 --> 00:38:05,019
operate similarly<font color="#E5E5E5"> at the logical level</font>

1163
00:38:03,400 --> 00:38:06,730
<font color="#E5E5E5">this does not mean that they work the</font>

1164
00:38:05,019 --> 00:38:07,868
<font color="#CCCCCC">same way at the</font><font color="#E5E5E5"> physical level</font><font color="#CCCCCC"> you know</font>

1165
00:38:06,730 --> 00:38:09,609
as a<font color="#CCCCCC"> community we really should question</font>

1166
00:38:07,869 --> 00:38:12,849
<font color="#E5E5E5">whether</font><font color="#CCCCCC"> it's truly a sound business</font>

1167
00:38:09,609 --> 00:38:14,529
decisions<font color="#E5E5E5"> and to neglect eap-tls in in</font>

1168
00:38:12,849 --> 00:38:15,940
<font color="#E5E5E5">favor of a more reactive</font><font color="#CCCCCC"> approach that</font>

1169
00:38:14,529 --> 00:38:18,579
<font color="#CCCCCC">focuses on access control and threat</font>

1170
00:38:15,940 --> 00:38:19,809
containment and and<font color="#E5E5E5"> finally if there's</font>

1171
00:38:18,579 --> 00:38:21,250
one thing you take<font color="#CCCCCC"> away from this it's</font>

1172
00:38:19,809 --> 00:38:22,450
<font color="#CCCCCC">that the needs for convenience and</font>

1173
00:38:21,250 --> 00:38:23,799
<font color="#CCCCCC">security are often at odds with one</font>

1174
00:38:22,450 --> 00:38:26,078
another<font color="#CCCCCC"> and maintain a healthy</font>

1175
00:38:23,799 --> 00:38:29,579
<font color="#E5E5E5">skepticism for proposed solutions that</font>

1176
00:38:26,079 --> 00:38:29,579
promise<font color="#E5E5E5"> both thank you</font>

1177
00:38:29,890 --> 00:38:54,089
[Applause]

1178
00:38:32,480 --> 00:38:54,089
[Music]

