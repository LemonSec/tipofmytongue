1
00:00:00,840 --> 00:00:02,820
right thanks for the introduction there

2
00:00:02,820 --> 00:00:03,899
so

3
00:00:03,899 --> 00:00:05,880
um I am going to be talking about how we

4
00:00:05,880 --> 00:00:08,460
hack ships today my name's Andrew

5
00:00:08,460 --> 00:00:10,740
um I work for a pen testing company but

6
00:00:10,740 --> 00:00:13,799
I used to work on ships this is me 16

7
00:00:13,799 --> 00:00:16,320
years ago as a marine engineer on a

8
00:00:16,320 --> 00:00:18,480
container ship in the Suez Canal

9
00:00:18,480 --> 00:00:20,220
um my forehead is probably about as

10
00:00:20,220 --> 00:00:23,100
shiny as it was back then as well

11
00:00:23,100 --> 00:00:24,480
I used to work on things like this

12
00:00:24,480 --> 00:00:27,119
massive container ships 300 meters long

13
00:00:27,119 --> 00:00:29,699
330 meters long carrying somewhere

14
00:00:29,699 --> 00:00:31,500
between six and eight thousand

15
00:00:31,500 --> 00:00:34,140
containers so the the biggest container

16
00:00:34,140 --> 00:00:36,239
ships back in those days it's given me

17
00:00:36,239 --> 00:00:37,920
insight into how these things work and

18
00:00:37,920 --> 00:00:39,239
what they do

19
00:00:39,239 --> 00:00:41,340
so I'm going to take you through how we

20
00:00:41,340 --> 00:00:43,920
hack ships what we do and what a

21
00:00:43,920 --> 00:00:45,660
security consultant a pen tester someone

22
00:00:45,660 --> 00:00:47,640
who works with ships what they can do to

23
00:00:47,640 --> 00:00:49,620
improve the security of these it's going

24
00:00:49,620 --> 00:00:51,180
to be a bit of fun though at the end of

25
00:00:51,180 --> 00:00:53,340
this hopefully I'll show you how I've

26
00:00:53,340 --> 00:00:56,160
sat on my sofa in my pants taking

27
00:00:56,160 --> 00:01:00,120
control of a cruise ship over TeamViewer

28
00:01:00,120 --> 00:01:01,320
the first thing I want to talk about is

29
00:01:01,320 --> 00:01:03,539
accurate threat models to work with any

30
00:01:03,539 --> 00:01:05,519
system to work out what you can do to

31
00:01:05,519 --> 00:01:07,799
impact it you need to understand how it

32
00:01:07,799 --> 00:01:09,540
works what's the worst thing you can do

33
00:01:09,540 --> 00:01:11,460
what's the likely things that you can do

34
00:01:11,460 --> 00:01:13,920
what attacks can you carry out so let's

35
00:01:13,920 --> 00:01:15,659
talk about ships

36
00:01:15,659 --> 00:01:17,939
now this is the engine on one of the

37
00:01:17,939 --> 00:01:20,220
container ships I worked on this is just

38
00:01:20,220 --> 00:01:22,619
the top bit of the engine that red box

39
00:01:22,619 --> 00:01:25,320
there is just the exhaust valve of one

40
00:01:25,320 --> 00:01:27,420
of the cylinders they're really really

41
00:01:27,420 --> 00:01:29,580
quite big they go from but they're three

42
00:01:29,580 --> 00:01:31,920
stories high from top to bottom

43
00:01:31,920 --> 00:01:34,200
looking up you can see there's ladders

44
00:01:34,200 --> 00:01:36,180
you've got the bottom plates the middle

45
00:01:36,180 --> 00:01:37,799
plates and the top plates you've got

46
00:01:37,799 --> 00:01:41,159
three different levels on those engines

47
00:01:41,159 --> 00:01:44,579
this is one of the two turbochargers on

48
00:01:44,579 --> 00:01:46,140
that engine there

49
00:01:46,140 --> 00:01:48,780
so this here is the the inlet side so

50
00:01:48,780 --> 00:01:50,280
that's compressing the air to force air

51
00:01:50,280 --> 00:01:51,960
into the engine the other side of it is

52
00:01:51,960 --> 00:01:54,780
the exhaust side

53
00:01:54,780 --> 00:01:56,640
this is a cross section not my picture

54
00:01:56,640 --> 00:01:58,140
I've never chopped one of these engines

55
00:01:58,140 --> 00:01:59,820
in half and that's a banana for scale

56
00:01:59,820 --> 00:02:01,920
obviously you have to shrink it down a

57
00:02:01,920 --> 00:02:03,479
little bit but you can see there's a man

58
00:02:03,479 --> 00:02:05,759
stood up there on the top these things

59
00:02:05,759 --> 00:02:08,880
are genuinely huge

60
00:02:08,880 --> 00:02:11,099
this is doing something called taking

61
00:02:11,099 --> 00:02:13,379
balls on the main engine so this is one

62
00:02:13,379 --> 00:02:15,660
of the cylinders we've taken the top off

63
00:02:15,660 --> 00:02:17,340
of it and we're looking to see how wide

64
00:02:17,340 --> 00:02:20,819
it is it's 96 centimeters across almost

65
00:02:20,819 --> 00:02:23,340
a meter from side to side we're checking

66
00:02:23,340 --> 00:02:25,440
how much it's worn that was on one of

67
00:02:25,440 --> 00:02:28,680
the ships I was on before I got on board

68
00:02:28,680 --> 00:02:30,540
so just out like that it's three stories

69
00:02:30,540 --> 00:02:32,760
high the one we looked at there has got

70
00:02:32,760 --> 00:02:35,160
10 units we call them units but they're

71
00:02:35,160 --> 00:02:36,959
cylinders in reality

72
00:02:36,959 --> 00:02:40,319
it's 96 centimeters across but 2.4

73
00:02:40,319 --> 00:02:42,420
meters stroke so that piston goes up and

74
00:02:42,420 --> 00:02:44,459
down 2.4 meters

75
00:02:44,459 --> 00:02:48,360
that results in 1 810 liters per

76
00:02:48,360 --> 00:02:50,340
cylinder it's a little bit bigger than

77
00:02:50,340 --> 00:02:52,019
your normal engine here it's a

78
00:02:52,019 --> 00:02:53,519
two-stroke diesel engine though it's not

79
00:02:53,519 --> 00:02:56,220
a four-stroke it's very very different

80
00:02:56,220 --> 00:02:59,160
but as a result that huge stroke it can

81
00:02:59,160 --> 00:03:02,760
only go at 102 RPM that's the maximum

82
00:03:02,760 --> 00:03:04,140
rate that it can spin around that

83
00:03:04,140 --> 00:03:06,000
compared to a car engine that can do

84
00:03:06,000 --> 00:03:08,580
6000 RPM is pretty different

85
00:03:08,580 --> 00:03:11,519
but it still develops 55 megawatts of

86
00:03:11,519 --> 00:03:13,620
power this is a small Power Station

87
00:03:13,620 --> 00:03:17,040
dumping that power into the sea and as a

88
00:03:17,040 --> 00:03:20,040
result it burns about 250 tons of heavy

89
00:03:20,040 --> 00:03:22,140
fuel oil every single day

90
00:03:22,140 --> 00:03:24,540
absolutely massive

91
00:03:24,540 --> 00:03:25,920
how do you get that power from the main

92
00:03:25,920 --> 00:03:28,140
engine into the sea well you need a prop

93
00:03:28,140 --> 00:03:30,599
shaft it's a massive chunk of Steel that

94
00:03:30,599 --> 00:03:32,340
runs from the main engine all the way

95
00:03:32,340 --> 00:03:34,140
down to the propeller there is no

96
00:03:34,140 --> 00:03:36,239
gearbox if you want to change direction

97
00:03:36,239 --> 00:03:38,459
if you want to go in reverse you stop

98
00:03:38,459 --> 00:03:40,140
the main engine and you turn it round

99
00:03:40,140 --> 00:03:42,659
and make it go the other way

100
00:03:42,659 --> 00:03:44,760
so how big is the propeller on one of

101
00:03:44,760 --> 00:03:47,280
these things well it's really big

102
00:03:47,280 --> 00:03:49,799
um this is the Ned Lloyd Southampton

103
00:03:49,799 --> 00:03:51,959
when it was in Dry Dock so that is the

104
00:03:51,959 --> 00:03:54,299
propeller there absolutely huge that's

105
00:03:54,299 --> 00:03:56,400
the uh the old man the captain stood

106
00:03:56,400 --> 00:03:58,500
next to a potato quality because it was

107
00:03:58,500 --> 00:04:02,700
kind of year 2004 or something like that

108
00:04:02,700 --> 00:04:04,080
a really interesting thing is how do you

109
00:04:04,080 --> 00:04:05,819
work out how much power this main engine

110
00:04:05,819 --> 00:04:07,799
is putting into the sea how do you work

111
00:04:07,799 --> 00:04:09,360
out how much power that engine's

112
00:04:09,360 --> 00:04:11,519
developing well we've got a power meter

113
00:04:11,519 --> 00:04:13,980
like you'd have on a bike or a car or

114
00:04:13,980 --> 00:04:15,780
something like that it works out how

115
00:04:15,780 --> 00:04:17,760
fast it's spinning and then it looks at

116
00:04:17,760 --> 00:04:19,620
that massive chunk of metal that prop

117
00:04:19,620 --> 00:04:21,298
shaft that I just showed you and it

118
00:04:21,298 --> 00:04:23,340
works out how much it's twisting it

119
00:04:23,340 --> 00:04:25,440
looks at the torsion on that if it

120
00:04:25,440 --> 00:04:27,180
twists more you're developing more power

121
00:04:27,180 --> 00:04:29,600
at this moment in time we're developing

122
00:04:29,600 --> 00:04:33,060
33.76 megawatts of power not that much

123
00:04:33,060 --> 00:04:35,220
at that point in time

124
00:04:35,220 --> 00:04:37,139
now to support one of these engines you

125
00:04:37,139 --> 00:04:39,240
need loads of things called ancillaries

126
00:04:39,240 --> 00:04:41,900
you've got pumps loads of pumps to move

127
00:04:41,900 --> 00:04:45,060
cooling water sea water oil and so on

128
00:04:45,060 --> 00:04:46,979
around the engine you've got to dump

129
00:04:46,979 --> 00:04:49,020
that power or that heat that comes from

130
00:04:49,020 --> 00:04:50,820
the engine the waste heat into the sea

131
00:04:50,820 --> 00:04:52,620
so you've got heat exchangers which are

132
00:04:52,620 --> 00:04:54,540
those things I'm showing you up on the

133
00:04:54,540 --> 00:04:56,460
right hand side there they're massive

134
00:04:56,460 --> 00:04:58,860
titanium stacks of plates that change

135
00:04:58,860 --> 00:05:01,979
from seawater through to cooling water

136
00:05:01,979 --> 00:05:03,840
how do you start one of these engines

137
00:05:03,840 --> 00:05:06,240
well you don't have a starter motor you

138
00:05:06,240 --> 00:05:07,979
start them with compressed air

139
00:05:07,979 --> 00:05:10,139
these are the two starter bottles on one

140
00:05:10,139 --> 00:05:11,880
of these main engines each one of them

141
00:05:11,880 --> 00:05:14,280
holds Air at about 30 bar

142
00:05:14,280 --> 00:05:15,900
so that's a really really high pressure

143
00:05:15,900 --> 00:05:19,380
450 PSI or so and you inject it into the

144
00:05:19,380 --> 00:05:21,600
cylinders like you would with a

145
00:05:21,600 --> 00:05:24,060
distributor on a car sending Sparks into

146
00:05:24,060 --> 00:05:25,800
cylinders you push air into the

147
00:05:25,800 --> 00:05:28,259
cylinders that's how you start them

148
00:05:28,259 --> 00:05:29,400
of course you've got to fill them up

149
00:05:29,400 --> 00:05:31,139
with air so you've got air compressors

150
00:05:31,139 --> 00:05:33,720
three air compressors there

151
00:05:33,720 --> 00:05:35,400
um really really dated design going back

152
00:05:35,400 --> 00:05:37,320
to the 1950s but powering these modern

153
00:05:37,320 --> 00:05:38,400
engines

154
00:05:38,400 --> 00:05:40,320
where do these air compressors get their

155
00:05:40,320 --> 00:05:41,699
power from well you can't get the power

156
00:05:41,699 --> 00:05:42,960
from the main engine because it's not

157
00:05:42,960 --> 00:05:43,919
running

158
00:05:43,919 --> 00:05:46,860
so you have four maybe five diesel

159
00:05:46,860 --> 00:05:49,139
generators each one of these sits at

160
00:05:49,139 --> 00:05:51,180
about 3.4 megawatts

161
00:05:51,180 --> 00:05:53,340
so you can generate 12 megawatts of

162
00:05:53,340 --> 00:05:55,680
power independent the main engine that's

163
00:05:55,680 --> 00:05:58,020
obviously quite a lot of power but how

164
00:05:58,020 --> 00:05:59,759
do you start these diesel generators

165
00:05:59,759 --> 00:06:02,100
well if you need to start these you need

166
00:06:02,100 --> 00:06:03,539
to fill up another tank full of

167
00:06:03,539 --> 00:06:05,280
compressed air which needs another

168
00:06:05,280 --> 00:06:06,720
smaller engine called the emergency

169
00:06:06,720 --> 00:06:09,000
diesel generated to start it it's

170
00:06:09,000 --> 00:06:10,860
starting to sound complicated it's a

171
00:06:10,860 --> 00:06:12,419
long chain of things that need to work

172
00:06:12,419 --> 00:06:15,720
for the ship to go and run so if you

173
00:06:15,720 --> 00:06:17,820
want to go from a black start no power

174
00:06:17,820 --> 00:06:19,020
on the ship you need to start the

175
00:06:19,020 --> 00:06:21,060
emergency generator run a single air

176
00:06:21,060 --> 00:06:23,699
compressor charge the generator starter

177
00:06:23,699 --> 00:06:26,220
start an individual generator run more

178
00:06:26,220 --> 00:06:27,600
air compressors off the back of that

179
00:06:27,600 --> 00:06:30,060
charge the main engine starter and

180
00:06:30,060 --> 00:06:31,919
finally start the main engine that's

181
00:06:31,919 --> 00:06:33,419
quite a big chain of things to occur

182
00:06:33,419 --> 00:06:34,500
there

183
00:06:34,500 --> 00:06:36,960
now in emergency conditions sometimes

184
00:06:36,960 --> 00:06:38,580
all of the automatic controls that make

185
00:06:38,580 --> 00:06:40,259
you start and stop that mate engine main

186
00:06:40,259 --> 00:06:42,780
engine might break and you'll you'll

187
00:06:42,780 --> 00:06:45,360
have to control the main engine manually

188
00:06:45,360 --> 00:06:47,520
on the side of the main engine there are

189
00:06:47,520 --> 00:06:49,199
literally sticks that let you control

190
00:06:49,199 --> 00:06:51,419
the throttle on this thing you call it

191
00:06:51,419 --> 00:06:53,400
riding the sticks so you've got one that

192
00:06:53,400 --> 00:06:54,840
chooses which direction it goes in

193
00:06:54,840 --> 00:06:56,400
you've got one that chooses whether

194
00:06:56,400 --> 00:06:58,560
you're going and one that chooses what

195
00:06:58,560 --> 00:06:59,880
throttle you're at

196
00:06:59,880 --> 00:07:01,380
so you sit there and you've got to

197
00:07:01,380 --> 00:07:02,940
regulate it manually if all the control

198
00:07:02,940 --> 00:07:05,100
systems fail

199
00:07:05,100 --> 00:07:06,360
if you're running under automated

200
00:07:06,360 --> 00:07:10,199
systems you get about 10 or 12 changes

201
00:07:10,199 --> 00:07:12,000
of Direction so if you want to go

202
00:07:12,000 --> 00:07:14,340
forwards backwards that starter will

203
00:07:14,340 --> 00:07:17,160
last 10 or 12 start to the engine if

204
00:07:17,160 --> 00:07:18,660
you're doing it manually riding the

205
00:07:18,660 --> 00:07:21,120
sticks you're down to three four or five

206
00:07:21,120 --> 00:07:23,759
starts before you run out of air it's a

207
00:07:23,759 --> 00:07:25,680
massive difference

208
00:07:25,680 --> 00:07:27,900
so why am I talking about this

209
00:07:27,900 --> 00:07:29,940
well a weird thing about container ships

210
00:07:29,940 --> 00:07:31,199
is you've just got that one big

211
00:07:31,199 --> 00:07:33,780
propeller you've just got one rudder if

212
00:07:33,780 --> 00:07:35,460
your propeller is not spinning round if

213
00:07:35,460 --> 00:07:37,560
you don't have any forward momentum the

214
00:07:37,560 --> 00:07:39,060
rudder does not do anything

215
00:07:39,060 --> 00:07:40,680
there's no water flowing over that

216
00:07:40,680 --> 00:07:43,139
Rudder you will lose control you cannot

217
00:07:43,139 --> 00:07:46,139
steer and that causes problems like this

218
00:07:46,139 --> 00:07:49,020
so this is the Milano Bridge

219
00:07:49,020 --> 00:07:51,000
um this happened a few years ago it was

220
00:07:51,000 --> 00:07:52,680
a very very large container ship that

221
00:07:52,680 --> 00:07:54,780
just came out of dry dock you might

222
00:07:54,780 --> 00:07:56,759
notice something about it there it looks

223
00:07:56,759 --> 00:07:59,160
very very high up out of the water

224
00:07:59,160 --> 00:08:00,900
so they just come out of dry dock there

225
00:08:00,900 --> 00:08:02,880
was no cargo on board they hadn't had

226
00:08:02,880 --> 00:08:05,400
taken any ballast water on board the

227
00:08:05,400 --> 00:08:07,380
prop was half out of the water and they

228
00:08:07,380 --> 00:08:09,840
had virtually no maneuvering power

229
00:08:09,840 --> 00:08:12,599
now if you can identify threats that any

230
00:08:12,599 --> 00:08:14,819
of those individual stages there

231
00:08:14,819 --> 00:08:16,860
through cyber security you could stop

232
00:08:16,860 --> 00:08:18,720
them working you can cause things like

233
00:08:18,720 --> 00:08:21,060
this to happen there are lots of single

234
00:08:21,060 --> 00:08:24,240
points of failures in ships

235
00:08:24,240 --> 00:08:26,580
another thing nearly All Ships these

236
00:08:26,580 --> 00:08:29,460
days use something called an ectus which

237
00:08:29,460 --> 00:08:30,960
is the charting system

238
00:08:30,960 --> 00:08:32,880
so if you want to plot a passage if you

239
00:08:32,880 --> 00:08:34,380
want to know where you are this this

240
00:08:34,380 --> 00:08:35,458
shows you

241
00:08:35,458 --> 00:08:37,860
the thing is when I worked on ships you

242
00:08:37,860 --> 00:08:40,440
used to have a paper chart table you

243
00:08:40,440 --> 00:08:41,940
literally had paper charts and someone

244
00:08:41,940 --> 00:08:43,679
would plot where you were going on there

245
00:08:43,679 --> 00:08:45,720
you could plot your Passage

246
00:08:45,720 --> 00:08:47,399
the thing is nowadays they've completely

247
00:08:47,399 --> 00:08:50,220
got rid of these you have two actors no

248
00:08:50,220 --> 00:08:51,660
paper chart

249
00:08:51,660 --> 00:08:54,240
from a perspective of an attacker if I

250
00:08:54,240 --> 00:08:56,160
can take out both of those actors I've

251
00:08:56,160 --> 00:08:58,140
stopped that ship working it can no

252
00:08:58,140 --> 00:09:00,180
longer Sail

253
00:09:00,180 --> 00:09:01,740
these ones seem quite obvious if we can

254
00:09:01,740 --> 00:09:03,060
stop the engines if I can stop

255
00:09:03,060 --> 00:09:06,420
Navigation that makes sense

256
00:09:06,420 --> 00:09:09,240
but what's this this is a fire alarm

257
00:09:09,240 --> 00:09:11,820
it seems kind of boring fire alarms are

258
00:09:11,820 --> 00:09:13,380
not the most interesting thing in the

259
00:09:13,380 --> 00:09:14,339
world

260
00:09:14,339 --> 00:09:15,899
but if you're on a passenger ship

261
00:09:15,899 --> 00:09:18,360
specifically larger cruise ships

262
00:09:18,360 --> 00:09:20,940
they've got three fire alarm systems one

263
00:09:20,940 --> 00:09:22,620
of the biggest threats to life on ships

264
00:09:22,620 --> 00:09:25,200
is fire you've really really wanted to

265
00:09:25,200 --> 00:09:27,240
take fire quickly and put it out so they

266
00:09:27,240 --> 00:09:29,040
have three fire alarm systems running

267
00:09:29,040 --> 00:09:30,120
together

268
00:09:30,120 --> 00:09:32,220
one of them's there for Pure redundancy

269
00:09:32,220 --> 00:09:34,260
if we take it out if it stops working

270
00:09:34,260 --> 00:09:36,720
you've still got those two everything's

271
00:09:36,720 --> 00:09:37,560
fine

272
00:09:37,560 --> 00:09:39,540
if we take out two of those fire alarms

273
00:09:39,540 --> 00:09:41,459
you've got a bigger problem now you need

274
00:09:41,459 --> 00:09:43,620
to do fire watches a member of crew will

275
00:09:43,620 --> 00:09:45,120
need to walk about the ship pretty much

276
00:09:45,120 --> 00:09:47,279
full time on a big cruise ship to check

277
00:09:47,279 --> 00:09:49,560
nothing's on fire so things are getting

278
00:09:49,560 --> 00:09:52,920
quite uh awkward at this point in time

279
00:09:52,920 --> 00:09:56,040
if I take out all of the fire systems we

280
00:09:56,040 --> 00:09:57,899
now need to disembark all passengers

281
00:09:57,899 --> 00:09:59,940
until the fire system is back up and

282
00:09:59,940 --> 00:10:00,899
working

283
00:10:00,899 --> 00:10:03,000
if you've got 6 000 passengers on board

284
00:10:03,000 --> 00:10:05,040
you're in a small Mediterranean island

285
00:10:05,040 --> 00:10:06,720
and you now suddenly need to get all of

286
00:10:06,720 --> 00:10:08,940
them back home that's going to cost you

287
00:10:08,940 --> 00:10:10,380
big money

288
00:10:10,380 --> 00:10:12,420
how did we identify this the day before

289
00:10:12,420 --> 00:10:14,519
we got on a ship a fire alarm engineer

290
00:10:14,519 --> 00:10:15,600
got on board

291
00:10:15,600 --> 00:10:17,940
he updated the firmware on all three of

292
00:10:17,940 --> 00:10:20,640
them at the same time and bricked all

293
00:10:20,640 --> 00:10:22,500
three of them

294
00:10:22,500 --> 00:10:24,180
luckily there were no passengers on

295
00:10:24,180 --> 00:10:25,860
board but we were told about it

296
00:10:25,860 --> 00:10:27,839
immediately I was not aware of this

297
00:10:27,839 --> 00:10:29,700
limitation and from a threat modeling

298
00:10:29,700 --> 00:10:31,380
perspective it's important to know these

299
00:10:31,380 --> 00:10:32,640
things

300
00:10:32,640 --> 00:10:34,800
but of course I'm talking about cyber

301
00:10:34,800 --> 00:10:36,720
threats here well we did manage to get

302
00:10:36,720 --> 00:10:39,240
route access to the firearms

303
00:10:39,240 --> 00:10:41,040
it's pretty easy another system linked

304
00:10:41,040 --> 00:10:43,980
into them we found a a script file that

305
00:10:43,980 --> 00:10:46,800
had the password and the username to

306
00:10:46,800 --> 00:10:48,300
download information from the fire alarm

307
00:10:48,300 --> 00:10:50,579
to feed it to another system we logged

308
00:10:50,579 --> 00:10:52,980
into it it wasn't the root user

309
00:10:52,980 --> 00:10:55,320
technically but we could still cut the

310
00:10:55,320 --> 00:10:57,660
shadow file destroy the file system and

311
00:10:57,660 --> 00:10:59,820
above all we could VNC into the fire

312
00:10:59,820 --> 00:11:02,700
alarm why has a fire alarm got VNC

313
00:11:02,700 --> 00:11:05,220
enabled on it so we could take that out

314
00:11:05,220 --> 00:11:08,160
and cause harm to that vessel

315
00:11:08,160 --> 00:11:10,380
another one's the voyage data recorder

316
00:11:10,380 --> 00:11:13,800
it's the black box on a ship the vdr

317
00:11:13,800 --> 00:11:15,959
and again we got network access to this

318
00:11:15,959 --> 00:11:17,160
and we thought we'd have a look at it

319
00:11:17,160 --> 00:11:19,200
what could we do with this well first

320
00:11:19,200 --> 00:11:21,060
off it had a very low level of access

321
00:11:21,060 --> 00:11:23,459
crew zero one with the password crew

322
00:11:23,459 --> 00:11:25,380
zero one and we can log into it it's in

323
00:11:25,380 --> 00:11:27,959
the documents it's it's easy to find and

324
00:11:27,959 --> 00:11:29,700
we found you could download a backup

325
00:11:29,700 --> 00:11:32,279
from that a backup of the configuration

326
00:11:32,279 --> 00:11:34,260
now with a bit of reverse engineering we

327
00:11:34,260 --> 00:11:35,579
realized you could pull out the password

328
00:11:35,579 --> 00:11:38,040
hashes for all of the users on there

329
00:11:38,040 --> 00:11:40,140
I've had to redact them

330
00:11:40,140 --> 00:11:41,940
um but we put those password hashes

331
00:11:41,940 --> 00:11:43,860
through our cracking rig and we quite

332
00:11:43,860 --> 00:11:46,140
quickly got a password for the account

333
00:11:46,140 --> 00:11:49,019
web admin and we could Now log into the

334
00:11:49,019 --> 00:11:51,000
admin interface the web interface using

335
00:11:51,000 --> 00:11:53,600
this other account

336
00:11:53,640 --> 00:11:55,320
from that perspective we found you could

337
00:11:55,320 --> 00:11:57,360
then edit the password file you couldn't

338
00:11:57,360 --> 00:11:59,160
edit edit the shadow file but you could

339
00:11:59,160 --> 00:12:01,200
edit the password file now web admin

340
00:12:01,200 --> 00:12:03,720
couldn't log in Via a shell at that

341
00:12:03,720 --> 00:12:05,700
moment in time for some reason it was

342
00:12:05,700 --> 00:12:07,320
running user Bim password when you tried

343
00:12:07,320 --> 00:12:09,660
logging in with web admin but we could

344
00:12:09,660 --> 00:12:10,860
edit this file

345
00:12:10,860 --> 00:12:13,380
so we changed it to bin.sh for that

346
00:12:13,380 --> 00:12:15,839
particular user and there you go we've

347
00:12:15,839 --> 00:12:17,700
now got a shell on the voyage data

348
00:12:17,700 --> 00:12:18,779
recorder

349
00:12:18,779 --> 00:12:20,640
the file system was not protected in any

350
00:12:20,640 --> 00:12:23,399
way shape or form an rm-rf on the root

351
00:12:23,399 --> 00:12:25,140
of that would have trashed it there is

352
00:12:25,140 --> 00:12:27,180
only one of them on the ship

353
00:12:27,180 --> 00:12:28,920
that would have been it it would not be

354
00:12:28,920 --> 00:12:31,620
able to sail at that point in time

355
00:12:31,620 --> 00:12:33,000
so it's always important to think about

356
00:12:33,000 --> 00:12:34,380
the different things you can do from

357
00:12:34,380 --> 00:12:36,240
different perspectives it's not always

358
00:12:36,240 --> 00:12:38,220
steering a ship remotely that's not

359
00:12:38,220 --> 00:12:40,200
always the biggest threat here what's

360
00:12:40,200 --> 00:12:42,420
the likely thing that can impact the

361
00:12:42,420 --> 00:12:44,100
ship

362
00:12:44,100 --> 00:12:45,420
they're kind of coming back to pen

363
00:12:45,420 --> 00:12:47,160
testing and I I want to call this an

364
00:12:47,160 --> 00:12:50,040
unfair Advantage I'm I'm fundamentally a

365
00:12:50,040 --> 00:12:51,720
really lazy person

366
00:12:51,720 --> 00:12:53,639
if I don't have to do work I'm not going

367
00:12:53,639 --> 00:12:55,079
to do the work

368
00:12:55,079 --> 00:12:56,459
um other people would like to call it

369
00:12:56,459 --> 00:12:59,220
efficient I prefer lazy to be fair

370
00:12:59,220 --> 00:13:02,279
but this is key Black Box pen testing

371
00:13:02,279 --> 00:13:04,680
it relies on your tester being better

372
00:13:04,680 --> 00:13:06,480
than your attackers and I don't think

373
00:13:06,480 --> 00:13:08,579
you can rely on that anymore attackers

374
00:13:08,579 --> 00:13:11,220
well they've got more time if you pay me

375
00:13:11,220 --> 00:13:12,839
two weeks to do a pen test I'm going to

376
00:13:12,839 --> 00:13:14,399
spend two weeks doing a pen test I'm not

377
00:13:14,399 --> 00:13:16,500
going to spend six months doing it

378
00:13:16,500 --> 00:13:18,660
they've probably got more skill I like

379
00:13:18,660 --> 00:13:20,399
to think I know what I'm doing my

380
00:13:20,399 --> 00:13:22,920
colleagues probably don't but

381
00:13:22,920 --> 00:13:25,800
our attackers people can be experts in

382
00:13:25,800 --> 00:13:27,540
the industry they can be insiders from

383
00:13:27,540 --> 00:13:29,880
companies that produce these systems but

384
00:13:29,880 --> 00:13:31,800
above all they have to obey fewer rules

385
00:13:31,800 --> 00:13:34,260
they can break into other systems they

386
00:13:34,260 --> 00:13:36,000
can look at things that aren't in scope

387
00:13:36,000 --> 00:13:38,820
so we need to get a leg up so that we

388
00:13:38,820 --> 00:13:40,800
can do things that attackers can do but

389
00:13:40,800 --> 00:13:42,839
more quickly so I'll give you some hints

390
00:13:42,839 --> 00:13:44,760
to how we do this

391
00:13:44,760 --> 00:13:46,620
one of the really really useful things

392
00:13:46,620 --> 00:13:48,660
we found is whole vessel traffic

393
00:13:48,660 --> 00:13:50,820
interception you might have seen one of

394
00:13:50,820 --> 00:13:53,339
these little boxes before it is just a

395
00:13:53,339 --> 00:13:56,220
network tap you pass a network through

396
00:13:56,220 --> 00:13:57,899
it and all of them the traffic will come

397
00:13:57,899 --> 00:13:59,639
out of that monitor Port there's no

398
00:13:59,639 --> 00:14:01,440
chance of you injecting traffic it's

399
00:14:01,440 --> 00:14:03,300
safe in those respects that brief

400
00:14:03,300 --> 00:14:06,420
disconnection is fine so we're sat there

401
00:14:06,420 --> 00:14:08,579
uh on the satellite connection on an oil

402
00:14:08,579 --> 00:14:10,500
rig so we can see all of that traffic

403
00:14:10,500 --> 00:14:12,360
going in and out and for that whole week

404
00:14:12,360 --> 00:14:13,860
we were there we were just intercepting

405
00:14:13,860 --> 00:14:14,940
all the traffic

406
00:14:14,940 --> 00:14:16,740
a real attacker probably wouldn't end up

407
00:14:16,740 --> 00:14:17,880
in this position

408
00:14:17,880 --> 00:14:19,139
but we did

409
00:14:19,139 --> 00:14:21,600
and what we managed to do was we managed

410
00:14:21,600 --> 00:14:24,360
to get an FTP user account and an FTP

411
00:14:24,360 --> 00:14:26,579
password plain text going from the oil

412
00:14:26,579 --> 00:14:28,440
rig through to the corporate side of

413
00:14:28,440 --> 00:14:29,279
things

414
00:14:29,279 --> 00:14:31,920
it turned out that user was in fact a

415
00:14:31,920 --> 00:14:33,959
domain administrator it was

416
00:14:33,959 --> 00:14:35,820
synchronizing just some basic files

417
00:14:35,820 --> 00:14:37,860
between two systems but we had the

418
00:14:37,860 --> 00:14:39,720
password and it didn't really matter

419
00:14:39,720 --> 00:14:41,760
that that was what it was meant for we

420
00:14:41,760 --> 00:14:43,800
had domain admin that's a screenshot

421
00:14:43,800 --> 00:14:45,779
from Bloodhound it was actually a third

422
00:14:45,779 --> 00:14:49,860
party that um wasn't HP obviously by the

423
00:14:49,860 --> 00:14:52,680
beginning of the names there but

424
00:14:52,680 --> 00:14:55,320
we could access everything at that point

425
00:14:55,320 --> 00:14:58,079
and it wasn't just on that oil rig it

426
00:14:58,079 --> 00:15:00,180
was everything it was every single oil

427
00:15:00,180 --> 00:15:01,980
rig in the fleet it was the corporate

428
00:15:01,980 --> 00:15:04,079
offices the main admin across everything

429
00:15:04,079 --> 00:15:06,360
just because an FTP password is being

430
00:15:06,360 --> 00:15:09,139
sent in the plane

431
00:15:09,540 --> 00:15:11,820
another Advantage we have is first off

432
00:15:11,820 --> 00:15:13,500
we can speak to people

433
00:15:13,500 --> 00:15:15,360
we can say how does this work what

434
00:15:15,360 --> 00:15:16,980
vulnerabilities are in this

435
00:15:16,980 --> 00:15:19,199
most of the time someone in that company

436
00:15:19,199 --> 00:15:21,420
knows these vulnerabilities anyway they

437
00:15:21,420 --> 00:15:22,740
know something that happened in the past

438
00:15:22,740 --> 00:15:24,959
they know some password that everybody

439
00:15:24,959 --> 00:15:27,420
knows that's common across all systems

440
00:15:27,420 --> 00:15:29,220
but you often get things that happen the

441
00:15:29,220 --> 00:15:30,600
other way where they say things are

442
00:15:30,600 --> 00:15:31,920
secure

443
00:15:31,920 --> 00:15:33,660
and this was on one test where they said

444
00:15:33,660 --> 00:15:35,760
the drilling control network is entirely

445
00:15:35,760 --> 00:15:37,680
air gapped so the drilling control

446
00:15:37,680 --> 00:15:39,300
network is the bit on an oil rig that

447
00:15:39,300 --> 00:15:40,560
deals with the drilling not the

448
00:15:40,560 --> 00:15:42,959
propulsion the drilling bit

449
00:15:42,959 --> 00:15:44,579
and we thought well let's look at the

450
00:15:44,579 --> 00:15:46,500
documentation we're not an attacker

451
00:15:46,500 --> 00:15:48,300
we've got the advantage of having these

452
00:15:48,300 --> 00:15:50,220
documents in front of us

453
00:15:50,220 --> 00:15:52,740
so this is a diagram of the drilling

454
00:15:52,740 --> 00:15:55,019
control Network it's a large loop

455
00:15:55,019 --> 00:15:57,899
Network there amazingly those um those

456
00:15:57,899 --> 00:15:59,220
chairs the things where you actually

457
00:15:59,220 --> 00:16:00,600
control the drill at the top are called

458
00:16:00,600 --> 00:16:03,720
cyber chairs which I really really like

459
00:16:03,720 --> 00:16:05,459
but we looked at that and we said well

460
00:16:05,459 --> 00:16:07,800
they they said this network is

461
00:16:07,800 --> 00:16:09,360
air-gapped and I thought well that

462
00:16:09,360 --> 00:16:11,100
that's really strange though because I'm

463
00:16:11,100 --> 00:16:12,899
sorry it's a bit fuzzy here there's this

464
00:16:12,899 --> 00:16:15,000
kind of Cloudy things that links off to

465
00:16:15,000 --> 00:16:18,300
something called an FW a firewall it was

466
00:16:18,300 --> 00:16:20,459
an air gap it was connected via a

467
00:16:20,459 --> 00:16:22,380
firewall now in this instance that

468
00:16:22,380 --> 00:16:24,180
firewall was incredibly well configured

469
00:16:24,180 --> 00:16:25,740
but there's a very big difference

470
00:16:25,740 --> 00:16:28,320
between an air gapped and a firewall

471
00:16:28,320 --> 00:16:31,279
connecting to that system

472
00:16:31,620 --> 00:16:33,660
another thing we find is that every

473
00:16:33,660 --> 00:16:35,820
vessel will have had changes made to it

474
00:16:35,820 --> 00:16:38,100
people want to get their jobs done they

475
00:16:38,100 --> 00:16:40,019
want things to work when you're on a

476
00:16:40,019 --> 00:16:41,639
ship you don't have access to Google at

477
00:16:41,639 --> 00:16:44,339
high speeds you don't have the liberty

478
00:16:44,339 --> 00:16:45,480
of being able to order things from

479
00:16:45,480 --> 00:16:46,440
Amazon

480
00:16:46,440 --> 00:16:48,360
so quite often your goal is to make

481
00:16:48,360 --> 00:16:50,639
things work that's your primary goal

482
00:16:50,639 --> 00:16:52,500
so if you have to run a patch cable

483
00:16:52,500 --> 00:16:54,480
between two switches that make things

484
00:16:54,480 --> 00:16:58,019
work go for it it works my job's done

485
00:16:58,019 --> 00:17:00,240
but the problem there is things end up

486
00:17:00,240 --> 00:17:02,399
deviating from documentation

487
00:17:02,399 --> 00:17:04,619
now that thing there that yellow box is

488
00:17:04,619 --> 00:17:06,900
a fluke Network Tracer you plug it into

489
00:17:06,900 --> 00:17:08,400
a network cable at one end and you wave

490
00:17:08,400 --> 00:17:09,900
that about in cabinets at the other end

491
00:17:09,900 --> 00:17:11,819
and you can find where those cables go

492
00:17:11,819 --> 00:17:14,400
it's been absolutely invaluable working

493
00:17:14,400 --> 00:17:16,500
on ships we have this connection here

494
00:17:16,500 --> 00:17:19,859
this service PC there was a PC somewhere

495
00:17:19,859 --> 00:17:21,720
in the accommodation on this oil rig

496
00:17:21,720 --> 00:17:23,280
that connected through to the vsat

497
00:17:23,280 --> 00:17:25,380
systems it took me about three hours to

498
00:17:25,380 --> 00:17:29,120
find it using a cable tracer

499
00:17:29,640 --> 00:17:31,620
another Advantage we've got is physical

500
00:17:31,620 --> 00:17:34,440
access to the devices now if any of you

501
00:17:34,440 --> 00:17:36,179
have ever worked with network switches

502
00:17:36,179 --> 00:17:37,919
and firewalls it's particularly Cisco

503
00:17:37,919 --> 00:17:40,620
you'll recognize the console port

504
00:17:40,620 --> 00:17:44,160
it's either USB RJ45 DB9 but it's a

505
00:17:44,160 --> 00:17:46,200
serial connection into that device that

506
00:17:46,200 --> 00:17:48,299
allows me to interact with it

507
00:17:48,299 --> 00:17:50,640
now quite often people put a password on

508
00:17:50,640 --> 00:17:52,200
that serial connection so you can't just

509
00:17:52,200 --> 00:17:54,000
log into the device and do what you want

510
00:17:54,000 --> 00:17:56,100
but Cisco really helpfully added this

511
00:17:56,100 --> 00:17:58,380
thing called password recovery mode

512
00:17:58,380 --> 00:18:00,120
what it means with physical access you

513
00:18:00,120 --> 00:18:02,280
can reboot the switch you reboot the

514
00:18:02,280 --> 00:18:04,020
switch holding down the power button

515
00:18:04,020 --> 00:18:05,760
doing something strange with removing a

516
00:18:05,760 --> 00:18:08,280
CF card or whatever and it will let you

517
00:18:08,280 --> 00:18:10,080
read the configuration of that switch

518
00:18:10,080 --> 00:18:12,299
the idea is that you could then reset

519
00:18:12,299 --> 00:18:13,860
the password and gain access again

520
00:18:13,860 --> 00:18:15,720
you've got physical access so resetting

521
00:18:15,720 --> 00:18:17,520
a password makes sense

522
00:18:17,520 --> 00:18:19,559
it's really easy to do

523
00:18:19,559 --> 00:18:21,720
reboot it the only thing with Cisco

524
00:18:21,720 --> 00:18:23,460
devices sometimes they take six seven

525
00:18:23,460 --> 00:18:25,500
eight minutes to reboot which is a crazy

526
00:18:25,500 --> 00:18:27,720
amount of time in an operating uh

527
00:18:27,720 --> 00:18:30,380
environment

528
00:18:30,419 --> 00:18:32,160
but one of the big things with Cisco

529
00:18:32,160 --> 00:18:34,080
devices is you can hash your password

530
00:18:34,080 --> 00:18:36,299
sometimes but there's a different type

531
00:18:36,299 --> 00:18:38,220
of password called type 7 in Cisco

532
00:18:38,220 --> 00:18:40,080
configs where they're encrypted it's a

533
00:18:40,080 --> 00:18:42,179
hard-coded key you can turn those

534
00:18:42,179 --> 00:18:44,100
passwords back from those encrypted

535
00:18:44,100 --> 00:18:46,559
values into the raw password

536
00:18:46,559 --> 00:18:48,360
now if that password works on this

537
00:18:48,360 --> 00:18:50,640
device and every other Cisco switch on

538
00:18:50,640 --> 00:18:52,980
that oil rig or every other Cisco switch

539
00:18:52,980 --> 00:18:55,200
across the entire fleet we've now got a

540
00:18:55,200 --> 00:18:57,559
big problem

541
00:18:58,260 --> 00:19:00,600
another thing we found was the use of

542
00:19:00,600 --> 00:19:02,640
what's called out of bound out-of-band

543
00:19:02,640 --> 00:19:03,720
management

544
00:19:03,720 --> 00:19:06,299
now if you lose your main connection SSH

545
00:19:06,299 --> 00:19:08,520
into your switches or so on you want a

546
00:19:08,520 --> 00:19:10,620
way to dial back into that vessel so you

547
00:19:10,620 --> 00:19:12,240
can remotely access the switches in the

548
00:19:12,240 --> 00:19:13,740
firewall and reconfigure them to get

549
00:19:13,740 --> 00:19:15,480
that access back

550
00:19:15,480 --> 00:19:17,160
so there's a common device we find

551
00:19:17,160 --> 00:19:19,980
called an uplogix it's a generally

552
00:19:19,980 --> 00:19:21,660
connects using slow speed satellite

553
00:19:21,660 --> 00:19:24,179
something like iridium or we're talking

554
00:19:24,179 --> 00:19:26,280
properly slow speed like mode M speeds

555
00:19:26,280 --> 00:19:28,620
from the mid 90s and it allows you to

556
00:19:28,620 --> 00:19:31,320
connect via serial console into lots of

557
00:19:31,320 --> 00:19:33,000
different devices it'll generally be the

558
00:19:33,000 --> 00:19:35,940
vsat mode and router firewall and so on

559
00:19:35,940 --> 00:19:38,280
now really strangely rather than you

560
00:19:38,280 --> 00:19:39,900
type the password in for all of those

561
00:19:39,900 --> 00:19:43,020
devices you want to access it stores the

562
00:19:43,020 --> 00:19:44,460
passwords for the router and the switch

563
00:19:44,460 --> 00:19:47,220
and so on locally on the device

564
00:19:47,220 --> 00:19:49,679
cannot quite work out why

565
00:19:49,679 --> 00:19:52,140
it has a fips compliant mode you can

566
00:19:52,140 --> 00:19:53,820
properly put this thing into a hardcore

567
00:19:53,820 --> 00:19:55,740
security mode so that recovering those

568
00:19:55,740 --> 00:19:57,539
passwords is difficult

569
00:19:57,539 --> 00:20:00,059
but we add physical access

570
00:20:00,059 --> 00:20:02,640
so I took it apart as you do it was

571
00:20:02,640 --> 00:20:04,740
broken actually the fan in it failed and

572
00:20:04,740 --> 00:20:06,179
it wasn't working I fixed it and put it

573
00:20:06,179 --> 00:20:08,880
back so you know I was being useful

574
00:20:08,880 --> 00:20:10,919
um and we pulled the hard drive out read

575
00:20:10,919 --> 00:20:13,440
the encrypted password and worked out

576
00:20:13,440 --> 00:20:15,900
how they encrypted the passwords

577
00:20:15,900 --> 00:20:17,520
well yeah they encrypted them with a

578
00:20:17,520 --> 00:20:20,400
hard-coded key build a mock dizzy

579
00:20:20,400 --> 00:20:22,500
password now are any of you fans of Bob

580
00:20:22,500 --> 00:20:23,700
the Builder

581
00:20:23,700 --> 00:20:27,120
probably not but anyway build a mock and

582
00:20:27,120 --> 00:20:28,559
dizzy are characters from Bob the

583
00:20:28,559 --> 00:20:29,700
Builder

584
00:20:29,700 --> 00:20:31,679
um so yeah we had the password for all

585
00:20:31,679 --> 00:20:33,660
of the devices the router the switch and

586
00:20:33,660 --> 00:20:35,580
everything now I'm not going to say they

587
00:20:35,580 --> 00:20:37,320
were based on the name of the vessel but

588
00:20:37,320 --> 00:20:38,640
they were based on the name of the

589
00:20:38,640 --> 00:20:39,960
vessel

590
00:20:39,960 --> 00:20:42,120
this is a key principle the compromise

591
00:20:42,120 --> 00:20:43,740
of one device should not lead to the

592
00:20:43,740 --> 00:20:45,480
compromise of many if I've got one

593
00:20:45,480 --> 00:20:46,919
switch in front of me if I can get a

594
00:20:46,919 --> 00:20:48,539
password hash or a password off it I

595
00:20:48,539 --> 00:20:50,039
should not be able to use it on other

596
00:20:50,039 --> 00:20:52,740
devices unfortunately it rarely turns

597
00:20:52,740 --> 00:20:54,960
out like that on ships

598
00:20:54,960 --> 00:20:58,200
hidden stuff everywhere now Ryan he's

599
00:20:58,200 --> 00:21:00,539
sat here in the front row a few years

600
00:21:00,539 --> 00:21:02,880
ago with a completely different project

601
00:21:02,880 --> 00:21:06,120
a a crypto wallet said much of hacking's

602
00:21:06,120 --> 00:21:07,980
about understanding systems better than

603
00:21:07,980 --> 00:21:09,539
those who built them and using that

604
00:21:09,539 --> 00:21:10,860
knowledge to do what is supposed to be

605
00:21:10,860 --> 00:21:12,059
impossible

606
00:21:12,059 --> 00:21:14,039
now there's got to be Nuance around us

607
00:21:14,039 --> 00:21:15,240
there was a big discussion earlier this

608
00:21:15,240 --> 00:21:16,500
week on Twitter

609
00:21:16,500 --> 00:21:20,100
but we quite often get on ships and

610
00:21:20,100 --> 00:21:22,500
our goal is to understand those systems

611
00:21:22,500 --> 00:21:24,000
our goal isn't to just make them work

612
00:21:24,000 --> 00:21:25,620
our goal is to find all of those weird

613
00:21:25,620 --> 00:21:27,720
connections understand those strange

614
00:21:27,720 --> 00:21:30,419
protocols exactly what's going on and

615
00:21:30,419 --> 00:21:32,400
and that's what we do we quite often get

616
00:21:32,400 --> 00:21:34,200
on a ship and we find things out that no

617
00:21:34,200 --> 00:21:36,179
one who works for that company knew

618
00:21:36,179 --> 00:21:38,220
about and take you through a few of

619
00:21:38,220 --> 00:21:40,080
these

620
00:21:40,080 --> 00:21:42,360
now the way that systems used to work

621
00:21:42,360 --> 00:21:44,159
when I worked on ships was you'd have

622
00:21:44,159 --> 00:21:45,960
your engine room systems your Bridge

623
00:21:45,960 --> 00:21:47,700
systems navigation systems they'd be

624
00:21:47,700 --> 00:21:49,799
completely air gapped from the corporate

625
00:21:49,799 --> 00:21:51,659
side of things there would be no

626
00:21:51,659 --> 00:21:53,760
connection between them whatsoever so

627
00:21:53,760 --> 00:21:55,380
the only way you could impact navigation

628
00:21:55,380 --> 00:21:57,120
propulsion would be if you physically

629
00:21:57,120 --> 00:22:00,299
connected to them but that's been eroded

630
00:22:00,299 --> 00:22:02,220
people want to remotely monitor what

631
00:22:02,220 --> 00:22:04,620
ships are doing the largest cost by far

632
00:22:04,620 --> 00:22:06,419
for big container ships is fuel

633
00:22:06,419 --> 00:22:08,700
consumption the fuel costs a huge amount

634
00:22:08,700 --> 00:22:10,200
of money so they want to see how

635
00:22:10,200 --> 00:22:12,659
efficient they are in using fuel

636
00:22:12,659 --> 00:22:15,240
now the captain the chief engineer on

637
00:22:15,240 --> 00:22:16,559
this vessel they both knew there was

638
00:22:16,559 --> 00:22:17,760
some kind of remote monitoring that

639
00:22:17,760 --> 00:22:19,140
meant they could work out how efficient

640
00:22:19,140 --> 00:22:21,539
they were being with fuel shoreside knew

641
00:22:21,539 --> 00:22:23,400
that system existed they were paying for

642
00:22:23,400 --> 00:22:25,380
it but no one actually knew where the

643
00:22:25,380 --> 00:22:27,659
system was on the vessel they literally

644
00:22:27,659 --> 00:22:29,159
didn't know

645
00:22:29,159 --> 00:22:31,320
so we spent a rather hungover morning

646
00:22:31,320 --> 00:22:33,539
routing around on this ship trying to

647
00:22:33,539 --> 00:22:35,340
find this thing

648
00:22:35,340 --> 00:22:36,840
and at the top there you've got the

649
00:22:36,840 --> 00:22:38,820
voyage data recorder the vdr the black

650
00:22:38,820 --> 00:22:41,340
box now that brings together lots of

651
00:22:41,340 --> 00:22:43,200
systems it monitors all of these

652
00:22:43,200 --> 00:22:44,640
connections where you are how fast

653
00:22:44,640 --> 00:22:46,260
you're going what you're saying and we

654
00:22:46,260 --> 00:22:47,880
thought well a remote monitoring system

655
00:22:47,880 --> 00:22:49,799
is probably going to be close to the vdr

656
00:22:49,799 --> 00:22:51,480
and you see that little panel in the

657
00:22:51,480 --> 00:22:53,460
middle there it does have a label on it

658
00:22:53,460 --> 00:22:55,740
but that label wasn't meaningful it was

659
00:22:55,740 --> 00:22:57,900
screwed into the wall

660
00:22:57,900 --> 00:23:00,059
we unscrewed it and there's our remote

661
00:23:00,059 --> 00:23:02,520
monitoring system screwed into the wall

662
00:23:02,520 --> 00:23:04,919
it was really quite hard to find

663
00:23:04,919 --> 00:23:07,140
um amazingly my colleague unplugged one

664
00:23:07,140 --> 00:23:08,820
of the network cables and it dropped

665
00:23:08,820 --> 00:23:12,960
down into the cavity uh yes

666
00:23:12,960 --> 00:23:15,299
anyway

667
00:23:15,299 --> 00:23:17,700
we had a look at this thing and it had

668
00:23:17,700 --> 00:23:19,799
loads of Serial connections coming in

669
00:23:19,799 --> 00:23:21,780
industrial Control Systems love cereal

670
00:23:21,780 --> 00:23:24,000
it's a great way of transferring data at

671
00:23:24,000 --> 00:23:25,860
low speed and entirely reliably or

672
00:23:25,860 --> 00:23:27,720
entirely reliably within the defined

673
00:23:27,720 --> 00:23:29,640
time frame but you'll notice something

674
00:23:29,640 --> 00:23:32,280
there there's only two wires for each

675
00:23:32,280 --> 00:23:34,200
one of those pairs you've got white and

676
00:23:34,200 --> 00:23:35,820
orange you've got white and green white

677
00:23:35,820 --> 00:23:38,220
and blue and every third one's missing

678
00:23:38,220 --> 00:23:40,020
it's really really important in terms of

679
00:23:40,020 --> 00:23:42,240
security this

680
00:23:42,240 --> 00:23:44,220
so we don't understand that connection

681
00:23:44,220 --> 00:23:46,320
until we found the device the Blue Line

682
00:23:46,320 --> 00:23:48,539
represents something I don't understand

683
00:23:48,539 --> 00:23:50,700
now if I want to communicate over serial

684
00:23:50,700 --> 00:23:52,860
we've got a receive and a transmit it's

685
00:23:52,860 --> 00:23:54,840
two different sides so we can transmit

686
00:23:54,840 --> 00:23:56,039
data through to the other end and then

687
00:23:56,039 --> 00:23:57,299
we receive it

688
00:23:57,299 --> 00:23:58,860
now the way that lots of systems on

689
00:23:58,860 --> 00:24:00,659
ships work is they just broadcast that

690
00:24:00,659 --> 00:24:02,940
data they just keep on sending out the

691
00:24:02,940 --> 00:24:04,980
data again and again and again there is

692
00:24:04,980 --> 00:24:06,780
no concept of me asking for the data

693
00:24:06,780 --> 00:24:08,880
they'll just shout it out so that Red

694
00:24:08,880 --> 00:24:10,919
Connection the transmission through to

695
00:24:10,919 --> 00:24:12,780
the control systems doesn't actually

696
00:24:12,780 --> 00:24:14,820
have to be there and this is what

697
00:24:14,820 --> 00:24:16,440
they've done in this case they only put

698
00:24:16,440 --> 00:24:18,120
one of the wires there this is

699
00:24:18,120 --> 00:24:20,340
essentially a data diode you cannot get

700
00:24:20,340 --> 00:24:23,100
data from the monitoring system through

701
00:24:23,100 --> 00:24:24,960
to the control systems

702
00:24:24,960 --> 00:24:27,840
so we'd proven that that system was safe

703
00:24:27,840 --> 00:24:29,700
from controlling the vessel it's really

704
00:24:29,700 --> 00:24:30,780
important this

705
00:24:30,780 --> 00:24:32,580
when you're testing a ship it's not

706
00:24:32,580 --> 00:24:35,220
always about showboating that was not

707
00:24:35,220 --> 00:24:36,600
meant to be a pun it's not always about

708
00:24:36,600 --> 00:24:38,039
showing that you can hack it remotely

709
00:24:38,039 --> 00:24:39,840
sometimes it's about proving things as

710
00:24:39,840 --> 00:24:42,600
safe making the client feel happy

711
00:24:42,600 --> 00:24:44,520
but it's not always like this

712
00:24:44,520 --> 00:24:46,140
this was on a container ship we found

713
00:24:46,140 --> 00:24:48,960
this little box a little rugged PC that

714
00:24:48,960 --> 00:24:50,880
was just kind of Hidden Away in a server

715
00:24:50,880 --> 00:24:53,039
rack we thought well what's that let's

716
00:24:53,039 --> 00:24:54,780
look into it

717
00:24:54,780 --> 00:24:56,280
if you've worked in any industrial

718
00:24:56,280 --> 00:24:57,960
Control Systems you recognize these it's

719
00:24:57,960 --> 00:25:00,900
an IP to serial converter it takes

720
00:25:00,900 --> 00:25:02,700
cereal in one side that receive and

721
00:25:02,700 --> 00:25:04,799
transmit possibly rs-485 a slightly

722
00:25:04,799 --> 00:25:06,539
different protocol and it converts it

723
00:25:06,539 --> 00:25:08,400
into IP that you can feed into a

724
00:25:08,400 --> 00:25:10,980
computer just a protocol converter

725
00:25:10,980 --> 00:25:13,020
they're everywhere now these were

726
00:25:13,020 --> 00:25:14,760
involved with this little box called

727
00:25:14,760 --> 00:25:16,980
Blue Tracker and we kind of traced it

728
00:25:16,980 --> 00:25:18,720
out and we worked out what was going on

729
00:25:18,720 --> 00:25:21,000
it was taking one feed from bridge

730
00:25:21,000 --> 00:25:23,880
systems the ectus which is the charting

731
00:25:23,880 --> 00:25:26,460
system position speed and so on and it

732
00:25:26,460 --> 00:25:28,440
was going also to the main engines to

733
00:25:28,440 --> 00:25:30,000
find out how fast the engine was going

734
00:25:30,000 --> 00:25:32,820
how much fuel it was using and so on and

735
00:25:32,820 --> 00:25:36,120
again we wanted to understand that

736
00:25:36,120 --> 00:25:37,919
now again after a lot of digging about

737
00:25:37,919 --> 00:25:40,200
what we found was this is the Actis the

738
00:25:40,200 --> 00:25:41,640
the ship's electrician has taken the

739
00:25:41,640 --> 00:25:43,620
panel off of it and we found that that

740
00:25:43,620 --> 00:25:45,840
serial connection was broadcast only the

741
00:25:45,840 --> 00:25:47,400
speed position and everything from the

742
00:25:47,400 --> 00:25:49,320
bridge systems being sent from them to

743
00:25:49,320 --> 00:25:51,360
Blue Tracker there was no way for me to

744
00:25:51,360 --> 00:25:53,520
go back in the other direction so we've

745
00:25:53,520 --> 00:25:55,620
said that one safe there's not much you

746
00:25:55,620 --> 00:25:56,880
can do with that

747
00:25:56,880 --> 00:25:58,320
so then we thought we'd look at the

748
00:25:58,320 --> 00:26:00,299
engine room side of things

749
00:26:00,299 --> 00:26:02,580
it was using modbus

750
00:26:02,580 --> 00:26:05,520
now modbus is different to normal serial

751
00:26:05,520 --> 00:26:08,220
you've got to Poll for values it doesn't

752
00:26:08,220 --> 00:26:10,440
just broadcast What It Wants you've got

753
00:26:10,440 --> 00:26:12,120
to say I want to know how fast the

754
00:26:12,120 --> 00:26:13,679
engine's going I want to know what the

755
00:26:13,679 --> 00:26:16,500
cylinder pressures are and so on

756
00:26:16,500 --> 00:26:19,200
so it's a request response you need that

757
00:26:19,200 --> 00:26:21,059
transmit and that receive side of things

758
00:26:21,059 --> 00:26:24,059
you cannot cut one of those pairs

759
00:26:24,059 --> 00:26:26,039
now it might be the case that all those

760
00:26:26,039 --> 00:26:28,380
requests that have been made is doing is

761
00:26:28,380 --> 00:26:30,360
just requesting values not carrying out

762
00:26:30,360 --> 00:26:32,700
any actions but we've got no way of

763
00:26:32,700 --> 00:26:34,440
confirming that there was no

764
00:26:34,440 --> 00:26:36,179
documentation no one understood that

765
00:26:36,179 --> 00:26:38,460
system there's a PLC sat on the side of

766
00:26:38,460 --> 00:26:39,419
the main engine that we can make

767
00:26:39,419 --> 00:26:43,200
requests to not a good position to be in

768
00:26:43,200 --> 00:26:45,539
so at the moment in time we've got

769
00:26:45,539 --> 00:26:47,279
control possibly of injecting things

770
00:26:47,279 --> 00:26:49,260
onto the main engine but you say well no

771
00:26:49,260 --> 00:26:51,299
one can do that remotely well the thing

772
00:26:51,299 --> 00:26:53,220
was of course we had TeamViewer on that

773
00:26:53,220 --> 00:26:54,299
box

774
00:26:54,299 --> 00:26:55,320
um

775
00:26:55,320 --> 00:26:57,120
the best thing here was that for blue

776
00:26:57,120 --> 00:26:59,159
track of this system our client who

777
00:26:59,159 --> 00:27:01,260
operated that vessel had not been paying

778
00:27:01,260 --> 00:27:04,200
for this system for four years

779
00:27:04,200 --> 00:27:06,480
TeamViewer was still completely active

780
00:27:06,480 --> 00:27:08,760
on this so someone could have connected

781
00:27:08,760 --> 00:27:11,580
in VIA that via the third party via

782
00:27:11,580 --> 00:27:13,440
compromising the third party and

783
00:27:13,440 --> 00:27:14,880
injected traffic

784
00:27:14,880 --> 00:27:17,220
not a great situation so this was about

785
00:27:17,220 --> 00:27:18,960
risk awareness disconnect the system

786
00:27:18,960 --> 00:27:22,260
decommission it just get rid of it

787
00:27:22,260 --> 00:27:25,080
another one we found this is one of the

788
00:27:25,080 --> 00:27:27,600
generators on an offshore tug

789
00:27:27,600 --> 00:27:30,600
um and I'm looking in the little box on

790
00:27:30,600 --> 00:27:31,860
the top of it to understand what's going

791
00:27:31,860 --> 00:27:33,539
on

792
00:27:33,539 --> 00:27:35,700
and Visually inspecting it something

793
00:27:35,700 --> 00:27:37,260
kind of stood out as interesting that

794
00:27:37,260 --> 00:27:39,419
little yellow box on the top right hand

795
00:27:39,419 --> 00:27:42,059
side so we look at that and it's a

796
00:27:42,059 --> 00:27:45,720
little router an industrial router

797
00:27:45,720 --> 00:27:47,220
now the first thing that peeped my

798
00:27:47,220 --> 00:27:48,960
interest was the fact it had an antenna

799
00:27:48,960 --> 00:27:50,460
connection on the front of it and it can

800
00:27:50,460 --> 00:27:52,559
be a cellular modem it can have a

801
00:27:52,559 --> 00:27:54,360
completely remote connection but we're

802
00:27:54,360 --> 00:27:56,400
on the bottom plates of a ship there's

803
00:27:56,400 --> 00:27:57,779
no way it's going to get a signal there

804
00:27:57,779 --> 00:27:59,400
was no antenna connected

805
00:27:59,400 --> 00:28:00,360
but there was something else that

806
00:28:00,360 --> 00:28:02,520
interested me on this there was a label

807
00:28:02,520 --> 00:28:05,340
saying Lan slash one now if you look at

808
00:28:05,340 --> 00:28:07,020
your router at home it will probably

809
00:28:07,020 --> 00:28:09,600
have a Wan port for the internet the

810
00:28:09,600 --> 00:28:11,159
wide area network and a lamp Port

811
00:28:11,159 --> 00:28:13,020
they're probably going to be physically

812
00:28:13,020 --> 00:28:14,100
separate

813
00:28:14,100 --> 00:28:15,419
not here

814
00:28:15,419 --> 00:28:16,860
the same port

815
00:28:16,860 --> 00:28:18,720
now how are you going to provide strong

816
00:28:18,720 --> 00:28:20,520
separation

817
00:28:20,520 --> 00:28:22,620
the traffic on a router when you're

818
00:28:22,620 --> 00:28:24,600
using the same pool

819
00:28:24,600 --> 00:28:26,220
especially when someone's got local

820
00:28:26,220 --> 00:28:29,520
access to one of those Networks

821
00:28:29,520 --> 00:28:31,200
so a bit more tracing those networks out

822
00:28:31,200 --> 00:28:33,480
and we found it looked a bit like this

823
00:28:33,480 --> 00:28:35,279
we've got our ship plan at the top there

824
00:28:35,279 --> 00:28:37,500
running on a 192 Network we've got a

825
00:28:37,500 --> 00:28:39,299
little router sat to the side in yellow

826
00:28:39,299 --> 00:28:41,940
and then that route over to the

827
00:28:41,940 --> 00:28:44,460
generator Network on a 172 Network so

828
00:28:44,460 --> 00:28:46,080
two different IP domains two different

829
00:28:46,080 --> 00:28:48,360
subnets and the idea is that little

830
00:28:48,360 --> 00:28:51,419
router routes between the two Networks

831
00:28:51,419 --> 00:28:53,520
but the thing is I don't have to obey

832
00:28:53,520 --> 00:28:55,500
any rules when I'm on the ship's Network

833
00:28:55,500 --> 00:28:58,380
I don't have to be a 192 address anymore

834
00:28:58,380 --> 00:29:01,020
I can become a 170.

835
00:29:01,020 --> 00:29:03,419
so to bypass this security control to

836
00:29:03,419 --> 00:29:05,220
bypass that router all I had to do is

837
00:29:05,220 --> 00:29:08,279
set my IP address to a 172 range I was

838
00:29:08,279 --> 00:29:10,200
true to the generator controllers and I

839
00:29:10,200 --> 00:29:12,299
had control of the generators from one

840
00:29:12,299 --> 00:29:13,980
of the cabins on the ship

841
00:29:13,980 --> 00:29:15,900
how did I do that well they'd given us

842
00:29:15,900 --> 00:29:17,880
little boxes in the cabins that let us

843
00:29:17,880 --> 00:29:20,580
watch IPTV

844
00:29:20,580 --> 00:29:22,399
that was on that same network that

845
00:29:22,399 --> 00:29:25,440
192.168 I changed my address to 172 and

846
00:29:25,440 --> 00:29:26,940
we were through

847
00:29:26,940 --> 00:29:29,039
it did take a bit of knowledge again

848
00:29:29,039 --> 00:29:31,200
we're we're you know we're pen testers

849
00:29:31,200 --> 00:29:33,179
we're not hackers we want to well we've

850
00:29:33,179 --> 00:29:34,620
kind of both but we're not a malicious

851
00:29:34,620 --> 00:29:36,240
attacker I could go down to the engine

852
00:29:36,240 --> 00:29:37,740
room and see that the diesel generator

853
00:29:37,740 --> 00:29:39,360
controller is made by Death

854
00:29:39,360 --> 00:29:41,340
I can see how it's working I registered

855
00:29:41,340 --> 00:29:43,620
on the Deep website downloaded a nice

856
00:29:43,620 --> 00:29:45,059
little tool that allowed me to

857
00:29:45,059 --> 00:29:46,860
communicate with the generator

858
00:29:46,860 --> 00:29:48,779
that kind of black line that says GB

859
00:29:48,779 --> 00:29:50,580
there is the breaker for that generator

860
00:29:50,580 --> 00:29:52,620
I could click on that and it would

861
00:29:52,620 --> 00:29:54,360
disconnect the generator you could black

862
00:29:54,360 --> 00:29:56,279
the ship out

863
00:29:56,279 --> 00:29:57,960
so not great in the general scheme of

864
00:29:57,960 --> 00:30:00,059
things

865
00:30:00,059 --> 00:30:02,820
same different

866
00:30:02,820 --> 00:30:04,620
no they I don't know if we're going to

867
00:30:04,620 --> 00:30:06,120
call this a zero day but I've never

868
00:30:06,120 --> 00:30:07,740
mentioned this password before but I'm

869
00:30:07,740 --> 00:30:10,380
fed up with this company

870
00:30:10,380 --> 00:30:13,220
Marine Exchange mxp

871
00:30:13,220 --> 00:30:16,140
every single cruise ship we have ever

872
00:30:16,140 --> 00:30:17,399
been on

873
00:30:17,399 --> 00:30:19,140
and we've got the main admin on every

874
00:30:19,140 --> 00:30:20,760
single cruise ship we have been on we

875
00:30:20,760 --> 00:30:23,220
have done it via mxp

876
00:30:23,220 --> 00:30:25,860
I'm not joking here it is everywhere

877
00:30:25,860 --> 00:30:27,419
look at the names on the bottom there

878
00:30:27,419 --> 00:30:30,720
it's every single crew line what is mxp

879
00:30:30,720 --> 00:30:33,659
well I'm not really sure to be honest

880
00:30:33,659 --> 00:30:35,700
it's a passenger management system it's

881
00:30:35,700 --> 00:30:37,320
a stores management system it does

882
00:30:37,320 --> 00:30:38,880
everything on a ship

883
00:30:38,880 --> 00:30:40,740
but the way it's architected and the way

884
00:30:40,740 --> 00:30:43,620
it's secured is just terrible

885
00:30:43,620 --> 00:30:46,740
it's a server thick client application a

886
00:30:46,740 --> 00:30:48,299
lot of things are thick clients on ships

887
00:30:48,299 --> 00:30:50,340
so we've got a service side and we've

888
00:30:50,340 --> 00:30:51,659
got a client side we want to understand

889
00:30:51,659 --> 00:30:54,360
how that works well interesting thing

890
00:30:54,360 --> 00:30:56,159
about the way it works is to get the

891
00:30:56,159 --> 00:30:57,899
settings for the client first off it

892
00:30:57,899 --> 00:31:00,419
goes over SMB to a file share and it

893
00:31:00,419 --> 00:31:02,159
will pull down the settings in an any

894
00:31:02,159 --> 00:31:03,960
file to the client so it knows which

895
00:31:03,960 --> 00:31:06,179
server to connect to what password to

896
00:31:06,179 --> 00:31:08,159
use and so on how to authenticate to it

897
00:31:08,159 --> 00:31:10,559
so it pulls down that file and it turns

898
00:31:10,559 --> 00:31:12,539
out that mxp server is actually a SQL

899
00:31:12,539 --> 00:31:15,360
Server so it's using SQL to communicate

900
00:31:15,360 --> 00:31:17,039
with the server

901
00:31:17,039 --> 00:31:19,919
let's look at that any file

902
00:31:19,919 --> 00:31:22,200
so the username there pause to mxp

903
00:31:22,200 --> 00:31:25,140
underneath it is an mxpdb password the

904
00:31:25,140 --> 00:31:26,820
database password

905
00:31:26,820 --> 00:31:30,480
it's encrypted using a hard-coded key

906
00:31:30,480 --> 00:31:32,279
I'm not going to say the username and

907
00:31:32,279 --> 00:31:33,720
password are the same but the username

908
00:31:33,720 --> 00:31:35,460
and password have some commonality

909
00:31:35,460 --> 00:31:36,840
between them

910
00:31:36,840 --> 00:31:39,059
of course someone who does this who

911
00:31:39,059 --> 00:31:41,880
leaves a SQL password in an any file

912
00:31:41,880 --> 00:31:43,740
poorly encrypted like this probably

913
00:31:43,740 --> 00:31:45,299
isn't going to understand how to harden

914
00:31:45,299 --> 00:31:48,000
SQL Server so of course we can log in

915
00:31:48,000 --> 00:31:50,220
we've got pretty much sa and we can use

916
00:31:50,220 --> 00:31:52,620
XP command shell to gain admin

917
00:31:52,620 --> 00:31:55,260
credentials on the underlying box

918
00:31:55,260 --> 00:31:57,120
we've done this on so many cruise ships

919
00:31:57,120 --> 00:31:59,460
it's not even funny the companies have

920
00:31:59,460 --> 00:32:01,919
stopped reporting it to mxp because it's

921
00:32:01,919 --> 00:32:04,380
just not getting fixed

922
00:32:04,380 --> 00:32:06,059
another thing we often find on ships is

923
00:32:06,059 --> 00:32:08,340
that they use something like veeam to

924
00:32:08,340 --> 00:32:10,919
perform backups of VMS on a cruise ship

925
00:32:10,919 --> 00:32:14,220
that can be 80 to 150 virtual machines

926
00:32:14,220 --> 00:32:16,980
running everything massively complex you

927
00:32:16,980 --> 00:32:18,659
want them backed up to a central store

928
00:32:18,659 --> 00:32:21,179
now the thing is is to backup a virtual

929
00:32:21,179 --> 00:32:23,279
machine you need to have some form of

930
00:32:23,279 --> 00:32:24,720
high privilege it's some way of

931
00:32:24,720 --> 00:32:26,279
accessing

932
00:32:26,279 --> 00:32:29,220
the data storage that underlies it so

933
00:32:29,220 --> 00:32:31,679
veeam stores credentials generally for

934
00:32:31,679 --> 00:32:33,659
Windows for Linux and so on so it can

935
00:32:33,659 --> 00:32:35,760
log into these esxi boxes and so on and

936
00:32:35,760 --> 00:32:37,860
pull those backups back and it can't

937
00:32:37,860 --> 00:32:39,360
store them hashed they've got to be

938
00:32:39,360 --> 00:32:41,700
encrypted because it uses them the thing

939
00:32:41,700 --> 00:32:44,940
is again it uses a hard-coded key so

940
00:32:44,940 --> 00:32:46,500
there's a little script you can find on

941
00:32:46,500 --> 00:32:48,179
the veeam forums

942
00:32:48,179 --> 00:32:49,919
um that if you're logged in as a user

943
00:32:49,919 --> 00:32:51,120
can use those credentials you can

944
00:32:51,120 --> 00:32:52,919
recover the credentials from veeam and

945
00:32:52,919 --> 00:32:55,320
they will work across so much on a ship

946
00:32:55,320 --> 00:32:57,600
you can log into things that that aren't

947
00:32:57,600 --> 00:32:59,159
things you get access to a domain

948
00:32:59,159 --> 00:33:00,960
administrator it's absolutely crucial

949
00:33:00,960 --> 00:33:03,000
people see domain admin as being like

950
00:33:03,000 --> 00:33:05,460
the end goal that's not our end goal we

951
00:33:05,460 --> 00:33:08,940
want to compromise and ruin everything

952
00:33:08,940 --> 00:33:11,580
the the Gins are turning up

953
00:33:11,580 --> 00:33:13,559
adverse impact

954
00:33:13,559 --> 00:33:14,820
another thing on a ship that's

955
00:33:14,820 --> 00:33:16,380
absolutely crucial to operations called

956
00:33:16,380 --> 00:33:19,320
the load computer it takes the levels in

957
00:33:19,320 --> 00:33:21,720
the tanks how much cargo how much cargo

958
00:33:21,720 --> 00:33:23,100
you've got how many passengers you've

959
00:33:23,100 --> 00:33:24,539
got on board how many bananas you've got

960
00:33:24,539 --> 00:33:26,700
on board literally you have to tell it

961
00:33:26,700 --> 00:33:28,559
how many bananas you've got on board I'd

962
00:33:28,559 --> 00:33:30,059
really like bananas

963
00:33:30,059 --> 00:33:32,279
um this isn't this is just a screenshot

964
00:33:32,279 --> 00:33:33,840
to show you what it looks like it's

965
00:33:33,840 --> 00:33:36,059
vital for safety you can put it into

966
00:33:36,059 --> 00:33:37,980
another mode if you if you hold the

967
00:33:37,980 --> 00:33:39,659
vessel if you're taking water on it this

968
00:33:39,659 --> 00:33:41,640
goes into an emergency situation that

969
00:33:41,640 --> 00:33:43,260
will tell you if really bad things are

970
00:33:43,260 --> 00:33:44,460
going to happen

971
00:33:44,460 --> 00:33:46,440
so it's crucial you'd hope it would be

972
00:33:46,440 --> 00:33:48,120
secure

973
00:33:48,120 --> 00:33:51,179
now the thing is is what we found was it

974
00:33:51,179 --> 00:33:53,340
needs to pull those values for tanks you

975
00:33:53,340 --> 00:33:54,779
need to know how much fuel how much

976
00:33:54,779 --> 00:33:56,940
ballast water if you've got whole stress

977
00:33:56,940 --> 00:33:58,260
monitors that measure how much the

978
00:33:58,260 --> 00:34:00,059
ship's bending then you need to pull

979
00:34:00,059 --> 00:34:01,580
these values into the load computer

980
00:34:01,580 --> 00:34:04,140
manually entering them is time consuming

981
00:34:04,140 --> 00:34:06,960
and error prone so what they do is they

982
00:34:06,960 --> 00:34:09,300
read them through serial so the bridge

983
00:34:09,300 --> 00:34:11,040
Control Systems will be reading high

984
00:34:11,040 --> 00:34:12,780
stress monitoring tank levels are all

985
00:34:12,780 --> 00:34:15,179
over serial Networks and we want to read

986
00:34:15,179 --> 00:34:17,219
them and our little friend the IP to

987
00:34:17,219 --> 00:34:19,139
serial converter comes in

988
00:34:19,139 --> 00:34:20,760
so we've got that

989
00:34:20,760 --> 00:34:23,520
and we have a load computer server it

990
00:34:23,520 --> 00:34:25,199
has an IP serial converter that connects

991
00:34:25,199 --> 00:34:26,760
into those buses and will pull those

992
00:34:26,760 --> 00:34:28,020
values back

993
00:34:28,020 --> 00:34:29,820
now that load computer server will be

994
00:34:29,820 --> 00:34:31,679
buried in a server room somewhere it

995
00:34:31,679 --> 00:34:33,239
might be behind the bridge below the

996
00:34:33,239 --> 00:34:34,918
bridge or somewhere else but to actually

997
00:34:34,918 --> 00:34:36,540
use the system you want to be on the

998
00:34:36,540 --> 00:34:38,820
bridge so they have a user interface

999
00:34:38,820 --> 00:34:41,159
computer a separate device

1000
00:34:41,159 --> 00:34:42,659
and somehow they need to communicate

1001
00:34:42,659 --> 00:34:45,119
with each other now the thing is is that

1002
00:34:45,119 --> 00:34:46,440
vendors

1003
00:34:46,440 --> 00:34:48,359
they get on board ships and they want to

1004
00:34:48,359 --> 00:34:49,859
install these systems they just want

1005
00:34:49,859 --> 00:34:51,060
them to work

1006
00:34:51,060 --> 00:34:52,980
the load computer company doesn't know

1007
00:34:52,980 --> 00:34:55,080
to go to it for a cruise company and say

1008
00:34:55,080 --> 00:34:56,820
we need to be able to patch on a private

1009
00:34:56,820 --> 00:34:58,020
Network between these two different

1010
00:34:58,020 --> 00:35:00,240
places what they do is they come along

1011
00:35:00,240 --> 00:35:01,980
they've got their load computer server

1012
00:35:01,980 --> 00:35:03,780
down to decks they've got their user

1013
00:35:03,780 --> 00:35:05,700
interface and there's two Network ports

1014
00:35:05,700 --> 00:35:07,260
next to them they're just going to plug

1015
00:35:07,260 --> 00:35:09,119
them into those Network ports and hope

1016
00:35:09,119 --> 00:35:10,680
for the best

1017
00:35:10,680 --> 00:35:12,540
so they need to talk to each other

1018
00:35:12,540 --> 00:35:13,920
but what they found was they could plug

1019
00:35:13,920 --> 00:35:16,380
into any ports in the walls and those

1020
00:35:16,380 --> 00:35:17,820
two devices would talk to each other

1021
00:35:17,820 --> 00:35:20,820
they get a DHCP address in the 192 range

1022
00:35:20,820 --> 00:35:23,280
you could just communicate it was all

1023
00:35:23,280 --> 00:35:24,900
fine it worked they might have only been

1024
00:35:24,900 --> 00:35:26,880
on board for eight hours job done let's

1025
00:35:26,880 --> 00:35:29,099
get off

1026
00:35:29,099 --> 00:35:31,680
the problem was was that mechanism of

1027
00:35:31,680 --> 00:35:32,940
plugging into a wall port and getting

1028
00:35:32,940 --> 00:35:34,619
that 192 address was what they called

1029
00:35:34,619 --> 00:35:37,440
tar pitting on this vessel if I was in

1030
00:35:37,440 --> 00:35:40,020
the bar if I was in the pool in the

1031
00:35:40,020 --> 00:35:41,700
cabin and I plugged into a network port

1032
00:35:41,700 --> 00:35:43,980
and I didn't have an 8021x certificate

1033
00:35:43,980 --> 00:35:46,079
or a valid Mac address

1034
00:35:46,079 --> 00:35:47,940
I would just get dumped into this tar

1035
00:35:47,940 --> 00:35:48,900
pit

1036
00:35:48,900 --> 00:35:50,820
you'd get a holding page saying you're

1037
00:35:50,820 --> 00:35:51,960
not supposed to be plugged in if you

1038
00:35:51,960 --> 00:35:53,820
tried accessing the internet you should

1039
00:35:53,820 --> 00:35:55,859
pay for internet but the idea was this

1040
00:35:55,859 --> 00:35:57,780
improved security it meant that people

1041
00:35:57,780 --> 00:35:59,640
couldn't arbitrarily access the

1042
00:35:59,640 --> 00:36:01,320
corporate Network

1043
00:36:01,320 --> 00:36:03,180
the problem was was that load computer

1044
00:36:03,180 --> 00:36:05,460
the UI and the server were in the tar

1045
00:36:05,460 --> 00:36:07,740
pit and I worked out one evening sat in

1046
00:36:07,740 --> 00:36:10,440
the bar you could also plug into a wall

1047
00:36:10,440 --> 00:36:12,119
socket there and end up in the same tar

1048
00:36:12,119 --> 00:36:14,099
pit there was no client isolation it's a

1049
00:36:14,099 --> 00:36:15,780
wired Network you're in the same subnet

1050
00:36:15,780 --> 00:36:18,060
so we've now got network access to the

1051
00:36:18,060 --> 00:36:20,220
load computer

1052
00:36:20,220 --> 00:36:22,320
the thing on ships is lots of systems

1053
00:36:22,320 --> 00:36:24,359
have to start automatically if you black

1054
00:36:24,359 --> 00:36:26,940
out lose power you don't want to have to

1055
00:36:26,940 --> 00:36:29,339
type in a 16 character password into

1056
00:36:29,339 --> 00:36:30,660
your load computer to get it working

1057
00:36:30,660 --> 00:36:33,000
again so Auto logging is incredibly

1058
00:36:33,000 --> 00:36:34,320
common

1059
00:36:34,320 --> 00:36:35,880
now this system is made by a company

1060
00:36:35,880 --> 00:36:37,920
called Napa

1061
00:36:37,920 --> 00:36:39,000
um and I'm not saying that the

1062
00:36:39,000 --> 00:36:40,980
username's OB Napa and the passwords

1063
00:36:40,980 --> 00:36:43,380
Napa oi and it's been the same on every

1064
00:36:43,380 --> 00:36:47,220
single ship we've ever been on but it is

1065
00:36:47,220 --> 00:36:49,619
we've now got admin access

1066
00:36:49,619 --> 00:36:52,980
that load computer server from the bar

1067
00:36:52,980 --> 00:36:54,480
the thing is it's connected to this IP

1068
00:36:54,480 --> 00:36:58,079
to serial converter now again I'm lazy I

1069
00:36:58,079 --> 00:36:59,760
could do some kind of advanced thing and

1070
00:36:59,760 --> 00:37:01,500
inject some genuine values and make

1071
00:37:01,500 --> 00:37:03,359
something crazy happen I could just Spam

1072
00:37:03,359 --> 00:37:06,060
noise into that serial cable I spam

1073
00:37:06,060 --> 00:37:08,640
noise into that all other consumers in

1074
00:37:08,640 --> 00:37:10,440
that cereal bus will see that noise and

1075
00:37:10,440 --> 00:37:13,140
you've now got unreliable data there is

1076
00:37:13,140 --> 00:37:15,060
no other easy way to get these these

1077
00:37:15,060 --> 00:37:16,560
bits of data if you want to find out how

1078
00:37:16,560 --> 00:37:18,060
much is in your tanks doing that

1079
00:37:18,060 --> 00:37:21,000
manually is a massive pain

1080
00:37:21,000 --> 00:37:22,380
so yeah that one's an interesting one

1081
00:37:22,380 --> 00:37:24,960
we've only seen that one today the the

1082
00:37:24,960 --> 00:37:27,060
top hitting thing

1083
00:37:27,060 --> 00:37:29,880
another job an oil rig

1084
00:37:29,880 --> 00:37:31,859
um so this was an exploratory drilling

1085
00:37:31,859 --> 00:37:33,359
platform

1086
00:37:33,359 --> 00:37:34,320
um

1087
00:37:34,320 --> 00:37:36,359
absolutely massive we had Free Run of it

1088
00:37:36,359 --> 00:37:37,920
it was brilliant I could just go and do

1089
00:37:37,920 --> 00:37:39,420
what I wanted it was in what's called

1090
00:37:39,420 --> 00:37:42,060
warm stack so it's running the

1091
00:37:42,060 --> 00:37:43,440
generators are running but it's not

1092
00:37:43,440 --> 00:37:45,540
drilling so there was a skeleton crew on

1093
00:37:45,540 --> 00:37:46,980
board and we were just told go and do

1094
00:37:46,980 --> 00:37:48,300
what you want

1095
00:37:48,300 --> 00:37:49,800
but an interesting thing on drilling

1096
00:37:49,800 --> 00:37:50,880
rigs is if you go out from the

1097
00:37:50,880 --> 00:37:52,920
accommodation where the offices and

1098
00:37:52,920 --> 00:37:54,900
cabins are and you go out onto the

1099
00:37:54,900 --> 00:37:56,220
drilling floor

1100
00:37:56,220 --> 00:37:57,660
there's could be the potential for

1101
00:37:57,660 --> 00:38:00,060
explosive gases lots of bad things to

1102
00:38:00,060 --> 00:38:01,619
happen so you need to put a boiler seat

1103
00:38:01,619 --> 00:38:03,180
on you need to put safety boots on

1104
00:38:03,180 --> 00:38:06,180
goggles hard hat check out a radio gas

1105
00:38:06,180 --> 00:38:08,099
detector all of these different things

1106
00:38:08,099 --> 00:38:11,040
that's a massive pain that's a barrier

1107
00:38:11,040 --> 00:38:12,300
to me going out onto the drilling

1108
00:38:12,300 --> 00:38:14,339
platform but the thing was that drilling

1109
00:38:14,339 --> 00:38:15,839
control Network that I mentioned earlier

1110
00:38:15,839 --> 00:38:18,599
that sat on the drilling part of it not

1111
00:38:18,599 --> 00:38:20,400
the accommodation

1112
00:38:20,400 --> 00:38:23,280
so people are lazy people like

1113
00:38:23,280 --> 00:38:24,839
convenience they don't want to get

1114
00:38:24,839 --> 00:38:26,400
dressed up to go into all of this stuff

1115
00:38:26,400 --> 00:38:29,220
they'd rather just maybe TeamViewer into

1116
00:38:29,220 --> 00:38:30,660
that

1117
00:38:30,660 --> 00:38:32,640
so the ideal situation here is we've got

1118
00:38:32,640 --> 00:38:34,140
all of our drilling control networks sat

1119
00:38:34,140 --> 00:38:35,820
there completely air gap from the

1120
00:38:35,820 --> 00:38:37,320
business Networks

1121
00:38:37,320 --> 00:38:39,720
but that wasn't what we found

1122
00:38:39,720 --> 00:38:41,220
so I went out into the equipment room

1123
00:38:41,220 --> 00:38:43,260
below the Cyber chairs and I found this

1124
00:38:43,260 --> 00:38:45,660
PC amusingly the password hint

1125
00:38:45,660 --> 00:38:47,280
underneath it did have a password on it

1126
00:38:47,280 --> 00:38:49,800
said who do you work for so I typed in

1127
00:38:49,800 --> 00:38:51,359
the name of the company it needed a

1128
00:38:51,359 --> 00:38:52,560
capital letter at the beginning so I got

1129
00:38:52,560 --> 00:38:54,480
it wrong the first time but you know not

1130
00:38:54,480 --> 00:38:56,940
much of a barrier so there's this PC and

1131
00:38:56,940 --> 00:38:59,940
I did ipconfig

1132
00:38:59,940 --> 00:39:01,560
and there was something interesting I

1133
00:39:01,560 --> 00:39:03,420
saw first off this was a kongsburg

1134
00:39:03,420 --> 00:39:05,700
maritime PC that had been repurposed it

1135
00:39:05,700 --> 00:39:07,740
was from the control systems of the

1136
00:39:07,740 --> 00:39:09,660
vessel it just been taken out there I

1137
00:39:09,660 --> 00:39:10,800
knew that because of the names of the

1138
00:39:10,800 --> 00:39:12,000
network

1139
00:39:12,000 --> 00:39:14,400
but also there was one ethernet adapter

1140
00:39:14,400 --> 00:39:16,380
in it that had an IP address but the one

1141
00:39:16,380 --> 00:39:18,540
below it in red there

1142
00:39:18,540 --> 00:39:20,880
said media disconnected but it also had

1143
00:39:20,880 --> 00:39:24,000
a DNS suffix of Court dot local now the

1144
00:39:24,000 --> 00:39:25,800
way that Windows works is when you plug

1145
00:39:25,800 --> 00:39:28,260
into a network and you get a DHCP

1146
00:39:28,260 --> 00:39:30,060
address

1147
00:39:30,060 --> 00:39:32,820
the DNS suffix populates itself when you

1148
00:39:32,820 --> 00:39:34,859
unplug it it persists

1149
00:39:34,859 --> 00:39:36,960
so to me this is a clue saying that that

1150
00:39:36,960 --> 00:39:38,640
network connection had been plugged in

1151
00:39:38,640 --> 00:39:40,140
in the past

1152
00:39:40,140 --> 00:39:42,000
why has it been unplugged what's going

1153
00:39:42,000 --> 00:39:44,339
on here I mean I like to think I'm a

1154
00:39:44,339 --> 00:39:46,380
detective but I just look to my left and

1155
00:39:46,380 --> 00:39:48,119
there was a network cable

1156
00:39:48,119 --> 00:39:50,640
literally unplugged from a socket

1157
00:39:50,640 --> 00:39:52,560
and I thought well what happens if I

1158
00:39:52,560 --> 00:39:54,180
plug into that and I plugged into it and

1159
00:39:54,180 --> 00:39:55,920
I got an address on the corporate

1160
00:39:55,920 --> 00:39:58,099
Network

1161
00:39:58,500 --> 00:40:00,420
so now we've got that jump box going

1162
00:40:00,420 --> 00:40:02,400
between the business Network and the

1163
00:40:02,400 --> 00:40:04,140
drilling control Network it did have

1164
00:40:04,140 --> 00:40:05,880
TeamViewer on it it was personal

1165
00:40:05,880 --> 00:40:07,440
TeamViewer rather than the corporate one

1166
00:40:07,440 --> 00:40:09,780
because this was not this was Shadow I.T

1167
00:40:09,780 --> 00:40:12,300
something that wasn't authorized not

1168
00:40:12,300 --> 00:40:14,700
great in the general scheme of things

1169
00:40:14,700 --> 00:40:17,220
so here really what they had done is

1170
00:40:17,220 --> 00:40:19,079
they hadn't provided an authorized way

1171
00:40:19,079 --> 00:40:20,579
of remotely accessing the drilling

1172
00:40:20,579 --> 00:40:22,320
control Network so someone went and did

1173
00:40:22,320 --> 00:40:24,180
it themselves and they did it incredibly

1174
00:40:24,180 --> 00:40:26,460
badly

1175
00:40:26,460 --> 00:40:28,380
the next one fingerprint Access Control

1176
00:40:28,380 --> 00:40:30,240
sounds like a great idea I know people

1177
00:40:30,240 --> 00:40:31,920
have got some complaints with Biometrics

1178
00:40:31,920 --> 00:40:33,660
but on a ship you want to control access

1179
00:40:33,660 --> 00:40:35,820
to the bridge to Machinery spaces and so

1180
00:40:35,820 --> 00:40:36,599
on

1181
00:40:36,599 --> 00:40:38,760
so this ship added fingerprint Access

1182
00:40:38,760 --> 00:40:40,800
Control seems like a great idea doesn't

1183
00:40:40,800 --> 00:40:43,020
it until you meet an engineer

1184
00:40:43,020 --> 00:40:45,200
foreign

1185
00:40:45,619 --> 00:40:49,619
filthy absolutely filthy so what happens

1186
00:40:49,619 --> 00:40:51,660
they found that these biometric readers

1187
00:40:51,660 --> 00:40:52,859
would not read fingerprints for

1188
00:40:52,859 --> 00:40:55,440
engineers so what did they do they gave

1189
00:40:55,440 --> 00:40:58,260
every engineer a master key

1190
00:40:58,260 --> 00:41:00,660
a physical master key for the lock that

1191
00:41:00,660 --> 00:41:02,760
can bypass it so now we've got 40

1192
00:41:02,760 --> 00:41:04,680
Engineers who've got master keys that

1193
00:41:04,680 --> 00:41:06,420
they can lose you can't revoke those

1194
00:41:06,420 --> 00:41:07,680
credentials

1195
00:41:07,680 --> 00:41:09,359
absolutely crazy

1196
00:41:09,359 --> 00:41:11,339
it's a security control that was

1197
00:41:11,339 --> 00:41:13,079
implemented and because it wasn't done

1198
00:41:13,079 --> 00:41:15,240
well without considering the users it

1199
00:41:15,240 --> 00:41:17,040
made things worse

1200
00:41:17,040 --> 00:41:19,079
the other one HMI is human machine

1201
00:41:19,079 --> 00:41:20,820
interfaces

1202
00:41:20,820 --> 00:41:21,480
um

1203
00:41:21,480 --> 00:41:23,700
these are the screens on ships that you

1204
00:41:23,700 --> 00:41:25,200
interact with machinery and so on and

1205
00:41:25,200 --> 00:41:26,820
there'll be hundreds of them on a cruise

1206
00:41:26,820 --> 00:41:28,859
ship there'll be ones in the HVAC rooms

1207
00:41:28,859 --> 00:41:30,420
in the air conditioning there'll be ones

1208
00:41:30,420 --> 00:41:31,560
down in the engine room they'll be

1209
00:41:31,560 --> 00:41:32,640
everywhere

1210
00:41:32,640 --> 00:41:34,680
and we've gained significant access

1211
00:41:34,680 --> 00:41:36,359
before walking into a swimming pool

1212
00:41:36,359 --> 00:41:38,579
control room and getting an HMI there

1213
00:41:38,579 --> 00:41:40,320
breaking out of it and doing bad things

1214
00:41:40,320 --> 00:41:42,900
so people want to lock them like you'd

1215
00:41:42,900 --> 00:41:44,339
like a normal laptop or a desktop

1216
00:41:44,339 --> 00:41:45,960
computer your screen saver comes on you

1217
00:41:45,960 --> 00:41:48,300
need a password so again they

1218
00:41:48,300 --> 00:41:51,000
implemented locking of the hmis you had

1219
00:41:51,000 --> 00:41:53,760
two minutes so you'd log into it you'd

1220
00:41:53,760 --> 00:41:55,140
get two minutes and you'd have to log

1221
00:41:55,140 --> 00:41:58,200
into it again now the thing is and and I

1222
00:41:58,200 --> 00:42:00,180
know this I've worked on ships you might

1223
00:42:00,180 --> 00:42:02,160
be starting up a purifier tending to the

1224
00:42:02,160 --> 00:42:04,619
 tank whatever it is but you will

1225
00:42:04,619 --> 00:42:06,420
make it do something on the HMI you'll

1226
00:42:06,420 --> 00:42:08,400
go and do some physical work and then

1227
00:42:08,400 --> 00:42:10,140
three minutes later you'll come back to

1228
00:42:10,140 --> 00:42:12,180
check if everything's working

1229
00:42:12,180 --> 00:42:14,880
now the terminal is locked you've now

1230
00:42:14,880 --> 00:42:17,460
got oil or poo on your hands both

1231
00:42:17,460 --> 00:42:19,740
whichever one it is so what happened

1232
00:42:19,740 --> 00:42:21,960
here was that the engineers worked out

1233
00:42:21,960 --> 00:42:24,720
there were two high-level user accounts

1234
00:42:24,720 --> 00:42:26,339
on

1235
00:42:26,339 --> 00:42:29,460
the icms system the control systems c

1236
00:42:29,460 --> 00:42:32,760
and e captain and engineer that had a

1237
00:42:32,760 --> 00:42:34,800
fairly easily guessed password that

1238
00:42:34,800 --> 00:42:36,900
didn't have that time out

1239
00:42:36,900 --> 00:42:39,480
so what we found was most of the hmis on

1240
00:42:39,480 --> 00:42:41,280
the ship were just logged in as these

1241
00:42:41,280 --> 00:42:43,920
hard-coded users you couldn't they

1242
00:42:43,920 --> 00:42:45,900
weren't locking so again someone had

1243
00:42:45,900 --> 00:42:47,880
added these controls and they just not

1244
00:42:47,880 --> 00:42:50,960
done it particularly well

1245
00:42:51,839 --> 00:42:54,300
Simplicity can lead to vulnerability

1246
00:42:54,300 --> 00:42:56,339
now a massive thing that we found over

1247
00:42:56,339 --> 00:43:00,000
the last 10 years is that ships have

1248
00:43:00,000 --> 00:43:01,680
moved towards what we call converged

1249
00:43:01,680 --> 00:43:03,839
networks from discrete Networks

1250
00:43:03,839 --> 00:43:05,579
previously you'd have passenger networks

1251
00:43:05,579 --> 00:43:08,160
CCTV corporate operational technology

1252
00:43:08,160 --> 00:43:10,020
all on physically separate switches

1253
00:43:10,020 --> 00:43:12,060
physically separate connections the

1254
00:43:12,060 --> 00:43:13,740
thing is they've all got so complex that

1255
00:43:13,740 --> 00:43:15,119
running all of these different cables

1256
00:43:15,119 --> 00:43:16,020
and having all these different

1257
00:43:16,020 --> 00:43:17,819
infrastructures become really complex

1258
00:43:17,819 --> 00:43:19,700
and you end up with stuff like this

1259
00:43:19,700 --> 00:43:22,500
cables everywhere you can't manage this

1260
00:43:22,500 --> 00:43:24,900
you can't manage it remotely

1261
00:43:24,900 --> 00:43:26,700
so they've moved to converge networks

1262
00:43:26,700 --> 00:43:29,339
essentially using VLAN trunks so you run

1263
00:43:29,339 --> 00:43:30,660
lots and lots of different network

1264
00:43:30,660 --> 00:43:33,060
connections all down the same cable

1265
00:43:33,060 --> 00:43:34,800
that's great if I come at it from an

1266
00:43:34,800 --> 00:43:36,359
attacker's perspective on an individual

1267
00:43:36,359 --> 00:43:38,040
Network can only compromise that

1268
00:43:38,040 --> 00:43:39,480
individual Network

1269
00:43:39,480 --> 00:43:41,579
but we might have physical access we

1270
00:43:41,579 --> 00:43:42,960
might be able to take control of one of

1271
00:43:42,960 --> 00:43:45,060
the switches with the shared password

1272
00:43:45,060 --> 00:43:47,280
so if I can get on that VLAN trunk if I

1273
00:43:47,280 --> 00:43:49,440
can compromise a switch all of those

1274
00:43:49,440 --> 00:43:52,640
networks are compromised now

1275
00:43:53,640 --> 00:43:55,619
now one of the things with large ships

1276
00:43:55,619 --> 00:43:57,660
is they're divided into fire zones water

1277
00:43:57,660 --> 00:43:59,760
type zones vertical barriers and this

1278
00:43:59,760 --> 00:44:01,500
changes how they implement the network

1279
00:44:01,500 --> 00:44:03,240
you can't just run cables everywhere

1280
00:44:03,240 --> 00:44:05,339
it's fairly easy to run cables

1281
00:44:05,339 --> 00:44:07,560
vertically it's really really difficult

1282
00:44:07,560 --> 00:44:09,660
to run them horizontally and this

1283
00:44:09,660 --> 00:44:11,760
dictates how the ships are architected

1284
00:44:11,760 --> 00:44:13,740
we have these things called rdps remote

1285
00:44:13,740 --> 00:44:15,839
distribution points there'll be one per

1286
00:44:15,839 --> 00:44:18,480
fire zone and looped off them will be

1287
00:44:18,480 --> 00:44:20,400
what are called cabin switches they're

1288
00:44:20,400 --> 00:44:22,319
access switches they take a VLAN trunk

1289
00:44:22,319 --> 00:44:23,520
through them and they'll break out

1290
00:44:23,520 --> 00:44:25,859
different network connections so there'd

1291
00:44:25,859 --> 00:44:27,780
be lots of those you'll tend to have two

1292
00:44:27,780 --> 00:44:29,640
sets of rdps for redundancy port and

1293
00:44:29,640 --> 00:44:30,720
starboard side

1294
00:44:30,720 --> 00:44:33,180
and hanging off them you've got vsat the

1295
00:44:33,180 --> 00:44:35,579
satellite connection engine room systems

1296
00:44:35,579 --> 00:44:37,740
Bridge systems and so on and that trunk

1297
00:44:37,740 --> 00:44:40,500
running through that RDP Loop running

1298
00:44:40,500 --> 00:44:42,119
through the cabins carries lots of

1299
00:44:42,119 --> 00:44:43,619
network traffic that you might not

1300
00:44:43,619 --> 00:44:46,560
necessarily want to see in your cabin

1301
00:44:46,560 --> 00:44:49,800
to give you an idea of scale this is one

1302
00:44:49,800 --> 00:44:51,720
half of a patch Bay for one of those

1303
00:44:51,720 --> 00:44:54,660
rdps I hang off each one of those Loops

1304
00:44:54,660 --> 00:44:57,720
is about 10 cabins so it's a huge number

1305
00:44:57,720 --> 00:44:59,339
of switches

1306
00:44:59,339 --> 00:45:01,380
let's break that out a bit so we've got

1307
00:45:01,380 --> 00:45:02,700
a cabin switch

1308
00:45:02,700 --> 00:45:04,980
now each cabin switch has two cabins

1309
00:45:04,980 --> 00:45:07,980
hanging outfit so we've got cabinet and

1310
00:45:07,980 --> 00:45:10,980
our TV will come over over the IP

1311
00:45:10,980 --> 00:45:13,200
network there our VoIP phone will come

1312
00:45:13,200 --> 00:45:15,540
come over that IP network the cabin

1313
00:45:15,540 --> 00:45:17,460
control system that controls the

1314
00:45:17,460 --> 00:45:20,099
lighting the HVAC the door you can lock

1315
00:45:20,099 --> 00:45:21,900
and unlock the door through it and the

1316
00:45:21,900 --> 00:45:23,880
water temperature all comes through that

1317
00:45:23,880 --> 00:45:25,619
Network so that vlant trunk gets broken

1318
00:45:25,619 --> 00:45:27,660
out into the individual cabin

1319
00:45:27,660 --> 00:45:29,520
we'll have cabin B the other side of it

1320
00:45:29,520 --> 00:45:30,839
two cabins

1321
00:45:30,839 --> 00:45:32,579
but for convenience because it's

1322
00:45:32,579 --> 00:45:33,660
difficult making those connections

1323
00:45:33,660 --> 00:45:35,819
across a ship rather than down we'll

1324
00:45:35,819 --> 00:45:37,260
also have things like Wi-Fi access

1325
00:45:37,260 --> 00:45:39,540
points and CCTV cameras

1326
00:45:39,540 --> 00:45:41,339
hanging off that Network

1327
00:45:41,339 --> 00:45:43,200
that means if I gain physical access to

1328
00:45:43,200 --> 00:45:44,280
that trunk

1329
00:45:44,280 --> 00:45:46,140
all of those networks are mine to

1330
00:45:46,140 --> 00:45:47,339
interact with

1331
00:45:47,339 --> 00:45:49,920
so how do we do that well we first did

1332
00:45:49,920 --> 00:45:51,599
this when we on we were on an

1333
00:45:51,599 --> 00:45:53,880
operational cruise ship I couldn't sit

1334
00:45:53,880 --> 00:45:56,220
in a passageway and start unplugging

1335
00:45:56,220 --> 00:45:58,020
things and messing about so we needed to

1336
00:45:58,020 --> 00:46:00,720
do it relatively covertly so what I did

1337
00:46:00,720 --> 00:46:03,540
first was I unplugged my TV my VoIP

1338
00:46:03,540 --> 00:46:05,760
phone I wasn't watching TV I'm allowed

1339
00:46:05,760 --> 00:46:06,839
to hack a cruise ship there's more

1340
00:46:06,839 --> 00:46:09,000
interesting things to do unplug my vote

1341
00:46:09,000 --> 00:46:10,440
phone so now I've got a connection going

1342
00:46:10,440 --> 00:46:13,140
for my cabin out to the cabin switch

1343
00:46:13,140 --> 00:46:15,420
I then went to the cabin switch which is

1344
00:46:15,420 --> 00:46:17,579
just in a panel in the passageway very

1345
00:46:17,579 --> 00:46:19,859
little physical access control and I

1346
00:46:19,859 --> 00:46:22,619
disconnected the cabin switch from that

1347
00:46:22,619 --> 00:46:25,020
Loop and put my TV and VoIP phone into

1348
00:46:25,020 --> 00:46:26,640
those connections so now it's going

1349
00:46:26,640 --> 00:46:27,900
through my cabin

1350
00:46:27,900 --> 00:46:30,480
and then put a switch in my cabin

1351
00:46:30,480 --> 00:46:32,160
so now I've got the VLAN trunks coming

1352
00:46:32,160 --> 00:46:33,420
through my cabin

1353
00:46:33,420 --> 00:46:35,760
I can't get TV in my cabin anymore but

1354
00:46:35,760 --> 00:46:37,319
that's not really a problem when I want

1355
00:46:37,319 --> 00:46:40,500
to steer a cruise ship remotely

1356
00:46:40,500 --> 00:46:42,839
we've managed to do this in around two

1357
00:46:42,839 --> 00:46:45,180
minutes give or take so we can open up

1358
00:46:45,180 --> 00:46:47,400
the panel in the passageway open up

1359
00:46:47,400 --> 00:46:49,079
connect to that and Patch it through to

1360
00:46:49,079 --> 00:46:51,420
our cabin in in about two three minutes

1361
00:46:51,420 --> 00:46:54,300
give or take I've done it on a ship and

1362
00:46:54,300 --> 00:46:56,280
no one said anything and I've got access

1363
00:46:56,280 --> 00:46:59,040
to all of these different Networks

1364
00:46:59,040 --> 00:47:01,440
so now we've got that attacker switch

1365
00:47:01,440 --> 00:47:03,359
we'll be honest the TV system the

1366
00:47:03,359 --> 00:47:04,980
passwords are all default the VoIP

1367
00:47:04,980 --> 00:47:07,140
phones the passwords are all default the

1368
00:47:07,140 --> 00:47:10,440
Wi-Fi had some slight problems the CCTV

1369
00:47:10,440 --> 00:47:12,480
to view those cameras there was no

1370
00:47:12,480 --> 00:47:14,160
control on that you could just view all

1371
00:47:14,160 --> 00:47:16,200
of the cameras several thousand cameras

1372
00:47:16,200 --> 00:47:17,400
across the ship

1373
00:47:17,400 --> 00:47:19,980
obviously redacted somewhat but we also

1374
00:47:19,980 --> 00:47:22,140
had access to the cabin control system

1375
00:47:22,140 --> 00:47:24,240
which let you change what the lights

1376
00:47:24,240 --> 00:47:26,280
were doing now this isn't an image this

1377
00:47:26,280 --> 00:47:27,660
this is this is an image of the Internet

1378
00:47:27,660 --> 00:47:28,920
it's not what we were allowed to do we

1379
00:47:28,920 --> 00:47:30,420
did go and say to the client can we

1380
00:47:30,420 --> 00:47:32,040
write rude words down the side of your

1381
00:47:32,040 --> 00:47:33,359
ship using the lights in the cabin

1382
00:47:33,359 --> 00:47:35,280
control system

1383
00:47:35,280 --> 00:47:37,560
and they said no

1384
00:47:37,560 --> 00:47:39,839
um I really disappointingly I found out

1385
00:47:39,839 --> 00:47:41,400
on another ship you can't always turn

1386
00:47:41,400 --> 00:47:42,540
the lights on and off using the cabin

1387
00:47:42,540 --> 00:47:44,040
control system

1388
00:47:44,040 --> 00:47:45,660
they just make a spreadsheet and then

1389
00:47:45,660 --> 00:47:47,579
send someone who's not paid very much to

1390
00:47:47,579 --> 00:47:49,079
go and turn the lights on and off in all

1391
00:47:49,079 --> 00:47:50,760
the cabins

1392
00:47:50,760 --> 00:47:53,339
right that's been all the things we've

1393
00:47:53,339 --> 00:47:55,200
found on shit's kind of laid out let's

1394
00:47:55,200 --> 00:47:56,700
bring that together how could you

1395
00:47:56,700 --> 00:48:00,000
control a cruise ship remotely

1396
00:48:00,000 --> 00:48:02,099
Speed 2 cruise control my inspiration

1397
00:48:02,099 --> 00:48:04,740
for my entire life still not met Sandra

1398
00:48:04,740 --> 00:48:06,420
Bullock though

1399
00:48:06,420 --> 00:48:07,740
so the main thing on a ship that

1400
00:48:07,740 --> 00:48:09,300
controls the engine rooms navigation

1401
00:48:09,300 --> 00:48:11,339
sounds called the icms the integrated

1402
00:48:11,339 --> 00:48:13,859
control and monitoring system that does

1403
00:48:13,859 --> 00:48:16,140
pretty much everything nowadays if you

1404
00:48:16,140 --> 00:48:18,000
turn a Rudder if you start and stop the

1405
00:48:18,000 --> 00:48:19,680
engines it could all go through this

1406
00:48:19,680 --> 00:48:20,520
system

1407
00:48:20,520 --> 00:48:23,520
very very powerful and important

1408
00:48:23,520 --> 00:48:25,260
but on a cruise ship you've also got a

1409
00:48:25,260 --> 00:48:27,119
very important system called the SMS or

1410
00:48:27,119 --> 00:48:29,099
Safety Management System

1411
00:48:29,099 --> 00:48:31,260
this is a specific room generally behind

1412
00:48:31,260 --> 00:48:34,980
the bridge the Safety Center where if

1413
00:48:34,980 --> 00:48:36,960
there's a fire if someone goes overboard

1414
00:48:36,960 --> 00:48:40,560
if you need to abandon ship it gets

1415
00:48:40,560 --> 00:48:42,900
coordinated from here and it brings

1416
00:48:42,900 --> 00:48:46,260
together everything CCTV watertight

1417
00:48:46,260 --> 00:48:48,720
doors ventilation firefighting pumps

1418
00:48:48,720 --> 00:48:51,720
energy absolutely everything comes into

1419
00:48:51,720 --> 00:48:54,480
the SMS as a result it's got connections

1420
00:48:54,480 --> 00:48:56,940
through to everything from an attacker's

1421
00:48:56,940 --> 00:48:58,980
perspective it's very interesting

1422
00:48:58,980 --> 00:49:01,740
our goal was to take control over the

1423
00:49:01,740 --> 00:49:03,780
azipods on the bottom of the vessel

1424
00:49:03,780 --> 00:49:05,280
modern cruise ships are powered by

1425
00:49:05,280 --> 00:49:07,380
things called azipod's gigantic electric

1426
00:49:07,380 --> 00:49:09,240
motors that can physically rotate there

1427
00:49:09,240 --> 00:49:11,700
are no rudders and that was what we

1428
00:49:11,700 --> 00:49:13,980
wanted to do and we thought let's give

1429
00:49:13,980 --> 00:49:15,780
it a go

1430
00:49:15,780 --> 00:49:17,280
now we've already got that attacker

1431
00:49:17,280 --> 00:49:19,740
switch on the network so we've got the

1432
00:49:19,740 --> 00:49:22,619
ability to inject traffic onto trunks

1433
00:49:22,619 --> 00:49:24,180
because we had physical access to the

1434
00:49:24,180 --> 00:49:25,380
switch we managed to dump a

1435
00:49:25,380 --> 00:49:27,180
configuration from a switch we managed

1436
00:49:27,180 --> 00:49:29,040
to get a pass room from that and oddly

1437
00:49:29,040 --> 00:49:31,619
it worked on one RDP it only worked on

1438
00:49:31,619 --> 00:49:33,060
one of those remote distribution points

1439
00:49:33,060 --> 00:49:34,680
it'd been changed on all the other ones

1440
00:49:34,680 --> 00:49:37,500
the password we recovered was the name

1441
00:49:37,500 --> 00:49:39,839
of a vendor in late speak to make it a

1442
00:49:39,839 --> 00:49:40,859
little bit more difficult to work out

1443
00:49:40,859 --> 00:49:42,540
but it was just an emission someone had

1444
00:49:42,540 --> 00:49:44,579
made a mistake and left it on an RDP

1445
00:49:44,579 --> 00:49:46,260
that meant we could reconfigure how

1446
00:49:46,260 --> 00:49:49,380
Network traffic was rooted on that ship

1447
00:49:49,380 --> 00:49:51,540
so breaking it down

1448
00:49:51,540 --> 00:49:52,920
on the left hand side we've got the

1449
00:49:52,920 --> 00:49:54,599
passenger cabins that where that's where

1450
00:49:54,599 --> 00:49:56,099
we're coming from we've now got control

1451
00:49:56,099 --> 00:49:58,619
over the core Network it's not a great

1452
00:49:58,619 --> 00:50:01,380
situation that core network carries

1453
00:50:01,380 --> 00:50:04,380
traffic for the safety management system

1454
00:50:04,380 --> 00:50:06,540
an interesting thing oh and I've just

1455
00:50:06,540 --> 00:50:08,220
skipped too many slides

1456
00:50:08,220 --> 00:50:10,578
sorry

1457
00:50:12,660 --> 00:50:16,220
oh you've seen the big reveal now

1458
00:50:17,339 --> 00:50:18,780
interesting thing with the safety

1459
00:50:18,780 --> 00:50:20,099
management system was they had these

1460
00:50:20,099 --> 00:50:22,319
remote tablets so if there was an

1461
00:50:22,319 --> 00:50:24,300
emergency situation and you needed to

1462
00:50:24,300 --> 00:50:26,640
manage that from a a firefighting point

1463
00:50:26,640 --> 00:50:28,079
or something like that you could take a

1464
00:50:28,079 --> 00:50:29,940
remote tablet and deal with that it was

1465
00:50:29,940 --> 00:50:31,680
a Windows tablet which meant we could

1466
00:50:31,680 --> 00:50:33,780
get the Wi-Fi password that accessed the

1467
00:50:33,780 --> 00:50:35,940
safety management system from there and

1468
00:50:35,940 --> 00:50:37,260
get the passwords for the safety

1469
00:50:37,260 --> 00:50:38,640
management system

1470
00:50:38,640 --> 00:50:40,560
so we've compromised the Wi-Fi aspect of

1471
00:50:40,560 --> 00:50:41,579
that

1472
00:50:41,579 --> 00:50:44,940
this is a genuine picture from a test

1473
00:50:44,940 --> 00:50:46,980
the password was set to one two three

1474
00:50:46,980 --> 00:50:49,140
four our recommendation was to make the

1475
00:50:49,140 --> 00:50:53,118
password stronger the client's response

1476
00:50:55,020 --> 00:50:58,040
yeah not great

1477
00:50:58,140 --> 00:51:00,180
so we've now got access to the safety

1478
00:51:00,180 --> 00:51:01,680
management system we can control

1479
00:51:01,680 --> 00:51:04,319
watertight doors I mean watertight doors

1480
00:51:04,319 --> 00:51:05,880
are serious things so these massive

1481
00:51:05,880 --> 00:51:07,859
hydraulic doors deep down in the vessel

1482
00:51:07,859 --> 00:51:09,540
that you can move backwards and forwards

1483
00:51:09,540 --> 00:51:11,880
we can control ventilation firefighting

1484
00:51:11,880 --> 00:51:14,520
pumps and so on

1485
00:51:14,520 --> 00:51:16,619
so Safety Management Systems compromised

1486
00:51:16,619 --> 00:51:18,240
I've already talked about how we've got

1487
00:51:18,240 --> 00:51:19,920
control over the voyage data recorder

1488
00:51:19,920 --> 00:51:22,079
we've got control over the fire alarms

1489
00:51:22,079 --> 00:51:23,880
that we can brick them now from the

1490
00:51:23,880 --> 00:51:25,680
safety management system not a great

1491
00:51:25,680 --> 00:51:26,880
situation

1492
00:51:26,880 --> 00:51:28,980
now you'll notice I'll split the cabins

1493
00:51:28,980 --> 00:51:31,380
into offices and passengers now the

1494
00:51:31,380 --> 00:51:32,940
network had been configured so that

1495
00:51:32,940 --> 00:51:35,220
officers could Connect into the icms the

1496
00:51:35,220 --> 00:51:37,440
control systems with the read-only view

1497
00:51:37,440 --> 00:51:39,780
so if an alarm goes off if something bad

1498
00:51:39,780 --> 00:51:41,880
happens they can have their laptop a

1499
00:51:41,880 --> 00:51:44,040
desktop computer and they can see what's

1500
00:51:44,040 --> 00:51:46,800
going on on the control systems it was

1501
00:51:46,800 --> 00:51:49,380
done using RDP so just a remote desktop

1502
00:51:49,380 --> 00:51:51,660
onto the icms system

1503
00:51:51,660 --> 00:51:53,400
I might be connected over that it was a

1504
00:51:53,400 --> 00:51:55,680
read-only view you couldn't even if you

1505
00:51:55,680 --> 00:51:57,540
logged in as that those secret Chief and

1506
00:51:57,540 --> 00:51:58,859
engineer accounts you couldn't change

1507
00:51:58,859 --> 00:52:00,300
anything you couldn't change any

1508
00:52:00,300 --> 00:52:02,520
settings so it seems like that's quite

1509
00:52:02,520 --> 00:52:03,420
secure

1510
00:52:03,420 --> 00:52:05,400
until you go to file print and then you

1511
00:52:05,400 --> 00:52:06,900
get the dialog come up and you open

1512
00:52:06,900 --> 00:52:09,660
command prompt and you've got a breakout

1513
00:52:09,660 --> 00:52:12,839
and it's an admin user so now we've got

1514
00:52:12,839 --> 00:52:15,960
an icms host where we've got admin full

1515
00:52:15,960 --> 00:52:17,940
admin on that box

1516
00:52:17,940 --> 00:52:19,920
the situation is now from the passenger

1517
00:52:19,920 --> 00:52:21,839
Network we can go through to the icms

1518
00:52:21,839 --> 00:52:24,240
and log in as admin pretty serious

1519
00:52:24,240 --> 00:52:27,200
situation to be in

1520
00:52:27,780 --> 00:52:31,020
now this little orange line there we're

1521
00:52:31,020 --> 00:52:32,400
going from the engine room systems

1522
00:52:32,400 --> 00:52:34,559
through to the azipod systems and we

1523
00:52:34,559 --> 00:52:36,059
didn't really understand what that

1524
00:52:36,059 --> 00:52:38,220
connection was how are commands being

1525
00:52:38,220 --> 00:52:39,540
sent from the engine room systems

1526
00:52:39,540 --> 00:52:41,640
through to the azipods and we needed to

1527
00:52:41,640 --> 00:52:44,299
understand that

1528
00:52:44,819 --> 00:52:46,559
now a common way of industrial control

1529
00:52:46,559 --> 00:52:48,420
equipment talking to to each other is

1530
00:52:48,420 --> 00:52:51,000
discrete serial connections or discrete

1531
00:52:51,000 --> 00:52:52,800
IO just things turning on and off with

1532
00:52:52,800 --> 00:52:55,079
individual wires the problem is you end

1533
00:52:55,079 --> 00:52:56,579
up with lots of wires you don't want

1534
00:52:56,579 --> 00:52:58,980
lots of wires so if you compromise one

1535
00:52:58,980 --> 00:53:00,599
of those you can only compromise the

1536
00:53:00,599 --> 00:53:02,339
device on the end of it and you can't

1537
00:53:02,339 --> 00:53:04,440
move out of scope I might be able to

1538
00:53:04,440 --> 00:53:05,700
turn something on or off but I'm not

1539
00:53:05,700 --> 00:53:08,099
going to be able to RDP over a serial

1540
00:53:08,099 --> 00:53:09,000
connection

1541
00:53:09,000 --> 00:53:11,339
but people have converged these Networks

1542
00:53:11,339 --> 00:53:14,339
they've moved to serial over IP

1543
00:53:14,339 --> 00:53:16,140
so there'll be a host there'll be a box

1544
00:53:16,140 --> 00:53:18,420
that takes 20 30 serial connections and

1545
00:53:18,420 --> 00:53:20,280
it will Ram it down one ethernet cable

1546
00:53:20,280 --> 00:53:22,020
to the other end where they'll pop out

1547
00:53:22,020 --> 00:53:24,660
all in one go

1548
00:53:24,660 --> 00:53:26,040
the problem is that ethernet connection

1549
00:53:26,040 --> 00:53:28,200
is not just designed to take serial it

1550
00:53:28,200 --> 00:53:30,660
can take RDP SSH whatever I want it to

1551
00:53:30,660 --> 00:53:33,119
if I compromise one end of that I can

1552
00:53:33,119 --> 00:53:34,500
remote desktop through to the other end

1553
00:53:34,500 --> 00:53:37,020
compromise the host at the other end and

1554
00:53:37,020 --> 00:53:38,880
if there's other networks on the end of

1555
00:53:38,880 --> 00:53:40,740
that I can then pivot through that

1556
00:53:40,740 --> 00:53:41,700
device

1557
00:53:41,700 --> 00:53:44,460
IP is so much more risky than serial

1558
00:53:44,460 --> 00:53:47,040
it's a rootable network you can't do

1559
00:53:47,040 --> 00:53:48,720
that with serial

1560
00:53:48,720 --> 00:53:51,599
so why does this matter well once again

1561
00:53:51,599 --> 00:53:53,700
we've got that privilege of a tester on

1562
00:53:53,700 --> 00:53:55,800
board we could look at the documentation

1563
00:53:55,800 --> 00:53:58,079
and we looked at the documentation and

1564
00:53:58,079 --> 00:54:00,059
you can see there in the dotted Red Line

1565
00:54:00,059 --> 00:54:02,819
there there's a card in a pack a pack is

1566
00:54:02,819 --> 00:54:04,500
a programmable automation control it's

1567
00:54:04,500 --> 00:54:07,200
like a PLC but runs Windows and is less

1568
00:54:07,200 --> 00:54:09,379
good

1569
00:54:09,420 --> 00:54:10,980
it's got a connection there labeled

1570
00:54:10,980 --> 00:54:14,040
serial and it's got four ports on it and

1571
00:54:14,040 --> 00:54:15,720
then it goes through and it hits a

1572
00:54:15,720 --> 00:54:18,420
firewall and then a switch

1573
00:54:18,420 --> 00:54:20,700
last time I checked serial doesn't go

1574
00:54:20,700 --> 00:54:22,559
through files and switches this was

1575
00:54:22,559 --> 00:54:25,440
ethernet it was serial over ethernet but

1576
00:54:25,440 --> 00:54:27,240
it had been labeled serial on all the

1577
00:54:27,240 --> 00:54:28,619
diagrams and I think that meant that

1578
00:54:28,619 --> 00:54:30,660
people thought the risk was the same as

1579
00:54:30,660 --> 00:54:33,319
a serial connection

1580
00:54:33,540 --> 00:54:35,880
we want full Inception I think we have

1581
00:54:35,880 --> 00:54:37,800
four layers of remote desktop Deep by

1582
00:54:37,800 --> 00:54:40,380
the point we got here but we're now

1583
00:54:40,380 --> 00:54:43,020
already paid onto one of the controllers

1584
00:54:43,020 --> 00:54:45,660
on the azipod system

1585
00:54:45,660 --> 00:54:48,300
it wasn't just serial we did need to

1586
00:54:48,300 --> 00:54:50,280
recover hashes from the azipod system

1587
00:54:50,280 --> 00:54:51,900
and carry out a Brute Force attack again

1588
00:54:51,900 --> 00:54:53,220
something that other people wouldn't

1589
00:54:53,220 --> 00:54:55,020
have the privilege for but the passwords

1590
00:54:55,020 --> 00:54:56,819
were not good

1591
00:54:56,819 --> 00:54:59,339
so the situation is now we've got all of

1592
00:54:59,339 --> 00:55:01,440
these different things compromised which

1593
00:55:01,440 --> 00:55:03,900
means from my cabin I've got the ability

1594
00:55:03,900 --> 00:55:06,119
to control the azipods on the bottom of

1595
00:55:06,119 --> 00:55:07,500
the vessel

1596
00:55:07,500 --> 00:55:09,180
so that's not great in the general

1597
00:55:09,180 --> 00:55:11,839
scheme of things

1598
00:55:12,540 --> 00:55:14,280
the thing is

1599
00:55:14,280 --> 00:55:15,780
you might say you're still on the ship

1600
00:55:15,780 --> 00:55:18,300
now I'd like to heart back to speed two

1601
00:55:18,300 --> 00:55:19,800
where in fact he was still on the ship

1602
00:55:19,800 --> 00:55:21,960
so I've achieved the goals of speed too

1603
00:55:21,960 --> 00:55:24,119
but we want to do this remotely don't we

1604
00:55:24,119 --> 00:55:27,420
our good old friend TeamViewer comes

1605
00:55:27,420 --> 00:55:28,980
now this isn't from this particular

1606
00:55:28,980 --> 00:55:30,480
situation this these are the screenshots

1607
00:55:30,480 --> 00:55:32,760
from the oil rig with that jump box

1608
00:55:32,760 --> 00:55:35,160
TeamViewer personal was installed on a

1609
00:55:35,160 --> 00:55:36,480
device and of course we could connect

1610
00:55:36,480 --> 00:55:39,240
remotely where did that happen on the

1611
00:55:39,240 --> 00:55:40,619
cruise ship

1612
00:55:40,619 --> 00:55:43,559
it was the cabin control system

1613
00:55:43,559 --> 00:55:46,200
now we only found this because we were

1614
00:55:46,200 --> 00:55:48,300
in the engine control room and next the

1615
00:55:48,300 --> 00:55:49,800
engine control rooms the hotel control

1616
00:55:49,800 --> 00:55:51,900
room the thing that does HVAC water and

1617
00:55:51,900 --> 00:55:54,119
so on and I could see on the cabin

1618
00:55:54,119 --> 00:55:56,520
control system in the system tray

1619
00:55:56,520 --> 00:55:58,920
TeamViewer sat there

1620
00:55:58,920 --> 00:56:01,980
I got my colleague to distract people

1621
00:56:01,980 --> 00:56:03,660
whilst I looked for the password in

1622
00:56:03,660 --> 00:56:06,420
TeamViewer the password was long and of

1623
00:56:06,420 --> 00:56:07,980
relatively good quality

1624
00:56:07,980 --> 00:56:10,380
but it was a fixed password for that

1625
00:56:10,380 --> 00:56:13,619
ship it wasn't managed centrally

1626
00:56:13,619 --> 00:56:16,079
let's just say that again it was one of

1627
00:56:16,079 --> 00:56:17,520
those passwords where you know you've

1628
00:56:17,520 --> 00:56:18,780
got reason to believe it would be the

1629
00:56:18,780 --> 00:56:20,280
same across lots and lots of different

1630
00:56:20,280 --> 00:56:23,099
ships it was related to the vendor name

1631
00:56:23,099 --> 00:56:24,780
so we've now got control over the cabin

1632
00:56:24,780 --> 00:56:26,400
control system

1633
00:56:26,400 --> 00:56:28,020
so I could turn lights on and off mess

1634
00:56:28,020 --> 00:56:29,880
about the HVAC and stuff it's not the

1635
00:56:29,880 --> 00:56:31,380
end of the world though is it

1636
00:56:31,380 --> 00:56:32,760
but then we had a look at the cabin

1637
00:56:32,760 --> 00:56:35,400
control system and at the top there we

1638
00:56:35,400 --> 00:56:37,020
noticed it's got outdoor temperature

1639
00:56:37,020 --> 00:56:39,660
relative humidity AC temperatures on

1640
00:56:39,660 --> 00:56:41,520
it's got other feeds it could also tell

1641
00:56:41,520 --> 00:56:43,079
you what the sea water temperature is

1642
00:56:43,079 --> 00:56:45,059
where would it get them from

1643
00:56:45,059 --> 00:56:46,800
well it would get them from the icms

1644
00:56:46,800 --> 00:56:49,260
system that's where that was what what

1645
00:56:49,260 --> 00:56:50,819
would know what the sea temperature is

1646
00:56:50,819 --> 00:56:52,079
so we've got another one of these

1647
00:56:52,079 --> 00:56:54,300
connections we don't understand guess

1648
00:56:54,300 --> 00:56:58,440
what I used modbus again over ethernet

1649
00:56:58,440 --> 00:57:00,540
so we've got exactly that same situation

1650
00:57:00,540 --> 00:57:02,160
where that connection could be something

1651
00:57:02,160 --> 00:57:04,980
low risk but it's not

1652
00:57:04,980 --> 00:57:07,319
so from the CCS we can now carry out all

1653
00:57:07,319 --> 00:57:09,240
of those different exploits

1654
00:57:09,240 --> 00:57:11,400
so remotely take control over the CCS

1655
00:57:11,400 --> 00:57:14,040
using TeamViewer go through to the icms

1656
00:57:14,040 --> 00:57:15,960
that we've got admin rights on take

1657
00:57:15,960 --> 00:57:17,339
control of some controllers I've not

1658
00:57:17,339 --> 00:57:19,260
even mentioned through to the azipod

1659
00:57:19,260 --> 00:57:21,900
systems and I'm sat on my sofa at home

1660
00:57:21,900 --> 00:57:24,119
in my pants with TeamViewer able to

1661
00:57:24,119 --> 00:57:25,740
control the azibods on a cruise ship

1662
00:57:25,740 --> 00:57:28,260
which was really good fun

1663
00:57:28,260 --> 00:57:30,300
and I honestly didn't think it'd be

1664
00:57:30,300 --> 00:57:32,220
possible

1665
00:57:32,220 --> 00:57:34,200
so what can we take away from this

1666
00:57:34,200 --> 00:57:36,960
well first off work out impactful

1667
00:57:36,960 --> 00:57:38,700
attacks with minimum effort

1668
00:57:38,700 --> 00:57:40,440
the thing is is quite often we want to

1669
00:57:40,440 --> 00:57:41,880
come up with these crazy things like

1670
00:57:41,880 --> 00:57:44,000
steering a cruise ship realistically

1671
00:57:44,000 --> 00:57:46,200
bricking one of those controllers would

1672
00:57:46,200 --> 00:57:48,300
probably have as much impact ransomware

1673
00:57:48,300 --> 00:57:49,980
on the shop systems would probably have

1674
00:57:49,980 --> 00:57:51,720
as much impact

1675
00:57:51,720 --> 00:57:54,660
be lazy really just just do this always

1676
00:57:54,660 --> 00:57:56,400
try to minimize the amount of effort you

1677
00:57:56,400 --> 00:57:57,900
have to go to if you can get passwords

1678
00:57:57,900 --> 00:57:59,760
for a system by stealing a notebook off

1679
00:57:59,760 --> 00:58:02,819
the chief engineer wait no sorry I don't

1680
00:58:02,819 --> 00:58:04,160
advise that

1681
00:58:04,160 --> 00:58:05,940
undocumented stuff is absolutely

1682
00:58:05,940 --> 00:58:07,920
everywhere every ship we get on there's

1683
00:58:07,920 --> 00:58:09,960
things even brand new ones the systems

1684
00:58:09,960 --> 00:58:11,400
that are not documented people don't

1685
00:58:11,400 --> 00:58:14,280
understand how they're connected

1686
00:58:14,280 --> 00:58:16,800
convergence and modernization introduce

1687
00:58:16,800 --> 00:58:19,079
new risks most of the people on ships

1688
00:58:19,079 --> 00:58:20,579
the people who design ships are thinking

1689
00:58:20,579 --> 00:58:22,200
about things the way they were 10 years

1690
00:58:22,200 --> 00:58:24,300
ago not the way on but the way they are

1691
00:58:24,300 --> 00:58:27,180
now with tcpip everywhere

1692
00:58:27,180 --> 00:58:28,980
watch the third parties

1693
00:58:28,980 --> 00:58:31,140
every third party who gets on board your

1694
00:58:31,140 --> 00:58:33,720
ship not do any of your own ships Yachts

1695
00:58:33,720 --> 00:58:35,940
even a vote if someone gets on your ship

1696
00:58:35,940 --> 00:58:37,799
into your office whatever watch what

1697
00:58:37,799 --> 00:58:39,299
these third parties do they will put

1698
00:58:39,299 --> 00:58:41,700
remote access in if they can

1699
00:58:41,700 --> 00:58:43,440
crucially

1700
00:58:43,440 --> 00:58:45,900
I think it's worth saying not finding an

1701
00:58:45,900 --> 00:58:47,940
issue can be as useful to your client as

1702
00:58:47,940 --> 00:58:49,559
finding an issue if you can prove

1703
00:58:49,559 --> 00:58:50,940
something secure if something's

1704
00:58:50,940 --> 00:58:53,160
difficult to do then that is very very

1705
00:58:53,160 --> 00:58:54,480
useful to them

1706
00:58:54,480 --> 00:58:55,980
so yeah

1707
00:58:55,980 --> 00:58:58,319
um that's my my talk on on hacking

1708
00:58:58,319 --> 00:59:00,540
cruise ships um I'd like to dedicate

1709
00:59:00,540 --> 00:59:03,059
this to Nigel Hearn a colleague of mine

1710
00:59:03,059 --> 00:59:05,160
who he lost yesterday

1711
00:59:05,160 --> 00:59:08,400
um because he sold most of these jobs he

1712
00:59:08,400 --> 00:59:10,319
sold the first job and I'm cracking up

1713
00:59:10,319 --> 00:59:12,960
now um yeah um so this is dedicated to

1714
00:59:12,960 --> 00:59:15,540
Nigel who we lost yesterday to cancer

1715
00:59:15,540 --> 00:59:17,340
so thank you everybody

1716
00:59:17,340 --> 00:59:31,390
[Applause]

1717
00:59:31,460 --> 00:59:34,380
well Andrew thank you very much for an

1718
00:59:34,380 --> 00:59:37,200
incredibly thorough walkthrough of a

1719
00:59:37,200 --> 00:59:39,720
ship and I'm going to be petrified the

1720
00:59:39,720 --> 00:59:42,000
next time I set foot on one so you

1721
00:59:42,000 --> 00:59:44,640
should be so you should all have a

1722
00:59:44,640 --> 00:59:46,380
version of Gin now

1723
00:59:46,380 --> 00:59:48,480
um we've had a few requests for the

1724
00:59:48,480 --> 00:59:50,460
non-alcohol ones I've actually got one

1725
00:59:50,460 --> 00:59:52,079
here it actually tastes quite nice so

1726
00:59:52,079 --> 00:59:55,740
I'm very happy anyway we've all lost

1727
00:59:55,740 --> 00:59:58,319
people this is life

1728
00:59:58,319 --> 01:00:00,059
but it's been a very poignant three

1729
01:00:00,059 --> 01:00:02,880
years everyone knows someone who's been

1730
01:00:02,880 --> 01:00:06,480
lost due to covid that's the reality

1731
01:00:06,480 --> 01:00:09,059
um but we've had people die of other

1732
01:00:09,059 --> 01:00:12,000
things as Andrew just pointed out cancer

1733
01:00:12,000 --> 01:00:14,220
treatment has been incredibly hard the

1734
01:00:14,220 --> 01:00:16,140
last three years because my sister is a

1735
01:00:16,140 --> 01:00:18,059
cancer specialist she's had great

1736
01:00:18,059 --> 01:00:19,799
trouble even seeing patients let alone

1737
01:00:19,799 --> 01:00:21,540
treating them

1738
01:00:21,540 --> 01:00:26,700
so it's been really really difficult

1739
01:00:26,700 --> 01:00:28,740
um if you want you can dedicate this to

1740
01:00:28,740 --> 01:00:31,200
the recent Royal loss if you want you

1741
01:00:31,200 --> 01:00:34,079
dedicate it to someone that you know or

1742
01:00:34,079 --> 01:00:35,160
new

1743
01:00:35,160 --> 01:00:37,920
but here is a toast to absent friends at

1744
01:00:37,920 --> 01:00:40,579
44con

1745
01:00:47,520 --> 01:00:49,740
and with that

1746
01:00:49,740 --> 01:00:53,000
food is outside

