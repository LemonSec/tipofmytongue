1
00:00:00,000 --> 00:00:06,660
morning everyone thank you everyone for

2
00:00:02,460 --> 00:00:08,910
turning up if you're sober conscious

3
00:00:06,660 --> 00:00:10,650
awake or all three thank you very much

4
00:00:08,910 --> 00:00:14,160
for coming see our talk so you want to

5
00:00:10,650 --> 00:00:17,220
read team my name is Lawrence Munroe

6
00:00:14,160 --> 00:00:18,930
I'm the worldwide VP for spine labs so I

7
00:00:17,220 --> 00:00:21,538
oversee their pen testing and red

8
00:00:18,930 --> 00:00:24,539
teaming within the company I'm also a

9
00:00:21,539 --> 00:00:26,130
post-grad Oxford at the moment I look at

10
00:00:24,539 --> 00:00:29,250
things like red team tactics and all

11
00:00:26,130 --> 00:00:31,399
kinds of silly things like that I used

12
00:00:29,250 --> 00:00:34,950
to be a pen tester and a blue team er

13
00:00:31,399 --> 00:00:36,660
well a bit of blue teaming I really like

14
00:00:34,950 --> 00:00:40,379
their strategy elements of those types

15
00:00:36,660 --> 00:00:42,540
of things I'm also speaking quite a lot

16
00:00:40,379 --> 00:00:46,199
at the moment so I spoke at blackhat us

17
00:00:42,540 --> 00:00:48,059
this year which was really cool I also

18
00:00:46,200 --> 00:00:50,399
used to direct besides London which used

19
00:00:48,059 --> 00:00:54,000
to be here so it's really nice to speak

20
00:00:50,399 --> 00:00:56,250
in the same building and I'm also on the

21
00:00:54,000 --> 00:00:59,219
crest executive but don't hold that

22
00:00:56,250 --> 00:01:00,719
against me and you can tweet me if you

23
00:00:59,219 --> 00:01:03,030
want a message about the talk or

24
00:01:00,719 --> 00:01:04,559
anything else on the address above I'll

25
00:01:03,030 --> 00:01:08,970
just hand over to Matt who's going to be

26
00:01:04,559 --> 00:01:10,530
doing talk with me good morning everyone

27
00:01:08,970 --> 00:01:12,840
so my name is Matt Lorenzen I'm a

28
00:01:10,530 --> 00:01:16,140
principal security consultant at spider

29
00:01:12,840 --> 00:01:18,570
labs so I'm sassy see you know CCTV of

30
00:01:16,140 --> 00:01:21,240
course requests badges I've set on a few

31
00:01:18,570 --> 00:01:24,508
data center floors in my time so I'm a

32
00:01:21,240 --> 00:01:25,710
jobbing pen tester my focus in the last

33
00:01:24,509 --> 00:01:27,500
couple of years he's been around red

34
00:01:25,710 --> 00:01:30,720
teaming and purple teaming in particular

35
00:01:27,500 --> 00:01:32,490
and before I sort of came into the

36
00:01:30,720 --> 00:01:34,439
industry I used to work for HP before

37
00:01:32,490 --> 00:01:36,360
spider labs and before that I ran my own

38
00:01:34,439 --> 00:01:37,619
consultancy company for seven years so

39
00:01:36,360 --> 00:01:39,270
I've got a bit of an interest in

40
00:01:37,619 --> 00:01:42,869
business as well and that's my twitter

41
00:01:39,270 --> 00:01:44,880
handle a balm cool so today we're going

42
00:01:42,869 --> 00:01:47,610
to be talking about the differences

43
00:01:44,880 --> 00:01:50,250
between red teaming and pen testing that

44
00:01:47,610 --> 00:01:51,299
do exist thoughts on how to get head so

45
00:01:50,250 --> 00:01:53,610
we're going to talk a little bit about

46
00:01:51,299 --> 00:01:55,740
how you can break into doing red teaming

47
00:01:53,610 --> 00:01:57,840
from being a pen tester or how you can

48
00:01:55,740 --> 00:01:59,339
get better and improve and enhance your

49
00:01:57,840 --> 00:02:01,710
skills if you're an existing red teamer

50
00:01:59,340 --> 00:02:03,869
we're going to talk a bit about closing

51
00:02:01,710 --> 00:02:05,729
skills gaps and also Matt's going to

52
00:02:03,869 --> 00:02:07,290
present a new framework that he's got

53
00:02:05,729 --> 00:02:09,959
called project lab seed which helps

54
00:02:07,290 --> 00:02:12,780
people get labs built quicker and adds

55
00:02:09,959 --> 00:02:13,890
lots of new new functionality to

56
00:02:12,780 --> 00:02:15,569
building labs and

57
00:02:13,890 --> 00:02:18,119
running labs that helps you get better

58
00:02:15,569 --> 00:02:19,140
at things like red teaming and then

59
00:02:18,120 --> 00:02:21,380
we're just going to summarize the whole

60
00:02:19,140 --> 00:02:25,079
thing and hopefully it'll be interesting

61
00:02:21,380 --> 00:02:28,319
so from my perspective the difference

62
00:02:25,080 --> 00:02:30,360
between a red teamer and pentester if

63
00:02:28,319 --> 00:02:34,708
I'm taking the business perspective is

64
00:02:30,360 --> 00:02:36,390
is is about 50k in honesty but in terms

65
00:02:34,709 --> 00:02:37,980
of the way that people operate there's

66
00:02:36,390 --> 00:02:40,410
definitely a maturity and an

67
00:02:37,980 --> 00:02:41,820
understanding of organizations and

68
00:02:40,410 --> 00:02:44,280
enterprise security that kind of

69
00:02:41,820 --> 00:02:46,530
underpins this so it's really important

70
00:02:44,280 --> 00:02:48,540
to bear that in mind that before you

71
00:02:46,530 --> 00:02:50,400
approach doing red teaming these types

72
00:02:48,540 --> 00:02:52,440
of things and delivering these types of

73
00:02:50,400 --> 00:02:55,500
services for organizations like

74
00:02:52,440 --> 00:02:57,570
pentesting firms that kind of stuff you

75
00:02:55,500 --> 00:02:59,400
need to think about your how

76
00:02:57,570 --> 00:03:01,049
well-rounded you are how consultative

77
00:02:59,400 --> 00:03:02,160
you are and sharing that kind of

78
00:03:01,050 --> 00:03:03,870
knowledge and you're understanding

79
00:03:02,160 --> 00:03:05,549
things like Blue Team so that's really

80
00:03:03,870 --> 00:03:07,980
where I'm coming from from a lot of the

81
00:03:05,550 --> 00:03:09,720
points that I'm making in terms of the

82
00:03:07,980 --> 00:03:11,579
differences between red teaming and

83
00:03:09,720 --> 00:03:13,109
pentesting there's also technical

84
00:03:11,580 --> 00:03:15,090
differences in how they're delivered and

85
00:03:13,110 --> 00:03:16,320
the concepts behind them but essentially

86
00:03:15,090 --> 00:03:19,530
that's kind of where I'm coming from

87
00:03:16,320 --> 00:03:21,690
from my perspective and I'm very much

88
00:03:19,530 --> 00:03:23,160
coming from the eyes on the screen hands

89
00:03:21,690 --> 00:03:24,480
on the keyboard perspective trying to

90
00:03:23,160 --> 00:03:26,579
keep up with this raft of new

91
00:03:24,480 --> 00:03:29,220
information that that's constantly

92
00:03:26,579 --> 00:03:30,870
changing trying to stay relevant looking

93
00:03:29,220 --> 00:03:33,000
at what was working yesterday and is no

94
00:03:30,870 --> 00:03:37,230
longer working today and trying to just

95
00:03:33,000 --> 00:03:40,739
sort of stay on that edge really sorry

96
00:03:37,230 --> 00:03:43,018
about all the swapping so really when

97
00:03:40,739 --> 00:03:44,670
you look at the different different kind

98
00:03:43,019 --> 00:03:47,010
of mindsets you have when you start out

99
00:03:44,670 --> 00:03:49,109
doing pen testing there's really a kind

100
00:03:47,010 --> 00:03:51,570
of continuum of your understanding of of

101
00:03:49,110 --> 00:03:53,549
how things go and and when you start out

102
00:03:51,570 --> 00:03:55,200
you look at things tools like necess so

103
00:03:53,549 --> 00:03:57,750
necessary for you you'll get the win

104
00:03:55,200 --> 00:04:00,420
you'll get shell you'll maybe use a bit

105
00:03:57,750 --> 00:04:02,070
of Metasploit something like that and

106
00:04:00,420 --> 00:04:04,679
then you'll start automating things to

107
00:04:02,070 --> 00:04:06,420
get quicker it's not so necessarily the

108
00:04:04,680 --> 00:04:07,890
most eloquent solution but you're

109
00:04:06,420 --> 00:04:09,328
getting things done quickly you're

110
00:04:07,890 --> 00:04:11,640
sticking it all in it all the loot in a

111
00:04:09,329 --> 00:04:15,120
database and moving forwards and as you

112
00:04:11,640 --> 00:04:17,519
progress along the continuum of woke you

113
00:04:15,120 --> 00:04:19,649
become more aware of the different

114
00:04:17,519 --> 00:04:22,169
things it requires to simulate hackers

115
00:04:19,649 --> 00:04:23,340
simulate attackers and get better at

116
00:04:22,169 --> 00:04:26,190
what you're what you're doing in your

117
00:04:23,340 --> 00:04:28,270
tradecraft essentially there's a very

118
00:04:26,190 --> 00:04:30,789
kind of windows focus for

119
00:04:28,270 --> 00:04:32,318
kind of perspective because windows if

120
00:04:30,789 --> 00:04:34,090
you look in an enterprise environment is

121
00:04:32,319 --> 00:04:36,280
pretty much what you see and what you

122
00:04:34,090 --> 00:04:38,080
want to be proficient at not that the

123
00:04:36,280 --> 00:04:40,330
other world doesn't exist but it is very

124
00:04:38,080 --> 00:04:42,128
important so looking at technologies

125
00:04:40,330 --> 00:04:44,530
like PowerShell and using PowerShell

126
00:04:42,129 --> 00:04:47,590
then becomes comes on your radar and you

127
00:04:44,530 --> 00:04:50,289
get more you realize that there's tools

128
00:04:47,590 --> 00:04:51,909
like power sploit and Empire PowerShell

129
00:04:50,289 --> 00:04:53,169
that are going to help you get the the

130
00:04:51,909 --> 00:04:55,479
things that you want in order to get

131
00:04:53,169 --> 00:04:58,120
domain admin in pentesting those types

132
00:04:55,479 --> 00:05:00,729
of things and moving forwards and then a

133
00:04:58,120 --> 00:05:02,409
bit on the kind of inclusive battlefront

134
00:05:00,729 --> 00:05:04,659
where you have the kind of red versus

135
00:05:02,409 --> 00:05:07,629
blue and the continuation of that things

136
00:05:04,659 --> 00:05:10,419
like PowerShell obfuscate or invoke

137
00:05:07,629 --> 00:05:13,629
obfuscate that Daniel Bohannon created

138
00:05:10,419 --> 00:05:16,930
in order to look at the different ways

139
00:05:13,629 --> 00:05:18,699
that you can log PowerShell and how blue

140
00:05:16,930 --> 00:05:21,189
teams are actually logging that and how

141
00:05:18,699 --> 00:05:23,770
defensive arts are progressing so

142
00:05:21,189 --> 00:05:26,020
obviously you have a kind of back and

143
00:05:23,770 --> 00:05:28,270
forth between offensive and defensive as

144
00:05:26,020 --> 00:05:30,609
people learn and they're moving forwards

145
00:05:28,270 --> 00:05:32,770
things like low beam and low pass guy

146
00:05:30,610 --> 00:05:34,629
called oddvar Mo's has done a lot of

147
00:05:32,770 --> 00:05:37,448
really good work you can find it on his

148
00:05:34,629 --> 00:05:39,610
github around low beam so it's stands

149
00:05:37,449 --> 00:05:40,740
for living off the land binaries so

150
00:05:39,610 --> 00:05:43,270
these are looking at all the different

151
00:05:40,740 --> 00:05:45,039
mini applications that you have in

152
00:05:43,270 --> 00:05:48,400
society - and in Windows operating

153
00:05:45,039 --> 00:05:51,969
systems in order to move forwards and

154
00:05:48,400 --> 00:05:53,739
kind of use native applications to get

155
00:05:51,969 --> 00:05:55,539
where you want and there's less likely

156
00:05:53,740 --> 00:05:57,879
to get caught by AV and other

157
00:05:55,539 --> 00:06:00,759
technologies EDR stuff like that to stop

158
00:05:57,879 --> 00:06:04,180
you and then as you get towards things

159
00:06:00,759 --> 00:06:06,009
like rats and implant frameworks as well

160
00:06:04,180 --> 00:06:08,409
as you become more proficient you'll

161
00:06:06,009 --> 00:06:11,139
start looking at things like dos pack by

162
00:06:08,409 --> 00:06:13,629
harm joy which was released recently as

163
00:06:11,139 --> 00:06:16,180
a c-sharp framework for exploiting

164
00:06:13,629 --> 00:06:18,279
hosts and doing post exploitation tasks

165
00:06:16,180 --> 00:06:22,240
on Windows hosts and also things like

166
00:06:18,279 --> 00:06:24,250
interacting with Windows API such as WMI

167
00:06:22,240 --> 00:06:26,169
decom objects all that kind of good

168
00:06:24,250 --> 00:06:27,729
stuff and the kind of concept moving

169
00:06:26,169 --> 00:06:30,310
towards the concept of living off the

170
00:06:27,729 --> 00:06:31,628
land arguably living off the lands kind

171
00:06:30,310 --> 00:06:34,900
of been around a long time and people

172
00:06:31,629 --> 00:06:37,180
have been using small things like doing

173
00:06:34,900 --> 00:06:37,568
breakouts on on hosts and things like

174
00:06:37,180 --> 00:06:40,209
that

175
00:06:37,569 --> 00:06:40,960
even going back to things like wicked

176
00:06:40,209 --> 00:06:42,759
clowns

177
00:06:40,960 --> 00:06:45,940
talks that used to do really cool talks

178
00:06:42,759 --> 00:06:48,069
on popping up calculator and getting

179
00:06:45,940 --> 00:06:50,050
running vbscript soft desktops and

180
00:06:48,069 --> 00:06:54,550
things like that so it harks back quite

181
00:06:50,050 --> 00:06:56,050
a bit and it's not new so how do you

182
00:06:54,550 --> 00:06:58,599
know where to go one of the problems

183
00:06:56,050 --> 00:07:00,669
with working as a pen tester in an

184
00:06:58,599 --> 00:07:03,520
organization is that the red team can

185
00:07:00,669 --> 00:07:04,448
often be siloed off and there'll be

186
00:07:03,520 --> 00:07:06,490
people that you won't necessarily

187
00:07:04,449 --> 00:07:08,680
interact with and speak to so how do you

188
00:07:06,490 --> 00:07:11,020
get the skillsets to improve and to

189
00:07:08,680 --> 00:07:13,030
actually get better it can often be very

190
00:07:11,020 --> 00:07:15,789
hard so just thinking about how you

191
00:07:13,030 --> 00:07:17,789
actually progress can can be quite

192
00:07:15,789 --> 00:07:20,080
difficult there's often a glass ceiling

193
00:07:17,789 --> 00:07:21,400
you don't know where to learn and

194
00:07:20,080 --> 00:07:23,020
there's all these kinds of challenges

195
00:07:21,400 --> 00:07:24,008
that you need to overcome so hopefully

196
00:07:23,020 --> 00:07:28,060
today well answer some of those

197
00:07:24,009 --> 00:07:30,280
questions and give you some hints so on

198
00:07:28,060 --> 00:07:33,699
this slide I've basically compiled a lot

199
00:07:30,280 --> 00:07:35,440
of the people that myself Matt and find

200
00:07:33,699 --> 00:07:38,050
really interesting on Twitter they

201
00:07:35,440 --> 00:07:40,719
provide lots of information the way that

202
00:07:38,050 --> 00:07:42,069
I've split it is red and blue so down

203
00:07:40,720 --> 00:07:44,560
the center you've got a few folks that

204
00:07:42,069 --> 00:07:47,289
kind of span these two worlds in and do

205
00:07:44,560 --> 00:07:50,560
really well at doing that guys like Matt

206
00:07:47,289 --> 00:07:52,599
Graber migrators really well-known he

207
00:07:50,560 --> 00:07:54,580
kind of tweets a lot about philosophies

208
00:07:52,599 --> 00:07:57,039
but also really deep technical stuff

209
00:07:54,580 --> 00:07:59,948
he's one of the first guys who disclosed

210
00:07:57,039 --> 00:08:02,620
an ansi bypass as well so really good

211
00:07:59,949 --> 00:08:06,370
stuff comes out of out of his mouth and

212
00:08:02,620 --> 00:08:09,190
his Twitter Oh Jay Reeves someone who

213
00:08:06,370 --> 00:08:11,590
runs a really good twitch channel TV

214
00:08:09,190 --> 00:08:13,810
channel as well the cut as the colonial

215
00:08:11,590 --> 00:08:15,429
so a lot of his stuff is really

216
00:08:13,810 --> 00:08:17,050
interesting he talks a lot about reverse

217
00:08:15,430 --> 00:08:19,599
engineering does really great

218
00:08:17,050 --> 00:08:21,580
walkthroughs he's based in Australia so

219
00:08:19,599 --> 00:08:24,039
you sometimes have to be up a bit late

220
00:08:21,580 --> 00:08:26,590
to catch them but his videos are really

221
00:08:24,039 --> 00:08:29,080
great also Casey Smith and will talk a

222
00:08:26,590 --> 00:08:31,750
bit about Casey and his contributions to

223
00:08:29,080 --> 00:08:34,419
mightier attack matrix and those types

224
00:08:31,750 --> 00:08:36,399
of things miters also up there I'll talk

225
00:08:34,419 --> 00:08:38,978
about a bit about that in a while as

226
00:08:36,399 --> 00:08:42,309
well but Casey makes great contributions

227
00:08:38,979 --> 00:08:44,829
to that and also the atomic red team

228
00:08:42,309 --> 00:08:46,329
framework as well hopefully that's

229
00:08:44,829 --> 00:08:47,739
useful we'll be sharing the slides at

230
00:08:46,329 --> 00:08:50,529
the end if you want any references

231
00:08:47,740 --> 00:08:52,180
obviously this is an exhaustive list and

232
00:08:50,529 --> 00:08:53,510
we're not endorsing these people but

233
00:08:52,180 --> 00:08:56,089
they are really great and they

234
00:08:53,510 --> 00:08:59,720
tons of content so thanks and props to

235
00:08:56,090 --> 00:09:02,240
these guys so thinking about something I

236
00:08:59,720 --> 00:09:03,710
mentioned earlier with tool sets is the

237
00:09:02,240 --> 00:09:05,810
tool sets that you use for red teaming

238
00:09:03,710 --> 00:09:08,150
are different or you use the tools same

239
00:09:05,810 --> 00:09:09,709
tools in a different way so we're not in

240
00:09:08,150 --> 00:09:11,449
this talk just going to list off lots

241
00:09:09,710 --> 00:09:14,030
and lots of different slicer

242
00:09:11,450 --> 00:09:15,830
lots and lots of different tools but we

243
00:09:14,030 --> 00:09:17,510
will reference some and talk a little

244
00:09:15,830 --> 00:09:19,340
bit about the differences in using them

245
00:09:17,510 --> 00:09:21,319
for example you use their map in a very

246
00:09:19,340 --> 00:09:22,820
different way using proxy chaining and

247
00:09:21,320 --> 00:09:24,950
things like that on a red team whereas

248
00:09:22,820 --> 00:09:27,410
you might just spray everything in a pen

249
00:09:24,950 --> 00:09:29,540
test tools like bloodhound for example

250
00:09:27,410 --> 00:09:31,219
very noisy you would you'd use it on a

251
00:09:29,540 --> 00:09:33,319
pen test but not necessarily on a red

252
00:09:31,220 --> 00:09:35,120
team so actually understanding your

253
00:09:33,320 --> 00:09:36,770
tools to the depth that you will

254
00:09:35,120 --> 00:09:40,400
understand the different detections that

255
00:09:36,770 --> 00:09:41,960
will be available to for those tools and

256
00:09:40,400 --> 00:09:45,470
all those different things in terms of

257
00:09:41,960 --> 00:09:48,980
stealth goals and goal objectives high

258
00:09:45,470 --> 00:09:51,290
level goal objectives as well also this

259
00:09:48,980 --> 00:09:52,880
introduces a concept of rats and implant

260
00:09:51,290 --> 00:09:53,959
frameworks as well so if you're not

261
00:09:52,880 --> 00:09:55,340
familiar with rats and implant

262
00:09:53,960 --> 00:09:58,400
frameworks they're essentially tools

263
00:09:55,340 --> 00:10:00,380
that replicate more advanced malware

264
00:09:58,400 --> 00:10:02,390
behaviors so things like you've probably

265
00:10:00,380 --> 00:10:05,510
heard of cobalt strike and things like

266
00:10:02,390 --> 00:10:07,460
that there's also lots of open source

267
00:10:05,510 --> 00:10:09,830
ones available things like posh situ

268
00:10:07,460 --> 00:10:12,980
that was developed by Dave Hardy and Ben

269
00:10:09,830 --> 00:10:15,980
Turner Merlin and tons that seem to be

270
00:10:12,980 --> 00:10:21,890
popping up in golang golang or go home

271
00:10:15,980 --> 00:10:25,160
seems to be the theme at the moment well

272
00:10:21,890 --> 00:10:27,410
do t-shirts later and then also thinking

273
00:10:25,160 --> 00:10:29,209
about the red team in in terms of the

274
00:10:27,410 --> 00:10:31,310
strategy so it's often very goal

275
00:10:29,210 --> 00:10:32,480
orientated so you'll think very high

276
00:10:31,310 --> 00:10:35,109
level about the goals and the objectives

277
00:10:32,480 --> 00:10:38,060
that you want to achieve and then

278
00:10:35,110 --> 00:10:39,800
contact contextualize that around the

279
00:10:38,060 --> 00:10:40,969
different types of skill sets that you

280
00:10:39,800 --> 00:10:42,800
have and the way that you're going to

281
00:10:40,970 --> 00:10:45,680
approach it very different to a pen test

282
00:10:42,800 --> 00:10:48,459
which is obviously a subset of scope and

283
00:10:45,680 --> 00:10:50,870
a subset of activities that you'll do

284
00:10:48,460 --> 00:10:52,400
there's also things like stealth and

285
00:10:50,870 --> 00:10:53,990
data exfiltration that you probably

286
00:10:52,400 --> 00:10:55,699
won't have considered before if you're

287
00:10:53,990 --> 00:10:58,190
moving across from one discipline to

288
00:10:55,700 --> 00:11:00,440
another so stealth very important all

289
00:10:58,190 --> 00:11:02,390
the way from having things like AWS

290
00:11:00,440 --> 00:11:04,840
redirect as in front of your attack

291
00:11:02,390 --> 00:11:06,680
infrastructure based on the web to

292
00:11:04,840 --> 00:11:07,250
different types of things that you're

293
00:11:06,680 --> 00:11:09,079
going to do

294
00:11:07,250 --> 00:11:11,000
when you're you're scanning networks or

295
00:11:09,080 --> 00:11:12,920
reconning hosts you need to be much more

296
00:11:11,000 --> 00:11:16,610
pinpoint and the whole kind of concept

297
00:11:12,920 --> 00:11:18,890
with when you're red teaming is you

298
00:11:16,610 --> 00:11:20,690
you can't start noisy if you start noisy

299
00:11:18,890 --> 00:11:23,030
you're gonna get detected and it's kind

300
00:11:20,690 --> 00:11:24,650
of game over to some extent but what

301
00:11:23,030 --> 00:11:26,689
will happen is you need to start very

302
00:11:24,650 --> 00:11:28,730
quiet and kind of ramp it up as you need

303
00:11:26,690 --> 00:11:30,050
to get a bit more automated in what

304
00:11:28,730 --> 00:11:33,980
you're doing but typically you'll be

305
00:11:30,050 --> 00:11:35,420
very pinpoint in what you do so

306
00:11:33,980 --> 00:11:37,160
something that I started about a year

307
00:11:35,420 --> 00:11:38,750
ago that was very useful for me and I

308
00:11:37,160 --> 00:11:41,420
talked a lot about internally with the

309
00:11:38,750 --> 00:11:43,340
with the red team's is what I'd call

310
00:11:41,420 --> 00:11:45,319
Blue Monday so every Monday I spend

311
00:11:43,340 --> 00:11:48,500
about an hour looking at a blue team

312
00:11:45,320 --> 00:11:50,750
stuff because historically for myself

313
00:11:48,500 --> 00:11:53,770
I've always been on the offensive side

314
00:11:50,750 --> 00:11:59,000
of things personally and in my career

315
00:11:53,770 --> 00:12:00,980
and the blue team elements are something

316
00:11:59,000 --> 00:12:03,290
that I think is very important so a lot

317
00:12:00,980 --> 00:12:04,730
of the time people get lazy is probably

318
00:12:03,290 --> 00:12:06,560
not the right word but they feel that

319
00:12:04,730 --> 00:12:08,210
this world is separate and it doesn't

320
00:12:06,560 --> 00:12:10,819
really matter and it doesn't inform what

321
00:12:08,210 --> 00:12:12,380
they do as red teamers but I think it's

322
00:12:10,820 --> 00:12:15,470
very much on the contrary and being

323
00:12:12,380 --> 00:12:17,720
purple is something that everyone should

324
00:12:15,470 --> 00:12:20,120
do and think about if you take it from

325
00:12:17,720 --> 00:12:21,980
this perspective that someone maybe you

326
00:12:20,120 --> 00:12:23,300
reverse the roles and say okay well a

327
00:12:21,980 --> 00:12:26,839
blue team is going to come in and

328
00:12:23,300 --> 00:12:28,099
observe my observe my testing and then

329
00:12:26,839 --> 00:12:29,780
from their perspective we've no

330
00:12:28,100 --> 00:12:31,880
knowledge of what I'm doing tell me

331
00:12:29,780 --> 00:12:33,650
where I'm going wrong when you flip that

332
00:12:31,880 --> 00:12:35,689
on its head it's it's quite an odd

333
00:12:33,650 --> 00:12:37,959
situation that you would have so not

334
00:12:35,690 --> 00:12:40,730
understanding things like I our P's

335
00:12:37,960 --> 00:12:42,380
Incident Response playbooks all that

336
00:12:40,730 --> 00:12:44,690
kind of stuff is really important to

337
00:12:42,380 --> 00:12:46,250
understand how enterprises defend from a

338
00:12:44,690 --> 00:12:48,589
tactical perspective and getting your

339
00:12:46,250 --> 00:12:49,880
TTP's in order but also from the

340
00:12:48,589 --> 00:12:52,040
perspective of you've got to give these

341
00:12:49,880 --> 00:12:53,839
advice these guys advice afterwards and

342
00:12:52,040 --> 00:12:55,339
if you don't understand what it is and

343
00:12:53,839 --> 00:12:58,460
how they operate then that's really

344
00:12:55,339 --> 00:13:00,200
going to be a struggle also the the

345
00:12:58,460 --> 00:13:02,150
goals of a red team are different a lot

346
00:13:00,200 --> 00:13:04,310
of people think how red teaming is about

347
00:13:02,150 --> 00:13:06,920
getting in it's about penetration it's

348
00:13:04,310 --> 00:13:08,689
about exploiting and polling I don't

349
00:13:06,920 --> 00:13:10,459
think it is it's about detection

350
00:13:08,690 --> 00:13:12,920
it's about response and it's about

351
00:13:10,460 --> 00:13:15,020
recovery and testing those mechanisms to

352
00:13:12,920 --> 00:13:17,750
make sure that they're effective a lot

353
00:13:15,020 --> 00:13:19,880
of people I think don't get into

354
00:13:17,750 --> 00:13:20,440
security on or do get into security for

355
00:13:19,880 --> 00:13:22,360
the right reason

356
00:13:20,440 --> 00:13:24,970
they want to improve the state of

357
00:13:22,360 --> 00:13:27,580
security but I think that sometimes gets

358
00:13:24,970 --> 00:13:29,700
a bit lost they get stuck in a routine

359
00:13:27,580 --> 00:13:31,930
of wanting to win all the time and

360
00:13:29,700 --> 00:13:34,480
winning is is less important than

361
00:13:31,930 --> 00:13:36,400
improving the state of security so being

362
00:13:34,480 --> 00:13:38,560
consultative and knowing these types of

363
00:13:36,400 --> 00:13:40,329
things and helping out is a very kind of

364
00:13:38,560 --> 00:13:43,270
strong belief of mine of what people

365
00:13:40,330 --> 00:13:45,400
should do also learning things like

366
00:13:43,270 --> 00:13:47,410
mitre attacked matrix so my to attack

367
00:13:45,400 --> 00:13:48,939
matrix is have been a very useful thing

368
00:13:47,410 --> 00:13:52,209
that's kind of appeared over the last

369
00:13:48,940 --> 00:13:55,390
couple of years so mitre attack matrix

370
00:13:52,210 --> 00:13:58,960
is essentially a grid with lots of

371
00:13:55,390 --> 00:14:02,860
different techniques that you can do so

372
00:13:58,960 --> 00:14:05,230
exploit root rather sorry not exploit

373
00:14:02,860 --> 00:14:07,420
roots but attack chains that you can

374
00:14:05,230 --> 00:14:09,250
perform against an organization and it's

375
00:14:07,420 --> 00:14:11,020
almost like an audit function so for

376
00:14:09,250 --> 00:14:12,940
organizations who do these types of

377
00:14:11,020 --> 00:14:14,590
things there's also atomic red team that

378
00:14:12,940 --> 00:14:16,870
sits alongside that that was developed

379
00:14:14,590 --> 00:14:19,300
by red canary and Casey Smith in in

380
00:14:16,870 --> 00:14:21,220
particular how this is really useful for

381
00:14:19,300 --> 00:14:22,930
you guys or people looking to do red

382
00:14:21,220 --> 00:14:25,060
teaming is where you audit an

383
00:14:22,930 --> 00:14:26,739
organization and you look at the the

384
00:14:25,060 --> 00:14:28,599
different paths and the tact eanes that

385
00:14:26,740 --> 00:14:30,610
you can actually get and your defenses

386
00:14:28,600 --> 00:14:32,500
against them you can also do that with

387
00:14:30,610 --> 00:14:34,270
your skill sets so if you're looking at

388
00:14:32,500 --> 00:14:35,590
my to attack matrix and you're saying I

389
00:14:34,270 --> 00:14:37,120
don't know what that is I don't know

390
00:14:35,590 --> 00:14:38,650
what that is that's probably alarm bells

391
00:14:37,120 --> 00:14:40,330
to some extent not everyone's going to

392
00:14:38,650 --> 00:14:42,160
know everything but if you're very

393
00:14:40,330 --> 00:14:43,630
proactive in developing your skills and

394
00:14:42,160 --> 00:14:45,219
what you want to do looking at this

395
00:14:43,630 --> 00:14:46,420
gives you a good reference as to the

396
00:14:45,220 --> 00:14:48,520
types of things that you want to be

397
00:14:46,420 --> 00:14:50,530
doing on engagements and how you can up

398
00:14:48,520 --> 00:14:54,520
skill to get there so I think that's a

399
00:14:50,530 --> 00:14:56,319
very important message so one of the

400
00:14:54,520 --> 00:14:57,790
things is that I found especially with

401
00:14:56,320 --> 00:14:59,260
technical people and especially with red

402
00:14:57,790 --> 00:15:01,810
teamers is there's there's kind of

403
00:14:59,260 --> 00:15:04,030
disregard for threat intelligence and

404
00:15:01,810 --> 00:15:05,739
the venn of snake oil kind of in

405
00:15:04,030 --> 00:15:07,720
illustrates that a little bit or some of

406
00:15:05,740 --> 00:15:11,470
the the things that you can do to

407
00:15:07,720 --> 00:15:12,940
actually get value from it because I

408
00:15:11,470 --> 00:15:14,800
think if you're using threat

409
00:15:12,940 --> 00:15:17,410
intelligence in a certain way to inform

410
00:15:14,800 --> 00:15:18,849
scenarios of how you're going to to

411
00:15:17,410 --> 00:15:20,439
actually do the attacks I think that

412
00:15:18,850 --> 00:15:22,540
they can sometimes be a very limited

413
00:15:20,440 --> 00:15:24,400
value in that but if you're taking it

414
00:15:22,540 --> 00:15:25,510
from the perspective of being an

415
00:15:24,400 --> 00:15:27,490
attacker and someone who wants to

416
00:15:25,510 --> 00:15:29,020
replicate these types of things I think

417
00:15:27,490 --> 00:15:30,670
it informs different techniques

418
00:15:29,020 --> 00:15:33,400
different mindsets and different ways to

419
00:15:30,670 --> 00:15:34,219
do it some of them will be relevant some

420
00:15:33,400 --> 00:15:35,810
of them won't be so

421
00:15:34,220 --> 00:15:37,010
elephant where you have insider threats

422
00:15:35,810 --> 00:15:39,199
and things like that that you can't

423
00:15:37,010 --> 00:15:40,939
leverage in your own everyday lives but

424
00:15:39,200 --> 00:15:43,550
a lot of it looking at malware and all

425
00:15:40,940 --> 00:15:45,020
those kinds of intelligence elements

426
00:15:43,550 --> 00:15:48,469
that you can bring into it are really

427
00:15:45,020 --> 00:15:50,510
important so on the Venn diagram that I

428
00:15:48,470 --> 00:15:53,780
put up on the board I think it's it's

429
00:15:50,510 --> 00:15:55,250
important to think about disregard so if

430
00:15:53,780 --> 00:15:56,660
you take threat intelligence as a

431
00:15:55,250 --> 00:15:58,880
concept and say these are all the things

432
00:15:56,660 --> 00:16:01,610
that have happened and they might happen

433
00:15:58,880 --> 00:16:03,439
to my organization so I need to be ready

434
00:16:01,610 --> 00:16:05,000
for these types of things it really

435
00:16:03,440 --> 00:16:07,070
boils down to they're only being what's

436
00:16:05,000 --> 00:16:09,410
technically possible what you can do and

437
00:16:07,070 --> 00:16:11,540
how long you've got so a lot of the time

438
00:16:09,410 --> 00:16:13,370
the TI doesn't even matter but from a

439
00:16:11,540 --> 00:16:15,560
personal perspective and a kind of more

440
00:16:13,370 --> 00:16:17,750
broad perspective you can contextualize

441
00:16:15,560 --> 00:16:19,670
that and use it in a different way than

442
00:16:17,750 --> 00:16:21,560
perhaps is intended or it's being used

443
00:16:19,670 --> 00:16:24,380
by things like frameworks like Sivir

444
00:16:21,560 --> 00:16:25,819
stiva star all those kinds of things so

445
00:16:24,380 --> 00:16:30,320
there are limitations but I think there

446
00:16:25,820 --> 00:16:32,030
are also benefits as well so I think

447
00:16:30,320 --> 00:16:35,150
getting into a team as well it shouldn't

448
00:16:32,030 --> 00:16:37,100
be magic I always laugh at this one it

449
00:16:35,150 --> 00:16:40,370
shouldn't be magic getting into a red

450
00:16:37,100 --> 00:16:41,540
team you know it should be more easy and

451
00:16:40,370 --> 00:16:44,300
it should be easier to develop your

452
00:16:41,540 --> 00:16:45,740
skills so I think oh the thing I was

453
00:16:44,300 --> 00:16:47,510
tell people who are kind of coming up

454
00:16:45,740 --> 00:16:50,150
through the ranks is be a jack of all

455
00:16:47,510 --> 00:16:52,910
trades and a master of some so have a

456
00:16:50,150 --> 00:16:54,620
broad background but then get really

457
00:16:52,910 --> 00:16:57,140
technical at certain areas and have

458
00:16:54,620 --> 00:16:59,450
certain strengths also don't neglect

459
00:16:57,140 --> 00:17:01,040
your apt gain so if you look at all the

460
00:16:59,450 --> 00:17:02,900
attacks that happen you can see that

461
00:17:01,040 --> 00:17:05,389
quite often it's through application

462
00:17:02,900 --> 00:17:07,460
vectors that people get owned or lose

463
00:17:05,390 --> 00:17:08,900
their data and I think quite a lot of

464
00:17:07,460 --> 00:17:11,120
the time red team is kind of get

465
00:17:08,900 --> 00:17:13,520
obsessed to some extent with executing

466
00:17:11,119 --> 00:17:16,459
the kill chain so gaining persistence on

467
00:17:13,520 --> 00:17:18,349
hosts pivoting you know moving through

468
00:17:16,460 --> 00:17:20,420
networks all that stuff is noisy if

469
00:17:18,349 --> 00:17:22,520
you're just looking at a database that's

470
00:17:20,420 --> 00:17:24,800
on the back end of an app just look for

471
00:17:22,520 --> 00:17:26,960
sequel injection look for xxe and remote

472
00:17:24,800 --> 00:17:29,330
code execution on the boxes so

473
00:17:26,960 --> 00:17:32,630
definitely app is kind of sexy again and

474
00:17:29,330 --> 00:17:35,330
don't neglect your app game also look at

475
00:17:32,630 --> 00:17:36,440
creating niches so where you're trying

476
00:17:35,330 --> 00:17:38,389
to get into a team within an

477
00:17:36,440 --> 00:17:40,400
organization sometimes you'll feel that

478
00:17:38,390 --> 00:17:41,510
you don't maybe have the profile or the

479
00:17:40,400 --> 00:17:42,920
people in the team don't think you're

480
00:17:41,510 --> 00:17:44,900
good enough to do these kinds of things

481
00:17:42,920 --> 00:17:46,640
so look at the different ways that you

482
00:17:44,900 --> 00:17:47,690
can get in tactically so look at your

483
00:17:46,640 --> 00:17:49,700
the niches

484
00:17:47,690 --> 00:17:51,350
so something I tell to junior people who

485
00:17:49,700 --> 00:17:53,570
who kind of come to me and say I want to

486
00:17:51,350 --> 00:17:55,280
do red teaming say well look at the team

487
00:17:53,570 --> 00:17:57,710
what's the structure are there people

488
00:17:55,280 --> 00:17:59,870
who do Ti for example in the UK there's

489
00:17:57,710 --> 00:18:01,700
a lot of frameworks that require Ti in

490
00:17:59,870 --> 00:18:04,879
order to build things to simulate

491
00:18:01,700 --> 00:18:06,770
attacks who's doing the TI could you be

492
00:18:04,880 --> 00:18:09,380
that guy is that your way in what about

493
00:18:06,770 --> 00:18:10,610
social engineering is vectors there are

494
00:18:09,380 --> 00:18:12,200
other things that you can contribute

495
00:18:10,610 --> 00:18:15,860
that other people can't they're going to

496
00:18:12,200 --> 00:18:18,530
be really helpful also read Lots so

497
00:18:15,860 --> 00:18:20,510
reading is is really important I'm quite

498
00:18:18,530 --> 00:18:22,370
surprised often that I mention things as

499
00:18:20,510 --> 00:18:24,350
someone who doesn't you know hasn't been

500
00:18:22,370 --> 00:18:26,419
on the command line for about six years

501
00:18:24,350 --> 00:18:27,980
when I tell people about new techniques

502
00:18:26,420 --> 00:18:30,170
or new tools and things it's kind of

503
00:18:27,980 --> 00:18:31,970
news to them so coming from me it's cut

504
00:18:30,170 --> 00:18:33,590
you know it's sometimes kind of sad that

505
00:18:31,970 --> 00:18:35,150
they're not reading and staying up to

506
00:18:33,590 --> 00:18:37,010
date I mean there's a lot of things to

507
00:18:35,150 --> 00:18:38,660
process but when you kind of filter it

508
00:18:37,010 --> 00:18:41,270
and get really directed in what you want

509
00:18:38,660 --> 00:18:43,100
to do reading and building labs and

510
00:18:41,270 --> 00:18:44,480
doing these kinds of things really the

511
00:18:43,100 --> 00:18:46,219
ways that you're going to progress and

512
00:18:44,480 --> 00:18:47,450
if you're not progressing it's going to

513
00:18:46,220 --> 00:18:49,280
be apparent to everyone else that you're

514
00:18:47,450 --> 00:18:50,720
kind of stagnating in what you know and

515
00:18:49,280 --> 00:18:52,700
what you do and that's not what you're

516
00:18:50,720 --> 00:18:54,890
looking for that's not what I'm looking

517
00:18:52,700 --> 00:18:56,540
for as someone who builds these teams

518
00:18:54,890 --> 00:18:59,240
and makes effective teams to do these

519
00:18:56,540 --> 00:19:02,180
types of tasks also make your goals

520
00:18:59,240 --> 00:19:04,220
really clear so another kind of pet

521
00:19:02,180 --> 00:19:06,770
peeve of mine is is a lot of people say

522
00:19:04,220 --> 00:19:08,480
oh well I I want to do red teaming but

523
00:19:06,770 --> 00:19:10,430
you haven't helped me I was like well I

524
00:19:08,480 --> 00:19:12,080
didn't know why didn't you tell me you

525
00:19:10,430 --> 00:19:13,640
know make it a parent you should always

526
00:19:12,080 --> 00:19:15,860
talk to your colleagues who do these

527
00:19:13,640 --> 00:19:17,900
kinds of things talk to your bosses talk

528
00:19:15,860 --> 00:19:20,179
to your managers and and make it

529
00:19:17,900 --> 00:19:21,950
apparent because it's not always clear I

530
00:19:20,180 --> 00:19:23,540
think at the moment everyone either is

531
00:19:21,950 --> 00:19:26,990
or wants to be a red teamer in the

532
00:19:23,540 --> 00:19:28,879
pentesting world but so few are so just

533
00:19:26,990 --> 00:19:30,650
make your goals clear and try and look

534
00:19:28,880 --> 00:19:32,810
for mentors within the group who help

535
00:19:30,650 --> 00:19:35,150
and support that kind of approach that

536
00:19:32,810 --> 00:19:37,790
you want to take also networked

537
00:19:35,150 --> 00:19:40,130
externally as well I find so many people

538
00:19:37,790 --> 00:19:41,930
who start developing a tool or a concept

539
00:19:40,130 --> 00:19:42,890
that they think it's really cool I need

540
00:19:41,930 --> 00:19:45,320
to find that someone else has already

541
00:19:42,890 --> 00:19:47,180
done it or something along those lines

542
00:19:45,320 --> 00:19:48,889
but they don't do their research they

543
00:19:47,180 --> 00:19:49,550
don't reach out people are really really

544
00:19:48,890 --> 00:19:51,980
friendly

545
00:19:49,550 --> 00:19:53,330
the guys at Specter ops for example they

546
00:19:51,980 --> 00:19:55,730
help so many people with all these

547
00:19:53,330 --> 00:19:58,040
different projects it's really important

548
00:19:55,730 --> 00:20:01,340
to network because when you move into

549
00:19:58,040 --> 00:20:03,680
your next job people use recommendations

550
00:20:01,340 --> 00:20:05,959
in our industry is still quite small and

551
00:20:03,680 --> 00:20:07,550
in its Genesis in a way so what will

552
00:20:05,960 --> 00:20:08,780
happen is you'll get recommendations if

553
00:20:07,550 --> 00:20:10,370
you interact with people and they

554
00:20:08,780 --> 00:20:12,080
understand your skills and they can see

555
00:20:10,370 --> 00:20:14,570
you've got skills then it can facilitate

556
00:20:12,080 --> 00:20:16,669
in developing your career as well so

557
00:20:14,570 --> 00:20:18,889
talk to people don't be scared just walk

558
00:20:16,670 --> 00:20:21,350
up say hi and talk to people who've got

559
00:20:18,890 --> 00:20:24,500
similar interests you look on github all

560
00:20:21,350 --> 00:20:25,669
those kinds of good things also take the

561
00:20:24,500 --> 00:20:27,530
opportunity to look at niche

562
00:20:25,670 --> 00:20:29,180
technologies so if you're looking at

563
00:20:27,530 --> 00:20:30,530
things like red teaming where do we sell

564
00:20:29,180 --> 00:20:33,110
lots of red teaming words that always

565
00:20:30,530 --> 00:20:35,240
exist financial services if you can get

566
00:20:33,110 --> 00:20:36,080
application experience doing Swift or

567
00:20:35,240 --> 00:20:39,160
things like that

568
00:20:36,080 --> 00:20:42,350
that's going to be really useful for you

569
00:20:39,160 --> 00:20:43,940
so in terms of filling your gaps and and

570
00:20:42,350 --> 00:20:45,169
kind of filling that knowledge something

571
00:20:43,940 --> 00:20:47,570
that Matt's going to be presenting about

572
00:20:45,170 --> 00:20:48,890
and showing you a lot of these different

573
00:20:47,570 --> 00:20:50,389
labs and different ways to make them

574
00:20:48,890 --> 00:20:53,480
realistic in order to develop your

575
00:20:50,390 --> 00:20:55,280
skills and test yourself and generate

576
00:20:53,480 --> 00:20:58,420
random environments that you can do this

577
00:20:55,280 --> 00:21:01,040
in so you can also fill your gaps with

578
00:20:58,420 --> 00:21:03,740
instructor-led training conferences like

579
00:21:01,040 --> 00:21:06,260
44 Khan James foreshores workshop this

580
00:21:03,740 --> 00:21:07,430
week all these kinds of things appear at

581
00:21:06,260 --> 00:21:09,560
all these different conferences

582
00:21:07,430 --> 00:21:12,170
sometimes for free sometimes for a small

583
00:21:09,560 --> 00:21:14,960
cost think about yourself constructively

584
00:21:12,170 --> 00:21:17,750
and build yourself into the kind of

585
00:21:14,960 --> 00:21:18,650
tester person that you want to be and

586
00:21:17,750 --> 00:21:20,360
look for Mentors

587
00:21:18,650 --> 00:21:23,030
you won't find them in your organization

588
00:21:20,360 --> 00:21:24,709
you might find them externally but it's

589
00:21:23,030 --> 00:21:25,790
always worth networking and speaking to

590
00:21:24,710 --> 00:21:26,900
people about these things you'll find

591
00:21:25,790 --> 00:21:28,940
that other people have the same

592
00:21:26,900 --> 00:21:31,940
aspirations and goals and maybe more

593
00:21:28,940 --> 00:21:34,340
experience and finally before I hand

594
00:21:31,940 --> 00:21:39,440
over to Matt don't be a dick like

595
00:21:34,340 --> 00:21:41,330
there's lots of dicks about but maybe

596
00:21:39,440 --> 00:21:46,100
you've got one maybe you are one it's

597
00:21:41,330 --> 00:21:48,199
the a lot of people behave in such a way

598
00:21:46,100 --> 00:21:50,120
it's just you need to play nice with

599
00:21:48,200 --> 00:21:51,710
people you need to be approachable you

600
00:21:50,120 --> 00:21:54,379
need to think about what you're doing

601
00:21:51,710 --> 00:21:56,150
and behave in a professional manner

602
00:21:54,380 --> 00:21:58,970
we do have a subculture within

603
00:21:56,150 --> 00:22:01,940
pentesting communities that is tends to

604
00:21:58,970 --> 00:22:03,830
be anti-authoritarian and you know

605
00:22:01,940 --> 00:22:06,170
occasionally trolling and stuff like

606
00:22:03,830 --> 00:22:08,840
that maybe you fire up some sort of

607
00:22:06,170 --> 00:22:11,180
troll account for a large pentesting

608
00:22:08,840 --> 00:22:12,668
company or whatever you know all these

609
00:22:11,180 --> 00:22:14,590
things

610
00:22:12,669 --> 00:22:16,179
not the right way to behave and we

611
00:22:14,590 --> 00:22:19,600
should think about you know being nice

612
00:22:16,179 --> 00:22:21,490
to each other building people up rather

613
00:22:19,600 --> 00:22:30,129
than tearing them down and how we can do

614
00:22:21,490 --> 00:22:32,049
that so I'll hand over to Matt so

615
00:22:30,129 --> 00:22:35,110
practice makes perfect

616
00:22:32,049 --> 00:22:36,610
that's kind of where we are a lot of my

617
00:22:35,110 --> 00:22:38,529
initial journey into this was sort of

618
00:22:36,610 --> 00:22:41,320
self-directed learning and I think you

619
00:22:38,529 --> 00:22:43,179
need that you need the tenacity to smash

620
00:22:41,320 --> 00:22:45,279
into these brick walls and push through

621
00:22:43,179 --> 00:22:46,629
and things like osep are really good for

622
00:22:45,279 --> 00:22:48,129
that but the problem with that approach

623
00:22:46,629 --> 00:22:49,539
is how do you know whether you're

624
00:22:48,129 --> 00:22:51,309
smashing into the right brick wall you

625
00:22:49,539 --> 00:22:53,499
could be you know completely in the

626
00:22:51,309 --> 00:22:55,389
wrong way so I think a better manner for

627
00:22:53,499 --> 00:22:57,220
this is his perfect practice makes

628
00:22:55,389 --> 00:22:58,840
perfect and not many people look at

629
00:22:57,220 --> 00:23:00,490
their I haven't met many people that

630
00:22:58,840 --> 00:23:02,499
actually really look at their processes

631
00:23:00,490 --> 00:23:04,419
and see where they can gain efficiencies

632
00:23:02,499 --> 00:23:06,159
I would say it's a strength of mine that

633
00:23:04,419 --> 00:23:08,080
I can look at my processes and see where

634
00:23:06,159 --> 00:23:09,850
I can gain efficiencies it's always a

635
00:23:08,080 --> 00:23:11,408
curse because I'm probably my own

636
00:23:09,850 --> 00:23:13,418
harshest critic so I'm really good

637
00:23:11,409 --> 00:23:14,799
finding out what I'm not very good at

638
00:23:13,419 --> 00:23:16,090
and trying to fill those holes but I'm

639
00:23:14,799 --> 00:23:18,610
not actually that good at acknowledging

640
00:23:16,090 --> 00:23:20,350
the things that I I am more successful

641
00:23:18,610 --> 00:23:22,269
in but I followed this room there's a

642
00:23:20,350 --> 00:23:23,740
there's a great quote from Michael

643
00:23:22,269 --> 00:23:25,389
Jordan the American basketball star and

644
00:23:23,740 --> 00:23:27,639
he's like you can shoot eight hours a

645
00:23:25,389 --> 00:23:29,769
day essentially but if if your technique

646
00:23:27,639 --> 00:23:32,740
is wrong all you end up is shooting

647
00:23:29,769 --> 00:23:33,970
really badly it's all about the basics

648
00:23:32,740 --> 00:23:36,309
you know getting that for that

649
00:23:33,970 --> 00:23:38,320
foundation right I'm a sysadmin so you

650
00:23:36,309 --> 00:23:39,428
know former Microsoft sis admin and I

651
00:23:38,320 --> 00:23:41,049
think that helps me a lot in

652
00:23:39,429 --> 00:23:42,610
understanding networks and structures

653
00:23:41,049 --> 00:23:44,350
and if you ever see any pictures of

654
00:23:42,610 --> 00:23:46,299
Michael Jordan he's always smiling and

655
00:23:44,350 --> 00:23:48,189
it's because he's worth one point seven

656
00:23:46,299 --> 00:23:50,440
billion dollars because he spent a lot

657
00:23:48,190 --> 00:23:52,149
of time realizing that it's all in his

658
00:23:50,440 --> 00:23:54,940
basics and that's how he essentially

659
00:23:52,149 --> 00:23:56,408
built his career so I kind of look at

660
00:23:54,940 --> 00:23:58,450
this from I know how to build networks

661
00:23:56,409 --> 00:24:00,399
isn't a sysadmin what are the components

662
00:23:58,450 --> 00:24:02,679
that I need to create a representative

663
00:24:00,399 --> 00:24:04,268
company so that I can try some of these

664
00:24:02,679 --> 00:24:05,559
techniques out and they basically boil

665
00:24:04,269 --> 00:24:07,059
down to these three sections

666
00:24:05,559 --> 00:24:10,090
you know we've got machines that we need

667
00:24:07,059 --> 00:24:12,820
to run we need a domain structure Active

668
00:24:10,090 --> 00:24:15,039
Directory is ubiquitous you know love it

669
00:24:12,820 --> 00:24:17,830
or hate it that's just the way of the

670
00:24:15,039 --> 00:24:19,509
world and then user emulation and

671
00:24:17,830 --> 00:24:21,850
actually how do i replicate proper

672
00:24:19,509 --> 00:24:23,529
network traffic because very rarely are

673
00:24:21,850 --> 00:24:24,580
they just a collection of static

674
00:24:23,529 --> 00:24:26,369
machines that don't have any

675
00:24:24,580 --> 00:24:29,830
relationship that's obviously the people

676
00:24:26,369 --> 00:24:31,389
communicating within them that are it's

677
00:24:29,830 --> 00:24:33,129
alive it's a breathing thing and

678
00:24:31,389 --> 00:24:35,740
certainly in a red teaming we focus more

679
00:24:33,129 --> 00:24:37,600
on attacking those user configurations

680
00:24:35,740 --> 00:24:40,840
and how we can move through a network in

681
00:24:37,600 --> 00:24:44,889
the users rather than sort of SMB

682
00:24:40,840 --> 00:24:46,059
exploits etc so I started building demo

683
00:24:44,889 --> 00:24:47,350
labs I've been building them for a

684
00:24:46,059 --> 00:24:50,678
couple of years now but if you take this

685
00:24:47,350 --> 00:24:52,449
as an example of a demo lab it's got

686
00:24:50,679 --> 00:24:54,100
multiple sections to it's representative

687
00:24:52,450 --> 00:24:56,109
of a company environment in the sense

688
00:24:54,100 --> 00:24:58,629
that it can have nested Active Directory

689
00:24:56,109 --> 00:25:00,789
domain so parent-child relationships it

690
00:24:58,629 --> 00:25:02,740
has a customer network so there's a

691
00:25:00,789 --> 00:25:04,539
forest trust in place there and you know

692
00:25:02,740 --> 00:25:06,669
we can sort of emulate these fairly

693
00:25:04,539 --> 00:25:08,529
large organizations and I want to build

694
00:25:06,669 --> 00:25:10,590
big networks I mean I have a little

695
00:25:08,529 --> 00:25:13,059
network that I carry around my laptop

696
00:25:10,590 --> 00:25:14,590
but the the environments that I really

697
00:25:13,059 --> 00:25:17,019
want to build internally I want them to

698
00:25:14,590 --> 00:25:18,850
be 40 50 100 machines I basically want

699
00:25:17,019 --> 00:25:21,490
to get a beautifu males saying that

700
00:25:18,850 --> 00:25:23,379
we're gonna have to reinvest in sands to

701
00:25:21,490 --> 00:25:25,539
cover the cost of disk space i want them

702
00:25:23,379 --> 00:25:28,330
to be big big things right and lawrence

703
00:25:25,539 --> 00:25:31,779
screaming at me about the bills so

704
00:25:28,330 --> 00:25:33,639
thinking about building stuff you can

705
00:25:31,779 --> 00:25:35,019
always cheat that would be a good start

706
00:25:33,639 --> 00:25:37,029
if you just want to get going there's

707
00:25:35,019 --> 00:25:39,059
some great repos here Microsoft being

708
00:25:37,029 --> 00:25:41,470
the first so if you go to the Microsoft

709
00:25:39,059 --> 00:25:43,928
github there's a powershell scripts that

710
00:25:41,470 --> 00:25:47,019
allow you to just stand up an Active

711
00:25:43,929 --> 00:25:48,759
Directory infrastructure it uses hyper-v

712
00:25:47,019 --> 00:25:50,289
which is great because it's they're told

713
00:25:48,759 --> 00:25:51,070
not so great if you want to introduce

714
00:25:50,289 --> 00:25:53,830
other

715
00:25:51,070 --> 00:25:55,749
weirder machines and also hyper-v has a

716
00:25:53,830 --> 00:25:57,639
restriction in the version of Windows

717
00:25:55,749 --> 00:26:00,700
Server that you can run on it so you're

718
00:25:57,639 --> 00:26:03,998
kind of restricted to anything to 2008

719
00:26:00,700 --> 00:26:05,499
r2 and above so you know maybe if you

720
00:26:03,999 --> 00:26:08,409
don't want sort of if you want to

721
00:26:05,499 --> 00:26:10,210
replicate older networking that's not

722
00:26:08,409 --> 00:26:12,309
such a great solution an automated lab

723
00:26:10,210 --> 00:26:13,690
is the same type of thing one that I

724
00:26:12,309 --> 00:26:15,460
really like that I've been looking at

725
00:26:13,690 --> 00:26:17,590
for a while now is the detection lab

726
00:26:15,460 --> 00:26:20,109
project and that's kind of leans to my

727
00:26:17,590 --> 00:26:22,749
approach they use Paco and they look at

728
00:26:20,109 --> 00:26:24,428
it's quite intensive in how you build

729
00:26:22,749 --> 00:26:26,980
these machines so you know how can we

730
00:26:24,429 --> 00:26:28,750
make efficiencies with that and a lot of

731
00:26:26,980 --> 00:26:30,519
this seeds of these projects for me I

732
00:26:28,750 --> 00:26:33,070
read a paper from the University of

733
00:26:30,519 --> 00:26:34,990
Amsterdam published last year and Mark

734
00:26:33,070 --> 00:26:36,759
Smeets was one of the mentors on that so

735
00:26:34,990 --> 00:26:38,530
if you follow the sphere he's always got

736
00:26:36,759 --> 00:26:40,270
some interesting things to say

737
00:26:38,530 --> 00:26:42,820
and they were basically looking at all

738
00:26:40,270 --> 00:26:44,980
of the available solutions against their

739
00:26:42,820 --> 00:26:46,750
own approach and they did a sort of a

740
00:26:44,980 --> 00:26:49,810
cost comparison essentially as to where

741
00:26:46,750 --> 00:26:52,210
it was so if you look at hypervisors I'm

742
00:26:49,810 --> 00:26:53,500
a really big fan of proxmox if you've if

743
00:26:52,210 --> 00:26:54,910
you've never heard of it before you

744
00:26:53,500 --> 00:26:59,830
should check it out

745
00:26:54,910 --> 00:27:01,690
VMware is paid for it when you start

746
00:26:59,830 --> 00:27:03,610
getting into the the features that you

747
00:27:01,690 --> 00:27:05,200
want obviously hyper-v is a solution and

748
00:27:03,610 --> 00:27:06,639
you can run things on VirtualBox but

749
00:27:05,200 --> 00:27:08,820
when you're talking about big labs you

750
00:27:06,640 --> 00:27:11,590
basically need somewhere to run this and

751
00:27:08,820 --> 00:27:13,899
it's it's as I said it's a known problem

752
00:27:11,590 --> 00:27:15,610
Carlos Perez was just tweeting the other

753
00:27:13,900 --> 00:27:19,060
day about it's taking him far too much

754
00:27:15,610 --> 00:27:20,409
time to build his home lab and now who's

755
00:27:19,060 --> 00:27:21,940
got to start configuring all the

756
00:27:20,410 --> 00:27:23,260
components so I really started to focus

757
00:27:21,940 --> 00:27:24,570
on this is the way that I could think

758
00:27:23,260 --> 00:27:27,070
about improving things

759
00:27:24,570 --> 00:27:28,720
so essentially project project Labs is

760
00:27:27,070 --> 00:27:31,149
the wrapper for some of this sort of

761
00:27:28,720 --> 00:27:33,730
stuff you know and how can I build these

762
00:27:31,150 --> 00:27:35,170
places where I can test these things out

763
00:27:33,730 --> 00:27:37,330
what does my traffic look like on the

764
00:27:35,170 --> 00:27:39,610
wire how can I detect it how can I look

765
00:27:37,330 --> 00:27:41,350
at token manipulation and running DC

766
00:27:39,610 --> 00:27:44,530
sync and all this sort of stuff and how

767
00:27:41,350 --> 00:27:45,939
can I sort of level up and I want it to

768
00:27:44,530 --> 00:27:47,740
be focused on building these labs

769
00:27:45,940 --> 00:27:48,850
without manual control now we've all got

770
00:27:47,740 --> 00:27:50,530
better things to do than sit there

771
00:27:48,850 --> 00:27:52,750
clicking Next Next and worrying about

772
00:27:50,530 --> 00:27:53,710
Microsoft activation keys and I want to

773
00:27:52,750 --> 00:27:56,110
build large Active Directory

774
00:27:53,710 --> 00:27:57,820
infrastructure rich Active Directory

775
00:27:56,110 --> 00:27:59,469
infrastructures with lots of users and

776
00:27:57,820 --> 00:28:00,909
lots of information inside these Active

777
00:27:59,470 --> 00:28:03,370
Directory structures that I have to pull

778
00:28:00,910 --> 00:28:05,470
out and then the final challenge is

779
00:28:03,370 --> 00:28:07,540
emulating user behaviors you know how do

780
00:28:05,470 --> 00:28:09,010
you actually make it look like they're

781
00:28:07,540 --> 00:28:10,960
real users and not necessarily

782
00:28:09,010 --> 00:28:13,390
collections of scripts or of introducing

783
00:28:10,960 --> 00:28:15,910
tools for that and then I want it to be

784
00:28:13,390 --> 00:28:17,530
introduced entropy and make it random so

785
00:28:15,910 --> 00:28:18,850
that even though I've built it I don't

786
00:28:17,530 --> 00:28:20,710
necessarily want to know all the

787
00:28:18,850 --> 00:28:23,560
components of this lab the whole purpose

788
00:28:20,710 --> 00:28:25,840
of this is to facilitate my learning so

789
00:28:23,560 --> 00:28:27,550
if I've built it's like I'm taking my

790
00:28:25,840 --> 00:28:29,260
own exam so I want to build in that

791
00:28:27,550 --> 00:28:31,379
randomness so that I can focus on the

792
00:28:29,260 --> 00:28:33,730
principles of what I'm trying to achieve

793
00:28:31,380 --> 00:28:36,040
enumeration etc without necessarily

794
00:28:33,730 --> 00:28:38,920
knowing the answers for that and it's a

795
00:28:36,040 --> 00:28:41,320
good place to practice DDD IO which is a

796
00:28:38,920 --> 00:28:44,140
term coined by Lawrence which is this

797
00:28:41,320 --> 00:28:46,659
dangerous destructive disruptive illegal

798
00:28:44,140 --> 00:28:48,160
or out of scope activities so let's say

799
00:28:46,660 --> 00:28:49,660
you actually want a back door active

800
00:28:48,160 --> 00:28:50,960
directory it's probably not a good idea

801
00:28:49,660 --> 00:28:52,700
if you do that on a customer

802
00:28:50,960 --> 00:28:54,860
work it would be a challenge to to

803
00:28:52,700 --> 00:28:56,809
explain the outcome of that but still we

804
00:28:54,860 --> 00:28:58,610
should be exploring the ramifications of

805
00:28:56,809 --> 00:29:01,158
these things because as soon as it gets

806
00:28:58,610 --> 00:29:02,629
put into a framework like golden ticket

807
00:29:01,159 --> 00:29:04,190
somebody's going to click the big red

808
00:29:02,630 --> 00:29:07,460
button so it would be interesting to

809
00:29:04,190 --> 00:29:08,360
explore these so in terms of building

810
00:29:07,460 --> 00:29:10,130
machines

811
00:29:08,360 --> 00:29:12,139
my focus is Packer and if you haven't

812
00:29:10,130 --> 00:29:14,299
heard about Paco it's basically a

813
00:29:12,140 --> 00:29:16,399
mechanism for creating a machine image

814
00:29:14,299 --> 00:29:18,620
automating the processes in and out of

815
00:29:16,399 --> 00:29:20,750
that and then deploying it to a lot of

816
00:29:18,620 --> 00:29:22,250
places because one person might want to

817
00:29:20,750 --> 00:29:25,460
use hyper-v another person might want to

818
00:29:22,250 --> 00:29:28,220
push it to AWS my approach to this is

819
00:29:25,460 --> 00:29:29,600
the Packer basically has JSON files so

820
00:29:28,220 --> 00:29:31,190
it describes what the machines going to

821
00:29:29,600 --> 00:29:32,928
be like what happens when it boots up

822
00:29:31,190 --> 00:29:34,340
what happens in the middle and what

823
00:29:32,929 --> 00:29:36,590
happens when it's finished and where it

824
00:29:34,340 --> 00:29:38,779
pushes it to so you would make a base

825
00:29:36,590 --> 00:29:40,850
Windows image and then you would see the

826
00:29:38,779 --> 00:29:42,830
rest of the lab from that you can use

827
00:29:40,850 --> 00:29:45,549
the Microsoft 180 day evaluation

828
00:29:42,830 --> 00:29:47,899
solutions so that's six months for free

829
00:29:45,549 --> 00:29:49,879
you don't care about the nag screens and

830
00:29:47,899 --> 00:29:51,918
this is the point you know we won't

831
00:29:49,880 --> 00:29:53,899
build that randomness so we should have

832
00:29:51,919 --> 00:29:56,149
a process where we can just squash this

833
00:29:53,899 --> 00:29:58,279
lab and stand the whole thing up again

834
00:29:56,149 --> 00:30:00,949
and have another three six months to do

835
00:29:58,279 --> 00:30:02,539
all this sort of stuff you can see on

836
00:30:00,950 --> 00:30:03,950
the slide that here's all the provision

837
00:30:02,539 --> 00:30:05,570
are the builders that it supports so

838
00:30:03,950 --> 00:30:07,429
basically it can create images for all

839
00:30:05,570 --> 00:30:10,039
of those places which pretty much covers

840
00:30:07,429 --> 00:30:11,299
I would say 90% of the market and if it

841
00:30:10,039 --> 00:30:13,820
doesn't have a builder that you

842
00:30:11,299 --> 00:30:16,220
supported for you you can write your own

843
00:30:13,820 --> 00:30:18,080
so this is a solved problem in the the

844
00:30:16,220 --> 00:30:19,669
DevOps community in that they do these

845
00:30:18,080 --> 00:30:21,889
sorts of things for testing and I'm

846
00:30:19,669 --> 00:30:23,570
certainly building borrowing a lot of

847
00:30:21,890 --> 00:30:26,480
inspiration from their processes for

848
00:30:23,570 --> 00:30:28,700
that so that's an example of the JSON

849
00:30:26,480 --> 00:30:30,679
file you just you know define what the

850
00:30:28,700 --> 00:30:32,210
VM is going to be called where the ISO

851
00:30:30,679 --> 00:30:34,159
URL is you can't see that further down

852
00:30:32,210 --> 00:30:36,080
but I've got a video innocent it's quite

853
00:30:34,159 --> 00:30:38,980
quite human readable and then the floppy

854
00:30:36,080 --> 00:30:41,270
files you were basically adding in

855
00:30:38,980 --> 00:30:42,830
processes the machine starts up so it's

856
00:30:41,270 --> 00:30:44,330
going to automate sysprep and all those

857
00:30:42,830 --> 00:30:46,520
sorts of things so that you have a

858
00:30:44,330 --> 00:30:49,610
unique image and this is taken extended

859
00:30:46,520 --> 00:30:51,200
from the detection lab so as a video of

860
00:30:49,610 --> 00:30:54,199
that process basically you can validate

861
00:30:51,200 --> 00:30:56,029
that the template is is working and once

862
00:30:54,200 --> 00:30:57,830
it validates you can basically say build

863
00:30:56,029 --> 00:30:59,419
and what it will do is it will go away

864
00:30:57,830 --> 00:31:02,360
to the evaluation solution it will

865
00:30:59,419 --> 00:31:03,559
download the ISO for you and it will use

866
00:31:02,360 --> 00:31:04,699
that as a seed I've already downloaded

867
00:31:03,559 --> 00:31:06,950
that

868
00:31:04,700 --> 00:31:09,140
that solution so it's locally it's going

869
00:31:06,950 --> 00:31:11,120
to go away and then it will start going

870
00:31:09,140 --> 00:31:13,130
through the build process as you can see

871
00:31:11,120 --> 00:31:18,189
it's pulling it down and it's starting

872
00:31:13,130 --> 00:31:21,500
the Machine through lots of manual stuff

873
00:31:18,190 --> 00:31:23,150
so you can choose to install updates or

874
00:31:21,500 --> 00:31:24,770
not install updates depending on what

875
00:31:23,150 --> 00:31:26,660
you want you know that this isn't a

876
00:31:24,770 --> 00:31:28,220
5-minute solution you can build these

877
00:31:26,660 --> 00:31:29,300
sorts of labs in a couple of hours but

878
00:31:28,220 --> 00:31:30,560
the whole point about this is that

879
00:31:29,300 --> 00:31:32,810
you're not standing there having to

880
00:31:30,560 --> 00:31:34,610
touch this sort of stuff

881
00:31:32,810 --> 00:31:35,450
installing updates is an interesting one

882
00:31:34,610 --> 00:31:37,820
because it may be that you want

883
00:31:35,450 --> 00:31:39,500
out-of-date patched machines missing

884
00:31:37,820 --> 00:31:42,379
patches and look at that sort of stuff

885
00:31:39,500 --> 00:31:45,200
so yeah I'm going to release some

886
00:31:42,380 --> 00:31:47,000
scripts looking at how we can automate

887
00:31:45,200 --> 00:31:48,950
some of the solution and the goal is

888
00:31:47,000 --> 00:31:50,720
like make whatever your own lab is with

889
00:31:48,950 --> 00:31:52,130
different Network segments but if you

890
00:31:50,720 --> 00:31:54,650
look at this that's only one piece of

891
00:31:52,130 --> 00:31:56,240
the puzzle the lab is just machines at

892
00:31:54,650 --> 00:31:58,700
this point in time and we need that we

893
00:31:56,240 --> 00:32:00,260
need these edge controls in place so in

894
00:31:58,700 --> 00:32:03,110
this example there's actually three

895
00:32:00,260 --> 00:32:04,460
firewalls one which is handling the

896
00:32:03,110 --> 00:32:06,560
connections between the corporate in the

897
00:32:04,460 --> 00:32:08,090
IT environments and development which is

898
00:32:06,560 --> 00:32:09,620
a proxy server and then there's a

899
00:32:08,090 --> 00:32:11,810
secondary just as in a corporate

900
00:32:09,620 --> 00:32:13,939
environment you know you have multiple

901
00:32:11,810 --> 00:32:16,280
layers of control and I want that in the

902
00:32:13,940 --> 00:32:17,810
lab so that I can look at putting

903
00:32:16,280 --> 00:32:19,220
challenges in place and thinking about

904
00:32:17,810 --> 00:32:22,250
what my traffic is and what other

905
00:32:19,220 --> 00:32:23,780
controls between the two so if anybody's

906
00:32:22,250 --> 00:32:26,510
heard of it before I'm a huge fan of

907
00:32:23,780 --> 00:32:27,290
Vios which is like a hardware emulation

908
00:32:26,510 --> 00:32:29,450
router

909
00:32:27,290 --> 00:32:31,879
it used to be called viata brocade

910
00:32:29,450 --> 00:32:34,340
bought it subsequently quickly killed

911
00:32:31,880 --> 00:32:36,320
off the community edition but thankfully

912
00:32:34,340 --> 00:32:38,540
the superheroes at vias forked it before

913
00:32:36,320 --> 00:32:40,490
it was buried and it does everything

914
00:32:38,540 --> 00:32:42,710
it's really powerful and if you've done

915
00:32:40,490 --> 00:32:44,540
any Cisco configuration or juniper work

916
00:32:42,710 --> 00:32:45,860
it will feel very familiar to you it's

917
00:32:44,540 --> 00:32:47,690
actually based on the juniper standard

918
00:32:45,860 --> 00:32:49,250
and this is just on the on the right

919
00:32:47,690 --> 00:32:50,270
hand side there's just some examples of

920
00:32:49,250 --> 00:32:52,820
all the things that you can do out of

921
00:32:50,270 --> 00:32:55,370
the box I generally tend to use the

922
00:32:52,820 --> 00:32:57,290
firewall proxy and the DHCP capabilities

923
00:32:55,370 --> 00:32:59,389
of it but it's very very powerful you

924
00:32:57,290 --> 00:33:01,550
can emulate site-to-site VPN with it and

925
00:32:59,390 --> 00:33:03,230
all that sort of stuff and how I use it

926
00:33:01,550 --> 00:33:05,060
in the context of the lab is basically I

927
00:33:03,230 --> 00:33:06,710
have a master bios and that has an

928
00:33:05,060 --> 00:33:08,960
interface in each of these network

929
00:33:06,710 --> 00:33:10,340
segments that are created and then I can

930
00:33:08,960 --> 00:33:12,470
control the traffic between them we can

931
00:33:10,340 --> 00:33:14,240
specify that one more more one can only

932
00:33:12,470 --> 00:33:15,890
talk on certain ports to anything in the

933
00:33:14,240 --> 00:33:18,250
adjacent subnet and we can build more

934
00:33:15,890 --> 00:33:19,950
realistic Network examples

935
00:33:18,250 --> 00:33:23,410
we would like to say that we don't see

936
00:33:19,950 --> 00:33:25,030
flat networks on a daily basis and we

937
00:33:23,410 --> 00:33:27,700
would recommend that they are segmented

938
00:33:25,030 --> 00:33:30,129
but but even so it's it's still a common

939
00:33:27,700 --> 00:33:31,390
thing so the next thing is once you've

940
00:33:30,130 --> 00:33:32,620
got your environment in place you need

941
00:33:31,390 --> 00:33:34,750
to start thinking about Active Directory

942
00:33:32,620 --> 00:33:36,669
and domain account so how can we do that

943
00:33:34,750 --> 00:33:38,080
because as I said before I want to be

944
00:33:36,670 --> 00:33:40,240
able to go through the process of

945
00:33:38,080 --> 00:33:41,949
enumerated Active Directory in searching

946
00:33:40,240 --> 00:33:45,640
for things rather than necessarily

947
00:33:41,950 --> 00:33:48,490
knowing what's out there now that's the

948
00:33:45,640 --> 00:33:50,110
whole point of the the learning for me

949
00:33:48,490 --> 00:33:52,150
is in getting better at those skill sets

950
00:33:50,110 --> 00:33:53,469
and improving on my tradecraft so when

951
00:33:52,150 --> 00:33:55,120
I'm creating these I thought well what

952
00:33:53,470 --> 00:33:57,340
do I actually need to introduce into

953
00:33:55,120 --> 00:33:59,469
this this seeding approach I need them

954
00:33:57,340 --> 00:34:00,909
to be unique accounts and I want them to

955
00:33:59,470 --> 00:34:02,770
be random so I don't actually want to

956
00:34:00,910 --> 00:34:05,350
know what the user names and think

957
00:34:02,770 --> 00:34:06,490
information about that person is I want

958
00:34:05,350 --> 00:34:08,139
them to be able to generate random

959
00:34:06,490 --> 00:34:10,149
passwords because that's really good for

960
00:34:08,139 --> 00:34:11,889
things like testing out hash cap masking

961
00:34:10,149 --> 00:34:14,290
and you know maybe you want to do some

962
00:34:11,889 --> 00:34:15,879
cracking drop NTDs bit and test out some

963
00:34:14,290 --> 00:34:18,489
strategies about how you can improve

964
00:34:15,879 --> 00:34:20,020
your cracking I want them to be able to

965
00:34:18,489 --> 00:34:22,330
choose source lists you know things like

966
00:34:20,020 --> 00:34:24,219
the common speak - source list word

967
00:34:22,330 --> 00:34:26,918
lists are really good they're they're

968
00:34:24,219 --> 00:34:28,928
action from true real-world github

969
00:34:26,918 --> 00:34:30,580
repositories I like the real password

970
00:34:28,929 --> 00:34:32,950
lists as well you know they're from

971
00:34:30,580 --> 00:34:34,690
passwords that people choose and also

972
00:34:32,949 --> 00:34:36,428
choosing your own source list I've been

973
00:34:34,690 --> 00:34:38,290
on jobs where we've scraped the company

974
00:34:36,429 --> 00:34:41,860
website beforehand and they've been

975
00:34:38,290 --> 00:34:44,980
things like beer brands German beer

976
00:34:41,860 --> 00:34:47,110
brands that aren't in common you have to

977
00:34:44,980 --> 00:34:48,879
find them out so they're very unique to

978
00:34:47,110 --> 00:34:50,310
that company and obviously people that

979
00:34:48,879 --> 00:34:52,418
are part of the company tend to

980
00:34:50,310 --> 00:34:54,370
affiliate to that so some of the

981
00:34:52,418 --> 00:34:56,799
passwords are choices that are relevant

982
00:34:54,370 --> 00:34:58,240
so you know we managed to recover a lot

983
00:34:56,800 --> 00:35:00,760
of passwords that way and it kind of

984
00:34:58,240 --> 00:35:02,890
made me think well I want that ability

985
00:35:00,760 --> 00:35:05,320
to be able to provide randomness there

986
00:35:02,890 --> 00:35:06,879
and I want to make it at volume I want

987
00:35:05,320 --> 00:35:08,830
lots and lots of users and lots and lots

988
00:35:06,880 --> 00:35:10,800
of places so that I really have to wade

989
00:35:08,830 --> 00:35:13,450
through those details to get to the end

990
00:35:10,800 --> 00:35:16,390
so I'm gonna be pushing a tool called

991
00:35:13,450 --> 00:35:18,730
user over the weekend to the spider lab

992
00:35:16,390 --> 00:35:21,520
to github repo it's a tool that uses

993
00:35:18,730 --> 00:35:23,860
faker if you've ever done any it's in

994
00:35:21,520 --> 00:35:25,660
Ruby there's some options there and it

995
00:35:23,860 --> 00:35:27,460
generates a large number of users at

996
00:35:25,660 --> 00:35:30,879
random so I can create a hundred

997
00:35:27,460 --> 00:35:31,660
thousand users in about 30 seconds I got

998
00:35:30,880 --> 00:35:33,039
to a million use

999
00:35:31,660 --> 00:35:34,538
the other day and it was under three

1000
00:35:33,039 --> 00:35:36,160
minutes I mean that's a big active

1001
00:35:34,539 --> 00:35:38,200
directory to have that number of users

1002
00:35:36,160 --> 00:35:40,328
and it basically chooses a password

1003
00:35:38,200 --> 00:35:41,770
lists or the word list that you've

1004
00:35:40,329 --> 00:35:44,319
specified and it picks them at random

1005
00:35:41,770 --> 00:35:46,990
and it spits out a CSV file with those

1006
00:35:44,319 --> 00:35:48,520
credentials and a PowerShell file that

1007
00:35:46,990 --> 00:35:49,990
you can run on the DC so if you think

1008
00:35:48,520 --> 00:35:51,819
back to how you can automate this with

1009
00:35:49,990 --> 00:35:53,558
Packer that would be part of a post

1010
00:35:51,819 --> 00:35:55,930
process procedure to import all of these

1011
00:35:53,559 --> 00:35:58,599
users in and there's an example of this

1012
00:35:55,930 --> 00:36:00,848
at the top so it's a command line

1013
00:35:58,599 --> 00:36:03,609
scenario so you pass in the solutions

1014
00:36:00,849 --> 00:36:05,589
and it spits out these files for you and

1015
00:36:03,609 --> 00:36:08,680
in the first example I've got a CSV file

1016
00:36:05,589 --> 00:36:10,420
and it's generated 20 character random

1017
00:36:08,680 --> 00:36:11,558
passwords for all of those users so

1018
00:36:10,420 --> 00:36:13,780
that's really good I can import that

1019
00:36:11,559 --> 00:36:15,520
interactive directory and there's a

1020
00:36:13,780 --> 00:36:17,289
PowerShell file that it writes for you

1021
00:36:15,520 --> 00:36:20,079
which is relevant to that CSV file it's

1022
00:36:17,289 --> 00:36:22,530
just created i I do direct LDAP

1023
00:36:20,079 --> 00:36:24,430
connections using Active Directory

1024
00:36:22,530 --> 00:36:26,920
accelerators rather than using the

1025
00:36:24,430 --> 00:36:29,230
Active Directory commandlets because it

1026
00:36:26,920 --> 00:36:30,760
means that it runs on things like 2008

1027
00:36:29,230 --> 00:36:33,220
DC's which don't have some of those

1028
00:36:30,760 --> 00:36:34,930
controls and then the second example is

1029
00:36:33,220 --> 00:36:38,799
that I've just created it with a word

1030
00:36:34,930 --> 00:36:42,669
list to do the same thing basically so

1031
00:36:38,799 --> 00:36:46,240
you take the CSV file and take it to a

1032
00:36:42,670 --> 00:36:47,619
DC and then you can basically run the

1033
00:36:46,240 --> 00:36:49,660
tool and it will import it it will

1034
00:36:47,619 --> 00:36:51,460
create an object for each user and it

1035
00:36:49,660 --> 00:36:53,680
will push them in and you can really get

1036
00:36:51,460 --> 00:36:55,180
rich with the types of LDAP properties

1037
00:36:53,680 --> 00:36:57,160
that you can attach to these users so it

1038
00:36:55,180 --> 00:37:00,430
supports names and addresses and locales

1039
00:36:57,160 --> 00:37:02,259
so you can create German addresses you

1040
00:37:00,430 --> 00:37:03,819
know Asian addresses English addresses

1041
00:37:02,260 --> 00:37:05,410
and the whole point about this is to

1042
00:37:03,819 --> 00:37:07,660
bury stuff into the directory that you

1043
00:37:05,410 --> 00:37:08,950
have to say to people hey can you go and

1044
00:37:07,660 --> 00:37:11,200
find me all of the people that live in

1045
00:37:08,950 --> 00:37:13,450
this county that whose name begins with

1046
00:37:11,200 --> 00:37:15,460
B now these are all good strategies to

1047
00:37:13,450 --> 00:37:17,558
build up our tradecraft to try and find

1048
00:37:15,460 --> 00:37:20,470
where these users are and how they're

1049
00:37:17,559 --> 00:37:24,279
relevant I'll fast forward this was a

1050
00:37:20,470 --> 00:37:26,439
10,000 list file that I created so I'll

1051
00:37:24,279 --> 00:37:28,299
just skip through to showing you at the

1052
00:37:26,440 --> 00:37:30,700
end so down the bottom it's reduced

1053
00:37:28,299 --> 00:37:32,020
imported a thousand users and then when

1054
00:37:30,700 --> 00:37:33,368
you refresh all of those users are in

1055
00:37:32,020 --> 00:37:34,900
there now I don't know any of these

1056
00:37:33,369 --> 00:37:36,520
people's names they're all active

1057
00:37:34,900 --> 00:37:38,940
accounts now that I can now go and start

1058
00:37:36,520 --> 00:37:38,940
exploring

1059
00:37:40,549 --> 00:37:47,190
so that's so there's still a missing

1060
00:37:42,839 --> 00:37:50,130
piece so we have a structure to build

1061
00:37:47,190 --> 00:37:51,690
domains and we have an approach to

1062
00:37:50,130 --> 00:37:54,059
ceding Active Directory with random

1063
00:37:51,690 --> 00:37:55,589
information that we don't know about but

1064
00:37:54,059 --> 00:37:58,470
the point as I said before is it's it's

1065
00:37:55,589 --> 00:37:59,940
about how do we emulate user actions you

1066
00:37:58,470 --> 00:38:01,640
know that is part of the network we're

1067
00:37:59,940 --> 00:38:04,440
attacking the users how do we do that

1068
00:38:01,640 --> 00:38:08,910
so introducing a cool tool called

1069
00:38:04,440 --> 00:38:11,059
sheeple essentially it's designed to

1070
00:38:08,910 --> 00:38:13,589
emulate all of the things that can be

1071
00:38:11,059 --> 00:38:15,990
represented by a user if you think about

1072
00:38:13,589 --> 00:38:17,910
what a user does and how they interact

1073
00:38:15,990 --> 00:38:19,589
with the system my goal is really to try

1074
00:38:17,910 --> 00:38:22,529
and emulate all of that activity and

1075
00:38:19,589 --> 00:38:24,240
have benign actions as well as malicious

1076
00:38:22,529 --> 00:38:26,759
actions so that it's useful for both

1077
00:38:24,240 --> 00:38:28,618
sides of that equation blue teamers can

1078
00:38:26,759 --> 00:38:32,089
use it for detection capabilities to see

1079
00:38:28,619 --> 00:38:34,980
whether they can find that specific

1080
00:38:32,089 --> 00:38:36,900
powershell download cradle in a massive

1081
00:38:34,980 --> 00:38:38,279
network noise rather than being

1082
00:38:36,900 --> 00:38:40,410
everybody got their sense is ready right

1083
00:38:38,279 --> 00:38:41,910
click we've all you know we can see that

1084
00:38:40,410 --> 00:38:44,368
event try and blend things into the

1085
00:38:41,910 --> 00:38:46,348
noise and it really came about from

1086
00:38:44,369 --> 00:38:48,569
reading the paper that I said before and

1087
00:38:46,349 --> 00:38:49,619
that they did a large study and then

1088
00:38:48,569 --> 00:38:51,839
they found that there wasn't really

1089
00:38:49,619 --> 00:38:53,269
anything there to generate for users to

1090
00:38:51,839 --> 00:38:55,589
generate files

1091
00:38:53,269 --> 00:38:57,238
you know the sorts of common things that

1092
00:38:55,589 --> 00:38:59,130
users do within a network generating

1093
00:38:57,239 --> 00:39:00,839
artifacts content interacting with each

1094
00:38:59,130 --> 00:39:02,880
other all of those sorts of things

1095
00:39:00,839 --> 00:39:04,349
so this stayed with me and I've kind of

1096
00:39:02,880 --> 00:39:05,880
researched and thought about ways that I

1097
00:39:04,349 --> 00:39:07,619
could do this and I realized that I've

1098
00:39:05,880 --> 00:39:10,589
kind of been here before because I'm a

1099
00:39:07,619 --> 00:39:12,650
sysadmin and when I ran my own company I

1100
00:39:10,589 --> 00:39:14,730
had to do a lot of deployment software

1101
00:39:12,650 --> 00:39:16,710
so I wanted to look at ways of

1102
00:39:14,730 --> 00:39:18,299
automating it and when I'd get pieces of

1103
00:39:16,710 --> 00:39:20,339
software that couldn't be deployed or

1104
00:39:18,299 --> 00:39:24,150
MSI wrapped because they were written in

1105
00:39:20,339 --> 00:39:26,190
1995 for Windows 95 and they would just

1106
00:39:24,150 --> 00:39:27,989
break I needed a better solution rather

1107
00:39:26,190 --> 00:39:29,640
than the concept of sitting at a

1108
00:39:27,989 --> 00:39:32,369
thousand machines clicking next next

1109
00:39:29,640 --> 00:39:35,009
next next so I used a tool called all to

1110
00:39:32,369 --> 00:39:37,410
it for for that solution and if you

1111
00:39:35,009 --> 00:39:39,269
don't know what altar is it's it's a

1112
00:39:37,410 --> 00:39:41,368
basic like language it's freeware it

1113
00:39:39,269 --> 00:39:43,439
fully integrates some controls windows

1114
00:39:41,369 --> 00:39:45,180
so you can it's very powerful you can

1115
00:39:43,440 --> 00:39:46,829
hook it in at the kernel level you can

1116
00:39:45,180 --> 00:39:49,440
interface with calm objects but you can

1117
00:39:46,829 --> 00:39:52,020
enter you can automate any part of the

1118
00:39:49,440 --> 00:39:54,240
graphical interface so you

1119
00:39:52,020 --> 00:39:55,860
move my so you can send keys and I

1120
00:39:54,240 --> 00:39:57,810
really started to realize well how far

1121
00:39:55,860 --> 00:40:00,300
can i push this technology to try and

1122
00:39:57,810 --> 00:40:05,549
replicate the type of user activities

1123
00:40:00,300 --> 00:40:06,960
that I want so if you think about what a

1124
00:40:05,550 --> 00:40:09,000
user does that you know they create

1125
00:40:06,960 --> 00:40:12,690
tasks they have things that they do

1126
00:40:09,000 --> 00:40:14,460
within a day so I wanted them to be able

1127
00:40:12,690 --> 00:40:15,840
to create Word documents and interact

1128
00:40:14,460 --> 00:40:17,790
with command shells and load up

1129
00:40:15,840 --> 00:40:20,190
PowerShell and create remote desktop

1130
00:40:17,790 --> 00:40:21,990
connections and all of that needed to be

1131
00:40:20,190 --> 00:40:24,510
in a random time because I didn't want

1132
00:40:21,990 --> 00:40:26,069
to necessarily know when that would

1133
00:40:24,510 --> 00:40:27,720
happen a problem with sort of

1134
00:40:26,070 --> 00:40:29,100
traditional script based approaches is

1135
00:40:27,720 --> 00:40:30,480
they're generally on a scheduled loop

1136
00:40:29,100 --> 00:40:32,190
and they'll run every 10 minutes so

1137
00:40:30,480 --> 00:40:35,100
they're predictable so that's good

1138
00:40:32,190 --> 00:40:37,020
initially but then immediately the

1139
00:40:35,100 --> 00:40:38,549
return of investment diminishes because

1140
00:40:37,020 --> 00:40:39,570
now you already know what the answer is

1141
00:40:38,550 --> 00:40:41,460
going to be you know when things are

1142
00:40:39,570 --> 00:40:44,130
going to happen so it removes those

1143
00:40:41,460 --> 00:40:46,710
moments of opportunity and ways to sort

1144
00:40:44,130 --> 00:40:49,200
of see if you can catch that so in this

1145
00:40:46,710 --> 00:40:51,810
example I'm just using the the the

1146
00:40:49,200 --> 00:40:53,790
command line version to mass create

1147
00:40:51,810 --> 00:40:56,130
people I will say we still haven't

1148
00:40:53,790 --> 00:40:58,470
properly agreed on whether it's a sheep

1149
00:40:56,130 --> 00:41:00,270
all the shapes of shirts and what's the

1150
00:40:58,470 --> 00:41:02,399
plural of sheeple it's all been quite

1151
00:41:00,270 --> 00:41:04,680
interesting over beers as to what

1152
00:41:02,400 --> 00:41:06,690
actually this thing is but that's part

1153
00:41:04,680 --> 00:41:08,220
of the firm it has two modes it has this

1154
00:41:06,690 --> 00:41:09,630
mode that you can put it into a wider

1155
00:41:08,220 --> 00:41:12,120
description solution or I've written an

1156
00:41:09,630 --> 00:41:14,040
interactive solution as well so it

1157
00:41:12,120 --> 00:41:15,810
basically uses Python to spit out these

1158
00:41:14,040 --> 00:41:16,980
valid or to it files that control the

1159
00:41:15,810 --> 00:41:20,340
functions and you'll see some of the

1160
00:41:16,980 --> 00:41:21,570
benefits of Waterway in a minute this is

1161
00:41:20,340 --> 00:41:23,010
an example of running the CMD

1162
00:41:21,570 --> 00:41:25,140
interaction and all the things that get

1163
00:41:23,010 --> 00:41:27,570
pushed out and I've written all of the

1164
00:41:25,140 --> 00:41:29,190
actions as Python 3 classes so you know

1165
00:41:27,570 --> 00:41:30,870
adding new behaviors into this you

1166
00:41:29,190 --> 00:41:32,760
should be able to extend it and with

1167
00:41:30,870 --> 00:41:34,740
some little tweaks to where these things

1168
00:41:32,760 --> 00:41:37,410
get pulled in as arguments you could

1169
00:41:34,740 --> 00:41:39,270
should be able to add those in so this

1170
00:41:37,410 --> 00:41:42,210
is an example of running it interactive

1171
00:41:39,270 --> 00:41:44,509
mode so you get this this lab and you

1172
00:41:42,210 --> 00:41:46,200
can list the types of current

1173
00:41:44,510 --> 00:41:47,850
functionalities that they can do as you

1174
00:41:46,200 --> 00:41:51,200
can see they can create Word files and

1175
00:41:47,850 --> 00:41:54,600
and CMD and PowerShell etc you create a

1176
00:41:51,200 --> 00:41:56,220
thing a shirts and sheep or whatever in

1177
00:41:54,600 --> 00:41:58,529
this case I'm creating one called 44

1178
00:41:56,220 --> 00:42:00,899
Khan and you specify how long that wants

1179
00:41:58,530 --> 00:42:03,390
to be so I want to be able to say things

1180
00:42:00,900 --> 00:42:04,950
like they can do tasks over 8 hours and

1181
00:42:03,390 --> 00:42:05,470
maybe give them three things to do in

1182
00:42:04,950 --> 00:42:07,089
those eight

1183
00:42:05,470 --> 00:42:09,459
and you're not entirely sure when

1184
00:42:07,090 --> 00:42:11,980
they're going to happen so I've

1185
00:42:09,460 --> 00:42:13,540
specified going to the CMD prompt here

1186
00:42:11,980 --> 00:42:15,280
and these are the commands that I want

1187
00:42:13,540 --> 00:42:20,380
you to execute when you get to the CMD

1188
00:42:15,280 --> 00:42:21,430
window you know all the common things if

1189
00:42:20,380 --> 00:42:23,020
you start thinking about anything that

1190
00:42:21,430 --> 00:42:26,020
you can type on a keyboard can be

1191
00:42:23,020 --> 00:42:27,700
emulated so I keep on coming back to

1192
00:42:26,020 --> 00:42:29,080
that you can make good sheeple or bad

1193
00:42:27,700 --> 00:42:31,419
cheaper that's entirely up to you but

1194
00:42:29,080 --> 00:42:33,400
I've actually started using this to sort

1195
00:42:31,420 --> 00:42:35,950
of emulate malware and maybe some of the

1196
00:42:33,400 --> 00:42:38,490
other things that I I kind of look at to

1197
00:42:35,950 --> 00:42:40,270
do diversionary tactics and things

1198
00:42:38,490 --> 00:42:41,799
anything that you can type on the

1199
00:42:40,270 --> 00:42:43,390
keyboard can be emulated with this

1200
00:42:41,800 --> 00:42:45,550
process also it supports all of the

1201
00:42:43,390 --> 00:42:48,580
windows hotkeys so you can get very

1202
00:42:45,550 --> 00:42:50,410
creative and complex with these tasks so

1203
00:42:48,580 --> 00:42:52,270
in the second one I'm just now giving it

1204
00:42:50,410 --> 00:42:55,029
a second task which is PowerShell I've

1205
00:42:52,270 --> 00:42:57,400
truncated the time to any of my demos

1206
00:42:55,030 --> 00:42:59,080
are over sort of one minute they perform

1207
00:42:57,400 --> 00:43:00,520
all of these tasks over one minute it's

1208
00:42:59,080 --> 00:43:01,990
got some logic for things like if you

1209
00:43:00,520 --> 00:43:03,640
pass in the wrong commands it will say

1210
00:43:01,990 --> 00:43:07,419
hey no you need this is actually what

1211
00:43:03,640 --> 00:43:10,990
you need to do and there's going to be

1212
00:43:07,420 --> 00:43:13,119
one more interaction which is a tea

1213
00:43:10,990 --> 00:43:15,040
break which is quite nice because that

1214
00:43:13,119 --> 00:43:17,589
gives you the option of introducing even

1215
00:43:15,040 --> 00:43:19,330
more sort of randomness into it there's

1216
00:43:17,589 --> 00:43:20,710
a period of time as a task where they

1217
00:43:19,330 --> 00:43:22,750
just don't do anything they sit dormant

1218
00:43:20,710 --> 00:43:23,950
sleep and then after they've had their

1219
00:43:22,750 --> 00:43:26,650
tea break they're gonna come back and

1220
00:43:23,950 --> 00:43:28,720
they're gonna go to to open up ie on

1221
00:43:26,650 --> 00:43:30,520
Google and it spits out this or to it

1222
00:43:28,720 --> 00:43:34,060
file that you get up with that you end

1223
00:43:30,520 --> 00:43:36,670
up with and then you compile that using

1224
00:43:34,060 --> 00:43:38,980
that a to exe version so this can work

1225
00:43:36,670 --> 00:43:40,540
it's good to work on Windows that I've

1226
00:43:38,980 --> 00:43:41,920
deliberately written the tool in Python

1227
00:43:40,540 --> 00:43:43,839
3 so that it doesn't have any external

1228
00:43:41,920 --> 00:43:45,280
dependencies so that you can run it on

1229
00:43:43,839 --> 00:43:47,109
Windows without too much of a headache

1230
00:43:45,280 --> 00:43:49,630
but you can also run this on wine and

1231
00:43:47,109 --> 00:43:52,509
compile it that way and when you look at

1232
00:43:49,630 --> 00:43:54,730
the output here when I run as a process

1233
00:43:52,510 --> 00:43:56,109
list I run 44 con dot X E which was what

1234
00:43:54,730 --> 00:43:59,109
I showed you before and if you look at

1235
00:43:56,109 --> 00:44:01,540
the process tree 44 context II spawns as

1236
00:43:59,109 --> 00:44:03,069
a child process of Explorer so

1237
00:44:01,540 --> 00:44:06,730
straightaway that's really good like EDR

1238
00:44:03,070 --> 00:44:09,040
solutions commonly look at how how the

1239
00:44:06,730 --> 00:44:10,960
process tree is an Excel spawning calc

1240
00:44:09,040 --> 00:44:13,029
which is a bit of a anomaly and that's a

1241
00:44:10,960 --> 00:44:14,920
strange thing but because we're sending

1242
00:44:13,030 --> 00:44:16,510
keystrokes all of these keystrokes can

1243
00:44:14,920 --> 00:44:18,789
actually be key log of all so you know

1244
00:44:16,510 --> 00:44:20,529
I'll show you some examples later where

1245
00:44:18,789 --> 00:44:22,660
you can intercept the types of things

1246
00:44:20,529 --> 00:44:24,609
that they're there typing so you know

1247
00:44:22,660 --> 00:44:26,949
that brings in opportunities as copying

1248
00:44:24,609 --> 00:44:28,569
the keyboard and monitoring that and you

1249
00:44:26,949 --> 00:44:31,119
can see as they're typing these commands

1250
00:44:28,569 --> 00:44:33,489
in if it needs to spawn a sub process

1251
00:44:31,119 --> 00:44:35,469
under CMD then it will do that I've

1252
00:44:33,489 --> 00:44:37,089
pushed the process Explorer to the front

1253
00:44:35,469 --> 00:44:38,949
here because one of the challenges of

1254
00:44:37,089 --> 00:44:40,749
the scripting is if something seals that

1255
00:44:38,949 --> 00:44:42,339
focus all of a sudden all your commands

1256
00:44:40,749 --> 00:44:45,819
are being pushed into the calc window

1257
00:44:42,339 --> 00:44:47,828
and really bad things happen so it has a

1258
00:44:45,819 --> 00:44:49,359
feature where as soon as it realizes it

1259
00:44:47,829 --> 00:44:51,039
needs to act with the CMD again it will

1260
00:44:49,359 --> 00:44:52,390
immediately take the focus back from the

1261
00:44:51,039 --> 00:44:54,130
genome and it will bring that window to

1262
00:44:52,390 --> 00:44:55,509
the forefront so it's very sticky like

1263
00:44:54,130 --> 00:44:57,429
that so it solves those sorts of

1264
00:44:55,509 --> 00:45:00,669
problems as you can see I can minimize

1265
00:44:57,429 --> 00:45:02,410
it here just to try and disrupt the

1266
00:45:00,669 --> 00:45:04,259
process but it will quickly open it back

1267
00:45:02,410 --> 00:45:07,828
up again and it will finish the last

1268
00:45:04,259 --> 00:45:10,509
that the last command in that task block

1269
00:45:07,829 --> 00:45:11,979
so hopefully after a couple of seconds

1270
00:45:10,509 --> 00:45:14,439
he's probably be potentially on a tea

1271
00:45:11,979 --> 00:45:15,489
break but he's gonna open up powershell

1272
00:45:14,439 --> 00:45:17,229
and he's gonna run all this sort of

1273
00:45:15,489 --> 00:45:19,119
stuff so as you can start to think about

1274
00:45:17,229 --> 00:45:21,368
what you would use powershell for this

1275
00:45:19,119 --> 00:45:23,409
could be anything this could be an IE x

1276
00:45:21,369 --> 00:45:25,900
download cradle two to invoke mimikatz

1277
00:45:23,409 --> 00:45:28,689
as an example or you know whatever you

1278
00:45:25,900 --> 00:45:29,859
can type on a keyboard we can emulate so

1279
00:45:28,689 --> 00:45:32,019
you just have to think about what your

1280
00:45:29,859 --> 00:45:33,999
processes are and a lot of this stuff

1281
00:45:32,019 --> 00:45:35,859
has been informed by how I actually work

1282
00:45:33,999 --> 00:45:38,078
anyway and me looking at my process to

1283
00:45:35,859 --> 00:45:43,449
think well can I actually automate that

1284
00:45:38,079 --> 00:45:46,719
can I make a sheep will do that and

1285
00:45:43,449 --> 00:45:50,589
hopefully when it's finished on mindful

1286
00:45:46,719 --> 00:45:54,219
of time he should open ie I'll skip to

1287
00:45:50,589 --> 00:45:55,808
I'll skip to the magic so all obviously

1288
00:45:54,219 --> 00:45:57,909
looks like magic like Laurence said it

1289
00:45:55,809 --> 00:46:00,459
wasn't magic but Paul Daniels disagrees

1290
00:45:57,909 --> 00:46:04,390
it really is so if you look at this in a

1291
00:46:00,459 --> 00:46:06,009
more realistic scenario I wanted so

1292
00:46:04,390 --> 00:46:07,779
that's the example it can show you how

1293
00:46:06,009 --> 00:46:09,939
we can spawn processes but how can we

1294
00:46:07,779 --> 00:46:12,429
sort properly emulate so so my last

1295
00:46:09,939 --> 00:46:14,799
video is really kind of giving the full

1296
00:46:12,429 --> 00:46:16,359
picture of this so I've got cobalt right

1297
00:46:14,799 --> 00:46:19,059
running with a beacon active already

1298
00:46:16,359 --> 00:46:21,279
I've extended this 44 Conchi bull that

1299
00:46:19,059 --> 00:46:22,239
I've created I don't need to show you

1300
00:46:21,279 --> 00:46:25,329
how to build that anymore

1301
00:46:22,239 --> 00:46:26,919
it's running my sort of go-to IP config

1302
00:46:25,329 --> 00:46:28,239
I'm building in other things lie as you

1303
00:46:26,919 --> 00:46:29,348
can see there's a spelling mistake there

1304
00:46:28,239 --> 00:46:30,640
so he's quickly back back back back

1305
00:46:29,349 --> 00:46:32,110
because if you ever watched me typing

1306
00:46:30,640 --> 00:46:34,210
I'm atrocious

1307
00:46:32,110 --> 00:46:36,160
bringing in sort of randomness into how

1308
00:46:34,210 --> 00:46:37,810
they type and adding in mistakes makes

1309
00:46:36,160 --> 00:46:40,149
it more difficult for us to try and pass

1310
00:46:37,810 --> 00:46:42,279
this blob of keylogging that we get back

1311
00:46:40,150 --> 00:46:43,930
I think all of these sorts of things are

1312
00:46:42,280 --> 00:46:45,490
really useful you know we don't expect

1313
00:46:43,930 --> 00:46:47,770
everything to come through and you can

1314
00:46:45,490 --> 00:46:50,259
control how fast they type as well so I

1315
00:46:47,770 --> 00:46:52,690
like the idea of having chicken peckers

1316
00:46:50,260 --> 00:46:54,070
that take like three three weeks to type

1317
00:46:52,690 --> 00:46:56,260
three commands so that you really have

1318
00:46:54,070 --> 00:46:58,300
to work with that and then the next task

1319
00:46:56,260 --> 00:47:00,220
is going to open up 44 con it's going to

1320
00:46:58,300 --> 00:47:01,900
open up a Word document it's going to

1321
00:47:00,220 --> 00:47:04,149
send the commands to change heading

1322
00:47:01,900 --> 00:47:05,440
types and all this sort of stuff so it's

1323
00:47:04,150 --> 00:47:06,910
pretty fun to think about how you can

1324
00:47:05,440 --> 00:47:09,400
interact with Word you can insert

1325
00:47:06,910 --> 00:47:12,069
pictures and do any of that sort of

1326
00:47:09,400 --> 00:47:13,870
stuff pretty good from from that

1327
00:47:12,070 --> 00:47:15,850
perspective there's a spelling mistake

1328
00:47:13,870 --> 00:47:17,440
in there it has been great to be a part

1329
00:47:15,850 --> 00:47:21,880
of this so I think we all deserve to be

1330
00:47:17,440 --> 00:47:23,470
gripped frequently so you know I hope

1331
00:47:21,880 --> 00:47:25,450
you can see that the value in in this

1332
00:47:23,470 --> 00:47:28,299
isn't really so gimmicky it's about how

1333
00:47:25,450 --> 00:47:29,919
can I create things that I can then work

1334
00:47:28,300 --> 00:47:32,140
on attacking and

1335
00:47:29,920 --> 00:47:34,360
really focus on what my attack process

1336
00:47:32,140 --> 00:47:36,940
is so after it's finished it will save

1337
00:47:34,360 --> 00:47:39,670
that document onto the desktop 4444 Khan

1338
00:47:36,940 --> 00:47:41,530
thanks and there's other tasks some

1339
00:47:39,670 --> 00:47:43,060
harder than others so as I said to you

1340
00:47:41,530 --> 00:47:46,330
before I wanted to emulate things like

1341
00:47:43,060 --> 00:47:47,890
RDP so that all run as tokens so that

1342
00:47:46,330 --> 00:47:50,020
these processes that are being spawned

1343
00:47:47,890 --> 00:47:52,540
by these things on in the context of

1344
00:47:50,020 --> 00:47:55,180
another user or I can screenshot people

1345
00:47:52,540 --> 00:47:57,610
interacting with things so that I I kind

1346
00:47:55,180 --> 00:47:59,140
of understand if they're using an

1347
00:47:57,610 --> 00:48:01,150
application what does that application

1348
00:47:59,140 --> 00:48:02,379
that like a really good red team a

1349
00:48:01,150 --> 00:48:04,660
friend of mine was saying that sometimes

1350
00:48:02,380 --> 00:48:06,760
he just watches so I'm just supporting

1351
00:48:04,660 --> 00:48:09,160
PowerShell from C&D because the blue was

1352
00:48:06,760 --> 00:48:11,050
difficult to see and it's interesting to

1353
00:48:09,160 --> 00:48:13,770
show and I'm just doing like a bits

1354
00:48:11,050 --> 00:48:16,120
transfer which is one way that I like to

1355
00:48:13,770 --> 00:48:17,920
download stuff so it's just basically

1356
00:48:16,120 --> 00:48:19,870
pulled down a text file which is from my

1357
00:48:17,920 --> 00:48:21,160
web server over a bitch transfer and

1358
00:48:19,870 --> 00:48:23,339
it's got the content and you can see

1359
00:48:21,160 --> 00:48:26,080
down the bottom that's the the head

1360
00:48:23,340 --> 00:48:27,370
header for connecting that and then I

1361
00:48:26,080 --> 00:48:28,660
started thinking well what else can we

1362
00:48:27,370 --> 00:48:30,609
do like Lawrence has mentioned a lot

1363
00:48:28,660 --> 00:48:34,770
about red Canary stuff so this is

1364
00:48:30,610 --> 00:48:37,900
basically executing The MITRE t.i 1063

1365
00:48:34,770 --> 00:48:39,310
example for security software discovery

1366
00:48:37,900 --> 00:48:41,590
so if you're a blue team and you've got

1367
00:48:39,310 --> 00:48:43,540
PowerShell logging on you can just back

1368
00:48:41,590 --> 00:48:45,400
check this stuff out there and see

1369
00:48:43,540 --> 00:48:46,120
whether in your logs you can find out

1370
00:48:45,400 --> 00:48:47,650
the fact

1371
00:48:46,120 --> 00:48:49,359
here is a person that's actually a

1372
00:48:47,650 --> 00:48:50,830
numerating the end point and as you can

1373
00:48:49,360 --> 00:48:52,330
see we've got a positive response with

1374
00:48:50,830 --> 00:48:55,029
the fact the fact that defender is

1375
00:48:52,330 --> 00:48:59,590
actually running there and they're more

1376
00:48:55,030 --> 00:49:02,230
complex tasks when it catches up so this

1377
00:48:59,590 --> 00:49:05,110
is quite hard like RDP because I kind of

1378
00:49:02,230 --> 00:49:07,240
fell into a like a rabbit hole of our

1379
00:49:05,110 --> 00:49:10,330
nested sub commands where I actually

1380
00:49:07,240 --> 00:49:12,100
wanted them to be able to enter commands

1381
00:49:10,330 --> 00:49:14,799
into the RDP sessions that they're then

1382
00:49:12,100 --> 00:49:17,020
creating and I've changed some of the

1383
00:49:14,800 --> 00:49:18,520
logic so that a book can do that it can

1384
00:49:17,020 --> 00:49:21,430
open up an RDP connection it can issue

1385
00:49:18,520 --> 00:49:23,500
commands into that and then mess around

1386
00:49:21,430 --> 00:49:24,759
with window focus and stuff I didn't

1387
00:49:23,500 --> 00:49:26,560
have an internet connection so that one

1388
00:49:24,760 --> 00:49:28,540
failed and then obviously we all you

1389
00:49:26,560 --> 00:49:31,180
know we see people storing credits in in

1390
00:49:28,540 --> 00:49:32,800
notepad regularly so so we can we can

1391
00:49:31,180 --> 00:49:35,589
stick some creds in there and that's all

1392
00:49:32,800 --> 00:49:37,540
that's all available to be logged and if

1393
00:49:35,590 --> 00:49:38,800
you look from the the Kobalt strike you

1394
00:49:37,540 --> 00:49:41,350
can see I've received a ton of those

1395
00:49:38,800 --> 00:49:43,900
keystrokes this she pulled is a fast

1396
00:49:41,350 --> 00:49:46,839
typer so she's probably a PA I say she

1397
00:49:43,900 --> 00:49:48,070
or he and you can see that these are the

1398
00:49:46,840 --> 00:49:49,330
keystrokes that I've captured so you

1399
00:49:48,070 --> 00:49:51,670
don't get all of it you can mess around

1400
00:49:49,330 --> 00:49:53,319
with this if you ramp up the the

1401
00:49:51,670 --> 00:49:56,170
milliseconds they typed slower and you

1402
00:49:53,320 --> 00:49:57,820
can get more key logging and if you

1403
00:49:56,170 --> 00:49:59,290
don't then you get fragments of that

1404
00:49:57,820 --> 00:50:03,670
information that you then have to sort

1405
00:49:59,290 --> 00:50:06,070
of ball back together so inclusion in

1406
00:50:03,670 --> 00:50:07,750
conclusion I think realistic labs will

1407
00:50:06,070 --> 00:50:09,190
help you develop your skills it's

1408
00:50:07,750 --> 00:50:11,500
certainly been a fun area for me to

1409
00:50:09,190 --> 00:50:14,740
explore a place where I can kind of get

1410
00:50:11,500 --> 00:50:16,630
an interactive relationship going with

1411
00:50:14,740 --> 00:50:18,279
it and I can test where I can see what I

1412
00:50:16,630 --> 00:50:20,230
would expect to work and what not

1413
00:50:18,280 --> 00:50:22,240
I want rich Active Directory

1414
00:50:20,230 --> 00:50:24,640
infrastructure full of information that

1415
00:50:22,240 --> 00:50:27,609
I don't know that I then have to go and

1416
00:50:24,640 --> 00:50:29,560
find and I think sheeple is a is a good

1417
00:50:27,610 --> 00:50:32,590
solution to sort of emulating user

1418
00:50:29,560 --> 00:50:34,480
behavior and I can continue to push the

1419
00:50:32,590 --> 00:50:38,530
boundaries of that I've got some ideas

1420
00:50:34,480 --> 00:50:40,480
for an actual official 1.0 release that

1421
00:50:38,530 --> 00:50:42,190
introduced the concept of profiles where

1422
00:50:40,480 --> 00:50:43,840
you apply a blue team profile and they

1423
00:50:42,190 --> 00:50:45,970
will actually pass the event logs and

1424
00:50:43,840 --> 00:50:47,320
maybe respond to actions based on what

1425
00:50:45,970 --> 00:50:48,700
they see like resetting all the

1426
00:50:47,320 --> 00:50:52,780
passwords and Active Directory would be

1427
00:50:48,700 --> 00:50:55,000
a warm solution so I can extend it big

1428
00:50:52,780 --> 00:50:56,920
thanks to Ed for all the chats about

1429
00:50:55,000 --> 00:50:57,619
this over slack of what I've ideas and

1430
00:50:56,920 --> 00:51:00,170
stuff and

1431
00:50:57,619 --> 00:51:03,410
the lorentz for everything pretty much

1432
00:51:00,170 --> 00:51:04,640
and thank you to 44 con 4 for letting me

1433
00:51:03,410 --> 00:51:06,170
speak it's the first time that I've

1434
00:51:04,640 --> 00:51:07,519
actually ever been to the conference so

1435
00:51:06,170 --> 00:51:10,720
to have the opportunity to speak here

1436
00:51:07,519 --> 00:51:16,700
has been it's been awesome thank you

1437
00:51:10,720 --> 00:51:16,700
[Applause]

1438
00:51:16,810 --> 00:51:38,009
[Music]

