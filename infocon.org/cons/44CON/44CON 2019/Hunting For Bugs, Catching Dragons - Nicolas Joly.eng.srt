1
00:00:03,360 --> 00:00:08,700
so thank you for having me quite happy

2
00:00:06,810 --> 00:00:11,639
to be here on stage that's my fourth

3
00:00:08,700 --> 00:00:14,279
time at 44 Khan and I thought that for

4
00:00:11,639 --> 00:00:16,500
once I should be I should come I should

5
00:00:14,279 --> 00:00:19,560
submit something and the on the stage to

6
00:00:16,500 --> 00:00:23,730
present so here I am with aunty for bugs

7
00:00:19,560 --> 00:00:26,400
catching dragons so my name is Nico I'm

8
00:00:23,730 --> 00:00:29,430
French I work for Microsoft Security

9
00:00:26,400 --> 00:00:33,769
Response Center in Cheltenham and part

10
00:00:29,430 --> 00:00:33,769
of the variability a mediation team

11
00:00:34,110 --> 00:00:40,350
I'm very sorry to look like a zombie I

12
00:00:37,040 --> 00:00:42,329
just have a baby with dirty fingers and

13
00:00:40,350 --> 00:00:45,930
I'm learning to be a daddy so hard way

14
00:00:42,329 --> 00:00:46,290
so sorry I tried to my best upgrade on

15
00:00:45,930 --> 00:00:50,130
dear

16
00:00:46,290 --> 00:00:53,940
don't be an issue so I'm going to talk

17
00:00:50,130 --> 00:00:58,800
about exploits burn books for affecting

18
00:00:53,940 --> 00:01:02,040
outlook and exchange so I thought we've

19
00:00:58,800 --> 00:01:03,750
outlook first so first part of this

20
00:01:02,040 --> 00:01:07,020
presentation will be focused on outlook

21
00:01:03,750 --> 00:01:09,119
I expect it to last around for 35

22
00:01:07,020 --> 00:01:13,798
minutes and then I spend on over 10

23
00:01:09,119 --> 00:01:17,310
minutes on an exchange so for those of

24
00:01:13,799 --> 00:01:19,469
you who have no idea of exploits in

25
00:01:17,310 --> 00:01:20,909
emails I hope you learn something this

26
00:01:19,469 --> 00:01:22,949
presentation for those of you who

27
00:01:20,909 --> 00:01:24,959
already have practiced practiced of it I

28
00:01:22,950 --> 00:01:27,659
hope you still learn something and for

29
00:01:24,959 --> 00:01:30,659
those of you who had already exploited

30
00:01:27,659 --> 00:01:34,740
there's these applications well you and

31
00:01:30,659 --> 00:01:38,849
I should talk after that talk because I

32
00:01:34,740 --> 00:01:40,199
don't know you so I expect I assume that

33
00:01:38,849 --> 00:01:43,469
you guys are not very familiar with

34
00:01:40,200 --> 00:01:47,609
Outlook exploits so I just show you

35
00:01:43,469 --> 00:01:50,538
something like shoulder yeah just a

36
00:01:47,609 --> 00:01:53,490
shorty move so try to think about it

37
00:01:50,539 --> 00:01:56,819
what according to you what's the worst

38
00:01:53,490 --> 00:01:58,408
case for Outlook it's an exploit

39
00:01:56,819 --> 00:02:00,419
affecting out what would be the worst

40
00:01:58,409 --> 00:02:02,039
case you would think I believe like

41
00:02:00,419 --> 00:02:04,319
something that's a preview pane you sin

42
00:02:02,039 --> 00:02:07,200
and you got an email and then you get it

43
00:02:04,319 --> 00:02:09,780
on the preview pen and then something

44
00:02:07,200 --> 00:02:11,730
happen and cat pups well look at this

45
00:02:09,780 --> 00:02:14,250
one you don't even need a preview pane

46
00:02:11,730 --> 00:02:15,929
to be honest you just receive an email

47
00:02:14,250 --> 00:02:18,390
and

48
00:02:15,930 --> 00:02:24,510
your client get ons that's one of the

49
00:02:18,390 --> 00:02:26,790
worst issues ever seen in my career this

50
00:02:24,510 --> 00:02:29,939
one is quite bad so I'm not going to

51
00:02:26,790 --> 00:02:34,230
talk about it but instead I will show

52
00:02:29,939 --> 00:02:36,030
over issues so no let's pretend that

53
00:02:34,230 --> 00:02:38,209
this never happened

54
00:02:36,030 --> 00:02:40,920
let's pretend that you haven't seen that

55
00:02:38,209 --> 00:02:45,150
try to think about there's these

56
00:02:40,920 --> 00:02:48,980
exploits affecting a make ions when I

57
00:02:45,150 --> 00:02:52,639
think about it I believe that the first

58
00:02:48,980 --> 00:02:56,040
thing that come to my mind are those

59
00:02:52,639 --> 00:02:58,290
warmth that we saw in the early 2000

60
00:02:56,040 --> 00:03:00,418
like typically I love you you would get

61
00:02:58,290 --> 00:03:05,099
an email with vbscript attachment you

62
00:03:00,419 --> 00:03:06,959
double click it and then that sorry

63
00:03:05,099 --> 00:03:09,388
there are so many people in the room and

64
00:03:06,959 --> 00:03:11,510
that it would just spread on spread

65
00:03:09,389 --> 00:03:15,419
again if there was one over I think in

66
00:03:11,510 --> 00:03:17,370
1997 name of dive heiress was CAC and

67
00:03:15,419 --> 00:03:19,560
this one was spreading with JavaScript

68
00:03:17,370 --> 00:03:21,569
signature she would send an email with a

69
00:03:19,560 --> 00:03:24,299
JavaScript signature and then it would

70
00:03:21,569 --> 00:03:26,488
just run JavaScript code and then Auto

71
00:03:24,299 --> 00:03:27,659
spread and that was quite a nice exploit

72
00:03:26,489 --> 00:03:31,909
as well

73
00:03:27,659 --> 00:03:36,780
but nothing more something more recently

74
00:03:31,909 --> 00:03:40,948
so we had - a good friend of mine he

75
00:03:36,780 --> 00:03:45,090
voted us an exploit that he named bad

76
00:03:40,949 --> 00:03:48,060
win mail in 2015 so basically he managed

77
00:03:45,090 --> 00:03:51,569
to find a way to build an email

78
00:03:48,060 --> 00:03:53,939
containing flash object and and we've

79
00:03:51,569 --> 00:03:58,858
known a flash vulnerability managed to

80
00:03:53,939 --> 00:04:01,799
get our C on this there's also that that

81
00:03:58,859 --> 00:04:04,620
person Ryan Hansen so you know it's a

82
00:04:01,799 --> 00:04:06,810
it's one day at the MS or C or and where

83
00:04:04,620 --> 00:04:08,970
I'm checking with you and suddenly I see

84
00:04:06,810 --> 00:04:11,609
a free mails from somebody that I don't

85
00:04:08,970 --> 00:04:13,199
know free image reporting bugs in my

86
00:04:11,609 --> 00:04:16,620
stuff outlook and I'm reading they're

87
00:04:13,199 --> 00:04:19,169
aware of the quick notes right if only

88
00:04:16,620 --> 00:04:21,750
half of this is true then then it's

89
00:04:19,168 --> 00:04:23,280
really bad it turns out that this guy

90
00:04:21,750 --> 00:04:25,919
was great and everything he said was

91
00:04:23,280 --> 00:04:27,650
true so this day we got three amazing

92
00:04:25,919 --> 00:04:29,690
varieties and then

93
00:04:27,650 --> 00:04:33,258
there is a lot class of issues varies

94
00:04:29,690 --> 00:04:35,389
those where we see the exploit and we

95
00:04:33,259 --> 00:04:37,580
just don't know that I took is affected

96
00:04:35,389 --> 00:04:39,259
I'm thinking for example about the

97
00:04:37,580 --> 00:04:42,258
exploits that we saw in the while

98
00:04:39,259 --> 00:04:46,520
targeting world about two three years

99
00:04:42,259 --> 00:04:50,840
ago Soviet actors where we're attacking

100
00:04:46,520 --> 00:04:53,210
people using world with with some funds

101
00:04:50,840 --> 00:04:56,359
so sending a document with a malicious

102
00:04:53,210 --> 00:04:58,659
fund the thing is that nobody never

103
00:04:56,360 --> 00:05:02,330
realized that this also apply to Outlook

104
00:04:58,660 --> 00:05:05,150
so that that leads us to the attack

105
00:05:02,330 --> 00:05:08,210
surface look it's quite big to be honest

106
00:05:05,150 --> 00:05:10,460
I think first about image so anything

107
00:05:08,210 --> 00:05:13,250
that is present in in an email it can be

108
00:05:10,460 --> 00:05:15,888
like it's a formatting like HTML can

109
00:05:13,250 --> 00:05:18,889
really sounds fun somebody in animal can

110
00:05:15,889 --> 00:05:20,530
be pictures can be links attachments of

111
00:05:18,889 --> 00:05:24,380
course don't want to double click them

112
00:05:20,530 --> 00:05:25,388
can be calendars can be all sort of

113
00:05:24,380 --> 00:05:29,389
things

114
00:05:25,389 --> 00:05:33,919
there are also protocols obviously SMTP

115
00:05:29,389 --> 00:05:34,910
pop3 the Exchange ActiveSync one there

116
00:05:33,919 --> 00:05:39,680
used to be an NTP

117
00:05:34,910 --> 00:05:42,380
but I think this one is gone also all

118
00:05:39,680 --> 00:05:45,470
the issues that relate to spoofing like

119
00:05:42,380 --> 00:05:48,469
fraud with certificates like anything

120
00:05:45,470 --> 00:05:51,860
that has to do with the identities etc

121
00:05:48,470 --> 00:05:53,990
etcetera and obviously while order

122
00:05:51,860 --> 00:05:55,039
remainings like we are doing with an

123
00:05:53,990 --> 00:05:57,680
office application

124
00:05:55,039 --> 00:05:59,659
so think about macros think for example

125
00:05:57,680 --> 00:06:02,539
about a scenario where you'd get an

126
00:05:59,659 --> 00:06:05,270
email and that he made would execute

127
00:06:02,539 --> 00:06:07,580
macro why I've never seen that and I

128
00:06:05,270 --> 00:06:10,099
hope that this does not exist but just

129
00:06:07,580 --> 00:06:13,789
have this in mind also I think about

130
00:06:10,099 --> 00:06:17,210
sans post their rulers attack so this

131
00:06:13,789 --> 00:06:20,930
was assuming that they had the control

132
00:06:17,210 --> 00:06:22,840
of box of yeah of a mailbox and they

133
00:06:20,930 --> 00:06:26,270
were trying to leverage that to get

134
00:06:22,840 --> 00:06:28,789
correction on on the client so obviously

135
00:06:26,270 --> 00:06:31,270
I just have 45 minutes here so I'm not

136
00:06:28,789 --> 00:06:35,900
going to talk about everything I just

137
00:06:31,270 --> 00:06:38,568
talked about the rich text format some

138
00:06:35,900 --> 00:06:41,239
early objects some attachments

139
00:06:38,569 --> 00:06:46,339
and of course a TNF and my key

140
00:06:41,240 --> 00:06:50,119
properties before I dive in whitey stock

141
00:06:46,339 --> 00:06:53,629
so I told you I'm I'm working for

142
00:06:50,119 --> 00:06:56,240
Microsoft so you might be thinking this

143
00:06:53,629 --> 00:06:58,599
guy he says he's from Microsoft and he's

144
00:06:56,240 --> 00:07:03,379
going to teach us how to hack outlook

145
00:06:58,599 --> 00:07:05,539
right well yes but that's not the point

146
00:07:03,379 --> 00:07:08,929
the point is that there are all these

147
00:07:05,539 --> 00:07:11,990
exploits out there and we don't know

148
00:07:08,929 --> 00:07:13,938
them occasionally we only receive good

149
00:07:11,990 --> 00:07:16,999
reports of run our riches but that's

150
00:07:13,939 --> 00:07:19,249
very that's very occasionally two days

151
00:07:16,999 --> 00:07:22,219
ago there was Patch Tuesday one bug was

152
00:07:19,249 --> 00:07:24,709
was fixed I believe this was a this one

153
00:07:22,219 --> 00:07:27,619
was interesting but there are all

154
00:07:24,709 --> 00:07:29,889
viewers so from time to time I'm bumping

155
00:07:27,619 --> 00:07:32,749
into someone and you say Oh Nico yeah

156
00:07:29,889 --> 00:07:33,469
last Patch Tuesday you killed three of

157
00:07:32,749 --> 00:07:35,539
my bugs

158
00:07:33,469 --> 00:07:37,009
that's that's bad because there's work

159
00:07:35,539 --> 00:07:41,419
with huh sorry for you man

160
00:07:37,009 --> 00:07:43,399
how do I kill the earth so why are

161
00:07:41,419 --> 00:07:44,599
people are not reporting to us is it

162
00:07:43,399 --> 00:07:47,719
because it's too difficult

163
00:07:44,599 --> 00:07:49,789
well yeah possibly I mean you don't have

164
00:07:47,719 --> 00:07:51,949
scripting in giant you know

165
00:07:49,789 --> 00:07:53,659
Dez made client it's not like you're

166
00:07:51,949 --> 00:07:55,610
attacking your browser it's not like

167
00:07:53,659 --> 00:07:56,779
you've got that's memory corruption that

168
00:07:55,610 --> 00:08:00,169
you are going to be able to leverage

169
00:07:56,779 --> 00:08:01,669
easily to get to get your exploits it's

170
00:08:00,169 --> 00:08:05,149
more difficult than that

171
00:08:01,669 --> 00:08:07,818
why else perhaps because there's no

172
00:08:05,149 --> 00:08:11,959
symbols for fees sorry this I cannot

173
00:08:07,819 --> 00:08:13,309
help you but still there are some good

174
00:08:11,959 --> 00:08:14,800
offers around where for example of

175
00:08:13,309 --> 00:08:16,939
friends at tipping point

176
00:08:14,800 --> 00:08:20,779
they are offering and there's nice

177
00:08:16,939 --> 00:08:24,259
bounties of exchange on Outlook 200k for

178
00:08:20,779 --> 00:08:27,199
Outlook 250 for external 0 diem also is

179
00:08:24,259 --> 00:08:31,339
buy is giving the same amount 250 for

180
00:08:27,199 --> 00:08:34,610
exchange or outlook so there is a very

181
00:08:31,339 --> 00:08:37,009
very very some place for some room for

182
00:08:34,610 --> 00:08:38,899
reserves how can we help or find us

183
00:08:37,009 --> 00:08:41,930
let's just talk about war on research

184
00:08:38,899 --> 00:08:43,818
and things that we've seen so that's why

185
00:08:41,929 --> 00:08:46,189
I will be presenting things I've seen

186
00:08:43,818 --> 00:08:48,019
myself and things that people have been

187
00:08:46,189 --> 00:08:50,719
reporting us and obviously quick

188
00:08:48,019 --> 00:08:51,779
disclaimer everything that has been that

189
00:08:50,720 --> 00:08:55,490
his

190
00:08:51,779 --> 00:08:58,529
and here as obviously being fixed info

191
00:08:55,490 --> 00:09:01,639
so we're sure we'll start avoid that

192
00:08:58,529 --> 00:09:05,670
slides from jefes plantation contact

193
00:09:01,639 --> 00:09:08,339
two-year today two years ago so when you

194
00:09:05,670 --> 00:09:11,878
when you start looking for outlook

195
00:09:08,339 --> 00:09:14,819
features you quickly figure that very

196
00:09:11,879 --> 00:09:16,980
something called t nif emails and when

197
00:09:14,819 --> 00:09:19,740
you google that I think that the first

198
00:09:16,980 --> 00:09:24,019
link that you see is a page from

199
00:09:19,740 --> 00:09:27,509
Microsoft describing as a gif format and

200
00:09:24,019 --> 00:09:30,540
among other things that are set on this

201
00:09:27,509 --> 00:09:33,629
page there is this it's just a container

202
00:09:30,540 --> 00:09:35,160
for Outlook special features and this is

203
00:09:33,629 --> 00:09:37,559
exactly what we are after

204
00:09:35,160 --> 00:09:41,969
who after these features that give you a

205
00:09:37,559 --> 00:09:45,300
remote code execution so what Jenny a

206
00:09:41,970 --> 00:09:48,509
female suggests I just just a container

207
00:09:45,300 --> 00:09:51,269
basically so you've got your client and

208
00:09:48,509 --> 00:09:53,519
you select you can choose the format of

209
00:09:51,269 --> 00:09:55,529
your email if your HTML plain text or

210
00:09:53,519 --> 00:09:57,750
rich text format you choose reach that

211
00:09:55,529 --> 00:10:00,120
format you send it and then on the other

212
00:09:57,750 --> 00:10:02,610
side you get this email for example you

213
00:10:00,120 --> 00:10:05,879
check on the server and there is the

214
00:10:02,610 --> 00:10:08,370
thing meme hitters and then some content

215
00:10:05,879 --> 00:10:10,490
you see application and stn yes and you

216
00:10:08,370 --> 00:10:13,290
wonder what it is something encoded by

217
00:10:10,490 --> 00:10:16,980
64dd cut that and then there's these two

218
00:10:13,290 --> 00:10:22,860
levers just like a file with some

219
00:10:16,980 --> 00:10:26,009
binaries so obviously what is this so as

220
00:10:22,860 --> 00:10:29,579
we've most of my stuff formats

221
00:10:26,009 --> 00:10:33,480
this one is publicly documented it's

222
00:10:29,579 --> 00:10:35,309
quite easy to follow so just a roof is

223
00:10:33,480 --> 00:10:39,870
just a sequence of objects and

224
00:10:35,309 --> 00:10:42,779
attributes that that are that are in in

225
00:10:39,870 --> 00:10:46,769
a file basically so for this research I

226
00:10:42,779 --> 00:10:51,829
built our no.100 template so I've been

227
00:10:46,769 --> 00:10:51,829
asked if this thing was

228
00:10:51,850 --> 00:10:57,710
so it's not public but I've got a deal

229
00:10:54,890 --> 00:11:00,410
for you you send me a good bug and I

230
00:10:57,710 --> 00:11:06,020
published it and an intern you'd get

231
00:11:00,410 --> 00:11:09,969
also a nice blog post right so there is

232
00:11:06,020 --> 00:11:13,430
often a confusion between a TAF and RTF

233
00:11:09,970 --> 00:11:15,320
so when you send that email in a rich

234
00:11:13,430 --> 00:11:17,359
text format you might have the thing

235
00:11:15,320 --> 00:11:20,600
that you're just sending an RTF document

236
00:11:17,360 --> 00:11:22,670
it's partly true you're sending that RTF

237
00:11:20,600 --> 00:11:24,920
document but it's actually embedded in

238
00:11:22,670 --> 00:11:27,020
that gif container so yeah you're saying

239
00:11:24,920 --> 00:11:31,520
this RTF along with many other

240
00:11:27,020 --> 00:11:33,860
properties this RTF document is embedded

241
00:11:31,520 --> 00:11:37,460
in that clear RTF compress properties

242
00:11:33,860 --> 00:11:40,040
various anchor dings first one is as one

243
00:11:37,460 --> 00:11:43,970
by default the compressed one so a

244
00:11:40,040 --> 00:11:46,939
custom lzma anchoring and the other one

245
00:11:43,970 --> 00:11:48,920
is something that you normally don't see

246
00:11:46,940 --> 00:11:50,600
because I don't believe that with VRI

247
00:11:48,920 --> 00:11:57,310
it's possible to send those emails so

248
00:11:50,600 --> 00:11:57,310
melih just a plain text email sorry

249
00:11:57,910 --> 00:12:03,500
usually occasionally we get cases where

250
00:12:02,360 --> 00:12:06,110
or finder

251
00:12:03,500 --> 00:12:09,310
I've been fuzzing of finders I've been

252
00:12:06,110 --> 00:12:13,040
the fuzzing as an MSG file format and

253
00:12:09,310 --> 00:12:16,250
and most of the time it's this is just

254
00:12:13,040 --> 00:12:18,800
because they say first the so compressed

255
00:12:16,250 --> 00:12:20,780
part and my stringer some random memory

256
00:12:18,800 --> 00:12:22,520
corruption well most of time this is

257
00:12:20,780 --> 00:12:24,800
going to fail because the parser is

258
00:12:22,520 --> 00:12:27,680
quite pedantic so if you want to first

259
00:12:24,800 --> 00:12:30,290
this part just use for example view out

260
00:12:27,680 --> 00:12:33,620
looking interrupts library it will help

261
00:12:30,290 --> 00:12:36,620
you just select your RTF file and send

262
00:12:33,620 --> 00:12:39,680
it on the wire so it's much easier and

263
00:12:36,620 --> 00:12:42,620
it will just give you much much false

264
00:12:39,680 --> 00:12:43,579
positive than just facing as herb is a

265
00:12:42,620 --> 00:12:45,709
bits waiver

266
00:12:43,580 --> 00:12:47,720
like a shotgun activity things that we

267
00:12:45,709 --> 00:12:49,219
see it still works because we are still

268
00:12:47,720 --> 00:12:52,970
fixing those cases I think there was one

269
00:12:49,220 --> 00:12:57,170
fixed about a months ago but most of

270
00:12:52,970 --> 00:13:00,950
time it won't give you any results so

271
00:12:57,170 --> 00:13:03,819
now let's talk about some examples of

272
00:13:00,950 --> 00:13:07,990
issues that we've seen a thinking out

273
00:13:03,820 --> 00:13:10,780
so when I'm talking about RTF I'm also

274
00:13:07,990 --> 00:13:14,200
talking about world because outlook uses

275
00:13:10,780 --> 00:13:15,189
the world core library to parse those

276
00:13:14,200 --> 00:13:18,400
RTF emails

277
00:13:15,190 --> 00:13:19,510
so anything that effect word that word

278
00:13:18,400 --> 00:13:22,060
parser that world

279
00:13:19,510 --> 00:13:25,510
RTF parser might also affect Outlook

280
00:13:22,060 --> 00:13:27,880
that's why occasionally when there is an

281
00:13:25,510 --> 00:13:30,250
issue of it in the RTF file format you

282
00:13:27,880 --> 00:13:33,460
will see that Bolton that we published

283
00:13:30,250 --> 00:13:35,440
are critical and not important it's

284
00:13:33,460 --> 00:13:38,860
because most of the time this code can

285
00:13:35,440 --> 00:13:42,520
also be reached from Outlook and the

286
00:13:38,860 --> 00:13:44,740
preview pane so now think about the RTF

287
00:13:42,520 --> 00:13:48,939
specifications there might be things

288
00:13:44,740 --> 00:13:51,400
that that shouldn't be found in in

289
00:13:48,940 --> 00:13:54,010
Outlook but should still be finding in

290
00:13:51,400 --> 00:13:57,069
world and that leads me to the template

291
00:13:54,010 --> 00:13:59,800
keyword I didn't find that one right now

292
00:13:57,070 --> 00:14:05,290
in Leda so what do you figure out so it

293
00:13:59,800 --> 00:14:08,260
was 2000 2017 I think he found a way he

294
00:14:05,290 --> 00:14:12,010
figure out that it was possible to send

295
00:14:08,260 --> 00:14:15,040
an email in RTF that has these this

296
00:14:12,010 --> 00:14:16,780
template a keyword in it and then you

297
00:14:15,040 --> 00:14:19,959
would point that home plate somewhere

298
00:14:16,780 --> 00:14:22,360
for example over on the web like with

299
00:14:19,960 --> 00:14:24,010
HTTP on our remote chair and then in

300
00:14:22,360 --> 00:14:26,380
that template you would embed a flash

301
00:14:24,010 --> 00:14:29,319
object and so he figured out that even

302
00:14:26,380 --> 00:14:32,140
if hi face but we might had been fixed

303
00:14:29,320 --> 00:14:34,270
there was still a path one possible way

304
00:14:32,140 --> 00:14:36,910
to get codecs efficient with flash and

305
00:14:34,270 --> 00:14:41,110
and he was true because if you look at

306
00:14:36,910 --> 00:14:43,180
the code you can see that we fixed the

307
00:14:41,110 --> 00:14:44,920
way that outlook was supposed to

308
00:14:43,180 --> 00:14:46,750
instantiate objects but we didn't

309
00:14:44,920 --> 00:14:49,930
realize that was also possible to get

310
00:14:46,750 --> 00:14:54,070
the same behavior using templates and so

311
00:14:49,930 --> 00:14:56,469
that was amazing but there's not only

312
00:14:54,070 --> 00:14:58,780
the problem with these objects think

313
00:14:56,470 --> 00:15:00,490
about the templates yours you can just

314
00:14:58,780 --> 00:15:03,430
put whatever you want here

315
00:15:00,490 --> 00:15:05,040
like for example a link on the web share

316
00:15:03,430 --> 00:15:10,359
and then

317
00:15:05,040 --> 00:15:12,610
you guys like it getting the anti lmf

318
00:15:10,360 --> 00:15:15,550
for example and then that's an easier

319
00:15:12,610 --> 00:15:18,460
and that's an easy win there's also the

320
00:15:15,550 --> 00:15:21,280
fact that in that case you just extend

321
00:15:18,460 --> 00:15:25,720
the attack surface suddenly you are able

322
00:15:21,280 --> 00:15:29,829
to be able to have Outlook load every

323
00:15:25,720 --> 00:15:34,090
binary formats that world supports XML

324
00:15:29,830 --> 00:15:36,460
HTML legacy binary formats everything so

325
00:15:34,090 --> 00:15:38,710
just all of a sudden everything that

326
00:15:36,460 --> 00:15:40,900
affects world also affects outage so

327
00:15:38,710 --> 00:15:42,940
which means that that's very bad

328
00:15:40,900 --> 00:15:45,660
I never issues affecting this template

329
00:15:42,940 --> 00:15:48,550
this one have I found it myself

330
00:15:45,660 --> 00:15:50,980
so say that you've got a document that

331
00:15:48,550 --> 00:15:52,839
that is linked to a template and these

332
00:15:50,980 --> 00:15:55,330
templates point to another template with

333
00:15:52,840 --> 00:15:58,150
the same name but for some reason this

334
00:15:55,330 --> 00:16:00,370
template is an accessible for example

335
00:15:58,150 --> 00:16:03,430
it's sit on a remote chair and then you

336
00:16:00,370 --> 00:16:06,520
don't have you don't have access to to

337
00:16:03,430 --> 00:16:08,800
go to that chair so that we just trigger

338
00:16:06,520 --> 00:16:11,500
a nice use after free in Outlook can you

339
00:16:08,800 --> 00:16:13,870
all world can you exploit that it's

340
00:16:11,500 --> 00:16:15,460
probably complicated but what as you can

341
00:16:13,870 --> 00:16:19,000
guess there are lots of issues affecting

342
00:16:15,460 --> 00:16:21,610
the template keyword and so what do we

343
00:16:19,000 --> 00:16:23,350
think happened there yeah for once we

344
00:16:21,610 --> 00:16:24,900
just remove the feature it's not

345
00:16:23,350 --> 00:16:27,760
something that we often see usually

346
00:16:24,900 --> 00:16:29,980
teams try to fix the issue but there are

347
00:16:27,760 --> 00:16:32,740
cases where we just remove the feature

348
00:16:29,980 --> 00:16:36,250
because yeah it doesn't need to be there

349
00:16:32,740 --> 00:16:40,030
I come back no to the outlook interrupt

350
00:16:36,250 --> 00:16:42,400
library so if you like c-sharp it's

351
00:16:40,030 --> 00:16:45,579
probably the easiest way to build an

352
00:16:42,400 --> 00:16:47,860
email so look at look at this this piece

353
00:16:45,580 --> 00:16:49,570
of code very something here called the

354
00:16:47,860 --> 00:16:51,910
message class property so basically

355
00:16:49,570 --> 00:16:55,089
everything here is properly documented

356
00:16:51,910 --> 00:16:58,209
so just go on on Microsoft website and

357
00:16:55,089 --> 00:17:01,300
your finals documentation there so look

358
00:16:58,210 --> 00:17:04,060
at this message place it said IPM

359
00:17:01,300 --> 00:17:08,909
contact so what is that exactly if you

360
00:17:04,060 --> 00:17:11,889
send a DC mail and if you receive it on

361
00:17:08,910 --> 00:17:15,130
the off lock side you will get this

362
00:17:11,890 --> 00:17:17,820
instead of having your email with your

363
00:17:15,130 --> 00:17:20,490
text you will see the contact form

364
00:17:17,819 --> 00:17:24,060
well it's possible with Outlook and with

365
00:17:20,490 --> 00:17:28,200
a gif format to send basically whatever

366
00:17:24,060 --> 00:17:30,899
forms that outlook support on a wire so

367
00:17:28,200 --> 00:17:35,490
they are like contact forms calendars

368
00:17:30,900 --> 00:17:37,490
tasks well many of them and what's

369
00:17:35,490 --> 00:17:41,100
interesting is that each of this form

370
00:17:37,490 --> 00:17:43,560
each of these forms as its own

371
00:17:41,100 --> 00:17:46,350
properties and its own code for example

372
00:17:43,560 --> 00:17:48,360
this one on the top right corner there

373
00:17:46,350 --> 00:17:50,610
is a picture and you're going to say

374
00:17:48,360 --> 00:17:52,020
yeah but what's what's the benefit of

375
00:17:50,610 --> 00:17:54,000
this because if you send an email you

376
00:17:52,020 --> 00:17:57,840
can already include pictures that's

377
00:17:54,000 --> 00:18:00,120
right the thing is here outlook is not

378
00:17:57,840 --> 00:18:02,669
using as a standard path to parse that

379
00:18:00,120 --> 00:18:07,080
picture instead it's using the GDI GDI

380
00:18:02,670 --> 00:18:08,910
plus stack instead of just VLC stack

381
00:18:07,080 --> 00:18:11,100
which means that if you've got a

382
00:18:08,910 --> 00:18:13,590
vulnerability or an exploit affecting

383
00:18:11,100 --> 00:18:16,080
the GDI stack in Windows then you might

384
00:18:13,590 --> 00:18:16,560
also be able to use it here in that

385
00:18:16,080 --> 00:18:20,760
email

386
00:18:16,560 --> 00:18:23,100
there are over like things specific to

387
00:18:20,760 --> 00:18:25,320
as well as those properties but be aware

388
00:18:23,100 --> 00:18:27,360
that when you do that there might be

389
00:18:25,320 --> 00:18:33,330
hidden features that you might be able

390
00:18:27,360 --> 00:18:37,050
to to to exploit so as I said they're

391
00:18:33,330 --> 00:18:40,740
old as old as me such class all these

392
00:18:37,050 --> 00:18:42,960
message classes and more can be found on

393
00:18:40,740 --> 00:18:45,240
that websites there they are even some

394
00:18:42,960 --> 00:18:48,300
that are not documented but you guys are

395
00:18:45,240 --> 00:18:52,260
reversers you know how to find them just

396
00:18:48,300 --> 00:18:54,389
look for strings in a binary let's talk

397
00:18:52,260 --> 00:18:57,720
about issues now affecting there's

398
00:18:54,390 --> 00:19:01,110
classes so receive that one I think it

399
00:18:57,720 --> 00:19:04,680
was summer 2016 in ballot so eighteen

400
00:19:01,110 --> 00:19:07,320
Sterman he reported an email using the

401
00:19:04,680 --> 00:19:08,850
IP and remote class and this was

402
00:19:07,320 --> 00:19:11,669
triggering just a null pointer and

403
00:19:08,850 --> 00:19:13,949
pivoting so for bugs like this we are

404
00:19:11,670 --> 00:19:16,440
not going to issue a CVD because they

405
00:19:13,950 --> 00:19:19,560
don't they don't qualify for our so this

406
00:19:16,440 --> 00:19:22,140
is just a motorized issue but city-state

407
00:19:19,560 --> 00:19:25,230
interesting cause at least it shows some

408
00:19:22,140 --> 00:19:28,460
hidden behavior things that shouldn't

409
00:19:25,230 --> 00:19:31,210
happen and see it made it

410
00:19:28,460 --> 00:19:35,139
to this foundation today - Frank's agian

411
00:19:31,210 --> 00:19:37,759
I'm going to spend more time no showing

412
00:19:35,139 --> 00:19:41,119
talking about the ITIN document classes

413
00:19:37,759 --> 00:19:44,539
so this one again was submitted to us by

414
00:19:41,119 --> 00:19:47,269
Ryan Ryan Hansen so imagine an email

415
00:19:44,539 --> 00:19:50,509
where you have two attachments

416
00:19:47,269 --> 00:19:53,360
- or documents attached so one is a

417
00:19:50,509 --> 00:19:56,360
normal RTF file and the other one is

418
00:19:53,360 --> 00:19:58,269
that IBM document things when you open

419
00:19:56,360 --> 00:20:01,908
the first one the first attachment

420
00:19:58,269 --> 00:20:04,490
you'll see world pop up but war will pop

421
00:20:01,909 --> 00:20:06,980
up in in protective mode in predictive

422
00:20:04,490 --> 00:20:09,649
view so this is fine however in the

423
00:20:06,980 --> 00:20:12,730
other one a protected view won't be

424
00:20:09,649 --> 00:20:16,639
started and you will you will have world

425
00:20:12,730 --> 00:20:19,299
just popping in medium integrity so

426
00:20:16,639 --> 00:20:23,629
which means that some box is not gone so

427
00:20:19,299 --> 00:20:26,418
I'm very sore so that over case opening

428
00:20:23,629 --> 00:20:28,730
sending mail sending emails and having

429
00:20:26,419 --> 00:20:31,879
office document running without user

430
00:20:28,730 --> 00:20:33,590
interaction so I'm going to just quickly

431
00:20:31,879 --> 00:20:36,230
if you want to try that that's a balk

432
00:20:33,590 --> 00:20:38,928
I'm going to show you a demo of these

433
00:20:36,230 --> 00:20:43,840
two cases combined so send that say that

434
00:20:38,929 --> 00:20:45,740
you've sent an email instead of just

435
00:20:43,840 --> 00:20:47,990
having some text

436
00:20:45,740 --> 00:20:50,389
you've got word that shows that in the

437
00:20:47,990 --> 00:20:53,269
preview pane that's fine so this one is

438
00:20:50,389 --> 00:20:57,678
running in that container so pretty view

439
00:20:53,269 --> 00:20:59,690
is correctly open he's quickly starting

440
00:20:57,679 --> 00:21:02,690
on the side no what do you think happen

441
00:20:59,690 --> 00:21:05,029
if you double click that email then

442
00:21:02,690 --> 00:21:07,340
something else is going to happen word

443
00:21:05,029 --> 00:21:09,830
will show up but this time using a

444
00:21:07,340 --> 00:21:11,840
sukham automation and if you look at it

445
00:21:09,830 --> 00:21:16,158
you will see that practice view is now

446
00:21:11,840 --> 00:21:19,580
gone you guys are reversers so you're a

447
00:21:16,159 --> 00:21:22,369
big curse of how this works so I've got

448
00:21:19,580 --> 00:21:25,009
another demo for you this is all about

449
00:21:22,369 --> 00:21:27,889
calm stuff and if you look at the code

450
00:21:25,009 --> 00:21:30,230
you'll see that word was launched in the

451
00:21:27,889 --> 00:21:32,090
first demo with automation because at

452
00:21:30,230 --> 00:21:33,950
some point there is a class ID says that

453
00:21:32,090 --> 00:21:35,928
yet that's a whirl document with what

454
00:21:33,950 --> 00:21:38,640
happens if you send another class ID

455
00:21:35,929 --> 00:21:41,070
that typically the equation

456
00:21:38,640 --> 00:21:43,440
enter society so remember about two

457
00:21:41,070 --> 00:21:46,050
years ago we had des exploit involving

458
00:21:43,440 --> 00:21:48,870
the equation editor it was just possible

459
00:21:46,050 --> 00:21:51,000
to trigger that in Outlook not zero

460
00:21:48,870 --> 00:21:54,060
click just one click away so be aware

461
00:21:51,000 --> 00:21:56,250
that when their exploits like this that

462
00:21:54,060 --> 00:21:59,960
effect words sometimes it's also

463
00:21:56,250 --> 00:22:01,260
possible to have them work on Outlook

464
00:21:59,960 --> 00:22:04,440
all right

465
00:22:01,260 --> 00:22:07,379
I'm now going to move slowly to all the

466
00:22:04,440 --> 00:22:09,720
objects but first let me talk about the

467
00:22:07,380 --> 00:22:11,820
other file format that outlook support

468
00:22:09,720 --> 00:22:13,890
so I've just been talking about the

469
00:22:11,820 --> 00:22:16,350
email format basically dot Idi Amin

470
00:22:13,890 --> 00:22:19,260
there's another one that autumn supports

471
00:22:16,350 --> 00:22:21,000
a message file format several ways to

472
00:22:19,260 --> 00:22:23,310
generate the slice for example

473
00:22:21,000 --> 00:22:25,170
copy/paste from the client to the

474
00:22:23,310 --> 00:22:27,540
desktop or you can also use the

475
00:22:25,170 --> 00:22:31,290
interrupt library to just generate that

476
00:22:27,540 --> 00:22:33,270
this one is is good in a way that it

477
00:22:31,290 --> 00:22:36,180
will give you everything that has been

478
00:22:33,270 --> 00:22:38,760
generated in that code if you do the

479
00:22:36,180 --> 00:22:40,380
copy paste from outlook client to

480
00:22:38,760 --> 00:22:43,710
desktop sometimes you're losing some

481
00:22:40,380 --> 00:22:46,590
information so bear that in mind so when

482
00:22:43,710 --> 00:22:51,740
you do that and when you try to open

483
00:22:46,590 --> 00:22:54,689
this this message format you'll see that

484
00:22:51,740 --> 00:22:56,730
this is actually an Ori storage that you

485
00:22:54,690 --> 00:22:59,700
have so just not a random binary file

486
00:22:56,730 --> 00:23:01,920
Noorie storage consisting of streams and

487
00:22:59,700 --> 00:23:06,390
stop storage notice for examples of

488
00:23:01,920 --> 00:23:10,380
property versions 1.0 top stream I come

489
00:23:06,390 --> 00:23:13,070
back to it in a in a second might be

490
00:23:10,380 --> 00:23:17,010
properties might be properties are

491
00:23:13,070 --> 00:23:19,590
essentially described by three three

492
00:23:17,010 --> 00:23:26,580
different properties so first one is the

493
00:23:19,590 --> 00:23:29,790
PID so here for example 1 1 a1 F it's

494
00:23:26,580 --> 00:23:33,270
also described by its type here 1 F for

495
00:23:29,790 --> 00:23:37,889
a Unicode string and its value so here

496
00:23:33,270 --> 00:23:40,110
I'd handle text so the two types follows

497
00:23:37,890 --> 00:23:42,840
of windows Barn types so it's very easy

498
00:23:40,110 --> 00:23:46,949
to read them free for an integer 5 for

499
00:23:42,840 --> 00:23:49,050
float etc etc etc so what the

500
00:23:46,950 --> 00:23:50,890
relationship between V my file format

501
00:23:49,050 --> 00:23:54,158
and the research performance

502
00:23:50,890 --> 00:23:56,409
look at the properties is the first

503
00:23:54,159 --> 00:23:59,590
trainer superb diversion stream and

504
00:23:56,409 --> 00:24:01,899
you'll see for example this this

505
00:23:59,590 --> 00:24:05,230
property so everything in that stream is

506
00:24:01,899 --> 00:24:07,389
encoded on 16 bytes so for example for

507
00:24:05,230 --> 00:24:09,760
this property which is an integer you

508
00:24:07,390 --> 00:24:13,360
see the value at offset plus sites who

509
00:24:09,760 --> 00:24:16,330
are here just a sequence of zeros for it

510
00:24:13,360 --> 00:24:19,360
for this one which is a string and each

511
00:24:16,330 --> 00:24:24,639
size is set to 12 so obviously there's

512
00:24:19,360 --> 00:24:27,549
not enough room for 4 for it to be

513
00:24:24,639 --> 00:24:30,370
contained in that stream so outlook will

514
00:24:27,549 --> 00:24:33,250
just create another stream for you so if

515
00:24:30,370 --> 00:24:37,750
you want to first this 5 format just be

516
00:24:33,250 --> 00:24:42,070
aware of des des specificities because

517
00:24:37,750 --> 00:24:44,679
otherwise you will just like hit the

518
00:24:42,070 --> 00:24:49,649
parsers and and we it will just render

519
00:24:44,679 --> 00:24:52,690
nothing so you will just lose your time

520
00:24:49,649 --> 00:24:54,779
let's come now to view the objects so

521
00:24:52,690 --> 00:24:57,580
from Haifa is research we know that it's

522
00:24:54,779 --> 00:25:01,149
unfortunately possible to embed some

523
00:24:57,580 --> 00:25:03,879
objects in an email for example des

524
00:25:01,149 --> 00:25:07,209
objects if you follow the windows

525
00:25:03,880 --> 00:25:10,929
variant types they can be a ver and they

526
00:25:07,210 --> 00:25:14,470
can end a ver with 0 9 or 0 D so in

527
00:25:10,929 --> 00:25:18,389
Outlook they all end with 0 so here

528
00:25:14,470 --> 00:25:19,600
you've got this property which I forgot

529
00:25:18,389 --> 00:25:24,250
something

530
00:25:19,600 --> 00:25:28,350
37 Oh 100 D which means that you've got

531
00:25:24,250 --> 00:25:31,750
an substrate an object and some subs

532
00:25:28,350 --> 00:25:34,629
subs over sub storages or over streams

533
00:25:31,750 --> 00:25:36,279
in it and this is interesting in this

534
00:25:34,630 --> 00:25:39,159
research because when you are dealing

535
00:25:36,279 --> 00:25:43,750
with all the objects you are dealing

536
00:25:39,159 --> 00:25:45,399
with all the functions that are in 32 so

537
00:25:43,750 --> 00:25:48,340
I appreciate that you don't have the

538
00:25:45,399 --> 00:25:51,219
symbols for office but you do have those

539
00:25:48,340 --> 00:25:53,439
for Windows and if you're curious you

540
00:25:51,220 --> 00:25:57,549
can just put your breakpoints on the

541
00:25:53,440 --> 00:25:59,710
usual suspects essentially here read

542
00:25:57,549 --> 00:26:01,950
message class or you open storage or

543
00:25:59,710 --> 00:26:03,750
even or loader and

544
00:26:01,950 --> 00:26:06,240
if you do that you realize quickly that

545
00:26:03,750 --> 00:26:09,149
we are I think three plus IDs that are

546
00:26:06,240 --> 00:26:12,299
under the differently in Outlook first

547
00:26:09,149 --> 00:26:14,459
ones are for samhita files I think one

548
00:26:12,299 --> 00:26:18,870
is for a bitmap pictures and the last

549
00:26:14,460 --> 00:26:22,080
one is for the only standard ink now you

550
00:26:18,870 --> 00:26:24,120
see where I'm going back I think two

551
00:26:22,080 --> 00:26:27,539
years ago we saw all these exploits

552
00:26:24,120 --> 00:26:30,000
involving communica most of them were

553
00:26:27,539 --> 00:26:32,370
just embedded in world documents or

554
00:26:30,000 --> 00:26:34,559
Excel documents I don't believe that

555
00:26:32,370 --> 00:26:37,229
anybody noticed that it was also

556
00:26:34,559 --> 00:26:40,710
possible to trigger the same attacks in

557
00:26:37,230 --> 00:26:43,909
Outlook unfortunately so the attacks

558
00:26:40,710 --> 00:26:49,230
that I'm now going to show you our

559
00:26:43,909 --> 00:26:51,690
coming from these disco monitors so just

560
00:26:49,230 --> 00:26:53,610
if you look a bit at the code you'll see

561
00:26:51,690 --> 00:26:57,029
that from early load once you've

562
00:26:53,610 --> 00:27:00,269
modified the or v01 holy stream you are

563
00:26:57,029 --> 00:27:02,340
able to hit this code all the ring

564
00:27:00,269 --> 00:27:04,500
moniker stream which in Vienna

565
00:27:02,340 --> 00:27:06,449
I just called Ali load from China if you

566
00:27:04,500 --> 00:27:09,269
look at the documentation this is just

567
00:27:06,450 --> 00:27:12,120
about reading an object from a stream

568
00:27:09,269 --> 00:27:15,360
and instantiate it on the I persist

569
00:27:12,120 --> 00:27:18,510
stream interface how would we explain

570
00:27:15,360 --> 00:27:23,279
that wilt oh man I think was the first

571
00:27:18,510 --> 00:27:25,049
one to report that behavior to us so two

572
00:27:23,279 --> 00:27:28,919
years three years ago maybe he noticed

573
00:27:25,049 --> 00:27:31,408
that if we use Outlook 97 or maybe out

574
00:27:28,919 --> 00:27:34,260
loop 2000 it was possible to send an

575
00:27:31,409 --> 00:27:36,649
email with a link to an object and in

576
00:27:34,260 --> 00:27:39,539
that link you would specify a path on

577
00:27:36,649 --> 00:27:42,418
remote share for example and he noticed

578
00:27:39,539 --> 00:27:45,658
that if you do that when the victim

579
00:27:42,419 --> 00:27:48,480
would open that email in his ultra

580
00:27:45,659 --> 00:27:51,029
client then we were shocked you could

581
00:27:48,480 --> 00:27:53,610
see some traffic going to that to that

582
00:27:51,029 --> 00:27:56,309
web share and and then the IP address

583
00:27:53,610 --> 00:27:58,320
along with for example Vientiane - would

584
00:27:56,309 --> 00:28:00,629
be leaked and so she was worried buddies

585
00:27:58,320 --> 00:28:03,658
and that was that was a legitimate

586
00:28:00,630 --> 00:28:07,139
worried and then he figured out that if

587
00:28:03,659 --> 00:28:09,779
you even have missing be variabilities

588
00:28:07,139 --> 00:28:10,860
it was also possible to trigger it just

589
00:28:09,779 --> 00:28:13,350
with it so

590
00:28:10,860 --> 00:28:16,049
I'm talking about SMB client varieties

591
00:28:13,350 --> 00:28:17,760
so his attack here was just usin you

592
00:28:16,049 --> 00:28:21,960
sent an email and then this immolate is

593
00:28:17,760 --> 00:28:24,690
going to just blue screen your your your

594
00:28:21,960 --> 00:28:28,169
box that's annoying it's not on our C

595
00:28:24,690 --> 00:28:29,880
but still it's annoying there is more

596
00:28:28,169 --> 00:28:33,630
that you can do if the fine manager if

597
00:28:29,880 --> 00:28:35,789
you have ever reversed it varies that

598
00:28:33,630 --> 00:28:37,860
that that function that is called at

599
00:28:35,789 --> 00:28:40,110
some point every store shall link so

600
00:28:37,860 --> 00:28:43,649
what is that thing doing you know about

601
00:28:40,110 --> 00:28:46,320
windows shortcuts it's actually possible

602
00:28:43,649 --> 00:28:48,539
to embed dead to embed them in there's

603
00:28:46,320 --> 00:28:50,939
five monitors and he'd say that we've

604
00:28:48,539 --> 00:28:53,639
got a variety affecting windows

605
00:28:50,940 --> 00:28:56,250
shortcuts and that still happen one was

606
00:28:53,639 --> 00:28:59,129
predicted two days ago it's definitely

607
00:28:56,250 --> 00:29:01,409
possible to trigger it in Outlook so is

608
00:28:59,130 --> 00:29:04,740
it possible to load a remote library

609
00:29:01,409 --> 00:29:06,389
with it like we saw with subnet I don't

610
00:29:04,740 --> 00:29:09,510
know I haven't tried it but I'm assuming

611
00:29:06,389 --> 00:29:12,570
that potentially it is just to say that

612
00:29:09,510 --> 00:29:16,320
there are always things hidden here and

613
00:29:12,570 --> 00:29:26,250
there that might be able to to to figure

614
00:29:16,320 --> 00:29:29,189
on out I'm not going to talk about

615
00:29:26,250 --> 00:29:31,620
another moniker V of drive one so I did

616
00:29:29,190 --> 00:29:36,000
that research about three years ago yes

617
00:29:31,620 --> 00:29:38,070
summer 2016 and at that time I didn't

618
00:29:36,000 --> 00:29:40,559
know about viewer monikers like the new

619
00:29:38,070 --> 00:29:43,769
moniker the human occurs like everything

620
00:29:40,559 --> 00:29:44,639
that has been exploiting the 2017-2018 I

621
00:29:43,769 --> 00:29:46,769
didn't know about that

622
00:29:44,639 --> 00:29:49,019
but I'm glad I throw that one so what's

623
00:29:46,769 --> 00:29:53,000
that one this one is just about on

624
00:29:49,019 --> 00:29:57,330
marshalling objects that have been

625
00:29:53,000 --> 00:30:00,000
marshaled with a trusted marshal how do

626
00:29:57,330 --> 00:30:02,908
you exploit that how do you you know

627
00:30:00,000 --> 00:30:04,679
that you can send an email and this

628
00:30:02,909 --> 00:30:07,169
email we just unmarshal

629
00:30:04,679 --> 00:30:10,260
a calm object but see how do you get cut

630
00:30:07,169 --> 00:30:12,299
addiction from this so first step you're

631
00:30:10,260 --> 00:30:14,399
going to call CO and motion interface

632
00:30:12,299 --> 00:30:17,070
with something that has been that is

633
00:30:14,399 --> 00:30:20,299
trusted so there is a list of trusted

634
00:30:17,070 --> 00:30:23,510
markers not so many of them I think 15

635
00:30:20,299 --> 00:30:27,200
so it's quite easy to loop to

636
00:30:23,510 --> 00:30:29,330
and proton tray find some bugs so the

637
00:30:27,200 --> 00:30:34,100
first component that I noticed was this

638
00:30:29,330 --> 00:30:35,990
one affecting the vid control library

639
00:30:34,100 --> 00:30:38,240
and this one was interesting because

640
00:30:35,990 --> 00:30:40,370
when you look at the code so this is a

641
00:30:38,240 --> 00:30:41,960
code that is triggered when you open a

642
00:30:40,370 --> 00:30:45,139
stream and so you see there is a loop

643
00:30:41,960 --> 00:30:48,110
that take a counter and then it's going

644
00:30:45,140 --> 00:30:51,580
to take like calm objects from the

645
00:30:48,110 --> 00:30:54,770
stream instantiate them and then

646
00:30:51,580 --> 00:30:57,820
initialize them on VI persist rain in it

647
00:30:54,770 --> 00:31:00,860
interface and that init interface is

648
00:30:57,820 --> 00:31:03,080
important it's different that the normal

649
00:31:00,860 --> 00:31:05,030
I persist REM in it that sorry is

650
00:31:03,080 --> 00:31:07,220
different that normal I persist REM

651
00:31:05,030 --> 00:31:09,889
interface if you've done some browser

652
00:31:07,220 --> 00:31:14,240
research you know for example does that

653
00:31:09,890 --> 00:31:17,180
flash starts with this interface so at

654
00:31:14,240 --> 00:31:20,150
that point I know I had that I had an

655
00:31:17,180 --> 00:31:22,220
email and I was able to trigger flash so

656
00:31:20,150 --> 00:31:24,770
I could get a remote colleagues action

657
00:31:22,220 --> 00:31:27,830
with flash and then so this was summer

658
00:31:24,770 --> 00:31:31,040
2016 so I had been at my stuff for about

659
00:31:27,830 --> 00:31:33,260
nine months and somebody told me Nick oh

660
00:31:31,040 --> 00:31:35,570
so now you're at Microsoft you need to

661
00:31:33,260 --> 00:31:37,840
leave flash alone and forget about it

662
00:31:35,570 --> 00:31:39,649
varies enough for you to do at Microsoft

663
00:31:37,840 --> 00:31:42,620
all right fair enough

664
00:31:39,650 --> 00:31:47,320
so I had to find something else so there

665
00:31:42,620 --> 00:31:50,239
are not that many that many controls

666
00:31:47,320 --> 00:31:52,790
starting with VI persist a minute so I

667
00:31:50,240 --> 00:31:57,170
just tried them all and I noticed that

668
00:31:52,790 --> 00:32:00,680
for this one the XML feed moniker if you

669
00:31:57,170 --> 00:32:03,800
were giving it some HTML it would just

670
00:32:00,680 --> 00:32:08,030
load it unload the scripts that that

671
00:32:03,800 --> 00:32:10,100
were in that were container so that's it

672
00:32:08,030 --> 00:32:12,740
at that moment I had an email that was

673
00:32:10,100 --> 00:32:15,699
able to instantiate some vbscript it was

674
00:32:12,740 --> 00:32:18,710
not enough because I was still locked

675
00:32:15,700 --> 00:32:20,690
inside VB I couldn't like for example

676
00:32:18,710 --> 00:32:23,480
instantiate the file system object and

677
00:32:20,690 --> 00:32:26,000
all right to files so I still have to

678
00:32:23,480 --> 00:32:29,150
find something else I just used a vb0

679
00:32:26,000 --> 00:32:33,140
because you know we are some

680
00:32:29,150 --> 00:32:36,380
but more interestingly what was fixed

681
00:32:33,140 --> 00:32:39,380
with this attack so first everything

682
00:32:36,380 --> 00:32:41,570
that had to do with that that with that

683
00:32:39,380 --> 00:32:45,380
vid control so this was a trusted

684
00:32:41,570 --> 00:32:47,689
marshal and it was very very important

685
00:32:45,380 --> 00:32:50,120
crucial that everything that was on

686
00:32:47,690 --> 00:32:53,410
marshal with that library was Reseda

687
00:32:50,120 --> 00:32:56,000
there were at least three series on this

688
00:32:53,410 --> 00:33:00,980
do some research maybe you can find ours

689
00:32:56,000 --> 00:33:03,590
hopefully not the examine filmmaker and

690
00:33:00,980 --> 00:33:05,809
video giraffe I'm glad that I did that

691
00:33:03,590 --> 00:33:08,809
research because then we added them to

692
00:33:05,809 --> 00:33:11,090
the come activation filter in office so

693
00:33:08,809 --> 00:33:12,830
now it's not possible to load s come

694
00:33:11,090 --> 00:33:15,110
objects anymore

695
00:33:12,830 --> 00:33:17,419
it might still be possible to load the

696
00:33:15,110 --> 00:33:20,300
breath in video because I think there is

697
00:33:17,420 --> 00:33:22,400
a one weird use case but that's that's

698
00:33:20,300 --> 00:33:26,210
another story for of your applications

699
00:33:22,400 --> 00:33:28,100
this is now done do not load all the

700
00:33:26,210 --> 00:33:29,960
objects in the bank you don't put the

701
00:33:28,100 --> 00:33:32,750
preview pane here I'm just talking about

702
00:33:29,960 --> 00:33:35,150
the panes in Outlook in general because

703
00:33:32,750 --> 00:33:37,370
when you get an email and you reply to

704
00:33:35,150 --> 00:33:39,920
or you forward it then that's another

705
00:33:37,370 --> 00:33:42,409
thing that is going to show up and so at

706
00:33:39,920 --> 00:33:44,510
some point I had a case where it was

707
00:33:42,410 --> 00:33:47,030
possible to get correction just by

708
00:33:44,510 --> 00:33:48,710
eating reply to to that email so you

709
00:33:47,030 --> 00:33:50,629
wouldn't get correction that the

710
00:33:48,710 --> 00:33:53,120
wouldn't trigger when you were reading

711
00:33:50,630 --> 00:33:56,510
teammate but if you reply to then yes

712
00:33:53,120 --> 00:33:59,419
you would be on right it fixed another

713
00:33:56,510 --> 00:34:01,670
vbscript bug yeah but more importantly

714
00:33:59,420 --> 00:34:04,700
now it's not possible to lose vbscript

715
00:34:01,670 --> 00:34:07,790
anymore at least on the recent branches

716
00:34:04,700 --> 00:34:10,879
and then something something quite cool

717
00:34:07,790 --> 00:34:13,040
and if we restrict objects loaded by the

718
00:34:10,879 --> 00:34:14,600
diagnostic service and if you followed

719
00:34:13,040 --> 00:34:17,570
that plantation so far you should be

720
00:34:14,600 --> 00:34:20,868
like what is he talking about think

721
00:34:17,570 --> 00:34:23,919
about that that attack is not only

722
00:34:20,869 --> 00:34:29,000
affecting outlook it's affecting or

723
00:34:23,918 --> 00:34:31,129
orals succumb objects in general or all

724
00:34:29,000 --> 00:34:34,310
the objects that are marshaled

725
00:34:31,129 --> 00:34:36,949
in Windows Windows is just about objects

726
00:34:34,310 --> 00:34:38,668
sent from what application to another

727
00:34:36,949 --> 00:34:41,518
and if you can

728
00:34:38,668 --> 00:34:44,279
abuse there's a Marshall distrust reamer

729
00:34:41,518 --> 00:34:47,368
sure then you can do crazy things with

730
00:34:44,279 --> 00:34:50,250
this think about variant and safer eyes

731
00:34:47,369 --> 00:34:52,950
safer eyes for example just an RA

732
00:34:50,250 --> 00:34:55,799
continuing different type of variance

733
00:34:52,949 --> 00:34:57,210
when you when you do when you're

734
00:34:55,799 --> 00:34:58,890
creating your application and you're

735
00:34:57,210 --> 00:35:01,829
using a cipher you don't specify the

736
00:34:58,890 --> 00:35:03,720
type on the on the safer you can do some

737
00:35:01,829 --> 00:35:07,109
check later but when you use a safe

738
00:35:03,720 --> 00:35:11,279
right it can it's a generic RA it can

739
00:35:07,109 --> 00:35:16,109
contain whatever so know so think about

740
00:35:11,279 --> 00:35:19,349
a case where you would for example load

741
00:35:16,109 --> 00:35:21,930
safe for I containing strings so you

742
00:35:19,349 --> 00:35:23,609
would have your strings marshaled in

743
00:35:21,930 --> 00:35:27,509
that safe array and then on the other

744
00:35:23,609 --> 00:35:29,730
side so code would just see that very

745
00:35:27,510 --> 00:35:33,630
some string in Safari and then unmarshal

746
00:35:29,730 --> 00:35:36,839
everything so now think about what would

747
00:35:33,630 --> 00:35:39,299
happen if you instead of giving strings

748
00:35:36,839 --> 00:35:42,269
you'd give objects exactly the same

749
00:35:39,299 --> 00:35:45,960
death subject would be answer as for you

750
00:35:42,269 --> 00:35:49,618
and so so if you think about it and if

751
00:35:45,960 --> 00:35:53,480
you can find an application that works

752
00:35:49,619 --> 00:35:57,000
on RPC and that allows that supports

753
00:35:53,480 --> 00:35:59,730
there's sa Fahr eyes you you've you've

754
00:35:57,000 --> 00:36:02,759
you've already won for example think

755
00:35:59,730 --> 00:36:04,740
about this one it's a diagnostic service

756
00:36:02,759 --> 00:36:07,710
I didn't know about that service at

757
00:36:04,740 --> 00:36:11,549
first I think I learned from it at Point

758
00:36:07,710 --> 00:36:14,940
1016 that South Korean guy look he heart

759
00:36:11,549 --> 00:36:17,880
he managed to exploit I think to us I at

760
00:36:14,940 --> 00:36:20,670
that point or was it I don't remember he

761
00:36:17,880 --> 00:36:23,160
managed to exploit it just by having his

762
00:36:20,670 --> 00:36:26,039
own library loaded by a system service

763
00:36:23,160 --> 00:36:28,460
and when you look at it right how am I

764
00:36:26,039 --> 00:36:31,950
supposed to know that these things exist

765
00:36:28,460 --> 00:36:34,109
it wasn't that figure I mean there were

766
00:36:31,950 --> 00:36:36,720
some restrictions it wasn't possible

767
00:36:34,109 --> 00:36:38,640
just to load the library they you needed

768
00:36:36,720 --> 00:36:40,950
to bypass some checks but still that's

769
00:36:38,640 --> 00:36:43,828
that's what he emerged and he managed to

770
00:36:40,950 --> 00:36:46,460
do and usually it's not possible to do

771
00:36:43,829 --> 00:36:48,309
anything with that service but I'm not

772
00:36:46,460 --> 00:36:50,799
looking at

773
00:36:48,309 --> 00:36:53,020
at things that I can do if that service

774
00:36:50,799 --> 00:36:55,450
I was just looking for functions

775
00:36:53,020 --> 00:36:58,150
exported by this service and there was

776
00:36:55,450 --> 00:37:00,129
one to get drafted updates that was

777
00:36:58,150 --> 00:37:02,980
exactly what I was looking for because

778
00:37:00,130 --> 00:37:05,500
here this function takes in parameter

779
00:37:02,980 --> 00:37:08,140
safer right and I think this was a safe

780
00:37:05,500 --> 00:37:10,809
array of string yeah if you look if you

781
00:37:08,140 --> 00:37:12,848
look at at the prototype you see contour

782
00:37:10,809 --> 00:37:14,589
ideas be strings so here the God is just

783
00:37:12,849 --> 00:37:18,760
waiting for strings but what happen if

784
00:37:14,589 --> 00:37:21,880
you send objects instead one so could we

785
00:37:18,760 --> 00:37:23,380
just unlock them for you and and once

786
00:37:21,880 --> 00:37:25,270
you're in that function and it's

787
00:37:23,380 --> 00:37:26,349
checking if you've already actually

788
00:37:25,270 --> 00:37:28,059
provided some string

789
00:37:26,349 --> 00:37:30,280
it's ready to light your objects have

790
00:37:28,059 --> 00:37:33,520
already been marshaled I've got a demo

791
00:37:30,280 --> 00:37:36,690
for you trying that so you just receive

792
00:37:33,520 --> 00:37:39,430
an email and and then magic will happen

793
00:37:36,690 --> 00:37:43,119
in your program you click it and then

794
00:37:39,430 --> 00:37:46,288
stuff happens in the background and you

795
00:37:43,119 --> 00:37:50,109
get on and then you system payload

796
00:37:46,289 --> 00:37:52,450
there's a tax work and not just only

797
00:37:50,109 --> 00:37:55,660
here for the purpose of that demo

798
00:37:52,450 --> 00:37:57,819
they are quite for labor and I'm

799
00:37:55,660 --> 00:38:02,140
definitely looking for them this is what

800
00:37:57,819 --> 00:38:05,190
I call a dragon by the way so that's it

801
00:38:02,140 --> 00:38:09,819
for outlook are now going to talk about

802
00:38:05,190 --> 00:38:11,549
exchange so what I found difficult these

803
00:38:09,819 --> 00:38:14,529
days when I start a new project

804
00:38:11,549 --> 00:38:19,390
basically when I want to attack product

805
00:38:14,529 --> 00:38:22,240
is how do I do that what what was

806
00:38:19,390 --> 00:38:24,879
previously done how can I get some IDs

807
00:38:22,240 --> 00:38:25,868
from what was previously done can I get

808
00:38:24,880 --> 00:38:27,640
some inspiration

809
00:38:25,869 --> 00:38:30,410
because usually I just don't know the

810
00:38:27,640 --> 00:38:35,690
target and so for exchange

811
00:38:30,410 --> 00:38:37,100
when I looked at it I just I just looked

812
00:38:35,690 --> 00:38:40,130
at what had been done before and

813
00:38:37,100 --> 00:38:42,440
unfortunately via was not much there was

814
00:38:40,130 --> 00:38:45,500
that exploits that we saw from the

815
00:38:42,440 --> 00:38:47,330
shadow brokers we exploit called

816
00:38:45,500 --> 00:38:49,520
Englishman dentist what was it about

817
00:38:47,330 --> 00:38:53,060
this was about sending an email to

818
00:38:49,520 --> 00:38:55,870
exchange 2003 on Windows Server 2003 and

819
00:38:53,060 --> 00:39:00,080
then when you would view that email in

820
00:38:55,870 --> 00:39:04,330
Outlook Web Apps it would reach a point

821
00:39:00,080 --> 00:39:06,560
where you could you quit them download

822
00:39:04,330 --> 00:39:10,310
what you could force a cut on the server

823
00:39:06,560 --> 00:39:12,140
to download a picture included in in Mac

824
00:39:10,310 --> 00:39:14,630
format and then there was a stack

825
00:39:12,140 --> 00:39:16,310
overflow issue with the library parsing

826
00:39:14,630 --> 00:39:20,000
it and then you would get a codec

827
00:39:16,310 --> 00:39:22,610
solution there but this is exchange 2003

828
00:39:20,000 --> 00:39:25,400
on Windows 2003 how can I get this

829
00:39:22,610 --> 00:39:28,940
attack to work on exchange 2019 for

830
00:39:25,400 --> 00:39:31,640
example another issue that was

831
00:39:28,940 --> 00:39:36,710
interesting so this was submitted to us

832
00:39:31,640 --> 00:39:40,779
by by CDI so it's not as it's not really

833
00:39:36,710 --> 00:39:44,570
about emails but it's more about you

834
00:39:40,780 --> 00:39:48,020
already have a control of on on a box

835
00:39:44,570 --> 00:39:49,490
and you leave a voicemail and you you

836
00:39:48,020 --> 00:39:53,060
play with the map you properties and

837
00:39:49,490 --> 00:39:54,560
then you will get a deserialization and

838
00:39:53,060 --> 00:39:56,750
it will just unmarshal

839
00:39:54,560 --> 00:39:58,340
some code for you and then you get our

840
00:39:56,750 --> 00:40:01,310
see on the server that's not exactly

841
00:39:58,340 --> 00:40:04,220
what I'm what I'm looking after but when

842
00:40:01,310 --> 00:40:06,440
you look at what has been done before in

843
00:40:04,220 --> 00:40:07,040
the past for exchange this is this is

844
00:40:06,440 --> 00:40:10,850
what you'll see

845
00:40:07,040 --> 00:40:13,490
so definitely not much so also think

846
00:40:10,850 --> 00:40:15,920
about the scenarios what are we looking

847
00:40:13,490 --> 00:40:17,799
for how are we attacking that are we I

848
00:40:15,920 --> 00:40:20,720
will note unstated

849
00:40:17,800 --> 00:40:23,060
or do we already have some creds on the

850
00:40:20,720 --> 00:40:26,839
system what sort of attack are we trying

851
00:40:23,060 --> 00:40:29,630
to do are we trying XSS is inoue are we

852
00:40:26,840 --> 00:40:32,690
trying memory corruptions think also

853
00:40:29,630 --> 00:40:36,050
that no these days exchange is

854
00:40:32,690 --> 00:40:38,240
essentially a dotnet application is it

855
00:40:36,050 --> 00:40:40,490
rare dot and application look at the

856
00:40:38,240 --> 00:40:43,580
components they are fairies that 1x RPC

857
00:40:40,490 --> 00:40:45,680
32 I'll come back to it in a second

858
00:40:43,580 --> 00:40:49,610
but some Taurus is unsure for this

859
00:40:45,680 --> 00:40:52,339
research and the VIP this one is just

860
00:40:49,610 --> 00:40:54,620
about opening your box your inbox and

861
00:40:52,340 --> 00:40:56,690
looking at all the emails all the

862
00:40:54,620 --> 00:40:59,029
objects that are in that himmel's and

863
00:40:56,690 --> 00:41:02,660
the amount of things that you can do if

864
00:40:59,030 --> 00:41:04,760
that this tool is just huge you can one

865
00:41:02,660 --> 00:41:07,819
thing that that I really like that you

866
00:41:04,760 --> 00:41:08,600
could you were able to drop literally

867
00:41:07,820 --> 00:41:11,150
everything

868
00:41:08,600 --> 00:41:12,770
drop it in a gif format and then that

869
00:41:11,150 --> 00:41:14,450
would give you some ugly properties that

870
00:41:12,770 --> 00:41:16,430
outlook was unable to generate for

871
00:41:14,450 --> 00:41:18,439
example and I found some bugs just by

872
00:41:16,430 --> 00:41:20,629
replaying this might be properties in

873
00:41:18,440 --> 00:41:22,310
emails and this was this was this was

874
00:41:20,630 --> 00:41:24,170
really cool if you do some research like

875
00:41:22,310 --> 00:41:27,770
this bear that in mind because there are

876
00:41:24,170 --> 00:41:30,680
things here that are aware of it except

877
00:41:27,770 --> 00:41:33,200
easy no so as I said exchange is mostly

878
00:41:30,680 --> 00:41:35,799
just dotnet a huge dotnet application

879
00:41:33,200 --> 00:41:38,930
but there are still a couple of binary

880
00:41:35,800 --> 00:41:42,430
binaries here and there that that are

881
00:41:38,930 --> 00:41:48,169
coding in C or C++ X RPC is one of them

882
00:41:42,430 --> 00:41:49,669
when I looked at it initially I well

883
00:41:48,170 --> 00:41:51,020
I've got the source code so I first

884
00:41:49,670 --> 00:41:53,420
looked at the source code and then I

885
00:41:51,020 --> 00:41:55,910
started either also just to have an idea

886
00:41:53,420 --> 00:41:58,250
of what was going on and I noticed some

887
00:41:55,910 --> 00:42:00,140
functions that were directly working on

888
00:41:58,250 --> 00:42:04,460
the map the properties taken from an

889
00:42:00,140 --> 00:42:07,040
email is where some bug left here let's

890
00:42:04,460 --> 00:42:10,520
see so we got for example this easy

891
00:42:07,040 --> 00:42:13,820
parse and three ID function you see that

892
00:42:10,520 --> 00:42:16,690
there's if you look at it in Ida you see

893
00:42:13,820 --> 00:42:19,430
that there's a huge function which

894
00:42:16,690 --> 00:42:21,620
dispatches to over function depending on

895
00:42:19,430 --> 00:42:23,750
the multi properties and usually you've

896
00:42:21,620 --> 00:42:27,140
got some code that ensured that the

897
00:42:23,750 --> 00:42:30,020
magic property you've submitted is of a

898
00:42:27,140 --> 00:42:32,270
valid type so for example here either a

899
00:42:30,020 --> 00:42:34,700
string or a Unicode string but there

900
00:42:32,270 --> 00:42:39,050
were two cases where these checks were

901
00:42:34,700 --> 00:42:41,089
not done this one for example so here we

902
00:42:39,050 --> 00:42:42,830
would just this function we're supposed

903
00:42:41,090 --> 00:42:45,440
to take a bite all right but you could

904
00:42:42,830 --> 00:42:49,069
instead submit anything like for example

905
00:42:45,440 --> 00:42:51,830
a float so what would happen here is

906
00:42:49,070 --> 00:42:55,040
just another difference in the delivery

907
00:42:51,830 --> 00:42:57,470
process can you exploit that probably

908
00:42:55,040 --> 00:43:00,020
not because of the way variants are

909
00:42:57,470 --> 00:43:03,618
I'm Kareem on 64-bit it was probably

910
00:43:00,020 --> 00:43:05,270
just those at work but at worst but I'd

911
00:43:03,619 --> 00:43:06,680
love to be proven wrong here so if

912
00:43:05,270 --> 00:43:07,460
you've got some times and want to do

913
00:43:06,680 --> 00:43:10,069
some research

914
00:43:07,460 --> 00:43:13,339
have a look at it it's interesting if it

915
00:43:10,069 --> 00:43:16,490
was that over case he made filler from

916
00:43:13,339 --> 00:43:18,560
from eighth year so when I looked at

917
00:43:16,490 --> 00:43:21,379
this function I didn't see the check at

918
00:43:18,560 --> 00:43:23,328
first checked for four sue properties

919
00:43:21,380 --> 00:43:26,089
which is the type of property it turns

920
00:43:23,329 --> 00:43:27,859
out that check is not done above in the

921
00:43:26,089 --> 00:43:29,810
current function but it's done in that

922
00:43:27,859 --> 00:43:31,730
function itself so there was no

923
00:43:29,810 --> 00:43:33,619
possibility for a tight confident here

924
00:43:31,730 --> 00:43:35,660
but then I looked at the car and I

925
00:43:33,619 --> 00:43:38,030
noticed that with either not looking at

926
00:43:35,660 --> 00:43:43,279
the source code it was possible at some

927
00:43:38,030 --> 00:43:45,619
point to write a bit too visa before

928
00:43:43,280 --> 00:43:50,270
that was submitted to buffer that came

929
00:43:45,619 --> 00:43:52,819
from that email so in particle

930
00:43:50,270 --> 00:43:56,060
conditions it was possible just to go

931
00:43:52,819 --> 00:43:58,369
out of the bound by one bit that sounds

932
00:43:56,060 --> 00:44:00,619
cool that's typically the kind of issue

933
00:43:58,369 --> 00:44:03,740
that you'd be able to exploit in a

934
00:44:00,619 --> 00:44:06,530
browser so how much time yeah probably

935
00:44:03,740 --> 00:44:10,368
to two minutes left so what do you think

936
00:44:06,530 --> 00:44:10,970
I did something crazy right I did

937
00:44:10,369 --> 00:44:13,460
nothing

938
00:44:10,970 --> 00:44:17,060
it was too hard I think I spent about

939
00:44:13,460 --> 00:44:18,980
two weeks there trying to figure out a

940
00:44:17,060 --> 00:44:21,470
way to exploit that I couldn't find

941
00:44:18,980 --> 00:44:23,960
anything essentially because of the way

942
00:44:21,470 --> 00:44:26,720
the hip works in in.net

943
00:44:23,960 --> 00:44:27,740
and in the Indies this application is it

944
00:44:26,720 --> 00:44:29,930
possible to exploit it

945
00:44:27,740 --> 00:44:32,839
adopt it but again feel free to do some

946
00:44:29,930 --> 00:44:37,540
research and prove me wrong I won't know

947
00:44:32,839 --> 00:44:40,730
to mention quickly something else so I

948
00:44:37,540 --> 00:44:42,500
so there was a bug that was fixed about

949
00:44:40,730 --> 00:44:44,540
three months ago

950
00:44:42,500 --> 00:44:47,720
in exchange and some people on Twitter

951
00:44:44,540 --> 00:44:49,880
asked me what it was about I told them I

952
00:44:47,720 --> 00:44:53,118
will talk about that later I'm talking

953
00:44:49,880 --> 00:44:55,069
about it no think about oh no because I

954
00:44:53,119 --> 00:44:58,220
haven't talked about that of his web

955
00:44:55,069 --> 00:45:00,710
apps so that's a that's a client that's

956
00:44:58,220 --> 00:45:02,569
supposed to run it in your web server in

957
00:45:00,710 --> 00:45:04,609
your browser so they are obviously

958
00:45:02,569 --> 00:45:07,470
functionalities features that are not

959
00:45:04,609 --> 00:45:10,319
available there but some of them

960
00:45:07,470 --> 00:45:14,160
are still available and Fraser refused

961
00:45:10,320 --> 00:45:15,630
and an RTF email containing objects desi

962
00:45:14,160 --> 00:45:17,339
audio objects this audio object

963
00:45:15,630 --> 00:45:19,440
obviously won't be rendered in your

964
00:45:17,340 --> 00:45:21,420
browser but there still be things that

965
00:45:19,440 --> 00:45:23,610
will be render like for example pictures

966
00:45:21,420 --> 00:45:25,320
so say that you've got your Olli object

967
00:45:23,610 --> 00:45:27,440
and then there is an image that is

968
00:45:25,320 --> 00:45:30,770
encoded with the sorry objects and

969
00:45:27,440 --> 00:45:33,390
something there on that server must be

970
00:45:30,770 --> 00:45:35,880
extracting that that that picture for

971
00:45:33,390 --> 00:45:38,129
you so I looked a bit at the code and so

972
00:45:35,880 --> 00:45:40,110
everything is done in early 32 so it's

973
00:45:38,130 --> 00:45:42,450
got the symbols so you can look at it

974
00:45:40,110 --> 00:45:48,420
and it turns out that various picture

975
00:45:42,450 --> 00:45:50,910
formats were accepted so usually wmf but

976
00:45:48,420 --> 00:45:52,860
it was also possible to specify an EMS

977
00:45:50,910 --> 00:45:55,710
picture and when I saw that a figure

978
00:45:52,860 --> 00:45:57,060
this this must be valid because there

979
00:45:55,710 --> 00:46:00,240
are so many things that you can do with

980
00:45:57,060 --> 00:46:02,670
vmf and so this was exactly what this

981
00:46:00,240 --> 00:46:05,430
Advisory was about do not load EMF

982
00:46:02,670 --> 00:46:09,270
pictures on the server side so I got one

983
00:46:05,430 --> 00:46:12,960
last demo for you where I'm just sending

984
00:46:09,270 --> 00:46:16,650
an email and then my victim

985
00:46:12,960 --> 00:46:19,580
just open it in a while and then that

986
00:46:16,650 --> 00:46:21,330
will just blue screen the extreme server

987
00:46:19,580 --> 00:46:27,140
you like it right

988
00:46:21,330 --> 00:46:29,730
I liked it too so to conclude just a few

989
00:46:27,140 --> 00:46:31,560
few things about that research I didn't

990
00:46:29,730 --> 00:46:34,230
manage to get codec section an exchange

991
00:46:31,560 --> 00:46:37,890
alpha although I tried I tried things I

992
00:46:34,230 --> 00:46:39,990
was unsuccessful I want you to get

993
00:46:37,890 --> 00:46:42,540
something authenticated I found some

994
00:46:39,990 --> 00:46:44,700
verbs where that were more interesting

995
00:46:42,540 --> 00:46:47,490
but you needed to be authenticated I do

996
00:46:44,700 --> 00:46:49,710
not try to exploit them unfortunately

997
00:46:47,490 --> 00:46:51,509
for those that I found I don't believe

998
00:46:49,710 --> 00:46:55,830
they are exploitable

999
00:46:51,510 --> 00:46:57,720
but what can you guys found that's what

1000
00:46:55,830 --> 00:47:01,290
I'm interested in it is him

1001
00:46:57,720 --> 00:47:05,609
some references if you want to check

1002
00:47:01,290 --> 00:47:07,800
that the slides are online and and thank

1003
00:47:05,610 --> 00:47:08,450
you or thank you for it

1004
00:47:07,800 --> 00:47:11,780
you

1005
00:47:08,450 --> 00:47:11,779
[Applause]

