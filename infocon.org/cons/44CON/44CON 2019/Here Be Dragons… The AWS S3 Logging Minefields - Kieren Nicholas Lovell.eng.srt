1
00:00:04,270 --> 00:00:10,670
well good afternoon everyone I hope you

2
00:00:07,939 --> 00:00:13,490
enjoyed joint use domestic lunch it gave

3
00:00:10,670 --> 00:00:16,009
me a bit of flashback to my Navy days of

4
00:00:13,490 --> 00:00:17,689
seeing some interesting fish thrown in

5
00:00:16,010 --> 00:00:18,769
with baked beans and some other stuff

6
00:00:17,689 --> 00:00:20,900
that was always pretty much what the

7
00:00:18,769 --> 00:00:22,698
Navy used to do you know throw is open

8
00:00:20,900 --> 00:00:24,470
as many kin yeah tins of food as you can

9
00:00:22,699 --> 00:00:28,460
throw them in boil them to perfection

10
00:00:24,470 --> 00:00:31,640
moments of it so always good so what am

11
00:00:28,460 --> 00:00:33,440
I here to talk to you about today even

12
00:00:31,640 --> 00:00:35,690
though we're actually talking about AWS

13
00:00:33,440 --> 00:00:37,370
and we're talking about cloud services

14
00:00:35,690 --> 00:00:38,809
and log analytics I must stress that

15
00:00:37,370 --> 00:00:41,930
this is actually applicable to

16
00:00:38,809 --> 00:00:42,919
everything and from my experience and

17
00:00:41,930 --> 00:00:47,059
I'll give you a bit of an introduction

18
00:00:42,920 --> 00:00:51,260
from my viewpoint we really have kind of

19
00:00:47,059 --> 00:00:53,809
done the wrong thing with logs and we'll

20
00:00:51,260 --> 00:00:55,760
go into a little bit about that later so

21
00:00:53,809 --> 00:00:57,559
from my experience first of all I will

22
00:00:55,760 --> 00:01:01,428
apologize I am a very very strange

23
00:00:57,559 --> 00:01:03,980
person I joined up in 2002 is a nuclear

24
00:01:01,429 --> 00:01:05,990
ballistic missile submarine or as a

25
00:01:03,980 --> 00:01:08,329
crypto officer and as a communications

26
00:01:05,990 --> 00:01:12,770
officer the longest I spent underwater

27
00:01:08,329 --> 00:01:14,089
was 138 days I then left that after two

28
00:01:12,770 --> 00:01:16,130
years to do something slightly less

29
00:01:14,090 --> 00:01:18,770
dangerous and went into bomb disposal

30
00:01:16,130 --> 00:01:21,979
for five years so I didn't say I was

31
00:01:18,770 --> 00:01:26,140
smart after that though if you do any

32
00:01:21,979 --> 00:01:30,890
open source intelligence against me in

33
00:01:26,140 --> 00:01:34,189
2006 my ship crashed in Norway I must

34
00:01:30,890 --> 00:01:36,350
stress I wasn't driving however they

35
00:01:34,189 --> 00:01:38,449
gave me a good recommendation for

36
00:01:36,350 --> 00:01:40,579
instant response so the Norwegian

37
00:01:38,450 --> 00:01:43,189
government asked would you like to come

38
00:01:40,579 --> 00:01:45,169
and work for them I said no they said

39
00:01:43,189 --> 00:01:46,850
we'll pay you three times as much I went

40
00:01:45,170 --> 00:01:50,390
okay let's go

41
00:01:46,850 --> 00:01:52,070
and I became I set up the what are the

42
00:01:50,390 --> 00:01:53,689
co-sponsors to set up the cyber warfare

43
00:01:52,070 --> 00:01:57,439
division for the wrong or Weejun Navy

44
00:01:53,689 --> 00:02:00,229
and as a civilian at the start and then

45
00:01:57,439 --> 00:02:03,770
I got a commission from the King of

46
00:02:00,229 --> 00:02:06,590
Norway to lead nine nine warships to

47
00:02:03,770 --> 00:02:08,780
hunt pirates in Somalia for nine months

48
00:02:06,590 --> 00:02:10,459
so during the day as an intelligence

49
00:02:08,780 --> 00:02:12,440
officer and chief information security

50
00:02:10,459 --> 00:02:14,990
officer and then in the evening as a

51
00:02:12,440 --> 00:02:17,700
battle watch commander commander

52
00:02:14,990 --> 00:02:19,380
after that my next promotion was going

53
00:02:17,700 --> 00:02:21,630
to be a desk so I decided to do

54
00:02:19,380 --> 00:02:23,579
something else so I wanted to see what

55
00:02:21,630 --> 00:02:25,109
real psychological warfare is like so I

56
00:02:23,580 --> 00:02:27,240
went to the University of Cambridge as

57
00:02:25,110 --> 00:02:29,430
the head of cyber security to see how

58
00:02:27,240 --> 00:02:31,200
academics do warfare and have to admit

59
00:02:29,430 --> 00:02:33,780
that's more cutthroat than any military

60
00:02:31,200 --> 00:02:38,220
I've ever seen after doing that for

61
00:02:33,780 --> 00:02:40,860
three years I then moved to Estonia to

62
00:02:38,220 --> 00:02:43,170
do more exciting more pragmatic things

63
00:02:40,860 --> 00:02:45,930
and also trying to not repeat the same

64
00:02:43,170 --> 00:02:48,299
mistakes and the same kind of ethos we

65
00:02:45,930 --> 00:02:50,640
were doing the tick-box to security

66
00:02:48,300 --> 00:02:52,890
routine which became pretty much my

67
00:02:50,640 --> 00:02:56,369
routine part of job and to actually look

68
00:02:52,890 --> 00:02:59,279
at the issues in hand but one of the key

69
00:02:56,370 --> 00:03:03,870
parts I learned from my very start of my

70
00:02:59,280 --> 00:03:06,690
naval days was actually about fires if

71
00:03:03,870 --> 00:03:09,660
this ship identified when a fire was

72
00:03:06,690 --> 00:03:11,940
going off less than 30 seconds and we

73
00:03:09,660 --> 00:03:14,640
knew it was going to happen and we

74
00:03:11,940 --> 00:03:17,579
responded correctly we knew the ship

75
00:03:14,640 --> 00:03:19,890
would be saved we had to know all of the

76
00:03:17,580 --> 00:03:22,590
stuff that was happening before it in

77
00:03:19,890 --> 00:03:25,350
little indicating factors but within 30

78
00:03:22,590 --> 00:03:27,990
seconds it's saved oh for 30 seconds

79
00:03:25,350 --> 00:03:31,410
we've lost the ship even if if it is

80
00:03:27,990 --> 00:03:33,660
just a waste bin fire the same applies

81
00:03:31,410 --> 00:03:36,990
to any incident you need to know very

82
00:03:33,660 --> 00:03:40,049
early on in when you have a cyber attack

83
00:03:36,990 --> 00:03:41,880
what are you looking at are you can can

84
00:03:40,050 --> 00:03:45,270
you actually get the information you

85
00:03:41,880 --> 00:03:47,160
need and can you act quickly do you know

86
00:03:45,270 --> 00:03:49,080
the information do you get it in time

87
00:03:47,160 --> 00:03:51,780
they're the only key things you really

88
00:03:49,080 --> 00:03:57,270
need the rest of it will come naturally

89
00:03:51,780 --> 00:03:59,550
and this brings us to two logs first of

90
00:03:57,270 --> 00:04:01,620
all while we may have moved it to this

91
00:03:59,550 --> 00:04:03,420
lovely cloud infrastructure let's be

92
00:04:01,620 --> 00:04:07,110
honest it is exactly the same as before

93
00:04:03,420 --> 00:04:08,730
it's just the cable is longer did people

94
00:04:07,110 --> 00:04:11,910
check logs in the first place

95
00:04:08,730 --> 00:04:15,209
no people check logs when there's an

96
00:04:11,910 --> 00:04:19,230
incident people check logs after the

97
00:04:15,210 --> 00:04:22,260
event after the indicator and what we've

98
00:04:19,230 --> 00:04:26,250
now got with this new cloud structure

99
00:04:22,260 --> 00:04:28,560
and when we're picking here as AWS with

100
00:04:26,250 --> 00:04:30,570
s3 you've got no problem with storage

101
00:04:28,560 --> 00:04:32,700
in terms of storing these logs this is

102
00:04:30,570 --> 00:04:35,849
great you can whack in as much as you

103
00:04:32,700 --> 00:04:36,419
want but do you know what you're looking

104
00:04:35,850 --> 00:04:40,169
for

105
00:04:36,419 --> 00:04:42,450
have you looked at the data do you

106
00:04:40,169 --> 00:04:46,080
actually know what's irregular and I use

107
00:04:42,450 --> 00:04:47,760
this example earlier because we laugh at

108
00:04:46,080 --> 00:04:50,669
them for doing these you've heard this

109
00:04:47,760 --> 00:04:52,050
the British Telecom spearfishing that's

110
00:04:50,669 --> 00:04:54,630
right they're phishing campaign they

111
00:04:52,050 --> 00:04:57,510
phone up old people and say your Windows

112
00:04:54,630 --> 00:04:59,340
machine has been compromised if you open

113
00:04:57,510 --> 00:05:00,690
the Event Viewer log on your Windows

114
00:04:59,340 --> 00:05:03,090
machine and they walk them through it

115
00:05:00,690 --> 00:05:05,160
and then it opens up the event log and

116
00:05:03,090 --> 00:05:09,599
it's got thousands of critical errors

117
00:05:05,160 --> 00:05:10,740
and it gives them confirmation so the

118
00:05:09,600 --> 00:05:13,560
person that you're doing this

119
00:05:10,740 --> 00:05:15,570
spearfishing campaign for the victim

120
00:05:13,560 --> 00:05:16,830
says I'm looking at this you told me

121
00:05:15,570 --> 00:05:18,540
there are errors there are critical

122
00:05:16,830 --> 00:05:21,359
errors yes

123
00:05:18,540 --> 00:05:23,490
I now need your help to sort this out we

124
00:05:21,360 --> 00:05:25,200
do this an incident response because

125
00:05:23,490 --> 00:05:27,440
when we're looking at vlogs and we've

126
00:05:25,200 --> 00:05:29,370
got incidents and it's all going wrong

127
00:05:27,440 --> 00:05:31,590
have we actually ever looked at that

128
00:05:29,370 --> 00:05:34,140
look before are they just sequel calls

129
00:05:31,590 --> 00:05:36,510
that failed are they just error messages

130
00:05:34,140 --> 00:05:38,039
that were always there and now all of a

131
00:05:36,510 --> 00:05:40,169
sudden rather than focusing our

132
00:05:38,039 --> 00:05:44,159
attention on really what's happening

133
00:05:40,169 --> 00:05:46,919
are we just fixing things that were

134
00:05:44,160 --> 00:05:49,070
never broken in the first place so this

135
00:05:46,919 --> 00:05:53,580
is the kind of mindset of how to change

136
00:05:49,070 --> 00:05:55,289
this works but what's quite interesting

137
00:05:53,580 --> 00:05:58,530
with the way the structure has changed

138
00:05:55,289 --> 00:06:00,690
by going into the clout is not a lot of

139
00:05:58,530 --> 00:06:05,429
people actually know how AWS logging

140
00:06:00,690 --> 00:06:08,460
works there is a real kind of in-depth

141
00:06:05,430 --> 00:06:10,830
skill change you need to learn it's very

142
00:06:08,460 --> 00:06:13,680
easy to use it's hard to set up

143
00:06:10,830 --> 00:06:16,950
correctly and setting up that correctly

144
00:06:13,680 --> 00:06:19,320
yes aspect is so important and it's spec

145
00:06:16,950 --> 00:06:23,159
techs we have found that there are a

146
00:06:19,320 --> 00:06:26,370
number of logs that have been dumped

147
00:06:23,160 --> 00:06:29,220
publicly that should definitely have not

148
00:06:26,370 --> 00:06:31,830
been dumped publicly we're talking

149
00:06:29,220 --> 00:06:33,960
emails voicemails things that could be

150
00:06:31,830 --> 00:06:36,419
easily extracted from a public viewpoint

151
00:06:33,960 --> 00:06:38,400
and these are not just from two-bit

152
00:06:36,419 --> 00:06:40,320
small companies these are Tier one

153
00:06:38,400 --> 00:06:42,150
companies

154
00:06:40,320 --> 00:06:44,180
mission-critical stuff but they're not

155
00:06:42,150 --> 00:06:47,929
understanding how it works

156
00:06:44,180 --> 00:06:52,590
so we're gonna use as our example today

157
00:06:47,930 --> 00:06:53,220
our own public bucket with 20 million

158
00:06:52,590 --> 00:06:58,590
blobs

159
00:06:53,220 --> 00:07:00,690
it's from 2017 to 2019 but it's not too

160
00:06:58,590 --> 00:07:04,590
big but it's an all right sample size

161
00:07:00,690 --> 00:07:06,510
just to show how we can work this out so

162
00:07:04,590 --> 00:07:09,419
for those that always love reading an

163
00:07:06,510 --> 00:07:14,280
indicator of a log this is the structure

164
00:07:09,420 --> 00:07:17,520
of that particular the log format quite

165
00:07:14,280 --> 00:07:21,419
standard normal but again an awful lot

166
00:07:17,520 --> 00:07:22,830
of them and they are well documented and

167
00:07:21,420 --> 00:07:25,230
by well documented I mean quite

168
00:07:22,830 --> 00:07:29,400
documented and by quite documented we

169
00:07:25,230 --> 00:07:33,990
mean hey it might not be as good as you

170
00:07:29,400 --> 00:07:36,359
think but if we have a look at it as

171
00:07:33,990 --> 00:07:38,540
it's much easier obviously now we all

172
00:07:36,360 --> 00:07:42,330
understand it that way so it's all good

173
00:07:38,540 --> 00:07:44,130
when we look at the regex this is how we

174
00:07:42,330 --> 00:07:45,599
have to pass it so if you're using a

175
00:07:44,130 --> 00:07:48,570
thinner or if you're trying to put it in

176
00:07:45,600 --> 00:07:51,450
a human readable format these is the

177
00:07:48,570 --> 00:07:53,790
unique expression that we need obviously

178
00:07:51,450 --> 00:07:55,409
you would never notice if you would all

179
00:07:53,790 --> 00:07:57,780
spot that there's you know a ROM comma

180
00:07:55,410 --> 00:08:01,890
in there or wrong on speech mark Whittle

181
00:07:57,780 --> 00:08:05,340
we're all very very clear with this the

182
00:08:01,890 --> 00:08:07,950
problem starts to occur however when the

183
00:08:05,340 --> 00:08:11,099
well-documented format where they

184
00:08:07,950 --> 00:08:14,460
definitely said in March 2019 so you

185
00:08:11,100 --> 00:08:16,320
would not change changed we know this

186
00:08:14,460 --> 00:08:18,109
because using wayback machine we can

187
00:08:16,320 --> 00:08:20,610
look back at the manual and the core

188
00:08:18,110 --> 00:08:24,120
format of what they were storing their

189
00:08:20,610 --> 00:08:26,390
looks was altered they did state that

190
00:08:24,120 --> 00:08:29,280
they would only just add extra fields

191
00:08:26,390 --> 00:08:31,349
but now we know it's altered if you're

192
00:08:29,280 --> 00:08:34,439
trying to pass this data that's historic

193
00:08:31,350 --> 00:08:37,469
with the new rousseff you're going to

194
00:08:34,440 --> 00:08:41,330
get invalid results it's not an accurate

195
00:08:37,469 --> 00:08:43,770
way to recall what happened previously

196
00:08:41,330 --> 00:08:45,660
this generally does happen in

197
00:08:43,770 --> 00:08:49,110
organizations like Google or anything

198
00:08:45,660 --> 00:08:50,790
because it is a very agile workplace you

199
00:08:49,110 --> 00:08:52,420
know I've never seen Gmail ever to be

200
00:08:50,790 --> 00:08:54,730
anything other than beta

201
00:08:52,420 --> 00:08:57,310
but you know because of that structure

202
00:08:54,730 --> 00:08:59,019
change when you look back you have to

203
00:08:57,310 --> 00:09:02,739
take these things into consideration and

204
00:08:59,019 --> 00:09:04,630
your past scripts won't work they will

205
00:09:02,740 --> 00:09:08,560
start walking out or other particular

206
00:09:04,630 --> 00:09:11,889
tools that you can use on spec Tech's

207
00:09:08,560 --> 00:09:14,469
for our site when we've shut this safe

208
00:09:11,889 --> 00:09:16,029
through it becomes more nice more fluffy

209
00:09:14,470 --> 00:09:18,910
and a human readable so we can actually

210
00:09:16,029 --> 00:09:21,699
understand what's going on but of course

211
00:09:18,910 --> 00:09:23,769
we want to develop this further and make

212
00:09:21,699 --> 00:09:25,810
it in a more structured mindset so we

213
00:09:23,769 --> 00:09:31,029
can actually then flow in and we can do

214
00:09:25,810 --> 00:09:33,910
proper analytics out of this so as you

215
00:09:31,029 --> 00:09:36,939
can see on here we've starting to get

216
00:09:33,910 --> 00:09:38,740
all of the buckets whacked in and we're

217
00:09:36,940 --> 00:09:41,649
now filtering for the important files

218
00:09:38,740 --> 00:09:44,139
for actually we want to look for once we

219
00:09:41,649 --> 00:09:46,510
start to collect all this data we can

220
00:09:44,139 --> 00:09:48,610
then start playing around with it which

221
00:09:46,510 --> 00:09:50,500
then gets me to a point of before we

222
00:09:48,610 --> 00:09:52,540
start looking at files something you

223
00:09:50,500 --> 00:09:55,720
really need to get your security teams

224
00:09:52,540 --> 00:09:57,790
to do one of the first bits I mentioned

225
00:09:55,720 --> 00:10:01,510
at the staff is you need to know what

226
00:09:57,790 --> 00:10:04,839
normal is don't just get people looking

227
00:10:01,510 --> 00:10:08,260
at your logs after an incident get them

228
00:10:04,839 --> 00:10:10,720
looking at the logs for fun play around

229
00:10:08,260 --> 00:10:16,089
with it see actually what your systems

230
00:10:10,720 --> 00:10:18,880
do I found looking at the university

231
00:10:16,089 --> 00:10:20,500
that I also work for we've always our

232
00:10:18,880 --> 00:10:22,899
single sign-on system has always worked

233
00:10:20,500 --> 00:10:25,000
so we never looked at it you know just

234
00:10:22,899 --> 00:10:27,160
worked magic yeah Singles aren't all

235
00:10:25,000 --> 00:10:29,140
good but then actually doing analytics

236
00:10:27,160 --> 00:10:31,269
of how it worked if we did have an

237
00:10:29,140 --> 00:10:32,410
incident on that particular system all

238
00:10:31,269 --> 00:10:35,050
of the Estonians

239
00:10:32,410 --> 00:10:37,209
were being saved into the English

240
00:10:35,050 --> 00:10:38,769
database and order the English people

241
00:10:37,209 --> 00:10:42,279
were being saved into the Estonian

242
00:10:38,769 --> 00:10:43,630
database due to the typo none of us

243
00:10:42,279 --> 00:10:46,060
would have known this none of us would

244
00:10:43,630 --> 00:10:48,970
have even looked a bit but we had a play

245
00:10:46,060 --> 00:10:51,069
and you get to the more you get to know

246
00:10:48,970 --> 00:10:52,180
and experience your system the more you

247
00:10:51,069 --> 00:10:57,189
actually really understand what's

248
00:10:52,180 --> 00:10:59,290
underlying in it and the way on how it's

249
00:10:57,190 --> 00:11:03,279
done in AWS is you have the one region

250
00:10:59,290 --> 00:11:06,040
and within that it is then more smaller

251
00:11:03,279 --> 00:11:07,500
files that were locked in there so if we

252
00:11:06,040 --> 00:11:12,069
have a look at the

253
00:11:07,500 --> 00:11:14,140
there's ten million blocks we have 20

254
00:11:12,070 --> 00:11:16,420
million lock records and we have six

255
00:11:14,140 --> 00:11:18,130
million logs within that which we can

256
00:11:16,420 --> 00:11:22,420
the files which we can start doing

257
00:11:18,130 --> 00:11:27,040
analytics on so where do the problems

258
00:11:22,420 --> 00:11:28,360
start to come well first of all I don't

259
00:11:27,040 --> 00:11:30,780
know I think I have to tell you this

260
00:11:28,360 --> 00:11:34,350
really AWS is a rather large company

261
00:11:30,780 --> 00:11:36,819
they kind of do an awful lot of stuff

262
00:11:34,350 --> 00:11:40,420
and when you're running your own box

263
00:11:36,820 --> 00:11:42,970
your news to the logs being saved and

264
00:11:40,420 --> 00:11:46,540
being recalled at a relatively minor

265
00:11:42,970 --> 00:11:50,800
place and in some cases in AWS this is

266
00:11:46,540 --> 00:11:53,050
true in some cases it is not further

267
00:11:50,800 --> 00:11:55,959
though there is some interesting

268
00:11:53,050 --> 00:11:58,270
irregularities of how far it can be from

269
00:11:55,960 --> 00:12:01,990
when the event was created to when the

270
00:11:58,270 --> 00:12:03,760
record is actually reported to you quite

271
00:12:01,990 --> 00:12:06,780
a lot of difference which we will come

272
00:12:03,760 --> 00:12:10,480
into later but as you can see if we take

273
00:12:06,780 --> 00:12:12,400
you West one from the bucket loader it's

274
00:12:10,480 --> 00:12:14,440
normally about twenty two thousand

275
00:12:12,400 --> 00:12:16,930
thousand hour which is the average of

276
00:12:14,440 --> 00:12:19,660
how much it is throwing and putting it

277
00:12:16,930 --> 00:12:23,979
into this after the response that is a

278
00:12:19,660 --> 00:12:27,640
lot of requests so when we're doing the

279
00:12:23,980 --> 00:12:34,270
best effort approach to do this there is

280
00:12:27,640 --> 00:12:37,569
a little bit of an offset so if we look

281
00:12:34,270 --> 00:12:40,569
at the on order logs that is coming in

282
00:12:37,570 --> 00:12:42,640
on here the average shipping time from

283
00:12:40,570 --> 00:12:44,920
actually when the event is done to when

284
00:12:42,640 --> 00:12:47,230
it's posted so where you can actually do

285
00:12:44,920 --> 00:12:52,589
any analytics or even read it is sixty

286
00:12:47,230 --> 00:12:59,080
five minutes the best case is 17 minutes

287
00:12:52,590 --> 00:13:01,180
that is quite slow really but we can

288
00:12:59,080 --> 00:13:02,740
then take it a little bit further we can

289
00:13:01,180 --> 00:13:06,010
calculate the best time to actually

290
00:13:02,740 --> 00:13:08,170
launch the attack because by taking this

291
00:13:06,010 --> 00:13:10,360
data set and then analyzing it and

292
00:13:08,170 --> 00:13:12,579
working out if there are any historical

293
00:13:10,360 --> 00:13:15,520
patterns I think we can see that it was

294
00:13:12,580 --> 00:13:19,830
quite a bit of correlation on this map

295
00:13:15,520 --> 00:13:27,110
here we can see

296
00:13:19,830 --> 00:13:30,529
your launcher attack just after you have

297
00:13:27,110 --> 00:13:33,600
71 minutes until that event is actually

298
00:13:30,529 --> 00:13:36,450
recorded until you can actually even

299
00:13:33,600 --> 00:13:38,310
find out that incident is happening now

300
00:13:36,450 --> 00:13:42,540
for a remind you to back of my analogy

301
00:13:38,310 --> 00:13:44,099
with the ship we knew in 30 seconds if

302
00:13:42,540 --> 00:13:45,839
you've got some of these indicating

303
00:13:44,100 --> 00:13:48,800
knowledge ease you could work out how to

304
00:13:45,839 --> 00:13:51,899
deal with the incident 71 minutes is

305
00:13:48,800 --> 00:13:53,760
pushing the boat out you're no longer

306
00:13:51,899 --> 00:13:55,920
dealing with is somebody trying to do

307
00:13:53,760 --> 00:13:57,899
intrude into your system it's okay what

308
00:13:55,920 --> 00:13:59,189
have they got because they're definitely

309
00:13:57,899 --> 00:14:05,519
in there and definitely something's

310
00:13:59,190 --> 00:14:07,620
happening have they improved no I think

311
00:14:05,519 --> 00:14:10,200
it's a quick easy one on this slide

312
00:14:07,620 --> 00:14:12,600
we've taken it back from the start of

313
00:14:10,200 --> 00:14:14,640
when we start to collect this data to

314
00:14:12,600 --> 00:14:17,339
current day and as you can see the

315
00:14:14,640 --> 00:14:22,649
correlation is still quite clear from

316
00:14:17,339 --> 00:14:25,980
2017 to 2018 to 2019 it is a pretty

317
00:14:22,649 --> 00:14:27,180
consistent so for hackers in the

318
00:14:25,980 --> 00:14:30,480
audience if you're going to launch an

319
00:14:27,180 --> 00:14:32,699
attack do it after zero zero zero if

320
00:14:30,480 --> 00:14:34,170
you're trying to fix it on top of God

321
00:14:32,700 --> 00:14:36,510
definitely make sure you're paying

322
00:14:34,170 --> 00:14:39,329
attention at 71 minutes afterwards

323
00:14:36,510 --> 00:14:43,350
because something you have a window of

324
00:14:39,329 --> 00:14:45,810
where something can happen however I

325
00:14:43,350 --> 00:14:48,630
must stress on behalf of all of the

326
00:14:45,810 --> 00:14:51,680
places I represent please do not add kws

327
00:14:48,630 --> 00:14:56,040
because of this talk but nevertheless

328
00:14:51,680 --> 00:14:58,849
he's definitely there however I did say

329
00:14:56,040 --> 00:15:01,170
there were some anomalies in this and

330
00:14:58,850 --> 00:15:03,180
this one is quite interesting the

331
00:15:01,170 --> 00:15:06,750
longest I was on a nuclear submarine was

332
00:15:03,180 --> 00:15:10,279
138 days I know that feels like a

333
00:15:06,750 --> 00:15:13,970
ridiculous long time where is this was

334
00:15:10,279 --> 00:15:16,769
237 days for it to report the incident

335
00:15:13,970 --> 00:15:21,660
happening the actual indicator to

336
00:15:16,769 --> 00:15:27,510
actually being reported to you that is a

337
00:15:21,660 --> 00:15:29,189
huge gap in lock delivery from start to

338
00:15:27,510 --> 00:15:33,120
actually where you can get to see it and

339
00:15:29,190 --> 00:15:33,660
as we all know CEOs are always very very

340
00:15:33,120 --> 00:15:35,330
nice

341
00:15:33,660 --> 00:15:37,740
friendly when you say that you've got

342
00:15:35,330 --> 00:15:39,830
237 days and it was a technical error of

343
00:15:37,740 --> 00:15:45,480
why you didn't know something happened

344
00:15:39,830 --> 00:15:50,870
is this a big problem on a grand scale

345
00:15:45,480 --> 00:15:57,180
no on the 237th day thing it was only

346
00:15:50,870 --> 00:16:00,480
0.0008 percent over 14 days however it's

347
00:15:57,180 --> 00:16:02,459
still a problem it still exists and you

348
00:16:00,480 --> 00:16:05,010
need to make sure that you can work out

349
00:16:02,460 --> 00:16:07,050
that this is actually possible you know

350
00:16:05,010 --> 00:16:10,170
it could be the fact that you cannot

351
00:16:07,050 --> 00:16:12,150
trust your logs what can you do to kind

352
00:16:10,170 --> 00:16:15,360
of mitigate this to work out how you can

353
00:16:12,150 --> 00:16:18,600
better improve your response or to

354
00:16:15,360 --> 00:16:22,290
understand in your log why you can't are

355
00:16:18,600 --> 00:16:24,630
always a hundred percent trust it the

356
00:16:22,290 --> 00:16:26,819
way that we have to news logs is logs

357
00:16:24,630 --> 00:16:30,120
are not to confirm if you haven't been

358
00:16:26,820 --> 00:16:32,460
hacked come you need two news logs to

359
00:16:30,120 --> 00:16:34,170
confirm that there is no chance you've

360
00:16:32,460 --> 00:16:36,570
been hacked and if you've got a big gaps

361
00:16:34,170 --> 00:16:38,310
in your data or even small gaps in your

362
00:16:36,570 --> 00:16:40,620
data you need to know about them to

363
00:16:38,310 --> 00:16:43,469
further make sure that you're actually

364
00:16:40,620 --> 00:16:45,120
are secure on water-type the example I

365
00:16:43,470 --> 00:16:47,190
always news to news

366
00:16:45,120 --> 00:16:49,440
we had a vulnerable system at one of the

367
00:16:47,190 --> 00:16:52,050
universities I worked in for four years

368
00:16:49,440 --> 00:16:53,700
we had six months worth of logs so my

369
00:16:52,050 --> 00:16:55,140
chief information security officer said

370
00:16:53,700 --> 00:16:57,540
well it's never been attacked

371
00:16:55,140 --> 00:16:59,460
I checked the six months worth of logs -

372
00:16:57,540 --> 00:17:01,760
its run congratulations but the three

373
00:16:59,460 --> 00:17:04,290
years six months where we have no logs

374
00:17:01,760 --> 00:17:05,550
probably might be an area where you

375
00:17:04,290 --> 00:17:08,810
might want to have a concern on and

376
00:17:05,550 --> 00:17:10,740
because the vulnerability was so old

377
00:17:08,810 --> 00:17:12,060
possibility that no one's attacked in

378
00:17:10,740 --> 00:17:16,410
six months is because they don't think

379
00:17:12,060 --> 00:17:20,669
we're that crap not a great security

380
00:17:16,410 --> 00:17:23,370
posture to have but also the way that

381
00:17:20,670 --> 00:17:26,640
the structure can happen within the log

382
00:17:23,369 --> 00:17:28,109
formatting it can also not return back

383
00:17:26,640 --> 00:17:31,620
results because it's not actually

384
00:17:28,109 --> 00:17:34,469
getting both sides of the story a put

385
00:17:31,620 --> 00:17:36,120
request needs a get request if it's

386
00:17:34,470 --> 00:17:39,420
missing one there's a mismatch it

387
00:17:36,120 --> 00:17:42,239
doesn't give you the feedback it then

388
00:17:39,420 --> 00:17:44,880
comes in a missed report in the log and

389
00:17:42,240 --> 00:17:47,789
as you can see where we checked on our

390
00:17:44,880 --> 00:17:54,269
own data that was pub

391
00:17:47,789 --> 00:17:58,299
we had 15 in 2017 and then 14 in 2019

392
00:17:54,269 --> 00:18:01,779
this mismatch between the put and the

393
00:17:58,299 --> 00:18:02,289
get could also of course be a attack

394
00:18:01,779 --> 00:18:04,450
vector

395
00:18:02,289 --> 00:18:07,119
it could be someone has just altered

396
00:18:04,450 --> 00:18:11,529
this tree to actually make this not

397
00:18:07,119 --> 00:18:14,590
repair into our logs so if we have a

398
00:18:11,529 --> 00:18:20,769
look at this we're just using the agent

399
00:18:14,590 --> 00:18:26,139
handler here just using curl if we then

400
00:18:20,769 --> 00:18:27,820
alter before we actually start to input

401
00:18:26,139 --> 00:18:33,158
anything into the log to try and check

402
00:18:27,820 --> 00:18:35,019
it and in this case you can see we've

403
00:18:33,159 --> 00:18:37,889
just altered something in the strings to

404
00:18:35,019 --> 00:18:41,409
enter syntax and then kind of break it

405
00:18:37,889 --> 00:18:44,889
this then drops it there's no report in

406
00:18:41,409 --> 00:18:46,450
the log just by doing that it's no

407
00:18:44,889 --> 00:18:48,779
longer actually following the set

408
00:18:46,450 --> 00:18:52,629
structure in order for it to report back

409
00:18:48,779 --> 00:18:55,359
that is rather rather simple in order to

410
00:18:52,629 --> 00:19:00,969
break the string and make this no longer

411
00:18:55,359 --> 00:19:03,699
move forward so where as you can see

412
00:19:00,970 --> 00:19:05,830
we've we will be publishing a paper on

413
00:19:03,700 --> 00:19:10,330
this and it will be on a blog please

414
00:19:05,830 --> 00:19:13,029
follow us spectacular but surely this

415
00:19:10,330 --> 00:19:15,189
must have been reported before because

416
00:19:13,029 --> 00:19:17,649
this is something that if you don't

417
00:19:15,190 --> 00:19:18,070
trust your logs just like when I was in

418
00:19:17,649 --> 00:19:20,709
the Navy

419
00:19:18,070 --> 00:19:22,269
your ships log is your friend ship's log

420
00:19:20,710 --> 00:19:23,919
is what gets you out of trouble you can

421
00:19:22,269 --> 00:19:25,809
always refer to that and go this is my

422
00:19:23,919 --> 00:19:29,169
get-out-of-jail-free card I made this

423
00:19:25,809 --> 00:19:31,629
decision because log told me to but it

424
00:19:29,169 --> 00:19:35,320
has been reported this was reported back

425
00:19:31,629 --> 00:19:40,809
in 2012 and it wasn't taken very

426
00:19:35,320 --> 00:19:42,999
seriously yeah if you did the logs if

427
00:19:40,809 --> 00:19:45,428
that you can only do an act in

428
00:19:42,999 --> 00:19:46,419
accordance with how your logs tell you

429
00:19:45,429 --> 00:19:48,999
what happened

430
00:19:46,419 --> 00:19:51,009
we don't have mystery magic technology

431
00:19:48,999 --> 00:19:53,590
yet no matter what a number of these

432
00:19:51,009 --> 00:19:57,129
firewall companies tell me the magic box

433
00:19:53,590 --> 00:20:00,129
technology is yet to be invented but how

434
00:19:57,129 --> 00:20:03,139
can we then make this work well

435
00:20:00,130 --> 00:20:08,030
let's just do a simple simple question

436
00:20:03,140 --> 00:20:10,040
which may would may arrive anywhere the

437
00:20:08,030 --> 00:20:13,550
question is has anyone downloaded our

438
00:20:10,040 --> 00:20:17,360
database of backup tops equal during the

439
00:20:13,550 --> 00:20:20,810
last two years when it was public it's a

440
00:20:17,360 --> 00:20:23,030
very very simple question and one that

441
00:20:20,810 --> 00:20:25,250
could be very much asked by any security

442
00:20:23,030 --> 00:20:26,930
person to ask me can you prove if

443
00:20:25,250 --> 00:20:29,810
anyone's actually downloaded this breach

444
00:20:26,930 --> 00:20:32,500
database so in this environment this is

445
00:20:29,810 --> 00:20:37,010
a paid database that we have

446
00:20:32,500 --> 00:20:40,100
so as my budding sock specialist would

447
00:20:37,010 --> 00:20:41,600
do they would google her analyze s3

448
00:20:40,100 --> 00:20:45,679
access locks and they would come up to

449
00:20:41,600 --> 00:20:48,679
this lovely shiny page off of how do i

450
00:20:45,680 --> 00:20:51,140
analogue analyze Amazon s3 server access

451
00:20:48,680 --> 00:20:53,120
logic snoozing Athena to which they

452
00:20:51,140 --> 00:20:59,810
would go to their help page and tell

453
00:20:53,120 --> 00:21:03,909
them how to do so we then using spec

454
00:20:59,810 --> 00:21:08,000
techs here we're running the query so I

455
00:21:03,910 --> 00:21:10,850
think this sorry yeah mix the two up you

456
00:21:08,000 --> 00:21:13,610
see a full that results and we get zero

457
00:21:10,850 --> 00:21:15,110
records returned so there's no

458
00:21:13,610 --> 00:21:18,500
indication of compromise everything's

459
00:21:15,110 --> 00:21:20,959
a-okay and I do know a few security

460
00:21:18,500 --> 00:21:22,460
professionals that would that do like to

461
00:21:20,960 --> 00:21:23,810
use this approach of it told me

462
00:21:22,460 --> 00:21:27,020
everything is fine so everything's

463
00:21:23,810 --> 00:21:30,919
a-okay let's move on but I do like to

464
00:21:27,020 --> 00:21:32,480
prefer to use tools and the blades to

465
00:21:30,920 --> 00:21:35,270
actually work out if we really are in

466
00:21:32,480 --> 00:21:37,610
the clip and as you can see going back

467
00:21:35,270 --> 00:21:39,830
to this slide again it is a beautiful

468
00:21:37,610 --> 00:21:43,189
structure very very easy for us to

469
00:21:39,830 --> 00:21:45,379
understand but once we start then using

470
00:21:43,190 --> 00:21:47,720
that data and parse it in other ways to

471
00:21:45,380 --> 00:21:49,160
check to see if it's been broken we can

472
00:21:47,720 --> 00:21:51,550
then identify that there may be a

473
00:21:49,160 --> 00:21:51,550
mismatch

474
00:21:52,450 --> 00:22:13,049
oh it's gone on oh yes so as you can see

475
00:22:04,370 --> 00:22:15,059
now we've run same query mismatch

476
00:22:13,049 --> 00:22:17,658
there it's definitely saying that

477
00:22:15,059 --> 00:22:20,549
something hasn't gone right with this

478
00:22:17,659 --> 00:22:22,230
half of the packets of other bit have

479
00:22:20,549 --> 00:22:25,649
been dropped and is no longer producing

480
00:22:22,230 --> 00:22:29,639
this within the log but we can then

481
00:22:25,649 --> 00:22:33,209
start to see how far he did get until it

482
00:22:29,639 --> 00:22:36,360
was worked out until we can actually see

483
00:22:33,210 --> 00:22:38,190
somebody had altered that string just

484
00:22:36,360 --> 00:22:41,189
changing it enough in order for it to

485
00:22:38,190 --> 00:22:44,489
give us a zero result at the start we

486
00:22:41,190 --> 00:22:47,340
can now start producing actual data to

487
00:22:44,489 --> 00:22:49,739
see who really got it now we are losing

488
00:22:47,340 --> 00:22:52,949
data still because it's not in a correct

489
00:22:49,739 --> 00:22:54,629
format apart from we do have the things

490
00:22:52,950 --> 00:22:59,609
that you probably want to answer on that

491
00:22:54,629 --> 00:23:03,299
question who actually downloaded it what

492
00:22:59,609 --> 00:23:06,809
time stamp when where which then starts

493
00:23:03,299 --> 00:23:08,730
to help it gives you a small string to

494
00:23:06,809 --> 00:23:14,100
follow in terms you to investigate how

495
00:23:08,730 --> 00:23:16,200
we can go further on this the big

496
00:23:14,100 --> 00:23:19,080
problem we do have is we don't like to

497
00:23:16,200 --> 00:23:20,700
look at our logs we don't actually like

498
00:23:19,080 --> 00:23:23,100
to look at the small bits of information

499
00:23:20,700 --> 00:23:25,559
that tell us what's going on we like to

500
00:23:23,100 --> 00:23:26,969
look at loud and proud the thing that

501
00:23:25,559 --> 00:23:28,769
gives you all of the critical analysis

502
00:23:26,970 --> 00:23:32,489
and everything that's going wrong and

503
00:23:28,769 --> 00:23:35,580
everything there but as you can see just

504
00:23:32,489 --> 00:23:37,289
using this structure we can start to get

505
00:23:35,580 --> 00:23:39,779
an indication of where this data was

506
00:23:37,289 --> 00:23:41,639
downloaded and then to actually do the

507
00:23:39,779 --> 00:23:43,230
real investigation rather than either

508
00:23:41,639 --> 00:23:45,748
doing the other two which is

509
00:23:43,230 --> 00:23:48,629
everything's a-okay I can't see anything

510
00:23:45,749 --> 00:23:52,049
or everything is paid chaos everything

511
00:23:48,629 --> 00:23:55,678
is panicking so there is going to be a

512
00:23:52,049 --> 00:23:57,720
full technical documentation that will

513
00:23:55,679 --> 00:24:01,529
be on this if you follow the spec text

514
00:23:57,720 --> 00:24:03,119
lab we will post that and would be a

515
00:24:01,529 --> 00:24:03,989
nice interesting read complete this

516
00:24:03,119 --> 00:24:07,080
lovely data

517
00:24:03,989 --> 00:24:10,259
my lovely Carney girl na will be also

518
00:24:07,080 --> 00:24:11,699
very available for them advanced paper

519
00:24:10,259 --> 00:24:15,299
that he's written it's really

520
00:24:11,700 --> 00:24:19,559
particularly impressive from from my

521
00:24:15,299 --> 00:24:22,139
side the reason I actually I've got five

522
00:24:19,559 --> 00:24:26,190
six jobs I work at Cambridge University

523
00:24:22,139 --> 00:24:26,850
I work at Defence Academy for the United

524
00:24:26,190 --> 00:24:28,409
Kingdom

525
00:24:26,850 --> 00:24:30,449
tell techn University and I also

526
00:24:28,409 --> 00:24:31,830
occasionally run around and try and

527
00:24:30,450 --> 00:24:34,080
break into warships but that's another

528
00:24:31,830 --> 00:24:36,360
question over there but one of the

529
00:24:34,080 --> 00:24:38,039
reasons that I actually actually asked

530
00:24:36,360 --> 00:24:39,809
spec Tech's to go and do their stuff is

531
00:24:38,039 --> 00:24:42,539
it's one of the greatest systems I've

532
00:24:39,809 --> 00:24:47,490
seen to actually look at logs and from

533
00:24:42,539 --> 00:24:49,649
my time as a incident responder it's the

534
00:24:47,490 --> 00:24:51,299
thing that always saved me is actually

535
00:24:49,649 --> 00:24:54,029
knowing what an earthed is going on my

536
00:24:51,299 --> 00:24:57,860
system I did like that a previous talk

537
00:24:54,029 --> 00:25:01,710
if you heard the these sighs O's dynamo

538
00:24:57,860 --> 00:25:03,360
the never-ending circle you don't get

539
00:25:01,710 --> 00:25:08,220
that in universities we break at the

540
00:25:03,360 --> 00:25:10,529
first hurdle we don't have any money we

541
00:25:08,220 --> 00:25:12,480
had to do everything by love and Python

542
00:25:10,529 --> 00:25:14,490
scripting and by just hoping for the

543
00:25:12,480 --> 00:25:16,980
best and trying to manipulate that data

544
00:25:14,490 --> 00:25:18,480
however I must dress that's not a good

545
00:25:16,980 --> 00:25:22,769
way to follow either you just end up

546
00:25:18,480 --> 00:25:24,419
with gray hair at 26 with this once you

547
00:25:22,769 --> 00:25:26,159
do get to see what's going on - you're

548
00:25:24,419 --> 00:25:28,019
underlining you can understand to fix

549
00:25:26,159 --> 00:25:30,360
your real problems rather than just

550
00:25:28,019 --> 00:25:32,309
magic firewall technology which we all

551
00:25:30,360 --> 00:25:40,370
know is award-winning until it goes

552
00:25:32,309 --> 00:25:40,370
wrong if you would like any questions

553
00:26:11,090 --> 00:26:14,159
[Music]

554
00:26:42,220 --> 00:26:45,299
[Applause]

555
00:27:02,330 --> 00:27:08,089
[Music]

556
00:27:19,030 --> 00:27:22,139
[Music]

557
00:27:24,750 --> 00:27:27,809
[Music]

558
00:27:32,130 --> 00:27:35,249
[Music]

559
00:27:50,380 --> 00:27:53,479
[Applause]

560
00:28:16,940 --> 00:28:44,610
always and we need to constantly they

561
00:28:43,320 --> 00:28:54,059
are

562
00:28:44,610 --> 00:28:55,500
I could take home for anything is

563
00:28:54,059 --> 00:28:57,960
definitely do make sure your teams play

564
00:28:55,500 --> 00:29:00,450
with it do play with the logs dude have

565
00:28:57,960 --> 00:29:02,549
a look at seeing what stuff is actually

566
00:29:00,450 --> 00:29:04,620
happening and because if you're just

567
00:29:02,549 --> 00:29:06,840
only dealing with the incidents that are

568
00:29:04,620 --> 00:29:09,209
reported when you're getting an alert

569
00:29:06,840 --> 00:29:12,149
well that is when your car alarms going

570
00:29:09,210 --> 00:29:14,370
off and your cars being broken into if

571
00:29:12,150 --> 00:29:16,020
you can see other stuff and the only way

572
00:29:14,370 --> 00:29:19,590
you can do this is by being creative

573
00:29:16,020 --> 00:29:24,650
just having a look finding out questions

574
00:29:19,590 --> 00:29:27,389
I was running am summer school in the

575
00:29:24,650 --> 00:29:29,520
student July this year at the University

576
00:29:27,390 --> 00:29:31,650
Cambridge with three people at three

577
00:29:29,520 --> 00:29:33,090
weeks of people that were just not

578
00:29:31,650 --> 00:29:36,480
cybersecurity professionals in the

579
00:29:33,090 --> 00:29:37,949
slightest but because they were doing

580
00:29:36,480 --> 00:29:40,530
everything that we did and they were

581
00:29:37,950 --> 00:29:42,809
just googling and being creative so far

582
00:29:40,530 --> 00:29:44,250
out of the hundred and ninety people

583
00:29:42,809 --> 00:29:47,129
they attempted to attack we have a

584
00:29:44,250 --> 00:29:48,890
hundred percent success rate with people

585
00:29:47,130 --> 00:29:52,020
that aren't trained in cyber security

586
00:29:48,890 --> 00:29:53,520
where is with my master's of course of

587
00:29:52,020 --> 00:29:55,230
doing exactly the same thing that people

588
00:29:53,520 --> 00:29:58,200
have done cyber security it's around

589
00:29:55,230 --> 00:30:00,720
about 52% because they're thinking

590
00:29:58,200 --> 00:30:02,429
differently and they're not we by

591
00:30:00,720 --> 00:30:05,250
inherently only doing the things that

592
00:30:02,429 --> 00:30:07,500
we've ever seen from a defending point

593
00:30:05,250 --> 00:30:11,460
of view whereas they don't have any of

594
00:30:07,500 --> 00:30:14,299
this cloud fog really so they were

595
00:30:11,460 --> 00:30:14,299
having an adventure

596
00:30:17,850 --> 00:30:20,980
[Music]

597
00:31:05,260 --> 00:31:08,460
[Music]

598
00:31:10,820 --> 00:31:28,340
it's not a father I do and he should be

599
00:31:22,520 --> 00:31:36,210
silly fish as they are today and fossil

600
00:31:28,340 --> 00:31:43,530
fuels and reduce overall walk given up

601
00:31:36,210 --> 00:31:48,860
by resources ready to access the revisit

602
00:31:43,530 --> 00:31:56,000
my that's why it's endearing

603
00:31:48,860 --> 00:31:56,000
I want to reduce my more by zero by

604
00:31:56,960 --> 00:32:07,340
saying I see

605
00:32:17,270 --> 00:32:20,579
[Applause]

