1
00:00:02,480 --> 00:00:12,530
all right welcome to breaking badge the

2
00:00:08,210 --> 00:00:18,439
well story behind your 44 combadge

3
00:00:12,530 --> 00:00:20,820
effectively and that's by myself

4
00:00:18,439 --> 00:00:25,439
well my calling you by your proper name

5
00:00:20,820 --> 00:00:28,410
or fuchsine whatever right the duck yeah

6
00:00:25,439 --> 00:00:30,029
so we're obviously celebrity look-alikes

7
00:00:28,410 --> 00:00:30,900
for a handy crane and Ed the duck if you

8
00:00:30,029 --> 00:00:35,460
don't know who they are

9
00:00:30,900 --> 00:00:52,890
google them please right yeah and yeah

10
00:00:35,460 --> 00:00:54,900
you're probably too young for young

11
00:00:52,890 --> 00:01:11,070
candid camera Sam you know you're being

12
00:00:54,900 --> 00:01:13,740
recorded yeah let's go positive okay so

13
00:01:11,070 --> 00:01:16,110
as I was saying I'm Tim this is fusion

14
00:01:13,740 --> 00:01:17,729
and we're celebrity look-alikes for

15
00:01:16,110 --> 00:01:19,620
handy crane and Ned the duck we cracked

16
00:01:17,730 --> 00:01:21,930
that joke nobody laughed that's fine

17
00:01:19,620 --> 00:01:24,810
I am an exit since I'm in doing

18
00:01:21,930 --> 00:01:28,320
management stuff I'm security testing

19
00:01:24,810 --> 00:01:30,450
yes right and I'm Timmy whimmy and he's

20
00:01:28,320 --> 00:01:32,158
at fusion on Twitter and we're

21
00:01:30,450 --> 00:01:33,500
definitely not replicants in any way

22
00:01:32,159 --> 00:01:36,600
shape or form

23
00:01:33,500 --> 00:01:39,150
right so the badge that you should all

24
00:01:36,600 --> 00:01:40,559
have hanging around your neck you know

25
00:01:39,150 --> 00:01:42,960
you can get stickers for these as well

26
00:01:40,560 --> 00:01:44,520
by the way though I'm floating around so

27
00:01:42,960 --> 00:01:47,399
you can have police want maybe the

28
00:01:44,520 --> 00:01:50,399
tyrell logo all right you can decide who

29
00:01:47,400 --> 00:01:55,260
you want to be but they are based on the

30
00:01:50,400 --> 00:01:56,970
SLA four four four two chips up and this

31
00:01:55,260 --> 00:02:00,479
is basically all the cards are actually

32
00:01:56,970 --> 00:02:05,009
compatible you can't buy a 4-4-2 anymore

33
00:02:00,479 --> 00:02:08,580
sorry three four starting a four four

34
00:02:05,010 --> 00:02:11,489
four two chip anymore so they're all

35
00:02:08,580 --> 00:02:12,420
compatible ones which is great fun they

36
00:02:11,489 --> 00:02:14,850
are intelligent

37
00:02:12,420 --> 00:02:19,859
eproms they have 256

38
00:02:14,850 --> 00:02:21,930
white memory on them with right

39
00:02:19,860 --> 00:02:24,450
protection function and programmable

40
00:02:21,930 --> 00:02:26,820
security code so that makes me sound

41
00:02:24,450 --> 00:02:31,410
totally secure and they are compatible

42
00:02:26,820 --> 00:02:33,690
with ISO 7816 if you want to read and

43
00:02:31,410 --> 00:02:36,450
write them and the data can only be

44
00:02:33,690 --> 00:02:39,030
changed after entry of the correct three

45
00:02:36,450 --> 00:02:41,519
byte programmable security code all the

46
00:02:39,030 --> 00:02:43,020
security memory this is all taken from

47
00:02:41,520 --> 00:02:47,700
the date sheet and this is exactly what

48
00:02:43,020 --> 00:02:51,270
it actually says there so you have pin

49
00:02:47,700 --> 00:02:53,010
outs for your as you can see we've got 5

50
00:02:51,270 --> 00:02:56,010
volts we've got reset we've got clock

51
00:02:53,010 --> 00:02:57,899
we've got ground and we've got data so

52
00:02:56,010 --> 00:03:00,120
say you're a man-in-the-middle illness

53
00:02:57,900 --> 00:03:04,110
I'll show you how we did that earlier

54
00:03:00,120 --> 00:03:08,220
but I'll show you how we did it later

55
00:03:04,110 --> 00:03:11,580
your presentation place is the wires you

56
00:03:08,220 --> 00:03:13,260
want to connect up there's a link in the

57
00:03:11,580 --> 00:03:15,260
actual thing for where we actually

58
00:03:13,260 --> 00:03:19,170
pulled this from and as you can tell

59
00:03:15,260 --> 00:03:20,519
kinko which is operated by FedEx used to

60
00:03:19,170 --> 00:03:23,280
actually use this system for keeping

61
00:03:20,520 --> 00:03:25,590
track photocopy there was a Def Con

62
00:03:23,280 --> 00:03:27,990
presentation where a lot of this stuff

63
00:03:25,590 --> 00:03:31,380
was actually revealed to be very very

64
00:03:27,990 --> 00:03:33,390
insecure the main reason being that this

65
00:03:31,380 --> 00:03:39,720
is the memory overview of it as you can

66
00:03:33,390 --> 00:03:42,179
see right here it's resection point you

67
00:03:39,720 --> 00:03:45,030
know the resection does not require any

68
00:03:42,180 --> 00:03:47,660
form of security so you can read these

69
00:03:45,030 --> 00:03:50,250
devices without knowing the pin number

70
00:03:47,660 --> 00:03:51,000
but if people don't change the pin

71
00:03:50,250 --> 00:03:55,440
number

72
00:03:51,000 --> 00:04:00,720
you know the default PIN number is ffff

73
00:03:55,440 --> 00:04:04,490
all right so yeah I remember every time

74
00:04:00,720 --> 00:04:05,760
you don't change default Kretz got disk

75
00:04:04,490 --> 00:04:07,770
yeah

76
00:04:05,760 --> 00:04:12,090
it's Thomas that one I'm not sure which

77
00:04:07,770 --> 00:04:15,060
one that's gonna be next but yeah so

78
00:04:12,090 --> 00:04:16,950
going back to this a second yeah so the

79
00:04:15,060 --> 00:04:20,070
only time that you actually need this

80
00:04:16,950 --> 00:04:22,740
code is to actually overwrite certain

81
00:04:20,070 --> 00:04:25,550
bits of data they're not necessarily all

82
00:04:22,740 --> 00:04:25,550
the data as well

83
00:04:27,720 --> 00:04:33,600
right so if you've got a card reader in

84
00:04:31,290 --> 00:04:36,420
your laptop right this one's actually

85
00:04:33,600 --> 00:04:37,650
from my particular card reader in my

86
00:04:36,420 --> 00:04:42,480
dull laptop over there

87
00:04:37,650 --> 00:04:46,049
it really hates these cards pointing out

88
00:04:42,480 --> 00:04:48,930
my laptop okay yeah it really really

89
00:04:46,050 --> 00:04:53,160
hates these cards so I have no idea why

90
00:04:48,930 --> 00:04:55,290
and yeah same laptop same software just

91
00:04:53,160 --> 00:04:56,970
different card reader will give you

92
00:04:55,290 --> 00:04:59,340
something like that based off exactly

93
00:04:56,970 --> 00:05:02,100
the same card so if you are getting card

94
00:04:59,340 --> 00:05:06,510
unresponsive and you're using basically

95
00:05:02,100 --> 00:05:12,410
not the only Kia 3021 that's probably

96
00:05:06,510 --> 00:05:12,409
actually where you're going wrong okay I

97
00:05:12,860 --> 00:05:22,860
cannot miss once right right so software

98
00:05:19,890 --> 00:05:23,700
do you actually need it's quite an

99
00:05:22,860 --> 00:05:28,890
extensive list

100
00:05:23,700 --> 00:05:31,130
yeah well that's pop right so the actual

101
00:05:28,890 --> 00:05:35,820
files you actually need to install our

102
00:05:31,130 --> 00:05:38,060
pcs CD which is a daemon which I'll

103
00:05:35,820 --> 00:05:41,940
handle talking to the card reader and

104
00:05:38,060 --> 00:05:43,080
communications PC SC tools will give you

105
00:05:41,940 --> 00:05:44,610
a load of tools that you can actually

106
00:05:43,080 --> 00:05:47,840
then interface with the cars

107
00:05:44,610 --> 00:05:50,880
well interface with the demon itself so

108
00:05:47,840 --> 00:05:52,830
two tools you can use are scripter and g

109
00:05:50,880 --> 00:05:56,909
script up which will allow you to read

110
00:05:52,830 --> 00:05:58,500
and write to the cards directly but you

111
00:05:56,910 --> 00:06:00,510
do need to know all the byte codes

112
00:05:58,500 --> 00:06:03,919
you're sending to them which is great

113
00:06:00,510 --> 00:06:03,919
fun you should try to go over

114
00:06:07,370 --> 00:06:13,470
if you're using Windows so fortunately

115
00:06:11,460 --> 00:06:14,580
for you guys it's actually part of the

116
00:06:13,470 --> 00:06:16,890
base operating system

117
00:06:14,580 --> 00:06:19,080
once upon a time these cards actually

118
00:06:16,890 --> 00:06:20,610
allowed you to log into Windows right

119
00:06:19,080 --> 00:06:23,010
because he needs Windows hello

120
00:06:20,610 --> 00:06:28,370
you know just card that you can

121
00:06:23,010 --> 00:06:28,370
arbitrarily phone and read it's fine

122
00:06:31,190 --> 00:06:39,780
some real muttering right yeah the apps

123
00:06:37,080 --> 00:06:41,609
are dependent on the reader so literally

124
00:06:39,780 --> 00:06:43,948
you can go to all many keys website

125
00:06:41,610 --> 00:06:47,370
load software to actually read and write

126
00:06:43,949 --> 00:06:48,870
cards today's like I say the only thing

127
00:06:47,370 --> 00:06:57,689
you actually need is the default key

128
00:06:48,870 --> 00:07:00,210
which is three bites of ffffff okay

129
00:06:57,689 --> 00:07:02,250
so if you wanted to man-in-the-middle

130
00:07:00,210 --> 00:07:04,229
these cards because say somebody's

131
00:07:02,250 --> 00:07:07,830
actually changing the pin and the pin is

132
00:07:04,229 --> 00:07:09,840
actually protected so if you do try and

133
00:07:07,830 --> 00:07:11,580
brute force in you're gonna be out of

134
00:07:09,840 --> 00:07:13,318
luck right

135
00:07:11,580 --> 00:07:16,349
you get three goes and then your card

136
00:07:13,319 --> 00:07:20,340
locks you can still read it but you

137
00:07:16,349 --> 00:07:22,620
can't write to it and that's it so we

138
00:07:20,340 --> 00:07:26,119
actually did this if anybody can spot a

139
00:07:22,620 --> 00:07:29,099
mistake on this slide well in the images

140
00:07:26,120 --> 00:07:30,779
right right right

141
00:07:29,099 --> 00:07:32,759
this is actually conductive paint this

142
00:07:30,779 --> 00:07:36,029
does actually work after refreshing

143
00:07:32,759 --> 00:07:38,340
because I've got Cod here if you

144
00:07:36,029 --> 00:07:42,900
actually think about the pin at one of

145
00:07:38,340 --> 00:07:44,159
these pins is no connection and I put it

146
00:07:42,900 --> 00:07:48,270
as this one here right at the very

147
00:07:44,159 --> 00:07:50,039
bottom yeah unfortunately that one's

148
00:07:48,270 --> 00:07:51,810
actually one of the ones in use and it's

149
00:07:50,039 --> 00:07:55,139
the one on the opposite side and so at

150
00:07:51,810 --> 00:07:56,879
what draw an extra pin in so yeah

151
00:07:55,139 --> 00:07:58,949
actually got the cards that we actually

152
00:07:56,879 --> 00:08:07,169
used to play about with if you wanna

153
00:07:58,949 --> 00:08:08,699
have a look around and pass these but

154
00:08:07,169 --> 00:08:10,710
effectively what you can do on this is

155
00:08:08,699 --> 00:08:13,349
just put them into the card reader

156
00:08:10,710 --> 00:08:15,539
attach your bus pirate set the bot bus

157
00:08:13,349 --> 00:08:19,009
pirate up with the correct baud rate and

158
00:08:15,539 --> 00:08:20,699
speed and then you can actually start

159
00:08:19,009 --> 00:08:22,919
intercepting all the commands as they

160
00:08:20,699 --> 00:08:24,569
fly over the wire and decoding

161
00:08:22,919 --> 00:08:27,120
everything and this is how the original

162
00:08:24,569 --> 00:08:30,569
Kinkos hat was done so he was able to

163
00:08:27,120 --> 00:08:32,399
get the pin number out of it and then he

164
00:08:30,569 --> 00:08:35,310
could program up the card to do whatever

165
00:08:32,399 --> 00:08:39,208
he wants including changing his balance

166
00:08:35,309 --> 00:08:41,309
he could ya make it say that he'd

167
00:08:39,208 --> 00:08:43,978
actually printed out 20 things and yet

168
00:08:41,309 --> 00:08:47,609
still got a credit at one pound or on

169
00:08:43,979 --> 00:08:49,880
dollar in this case yeah so you can

170
00:08:47,610 --> 00:08:51,930
literally change anything on the card if

171
00:08:49,880 --> 00:08:56,390
you just need to figure out what's the

172
00:08:51,930 --> 00:08:56,390
system for it okay

173
00:08:56,649 --> 00:09:02,810
yes the default key is 6s yeah but is

174
00:09:01,339 --> 00:09:04,759
that hitting the bar yeah

175
00:09:02,810 --> 00:09:07,729
sorry if I keep changing you Trinity

176
00:09:04,759 --> 00:09:12,699
yeah there is only one protection

177
00:09:07,730 --> 00:09:12,699
mechanism on these cards and that is yep

178
00:09:13,000 --> 00:09:22,449
yes it resets to after three is dead

179
00:09:22,750 --> 00:09:27,980
yeah if if you think about it if you

180
00:09:26,180 --> 00:09:29,660
could reset it after the three then

181
00:09:27,980 --> 00:09:37,839
you've just violated your security

182
00:09:29,660 --> 00:09:37,839
control yeah yeah they are what they are

183
00:09:42,699 --> 00:09:47,839
right

184
00:09:43,939 --> 00:09:49,819
technically you may be able to do that

185
00:09:47,839 --> 00:09:53,779
you've got a D cap it to actually do

186
00:09:49,819 --> 00:09:55,939
that which we've not tried to but as it

187
00:09:53,779 --> 00:09:59,029
is an EEPROM and all the Proms will

188
00:09:55,939 --> 00:10:04,430
glaze it with UV light potentially yes

189
00:09:59,029 --> 00:10:05,990
you could but you will reset all the

190
00:10:04,430 --> 00:10:09,620
data that's on the card as well at the

191
00:10:05,990 --> 00:10:11,420
same time if they haven't put in place

192
00:10:09,620 --> 00:10:14,720
any extra protection mechanisms as well

193
00:10:11,420 --> 00:10:16,339
and you don't have to shine it down at

194
00:10:14,720 --> 00:10:20,949
an angle which is usually the way you

195
00:10:16,339 --> 00:10:24,980
have to do it okay

196
00:10:20,949 --> 00:10:27,290
so reading a card is basically as simple

197
00:10:24,980 --> 00:10:29,329
as you issue a command and it gives up

198
00:10:27,290 --> 00:10:35,089
the goods it's really really a cheap

199
00:10:29,329 --> 00:10:38,180
date it's easy so you actually do and in

200
00:10:35,089 --> 00:10:39,500
the datasheet the command is about well

201
00:10:38,180 --> 00:10:41,660
you tell it where you want to start

202
00:10:39,500 --> 00:10:44,300
reading from and it'll give you all the

203
00:10:41,660 --> 00:10:46,040
information from that point on so it's

204
00:10:44,300 --> 00:10:54,019
not particularly difficult to actually

205
00:10:46,040 --> 00:10:57,019
do so when you're actually writing your

206
00:10:54,019 --> 00:10:59,860
card you need to actually first issue a

207
00:10:57,019 --> 00:11:03,620
command to verify the PIN number and

208
00:10:59,860 --> 00:11:06,980
assuming that one is successful you can

209
00:11:03,620 --> 00:11:07,910
then it raised all the card data which

210
00:11:06,980 --> 00:11:10,250
is done

211
00:11:07,910 --> 00:11:12,469
so what you actually do it will eraser

212
00:11:10,250 --> 00:11:15,680
and it will write all one small sectors

213
00:11:12,470 --> 00:11:19,400
this is probably why the pin is F F F F

214
00:11:15,680 --> 00:11:21,829
F F as well because then when you want

215
00:11:19,400 --> 00:11:26,270
to actually write data to it it will and

216
00:11:21,830 --> 00:11:27,710
the data onto the memory and so yeah

217
00:11:26,270 --> 00:11:30,170
that's why you'll find a load of the

218
00:11:27,710 --> 00:11:32,660
sectors on your cards will be F F F F

219
00:11:30,170 --> 00:11:38,510
all over the place when you actually try

220
00:11:32,660 --> 00:11:47,030
to read and humble man okay so any

221
00:11:38,510 --> 00:11:48,740
questions about that so far yeah but

222
00:11:47,030 --> 00:11:55,180
most of the software you use will

223
00:11:48,740 --> 00:11:57,380
abstract that for you anyway alright so

224
00:11:55,180 --> 00:11:59,180
thinking about the security model of

225
00:11:57,380 --> 00:12:01,070
this thing since I believe there is a

226
00:11:59,180 --> 00:12:02,870
challenge actually for you to come up

227
00:12:01,070 --> 00:12:06,830
with a system that can actually use this

228
00:12:02,870 --> 00:12:12,050
card well I want to say securely here

229
00:12:06,830 --> 00:12:16,130
but there has to be the security of it

230
00:12:12,050 --> 00:12:20,510
doesn't have to rely on yeah basically

231
00:12:16,130 --> 00:12:23,330
O's yeah if you use it the card cannot

232
00:12:20,510 --> 00:12:26,330
actually make it any worse right

233
00:12:23,330 --> 00:12:27,890
so we've heard talk of PAM modules so

234
00:12:26,330 --> 00:12:29,510
where you it basically prompts you for

235
00:12:27,890 --> 00:12:32,240
who do you want to be you plug in the

236
00:12:29,510 --> 00:12:37,970
card and it just lobs you in stuff like

237
00:12:32,240 --> 00:12:40,580
that but yeah so when somebody actually

238
00:12:37,970 --> 00:12:42,500
did this they must have thought about

239
00:12:40,580 --> 00:12:43,790
the security model well I'd like to

240
00:12:42,500 --> 00:12:45,980
think they thought about the security

241
00:12:43,790 --> 00:12:47,750
model this is probably the management

242
00:12:45,980 --> 00:12:50,450
part of me coming out right and

243
00:12:47,750 --> 00:12:53,980
obviously the CIA try it because

244
00:12:50,450 --> 00:12:58,120
everybody loves that so confidentiality

245
00:12:53,980 --> 00:12:58,120
it's my favorite thing in the world

246
00:12:58,390 --> 00:13:04,460
clearly not a thing on this card right

247
00:13:01,070 --> 00:13:08,630
you can read it regardless there is no

248
00:13:04,460 --> 00:13:12,410
security controls to stop you whatsoever

249
00:13:08,630 --> 00:13:16,510
and so yeah so if you're going to put

250
00:13:12,410 --> 00:13:16,510
any data on there expect it to be cloned

251
00:13:18,520 --> 00:13:24,199
integrity so you do actually have

252
00:13:21,620 --> 00:13:25,819
some integrity in place which is that

253
00:13:24,199 --> 00:13:30,079
pin number to stop it actually being

254
00:13:25,819 --> 00:13:31,599
changed but as we've discussed earlier

255
00:13:30,079 --> 00:13:33,699
we can money in the middle of this thing

256
00:13:31,600 --> 00:13:36,499
assuming it's not completely hidden

257
00:13:33,699 --> 00:13:38,240
certainly the card readers we've got hey

258
00:13:36,499 --> 00:13:43,249
you can put the card in and you will be

259
00:13:38,240 --> 00:13:45,259
able to get at the back ports also fail

260
00:13:43,249 --> 00:13:46,970
ability in general if you've got these

261
00:13:45,259 --> 00:13:49,819
cards you need a way of replacing them

262
00:13:46,970 --> 00:13:52,519
because they are going to actually get

263
00:13:49,819 --> 00:13:55,519
lost get stolen get broken this is why

264
00:13:52,519 --> 00:14:00,439
they were used for Kinkos in the first

265
00:13:55,519 --> 00:14:02,449
place and yeah basically if you lose

266
00:14:00,439 --> 00:14:07,939
your card you can't then use it that

267
00:14:02,449 --> 00:14:10,189
somebody else can make them along so how

268
00:14:07,939 --> 00:14:12,519
you're actually going to use that to do

269
00:14:10,189 --> 00:14:16,610
something that's gonna be securely

270
00:14:12,519 --> 00:14:19,699
really it's difficult the only thing

271
00:14:16,610 --> 00:14:22,670
that I could actually think of to

272
00:14:19,699 --> 00:14:24,589
actually use this is something that's

273
00:14:22,670 --> 00:14:27,349
going to hold an encryption an encrypted

274
00:14:24,589 --> 00:14:30,860
message which is then validated by

275
00:14:27,350 --> 00:14:34,699
back-end so if you store a hash of say a

276
00:14:30,860 --> 00:14:36,439
user ID and a transaction ID and then

277
00:14:34,699 --> 00:14:39,319
you keep writing that transaction ID to

278
00:14:36,439 --> 00:14:42,620
the card so it automatically changes but

279
00:14:39,319 --> 00:14:44,479
it's encrypted on the card if somebody

280
00:14:42,620 --> 00:14:47,180
claims oh then one of the clones is

281
00:14:44,480 --> 00:14:48,740
gonna stop working retention that's the

282
00:14:47,180 --> 00:14:50,689
only thing that I could ever think of

283
00:14:48,740 --> 00:14:54,740
first I don't know maybe you guys have

284
00:14:50,689 --> 00:14:56,719
got some other ideas but you see well

285
00:14:54,740 --> 00:15:00,610
yeah it would be interesting to see and

286
00:14:56,720 --> 00:15:00,610
that's the basis it's a challenge so

287
00:15:08,740 --> 00:15:11,799
[Music]

288
00:15:14,860 --> 00:15:20,569
yeah so would you actually have public

289
00:15:19,040 --> 00:15:30,410
key on the card or the private key which

290
00:15:20,569 --> 00:15:31,878
is saying ok right ok so people can

291
00:15:30,410 --> 00:15:34,209
still root for sure

292
00:15:31,879 --> 00:15:34,209
key

293
00:15:35,440 --> 00:15:41,150
well yeah you'd brute-force the password

294
00:15:38,030 --> 00:15:49,390
as Paul was saying you can only have 256

295
00:15:41,150 --> 00:15:54,130
bytes for your p226 - true right - yeah

296
00:15:49,390 --> 00:15:58,250
yep basically you get off that's 200

297
00:15:54,130 --> 00:16:01,820
yeah so 220 bytes you're gonna have for

298
00:15:58,250 --> 00:16:04,970
a key that's gonna be problematic your

299
00:16:01,820 --> 00:16:06,560
and also if you lose your key somebody

300
00:16:04,970 --> 00:16:08,860
else can read it they can brute force it

301
00:16:06,560 --> 00:16:11,390
they can do what they want with it

302
00:16:08,860 --> 00:16:41,150
essentially it's a good idea though but

303
00:16:11,390 --> 00:16:44,170
ya know yeah right well if you can

304
00:16:41,150 --> 00:16:46,430
attack the software we've actually had a

305
00:16:44,170 --> 00:16:48,050
certain bits of software actually

306
00:16:46,430 --> 00:16:49,790
dumping out all the codes that they were

307
00:16:48,050 --> 00:16:52,760
writing to the cards and as they were

308
00:16:49,790 --> 00:16:55,910
reading so we've actually done it from

309
00:16:52,760 --> 00:16:58,780
that side of things this well this is

310
00:16:55,910 --> 00:17:01,240
what our readers actually look like so

311
00:16:58,780 --> 00:17:13,579
he's actually got the card at the moment

312
00:17:01,240 --> 00:17:14,839
they're at the back right probably

313
00:17:13,579 --> 00:17:17,599
nobody's gonna be able to see this

314
00:17:14,839 --> 00:17:19,129
anyway but yeah for the man in the

315
00:17:17,599 --> 00:17:21,679
middle people naturally just plug it in

316
00:17:19,130 --> 00:17:24,110
like that and all the pink contacts on

317
00:17:21,680 --> 00:17:26,360
this card are still intact when you

318
00:17:24,109 --> 00:17:28,000
actually try and read it still works but

319
00:17:26,359 --> 00:17:30,889
you've now got all these pins on the top

320
00:17:28,000 --> 00:17:31,970
which you can then plug into your bus

321
00:17:30,890 --> 00:17:38,840
pirate to actually extract the

322
00:17:31,970 --> 00:17:40,640
information at the same time yeah you'd

323
00:17:38,840 --> 00:17:46,990
still use the software to read and write

324
00:17:40,640 --> 00:17:46,990
from it yeah yeah

325
00:17:47,240 --> 00:17:51,380
yeah Kinkos II literally went into the

326
00:17:49,340 --> 00:17:56,240
shop and actually attacked this directly

327
00:17:51,380 --> 00:17:59,030
yeah I think she plug it in pay money

328
00:17:56,240 --> 00:18:05,510
but he had the thing listening on the

329
00:17:59,030 --> 00:18:06,470
boss as the capital dated yeah I'll see

330
00:18:05,510 --> 00:18:08,360
you because easy to set in the

331
00:18:06,470 --> 00:18:11,000
communication between the card on the

332
00:18:08,360 --> 00:18:13,820
machine you could get all the traffic in

333
00:18:11,000 --> 00:18:16,670
our Rob that's what that's deal lock a

334
00:18:13,820 --> 00:18:18,320
BP you yeah yeah so you see the bytes

335
00:18:16,670 --> 00:18:20,690
coming through but well that's that's it

336
00:18:18,320 --> 00:18:29,809
that's doubly enticing and then the

337
00:18:20,690 --> 00:18:32,570
condition want me to run well I mean

338
00:18:29,809 --> 00:18:34,490
it's only sending like sending like a

339
00:18:32,570 --> 00:18:37,460
bunch of ice don't so you could even

340
00:18:34,490 --> 00:18:39,170
just like a program so if like for

341
00:18:37,460 --> 00:18:42,590
example like those cards are the same

342
00:18:39,170 --> 00:18:44,570
solvent slimming world cards so the

343
00:18:42,590 --> 00:18:47,899
people who do something world humbucker

344
00:18:44,570 --> 00:18:50,450
PC with the reader cell put in they've

345
00:18:47,900 --> 00:18:52,730
on their program which then sends they a

346
00:18:50,450 --> 00:18:54,320
lot called down and then rights to it if

347
00:18:52,730 --> 00:18:56,690
anybody's interested it does store your

348
00:18:54,320 --> 00:18:58,790
name in plain text on most cards because

349
00:18:56,690 --> 00:19:01,160
I've got one I don't know if extortion

350
00:18:58,790 --> 00:19:05,690
wait in plain texts is don't want to

351
00:19:01,160 --> 00:19:07,790
find that but yeah and so it's not

352
00:19:05,690 --> 00:19:09,140
necessarily like hardware think because

353
00:19:07,790 --> 00:19:13,120
obviously some software will handle

354
00:19:09,140 --> 00:19:16,850
squads winning we did find a - my drink

355
00:19:13,120 --> 00:19:19,939
which abstracts a lot of this stuff so

356
00:19:16,850 --> 00:19:22,730
you can just create low - scripts that -

357
00:19:19,940 --> 00:19:25,670
connected hard to read from it if you

358
00:19:22,730 --> 00:19:28,550
know the pin and you know the sets of

359
00:19:25,670 --> 00:19:35,150
byte codes - to do those things which

360
00:19:28,550 --> 00:19:41,830
are all in the datasheet yeah I can't

361
00:19:35,150 --> 00:19:41,830
talk is this right but Sir yeah

362
00:19:45,309 --> 00:19:53,500
does anybody have any other questions

363
00:19:50,320 --> 00:19:53,500
[Music]

364
00:19:56,260 --> 00:20:02,549
yep they are

365
00:19:59,110 --> 00:20:05,049
which I don't know if you've got the

366
00:20:02,549 --> 00:20:07,420
datasheet on there I've got everything

367
00:20:05,049 --> 00:20:08,710
that you put in the report right okay we

368
00:20:07,420 --> 00:20:10,179
do actually have a repository where

369
00:20:08,710 --> 00:20:12,730
we've actually just crammed in a load of

370
00:20:10,179 --> 00:20:14,380
stuff that we've been looking up which

371
00:20:12,730 --> 00:20:18,160
will probably tart up a little bit

372
00:20:14,380 --> 00:20:21,340
online for you including a Python script

373
00:20:18,160 --> 00:20:25,390
that I actually found that was and still

374
00:20:21,340 --> 00:20:26,709
partly is written in Italian right the

375
00:20:25,390 --> 00:20:28,270
brute-force button that's currently

376
00:20:26,710 --> 00:20:29,950
there does not brute force because

377
00:20:28,270 --> 00:20:31,660
originally I didn't bother reading the

378
00:20:29,950 --> 00:20:35,230
date sheet that said I yield the card

379
00:20:31,660 --> 00:20:37,690
out after three attempts and so I pushed

380
00:20:35,230 --> 00:20:39,669
the button after writing it in this

381
00:20:37,690 --> 00:20:39,820
function wondered why my card didn't

382
00:20:39,669 --> 00:20:46,000
work

383
00:20:39,820 --> 00:20:49,570
oh yes it now actually tries to do it

384
00:20:46,000 --> 00:20:54,299
three times and then stops and it's

385
00:20:49,570 --> 00:20:54,299
always with F F F F F F yep

386
00:21:01,830 --> 00:21:07,230
that depends on how you actually

387
00:21:03,730 --> 00:21:10,120
engineer you don't have to because the

388
00:21:07,230 --> 00:21:12,610
software supplies the pin to actually do

389
00:21:10,120 --> 00:21:14,918
the changing so in theory if you can

390
00:21:12,610 --> 00:21:18,668
identify the card reliably you could

391
00:21:14,919 --> 00:21:34,870
then have a different pin number for

392
00:21:18,669 --> 00:21:36,580
each card we've looked at a few but in

393
00:21:34,870 --> 00:21:38,909
terms of the actual systems they tend to

394
00:21:36,580 --> 00:21:40,559
actually have the same in the morning

395
00:21:38,910 --> 00:21:47,530
[Music]

396
00:21:40,559 --> 00:21:49,960
yeah yeah although yeah going back to

397
00:21:47,530 --> 00:21:52,000
the Kinkos attack what they actually did

398
00:21:49,960 --> 00:21:54,130
was they actually or a load of blank

399
00:21:52,000 --> 00:21:57,070
cards so literally these cards would

400
00:21:54,130 --> 00:21:58,690
have worked on it with the default pins

401
00:21:57,070 --> 00:22:01,629
and they would actually detect that they

402
00:21:58,690 --> 00:22:03,790
got the default pin and then reprogram

403
00:22:01,630 --> 00:22:05,740
them completely with the new pins

404
00:22:03,790 --> 00:22:07,389
because they go oh this is a blank card

405
00:22:05,740 --> 00:22:11,020
and I recognize it right it's going to

406
00:22:07,390 --> 00:22:14,370
be wiped and here's its new details so

407
00:22:11,020 --> 00:22:14,370
literally they just over wrote

408
00:22:15,270 --> 00:22:22,600
okay right so we do have some card

409
00:22:20,740 --> 00:22:25,360
readers people want to come out and have

410
00:22:22,600 --> 00:22:26,620
a play we've got about 20 of them they

411
00:22:25,360 --> 00:22:28,629
will be around by the lock-picking

412
00:22:26,620 --> 00:22:30,729
village for the rest of the day if you

413
00:22:28,630 --> 00:22:33,160
want to have a go see what you can do

414
00:22:30,730 --> 00:22:34,720
with the badge try and have a read and

415
00:22:33,160 --> 00:22:38,110
write of it will show you where all our

416
00:22:34,720 --> 00:22:50,290
repos are and we'll put the repository

417
00:22:38,110 --> 00:22:52,030
online okay yeah I realize we've only

418
00:22:50,290 --> 00:22:54,280
taken about 20 minutes and you got an

419
00:22:52,030 --> 00:22:56,230
hour so you know if you want to come and

420
00:22:54,280 --> 00:22:58,899
ask us any questions we've got all the

421
00:22:56,230 --> 00:22:59,980
stuff you can have a play I'll show you

422
00:22:58,900 --> 00:23:01,540
the man in the middle thing because I've

423
00:22:59,980 --> 00:23:03,850
just now broken it well there you go I

424
00:23:01,540 --> 00:23:11,500
don't off the paint we can fix it later

425
00:23:03,850 --> 00:23:19,178
right yes you can read the card with

426
00:23:11,500 --> 00:23:22,150
that pen yeah okay right so the question

427
00:23:19,179 --> 00:23:31,780
was can i clone the if I clone the card

428
00:23:22,150 --> 00:23:35,290
can I find the pin right no button right

429
00:23:31,780 --> 00:23:39,370
yeah slide three right so the slight

430
00:23:35,290 --> 00:23:43,918
thing is that it doesn't quite read

431
00:23:39,370 --> 00:23:47,110
everything on there yeah it won't read

432
00:23:43,919 --> 00:23:51,309
the pen that is the only bit that it

433
00:23:47,110 --> 00:23:54,090
will not read so other than that yes it

434
00:23:51,309 --> 00:23:54,090
would clone everything

435
00:23:57,350 --> 00:24:05,198
[Music]

436
00:24:06,260 --> 00:24:12,419
right so far is using a card with a

437
00:24:09,720 --> 00:24:15,299
different pin with exactly the same data

438
00:24:12,419 --> 00:24:17,370
no the it would depend on the system

439
00:24:15,299 --> 00:24:18,779
that was actually trying to manipulate

440
00:24:17,370 --> 00:24:21,000
the data and what it was actually doing

441
00:24:18,779 --> 00:24:22,590
with it because obviously it cannot then

442
00:24:21,000 --> 00:24:25,289
write the data which may or may not

443
00:24:22,590 --> 00:24:27,299
cause an error for me I do have one

444
00:24:25,289 --> 00:24:29,399
question about the Kinkos think that if

445
00:24:27,299 --> 00:24:33,480
I actually programmed it up and change

446
00:24:29,399 --> 00:24:35,639
the pin myself would the Kinkos system

447
00:24:33,480 --> 00:24:38,250
actually go oh right so you've got a

448
00:24:35,640 --> 00:24:43,289
dollar on your account you've done 10

449
00:24:38,250 --> 00:24:45,059
copies your yeah the value on the card

450
00:24:43,289 --> 00:24:47,940
is still well I'll try and decrement the

451
00:24:45,059 --> 00:24:49,049
amount but it's still actually one

452
00:24:47,940 --> 00:24:52,350
dollar because you can't change the

453
00:24:49,049 --> 00:24:53,908
value in the card that was actually

454
00:24:52,350 --> 00:24:55,649
quite an interesting system that Kinkos

455
00:24:53,909 --> 00:24:59,130
actually came up with because actually

456
00:24:55,649 --> 00:25:01,199
stored the amount that you'd paid on the

457
00:24:59,130 --> 00:25:03,179
card itself what all your transactions

458
00:25:01,200 --> 00:25:04,980
were in the back-end system so you could

459
00:25:03,179 --> 00:25:07,080
literally say oh I've got a card that's

460
00:25:04,980 --> 00:25:11,120
blank and it's got one dollar on it you

461
00:25:07,080 --> 00:25:14,879
can clone it and then as you go through

462
00:25:11,120 --> 00:25:15,510
the guy or a load of photocopies on

463
00:25:14,880 --> 00:25:18,750
there

464
00:25:15,510 --> 00:25:21,600
and put his cloned card in it instead

465
00:25:18,750 --> 00:25:25,799
yes you've done 20 photocopies and your

466
00:25:21,600 --> 00:25:28,199
balance is $1 so yeah it all depends on

467
00:25:25,799 --> 00:25:30,899
what you're storing on that card and

468
00:25:28,200 --> 00:25:33,059
this is why I probably install something

469
00:25:30,899 --> 00:25:36,059
encrypted which you're changing every

470
00:25:33,059 --> 00:25:42,418
single transaction and keep track of it

471
00:25:36,059 --> 00:25:44,899
in a back-end system any other questions

472
00:25:42,419 --> 00:25:44,899
for anybody

473
00:25:50,630 --> 00:25:55,910
[Music]

474
00:25:53,660 --> 00:26:04,490
so sometimes you have a magnetic stripe

475
00:25:55,910 --> 00:26:06,710
on the back yes right so the question

476
00:26:04,490 --> 00:26:08,450
was do you have extra protections if

477
00:26:06,710 --> 00:26:11,650
you've got a mag stripe on the back as

478
00:26:08,450 --> 00:26:14,450
well as the chip and pin mark the chip

479
00:26:11,650 --> 00:26:16,430
well with the mag you can read it

480
00:26:14,450 --> 00:26:19,730
because it's all in plain text so anyway

481
00:26:16,430 --> 00:26:21,140
but typically as you see with these

482
00:26:19,730 --> 00:26:24,140
readers you normally have a reader

483
00:26:21,140 --> 00:26:27,610
that's doing one job and not both so it

484
00:26:24,140 --> 00:26:30,680
might be for compatibility reasons yeah

485
00:26:27,610 --> 00:26:32,360
so I don't think I'm actually seen a

486
00:26:30,680 --> 00:26:35,900
system that actually does both for

487
00:26:32,360 --> 00:26:38,179
verification but again it would be in

488
00:26:35,900 --> 00:26:41,920
plain text so it'd be easy to manipulate

489
00:26:38,180 --> 00:26:41,920
one if you manipulate the other anyway

490
00:26:50,740 --> 00:26:54,320
technically you could have the hash

491
00:26:52,670 --> 00:26:55,670
valued on the mag stripe if you really

492
00:26:54,320 --> 00:26:57,439
wanted to but like I say you can

493
00:26:55,670 --> 00:27:01,580
manipulate the mag stripe just as easily

494
00:26:57,440 --> 00:27:03,830
if not actually I dare to say it but

495
00:27:01,580 --> 00:27:06,649
yeah the chip is actually the more

496
00:27:03,830 --> 00:27:09,139
secure part of that system anyway yeah

497
00:27:06,650 --> 00:27:11,240
and indeed the one that I passed around

498
00:27:09,140 --> 00:27:13,840
for my man in the middle one has

499
00:27:11,240 --> 00:27:25,730
actually got the mag stripe on the back

500
00:27:13,840 --> 00:27:29,330
yeah windows for windows head actually

501
00:27:25,730 --> 00:27:31,520
have the driver software on there so you

502
00:27:29,330 --> 00:27:33,350
should be able to find that on his

503
00:27:31,520 --> 00:27:36,139
website yep

504
00:27:33,350 --> 00:27:39,290
I think we've got smoke horizon where am

505
00:27:36,140 --> 00:27:45,950
I John I have like a wrong repo so if we

506
00:27:39,290 --> 00:27:49,970
actually put the links very death that's

507
00:27:45,950 --> 00:27:52,390
a be planar okay so that's the Java code

508
00:27:49,970 --> 00:27:52,390
mange

509
00:27:56,390 --> 00:28:15,020
a bunch of baby ladies there's the

510
00:28:08,809 --> 00:28:16,280
vaccine down now it's gonna try and fund

511
00:28:15,020 --> 00:28:19,129
the hit website

512
00:28:16,280 --> 00:28:21,970
I'm but literally if you google search

513
00:28:19,130 --> 00:28:27,950
for hit on Nikki

514
00:28:21,970 --> 00:28:28,400
3021 you'll find the software for that's

515
00:28:27,950 --> 00:28:31,280
it

516
00:28:28,400 --> 00:28:32,809
it's the hit global Omni key workbench

517
00:28:31,280 --> 00:28:35,540
will certainly allow you to get

518
00:28:32,809 --> 00:28:39,080
Diagnostics at them that one right there

519
00:28:35,540 --> 00:28:41,540
yeah so the data she and everything will

520
00:28:39,080 --> 00:28:43,399
be in the repository later on which

521
00:28:41,540 --> 00:28:47,000
gonna tapped up a little bit and then

522
00:28:43,400 --> 00:28:49,400
like people that like nor is look I'll

523
00:28:47,000 --> 00:28:51,110
just tweet it to a 5-4 con that's

524
00:28:49,400 --> 00:28:54,970
probably the easiest way isn't it yeah

525
00:28:51,110 --> 00:28:54,969
and we'll get it retweeted after you

526
00:28:55,179 --> 00:28:59,660
sorry

527
00:28:56,830 --> 00:29:00,740
yeah so we've been using a it's on

528
00:28:59,660 --> 00:29:07,220
github we're gonna tweet the link out

529
00:29:00,740 --> 00:29:11,090
later I'm like yeah that's the easiest

530
00:29:07,220 --> 00:29:15,440
way and people like no use to it right

531
00:29:11,090 --> 00:29:17,330
okay if you come back up picking village

532
00:29:15,440 --> 00:29:19,990
anyway yeah

533
00:29:17,330 --> 00:29:29,360
well well make sure you find out

534
00:29:19,990 --> 00:29:32,480
yesterday the payment cuts they're

535
00:29:29,360 --> 00:29:34,969
probably a bit more secure so nice of

536
00:29:32,480 --> 00:29:38,000
all you can read them or with that card

537
00:29:34,970 --> 00:29:42,380
reader it's not the same chip so that's

538
00:29:38,000 --> 00:29:43,880
not the sles 44:52 it's more it's got

539
00:29:42,380 --> 00:29:45,290
like challenge response type things and

540
00:29:43,880 --> 00:29:47,480
almost possible the more complicated

541
00:29:45,290 --> 00:29:49,250
stuff because it's a bank card obviously

542
00:29:47,480 --> 00:29:53,390
whereas these are just like so did you

543
00:29:49,250 --> 00:29:57,740
put in for copier are I think your

544
00:29:53,390 --> 00:29:59,360
journey of using for long term up you

545
00:29:57,740 --> 00:30:05,390
know so you like just a washing machine

546
00:29:59,360 --> 00:30:08,409
though I'm used to the kid web on eBay I

547
00:30:05,390 --> 00:30:11,020
bought five for about two pounds but

548
00:30:08,410 --> 00:30:17,360
[Music]

549
00:30:11,020 --> 00:30:18,889
yes they're probably about the same like

550
00:30:17,360 --> 00:30:22,820
you can buy late in bulk you'll get to

551
00:30:18,890 --> 00:30:24,890
achieve the same as RFID cards right but

552
00:30:22,820 --> 00:30:27,649
you can buy them so you can get them

553
00:30:24,890 --> 00:30:29,360
with a reader as well like I bought a

554
00:30:27,650 --> 00:30:30,230
reader doesn't work because these cards

555
00:30:29,360 --> 00:30:35,419
so don't buy that one

556
00:30:30,230 --> 00:30:38,720
and that was worth 14 foot so it reads

557
00:30:35,420 --> 00:31:05,000
open cards but when I put in these cards

558
00:30:38,720 --> 00:31:11,390
it just showed us it was unresponsive so

559
00:31:05,000 --> 00:31:27,350
what was he thinks you're 34 you 38

560
00:31:11,390 --> 00:31:30,740
uniform SIM cards I expect there'd be

561
00:31:27,350 --> 00:31:33,800
the same hmm I couldn't stay with a game

562
00:31:30,740 --> 00:31:35,330
one I thought it'd be difficult to solve

563
00:31:33,800 --> 00:31:44,419
get that in the card reader because you

564
00:31:35,330 --> 00:31:45,590
don't get the idea you know what are you

565
00:31:44,420 --> 00:31:48,610
gonna get a full-size SIM card from

566
00:31:45,590 --> 00:31:48,610
these days probably like that

567
00:31:52,240 --> 00:31:58,310
incidentally with the advent of flexible

568
00:31:56,390 --> 00:31:59,990
PCBs as well you could probably actually

569
00:31:58,310 --> 00:32:02,649
build a better man in the middle tool

570
00:31:59,990 --> 00:32:05,450
these days these mini places this year

571
00:32:02,650 --> 00:32:07,660
but it's on your video right some of the

572
00:32:05,450 --> 00:32:07,660
video

573
00:32:08,120 --> 00:32:11,209
[Music]

574
00:32:14,620 --> 00:32:24,239
okay that's right

