1
00:00:00,000 --> 00:00:02,029
Oh

2
00:00:02,230 --> 00:00:09,410
okay hello everyone how are you welcome

3
00:00:07,129 --> 00:00:11,570
to this talk where we're going to BA I

4
00:00:09,410 --> 00:00:13,940
talked about ASAP we're going to talk

5
00:00:11,570 --> 00:00:18,320
about spyware ransomware warms on how to

6
00:00:13,940 --> 00:00:20,330
prevent the next ASAP trashy first of

7
00:00:18,320 --> 00:00:22,460
all there is always the disclaimer that

8
00:00:20,330 --> 00:00:24,589
I always like to put basically is that I

9
00:00:22,460 --> 00:00:28,070
know you intend to override any of the

10
00:00:24,590 --> 00:00:29,960
privileges that ASAP might have to the

11
00:00:28,070 --> 00:00:32,200
different products no one reads it

12
00:00:29,960 --> 00:00:34,970
anyways but it's always a nice to have

13
00:00:32,200 --> 00:00:37,400
okay so Who am I my name is Jordan

14
00:00:34,970 --> 00:00:39,260
Center City I am the founder of mixer

15
00:00:37,400 --> 00:00:42,470
I'm going to tell you later on what Big

16
00:00:39,260 --> 00:00:45,080
Sur is my background probably is justice

17
00:00:42,470 --> 00:00:47,480
yours I started to be like a general

18
00:00:45,080 --> 00:00:52,400
penetration tester you name it like

19
00:00:47,480 --> 00:00:55,519
Apache called sweet etc and then I

20
00:00:52,400 --> 00:01:00,290
slowly specialized on the ERP word that

21
00:00:55,520 --> 00:01:01,940
was several years ago I am a speaker and

22
00:01:00,290 --> 00:01:03,710
training whatever I had the time a

23
00:01:01,940 --> 00:01:06,230
difference it could be confidences like

24
00:01:03,710 --> 00:01:08,930
Blackheart or was a hugger hearted you

25
00:01:06,230 --> 00:01:12,910
name it and thank you very much now the

26
00:01:08,930 --> 00:01:16,190
44 Khan and I had the privilege is to

27
00:01:12,910 --> 00:01:17,690
basically work with different so there

28
00:01:16,190 --> 00:01:19,759
are different organizations around the

29
00:01:17,690 --> 00:01:26,030
world you name in life from the military

30
00:01:19,760 --> 00:01:28,280
space on geez big organizations etc this

31
00:01:26,030 --> 00:01:30,740
is the brief agenda that I have for

32
00:01:28,280 --> 00:01:34,550
today we're going to start with a really

33
00:01:30,740 --> 00:01:37,070
really brief introduction to SMP I'm

34
00:01:34,550 --> 00:01:39,560
aware that not everyone might know our

35
00:01:37,070 --> 00:01:41,750
CP so this chapter will be important so

36
00:01:39,560 --> 00:01:43,370
we can stay all at the same level and

37
00:01:41,750 --> 00:01:47,030
all of you can understand the attacks

38
00:01:43,370 --> 00:01:48,920
and later on we have the project Arzo

39
00:01:47,030 --> 00:01:52,010
I'm going to tell you what it is and how

40
00:01:48,920 --> 00:01:53,630
it was born a traditional approach to

41
00:01:52,010 --> 00:01:56,740
malware distribution this is actually a

42
00:01:53,630 --> 00:02:00,380
real case that happened in s AP and

43
00:01:56,740 --> 00:02:02,780
chapter 4 I going to show you what I

44
00:02:00,380 --> 00:02:04,820
have been researching so far what is the

45
00:02:02,780 --> 00:02:07,490
status of the security of the ESF

46
00:02:04,820 --> 00:02:10,728
assistance in the current market and how

47
00:02:07,490 --> 00:02:12,890
someone can be used of that and from the

48
00:02:10,729 --> 00:02:14,880
other side what we need to do in order

49
00:02:12,890 --> 00:02:19,769
to prevent that before it's too late

50
00:02:14,880 --> 00:02:22,980
okay so without further introduction we

51
00:02:19,770 --> 00:02:25,590
start so the main question for you might

52
00:02:22,980 --> 00:02:27,929
be okay what is a CP you might be

53
00:02:25,590 --> 00:02:30,360
wondering okay so it's a V stands for an

54
00:02:27,930 --> 00:02:33,300
accounting of seasons applications and

55
00:02:30,360 --> 00:02:36,860
products in data processing basically

56
00:02:33,300 --> 00:02:39,720
it's a software that is the sign to

57
00:02:36,860 --> 00:02:44,100
satisfies all the different needs that

58
00:02:39,720 --> 00:02:47,700
accompany my hub logistics HR process of

59
00:02:44,100 --> 00:02:50,519
payments credit cards etc everything is

60
00:02:47,700 --> 00:02:53,880
centralized in a CP chances are that a

61
00:02:50,520 --> 00:02:55,920
part of the scarlet ASAP is like the

62
00:02:53,880 --> 00:02:57,799
most important software turn

63
00:02:55,920 --> 00:03:01,260
organization maja

64
00:02:57,800 --> 00:03:04,320
so let's go by the numbers ASAP was

65
00:03:01,260 --> 00:03:05,609
founded in 1972 by X IBM employees I

66
00:03:04,320 --> 00:03:07,829
don't know if you know the story but

67
00:03:05,610 --> 00:03:12,180
basically these guys were working on an

68
00:03:07,830 --> 00:03:14,100
ERP for IBM and I don't know why but the

69
00:03:12,180 --> 00:03:16,380
pressure gets canceled and this guy says

70
00:03:14,100 --> 00:03:18,090
okay wait a second we do have something

71
00:03:16,380 --> 00:03:20,579
really good here between our hands why

72
00:03:18,090 --> 00:03:23,010
don't we just split up create our own

73
00:03:20,580 --> 00:03:24,240
company and that let me tell you my

74
00:03:23,010 --> 00:03:26,549
friends that was one of the most

75
00:03:24,240 --> 00:03:28,770
successful business decision in the

76
00:03:26,550 --> 00:03:30,480
history of modern software this ties I

77
00:03:28,770 --> 00:03:33,120
think there are like the four biggest

78
00:03:30,480 --> 00:03:35,340
independent software seller of the war

79
00:03:33,120 --> 00:03:38,760
they are gigantic and look at those

80
00:03:35,340 --> 00:03:41,370
numbers I mean they have almost 90,000

81
00:03:38,760 --> 00:03:43,260
employees worldwide they have more than

82
00:03:41,370 --> 00:03:45,510
three hundred seventy eight thousand

83
00:03:43,260 --> 00:03:48,149
customers they are almost in every

84
00:03:45,510 --> 00:03:50,609
single customer sorry on every single

85
00:03:48,150 --> 00:03:52,530
country that is all there and I think

86
00:03:50,610 --> 00:03:54,810
the most important number is the one

87
00:03:52,530 --> 00:03:57,870
that you will see at the end look at

88
00:03:54,810 --> 00:04:01,020
this the force global 2000 that

89
00:03:57,870 --> 00:04:04,110
represents the most powerful and richest

90
00:04:01,020 --> 00:04:07,110
companies out there in the world an 87%

91
00:04:04,110 --> 00:04:09,840
of those companies are currently using s

92
00:04:07,110 --> 00:04:15,060
AP this guy's like completely dominate

93
00:04:09,840 --> 00:04:16,829
the market for this extremely brief

94
00:04:15,060 --> 00:04:20,160
introduction we're going to separate the

95
00:04:16,829 --> 00:04:21,659
s AP solutions into this is know what

96
00:04:20,160 --> 00:04:23,970
you will find on the documentation but

97
00:04:21,660 --> 00:04:25,680
we just have a very limited time in

98
00:04:23,970 --> 00:04:26,790
order to speak about the different

99
00:04:25,680 --> 00:04:29,340
solutions

100
00:04:26,790 --> 00:04:30,870
once I had the enterprise solutions and

101
00:04:29,340 --> 00:04:33,510
from the other side we had the

102
00:04:30,870 --> 00:04:35,880
supporting solutions the earth the price

103
00:04:33,510 --> 00:04:39,330
solutions are the most important ones on

104
00:04:35,880 --> 00:04:42,270
simple terms is worth the money is if

105
00:04:39,330 --> 00:04:44,909
the company only has one system that

106
00:04:42,270 --> 00:04:48,450
would be the sa sa P ERP that's the

107
00:04:44,910 --> 00:04:51,330
heart of the entire ASAP landscape and

108
00:04:48,450 --> 00:04:53,520
organization if the company's processing

109
00:04:51,330 --> 00:04:56,430
credit card is going to be on the ERP if

110
00:04:53,520 --> 00:05:00,479
they are processing payments is going to

111
00:04:56,430 --> 00:05:04,440
be on the ERP then you have the bi bi is

112
00:05:00,480 --> 00:05:08,520
more focus on how we sell more in a more

113
00:05:04,440 --> 00:05:10,770
efficient way toward customers CRM will

114
00:05:08,520 --> 00:05:13,109
centralize every single interaction of

115
00:05:10,770 --> 00:05:15,870
the customers with the company you can

116
00:05:13,110 --> 00:05:20,700
start getting a sense that very powerful

117
00:05:15,870 --> 00:05:22,470
information is store on si P from the

118
00:05:20,700 --> 00:05:24,570
other side which is have the supporting

119
00:05:22,470 --> 00:05:26,880
solutions it will not be the main focus

120
00:05:24,570 --> 00:05:28,800
of this talk basically the supporting

121
00:05:26,880 --> 00:05:31,830
solutions would support the enterprise

122
00:05:28,800 --> 00:05:33,420
solutions at the difference of the

123
00:05:31,830 --> 00:05:35,609
enterprise solutions were the people

124
00:05:33,420 --> 00:05:38,160
that actually log in most of them are

125
00:05:35,610 --> 00:05:40,140
just regular employees on the supporting

126
00:05:38,160 --> 00:05:42,860
solutions you will expect more technical

127
00:05:40,140 --> 00:05:46,169
users or more I mean straight or users

128
00:05:42,860 --> 00:05:48,360
all the systems on the enterprise

129
00:05:46,170 --> 00:05:51,300
solutions are something that is called

130
00:05:48,360 --> 00:05:53,580
netweaver base so what is dissonant we

131
00:05:51,300 --> 00:05:58,110
were that I mentioned basically it's the

132
00:05:53,580 --> 00:06:01,080
framework where si P sits in netweaver

133
00:05:58,110 --> 00:06:05,010
is service oriented and can be divided

134
00:06:01,080 --> 00:06:07,680
into a vApp and Java a bob was more

135
00:06:05,010 --> 00:06:11,909
designed to be like a back-end type of

136
00:06:07,680 --> 00:06:15,330
stock basically ava is the specific part

137
00:06:11,910 --> 00:06:17,790
of the net we were systems there calls

138
00:06:15,330 --> 00:06:21,180
money credit cards as I mentioned before

139
00:06:17,790 --> 00:06:24,180
and Java was more the song to be solar

140
00:06:21,180 --> 00:06:27,060
like a front-end system and is slowly

141
00:06:24,180 --> 00:06:29,730
being deprecated we do have systems that

142
00:06:27,060 --> 00:06:33,720
are pure ava and we do have systems that

143
00:06:29,730 --> 00:06:35,610
are pure Java and also we have systems

144
00:06:33,720 --> 00:06:37,950
that are what is called dual stack

145
00:06:35,610 --> 00:06:40,200
meaning that it will contain all the

146
00:06:37,950 --> 00:06:42,300
different services that a Vikas

147
00:06:40,200 --> 00:06:44,760
and he will contain all the different

148
00:06:42,300 --> 00:06:46,650
service that Java has for an attacker

149
00:06:44,760 --> 00:06:48,510
perspective that is awesome the brother

150
00:06:46,650 --> 00:06:54,690
is your platform the more chances you

151
00:06:48,510 --> 00:06:56,250
have to compromise the system now this

152
00:06:54,690 --> 00:06:58,710
would be like the welcome to the

153
00:06:56,250 --> 00:07:03,030
European this is not something that is

154
00:06:58,710 --> 00:07:05,030
exclusive of sa P each one of those

155
00:07:03,030 --> 00:07:09,799
services that I was mentioning before

156
00:07:05,030 --> 00:07:12,359
most of those services are private re

157
00:07:09,800 --> 00:07:15,090
meaning that the protocol is not open

158
00:07:12,360 --> 00:07:16,830
and most cases today's not technical

159
00:07:15,090 --> 00:07:19,890
documentation whatsoever how the

160
00:07:16,830 --> 00:07:21,719
protocol works the only way that you can

161
00:07:19,890 --> 00:07:24,020
do to actually figure it out how it

162
00:07:21,720 --> 00:07:26,970
works is through reverse engineering

163
00:07:24,020 --> 00:07:29,669
then there are even more crazy stuff for

164
00:07:26,970 --> 00:07:31,620
example some protocols don't even

165
00:07:29,670 --> 00:07:33,960
consider authentication the dedication

166
00:07:31,620 --> 00:07:36,620
layer itself is not even embedded in the

167
00:07:33,960 --> 00:07:40,979
protocol and this goes without saying

168
00:07:36,620 --> 00:07:45,270
most of them most of them are not

169
00:07:40,980 --> 00:07:47,430
encrypted by default so how people

170
00:07:45,270 --> 00:07:50,190
actually log into the ASAP systems well

171
00:07:47,430 --> 00:07:53,400
you have many ways the most common ones

172
00:07:50,190 --> 00:07:57,270
are this a big GUI which is a client a

173
00:07:53,400 --> 00:08:00,630
very extracting client the installer is

174
00:07:57,270 --> 00:08:02,310
more than 1.4 gigabytes for example and

175
00:08:00,630 --> 00:08:05,880
then you have through the web

176
00:08:02,310 --> 00:08:07,920
application servers Ava had the some web

177
00:08:05,880 --> 00:08:10,710
application server which is called ICM

178
00:08:07,920 --> 00:08:13,620
Java has its own web application server

179
00:08:10,710 --> 00:08:16,770
which is called Java HTTP and then you

180
00:08:13,620 --> 00:08:20,340
have another thing that is called Hana

181
00:08:16,770 --> 00:08:22,320
excess or Hana excess a that basically

182
00:08:20,340 --> 00:08:25,560
in terms of recycling of the technology

183
00:08:22,320 --> 00:08:27,750
is just ICM with asteroids of course

184
00:08:25,560 --> 00:08:29,340
every single one of those web

185
00:08:27,750 --> 00:08:32,010
application servers today in describing

186
00:08:29,340 --> 00:08:34,079
our private area again we don't have

187
00:08:32,010 --> 00:08:36,990
technical documentation of how they

188
00:08:34,080 --> 00:08:39,210
really works internally we have a few

189
00:08:36,990 --> 00:08:42,630
things but the documentation is very

190
00:08:39,210 --> 00:08:45,900
limited in consents so why if you

191
00:08:42,630 --> 00:08:49,200
haven't pay attention why someone would

192
00:08:45,900 --> 00:08:50,780
try to attack any say resistancy ID in

193
00:08:49,200 --> 00:08:54,340
the most cumbersome

194
00:08:50,780 --> 00:08:57,680
definition is is where the money is

195
00:08:54,340 --> 00:09:00,230
attackers know that ACP will have money

196
00:08:57,680 --> 00:09:02,030
attackers know that organizations highly

197
00:09:00,230 --> 00:09:04,430
depend on ASAP assistance so they will

198
00:09:02,030 --> 00:09:06,890
be very valuable information inside

199
00:09:04,430 --> 00:09:08,870
those systems or maybe just don't like

200
00:09:06,890 --> 00:09:11,230
you they are targeting you for something

201
00:09:08,870 --> 00:09:11,230
in particular

202
00:09:12,250 --> 00:09:20,600
so what is this pushing our sub on why

203
00:09:16,790 --> 00:09:22,400
I'm here the structure of this talk is a

204
00:09:20,600 --> 00:09:24,380
little bit different than why I'm still

205
00:09:22,400 --> 00:09:27,260
introducing myself if we already

206
00:09:24,380 --> 00:09:29,990
finished with chapter 2 well it will

207
00:09:27,260 --> 00:09:32,090
make sense in a few more seconds as I

208
00:09:29,990 --> 00:09:33,950
told before I work for an organization

209
00:09:32,090 --> 00:09:38,270
that is Victor that I helped found it

210
00:09:33,950 --> 00:09:41,990
where we basically focus on Oracle and

211
00:09:38,270 --> 00:09:44,390
adsap it's mainly earpiece like pen test

212
00:09:41,990 --> 00:09:46,280
whenever it assessments tons of

213
00:09:44,390 --> 00:09:48,170
forensics which I love to do but each

214
00:09:46,280 --> 00:09:51,740
time I do I lose two years of my life

215
00:09:48,170 --> 00:09:53,990
and trainings which I did here for the

216
00:09:51,740 --> 00:09:55,940
four phone why I am telling you these

217
00:09:53,990 --> 00:09:59,570
what we are a relatively young company

218
00:09:55,940 --> 00:10:01,070
and as many young companies so there we

219
00:09:59,570 --> 00:10:03,680
had the same challenge done everyone cut

220
00:10:01,070 --> 00:10:07,640
okay so how do we get new leads that

221
00:10:03,680 --> 00:10:09,260
will Tran for me customers most people

222
00:10:07,640 --> 00:10:11,650
will do the traditional approach what

223
00:10:09,260 --> 00:10:14,210
they do is they choose via a list of

224
00:10:11,650 --> 00:10:16,550
companies that are already using s IP

225
00:10:14,210 --> 00:10:20,840
for example and they start doing some

226
00:10:16,550 --> 00:10:23,569
cold calling this is or the success rate

227
00:10:20,840 --> 00:10:25,580
that they get is 1% and it's exactly the

228
00:10:23,570 --> 00:10:28,070
same the same success rate and spammers

229
00:10:25,580 --> 00:10:31,850
have which is not a coincidence if you

230
00:10:28,070 --> 00:10:35,780
ask me so we say yourself okay we are

231
00:10:31,850 --> 00:10:38,330
hackers I mean we are supposed to find a

232
00:10:35,780 --> 00:10:40,670
better way to solve this issue what we

233
00:10:38,330 --> 00:10:43,640
can do and that's how the project our

234
00:10:40,670 --> 00:10:46,040
sub was more basically what we do there

235
00:10:43,640 --> 00:10:48,439
is we took every single point of

236
00:10:46,040 --> 00:10:50,870
information every source every data

237
00:10:48,440 --> 00:10:54,500
source that we could get like shot on

238
00:10:50,870 --> 00:10:56,150
Google being my personal favor if you

239
00:10:54,500 --> 00:10:58,040
haven't check it out yet I would

240
00:10:56,150 --> 00:11:03,920
recommended assume I is like Chinese

241
00:10:58,040 --> 00:11:06,290
version of Shoreham and basically we I

242
00:11:03,920 --> 00:11:07,610
was forgetting something important also

243
00:11:06,290 --> 00:11:10,490
we took a few research

244
00:11:07,610 --> 00:11:12,740
from the Deep Web song of course search

245
00:11:10,490 --> 00:11:17,329
engine is some very very very very very

246
00:11:12,740 --> 00:11:20,180
sketchy forums we basically wanted to

247
00:11:17,329 --> 00:11:23,300
create a live map of SAV systems that

248
00:11:20,180 --> 00:11:25,579
were exposed to the Internet we had to

249
00:11:23,300 --> 00:11:27,500
create an extractor for each one of

250
00:11:25,579 --> 00:11:29,449
those data sources basically it's a

251
00:11:27,500 --> 00:11:31,250
Python script that periodically will

252
00:11:29,450 --> 00:11:33,320
connect to those data sources and pull

253
00:11:31,250 --> 00:11:36,140
out the information we will compare the

254
00:11:33,320 --> 00:11:38,870
new information with the assistance that

255
00:11:36,140 --> 00:11:41,569
we already have why we did this because

256
00:11:38,870 --> 00:11:45,140
we knew from the very beginning is that

257
00:11:41,570 --> 00:11:47,390
that map will be live you won't believe

258
00:11:45,140 --> 00:11:49,189
it but there are many organizations out

259
00:11:47,390 --> 00:11:51,620
there that a part of publishing

260
00:11:49,190 --> 00:11:55,519
production which is what you will expect

261
00:11:51,620 --> 00:11:58,660
that also publishing QA and web which

262
00:11:55,519 --> 00:12:01,730
makes absolutely no sense

263
00:11:58,660 --> 00:12:04,550
apart from that okay we say now we have

264
00:12:01,730 --> 00:12:07,670
a list but we need to make sense of this

265
00:12:04,550 --> 00:12:09,290
raw data were working with fortunately

266
00:12:07,670 --> 00:12:11,300
for us the web application services

267
00:12:09,290 --> 00:12:14,990
appear quite verbose look at those

268
00:12:11,300 --> 00:12:17,719
headers that we got in Sapien and we

269
00:12:14,990 --> 00:12:20,269
were application server 7:21 application

270
00:12:17,720 --> 00:12:23,029
server Java 731 is a pinwheel

271
00:12:20,269 --> 00:12:26,390
application server 722 application

272
00:12:23,029 --> 00:12:28,189
servers and thirdly there is no doubt

273
00:12:26,390 --> 00:12:31,459
that you're dealing with an NCP system

274
00:12:28,190 --> 00:12:34,310
and lucky for us also it provides us

275
00:12:31,459 --> 00:12:36,680
with a version so we know that the

276
00:12:34,310 --> 00:12:39,380
system started out there we know the

277
00:12:36,680 --> 00:12:43,250
version we know exactly where they're

278
00:12:39,380 --> 00:12:46,459
being hosts by country right continue

279
00:12:43,250 --> 00:12:48,709
and this is a clarification here even

280
00:12:46,459 --> 00:12:51,050
though we find that an SI p system is

281
00:12:48,709 --> 00:12:52,910
being caught in one country that doesn't

282
00:12:51,050 --> 00:12:54,890
necessarily mean that the owner of that

283
00:12:52,910 --> 00:12:58,850
the CPC's tena first is from that

284
00:12:54,890 --> 00:13:02,209
country for example AWS Singapore is

285
00:12:58,850 --> 00:13:05,720
hosting a massive amount of si B systems

286
00:13:02,209 --> 00:13:08,920
and they do it for the whole region now

287
00:13:05,720 --> 00:13:13,240
and we found several interesting things

288
00:13:08,920 --> 00:13:17,209
we found for example that very few in

289
00:13:13,240 --> 00:13:19,970
percentage very few of them were having

290
00:13:17,209 --> 00:13:20,839
a proper level of security a lot of cell

291
00:13:19,970 --> 00:13:23,990
science of

292
00:13:20,840 --> 00:13:27,500
creates a lot of certificates that they

293
00:13:23,990 --> 00:13:30,770
will expire many more things that I

294
00:13:27,500 --> 00:13:32,840
going to comment very soon so what we

295
00:13:30,770 --> 00:13:36,290
did we just compare the version that we

296
00:13:32,840 --> 00:13:39,140
have with the knowledge wares or

297
00:13:36,290 --> 00:13:41,390
internal knowledge database in terms of

298
00:13:39,140 --> 00:13:43,490
boon abilities that we have some of them

299
00:13:41,390 --> 00:13:46,010
were public published by all the

300
00:13:43,490 --> 00:13:51,400
researchers are there and some of them

301
00:13:46,010 --> 00:13:53,990
the private ones that we hold these are

302
00:13:51,400 --> 00:13:55,730
potential results what do I mean with

303
00:13:53,990 --> 00:13:58,100
potential results within actually

304
00:13:55,730 --> 00:14:00,440
trigger the attacks on the sa

305
00:13:58,100 --> 00:14:02,180
persistence we just compare the versions

306
00:14:00,440 --> 00:14:04,460
we know for sure that they're vulnerable

307
00:14:02,180 --> 00:14:07,010
but we don't want to break the law and

308
00:14:04,460 --> 00:14:09,020
go and try the payloads are you

309
00:14:07,010 --> 00:14:10,910
intrigued by the results well let me

310
00:14:09,020 --> 00:14:13,850
tell you before I show you the results

311
00:14:10,910 --> 00:14:16,790
that all these will be Suman eyes on a

312
00:14:13,850 --> 00:14:20,000
paper that we're going to release by the

313
00:14:16,790 --> 00:14:21,500
end of the year maybe before but more or

314
00:14:20,000 --> 00:14:24,380
less by the end of the year were

315
00:14:21,500 --> 00:14:27,110
containing the pure data of their of

316
00:14:24,380 --> 00:14:29,930
course and I'm going to give you the

317
00:14:27,110 --> 00:14:33,530
name of the companies that owned the SAV

318
00:14:29,930 --> 00:14:35,270
systems but at least you will get the

319
00:14:33,530 --> 00:14:37,760
big numbers and we're planning to it

320
00:14:35,270 --> 00:14:43,640
perishing so you will have something

321
00:14:37,760 --> 00:14:46,490
good in total we found more than 14,000

322
00:14:43,640 --> 00:14:48,290
xip systems directly exposed to the

323
00:14:46,490 --> 00:14:52,010
internet and let me make a clarification

324
00:14:48,290 --> 00:14:53,510
here maybe you think about it and you

325
00:14:52,010 --> 00:14:55,670
say okay what yeah

326
00:14:53,510 --> 00:14:59,330
14,000 but it's not that bad because I

327
00:14:55,670 --> 00:15:02,479
already have a wife or I already have a

328
00:14:59,330 --> 00:15:05,180
firewall for example or an IPS well if

329
00:15:02,480 --> 00:15:08,630
you have a firewall you have to let me

330
00:15:05,180 --> 00:15:10,969
pass through the port 80 or 443 and it's

331
00:15:08,630 --> 00:15:13,670
only what I need to compromise your

332
00:15:10,970 --> 00:15:16,490
recipe system if you have a wife or if

333
00:15:13,670 --> 00:15:18,949
you have an ideas on an IPS good luck

334
00:15:16,490 --> 00:15:22,370
for you because most of those stuff do

335
00:15:18,950 --> 00:15:24,380
not have a single signature to catch ACP

336
00:15:22,370 --> 00:15:26,990
attacks maybe you will catch if the

337
00:15:24,380 --> 00:15:29,330
attacker is invoking the CMD dot X a

338
00:15:26,990 --> 00:15:31,010
because if they will parse the entire

339
00:15:29,330 --> 00:15:33,200
string I will detect that that might be

340
00:15:31,010 --> 00:15:35,180
part of an attack maybe you will catch

341
00:15:33,200 --> 00:15:38,240
it if the attacker is trying to you

342
00:15:35,180 --> 00:15:46,010
but if someone is using pure sapa staff

343
00:15:38,240 --> 00:15:48,380
forget it this is funny uh for all those

344
00:15:46,010 --> 00:15:51,350
fourteen thousand systems that we were

345
00:15:48,380 --> 00:15:55,460
able to get we were able to identify who

346
00:15:51,350 --> 00:15:57,440
was the owner of almost 40% of them it's

347
00:15:55,460 --> 00:15:59,720
a piece like a Ferrari it's extremely

348
00:15:57,440 --> 00:16:01,850
expensive right - why the license to

349
00:15:59,720 --> 00:16:05,060
implement and hide thing there is no

350
00:16:01,850 --> 00:16:09,020
such thing as an orphan Ferrari so

351
00:16:05,060 --> 00:16:11,500
someone has to own that ASAP system by

352
00:16:09,020 --> 00:16:14,060
using techniques ruining the metadata

353
00:16:11,500 --> 00:16:16,850
reading the certificates and so on

354
00:16:14,060 --> 00:16:19,219
Moodle 25 the owners of the ESA PC

355
00:16:16,850 --> 00:16:23,030
stands and I think this is the most

356
00:16:19,220 --> 00:16:26,420
powerful number for all those 14,000 SAV

357
00:16:23,030 --> 00:16:28,610
systems we saw that 27% of those were

358
00:16:26,420 --> 00:16:30,110
exposed to critical vulnerabilities and

359
00:16:28,610 --> 00:16:31,820
when I say critical whatever it is I

360
00:16:30,110 --> 00:16:35,870
want to clarify remote code execution

361
00:16:31,820 --> 00:16:38,630
file upload file download pod reverse

362
00:16:35,870 --> 00:16:40,880
sauce you name it it was there of course

363
00:16:38,630 --> 00:16:43,640
again we didn't try the payload by by

364
00:16:40,880 --> 00:16:45,710
just knowing the versions you can you

365
00:16:43,640 --> 00:16:48,500
can figure it out so we were highly

366
00:16:45,710 --> 00:16:51,470
surprised actually I was not expecting

367
00:16:48,500 --> 00:16:52,880
the number to be higher that far or 7%

368
00:16:51,470 --> 00:16:55,130
more or less

369
00:16:52,880 --> 00:16:57,980
it was far more that we were expecting

370
00:16:55,130 --> 00:17:00,410
and we say okay wait a second is someone

371
00:16:57,980 --> 00:17:02,600
right now is the site to create

372
00:17:00,410 --> 00:17:05,510
something malicious like a warm and say

373
00:17:02,600 --> 00:17:07,520
that this could be a real tragedy how

374
00:17:05,510 --> 00:17:10,459
you will say what keep watching I will

375
00:17:07,520 --> 00:17:11,959
give you a few hints how to talk on how

376
00:17:10,459 --> 00:17:14,930
to offense of course we are the good

377
00:17:11,959 --> 00:17:18,350
guys we're trying to help people

378
00:17:14,930 --> 00:17:21,410
you got email this is like a real

379
00:17:18,349 --> 00:17:24,740
scenario that has happening before of

380
00:17:21,410 --> 00:17:27,709
course at this point when I show you the

381
00:17:24,740 --> 00:17:30,110
demo and I have several demos for you

382
00:17:27,709 --> 00:17:31,760
and I in crazy enough to do it live I

383
00:17:30,110 --> 00:17:33,560
got us a persistence writing on my

384
00:17:31,760 --> 00:17:38,150
machine so let's cross the finger for

385
00:17:33,560 --> 00:17:40,760
the demo gods are you I find myself

386
00:17:38,150 --> 00:17:42,230
having to downgrade with the need of

387
00:17:40,760 --> 00:17:44,000
time to downgrade a little bit this

388
00:17:42,230 --> 00:17:46,570
attack just because I don't want to give

389
00:17:44,000 --> 00:17:50,350
everything always of people doing

390
00:17:46,570 --> 00:17:53,408
our campaign on ASAP but if you have

391
00:17:50,350 --> 00:17:57,100
more questions or if you have a hint of

392
00:17:53,409 --> 00:17:59,049
a if I do X Y Z I will be able to power

393
00:17:57,100 --> 00:18:02,529
up this attack later on I would say yes

394
00:17:59,049 --> 00:18:05,139
or no okay so think about it we need to

395
00:18:02,529 --> 00:18:07,419
start thinking like an attacker an

396
00:18:05,139 --> 00:18:09,459
attacker already has a collection of a

397
00:18:07,419 --> 00:18:11,710
CB system they already know what

398
00:18:09,460 --> 00:18:15,309
companies are using those s AV systems

399
00:18:11,710 --> 00:18:17,860
and it's fairly trivial to do a small

400
00:18:15,309 --> 00:18:19,779
investigation to get emails for example

401
00:18:17,860 --> 00:18:22,299
of the people that work on those

402
00:18:19,779 --> 00:18:24,070
companies the attacker knows that

403
00:18:22,299 --> 00:18:27,129
probably if there is in SAT there is in

404
00:18:24,070 --> 00:18:29,289
s AP across the war I mean it's the

405
00:18:27,129 --> 00:18:31,658
whole definition of an ERP system is a

406
00:18:29,289 --> 00:18:34,049
solution that should provide help to the

407
00:18:31,659 --> 00:18:36,759
different parts of an organization and

408
00:18:34,049 --> 00:18:40,269
the attacker also knows that if a

409
00:18:36,759 --> 00:18:42,789
company can have an ACP most likely to

410
00:18:40,269 --> 00:18:45,700
have high resources high resources means

411
00:18:42,789 --> 00:18:48,340
that America many employees if they have

412
00:18:45,700 --> 00:18:51,370
many employees they might infer that

413
00:18:48,340 --> 00:18:55,799
single sign-on is being configured

414
00:18:51,370 --> 00:18:59,258
inside esse system which is the case of

415
00:18:55,799 --> 00:19:01,929
97% of the organizations that I'm

416
00:18:59,259 --> 00:19:04,000
currently using sa B so what's happening

417
00:19:01,929 --> 00:19:06,610
here well how we found this distribution

418
00:19:04,000 --> 00:19:08,740
of mal work well basically the model was

419
00:19:06,610 --> 00:19:11,830
in form of something that is called sub

420
00:19:08,740 --> 00:19:14,740
GUI scripts it's basically a programming

421
00:19:11,830 --> 00:19:18,189
or scripting language that you can use

422
00:19:14,740 --> 00:19:21,129
for tsap client basically you will use

423
00:19:18,190 --> 00:19:23,830
this to perform butt jobs operations

424
00:19:21,129 --> 00:19:25,990
under the privileges of the ASAP user

425
00:19:23,830 --> 00:19:30,220
that is actually executing those batch

426
00:19:25,990 --> 00:19:33,309
files here's the good part by the fall

427
00:19:30,220 --> 00:19:34,360
this functionality comes disabled which

428
00:19:33,309 --> 00:19:36,789
is awesome

429
00:19:34,360 --> 00:19:39,418
but there is a problem with that this is

430
00:19:36,789 --> 00:19:42,879
the main way that companies have to

431
00:19:39,419 --> 00:19:45,490
actually do automatic testing NSIP

432
00:19:42,879 --> 00:19:48,789
because it recreates the behavior of a

433
00:19:45,490 --> 00:19:51,970
human being and because of that 90% of

434
00:19:48,789 --> 00:19:54,929
the corporate users actually have this

435
00:19:51,970 --> 00:19:54,929
activated

436
00:19:57,440 --> 00:20:02,690
going to show you the demo but first I

437
00:19:59,750 --> 00:20:04,580
wanted to show you the a scenario this

438
00:20:02,690 --> 00:20:07,850
will be the attacker that basically is

439
00:20:04,580 --> 00:20:10,668
going to distribute a typical sub GUI

440
00:20:07,850 --> 00:20:12,799
script to the users that the users will

441
00:20:10,669 --> 00:20:15,289
be in the villain and then the

442
00:20:12,799 --> 00:20:17,299
operations will be carried out to this

443
00:20:15,289 --> 00:20:19,129
server spielen the users for sure we

444
00:20:17,299 --> 00:20:20,539
have a firewall exclusion two goes to

445
00:20:19,129 --> 00:20:23,178
the server's villain because it's how

446
00:20:20,539 --> 00:20:24,919
they need to connect to si P in order to

447
00:20:23,179 --> 00:20:27,440
work the daily operations

448
00:20:24,919 --> 00:20:29,169
and I'm being quite generous here with

449
00:20:27,440 --> 00:20:31,490
this network diagram most companies

450
00:20:29,169 --> 00:20:34,159
nowadays they don't even have a

451
00:20:31,490 --> 00:20:36,919
segregation between the users and the

452
00:20:34,159 --> 00:20:39,769
server side everyone tends to work with

453
00:20:36,919 --> 00:20:45,259
a flat network so let me show you a

454
00:20:39,769 --> 00:20:48,980
little bit here I have one of the ESF

455
00:20:45,259 --> 00:20:52,279
assistants for you just going to give

456
00:20:48,980 --> 00:20:54,529
you a brief overview what this malicious

457
00:20:52,279 --> 00:20:57,620
screen that I have created for you today

458
00:20:54,529 --> 00:21:01,570
is going to do is literally delete a

459
00:20:57,620 --> 00:21:03,739
table that will contain public debt

460
00:21:01,570 --> 00:21:05,539
basically you can do whatever you want

461
00:21:03,740 --> 00:21:10,700
this is just for the sake of the

462
00:21:05,539 --> 00:21:13,879
exercise this is how you see a table in

463
00:21:10,700 --> 00:21:16,340
a say P basically what the attacker

464
00:21:13,879 --> 00:21:17,840
wants to do for example is to clear out

465
00:21:16,340 --> 00:21:20,509
the amount of data that each one of

466
00:21:17,840 --> 00:21:24,620
these persons have kudos for you if you

467
00:21:20,509 --> 00:21:26,690
can recognize some of the names okay so

468
00:21:24,620 --> 00:21:29,090
what is going to happen here basically

469
00:21:26,690 --> 00:21:31,850
the person is going to be working inside

470
00:21:29,090 --> 00:21:35,178
the ESF assistant is going to receive an

471
00:21:31,850 --> 00:21:38,990
email here and I make it on purpose yet

472
00:21:35,179 --> 00:21:42,309
again I created the subway script with

473
00:21:38,990 --> 00:21:47,929
the VBS extension there are many tricks

474
00:21:42,309 --> 00:21:50,690
to bypass this and to make the sub GUI

475
00:21:47,929 --> 00:21:53,419
scrip or the malware I almost in

476
00:21:50,690 --> 00:21:54,860
detectable but yet again I don't want to

477
00:21:53,419 --> 00:21:56,659
be responsible for something but

478
00:21:54,860 --> 00:21:57,889
basically the person will do a

479
00:21:56,659 --> 00:22:00,169
double-click on that file and

480
00:21:57,889 --> 00:22:03,019
automatically all the actions will be

481
00:22:00,169 --> 00:22:05,419
carried out inside the sfe system under

482
00:22:03,019 --> 00:22:07,490
the privileges of that person even if

483
00:22:05,419 --> 00:22:09,230
you go to the logs you will see that the

484
00:22:07,490 --> 00:22:10,710
actions will be performed on the

485
00:22:09,230 --> 00:22:12,539
victim's name

486
00:22:10,710 --> 00:22:15,720
and that's about it if you're not paying

487
00:22:12,539 --> 00:22:17,879
attention as you could see the the

488
00:22:15,720 --> 00:22:20,100
execution was actually quite fast

489
00:22:17,880 --> 00:22:22,740
remember this is something automatic

490
00:22:20,100 --> 00:22:27,230
that people use to do the automatic

491
00:22:22,740 --> 00:22:30,890
testing and now if we go to the table

492
00:22:27,230 --> 00:22:33,600
you will see that the values are

493
00:22:30,890 --> 00:22:34,830
modified again this is one of the

494
00:22:33,600 --> 00:22:36,809
examples basically you will do

495
00:22:34,830 --> 00:22:38,549
everything here as long as the user has

496
00:22:36,809 --> 00:22:41,668
enough privileges shut down the SAV

497
00:22:38,549 --> 00:22:43,620
system get the credit cards and forward

498
00:22:41,669 --> 00:22:47,159
the credit cards to a net cut that is

499
00:22:43,620 --> 00:22:49,678
listening or to an HTTP server that is

500
00:22:47,159 --> 00:22:54,140
waiting for the credit cards and so on

501
00:22:49,679 --> 00:22:54,140
the possibilities here are limitless

502
00:22:59,480 --> 00:23:06,480
unfortunately unfortunately most people

503
00:23:03,360 --> 00:23:10,219
cannot disable this functionality they

504
00:23:06,480 --> 00:23:13,140
all needed to do this kind of testing

505
00:23:10,220 --> 00:23:15,630
but if you cannot there is one thing

506
00:23:13,140 --> 00:23:18,929
that you can do basically on uncp

507
00:23:15,630 --> 00:23:21,539
systems you can say okay I love the

508
00:23:18,929 --> 00:23:24,210
scripting for all the users but only

509
00:23:21,539 --> 00:23:26,549
allowed execution to be for the users

510
00:23:24,210 --> 00:23:28,320
that have a particular decision optional

511
00:23:26,549 --> 00:23:32,129
particular privileges called s

512
00:23:28,320 --> 00:23:34,950
underscore s CR on value 16 you will be

513
00:23:32,130 --> 00:23:37,440
raising the bar a lot because I really

514
00:23:34,950 --> 00:23:40,320
only want a very handful of users to be

515
00:23:37,440 --> 00:23:42,659
able to be used for automatic testing

516
00:23:40,320 --> 00:23:46,639
the other ones have no reason to be here

517
00:23:42,659 --> 00:23:50,460
and then you can also configure the

518
00:23:46,640 --> 00:23:52,260
client to notify you whenever a subbu is

519
00:23:50,460 --> 00:23:54,559
scripting is about to be executed so you

520
00:23:52,260 --> 00:23:57,870
can say yes unknown unfortunately again

521
00:23:54,559 --> 00:24:05,190
these are on the market right now people

522
00:23:57,870 --> 00:24:06,539
tend to disable this a lot ok so now

523
00:24:05,190 --> 00:24:08,490
we're going to talk about the

524
00:24:06,539 --> 00:24:11,580
urbanisation and deprivation we're going

525
00:24:08,490 --> 00:24:13,380
to go more to what we have found that we

526
00:24:11,580 --> 00:24:16,110
could do on the systems that we're

527
00:24:13,380 --> 00:24:18,210
exposed to the Internet the first thing

528
00:24:16,110 --> 00:24:20,668
that would is talk about it is like okay

529
00:24:18,210 --> 00:24:23,040
know if someone creates a warm that will

530
00:24:20,669 --> 00:24:26,640
be really really bad movie

531
00:24:23,040 --> 00:24:28,920
hi I'm really real danger out there we

532
00:24:26,640 --> 00:24:31,140
wanted to help but before we could help

533
00:24:28,920 --> 00:24:33,600
we need to understand how someone will

534
00:24:31,140 --> 00:24:36,690
create the malware to attack the SME

535
00:24:33,600 --> 00:24:39,240
system well with is to start studying

536
00:24:36,690 --> 00:24:41,760
previous month Wars previous transforms

537
00:24:39,240 --> 00:24:44,130
and warms and we scored that some of

538
00:24:41,760 --> 00:24:46,940
them share some personality traits for

539
00:24:44,130 --> 00:24:49,530
example they were the song to hit hard

540
00:24:46,940 --> 00:24:52,320
lateral movement was cool because you

541
00:24:49,530 --> 00:24:52,970
want to compromise as many horse as you

542
00:24:52,320 --> 00:24:55,379
can

543
00:24:52,970 --> 00:24:57,930
avoiding making noise was not a priority

544
00:24:55,380 --> 00:24:59,730
you're hitting hard you're moving fast

545
00:24:57,930 --> 00:25:03,450
not necessarily you wanna keep it quiet

546
00:24:59,730 --> 00:25:06,090
and they're open to weaponize what does

547
00:25:03,450 --> 00:25:07,830
it mean it means that the attackers

548
00:25:06,090 --> 00:25:10,590
don't really want to trigger this they

549
00:25:07,830 --> 00:25:12,780
already have a framework for 10 brands

550
00:25:10,590 --> 00:25:14,580
some water for 10 one the only thing

551
00:25:12,780 --> 00:25:17,670
that they need is the Silver Bullet that

552
00:25:14,580 --> 00:25:20,100
are going to use to penetrate in the

553
00:25:17,670 --> 00:25:21,930
systems and do the lateral movement but

554
00:25:20,100 --> 00:25:23,429
the framework itself is already there

555
00:25:21,930 --> 00:25:27,060
they're just waiting for the right

556
00:25:23,430 --> 00:25:30,840
opportunity this will be the a scenario

557
00:25:27,060 --> 00:25:33,720
that we have and this scenario is very

558
00:25:30,840 --> 00:25:36,449
similar that you will find on the system

559
00:25:33,720 --> 00:25:38,730
so that exposed the internet the

560
00:25:36,450 --> 00:25:40,500
attackers or the people that want to

561
00:25:38,730 --> 00:25:42,630
interact with the SMP system are going

562
00:25:40,500 --> 00:25:45,870
to connect with the ASAP system on this

563
00:25:42,630 --> 00:25:47,910
case and Java one that isn't a DMC most

564
00:25:45,870 --> 00:25:51,300
likely that Java system will be

565
00:25:47,910 --> 00:25:53,820
connecting to a system of a consistent a

566
00:25:51,300 --> 00:25:56,639
BA on the DMC and being very generous

567
00:25:53,820 --> 00:25:59,240
here once again in general people have

568
00:25:56,640 --> 00:26:02,280
everything on the internal network and

569
00:25:59,240 --> 00:26:04,110
finally and this is because how ICP

570
00:26:02,280 --> 00:26:06,450
works is a big has been born to be

571
00:26:04,110 --> 00:26:09,389
highly interconnected that back-end

572
00:26:06,450 --> 00:26:11,130
system will indeed need to speak with

573
00:26:09,390 --> 00:26:12,600
the systems on the internal network what

574
00:26:11,130 --> 00:26:16,500
does it mean it means that that

575
00:26:12,600 --> 00:26:22,050
particular box will have access through

576
00:26:16,500 --> 00:26:23,370
the firewall the attackers know this so

577
00:26:22,050 --> 00:26:25,080
what we're going to do here we're going

578
00:26:23,370 --> 00:26:27,510
to divide the attack on five different

579
00:26:25,080 --> 00:26:29,429
phases the first one will be the

580
00:26:27,510 --> 00:26:32,879
intrusion one why because you need

581
00:26:29,430 --> 00:26:35,549
something to compromise the first java

582
00:26:32,880 --> 00:26:37,919
system that is on the DMC

583
00:26:35,549 --> 00:26:39,629
you compromise that SAV system you need

584
00:26:37,919 --> 00:26:42,869
to start getting credentials you wanna

585
00:26:39,629 --> 00:26:44,759
do lateral movement once you get the

586
00:26:42,869 --> 00:26:47,610
lateral movement that could be with many

587
00:26:44,759 --> 00:26:50,309
things like utilizing the password

588
00:26:47,610 --> 00:26:53,758
password guessing's brute force etc

589
00:26:50,309 --> 00:26:56,009
we're going to do something else once

590
00:26:53,759 --> 00:26:58,980
you do that then you scape the dmz

591
00:26:56,009 --> 00:27:00,960
because you wanna hit the lan for that

592
00:26:58,980 --> 00:27:03,929
at least for this demo I'm going to show

593
00:27:00,960 --> 00:27:05,879
you how an attackers can take advantage

594
00:27:03,929 --> 00:27:08,429
of something as a beta is called master

595
00:27:05,879 --> 00:27:09,959
password and how they can use the

596
00:27:08,429 --> 00:27:11,609
different interfaces that they say be

597
00:27:09,960 --> 00:27:15,080
provide to actually attacking those

598
00:27:11,609 --> 00:27:19,980
systems that are on the user's network

599
00:27:15,080 --> 00:27:22,769
and finally coming back to this model we

600
00:27:19,980 --> 00:27:25,200
are not just in good enough with

601
00:27:22,769 --> 00:27:27,720
attacking the SIV servers that you see

602
00:27:25,200 --> 00:27:30,090
on the internal network we also want to

603
00:27:27,720 --> 00:27:33,480
attract the people that are connecting

604
00:27:30,090 --> 00:27:37,949
to those servers we're going to see how

605
00:27:33,480 --> 00:27:39,600
we're going to do this each stage I'm

606
00:27:37,950 --> 00:27:41,789
going to show you like a demo I'm going

607
00:27:39,600 --> 00:27:44,820
to show you some of the codes of course

608
00:27:41,789 --> 00:27:46,799
of course the main mawar or the main

609
00:27:44,820 --> 00:27:49,289
simulation of the malware is not going

610
00:27:46,799 --> 00:27:51,899
to be distributed for obvious reasons in

611
00:27:49,289 --> 00:27:54,330
my end goal here is to help people to

612
00:27:51,899 --> 00:27:57,479
prevent this not to help people to cause

613
00:27:54,330 --> 00:28:00,090
this but yes I will show you some code

614
00:27:57,480 --> 00:28:02,399
and if you need later on you wanna see

615
00:28:00,090 --> 00:28:05,158
it in detail you can ask me and I will

616
00:28:02,399 --> 00:28:06,988
be more than happy to show you okay as I

617
00:28:05,159 --> 00:28:08,730
told you before the the framework of

618
00:28:06,989 --> 00:28:10,499
compromise is already there what we need

619
00:28:08,730 --> 00:28:13,379
is the Silver Bullet to actually get

620
00:28:10,499 --> 00:28:17,159
inside the front-running system that is

621
00:28:13,379 --> 00:28:20,340
on the SMP system unfortunately right

622
00:28:17,159 --> 00:28:22,950
now you have like three remote common

623
00:28:20,340 --> 00:28:27,779
executions that are pre out that are

624
00:28:22,950 --> 00:28:31,379
somewhat known to the public researchers

625
00:28:27,779 --> 00:28:33,989
on purpose I'm going to select the

626
00:28:31,379 --> 00:28:36,629
oldest one again because I don't wanna i

627
00:28:33,989 --> 00:28:38,159
someone to create a warm but now that

628
00:28:36,629 --> 00:28:40,879
there are three different alternatives

629
00:28:38,159 --> 00:28:43,830
to what you are going to see these and

630
00:28:40,879 --> 00:28:45,570
unfortunately even if we take the oldest

631
00:28:43,830 --> 00:28:46,309
exploit that I'm going to show you a

632
00:28:45,570 --> 00:28:48,499
core

633
00:28:46,309 --> 00:28:50,960
all investigations on this project are

634
00:28:48,499 --> 00:28:52,429
sub three out of ten SMP systems that

635
00:28:50,960 --> 00:28:57,369
are exposed to the internet right now

636
00:28:52,429 --> 00:29:00,349
are still vulnerable so let me show you

637
00:28:57,369 --> 00:29:04,509
this is one of the SMP systems that I

638
00:29:00,349 --> 00:29:07,399
brought for you today is a Java one and

639
00:29:04,509 --> 00:29:13,669
let me show you how complex the

640
00:29:07,399 --> 00:29:16,039
exploitation is basically there is one

641
00:29:13,669 --> 00:29:18,469
particular URL that you see right there

642
00:29:16,039 --> 00:29:22,070
and I'm going to show you whether on the

643
00:29:18,469 --> 00:29:24,349
code that will gladly take operating

644
00:29:22,070 --> 00:29:26,629
system commands directly from you for

645
00:29:24,349 --> 00:29:28,939
example here you see that those commands

646
00:29:26,629 --> 00:29:30,678
are being executed under the context of

647
00:29:28,940 --> 00:29:33,979
the user that is running the SMB system

648
00:29:30,679 --> 00:29:36,469
here you got shut it off corrupt the

649
00:29:33,979 --> 00:29:38,450
kernel jump to the database because the

650
00:29:36,469 --> 00:29:41,690
ESP system always maintained a trust

651
00:29:38,450 --> 00:29:43,009
relationship with the mat database so

652
00:29:41,690 --> 00:29:45,889
you will be able to execute queries

653
00:29:43,009 --> 00:29:49,729
without even providing a username and

654
00:29:45,889 --> 00:29:52,218
password for the database let me show

655
00:29:49,729 --> 00:29:54,919
you right here this is the code that I

656
00:29:52,219 --> 00:29:57,019
have prepared for you a little bit

657
00:29:54,919 --> 00:29:59,629
unnecessary at least for this part

658
00:29:57,019 --> 00:30:02,659
because I saw you before is literally

659
00:29:59,629 --> 00:30:04,309
just a URL but I just wanted to show you

660
00:30:02,659 --> 00:30:07,249
that you can execute pretty much

661
00:30:04,309 --> 00:30:11,418
whatever you want as long as a valid

662
00:30:07,249 --> 00:30:15,409
comment okay so the first part for the

663
00:30:11,419 --> 00:30:18,679
attacker is quite simple this exploit

664
00:30:15,409 --> 00:30:21,879
just give you the ability to completely

665
00:30:18,679 --> 00:30:25,969
pound the system that is in front of you

666
00:30:21,879 --> 00:30:28,519
here this is scenario is already really

667
00:30:25,969 --> 00:30:31,429
dangerous the worst thing that happened

668
00:30:28,519 --> 00:30:33,859
to us is someone to set food on or DM C

669
00:30:31,429 --> 00:30:36,259
once they gain terrains just a matter of

670
00:30:33,859 --> 00:30:38,509
time for an attacker to start spraying

671
00:30:36,259 --> 00:30:41,210
and trying to jump to the internal users

672
00:30:38,509 --> 00:30:42,859
Network first of all why this

673
00:30:41,210 --> 00:30:44,869
application exists you might be

674
00:30:42,859 --> 00:30:47,539
wondering why exists without

675
00:30:44,869 --> 00:30:49,759
authentication well this is something

676
00:30:47,539 --> 00:30:51,589
that is called the invoker servlet that

677
00:30:49,759 --> 00:30:53,899
invokes something that is called config

678
00:30:51,589 --> 00:30:58,279
servlet that basically is an application

679
00:30:53,899 --> 00:30:59,810
that ACP uses to install itself I show

680
00:30:58,279 --> 00:31:01,850
you X

681
00:30:59,810 --> 00:31:03,950
you son of a betting system commands but

682
00:31:01,850 --> 00:31:06,770
that handy application also allow us to

683
00:31:03,950 --> 00:31:09,530
create users and assign whatever

684
00:31:06,770 --> 00:31:11,180
privileges we want of those users for

685
00:31:09,530 --> 00:31:15,460
example you can create yourself an

686
00:31:11,180 --> 00:31:18,620
administrator which is to post requests

687
00:31:15,460 --> 00:31:20,780
so what do we do with this guy well you

688
00:31:18,620 --> 00:31:22,939
have to apply three different ICP notes

689
00:31:20,780 --> 00:31:25,340
and notes it's like a patch that you

690
00:31:22,940 --> 00:31:27,070
have on the IP Ward in order to actually

691
00:31:25,340 --> 00:31:29,750
mitigate this wound ability

692
00:31:27,070 --> 00:31:31,850
unfortunately many more abilities in a

693
00:31:29,750 --> 00:31:34,160
bar bar just before misconfigurations

694
00:31:31,850 --> 00:31:36,889
but in Java the only thing that you can

695
00:31:34,160 --> 00:31:39,350
may be ahead of the curve is if you

696
00:31:36,890 --> 00:31:42,730
patch patch patch there is no other way

697
00:31:39,350 --> 00:31:45,290
just an FYI in case you need to apply

698
00:31:42,730 --> 00:31:48,490
the three notes if you're missing the

699
00:31:45,290 --> 00:31:53,000
three notes please read the note 1467

700
00:31:48,490 --> 00:31:55,430
771 because there is a bug in one of the

701
00:31:53,000 --> 00:31:58,220
fixes that you have for the SA

702
00:31:55,430 --> 00:32:01,760
persistence and if you don't apply that

703
00:31:58,220 --> 00:32:04,040
not you might lock out your real users

704
00:32:01,760 --> 00:32:06,400
from the ASAP system so there is a patch

705
00:32:04,040 --> 00:32:09,200
for the patch just an FYI and

706
00:32:06,400 --> 00:32:11,660
unfortunately like many things in s IPS

707
00:32:09,200 --> 00:32:15,140
the course have been evolving from the

708
00:32:11,660 --> 00:32:16,640
80s they are very monolithic for many of

709
00:32:15,140 --> 00:32:19,430
the operations that you will have to do

710
00:32:16,640 --> 00:32:21,710
you have to restore the SAV system for

711
00:32:19,430 --> 00:32:23,510
the changes to take effect you will be

712
00:32:21,710 --> 00:32:26,030
able to really do it on there you may be

713
00:32:23,510 --> 00:32:27,770
able to easily do it on QA but in

714
00:32:26,030 --> 00:32:29,810
production for most of the companies

715
00:32:27,770 --> 00:32:32,000
that is a challenge they usually have a

716
00:32:29,810 --> 00:32:37,820
window of opportunity where they can

717
00:32:32,000 --> 00:32:39,740
actually do the restart so ok yeah we

718
00:32:37,820 --> 00:32:42,050
were able to compromise the first system

719
00:32:39,740 --> 00:32:44,810
if you remember the diagram now we need

720
00:32:42,050 --> 00:32:48,110
credentials why because we want to start

721
00:32:44,810 --> 00:32:49,879
doing some lateral movement for lateral

722
00:32:48,110 --> 00:32:53,120
movement I mean I wanted to keep

723
00:32:49,880 --> 00:32:55,100
everything like on the SAV sphere what

724
00:32:53,120 --> 00:32:57,679
you can do is to choose drawing mini

725
00:32:55,100 --> 00:33:00,439
cuts or just try to put Metasploit there

726
00:32:57,680 --> 00:33:02,480
or put a nation of metas flow and tah

727
00:33:00,440 --> 00:33:04,130
and start targeting the res on the other

728
00:33:02,480 --> 00:33:07,250
ways but for the sake of this talk we

729
00:33:04,130 --> 00:33:09,320
want to keep it s AP there is something

730
00:33:07,250 --> 00:33:11,690
on the java systems that i really show

731
00:33:09,320 --> 00:33:12,999
you before that is called the ASAP java

732
00:33:11,690 --> 00:33:15,489
secure storage

733
00:33:12,999 --> 00:33:17,379
each stack has its own storage while we

734
00:33:15,489 --> 00:33:19,839
are on a Java system so we're going to

735
00:33:17,379 --> 00:33:22,238
talk about this guy basically it's our

736
00:33:19,839 --> 00:33:25,708
encrypted file that sees on the file

737
00:33:22,239 --> 00:33:28,689
system that is encrypted with Triple DES

738
00:33:25,709 --> 00:33:31,179
in order to decrypt that you will have

739
00:33:28,689 --> 00:33:35,519
to have a passphrase that the user

740
00:33:31,179 --> 00:33:38,919
specifies at installation time and a key

741
00:33:35,519 --> 00:33:42,729
unfortunately that key is hard-coded on

742
00:33:38,919 --> 00:33:46,059
the binaries so if you know the key and

743
00:33:42,729 --> 00:33:48,489
if you are able to get the files you are

744
00:33:46,059 --> 00:33:51,459
able to open the secure storage and

745
00:33:48,489 --> 00:33:53,409
guess what's inside first is the

746
00:33:51,459 --> 00:33:58,239
password of the SMP administrator and

747
00:33:53,409 --> 00:33:59,739
second is the entire JDBC chain for DSP

748
00:33:58,239 --> 00:34:02,769
to be able to connect to the database

749
00:33:59,739 --> 00:34:05,259
for those of you that you are not very

750
00:34:02,769 --> 00:34:07,899
familiar with Java programming if you

751
00:34:05,259 --> 00:34:09,879
had the full JDBC change it means that

752
00:34:07,899 --> 00:34:11,739
you also had the password for the user

753
00:34:09,879 --> 00:34:15,250
that is going to be used at the database

754
00:34:11,739 --> 00:34:18,279
level encrypting this decrypting please

755
00:34:15,250 --> 00:34:20,609
sorry is really trivial as I told you

756
00:34:18,279 --> 00:34:28,239
before the only thing that you need to

757
00:34:20,609 --> 00:34:30,668
have is the key this key that is

758
00:34:28,239 --> 00:34:32,918
hard-coded in the obligation so what I

759
00:34:30,668 --> 00:34:36,668
did there is basically I took the s ap

760
00:34:32,918 --> 00:34:39,699
application I play with it a little bit

761
00:34:36,668 --> 00:34:43,868
actually I customized it just a little

762
00:34:39,699 --> 00:34:46,538
bit and I created my own the krypter of

763
00:34:43,869 --> 00:34:49,119
this secure storage basically once the

764
00:34:46,539 --> 00:34:50,500
decryption is done it will gladly give

765
00:34:49,119 --> 00:34:56,440
you the password of the administrator

766
00:34:50,500 --> 00:34:59,950
and the inter JDBC connection chain that

767
00:34:56,440 --> 00:35:05,619
system is automatically found right

768
00:34:59,950 --> 00:35:07,750
there so now we have the passwords of

769
00:35:05,619 --> 00:35:11,109
the ministry doors we have the password

770
00:35:07,750 --> 00:35:13,329
for the database we have everything how

771
00:35:11,109 --> 00:35:14,680
we can protect this from happen before

772
00:35:13,329 --> 00:35:17,170
we continue with the lateral movement

773
00:35:14,680 --> 00:35:19,118
but first of all the secret storage must

774
00:35:17,170 --> 00:35:21,509
be protected those are the files that

775
00:35:19,119 --> 00:35:24,519
actually you need to be protecting

776
00:35:21,509 --> 00:35:26,650
basically you need to be sure that only

777
00:35:24,519 --> 00:35:30,578
the SMB administrator has

778
00:35:26,650 --> 00:35:33,279
access to those files and the passwords

779
00:35:30,579 --> 00:35:35,619
that you see there must be different

780
00:35:33,279 --> 00:35:38,410
from the master password we're going to

781
00:35:35,619 --> 00:35:41,289
see very soon what a master password is

782
00:35:38,410 --> 00:35:43,538
which is one of the main issues that

783
00:35:41,289 --> 00:35:45,130
modern implementations of the ESP

784
00:35:43,539 --> 00:35:50,799
systems in the market are suffering

785
00:35:45,130 --> 00:35:52,630
right now so we already have the front

786
00:35:50,799 --> 00:35:57,910
end let's go for the beginner let's try

787
00:35:52,630 --> 00:36:00,789
to jump in what we're going to do here

788
00:35:57,910 --> 00:36:04,299
is to try to compromise the other a verb

789
00:36:00,789 --> 00:36:06,849
system right we have the credentials and

790
00:36:04,299 --> 00:36:09,700
we might try to realize them but let me

791
00:36:06,849 --> 00:36:12,010
tell you something is not necessary why

792
00:36:09,700 --> 00:36:15,250
because the way that the Java systems

793
00:36:12,010 --> 00:36:17,640
speak with the back end as a be a verb

794
00:36:15,250 --> 00:36:20,230
system is true some title is called jco

795
00:36:17,640 --> 00:36:22,598
basically jco is a wrapper that they

796
00:36:20,230 --> 00:36:24,250
have to speak the main protocol of

797
00:36:22,599 --> 00:36:26,670
communication that is a big Hoss that is

798
00:36:24,250 --> 00:36:30,279
called RF EC it's just a plain wrapper

799
00:36:26,670 --> 00:36:32,890
the jco will come with what is called a

800
00:36:30,279 --> 00:36:34,750
JCL destination what is that basically

801
00:36:32,890 --> 00:36:36,879
at some point of your database you have

802
00:36:34,750 --> 00:36:40,599
a hard coded connection with the

803
00:36:36,880 --> 00:36:42,069
hostname the port the client that we

804
00:36:40,599 --> 00:36:45,339
don't care what it is right now a

805
00:36:42,069 --> 00:36:47,920
username and a password of course that

806
00:36:45,339 --> 00:36:50,680
information is encrypted but how do you

807
00:36:47,920 --> 00:36:53,920
think it might be encrypted you guess it

808
00:36:50,680 --> 00:36:56,940
is exactly the Triple DES and is with

809
00:36:53,920 --> 00:37:01,119
the exact same key that you saw before

810
00:36:56,940 --> 00:37:03,670
this is a problem that I find very often

811
00:37:01,119 --> 00:37:08,440
it's like people trying to utilize not

812
00:37:03,670 --> 00:37:11,020
just technology if not crypto and even

813
00:37:08,440 --> 00:37:12,819
hard-coded credentials it works like a

814
00:37:11,020 --> 00:37:16,000
charm when you're a researcher is a big

815
00:37:12,819 --> 00:37:17,920
head when you are at the blue team so we

816
00:37:16,000 --> 00:37:20,680
also automatically that will give you

817
00:37:17,920 --> 00:37:23,289
direct access to the arab system also in

818
00:37:20,680 --> 00:37:28,868
teh DMC we have completely compromised

819
00:37:23,289 --> 00:37:31,059
the DMC which is s IP methods again we

820
00:37:28,869 --> 00:37:34,690
didn't even need to do mimic at within

821
00:37:31,059 --> 00:37:37,380
into Metasploit nothing just with the

822
00:37:34,690 --> 00:37:40,420
functionality the recipe give us and

823
00:37:37,380 --> 00:37:43,690
finally as we want to jump

824
00:37:40,420 --> 00:37:46,750
to the users son we want to utilize the

825
00:37:43,690 --> 00:37:49,390
master password before I show you a

826
00:37:46,750 --> 00:37:51,790
really silly demo what I mean is to

827
00:37:49,390 --> 00:37:53,259
realize the master password basically I

828
00:37:51,790 --> 00:37:54,790
want to define what is this master

829
00:37:53,260 --> 00:37:57,910
password basically when you are

830
00:37:54,790 --> 00:38:01,660
installing an SI p system si B is going

831
00:37:57,910 --> 00:38:04,569
to ask you hey do you want to create a

832
00:38:01,660 --> 00:38:07,720
unique password for each one of the

833
00:38:04,570 --> 00:38:10,180
special users the special users are sub

834
00:38:07,720 --> 00:38:12,669
star and data dictionary those are for

835
00:38:10,180 --> 00:38:15,040
the S ap application itself the special

836
00:38:12,670 --> 00:38:17,020
users are the operating system users

837
00:38:15,040 --> 00:38:20,470
that they say B is going to create for

838
00:38:17,020 --> 00:38:23,740
us the special users are the database

839
00:38:20,470 --> 00:38:27,160
this IP database users that we have a

840
00:38:23,740 --> 00:38:31,330
database is a piece going to us hey do

841
00:38:27,160 --> 00:38:34,480
you want to create a unique password for

842
00:38:31,330 --> 00:38:37,750
each one of those accounts or do you

843
00:38:34,480 --> 00:38:39,880
want to use a master password basically

844
00:38:37,750 --> 00:38:42,550
what the master password is going to use

845
00:38:39,880 --> 00:38:46,480
is reutilized that same credential that

846
00:38:42,550 --> 00:38:47,080
one credential across everything every

847
00:38:46,480 --> 00:38:49,960
single thing

848
00:38:47,080 --> 00:38:52,810
and unfortunately the utilization of

849
00:38:49,960 --> 00:38:56,590
master password is what it comes by

850
00:38:52,810 --> 00:38:59,770
default so against how it is configured

851
00:38:56,590 --> 00:39:02,620
in most of the organizations yes you got

852
00:38:59,770 --> 00:39:05,950
it right in general if you crack one

853
00:39:02,620 --> 00:39:07,990
half of any of those guys as I told you

854
00:39:05,950 --> 00:39:11,859
before that system is completely

855
00:39:07,990 --> 00:39:14,919
compromised and how because how sa B

856
00:39:11,860 --> 00:39:17,770
works in general that same password that

857
00:39:14,920 --> 00:39:21,880
you find one system for example and say

858
00:39:17,770 --> 00:39:23,770
there it's almost sure and almost

859
00:39:21,880 --> 00:39:27,370
guaranteed that that same password will

860
00:39:23,770 --> 00:39:30,970
be in production it always happens the

861
00:39:27,370 --> 00:39:33,660
same and is as you can see there 90 fine

862
00:39:30,970 --> 00:39:36,129
of the pen tests that we have used are

863
00:39:33,660 --> 00:39:38,259
using the master password for everything

864
00:39:36,130 --> 00:39:41,050
so if you have one passport you have

865
00:39:38,260 --> 00:39:45,790
everything and then for example you can

866
00:39:41,050 --> 00:39:48,520
use SSH to log into the systems because

867
00:39:45,790 --> 00:39:51,190
we you already know that the OS user of

868
00:39:48,520 --> 00:39:52,900
the that is being used by ACB will have

869
00:39:51,190 --> 00:39:57,269
that master password

870
00:39:52,900 --> 00:40:00,819
or you could use some other techniques

871
00:39:57,269 --> 00:40:02,618
for example I'm going to show you really

872
00:40:00,819 --> 00:40:04,329
soon this is just a really silly example

873
00:40:02,619 --> 00:40:06,819
of how you realize the master password

874
00:40:04,329 --> 00:40:08,950
you choose connect through SSH you

875
00:40:06,819 --> 00:40:11,829
execute whatever you want and that's it

876
00:40:08,950 --> 00:40:13,960
this is not very special interest in in

877
00:40:11,829 --> 00:40:16,029
terms of interest of time I'm going to

878
00:40:13,960 --> 00:40:17,950
just skip it because I want you to see

879
00:40:16,029 --> 00:40:22,269
that the real deal later on but if you

880
00:40:17,950 --> 00:40:24,848
have questions you can ask me once we

881
00:40:22,269 --> 00:40:28,419
had the master password once we have all

882
00:40:24,849 --> 00:40:33,039
the credentials basically it's game over

883
00:40:28,420 --> 00:40:35,440
right just by doing that very very small

884
00:40:33,039 --> 00:40:37,299
sequence of steps that by the way I'm

885
00:40:35,440 --> 00:40:40,150
going to show you at the end a program

886
00:40:37,299 --> 00:40:42,460
that does the whole thing like common

887
00:40:40,150 --> 00:40:44,319
execution gets the Sakura store the

888
00:40:42,460 --> 00:40:46,210
creeps the Sakura store and starts

889
00:40:44,319 --> 00:40:48,880
spreading those credentials pretty much

890
00:40:46,210 --> 00:40:53,890
everywhere once you get those level of

891
00:40:48,880 --> 00:40:55,900
privileges that's it is game over is

892
00:40:53,890 --> 00:40:58,058
when you see this type of a screen at

893
00:40:55,900 --> 00:41:00,430
the money money or just complicated in

894
00:40:58,059 --> 00:41:06,640
your life ruining your vacations or

895
00:41:00,430 --> 00:41:09,669
wasting your weekends so why this is

896
00:41:06,640 --> 00:41:12,730
happening apart that the technology is

897
00:41:09,670 --> 00:41:15,160
being utilized and encryption and the

898
00:41:12,730 --> 00:41:18,029
keys are being utilized why this is

899
00:41:15,160 --> 00:41:20,710
happening what you can do from your

900
00:41:18,029 --> 00:41:23,200
point of view to actually try to apply

901
00:41:20,710 --> 00:41:25,359
some confirmations to this well

902
00:41:23,200 --> 00:41:28,509
basically there is something that is

903
00:41:25,359 --> 00:41:31,779
called are an RFIC destinations that are

904
00:41:28,509 --> 00:41:34,210
very similar to the jco first of all you

905
00:41:31,779 --> 00:41:36,069
need to have the less privileged

906
00:41:34,210 --> 00:41:38,920
approach right the user that you're

907
00:41:36,069 --> 00:41:41,589
going to put in any of the connections

908
00:41:38,920 --> 00:41:43,180
like jay-z or FCS the nations had to

909
00:41:41,589 --> 00:41:43,930
have the less amount of privileges

910
00:41:43,180 --> 00:41:47,799
possible

911
00:41:43,930 --> 00:41:51,759
and second and this is key you don't

912
00:41:47,799 --> 00:41:53,619
need to use the master password now on

913
00:41:51,759 --> 00:41:55,480
the latest and greatest installers you

914
00:41:53,619 --> 00:41:57,220
don't have the master password but as

915
00:41:55,480 --> 00:41:59,259
soon as you type the very first password

916
00:41:57,220 --> 00:42:01,868
that password is spread automatically to

917
00:41:59,259 --> 00:42:03,700
the other users unless you go there and

918
00:42:01,869 --> 00:42:04,690
change it it's exactly the same as

919
00:42:03,700 --> 00:42:07,060
having the

920
00:42:04,690 --> 00:42:10,450
master password and finally you need to

921
00:42:07,060 --> 00:42:11,828
revise your final your firewall strategy

922
00:42:10,450 --> 00:42:13,868
I mean you need to ask yourself do I

923
00:42:11,829 --> 00:42:16,210
need such amount of a safe assistance

924
00:42:13,869 --> 00:42:19,150
directly exposed to the Internet can I

925
00:42:16,210 --> 00:42:24,910
do it better can make the users connect

926
00:42:19,150 --> 00:42:27,190
through a VPN so we are here wearing two

927
00:42:24,910 --> 00:42:29,379
internal network because we are pretty

928
00:42:27,190 --> 00:42:33,250
much spreading the credentials to

929
00:42:29,380 --> 00:42:35,609
whatever we can use to login we want to

930
00:42:33,250 --> 00:42:37,960
tag as a bonus we want to track the

931
00:42:35,609 --> 00:42:40,930
customers the people that are actually

932
00:42:37,960 --> 00:42:43,210
connecting to the internal network what

933
00:42:40,930 --> 00:42:46,480
we're gonna do basically there is a

934
00:42:43,210 --> 00:42:49,589
mechanism that ASAP has that is called

935
00:42:46,480 --> 00:42:52,180
soap our FEC it's just a web application

936
00:42:49,589 --> 00:42:57,910
sitting on the web application server

937
00:42:52,180 --> 00:43:00,399
that will translate HTTP to this are FEC

938
00:42:57,910 --> 00:43:04,480
protocol that I mentioned in before has

939
00:43:00,400 --> 00:43:06,609
many utilities this translation you have

940
00:43:04,480 --> 00:43:09,700
to invoke what is called a remote

941
00:43:06,609 --> 00:43:11,290
function call like a piece of SAV

942
00:43:09,700 --> 00:43:14,160
software coded in a profitable

943
00:43:11,290 --> 00:43:17,050
programming language called call Ava

944
00:43:14,160 --> 00:43:20,339
that might do different things the one

945
00:43:17,050 --> 00:43:23,349
that I found is one that sends an alert

946
00:43:20,339 --> 00:43:26,078
pop-up to every single person that is

947
00:43:23,349 --> 00:43:29,140
connected to the ASAP system so

948
00:43:26,079 --> 00:43:31,599
basically what this hypothetical Manoir

949
00:43:29,140 --> 00:43:34,660
what is going to do is by spraying the

950
00:43:31,599 --> 00:43:35,890
credentials across all the SM assistance

951
00:43:34,660 --> 00:43:38,290
on the internal network

952
00:43:35,890 --> 00:43:40,328
if three credentials are accepted all

953
00:43:38,290 --> 00:43:42,910
the users that are connected at that

954
00:43:40,329 --> 00:43:47,920
time will receive a pop-up that says hey

955
00:43:42,910 --> 00:43:51,430
your ASAP GUI version is deprecated you

956
00:43:47,920 --> 00:43:53,920
need to download this a small patch so

957
00:43:51,430 --> 00:43:56,410
you avoid disrupting the ESP system that

958
00:43:53,920 --> 00:43:59,170
you are connecting to and of course that

959
00:43:56,410 --> 00:44:02,348
small patch will be a Europe that we

960
00:43:59,170 --> 00:44:06,579
control that will be on charge to spread

961
00:44:02,349 --> 00:44:08,530
the malware let me quickly show you this

962
00:44:06,579 --> 00:44:11,560
is the payload that I have prepared for

963
00:44:08,530 --> 00:44:13,839
you here I'm limiting the execution of

964
00:44:11,560 --> 00:44:16,270
this pop-up to just one user but of

965
00:44:13,839 --> 00:44:18,400
course the attackers will will try to do

966
00:44:16,270 --> 00:44:20,529
this across pretty much every

967
00:44:18,400 --> 00:44:24,430
single-user know that the code is

968
00:44:20,529 --> 00:44:27,099
completely very simple because literally

969
00:44:24,430 --> 00:44:30,879
we're just hitting a URL we're just

970
00:44:27,099 --> 00:44:33,910
hitting a slash x AP / bc / salt / r vc

971
00:44:30,880 --> 00:44:36,849
and we are sending a post request with

972
00:44:33,910 --> 00:44:40,000
this XML that you see there and let me

973
00:44:36,849 --> 00:44:43,059
show you what happens I'm going to go as

974
00:44:40,000 --> 00:44:47,410
I was a regular user I'm my main screen

975
00:44:43,059 --> 00:44:49,809
doing my business and after the attacker

976
00:44:47,410 --> 00:44:53,109
gets the spray I will get a pop-up

977
00:44:49,809 --> 00:44:55,539
directly from the SA P client saying hey

978
00:44:53,109 --> 00:45:03,190
you already know the progression you

979
00:44:55,539 --> 00:45:05,799
must download my patch now and that's it

980
00:45:03,190 --> 00:45:10,059
you just don't have the server you also

981
00:45:05,799 --> 00:45:14,069
try to make the the users fall you can

982
00:45:10,059 --> 00:45:14,069
put like backdoors you can put like

983
00:45:14,309 --> 00:45:19,539
ransomware you can try to force them to

984
00:45:17,200 --> 00:45:22,868
do any action that you want again this

985
00:45:19,539 --> 00:45:25,329
was just one particular message you

986
00:45:22,869 --> 00:45:27,760
could try to do many more things with

987
00:45:25,329 --> 00:45:30,970
different RF EC function calls but again

988
00:45:27,760 --> 00:45:32,740
I'm fine myself don't great in a little

989
00:45:30,970 --> 00:45:34,868
bit data because they've shut the here

990
00:45:32,740 --> 00:45:38,770
is to create conscience to people so

991
00:45:34,869 --> 00:45:41,230
they patch and do the proper sappy

992
00:45:38,770 --> 00:45:43,000
security - instead of like allowing

993
00:45:41,230 --> 00:45:48,010
people to actually create a fully

994
00:45:43,000 --> 00:45:54,220
functional malware so wrapping up what

995
00:45:48,010 --> 00:45:57,279
do we learn today a few takeaways first

996
00:45:54,220 --> 00:45:59,859
you need to ask again the question like

997
00:45:57,279 --> 00:46:01,799
do I need all these SMP systems directly

998
00:45:59,859 --> 00:46:04,779
exposed to the Internet are there

999
00:46:01,799 --> 00:46:08,650
alternative methods that could help me

1000
00:46:04,779 --> 00:46:11,049
to raise the bar definitely there is no

1001
00:46:08,650 --> 00:46:14,200
excuse to poorly publish dev and QA

1002
00:46:11,049 --> 00:46:16,450
there is no excuse whatsoever if a few

1003
00:46:14,200 --> 00:46:19,000
set of developers want to work on your

1004
00:46:16,450 --> 00:46:20,828
recipe system just use VPN or use any

1005
00:46:19,000 --> 00:46:24,400
other thing there is no excuse to just

1006
00:46:20,829 --> 00:46:27,039
publish the ECP systems they're actually

1007
00:46:24,400 --> 00:46:28,370
one of the cases that I was a forensic

1008
00:46:27,039 --> 00:46:31,160
and

1009
00:46:28,370 --> 00:46:33,710
investigator for the government it

1010
00:46:31,160 --> 00:46:35,870
happened exactly at that as they exposed

1011
00:46:33,710 --> 00:46:38,380
a bank you a people compromised those

1012
00:46:35,870 --> 00:46:40,790
foxes hunt they start jumping around

1013
00:46:38,380 --> 00:46:42,860
there is something tell us if we will

1014
00:46:40,790 --> 00:46:45,770
include for free that is called the SP

1015
00:46:42,860 --> 00:46:47,720
word dispatcher where is going to help

1016
00:46:45,770 --> 00:46:50,240
you to restrict the amount of webpages

1017
00:46:47,720 --> 00:46:52,970
that you are going to make available to

1018
00:46:50,240 --> 00:46:55,700
your end customers for example if you

1019
00:46:52,970 --> 00:46:58,910
are only exposing a custom application

1020
00:46:55,700 --> 00:47:01,310
that you have on that Java system on the

1021
00:46:58,910 --> 00:47:02,690
DNC you can only allow the access the

1022
00:47:01,310 --> 00:47:04,730
public access to those set of

1023
00:47:02,690 --> 00:47:06,740
applications and that's it you can deny

1024
00:47:04,730 --> 00:47:10,850
the connections to every single

1025
00:47:06,740 --> 00:47:12,979
application that is out there and I know

1026
00:47:10,850 --> 00:47:15,140
that is a very controversial topic but

1027
00:47:12,980 --> 00:47:17,540
patching is key for everything today's

1028
00:47:15,140 --> 00:47:20,779
ASAP system wise patching is key in

1029
00:47:17,540 --> 00:47:22,580
general patching NSIP is not that easy

1030
00:47:20,780 --> 00:47:24,200
I mean it's not like patching our

1031
00:47:22,580 --> 00:47:26,630
Windows servers not that you don't know

1032
00:47:24,200 --> 00:47:28,460
the node next next next and that's it

1033
00:47:26,630 --> 00:47:30,320
you need to download the node and then

1034
00:47:28,460 --> 00:47:32,210
you need to follow what is color

1035
00:47:30,320 --> 00:47:34,340
correction instructions basically some

1036
00:47:32,210 --> 00:47:37,070
manual set of steps that you need to

1037
00:47:34,340 --> 00:47:40,160
take most of the times in order to

1038
00:47:37,070 --> 00:47:42,140
actually finish the application of that

1039
00:47:40,160 --> 00:47:46,190
patch you need to restart the SMP system

1040
00:47:42,140 --> 00:47:48,259
for the changes to take effect all the

1041
00:47:46,190 --> 00:47:50,150
trails all the trails are extremely

1042
00:47:48,260 --> 00:47:53,210
important we didn't cover these on this

1043
00:47:50,150 --> 00:47:55,070
truck because of time but most of the

1044
00:47:53,210 --> 00:47:57,740
early trails at least on Ava

1045
00:47:55,070 --> 00:48:00,170
they don't come enabled by default so in

1046
00:47:57,740 --> 00:48:02,990
case of a security incident if you don't

1047
00:48:00,170 --> 00:48:05,420
have them there is very little that and

1048
00:48:02,990 --> 00:48:08,569
a forensic investigator can do in order

1049
00:48:05,420 --> 00:48:10,850
to analyze the attacks audit rows are

1050
00:48:08,570 --> 00:48:11,540
key for the Java side the ones that we

1051
00:48:10,850 --> 00:48:14,029
care about

1052
00:48:11,540 --> 00:48:17,360
lucky for us or not like for us this was

1053
00:48:14,030 --> 00:48:20,360
a good move on honest ap they do common

1054
00:48:17,360 --> 00:48:22,880
evil by default then you need to make

1055
00:48:20,360 --> 00:48:26,570
your sock a safety aware I always make

1056
00:48:22,880 --> 00:48:28,460
the joke that IT security and the SAPT

1057
00:48:26,570 --> 00:48:30,530
Minsk are like a Venn diagram that never

1058
00:48:28,460 --> 00:48:31,940
intercepts from one side you had that

1059
00:48:30,530 --> 00:48:34,450
the security guys that they know a

1060
00:48:31,940 --> 00:48:37,850
lovable IT security but they might not

1061
00:48:34,450 --> 00:48:39,589
know a lot about ASAP and from the other

1062
00:48:37,850 --> 00:48:42,040
side you have disappearance traitors

1063
00:48:39,590 --> 00:48:43,990
which know a lot about a CP but none

1064
00:48:42,040 --> 00:48:46,990
I certainly know a lot about information

1065
00:48:43,990 --> 00:48:49,689
security and finally prevent prevent

1066
00:48:46,990 --> 00:48:52,779
prevent don't put yourself on the case

1067
00:48:49,690 --> 00:48:55,840
of having to do a forensic investigation

1068
00:48:52,780 --> 00:48:58,000
because it's a headache you know when

1069
00:48:55,840 --> 00:49:01,510
you start you never know when you leave

1070
00:48:58,000 --> 00:49:04,570
and a part of that because it's a B is

1071
00:49:01,510 --> 00:49:06,070
so huge has so many data sources and if

1072
00:49:04,570 --> 00:49:09,250
they're available you have a such a

1073
00:49:06,070 --> 00:49:11,590
gigantic volume of logs you can never

1074
00:49:09,250 --> 00:49:14,020
guarantee that the ABCs thing has not

1075
00:49:11,590 --> 00:49:15,850
been hot if you say that you will be

1076
00:49:14,020 --> 00:49:19,570
lying to your customer or to your

1077
00:49:15,850 --> 00:49:21,940
employer you can say eh I found evidence

1078
00:49:19,570 --> 00:49:23,560
of compromise yes your system was hot

1079
00:49:21,940 --> 00:49:28,960
but you can never guarantee that the

1080
00:49:23,560 --> 00:49:33,520
system was not hack okay so I think we

1081
00:49:28,960 --> 00:49:35,500
have time to spare if you guys have

1082
00:49:33,520 --> 00:49:37,800
final questions this is the time if

1083
00:49:35,500 --> 00:49:40,570
there are more sensitive you can say

1084
00:49:37,800 --> 00:49:42,190
ministers here or you can contact me at

1085
00:49:40,570 --> 00:49:45,250
the conference I will be here for the

1086
00:49:42,190 --> 00:49:48,730
rest of the day so don't be shy and ask

1087
00:49:45,250 --> 00:49:51,390
away if not let's go to have lunch thank

1088
00:49:48,730 --> 00:49:51,390
you for your time guys

1089
00:49:51,510 --> 00:50:12,630
[Applause]

1090
00:49:56,990 --> 00:50:15,330
very interesting very interesting look

1091
00:50:12,630 --> 00:50:18,330
into logs that would detect all of those

1092
00:50:15,330 --> 00:50:24,299
changes all those things that you've

1093
00:50:18,330 --> 00:50:27,029
been doing what that's an amazing

1094
00:50:24,300 --> 00:50:30,450
question and unfortunately there is no

1095
00:50:27,030 --> 00:50:33,180
much documentation of that when I had to

1096
00:50:30,450 --> 00:50:35,399
start doing forensics I found myself on

1097
00:50:33,180 --> 00:50:37,620
that same issue there was no

1098
00:50:35,400 --> 00:50:39,210
documentation whatsoever and let me tell

1099
00:50:37,620 --> 00:50:41,609
you that is not easy at all

1100
00:50:39,210 --> 00:50:45,060
first of all and this is what I do on my

1101
00:50:41,610 --> 00:50:46,950
regular forensics is once I have all the

1102
00:50:45,060 --> 00:50:49,910
locks activated I need to create a

1103
00:50:46,950 --> 00:50:52,350
parcel for each one of those locks why

1104
00:50:49,910 --> 00:50:54,540
because they are not a machinist each

1105
00:50:52,350 --> 00:50:55,950
lock that comes from all the different

1106
00:50:54,540 --> 00:50:57,960
services that you need on a list an

1107
00:50:55,950 --> 00:51:00,330
alive they're completely different from

1108
00:50:57,960 --> 00:51:03,360
one another so Moton and plaintext some

1109
00:51:00,330 --> 00:51:06,029
of them are even binary once you create

1110
00:51:03,360 --> 00:51:09,420
the departs at once you get information

1111
00:51:06,030 --> 00:51:11,700
I put it on Splunk why because there is

1112
00:51:09,420 --> 00:51:15,090
a lot of info that you need to start

1113
00:51:11,700 --> 00:51:17,520
analyzing and finally and this is the

1114
00:51:15,090 --> 00:51:20,940
most complex part and this is the real

1115
00:51:17,520 --> 00:51:23,009
bottleneck you need to know about ACP in

1116
00:51:20,940 --> 00:51:24,930
order to apply the heuristics because

1117
00:51:23,010 --> 00:51:27,960
you need to know what you're looking for

1118
00:51:24,930 --> 00:51:30,359
and unfortunately for that unless you

1119
00:51:27,960 --> 00:51:32,670
are an attacker unless you have passed

1120
00:51:30,360 --> 00:51:35,580
time actually a reverse engineer on

1121
00:51:32,670 --> 00:51:37,620
playing with the core of ASAP there are

1122
00:51:35,580 --> 00:51:40,799
no documents that will let you know

1123
00:51:37,620 --> 00:51:43,200
exactly what to look for that there is a

1124
00:51:40,800 --> 00:51:47,340
gap we are security researcher still

1125
00:51:43,200 --> 00:51:49,620
owned to the general public got another

1126
00:51:47,340 --> 00:51:53,250
one I have to you I mean as my first one

1127
00:51:49,620 --> 00:51:54,210
is a lot over here very quickly in terms

1128
00:51:53,250 --> 00:51:56,460
of compare

1129
00:51:54,210 --> 00:51:58,080
of difficulty hatching have you compared

1130
00:51:56,460 --> 00:51:59,700
as they these patent process with

1131
00:51:58,080 --> 00:52:03,779
complexity of Oracle's patent process

1132
00:51:59,700 --> 00:52:06,868
and if so which one was worse well I

1133
00:52:03,780 --> 00:52:10,230
don't know which one in words but yes in

1134
00:52:06,869 --> 00:52:13,619
terms of complexity absolutely the it's

1135
00:52:10,230 --> 00:52:16,140
not that issues us a new patch is coming

1136
00:52:13,619 --> 00:52:18,030
let's apply you guys you will find and

1137
00:52:16,140 --> 00:52:19,830
this is very common you will find a lot

1138
00:52:18,030 --> 00:52:21,690
of resistance from the business

1139
00:52:19,830 --> 00:52:24,150
something very particular that happens

1140
00:52:21,690 --> 00:52:26,460
here is that if you wanna patch a switch

1141
00:52:24,150 --> 00:52:29,190
core well I did security ohms that if

1142
00:52:26,460 --> 00:52:31,589
you wanna part webserver that everyone

1143
00:52:29,190 --> 00:52:34,500
uses what is security owns that if you

1144
00:52:31,589 --> 00:52:37,619
wanna patch sa be most of the times the

1145
00:52:34,500 --> 00:52:39,540
business owns that box so you have to

1146
00:52:37,619 --> 00:52:42,540
negotiate with the business when you

1147
00:52:39,540 --> 00:52:44,580
have a window of opportunity because you

1148
00:52:42,540 --> 00:52:46,520
most likely we have to restore this AP

1149
00:52:44,580 --> 00:52:50,098
system for the changes to take effect

1150
00:52:46,520 --> 00:52:52,530
yes I will say that I say be is leader

1151
00:52:50,099 --> 00:52:56,280
for a reason though but yes is

1152
00:52:52,530 --> 00:53:03,020
definitely non-trivial I have another

1153
00:52:56,280 --> 00:53:06,839
question you haven't because there is

1154
00:53:03,020 --> 00:53:09,990
actually none all the things you were

1155
00:53:06,839 --> 00:53:12,750
describing theoretical no no these are

1156
00:53:09,990 --> 00:53:15,779
like very very real and actually what I

1157
00:53:12,750 --> 00:53:18,300
show you it was the easiest way it was

1158
00:53:15,780 --> 00:53:20,730
the part of less resistant which is

1159
00:53:18,300 --> 00:53:22,950
exactly what an attacker would try to do

1160
00:53:20,730 --> 00:53:24,900
later on you have far far more

1161
00:53:22,950 --> 00:53:26,549
complicated techniques that if you know

1162
00:53:24,900 --> 00:53:28,980
what you're doing you can achieve like

1163
00:53:26,550 --> 00:53:31,170
attacking pure recipe components but

1164
00:53:28,980 --> 00:53:33,000
most of the tough that you saw here are

1165
00:53:31,170 --> 00:53:37,320
web related that everyone understands

1166
00:53:33,000 --> 00:53:39,390
well my second question is in doing this

1167
00:53:37,320 --> 00:53:43,290
research with regional companies have

1168
00:53:39,390 --> 00:53:45,118
you interact with any of the audit firms

1169
00:53:43,290 --> 00:53:48,109
groups people look at all these things

1170
00:53:45,119 --> 00:53:51,630
can look at their attempts at security

1171
00:53:48,109 --> 00:53:56,098
yes it's a it's a funny question that

1172
00:53:51,630 --> 00:53:58,380
you ask you know that every time that

1173
00:53:56,099 --> 00:54:02,910
you hear one of those buzzwords like a

1174
00:53:58,380 --> 00:54:05,760
blockchain or cyber you start to feel

1175
00:54:02,910 --> 00:54:06,899
the chill but it's the only way that we

1176
00:54:05,760 --> 00:54:08,819
have to differentiate

1177
00:54:06,900 --> 00:54:10,770
self with the regular approach that

1178
00:54:08,819 --> 00:54:12,569
those guys will take those guys when

1179
00:54:10,770 --> 00:54:13,890
they say I wanna do sa P security

1180
00:54:12,569 --> 00:54:16,230
basically what they're doing is

1181
00:54:13,890 --> 00:54:18,420
segregation of the ADIZ making sure that

1182
00:54:16,230 --> 00:54:20,579
if I have a user that gantry the

1183
00:54:18,420 --> 00:54:23,640
purchase order that user cannot approve

1184
00:54:20,579 --> 00:54:27,150
it but in terms of cyber security as

1185
00:54:23,640 --> 00:54:29,430
part of check-in the few default users

1186
00:54:27,150 --> 00:54:31,470
that's about it that's the value that

1187
00:54:29,430 --> 00:54:33,240
you're getting don't get me wrong is you

1188
00:54:31,470 --> 00:54:35,069
still definitely need figuration or

1189
00:54:33,240 --> 00:54:38,520
duties and a lot because that prevents

1190
00:54:35,069 --> 00:54:40,020
fraud but someone needs to take or start

1191
00:54:38,520 --> 00:54:41,970
thinking on buffer overflows and stack

1192
00:54:40,020 --> 00:54:43,710
overflows from a common executions and

1193
00:54:41,970 --> 00:54:46,259
those topics are not being covered

1194
00:54:43,710 --> 00:54:57,260
nowadays by those guys where do you

1195
00:54:46,260 --> 00:54:57,260
think that is thank you thank you guys

