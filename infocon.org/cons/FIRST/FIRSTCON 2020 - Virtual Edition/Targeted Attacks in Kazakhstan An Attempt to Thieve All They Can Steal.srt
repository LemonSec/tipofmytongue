1
00:00:15,280 --> 00:00:16,880
hey okay can you hear me

2
00:00:16,880 --> 00:00:20,160
yeah okay thanks hello colleagues uh as

3
00:00:20,160 --> 00:00:23,279
uh sir thanks for uh

4
00:00:23,279 --> 00:00:26,640
my presentation uh my name is aleka

5
00:00:26,640 --> 00:00:29,199
said uh i'm working as a head of

6
00:00:29,199 --> 00:00:31,119
anti-malware research lab

7
00:00:31,119 --> 00:00:34,000
uh for state technical services here in

8
00:00:34,000 --> 00:00:35,200
kazakhstan in

9
00:00:35,200 --> 00:00:38,399
north carolina or ax astana city

10
00:00:38,399 --> 00:00:41,840
uh i working for a kazakhstan government

11
00:00:41,840 --> 00:00:43,840
company which work in

12
00:00:43,840 --> 00:00:48,800
the security field and hosts

13
00:00:48,800 --> 00:00:53,519
cases heard in this company

14
00:00:56,559 --> 00:01:00,239
our digit church was established in 2011

15
00:01:00,239 --> 00:01:03,280
uh now it has

16
00:01:03,280 --> 00:01:07,040
many connections due to uh

17
00:01:07,040 --> 00:01:10,159
uh cross-border nature of cyber

18
00:01:10,159 --> 00:01:11,439
incidents which

19
00:01:11,439 --> 00:01:15,600
we are investigate and

20
00:01:15,600 --> 00:01:19,040
kiss its earth is

21
00:01:19,040 --> 00:01:22,159
has a wide network of contacts um

22
00:01:22,159 --> 00:01:26,640
with many search or

23
00:01:26,640 --> 00:01:30,079
ig security vendors if you interested in

24
00:01:30,079 --> 00:01:32,320
cooperation with us you can drop me a

25
00:01:32,320 --> 00:01:33,200
mail

26
00:01:33,200 --> 00:01:36,560
and we we respond you and

27
00:01:36,560 --> 00:01:39,200
we we can cooperate uh with we've

28
00:01:39,200 --> 00:01:40,640
analyzed analyzed

29
00:01:40,640 --> 00:01:44,640
statistics uh of uh cyber incident and

30
00:01:44,640 --> 00:01:45,759
as you can see

31
00:01:45,759 --> 00:01:48,320
uh the number the total number of

32
00:01:48,320 --> 00:01:49,040
incidents

33
00:01:49,040 --> 00:01:52,079
uh in uh this year uh

34
00:01:52,079 --> 00:01:55,119
increased was increased in uh due to the

35
00:01:55,119 --> 00:01:56,240
transferring

36
00:01:56,240 --> 00:02:00,399
uh operations uh to online mode

37
00:02:00,399 --> 00:02:03,439
and as you can see uh

38
00:02:03,439 --> 00:02:07,439
the doors numbers was increased uh

39
00:02:07,439 --> 00:02:11,360
dramatically in may because

40
00:02:11,360 --> 00:02:15,360
we have internal um

41
00:02:15,360 --> 00:02:18,480
specific uh operations here

42
00:02:18,480 --> 00:02:22,400
uh because of

43
00:02:22,400 --> 00:02:26,000
government helping to uh to the

44
00:02:26,000 --> 00:02:29,680
uh people and uh some ddos attacks uh

45
00:02:29,680 --> 00:02:32,800
was uh uh were

46
00:02:32,800 --> 00:02:38,000
uh at this time fishing

47
00:02:38,000 --> 00:02:40,460
has also increased

48
00:02:40,460 --> 00:02:43,360
[Music]

49
00:02:43,360 --> 00:02:46,800
most prevalent fields are financial

50
00:02:46,800 --> 00:02:49,680
education trade and straight

51
00:02:49,680 --> 00:02:52,800
and we see it in in march

52
00:02:52,800 --> 00:02:55,920
and april and october uh

53
00:02:55,920 --> 00:02:59,920
we see you can see a

54
00:03:00,480 --> 00:03:05,120
beacon freezing uh uh comparing with

55
00:03:05,120 --> 00:03:09,040
last year uh as you can see on my slide

56
00:03:09,040 --> 00:03:12,319
um the bosch prevalent uh

57
00:03:12,319 --> 00:03:15,599
channel is a website uh which

58
00:03:15,599 --> 00:03:19,120
placing uh fishing pages

59
00:03:19,120 --> 00:03:22,000
to to

60
00:03:22,879 --> 00:03:27,440
work with victims and now i want to

61
00:03:27,440 --> 00:03:32,239
talk about some interesting

62
00:03:32,239 --> 00:03:36,000
targeted attacks which which we uh

63
00:03:36,000 --> 00:03:41,440
investigate in here in kazakhstan and um

64
00:03:41,680 --> 00:03:44,480
talk about interesting moments so which

65
00:03:44,480 --> 00:03:45,200
we

66
00:03:45,200 --> 00:03:49,519
uh we found almost all 19 percent of

67
00:03:49,519 --> 00:03:50,959
analyzed uh

68
00:03:50,959 --> 00:03:54,879
uh samples are bad of uh horsepower

69
00:03:54,879 --> 00:03:57,680
spyware i think it's uh due to the

70
00:03:57,680 --> 00:03:58,840
nature of

71
00:03:58,840 --> 00:04:03,040
our uh fields of aeration its government

72
00:04:03,040 --> 00:04:04,480
sector on critical

73
00:04:04,480 --> 00:04:07,519
infrastructure sector uh uh

74
00:04:07,519 --> 00:04:10,959
attackers want to uh to control uh

75
00:04:10,959 --> 00:04:14,080
this um these computers

76
00:04:14,080 --> 00:04:16,160
in the government or infra

77
00:04:16,160 --> 00:04:17,120
infrastructure

78
00:04:17,120 --> 00:04:20,560
uh field uh we found

79
00:04:20,560 --> 00:04:23,600
uh one computer which has um

80
00:04:23,600 --> 00:04:27,199
20 malware samples uh 12 of them

81
00:04:27,199 --> 00:04:30,800
uh were spyware and four of them

82
00:04:30,800 --> 00:04:33,840
were installed during one day it's it

83
00:04:33,840 --> 00:04:34,639
was so

84
00:04:34,639 --> 00:04:37,199
interesting uh very interesting computer

85
00:04:37,199 --> 00:04:38,000
uh for

86
00:04:38,000 --> 00:04:41,759
attackers uh two years and three months

87
00:04:41,759 --> 00:04:43,280
uh

88
00:04:43,280 --> 00:04:46,960
spyware was active on a computer

89
00:04:46,960 --> 00:04:49,440
uh it was a record which we've

90
00:04:49,440 --> 00:04:50,479
investigated

91
00:04:50,479 --> 00:04:53,680
and the second place uh was

92
00:04:53,680 --> 00:04:56,960
uh one year and 10 months of active

93
00:04:56,960 --> 00:05:00,560
uh spyware on the comp at the computer

94
00:05:00,560 --> 00:05:03,919
uh we found more than uh 10 infected

95
00:05:03,919 --> 00:05:05,039
computers

96
00:05:05,039 --> 00:05:08,960
during one incidence the victims

97
00:05:08,960 --> 00:05:14,479
didn't do anything as i said we found

98
00:05:14,639 --> 00:05:18,160
encoded config file of malware which

99
00:05:18,160 --> 00:05:23,919
contained mac addresses

100
00:05:24,000 --> 00:05:27,600
encoded mark addresses of targeted

101
00:05:27,600 --> 00:05:31,520
victims and we could

102
00:05:31,520 --> 00:05:34,880
could find this computer by

103
00:05:34,880 --> 00:05:38,320
mark addresses we can

104
00:05:38,320 --> 00:05:41,680
we see uh during our investigations uh

105
00:05:41,680 --> 00:05:44,800
complication of malware uh attempts to

106
00:05:44,800 --> 00:05:47,039
bypass many protection techniques

107
00:05:47,039 --> 00:05:50,400
uh such as sandboxes so attackers

108
00:05:50,400 --> 00:05:53,680
uh knowing about

109
00:05:53,680 --> 00:05:57,360
modern techniques ideas

110
00:05:57,360 --> 00:06:01,120
networks and boxes mails and boxes

111
00:06:01,120 --> 00:06:05,280
edr and so on and try to

112
00:06:05,280 --> 00:06:08,319
bypass it with many

113
00:06:08,319 --> 00:06:12,400
techniques as i said

114
00:06:14,240 --> 00:06:18,000
after the the first case

115
00:06:18,000 --> 00:06:21,120
about which i i want to talk uh

116
00:06:21,120 --> 00:06:24,319
has um interesting technique

117
00:06:24,319 --> 00:06:28,240
because um any operations was made by

118
00:06:28,240 --> 00:06:30,639
um

119
00:06:32,000 --> 00:06:36,400
by a legitimate court uh

120
00:06:36,479 --> 00:06:40,319
source code of malware

121
00:06:40,319 --> 00:06:43,680
which was written on c sharp uh was

122
00:06:43,680 --> 00:06:46,880
delivered to the victim's computer

123
00:06:46,880 --> 00:06:50,160
uh this uh malware

124
00:06:50,160 --> 00:06:53,520
uh contained a small loader as you can

125
00:06:53,520 --> 00:06:53,919
see

126
00:06:53,919 --> 00:06:57,680
on upper uh part of the slide

127
00:06:57,680 --> 00:07:00,960
uh which allocates uh memory

128
00:07:00,960 --> 00:07:03,800
and then create thread with

129
00:07:03,800 --> 00:07:05,039
[Music]

130
00:07:05,039 --> 00:07:08,479
the memory which contains

131
00:07:08,479 --> 00:07:12,639
show code which

132
00:07:12,639 --> 00:07:15,759
stored in array uh

133
00:07:15,759 --> 00:07:19,199
which placed on uh

134
00:07:19,199 --> 00:07:23,039
above of the uh this port and um

135
00:07:23,039 --> 00:07:26,479
this code delivered uh to um

136
00:07:26,479 --> 00:07:28,960
to victim's machine as i said before

137
00:07:28,960 --> 00:07:29,520
then

138
00:07:29,520 --> 00:07:33,039
it's compiled by a legitimate

139
00:07:33,039 --> 00:07:37,199
code which included into microsoft

140
00:07:37,199 --> 00:07:40,639
windows uh as you see in the middle of

141
00:07:40,639 --> 00:07:41,919
the slide

142
00:07:41,919 --> 00:07:46,160
it's compiled to dll

143
00:07:46,160 --> 00:07:50,479
and this dll loaded by powershell code

144
00:07:50,479 --> 00:07:55,360
which shown at

145
00:07:55,360 --> 00:07:58,560
the button

146
00:07:58,560 --> 00:08:01,599
part of the uh this uh

147
00:08:01,599 --> 00:08:04,800
uh this picture and uh

148
00:08:04,800 --> 00:08:09,440
dll uh uh working with uh payload uh it

149
00:08:09,440 --> 00:08:10,400
was uh

150
00:08:10,400 --> 00:08:14,000
uh backdoor which can control

151
00:08:14,000 --> 00:08:18,000
uh almost all

152
00:08:18,000 --> 00:08:20,639
operations on the computer this first

153
00:08:20,639 --> 00:08:22,960
case uh

154
00:08:22,960 --> 00:08:26,479
has a additional um

155
00:08:26,479 --> 00:08:29,759
additional parts because when we

156
00:08:29,759 --> 00:08:33,200
investigate this case

157
00:08:33,200 --> 00:08:36,399
we found another computer

158
00:08:36,399 --> 00:08:39,760
which has a similar dll

159
00:08:39,760 --> 00:08:42,159
which was protected with good protector

160
00:08:42,159 --> 00:08:43,360
and

161
00:08:43,360 --> 00:08:47,519
it was uh difficult to to dump

162
00:08:47,519 --> 00:08:51,279
the code there's a payload

163
00:08:51,279 --> 00:08:55,200
because it was uh

164
00:08:55,200 --> 00:08:59,360
encrypted uh but we tried to

165
00:08:59,360 --> 00:09:02,800
you know to to find this code because

166
00:09:02,800 --> 00:09:06,240
we thought that um

167
00:09:06,240 --> 00:09:09,760
the code was uh stored as a

168
00:09:09,760 --> 00:09:13,360
nri and we think about um

169
00:09:13,360 --> 00:09:17,040
a situation that uh this array must be

170
00:09:17,040 --> 00:09:20,880
must be decrypted uh before uh loading

171
00:09:20,880 --> 00:09:24,160
and we thought that

172
00:09:24,160 --> 00:09:27,060
it can be found in decrypted

173
00:09:27,060 --> 00:09:29,600
[Music]

174
00:09:29,600 --> 00:09:32,320
in decrypted

175
00:09:34,480 --> 00:09:37,519
file uh in in the memory in the memory

176
00:09:37,519 --> 00:09:38,560
um

177
00:09:38,560 --> 00:09:42,000
and uh we tried to found uh

178
00:09:42,000 --> 00:09:45,200
it in dump in memory down and we found

179
00:09:45,200 --> 00:09:45,680
because

180
00:09:45,680 --> 00:09:48,720
um uh the code was the same

181
00:09:48,720 --> 00:09:52,160
but protected and because of

182
00:09:52,160 --> 00:09:55,200
a mistake of attackers we can

183
00:09:55,200 --> 00:09:58,480
we could get and dump

184
00:09:58,480 --> 00:10:02,480
this payload and analyze it

185
00:10:02,480 --> 00:10:05,519
second case which i want to

186
00:10:05,519 --> 00:10:08,399
talk about uh interesting by this

187
00:10:08,399 --> 00:10:09,279
operation

188
00:10:09,279 --> 00:10:12,320
each separation scheme uh

189
00:10:12,320 --> 00:10:16,160
it used um a process following technique

190
00:10:16,160 --> 00:10:19,440
surfaces halloween technique so mobxis

191
00:10:19,440 --> 00:10:20,480
xz

192
00:10:20,480 --> 00:10:24,240
it malware malicious

193
00:10:24,240 --> 00:10:26,640
files

194
00:10:28,160 --> 00:10:31,200
malicious file each

195
00:10:31,200 --> 00:10:34,320
run check if it runs in

196
00:10:34,320 --> 00:10:38,800
a virtual machine if it

197
00:10:38,800 --> 00:10:42,480
passed checking it run

198
00:10:42,480 --> 00:10:45,680
another copy of it

199
00:10:45,680 --> 00:10:49,279
writes decrypted resource

200
00:10:49,279 --> 00:10:52,640
into the memory of the second

201
00:10:52,640 --> 00:10:55,920
process and

202
00:10:57,279 --> 00:11:01,519
run payload which was

203
00:11:01,519 --> 00:11:05,279
inject uh the payload code

204
00:11:05,279 --> 00:11:08,320
into the memory of existing legitimate

205
00:11:08,320 --> 00:11:08,880
process

206
00:11:08,880 --> 00:11:12,160
uh explorer xz uh on 32

207
00:11:12,160 --> 00:11:16,079
architecture and calculate z uh

208
00:11:16,079 --> 00:11:19,200
on uh 64 at architecture

209
00:11:19,200 --> 00:11:23,279
and run this case uh

210
00:11:23,279 --> 00:11:26,320
used many intermediate domains uh it was

211
00:11:26,320 --> 00:11:29,279
an idol model

212
00:11:29,279 --> 00:11:31,360
used many intermediate domains for

213
00:11:31,360 --> 00:11:32,399
getting real

214
00:11:32,399 --> 00:11:35,360
urls to download one of the sample

215
00:11:35,360 --> 00:11:36,000
contained

216
00:11:36,000 --> 00:11:39,440
more than one uh thousand four

217
00:11:39,440 --> 00:11:42,800
hundred of domains uh

218
00:11:42,800 --> 00:11:45,920
it use this domain uh at least

219
00:11:45,920 --> 00:11:49,519
uh very um uh very

220
00:11:49,519 --> 00:11:52,800
uh very economically

221
00:11:52,800 --> 00:11:56,000
maybe by one

222
00:11:56,000 --> 00:11:59,120
or two uh uh per minute

223
00:11:59,120 --> 00:12:03,040
uh it was uh done because um

224
00:12:03,040 --> 00:12:06,800
attackers want to hide these uh

225
00:12:06,800 --> 00:12:11,040
domains uh from analysis or

226
00:12:11,040 --> 00:12:14,560
in sandbox and sandbox couldn't receive

227
00:12:14,560 --> 00:12:17,839
a full list of domains which

228
00:12:17,839 --> 00:12:21,120
this malware used

229
00:12:21,360 --> 00:12:24,560
the code in the sample uh looks innocent

230
00:12:24,560 --> 00:12:27,760
uh the first uh sample

231
00:12:27,760 --> 00:12:31,200
uh has only uh uh

232
00:12:31,200 --> 00:12:34,800
larger of uh itself and

233
00:12:34,800 --> 00:12:38,800
only uh

234
00:12:38,800 --> 00:12:41,839
uh memory of the second process and

235
00:12:41,839 --> 00:12:43,200
nothing else

236
00:12:43,200 --> 00:12:46,639
so static analysis can

237
00:12:46,639 --> 00:12:51,120
show real functionality of malware

238
00:12:51,120 --> 00:12:55,600
files which this malware want to

239
00:12:55,600 --> 00:12:58,880
download uh had intentionally

240
00:12:58,880 --> 00:13:02,079
damaged the header it was made for

241
00:13:02,079 --> 00:13:05,839
um by passing

242
00:13:05,839 --> 00:13:09,600
network sandbox

243
00:13:09,600 --> 00:13:13,200
when a network savebox try to execute

244
00:13:13,200 --> 00:13:17,200
a downloading file it fails because

245
00:13:17,200 --> 00:13:21,120
file corrupted and sample

246
00:13:21,120 --> 00:13:24,480
samples as i said do many

247
00:13:24,480 --> 00:13:28,000
anti-vms and box checks to prevent

248
00:13:28,000 --> 00:13:32,160
execution in sandboxes the third case

249
00:13:32,160 --> 00:13:35,200
it's also very interesting because of

250
00:13:35,200 --> 00:13:38,880
its uh operation mode

251
00:13:38,880 --> 00:13:42,000
uh it at the upper

252
00:13:42,000 --> 00:13:45,680
um part of this slide

253
00:13:45,680 --> 00:13:49,519
you can see a little script

254
00:13:49,519 --> 00:13:54,240
which resto receives

255
00:13:54,240 --> 00:13:59,120
doc files microsoft word files

256
00:13:59,120 --> 00:14:02,639
docx or doc formats

257
00:14:02,639 --> 00:14:05,760
into rtf format

258
00:14:05,760 --> 00:14:09,839
then rtf uh file

259
00:14:09,839 --> 00:14:14,000
was a then show called

260
00:14:14,000 --> 00:14:17,199
exploit code was appended to a new

261
00:14:17,199 --> 00:14:20,320
rtf file and you

262
00:14:20,320 --> 00:14:24,560
you can see uh

263
00:14:24,560 --> 00:14:28,320
exploit code as in a red

264
00:14:28,320 --> 00:14:31,519
box uh at the bottom uh

265
00:14:31,519 --> 00:14:34,560
lower uh part of the screen

266
00:14:34,560 --> 00:14:39,040
and this exploit

267
00:14:40,720 --> 00:14:43,040
makes

268
00:14:43,839 --> 00:14:47,360
that uh microsoft word when it uh

269
00:14:47,360 --> 00:14:51,279
opens uh uh file uh

270
00:14:51,279 --> 00:14:54,079
can load a malicious code which is

271
00:14:54,079 --> 00:14:55,360
stored into

272
00:14:55,360 --> 00:14:59,040
uh the dll earth x

273
00:14:59,040 --> 00:15:02,240
dll uh which uh placed uh

274
00:15:02,240 --> 00:15:05,760
uh nearby the the file in the same

275
00:15:05,760 --> 00:15:08,880
uh uh in the same directory

276
00:15:08,880 --> 00:15:11,160
and um uh

277
00:15:11,160 --> 00:15:13,760
[Music]

278
00:15:13,760 --> 00:15:17,440
as you can see when we opened the

279
00:15:17,440 --> 00:15:20,800
test document which in real case

280
00:15:20,800 --> 00:15:24,639
uh will be a real

281
00:15:24,639 --> 00:15:28,320
user's file legitimate but we

282
00:15:28,320 --> 00:15:32,320
but restored uh received in rtf format

283
00:15:32,320 --> 00:15:32,720
with

284
00:15:32,720 --> 00:15:35,920
exploit code and when uh

285
00:15:35,920 --> 00:15:39,120
word uh ms word will open

286
00:15:39,120 --> 00:15:41,839
this file

287
00:15:42,800 --> 00:15:46,959
dll will be loaded into the memory and

288
00:15:46,959 --> 00:15:51,360
in fact the computer which

289
00:15:51,360 --> 00:15:54,880
on which it will open and uh

290
00:15:54,880 --> 00:15:58,480
we can see uh uh process three uh

291
00:15:58,480 --> 00:16:02,560
uh that shows uh that win world

292
00:16:02,560 --> 00:16:05,839
lords around yellow 32 xz uh

293
00:16:05,839 --> 00:16:09,600
which with malicious port which

294
00:16:09,600 --> 00:16:12,959
in fact already infects uh targeted

295
00:16:12,959 --> 00:16:13,839
computer

296
00:16:13,839 --> 00:16:16,880
and if you

297
00:16:16,959 --> 00:16:20,560
zoom it you can see that it

298
00:16:20,560 --> 00:16:23,600
that malicious dll was placed into

299
00:16:23,600 --> 00:16:27,279
temp directory uh uh with name of the

300
00:16:27,279 --> 00:16:27,680
file

301
00:16:27,680 --> 00:16:31,600
e rt util dot dll

302
00:16:31,600 --> 00:16:36,480
uh the computer was infected and uh

303
00:16:36,480 --> 00:16:40,959
attackers get control on it

304
00:16:41,120 --> 00:16:45,759
this sample have has

305
00:16:46,800 --> 00:16:49,360
much capabilities many capabilities it

306
00:16:49,360 --> 00:16:50,320
can hide

307
00:16:50,320 --> 00:16:54,079
files on fast32 many usb sticks as i

308
00:16:54,079 --> 00:16:54,720
know

309
00:16:54,720 --> 00:16:57,199
as you know formatted in this file

310
00:16:57,199 --> 00:16:58,320
system

311
00:16:58,320 --> 00:17:01,440
uh via editing of file systems

312
00:17:01,440 --> 00:17:05,280
uh data structures um it

313
00:17:05,280 --> 00:17:08,400
sets uncommon

314
00:17:08,400 --> 00:17:11,599
uh combination of file attributes to the

315
00:17:11,599 --> 00:17:14,480
data structure of its files uh which

316
00:17:14,480 --> 00:17:16,720
will uh

317
00:17:16,720 --> 00:17:19,760
need be hidden uh and

318
00:17:19,760 --> 00:17:23,359
uh operation system uh didn't

319
00:17:23,359 --> 00:17:26,559
uh show these files or

320
00:17:26,559 --> 00:17:29,600
um didn't show these files

321
00:17:29,600 --> 00:17:34,400
or on the flash on the usb sticks

322
00:17:34,400 --> 00:17:36,880
it this malware can deliver data and

323
00:17:36,880 --> 00:17:38,240
files to and from

324
00:17:38,240 --> 00:17:41,360
air gaped systems uh

325
00:17:41,360 --> 00:17:44,280
it it can receive an additional

326
00:17:44,280 --> 00:17:47,280
executable

327
00:17:47,760 --> 00:17:51,039
and run it

328
00:17:51,840 --> 00:17:57,120
so okay i read in chat

329
00:17:57,520 --> 00:18:00,960
to and from air gap systems and it can

330
00:18:00,960 --> 00:18:03,600
receive an additional executable

331
00:18:03,600 --> 00:18:06,880
and command and run it in

332
00:18:06,880 --> 00:18:10,000
air gap system and send

333
00:18:10,000 --> 00:18:13,440
results of execution to

334
00:18:13,440 --> 00:18:16,640
the computer which uh

335
00:18:16,640 --> 00:18:20,160
is controlled by attackers uh the number

336
00:18:20,160 --> 00:18:22,880
of intermediate computers in the airgap

337
00:18:22,880 --> 00:18:27,120
network doesn't matter it it means that

338
00:18:27,120 --> 00:18:30,400
it use as many hopes in

339
00:18:30,400 --> 00:18:34,000
uh chain of computers uh

340
00:18:34,000 --> 00:18:37,919
as attackers need to to

341
00:18:37,919 --> 00:18:41,120
to go to interesting computer it

342
00:18:41,120 --> 00:18:44,480
can hold three or more uh hopes uh

343
00:18:44,480 --> 00:18:48,240
to to go there

344
00:18:48,240 --> 00:18:52,160
uh and the last um case which

345
00:18:52,160 --> 00:18:56,240
i want to show you um

346
00:18:56,240 --> 00:19:00,320
when we investigate uh one of uh

347
00:19:00,320 --> 00:19:03,600
the case we found a keyboard spy lock uh

348
00:19:03,600 --> 00:19:03,919
by

349
00:19:03,919 --> 00:19:06,960
uh which was made by plugix

350
00:19:06,960 --> 00:19:11,360
and we have no loader and payload

351
00:19:11,360 --> 00:19:14,000
uh because they were deleted by

352
00:19:14,000 --> 00:19:15,440
antivirus

353
00:19:15,440 --> 00:19:18,320
more than a year ago and we haven't

354
00:19:18,320 --> 00:19:19,600
[Music]

355
00:19:19,600 --> 00:19:23,280
the code which creates this

356
00:19:23,280 --> 00:19:26,559
keyboard spyroc and

357
00:19:26,559 --> 00:19:29,919
we can't analyze it and

358
00:19:29,919 --> 00:19:33,679
find out the methods to decrypt

359
00:19:33,679 --> 00:19:36,880
this log file but

360
00:19:36,880 --> 00:19:40,000
we have some decryption scripts uh

361
00:19:40,000 --> 00:19:43,679
uh that couldn't decrypt lock

362
00:19:43,679 --> 00:19:47,679
uh but this scripts uh can

363
00:19:47,679 --> 00:19:50,960
can understood format uh it can

364
00:19:50,960 --> 00:19:54,320
um understood uh length of

365
00:19:54,320 --> 00:19:57,760
uh records in this file and uh

366
00:19:57,760 --> 00:20:01,760
extract keys for each um

367
00:20:01,760 --> 00:20:04,799
for each record

368
00:20:05,120 --> 00:20:08,159
plugins use um different keys for for

369
00:20:08,159 --> 00:20:09,360
each record

370
00:20:09,360 --> 00:20:12,720
and uh we need to decrypt it and

371
00:20:12,720 --> 00:20:16,480
we try to uh make the the scheme

372
00:20:16,480 --> 00:20:20,880
uh we we look at uh uncommon log file

373
00:20:20,880 --> 00:20:21,679
name

374
00:20:21,679 --> 00:20:24,880
uh and we try to guess that it was

375
00:20:24,880 --> 00:20:28,000
uh custom plugins version uh

376
00:20:28,000 --> 00:20:31,919
we tried to uh find uh on virus total

377
00:20:31,919 --> 00:20:33,200
intelligence

378
00:20:33,200 --> 00:20:36,720
tried to bundle files and found

379
00:20:36,720 --> 00:20:40,159
loader of malware but a loader

380
00:20:40,159 --> 00:20:42,799
doesn't contain a loader in plugins

381
00:20:42,799 --> 00:20:45,120
doesn't contain

382
00:20:45,120 --> 00:20:48,159
the code which creates a keyboard

383
00:20:48,159 --> 00:20:53,440
lock and the login didn't contain

384
00:20:53,440 --> 00:20:57,120
the code which encrypts it we haven't

385
00:20:57,120 --> 00:21:01,760
found a payload when we

386
00:21:01,760 --> 00:21:05,039
tried to search by loaders hash

387
00:21:05,039 --> 00:21:08,880
on free analysis services we found

388
00:21:08,880 --> 00:21:12,000
some payload which

389
00:21:12,000 --> 00:21:15,280
bonded to the hash which we found

390
00:21:15,280 --> 00:21:18,880
and we found pilot uh we analyzed

391
00:21:18,880 --> 00:21:20,000
payload

392
00:21:20,000 --> 00:21:23,039
and gives decryption algorithm

393
00:21:23,039 --> 00:21:26,400
and uh successfully uh decrypted

394
00:21:26,400 --> 00:21:29,440
log file and uh when we

395
00:21:29,440 --> 00:21:32,799
decrypted it we found exact date of

396
00:21:32,799 --> 00:21:36,240
infection because of a date of uh

397
00:21:36,240 --> 00:21:40,159
the first record in this log file

398
00:21:40,159 --> 00:21:44,000
uh compromised information uh we

399
00:21:44,000 --> 00:21:47,280
found information that was stored

400
00:21:47,280 --> 00:21:50,480
stolen that was

401
00:21:50,480 --> 00:21:53,840
included in this log file relation to

402
00:21:53,840 --> 00:21:57,679
another incident because we found

403
00:21:57,679 --> 00:22:00,400
another incident which happens at the

404
00:22:00,400 --> 00:22:02,480
same period of dates

405
00:22:02,480 --> 00:22:05,679
and possible emails of attackers we

406
00:22:05,679 --> 00:22:06,240
found

407
00:22:06,240 --> 00:22:09,360
because attackers

408
00:22:09,360 --> 00:22:12,400
asked to ask ask a victim

409
00:22:12,400 --> 00:22:16,000
to confirm receiving of this mail

410
00:22:16,000 --> 00:22:19,440
and our victim confirmed

411
00:22:19,440 --> 00:22:22,559
but it confirmed

412
00:22:22,559 --> 00:22:27,039
it when uh keep keylogger uh

413
00:22:27,039 --> 00:22:32,080
was running and keylogger logs

414
00:22:32,080 --> 00:22:35,520
this mail and so it locks uh

415
00:22:35,520 --> 00:22:40,240
every part of the form of my

416
00:22:40,240 --> 00:22:44,240
email client and

417
00:22:44,480 --> 00:22:48,880
it locked attacker's email

418
00:22:48,880 --> 00:22:51,919
and we found attackers email so

419
00:22:51,919 --> 00:22:55,360
it's everything i as i want to

420
00:22:55,360 --> 00:22:58,320
tell about and if you have questions i

421
00:22:58,320 --> 00:22:59,520
try to

422
00:22:59,520 --> 00:23:03,280
answer it thank you

423
00:23:04,320 --> 00:23:07,360
okay thank you oleg for an interesting

424
00:23:07,360 --> 00:23:09,360
talk i don't see any questions in the q

425
00:23:09,360 --> 00:23:10,720
a right now so

426
00:23:10,720 --> 00:23:12,000
are there any questions by the

427
00:23:12,000 --> 00:23:14,320
participants if so please

428
00:23:14,320 --> 00:23:18,000
add them to the q and a i i have one so

429
00:23:18,000 --> 00:23:21,200
the the first question will be in in all

430
00:23:21,200 --> 00:23:23,039
of these events do you see

431
00:23:23,039 --> 00:23:25,200
is it always against kind of the same

432
00:23:25,200 --> 00:23:27,039
types of victims

433
00:23:27,039 --> 00:23:30,320
and kind of the second related one

434
00:23:30,320 --> 00:23:33,600
could you find some form of attribution

435
00:23:33,600 --> 00:23:34,720
is it always kind of

436
00:23:34,720 --> 00:23:37,200
the same group that you feel is behind

437
00:23:37,200 --> 00:23:39,360
it

438
00:23:42,720 --> 00:23:46,240
as a type of victim

439
00:23:46,240 --> 00:23:49,919
i can talk about it it is a government

440
00:23:49,919 --> 00:23:50,559
sector

441
00:23:50,559 --> 00:23:53,840
uh and uh some organization

442
00:23:53,840 --> 00:23:56,560
in government sector uh because

443
00:23:56,560 --> 00:23:59,520
[Music]

444
00:23:59,520 --> 00:24:01,760
as

445
00:24:02,640 --> 00:24:05,679
this you can see uh as it can

446
00:24:05,679 --> 00:24:09,120
say by attribution of this attack now i

447
00:24:09,120 --> 00:24:12,799
i don't know uh with which

448
00:24:12,799 --> 00:24:16,880
um group it can be attributed but

449
00:24:16,880 --> 00:24:21,600
uh as i said before uh

450
00:24:21,600 --> 00:24:25,039
the two was uh plugix and uh

451
00:24:25,039 --> 00:24:28,400
as you know uh geeks may be attributed

452
00:24:28,400 --> 00:24:29,279
to

453
00:24:29,279 --> 00:24:32,400
the one big country

454
00:24:32,400 --> 00:24:35,600
at the east of

455
00:24:35,600 --> 00:24:39,279
us many many

456
00:24:39,279 --> 00:24:43,440
sources talk about plagueis attribution

457
00:24:43,440 --> 00:24:46,960
as a chinese

458
00:24:46,960 --> 00:24:50,000
but i can't confirm it okay and

459
00:24:50,000 --> 00:24:52,080
obviously it's always hard for

460
00:24:52,080 --> 00:24:54,880
force technical people to to really do

461
00:24:54,880 --> 00:24:57,200
attribution it was more in terms of a

462
00:24:57,200 --> 00:25:00,159
commonality yeah i think it was a really

463
00:25:00,159 --> 00:25:01,279
interesting talk

464
00:25:01,279 --> 00:25:03,760
i appreciate that a lot any questions

465
00:25:03,760 --> 00:25:06,080
last chance

466
00:25:06,080 --> 00:25:09,360
if not olek thanks a lot and uh all the

467
00:25:09,360 --> 00:25:10,400
best you in

468
00:25:10,400 --> 00:25:14,000
far away in yeah kazakhstan

469
00:25:14,000 --> 00:25:16,799
have a one question what indicators of

470
00:25:16,799 --> 00:25:18,080
compromise

471
00:25:18,080 --> 00:25:21,360
uh which

472
00:25:21,360 --> 00:25:25,200
case do you mean catch

473
00:25:25,200 --> 00:25:28,960
uh i could say uh

474
00:25:28,960 --> 00:25:32,960
i can i i i think you can um

475
00:25:32,960 --> 00:25:36,320
send your question in um

476
00:25:36,320 --> 00:25:39,840
on my mail and if we can uh

477
00:25:39,840 --> 00:25:42,400
answer it we will answer i think that's

478
00:25:42,400 --> 00:25:43,440
good so yeah

479
00:25:43,440 --> 00:25:46,480
okay thank you search thank you

480
00:25:46,480 --> 00:25:49,120
thank you thanks crazy thanks to all the

481
00:25:49,120 --> 00:25:50,799
audience bye bye

482
00:25:50,799 --> 00:25:53,679
bye thanks

