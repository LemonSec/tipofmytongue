1
00:00:01,520 --> 00:00:03,360
if you are using the event app we

2
00:00:03,360 --> 00:00:05,040
encourage you to check into the session

3
00:00:05,040 --> 00:00:06,879
update your activities and be sure to

4
00:00:06,879 --> 00:00:09,679
complete the session survey at the end

5
00:00:09,679 --> 00:00:12,320
this session is tlp white and is being

6
00:00:12,320 --> 00:00:13,519
recorded

7
00:00:13,519 --> 00:00:15,759
recordings will be available within 24

8
00:00:15,759 --> 00:00:17,440
hours via the app

9
00:00:17,440 --> 00:00:19,039
and with that i would like to introduce

10
00:00:19,039 --> 00:00:20,800
you to your session moderator

11
00:00:20,800 --> 00:00:23,760
olivia califf thank you and please take

12
00:00:23,760 --> 00:00:25,680
it away olivier

13
00:00:25,680 --> 00:00:27,920
hello all of you virtual attendees so

14
00:00:27,920 --> 00:00:29,920
i'm olivier kalef i'll be moting this

15
00:00:29,920 --> 00:00:31,359
session today

16
00:00:31,359 --> 00:00:33,520
i'm a first liaison and i now work for

17
00:00:33,520 --> 00:00:34,480
sanofi

18
00:00:34,480 --> 00:00:36,719
a global health and pharmaceutical

19
00:00:36,719 --> 00:00:39,280
company and i was part of the 2020

20
00:00:39,280 --> 00:00:40,399
program conference

21
00:00:40,399 --> 00:00:43,840
committee question answer will be at the

22
00:00:43,840 --> 00:00:45,760
end of the talk so feel free to

23
00:00:45,760 --> 00:00:48,719
submit your your questions using the q a

24
00:00:48,719 --> 00:00:49,520
um

25
00:00:49,520 --> 00:00:51,680
feature which is at the bottom of your

26
00:00:51,680 --> 00:00:52,800
zoom browser

27
00:00:52,800 --> 00:00:54,320
and with that let's go ahead and get

28
00:00:54,320 --> 00:00:56,640
started so i'm happy to introduce this

29
00:00:56,640 --> 00:00:57,760
rotation by

30
00:00:57,760 --> 00:00:59,920
yukaitan who is a senior incident

31
00:00:59,920 --> 00:01:01,760
responder at gojek

32
00:01:01,760 --> 00:01:03,760
prior he's to that he has been spending

33
00:01:03,760 --> 00:01:05,600
one year at vmware and a five

34
00:01:05,600 --> 00:01:09,119
year at the singapore government agency

35
00:01:09,119 --> 00:01:11,280
performing computer forensics and

36
00:01:11,280 --> 00:01:13,119
incident response

37
00:01:13,119 --> 00:01:16,560
and he's also been releasing a few

38
00:01:16,560 --> 00:01:18,799
open source tools as you can see in his

39
00:01:18,799 --> 00:01:20,080
online bio

40
00:01:20,080 --> 00:01:23,920
so with that mr tan the floor is yours

41
00:01:23,920 --> 00:01:25,680
thank you olivier for the introduction

42
00:01:25,680 --> 00:01:29,200
so i'll start by sharing my screen

43
00:01:31,520 --> 00:01:33,759
so hi everybody uh thank you for joining

44
00:01:33,759 --> 00:01:35,040
me in this session

45
00:01:35,040 --> 00:01:37,200
has idiom made host forensic artifact

46
00:01:37,200 --> 00:01:38,880
analysis obsolete

47
00:01:38,880 --> 00:01:40,799
and how to combine them effectively for

48
00:01:40,799 --> 00:01:42,159
investigations

49
00:01:42,159 --> 00:01:44,000
so my name is yukai i'm currently a

50
00:01:44,000 --> 00:01:46,320
senior incident responder at kojec

51
00:01:46,320 --> 00:01:47,840
so for those that are not familiar with

52
00:01:47,840 --> 00:01:49,759
this company you can think of it as the

53
00:01:49,759 --> 00:01:50,799
southeast asia

54
00:01:50,799 --> 00:01:55,840
equivalent of uber

55
00:01:56,000 --> 00:01:59,280
so as introduced by olivia um i've spent

56
00:01:59,280 --> 00:02:01,600
six years in dfir with five years in a

57
00:02:01,600 --> 00:02:03,759
public sector and a government agency in

58
00:02:03,759 --> 00:02:04,560
singapore

59
00:02:04,560 --> 00:02:06,399
it was followed by one year at vmware

60
00:02:06,399 --> 00:02:08,000
and then currently at google jack

61
00:02:08,000 --> 00:02:09,440
i'm also the author of the following

62
00:02:09,440 --> 00:02:11,280
forensic tools that you may or may not

63
00:02:11,280 --> 00:02:13,599
be familiar with

64
00:02:13,599 --> 00:02:15,200
my contact information is on the right

65
00:02:15,200 --> 00:02:16,640
hand side of the slide

66
00:02:16,640 --> 00:02:18,319
so you can contact me either via

67
00:02:18,319 --> 00:02:23,040
linkedin twitter or github

68
00:02:23,040 --> 00:02:25,280
so the agenda for this session today is

69
00:02:25,280 --> 00:02:26,319
as follows

70
00:02:26,319 --> 00:02:28,400
what i'm referring to by host phones and

71
00:02:28,400 --> 00:02:30,160
artifacts and what are its

72
00:02:30,160 --> 00:02:32,400
issues this is followed by a short

73
00:02:32,400 --> 00:02:34,239
introduction of edrs or endpoint

74
00:02:34,239 --> 00:02:37,200
detection and response and its issues

75
00:02:37,200 --> 00:02:39,040
then i will summarize the issues that i

76
00:02:39,040 --> 00:02:40,480
raised with both of them

77
00:02:40,480 --> 00:02:43,280
and discuss why we need to combine them

78
00:02:43,280 --> 00:02:44,480
next i'll be going through a few

79
00:02:44,480 --> 00:02:46,560
scenarios that shows how to combine both

80
00:02:46,560 --> 00:02:47,040
of them

81
00:02:47,040 --> 00:02:50,080
for investigations and lastly i'll be

82
00:02:50,080 --> 00:02:51,680
introducing two tools

83
00:02:51,680 --> 00:02:53,519
the first to collect host forensic

84
00:02:53,519 --> 00:02:54,959
artifacts at scale

85
00:02:54,959 --> 00:02:56,879
and the second to track changes in

86
00:02:56,879 --> 00:02:58,000
windows event logs

87
00:02:58,000 --> 00:03:02,159
over different windows versions

88
00:03:03,599 --> 00:03:05,440
so what are host phones and artifacts

89
00:03:05,440 --> 00:03:07,040
you can think of it simply as

90
00:03:07,040 --> 00:03:09,040
foreign artifacts that you find on hosts

91
00:03:09,040 --> 00:03:11,040
or endpoints

92
00:03:11,040 --> 00:03:13,519
for example for evidence or execution

93
00:03:13,519 --> 00:03:15,360
for windows you have mcash and app

94
00:03:15,360 --> 00:03:16,480
compact cache

95
00:03:16,480 --> 00:03:18,560
also known as stream cache and for mac

96
00:03:18,560 --> 00:03:20,159
os you have knowledge c

97
00:03:20,159 --> 00:03:22,480
database there are also many other types

98
00:03:22,480 --> 00:03:25,360
of artifacts like windows registry hives

99
00:03:25,360 --> 00:03:28,080
your various p links and mac os windows

100
00:03:28,080 --> 00:03:29,040
event logs

101
00:03:29,040 --> 00:03:33,840
apple unified logs and many others

102
00:03:34,159 --> 00:03:36,000
so one of the issues with the analysis

103
00:03:36,000 --> 00:03:37,760
of these artifacts or the main problem

104
00:03:37,760 --> 00:03:39,599
statement of this presentation is that

105
00:03:39,599 --> 00:03:41,040
the availability

106
00:03:41,040 --> 00:03:43,360
the value to investigations and the

107
00:03:43,360 --> 00:03:45,760
structure of host forensic artifacts

108
00:03:45,760 --> 00:03:47,599
can differ over the different versions

109
00:03:47,599 --> 00:03:50,640
of the operating system

110
00:03:50,799 --> 00:03:53,280
so the first example that i'm going to

111
00:03:53,280 --> 00:03:53,840
use is

112
00:03:53,840 --> 00:03:56,239
uncache for windows so amp cache as you

113
00:03:56,239 --> 00:03:58,159
know consists of various files

114
00:03:58,159 --> 00:04:01,280
and the availability of this files can

115
00:04:01,280 --> 00:04:03,120
differ drastically over different

116
00:04:03,120 --> 00:04:04,480
windows versions

117
00:04:04,480 --> 00:04:07,040
as you can see in this table however

118
00:04:07,040 --> 00:04:08,799
this table is just scratching a surface

119
00:04:08,799 --> 00:04:10,720
because it's value to investigation as

120
00:04:10,720 --> 00:04:12,879
well as its structure also changes

121
00:04:12,879 --> 00:04:14,879
so for more details you can refer to the

122
00:04:14,879 --> 00:04:17,918
reference in this slide

123
00:04:17,918 --> 00:04:20,160
another example on windows is add combat

124
00:04:20,160 --> 00:04:21,279
cache

125
00:04:21,279 --> 00:04:23,199
this table shows that its value and

126
00:04:23,199 --> 00:04:24,960
structure also changes across the

127
00:04:24,960 --> 00:04:27,759
different windows versions

128
00:04:27,759 --> 00:04:30,000
of note is that the execution flag was

129
00:04:30,000 --> 00:04:31,440
removed in windows 10

130
00:04:31,440 --> 00:04:33,280
so we are now no longer able to

131
00:04:33,280 --> 00:04:35,360
determine whether an application

132
00:04:35,360 --> 00:04:36,960
that was referenced by the app compat

133
00:04:36,960 --> 00:04:42,880
cache entry has executed on the system

134
00:04:42,880 --> 00:04:45,280
so the last example is for mac os

135
00:04:45,280 --> 00:04:46,960
unified logs

136
00:04:46,960 --> 00:04:49,120
so it has replaced system.log and apple

137
00:04:49,120 --> 00:04:50,560
system logs

138
00:04:50,560 --> 00:04:52,720
and was introduced in mac os 10 control

139
00:04:52,720 --> 00:04:54,240
serra

140
00:04:54,240 --> 00:04:56,000
so the number of fields available for

141
00:04:56,000 --> 00:04:57,600
use within long entries

142
00:04:57,600 --> 00:04:59,280
since its introduction has increased

143
00:04:59,280 --> 00:05:01,039
from 16 incera

144
00:05:01,039 --> 00:05:04,479
to 22 in high sierra to 27 more

145
00:05:04,479 --> 00:05:06,400
fortunately this increase has remained

146
00:05:06,400 --> 00:05:08,000
constant or has stopped

147
00:05:08,000 --> 00:05:10,720
because in catalina is still at 27 and

148
00:05:10,720 --> 00:05:12,960
typically when we are analyzing unifor

149
00:05:12,960 --> 00:05:15,520
unified locks we are focusing on four

150
00:05:15,520 --> 00:05:16,240
fields

151
00:05:16,240 --> 00:05:18,800
time stem process category and the

152
00:05:18,800 --> 00:05:19,680
message field

153
00:05:19,680 --> 00:05:21,199
and they are all available in the

154
00:05:21,199 --> 00:05:25,840
different versions of the unified logs

155
00:05:26,479 --> 00:05:28,880
so why do these artifacts change the

156
00:05:28,880 --> 00:05:30,240
obvious reason is that they are not

157
00:05:30,240 --> 00:05:32,560
created for forensic investigations

158
00:05:32,560 --> 00:05:34,400
they are typically a by-product os

159
00:05:34,400 --> 00:05:36,560
features take for example app compact

160
00:05:36,560 --> 00:05:37,600
cache

161
00:05:37,600 --> 00:05:39,199
is associated with the microsoft

162
00:05:39,199 --> 00:05:42,240
application compatibility infrastructure

163
00:05:42,240 --> 00:05:44,039
and its purpose is to enable the

164
00:05:44,039 --> 00:05:45,440
compatibility of

165
00:05:45,440 --> 00:05:47,280
existing software between the different

166
00:05:47,280 --> 00:05:50,400
versions of the windows os

167
00:05:50,400 --> 00:05:52,479
it does this by tracking the metadata of

168
00:05:52,479 --> 00:05:54,479
the binary that was executed with create

169
00:05:54,479 --> 00:05:55,840
process api

170
00:05:55,840 --> 00:05:57,600
and this metadata is the forensic

171
00:05:57,600 --> 00:05:59,520
artifact that we rely on during our

172
00:05:59,520 --> 00:06:01,919
investigations

173
00:06:01,919 --> 00:06:04,639
another reason for the change is because

174
00:06:04,639 --> 00:06:06,160
the artifact artifacts change as the

175
00:06:06,160 --> 00:06:06,720
features

176
00:06:06,720 --> 00:06:08,560
that they depend on or they are based on

177
00:06:08,560 --> 00:06:10,880
has changed example will be apple system

178
00:06:10,880 --> 00:06:13,120
logs transitioning to unified logs

179
00:06:13,120 --> 00:06:14,880
because apple wanted a single logging

180
00:06:14,880 --> 00:06:17,120
mechanism for user and kernel mode

181
00:06:17,120 --> 00:06:20,639
where they had asl and bsm audit logs

182
00:06:20,639 --> 00:06:21,039
for

183
00:06:21,039 --> 00:06:23,759
each respectively previously they also

184
00:06:23,759 --> 00:06:25,759
wanted a common logging system across a

185
00:06:25,759 --> 00:06:27,039
different apple os

186
00:06:27,039 --> 00:06:31,120
like ios tv os ipad os etc

187
00:06:31,120 --> 00:06:32,560
they also wanted to integrate

188
00:06:32,560 --> 00:06:34,479
compression and privacy features

189
00:06:34,479 --> 00:06:38,080
into the logging system itself

190
00:06:40,080 --> 00:06:42,240
so constantly changing artifacts can be

191
00:06:42,240 --> 00:06:44,560
associated with major feature updates of

192
00:06:44,560 --> 00:06:46,080
operating systems

193
00:06:46,080 --> 00:06:48,080
for windows that comes twice a year

194
00:06:48,080 --> 00:06:51,120
iphone mac os that comes once a year

195
00:06:51,120 --> 00:06:52,720
as a result analysts have to

196
00:06:52,720 --> 00:06:54,479
continuously play catch up

197
00:06:54,479 --> 00:06:56,479
they have to constantly research and

198
00:06:56,479 --> 00:06:58,400
keep up with the artifacts changes

199
00:06:58,400 --> 00:07:00,080
they also have to validate and compare

200
00:07:00,080 --> 00:07:02,160
the past output of different tools to

201
00:07:02,160 --> 00:07:03,840
ensure that these tools support the

202
00:07:03,840 --> 00:07:05,759
latest version of the artifacts

203
00:07:05,759 --> 00:07:07,039
to ensure accuracy in their

204
00:07:07,039 --> 00:07:09,360
investigations

205
00:07:09,360 --> 00:07:11,919
all this takes valuable time away from

206
00:07:11,919 --> 00:07:14,840
their core job of performing

207
00:07:14,840 --> 00:07:17,840
investigations

208
00:07:18,000 --> 00:07:20,000
so with the limitation of host onesie

209
00:07:20,000 --> 00:07:22,080
artifacts the question is can we rely

210
00:07:22,080 --> 00:07:24,639
solely on edrs to perform investigations

211
00:07:24,639 --> 00:07:25,440
instead

212
00:07:25,440 --> 00:07:28,000
so we before we go into that a short

213
00:07:28,000 --> 00:07:29,599
introduction of edrs

214
00:07:29,599 --> 00:07:31,520
is that his previously endpoint threat

215
00:07:31,520 --> 00:07:34,000
detection and response etdr with the

216
00:07:34,000 --> 00:07:35,120
extra t

217
00:07:35,120 --> 00:07:37,280
was a term coined by dr enter chewbacca

218
00:07:37,280 --> 00:07:38,639
in 2013

219
00:07:38,639 --> 00:07:40,479
where endpoint was as opposed to just

220
00:07:40,479 --> 00:07:43,120
network fed as opposed to just malware

221
00:07:43,120 --> 00:07:44,400
and was

222
00:07:44,400 --> 00:07:46,319
primarily used for detection and

223
00:07:46,319 --> 00:07:48,240
response

224
00:07:48,240 --> 00:07:50,080
it was subsequently renamed to endpoint

225
00:07:50,080 --> 00:07:52,639
detection and response in 2015

226
00:07:52,639 --> 00:07:54,960
and its focus remains the same primarily

227
00:07:54,960 --> 00:07:56,080
on investigations

228
00:07:56,080 --> 00:07:57,840
and less focus on full disk image

229
00:07:57,840 --> 00:07:59,759
acquisition and analysis

230
00:07:59,759 --> 00:08:01,680
than you typically associate with

231
00:08:01,680 --> 00:08:05,440
traditional computer forensics

232
00:08:06,240 --> 00:08:07,840
there are many edr solutions in the

233
00:08:07,840 --> 00:08:09,919
market and which brings suitable unique

234
00:08:09,919 --> 00:08:10,720
features

235
00:08:10,720 --> 00:08:12,560
for example the cooling or endpoints

236
00:08:12,560 --> 00:08:14,400
using os query that you see in carbon

237
00:08:14,400 --> 00:08:15,039
black

238
00:08:15,039 --> 00:08:18,400
mixture and ev using machine learning

239
00:08:18,400 --> 00:08:21,280
asset discovery features vulnerability

240
00:08:21,280 --> 00:08:24,000
detection management features

241
00:08:24,000 --> 00:08:25,919
because we do not want to go into every

242
00:08:25,919 --> 00:08:28,319
single feature of every edr solution out

243
00:08:28,319 --> 00:08:28,960
there

244
00:08:28,960 --> 00:08:30,800
the scope of this presentation is

245
00:08:30,800 --> 00:08:33,200
restricted to features that are common

246
00:08:33,200 --> 00:08:34,958
in most edr solutions

247
00:08:34,958 --> 00:08:37,120
and there will be event telemetry and

248
00:08:37,120 --> 00:08:41,679
remote response

249
00:08:41,679 --> 00:08:43,679
so for event telemetry refers to the

250
00:08:43,679 --> 00:08:45,440
feature that records all events

251
00:08:45,440 --> 00:08:47,120
happening on the endpoint such as the

252
00:08:47,120 --> 00:08:48,880
process executions

253
00:08:48,880 --> 00:08:50,800
registry modifications and network

254
00:08:50,800 --> 00:08:52,880
connections

255
00:08:52,880 --> 00:08:54,480
this collected events are typically

256
00:08:54,480 --> 00:08:56,480
analyzed in real time and only in a

257
00:08:56,480 --> 00:08:57,120
cloud

258
00:08:57,120 --> 00:08:59,600
for detection and prevention they are

259
00:08:59,600 --> 00:09:01,040
also stored in a searchable they are

260
00:09:01,040 --> 00:09:02,880
stored for the energies to review and to

261
00:09:02,880 --> 00:09:04,560
track hard

262
00:09:04,560 --> 00:09:06,240
you can think of event telemetry as

263
00:09:06,240 --> 00:09:08,080
unfiltered data and carbon black

264
00:09:08,080 --> 00:09:10,320
endpoint activity monitoring crosstrack

265
00:09:10,320 --> 00:09:11,680
or deep visibility or

266
00:09:11,680 --> 00:09:14,000
center on one so others three are adr

267
00:09:14,000 --> 00:09:16,560
solutions

268
00:09:17,120 --> 00:09:19,920
for remote response it's a feature that

269
00:09:19,920 --> 00:09:21,600
enables the investigation and

270
00:09:21,600 --> 00:09:23,519
remediation of threats in real time

271
00:09:23,519 --> 00:09:24,480
remotely

272
00:09:24,480 --> 00:09:26,320
so the benefits include enhanced

273
00:09:26,320 --> 00:09:28,240
visibility to systems across the

274
00:09:28,240 --> 00:09:29,360
enterprise

275
00:09:29,360 --> 00:09:31,279
and it also reduces the time required to

276
00:09:31,279 --> 00:09:32,720
respond to threats

277
00:09:32,720 --> 00:09:35,040
as analysts no longer require physical

278
00:09:35,040 --> 00:09:35,839
access to

279
00:09:35,839 --> 00:09:39,680
infected systems to remediate threats

280
00:09:39,680 --> 00:09:41,519
the capabilities can be divided into

281
00:09:41,519 --> 00:09:43,279
three parts firstly the collection of

282
00:09:43,279 --> 00:09:44,000
information

283
00:09:44,000 --> 00:09:45,600
that includes the exploring of file

284
00:09:45,600 --> 00:09:47,600
system extracting files

285
00:09:47,600 --> 00:09:50,080
and listing running processes the second

286
00:09:50,080 --> 00:09:52,399
the execution of scripts such as partial

287
00:09:52,399 --> 00:09:54,880
shell scripts that enable the execution

288
00:09:54,880 --> 00:09:57,600
of multiple commands

289
00:09:57,600 --> 00:10:00,640
the last is remediation of threats

290
00:10:00,640 --> 00:10:02,959
which includes deleting a malicious file

291
00:10:02,959 --> 00:10:04,800
or killing a malicious process or

292
00:10:04,800 --> 00:10:08,320
deleting a malicious registry key

293
00:10:08,320 --> 00:10:10,000
so we can take our remote response as

294
00:10:10,000 --> 00:10:11,839
equivalent to life response feature and

295
00:10:11,839 --> 00:10:12,800
complex

296
00:10:12,800 --> 00:10:15,040
built-in response on rtr and crowdstrike

297
00:10:15,040 --> 00:10:19,839
or full remote shell and sentinel1

298
00:10:20,320 --> 00:10:22,160
unfortunately edrs also has its

299
00:10:22,160 --> 00:10:24,160
limitations and

300
00:10:24,160 --> 00:10:26,560
this the first is the limited retention

301
00:10:26,560 --> 00:10:28,399
of event telemetry due to the high

302
00:10:28,399 --> 00:10:30,480
volume events being collected

303
00:10:30,480 --> 00:10:32,240
so each endpoint can generate hundreds

304
00:10:32,240 --> 00:10:34,079
of megabytes per day and this becomes

305
00:10:34,079 --> 00:10:35,760
especially significant for companies

306
00:10:35,760 --> 00:10:38,079
with many employees

307
00:10:38,079 --> 00:10:41,360
if forwarded to a sim then the decision

308
00:10:41,360 --> 00:10:42,000
has to be

309
00:10:42,000 --> 00:10:44,320
on whether to drop less important event

310
00:10:44,320 --> 00:10:45,200
types

311
00:10:45,200 --> 00:10:47,360
that sacrifices contextual information

312
00:10:47,360 --> 00:10:48,959
during investigations

313
00:10:48,959 --> 00:10:50,959
for higher retention of more important

314
00:10:50,959 --> 00:10:53,120
event types like for example process

315
00:10:53,120 --> 00:10:55,360
execution

316
00:10:55,360 --> 00:10:57,440
with limited retention analysts will not

317
00:10:57,440 --> 00:10:59,440
be able to query or hunt for relevant

318
00:10:59,440 --> 00:11:00,079
events

319
00:11:00,079 --> 00:11:02,160
to investigations that happen too far

320
00:11:02,160 --> 00:11:04,399
back

321
00:11:06,320 --> 00:11:09,680
another limitation on edrs is coverage

322
00:11:09,680 --> 00:11:11,600
this can be divided into two parts event

323
00:11:11,600 --> 00:11:14,399
coverage and device coverage firstly for

324
00:11:14,399 --> 00:11:15,519
event coverage

325
00:11:15,519 --> 00:11:17,839
different edr solutions will prioritize

326
00:11:17,839 --> 00:11:20,000
different event types to record

327
00:11:20,000 --> 00:11:22,240
so while most of them can agree that

328
00:11:22,240 --> 00:11:23,600
processed executions

329
00:11:23,600 --> 00:11:25,440
magic stream modifications network

330
00:11:25,440 --> 00:11:27,600
connections are important event types

331
00:11:27,600 --> 00:11:29,760
that should be recorded there are also

332
00:11:29,760 --> 00:11:31,680
other event types that only recorded in

333
00:11:31,680 --> 00:11:33,519
specific adr solutions

334
00:11:33,519 --> 00:11:35,760
for example network traffic size browser

335
00:11:35,760 --> 00:11:38,160
history or suspicious api calls event

336
00:11:38,160 --> 00:11:39,920
types

337
00:11:39,920 --> 00:11:41,760
so depending on the edl solution that

338
00:11:41,760 --> 00:11:44,480
has been adopted the analysts have to

339
00:11:44,480 --> 00:11:46,240
make use of post-sponsoring artifacts to

340
00:11:46,240 --> 00:11:47,839
fill in the missing gaps for

341
00:11:47,839 --> 00:11:51,440
more comprehensive investigation

342
00:11:52,399 --> 00:11:54,320
so the other part of coverage is device

343
00:11:54,320 --> 00:11:56,480
coverage so it might not be possible to

344
00:11:56,480 --> 00:11:57,519
achieve 100

345
00:11:57,519 --> 00:12:00,959
device coverage uh for eds over or

346
00:12:00,959 --> 00:12:02,240
through the enterprise

347
00:12:02,240 --> 00:12:05,040
due to many reasons for example license

348
00:12:05,040 --> 00:12:07,040
limitation where the company growth

349
00:12:07,040 --> 00:12:10,800
exits the number of licenses available

350
00:12:10,800 --> 00:12:12,639
platforms support limitations where the

351
00:12:12,639 --> 00:12:15,120
edr cannot be installed on rare versions

352
00:12:15,120 --> 00:12:16,720
of linux or older versions of the

353
00:12:16,720 --> 00:12:18,480
operating system

354
00:12:18,480 --> 00:12:20,880
company policies on deploying on mission

355
00:12:20,880 --> 00:12:22,720
critical servers when there's a fear

356
00:12:22,720 --> 00:12:23,839
that

357
00:12:23,839 --> 00:12:26,880
these agents will compete for resources

358
00:12:26,880 --> 00:12:30,000
with critical services or processes and

359
00:12:30,000 --> 00:12:30,560
also

360
00:12:30,560 --> 00:12:32,240
it might not be installed unmanaged

361
00:12:32,240 --> 00:12:36,079
devices or bring our own devices

362
00:12:37,120 --> 00:12:40,320
so if an incident were to occur on an

363
00:12:40,320 --> 00:12:42,560
endpoint if our edi agent installed

364
00:12:42,560 --> 00:12:44,160
retrospective events will not be

365
00:12:44,160 --> 00:12:45,200
available

366
00:12:45,200 --> 00:12:47,200
and anothers will have to depend on host

367
00:12:47,200 --> 00:12:50,320
forensic artifacts for

368
00:12:50,839 --> 00:12:52,959
analysis

369
00:12:52,959 --> 00:12:54,399
the last limitation that i'm going to

370
00:12:54,399 --> 00:12:56,480
touch on is the possible bypassing of

371
00:12:56,480 --> 00:12:58,320
eduos

372
00:12:58,320 --> 00:13:01,279
that impacts this availability so sophos

373
00:13:01,279 --> 00:13:03,200
actually identified two such feathers

374
00:13:03,200 --> 00:13:06,800
two such techniques used in late 2019

375
00:13:06,800 --> 00:13:10,079
and early 2020

376
00:13:10,320 --> 00:13:12,399
so the first article living off another

377
00:13:12,399 --> 00:13:14,320
land went somewhere about respondable

378
00:13:14,320 --> 00:13:15,120
driver

379
00:13:15,120 --> 00:13:17,680
to remove security software so what

380
00:13:17,680 --> 00:13:19,279
happened was that sophos observed the

381
00:13:19,279 --> 00:13:20,000
adversary

382
00:13:20,000 --> 00:13:23,200
deploying a sign a legitimate gigabyte

383
00:13:23,200 --> 00:13:25,200
driver that drops a second unsigned

384
00:13:25,200 --> 00:13:26,000
driver

385
00:13:26,000 --> 00:13:29,040
so this second driver kills

386
00:13:29,040 --> 00:13:30,959
the process and deletes files that

387
00:13:30,959 --> 00:13:32,480
belongs to the endpoint protection

388
00:13:32,480 --> 00:13:34,160
software via kernel mode

389
00:13:34,160 --> 00:13:35,839
and this enables the bypassing of the

390
00:13:35,839 --> 00:13:37,680
tempo protection of the software

391
00:13:37,680 --> 00:13:40,160
that enables the ransomware to execute

392
00:13:40,160 --> 00:13:43,279
without interference

393
00:13:44,079 --> 00:13:46,959
the second article is snatch ransomware

394
00:13:46,959 --> 00:13:49,199
reports pcs into safe mode to bypass

395
00:13:49,199 --> 00:13:50,160
protection

396
00:13:50,160 --> 00:13:51,920
so sophos observes the ransomware

397
00:13:51,920 --> 00:13:54,160
installing itself as a windows service

398
00:13:54,160 --> 00:13:56,160
adding a registry key to the battery's

399
00:13:56,160 --> 00:13:58,000
tree to ensure that inputs during safe

400
00:13:58,000 --> 00:13:58,560
mode

401
00:13:58,560 --> 00:14:00,880
then reboots the pc into safe mode so

402
00:14:00,880 --> 00:14:02,399
this technique allows you to bypass

403
00:14:02,399 --> 00:14:04,160
endpoint protection software that does

404
00:14:04,160 --> 00:14:07,519
not run in safe mode

405
00:14:09,199 --> 00:14:10,800
so with the mentioned limitations of

406
00:14:10,800 --> 00:14:13,440
both host one sec artifacts and edus

407
00:14:13,440 --> 00:14:15,120
it kind of makes sense to combine both

408
00:14:15,120 --> 00:14:16,800
of them as one tends to make up for the

409
00:14:16,800 --> 00:14:18,800
limitations of the other

410
00:14:18,800 --> 00:14:20,800
for example if an analysis is not up to

411
00:14:20,800 --> 00:14:22,800
date with the latest versions of

412
00:14:22,800 --> 00:14:24,720
evidence or execution for the same

413
00:14:24,720 --> 00:14:25,600
artifacts

414
00:14:25,600 --> 00:14:27,360
they can instead rely on the edr

415
00:14:27,360 --> 00:14:29,279
telemetry or event telemetry

416
00:14:29,279 --> 00:14:31,519
for process execution to complete the

417
00:14:31,519 --> 00:14:34,320
investigation

418
00:14:36,959 --> 00:14:38,800
another reason to combine them is the

419
00:14:38,800 --> 00:14:41,279
accelerated network paradigm shift

420
00:14:41,279 --> 00:14:44,480
due to the cool bit 19 situation

421
00:14:44,480 --> 00:14:46,240
as a result of covert nighting more

422
00:14:46,240 --> 00:14:48,079
employees are actually working remotely

423
00:14:48,079 --> 00:14:49,440
there are less employees within the

424
00:14:49,440 --> 00:14:51,920
network security parameter

425
00:14:51,920 --> 00:14:53,760
hence also less amount of employee

426
00:14:53,760 --> 00:14:55,279
traffic going through network security

427
00:14:55,279 --> 00:14:56,320
appliances

428
00:14:56,320 --> 00:14:58,560
there are also more applications files

429
00:14:58,560 --> 00:15:00,320
and data moving towards the cloud

430
00:15:00,320 --> 00:15:02,079
and more employees are assessing the

431
00:15:02,079 --> 00:15:05,760
cloud for work and productivity

432
00:15:05,760 --> 00:15:08,000
so as a result you can say that normal

433
00:15:08,000 --> 00:15:09,760
security appliances are

434
00:15:09,760 --> 00:15:12,720
bypassed and from an analyst perspective

435
00:15:12,720 --> 00:15:13,839
um

436
00:15:13,839 --> 00:15:15,519
network artifacts or network traffic

437
00:15:15,519 --> 00:15:17,920
logs are

438
00:15:17,920 --> 00:15:20,720
are not available and so we have to

439
00:15:20,720 --> 00:15:21,920
actually rely more on

440
00:15:21,920 --> 00:15:23,680
what is available at the endpoint which

441
00:15:23,680 --> 00:15:25,760
is your edr telemetry and your host

442
00:15:25,760 --> 00:15:27,120
phones and artifacts

443
00:15:27,120 --> 00:15:28,880
so it makes sense to combine them both

444
00:15:28,880 --> 00:15:32,079
to maximize what we have

445
00:15:34,880 --> 00:15:36,320
next i'll be going through a few

446
00:15:36,320 --> 00:15:38,320
scenarios that shows how to combine both

447
00:15:38,320 --> 00:15:41,440
edrs and host sponsoring artifacts for

448
00:15:41,440 --> 00:15:44,720
to facilitate investigations so the

449
00:15:44,720 --> 00:15:46,720
first scenario pertains to identifying

450
00:15:46,720 --> 00:15:48,560
the source of initial pa load

451
00:15:48,560 --> 00:15:52,240
of a drive-by download null infection

452
00:15:52,240 --> 00:15:53,360
this might not be triggered or

453
00:15:53,360 --> 00:15:55,279
determined using an egr because it might

454
00:15:55,279 --> 00:15:57,440
not record the event telemetry that you

455
00:15:57,440 --> 00:15:58,560
associate with the

456
00:15:58,560 --> 00:16:00,399
full url that was assessed by the

457
00:16:00,399 --> 00:16:03,360
browser at the end point

458
00:16:03,360 --> 00:16:05,040
this could be further complicated if the

459
00:16:05,040 --> 00:16:08,240
users use encrypted dns

460
00:16:08,240 --> 00:16:10,639
so a quick solution to this assuming

461
00:16:10,639 --> 00:16:12,079
that the file is still on this

462
00:16:12,079 --> 00:16:15,360
is to use the eds remote response

463
00:16:15,360 --> 00:16:17,360
capability to query host forensic

464
00:16:17,360 --> 00:16:18,240
artifacts

465
00:16:18,240 --> 00:16:20,079
for mac os there will be the spotlight

466
00:16:20,079 --> 00:16:23,600
metadata attribute pmd item platforms

467
00:16:23,600 --> 00:16:26,000
and for windows the zone identifier ads

468
00:16:26,000 --> 00:16:28,079
or alternate data stream

469
00:16:28,079 --> 00:16:29,680
and for both of them you can see that

470
00:16:29,680 --> 00:16:31,440
actual manager should find the source of

471
00:16:31,440 --> 00:16:32,639
the download

472
00:16:32,639 --> 00:16:34,079
the first line here as well as the

473
00:16:34,079 --> 00:16:37,839
second line here

474
00:16:38,560 --> 00:16:40,399
so the second scenario pertains to

475
00:16:40,399 --> 00:16:42,800
identifying or surfacing suspicious user

476
00:16:42,800 --> 00:16:44,160
logons and types

477
00:16:44,160 --> 00:16:46,399
again this might not be trivial to

478
00:16:46,399 --> 00:16:47,759
determine with

479
00:16:47,759 --> 00:16:50,160
edrs as many of them do not record

480
00:16:50,160 --> 00:16:53,040
authentication telemetry

481
00:16:53,040 --> 00:16:55,199
so a solution to this is again to use

482
00:16:55,199 --> 00:16:58,079
the edr's remote response capability

483
00:16:58,079 --> 00:17:00,880
to pool or collect host phones artifacts

484
00:17:00,880 --> 00:17:02,320
in this case for windows

485
00:17:02,320 --> 00:17:04,480
windows 7 logs for mac os the apple

486
00:17:04,480 --> 00:17:05,599
unified logs

487
00:17:05,599 --> 00:17:07,520
and after collecting these logs the

488
00:17:07,520 --> 00:17:08,880
analyst can

489
00:17:08,880 --> 00:17:11,199
perform filtering or perform queries to

490
00:17:11,199 --> 00:17:14,720
obtain the desired information

491
00:17:17,039 --> 00:17:18,400
the last scenario pertains to

492
00:17:18,400 --> 00:17:20,079
determining whether

493
00:17:20,079 --> 00:17:22,319
exfiltration has been performed by the

494
00:17:22,319 --> 00:17:25,039
adversary

495
00:17:25,039 --> 00:17:27,919
so uh this is again not triggered to

496
00:17:27,919 --> 00:17:29,679
determine with endpoint solutions as

497
00:17:29,679 --> 00:17:31,440
many of them while they record network

498
00:17:31,440 --> 00:17:32,400
connections

499
00:17:32,400 --> 00:17:34,320
they do not record the incoming network

500
00:17:34,320 --> 00:17:36,080
traffic size and outgoing network

501
00:17:36,080 --> 00:17:37,360
traffic size

502
00:17:37,360 --> 00:17:39,280
so this made it more difficult if you do

503
00:17:39,280 --> 00:17:41,200
not have normal artifacts available or

504
00:17:41,200 --> 00:17:44,400
network locks available

505
00:17:44,480 --> 00:17:46,559
so one solution to this is again to use

506
00:17:46,559 --> 00:17:49,280
the edr's remote response capability

507
00:17:49,280 --> 00:17:51,039
to collect host phones and artifacts in

508
00:17:51,039 --> 00:17:52,799
this case for windows the system

509
00:17:52,799 --> 00:17:54,880
resource usage monitors from

510
00:17:54,880 --> 00:17:57,919
ese database or for mac os the

511
00:17:57,919 --> 00:18:00,400
net usage sqlite database so after

512
00:18:00,400 --> 00:18:02,080
collecting these two database you can

513
00:18:02,080 --> 00:18:03,280
perform queries

514
00:18:03,280 --> 00:18:05,280
to obtain the desired information in

515
00:18:05,280 --> 00:18:07,200
this case there will be the bikes in and

516
00:18:07,200 --> 00:18:08,160
bikes out

517
00:18:08,160 --> 00:18:14,960
for each individual process

518
00:18:14,960 --> 00:18:18,080
so having established how a host for

519
00:18:18,080 --> 00:18:20,559
foreign artefacts can complement egrs to

520
00:18:20,559 --> 00:18:22,160
perform investigations

521
00:18:22,160 --> 00:18:23,600
i'd like to introduce a tool that i've

522
00:18:23,600 --> 00:18:25,200
written called box strike

523
00:18:25,200 --> 00:18:27,280
so it never reaches a remote response

524
00:18:27,280 --> 00:18:29,039
capability or etrs

525
00:18:29,039 --> 00:18:30,799
to make host phones and artifacts more

526
00:18:30,799 --> 00:18:33,200
accessible its written for crowdstrike

527
00:18:33,200 --> 00:18:35,440
hence its name but similar tools exist

528
00:18:35,440 --> 00:18:37,760
for other egos

529
00:18:37,760 --> 00:18:40,080
so it is able to simultaneously connect

530
00:18:40,080 --> 00:18:42,480
to multiple remote systems to issue

531
00:18:42,480 --> 00:18:45,440
multiple commands

532
00:18:47,120 --> 00:18:49,679
other features about strike includes the

533
00:18:49,679 --> 00:18:51,520
uploading of files and scripts to

534
00:18:51,520 --> 00:18:56,080
crosstrack cloud

535
00:18:56,080 --> 00:18:58,480
this this scripts and files can then be

536
00:18:58,480 --> 00:18:59,200
pushed

537
00:18:59,200 --> 00:19:02,000
to the endpoint for execution another

538
00:19:02,000 --> 00:19:02,559
feature

539
00:19:02,559 --> 00:19:04,320
is that it is able to kill offline

540
00:19:04,320 --> 00:19:06,320
commands

541
00:19:06,320 --> 00:19:08,000
on an offline host so that these

542
00:19:08,000 --> 00:19:09,919
commands can be executed when these

543
00:19:09,919 --> 00:19:11,760
hosts come online

544
00:19:11,760 --> 00:19:13,520
so box strike is available on my github

545
00:19:13,520 --> 00:19:15,919
repository or the link at the left-hand

546
00:19:15,919 --> 00:19:19,520
bottom hand corner of the slide

547
00:19:22,240 --> 00:19:24,160
so this slide shows the demo about

548
00:19:24,160 --> 00:19:27,360
scratch so basically it shows

549
00:19:27,360 --> 00:19:30,080
how it makes use of kit which is chrome

550
00:19:30,080 --> 00:19:31,840
artifact parser extractor where you will

551
00:19:31,840 --> 00:19:34,000
push it down to the remote endpoint

552
00:19:34,000 --> 00:19:36,160
uh to collect host sponsoring artifacts

553
00:19:36,160 --> 00:19:37,679
so in this demo it will connect to

554
00:19:37,679 --> 00:19:39,200
multiple endpoints

555
00:19:39,200 --> 00:19:42,400
and one quick tip for using kit is that

556
00:19:42,400 --> 00:19:44,720
you can remove the gui executable as

557
00:19:44,720 --> 00:19:46,320
well as the modules folder

558
00:19:46,320 --> 00:19:49,039
to reduce the total file size of kit to

559
00:19:49,039 --> 00:19:49,919
less than 10

560
00:19:49,919 --> 00:19:52,400
of its original size making it more

561
00:19:52,400 --> 00:19:54,240
bandwidth efficient to push it down to

562
00:19:54,240 --> 00:19:56,880
the endpoint

563
00:19:57,280 --> 00:19:59,039
so because of time constraints i'll not

564
00:19:59,039 --> 00:20:00,720
be playing this demo in full

565
00:20:00,720 --> 00:20:02,480
so if you are interested you can access

566
00:20:02,480 --> 00:20:07,840
it at the github repository

567
00:20:08,320 --> 00:20:10,799
so after successful execution this whole

568
00:20:10,799 --> 00:20:12,240
swansea artifacts will be uploaded

569
00:20:12,240 --> 00:20:13,440
across track cloud

570
00:20:13,440 --> 00:20:15,280
where you can actually download it to

571
00:20:15,280 --> 00:20:16,799
your system

572
00:20:16,799 --> 00:20:21,840
via the crosstrack web console

573
00:20:22,960 --> 00:20:24,960
so before moving on to the next tool um

574
00:20:24,960 --> 00:20:26,960
we need to understand how an event of an

575
00:20:26,960 --> 00:20:29,360
event lock is shown in a windows event

576
00:20:29,360 --> 00:20:32,240
viewer so when a user selects an event

577
00:20:32,240 --> 00:20:34,880
in the windows event viewer

578
00:20:34,880 --> 00:20:37,600
the event is read from the event you

579
00:20:37,600 --> 00:20:38,400
will reach the

580
00:20:38,400 --> 00:20:41,360
provider event id and event data from

581
00:20:41,360 --> 00:20:42,640
the event itself

582
00:20:42,640 --> 00:20:45,039
however this event data contains missing

583
00:20:45,039 --> 00:20:46,559
information such as the event

584
00:20:46,559 --> 00:20:47,840
description

585
00:20:47,840 --> 00:20:51,039
as well as the field names so they have

586
00:20:51,039 --> 00:20:52,880
to fill in this missing information and

587
00:20:52,880 --> 00:20:54,799
one way to do this is to query this

588
00:20:54,799 --> 00:20:57,200
registry key at the channel and provider

589
00:20:57,200 --> 00:20:58,960
which are values that it meets from the

590
00:20:58,960 --> 00:21:02,559
event as well as the event log form

591
00:21:02,559 --> 00:21:04,240
next it will read the value event

592
00:21:04,240 --> 00:21:06,320
message file to obtain the location

593
00:21:06,320 --> 00:21:10,159
of the dll that contains the

594
00:21:10,159 --> 00:21:13,840
event message this event message will

595
00:21:13,840 --> 00:21:15,440
contain the missing information which

596
00:21:15,440 --> 00:21:16,880
you will then interpolate back into the

597
00:21:16,880 --> 00:21:17,360
event

598
00:21:17,360 --> 00:21:19,840
to show the complete event to the user

599
00:21:19,840 --> 00:21:21,520
so what the second tool which is nsa

600
00:21:21,520 --> 00:21:23,840
cyber's windows event messages 2 does is

601
00:21:23,840 --> 00:21:25,919
that

602
00:21:25,919 --> 00:21:27,840
for all the dlr files it will extract

603
00:21:27,840 --> 00:21:30,400
all the event messages of all possible

604
00:21:30,400 --> 00:21:32,400
windows events that could be generated

605
00:21:32,400 --> 00:21:35,600
by the operating system

606
00:21:38,320 --> 00:21:40,720
so this is a sample of an event message

607
00:21:40,720 --> 00:21:44,480
that is extracted by wlm 2.

608
00:21:44,480 --> 00:21:46,240
so this is for very common event which

609
00:21:46,240 --> 00:21:47,520
is windows security

610
00:21:47,520 --> 00:21:50,159
event id 4624 which is the successful

611
00:21:50,159 --> 00:21:51,440
logon event

612
00:21:51,440 --> 00:21:53,360
so this message contains the missing

613
00:21:53,360 --> 00:21:54,720
information the event

614
00:21:54,720 --> 00:21:56,960
description as well as the field names

615
00:21:56,960 --> 00:21:58,159
that are mapped to

616
00:21:58,159 --> 00:22:00,320
the position that it appears within the

617
00:22:00,320 --> 00:22:03,760
event data of the event

618
00:22:03,840 --> 00:22:06,080
so as mentioned previously wrm is able

619
00:22:06,080 --> 00:22:07,520
to extract

620
00:22:07,520 --> 00:22:09,520
this message from all possible windows

621
00:22:09,520 --> 00:22:11,600
events that could be generated

622
00:22:11,600 --> 00:22:14,480
on the host os and its output looks

623
00:22:14,480 --> 00:22:15,200
something like this

624
00:22:15,200 --> 00:22:17,440
this the text output also has the csv

625
00:22:17,440 --> 00:22:20,559
output and the json output

626
00:22:20,559 --> 00:22:24,240
so it's able to actually export 47 317

627
00:22:24,240 --> 00:22:25,600
event messages

628
00:22:25,600 --> 00:22:28,000
for the os where each line represents an

629
00:22:28,000 --> 00:22:30,320
event

630
00:22:30,320 --> 00:22:34,720
five minutes remaining okay

631
00:22:35,039 --> 00:22:37,520
with the release of this tool nsn cyber

632
00:22:37,520 --> 00:22:39,120
has released

633
00:22:39,120 --> 00:22:41,280
data sets for flash os installations up

634
00:22:41,280 --> 00:22:42,320
to windows 10

635
00:22:42,320 --> 00:22:45,600
version 1703 and windows server 2016

636
00:22:45,600 --> 00:22:47,200
version 16.07

637
00:22:47,200 --> 00:22:49,120
unfortunately no new data sets have been

638
00:22:49,120 --> 00:22:52,000
released since then

639
00:22:53,360 --> 00:22:54,720
so what i have done is to form the

640
00:22:54,720 --> 00:22:56,400
repository and

641
00:22:56,400 --> 00:22:58,720
create a new release with data sets for

642
00:22:58,720 --> 00:23:02,240
the latest three releases of windows 10

643
00:23:02,240 --> 00:23:04,400
i've also compiled the binary of the

644
00:23:04,400 --> 00:23:06,320
code of nsa cyprus

645
00:23:06,320 --> 00:23:10,080
and release it in this release as well

646
00:23:10,080 --> 00:23:12,000
so any user is able to download the zip

647
00:23:12,000 --> 00:23:14,000
file to a fresh os installation

648
00:23:14,000 --> 00:23:15,840
unzip it and run the batch file with

649
00:23:15,840 --> 00:23:17,200
admin privileges

650
00:23:17,200 --> 00:23:19,120
to generate the windows event messages

651
00:23:19,120 --> 00:23:20,320
what the os

652
00:23:20,320 --> 00:23:23,840
is executing from

653
00:23:24,640 --> 00:23:28,000
so primary usage for windows

654
00:23:28,000 --> 00:23:31,280
wlm 2 is that it's able to determine

655
00:23:31,280 --> 00:23:32,960
what are the changes in windows event

656
00:23:32,960 --> 00:23:35,280
logs over the different os fields

657
00:23:35,280 --> 00:23:37,360
so what what i have here is the

658
00:23:37,360 --> 00:23:39,039
comparison between the two latest

659
00:23:39,039 --> 00:23:40,799
releases of windows 10

660
00:23:40,799 --> 00:23:43,840
between 2004 and h2 returning h2 was

661
00:23:43,840 --> 00:23:46,320
released just last month

662
00:23:46,320 --> 00:23:48,240
so on the right hand side you have 20 h2

663
00:23:48,240 --> 00:23:49,840
you can see that there are several new

664
00:23:49,840 --> 00:23:51,600
events in 20h2

665
00:23:51,600 --> 00:23:54,000
unfortunately it contains missing

666
00:23:54,000 --> 00:23:56,000
information such as where it's being

667
00:23:56,000 --> 00:23:59,120
logged to for this new events

668
00:23:59,120 --> 00:24:03,200
as well as the event message that tells

669
00:24:03,200 --> 00:24:04,000
you what is it

670
00:24:04,000 --> 00:24:06,000
being used for this is currently not

671
00:24:06,000 --> 00:24:09,600
very useful for investigations

672
00:24:10,640 --> 00:24:12,240
however if we were to do a comparison

673
00:24:12,240 --> 00:24:14,320
between the windows event messages for

674
00:24:14,320 --> 00:24:16,159
2004 and 1909

675
00:24:16,159 --> 00:24:19,360
which was released in last november

676
00:24:19,360 --> 00:24:20,640
there are actually two events that could

677
00:24:20,640 --> 00:24:24,320
be useful for investigations

678
00:24:24,960 --> 00:24:27,600
the first new event is event id 207 from

679
00:24:27,600 --> 00:24:30,159
microsoft windows storage spaces driver

680
00:24:30,159 --> 00:24:33,039
so this event is generated each time a

681
00:24:33,039 --> 00:24:34,480
storage device

682
00:24:34,480 --> 00:24:37,440
or is whether it's removable or internal

683
00:24:37,440 --> 00:24:39,039
is plugged into the system

684
00:24:39,039 --> 00:24:41,679
so this is a event that could be useful

685
00:24:41,679 --> 00:24:42,400
for usb

686
00:24:42,400 --> 00:24:46,559
investigations the other new event is

687
00:24:46,559 --> 00:24:49,840
event id 151 for microsoft windows ntfs

688
00:24:49,840 --> 00:24:51,039
operational

689
00:24:51,039 --> 00:24:53,039
so this event is generated every one

690
00:24:53,039 --> 00:24:54,960
hour where it will actually

691
00:24:54,960 --> 00:24:56,240
show the number of files that were

692
00:24:56,240 --> 00:24:58,080
deleted in the past one hour

693
00:24:58,080 --> 00:25:00,080
we also identified the responsible

694
00:25:00,080 --> 00:25:01,120
process

695
00:25:01,120 --> 00:25:03,360
so how you interpret this event is that

696
00:25:03,360 --> 00:25:04,640
in the last one hour

697
00:25:04,640 --> 00:25:08,480
it found that 9491 files were directed

698
00:25:08,480 --> 00:25:10,880
and was able to identify the responsible

699
00:25:10,880 --> 00:25:12,840
process for all the

700
00:25:12,840 --> 00:25:15,120
deletions and it will generate a

701
00:25:15,120 --> 00:25:16,240
separate event

702
00:25:16,240 --> 00:25:19,440
id 151 for every responsible process

703
00:25:19,440 --> 00:25:21,760
so this particular process or event is

704
00:25:21,760 --> 00:25:24,080
for pycharm 64.exe

705
00:25:24,080 --> 00:25:26,080
where this process is responsible for

706
00:25:26,080 --> 00:25:28,000
three of the thousand plus four

707
00:25:28,000 --> 00:25:30,320
deletions

708
00:25:30,320 --> 00:25:32,159
so this event could be useful to help

709
00:25:32,159 --> 00:25:34,320
you determine what are the active

710
00:25:34,320 --> 00:25:35,120
processes

711
00:25:35,120 --> 00:25:38,559
in one hour periods it could also be

712
00:25:38,559 --> 00:25:39,120
used to

713
00:25:39,120 --> 00:25:42,480
identify a destructive malware as well

714
00:25:42,480 --> 00:25:45,120
as book users deleting a large volume of

715
00:25:45,120 --> 00:25:45,760
files

716
00:25:45,760 --> 00:25:48,720
in four servers

717
00:25:50,080 --> 00:25:51,840
with this i've come to the end of my

718
00:25:51,840 --> 00:25:53,840
presentation so very much thank you very

719
00:25:53,840 --> 00:25:56,480
much for your time

720
00:25:56,480 --> 00:25:57,919
please feel free to leave your questions

721
00:25:57,919 --> 00:26:00,320
in a q a yeah thank you very much

722
00:26:00,320 --> 00:26:03,760
we have one question in the pipe uh

723
00:26:03,760 --> 00:26:06,559
which says from just bowling sorry if i

724
00:26:06,559 --> 00:26:07,520
miss it but

725
00:26:07,520 --> 00:26:10,240
what strips are you using to gather host

726
00:26:10,240 --> 00:26:14,480
artifacts and is it available to others

727
00:26:16,559 --> 00:26:19,200
so mainly i'm using kit which is cool

728
00:26:19,200 --> 00:26:21,120
artifact parser extractor

729
00:26:21,120 --> 00:26:23,039
so i think this is a very popular tool

730
00:26:23,039 --> 00:26:24,240
by alex zimmerman

731
00:26:24,240 --> 00:26:25,919
where you can actually do a quick google

732
00:26:25,919 --> 00:26:27,760
search and i think that would be one of

733
00:26:27,760 --> 00:26:28,799
the first results

734
00:26:28,799 --> 00:26:31,120
available so what this tool does is that

735
00:26:31,120 --> 00:26:32,640
allow you to collect

736
00:26:32,640 --> 00:26:34,400
so you can actually set up the command

737
00:26:34,400 --> 00:26:36,559
line using kit and then you can actually

738
00:26:36,559 --> 00:26:37,360
choose the

739
00:26:37,360 --> 00:26:39,200
artifacts that you want to collect and

740
00:26:39,200 --> 00:26:40,880
then you copy the command line and then

741
00:26:40,880 --> 00:26:42,480
you actually run it via

742
00:26:42,480 --> 00:26:44,400
the remote response capability of the

743
00:26:44,400 --> 00:26:46,880
edr

744
00:26:47,679 --> 00:26:51,039
thank you another question

745
00:26:51,039 --> 00:26:53,440
related to the retention you've been

746
00:26:53,440 --> 00:26:55,039
talking about retention earlier in the

747
00:26:55,039 --> 00:26:56,640
presentation

748
00:26:56,640 --> 00:26:59,120
is it a problem with you or in some

749
00:26:59,120 --> 00:27:00,240
countries

750
00:27:00,240 --> 00:27:02,640
due to local regulations or privacy

751
00:27:02,640 --> 00:27:04,960
issues

752
00:27:05,520 --> 00:27:07,600
yeah i think that like what you said

753
00:27:07,600 --> 00:27:09,360
there could be actually different

754
00:27:09,360 --> 00:27:11,600
regulations for different countries

755
00:27:11,600 --> 00:27:13,600
especially uh privacy laws in

756
00:27:13,600 --> 00:27:16,559
europe for example and there could also

757
00:27:16,559 --> 00:27:17,360
be

758
00:27:17,360 --> 00:27:19,279
different laws that actually requires

759
00:27:19,279 --> 00:27:20,880
their logs to be retained for a certain

760
00:27:20,880 --> 00:27:22,880
period for compliance purposes

761
00:27:22,880 --> 00:27:24,799
so it really depends on what you are

762
00:27:24,799 --> 00:27:26,640
trying to adhere to and which vision you

763
00:27:26,640 --> 00:27:27,760
are reciting it

764
00:27:27,760 --> 00:27:29,919
there's also another fact that employees

765
00:27:29,919 --> 00:27:33,279
actually agree to be monitored

766
00:27:33,279 --> 00:27:34,960
when they sign their employment contract

767
00:27:34,960 --> 00:27:37,360
so i mean they are actually giving out

768
00:27:37,360 --> 00:27:39,039
their privacy in that sense because they

769
00:27:39,039 --> 00:27:40,640
are actually using the word laptop and

770
00:27:40,640 --> 00:27:41,840
they have agreed

771
00:27:41,840 --> 00:27:44,799
uh to be monitored so there shouldn't be

772
00:27:44,799 --> 00:27:46,559
an issue there but then i'm not expert

773
00:27:46,559 --> 00:27:49,600
on this so that's just my opinion

774
00:27:49,600 --> 00:27:53,039
okay thank you and one final question in

775
00:27:53,039 --> 00:27:55,279
two minutes please can this tool be

776
00:27:55,279 --> 00:27:58,000
integrated with domain controllers

777
00:27:58,000 --> 00:28:02,399
to sweep across various endpoints

778
00:28:02,399 --> 00:28:05,200
uh there's no such feature yet so um

779
00:28:05,200 --> 00:28:06,080
what can you do

780
00:28:06,080 --> 00:28:07,840
with with this tool is that you can

781
00:28:07,840 --> 00:28:09,919
actually go to a crosstrack web console

782
00:28:09,919 --> 00:28:11,520
and then try to download all the

783
00:28:11,520 --> 00:28:14,240
hosts that is actually reporting back to

784
00:28:14,240 --> 00:28:15,440
the cloud strike

785
00:28:15,440 --> 00:28:17,120
and then with the host id you can

786
00:28:17,120 --> 00:28:18,559
actually

787
00:28:18,559 --> 00:28:20,640
list them down in a text file and then

788
00:28:20,640 --> 00:28:22,640
use it as an input to the box strike

789
00:28:22,640 --> 00:28:23,120
tool

790
00:28:23,120 --> 00:28:24,559
and then you can use it to communicate

791
00:28:24,559 --> 00:28:28,559
with all the endpoints in this way

792
00:28:29,360 --> 00:28:32,640
okay so no other questions so

793
00:28:32,640 --> 00:28:35,679
uh first i'd like to thank you for uh

794
00:28:35,679 --> 00:28:38,159
this great presentation and answer to

795
00:28:38,159 --> 00:28:39,279
the questions

796
00:28:39,279 --> 00:28:40,880
uh thank you to all of you virtual

797
00:28:40,880 --> 00:28:42,399
attendees especially to those who've

798
00:28:42,399 --> 00:28:43,279
been asking

799
00:28:43,279 --> 00:28:44,799
questions i hope you enjoyed this

800
00:28:44,799 --> 00:28:47,440
presentation as much as i did

801
00:28:47,440 --> 00:28:49,760
and this session is now over so please

802
00:28:49,760 --> 00:28:50,480
log off

803
00:28:50,480 --> 00:28:52,799
from this station and log in to the next

804
00:28:52,799 --> 00:28:54,720
schedule 14 for you

805
00:28:54,720 --> 00:28:59,840
thank you bye

806
00:29:01,039 --> 00:29:06,320
thanks oliver for moderating welcome

