1
00:00:06,640 --> 00:00:07,359
all right hi

2
00:00:07,359 --> 00:00:09,280
everybody thank you for joining us the

3
00:00:09,280 --> 00:00:11,120
second session of the day

4
00:00:11,120 --> 00:00:13,040
uh just get things started here real

5
00:00:13,040 --> 00:00:15,360
quick with a couple of announcements

6
00:00:15,360 --> 00:00:17,440
everybody is muted if you are using the

7
00:00:17,440 --> 00:00:19,119
event app we encourage you to check into

8
00:00:19,119 --> 00:00:20,960
your sessions update your activities

9
00:00:20,960 --> 00:00:22,560
and to please complete the session

10
00:00:22,560 --> 00:00:24,160
survey at the end

11
00:00:24,160 --> 00:00:26,160
if you are having trouble please email

12
00:00:26,160 --> 00:00:28,400
us at eventsetfirst.org and we're happy

13
00:00:28,400 --> 00:00:29,199
to help

14
00:00:29,199 --> 00:00:31,119
the session is tlp white and is being

15
00:00:31,119 --> 00:00:33,200
recorded recordings will be available

16
00:00:33,200 --> 00:00:35,200
within 24 hours via the app or the

17
00:00:35,200 --> 00:00:36,800
desktop mobile site

18
00:00:36,800 --> 00:00:38,239
and with that i'd like to introduce you

19
00:00:38,239 --> 00:00:40,320
to your session moderator today

20
00:00:40,320 --> 00:00:43,280
alexander yaeger alex hi everyone this

21
00:00:43,280 --> 00:00:44,480
is alex and i will

22
00:00:44,480 --> 00:00:46,879
be moderating this session today um just

23
00:00:46,879 --> 00:00:49,039
one item before we get started

24
00:00:49,039 --> 00:00:51,600
we ask you to submit your question using

25
00:00:51,600 --> 00:00:52,239
the q

26
00:00:52,239 --> 00:00:54,960
a section of the zoom app and questions

27
00:00:54,960 --> 00:00:57,199
will be queued in the order received at

28
00:00:57,199 --> 00:00:58,800
the end of the talk

29
00:00:58,800 --> 00:01:00,559
and with that let's go ahead and get

30
00:01:00,559 --> 00:01:02,879
started most people have heard about

31
00:01:02,879 --> 00:01:04,159
passive dns

32
00:01:04,159 --> 00:01:06,880
and it has become a key tool conducting

33
00:01:06,880 --> 00:01:08,240
instant response

34
00:01:08,240 --> 00:01:11,119
jan from netlab 360 will walk us through

35
00:01:11,119 --> 00:01:12,000
some examples

36
00:01:12,000 --> 00:01:14,560
of how they leveraged a very large data

37
00:01:14,560 --> 00:01:15,200
set

38
00:01:15,200 --> 00:01:17,759
to hunt web threats please join me in

39
00:01:17,759 --> 00:01:18,720
welcoming young

40
00:01:18,720 --> 00:01:27,840
the stage is yours

41
00:01:31,600 --> 00:01:41,839
yang i think you are still muted

42
00:01:46,240 --> 00:01:54,240
okay can you hear me yes thanks cool

43
00:01:54,240 --> 00:01:57,280
sorry wait a minute

44
00:01:58,240 --> 00:02:01,840
okay hello everyone glad to

45
00:02:01,840 --> 00:02:04,000
have the opportunity to have a talk with

46
00:02:04,000 --> 00:02:05,200
you guys

47
00:02:05,200 --> 00:02:07,600
my talk today is data driving web threat

48
00:02:07,600 --> 00:02:08,560
hunting

49
00:02:08,560 --> 00:02:12,720
let me introduce me and our group first

50
00:02:12,720 --> 00:02:15,200
we are a cyber security research lab of

51
00:02:15,200 --> 00:02:16,239
360.

52
00:02:16,239 --> 00:02:19,200
cct is one of the biggest cyber security

53
00:02:19,200 --> 00:02:20,080
companies in china

54
00:02:20,080 --> 00:02:23,120
and we supply cyber

55
00:02:23,120 --> 00:02:25,840
security solutions to general nations

56
00:02:25,840 --> 00:02:26,319
and

57
00:02:26,319 --> 00:02:29,360
to our business partners

58
00:02:29,360 --> 00:02:32,560
for me and for our team we focus

59
00:02:32,560 --> 00:02:35,360
our energy on threat hunting try to use

60
00:02:35,360 --> 00:02:37,920
all kinds of data to catch the newest

61
00:02:37,920 --> 00:02:41,840
or the biggest cyber threat the words

62
00:02:41,840 --> 00:02:45,360
cloud on the right is generated from our

63
00:02:45,360 --> 00:02:46,480
blog

64
00:02:46,480 --> 00:02:48,640
our blog's keywords through which you

65
00:02:48,640 --> 00:02:50,000
can get a first glance

66
00:02:50,000 --> 00:02:52,800
of our work

67
00:02:53,360 --> 00:02:56,319
we have a system called dsma for our

68
00:02:56,319 --> 00:02:57,360
team

69
00:02:57,360 --> 00:03:00,800
we run the biggest bds database of china

70
00:03:00,800 --> 00:03:02,080
more than six years

71
00:03:02,080 --> 00:03:04,319
and the cumulative domain ip making

72
00:03:04,319 --> 00:03:05,120
records

73
00:03:05,120 --> 00:03:07,920
now over 100 billion besides the

74
00:03:07,920 --> 00:03:09,599
original pds

75
00:03:09,599 --> 00:03:12,560
database we have built a whole ds based

76
00:03:12,560 --> 00:03:13,920
anomaly detection and

77
00:03:13,920 --> 00:03:17,120
verification system like we will

78
00:03:17,120 --> 00:03:19,680
catch nod newly observed dummy in real

79
00:03:19,680 --> 00:03:20,720
time

80
00:03:20,720 --> 00:03:23,360
and nad which is the domain name you

81
00:03:23,360 --> 00:03:23,760
know

82
00:03:23,760 --> 00:03:26,720
used to be active in history then from a

83
00:03:26,720 --> 00:03:28,159
certain time it goes to

84
00:03:28,159 --> 00:03:31,200
silence and boom now it goes active

85
00:03:31,200 --> 00:03:31,599
again

86
00:03:31,599 --> 00:03:33,680
we will catch it and other kinds of

87
00:03:33,680 --> 00:03:36,239
anomaly like domain name query spike

88
00:03:36,239 --> 00:03:39,840
subdominant spike or anomaly excess

89
00:03:39,840 --> 00:03:42,640
correlation etc all kinds of dns anomaly

90
00:03:42,640 --> 00:03:44,799
data will be used as the inputs

91
00:03:44,799 --> 00:03:47,360
of the following procedures the dns

92
00:03:47,360 --> 00:03:48,560
anomaly data will be

93
00:03:48,560 --> 00:03:52,720
related with other data dimensions like

94
00:03:52,720 --> 00:03:55,519
ui data the connection between dns and

95
00:03:55,519 --> 00:03:57,439
the url is very helpful

96
00:03:57,439 --> 00:04:00,879
for our dns anomaly an analysis and

97
00:04:00,879 --> 00:04:04,159
verification web insight

98
00:04:04,159 --> 00:04:07,200
i think you share your um

99
00:04:07,200 --> 00:04:09,680
not the slide you're talking about you

100
00:04:09,680 --> 00:04:13,200
need to restart your presentation

101
00:04:13,519 --> 00:04:16,320
we can see the slide yeah we can hear

102
00:04:16,320 --> 00:04:18,399
you but you can see the case to

103
00:04:18,399 --> 00:04:21,918
javascript high checking slide

104
00:04:22,960 --> 00:04:26,320
uh to restart from the

105
00:04:26,320 --> 00:04:29,360
so we don't we don't see the the um

106
00:04:29,360 --> 00:04:32,560
the slide you're talking about

107
00:04:32,960 --> 00:04:36,240
what about now still not

108
00:04:36,240 --> 00:04:43,840
changing anything

109
00:04:45,040 --> 00:04:46,479
we can't see your screen but it's the

110
00:04:46,479 --> 00:04:48,960
keynote app

111
00:04:48,960 --> 00:04:52,320
and your move is not your mouse is not

112
00:04:52,320 --> 00:04:55,199
moving yeah maybe try try stop sharing

113
00:04:55,199 --> 00:04:56,000
your screen and then

114
00:04:56,000 --> 00:04:58,800
share again let's see if that's okay in

115
00:04:58,800 --> 00:05:10,800
a minute

116
00:05:10,800 --> 00:05:13,440
how about now

117
00:05:16,960 --> 00:05:25,840
it's just loading loading

118
00:05:27,199 --> 00:05:30,240
still loading i'm changing my slide

119
00:05:30,240 --> 00:05:33,600
can't you see no it's still a black

120
00:05:33,600 --> 00:05:35,039
screen that just says

121
00:05:35,039 --> 00:05:38,160
um you started sharing let's try it one

122
00:05:38,160 --> 00:05:41,039
more time just hit stop share

123
00:05:41,039 --> 00:05:43,919
stop here and then try let's try it one

124
00:05:43,919 --> 00:05:46,320
more time

125
00:06:05,360 --> 00:06:08,319
just a black screen do you have two

126
00:06:08,319 --> 00:06:10,880
monitors

127
00:06:12,479 --> 00:06:14,960
because did do you share a monitor or

128
00:06:14,960 --> 00:06:17,919
the app directly

129
00:06:17,919 --> 00:06:22,240
uh i i test on another

130
00:06:22,240 --> 00:06:35,840
room it's okay

131
00:06:37,919 --> 00:06:41,039
tracy any tips um i'm trying to see

132
00:06:41,039 --> 00:06:44,319
oh so we can see now you again you're

133
00:06:44,319 --> 00:06:49,840
now now we can see your mouse scrolling

134
00:06:50,479 --> 00:06:53,680
now you can see it no it's now it went

135
00:06:53,680 --> 00:06:56,000
away

136
00:06:56,160 --> 00:06:59,919
i have a pdf there we go there we go

137
00:06:59,919 --> 00:07:02,160
and now press start share the

138
00:07:02,160 --> 00:07:03,280
presentation

139
00:07:03,280 --> 00:07:06,560
there you go okay yeah okay okay

140
00:07:06,560 --> 00:07:10,639
you're back i'm go back to the dsm

141
00:07:10,639 --> 00:07:13,919
and the web inside part all right

142
00:07:13,919 --> 00:07:18,479
yeah uh yes desmond is a

143
00:07:18,720 --> 00:07:21,759
our opinions database and

144
00:07:21,759 --> 00:07:25,120
besides the pds database we also

145
00:07:25,120 --> 00:07:28,319
run all kinds of dns anomaly

146
00:07:28,319 --> 00:07:31,919
checking and verification

147
00:07:31,919 --> 00:07:33,919
and the web insight web insight is a

148
00:07:33,919 --> 00:07:36,639
functional module with focusing on web

149
00:07:36,639 --> 00:07:37,599
thread hunting

150
00:07:37,599 --> 00:07:41,360
it's a functional logic detail it's a

151
00:07:41,360 --> 00:07:41,919
key point

152
00:07:41,919 --> 00:07:44,960
of our discussion here today with dsm on

153
00:07:44,960 --> 00:07:45,919
the web inside

154
00:07:45,919 --> 00:07:49,680
the panel cabin fishing of the websites

155
00:07:49,680 --> 00:07:52,319
had been compromised will be detected in

156
00:07:52,319 --> 00:07:53,120
real time

157
00:07:53,120 --> 00:07:58,800
let's see some real cases first

158
00:07:58,800 --> 00:08:01,440
can see me

159
00:08:02,479 --> 00:08:06,879
yep oh yes is that okay yeah okay okay

160
00:08:06,879 --> 00:08:10,479
uh the first case is a website exploit

161
00:08:10,479 --> 00:08:13,120
this is a fragment of jazz code that had

162
00:08:13,120 --> 00:08:15,120
been injected in many

163
00:08:15,120 --> 00:08:18,240
wordpress websites it suggests puddle

164
00:08:18,240 --> 00:08:20,560
waiting the website's administrator to

165
00:08:20,560 --> 00:08:21,280
access

166
00:08:21,280 --> 00:08:23,440
once the administrator stepped in this

167
00:08:23,440 --> 00:08:27,120
puddle then the code will be

168
00:08:27,120 --> 00:08:29,360
still the admin power of the

169
00:08:29,360 --> 00:08:30,560
administrator

170
00:08:30,560 --> 00:08:32,880
to create another an administrator

171
00:08:32,880 --> 00:08:33,760
account

172
00:08:33,760 --> 00:08:36,159
then the hacker can use the new

173
00:08:36,159 --> 00:08:38,000
administrator to log in and

174
00:08:38,000 --> 00:08:40,399
do whatever they want we see it in our

175
00:08:40,399 --> 00:08:41,039
data

176
00:08:41,039 --> 00:08:44,880
the name and the password of the new an

177
00:08:44,880 --> 00:08:47,279
administrator is fixed in the codes i

178
00:08:47,279 --> 00:08:48,320
covered it up

179
00:08:48,320 --> 00:08:51,360
so we can simply use it to verify

180
00:08:51,360 --> 00:08:54,240
here is the result it works we can log

181
00:08:54,240 --> 00:08:55,120
in the admin

182
00:08:55,120 --> 00:08:57,760
page and with the rule of the

183
00:08:57,760 --> 00:08:59,120
administrator so

184
00:08:59,120 --> 00:09:02,080
i can do whatever i want in the past

185
00:09:02,080 --> 00:09:02,640
year

186
00:09:02,640 --> 00:09:05,760
we see hundreds of websites had been

187
00:09:05,760 --> 00:09:06,240
hacked

188
00:09:06,240 --> 00:09:09,120
in this way and at least three different

189
00:09:09,120 --> 00:09:11,279
versions of this kind of attack still

190
00:09:11,279 --> 00:09:12,480
being alive

191
00:09:12,480 --> 00:09:14,800
the right screenshot is a picture of

192
00:09:14,800 --> 00:09:15,680
part of

193
00:09:15,680 --> 00:09:18,240
our data you can see the cases came out

194
00:09:18,240 --> 00:09:20,480
day by day from the

195
00:09:20,480 --> 00:09:22,720
first thing let's see time column and

196
00:09:22,720 --> 00:09:24,640
you can see the user password data

197
00:09:24,640 --> 00:09:25,279
either

198
00:09:25,279 --> 00:09:27,760
i covered the secret part but you can

199
00:09:27,760 --> 00:09:28,880
get what i mean

200
00:09:28,880 --> 00:09:31,519
and you can imagine what you can do with

201
00:09:31,519 --> 00:09:32,160
it

202
00:09:32,160 --> 00:09:34,560
we don't scan the whole internet for the

203
00:09:34,560 --> 00:09:36,880
real number of the

204
00:09:36,880 --> 00:09:39,279
whole compromise of websites for it is

205
00:09:39,279 --> 00:09:40,399
enough for us

206
00:09:40,399 --> 00:09:43,279
to catch this thread and identify the

207
00:09:43,279 --> 00:09:44,240
vulnerability

208
00:09:44,240 --> 00:09:46,880
but no doubt that the real number will

209
00:09:46,880 --> 00:09:49,440
be very very high

210
00:09:49,440 --> 00:09:53,200
case 2 is just hijacking

211
00:09:53,200 --> 00:09:55,120
see the right picture which is the code

212
00:09:55,120 --> 00:09:57,200
of just script

213
00:09:57,200 --> 00:10:00,959
the codes below the blue line are the

214
00:10:00,959 --> 00:10:02,880
original codes the normal codes

215
00:10:02,880 --> 00:10:05,519
the code below the above the blue line

216
00:10:05,519 --> 00:10:06,560
are the codes

217
00:10:06,560 --> 00:10:09,600
that had been injected in the script

218
00:10:09,600 --> 00:10:11,680
the hex code when the code being

219
00:10:11,680 --> 00:10:13,920
executed it will create a

220
00:10:13,920 --> 00:10:18,079
html script node in the page the request

221
00:10:18,079 --> 00:10:21,120
and then request another url then it can

222
00:10:21,120 --> 00:10:24,000
do the redirection or change the content

223
00:10:24,000 --> 00:10:25,680
of the web page

224
00:10:25,680 --> 00:10:28,720
also see the content in the red line box

225
00:10:28,720 --> 00:10:32,440
the variable as the first line s a sads

226
00:10:32,440 --> 00:10:35,519
dsf-23 is a sign that the current

227
00:10:35,519 --> 00:10:36,399
website

228
00:10:36,399 --> 00:10:38,959
had been injected there are many of them

229
00:10:38,959 --> 00:10:40,079
i think

230
00:10:40,079 --> 00:10:42,880
maybe different variables belong to

231
00:10:42,880 --> 00:10:44,399
different hacker groups

232
00:10:44,399 --> 00:10:46,800
or different hacking campaigns these

233
00:10:46,800 --> 00:10:47,440
kinds of

234
00:10:47,440 --> 00:10:49,600
variables also can be used as a

235
00:10:49,600 --> 00:10:50,880
detection keyword

236
00:10:50,880 --> 00:10:54,560
detection features by us in this case

237
00:10:54,560 --> 00:10:57,760
we have found 1207

238
00:10:57,760 --> 00:11:00,000
normal js scripts had been hacked

239
00:11:00,000 --> 00:11:00,800
affected

240
00:11:00,800 --> 00:11:04,160
over 5000 websites and they all have the

241
00:11:04,160 --> 00:11:06,240
variable

242
00:11:06,240 --> 00:11:10,000
as true before the sads

243
00:11:10,000 --> 00:11:14,320
blah blah blah history this is a

244
00:11:14,320 --> 00:11:16,959
another interesting case of gs injection

245
00:11:16,959 --> 00:11:18,720
the malicious code

246
00:11:18,720 --> 00:11:22,000
e is obfuscated in car code

247
00:11:22,000 --> 00:11:24,880
after simple decode we can see what they

248
00:11:24,880 --> 00:11:26,640
want to do clearly

249
00:11:26,640 --> 00:11:29,279
and the code is d over first created the

250
00:11:29,279 --> 00:11:30,160
code will be

251
00:11:30,160 --> 00:11:35,519
executed within a 02.5 second delay

252
00:11:35,519 --> 00:11:38,320
and it will generate a domain name

253
00:11:38,320 --> 00:11:39,200
accord

254
00:11:39,200 --> 00:11:42,800
according the current time step the dld

255
00:11:42,800 --> 00:11:44,000
the domain suffix

256
00:11:44,000 --> 00:11:47,200
is fixed to ru the length of the domain

257
00:11:47,200 --> 00:11:48,720
name is fixed to

258
00:11:48,720 --> 00:11:52,160
16 with the new domain name a url

259
00:11:52,160 --> 00:11:54,880
will be composed and will be loaded in a

260
00:11:54,880 --> 00:11:56,000
new frame

261
00:11:56,000 --> 00:11:59,120
it's a web dga

262
00:11:59,120 --> 00:12:01,760
as we get the codes so we can calculate

263
00:12:01,760 --> 00:12:03,760
all the possible dga domain names by

264
00:12:03,760 --> 00:12:05,519
changing the time step

265
00:12:05,519 --> 00:12:07,680
there will be two domain names per day

266
00:12:07,680 --> 00:12:10,000
with fixed url pattern

267
00:12:10,000 --> 00:12:12,720
if we access the compromised website we

268
00:12:12,720 --> 00:12:14,560
can send the malicious url requested

269
00:12:14,560 --> 00:12:15,600
will be sent

270
00:12:15,600 --> 00:12:18,800
see the red line

271
00:12:18,800 --> 00:12:24,800
is a dj dominant but is not resolved

272
00:12:24,800 --> 00:12:28,480
if we keep keeping the time step to get

273
00:12:28,480 --> 00:12:28,880
the

274
00:12:28,880 --> 00:12:31,760
all the dg domain name we can see it's

275
00:12:31,760 --> 00:12:32,720
not endless

276
00:12:32,720 --> 00:12:35,360
it's a circle after some time the

277
00:12:35,360 --> 00:12:36,000
dominant

278
00:12:36,000 --> 00:12:39,440
will go back to the first there will be

279
00:12:39,440 --> 00:12:42,639
two uh 732 different

280
00:12:42,639 --> 00:12:45,839
domain names by this algorithm right now

281
00:12:45,839 --> 00:12:47,920
we have seen four different variants of

282
00:12:47,920 --> 00:12:49,440
this kind of injection

283
00:12:49,440 --> 00:12:52,000
and over 300 websites had been

284
00:12:52,000 --> 00:12:52,959
compromised

285
00:12:52,959 --> 00:12:55,600
see the uil pass always have a

286
00:12:55,600 --> 00:12:56,720
rainforest run

287
00:12:56,720 --> 00:13:00,079
so this dga been called rainforest

288
00:13:00,079 --> 00:13:02,399
the first report about this tga was

289
00:13:02,399 --> 00:13:03,880
around

290
00:13:03,880 --> 00:13:07,120
2012. eight years later still active on

291
00:13:07,120 --> 00:13:07,920
the internet

292
00:13:07,920 --> 00:13:11,279
if you like you can you know register

293
00:13:11,279 --> 00:13:13,120
those dj dominant and do a little

294
00:13:13,120 --> 00:13:16,000
traffic hijacking

295
00:13:18,079 --> 00:13:20,880
case for spider survival is used for

296
00:13:20,880 --> 00:13:21,920
blackhead screen

297
00:13:21,920 --> 00:13:24,800
uh search engine optimization tons of

298
00:13:24,800 --> 00:13:25,360
fake

299
00:13:25,360 --> 00:13:28,079
websites or subdomain pages will be

300
00:13:28,079 --> 00:13:29,440
dynamically

301
00:13:29,440 --> 00:13:32,480
generated and interconnected so

302
00:13:32,480 --> 00:13:35,360
when such engine crawler approaches one

303
00:13:35,360 --> 00:13:37,440
it will be trapped in the spider pool

304
00:13:37,440 --> 00:13:40,160
for endless working with the noise data

305
00:13:40,160 --> 00:13:41,600
and then the noise data will

306
00:13:41,600 --> 00:13:44,079
promote the spam or malicious website's

307
00:13:44,079 --> 00:13:45,440
ranking score

308
00:13:45,440 --> 00:13:48,240
with the help of audience nod and ad

309
00:13:48,240 --> 00:13:49,839
data as i mentioned before

310
00:13:49,839 --> 00:13:51,920
we can catch the spider for italy for

311
00:13:51,920 --> 00:13:54,320
the new observed domain name of

312
00:13:54,320 --> 00:13:57,199
the recently new active domain name it's

313
00:13:57,199 --> 00:13:59,040
often used by the spider board

314
00:13:59,040 --> 00:14:01,440
infrastructure as we can follow it if we

315
00:14:01,440 --> 00:14:03,360
can find it

316
00:14:03,360 --> 00:14:06,959
piece 5 is a marquee card

317
00:14:06,959 --> 00:14:08,800
market card attack means malicious

318
00:14:08,800 --> 00:14:11,839
hacker groups who target online shopping

319
00:14:11,839 --> 00:14:15,199
cart system at first the magical system

320
00:14:15,199 --> 00:14:17,440
to steal customer payment card

321
00:14:17,440 --> 00:14:18,240
information

322
00:14:18,240 --> 00:14:19,920
if you want to follow this kind of

323
00:14:19,920 --> 00:14:21,279
thread you can

324
00:14:21,279 --> 00:14:24,560
follow the hashtag like

325
00:14:24,720 --> 00:14:28,959
magic card skimmer or web scheming

326
00:14:28,959 --> 00:14:32,160
on twitter here are two examples of

327
00:14:32,160 --> 00:14:35,600
skimming code fragment the left is

328
00:14:35,600 --> 00:14:38,880
in plain text and the right is obviously

329
00:14:38,880 --> 00:14:39,600
it

330
00:14:39,600 --> 00:14:42,000
seems different but they are of the same

331
00:14:42,000 --> 00:14:42,720
function

332
00:14:42,720 --> 00:14:45,199
as the code runs it will check the

333
00:14:45,199 --> 00:14:46,959
user's payment inputs

334
00:14:46,959 --> 00:14:48,959
once the credit card information is

335
00:14:48,959 --> 00:14:51,360
ready the data will be sent back to a

336
00:14:51,360 --> 00:14:52,639
specific address

337
00:14:52,639 --> 00:14:55,440
of the reporting gate as shown on the

338
00:14:55,440 --> 00:14:56,320
left picture

339
00:14:56,320 --> 00:14:59,839
the in the red line box

340
00:14:59,839 --> 00:15:01,839
in this kind of a text the online shop's

341
00:15:01,839 --> 00:15:03,360
domain name is

342
00:15:03,360 --> 00:15:06,399
the victim the reporting domain name the

343
00:15:06,399 --> 00:15:09,279
reporting gate is bad so we listed the

344
00:15:09,279 --> 00:15:10,240
reporting gate

345
00:15:10,240 --> 00:15:13,519
domain name and the url as ioc which we

346
00:15:13,519 --> 00:15:15,839
detected over 50 in less one year

347
00:15:15,839 --> 00:15:19,279
as shown in the picture

348
00:15:19,839 --> 00:15:22,320
here is a link of our blog with some

349
00:15:22,320 --> 00:15:22,880
details

350
00:15:22,880 --> 00:15:25,279
if you are interested in this thread you

351
00:15:25,279 --> 00:15:26,639
can take a look

352
00:15:26,639 --> 00:15:28,399
due to different credit card payment

353
00:15:28,399 --> 00:15:30,320
methods in different regions like

354
00:15:30,320 --> 00:15:32,800
in china we need to input the password

355
00:15:32,800 --> 00:15:34,000
for every bill

356
00:15:34,000 --> 00:15:36,720
so the multi-card attack affects the

357
00:15:36,720 --> 00:15:37,680
europe and

358
00:15:37,680 --> 00:15:41,199
north american the most uh

359
00:15:41,199 --> 00:15:44,399
okay that's the case the case one to

360
00:15:44,399 --> 00:15:47,279
five is kind of uh special cases but

361
00:15:47,279 --> 00:15:49,040
actually most of what we see

362
00:15:49,040 --> 00:15:51,680
is point websites gaming websites fraud

363
00:15:51,680 --> 00:15:53,199
websites and all kinds of

364
00:15:53,199 --> 00:15:56,399
illegal promotion websites for these

365
00:15:56,399 --> 00:15:56,959
kinds of

366
00:15:56,959 --> 00:15:59,440
malicious websites are using new domain

367
00:15:59,440 --> 00:16:00,160
name to

368
00:16:00,160 --> 00:16:03,519
invade supervision to invade

369
00:16:03,519 --> 00:16:06,880
blockade they use the new domain name as

370
00:16:06,880 --> 00:16:10,160
the new github while the infrastructure

371
00:16:10,160 --> 00:16:11,440
they use like the js

372
00:16:11,440 --> 00:16:14,399
scripts are always the same or similar

373
00:16:14,399 --> 00:16:14,800
so

374
00:16:14,800 --> 00:16:17,120
it's a great feature for us to dig them

375
00:16:17,120 --> 00:16:18,000
out

376
00:16:18,000 --> 00:16:20,480
as shown in the picture loads a bunch of

377
00:16:20,480 --> 00:16:22,399
gaming websites they

378
00:16:22,399 --> 00:16:26,000
are all of different domain names but

379
00:16:26,000 --> 00:16:29,600
they have the same js scripts the name

380
00:16:29,600 --> 00:16:33,519
new jump slash ygs dot js

381
00:16:33,519 --> 00:16:37,120
and the sim calls in it also if they

382
00:16:37,120 --> 00:16:38,240
dive into

383
00:16:38,240 --> 00:16:40,480
their code so we can see the patterns

384
00:16:40,480 --> 00:16:41,759
other similar

385
00:16:41,759 --> 00:16:44,079
here are some examples we can see that

386
00:16:44,079 --> 00:16:45,040
they all like

387
00:16:45,040 --> 00:16:47,519
using a setting to a function to delay

388
00:16:47,519 --> 00:16:48,240
the loading

389
00:16:48,240 --> 00:16:50,560
and then either insert a iframe or

390
00:16:50,560 --> 00:16:52,720
insert a script node

391
00:16:52,720 --> 00:16:57,920
link to another js script

392
00:16:58,639 --> 00:17:01,040
okay after the cases we have sent let's

393
00:17:01,040 --> 00:17:03,120
get back to our system

394
00:17:03,120 --> 00:17:06,799
here is a all-in-one diagram shows

395
00:17:06,799 --> 00:17:09,599
our whole system process pipelines the

396
00:17:09,599 --> 00:17:12,240
upper part is the real-time process

397
00:17:12,240 --> 00:17:15,039
with all the anomaly data like led and

398
00:17:15,039 --> 00:17:15,599
spike

399
00:17:15,599 --> 00:17:19,039
etc our crawler will get its page

400
00:17:19,039 --> 00:17:21,439
the main page or with the help of our

401
00:17:21,439 --> 00:17:22,720
url data

402
00:17:22,720 --> 00:17:25,760
to get the specific url

403
00:17:25,760 --> 00:17:28,480
page and extract all the resources then

404
00:17:28,480 --> 00:17:29,280
with the help

405
00:17:29,280 --> 00:17:31,840
of our history black rule set like the

406
00:17:31,840 --> 00:17:34,240
special keywords in web scheming attack

407
00:17:34,240 --> 00:17:37,280
like the special variables ingest

408
00:17:37,280 --> 00:17:39,919
injection this is the special chest

409
00:17:39,919 --> 00:17:41,520
pattern in cabin

410
00:17:41,520 --> 00:17:44,080
websites cases as i mentioned before we

411
00:17:44,080 --> 00:17:45,200
can directly

412
00:17:45,200 --> 00:17:48,480
determine whether it is malicious and

413
00:17:48,480 --> 00:17:51,919
maybe what kind of malicious it is

414
00:17:51,919 --> 00:17:55,120
the lower part is our daily job

415
00:17:55,120 --> 00:17:58,000
all the data will be stored together day

416
00:17:58,000 --> 00:17:58,640
by day

417
00:17:58,640 --> 00:18:00,559
we will run an automatic discovery

418
00:18:00,559 --> 00:18:02,960
process which we will discuss later

419
00:18:02,960 --> 00:18:05,760
to discover the new suspicious data to

420
00:18:05,760 --> 00:18:07,600
expand our black rule set

421
00:18:07,600 --> 00:18:10,400
constantly the malicious websites are

422
00:18:10,400 --> 00:18:11,200
attacked

423
00:18:11,200 --> 00:18:14,080
by the old black rules and the new black

424
00:18:14,080 --> 00:18:16,240
rules are automatically discovered

425
00:18:16,240 --> 00:18:18,240
the whole loop process requires only a

426
00:18:18,240 --> 00:18:19,600
small amount of

427
00:18:19,600 --> 00:18:22,640
our menu review and of course the

428
00:18:22,640 --> 00:18:25,360
whole process needs the crawlers passing

429
00:18:25,360 --> 00:18:26,000
the

430
00:18:26,000 --> 00:18:29,520
extraction so much engineering work

431
00:18:29,520 --> 00:18:32,799
to do but i i i'm not want to go

432
00:18:32,799 --> 00:18:35,600
going deep here

433
00:18:35,840 --> 00:18:40,160
as i said before we have uh we have an

434
00:18:40,160 --> 00:18:42,480
automatic discovery process for black

435
00:18:42,480 --> 00:18:43,360
rules right

436
00:18:43,360 --> 00:18:46,080
the automatic discovery process rely on

437
00:18:46,080 --> 00:18:46,880
our

438
00:18:46,880 --> 00:18:50,000
established features i listed uh some

439
00:18:50,000 --> 00:18:52,400
of them about not all but the majority

440
00:18:52,400 --> 00:18:54,000
of the most useful ones

441
00:18:54,000 --> 00:18:56,240
maybe you would notice that the features

442
00:18:56,240 --> 00:18:57,360
are mainly gs

443
00:18:57,360 --> 00:19:00,640
grips related right before we do this

444
00:19:00,640 --> 00:19:04,320
whole system we have a deep and analysis

445
00:19:04,320 --> 00:19:06,559
for endless malicious websites the

446
00:19:06,559 --> 00:19:08,080
infrastructure they use

447
00:19:08,080 --> 00:19:10,960
are always the same like ip for the

448
00:19:10,960 --> 00:19:11,919
continuous

449
00:19:11,919 --> 00:19:14,559
hiking campaign the hacking resources

450
00:19:14,559 --> 00:19:16,400
will be used again and again

451
00:19:16,400 --> 00:19:18,960
like the scripts or codes in this way

452
00:19:18,960 --> 00:19:21,200
rather than discovering the

453
00:19:21,200 --> 00:19:24,559
malicious website you want to discovery

454
00:19:24,559 --> 00:19:26,960
the malicious resources used by the

455
00:19:26,960 --> 00:19:28,640
malicious websites or the

456
00:19:28,640 --> 00:19:32,080
threat campaign it's more effective and

457
00:19:32,080 --> 00:19:34,720
valuable these features are based on

458
00:19:34,720 --> 00:19:35,679
what we

459
00:19:35,679 --> 00:19:38,799
know which could be suspicious right but

460
00:19:38,799 --> 00:19:40,480
there are lots of what we don't

461
00:19:40,480 --> 00:19:42,400
know so let's go deeper think the

462
00:19:42,400 --> 00:19:43,679
website structure

463
00:19:43,679 --> 00:19:46,799
each website can be uh

464
00:19:46,799 --> 00:19:50,960
sync it can be seen as composed with

465
00:19:50,960 --> 00:19:53,840
various resources and the js code and

466
00:19:53,840 --> 00:19:55,520
the scripts are of the most

467
00:19:55,520 --> 00:19:59,039
important right and also each js scripts

468
00:19:59,039 --> 00:19:59,840
or codes

469
00:19:59,840 --> 00:20:03,360
can be splated into many functional

470
00:20:03,360 --> 00:20:06,520
code fragments so based on this

471
00:20:06,520 --> 00:20:09,200
multi-composing structure we can do lots

472
00:20:09,200 --> 00:20:09,600
of

473
00:20:09,600 --> 00:20:12,880
statistical anomaly detection like

474
00:20:12,880 --> 00:20:16,240
uh there a new js file appears on many

475
00:20:16,240 --> 00:20:17,600
new websites

476
00:20:17,600 --> 00:20:20,720
is there a new sim js scripts

477
00:20:20,720 --> 00:20:22,960
with various suggest names if they are

478
00:20:22,960 --> 00:20:23,760
just called

479
00:20:23,760 --> 00:20:26,720
fragment appears in many unrelevant js

480
00:20:26,720 --> 00:20:27,600
scripts

481
00:20:27,600 --> 00:20:30,320
if they're a spike or meaningless or

482
00:20:30,320 --> 00:20:31,120
variables

483
00:20:31,120 --> 00:20:33,280
once normally being funded we can

484
00:20:33,280 --> 00:20:35,120
quickly give it a menu check

485
00:20:35,120 --> 00:20:38,158
to see what it is

486
00:20:38,480 --> 00:20:41,120
there's a clearly advantage with the

487
00:20:41,120 --> 00:20:43,760
focusing on the resources for example

488
00:20:43,760 --> 00:20:46,159
once we found a malicious js code or

489
00:20:46,159 --> 00:20:47,039
scripts

490
00:20:47,039 --> 00:20:50,559
suppose we found it in at funded

491
00:20:50,559 --> 00:20:53,200
january first then we can keep tracking

492
00:20:53,200 --> 00:20:55,200
what new domain name they use

493
00:20:55,200 --> 00:20:57,840
we can see the hiking activities not in

494
00:20:57,840 --> 00:21:00,000
a separate view but a hacking group

495
00:21:00,000 --> 00:21:02,240
will we can see the malicious websites

496
00:21:02,240 --> 00:21:04,000
in clustering

497
00:21:04,000 --> 00:21:08,240
actually there will be over uh

498
00:21:08,480 --> 00:21:12,400
50 000 new porn or gaming website appear

499
00:21:12,400 --> 00:21:14,559
every day in china but we can block most

500
00:21:14,559 --> 00:21:15,200
of them

501
00:21:15,200 --> 00:21:20,159
within less than 500.js script url

502
00:21:20,159 --> 00:21:22,960
here are some pages need to know during

503
00:21:22,960 --> 00:21:24,080
the development

504
00:21:24,080 --> 00:21:27,720
we of course encountered many

505
00:21:27,720 --> 00:21:30,080
unexpected problems some of them are

506
00:21:30,080 --> 00:21:32,320
just the general engineering issues but

507
00:21:32,320 --> 00:21:33,360
some of them

508
00:21:33,360 --> 00:21:36,480
are the bad guys countermeasures which

509
00:21:36,480 --> 00:21:37,120
need us

510
00:21:37,120 --> 00:21:39,919
attention for example the hacker may use

511
00:21:39,919 --> 00:21:42,000
a small piece of code to check if the

512
00:21:42,000 --> 00:21:42,960
user browsers

513
00:21:42,960 --> 00:21:46,480
user agent or platform commit their

514
00:21:46,480 --> 00:21:48,640
requirements or not then do a

515
00:21:48,640 --> 00:21:49,840
redirection

516
00:21:49,840 --> 00:21:53,280
to the real malicious code rpgs and the

517
00:21:53,280 --> 00:21:56,480
execution execution of some malicious

518
00:21:56,480 --> 00:21:56,880
code

519
00:21:56,880 --> 00:21:59,520
need to wait a specific time the cases i

520
00:21:59,520 --> 00:22:00,559
posted before

521
00:22:00,559 --> 00:22:05,360
i just 0. 0.5 second

522
00:22:05,360 --> 00:22:07,440
or one second but there are some other

523
00:22:07,440 --> 00:22:08,559
cases in which

524
00:22:08,559 --> 00:22:11,440
we need to see longer three seconds or

525
00:22:11,440 --> 00:22:12,080
even more

526
00:22:12,080 --> 00:22:15,520
10 seconds some malicious codes like you

527
00:22:15,520 --> 00:22:17,600
like using a portrait or say a gateway

528
00:22:17,600 --> 00:22:18,880
gs the

529
00:22:18,880 --> 00:22:21,200
real malicious function codes are behind

530
00:22:21,200 --> 00:22:24,000
many times of js redirections

531
00:22:24,000 --> 00:22:26,640
and some websites my page is the empty

532
00:22:26,640 --> 00:22:28,720
landing page while their

533
00:22:28,720 --> 00:22:33,360
sub domain or some of their specific url

534
00:22:33,360 --> 00:22:36,559
are malicious some url using the fake

535
00:22:36,559 --> 00:22:37,600
uil suffix

536
00:22:37,600 --> 00:22:40,640
like the request like if you request

537
00:22:40,640 --> 00:22:44,400
a dot html but it may return with some

538
00:22:44,400 --> 00:22:46,640
malicious test codes

539
00:22:46,640 --> 00:22:48,880
and also some hackers do not follow the

540
00:22:48,880 --> 00:22:51,039
http protocol on purpose

541
00:22:51,039 --> 00:22:54,080
for run for the request they may return

542
00:22:54,080 --> 00:22:56,320
the error response code but actually

543
00:22:56,320 --> 00:22:58,400
with the data they needed

544
00:22:58,400 --> 00:23:01,280
and the more common issue is some bad

545
00:23:01,280 --> 00:23:02,240
actors actions

546
00:23:02,240 --> 00:23:04,960
are triggered by the user's interaction

547
00:23:04,960 --> 00:23:06,559
with the crawler we may get

548
00:23:06,559 --> 00:23:09,520
resources used but we cannot see the

549
00:23:09,520 --> 00:23:11,520
execution of malicious x

550
00:23:11,520 --> 00:23:13,679
without the proper interaction right in

551
00:23:13,679 --> 00:23:15,039
this situation

552
00:23:15,039 --> 00:23:18,320
locate the suspicious code segment

553
00:23:18,320 --> 00:23:21,840
and verify it with our expert knowledge

554
00:23:21,840 --> 00:23:25,280
is of the most important

555
00:23:27,039 --> 00:23:29,520
okay let's see what we have got

556
00:23:29,520 --> 00:23:30,159
basically

557
00:23:30,159 --> 00:23:33,280
the result includes two parts the first

558
00:23:33,280 --> 00:23:35,760
is illegal websites like the point

559
00:23:35,760 --> 00:23:37,360
websites gambling

560
00:23:37,360 --> 00:23:40,679
fraud websites we can see over

561
00:23:40,679 --> 00:23:44,320
50 000 every day and

562
00:23:44,320 --> 00:23:47,679
our cumulative data is over

563
00:23:47,679 --> 00:23:51,600
40 meaning the second part is

564
00:23:51,600 --> 00:23:54,000
normal websites while being hacked like

565
00:23:54,000 --> 00:23:56,240
js injection web scheming etc

566
00:23:56,240 --> 00:23:59,279
we can see over 500 per day on average

567
00:23:59,279 --> 00:24:02,960
and the cumulative data is over 500 000

568
00:24:02,960 --> 00:24:06,159
in this part we are not aiming to find

569
00:24:06,159 --> 00:24:08,480
out all the compromise website we only

570
00:24:08,480 --> 00:24:10,480
want to find out the io 6

571
00:24:10,480 --> 00:24:12,880
like the reporting domain name in web

572
00:24:12,880 --> 00:24:14,159
skimming cases

573
00:24:14,159 --> 00:24:17,360
all the results started from our mount

574
00:24:17,360 --> 00:24:18,000
system

575
00:24:18,000 --> 00:24:20,720
the dns anomaly data and the whole

576
00:24:20,720 --> 00:24:21,440
system

577
00:24:21,440 --> 00:24:24,240
are centered on data process using

578
00:24:24,240 --> 00:24:25,200
anomaly data

579
00:24:25,200 --> 00:24:28,480
as input and using statistical anomaly

580
00:24:28,480 --> 00:24:29,440
as trigger of

581
00:24:29,440 --> 00:24:33,360
our menu analysis we build the pipeline

582
00:24:33,360 --> 00:24:33,600
and

583
00:24:33,600 --> 00:24:36,559
the data tells us what we should do and

584
00:24:36,559 --> 00:24:37,679
what is

585
00:24:37,679 --> 00:24:42,240
uh the most notable thing

586
00:24:42,400 --> 00:24:45,200
okay i thought so thank you thank you

587
00:24:45,200 --> 00:24:46,480
for your time

588
00:24:46,480 --> 00:24:50,559
thank you young there are some questions

589
00:24:50,559 --> 00:24:53,440
um the first one was asked by robert who

590
00:24:53,440 --> 00:24:54,240
asks

591
00:24:54,240 --> 00:24:56,799
if there are any open source for your

592
00:24:56,799 --> 00:24:58,720
web insights

593
00:24:58,720 --> 00:25:01,200
we will open some of our data in the

594
00:25:01,200 --> 00:25:02,880
future in the near future

595
00:25:02,880 --> 00:25:07,120
but the program or the middleware we use

596
00:25:07,120 --> 00:25:10,559
we don't open because you know now our

597
00:25:10,559 --> 00:25:13,120
company 360 are on

598
00:25:13,120 --> 00:25:15,200
the american list you know the block

599
00:25:15,200 --> 00:25:17,120
list i i don't know why but

600
00:25:17,120 --> 00:25:20,640
i can do that okay cool

601
00:25:20,640 --> 00:25:23,440
and the other question is from kunal how

602
00:25:23,440 --> 00:25:24,960
do you infer

603
00:25:24,960 --> 00:25:27,120
if javascript has been maliciously

604
00:25:27,120 --> 00:25:28,159
changed

605
00:25:28,159 --> 00:25:30,240
is it through crawling target sites

606
00:25:30,240 --> 00:25:32,960
continuously

607
00:25:33,760 --> 00:25:37,679
basically we will check recheck the

608
00:25:37,679 --> 00:25:42,240
malicious js scripts time and time again

609
00:25:42,240 --> 00:25:45,120
like one week one time we will check if

610
00:25:45,120 --> 00:25:46,159
the malicious

611
00:25:46,159 --> 00:25:48,880
uh jet scripts are still alive or not to

612
00:25:48,880 --> 00:25:50,240
check the action

613
00:25:50,240 --> 00:25:53,200
to check if they are still alive but the

614
00:25:53,200 --> 00:25:53,840
like

615
00:25:53,840 --> 00:25:56,880
the ioc in the course have changed

616
00:25:56,880 --> 00:26:00,960
to say if it changes or not

617
00:26:01,440 --> 00:26:05,440
cool and omar wants to know

618
00:26:05,440 --> 00:26:07,200
what do you do if you discover a

619
00:26:07,200 --> 00:26:09,440
compromised website

620
00:26:09,440 --> 00:26:11,440
what actions do you take to inform the

621
00:26:11,440 --> 00:26:13,919
owner or the owners

622
00:26:13,919 --> 00:26:16,960
actually we only produce the ioc

623
00:26:16,960 --> 00:26:20,720
for our cybersecurity products

624
00:26:20,720 --> 00:26:24,400
to our to protect our customer

625
00:26:24,400 --> 00:26:26,720
but we don't have the right position to

626
00:26:26,720 --> 00:26:28,799
block all the malicious websites

627
00:26:28,799 --> 00:26:32,640
of all the uh

628
00:26:32,640 --> 00:26:34,960
you know the bad actor we don't have the

629
00:26:34,960 --> 00:26:38,720
isp position to do that

630
00:26:38,720 --> 00:26:41,760
okay cool thank you very much that were

631
00:26:41,760 --> 00:26:42,640
all the questions that

632
00:26:42,640 --> 00:26:45,600
have been asked if nothing else young

633
00:26:45,600 --> 00:26:47,600
thank you very much for your talk

634
00:26:47,600 --> 00:26:51,279
and with that handing back to tracy

635
00:26:51,279 --> 00:26:53,440
great thanks guys yeah we're going to go

636
00:26:53,440 --> 00:26:54,480
into

637
00:26:54,480 --> 00:26:58,159
a extended break um and we get things

638
00:26:58,159 --> 00:27:02,000
back started at uh looks like 14

639
00:27:02,000 --> 00:27:05,279
35 utc so

640
00:27:05,279 --> 00:27:09,320
about 30 minute break great thanks

641
00:27:09,320 --> 00:27:12,320
everybody

