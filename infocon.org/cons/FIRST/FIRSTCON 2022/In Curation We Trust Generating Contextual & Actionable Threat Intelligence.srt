1
00:00:06,070 --> 00:00:09,129
[Music]

2
00:00:10,160 --> 00:00:12,240
welcome to this morning session good to

3
00:00:12,240 --> 00:00:14,320
see so many of you up and

4
00:00:14,320 --> 00:00:16,560
clicking

5
00:00:16,560 --> 00:00:18,480
and

6
00:00:18,480 --> 00:00:21,600
i am henna glassen i'm from the

7
00:00:21,600 --> 00:00:24,400
danish environment dk search and i'm the

8
00:00:24,400 --> 00:00:26,960
chair of this morning session

9
00:00:26,960 --> 00:00:28,320
i'm

10
00:00:28,320 --> 00:00:30,960
delighted to be able to say welcome to

11
00:00:30,960 --> 00:00:33,200
michelle and bart from nbc

12
00:00:33,200 --> 00:00:36,079
uh who are telling us about a problem

13
00:00:36,079 --> 00:00:38,480
that i i'm sure we all have

14
00:00:38,480 --> 00:00:40,399
the problem of

15
00:00:40,399 --> 00:00:43,399
of

16
00:00:44,480 --> 00:00:47,199
false uh

17
00:00:47,280 --> 00:00:49,440
hey what's it called

18
00:00:49,440 --> 00:00:50,800
for uh

19
00:00:50,800 --> 00:00:52,719
false positives of course yeah it tells

20
00:00:52,719 --> 00:00:55,360
mr white sorry this morning and the

21
00:00:55,360 --> 00:00:57,760
problem of false positives in in certain

22
00:00:57,760 --> 00:01:00,239
intelligence and better use perhaps of

23
00:01:00,239 --> 00:01:05,040
the misplaced many of us are uses of so

24
00:01:05,040 --> 00:01:06,880
welcome

25
00:01:06,880 --> 00:01:08,280
thank you

26
00:01:08,280 --> 00:01:10,880
[Applause]

27
00:01:10,880 --> 00:01:13,119
thank you and uh good morning everyone

28
00:01:13,119 --> 00:01:15,360
it's uh it's amazing to see this many

29
00:01:15,360 --> 00:01:16,880
people here on the final day on the

30
00:01:16,880 --> 00:01:18,799
first talk of the morning so i really

31
00:01:18,799 --> 00:01:21,520
appreciate you all being here today

32
00:01:21,520 --> 00:01:24,720
so i'm uh michelle i'm the incident

33
00:01:24,720 --> 00:01:26,560
response and threat intelligence lead at

34
00:01:26,560 --> 00:01:28,479
nvizo i'm joined here today by my

35
00:01:28,479 --> 00:01:30,960
colleague bart good morning i'm bart and

36
00:01:30,960 --> 00:01:34,640
i'm a threat until manager at nvizo

37
00:01:34,640 --> 00:01:37,759
so what are we going to talk about today

38
00:01:37,759 --> 00:01:39,600
so we're going to talk about the problem

39
00:01:39,600 --> 00:01:41,840
that many of us are having in detail we

40
00:01:41,840 --> 00:01:42,880
have

41
00:01:42,880 --> 00:01:44,479
threat intelligence coming into our

42
00:01:44,479 --> 00:01:46,320
organization we get it from various

43
00:01:46,320 --> 00:01:47,759
sources

44
00:01:47,759 --> 00:01:49,759
but we do get some false positives so we

45
00:01:49,759 --> 00:01:52,000
talk a bit about okay what did we see

46
00:01:52,000 --> 00:01:54,399
and how did we improve on that or how

47
00:01:54,399 --> 00:01:56,240
did we try to tackle that problem within

48
00:01:56,240 --> 00:01:58,560
our own organization but also how you

49
00:01:58,560 --> 00:02:01,439
can do it within your organization

50
00:02:01,439 --> 00:02:02,960
we're currently working on this project

51
00:02:02,960 --> 00:02:04,399
we've been doing this for quite some

52
00:02:04,399 --> 00:02:06,880
time already now um but we still have a

53
00:02:06,880 --> 00:02:08,399
roadmap we still have some things

54
00:02:08,399 --> 00:02:10,399
planned that we want to improve on that

55
00:02:10,399 --> 00:02:12,879
we want to um elaborate on within our

56
00:02:12,879 --> 00:02:15,599
workflow so we'll talk about the roadmap

57
00:02:15,599 --> 00:02:17,520
that we have but also about the lessons

58
00:02:17,520 --> 00:02:19,200
learned and of course if there are any

59
00:02:19,200 --> 00:02:21,040
questions we're happy to answer them at

60
00:02:21,040 --> 00:02:23,840
the end of the talk

61
00:02:24,000 --> 00:02:25,760
so

62
00:02:25,760 --> 00:02:27,440
what's the problem that we have with

63
00:02:27,440 --> 00:02:29,040
threat intelligence

64
00:02:29,040 --> 00:02:32,400
so many of you are probably connected to

65
00:02:32,400 --> 00:02:36,319
the first misp maybe two circle to other

66
00:02:36,319 --> 00:02:39,599
various sources to paid feeds uh two

67
00:02:39,599 --> 00:02:42,000
commercial feeds there as well

68
00:02:42,000 --> 00:02:44,640
and what are some things that well

69
00:02:44,640 --> 00:02:47,120
maybe i'll just ask for a raise of hands

70
00:02:47,120 --> 00:02:49,040
here it's still in the morning get a bit

71
00:02:49,040 --> 00:02:51,360
interactive raise of hands who

72
00:02:51,360 --> 00:02:54,720
encountered this indicator in their misp

73
00:02:54,720 --> 00:02:57,680
or other threat intel infrastructure

74
00:02:57,680 --> 00:02:58,879
right

75
00:02:58,879 --> 00:03:00,800
i'm going to say more than half of the

76
00:03:00,800 --> 00:03:04,000
room said yes absolutely this indicator

77
00:03:04,000 --> 00:03:06,720
it might be there but it within miss we

78
00:03:06,720 --> 00:03:09,519
have something to ids send it to your

79
00:03:09,519 --> 00:03:10,480
seam

80
00:03:10,480 --> 00:03:12,400
send it to your security tools this is

81
00:03:12,400 --> 00:03:15,040
of course enabled now if this happens if

82
00:03:15,040 --> 00:03:17,440
this enters within your organization

83
00:03:17,440 --> 00:03:19,680
what's the next thing that happens

84
00:03:19,680 --> 00:03:22,000
it's sent to the soccer what's going on

85
00:03:22,000 --> 00:03:24,560
at the sock

86
00:03:24,640 --> 00:03:26,400
everything starts to light up like a

87
00:03:26,400 --> 00:03:29,519
christmas tree alerts all around

88
00:03:29,519 --> 00:03:32,640
so of course if we get garbage we like

89
00:03:32,640 --> 00:03:34,480
to call it garbage there if we get

90
00:03:34,480 --> 00:03:37,360
garbage into our infrastructure that's

91
00:03:37,360 --> 00:03:39,280
just gonna cause a negative spiral

92
00:03:39,280 --> 00:03:41,840
within our environment within uh with

93
00:03:41,840 --> 00:03:43,760
our colleagues uh that's something that

94
00:03:43,760 --> 00:03:46,959
we want to avoid of course

95
00:03:46,959 --> 00:03:47,680
so

96
00:03:47,680 --> 00:03:49,519
it's the garbage that goes to enrich

97
00:03:49,519 --> 00:03:51,440
garbage and ends up into being an

98
00:03:51,440 --> 00:03:53,920
inflated balloon there

99
00:03:53,920 --> 00:03:56,400
so for us within nviso we thought about

100
00:03:56,400 --> 00:03:58,640
okay how are we going to improve on that

101
00:03:58,640 --> 00:04:00,959
how can we do better because we used to

102
00:04:00,959 --> 00:04:02,879
have one misp instance that miss

103
00:04:02,879 --> 00:04:04,000
pinstance

104
00:04:04,000 --> 00:04:06,000
got in all the feats and that was also

105
00:04:06,000 --> 00:04:07,280
the one that distributed to the

106
00:04:07,280 --> 00:04:08,799
different teams

107
00:04:08,799 --> 00:04:10,480
so he said okay if we want to do this

108
00:04:10,480 --> 00:04:12,720
better we need to generate an

109
00:04:12,720 --> 00:04:14,640
infrastructure we need to make sure that

110
00:04:14,640 --> 00:04:16,160
we have the right policies and

111
00:04:16,160 --> 00:04:17,839
procedures set up we need to have

112
00:04:17,839 --> 00:04:19,680
everything in place now it's the first

113
00:04:19,680 --> 00:04:22,320
thing that you need to do if you want to

114
00:04:22,320 --> 00:04:24,800
set something up like that you need to

115
00:04:24,800 --> 00:04:26,880
understand who are your customers say

116
00:04:26,880 --> 00:04:28,639
who is consuming threat intelligence

117
00:04:28,639 --> 00:04:30,320
within your environment and who is

118
00:04:30,320 --> 00:04:32,080
creating threat intelligence within your

119
00:04:32,080 --> 00:04:33,040
environment

120
00:04:33,040 --> 00:04:34,400
it's going to be a different a bit

121
00:04:34,400 --> 00:04:36,320
different for all of you of course for

122
00:04:36,320 --> 00:04:38,960
us if you look at us we have our mdr

123
00:04:38,960 --> 00:04:42,560
team our sock they generate they consume

124
00:04:42,560 --> 00:04:44,240
threat intelligence our incident

125
00:04:44,240 --> 00:04:47,120
response team as well of course and yes

126
00:04:47,120 --> 00:04:49,600
the threat intelligence team themselves

127
00:04:49,600 --> 00:04:52,880
all of those have unique use cases and

128
00:04:52,880 --> 00:04:54,960
we need to make sure that whatever we

129
00:04:54,960 --> 00:04:57,120
set up whatever that we create as a

130
00:04:57,120 --> 00:05:00,000
curation procedure as an infrastructure

131
00:05:00,000 --> 00:05:01,840
that it supports all of those different

132
00:05:01,840 --> 00:05:03,120
use cases

133
00:05:03,120 --> 00:05:05,039
some high level use cases here if you

134
00:05:05,039 --> 00:05:07,280
look at our mdr team

135
00:05:07,280 --> 00:05:08,639
or soc they're of course going to use

136
00:05:08,639 --> 00:05:10,560
our indicators of compromise to do

137
00:05:10,560 --> 00:05:13,280
monitoring to do alerting to do tread

138
00:05:13,280 --> 00:05:15,280
hunting to hunt in historical logs for

139
00:05:15,280 --> 00:05:18,080
new indicators that have been seen but

140
00:05:18,080 --> 00:05:20,080
that's the consuming part they also

141
00:05:20,080 --> 00:05:21,919
generate threat intelligence every time

142
00:05:21,919 --> 00:05:23,600
they handle a case say they get in

143
00:05:23,600 --> 00:05:26,080
phishing emails they will extract the

144
00:05:26,080 --> 00:05:28,560
iocs they will anonymize it and push it

145
00:05:28,560 --> 00:05:31,120
back into the mis instance there for the

146
00:05:31,120 --> 00:05:33,440
c cert we do incident response cases

147
00:05:33,440 --> 00:05:35,759
malware analysis this goes both way this

148
00:05:35,759 --> 00:05:37,600
is using threat intelligence generating

149
00:05:37,600 --> 00:05:39,600
threat intelligence and if you look at

150
00:05:39,600 --> 00:05:42,240
the threat intel team itself

151
00:05:42,240 --> 00:05:44,160
they use threat intelligence in various

152
00:05:44,160 --> 00:05:46,560
ways of course like many of you do for

153
00:05:46,560 --> 00:05:48,720
example to support our red teams when we

154
00:05:48,720 --> 00:05:50,639
create a threat emulation plan or

155
00:05:50,639 --> 00:05:52,960
adversary emulation plans and a whole

156
00:05:52,960 --> 00:05:55,199
ton of other things there

157
00:05:55,199 --> 00:05:57,520
so one of the first things that we came

158
00:05:57,520 --> 00:06:00,160
up with the first step to solve this

159
00:06:00,160 --> 00:06:03,440
problem is we created an infrastructure

160
00:06:03,440 --> 00:06:05,840
a specific mis

161
00:06:05,840 --> 00:06:07,840
like we like to call it

162
00:06:07,840 --> 00:06:10,639
that starts with our edgemisp

163
00:06:10,639 --> 00:06:12,800
this is the edgemis this is the one that

164
00:06:12,800 --> 00:06:15,280
ingests all the feeds from all the

165
00:06:15,280 --> 00:06:17,360
different channels that we have

166
00:06:17,360 --> 00:06:18,800
open source

167
00:06:18,800 --> 00:06:20,960
closed source commercial all the

168
00:06:20,960 --> 00:06:22,639
different channels they come into the

169
00:06:22,639 --> 00:06:25,039
edgemisp there we do our curation on

170
00:06:25,039 --> 00:06:27,680
that one once we've done the curation we

171
00:06:27,680 --> 00:06:30,000
will send all of that information to our

172
00:06:30,000 --> 00:06:32,479
central mist this is our single source

173
00:06:32,479 --> 00:06:34,400
of truth this is where all the

174
00:06:34,400 --> 00:06:36,319
information is at

175
00:06:36,319 --> 00:06:38,160
now we took it a little bit further and

176
00:06:38,160 --> 00:06:40,080
we also created two separate ones one

177
00:06:40,080 --> 00:06:41,680
for the cser

178
00:06:41,680 --> 00:06:43,199
one for our sock

179
00:06:43,199 --> 00:06:45,759
why did we create those two separate

180
00:06:45,759 --> 00:06:47,840
ones why cannot we can't we just connect

181
00:06:47,840 --> 00:06:49,440
to that central one that's the single

182
00:06:49,440 --> 00:06:51,440
source of truth because if you look at

183
00:06:51,440 --> 00:06:53,280
it from an incident response perspective

184
00:06:53,280 --> 00:06:55,599
we do instant response cases for clients

185
00:06:55,599 --> 00:06:58,800
we put in their iocs it to do enrichment

186
00:06:58,800 --> 00:07:01,039
to do linking to perhaps other cases

187
00:07:01,039 --> 00:07:03,280
that we've seen but those clients might

188
00:07:03,280 --> 00:07:05,440
not want us to share those iocs with the

189
00:07:05,440 --> 00:07:07,199
community or even with the rest of the

190
00:07:07,199 --> 00:07:09,440
organization so we wanted to have a

191
00:07:09,440 --> 00:07:11,599
clear cut-off point there

192
00:07:11,599 --> 00:07:13,520
that we can keep all of that very nicely

193
00:07:13,520 --> 00:07:15,759
same goes for the for the sock

194
00:07:15,759 --> 00:07:17,440
you say keep it there we will do

195
00:07:17,440 --> 00:07:19,039
curation on everything that you put in

196
00:07:19,039 --> 00:07:21,440
there before we send it to the central

197
00:07:21,440 --> 00:07:23,039
miss again

198
00:07:23,039 --> 00:07:25,840
so that's our architecture now this does

199
00:07:25,840 --> 00:07:28,160
not solve the following problems

200
00:07:28,160 --> 00:07:30,800
the problem of potential false positives

201
00:07:30,800 --> 00:07:32,479
like we see here on the slide i hope

202
00:07:32,479 --> 00:07:34,960
it's big enough to read of course it is

203
00:07:34,960 --> 00:07:36,560
warning false positives the warning

204
00:07:36,560 --> 00:07:38,160
lists in miss

205
00:07:38,160 --> 00:07:40,000
for whoever uses mist you probably have

206
00:07:40,000 --> 00:07:42,840
seen this already it's like uh

207
00:07:42,840 --> 00:07:45,120
127.001 it's probably not something you

208
00:07:45,120 --> 00:07:47,360
want there you will get a warning list

209
00:07:47,360 --> 00:07:49,280
pop-up in your event

210
00:07:49,280 --> 00:07:50,960
so those false positives that's still

211
00:07:50,960 --> 00:07:52,400
something we need to think about still

212
00:07:52,400 --> 00:07:54,240
something we haven't solved with the

213
00:07:54,240 --> 00:07:56,240
architecture part

214
00:07:56,240 --> 00:07:59,039
next up another thing that we have with

215
00:07:59,039 --> 00:08:01,039
the events that we're getting in is the

216
00:08:01,039 --> 00:08:03,680
lack of contextualization

217
00:08:03,680 --> 00:08:04,720
right

218
00:08:04,720 --> 00:08:06,400
so probably something most of you have

219
00:08:06,400 --> 00:08:09,039
seen as well you get in an event

220
00:08:09,039 --> 00:08:13,120
has 50 ip addresses to it and it says

221
00:08:13,120 --> 00:08:14,960
phishing

222
00:08:14,960 --> 00:08:16,319
okay

223
00:08:16,319 --> 00:08:18,639
what are those ip addresses where are

224
00:08:18,639 --> 00:08:20,800
they used how are they used within the

225
00:08:20,800 --> 00:08:23,280
event so we miss a lot of context what

226
00:08:23,280 --> 00:08:24,400
we want

227
00:08:24,400 --> 00:08:26,400
for all of the analysts that use the

228
00:08:26,400 --> 00:08:28,000
information that we have within our

229
00:08:28,000 --> 00:08:30,160
systems what we want is that they look

230
00:08:30,160 --> 00:08:32,320
at the event they look at an ioc and

231
00:08:32,320 --> 00:08:34,640
they get sufficient context

232
00:08:34,640 --> 00:08:36,159
as much as possible of course that we

233
00:08:36,159 --> 00:08:37,760
can give them but have sufficient

234
00:08:37,760 --> 00:08:39,200
context on

235
00:08:39,200 --> 00:08:42,640
this ip is related to data exfiltration

236
00:08:42,640 --> 00:08:45,839
this ip is related to initial intrusion

237
00:08:45,839 --> 00:08:48,640
knowing that two very extreme parts of

238
00:08:48,640 --> 00:08:50,720
your attack life cycle knowing that will

239
00:08:50,720 --> 00:08:52,800
also change your response that you have

240
00:08:52,800 --> 00:08:54,720
on that observation so it's very

241
00:08:54,720 --> 00:08:56,560
important for us that all the analysts

242
00:08:56,560 --> 00:08:58,000
that have that threat intelligence that

243
00:08:58,000 --> 00:08:59,519
use that threat intelligence that they

244
00:08:59,519 --> 00:09:02,480
have sufficient context to make informed

245
00:09:02,480 --> 00:09:04,320
decisions on that

246
00:09:04,320 --> 00:09:07,519
another one is inconsistencies we rely

247
00:09:07,519 --> 00:09:10,560
on automation quite a bit

248
00:09:10,560 --> 00:09:12,399
if you use automation

249
00:09:12,399 --> 00:09:16,080
and you say i only want tlp white

250
00:09:16,080 --> 00:09:17,920
things sent to

251
00:09:17,920 --> 00:09:20,160
i don't know a certain system right for

252
00:09:20,160 --> 00:09:21,360
some reason

253
00:09:21,360 --> 00:09:24,320
now if you look at it here tlp white how

254
00:09:24,320 --> 00:09:26,160
is it tagged

255
00:09:26,160 --> 00:09:28,080
in your misp environment have a look in

256
00:09:28,080 --> 00:09:29,680
your own misma environment if you use

257
00:09:29,680 --> 00:09:31,760
misp or any other environment that you

258
00:09:31,760 --> 00:09:33,920
use have a look there and search for tlp

259
00:09:33,920 --> 00:09:35,640
byte you'll see there's a lot of

260
00:09:35,640 --> 00:09:37,920
inconsistencies and watch which tagging

261
00:09:37,920 --> 00:09:39,200
that we're using

262
00:09:39,200 --> 00:09:40,720
so we want to make sure that there as

263
00:09:40,720 --> 00:09:42,480
well all the tags that we use for

264
00:09:42,480 --> 00:09:44,160
automation that we use them in a

265
00:09:44,160 --> 00:09:46,640
consistent manner

266
00:09:46,640 --> 00:09:48,320
and as a final one

267
00:09:48,320 --> 00:09:50,399
are the events that we're getting in

268
00:09:50,399 --> 00:09:52,320
actionable

269
00:09:52,320 --> 00:09:55,920
80 000 indicators in one event

270
00:09:55,920 --> 00:09:58,000
is that still actionable does that

271
00:09:58,000 --> 00:10:00,640
really bring value to your organization

272
00:10:00,640 --> 00:10:02,959
there might be some really good

273
00:10:02,959 --> 00:10:05,519
indicators in there absolutely but

274
00:10:05,519 --> 00:10:07,600
there's very likely going to be a lot of

275
00:10:07,600 --> 00:10:09,600
garbage in there as well so that's also

276
00:10:09,600 --> 00:10:12,000
something we don't want so on top of the

277
00:10:12,000 --> 00:10:14,000
infrastructure that we created

278
00:10:14,000 --> 00:10:14,880
we

279
00:10:14,880 --> 00:10:17,920
also have our curation procedure and our

280
00:10:17,920 --> 00:10:20,560
creation curation procedure partly

281
00:10:20,560 --> 00:10:23,120
automated partly manual

282
00:10:23,120 --> 00:10:25,120
builds on three pillars

283
00:10:25,120 --> 00:10:27,440
well there it's a funnel

284
00:10:27,440 --> 00:10:29,360
so the first one we want to remove false

285
00:10:29,360 --> 00:10:31,920
positives we use those warning lists we

286
00:10:31,920 --> 00:10:33,600
already mentioned that one warning list

287
00:10:33,600 --> 00:10:34,959
within ms

288
00:10:34,959 --> 00:10:37,200
very good starting point what we also do

289
00:10:37,200 --> 00:10:39,920
is we create our own warning list um

290
00:10:39,920 --> 00:10:42,240
mainly the sock feeds gives us feedback

291
00:10:42,240 --> 00:10:44,000
and feedback loop i'll come back to that

292
00:10:44,000 --> 00:10:45,440
in a bit

293
00:10:45,440 --> 00:10:47,120
but the song gives us feedback saying we

294
00:10:47,120 --> 00:10:48,640
saw this this is actually a false

295
00:10:48,640 --> 00:10:49,920
positive you didn't spot it in the

296
00:10:49,920 --> 00:10:51,600
beginning but we're going to avoid

297
00:10:51,600 --> 00:10:53,440
having this false positive

298
00:10:53,440 --> 00:10:55,600
clogging up our systems over and over

299
00:10:55,600 --> 00:10:58,000
again so we use those custom warnings we

300
00:10:58,000 --> 00:11:00,399
also of course have our analyst judgment

301
00:11:00,399 --> 00:11:02,240
in the manual work that we need to do

302
00:11:02,240 --> 00:11:04,000
there so we go through all of those

303
00:11:04,000 --> 00:11:06,480
events and see okay what's going on here

304
00:11:06,480 --> 00:11:09,440
does it make sensible yes or no

305
00:11:09,440 --> 00:11:12,079
next up is adding context

306
00:11:12,079 --> 00:11:14,640
it needs to have mandatory tlp tagging

307
00:11:14,640 --> 00:11:17,200
that's one uh we also add a number of

308
00:11:17,200 --> 00:11:19,680
other tags like what's the source of the

309
00:11:19,680 --> 00:11:21,600
event where is this event coming from

310
00:11:21,600 --> 00:11:23,680
from what source organization why is

311
00:11:23,680 --> 00:11:26,160
that important bart will explain that in

312
00:11:26,160 --> 00:11:27,200
a minute

313
00:11:27,200 --> 00:11:29,519
but we also talk about okay what's the

314
00:11:29,519 --> 00:11:31,600
threat active that might be linked to it

315
00:11:31,600 --> 00:11:34,399
what mitral techniques are

316
00:11:34,399 --> 00:11:37,360
are linked to this event

317
00:11:37,360 --> 00:11:39,120
all kinds of other things again to make

318
00:11:39,120 --> 00:11:41,200
sure that the analysts that they have

319
00:11:41,200 --> 00:11:43,839
sufficient context to make an informed

320
00:11:43,839 --> 00:11:44,959
decision

321
00:11:44,959 --> 00:11:47,519
and finally we assess in a manual way

322
00:11:47,519 --> 00:11:49,600
the relevance of the event is it

323
00:11:49,600 --> 00:11:52,480
relevant to us to our organization to

324
00:11:52,480 --> 00:11:55,120
our customer base we do another sanity

325
00:11:55,120 --> 00:11:57,040
check making sure that everything is

326
00:11:57,040 --> 00:11:59,680
readily available and that we have all

327
00:11:59,680 --> 00:12:01,440
of the information before we send it off

328
00:12:01,440 --> 00:12:03,440
to that central miss you might think

329
00:12:03,440 --> 00:12:06,079
this sounds like a lot of work

330
00:12:06,079 --> 00:12:07,839
it is to set up

331
00:12:07,839 --> 00:12:10,320
but overall i think we spend about 20 to

332
00:12:10,320 --> 00:12:12,959
30 minutes a day to go through and

333
00:12:12,959 --> 00:12:14,959
process all the new events that we get

334
00:12:14,959 --> 00:12:16,880
in on a daily basis so it's a daily

335
00:12:16,880 --> 00:12:19,680
curation process that we do

336
00:12:19,680 --> 00:12:22,639
now this is all a bit manual work and my

337
00:12:22,639 --> 00:12:24,720
colleague bharti will now talk about a

338
00:12:24,720 --> 00:12:27,200
lot of the automations that we put in as

339
00:12:27,200 --> 00:12:28,480
well

340
00:12:28,480 --> 00:12:31,600
thank you michelle so indeed we'll just

341
00:12:31,600 --> 00:12:33,040
keep funneling right because it's a

342
00:12:33,040 --> 00:12:34,959
beautiful word and

343
00:12:34,959 --> 00:12:37,519
these three focal points so the context

344
00:12:37,519 --> 00:12:39,760
adding removing of false positive and

345
00:12:39,760 --> 00:12:41,920
then that quality assurance these were

346
00:12:41,920 --> 00:12:43,839
the key items that we wanted to look at

347
00:12:43,839 --> 00:12:46,720
so how do we do that in two parts well

348
00:12:46,720 --> 00:12:48,560
first of all we want to say

349
00:12:48,560 --> 00:12:51,360
okay let's do some scripting let's do an

350
00:12:51,360 --> 00:12:53,600
automatic or automated curation

351
00:12:53,600 --> 00:12:55,040
procedure right

352
00:12:55,040 --> 00:12:57,760
and one part of that is of course having

353
00:12:57,760 --> 00:13:00,160
that workflow right you first want to

354
00:13:00,160 --> 00:13:02,000
visualize this so it's clear for

355
00:13:02,000 --> 00:13:04,320
everyone how it's going to be

356
00:13:04,320 --> 00:13:06,880
so if someone new joins they can just

357
00:13:06,880 --> 00:13:08,880
check out that workflow right that flow

358
00:13:08,880 --> 00:13:10,720
chart and they can see this is how it

359
00:13:10,720 --> 00:13:12,880
works in the background

360
00:13:12,880 --> 00:13:14,880
so for that we use a bunch of scripts

361
00:13:14,880 --> 00:13:17,760
which i'll get to in just a few minutes

362
00:13:17,760 --> 00:13:20,399
so let's go to that automated curation

363
00:13:20,399 --> 00:13:23,040
parts again two parts automated and

364
00:13:23,040 --> 00:13:24,320
manual

365
00:13:24,320 --> 00:13:26,959
if you look at the automated parts again

366
00:13:26,959 --> 00:13:28,000
all these

367
00:13:28,000 --> 00:13:31,519
events come into our edgemisp so

368
00:13:31,519 --> 00:13:33,200
how do we do that those familiar with

369
00:13:33,200 --> 00:13:36,399
miss probably knows that mq or 0mq is

370
00:13:36,399 --> 00:13:38,320
basically a message queue and it allows

371
00:13:38,320 --> 00:13:40,560
to send and receive events in this kind

372
00:13:40,560 --> 00:13:41,839
of context

373
00:13:41,839 --> 00:13:45,760
so we've subscribed to zmq model

374
00:13:45,760 --> 00:13:47,920
what happens first well all these events

375
00:13:47,920 --> 00:13:50,480
they come into our hmis and we'll put

376
00:13:50,480 --> 00:13:53,279
them in an unpublished state so that

377
00:13:53,279 --> 00:13:54,480
means that

378
00:13:54,480 --> 00:13:56,160
nothing is done there it doesn't get to

379
00:13:56,160 --> 00:13:58,240
our central and for more central it

380
00:13:58,240 --> 00:14:00,720
won't go anywhere either of course

381
00:14:00,720 --> 00:14:03,600
addition into that is that we have a

382
00:14:03,600 --> 00:14:06,959
local tag called workflow incomplete

383
00:14:06,959 --> 00:14:09,600
again this is miss language but this is

384
00:14:09,600 --> 00:14:11,600
what we use we have the unpublished

385
00:14:11,600 --> 00:14:14,560
state of the event and then a local tag

386
00:14:14,560 --> 00:14:16,720
called workflow incomplete and this will

387
00:14:16,720 --> 00:14:19,279
basically tell both our scripts and an

388
00:14:19,279 --> 00:14:22,240
analyst later on to say this is not

389
00:14:22,240 --> 00:14:24,720
curated yet it's not cleared to go to

390
00:14:24,720 --> 00:14:26,480
our consumers it's not clear to go to

391
00:14:26,480 --> 00:14:28,240
the sock right

392
00:14:28,240 --> 00:14:30,959
so then we have the source and the tlp

393
00:14:30,959 --> 00:14:33,040
level of course first of all we want to

394
00:14:33,040 --> 00:14:35,600
say where is this data coming from is it

395
00:14:35,600 --> 00:14:37,360
coming from the first miss is it coming

396
00:14:37,360 --> 00:14:39,920
from circle it's going from private

397
00:14:39,920 --> 00:14:42,160
commercial and so on or is it coming

398
00:14:42,160 --> 00:14:44,320
from our internal miss sprite because of

399
00:14:44,320 --> 00:14:46,480
course we do share intelligence

400
00:14:46,480 --> 00:14:48,880
appropriately with one another

401
00:14:48,880 --> 00:14:51,199
and then finally we have that tlp

402
00:14:51,199 --> 00:14:53,839
scenarization process as well as my

403
00:14:53,839 --> 00:14:55,839
colleague michelle also explained we

404
00:14:55,839 --> 00:14:58,639
sometimes see different types of tlp

405
00:14:58,639 --> 00:15:02,639
capitals lowercase uppercase they'll be

406
00:15:02,639 --> 00:15:04,560
white whites we've seen a whole bunch of

407
00:15:04,560 --> 00:15:06,480
things so we want to strip that out and

408
00:15:06,480 --> 00:15:08,639
put them all into lowercase this will

409
00:15:08,639 --> 00:15:10,240
allow our scripts to

410
00:15:10,240 --> 00:15:13,839
work nicely together

411
00:15:13,839 --> 00:15:15,600
and then we have that manual creation

412
00:15:15,600 --> 00:15:17,600
process so this is where the analyst

413
00:15:17,600 --> 00:15:19,199
comes into play

414
00:15:19,199 --> 00:15:21,839
again we work with workflow it's in an

415
00:15:21,839 --> 00:15:24,399
unpublished state

416
00:15:24,399 --> 00:15:25,920
and first of all we will check all

417
00:15:25,920 --> 00:15:28,399
defaults positive so we have the warning

418
00:15:28,399 --> 00:15:30,480
list from misp as explained before as

419
00:15:30,480 --> 00:15:33,680
well and all our own warning lists so

420
00:15:33,680 --> 00:15:35,440
that's something that the ti team sees

421
00:15:35,440 --> 00:15:37,120
the stock team sees

422
00:15:37,120 --> 00:15:39,279
and what's fun here as well is that we

423
00:15:39,279 --> 00:15:41,600
have a script that also syncs all the

424
00:15:41,600 --> 00:15:43,440
warning lists between our different mis

425
00:15:43,440 --> 00:15:46,000
instances so it's very nice to

426
00:15:46,000 --> 00:15:47,759
have that updated list all the time

427
00:15:47,759 --> 00:15:50,079
because false positives do happen you

428
00:15:50,079 --> 00:15:52,399
can't filter on everything and this

429
00:15:52,399 --> 00:15:54,160
setup allows us to have really

430
00:15:54,160 --> 00:15:56,160
qualitative events or at least that's

431
00:15:56,160 --> 00:15:58,480
the idea

432
00:15:58,480 --> 00:15:59,199
so

433
00:15:59,199 --> 00:16:01,360
quality completeness context and

434
00:16:01,360 --> 00:16:03,440
relevance always like to bunch these

435
00:16:03,440 --> 00:16:05,279
three up together because they belong

436
00:16:05,279 --> 00:16:06,240
together

437
00:16:06,240 --> 00:16:08,079
so if you have a look at the context

438
00:16:08,079 --> 00:16:10,959
first we want to add target info right

439
00:16:10,959 --> 00:16:13,360
an event with just a bunch of ips

440
00:16:13,360 --> 00:16:15,040
domains hashes

441
00:16:15,040 --> 00:16:16,959
it doesn't really tell me anything what

442
00:16:16,959 --> 00:16:20,399
is it about which malware is used right

443
00:16:20,399 --> 00:16:23,920
which c2ip is this this is a hash of

444
00:16:23,920 --> 00:16:25,759
i don't know some malware like china

445
00:16:25,759 --> 00:16:28,160
chopper here or is it something

446
00:16:28,160 --> 00:16:29,759
completely different we don't want to

447
00:16:29,759 --> 00:16:32,160
spend half an hour figuring out what is

448
00:16:32,160 --> 00:16:34,240
this hash does is exist in i don't know

449
00:16:34,240 --> 00:16:36,800
virustotal for example but what does it

450
00:16:36,800 --> 00:16:39,680
do so we add that context

451
00:16:39,680 --> 00:16:42,079
and then we check how relevant is it

452
00:16:42,079 --> 00:16:44,399
right so after going through these first

453
00:16:44,399 --> 00:16:47,360
few steps clearing out false positives

454
00:16:47,360 --> 00:16:50,079
doing that qa how relevant is the event

455
00:16:50,079 --> 00:16:51,199
still

456
00:16:51,199 --> 00:16:53,680
if you have an event with 100 indicators

457
00:16:53,680 --> 00:16:55,759
let's say 100 attributes

458
00:16:55,759 --> 00:16:57,519
we go through this process and there's

459
00:16:57,519 --> 00:16:58,959
only one left

460
00:16:58,959 --> 00:17:02,399
is that still valuable intelligence

461
00:17:02,399 --> 00:17:04,480
any yes no

462
00:17:04,480 --> 00:17:07,199
or do you think

463
00:17:11,039 --> 00:17:13,919
bits yes no indeed it depends right it

464
00:17:13,919 --> 00:17:16,400
depends if he had context if you know

465
00:17:16,400 --> 00:17:18,959
what it's about yes then it's relevant

466
00:17:18,959 --> 00:17:21,119
then it's useful but if we can't figure

467
00:17:21,119 --> 00:17:22,160
this out

468
00:17:22,160 --> 00:17:24,319
or it's not mentioned anywhere then it

469
00:17:24,319 --> 00:17:25,760
is not useful

470
00:17:25,760 --> 00:17:27,520
so that's basically the id

471
00:17:27,520 --> 00:17:29,760
once we do that again we make use of

472
00:17:29,760 --> 00:17:32,720
that workflow tag so we set that tag to

473
00:17:32,720 --> 00:17:35,679
complete the analyst does that manually

474
00:17:35,679 --> 00:17:38,240
and then from our edgemisp it is pushed

475
00:17:38,240 --> 00:17:40,559
to our central misp and from the central

476
00:17:40,559 --> 00:17:43,200
mist then it goes through our sock or

477
00:17:43,200 --> 00:17:47,240
through our c-cert mist

478
00:17:48,240 --> 00:17:49,679
great so

479
00:17:49,679 --> 00:17:51,440
no need repeating but we'll do it here

480
00:17:51,440 --> 00:17:53,440
anyway sometimes you don't want to do

481
00:17:53,440 --> 00:17:55,600
double triple quadruple work you have

482
00:17:55,600 --> 00:17:57,200
seen events that

483
00:17:57,200 --> 00:17:59,600
well they have 80 000 indicators ninety

484
00:17:59,600 --> 00:18:01,520
thousand to a hundred thousands who has

485
00:18:01,520 --> 00:18:02,480
a million

486
00:18:02,480 --> 00:18:04,640
anyways so that's not something you want

487
00:18:04,640 --> 00:18:06,640
to keep doing so

488
00:18:06,640 --> 00:18:08,880
we have implemented a sort of offender

489
00:18:08,880 --> 00:18:11,360
list mechanism that means that

490
00:18:11,360 --> 00:18:13,760
if an organization pushes way too many

491
00:18:13,760 --> 00:18:16,240
indicators for it to be useful or never

492
00:18:16,240 --> 00:18:18,240
adds any relevance never adds any

493
00:18:18,240 --> 00:18:21,120
context or it's basically just

494
00:18:21,120 --> 00:18:23,120
a bunch of false positives all the time

495
00:18:23,120 --> 00:18:24,320
because they don't have their own

496
00:18:24,320 --> 00:18:26,320
creation procedure then we'll put them

497
00:18:26,320 --> 00:18:28,640
on a sort of offender list let's say

498
00:18:28,640 --> 00:18:31,039
if you have more than five strikes then

499
00:18:31,039 --> 00:18:33,600
we put you on the block list so to speak

500
00:18:33,600 --> 00:18:34,880
now

501
00:18:34,880 --> 00:18:36,960
you might think okay but will you not

502
00:18:36,960 --> 00:18:39,840
miss out on intel perhaps but you need

503
00:18:39,840 --> 00:18:41,840
to make that bounce between doing the

504
00:18:41,840 --> 00:18:44,559
cleanup all the time every day

505
00:18:44,559 --> 00:18:47,919
or having actual valuable intelligence

506
00:18:47,919 --> 00:18:50,559
with context-rich data

507
00:18:50,559 --> 00:18:52,799
so we also sync these between the

508
00:18:52,799 --> 00:18:55,360
different mips so if the stock says okay

509
00:18:55,360 --> 00:18:57,919
we have seen this organization spam us

510
00:18:57,919 --> 00:19:00,320
all the time with 8888 somehow that got

511
00:19:00,320 --> 00:19:02,240
true shouldn't really be possible but

512
00:19:02,240 --> 00:19:04,160
anyway as an example

513
00:19:04,160 --> 00:19:07,679
then they can also block that

514
00:19:07,919 --> 00:19:09,600
of course for some statistics you might

515
00:19:09,600 --> 00:19:12,320
wonder what have you done so far well we

516
00:19:12,320 --> 00:19:14,160
did this setup around the same time last

517
00:19:14,160 --> 00:19:15,840
year may june

518
00:19:15,840 --> 00:19:16,640
and

519
00:19:16,640 --> 00:19:18,640
these are just a few statistics from our

520
00:19:18,640 --> 00:19:21,919
miss dashboard we have curated vrs

521
00:19:21,919 --> 00:19:22,960
process

522
00:19:22,960 --> 00:19:25,679
automatic and manual more than 3000

523
00:19:25,679 --> 00:19:26,720
events

524
00:19:26,720 --> 00:19:29,120
which bears over 2 million attributes in

525
00:19:29,120 --> 00:19:32,640
total so we have done that analysis work

526
00:19:32,640 --> 00:19:34,480
and that procedure for over 2 million

527
00:19:34,480 --> 00:19:35,919
attributes that's

528
00:19:35,919 --> 00:19:37,440
quite a bunch

529
00:19:37,440 --> 00:19:39,120
and we have block listed 16

530
00:19:39,120 --> 00:19:42,080
organizations out of almost 600 that are

531
00:19:42,080 --> 00:19:44,640
connected to our misp i think it's

532
00:19:44,640 --> 00:19:46,400
viable percentage

533
00:19:46,400 --> 00:19:49,039
i think it's pretty fair

534
00:19:49,039 --> 00:19:49,919
so

535
00:19:49,919 --> 00:19:51,760
then you might think okay that's all

536
00:19:51,760 --> 00:19:53,360
great all these talks about scripts and

537
00:19:53,360 --> 00:19:56,640
automation but show the scripts okay no

538
00:19:56,640 --> 00:19:59,280
problem so a bunch of scripts here false

539
00:19:59,280 --> 00:20:02,640
positives relevant indicators scrape

540
00:20:02,640 --> 00:20:04,799
different web sources and of course

541
00:20:04,799 --> 00:20:07,520
finally block delete events

542
00:20:07,520 --> 00:20:09,919
so the first one is removing those false

543
00:20:09,919 --> 00:20:12,240
positives how does that work

544
00:20:12,240 --> 00:20:14,240
well first of all we have our own

545
00:20:14,240 --> 00:20:17,360
warning list and those of misp of course

546
00:20:17,360 --> 00:20:19,919
the second is that we use the nsrl so

547
00:20:19,919 --> 00:20:22,159
the national software reference library

548
00:20:22,159 --> 00:20:24,799
as well to ping against and to check do

549
00:20:24,799 --> 00:20:26,880
we know this hash is it goodwear is it

550
00:20:26,880 --> 00:20:29,760
bad where and so on in addition we use

551
00:20:29,760 --> 00:20:32,080
circles lookup as well i believe there

552
00:20:32,080 --> 00:20:34,000
was a workshop yesterday from circle

553
00:20:34,000 --> 00:20:36,320
regarding hash look up so if you visited

554
00:20:36,320 --> 00:20:38,080
that one you'll know what this is about

555
00:20:38,080 --> 00:20:38,799
but

556
00:20:38,799 --> 00:20:41,760
it also aggregates a ton of sources like

557
00:20:41,760 --> 00:20:44,880
windows for example to create a list of

558
00:20:44,880 --> 00:20:48,960
goods and bad hashes or files to hashes

559
00:20:48,960 --> 00:20:51,039
now one fun thing is here that in the

560
00:20:51,039 --> 00:20:52,799
beginning we had said

561
00:20:52,799 --> 00:20:55,520
using that script we will just remove

562
00:20:55,520 --> 00:20:58,080
the hashes from our events

563
00:20:58,080 --> 00:20:58,880
now

564
00:20:58,880 --> 00:21:01,679
this turned out to be an issue once

565
00:21:01,679 --> 00:21:03,840
what happened in the nsrl for some

566
00:21:03,840 --> 00:21:06,480
reason a mimikat's binary was flagged

567
00:21:06,480 --> 00:21:09,039
this is good wear it's okay

568
00:21:09,039 --> 00:21:10,799
if you don't know mimikatz is a

569
00:21:10,799 --> 00:21:12,640
offensive security tool and you

570
00:21:12,640 --> 00:21:14,080
definitely don't want to be hanging

571
00:21:14,080 --> 00:21:17,760
around the sock or your clients

572
00:21:17,760 --> 00:21:20,240
so we kind of fixed that by saying just

573
00:21:20,240 --> 00:21:23,679
tag an srl so we can just visually see

574
00:21:23,679 --> 00:21:26,559
does this exist in the database or not

575
00:21:26,559 --> 00:21:28,400
the second part or the second script is

576
00:21:28,400 --> 00:21:31,200
relevant indicators so of course you

577
00:21:31,200 --> 00:21:32,480
might think

578
00:21:32,480 --> 00:21:34,240
all those events all those two million

579
00:21:34,240 --> 00:21:36,640
attributes at some point it might stop

580
00:21:36,640 --> 00:21:39,600
being relevant right so what do we have

581
00:21:39,600 --> 00:21:41,679
we have a decaying script that says

582
00:21:41,679 --> 00:21:44,480
after these periods of time decay the

583
00:21:44,480 --> 00:21:47,200
actionability of the indicators that

584
00:21:47,200 --> 00:21:49,440
means that that's ids flag which my

585
00:21:49,440 --> 00:21:50,640
colleague michelle was talking about

586
00:21:50,640 --> 00:21:53,120
earlier it gets ticked off

587
00:21:53,120 --> 00:21:55,520
so it won't alert anymore but it will

588
00:21:55,520 --> 00:21:57,760
still exist as intelligence because it's

589
00:21:57,760 --> 00:22:00,080
still good to refer back to these older

590
00:22:00,080 --> 00:22:01,679
campaigns

591
00:22:01,679 --> 00:22:03,360
that's one part

592
00:22:03,360 --> 00:22:05,280
you might wonder what do you do exactly

593
00:22:05,280 --> 00:22:07,919
what are those days well we decay ips

594
00:22:07,919 --> 00:22:09,840
much faster than domains for the simple

595
00:22:09,840 --> 00:22:12,080
reason that domains are more static as

596
00:22:12,080 --> 00:22:15,199
opposed to ips

597
00:22:15,520 --> 00:22:18,720
script rep sources

598
00:22:19,360 --> 00:22:20,320
okay

599
00:22:20,320 --> 00:22:21,360
so

600
00:22:21,360 --> 00:22:23,360
all those security blocks

601
00:22:23,360 --> 00:22:24,400
we know

602
00:22:24,400 --> 00:22:26,000
the usual suspects but there might be

603
00:22:26,000 --> 00:22:28,960
some more altruistic or arcane

604
00:22:28,960 --> 00:22:30,080
malware

605
00:22:30,080 --> 00:22:32,400
archaeology or whatever you wish as well

606
00:22:32,400 --> 00:22:34,240
out there some more intelligence that

607
00:22:34,240 --> 00:22:36,799
it's not perhaps as known to most people

608
00:22:36,799 --> 00:22:38,559
so we put a scraper on there that just

609
00:22:38,559 --> 00:22:39,440
says

610
00:22:39,440 --> 00:22:42,000
give me all the iocs from this webpage

611
00:22:42,000 --> 00:22:44,400
that's it it gets put into our misp and

612
00:22:44,400 --> 00:22:46,799
of course that creation procedure still

613
00:22:46,799 --> 00:22:49,440
applies but this way we don't miss out

614
00:22:49,440 --> 00:22:51,919
on tread intel

615
00:22:51,919 --> 00:22:54,159
and then block delete events you always

616
00:22:54,159 --> 00:22:56,159
need to have a backup what if something

617
00:22:56,159 --> 00:22:58,720
goes wrong what if hypothetically of

618
00:22:58,720 --> 00:23:01,039
course 80 000 indicators get up in your

619
00:23:01,039 --> 00:23:02,799
misp well you need to have a plan to

620
00:23:02,799 --> 00:23:04,480
delete that so

621
00:23:04,480 --> 00:23:06,799
again we created a script that says

622
00:23:06,799 --> 00:23:09,840
from this organization this uid deletes

623
00:23:09,840 --> 00:23:11,200
all the events

624
00:23:11,200 --> 00:23:14,640
or we just feed the script an event id

625
00:23:14,640 --> 00:23:16,799
and it will just get deleted via the

626
00:23:16,799 --> 00:23:19,120
console because sometimes if you have

627
00:23:19,120 --> 00:23:21,440
this overflow or if you have an event

628
00:23:21,440 --> 00:23:24,000
that has a lot of relationships you know

629
00:23:24,000 --> 00:23:25,840
what will happen your miss will not be

630
00:23:25,840 --> 00:23:28,480
accessible anymore so you need to go via

631
00:23:28,480 --> 00:23:32,799
console and execute one of the scripts

632
00:23:32,799 --> 00:23:34,159
great so

633
00:23:34,159 --> 00:23:36,480
just a few of the lessons learned as i

634
00:23:36,480 --> 00:23:39,039
said before we set this up

635
00:23:39,039 --> 00:23:40,480
somewhere around last year at the same

636
00:23:40,480 --> 00:23:41,279
time

637
00:23:41,279 --> 00:23:42,000
but

638
00:23:42,000 --> 00:23:43,520
what did we learn from this kind of

639
00:23:43,520 --> 00:23:46,400
setup well the first part is tooling

640
00:23:46,400 --> 00:23:48,559
work with what you have but also know

641
00:23:48,559 --> 00:23:50,480
what you have right what is your use

642
00:23:50,480 --> 00:23:53,039
case why do you want to do threat intel

643
00:23:53,039 --> 00:23:55,120
what do you already have on your hands

644
00:23:55,120 --> 00:23:57,520
perhaps you already have a misp so you

645
00:23:57,520 --> 00:23:59,679
can do a similar system as here you can

646
00:23:59,679 --> 00:24:01,440
set up an edge miss to receive all the

647
00:24:01,440 --> 00:24:03,840
events and do the creation procedure and

648
00:24:03,840 --> 00:24:06,480
then a central misp that is then your

649
00:24:06,480 --> 00:24:09,039
well source of truth let's say

650
00:24:09,039 --> 00:24:11,600
what else extent what is available and

651
00:24:11,600 --> 00:24:13,360
automate where you can so all these

652
00:24:13,360 --> 00:24:15,520
scripts that we created there's a few

653
00:24:15,520 --> 00:24:17,600
more as well but it really helps in

654
00:24:17,600 --> 00:24:20,880
making our ti flow really efficient

655
00:24:20,880 --> 00:24:23,200
very context rich and of course always

656
00:24:23,200 --> 00:24:24,320
actionable

657
00:24:24,320 --> 00:24:25,360
and

658
00:24:25,360 --> 00:24:27,679
at least that's our assumption and we

659
00:24:27,679 --> 00:24:29,520
hope but that the sock doesn't poke us

660
00:24:29,520 --> 00:24:31,360
every day and says hey this is a false

661
00:24:31,360 --> 00:24:32,480
positive

662
00:24:32,480 --> 00:24:34,720
and after this procedure i can say that

663
00:24:34,720 --> 00:24:36,559
that doesn't happen

664
00:24:36,559 --> 00:24:38,480
so there's two other key items which my

665
00:24:38,480 --> 00:24:41,520
colleague michelle will also zoom in on

666
00:24:41,520 --> 00:24:42,320
yes

667
00:24:42,320 --> 00:24:44,240
so for the next one it's

668
00:24:44,240 --> 00:24:46,480
it's actually everybody's favorite thing

669
00:24:46,480 --> 00:24:50,480
to do day in day out it's documentation

670
00:24:50,480 --> 00:24:51,440
right

671
00:24:51,440 --> 00:24:54,320
so documentation is very important it's

672
00:24:54,320 --> 00:24:55,840
a good lesson learned was a good lesson

673
00:24:55,840 --> 00:24:57,840
learned for us as well but you need to

674
00:24:57,840 --> 00:25:00,000
have proper documentation on everything

675
00:25:00,000 --> 00:25:02,880
that you've done as we've seen this is a

676
00:25:02,880 --> 00:25:03,919
shared

677
00:25:03,919 --> 00:25:06,400
automatic and manual process meaning

678
00:25:06,400 --> 00:25:08,080
that you want to document everything

679
00:25:08,080 --> 00:25:09,760
that you set up in terms of

680
00:25:09,760 --> 00:25:12,320
infrastructure communication flows but

681
00:25:12,320 --> 00:25:14,159
also on the manual processes that you

682
00:25:14,159 --> 00:25:17,600
need to execute on a daily basis

683
00:25:17,600 --> 00:25:19,919
bart knows very well on how to do that

684
00:25:19,919 --> 00:25:23,360
curation he does it every week every day

685
00:25:23,360 --> 00:25:24,799
he does that curation he goes through

686
00:25:24,799 --> 00:25:26,559
those events now we have some other

687
00:25:26,559 --> 00:25:28,559
colleagues coming in as well we want

688
00:25:28,559 --> 00:25:30,480
them to take over from bart from time to

689
00:25:30,480 --> 00:25:32,720
time yes from time to time bar takes

690
00:25:32,720 --> 00:25:34,960
some holidays so somebody else needs to

691
00:25:34,960 --> 00:25:36,880
step in so we want to make sure that all

692
00:25:36,880 --> 00:25:39,440
of that is very properly documented so

693
00:25:39,440 --> 00:25:42,640
that everybody can do this curation but

694
00:25:42,640 --> 00:25:44,640
that also if something goes wrong and

695
00:25:44,640 --> 00:25:46,559
you need to troubleshoot you want to

696
00:25:46,559 --> 00:25:49,360
know okay how was this set up who did

697
00:25:49,360 --> 00:25:52,640
this who set this up and so forth

698
00:25:52,640 --> 00:25:54,840
another one another favorite one is

699
00:25:54,840 --> 00:25:57,200
communication this is what i hinted on

700
00:25:57,200 --> 00:25:59,360
in the beginning already you want to

701
00:25:59,360 --> 00:26:01,440
talk to your stakeholders you want to

702
00:26:01,440 --> 00:26:04,960
understand what's very important to you

703
00:26:04,960 --> 00:26:06,799
what do you get out of it

704
00:26:06,799 --> 00:26:08,400
we might be thinking

705
00:26:08,400 --> 00:26:11,200
we're doing an awesome job in

706
00:26:11,200 --> 00:26:12,640
making sure that we're not sending any

707
00:26:12,640 --> 00:26:15,360
false positives to the sock

708
00:26:15,360 --> 00:26:17,039
now the stock might be saying yes

709
00:26:17,039 --> 00:26:18,559
there's no false positives but there's

710
00:26:18,559 --> 00:26:20,480
no true positive cedar because in the

711
00:26:20,480 --> 00:26:22,480
last six months you send us 50

712
00:26:22,480 --> 00:26:23,679
indicators

713
00:26:23,679 --> 00:26:26,159
we're doing a great job right zero false

714
00:26:26,159 --> 00:26:28,000
positives everything is excellently

715
00:26:28,000 --> 00:26:30,720
curated but do we bring value

716
00:26:30,720 --> 00:26:33,360
not really so you really want to engage

717
00:26:33,360 --> 00:26:34,960
in that interaction with all your

718
00:26:34,960 --> 00:26:37,440
stakeholders does it work for you what

719
00:26:37,440 --> 00:26:39,520
are you saying what are you missing

720
00:26:39,520 --> 00:26:41,679
still you might be saying okay

721
00:26:41,679 --> 00:26:43,760
we give sufficient context they might be

722
00:26:43,760 --> 00:26:45,520
saying well the context that you're

723
00:26:45,520 --> 00:26:47,360
giving is irrelevant to us you want to

724
00:26:47,360 --> 00:26:49,679
be aware of that communication between

725
00:26:49,679 --> 00:26:51,760
all the stakeholders is really really

726
00:26:51,760 --> 00:26:55,919
important cannot emphasize this enough

727
00:26:56,880 --> 00:26:59,120
as we mentioned we still have some work

728
00:26:59,120 --> 00:27:00,159
to do

729
00:27:00,159 --> 00:27:01,760
i would like to say that we're now in a

730
00:27:01,760 --> 00:27:03,919
good alpha state of this project we're

731
00:27:03,919 --> 00:27:05,919
here about a year running this and it

732
00:27:05,919 --> 00:27:07,919
runs okay but there's still some things

733
00:27:07,919 --> 00:27:09,760
on our roadmap that we want to do before

734
00:27:09,760 --> 00:27:12,640
we go we go to a beta or a final state

735
00:27:12,640 --> 00:27:14,559
in this one if we ever reach a final

736
00:27:14,559 --> 00:27:15,840
state of course

737
00:27:15,840 --> 00:27:18,000
one of the first things that we want to

738
00:27:18,000 --> 00:27:21,200
look at are those new misp workflows

739
00:27:21,200 --> 00:27:24,640
i'll be very honest i saw this image

740
00:27:24,640 --> 00:27:27,440
and the blog around this two weeks ago

741
00:27:27,440 --> 00:27:29,760
so we haven't tested this yet but it

742
00:27:29,760 --> 00:27:31,919
looks really interesting this is

743
00:27:31,919 --> 00:27:34,159
automation in mist doing automation in

744
00:27:34,159 --> 00:27:36,720
mis which means that we could build some

745
00:27:36,720 --> 00:27:39,520
automation workflows of the scripts that

746
00:27:39,520 --> 00:27:42,000
we have created already which would make

747
00:27:42,000 --> 00:27:45,200
it a lot easier to in the end share this

748
00:27:45,200 --> 00:27:47,200
also with the community so that we don't

749
00:27:47,200 --> 00:27:49,120
have like really custom stuff for

750
00:27:49,120 --> 00:27:51,120
ourselves but that we work with those

751
00:27:51,120 --> 00:27:53,120
workflows so that's something that's on

752
00:27:53,120 --> 00:27:56,399
the roadmap to further investigate

753
00:27:56,399 --> 00:27:58,720
and talking about that community parts

754
00:27:58,720 --> 00:28:01,600
michelle of course you're all thinking

755
00:28:01,600 --> 00:28:04,159
are you going to share any of this well

756
00:28:04,159 --> 00:28:06,480
the answer is yes we'll do that in two

757
00:28:06,480 --> 00:28:08,960
ways the first way is contributing back

758
00:28:08,960 --> 00:28:11,600
to the community by reporting on these

759
00:28:11,600 --> 00:28:14,480
false positives that we see reporting on

760
00:28:14,480 --> 00:28:16,240
context that we might give and that

761
00:28:16,240 --> 00:28:18,240
might be useful to all of you in the

762
00:28:18,240 --> 00:28:19,919
room and to all the other organizations

763
00:28:19,919 --> 00:28:22,159
out there so we will do that via the

764
00:28:22,159 --> 00:28:24,880
event proposals using the ms system and

765
00:28:24,880 --> 00:28:27,440
via sightings process as well

766
00:28:27,440 --> 00:28:28,880
before we do that

767
00:28:28,880 --> 00:28:31,120
we first want to mature a bit more so we

768
00:28:31,120 --> 00:28:33,840
go into a better phase so to speak and

769
00:28:33,840 --> 00:28:36,159
then we will do that active contribution

770
00:28:36,159 --> 00:28:38,320
back to the community back to you as

771
00:28:38,320 --> 00:28:41,360
well so that we can all profit from that

772
00:28:41,360 --> 00:28:43,440
now one other thing that we will be

773
00:28:43,440 --> 00:28:46,080
looking at is announcements so we will

774
00:28:46,080 --> 00:28:48,399
probably look at implementing a sort of

775
00:28:48,399 --> 00:28:51,200
bots discord slack themes whatever you

776
00:28:51,200 --> 00:28:53,760
use that says in the morning for example

777
00:28:53,760 --> 00:28:54,559
hey

778
00:28:54,559 --> 00:28:56,320
these events have come in into the edge

779
00:28:56,320 --> 00:28:58,799
missed let's say 50 are ready to be

780
00:28:58,799 --> 00:28:59,919
curated

781
00:28:59,919 --> 00:29:01,440
here's an issue with one of these

782
00:29:01,440 --> 00:29:03,520
because there was no tlp tag but the

783
00:29:03,520 --> 00:29:05,679
script has edited that's what we're

784
00:29:05,679 --> 00:29:07,360
going to look at in the future so we

785
00:29:07,360 --> 00:29:10,000
want to add sort of bots that makes it

786
00:29:10,000 --> 00:29:12,320
really easy to say here's what's going

787
00:29:12,320 --> 00:29:14,559
on in the mist this morning

788
00:29:14,559 --> 00:29:15,919
after a weekend

789
00:29:15,919 --> 00:29:18,240
it's nice to see that and what you can

790
00:29:18,240 --> 00:29:20,080
expect

791
00:29:20,080 --> 00:29:22,399
and then open source the scripts so all

792
00:29:22,399 --> 00:29:24,640
these scripts that we have here and some

793
00:29:24,640 --> 00:29:26,720
others as well yes we will also put

794
00:29:26,720 --> 00:29:28,960
these on our github in the future but

795
00:29:28,960 --> 00:29:30,480
first we just want to polish them up a

796
00:29:30,480 --> 00:29:32,960
bit we want to generalize them because

797
00:29:32,960 --> 00:29:35,679
now of course it's quite custom to our

798
00:29:35,679 --> 00:29:38,480
environment and well to how we have done

799
00:29:38,480 --> 00:29:40,720
this full architectural setup but of

800
00:29:40,720 --> 00:29:42,880
course we will be sharing this back on

801
00:29:42,880 --> 00:29:45,679
our github as well and the link is there

802
00:29:45,679 --> 00:29:48,000
if you want to check it out

803
00:29:48,000 --> 00:29:49,200
now

804
00:29:49,200 --> 00:29:50,399
that brings us to the end of our

805
00:29:50,399 --> 00:29:52,080
presentation so

806
00:29:52,080 --> 00:29:54,159
thank you all for joining and we hope if

807
00:29:54,159 --> 00:29:56,399
you have any questions that you fire

808
00:29:56,399 --> 00:29:59,360
away thank you

809
00:30:03,039 --> 00:30:05,679
thank you new zealand bart and

810
00:30:05,679 --> 00:30:07,919
questions we have a microphone over here

811
00:30:07,919 --> 00:30:10,159
there's one over there please step up

812
00:30:10,159 --> 00:30:11,200
and

813
00:30:11,200 --> 00:30:14,080
ask your questions

814
00:30:14,080 --> 00:30:16,320
yep

815
00:30:16,880 --> 00:30:20,000
who will be the quickest you were

816
00:30:20,000 --> 00:30:21,919
well thank you very much uh jerry boyce

817
00:30:21,919 --> 00:30:24,399
from bos luxembourg uh it was very

818
00:30:24,399 --> 00:30:25,840
interesting and very actually

819
00:30:25,840 --> 00:30:27,679
interesting process uh to actually

820
00:30:27,679 --> 00:30:29,600
enhance the quality of the the threat

821
00:30:29,600 --> 00:30:32,640
intelligence but uh my question is uh

822
00:30:32,640 --> 00:30:34,960
despite actually all these measures is

823
00:30:34,960 --> 00:30:37,600
there any actually uh false positive

824
00:30:37,600 --> 00:30:39,440
which is remaining after all the process

825
00:30:39,440 --> 00:30:40,399
has been

826
00:30:40,399 --> 00:30:43,120
uh made from end to end or actually this

827
00:30:43,120 --> 00:30:46,159
is a you arrive to a rate or to of a

828
00:30:46,159 --> 00:30:48,960
zero a false positive at the end

829
00:30:48,960 --> 00:30:50,159
thank you

830
00:30:50,159 --> 00:30:51,679
thank you for your question uh

831
00:30:51,679 --> 00:30:54,080
unfortunately we're not at the zero

832
00:30:54,080 --> 00:30:56,720
false positive rate yet um

833
00:30:56,720 --> 00:30:58,240
has it gone down

834
00:30:58,240 --> 00:31:00,880
yes drastically where we would get

835
00:31:00,880 --> 00:31:03,200
pretty much notifications from our sock

836
00:31:03,200 --> 00:31:05,360
on pretty much a daily basis saying out

837
00:31:05,360 --> 00:31:08,000
this alert and this hit and this hit we

838
00:31:08,000 --> 00:31:09,679
now have it

839
00:31:09,679 --> 00:31:12,320
once a week once every two weeks

840
00:31:12,320 --> 00:31:14,720
coincidentally i received a message this

841
00:31:14,720 --> 00:31:16,840
morning that there was something there

842
00:31:16,840 --> 00:31:19,519
um it was something that was seen in a

843
00:31:19,519 --> 00:31:20,640
fishing

844
00:31:20,640 --> 00:31:22,720
to uh to where the the

845
00:31:22,720 --> 00:31:24,640
malicious document was downloaded from

846
00:31:24,640 --> 00:31:26,799
but it's also used broadly in other

847
00:31:26,799 --> 00:31:28,240
places

848
00:31:28,240 --> 00:31:30,320
we're working on that and that's also

849
00:31:30,320 --> 00:31:32,240
where that feedback loop from the sock

850
00:31:32,240 --> 00:31:33,760
comes in just to make sure that okay

851
00:31:33,760 --> 00:31:36,559
we've seen that before we don't want to

852
00:31:36,559 --> 00:31:38,559
well hit our foot on the same stone

853
00:31:38,559 --> 00:31:40,559
twice so that's where that feedback loop

854
00:31:40,559 --> 00:31:42,880
comes in we're not at zero percent false

855
00:31:42,880 --> 00:31:44,880
post i don't think will ever be there

856
00:31:44,880 --> 00:31:47,440
but as long as we drastically reduce

857
00:31:47,440 --> 00:31:48,880
those false positives we're already

858
00:31:48,880 --> 00:31:50,480
happy and the sock is happy as well

859
00:31:50,480 --> 00:31:52,320
let's go very good thank you very much

860
00:31:52,320 --> 00:31:54,480
thank you

861
00:31:54,480 --> 00:31:55,679
okay

862
00:31:55,679 --> 00:31:58,640
perfect i'm rusty from linkedin um so

863
00:31:58,640 --> 00:31:59,840
you mentioned that you had somewhere in

864
00:31:59,840 --> 00:32:00,799
the neighborhood of i think it was like

865
00:32:00,799 --> 00:32:02,080
two and a half million indicators in

866
00:32:02,080 --> 00:32:03,120
your uh

867
00:32:03,120 --> 00:32:05,279
instance right now um one of the

868
00:32:05,279 --> 00:32:06,880
challenges is working at a big company

869
00:32:06,880 --> 00:32:10,080
is i think i have 13 million in my

870
00:32:10,080 --> 00:32:12,840
uh repository currently but how do

871
00:32:12,840 --> 00:32:15,519
you what are some tips and tricks in

872
00:32:15,519 --> 00:32:17,360
terms of getting sort of that raw

873
00:32:17,360 --> 00:32:19,919
indicator set into a nice curated misp

874
00:32:19,919 --> 00:32:21,760
instance when just the scale is so

875
00:32:21,760 --> 00:32:23,679
ridiculous

876
00:32:23,679 --> 00:32:25,760
that's a very good question i mean

877
00:32:25,760 --> 00:32:28,000
obviously again you should work with the

878
00:32:28,000 --> 00:32:29,519
tools that you have but the first thing

879
00:32:29,519 --> 00:32:31,840
that we did is before we had this full

880
00:32:31,840 --> 00:32:35,039
procedure we had the same thing as you

881
00:32:35,039 --> 00:32:35,840
so

882
00:32:35,840 --> 00:32:37,919
we had one misp and with a lot of

883
00:32:37,919 --> 00:32:39,919
indicators more than two million that we

884
00:32:39,919 --> 00:32:42,240
have now so we basically reinvented

885
00:32:42,240 --> 00:32:44,720
ourselves so we set up this whole thing

886
00:32:44,720 --> 00:32:47,120
from scratch and then started a really

887
00:32:47,120 --> 00:32:49,919
good creation procedure here and it also

888
00:32:49,919 --> 00:32:53,039
trims down on those indicators because

889
00:32:53,039 --> 00:32:55,760
if you just put everything in one

890
00:32:55,760 --> 00:32:57,919
well central location let's say without

891
00:32:57,919 --> 00:33:01,440
procedure you'll have a ton now

892
00:33:01,440 --> 00:33:03,519
to have that more

893
00:33:03,519 --> 00:33:05,279
it's always like that balance again

894
00:33:05,279 --> 00:33:08,080
right what is useful and what is not for

895
00:33:08,080 --> 00:33:10,640
that i think the decaying plays a big

896
00:33:10,640 --> 00:33:11,519
part

897
00:33:11,519 --> 00:33:14,480
so all that data that intelligence still

898
00:33:14,480 --> 00:33:16,000
stays in your misp

899
00:33:16,000 --> 00:33:18,480
but it's not actionable anymore so you

900
00:33:18,480 --> 00:33:21,039
have no risk of having those really

901
00:33:21,039 --> 00:33:23,039
brutal false positives hit you after a

902
00:33:23,039 --> 00:33:24,480
while

903
00:33:24,480 --> 00:33:25,519
of course

904
00:33:25,519 --> 00:33:27,919
the more organizations that come or that

905
00:33:27,919 --> 00:33:30,000
are connected the more indicators that

906
00:33:30,000 --> 00:33:31,760
you have the more reports

907
00:33:31,760 --> 00:33:34,960
it gets filled up quite fast but

908
00:33:34,960 --> 00:33:37,120
it's not a problem to solve i think but

909
00:33:37,120 --> 00:33:39,519
one part of that is already just redo

910
00:33:39,519 --> 00:33:41,919
your infrastructure start from scratch

911
00:33:41,919 --> 00:33:44,159
and see what you take over from before

912
00:33:44,159 --> 00:33:47,760
things from 2013 are they still useful

913
00:33:47,760 --> 00:33:49,919
perhaps in a historical context should

914
00:33:49,919 --> 00:33:51,600
you add them again now

915
00:33:51,600 --> 00:33:53,760
probably not probably not on your new

916
00:33:53,760 --> 00:33:55,120
live misp

917
00:33:55,120 --> 00:33:56,320
cool thanks

918
00:33:56,320 --> 00:33:58,639
welcome

919
00:33:59,919 --> 00:34:01,200
thank you for the presentation my name

920
00:34:01,200 --> 00:34:03,440
is aiden from cert is

921
00:34:03,440 --> 00:34:05,120
from my understanding in the curation

922
00:34:05,120 --> 00:34:07,919
process you're editing existing events

923
00:34:07,919 --> 00:34:10,239
and putting them onto your central miss

924
00:34:10,239 --> 00:34:12,639
i was wondering how it works like after

925
00:34:12,639 --> 00:34:15,440
you've done a curation for an event from

926
00:34:15,440 --> 00:34:17,280
some other organization

927
00:34:17,280 --> 00:34:19,359
and then that organization pushes out an

928
00:34:19,359 --> 00:34:22,079
update how is the process from like the

929
00:34:22,079 --> 00:34:25,679
updated event to your curated event

930
00:34:25,679 --> 00:34:27,599
very good question it's actually just

931
00:34:27,599 --> 00:34:30,159
the same thing so if an awk pushes an

932
00:34:30,159 --> 00:34:33,040
update it gets back into our edgemisp

933
00:34:33,040 --> 00:34:34,639
and then the creation procedure starts

934
00:34:34,639 --> 00:34:37,199
again so we don't have a risk of hey

935
00:34:37,199 --> 00:34:39,440
they added new indicators

936
00:34:39,440 --> 00:34:41,199
but there's a false positive in there

937
00:34:41,199 --> 00:34:43,040
but we don't know no that's not how it

938
00:34:43,040 --> 00:34:45,040
works because it ends up in our etch

939
00:34:45,040 --> 00:34:47,040
misbegan and there we do that creation

940
00:34:47,040 --> 00:34:50,399
procedure so even indeed if they update

941
00:34:50,399 --> 00:34:52,480
an event with a bunch of new stuff that

942
00:34:52,480 --> 00:34:55,119
happens we've seen events from 2015 get

943
00:34:55,119 --> 00:34:58,000
updated with new stuff well then it just

944
00:34:58,000 --> 00:35:00,800
goes through creation procedure again

945
00:35:00,800 --> 00:35:04,240
thank you okay okay

946
00:35:04,240 --> 00:35:07,200
i think we're nearing the last question

947
00:35:07,200 --> 00:35:09,520
time is running out so yeah

948
00:35:09,520 --> 00:35:11,680
a quick question um thanks for the

949
00:35:11,680 --> 00:35:13,440
presentation um

950
00:35:13,440 --> 00:35:15,119
the question uh one of the slides that

951
00:35:15,119 --> 00:35:17,920
you have is on expiring of iocs what's

952
00:35:17,920 --> 00:35:20,480
the recommended uh duration that you

953
00:35:20,480 --> 00:35:21,839
expire and one of the biggest problems

954
00:35:21,839 --> 00:35:23,040
that we have is

955
00:35:23,040 --> 00:35:25,760
because we don't expire it in in default

956
00:35:25,760 --> 00:35:27,839
so that you know the ioc will just build

957
00:35:27,839 --> 00:35:30,079
up in the database so what is the

958
00:35:30,079 --> 00:35:31,440
recommendation that you have for

959
00:35:31,440 --> 00:35:33,920
expiring the iocs

960
00:35:33,920 --> 00:35:35,920
i would say depends on your use case

961
00:35:35,920 --> 00:35:37,280
really how

962
00:35:37,280 --> 00:35:39,280
i mean how mature is your stock if it's

963
00:35:39,280 --> 00:35:41,280
really mature you can leave it a bit

964
00:35:41,280 --> 00:35:43,440
longer but you don't want to have that

965
00:35:43,440 --> 00:35:46,160
alert fatigue in the sock so what we do

966
00:35:46,160 --> 00:35:48,960
for ip addresses for example it's 30

967
00:35:48,960 --> 00:35:49,839
days

968
00:35:49,839 --> 00:35:53,040
for domains we do 60 days and for hashes

969
00:35:53,040 --> 00:35:55,920
actually never because a hash is

970
00:35:55,920 --> 00:35:59,440
normally a static thing like it will not

971
00:35:59,440 --> 00:36:01,280
change usually

972
00:36:01,280 --> 00:36:03,760
but for ips again there can be multiple

973
00:36:03,760 --> 00:36:05,119
domains that are

974
00:36:05,119 --> 00:36:08,000
good domains right an ip can also be

975
00:36:08,000 --> 00:36:10,480
reused and re-abused

976
00:36:10,480 --> 00:36:13,200
but the domain it's also again a bit

977
00:36:13,200 --> 00:36:14,560
more

978
00:36:14,560 --> 00:36:17,359
okay to live longer right it's

979
00:36:17,359 --> 00:36:20,000
it's not as dynamic or as dangerous as

980
00:36:20,000 --> 00:36:24,240
an ip so ips 30 days domain 60 days

981
00:36:24,240 --> 00:36:27,839
hashes pretty much never

982
00:36:28,480 --> 00:36:30,800
okay we're out of time but if you have a

983
00:36:30,800 --> 00:36:32,880
very short question let's come up and

984
00:36:32,880 --> 00:36:34,240
ask

985
00:36:34,240 --> 00:36:36,560
me afterwards

986
00:36:36,560 --> 00:36:38,640
yeah good

987
00:36:38,640 --> 00:36:41,599
let's give bart and michelle a warm

988
00:36:41,599 --> 00:36:42,400
applause

989
00:36:42,400 --> 00:36:48,720
[Applause]

990
00:36:48,720 --> 00:36:52,160
don't forget to fill out your

991
00:36:52,160 --> 00:36:54,400
survey in the app

992
00:36:54,400 --> 00:36:55,760
and

993
00:36:55,760 --> 00:36:58,079
we'll have a brief

994
00:36:58,079 --> 00:36:59,839
pause here and then

995
00:36:59,839 --> 00:37:02,640
get ready for the next

996
00:37:02,640 --> 00:37:05,119
the next speech in in ten minutes thank

997
00:37:05,119 --> 00:37:09,079
you right thanks everyone

