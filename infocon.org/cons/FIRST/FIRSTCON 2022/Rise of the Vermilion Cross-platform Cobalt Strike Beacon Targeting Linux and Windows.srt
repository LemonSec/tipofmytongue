1
00:00:05,870 --> 00:00:07,680
[Music]

2
00:00:07,680 --> 00:00:08,800
hello

3
00:00:08,800 --> 00:00:09,920
everyone

4
00:00:09,920 --> 00:00:12,160
welcome you find your seat

5
00:00:12,160 --> 00:00:14,799
for this last presentation before lunch

6
00:00:14,799 --> 00:00:16,880
break

7
00:00:16,880 --> 00:00:18,160
the team from

8
00:00:18,160 --> 00:00:20,640
integer has stayed with us

9
00:00:20,640 --> 00:00:21,439
and

10
00:00:21,439 --> 00:00:23,199
will be

11
00:00:23,199 --> 00:00:25,840
taking us into the world of

12
00:00:25,840 --> 00:00:28,240
a friend there and there to many of us

13
00:00:28,240 --> 00:00:30,800
cobblestrike and

14
00:00:30,800 --> 00:00:33,040
yeah i'll give it to abigail and ryan

15
00:00:33,040 --> 00:00:34,880
again

16
00:00:34,880 --> 00:00:37,120
great

17
00:00:37,840 --> 00:00:40,320
okay so hi everybody um welcome to the

18
00:00:40,320 --> 00:00:42,320
rise of the vermillion cross-platform

19
00:00:42,320 --> 00:00:44,559
cobra strike beacon targeting linux and

20
00:00:44,559 --> 00:00:47,039
windows this talk is based on a research

21
00:00:47,039 --> 00:00:51,200
we conducted during august 21.

22
00:00:51,280 --> 00:00:53,280
i'm avigil i'm a product manager at

23
00:00:53,280 --> 00:00:55,280
integer before that i was part of the

24
00:00:55,280 --> 00:00:57,199
research team and i focused on malware

25
00:00:57,199 --> 00:00:59,199
analysis and threat hunting

26
00:00:59,199 --> 00:01:02,399
i'm ryan also a security researcher with

27
00:01:02,399 --> 00:01:04,319
intelzer you might think i look similar

28
00:01:04,319 --> 00:01:05,920
to alaska in the talk

29
00:01:05,920 --> 00:01:08,159
we're related so we are

30
00:01:08,159 --> 00:01:10,640
now in previous roles i was a researcher

31
00:01:10,640 --> 00:01:11,360
in

32
00:01:11,360 --> 00:01:13,119
anomalies threat research team on a

33
00:01:13,119 --> 00:01:15,280
security engineer

34
00:01:15,280 --> 00:01:18,080
securing uh cloud applications on the

35
00:01:18,080 --> 00:01:19,040
entire

36
00:01:19,040 --> 00:01:20,640
organization

37
00:01:20,640 --> 00:01:23,920
so a quick uh sort of agenda for what

38
00:01:23,920 --> 00:01:24,799
we're

39
00:01:24,799 --> 00:01:27,200
going to go through very lightweight but

40
00:01:27,200 --> 00:01:28,560
we're going to talk about cobalt strike

41
00:01:28,560 --> 00:01:30,880
first um the reason why we want to talk

42
00:01:30,880 --> 00:01:32,240
about that is that

43
00:01:32,240 --> 00:01:33,360
you know

44
00:01:33,360 --> 00:01:36,159
this is the reason why vermilion exists

45
00:01:36,159 --> 00:01:38,479
so it really helps to understand

46
00:01:38,479 --> 00:01:40,560
what cobalt strike is

47
00:01:40,560 --> 00:01:42,960
who uses it why it's being used why it's

48
00:01:42,960 --> 00:01:46,000
so popular and then why it gives birth

49
00:01:46,000 --> 00:01:46,720
to

50
00:01:46,720 --> 00:01:49,280
other malwares that are inspired by it

51
00:01:49,280 --> 00:01:50,880
uh then avi will start talking about the

52
00:01:50,880 --> 00:01:53,360
linux malware frat landscape um this

53
00:01:53,360 --> 00:01:55,920
kind of combines the cobalt strike uh

54
00:01:55,920 --> 00:01:59,040
sort of to give birth to vermilion and

55
00:01:59,040 --> 00:02:00,640
uh

56
00:02:00,640 --> 00:02:02,719
you know we'll talk about that uh are we

57
00:02:02,719 --> 00:02:04,320
talking about the threat landscape it's

58
00:02:04,320 --> 00:02:05,840
yeah the incentive you know the march

59
00:02:05,840 --> 00:02:08,000
towards cloud and when why there's an

60
00:02:08,000 --> 00:02:09,840
incentive to target linux

61
00:02:09,840 --> 00:02:11,360
so then we'll talk about the actual

62
00:02:11,360 --> 00:02:13,599
malware itself vermilion we got the

63
00:02:13,599 --> 00:02:15,360
quite technical

64
00:02:15,360 --> 00:02:17,599
avi will talk about in the background

65
00:02:17,599 --> 00:02:19,920
first of like how we discovered it you

66
00:02:19,920 --> 00:02:22,080
know what we find odd about it you know

67
00:02:22,080 --> 00:02:24,879
how i came onto our radar

68
00:02:24,879 --> 00:02:27,120
uh and then i'll go deep into sort of

69
00:02:27,120 --> 00:02:29,280
more technical analysis maybe

70
00:02:29,280 --> 00:02:31,760
show a bit of code and stuff so that'll

71
00:02:31,760 --> 00:02:32,800
be fun

72
00:02:32,800 --> 00:02:35,040
uh and then we'll have a discussion

73
00:02:35,040 --> 00:02:37,519
around that and just sort of a wrap up

74
00:02:37,519 --> 00:02:39,519
and hopefully talk to you guys and get

75
00:02:39,519 --> 00:02:41,760
some questions from you

76
00:02:41,760 --> 00:02:44,160
so what is cobalt strike

77
00:02:44,160 --> 00:02:46,879
it's marketed as

78
00:02:46,879 --> 00:02:48,879
software for adversary simulations in

79
00:02:48,879 --> 00:02:51,040
red team operations

80
00:02:51,040 --> 00:02:53,040
that might not be too descriptive for

81
00:02:53,040 --> 00:02:55,040
you it might sound like some of the

82
00:02:55,040 --> 00:02:58,000
marketing or sales people downstairs

83
00:02:58,000 --> 00:02:59,120
you know but

84
00:02:59,120 --> 00:03:01,280
the way that i would freeze it it's a

85
00:03:01,280 --> 00:03:03,360
malware framework it doesn't just

86
00:03:03,360 --> 00:03:05,920
include the malware but it includes the

87
00:03:05,920 --> 00:03:07,599
ability to generate payloads and the

88
00:03:07,599 --> 00:03:08,879
command and control infrastructure

89
00:03:08,879 --> 00:03:11,920
behind that so really if you want to

90
00:03:11,920 --> 00:03:15,040
get up the speed or start using

91
00:03:15,040 --> 00:03:17,040
a really good malware framework it's

92
00:03:17,040 --> 00:03:20,080
it's all one so it is

93
00:03:20,080 --> 00:03:21,440
um and

94
00:03:21,440 --> 00:03:22,400
um

95
00:03:22,400 --> 00:03:24,000
simply there's certain more components

96
00:03:24,000 --> 00:03:25,760
in this but the most basic components

97
00:03:25,760 --> 00:03:27,920
really to be aware of is that there is

98
00:03:27,920 --> 00:03:29,120
the bacon

99
00:03:29,120 --> 00:03:31,200
and the bacon's what you would sort of

100
00:03:31,200 --> 00:03:33,280
consider the malware side the beacon is

101
00:03:33,280 --> 00:03:36,480
what runs on unaffected host what is

102
00:03:36,480 --> 00:03:38,159
there you know whatever your target is

103
00:03:38,159 --> 00:03:40,080
or you know if you're pen testing for

104
00:03:40,080 --> 00:03:41,920
your own organization some of your own

105
00:03:41,920 --> 00:03:44,560
internal computers and that can consist

106
00:03:44,560 --> 00:03:47,440
of two different components one is the

107
00:03:47,440 --> 00:03:50,000
stager the stager is optional but it's

108
00:03:50,000 --> 00:03:52,239
used quite a lot and basically it's a

109
00:03:52,239 --> 00:03:54,959
small snippet of shell code that will

110
00:03:54,959 --> 00:03:57,599
reach out to a command control server

111
00:03:57,599 --> 00:03:59,599
and it'll pull down the back door

112
00:03:59,599 --> 00:04:01,599
and the back door pretty much it's the

113
00:04:01,599 --> 00:04:02,959
film malware it's the thing that

114
00:04:02,959 --> 00:04:05,120
controls the machine will contact back

115
00:04:05,120 --> 00:04:08,400
to the c2 get controls you know really

116
00:04:08,400 --> 00:04:09,519
what you're going to perform your

117
00:04:09,519 --> 00:04:12,000
actions on objective on

118
00:04:12,000 --> 00:04:14,080
there are things called loaders um what

119
00:04:14,080 --> 00:04:16,320
loaders are are they're sort of small

120
00:04:16,320 --> 00:04:18,079
snippets of code

121
00:04:18,079 --> 00:04:19,918
you get them from many many languages

122
00:04:19,918 --> 00:04:23,120
many scripts uh you know things but busy

123
00:04:23,120 --> 00:04:25,919
a loader is a snippet of code that will

124
00:04:25,919 --> 00:04:29,280
execute either a stager or a back door

125
00:04:29,280 --> 00:04:31,600
there's what's called the team server

126
00:04:31,600 --> 00:04:33,759
pretty much the c2

127
00:04:33,759 --> 00:04:35,280
and there is the client and that's what

128
00:04:35,280 --> 00:04:36,960
you see in the screenshot there the

129
00:04:36,960 --> 00:04:38,160
client is

130
00:04:38,160 --> 00:04:40,240
what you use to log into a team server

131
00:04:40,240 --> 00:04:42,240
but it's also what you use to uh you

132
00:04:42,240 --> 00:04:44,160
know sort of generate the payloads on

133
00:04:44,160 --> 00:04:46,639
where you run the commands from it's

134
00:04:46,639 --> 00:04:48,560
think of it more as your your steering

135
00:04:48,560 --> 00:04:50,000
wheel

136
00:04:50,000 --> 00:04:53,280
for a cobalt strike

137
00:04:53,280 --> 00:04:55,040
it's extremely popular

138
00:04:55,040 --> 00:04:57,680
why it's got great features

139
00:04:57,680 --> 00:04:59,360
pretty hard to detect you know the

140
00:04:59,360 --> 00:05:02,320
staging all typically run in memory

141
00:05:02,320 --> 00:05:03,520
um

142
00:05:03,520 --> 00:05:05,360
it's easy to configure you know there's

143
00:05:05,360 --> 00:05:08,000
a gui and everything for it so you can

144
00:05:08,000 --> 00:05:10,400
point and click there's no sort of like

145
00:05:10,400 --> 00:05:11,919
you don't need to use like a fancy

146
00:05:11,919 --> 00:05:14,000
terminal kind of you want

147
00:05:14,000 --> 00:05:16,479
you can generate a plethora of payloads

148
00:05:16,479 --> 00:05:19,120
you know like i said the loader it has

149
00:05:19,120 --> 00:05:20,960
many many languages you can even

150
00:05:20,960 --> 00:05:23,120
generate like sort of documents uh

151
00:05:23,120 --> 00:05:25,600
emails things like that that's

152
00:05:25,600 --> 00:05:28,240
you know for whatever your target is it

153
00:05:28,240 --> 00:05:30,000
usually has something pretty sort of

154
00:05:30,000 --> 00:05:32,560
bespoke for it in the end you can do it

155
00:05:32,560 --> 00:05:35,360
the command control is handled so you

156
00:05:35,360 --> 00:05:37,600
you know you don't really need to do too

157
00:05:37,600 --> 00:05:40,720
much to set up your c2 just sort of

158
00:05:40,720 --> 00:05:43,039
run a script and that's all sort of set

159
00:05:43,039 --> 00:05:44,800
up for you you don't need to deal with

160
00:05:44,800 --> 00:05:47,199
like network communications yourself too

161
00:05:47,199 --> 00:05:48,160
much

162
00:05:48,160 --> 00:05:50,240
and it's hard to uh

163
00:05:50,240 --> 00:05:53,120
attribute so it is um

164
00:05:53,120 --> 00:05:55,520
and the reason why i say that is that

165
00:05:55,520 --> 00:05:57,360
there are so many people using cobalt

166
00:05:57,360 --> 00:05:58,720
strike that

167
00:05:58,720 --> 00:06:00,479
it creates a kind of

168
00:06:00,479 --> 00:06:02,400
spartacus effect

169
00:06:02,400 --> 00:06:03,840
and um

170
00:06:03,840 --> 00:06:05,120
you know

171
00:06:05,120 --> 00:06:06,720
a lot of time you really don't know

172
00:06:06,720 --> 00:06:08,720
who's behind the door you can't

173
00:06:08,720 --> 00:06:10,560
attribute based off cobalt strike alone

174
00:06:10,560 --> 00:06:12,319
you have to do other things such as like

175
00:06:12,319 --> 00:06:15,680
the c2 and all um if you remember the

176
00:06:15,680 --> 00:06:16,960
ukrainian

177
00:06:16,960 --> 00:06:18,400
cert was talking here a couple of days

178
00:06:18,400 --> 00:06:20,479
ago it was the second most popular

179
00:06:20,479 --> 00:06:23,600
malware i believe that they had seen

180
00:06:23,600 --> 00:06:25,759
so here are the users behind it

181
00:06:25,759 --> 00:06:28,240
they're red teams um adversaries we call

182
00:06:28,240 --> 00:06:31,039
them so the intended targets are sorry

183
00:06:31,039 --> 00:06:33,199
targets and the intended users are the

184
00:06:33,199 --> 00:06:34,880
red teams you know these are people that

185
00:06:34,880 --> 00:06:37,280
buy the product it's licensed they have

186
00:06:37,280 --> 00:06:38,880
permission to use it within their own

187
00:06:38,880 --> 00:06:41,120
organization and they're really using it

188
00:06:41,120 --> 00:06:42,560
to find

189
00:06:42,560 --> 00:06:44,880
you know vulnerabilities or busy conduct

190
00:06:44,880 --> 00:06:47,199
attacks within their own organizations

191
00:06:47,199 --> 00:06:48,639
see what you can learn be within the

192
00:06:48,639 --> 00:06:51,280
mind of an attacker and then start to

193
00:06:51,280 --> 00:06:52,400
patch that

194
00:06:52,400 --> 00:06:54,400
the other side adversaries

195
00:06:54,400 --> 00:06:56,160
black cats actors whatever you want to

196
00:06:56,160 --> 00:06:58,639
call them people these are people that

197
00:06:58,639 --> 00:07:00,639
usually get a cracked version of it so

198
00:07:00,639 --> 00:07:03,120
no license you know nobody permission to

199
00:07:03,120 --> 00:07:04,880
use it and they use it as you know a

200
00:07:04,880 --> 00:07:07,280
malware

201
00:07:07,520 --> 00:07:11,039
and so where do adversaries get cobalt

202
00:07:11,039 --> 00:07:12,639
strike from

203
00:07:12,639 --> 00:07:14,560
pretty much um

204
00:07:14,560 --> 00:07:16,560
every time a new version of code strike

205
00:07:16,560 --> 00:07:17,919
is released

206
00:07:17,919 --> 00:07:20,560
honestly within like a week a few days

207
00:07:20,560 --> 00:07:22,400
couple of weeks you'll get a cracked

208
00:07:22,400 --> 00:07:25,680
version somewhere online it's

209
00:07:25,680 --> 00:07:27,520
honestly it's it's trivial to get your

210
00:07:27,520 --> 00:07:29,919
hands on so you can get it even on sort

211
00:07:29,919 --> 00:07:31,440
of github like

212
00:07:31,440 --> 00:07:34,000
just screenshot the tech like you can

213
00:07:34,000 --> 00:07:35,280
actually i think you can even just sort

214
00:07:35,280 --> 00:07:37,360
of google it and you'll probably get it

215
00:07:37,360 --> 00:07:38,880
in like the first couple of uh search

216
00:07:38,880 --> 00:07:40,800
results but you can also get it in

217
00:07:40,800 --> 00:07:42,479
things like

218
00:07:42,479 --> 00:07:44,560
dark web forum sort of markets and all

219
00:07:44,560 --> 00:07:46,160
obviously extremely trivial to get your

220
00:07:46,160 --> 00:07:48,160
version uh so to get your hands on a

221
00:07:48,160 --> 00:07:51,520
cracked version of a couple strike

222
00:07:51,520 --> 00:07:54,080
so in the news

223
00:07:54,080 --> 00:07:55,919
honestly i could have picked

224
00:07:55,919 --> 00:07:58,639
one of a million you know sort of things

225
00:07:58,639 --> 00:08:00,479
that gets you just type it into google

226
00:08:00,479 --> 00:08:03,199
news and you get pages upon pages upon

227
00:08:03,199 --> 00:08:05,039
pages i could have updated this probably

228
00:08:05,039 --> 00:08:07,440
for last week you know so you see things

229
00:08:07,440 --> 00:08:09,680
russian apt hackers you know using

230
00:08:09,680 --> 00:08:11,840
target sort of diplomats in europe

231
00:08:11,840 --> 00:08:13,280
things like that

232
00:08:13,280 --> 00:08:14,639
um

233
00:08:14,639 --> 00:08:16,720
yeah it's it's all over the news now

234
00:08:16,720 --> 00:08:18,479
you'll get it from the lowest script

235
00:08:18,479 --> 00:08:20,080
kerry even up to the highest southern

236
00:08:20,080 --> 00:08:23,759
nation state apt uh using this song yeah

237
00:08:23,759 --> 00:08:25,759
it'll make the news

238
00:08:25,759 --> 00:08:26,639
so

239
00:08:26,639 --> 00:08:29,039
what about cobalt strike and linux

240
00:08:29,039 --> 00:08:30,720
officially

241
00:08:30,720 --> 00:08:32,399
there's no limits version and the

242
00:08:32,399 --> 00:08:33,919
maintainer is a cobbled strike held in

243
00:08:33,919 --> 00:08:35,679
those systems there is the blog saying

244
00:08:35,679 --> 00:08:37,760
much as so this is a windows only

245
00:08:37,760 --> 00:08:38,799
payload

246
00:08:38,799 --> 00:08:40,880
but you know like programmers are smart

247
00:08:40,880 --> 00:08:42,479
people attack people are smart people

248
00:08:42,479 --> 00:08:44,480
that that really doesn't stop them from

249
00:08:44,480 --> 00:08:45,600
making something that's able to

250
00:08:45,600 --> 00:08:47,680
communicate with the server so a few

251
00:08:47,680 --> 00:08:49,680
sort of notable examples for

252
00:08:49,680 --> 00:08:52,240
uh linux versions a couple strike

253
00:08:52,240 --> 00:08:54,560
open source project called gigan it is a

254
00:08:54,560 --> 00:08:56,399
golang version uh

255
00:08:56,399 --> 00:08:58,720
of the cobot strike bacon

256
00:08:58,720 --> 00:09:01,839
uh there's the cross c2 framework um

257
00:09:01,839 --> 00:09:03,600
what's probably my favorite is that a

258
00:09:03,600 --> 00:09:06,320
user on twitter he was able to run the

259
00:09:06,320 --> 00:09:08,560
windows version of bacon using a wine

260
00:09:08,560 --> 00:09:10,720
emulator on linux so

261
00:09:10,720 --> 00:09:12,800
yeah you can probably just use windows

262
00:09:12,800 --> 00:09:14,640
on linux i don't know how easy it is to

263
00:09:14,640 --> 00:09:16,560
install wine

264
00:09:16,560 --> 00:09:18,240
so yeah

265
00:09:18,240 --> 00:09:20,560
you can get it for linux so

266
00:09:20,560 --> 00:09:22,640
now you're probably on topic alex

267
00:09:22,640 --> 00:09:24,480
thanks ryan thank you very much

268
00:09:24,480 --> 00:09:26,080
uh cool so now that we have some

269
00:09:26,080 --> 00:09:28,160
background about kobo strike let's talk

270
00:09:28,160 --> 00:09:29,760
about the linux and malwarethread

271
00:09:29,760 --> 00:09:31,200
landscape

272
00:09:31,200 --> 00:09:33,279
so the linux market share the desktop

273
00:09:33,279 --> 00:09:35,200
world is really really low it's

274
00:09:35,200 --> 00:09:37,760
approximately two percent

275
00:09:37,760 --> 00:09:40,720
however when speaking of cloud servers

276
00:09:40,720 --> 00:09:43,200
servers in general the situation is

277
00:09:43,200 --> 00:09:44,880
quite the opposite where linux is a

278
00:09:44,880 --> 00:09:47,040
predominant operating system

279
00:09:47,040 --> 00:09:49,120
which makes sense because of the

280
00:09:49,120 --> 00:09:52,160
the nature of this operating system

281
00:09:52,160 --> 00:09:54,880
now this really affects um the malware

282
00:09:54,880 --> 00:09:56,959
threat landscape because we see

283
00:09:56,959 --> 00:09:59,200
many many coin miners and botnets which

284
00:09:59,200 --> 00:10:01,519
are designed to take advantage of the

285
00:10:01,519 --> 00:10:03,440
victims computing power

286
00:10:03,440 --> 00:10:05,120
and the developers behind of these

287
00:10:05,120 --> 00:10:07,440
malwares or the adversaries that deliver

288
00:10:07,440 --> 00:10:09,680
these malware just want to get to as

289
00:10:09,680 --> 00:10:11,760
many victims as possible

290
00:10:11,760 --> 00:10:13,279
and these are attack are usually not

291
00:10:13,279 --> 00:10:15,120
targeted

292
00:10:15,120 --> 00:10:17,360
now we also have ransomware

293
00:10:17,360 --> 00:10:20,000
they will usually be more targeted and

294
00:10:20,000 --> 00:10:21,839
they will be delivered to

295
00:10:21,839 --> 00:10:24,480
file hosting services such as qnap or to

296
00:10:24,480 --> 00:10:27,120
vmware esxi

297
00:10:27,120 --> 00:10:30,079
and lastly less frequently documented

298
00:10:30,079 --> 00:10:32,720
are backdoors and backdoors will usually

299
00:10:32,720 --> 00:10:35,200
be targeted

300
00:10:35,200 --> 00:10:37,600
and historically they will be developed

301
00:10:37,600 --> 00:10:40,000
by a nation state

302
00:10:40,000 --> 00:10:42,720
now the nation state that have been

303
00:10:42,720 --> 00:10:46,000
publicly known to be to deliver maori to

304
00:10:46,000 --> 00:10:47,279
linux are

305
00:10:47,279 --> 00:10:50,800
russia north korea and china

306
00:10:50,800 --> 00:10:53,600
now an interesting fact here is that

307
00:10:53,600 --> 00:10:55,440
many of these malware

308
00:10:55,440 --> 00:10:58,240
written from linux by nation state has

309
00:10:58,240 --> 00:11:01,600
at least one other version to target

310
00:11:01,600 --> 00:11:03,440
another operating system

311
00:11:03,440 --> 00:11:04,640
so

312
00:11:04,640 --> 00:11:07,519
for example for russia we have apt-29

313
00:11:07,519 --> 00:11:10,079
they have wellness wellness targets

314
00:11:10,079 --> 00:11:12,880
linux and windows

315
00:11:12,880 --> 00:11:15,680
for north korea we have the lazarus

316
00:11:15,680 --> 00:11:18,880
group they have dakal's tool that calls

317
00:11:18,880 --> 00:11:21,839
targets mac linux and windows they also

318
00:11:21,839 --> 00:11:24,320
have the um manuscript tool that targets

319
00:11:24,320 --> 00:11:26,000
linux and windows

320
00:11:26,000 --> 00:11:28,959
and for china we have the winte group

321
00:11:28,959 --> 00:11:30,640
they have a back door for linux and

322
00:11:30,640 --> 00:11:32,000
windows

323
00:11:32,000 --> 00:11:34,800
and also the blacktech group which

324
00:11:34,800 --> 00:11:35,760
have

325
00:11:35,760 --> 00:11:37,760
ts cookie and plid

326
00:11:37,760 --> 00:11:39,920
both of them were first found targeting

327
00:11:39,920 --> 00:11:42,320
windows and later on they were targeting

328
00:11:42,320 --> 00:11:44,800
linux

329
00:11:44,959 --> 00:11:47,360
so yeah

330
00:11:47,360 --> 00:11:49,200
okay so now we have background about

331
00:11:49,200 --> 00:11:51,920
cobra strike about linux malware let's

332
00:11:51,920 --> 00:11:54,160
connect all the dots together and talk

333
00:11:54,160 --> 00:11:57,279
about a research so one day we got the

334
00:11:57,279 --> 00:11:59,680
sit from our thread hunting tool about

335
00:11:59,680 --> 00:12:01,600
this elf file

336
00:12:01,600 --> 00:12:03,839
we uploaded it to our system which is

337
00:12:03,839 --> 00:12:06,000
integer platform

338
00:12:06,000 --> 00:12:09,600
and we found three interesting things

339
00:12:09,600 --> 00:12:10,720
first of all

340
00:12:10,720 --> 00:12:12,800
again this is an elf sample

341
00:12:12,800 --> 00:12:15,519
and we saw that it shared strings with

342
00:12:15,519 --> 00:12:17,440
cobble strike now as ryan mentioned

343
00:12:17,440 --> 00:12:18,480
before

344
00:12:18,480 --> 00:12:21,440
cobblestrike has no official version for

345
00:12:21,440 --> 00:12:23,600
for linux okay so this was really really

346
00:12:23,600 --> 00:12:25,200
interesting

347
00:12:25,200 --> 00:12:27,200
second of all um

348
00:12:27,200 --> 00:12:30,079
we saw that it had a high percentage of

349
00:12:30,079 --> 00:12:32,079
previously unseen code okay the

350
00:12:32,079 --> 00:12:35,200
vermilion vermilion strike that you see

351
00:12:35,200 --> 00:12:36,240
over here

352
00:12:36,240 --> 00:12:39,200
this was after we marked it okay

353
00:12:39,200 --> 00:12:42,000
this code was unknown now

354
00:12:42,000 --> 00:12:44,320
i'll explain what it does do so what i'm

355
00:12:44,320 --> 00:12:46,240
telling you now will make sense

356
00:12:46,240 --> 00:12:49,360
integer has a very very big database of

357
00:12:49,360 --> 00:12:51,200
previously seen malicious and trusted

358
00:12:51,200 --> 00:12:54,399
code so every file that is uploaded to

359
00:12:54,399 --> 00:12:55,680
our database

360
00:12:55,680 --> 00:12:57,760
will be then divided into small chunks

361
00:12:57,760 --> 00:12:58,720
of code

362
00:12:58,720 --> 00:13:01,519
compared against this database

363
00:13:01,519 --> 00:13:03,279
and based on the result we can tell if

364
00:13:03,279 --> 00:13:05,120
this code has been seen before what the

365
00:13:05,120 --> 00:13:08,160
file is it is malicious is it trusted

366
00:13:08,160 --> 00:13:10,880
what family it is and so on

367
00:13:10,880 --> 00:13:13,040
so the fact that it had

368
00:13:13,040 --> 00:13:15,279
no previously seen code is a really

369
00:13:15,279 --> 00:13:17,040
strong indication that it was written

370
00:13:17,040 --> 00:13:19,600
from scratch

371
00:13:19,600 --> 00:13:21,760
and lastly um it had different

372
00:13:21,760 --> 00:13:23,360
network-related capabilities for

373
00:13:23,360 --> 00:13:27,279
communication dns resolution and so on

374
00:13:27,279 --> 00:13:29,040
now looking at this

375
00:13:29,040 --> 00:13:32,480
file in virustotal it had no detection

376
00:13:32,480 --> 00:13:34,880
by any other security vendors which is

377
00:13:34,880 --> 00:13:36,959
not really a decision differentiator

378
00:13:36,959 --> 00:13:39,600
when speaking about linux and i'll touch

379
00:13:39,600 --> 00:13:41,600
upon that later

380
00:13:41,600 --> 00:13:44,800
however it had an interesting name x11

381
00:13:44,800 --> 00:13:46,160
jtk

382
00:13:46,160 --> 00:13:49,040
okay so x11 is the graphical environment

383
00:13:49,040 --> 00:13:50,320
jtk

384
00:13:50,320 --> 00:13:53,440
widget libraries it's a thing okay

385
00:13:53,440 --> 00:13:56,639
however when we search the exact name in

386
00:13:56,639 --> 00:13:59,440
virustotal and in google

387
00:13:59,440 --> 00:14:02,800
we got no hits at all okay so this was

388
00:14:02,800 --> 00:14:04,959
kind of interesting

389
00:14:04,959 --> 00:14:07,760
and lastly we saw um in virustotal that

390
00:14:07,760 --> 00:14:10,320
it got hits by florian ross's

391
00:14:10,320 --> 00:14:12,320
yara rules for cobblestrike which kind

392
00:14:12,320 --> 00:14:14,480
of aligns with the string views that we

393
00:14:14,480 --> 00:14:17,040
saw before at integer

394
00:14:17,040 --> 00:14:19,040
so all of this made us really really

395
00:14:19,040 --> 00:14:20,959
happy as researchers because we know

396
00:14:20,959 --> 00:14:22,639
that we have something interesting in

397
00:14:22,639 --> 00:14:24,079
our hands

398
00:14:24,079 --> 00:14:26,800
and then we continued to research this

399
00:14:26,800 --> 00:14:28,839
and we dived in

400
00:14:28,839 --> 00:14:32,800
technically and ryan will explain you

401
00:14:32,800 --> 00:14:35,599
thank you very much

402
00:14:36,320 --> 00:14:39,360
so the fun part i sort of deep dive into

403
00:14:39,360 --> 00:14:41,600
a vermillion strike i'll show some code

404
00:14:41,600 --> 00:14:43,199
and stuff so

405
00:14:43,199 --> 00:14:44,880
let's jump into it

406
00:14:44,880 --> 00:14:45,920
so

407
00:14:45,920 --> 00:14:48,959
very simply reduced into a very simple

408
00:14:48,959 --> 00:14:50,079
flowchart

409
00:14:50,079 --> 00:14:52,560
vermilion is executed it will demonize

410
00:14:52,560 --> 00:14:54,240
itself in the background

411
00:14:54,240 --> 00:14:57,040
split it will decode a configuration

412
00:14:57,040 --> 00:14:59,279
you import a public key we'll sort of

413
00:14:59,279 --> 00:15:02,000
use for encryption communication it'll

414
00:15:02,000 --> 00:15:04,160
fingerprint the machine and then just

415
00:15:04,160 --> 00:15:06,240
start the command controller

416
00:15:06,240 --> 00:15:08,880
honestly kind of simple

417
00:15:08,880 --> 00:15:09,760
and so let's start with the

418
00:15:09,760 --> 00:15:11,440
configuration

419
00:15:11,440 --> 00:15:13,680
simple source cipher uh pretty normal

420
00:15:13,680 --> 00:15:16,639
for cold strike um what we noticed is it

421
00:15:16,639 --> 00:15:17,920
used what was

422
00:15:17,920 --> 00:15:21,040
a pretty standard key hex 69

423
00:15:21,040 --> 00:15:21,420
um

424
00:15:21,420 --> 00:15:22,560
[Music]

425
00:15:22,560 --> 00:15:24,880
and yeah we see that in like a lot of

426
00:15:24,880 --> 00:15:27,279
the windows versions for cobot strike

427
00:15:27,279 --> 00:15:28,720
what was really really funny uh

428
00:15:28,720 --> 00:15:30,880
interesting is that you can use standard

429
00:15:30,880 --> 00:15:33,759
tools you know uh for parsing the cobble

430
00:15:33,759 --> 00:15:36,079
strike configuration uh

431
00:15:36,079 --> 00:15:38,480
on this too so you know imagine you're

432
00:15:38,480 --> 00:15:40,079
expecting to give like a windows file

433
00:15:40,079 --> 00:15:42,320
you can give like a elf file and it'll

434
00:15:42,320 --> 00:15:44,480
still be able to parse the configuration

435
00:15:44,480 --> 00:15:46,240
and something very interesting is that

436
00:15:46,240 --> 00:15:48,399
you'll sort of notice that there are

437
00:15:48,399 --> 00:15:50,240
windows artifacts

438
00:15:50,240 --> 00:15:52,880
you know that show up in

439
00:15:52,880 --> 00:15:55,680
the linux version so you know if you're

440
00:15:55,680 --> 00:15:57,759
ever trying to look for suspicious linux

441
00:15:57,759 --> 00:16:00,639
files a nice flag this is it has like

442
00:16:00,639 --> 00:16:02,720
some windows stuff inside it because it

443
00:16:02,720 --> 00:16:05,440
kind of doesn't make sense um what i'll

444
00:16:05,440 --> 00:16:07,440
just highlight up there in the corners

445
00:16:07,440 --> 00:16:10,560
that is the c2

446
00:16:10,560 --> 00:16:12,480
address that you you can put multiple

447
00:16:12,480 --> 00:16:14,720
within the configuration of cobalt

448
00:16:14,720 --> 00:16:16,720
strike

449
00:16:16,720 --> 00:16:18,639
so fingerprinting machine

450
00:16:18,639 --> 00:16:20,880
again super easy get the process id get

451
00:16:20,880 --> 00:16:24,320
the kernel version network user

452
00:16:24,320 --> 00:16:26,639
build it up into a big string

453
00:16:26,639 --> 00:16:29,519
encrypt that string using the rsa key

454
00:16:29,519 --> 00:16:32,399
and then bs64 encode that so if you're

455
00:16:32,399 --> 00:16:34,000
doing any sort of

456
00:16:34,000 --> 00:16:36,720
network traffic kind of monitoring like

457
00:16:36,720 --> 00:16:39,040
you won't be able uh to detect you know

458
00:16:39,040 --> 00:16:39,920
those

459
00:16:39,920 --> 00:16:42,160
suspicious strengths going across so

460
00:16:42,160 --> 00:16:44,880
uh it'll avoid like some sort of

461
00:16:44,880 --> 00:16:47,040
defenses things like that

462
00:16:47,040 --> 00:16:50,680
command and control uh it was a dns on

463
00:16:50,680 --> 00:16:52,800
http beacon

464
00:16:52,800 --> 00:16:56,480
primarily it was dns but you can sort of

465
00:16:56,480 --> 00:16:59,120
swap so you can so commands are received

466
00:16:59,120 --> 00:17:02,079
over address and tax records

467
00:17:02,079 --> 00:17:03,519
the way it goes think of address kind of

468
00:17:03,519 --> 00:17:05,439
like a get request that just sort of

469
00:17:05,439 --> 00:17:07,280
points you to do something but if you

470
00:17:07,280 --> 00:17:10,319
need to give data down to uh vermillion

471
00:17:10,319 --> 00:17:12,480
strike um you can do that in a text

472
00:17:12,480 --> 00:17:14,640
record like say give me this file or

473
00:17:14,640 --> 00:17:16,400
sort of this directory you know where

474
00:17:16,400 --> 00:17:18,559
you need to tell it something

475
00:17:18,559 --> 00:17:20,880
uh also interesting enough there's a

476
00:17:20,880 --> 00:17:23,280
branch of code within vermilion strike

477
00:17:23,280 --> 00:17:26,559
that deals with icmp communication

478
00:17:26,559 --> 00:17:28,559
but there's no way to actually get to

479
00:17:28,559 --> 00:17:30,080
the branch so

480
00:17:30,080 --> 00:17:31,840
possibly the frat actors they were

481
00:17:31,840 --> 00:17:34,080
thinking about adding a new protocol for

482
00:17:34,080 --> 00:17:35,280
communication

483
00:17:35,280 --> 00:17:37,679
maybe it's still in development or

484
00:17:37,679 --> 00:17:40,320
maybe they sort of just stopped halfway

485
00:17:40,320 --> 00:17:42,240
through and just fought and the dns and

486
00:17:42,240 --> 00:17:44,880
http is good enough you know it isn't

487
00:17:44,880 --> 00:17:46,799
sort of detected or anything so maybe

488
00:17:46,799 --> 00:17:48,559
there's no incentive to keep going

489
00:17:48,559 --> 00:17:50,000
without but it was there very

490
00:17:50,000 --> 00:17:52,320
interestingly

491
00:17:52,320 --> 00:17:54,480
so the the commands i can do

492
00:17:54,480 --> 00:17:57,120
very simply you can change the directory

493
00:17:57,120 --> 00:17:58,640
you can find out what current directory

494
00:17:58,640 --> 00:18:00,559
you're in you can list the files within

495
00:18:00,559 --> 00:18:03,120
that directory you can download the file

496
00:18:03,120 --> 00:18:06,080
upload a file less than minded desks i'm

497
00:18:06,080 --> 00:18:08,160
just hand chasing it and you can execute

498
00:18:08,160 --> 00:18:09,280
commands

499
00:18:09,280 --> 00:18:11,600
so honestly pretty much everything that

500
00:18:11,600 --> 00:18:15,600
you need for like a backdoor

501
00:18:15,600 --> 00:18:16,880
so

502
00:18:16,880 --> 00:18:18,799
we managed to find a windows version by

503
00:18:18,799 --> 00:18:20,720
pivoting of the c2 address if you

504
00:18:20,720 --> 00:18:22,240
remember the

505
00:18:22,240 --> 00:18:24,799
addresses that i had highlighted before

506
00:18:24,799 --> 00:18:26,799
in the configuration slide

507
00:18:26,799 --> 00:18:30,640
from that we found what was the stager

508
00:18:30,640 --> 00:18:33,280
and a stager was using powershell to

509
00:18:33,280 --> 00:18:36,640
download a dll and then execute this dll

510
00:18:36,640 --> 00:18:38,640
in memory you know as sort of file as

511
00:18:38,640 --> 00:18:39,760
malware

512
00:18:39,760 --> 00:18:40,720
and

513
00:18:40,720 --> 00:18:42,480
we found out that

514
00:18:42,480 --> 00:18:46,559
this dll is the windows version um of

515
00:18:46,559 --> 00:18:48,320
vermilion strike

516
00:18:48,320 --> 00:18:49,200
and

517
00:18:49,200 --> 00:18:52,160
the dll is actually from 2019 so

518
00:18:52,160 --> 00:18:53,840
if any of you guys know the researcher

519
00:18:53,840 --> 00:18:55,679
silas cutter he actually posted a tweet

520
00:18:55,679 --> 00:18:57,679
about it years ago saying like hey this

521
00:18:57,679 --> 00:19:00,400
is a interesting copy of cobalt strike

522
00:19:00,400 --> 00:19:01,120
but

523
00:19:01,120 --> 00:19:02,799
it turned out to not be cobblestrike at

524
00:19:02,799 --> 00:19:03,679
all

525
00:19:03,679 --> 00:19:07,280
um and uh yeah the functionality between

526
00:19:07,280 --> 00:19:09,840
the two versions are largely the same so

527
00:19:09,840 --> 00:19:11,360
what i have nicely here is like an

528
00:19:11,360 --> 00:19:13,760
idograph on the left you see the linux

529
00:19:13,760 --> 00:19:16,000
self version of your millions track and

530
00:19:16,000 --> 00:19:18,880
on the right uh the dll this here is the

531
00:19:18,880 --> 00:19:20,960
configuration

532
00:19:20,960 --> 00:19:22,799
decoding function so

533
00:19:22,799 --> 00:19:24,400
um yeah if you bring them up side by

534
00:19:24,400 --> 00:19:26,240
side in either the windows and linux

535
00:19:26,240 --> 00:19:27,200
versions

536
00:19:27,200 --> 00:19:28,160
they look

537
00:19:28,160 --> 00:19:30,960
pretty similar so they

538
00:19:30,960 --> 00:19:33,039
so in the world

539
00:19:33,039 --> 00:19:35,360
thanks

540
00:19:36,000 --> 00:19:38,720
okay so we partnered up with the mcafee

541
00:19:38,720 --> 00:19:42,240
enterprise atr we provided them iocs and

542
00:19:42,240 --> 00:19:44,720
they queried their telemetry

543
00:19:44,720 --> 00:19:48,160
and we discovered that vermilion strike

544
00:19:48,160 --> 00:19:51,120
was part of live attacks on high-profile

545
00:19:51,120 --> 00:19:53,600
companies around the world

546
00:19:53,600 --> 00:19:56,720
government agencies telecom advisory

547
00:19:56,720 --> 00:19:59,760
financial institutions nit companies

548
00:19:59,760 --> 00:20:02,000
with that being said the amount of

549
00:20:02,000 --> 00:20:04,960
victims was still kind of specific okay

550
00:20:04,960 --> 00:20:08,000
so we didn't found many many victims

551
00:20:08,000 --> 00:20:10,559
as well that we didn't found many many

552
00:20:10,559 --> 00:20:13,120
samples

553
00:20:13,280 --> 00:20:15,679
as for the attribution

554
00:20:15,679 --> 00:20:18,159
so we know it's a backdoor

555
00:20:18,159 --> 00:20:20,960
we know that it's written from scratch

556
00:20:20,960 --> 00:20:23,440
we know that it targets windows and

557
00:20:23,440 --> 00:20:25,120
linux

558
00:20:25,120 --> 00:20:27,039
and we know that vermilion strike

559
00:20:27,039 --> 00:20:29,120
was targeting high profile companies

560
00:20:29,120 --> 00:20:30,480
around the world

561
00:20:30,480 --> 00:20:33,200
so based on our historical knowledge we

562
00:20:33,200 --> 00:20:35,120
can assess with high probability that

563
00:20:35,120 --> 00:20:38,240
vermilion strike was developed by

564
00:20:38,240 --> 00:20:40,799
a advanced adversary

565
00:20:40,799 --> 00:20:43,360
most probably a nation state

566
00:20:43,360 --> 00:20:45,760
however we didn't attribute it to any

567
00:20:45,760 --> 00:20:49,520
specific nation state

568
00:20:49,520 --> 00:20:51,520
now the windows version of vermillion

569
00:20:51,520 --> 00:20:54,080
strike had a decent amount of security

570
00:20:54,080 --> 00:20:56,640
vendors detecting that in virus total

571
00:20:56,640 --> 00:21:00,240
however the linux version had none and

572
00:21:00,240 --> 00:21:02,720
this raises the question of why linux

573
00:21:02,720 --> 00:21:05,919
malware fly under the radar

574
00:21:05,919 --> 00:21:07,600
let me show you this screenshot taken

575
00:21:07,600 --> 00:21:10,799
from ubuntu's official website the title

576
00:21:10,799 --> 00:21:13,440
is do i need antivirus malware and i

577
00:21:13,440 --> 00:21:14,799
mark down

578
00:21:14,799 --> 00:21:17,600
two sentences first sentence is i'll

579
00:21:17,600 --> 00:21:19,760
read it from here antivirus software

580
00:21:19,760 --> 00:21:21,840
does exist for linux but you probably

581
00:21:21,840 --> 00:21:23,919
don't need to use it

582
00:21:23,919 --> 00:21:26,320
second sentence whatever the reason

583
00:21:26,320 --> 00:21:28,960
linux viruses are so rare that you don't

584
00:21:28,960 --> 00:21:30,720
really need to worry about them at the

585
00:21:30,720 --> 00:21:32,400
moment

586
00:21:32,400 --> 00:21:35,280
now this misconception causes for less

587
00:21:35,280 --> 00:21:37,919
demand for linux detection which shifts

588
00:21:37,919 --> 00:21:40,240
away security vendors from spending time

589
00:21:40,240 --> 00:21:43,280
and resources on linux detection

590
00:21:43,280 --> 00:21:46,880
and this leads to these situations okay

591
00:21:46,880 --> 00:21:50,480
this is a sample of mirai botnet mirai

592
00:21:50,480 --> 00:21:54,240
is one of the first most common botnets

593
00:21:54,240 --> 00:21:56,320
kind of ever okay its source code was

594
00:21:56,320 --> 00:21:58,480
leaked a while ago

595
00:21:58,480 --> 00:22:01,280
and the developer of this sample added a

596
00:22:01,280 --> 00:22:03,840
spice of sophistication

597
00:22:03,840 --> 00:22:05,200
and they

598
00:22:05,200 --> 00:22:06,880
obfuscated some strings and function

599
00:22:06,880 --> 00:22:08,880
names okay and this is the result none

600
00:22:08,880 --> 00:22:11,280
of the security vendors and virustotal

601
00:22:11,280 --> 00:22:12,880
detected it

602
00:22:12,880 --> 00:22:15,280
and i find it's really really concerning

603
00:22:15,280 --> 00:22:17,919
okay we really should um we really

604
00:22:17,919 --> 00:22:20,320
should care about linux malware we had

605
00:22:20,320 --> 00:22:23,280
integer we found um we find the nox

606
00:22:23,280 --> 00:22:25,600
power and undetected all the time and we

607
00:22:25,600 --> 00:22:27,760
continuously report about it we just

608
00:22:27,760 --> 00:22:29,760
published a report about zambiot which

609
00:22:29,760 --> 00:22:33,120
is a linux rootkit also found in live

610
00:22:33,120 --> 00:22:34,880
attacks um

611
00:22:34,880 --> 00:22:36,480
so i really hope this is one of the

612
00:22:36,480 --> 00:22:39,440
takeaways um from our talk today for you

613
00:22:39,440 --> 00:22:41,840
guys

614
00:22:45,280 --> 00:22:46,159
so

615
00:22:46,159 --> 00:22:47,600
sort of the

616
00:22:47,600 --> 00:22:50,480
detection and response

617
00:22:50,480 --> 00:22:52,480
for the windows version of vermilion

618
00:22:52,480 --> 00:22:55,280
strike it needs to be detected in memory

619
00:22:55,280 --> 00:22:57,120
you know it's it's it's a file is

620
00:22:57,120 --> 00:23:00,480
payload so your edr antivirus endpoint

621
00:23:00,480 --> 00:23:01,520
scanner

622
00:23:01,520 --> 00:23:04,640
whatever you're using on your endpoints

623
00:23:04,640 --> 00:23:06,320
make sure that that can deal with files

624
00:23:06,320 --> 00:23:09,120
code stuff in memory but you can also

625
00:23:09,120 --> 00:23:11,360
detect via the stager tower when those

626
00:23:11,360 --> 00:23:13,039
what we noticed is that the stager it

627
00:23:13,039 --> 00:23:15,360
was uh uniquely developed so it had that

628
00:23:15,360 --> 00:23:17,600
sort of similar situation where we had

629
00:23:17,600 --> 00:23:21,120
not seen the code used anywhere else so

630
00:23:21,120 --> 00:23:23,919
if you find that particular stager

631
00:23:23,919 --> 00:23:25,440
you can probably also go okay there's a

632
00:23:25,440 --> 00:23:27,280
good chance that there's vermilion

633
00:23:27,280 --> 00:23:28,880
strike we haven't seen that stage or

634
00:23:28,880 --> 00:23:30,640
download anything else and execute that

635
00:23:30,640 --> 00:23:32,640
in memory even though it has the

636
00:23:32,640 --> 00:23:34,559
ability to

637
00:23:34,559 --> 00:23:36,799
the linux version you can just find that

638
00:23:36,799 --> 00:23:39,360
on uh on your desk so

639
00:23:39,360 --> 00:23:41,360
technically it should be a simpler task

640
00:23:41,360 --> 00:23:43,600
but as we talks about there's

641
00:23:43,600 --> 00:23:44,880
not the

642
00:23:44,880 --> 00:23:47,360
sort of same amount of detection for

643
00:23:47,360 --> 00:23:49,440
that around there so

644
00:23:49,440 --> 00:23:50,480
um

645
00:23:50,480 --> 00:23:52,880
some couples called strike

646
00:23:52,880 --> 00:23:54,720
methods for detection can be used for a

647
00:23:54,720 --> 00:23:56,559
vermilion strike as well you saw on the

648
00:23:56,559 --> 00:23:58,640
slides like the yara signatures that

649
00:23:58,640 --> 00:24:00,480
florian ralph had made you know you can

650
00:24:00,480 --> 00:24:02,400
detect like the configuration it's the

651
00:24:02,400 --> 00:24:05,039
same as the windows or even you can

652
00:24:05,039 --> 00:24:06,960
detect it via the network you know if

653
00:24:06,960 --> 00:24:09,760
you have ways of fingerprinting um like

654
00:24:09,760 --> 00:24:11,679
coupled strike

655
00:24:11,679 --> 00:24:15,039
c2 servers uh or sort of communication

656
00:24:15,039 --> 00:24:16,559
artifacts

657
00:24:16,559 --> 00:24:18,480
you can find out too that'll be the same

658
00:24:18,480 --> 00:24:21,120
as uh cobblestrike

659
00:24:21,120 --> 00:24:22,320
um

660
00:24:22,320 --> 00:24:24,080
predictions to come from that

661
00:24:24,080 --> 00:24:25,840
couplet strike it'll probably remain to

662
00:24:25,840 --> 00:24:28,000
be a big issue for windows

663
00:24:28,000 --> 00:24:30,480
it's still extremely popular um you know

664
00:24:30,480 --> 00:24:31,679
it's still being maintained there's new

665
00:24:31,679 --> 00:24:33,520
versions coming out then because there's

666
00:24:33,520 --> 00:24:34,960
new versions coming out there's new

667
00:24:34,960 --> 00:24:36,880
cracks for it and

668
00:24:36,880 --> 00:24:40,400
yet it's it's going hot as ever so

669
00:24:40,400 --> 00:24:42,480
i think it'll keep being a big issue for

670
00:24:42,480 --> 00:24:43,360
windows

671
00:24:43,360 --> 00:24:46,000
vermilion strike i would say it has a on

672
00:24:46,000 --> 00:24:48,080
share future you know we find the

673
00:24:48,080 --> 00:24:50,159
targeting organizations around the world

674
00:24:50,159 --> 00:24:52,640
you know stuff in government and all um

675
00:24:52,640 --> 00:24:54,000
but it wasn't

676
00:24:54,000 --> 00:24:57,200
an insanely huge amount so in a way we

677
00:24:57,200 --> 00:24:59,919
don't particularly have the telemetry

678
00:24:59,919 --> 00:25:02,080
the find out you know what the future

679
00:25:02,080 --> 00:25:03,360
for that's going to be

680
00:25:03,360 --> 00:25:05,679
as you saw the like the windows version

681
00:25:05,679 --> 00:25:08,320
was still live from 2019 the c2 have

682
00:25:08,320 --> 00:25:10,559
been serving that payload for years

683
00:25:10,559 --> 00:25:12,080
years

684
00:25:12,080 --> 00:25:14,880
and we see the crossfi cross-platform

685
00:25:14,880 --> 00:25:17,760
malware will continue again we are like

686
00:25:17,760 --> 00:25:19,440
we're finding those all the time we even

687
00:25:19,440 --> 00:25:21,760
find stuff there you know for like

688
00:25:21,760 --> 00:25:24,640
targets mark linux uh windows

689
00:25:24,640 --> 00:25:26,159
um so yeah

690
00:25:26,159 --> 00:25:27,520
they're still the incentive there you

691
00:25:27,520 --> 00:25:30,000
know people are moving to again the

692
00:25:30,000 --> 00:25:32,320
march declined continues on people

693
00:25:32,320 --> 00:25:34,320
using macs still and you know there's

694
00:25:34,320 --> 00:25:36,559
going to be stuff with like the m1 chips

695
00:25:36,559 --> 00:25:38,720
so you can see like arm versions of

696
00:25:38,720 --> 00:25:40,640
malware and all

697
00:25:40,640 --> 00:25:42,400
we think that'll keep happening

698
00:25:42,400 --> 00:25:44,240
and with that thank you very much

699
00:25:44,240 --> 00:25:46,000
there's a qr code that blog please read

700
00:25:46,000 --> 00:25:48,080
it it's got iocs everything you want you

701
00:25:48,080 --> 00:25:49,440
know again you want to find out what the

702
00:25:49,440 --> 00:25:51,760
stager looks like you want to find iocs

703
00:25:51,760 --> 00:25:54,320
for the malware and like network iocs

704
00:25:54,320 --> 00:25:56,159
please read the blog has very loads of

705
00:25:56,159 --> 00:25:58,480
technical details and please invite if

706
00:25:58,480 --> 00:26:01,039
you have any questions please

707
00:26:01,039 --> 00:26:04,380
we want you to ask us

708
00:26:04,380 --> 00:26:13,679
[Applause]

709
00:26:13,760 --> 00:26:16,799
thanks a lot um

710
00:26:16,799 --> 00:26:17,600
so

711
00:26:17,600 --> 00:26:20,480
these uh fine people will be

712
00:26:20,480 --> 00:26:22,159
available for questions later if you

713
00:26:22,159 --> 00:26:23,120
have some

714
00:26:23,120 --> 00:26:26,400
new as you want now

715
00:26:26,400 --> 00:26:29,150
oh yeah we do oh yeah all right

716
00:26:29,150 --> 00:26:31,039
[Music]

717
00:26:31,039 --> 00:26:33,039
question about like i totally agree with

718
00:26:33,039 --> 00:26:35,279
your assessment about the uh the lack of

719
00:26:35,279 --> 00:26:37,600
attention towards linux

720
00:26:37,600 --> 00:26:40,000
and um

721
00:26:40,000 --> 00:26:41,440
i've been thinking about that myself a

722
00:26:41,440 --> 00:26:44,880
lot running virtual machines etc and

723
00:26:44,880 --> 00:26:47,200
sort of the best i came across was root

724
00:26:47,200 --> 00:26:49,360
kit hunter and things like that

725
00:26:49,360 --> 00:26:51,200
is there some

726
00:26:51,200 --> 00:26:52,880
willingness and some effort to actually

727
00:26:52,880 --> 00:26:54,880
push to those existing

728
00:26:54,880 --> 00:26:56,400
easy

729
00:26:56,400 --> 00:27:00,000
sort of av light systems for linux or

730
00:27:00,000 --> 00:27:01,760
how do you recommend approaching the

731
00:27:01,760 --> 00:27:05,200
problem that you're identifying

732
00:27:05,200 --> 00:27:07,039
if i understand your question correctly

733
00:27:07,039 --> 00:27:10,559
you ask how to identify linux malware

734
00:27:10,559 --> 00:27:12,640
no uh how do we how do how do we bridge

735
00:27:12,640 --> 00:27:14,799
that gap that's you know the the problem

736
00:27:14,799 --> 00:27:16,960
like you know there's almost no

737
00:27:16,960 --> 00:27:20,080
no detection software by default in in

738
00:27:20,080 --> 00:27:22,799
linux in there so yeah um

739
00:27:22,799 --> 00:27:25,200
so i i can take that or yeah i said you

740
00:27:25,200 --> 00:27:26,640
said that yeah

741
00:27:26,640 --> 00:27:28,480
so basically

742
00:27:28,480 --> 00:27:30,080
windows when you buy it you have windows

743
00:27:30,080 --> 00:27:32,799
defender and you know there's

744
00:27:32,799 --> 00:27:35,120
a huge industry for endpoint and edr's

745
00:27:35,120 --> 00:27:36,080
and so on

746
00:27:36,080 --> 00:27:37,600
um they also

747
00:27:37,600 --> 00:27:39,520
the adrs also

748
00:27:39,520 --> 00:27:41,120
can run on linux

749
00:27:41,120 --> 00:27:42,240
and

750
00:27:42,240 --> 00:27:44,799
this is kind of the cso's work you know

751
00:27:44,799 --> 00:27:46,960
if you have you need to map all the

752
00:27:46,960 --> 00:27:49,279
machines in your in your company do you

753
00:27:49,279 --> 00:27:51,120
have servers which end points do you

754
00:27:51,120 --> 00:27:52,480
have to have mac do you have windows

755
00:27:52,480 --> 00:27:54,559
which percentage and make sure that you

756
00:27:54,559 --> 00:27:56,559
have coverage and there are solutions

757
00:27:56,559 --> 00:27:59,679
for for everything um i believe not for

758
00:27:59,679 --> 00:28:02,080
everything but there are many solutions

759
00:28:02,080 --> 00:28:05,760
so it's kind of the security posture and

760
00:28:05,760 --> 00:28:08,240
the assessment of what you have

761
00:28:08,240 --> 00:28:09,039
yes

762
00:28:09,039 --> 00:28:10,720
i don't quite agree because like linux

763
00:28:10,720 --> 00:28:12,320
as you pointed out is like really

764
00:28:12,320 --> 00:28:13,360
everywhere

765
00:28:13,360 --> 00:28:15,039
lots of it is in the cloud but also

766
00:28:15,039 --> 00:28:16,960
another big

767
00:28:16,960 --> 00:28:19,120
use user base for linux is embedded

768
00:28:19,120 --> 00:28:20,240
systems

769
00:28:20,240 --> 00:28:22,399
and in better systems you can't run like

770
00:28:22,399 --> 00:28:24,960
a full edr like on top

771
00:28:24,960 --> 00:28:27,840
um or yeah i mean

772
00:28:27,840 --> 00:28:29,360
the update cycles are different et

773
00:28:29,360 --> 00:28:31,120
cetera et cetera so we need something

774
00:28:31,120 --> 00:28:33,200
else and that's why i'm wondering like

775
00:28:33,200 --> 00:28:35,520
how do we address this problem

776
00:28:35,520 --> 00:28:38,159
um yeah yeah so

777
00:28:38,159 --> 00:28:41,360
i'm not actually i'm not sure what's the

778
00:28:41,360 --> 00:28:43,200
industry for embedded systems i know

779
00:28:43,200 --> 00:28:45,200
that there's industry for you know

780
00:28:45,200 --> 00:28:47,520
servers running intel and you know

781
00:28:47,520 --> 00:28:49,520
64-bit

782
00:28:49,520 --> 00:28:51,919
we also have a tool in an integer which

783
00:28:51,919 --> 00:28:54,559
is called protect for these kind of

784
00:28:54,559 --> 00:28:56,799
matters um do you want to take that or

785
00:28:56,799 --> 00:28:59,120
yeah it's sort of it depends how

786
00:28:59,120 --> 00:29:00,559
creative you are i know some people

787
00:29:00,559 --> 00:29:02,320
again like we have a product i won't

788
00:29:02,320 --> 00:29:04,399
talk about too much but um you know like

789
00:29:04,399 --> 00:29:06,320
we have things that scan like in memory

790
00:29:06,320 --> 00:29:08,240
you know to the tag code

791
00:29:08,240 --> 00:29:09,760
i know some other vendors have tried

792
00:29:09,760 --> 00:29:11,360
stuff where they'll take like an image

793
00:29:11,360 --> 00:29:13,520
you know of their vms and then sort of

794
00:29:13,520 --> 00:29:16,159
you know try scan you know those sort of

795
00:29:16,159 --> 00:29:18,320
snapshots of images from malware

796
00:29:18,320 --> 00:29:20,240
and other stuff like clown vm

797
00:29:20,240 --> 00:29:22,320
what i think is very interesting is that

798
00:29:22,320 --> 00:29:23,760
you know for linux there's not too many

799
00:29:23,760 --> 00:29:26,640
sandboxing solutions and you know what

800
00:29:26,640 --> 00:29:28,399
can also especially get hard like if you

801
00:29:28,399 --> 00:29:30,720
take uh you know vermilion strike there

802
00:29:30,720 --> 00:29:33,600
that particular sample it was compiled

803
00:29:33,600 --> 00:29:36,240
for like uh for centos or red hat you

804
00:29:36,240 --> 00:29:37,679
know so if you were trying to run it in

805
00:29:37,679 --> 00:29:40,960
like a ubuntu soundbox you know it would

806
00:29:40,960 --> 00:29:42,960
sort of break itself so it's it's almost

807
00:29:42,960 --> 00:29:44,399
like you need very good sound boxing

808
00:29:44,399 --> 00:29:45,919
solutions but for

809
00:29:45,919 --> 00:29:48,240
like different sort of distributions

810
00:29:48,240 --> 00:29:49,840
it's sometimes hard to get things their

811
00:29:49,840 --> 00:29:51,520
own so

812
00:29:51,520 --> 00:29:52,559
um

813
00:29:52,559 --> 00:29:53,520
yeah

814
00:29:53,520 --> 00:29:55,440
like if i were to say that the best

815
00:29:55,440 --> 00:29:57,039
always have product but

816
00:29:57,039 --> 00:29:59,039
the like yeah it depends how creative

817
00:29:59,039 --> 00:30:00,480
you are i would say the sort of bridge

818
00:30:00,480 --> 00:30:01,600
that go

819
00:30:01,600 --> 00:30:04,159
i i wouldn't say i know the perfect way

820
00:30:04,159 --> 00:30:06,640
okay thanks

821
00:30:06,640 --> 00:30:07,760
thank

822
00:30:07,760 --> 00:30:09,200
i guess the perfect way is to talk about

823
00:30:09,200 --> 00:30:11,679
it you know start start a discussion

824
00:30:11,679 --> 00:30:13,679
first question

825
00:30:13,679 --> 00:30:16,480
start discussion

826
00:30:16,559 --> 00:30:18,480
yeah hello

827
00:30:18,480 --> 00:30:21,200
i have a question about the protocol

828
00:30:21,200 --> 00:30:23,279
so i understood that

829
00:30:23,279 --> 00:30:25,120
it implements a subset of all the

830
00:30:25,120 --> 00:30:26,399
commands that you would find in the

831
00:30:26,399 --> 00:30:28,000
windows version so not all the commands

832
00:30:28,000 --> 00:30:29,360
are implemented

833
00:30:29,360 --> 00:30:31,520
is that correct uh i would say so yeah

834
00:30:31,520 --> 00:30:33,919
it's like a sort of minimal version do

835
00:30:33,919 --> 00:30:36,159
you have an id if a command like

836
00:30:36,159 --> 00:30:38,720
portscan if they implement it and i'm

837
00:30:38,720 --> 00:30:40,240
asking this question because in the

838
00:30:40,240 --> 00:30:42,960
protocol of cobalt strike if there is

839
00:30:42,960 --> 00:30:45,679
something like a port scan

840
00:30:45,679 --> 00:30:46,880
the

841
00:30:46,880 --> 00:30:48,559
standard windows

842
00:30:48,559 --> 00:30:49,520
beacon

843
00:30:49,520 --> 00:30:51,679
has no functionality to do the port scan

844
00:30:51,679 --> 00:30:54,559
so the team server will send over dll

845
00:30:54,559 --> 00:30:56,960
that is able to do the port so there's

846
00:30:56,960 --> 00:30:59,120
extra functionality being sent off so

847
00:30:59,120 --> 00:31:01,360
that's in the yeah the commercial

848
00:31:01,360 --> 00:31:03,600
version you know if something like that

849
00:31:03,600 --> 00:31:05,760
is implemented in the vermillion if they

850
00:31:05,760 --> 00:31:08,320
send over an elf for example for xlr

851
00:31:08,320 --> 00:31:10,880
functionality uh yeah i think you know

852
00:31:10,880 --> 00:31:12,000
what you mean like like they'll send

853
00:31:12,000 --> 00:31:14,159
down like the tool that see what we used

854
00:31:14,159 --> 00:31:16,080
no we didn't see that actually so

855
00:31:16,080 --> 00:31:17,360
there's basically there's the commands

856
00:31:17,360 --> 00:31:19,440
that can be run and then i think

857
00:31:19,440 --> 00:31:21,200
everything else it's if you can do it

858
00:31:21,200 --> 00:31:23,200
within a you know command that you can

859
00:31:23,200 --> 00:31:25,360
kind of run in like the terminal that's

860
00:31:25,360 --> 00:31:27,519
just like execute a command and have you

861
00:31:27,519 --> 00:31:30,559
seen commands implemented that are not

862
00:31:30,559 --> 00:31:34,000
existing in the commercial version

863
00:31:34,000 --> 00:31:36,080
um i'm not sure if like the gap the

864
00:31:36,080 --> 00:31:38,080
minded desks is out in

865
00:31:38,080 --> 00:31:39,519
the the commercial version of cobalt

866
00:31:39,519 --> 00:31:41,360
strike i thought that was quite

867
00:31:41,360 --> 00:31:43,679
interesting okay

868
00:31:43,679 --> 00:31:47,559
thank you thank you very much

869
00:31:49,600 --> 00:31:53,519
hi good question so you said um on linux

870
00:31:53,519 --> 00:31:56,399
it does drop a file on the system

871
00:31:56,399 --> 00:31:58,640
do you think it could go far less in the

872
00:31:58,640 --> 00:32:01,760
future is it possible on linux to do so

873
00:32:01,760 --> 00:32:05,200
uh it's possible yeah um

874
00:32:05,200 --> 00:32:07,679
i don't really see that happening you

875
00:32:07,679 --> 00:32:10,159
know where there's stuff like

876
00:32:10,159 --> 00:32:11,840
you know say if it's packed so there's

877
00:32:11,840 --> 00:32:13,200
like

878
00:32:13,200 --> 00:32:15,039
zuri packers for example if you pack it

879
00:32:15,039 --> 00:32:17,039
with missouri that will technically make

880
00:32:17,039 --> 00:32:18,640
it the phyllis

881
00:32:18,640 --> 00:32:20,159
but um

882
00:32:20,159 --> 00:32:21,519
i would say that there didn't seem to be

883
00:32:21,519 --> 00:32:23,279
any incentive to like when we found it

884
00:32:23,279 --> 00:32:24,240
there was

885
00:32:24,240 --> 00:32:26,559
zero detections and you know and

886
00:32:26,559 --> 00:32:28,480
honestly there's not even really any

887
00:32:28,480 --> 00:32:30,640
other obfuscation techniques you know

888
00:32:30,640 --> 00:32:32,240
it's not like it's installing root kits

889
00:32:32,240 --> 00:32:33,519
and then removing it from like the

890
00:32:33,519 --> 00:32:35,519
process list and all like it's

891
00:32:35,519 --> 00:32:37,360
in some ways like kind of basic so i

892
00:32:37,360 --> 00:32:38,480
would say

893
00:32:38,480 --> 00:32:40,720
i don't see it having it okay

894
00:32:40,720 --> 00:32:43,840
thanks thank you very much

895
00:32:46,000 --> 00:32:48,720
for that question

896
00:32:48,720 --> 00:32:49,760
um

897
00:32:49,760 --> 00:32:51,519
my experience

898
00:32:51,519 --> 00:32:52,799
in the last

899
00:32:52,799 --> 00:32:55,919
13 years as ibm researcher in the

900
00:32:55,919 --> 00:32:57,279
x-force team

901
00:32:57,279 --> 00:32:58,640
i

902
00:32:58,640 --> 00:33:02,080
analyzed several what net

903
00:33:02,080 --> 00:33:03,200
attacks

904
00:33:03,200 --> 00:33:04,399
and

905
00:33:04,399 --> 00:33:06,320
i find

906
00:33:06,320 --> 00:33:09,600
most of detour's attacks are

907
00:33:09,600 --> 00:33:11,760
also currently available

908
00:33:11,760 --> 00:33:13,679
or running at the moment

909
00:33:13,679 --> 00:33:16,080
i come from

910
00:33:16,080 --> 00:33:17,840
embedded devices

911
00:33:17,840 --> 00:33:19,360
for example

912
00:33:19,360 --> 00:33:21,519
cameras

913
00:33:21,519 --> 00:33:25,200
digital video recorders old solo routers

914
00:33:25,200 --> 00:33:27,840
and something like that and

915
00:33:27,840 --> 00:33:30,480
i think the big biggest problem that we

916
00:33:30,480 --> 00:33:33,039
have is

917
00:33:33,039 --> 00:33:35,519
this hardware or also the firmware of

918
00:33:35,519 --> 00:33:37,039
this devices

919
00:33:37,039 --> 00:33:39,600
are never updated

920
00:33:39,600 --> 00:33:42,640
and you can find very easily

921
00:33:42,640 --> 00:33:44,880
default username password databases on

922
00:33:44,880 --> 00:33:46,240
the internet

923
00:33:46,240 --> 00:33:47,200
and

924
00:33:47,200 --> 00:33:50,640
if you monitor such devices

925
00:33:50,640 --> 00:33:53,440
you can see permanently scans broad

926
00:33:53,440 --> 00:33:54,960
scans

927
00:33:54,960 --> 00:33:58,480
and if they detect something open

928
00:33:58,480 --> 00:34:01,039
on such a device

929
00:34:01,039 --> 00:34:03,840
the yeah the botnets

930
00:34:03,840 --> 00:34:07,519
have a war against

931
00:34:07,519 --> 00:34:08,800
each

932
00:34:08,800 --> 00:34:11,679
other botnet to to get

933
00:34:11,679 --> 00:34:14,320
access to the device

934
00:34:14,320 --> 00:34:15,119
and

935
00:34:15,119 --> 00:34:17,199
yeah mostly cameras

936
00:34:17,199 --> 00:34:19,119
i

937
00:34:19,119 --> 00:34:22,480
i see a lot of cameras in the asia

938
00:34:22,480 --> 00:34:24,800
pacific area

939
00:34:24,800 --> 00:34:27,520
these devices are installed set it and

940
00:34:27,520 --> 00:34:29,119
forget it

941
00:34:29,119 --> 00:34:31,359
that's i think it's my thinking the

942
00:34:31,359 --> 00:34:33,359
biggest problem

943
00:34:33,359 --> 00:34:35,599
for ddos attacks

944
00:34:35,599 --> 00:34:38,399
the last years and also at the moment

945
00:34:38,399 --> 00:34:40,560
did you increase this

946
00:34:40,560 --> 00:34:41,839
um

947
00:34:41,839 --> 00:34:44,560
we do not really focus on these kind of

948
00:34:44,560 --> 00:34:46,320
infrastructure

949
00:34:46,320 --> 00:34:49,918
but we see many um also i see many um

950
00:34:49,918 --> 00:34:52,239
publications and also we see many

951
00:34:52,239 --> 00:34:54,639
botnets that are coming to a system that

952
00:34:54,639 --> 00:34:56,879
are armed for example that can run of

953
00:34:56,879 --> 00:35:00,640
these uh yeah so it's very common um

954
00:35:00,640 --> 00:35:02,800
as you said before they scan the net

955
00:35:02,800 --> 00:35:05,760
they use default credentials maybe

956
00:35:05,760 --> 00:35:08,480
password sprayers and vulnerability

957
00:35:08,480 --> 00:35:10,560
exploits and so on yeah

958
00:35:10,560 --> 00:35:11,440
okay

959
00:35:11,440 --> 00:35:13,760
thank you very much

960
00:35:13,760 --> 00:35:14,720
thank you

961
00:35:14,720 --> 00:35:17,839
one question

962
00:35:18,079 --> 00:35:20,240
uh have you seen uh how far it will be

963
00:35:20,240 --> 00:35:22,240
effective uh by analyzing the dns

964
00:35:22,240 --> 00:35:24,960
request and response uh can you generate

965
00:35:24,960 --> 00:35:26,960
some patterns based on this cobar check

966
00:35:26,960 --> 00:35:28,160
beacons

967
00:35:28,160 --> 00:35:30,800
for network indicators a pattern of dns

968
00:35:30,800 --> 00:35:32,480
request and response

969
00:35:32,480 --> 00:35:34,240
has there been any implementation like

970
00:35:34,240 --> 00:35:36,320
that in the security community

971
00:35:36,320 --> 00:35:39,119
at the ips or firewall

972
00:35:39,119 --> 00:35:41,760
um if i'm sort of let me go back a few

973
00:35:41,760 --> 00:35:44,000
slides maybe to where i have screenshots

974
00:35:44,000 --> 00:35:46,800
of the answer and i'll try to figure out

975
00:35:46,800 --> 00:35:49,119
i mean

976
00:35:49,760 --> 00:35:52,880
yeah so here um so are you asking sort

977
00:35:52,880 --> 00:35:55,520
of maybe you could get like this pattern

978
00:35:55,520 --> 00:35:56,640
if you saw

979
00:35:56,640 --> 00:36:00,079
you know these types of uh queries in

980
00:36:00,079 --> 00:36:02,640
sequence that you could attack that yeah

981
00:36:02,640 --> 00:36:04,160
i would say could do that that you can

982
00:36:04,160 --> 00:36:06,800
probably deal with snort and uh and uh

983
00:36:06,800 --> 00:36:09,520
sarah carla so what's interesting about

984
00:36:09,520 --> 00:36:11,680
this is that you'll see that um you know

985
00:36:11,680 --> 00:36:16,000
this is the c2 address here but the um

986
00:36:16,000 --> 00:36:18,079
so these numbers beforehand this is

987
00:36:18,079 --> 00:36:20,079
actually a randomly generated number so

988
00:36:20,079 --> 00:36:22,640
said they keep that but then they sort

989
00:36:22,640 --> 00:36:24,560
of will change stuff so a lot of these

990
00:36:24,560 --> 00:36:26,560
are in the config it'll be you know

991
00:36:26,560 --> 00:36:28,400
apple that them there's you know there's

992
00:36:28,400 --> 00:36:30,400
apple facebook there was um there was

993
00:36:30,400 --> 00:36:32,079
kind of sequence of which that would run

994
00:36:32,079 --> 00:36:35,040
so i'd probably say yes um i would say

995
00:36:35,040 --> 00:36:38,640
maybe the best way snort uh and

996
00:36:38,640 --> 00:36:40,640
sarakata i think you can add a sequence

997
00:36:40,640 --> 00:36:43,200
in there if i'm not mistaken

998
00:36:43,200 --> 00:36:46,319
thank you thank you very much

999
00:36:49,599 --> 00:36:52,320
uh thanks for als good questions uh see

1000
00:36:52,320 --> 00:36:55,359
we're out of time so with those last

1001
00:36:55,359 --> 00:36:56,480
words

1002
00:36:56,480 --> 00:36:57,440
i say

1003
00:36:57,440 --> 00:36:59,359
thank you again to into sir

1004
00:36:59,359 --> 00:37:02,759
thank you very much

