1
00:00:05,870 --> 00:00:07,759
[Music]

2
00:00:07,759 --> 00:00:10,320
so welcome uh to this presentation which

3
00:00:10,320 --> 00:00:12,639
will be given by olaf hartung and he's a

4
00:00:12,639 --> 00:00:14,400
defensive specialist and security

5
00:00:14,400 --> 00:00:16,720
researcher at falconforce

6
00:00:16,720 --> 00:00:19,520
the presentation is idr internals from a

7
00:00:19,520 --> 00:00:22,000
defender's perspective and olof will

8
00:00:22,000 --> 00:00:22,720
tell

9
00:00:22,720 --> 00:00:24,160
more about that

10
00:00:24,160 --> 00:00:26,000
just to remind about the rules this is

11
00:00:26,000 --> 00:00:28,160
tlp white session

12
00:00:28,160 --> 00:00:30,320
please switch off your mobile phones so

13
00:00:30,320 --> 00:00:32,000
that we don't get any

14
00:00:32,000 --> 00:00:33,920
uh unpleasant noises during the

15
00:00:33,920 --> 00:00:35,360
presentation

16
00:00:35,360 --> 00:00:38,239
and after the session please do fill in

17
00:00:38,239 --> 00:00:41,920
the evaluation on the mobile app to show

18
00:00:41,920 --> 00:00:42,960
how do you

19
00:00:42,960 --> 00:00:45,360
like the presentation thank you very

20
00:00:45,360 --> 00:00:47,920
much and olaf welcome

21
00:00:47,920 --> 00:00:49,680
thank you

22
00:00:49,680 --> 00:00:51,920
i just set my own timer

23
00:00:51,920 --> 00:00:54,000
so good morning everyone thanks for

24
00:00:54,000 --> 00:00:56,239
making it up um

25
00:00:56,239 --> 00:00:58,719
just a brief introduction to add to it

26
00:00:58,719 --> 00:01:01,520
so um my name is oliverton as mentioned

27
00:01:01,520 --> 00:01:02,719
before

28
00:01:02,719 --> 00:01:05,519
i work at falconforce and one of the

29
00:01:05,519 --> 00:01:06,799
things that we do and i don't want to

30
00:01:06,799 --> 00:01:08,720
make this into a sales talk but we

31
00:01:08,720 --> 00:01:10,560
primarily focus on a lot of detection

32
00:01:10,560 --> 00:01:12,560
engineering a lot of research

33
00:01:12,560 --> 00:01:14,159
and a lot of offensive work and that's

34
00:01:14,159 --> 00:01:16,640
also why we started digging into edrs

35
00:01:16,640 --> 00:01:18,640
because that's what everybody uses or

36
00:01:18,640 --> 00:01:19,680
should use

37
00:01:19,680 --> 00:01:22,080
just to figure out what it's capable of

38
00:01:22,080 --> 00:01:23,680
and how we can

39
00:01:23,680 --> 00:01:27,280
make it useful for us as a as a defender

40
00:01:27,280 --> 00:01:29,600
but also for an attacker perspective

41
00:01:29,600 --> 00:01:32,079
to understand how can we bypass it and

42
00:01:32,079 --> 00:01:34,159
detect that again

43
00:01:34,159 --> 00:01:36,240
so i have a broad background in all

44
00:01:36,240 --> 00:01:37,840
kinds of threat hunting ir and these

45
00:01:37,840 --> 00:01:39,759
kind of things you can read

46
00:01:39,759 --> 00:01:42,000
i went to art school so i never studied

47
00:01:42,000 --> 00:01:43,840
computer science and

48
00:01:43,840 --> 00:01:46,479
nor should you but it would help

49
00:01:46,479 --> 00:01:48,079
i'm father two boys and of course i like

50
00:01:48,079 --> 00:01:49,520
warm hugs for the people that have seen

51
00:01:49,520 --> 00:01:52,799
frozen i really like disney for that

52
00:01:52,799 --> 00:01:54,880
so what can you expect from this talk so

53
00:01:54,880 --> 00:01:56,880
i'll generally talk about defender for

54
00:01:56,880 --> 00:01:58,240
endpoint

55
00:01:58,240 --> 00:02:01,439
from microsoft um i mean also an mvp i'm

56
00:02:01,439 --> 00:02:04,320
not a commercial vehicle because it will

57
00:02:04,320 --> 00:02:06,320
be a critical talk

58
00:02:06,320 --> 00:02:08,878
but this applies to every edr

59
00:02:08,878 --> 00:02:10,318
technically right so there might be

60
00:02:10,318 --> 00:02:12,000
differences and all kinds of things but

61
00:02:12,000 --> 00:02:13,840
the whole the whole way they work are

62
00:02:13,840 --> 00:02:15,840
generally the same

63
00:02:15,840 --> 00:02:17,200
so i started looking at what kind of

64
00:02:17,200 --> 00:02:18,959
telemetry does it bring you what can you

65
00:02:18,959 --> 00:02:20,560
do with it

66
00:02:20,560 --> 00:02:22,319
where does it come from which is also

67
00:02:22,319 --> 00:02:24,000
very important also from an attacker

68
00:02:24,000 --> 00:02:25,680
perspective because you might have a

69
00:02:25,680 --> 00:02:27,520
separate set of telemetry that you want

70
00:02:27,520 --> 00:02:29,120
to augment to it just to make sure that

71
00:02:29,120 --> 00:02:30,239
you have it

72
00:02:30,239 --> 00:02:32,319
um it's configured so we also want to

73
00:02:32,319 --> 00:02:34,160
show a little over know a little bit

74
00:02:34,160 --> 00:02:36,080
what what it's actually doing how it's

75
00:02:36,080 --> 00:02:38,239
getting its information and then i have

76
00:02:38,239 --> 00:02:40,400
a wrap up and if i go too fast i have

77
00:02:40,400 --> 00:02:43,360
backup slides for some additional fun

78
00:02:43,360 --> 00:02:45,120
so first of all what what can you do

79
00:02:45,120 --> 00:02:47,200
with it right so it's a it's a sort of

80
00:02:47,200 --> 00:02:50,239
all-in-one trying to be solution

81
00:02:50,239 --> 00:02:52,480
xdr whatever

82
00:02:52,480 --> 00:02:54,080
it doesn't really matter

83
00:02:54,080 --> 00:02:56,319
it has a couple of components and the

84
00:02:56,319 --> 00:02:58,879
most important ones are av

85
00:02:58,879 --> 00:03:00,640
attack service reduction which is sort

86
00:03:00,640 --> 00:03:02,400
of part of the operating system as well

87
00:03:02,400 --> 00:03:04,480
so it ties into each other but it

88
00:03:04,480 --> 00:03:07,200
doesn't necessarily have to be bought

89
00:03:07,200 --> 00:03:08,959
you have exploit guard the application

90
00:03:08,959 --> 00:03:10,560
control there's of course the edr

91
00:03:10,560 --> 00:03:13,200
component that is cloud-based

92
00:03:13,200 --> 00:03:14,879
um there is there is some incident

93
00:03:14,879 --> 00:03:16,480
response capability where you can live

94
00:03:16,480 --> 00:03:18,640
connect to a host do some memory dumps

95
00:03:18,640 --> 00:03:20,640
some small analysis things get some

96
00:03:20,640 --> 00:03:22,480
artifacts

97
00:03:22,480 --> 00:03:24,959
it does do some vulnerability management

98
00:03:24,959 --> 00:03:26,720
or scanning

99
00:03:26,720 --> 00:03:28,720
there's a network sensor it has dop

100
00:03:28,720 --> 00:03:30,640
capabilities you can even scan networks

101
00:03:30,640 --> 00:03:32,000
these kind of things so it's being

102
00:03:32,000 --> 00:03:34,400
expanded constantly

103
00:03:34,400 --> 00:03:36,319
just use whatever you like so the av

104
00:03:36,319 --> 00:03:38,239
component of course is embedded already

105
00:03:38,239 --> 00:03:39,760
in the operating system that just

106
00:03:39,760 --> 00:03:43,120
ingests the alerts into the edr product

107
00:03:43,120 --> 00:03:45,200
of course it's very signature based

108
00:03:45,200 --> 00:03:48,080
as every edr mostly does

109
00:03:48,080 --> 00:03:49,519
it does do also some cloud-based

110
00:03:49,519 --> 00:03:51,200
analysis of the samples that it can

111
00:03:51,200 --> 00:03:52,959
upload if you allow it to

112
00:03:52,959 --> 00:03:55,120
and if you want to be a little bit more

113
00:03:55,120 --> 00:03:56,879
into what the capabilities of the

114
00:03:56,879 --> 00:03:59,200
signature database are there's a great

115
00:03:59,200 --> 00:04:01,599
research project from camille moogie

116
00:04:01,599 --> 00:04:03,439
probably butchering his name sorry he

117
00:04:03,439 --> 00:04:05,920
works for the france french ansi

118
00:04:05,920 --> 00:04:08,640
and he basically found a way to do to

119
00:04:08,640 --> 00:04:11,360
decrypt the whole database

120
00:04:11,360 --> 00:04:12,640
so a couple of things that you should be

121
00:04:12,640 --> 00:04:14,640
aware of of course you can exclude stuff

122
00:04:14,640 --> 00:04:16,320
from av like like

123
00:04:16,320 --> 00:04:18,639
sometimes should be useful

124
00:04:18,639 --> 00:04:19,759
but this is also something that

125
00:04:19,759 --> 00:04:21,839
attackers will at least try immediately

126
00:04:21,839 --> 00:04:23,360
when they hit the box so definitely make

127
00:04:23,360 --> 00:04:25,759
sure you monitor that

128
00:04:25,759 --> 00:04:27,600
and there are some couple of quirks

129
00:04:27,600 --> 00:04:30,240
where you can also exclude a process for

130
00:04:30,240 --> 00:04:32,400
instance but it won't exclude that

131
00:04:32,400 --> 00:04:34,320
process it will exclude the child of

132
00:04:34,320 --> 00:04:36,080
that process so if you want to

133
00:04:36,080 --> 00:04:37,759
have a certain tree that you don't want

134
00:04:37,759 --> 00:04:40,720
to see being caught then you should

135
00:04:40,720 --> 00:04:42,639
address that accordingly and

136
00:04:42,639 --> 00:04:44,639
if you exclude something then it's only

137
00:04:44,639 --> 00:04:46,240
excluded for the av which is kind of

138
00:04:46,240 --> 00:04:48,639
nice because then still the edr and all

139
00:04:48,639 --> 00:04:51,440
the other components will apply to it so

140
00:04:51,440 --> 00:04:52,880
if you want to exclude it there you have

141
00:04:52,880 --> 00:04:55,520
to make multiple exclusions

142
00:04:55,520 --> 00:04:58,000
um and if you really want to see how it

143
00:04:58,000 --> 00:04:59,199
works there's a couple of tools so you

144
00:04:59,199 --> 00:05:01,759
have defender check which is a tool uh

145
00:05:01,759 --> 00:05:03,919
that i sometimes use if i want to see

146
00:05:03,919 --> 00:05:05,919
why it triggered on something

147
00:05:05,919 --> 00:05:06,960
so

148
00:05:06,960 --> 00:05:08,880
it didn't used to be but now it's also

149
00:05:08,880 --> 00:05:11,120
detected by the av because they think

150
00:05:11,120 --> 00:05:13,039
it's a malicious tool so you can use

151
00:05:13,039 --> 00:05:15,600
defender check to check on the fender

152
00:05:15,600 --> 00:05:17,680
check to check on the fender sort of

153
00:05:17,680 --> 00:05:19,919
weird weird deep dive but basically what

154
00:05:19,919 --> 00:05:21,680
you can see is is

155
00:05:21,680 --> 00:05:24,080
the bit that the av engine triggered on

156
00:05:24,080 --> 00:05:25,919
and then if you're a malware developer

157
00:05:25,919 --> 00:05:27,759
you could change a bit of that code

158
00:05:27,759 --> 00:05:30,639
usually it's a bit of string or comment

159
00:05:30,639 --> 00:05:32,639
and you might be able to bypass the av

160
00:05:32,639 --> 00:05:33,919
that way it's just to understand a

161
00:05:33,919 --> 00:05:34,880
little bit

162
00:05:34,880 --> 00:05:36,560
also if you have a legitimate tool why

163
00:05:36,560 --> 00:05:37,919
it triggered and you might be able to

164
00:05:37,919 --> 00:05:39,120
talk to the

165
00:05:39,120 --> 00:05:41,280
developers

166
00:05:41,280 --> 00:05:42,800
other component is the attack service

167
00:05:42,800 --> 00:05:44,400
reduction one

168
00:05:44,400 --> 00:05:46,639
and this is built in as i mentioned just

169
00:05:46,639 --> 00:05:48,880
into windows 10 and up

170
00:05:48,880 --> 00:05:51,120
and it's a super powerful feature so

171
00:05:51,120 --> 00:05:53,759
there's like 16 rules for office child

172
00:05:53,759 --> 00:05:56,160
child processes and so on

173
00:05:56,160 --> 00:05:59,520
which you should enable always

174
00:05:59,520 --> 00:06:01,039
but you can you can configure them in

175
00:06:01,039 --> 00:06:02,319
blocking or audit mode so in the

176
00:06:02,319 --> 00:06:04,400
beginning definitely don't block

177
00:06:04,400 --> 00:06:05,840
because you might break stuff and people

178
00:06:05,840 --> 00:06:06,960
will be mad

179
00:06:06,960 --> 00:06:07,840
but

180
00:06:07,840 --> 00:06:11,120
um the ones that you do think

181
00:06:11,120 --> 00:06:12,639
should be blocked you can at least start

182
00:06:12,639 --> 00:06:14,800
enabling because it's a really powerful

183
00:06:14,800 --> 00:06:17,600
way of making it harder for an attacker

184
00:06:17,600 --> 00:06:20,479
without too much hassle so the graph

185
00:06:20,479 --> 00:06:22,160
that you see here is built by by

186
00:06:22,160 --> 00:06:24,800
palantir a us company and they basically

187
00:06:24,800 --> 00:06:26,560
had a sort of generic

188
00:06:26,560 --> 00:06:28,720
guidance into which ones should be safe

189
00:06:28,720 --> 00:06:30,319
for most companies

190
00:06:30,319 --> 00:06:31,680
and the rest you might want to

191
00:06:31,680 --> 00:06:32,800
investigate

192
00:06:32,800 --> 00:06:34,400
still you want to also investigate the

193
00:06:34,400 --> 00:06:36,800
safe ones because you never know if it

194
00:06:36,800 --> 00:06:38,319
is different for you and it's relatively

195
00:06:38,319 --> 00:06:39,840
easy to enable it's just a couple of

196
00:06:39,840 --> 00:06:42,479
gpos that you can push

197
00:06:42,479 --> 00:06:44,400
or register keys via intune or whatever

198
00:06:44,400 --> 00:06:46,800
you're using so it's relatively safe and

199
00:06:46,800 --> 00:06:49,520
again this is also something that is

200
00:06:49,520 --> 00:06:52,319
slightly rule based so this is an extra

201
00:06:52,319 --> 00:06:54,400
extract also from that same research

202
00:06:54,400 --> 00:06:55,759
from camille

203
00:06:55,759 --> 00:06:58,240
where they have all kinds of lua scripts

204
00:06:58,240 --> 00:06:59,599
that run

205
00:06:59,599 --> 00:07:01,520
in the engine for the

206
00:07:01,520 --> 00:07:03,759
for the asr rules and i

207
00:07:03,759 --> 00:07:05,360
highlighted a couple where you can just

208
00:07:05,360 --> 00:07:07,919
see some are are quite bad in a way

209
00:07:07,919 --> 00:07:09,759
because they they just look at two

210
00:07:09,759 --> 00:07:12,080
folders in a whole path so if you know

211
00:07:12,080 --> 00:07:13,680
this as an attacker you can just create

212
00:07:13,680 --> 00:07:16,080
those two folders drop your malware and

213
00:07:16,080 --> 00:07:18,319
it will bypass this rule

214
00:07:18,319 --> 00:07:20,639
it's still a little bit of fiddly but

215
00:07:20,639 --> 00:07:22,960
this is a way to bypass it and microsoft

216
00:07:22,960 --> 00:07:24,800
is working on addressing this to also

217
00:07:24,800 --> 00:07:26,560
look a little bit more

218
00:07:26,560 --> 00:07:28,080
in a broader sense

219
00:07:28,080 --> 00:07:29,919
than only past command lines and file

220
00:07:29,919 --> 00:07:31,199
names

221
00:07:31,199 --> 00:07:32,639
but there's something to be aware of

222
00:07:32,639 --> 00:07:34,960
right as a defender another one is the

223
00:07:34,960 --> 00:07:36,880
defender application control which is an

224
00:07:36,880 --> 00:07:39,120
extremely powerful feature

225
00:07:39,120 --> 00:07:40,880
where you can basically

226
00:07:40,880 --> 00:07:43,120
kill everything anything on a box that

227
00:07:43,120 --> 00:07:45,599
you don't want there

228
00:07:45,599 --> 00:07:47,039
and you can do that on all the

229
00:07:47,039 --> 00:07:48,960
attributes that are listed there so it's

230
00:07:48,960 --> 00:07:50,879
again very powerful there's a lot of

231
00:07:50,879 --> 00:07:53,280
great research by matt graber on this

232
00:07:53,280 --> 00:07:55,039
something that you might want to look

233
00:07:55,039 --> 00:07:56,639
into it's like application whitelisting

234
00:07:56,639 --> 00:07:58,240
it's complicated i have to grant that

235
00:07:58,240 --> 00:07:59,039
but

236
00:07:59,039 --> 00:08:00,400
if you just have a

237
00:08:00,400 --> 00:08:01,759
there's a couple of lists even with

238
00:08:01,759 --> 00:08:03,360
malicious drivers and some stuff that

239
00:08:03,360 --> 00:08:05,199
you probably don't want on your systems

240
00:08:05,199 --> 00:08:06,560
just start with that

241
00:08:06,560 --> 00:08:08,240
and maybe

242
00:08:08,240 --> 00:08:10,720
use it only in audit mode again so that

243
00:08:10,720 --> 00:08:12,160
at least you have telemetry when you

244
00:08:12,160 --> 00:08:13,840
know something that you probably think

245
00:08:13,840 --> 00:08:16,720
is suspicious will will be executed

246
00:08:16,720 --> 00:08:18,479
and this also goes for driver loads and

247
00:08:18,479 --> 00:08:20,479
all kinds of other telemetry so if you

248
00:08:20,479 --> 00:08:22,720
only rely on your native event logs and

249
00:08:22,720 --> 00:08:24,960
your edr you might wanna augment it with

250
00:08:24,960 --> 00:08:26,960
this

251
00:08:26,960 --> 00:08:28,479
and then of course the edr telemetry is

252
00:08:28,479 --> 00:08:30,560
there right so this is probably the gist

253
00:08:30,560 --> 00:08:34,880
of of where an edr becomes powerful

254
00:08:34,880 --> 00:08:37,599
and in the defender for endpoint case it

255
00:08:37,599 --> 00:08:40,719
relies primarily on the sense service

256
00:08:40,719 --> 00:08:42,559
which is an a service that runs on your

257
00:08:42,559 --> 00:08:44,800
windows box and it gathers all kinds of

258
00:08:44,800 --> 00:08:46,399
events and ships it off to the cloud

259
00:08:46,399 --> 00:08:48,240
where it gets analyzed and then if they

260
00:08:48,240 --> 00:08:49,600
find something they push it back and

261
00:08:49,600 --> 00:08:51,600
block it

262
00:08:51,600 --> 00:08:53,279
and all of those events

263
00:08:53,279 --> 00:08:55,279
are basically stored in a

264
00:08:55,279 --> 00:08:57,839
advanced hunting table as they call it

265
00:08:57,839 --> 00:08:59,600
which is basically a log analytics

266
00:08:59,600 --> 00:09:01,920
workspace on azure

267
00:09:01,920 --> 00:09:03,360
that you can query with the gusto

268
00:09:03,360 --> 00:09:05,519
language

269
00:09:05,519 --> 00:09:07,279
and a couple of things to note is

270
00:09:07,279 --> 00:09:09,040
basically the most important one is

271
00:09:09,040 --> 00:09:11,600
which the events that are logged

272
00:09:11,600 --> 00:09:14,080
and visible is controlled uh by

273
00:09:14,080 --> 00:09:16,480
microsoft and they they control that

274
00:09:16,480 --> 00:09:18,000
configuration you can't say hey i'm

275
00:09:18,000 --> 00:09:19,440
interested in the registry key and i

276
00:09:19,440 --> 00:09:21,279
don't see it yet

277
00:09:21,279 --> 00:09:23,120
too bad yeah you can ask them right so

278
00:09:23,120 --> 00:09:25,519
you can you can open a ticket request it

279
00:09:25,519 --> 00:09:27,680
with a reason and it's relatively likely

280
00:09:27,680 --> 00:09:29,600
that they'll do it but they don't do it

281
00:09:29,600 --> 00:09:31,519
tomorrow might take a couple of months

282
00:09:31,519 --> 00:09:33,279
depending on the backlog

283
00:09:33,279 --> 00:09:34,720
so this is something to take into

284
00:09:34,720 --> 00:09:36,560
account and then another one that is

285
00:09:36,560 --> 00:09:38,560
very important so some of those events

286
00:09:38,560 --> 00:09:39,440
are

287
00:09:39,440 --> 00:09:40,720
sampled

288
00:09:40,720 --> 00:09:43,120
or at least filtered

289
00:09:43,120 --> 00:09:45,040
and the reason that they do that and

290
00:09:45,040 --> 00:09:46,959
well you can see which ones they are but

291
00:09:46,959 --> 00:09:48,800
the reason probably why the primary

292
00:09:48,800 --> 00:09:51,360
reasons is one you pay a fixed amount

293
00:09:51,360 --> 00:09:53,760
per month for that service so they have

294
00:09:53,760 --> 00:09:57,040
to sort of constrain their resource use

295
00:09:57,040 --> 00:09:59,680
which is probably the primary one

296
00:09:59,680 --> 00:10:01,680
the second one is a lot of people don't

297
00:10:01,680 --> 00:10:03,360
even use the telemetry so it's also a

298
00:10:03,360 --> 00:10:05,600
ways to store it i think that's that's

299
00:10:05,600 --> 00:10:08,240
both their reasons to do it um and then

300
00:10:08,240 --> 00:10:09,440
of course there's some bandwidth

301
00:10:09,440 --> 00:10:11,200
restrictions that they want to keep it

302
00:10:11,200 --> 00:10:12,959
contained in a way but

303
00:10:12,959 --> 00:10:15,279
um generally it's it's okay so for

304
00:10:15,279 --> 00:10:17,040
instance the network connections are are

305
00:10:17,040 --> 00:10:18,079
heavily

306
00:10:18,079 --> 00:10:19,839
rate limited so you usually get the

307
00:10:19,839 --> 00:10:21,680
first scene event

308
00:10:21,680 --> 00:10:24,720
of that day with a lot of fields

309
00:10:24,720 --> 00:10:27,120
so it's relatively it's relatively okay

310
00:10:27,120 --> 00:10:28,880
but you can't see beaconing or that kind

311
00:10:28,880 --> 00:10:29,920
of stuff

312
00:10:29,920 --> 00:10:32,640
so be aware of that because

313
00:10:32,640 --> 00:10:34,160
if you want to build a detection rule

314
00:10:34,160 --> 00:10:36,399
that looks for beaconing behavior

315
00:10:36,399 --> 00:10:38,480
this is probably not your data source

316
00:10:38,480 --> 00:10:40,800
um and it heavily relies on the event

317
00:10:40,800 --> 00:10:42,880
racing for windows as well so i'll dig

318
00:10:42,880 --> 00:10:45,600
into that a little bit

319
00:10:45,600 --> 00:10:45,839
and longer

320
00:10:45,839 --> 00:10:47,680
even generate their own

321
00:10:47,680 --> 00:10:50,160
native etw events which you might have a

322
00:10:50,160 --> 00:10:52,560
look at as well if you start looking

323
00:10:52,560 --> 00:10:55,920
for for special events

324
00:10:56,000 --> 00:10:57,120
so

325
00:10:57,120 --> 00:10:59,920
as i mentioned so you pay per per device

326
00:10:59,920 --> 00:11:01,920
or per user a little bit depends if it's

327
00:11:01,920 --> 00:11:03,920
a server or a workstation

328
00:11:03,920 --> 00:11:06,240
and they they keep the data in the cloud

329
00:11:06,240 --> 00:11:08,480
for you for 30 days

330
00:11:08,480 --> 00:11:11,200
um and the marketing says 180 days but

331
00:11:11,200 --> 00:11:13,200
that's basically the timeline so they

332
00:11:13,200 --> 00:11:14,959
also make a sort of very condensed

333
00:11:14,959 --> 00:11:18,480
version of your already condensed uh

334
00:11:18,480 --> 00:11:20,640
telemetry and you can create that for

335
00:11:20,640 --> 00:11:22,720
180 days but you can't query it with the

336
00:11:22,720 --> 00:11:24,320
query language you have to use this

337
00:11:24,320 --> 00:11:26,079
search box or the portal which isn't a

338
00:11:26,079 --> 00:11:29,279
very nice experience and

339
00:11:29,279 --> 00:11:30,399
if you want it longer you have to

340
00:11:30,399 --> 00:11:32,320
basically get it from the api extract it

341
00:11:32,320 --> 00:11:33,839
store it somewhere else there's plenty

342
00:11:33,839 --> 00:11:35,360
of ways to do it there's all kinds of

343
00:11:35,360 --> 00:11:37,120
azure solutions but you can also get it

344
00:11:37,120 --> 00:11:38,480
to splunk or whatever you're using

345
00:11:38,480 --> 00:11:40,079
locally

346
00:11:40,079 --> 00:11:42,160
which would be a good idea because 30

347
00:11:42,160 --> 00:11:44,079
days is nice but if you have an incident

348
00:11:44,079 --> 00:11:46,160
you generally want to look at look at

349
00:11:46,160 --> 00:11:48,000
least longer

350
00:11:48,000 --> 00:11:50,000
um and on average i think i think this

351
00:11:50,000 --> 00:11:51,200
slide is a little bit out there but it's

352
00:11:51,200 --> 00:11:53,600
like 20 to 25 megabytes per device per

353
00:11:53,600 --> 00:11:55,279
day so it's

354
00:11:55,279 --> 00:11:57,279
yeah it's not it's not a lot but it's

355
00:11:57,279 --> 00:12:00,079
also not very little um and depending on

356
00:12:00,079 --> 00:12:01,760
how active you want to be with that data

357
00:12:01,760 --> 00:12:03,200
it's probably too little for you if you

358
00:12:03,200 --> 00:12:04,959
want to get a lot of it but

359
00:12:04,959 --> 00:12:07,120
it's it's storable

360
00:12:07,120 --> 00:12:08,000
and then

361
00:12:08,000 --> 00:12:10,000
it's structured in a way that it's it's

362
00:12:10,000 --> 00:12:12,079
like a database right so there's tables

363
00:12:12,079 --> 00:12:13,920
and then within the tables there there

364
00:12:13,920 --> 00:12:16,160
is a schema with all kinds of fields

365
00:12:16,160 --> 00:12:18,480
um and basically what you can do you can

366
00:12:18,480 --> 00:12:21,040
query the the interface itself

367
00:12:21,040 --> 00:12:22,560
tell it to get the schema and you get

368
00:12:22,560 --> 00:12:24,639
all the fields listed

369
00:12:24,639 --> 00:12:26,480
but that doesn't go

370
00:12:26,480 --> 00:12:28,240
to the depth that you want it because

371
00:12:28,240 --> 00:12:30,160
what they do for the at least for the

372
00:12:30,160 --> 00:12:31,600
device events

373
00:12:31,600 --> 00:12:33,360
is they have a sort of catch-all bucket

374
00:12:33,360 --> 00:12:35,040
where the action type

375
00:12:35,040 --> 00:12:36,959
is basically filled with with the whole

376
00:12:36,959 --> 00:12:40,079
list and way more i think there's 185

377
00:12:40,079 --> 00:12:42,240
different action types in there now and

378
00:12:42,240 --> 00:12:45,200
they go from those asr events exploit

379
00:12:45,200 --> 00:12:47,519
guards

380
00:12:47,519 --> 00:12:50,000
usb devices plugged in

381
00:12:50,000 --> 00:12:51,600
but also

382
00:12:51,600 --> 00:12:54,160
for instance uh elsa's dumping

383
00:12:54,160 --> 00:12:56,079
is also in there and then there's all

384
00:12:56,079 --> 00:12:57,920
kinds of additional fields

385
00:12:57,920 --> 00:13:00,240
tied to that event which gives you all

386
00:13:00,240 --> 00:13:03,040
kinds of very nice json information

387
00:13:03,040 --> 00:13:04,079
which you can actually use in the

388
00:13:04,079 --> 00:13:06,800
detection but keeping track of that is

389
00:13:06,800 --> 00:13:08,399
relatively difficult because they

390
00:13:08,399 --> 00:13:10,240
constantly onboard new information for

391
00:13:10,240 --> 00:13:11,040
you

392
00:13:11,040 --> 00:13:12,959
but you're not necessarily notified of

393
00:13:12,959 --> 00:13:14,720
that so one of the things that you can

394
00:13:14,720 --> 00:13:17,279
do there's there's this schema reference

395
00:13:17,279 --> 00:13:19,600
guide in the portal where you can browse

396
00:13:19,600 --> 00:13:21,600
through it and see what is there

397
00:13:21,600 --> 00:13:23,120
but nobody wants to scroll and then

398
00:13:23,120 --> 00:13:25,200
remember everything so

399
00:13:25,200 --> 00:13:27,200
what you can also do is just

400
00:13:27,200 --> 00:13:29,760
open the hacker tab with f12

401
00:13:29,760 --> 00:13:31,839
and then basically get that

402
00:13:31,839 --> 00:13:34,079
through the api so you can get the api

403
00:13:34,079 --> 00:13:36,320
call that they do

404
00:13:36,320 --> 00:13:38,399
and basically build a very simple script

405
00:13:38,399 --> 00:13:40,880
where you can download it and do a diff

406
00:13:40,880 --> 00:13:42,240
and then you can build a slack bot for

407
00:13:42,240 --> 00:13:43,839
instance that tells you every time they

408
00:13:43,839 --> 00:13:45,920
added some new data components which is

409
00:13:45,920 --> 00:13:47,360
kind of nice because you want to be on

410
00:13:47,360 --> 00:13:50,480
top of what you can use

411
00:13:51,839 --> 00:13:53,600
out of the box they generate all kinds

412
00:13:53,600 --> 00:13:55,440
of alerts and this is nice but you never

413
00:13:55,440 --> 00:13:58,160
know what they do so what we try to do

414
00:13:58,160 --> 00:14:00,240
and i deliberately share an old slide

415
00:14:00,240 --> 00:14:02,639
because i don't want to help anybody on

416
00:14:02,639 --> 00:14:04,399
the offensive side

417
00:14:04,399 --> 00:14:05,760
and since this is broadcasters i don't

418
00:14:05,760 --> 00:14:07,920
know who's watching but basically what

419
00:14:07,920 --> 00:14:10,240
we do is try tracking across all of our

420
00:14:10,240 --> 00:14:12,399
clients and our friends

421
00:14:12,399 --> 00:14:13,920
anonymously what

422
00:14:13,920 --> 00:14:16,560
type of alerts are triggered plus we do

423
00:14:16,560 --> 00:14:17,920
a lot of research ourselves so we

424
00:14:17,920 --> 00:14:19,279
constantly trigger all kinds of

425
00:14:19,279 --> 00:14:21,440
out-of-the-box alerts and this can help

426
00:14:21,440 --> 00:14:23,519
us at least understand okay where is it

427
00:14:23,519 --> 00:14:25,519
strong where is it weaker so where do we

428
00:14:25,519 --> 00:14:27,279
need to do stuff ourselves build

429
00:14:27,279 --> 00:14:30,399
detections or get an additional product

430
00:14:30,399 --> 00:14:31,519
that's basically a thing and it will

431
00:14:31,519 --> 00:14:33,040
never be completely blue right everybody

432
00:14:33,040 --> 00:14:34,480
that works with with the attack

433
00:14:34,480 --> 00:14:36,000
framework knows

434
00:14:36,000 --> 00:14:38,560
that there's no there's no holy grail

435
00:14:38,560 --> 00:14:39,519
there

436
00:14:39,519 --> 00:14:41,360
and we can also start mapping the data

437
00:14:41,360 --> 00:14:43,440
potential so basically we can look at

438
00:14:43,440 --> 00:14:45,519
what type of data components does it

439
00:14:45,519 --> 00:14:46,880
actually log

440
00:14:46,880 --> 00:14:49,279
and what would that theoretically

441
00:14:49,279 --> 00:14:51,600
be able to visualize for us and then of

442
00:14:51,600 --> 00:14:53,360
course it's theoretically because not

443
00:14:53,360 --> 00:14:55,279
every attack will be visible that way

444
00:14:55,279 --> 00:14:56,160
and

445
00:14:56,160 --> 00:14:56,959
not

446
00:14:56,959 --> 00:14:58,959
all data will be in there since it is

447
00:14:58,959 --> 00:15:00,399
configured and

448
00:15:00,399 --> 00:15:01,680
sampled so

449
00:15:01,680 --> 00:15:03,120
it's it's at least the direction so we

450
00:15:03,120 --> 00:15:05,040
can understand do we even have the

451
00:15:05,040 --> 00:15:07,600
potential of data for it

452
00:15:07,600 --> 00:15:09,519
and basically what you what we did is

453
00:15:09,519 --> 00:15:13,680
map it basically to every uh mitre

454
00:15:13,680 --> 00:15:16,880
data component with the the table and

455
00:15:16,880 --> 00:15:18,480
the entries in there that we want to

456
00:15:18,480 --> 00:15:19,760
utilize

457
00:15:19,760 --> 00:15:21,839
and this gives us a huge potential in

458
00:15:21,839 --> 00:15:25,120
theory again but we can cover well 299

459
00:15:25,120 --> 00:15:26,560
techniques which is quite a lot out of

460
00:15:26,560 --> 00:15:28,320
the 550

461
00:15:28,320 --> 00:15:30,560
ish that they have

462
00:15:30,560 --> 00:15:32,240
and we can even start visualizing it so

463
00:15:32,240 --> 00:15:33,920
this is a custom bloodhound version that

464
00:15:33,920 --> 00:15:35,759
we that we used

465
00:15:35,759 --> 00:15:38,000
where we can see okay if we want to only

466
00:15:38,000 --> 00:15:40,560
use the registry for instance as a

467
00:15:40,560 --> 00:15:42,160
data source what kind of techniques

468
00:15:42,160 --> 00:15:44,240
could we be covering here

469
00:15:44,240 --> 00:15:46,560
and then we can see which event types on

470
00:15:46,560 --> 00:15:48,480
the on the provider side which is

471
00:15:48,480 --> 00:15:49,920
defender for endpoint can we actually

472
00:15:49,920 --> 00:15:52,000
utilize this is a nice visual way of

473
00:15:52,000 --> 00:15:53,519
seeing okay what can i actually do with

474
00:15:53,519 --> 00:15:55,680
my data

475
00:15:55,680 --> 00:15:58,000
but also what is important is so where

476
00:15:58,000 --> 00:16:00,000
does the telemetry come from on the

477
00:16:00,000 --> 00:16:01,519
operating system there's all kinds of

478
00:16:01,519 --> 00:16:03,600
ways that it can be acquired so we

479
00:16:03,600 --> 00:16:06,480
started looking a little bit into this

480
00:16:06,480 --> 00:16:08,320
and the easiest tool i could find to do

481
00:16:08,320 --> 00:16:10,639
this was mimikatz because it's just so

482
00:16:10,639 --> 00:16:12,560
convenient in there but basically we can

483
00:16:12,560 --> 00:16:14,800
see all the the kernel callback channels

484
00:16:14,800 --> 00:16:16,079
that were there

485
00:16:16,079 --> 00:16:18,720
and see if this is here so welcome

486
00:16:18,720 --> 00:16:19,839
um but

487
00:16:19,839 --> 00:16:21,839
the the cool thing here is if we can see

488
00:16:21,839 --> 00:16:23,680
basically what what it does does is it

489
00:16:23,680 --> 00:16:25,440
tells the kernel the driver tells the

490
00:16:25,440 --> 00:16:27,440
colonel hey if an incident like this or

491
00:16:27,440 --> 00:16:29,360
an event like this happens i want to get

492
00:16:29,360 --> 00:16:30,959
a

493
00:16:30,959 --> 00:16:33,040
an event from it so we can see that we

494
00:16:33,040 --> 00:16:37,440
see a wd filter that says and mss

495
00:16:37,440 --> 00:16:39,199
the wd filter is the windows defender

496
00:16:39,199 --> 00:16:41,279
agent so that's the av component

497
00:16:41,279 --> 00:16:43,920
and the msec flt is basically the edr

498
00:16:43,920 --> 00:16:46,000
component so they both get their own

499
00:16:46,000 --> 00:16:48,639
individual data stream and they might

500
00:16:48,639 --> 00:16:51,279
also look at different information there

501
00:16:51,279 --> 00:16:52,000
so

502
00:16:52,000 --> 00:16:53,680
they if you want to kill it or if

503
00:16:53,680 --> 00:16:54,880
somebody wants to kill it they have to

504
00:16:54,880 --> 00:16:57,199
kill both which is kind of nice

505
00:16:57,199 --> 00:16:58,959
but you did you don't necessarily know

506
00:16:58,959 --> 00:17:00,480
what they do when you see some system on

507
00:17:00,480 --> 00:17:01,839
in between as well

508
00:17:01,839 --> 00:17:03,680
for the people that use that so

509
00:17:03,680 --> 00:17:05,280
a lot of the stuff is the same so they

510
00:17:05,280 --> 00:17:06,720
get the same telemetry at least from the

511
00:17:06,720 --> 00:17:08,079
kernel

512
00:17:08,079 --> 00:17:10,400
with one diff difference though

513
00:17:10,400 --> 00:17:12,319
on the process side you can see a

514
00:17:12,319 --> 00:17:14,880
pre-operation and a post operation which

515
00:17:14,880 --> 00:17:16,640
technically means the pre-operation is

516
00:17:16,640 --> 00:17:18,640
whenever it happens so process creation

517
00:17:18,640 --> 00:17:19,679
event

518
00:17:19,679 --> 00:17:22,480
and the post operation is a process

519
00:17:22,480 --> 00:17:24,880
termination event so as you can see

520
00:17:24,880 --> 00:17:26,959
sysmon does both and the defender

521
00:17:26,959 --> 00:17:29,600
product doesn't do that so

522
00:17:29,600 --> 00:17:31,360
not necessarily bad

523
00:17:31,360 --> 00:17:32,960
unless you want to monitor for it or see

524
00:17:32,960 --> 00:17:35,039
how long a process lived

525
00:17:35,039 --> 00:17:36,400
which could be cool in an ir

526
00:17:36,400 --> 00:17:38,240
investigation right

527
00:17:38,240 --> 00:17:39,919
but yeah that's something the edr won't

528
00:17:39,919 --> 00:17:42,400
help you with

529
00:17:42,880 --> 00:17:44,480
and then the event tracing for windows

530
00:17:44,480 --> 00:17:46,400
bit it's basically the mechanism on the

531
00:17:46,400 --> 00:17:48,160
kernel side which generates all the raw

532
00:17:48,160 --> 00:17:50,640
telemetry it's a fire hose so don't just

533
00:17:50,640 --> 00:17:52,559
ingest everything

534
00:17:52,559 --> 00:17:54,480
and it's basically built in three layers

535
00:17:54,480 --> 00:17:56,720
so you have providers you have consumers

536
00:17:56,720 --> 00:17:58,400
which basically consume what the

537
00:17:58,400 --> 00:18:00,080
provider gives you and they have a

538
00:18:00,080 --> 00:18:02,480
tracing session which is sort of

539
00:18:02,480 --> 00:18:04,480
a consumption based thing from a

540
00:18:04,480 --> 00:18:06,000
provider but it works in a slightly

541
00:18:06,000 --> 00:18:08,320
different way

542
00:18:08,320 --> 00:18:09,679
and basically

543
00:18:09,679 --> 00:18:11,760
what it does and what the defender

544
00:18:11,760 --> 00:18:13,280
product does is it creates its own

545
00:18:13,280 --> 00:18:15,440
providers as well where it basically

546
00:18:15,440 --> 00:18:17,760
looks at itself and these are

547
00:18:17,760 --> 00:18:20,400
sort of aggregation providers so what it

548
00:18:20,400 --> 00:18:22,320
does is it looks at a lot of other etw

549
00:18:22,320 --> 00:18:25,280
events gets it into its own

550
00:18:25,280 --> 00:18:27,360
stream and then hooks on that and ships

551
00:18:27,360 --> 00:18:30,640
that to the uh to the portal

552
00:18:30,640 --> 00:18:31,440
and

553
00:18:31,440 --> 00:18:32,880
there were there were like i don't know

554
00:18:32,880 --> 00:18:35,600
how many as an eight or nine so i i was

555
00:18:35,600 --> 00:18:37,280
very interested in what's in there right

556
00:18:37,280 --> 00:18:39,280
because i want to know what is actually

557
00:18:39,280 --> 00:18:40,720
what what is being logged what it's

558
00:18:40,720 --> 00:18:43,280
looking at to understand a little bit

559
00:18:43,280 --> 00:18:46,080
more what i can actually do with it

560
00:18:46,080 --> 00:18:48,000
so what it does is it stores it first

561
00:18:48,000 --> 00:18:50,720
locally so it's it makes a

562
00:18:50,720 --> 00:18:52,559
subscription to the event tracing for

563
00:18:52,559 --> 00:18:54,559
windows providers

564
00:18:54,559 --> 00:18:56,000
gets that information stores it in the

565
00:18:56,000 --> 00:18:58,400
sqlite database and that gets flushed

566
00:18:58,400 --> 00:19:00,000
every time it uploads it so there's a

567
00:19:00,000 --> 00:19:02,400
sort of local store and forward system

568
00:19:02,400 --> 00:19:04,320
to not lose any of the telemetry if the

569
00:19:04,320 --> 00:19:05,760
internet goes down or whatever on that

570
00:19:05,760 --> 00:19:07,600
machine

571
00:19:07,600 --> 00:19:09,840
and it's kind of funny that they use a

572
00:19:09,840 --> 00:19:12,480
sort of very old

573
00:19:12,480 --> 00:19:14,720
code name for that database which is

574
00:19:14,720 --> 00:19:17,440
called asimov which is i think a halo

575
00:19:17,440 --> 00:19:18,880
reference

576
00:19:18,880 --> 00:19:20,160
but it's also

577
00:19:20,160 --> 00:19:21,600
now

578
00:19:21,600 --> 00:19:23,679
the whole asimov project

579
00:19:23,679 --> 00:19:26,400
was renamed it to the direct track

580
00:19:26,400 --> 00:19:28,080
service which we'll come back to in a

581
00:19:28,080 --> 00:19:30,799
second so keep in mind that name

582
00:19:30,799 --> 00:19:32,880
and basically this is where it stores it

583
00:19:32,880 --> 00:19:34,799
so it's not very important for the rest

584
00:19:34,799 --> 00:19:35,840
it's it's

585
00:19:35,840 --> 00:19:37,600
assigned and it's protected so it's very

586
00:19:37,600 --> 00:19:39,520
hard to tamper with that from an

587
00:19:39,520 --> 00:19:41,280
attacker perspective so that's

588
00:19:41,280 --> 00:19:43,200
relatively safe

589
00:19:43,200 --> 00:19:44,799
so then i was interested in what what

590
00:19:44,799 --> 00:19:47,120
kind of telemetry is being being

591
00:19:47,120 --> 00:19:50,240
generated right or being captured

592
00:19:50,240 --> 00:19:51,440
and

593
00:19:51,440 --> 00:19:53,919
one of the very nice tools to to start

594
00:19:53,919 --> 00:19:56,000
looking at those event racing things is

595
00:19:56,000 --> 00:19:59,200
um is c lighter it's a it's a relatively

596
00:19:59,200 --> 00:20:00,720
simple tool where you can just say okay

597
00:20:00,720 --> 00:20:03,280
i want to subscribe to these providers

598
00:20:03,280 --> 00:20:05,600
and you can log it to either the screen

599
00:20:05,600 --> 00:20:07,360
or to a json file or even to the event

600
00:20:07,360 --> 00:20:08,880
log itself so you can create your own

601
00:20:08,880 --> 00:20:11,760
custom feeds if you want to

602
00:20:11,760 --> 00:20:14,320
and as the the the creator mentions it's

603
00:20:14,320 --> 00:20:17,200
not as stable i found it very stable but

604
00:20:17,200 --> 00:20:20,000
if you want to do with a skill maybe tw

605
00:20:20,000 --> 00:20:21,840
or even velociraptor might be a better

606
00:20:21,840 --> 00:20:25,360
way to to start hooking those

607
00:20:25,360 --> 00:20:27,440
so once i started building those traces

608
00:20:27,440 --> 00:20:30,159
i saw you get a very nice structured

609
00:20:30,159 --> 00:20:32,480
data output per event this is from the

610
00:20:32,480 --> 00:20:34,640
cyber security feed

611
00:20:34,640 --> 00:20:36,400
or cyber defense feed

612
00:20:36,400 --> 00:20:37,919
and one of the things i noticed was this

613
00:20:37,919 --> 00:20:40,559
this events blob which looked like a

614
00:20:40,559 --> 00:20:43,039
base 64 string so i figured okay let's

615
00:20:43,039 --> 00:20:45,840
just decode it that's probably possible

616
00:20:45,840 --> 00:20:47,600
and then i got this as an output and

617
00:20:47,600 --> 00:20:49,440
probably you can't read it

618
00:20:49,440 --> 00:20:51,679
but but this looks probably quite

619
00:20:51,679 --> 00:20:53,679
familiar to a lot of people which is

620
00:20:53,679 --> 00:20:55,760
even in the same structure with all the

621
00:20:55,760 --> 00:20:58,720
ugly tabs and so on as a normal event

622
00:20:58,720 --> 00:21:00,880
log events from the powershell

623
00:21:00,880 --> 00:21:02,799
provider

624
00:21:02,799 --> 00:21:04,640
so that was kind of interesting and then

625
00:21:04,640 --> 00:21:06,240
there was some some base some some

626
00:21:06,240 --> 00:21:08,400
basically some some blobs and binary

627
00:21:08,400 --> 00:21:10,880
code around it so it turns out that this

628
00:21:10,880 --> 00:21:12,799
uh that's bond it's an open source

629
00:21:12,799 --> 00:21:15,440
project by microsoft where they use

630
00:21:15,440 --> 00:21:18,799
some serialization with a schema

631
00:21:18,799 --> 00:21:20,720
to make it more efficient to upload it

632
00:21:20,720 --> 00:21:22,720
and just compress the data a little bit

633
00:21:22,720 --> 00:21:24,799
i couldn't find the schemas in the in

634
00:21:24,799 --> 00:21:26,559
the source code of

635
00:21:26,559 --> 00:21:28,400
of the defender

636
00:21:28,400 --> 00:21:30,559
client but i also didn't really need it

637
00:21:30,559 --> 00:21:32,559
because i was more after the the

638
00:21:32,559 --> 00:21:34,799
telemetry generation so i

639
00:21:34,799 --> 00:21:36,799
i might dig into that later

640
00:21:36,799 --> 00:21:37,760
um

641
00:21:37,760 --> 00:21:39,600
but my next question was basically so

642
00:21:39,600 --> 00:21:41,039
hey that powershell information is kind

643
00:21:41,039 --> 00:21:43,039
of interesting where does it get it so i

644
00:21:43,039 --> 00:21:44,400
started looking at

645
00:21:44,400 --> 00:21:46,880
all of the providers the etw providers

646
00:21:46,880 --> 00:21:49,039
and their subscriptions on the operating

647
00:21:49,039 --> 00:21:51,360
system and one of the tools to use is

648
00:21:51,360 --> 00:21:53,200
the telemetry sourcer which is another

649
00:21:53,200 --> 00:21:55,120
open source tool really nice

650
00:21:55,120 --> 00:21:57,440
and you can basically see the

651
00:21:57,440 --> 00:21:59,360
on the left side you can see all of the

652
00:21:59,360 --> 00:22:01,039
providers and the subscriptions or the

653
00:22:01,039 --> 00:22:02,720
sessions next to it

654
00:22:02,720 --> 00:22:04,720
and the powershell one only had one

655
00:22:04,720 --> 00:22:07,200
session basically so only the event log

656
00:22:07,200 --> 00:22:09,520
was actually capturing that powershell

657
00:22:09,520 --> 00:22:11,840
information and i rented a system so i

658
00:22:11,840 --> 00:22:14,320
should be able to see everything

659
00:22:14,320 --> 00:22:17,039
um so then my sort of assumption would

660
00:22:17,039 --> 00:22:18,159
be a

661
00:22:18,159 --> 00:22:20,000
mde just uses the event log right

662
00:22:20,000 --> 00:22:22,400
because i can't see a session there

663
00:22:22,400 --> 00:22:23,919
so i started looking a little bit more

664
00:22:23,919 --> 00:22:26,080
on the underlying side and there the

665
00:22:26,080 --> 00:22:28,400
dire track thing comes back which is the

666
00:22:28,400 --> 00:22:31,440
diagnostics tracing service from windows

667
00:22:31,440 --> 00:22:34,640
which captures a lot of information

668
00:22:34,640 --> 00:22:36,480
and apparently also microsoft uses that

669
00:22:36,480 --> 00:22:38,159
as a vehicle to get to some of those

670
00:22:38,159 --> 00:22:39,760
event logs

671
00:22:39,760 --> 00:22:42,159
and the interesting bit was that

672
00:22:42,159 --> 00:22:44,559
the service itself is not protected so

673
00:22:44,559 --> 00:22:46,720
it's just there and every local admin

674
00:22:46,720 --> 00:22:48,720
can basically kill stop

675
00:22:48,720 --> 00:22:50,720
and pause it

676
00:22:50,720 --> 00:22:52,960
and if you do that some of the telemetry

677
00:22:52,960 --> 00:22:54,880
doesn't go into the defender portal

678
00:22:54,880 --> 00:22:57,520
anymore so you you can partially blind

679
00:22:57,520 --> 00:22:59,760
it you still will have all your brass

680
00:22:59,760 --> 00:23:01,200
creation all the other ones that it gets

681
00:23:01,200 --> 00:23:03,120
from the kernel directly but some of the

682
00:23:03,120 --> 00:23:05,520
event tracing for windows traces will be

683
00:23:05,520 --> 00:23:08,320
sort of suspended for that for that time

684
00:23:08,320 --> 00:23:09,120
so

685
00:23:09,120 --> 00:23:11,039
i don't know why it used to be a

686
00:23:11,039 --> 00:23:12,960
protected service for quite a long time

687
00:23:12,960 --> 00:23:14,960
and then for some reason

688
00:23:14,960 --> 00:23:16,559
in one of the patches

689
00:23:16,559 --> 00:23:20,399
it suddenly got unprotected

690
00:23:21,280 --> 00:23:22,640
so that's something i still have to

691
00:23:22,640 --> 00:23:24,080
validate with microsoft but it's

692
00:23:24,080 --> 00:23:25,760
interesting to know so if somebody stops

693
00:23:25,760 --> 00:23:27,440
at surface that might also be a trigger

694
00:23:27,440 --> 00:23:29,840
for you to have a look at

695
00:23:29,840 --> 00:23:31,679
so going to the configuration a little

696
00:23:31,679 --> 00:23:34,000
bit so like every product you have to

697
00:23:34,000 --> 00:23:36,640
tell it what to do and as i mentioned

698
00:23:36,640 --> 00:23:38,960
before microsoft maintains this

699
00:23:38,960 --> 00:23:40,720
it's stored on the box

700
00:23:40,720 --> 00:23:43,600
it might be a nice cdf to to find it

701
00:23:43,600 --> 00:23:44,720
and and

702
00:23:44,720 --> 00:23:47,279
decode it

703
00:23:47,520 --> 00:23:49,039
because i'm not going to tell you where

704
00:23:49,039 --> 00:23:50,960
it is for

705
00:23:50,960 --> 00:23:53,360
all kinds of reasons i don't want people

706
00:23:53,360 --> 00:23:55,120
just just to be able because you can

707
00:23:55,120 --> 00:23:57,440
basically see everything it's tracing

708
00:23:57,440 --> 00:23:59,279
which is great for every offensive

709
00:23:59,279 --> 00:24:02,240
person or ransomware person as well

710
00:24:02,240 --> 00:24:05,279
but it will be a nice exercise to do so

711
00:24:05,279 --> 00:24:06,159
um

712
00:24:06,159 --> 00:24:09,039
it is signed so you can't

713
00:24:09,039 --> 00:24:11,279
add stuff to it or remove stuff from it

714
00:24:11,279 --> 00:24:13,520
it's just a source that the process can

715
00:24:13,520 --> 00:24:14,320
can

716
00:24:14,320 --> 00:24:15,360
access

717
00:24:15,360 --> 00:24:17,600
and we so far we didn't manage to

718
00:24:17,600 --> 00:24:18,960
actually

719
00:24:18,960 --> 00:24:21,120
bypass that signing so that that's it

720
00:24:21,120 --> 00:24:23,120
it's quite secure but it is it's

721
00:24:23,120 --> 00:24:25,120
readable and on a mac linux box it's

722
00:24:25,120 --> 00:24:26,880
super easy because that's stored in just

723
00:24:26,880 --> 00:24:29,279
the json blob in plain text

724
00:24:29,279 --> 00:24:30,880
as a file so

725
00:24:30,880 --> 00:24:32,400
those are easy but the ones on the

726
00:24:32,400 --> 00:24:36,559
windows box is slightly more complicated

727
00:24:36,640 --> 00:24:38,400
but some examples there so so they

728
00:24:38,400 --> 00:24:40,320
configure all the etw events and the

729
00:24:40,320 --> 00:24:42,640
registry keys the file passes monitoring

730
00:24:42,640 --> 00:24:44,960
and so on all kinds of exclusions the

731
00:24:44,960 --> 00:24:47,039
filters that they apply to it

732
00:24:47,039 --> 00:24:49,679
which process names are white listed

733
00:24:49,679 --> 00:24:51,760
a lot of stuff and then the the very

734
00:24:51,760 --> 00:24:53,679
important one is the capping so they do

735
00:24:53,679 --> 00:24:55,919
a global cap and a local cap so the

736
00:24:55,919 --> 00:24:58,240
global cap is basically i only want 5

737
00:24:58,240 --> 00:25:00,960
000 powershell events for that day

738
00:25:00,960 --> 00:25:03,039
and then the local gap might be i only

739
00:25:03,039 --> 00:25:06,400
want one powershell event today that was

740
00:25:06,400 --> 00:25:09,440
spawned by this process and this command

741
00:25:09,440 --> 00:25:11,039
line and some some of the other ones so

742
00:25:11,039 --> 00:25:13,760
it's basically trimmed down a little bit

743
00:25:13,760 --> 00:25:15,520
then they also do a lot of dynamic data

744
00:25:15,520 --> 00:25:17,520
collection so they have all kinds of

745
00:25:17,520 --> 00:25:21,279
powershell scripts that they run to see

746
00:25:21,279 --> 00:25:22,640
which

747
00:25:22,640 --> 00:25:24,640
which wi-fi connections you have stored

748
00:25:24,640 --> 00:25:26,720
on your box or which services are

749
00:25:26,720 --> 00:25:28,720
running all kinds of dynamic data

750
00:25:28,720 --> 00:25:30,240
collection

751
00:25:30,240 --> 00:25:32,080
then the config of the agent itself so

752
00:25:32,080 --> 00:25:33,919
how often should it upload what are the

753
00:25:33,919 --> 00:25:35,360
quotas

754
00:25:35,360 --> 00:25:37,600
if if there's a low latency connection

755
00:25:37,600 --> 00:25:39,760
or a high latency connection it also

756
00:25:39,760 --> 00:25:41,520
trims down the volume of the data that

757
00:25:41,520 --> 00:25:43,600
it will upload so it will be a little

758
00:25:43,600 --> 00:25:46,000
bit dynamic from that perspective and

759
00:25:46,000 --> 00:25:48,159
that config is huge it's like probably

760
00:25:48,159 --> 00:25:51,679
over 75k lines by now so it grows over

761
00:25:51,679 --> 00:25:52,799
time

762
00:25:52,799 --> 00:25:54,400
and we also monitor that to see what

763
00:25:54,400 --> 00:25:56,080
they're actually including excluding

764
00:25:56,080 --> 00:25:57,520
these kind of things

765
00:25:57,520 --> 00:25:59,760
we can see all the etw providers and the

766
00:25:59,760 --> 00:26:01,760
events within it that it's uh it's

767
00:26:01,760 --> 00:26:04,480
grabbing there's like 500 registry paths

768
00:26:04,480 --> 00:26:06,640
that it's monitoring

769
00:26:06,640 --> 00:26:08,400
and and all those data collection once

770
00:26:08,400 --> 00:26:11,840
it's like 60 scripts it's quite a lot

771
00:26:11,840 --> 00:26:14,320
so this is just a random snippet of it

772
00:26:14,320 --> 00:26:16,640
as a very lengthy list as i mentioned

773
00:26:16,640 --> 00:26:18,159
before so this is an interesting one the

774
00:26:18,159 --> 00:26:20,799
threat intelligence provider which is a

775
00:26:20,799 --> 00:26:23,679
windows native etw event that is only

776
00:26:23,679 --> 00:26:24,620
accessible to

777
00:26:24,620 --> 00:26:27,360
[Music]

778
00:26:27,360 --> 00:26:29,840
basically approved

779
00:26:29,840 --> 00:26:32,320
what is it the elam drive so the early

780
00:26:32,320 --> 00:26:35,520
load malware analysis driver it's

781
00:26:35,520 --> 00:26:38,240
slightly different but you get drift so

782
00:26:38,240 --> 00:26:40,400
microsoft allows you to to get access to

783
00:26:40,400 --> 00:26:42,799
that or not so mostly most av and edr

784
00:26:42,799 --> 00:26:44,400
vendors have it and what's in there is

785
00:26:44,400 --> 00:26:46,400
like process suspension events process

786
00:26:46,400 --> 00:26:47,520
resume

787
00:26:47,520 --> 00:26:50,559
um some some virtual allocations so a

788
00:26:50,559 --> 00:26:53,360
set of api calls that it can monitor

789
00:26:53,360 --> 00:26:54,880
the powershell commands we actually seen

790
00:26:54,880 --> 00:26:56,480
that one right in this in the example

791
00:26:56,480 --> 00:26:59,200
before and i saw security w which which

792
00:26:59,200 --> 00:27:00,960
kind of looked funny to me because it

793
00:27:00,960 --> 00:27:03,120
the name is very different but yeah it

794
00:27:03,120 --> 00:27:05,120
says secure so it must be interesting so

795
00:27:05,120 --> 00:27:06,880
i started looking at that and what what

796
00:27:06,880 --> 00:27:08,720
i did first i looked up the provider

797
00:27:08,720 --> 00:27:10,880
guide so everything has a global unique

798
00:27:10,880 --> 00:27:12,480
id

799
00:27:12,480 --> 00:27:13,919
and with log man which is a native

800
00:27:13,919 --> 00:27:16,000
windows tool you can just query it and

801
00:27:16,000 --> 00:27:18,399
see what it's actually called so

802
00:27:18,399 --> 00:27:20,960
it turns out it's just a security lock

803
00:27:20,960 --> 00:27:23,360
so from there i started looking at hey

804
00:27:23,360 --> 00:27:24,799
what's actually in that security log

805
00:27:24,799 --> 00:27:26,320
which events is it tailing so for

806
00:27:26,320 --> 00:27:28,880
instance it checks the 4624 which most

807
00:27:28,880 --> 00:27:32,000
people would know as the logon success

808
00:27:32,000 --> 00:27:34,480
and then we can also see a couple of

809
00:27:34,480 --> 00:27:36,399
things so we can see the events or the

810
00:27:36,399 --> 00:27:38,480
fields that it's making that that local

811
00:27:38,480 --> 00:27:41,120
cap on right so there's a cap of one

812
00:27:41,120 --> 00:27:43,039
if a specific user with a specific

813
00:27:43,039 --> 00:27:45,600
domain name with a specific sid and a

814
00:27:45,600 --> 00:27:49,679
specific logon type from a specific ip

815
00:27:49,679 --> 00:27:52,399
has a specific target logon id so that

816
00:27:52,399 --> 00:27:54,240
that whole set of things would be one

817
00:27:54,240 --> 00:27:56,720
event per day so if i use a different ip

818
00:27:56,720 --> 00:27:59,120
with the same other variables it will be

819
00:27:59,120 --> 00:28:01,200
a new event and there's a thousand in

820
00:28:01,200 --> 00:28:04,000
total that would get logged

821
00:28:04,000 --> 00:28:05,440
and then there's a bunch of field

822
00:28:05,440 --> 00:28:06,880
configurations so basically all the

823
00:28:06,880 --> 00:28:08,320
fields that would get shipped to the

824
00:28:08,320 --> 00:28:09,279
portal

825
00:28:09,279 --> 00:28:10,720
um

826
00:28:10,720 --> 00:28:12,240
so then i was interested okay it tells

827
00:28:12,240 --> 00:28:14,159
the security event log which events is

828
00:28:14,159 --> 00:28:15,840
actually looking for and it's quite a

829
00:28:15,840 --> 00:28:17,679
lengthy list as you can see

830
00:28:17,679 --> 00:28:19,200
you don't have to go through it all but

831
00:28:19,200 --> 00:28:21,600
basically what i then did so i know from

832
00:28:21,600 --> 00:28:23,919
security log is that sometimes you need

833
00:28:23,919 --> 00:28:25,600
to enable some of those events right

834
00:28:25,600 --> 00:28:26,399
because

835
00:28:26,399 --> 00:28:27,679
out of the box

836
00:28:27,679 --> 00:28:29,200
it's pretty bad so there's a couple of

837
00:28:29,200 --> 00:28:30,640
things that you can do

838
00:28:30,640 --> 00:28:32,960
i have to speed up i know this so if i'm

839
00:28:32,960 --> 00:28:34,799
going too fast just wave

840
00:28:34,799 --> 00:28:36,320
but basically what you can do with the

841
00:28:36,320 --> 00:28:38,399
audio policies is you can set nothing

842
00:28:38,399 --> 00:28:40,480
and then it doesn't audit

843
00:28:40,480 --> 00:28:42,320
you can say it's only on the successful

844
00:28:42,320 --> 00:28:44,799
field and on both

845
00:28:44,799 --> 00:28:47,679
so for most of those events that we just

846
00:28:47,679 --> 00:28:50,000
saw we can actually know

847
00:28:50,000 --> 00:28:53,279
what setting does it require to get logs

848
00:28:53,279 --> 00:28:54,960
so i started mapping that and then i

849
00:28:54,960 --> 00:28:57,200
started looking at

850
00:28:57,200 --> 00:28:58,960
what is on a default out-of-the-box

851
00:28:58,960 --> 00:29:01,600
windows box so from that whole list and

852
00:29:01,600 --> 00:29:03,600
most of them are grayed out that are

853
00:29:03,600 --> 00:29:05,919
actually fine but all the white ones

854
00:29:05,919 --> 00:29:07,440
remain as

855
00:29:07,440 --> 00:29:10,720
out of the box not logged but required

856
00:29:10,720 --> 00:29:13,200
by the edr or at least preferred by the

857
00:29:13,200 --> 00:29:14,480
edr and there's some some interesting

858
00:29:14,480 --> 00:29:16,960
ones in there like service creation

859
00:29:16,960 --> 00:29:18,000
um

860
00:29:18,000 --> 00:29:19,840
scheduled tasks which are probably two

861
00:29:19,840 --> 00:29:22,799
of the most used attack factors

862
00:29:22,799 --> 00:29:25,200
so there it's blind to that by default

863
00:29:25,200 --> 00:29:27,200
but fortunately

864
00:29:27,200 --> 00:29:29,679
the defender team was also aware of this

865
00:29:29,679 --> 00:29:32,799
so they enable a bunch of those

866
00:29:32,799 --> 00:29:36,399
but they still don't enable all of them

867
00:29:36,399 --> 00:29:38,000
and there's a couple of reasons because

868
00:29:38,000 --> 00:29:40,640
as you can see you see the firewall one

869
00:29:40,640 --> 00:29:42,399
and you see uh

870
00:29:42,399 --> 00:29:44,159
default credentials which isn't that

871
00:29:44,159 --> 00:29:45,919
noisy but especially the firewall one

872
00:29:45,919 --> 00:29:47,360
most people would know that that's like

873
00:29:47,360 --> 00:29:49,520
a fire hose so you might not want to

874
00:29:49,520 --> 00:29:51,760
have that enabled on all your servers

875
00:29:51,760 --> 00:29:53,440
that are also shipping to splunk or

876
00:29:53,440 --> 00:29:55,039
sentinel or something else and then get

877
00:29:55,039 --> 00:29:56,960
flooded by all kinds of data because you

878
00:29:56,960 --> 00:29:59,279
enabled edr so this is the reason why

879
00:29:59,279 --> 00:30:02,159
they don't enable that sadly they also

880
00:30:02,159 --> 00:30:03,760
don't document that they don't enable

881
00:30:03,760 --> 00:30:04,640
that

882
00:30:04,640 --> 00:30:07,279
which you have to sort of find out now

883
00:30:07,279 --> 00:30:09,440
or by yourself so that that's kind of

884
00:30:09,440 --> 00:30:12,480
shitty sorry for my language but um that

885
00:30:12,480 --> 00:30:15,520
that's yeah that's not good so at least

886
00:30:15,520 --> 00:30:16,960
have a check

887
00:30:16,960 --> 00:30:18,240
in your environment and that's also

888
00:30:18,240 --> 00:30:20,559
something to know so they enable

889
00:30:20,559 --> 00:30:21,840
they enable a couple of them right

890
00:30:21,840 --> 00:30:23,279
serves creation for instance you

891
00:30:23,279 --> 00:30:26,240
probably have that in your gpo already

892
00:30:26,240 --> 00:30:27,760
but if you have something else in your

893
00:30:27,760 --> 00:30:30,559
gpo and they enable it the gpo will just

894
00:30:30,559 --> 00:30:32,240
override that and then it's gone again

895
00:30:32,240 --> 00:30:33,039
so

896
00:30:33,039 --> 00:30:35,360
be aware what you actually have set in

897
00:30:35,360 --> 00:30:37,600
your your gpos

898
00:30:37,600 --> 00:30:38,799
and

899
00:30:38,799 --> 00:30:40,640
to help you out i build a very bad

900
00:30:40,640 --> 00:30:42,640
powershell script but it basically gets

901
00:30:42,640 --> 00:30:44,559
all the gpos sees where there's an audit

902
00:30:44,559 --> 00:30:45,600
event

903
00:30:45,600 --> 00:30:47,840
and if it isn't enabled it will tell you

904
00:30:47,840 --> 00:30:50,320
or if it's not in the right setting so i

905
00:30:50,320 --> 00:30:52,080
have a have a check there so i have to

906
00:30:52,080 --> 00:30:53,840
almost wrap up there we go

907
00:30:53,840 --> 00:30:56,880
um so just to conclude really try to

908
00:30:56,880 --> 00:30:59,120
understand if you use a tool how it

909
00:30:59,120 --> 00:31:00,159
works

910
00:31:00,159 --> 00:31:01,679
where it's strong where it's bad because

911
00:31:01,679 --> 00:31:03,120
then you can actually

912
00:31:03,120 --> 00:31:05,840
address that

913
00:31:05,840 --> 00:31:07,919
and try to reassess this because tools

914
00:31:07,919 --> 00:31:09,840
like these evolve over time they

915
00:31:09,840 --> 00:31:11,519
constantly get improved or sometimes

916
00:31:11,519 --> 00:31:13,039
worsened

917
00:31:13,039 --> 00:31:15,279
so you can then augment it with an

918
00:31:15,279 --> 00:31:17,120
additional tool just to improve your

919
00:31:17,120 --> 00:31:20,720
telemetry and make the full use of it

920
00:31:20,720 --> 00:31:22,480
and with that i think we have time for

921
00:31:22,480 --> 00:31:25,480
questions

922
00:31:35,279 --> 00:31:37,840
absolutely so there is a microphone in

923
00:31:37,840 --> 00:31:38,880
front

924
00:31:38,880 --> 00:31:40,960
please

925
00:31:40,960 --> 00:31:42,159
do ask

926
00:31:42,159 --> 00:31:43,840
question we have a couple of minutes

927
00:31:43,840 --> 00:31:44,880
left

928
00:31:44,880 --> 00:31:48,559
i think it was very good to see uh

929
00:31:48,559 --> 00:31:49,360
some

930
00:31:49,360 --> 00:31:52,720
insights and ticks and trips that

931
00:31:52,720 --> 00:31:54,320
you can

932
00:31:54,320 --> 00:31:56,640
give us so that people

933
00:31:56,640 --> 00:31:59,039
can be aware of these details

934
00:31:59,039 --> 00:32:00,399
yeah one of the things i'm working on

935
00:32:00,399 --> 00:32:01,760
now if there's no questions i'll just

936
00:32:01,760 --> 00:32:02,960
talk on

937
00:32:02,960 --> 00:32:04,799
probably

938
00:32:04,799 --> 00:32:06,640
a few more minutes

939
00:32:06,640 --> 00:32:08,399
one of the things i started doing

940
00:32:08,399 --> 00:32:10,559
because one of the the most annoying

941
00:32:10,559 --> 00:32:12,640
features is that they most of the time

942
00:32:12,640 --> 00:32:14,480
they they restrict the amount of

943
00:32:14,480 --> 00:32:17,360
telemetry but for the dll loads it's

944
00:32:17,360 --> 00:32:18,960
completely random there's really no

945
00:32:18,960 --> 00:32:21,440
logic behind it so you just get events

946
00:32:21,440 --> 00:32:23,039
maybe or not

947
00:32:23,039 --> 00:32:24,799
so what i started doing now is starting

948
00:32:24,799 --> 00:32:26,799
an open source project with a defender

949
00:32:26,799 --> 00:32:28,640
application control policy that is in

950
00:32:28,640 --> 00:32:30,559
order only mode for the dlls that i

951
00:32:30,559 --> 00:32:32,480
actually care about

952
00:32:32,480 --> 00:32:34,000
so that at least that dilemma sheet gets

953
00:32:34,000 --> 00:32:35,519
generated and that will also show up in

954
00:32:35,519 --> 00:32:37,679
the portal so it's just a sort of cheap

955
00:32:37,679 --> 00:32:41,039
hack to get rid of some of that other

956
00:32:41,039 --> 00:32:42,640
limitations

957
00:32:42,640 --> 00:32:44,799
sir

958
00:32:46,960 --> 00:32:50,480
there is a question down there

959
00:32:51,840 --> 00:32:54,240
yes yes it's working thank you thank you

960
00:32:54,240 --> 00:32:56,240
for this presentation presentation i was

961
00:32:56,240 --> 00:32:59,279
just wondering is there a documentation

962
00:32:59,279 --> 00:33:01,519
from microsoft on this i'm not a client

963
00:33:01,519 --> 00:33:02,960
for microsoft

964
00:33:02,960 --> 00:33:05,840
no no that's sadly on the at least on

965
00:33:05,840 --> 00:33:08,240
the blind spots with the security audit

966
00:33:08,240 --> 00:33:10,480
settings there's no documentation so

967
00:33:10,480 --> 00:33:12,399
the only thing i i couldn't find it at

968
00:33:12,399 --> 00:33:14,320
least and i googled and i searched on

969
00:33:14,320 --> 00:33:17,279
the microsoft website i haven't seen it

970
00:33:17,279 --> 00:33:19,200
there used to be something only around

971
00:33:19,200 --> 00:33:22,720
the firewall events but the rest is just

972
00:33:22,720 --> 00:33:24,799
it's not there exactly no i have the

973
00:33:24,799 --> 00:33:28,480
same issues with my own provider

974
00:33:28,480 --> 00:33:30,480
yeah it's a shame right because if they

975
00:33:30,480 --> 00:33:32,320
if they want to have that telemetry it

976
00:33:32,320 --> 00:33:33,919
makes the product better so you would

977
00:33:33,919 --> 00:33:35,600
figure they would at least tell you to

978
00:33:35,600 --> 00:33:38,080
enable it to make the product their

979
00:33:38,080 --> 00:33:39,279
older product

980
00:33:39,279 --> 00:33:41,360
perceived as a better product so

981
00:33:41,360 --> 00:33:42,880
and as you say you would better

982
00:33:42,880 --> 00:33:45,200
understand how the product is working

983
00:33:45,200 --> 00:33:47,360
and how yeah

984
00:33:47,360 --> 00:33:50,399
where it cannot work uh and where you

985
00:33:50,399 --> 00:33:52,559
have to put specific things around

986
00:33:52,559 --> 00:33:54,799
exactly that they don't publish their

987
00:33:54,799 --> 00:33:56,640
own configuration like the one that i

988
00:33:56,640 --> 00:33:58,640
reversed i can imagine because that's

989
00:33:58,640 --> 00:34:00,320
helping attackers but this is just

990
00:34:00,320 --> 00:34:02,880
enabling your your whole work fleet of

991
00:34:02,880 --> 00:34:04,559
at least generating the right telemetry

992
00:34:04,559 --> 00:34:06,240
which that should be that should be

993
00:34:06,240 --> 00:34:08,399
documented period

994
00:34:08,399 --> 00:34:10,320
thank you welcome thank you

995
00:34:10,320 --> 00:34:12,079
thank you for the question and let's

996
00:34:12,079 --> 00:34:13,918
thank allah for the very insightful

997
00:34:13,918 --> 00:34:17,199
presentation thank you

998
00:34:19,520 --> 00:34:22,159
so we have 10 minutes to either change

999
00:34:22,159 --> 00:34:24,480
the room or stay here and

1000
00:34:24,480 --> 00:34:26,560
stretch a little bit and then in 10

1001
00:34:26,560 --> 00:34:27,760
minutes we'll start the next

1002
00:34:27,760 --> 00:34:30,760
presentation

