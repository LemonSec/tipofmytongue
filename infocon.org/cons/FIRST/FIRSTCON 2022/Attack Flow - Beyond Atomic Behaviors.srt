1
00:00:05,870 --> 00:00:07,600
[Music]

2
00:00:07,600 --> 00:00:08,720
all right guys let's get this next

3
00:00:08,720 --> 00:00:10,160
session started just like the last

4
00:00:10,160 --> 00:00:12,559
session this session is also traffic

5
00:00:12,559 --> 00:00:15,200
like white tlp white silence any devices

6
00:00:15,200 --> 00:00:17,440
you have uh before we get started here

7
00:00:17,440 --> 00:00:19,600
um the title of this next topic attack

8
00:00:19,600 --> 00:00:21,840
flow beyond atomic behaviors and our

9
00:00:21,840 --> 00:00:23,519
three presenters here we have desiree

10
00:00:23,519 --> 00:00:26,240
beck from the mitre corporation and we

11
00:00:26,240 --> 00:00:28,400
have gabriel bassette did i say it

12
00:00:28,400 --> 00:00:30,640
correctly bassett gabriel bassett from

13
00:00:30,640 --> 00:00:33,040
verizon and ryu masuka

14
00:00:33,040 --> 00:00:34,640
from and let me get this whole thing

15
00:00:34,640 --> 00:00:36,640
fujitsu system integration laboratories

16
00:00:36,640 --> 00:00:39,200
limited japan so with that i'll let you

17
00:00:39,200 --> 00:00:40,559
guys take it away

18
00:00:40,559 --> 00:00:42,000
thank you

19
00:00:42,000 --> 00:00:45,239
thanks joshua

20
00:00:48,559 --> 00:00:50,079
so we've been introduced so i probably

21
00:00:50,079 --> 00:00:52,160
won't linger on this slide but there we

22
00:00:52,160 --> 00:00:53,920
are officially and the slides will be

23
00:00:53,920 --> 00:00:55,520
posted at some point so you'll have our

24
00:00:55,520 --> 00:00:58,879
contact information if you needed it

25
00:00:58,879 --> 00:01:01,359
this work was done by the center for

26
00:01:01,359 --> 00:01:03,359
threat informed defense

27
00:01:03,359 --> 00:01:05,119
and we've had actually another talk at

28
00:01:05,119 --> 00:01:06,560
the conference we did a workshop on

29
00:01:06,560 --> 00:01:08,479
sunday but if you haven't heard of the

30
00:01:08,479 --> 00:01:11,439
center we conduct collaborative research

31
00:01:11,439 --> 00:01:13,920
and development projects and we do it in

32
00:01:13,920 --> 00:01:16,159
combination with the best security teams

33
00:01:16,159 --> 00:01:17,439
from everywhere you can see in that

34
00:01:17,439 --> 00:01:18,720
circle there

35
00:01:18,720 --> 00:01:19,600
and

36
00:01:19,600 --> 00:01:21,520
also then with mitre where we've got you

37
00:01:21,520 --> 00:01:23,360
know technical resources and miter is

38
00:01:23,360 --> 00:01:25,200
known for you know our objectivity in

39
00:01:25,200 --> 00:01:27,520
that so is a combination

40
00:01:27,520 --> 00:01:30,320
and we've got about 30 organizations

41
00:01:30,320 --> 00:01:32,240
involved and we'll soon be publishing

42
00:01:32,240 --> 00:01:33,840
our 18th project

43
00:01:33,840 --> 00:01:35,920
and what's really neat about the center

44
00:01:35,920 --> 00:01:37,200
is that

45
00:01:37,200 --> 00:01:38,720
when the work is complete on whatever

46
00:01:38,720 --> 00:01:40,720
project it is publicly released and so

47
00:01:40,720 --> 00:01:42,960
it's available for the whole community

48
00:01:42,960 --> 00:01:45,280
and um the attack flow project was

49
00:01:45,280 --> 00:01:47,520
released in march and so we have what at

50
00:01:47,520 --> 00:01:48,960
the end we'll give you the links to that

51
00:01:48,960 --> 00:01:50,799
we've got the github site

52
00:01:50,799 --> 00:01:52,880
uh blog posts and things which we could

53
00:01:52,880 --> 00:01:54,880
refer you to um and then there's

54
00:01:54,880 --> 00:01:57,200
actually a follow-on project underway we

55
00:01:57,200 --> 00:01:58,960
call it attack flow too

56
00:01:58,960 --> 00:02:01,360
which wasn't too original but it works

57
00:02:01,360 --> 00:02:03,280
and um we'll be uh

58
00:02:03,280 --> 00:02:04,960
finishing up

59
00:02:04,960 --> 00:02:07,360
by end of summer and it'll be published

60
00:02:07,360 --> 00:02:09,840
at probably we're thinking october but

61
00:02:09,840 --> 00:02:11,280
in the fall

62
00:02:11,280 --> 00:02:13,440
in any case

63
00:02:13,440 --> 00:02:16,160
so members actually choose

64
00:02:16,160 --> 00:02:17,840
of all the 30 members they choose and

65
00:02:17,840 --> 00:02:20,239
what projects they want to support and

66
00:02:20,239 --> 00:02:22,239
attack flow is actually very popular we

67
00:02:22,239 --> 00:02:24,720
had 10 industry partners supporting it

68
00:02:24,720 --> 00:02:27,040
and two non-profits

69
00:02:27,040 --> 00:02:28,560
and they don't only provide the

70
00:02:28,560 --> 00:02:30,560
financial support you know to do the the

71
00:02:30,560 --> 00:02:33,840
work they also are very active and they

72
00:02:33,840 --> 00:02:36,080
contribute technical expertise feedback

73
00:02:36,080 --> 00:02:37,680
throughout the project

74
00:02:37,680 --> 00:02:39,360
and you know it's very collaborative we

75
00:02:39,360 --> 00:02:41,120
have a miter

76
00:02:41,120 --> 00:02:43,200
uh research team that works in

77
00:02:43,200 --> 00:02:44,560
conjunction with different

78
00:02:44,560 --> 00:02:45,920
representatives from the different

79
00:02:45,920 --> 00:02:47,120
companies

80
00:02:47,120 --> 00:02:50,000
and i was the project leader on the

81
00:02:50,000 --> 00:02:51,519
attack flow project

82
00:02:51,519 --> 00:02:54,080
and then both gabe and ryu

83
00:02:54,080 --> 00:02:55,680
were directly involved in the hands-on

84
00:02:55,680 --> 00:02:57,440
work so we worked together and when we

85
00:02:57,440 --> 00:02:58,879
saw the theme of the conference this

86
00:02:58,879 --> 00:03:00,879
year strength together it just very much

87
00:03:00,879 --> 00:03:02,959
suggested you know we should definitely

88
00:03:02,959 --> 00:03:05,280
put a proposal in because that's really

89
00:03:05,280 --> 00:03:07,040
the philosophy of the center is that

90
00:03:07,040 --> 00:03:08,800
we're stronger together and you know we

91
00:03:08,800 --> 00:03:10,720
work collaboratively and then put it out

92
00:03:10,720 --> 00:03:13,200
to the community for hopefully follow on

93
00:03:13,200 --> 00:03:15,599
you know input from them as well or from

94
00:03:15,599 --> 00:03:17,120
from you guys

95
00:03:17,120 --> 00:03:19,200
so our presentation has three parts the

96
00:03:19,200 --> 00:03:21,360
problem the solution and the impact and

97
00:03:21,360 --> 00:03:22,959
we've slid it between the three of us so

98
00:03:22,959 --> 00:03:25,280
i'll be doing the problem piece gabe is

99
00:03:25,280 --> 00:03:27,440
going to do the solution piece and then

100
00:03:27,440 --> 00:03:30,720
ryu will do the impact piece

101
00:03:30,720 --> 00:03:32,159
so to start with the problem you know

102
00:03:32,159 --> 00:03:34,239
what is the problem

103
00:03:34,239 --> 00:03:36,720
well the problem is that defenders tend

104
00:03:36,720 --> 00:03:38,319
to track adversary behaviors

105
00:03:38,319 --> 00:03:40,400
individually so you may have seen

106
00:03:40,400 --> 00:03:42,319
reports where you've got the table maybe

107
00:03:42,319 --> 00:03:44,159
of attack techniques that come out or a

108
00:03:44,159 --> 00:03:47,040
list of techniques and in doing that you

109
00:03:47,040 --> 00:03:49,120
know it's it's good i mean it's a good

110
00:03:49,120 --> 00:03:50,720
start but

111
00:03:50,720 --> 00:03:52,400
adversaries actually

112
00:03:52,400 --> 00:03:54,480
think in terms of sequences of those

113
00:03:54,480 --> 00:03:55,920
techniques you know their attack is

114
00:03:55,920 --> 00:03:58,400
comprised of this followed by that and

115
00:03:58,400 --> 00:04:00,159
so forth and we're not necessarily

116
00:04:00,159 --> 00:04:01,280
seeing or considering those

117
00:04:01,280 --> 00:04:03,840
relationships which can be a problem

118
00:04:03,840 --> 00:04:05,840
that things like um by not doing that

119
00:04:05,840 --> 00:04:07,599
you know you may have trouble

120
00:04:07,599 --> 00:04:09,680
identifying false positives so for

121
00:04:09,680 --> 00:04:12,239
example you may see two individual

122
00:04:12,239 --> 00:04:14,319
techniques that you know are out there

123
00:04:14,319 --> 00:04:16,079
in whatever information you're looking

124
00:04:16,079 --> 00:04:17,918
at you think okay that's nothing that's

125
00:04:17,918 --> 00:04:20,000
just let's ignore it but if you knew

126
00:04:20,000 --> 00:04:21,680
that they were related and you saw them

127
00:04:21,680 --> 00:04:24,160
together as a unit then it could be like

128
00:04:24,160 --> 00:04:26,160
wow that's really significant so that's

129
00:04:26,160 --> 00:04:27,360
the kind of things that we're trying to

130
00:04:27,360 --> 00:04:28,880
address

131
00:04:28,880 --> 00:04:30,560
you know when you have campaigns or

132
00:04:30,560 --> 00:04:32,080
incidents happening

133
00:04:32,080 --> 00:04:34,880
and you don't have a very you know as

134
00:04:34,880 --> 00:04:37,280
thorough understanding as you can have

135
00:04:37,280 --> 00:04:38,800
your response isn't going to be as good

136
00:04:38,800 --> 00:04:41,759
as it could be so these problems and the

137
00:04:41,759 --> 00:04:43,360
idea that we need to really be looking

138
00:04:43,360 --> 00:04:46,240
at sequences that was um the idea that

139
00:04:46,240 --> 00:04:48,720
motivated the idea of the task flow

140
00:04:48,720 --> 00:04:50,320
project

141
00:04:50,320 --> 00:04:52,080
so

142
00:04:52,080 --> 00:04:54,240
what is an attack flow this is a really

143
00:04:54,240 --> 00:04:56,080
basic representation just kind of to get

144
00:04:56,080 --> 00:04:58,080
you started and gabe is going to go into

145
00:04:58,080 --> 00:05:00,080
the details so you'll know a lot more

146
00:05:00,080 --> 00:05:01,360
after he's done

147
00:05:01,360 --> 00:05:04,400
but basically an attack flow

148
00:05:04,400 --> 00:05:06,080
is comprised of five things so you've

149
00:05:06,080 --> 00:05:07,840
got the flow itself

150
00:05:07,840 --> 00:05:11,039
and then you have lists or collections

151
00:05:11,039 --> 00:05:12,400
of actions

152
00:05:12,400 --> 00:05:14,320
assets and properties

153
00:05:14,320 --> 00:05:16,720
and then you also have the represent or

154
00:05:16,720 --> 00:05:18,560
the causal relationships between the

155
00:05:18,560 --> 00:05:20,800
actions and assets and again gabe will

156
00:05:20,800 --> 00:05:23,680
go into details but this is you know

157
00:05:23,680 --> 00:05:25,680
at a very high level what is an attack

158
00:05:25,680 --> 00:05:27,919
flow that's what it is

159
00:05:27,919 --> 00:05:29,360
and then how do they help you know the

160
00:05:29,360 --> 00:05:31,120
help of everything from

161
00:05:31,120 --> 00:05:32,960
explaining defensive postures to

162
00:05:32,960 --> 00:05:35,360
executives to developing realistic

163
00:05:35,360 --> 00:05:37,680
adversary emulation scenarios

164
00:05:37,680 --> 00:05:39,360
and ryu was actually going to talk more

165
00:05:39,360 --> 00:05:41,440
about those use cases how they're useful

166
00:05:41,440 --> 00:05:43,360
and you know

167
00:05:43,360 --> 00:05:44,800
what their impact has been or it could

168
00:05:44,800 --> 00:05:46,160
be

169
00:05:46,160 --> 00:05:48,160
this is an example here the graphical

170
00:05:48,160 --> 00:05:50,560
representation it was a tesla breach

171
00:05:50,560 --> 00:05:52,400
from 2018.

172
00:05:52,400 --> 00:05:54,479
and it happened when tesla's cloud

173
00:05:54,479 --> 00:05:56,720
environment is compromised to mine

174
00:05:56,720 --> 00:05:59,039
cryptocurrencies and so if you look up

175
00:05:59,039 --> 00:06:00,639
there you'll see

176
00:06:00,639 --> 00:06:01,840
the

177
00:06:01,840 --> 00:06:04,720
pink boxes are the actions

178
00:06:04,720 --> 00:06:07,039
the blue boxes are the assets and then

179
00:06:07,039 --> 00:06:09,280
the green boxes are the properties that

180
00:06:09,280 --> 00:06:11,600
are assigned in this case i think to the

181
00:06:11,600 --> 00:06:14,560
different um assets and then the black

182
00:06:14,560 --> 00:06:16,800
lines are the relationships

183
00:06:16,800 --> 00:06:19,440
between those actions and assets and i

184
00:06:19,440 --> 00:06:20,960
should point out if you look at it i

185
00:06:20,960 --> 00:06:22,800
think you could probably see the details

186
00:06:22,800 --> 00:06:25,120
you'll see that in the

187
00:06:25,120 --> 00:06:27,280
action piece we've referenced different

188
00:06:27,280 --> 00:06:29,440
attack techniques

189
00:06:29,440 --> 00:06:31,039
but to say that attack flow was

190
00:06:31,039 --> 00:06:33,039
developed to support all actions it

191
00:06:33,039 --> 00:06:35,199
doesn't have to be attack you know we

192
00:06:35,199 --> 00:06:37,759
tend to use the attack but

193
00:06:37,759 --> 00:06:40,080
it could be used you could also use like

194
00:06:40,080 --> 00:06:42,800
varus or vendor tool or anything you

195
00:06:42,800 --> 00:06:45,199
know your organization's own solution

196
00:06:45,199 --> 00:06:46,800
and gabe is going to probably show you

197
00:06:46,800 --> 00:06:48,479
more of the veris side of things you

198
00:06:48,479 --> 00:06:50,240
know it's it's really was purposely

199
00:06:50,240 --> 00:06:52,479
divine defined or developed so that you

200
00:06:52,479 --> 00:06:55,599
could use whatever you like there

201
00:06:55,599 --> 00:06:57,520
and now i think

202
00:06:57,520 --> 00:06:58,960
we're going to go into the solution and

203
00:06:58,960 --> 00:07:02,400
gabe will talk about the data format

204
00:07:02,400 --> 00:07:03,840
so

205
00:07:03,840 --> 00:07:06,080
this is the dense portion of the

206
00:07:06,080 --> 00:07:07,599
presentation

207
00:07:07,599 --> 00:07:08,560
um

208
00:07:08,560 --> 00:07:11,120
dez told you about the

209
00:07:11,120 --> 00:07:12,720
problem and so i'm going to tell you how

210
00:07:12,720 --> 00:07:13,840
to solve it we're going to do this by

211
00:07:13,840 --> 00:07:15,680
walking through an example because

212
00:07:15,680 --> 00:07:16,880
that's the way i like to kind of do

213
00:07:16,880 --> 00:07:18,479
things so we're going to start with the

214
00:07:18,479 --> 00:07:20,880
scheme and i do want to thank

215
00:07:20,880 --> 00:07:22,800
mark davidson who's now a title and andy

216
00:07:22,800 --> 00:07:25,120
applebaum who both now at apple who

217
00:07:25,120 --> 00:07:27,440
contributed to building the schema and

218
00:07:27,440 --> 00:07:29,680
the schema is really is what's required

219
00:07:29,680 --> 00:07:31,680
what's optional what you connect in

220
00:07:31,680 --> 00:07:33,680
informs the foundation of attack flow

221
00:07:33,680 --> 00:07:35,280
and so um

222
00:07:35,280 --> 00:07:39,039
the schema is written is initially in

223
00:07:39,039 --> 00:07:40,639
json schema

224
00:07:40,639 --> 00:07:43,120
but you can also define it in terms of a

225
00:07:43,120 --> 00:07:44,879
graph and we're going to call that the

226
00:07:44,879 --> 00:07:47,599
rdf version because it's linked data

227
00:07:47,599 --> 00:07:49,440
and one of the nice things is the graph

228
00:07:49,440 --> 00:07:51,360
version because it's linked data and rdf

229
00:07:51,360 --> 00:07:53,280
data it kind of inherits a lot of that

230
00:07:53,280 --> 00:07:55,199
and so you can represent it as json as

231
00:07:55,199 --> 00:07:57,280
in like json ld

232
00:07:57,280 --> 00:07:58,879
as tabular data or really kind of

233
00:07:58,879 --> 00:08:00,560
whatever scheme is and by the way i do

234
00:08:00,560 --> 00:08:02,319
want to talk a little bit about rdf

235
00:08:02,319 --> 00:08:04,160
because if this is the first time you've

236
00:08:04,160 --> 00:08:05,440
heard this and you're googling it and

237
00:08:05,440 --> 00:08:07,039
you find it you're going to get scared

238
00:08:07,039 --> 00:08:08,240
and you're never going to come back to

239
00:08:08,240 --> 00:08:10,400
it because it's this weird really

240
00:08:10,400 --> 00:08:14,400
complex really dense academic thing and

241
00:08:14,400 --> 00:08:16,720
that's all up here we're using this bit

242
00:08:16,720 --> 00:08:20,800
down here and so at its base level

243
00:08:20,800 --> 00:08:23,280
graphs are just nodes right dots and

244
00:08:23,280 --> 00:08:25,199
edges between them and

245
00:08:25,199 --> 00:08:27,199
rdf is just three things

246
00:08:27,199 --> 00:08:29,120
it's the node the edge and then the node

247
00:08:29,120 --> 00:08:31,440
it points to and in fact they're defined

248
00:08:31,440 --> 00:08:33,120
by your eyes or i mean we can call them

249
00:08:33,120 --> 00:08:35,760
urls because that's really what they are

250
00:08:35,760 --> 00:08:37,919
and so our three things are all just

251
00:08:37,919 --> 00:08:39,839
three of the same thing in a certain

252
00:08:39,839 --> 00:08:41,039
order

253
00:08:41,039 --> 00:08:43,039
it's the subject the predicate and the

254
00:08:43,039 --> 00:08:45,120
object but that doesn't make sense right

255
00:08:45,120 --> 00:08:46,160
like no one thinks about them in that

256
00:08:46,160 --> 00:08:47,360
way and so it's a lot easier to think

257
00:08:47,360 --> 00:08:49,600
about them in terms of the source the

258
00:08:49,600 --> 00:08:51,279
relationship and the destination even

259
00:08:51,279 --> 00:08:52,959
just the beginning the middle and the

260
00:08:52,959 --> 00:08:55,360
end you know whatever makes sense to you

261
00:08:55,360 --> 00:08:57,040
we're thinking about just three things

262
00:08:57,040 --> 00:08:58,240
in an order

263
00:08:58,240 --> 00:08:59,839
and that's what an rdf triple is and

264
00:08:59,839 --> 00:09:01,920
what our graph is built out of and again

265
00:09:01,920 --> 00:09:02,959
if you go search for this you're going

266
00:09:02,959 --> 00:09:03,920
to see

267
00:09:03,920 --> 00:09:06,880
things like al for web ontology language

268
00:09:06,880 --> 00:09:08,320
and it's going to say this is a tool you

269
00:09:08,320 --> 00:09:09,839
can use to reason across your graph and

270
00:09:09,839 --> 00:09:10,959
you're going to go i don't need to do

271
00:09:10,959 --> 00:09:13,519
that why would i want to do that and you

272
00:09:13,519 --> 00:09:15,760
don't in a tag flow i mean you could you

273
00:09:15,760 --> 00:09:18,320
could go do these things but in reality

274
00:09:18,320 --> 00:09:20,399
you're going to be using rdf or out to

275
00:09:20,399 --> 00:09:22,399
do things to say like this node

276
00:09:22,399 --> 00:09:26,080
is the same as this node right asset one

277
00:09:26,080 --> 00:09:29,760
is the same asset as my firewall

278
00:09:29,760 --> 00:09:32,480
you know very simple relationships and

279
00:09:32,480 --> 00:09:34,160
so don't get too

280
00:09:34,160 --> 00:09:35,680
scared by what you find when you look at

281
00:09:35,680 --> 00:09:37,680
rdf now

282
00:09:37,680 --> 00:09:39,279
attack flow really is dealing with a

283
00:09:39,279 --> 00:09:41,279
very basic portion of it so back to the

284
00:09:41,279 --> 00:09:42,160
example

285
00:09:42,160 --> 00:09:44,000
we have our foundation

286
00:09:44,000 --> 00:09:45,519
our foundation

287
00:09:45,519 --> 00:09:46,880
is the scheme and now we need to build

288
00:09:46,880 --> 00:09:48,880
on top of that and anytime we have three

289
00:09:48,880 --> 00:09:52,640
things actions assets and order we can

290
00:09:52,640 --> 00:09:54,320
build a flow

291
00:09:54,320 --> 00:09:56,560
and in the future i think tools are

292
00:09:56,560 --> 00:09:57,600
going to

293
00:09:57,600 --> 00:09:59,360
output flow data for you automatically

294
00:09:59,360 --> 00:10:01,200
but right now right this project just

295
00:10:01,200 --> 00:10:03,200
came out a few months ago and so we

296
00:10:03,200 --> 00:10:05,040
create them manually

297
00:10:05,040 --> 00:10:06,560
and you can really kind of create them

298
00:10:06,560 --> 00:10:08,000
from a lot of different types of data

299
00:10:08,000 --> 00:10:10,560
you can do it from incident reports

300
00:10:10,560 --> 00:10:12,079
from red team reports thread intel

301
00:10:12,079 --> 00:10:12,959
reports

302
00:10:12,959 --> 00:10:15,360
and one important thing here

303
00:10:15,360 --> 00:10:18,160
is that attack flow supports both action

304
00:10:18,160 --> 00:10:20,720
and asset centric views

305
00:10:20,720 --> 00:10:22,480
right in our ir report we talked about

306
00:10:22,480 --> 00:10:24,640
the servers first right it's very asset

307
00:10:24,640 --> 00:10:25,600
centric

308
00:10:25,600 --> 00:10:28,079
and in our red team report we talk about

309
00:10:28,079 --> 00:10:30,880
the action first right phished installed

310
00:10:30,880 --> 00:10:32,800
things like that and

311
00:10:32,800 --> 00:10:34,480
in general we see that right because if

312
00:10:34,480 --> 00:10:35,760
you get

313
00:10:35,760 --> 00:10:37,519
a blue team report it's going to have

314
00:10:37,519 --> 00:10:39,920
like the firewall and a user

315
00:10:39,920 --> 00:10:41,680
and a desktop and there's going to be a

316
00:10:41,680 --> 00:10:43,920
line that says action one action two

317
00:10:43,920 --> 00:10:46,720
action three it's very asset centric

318
00:10:46,720 --> 00:10:48,560
because the assets are the nodes

319
00:10:48,560 --> 00:10:50,480
if you look at like a red team report a

320
00:10:50,480 --> 00:10:52,000
lot of times it's action-centric and

321
00:10:52,000 --> 00:10:54,160
says we did action one first then we did

322
00:10:54,160 --> 00:10:56,079
action two then action three

323
00:10:56,079 --> 00:10:58,000
where the actions are really the nodes

324
00:10:58,000 --> 00:10:59,360
and the connection between them the

325
00:10:59,360 --> 00:11:02,000
relationship is kind of implicitly the

326
00:11:02,000 --> 00:11:03,839
asset connecting them

327
00:11:03,839 --> 00:11:04,800
and so

328
00:11:04,800 --> 00:11:06,959
attack flow makes those two views

329
00:11:06,959 --> 00:11:09,120
interoperable

330
00:11:09,120 --> 00:11:10,720
and so you've got your data now you need

331
00:11:10,720 --> 00:11:12,880
to structure it and the tool we're going

332
00:11:12,880 --> 00:11:14,240
to use for that in this example is

333
00:11:14,240 --> 00:11:16,399
attack flow designer this is free tool

334
00:11:16,399 --> 00:11:17,760
that was published as part of the attack

335
00:11:17,760 --> 00:11:20,720
flow one project

336
00:11:20,720 --> 00:11:22,560
credit goes to michael corenzo at mitre

337
00:11:22,560 --> 00:11:24,720
who built it and it's a really good

338
00:11:24,720 --> 00:11:26,640
assuming you can build a node

339
00:11:26,640 --> 00:11:29,279
npm app it's a really good kind of

340
00:11:29,279 --> 00:11:32,079
smooth entry into this

341
00:11:32,079 --> 00:11:33,519
it's not going to build like these big

342
00:11:33,519 --> 00:11:34,959
complex things but when you're at that

343
00:11:34,959 --> 00:11:36,720
point you know come find any of us we'll

344
00:11:36,720 --> 00:11:38,320
help you solve that

345
00:11:38,320 --> 00:11:40,399
and so here we see the actions are in

346
00:11:40,399 --> 00:11:41,519
blue

347
00:11:41,519 --> 00:11:44,000
the assets are in orange

348
00:11:44,000 --> 00:11:45,920
and it goes action asset action asset

349
00:11:45,920 --> 00:11:47,600
and that's very important that's how we

350
00:11:47,600 --> 00:11:49,279
get that interoperability between kind

351
00:11:49,279 --> 00:11:51,040
of the red and blue side

352
00:11:51,040 --> 00:11:52,800
and we have our properties down here in

353
00:11:52,800 --> 00:11:54,160
red

354
00:11:54,160 --> 00:11:56,639
and the relationships to the lines

355
00:11:56,639 --> 00:11:57,920
and one thing you'll notice you know as

356
00:11:57,920 --> 00:12:00,959
dez mentioned she um her example uses

357
00:12:00,959 --> 00:12:01,920
attack

358
00:12:01,920 --> 00:12:03,519
here we're using varus if you don't know

359
00:12:03,519 --> 00:12:04,800
varus is a

360
00:12:04,800 --> 00:12:07,120
schema that the verizon team the dbir

361
00:12:07,120 --> 00:12:10,240
team uses to code incidents and breaches

362
00:12:10,240 --> 00:12:11,040
it's

363
00:12:11,040 --> 00:12:13,120
helpful for us in that it's a very good

364
00:12:13,120 --> 00:12:15,040
structured way to represent things but

365
00:12:15,040 --> 00:12:18,000
it's just the way we think and if um dez

366
00:12:18,000 --> 00:12:20,720
thinks an attack and reuse things in

367
00:12:20,720 --> 00:12:22,560
something specific to him the cool thing

368
00:12:22,560 --> 00:12:25,440
about attack flow is we can all have our

369
00:12:25,440 --> 00:12:28,079
own schemas our own name spaces

370
00:12:28,079 --> 00:12:30,240
and so we can use whatever makes sense

371
00:12:30,240 --> 00:12:32,399
to us in fact i can explain we'll show

372
00:12:32,399 --> 00:12:34,959
later how i can say this is thing in my

373
00:12:34,959 --> 00:12:36,240
schema

374
00:12:36,240 --> 00:12:38,320
relates to thing indexes in fact because

375
00:12:38,320 --> 00:12:39,680
we're incorporating

376
00:12:39,680 --> 00:12:41,839
namespaces i don't even have to put that

377
00:12:41,839 --> 00:12:43,839
whole thing in i just have to put you

378
00:12:43,839 --> 00:12:46,160
know varus person

379
00:12:46,160 --> 00:12:47,839
and then everything about what a person

380
00:12:47,839 --> 00:12:50,720
is is implicitly exists in that other

381
00:12:50,720 --> 00:12:53,040
namespace and so this is this great

382
00:12:53,040 --> 00:12:55,200
capability um associated with the tag

383
00:12:55,200 --> 00:12:56,959
flow and it's based on the fact that we

384
00:12:56,959 --> 00:13:00,720
use urls or uris for the ids

385
00:13:00,720 --> 00:13:02,079
and so you've built out that tool you

386
00:13:02,079 --> 00:13:03,440
get you point and clicked and filled in

387
00:13:03,440 --> 00:13:04,880
the fields

388
00:13:04,880 --> 00:13:06,160
and one thing i want to point out is

389
00:13:06,160 --> 00:13:07,839
that the reason action is longer here is

390
00:13:07,839 --> 00:13:10,000
because it has more defined properties

391
00:13:10,000 --> 00:13:11,839
you can add as many properties as you

392
00:13:11,839 --> 00:13:13,920
want on each one of these and so it's

393
00:13:13,920 --> 00:13:15,120
not restricted from a property

394
00:13:15,120 --> 00:13:17,040
perspective and so you fill that out and

395
00:13:17,040 --> 00:13:18,800
you get a file it's a json schema file

396
00:13:18,800 --> 00:13:20,320
and don't worry about the fact that this

397
00:13:20,320 --> 00:13:22,399
is an eye chart a lot of these charts

398
00:13:22,399 --> 00:13:24,160
are that way just to show that you can

399
00:13:24,160 --> 00:13:25,440
do this and kind of give an idea it's

400
00:13:25,440 --> 00:13:27,040
not meant for you to like figure out

401
00:13:27,040 --> 00:13:28,880
what each line says

402
00:13:28,880 --> 00:13:30,880
and so the nice thing here is that

403
00:13:30,880 --> 00:13:32,320
action

404
00:13:32,320 --> 00:13:34,880
assets relationships data properties

405
00:13:34,880 --> 00:13:36,480
object properties those are all in their

406
00:13:36,480 --> 00:13:37,440
own

407
00:13:37,440 --> 00:13:38,880
space and that's kind of the benefit you

408
00:13:38,880 --> 00:13:41,199
get from doing this as a json schema

409
00:13:41,199 --> 00:13:43,120
you can also convert it to a graph this

410
00:13:43,120 --> 00:13:45,120
is a json ld

411
00:13:45,120 --> 00:13:47,600
and so here it's a list right

412
00:13:47,600 --> 00:13:50,560
and each object in the list is its own

413
00:13:50,560 --> 00:13:51,440
node

414
00:13:51,440 --> 00:13:53,040
and the nice thing here is that you can

415
00:13:53,040 --> 00:13:55,120
see this kind of key value property

416
00:13:55,120 --> 00:13:57,040
where here's the key and here's the

417
00:13:57,040 --> 00:13:58,800
value and so what you have

418
00:13:58,800 --> 00:14:00,800
is you have a source

419
00:14:00,800 --> 00:14:02,880
a relationship and a destination you

420
00:14:02,880 --> 00:14:04,000
have your triples you have all the

421
00:14:04,000 --> 00:14:06,000
triples coming from that node all

422
00:14:06,000 --> 00:14:07,120
together

423
00:14:07,120 --> 00:14:08,480
the other nice thing is because this is

424
00:14:08,480 --> 00:14:11,440
rdf data um you inherit that ecosystem

425
00:14:11,440 --> 00:14:12,320
so

426
00:14:12,320 --> 00:14:14,639
here we're expressing is json you can

427
00:14:14,639 --> 00:14:17,920
also express it as tabular data

428
00:14:17,920 --> 00:14:20,240
you can express it as xml really there's

429
00:14:20,240 --> 00:14:21,519
a format for almost anything there's

430
00:14:21,519 --> 00:14:23,519
human readable formats and because

431
00:14:23,519 --> 00:14:24,959
there's so many formats it's very

432
00:14:24,959 --> 00:14:26,800
storage agnostic

433
00:14:26,800 --> 00:14:28,959
you can store it in sql databases you

434
00:14:28,959 --> 00:14:30,639
can store it in nosql databases key

435
00:14:30,639 --> 00:14:33,279
value stores graph databases flat files

436
00:14:33,279 --> 00:14:35,199
whatever works for you

437
00:14:35,199 --> 00:14:37,360
and you also get kind the tooling

438
00:14:37,360 --> 00:14:39,279
ecosystem which includes apis for

439
00:14:39,279 --> 00:14:41,680
transport includes visualization

440
00:14:41,680 --> 00:14:43,279
editing tools reasoning tools

441
00:14:43,279 --> 00:14:45,199
programming querying

442
00:14:45,199 --> 00:14:47,519
there's already this big ecosystem

443
00:14:47,519 --> 00:14:49,920
around linked data that you get to take

444
00:14:49,920 --> 00:14:53,120
advantage of from a graph perspective

445
00:14:53,120 --> 00:14:55,360
and so but this is all text right we

446
00:14:55,360 --> 00:14:56,720
don't want to work in text we want to

447
00:14:56,720 --> 00:14:58,720
look at something and so what's it look

448
00:14:58,720 --> 00:14:59,680
like

449
00:14:59,680 --> 00:15:02,000
this is us having converted it we built

450
00:15:02,000 --> 00:15:03,839
it in designer we converted it to a

451
00:15:03,839 --> 00:15:05,600
graph and now we're looking at it in a

452
00:15:05,600 --> 00:15:08,480
tool called onto text graph db

453
00:15:08,480 --> 00:15:10,839
just because it's this nice free graph

454
00:15:10,839 --> 00:15:13,519
database there's a lot of tools you

455
00:15:13,519 --> 00:15:14,480
could use

456
00:15:14,480 --> 00:15:16,639
um and again here the actions are

457
00:15:16,639 --> 00:15:18,240
circled in blue

458
00:15:18,240 --> 00:15:20,160
the assets are in orange and you still

459
00:15:20,160 --> 00:15:23,040
have this causal path and by the way

460
00:15:23,040 --> 00:15:24,480
here we're using actions to mean

461
00:15:24,480 --> 00:15:27,199
malicious actions but

462
00:15:27,199 --> 00:15:29,199
it doesn't force that on you you could

463
00:15:29,199 --> 00:15:31,040
use actions to describe legitimate

464
00:15:31,040 --> 00:15:32,959
actions of your system you can use

465
00:15:32,959 --> 00:15:34,959
actions to describe responses you would

466
00:15:34,959 --> 00:15:36,000
take

467
00:15:36,000 --> 00:15:38,959
and so like you know if you have

468
00:15:38,959 --> 00:15:40,720
s-bomb data you say that this

469
00:15:40,720 --> 00:15:42,720
piece of software it relies on this

470
00:15:42,720 --> 00:15:45,360
other piece of software you can build

471
00:15:45,360 --> 00:15:46,720
relationships in that way to say a

472
00:15:46,720 --> 00:15:48,320
compromise of this piece of software

473
00:15:48,320 --> 00:15:50,639
would create an action that compromises

474
00:15:50,639 --> 00:15:52,880
something else and so you can describe

475
00:15:52,880 --> 00:15:55,279
that kind of

476
00:15:55,279 --> 00:15:57,360
resiliency or lack thereof

477
00:15:57,360 --> 00:15:58,800
and so those are the actions and assets

478
00:15:58,800 --> 00:16:00,480
we have the properties down below in

479
00:16:00,480 --> 00:16:01,920
this orange box and i've only shown kind

480
00:16:01,920 --> 00:16:03,759
of bigger ones not like the timestamps

481
00:16:03,759 --> 00:16:04,959
and such

482
00:16:04,959 --> 00:16:06,800
and so those are three of the parts that

483
00:16:06,800 --> 00:16:09,279
dev showed you the fourth is the flow

484
00:16:09,279 --> 00:16:11,759
and so we define a single flow as a node

485
00:16:11,759 --> 00:16:13,519
and then our relationships are all these

486
00:16:13,519 --> 00:16:15,279
edges in between

487
00:16:15,279 --> 00:16:16,240
right

488
00:16:16,240 --> 00:16:18,079
and the nice thing in the power of

489
00:16:18,079 --> 00:16:19,839
attack flow is it describes the three

490
00:16:19,839 --> 00:16:20,880
c's

491
00:16:20,880 --> 00:16:24,000
describes causality describes context

492
00:16:24,000 --> 00:16:26,399
and it describes complexity

493
00:16:26,399 --> 00:16:28,480
and so causality obviously is the causal

494
00:16:28,480 --> 00:16:30,240
path in the middle

495
00:16:30,240 --> 00:16:32,079
um the stuff that happened and again

496
00:16:32,079 --> 00:16:33,519
right you've got actions you've got

497
00:16:33,519 --> 00:16:34,959
assets you've got order you can build

498
00:16:34,959 --> 00:16:37,040
that causal path

499
00:16:37,040 --> 00:16:40,639
second it describes context so log files

500
00:16:40,639 --> 00:16:42,480
if you have information about the asset

501
00:16:42,480 --> 00:16:43,839
you can build that in

502
00:16:43,839 --> 00:16:46,399
if you have the attack knowledge base as

503
00:16:46,399 --> 00:16:48,399
a graph you can reference into it and

504
00:16:48,399 --> 00:16:50,079
take advantage of all that additional

505
00:16:50,079 --> 00:16:52,480
context and all those properties

506
00:16:52,480 --> 00:16:54,639
and we have complexity and this one's a

507
00:16:54,639 --> 00:16:56,160
little harder to explain from a graph

508
00:16:56,160 --> 00:16:58,160
perspective and we put a lot of work

509
00:16:58,160 --> 00:16:59,759
into kind of the

510
00:16:59,759 --> 00:17:03,360
the theoretical behind this uh behind a

511
00:17:03,360 --> 00:17:05,919
tag flow in graph terms the action and

512
00:17:05,919 --> 00:17:08,160
assets create a bipartite network which

513
00:17:08,160 --> 00:17:10,160
is one way of representing hypergraphs

514
00:17:10,160 --> 00:17:12,160
with complex relationships and who here

515
00:17:12,160 --> 00:17:14,720
cares about that yeah no one right like

516
00:17:14,720 --> 00:17:15,760
this is the kind of thing from

517
00:17:15,760 --> 00:17:17,839
theoretically that we care about what

518
00:17:17,839 --> 00:17:19,439
benefits y'all

519
00:17:19,439 --> 00:17:22,400
is i'm from southern us so i see y'all a

520
00:17:22,400 --> 00:17:23,679
lot

521
00:17:23,679 --> 00:17:25,679
what benefits y'all is that the

522
00:17:25,679 --> 00:17:27,919
complexity allows for the asset centric

523
00:17:27,919 --> 00:17:29,679
and action-centric views to work

524
00:17:29,679 --> 00:17:31,840
together and inter-operate and that is

525
00:17:31,840 --> 00:17:34,320
very important for the community it also

526
00:17:34,320 --> 00:17:36,160
allows for

527
00:17:36,160 --> 00:17:38,799
complex incidents to work and so where

528
00:17:38,799 --> 00:17:41,440
we have fan out we have collapsing back

529
00:17:41,440 --> 00:17:43,360
down

530
00:17:43,360 --> 00:17:46,640
we have going back to previous assets

531
00:17:46,640 --> 00:17:48,960
attack flow works for simple incidents

532
00:17:48,960 --> 00:17:52,320
but it also works for complex ones

533
00:17:52,320 --> 00:17:53,520
and so but

534
00:17:53,520 --> 00:17:54,880
i mean this is all cool you get to look

535
00:17:54,880 --> 00:17:56,160
at and stuff but really what you want to

536
00:17:56,160 --> 00:17:57,440
do is you want to ask your data

537
00:17:57,440 --> 00:17:59,039
questions i'm a data scientist i want to

538
00:17:59,039 --> 00:18:00,320
ask questions i don't want to look at

539
00:18:00,320 --> 00:18:01,840
data because i've got lots and lots of

540
00:18:01,840 --> 00:18:02,799
it

541
00:18:02,799 --> 00:18:05,120
i want to aggregate it and analyze it

542
00:18:05,120 --> 00:18:07,919
and so we can do that here because we're

543
00:18:07,919 --> 00:18:09,520
doing a graph database we're asking

544
00:18:09,520 --> 00:18:11,679
questions in sparkle

545
00:18:11,679 --> 00:18:13,200
but you can really do it in any language

546
00:18:13,200 --> 00:18:16,640
that your data store supports

547
00:18:16,640 --> 00:18:19,600
on the left we're asking it what action

548
00:18:19,600 --> 00:18:21,760
or what assets have been breached very

549
00:18:21,760 --> 00:18:23,039
simple

550
00:18:23,039 --> 00:18:24,640
on the right we're asking it what

551
00:18:24,640 --> 00:18:26,320
actions have we seen and these are very

552
00:18:26,320 --> 00:18:28,080
simple queries but you could go back and

553
00:18:28,080 --> 00:18:29,919
conceptually you could say hey show me

554
00:18:29,919 --> 00:18:32,080
everything within a time span

555
00:18:32,080 --> 00:18:34,480
or count what actions happen most often

556
00:18:34,480 --> 00:18:35,760
because that's what i want to go then

557
00:18:35,760 --> 00:18:38,240
target when i go and buy my mitigations

558
00:18:38,240 --> 00:18:40,080
you can really kind of query it to the

559
00:18:40,080 --> 00:18:41,760
extent that your query language surprise

560
00:18:41,760 --> 00:18:44,960
whether it's sql or cipher or kql or

561
00:18:44,960 --> 00:18:47,440
whatever

562
00:18:47,440 --> 00:18:49,440
and so and again right this isn't just

563
00:18:49,440 --> 00:18:50,720
varus

564
00:18:50,720 --> 00:18:52,400
we're using various actions here but it

565
00:18:52,400 --> 00:18:54,080
could just as easily be an attack and in

566
00:18:54,080 --> 00:18:56,160
fact you can map between them right

567
00:18:56,160 --> 00:18:59,120
there's a ctid project called attack

568
00:18:59,120 --> 00:19:00,240
tavares

569
00:19:00,240 --> 00:19:02,320
and that would let you map from attack

570
00:19:02,320 --> 00:19:04,000
to varus in the same name space you

571
00:19:04,000 --> 00:19:05,200
could define in either one of them and

572
00:19:05,200 --> 00:19:06,720
still know what was happening in the

573
00:19:06,720 --> 00:19:08,640
other by bringing in

574
00:19:08,640 --> 00:19:13,120
this project has an additional namespace

575
00:19:13,120 --> 00:19:14,880
and so with that i'm going to hand it

576
00:19:14,880 --> 00:19:16,320
over to ryu one of

577
00:19:16,320 --> 00:19:17,840
someone that i learn impressive stuff

578
00:19:17,840 --> 00:19:19,600
about every single day

579
00:19:19,600 --> 00:19:20,799
he's going to tell you about the

580
00:19:20,799 --> 00:19:25,320
benefits of attack flow

581
00:19:27,840 --> 00:19:29,200
okay

582
00:19:29,200 --> 00:19:30,160
let me

583
00:19:30,160 --> 00:19:32,880
talk about impacts and

584
00:19:32,880 --> 00:19:36,320
use cases of attack flows

585
00:19:36,320 --> 00:19:39,840
these are what we compiled uh

586
00:19:39,840 --> 00:19:42,160
at the beginning of this attack flow

587
00:19:42,160 --> 00:19:45,360
project and they are yet to be realized

588
00:19:45,360 --> 00:19:46,240
but

589
00:19:46,240 --> 00:19:50,640
we believe they are important and

590
00:19:50,640 --> 00:19:52,720
valid okay

591
00:19:52,720 --> 00:19:54,400
and we

592
00:19:54,400 --> 00:19:56,880
we categorize them in a couple of uh

593
00:19:56,880 --> 00:19:59,360
several categories the first one is the

594
00:19:59,360 --> 00:20:01,120
beta communication

595
00:20:01,120 --> 00:20:05,600
this is about uh human to human um

596
00:20:05,600 --> 00:20:08,400
so uh and this is mostly about a

597
00:20:08,400 --> 00:20:11,679
visualization of attack flows

598
00:20:11,679 --> 00:20:12,799
um

599
00:20:12,799 --> 00:20:15,760
so uh for example we can use some of the

600
00:20:15,760 --> 00:20:18,080
visualization you have seen

601
00:20:18,080 --> 00:20:20,640
uh in the previous slides

602
00:20:20,640 --> 00:20:24,799
for a visualized ir incident response or

603
00:20:24,799 --> 00:20:28,960
threat intelligence or red gym data

604
00:20:28,960 --> 00:20:29,760
we

605
00:20:29,760 --> 00:20:32,559
believe some of the attack flows we

606
00:20:32,559 --> 00:20:36,000
might want to simplify to visualize so

607
00:20:36,000 --> 00:20:36,960
uh

608
00:20:36,960 --> 00:20:38,400
we are thinking of

609
00:20:38,400 --> 00:20:40,960
aggregating nodes and

610
00:20:40,960 --> 00:20:42,080
actions

611
00:20:42,080 --> 00:20:44,880
and future tangential properties

612
00:20:44,880 --> 00:20:45,679
to

613
00:20:45,679 --> 00:20:49,840
give out a simpler version of

614
00:20:49,840 --> 00:20:52,159
attack flow or visualization

615
00:20:52,159 --> 00:20:53,120
and

616
00:20:53,120 --> 00:20:54,720
the one

617
00:20:54,720 --> 00:20:57,200
more important probably

618
00:20:57,200 --> 00:20:58,240
is to

619
00:20:58,240 --> 00:21:00,720
use a visualization to explain a

620
00:21:00,720 --> 00:21:02,799
defensive postures

621
00:21:02,799 --> 00:21:03,919
to

622
00:21:03,919 --> 00:21:06,960
your executives and

623
00:21:06,960 --> 00:21:10,000
this one is too small so we have a blow

624
00:21:10,000 --> 00:21:12,400
up one in the next slide

625
00:21:12,400 --> 00:21:14,640
and

626
00:21:14,640 --> 00:21:17,440
so what we did this in this um

627
00:21:17,440 --> 00:21:20,240
visualization is we

628
00:21:20,240 --> 00:21:24,480
we uh overlaid uh money flow on top of

629
00:21:24,480 --> 00:21:26,000
attack flow

630
00:21:26,000 --> 00:21:29,919
and uh so uh this is one uh one of

631
00:21:29,919 --> 00:21:32,799
our attempts to visualize in many ways

632
00:21:32,799 --> 00:21:36,159
because it is in machine readable uh

633
00:21:36,159 --> 00:21:40,320
format uh you can have a lot of

634
00:21:40,320 --> 00:21:43,280
visualization you might want to try out

635
00:21:43,280 --> 00:21:45,840
and

636
00:21:46,159 --> 00:21:48,799
and we are also working on

637
00:21:48,799 --> 00:21:51,360
different visualizations

638
00:21:51,360 --> 00:21:53,760
in their follow-up

639
00:21:53,760 --> 00:21:54,799
project

640
00:21:54,799 --> 00:21:56,159
okay

641
00:21:56,159 --> 00:21:58,080
and the second one is a better

642
00:21:58,080 --> 00:22:01,039
intelligence exchange uh actually this

643
00:22:01,039 --> 00:22:03,280
is about uh machine

644
00:22:03,280 --> 00:22:07,039
computer to computer uh communication

645
00:22:07,039 --> 00:22:08,480
and

646
00:22:08,480 --> 00:22:11,360
so the future i4c

647
00:22:11,360 --> 00:22:12,480
is

648
00:22:12,480 --> 00:22:13,360
that

649
00:22:13,360 --> 00:22:15,360
attack flow sightings

650
00:22:15,360 --> 00:22:19,120
are shared on machine 2 machine

651
00:22:19,120 --> 00:22:23,039
accurately and at machine speed

652
00:22:23,039 --> 00:22:25,280
so

653
00:22:25,520 --> 00:22:28,240
and it doesn't always have to be a full

654
00:22:28,240 --> 00:22:30,320
attack flow um

655
00:22:30,320 --> 00:22:31,760
here i

656
00:22:31,760 --> 00:22:34,880
we have a graph pattern this is

657
00:22:34,880 --> 00:22:36,880
something that uh

658
00:22:36,880 --> 00:22:39,039
a part of uh

659
00:22:39,039 --> 00:22:42,080
attack flow that occurs again and again

660
00:22:42,080 --> 00:22:44,799
so we sometimes call it motif

661
00:22:44,799 --> 00:22:48,320
so we can also so we can share our

662
00:22:48,320 --> 00:22:51,520
full attack flows or a part of attack

663
00:22:51,520 --> 00:22:56,720
flows which are a graph patterns and

664
00:22:56,720 --> 00:22:59,280
motif

665
00:22:59,760 --> 00:23:01,600
okay

666
00:23:01,600 --> 00:23:03,520
the next

667
00:23:03,520 --> 00:23:06,159
category of use cases uh

668
00:23:06,159 --> 00:23:09,600
is beta operations and we believe our

669
00:23:09,600 --> 00:23:11,760
attack flows uh contribute to better

670
00:23:11,760 --> 00:23:14,080
operations and the key

671
00:23:14,080 --> 00:23:17,600
uh we believe is the attack flow queries

672
00:23:17,600 --> 00:23:18,480
gave

673
00:23:18,480 --> 00:23:20,320
uh mentioned

674
00:23:20,320 --> 00:23:24,559
and so my example is that um

675
00:23:24,559 --> 00:23:28,159
i i had a one technique which was very

676
00:23:28,159 --> 00:23:29,760
difficult to

677
00:23:29,760 --> 00:23:31,919
mitigate in the past

678
00:23:31,919 --> 00:23:34,240
uh at that time what i thought was that

679
00:23:34,240 --> 00:23:35,600
um but

680
00:23:35,600 --> 00:23:38,480
technique does not happen in isolation

681
00:23:38,480 --> 00:23:41,840
so uh if there are attack flows going

682
00:23:41,840 --> 00:23:44,400
into that technique and then uh

683
00:23:44,400 --> 00:23:47,440
coming out of that technique so uh if

684
00:23:47,440 --> 00:23:50,799
you even if you cannot stop a particular

685
00:23:50,799 --> 00:23:54,320
technique if you can stop uh before the

686
00:23:54,320 --> 00:23:56,320
technique or immediately after the

687
00:23:56,320 --> 00:23:57,679
technique then

688
00:23:57,679 --> 00:24:01,600
we are much better position safer

689
00:24:01,600 --> 00:24:02,720
so that's

690
00:24:02,720 --> 00:24:04,480
better operations

691
00:24:04,480 --> 00:24:05,520
and

692
00:24:05,520 --> 00:24:08,480
and a better defensive planning so uh

693
00:24:08,480 --> 00:24:10,640
if you go back

694
00:24:10,640 --> 00:24:12,000
backward

695
00:24:12,000 --> 00:24:14,559
you if you follow the attack flows

696
00:24:14,559 --> 00:24:17,440
backward then you should have a much

697
00:24:17,440 --> 00:24:20,480
better understanding of attack surfaces

698
00:24:20,480 --> 00:24:23,520
we can use them analyze risks

699
00:24:23,520 --> 00:24:26,240
and aggregate attack flows

700
00:24:26,240 --> 00:24:29,039
and then uh then as

701
00:24:29,039 --> 00:24:31,600
that's quickly mentioned but we can

702
00:24:31,600 --> 00:24:32,480
build

703
00:24:32,480 --> 00:24:34,960
and communicate known atomic detections

704
00:24:34,960 --> 00:24:36,960
so

705
00:24:36,960 --> 00:24:38,320
we can

706
00:24:38,320 --> 00:24:42,400
combine a detection of multiple

707
00:24:42,400 --> 00:24:45,679
techniques in attack flow then we should

708
00:24:45,679 --> 00:24:48,240
be able to have a much

709
00:24:48,240 --> 00:24:53,200
more reliable detection of the attack

710
00:24:53,919 --> 00:24:56,799
choke points here

711
00:24:56,799 --> 00:24:58,960
is what

712
00:24:58,960 --> 00:25:02,960
most of the attack flows uh go through

713
00:25:02,960 --> 00:25:05,360
techniques that most of our attack flows

714
00:25:05,360 --> 00:25:06,400
go through

715
00:25:06,400 --> 00:25:08,880
if we can identify

716
00:25:08,880 --> 00:25:10,799
these choke points then we should be

717
00:25:10,799 --> 00:25:12,559
able to

718
00:25:12,559 --> 00:25:14,799
invest our resources much more

719
00:25:14,799 --> 00:25:18,159
efficiently uh to those uh to deal with

720
00:25:18,159 --> 00:25:21,200
those choke points

721
00:25:22,559 --> 00:25:24,880
and then uh best assess better

722
00:25:24,880 --> 00:25:26,559
assessment so

723
00:25:26,559 --> 00:25:29,279
we can use attack flows to build more

724
00:25:29,279 --> 00:25:30,720
realistic

725
00:25:30,720 --> 00:25:33,440
adversary emulation scenarios

726
00:25:33,440 --> 00:25:37,360
for pen testing or to automate uh breach

727
00:25:37,360 --> 00:25:42,400
and attack simulation tools or bas tools

728
00:25:42,400 --> 00:25:45,840
when you do that uh probably

729
00:25:45,840 --> 00:25:48,240
a logic operators like

730
00:25:48,240 --> 00:25:50,960
and and or for the

731
00:25:50,960 --> 00:25:53,600
for the attack flow

732
00:25:53,600 --> 00:25:57,120
schema is the key we believe

733
00:25:57,120 --> 00:25:58,799
so

734
00:25:58,799 --> 00:26:02,000
in order to realize those use cases and

735
00:26:02,000 --> 00:26:04,400
merits or impacts

736
00:26:04,400 --> 00:26:05,600
we believe

737
00:26:05,600 --> 00:26:08,880
we it is critical to have a lot of

738
00:26:08,880 --> 00:26:10,400
attack flows

739
00:26:10,400 --> 00:26:13,520
so we started to build a corpus of

740
00:26:13,520 --> 00:26:16,799
attack flows and currently we have

741
00:26:16,799 --> 00:26:18,400
those

742
00:26:18,400 --> 00:26:23,039
six of them uh one of which this one is

743
00:26:23,039 --> 00:26:26,080
uh provided from outside the of the uh

744
00:26:26,080 --> 00:26:28,880
of the project sorry

745
00:26:28,880 --> 00:26:30,240
so uh

746
00:26:30,240 --> 00:26:33,279
you can find them in our githum

747
00:26:33,279 --> 00:26:35,600
uh in the github here

748
00:26:35,600 --> 00:26:37,279
and uh so

749
00:26:37,279 --> 00:26:40,799
we are planning to build more uh create

750
00:26:40,799 --> 00:26:43,279
more attack flows uh

751
00:26:43,279 --> 00:26:45,279
and uh i

752
00:26:45,279 --> 00:26:50,559
we invite you to provide attack flows uh

753
00:26:50,799 --> 00:26:52,640
attack flows so

754
00:26:52,640 --> 00:26:56,720
that's it for me and des

755
00:27:01,840 --> 00:27:03,279
all right so

756
00:27:03,279 --> 00:27:05,120
we have a number of resources available

757
00:27:05,120 --> 00:27:07,120
so we hope that you'll check them out

758
00:27:07,120 --> 00:27:09,200
and even become an early user of attack

759
00:27:09,200 --> 00:27:11,840
flow so that would be fantastic you know

760
00:27:11,840 --> 00:27:14,080
you may be a vendor that could implement

761
00:27:14,080 --> 00:27:16,799
attack flows in your tool or service or

762
00:27:16,799 --> 00:27:19,120
maybe you're an organization and you

763
00:27:19,120 --> 00:27:21,520
could start to integrate attack flows

764
00:27:21,520 --> 00:27:23,840
into your um

765
00:27:23,840 --> 00:27:25,840
processes and that so

766
00:27:25,840 --> 00:27:28,000
um and it can be hard you know using

767
00:27:28,000 --> 00:27:31,360
attack flows isn't immediately easy

768
00:27:31,360 --> 00:27:35,279
you know we had the workshop and um

769
00:27:35,279 --> 00:27:37,200
even as a team you know that's part of

770
00:27:37,200 --> 00:27:38,559
what we're doing you know we're building

771
00:27:38,559 --> 00:27:40,320
out actually for attack flow too we are

772
00:27:40,320 --> 00:27:42,399
making a much bigger corpus and learning

773
00:27:42,399 --> 00:27:44,559
things along the way so it isn't

774
00:27:44,559 --> 00:27:46,399
necessarily easy but we are here to help

775
00:27:46,399 --> 00:27:48,240
and we'd love to help you guys so

776
00:27:48,240 --> 00:27:51,120
contact us directly or you know we've

777
00:27:51,120 --> 00:27:53,120
got the github if you've got

778
00:27:53,120 --> 00:27:54,880
feedback there that would be great if

779
00:27:54,880 --> 00:27:57,120
you contributed at that

780
00:27:57,120 --> 00:28:00,320
i think the workshop material

781
00:28:00,320 --> 00:28:01,679
not the workshop itself but we're

782
00:28:01,679 --> 00:28:03,600
thinking about maybe putting some of the

783
00:28:03,600 --> 00:28:04,399
uh

784
00:28:04,399 --> 00:28:06,320
resources like that online too at some

785
00:28:06,320 --> 00:28:07,200
point

786
00:28:07,200 --> 00:28:11,279
um and we've also got so of the

787
00:28:13,279 --> 00:28:14,960
so here's the um

788
00:28:14,960 --> 00:28:16,799
on medium there's a blog post and that

789
00:28:16,799 --> 00:28:18,720
might be a good place to start it kind

790
00:28:18,720 --> 00:28:20,480
of reviews what we've seen today but

791
00:28:20,480 --> 00:28:22,000
kind of a higher level overview of

792
00:28:22,000 --> 00:28:23,760
things and then you could go to the

793
00:28:23,760 --> 00:28:26,159
github site for the details and actually

794
00:28:26,159 --> 00:28:28,799
to look at the schema and that corpus

795
00:28:28,799 --> 00:28:30,240
and that's all on the public site right

796
00:28:30,240 --> 00:28:33,039
now so you know we are refining the

797
00:28:33,039 --> 00:28:35,840
solution in attack flow too

798
00:28:35,840 --> 00:28:36,640
and

799
00:28:36,640 --> 00:28:38,399
part of that is based upon you know

800
00:28:38,399 --> 00:28:40,880
community feedback so anything any

801
00:28:40,880 --> 00:28:42,559
comments that you guys have any

802
00:28:42,559 --> 00:28:44,880
suggestions if you could open them as an

803
00:28:44,880 --> 00:28:46,240
issue in github that would probably be

804
00:28:46,240 --> 00:28:48,559
the most helpful to us or again contact

805
00:28:48,559 --> 00:28:50,559
us directly we are getting some

806
00:28:50,559 --> 00:28:52,399
community feedback now if you go to

807
00:28:52,399 --> 00:28:54,000
github and have a look to see what

808
00:28:54,000 --> 00:28:56,159
people are talking about so that again

809
00:28:56,159 --> 00:28:58,000
you know the whole community coming

810
00:28:58,000 --> 00:28:59,679
together is going to make it

811
00:28:59,679 --> 00:29:01,279
the most successful

812
00:29:01,279 --> 00:29:02,240
um

813
00:29:02,240 --> 00:29:03,120
so

814
00:29:03,120 --> 00:29:04,480
also

815
00:29:04,480 --> 00:29:05,279
so

816
00:29:05,279 --> 00:29:07,360
for the dbir um

817
00:29:07,360 --> 00:29:08,960
they breach investigations point from

818
00:29:08,960 --> 00:29:10,559
verizon like we spend a lot of time

819
00:29:10,559 --> 00:29:11,840
coding data and we spent a lot of time

820
00:29:11,840 --> 00:29:13,760
teaching people to code data

821
00:29:13,760 --> 00:29:15,520
and so it's very likely that as you come

822
00:29:15,520 --> 00:29:16,559
in you'll

823
00:29:16,559 --> 00:29:17,679
want to look for that we're going to

824
00:29:17,679 --> 00:29:20,159
start trying to produce some content to

825
00:29:20,159 --> 00:29:22,240
help teach people how to code this but

826
00:29:22,240 --> 00:29:25,120
also the same way for the dvr by the way

827
00:29:25,120 --> 00:29:27,760
we are always looking on the dvr for new

828
00:29:27,760 --> 00:29:30,720
contributors people that can help bring

829
00:29:30,720 --> 00:29:33,279
incidents from their industry from their

830
00:29:33,279 --> 00:29:35,039
reach in the world

831
00:29:35,039 --> 00:29:37,039
and it helps make our report more

832
00:29:37,039 --> 00:29:38,159
applicable

833
00:29:38,159 --> 00:29:41,600
um as well and so if you

834
00:29:41,600 --> 00:29:43,760
have incidents that you might be willing

835
00:29:43,760 --> 00:29:46,799
to contribute for the dbir it's they go

836
00:29:46,799 --> 00:29:48,559
back for the good of the community um

837
00:29:48,559 --> 00:29:49,919
also if you want to figure out how to

838
00:29:49,919 --> 00:29:52,080
code incidents whether an attack flow or

839
00:29:52,080 --> 00:29:54,000
in varus or whatever

840
00:29:54,000 --> 00:29:56,640
to structure your incident data again

841
00:29:56,640 --> 00:29:57,840
reach out

842
00:29:57,840 --> 00:29:59,279
we're here to help and we've done it

843
00:29:59,279 --> 00:30:01,039
many times before and we love doing it

844
00:30:01,039 --> 00:30:02,399
to help other people figure out how to

845
00:30:02,399 --> 00:30:04,559
structure their incident data and so

846
00:30:04,559 --> 00:30:07,440
with that um open it up to questions

847
00:30:07,440 --> 00:30:10,559
thank you thank you

848
00:30:11,290 --> 00:30:18,659
[Applause]

849
00:30:21,520 --> 00:30:23,760
uh thanks for your talk um eric julian

850
00:30:23,760 --> 00:30:26,159
from octa uh just real quick so do you

851
00:30:26,159 --> 00:30:27,919
have any um

852
00:30:27,919 --> 00:30:30,480
i guess proof of concept for how to

853
00:30:30,480 --> 00:30:32,799
to actually use it for detection

854
00:30:32,799 --> 00:30:34,240
um

855
00:30:34,240 --> 00:30:36,159
like whether in splunk or elasticsearch

856
00:30:36,159 --> 00:30:38,559
or anything like that and so part of the

857
00:30:38,559 --> 00:30:41,840
second project is to look at workflows

858
00:30:41,840 --> 00:30:44,799
and so the first project produces schema

859
00:30:44,799 --> 00:30:46,559
and the second project is looking to

860
00:30:46,559 --> 00:30:48,640
then produce like documents to help

861
00:30:48,640 --> 00:30:50,159
explain how to accomplish the different

862
00:30:50,159 --> 00:30:52,159
things you can accomplish with it

863
00:30:52,159 --> 00:30:53,120
um

864
00:30:53,120 --> 00:30:56,159
i i don't remember if um

865
00:30:56,159 --> 00:30:58,000
searches within

866
00:30:58,000 --> 00:31:00,320
um like splunk or such are one of the

867
00:31:00,320 --> 00:31:01,840
workflows but hopefully out of the

868
00:31:01,840 --> 00:31:04,080
second project will have some discrete

869
00:31:04,080 --> 00:31:06,640
workflows to say this is how you would

870
00:31:06,640 --> 00:31:08,559
automate a pin tester this is how you

871
00:31:08,559 --> 00:31:10,080
would

872
00:31:10,080 --> 00:31:11,840
do detection or such

873
00:31:11,840 --> 00:31:14,320
but in general detection gets to be one

874
00:31:14,320 --> 00:31:16,519
of the really interesting things

875
00:31:16,519 --> 00:31:18,640
because um

876
00:31:18,640 --> 00:31:20,320
the challenges will not be with attack

877
00:31:20,320 --> 00:31:21,200
flow

878
00:31:21,200 --> 00:31:23,200
they'll be with how you store the data

879
00:31:23,200 --> 00:31:24,960
because if you pump in lots and lots of

880
00:31:24,960 --> 00:31:26,640
data into a graph it gets very big very

881
00:31:26,640 --> 00:31:29,200
quick and so if you're searching for

882
00:31:29,200 --> 00:31:30,399
every time you pump something new and

883
00:31:30,399 --> 00:31:32,320
you're searching the entire graph for a

884
00:31:32,320 --> 00:31:35,279
specific say pair of nodes which is very

885
00:31:35,279 --> 00:31:36,960
easy to do right you can if you say hey

886
00:31:36,960 --> 00:31:38,480
i want to find a that leads to b that

887
00:31:38,480 --> 00:31:39,679
leads to c

888
00:31:39,679 --> 00:31:41,519
you know that's a simple query in almost

889
00:31:41,519 --> 00:31:43,440
any language that you'd be doing it in

890
00:31:43,440 --> 00:31:45,200
but if you have to do it every time you

891
00:31:45,200 --> 00:31:47,200
get something new in over the entire

892
00:31:47,200 --> 00:31:49,440
data set it's going to be very slow and

893
00:31:49,440 --> 00:31:50,640
so there

894
00:31:50,640 --> 00:31:52,399
the bigger problem ends up being your

895
00:31:52,399 --> 00:31:54,720
optimization of how you execute and when

896
00:31:54,720 --> 00:31:56,960
you execute the searches versus the

897
00:31:56,960 --> 00:31:58,799
actual query the queries end up being

898
00:31:58,799 --> 00:32:01,200
rather simple to write

899
00:32:01,200 --> 00:32:03,360
yeah and then uh just that i was

900
00:32:03,360 --> 00:32:04,720
thinking about something along those

901
00:32:04,720 --> 00:32:06,640
lines it's like i mean if you've got a

902
00:32:06,640 --> 00:32:08,640
a 20 step

903
00:32:08,640 --> 00:32:09,519
flow

904
00:32:09,519 --> 00:32:10,960
i don't know if it would i don't know i

905
00:32:10,960 --> 00:32:13,279
guess optimizing it is you know four of

906
00:32:13,279 --> 00:32:15,679
those steps optimal or three of those

907
00:32:15,679 --> 00:32:16,559
steps

908
00:32:16,559 --> 00:32:18,480
to get closer to

909
00:32:18,480 --> 00:32:20,320
um and so

910
00:32:20,320 --> 00:32:22,720
if i were doing it i want i would put

911
00:32:22,720 --> 00:32:25,039
the entire flows in because that

912
00:32:25,039 --> 00:32:26,720
aggregate data particularly when you go

913
00:32:26,720 --> 00:32:29,440
like ri was talking about um when you go

914
00:32:29,440 --> 00:32:31,200
and do strategic planning you might find

915
00:32:31,200 --> 00:32:33,279
out that that 20 flow

916
00:32:33,279 --> 00:32:34,640
or 20 step

917
00:32:34,640 --> 00:32:36,799
breach all and every other one you

918
00:32:36,799 --> 00:32:38,880
breaches all go through this one node

919
00:32:38,880 --> 00:32:40,720
and if you left out that portion when

920
00:32:40,720 --> 00:32:42,320
you're coding it into your data set you

921
00:32:42,320 --> 00:32:44,080
might not find that out but when it

922
00:32:44,080 --> 00:32:45,840
comes to searching

923
00:32:45,840 --> 00:32:48,000
i think you use the minimal search

924
00:32:48,000 --> 00:32:50,799
that's viable in fact so like

925
00:32:50,799 --> 00:32:51,840
grapple

926
00:32:51,840 --> 00:32:54,080
grpl is this company that does graph

927
00:32:54,080 --> 00:32:56,399
based detections in memory

928
00:32:56,399 --> 00:32:58,640
and like there's some of their matches

929
00:32:58,640 --> 00:33:00,320
or many other matches i think are just

930
00:33:00,320 --> 00:33:02,000
like two nodes

931
00:33:02,000 --> 00:33:03,679
or effectively two actions you know an

932
00:33:03,679 --> 00:33:05,840
action an asset and then an action and

933
00:33:05,840 --> 00:33:07,600
they still get a huge amount of benefit

934
00:33:07,600 --> 00:33:08,960
about that because

935
00:33:08,960 --> 00:33:11,279
every new thing you put in there

936
00:33:11,279 --> 00:33:13,200
does a better job compared to what we

937
00:33:13,200 --> 00:33:15,279
are doing which is looking for one

938
00:33:15,279 --> 00:33:16,320
action

939
00:33:16,320 --> 00:33:18,480
um even just stepping up to two actions

940
00:33:18,480 --> 00:33:21,279
gets clears out a lot of the chaff

941
00:33:21,279 --> 00:33:23,440
and false positives and focuses in more

942
00:33:23,440 --> 00:33:24,880
narrowly and so i do think that you use

943
00:33:24,880 --> 00:33:27,519
the minimal matching you need um talking

944
00:33:27,519 --> 00:33:28,399
about

945
00:33:28,399 --> 00:33:30,720
motifs or graph patterns

946
00:33:30,720 --> 00:33:32,799
right even in academia trying to match a

947
00:33:32,799 --> 00:33:35,120
pattern past like

948
00:33:35,120 --> 00:33:36,480
five or six nodes and granted they're

949
00:33:36,480 --> 00:33:37,760
doing in a much more generic way but

950
00:33:37,760 --> 00:33:38,399
it's

951
00:33:38,399 --> 00:33:40,480
very computationally intensive

952
00:33:40,480 --> 00:33:42,799
and so the smaller you can make that

953
00:33:42,799 --> 00:33:44,480
match the more efficient the better it's

954
00:33:44,480 --> 00:33:45,440
going to be but that gets back to the

955
00:33:45,440 --> 00:33:47,200
efficiency question

956
00:33:47,200 --> 00:33:49,760
great thanks

957
00:33:50,960 --> 00:33:52,880
we have about a minute left if there's

958
00:33:52,880 --> 00:33:56,000
any other questions but

959
00:33:57,120 --> 00:33:58,240
all right well thank you so much for

960
00:33:58,240 --> 00:34:01,310
coming to see our talk today thank you

961
00:34:01,310 --> 00:34:07,429
[Applause]

962
00:34:26,079 --> 00:34:28,159
you

