1
00:00:02,879 --> 00:00:05,870
foreign

2
00:00:05,870 --> 00:00:07,200
[Music]

3
00:00:07,200 --> 00:00:10,440
I can hear me too so I guess welcome to

4
00:00:10,440 --> 00:00:13,200
the session uh don't all cluster

5
00:00:13,200 --> 00:00:14,820
together down front

6
00:00:14,820 --> 00:00:17,580
um we've got some exciting uh what you

7
00:00:17,580 --> 00:00:21,000
call content uh material uh Adventures

8
00:00:21,000 --> 00:00:23,460
ahead of us this afternoon I'm not gonna

9
00:00:23,460 --> 00:00:24,720
waste

10
00:00:24,720 --> 00:00:26,519
this gentleman's time or all of yours

11
00:00:26,519 --> 00:00:28,019
I'm trade early I'm your session chair

12
00:00:28,019 --> 00:00:30,060
if there are any issues throw something

13
00:00:30,060 --> 00:00:32,098
at my head or text me on slack or

14
00:00:32,098 --> 00:00:33,300
something

15
00:00:33,300 --> 00:00:36,000
um Joseph Carson you can read about him

16
00:00:36,000 --> 00:00:38,760
in the program as I did but I asked him

17
00:00:38,760 --> 00:00:40,320
what are some interesting things about

18
00:00:40,320 --> 00:00:42,420
you that people maybe don't know and he

19
00:00:42,420 --> 00:00:44,160
started talking about you know hobbies

20
00:00:44,160 --> 00:00:45,780
and whatnot and then he happened to

21
00:00:45,780 --> 00:00:46,980
mention that

22
00:00:46,980 --> 00:00:49,320
as it says in the first sentence of your

23
00:00:49,320 --> 00:00:52,020
bio 25 years over 25 years experience

24
00:00:52,020 --> 00:00:54,239
but it was Brian honen

25
00:00:54,239 --> 00:00:56,280
whose fault it was that God demented to

26
00:00:56,280 --> 00:00:58,980
this back in 2001 the year of Our Lord

27
00:00:58,980 --> 00:01:00,000
so

28
00:01:00,000 --> 00:01:01,500
um you're going to take us on a bit of a

29
00:01:01,500 --> 00:01:04,500
walk through of ransomware from uh the

30
00:01:04,500 --> 00:01:06,020
other side of the Looking Glass

31
00:01:06,020 --> 00:01:09,119
well let's have a warm Round of Applause

32
00:01:09,119 --> 00:01:11,939
and one last thing sorry I'm it's been

33
00:01:11,939 --> 00:01:14,040
years since I've done this before the

34
00:01:14,040 --> 00:01:15,180
round of applause there's like a

35
00:01:15,180 --> 00:01:17,400
kilogram of Belgian praline chocolates

36
00:01:17,400 --> 00:01:19,799
down here I believe that good speakers

37
00:01:19,799 --> 00:01:22,560
deserve good questions good questions

38
00:01:22,560 --> 00:01:25,020
will be rewarded by me with Belgian

39
00:01:25,020 --> 00:01:26,460
pralines just bear that in mind

40
00:01:26,460 --> 00:01:28,439
throughout the rest of the day and with

41
00:01:28,439 --> 00:01:31,079
that warm Round of Applause for Joseph

42
00:01:31,079 --> 00:01:33,780
thank you

43
00:01:33,780 --> 00:01:35,340
so

44
00:01:35,340 --> 00:01:37,380
it's a pleasure to be here this is my

45
00:01:37,380 --> 00:01:39,060
first time at first and my first time

46
00:01:39,060 --> 00:01:41,340
speaking at first so I'm so excited to

47
00:01:41,340 --> 00:01:42,780
be here sharing my experience and

48
00:01:42,780 --> 00:01:45,479
knowledge with you and the majority of

49
00:01:45,479 --> 00:01:46,979
this session I'm actually going to be

50
00:01:46,979 --> 00:01:49,439
attempting to do a live demonstration

51
00:01:49,439 --> 00:01:51,840
walkthrough I had two choices when I was

52
00:01:51,840 --> 00:01:54,240
actually selected to speak here today I

53
00:01:54,240 --> 00:01:56,939
could throw slides at you and walk you

54
00:01:56,939 --> 00:01:58,500
through it that way but I think it's

55
00:01:58,500 --> 00:02:00,360
always better seeing it in the actual

56
00:02:00,360 --> 00:02:02,700
kind of the demonstration itself to give

57
00:02:02,700 --> 00:02:04,380
you the real understanding about what

58
00:02:04,380 --> 00:02:05,939
it's like from attackers perspective

59
00:02:05,939 --> 00:02:07,560
when they're actually targeting an

60
00:02:07,560 --> 00:02:09,179
organization and the steps and

61
00:02:09,179 --> 00:02:11,099
techniques they do to go through I've

62
00:02:11,099 --> 00:02:12,780
been privileged because not many

63
00:02:12,780 --> 00:02:15,180
organizations I've been in the industry

64
00:02:15,180 --> 00:02:17,099
quite a long time and not many

65
00:02:17,099 --> 00:02:20,459
organizations give you the permission to

66
00:02:20,459 --> 00:02:21,720
tell their story

67
00:02:21,720 --> 00:02:24,000
to share their experience

68
00:02:24,000 --> 00:02:26,160
to take you through the Journey to what

69
00:02:26,160 --> 00:02:27,780
happened to their business

70
00:02:27,780 --> 00:02:29,099
and I've been fortunate enough to be

71
00:02:29,099 --> 00:02:31,260
allowed and permitted in order to share

72
00:02:31,260 --> 00:02:34,200
that experience to give the knowledge to

73
00:02:34,200 --> 00:02:36,660
you and hopefully that organizations

74
00:02:36,660 --> 00:02:38,819
will learn from this and actually

75
00:02:38,819 --> 00:02:40,980
prevent them from becoming a victim in

76
00:02:40,980 --> 00:02:43,260
the future to provide the world a chance

77
00:02:43,260 --> 00:02:46,080
we're all here superheroes fighting a a

78
00:02:46,080 --> 00:02:48,420
major crime and I think it's important

79
00:02:48,420 --> 00:02:50,280
that we actually have to share knowledge

80
00:02:50,280 --> 00:02:52,319
together and work together and that's

81
00:02:52,319 --> 00:02:54,180
what they permitted me to do so I'm

82
00:02:54,180 --> 00:02:55,379
going to take you through a ransomware

83
00:02:55,379 --> 00:02:56,640
insta response

84
00:02:56,640 --> 00:02:58,739
and this particular incident is related

85
00:02:58,739 --> 00:03:01,019
to the crylock version of ransomware so

86
00:03:01,019 --> 00:03:02,519
some of you might be familiar with it

87
00:03:02,519 --> 00:03:04,920
for me I like to take incidents that

88
00:03:04,920 --> 00:03:06,959
I've experienced in the past that taught

89
00:03:06,959 --> 00:03:09,480
me something new that I learned from

90
00:03:09,480 --> 00:03:11,040
them that I think that others should

91
00:03:11,040 --> 00:03:13,319
also learn from that as well now crylock

92
00:03:13,319 --> 00:03:16,260
was a updated variant of ransomer which

93
00:03:16,260 --> 00:03:17,940
the previous versions was known as cry

94
00:03:17,940 --> 00:03:21,000
Echo and crackle went up to version 1.6

95
00:03:21,000 --> 00:03:23,220
and it was around until about kind of

96
00:03:23,220 --> 00:03:26,760
mid 2018 maybe early 2019 and then it

97
00:03:26,760 --> 00:03:28,680
disappeared and was around the time that

98
00:03:28,680 --> 00:03:30,000
they actually found weaknesses in the

99
00:03:30,000 --> 00:03:31,920
encryption capability and ultimately a

100
00:03:31,920 --> 00:03:33,780
key was disclosed to previous victims

101
00:03:33,780 --> 00:03:35,940
then it disappeared for a while

102
00:03:35,940 --> 00:03:39,299
then it resurfaced around mid-2020 and

103
00:03:39,299 --> 00:03:41,340
in mid-2020 it was interesting because

104
00:03:41,340 --> 00:03:43,080
it was one of the first it wasn't

105
00:03:43,080 --> 00:03:45,420
necessarily ransomware as a service it

106
00:03:45,420 --> 00:03:47,159
was actually ransomware with an

107
00:03:47,159 --> 00:03:48,599
affiliate program so think about

108
00:03:48,599 --> 00:03:51,299
ransomware creators that have a Channel

109
00:03:51,299 --> 00:03:53,819
program that for those who want to do

110
00:03:53,819 --> 00:03:56,099
cyber crime they can become you know

111
00:03:56,099 --> 00:03:58,379
Partners or Affiliates of that uh

112
00:03:58,379 --> 00:04:01,799
ransomware Creator and then basically go

113
00:04:01,799 --> 00:04:03,659
and distribute it and get runs from our

114
00:04:03,659 --> 00:04:05,580
rewards and they provide rewards back to

115
00:04:05,580 --> 00:04:07,620
the creators of the ransomer so for me

116
00:04:07,620 --> 00:04:09,480
it was an interesting time

117
00:04:09,480 --> 00:04:11,760
um and that this was something that uh

118
00:04:11,760 --> 00:04:15,120
was very catastrophic to the business so

119
00:04:15,120 --> 00:04:16,259
the first thing is that this

120
00:04:16,259 --> 00:04:18,540
organization promotes organizations you

121
00:04:18,540 --> 00:04:19,798
tend to find out that you're a victim

122
00:04:19,798 --> 00:04:22,019
from the outside before you even know

123
00:04:22,019 --> 00:04:23,820
yourself and what I mean by that

124
00:04:23,820 --> 00:04:25,199
sometimes you'll hear from law

125
00:04:25,199 --> 00:04:26,699
enforcement sometimes you'll hear from

126
00:04:26,699 --> 00:04:28,979
third parties customers Partners even

127
00:04:28,979 --> 00:04:31,680
your employees sometimes you might hear

128
00:04:31,680 --> 00:04:33,060
from security researchers and they'll

129
00:04:33,060 --> 00:04:34,199
share a particular interesting story

130
00:04:34,199 --> 00:04:36,660
about this incident as well from my

131
00:04:36,660 --> 00:04:38,759
experience from being a security

132
00:04:38,759 --> 00:04:40,919
researcher you sometimes might hear from

133
00:04:40,919 --> 00:04:42,360
social media you might hear from Twitter

134
00:04:42,360 --> 00:04:44,759
feeds the attackers might be shaming and

135
00:04:44,759 --> 00:04:47,280
you know blaming you and notifying your

136
00:04:47,280 --> 00:04:49,080
customers that you're a victim as well

137
00:04:49,080 --> 00:04:51,479
this particular attacker they actually

138
00:04:51,479 --> 00:04:53,639
notified the security team directly

139
00:04:53,639 --> 00:04:55,560
early Sunday morning they decided to

140
00:04:55,560 --> 00:04:57,720
send messages emails to the security

141
00:04:57,720 --> 00:04:59,340
team notifying that or their

142
00:04:59,340 --> 00:05:01,080
organization have become a victim of a

143
00:05:01,080 --> 00:05:03,300
ransomware attack the attacker still had

144
00:05:03,300 --> 00:05:05,400
persistent access they still were

145
00:05:05,400 --> 00:05:07,020
actually at that time of notifying the

146
00:05:07,020 --> 00:05:08,900
security team they were still actually

147
00:05:08,900 --> 00:05:11,340
extracting large amounts and gigabytes

148
00:05:11,340 --> 00:05:13,080
of data from the organization so they'll

149
00:05:13,080 --> 00:05:14,759
actually still do basically escort

150
00:05:14,759 --> 00:05:16,919
trading data from the organization now I

151
00:05:16,919 --> 00:05:18,060
always like to share a bit of

152
00:05:18,060 --> 00:05:20,400
interesting piece of this is that when I

153
00:05:20,400 --> 00:05:21,780
was actually doing the instant response

154
00:05:21,780 --> 00:05:23,100
in digital forensics of this particular

155
00:05:23,100 --> 00:05:26,039
case that it's common that you sometimes

156
00:05:26,039 --> 00:05:28,620
find other evidence of other victims the

157
00:05:28,620 --> 00:05:30,360
attackers were not so sophisticated they

158
00:05:30,360 --> 00:05:32,340
did a lot of copy paste and they

159
00:05:32,340 --> 00:05:33,960
actually copy pasted some of the scripts

160
00:05:33,960 --> 00:05:35,340
and some of the logs and evidence from

161
00:05:35,340 --> 00:05:37,800
other crimes and actually reused it in

162
00:05:37,800 --> 00:05:40,020
this particular incident so as I was

163
00:05:40,020 --> 00:05:41,460
investigating the logs I did find

164
00:05:41,460 --> 00:05:44,520
another victim of the ransomer and I

165
00:05:44,520 --> 00:05:46,560
thought as a good security researcher

166
00:05:46,560 --> 00:05:48,060
what should I do I should notify the

167
00:05:48,060 --> 00:05:50,160
victim so I notified them fund the

168
00:05:50,160 --> 00:05:51,479
contact details this is quite a large

169
00:05:51,479 --> 00:05:52,740
organization

170
00:05:52,740 --> 00:05:54,600
so I sent them information saying I'm

171
00:05:54,600 --> 00:05:57,300
investigating another incident here and

172
00:05:57,300 --> 00:05:59,100
I find evidence of your IP addresses

173
00:05:59,100 --> 00:06:02,400
server names usernames passwords that

174
00:06:02,400 --> 00:06:03,780
were actually discovered in this

175
00:06:03,780 --> 00:06:05,699
particular case

176
00:06:05,699 --> 00:06:07,220
and

177
00:06:07,220 --> 00:06:10,319
that basically a few days later I get a

178
00:06:10,319 --> 00:06:12,660
response back saying you're wrong

179
00:06:12,660 --> 00:06:14,400
there's we don't have we have no

180
00:06:14,400 --> 00:06:15,780
knowledge of urban summer instruments

181
00:06:15,780 --> 00:06:17,699
and we're not a victim

182
00:06:17,699 --> 00:06:19,440
I was curious I was going but I'm

183
00:06:19,440 --> 00:06:21,539
looking at the data so I decided that

184
00:06:21,539 --> 00:06:23,520
okay I sent back maybe this is a good

185
00:06:23,520 --> 00:06:25,380
opportunity maybe they haven't actually

186
00:06:25,380 --> 00:06:26,759
deployed the ransomware yet maybe it

187
00:06:26,759 --> 00:06:28,259
gives you a chance to go and investigate

188
00:06:28,259 --> 00:06:30,660
maybe they're preparing maybe this is a

189
00:06:30,660 --> 00:06:32,639
good time actually you have a chance to

190
00:06:32,639 --> 00:06:34,560
actually protect your organization

191
00:06:34,560 --> 00:06:37,620
silence after that and about a couple of

192
00:06:37,620 --> 00:06:39,240
months after closing up and doing the

193
00:06:39,240 --> 00:06:40,620
investigation it came to time where I

194
00:06:40,620 --> 00:06:42,060
actually had to take all of my archives

195
00:06:42,060 --> 00:06:43,440
and all the logs and all of the evidence

196
00:06:43,440 --> 00:06:45,600
passed it along to the organization who

197
00:06:45,600 --> 00:06:47,039
was the victim and they were going to

198
00:06:47,039 --> 00:06:49,139
pass it over to law enforcement uh for

199
00:06:49,139 --> 00:06:51,960
evidence Gathering and so forth and I

200
00:06:51,960 --> 00:06:53,400
thought other due diligence I should

201
00:06:53,400 --> 00:06:55,560
notify this victim again that claimed

202
00:06:55,560 --> 00:06:57,000
they weren't a victim to let them know

203
00:06:57,000 --> 00:06:58,919
that I'm handing over evidence that has

204
00:06:58,919 --> 00:07:00,860
actually traces of their data within it

205
00:07:00,860 --> 00:07:02,819
immediately afterwards I Got a

206
00:07:02,819 --> 00:07:05,099
notification saying yes we were a victim

207
00:07:05,099 --> 00:07:06,539
we don't want anyone to know about it

208
00:07:06,539 --> 00:07:09,120
they actually paid the ransom to recover

209
00:07:09,120 --> 00:07:10,560
so it's always interesting when you're

210
00:07:10,560 --> 00:07:12,479
doing digital forensics instant response

211
00:07:12,479 --> 00:07:14,280
sometimes you do find evidence of other

212
00:07:14,280 --> 00:07:16,620
types of victims and other crimes

213
00:07:16,620 --> 00:07:18,419
another interesting thing was when I was

214
00:07:18,419 --> 00:07:20,220
doing the evidence gathering this also

215
00:07:20,220 --> 00:07:23,220
that I did find uh crypto mining

216
00:07:23,220 --> 00:07:25,139
software that had been running in the

217
00:07:25,139 --> 00:07:26,880
environment for two years

218
00:07:26,880 --> 00:07:28,979
up until that point so crypto mining

219
00:07:28,979 --> 00:07:31,139
which was installed well before the

220
00:07:31,139 --> 00:07:33,360
attackers had access so it was likely

221
00:07:33,360 --> 00:07:34,800
being installed by an employee who

222
00:07:34,800 --> 00:07:37,199
decided to mine the organization's

223
00:07:37,199 --> 00:07:38,880
systems for cryptocurrency so it's

224
00:07:38,880 --> 00:07:40,199
always interesting what other things you

225
00:07:40,199 --> 00:07:42,300
find now in this of course when the

226
00:07:42,300 --> 00:07:43,979
organization was notified that they had

227
00:07:43,979 --> 00:07:46,860
become a victim of ransomware it was on

228
00:07:46,860 --> 00:07:48,000
a weekend

229
00:07:48,000 --> 00:07:50,160
and fortunately enough all of their

230
00:07:50,160 --> 00:07:51,780
employees majority of their employees

231
00:07:51,780 --> 00:07:53,940
who had laptops had taken them home on

232
00:07:53,940 --> 00:07:55,680
Friday so they were not directly

233
00:07:55,680 --> 00:07:57,000
connected to the corporate Network at

234
00:07:57,000 --> 00:07:58,919
the time but unfortunately the servers

235
00:07:58,919 --> 00:08:01,560
which were all connected had all quickly

236
00:08:01,560 --> 00:08:04,020
become victims of the ransomer itself so

237
00:08:04,020 --> 00:08:05,280
the organization triggered a rinse

238
00:08:05,280 --> 00:08:06,599
response and one of the lessons they

239
00:08:06,599 --> 00:08:08,940
learned in this particular incident was

240
00:08:08,940 --> 00:08:11,460
that having a plan is one thing

241
00:08:11,460 --> 00:08:13,919
actually practicing it is another thing

242
00:08:13,919 --> 00:08:15,660
and too many organizations they've spent

243
00:08:15,660 --> 00:08:17,340
the last ever since not Petra and want

244
00:08:17,340 --> 00:08:18,860
to cry they went through this

245
00:08:18,860 --> 00:08:21,000
inter-response planning process and

246
00:08:21,000 --> 00:08:22,919
they've got these plans in place and

247
00:08:22,919 --> 00:08:24,960
then they've left them for about a year

248
00:08:24,960 --> 00:08:26,460
on their SharePoint on their file

249
00:08:26,460 --> 00:08:28,560
systems and then when it comes time to

250
00:08:28,560 --> 00:08:30,840
trigger it what happens to it it's

251
00:08:30,840 --> 00:08:32,580
encrypted they don't have access to it

252
00:08:32,580 --> 00:08:34,200
they have an old copy that might be a

253
00:08:34,200 --> 00:08:37,200
year old so a lot of cases organizations

254
00:08:37,200 --> 00:08:39,599
they might have plans in place but I

255
00:08:39,599 --> 00:08:40,979
think we need to get the point we need

256
00:08:40,979 --> 00:08:42,539
to be practicing they need to simulate

257
00:08:42,539 --> 00:08:44,219
they need to understand that instant

258
00:08:44,219 --> 00:08:46,800
response is no longer just an I.T or a

259
00:08:46,800 --> 00:08:48,060
security team's accountability

260
00:08:48,060 --> 00:08:49,980
responsibility that actually is a

261
00:08:49,980 --> 00:08:51,660
business impact we need to make sure

262
00:08:51,660 --> 00:08:53,399
that when they're doing simulations they

263
00:08:53,399 --> 00:08:55,019
actually work with the business they

264
00:08:55,019 --> 00:08:56,399
work with other departments because in

265
00:08:56,399 --> 00:08:57,540
this sense response it was the first

266
00:08:57,540 --> 00:09:00,000
time they decided to talk with the

267
00:09:00,000 --> 00:09:01,680
finance team it was the first time they

268
00:09:01,680 --> 00:09:04,080
started talking with HR team the first

269
00:09:04,080 --> 00:09:05,459
time they started talking with the seals

270
00:09:05,459 --> 00:09:06,779
in other parts of the business to

271
00:09:06,779 --> 00:09:08,279
understand what they need to be doing to

272
00:09:08,279 --> 00:09:10,380
get the business back operating again

273
00:09:10,380 --> 00:09:12,899
now unfortunately they came the decision

274
00:09:12,899 --> 00:09:15,000
that within an hour or two of this

275
00:09:15,000 --> 00:09:16,800
incident they had to decide because the

276
00:09:16,800 --> 00:09:19,380
attackers still had persistent access

277
00:09:19,380 --> 00:09:22,019
they still had access to the network

278
00:09:22,019 --> 00:09:23,880
and the decision was made I can only

279
00:09:23,880 --> 00:09:26,279
make recommendations I was sometimes I

280
00:09:26,279 --> 00:09:27,959
would like to observe the attacker and

281
00:09:27,959 --> 00:09:29,839
understand more about their techniques

282
00:09:29,839 --> 00:09:31,740
unfortunately at the time when the

283
00:09:31,740 --> 00:09:33,240
investigation started the attackers had

284
00:09:33,240 --> 00:09:35,220
actually deleted lots of the log files

285
00:09:35,220 --> 00:09:38,339
so the logs And archiving and events was

286
00:09:38,339 --> 00:09:40,140
very very difficult there was much left

287
00:09:40,140 --> 00:09:43,200
at that stage so I'd like to observe but

288
00:09:43,200 --> 00:09:44,580
the attackers were still extracting

289
00:09:44,580 --> 00:09:46,920
large portions of data so the decision

290
00:09:46,920 --> 00:09:48,839
was made to basically shut down the

291
00:09:48,839 --> 00:09:51,360
environment they decided to cut off the

292
00:09:51,360 --> 00:09:52,920
systems shut them down cut the internet

293
00:09:52,920 --> 00:09:54,899
off in order to make sure they were able

294
00:09:54,899 --> 00:09:57,000
to control the incident and contain it

295
00:09:57,000 --> 00:09:58,380
some things were able to go back to

296
00:09:58,380 --> 00:10:00,000
operational Standalone that were

297
00:10:00,000 --> 00:10:02,160
isolated and the important question was

298
00:10:02,160 --> 00:10:03,779
you know how do we make sure the

299
00:10:03,779 --> 00:10:05,880
attackers can't get back in where do we

300
00:10:05,880 --> 00:10:07,620
find patient zero what systems were used

301
00:10:07,620 --> 00:10:09,300
for the staging environment

302
00:10:09,300 --> 00:10:11,160
in this less at this point in time there

303
00:10:11,160 --> 00:10:12,600
was a big decision about how do you get

304
00:10:12,600 --> 00:10:14,820
back to operation what's the path

305
00:10:14,820 --> 00:10:16,380
now a lot of things happen in between

306
00:10:16,380 --> 00:10:18,120
about understanding the skill

307
00:10:18,120 --> 00:10:20,279
understanding about how many systems are

308
00:10:20,279 --> 00:10:22,260
impacted and we got the point well let's

309
00:10:22,260 --> 00:10:24,300
restore from a backup well unfortunately

310
00:10:24,300 --> 00:10:27,420
like most organizations the backup was

311
00:10:27,420 --> 00:10:28,620
on the same network with the same

312
00:10:28,620 --> 00:10:30,600
credentials and what happens to that

313
00:10:30,600 --> 00:10:33,120
backup it is also encrypted

314
00:10:33,120 --> 00:10:35,339
so you're faced with a situation where

315
00:10:35,339 --> 00:10:37,560
all your production systems all your

316
00:10:37,560 --> 00:10:39,959
backup systems are not encrypted

317
00:10:39,959 --> 00:10:41,820
and they face a hard choice at that

318
00:10:41,820 --> 00:10:43,860
point in time it was the business had

319
00:10:43,860 --> 00:10:45,779
gone the business had basically

320
00:10:45,779 --> 00:10:47,880
evaporated within hours

321
00:10:47,880 --> 00:10:49,860
and this is a large business Hunter's

322
00:10:49,860 --> 00:10:52,079
employees multi-millions of years in

323
00:10:52,079 --> 00:10:53,880
revenue and they're faced with the

324
00:10:53,880 --> 00:10:55,019
choice of what how do we get this

325
00:10:55,019 --> 00:10:57,000
business back so they actually started

326
00:10:57,000 --> 00:10:58,500
looking into paying the ransom and we

327
00:10:58,500 --> 00:11:00,240
always hear I mean I'm a security

328
00:11:00,240 --> 00:11:02,160
researcher practitioner ethical hacker

329
00:11:02,160 --> 00:11:03,660
and we always hear about well the

330
00:11:03,660 --> 00:11:05,519
recommendation is not to pay the ransom

331
00:11:05,519 --> 00:11:07,860
and I that's the recommendation we

332
00:11:07,860 --> 00:11:09,420
shouldn't be forcing organizations at

333
00:11:09,420 --> 00:11:11,040
that decision because ultimately I can

334
00:11:11,040 --> 00:11:13,380
only provide my input ultimately it's a

335
00:11:13,380 --> 00:11:14,880
business decision into whether they pay

336
00:11:14,880 --> 00:11:17,760
the ransom it's a business decision what

337
00:11:17,760 --> 00:11:19,560
choice they face sometimes organizations

338
00:11:19,560 --> 00:11:21,060
pass that decision over to cyber

339
00:11:21,060 --> 00:11:22,980
insurance companies now as part of the

340
00:11:22,980 --> 00:11:24,240
policy so you have to make sure you

341
00:11:24,240 --> 00:11:26,040
understand what's in the policy because

342
00:11:26,040 --> 00:11:27,720
some cyber insurance company policies

343
00:11:27,720 --> 00:11:29,940
say that decision to pay the ransom is

344
00:11:29,940 --> 00:11:31,800
now part of insurance decision because

345
00:11:31,800 --> 00:11:33,959
it comes into financial decision

346
00:11:33,959 --> 00:11:36,300
fortunate enough this organization

347
00:11:36,300 --> 00:11:39,620
we find a system that had been migrated

348
00:11:39,620 --> 00:11:42,480
one year ago that was GDP decommissioned

349
00:11:42,480 --> 00:11:45,660
that had not been completely erased and

350
00:11:45,660 --> 00:11:46,980
decommissioned

351
00:11:46,980 --> 00:11:49,019
that was a one-year-old server that was

352
00:11:49,019 --> 00:11:51,839
migrated that actually was used as the

353
00:11:51,839 --> 00:11:54,540
basis of rebuilding this environment

354
00:11:54,540 --> 00:11:56,760
so what we were facing was was no longer

355
00:11:56,760 --> 00:11:58,680
that the entire business has gone what

356
00:11:58,680 --> 00:12:00,600
the business now faced was one year's

357
00:12:00,600 --> 00:12:02,639
worth of their business data had gone

358
00:12:02,639 --> 00:12:05,040
and it meant that we used that migrate

359
00:12:05,040 --> 00:12:07,800
server as the basis we actually migrated

360
00:12:07,800 --> 00:12:10,200
it and used that as Baseline we hired a

361
00:12:10,200 --> 00:12:12,000
bunch of data analysts in order to go

362
00:12:12,000 --> 00:12:14,100
through and sift through evidence to get

363
00:12:14,100 --> 00:12:16,560
data look through receipts paper

364
00:12:16,560 --> 00:12:19,200
inventory all the asset information and

365
00:12:19,200 --> 00:12:21,000
start recreating that businesses one

366
00:12:21,000 --> 00:12:22,980
year's worth of lost data it took almost

367
00:12:22,980 --> 00:12:25,019
about two to two and a half months to do

368
00:12:25,019 --> 00:12:26,579
that

369
00:12:26,579 --> 00:12:28,079
but they actually avoided paying their

370
00:12:28,079 --> 00:12:31,139
Ransom and actually this method was

371
00:12:31,139 --> 00:12:33,060
actually much cheaper it still costs a

372
00:12:33,060 --> 00:12:34,560
lot of money hundreds of thousands of

373
00:12:34,560 --> 00:12:36,660
euros but it was actually much cheaper

374
00:12:36,660 --> 00:12:38,100
than paying the multi-million of Euro

375
00:12:38,100 --> 00:12:39,959
Ransom that was being demanded and of

376
00:12:39,959 --> 00:12:40,860
course if you don't pay that rents

377
00:12:40,860 --> 00:12:42,120
within two days

378
00:12:42,120 --> 00:12:44,459
it increases 50 percent

379
00:12:44,459 --> 00:12:46,680
so what I was tasked with in this

380
00:12:46,680 --> 00:12:48,720
particular incident was not only helping

381
00:12:48,720 --> 00:12:52,079
coordinate and deal with basically the

382
00:12:52,079 --> 00:12:54,660
uh doing Dynamic and static analysis of

383
00:12:54,660 --> 00:12:56,940
the actual Renaissance itself and also

384
00:12:56,940 --> 00:12:58,200
helping to coordinate the team and

385
00:12:58,200 --> 00:12:59,279
making sure they're able to get the

386
00:12:59,279 --> 00:13:01,740
right images collected and so forth that

387
00:13:01,740 --> 00:13:03,480
I was tasked with understanding the

388
00:13:03,480 --> 00:13:05,880
techniques of the attacker my job was to

389
00:13:05,880 --> 00:13:07,740
put the attacker's hat on and understand

390
00:13:07,740 --> 00:13:11,100
how they got in what they did what steps

391
00:13:11,100 --> 00:13:12,959
they took what scripts they run and as

392
00:13:12,959 --> 00:13:14,880
an investigator we're dealing with a

393
00:13:14,880 --> 00:13:16,139
ransomware case one thing they're great

394
00:13:16,139 --> 00:13:18,300
at is destroying evidence

395
00:13:18,300 --> 00:13:20,459
when you're looking at a ransomware that

396
00:13:20,459 --> 00:13:22,500
but a lot of the times the logs are

397
00:13:22,500 --> 00:13:24,540
emptied they're cleared the events are

398
00:13:24,540 --> 00:13:27,600
deleted the actually uh systems logs are

399
00:13:27,600 --> 00:13:29,519
also encrypted so you're dealing with

400
00:13:29,519 --> 00:13:30,779
sometimes I call it like almost like

401
00:13:30,779 --> 00:13:33,000
having been giving a 10 000 piece jigsaw

402
00:13:33,000 --> 00:13:35,040
puzzle I'm looking at that puzzle and

403
00:13:35,040 --> 00:13:37,139
I've only got 300 pieces remaining

404
00:13:37,139 --> 00:13:38,579
and I know I need to put that jigsaw

405
00:13:38,579 --> 00:13:40,260
puzzle together and tell the

406
00:13:40,260 --> 00:13:41,639
organization what the big picture was

407
00:13:41,639 --> 00:13:44,100
it's almost it's a difficult job to do

408
00:13:44,100 --> 00:13:45,959
it's very challenging to be able to

409
00:13:45,959 --> 00:13:47,339
actually get into understanding about

410
00:13:47,339 --> 00:13:49,920
the entire attack path so I was given

411
00:13:49,920 --> 00:13:51,540
understand what access do they have the

412
00:13:51,540 --> 00:13:52,920
domain controllers

413
00:13:52,920 --> 00:13:54,540
what systems that they have access to

414
00:13:54,540 --> 00:13:58,139
what data how many applications was it

415
00:13:58,139 --> 00:14:00,360
limited to on-premise and Cloud

416
00:14:00,360 --> 00:14:01,980
what was the length of time of this

417
00:14:01,980 --> 00:14:03,180
attack

418
00:14:03,180 --> 00:14:05,940
what types of tools did they use did

419
00:14:05,940 --> 00:14:07,260
they leave any hidden back doors that

420
00:14:07,260 --> 00:14:08,699
allowed them to come back at a later

421
00:14:08,699 --> 00:14:11,100
stage what data did they take and how

422
00:14:11,100 --> 00:14:12,360
did they extract out of the organization

423
00:14:12,360 --> 00:14:14,459
what was the timeline of events and what

424
00:14:14,459 --> 00:14:15,720
evidence was remaining in order to

425
00:14:15,720 --> 00:14:18,120
actually conclude a very consensus of uh

426
00:14:18,120 --> 00:14:20,880
detailed investigation now what was

427
00:14:20,880 --> 00:14:22,440
really difficult was for finding the

428
00:14:22,440 --> 00:14:23,820
stage of machines at that point in time

429
00:14:23,820 --> 00:14:26,279
so what I did was with having very

430
00:14:26,279 --> 00:14:28,139
little evidence remaining I used things

431
00:14:28,139 --> 00:14:30,300
like plaso and log to timeline I got a

432
00:14:30,300 --> 00:14:31,980
lot of the event logs that was remaining

433
00:14:31,980 --> 00:14:34,320
and what I did was at that point in

434
00:14:34,320 --> 00:14:37,380
order to try and find the path to the

435
00:14:37,380 --> 00:14:39,540
staging machines what I did was I

436
00:14:39,540 --> 00:14:41,339
actually looked at the timestamp of the

437
00:14:41,339 --> 00:14:43,440
cleared event logs and I was able to

438
00:14:43,440 --> 00:14:45,180
actually create a pyramid into looking

439
00:14:45,180 --> 00:14:47,220
at these with systems and timestamps to

440
00:14:47,220 --> 00:14:49,079
finding the first machine that that

441
00:14:49,079 --> 00:14:51,180
cleared event log had happened on and

442
00:14:51,180 --> 00:14:52,860
that was able to then finding back to

443
00:14:52,860 --> 00:14:55,560
actually ultimately patient zero now

444
00:14:55,560 --> 00:14:57,540
when I got to Patient Zero was the next

445
00:14:57,540 --> 00:14:58,800
stage where I was able to then start

446
00:14:58,800 --> 00:14:59,880
building the footprints and

447
00:14:59,880 --> 00:15:01,920
understanding the attacker's footprint

448
00:15:01,920 --> 00:15:04,139
so who's ready for a demo I hope my

449
00:15:04,139 --> 00:15:06,720
machine is so let's see if I can make

450
00:15:06,720 --> 00:15:08,399
this work let's hope the demo gods are

451
00:15:08,399 --> 00:15:10,260
with me today

452
00:15:10,260 --> 00:15:12,839
yeah we'll see

453
00:15:12,839 --> 00:15:14,220
um I like putting myself on these

454
00:15:14,220 --> 00:15:16,500
challenging situations so I'm going to

455
00:15:16,500 --> 00:15:17,399
cut it short because I don't have a lot

456
00:15:17,399 --> 00:15:18,899
of time to go into as much detail as

457
00:15:18,899 --> 00:15:20,880
possible there's a lot of different ways

458
00:15:20,880 --> 00:15:22,320
that the attackers could have gained

459
00:15:22,320 --> 00:15:26,100
access but we know that seven months

460
00:15:26,100 --> 00:15:28,019
prior to the Hands-On keyboard so seven

461
00:15:28,019 --> 00:15:30,060
months prior to the attack itself there

462
00:15:30,060 --> 00:15:33,120
was a successful log on from a known uh

463
00:15:33,120 --> 00:15:34,920
bad reputation IP address that was

464
00:15:34,920 --> 00:15:37,620
coming from an exit tour node so we know

465
00:15:37,620 --> 00:15:39,300
that seven months prior was a successful

466
00:15:39,300 --> 00:15:42,120
logon how they got those credentials

467
00:15:42,120 --> 00:15:44,279
could have been fight fishing could have

468
00:15:44,279 --> 00:15:47,639
been via things like responder not bias

469
00:15:47,639 --> 00:15:50,880
and Gathering hashes maybe a machine was

470
00:15:50,880 --> 00:15:52,680
compromised at some point maybe somebody

471
00:15:52,680 --> 00:15:55,199
entered the credentials into a phishing

472
00:15:55,199 --> 00:15:57,360
website there's multiple ways of doing

473
00:15:57,360 --> 00:16:00,360
it but the way that we think that was

474
00:16:00,360 --> 00:16:02,220
the most likely was through RDP Brute

475
00:16:02,220 --> 00:16:05,339
Force why do we believe that one is that

476
00:16:05,339 --> 00:16:08,160
the the system that was patient zero was

477
00:16:08,160 --> 00:16:10,800
an interesting system it was a database

478
00:16:10,800 --> 00:16:13,560
Windows machine that was owned and

479
00:16:13,560 --> 00:16:15,240
responsible by an accountant and that

480
00:16:15,240 --> 00:16:16,519
accountant was in a different country

481
00:16:16,519 --> 00:16:18,720
and during the start of the pandemic

482
00:16:18,720 --> 00:16:20,279
that accountant needed to have access

483
00:16:20,279 --> 00:16:21,959
they could no longer travel to the

484
00:16:21,959 --> 00:16:24,000
location so what they did was Roland

485
00:16:24,000 --> 00:16:25,380
calling it

486
00:16:25,380 --> 00:16:27,180
they called the hosting provider

487
00:16:27,180 --> 00:16:28,380
directly

488
00:16:28,380 --> 00:16:31,320
and they demanded that RDP access to the

489
00:16:31,320 --> 00:16:34,079
server was made in the available so it

490
00:16:34,079 --> 00:16:35,940
they have Security in place they have

491
00:16:35,940 --> 00:16:37,759
antivirus they've got vpns they've got

492
00:16:37,759 --> 00:16:40,440
multi-factor authentication everything

493
00:16:40,440 --> 00:16:42,240
but because the accountant has a bit of

494
00:16:42,240 --> 00:16:44,399
power they decided to call the hosting

495
00:16:44,399 --> 00:16:45,779
provider and hosting provider decided

496
00:16:45,779 --> 00:16:46,920
well this is the person who pays the

497
00:16:46,920 --> 00:16:48,360
bills

498
00:16:48,360 --> 00:16:49,860
um we should do what they say so they

499
00:16:49,860 --> 00:16:51,899
made RDP access publicly available on

500
00:16:51,899 --> 00:16:54,000
this particular system this system was

501
00:16:54,000 --> 00:16:58,980
also vulnerable to Eternal blue uh and

502
00:16:58,980 --> 00:17:01,079
what happened was that we didn't find

503
00:17:01,079 --> 00:17:02,399
any evidence that that vulnerability

504
00:17:02,399 --> 00:17:04,500
been exploited because it usually is a

505
00:17:04,500 --> 00:17:07,199
very unstable exploit and sometimes you

506
00:17:07,199 --> 00:17:08,819
do see a lot of noise in the event logs

507
00:17:08,819 --> 00:17:10,439
we didn't see evidence of it even though

508
00:17:10,439 --> 00:17:13,140
it was vulnerable to it but the most

509
00:17:13,140 --> 00:17:15,240
likely path was through RDP Brute Force

510
00:17:15,240 --> 00:17:17,400
so we're simply using and the IP

511
00:17:17,400 --> 00:17:19,919
addresses and everything the passwords

512
00:17:19,919 --> 00:17:21,599
anything that was related to the victim

513
00:17:21,599 --> 00:17:24,000
I have anonymized and simplified so what

514
00:17:24,000 --> 00:17:25,859
you see in the demo is not the actual

515
00:17:25,859 --> 00:17:27,959
passwords that was used in the victim

516
00:17:27,959 --> 00:17:30,480
I've simplified them but they were

517
00:17:30,480 --> 00:17:31,860
crackable because they were human

518
00:17:31,860 --> 00:17:34,020
created passwords so simply using

519
00:17:34,020 --> 00:17:35,400
something like crowbar what you see here

520
00:17:35,400 --> 00:17:38,640
is krillbar basically targeting using

521
00:17:38,640 --> 00:17:40,740
RDP it's targeting particular server

522
00:17:40,740 --> 00:17:42,360
we've already enumerated and done

523
00:17:42,360 --> 00:17:44,460
reconnaissance to get the username and

524
00:17:44,460 --> 00:17:46,020
we've basically created a word list of

525
00:17:46,020 --> 00:17:47,640
potential passwords that this person has

526
00:17:47,640 --> 00:17:49,320
created we're only going to get previous

527
00:17:49,320 --> 00:17:51,900
password disclosures we're looking at

528
00:17:51,900 --> 00:17:53,400
basically their social media footprint

529
00:17:53,400 --> 00:17:55,380
to create word lists and then create a

530
00:17:55,380 --> 00:17:57,600
very intelligent very large password

531
00:17:57,600 --> 00:18:00,900
word list and I'll be running this I've

532
00:18:00,900 --> 00:18:02,760
selected one thread you can select

533
00:18:02,760 --> 00:18:04,200
multiple threads but simply you can see

534
00:18:04,200 --> 00:18:06,240
here after a period of time I've got a

535
00:18:06,240 --> 00:18:07,980
successful login so that's what we

536
00:18:07,980 --> 00:18:09,720
believe happened that seven months prior

537
00:18:09,720 --> 00:18:11,100
and then nothing happened for three

538
00:18:11,100 --> 00:18:12,360
months

539
00:18:12,360 --> 00:18:13,919
three months later there was another

540
00:18:13,919 --> 00:18:15,840
successful logon

541
00:18:15,840 --> 00:18:17,640
two weeks prior to the Hands-On keyboard

542
00:18:17,640 --> 00:18:20,039
another successful logon all of those

543
00:18:20,039 --> 00:18:21,900
three successful logons come from three

544
00:18:21,900 --> 00:18:24,440
separate different countries exit nodes

545
00:18:24,440 --> 00:18:27,480
so basically very likely that the

546
00:18:27,480 --> 00:18:29,880
initial access was obtained by an access

547
00:18:29,880 --> 00:18:32,039
broker somebody who specialized in

548
00:18:32,039 --> 00:18:33,539
gaining access to this infrastructure

549
00:18:33,539 --> 00:18:36,120
it's very likely they then sold it in

550
00:18:36,120 --> 00:18:38,460
the dark web to another actor who

551
00:18:38,460 --> 00:18:40,260
basically had also became an affiliate

552
00:18:40,260 --> 00:18:43,500
of crylock ransomware creators and also

553
00:18:43,500 --> 00:18:45,660
purchased the credentials and were able

554
00:18:45,660 --> 00:18:47,820
to then use that to gain access Next

555
00:18:47,820 --> 00:18:49,559
Step the attacker did was basically do

556
00:18:49,559 --> 00:18:52,559
an RDP to this target system so now with

557
00:18:52,559 --> 00:18:54,780
those credentials that they've purchased

558
00:18:54,780 --> 00:18:56,280
and knowing that this machine is

559
00:18:56,280 --> 00:18:58,140
publicly available probably using things

560
00:18:58,140 --> 00:19:00,059
like showdown in order to gain access

561
00:19:00,059 --> 00:19:02,760
they log in now they've got a foothold

562
00:19:02,760 --> 00:19:04,919
in the infrastructure so let me take you

563
00:19:04,919 --> 00:19:06,240
through basically the steps that

564
00:19:06,240 --> 00:19:08,700
actually attackers did now unfortunately

565
00:19:08,700 --> 00:19:10,740
what employees do to make their life

566
00:19:10,740 --> 00:19:13,799
easier I am not kidding you on the

567
00:19:13,799 --> 00:19:15,900
desktop there was a file exactly like

568
00:19:15,900 --> 00:19:18,360
this called important stuff exactly

569
00:19:18,360 --> 00:19:20,220
named important stuff and when you open

570
00:19:20,220 --> 00:19:22,440
that file they actually accountant had

571
00:19:22,440 --> 00:19:24,000
actually put all the credentials off the

572
00:19:24,000 --> 00:19:26,640
database and the financial systems in

573
00:19:26,640 --> 00:19:27,960
the cloud

574
00:19:27,960 --> 00:19:30,660
um on here making it easy for basically

575
00:19:30,660 --> 00:19:32,220
them to see and start looking at

576
00:19:32,220 --> 00:19:34,500
numerating further another thing that

577
00:19:34,500 --> 00:19:36,720
was unfortunately on the system was what

578
00:19:36,720 --> 00:19:38,580
do browsers love what is the browser's

579
00:19:38,580 --> 00:19:40,220
love apart from cookies

580
00:19:40,220 --> 00:19:42,960
they love passwords when you go to a

581
00:19:42,960 --> 00:19:45,419
website the browser says hey you know so

582
00:19:45,419 --> 00:19:46,799
you don't have to remember this in the

583
00:19:46,799 --> 00:19:49,140
future we will save it for you isn't

584
00:19:49,140 --> 00:19:51,000
that really cool but unfortunately what

585
00:19:51,000 --> 00:19:53,280
the browsers not have by default

586
00:19:53,280 --> 00:19:55,620
securely enabled so simply the attacker

587
00:19:55,620 --> 00:19:57,480
can I go click on passwords and

588
00:19:57,480 --> 00:19:59,340
ultimately for this victim they also use

589
00:19:59,340 --> 00:20:01,200
this machine to browse other things that

590
00:20:01,200 --> 00:20:02,640
they may have not been able to do from

591
00:20:02,640 --> 00:20:04,200
their own machine because it was managed

592
00:20:04,200 --> 00:20:06,960
or restricted browser and they would you

593
00:20:06,960 --> 00:20:08,400
know some cases installed another

594
00:20:08,400 --> 00:20:10,980
browser to bypass that but browsers love

595
00:20:10,980 --> 00:20:12,419
passwords

596
00:20:12,419 --> 00:20:14,039
and they want to store them and enforce

597
00:20:14,039 --> 00:20:15,360
it by default

598
00:20:15,360 --> 00:20:17,340
the attacker when they gain access to

599
00:20:17,340 --> 00:20:19,740
the system now they can actually move to

600
00:20:19,740 --> 00:20:22,200
that employee's cloud email to their

601
00:20:22,200 --> 00:20:24,240
file system to other things that simply

602
00:20:24,240 --> 00:20:26,400
is only protected with a password so

603
00:20:26,400 --> 00:20:27,900
this is some of the things the attackers

604
00:20:27,900 --> 00:20:28,679
did

605
00:20:28,679 --> 00:20:31,440
the next stage the attacker did was then

606
00:20:31,440 --> 00:20:33,360
starting to understand more about the

607
00:20:33,360 --> 00:20:34,919
user that they're on the system

608
00:20:34,919 --> 00:20:37,140
and the next step was just simply going

609
00:20:37,140 --> 00:20:39,960
that user okay who else is on the

610
00:20:39,960 --> 00:20:41,400
machine I can see different

611
00:20:41,400 --> 00:20:43,679
administrators they can then do local

612
00:20:43,679 --> 00:20:45,720
group and see what type of privileges I

613
00:20:45,720 --> 00:20:49,200
have and unfortunately

614
00:20:49,200 --> 00:20:52,020
this user was a local administrator

615
00:20:52,020 --> 00:20:53,760
so now the attacker has the ability to

616
00:20:53,760 --> 00:20:55,260
make configuration changes to this

617
00:20:55,260 --> 00:20:57,179
machine they have the ability to change

618
00:20:57,179 --> 00:20:58,500
the state

619
00:20:58,500 --> 00:21:00,659
now most organizations Unfortunately

620
00:21:00,659 --> 00:21:03,000
they think that it's a local Minister

621
00:21:03,000 --> 00:21:04,320
yeah

622
00:21:04,320 --> 00:21:06,299
it can only do damage to this machine it

623
00:21:06,299 --> 00:21:08,220
can't harm our infrastructure it's just

624
00:21:08,220 --> 00:21:10,080
local it's administrator they can

625
00:21:10,080 --> 00:21:11,280
actually do bad means to this machine

626
00:21:11,280 --> 00:21:13,860
but nowhere else that's a false sense of

627
00:21:13,860 --> 00:21:15,659
security just because it's called local

628
00:21:15,659 --> 00:21:17,400
doesn't mean that it can't actually

629
00:21:17,400 --> 00:21:19,380
expand and be able to elevate and gain

630
00:21:19,380 --> 00:21:21,360
other privileges

631
00:21:21,360 --> 00:21:23,700
it's only two steps from having local

632
00:21:23,700 --> 00:21:25,080
Minister rights to getting up to full

633
00:21:25,080 --> 00:21:27,240
domain and this attacker knew those

634
00:21:27,240 --> 00:21:29,520
steps very easily so what they'd end up

635
00:21:29,520 --> 00:21:30,360
doing

636
00:21:30,360 --> 00:21:31,740
okay now they know the local

637
00:21:31,740 --> 00:21:34,500
administrator so on their attack machine

638
00:21:34,500 --> 00:21:36,960
they set up a web server and the web

639
00:21:36,960 --> 00:21:39,840
server had a series of different uh

640
00:21:39,840 --> 00:21:42,240
downloads the and of course this was

641
00:21:42,240 --> 00:21:44,460
available from the cloud

642
00:21:44,460 --> 00:21:47,400
and what they'll simply then do is go to

643
00:21:47,400 --> 00:21:49,320
this IP

644
00:21:49,320 --> 00:21:51,360
and

645
00:21:51,360 --> 00:21:53,100
we'll be mainly available is this

646
00:21:53,100 --> 00:21:56,520
structure sorry for those in the back uh

647
00:21:56,520 --> 00:22:00,980
let me see if I can zoom in here for you

648
00:22:02,400 --> 00:22:04,260
or zoom out a little bit too much okay

649
00:22:04,260 --> 00:22:08,340
so what they've done was a b c d e f and

650
00:22:08,340 --> 00:22:10,020
so forth and then they have the scan and

651
00:22:10,020 --> 00:22:11,280
then hit zap

652
00:22:11,280 --> 00:22:14,580
now a was the first file LED download

653
00:22:14,580 --> 00:22:15,720
it's the first thing that they'll

654
00:22:15,720 --> 00:22:18,000
download and what a was basically some

655
00:22:18,000 --> 00:22:20,880
enumeration scanning on the system the

656
00:22:20,880 --> 00:22:22,860
places that they actually placed these

657
00:22:22,860 --> 00:22:24,419
downloads was in a couple of locations

658
00:22:24,419 --> 00:22:26,400
one was on the C drive and it was

659
00:22:26,400 --> 00:22:28,679
actually in a folder called Intel and in

660
00:22:28,679 --> 00:22:30,780
here there was enumeration scripts all

661
00:22:30,780 --> 00:22:32,460
the locations were in user profiles

662
00:22:32,460 --> 00:22:34,559
things like videos pictures and so forth

663
00:22:34,559 --> 00:22:37,080
now in the enumeration here you'll see

664
00:22:37,080 --> 00:22:39,179
that the first thing that a was simply

665
00:22:39,179 --> 00:22:40,679
automation

666
00:22:40,679 --> 00:22:43,799
a was simply just the automation of this

667
00:22:43,799 --> 00:22:45,960
system and in the automation they had

668
00:22:45,960 --> 00:22:48,179
things like disable security so knowing

669
00:22:48,179 --> 00:22:49,980
that I'm now a local minister in the

670
00:22:49,980 --> 00:22:51,780
system one of the things they can now do

671
00:22:51,780 --> 00:22:53,640
is basically just to show you the script

672
00:22:53,640 --> 00:22:54,720
itself

673
00:22:54,720 --> 00:22:56,520
this would actually go and disable any

674
00:22:56,520 --> 00:22:57,840
of the security that was on the system

675
00:22:57,840 --> 00:22:58,980
itself

676
00:22:58,980 --> 00:23:00,780
and the sessions lasted somewhere

677
00:23:00,780 --> 00:23:02,940
between four minutes most sessions were

678
00:23:02,940 --> 00:23:04,679
four minutes long others were eight

679
00:23:04,679 --> 00:23:07,320
minutes no longer and the purpose of

680
00:23:07,320 --> 00:23:09,659
them being this long was that in Windows

681
00:23:09,659 --> 00:23:12,179
Defender has a auto healing as a protect

682
00:23:12,179 --> 00:23:14,400
the service so when it's off for a

683
00:23:14,400 --> 00:23:15,900
certain amount of time it will actually

684
00:23:15,900 --> 00:23:18,059
restart but those sessions were shorter

685
00:23:18,059 --> 00:23:19,740
than that window so they could actually

686
00:23:19,740 --> 00:23:21,299
stay hidden they could actually do the

687
00:23:21,299 --> 00:23:23,760
malicious activity within that state

688
00:23:23,760 --> 00:23:25,679
so this would be the ability to disable

689
00:23:25,679 --> 00:23:27,539
the security the next thing they would

690
00:23:27,539 --> 00:23:28,860
end up doing is then running the

691
00:23:28,860 --> 00:23:30,659
downloader and the downloader then would

692
00:23:30,659 --> 00:23:32,580
actually go off to that site again and

693
00:23:32,580 --> 00:23:36,419
then download B C D and from that within

694
00:23:36,419 --> 00:23:39,299
c b c and d was the malicious scripts

695
00:23:39,299 --> 00:23:40,799
and malicious Tools in order for the

696
00:23:40,799 --> 00:23:42,059
further numeration because knowledge

697
00:23:42,059 --> 00:23:44,039
security is disabled in the system it's

698
00:23:44,039 --> 00:23:45,960
not going to detect anything that they

699
00:23:45,960 --> 00:23:48,840
download and execute from that point

700
00:23:48,840 --> 00:23:50,400
um the first couple of sessions they

701
00:23:50,400 --> 00:23:52,559
didn't do any back doors but later they

702
00:23:52,559 --> 00:23:55,020
decided to add some users so about a

703
00:23:55,020 --> 00:23:57,120
week into the attack they went and added

704
00:23:57,120 --> 00:23:59,460
the user and added that user to the

705
00:23:59,460 --> 00:24:00,480
actually administrator and remote

706
00:24:00,480 --> 00:24:02,580
desktop users we believe the purpose was

707
00:24:02,580 --> 00:24:04,380
that they were afraid of losing access

708
00:24:04,380 --> 00:24:05,820
and were afraid of the user may be

709
00:24:05,820 --> 00:24:07,679
changing their password and therefore

710
00:24:07,679 --> 00:24:09,600
limiting that access so they created a

711
00:24:09,600 --> 00:24:11,580
back door another backdoor that they

712
00:24:11,580 --> 00:24:13,860
also used which is still ironic today

713
00:24:13,860 --> 00:24:16,140
that has still been used is sticky keys

714
00:24:16,140 --> 00:24:17,940
so sticky keys is the ability to

715
00:24:17,940 --> 00:24:19,559
actually go and change in the utility

716
00:24:19,559 --> 00:24:21,900
Helper and molgun screen that when you

717
00:24:21,900 --> 00:24:23,220
click in it it will actually open up a

718
00:24:23,220 --> 00:24:25,860
full command prompt and have full NTS

719
00:24:25,860 --> 00:24:28,440
system Authority access so you can go if

720
00:24:28,440 --> 00:24:30,419
you ever lose access this is your quick

721
00:24:30,419 --> 00:24:32,700
access to go and create another user and

722
00:24:32,700 --> 00:24:34,740
regain access to the machine so another

723
00:24:34,740 --> 00:24:36,360
interesting technique that was used in

724
00:24:36,360 --> 00:24:38,220
order to create great persistence so

725
00:24:38,220 --> 00:24:39,900
once they had went through and did all

726
00:24:39,900 --> 00:24:41,940
of these basically it also run fine

727
00:24:41,940 --> 00:24:43,500
passwords to see if there's passwords

728
00:24:43,500 --> 00:24:45,620
kept in the registry in the file system

729
00:24:45,620 --> 00:24:48,360
and at that point in time they would end

730
00:24:48,360 --> 00:24:49,919
up going and downloading the B file

731
00:24:49,919 --> 00:24:52,799
which contained memicats so mimikats now

732
00:24:52,799 --> 00:24:53,880
they have the ability to go and check

733
00:24:53,880 --> 00:24:55,440
and see is there any passwords and clear

734
00:24:55,440 --> 00:24:58,260
texts so remember four minutes

735
00:24:58,260 --> 00:25:00,120
disabling security

736
00:25:00,120 --> 00:25:02,100
downloading the Malaysia's files and now

737
00:25:02,100 --> 00:25:03,600
basically making configuration changes

738
00:25:03,600 --> 00:25:05,460
the system the first thing and these

739
00:25:05,460 --> 00:25:07,080
this is the exact same scripts that was

740
00:25:07,080 --> 00:25:09,299
used in the attack so first thing is of

741
00:25:09,299 --> 00:25:12,360
course the windows 12 sp1 there was a

742
00:25:12,360 --> 00:25:13,880
change made that

743
00:25:13,880 --> 00:25:15,779
passwords are not stored in clear text

744
00:25:15,779 --> 00:25:18,360
but with a simple registry change as a

745
00:25:18,360 --> 00:25:20,159
local administrator user you can reverse

746
00:25:20,159 --> 00:25:22,080
that change and unfortunately this

747
00:25:22,080 --> 00:25:24,179
change will be persistent

748
00:25:24,179 --> 00:25:26,520
um that now with this change anyone who

749
00:25:26,520 --> 00:25:28,320
logs in after adding this to the

750
00:25:28,320 --> 00:25:30,179
registry they will actually be able to

751
00:25:30,179 --> 00:25:31,620
then detect the passwords and clear text

752
00:25:31,620 --> 00:25:33,659
post this point in time

753
00:25:33,659 --> 00:25:34,799
so

754
00:25:34,799 --> 00:25:37,260
once they've done that they will also

755
00:25:37,260 --> 00:25:39,840
then maybe run a thumbscred and this

756
00:25:39,840 --> 00:25:41,460
basically you'll see here this is the

757
00:25:41,460 --> 00:25:43,860
exact script this dumps guys and also

758
00:25:43,860 --> 00:25:45,120
the reason why they've got some of those

759
00:25:45,120 --> 00:25:47,460
color coordination in the top there is

760
00:25:47,460 --> 00:25:49,559
that they can also pass parameters from

761
00:25:49,559 --> 00:25:51,480
another tool as well but you can see

762
00:25:51,480 --> 00:25:53,460
here simply the protect the processor I

763
00:25:53,460 --> 00:25:55,400
also they wanted to make it look pretty

764
00:25:55,400 --> 00:25:57,779
by changing the color to something that

765
00:25:57,779 --> 00:25:59,460
was something that they you know and

766
00:25:59,460 --> 00:26:03,000
they also changed the title as well but

767
00:26:03,000 --> 00:26:05,159
they will actually run the right version

768
00:26:05,159 --> 00:26:07,559
of mimikats for this particular system

769
00:26:07,559 --> 00:26:09,480
now once they had basically get the dump

770
00:26:09,480 --> 00:26:10,919
and they realized that of course at that

771
00:26:10,919 --> 00:26:13,080
first time they do this there's no real

772
00:26:13,080 --> 00:26:14,940
passwords other than the credential I'm

773
00:26:14,940 --> 00:26:17,220
logged in as so they will come back to

774
00:26:17,220 --> 00:26:18,840
the numeration once they've made that

775
00:26:18,840 --> 00:26:20,159
change they go back from the Automation

776
00:26:20,159 --> 00:26:21,840
and they run a clean script the clean

777
00:26:21,840 --> 00:26:23,659
script will remove all of those files

778
00:26:23,659 --> 00:26:26,279
memicats all of the changes and also

779
00:26:26,279 --> 00:26:27,840
delete the last couple of minutes in the

780
00:26:27,840 --> 00:26:31,260
log files so from a end user or system

781
00:26:31,260 --> 00:26:33,179
administrator perspective when you look

782
00:26:33,179 --> 00:26:34,820
at this it just looks at this machine

783
00:26:34,820 --> 00:26:37,200
rebooted or was offline for four minutes

784
00:26:37,200 --> 00:26:39,779
and if you look at your AV dashboards

785
00:26:39,779 --> 00:26:40,919
you'll see that there's a communication

786
00:26:40,919 --> 00:26:42,840
missed for maybe a few minutes and most

787
00:26:42,840 --> 00:26:44,940
people will just ignore that most assist

788
00:26:44,940 --> 00:26:46,919
administrators will just decide that it

789
00:26:46,919 --> 00:26:49,020
was a blip maybe a network failure maybe

790
00:26:49,020 --> 00:26:50,520
something happened

791
00:26:50,520 --> 00:26:52,080
every four minutes it looks like

792
00:26:52,080 --> 00:26:53,820
everything's back online now it looks

793
00:26:53,820 --> 00:26:56,159
okay but the attackers made some little

794
00:26:56,159 --> 00:26:58,679
modifications so now what they've been

795
00:26:58,679 --> 00:27:00,299
able to do is they've done further

796
00:27:00,299 --> 00:27:02,100
enumeration and unfortunately for this

797
00:27:02,100 --> 00:27:03,779
organization this was an accountant's

798
00:27:03,779 --> 00:27:04,500
machine that was running Financial

799
00:27:04,500 --> 00:27:06,659
database that actually for that

800
00:27:06,659 --> 00:27:08,400
accountant to make financial statements

801
00:27:08,400 --> 00:27:11,580
for the organization now within that the

802
00:27:11,580 --> 00:27:13,919
IT team we're actually taking a backup

803
00:27:13,919 --> 00:27:16,020
of that database

804
00:27:16,020 --> 00:27:18,179
and they had a script running they had

805
00:27:18,179 --> 00:27:20,399
PS exact running in the background open

806
00:27:20,399 --> 00:27:23,399
up a connection copy the database down

807
00:27:23,399 --> 00:27:25,679
to a local system to back that database

808
00:27:25,679 --> 00:27:28,740
up and fortunately the credentials of

809
00:27:28,740 --> 00:27:31,200
that PS exec script were a domain

810
00:27:31,200 --> 00:27:33,419
administrator

811
00:27:33,419 --> 00:27:35,580
now the series was the attacker only

812
00:27:35,580 --> 00:27:37,440
needed to wait a period of time now

813
00:27:37,440 --> 00:27:38,580
what's also interesting in this

814
00:27:38,580 --> 00:27:40,740
particular case as well the attackers

815
00:27:40,740 --> 00:27:42,899
also had downloaded gmr and I was

816
00:27:42,899 --> 00:27:44,279
confused I was going why are they using

817
00:27:44,279 --> 00:27:46,620
gmr because we use it as Defenders we

818
00:27:46,620 --> 00:27:48,480
use it in order to detect root kits in

819
00:27:48,480 --> 00:27:49,919
order to detect things like filter

820
00:27:49,919 --> 00:27:51,720
drivers and mini-filter drivers that's

821
00:27:51,720 --> 00:27:53,159
communicating with the kernel to

822
00:27:53,159 --> 00:27:55,500
understand about you know what maybe

823
00:27:55,500 --> 00:27:57,600
there's back doors in place the

824
00:27:57,600 --> 00:27:59,580
attackers are using it for to find out

825
00:27:59,580 --> 00:28:02,159
what AV and anti-malware software is

826
00:28:02,159 --> 00:28:03,480
running in the background that they may

827
00:28:03,480 --> 00:28:04,919
not see in the system trade they might

828
00:28:04,919 --> 00:28:06,480
not see on the interface they're running

829
00:28:06,480 --> 00:28:08,520
it to see what tools we're using in

830
00:28:08,520 --> 00:28:10,799
order to evade detection after doing a

831
00:28:10,799 --> 00:28:12,299
numeration in the system the attackers

832
00:28:12,299 --> 00:28:14,760
had enough knowledge crylock was not the

833
00:28:14,760 --> 00:28:16,580
only variant that ransomware they had to

834
00:28:16,580 --> 00:28:19,740
disposed basically to use they had five

835
00:28:19,740 --> 00:28:21,539
other versions of ransomware that they

836
00:28:21,539 --> 00:28:23,340
could have chosen from they chose

837
00:28:23,340 --> 00:28:25,740
crylock because of the security controls

838
00:28:25,740 --> 00:28:26,760
and everything that was in place in

839
00:28:26,760 --> 00:28:28,440
these systems they knew would not be

840
00:28:28,440 --> 00:28:30,299
detected they needed to execute

841
00:28:30,299 --> 00:28:32,399
successfully whether the defense has

842
00:28:32,399 --> 00:28:33,899
been able to stop it

843
00:28:33,899 --> 00:28:35,700
when I actually ran the first time when

844
00:28:35,700 --> 00:28:37,080
I got a hold of this particular version

845
00:28:37,080 --> 00:28:39,480
I ran in virus total I ran it in Joe's

846
00:28:39,480 --> 00:28:41,580
sandbox I actually did Dynamic analysis

847
00:28:41,580 --> 00:28:43,980
and virus total only three antivirus

848
00:28:43,980 --> 00:28:46,320
vendors detected it three

849
00:28:46,320 --> 00:28:49,320
at that time of running it

850
00:28:49,320 --> 00:28:51,179
so this organization did have defense in

851
00:28:51,179 --> 00:28:52,799
place and just unfortunately the

852
00:28:52,799 --> 00:28:54,240
attackers are looking at ways in order

853
00:28:54,240 --> 00:28:57,240
to get and move around it so a few days

854
00:28:57,240 --> 00:28:59,940
later backup script runs attackers come

855
00:28:59,940 --> 00:29:00,960
back in

856
00:29:00,960 --> 00:29:03,419
they go in again they run the disabled

857
00:29:03,419 --> 00:29:06,000
security they check their back doors

858
00:29:06,000 --> 00:29:08,520
they come back in they run memicats

859
00:29:08,520 --> 00:29:11,580
they dump the credentials opening up and

860
00:29:11,580 --> 00:29:13,860
after running this quite a few times

861
00:29:13,860 --> 00:29:15,539
it's only a matter of time before that

862
00:29:15,539 --> 00:29:17,760
backup script that runs

863
00:29:17,760 --> 00:29:21,740
you can see eventually at some point

864
00:29:22,380 --> 00:29:25,220
you'll see here

865
00:29:26,580 --> 00:29:27,899
even though I've basically been able to

866
00:29:27,899 --> 00:29:30,240
get that's not the right one

867
00:29:30,240 --> 00:29:32,159
here

868
00:29:32,159 --> 00:29:33,960
domain administrator account coming from

869
00:29:33,960 --> 00:29:35,520
PS exact that their team is using

870
00:29:35,520 --> 00:29:36,720
themselves

871
00:29:36,720 --> 00:29:38,940
in order to do systems management for

872
00:29:38,940 --> 00:29:41,100
this environment to take backups so now

873
00:29:41,100 --> 00:29:42,899
the attacker has knowledge of the

874
00:29:42,899 --> 00:29:44,640
credentials for domain controller they

875
00:29:44,640 --> 00:29:46,080
move to the next stage and fortunately

876
00:29:46,080 --> 00:29:47,399
at that point in time

877
00:29:47,399 --> 00:29:49,320
you're talking about hours before you

878
00:29:49,320 --> 00:29:52,320
become a ransomware victim it's hours at

879
00:29:52,320 --> 00:29:54,779
that stage once they have the access

880
00:29:54,779 --> 00:29:56,700
so the next thing they'll do is they'll

881
00:29:56,700 --> 00:29:58,320
go when they run a scanner now the

882
00:29:58,320 --> 00:29:59,760
scanner was used in this particular case

883
00:29:59,760 --> 00:30:01,679
was net scanner from self-perfect it's

884
00:30:01,679 --> 00:30:02,820
great for using it for system

885
00:30:02,820 --> 00:30:04,320
administrators for small business in

886
00:30:04,320 --> 00:30:06,120
order to manage the environment

887
00:30:06,120 --> 00:30:08,279
and ultimately here they were able to

888
00:30:08,279 --> 00:30:09,899
scan the environment and unfortunately

889
00:30:09,899 --> 00:30:11,580
for most organizations what do they do

890
00:30:11,580 --> 00:30:13,919
what what do they name their servers the

891
00:30:13,919 --> 00:30:17,520
backup server Erp system SQL we name it

892
00:30:17,520 --> 00:30:19,380
so that we can easily understand what

893
00:30:19,380 --> 00:30:20,820
it's doing in the business and

894
00:30:20,820 --> 00:30:21,960
unfortunately for the attackers it's

895
00:30:21,960 --> 00:30:23,340
almost like giving them it basically if

896
00:30:23,340 --> 00:30:25,679
you know a complete footprint of the

897
00:30:25,679 --> 00:30:28,399
environment itself

898
00:30:28,620 --> 00:30:31,679
okay scanning's not working but I'll

899
00:30:31,679 --> 00:30:34,080
find a reason uh to figure out but one

900
00:30:34,080 --> 00:30:35,399
of the things was interesting and this

901
00:30:35,399 --> 00:30:37,559
was here is where they set up the

902
00:30:37,559 --> 00:30:39,720
automation this is the program so it's

903
00:30:39,720 --> 00:30:41,220
integration in the scanner so when it

904
00:30:41,220 --> 00:30:42,539
picks up the servers in the environment

905
00:30:42,539 --> 00:30:43,860
they can simply right click and run

906
00:30:43,860 --> 00:30:46,679
these this was the first evidence that

907
00:30:46,679 --> 00:30:48,360
the actually attackers for Russian

908
00:30:48,360 --> 00:30:49,380
speaking

909
00:30:49,380 --> 00:30:51,659
from Russian origin and now it's not to

910
00:30:51,659 --> 00:30:52,799
say there were Russian citizens or

911
00:30:52,799 --> 00:30:55,020
Russian Nationals it just means that

912
00:30:55,020 --> 00:30:56,940
here it was actually an acrylic language

913
00:30:56,940 --> 00:30:58,740
which meant that basically they were

914
00:30:58,740 --> 00:31:00,720
Russian speaking there's some

915
00:31:00,720 --> 00:31:02,340
indications of attribution which I can't

916
00:31:02,340 --> 00:31:04,860
disclose but were that potentially came

917
00:31:04,860 --> 00:31:07,019
from but this was the first indication

918
00:31:07,019 --> 00:31:10,019
that we find evidence of attribution in

919
00:31:10,019 --> 00:31:12,360
this location from the acrylic language

920
00:31:12,360 --> 00:31:14,820
been used in this particular tool the

921
00:31:14,820 --> 00:31:17,519
next stage of course was to run some of

922
00:31:17,519 --> 00:31:19,140
those scripts to create basically

923
00:31:19,140 --> 00:31:21,120
download staging machines and staging

924
00:31:21,120 --> 00:31:23,460
files onto other machines ultimately

925
00:31:23,460 --> 00:31:25,260
then do an RDP

926
00:31:25,260 --> 00:31:28,260
and it was moments after

927
00:31:28,260 --> 00:31:31,019
logging into the main controller a few

928
00:31:31,019 --> 00:31:32,700
about two hours after doing this point

929
00:31:32,700 --> 00:31:35,399
was when the ransomware was deployed and

930
00:31:35,399 --> 00:31:37,019
took out the entire business

931
00:31:37,019 --> 00:31:38,940
so these are the steps and techniques

932
00:31:38,940 --> 00:31:40,740
that attackers have used and that's what

933
00:31:40,740 --> 00:31:42,600
we're here sometimes to kind of reverse

934
00:31:42,600 --> 00:31:43,980
that and look at the evidence look at

935
00:31:43,980 --> 00:31:46,200
the how they get it got in what evidence

936
00:31:46,200 --> 00:31:48,720
was remaining so some of the areas once

937
00:31:48,720 --> 00:31:50,279
they have the access and they go through

938
00:31:50,279 --> 00:31:52,140
they can simply now go back and do

939
00:31:52,140 --> 00:31:55,019
things like PS exec from Impact it you

940
00:31:55,019 --> 00:31:56,100
can go and basically know you've got

941
00:31:56,100 --> 00:31:58,019
credentials I can simply use a command

942
00:31:58,019 --> 00:31:59,460
line just like the backup script does

943
00:31:59,460 --> 00:32:02,220
and now I've got access to the victim

944
00:32:02,220 --> 00:32:03,600
staging machines

945
00:32:03,600 --> 00:32:05,640
I can also use evil win or M with the

946
00:32:05,640 --> 00:32:07,620
past the heist method and go and simply

947
00:32:07,620 --> 00:32:11,580
Target the domain controller now if even

948
00:32:11,580 --> 00:32:13,200
um the you know I don't have the

949
00:32:13,200 --> 00:32:15,299
password itself I just have the hash I

950
00:32:15,299 --> 00:32:17,580
can simply log in and now I've got full

951
00:32:17,580 --> 00:32:20,519
access to the main controller

952
00:32:20,519 --> 00:32:22,320
as that user

953
00:32:22,320 --> 00:32:23,700
all the techniques the attackers are

954
00:32:23,700 --> 00:32:26,000
using

955
00:32:26,820 --> 00:32:28,679
so going through this what things can we

956
00:32:28,679 --> 00:32:30,720
do to reduce the risks how can we start

957
00:32:30,720 --> 00:32:32,399
reducing these types of attacks from

958
00:32:32,399 --> 00:32:33,840
happening and it's about it's all

959
00:32:33,840 --> 00:32:35,399
working together it's all of us using

960
00:32:35,399 --> 00:32:36,840
our knowledge and finding ways in order

961
00:32:36,840 --> 00:32:39,179
to make my job is always to make the

962
00:32:39,179 --> 00:32:41,159
attacker's job more difficult to force

963
00:32:41,159 --> 00:32:43,380
them to create more noise to force them

964
00:32:43,380 --> 00:32:45,779
to take more risks in the business and

965
00:32:45,779 --> 00:32:47,519
giving the Defenders a chance at seeing

966
00:32:47,519 --> 00:32:49,019
those ripples in the water seeing those

967
00:32:49,019 --> 00:32:50,580
techniques being used in order to

968
00:32:50,580 --> 00:32:52,140
prevent the attack from happening or to

969
00:32:52,140 --> 00:32:54,779
stop it in mid attack but we what things

970
00:32:54,779 --> 00:32:57,779
we can do from these lessons good cyber

971
00:32:57,779 --> 00:32:59,820
education and knowledge and awareness

972
00:32:59,820 --> 00:33:01,919
for the team not just for the I.T team

973
00:33:01,919 --> 00:33:03,299
and security team but also across the

974
00:33:03,299 --> 00:33:05,480
business

975
00:33:05,940 --> 00:33:07,980
make security usable

976
00:33:07,980 --> 00:33:10,679
make it so people want to use it

977
00:33:10,679 --> 00:33:13,019
and also the backup itself the

978
00:33:13,019 --> 00:33:14,399
organization learned a very important

979
00:33:14,399 --> 00:33:18,000
lesson that the backup itself was a

980
00:33:18,000 --> 00:33:19,799
protection against data corruption or

981
00:33:19,799 --> 00:33:21,480
Hardware failure but not tailored to

982
00:33:21,480 --> 00:33:22,679
ransomware

983
00:33:22,679 --> 00:33:24,840
and organizations need to revise review

984
00:33:24,840 --> 00:33:26,279
their backups and make sure that they

985
00:33:26,279 --> 00:33:28,320
actually have a backup and plan in place

986
00:33:28,320 --> 00:33:31,559
that actually considers ransomware types

987
00:33:31,559 --> 00:33:32,640
of attacks

988
00:33:32,640 --> 00:33:34,860
practice the prince of least privilege

989
00:33:34,860 --> 00:33:37,140
make sure that basically the credentials

990
00:33:37,140 --> 00:33:38,519
of user they're not being local

991
00:33:38,519 --> 00:33:40,019
administrator user they're not over

992
00:33:40,019 --> 00:33:42,480
privileged users you're not using domain

993
00:33:42,480 --> 00:33:44,460
accounts domain administer accounts and

994
00:33:44,460 --> 00:33:46,260
backup scripts that you've got scripts

995
00:33:46,260 --> 00:33:48,480
to prevent lateral moves that after that

996
00:33:48,480 --> 00:33:50,700
you rotate the credentials so even I was

997
00:33:50,700 --> 00:33:53,159
able to obtain the hash I can't reuse

998
00:33:53,159 --> 00:33:54,419
that hash to move around the network

999
00:33:54,419 --> 00:33:56,640
using privilege access management Tools

1000
00:33:56,640 --> 00:33:58,620
in order to rotate credentials make sure

1001
00:33:58,620 --> 00:34:01,019
they're not human created credentials

1002
00:34:01,019 --> 00:34:03,120
controlling applications

1003
00:34:03,120 --> 00:34:05,159
a lot of the applications used here were

1004
00:34:05,159 --> 00:34:06,720
used for basically you know attackers

1005
00:34:06,720 --> 00:34:08,099
were pretty much living off the land

1006
00:34:08,099 --> 00:34:10,020
living off what they were able to find

1007
00:34:10,020 --> 00:34:12,060
but making sure when things are running

1008
00:34:12,060 --> 00:34:13,918
for example on a Sunday morning or

1009
00:34:13,918 --> 00:34:15,960
Saturday night being able to detect the

1010
00:34:15,960 --> 00:34:17,699
difference between that being run by a

1011
00:34:17,699 --> 00:34:19,379
malicious attacker and something that's

1012
00:34:19,379 --> 00:34:22,079
run on a Tuesday afternoon by an

1013
00:34:22,079 --> 00:34:24,000
authorized employee being able to

1014
00:34:24,000 --> 00:34:25,560
determine the difference control

1015
00:34:25,560 --> 00:34:27,659
applications make sure you actually have

1016
00:34:27,659 --> 00:34:29,339
a behavior and understanding about when

1017
00:34:29,339 --> 00:34:31,440
they run and maybe out of hours you have

1018
00:34:31,440 --> 00:34:33,359
additional security controls in place

1019
00:34:33,359 --> 00:34:35,579
and just make sure that do the basics of

1020
00:34:35,579 --> 00:34:37,619
patch management and updating security

1021
00:34:37,619 --> 00:34:39,060
ultimately

1022
00:34:39,060 --> 00:34:41,280
my last statement is understanding

1023
00:34:41,280 --> 00:34:43,199
hacker techniques

1024
00:34:43,199 --> 00:34:45,659
is the best way to defend if you know

1025
00:34:45,659 --> 00:34:47,520
the techniques they use we can put the

1026
00:34:47,520 --> 00:34:49,020
right controls in place to make it more

1027
00:34:49,020 --> 00:34:50,760
difficult for them

1028
00:34:50,760 --> 00:34:52,560
but we need to translate that into the

1029
00:34:52,560 --> 00:34:54,418
business

1030
00:34:54,418 --> 00:34:56,699
we can't go to the business and say we

1031
00:34:56,699 --> 00:34:57,780
need to put these in place to stop

1032
00:34:57,780 --> 00:34:59,520
attackers

1033
00:34:59,520 --> 00:35:01,160
we need to translate into business

1034
00:35:01,160 --> 00:35:03,660
basically return on investment in order

1035
00:35:03,660 --> 00:35:05,160
to get the budget in order for us to do

1036
00:35:05,160 --> 00:35:06,359
the things that make attack ourselves

1037
00:35:06,359 --> 00:35:08,520
more difficult at that point of time I

1038
00:35:08,520 --> 00:35:10,560
think my time's up and I would like to

1039
00:35:10,560 --> 00:35:11,820
thank you for being an awesome audience

1040
00:35:11,820 --> 00:35:13,560
and taking time and listening to me

1041
00:35:13,560 --> 00:35:15,900
today if I have some time for one or two

1042
00:35:15,900 --> 00:35:18,220
questions I'll be happy to answer

1043
00:35:18,220 --> 00:35:25,380
[Applause]

1044
00:35:25,380 --> 00:35:27,079
questions

1045
00:35:27,079 --> 00:35:29,460
yes don't forget there's some chocolates

1046
00:35:29,460 --> 00:35:31,859
here I think that uh you will you're

1047
00:35:31,859 --> 00:35:34,520
willing to uh

1048
00:35:34,560 --> 00:35:38,520
so while we have managed to

1049
00:35:38,520 --> 00:35:41,220
oh I can see you now we have managed to

1050
00:35:41,220 --> 00:35:42,780
stay away from ransomware attacks

1051
00:35:42,780 --> 00:35:45,720
virtually 100 of our supplier incidents

1052
00:35:45,720 --> 00:35:48,240
we deal with involve ransomware

1053
00:35:48,240 --> 00:35:50,579
and we ran into a unique situation

1054
00:35:50,579 --> 00:35:52,020
recently I was just going to run a

1055
00:35:52,020 --> 00:35:53,099
passage and see if you've heard of it

1056
00:35:53,099 --> 00:35:54,780
where

1057
00:35:54,780 --> 00:35:57,060
um the supplier was refusing to pay the

1058
00:35:57,060 --> 00:35:58,380
ransom

1059
00:35:58,380 --> 00:36:00,900
so the ransomware attacker fired off

1060
00:36:00,900 --> 00:36:02,960
random emails to some of our employees

1061
00:36:02,960 --> 00:36:06,480
saying we have your data on this

1062
00:36:06,480 --> 00:36:09,480
companies systems they're refusing to

1063
00:36:09,480 --> 00:36:12,119
pay the ransom if you don't twist their

1064
00:36:12,119 --> 00:36:13,680
arm and force them to pay that Ransom

1065
00:36:13,680 --> 00:36:16,079
were going to leak your data have you

1066
00:36:16,079 --> 00:36:17,820
run into those situations absolutely

1067
00:36:17,820 --> 00:36:19,500
I've seen lots of cases similar to that

1068
00:36:19,500 --> 00:36:21,599
in various different ways sometimes it's

1069
00:36:21,599 --> 00:36:22,859
their customers not so much their

1070
00:36:22,859 --> 00:36:25,560
employees sometimes they'll do uh

1071
00:36:25,560 --> 00:36:27,119
threaten to leak the data on the public

1072
00:36:27,119 --> 00:36:28,980
internet that much you might you know

1073
00:36:28,980 --> 00:36:30,839
cause the organization some harm with

1074
00:36:30,839 --> 00:36:34,260
regulatory needs and so forth like gdpr

1075
00:36:34,260 --> 00:36:36,599
um and privacy act so so yes I have seen

1076
00:36:36,599 --> 00:36:38,520
we're seeing ransomer you know even if

1077
00:36:38,520 --> 00:36:40,440
you look at the lapsis group their

1078
00:36:40,440 --> 00:36:42,000
technique was not so much sexually

1079
00:36:42,000 --> 00:36:43,680
locking the systems but it was more

1080
00:36:43,680 --> 00:36:45,240
about stealing data and threatening to

1081
00:36:45,240 --> 00:36:48,420
disclose that data so yes attackers have

1082
00:36:48,420 --> 00:36:50,460
different ways of gaining financial gain

1083
00:36:50,460 --> 00:36:52,920
and some of them might take multiple

1084
00:36:52,920 --> 00:36:55,740
steps whether being threatening and you

1085
00:36:55,740 --> 00:36:58,740
know employees to disclose the data so

1086
00:36:58,740 --> 00:37:00,900
yes that's there's multiple extortion

1087
00:37:00,900 --> 00:37:02,460
techniques that's been used it's not

1088
00:37:02,460 --> 00:37:04,200
just destruction of data and systems

1089
00:37:04,200 --> 00:37:06,480
it's also threatening disclosure and

1090
00:37:06,480 --> 00:37:08,400
other brand damage and financial damage

1091
00:37:08,400 --> 00:37:10,140
that they can do absolutely

1092
00:37:10,140 --> 00:37:12,420
all right uh we have time for one more

1093
00:37:12,420 --> 00:37:14,660
question

1094
00:37:15,060 --> 00:37:17,880
hello yeah hi George kutepas from

1095
00:37:17,880 --> 00:37:19,980
certain U thank you for the brilliant

1096
00:37:19,980 --> 00:37:21,240
talk

1097
00:37:21,240 --> 00:37:24,420
um we we seem to associate ransomware

1098
00:37:24,420 --> 00:37:26,640
attackers with a higher degree of

1099
00:37:26,640 --> 00:37:30,900
automation usually a fishing email the

1100
00:37:30,900 --> 00:37:34,079
victim just clicks on some links or runs

1101
00:37:34,079 --> 00:37:35,820
something that is attached to that email

1102
00:37:35,820 --> 00:37:39,720
and we go from that in your case we see

1103
00:37:39,720 --> 00:37:42,060
the attackers doing some serious let's

1104
00:37:42,060 --> 00:37:46,640
say Hands-On effort and some very deep

1105
00:37:46,640 --> 00:37:49,980
research of the victim was this a

1106
00:37:49,980 --> 00:37:53,220
special case of a threat actor or was it

1107
00:37:53,220 --> 00:37:56,300
a special case of a victim which would

1108
00:37:56,300 --> 00:38:00,359
uh satisfy the need for a higher degree

1109
00:38:00,359 --> 00:38:05,000
of effort due to the expected profit

1110
00:38:05,000 --> 00:38:07,920
what's your take on that so thank you so

1111
00:38:07,920 --> 00:38:09,180
excellent question thank you for for

1112
00:38:09,180 --> 00:38:10,619
asking the question uh from this

1113
00:38:10,619 --> 00:38:12,599
particular you know these attackers made

1114
00:38:12,599 --> 00:38:14,820
lots of mistakes the when you in

1115
00:38:14,820 --> 00:38:16,260
retrospect when you look at the evidence

1116
00:38:16,260 --> 00:38:18,060
remaining that I went through they were

1117
00:38:18,060 --> 00:38:19,920
not quiet most attackers that are more

1118
00:38:19,920 --> 00:38:22,320
sophisticated prefer to stay stealthy

1119
00:38:22,320 --> 00:38:23,940
they made lots of mistakes they made

1120
00:38:23,940 --> 00:38:27,240
lots of uh areas so from my view these

1121
00:38:27,240 --> 00:38:29,099
were script kitties borderline you know

1122
00:38:29,099 --> 00:38:32,220
kind of with a bit more skills so they

1123
00:38:32,220 --> 00:38:34,320
were not very events and going into the

1124
00:38:34,320 --> 00:38:36,060
path where what rather than actually

1125
00:38:36,060 --> 00:38:38,220
doing phishing emails themselves most

1126
00:38:38,220 --> 00:38:39,839
criminal gangs are now starting to just

1127
00:38:39,839 --> 00:38:42,900
go and buy the access directly so they

1128
00:38:42,900 --> 00:38:45,119
don't have to do that stem their special

1129
00:38:45,119 --> 00:38:46,859
access Brokers out there were rather

1130
00:38:46,859 --> 00:38:48,839
than me having to do multiple types of

1131
00:38:48,839 --> 00:38:50,520
Specialties and you know fishing and

1132
00:38:50,520 --> 00:38:52,440
then creating ransomware and then doing

1133
00:38:52,440 --> 00:38:54,720
Hands-On keyboard and gaining uh and

1134
00:38:54,720 --> 00:38:56,220
then also even doing the communication

1135
00:38:56,220 --> 00:38:58,320
in this particular case it was actually

1136
00:38:58,320 --> 00:39:00,780
another group that was actually dealing

1137
00:39:00,780 --> 00:39:01,859
with the communication because the

1138
00:39:01,859 --> 00:39:04,079
attacker native language was not English

1139
00:39:04,079 --> 00:39:05,640
so you're dealing with a series of

1140
00:39:05,640 --> 00:39:07,560
almost like a supply chain of criminal

1141
00:39:07,560 --> 00:39:08,940
activity

1142
00:39:08,940 --> 00:39:10,500
um so yes more attackers are starting to

1143
00:39:10,500 --> 00:39:12,359
rather than try to be specialist in

1144
00:39:12,359 --> 00:39:14,040
everything they would specialize in one

1145
00:39:14,040 --> 00:39:16,140
thing and do that really well and rather

1146
00:39:16,140 --> 00:39:17,400
than doing fishing they'll just buy the

1147
00:39:17,400 --> 00:39:19,740
credentials of an access broker this

1148
00:39:19,740 --> 00:39:21,660
particular organization actually had

1149
00:39:21,660 --> 00:39:23,220
done all the right things they had all

1150
00:39:23,220 --> 00:39:24,599
the right things in place unfortunately

1151
00:39:24,599 --> 00:39:26,220
it was that one employee had a bit of

1152
00:39:26,220 --> 00:39:28,920
power and was able to do Shadow I.T like

1153
00:39:28,920 --> 00:39:31,619
most organizations Shadow I.T is a is a

1154
00:39:31,619 --> 00:39:33,000
very dangerous thing and can

1155
00:39:33,000 --> 00:39:34,980
circumstance security quite extensively

1156
00:39:34,980 --> 00:39:36,780
and that's unfortunately was the case

1157
00:39:36,780 --> 00:39:39,000
here it was Shadow I.T that ultimately

1158
00:39:39,000 --> 00:39:40,500
created a backdoor into the organization

1159
00:39:40,500 --> 00:39:42,839
which the attackers are you know very

1160
00:39:42,839 --> 00:39:45,480
skilled they're looking for so this was

1161
00:39:45,480 --> 00:39:47,339
not this is not sophisticated this is a

1162
00:39:47,339 --> 00:39:49,140
common thing that I've seen about 80

1163
00:39:49,140 --> 00:39:51,540
percent of it I see in most cases I

1164
00:39:51,540 --> 00:39:54,000
worked on it's just the entry point and

1165
00:39:54,000 --> 00:39:56,099
the ransomware variant tends to be the

1166
00:39:56,099 --> 00:39:57,480
the slight differences

1167
00:39:57,480 --> 00:39:59,700
so thank you so much for the great

1168
00:39:59,700 --> 00:40:03,060
question uh thanks for Joseph Carson our

1169
00:40:03,060 --> 00:40:04,920
speaker thank you very much it's been a

1170
00:40:04,920 --> 00:40:06,839
pleasure

1171
00:40:06,839 --> 00:40:08,760
and I'm here for the rest of the today

1172
00:40:08,760 --> 00:40:10,380
and tomorrow so if you have questions uh

1173
00:40:10,380 --> 00:40:11,700
feel free to come up in directly and

1174
00:40:11,700 --> 00:40:12,960
always you know make sure you provide

1175
00:40:12,960 --> 00:40:15,060
feedback to the organizers uh because

1176
00:40:15,060 --> 00:40:16,920
I'd love to this not be my first and

1177
00:40:16,920 --> 00:40:19,260
only conference I'd like it to be my the

1178
00:40:19,260 --> 00:40:21,540
first of many uh could I ask our next

1179
00:40:21,540 --> 00:40:25,800
speaker to come up here uh uh

1180
00:40:25,800 --> 00:40:27,359
and uh

1181
00:40:27,359 --> 00:40:30,060
we've got a great lineup ahead but we'll

1182
00:40:30,060 --> 00:40:32,640
get started here in about oh let's say

1183
00:40:32,640 --> 00:40:35,839
six or seven minutes

1184
00:40:36,300 --> 00:40:39,000
and if you asked a question please come

1185
00:40:39,000 --> 00:40:40,380
forward if you want to grab some

1186
00:40:40,380 --> 00:40:42,920
pralines

1187
00:40:51,960 --> 00:40:55,460
so is there

