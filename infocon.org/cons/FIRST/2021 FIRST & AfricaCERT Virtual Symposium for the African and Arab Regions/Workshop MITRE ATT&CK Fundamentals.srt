1
00:00:00,340 --> 00:00:05,040
[Music]

2
00:00:05,040 --> 00:00:07,279
so my name is sean whitley

3
00:00:07,279 --> 00:00:09,679
i'm an employee of the mitre corporation

4
00:00:09,679 --> 00:00:11,599
um most of you probably have not heard

5
00:00:11,599 --> 00:00:13,920
of us because we are what's known as a

6
00:00:13,920 --> 00:00:15,360
federally funded research and

7
00:00:15,360 --> 00:00:17,359
development corporation

8
00:00:17,359 --> 00:00:19,520
in the united states and so what that

9
00:00:19,520 --> 00:00:21,840
means is we are funded

10
00:00:21,840 --> 00:00:25,039
by the united states government to do

11
00:00:25,039 --> 00:00:26,240
research

12
00:00:26,240 --> 00:00:29,519
and other engineering activities solely

13
00:00:29,519 --> 00:00:32,960
for the benefit of the us government or

14
00:00:32,960 --> 00:00:34,800
in the case of things like attack

15
00:00:34,800 --> 00:00:37,200
publicly releasing it for the community

16
00:00:37,200 --> 00:00:38,559
itself

17
00:00:38,559 --> 00:00:40,559
so we don't sell things or we don't make

18
00:00:40,559 --> 00:00:42,879
things really

19
00:00:42,879 --> 00:00:45,360
i am actually an american if you could

20
00:00:45,360 --> 00:00:48,079
not tell from my accent uh but i am

21
00:00:48,079 --> 00:00:49,840
located in germany

22
00:00:49,840 --> 00:00:51,840
and so um i actually

23
00:00:51,840 --> 00:00:53,840
do a lot of work with uh african

24
00:00:53,840 --> 00:00:55,280
countries

25
00:00:55,280 --> 00:00:56,960
as well

26
00:00:56,960 --> 00:00:58,640
i have a master's degree in information

27
00:00:58,640 --> 00:01:00,320
security and assurance

28
00:01:00,320 --> 00:01:02,480
from george mason university uh in the

29
00:01:02,480 --> 00:01:03,840
united states

30
00:01:03,840 --> 00:01:06,479
uh and i've been doing this work for

31
00:01:06,479 --> 00:01:08,400
about nine plus years

32
00:01:08,400 --> 00:01:10,560
uh and all that time i have been with

33
00:01:10,560 --> 00:01:13,840
mitre corporation so it's been a while

34
00:01:13,840 --> 00:01:16,000
uh during my tenure here

35
00:01:16,000 --> 00:01:17,759
i have authored several papers on

36
00:01:17,759 --> 00:01:21,040
threat-based defense and i as part of my

37
00:01:21,040 --> 00:01:23,040
job conduct these sorts of training

38
00:01:23,040 --> 00:01:24,720
activities

39
00:01:24,720 --> 00:01:28,720
on how to implement threat-based defense

40
00:01:29,520 --> 00:01:32,400
uh so we are here to talk about attack

41
00:01:32,400 --> 00:01:35,119
uh so the first question is for what is

42
00:01:35,119 --> 00:01:38,560
attack um people who have been in the

43
00:01:38,560 --> 00:01:40,880
cyber security community for a while

44
00:01:40,880 --> 00:01:42,320
may have heard of this some of you may

45
00:01:42,320 --> 00:01:43,840
be very familiar

46
00:01:43,840 --> 00:01:46,640
some not so this is going to go

47
00:01:46,640 --> 00:01:49,439
go into great detail about attack

48
00:01:49,439 --> 00:01:50,560
what it is

49
00:01:50,560 --> 00:01:52,720
how you can use it uh those sorts of

50
00:01:52,720 --> 00:01:55,759
things uh and if we have time at the end

51
00:01:55,759 --> 00:01:59,280
um i'll go into actual the actual tag

52
00:01:59,280 --> 00:02:01,040
site and we can click through some

53
00:02:01,040 --> 00:02:03,280
things and also go to the attack

54
00:02:03,280 --> 00:02:05,040
navigator and maybe create some heat

55
00:02:05,040 --> 00:02:07,280
maps uh but what to see how we are on

56
00:02:07,280 --> 00:02:08,959
time

57
00:02:08,959 --> 00:02:13,440
uh so attack is a framework that we have

58
00:02:13,440 --> 00:02:15,440
uh shared with the cyberseries community

59
00:02:15,440 --> 00:02:16,400
for

60
00:02:16,400 --> 00:02:18,480
i think we released it about seven ish

61
00:02:18,480 --> 00:02:20,080
years ago

62
00:02:20,080 --> 00:02:22,400
um and so since that time it's been

63
00:02:22,400 --> 00:02:24,080
gaining more and more

64
00:02:24,080 --> 00:02:25,840
popularity within the

65
00:02:25,840 --> 00:02:27,840
cyber security community

66
00:02:27,840 --> 00:02:30,160
as a way of talking about adversary

67
00:02:30,160 --> 00:02:31,760
activity

68
00:02:31,760 --> 00:02:33,840
uh the diff way different teams use it

69
00:02:33,840 --> 00:02:34,879
varies

70
00:02:34,879 --> 00:02:36,879
but that's part of the power of the

71
00:02:36,879 --> 00:02:39,519
framework itself is that it is not

72
00:02:39,519 --> 00:02:41,920
uh stuck in being used in one particular

73
00:02:41,920 --> 00:02:44,160
use case we usually talk about four use

74
00:02:44,160 --> 00:02:46,560
cases which we'll get into later

75
00:02:46,560 --> 00:02:48,239
but we sort of did a on this side we

76
00:02:48,239 --> 00:02:49,120
have a

77
00:02:49,120 --> 00:02:50,720
quick overview of what that kind of

78
00:02:50,720 --> 00:02:52,080
looks like

79
00:02:52,080 --> 00:02:53,519
now you can use it for finding gaps in

80
00:02:53,519 --> 00:02:55,280
your defenses

81
00:02:55,280 --> 00:02:58,000
you can use it to plan threat emulation

82
00:02:58,000 --> 00:02:59,440
activities

83
00:02:59,440 --> 00:03:01,840
you can use it to help digest cyber

84
00:03:01,840 --> 00:03:05,040
threat intelligence and enables you

85
00:03:05,040 --> 00:03:07,760
and teams and organizations

86
00:03:07,760 --> 00:03:10,080
to share all that information between

87
00:03:10,080 --> 00:03:12,000
the different teams despite possibly

88
00:03:12,000 --> 00:03:14,400
despite definitely having different

89
00:03:14,400 --> 00:03:16,560
jobs or different educational

90
00:03:16,560 --> 00:03:19,560
backgrounds

91
00:03:19,920 --> 00:03:21,920
so this is the course structure

92
00:03:21,920 --> 00:03:25,120
it's not very complex it's um only three

93
00:03:25,120 --> 00:03:26,159
sections

94
00:03:26,159 --> 00:03:28,400
the actual training is much more broken

95
00:03:28,400 --> 00:03:29,360
down

96
00:03:29,360 --> 00:03:30,879
but in terms of the high level

97
00:03:30,879 --> 00:03:33,040
organization uh the first section we'll

98
00:03:33,040 --> 00:03:34,319
be talking about understanding what

99
00:03:34,319 --> 00:03:36,799
attack is and where it's come from so

100
00:03:36,799 --> 00:03:38,879
you'll get a little bit of the history

101
00:03:38,879 --> 00:03:41,680
um in section two uh we'll start talking

102
00:03:41,680 --> 00:03:43,680
about the benefits of using attacks so

103
00:03:43,680 --> 00:03:44,560
why

104
00:03:44,560 --> 00:03:46,319
would an organization want to even use

105
00:03:46,319 --> 00:03:48,000
it and what purpose might it serve and

106
00:03:48,000 --> 00:03:49,599
how it might improve their

107
00:03:49,599 --> 00:03:50,480
job

108
00:03:50,480 --> 00:03:52,239
and then in section three we'll talk

109
00:03:52,239 --> 00:03:54,319
about how to actually operationalize

110
00:03:54,319 --> 00:03:55,439
attack

111
00:03:55,439 --> 00:03:57,120
so how does

112
00:03:57,120 --> 00:03:59,200
assert or suck

113
00:03:59,200 --> 00:04:03,040
or another team start using it to

114
00:04:03,040 --> 00:04:06,400
actually do something

115
00:04:07,680 --> 00:04:08,879
so

116
00:04:08,879 --> 00:04:13,319
any questions about that before we start

117
00:04:15,920 --> 00:04:17,759
i don't see anything

118
00:04:17,759 --> 00:04:20,560
or hear anything uh so let's get started

119
00:04:20,560 --> 00:04:23,840
section one understanding attack

120
00:04:23,840 --> 00:04:26,560
uh this is what attack looks like and so

121
00:04:26,560 --> 00:04:27,759
when you see

122
00:04:27,759 --> 00:04:29,840
people talk about attack or see it

123
00:04:29,840 --> 00:04:31,759
presented as we are now

124
00:04:31,759 --> 00:04:34,320
this is usually the view you see

125
00:04:34,320 --> 00:04:36,240
it is the classic

126
00:04:36,240 --> 00:04:39,440
tabular format where we have tactics

127
00:04:39,440 --> 00:04:40,880
across the top

128
00:04:40,880 --> 00:04:43,759
and techniques running down the bottom

129
00:04:43,759 --> 00:04:46,240
we'll go down into a little more detail

130
00:04:46,240 --> 00:04:48,000
but then when we're talking about attack

131
00:04:48,000 --> 00:04:50,880
this is the summary sort of view

132
00:04:50,880 --> 00:04:54,080
we're often referring to

133
00:04:54,479 --> 00:04:56,960
let's take a step back first and uh

134
00:04:56,960 --> 00:04:58,720
really understand where

135
00:04:58,720 --> 00:05:02,000
what problem attack is trying to solve

136
00:05:02,000 --> 00:05:03,360
um so

137
00:05:03,360 --> 00:05:04,720
we all know there are dangerous threats

138
00:05:04,720 --> 00:05:07,520
out there and if all it takes is a quick

139
00:05:07,520 --> 00:05:09,680
look in the news on perhaps any given

140
00:05:09,680 --> 00:05:12,240
day and there's a good chance you'll see

141
00:05:12,240 --> 00:05:14,639
something about a new compromise a new

142
00:05:14,639 --> 00:05:16,080
attack

143
00:05:16,080 --> 00:05:17,680
anything like that

144
00:05:17,680 --> 00:05:20,000
and it's happening all the time

145
00:05:20,000 --> 00:05:21,360
and we've been trying to do network

146
00:05:21,360 --> 00:05:23,039
security defense

147
00:05:23,039 --> 00:05:25,840
for as long as we've had computer

148
00:05:25,840 --> 00:05:27,840
networks or computer systems you know

149
00:05:27,840 --> 00:05:29,360
we've had passwords we have different

150
00:05:29,360 --> 00:05:31,440
authentication mechanisms

151
00:05:31,440 --> 00:05:32,800
different ways to try to value people's

152
00:05:32,800 --> 00:05:35,120
identities and keep the wrong people out

153
00:05:35,120 --> 00:05:39,039
of the systems and we continue to fail

154
00:05:39,039 --> 00:05:41,759
leds fail from the perspective of

155
00:05:41,759 --> 00:05:43,919
complete security

156
00:05:43,919 --> 00:05:45,840
uh but if we take

157
00:05:45,840 --> 00:05:48,639
if we take the computer security

158
00:05:48,639 --> 00:05:50,240
paradigm if you will

159
00:05:50,240 --> 00:05:52,960
um and look at it from a physical

160
00:05:52,960 --> 00:05:55,120
security perspective

161
00:05:55,120 --> 00:05:57,280
we might consider that well it's perfect

162
00:05:57,280 --> 00:05:59,120
security is

163
00:05:59,120 --> 00:06:00,880
perhaps a pipe dream

164
00:06:00,880 --> 00:06:03,039
it is a laudable goal

165
00:06:03,039 --> 00:06:04,960
but realistically we're never going to

166
00:06:04,960 --> 00:06:07,039
get there no we've been building

167
00:06:07,039 --> 00:06:09,520
buildings for as long as humans have

168
00:06:09,520 --> 00:06:10,560
existed

169
00:06:10,560 --> 00:06:12,400
and we still don't have a way of

170
00:06:12,400 --> 00:06:14,080
securing a building

171
00:06:14,080 --> 00:06:16,479
uh without um

172
00:06:16,479 --> 00:06:18,960
with zero risk of somebody finding a way

173
00:06:18,960 --> 00:06:19,680
in

174
00:06:19,680 --> 00:06:21,840
so in this picture we have an example of

175
00:06:21,840 --> 00:06:23,039
a castle

176
00:06:23,039 --> 00:06:24,000
um

177
00:06:24,000 --> 00:06:26,639
so from the traditional cyber or the

178
00:06:26,639 --> 00:06:27,680
traditional computer security

179
00:06:27,680 --> 00:06:30,319
perspective we might say well we put a

180
00:06:30,319 --> 00:06:33,600
firewall or a stone wall around

181
00:06:33,600 --> 00:06:36,240
our treasure chest or our critical

182
00:06:36,240 --> 00:06:39,280
information or whatever it is

183
00:06:39,280 --> 00:06:42,639
and so we've stopped let's say

184
00:06:42,639 --> 00:06:45,440
the casual person from walking in

185
00:06:45,440 --> 00:06:48,639
or maybe someone who has a small ladder

186
00:06:48,639 --> 00:06:49,599
but

187
00:06:49,599 --> 00:06:50,960
if we think about

188
00:06:50,960 --> 00:06:52,800
really the security behind the wall in

189
00:06:52,800 --> 00:06:53,759
this case

190
00:06:53,759 --> 00:06:55,120
there's lots of ways to get around a

191
00:06:55,120 --> 00:06:55,919
wall

192
00:06:55,919 --> 00:06:58,560
you can dig under a wall you can get a

193
00:06:58,560 --> 00:07:01,120
big ladder and climb over a wall

194
00:07:01,120 --> 00:07:03,280
you can get a trebuchet and destroy the

195
00:07:03,280 --> 00:07:05,120
wall

196
00:07:05,120 --> 00:07:06,240
you know if you wait long enough the

197
00:07:06,240 --> 00:07:08,720
wall falls apart and so

198
00:07:08,720 --> 00:07:11,840
a wall in terms of physical security

199
00:07:11,840 --> 00:07:14,400
is not a perfect

200
00:07:14,400 --> 00:07:17,039
security mechanism but it's one

201
00:07:17,039 --> 00:07:19,440
that we accept generally

202
00:07:19,440 --> 00:07:20,639
as

203
00:07:20,639 --> 00:07:22,560
pretty good

204
00:07:22,560 --> 00:07:24,960
um so but what attack is trying to do is

205
00:07:24,960 --> 00:07:26,240
trying to capture

206
00:07:26,240 --> 00:07:27,199
not

207
00:07:27,199 --> 00:07:28,560
you know the security the different

208
00:07:28,560 --> 00:07:30,479
options for securing this

209
00:07:30,479 --> 00:07:32,800
treasure chest but really trying to

210
00:07:32,800 --> 00:07:34,400
capture what are the different ways

211
00:07:34,400 --> 00:07:37,440
adversaries can bypass our wall

212
00:07:37,440 --> 00:07:38,960
and once they're within the wall what

213
00:07:38,960 --> 00:07:41,360
can they do

214
00:07:41,360 --> 00:07:44,319
so that is really the purpose of attack

215
00:07:44,319 --> 00:07:45,680
and we call this

216
00:07:45,680 --> 00:07:47,759
a threat of form defense

217
00:07:47,759 --> 00:07:50,080
so rather than a defense based on a

218
00:07:50,080 --> 00:07:52,160
technology or

219
00:07:52,160 --> 00:07:53,039
a

220
00:07:53,039 --> 00:07:55,759
specific layer in the osi model

221
00:07:55,759 --> 00:07:58,080
we're trying to figure out okay what are

222
00:07:58,080 --> 00:07:59,919
the things that averages are trying to

223
00:07:59,919 --> 00:08:01,360
do to us

224
00:08:01,360 --> 00:08:05,039
and what can we do about that

225
00:08:08,080 --> 00:08:10,000
so attack is a knowledge base of

226
00:08:10,000 --> 00:08:12,080
adversary behaviors

227
00:08:12,080 --> 00:08:13,919
it is importantly based on real world

228
00:08:13,919 --> 00:08:15,599
observations

229
00:08:15,599 --> 00:08:18,319
it's free open and globally accessible

230
00:08:18,319 --> 00:08:21,360
unless your country blocks it

231
00:08:21,360 --> 00:08:24,400
and is a community driven

232
00:08:24,400 --> 00:08:25,599
so

233
00:08:25,599 --> 00:08:28,080
i think the first point uh

234
00:08:28,080 --> 00:08:29,919
is self-explanatory

235
00:08:29,919 --> 00:08:32,479
um the important part about the second

236
00:08:32,479 --> 00:08:34,000
bullet is

237
00:08:34,000 --> 00:08:36,799
that this is not stuff we came up with

238
00:08:36,799 --> 00:08:38,640
in a lab or

239
00:08:38,640 --> 00:08:41,360
things we made up or you know things we

240
00:08:41,360 --> 00:08:43,360
talked or we just pulled out of black

241
00:08:43,360 --> 00:08:46,000
hat or other security conferences

242
00:08:46,000 --> 00:08:48,480
uh most of the content in attack is

243
00:08:48,480 --> 00:08:51,120
based on reports that are put out by

244
00:08:51,120 --> 00:08:53,440
other organizations or people in the

245
00:08:53,440 --> 00:08:54,399
community

246
00:08:54,399 --> 00:08:55,839
that can show

247
00:08:55,839 --> 00:08:58,000
some demonstrated

248
00:08:58,000 --> 00:09:00,560
uh use of these techniques

249
00:09:00,560 --> 00:09:02,640
so that we know okay this is a real live

250
00:09:02,640 --> 00:09:04,320
thing and not just

251
00:09:04,320 --> 00:09:08,000
a hypothetical use that somebody was

252
00:09:08,000 --> 00:09:11,040
able to do another lab

253
00:09:11,040 --> 00:09:13,519
as it is free and open which means

254
00:09:13,519 --> 00:09:15,920
anybody can use it there's no license to

255
00:09:15,920 --> 00:09:18,320
use it this is not a thing you buy

256
00:09:18,320 --> 00:09:21,040
it's not a thing you install in a server

257
00:09:21,040 --> 00:09:23,920
room it is symmetrical before a

258
00:09:23,920 --> 00:09:25,040
framework

259
00:09:25,040 --> 00:09:27,360
and more important as a framework of

260
00:09:27,360 --> 00:09:28,640
language

261
00:09:28,640 --> 00:09:31,440
that we can use to talk between groups

262
00:09:31,440 --> 00:09:34,000
and so yesterday in the plenary sessions

263
00:09:34,000 --> 00:09:35,519
there was a lot of talk about how

264
00:09:35,519 --> 00:09:37,680
important it is that we all speak a

265
00:09:37,680 --> 00:09:39,920
common language that we all are on the

266
00:09:39,920 --> 00:09:42,560
same page about how we talk about cyber

267
00:09:42,560 --> 00:09:44,880
security or cyber security related

268
00:09:44,880 --> 00:09:48,000
topics and so that is part of what the

269
00:09:48,000 --> 00:09:50,399
attack framework is trying to do is

270
00:09:50,399 --> 00:09:52,480
provide a way for not just the

271
00:09:52,480 --> 00:09:54,000
practitioners

272
00:09:54,000 --> 00:09:55,920
to discuss that but how can the

273
00:09:55,920 --> 00:09:57,839
practitioners talk to

274
00:09:57,839 --> 00:09:59,760
their management

275
00:09:59,760 --> 00:10:01,760
or other organizations that maybe are

276
00:10:01,760 --> 00:10:02,560
not

277
00:10:02,560 --> 00:10:04,959
as technically deep

278
00:10:04,959 --> 00:10:07,440
as the practitioners are now a manager

279
00:10:07,440 --> 00:10:09,360
may not know what

280
00:10:09,360 --> 00:10:11,680
a command prompt is for example but the

281
00:10:11,680 --> 00:10:13,200
practitioner knows so how does the

282
00:10:13,200 --> 00:10:15,200
practitioner convert that

283
00:10:15,200 --> 00:10:17,040
into something that

284
00:10:17,040 --> 00:10:20,240
um their management might understand

285
00:10:20,240 --> 00:10:23,279
and then uh i think the community point

286
00:10:23,279 --> 00:10:24,000
we

287
00:10:24,000 --> 00:10:25,839
take input from throughout the community

288
00:10:25,839 --> 00:10:27,440
so it's not just

289
00:10:27,440 --> 00:10:28,399
mitre

290
00:10:28,399 --> 00:10:31,440
or the united states organizations even

291
00:10:31,440 --> 00:10:33,680
we take input from anyone in the world

292
00:10:33,680 --> 00:10:36,640
and you can email us or contact us

293
00:10:36,640 --> 00:10:38,800
with ideas or proposals for

294
00:10:38,800 --> 00:10:41,120
changes or additions to the framework

295
00:10:41,120 --> 00:10:43,040
and we'll take those into consideration

296
00:10:43,040 --> 00:10:47,160
and integrate them

297
00:10:47,200 --> 00:10:49,600
uh for those of you who are not familiar

298
00:10:49,600 --> 00:10:52,079
this is david bianco's pyramid of pain

299
00:10:52,079 --> 00:10:55,680
uh that he published in around 2013

300
00:10:55,680 --> 00:10:56,560
and the

301
00:10:56,560 --> 00:10:59,440
purpose of this was to capture

302
00:10:59,440 --> 00:11:02,079
how easy or difficult it is for

303
00:11:02,079 --> 00:11:05,200
adversaries to change various

304
00:11:05,200 --> 00:11:08,240
things we look for as network defenders

305
00:11:08,240 --> 00:11:08,959
so

306
00:11:08,959 --> 00:11:10,480
traditionally we'll look at a lot of

307
00:11:10,480 --> 00:11:13,360
things like hash values or ip addresses

308
00:11:13,360 --> 00:11:15,760
when we get cyber threat intelligence or

309
00:11:15,760 --> 00:11:17,680
other information about ongoing

310
00:11:17,680 --> 00:11:19,040
compromises

311
00:11:19,040 --> 00:11:21,120
but the problem with those are

312
00:11:21,120 --> 00:11:23,920
using those in defense at least is they

313
00:11:23,920 --> 00:11:25,360
are trivial

314
00:11:25,360 --> 00:11:26,240
for

315
00:11:26,240 --> 00:11:28,560
adversaries to change you know to change

316
00:11:28,560 --> 00:11:30,959
the hash of a program

317
00:11:30,959 --> 00:11:32,880
just takes recompiling it

318
00:11:32,880 --> 00:11:36,160
or changing a single variable or editing

319
00:11:36,160 --> 00:11:37,600
one string and then the hash is

320
00:11:37,600 --> 00:11:40,000
completely different and now

321
00:11:40,000 --> 00:11:42,480
your detection or your mitigation for

322
00:11:42,480 --> 00:11:44,399
that is useless

323
00:11:44,399 --> 00:11:47,040
and so as we go up this pyramid

324
00:11:47,040 --> 00:11:49,120
uh we see an increasingly harder and

325
00:11:49,120 --> 00:11:50,399
harder

326
00:11:50,399 --> 00:11:54,000
um things or artifacts um a lot these

327
00:11:54,000 --> 00:11:56,000
are generally called iocs and it carries

328
00:11:56,000 --> 00:11:57,279
a compromise

329
00:11:57,279 --> 00:11:59,519
uh that adversary is increasingly

330
00:11:59,519 --> 00:12:01,440
difficult for adversaries to change them

331
00:12:01,440 --> 00:12:02,480
so

332
00:12:02,480 --> 00:12:04,320
changing an ip address

333
00:12:04,320 --> 00:12:06,399
also not that hard maybe a little bit to

334
00:12:06,399 --> 00:12:09,839
find a publicly facing ipi address to

335
00:12:09,839 --> 00:12:10,959
change it

336
00:12:10,959 --> 00:12:12,560
domain names again you can just register

337
00:12:12,560 --> 00:12:14,079
a new domain name but it's a little more

338
00:12:14,079 --> 00:12:16,800
time and eventually

339
00:12:16,800 --> 00:12:19,839
we get up to ttps or tactics techniques

340
00:12:19,839 --> 00:12:21,440
and procedures

341
00:12:21,440 --> 00:12:24,639
and this is where attack comes in so

342
00:12:24,639 --> 00:12:25,760
attack

343
00:12:25,760 --> 00:12:27,680
uh when we started doing attack

344
00:12:27,680 --> 00:12:29,600
we saw this whole this problem with

345
00:12:29,600 --> 00:12:32,160
traditional network security which is

346
00:12:32,160 --> 00:12:34,639
yeah we can write all the firewall rules

347
00:12:34,639 --> 00:12:38,160
all the anti-virus spot that files

348
00:12:38,160 --> 00:12:40,959
although whatever's detect these

349
00:12:40,959 --> 00:12:43,600
but these are easy for an arbitrary to

350
00:12:43,600 --> 00:12:46,560
change and so as defenders we are always

351
00:12:46,560 --> 00:12:48,240
lagging behind

352
00:12:48,240 --> 00:12:49,680
in

353
00:12:49,680 --> 00:12:52,720
defense so it's always we spend a lot of

354
00:12:52,720 --> 00:12:53,839
time

355
00:12:53,839 --> 00:12:56,480
trying to change our

356
00:12:56,480 --> 00:12:58,320
detections or mitigations

357
00:12:58,320 --> 00:13:00,399
and then it's trivial

358
00:13:00,399 --> 00:13:01,120
for

359
00:13:01,120 --> 00:13:04,079
the adversaries to subvert those which

360
00:13:04,079 --> 00:13:05,839
means we're fighting a constant losing

361
00:13:05,839 --> 00:13:06,959
battle

362
00:13:06,959 --> 00:13:09,040
but if we can get up to ttps and

363
00:13:09,040 --> 00:13:10,959
addressing these

364
00:13:10,959 --> 00:13:12,399
then we hope

365
00:13:12,399 --> 00:13:14,639
that that um

366
00:13:14,639 --> 00:13:17,440
dynamic inverts and adversaries then has

367
00:13:17,440 --> 00:13:19,279
spent a lot more time

368
00:13:19,279 --> 00:13:21,839
editing their ttps while we have already

369
00:13:21,839 --> 00:13:25,120
prepared hopefully for those

370
00:13:25,120 --> 00:13:28,399
eventualities and so we don't have to

371
00:13:28,399 --> 00:13:30,800
spend as much time investing those

372
00:13:30,800 --> 00:13:33,680
also this is a smaller space

373
00:13:33,680 --> 00:13:36,160
than all these you know there's

374
00:13:36,160 --> 00:13:38,959
an enormous number a possible

375
00:13:38,959 --> 00:13:41,279
theoretical number of hashtag values

376
00:13:41,279 --> 00:13:43,040
you'll net you can't write you know a

377
00:13:43,040 --> 00:13:45,519
detecting for all hash values

378
00:13:45,519 --> 00:13:47,440
we can do is perhaps identify all the

379
00:13:47,440 --> 00:13:51,839
ttps or a small or a subset of those

380
00:13:51,839 --> 00:13:55,120
and address those

381
00:13:55,199 --> 00:13:58,160
but within ttps themselves

382
00:13:58,160 --> 00:13:58,959
there's

383
00:13:58,959 --> 00:14:01,360
no further breakdown we have

384
00:14:01,360 --> 00:14:02,480
seizures

385
00:14:02,480 --> 00:14:04,639
uh sub techniques

386
00:14:04,639 --> 00:14:06,160
and then techniques and then tactics

387
00:14:06,160 --> 00:14:07,440
above those

388
00:14:07,440 --> 00:14:09,680
and we'll get more into how attack looks

389
00:14:09,680 --> 00:14:11,440
at each of these

390
00:14:11,440 --> 00:14:14,399
later in the slides

391
00:14:14,480 --> 00:14:16,240
so again a little refresher this is what

392
00:14:16,240 --> 00:14:17,600
it looks like

393
00:14:17,600 --> 00:14:19,839
um these are all techniques down the

394
00:14:19,839 --> 00:14:20,800
bottom

395
00:14:20,800 --> 00:14:21,839
um but

396
00:14:21,839 --> 00:14:25,199
above this graph uh we have different

397
00:14:25,199 --> 00:14:27,920
matrices and platforms so

398
00:14:27,920 --> 00:14:30,240
this one visualization does not

399
00:14:30,240 --> 00:14:31,839
encompass

400
00:14:31,839 --> 00:14:34,240
all possible techniques across all

401
00:14:34,240 --> 00:14:36,240
systems you know this is what we call

402
00:14:36,240 --> 00:14:39,279
attack enterprise which is the most

403
00:14:39,279 --> 00:14:41,120
generalized one

404
00:14:41,120 --> 00:14:42,720
we'll get mentioned a little bit later

405
00:14:42,720 --> 00:14:44,399
what is included

406
00:14:44,399 --> 00:14:46,320
but we also have

407
00:14:46,320 --> 00:14:48,480
other platforms or matrices applied to

408
00:14:48,480 --> 00:14:50,079
different platforms

409
00:14:50,079 --> 00:14:51,839
uh so acros like i said we have across

410
00:14:51,839 --> 00:14:54,000
the top of tactics

411
00:14:54,000 --> 00:14:57,199
and then within each tactic we have

412
00:14:57,199 --> 00:15:00,160
individual techniques and sub techniques

413
00:15:00,160 --> 00:15:02,399
and within each of those we have you

414
00:15:02,399 --> 00:15:04,240
know things like a description of what

415
00:15:04,240 --> 00:15:06,880
that is or the sub techniques that make

416
00:15:06,880 --> 00:15:09,199
up that

417
00:15:09,199 --> 00:15:11,199
uh and then coming out of that

418
00:15:11,199 --> 00:15:12,399
we also have

419
00:15:12,399 --> 00:15:14,480
mitigations and data sources we can use

420
00:15:14,480 --> 00:15:16,800
for detections

421
00:15:16,800 --> 00:15:19,120
and further we have the individual

422
00:15:19,120 --> 00:15:21,600
procedures for how those specific

423
00:15:21,600 --> 00:15:22,880
techniques and sub techniques are

424
00:15:22,880 --> 00:15:24,000
implemented

425
00:15:24,000 --> 00:15:26,480
so you see within the frame just the one

426
00:15:26,480 --> 00:15:29,759
framework itself we can go from

427
00:15:29,759 --> 00:15:32,240
you know uh what systems do i care about

428
00:15:32,240 --> 00:15:34,240
which tactics apply

429
00:15:34,240 --> 00:15:36,079
to those systems

430
00:15:36,079 --> 00:15:38,880
um which techniques um

431
00:15:38,880 --> 00:15:40,399
apply and how

432
00:15:40,399 --> 00:15:42,160
those might work

433
00:15:42,160 --> 00:15:44,480
and then what can i do about it or what

434
00:15:44,480 --> 00:15:46,240
are some options i have to either detect

435
00:15:46,240 --> 00:15:48,000
or mitigate it

436
00:15:48,000 --> 00:15:50,320
and so it's a lot of information we as

437
00:15:50,320 --> 00:15:51,839
never defenders need when trying to do

438
00:15:51,839 --> 00:15:54,000
our jobs

439
00:15:54,000 --> 00:15:56,639
and it's also constantly growing and in

440
00:15:56,639 --> 00:15:59,120
all these different aspects uh we're

441
00:15:59,120 --> 00:16:01,680
constantly making updates and changes

442
00:16:01,680 --> 00:16:03,839
you know tactics are generally pretty

443
00:16:03,839 --> 00:16:05,199
static

444
00:16:05,199 --> 00:16:07,040
but the techniques and especially the

445
00:16:07,040 --> 00:16:08,800
sub techniques

446
00:16:08,800 --> 00:16:10,320
they're always coming out with new ones

447
00:16:10,320 --> 00:16:12,079
or new details

448
00:16:12,079 --> 00:16:13,199
particularly when you talk about

449
00:16:13,199 --> 00:16:15,440
procedures or groups and software that

450
00:16:15,440 --> 00:16:17,839
use them

451
00:16:18,959 --> 00:16:20,240
so let's

452
00:16:20,240 --> 00:16:22,720
visualize um the relationships between

453
00:16:22,720 --> 00:16:25,360
these things uh in case it wasn't clear

454
00:16:25,360 --> 00:16:27,199
if when i described them

455
00:16:27,199 --> 00:16:29,839
so at the top left we have the adversary

456
00:16:29,839 --> 00:16:30,959
group

457
00:16:30,959 --> 00:16:32,800
this is a lot of times what we see in

458
00:16:32,800 --> 00:16:35,680
throughout reports so

459
00:16:36,040 --> 00:16:38,480
apg3x or whatever

460
00:16:38,480 --> 00:16:40,480
is doing something uh but what are they

461
00:16:40,480 --> 00:16:42,160
doing they're using

462
00:16:42,160 --> 00:16:44,079
uh the technique

463
00:16:44,079 --> 00:16:46,720
and to do that technique they're usually

464
00:16:46,720 --> 00:16:48,800
using software they don't have to

465
00:16:48,800 --> 00:16:50,720
but they oftentimes will have software

466
00:16:50,720 --> 00:16:53,279
that they use physically specifically

467
00:16:53,279 --> 00:16:56,880
which implements those techniques

468
00:16:56,880 --> 00:16:59,680
and those techniques accomplish certain

469
00:16:59,680 --> 00:17:01,519
tactics so you know they're dumping

470
00:17:01,519 --> 00:17:04,400
credentials in order

471
00:17:04,400 --> 00:17:06,720
to or they're dumping lsat's memory in

472
00:17:06,720 --> 00:17:09,199
order to get credentials

473
00:17:09,199 --> 00:17:11,359
and then we as defenders

474
00:17:11,359 --> 00:17:13,119
have mitigation options which can

475
00:17:13,119 --> 00:17:14,799
prevent

476
00:17:14,799 --> 00:17:17,599
these techniques

477
00:17:17,599 --> 00:17:19,359
so here's an example if we were to fill

478
00:17:19,359 --> 00:17:20,720
in those blanks

479
00:17:20,720 --> 00:17:25,439
apt 28 uses mimikatz a credential dumper

480
00:17:25,439 --> 00:17:29,760
to do lsas memory credential dumping

481
00:17:29,760 --> 00:17:31,840
we can that accomplishes credential

482
00:17:31,840 --> 00:17:34,320
access for the adversary giving them

483
00:17:34,320 --> 00:17:36,080
access to user credentials

484
00:17:36,080 --> 00:17:38,720
but we as network defenders

485
00:17:38,720 --> 00:17:40,640
can use credential access protection to

486
00:17:40,640 --> 00:17:43,120
help prevent that

487
00:17:43,120 --> 00:17:45,760
now this is not uh in a framework we do

488
00:17:45,760 --> 00:17:48,640
not say it is a completely comprehensive

489
00:17:48,640 --> 00:17:51,440
uh framework there are certainly gaps

490
00:17:51,440 --> 00:17:53,600
in there that we maybe don't know about

491
00:17:53,600 --> 00:17:54,640
and so

492
00:17:54,640 --> 00:17:55,919
um be

493
00:17:55,919 --> 00:17:58,320
careful about assuming well this is

494
00:17:58,320 --> 00:18:00,160
everything that could ever happen

495
00:18:00,160 --> 00:18:01,600
because that's not true this is more of

496
00:18:01,600 --> 00:18:03,679
a capturing of what has been publicly

497
00:18:03,679 --> 00:18:04,799
released

498
00:18:04,799 --> 00:18:08,160
um in the community

499
00:18:08,880 --> 00:18:09,840
and so

500
00:18:09,840 --> 00:18:11,679
when we're talking about visualizing

501
00:18:11,679 --> 00:18:14,720
attack as i mentioned before we usually

502
00:18:14,720 --> 00:18:17,360
talk about in this tabular format

503
00:18:17,360 --> 00:18:20,320
and this is a useful visualization

504
00:18:20,320 --> 00:18:22,000
because it captures relationships

505
00:18:22,000 --> 00:18:24,160
between tactics techniques and sub

506
00:18:24,160 --> 00:18:25,679
techniques

507
00:18:25,679 --> 00:18:28,559
and each matrix we look at is centered

508
00:18:28,559 --> 00:18:32,000
around a specific technology domain

509
00:18:32,000 --> 00:18:34,320
so in this example we have again tactics

510
00:18:34,320 --> 00:18:36,559
across the top and then the techniques

511
00:18:36,559 --> 00:18:38,000
below them

512
00:18:38,000 --> 00:18:40,559
and then so you can easily see okay well

513
00:18:40,559 --> 00:18:44,000
what does internal spear phishing

514
00:18:44,000 --> 00:18:46,320
accomplish well it may help enable

515
00:18:46,320 --> 00:18:47,919
lateral movement

516
00:18:47,919 --> 00:18:51,919
um what does um data for removal media

517
00:18:51,919 --> 00:18:53,280
uh in this case you might think of

518
00:18:53,280 --> 00:18:56,880
things like cds or usbs um

519
00:18:56,880 --> 00:18:58,720
do or how might an aperture use those

520
00:18:58,720 --> 00:19:00,720
against me while they can use it

521
00:19:00,720 --> 00:19:02,480
to enable data collection maybe they

522
00:19:02,480 --> 00:19:04,240
pull data off of

523
00:19:04,240 --> 00:19:06,480
those devices

524
00:19:06,480 --> 00:19:08,880
and so on and so forth

525
00:19:08,880 --> 00:19:11,520
and these are might vary between the

526
00:19:11,520 --> 00:19:13,840
different platforms uh we'll get talk a

527
00:19:13,840 --> 00:19:15,760
little bit more those are later

528
00:19:15,760 --> 00:19:18,480
um but just keep that in mind

529
00:19:18,480 --> 00:19:21,039
and so in that sort of tabular format

530
00:19:21,039 --> 00:19:22,480
you can see

531
00:19:22,480 --> 00:19:25,600
these as well so in this case technique

532
00:19:25,600 --> 00:19:27,440
a and technic b

533
00:19:27,440 --> 00:19:30,400
are unique to both tactics a and b

534
00:19:30,400 --> 00:19:31,679
respectively

535
00:19:31,679 --> 00:19:33,120
however

536
00:19:33,120 --> 00:19:34,640
technique c

537
00:19:34,640 --> 00:19:37,600
is common across both tactics

538
00:19:37,600 --> 00:19:40,240
now how can that be how can a technique

539
00:19:40,240 --> 00:19:42,160
be common across both

540
00:19:42,160 --> 00:19:44,799
well let's take the example of scheduled

541
00:19:44,799 --> 00:19:47,679
tasks uh you can use scheduled tasks to

542
00:19:47,679 --> 00:19:49,919
either maintain persistence so that

543
00:19:49,919 --> 00:19:51,679
might be something like scheduling a

544
00:19:51,679 --> 00:19:54,160
test run when a system boots

545
00:19:54,160 --> 00:19:57,120
or you can schedule a task to run as a

546
00:19:57,120 --> 00:19:59,120
different user like system

547
00:19:59,120 --> 00:20:00,720
in which case that might be more

548
00:20:00,720 --> 00:20:04,000
representative of um

549
00:20:04,000 --> 00:20:07,039
privilege escalation

550
00:20:07,039 --> 00:20:08,880
so that's why some techniques have these

551
00:20:08,880 --> 00:20:10,559
cross-tactic boundaries because

552
00:20:10,559 --> 00:20:13,039
depending on how you implement it

553
00:20:13,039 --> 00:20:15,280
might have different techniques or i

554
00:20:15,280 --> 00:20:17,679
mean sorry tactics

555
00:20:17,679 --> 00:20:20,400
and then if we go further technique d

556
00:20:20,400 --> 00:20:24,320
has no sub techniques uh the technique e

557
00:20:24,320 --> 00:20:27,760
you see from the three little dashes has

558
00:20:27,760 --> 00:20:29,679
multiple sub techniques which means as

559
00:20:29,679 --> 00:20:32,240
different implementations

560
00:20:32,240 --> 00:20:34,080
you'll see this uh these occur

561
00:20:34,080 --> 00:20:35,520
especially with

562
00:20:35,520 --> 00:20:38,159
techniques that cross multiple platforms

563
00:20:38,159 --> 00:20:40,240
or multiple operating systems

564
00:20:40,240 --> 00:20:41,840
because the way you accomplish something

565
00:20:41,840 --> 00:20:43,200
in windows

566
00:20:43,200 --> 00:20:45,520
might vary from how you do it in linux

567
00:20:45,520 --> 00:20:48,760
or mac

568
00:20:49,520 --> 00:20:51,760
so we talked about what

569
00:20:51,760 --> 00:20:53,919
um the different plat different

570
00:20:53,919 --> 00:20:56,720
operating systems are within enterprise

571
00:20:56,720 --> 00:20:59,600
and so within at the enterprise group we

572
00:20:59,600 --> 00:21:01,679
have windows linux

573
00:21:01,679 --> 00:21:02,559
mac

574
00:21:02,559 --> 00:21:05,120
cloud and um

575
00:21:05,120 --> 00:21:07,120
networking systems

576
00:21:07,120 --> 00:21:08,880
things like routers

577
00:21:08,880 --> 00:21:11,360
those sorts of devices

578
00:21:11,360 --> 00:21:13,840
and in total in the

579
00:21:13,840 --> 00:21:16,480
currents i believe

580
00:21:16,480 --> 00:21:18,960
model or framework we have 14 enterprise

581
00:21:18,960 --> 00:21:20,480
tactics

582
00:21:20,480 --> 00:21:21,600
these are

583
00:21:21,600 --> 00:21:23,120
roughly

584
00:21:23,120 --> 00:21:26,400
very roughly in order of how they might

585
00:21:26,400 --> 00:21:29,280
be pursued by an adversary but that's

586
00:21:29,280 --> 00:21:31,200
not strictly speaking true if you really

587
00:21:31,200 --> 00:21:32,400
look at it

588
00:21:32,400 --> 00:21:33,919
you'll see

589
00:21:33,919 --> 00:21:35,600
in an actual

590
00:21:35,600 --> 00:21:37,440
uh events or

591
00:21:37,440 --> 00:21:38,480
campaign

592
00:21:38,480 --> 00:21:41,440
that these really cycle in on themselves

593
00:21:41,440 --> 00:21:43,600
a lot you know they'll do persistence

594
00:21:43,600 --> 00:21:46,559
credential access execution lateral

595
00:21:46,559 --> 00:21:48,080
movement and then do it all over again

596
00:21:48,080 --> 00:21:49,679
on a new system

597
00:21:49,679 --> 00:21:50,640
uh but you know things like

598
00:21:50,640 --> 00:21:52,159
reconnaissance are probably going to

599
00:21:52,159 --> 00:21:53,919
happen up front

600
00:21:53,919 --> 00:21:56,320
and things like exfiltration or impact

601
00:21:56,320 --> 00:21:57,440
are going to be towards the end

602
00:21:57,440 --> 00:21:59,840
generally

603
00:22:01,840 --> 00:22:03,919
and so like i mentioned before it's not

604
00:22:03,919 --> 00:22:07,200
just those um common operating systems

605
00:22:07,200 --> 00:22:09,520
devices we also have other domains we

606
00:22:09,520 --> 00:22:10,640
talked about

607
00:22:10,640 --> 00:22:13,039
and so they may target lots of different

608
00:22:13,039 --> 00:22:15,440
technologies and as we know all know

609
00:22:15,440 --> 00:22:16,960
especially things like internet of

610
00:22:16,960 --> 00:22:20,080
things there's a very wide breadth of

611
00:22:20,080 --> 00:22:22,640
possible things we have to care about

612
00:22:22,640 --> 00:22:24,880
not just the traditional enterprise

613
00:22:24,880 --> 00:22:26,720
network

614
00:22:26,720 --> 00:22:29,360
and so we have actually mobile attack as

615
00:22:29,360 --> 00:22:32,880
well and this encap encapsulates android

616
00:22:32,880 --> 00:22:35,039
and ios

617
00:22:35,039 --> 00:22:37,120
techniques or these techniques that work

618
00:22:37,120 --> 00:22:39,280
across those devices

619
00:22:39,280 --> 00:22:40,960
and so because those are very different

620
00:22:40,960 --> 00:22:42,880
technologies from

621
00:22:42,880 --> 00:22:45,039
what you have in your normal enterprise

622
00:22:45,039 --> 00:22:48,159
network we have a separate um

623
00:22:48,159 --> 00:22:50,080
grouping of techniques and tactics for

624
00:22:50,080 --> 00:22:51,760
those

625
00:22:51,760 --> 00:22:53,200
and similarly

626
00:22:53,200 --> 00:22:56,240
we have an attack for ics or industrial

627
00:22:56,240 --> 00:22:58,400
control systems and scada

628
00:22:58,400 --> 00:23:01,200
because those are very different systems

629
00:23:01,200 --> 00:23:02,799
but we still care about them especially

630
00:23:02,799 --> 00:23:04,640
when we start talking about national

631
00:23:04,640 --> 00:23:06,559
critical infrastructure

632
00:23:06,559 --> 00:23:08,480
or you know these are things like power

633
00:23:08,480 --> 00:23:12,320
plants or ports or airports

634
00:23:12,320 --> 00:23:13,919
you know things that if something

635
00:23:13,919 --> 00:23:15,360
happens to them

636
00:23:15,360 --> 00:23:17,440
no it could be catastrophic you know if

637
00:23:17,440 --> 00:23:21,120
somebody compromises a dam on a river

638
00:23:21,120 --> 00:23:24,120
and releases the floodgates that can be

639
00:23:24,120 --> 00:23:26,720
catastrophic for anybody living down

640
00:23:26,720 --> 00:23:29,039
river

641
00:23:30,000 --> 00:23:32,159
but these platforms don't exist

642
00:23:32,159 --> 00:23:34,400
independently of each other

643
00:23:34,400 --> 00:23:36,400
there's overlaps and redundancies that

644
00:23:36,400 --> 00:23:39,200
exist between all the matrices because a

645
00:23:39,200 --> 00:23:40,320
lot of the

646
00:23:40,320 --> 00:23:41,919
tactics in particular but some of the

647
00:23:41,919 --> 00:23:43,520
techniques as well are common across

648
00:23:43,520 --> 00:23:44,640
them

649
00:23:44,640 --> 00:23:47,200
it's also important to identify where

650
00:23:47,200 --> 00:23:48,799
these overlaps are

651
00:23:48,799 --> 00:23:50,960
because there's a lot of overlap in

652
00:23:50,960 --> 00:23:53,120
these different platforms

653
00:23:53,120 --> 00:23:56,240
so going back a slide if we look at

654
00:23:56,240 --> 00:23:58,960
you know enterprise versus mobile versus

655
00:23:58,960 --> 00:24:00,480
attack ics

656
00:24:00,480 --> 00:24:02,880
you could have a network that has all

657
00:24:02,880 --> 00:24:04,799
three things in it

658
00:24:04,799 --> 00:24:06,240
you know your core

659
00:24:06,240 --> 00:24:08,320
of your network might be windows you

660
00:24:08,320 --> 00:24:10,960
might have servers in the back end that

661
00:24:10,960 --> 00:24:12,320
are running linux

662
00:24:12,320 --> 00:24:14,080
you might have users connecting their

663
00:24:14,080 --> 00:24:16,880
mobile devices to that network either in

664
00:24:16,880 --> 00:24:19,679
the office or maybe you have staff out

665
00:24:19,679 --> 00:24:20,960
in the field

666
00:24:20,960 --> 00:24:22,480
doing things through their mobile

667
00:24:22,480 --> 00:24:24,400
devices that are work related like

668
00:24:24,400 --> 00:24:27,039
checking pipelines or whatever

669
00:24:27,039 --> 00:24:29,600
but your network may also have an ics

670
00:24:29,600 --> 00:24:32,000
scada section

671
00:24:32,000 --> 00:24:34,000
oftentimes the ics scada in particular

672
00:24:34,000 --> 00:24:36,480
is forgotten because some the systems

673
00:24:36,480 --> 00:24:38,799
are so archaic

674
00:24:38,799 --> 00:24:40,880
that we as narrative don't even know how

675
00:24:40,880 --> 00:24:43,679
to begin to start looking at it no it's

676
00:24:43,679 --> 00:24:44,480
just

677
00:24:44,480 --> 00:24:46,960
numbers transited across a wire

678
00:24:46,960 --> 00:24:49,440
without any idea what that means

679
00:24:49,440 --> 00:24:52,159
but the impact of

680
00:24:52,159 --> 00:24:54,400
being compromised there can be just as

681
00:24:54,400 --> 00:24:57,919
large anywhere else in the

682
00:24:58,840 --> 00:25:01,120
network and so going a little more

683
00:25:01,120 --> 00:25:03,200
detail about the different sections of

684
00:25:03,200 --> 00:25:04,320
attack

685
00:25:04,320 --> 00:25:06,799
uh tactics are the adversary goals

686
00:25:06,799 --> 00:25:09,039
during an attack or that's uh one way to

687
00:25:09,039 --> 00:25:11,279
think about it it's the why

688
00:25:11,279 --> 00:25:13,360
of why an adversary performs each action

689
00:25:13,360 --> 00:25:16,400
or does that specific technique

690
00:25:16,400 --> 00:25:18,640
and so the list of taxes may vary across

691
00:25:18,640 --> 00:25:20,559
different technology domains

692
00:25:20,559 --> 00:25:21,760
but generally speaking they're

693
00:25:21,760 --> 00:25:23,600
relatively static

694
00:25:23,600 --> 00:25:25,919
there's a later site where i look at how

695
00:25:25,919 --> 00:25:28,720
attack has evolved over time

696
00:25:28,720 --> 00:25:29,520
but

697
00:25:29,520 --> 00:25:30,799
up front here

698
00:25:30,799 --> 00:25:32,000
we've roughly

699
00:25:32,000 --> 00:25:34,960
in seven or so years we've only roughly

700
00:25:34,960 --> 00:25:38,400
doubled the number of tactics

701
00:25:38,400 --> 00:25:40,240
the number of techniques is

702
00:25:40,240 --> 00:25:43,840
growing much larger than that

703
00:25:44,880 --> 00:25:47,760
uh each tactic is assigned an id as well

704
00:25:47,760 --> 00:25:50,000
as a short and long description

705
00:25:50,000 --> 00:25:52,159
so uh when you read threat reports you

706
00:25:52,159 --> 00:25:54,240
might see things referenced like tactic

707
00:25:54,240 --> 00:25:56,720
numbers which are the ta number

708
00:25:56,720 --> 00:25:59,440
uh and the niches of course have a name

709
00:25:59,440 --> 00:26:01,679
and then in a summary view it has a

710
00:26:01,679 --> 00:26:03,760
description

711
00:26:03,760 --> 00:26:06,880
if we open up each of those tactics

712
00:26:06,880 --> 00:26:11,039
we have much more detailed information

713
00:26:11,039 --> 00:26:12,880
in this case for persistence

714
00:26:12,880 --> 00:26:14,960
you know the summary is the adversary is

715
00:26:14,960 --> 00:26:17,039
trying to gain or to maintain their

716
00:26:17,039 --> 00:26:18,960
foothold

717
00:26:18,960 --> 00:26:20,400
but the longer one is persistence

718
00:26:20,400 --> 00:26:22,480
consists of techniques that adversaries

719
00:26:22,480 --> 00:26:25,279
use to keep access to systems across

720
00:26:25,279 --> 00:26:29,919
restarts change credentials etc etc

721
00:26:29,919 --> 00:26:31,760
the great deep the detail is very

722
00:26:31,760 --> 00:26:34,000
important for us as defenders to know

723
00:26:34,000 --> 00:26:36,720
and understand so we're better prepared

724
00:26:36,720 --> 00:26:40,159
to understand what we're looking for

725
00:26:40,880 --> 00:26:43,520
so again the top is tactics

726
00:26:43,520 --> 00:26:45,360
uh within let's take the lateral

727
00:26:45,360 --> 00:26:46,720
movement tactic

728
00:26:46,720 --> 00:26:49,279
uh these are a group of the different

729
00:26:49,279 --> 00:26:52,320
means of lateral movement within um the

730
00:26:52,320 --> 00:26:53,600
model

731
00:26:53,600 --> 00:26:55,919
so we have things like remote services

732
00:26:55,919 --> 00:26:58,000
software deployment tools replication

733
00:26:58,000 --> 00:27:00,000
through removable removable media like

734
00:27:00,000 --> 00:27:02,159
usbs

735
00:27:02,159 --> 00:27:04,640
etc etc and then as i mentioned before

736
00:27:04,640 --> 00:27:06,080
these

737
00:27:06,080 --> 00:27:07,679
uh hamburger

738
00:27:07,679 --> 00:27:10,320
icon or triple hash whatever you want to

739
00:27:10,320 --> 00:27:11,279
call it

740
00:27:11,279 --> 00:27:12,720
indicates there are sub techniques

741
00:27:12,720 --> 00:27:15,520
within each of those

742
00:27:15,919 --> 00:27:17,520
and so if you're going to dive into one

743
00:27:17,520 --> 00:27:20,240
of those in this case the command

744
00:27:20,240 --> 00:27:22,000
and scripting interpreter

745
00:27:22,000 --> 00:27:24,720
technique the techniques are the means

746
00:27:24,720 --> 00:27:26,320
by which adversaries achieve their

747
00:27:26,320 --> 00:27:27,760
tactical goals

748
00:27:27,760 --> 00:27:30,240
from the adversaries perspective not the

749
00:27:30,240 --> 00:27:31,440
defenders

750
00:27:31,440 --> 00:27:33,600
so this is the how of

751
00:27:33,600 --> 00:27:36,320
adversary performing each action

752
00:27:36,320 --> 00:27:38,399
the list of techniques may differ across

753
00:27:38,399 --> 00:27:40,159
platforms

754
00:27:40,159 --> 00:27:42,880
but they do grow and evolve over time

755
00:27:42,880 --> 00:27:46,240
and often unlike the tactics groups

756
00:27:46,240 --> 00:27:48,159
so in this case we have the command and

757
00:27:48,159 --> 00:27:50,080
scripting interpreter which in this case

758
00:27:50,080 --> 00:27:52,480
has eight sub techniques and then has

759
00:27:52,480 --> 00:27:54,799
this as its general description of that

760
00:27:54,799 --> 00:27:56,320
technique

761
00:27:56,320 --> 00:27:58,880
and so each of these blue links

762
00:27:58,880 --> 00:28:01,520
goes to a different section on um the

763
00:28:01,520 --> 00:28:03,360
attack site with information about you

764
00:28:03,360 --> 00:28:05,039
know what is commit windows command

765
00:28:05,039 --> 00:28:08,399
shell what is javascripts or jscripts

766
00:28:08,399 --> 00:28:09,440
and so

767
00:28:09,440 --> 00:28:11,600
when we're trying to redo research as

768
00:28:11,600 --> 00:28:14,240
defenders attack provides us a

769
00:28:14,240 --> 00:28:16,480
good resource for better understanding

770
00:28:16,480 --> 00:28:20,000
what the adversary is doing

771
00:28:20,240 --> 00:28:21,360
if you go

772
00:28:21,360 --> 00:28:22,559
uh like i mentioned before we have the

773
00:28:22,559 --> 00:28:24,240
sub techniques and these are more

774
00:28:24,240 --> 00:28:26,640
specific descriptions of the adversarial

775
00:28:26,640 --> 00:28:29,679
behavior used to achieve the goal

776
00:28:29,679 --> 00:28:31,279
so in the case of command and scripting

777
00:28:31,279 --> 00:28:33,600
interpreter we have different command

778
00:28:33,600 --> 00:28:36,000
scripting interpreters

779
00:28:36,000 --> 00:28:37,760
they describe the behavior at a lower

780
00:28:37,760 --> 00:28:39,919
level than a technique

781
00:28:39,919 --> 00:28:42,480
but some techniques have only a single

782
00:28:42,480 --> 00:28:45,039
technique parent so you don't have a

783
00:28:45,039 --> 00:28:47,760
many to many relationship between

784
00:28:47,760 --> 00:28:49,200
techniques and sub techniques sub

785
00:28:49,200 --> 00:28:50,960
techniques are always tied to a single

786
00:28:50,960 --> 00:28:53,120
technique

787
00:28:53,120 --> 00:28:55,279
they are often but not always platform

788
00:28:55,279 --> 00:28:57,120
specific and so this is where i

789
00:28:57,120 --> 00:28:59,520
mentioned the different

790
00:28:59,520 --> 00:29:01,679
operating systems for example you might

791
00:29:01,679 --> 00:29:02,720
have

792
00:29:02,720 --> 00:29:05,760
a way of doing um

793
00:29:05,760 --> 00:29:07,279
executing a script on windows that

794
00:29:07,279 --> 00:29:09,039
doesn't apply to linux

795
00:29:09,039 --> 00:29:10,720
and this is designed to help reduce

796
00:29:10,720 --> 00:29:13,200
changes to the techniques as new

797
00:29:13,200 --> 00:29:15,200
variation that platforms are added so

798
00:29:15,200 --> 00:29:17,360
these are intended to be very

799
00:29:17,360 --> 00:29:18,559
um

800
00:29:18,559 --> 00:29:21,039
fluctuating they know we might add them

801
00:29:21,039 --> 00:29:22,880
we might consolidate them we might break

802
00:29:22,880 --> 00:29:25,279
them apart based on

803
00:29:25,279 --> 00:29:27,120
information that comes out

804
00:29:27,120 --> 00:29:29,440
so if you look at the sub techniques for

805
00:29:29,440 --> 00:29:32,240
the command and scripting interpreter

806
00:29:32,240 --> 00:29:33,520
here's a list

807
00:29:33,520 --> 00:29:36,320
and you see they have a t number

808
00:29:36,320 --> 00:29:39,279
and then the syntax is generally the t

809
00:29:39,279 --> 00:29:42,159
number and then a sequential number

810
00:29:42,159 --> 00:29:43,360
um and so

811
00:29:43,360 --> 00:29:45,760
talking about why these are separated

812
00:29:45,760 --> 00:29:47,919
powershell only applies to windows

813
00:29:47,919 --> 00:29:50,880
applescript only applies to ios devices

814
00:29:50,880 --> 00:29:53,520
et cetera et cetera so if as a defender

815
00:29:53,520 --> 00:29:56,240
someone came to me and said well they're

816
00:29:56,240 --> 00:29:58,480
doing command and scripting interpreter

817
00:29:58,480 --> 00:30:00,399
on systems

818
00:30:00,399 --> 00:30:03,200
i wouldn't know what to look for but the

819
00:30:03,200 --> 00:30:05,520
deeper

820
00:30:06,080 --> 00:30:07,679
i'm sorry can you please minimize the

821
00:30:07,679 --> 00:30:10,159
screen

822
00:30:12,000 --> 00:30:14,480
i'm not sure which screen you are

823
00:30:14,480 --> 00:30:17,120
referring to

824
00:30:17,200 --> 00:30:18,960
your screen looks good to me

825
00:30:18,960 --> 00:30:20,840
okay

826
00:30:20,840 --> 00:30:24,960
um sorry i lost my train of thought

827
00:30:24,960 --> 00:30:26,559
um

828
00:30:26,559 --> 00:30:28,559
so yeah these are oftentimes going to be

829
00:30:28,559 --> 00:30:31,840
specific to different operating systems

830
00:30:31,840 --> 00:30:34,240
and as i mentioned the nomenclature

831
00:30:34,240 --> 00:30:35,039
is

832
00:30:35,039 --> 00:30:36,480
they have to be unique otherwise we

833
00:30:36,480 --> 00:30:39,840
can't talk about them in a common way

834
00:30:39,840 --> 00:30:42,880
uh so the techniques are labeled with t

835
00:30:42,880 --> 00:30:44,960
and then a four digit number and the sub

836
00:30:44,960 --> 00:30:46,799
techniques have the format of that

837
00:30:46,799 --> 00:30:48,559
technique number

838
00:30:48,559 --> 00:30:50,559
dot their

839
00:30:50,559 --> 00:30:52,080
sub technique number which is an

840
00:30:52,080 --> 00:30:54,320
incrementing value

841
00:30:54,320 --> 00:30:56,159
um theoretically we could get to a

842
00:30:56,159 --> 00:30:57,919
thousand we'd have a problem

843
00:30:57,919 --> 00:31:00,720
but so far we're nowhere near there

844
00:31:00,720 --> 00:31:04,240
and so for the brute force i detect text

845
00:31:04,240 --> 00:31:06,240
technique i'm sorry no sorry tech

846
00:31:06,240 --> 00:31:07,519
technique

847
00:31:07,519 --> 00:31:09,960
um id t1110

848
00:31:09,960 --> 00:31:13,029
[Music]

849
00:31:13,360 --> 00:31:16,480
um we have four different sub techniques

850
00:31:16,480 --> 00:31:18,240
and and those are labeled one two three

851
00:31:18,240 --> 00:31:20,000
four and they have different names

852
00:31:20,000 --> 00:31:21,440
and you can deep dive each of these to

853
00:31:21,440 --> 00:31:23,919
learn more

854
00:31:24,080 --> 00:31:26,000
but that's not the only thing that's in

855
00:31:26,000 --> 00:31:29,039
uh techniques they include

856
00:31:29,039 --> 00:31:30,799
a wealth of additional information that

857
00:31:30,799 --> 00:31:32,480
connects us to the rest of the attack

858
00:31:32,480 --> 00:31:33,679
model

859
00:31:33,679 --> 00:31:36,000
including arguments mitigations so how

860
00:31:36,000 --> 00:31:37,840
can i prevent that technique from

861
00:31:37,840 --> 00:31:39,200
occurring

862
00:31:39,200 --> 00:31:40,960
uh data sources

863
00:31:40,960 --> 00:31:43,679
so what data sources can i use to detect

864
00:31:43,679 --> 00:31:46,000
that technique and what detection

865
00:31:46,000 --> 00:31:50,320
methods might i use to identify it

866
00:31:50,320 --> 00:31:52,080
uh what procedures

867
00:31:52,080 --> 00:31:54,640
are used so this would be starting

868
00:31:54,640 --> 00:31:58,880
bridge that gap between ttps and iocs

869
00:31:58,880 --> 00:32:02,159
so this is very specific implementations

870
00:32:02,159 --> 00:32:05,440
of how each technique is being done

871
00:32:05,440 --> 00:32:09,360
so in this case we have apt 41

872
00:32:09,360 --> 00:32:11,039
doing

873
00:32:11,039 --> 00:32:14,240
executing file bin password and

874
00:32:14,240 --> 00:32:16,159
exploiting this specific cv against

875
00:32:16,159 --> 00:32:17,600
citrix devices

876
00:32:17,600 --> 00:32:20,799
so this is a very very specific

877
00:32:20,799 --> 00:32:24,240
implementation of a technique

878
00:32:25,519 --> 00:32:27,679
if we look at the technique page as a

879
00:32:27,679 --> 00:32:28,720
whole

880
00:32:28,720 --> 00:32:30,799
i believe this

881
00:32:30,799 --> 00:32:33,440
this is a sub technique i'm sorry

882
00:32:33,440 --> 00:32:34,960
it contains

883
00:32:34,960 --> 00:32:37,200
all that information in a pretty

884
00:32:37,200 --> 00:32:39,200
consolidated view

885
00:32:39,200 --> 00:32:40,799
so we have

886
00:32:40,799 --> 00:32:42,720
the high level description

887
00:32:42,720 --> 00:32:44,960
we have some of the

888
00:32:44,960 --> 00:32:47,679
summarized information about it in tags

889
00:32:47,679 --> 00:32:49,440
things like contributors on are included

890
00:32:49,440 --> 00:32:51,440
in here as well

891
00:32:51,440 --> 00:32:54,000
we have specific procedure examples so

892
00:32:54,000 --> 00:32:55,760
we talked about the mitigations and the

893
00:32:55,760 --> 00:32:58,399
detections

894
00:32:58,880 --> 00:33:01,279
so for the mitigations in this case

895
00:33:01,279 --> 00:33:02,320
um

896
00:33:02,320 --> 00:33:04,799
on the operating system configuration uh

897
00:33:04,799 --> 00:33:06,480
you might be able to ensure only that

898
00:33:06,480 --> 00:33:08,320
password filters are registered in this

899
00:33:08,320 --> 00:33:10,000
case we're talking about password filter

900
00:33:10,000 --> 00:33:14,640
dll usage we're getting credentials

901
00:33:15,120 --> 00:33:17,600
uh so mitigations are configurations

902
00:33:17,600 --> 00:33:19,840
tools or processes that can prevent a

903
00:33:19,840 --> 00:33:21,519
technique from working or having the

904
00:33:21,519 --> 00:33:25,120
desired outcome for an adversary

905
00:33:25,120 --> 00:33:26,960
they're intended to allow you to take an

906
00:33:26,960 --> 00:33:28,399
action such as changing a policy or

907
00:33:28,399 --> 00:33:30,399
deploying a tool with the purpose of

908
00:33:30,399 --> 00:33:33,440
stopping those adversaries and so the

909
00:33:33,440 --> 00:33:36,720
big distinction here is mitigations help

910
00:33:36,720 --> 00:33:38,720
stop activity detections help you

911
00:33:38,720 --> 00:33:42,000
identify when activity occurs generally

912
00:33:42,000 --> 00:33:45,360
you could use detections to then

913
00:33:45,360 --> 00:33:48,320
implement mitigations that's a little

914
00:33:48,320 --> 00:33:50,240
beyond the scope of this

915
00:33:50,240 --> 00:33:53,240
course

916
00:33:53,279 --> 00:33:54,080
so

917
00:33:54,080 --> 00:33:54,960
um

918
00:33:54,960 --> 00:33:56,320
this is all

919
00:33:56,320 --> 00:33:58,159
a pop a populated example from a

920
00:33:58,159 --> 00:34:00,399
technique page of different mitigations

921
00:34:00,399 --> 00:34:01,279
so

922
00:34:01,279 --> 00:34:03,360
from an anti-virus or anti-malware

923
00:34:03,360 --> 00:34:04,720
perspective

924
00:34:04,720 --> 00:34:06,240
you can use it to automatically

925
00:34:06,240 --> 00:34:08,560
quarantine suspicious files

926
00:34:08,560 --> 00:34:09,918
you might from a code signing

927
00:34:09,918 --> 00:34:12,399
perspective if you have code signing

928
00:34:12,399 --> 00:34:13,760
soft software that checks for code

929
00:34:13,760 --> 00:34:15,359
signing or things like that

930
00:34:15,359 --> 00:34:17,119
you only permit execution of sign

931
00:34:17,119 --> 00:34:19,520
scripts versus unsigned

932
00:34:19,520 --> 00:34:21,679
and so on and so forth so

933
00:34:21,679 --> 00:34:23,440
you might look at this like okay we we

934
00:34:23,440 --> 00:34:25,199
do have antivirus so let's figure out

935
00:34:25,199 --> 00:34:26,560
how we can solve this problem through

936
00:34:26,560 --> 00:34:28,800
antivirus or empty malware

937
00:34:28,800 --> 00:34:31,040
or no we have that but it's not working

938
00:34:31,040 --> 00:34:33,760
so what else can we do maybe we can stop

939
00:34:33,760 --> 00:34:36,320
its execution or we maybe we need to

940
00:34:36,320 --> 00:34:38,639
better manage our privilege account

941
00:34:38,639 --> 00:34:40,399
usage

942
00:34:40,399 --> 00:34:42,000
and so you can use this and start

943
00:34:42,000 --> 00:34:43,119
looking at different options from

944
00:34:43,119 --> 00:34:45,599
mitigating

945
00:34:45,679 --> 00:34:47,520
in case it's example remove a feature

946
00:34:47,520 --> 00:34:48,719
program

947
00:34:48,719 --> 00:34:51,359
we can dive into that and then has

948
00:34:51,359 --> 00:34:54,239
some information about how to do that

949
00:34:54,239 --> 00:34:55,679
and so we

950
00:34:55,679 --> 00:34:57,839
dive down all the way from a tactic to a

951
00:34:57,839 --> 00:35:00,000
technique to a sub technique to

952
00:35:00,000 --> 00:35:01,280
mitigation

953
00:35:01,280 --> 00:35:04,000
to a very concrete thing you can do

954
00:35:04,000 --> 00:35:05,680
about that

955
00:35:05,680 --> 00:35:07,760
which i think is very powerful and it's

956
00:35:07,760 --> 00:35:11,359
all done in the same framework

957
00:35:12,800 --> 00:35:16,079
and then within there's each mitigation

958
00:35:16,079 --> 00:35:18,000
you also have well what else does that

959
00:35:18,000 --> 00:35:19,680
mitigation apply to

960
00:35:19,680 --> 00:35:22,079
so this specific mitigation doesn't

961
00:35:22,079 --> 00:35:23,680
necessarily just apply to that one

962
00:35:23,680 --> 00:35:25,280
technique it might apply to many

963
00:35:25,280 --> 00:35:26,640
techniques

964
00:35:26,640 --> 00:35:27,920
and so you now you're starting to come

965
00:35:27,920 --> 00:35:29,440
all the way back out out of the

966
00:35:29,440 --> 00:35:31,280
mitigation like okay well if i do this

967
00:35:31,280 --> 00:35:33,680
what else is it possibly going to affect

968
00:35:33,680 --> 00:35:34,800
and so you might when you're

969
00:35:34,800 --> 00:35:37,599
prioritizing mitigations look at okay

970
00:35:37,599 --> 00:35:39,359
which mitigation

971
00:35:39,359 --> 00:35:42,160
does the most for me

972
00:35:42,160 --> 00:35:44,000
now which one i've cup

973
00:35:44,000 --> 00:35:45,680
addresses the most techniques or sub

974
00:35:45,680 --> 00:35:48,078
techniques

975
00:35:49,680 --> 00:35:52,720
so looking at data sources

976
00:35:52,720 --> 00:35:54,640
uh and detection so the data sources

977
00:35:54,640 --> 00:35:56,800
really will often inform the detection

978
00:35:56,800 --> 00:35:59,040
that data sources help inform how you do

979
00:35:59,040 --> 00:36:01,520
that detection

980
00:36:01,520 --> 00:36:04,079
um historically impress past versions of

981
00:36:04,079 --> 00:36:05,200
attack

982
00:36:05,200 --> 00:36:06,640
data sources look more like this they're

983
00:36:06,640 --> 00:36:09,359
very high level descriptions of things

984
00:36:09,359 --> 00:36:10,960
you might look for

985
00:36:10,960 --> 00:36:13,119
uh but in more recent release releases

986
00:36:13,119 --> 00:36:15,359
since last year i believe

987
00:36:15,359 --> 00:36:17,680
uh we started to expand it to be much

988
00:36:17,680 --> 00:36:19,119
more granular

989
00:36:19,119 --> 00:36:21,119
so we as defenders have a better idea of

990
00:36:21,119 --> 00:36:23,680
what we're really trying to look for

991
00:36:23,680 --> 00:36:25,760
so in this case is we're looking at

992
00:36:25,760 --> 00:36:28,800
things like file file creation events so

993
00:36:28,800 --> 00:36:30,160
what are the things you do with files

994
00:36:30,160 --> 00:36:32,000
well you can create them so we're gonna

995
00:36:32,000 --> 00:36:33,760
look for file creation specifically

996
00:36:33,760 --> 00:36:35,599
versus things like

997
00:36:35,599 --> 00:36:40,119
file modifications or file deletions

998
00:36:40,880 --> 00:36:43,280
and so data sources are sources of

999
00:36:43,280 --> 00:36:45,200
information collected by a sensor or

1000
00:36:45,200 --> 00:36:46,960
logging system so oftentimes this is

1001
00:36:46,960 --> 00:36:48,240
what you'll see

1002
00:36:48,240 --> 00:36:50,160
when you're looking in a seam

1003
00:36:50,160 --> 00:36:52,240
or doing perhaps forensics is you're

1004
00:36:52,240 --> 00:36:55,119
collecting data sources uh for info for

1005
00:36:55,119 --> 00:36:57,359
data to then turn that into information

1006
00:36:57,359 --> 00:36:59,760
about what the advertiser is doing

1007
00:36:59,760 --> 00:37:01,280
so use that like i said to collect

1008
00:37:01,280 --> 00:37:02,960
information relevant to identifying

1009
00:37:02,960 --> 00:37:04,720
adversary actions

1010
00:37:04,720 --> 00:37:08,160
and this is the where to collect data

1011
00:37:08,160 --> 00:37:10,800
and as of a tag version 9

1012
00:37:10,800 --> 00:37:12,960
as i'm just talking about data sources

1013
00:37:12,960 --> 00:37:15,440
also include data components to further

1014
00:37:15,440 --> 00:37:17,359
define data requirements so we're not

1015
00:37:17,359 --> 00:37:19,119
saying things like process anymore we're

1016
00:37:19,119 --> 00:37:20,839
talking about process

1017
00:37:20,839 --> 00:37:23,440
creation and then we can tie process

1018
00:37:23,440 --> 00:37:26,160
creation to specific data sources like

1019
00:37:26,160 --> 00:37:27,200
sysmon

1020
00:37:27,200 --> 00:37:29,920
so okay so if i want to collect

1021
00:37:29,920 --> 00:37:31,200
i need to collect process creation

1022
00:37:31,200 --> 00:37:33,359
events for this technique how can i do

1023
00:37:33,359 --> 00:37:35,119
that well i can do a cismod event code

1024
00:37:35,119 --> 00:37:38,000
one and now i have a whole chain

1025
00:37:38,000 --> 00:37:40,880
of who what the rest people are doing

1026
00:37:40,880 --> 00:37:43,119
how they're doing it what can i use to

1027
00:37:43,119 --> 00:37:45,119
detect it and then actually getting to

1028
00:37:45,119 --> 00:37:47,359
implementing that on the system

1029
00:37:47,359 --> 00:37:49,599
and this is the github repository where

1030
00:37:49,599 --> 00:37:52,800
that information is stored

1031
00:37:54,240 --> 00:37:56,160
and so you can see here sort of that

1032
00:37:56,160 --> 00:37:57,599
connection that i was just talking about

1033
00:37:57,599 --> 00:38:00,000
so for this specific sub technique of

1034
00:38:00,000 --> 00:38:03,520
credential dumping via lsas memory

1035
00:38:03,520 --> 00:38:06,000
there's three different ways we can look

1036
00:38:06,000 --> 00:38:07,520
at that from a process perspective and

1037
00:38:07,520 --> 00:38:09,760
this is why we had to break it out

1038
00:38:09,760 --> 00:38:11,520
you can do it from a process access

1039
00:38:11,520 --> 00:38:13,680
level you can do it from a process

1040
00:38:13,680 --> 00:38:16,960
operating system api execution level

1041
00:38:16,960 --> 00:38:17,760
or

1042
00:38:17,760 --> 00:38:19,760
a process creation level

1043
00:38:19,760 --> 00:38:21,520
so from across this creation level you

1044
00:38:21,520 --> 00:38:22,880
might be looking at

1045
00:38:22,880 --> 00:38:25,520
they ran mimikats

1046
00:38:25,520 --> 00:38:27,119
from the process access you might be

1047
00:38:27,119 --> 00:38:28,960
looking at well which

1048
00:38:28,960 --> 00:38:30,960
processes are actually accessing that

1049
00:38:30,960 --> 00:38:32,800
memory space

1050
00:38:32,800 --> 00:38:35,200
and then api execution which apis are

1051
00:38:35,200 --> 00:38:36,720
actually executed as part of that

1052
00:38:36,720 --> 00:38:39,118
process

1053
00:38:41,760 --> 00:38:44,160
so well now how we

1054
00:38:44,160 --> 00:38:45,680
got to use those data sources for

1055
00:38:45,680 --> 00:38:47,599
actually building detections

1056
00:38:47,599 --> 00:38:49,200
um oftentimes

1057
00:38:49,200 --> 00:38:50,320
when we're talking as we're talking

1058
00:38:50,320 --> 00:38:52,720
about analytics so high-level analytic

1059
00:38:52,720 --> 00:38:53,760
processes

1060
00:38:53,760 --> 00:38:56,400
sensors data and detection strategies

1061
00:38:56,400 --> 00:38:58,720
analytics are just a part of that

1062
00:38:58,720 --> 00:39:00,560
they're useful to identify a technique

1063
00:39:00,560 --> 00:39:02,880
that has been used by an adversary so

1064
00:39:02,880 --> 00:39:05,040
this is how to interpret the collective

1065
00:39:05,040 --> 00:39:07,440
data so okay we're sucking in all this

1066
00:39:07,440 --> 00:39:09,520
information but then what do we do with

1067
00:39:09,520 --> 00:39:11,119
it you know just having it doesn't get

1068
00:39:11,119 --> 00:39:14,079
us anywhere

1069
00:39:14,079 --> 00:39:16,560
so if we take the example of

1070
00:39:16,560 --> 00:39:18,800
the lsat's memory access

1071
00:39:18,800 --> 00:39:21,040
we have lots of data sources and we have

1072
00:39:21,040 --> 00:39:23,599
a lot of different detection options but

1073
00:39:23,599 --> 00:39:25,839
then how they tie together

1074
00:39:25,839 --> 00:39:27,760
so um this

1075
00:39:27,760 --> 00:39:29,920
this command command execution really

1076
00:39:29,920 --> 00:39:32,400
addresses this or can be used for this

1077
00:39:32,400 --> 00:39:34,480
specific detection

1078
00:39:34,480 --> 00:39:36,240
process creation

1079
00:39:36,240 --> 00:39:37,680
is this one

1080
00:39:37,680 --> 00:39:39,520
and then the os

1081
00:39:39,520 --> 00:39:43,119
os api execution and process access is

1082
00:39:43,119 --> 00:39:45,359
sort of found up here

1083
00:39:45,359 --> 00:39:46,079
so

1084
00:39:46,079 --> 00:39:47,920
um reading these sites sort of start

1085
00:39:47,920 --> 00:39:50,240
seeing how they're all tied together

1086
00:39:50,240 --> 00:39:52,079
so it's not just well go look at process

1087
00:39:52,079 --> 00:39:53,200
creation but

1088
00:39:53,200 --> 00:39:54,960
what do you what are you looking for in

1089
00:39:54,960 --> 00:39:56,640
process creation

1090
00:39:56,640 --> 00:39:58,079
in this case

1091
00:39:58,079 --> 00:40:00,079
looking at things like mimi cats or

1092
00:40:00,079 --> 00:40:02,880
other uh remote tools or access tools

1093
00:40:02,880 --> 00:40:05,920
that you know use it

1094
00:40:06,319 --> 00:40:09,839
then diving into procedure examples

1095
00:40:09,839 --> 00:40:11,839
these are going to be things like

1096
00:40:11,839 --> 00:40:15,599
groups or tools that use it

1097
00:40:15,599 --> 00:40:17,359
so the procedures are specific

1098
00:40:17,359 --> 00:40:19,520
implementations the advertiser uses for

1099
00:40:19,520 --> 00:40:21,599
techniques or sub techniques

1100
00:40:21,599 --> 00:40:23,680
and these are populated on in technique

1101
00:40:23,680 --> 00:40:26,880
pages as well as groups and on the

1102
00:40:26,880 --> 00:40:29,119
software pages and they describe the

1103
00:40:29,119 --> 00:40:31,760
group or software entities with a brief

1104
00:40:31,760 --> 00:40:33,359
description of how that technique is

1105
00:40:33,359 --> 00:40:34,480
used

1106
00:40:34,480 --> 00:40:38,400
so we have here things like apt-38

1107
00:40:38,400 --> 00:40:41,119
is using that uses the hermes ransomware

1108
00:40:41,119 --> 00:40:44,079
to include files with aes26

1109
00:40:44,079 --> 00:40:45,920
which is different than maybe what jkry

1110
00:40:45,920 --> 00:40:47,839
does which is they encrypt files and

1111
00:40:47,839 --> 00:40:51,119
demand bitcoin to decrypt those files

1112
00:40:51,119 --> 00:40:52,240
and so that's why we have to have

1113
00:40:52,240 --> 00:40:54,160
different

1114
00:40:54,160 --> 00:40:56,800
implementations or procedures for how

1115
00:40:56,800 --> 00:40:58,240
different adversaries use different

1116
00:40:58,240 --> 00:40:59,520
techniques because they're not going to

1117
00:40:59,520 --> 00:41:02,319
always be the same

1118
00:41:02,319 --> 00:41:04,480
so let's take apt-38 as example which is

1119
00:41:04,480 --> 00:41:06,240
a group

1120
00:41:06,240 --> 00:41:08,400
groups are related intrusion activity

1121
00:41:08,400 --> 00:41:10,720
that are tracked by common name

1122
00:41:10,720 --> 00:41:12,400
and some groups have multiple names

1123
00:41:12,400 --> 00:41:15,599
associated with similar activities

1124
00:41:15,599 --> 00:41:17,839
so in the case of apt-1

1125
00:41:17,839 --> 00:41:19,760
apt-1 is a chinese threat group that has

1126
00:41:19,760 --> 00:41:21,520
been attributed to the second bureau of

1127
00:41:21,520 --> 00:41:22,560
the

1128
00:41:22,560 --> 00:41:24,880
pla general staff department's third

1129
00:41:24,880 --> 00:41:26,800
department commonly known as the

1130
00:41:26,800 --> 00:41:30,000
military unit covered designator as unit

1131
00:41:30,000 --> 00:41:32,079
61398

1132
00:41:32,079 --> 00:41:34,720
they also have other names uh such as

1133
00:41:34,720 --> 00:41:36,880
comment crew comment group comma panda

1134
00:41:36,880 --> 00:41:38,240
etc

1135
00:41:38,240 --> 00:41:41,200
now the challenge here is that different

1136
00:41:41,200 --> 00:41:43,599
cyber threat intelligence providers have

1137
00:41:43,599 --> 00:41:44,880
different names

1138
00:41:44,880 --> 00:41:46,319
and they have different ways of

1139
00:41:46,319 --> 00:41:48,880
organizing groups and so within attack

1140
00:41:48,880 --> 00:41:50,560
we do our best

1141
00:41:50,560 --> 00:41:52,560
to try and consolidate them into what we

1142
00:41:52,560 --> 00:41:54,400
think is the best fit

1143
00:41:54,400 --> 00:41:55,680
but there's

1144
00:41:55,680 --> 00:41:57,280
some debate about you know where the

1145
00:41:57,280 --> 00:42:00,960
lines between different groups are

1146
00:42:01,680 --> 00:42:03,200
uh but these are all these are not going

1147
00:42:03,200 --> 00:42:04,880
to be based on sort of our names these

1148
00:42:04,880 --> 00:42:06,000
are going to be based on what the

1149
00:42:06,000 --> 00:42:07,920
community thinks uh their naming scheme

1150
00:42:07,920 --> 00:42:09,040
is

1151
00:42:09,040 --> 00:42:10,960
and then the alternative to that as we

1152
00:42:10,960 --> 00:42:12,800
talked about is the software

1153
00:42:12,800 --> 00:42:14,640
where the tools are malware used by an

1154
00:42:14,640 --> 00:42:16,960
adversary during intrusions

1155
00:42:16,960 --> 00:42:17,920
and again

1156
00:42:17,920 --> 00:42:19,920
some entries might have multiple names

1157
00:42:19,920 --> 00:42:23,920
so plug x which is a rat may also go by

1158
00:42:23,920 --> 00:42:28,240
destroy rat sogu cabba or core plug

1159
00:42:28,240 --> 00:42:30,000
perhaps depending on which uh threat

1160
00:42:30,000 --> 00:42:32,240
group uses it

1161
00:42:32,240 --> 00:42:35,520
and we try to capture that as well

1162
00:42:35,599 --> 00:42:38,560
uh so we take apg-38 as an example which

1163
00:42:38,560 --> 00:42:41,760
has been attributed to north korea

1164
00:42:41,760 --> 00:42:43,280
this is their

1165
00:42:43,280 --> 00:42:46,240
high level description of what they are

1166
00:42:46,240 --> 00:42:48,079
these are the techniques they all they

1167
00:42:48,079 --> 00:42:49,760
use

1168
00:42:49,760 --> 00:42:51,599
this is a software they're known to use

1169
00:42:51,599 --> 00:42:54,160
along with the techniques that software

1170
00:42:54,160 --> 00:42:57,118
is known to implement

1171
00:42:57,599 --> 00:43:00,319
so we had a lot of information just for

1172
00:43:00,319 --> 00:43:03,359
that one group uh on their page

1173
00:43:03,359 --> 00:43:06,640
too much to fit on one side

1174
00:43:07,119 --> 00:43:09,280
so that's the the high level description

1175
00:43:09,280 --> 00:43:11,920
of all the contents of attack

1176
00:43:11,920 --> 00:43:14,720
so but attack is a living framework so

1177
00:43:14,720 --> 00:43:16,720
what i just went over is subject to

1178
00:43:16,720 --> 00:43:17,760
change

1179
00:43:17,760 --> 00:43:19,520
so adversaries malware and behaviors

1180
00:43:19,520 --> 00:43:21,599
evolve every day

1181
00:43:21,599 --> 00:43:23,040
techniques groups and software are

1182
00:43:23,040 --> 00:43:25,280
designed to be added deleted or enhanced

1183
00:43:25,280 --> 00:43:27,520
as needed so we built the framework to

1184
00:43:27,520 --> 00:43:28,880
be flexible

1185
00:43:28,880 --> 00:43:31,200
uh to what the current state

1186
00:43:31,200 --> 00:43:32,880
of things are in

1187
00:43:32,880 --> 00:43:35,520
our community

1188
00:43:35,520 --> 00:43:37,359
but we need a process for vetting and

1189
00:43:37,359 --> 00:43:39,359
modifying content

1190
00:43:39,359 --> 00:43:41,920
we can't just open it up to everybody

1191
00:43:41,920 --> 00:43:45,359
and say add whatever you want because

1192
00:43:45,359 --> 00:43:47,280
it would just be chaos not to mention

1193
00:43:47,280 --> 00:43:49,520
people possibly trying to spoil it or

1194
00:43:49,520 --> 00:43:52,560
ruin the fair for other people so we are

1195
00:43:52,560 --> 00:43:54,880
the curators of the framework

1196
00:43:54,880 --> 00:43:56,480
although we like i said before we take

1197
00:43:56,480 --> 00:43:58,400
community contributions

1198
00:43:58,400 --> 00:44:00,640
um and we don't want to include just

1199
00:44:00,640 --> 00:44:02,000
everything that may theoretically be

1200
00:44:02,000 --> 00:44:03,520
possible we want to keep it grounded in

1201
00:44:03,520 --> 00:44:06,640
what people are actually seeing

1202
00:44:06,640 --> 00:44:08,800
and so that's why we want to keep it

1203
00:44:08,800 --> 00:44:13,119
grounded in real adversary usage

1204
00:44:13,440 --> 00:44:14,160
so

1205
00:44:14,160 --> 00:44:15,680
talk a little about the history of how

1206
00:44:15,680 --> 00:44:17,839
it's evolved and changed

1207
00:44:17,839 --> 00:44:19,359
uh this is what it looked like in the

1208
00:44:19,359 --> 00:44:22,880
first release back in around 2014.

1209
00:44:22,880 --> 00:44:24,960
you see there's only eight techniques

1210
00:44:24,960 --> 00:44:26,880
versus the 14 now

1211
00:44:26,880 --> 00:44:31,200
and significantly less uh techniques

1212
00:44:31,200 --> 00:44:33,920
you know it all it fits legibly on one

1213
00:44:33,920 --> 00:44:34,880
slot

1214
00:44:34,880 --> 00:44:36,880
which was nice at the time

1215
00:44:36,880 --> 00:44:37,599
but

1216
00:44:37,599 --> 00:44:40,000
as research has continued and as our

1217
00:44:40,000 --> 00:44:42,400
awareness of techniques has changed uh

1218
00:44:42,400 --> 00:44:46,640
we've greatly expanded um the model

1219
00:44:46,640 --> 00:44:49,119
and so now we're here i see that's

1220
00:44:49,119 --> 00:44:52,079
significantly larger

1221
00:44:52,960 --> 00:44:55,760
and we hope that um

1222
00:44:55,760 --> 00:44:59,440
this is better addresses this ttp

1223
00:44:59,440 --> 00:45:00,560
part of

1224
00:45:00,560 --> 00:45:02,319
the pyramid whereas before

1225
00:45:02,319 --> 00:45:05,839
we had some things were very specific

1226
00:45:05,839 --> 00:45:06,880
like

1227
00:45:06,880 --> 00:45:09,440
at um this is now it's called schedule

1228
00:45:09,440 --> 00:45:10,560
tasks

1229
00:45:10,560 --> 00:45:13,200
uh which encapsulates different specific

1230
00:45:13,200 --> 00:45:14,800
procedures

1231
00:45:14,800 --> 00:45:17,040
or implementations of

1232
00:45:17,040 --> 00:45:19,839
that technique

1233
00:45:20,240 --> 00:45:21,599
and so you can see a scheduled task up

1234
00:45:21,599 --> 00:45:23,280
here which now crosses three tactics

1235
00:45:23,280 --> 00:45:24,880
groups as well so that's kind of shows

1236
00:45:24,880 --> 00:45:25,599
you

1237
00:45:25,599 --> 00:45:30,000
the way the model has evolved over time

1238
00:45:30,400 --> 00:45:32,720
so how do we track all these changes

1239
00:45:32,720 --> 00:45:35,040
um and how often do we do it uh so

1240
00:45:35,040 --> 00:45:37,599
roughly we have a bi-annual schedule

1241
00:45:37,599 --> 00:45:39,200
it's not a hard schedule it's not like

1242
00:45:39,200 --> 00:45:40,720
we have to release it on a specific

1243
00:45:40,720 --> 00:45:41,920
certain day

1244
00:45:41,920 --> 00:45:43,520
but we aim for

1245
00:45:43,520 --> 00:45:44,839
around twice a

1246
00:45:44,839 --> 00:45:48,079
year the attack website is structured in

1247
00:45:48,079 --> 00:45:49,599
sticks or the structured threat

1248
00:45:49,599 --> 00:45:52,720
information expression

1249
00:45:52,720 --> 00:45:55,359
um unfortunately the attack defend

1250
00:45:55,359 --> 00:45:58,960
framework is outside the scope of

1251
00:45:58,960 --> 00:46:00,720
this course

1252
00:46:00,720 --> 00:46:03,119
um i believe there is

1253
00:46:03,119 --> 00:46:04,960
i'm trying to remember if there's course

1254
00:46:04,960 --> 00:46:06,960
released on under mad

1255
00:46:06,960 --> 00:46:08,560
as well

1256
00:46:08,560 --> 00:46:11,520
but we do have other trainings available

1257
00:46:11,520 --> 00:46:15,839
we do for attack defender i believe

1258
00:46:17,040 --> 00:46:19,359
and they yes the size will be shared

1259
00:46:19,359 --> 00:46:21,680
later

1260
00:46:21,920 --> 00:46:22,720
um

1261
00:46:22,720 --> 00:46:25,119
so sticks is a

1262
00:46:25,119 --> 00:46:27,680
also another framework we use for

1263
00:46:27,680 --> 00:46:28,960
sharing

1264
00:46:28,960 --> 00:46:30,960
information or thread information

1265
00:46:30,960 --> 00:46:32,720
between groups so

1266
00:46:32,720 --> 00:46:34,640
it provides a way for different

1267
00:46:34,640 --> 00:46:36,720
organizations to share a computer

1268
00:46:36,720 --> 00:46:38,400
understandable

1269
00:46:38,400 --> 00:46:39,920
interpretation of things like

1270
00:46:39,920 --> 00:46:42,880
compromises or campaigns

1271
00:46:42,880 --> 00:46:44,960
and we also keep the updated logs on the

1272
00:46:44,960 --> 00:46:46,240
website as well so you can see what

1273
00:46:46,240 --> 00:46:49,280
changes between different releases

1274
00:46:49,280 --> 00:46:51,200
so you see here an example from last

1275
00:46:51,200 --> 00:46:52,240
year

1276
00:46:52,240 --> 00:46:55,200
what changed in version 8

1277
00:46:55,200 --> 00:46:56,720
and sort of what its state was 14

1278
00:46:56,720 --> 00:47:00,160
tactics 177 techniques 348 sub

1279
00:47:00,160 --> 00:47:02,640
techniques

1280
00:47:05,520 --> 00:47:07,280
and so this is what the uh

1281
00:47:07,280 --> 00:47:09,280
tracking looks like across the different

1282
00:47:09,280 --> 00:47:11,920
versions uh the very old versions the

1283
00:47:11,920 --> 00:47:13,520
version one and two

1284
00:47:13,520 --> 00:47:16,000
uh are not in the styx format of fortune

1285
00:47:16,000 --> 00:47:19,200
they were originally done in mediawiki

1286
00:47:19,200 --> 00:47:21,440
and so they are not preserved on the

1287
00:47:21,440 --> 00:47:24,440
site

1288
00:47:25,599 --> 00:47:27,839
uh but how do we contribute to attack uh

1289
00:47:27,839 --> 00:47:29,760
so as you may remember may have noticed

1290
00:47:29,760 --> 00:47:32,240
on the technique screen we had a list of

1291
00:47:32,240 --> 00:47:33,520
the contributors

1292
00:47:33,520 --> 00:47:36,000
uh that helped uh with that technique or

1293
00:47:36,000 --> 00:47:38,640
the tactic or tool whatever

1294
00:47:38,640 --> 00:47:40,640
we try our best to keep up

1295
00:47:40,640 --> 00:47:42,400
ourselves but

1296
00:47:42,400 --> 00:47:43,839
if it's too much

1297
00:47:43,839 --> 00:47:45,680
uh for us to do

1298
00:47:45,680 --> 00:47:46,880
alone

1299
00:47:46,880 --> 00:47:49,760
we're not that big a team really

1300
00:47:49,760 --> 00:47:51,520
so we rely on the community to help give

1301
00:47:51,520 --> 00:47:53,520
us information and provide

1302
00:47:53,520 --> 00:47:55,040
feedback

1303
00:47:55,040 --> 00:47:58,160
so at that link we have how you can some

1304
00:47:58,160 --> 00:47:59,680
guidance for how you can contribute if

1305
00:47:59,680 --> 00:48:02,400
you want to and some examples

1306
00:48:02,400 --> 00:48:04,319
and we credit you

1307
00:48:04,319 --> 00:48:06,000
unless you supposed to ask not to be

1308
00:48:06,000 --> 00:48:07,599
credited and perhaps you don't feel

1309
00:48:07,599 --> 00:48:09,440
comfortable uh with your name being on

1310
00:48:09,440 --> 00:48:11,280
the site that's okay you don't have to

1311
00:48:11,280 --> 00:48:12,319
include you

1312
00:48:12,319 --> 00:48:14,079
uh but feel free to email us at

1313
00:48:14,079 --> 00:48:16,480
attack.mitre.org

1314
00:48:16,480 --> 00:48:20,280
if you have an idea

1315
00:48:20,559 --> 00:48:23,119
uh some more links uh here is the attack

1316
00:48:23,119 --> 00:48:26,079
website it's attack.miter.org

1317
00:48:26,079 --> 00:48:28,000
um we also have a couple of documents

1318
00:48:28,000 --> 00:48:29,760
capturing the philosophy behind attack

1319
00:48:29,760 --> 00:48:31,359
and how to get started

1320
00:48:31,359 --> 00:48:35,558
uh and those are here as well

1321
00:48:36,640 --> 00:48:38,480
uh so with that we've been going for

1322
00:48:38,480 --> 00:48:41,119
about an hour so i would say we can take

1323
00:48:41,119 --> 00:48:45,440
a seven minute break and reconvene

1324
00:48:47,280 --> 00:48:49,359
okay so we're gonna move into section

1325
00:48:49,359 --> 00:48:51,839
two now which is the benefits of using

1326
00:48:51,839 --> 00:48:53,040
attack so

1327
00:48:53,040 --> 00:48:55,520
by now we should have a pretty good idea

1328
00:48:55,520 --> 00:48:58,319
of what attack is you know what it looks

1329
00:48:58,319 --> 00:48:59,920
like what are the parts and pieces how

1330
00:48:59,920 --> 00:49:01,359
they fit together

1331
00:49:01,359 --> 00:49:02,800
so now we're gonna start talking about

1332
00:49:02,800 --> 00:49:05,839
how to actually start using it

1333
00:49:05,839 --> 00:49:09,040
or why we want to use it

1334
00:49:09,359 --> 00:49:10,559
so

1335
00:49:10,559 --> 00:49:12,880
uh again this is a but sort of the same

1336
00:49:12,880 --> 00:49:14,319
view you've seen before but a little bit

1337
00:49:14,319 --> 00:49:16,720
different so now we have

1338
00:49:16,720 --> 00:49:18,670
um if we're operating a different team

1339
00:49:18,670 --> 00:49:19,839
[Music]

1340
00:49:19,839 --> 00:49:21,200
we have different people in the team and

1341
00:49:21,200 --> 00:49:22,720
we have you know maybe different ways of

1342
00:49:22,720 --> 00:49:24,880
noting things down on the framework

1343
00:49:24,880 --> 00:49:27,599
uh but how does that help us

1344
00:49:27,599 --> 00:49:28,559
so

1345
00:49:28,559 --> 00:49:31,040
um in this case we have boot or long

1346
00:49:31,040 --> 00:49:33,359
auto start execution and those sub

1347
00:49:33,359 --> 00:49:35,119
techniques

1348
00:49:35,119 --> 00:49:36,800
uh but we as

1349
00:49:36,800 --> 00:49:38,640
the cyber threat intelligence team say

1350
00:49:38,640 --> 00:49:40,079
something like this is what the

1351
00:49:40,079 --> 00:49:41,760
adversary is doing

1352
00:49:41,760 --> 00:49:44,960
um and they're using the run key uh is

1353
00:49:44,960 --> 00:49:46,960
adobe updater

1354
00:49:46,960 --> 00:49:48,319
and then

1355
00:49:48,319 --> 00:49:51,680
us as the cyber defense team or the

1356
00:49:51,680 --> 00:49:54,160
network defenders or sock analysts

1357
00:49:54,160 --> 00:49:56,400
whatever your role or position is like

1358
00:49:56,400 --> 00:49:58,960
oh we have registry data we can look for

1359
00:49:58,960 --> 00:50:00,400
that

1360
00:50:00,400 --> 00:50:01,359
and so

1361
00:50:01,359 --> 00:50:03,119
this

1362
00:50:03,119 --> 00:50:06,720
one entry in attack can be shared

1363
00:50:06,720 --> 00:50:09,040
between those two teams

1364
00:50:09,040 --> 00:50:11,760
as a common language so that's why this

1365
00:50:11,760 --> 00:50:14,079
is such a beneficial

1366
00:50:14,079 --> 00:50:17,599
thing and doesn't just extend to cti and

1367
00:50:17,599 --> 00:50:20,160
stock analysts but also other teams and

1368
00:50:20,160 --> 00:50:21,200
groups

1369
00:50:21,200 --> 00:50:25,200
associated with uh cyber security

1370
00:50:25,280 --> 00:50:27,359
so attack is

1371
00:50:27,359 --> 00:50:30,319
is a team effort and the framework is

1372
00:50:30,319 --> 00:50:32,559
cleverly built from publicly available

1373
00:50:32,559 --> 00:50:34,240
reporting and documentation

1374
00:50:34,240 --> 00:50:36,640
uh so that can be from cty analysts or

1375
00:50:36,640 --> 00:50:37,520
from

1376
00:50:37,520 --> 00:50:39,760
uh defenders so you might have cti and

1377
00:50:39,760 --> 00:50:42,720
contribute more towards the usage of

1378
00:50:42,720 --> 00:50:44,559
techniques and you might have

1379
00:50:44,559 --> 00:50:47,599
uh sock analysts or people in certs

1380
00:50:47,599 --> 00:50:49,280
talking more or contributing more like

1381
00:50:49,280 --> 00:50:50,880
okay i know i can look for this sort of

1382
00:50:50,880 --> 00:50:53,520
technique in this kind of data i mean

1383
00:50:53,520 --> 00:50:54,960
everybody provides different insights

1384
00:50:54,960 --> 00:50:56,319
and feedback

1385
00:50:56,319 --> 00:50:57,680
um and

1386
00:50:57,680 --> 00:50:59,280
ideally those are all citable

1387
00:50:59,280 --> 00:51:00,480
contributions from the global

1388
00:51:00,480 --> 00:51:02,079
communities and not just something

1389
00:51:02,079 --> 00:51:04,800
someone came up with or made up

1390
00:51:04,800 --> 00:51:07,280
and again we curate and maintain

1391
00:51:07,280 --> 00:51:09,839
all that knowledge

1392
00:51:10,000 --> 00:51:12,480
so what does this end up looking like

1393
00:51:12,480 --> 00:51:14,319
in attack

1394
00:51:14,319 --> 00:51:17,040
so again this is a group um

1395
00:51:17,040 --> 00:51:18,960
but you also might have noticed these

1396
00:51:18,960 --> 00:51:20,839
footnotes at the end of paragraphs or

1397
00:51:20,839 --> 00:51:23,040
sections and these are the different

1398
00:51:23,040 --> 00:51:26,000
references that point to actual

1399
00:51:26,000 --> 00:51:28,240
cyber threat intelligence or threat

1400
00:51:28,240 --> 00:51:29,280
reports

1401
00:51:29,280 --> 00:51:32,559
that are out there in the public domain

1402
00:51:32,559 --> 00:51:34,960
so in this case with terla we didn't

1403
00:51:34,960 --> 00:51:36,480
just make up that

1404
00:51:36,480 --> 00:51:38,400
turla is a russian-based threat group

1405
00:51:38,400 --> 00:51:40,319
that affected victims in over 45

1406
00:51:40,319 --> 00:51:41,520
countries

1407
00:51:41,520 --> 00:51:43,200
we got that from

1408
00:51:43,200 --> 00:51:44,319
no

1409
00:51:44,319 --> 00:51:46,000
this um

1410
00:51:46,000 --> 00:51:48,000
this article or

1411
00:51:48,000 --> 00:51:51,040
no this article or this report from

1412
00:51:51,040 --> 00:51:52,720
crowdstrike

1413
00:51:52,720 --> 00:51:54,559
or this other um

1414
00:51:54,559 --> 00:51:56,000
threat report

1415
00:51:56,000 --> 00:51:58,079
uh so this is all stuff put out there in

1416
00:51:58,079 --> 00:51:59,280
the public domain and we're just

1417
00:51:59,280 --> 00:52:02,960
consolidating it into one place

1418
00:52:02,960 --> 00:52:04,240
so you can talk with some more

1419
00:52:04,240 --> 00:52:06,000
confidence about

1420
00:52:06,000 --> 00:52:08,160
you know yeah turla is a russian-based

1421
00:52:08,160 --> 00:52:09,520
threat group

1422
00:52:09,520 --> 00:52:11,200
based on you know

1423
00:52:11,200 --> 00:52:13,280
x number of different companies or

1424
00:52:13,280 --> 00:52:14,319
people

1425
00:52:14,319 --> 00:52:16,559
doing independent analyses

1426
00:52:16,559 --> 00:52:19,839
and coming to the same conclusion

1427
00:52:21,200 --> 00:52:23,200
again the procedures are also grounded

1428
00:52:23,200 --> 00:52:25,280
in threat intelligence

1429
00:52:25,280 --> 00:52:26,079
you know

1430
00:52:26,079 --> 00:52:27,920
here we have

1431
00:52:27,920 --> 00:52:29,420
uh this specific

1432
00:52:29,420 --> 00:52:30,480
[Music]

1433
00:52:30,480 --> 00:52:32,960
usage by of powershell by turla that

1434
00:52:32,960 --> 00:52:34,559
uses maintaining persistence on effects

1435
00:52:34,559 --> 00:52:36,400
machines and that's tied directly back

1436
00:52:36,400 --> 00:52:37,520
to

1437
00:52:37,520 --> 00:52:38,880
this report

1438
00:52:38,880 --> 00:52:43,520
um from m foul and r dumont

1439
00:52:44,000 --> 00:52:47,599
so you can yeah attack is nice to look

1440
00:52:47,599 --> 00:52:49,119
at at a summary view but if you really

1441
00:52:49,119 --> 00:52:50,559
want to get into the weeds of how we got

1442
00:52:50,559 --> 00:52:51,440
there

1443
00:52:51,440 --> 00:52:54,559
all the information is sourced to the

1444
00:52:54,559 --> 00:52:56,160
open source materials

1445
00:52:56,160 --> 00:52:58,000
of course it's possible that you know

1446
00:52:58,000 --> 00:53:01,200
these articles go offline or taken down

1447
00:53:01,200 --> 00:53:02,720
whatever

1448
00:53:02,720 --> 00:53:04,160
in that case please let us know if that

1449
00:53:04,160 --> 00:53:05,760
happens so we can update the site so we

1450
00:53:05,760 --> 00:53:09,839
don't have outdated links

1451
00:53:10,720 --> 00:53:12,720
if you dive down even deeper

1452
00:53:12,720 --> 00:53:14,559
to that specific

1453
00:53:14,559 --> 00:53:15,680
pdf

1454
00:53:15,680 --> 00:53:17,440
um this might be

1455
00:53:17,440 --> 00:53:19,280
an actual extra so now we're down to

1456
00:53:19,280 --> 00:53:21,920
okay this is actually what was the code

1457
00:53:21,920 --> 00:53:23,119
used

1458
00:53:23,119 --> 00:53:25,040
for that specific

1459
00:53:25,040 --> 00:53:27,520
uh technique no

1460
00:53:27,520 --> 00:53:29,280
and then you could actually directly do

1461
00:53:29,280 --> 00:53:31,040
this yourself at home maybe not a good

1462
00:53:31,040 --> 00:53:34,000
idea in this case but you could

1463
00:53:34,000 --> 00:53:35,920
uh so you say okay well

1464
00:53:35,920 --> 00:53:37,680
i can tell by looking at this oh they're

1465
00:53:37,680 --> 00:53:39,359
doing encoded

1466
00:53:39,359 --> 00:53:41,280
uh powershell from a basics for string

1467
00:53:41,280 --> 00:53:43,520
and this is this you could

1468
00:53:43,520 --> 00:53:46,000
decode that to get it out yourself and

1469
00:53:46,000 --> 00:53:47,599
find out what it is

1470
00:53:47,599 --> 00:53:51,200
and see oh yeah no it is in fact

1471
00:53:51,200 --> 00:53:54,598
encoded powershell

1472
00:53:56,720 --> 00:53:58,480
uh these are

1473
00:53:58,480 --> 00:53:59,440
a

1474
00:53:59,440 --> 00:54:00,960
listing of some of the different people

1475
00:54:00,960 --> 00:54:02,720
who have contributed

1476
00:54:02,720 --> 00:54:05,520
to uh attack over the years this is not

1477
00:54:05,520 --> 00:54:07,680
comprehensive so if you happen to be on

1478
00:54:07,680 --> 00:54:08,800
the call and are somebody who's

1479
00:54:08,800 --> 00:54:10,240
contributed already and they're not on

1480
00:54:10,240 --> 00:54:12,400
here sorry but we don't there's only so

1481
00:54:12,400 --> 00:54:13,920
much room on the slide

1482
00:54:13,920 --> 00:54:16,240
uh my name is also not on here so don't

1483
00:54:16,240 --> 00:54:18,319
feel bad

1484
00:54:18,319 --> 00:54:20,160
but you see there's lots of people from

1485
00:54:20,160 --> 00:54:22,079
lots of different groups and they're not

1486
00:54:22,079 --> 00:54:22,960
just

1487
00:54:22,960 --> 00:54:26,800
as much for us or even europe

1488
00:54:26,800 --> 00:54:28,079
you know and they're not even always

1489
00:54:28,079 --> 00:54:30,000
people you know we have elastic

1490
00:54:30,000 --> 00:54:33,760
from elk or difficult splunk

1491
00:54:33,760 --> 00:54:35,119
or

1492
00:54:35,119 --> 00:54:36,720
um

1493
00:54:36,720 --> 00:54:40,880
eset or palo alto or carbon black or ibm

1494
00:54:40,880 --> 00:54:43,440
these are big names in the security

1495
00:54:43,440 --> 00:54:45,839
world they're all contributing uh to

1496
00:54:45,839 --> 00:54:47,920
attack

1497
00:54:47,920 --> 00:54:49,920
and in many cases implementing attack

1498
00:54:49,920 --> 00:54:53,839
within their own companies

1499
00:54:54,079 --> 00:54:56,400
and that gives us like a title for that

1500
00:54:56,400 --> 00:54:58,480
diverse perspective that gives a lot of

1501
00:54:58,480 --> 00:54:59,920
breadth of ideas and operational

1502
00:54:59,920 --> 00:55:01,760
applications for how different

1503
00:55:01,760 --> 00:55:03,680
techniques can be done or are being done

1504
00:55:03,680 --> 00:55:05,520
by adversaries

1505
00:55:05,520 --> 00:55:08,400
and so we might take for example

1506
00:55:08,400 --> 00:55:10,160
well we don't know anything about supply

1507
00:55:10,160 --> 00:55:12,559
chain compromise but maybe you are

1508
00:55:12,559 --> 00:55:14,400
working an investigation where that

1509
00:55:14,400 --> 00:55:16,400
happened and you can provide some input

1510
00:55:16,400 --> 00:55:18,000
on you know which techniques were used

1511
00:55:18,000 --> 00:55:19,200
for that

1512
00:55:19,200 --> 00:55:20,559
you know we may

1513
00:55:20,559 --> 00:55:23,599
not be aware of unused or unsupported

1514
00:55:23,599 --> 00:55:25,119
cloud regions in other parts of the

1515
00:55:25,119 --> 00:55:26,000
world

1516
00:55:26,000 --> 00:55:27,839
and so you can maybe provide

1517
00:55:27,839 --> 00:55:30,079
input based on those

1518
00:55:30,079 --> 00:55:31,680
or maybe we don't know

1519
00:55:31,680 --> 00:55:35,280
uh specific uh information about a

1520
00:55:35,280 --> 00:55:37,760
particular device or machine in ics

1521
00:55:37,760 --> 00:55:38,880
systems

1522
00:55:38,880 --> 00:55:41,680
and so you can help give us or share

1523
00:55:41,680 --> 00:55:43,359
that information with the community as a

1524
00:55:43,359 --> 00:55:44,160
whole

1525
00:55:44,160 --> 00:55:46,319
so that others you might have to go do

1526
00:55:46,319 --> 00:55:47,200
you know

1527
00:55:47,200 --> 00:55:49,440
resolve an incident at a power plant or

1528
00:55:49,440 --> 00:55:51,839
a dam or whatever it's like oh they have

1529
00:55:51,839 --> 00:55:53,599
information on what that device's

1530
00:55:53,599 --> 00:55:55,200
communications are

1531
00:55:55,200 --> 00:55:57,359
or how and actually might use that on

1532
00:55:57,359 --> 00:55:59,040
attack so now i know what to look for

1533
00:55:59,040 --> 00:56:01,119
there

1534
00:56:01,119 --> 00:56:03,359
and also you know we may not know much

1535
00:56:03,359 --> 00:56:06,559
about um carrier billing fraud but maybe

1536
00:56:06,559 --> 00:56:09,280
the companies like android or apple do

1537
00:56:09,280 --> 00:56:11,119
and maybe they can provide input on some

1538
00:56:11,119 --> 00:56:13,200
of the techniques they see

1539
00:56:13,200 --> 00:56:15,280
um on their end for

1540
00:56:15,280 --> 00:56:17,760
that sort of fraud so maybe defenders

1541
00:56:17,760 --> 00:56:19,839
can go back and improve the security of

1542
00:56:19,839 --> 00:56:21,280
those devices

1543
00:56:21,280 --> 00:56:23,359
uh using that information

1544
00:56:23,359 --> 00:56:24,799
but we can't be experts with everything

1545
00:56:24,799 --> 00:56:26,240
that's why we need the input from the

1546
00:56:26,240 --> 00:56:28,400
community to help us

1547
00:56:28,400 --> 00:56:30,640
make a tab the attack framework as

1548
00:56:30,640 --> 00:56:33,839
comprehensive as it can be

1549
00:56:34,000 --> 00:56:36,160
as i said cyber security is complex and

1550
00:56:36,160 --> 00:56:37,760
we can't know everything

1551
00:56:37,760 --> 00:56:40,079
there's lots of technologies lots of

1552
00:56:40,079 --> 00:56:42,400
processes and lots of people that all

1553
00:56:42,400 --> 00:56:44,960
need to work together and those people

1554
00:56:44,960 --> 00:56:46,799
processes and technology are constantly

1555
00:56:46,799 --> 00:56:48,000
changing

1556
00:56:48,000 --> 00:56:50,319
and those people need different levels

1557
00:56:50,319 --> 00:56:53,040
of details and formats of information

1558
00:56:53,040 --> 00:56:54,880
you know the sock analyst needs you know

1559
00:56:54,880 --> 00:56:56,960
perhaps very detailed information

1560
00:56:56,960 --> 00:56:59,760
whereas the manager doesn't or

1561
00:56:59,760 --> 00:57:02,400
the person writing the threat report

1562
00:57:02,400 --> 00:57:04,640
needs uh some other kind of information

1563
00:57:04,640 --> 00:57:07,520
to make a report that reads well

1564
00:57:07,520 --> 00:57:10,240
nobody wants to read 20 lines of code

1565
00:57:10,240 --> 00:57:11,920
they want someone to distill that into

1566
00:57:11,920 --> 00:57:14,880
something that means something

1567
00:57:15,200 --> 00:57:17,200
and so we need the collaboration

1568
00:57:17,200 --> 00:57:19,119
communication across the resources and

1569
00:57:19,119 --> 00:57:21,680
that's key uh to enabling all these

1570
00:57:21,680 --> 00:57:24,839
teams to work together and different

1571
00:57:24,839 --> 00:57:27,280
organizations and as we talked

1572
00:57:27,280 --> 00:57:29,440
uh touched on earlier attacks provides

1573
00:57:29,440 --> 00:57:31,280
that adversary language

1574
00:57:31,280 --> 00:57:33,040
that's critical for consistently sharing

1575
00:57:33,040 --> 00:57:35,520
ideas about adversary behaviors it's

1576
00:57:35,520 --> 00:57:38,240
abstracted to an operational level but

1577
00:57:38,240 --> 00:57:41,119
also detailed enough that you can talk

1578
00:57:41,119 --> 00:57:43,599
at a very low level but also talk at you

1579
00:57:43,599 --> 00:57:45,520
know the tactics level

1580
00:57:45,520 --> 00:57:47,520
you know we are seeing

1581
00:57:47,520 --> 00:57:49,440
you know your manager manager may only

1582
00:57:49,440 --> 00:57:51,520
care about well they're

1583
00:57:51,520 --> 00:57:53,359
moving loudly in the network and he

1584
00:57:53,359 --> 00:57:54,400
knows what that means but he doesn't

1585
00:57:54,400 --> 00:57:56,240
need to know necessarily

1586
00:57:56,240 --> 00:57:58,799
well they're using smb shares

1587
00:57:58,799 --> 00:58:01,040
to copy files over before remotely

1588
00:58:01,040 --> 00:58:03,359
scheduling tasks execute those files

1589
00:58:03,359 --> 00:58:04,799
that's maybe too much information for

1590
00:58:04,799 --> 00:58:05,599
him

1591
00:58:05,599 --> 00:58:07,040
he just needs to know

1592
00:58:07,040 --> 00:58:09,839
they're moving laterally

1593
00:58:10,079 --> 00:58:11,359
and this also

1594
00:58:11,359 --> 00:58:14,160
uh connects the adversary perspective uh

1595
00:58:14,160 --> 00:58:16,559
to the defensive perspective so a lot of

1596
00:58:16,559 --> 00:58:18,640
times a lot of events i've been to you

1597
00:58:18,640 --> 00:58:20,240
know the red team or the adversary will

1598
00:58:20,240 --> 00:58:23,040
say well we did xyz but as a fan that

1599
00:58:23,040 --> 00:58:26,160
doesn't mean anything no or it's so

1600
00:58:26,160 --> 00:58:27,920
generic that there's no way i don't know

1601
00:58:27,920 --> 00:58:30,000
what to do with it in terms of finding

1602
00:58:30,000 --> 00:58:32,720
it like and then we

1603
00:58:32,720 --> 00:58:35,520
moved to computer x and then

1604
00:58:35,520 --> 00:58:36,480
did

1605
00:58:36,480 --> 00:58:38,720
we ran our wrecked

1606
00:58:38,720 --> 00:58:40,160
well as a defender i don't know what the

1607
00:58:40,160 --> 00:58:42,079
rat's name is i don't know how it works

1608
00:58:42,079 --> 00:58:45,200
i don't know anything about it

1609
00:58:45,200 --> 00:58:45,920
so

1610
00:58:45,920 --> 00:58:47,040
the only thing i could get out of that

1611
00:58:47,040 --> 00:58:49,359
is maybe looking for some sort of

1612
00:58:49,359 --> 00:58:51,599
movement and then maybe finding you know

1613
00:58:51,599 --> 00:58:54,400
some executable that occurred after that

1614
00:58:54,400 --> 00:58:56,480
but it's super vague but if you talk

1615
00:58:56,480 --> 00:58:57,839
about things like

1616
00:58:57,839 --> 00:58:58,880
well

1617
00:58:58,880 --> 00:59:03,359
we used smb shares to copy our rat tool

1618
00:59:03,359 --> 00:59:06,000
uh and then we had that thing do these

1619
00:59:06,000 --> 00:59:08,160
five techniques like oh okay i know what

1620
00:59:08,160 --> 00:59:10,559
to kind of look for now so next time if

1621
00:59:10,559 --> 00:59:12,720
you go back and do another event

1622
00:59:12,720 --> 00:59:14,720
you should be better prepared for things

1623
00:59:14,720 --> 00:59:18,279
i might have missed before

1624
00:59:18,640 --> 00:59:20,160
so traditionally this is what the sort

1625
00:59:20,160 --> 00:59:22,640
of communication looks like between cti

1626
00:59:22,640 --> 00:59:25,040
red teams saw catalysts

1627
00:59:25,040 --> 00:59:27,119
now cti's will say things like

1628
00:59:27,119 --> 00:59:28,720
uh we were seeing advertisers run this

1629
00:59:28,720 --> 00:59:31,920
command uh in this case secure lsa logon

1630
00:59:31,920 --> 00:59:33,280
passwords

1631
00:59:33,280 --> 00:59:34,319
so that's

1632
00:59:34,319 --> 00:59:35,920
what we call more like an ioc you know

1633
00:59:35,920 --> 00:59:40,079
it's a string to look for in data

1634
00:59:40,799 --> 00:59:42,160
and your red team i say oh i kind of

1635
00:59:42,160 --> 00:59:43,359
know what that is i think that belongs

1636
00:59:43,359 --> 00:59:45,680
to mimikatz

1637
00:59:45,680 --> 00:59:48,079
then your side goes okay well

1638
00:59:48,079 --> 00:59:50,720
mimi cats i can research meme cats and i

1639
00:59:50,720 --> 00:59:52,319
can write syntax

1640
00:59:52,319 --> 00:59:54,160
uh for that so i'll just look for like

1641
00:59:54,160 --> 00:59:55,920
secure lsa logon passwords that that

1642
00:59:55,920 --> 00:59:57,760
will mean mimikaz would run the

1643
00:59:57,760 --> 00:59:59,200
environment and we'll call that the

1644
00:59:59,200 --> 01:00:01,520
analytic

1645
01:00:01,520 --> 01:00:03,280
the problem with that is

1646
01:00:03,280 --> 01:00:04,799
there is that is there's a lack of

1647
01:00:04,799 --> 01:00:06,640
context and

1648
01:00:06,640 --> 01:00:08,559
details communicated

1649
01:00:08,559 --> 01:00:11,520
across those groups and that leads to

1650
01:00:11,520 --> 01:00:13,200
operational shortcomings

1651
01:00:13,200 --> 01:00:15,359
so really this sort of

1652
01:00:15,359 --> 01:00:18,079
string search kind of thing is very tool

1653
01:00:18,079 --> 01:00:19,760
specific

1654
01:00:19,760 --> 01:00:21,040
it may you may even call it a host

1655
01:00:21,040 --> 01:00:22,799
artifact because it's just a string that

1656
01:00:22,799 --> 01:00:24,720
occurs on a command line

1657
01:00:24,720 --> 01:00:26,400
so it's not really getting

1658
01:00:26,400 --> 01:00:29,760
to the hard problem of ttps

1659
01:00:29,760 --> 01:00:32,079
and so what could somebody do well an

1660
01:00:32,079 --> 01:00:34,319
average area could run me me cats

1661
01:00:34,319 --> 01:00:37,520
not on a command line or they could

1662
01:00:37,520 --> 01:00:40,720
not use that uh argument or they could

1663
01:00:40,720 --> 01:00:43,839
recompile it and edit the code to be

1664
01:00:43,839 --> 01:00:45,760
secure lsa2

1665
01:00:45,760 --> 01:00:47,760
colon colon logo passwords and now your

1666
01:00:47,760 --> 01:00:49,280
analytic is broken

1667
01:00:49,280 --> 01:00:52,640
so that's why it's very fragile

1668
01:00:53,920 --> 01:00:56,799
so how does attack sorry if you cannot

1669
01:00:56,799 --> 01:00:58,640
uh see it under uh this i don't know if

1670
01:00:58,640 --> 01:00:59,920
you can see that or not

1671
01:00:59,920 --> 01:01:00,880
um

1672
01:01:00,880 --> 01:01:02,960
under attack

1673
01:01:02,960 --> 01:01:04,640
you can say stuff like well they're

1674
01:01:04,640 --> 01:01:07,040
using os credential dumping using lss

1675
01:01:07,040 --> 01:01:09,680
memory and so from cti aside that looks

1676
01:01:09,680 --> 01:01:11,839
more like this is a very common trade

1677
01:01:11,839 --> 01:01:14,720
crash across many groups and software so

1678
01:01:14,720 --> 01:01:17,200
we're seeing this technique across a lot

1679
01:01:17,200 --> 01:01:18,799
of things so maybe it's a high priority

1680
01:01:18,799 --> 01:01:20,720
for us

1681
01:01:20,720 --> 01:01:22,799
and the ranch is like okay

1682
01:01:22,799 --> 01:01:25,119
for that specific technique i know what

1683
01:01:25,119 --> 01:01:28,000
they're doing is they're reading lsas

1684
01:01:28,000 --> 01:01:30,559
memory space

1685
01:01:30,559 --> 01:01:33,359
and as a defender that shifts the

1686
01:01:33,359 --> 01:01:36,000
defense creation or the analytic from

1687
01:01:36,000 --> 01:01:37,040
being

1688
01:01:37,040 --> 01:01:38,880
about this string

1689
01:01:38,880 --> 01:01:40,960
to being okay well i need to monitor

1690
01:01:40,960 --> 01:01:43,200
process access to lcs

1691
01:01:43,200 --> 01:01:44,240
which is

1692
01:01:44,240 --> 01:01:47,040
a in this case an actual technique to

1693
01:01:47,040 --> 01:01:48,319
look for

1694
01:01:48,319 --> 01:01:51,200
because and is much broader much more

1695
01:01:51,200 --> 01:01:52,799
broadly applicable because no longer are

1696
01:01:52,799 --> 01:01:54,240
we looking for

1697
01:01:54,240 --> 01:01:56,720
this one string they can name the string

1698
01:01:56,720 --> 01:01:57,839
whatever they want they could name

1699
01:01:57,839 --> 01:02:00,720
mimikats whatever they want it's still

1700
01:02:00,720 --> 01:02:03,119
reading lsas memory access it's still

1701
01:02:03,119 --> 01:02:04,720
going to have to do this

1702
01:02:04,720 --> 01:02:05,440
so

1703
01:02:05,440 --> 01:02:07,760
this would be a much more robust

1704
01:02:07,760 --> 01:02:10,000
detection in the long term

1705
01:02:10,000 --> 01:02:11,359
for finding

1706
01:02:11,359 --> 01:02:15,839
this behavior or this behavior

1707
01:02:17,440 --> 01:02:20,799
now we measure our cyber security

1708
01:02:20,799 --> 01:02:23,760
it's unfortunately not easy to quantify

1709
01:02:23,760 --> 01:02:25,760
um but it's vital to track progress and

1710
01:02:25,760 --> 01:02:28,079
growth over time you know metrics like

1711
01:02:28,079 --> 01:02:30,000
we have 100 analytics doesn't really

1712
01:02:30,000 --> 01:02:32,559
mean anything it means you hopefully are

1713
01:02:32,559 --> 01:02:35,280
better detecting things but across what

1714
01:02:35,280 --> 01:02:37,280
the aperture is doing

1715
01:02:37,280 --> 01:02:40,319
it may mean nothing

1716
01:02:40,960 --> 01:02:45,280
uh so let's look at uh example scorecard

1717
01:02:45,280 --> 01:02:46,799
um so here

1718
01:02:46,799 --> 01:02:48,400
we've scored what techniques are most

1719
01:02:48,400 --> 01:02:50,319
important to us

1720
01:02:50,319 --> 01:02:52,480
however we came up with this so this

1721
01:02:52,480 --> 01:02:53,440
could be

1722
01:02:53,440 --> 01:02:55,440
our threat analysts like okay these are

1723
01:02:55,440 --> 01:02:56,400
the

1724
01:02:56,400 --> 01:02:59,599
x number most common techniques or

1725
01:02:59,599 --> 01:03:01,680
you know these are the ones that we

1726
01:03:01,680 --> 01:03:03,440
care mo are most applicable to our

1727
01:03:03,440 --> 01:03:06,240
environment maybe

1728
01:03:06,480 --> 01:03:08,640
uh and then we can also also map okay

1729
01:03:08,640 --> 01:03:10,240
what techniques do we have defenses even

1730
01:03:10,240 --> 01:03:12,079
for

1731
01:03:12,079 --> 01:03:14,079
so there's some overlap in some of these

1732
01:03:14,079 --> 01:03:16,240
like phishing

1733
01:03:16,240 --> 01:03:18,319
so we care about it and we have a

1734
01:03:18,319 --> 01:03:21,359
defense for other ones we don't have uh

1735
01:03:21,359 --> 01:03:24,079
any things in that exist

1736
01:03:24,079 --> 01:03:26,960
to address them

1737
01:03:26,960 --> 01:03:29,280
and so we can use that to inform our

1738
01:03:29,280 --> 01:03:30,400
decision making

1739
01:03:30,400 --> 01:03:31,760
we can identify where do we need to

1740
01:03:31,760 --> 01:03:32,720
improve

1741
01:03:32,720 --> 01:03:34,720
uh where are our gaps in our current

1742
01:03:34,720 --> 01:03:37,280
knowledge versus where we want to be

1743
01:03:37,280 --> 01:03:39,440
in this case that might be these four

1744
01:03:39,440 --> 01:03:40,799
things

1745
01:03:40,799 --> 01:03:43,440
and so now we've narrowed down from this

1746
01:03:43,440 --> 01:03:47,200
whole you know two what 200 200 plus

1747
01:03:47,200 --> 01:03:49,920
uh techniques to

1748
01:03:49,920 --> 01:03:51,119
four

1749
01:03:51,119 --> 01:03:52,880
that we need to address and that's a

1750
01:03:52,880 --> 01:03:54,559
much more tractable number like okay now

1751
01:03:54,559 --> 01:03:55,839
we start planning

1752
01:03:55,839 --> 01:03:58,000
how do we address these four

1753
01:03:58,000 --> 01:04:00,160
let's start with valid accounts how do

1754
01:04:00,160 --> 01:04:02,000
we address falcons what is valid

1755
01:04:02,000 --> 01:04:03,520
accounts

1756
01:04:03,520 --> 01:04:06,400
etc etc

1757
01:04:06,960 --> 01:04:08,400
uh what are some other particular

1758
01:04:08,400 --> 01:04:12,240
potential potential metrics to measure

1759
01:04:12,240 --> 01:04:13,920
we can use a similar approach to

1760
01:04:13,920 --> 01:04:16,000
quantify other aspects of data captured

1761
01:04:16,000 --> 01:04:18,079
in attack like data sources

1762
01:04:18,079 --> 01:04:20,240
uh detections and analytics

1763
01:04:20,240 --> 01:04:22,960
mitigation controls and really anything

1764
01:04:22,960 --> 01:04:24,960
you can come up with so

1765
01:04:24,960 --> 01:04:27,599
one thing i do a lot of is i will map

1766
01:04:27,599 --> 01:04:29,440
individual tools

1767
01:04:29,440 --> 01:04:30,799
to attack

1768
01:04:30,799 --> 01:04:32,880
and so then i can build a

1769
01:04:32,880 --> 01:04:35,440
map of okay this tool addresses these

1770
01:04:35,440 --> 01:04:37,440
techniques this will address these

1771
01:04:37,440 --> 01:04:38,960
techniques this tool addresses these

1772
01:04:38,960 --> 01:04:41,920
techniques now if i can i can overlay

1773
01:04:41,920 --> 01:04:44,720
those all together and now i see for my

1774
01:04:44,720 --> 01:04:47,200
enterprise all the techniques

1775
01:04:47,200 --> 01:04:49,760
that have tools that at least generate

1776
01:04:49,760 --> 01:04:51,280
data for them and you can do the same

1777
01:04:51,280 --> 01:04:52,799
thing with your analytics

1778
01:04:52,799 --> 01:04:54,480
you do the same thing perhaps with your

1779
01:04:54,480 --> 01:04:57,200
cti it's okay which

1780
01:04:57,200 --> 01:04:59,119
uh techniques do we have cyber threat

1781
01:04:59,119 --> 01:05:01,359
intelligence for which ones maybe don't

1782
01:05:01,359 --> 01:05:03,440
we need we need we need not to care

1783
01:05:03,440 --> 01:05:04,720
about because there's nothing saying

1784
01:05:04,720 --> 01:05:08,359
that's even being used

1785
01:05:09,440 --> 01:05:12,400
but how do we make these graphs

1786
01:05:12,400 --> 01:05:13,599
um

1787
01:05:13,599 --> 01:05:16,079
so this is a little subjective uh but we

1788
01:05:16,079 --> 01:05:17,839
do have a tool we provide to help you do

1789
01:05:17,839 --> 01:05:20,079
this and that is the attack navigator

1790
01:05:20,079 --> 01:05:22,079
and that what allows us to do is it

1791
01:05:22,079 --> 01:05:23,119
gives you

1792
01:05:23,119 --> 01:05:27,280
uh this tabular format of the attack

1793
01:05:27,280 --> 01:05:29,039
framework it allows you to do things

1794
01:05:29,039 --> 01:05:31,200
like colorized cells score them

1795
01:05:31,200 --> 01:05:32,799
layer them on top of each other group

1796
01:05:32,799 --> 01:05:33,599
them

1797
01:05:33,599 --> 01:05:36,160
so it's a very handy tool in order to

1798
01:05:36,160 --> 01:05:38,640
start using the framework without having

1799
01:05:38,640 --> 01:05:40,480
to resort to excel things like excel

1800
01:05:40,480 --> 01:05:43,280
spreadsheets

1801
01:05:44,160 --> 01:05:46,880
so the attack navigator is designed to

1802
01:05:46,880 --> 01:05:49,280
provide basic navigation and annotation

1803
01:05:49,280 --> 01:05:51,280
of attack matrices

1804
01:05:51,280 --> 01:05:52,799
uh helps you visualize your defensive

1805
01:05:52,799 --> 01:05:56,160
coverage your red blue team planning

1806
01:05:56,160 --> 01:05:57,760
the frequency of detected techniques or

1807
01:05:57,760 --> 01:06:00,000
anything else you want to do so maybe

1808
01:06:00,000 --> 01:06:03,359
after you do a red blue team exercise

1809
01:06:03,359 --> 01:06:05,280
you map what the red team saw and what

1810
01:06:05,280 --> 01:06:07,119
the blue team saw and that and then look

1811
01:06:07,119 --> 01:06:08,640
where the gaps are

1812
01:06:08,640 --> 01:06:09,520
or

1813
01:06:09,520 --> 01:06:11,359
uh you just look at well how many times

1814
01:06:11,359 --> 01:06:13,839
does the red team do x technique versus

1815
01:06:13,839 --> 01:06:15,200
another

1816
01:06:15,200 --> 01:06:16,799
and you can manipulate the cells in the

1817
01:06:16,799 --> 01:06:18,960
matrix with a variety ways including

1818
01:06:18,960 --> 01:06:21,280
color coding adding a comment assigning

1819
01:06:21,280 --> 01:06:25,119
a numerical value etc

1820
01:06:25,280 --> 01:06:28,480
and on top of each major c we have this

1821
01:06:28,480 --> 01:06:30,319
concept of layers

1822
01:06:30,319 --> 01:06:32,720
and these are custom views of the attack

1823
01:06:32,720 --> 01:06:33,760
matrix

1824
01:06:33,760 --> 01:06:35,440
uh and they can be created interactively

1825
01:06:35,440 --> 01:06:38,079
with the navigator or programmatically

1826
01:06:38,079 --> 01:06:39,839
using json and you can import them

1827
01:06:39,839 --> 01:06:40,960
yourself

1828
01:06:40,960 --> 01:06:43,520
or export them to share with others

1829
01:06:43,520 --> 01:06:47,200
or to load them into different instances

1830
01:06:47,200 --> 01:06:49,119
so how do you get there

1831
01:06:49,119 --> 01:06:50,880
the source code and documentation are

1832
01:06:50,880 --> 01:06:52,559
all available on github

1833
01:06:52,559 --> 01:06:54,319
at that link and it's also hosted at

1834
01:06:54,319 --> 01:06:56,720
this github link

1835
01:06:56,720 --> 01:06:58,640
so you can download it yourself you can

1836
01:06:58,640 --> 01:07:00,640
use the publicly accessible version

1837
01:07:00,640 --> 01:07:02,000
that's already out there

1838
01:07:02,000 --> 01:07:04,000
it's all free for you to use however you

1839
01:07:04,000 --> 01:07:06,160
want

1840
01:07:06,160 --> 01:07:08,079
and this is what it looks like

1841
01:07:08,079 --> 01:07:11,039
so it looks very similar to the other

1842
01:07:11,039 --> 01:07:12,960
visualizations of attack we've already

1843
01:07:12,960 --> 01:07:14,400
looked at

1844
01:07:14,400 --> 01:07:16,799
so we have you know the tactics uh the

1845
01:07:16,799 --> 01:07:21,200
techniques uh we have the sub techniques

1846
01:07:21,200 --> 01:07:23,839
uh but we also have uh the sort of

1847
01:07:23,839 --> 01:07:25,520
toolbar

1848
01:07:25,520 --> 01:07:26,839
so what is in that

1849
01:07:26,839 --> 01:07:29,440
toolbar we have selection controls layer

1850
01:07:29,440 --> 01:07:32,559
controls and technique controls

1851
01:07:32,559 --> 01:07:34,079
and these are the different ways we can

1852
01:07:34,079 --> 01:07:36,880
manipulate the chart

1853
01:07:36,880 --> 01:07:40,400
so this is the sort of the group button

1854
01:07:40,400 --> 01:07:42,559
and this allows you to select

1855
01:07:42,559 --> 01:07:45,680
or deselect techniques based on

1856
01:07:45,680 --> 01:07:48,640
groups software or mitigations

1857
01:07:48,640 --> 01:07:50,559
and so you can do things like

1858
01:07:50,559 --> 01:07:52,640
just open the technology okay tell me

1859
01:07:52,640 --> 01:07:56,000
what techniques apt16 uses select and it

1860
01:07:56,000 --> 01:07:58,240
will select all those techniques you can

1861
01:07:58,240 --> 01:08:00,160
do that for software

1862
01:08:00,160 --> 01:08:02,240
or other any other group and you can

1863
01:08:02,240 --> 01:08:05,599
select multiple groups as well

1864
01:08:05,599 --> 01:08:07,760
so that's a very easy tool to say okay

1865
01:08:07,760 --> 01:08:10,000
going to attack site going through the

1866
01:08:10,000 --> 01:08:11,680
list of tech

1867
01:08:11,680 --> 01:08:12,880
techniques

1868
01:08:12,880 --> 01:08:15,280
trying to map them manually one by one

1869
01:08:15,280 --> 01:08:17,120
at a time it's very labor intensive but

1870
01:08:17,120 --> 01:08:18,880
this at least using the pre-generated

1871
01:08:18,880 --> 01:08:22,640
ones it makes it very easy

1872
01:08:22,640 --> 01:08:24,719
once you've done that you could then do

1873
01:08:24,719 --> 01:08:25,920
things like

1874
01:08:25,920 --> 01:08:27,679
add colors uh which is what we've done

1875
01:08:27,679 --> 01:08:29,120
in the past charts

1876
01:08:29,120 --> 01:08:31,359
or add scoring uh so you can assign

1877
01:08:31,359 --> 01:08:32,319
numbers

1878
01:08:32,319 --> 01:08:34,158
or add comments like

1879
01:08:34,158 --> 01:08:37,040
you know we detect this 50 of the time

1880
01:08:37,040 --> 01:08:38,399
using tool x

1881
01:08:38,399 --> 01:08:39,839
and maybe you use

1882
01:08:39,839 --> 01:08:42,640
a layer of the navigator to track

1883
01:08:42,640 --> 01:08:46,239
how you detect different techniques

1884
01:08:47,839 --> 01:08:49,679
and then finally once you have it sort

1885
01:08:49,679 --> 01:08:52,000
of set you can export it in a variety of

1886
01:08:52,000 --> 01:08:55,600
methods using like json excel or svg

1887
01:08:55,600 --> 01:08:58,080
if you just want the picture

1888
01:08:58,080 --> 01:08:59,600
so it gives you a lot of

1889
01:08:59,600 --> 01:09:01,600
flexibility and options to

1890
01:09:01,600 --> 01:09:04,080
make it easy to work with

1891
01:09:04,080 --> 01:09:07,600
the framework itself

1892
01:09:07,600 --> 01:09:10,158
so with layers um when you create you

1893
01:09:10,158 --> 01:09:11,679
open up the navigator this is the page

1894
01:09:11,679 --> 01:09:14,319
you end up with and this allows where

1895
01:09:14,319 --> 01:09:17,600
you do those sort of working with layers

1896
01:09:17,600 --> 01:09:19,920
and so when you create a new layer

1897
01:09:19,920 --> 01:09:21,198
you're presented with the option of

1898
01:09:21,198 --> 01:09:22,399
which

1899
01:09:22,399 --> 01:09:24,319
platform you want to use

1900
01:09:24,319 --> 01:09:26,399
oftentimes it's enterprise but also we

1901
01:09:26,399 --> 01:09:28,640
have mobile and ics on there

1902
01:09:28,640 --> 01:09:31,120
if you want to load one

1903
01:09:31,120 --> 01:09:33,359
you do it here and if you want to create

1904
01:09:33,359 --> 01:09:36,080
a layer that is a composite of multiple

1905
01:09:36,080 --> 01:09:38,560
layers uh you do that here

1906
01:09:38,560 --> 01:09:40,880
if we have time at the end um

1907
01:09:40,880 --> 01:09:42,319
i'll run through that what that looks

1908
01:09:42,319 --> 01:09:44,080
like but it basically

1909
01:09:44,080 --> 01:09:46,799
uh you can do a sort of an end operation

1910
01:09:46,799 --> 01:09:49,040
or math operations on the layers

1911
01:09:49,040 --> 01:09:51,679
themselves to get some like summaries so

1912
01:09:51,679 --> 01:09:53,839
you might say

1913
01:09:53,839 --> 01:09:56,159
like layer one anything in layer one is

1914
01:09:56,159 --> 01:09:57,600
assigned to value one

1915
01:09:57,600 --> 01:09:59,600
anything in layer two is assigned a

1916
01:09:59,600 --> 01:10:02,239
value of two and then layer 3 is a

1917
01:10:02,239 --> 01:10:03,760
summary of those

1918
01:10:03,760 --> 01:10:06,640
and so if the value in the third layer

1919
01:10:06,640 --> 01:10:08,880
is 3 that means it was common across

1920
01:10:08,880 --> 01:10:12,640
both you can do that sort of thing

1921
01:10:15,120 --> 01:10:18,000
uh so let's go move into our

1922
01:10:18,000 --> 01:10:19,600
third and final section which is

1923
01:10:19,600 --> 01:10:22,880
operationalizing attack

1924
01:10:23,600 --> 01:10:26,320
so when we talk about using attack and

1925
01:10:26,320 --> 01:10:28,880
operations uh we often talk about

1926
01:10:28,880 --> 01:10:31,840
in the mindset of three use cases that

1927
01:10:31,840 --> 01:10:34,159
is cyber threat intelligence uh

1928
01:10:34,159 --> 01:10:36,239
detections analytics threat emulation

1929
01:10:36,239 --> 01:10:38,400
and assessments in engineering

1930
01:10:38,400 --> 01:10:40,719
and all these are working

1931
01:10:40,719 --> 01:10:41,760
together

1932
01:10:41,760 --> 01:10:43,600
with the purpose of

1933
01:10:43,600 --> 01:10:45,760
doing a threat or enabling a threat in

1934
01:10:45,760 --> 01:10:47,360
form defense

1935
01:10:47,360 --> 01:10:49,920
and we define that as the systematic

1936
01:10:49,920 --> 01:10:52,000
application of a deep understanding of

1937
01:10:52,000 --> 01:10:54,080
adversary tradecraft and technology to

1938
01:10:54,080 --> 01:10:56,320
prevent detect indoor response to cyber

1939
01:10:56,320 --> 01:10:59,320
attacks

1940
01:11:01,280 --> 01:11:02,640
so let's start with

1941
01:11:02,640 --> 01:11:05,920
cti so cyber threat intelligence or cti

1942
01:11:05,920 --> 01:11:07,440
is all about knowing what your

1943
01:11:07,440 --> 01:11:09,760
adversaries do

1944
01:11:09,760 --> 01:11:11,600
so it's critical for improving decision

1945
01:11:11,600 --> 01:11:14,320
making as well as shaping operations

1946
01:11:14,320 --> 01:11:15,920
uh especially in the context of threat

1947
01:11:15,920 --> 01:11:17,920
and forward defense so

1948
01:11:17,920 --> 01:11:21,040
what we often or i often see people do

1949
01:11:21,040 --> 01:11:22,960
in socks or when they're responding to

1950
01:11:22,960 --> 01:11:24,560
incidents is the first thing they'll say

1951
01:11:24,560 --> 01:11:25,280
is

1952
01:11:25,280 --> 01:11:27,199
what data do we have

1953
01:11:27,199 --> 01:11:29,199
and then they'll start trying to solve a

1954
01:11:29,199 --> 01:11:31,520
problem out of that data

1955
01:11:31,520 --> 01:11:32,560
um

1956
01:11:32,560 --> 01:11:34,400
we're saying here is you should start

1957
01:11:34,400 --> 01:11:35,840
rather with

1958
01:11:35,840 --> 01:11:37,920
what am i even what

1959
01:11:37,920 --> 01:11:39,600
techniques or adversaries i'm even

1960
01:11:39,600 --> 01:11:41,040
looking for

1961
01:11:41,040 --> 01:11:43,280
and does that data i have support that

1962
01:11:43,280 --> 01:11:46,080
or do i need additional data to find

1963
01:11:46,080 --> 01:11:47,280
that

1964
01:11:47,280 --> 01:11:49,040
no it doesn't if you're looking for a

1965
01:11:49,040 --> 01:11:50,560
technique

1966
01:11:50,560 --> 01:11:52,320
that doesn't use

1967
01:11:52,320 --> 01:11:54,880
has nothing to do with let's say pcap

1968
01:11:54,880 --> 01:11:56,800
then you don't need to go

1969
01:11:56,800 --> 01:11:59,040
and push uh somebody start collecting

1970
01:11:59,040 --> 01:12:01,120
pcap off their network devices

1971
01:12:01,120 --> 01:12:02,400
you're just wasting time it's not going

1972
01:12:02,400 --> 01:12:04,480
to help you achieve your goal of

1973
01:12:04,480 --> 01:12:08,199
identifying that technique

1974
01:12:08,960 --> 01:12:10,960
so attack is a great starting point for

1975
01:12:10,960 --> 01:12:12,960
identifying what behaviors have been

1976
01:12:12,960 --> 01:12:16,000
reported for specific groups or malware

1977
01:12:16,000 --> 01:12:17,920
uh so we've talked a lot about that in

1978
01:12:17,920 --> 01:12:19,719
terms of groups so like threat group

1979
01:12:19,719 --> 01:12:22,560
339.0 is a chinese threat group et

1980
01:12:22,560 --> 01:12:25,199
cetera et cetera

1981
01:12:25,199 --> 01:12:27,360
and on the attack layer that threat

1982
01:12:27,360 --> 01:12:29,600
group looks like this

1983
01:12:29,600 --> 01:12:31,040
you know they do all these different

1984
01:12:31,040 --> 01:12:33,040
techniques with these different sub

1985
01:12:33,040 --> 01:12:34,800
techniques

1986
01:12:34,800 --> 01:12:36,719
and then this is how they use it

1987
01:12:36,719 --> 01:12:39,120
and so that allows the threat

1988
01:12:39,120 --> 01:12:41,040
intelligence people to communicate

1989
01:12:41,040 --> 01:12:43,440
information in a way that is useful to

1990
01:12:43,440 --> 01:12:44,800
defenders so

1991
01:12:44,800 --> 01:12:47,520
as a defender i know what to

1992
01:12:47,520 --> 01:12:49,440
look for how to look for net user for

1993
01:12:49,440 --> 01:12:51,440
example

1994
01:12:51,440 --> 01:12:52,159
or

1995
01:12:52,159 --> 01:12:53,070
i know

1996
01:12:53,070 --> 01:12:54,640
[Music]

1997
01:12:54,640 --> 01:12:56,239
they how to look for powershell

1998
01:12:56,239 --> 01:12:57,520
execution

1999
01:12:57,520 --> 01:13:00,400
but if they just say stuff like

2000
01:13:00,400 --> 01:13:01,360
they

2001
01:13:01,360 --> 01:13:03,040
do

2002
01:13:03,040 --> 01:13:04,960
elevation can they abuse elevation

2003
01:13:04,960 --> 01:13:06,560
control mechanisms

2004
01:13:06,560 --> 01:13:08,880
i don't know what to do with that

2005
01:13:08,880 --> 01:13:10,960
um so a lot of times i've heard the

2006
01:13:10,960 --> 01:13:13,840
issue of the people providing the threat

2007
01:13:13,840 --> 01:13:16,000
information are not providing

2008
01:13:16,000 --> 01:13:17,600
information in a way that is useful to

2009
01:13:17,600 --> 01:13:19,280
the defenders you know there are a lot

2010
01:13:19,280 --> 01:13:22,000
of times it might be providing iocs

2011
01:13:22,000 --> 01:13:23,600
which are not really addressing that

2012
01:13:23,600 --> 01:13:26,320
pyramid of pain problem that defenders

2013
01:13:26,320 --> 01:13:29,519
want to start addressing

2014
01:13:29,920 --> 01:13:32,640
and ctia comes in many forms

2015
01:13:32,640 --> 01:13:35,280
so we might have threat reports

2016
01:13:35,280 --> 01:13:36,800
like this one from crowdstrike on their

2017
01:13:36,800 --> 01:13:38,480
blog

2018
01:13:38,480 --> 01:13:41,040
or you might have this snippet

2019
01:13:41,040 --> 01:13:43,440
from a different threat report or you

2020
01:13:43,440 --> 01:13:44,880
might even have someone sending

2021
01:13:44,880 --> 01:13:46,960
something out over twitter which is just

2022
01:13:46,960 --> 01:13:48,719
a snippet of code

2023
01:13:48,719 --> 01:13:50,960
and so cyber threatened

2024
01:13:50,960 --> 01:13:53,199
analysts have to

2025
01:13:53,199 --> 01:13:55,360
keep an open mind about the different

2026
01:13:55,360 --> 01:13:56,960
places they can pull this information

2027
01:13:56,960 --> 01:13:58,320
from

2028
01:13:58,320 --> 01:14:01,600
it's not just uh if you're a government

2029
01:14:01,600 --> 01:14:03,920
agency you know your intelligence group

2030
01:14:03,920 --> 01:14:05,440
or if you're

2031
01:14:05,440 --> 01:14:06,880
a company

2032
01:14:06,880 --> 01:14:08,640
you know what if you have a different

2033
01:14:08,640 --> 01:14:09,920
threat tells you within the company

2034
01:14:09,920 --> 01:14:11,280
whatever they say

2035
01:14:11,280 --> 01:14:13,120
or what attacks you're seeing

2036
01:14:13,120 --> 01:14:15,600
now there's a whole community out there

2037
01:14:15,600 --> 01:14:18,159
generating information for you to use

2038
01:14:18,159 --> 01:14:20,400
and a lot of it is open for you to use

2039
01:14:20,400 --> 01:14:23,679
so take advantage of it

2040
01:14:24,960 --> 01:14:26,960
but if we take some examples of cyber

2041
01:14:26,960 --> 01:14:28,640
threat intelligence how do we start

2042
01:14:28,640 --> 01:14:30,719
deriving that into

2043
01:14:30,719 --> 01:14:32,239
attack

2044
01:14:32,239 --> 01:14:33,440
so

2045
01:14:33,440 --> 01:14:36,400
in this example we might see

2046
01:14:36,400 --> 01:14:38,159
these techniques out of this threat

2047
01:14:38,159 --> 01:14:40,480
report

2048
01:14:40,480 --> 01:14:42,239
we have a different course if you want

2049
01:14:42,239 --> 01:14:43,679
to learn more about cyber threat

2050
01:14:43,679 --> 01:14:45,360
intelligence and how to derive stuff out

2051
01:14:45,360 --> 01:14:49,199
of it on um the mad training page

2052
01:14:49,199 --> 01:14:51,760
um but it's you know a separate hour

2053
01:14:51,760 --> 01:14:54,000
plus long course so i don't have time to

2054
01:14:54,000 --> 01:14:55,440
go into the nitty-gritty details

2055
01:14:55,440 --> 01:14:57,040
unfortunately

2056
01:14:57,040 --> 01:14:59,760
uh so and then from this sort of code

2057
01:14:59,760 --> 01:15:00,800
segment

2058
01:15:00,800 --> 01:15:03,600
our script we might extract these four

2059
01:15:03,600 --> 01:15:05,600
other techniques

2060
01:15:05,600 --> 01:15:07,280
and then this tweet

2061
01:15:07,280 --> 01:15:09,679
tweet mentions these other ones and so

2062
01:15:09,679 --> 01:15:11,120
now we're starting to build a bigger

2063
01:15:11,120 --> 01:15:13,440
picture of different techniques that are

2064
01:15:13,440 --> 01:15:16,000
being used that we can give to the sock

2065
01:15:16,000 --> 01:15:17,920
analysts or the csr members who are

2066
01:15:17,920 --> 01:15:20,000
responsible for building detections and

2067
01:15:20,000 --> 01:15:22,239
mitigations to what to look for

2068
01:15:22,239 --> 01:15:24,560
so instead of looking for everything

2069
01:15:24,560 --> 01:15:28,000
focus on this i don't know 20 let's call

2070
01:15:28,000 --> 01:15:30,159
it

2071
01:15:32,400 --> 01:15:35,040
so what do we do with it um

2072
01:15:35,040 --> 01:15:37,520
going back to our lsat member credential

2073
01:15:37,520 --> 01:15:39,440
or credential adopting lss memory

2074
01:15:39,440 --> 01:15:41,280
example

2075
01:15:41,280 --> 01:15:44,400
um we can see well mimikatz is pretty

2076
01:15:44,400 --> 01:15:46,400
common across all it's a pretty common

2077
01:15:46,400 --> 01:15:48,320
tool to implement all of those so

2078
01:15:48,320 --> 01:15:50,800
maybe as a defender or threat whoever's

2079
01:15:50,800 --> 01:15:52,719
responsible for this part might want to

2080
01:15:52,719 --> 01:15:54,000
spend some time investigating how

2081
01:15:54,000 --> 01:15:56,880
memecats works

2082
01:15:57,280 --> 01:15:58,960
um and going back to what we talked

2083
01:15:58,960 --> 01:16:01,360
about before the pyramid of pain looking

2084
01:16:01,360 --> 01:16:03,440
for things like the hash value or what a

2085
01:16:03,440 --> 01:16:07,040
hashtag for memecast is not useful

2086
01:16:07,040 --> 01:16:07,840
um

2087
01:16:07,840 --> 01:16:10,080
looking at their c2 that might use or

2088
01:16:10,080 --> 01:16:11,840
the rats that might use that is also not

2089
01:16:11,840 --> 01:16:13,520
helpful because the domain names that

2090
01:16:13,520 --> 01:16:15,199
that the text might be coming from is

2091
01:16:15,199 --> 01:16:18,320
also very volatile

2092
01:16:18,560 --> 01:16:20,000
so we want to think about what does

2093
01:16:20,000 --> 01:16:22,239
mimikatz actually do

2094
01:16:22,239 --> 01:16:23,920
now how does it

2095
01:16:23,920 --> 01:16:26,719
change lsas memory or mod or read lcs

2096
01:16:26,719 --> 01:16:29,360
memory and what can we as offenders do

2097
01:16:29,360 --> 01:16:31,199
start looking for that

2098
01:16:31,199 --> 01:16:32,719
and this is what we start talking about

2099
01:16:32,719 --> 01:16:34,480
behavioral based analytics

2100
01:16:34,480 --> 01:16:36,000
so we're not talking about analytics

2101
01:16:36,000 --> 01:16:38,400
based on ip addresses or hash values or

2102
01:16:38,400 --> 01:16:39,679
domain names

2103
01:16:39,679 --> 01:16:41,600
but about how

2104
01:16:41,600 --> 01:16:44,640
what is it that is inherent to that

2105
01:16:44,640 --> 01:16:46,640
technique or behavior that we can look

2106
01:16:46,640 --> 01:16:50,719
for that's more broadly applicable

2107
01:16:51,520 --> 01:16:54,239
so looking at that lsat's memory example

2108
01:16:54,239 --> 01:16:55,920
again

2109
01:16:55,920 --> 01:16:58,080
no we can monitor for unexpected

2110
01:16:58,080 --> 01:16:59,360
processes

2111
01:16:59,360 --> 01:17:03,080
interacting with lsas.exe

2112
01:17:03,600 --> 01:17:04,640
um

2113
01:17:04,640 --> 01:17:06,800
and then okay so how what does that look

2114
01:17:06,800 --> 01:17:08,159
like is there any other

2115
01:17:08,159 --> 01:17:10,560
resources we have for that

2116
01:17:10,560 --> 01:17:13,120
and in this case uh we've actually done

2117
01:17:13,120 --> 01:17:15,360
some work there uh we have something

2118
01:17:15,360 --> 01:17:17,040
called car which is a cyber analyst

2119
01:17:17,040 --> 01:17:18,400
repository

2120
01:17:18,400 --> 01:17:20,640
which has which is a database

2121
01:17:20,640 --> 01:17:22,320
or really it's a wiki

2122
01:17:22,320 --> 01:17:23,360
of

2123
01:17:23,360 --> 01:17:26,400
different analytics tied to different uh

2124
01:17:26,400 --> 01:17:27,600
techniques

2125
01:17:27,600 --> 01:17:29,199
and so you can do things like okay well

2126
01:17:29,199 --> 01:17:31,679
how can what analytics address mimikats

2127
01:17:31,679 --> 01:17:34,159
or address this specific technique

2128
01:17:34,159 --> 01:17:37,199
and then oh we have this analytic

2129
01:17:37,199 --> 01:17:39,920
out there that addresses that

2130
01:17:39,920 --> 01:17:42,800
so this analytic specifically addresses

2131
01:17:42,800 --> 01:17:45,360
memory dumping via mimikats

2132
01:17:45,360 --> 01:17:46,719
uh some credential droppers like

2133
01:17:46,719 --> 01:17:48,880
memocats can be loaded into memory and

2134
01:17:48,880 --> 01:17:50,719
from there we did it from another

2135
01:17:50,719 --> 01:17:52,000
processes

2136
01:17:52,000 --> 01:17:53,679
uh this and looks for instances where

2137
01:17:53,679 --> 01:17:55,280
processors are requesting specific

2138
01:17:55,280 --> 01:17:57,360
permissions to read parts of the lsas

2139
01:17:57,360 --> 01:17:58,480
process

2140
01:17:58,480 --> 01:17:59,840
in order to detect what incredible

2141
01:17:59,840 --> 01:18:01,679
dumping is occurring

2142
01:18:01,679 --> 01:18:03,679
uh there is a weakness uh which is that

2143
01:18:03,679 --> 01:18:06,000
all current implementations are uh

2144
01:18:06,000 --> 01:18:08,159
overtuned to look for common access

2145
01:18:08,159 --> 01:18:10,000
patterns associated with by mimikat so

2146
01:18:10,000 --> 01:18:12,400
there's still some weakness in this

2147
01:18:12,400 --> 01:18:13,520
but it is

2148
01:18:13,520 --> 01:18:15,600
better than looking at just process

2149
01:18:15,600 --> 01:18:17,840
creation and the meme cat string or

2150
01:18:17,840 --> 01:18:20,719
specific arguments

2151
01:18:21,600 --> 01:18:23,440
and so in this case this is like for any

2152
01:18:23,440 --> 01:18:24,560
process

2153
01:18:24,560 --> 01:18:26,719
that will access specifically lsat's

2154
01:18:26,719 --> 01:18:28,880
memory

2155
01:18:28,880 --> 01:18:30,480
uh for those not familiar this is the

2156
01:18:30,480 --> 01:18:33,360
cismod event code for process access

2157
01:18:33,360 --> 01:18:35,679
and these are values that you find in

2158
01:18:35,679 --> 01:18:39,760
the granted access field of those events

2159
01:18:39,760 --> 01:18:42,239
more specifically these are

2160
01:18:42,239 --> 01:18:44,159
an ending of the different flags

2161
01:18:44,159 --> 01:18:46,239
associated when a process asks for

2162
01:18:46,239 --> 01:18:48,480
permission to access another processes

2163
01:18:48,480 --> 01:18:50,080
memory space

2164
01:18:50,080 --> 01:18:53,440
and so when mimikatz uses a specific set

2165
01:18:53,440 --> 01:18:56,880
of flags usually to do that and so

2166
01:18:56,880 --> 01:19:00,320
that's what this analytic is keying on

2167
01:19:00,320 --> 01:19:03,759
now this is also why this is

2168
01:19:03,920 --> 01:19:05,920
fragile because then

2169
01:19:05,920 --> 01:19:07,199
someone who knows you're looking for

2170
01:19:07,199 --> 01:19:09,679
that can change the flags being used and

2171
01:19:09,679 --> 01:19:11,679
subvert this analytic but at least it's

2172
01:19:11,679 --> 01:19:14,880
better than what we had before

2173
01:19:14,880 --> 01:19:16,880
and again it's looking specific at lss

2174
01:19:16,880 --> 01:19:19,840
not just every process

2175
01:19:19,840 --> 01:19:22,560
but then okay now we've got an analytic

2176
01:19:22,560 --> 01:19:24,560
that's based on some concrete cyber

2177
01:19:24,560 --> 01:19:26,239
threat intelligence

2178
01:19:26,239 --> 01:19:28,640
um how do we validate that the analytic

2179
01:19:28,640 --> 01:19:30,080
works

2180
01:19:30,080 --> 01:19:33,120
uh so often times or historically red

2181
01:19:33,120 --> 01:19:35,840
teams have sort of fulfilled this role

2182
01:19:35,840 --> 01:19:38,719
red teams mimic known threats

2183
01:19:38,719 --> 01:19:40,400
and they allow us to operationalize

2184
01:19:40,400 --> 01:19:41,520
intelligence

2185
01:19:41,520 --> 01:19:43,199
using the scope and prioritize what

2186
01:19:43,199 --> 01:19:46,320
threats and behavior we test

2187
01:19:46,320 --> 01:19:49,120
they observe and evaluate our defenses

2188
01:19:49,120 --> 01:19:50,960
from the perspective of our adversaries

2189
01:19:50,960 --> 01:19:52,080
so

2190
01:19:52,080 --> 01:19:54,640
there's different ways these can occur

2191
01:19:54,640 --> 01:19:56,880
the most basic one is a red team comes

2192
01:19:56,880 --> 01:19:57,520
in

2193
01:19:57,520 --> 01:19:59,600
they do attacks and then they leave and

2194
01:19:59,600 --> 01:20:01,840
provide a report on what was what worked

2195
01:20:01,840 --> 01:20:04,640
when what didn't and so help inform the

2196
01:20:04,640 --> 01:20:07,520
defense what they need to improve

2197
01:20:07,520 --> 01:20:09,280
as i mentioned before

2198
01:20:09,280 --> 01:20:10,800
traditional red teams perhaps not

2199
01:20:10,800 --> 01:20:13,120
communicate this in an effective way and

2200
01:20:13,120 --> 01:20:14,880
using attack can help them not only

2201
01:20:14,880 --> 01:20:17,199
communicate their findings but also help

2202
01:20:17,199 --> 01:20:18,639
them plan

2203
01:20:18,639 --> 01:20:19,440
their

2204
01:20:19,440 --> 01:20:20,960
side of events

2205
01:20:20,960 --> 01:20:22,800
better

2206
01:20:22,800 --> 01:20:26,159
so this example

2207
01:20:28,239 --> 01:20:31,040
you know there's different ways of

2208
01:20:31,040 --> 01:20:34,400
doing this specific technique

2209
01:20:34,400 --> 01:20:35,679
there's

2210
01:20:35,679 --> 01:20:37,440
one too

2211
01:20:37,440 --> 01:20:38,560
many

2212
01:20:38,560 --> 01:20:40,320
as we saw before and we were hoping that

2213
01:20:40,320 --> 01:20:42,159
this addresses all

2214
01:20:42,159 --> 01:20:44,239
the detect the different ways

2215
01:20:44,239 --> 01:20:45,040
uh

2216
01:20:45,040 --> 01:20:47,280
that this specific technique can be done

2217
01:20:47,280 --> 01:20:48,800
but the reality might not

2218
01:20:48,800 --> 01:20:50,560
be that we might not we may have use

2219
01:20:50,560 --> 01:20:52,400
cases or edge cases that we did not

2220
01:20:52,400 --> 01:20:54,480
account for

2221
01:20:54,480 --> 01:20:57,280
so and we can look at uh other cyber

2222
01:20:57,280 --> 01:20:58,639
threat and tell us okay how else are

2223
01:20:58,639 --> 01:21:01,840
people doing this specific technique

2224
01:21:01,840 --> 01:21:04,080
that maybe the blue team missed

2225
01:21:04,080 --> 01:21:05,840
and make sure we try to incorporate that

2226
01:21:05,840 --> 01:21:07,920
into our plan we're trying to average or

2227
01:21:07,920 --> 01:21:10,880
emulate an adversary

2228
01:21:10,880 --> 01:21:13,040
so we want to ask ourselves okay if an

2229
01:21:13,040 --> 01:21:15,600
adversary is going to do it this way

2230
01:21:15,600 --> 01:21:17,520
let's make sure we replicate the

2231
01:21:17,520 --> 01:21:20,000
activity that way in our network to say

2232
01:21:20,000 --> 01:21:21,679
ask so we can answer the question are we

2233
01:21:21,679 --> 01:21:24,000
safe

2234
01:21:24,480 --> 01:21:27,040
and so we have the program called miter

2235
01:21:27,040 --> 01:21:29,520
attack evaluations which tries

2236
01:21:29,520 --> 01:21:32,400
to do this for you i'm at least in some

2237
01:21:32,400 --> 01:21:34,880
limited capacity you can't do everything

2238
01:21:34,880 --> 01:21:37,760
but we try to look at different

2239
01:21:37,760 --> 01:21:40,880
programs different vendor products

2240
01:21:40,880 --> 01:21:42,880
and okay look at

2241
01:21:42,880 --> 01:21:45,280
which sort of techniques might be done

2242
01:21:45,280 --> 01:21:46,480
and

2243
01:21:46,480 --> 01:21:48,639
run it against those tools so we can say

2244
01:21:48,639 --> 01:21:50,560
with some degree of certainty

2245
01:21:50,560 --> 01:21:52,639
yes this vendors probably will detect

2246
01:21:52,639 --> 01:21:54,320
that or no it won't

2247
01:21:54,320 --> 01:21:56,560
and these are done in collaboration with

2248
01:21:56,560 --> 01:21:58,960
those vendors

2249
01:21:58,960 --> 01:22:01,199
so here we have like on step 14 of the

2250
01:22:01,199 --> 01:22:02,800
emulation plan

2251
01:22:02,800 --> 01:22:04,560
um here's a high

2252
01:22:04,560 --> 01:22:06,159
uh level overview of the emulation

2253
01:22:06,159 --> 01:22:07,840
techniques evaluated

2254
01:22:07,840 --> 01:22:10,000
um here's a cyber threat intelligence

2255
01:22:10,000 --> 01:22:12,000
that we're going to reference for that

2256
01:22:12,000 --> 01:22:14,239
um here are the contributors to that and

2257
01:22:14,239 --> 01:22:15,760
then here's

2258
01:22:15,760 --> 01:22:18,400
sort of a verbal plan for how it's going

2259
01:22:18,400 --> 01:22:20,560
to run in the content of it so we're

2260
01:22:20,560 --> 01:22:22,960
going to have node 2 payloads

2261
01:22:22,960 --> 01:22:24,400
uh they're going to be

2262
01:22:24,400 --> 01:22:27,199
called this and that and so on

2263
01:22:27,199 --> 01:22:29,120
and so this is also available for you to

2264
01:22:29,120 --> 01:22:30,080
use

2265
01:22:30,080 --> 01:22:32,080
as um if you wish

2266
01:22:32,080 --> 01:22:33,760
or to reference

2267
01:22:33,760 --> 01:22:35,360
and here's where the insert intelligence

2268
01:22:35,360 --> 01:22:37,679
comes so how should that readme file

2269
01:22:37,679 --> 01:22:39,120
look

2270
01:22:39,120 --> 01:22:41,040
how should we configure

2271
01:22:41,040 --> 01:22:44,080
this uh bypass uac script

2272
01:22:44,080 --> 01:22:46,000
and so the the more intelligence we have

2273
01:22:46,000 --> 01:22:48,239
how those things work the more

2274
01:22:48,239 --> 01:22:50,159
uh we can be sure that it would work in

2275
01:22:50,159 --> 01:22:54,080
the case of an actual adversary using it

2276
01:22:55,280 --> 01:22:57,120
and so we've blown out this is what that

2277
01:22:57,120 --> 01:22:59,520
might look like

2278
01:22:59,520 --> 01:23:01,199
uh from the threat so the threat

2279
01:23:01,199 --> 01:23:02,880
intelligence people might give this to

2280
01:23:02,880 --> 01:23:05,199
the red team say okay this is what

2281
01:23:05,199 --> 01:23:08,159
apt 29 is doing and for this exercise we

2282
01:23:08,159 --> 01:23:09,120
want to

2283
01:23:09,120 --> 01:23:11,600
emulate apt-29 so

2284
01:23:11,600 --> 01:23:12,719
please

2285
01:23:12,719 --> 01:23:15,840
roughly or stick to this script when

2286
01:23:15,840 --> 01:23:17,440
doing it so we can say with some

2287
01:23:17,440 --> 01:23:20,239
certainty if fabric is our network they

2288
01:23:20,239 --> 01:23:21,440
will probably

2289
01:23:21,440 --> 01:23:24,000
execute the technique this way

2290
01:23:24,000 --> 01:23:25,679
and we can make sure that our detections

2291
01:23:25,679 --> 01:23:28,320
work against that

2292
01:23:28,320 --> 01:23:30,159
now you may also want to give the red

2293
01:23:30,159 --> 01:23:32,639
team some flexibility in what they do

2294
01:23:32,639 --> 01:23:35,120
to explore other options that maybe

2295
01:23:35,120 --> 01:23:37,120
the cyber threat intelligence analysts

2296
01:23:37,120 --> 01:23:39,440
did not think of or push the boundaries

2297
01:23:39,440 --> 01:23:41,840
of our defense more

2298
01:23:41,840 --> 01:23:43,280
at least this gives us a way of saying

2299
01:23:43,280 --> 01:23:44,719
with some degree of certainty we are

2300
01:23:44,719 --> 01:23:49,400
protecting against adversary x

2301
01:23:50,800 --> 01:23:52,080
um so

2302
01:23:52,080 --> 01:23:53,600
this is sort of what the

2303
01:23:53,600 --> 01:23:54,960
another threat informed assessment

2304
01:23:54,960 --> 01:23:58,400
looked like for fin6

2305
01:23:59,199 --> 01:24:02,719
which is this group id g37

2306
01:24:02,719 --> 01:24:04,239
which has these associated groups and so

2307
01:24:04,239 --> 01:24:06,000
it has sort of objective objectives and

2308
01:24:06,000 --> 01:24:07,120
evolution

2309
01:24:07,120 --> 01:24:09,280
who they target operations

2310
01:24:09,280 --> 01:24:11,840
and so you try to create a plan

2311
01:24:11,840 --> 01:24:13,440
for how

2312
01:24:13,440 --> 01:24:16,400
they how to replicate what they do so

2313
01:24:16,400 --> 01:24:17,840
others in the community can do it

2314
01:24:17,840 --> 01:24:19,280
themselves as well

2315
01:24:19,280 --> 01:24:20,800
so it's not just you going home and

2316
01:24:20,800 --> 01:24:23,760
running whatever script you saw but like

2317
01:24:23,760 --> 01:24:24,639
okay

2318
01:24:24,639 --> 01:24:27,679
first they do account discovery and then

2319
01:24:27,679 --> 01:24:28,960
but they might do it one of two ways i

2320
01:24:28,960 --> 01:24:30,400
might do it this way or that way so

2321
01:24:30,400 --> 01:24:32,480
maybe we have to mix it up in order to

2322
01:24:32,480 --> 01:24:34,800
have some degree of certainty that we're

2323
01:24:34,800 --> 01:24:36,480
going to detect them

2324
01:24:36,480 --> 01:24:37,679
and then they'll move on to remote

2325
01:24:37,679 --> 01:24:39,040
system discovery

2326
01:24:39,040 --> 01:24:40,800
so it's not just

2327
01:24:40,800 --> 01:24:42,560
as simple as

2328
01:24:42,560 --> 01:24:44,960
populating this script with 10

2329
01:24:44,960 --> 01:24:47,199
power shell lines and then running that

2330
01:24:47,199 --> 01:24:48,960
and it's calling it done

2331
01:24:48,960 --> 01:24:50,080
we try to have a little more thought

2332
01:24:50,080 --> 01:24:51,360
about it and this can also include

2333
01:24:51,360 --> 01:24:52,480
things like

2334
01:24:52,480 --> 01:24:54,719
well we want to go low and slow

2335
01:24:54,719 --> 01:24:56,880
so you know we're going to do something

2336
01:24:56,880 --> 01:24:58,880
at minute zero and then we're gonna wait

2337
01:24:58,880 --> 01:25:00,880
30 minutes before we do the next thing

2338
01:25:00,880 --> 01:25:02,320
because maybe that'll trip up our

2339
01:25:02,320 --> 01:25:05,120
detections that they're looking for

2340
01:25:05,120 --> 01:25:06,639
things happening in a short period of

2341
01:25:06,639 --> 01:25:08,960
time

2342
01:25:10,159 --> 01:25:13,360
but the goal is always to improve uh so

2343
01:25:13,360 --> 01:25:14,400
improve

2344
01:25:14,400 --> 01:25:17,199
uh the red team's uh abilities to

2345
01:25:17,199 --> 01:25:20,320
approve the defensive capabilities

2346
01:25:20,320 --> 01:25:22,639
uh so but we had to measure that and

2347
01:25:22,639 --> 01:25:23,920
track progress through things like

2348
01:25:23,920 --> 01:25:26,320
assessing car coverage and prioritizing

2349
01:25:26,320 --> 01:25:28,639
gaps and tuning our defenses so this

2350
01:25:28,639 --> 01:25:31,679
starts getting to the engineering

2351
01:25:31,679 --> 01:25:34,239
aspect of

2352
01:25:34,239 --> 01:25:35,199
uh

2353
01:25:35,199 --> 01:25:36,960
using attack

2354
01:25:36,960 --> 01:25:39,360
so we have okay we have this the text we

2355
01:25:39,360 --> 01:25:40,560
want to use

2356
01:25:40,560 --> 01:25:43,520
but when we did the red team

2357
01:25:43,520 --> 01:25:45,360
we found that we've detected three

2358
01:25:45,360 --> 01:25:47,520
different ways uh that they might do it

2359
01:25:47,520 --> 01:25:49,040
but we missed two

2360
01:25:49,040 --> 01:25:50,560
so what does that mean

2361
01:25:50,560 --> 01:25:52,719
well that means we still have a gap in

2362
01:25:52,719 --> 01:25:55,040
our coverage for that technique for lcs

2363
01:25:55,040 --> 01:25:57,440
memory

2364
01:25:57,840 --> 01:26:00,719
uh or you know it maybe they're doing

2365
01:26:00,719 --> 01:26:02,320
different ways of

2366
01:26:02,320 --> 01:26:03,920
maybe we're asking ourselves for

2367
01:26:03,920 --> 01:26:05,440
credential dom okay we've got elsas

2368
01:26:05,440 --> 01:26:08,320
covered but maybe not the others

2369
01:26:08,320 --> 01:26:10,880
there's lots of different ways to look

2370
01:26:10,880 --> 01:26:13,199
at credential access specifically so

2371
01:26:13,199 --> 01:26:15,520
just because you have lss

2372
01:26:15,520 --> 01:26:16,560
covered

2373
01:26:16,560 --> 01:26:17,520
or

2374
01:26:17,520 --> 01:26:18,800
partially covered doesn't mean you have

2375
01:26:18,800 --> 01:26:20,880
any of the other ones

2376
01:26:20,880 --> 01:26:23,199
so a lot of times we'll mark this if

2377
01:26:23,199 --> 01:26:24,560
you're doing a very simple one like this

2378
01:26:24,560 --> 01:26:26,480
is partial so it's yellow

2379
01:26:26,480 --> 01:26:28,480
so in our chart

2380
01:26:28,480 --> 01:26:32,480
um we might have a red yellow green

2381
01:26:32,480 --> 01:26:33,360
um

2382
01:26:33,360 --> 01:26:34,960
way of marking things like green is we

2383
01:26:34,960 --> 01:26:36,639
got we'll detect it

2384
01:26:36,639 --> 01:26:39,120
yellow is well subtypes detect it and

2385
01:26:39,120 --> 01:26:40,880
red is we won't

2386
01:26:40,880 --> 01:26:43,440
and so for this specific technique

2387
01:26:43,440 --> 01:26:45,840
and this um sub technique

2388
01:26:45,840 --> 01:26:47,920
we are maybe

2389
01:26:47,920 --> 01:26:50,239
and you look at the larger chart you

2390
01:26:50,239 --> 01:26:51,760
know we start looking at okay what other

2391
01:26:51,760 --> 01:26:53,840
techniques do we care about

2392
01:26:53,840 --> 01:26:55,679
and then accept that we can't cover

2393
01:26:55,679 --> 01:26:56,880
everything

2394
01:26:56,880 --> 01:26:59,040
and then for each of these we would go

2395
01:26:59,040 --> 01:27:01,360
through the same process of

2396
01:27:01,360 --> 01:27:03,840
okay how are these threats being done

2397
01:27:03,840 --> 01:27:05,360
who's and who are we carrying up who do

2398
01:27:05,360 --> 01:27:06,719
we care about

2399
01:27:06,719 --> 01:27:08,480
how can we build an analytic to detect

2400
01:27:08,480 --> 01:27:10,400
those and then slowly we can start

2401
01:27:10,400 --> 01:27:12,159
populating this chart with that

2402
01:27:12,159 --> 01:27:13,760
information

2403
01:27:13,760 --> 01:27:16,480
and we might as we indicate here

2404
01:27:16,480 --> 01:27:18,239
we're not going to cover everything

2405
01:27:18,239 --> 01:27:19,760
there's too much

2406
01:27:19,760 --> 01:27:21,760
and so we have to accept some risk some

2407
01:27:21,760 --> 01:27:24,000
in some places say you know what either

2408
01:27:24,000 --> 01:27:25,120
this is

2409
01:27:25,120 --> 01:27:28,080
not used very often or

2410
01:27:28,080 --> 01:27:29,840
we have other things in place to

2411
01:27:29,840 --> 01:27:32,719
mitigate it or you know just we should

2412
01:27:32,719 --> 01:27:35,120
consider it low risk

2413
01:27:35,120 --> 01:27:36,480
and so we have to make those sorts of

2414
01:27:36,480 --> 01:27:37,760
decisions when we start talking about

2415
01:27:37,760 --> 01:27:40,400
the engineering aspects of

2416
01:27:40,400 --> 01:27:41,199
our

2417
01:27:41,199 --> 01:27:44,080
in security architecture

2418
01:27:44,080 --> 01:27:46,480
so you want to do it one piece at a time

2419
01:27:46,480 --> 01:27:49,760
uh using informed decisions

2420
01:27:49,760 --> 01:27:51,600
um the assessments and we want to do the

2421
01:27:51,600 --> 01:27:53,280
assessments using threats because that

2422
01:27:53,280 --> 01:27:55,440
will lead us towards knowing where the

2423
01:27:55,440 --> 01:27:58,480
necessary enhancements we need to make

2424
01:27:58,480 --> 01:27:59,920
and this is a cumulative iterative

2425
01:27:59,920 --> 01:28:01,679
process that never stops

2426
01:28:01,679 --> 01:28:03,920
so i'll take for example the network i

2427
01:28:03,920 --> 01:28:05,920
used to run we used to do these

2428
01:28:05,920 --> 01:28:07,360
exercises

2429
01:28:07,360 --> 01:28:08,800
bi-monthly

2430
01:28:08,800 --> 01:28:10,880
it's in order to assess okay we're going

2431
01:28:10,880 --> 01:28:12,840
to do emulate this adversary these

2432
01:28:12,840 --> 01:28:15,600
techniques uh we've got

2433
01:28:15,600 --> 01:28:17,040
let's see if we can recreate what they

2434
01:28:17,040 --> 01:28:19,520
did build detections for them

2435
01:28:19,520 --> 01:28:20,960
and then see how well they work the next

2436
01:28:20,960 --> 01:28:23,679
time or do we have gaps in sensing or do

2437
01:28:23,679 --> 01:28:25,840
we have gaps in our analytics we're

2438
01:28:25,840 --> 01:28:28,159
constantly doing that iterative process

2439
01:28:28,159 --> 01:28:30,080
to better to continuously improve

2440
01:28:30,080 --> 01:28:32,239
ourselves and this also helps the red

2441
01:28:32,239 --> 01:28:33,120
teams

2442
01:28:33,120 --> 01:28:34,320
because they get a

2443
01:28:34,320 --> 01:28:36,719
sense of how they can be detected and it

2444
01:28:36,719 --> 01:28:40,400
pushes them to improve their skills

2445
01:28:40,400 --> 01:28:41,600
and different how to actually different

2446
01:28:41,600 --> 01:28:43,840
techniques

2447
01:28:44,480 --> 01:28:46,639
but ultimately security is hard

2448
01:28:46,639 --> 01:28:48,560
um and it's easier when we coordinate

2449
01:28:48,560 --> 01:28:50,639
and communicate and work together

2450
01:28:50,639 --> 01:28:52,400
and that's something attack really helps

2451
01:28:52,400 --> 01:28:55,120
us do across all those different teams

2452
01:28:55,120 --> 01:28:56,719
in a lot of socks those four different

2453
01:28:56,719 --> 01:28:58,320
use cases are handled by completely

2454
01:28:58,320 --> 01:28:59,600
different groups

2455
01:28:59,600 --> 01:29:02,159
you know cti is handled by one group

2456
01:29:02,159 --> 01:29:03,840
then you have a bunch of sock analysts

2457
01:29:03,840 --> 01:29:06,000
developing analytics and then you have

2458
01:29:06,000 --> 01:29:09,120
network engineers who are independently

2459
01:29:09,120 --> 01:29:11,040
building up the security architecture to

2460
01:29:11,040 --> 01:29:15,360
support the never defense

2461
01:29:16,239 --> 01:29:18,159
and we have to keep in mind why we're

2462
01:29:18,159 --> 01:29:20,320
doing this now we don't want to just get

2463
01:29:20,320 --> 01:29:21,840
in the mindset of okay we're doing it to

2464
01:29:21,840 --> 01:29:24,320
fill in boxes we want all boxes to be in

2465
01:29:24,320 --> 01:29:25,199
green

2466
01:29:25,199 --> 01:29:27,199
uh we don't want to do that

2467
01:29:27,199 --> 01:29:29,199
we want to make sure we that we're doing

2468
01:29:29,199 --> 01:29:31,920
this to understand our threats

2469
01:29:31,920 --> 01:29:34,320
and have that inform our actions and

2470
01:29:34,320 --> 01:29:36,880
decisions that should inform why we're

2471
01:29:36,880 --> 01:29:39,520
purchasing or installing tools

2472
01:29:39,520 --> 01:29:41,040
this is why we're developing these

2473
01:29:41,040 --> 01:29:43,040
analytics

2474
01:29:43,040 --> 01:29:45,760
and so on

2475
01:29:47,280 --> 01:29:49,679
so attack gives us a quantifiable way of

2476
01:29:49,679 --> 01:29:51,679
understanding tracking communicating and

2477
01:29:51,679 --> 01:29:52,800
addressing

2478
01:29:52,800 --> 01:29:54,880
what our threats are doing

2479
01:29:54,880 --> 01:29:56,159
and we can use this knowledge to gain

2480
01:29:56,159 --> 01:29:58,560
strategic and operational advantages

2481
01:29:58,560 --> 01:30:00,880
which ultimately will hopefully

2482
01:30:00,880 --> 01:30:03,040
improve our ability to defend uh

2483
01:30:03,040 --> 01:30:05,440
networks as a community and not just

2484
01:30:05,440 --> 01:30:08,480
uh for ourselves

2485
01:30:09,600 --> 01:30:10,880
so

2486
01:30:10,880 --> 01:30:12,320
but if we all

2487
01:30:12,320 --> 01:30:14,159
uh speak the second language we can also

2488
01:30:14,159 --> 01:30:15,679
say okay i'm seeing command and

2489
01:30:15,679 --> 01:30:16,800
scripting

2490
01:30:16,800 --> 01:30:18,400
uh using an interpreter in this case

2491
01:30:18,400 --> 01:30:20,880
powershell and if we're all on the same

2492
01:30:20,880 --> 01:30:22,480
page about what that means through the

2493
01:30:22,480 --> 01:30:24,239
attack framework we all know what that

2494
01:30:24,239 --> 01:30:25,679
means

2495
01:30:25,679 --> 01:30:28,320
you know if we just say i saw this thing

2496
01:30:28,320 --> 01:30:29,920
in command line and it happens being a

2497
01:30:29,920 --> 01:30:31,520
coded powershell nobody knows what that

2498
01:30:31,520 --> 01:30:33,840
is necessarily maybe a couple experts

2499
01:30:33,840 --> 01:30:35,840
know but the community at large doesn't

2500
01:30:35,840 --> 01:30:38,560
but framing it in this way allows us as

2501
01:30:38,560 --> 01:30:40,800
a community to understand what everybody

2502
01:30:40,800 --> 01:30:42,639
else is talking about

2503
01:30:42,639 --> 01:30:46,239
and allows for a degree of anonymization

2504
01:30:46,239 --> 01:30:49,040
for things like companies who maybe are

2505
01:30:49,040 --> 01:30:51,040
concerned about releasing too much

2506
01:30:51,040 --> 01:30:53,120
information about a compromise in their

2507
01:30:53,120 --> 01:30:55,519
network

2508
01:30:56,560 --> 01:30:59,280
uh so there's lots of information uh

2509
01:30:59,280 --> 01:31:01,520
more about these different use cases

2510
01:31:01,520 --> 01:31:03,520
um again there's the getting started

2511
01:31:03,520 --> 01:31:05,440
attack ebook

2512
01:31:05,440 --> 01:31:06,880
and we also have

2513
01:31:06,880 --> 01:31:08,400
not just this training but other

2514
01:31:08,400 --> 01:31:10,320
trainings uh four different ways of

2515
01:31:10,320 --> 01:31:11,840
using attack

2516
01:31:11,840 --> 01:31:14,480
at the miter uh attack

2517
01:31:14,480 --> 01:31:16,159
defender

2518
01:31:16,159 --> 01:31:20,638
or mad learning courses on siberia

2519
01:31:20,960 --> 01:31:23,120
so in summary

2520
01:31:23,120 --> 01:31:25,440
um this is the attack framework and it

2521
01:31:25,440 --> 01:31:26,719
really helps us

2522
01:31:26,719 --> 01:31:28,800
communicate with each other as well as

2523
01:31:28,800 --> 01:31:30,960
get after a lot of the different

2524
01:31:30,960 --> 01:31:33,040
problems uh we're trying to address when

2525
01:31:33,040 --> 01:31:36,400
trying to do network defense

2526
01:31:36,560 --> 01:31:39,280
uh so with that uh here's again the link

2527
01:31:39,280 --> 01:31:42,080
as well as uh the attack twitter

2528
01:31:42,080 --> 01:31:44,480
if you want to follow them and with that

2529
01:31:44,480 --> 01:31:48,159
i will open up to questions and if not

2530
01:31:48,159 --> 01:31:50,320
questions then i will run through a

2531
01:31:50,320 --> 01:31:51,840
quick example

2532
01:31:51,840 --> 01:31:57,000
on the attack navigator and attack site

2533
01:32:03,840 --> 01:32:05,920
so there are a couple questions in the q

2534
01:32:05,920 --> 01:32:07,120
a

2535
01:32:07,120 --> 01:32:08,080
button

2536
01:32:08,080 --> 01:32:11,080
okay

2537
01:32:12,800 --> 01:32:15,199
okay so question number one

2538
01:32:15,199 --> 01:32:17,360
oh what is the best practice to prevent

2539
01:32:17,360 --> 01:32:19,840
an attack

2540
01:32:19,840 --> 01:32:20,960
do you uh when you're talking about

2541
01:32:20,960 --> 01:32:22,639
preventing attacks you're looking at the

2542
01:32:22,639 --> 01:32:25,120
mitigations on the attack page

2543
01:32:25,120 --> 01:32:26,560
um

2544
01:32:26,560 --> 01:32:28,400
it's not

2545
01:32:28,400 --> 01:32:30,080
a matter of

2546
01:32:30,080 --> 01:32:31,360
just

2547
01:32:31,360 --> 01:32:34,719
no this mitigation works for everything

2548
01:32:34,719 --> 01:32:37,760
there's an example that my professor in

2549
01:32:37,760 --> 01:32:39,679
when i do my master's

2550
01:32:39,679 --> 01:32:41,920
talked about

2551
01:32:41,920 --> 01:32:44,560
okay um that was the only secure system

2552
01:32:44,560 --> 01:32:46,880
or a computer is one that doesn't work

2553
01:32:46,880 --> 01:32:49,040
or in case in concrete

2554
01:32:49,040 --> 01:32:51,600
so uh the more functionality or useful

2555
01:32:51,600 --> 01:32:53,520
system is generally the more option

2556
01:32:53,520 --> 01:32:55,440
there is to misuse it

2557
01:32:55,440 --> 01:32:56,800
and so really when you're talking about

2558
01:32:56,800 --> 01:32:58,320
how to prevent it

2559
01:32:58,320 --> 01:33:00,159
it you know it depends on the instance

2560
01:33:00,159 --> 01:33:03,840
uh so i'll open the floor to

2561
01:33:03,840 --> 01:33:05,360
events three

2562
01:33:05,360 --> 01:33:07,840
i'm not sure how to do that though

2563
01:33:07,840 --> 01:33:11,120
they would like to answer the question

2564
01:33:11,360 --> 01:33:14,080
nope i was just setting it up for you oh

2565
01:33:14,080 --> 01:33:15,360
okay

2566
01:33:15,360 --> 01:33:17,600
sorry i thought you were trying to

2567
01:33:17,600 --> 01:33:20,080
answer it

2568
01:33:20,320 --> 01:33:23,840
so what is the best tactics um

2569
01:33:23,840 --> 01:33:26,400
again this is very subjective

2570
01:33:26,400 --> 01:33:28,639
let me bring up the attack site real

2571
01:33:28,639 --> 01:33:32,080
quick if i can

2572
01:33:33,280 --> 01:33:35,120
this is the navigator but that'll work

2573
01:33:35,120 --> 01:33:38,000
just as well

2574
01:33:38,639 --> 01:33:39,840
so

2575
01:33:39,840 --> 01:33:42,880
um this is the current version of attack

2576
01:33:42,880 --> 01:33:44,480
and from the attack you see we have all

2577
01:33:44,480 --> 01:33:47,440
these tactics groups

2578
01:33:47,440 --> 01:33:50,239
i would some might say well the best

2579
01:33:50,239 --> 01:33:51,440
tactic is the one that has the most

2580
01:33:51,440 --> 01:33:52,560
techniques

2581
01:33:52,560 --> 01:33:54,159
in this case that would be defensive

2582
01:33:54,159 --> 01:33:55,520
asian

2583
01:33:55,520 --> 01:33:58,719
um some might say theologists say well

2584
01:33:58,719 --> 01:33:59,920
you should go for the one that has the

2585
01:33:59,920 --> 01:34:02,320
smallest number of techniques because

2586
01:34:02,320 --> 01:34:03,920
you are more likely to be able to write

2587
01:34:03,920 --> 01:34:04,960
all the

2588
01:34:04,960 --> 01:34:06,560
detection or mitigation that addresses

2589
01:34:06,560 --> 01:34:08,639
all those

2590
01:34:08,639 --> 01:34:11,520
again that's not really necessarily true

2591
01:34:11,520 --> 01:34:14,000
or at least nothing so i

2592
01:34:14,000 --> 01:34:15,920
we have you can think about it sometimes

2593
01:34:15,920 --> 01:34:18,400
like there is in this in terms of cyber

2594
01:34:18,400 --> 01:34:20,000
kill chain you know they're going to do

2595
01:34:20,000 --> 01:34:21,520
this and then that and then that and

2596
01:34:21,520 --> 01:34:24,080
then if you can find the break point

2597
01:34:24,080 --> 01:34:26,000
in that execution

2598
01:34:26,000 --> 01:34:27,760
then maybe that is where you want to

2599
01:34:27,760 --> 01:34:30,080
focus but that's gonna be uh very much

2600
01:34:30,080 --> 01:34:32,880
dependent on the specific group you're

2601
01:34:32,880 --> 01:34:34,480
talking about so going back to your

2602
01:34:34,480 --> 01:34:37,199
which specific threat you mean

2603
01:34:37,199 --> 01:34:39,199
if you want to do if your goal is to

2604
01:34:39,199 --> 01:34:41,600
limit the extent of compromise

2605
01:34:41,600 --> 01:34:43,199
maybe you want to focus on lateral

2606
01:34:43,199 --> 01:34:45,679
movements because if you can lock down

2607
01:34:45,679 --> 01:34:47,679
lateral movement they can only ever

2608
01:34:47,679 --> 01:34:50,239
exist on one system which may be your

2609
01:34:50,239 --> 01:34:52,639
max or you're minimizing your risk that

2610
01:34:52,639 --> 01:34:54,239
way

2611
01:34:54,239 --> 01:34:56,000
or maybe you say

2612
01:34:56,000 --> 01:34:58,400
that they can't ever get credentials

2613
01:34:58,400 --> 01:35:00,400
um that will

2614
01:35:00,400 --> 01:35:02,159
by its nature

2615
01:35:02,159 --> 01:35:03,920
limit lateral movement

2616
01:35:03,920 --> 01:35:05,760
uh and limit them to

2617
01:35:05,760 --> 01:35:07,119
um

2618
01:35:07,119 --> 01:35:09,440
limited privilege uh executions which

2619
01:35:09,440 --> 01:35:10,719
will keep them from doing anything too

2620
01:35:10,719 --> 01:35:12,400
bad

2621
01:35:12,400 --> 01:35:13,520
so

2622
01:35:13,520 --> 01:35:15,920
the answer is there is no easy answer

2623
01:35:15,920 --> 01:35:18,639
it's going to be up to sort of your goal

2624
01:35:18,639 --> 01:35:20,560
and what threats you're looking at

2625
01:35:20,560 --> 01:35:23,199
to where you kind of want to focus um i

2626
01:35:23,199 --> 01:35:25,840
personally as a

2627
01:35:25,840 --> 01:35:27,840
developer of analytics

2628
01:35:27,840 --> 01:35:30,639
i a lot i spend a lot of my time looking

2629
01:35:30,639 --> 01:35:32,080
at

2630
01:35:32,080 --> 01:35:34,159
i would say execution

2631
01:35:34,159 --> 01:35:35,760
uh because it's kind of the easiest to

2632
01:35:35,760 --> 01:35:37,280
start thinking about

2633
01:35:37,280 --> 01:35:39,119
uh because a lot of times it's things

2634
01:35:39,119 --> 01:35:41,280
like process creation

2635
01:35:41,280 --> 01:35:43,119
and so it's a lot easier to mentally

2636
01:35:43,119 --> 01:35:45,360
understand what's happening there

2637
01:35:45,360 --> 01:35:47,119
and then from there you start thinking

2638
01:35:47,119 --> 01:35:48,239
about

2639
01:35:48,239 --> 01:35:50,480
well okay i can see mimikatz here

2640
01:35:50,480 --> 01:35:52,000
but how do i

2641
01:35:52,000 --> 01:35:53,920
move from memecast there to how it's

2642
01:35:53,920 --> 01:35:55,440
really working

2643
01:35:55,440 --> 01:35:58,960
under credential access

2644
01:36:00,880 --> 01:36:04,080
so i hope that answers your question

2645
01:36:04,080 --> 01:36:05,840
and then taking

2646
01:36:05,840 --> 01:36:07,360
the example of a cyber attack and

2647
01:36:07,360 --> 01:36:08,480
mapping it

2648
01:36:08,480 --> 01:36:10,400
as a deep dive

2649
01:36:10,400 --> 01:36:12,159
okay so

2650
01:36:12,159 --> 01:36:15,119
let us take

2651
01:36:16,800 --> 01:36:18,639
let's see what is a good i'm going to do

2652
01:36:18,639 --> 01:36:20,480
schedule task because i know that one

2653
01:36:20,480 --> 01:36:24,839
quite well as long as i can find it

2654
01:36:25,440 --> 01:36:28,719
that is not what i wanted to do

2655
01:36:32,880 --> 01:36:35,840
uh so schedule tasks

2656
01:36:35,840 --> 01:36:37,360
uh so

2657
01:36:37,360 --> 01:36:40,080
uh scheduled tests exists in several

2658
01:36:40,080 --> 01:36:42,560
uh places thus looking at

2659
01:36:42,560 --> 01:36:44,719
specifically execution uh just for

2660
01:36:44,719 --> 01:36:46,719
example

2661
01:36:46,719 --> 01:36:48,480
and what so

2662
01:36:48,480 --> 01:36:50,880
how do you do discussion prefs we have

2663
01:36:50,880 --> 01:36:52,560
some threat intelligence

2664
01:36:52,560 --> 01:36:54,000
uh that's also what's threatened told

2665
01:36:54,000 --> 01:36:58,080
you might have told us to focus on this

2666
01:37:00,239 --> 01:37:01,920
so let us say

2667
01:37:01,920 --> 01:37:04,320
we read

2668
01:37:04,320 --> 01:37:07,520
uh this specific uh paper from

2669
01:37:07,520 --> 01:37:10,080
kaspersky no conspiracy lab is a

2670
01:37:10,080 --> 01:37:12,400
relatively well-known anti-virus vendor

2671
01:37:12,400 --> 01:37:14,480
who publishes regular reports so it's

2672
01:37:14,480 --> 01:37:17,600
probably a high degree of confidence

2673
01:37:17,600 --> 01:37:21,840
that this is a good source

2674
01:37:22,880 --> 01:37:25,119
and so we might look at

2675
01:37:25,119 --> 01:37:26,000
okay

2676
01:37:26,000 --> 01:37:28,880
uh adversaries made use task scheduling

2677
01:37:28,880 --> 01:37:31,920
etc etc

2678
01:37:32,840 --> 01:37:34,960
okay and they might use it to do these

2679
01:37:34,960 --> 01:37:37,199
kind of things for detection

2680
01:37:37,199 --> 01:37:39,199
you know what might we look at in here

2681
01:37:39,199 --> 01:37:42,638
you know here's a registry key

2682
01:37:42,960 --> 01:37:44,719
um but

2683
01:37:44,719 --> 01:37:46,000
that's separately you might wanna do

2684
01:37:46,000 --> 01:37:48,480
okay this is this is okay information

2685
01:37:48,480 --> 01:37:51,199
but as a defender

2686
01:37:51,199 --> 01:37:53,440
maybe i want more

2687
01:37:53,440 --> 01:37:55,360
um like maybe this is what the cyber

2688
01:37:55,360 --> 01:37:57,280
threat intelligence gave me like you

2689
01:37:57,280 --> 01:37:59,360
know we're seeing i've got a threat

2690
01:37:59,360 --> 01:38:01,840
report from kaspersky that says they're

2691
01:38:01,840 --> 01:38:04,880
doing schedule tasks

2692
01:38:04,880 --> 01:38:06,159
and they're doing scheduled tasks

2693
01:38:06,159 --> 01:38:09,199
specifically uh using the sch task

2694
01:38:09,199 --> 01:38:10,719
utility

2695
01:38:10,719 --> 01:38:14,159
so by like okay how do you create

2696
01:38:14,159 --> 01:38:17,839
a job for scheduled tasks

2697
01:38:19,520 --> 01:38:21,199
um well there's

2698
01:38:21,199 --> 01:38:23,119
um

2699
01:38:23,119 --> 01:38:24,880
different ways um we have to do i don't

2700
01:38:24,880 --> 01:38:26,080
want to go into we don't have time we

2701
01:38:26,080 --> 01:38:27,679
only have nine minutes to go into

2702
01:38:27,679 --> 01:38:29,360
nitty-gritty details

2703
01:38:29,360 --> 01:38:31,920
but on windows what happens is

2704
01:38:31,920 --> 01:38:34,400
you'll create a job file so then also

2705
01:38:34,400 --> 01:38:37,679
create a registry key associated with it

2706
01:38:37,679 --> 01:38:40,400
and then you can windows also has

2707
01:38:40,400 --> 01:38:42,400
an event code you can configure to

2708
01:38:42,400 --> 01:38:45,360
generate data for that so as a you might

2709
01:38:45,360 --> 01:38:47,040
say okay if i want to look for scheduled

2710
01:38:47,040 --> 01:38:48,400
tasks

2711
01:38:48,400 --> 01:38:50,320
i need to look for

2712
01:38:50,320 --> 01:38:52,719
this uh i need to configure my

2713
01:38:52,719 --> 01:38:53,920
environment

2714
01:38:53,920 --> 01:38:56,000
uh so this will be going to the sort of

2715
01:38:56,000 --> 01:38:57,600
engineering

2716
01:38:57,600 --> 01:38:59,360
team and say okay i need you guys to

2717
01:38:59,360 --> 01:39:00,400
collect

2718
01:39:00,400 --> 01:39:03,199
this specific event code

2719
01:39:03,199 --> 01:39:06,320
uh which is three six nine eight if i'm

2720
01:39:06,320 --> 01:39:08,320
not mistaken or four six nine eight how

2721
01:39:08,320 --> 01:39:10,159
to double check

2722
01:39:10,159 --> 01:39:12,719
four six nine eight here it is

2723
01:39:12,719 --> 01:39:14,400
um four six nine eight events from

2724
01:39:14,400 --> 01:39:17,600
windows uh so push out that group policy

2725
01:39:17,600 --> 01:39:19,440
okay once that's pushed out

2726
01:39:19,440 --> 01:39:22,320
um now go to the stock analyst and say

2727
01:39:22,320 --> 01:39:23,280
okay

2728
01:39:23,280 --> 01:39:25,600
uh are we collecting that data yes is it

2729
01:39:25,600 --> 01:39:27,840
getting to the sock or seam or whatever

2730
01:39:27,840 --> 01:39:30,239
data analysis platform we're using

2731
01:39:30,239 --> 01:39:32,719
uh yeah if yes then we can write an

2732
01:39:32,719 --> 01:39:34,400
analytic for that

2733
01:39:34,400 --> 01:39:36,400
then we can write an analytic

2734
01:39:36,400 --> 01:39:38,400
uh that covers it

2735
01:39:38,400 --> 01:39:40,080
so that could be looking at that split

2736
01:39:40,080 --> 01:39:42,000
event code it could be

2737
01:39:42,000 --> 01:39:43,679
uh taking something else from this

2738
01:39:43,679 --> 01:39:45,840
information like

2739
01:39:45,840 --> 01:39:48,639
uh using this specific field or

2740
01:39:48,639 --> 01:39:51,119
different arguments

2741
01:39:51,119 --> 01:39:53,760
um it kind of depends on going a level

2742
01:39:53,760 --> 01:39:56,800
deeper level detail deeper onto which

2743
01:39:56,800 --> 01:39:58,560
specific execution method you're looking

2744
01:39:58,560 --> 01:39:59,600
for

2745
01:39:59,600 --> 01:40:01,440
then once that's built

2746
01:40:01,440 --> 01:40:03,600
you would then go to your threat

2747
01:40:03,600 --> 01:40:05,199
emulation team

2748
01:40:05,199 --> 01:40:06,880
and say okay i need you

2749
01:40:06,880 --> 01:40:08,960
to do run schedule tasks

2750
01:40:08,960 --> 01:40:11,280
as

2751
01:40:11,360 --> 01:40:15,040
in the same method as say loki bot

2752
01:40:15,040 --> 01:40:16,080
and then

2753
01:40:16,080 --> 01:40:18,320
make sure that works for

2754
01:40:18,320 --> 01:40:21,280
our specific detection

2755
01:40:21,280 --> 01:40:22,880
and then you do a gap analysis of

2756
01:40:22,880 --> 01:40:24,960
whether or not that worked

2757
01:40:24,960 --> 01:40:27,600
and then you can go to attack

2758
01:40:27,600 --> 01:40:29,600
to do

2759
01:40:29,600 --> 01:40:30,719
they create a new empty one for

2760
01:40:30,719 --> 01:40:35,159
enterprise or the navigator i mean

2761
01:40:36,239 --> 01:40:39,199
and says okay for scheduled tasks where

2762
01:40:39,199 --> 01:40:42,719
is scheduled tasks

2763
01:40:45,760 --> 01:40:48,960
for scheduled tasks i can

2764
01:40:48,960 --> 01:40:51,280
detect it let's say

2765
01:40:51,280 --> 01:40:53,199
um

2766
01:40:53,199 --> 01:40:55,199
100 let's call it green because it's

2767
01:40:55,199 --> 01:40:56,880
easy

2768
01:40:56,880 --> 01:40:59,520
may not be true but um let's just start

2769
01:40:59,520 --> 01:41:00,719
with that

2770
01:41:00,719 --> 01:41:02,080
and then you might go through several

2771
01:41:02,080 --> 01:41:04,639
iterations of that

2772
01:41:04,639 --> 01:41:07,520
and then eventually what you might

2773
01:41:07,520 --> 01:41:09,119
do is you might have several dose let's

2774
01:41:09,119 --> 01:41:11,199
grab the group tool

2775
01:41:11,199 --> 01:41:13,119
and quickly try to do the layer

2776
01:41:13,119 --> 01:41:16,920
composite example

2777
01:41:21,840 --> 01:41:25,040
let us select everything for

2778
01:41:25,040 --> 01:41:28,719
let's see let's grab 28

2779
01:41:29,360 --> 01:41:31,040
uh so these are all the techniques so

2780
01:41:31,040 --> 01:41:33,119
the ht28 so we've grabbed all of them

2781
01:41:33,119 --> 01:41:34,080
already

2782
01:41:34,080 --> 01:41:37,360
and then i want to score them

2783
01:41:37,360 --> 01:41:38,080
as

2784
01:41:38,080 --> 01:41:40,400
one

2785
01:41:40,880 --> 01:41:44,639
and then i will call this

2786
01:41:45,119 --> 01:41:47,040
layer

2787
01:41:47,040 --> 01:41:50,560
uh it's called hd2988

2788
01:41:52,480 --> 01:41:54,400
i think that's an h my screen is not big

2789
01:41:54,400 --> 01:41:55,520
enough to support that size

2790
01:41:55,520 --> 01:41:57,360
unfortunately

2791
01:41:57,360 --> 01:42:01,360
uh now we'll create another layer

2792
01:42:01,360 --> 01:42:04,320
and then for enterprise as well

2793
01:42:04,320 --> 01:42:05,600
and we'll call

2794
01:42:05,600 --> 01:42:07,119
grab

2795
01:42:07,119 --> 01:42:12,119
let's call it apt3 this time

2796
01:42:17,600 --> 01:42:21,199
and score those as 2

2797
01:42:22,800 --> 01:42:23,920
and call

2798
01:42:23,920 --> 01:42:24,800
this

2799
01:42:24,800 --> 01:42:26,320
layer

2800
01:42:26,320 --> 01:42:29,719
something else

2801
01:42:32,400 --> 01:42:35,400
apt3

2802
01:42:36,159 --> 01:42:38,800
and then finally create

2803
01:42:38,800 --> 01:42:40,719
a

2804
01:42:40,719 --> 01:42:43,679
a layer from other layers

2805
01:42:43,679 --> 01:42:46,159
uh so here's a little more complicated

2806
01:42:46,159 --> 01:42:48,159
uh so we're gonna do an enterprise one

2807
01:42:48,159 --> 01:42:50,000
uh and the expression

2808
01:42:50,000 --> 01:42:51,600
uh is going based yet to do a

2809
01:42:51,600 --> 01:42:53,920
mathematical expression based on

2810
01:42:53,920 --> 01:42:55,840
the content of layers so in this case

2811
01:42:55,840 --> 01:42:58,719
it's up here it's been labeled a and b

2812
01:42:58,719 --> 01:43:01,199
and so we can do stuff like a

2813
01:43:01,199 --> 01:43:03,280
plus b

2814
01:43:03,280 --> 01:43:05,520
and so now when we bring up the new map

2815
01:43:05,520 --> 01:43:08,080
uh what we'll see is

2816
01:43:08,080 --> 01:43:11,440
a composite score across both of those

2817
01:43:11,440 --> 01:43:14,159
and so now we have a heat map

2818
01:43:14,159 --> 01:43:15,679
which shows us

2819
01:43:15,679 --> 01:43:18,159
uh what's red you can configure this

2820
01:43:18,159 --> 01:43:21,679
color scale um but what's red is one so

2821
01:43:21,679 --> 01:43:24,000
that is unique to apt-28

2822
01:43:24,000 --> 01:43:25,119
um

2823
01:43:25,119 --> 01:43:28,159
what is labeled two or is yellow is

2824
01:43:28,159 --> 01:43:30,000
unique to apt3

2825
01:43:30,000 --> 01:43:31,520
and what's green is what's common to

2826
01:43:31,520 --> 01:43:32,719
both

2827
01:43:32,719 --> 01:43:34,239
and so now if we're talking about sort

2828
01:43:34,239 --> 01:43:36,560
of prioritizing which techniques you

2829
01:43:36,560 --> 01:43:37,840
want to start addressing this is a

2830
01:43:37,840 --> 01:43:39,840
method we could use we say okay

2831
01:43:39,840 --> 01:43:41,360
these are the two adversaries i care

2832
01:43:41,360 --> 01:43:42,320
about

2833
01:43:42,320 --> 01:43:43,760
what let's start with the techniques

2834
01:43:43,760 --> 01:43:45,360
that are common to both

2835
01:43:45,360 --> 01:43:49,199
okay it's one two three four five six

2836
01:43:49,199 --> 01:43:51,440
so we'll start i'll focus our efforts on

2837
01:43:51,440 --> 01:43:53,840
understanding and creating defenses for

2838
01:43:53,840 --> 01:43:55,440
these six

2839
01:43:55,440 --> 01:43:57,440
and then maybe we'll move to ones that

2840
01:43:57,440 --> 01:43:59,679
are unique to one or the other or we'll

2841
01:43:59,679 --> 01:44:03,119
use another prioritization scheme

2842
01:44:03,119 --> 01:44:05,679
that's the idea and you can do this with

2843
01:44:05,679 --> 01:44:07,840
you could create another layer which is

2844
01:44:07,840 --> 01:44:09,920
your detection so you might create a

2845
01:44:09,920 --> 01:44:11,840
another layer or a scale of tasks

2846
01:44:11,840 --> 01:44:13,280
example which is

2847
01:44:13,280 --> 01:44:15,119
well we detect this one

2848
01:44:15,119 --> 01:44:17,520
and so maybe we'll

2849
01:44:17,520 --> 01:44:21,280
reset the value to zero if uh they have

2850
01:44:21,280 --> 01:44:23,840
a common one so now or we'll set it to

2851
01:44:23,840 --> 01:44:25,600
some really high number

2852
01:44:25,600 --> 01:44:28,159
and so well if it's

2853
01:44:28,159 --> 01:44:29,920
we have it covered

2854
01:44:29,920 --> 01:44:32,320
it'll be you know 100 plus and so we

2855
01:44:32,320 --> 01:44:33,760
know which ones of these techniques we

2856
01:44:33,760 --> 01:44:36,000
have covered versus which adversaries we

2857
01:44:36,000 --> 01:44:37,280
care about

2858
01:44:37,280 --> 01:44:39,760
so that's some of the ways we can use

2859
01:44:39,760 --> 01:44:42,000
this

2860
01:44:43,280 --> 01:44:46,400
um any other questions or that

2861
01:44:46,400 --> 01:44:49,280
help answer your question i'm sorry

2862
01:44:49,280 --> 01:44:50,639
uh if you really want to get into

2863
01:44:50,639 --> 01:44:53,280
nitty-gritty details of converting cyber

2864
01:44:53,280 --> 01:44:54,960
threat intelligence into useful

2865
01:44:54,960 --> 01:44:56,639
information for defenders

2866
01:44:56,639 --> 01:44:59,520
you're you have to go to the

2867
01:44:59,520 --> 01:45:01,280
mad training

2868
01:45:01,280 --> 01:45:02,560
for the cyber threat intelligence

2869
01:45:02,560 --> 01:45:03,920
specifically because that's a separate

2870
01:45:03,920 --> 01:45:06,920
course

2871
01:45:18,080 --> 01:45:22,239
three minutes to ask any other questions

2872
01:45:22,239 --> 01:45:25,040
hopefully related to this topic

2873
01:45:25,040 --> 01:45:27,040
now i can go back clarify something if

2874
01:45:27,040 --> 01:45:29,920
you didn't get it the first time

2875
01:45:29,920 --> 01:45:31,520
or anything like that but the size like

2876
01:45:31,520 --> 01:45:33,119
you mentioned will be released as will

2877
01:45:33,119 --> 01:45:34,320
the video

2878
01:45:34,320 --> 01:45:36,400
and if you want to

2879
01:45:36,400 --> 01:45:38,239
take the slower paced

2880
01:45:38,239 --> 01:45:40,480
uh more piecemeal training

2881
01:45:40,480 --> 01:45:44,719
then um that is also on the attack mad

2882
01:45:44,719 --> 01:45:46,239
site

2883
01:45:46,239 --> 01:45:50,839
so let me go there real quick

2884
01:46:04,880 --> 01:46:07,440
so we are publicly releasing

2885
01:46:07,440 --> 01:46:08,560
um

2886
01:46:08,560 --> 01:46:11,360
these different modules

2887
01:46:11,360 --> 01:46:13,280
and so you just went through the

2888
01:46:13,280 --> 01:46:14,719
fundamentals

2889
01:46:14,719 --> 01:46:17,440
which was this first

2890
01:46:17,440 --> 01:46:19,199
section

2891
01:46:19,199 --> 01:46:20,639
um

2892
01:46:20,639 --> 01:46:23,199
but there are other additional modules

2893
01:46:23,199 --> 01:46:24,800
like the cyber threat intelligence and

2894
01:46:24,800 --> 01:46:27,280
forum assessments

2895
01:46:27,280 --> 01:46:28,800
we are

2896
01:46:28,800 --> 01:46:31,520
uh where's

2897
01:46:31,520 --> 01:46:34,159
two a layer too deep

2898
01:46:34,159 --> 01:46:37,040
uh but there's also a course for

2899
01:46:37,040 --> 01:46:39,040
or we're working on the one for hunting

2900
01:46:39,040 --> 01:46:40,960
right now which will be released

2901
01:46:40,960 --> 01:46:42,800
hopefully soon

2902
01:46:42,800 --> 01:46:45,679
uh and the courses are free

2903
01:46:45,679 --> 01:46:46,960
uh to

2904
01:46:46,960 --> 01:46:49,679
uh take but the certification costs

2905
01:46:49,679 --> 01:46:51,199
money

2906
01:46:51,199 --> 01:46:53,520
so you are free to watch the courses as

2907
01:46:53,520 --> 01:46:55,840
you wish

2908
01:46:56,880 --> 01:46:59,920
uh with that uh we are out of time so

2909
01:46:59,920 --> 01:47:01,360
thank you very much for your time and

2910
01:47:01,360 --> 01:47:02,639
hopefully

2911
01:47:02,639 --> 01:47:05,600
it was insightful and feel free to

2912
01:47:05,600 --> 01:47:07,360
email the attack team if you have any

2913
01:47:07,360 --> 01:47:09,839
other questions

