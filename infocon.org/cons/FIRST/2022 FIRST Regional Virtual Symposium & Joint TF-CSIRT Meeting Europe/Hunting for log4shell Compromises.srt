1
00:00:00,350 --> 00:00:05,359
[Music]

2
00:00:05,359 --> 00:00:07,839
uh hell thank you for

3
00:00:07,839 --> 00:00:10,960
take your time to uh listen to me to my

4
00:00:10,960 --> 00:00:14,639
ramblings uh this is a talk as uh chris

5
00:00:14,639 --> 00:00:16,560
has said of about hunting for block for

6
00:00:16,560 --> 00:00:18,080
cell compromises

7
00:00:18,080 --> 00:00:21,119
okay this is based on experience that uh

8
00:00:21,119 --> 00:00:23,439
me and other members of my team we had

9
00:00:23,439 --> 00:00:26,880
during december 2021 just after lot for

10
00:00:26,880 --> 00:00:28,960
sale was revealed

11
00:00:28,960 --> 00:00:30,880
uh we did this in two different

12
00:00:30,880 --> 00:00:32,960
companies uh because they needed to know

13
00:00:32,960 --> 00:00:34,800
if they have been compromised prior to

14
00:00:34,800 --> 00:00:36,960
the to the disclosure of the of the

15
00:00:36,960 --> 00:00:38,559
vulnerability okay

16
00:00:38,559 --> 00:00:41,680
so let's go into let's go into start

17
00:00:41,680 --> 00:00:43,120
okay it's a very christmas theme

18
00:00:43,120 --> 00:00:45,840
presentation by the way it says

19
00:00:45,840 --> 00:00:47,600
for me it's very difficult to separate

20
00:00:47,600 --> 00:00:49,680
that time of the this that time of the

21
00:00:49,680 --> 00:00:52,559
year from this thing that we don't bring

22
00:00:52,559 --> 00:00:54,719
to christmas so some introductions of

23
00:00:54,719 --> 00:00:55,600
course

24
00:00:55,600 --> 00:00:58,480
so i'm jose andrea i'm senior incident

25
00:00:58,480 --> 00:01:00,239
handler in seattle

26
00:01:00,239 --> 00:01:01,920
and i have been involved in cyber

27
00:01:01,920 --> 00:01:04,720
security since 2013.

28
00:01:04,720 --> 00:01:07,520
prior to being in sia just in nazok

29
00:01:07,520 --> 00:01:11,680
and since 2018 i have been in a facility

30
00:01:11,680 --> 00:01:13,200
in seattle

31
00:01:13,200 --> 00:01:14,960
and we have we done a little bit of

32
00:01:14,960 --> 00:01:17,280
everything we do from tabletop exercise

33
00:01:17,280 --> 00:01:19,439
to training simulations to post

34
00:01:19,439 --> 00:01:22,240
incidents post incident assessments and

35
00:01:22,240 --> 00:01:24,159
everything in between

36
00:01:24,159 --> 00:01:26,159
and in this case we did a compromise

37
00:01:26,159 --> 00:01:28,400
assessment and i will explain what is uh

38
00:01:28,400 --> 00:01:30,400
that for you because i i don't think

39
00:01:30,400 --> 00:01:33,119
that is normal uh terminology

40
00:01:33,119 --> 00:01:35,119
so a christmas tale

41
00:01:35,119 --> 00:01:37,280
okay it's going to

42
00:01:37,280 --> 00:01:39,600
set up the mood

43
00:01:39,600 --> 00:01:41,520
look for cell is the greens because it

44
00:01:41,520 --> 00:01:43,759
can ruin your christmas it almost did it

45
00:01:43,759 --> 00:01:44,880
with mine

46
00:01:44,880 --> 00:01:47,360
and lot for sale was revealed on

47
00:01:47,360 --> 00:01:50,079
december 10 as i think has already

48
00:01:50,079 --> 00:01:53,200
discussed here today

49
00:01:53,200 --> 00:01:55,520
in allow an unskilled attacker to

50
00:01:55,520 --> 00:01:58,560
basically embed arbitrary code in the

51
00:01:58,560 --> 00:02:02,960
user agent uh part of uh http request

52
00:02:02,960 --> 00:02:04,560
and basically

53
00:02:04,560 --> 00:02:07,200
arbitrarily execute code in

54
00:02:07,200 --> 00:02:09,598
a target system okay

55
00:02:09,598 --> 00:02:11,440
it had a

56
00:02:11,440 --> 00:02:14,480
score of 10.0 it has been done so it was

57
00:02:14,480 --> 00:02:17,040
really really serious but another things

58
00:02:17,040 --> 00:02:20,319
made it even worse uh three things okay

59
00:02:20,319 --> 00:02:22,560
it was revealed on a thursday and it's

60
00:02:22,560 --> 00:02:24,959
not trivial to parts for the for

61
00:02:24,959 --> 00:02:26,640
development teams

62
00:02:26,640 --> 00:02:29,360
uh also these teams were already under

63
00:02:29,360 --> 00:02:31,360
staff uh it was prayer prior to

64
00:02:31,360 --> 00:02:33,760
christmas just one week before everybody

65
00:02:33,760 --> 00:02:36,800
was going holidays and stuff and also it

66
00:02:36,800 --> 00:02:39,840
was in the midst of omicron so

67
00:02:39,840 --> 00:02:40,959
a lot of

68
00:02:40,959 --> 00:02:43,040
key people were was on

69
00:02:43,040 --> 00:02:45,280
on sick leave so that really hampered

70
00:02:45,280 --> 00:02:48,160
their their response

71
00:02:48,160 --> 00:02:51,920
so um apart from that uh

72
00:02:51,920 --> 00:02:55,200
the first update uh the first patch was

73
00:02:55,200 --> 00:02:56,640
wasn't enough to address the

74
00:02:56,640 --> 00:02:57,840
vulnerability

75
00:02:57,840 --> 00:02:58,879
uh

76
00:02:58,879 --> 00:03:01,200
by the end of the of this whole saga

77
00:03:01,200 --> 00:03:03,440
three three patches have been released

78
00:03:03,440 --> 00:03:06,239
in less than just two weeks that's that

79
00:03:06,239 --> 00:03:08,319
really really messed with the with the

80
00:03:08,319 --> 00:03:10,000
people trying to patch all the servers

81
00:03:10,000 --> 00:03:12,239
how the critical infrastructure

82
00:03:12,239 --> 00:03:15,040
uh so real mitigation efforts uh

83
00:03:15,040 --> 00:03:16,640
couldn't be taken until monday

84
00:03:16,640 --> 00:03:18,800
thirteenth with effective mitigation

85
00:03:18,800 --> 00:03:21,440
efforts so this make a lot of people

86
00:03:21,440 --> 00:03:23,280
very very nervous

87
00:03:23,280 --> 00:03:24,319
uh

88
00:03:24,319 --> 00:03:26,959
and it's a really serious relativity

89
00:03:26,959 --> 00:03:29,120
left alone not alone but

90
00:03:29,120 --> 00:03:31,760
kind of during a

91
00:03:31,760 --> 00:03:34,319
what can go wrong in this so

92
00:03:34,319 --> 00:03:35,280
that's

93
00:03:35,280 --> 00:03:38,560
uh so i'm an incident hunger why i have

94
00:03:38,560 --> 00:03:40,720
been involved with this okay

95
00:03:40,720 --> 00:03:44,480
uh well a public exploit was a bible uh

96
00:03:44,480 --> 00:03:46,640
rumors of our love for serving use a

97
00:03:46,640 --> 00:03:49,920
zero day uh way around okay

98
00:03:49,920 --> 00:03:52,400
uh sustained rumors but

99
00:03:52,400 --> 00:03:53,680
not uh

100
00:03:53,680 --> 00:03:56,959
not all that it could have been uh

101
00:03:56,959 --> 00:03:59,439
straight detection teams uh they have

102
00:03:59,439 --> 00:04:00,560
have

103
00:04:00,560 --> 00:04:03,519
enough on their plate already and this

104
00:04:03,519 --> 00:04:05,200
uh this was an overhead that they

105
00:04:05,200 --> 00:04:07,120
couldn't assume

106
00:04:07,120 --> 00:04:09,120
so the incident response team was

107
00:04:09,120 --> 00:04:12,319
activated as to provide muscle to the

108
00:04:12,319 --> 00:04:16,000
local teams uh and this is the story on

109
00:04:16,000 --> 00:04:18,798
how our team uh

110
00:04:18,798 --> 00:04:21,120
take take on this it's not that the only

111
00:04:21,120 --> 00:04:25,280
way uh is i for sure is not the best way

112
00:04:25,280 --> 00:04:26,080
but

113
00:04:26,080 --> 00:04:29,680
we are here to share and also to learn

114
00:04:29,680 --> 00:04:31,440
okay so some background on the

115
00:04:31,440 --> 00:04:33,919
probability for sure you are very

116
00:04:33,919 --> 00:04:35,680
familiar with it but

117
00:04:35,680 --> 00:04:38,000
i feel that we need to cover

118
00:04:38,000 --> 00:04:38,960
so

119
00:04:38,960 --> 00:04:41,280
little 4g is everywhere

120
00:04:41,280 --> 00:04:42,639
it's everywhere

121
00:04:42,639 --> 00:04:45,120
and it's not only in web servers on web

122
00:04:45,120 --> 00:04:47,680
applications it's in things that

123
00:04:47,680 --> 00:04:50,320
that in enterprise environments are are

124
00:04:50,320 --> 00:04:52,960
quite prevalent and quite important

125
00:04:52,960 --> 00:04:54,880
and cisco products

126
00:04:54,880 --> 00:04:57,360
here you have examples uh amazon what

127
00:04:57,360 --> 00:04:58,479
services

128
00:04:58,479 --> 00:05:01,680
ibm uh qradar module of key rather was

129
00:05:01,680 --> 00:05:03,280
affected by this so do you really want

130
00:05:03,280 --> 00:05:06,720
an rc vulnerability on your cm yeah

131
00:05:06,720 --> 00:05:08,000
fortinet

132
00:05:08,000 --> 00:05:10,800
was also affected and over 40 products

133
00:05:10,800 --> 00:05:13,199
of vmware so

134
00:05:13,199 --> 00:05:14,160
uh

135
00:05:14,160 --> 00:05:16,479
that makes this compound the the

136
00:05:16,479 --> 00:05:18,560
vulnerability

137
00:05:18,560 --> 00:05:20,240
so a little bit of a timeline this

138
00:05:20,240 --> 00:05:24,080
variety was introduced in 2013 when the

139
00:05:24,080 --> 00:05:25,120
lookup

140
00:05:25,120 --> 00:05:26,960
feature was introduced this is a quite

141
00:05:26,960 --> 00:05:28,160
useful

142
00:05:28,160 --> 00:05:29,199
feature

143
00:05:29,199 --> 00:05:31,600
of online enterprise environments but

144
00:05:31,600 --> 00:05:35,520
it introduced uh some some dangers

145
00:05:35,520 --> 00:05:37,600
already in 2014

146
00:05:37,600 --> 00:05:39,360
applications were crafted due to

147
00:05:39,360 --> 00:05:41,520
unhandled exceptions so

148
00:05:41,520 --> 00:05:43,600
that's not something that you want in a

149
00:05:43,600 --> 00:05:45,919
public phase application

150
00:05:45,919 --> 00:05:46,800
and

151
00:05:46,800 --> 00:05:49,440
some mitigations were introduced like no

152
00:05:49,440 --> 00:05:52,080
lookups or for local configuration and

153
00:05:52,080 --> 00:05:54,479
another one for globally let's disable

154
00:05:54,479 --> 00:05:55,759
this feature

155
00:05:55,759 --> 00:05:58,479
for all the your whole

156
00:05:58,479 --> 00:05:59,680
system okay

157
00:05:59,680 --> 00:06:04,800
and in 2016 uh black hole black hat talk

158
00:06:04,800 --> 00:06:06,400
was uh

159
00:06:06,400 --> 00:06:09,039
uh investigated about how gndi lookups

160
00:06:09,039 --> 00:06:12,080
on untrusted resources could lead to one

161
00:06:12,080 --> 00:06:14,639
remote code execution okay i wanted to

162
00:06:14,639 --> 00:06:18,039
divide three main vectors ldap

163
00:06:18,039 --> 00:06:19,680
umi

164
00:06:19,680 --> 00:06:22,080
globa and here you have the link they

165
00:06:22,080 --> 00:06:24,240
did much better much better work that i

166
00:06:24,240 --> 00:06:26,720
can do explaining this they also have a

167
00:06:26,720 --> 00:06:29,199
white paper on this and i think the the

168
00:06:29,199 --> 00:06:31,520
talk is on youtube so check it out

169
00:06:31,520 --> 00:06:32,800
because

170
00:06:32,800 --> 00:06:35,759
it can uh it really is really a good

171
00:06:35,759 --> 00:06:36,560
talk

172
00:06:36,560 --> 00:06:39,120
uh well let's go to jump the the next

173
00:06:39,120 --> 00:06:41,440
one uh that's december 10th that is when

174
00:06:41,440 --> 00:06:43,759
the polarities is closed but according

175
00:06:43,759 --> 00:06:46,160
to cloudflare the vulnerability had been

176
00:06:46,160 --> 00:06:48,000
there were attempts of exploitation

177
00:06:48,000 --> 00:06:49,759
since december 1st

178
00:06:49,759 --> 00:06:50,880
uh

179
00:06:50,880 --> 00:06:53,520
that makes a lot of people really really

180
00:06:53,520 --> 00:06:56,080
nervous right now that's why the ceo

181
00:06:56,080 --> 00:06:59,680
they exploit uh rumors were around

182
00:06:59,680 --> 00:07:00,479
okay

183
00:07:00,479 --> 00:07:03,199
how it works well we have a

184
00:07:03,199 --> 00:07:05,280
phase one the request the malicious

185
00:07:05,280 --> 00:07:07,360
request to the vulnerable job

186
00:07:07,360 --> 00:07:10,720
application then a second phase when

187
00:07:10,720 --> 00:07:12,960
that application performs an ldap

188
00:07:12,960 --> 00:07:14,319
resolution

189
00:07:14,319 --> 00:07:17,440
gets an answer and goes for the

190
00:07:17,440 --> 00:07:19,520
malicious resource okay to the payload

191
00:07:19,520 --> 00:07:22,080
to the final payload it can be as uh

192
00:07:22,080 --> 00:07:26,319
already done as a cover uh just normal

193
00:07:26,319 --> 00:07:28,160
base64

194
00:07:28,160 --> 00:07:30,400
encode commands or it can be a

195
00:07:30,400 --> 00:07:32,639
class resource with a custom class

196
00:07:32,639 --> 00:07:36,000
loader and everything in between okay

197
00:07:36,000 --> 00:07:37,280
uh

198
00:07:37,280 --> 00:07:40,400
um once this is done okay you have they

199
00:07:40,400 --> 00:07:42,160
have to come back to the attacker

200
00:07:42,160 --> 00:07:42,960
because

201
00:07:42,960 --> 00:07:44,319
what they're good is to exploit an

202
00:07:44,319 --> 00:07:45,440
application if you don't know if you

203
00:07:45,440 --> 00:07:47,120
have been successful okay that's the

204
00:07:47,120 --> 00:07:48,639
third stage

205
00:07:48,639 --> 00:07:49,440
so

206
00:07:49,440 --> 00:07:51,759
uh the second stage is important for us

207
00:07:51,759 --> 00:07:54,560
right now in in this work because it's

208
00:07:54,560 --> 00:07:55,759
going to

209
00:07:55,759 --> 00:07:59,199
will allow us to filter which resources

210
00:07:59,199 --> 00:08:00,639
we have to

211
00:08:00,639 --> 00:08:03,599
put into doing digital foreign response

212
00:08:03,599 --> 00:08:04,240
on

213
00:08:04,240 --> 00:08:06,160
on compromise assets

214
00:08:06,160 --> 00:08:07,520
okay

215
00:08:07,520 --> 00:08:09,280
well

216
00:08:09,280 --> 00:08:10,639
we have to do this in an entire

217
00:08:10,639 --> 00:08:13,520
organization so it's a sea and we only

218
00:08:13,520 --> 00:08:16,319
have a bucket so how are we going to

219
00:08:16,319 --> 00:08:18,479
to approach this okay

220
00:08:18,479 --> 00:08:20,800
first why we speak of compromise

221
00:08:20,800 --> 00:08:23,440
assessment well i'm not family because

222
00:08:23,440 --> 00:08:26,000
it could be very similar for some people

223
00:08:26,000 --> 00:08:28,720
uh firsthand is plan

224
00:08:28,720 --> 00:08:31,520
you you go there to go for after ttp and

225
00:08:31,520 --> 00:08:33,519
then you investigate that you use

226
00:08:33,519 --> 00:08:35,200
methods that are already available in

227
00:08:35,200 --> 00:08:37,200
the organization okay

228
00:08:37,200 --> 00:08:38,799
and you report at the end of the

229
00:08:38,799 --> 00:08:40,719
activity and what malicious activities

230
00:08:40,719 --> 00:08:41,679
from

231
00:08:41,679 --> 00:08:43,839
okay compromise assessment is more

232
00:08:43,839 --> 00:08:46,160
similar to an incident response where

233
00:08:46,160 --> 00:08:48,720
you don't know if something has been

234
00:08:48,720 --> 00:08:50,880
if there is an incident actually so it's

235
00:08:50,880 --> 00:08:52,160
not planned

236
00:08:52,160 --> 00:08:53,920
you use supplementary methods if you

237
00:08:53,920 --> 00:08:55,839
have to deploy ideas with deployment drc

238
00:08:55,839 --> 00:08:58,080
you need to provision a server or

239
00:08:58,080 --> 00:09:01,040
workstation to analyze logs

240
00:09:01,040 --> 00:09:03,200
you do that okay within the

241
00:09:03,200 --> 00:09:04,720
infrastructure of the affected

242
00:09:04,720 --> 00:09:07,360
overcoming organization okay

243
00:09:07,360 --> 00:09:10,320
and the reports are daily in our case uh

244
00:09:10,320 --> 00:09:12,959
even twice uh twice a day uh do you

245
00:09:12,959 --> 00:09:14,800
notify as soon as you find malicious

246
00:09:14,800 --> 00:09:16,720
activity even if it's not a successful

247
00:09:16,720 --> 00:09:18,320
master's activity you need to notify the

248
00:09:18,320 --> 00:09:20,640
detection teams so to see if they are

249
00:09:20,640 --> 00:09:23,360
taking that already so

250
00:09:23,360 --> 00:09:26,720
you try to close the gap in detection

251
00:09:26,720 --> 00:09:27,680
okay

252
00:09:27,680 --> 00:09:28,560
and

253
00:09:28,560 --> 00:09:31,279
that's the that's the approach so how we

254
00:09:31,279 --> 00:09:33,279
try to how to start uh you have to

255
00:09:33,279 --> 00:09:34,880
involve the local team

256
00:09:34,880 --> 00:09:36,640
uh they are the ones who know the

257
00:09:36,640 --> 00:09:38,399
infrastructure they know they are the

258
00:09:38,399 --> 00:09:40,080
ones who know which doors they have to

259
00:09:40,080 --> 00:09:42,160
knock and which levels they have to pull

260
00:09:42,160 --> 00:09:44,240
for you to do the job job

261
00:09:44,240 --> 00:09:45,839
uh i don't think you have a chance

262
00:09:45,839 --> 00:09:47,040
inside

263
00:09:47,040 --> 00:09:49,200
of success without involving them and

264
00:09:49,200 --> 00:09:52,160
really try to be close with them um

265
00:09:52,160 --> 00:09:54,560
thanks to those guys uh second entire

266
00:09:54,560 --> 00:09:56,640
organization is very different than a

267
00:09:56,640 --> 00:09:59,279
couple of dozen of systems it's

268
00:09:59,279 --> 00:10:01,200
there's a time limit actually so they

269
00:10:01,200 --> 00:10:02,160
want to know if they have been

270
00:10:02,160 --> 00:10:04,800
compromised yesterday you don't want for

271
00:10:04,800 --> 00:10:06,720
tomorrow they won't forget yesterday

272
00:10:06,720 --> 00:10:09,120
uh and you need a plan you need a

273
00:10:09,120 --> 00:10:10,800
plan that you need to know what you are

274
00:10:10,800 --> 00:10:12,959
going to start with systems that are

275
00:10:12,959 --> 00:10:14,640
going to be the first to say which

276
00:10:14,640 --> 00:10:16,720
systems have been affected how to check

277
00:10:16,720 --> 00:10:18,000
if a system is affected by the

278
00:10:18,000 --> 00:10:19,279
vulnerability

279
00:10:19,279 --> 00:10:21,680
uh on in which order you are going to do

280
00:10:21,680 --> 00:10:24,480
that okay uh in this case several issues

281
00:10:24,480 --> 00:10:27,279
arise because uh for example the best

282
00:10:27,279 --> 00:10:29,600
chance that to detect this is web server

283
00:10:29,600 --> 00:10:32,560
logs and application logs but those are

284
00:10:32,560 --> 00:10:34,720
not indexed and not centralized you have

285
00:10:34,720 --> 00:10:36,480
to go to the

286
00:10:36,480 --> 00:10:38,640
to the source to the to the proper

287
00:10:38,640 --> 00:10:41,360
applications and also several appliances

288
00:10:41,360 --> 00:10:43,360
are affected by this vulnerability

289
00:10:43,360 --> 00:10:45,920
uh you need people with knowledge and

290
00:10:45,920 --> 00:10:49,120
access to extract those uh back-end logs

291
00:10:49,120 --> 00:10:51,279
for you so you can run your legs your

292
00:10:51,279 --> 00:10:54,480
jared rules your detection rules on them

293
00:10:54,480 --> 00:10:56,320
okay uh

294
00:10:56,320 --> 00:10:58,560
so again involve the local thing that's

295
00:10:58,560 --> 00:11:00,000
the first thing and the best thing you

296
00:11:00,000 --> 00:11:02,079
can do

297
00:11:02,079 --> 00:11:05,040
that's the strategic approach uh

298
00:11:05,040 --> 00:11:07,279
the operational approach for us was an

299
00:11:07,279 --> 00:11:09,279
iterative approach okay

300
00:11:09,279 --> 00:11:11,279
first we identified the log sources in

301
00:11:11,279 --> 00:11:13,680
every organization in both organizations

302
00:11:13,680 --> 00:11:15,600
that we can use for this

303
00:11:15,600 --> 00:11:17,920
and we started with a very basic set of

304
00:11:17,920 --> 00:11:21,040
detection rules just to detect the basic

305
00:11:21,040 --> 00:11:23,920
uh log for cell activity for example

306
00:11:23,920 --> 00:11:26,880
gndi hold up okay let's go without that

307
00:11:26,880 --> 00:11:30,160
string uh we identified the iocs that

308
00:11:30,160 --> 00:11:31,920
were trying to

309
00:11:31,920 --> 00:11:34,800
to exploit this vulnerability and then

310
00:11:34,800 --> 00:11:37,760
see if our rules cover all the activity

311
00:11:37,760 --> 00:11:40,399
then they don't cover all the activity

312
00:11:40,399 --> 00:11:43,600
improve the rule run the rule again okay

313
00:11:43,600 --> 00:11:45,920
you identify new ics okay

314
00:11:45,920 --> 00:11:48,800
do it again and you that and you repeat

315
00:11:48,800 --> 00:11:50,880
and repeat and repeat until you run out

316
00:11:50,880 --> 00:11:51,920
of time

317
00:11:51,920 --> 00:11:54,160
or you are fairly sure that you have

318
00:11:54,160 --> 00:11:57,040
covered all okay

319
00:11:57,040 --> 00:12:00,160
this is a regular expression that

320
00:12:00,160 --> 00:12:03,200
we ended with this this monstrosity here

321
00:12:03,200 --> 00:12:04,880
and

322
00:12:04,880 --> 00:12:07,279
you can follow this semapro approach for

323
00:12:07,279 --> 00:12:09,760
general rules cm queries splunk queries

324
00:12:09,760 --> 00:12:12,000
elastic such queries okay

325
00:12:12,000 --> 00:12:14,079
we follow this the same approach

326
00:12:14,079 --> 00:12:16,880
uh thanks to florian roth uh really uh

327
00:12:16,880 --> 00:12:19,040
because he provided us with the initial

328
00:12:19,040 --> 00:12:22,639
rule um via his repository his public

329
00:12:22,639 --> 00:12:25,120
repository and especially the script to

330
00:12:25,120 --> 00:12:27,600
compose this so we could just introduce

331
00:12:27,600 --> 00:12:30,320
new beats uh in the in the regex and

332
00:12:30,320 --> 00:12:32,720
then compose don't have to edit this

333
00:12:32,720 --> 00:12:35,680
monstrosity on the fly yes

334
00:12:35,680 --> 00:12:39,040
that will be really a pain so

335
00:12:39,040 --> 00:12:39,839
uh

336
00:12:39,839 --> 00:12:41,040
well

337
00:12:41,040 --> 00:12:42,800
after this you have your rules but you

338
00:12:42,800 --> 00:12:45,279
have lots and lots and lots of hits on

339
00:12:45,279 --> 00:12:47,120
those rules because everybody was trying

340
00:12:47,120 --> 00:12:49,360
to exploit this vulnerability during the

341
00:12:49,360 --> 00:12:51,600
period we are speaking about we did this

342
00:12:51,600 --> 00:12:54,320
for during december from we run on the

343
00:12:54,320 --> 00:12:58,079
logs from the december 1st to december

344
00:12:58,079 --> 00:13:01,920
december 31st yeah around that

345
00:13:01,920 --> 00:13:03,279
so

346
00:13:03,279 --> 00:13:06,639
it's not possible to do a full

347
00:13:06,639 --> 00:13:07,440
uh

348
00:13:07,440 --> 00:13:09,200
digital forensic procedure on every

349
00:13:09,200 --> 00:13:11,920
asset that is impacted so then

350
00:13:11,920 --> 00:13:13,920
i'm going to look for the secondary the

351
00:13:13,920 --> 00:13:16,480
second stage activity for outgoing

352
00:13:16,480 --> 00:13:18,720
connections okay

353
00:13:18,720 --> 00:13:21,200
for this you can use the cm you can use

354
00:13:21,200 --> 00:13:22,240
edr

355
00:13:22,240 --> 00:13:24,720
however i would recommend to go straight

356
00:13:24,720 --> 00:13:27,120
to the to the firewall because that

357
00:13:27,120 --> 00:13:29,519
there's a source of the data some cms uh

358
00:13:29,519 --> 00:13:31,120
some organizations don't index

359
00:13:31,120 --> 00:13:33,440
everything uh they got in the firewalls

360
00:13:33,440 --> 00:13:35,600
uh only for example the night requests

361
00:13:35,600 --> 00:13:38,320
or only uh admitted requests they don't

362
00:13:38,320 --> 00:13:39,600
index everything that you need

363
00:13:39,600 --> 00:13:41,120
everything to see

364
00:13:41,120 --> 00:13:43,839
okay and a dedicated wall station to do

365
00:13:43,839 --> 00:13:46,560
these sets these jar cells this regex is

366
00:13:46,560 --> 00:13:48,720
really advisable why because you don't

367
00:13:48,720 --> 00:13:50,880
want to go and execute

368
00:13:50,880 --> 00:13:53,120
a complex java on a mission critical

369
00:13:53,120 --> 00:13:55,120
server first you are not going to have

370
00:13:55,120 --> 00:13:57,920
the the java engine second if you have

371
00:13:57,920 --> 00:14:00,560
it maybe you will crash the server and

372
00:14:00,560 --> 00:14:02,160
you don't want that you don't want to be

373
00:14:02,160 --> 00:14:04,079
breaking things while you are trying to

374
00:14:04,079 --> 00:14:06,320
tell uh a customer

375
00:14:06,320 --> 00:14:08,320
if they have been compromising the in

376
00:14:08,320 --> 00:14:11,199
the first place okay

377
00:14:11,199 --> 00:14:14,560
well that's the theory

378
00:14:14,560 --> 00:14:16,480
so let's going to see how we apply this

379
00:14:16,480 --> 00:14:18,880
in two different organizations

380
00:14:18,880 --> 00:14:19,760
okay

381
00:14:19,760 --> 00:14:22,240
so mostly we were able to follow this

382
00:14:22,240 --> 00:14:24,240
the same approach but we had to

383
00:14:24,240 --> 00:14:25,760
accommodate for

384
00:14:25,760 --> 00:14:28,160
for some things okay uh

385
00:14:28,160 --> 00:14:30,079
both organizations had different level

386
00:14:30,079 --> 00:14:34,319
of maturity in the cyber security

387
00:14:34,720 --> 00:14:35,519
realm

388
00:14:35,519 --> 00:14:37,279
and they belong to different sectors

389
00:14:37,279 --> 00:14:39,279
okay so different regulatory frameworks

390
00:14:39,279 --> 00:14:41,600
a different kind of data on them

391
00:14:41,600 --> 00:14:44,079
uh one was in a single country just

392
00:14:44,079 --> 00:14:45,600
limited to spain the other one was a

393
00:14:45,600 --> 00:14:48,240
multinational so several countries

394
00:14:48,240 --> 00:14:49,199
uh

395
00:14:49,199 --> 00:14:51,279
that made the chain of communication

396
00:14:51,279 --> 00:14:52,800
more difficult the chain of command more

397
00:14:52,800 --> 00:14:53,839
complex

398
00:14:53,839 --> 00:14:56,079
and also the different regulatory

399
00:14:56,079 --> 00:14:58,160
frameworks were involved and you cannot

400
00:14:58,160 --> 00:15:00,079
take data from some countries to others

401
00:15:00,079 --> 00:15:01,920
so you have to provision additional

402
00:15:01,920 --> 00:15:03,199
resources more

403
00:15:03,199 --> 00:15:06,560
in every one of them okay

404
00:15:06,800 --> 00:15:08,720
well first organization really old

405
00:15:08,720 --> 00:15:11,120
school organization okay

406
00:15:11,120 --> 00:15:13,360
is from the healthcare sector a critical

407
00:15:13,360 --> 00:15:16,000
operator in the midst of a pandemic

408
00:15:16,000 --> 00:15:18,240
so they were nervous they were really

409
00:15:18,240 --> 00:15:20,480
very nervous and with reason

410
00:15:20,480 --> 00:15:22,959
okay they had a simple and welfare

411
00:15:22,959 --> 00:15:25,279
network architecture so they have very

412
00:15:25,279 --> 00:15:27,279
good visibility on what was going in and

413
00:15:27,279 --> 00:15:30,000
going out they weren't so mature in in

414
00:15:30,000 --> 00:15:32,000
terms of cyber security but

415
00:15:32,000 --> 00:15:34,160
the idea administrators have been doing

416
00:15:34,160 --> 00:15:36,160
that job for 20 years

417
00:15:36,160 --> 00:15:38,639
so they knew the ins and outs of their

418
00:15:38,639 --> 00:15:40,639
network they knew where the

419
00:15:40,639 --> 00:15:42,480
network flows were coming and when they

420
00:15:42,480 --> 00:15:45,040
were going okay so they could help us

421
00:15:45,040 --> 00:15:46,880
just pointing us where we have to look

422
00:15:46,880 --> 00:15:47,759
for

423
00:15:47,759 --> 00:15:50,079
everything we didn't have to figure out

424
00:15:50,079 --> 00:15:52,000
anything we just asked

425
00:15:52,000 --> 00:15:54,959
what is this love is here okay thank you

426
00:15:54,959 --> 00:15:57,440
uh two years of locks on everything

427
00:15:57,440 --> 00:15:59,519
and more logs and cold storage so

428
00:15:59,519 --> 00:16:02,320
enterprise backup for everything

429
00:16:02,320 --> 00:16:05,680
uh but not all the old-school things are

430
00:16:05,680 --> 00:16:08,000
good uh they didn't provide us with

431
00:16:08,000 --> 00:16:09,759
remote access because they don't work on

432
00:16:09,759 --> 00:16:10,880
remote

433
00:16:10,880 --> 00:16:13,759
uh the thing has had to be deployed on

434
00:16:13,759 --> 00:16:17,040
on site in the midst of a pandemic

435
00:16:17,040 --> 00:16:20,399
that wasn't uh so nice they limited us a

436
00:16:20,399 --> 00:16:23,279
little bit uh no edr okay

437
00:16:23,279 --> 00:16:24,959
they are starting to deploy it on evr

438
00:16:24,959 --> 00:16:27,199
but they don't have any evr right now so

439
00:16:27,199 --> 00:16:28,720
that wasn't

440
00:16:28,720 --> 00:16:32,160
a relevant uh data source for us in this

441
00:16:32,160 --> 00:16:34,800
and no real cm to speak about they have

442
00:16:34,800 --> 00:16:37,199
like a log collection for all the files

443
00:16:37,199 --> 00:16:39,120
and all of the communications but they

444
00:16:39,120 --> 00:16:40,880
didn't have a

445
00:16:40,880 --> 00:16:43,040
real cm but you can run queries so you

446
00:16:43,040 --> 00:16:44,480
have to grab

447
00:16:44,480 --> 00:16:46,880
grab everything

448
00:16:46,880 --> 00:16:48,480
okay

449
00:16:48,480 --> 00:16:49,440
so

450
00:16:49,440 --> 00:16:51,680
which are the results we discovered in

451
00:16:51,680 --> 00:16:53,920
this organization well thousands

452
00:16:53,920 --> 00:16:56,560
thousands of blog posts are requests

453
00:16:56,560 --> 00:16:57,360
but

454
00:16:57,360 --> 00:17:00,000
really really a few of them i think like

455
00:17:00,000 --> 00:17:02,639
only 50 of them return

456
00:17:02,639 --> 00:17:07,039
200 okay so all of them were 400 300

457
00:17:07,039 --> 00:17:10,959
even some 500 uh codes on on there

458
00:17:10,959 --> 00:17:11,679
and

459
00:17:11,679 --> 00:17:14,799
they scan like very they run batteries

460
00:17:14,799 --> 00:17:17,039
of tests they started with the simple

461
00:17:17,039 --> 00:17:18,720
ones they started to go through

462
00:17:18,720 --> 00:17:21,119
different batteries of

463
00:17:21,119 --> 00:17:23,039
attempts of exploitation we didn't find

464
00:17:23,039 --> 00:17:25,119
any secondary activity so that's good in

465
00:17:25,119 --> 00:17:26,240
this case

466
00:17:26,240 --> 00:17:27,919
and three

467
00:17:27,919 --> 00:17:30,320
in the other case we didn't

468
00:17:30,320 --> 00:17:32,480
neither we find any secondary activities

469
00:17:32,480 --> 00:17:34,160
related with blood for cells to other

470
00:17:34,160 --> 00:17:36,480
things yes but not too low for cells so

471
00:17:36,480 --> 00:17:38,480
three main sources of data in this case

472
00:17:38,480 --> 00:17:40,480
web server logs that's our primary

473
00:17:40,480 --> 00:17:42,400
source of data because we have the

474
00:17:42,400 --> 00:17:44,960
request there we can run that

475
00:17:44,960 --> 00:17:47,679
end the firewalls of the dmc okay to

476
00:17:47,679 --> 00:17:49,440
check a incoming connection and

477
00:17:49,440 --> 00:17:51,679
especially outgoing connections and

478
00:17:51,679 --> 00:17:53,840
check them with the timestamp of the

479
00:17:53,840 --> 00:17:55,600
of the worst ever locks

480
00:17:55,600 --> 00:17:56,799
which

481
00:17:56,799 --> 00:17:59,280
was a very manual labor

482
00:17:59,280 --> 00:18:01,760
in that way and pro syllabus just in

483
00:18:01,760 --> 00:18:03,520
case uh the

484
00:18:03,520 --> 00:18:05,760
the domain resolutions and all those

485
00:18:05,760 --> 00:18:08,080
things that uh china has already so last

486
00:18:08,080 --> 00:18:10,960
we also saw that

487
00:18:10,960 --> 00:18:11,919
okay

488
00:18:11,919 --> 00:18:14,640
so organization two uh

489
00:18:14,640 --> 00:18:16,559
it's one organization but there's

490
00:18:16,559 --> 00:18:18,400
hundred heads because it has business

491
00:18:18,400 --> 00:18:20,400
areas that are a little bit independent

492
00:18:20,400 --> 00:18:23,600
in their key uh in the ep realm but they

493
00:18:23,600 --> 00:18:25,520
also have different geographical areas

494
00:18:25,520 --> 00:18:27,200
that are quite independent in that and

495
00:18:27,200 --> 00:18:29,120
they have a global

496
00:18:29,120 --> 00:18:32,320
a global body of government in that way

497
00:18:32,320 --> 00:18:33,840
okay

498
00:18:33,840 --> 00:18:35,600
they come from the energy sector again

499
00:18:35,600 --> 00:18:38,960
critical operator and they were very

500
00:18:38,960 --> 00:18:40,400
very very worried about being

501
00:18:40,400 --> 00:18:43,840
compromised uh with this vulnerability

502
00:18:43,840 --> 00:18:46,960
uh complex network architecture

503
00:18:46,960 --> 00:18:49,840
it's multinational do uh traffic

504
00:18:49,840 --> 00:18:51,520
originated in one country can go out

505
00:18:51,520 --> 00:18:52,960
from the through the

506
00:18:52,960 --> 00:18:53,919
uh

507
00:18:53,919 --> 00:18:54,840
through

508
00:18:54,840 --> 00:18:58,960
the through order and then go uh get an

509
00:18:58,960 --> 00:19:01,360
in an address point that shouldn't be

510
00:19:01,360 --> 00:19:03,280
the one that uh you think on the

511
00:19:03,280 --> 00:19:06,240
beginning but okay that happened so it

512
00:19:06,240 --> 00:19:08,240
was very difficult to trace that request

513
00:19:08,240 --> 00:19:10,320
to it's already in the outgoing request

514
00:19:10,320 --> 00:19:12,720
because uh incoming we could we were

515
00:19:12,720 --> 00:19:13,840
able to

516
00:19:13,840 --> 00:19:16,640
to trace them uh sad oit saluting

517
00:19:16,640 --> 00:19:18,080
everywhere

518
00:19:18,080 --> 00:19:19,600
it's a problem they are aware of the

519
00:19:19,600 --> 00:19:21,200
problem and they are trying to fix it

520
00:19:21,200 --> 00:19:22,000
but

521
00:19:22,000 --> 00:19:23,120
it's

522
00:19:23,120 --> 00:19:25,280
it's very difficult to fix and also a

523
00:19:25,280 --> 00:19:27,679
complex chain of command so

524
00:19:27,679 --> 00:19:30,559
you have to go from global cso to local

525
00:19:30,559 --> 00:19:34,240
cso to then to the ip guy who really

526
00:19:34,240 --> 00:19:35,919
handle that asset

527
00:19:35,919 --> 00:19:37,679
to get access

528
00:19:37,679 --> 00:19:40,240
but they had a very good usage of cyber

529
00:19:40,240 --> 00:19:42,799
security technologies they were uh

530
00:19:42,799 --> 00:19:44,000
far more mature than the first

531
00:19:44,000 --> 00:19:45,840
organization and they had a very good

532
00:19:45,840 --> 00:19:48,000
coverage with the ddr they had been

533
00:19:48,000 --> 00:19:50,080
doing a really really great job during

534
00:19:50,080 --> 00:19:51,919
the last three years to deploy ideas in

535
00:19:51,919 --> 00:19:54,320
both workstations and servers and being

536
00:19:54,320 --> 00:19:56,160
able to manage all that infrastructure

537
00:19:56,160 --> 00:19:57,200
with that

538
00:19:57,200 --> 00:19:59,840
uh they got a real cm

539
00:19:59,840 --> 00:20:01,120
that was a

540
00:20:01,120 --> 00:20:03,919
welcome news for us and they have an

541
00:20:03,919 --> 00:20:06,799
already ongoing threat hunting process

542
00:20:06,799 --> 00:20:10,000
so we just plug into that and just add

543
00:20:10,000 --> 00:20:12,159
muscle to that and redirect that threat

544
00:20:12,159 --> 00:20:14,799
hunting powers love for cell and

545
00:20:14,799 --> 00:20:15,919
a

546
00:20:15,919 --> 00:20:18,720
provision some workstations to be able

547
00:20:18,720 --> 00:20:19,440
to

548
00:20:19,440 --> 00:20:21,280
analyze this search instance to be able

549
00:20:21,280 --> 00:20:23,600
to to run our queries

550
00:20:23,600 --> 00:20:24,480
uh

551
00:20:24,480 --> 00:20:27,280
they will already have uh established

552
00:20:27,280 --> 00:20:29,120
racing with a local team uh we have been

553
00:20:29,120 --> 00:20:32,320
working with them since 2018 so we were

554
00:20:32,320 --> 00:20:33,360
able to

555
00:20:33,360 --> 00:20:35,600
uh really speak with people that we know

556
00:20:35,600 --> 00:20:37,919
well and we have a level of con of trust

557
00:20:37,919 --> 00:20:39,200
in them and they have a level of

558
00:20:39,200 --> 00:20:42,159
transcendence that it was really really

559
00:20:42,159 --> 00:20:44,000
uh useful

560
00:20:44,000 --> 00:20:46,640
so adapt and overcome we don't have uh

561
00:20:46,640 --> 00:20:49,440
so clear uh path to trace the second

562
00:20:49,440 --> 00:20:51,200
state's iocs

563
00:20:51,200 --> 00:20:52,880
and

564
00:20:52,880 --> 00:20:54,720
we don't have full access to all the

565
00:20:54,720 --> 00:20:57,440
request logs for the fragmented chain of

566
00:20:57,440 --> 00:21:00,960
command that we have already speak about

567
00:21:00,960 --> 00:21:04,559
so we use avr we use edr to look for

568
00:21:04,559 --> 00:21:06,880
exploitation related activity

569
00:21:06,880 --> 00:21:08,240
commands related to love for sure

570
00:21:08,240 --> 00:21:10,080
exportation connections of common

571
00:21:10,080 --> 00:21:12,640
launches from java prime processes

572
00:21:12,640 --> 00:21:15,120
common slots from java prime processes

573
00:21:15,120 --> 00:21:17,600
and containing ips or domains that

574
00:21:17,600 --> 00:21:19,679
could be subspecies

575
00:21:19,679 --> 00:21:22,320
doing this we found some isis activity

576
00:21:22,320 --> 00:21:24,720
but not related no trace to log for

577
00:21:24,720 --> 00:21:28,000
cells so it's not relevant for this tool

578
00:21:28,000 --> 00:21:30,159
also palo alto panorama

579
00:21:30,159 --> 00:21:32,240
we didn't have work with this uh before

580
00:21:32,240 --> 00:21:34,559
uh but it was really useful to be able

581
00:21:34,559 --> 00:21:37,039
to trace uh the outgoing connections to

582
00:21:37,039 --> 00:21:39,600
its real origin across multiple

583
00:21:39,600 --> 00:21:42,320
firewalls across multiple countries

584
00:21:42,320 --> 00:21:45,200
and really really help us and save our

585
00:21:45,200 --> 00:21:47,760
save our asses

586
00:21:47,760 --> 00:21:50,640
okay what we found uh here uh no

587
00:21:50,640 --> 00:21:52,880
activity related with uh look for sales

588
00:21:52,880 --> 00:21:54,080
politician

589
00:21:54,080 --> 00:21:55,760
on

590
00:21:55,760 --> 00:21:57,360
the distribution of the countries were

591
00:21:57,360 --> 00:21:58,559
the

592
00:21:58,559 --> 00:22:00,480
where the malicious requests were in

593
00:22:00,480 --> 00:22:04,240
common the usual i think that uh you can

594
00:22:04,240 --> 00:22:06,000
see here the usual distribution that you

595
00:22:06,000 --> 00:22:08,320
are going to see every time

596
00:22:08,320 --> 00:22:10,720
you do this kind of investigation

597
00:22:10,720 --> 00:22:11,520
uh

598
00:22:11,520 --> 00:22:12,480
three main

599
00:22:12,480 --> 00:22:15,200
sources of data again web server logs uh

600
00:22:15,200 --> 00:22:17,200
we were able to put them in our elastic

601
00:22:17,200 --> 00:22:18,720
search uh

602
00:22:18,720 --> 00:22:21,919
engine and run queries on them and also

603
00:22:21,919 --> 00:22:24,880
for for other level of security redex

604
00:22:24,880 --> 00:22:27,039
and jara all of them

605
00:22:27,039 --> 00:22:28,240
the edr

606
00:22:28,240 --> 00:22:30,799
we were able to look into the processes

607
00:22:30,799 --> 00:22:32,320
of something that we couldn't do in the

608
00:22:32,320 --> 00:22:34,480
previous organization and outgoing

609
00:22:34,480 --> 00:22:37,039
connections to second stage is and palo

610
00:22:37,039 --> 00:22:38,320
alto

611
00:22:38,320 --> 00:22:40,799
that was also something that we used to

612
00:22:40,799 --> 00:22:42,720
trace back connections

613
00:22:42,720 --> 00:22:44,559
okay

614
00:22:44,559 --> 00:22:47,200
this is what we did what we see look for

615
00:22:47,200 --> 00:22:49,120
selling what what

616
00:22:49,120 --> 00:22:50,320
we

617
00:22:50,320 --> 00:22:51,919
can see look for cell being in the

618
00:22:51,919 --> 00:22:52,840
future

619
00:22:52,840 --> 00:22:56,240
okay uh well

620
00:22:56,240 --> 00:22:58,159
i think that we are going to see this

621
00:22:58,159 --> 00:23:00,960
more as a lateral movement vulnerability

622
00:23:00,960 --> 00:23:02,000
due to

623
00:23:02,000 --> 00:23:03,520
it has been mainly patched in the

624
00:23:03,520 --> 00:23:04,799
perimeter

625
00:23:04,799 --> 00:23:08,960
but legacy environments sadly

626
00:23:09,280 --> 00:23:11,760
out of support copies of software or

627
00:23:11,760 --> 00:23:13,280
illegal copies of so

628
00:23:13,280 --> 00:23:14,799
it shouldn't be used in enterprise

629
00:23:14,799 --> 00:23:15,919
environments

630
00:23:15,919 --> 00:23:17,760
but you come across them from time to

631
00:23:17,760 --> 00:23:19,600
time

632
00:23:19,600 --> 00:23:20,960
and

633
00:23:20,960 --> 00:23:23,600
also it's another thing that is not just

634
00:23:23,600 --> 00:23:25,120
look for cell

635
00:23:25,120 --> 00:23:27,570
is that a gndi

636
00:23:27,570 --> 00:23:30,679
[Music]

637
00:23:30,799 --> 00:23:33,200
that is vector

638
00:23:33,200 --> 00:23:34,640
it's not only in

639
00:23:34,640 --> 00:23:36,400
log4j okay

640
00:23:36,400 --> 00:23:38,480
i think that our the java libraries that

641
00:23:38,480 --> 00:23:41,279
does the same thing these are lookups

642
00:23:41,279 --> 00:23:42,880
and that they can be exploited in the

643
00:23:42,880 --> 00:23:46,320
future and this has opened pandora's box

644
00:23:46,320 --> 00:23:48,799
and a lot of people is aware now of that

645
00:23:48,799 --> 00:23:50,559
vector

646
00:23:50,559 --> 00:23:52,480
it has been left mainly alone since

647
00:23:52,480 --> 00:23:56,080
2016's that's seen that since that book

648
00:23:56,080 --> 00:23:57,919
but i think that the future is not going

649
00:23:57,919 --> 00:24:00,320
to be so kind with us so we should uh

650
00:24:00,320 --> 00:24:02,640
look for for this kind of vectors and

651
00:24:02,640 --> 00:24:04,320
natural movements of nuclear abilities

652
00:24:04,320 --> 00:24:07,918
that can lead in this way

653
00:24:08,400 --> 00:24:11,520
well acknowledgements just because

654
00:24:11,520 --> 00:24:12,960
i have to

655
00:24:12,960 --> 00:24:16,400
uh to alvaro munoz and alexander

656
00:24:16,400 --> 00:24:19,039
i just back butchered his name sorry

657
00:24:19,039 --> 00:24:21,679
for the work in the uh

658
00:24:21,679 --> 00:24:24,320
in the gndi lookups and remote code

659
00:24:24,320 --> 00:24:26,720
executions in java to florian wrote for

660
00:24:26,720 --> 00:24:29,200
the work he does for instant response

661
00:24:29,200 --> 00:24:31,440
teams really the information he

662
00:24:31,440 --> 00:24:33,760
published is useful always useful and in

663
00:24:33,760 --> 00:24:35,120
this case

664
00:24:35,120 --> 00:24:38,240
it saved my christmas so really thanks

665
00:24:38,240 --> 00:24:40,320
uh and to my co-workers who were

666
00:24:40,320 --> 00:24:42,640
involved in this in this work jos

667
00:24:42,640 --> 00:24:46,039
alberto lopez

668
00:24:46,400 --> 00:24:48,080
and in case you have any complaints

669
00:24:48,080 --> 00:24:49,679
about this

670
00:24:49,679 --> 00:24:51,679
this talk just addressed them to abel

671
00:24:51,679 --> 00:24:53,679
gonzalez who is responsible for me

672
00:24:53,679 --> 00:24:55,120
joining

673
00:24:55,120 --> 00:24:57,039
he put me up for this so all the

674
00:24:57,039 --> 00:24:58,840
complaints to

675
00:24:58,840 --> 00:25:03,840
him some resources we come very engaged

676
00:25:03,840 --> 00:25:06,159
uh some idiot worries we use cloud

677
00:25:06,159 --> 00:25:08,480
strike in this case so here you have uh

678
00:25:08,480 --> 00:25:10,159
some if you have to do this activity in

679
00:25:10,159 --> 00:25:12,640
the future you can come and look for

680
00:25:12,640 --> 00:25:13,520
this

681
00:25:13,520 --> 00:25:16,559
uh elasticsearch queries basically doing

682
00:25:16,559 --> 00:25:18,559
the uh doing the same

683
00:25:18,559 --> 00:25:21,039
uh diagonal is just a repository because

684
00:25:21,039 --> 00:25:23,679
we mainly use already already crafted

685
00:25:23,679 --> 00:25:26,000
jaguars that

686
00:25:26,000 --> 00:25:26,640
all

687
00:25:26,640 --> 00:25:29,360
search patterns uh that were

688
00:25:29,360 --> 00:25:31,120
prepared by the community and really

689
00:25:31,120 --> 00:25:32,720
really useful

690
00:25:32,720 --> 00:25:35,279
uh a palo alto panorama query just for

691
00:25:35,279 --> 00:25:37,919
by thread id uh the queries that we use

692
00:25:37,919 --> 00:25:39,200
for um

693
00:25:39,200 --> 00:25:40,960
to trace back the activity is not it's

694
00:25:40,960 --> 00:25:42,559
not something that is relevant for any

695
00:25:42,559 --> 00:25:44,400
other organization

696
00:25:44,400 --> 00:25:45,520
and

697
00:25:45,520 --> 00:25:48,080
oh and here there is a mistake uh this

698
00:25:48,080 --> 00:25:50,000
is not a palo alto panorama query this

699
00:25:50,000 --> 00:25:52,400
is basically how to check if your

700
00:25:52,400 --> 00:25:54,480
system is affected by the vulnerability

701
00:25:54,480 --> 00:25:56,559
both in linux and windows i think this

702
00:25:56,559 --> 00:25:58,320
resource is already known by a lot of

703
00:25:58,320 --> 00:26:01,120
people but here it is

704
00:26:01,120 --> 00:26:04,000
and finally thank you for your time

705
00:26:04,000 --> 00:26:06,320
and i hope that this talk has been

706
00:26:06,320 --> 00:26:09,320
useful

