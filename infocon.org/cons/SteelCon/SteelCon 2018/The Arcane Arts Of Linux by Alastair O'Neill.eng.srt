1
00:00:02,419 --> 00:00:07,319
and<font color="#E5E5E5"> welcome to my talk</font><font color="#CCCCCC"> the arcane arts</font>

2
00:00:05,670 --> 00:00:08,219
of<font color="#E5E5E5"> Linux which I know it says Lunik</font><font color="#CCCCCC"> a</font>

3
00:00:07,319 --> 00:00:11,849
<font color="#E5E5E5">unix but yeah</font>

4
00:00:08,220 --> 00:00:13,830
Linux so Who<font color="#CCCCCC"> am I</font>

5
00:00:11,849 --> 00:00:16,020
I'm<font color="#CCCCCC"> Marsh or some of you might know me</font>

6
00:00:13,830 --> 00:00:19,050
my by<font color="#E5E5E5"> my real name which is</font><font color="#CCCCCC"> Alistair I'm</font>

7
00:00:16,020 --> 00:00:20,880
a security<font color="#E5E5E5"> consultant at MD</font><font color="#CCCCCC"> SEC and</font><font color="#E5E5E5"> I'm</font>

8
00:00:19,050 --> 00:00:24,300
a pen tester I'm a researcher I do

9
00:00:20,880 --> 00:00:26,250
forensic work<font color="#E5E5E5"> my sort of areas of</font>

10
00:00:24,300 --> 00:00:27,869
expertise are<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> Linux malware and</font>

11
00:00:26,250 --> 00:00:30,509
they're also mainframes which is weird

12
00:00:27,869 --> 00:00:32,668
mix I know<font color="#CCCCCC"> but there you</font><font color="#E5E5E5"> go and I also</font>

13
00:00:30,510 --> 00:00:34,620
like Fortran and this is why<font color="#CCCCCC"> this</font>

14
00:00:32,668 --> 00:00:36,569
<font color="#CCCCCC">slideshow theme so terrible it's because</font>

15
00:00:34,620 --> 00:00:40,349
I love terrible ones<font color="#E5E5E5"> and you can find me</font>

16
00:00:36,570 --> 00:00:43,530
on Twitter and I'll get up there<font color="#CCCCCC"> so what</font>

17
00:00:40,350 --> 00:00:44,940
is<font color="#E5E5E5"> this talk so my my brief about it was</font>

18
00:00:43,530 --> 00:00:47,820
a little<font color="#E5E5E5"> bit big</font><font color="#CCCCCC"> and a little bit short</font>

19
00:00:44,940 --> 00:00:49,320
<font color="#E5E5E5">but basically I wanted to talk a little</font>

20
00:00:47,820 --> 00:00:50,760
bit<font color="#CCCCCC"> about tool development</font><font color="#E5E5E5"> and</font>

21
00:00:49,320 --> 00:00:53,610
techniques<font color="#E5E5E5"> for Linux so things like how</font>

22
00:00:50,760 --> 00:00:55,110
<font color="#E5E5E5">sort of I've</font><font color="#CCCCCC"> gone about building a</font>

23
00:00:53,610 --> 00:00:57,780
framework for<font color="#CCCCCC"> making implants and</font>

24
00:00:55,110 --> 00:01:00,269
exploitation<font color="#CCCCCC"> sort of stuff I want to</font>

25
00:00:57,780 --> 00:01:02,039
<font color="#E5E5E5">kind of go</font><font color="#CCCCCC"> over some of the stuff that's</font>

26
00:01:00,270 --> 00:01:03,660
actually<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there as</font><font color="#E5E5E5"> well in terms</font><font color="#CCCCCC"> of</font>

27
00:01:02,039 --> 00:01:05,220
like what kind of malware<font color="#E5E5E5"> is there at</font>

28
00:01:03,660 --> 00:01:08,130
the moment<font color="#E5E5E5"> what's the state of it how</font>

29
00:01:05,220 --> 00:01:10,200
can we take some<font color="#E5E5E5"> ideas from it and I</font>

30
00:01:08,130 --> 00:01:13,619
also want to discuss<font color="#CCCCCC"> some things</font><font color="#E5E5E5"> I've</font>

31
00:01:10,200 --> 00:01:16,530
<font color="#CCCCCC">been working on over the past</font><font color="#E5E5E5"> probably</font>

32
00:01:13,619 --> 00:01:18,299
eight<font color="#E5E5E5"> months give or take and maybe</font>

33
00:01:16,530 --> 00:01:19,939
maybe if I'm comfortable<font color="#CCCCCC"> to code I'll</font>

34
00:01:18,299 --> 00:01:22,110
release<font color="#E5E5E5"> them in like a day or two and</font>

35
00:01:19,939 --> 00:01:24,000
the rationalizations for<font color="#E5E5E5"> doing all of</font>

36
00:01:22,110 --> 00:01:27,330
<font color="#E5E5E5">this and I want to share some unusual</font>

37
00:01:24,000 --> 00:01:29,549
discoveries I've found what this talk<font color="#CCCCCC"> is</font>

38
00:01:27,330 --> 00:01:31,650
not<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be about is read</font><font color="#E5E5E5"> two more</font>

39
00:01:29,549 --> 00:01:33,960
stories<font color="#E5E5E5"> anything incredibly super</font>

40
00:01:31,650 --> 00:01:35,670
technical<font color="#E5E5E5"> and any other days</font>

41
00:01:33,960 --> 00:01:37,110
unfortunately<font color="#CCCCCC"> we're just gonna have</font><font color="#E5E5E5"> to</font>

42
00:01:35,670 --> 00:01:38,700
fish people who move<font color="#CCCCCC"> latter into these</font>

43
00:01:37,110 --> 00:01:41,369
Linux boxes<font color="#E5E5E5"> that's it that's what it is</font>

44
00:01:38,700 --> 00:01:43,170
<font color="#CCCCCC">and really</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can summarize</font><font color="#E5E5E5"> this is me</font>

45
00:01:41,369 --> 00:01:44,430
reading<font color="#CCCCCC"> mine pages for fun in my spare</font>

46
00:01:43,170 --> 00:01:50,310
time<font color="#E5E5E5"> because</font><font color="#CCCCCC"> that's the</font><font color="#E5E5E5"> kind of person</font>

47
00:01:44,430 --> 00:01:51,990
<font color="#CCCCCC">that I am and</font><font color="#E5E5E5"> so I like Linux but one of</font>

48
00:01:50,310 --> 00:01:54,119
<font color="#E5E5E5">the problems</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> find is that most of the</font>

49
00:01:51,990 --> 00:01:56,339
<font color="#E5E5E5">red team material I see out there tends</font>

50
00:01:54,119 --> 00:01:58,320
to<font color="#CCCCCC"> focus entirely on Windows it's all</font>

51
00:01:56,340 --> 00:02:00,439
going<font color="#E5E5E5"> to be written in PowerShell</font><font color="#CCCCCC"> it's</font>

52
00:01:58,320 --> 00:02:03,719
all going to be Windows<font color="#CCCCCC"> domain</font><font color="#E5E5E5"> specific</font>

53
00:02:00,439 --> 00:02:05,460
<font color="#E5E5E5">and kind of disappointed me because</font>

54
00:02:03,719 --> 00:02:06,899
Linux is actually quite popular still

55
00:02:05,460 --> 00:02:09,329
you still<font color="#E5E5E5"> find</font><font color="#CCCCCC"> a lot of servers in every</font>

56
00:02:06,899 --> 00:02:10,949
estate and we should I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> we should</font>

57
00:02:09,330 --> 00:02:12,610
have some<font color="#CCCCCC"> kind of focus</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> that there</font>

58
00:02:10,949 --> 00:02:14,290
are any guides for how

59
00:02:12,610 --> 00:02:15,790
<font color="#E5E5E5">an implant or start to create your</font><font color="#CCCCCC"> own</font>

60
00:02:14,290 --> 00:02:18,670
thing or build a tool change for

61
00:02:15,790 --> 00:02:20,350
compiling stuff and there's there's very

62
00:02:18,670 --> 00:02:22,959
very little in<font color="#E5E5E5"> the way of any kind of</font>

63
00:02:20,350 --> 00:02:24,460
<font color="#E5E5E5">post exploitation my</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> Windows you'll</font>

64
00:02:22,960 --> 00:02:26,080
have<font color="#CCCCCC"> like the</font><font color="#E5E5E5"> entire</font><font color="#CCCCCC"> Metasploit</font>

65
00:02:24,460 --> 00:02:27,760
framework<font color="#E5E5E5"> it has so much that you can</font>

66
00:02:26,080 --> 00:02:29,200
use in<font color="#E5E5E5"> return and there's like the</font><font color="#CCCCCC"> Linux</font>

67
00:02:27,760 --> 00:02:31,179
interpreter<font color="#E5E5E5"> but I find it's completely</font>

68
00:02:29,200 --> 00:02:33,280
lacking in comparison<font color="#CCCCCC"> and there are also</font>

69
00:02:31,180 --> 00:02:36,400
you know<font color="#E5E5E5"> obviously other windows things</font>

70
00:02:33,280 --> 00:02:37,720
and and what<font color="#E5E5E5"> little tools that are out</font>

71
00:02:36,400 --> 00:02:39,550
<font color="#CCCCCC">there</font><font color="#E5E5E5"> that are like really</font><font color="#CCCCCC"> high</font><font color="#E5E5E5"> quality</font>

72
00:02:37,720 --> 00:02:42,520
tend to be<font color="#E5E5E5"> things I've been neat or</font>

73
00:02:39,550 --> 00:02:46,240
they're slightly<font color="#E5E5E5"> I've been and I</font><font color="#CCCCCC"> don't</font>

74
00:02:42,520 --> 00:02:48,220
sort<font color="#E5E5E5"> of trust them so yeah I mean I</font>

75
00:02:46,240 --> 00:02:51,520
let's let's let's<font color="#E5E5E5"> talk about what</font>

76
00:02:48,220 --> 00:02:53,260
they're<font color="#E5E5E5"> actually is out there so from</font>

77
00:02:51,520 --> 00:02:54,820
the<font color="#E5E5E5"> pen tester side of things whenever I</font>

78
00:02:53,260 --> 00:02:55,899
see people<font color="#CCCCCC"> doing Linux jobs especially</font>

79
00:02:54,820 --> 00:02:58,390
<font color="#CCCCCC">ones that are a</font><font color="#E5E5E5"> little bit more</font>

80
00:02:55,900 --> 00:02:59,950
offensive<font color="#E5E5E5"> mostly what I see people do to</font>

81
00:02:58,390 --> 00:03:02,679
retain access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> things it's stuff like</font>

82
00:02:59,950 --> 00:03:04,119
SSH keys you know you'll drop your your

83
00:03:02,680 --> 00:03:06,340
key<font color="#E5E5E5"> and authorized keys and</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> will be</font>

84
00:03:04,120 --> 00:03:07,930
it occasionally<font color="#E5E5E5"> see people if they're</font>

85
00:03:06,340 --> 00:03:10,720
doing exploits<font color="#E5E5E5"> the normal reverse shell</font>

86
00:03:07,930 --> 00:03:12,940
out using<font color="#E5E5E5"> Python or netcat it's it's all</font>

87
00:03:10,720 --> 00:03:14,950
pretty pretty standard<font color="#CCCCCC"> stuff</font>

88
00:03:12,940 --> 00:03:16,690
the only real post exploitation I ever

89
00:03:14,950 --> 00:03:18,488
see is when<font color="#CCCCCC"> people</font><font color="#E5E5E5"> have been dropped</font>

90
00:03:16,690 --> 00:03:20,769
into a shell from an exploit they'll run

91
00:03:18,489 --> 00:03:26,170
Python<font color="#E5E5E5"> import</font><font color="#CCCCCC"> Peter why</font><font color="#E5E5E5"> Peter</font><font color="#CCCCCC"> why'd that</font>

92
00:03:20,769 --> 00:03:27,760
<font color="#E5E5E5">spawn been SH and and also if you're</font>

93
00:03:26,170 --> 00:03:29,920
<font color="#E5E5E5">doing you know a web app you've shelled</font>

94
00:03:27,760 --> 00:03:33,010
it<font color="#CCCCCC"> I have seen</font><font color="#E5E5E5"> people genuinely upload</font>

95
00:03:29,920 --> 00:03:34,420
like<font color="#CCCCCC"> scene 99</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> pastebin onto it you</font>

96
00:03:33,010 --> 00:03:36,310
know we should<font color="#CCCCCC"> probably be doing</font><font color="#E5E5E5"> a</font>

97
00:03:34,420 --> 00:03:38,679
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit better than this and it's all</font>

98
00:03:36,310 --> 00:03:42,040
very very manual<font color="#E5E5E5"> there's no automation</font>

99
00:03:38,680 --> 00:03:45,430
<font color="#CCCCCC">there's basically you're in</font><font color="#E5E5E5"> control</font>

100
00:03:42,040 --> 00:03:46,870
<font color="#CCCCCC">every step of the way which is fine but</font>

101
00:03:45,430 --> 00:03:48,400
<font color="#E5E5E5">it's a little bit problematic when</font>

102
00:03:46,870 --> 00:03:49,989
<font color="#E5E5E5">you're doing a job</font><font color="#CCCCCC"> that maybe requires</font>

103
00:03:48,400 --> 00:03:54,040
you to mass exploit a number of things

104
00:03:49,989 --> 00:03:55,480
and retain access<font color="#E5E5E5"> to them</font><font color="#CCCCCC"> and in terms</font>

105
00:03:54,040 --> 00:03:57,790
of<font color="#E5E5E5"> the pros these things are at least</font>

106
00:03:55,480 --> 00:03:59,709
quick to deploy<font color="#E5E5E5"> I mean again I literally</font>

107
00:03:57,790 --> 00:04:01,420
know that<font color="#E5E5E5"> Python</font><font color="#CCCCCC"> one-liner off the top</font>

108
00:03:59,709 --> 00:04:03,400
of<font color="#CCCCCC"> my head</font><font color="#E5E5E5"> and they're</font><font color="#CCCCCC"> native there</font>

109
00:04:01,420 --> 00:04:05,170
built in Linux tools normally so you

110
00:04:03,400 --> 00:04:07,180
won't<font color="#E5E5E5"> need any specific sort of</font>

111
00:04:05,170 --> 00:04:08,679
libraries you don't need to go through

112
00:04:07,180 --> 00:04:11,950
the hassle of compiling something and

113
00:04:08,680 --> 00:04:13,360
putting it on<font color="#E5E5E5"> the box</font><font color="#CCCCCC"> and making</font><font color="#E5E5E5"> you</font>

114
00:04:11,950 --> 00:04:15,458
<font color="#E5E5E5">know debugging and testing and making</font>

115
00:04:13,360 --> 00:04:17,440
<font color="#E5E5E5">sure it works</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> other hand the cons</font>

116
00:04:15,459 --> 00:04:19,060
<font color="#E5E5E5">are that it is least stealthy thing in</font>

117
00:04:17,440 --> 00:04:21,488
the world<font color="#CCCCCC"> it is like screaming I've</font>

118
00:04:19,060 --> 00:04:23,560
<font color="#E5E5E5">owned your box</font><font color="#CCCCCC"> on there I'm in there and</font>

119
00:04:21,488 --> 00:04:25,810
and just not<font color="#CCCCCC"> even trying to hide</font><font color="#E5E5E5"> and</font>

120
00:04:23,560 --> 00:04:27,130
there isn't very<font color="#E5E5E5"> much</font><font color="#CCCCCC"> functionality</font>

121
00:04:25,810 --> 00:04:28,889
in terms of<font color="#E5E5E5"> these things if you've got a</font>

122
00:04:27,130 --> 00:04:32,620
<font color="#E5E5E5">reversal you basically just have</font><font color="#CCCCCC"> patch</font>

123
00:04:28,889 --> 00:04:34,060
<font color="#CCCCCC">and no added bonuses sits</font><font color="#E5E5E5"> down</font><font color="#CCCCCC"> to you</font>

124
00:04:32,620 --> 00:04:35,650
because it's so manual whether you want

125
00:04:34,060 --> 00:04:38,560
to do<font color="#CCCCCC"> anti forensics kind of things and</font>

126
00:04:35,650 --> 00:04:40,179
and I<font color="#E5E5E5"> mean like we're talking</font><font color="#CCCCCC"> about</font>

127
00:04:38,560 --> 00:04:41,830
<font color="#CCCCCC">plaintext</font><font color="#E5E5E5"> reverse shells which is a</font>

128
00:04:40,180 --> 00:04:46,060
really bad<font color="#CCCCCC"> idea we shouldn't be doing</font>

129
00:04:41,830 --> 00:04:49,419
<font color="#E5E5E5">that unlike</font><font color="#CCCCCC"> clients things</font><font color="#E5E5E5"> and on the</font>

130
00:04:46,060 --> 00:04:51,880
black side<font color="#CCCCCC"> of things I hope you like</font>

131
00:04:49,419 --> 00:04:54,099
DDoS spots because that's<font color="#E5E5E5"> nearly</font><font color="#CCCCCC"> 90% of</font>

132
00:04:51,880 --> 00:04:57,280
it<font color="#E5E5E5"> and the 10% that isn't is either</font>

133
00:04:54,100 --> 00:04:59,220
<font color="#CCCCCC">pearl DDoS pots or its Bitcoin miners or</font>

134
00:04:57,280 --> 00:05:01,719
<font color="#CCCCCC">Manero designing</font><font color="#E5E5E5"> a new hot thing and</font>

135
00:04:59,220 --> 00:05:03,820
there's no post exploitation at all

136
00:05:01,720 --> 00:05:05,530
there's no<font color="#E5E5E5"> manual</font><font color="#CCCCCC"> interaction from</font><font color="#E5E5E5"> their</font>

137
00:05:03,820 --> 00:05:07,810
<font color="#E5E5E5">side they are scanning the</font><font color="#CCCCCC"> internet and</font>

138
00:05:05,530 --> 00:05:11,679
never actually<font color="#E5E5E5"> fetching it occasionally</font>

139
00:05:07,810 --> 00:05:13,419
they might go<font color="#E5E5E5"> to their IRC and like send</font>

140
00:05:11,680 --> 00:05:16,000
a command to ping flood something but

141
00:05:13,419 --> 00:05:18,010
that's<font color="#E5E5E5"> as</font><font color="#CCCCCC"> far as</font><font color="#E5E5E5"> they're gonna go and</font>

142
00:05:16,000 --> 00:05:20,820
yeah it's a very automatic<font color="#E5E5E5"> process with</font>

143
00:05:18,010 --> 00:05:23,050
no intelligence behind it<font color="#E5E5E5"> whatsoever</font><font color="#CCCCCC"> and</font>

144
00:05:20,820 --> 00:05:25,330
so there's plenty of features<font color="#E5E5E5"> they</font><font color="#CCCCCC"> are</font>

145
00:05:23,050 --> 00:05:28,419
all DDoS in features but they're still

146
00:05:25,330 --> 00:05:29,919
there<font color="#E5E5E5"> and there's</font><font color="#CCCCCC"> also absolutely</font><font color="#E5E5E5"> no</font>

147
00:05:28,419 --> 00:05:33,340
stealth or anything like that involved

148
00:05:29,919 --> 00:05:34,840
it's very<font color="#E5E5E5"> on intelligence it's loud it's</font>

149
00:05:33,340 --> 00:05:36,280
spray-and-pray<font color="#CCCCCC"> you're just trying to</font>

150
00:05:34,840 --> 00:05:40,179
<font color="#E5E5E5">hammer everything as quickly as you</font><font color="#CCCCCC"> can</font>

151
00:05:36,280 --> 00:05:41,380
<font color="#E5E5E5">and so yeah it's just there's not a</font>

152
00:05:40,180 --> 00:05:43,150
whole<font color="#CCCCCC"> lot there that's</font><font color="#E5E5E5"> actually any good</font>

153
00:05:41,380 --> 00:05:48,250
<font color="#E5E5E5">apart from the automation and even</font>

154
00:05:43,150 --> 00:05:50,229
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> not great um in terms</font><font color="#E5E5E5"> of like the</font>

155
00:05:48,250 --> 00:05:51,490
<font color="#CCCCCC">nation-state abt stuff we see a</font><font color="#E5E5E5"> Linux</font>

156
00:05:50,229 --> 00:05:53,950
this<font color="#E5E5E5"> is a little bit more interesting</font>

157
00:05:51,490 --> 00:05:55,919
<font color="#E5E5E5">and so we actually have a relatively</font>

158
00:05:53,950 --> 00:05:58,690
good<font color="#E5E5E5"> grasp of what's going on here</font>

159
00:05:55,919 --> 00:06:00,729
<font color="#E5E5E5">because of the shadow brokers</font><font color="#CCCCCC"> Andy vault</font>

160
00:05:58,690 --> 00:06:02,350
<font color="#E5E5E5">seven weeks we have access to manuals we</font>

161
00:06:00,729 --> 00:06:05,469
have access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> buy arrays in some rare</font>

162
00:06:02,350 --> 00:06:07,120
<font color="#CCCCCC">cases we have</font><font color="#E5E5E5"> access to source code</font><font color="#CCCCCC"> the</font>

163
00:06:05,470 --> 00:06:09,160
vault<font color="#E5E5E5"> seven leaks are pretty fantastic</font>

164
00:06:07,120 --> 00:06:12,430
because<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> what is essentially</font>

165
00:06:09,160 --> 00:06:13,720
their entire like<font color="#E5E5E5"> and sort of</font>

166
00:06:12,430 --> 00:06:15,160
development process you have their

167
00:06:13,720 --> 00:06:16,900
comments on their development<font color="#E5E5E5"> processes</font>

168
00:06:15,160 --> 00:06:19,150
<font color="#E5E5E5">with all of that you</font><font color="#CCCCCC"> can see why they've</font>

169
00:06:16,900 --> 00:06:20,830
done things also<font color="#E5E5E5"> because they are</font><font color="#CCCCCC"> a</font>

170
00:06:19,150 --> 00:06:22,270
nation<font color="#CCCCCC"> state they are like</font><font color="#E5E5E5"> holding</font>

171
00:06:20,830 --> 00:06:24,430
themselves<font color="#E5E5E5"> to quite a</font><font color="#CCCCCC"> high standard so</font>

172
00:06:22,270 --> 00:06:25,810
they've all got good crypto<font color="#E5E5E5"> so I don't</font>

173
00:06:24,430 --> 00:06:27,910
know if<font color="#E5E5E5"> you've</font><font color="#CCCCCC"> if anyone here if you</font>

174
00:06:25,810 --> 00:06:30,070
<font color="#CCCCCC">look</font><font color="#E5E5E5"> into them but the</font><font color="#CCCCCC"> vault</font><font color="#E5E5E5"> the vault</font>

175
00:06:27,910 --> 00:06:32,620
seven have all used like<font color="#E5E5E5"> a</font><font color="#CCCCCC"> polarizer so</font>

176
00:06:30,070 --> 00:06:35,050
<font color="#CCCCCC">I'm just</font><font color="#E5E5E5"> now called embed TLS which is a</font>

177
00:06:32,620 --> 00:06:37,300
tiny<font color="#E5E5E5"> like</font><font color="#CCCCCC"> SSL library</font><font color="#E5E5E5"> it was a limited</font>

178
00:06:35,050 --> 00:06:39,070
<font color="#CCCCCC">attack space so that's</font><font color="#E5E5E5"> pretty good and</font>

179
00:06:37,300 --> 00:06:41,320
it's also been audited and

180
00:06:39,070 --> 00:06:44,920
as far<font color="#E5E5E5"> as I'm aware so again also</font><font color="#CCCCCC"> great</font>

181
00:06:41,320 --> 00:06:47,650
and<font color="#E5E5E5"> and the shadow brokers they they are</font>

182
00:06:44,920 --> 00:06:49,930
having<font color="#CCCCCC"> good leaks yes great success they</font>

183
00:06:47,650 --> 00:06:52,179
have leaked a load of stuff with a lot

184
00:06:49,930 --> 00:06:54,940
<font color="#CCCCCC">less documentation a lot less content</font><font color="#E5E5E5"> in</font>

185
00:06:52,180 --> 00:06:56,620
<font color="#E5E5E5">terms of sort of contacts and how it</font>

186
00:06:54,940 --> 00:06:58,600
works<font color="#E5E5E5"> the best you can really hope for</font>

187
00:06:56,620 --> 00:06:59,740
are<font color="#E5E5E5"> those badly written text manuals</font>

188
00:06:58,600 --> 00:07:02,290
that<font color="#E5E5E5"> they seem to dropping everything</font>

189
00:06:59,740 --> 00:07:03,820
that are sort of<font color="#E5E5E5"> like a step by step</font><font color="#CCCCCC"> for</font>

190
00:07:02,290 --> 00:07:05,500
<font color="#E5E5E5">the operators to run through literally</font>

191
00:07:03,820 --> 00:07:09,520
gives the commands they copy and<font color="#CCCCCC"> paste</font>

192
00:07:05,500 --> 00:07:10,720
<font color="#CCCCCC">and</font><font color="#E5E5E5"> but you can kind</font><font color="#CCCCCC"> of get some context</font>

193
00:07:09,520 --> 00:07:11,919
from that you can<font color="#E5E5E5"> work out</font><font color="#CCCCCC"> how the tool</font>

194
00:07:10,720 --> 00:07:13,960
of work you can work out how<font color="#E5E5E5"> they're</font>

195
00:07:11,920 --> 00:07:17,590
supposed<font color="#E5E5E5"> to used and work out this was</font>

196
00:07:13,960 --> 00:07:19,870
targeting and the code<font color="#E5E5E5"> itself what you</font>

197
00:07:17,590 --> 00:07:22,150
see if it<font color="#E5E5E5"> is fairly clean unfortunately</font>

198
00:07:19,870 --> 00:07:24,670
there's not a whole lot<font color="#CCCCCC"> but it is there</font>

199
00:07:22,150 --> 00:07:26,560
there's also a third<font color="#CCCCCC"> toolkit which I</font>

200
00:07:24,670 --> 00:07:29,440
would<font color="#E5E5E5"> consider the main</font><font color="#CCCCCC"> nation-state</font>

201
00:07:26,560 --> 00:07:33,160
Linux ones<font color="#E5E5E5"> which is the Turla or penguin</font>

202
00:07:29,440 --> 00:07:37,000
toolkit<font color="#E5E5E5"> and it's pretty well documented</font>

203
00:07:33,160 --> 00:07:38,860
and if no one's familiar<font color="#CCCCCC"> with it I</font>

204
00:07:37,000 --> 00:07:40,390
actually think it may come up<font color="#CCCCCC"> in another</font>

205
00:07:38,860 --> 00:07:45,010
<font color="#CCCCCC">slide but if it</font><font color="#E5E5E5"> doesn't I'll talk with</font>

206
00:07:40,390 --> 00:07:49,570
<font color="#E5E5E5">one even now and so it was an apt</font>

207
00:07:45,010 --> 00:07:51,130
campaign that started<font color="#E5E5E5"> in 1996 on</font><font color="#CCCCCC"> its</font>

208
00:07:49,570 --> 00:07:54,130
from<font color="#E5E5E5"> Russia</font><font color="#CCCCCC"> basically you might known as</font>

209
00:07:51,130 --> 00:07:55,630
then<font color="#E5E5E5"> he's like Saturn rain or</font><font color="#CCCCCC"> midnight</font>

210
00:07:54,130 --> 00:07:58,180
rain or singing<font color="#E5E5E5"> Titan</font><font color="#CCCCCC"> rain there it is</font>

211
00:07:55,630 --> 00:08:00,159
Titan<font color="#E5E5E5"> rain and it had another name and</font>

212
00:07:58,180 --> 00:08:02,890
essentially it was<font color="#E5E5E5"> just</font><font color="#CCCCCC"> long-running abt</font>

213
00:08:00,160 --> 00:08:05,620
campaign and he<font color="#CCCCCC"> like</font><font color="#E5E5E5"> mid-90s so there's</font>

214
00:08:02,890 --> 00:08:08,770
sort of granddaddy of all of that<font color="#E5E5E5"> that</font>

215
00:08:05,620 --> 00:08:13,600
<font color="#E5E5E5">is still going</font><font color="#CCCCCC"> around the day and and I</font>

216
00:08:08,770 --> 00:08:15,099
want to say<font color="#E5E5E5"> Kaspersky</font><font color="#CCCCCC"> and were the guys</font>

217
00:08:13,600 --> 00:08:16,710
who identified it but they<font color="#E5E5E5"> found it</font>

218
00:08:15,100 --> 00:08:20,920
because<font color="#E5E5E5"> they found this really unusual</font>

219
00:08:16,710 --> 00:08:24,250
<font color="#CCCCCC">Linux backdoor</font><font color="#E5E5E5"> on a server they were</font>

220
00:08:20,920 --> 00:08:25,570
doing forensics on and they they found

221
00:08:24,250 --> 00:08:27,580
out eventually<font color="#E5E5E5"> that it turned out to be</font>

222
00:08:25,570 --> 00:08:31,150
<font color="#CCCCCC">related to a tool called Loki - which</font>

223
00:08:27,580 --> 00:08:32,829
was released on frack of 1994 and and

224
00:08:31,150 --> 00:08:34,270
they started<font color="#CCCCCC"> thinking then this is</font>

225
00:08:32,830 --> 00:08:35,800
really<font color="#E5E5E5"> weird you</font><font color="#CCCCCC"> know this is properly</font>

226
00:08:34,270 --> 00:08:37,718
old<font color="#E5E5E5"> I wonder if we can link that to</font>

227
00:08:35,799 --> 00:08:39,218
these these Russian guys and so

228
00:08:37,719 --> 00:08:40,810
eventually they<font color="#E5E5E5"> got their hands</font><font color="#CCCCCC"> that</font>

229
00:08:39,219 --> 00:08:42,130
<font color="#CCCCCC">served it and all</font><font color="#E5E5E5"> these logs all these</font>

230
00:08:40,809 --> 00:08:44,410
tools they're able to connect<font color="#E5E5E5"> those to</font>

231
00:08:42,130 --> 00:08:46,660
you now<font color="#E5E5E5"> basically you have the base of</font>

232
00:08:44,410 --> 00:08:47,860
<font color="#CCCCCC">this so you have the Loki two tools get</font>

233
00:08:46,660 --> 00:08:49,750
all<font color="#E5E5E5"> of their codes that they use</font>

234
00:08:47,860 --> 00:08:51,550
<font color="#CCCCCC">republic at their time like their</font>

235
00:08:49,750 --> 00:08:52,870
development is it's somewhat documented

236
00:08:51,550 --> 00:08:54,370
<font color="#E5E5E5">so compared to</font>

237
00:08:52,870 --> 00:08:56,410
<font color="#E5E5E5">where you might only have a single</font>

238
00:08:54,370 --> 00:09:00,940
<font color="#CCCCCC">binary and that's it it's strips this is</font>

239
00:08:56,410 --> 00:09:04,270
has some<font color="#CCCCCC"> information about it the pros</font>

240
00:09:00,940 --> 00:09:05,680
and<font color="#E5E5E5"> cons</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these are that there really</font>

241
00:09:04,270 --> 00:09:07,900
will<font color="#E5E5E5"> mean they're really resilient</font>

242
00:09:05,680 --> 00:09:10,300
<font color="#CCCCCC">they've clearly been tested on</font><font color="#E5E5E5"> a lot of</font>

243
00:09:07,900 --> 00:09:11,620
things if you've tried using<font color="#E5E5E5"> them which</font>

244
00:09:10,300 --> 00:09:13,089
I wouldn't<font color="#CCCCCC"> recommend because you're</font>

245
00:09:11,620 --> 00:09:15,730
using random binary from<font color="#E5E5E5"> the internet</font>

246
00:09:13,089 --> 00:09:18,339
and they<font color="#E5E5E5"> they are actually quite</font><font color="#CCCCCC"> good</font>

247
00:09:15,730 --> 00:09:21,370
<font color="#E5E5E5">and they've all got really strong crypto</font>

248
00:09:18,339 --> 00:09:22,839
and they're all pretty stealthy in

249
00:09:21,370 --> 00:09:24,339
comparison<font color="#CCCCCC"> to something that just lives</font>

250
00:09:22,839 --> 00:09:26,830
in temp and spits packets at everything

251
00:09:24,339 --> 00:09:28,510
<font color="#E5E5E5">that they can see and they</font><font color="#CCCCCC"> try to avoid</font>

252
00:09:26,830 --> 00:09:31,870
<font color="#E5E5E5">the obvious attribution as well which is</font>

253
00:09:28,510 --> 00:09:33,700
<font color="#E5E5E5">kind of good so you know you don't sort</font>

254
00:09:31,870 --> 00:09:36,130
of have<font color="#CCCCCC"> anything that</font><font color="#E5E5E5"> makes it super</font>

255
00:09:33,700 --> 00:09:38,200
<font color="#E5E5E5">obvious</font><font color="#CCCCCC"> that you're around and there's</font>

256
00:09:36,130 --> 00:09:40,510
also so much post exploitation stuff in

257
00:09:38,200 --> 00:09:42,010
this which is<font color="#E5E5E5"> again it's a different</font>

258
00:09:40,510 --> 00:09:43,390
<font color="#E5E5E5">sort</font><font color="#CCCCCC"> of style of attacked what you</font>

259
00:09:42,010 --> 00:09:45,069
<font color="#CCCCCC">normally</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> from the pen testing side</font>

260
00:09:43,390 --> 00:09:47,589
<font color="#E5E5E5">of things or the blackout side of things</font>

261
00:09:45,070 --> 00:09:49,540
<font color="#E5E5E5">the cons are I genuinely would not touch</font>

262
00:09:47,589 --> 00:09:50,620
<font color="#E5E5E5">any of the binaries I'll run them on any</font>

263
00:09:49,540 --> 00:09:53,500
of my own machines

264
00:09:50,620 --> 00:09:54,430
I'm not least like a<font color="#E5E5E5"> client machine</font><font color="#CCCCCC"> it</font>

265
00:09:53,500 --> 00:10:00,010
would<font color="#E5E5E5"> be the worst thing in</font><font color="#CCCCCC"> the world</font>

266
00:09:54,430 --> 00:10:01,449
and they they soceity<font color="#E5E5E5"> and so a quick</font>

267
00:10:00,010 --> 00:10:02,950
look as well<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> Shadow Broker</font><font color="#E5E5E5"> is</font>

268
00:10:01,450 --> 00:10:04,029
because again<font color="#E5E5E5"> they have the most sort of</font>

269
00:10:02,950 --> 00:10:05,260
content<font color="#E5E5E5"> one of the things</font><font color="#CCCCCC"> that's really</font>

270
00:10:04,029 --> 00:10:08,140
interesting about this<font color="#E5E5E5"> is they've got a</font>

271
00:10:05,260 --> 00:10:10,029
<font color="#CCCCCC">tool kit called</font><font color="#E5E5E5"> green spirit and or</font><font color="#CCCCCC"> GX</font>

272
00:10:08,140 --> 00:10:11,890
it's a post exploitation framework if

273
00:10:10,029 --> 00:10:14,650
<font color="#CCCCCC">you've it's it's part of the</font><font color="#E5E5E5"> Linux tub</font>

274
00:10:11,890 --> 00:10:18,790
that happens<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> the second</font><font color="#E5E5E5"> or third</font>

275
00:10:14,650 --> 00:10:22,420
<font color="#CCCCCC">shutter brothers and it had a lot of</font>

276
00:10:18,790 --> 00:10:24,099
<font color="#E5E5E5">features</font><font color="#CCCCCC"> and it had log cleaning</font><font color="#E5E5E5"> it had</font>

277
00:10:22,420 --> 00:10:25,660
like time<font color="#E5E5E5"> stopping when you walk</font><font color="#CCCCCC"> through</font>

278
00:10:24,100 --> 00:10:27,670
time<font color="#E5E5E5"> stamps with one file</font><font color="#CCCCCC"> to make</font><font color="#E5E5E5"> it</font>

279
00:10:25,660 --> 00:10:30,069
resemble<font color="#E5E5E5"> time stamps another or you</font><font color="#CCCCCC"> may</font>

280
00:10:27,670 --> 00:10:32,079
give you feel<font color="#CCCCCC"> slightly basically</font><font color="#E5E5E5"> and it</font>

281
00:10:30,070 --> 00:10:33,970
had like they've<font color="#E5E5E5"> taken a list of</font>

282
00:10:32,080 --> 00:10:35,529
signatures<font color="#E5E5E5"> from our calendar</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> chk</font>

283
00:10:33,970 --> 00:10:39,760
<font color="#CCCCCC">routed and me</font><font color="#E5E5E5"> implemented them in their</font>

284
00:10:35,529 --> 00:10:43,600
own tool and which is cool but they were

285
00:10:39,760 --> 00:10:45,160
<font color="#E5E5E5">looking for like worms from 2003 in 2013</font>

286
00:10:43,600 --> 00:10:46,839
and I was<font color="#E5E5E5"> thinking that's probably kind</font>

287
00:10:45,160 --> 00:10:49,180
of<font color="#E5E5E5"> pointless and</font>

288
00:10:46,839 --> 00:10:50,650
<font color="#CCCCCC">our scanning</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> it I'd like</font><font color="#E5E5E5"> I think</font>

289
00:10:49,180 --> 00:10:54,550
<font color="#CCCCCC">was even some lateral</font><font color="#E5E5E5"> movement things</font>

290
00:10:50,650 --> 00:10:56,350
there<font color="#E5E5E5"> it was it was very good and</font><font color="#CCCCCC"> it had</font>

291
00:10:54,550 --> 00:10:58,120
things<font color="#CCCCCC"> for</font><font color="#E5E5E5"> like scheduling tasks as well</font>

292
00:10:56,350 --> 00:11:00,070
so if they wanted<font color="#CCCCCC"> to</font><font color="#E5E5E5"> run a command in</font>

293
00:10:58,120 --> 00:11:01,150
<font color="#CCCCCC">the future they could set up a to be</font>

294
00:11:00,070 --> 00:11:03,250
scheduled using a number of<font color="#E5E5E5"> different</font>

295
00:11:01,150 --> 00:11:05,770
<font color="#CCCCCC">mechanisms it's it's Sue's interesting</font>

296
00:11:03,250 --> 00:11:06,490
it's written in Perl<font color="#E5E5E5"> and but all the</font>

297
00:11:05,770 --> 00:11:09,550
modern bits

298
00:11:06,490 --> 00:11:14,800
from the last<font color="#E5E5E5"> night say two years</font><font color="#CCCCCC"> from</font>

299
00:11:09,550 --> 00:11:17,079
<font color="#E5E5E5">the 2011 to 2013</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that was written in</font>

300
00:11:14,800 --> 00:11:17,439
Python that's<font color="#E5E5E5"> that kind of struck me</font><font color="#CCCCCC"> as</font>

301
00:11:17,080 --> 00:11:18,760
interesting

302
00:11:17,440 --> 00:11:21,339
<font color="#CCCCCC">it sort of matched up without me</font><font color="#E5E5E5"> per sec</font>

303
00:11:18,760 --> 00:11:23,200
has changed<font color="#E5E5E5"> generally like we all had</font>

304
00:11:21,339 --> 00:11:25,839
like<font color="#CCCCCC"> Perl in the early 2000s and now</font>

305
00:11:23,200 --> 00:11:27,700
we're<font color="#E5E5E5"> on Python</font><font color="#CCCCCC"> so you can kind</font><font color="#E5E5E5"> of vibe</font>

306
00:11:25,839 --> 00:11:30,580
<font color="#E5E5E5">with their their development style</font>

307
00:11:27,700 --> 00:11:33,250
um but yeah yeah I mean everything there

308
00:11:30,580 --> 00:11:34,750
is interesting but I thought I'd like to

309
00:11:33,250 --> 00:11:37,089
<font color="#E5E5E5">give it a shot I'd like to see if I can</font>

310
00:11:34,750 --> 00:11:38,800
build<font color="#CCCCCC"> something a bit more</font><font color="#E5E5E5"> fun</font><font color="#CCCCCC"> and so</font>

311
00:11:37,089 --> 00:11:44,980
this is my design hopefully someone gets

312
00:11:38,800 --> 00:11:47,290
<font color="#E5E5E5">this reference I'm just</font><font color="#CCCCCC"> a random guy so</font>

313
00:11:44,980 --> 00:11:50,040
as a base<font color="#E5E5E5"> I wanted to use something with</font>

314
00:11:47,290 --> 00:11:52,660
<font color="#E5E5E5">really simple really clean code and</font>

315
00:11:50,040 --> 00:11:55,420
there are lots<font color="#E5E5E5"> and</font><font color="#CCCCCC"> lots of</font><font color="#E5E5E5"> tools out</font>

316
00:11:52,660 --> 00:11:56,860
<font color="#E5E5E5">there that are</font><font color="#CCCCCC"> public and that</font><font color="#E5E5E5"> you can</font>

317
00:11:55,420 --> 00:11:58,300
take and you can<font color="#E5E5E5"> use I could have</font>

318
00:11:56,860 --> 00:12:00,130
written something<font color="#E5E5E5"> myself from</font><font color="#CCCCCC"> scratch</font>

319
00:11:58,300 --> 00:12:01,990
but I'm lazy and I want something<font color="#E5E5E5"> that</font>

320
00:12:00,130 --> 00:12:03,670
<font color="#CCCCCC">feels quickly I don't want to go through</font>

321
00:12:01,990 --> 00:12:07,779
the whole process of<font color="#E5E5E5"> the building so I</font>

322
00:12:03,670 --> 00:12:09,790
picked a<font color="#CCCCCC"> backdoor called</font><font color="#E5E5E5"> th and it's</font>

323
00:12:07,779 --> 00:12:10,930
very functional<font color="#CCCCCC"> it's it</font><font color="#E5E5E5"> doesn't have</font>

324
00:12:09,790 --> 00:12:12,610
much<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the way of features to be fair</font>

325
00:12:10,930 --> 00:12:15,219
to it it has file upload file download

326
00:12:12,610 --> 00:12:17,829
<font color="#E5E5E5">no interactive shell with</font><font color="#CCCCCC"> PTY but it's</font>

327
00:12:15,220 --> 00:12:20,440
it's good<font color="#CCCCCC"> it's tiny code</font><font color="#E5E5E5"> it's stable in</font>

328
00:12:17,829 --> 00:12:22,870
a strong crypto<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's been used by</font>

329
00:12:20,440 --> 00:12:25,720
the<font color="#E5E5E5"> CIA</font><font color="#CCCCCC"> and China</font><font color="#E5E5E5"> in various different</font>

330
00:12:22,870 --> 00:12:28,180
variations and forms and the one that I

331
00:12:25,720 --> 00:12:30,610
use<font color="#E5E5E5"> is one that was modified</font><font color="#CCCCCC"> by a friend</font>

332
00:12:28,180 --> 00:12:33,370
<font color="#E5E5E5">of mine called</font><font color="#CCCCCC"> Darren</font><font color="#E5E5E5"> and our info</font><font color="#CCCCCC"> Doc's</font>

333
00:12:30,610 --> 00:12:34,870
on<font color="#CCCCCC"> Twitter he added SCTP support so if</font>

334
00:12:33,370 --> 00:12:36,790
no one's<font color="#E5E5E5"> familiar with that it's kind of</font>

335
00:12:34,870 --> 00:12:39,459
<font color="#E5E5E5">like a protocol similar to TCP and UDP</font>

336
00:12:36,790 --> 00:12:40,899
on the same layer but most firewalls<font color="#E5E5E5"> and</font>

337
00:12:39,459 --> 00:12:43,199
firewall configurations just sort of

338
00:12:40,899 --> 00:12:44,950
ignore you can<font color="#E5E5E5"> even swap right out and</font>

339
00:12:43,200 --> 00:12:46,810
do you think<font color="#CCCCCC"> she has</font><font color="#E5E5E5"> no real</font>

340
00:12:44,950 --> 00:12:47,980
dependencies as well which<font color="#E5E5E5"> is one of the</font>

341
00:12:46,810 --> 00:12:49,469
things I was<font color="#E5E5E5"> looking for I wanted</font>

342
00:12:47,980 --> 00:12:54,610
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> could be</font><font color="#E5E5E5"> standalone and</font>

343
00:12:49,470 --> 00:12:57,220
wouldn't cause any sort<font color="#E5E5E5"> of issues if I</font>

344
00:12:54,610 --> 00:12:58,930
was dynamically compiling it first<font color="#CCCCCC"> and</font>

345
00:12:57,220 --> 00:13:00,520
statically compiled or if I was

346
00:12:58,930 --> 00:13:04,209
statically compiled it wouldn't end<font color="#E5E5E5"> up</font>

347
00:13:00,520 --> 00:13:07,029
being<font color="#E5E5E5"> 30 MB in size</font><font color="#CCCCCC"> which I tried</font><font color="#E5E5E5"> to</font>

348
00:13:04,209 --> 00:13:09,939
<font color="#E5E5E5">prevent as much as</font><font color="#CCCCCC"> possible</font><font color="#E5E5E5"> and so I</font>

349
00:13:07,029 --> 00:13:11,680
started<font color="#E5E5E5"> by choosing a</font><font color="#CCCCCC"> C library because</font>

350
00:13:09,940 --> 00:13:13,089
while you could study<font color="#CCCCCC"> the compiler</font>

351
00:13:11,680 --> 00:13:14,529
<font color="#E5E5E5">something with gene you</font><font color="#CCCCCC"> would see what</font>

352
00:13:13,089 --> 00:13:16,089
happens is you do end up<font color="#CCCCCC"> with</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> two</font>

353
00:13:14,529 --> 00:13:17,410
megabyte binary and if you're<font color="#E5E5E5"> trying to</font>

354
00:13:16,089 --> 00:13:18,820
<font color="#E5E5E5">shuffle that around the client network</font>

355
00:13:17,410 --> 00:13:20,350
all<font color="#CCCCCC"> the time that is</font><font color="#E5E5E5"> going to be super</font>

356
00:13:18,820 --> 00:13:23,590
<font color="#CCCCCC">loud and</font><font color="#E5E5E5"> super obvious so</font>

357
00:13:20,350 --> 00:13:25,630
I went for<font color="#E5E5E5"> diet and which if anyone's</font>

358
00:13:23,590 --> 00:13:28,990
familiar with it's a<font color="#E5E5E5"> very small</font><font color="#CCCCCC"> see</font>

359
00:13:25,630 --> 00:13:31,990
library<font color="#CCCCCC"> and and it's it's it's pretty</font>

360
00:13:28,990 --> 00:13:34,150
<font color="#CCCCCC">much the</font><font color="#E5E5E5"> smallest one you can get and it</font>

361
00:13:31,990 --> 00:13:36,430
takes a<font color="#E5E5E5"> bit of time to</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> and then get</font>

362
00:13:34,150 --> 00:13:37,420
like<font color="#CCCCCC"> TSH D to compile with</font><font color="#E5E5E5"> it due to the</font>

363
00:13:36,430 --> 00:13:39,699
fact<font color="#E5E5E5"> that TSH</font>

364
00:13:37,420 --> 00:13:41,530
uses some<font color="#CCCCCC"> pdy functions that aren't</font><font color="#E5E5E5"> in</font>

365
00:13:39,700 --> 00:13:43,120
diet<font color="#E5E5E5"> so you like what</font><font color="#CCCCCC"> I did</font><font color="#E5E5E5"> was I just</font>

366
00:13:41,530 --> 00:13:45,819
<font color="#CCCCCC">stripped that</font><font color="#E5E5E5"> out and I replaced it with</font>

367
00:13:43,120 --> 00:13:48,130
just a standard<font color="#E5E5E5"> for exactly to get us a</font>

368
00:13:45,820 --> 00:13:49,500
<font color="#E5E5E5">normal shell but I think you could</font>

369
00:13:48,130 --> 00:13:52,240
probably<font color="#E5E5E5"> take some time</font><font color="#CCCCCC"> rema</font>

370
00:13:49,500 --> 00:13:55,450
<font color="#E5E5E5">re-implemented pdy shell in probably a</font>

371
00:13:52,240 --> 00:13:56,950
day<font color="#E5E5E5"> or two and</font><font color="#CCCCCC"> I also spent quite</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> bit</font>

372
00:13:55,450 --> 00:13:59,260
<font color="#E5E5E5">of time playing</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> the compilers as</font>

373
00:13:56,950 --> 00:14:01,990
well and flats<font color="#E5E5E5"> so probably for about a</font>

374
00:13:59,260 --> 00:14:03,640
month<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> my spare time was</font><font color="#E5E5E5"> trying to</font>

375
00:14:01,990 --> 00:14:05,350
optimize this as much<font color="#CCCCCC"> as</font><font color="#E5E5E5"> possible and</font>

376
00:14:03,640 --> 00:14:06,790
<font color="#CCCCCC">try to</font><font color="#E5E5E5"> remove any kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> debugging or</font>

377
00:14:05,350 --> 00:14:09,520
like debugging symbols or anything like

378
00:14:06,790 --> 00:14:11,400
<font color="#E5E5E5">that</font><font color="#CCCCCC"> so GCC</font><font color="#E5E5E5"> PCC</font><font color="#CCCCCC"> clang I</font><font color="#E5E5E5"> was pretty much</font>

379
00:14:09,520 --> 00:14:13,689
going<font color="#E5E5E5"> through</font><font color="#CCCCCC"> counselling and I'm</font>

380
00:14:11,400 --> 00:14:15,130
there's also a<font color="#E5E5E5"> tool kit called elf</font>

381
00:14:13,690 --> 00:14:16,240
<font color="#CCCCCC">Vickers which I found as well it's</font>

382
00:14:15,130 --> 00:14:18,700
really really useful

383
00:14:16,240 --> 00:14:21,310
it has a strip in<font color="#CCCCCC"> it that is a</font><font color="#E5E5E5"> lot more</font>

384
00:14:18,700 --> 00:14:24,040
<font color="#E5E5E5">functional than the</font><font color="#CCCCCC"> gnu strip that comes</font>

385
00:14:21,310 --> 00:14:28,839
with the<font color="#CCCCCC"> binutils</font><font color="#E5E5E5"> you can remove</font>

386
00:14:24,040 --> 00:14:31,630
sections<font color="#E5E5E5"> you can basically strip a lot</font>

387
00:14:28,840 --> 00:14:34,660
more data and<font color="#CCCCCC"> that massively reducing</font>

388
00:14:31,630 --> 00:14:36,400
the size so by the<font color="#E5E5E5"> end of it I was</font>

389
00:14:34,660 --> 00:14:40,420
compiling<font color="#E5E5E5"> these really great static</font>

390
00:14:36,400 --> 00:14:43,689
binaries for<font color="#E5E5E5"> x86 that were about and I</font>

391
00:14:40,420 --> 00:14:44,650
think<font color="#CCCCCC"> 50k in size which was which</font><font color="#E5E5E5"> was</font>

392
00:14:43,690 --> 00:14:46,510
good that<font color="#E5E5E5"> was kind of what I was looking</font>

393
00:14:44,650 --> 00:14:50,560
<font color="#CCCCCC">for but they still weren't very</font>

394
00:14:46,510 --> 00:14:51,240
obfuscated<font color="#CCCCCC"> so I decided I would</font><font color="#E5E5E5"> step up</font>

395
00:14:50,560 --> 00:14:55,689
my game

396
00:14:51,240 --> 00:14:58,030
so<font color="#E5E5E5"> in fodox again he revived the Packer</font>

397
00:14:55,690 --> 00:14:59,770
from about a decade<font color="#CCCCCC"> ago and this</font><font color="#E5E5E5"> is a PG</font>

398
00:14:58,030 --> 00:15:00,910
talk I've<font color="#E5E5E5"> thought about this so I'm</font><font color="#CCCCCC"> just</font>

399
00:14:59,770 --> 00:15:04,090
gonna say<font color="#CCCCCC"> that if the name of this</font>

400
00:15:00,910 --> 00:15:05,620
compactor begins with elf<font color="#E5E5E5"> and and if you</font>

401
00:15:04,090 --> 00:15:07,690
want to know what it<font color="#E5E5E5"> is later I'll come</font>

402
00:15:05,620 --> 00:15:09,370
<font color="#CCCCCC">and ask</font><font color="#E5E5E5"> me and he decided to create a</font>

403
00:15:07,690 --> 00:15:12,340
reverse engineering challenge which he

404
00:15:09,370 --> 00:15:16,240
called the<font color="#CCCCCC"> hello binary which was a bit</font>

405
00:15:12,340 --> 00:15:18,130
of<font color="#CCCCCC"> a pain to</font><font color="#E5E5E5"> to undo but yeah this is</font>

406
00:15:16,240 --> 00:15:20,140
<font color="#CCCCCC">this</font><font color="#E5E5E5"> Packer is really really great</font><font color="#CCCCCC"> so it</font>

407
00:15:18,130 --> 00:15:22,660
only supports x86 and<font color="#CCCCCC"> the crypto is</font>

408
00:15:20,140 --> 00:15:24,280
ancient it uses like our c4 is I think

409
00:15:22,660 --> 00:15:26,709
<font color="#E5E5E5">the most modern thing or maybe Blowfish</font>

410
00:15:24,280 --> 00:15:28,720
<font color="#E5E5E5">and but it does produce polymorphic</font>

411
00:15:26,710 --> 00:15:32,320
binary there are no obvious strings in

412
00:15:28,720 --> 00:15:33,820
them<font color="#E5E5E5"> it's relatively hard to signature</font>

413
00:15:32,320 --> 00:15:35,260
as well because of the<font color="#E5E5E5"> volume of</font>

414
00:15:33,820 --> 00:15:38,230
like the<font color="#E5E5E5"> actual amount of polymorphism</font>

415
00:15:35,260 --> 00:15:39,250
<font color="#E5E5E5">my producers I don't know 30 or 40</font>

416
00:15:38,230 --> 00:15:40,420
<font color="#CCCCCC">different batteries now let's try</font><font color="#E5E5E5"> to</font>

417
00:15:39,250 --> 00:15:42,100
look<font color="#E5E5E5"> for</font><font color="#CCCCCC"> patterns between</font><font color="#E5E5E5"> them and there</font>

418
00:15:40,420 --> 00:15:43,839
isn't<font color="#CCCCCC"> actually that</font><font color="#E5E5E5"> much there's the</font>

419
00:15:42,100 --> 00:15:45,520
first<font color="#E5E5E5"> maybe I think it's to hundreds or</font>

420
00:15:43,840 --> 00:15:48,220
something like<font color="#E5E5E5"> that that are obviously</font>

421
00:15:45,520 --> 00:15:49,540
that but yeah um I think<font color="#E5E5E5"> you can</font>

422
00:15:48,220 --> 00:15:52,320
<font color="#E5E5E5">probably change that as well a bit of</font>

423
00:15:49,540 --> 00:15:56,680
work<font color="#CCCCCC"> to modify it make</font><font color="#E5E5E5"> it a bit more</font>

424
00:15:52,320 --> 00:15:59,470
<font color="#CCCCCC">difficult a signature</font><font color="#E5E5E5"> um so yeah I mean</font>

425
00:15:56,680 --> 00:16:01,989
now<font color="#E5E5E5"> what you</font><font color="#CCCCCC"> end up getting is you have</font>

426
00:15:59,470 --> 00:16:04,150
a tool chain which I then automated to

427
00:16:01,990 --> 00:16:05,920
produce these<font color="#E5E5E5"> tiny binaries</font><font color="#CCCCCC"> they're</font>

428
00:16:04,150 --> 00:16:07,090
polymorphically packs<font color="#E5E5E5"> they're platform</font>

429
00:16:05,920 --> 00:16:10,000
agnostic in the sense that<font color="#E5E5E5"> they'll</font><font color="#CCCCCC"> run</font>

430
00:16:07,090 --> 00:16:11,800
on x86 or x64<font color="#E5E5E5"> which is really good</font>

431
00:16:10,000 --> 00:16:13,030
because<font color="#E5E5E5"> occasionally on</font><font color="#CCCCCC"> like line work</font>

432
00:16:11,800 --> 00:16:15,579
you might<font color="#E5E5E5"> find for</font><font color="#CCCCCC"> example in</font>

433
00:16:13,030 --> 00:16:16,510
<font color="#E5E5E5">that'sthat's x86 and that can be a pain</font>

434
00:16:15,580 --> 00:16:18,970
if you've got to recompile<font color="#E5E5E5"> everything</font>

435
00:16:16,510 --> 00:16:23,020
from exit 54<font color="#E5E5E5"> and you can see the</font><font color="#CCCCCC"> output</font>

436
00:16:18,970 --> 00:16:25,030
of<font color="#E5E5E5"> a life</font><font color="#CCCCCC"> stair it's 31 K and one of the</font>

437
00:16:23,020 --> 00:16:26,829
things you can also see the file<font color="#CCCCCC"> output</font>

438
00:16:25,030 --> 00:16:31,209
which is<font color="#E5E5E5"> held invalid class and byte</font>

439
00:16:26,830 --> 00:16:36,370
order and because of<font color="#E5E5E5"> the horrible</font>

440
00:16:31,210 --> 00:16:39,040
mangling it does to the to the<font color="#CCCCCC"> alpha and</font>

441
00:16:36,370 --> 00:16:43,150
and it's a bit of a pain<font color="#CCCCCC"> to reverse to</font>

442
00:16:39,040 --> 00:16:46,750
be honest<font color="#E5E5E5"> and</font><font color="#CCCCCC"> D yeah and there</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> the</font>

443
00:16:43,150 --> 00:16:48,880
<font color="#CCCCCC">packed binaries are unique and which is</font>

444
00:16:46,750 --> 00:16:50,170
good in a sense of the polymorphism it's

445
00:16:48,880 --> 00:16:51,670
<font color="#CCCCCC">funny</font><font color="#E5E5E5"> it's quite hard to signature the</font>

446
00:16:50,170 --> 00:16:53,410
content but one of<font color="#CCCCCC"> the problems I have</font>

447
00:16:51,670 --> 00:16:55,150
<font color="#CCCCCC">with</font><font color="#E5E5E5"> it is that the file header is as</font>

448
00:16:53,410 --> 00:16:56,469
you've seen<font color="#CCCCCC"> before really unique you're</font>

449
00:16:55,150 --> 00:16:59,170
not going to see<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> normal</font><font color="#E5E5E5"> UNIX</font>

450
00:16:56,470 --> 00:17:00,400
box<font color="#E5E5E5"> and if you were dropping these on</font>

451
00:16:59,170 --> 00:17:01,630
disk and<font color="#E5E5E5"> you're leaving them and someone</font>

452
00:17:00,400 --> 00:17:03,250
<font color="#CCCCCC">is doing a fine</font><font color="#E5E5E5"> if someone is looking</font>

453
00:17:01,630 --> 00:17:04,480
<font color="#E5E5E5">around you they will</font><font color="#CCCCCC"> find that</font><font color="#E5E5E5"> pretty</font>

454
00:17:03,250 --> 00:17:07,569
quickly and notice immediately that

455
00:17:04,480 --> 00:17:09,699
<font color="#CCCCCC">study</font><font color="#E5E5E5"> and so ideally what you'd be doing</font>

456
00:17:07,569 --> 00:17:11,139
<font color="#CCCCCC">is you'd be using</font><font color="#E5E5E5"> a mem FD which I'll</font>

457
00:17:09,699 --> 00:17:12,459
talk about later to execute<font color="#E5E5E5"> this in</font>

458
00:17:11,140 --> 00:17:15,010
memory<font color="#CCCCCC"> and Linux without ever actually</font>

459
00:17:12,459 --> 00:17:16,600
touching<font color="#E5E5E5"> disk or if you can't do</font><font color="#CCCCCC"> that</font>

460
00:17:15,010 --> 00:17:21,790
for whatever reason<font color="#CCCCCC"> it's an older kernel</font>

461
00:17:16,599 --> 00:17:23,020
you'll run it from<font color="#CCCCCC"> dead shn and there is</font>

462
00:17:21,790 --> 00:17:25,030
some work<font color="#CCCCCC"> that needs to be done</font><font color="#E5E5E5"> to this</font>

463
00:17:23,020 --> 00:17:28,810
<font color="#E5E5E5">Packer and it needs to be modernized and</font>

464
00:17:25,030 --> 00:17:30,700
then but it's doable<font color="#CCCCCC"> and one of the</font>

465
00:17:28,810 --> 00:17:33,280
other downsides here is that there's no

466
00:17:30,700 --> 00:17:35,470
support<font color="#E5E5E5"> for</font><font color="#CCCCCC"> armed or MIPS</font><font color="#E5E5E5"> at the moment</font>

467
00:17:33,280 --> 00:17:37,330
so you'll find<font color="#E5E5E5"> those as well quite</font>

468
00:17:35,470 --> 00:17:40,750
regular<font color="#E5E5E5"> routers and things like that or</font>

469
00:17:37,330 --> 00:17:43,240
again masses and and that would<font color="#E5E5E5"> require</font>

470
00:17:40,750 --> 00:17:45,610
an awful<font color="#E5E5E5"> lot more work but on the other</font>

471
00:17:43,240 --> 00:17:47,470
hand<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> upx</font><font color="#E5E5E5"> for that and I mean I</font>

472
00:17:45,610 --> 00:17:49,090
think<font color="#E5E5E5"> well you'd be a certain produce</font>

473
00:17:47,470 --> 00:17:50,919
<font color="#E5E5E5">binary is at least you can just</font><font color="#CCCCCC"> strip</font>

474
00:17:49,090 --> 00:17:52,959
out really obvious strings all over the

475
00:17:50,919 --> 00:17:55,659
UK<font color="#E5E5E5"> expiry let's say this has been packed</font>

476
00:17:52,960 --> 00:18:00,520
<font color="#E5E5E5">by</font><font color="#CCCCCC"> uvx</font><font color="#E5E5E5"> this is definitely packed by</font><font color="#CCCCCC"> ubx</font>

477
00:17:55,659 --> 00:18:02,320
<font color="#E5E5E5">guys we're using</font><font color="#CCCCCC"> upx</font><font color="#E5E5E5"> and but yeah yeah I</font>

478
00:18:00,520 --> 00:18:04,690
<font color="#E5E5E5">mean one of the other things that I was</font>

479
00:18:02,320 --> 00:18:07,030
<font color="#E5E5E5">finding with this is once one thing</font>

480
00:18:04,690 --> 00:18:09,490
compiled fine<font color="#E5E5E5"> I could apply this tool</font>

481
00:18:07,030 --> 00:18:12,668
chain to a whole bunch<font color="#CCCCCC"> of stuff and so</font>

482
00:18:09,490 --> 00:18:14,080
<font color="#CCCCCC">in math isn't</font><font color="#E5E5E5"> too</font><font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> statically</font>

483
00:18:12,669 --> 00:18:16,090
compiled with a<font color="#E5E5E5"> non-standard like</font>

484
00:18:14,080 --> 00:18:18,250
library and non-standard<font color="#E5E5E5"> toolkits but I</font>

485
00:18:16,090 --> 00:18:20,949
was able to compile a strobe<font color="#CCCCCC"> an ancient</font>

486
00:18:18,250 --> 00:18:22,900
port scanner from 1997 effectively and

487
00:18:20,950 --> 00:18:24,490
it works and<font color="#E5E5E5"> it's really fast it he's</font>

488
00:18:22,900 --> 00:18:29,679
actually<font color="#E5E5E5"> comparable to end that a lot of</font>

489
00:18:24,490 --> 00:18:32,500
<font color="#CCCCCC">time and and like just</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> test this I</font>

490
00:18:29,679 --> 00:18:34,150
<font color="#E5E5E5">took the</font><font color="#CCCCCC"> em like system decode that they</font>

491
00:18:32,500 --> 00:18:35,890
released publicly<font color="#E5E5E5"> a while back maybe a</font>

492
00:18:34,150 --> 00:18:38,140
<font color="#E5E5E5">year</font><font color="#CCCCCC"> or two ago and</font><font color="#E5E5E5"> I started compiling</font>

493
00:18:35,890 --> 00:18:40,390
like the the bid<font color="#CCCCCC"> the</font><font color="#E5E5E5"> utilities</font><font color="#CCCCCC"> nets like</font>

494
00:18:38,140 --> 00:18:41,860
I have a system<font color="#CCCCCC"> v ID that I can run as</font>

495
00:18:40,390 --> 00:18:43,929
<font color="#E5E5E5">compiled this tool chain</font><font color="#CCCCCC"> and it's</font><font color="#E5E5E5"> tiny</font>

496
00:18:41,860 --> 00:18:47,408
<font color="#E5E5E5">and probably more quickly packed</font>

497
00:18:43,929 --> 00:18:50,919
<font color="#E5E5E5">um but yeah there is an awful lot of</font>

498
00:18:47,409 --> 00:18:53,440
<font color="#E5E5E5">work left to do</font><font color="#CCCCCC"> on this</font><font color="#E5E5E5"> so I need to</font>

499
00:18:50,919 --> 00:18:54,400
<font color="#E5E5E5">modify tiny shell to use a proper CNC</font>

500
00:18:53,440 --> 00:18:56,289
<font color="#CCCCCC">because at the moment data is</font>

501
00:18:54,400 --> 00:18:57,700
essentially file upload file download

502
00:18:56,289 --> 00:19:00,580
and this show or you can<font color="#E5E5E5"> Institute</font>

503
00:18:57,700 --> 00:19:02,830
<font color="#E5E5E5">things I'd much rather have an actual</font>

504
00:19:00,580 --> 00:19:04,720
<font color="#CCCCCC">seems through mechanism where they'll be</font>

505
00:19:02,830 --> 00:19:07,120
<font color="#CCCCCC">Canal regularly and I don't</font><font color="#E5E5E5"> have to like</font>

506
00:19:04,720 --> 00:19:09,520
do a cron job or something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> for</font>

507
00:19:07,120 --> 00:19:12,280
it and and that<font color="#CCCCCC"> way</font><font color="#E5E5E5"> you know you can't</font>

508
00:19:09,520 --> 00:19:16,870
ask things multiple agents you can<font color="#E5E5E5"> end a</font>

509
00:19:12,280 --> 00:19:19,120
<font color="#CCCCCC">little lot better and it's cool</font><font color="#E5E5E5"> yeah</font>

510
00:19:16,870 --> 00:19:21,428
exactly<font color="#E5E5E5"> yeah new parallel</font><font color="#CCCCCC"> I need that</font>

511
00:19:19,120 --> 00:19:25,449
<font color="#E5E5E5">and right now I've</font><font color="#CCCCCC"> been using like a</font>

512
00:19:21,429 --> 00:19:27,159
horrible mess of like<font color="#CCCCCC"> em I don't even</font>

513
00:19:25,450 --> 00:19:28,809
talk about<font color="#CCCCCC"> but it's it's like a so cat</font>

514
00:19:27,159 --> 00:19:30,130
netcat in conference mode to get like

515
00:19:28,809 --> 00:19:33,520
those<font color="#E5E5E5"> of clients talking to each other</font>

516
00:19:30,130 --> 00:19:35,409
and I want to include<font color="#E5E5E5"> more protocols as</font>

517
00:19:33,520 --> 00:19:37,480
well<font color="#E5E5E5"> than just</font><font color="#CCCCCC"> a encrypted</font><font color="#E5E5E5"> TCP because</font>

518
00:19:35,409 --> 00:19:39,580
that's kind of yeah I think<font color="#E5E5E5"> it's pretty</font>

519
00:19:37,480 --> 00:19:42,130
noticeable<font color="#E5E5E5"> if someone</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> Osaka comes</font>

520
00:19:39,580 --> 00:19:43,720
and looks around<font color="#E5E5E5"> um ideally I'd like</font><font color="#CCCCCC"> to</font>

521
00:19:42,130 --> 00:19:45,850
be able<font color="#E5E5E5"> to hide a standard SSL or</font><font color="#CCCCCC"> use</font>

522
00:19:43,720 --> 00:19:47,260
<font color="#CCCCCC">two Bs traffic and I mean the one</font>

523
00:19:45,850 --> 00:19:48,879
advantage<font color="#E5E5E5"> of doing a lot</font><font color="#CCCCCC"> of this stuff</font>

524
00:19:47,260 --> 00:19:51,220
on<font color="#E5E5E5"> Linux is not only is no one doing it</font>

525
00:19:48,880 --> 00:19:55,000
anyway but<font color="#E5E5E5"> also no one is looking</font><font color="#CCCCCC"> so</font>

526
00:19:51,220 --> 00:19:56,890
that's quite good<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> want to do</font>

527
00:19:55,000 --> 00:19:58,059
a little<font color="#E5E5E5"> bit of modification to make it</font>

528
00:19:56,890 --> 00:19:59,950
difficult to reverse<font color="#CCCCCC"> engineer the</font>

529
00:19:58,059 --> 00:20:00,550
binaries<font color="#CCCCCC"> so I've</font><font color="#E5E5E5"> been working on</font><font color="#CCCCCC"> that</font>

530
00:19:59,950 --> 00:20:02,110
and

531
00:20:00,550 --> 00:20:03,760
you basically<font color="#E5E5E5"> you know I've done the</font>

532
00:20:02,110 --> 00:20:06,850
simple things no debugging attachment

533
00:20:03,760 --> 00:20:08,590
<font color="#E5E5E5">stuff like that and but you can still</font>

534
00:20:06,850 --> 00:20:10,330
<font color="#E5E5E5">make the process cord out then you get</font>

535
00:20:08,590 --> 00:20:13,780
<font color="#E5E5E5">all the unencrypted strings out of that</font>

536
00:20:10,330 --> 00:20:15,550
<font color="#E5E5E5">so yeah that needs</font><font color="#CCCCCC"> a bit of work</font><font color="#E5E5E5"> but at</font>

537
00:20:13,780 --> 00:20:17,889
some<font color="#CCCCCC"> point I'm thinking I might</font><font color="#E5E5E5"> probably</font>

538
00:20:15,550 --> 00:20:20,649
reduce<font color="#E5E5E5"> I release this build chain thing</font>

539
00:20:17,890 --> 00:20:22,870
that I've<font color="#E5E5E5"> come up with and so that's</font>

540
00:20:20,650 --> 00:20:27,640
that's<font color="#E5E5E5"> sort of my my plan for making</font>

541
00:20:22,870 --> 00:20:29,560
agents<font color="#CCCCCC"> since</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> got about it</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> now</font>

542
00:20:27,640 --> 00:20:31,150
it's time for post exploitation<font color="#CCCCCC"> with a</font>

543
00:20:29,560 --> 00:20:34,750
picture of<font color="#CCCCCC"> forks</font><font color="#E5E5E5"> which will be relevant</font>

544
00:20:31,150 --> 00:20:37,720
in a minute and so I'm<font color="#E5E5E5"> not actually</font>

545
00:20:34,750 --> 00:20:39,700
<font color="#E5E5E5">really familiar with anything</font><font color="#CCCCCC"> on Linux</font>

546
00:20:37,720 --> 00:20:41,650
for like proper post exploitation with

547
00:20:39,700 --> 00:20:45,730
loads of functionality<font color="#E5E5E5"> there's loads of</font>

548
00:20:41,650 --> 00:20:46,960
stuff<font color="#E5E5E5"> on</font><font color="#CCCCCC"> windows and but on</font><font color="#E5E5E5"> Linux you</font>

549
00:20:45,730 --> 00:20:49,060
basically got<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Linux meterpreter</font>

550
00:20:46,960 --> 00:20:50,560
<font color="#E5E5E5">there's a couple of like paid frameworks</font>

551
00:20:49,060 --> 00:20:52,030
that<font color="#CCCCCC"> have their</font><font color="#E5E5E5"> own custom implants</font><font color="#CCCCCC"> of</font>

552
00:20:50,560 --> 00:20:54,220
post exploitation stuff so<font color="#E5E5E5"> this time</font>

553
00:20:52,030 --> 00:20:56,020
business I think<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to say</font><font color="#CCCCCC"> core</font>

554
00:20:54,220 --> 00:20:58,420
impact<font color="#CCCCCC"> is</font><font color="#E5E5E5"> something as well but I'm not</font>

555
00:20:56,020 --> 00:21:00,879
<font color="#E5E5E5">100% certain there's something called</font>

556
00:20:58,420 --> 00:21:02,170
I'm going to pronounce it as puppy but<font color="#E5E5E5"> I</font>

557
00:21:00,880 --> 00:21:04,210
have no idea<font color="#CCCCCC"> how</font><font color="#E5E5E5"> it's actually supposed</font>

558
00:21:02,170 --> 00:21:06,700
<font color="#E5E5E5">to be pronounced it does only have one p</font>

559
00:21:04,210 --> 00:21:08,110
and and they but they don't<font color="#CCCCCC"> really do</font>

560
00:21:06,700 --> 00:21:09,510
the kind of things<font color="#E5E5E5"> that I'm looking</font><font color="#CCCCCC"> for</font>

561
00:21:08,110 --> 00:21:14,760
I'm looking<font color="#E5E5E5"> for something that offers</font>

562
00:21:09,510 --> 00:21:17,080
something<font color="#E5E5E5"> relatively comparable to the</font>

563
00:21:14,760 --> 00:21:19,450
functionality in in my green spirit for

564
00:21:17,080 --> 00:21:21,550
example<font color="#E5E5E5"> except with less</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> calendar so</font>

565
00:21:19,450 --> 00:21:24,490
<font color="#CCCCCC">I've</font><font color="#E5E5E5"> started working</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> a tool that's</font>

566
00:21:21,550 --> 00:21:25,930
<font color="#CCCCCC">called orc</font><font color="#E5E5E5"> and and it's it's</font><font color="#CCCCCC"> really</font>

567
00:21:24,490 --> 00:21:27,490
<font color="#E5E5E5">quite a simple</font><font color="#CCCCCC"> idea but I needed</font>

568
00:21:25,930 --> 00:21:30,550
<font color="#CCCCCC">something for post exploitation on a job</font>

569
00:21:27,490 --> 00:21:33,220
I<font color="#E5E5E5"> was</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> and and he started as a</font>

570
00:21:30,550 --> 00:21:35,830
component that<font color="#E5E5E5"> was wrapped around SSH</font>

571
00:21:33,220 --> 00:21:37,090
and it was like a sort<font color="#E5E5E5"> of a hacking</font>

572
00:21:35,830 --> 00:21:38,560
harness essentially that would prevent

573
00:21:37,090 --> 00:21:40,300
<font color="#E5E5E5">me from doing things like logging in</font>

574
00:21:38,560 --> 00:21:42,639
without the<font color="#E5E5E5"> - key flag to stop</font>

575
00:21:40,300 --> 00:21:45,610
requesting<font color="#E5E5E5"> a</font><font color="#CCCCCC"> PTY and not appearing in</font>

576
00:21:42,640 --> 00:21:47,800
logs and but then once I did<font color="#CCCCCC"> that I</font>

577
00:21:45,610 --> 00:21:49,270
<font color="#E5E5E5">started thinking</font><font color="#CCCCCC"> that I was doing</font>

578
00:21:47,800 --> 00:21:51,850
someone's stuff<font color="#E5E5E5"> manually I needed</font>

579
00:21:49,270 --> 00:21:53,050
automate some of<font color="#E5E5E5"> it so I thought</font><font color="#CCCCCC"> about</font>

580
00:21:51,850 --> 00:21:55,000
<font color="#E5E5E5">it again for</font><font color="#CCCCCC"> bid I thought about</font>

581
00:21:53,050 --> 00:21:56,350
<font color="#E5E5E5">lighting a hacking harness</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> is not</font>

582
00:21:55,000 --> 00:21:57,880
<font color="#E5E5E5">familiar with the idea of a hacking</font>

583
00:21:56,350 --> 00:22:00,969
awareness it's essentially something

584
00:21:57,880 --> 00:22:02,710
<font color="#CCCCCC">that wraps around</font><font color="#E5E5E5"> any any any handling</font>

585
00:22:00,970 --> 00:22:04,930
of<font color="#CCCCCC"> River shells on your</font><font color="#E5E5E5"> Fox when they</font>

586
00:22:02,710 --> 00:22:07,530
come<font color="#E5E5E5"> back in and it'll automate certain</font>

587
00:22:04,930 --> 00:22:10,150
things<font color="#E5E5E5"> venue from</font><font color="#CCCCCC"> doing mistakes like</font>

588
00:22:07,530 --> 00:22:12,240
again creating like - tea or freeing<font color="#CCCCCC"> -</font>

589
00:22:10,150 --> 00:22:14,550
like white<font color="#E5E5E5"> logs and stuff like that</font>

590
00:22:12,240 --> 00:22:16,800
and I thought about<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> it on</font><font color="#CCCCCC"> you know</font>

591
00:22:14,550 --> 00:22:19,080
sort of the decline side if you<font color="#E5E5E5"> will but</font>

592
00:22:16,800 --> 00:22:21,560
then in the end<font color="#E5E5E5"> I decided I'd rather do</font>

593
00:22:19,080 --> 00:22:24,000
it<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> target side and and</font>

594
00:22:21,560 --> 00:22:26,340
essentially<font color="#E5E5E5"> it's it's a</font><font color="#CCCCCC"> custom RC file</font>

595
00:22:24,000 --> 00:22:27,810
that you know<font color="#E5E5E5"> that she'll and it does it</font>

596
00:22:26,340 --> 00:22:31,770
actually<font color="#E5E5E5"> has quite a few features at the</font>

597
00:22:27,810 --> 00:22:34,050
moment<font color="#E5E5E5"> so um it does the standard</font><font color="#CCCCCC"> stuff</font>

598
00:22:31,770 --> 00:22:37,770
<font color="#E5E5E5">so it</font><font color="#CCCCCC"> unset his file it</font><font color="#E5E5E5"> Han sets his</font>

599
00:22:34,050 --> 00:22:39,510
size and it reads itself and stores

600
00:22:37,770 --> 00:22:42,270
itself in an<font color="#E5E5E5"> environment variable and</font>

601
00:22:39,510 --> 00:22:44,360
then it shreds itself and just because I

602
00:22:42,270 --> 00:22:47,400
don't<font color="#CCCCCC"> want to leave</font><font color="#E5E5E5"> it lying around and</font>

603
00:22:44,360 --> 00:22:49,229
it will if you spawn you<font color="#CCCCCC"> my shell for</font>

604
00:22:47,400 --> 00:22:52,320
example it'll also<font color="#E5E5E5"> make sure that that</font>

605
00:22:49,230 --> 00:22:53,940
loads itself and it<font color="#E5E5E5"> does like time</font>

606
00:22:52,320 --> 00:22:55,919
stomach so<font color="#E5E5E5"> it'll it has a bunch of</font>

607
00:22:53,940 --> 00:22:58,950
aliases for<font color="#E5E5E5"> like a chain modifying times</font>

608
00:22:55,920 --> 00:23:01,380
and stuff on various ways<font color="#CCCCCC"> and makes it a</font>

609
00:22:58,950 --> 00:23:03,840
little<font color="#E5E5E5"> easier</font><font color="#CCCCCC"> to touch and it has log</font>

610
00:23:01,380 --> 00:23:07,140
editing functions which I'm gonna<font color="#E5E5E5"> be</font>

611
00:23:03,840 --> 00:23:10,050
honest<font color="#E5E5E5"> while they work I'm currently</font>

612
00:23:07,140 --> 00:23:11,820
using<font color="#CCCCCC"> u TMP dump</font><font color="#E5E5E5"> which is a</font><font color="#CCCCCC"> built-in</font>

613
00:23:10,050 --> 00:23:15,149
<font color="#CCCCCC">thing on Linux which will</font><font color="#E5E5E5"> just convert</font>

614
00:23:11,820 --> 00:23:16,439
like WT MP into<font color="#E5E5E5"> plain text</font><font color="#CCCCCC"> and then can</font>

615
00:23:15,150 --> 00:23:18,270
convert<font color="#CCCCCC"> in fact I'm just</font><font color="#E5E5E5"> prepping them</font>

616
00:23:16,440 --> 00:23:20,790
out<font color="#E5E5E5"> but one of the problems</font><font color="#CCCCCC"> with that</font><font color="#E5E5E5"> is</font>

617
00:23:18,270 --> 00:23:22,320
when you repack it<font color="#E5E5E5"> he's always a</font>

618
00:23:20,790 --> 00:23:25,860
different md5 a couple of<font color="#E5E5E5"> bytes are</font>

619
00:23:22,320 --> 00:23:27,240
always off and it's a real pain<font color="#E5E5E5"> and I</font>

620
00:23:25,860 --> 00:23:29,070
need to sort<font color="#CCCCCC"> of come</font><font color="#E5E5E5"> up with a better</font>

621
00:23:27,240 --> 00:23:31,530
thing<font color="#CCCCCC"> for that</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> for now you can't be</font>

622
00:23:29,070 --> 00:23:34,800
that works fine<font color="#E5E5E5"> and it is</font><font color="#CCCCCC"> aliases phones</font>

623
00:23:31,530 --> 00:23:36,990
<font color="#E5E5E5">you</font><font color="#CCCCCC"> like the usual things like PS</font><font color="#E5E5E5"> pops</font>

624
00:23:34,800 --> 00:23:38,790
and all that and one<font color="#E5E5E5"> of the other</font>

625
00:23:36,990 --> 00:23:40,620
functionalities it has it can<font color="#CCCCCC"> drop</font><font color="#E5E5E5"> a</font>

626
00:23:38,790 --> 00:23:42,600
tiny<font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> written in assembly that</font>

627
00:23:40,620 --> 00:23:45,780
you can just set<font color="#CCCCCC"> UID to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> rude again</font>

628
00:23:42,600 --> 00:23:47,669
if you<font color="#E5E5E5"> need to or whatever um</font><font color="#CCCCCC"> pdy</font>

629
00:23:45,780 --> 00:23:49,020
spawning it uses either<font color="#E5E5E5"> the python thing</font>

630
00:23:47,670 --> 00:23:50,730
or there's another<font color="#E5E5E5"> thing that you can</font>

631
00:23:49,020 --> 00:23:53,220
<font color="#CCCCCC">use if the boxes in python</font><font color="#E5E5E5"> which happens</font>

632
00:23:50,730 --> 00:23:56,100
and there's a binary called<font color="#CCCCCC"> scripts is</font>

633
00:23:53,220 --> 00:23:58,380
anyone familiar with<font color="#E5E5E5"> it it's it was</font>

634
00:23:56,100 --> 00:23:59,879
originally written to<font color="#E5E5E5"> like record your</font>

635
00:23:58,380 --> 00:24:01,140
screen sessions on<font color="#CCCCCC"> linux so you could</font>

636
00:23:59,880 --> 00:24:05,970
report<font color="#E5E5E5"> like how your terminal went and</font>

637
00:24:01,140 --> 00:24:07,770
and for some reason now it does this by

638
00:24:05,970 --> 00:24:09,150
<font color="#CCCCCC">actually spawning a brand new pdy so if</font>

639
00:24:07,770 --> 00:24:10,680
<font color="#E5E5E5">you're on a box that doesn't have a</font><font color="#CCCCCC"> pdy</font>

640
00:24:09,150 --> 00:24:13,050
and you need<font color="#CCCCCC"> one you</font><font color="#E5E5E5"> can just run strip</font>

641
00:24:10,680 --> 00:24:15,330
<font color="#CCCCCC">I'm Deb null and you'll you'll pop a bdy</font>

642
00:24:13,050 --> 00:24:19,200
<font color="#E5E5E5">with the native</font><font color="#CCCCCC"> standard linux - looks</font>

643
00:24:15,330 --> 00:24:21,990
<font color="#E5E5E5">great and also launching sudo su</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> ssh</font>

644
00:24:19,200 --> 00:24:23,610
without using a PD<font color="#CCCCCC"> Y is pretty</font><font color="#E5E5E5"> handy too</font>

645
00:24:21,990 --> 00:24:24,780
<font color="#E5E5E5">because if you do spawn one you're going</font>

646
00:24:23,610 --> 00:24:28,229
<font color="#E5E5E5">to be in a log summer left</font><font color="#CCCCCC"> up</font>

647
00:24:24,780 --> 00:24:29,910
<font color="#CCCCCC">boy were saying py spawn and you can use</font>

648
00:24:28,230 --> 00:24:31,950
as<font color="#E5E5E5"> it sits this isn't very complicated</font>

649
00:24:29,910 --> 00:24:33,740
<font color="#E5E5E5">it basically just</font><font color="#CCCCCC"> does</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> S</font><font color="#E5E5E5"> pass it</font>

650
00:24:31,950 --> 00:24:35,910
drops a little<font color="#E5E5E5"> tiny</font><font color="#CCCCCC"> past scripts and</font>

651
00:24:33,740 --> 00:24:38,280
<font color="#E5E5E5">with the</font><font color="#CCCCCC"> password</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you specify</font><font color="#E5E5E5"> at</font>

652
00:24:35,910 --> 00:24:41,580
<font color="#CCCCCC">launch a new shell at</font><font color="#E5E5E5"> that or it'll</font>

653
00:24:38,280 --> 00:24:43,200
launch SSH or whatever<font color="#E5E5E5"> and I've also got</font>

654
00:24:41,580 --> 00:24:45,710
something<font color="#E5E5E5"> that essentially goes through</font>

655
00:24:43,200 --> 00:24:48,750
all of the<font color="#CCCCCC"> PDS is in deputy</font><font color="#E5E5E5"> PDS and</font>

656
00:24:45,710 --> 00:24:50,730
it'll stack them and<font color="#E5E5E5"> it'll get the idle</font>

657
00:24:48,750 --> 00:24:52,770
time<font color="#CCCCCC"> and link what</font><font color="#E5E5E5"> there's like the I</font>

658
00:24:50,730 --> 00:24:54,300
<font color="#E5E5E5">found down to the seconds and</font><font color="#CCCCCC"> link what</font>

659
00:24:52,770 --> 00:24:56,190
<font color="#CCCCCC">they're pdy is currently</font><font color="#E5E5E5"> doing which</font><font color="#CCCCCC"> is</font>

660
00:24:54,300 --> 00:24:57,510
really<font color="#E5E5E5"> really helpful</font><font color="#CCCCCC"> I find if</font><font color="#E5E5E5"> you're</font>

661
00:24:56,190 --> 00:24:59,400
on a box with someone actively<font color="#E5E5E5"> on it</font>

662
00:24:57,510 --> 00:25:01,530
like W is almost useless<font color="#E5E5E5"> because</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> you</font>

663
00:24:59,400 --> 00:25:02,670
<font color="#E5E5E5">see someone</font><font color="#CCCCCC"> like bash and then the idle</font>

664
00:25:01,530 --> 00:25:04,850
time it's gonna be completely<font color="#E5E5E5"> wrong</font>

665
00:25:02,670 --> 00:25:09,000
<font color="#E5E5E5">whereas this is a bit more effective</font><font color="#CCCCCC"> and</font>

666
00:25:04,850 --> 00:25:09,389
I'm probably going to<font color="#E5E5E5"> release this next</font>

667
00:25:09,000 --> 00:25:11,900
<font color="#E5E5E5">month</font>

668
00:25:09,390 --> 00:25:14,640
once I add a couple<font color="#CCCCCC"> more features</font><font color="#E5E5E5"> and</font>

669
00:25:11,900 --> 00:25:16,290
once I<font color="#E5E5E5"> think I'm gonna finish the actual</font>

670
00:25:14,640 --> 00:25:18,330
like<font color="#E5E5E5"> SSH</font><font color="#CCCCCC"> artists that I was using maybe</font>

671
00:25:16,290 --> 00:25:20,250
<font color="#CCCCCC">get to work better with the sort of</font>

672
00:25:18,330 --> 00:25:21,720
standard netcat handlers and I'm not a

673
00:25:20,250 --> 00:25:22,890
big<font color="#E5E5E5"> fan of releasing code so you're</font>

674
00:25:21,720 --> 00:25:26,550
gonna have to keep poking me on Twitter

675
00:25:22,890 --> 00:25:28,590
for this but<font color="#CCCCCC"> do that</font><font color="#E5E5E5"> and and credited to</font>

676
00:25:26,550 --> 00:25:29,760
grukk who's not here he's somewhere in

677
00:25:28,590 --> 00:25:31,980
Thailand probably living<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the dream</font>

678
00:25:29,760 --> 00:25:35,400
and for<font color="#E5E5E5"> inspiring it with his hash tool</font>

679
00:25:31,980 --> 00:25:37,440
which was the sort of<font color="#E5E5E5"> original hacking</font>

680
00:25:35,400 --> 00:25:40,140
harness and that<font color="#E5E5E5"> look be wrapped around</font>

681
00:25:37,440 --> 00:25:42,840
your<font color="#CCCCCC"> your evil shell and and also a</font>

682
00:25:40,140 --> 00:25:44,940
quick<font color="#E5E5E5"> aside as</font><font color="#CCCCCC"> well just to advertise</font>

683
00:25:42,840 --> 00:25:46,709
<font color="#E5E5E5">something I wrote myself again and I</font>

684
00:25:44,940 --> 00:25:48,660
also wrote a tool at the same time that

685
00:25:46,710 --> 00:25:50,820
basically does some checks for these

686
00:25:48,660 --> 00:25:52,740
kinds of<font color="#CCCCCC"> things</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> for like malware and</font>

687
00:25:50,820 --> 00:25:54,330
so on<font color="#CCCCCC"> boxes and you can find in my</font>

688
00:25:52,740 --> 00:25:55,710
<font color="#E5E5E5">github it's called suspect and he will</font>

689
00:25:54,330 --> 00:25:59,580
<font color="#CCCCCC">only one in</font><font color="#E5E5E5"> fedora at the moment</font>

690
00:25:55,710 --> 00:26:01,320
pretty much<font color="#CCCCCC"> and but it won't take too</font>

691
00:25:59,580 --> 00:26:06,330
<font color="#E5E5E5">much to modify</font><font color="#CCCCCC"> it's just certain</font><font color="#E5E5E5"> like</font>

692
00:26:01,320 --> 00:26:07,770
<font color="#CCCCCC">550 si fedora specific and I kind of</font>

693
00:26:06,330 --> 00:26:09,360
want to<font color="#E5E5E5"> keep developing this at the same</font>

694
00:26:07,770 --> 00:26:13,560
time it's developing the stuff that I'm

695
00:26:09,360 --> 00:26:15,000
doing<font color="#E5E5E5"> making this</font><font color="#CCCCCC"> total</font><font color="#E5E5E5"> kit</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> because</font>

696
00:26:13,560 --> 00:26:17,070
it's nice to<font color="#CCCCCC"> have a defensive</font><font color="#E5E5E5"> things as</font>

697
00:26:15,000 --> 00:26:20,040
well<font color="#CCCCCC"> and and yeah this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just</font>

698
00:26:17,070 --> 00:26:21,750
essentially I want to avoid<font color="#E5E5E5"> md5 in a</font>

699
00:26:20,040 --> 00:26:23,760
bunch<font color="#CCCCCC"> of files I got a hundred does or</font>

700
00:26:21,750 --> 00:26:25,770
whatever or looking<font color="#E5E5E5"> for very specific</font>

701
00:26:23,760 --> 00:26:27,930
<font color="#E5E5E5">files from our because</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of time</font>

702
00:26:25,770 --> 00:26:29,970
<font color="#CCCCCC">it's auto-generated now that you'll find</font>

703
00:26:27,930 --> 00:26:31,650
like Chinese DDoS<font color="#CCCCCC"> BOTS or randomly</font>

704
00:26:29,970 --> 00:26:35,220
<font color="#E5E5E5">naming themselves and living in various</font>

705
00:26:31,650 --> 00:26:36,720
different directories and so I guess we

706
00:26:35,220 --> 00:26:38,370
<font color="#CCCCCC">are we're</font><font color="#E5E5E5"> finally on to</font><font color="#CCCCCC"> just the</font>

707
00:26:36,720 --> 00:26:40,410
interesting discoveries and the

708
00:26:38,370 --> 00:26:42,090
sort of miscellaneous<font color="#CCCCCC"> things</font><font color="#E5E5E5"> that I've</font>

709
00:26:40,410 --> 00:26:44,190
explored one of the things that I've

710
00:26:42,090 --> 00:26:46,199
<font color="#CCCCCC">found is that once you start writing</font>

711
00:26:44,190 --> 00:26:48,960
terrible<font color="#CCCCCC"> bash and you try</font><font color="#E5E5E5"> to decide you</font>

712
00:26:46,200 --> 00:26:51,150
know what<font color="#E5E5E5"> can I get</font><font color="#CCCCCC"> bash to do you find</font>

713
00:26:48,960 --> 00:26:53,070
out that<font color="#CCCCCC"> eighties amazingly feature</font>

714
00:26:51,150 --> 00:26:55,140
<font color="#CCCCCC">'full and great and there's like a</font>

715
00:26:53,070 --> 00:26:57,360
thousand<font color="#E5E5E5"> things you can like</font><font color="#CCCCCC"> just abuse</font>

716
00:26:55,140 --> 00:26:59,700
and exploit on<font color="#E5E5E5"> Linux really</font><font color="#CCCCCC"> weird things</font>

717
00:26:57,360 --> 00:27:01,860
<font color="#E5E5E5">so LD preload I talked about here two</font>

718
00:26:59,700 --> 00:27:03,660
<font color="#CCCCCC">years ago and that's originally like</font>

719
00:27:01,860 --> 00:27:06,030
this debugging feature that allows you

720
00:27:03,660 --> 00:27:07,890
to force my program<font color="#E5E5E5"> to load a library</font>

721
00:27:06,030 --> 00:27:10,170
and way up<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> top of</font><font color="#CCCCCC"> the chain so</font>

722
00:27:07,890 --> 00:27:12,809
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use this to like hook functions</font>

723
00:27:10,170 --> 00:27:16,290
and so on and and<font color="#E5E5E5"> when I was doing this</font>

724
00:27:12,809 --> 00:27:18,090
research<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> clown</font><font color="#E5E5E5"> this that was</font>

725
00:27:16,290 --> 00:27:20,629
doing the rounds at the time and I<font color="#E5E5E5"> was</font>

726
00:27:18,090 --> 00:27:23,250
using constructors and destructors<font color="#CCCCCC"> to</font>

727
00:27:20,630 --> 00:27:26,510
create a new persistence mechanism and

728
00:27:23,250 --> 00:27:29,040
but one<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> problems with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> loss I</font>

729
00:27:26,510 --> 00:27:30,570
realized that once you find<font color="#CCCCCC"> this because</font>

730
00:27:29,040 --> 00:27:31,980
it also because it<font color="#E5E5E5"> lives on disk but</font>

731
00:27:30,570 --> 00:27:34,678
also because it's so persistent once you

732
00:27:31,980 --> 00:27:36,090
find this if someone<font color="#E5E5E5"> is going to find it</font>

733
00:27:34,679 --> 00:27:37,290
<font color="#E5E5E5">like say on a client engagement</font><font color="#CCCCCC"> they're</font>

734
00:27:36,090 --> 00:27:38,820
not<font color="#E5E5E5"> gonna be able to remove it very</font><font color="#CCCCCC"> easy</font>

735
00:27:37,290 --> 00:27:40,440
and<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> just going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> ignore it</font>

736
00:27:38,820 --> 00:27:41,700
<font color="#CCCCCC">and go</font><font color="#E5E5E5"> away that is</font><font color="#CCCCCC"> the box basically</font>

737
00:27:40,440 --> 00:27:42,929
<font color="#E5E5E5">burnt down they're gonna pull out the</font>

738
00:27:41,700 --> 00:27:44,340
hard drive they're gonna<font color="#E5E5E5"> thermite it</font>

739
00:27:42,929 --> 00:27:47,340
then they're gonna call you and be like

740
00:27:44,340 --> 00:27:48,870
<font color="#E5E5E5">we know you're there and so I decided</font>

741
00:27:47,340 --> 00:27:51,439
that<font color="#E5E5E5"> he wasn't really gonna work out</font>

742
00:27:48,870 --> 00:27:54,149
that way<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> is why I decided</font><font color="#CCCCCC"> to</font>

743
00:27:51,440 --> 00:27:57,210
basically<font color="#E5E5E5"> build this tool</font><font color="#CCCCCC"> cater which is</font>

744
00:27:54,150 --> 00:27:58,530
a little bit different and<font color="#CCCCCC"> so I don't</font>

745
00:27:57,210 --> 00:27:59,850
<font color="#E5E5E5">really recommend</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> persistence for</font>

746
00:27:58,530 --> 00:28:01,379
precisely this reason the<font color="#E5E5E5"> more you touch</font>

747
00:27:59,850 --> 00:28:04,230
this the more likely you are<font color="#CCCCCC"> going to be</font>

748
00:28:01,380 --> 00:28:06,240
found with someone and and people

749
00:28:04,230 --> 00:28:08,250
recursively will do a fine than the file

750
00:28:06,240 --> 00:28:10,320
system all the<font color="#E5E5E5"> time</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> you're trying</font>

751
00:28:08,250 --> 00:28:11,760
<font color="#E5E5E5">to find under your</font><font color="#CCCCCC"> PowerPoint from a</font>

752
00:28:10,320 --> 00:28:13,350
<font color="#E5E5E5">couple years ago and you're like what's</font>

753
00:28:11,760 --> 00:28:14,340
older than two weeks and<font color="#E5E5E5"> you'll go</font>

754
00:28:13,350 --> 00:28:17,219
through<font color="#E5E5E5"> it all and</font><font color="#CCCCCC"> you'll eventually</font>

755
00:28:14,340 --> 00:28:20,459
<font color="#E5E5E5">like someone will find your</font><font color="#CCCCCC"> mal we're</font>

756
00:28:17,220 --> 00:28:22,290
living in<font color="#CCCCCC"> rtmp and people are also using</font>

757
00:28:20,460 --> 00:28:25,620
really predictable<font color="#E5E5E5"> things so you'll have</font>

758
00:28:22,290 --> 00:28:27,389
<font color="#E5E5E5">like</font><font color="#CCCCCC"> Doc config auto</font><font color="#E5E5E5"> start and people's</font>

759
00:28:25,620 --> 00:28:29,280
home directory was used by the hacking

760
00:28:27,390 --> 00:28:33,000
team Linux malware and I think it's used

761
00:28:29,280 --> 00:28:35,220
by some of<font color="#E5E5E5"> the the Penguins are the guys</font>

762
00:28:33,000 --> 00:28:36,690
as well<font color="#E5E5E5"> it's it's all very predictable</font>

763
00:28:35,220 --> 00:28:38,190
it's all<font color="#CCCCCC"> very common it's obvious if</font>

764
00:28:36,690 --> 00:28:40,890
someone is doing<font color="#E5E5E5"> some IR and your box</font>

765
00:28:38,190 --> 00:28:43,170
they'll find<font color="#E5E5E5"> that and also cron</font><font color="#CCCCCC"> every</font>

766
00:28:40,890 --> 00:28:45,000
bit of malware that's scheduled to rerun

767
00:28:43,170 --> 00:28:47,490
is always<font color="#CCCCCC"> gonna be</font><font color="#E5E5E5"> strong but there are</font>

768
00:28:45,000 --> 00:28:49,290
other things you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> use so for example</font>

769
00:28:47,490 --> 00:28:51,870
is anyone here familiar with<font color="#E5E5E5"> d-bus it's</font>

770
00:28:49,290 --> 00:28:53,850
the<font color="#CCCCCC"> IPC forelimbs</font>

771
00:28:51,870 --> 00:28:56,789
<font color="#E5E5E5">oh hey so we'll put up their hand and</font>

772
00:28:53,850 --> 00:28:58,590
but<font color="#E5E5E5"> d-bus has</font><font color="#CCCCCC"> d-bus services and they're</font>

773
00:28:56,789 --> 00:29:02,370
just desktop files that live in<font color="#CCCCCC"> addy</font><font color="#E5E5E5"> bus</font>

774
00:28:58,590 --> 00:29:04,529
<font color="#E5E5E5">directories and you can you can</font>

775
00:29:02,370 --> 00:29:07,668
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> D bus a lot of start this and</font>

776
00:29:04,529 --> 00:29:10,830
that lives in that<font color="#E5E5E5"> exact path there and</font>

777
00:29:07,669 --> 00:29:13,140
they're pretty useful<font color="#CCCCCC"> assistance because</font>

778
00:29:10,830 --> 00:29:14,580
<font color="#E5E5E5">you can start your body</font><font color="#CCCCCC"> if the deepest</font>

779
00:29:13,140 --> 00:29:16,080
<font color="#CCCCCC">same commands</font><font color="#E5E5E5"> or if you want to get</font>

780
00:29:14,580 --> 00:29:17,879
<font color="#CCCCCC">complicated you can start using them</font><font color="#E5E5E5"> for</font>

781
00:29:16,080 --> 00:29:19,889
IBC so you can use<font color="#E5E5E5"> D bus to actually</font>

782
00:29:17,880 --> 00:29:21,059
send messages between<font color="#E5E5E5"> things launch</font>

783
00:29:19,890 --> 00:29:23,850
different things have different

784
00:29:21,059 --> 00:29:27,330
<font color="#CCCCCC">components working that way and which</font><font color="#E5E5E5"> is</font>

785
00:29:23,850 --> 00:29:29,100
which is<font color="#CCCCCC"> good and but you're still using</font>

786
00:29:27,330 --> 00:29:31,320
D bus which is<font color="#E5E5E5"> horrible so maybe not</font><font color="#CCCCCC"> and</font>

787
00:29:29,100 --> 00:29:33,629
you've also<font color="#E5E5E5"> got system D which is even</font>

788
00:29:31,320 --> 00:29:35,460
<font color="#CCCCCC">worse in general</font><font color="#E5E5E5"> and in its hurry to</font>

789
00:29:33,630 --> 00:29:36,899
devour<font color="#E5E5E5"> the whole known universe it's got</font>

790
00:29:35,460 --> 00:29:38,520
a load of functionality at the moment

791
00:29:36,899 --> 00:29:40,529
<font color="#E5E5E5">including</font><font color="#CCCCCC"> a complete cron and at</font>

792
00:29:38,520 --> 00:29:42,299
replacement<font color="#E5E5E5"> in your init system and I</font>

793
00:29:40,529 --> 00:29:45,299
don't<font color="#CCCCCC"> know why it has that but it does</font>

794
00:29:42,299 --> 00:29:47,399
and so it has these things<font color="#E5E5E5"> called timers</font>

795
00:29:45,299 --> 00:29:49,529
which function exactly<font color="#E5E5E5"> like</font><font color="#CCCCCC"> prom</font><font color="#E5E5E5"> or they</font>

796
00:29:47,399 --> 00:29:51,389
can<font color="#E5E5E5"> function like</font><font color="#CCCCCC"> that they can</font><font color="#E5E5E5"> be just</font>

797
00:29:49,529 --> 00:29:53,669
<font color="#E5E5E5">single-use tasks or they can repeatedly</font>

798
00:29:51,390 --> 00:29:55,399
run at its time or they can you<font color="#E5E5E5"> can</font>

799
00:29:53,669 --> 00:29:57,179
basically use it<font color="#E5E5E5"> exactly</font><font color="#CCCCCC"> like cron</font><font color="#E5E5E5"> and</font>

800
00:29:55,399 --> 00:29:59,520
unfortunately<font color="#E5E5E5"> the one thing that I find</font>

801
00:29:57,179 --> 00:30:01,500
<font color="#E5E5E5">about this is you need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> create two</font>

802
00:29:59,520 --> 00:30:02,549
different files for these and it also

803
00:30:01,500 --> 00:30:04,860
means that<font color="#E5E5E5"> you're doing a lot of</font>

804
00:30:02,549 --> 00:30:07,139
systemctl stuff so if there<font color="#CCCCCC"> is anything</font>

805
00:30:04,860 --> 00:30:09,510
I'm logging there and you're gonna<font color="#E5E5E5"> be</font>

806
00:30:07,140 --> 00:30:15,000
<font color="#E5E5E5">all over the place and so it's not</font>

807
00:30:09,510 --> 00:30:17,549
<font color="#E5E5E5">really great and there</font><font color="#CCCCCC"> are other various</font>

808
00:30:15,000 --> 00:30:19,590
<font color="#E5E5E5">little little-known miscellaneous</font>

809
00:30:17,549 --> 00:30:22,799
persistence methods as well<font color="#E5E5E5"> so it's sort</font>

810
00:30:19,590 --> 00:30:24,959
of a<font color="#CCCCCC"> proc mile</font><font color="#E5E5E5"> RC and proc mile is a is</font>

811
00:30:22,799 --> 00:30:27,179
a male thing that comes with<font color="#CCCCCC"> DB and it's</font>

812
00:30:24,960 --> 00:30:28,710
pretty<font color="#E5E5E5"> popular and probably</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> really</font>

813
00:30:27,179 --> 00:30:30,870
distress to be honest<font color="#E5E5E5"> with you but at</font>

814
00:30:28,710 --> 00:30:32,909
the proc male RC file that you<font color="#E5E5E5"> can put</font>

815
00:30:30,870 --> 00:30:34,379
in<font color="#E5E5E5"> etc can allow you with a certain</font>

816
00:30:32,909 --> 00:30:36,840
configuration<font color="#E5E5E5"> which you can find</font><font color="#CCCCCC"> in the</font>

817
00:30:34,380 --> 00:30:38,399
<font color="#CCCCCC">main page the</font><font color="#E5E5E5"> third thing to</font><font color="#CCCCCC"> arbitrarily</font>

818
00:30:36,840 --> 00:30:39,959
get code exec based on just sending

819
00:30:38,399 --> 00:30:42,139
emails to<font color="#CCCCCC"> a specific user in the server</font>

820
00:30:39,960 --> 00:30:44,460
and it will run it as their privileges

821
00:30:42,140 --> 00:30:47,159
<font color="#CCCCCC">which is really helpful I've used it on</font>

822
00:30:44,460 --> 00:30:48,570
jobs like to group things<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can</font>

823
00:30:47,159 --> 00:30:50,940
also do a really small LD preload

824
00:30:48,570 --> 00:30:53,010
wrapper around and you could stick<font color="#E5E5E5"> it in</font>

825
00:30:50,940 --> 00:30:55,649
something<font color="#E5E5E5"> like an SSH</font><font color="#CCCCCC"> key service file</font>

826
00:30:53,010 --> 00:30:56,940
to load every time sshd runs the forks

827
00:30:55,649 --> 00:30:58,439
<font color="#E5E5E5">and execute the process so they're using</font>

828
00:30:56,940 --> 00:31:01,530
constructor<font color="#CCCCCC"> or just</font><font color="#E5E5E5"> hooking something</font>

829
00:30:58,440 --> 00:31:02,549
<font color="#E5E5E5">and you can use bash RC</font><font color="#CCCCCC"> and one of the</font>

830
00:31:01,530 --> 00:31:04,799
things<font color="#E5E5E5"> I found is that there is a</font>

831
00:31:02,549 --> 00:31:05,610
surprising<font color="#CCCCCC"> amount of files</font><font color="#E5E5E5"> on like any</font>

832
00:31:04,799 --> 00:31:07,080
Linux<font color="#E5E5E5"> system</font>

833
00:31:05,610 --> 00:31:11,699
just essentially get executed by

834
00:31:07,080 --> 00:31:15,178
<font color="#E5E5E5">something at some point yeah there's</font>

835
00:31:11,700 --> 00:31:17,429
<font color="#CCCCCC">export as well</font><font color="#E5E5E5"> so um this there's all</font>

836
00:31:15,179 --> 00:31:19,590
the usual ways<font color="#E5E5E5"> of</font><font color="#CCCCCC"> exfil</font><font color="#E5E5E5"> you can post</font>

837
00:31:17,429 --> 00:31:22,230
data out you can<font color="#E5E5E5"> use HTTPS and</font><font color="#CCCCCC"> you curl</font>

838
00:31:19,590 --> 00:31:24,090
<font color="#CCCCCC">use DNS</font><font color="#E5E5E5"> I mean there's</font><font color="#CCCCCC"> those tools</font><font color="#E5E5E5"> that</font>

839
00:31:22,230 --> 00:31:25,380
do this by default<font color="#CCCCCC"> you can do this with</font>

840
00:31:24,090 --> 00:31:26,939
<font color="#E5E5E5">DES you can do this with</font><font color="#CCCCCC"> it</font>

841
00:31:25,380 --> 00:31:29,010
there's nothing fantastically new in

842
00:31:26,940 --> 00:31:30,090
this bit and again I'm not<font color="#E5E5E5"> doing</font>

843
00:31:29,010 --> 00:31:31,770
anything groundbreaking<font color="#E5E5E5"> but one thing</font>

844
00:31:30,090 --> 00:31:34,049
I've been playing with<font color="#E5E5E5"> is using system</font><font color="#CCCCCC"> v</font>

845
00:31:31,770 --> 00:31:37,379
message queues for storing stuff that I

846
00:31:34,049 --> 00:31:39,840
want to export rate later<font color="#E5E5E5"> and I have</font>

847
00:31:37,380 --> 00:31:42,780
been looking for where this stuff is

848
00:31:39,840 --> 00:31:44,909
<font color="#E5E5E5">stored on a Linux machine and I cannot</font>

849
00:31:42,780 --> 00:31:47,850
see it I've<font color="#CCCCCC"> done many many recursive</font>

850
00:31:44,910 --> 00:31:49,380
<font color="#CCCCCC">greps</font><font color="#E5E5E5"> so I feel like</font><font color="#CCCCCC"> I hope</font><font color="#E5E5E5"> like it's</font>

851
00:31:47,850 --> 00:31:50,580
just<font color="#E5E5E5"> living totally in memory I'm sure</font>

852
00:31:49,380 --> 00:31:53,460
it is<font color="#E5E5E5"> living somewhere in some weird</font>

853
00:31:50,580 --> 00:31:55,290
<font color="#CCCCCC">formats</font><font color="#E5E5E5"> but it's not easy to grab it</font><font color="#CCCCCC"> so</font>

854
00:31:53,460 --> 00:31:57,120
if you're<font color="#E5E5E5"> like saving like clear text</font>

855
00:31:55,290 --> 00:31:58,980
passwords it's you<font color="#E5E5E5"> won't find</font><font color="#CCCCCC"> just</font>

856
00:31:57,120 --> 00:32:00,360
really convenient<font color="#E5E5E5"> and one of the other</font>

857
00:31:58,980 --> 00:32:02,549
things is convenient<font color="#E5E5E5"> is you can</font><font color="#CCCCCC"> actually</font>

858
00:32:00,360 --> 00:32:04,678
<font color="#E5E5E5">get an example client from</font><font color="#CCCCCC"> mind</font><font color="#E5E5E5"> pages on</font>

859
00:32:02,549 --> 00:32:06,570
any box<font color="#CCCCCC"> a temporal bun to you can</font>

860
00:32:04,679 --> 00:32:09,780
compile<font color="#CCCCCC"> it dynamically</font><font color="#E5E5E5"> from a CD with</font>

861
00:32:06,570 --> 00:32:11,700
<font color="#CCCCCC">SPD in with GCC and you can just</font><font color="#E5E5E5"> you</font>

862
00:32:09,780 --> 00:32:13,290
said to alter<font color="#E5E5E5"> any of the code to you</font>

863
00:32:11,700 --> 00:32:15,179
know so it's got like this<font color="#E5E5E5"> example code</font>

864
00:32:13,290 --> 00:32:16,710
<font color="#E5E5E5">will just send a message you</font><font color="#CCCCCC"> can just</font>

865
00:32:15,179 --> 00:32:18,480
<font color="#CCCCCC">set that out and make it so you</font><font color="#E5E5E5"> can send</font>

866
00:32:16,710 --> 00:32:20,730
whatever<font color="#E5E5E5"> and if something</font><font color="#CCCCCC"> I'm thinking</font>

867
00:32:18,480 --> 00:32:22,830
<font color="#CCCCCC">about including</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> org essentially is</font>

868
00:32:20,730 --> 00:32:24,809
the idea<font color="#CCCCCC"> to quickly drop a message cube</font>

869
00:32:22,830 --> 00:32:27,689
client<font color="#E5E5E5"> that you can store stuff for</font>

870
00:32:24,809 --> 00:32:33,168
later<font color="#CCCCCC"> exfiltration and with a single</font>

871
00:32:27,690 --> 00:32:35,970
<font color="#CCCCCC">command and speaking of</font><font color="#E5E5E5"> executing things</font>

872
00:32:33,169 --> 00:32:37,679
so one of the things<font color="#CCCCCC"> I've also</font><font color="#E5E5E5"> been</font>

873
00:32:35,970 --> 00:32:38,850
playing<font color="#E5E5E5"> with this pipes on Linux so make</font>

874
00:32:37,679 --> 00:32:41,429
fire phone which will<font color="#E5E5E5"> allow you to</font>

875
00:32:38,850 --> 00:32:43,199
<font color="#CCCCCC">create a</font><font color="#E5E5E5"> sent by directional pipe and I</font>

876
00:32:41,429 --> 00:32:44,220
was thinking<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was hoping originally</font>

877
00:32:43,200 --> 00:32:46,410
<font color="#E5E5E5">that you could actually use that to</font>

878
00:32:44,220 --> 00:32:48,179
achieve binaries and just you know

879
00:32:46,410 --> 00:32:50,280
temporarily drop them<font color="#E5E5E5"> run them once and</font>

880
00:32:48,179 --> 00:32:52,530
<font color="#E5E5E5">that's it unfortunately you can't but</font>

881
00:32:50,280 --> 00:32:54,240
you<font color="#E5E5E5"> can drop a bash script in there and</font>

882
00:32:52,530 --> 00:32:55,559
just execute<font color="#E5E5E5"> essentially creating one</font>

883
00:32:54,240 --> 00:32:57,929
use<font color="#CCCCCC"> batch script that you can't read</font>

884
00:32:55,559 --> 00:32:59,820
again<font color="#CCCCCC"> and it's a little</font><font color="#E5E5E5"> harder to find</font>

885
00:32:57,929 --> 00:33:01,860
<font color="#CCCCCC">and do forensics</font><font color="#E5E5E5"> on than just running</font>

886
00:32:59,820 --> 00:33:04,678
something<font color="#E5E5E5"> from like a TMP heckard SH and</font>

887
00:33:01,860 --> 00:33:07,979
and it's actually how<font color="#E5E5E5"> works will drop</font>

888
00:33:04,679 --> 00:33:11,490
itself<font color="#E5E5E5"> in when it runs like</font><font color="#CCCCCC"> anybody</font>

889
00:33:07,980 --> 00:33:13,710
Forks off and runs a new shell<font color="#E5E5E5"> and yeah</font>

890
00:33:11,490 --> 00:33:16,110
it's it's pretty useful<font color="#CCCCCC"> it's it's a bit</font>

891
00:33:13,710 --> 00:33:18,510
of a pain but<font color="#E5E5E5"> yeah that's cool and I've</font>

892
00:33:16,110 --> 00:33:19,309
also been playing around with<font color="#E5E5E5"> the</font>

893
00:33:18,510 --> 00:33:24,350
dynamic linker

894
00:33:19,309 --> 00:33:26,389
<font color="#E5E5E5">loader um so this is so it's normally</font>

895
00:33:24,350 --> 00:33:28,820
<font color="#CCCCCC">like a in live</font><font color="#E5E5E5"> and live and it's how the</font>

896
00:33:26,389 --> 00:33:30,740
<font color="#CCCCCC">kernel will dynamically link things</font><font color="#E5E5E5"> to</font>

897
00:33:28,820 --> 00:33:32,689
libraries<font color="#E5E5E5"> and if your programs</font>

898
00:33:30,740 --> 00:33:36,830
dynamically compiled<font color="#E5E5E5"> it'll specify what</font>

899
00:33:32,690 --> 00:33:38,330
the loader<font color="#E5E5E5"> is in elf section that will</font>

900
00:33:36,830 --> 00:33:39,980
<font color="#E5E5E5">handle all</font><font color="#CCCCCC"> of the libraries and</font><font color="#E5E5E5"> whatever</font>

901
00:33:38,330 --> 00:33:42,049
<font color="#CCCCCC">and normally</font><font color="#E5E5E5"> we'll just want it straight</font>

902
00:33:39,980 --> 00:33:43,970
line you run ID or<font color="#E5E5E5"> whatever but you can</font>

903
00:33:42,049 --> 00:33:45,408
actually specifically set this to

904
00:33:43,970 --> 00:33:47,059
interpret it<font color="#CCCCCC"> and run the binder itself</font>

905
00:33:45,409 --> 00:33:48,710
and one of the<font color="#E5E5E5"> really great things</font><font color="#CCCCCC"> about</font>

906
00:33:47,059 --> 00:33:51,529
this<font color="#E5E5E5"> is if you're trying</font><font color="#CCCCCC"> to avoid</font>

907
00:33:48,710 --> 00:33:53,029
appearing in prop<font color="#E5E5E5"> property exit our</font>

908
00:33:51,529 --> 00:33:54,230
property<font color="#E5E5E5"> and sees</font><font color="#CCCCCC"> normally where I pull</font>

909
00:33:53,029 --> 00:33:55,490
<font color="#CCCCCC">out any melon</font><font color="#E5E5E5"> that's running on a box</font>

910
00:33:54,230 --> 00:33:57,679
<font color="#E5E5E5">and I'm doing forensics it's the easiest</font>

911
00:33:55,490 --> 00:34:01,519
way to get it up normal<font color="#CCCCCC"> level form but</font>

912
00:33:57,679 --> 00:34:03,200
if you run it<font color="#CCCCCC"> with Lib L</font><font color="#E5E5E5"> lead and you</font>

913
00:34:01,519 --> 00:34:04,460
will when you try<font color="#E5E5E5"> to blow the binary</font>

914
00:34:03,200 --> 00:34:06,909
you'll just<font color="#E5E5E5"> get the dynamic linker out</font>

915
00:34:04,460 --> 00:34:10,490
of that you'll<font color="#E5E5E5"> have to actually</font><font color="#CCCCCC"> pull</font>

916
00:34:06,909 --> 00:34:12,109
<font color="#E5E5E5">which is convenient and you can also</font>

917
00:34:10,489 --> 00:34:15,500
make<font color="#CCCCCC"> it set cap as well</font><font color="#E5E5E5"> which I'll talk</font>

918
00:34:12,109 --> 00:34:18,109
about<font color="#E5E5E5"> them a little bit</font><font color="#CCCCCC"> and also</font><font color="#E5E5E5"> I</font>

919
00:34:15,500 --> 00:34:19,520
mentioned mem FD before but if you've

920
00:34:18,109 --> 00:34:22,639
<font color="#E5E5E5">ever wanted to execute a</font><font color="#CCCCCC"> binary in</font>

921
00:34:19,520 --> 00:34:24,469
memory on<font color="#E5E5E5"> Linux now you can and there's</font>

922
00:34:22,639 --> 00:34:27,260
a tool called<font color="#CCCCCC"> Neto</font><font color="#E5E5E5"> which is</font><font color="#CCCCCC"> written</font><font color="#E5E5E5"> by a</font>

923
00:34:24,469 --> 00:34:28,428
friend of<font color="#E5E5E5"> mine and it downloads elf</font>

924
00:34:27,260 --> 00:34:30,440
<font color="#CCCCCC">except it was threatened from</font><font color="#E5E5E5"> the</font>

925
00:34:28,429 --> 00:34:32,389
internet<font color="#E5E5E5"> and runs them in memory and</font><font color="#CCCCCC"> MMF</font>

926
00:34:30,440 --> 00:34:34,369
<font color="#CCCCCC">D is essentially</font><font color="#E5E5E5"> like a file descriptor</font>

927
00:34:32,389 --> 00:34:36,649
that<font color="#E5E5E5"> exists in memory and doesn't touch</font>

928
00:34:34,369 --> 00:34:38,720
disk that<font color="#E5E5E5"> was introduced in the kernel</font>

929
00:34:36,649 --> 00:34:40,489
in 2014 for reasons<font color="#CCCCCC"> that I</font><font color="#E5E5E5"> have no idea</font>

930
00:34:38,719 --> 00:34:41,989
<font color="#CCCCCC">why it's a</font><font color="#E5E5E5"> little bit like LD preload</font>

931
00:34:40,489 --> 00:34:44,089
<font color="#E5E5E5">I'm sure there</font><font color="#CCCCCC"> are legitimate</font><font color="#E5E5E5"> reasons</font>

932
00:34:41,989 --> 00:34:45,649
<font color="#E5E5E5">but for</font><font color="#CCCCCC"> me all I can think about is</font>

933
00:34:44,089 --> 00:34:48,619
abusing<font color="#E5E5E5"> this and using the</font><font color="#CCCCCC"> selects</font><font color="#E5E5E5"> you</font>

934
00:34:45,649 --> 00:34:50,299
things in<font color="#E5E5E5"> memory and it's really quite</font>

935
00:34:48,619 --> 00:34:52,520
useful<font color="#CCCCCC"> there are still ways</font><font color="#E5E5E5"> to detect it</font>

936
00:34:50,300 --> 00:34:53,750
so<font color="#CCCCCC"> you will still see that</font><font color="#E5E5E5"> in the proper</font>

937
00:34:52,520 --> 00:34:55,879
list of file descriptors you will

938
00:34:53,750 --> 00:34:57,890
<font color="#E5E5E5">actually see that</font><font color="#CCCCCC"> it is a little odd</font>

939
00:34:55,879 --> 00:35:00,319
little thing like<font color="#E5E5E5"> if you LS</font><font color="#CCCCCC"> it that</font><font color="#E5E5E5"> will</font>

940
00:34:57,890 --> 00:35:01,190
say it's a man<font color="#CCCCCC"> ft so yeah</font><font color="#E5E5E5"> it's not that</font>

941
00:35:00,319 --> 00:35:03,470
common<font color="#CCCCCC"> I've not seen anything</font>

942
00:35:01,190 --> 00:35:06,109
legitimately use<font color="#CCCCCC"> this so someone looking</font>

943
00:35:03,470 --> 00:35:08,379
<font color="#CCCCCC">for it will find that and and</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> I</font>

944
00:35:06,109 --> 00:35:11,270
mentioned again<font color="#E5E5E5"> capabilities earlier and</font>

945
00:35:08,380 --> 00:35:13,160
so no one's<font color="#CCCCCC"> familiar with capabilities</font>

946
00:35:11,270 --> 00:35:16,819
they're kind of like set UID

947
00:35:13,160 --> 00:35:17,839
<font color="#E5E5E5">but they don't count</font><font color="#CCCCCC"> a as a normal</font>

948
00:35:16,819 --> 00:35:19,849
<font color="#CCCCCC">Commission so you won't find</font><font color="#E5E5E5"> a</font>

949
00:35:17,839 --> 00:35:22,339
justifying for<font color="#CCCCCC"> Commission's</font><font color="#E5E5E5"> they're sort</font>

950
00:35:19,849 --> 00:35:23,450
of<font color="#E5E5E5"> a way of modularly and providing</font>

951
00:35:22,339 --> 00:35:25,578
privileged

952
00:35:23,450 --> 00:35:27,770
<font color="#E5E5E5">features to a binary on</font><font color="#CCCCCC"> linux so for</font>

953
00:35:25,579 --> 00:35:30,020
example ping<font color="#CCCCCC"> on most modern Linux</font><font color="#E5E5E5"> will</font>

954
00:35:27,770 --> 00:35:31,849
have<font color="#CCCCCC"> cap net admin which is allows it to</font>

955
00:35:30,020 --> 00:35:32,480
<font color="#E5E5E5">create raw sockets</font><font color="#CCCCCC"> but not do any other</font>

956
00:35:31,849 --> 00:35:35,450
route up

957
00:35:32,480 --> 00:35:37,369
and but you<font color="#CCCCCC"> can also set things like</font>

958
00:35:35,450 --> 00:35:39,319
<font color="#CCCCCC">caps at you ID which will</font><font color="#E5E5E5"> let you run</font>

959
00:35:37,369 --> 00:35:43,099
<font color="#E5E5E5">set you ID'd function and</font><font color="#CCCCCC"> elevators up</font>

960
00:35:39,320 --> 00:35:47,780
up up and people<font color="#E5E5E5"> will run fines for set</font>

961
00:35:43,099 --> 00:35:49,070
<font color="#CCCCCC">UID</font><font color="#E5E5E5"> binary is constantly like</font><font color="#CCCCCC"> this it's</font>

962
00:35:47,780 --> 00:35:50,540
the number one thing<font color="#E5E5E5"> you'll do in a</font>

963
00:35:49,070 --> 00:35:52,520
build review for example<font color="#CCCCCC"> anyone</font><font color="#E5E5E5"> who's</font>

964
00:35:50,540 --> 00:35:53,990
been compromised will probably do this<font color="#E5E5E5"> -</font>

965
00:35:52,520 --> 00:35:54,740
sorry even suspect it<font color="#E5E5E5"> will probably do</font>

966
00:35:53,990 --> 00:35:56,810
this to see<font color="#E5E5E5"> if there's anything</font>

967
00:35:54,740 --> 00:35:59,180
suspicious<font color="#E5E5E5"> going on and one of the great</font>

968
00:35:56,810 --> 00:36:00,589
things about<font color="#E5E5E5"> capabilities is the only</font>

969
00:35:59,180 --> 00:36:02,660
way I know of to like<font color="#E5E5E5"> will personally</font>

970
00:36:00,589 --> 00:36:03,950
find them is the list is to use fine to

971
00:36:02,660 --> 00:36:07,578
print everything<font color="#E5E5E5"> on the filesystem</font><font color="#CCCCCC"> and</font>

972
00:36:03,950 --> 00:36:12,410
<font color="#E5E5E5">then pipe that into</font><font color="#CCCCCC"> light and say get</font>

973
00:36:07,579 --> 00:36:14,869
factor which will then<font color="#E5E5E5"> list them so</font>

974
00:36:12,410 --> 00:36:16,129
let's see other<font color="#E5E5E5"> random sort of</font>

975
00:36:14,869 --> 00:36:18,290
<font color="#E5E5E5">functionality that I find that's really</font>

976
00:36:16,130 --> 00:36:22,609
<font color="#CCCCCC">useful um there's</font><font color="#E5E5E5"> stuff like ssh-keygen</font>

977
00:36:18,290 --> 00:36:24,770
<font color="#E5E5E5">so I was on a box recently on a network</font>

978
00:36:22,609 --> 00:36:28,098
<font color="#E5E5E5">with essentially no real outgoing</font>

979
00:36:24,770 --> 00:36:29,270
<font color="#CCCCCC">Internet connectivity and I know ports</font>

980
00:36:28,099 --> 00:36:32,000
generally what that<font color="#E5E5E5"> it was my only way</font>

981
00:36:29,270 --> 00:36:34,040
in the network and<font color="#CCCCCC"> SSA</font><font color="#E5E5E5"> or SSH</font><font color="#CCCCCC"> key scan</font>

982
00:36:32,000 --> 00:36:37,190
<font color="#E5E5E5">Oh typo did it's actually called SSH key</font>

983
00:36:34,040 --> 00:36:38,960
<font color="#CCCCCC">scanner and basically what that</font><font color="#E5E5E5"> does is</font>

984
00:36:37,190 --> 00:36:42,109
it<font color="#E5E5E5"> will</font><font color="#CCCCCC"> take</font><font color="#E5E5E5"> a list of IPs and it will</font>

985
00:36:38,960 --> 00:36:45,230
grab the like prior the the fingerprint

986
00:36:42,109 --> 00:36:46,730
from all of them and and<font color="#E5E5E5"> you can</font>

987
00:36:45,230 --> 00:36:48,859
essentially use<font color="#E5E5E5"> it as a massive port</font>

988
00:36:46,730 --> 00:36:50,780
scanner<font color="#E5E5E5"> and you've also got s trace</font>

989
00:36:48,859 --> 00:36:52,220
which is ringing install and makes it

990
00:36:50,780 --> 00:36:56,599
perfectly serviceable<font color="#CCCCCC"> key logger</font><font color="#E5E5E5"> on</font>

991
00:36:52,220 --> 00:36:58,700
Linux<font color="#E5E5E5"> and I've combined s trace and SSH</font>

992
00:36:56,599 --> 00:37:00,560
key scan to basically port scan other

993
00:36:58,700 --> 00:37:02,210
ports as<font color="#CCCCCC"> well in like a</font><font color="#E5E5E5"> one line it's</font>

994
00:37:00,560 --> 00:37:03,470
really<font color="#E5E5E5"> convenient this exact which</font>

995
00:37:02,210 --> 00:37:05,540
allows you<font color="#E5E5E5"> to conveniently change the</font>

996
00:37:03,470 --> 00:37:07,069
name<font color="#CCCCCC"> of any processes you</font><font color="#E5E5E5"> wants so let's</font>

997
00:37:05,540 --> 00:37:08,779
say you're launching<font color="#CCCCCC"> TF HD</font><font color="#E5E5E5"> now looks</font>

998
00:37:07,069 --> 00:37:10,520
like<font color="#CCCCCC"> d-bus</font><font color="#E5E5E5"> it's these are all really</font>

999
00:37:08,780 --> 00:37:12,349
<font color="#CCCCCC">useful</font><font color="#E5E5E5"> built-in tools and links</font><font color="#CCCCCC"> that you</font>

1000
00:37:10,520 --> 00:37:16,550
can<font color="#E5E5E5"> use to hide if you're doing a red</font>

1001
00:37:12,349 --> 00:37:20,599
team job<font color="#E5E5E5"> and yeah so concluding</font>

1002
00:37:16,550 --> 00:37:22,040
basically there are<font color="#E5E5E5"> loads and</font><font color="#CCCCCC"> loads of</font>

1003
00:37:20,599 --> 00:37:23,990
ways to do strange and weird<font color="#E5E5E5"> things on</font>

1004
00:37:22,040 --> 00:37:25,640
<font color="#E5E5E5">Linux and nobody really looks at any of</font>

1005
00:37:23,990 --> 00:37:28,220
this<font color="#E5E5E5"> stuff anyway so you can kind of</font>

1006
00:37:25,640 --> 00:37:31,210
experiment<font color="#CCCCCC"> and I've been looking at for</font>

1007
00:37:28,220 --> 00:37:33,259
<font color="#CCCCCC">example some examples of red team's</font>

1008
00:37:31,210 --> 00:37:34,790
defensive stuff<font color="#E5E5E5"> which is</font><font color="#CCCCCC"> based on</font>

1009
00:37:33,260 --> 00:37:36,109
<font color="#CCCCCC">writing</font><font color="#E5E5E5"> where they're like you know if</font>

1010
00:37:34,790 --> 00:37:37,640
someone's<font color="#E5E5E5"> caddying</font><font color="#CCCCCC"> and setter password</font>

1011
00:37:36,109 --> 00:37:38,869
that's a little<font color="#E5E5E5"> bit suspicious</font><font color="#CCCCCC"> but I</font>

1012
00:37:37,640 --> 00:37:42,020
mean you can also just set your<font color="#CCCCCC"> heesu</font>

1013
00:37:38,869 --> 00:37:43,700
file to exert<font color="#E5E5E5"> a password load that</font><font color="#CCCCCC"> etc</font>

1014
00:37:42,020 --> 00:37:44,780
<font color="#E5E5E5">password then into your actual history</font>

1015
00:37:43,700 --> 00:37:45,319
and memory and<font color="#E5E5E5"> then just write history</font>

1016
00:37:44,780 --> 00:37:47,180
<font color="#CCCCCC">and get</font>

1017
00:37:45,319 --> 00:37:48,459
whole thing out<font color="#E5E5E5"> it's really easy to do</font>

1018
00:37:47,180 --> 00:37:51,529
pretty much anything other<font color="#E5E5E5"> works and</font>

1019
00:37:48,459 --> 00:37:52,788
<font color="#E5E5E5">there's a whole like world of implant</font>

1020
00:37:51,529 --> 00:37:54,049
development out there to explore

1021
00:37:52,789 --> 00:37:55,940
<font color="#E5E5E5">hopefully people are</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit</font>

1022
00:37:54,049 --> 00:37:58,459
interested in<font color="#E5E5E5"> the idea if you</font><font color="#CCCCCC"> can do</font>

1023
00:37:55,940 --> 00:38:00,380
things like create<font color="#E5E5E5"> libraries that have a</font>

1024
00:37:58,459 --> 00:38:02,029
<font color="#CCCCCC">main</font><font color="#E5E5E5"> and you can execute as a standard</font>

1025
00:38:00,380 --> 00:38:06,940
<font color="#CCCCCC">binary you know they're shared objects</font>

1026
00:38:02,029 --> 00:38:11,539
and and then I'm kind of hoping<font color="#CCCCCC"> that we</font>

1027
00:38:06,940 --> 00:38:13,579
sort of exhaust<font color="#E5E5E5"> the world of Windows we</font>

1028
00:38:11,539 --> 00:38:16,279
<font color="#CCCCCC">stop writing just focusing on PowerShell</font>

1029
00:38:13,579 --> 00:38:17,630
<font color="#CCCCCC">and c-sharp</font><font color="#E5E5E5"> minor' ease and then cobalt</font>

1030
00:38:16,279 --> 00:38:20,779
striking things and we start<font color="#CCCCCC"> developing</font>

1031
00:38:17,630 --> 00:38:22,459
cool things on Linux and<font color="#CCCCCC"> well especially</font>

1032
00:38:20,779 --> 00:38:24,319
<font color="#CCCCCC">because no one is ever pay attention</font>

1033
00:38:22,459 --> 00:38:26,479
slot easier to be stuff that<font color="#E5E5E5"> lives</font><font color="#CCCCCC"> I</font>

1034
00:38:24,319 --> 00:38:28,249
<font color="#CCCCCC">mean hacking harness is at least do seem</font>

1035
00:38:26,479 --> 00:38:31,339
<font color="#CCCCCC">to be coming</font><font color="#E5E5E5"> back I was recently linked</font>

1036
00:38:28,249 --> 00:38:32,718
to something<font color="#E5E5E5"> here it's called</font><font color="#CCCCCC"> FFM</font><font color="#E5E5E5"> I</font>

1037
00:38:31,339 --> 00:38:33,979
remember exactly<font color="#E5E5E5"> what it stands for but</font>

1038
00:38:32,719 --> 00:38:37,009
<font color="#E5E5E5">it's a really</font><font color="#CCCCCC"> cool hacking harness I</font>

1039
00:38:33,979 --> 00:38:38,989
<font color="#CCCCCC">reckon you guys</font><font color="#E5E5E5"> yes thank you</font><font color="#CCCCCC"> freedom</font>

1040
00:38:37,009 --> 00:38:40,430
<font color="#CCCCCC">fighting mode which is</font><font color="#E5E5E5"> pretty cool</font><font color="#CCCCCC"> I</font>

1041
00:38:38,989 --> 00:38:44,059
reckon you really should<font color="#CCCCCC"> check it out</font><font color="#E5E5E5"> I</font>

1042
00:38:40,430 --> 00:38:49,058
will<font color="#CCCCCC"> probably tweet it yeah that's my</font>

1043
00:38:44,059 --> 00:38:49,059
talk<font color="#E5E5E5"> and has anyone got any</font><font color="#CCCCCC"> questions</font>

1044
00:38:58,650 --> 00:39:10,540
<font color="#E5E5E5">I'm keeping this really</font><font color="#CCCCCC"> I think it's</font>

1045
00:39:09,220 --> 00:39:12,250
because you don't<font color="#E5E5E5"> actually need to</font><font color="#CCCCCC"> work</font>

1046
00:39:10,540 --> 00:39:15,009
<font color="#CCCCCC">very hard in</font><font color="#E5E5E5"> minutes I mean</font><font color="#CCCCCC"> chaining</font><font color="#E5E5E5"> and</font>

1047
00:39:12,250 --> 00:39:17,290
<font color="#E5E5E5">just dropping an SSH key into like</font>

1048
00:39:15,010 --> 00:39:18,670
authorized keys will do<font color="#CCCCCC"> 90 percent of</font>

1049
00:39:17,290 --> 00:39:22,509
the time no one<font color="#CCCCCC"> really</font><font color="#E5E5E5"> checks for these</font>

1050
00:39:18,670 --> 00:39:24,280
things<font color="#E5E5E5"> and</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> no like it's not</font>

1051
00:39:22,510 --> 00:39:26,080
<font color="#E5E5E5">really any AV right I mean you've got</font>

1052
00:39:24,280 --> 00:39:28,119
like<font color="#E5E5E5"> RK hunter and CH</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> a rootkit but</font>

1053
00:39:26,080 --> 00:39:29,680
they are relics of<font color="#CCCCCC"> the 80s</font><font color="#E5E5E5"> I mean</font><font color="#CCCCCC"> they</font>

1054
00:39:28,119 --> 00:39:31,690
are literally<font color="#E5E5E5"> looking for specific files</font>

1055
00:39:29,680 --> 00:39:33,549
with specific hashes from 2003<font color="#CCCCCC"> and</font>

1056
00:39:31,690 --> 00:39:34,869
they're useless<font color="#CCCCCC"> in my</font><font color="#E5E5E5"> opinion which</font><font color="#CCCCCC"> is I</font>

1057
00:39:33,550 --> 00:39:36,460
hope no one here<font color="#E5E5E5"> actually develops those</font>

1058
00:39:34,869 --> 00:39:57,910
<font color="#E5E5E5">or really likes them I'm sorry</font><font color="#CCCCCC"> probably</font>

1059
00:39:36,460 --> 00:40:01,030
<font color="#CCCCCC">music so I've</font><font color="#E5E5E5"> actually found some of</font>

1060
00:39:57,910 --> 00:40:04,359
those on<font color="#E5E5E5"> IR engagements and just me</font>

1061
00:40:01,030 --> 00:40:06,790
looking<font color="#CCCCCC"> for malware myself and but I've</font>

1062
00:40:04,359 --> 00:40:08,350
not looked too deeply into<font color="#CCCCCC"> it</font><font color="#E5E5E5"> to be</font>

1063
00:40:06,790 --> 00:40:09,670
honest with you they did go is

1064
00:40:08,350 --> 00:40:11,410
definitely becoming<font color="#E5E5E5"> more popular and</font>

1065
00:40:09,670 --> 00:40:13,240
cost platform go seems to be pretty<font color="#E5E5E5"> cool</font>

1066
00:40:11,410 --> 00:40:16,270
but it's not<font color="#CCCCCC"> something</font><font color="#E5E5E5"> I've explored in</font>

1067
00:40:13,240 --> 00:40:17,890
detail<font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> afraid I can't talk too</font>

1068
00:40:16,270 --> 00:40:19,660
much about<font color="#E5E5E5"> it</font><font color="#CCCCCC"> but yeah</font><font color="#E5E5E5"> people are</font>

1069
00:40:17,890 --> 00:40:36,250
definitely<font color="#E5E5E5"> using it to do this kind of</font>

1070
00:40:19,660 --> 00:40:37,660
stuff<font color="#CCCCCC"> okay yes</font><font color="#E5E5E5"> we're good</font><font color="#CCCCCC"> alright so I</font>

1071
00:40:36,250 --> 00:40:39,720
guess it's time<font color="#CCCCCC"> to go up enjoy the Sun</font>

1072
00:40:37,660 --> 00:40:41,779
<font color="#E5E5E5">in the sports balls</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you guys</font>

1073
00:40:39,720 --> 00:40:41,779
<font color="#E5E5E5">you</font>

