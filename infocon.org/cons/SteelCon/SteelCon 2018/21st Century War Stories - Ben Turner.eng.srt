1
00:00:00,030 --> 00:00:03,989
so<font color="#E5E5E5"> hey everyone thanks for coming</font><font color="#CCCCCC"> to</font>

2
00:00:02,070 --> 00:00:06,509
watch my talk on 21st century<font color="#CCCCCC"> war</font>

3
00:00:03,990 --> 00:00:08,039
stories<font color="#E5E5E5"> big thanks to silicon to have me</font>

4
00:00:06,509 --> 00:00:09,450
<font color="#E5E5E5">back for a second year</font><font color="#CCCCCC"> and me and Dave</font>

5
00:00:08,039 --> 00:00:10,919
<font color="#CCCCCC">hardly did talk on interactive</font>

6
00:00:09,450 --> 00:00:13,530
<font color="#E5E5E5">PowerShell sessions we met support last</font>

7
00:00:10,920 --> 00:00:14,610
year<font color="#CCCCCC"> so it's great to</font><font color="#E5E5E5"> be back again</font><font color="#CCCCCC"> I've</font>

8
00:00:13,530 --> 00:00:16,410
<font color="#E5E5E5">tried to make</font><font color="#CCCCCC"> sure there's something for</font>

9
00:00:14,610 --> 00:00:18,600
everyone<font color="#E5E5E5"> in this talk</font><font color="#CCCCCC"> so it's not</font><font color="#E5E5E5"> only</font>

10
00:00:16,410 --> 00:00:20,698
<font color="#E5E5E5">focus</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the SE</font><font color="#CCCCCC"> enthusiasts</font><font color="#E5E5E5"> but also be</font>

11
00:00:18,600 --> 00:00:22,289
professional red teamer<font color="#E5E5E5"> and if you got</font>

12
00:00:20,699 --> 00:00:27,029
<font color="#E5E5E5">any questions I'll take them all at the</font>

13
00:00:22,289 --> 00:00:29,400
end so the talk<font color="#E5E5E5"> is</font><font color="#CCCCCC"> going to run a</font><font color="#E5E5E5"> little</font>

14
00:00:27,029 --> 00:00:31,650
bit<font color="#E5E5E5"> like this</font><font color="#CCCCCC"> recon is quite important</font>

15
00:00:29,400 --> 00:00:33,600
<font color="#E5E5E5">in any penetration test so I'll touch on</font>

16
00:00:31,650 --> 00:00:36,239
<font color="#CCCCCC">that talk about some of their current</font>

17
00:00:33,600 --> 00:00:38,579
tooling and<font color="#E5E5E5"> commercial to pay for an</font>

18
00:00:36,239 --> 00:00:41,669
open-source talk about getting<font color="#E5E5E5"> inside</font>

19
00:00:38,579 --> 00:00:44,430
the<font color="#CCCCCC"> environment infiltrating tactics</font>

20
00:00:41,670 --> 00:00:46,170
techniques and procedures<font color="#E5E5E5"> persistent so</font>

21
00:00:44,430 --> 00:00:49,079
once we've got<font color="#CCCCCC"> inside an environment</font><font color="#E5E5E5"> how</font>

22
00:00:46,170 --> 00:00:51,329
we can stay<font color="#CCCCCC"> in lateral movement and then</font>

23
00:00:49,079 --> 00:00:53,280
acting on objectives<font color="#CCCCCC"> I was going to talk</font>

24
00:00:51,329 --> 00:00:55,260
<font color="#CCCCCC">about</font><font color="#E5E5E5"> push c2 which we did a workshop on</font>

25
00:00:53,280 --> 00:01:01,140
yesterday and<font color="#CCCCCC"> hopefully do a live demo</font>

26
00:00:55,260 --> 00:01:03,120
openly<font color="#E5E5E5"> your demo gods are with us so Who</font>

27
00:01:01,140 --> 00:01:04,589
am<font color="#CCCCCC"> I so my name is Benson and</font><font color="#E5E5E5"> for those</font>

28
00:01:03,120 --> 00:01:07,048
<font color="#E5E5E5">of</font><font color="#CCCCCC"> you who</font><font color="#E5E5E5"> don't know I'm a penetration</font>

29
00:01:04,589 --> 00:01:09,990
tester<font color="#CCCCCC"> and red teaming attitude</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

30
00:01:07,049 --> 00:01:14,189
<font color="#CCCCCC">me</font><font color="#E5E5E5"> before via drawing a beer and after a</font>

31
00:01:09,990 --> 00:01:16,169
beer I've been through the<font color="#CCCCCC"> Christian</font>

32
00:01:14,189 --> 00:01:18,029
<font color="#CCCCCC">leader</font><font color="#E5E5E5"> exams and do my fair amount of IT</font>

33
00:01:16,170 --> 00:01:19,590
health<font color="#CCCCCC"> checks</font><font color="#E5E5E5"> kind of think that makes</font>

34
00:01:18,030 --> 00:01:21,000
quite<font color="#E5E5E5"> a good</font><font color="#CCCCCC"> foundation for a red teamer</font>

35
00:01:19,590 --> 00:01:22,710
because you got all<font color="#E5E5E5"> these sort of</font>

36
00:01:21,000 --> 00:01:25,409
experience on the end<font color="#E5E5E5"> points and general</font>

37
00:01:22,710 --> 00:01:27,509
security inside an<font color="#CCCCCC"> organisation as of</font>

38
00:01:25,409 --> 00:01:30,150
late most<font color="#CCCCCC"> of my focus is on red teaming</font>

39
00:01:27,509 --> 00:01:31,860
<font color="#CCCCCC">se star and see best</font><font color="#E5E5E5"> I've also got the</font>

40
00:01:30,150 --> 00:01:33,950
simulated attack specialist example

41
00:01:31,860 --> 00:01:36,659
which about now<font color="#E5E5E5"> for almost two years</font>

42
00:01:33,950 --> 00:01:40,049
<font color="#CCCCCC">also not just to</font><font color="#E5E5E5"> full-time hacking nerd</font>

43
00:01:36,659 --> 00:01:42,329
<font color="#CCCCCC">and during my biking skiing</font><font color="#E5E5E5"> flying</font>

44
00:01:40,049 --> 00:01:45,210
drones<font color="#CCCCCC"> traveling try not to combine the</font>

45
00:01:42,329 --> 00:01:47,158
two and I work<font color="#E5E5E5"> for an attitude and</font>

46
00:01:45,210 --> 00:01:50,309
that's<font color="#E5E5E5"> what handles that then be to know</font>

47
00:01:47,159 --> 00:01:52,530
if you want<font color="#E5E5E5"> to follow me</font><font color="#CCCCCC"> be a</font><font color="#E5E5E5"> disclaimer</font>

48
00:01:50,310 --> 00:01:55,740
<font color="#E5E5E5">the presentation reflects real live</font>

49
00:01:52,530 --> 00:01:58,290
experiences but sensitivity<font color="#E5E5E5"> all has been</font>

50
00:01:55,740 --> 00:02:03,030
redacted<font color="#CCCCCC"> for</font><font color="#E5E5E5"> a client</font><font color="#CCCCCC"> sensitivity client</font>

51
00:01:58,290 --> 00:02:04,649
confidentiality<font color="#CCCCCC"> sir so what</font><font color="#E5E5E5"> is 21st</font>

52
00:02:03,030 --> 00:02:06,119
century hacking so 21st century half

53
00:02:04,649 --> 00:02:08,340
game is amalgamation of social

54
00:02:06,119 --> 00:02:09,810
engineering<font color="#CCCCCC"> red teaming star and</font><font color="#E5E5E5"> see</font>

55
00:02:08,340 --> 00:02:11,790
<font color="#E5E5E5">best and it's kind of the most cutting</font>

56
00:02:09,810 --> 00:02:13,989
edge<font color="#E5E5E5"> of all the assurance services</font><font color="#CCCCCC"> it</font>

57
00:02:11,790 --> 00:02:16,239
kind of brings<font color="#E5E5E5"> a mix of skill sets</font>

58
00:02:13,989 --> 00:02:18,790
in order to<font color="#E5E5E5"> obtain you know in order to</font>

59
00:02:16,239 --> 00:02:21,640
<font color="#CCCCCC">achieve an objective</font><font color="#E5E5E5"> includes physical</font>

60
00:02:18,790 --> 00:02:22,120
<font color="#CCCCCC">ICUs be dropped</font><font color="#E5E5E5"> spearfishing telephone</font>

61
00:02:21,640 --> 00:02:23,798
calls

62
00:02:22,120 --> 00:02:24,969
<font color="#CCCCCC">Tarkus social engineering infrastructure</font>

63
00:02:23,799 --> 00:02:27,430
hacking and everything that's kind<font color="#E5E5E5"> of</font>

64
00:02:24,969 --> 00:02:30,010
what I feel<font color="#E5E5E5"> like it is and it's free</font>

65
00:02:27,430 --> 00:02:31,180
from caveat at all forms so<font color="#E5E5E5"> you know</font>

66
00:02:30,010 --> 00:02:32,649
there's no constraints really what a

67
00:02:31,180 --> 00:02:35,469
hacker can do so why should we<font color="#CCCCCC"> have them</font>

68
00:02:32,650 --> 00:02:37,180
constraints and in my opinion<font color="#E5E5E5"> you know</font>

69
00:02:35,469 --> 00:02:38,230
if you're not<font color="#CCCCCC"> waking up at 3:00 a.m.</font><font color="#E5E5E5"> to</font>

70
00:02:37,180 --> 00:02:39,250
see if you've got a shell<font color="#E5E5E5"> inside an</font>

71
00:02:38,230 --> 00:02:42,159
<font color="#E5E5E5">organization</font><font color="#CCCCCC"> you haven't really</font>

72
00:02:39,250 --> 00:02:43,750
experienced red teaming<font color="#E5E5E5"> what I tend not</font>

73
00:02:42,159 --> 00:02:45,250
to class<font color="#E5E5E5"> reach even as a sort of blowing</font>

74
00:02:43,750 --> 00:02:47,169
<font color="#E5E5E5">the doors off a building with c4 and</font>

75
00:02:45,250 --> 00:02:48,790
<font color="#E5E5E5">access the computer systems that's more</font>

76
00:02:47,169 --> 00:02:55,450
<font color="#E5E5E5">of a military term so this is kind of</font>

77
00:02:48,790 --> 00:02:57,129
what I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> ready</font><font color="#E5E5E5"> - so basically in</font>

78
00:02:55,450 --> 00:02:59,108
a<font color="#CCCCCC"> nutshell</font><font color="#E5E5E5"> when people ask me you know</font>

79
00:02:57,129 --> 00:03:01,719
why should we do<font color="#E5E5E5"> read to mean I kind of</font>

80
00:02:59,109 --> 00:03:03,010
focus<font color="#E5E5E5"> on this one story so</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> having</font>

81
00:03:01,719 --> 00:03:04,930
<font color="#E5E5E5">a bank over in the Middle East and</font>

82
00:03:03,010 --> 00:03:06,069
they've had<font color="#E5E5E5"> lots of penetration tests</font>

83
00:03:04,930 --> 00:03:08,139
and they<font color="#E5E5E5"> thought they were fairly secure</font>

84
00:03:06,069 --> 00:03:09,929
and so that pictures kind<font color="#E5E5E5"> of speak for</font>

85
00:03:08,139 --> 00:03:12,639
<font color="#E5E5E5">themselves</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's just a normal ATM</font>

86
00:03:09,930 --> 00:03:14,980
<font color="#CCCCCC">in</font><font color="#E5E5E5"> the back it was actually been jammed</font>

87
00:03:12,639 --> 00:03:16,659
<font color="#CCCCCC">opened by</font><font color="#E5E5E5"> someone else not me so I saw a</font>

88
00:03:14,980 --> 00:03:19,929
nice Cisco switch hanging out the<font color="#E5E5E5"> back</font>

89
00:03:16,659 --> 00:03:22,030
<font color="#CCCCCC">of it so this is there's a lot</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> was</font>

90
00:03:19,930 --> 00:03:25,329
<font color="#E5E5E5">yes you ripped off held on with wood</font>

91
00:03:22,030 --> 00:03:26,590
which<font color="#CCCCCC"> is nice so what we did</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> was</font>

92
00:03:25,329 --> 00:03:28,889
able<font color="#CCCCCC"> to actually plug in this</font><font color="#E5E5E5"> Cisco</font>

93
00:03:26,590 --> 00:03:32,290
<font color="#E5E5E5">switch and there and see the complete</font>

94
00:03:28,889 --> 00:03:34,120
<font color="#E5E5E5">basically over the 3G 4G network see all</font>

95
00:03:32,290 --> 00:03:35,828
the<font color="#E5E5E5"> bank systems I was</font><font color="#CCCCCC"> able to RDP onto</font>

96
00:03:34,120 --> 00:03:37,780
the main controller<font color="#CCCCCC"> all</font><font color="#E5E5E5"> over the hack</font>

97
00:03:35,829 --> 00:03:39,970
all the<font color="#CCCCCC"> systems literally from that ATM</font>

98
00:03:37,780 --> 00:03:42,010
machine<font color="#E5E5E5"> so I kind</font><font color="#CCCCCC"> of you know why focus</font>

99
00:03:39,970 --> 00:03:43,359
<font color="#E5E5E5">on all the internal insider threat when</font>

100
00:03:42,010 --> 00:03:45,668
you can kind of focus<font color="#E5E5E5"> on</font><font color="#CCCCCC"> everything so</font>

101
00:03:43,359 --> 00:03:48,430
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> kind of why I feel like it is</font>

102
00:03:45,669 --> 00:03:51,099
really<font color="#CCCCCC"> and this is another</font><font color="#E5E5E5"> example of</font>

103
00:03:48,430 --> 00:03:53,229
<font color="#E5E5E5">another</font><font color="#CCCCCC"> atm just this is how it's</font><font color="#E5E5E5"> the</font>

104
00:03:51,099 --> 00:03:55,209
open of the Cisco<font color="#E5E5E5"> switch 3G router</font><font color="#CCCCCC"> so</font>

105
00:03:53,229 --> 00:03:58,299
<font color="#E5E5E5">we're just able</font><font color="#CCCCCC"> to plug in into</font><font color="#E5E5E5"> access</font>

106
00:03:55,209 --> 00:03:59,889
to the network and they even<font color="#E5E5E5"> put a nice</font>

107
00:03:58,299 --> 00:04:01,000
IP address with their<font color="#E5E5E5"> default gateway</font>

108
00:03:59,889 --> 00:04:04,659
<font color="#CCCCCC">and everything for me so I didn't</font><font color="#E5E5E5"> even</font>

109
00:04:01,000 --> 00:04:06,340
<font color="#CCCCCC">have to work hard to</font><font color="#E5E5E5"> get that so</font>

110
00:04:04,659 --> 00:04:08,078
everything<font color="#CCCCCC"> we do we</font><font color="#E5E5E5"> kind of map it</font><font color="#CCCCCC"> back</font>

111
00:04:06,340 --> 00:04:09,639
to a<font color="#E5E5E5"> cyber attack chain and the kill</font>

112
00:04:08,079 --> 00:04:11,799
chain from Lockheed Martin so

113
00:04:09,639 --> 00:04:13,989
reconnaissance delivery exploitation

114
00:04:11,799 --> 00:04:15,400
pivoting and data exfiltration<font color="#CCCCCC"> so I kind</font>

115
00:04:13,989 --> 00:04:18,180
<font color="#E5E5E5">of</font><font color="#CCCCCC"> focused this</font><font color="#E5E5E5"> whole talk</font><font color="#CCCCCC"> around them</font>

116
00:04:15,400 --> 00:04:20,168
<font color="#E5E5E5">five sort of fundamental key principles</font>

117
00:04:18,180 --> 00:04:22,810
I guess

118
00:04:20,168 --> 00:04:24,690
red teaming also fundamentally it kind

119
00:04:22,810 --> 00:04:26,740
of provides a risk to the organization

120
00:04:24,690 --> 00:04:27,410
<font color="#E5E5E5">and everything we can</font><font color="#CCCCCC"> I deal with based</font>

121
00:04:26,740 --> 00:04:28,730
<font color="#E5E5E5">on a threat</font>

122
00:04:27,410 --> 00:04:30,920
so it depends<font color="#E5E5E5"> which type of threat to a</font>

123
00:04:28,730 --> 00:04:32,210
trying to mimic sometimes it can<font color="#E5E5E5"> be sort</font>

124
00:04:30,920 --> 00:04:33,380
of a lone wolf<font color="#CCCCCC"> or</font><font color="#E5E5E5"> the script</font><font color="#CCCCCC"> kitty and</font>

125
00:04:32,210 --> 00:04:36,979
sometimes<font color="#CCCCCC"> you might be trying to mimic a</font>

126
00:04:33,380 --> 00:04:39,440
sauce<font color="#CCCCCC"> nation-state</font><font color="#E5E5E5"> so depending on what</font>

127
00:04:36,980 --> 00:04:41,150
type<font color="#CCCCCC"> of organization</font><font color="#E5E5E5"> so I could type</font><font color="#CCCCCC"> of</font>

128
00:04:39,440 --> 00:04:45,290
the organization the targeting might you

129
00:04:41,150 --> 00:04:46,640
know change the<font color="#E5E5E5"> way you</font><font color="#CCCCCC"> attack it these</font>

130
00:04:45,290 --> 00:04:49,310
are different<font color="#CCCCCC"> threat actors and their</font>

131
00:04:46,640 --> 00:04:51,680
capability so<font color="#CCCCCC"> arranging like I said from</font>

132
00:04:49,310 --> 00:04:53,720
<font color="#E5E5E5">script kiddie or lone wolf with</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> much</font>

133
00:04:51,680 --> 00:04:55,880
capability<font color="#E5E5E5"> so I've easy to fingerprint</font>

134
00:04:53,720 --> 00:04:56,990
<font color="#E5E5E5">easy detect to sort of go</font><font color="#CCCCCC"> and right up</font>

135
00:04:55,880 --> 00:04:58,430
<font color="#CCCCCC">to the end</font><font color="#E5E5E5"> of the other end of the scale</font>

136
00:04:56,990 --> 00:05:00,140
which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> nation state or</font><font color="#CCCCCC"> state-sponsored</font>

137
00:04:58,430 --> 00:05:02,450
<font color="#CCCCCC">so which has</font><font color="#E5E5E5"> got like custom</font>

138
00:05:00,140 --> 00:05:04,370
cryptography very very much<font color="#E5E5E5"> anti</font>

139
00:05:02,450 --> 00:05:06,650
detection capabilities and<font color="#CCCCCC"> zero-days</font>

140
00:05:04,370 --> 00:05:11,480
things like that<font color="#E5E5E5"> and it's a lot harder</font>

141
00:05:06,650 --> 00:05:13,780
<font color="#CCCCCC">to fingerprint and detect so I guess</font>

142
00:05:11,480 --> 00:05:16,400
<font color="#E5E5E5">recon is really the most important</font>

143
00:05:13,780 --> 00:05:17,900
principle in every penetration test<font color="#E5E5E5"> I</font>

144
00:05:16,400 --> 00:05:19,190
kind of<font color="#E5E5E5"> lived by the now</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> you proper</font>

145
00:05:17,900 --> 00:05:22,489
planning prevents piss-poor performance

146
00:05:19,190 --> 00:05:24,020
<font color="#E5E5E5">and I really think it does</font><font color="#CCCCCC"> every pen</font>

147
00:05:22,490 --> 00:05:25,430
test I've done if you do enough recon

148
00:05:24,020 --> 00:05:27,080
<font color="#CCCCCC">sometimes you don't</font><font color="#E5E5E5"> even need</font><font color="#CCCCCC"> to</font>

149
00:05:25,430 --> 00:05:28,670
actively target the<font color="#E5E5E5"> organization because</font>

150
00:05:27,080 --> 00:05:32,090
<font color="#E5E5E5">you can just get in on the recon data</font>

151
00:05:28,670 --> 00:05:33,320
that you<font color="#E5E5E5"> actually got most importantly</font>

152
00:05:32,090 --> 00:05:34,789
the more you can<font color="#E5E5E5"> find out about the</font>

153
00:05:33,320 --> 00:05:36,050
environment the<font color="#E5E5E5"> better you can attack it</font>

154
00:05:34,790 --> 00:05:37,610
<font color="#E5E5E5">about you can tell to weaponize your</font>

155
00:05:36,050 --> 00:05:39,110
payloads<font color="#E5E5E5"> or</font><font color="#CCCCCC"> Commons</font><font color="#E5E5E5"> things like that so</font>

156
00:05:37,610 --> 00:05:41,210
<font color="#E5E5E5">you know it's a great way to go the</font>

157
00:05:39,110 --> 00:05:44,240
tools are simply you tend to<font color="#E5E5E5"> users multi</font>

158
00:05:41,210 --> 00:05:47,450
<font color="#E5E5E5">you go DNS reconnaissance</font><font color="#CCCCCC"> who is records</font>

159
00:05:44,240 --> 00:05:48,350
<font color="#E5E5E5">media social networking github and</font><font color="#CCCCCC"> I'll</font>

160
00:05:47,450 --> 00:05:50,479
<font color="#CCCCCC">suggest so you can read</font><font color="#E5E5E5"> it for yourself</font>

161
00:05:48,350 --> 00:05:53,720
<font color="#CCCCCC">and but certain even search engine just</font>

162
00:05:50,480 --> 00:05:55,490
<font color="#E5E5E5">you know normal search engine optimizing</font>

163
00:05:53,720 --> 00:05:56,900
database and things like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> previous</font>

164
00:05:55,490 --> 00:05:57,590
breaches are really good as<font color="#CCCCCC"> well because</font>

165
00:05:56,900 --> 00:05:59,419
obviously<font color="#E5E5E5"> they've got a lot of</font>

166
00:05:57,590 --> 00:06:03,109
information<font color="#E5E5E5"> and often credentials might</font>

167
00:05:59,419 --> 00:06:04,130
<font color="#CCCCCC">be</font><font color="#E5E5E5"> still even work and so des is a</font>

168
00:06:03,110 --> 00:06:06,200
really<font color="#E5E5E5"> interesting one so I was</font>

169
00:06:04,130 --> 00:06:07,370
<font color="#CCCCCC">targeting organization recently</font><font color="#E5E5E5"> and I</font>

170
00:06:06,200 --> 00:06:09,440
didn't think they were<font color="#CCCCCC"> that savvy in</font>

171
00:06:07,370 --> 00:06:10,820
terms of email<font color="#CCCCCC"> security but actually</font>

172
00:06:09,440 --> 00:06:12,050
wouldn't doing some<font color="#E5E5E5"> DNS reverse lookup</font>

173
00:06:10,820 --> 00:06:14,450
so I found<font color="#E5E5E5"> out that they were using mine</font>

174
00:06:12,050 --> 00:06:16,280
cast so<font color="#E5E5E5"> ah bugger probably not going</font><font color="#CCCCCC"> to</font>

175
00:06:14,450 --> 00:06:18,260
get in here<font color="#E5E5E5"> so just</font><font color="#CCCCCC"> having that</font>

176
00:06:16,280 --> 00:06:19,940
knowledge<font color="#CCCCCC"> I was able to adapt my attack</font>

177
00:06:18,260 --> 00:06:20,840
method to<font color="#E5E5E5"> actually because I know mine</font>

178
00:06:19,940 --> 00:06:23,030
class is<font color="#E5E5E5"> pretty good at blocking</font>

179
00:06:20,840 --> 00:06:24,140
<font color="#E5E5E5">attachments so</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> like right this time</font>

180
00:06:23,030 --> 00:06:25,070
<font color="#E5E5E5">I'm not going to send</font><font color="#CCCCCC"> the document and</font>

181
00:06:24,140 --> 00:06:26,450
I'm going<font color="#CCCCCC"> to send a</font><font color="#E5E5E5"> link to a document</font>

182
00:06:25,070 --> 00:06:28,490
<font color="#E5E5E5">because I know it won't probably pick</font>

183
00:06:26,450 --> 00:06:30,560
that up so<font color="#E5E5E5"> you know just having that</font>

184
00:06:28,490 --> 00:06:31,850
insider information that's<font color="#E5E5E5"> freely</font>

185
00:06:30,560 --> 00:06:37,850
<font color="#E5E5E5">available is really good when you target</font>

186
00:06:31,850 --> 00:06:40,220
<font color="#E5E5E5">an organization so email tools so email</font>

187
00:06:37,850 --> 00:06:41,009
recon and tools that<font color="#E5E5E5"> are you so going</font>

188
00:06:40,220 --> 00:06:42,659
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> throat</font>

189
00:06:41,009 --> 00:06:45,270
<font color="#CCCCCC">torkoal</font><font color="#E5E5E5"> prowl which is pretty cool</font><font color="#CCCCCC"> so</font>

190
00:06:42,659 --> 00:06:46,349
<font color="#CCCCCC">I'll go</font><font color="#E5E5E5"> away and use LinkedIn that will</font>

191
00:06:45,270 --> 00:06:48,119
grab all<font color="#E5E5E5"> the information from LinkedIn</font>

192
00:06:46,349 --> 00:06:50,639
<font color="#E5E5E5">and give you basically a great list of</font>

193
00:06:48,119 --> 00:06:51,809
email<font color="#CCCCCC"> addresses</font><font color="#E5E5E5"> also then picks up on</font>

194
00:06:50,639 --> 00:06:52,559
other stuff as well<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I've gone that</font>

195
00:06:51,809 --> 00:06:55,379
in a<font color="#E5E5E5"> minute</font>

196
00:06:52,559 --> 00:06:56,219
simply<font color="#CCCCCC"> email the harvester</font><font color="#E5E5E5"> more to you</font>

197
00:06:55,379 --> 00:06:57,809
go

198
00:06:56,219 --> 00:06:59,129
and obviously previous breaches like<font color="#CCCCCC"> a</font>

199
00:06:57,809 --> 00:07:01,169
<font color="#E5E5E5">dis</font><font color="#CCCCCC"> mention so these are</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> are great</font>

200
00:06:59,129 --> 00:07:02,879
ways to<font color="#CCCCCC"> get information when</font><font color="#E5E5E5"> your target</font>

201
00:07:01,169 --> 00:07:04,469
an organization you do need to know<font color="#E5E5E5"> the</font>

202
00:07:02,879 --> 00:07:05,999
<font color="#E5E5E5">format of the email so you can probably</font>

203
00:07:04,469 --> 00:07:08,639
<font color="#E5E5E5">do that</font><font color="#CCCCCC"> by doing some manual searching</font>

204
00:07:05,999 --> 00:07:10,830
<font color="#CCCCCC">against</font><font color="#E5E5E5"> the organization but I guess</font>

205
00:07:08,639 --> 00:07:12,839
pick wisely because you know if you<font color="#E5E5E5"> are</font>

206
00:07:10,830 --> 00:07:16,020
<font color="#E5E5E5">targeting annoying as I</font><font color="#CCCCCC"> organization</font><font color="#E5E5E5"> and</font>

207
00:07:12,839 --> 00:07:17,249
you've got sort<font color="#E5E5E5"> of an end objective</font><font color="#CCCCCC"> that</font>

208
00:07:16,020 --> 00:07:19,109
you know you want to<font color="#E5E5E5"> get on this</font><font color="#CCCCCC"> Bank</font>

209
00:07:17,249 --> 00:07:20,639
and<font color="#E5E5E5"> Apple you want to get on this server</font>

210
00:07:19,110 --> 00:07:22,589
<font color="#E5E5E5">you know LinkedIn might tell you that</font>

211
00:07:20,639 --> 00:07:24,029
<font color="#E5E5E5">that guy actually runs that part of the</font>

212
00:07:22,589 --> 00:07:25,229
company so actually you know you don't

213
00:07:24,029 --> 00:07:27,779
have to do any<font color="#E5E5E5"> lateral movement if you</font>

214
00:07:25,229 --> 00:07:30,990
can just down his machine so again it

215
00:07:27,779 --> 00:07:32,879
comes down<font color="#CCCCCC"> to research and recon this is</font>

216
00:07:30,990 --> 00:07:36,839
prowl so one of the tools<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you might</font>

217
00:07:32,879 --> 00:07:38,370
want to consider it<font color="#E5E5E5"> also now cross</font>

218
00:07:36,839 --> 00:07:39,990
checks against<font color="#E5E5E5"> have I've in poem so</font>

219
00:07:38,370 --> 00:07:41,339
it'll pull back all the<font color="#CCCCCC"> information</font>

220
00:07:39,990 --> 00:07:42,959
it'll<font color="#E5E5E5"> tell you if any of these email</font>

221
00:07:41,339 --> 00:07:47,819
addresses<font color="#CCCCCC"> have</font><font color="#E5E5E5"> been in</font><font color="#CCCCCC"> hababam poem</font>

222
00:07:42,959 --> 00:07:48,930
database so I guess<font color="#CCCCCC"> knowing your</font>

223
00:07:47,819 --> 00:07:50,669
<font color="#E5E5E5">terminology when doing this type</font><font color="#CCCCCC"> of</font>

224
00:07:48,930 --> 00:07:53,099
<font color="#E5E5E5">engagement as well so spam phishing and</font>

225
00:07:50,669 --> 00:07:55,229
spoofing<font color="#E5E5E5"> that are quite significant</font>

226
00:07:53,099 --> 00:07:57,558
differences spans of unsolicited bulk

227
00:07:55,229 --> 00:07:59,909
email like<font color="#CCCCCC"> irrespective of content</font>

228
00:07:57,559 --> 00:08:02,009
<font color="#E5E5E5">phishing is like a type of spam but it's</font>

229
00:07:59,909 --> 00:08:04,589
normally intended<font color="#E5E5E5"> to get sensitive</font>

230
00:08:02,009 --> 00:08:06,209
information<font color="#E5E5E5"> or like fake PayPal invoices</font>

231
00:08:04,589 --> 00:08:07,409
<font color="#E5E5E5">that sort of thing and then spoofing is</font>

232
00:08:06,209 --> 00:08:09,149
normally sort<font color="#E5E5E5"> of when you spoof</font><font color="#CCCCCC"> for the</font>

233
00:08:07,409 --> 00:08:11,639
farm<font color="#E5E5E5"> address so when you try and it you</font>

234
00:08:09,149 --> 00:08:13,110
know<font color="#E5E5E5"> impersonate someone else</font><font color="#CCCCCC"> also know</font>

235
00:08:11,639 --> 00:08:14,819
the<font color="#CCCCCC"> countermeasures as</font><font color="#E5E5E5"> well so you can</font>

236
00:08:13,110 --> 00:08:16,559
tell the client what<font color="#CCCCCC"> they can do to try</font>

237
00:08:14,819 --> 00:08:20,599
<font color="#CCCCCC">and</font><font color="#E5E5E5"> help mitigate this stuff like sender</font>

238
00:08:16,559 --> 00:08:20,599
ID<font color="#E5E5E5"> SPF D Clement d mark</font>

239
00:08:25,990 --> 00:08:29,680
had<font color="#E5E5E5"> quite a lot of success</font><font color="#CCCCCC"> recently</font>

240
00:08:27,610 --> 00:08:31,630
actually<font color="#E5E5E5"> from doing an engagement where</font>

241
00:08:29,680 --> 00:08:33,610
when I was<font color="#CCCCCC"> targeting them I did some</font>

242
00:08:31,630 --> 00:08:35,588
recon<font color="#E5E5E5"> on their email gateway system</font><font color="#CCCCCC"> and</font>

243
00:08:33,610 --> 00:08:37,089
I didn't use the very top mail gateway

244
00:08:35,589 --> 00:08:39,760
but I was able<font color="#CCCCCC"> to use a</font><font color="#E5E5E5"> third one and</font>

245
00:08:37,089 --> 00:08:41,380
actually spoof the<font color="#CCCCCC"> forum address so but</font>

246
00:08:39,760 --> 00:08:42,819
not not spoofing<font color="#E5E5E5"> the address from any</font>

247
00:08:41,380 --> 00:08:44,770
random email I was<font color="#E5E5E5"> actually using the</font>

248
00:08:42,820 --> 00:08:46,750
company name and sending<font color="#CCCCCC"> emails from</font>

249
00:08:44,770 --> 00:08:48,310
themselves<font color="#CCCCCC"> so it was like</font><font color="#E5E5E5"> it almost like</font>

250
00:08:46,750 --> 00:08:49,870
an open mail relay but back<font color="#E5E5E5"> into</font>

251
00:08:48,310 --> 00:08:51,819
<font color="#CCCCCC">themselves and so the great thing with</font>

252
00:08:49,870 --> 00:08:54,160
<font color="#E5E5E5">this is without work it's a trusted</font>

253
00:08:51,820 --> 00:08:55,570
domain so if you like UNC<font color="#CCCCCC"> paths or</font>

254
00:08:54,160 --> 00:08:57,430
images they'll automatically download

255
00:08:55,570 --> 00:08:59,050
<font color="#E5E5E5">because it's a trusted domain so that's</font>

256
00:08:57,430 --> 00:09:01,209
a great<font color="#E5E5E5"> way to to get inside an</font>

257
00:08:59,050 --> 00:09:02,290
organization<font color="#E5E5E5"> intently</font><font color="#CCCCCC"> to buy domains to</font>

258
00:09:01,209 --> 00:09:04,149
hack them you can basically<font color="#E5E5E5"> just use</font>

259
00:09:02,290 --> 00:09:08,709
their own<font color="#CCCCCC"> mouse over so often it's a</font>

260
00:09:04,149 --> 00:09:10,240
really good<font color="#E5E5E5"> idea</font><font color="#CCCCCC"> to check</font><font color="#E5E5E5"> that first so</font>

261
00:09:08,709 --> 00:09:11,649
the current tool in<font color="#E5E5E5"> any industry at the</font>

262
00:09:10,240 --> 00:09:12,910
moment<font color="#CCCCCC"> so</font><font color="#E5E5E5"> Matt's one of the best</font>

263
00:09:11,649 --> 00:09:14,649
<font color="#CCCCCC">open-source penetration testing</font>

264
00:09:12,910 --> 00:09:16,689
frameworks but I wouldn't say it's great

265
00:09:14,649 --> 00:09:20,170
for red teaming<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's quite noisy and</font>

266
00:09:16,690 --> 00:09:21,610
it's not what not very stealthy it's

267
00:09:20,170 --> 00:09:24,579
been<font color="#CCCCCC"> signatures</font><font color="#E5E5E5"> by a lot of seeming AV</font>

268
00:09:21,610 --> 00:09:25,720
products as well but<font color="#E5E5E5"> the</font><font color="#CCCCCC"> rigorous HTTP</font>

269
00:09:24,580 --> 00:09:28,330
<font color="#E5E5E5">comms are still</font><font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> good and</font><font color="#CCCCCC"> you can</font>

270
00:09:25,720 --> 00:09:30,040
<font color="#E5E5E5">have set timeouts and sleep now and but</font>

271
00:09:28,330 --> 00:09:31,870
I<font color="#E5E5E5"> still probably</font><font color="#CCCCCC"> wouldn't use</font><font color="#E5E5E5"> it as a as</font>

272
00:09:30,040 --> 00:09:34,899
<font color="#E5E5E5">a red team you know gonna so as a red</font>

273
00:09:31,870 --> 00:09:36,610
teaming tool<font color="#CCCCCC"> empire's really good and</font>

274
00:09:34,899 --> 00:09:38,589
but<font color="#E5E5E5"> I've had some issues</font><font color="#CCCCCC"> with proxying</font>

275
00:09:36,610 --> 00:09:41,290
<font color="#E5E5E5">and but it's a great tool got some great</font>

276
00:09:38,589 --> 00:09:43,570
modules<font color="#CCCCCC"> as a</font><font color="#E5E5E5"> natural</font><font color="#CCCCCC"> movement and</font><font color="#E5E5E5"> cobalt</font>

277
00:09:41,290 --> 00:09:44,740
strike it's not<font color="#E5E5E5"> the cheapest but it is</font>

278
00:09:43,570 --> 00:09:51,279
probably you<font color="#CCCCCC"> know one</font><font color="#E5E5E5"> of the best tools</font>

279
00:09:44,740 --> 00:09:53,079
out there for<font color="#E5E5E5"> red teaming so getting in</font>

280
00:09:51,279 --> 00:09:55,480
so<font color="#E5E5E5"> I kind of have like</font><font color="#CCCCCC"> a hundred percent</font>

281
00:09:53,079 --> 00:09:56,770
<font color="#CCCCCC">success rate</font><font color="#E5E5E5"> so far and I guess one of</font>

282
00:09:55,480 --> 00:09:59,110
the main reasons is sort<font color="#CCCCCC"> of proxy where</font>

283
00:09:56,770 --> 00:10:01,300
<font color="#CCCCCC">payloads and kind</font><font color="#E5E5E5"> of making sure</font><font color="#CCCCCC"> that</font>

284
00:09:59,110 --> 00:10:03,640
<font color="#E5E5E5">all</font><font color="#CCCCCC"> your emails or</font><font color="#E5E5E5"> your fishing or</font>

285
00:10:01,300 --> 00:10:05,529
<font color="#E5E5E5">everything is pretty</font><font color="#CCCCCC"> guest trustworthy</font>

286
00:10:03,640 --> 00:10:06,790
<font color="#E5E5E5">and if you can mimic sort of like you</font>

287
00:10:05,529 --> 00:10:08,860
say<font color="#CCCCCC"> nation-state or something like</font><font color="#E5E5E5"> that</font>

288
00:10:06,790 --> 00:10:11,319
then you know<font color="#CCCCCC"> you probably likely to get</font>

289
00:10:08,860 --> 00:10:12,070
in some<font color="#E5E5E5"> of the things that we use sort</font>

290
00:10:11,320 --> 00:10:15,279
<font color="#CCCCCC">of VBA</font>

291
00:10:12,070 --> 00:10:16,750
so macros still work amazingly you can

292
00:10:15,279 --> 00:10:18,540
put PowerShell in macro you can put

293
00:10:16,750 --> 00:10:22,180
<font color="#E5E5E5">standalone executables and macros</font>

294
00:10:18,540 --> 00:10:23,589
documents with<font color="#E5E5E5"> early objects again</font>

295
00:10:22,180 --> 00:10:27,099
<font color="#E5E5E5">another one that's really really</font><font color="#CCCCCC"> good is</font>

296
00:10:23,589 --> 00:10:29,230
hosting Java files in<font color="#E5E5E5"> in an applet form</font>

297
00:10:27,100 --> 00:10:31,120
<font color="#E5E5E5">on websites and sending links to that</font><font color="#CCCCCC"> I</font>

298
00:10:29,230 --> 00:10:34,029
always<font color="#CCCCCC"> selling that</font><font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of thing</font>

299
00:10:31,120 --> 00:10:36,400
because default settings on Java is high

300
00:10:34,029 --> 00:10:37,510
<font color="#E5E5E5">so how I mean it won't accept anything</font>

301
00:10:36,400 --> 00:10:37,970
that's<font color="#E5E5E5"> not signed so if you're doing</font>

302
00:10:37,510 --> 00:10:39,649
that<font color="#E5E5E5"> sorry</font>

303
00:10:37,970 --> 00:10:42,800
<font color="#CCCCCC">I</font><font color="#E5E5E5"> would go ahead</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> get yourself at a</font>

304
00:10:39,649 --> 00:10:44,149
<font color="#CCCCCC">code signing</font><font color="#E5E5E5"> set</font><font color="#CCCCCC"> link files as well</font>

305
00:10:42,800 --> 00:10:45,560
quite a good one recently<font color="#CCCCCC"> that's come</font>

306
00:10:44,149 --> 00:10:47,180
out so<font color="#E5E5E5"> you can send a link file within</font>

307
00:10:45,560 --> 00:10:48,500
<font color="#E5E5E5">an email when they open the</font><font color="#CCCCCC"> link file</font>

308
00:10:47,180 --> 00:10:51,349
it's basically a link to<font color="#E5E5E5"> PowerShell it</font>

309
00:10:48,500 --> 00:10:52,819
<font color="#CCCCCC">wins a bit code click once</font><font color="#E5E5E5"> done quite a</font>

310
00:10:51,350 --> 00:10:54,560
bit click once recently that's also good

311
00:10:52,819 --> 00:10:58,250
as well<font color="#E5E5E5"> especially</font><font color="#CCCCCC"> when you target</font><font color="#E5E5E5"> stuff</font>

312
00:10:54,560 --> 00:10:59,508
like<font color="#E5E5E5"> Citrix</font><font color="#CCCCCC"> and slight cloning again</font>

313
00:10:58,250 --> 00:11:00,769
that's a really really<font color="#CCCCCC"> good one you can</font>

314
00:10:59,509 --> 00:11:02,209
<font color="#CCCCCC">just sort of</font><font color="#E5E5E5"> sending</font><font color="#CCCCCC"> an email</font><font color="#E5E5E5"> saying hi</font>

315
00:11:00,769 --> 00:11:03,680
we've just upgraded the<font color="#CCCCCC"> citrix system</font>

316
00:11:02,209 --> 00:11:05,599
can you all try and<font color="#CCCCCC"> login so you can</font>

317
00:11:03,680 --> 00:11:07,670
capture that<font color="#CCCCCC"> system potentially things</font>

318
00:11:05,600 --> 00:11:08,629
and even<font color="#E5E5E5"> if they using TFA you can get</font>

319
00:11:07,670 --> 00:11:09,459
around that<font color="#E5E5E5"> as well which I'll talk</font>

320
00:11:08,629 --> 00:11:11,689
about

321
00:11:09,459 --> 00:11:13,699
but even sometimes you know<font color="#E5E5E5"> before</font>

322
00:11:11,689 --> 00:11:14,930
you've even sent a<font color="#E5E5E5"> phishing campaign you</font>

323
00:11:13,699 --> 00:11:16,699
might want to just try<font color="#E5E5E5"> like a simple</font>

324
00:11:14,930 --> 00:11:20,329
brute force against the<font color="#E5E5E5"> systems even</font><font color="#CCCCCC"> if</font>

325
00:11:16,699 --> 00:11:22,490
they<font color="#CCCCCC"> even say they</font><font color="#E5E5E5"> are to a Fae so I was</font>

326
00:11:20,329 --> 00:11:24,079
actually testing again<font color="#E5E5E5"> the quite</font>

327
00:11:22,490 --> 00:11:26,629
prestigious<font color="#CCCCCC"> plying and they had a Citrix</font>

328
00:11:24,079 --> 00:11:28,699
<font color="#E5E5E5">to a phase system on the internet which</font>

329
00:11:26,629 --> 00:11:30,889
<font color="#CCCCCC">was quite interesting so could it said</font>

330
00:11:28,699 --> 00:11:32,420
username password and Pascoe doesn't

331
00:11:30,889 --> 00:11:33,920
<font color="#E5E5E5">ours is never going to work</font><font color="#CCCCCC"> well what</font>

332
00:11:32,420 --> 00:11:36,378
<font color="#E5E5E5">the hell I'll try a single brute force</font>

333
00:11:33,920 --> 00:11:39,279
anyway<font color="#E5E5E5"> so using the email addresses</font><font color="#CCCCCC"> that</font>

334
00:11:36,379 --> 00:11:41,720
I got from from the<font color="#E5E5E5"> LinkedIn breach</font>

335
00:11:39,279 --> 00:11:43,309
<font color="#E5E5E5">place they</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> targeted the</font><font color="#CCCCCC"> organisation</font>

336
00:11:41,720 --> 00:11:45,500
sent a<font color="#CCCCCC"> Scott member the passwords now</font>

337
00:11:43,309 --> 00:11:49,430
password one<font color="#E5E5E5"> my cost everyone and then</font>

338
00:11:45,500 --> 00:11:50,959
it's<font color="#E5E5E5"> actually gain so not all accounts</font>

339
00:11:49,430 --> 00:11:52,099
are subjected to<font color="#E5E5E5"> a Fae you actually got</font>

340
00:11:50,959 --> 00:11:54,500
<font color="#CCCCCC">to set that up so it's always always</font>

341
00:11:52,100 --> 00:11:56,209
<font color="#E5E5E5">worth trying that and</font><font color="#CCCCCC"> then actually</font><font color="#E5E5E5"> egg</font>

342
00:11:54,500 --> 00:11:57,980
access to literally<font color="#E5E5E5"> a lot of banking</font>

343
00:11:56,209 --> 00:11:59,689
<font color="#E5E5E5">information and what was interesting I</font>

344
00:11:57,980 --> 00:12:02,209
was kind of hit jackpot<font color="#CCCCCC"> really literally</font>

345
00:11:59,689 --> 00:12:04,099
the credit card data was stored on the

346
00:12:02,209 --> 00:12:06,229
server<font color="#E5E5E5"> external facing on the internet</font>

347
00:12:04,100 --> 00:12:09,220
and got<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to coming behind</font><font color="#E5E5E5"> me now</font>

348
00:12:06,230 --> 00:12:11,569
<font color="#CCCCCC">25,000 credit card details</font><font color="#E5E5E5"> in the clear</font>

349
00:12:09,220 --> 00:12:12,949
<font color="#E5E5E5">so and that was literally I didn't even</font>

350
00:12:11,569 --> 00:12:14,449
<font color="#E5E5E5">have to</font><font color="#CCCCCC"> target</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> organisation I just</font>

351
00:12:12,949 --> 00:12:16,729
sent a quick<font color="#E5E5E5"> brute force from the</font>

352
00:12:14,449 --> 00:12:19,519
internet and go in so you know it is

353
00:12:16,730 --> 00:12:24,350
<font color="#CCCCCC">amazing how</font><font color="#E5E5E5"> simple it can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> even if</font>

354
00:12:19,519 --> 00:12:27,079
they got through a fake and so<font color="#E5E5E5"> I guess</font>

355
00:12:24,350 --> 00:12:28,910
the way to<font color="#E5E5E5"> increase you</font><font color="#CCCCCC"> know the success</font>

356
00:12:27,079 --> 00:12:31,069
<font color="#E5E5E5">rate</font><font color="#CCCCCC"> is increasing the trustworthiness</font>

357
00:12:28,910 --> 00:12:32,660
<font color="#E5E5E5">of all your attachments or your emails</font>

358
00:12:31,069 --> 00:12:34,689
or your links everything<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> and</font>

359
00:12:32,660 --> 00:12:37,459
<font color="#E5E5E5">so what ways</font><font color="#CCCCCC"> you can do that is</font>

360
00:12:34,689 --> 00:12:38,990
legitimizing<font color="#CCCCCC"> sort of code signing</font><font color="#E5E5E5"> certs</font>

361
00:12:37,459 --> 00:12:41,300
<font color="#E5E5E5">purchasing burner phones</font>

362
00:12:38,990 --> 00:12:43,069
so<font color="#E5E5E5"> you basically to get a coat on</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> you</font>

363
00:12:41,300 --> 00:12:44,959
have<font color="#CCCCCC"> a company so we readied a company</font>

364
00:12:43,069 --> 00:12:46,069
with a<font color="#E5E5E5"> P o box and then you can</font>

365
00:12:44,959 --> 00:12:47,689
basically<font color="#E5E5E5"> go ahead and get a</font><font color="#CCCCCC"> code</font>

366
00:12:46,069 --> 00:12:49,399
<font color="#CCCCCC">signing</font><font color="#E5E5E5"> so it's quite a lengthy process</font>

367
00:12:47,689 --> 00:12:50,050
<font color="#E5E5E5">to go through</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> for doing the stuff</font>

368
00:12:49,399 --> 00:12:51,879
<font color="#CCCCCC">engagement</font>

369
00:12:50,050 --> 00:12:53,859
<font color="#CCCCCC">on a sort of</font><font color="#E5E5E5"> mimic a threat to this</font>

370
00:12:51,879 --> 00:12:55,239
nation state<font color="#CCCCCC"> or</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> app or even</font>

371
00:12:53,860 --> 00:12:58,689
activists<font color="#E5E5E5"> so hacktivists you're going to</font>

372
00:12:55,239 --> 00:13:00,129
want probably<font color="#CCCCCC"> a</font><font color="#E5E5E5"> code signing</font><font color="#CCCCCC"> cert also</font>

373
00:12:58,689 --> 00:13:01,959
using<font color="#CCCCCC"> things</font><font color="#E5E5E5"> like let's encrypt it's</font>

374
00:13:00,129 --> 00:13:03,339
like a free SSL certificate<font color="#E5E5E5"> so when they</font>

375
00:13:01,959 --> 00:13:04,689
see the padlock<font color="#CCCCCC"> in the back right corner</font>

376
00:13:03,339 --> 00:13:10,059
they feel<font color="#E5E5E5"> a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> nice warm and fuzzy</font>

377
00:13:04,689 --> 00:13:11,860
so they'll<font color="#E5E5E5"> probably click your link</font><font color="#CCCCCC"> yeah</font>

378
00:13:10,059 --> 00:13:13,988
so as I said<font color="#E5E5E5"> before Java default</font><font color="#CCCCCC"> is high</font>

379
00:13:11,860 --> 00:13:15,610
so it won't run if it's an unsigned

380
00:13:13,989 --> 00:13:18,069
applet so that's me<font color="#E5E5E5"> just an example</font><font color="#CCCCCC"> of</font>

381
00:13:15,610 --> 00:13:19,420
an applet I've used and<font color="#E5E5E5"> basically yeah</font>

382
00:13:18,069 --> 00:13:24,069
<font color="#CCCCCC">it's all signed so it doesn't work very</font>

383
00:13:19,420 --> 00:13:25,179
nice and read errors another interesting

384
00:13:24,069 --> 00:13:27,849
<font color="#CCCCCC">one is while a slight email reputation</font>

385
00:13:25,179 --> 00:13:30,879
<font color="#E5E5E5">so a lot of the</font><font color="#CCCCCC"> guess</font><font color="#E5E5E5"> more prestigious</font>

386
00:13:27,850 --> 00:13:32,949
clients of ours<font color="#E5E5E5"> use quite good</font><font color="#CCCCCC"> websites</font>

387
00:13:30,879 --> 00:13:36,220
filters so they're blocking things like

388
00:13:32,949 --> 00:13:38,589
unknown or recently created IP addresses

389
00:13:36,220 --> 00:13:40,720
<font color="#E5E5E5">or just direct IP addresses</font><font color="#CCCCCC"> so we're</font>

390
00:13:38,589 --> 00:13:42,579
having<font color="#E5E5E5"> to really go ahead and</font><font color="#CCCCCC"> now create</font>

391
00:13:40,720 --> 00:13:44,049
websites on the Internet<font color="#E5E5E5"> and leave them</font>

392
00:13:42,579 --> 00:13:45,638
<font color="#E5E5E5">running for</font><font color="#CCCCCC"> sort</font><font color="#E5E5E5"> of six months just to</font>

393
00:13:44,049 --> 00:13:47,619
get<font color="#E5E5E5"> some reputation</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> as either no</font>

394
00:13:45,639 --> 00:13:48,850
brochure<font color="#E5E5E5"> where or something so if you're</font>

395
00:13:47,619 --> 00:13:50,439
doing<font color="#E5E5E5"> this</font><font color="#CCCCCC"> type</font><font color="#E5E5E5"> of thing against you</font>

396
00:13:48,850 --> 00:13:51,790
know quite a big client<font color="#E5E5E5"> or something</font>

397
00:13:50,439 --> 00:13:53,889
that's<font color="#E5E5E5"> got that got a bit of security</font>

398
00:13:51,790 --> 00:13:55,660
savviness<font color="#E5E5E5"> and then you might want</font><font color="#CCCCCC"> to be</font>

399
00:13:53,889 --> 00:13:57,369
<font color="#CCCCCC">doing</font><font color="#E5E5E5"> this because as you can</font><font color="#CCCCCC"> see at the</font>

400
00:13:55,660 --> 00:13:58,600
bottom there<font color="#E5E5E5"> this is like the area this</font>

401
00:13:57,369 --> 00:14:00,339
is the area they would<font color="#CCCCCC"> get if you send</font>

402
00:13:58,600 --> 00:14:07,269
the<font color="#E5E5E5"> campaign in so you know your</font><font color="#CCCCCC"> stuffs</font>

403
00:14:00,339 --> 00:14:08,559
going to come<font color="#E5E5E5"> back out a good way doing</font>

404
00:14:07,269 --> 00:14:11,110
<font color="#E5E5E5">it is some submitting your site to</font>

405
00:14:08,559 --> 00:14:12,730
Google and there's a<font color="#CCCCCC"> websites</font><font color="#E5E5E5"> URL page</font>

406
00:14:11,110 --> 00:14:14,949
you can<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> submit to as well and</font>

407
00:14:12,730 --> 00:14:16,420
so they get reputation then and then you

408
00:14:14,949 --> 00:14:17,979
won't<font color="#E5E5E5"> have any</font><font color="#CCCCCC"> issues</font><font color="#E5E5E5"> also don't use</font>

409
00:14:16,420 --> 00:14:20,618
dynamic DNS we've seen that blocked a

410
00:14:17,980 --> 00:14:24,749
lot<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> so some of the</font><font color="#E5E5E5"> early days we</font>

411
00:14:20,619 --> 00:14:24,749
started to use<font color="#E5E5E5"> that and</font><font color="#CCCCCC"> again I try to</font>

412
00:14:25,290 --> 00:14:29,559
so another way we often<font color="#CCCCCC"> get in is</font>

413
00:14:27,369 --> 00:14:31,749
targeting so a slight cloning<font color="#E5E5E5"> or</font>

414
00:14:29,559 --> 00:14:34,660
credential harvesting so an interesting

415
00:14:31,749 --> 00:14:37,209
<font color="#CCCCCC">one is Citrix again</font><font color="#E5E5E5"> so when you think</font>

416
00:14:34,660 --> 00:14:39,790
it's got<font color="#CCCCCC"> to FA if you just send in</font>

417
00:14:37,209 --> 00:14:42,118
basically saying yeah we're<font color="#CCCCCC"> just really</font>

418
00:14:39,790 --> 00:14:44,919
<font color="#E5E5E5">Citrix lower and you clone their page</font>

419
00:14:42,119 --> 00:14:46,689
you<font color="#E5E5E5"> actually you can have some nice cool</font>

420
00:14:44,919 --> 00:14:48,100
<font color="#CCCCCC">JavaScript embedded in the</font><font color="#E5E5E5"> website so</font>

421
00:14:46,689 --> 00:14:50,410
<font color="#CCCCCC">that actually uploads their credentials</font>

422
00:14:48,100 --> 00:14:51,579
<font color="#E5E5E5">to a third-party site so literally in</font>

423
00:14:50,410 --> 00:14:53,110
real time I was<font color="#E5E5E5"> getting an each</font>

424
00:14:51,579 --> 00:14:55,149
potential out<font color="#E5E5E5"> and was able to actually</font>

425
00:14:53,110 --> 00:14:57,399
<font color="#E5E5E5">log into the site real you know properly</font>

426
00:14:55,149 --> 00:14:59,049
<font color="#E5E5E5">and if you redirect if you do it right</font>

427
00:14:57,399 --> 00:14:59,810
<font color="#E5E5E5">and</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> redirect the actual clone site</font>

428
00:14:59,049 --> 00:15:01,939
back to the ridge

429
00:14:59,810 --> 00:15:03,920
<font color="#E5E5E5">site and just like get it</font><font color="#CCCCCC"> with a sort of</font>

430
00:15:01,940 --> 00:15:05,600
<font color="#E5E5E5">fair login page or something they</font><font color="#CCCCCC"> login</font>

431
00:15:03,920 --> 00:15:06,620
<font color="#CCCCCC">a second time in getting and at that</font>

432
00:15:05,600 --> 00:15:07,820
time they don't<font color="#E5E5E5"> think anything of it</font>

433
00:15:06,620 --> 00:15:09,590
they<font color="#CCCCCC"> think</font><font color="#E5E5E5"> I'll great micro</font><font color="#CCCCCC"> interest</font>

434
00:15:07,820 --> 00:15:11,720
<font color="#E5E5E5">still work actually</font><font color="#CCCCCC"> you've got</font><font color="#E5E5E5"> foothold</font>

435
00:15:09,590 --> 00:15:13,820
inside the organization<font color="#E5E5E5"> now gonna fold</font>

436
00:15:11,720 --> 00:15:15,230
in<font color="#E5E5E5"> Citrix is kind of the best</font><font color="#CCCCCC"> one</font>

437
00:15:13,820 --> 00:15:16,700
because<font color="#E5E5E5"> you can always break out Citrix</font>

438
00:15:15,230 --> 00:15:17,720
it's a PowerShell<font color="#CCCCCC"> literally I don't</font>

439
00:15:16,700 --> 00:15:19,700
<font color="#E5E5E5">think I've ever</font><font color="#CCCCCC"> been on</font><font color="#E5E5E5"> a test where you</font>

440
00:15:17,720 --> 00:15:26,630
can't break<font color="#E5E5E5"> out Citrix to a command</font>

441
00:15:19,700 --> 00:15:28,610
prompt so when I'm sending<font color="#E5E5E5"> in some sort</font>

442
00:15:26,630 --> 00:15:31,820
of phishing campaigns<font color="#E5E5E5"> clients really</font>

443
00:15:28,610 --> 00:15:33,200
like analytical data<font color="#CCCCCC"> they</font><font color="#E5E5E5"> look graphs so</font>

444
00:15:31,820 --> 00:15:36,529
the way I<font color="#E5E5E5"> kind of do that is have a</font>

445
00:15:33,200 --> 00:15:39,529
three-stage approach so inside<font color="#E5E5E5"> the email</font>

446
00:15:36,529 --> 00:15:41,570
<font color="#E5E5E5">that was send up a web book basically</font><font color="#CCCCCC"> we</font>

447
00:15:39,529 --> 00:15:43,189
<font color="#E5E5E5">shall have a random integer</font><font color="#CCCCCC"> so I can</font>

448
00:15:41,570 --> 00:15:45,260
target and say how<font color="#E5E5E5"> many unique</font><font color="#CCCCCC"> lanta</font>

449
00:15:43,190 --> 00:15:47,300
<font color="#CCCCCC">Minter's ever got back</font><font color="#E5E5E5"> and then also if</font>

450
00:15:45,260 --> 00:15:48,950
I'm<font color="#E5E5E5"> sending in a payload</font><font color="#CCCCCC"> I can put in a</font>

451
00:15:47,300 --> 00:15:50,150
<font color="#E5E5E5">web bug inside the payload and then if</font>

452
00:15:48,950 --> 00:15:52,220
I've got obviously a document with a

453
00:15:50,150 --> 00:15:54,980
macro or<font color="#E5E5E5"> an hourly object if</font><font color="#CCCCCC"> that gets</font>

454
00:15:52,220 --> 00:15:56,180
<font color="#E5E5E5">excu if I've compromised</font><font color="#CCCCCC"> a machine so</font>

455
00:15:54,980 --> 00:15:57,380
you<font color="#CCCCCC"> can have a nice graph at</font><font color="#E5E5E5"> the end</font>

456
00:15:56,180 --> 00:15:59,329
which basically says what here's all the

457
00:15:57,380 --> 00:16:01,310
emails<font color="#E5E5E5"> sent here's how many people open</font>

458
00:15:59,330 --> 00:16:02,720
the emails<font color="#CCCCCC"> here's only documents opened</font>

459
00:16:01,310 --> 00:16:04,250
and<font color="#E5E5E5"> there's a many</font><font color="#CCCCCC"> host would compromise</font>

460
00:16:02,720 --> 00:16:05,540
<font color="#CCCCCC">just quite a nice graph when you're</font>

461
00:16:04,250 --> 00:16:07,010
doing this type<font color="#E5E5E5"> of</font><font color="#CCCCCC"> engagement so they</font>

462
00:16:05,540 --> 00:16:08,329
you know they can use this and<font color="#E5E5E5"> then go</font>

463
00:16:07,010 --> 00:16:10,339
<font color="#E5E5E5">write we need to now perform security</font>

464
00:16:08,330 --> 00:16:13,190
<font color="#CCCCCC">work and security awareness training off</font>

465
00:16:10,339 --> 00:16:14,839
the back of<font color="#CCCCCC"> your engagement</font><font color="#E5E5E5"> as you can</font>

466
00:16:13,190 --> 00:16:16,910
see<font color="#E5E5E5"> there in my log is obviously like</font>

467
00:16:14,839 --> 00:16:18,230
one dot PNG and<font color="#E5E5E5"> then the ID but also</font>

468
00:16:16,910 --> 00:16:20,510
it's good as well because you<font color="#CCCCCC"> know who's</font>

469
00:16:18,230 --> 00:16:22,400
open your email and so you can say

470
00:16:20,510 --> 00:16:24,260
specifically that<font color="#E5E5E5"> user not that we you</font>

471
00:16:22,400 --> 00:16:26,300
know condone<font color="#E5E5E5"> source telling people who</font>

472
00:16:24,260 --> 00:16:27,980
who the unlucky<font color="#CCCCCC"> people are they clicked</font>

473
00:16:26,300 --> 00:16:32,180
<font color="#E5E5E5">our links but it's good to have that</font>

474
00:16:27,980 --> 00:16:33,710
<font color="#CCCCCC">there anyway so UNC path hopefully you</font>

475
00:16:32,180 --> 00:16:35,930
went to Neal's talk<font color="#CCCCCC"> where he talked more</font>

476
00:16:33,710 --> 00:16:37,760
<font color="#E5E5E5">on this and</font><font color="#CCCCCC"> basically it's a</font><font color="#E5E5E5"> really good</font>

477
00:16:35,930 --> 00:16:39,680
way getting inside an organization<font color="#E5E5E5"> again</font>

478
00:16:37,760 --> 00:16:41,210
a lot<font color="#E5E5E5"> of the clients</font><font color="#CCCCCC"> that are I</font><font color="#E5E5E5"> guess</font>

479
00:16:39,680 --> 00:16:42,319
more developed<font color="#E5E5E5"> and</font><font color="#CCCCCC"> have got</font><font color="#E5E5E5"> sort of good</font>

480
00:16:41,210 --> 00:16:44,870
firewalls and<font color="#E5E5E5"> things probably won't</font>

481
00:16:42,320 --> 00:16:46,700
allow this but if you<font color="#E5E5E5"> have a UNC path</font>

482
00:16:44,870 --> 00:16:48,230
<font color="#E5E5E5">inside of an email you</font><font color="#CCCCCC"> can actually</font>

483
00:16:46,700 --> 00:16:51,470
<font color="#CCCCCC">capture the hash the</font><font color="#E5E5E5"> NC</font><font color="#CCCCCC"> lamb hash</font>

484
00:16:48,230 --> 00:16:52,820
providing the allow so we've done this

485
00:16:51,470 --> 00:16:54,350
on<font color="#E5E5E5"> loads of engagements and you can just</font>

486
00:16:52,820 --> 00:16:56,930
<font color="#CCCCCC">play to get</font><font color="#E5E5E5"> a hash so it's you get the</font>

487
00:16:54,350 --> 00:16:58,279
SMB ntlm<font color="#E5E5E5"> challenge hash so again you can</font>

488
00:16:56,930 --> 00:16:59,810
crack<font color="#CCCCCC"> that and use that on single factor</font>

489
00:16:58,279 --> 00:17:01,189
systems on the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> so it's a really</font>

490
00:16:59,810 --> 00:17:02,150
<font color="#E5E5E5">good way of sending</font><font color="#CCCCCC"> it you know sending</font>

491
00:17:01,190 --> 00:17:03,740
in

492
00:17:02,150 --> 00:17:07,129
with a<font color="#E5E5E5"> malicious - of attachment or</font>

493
00:17:03,740 --> 00:17:08,839
something the interesting one<font color="#E5E5E5"> melissa is</font>

494
00:17:07,130 --> 00:17:10,069
like even if you're<font color="#E5E5E5"> targeting like maybe</font>

495
00:17:08,839 --> 00:17:11,958
a bank or something<font color="#CCCCCC"> which you know</font><font color="#E5E5E5"> this</font>

496
00:17:10,069 --> 00:17:13,579
<font color="#E5E5E5">isn't going to be allowed if people are</font>

497
00:17:11,959 --> 00:17:15,650
<font color="#E5E5E5">working from home basically and they</font>

498
00:17:13,579 --> 00:17:17,448
don't always have<font color="#E5E5E5"> a no-slip VPN then</font>

499
00:17:15,650 --> 00:17:20,360
basically<font color="#E5E5E5"> they'll be using BT home hub</font>

500
00:17:17,449 --> 00:17:21,380
scrappy firewalls<font color="#CCCCCC"> and it's an app</font><font color="#E5E5E5"> for</font>

501
00:17:20,359 --> 00:17:23,300
<font color="#CCCCCC">provide straight</font><font color="#E5E5E5"> out man</font>

502
00:17:21,380 --> 00:17:25,430
so you know<font color="#E5E5E5"> it's we're thinking even it</font>

503
00:17:23,300 --> 00:17:30,620
against the more sort<font color="#E5E5E5"> of security aware</font>

504
00:17:25,430 --> 00:17:32,600
<font color="#CCCCCC">clients to put this type of</font><font color="#E5E5E5"> attack in so</font>

505
00:17:30,620 --> 00:17:33,709
you can base it<font color="#CCCCCC"> is and that's</font><font color="#E5E5E5"> what</font>

506
00:17:32,600 --> 00:17:35,540
module do<font color="#E5E5E5"> for I</font><font color="#CCCCCC"> don't always do it</font>

507
00:17:33,710 --> 00:17:36,530
manually<font color="#CCCCCC"> but</font><font color="#E5E5E5"> the network module provide</font>

508
00:17:35,540 --> 00:17:40,460
it a document<font color="#E5E5E5"> and it'll basically</font>

509
00:17:36,530 --> 00:17:43,030
<font color="#E5E5E5">recognize it with</font><font color="#CCCCCC"> the UNC path once you</font>

510
00:17:40,460 --> 00:17:44,900
<font color="#E5E5E5">crack the hashes you can log into</font><font color="#CCCCCC"> OWA</font>

511
00:17:43,030 --> 00:17:47,059
<font color="#E5E5E5">literally the amount</font><font color="#CCCCCC"> of times I've typed</font>

512
00:17:44,900 --> 00:17:49,490
password<font color="#E5E5E5"> in OWA and you get like lots of</font>

513
00:17:47,059 --> 00:17:52,700
information<font color="#CCCCCC"> back</font><font color="#E5E5E5"> or Wi-Fi</font><font color="#CCCCCC"> people often</font>

514
00:17:49,490 --> 00:17:53,900
<font color="#CCCCCC">saying the Wi-Fi code out over</font><font color="#E5E5E5"> 30 outlet</font>

515
00:17:52,700 --> 00:17:55,640
and<font color="#E5E5E5"> so you can use space</font><font color="#CCCCCC"> if you're</font>

516
00:17:53,900 --> 00:17:57,170
outside<font color="#E5E5E5"> the organization hook up to the</font>

517
00:17:55,640 --> 00:17:58,580
<font color="#CCCCCC">Y for a new access to the network so</font>

518
00:17:57,170 --> 00:18:00,740
these are the ways<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can kind of red</font>

519
00:17:58,580 --> 00:18:04,460
team the organization<font color="#CCCCCC"> again without even</font>

520
00:18:00,740 --> 00:18:09,410
really<font color="#E5E5E5"> sending anything in again another</font>

521
00:18:04,460 --> 00:18:11,059
one<font color="#E5E5E5"> link we often try and log</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> also</font>

522
00:18:09,410 --> 00:18:14,090
you can if you actually<font color="#E5E5E5"> managed</font><font color="#CCCCCC"> to get</font>

523
00:18:11,059 --> 00:18:15,290
into outlook<font color="#E5E5E5"> as some user you can kind</font>

524
00:18:14,090 --> 00:18:16,730
<font color="#E5E5E5">of reply to also if they've got</font>

525
00:18:15,290 --> 00:18:18,860
<font color="#E5E5E5">company-wide email address you reply to</font>

526
00:18:16,730 --> 00:18:20,690
wall<font color="#CCCCCC"> add at UNC in there and you'll</font><font color="#E5E5E5"> get</font>

527
00:18:18,860 --> 00:18:23,000
about<font color="#E5E5E5"> well however big the companies you</font>

528
00:18:20,690 --> 00:18:25,220
get<font color="#CCCCCC"> a thousand thousand UNC paths coming</font>

529
00:18:23,000 --> 00:18:29,000
<font color="#CCCCCC">out at you with a thousand hashes</font><font color="#E5E5E5"> so</font>

530
00:18:25,220 --> 00:18:31,429
that's another good way of<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> it so</font>

531
00:18:29,000 --> 00:18:33,559
often<font color="#CCCCCC"> we send map origin macros are</font>

532
00:18:31,429 --> 00:18:35,330
usually by<font color="#CCCCCC"> default</font><font color="#E5E5E5"> that are disabled but</font>

533
00:18:33,559 --> 00:18:36,770
<font color="#E5E5E5">they do have a notification so as long</font>

534
00:18:35,330 --> 00:18:39,020
<font color="#CCCCCC">as you can</font><font color="#E5E5E5"> put something in the document</font>

535
00:18:36,770 --> 00:18:42,050
<font color="#E5E5E5">for</font><font color="#CCCCCC"> example like this and say oh you</font>

536
00:18:39,020 --> 00:18:43,520
<font color="#E5E5E5">know to to enable the content in this</font>

537
00:18:42,050 --> 00:18:44,750
<font color="#E5E5E5">document please click enable content and</font>

538
00:18:43,520 --> 00:18:46,460
obviously that will enable your macro

539
00:18:44,750 --> 00:18:47,630
and give you<font color="#E5E5E5"> a foothold</font><font color="#CCCCCC"> but they think</font>

540
00:18:46,460 --> 00:18:49,910
<font color="#E5E5E5">nothing's happened and then you make the</font>

541
00:18:47,630 --> 00:18:52,460
<font color="#CCCCCC">image change or something like that so</font>

542
00:18:49,910 --> 00:18:54,410
<font color="#CCCCCC">again what I always</font><font color="#E5E5E5"> do is CV so I've got</font>

543
00:18:52,460 --> 00:18:57,110
a nice little<font color="#CCCCCC"> CV here that's not me</font>

544
00:18:54,410 --> 00:18:58,670
obviously<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it looks encrypted so I've</font>

545
00:18:57,110 --> 00:19:01,939
put a little image at the top<font color="#CCCCCC"> it say oh</font>

546
00:18:58,670 --> 00:19:03,410
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> fault faking coding please click</font>

547
00:19:01,940 --> 00:19:04,400
enable<font color="#E5E5E5"> content to show the image and</font>

548
00:19:03,410 --> 00:19:10,790
then<font color="#E5E5E5"> the image appears and they're like</font>

549
00:19:04,400 --> 00:19:11,929
oh<font color="#E5E5E5"> yeah yeah it's all works as I said</font>

550
00:19:10,790 --> 00:19:13,730
before click once is<font color="#E5E5E5"> really good</font>

551
00:19:11,929 --> 00:19:16,430
especially retarding something like

552
00:19:13,730 --> 00:19:20,000
<font color="#CCCCCC">Citrix I took a lot of</font><font color="#E5E5E5"> that ship so that</font>

553
00:19:16,430 --> 00:19:22,250
<font color="#CCCCCC">and but when you</font><font color="#E5E5E5"> basically first go to</font>

554
00:19:20,000 --> 00:19:23,690
Citrix<font color="#CCCCCC"> Astra to install something</font><font color="#E5E5E5"> so</font>

555
00:19:22,250 --> 00:19:24,890
that's why I clip once<font color="#E5E5E5"> works really well</font>

556
00:19:23,690 --> 00:19:26,600
because<font color="#E5E5E5"> as soon as you get</font><font color="#CCCCCC"> onto</font><font color="#E5E5E5"> this</font>

557
00:19:24,890 --> 00:19:28,610
page if you clone a website something

558
00:19:26,600 --> 00:19:30,679
<font color="#E5E5E5">and</font><font color="#CCCCCC"> send in an email it once they click</font>

559
00:19:28,610 --> 00:19:32,840
click install<font color="#E5E5E5"> it'll actually pop</font><font color="#CCCCCC"> up you</font>

560
00:19:30,680 --> 00:19:34,280
pop<font color="#CCCCCC"> up the box</font><font color="#E5E5E5"> and go host check</font><font color="#CCCCCC"> it yeah</font>

561
00:19:32,840 --> 00:19:35,300
<font color="#E5E5E5">oh I'll run that because I need</font><font color="#CCCCCC"> to do</font>

562
00:19:34,280 --> 00:19:37,190
that<font color="#E5E5E5"> because it always does that anyway</font>

563
00:19:35,300 --> 00:19:39,409
<font color="#CCCCCC">so it's you know just a loose</font><font color="#E5E5E5"> amaizing</font>

564
00:19:37,190 --> 00:19:43,850
<font color="#E5E5E5">your attacks to make them make them feel</font>

565
00:19:39,410 --> 00:19:45,200
warm and fuzzy always anonymizer traffic

566
00:19:43,850 --> 00:19:47,780
so depending on what for actor<font color="#CCCCCC"> you're</font>

567
00:19:45,200 --> 00:19:48,980
trying to mimic<font color="#E5E5E5"> in these engagements</font><font color="#CCCCCC"> you</font>

568
00:19:47,780 --> 00:19:50,720
don't want them to like look<font color="#E5E5E5"> up the</font>

569
00:19:48,980 --> 00:19:52,130
address that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> cg traffic go and say</font>

570
00:19:50,720 --> 00:19:54,290
nephew<font color="#CCCCCC"> they're like all</font><font color="#E5E5E5"> right now it's a</font>

571
00:19:52,130 --> 00:19:56,240
pen test<font color="#CCCCCC"> right we don't on that and so</font>

572
00:19:54,290 --> 00:19:58,070
always it naanum eyes it so<font color="#CCCCCC"> ways you can</font>

573
00:19:56,240 --> 00:19:59,840
do this<font color="#CCCCCC"> is by VPS azure around the world</font>

574
00:19:58,070 --> 00:20:01,909
so<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> even put</font><font color="#E5E5E5"> them in China</font><font color="#CCCCCC"> Russia</font>

575
00:19:59,840 --> 00:20:03,740
<font color="#E5E5E5">and</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> places like that</font><font color="#CCCCCC"> so you can use</font>

576
00:20:01,910 --> 00:20:05,510
other simple<font color="#CCCCCC"> iptables rules with just</font>

577
00:20:03,740 --> 00:20:07,250
four words<font color="#E5E5E5"> 18</font><font color="#CCCCCC"> 4 3 back</font><font color="#E5E5E5"> to your server</font>

578
00:20:05,510 --> 00:20:08,960
<font color="#CCCCCC">just completely</font><font color="#E5E5E5"> anonymize it the traffic</font>

579
00:20:07,250 --> 00:20:10,280
<font color="#E5E5E5">or</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> create like some funky</font>

580
00:20:08,960 --> 00:20:11,930
scripts which<font color="#E5E5E5"> we've got some Python</font>

581
00:20:10,280 --> 00:20:13,310
scripts<font color="#E5E5E5"> which basically says if it's</font>

582
00:20:11,930 --> 00:20:15,080
legitimate web traffic someone just

583
00:20:13,310 --> 00:20:16,399
wants to see if this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a dodgy site it</font>

584
00:20:15,080 --> 00:20:18,290
goes and puts them off to the website

585
00:20:16,400 --> 00:20:23,450
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you created or</font><font color="#CCCCCC"> if it's</font><font color="#E5E5E5"> C to traffic</font>

586
00:20:18,290 --> 00:20:24,080
put it back to my<font color="#CCCCCC"> C 2 server so</font><font color="#E5E5E5"> putting</font>

587
00:20:23,450 --> 00:20:26,270
<font color="#E5E5E5">all this together</font>

588
00:20:24,080 --> 00:20:30,830
one day in the red<font color="#CCCCCC"> teaming world I</font><font color="#E5E5E5"> sent</font>

589
00:20:26,270 --> 00:20:32,540
<font color="#E5E5E5">my CV into the recruitment company I've</font>

590
00:20:30,830 --> 00:20:35,780
got my<font color="#E5E5E5"> one dot PNG back which so</font>

591
00:20:32,540 --> 00:20:38,930
unusually<font color="#CCCCCC"> open email</font><font color="#E5E5E5"> got the attachment</font>

592
00:20:35,780 --> 00:20:40,610
<font color="#E5E5E5">back and I got</font><font color="#CCCCCC"> a Mac Pro executed so I</font>

593
00:20:38,930 --> 00:20:42,710
did I actually have UNC in this one

594
00:20:40,610 --> 00:20:44,750
which<font color="#E5E5E5"> was</font><font color="#CCCCCC"> interesting and so the UNC</font><font color="#E5E5E5"> was</font>

595
00:20:42,710 --> 00:20:45,770
blocked by default<font color="#CCCCCC"> which I</font><font color="#E5E5E5"> kind of</font>

596
00:20:44,750 --> 00:20:48,080
thought it<font color="#E5E5E5"> would be but what was really</font>

597
00:20:45,770 --> 00:20:49,070
<font color="#E5E5E5">interesting is never</font><font color="#CCCCCC"> fingers enter</font>

598
00:20:48,080 --> 00:20:51,290
<font color="#CCCCCC">boyd's bolt is here</font>

599
00:20:49,070 --> 00:20:52,700
<font color="#CCCCCC">Enterprise</font><font color="#E5E5E5"> evolved some reason sent me a</font>

600
00:20:51,290 --> 00:20:54,710
hash and<font color="#E5E5E5"> I was like well where did this</font>

601
00:20:52,700 --> 00:20:57,050
even come from<font color="#E5E5E5"> and it was a domain admin</font>

602
00:20:54,710 --> 00:20:58,490
<font color="#E5E5E5">so it's like zero to here in about five</font>

603
00:20:57,050 --> 00:20:59,690
<font color="#CCCCCC">minutes</font><font color="#E5E5E5"> and I was like what I've</font>

604
00:20:58,490 --> 00:21:01,520
actually got<font color="#CCCCCC"> four all in the</font>

605
00:20:59,690 --> 00:21:05,420
organization with<font color="#E5E5E5"> domain album in five</font>

606
00:21:01,520 --> 00:21:06,889
minutes<font color="#CCCCCC"> Yoho</font><font color="#E5E5E5"> thanks very much so again</font>

607
00:21:05,420 --> 00:21:08,420
another<font color="#E5E5E5"> another really good</font><font color="#CCCCCC"> reason to</font>

608
00:21:06,890 --> 00:21:09,860
use<font color="#CCCCCC"> U</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> C even if you think it</font><font color="#E5E5E5"> is what</font>

609
00:21:08,420 --> 00:21:13,780
you might get some<font color="#CCCCCC"> random things like</font><font color="#E5E5E5"> I</font>

610
00:21:09,860 --> 00:21:13,780
had and it's really<font color="#E5E5E5"> really interesting</font>

611
00:21:14,770 --> 00:21:18,530
<font color="#E5E5E5">yeah so that's I</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> basically where</font><font color="#CCCCCC"> I</font>

612
00:21:16,790 --> 00:21:19,520
was I was able<font color="#E5E5E5"> to access all the data</font>

613
00:21:18,530 --> 00:21:21,200
<font color="#CCCCCC">set there and everything from</font><font color="#E5E5E5"> where I</font>

614
00:21:19,520 --> 00:21:21,910
was<font color="#E5E5E5"> from</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> initial foothold</font><font color="#CCCCCC"> with the</font>

615
00:21:21,200 --> 00:21:25,280
<font color="#CCCCCC">a creds</font>

616
00:21:21,910 --> 00:21:26,530
so I was able to get screenshots<font color="#E5E5E5"> access</font>

617
00:21:25,280 --> 00:21:27,879
<font color="#E5E5E5">to payroll</font>

618
00:21:26,530 --> 00:21:31,110
and what better<font color="#CCCCCC"> way to show</font><font color="#E5E5E5"> risk than</font>

619
00:21:27,880 --> 00:21:36,460
just show the CEOs<font color="#E5E5E5"> payslip on the report</font>

620
00:21:31,110 --> 00:21:38,879
she<font color="#E5E5E5"> didn't a lot by the way but you know</font>

621
00:21:36,460 --> 00:21:41,020
<font color="#CCCCCC">Michelle</font><font color="#E5E5E5"> is only the beginning</font>

622
00:21:38,880 --> 00:21:42,640
sure it's great<font color="#E5E5E5"> to get lots of shells</font>

623
00:21:41,020 --> 00:21:44,650
<font color="#E5E5E5">yeah it's a dick measuring contest yeah</font>

624
00:21:42,640 --> 00:21:46,270
<font color="#E5E5E5">I've got 320</font><font color="#CCCCCC"> shells</font><font color="#E5E5E5"> will do but to be</font>

625
00:21:44,650 --> 00:21:48,520
honest it's it's only the initial

626
00:21:46,270 --> 00:21:49,960
<font color="#CCCCCC">foothold inside</font><font color="#E5E5E5"> the organization</font><font color="#CCCCCC"> so it's</font>

627
00:21:48,520 --> 00:21:51,220
the lateral<font color="#E5E5E5"> movement and</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> and the</font>

628
00:21:49,960 --> 00:21:54,910
crown jewels which is where the<font color="#E5E5E5"> real</font>

629
00:21:51,220 --> 00:21:56,440
sort of red<font color="#CCCCCC"> teaming comes in</font><font color="#E5E5E5"> but before</font>

630
00:21:54,910 --> 00:21:58,450
<font color="#E5E5E5">that happens I guess we need</font><font color="#CCCCCC"> to be you</font>

631
00:21:56,440 --> 00:21:59,740
know aware where we are<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> forget</font>

632
00:21:58,450 --> 00:22:01,090
<font color="#CCCCCC">when</font><font color="#E5E5E5"> you do this type of engagement you</font>

633
00:21:59,740 --> 00:22:02,320
don't in blind so you don't know what

634
00:22:01,090 --> 00:22:03,879
the<font color="#E5E5E5"> organization looks like you don't</font>

635
00:22:02,320 --> 00:22:05,260
know what the network layer is you don't

636
00:22:03,880 --> 00:22:06,940
even<font color="#CCCCCC"> know if you've</font><font color="#E5E5E5"> actually compromised</font>

637
00:22:05,260 --> 00:22:08,680
the right machine you might be on Bob's

638
00:22:06,940 --> 00:22:10,210
home machine but<font color="#E5E5E5"> you know so you need to</font>

639
00:22:08,680 --> 00:22:12,460
just<font color="#CCCCCC"> ensure them you know doing the</font>

640
00:22:10,210 --> 00:22:14,440
right<font color="#E5E5E5"> thing here so make sure your</font>

641
00:22:12,460 --> 00:22:17,050
implants landed<font color="#E5E5E5"> on the correct</font><font color="#CCCCCC"> system be</font>

642
00:22:14,440 --> 00:22:20,080
aware your surroundings<font color="#E5E5E5"> is it on</font><font color="#CCCCCC"> a</font>

643
00:22:17,050 --> 00:22:22,360
desktop isn't on a VDI is on a laptop is

644
00:22:20,080 --> 00:22:24,550
the<font color="#E5E5E5"> system joined to a domain what's the</font>

645
00:22:22,360 --> 00:22:27,459
system<font color="#E5E5E5"> uptime what's the date what's the</font>

646
00:22:24,550 --> 00:22:29,889
language<font color="#E5E5E5"> even so I was on a job once and</font>

647
00:22:27,460 --> 00:22:32,140
I<font color="#E5E5E5"> landed on</font><font color="#CCCCCC"> it and ending</font><font color="#E5E5E5"> Algeria</font>

648
00:22:29,890 --> 00:22:34,030
randomly<font color="#E5E5E5"> and I was trying to add my user</font>

649
00:22:32,140 --> 00:22:35,350
to<font color="#CCCCCC"> the local admin group</font><font color="#E5E5E5"> and it was like</font>

650
00:22:34,030 --> 00:22:36,879
no it's not<font color="#CCCCCC"> working not</font><font color="#E5E5E5"> working I was</font>

651
00:22:35,350 --> 00:22:38,560
pulling my hair out<font color="#E5E5E5"> about 30 minutes and</font>

652
00:22:36,880 --> 00:22:40,660
it's administered towards or something

653
00:22:38,560 --> 00:22:44,040
in<font color="#E5E5E5"> French so just knowing that little</font>

654
00:22:40,660 --> 00:22:47,140
<font color="#CCCCCC">difference makes goes a long way really</font>

655
00:22:44,040 --> 00:22:50,379
so persistence Ryan Michael<font color="#E5E5E5"> so here's</font>

656
00:22:47,140 --> 00:22:52,630
<font color="#E5E5E5">another little story so again we applied</font>

657
00:22:50,380 --> 00:22:54,370
for<font color="#CCCCCC"> a job at the top of the CV we had</font>

658
00:22:52,630 --> 00:22:56,440
our boat<font color="#CCCCCC"> being a phone number</font><font color="#E5E5E5"> and a guy</font>

659
00:22:54,370 --> 00:22:58,389
came and named Michael cause the phone<font color="#CCCCCC"> -</font>

660
00:22:56,440 --> 00:23:02,020
three<font color="#E5E5E5"> of us in the room at the time and</font>

661
00:22:58,390 --> 00:23:03,610
<font color="#E5E5E5">we were a bit</font><font color="#CCCCCC"> nervous</font><font color="#E5E5E5"> Ben was going on</font>

662
00:23:02,020 --> 00:23:04,810
<font color="#CCCCCC">so he was like no</font><font color="#E5E5E5"> you answer it you're</font>

663
00:23:03,610 --> 00:23:05,740
<font color="#CCCCCC">onto it you're</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> but so anyway</font><font color="#E5E5E5"> I</font>

664
00:23:04,810 --> 00:23:08,139
answered it

665
00:23:05,740 --> 00:23:10,480
so you said oh<font color="#CCCCCC"> hello we've got your CV</font>

666
00:23:08,140 --> 00:23:12,040
and yeah<font color="#CCCCCC"> yes I said but this seems</font><font color="#E5E5E5"> to be</font>

667
00:23:10,480 --> 00:23:13,390
a<font color="#E5E5E5"> problem with it there's there's a</font>

668
00:23:12,040 --> 00:23:14,820
<font color="#CCCCCC">picture but</font><font color="#E5E5E5"> it I think it's like all</font>

669
00:23:13,390 --> 00:23:17,020
encrypted

670
00:23:14,820 --> 00:23:18,730
sorry yeah it's a<font color="#CCCCCC"> problem with</font><font color="#E5E5E5"> it is</font>

671
00:23:17,020 --> 00:23:21,100
there an<font color="#CCCCCC"> enabled mobile content book</font>

672
00:23:18,730 --> 00:23:22,570
yeah yeah click it<font color="#E5E5E5"> I know I got a shower</font>

673
00:23:21,100 --> 00:23:24,100
<font color="#CCCCCC">so it's pretty</font><font color="#E5E5E5"> happy and I was like did</font>

674
00:23:22,570 --> 00:23:25,179
<font color="#E5E5E5">the image shows that yeah all about</font><font color="#CCCCCC"> yeah</font>

675
00:23:24,100 --> 00:23:28,120
thank you<font color="#E5E5E5"> thank you very much thank you</font>

676
00:23:25,180 --> 00:23:29,590
<font color="#CCCCCC">so</font><font color="#E5E5E5"> anyhow I got a nice little shell so</font>

677
00:23:28,120 --> 00:23:32,379
the reason why I'm saying this<font color="#E5E5E5"> we've got</font>

678
00:23:29,590 --> 00:23:33,429
an implant<font color="#CCCCCC"> in the organisation so the</font>

679
00:23:32,380 --> 00:23:36,280
next thing we<font color="#E5E5E5"> did was</font><font color="#CCCCCC"> try to</font><font color="#E5E5E5"> install</font>

680
00:23:33,430 --> 00:23:39,190
persistence<font color="#E5E5E5"> so unfortunately</font><font color="#CCCCCC"> for us it</font>

681
00:23:36,280 --> 00:23:41,170
failed<font color="#E5E5E5"> so</font><font color="#CCCCCC"> reinstalled it was on a</font><font color="#E5E5E5"> VDI</font>

682
00:23:39,190 --> 00:23:43,200
and we did it in<font color="#E5E5E5"> the registry but</font><font color="#CCCCCC"> we put</font>

683
00:23:41,170 --> 00:23:45,490
the<font color="#CCCCCC"> bat-file on the seat in the C Drive</font>

684
00:23:43,200 --> 00:23:48,700
<font color="#CCCCCC">so that when the guy then log back</font><font color="#E5E5E5"> in</font>

685
00:23:45,490 --> 00:23:50,650
the next<font color="#E5E5E5"> day he got a random</font><font color="#CCCCCC"> VDI so we</font>

686
00:23:48,700 --> 00:23:53,560
thought<font color="#E5E5E5"> okay maybe I'll try sending him</font>

687
00:23:50,650 --> 00:23:54,970
the document<font color="#CCCCCC"> again so we sent</font><font color="#E5E5E5"> like</font>

688
00:23:53,560 --> 00:23:56,830
<font color="#CCCCCC">michael</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> cv and said oh you know i</font>

689
00:23:54,970 --> 00:23:58,750
<font color="#CCCCCC">made a few updates would you mind just</font>

690
00:23:56,830 --> 00:24:01,510
opening it<font color="#CCCCCC"> and PDF in it sending</font><font color="#E5E5E5"> it back</font>

691
00:23:58,750 --> 00:24:02,560
we thought you<font color="#E5E5E5"> might not any wait shell</font>

692
00:24:01,510 --> 00:24:03,790
comes back in yes

693
00:24:02,560 --> 00:24:06,370
got another foothold inside<font color="#CCCCCC"> of the</font>

694
00:24:03,790 --> 00:24:07,450
organization<font color="#E5E5E5"> anyway second time we</font>

695
00:24:06,370 --> 00:24:10,659
<font color="#E5E5E5">thought</font><font color="#CCCCCC"> why you</font><font color="#E5E5E5"> need to nail this this</font>

696
00:24:07,450 --> 00:24:11,890
time we need<font color="#CCCCCC"> the persistence so we're</font>

697
00:24:10,660 --> 00:24:13,330
like<font color="#CCCCCC"> yeah right we put it</font><font color="#E5E5E5"> here put</font><font color="#CCCCCC"> it in</font>

698
00:24:11,890 --> 00:24:15,370
the registry blah blah blah<font color="#E5E5E5"> anyway for</font>

699
00:24:13,330 --> 00:24:18,970
another<font color="#E5E5E5"> reason it failed who thought no</font>

700
00:24:15,370 --> 00:24:20,919
we can't send a 30<font color="#E5E5E5"> not but yeah he</font>

701
00:24:18,970 --> 00:24:22,990
clicked the email<font color="#E5E5E5"> and we've gotten</font>

702
00:24:20,920 --> 00:24:24,220
assistance again so I guess the

703
00:24:22,990 --> 00:24:25,540
important<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> take</font><font color="#CCCCCC"> away is you know</font>

704
00:24:24,220 --> 00:24:27,970
you might<font color="#E5E5E5"> not always be lucky</font><font color="#CCCCCC"> and get a</font>

705
00:24:25,540 --> 00:24:29,260
guy like<font color="#CCCCCC"> Michael inside the organization</font>

706
00:24:27,970 --> 00:24:30,310
<font color="#E5E5E5">so just make</font><font color="#CCCCCC"> sure when you're running</font>

707
00:24:29,260 --> 00:24:32,440
<font color="#CCCCCC">with assistance put it in the right</font>

708
00:24:30,310 --> 00:24:33,629
place and<font color="#E5E5E5"> check if you want to VDI or</font>

709
00:24:32,440 --> 00:24:37,050
something like<font color="#E5E5E5"> that</font>

710
00:24:33,630 --> 00:24:39,280
so when<font color="#E5E5E5"> doing this stuff engagement</font>

711
00:24:37,050 --> 00:24:42,070
there's four ways that<font color="#CCCCCC"> I think you</font><font color="#E5E5E5"> can</font>

712
00:24:39,280 --> 00:24:43,810
reliably get persistence<font color="#E5E5E5"> so if you're in</font>

713
00:24:42,070 --> 00:24:45,340
New Zealand<font color="#E5E5E5"> and I guess the best</font><font color="#CCCCCC"> way for</font>

714
00:24:43,810 --> 00:24:47,080
me<font color="#E5E5E5"> is registry</font><font color="#CCCCCC"> one key so whenever they</font>

715
00:24:45,340 --> 00:24:48,790
log out and log back<font color="#E5E5E5"> in something what</font>

716
00:24:47,080 --> 00:24:50,409
is in<font color="#E5E5E5"> that Reggie one key will run so if</font>

717
00:24:48,790 --> 00:24:51,909
you point<font color="#E5E5E5"> that to a bat file or even</font>

718
00:24:50,410 --> 00:24:53,770
<font color="#CCCCCC">PowerShell directly in there it will run</font>

719
00:24:51,910 --> 00:24:55,540
if you've<font color="#CCCCCC"> actually managed to escalate</font>

720
00:24:53,770 --> 00:24:58,090
the system you can<font color="#CCCCCC"> do the same thing on</font>

721
00:24:55,540 --> 00:25:01,180
<font color="#E5E5E5">the hklm which will basically</font><font color="#CCCCCC"> once the</font>

722
00:24:58,090 --> 00:25:02,709
machine boots in children<font color="#CCCCCC"> schedule tasks</font>

723
00:25:01,180 --> 00:25:04,480
<font color="#E5E5E5">so you can create a schedule</font><font color="#CCCCCC"> at a store</font>

724
00:25:02,710 --> 00:25:05,950
<font color="#E5E5E5">in every 24 hours or every 60</font><font color="#CCCCCC"> minutes or</font>

725
00:25:04,480 --> 00:25:07,450
whatever<font color="#CCCCCC"> you want that's another really</font>

726
00:25:05,950 --> 00:25:08,740
good way doing<font color="#E5E5E5"> it sometimes in</font>

727
00:25:07,450 --> 00:25:09,130
environments<font color="#CCCCCC"> that is actually locked</font>

728
00:25:08,740 --> 00:25:10,780
down

729
00:25:09,130 --> 00:25:12,430
<font color="#E5E5E5">so you can't you should your</font><font color="#CCCCCC"> tasks but I</font>

730
00:25:10,780 --> 00:25:15,790
find more times or not you can do that

731
00:25:12,430 --> 00:25:17,470
<font color="#E5E5E5">approach and</font><font color="#CCCCCC"> also when if you do our</font>

732
00:25:15,790 --> 00:25:18,700
system on<font color="#E5E5E5"> on a box you can</font><font color="#CCCCCC"> actually</font>

733
00:25:17,470 --> 00:25:21,790
create service which is one of<font color="#E5E5E5"> the best</font>

734
00:25:18,700 --> 00:25:23,470
and most<font color="#CCCCCC"> effective methods harmed or has</font>

735
00:25:21,790 --> 00:25:25,570
also done some<font color="#E5E5E5"> good stuff on WI events</font>

736
00:25:23,470 --> 00:25:27,160
<font color="#E5E5E5">so it's also a really good and stealthy</font>

737
00:25:25,570 --> 00:25:28,720
way to get inside<font color="#CCCCCC"> and have persistence</font>

738
00:25:27,160 --> 00:25:30,460
<font color="#E5E5E5">especially if you you know tackling a</font>

739
00:25:28,720 --> 00:25:32,610
quite a good blue team<font color="#E5E5E5"> that knows what</font>

740
00:25:30,460 --> 00:25:32,610
they're<font color="#E5E5E5"> doing</font>

741
00:25:32,760 --> 00:25:37,120
also one thing<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be aware of is</font><font color="#CCCCCC"> I go on</font>

742
00:25:35,770 --> 00:25:40,090
<font color="#E5E5E5">about</font><font color="#CCCCCC"> it quite a lot</font><font color="#E5E5E5"> but it's making</font>

743
00:25:37,120 --> 00:25:41,800
<font color="#CCCCCC">sure your payloads</font><font color="#E5E5E5"> are proxy aware so if</font>

744
00:25:40,090 --> 00:25:43,240
you've escalated to system system isn't

745
00:25:41,800 --> 00:25:45,340
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to know what the proxy server is</font>

746
00:25:43,240 --> 00:25:46,630
inside the<font color="#CCCCCC"> organization it's not gonna</font>

747
00:25:45,340 --> 00:25:47,919
<font color="#E5E5E5">have</font><font color="#CCCCCC"> credential on the domain</font><font color="#E5E5E5"> to even</font>

748
00:25:46,630 --> 00:25:48,440
get<font color="#E5E5E5"> out so you need to make sure that</font>

749
00:25:47,920 --> 00:25:50,660
<font color="#CCCCCC">you</font><font color="#E5E5E5"> create</font>

750
00:25:48,440 --> 00:25:53,090
payloads<font color="#E5E5E5"> that you can put in the proxy</font>

751
00:25:50,660 --> 00:25:54,680
so that's what it's got a good<font color="#E5E5E5"> one</font><font color="#CCCCCC"> HTTP</font>

752
00:25:53,090 --> 00:25:56,540
proxy<font color="#E5E5E5"> and it allowed you actually go</font>

753
00:25:54,680 --> 00:25:58,370
<font color="#E5E5E5">right this is a proxy server this is the</font>

754
00:25:56,540 --> 00:26:00,740
port<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> username</font><font color="#CCCCCC"> Alice's this</font>

755
00:25:58,370 --> 00:26:02,449
is the<font color="#E5E5E5"> password so just to be aware of</font>

756
00:26:00,740 --> 00:26:03,710
<font color="#E5E5E5">it because</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is an issue when</font>

757
00:26:02,450 --> 00:26:05,360
you escalate the system people<font color="#E5E5E5"> think I</font>

758
00:26:03,710 --> 00:26:06,710
added<font color="#E5E5E5"> some silver systems in service</font>

759
00:26:05,360 --> 00:26:12,889
yeah happy days it just<font color="#CCCCCC"> won't work</font>

760
00:26:06,710 --> 00:26:15,260
<font color="#CCCCCC">especially with</font><font color="#E5E5E5"> an environment so other</font>

761
00:26:12,890 --> 00:26:16,460
post expectations techniques that I<font color="#E5E5E5"> used</font>

762
00:26:15,260 --> 00:26:19,730
quite<font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot</font><font color="#E5E5E5"> these things like cred</font>

763
00:26:16,460 --> 00:26:21,020
credit<font color="#E5E5E5"> popper and key logging</font><font color="#CCCCCC"> so just</font>

764
00:26:19,730 --> 00:26:22,310
popping<font color="#E5E5E5"> up a credential harvest</font>

765
00:26:21,020 --> 00:26:23,960
<font color="#E5E5E5">credential box on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> on the screen</font>

766
00:26:22,310 --> 00:26:25,520
<font color="#E5E5E5">saying</font><font color="#CCCCCC"> outlook needs your credentials</font><font color="#E5E5E5"> a</font>

767
00:26:23,960 --> 00:26:27,470
really effective<font color="#E5E5E5"> way to get the password</font>

768
00:26:25,520 --> 00:26:30,790
if they don't click<font color="#E5E5E5"> it first time if you</font>

769
00:26:27,470 --> 00:26:33,740
do it<font color="#CCCCCC"> a hundred</font><font color="#E5E5E5"> times</font><font color="#CCCCCC"> but they'll do</font><font color="#E5E5E5"> it</font>

770
00:26:30,790 --> 00:26:35,570
so I guess the main goal<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> Red Team</font>

771
00:26:33,740 --> 00:26:37,400
engagement is to get the critical assets

772
00:26:35,570 --> 00:26:39,409
<font color="#CCCCCC">all</font><font color="#E5E5E5"> the applications and often this</font>

773
00:26:37,400 --> 00:26:41,450
isn't always integrated windows

774
00:26:39,410 --> 00:26:42,860
authentication so<font color="#E5E5E5"> it might</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> Oracle or</font>

775
00:26:41,450 --> 00:26:45,320
Swift or any banking app that doesn't

776
00:26:42,860 --> 00:26:46,399
<font color="#CCCCCC">rely on ad</font><font color="#E5E5E5"> so actually you might</font><font color="#CCCCCC"> need to</font>

777
00:26:45,320 --> 00:26:48,820
get<font color="#E5E5E5"> their credentials for that as well</font>

778
00:26:46,400 --> 00:26:50,330
<font color="#E5E5E5">so that's why nd using key logging</font>

779
00:26:48,820 --> 00:26:51,439
<font color="#E5E5E5">sometimes</font><font color="#CCCCCC"> I've even killed the</font>

780
00:26:50,330 --> 00:26:53,360
application that<font color="#CCCCCC"> we're running</font><font color="#E5E5E5"> so</font>

781
00:26:51,440 --> 00:26:55,040
<font color="#CCCCCC">they're all just real so then I think it</font>

782
00:26:53,360 --> 00:26:56,510
<font color="#CCCCCC">captured their credentials so at least</font>

783
00:26:55,040 --> 00:26:57,980
<font color="#E5E5E5">an example of the bank it's</font><font color="#CCCCCC"> week that</font><font color="#E5E5E5"> I</font>

784
00:26:56,510 --> 00:26:59,390
was<font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to attack they</font><font color="#CCCCCC"> say I had</font><font color="#E5E5E5"> to</font>

785
00:26:57,980 --> 00:27:00,860
wait<font color="#CCCCCC"> until they logged in</font><font color="#E5E5E5"> force the</font>

786
00:26:59,390 --> 00:27:05,540
application to<font color="#E5E5E5"> close and then I can</font>

787
00:27:00,860 --> 00:27:07,310
access<font color="#E5E5E5"> the banking application so brings</font>

788
00:27:05,540 --> 00:27:10,460
<font color="#CCCCCC">onto another little</font><font color="#E5E5E5"> story so we</font>

789
00:27:07,310 --> 00:27:11,899
approached a guy called Andrew<font color="#E5E5E5"> and who</font>

790
00:27:10,460 --> 00:27:15,050
may or may<font color="#CCCCCC"> not have</font><font color="#E5E5E5"> been a network</font>

791
00:27:11,900 --> 00:27:17,210
specialist in his<font color="#E5E5E5"> current role so I may</font>

792
00:27:15,050 --> 00:27:19,730
<font color="#CCCCCC">also slightly</font><font color="#E5E5E5"> oversold him in</font><font color="#CCCCCC"> uit role</font>

793
00:27:17,210 --> 00:27:21,920
in another<font color="#E5E5E5"> organization</font><font color="#CCCCCC"> I offered them</font>

794
00:27:19,730 --> 00:27:24,440
pretty stupid salaries<font color="#E5E5E5"> working from home</font>

795
00:27:21,920 --> 00:27:27,670
all the time<font color="#CCCCCC"> good pension private health</font>

796
00:27:24,440 --> 00:27:30,890
care I really did sell it to this guy

797
00:27:27,670 --> 00:27:32,420
<font color="#E5E5E5">wasn't fair in hindsight and he did send</font>

798
00:27:30,890 --> 00:27:40,340
me some bad<font color="#E5E5E5"> messages after but but yeah</font>

799
00:27:32,420 --> 00:27:41,540
we'll get back onto that yeah<font color="#E5E5E5"> so lately</font>

800
00:27:40,340 --> 00:27:43,310
on<font color="#CCCCCC"> the phone so I</font><font color="#E5E5E5"> needed this guide to</font>

801
00:27:41,540 --> 00:27:45,560
<font color="#E5E5E5">basically click something and it was</font>

802
00:27:43,310 --> 00:27:47,090
very<font color="#E5E5E5"> very targeted</font><font color="#CCCCCC"> because I wanted this</font>

803
00:27:45,560 --> 00:27:48,500
guy because he<font color="#CCCCCC"> was a network engineer</font><font color="#E5E5E5"> I</font>

804
00:27:47,090 --> 00:27:49,699
<font color="#CCCCCC">wanted to make sure</font><font color="#E5E5E5"> that he acts because</font>

805
00:27:48,500 --> 00:27:51,200
he had<font color="#E5E5E5"> access to all the crown jewels</font>

806
00:27:49,700 --> 00:27:52,580
basically so I didn't need<font color="#E5E5E5"> to lapse</font>

807
00:27:51,200 --> 00:27:54,530
<font color="#CCCCCC">remove so I really want to work on this</font>

808
00:27:52,580 --> 00:27:56,179
guy<font color="#E5E5E5"> so I called him a few</font><font color="#CCCCCC"> times and</font><font color="#E5E5E5"> he</font>

809
00:27:54,530 --> 00:27:57,170
was very clever said I know yeah I'll go

810
00:27:56,180 --> 00:27:58,179
home<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'll do this because</font><font color="#E5E5E5"> obviously</font>

811
00:27:57,170 --> 00:27:59,200
didn't<font color="#E5E5E5"> want to</font>

812
00:27:58,179 --> 00:28:00,399
when<font color="#E5E5E5"> I was acting as a recruiter you</font>

813
00:27:59,200 --> 00:28:04,029
didn't want<font color="#E5E5E5"> to do anything</font><font color="#CCCCCC"> worked I'm</font>

814
00:28:00,399 --> 00:28:05,590
<font color="#CCCCCC">Melana</font><font color="#E5E5E5"> we've got an anonymized form that</font>

815
00:28:04,029 --> 00:28:08,019
you can fill out basically it<font color="#CCCCCC"> just</font>

816
00:28:05,590 --> 00:28:09,428
creates it creates an agreement between

817
00:28:08,019 --> 00:28:10,600
me and you<font color="#CCCCCC"> and that means I</font><font color="#E5E5E5"> can act on</font>

818
00:28:09,429 --> 00:28:13,090
your behalf and work with this

819
00:28:10,600 --> 00:28:14,709
organization<font color="#CCCCCC"> so I had a job of payload</font>

820
00:28:13,090 --> 00:28:16,779
Bay<font color="#E5E5E5"> C embedded inside the application</font>

821
00:28:14,710 --> 00:28:19,720
<font color="#CCCCCC">and</font><font color="#E5E5E5"> he had to go on</font><font color="#CCCCCC"> and put yeah legal</font>

822
00:28:16,779 --> 00:28:22,119
full name<font color="#E5E5E5"> email I agree</font><font color="#CCCCCC"> that this</font>

823
00:28:19,720 --> 00:28:23,769
content shall be given by UK law<font color="#CCCCCC"> click</font>

824
00:28:22,119 --> 00:28:25,869
that box<font color="#E5E5E5"> suzi click that box I got a</font>

825
00:28:23,769 --> 00:28:30,309
shell basically so yeah he did<font color="#E5E5E5"> that</font>

826
00:28:25,869 --> 00:28:32,830
happily so what was<font color="#E5E5E5"> really</font><font color="#CCCCCC"> interesting</font>

827
00:28:30,309 --> 00:28:34,990
what I got on his machine<font color="#E5E5E5"> I started</font>

828
00:28:32,830 --> 00:28:37,480
doing some key logging and because I've

829
00:28:34,990 --> 00:28:38,769
really sold this<font color="#E5E5E5"> job to him he was</font>

830
00:28:37,480 --> 00:28:40,629
actually<font color="#E5E5E5"> gonna kick out his office at</font>

831
00:28:38,769 --> 00:28:42,519
<font color="#CCCCCC">home so</font><font color="#E5E5E5"> he's buying</font><font color="#CCCCCC"> chairs and</font><font color="#E5E5E5"> printers</font>

832
00:28:40,629 --> 00:28:43,779
and<font color="#E5E5E5"> things like it's not</font><font color="#CCCCCC"> a no he's only</font>

833
00:28:42,519 --> 00:28:48,879
<font color="#E5E5E5">doing this because I've sold him a job</font>

834
00:28:43,779 --> 00:28:50,379
at working from home<font color="#E5E5E5"> but actually he did</font>

835
00:28:48,879 --> 00:28:52,029
have the key to the kingdom use on all

836
00:28:50,379 --> 00:28:53,769
the switches all the<font color="#E5E5E5"> firewalls all the</font>

837
00:28:52,029 --> 00:28:55,720
<font color="#CCCCCC">routers</font><font color="#E5E5E5"> and after because they're doing</font>

838
00:28:53,769 --> 00:28:57,610
some key logging<font color="#E5E5E5"> basically I got</font>

839
00:28:55,720 --> 00:29:01,149
<font color="#E5E5E5">everything and that's all I need to do I</font>

840
00:28:57,610 --> 00:29:02,559
didn't even need to<font color="#E5E5E5"> last we mean it</font>

841
00:29:01,149 --> 00:29:04,449
could have<font color="#E5E5E5"> been worse though it could be</font>

842
00:29:02,559 --> 00:29:07,418
my mate who targeted people<font color="#E5E5E5"> on LinkedIn</font>

843
00:29:04,450 --> 00:29:08,529
with that picture<font color="#CCCCCC"> I probably could</font><font color="#E5E5E5"> have</font>

844
00:29:07,419 --> 00:29:10,799
broke his marriage up so I'm glad<font color="#CCCCCC"> it</font>

845
00:29:08,529 --> 00:29:10,799
didn't do that

846
00:29:12,330 --> 00:29:16,389
so<font color="#CCCCCC"> that's your movement and</font><font color="#E5E5E5"> it's a key</font>

847
00:29:14,710 --> 00:29:18,399
point<font color="#E5E5E5"> in the side to kill chain and it's</font>

848
00:29:16,389 --> 00:29:19,600
you know<font color="#E5E5E5"> it's a key point to act on your</font>

849
00:29:18,399 --> 00:29:21,279
<font color="#E5E5E5">objectives because usually they're not</font>

850
00:29:19,600 --> 00:29:24,039
<font color="#E5E5E5">quite</font><font color="#CCCCCC"> as easy</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> that one I've showed</font>

851
00:29:21,279 --> 00:29:26,259
<font color="#E5E5E5">you about there and so usually the way</font><font color="#CCCCCC"> I</font>

852
00:29:24,039 --> 00:29:27,309
do<font color="#E5E5E5"> it is I would employ</font><font color="#CCCCCC"> a sort of mad</font>

853
00:29:26,259 --> 00:29:29,529
<font color="#E5E5E5">sport at this point because it's got a</font>

854
00:29:27,309 --> 00:29:31,299
<font color="#E5E5E5">great</font><font color="#CCCCCC"> Sox proxying capability so you can</font>

855
00:29:29,529 --> 00:29:32,919
actually use<font color="#E5E5E5"> proxy chains with the socks</font>

856
00:29:31,299 --> 00:29:35,200
proxy<font color="#E5E5E5"> and use any tool one your</font><font color="#CCCCCC"> Khali</font>

857
00:29:32,919 --> 00:29:37,139
but<font color="#CCCCCC"> candy machine or Windows machine</font><font color="#E5E5E5"> or</font>

858
00:29:35,200 --> 00:29:38,950
Windows machine<font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> that you use</font>

859
00:29:37,139 --> 00:29:40,389
it's<font color="#E5E5E5"> just a great way of</font><font color="#CCCCCC"> better</font>

860
00:29:38,950 --> 00:29:41,679
targeting organization with what you

861
00:29:40,389 --> 00:29:42,389
<font color="#E5E5E5">would</font><font color="#CCCCCC"> normally use as an internal</font>

862
00:29:41,679 --> 00:29:45,309
<font color="#CCCCCC">pentest</font>

863
00:29:42,389 --> 00:29:46,809
<font color="#CCCCCC">see ntlm also does the</font><font color="#E5E5E5"> same thing but</font>

864
00:29:45,309 --> 00:29:49,418
you'd<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to use SSH through the proxy</font>

865
00:29:46,809 --> 00:29:51,220
server<font color="#E5E5E5"> obviously you can</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> a normal</font>

866
00:29:49,419 --> 00:29:53,440
thing with like sort of PowerShell<font color="#E5E5E5"> when</font>

867
00:29:51,220 --> 00:29:54,610
RN do we mi that sort<font color="#CCCCCC"> of thing but if</font>

868
00:29:53,440 --> 00:29:56,080
<font color="#E5E5E5">you really</font><font color="#CCCCCC"> want to just</font><font color="#E5E5E5"> get in and use</font>

869
00:29:54,610 --> 00:30:02,019
your<font color="#E5E5E5"> own tools I</font><font color="#CCCCCC"> would just tend</font><font color="#E5E5E5"> to use</font>

870
00:29:56,080 --> 00:30:03,309
the socks proxy stuff so that's<font color="#E5E5E5"> the</font>

871
00:30:02,019 --> 00:30:04,690
module if anyone didn't know what it is

872
00:30:03,309 --> 00:30:06,820
but that's<font color="#E5E5E5"> a Sox server basically</font><font color="#CCCCCC"> it</font>

873
00:30:04,690 --> 00:30:09,159
<font color="#CCCCCC">crates if you get a shell with</font><font color="#E5E5E5"> mats</font><font color="#CCCCCC"> poit</font>

874
00:30:06,820 --> 00:30:09,919
and basically you<font color="#CCCCCC"> can use this module</font>

875
00:30:09,159 --> 00:30:11,300
<font color="#E5E5E5">and it</font>

876
00:30:09,920 --> 00:30:13,970
open up report on your box and<font color="#E5E5E5"> you can</font>

877
00:30:11,300 --> 00:30:15,320
<font color="#E5E5E5">then</font><font color="#CCCCCC"> use proxy change through it and you</font>

878
00:30:13,970 --> 00:30:18,020
can<font color="#CCCCCC"> just use all</font><font color="#E5E5E5"> your normal tools like</font>

879
00:30:15,320 --> 00:30:21,050
<font color="#CCCCCC">reducer</font><font color="#E5E5E5"> RDP SMB map or anything</font><font color="#CCCCCC"> like</font>

880
00:30:18,020 --> 00:30:23,330
that<font color="#CCCCCC"> basically so</font><font color="#E5E5E5"> you might be</font><font color="#CCCCCC"> really</font>

881
00:30:21,050 --> 00:30:26,740
<font color="#E5E5E5">lucky and you might have a guy who's got</font>

882
00:30:23,330 --> 00:30:26,740
the document opens all<font color="#CCCCCC"> this passwords</font>

883
00:30:27,640 --> 00:30:33,260
and then actually obviously<font color="#CCCCCC"> are again</font>

884
00:30:31,670 --> 00:30:35,900
<font color="#E5E5E5">coming back to Citrix but I do love</font>

885
00:30:33,260 --> 00:30:37,520
Citrix and what I<font color="#E5E5E5"> often find with Citrix</font>

886
00:30:35,900 --> 00:30:39,170
is because<font color="#E5E5E5"> people use them all the time</font>

887
00:30:37,520 --> 00:30:42,290
<font color="#CCCCCC">they don't really patch Citrix service</font>

888
00:30:39,170 --> 00:30:47,030
<font color="#E5E5E5">so again once you break out go onto</font>

889
00:30:42,290 --> 00:30:50,270
PowerShell<font color="#E5E5E5"> yeah elevate shell whenever</font>

890
00:30:47,030 --> 00:30:51,830
<font color="#E5E5E5">16 32 and get system and do all your</font>

891
00:30:50,270 --> 00:30:53,540
<font color="#CCCCCC">normal stuff like</font><font color="#E5E5E5"> mini cats</font><font color="#CCCCCC"> drop the</font>

892
00:30:51,830 --> 00:30:55,159
domain<font color="#CCCCCC"> album credentials</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> this is</font>

893
00:30:53,540 --> 00:30:56,360
again why I love Citrix you can always

894
00:30:55,160 --> 00:30:59,030
<font color="#E5E5E5">break out and do something really cool</font>

895
00:30:56,360 --> 00:31:03,490
<font color="#CCCCCC">with it and then I dictate on the domain</font>

896
00:30:59,030 --> 00:31:03,490
controller<font color="#E5E5E5"> again this is all from home</font>

897
00:31:04,210 --> 00:31:10,130
and<font color="#CCCCCC"> access all the applications banking</font>

898
00:31:07,550 --> 00:31:13,700
applications<font color="#E5E5E5"> transfer money make</font>

899
00:31:10,130 --> 00:31:19,970
payments again access<font color="#CCCCCC"> all the legal</font>

900
00:31:13,700 --> 00:31:21,440
<font color="#CCCCCC">documents again banking applications SQL</font>

901
00:31:19,970 --> 00:31:22,760
service so SQL<font color="#CCCCCC"> Server is quite an</font>

902
00:31:21,440 --> 00:31:25,850
<font color="#E5E5E5">interesting one if they use things like</font>

903
00:31:22,760 --> 00:31:27,620
Imperva improve of a log access<font color="#E5E5E5"> to</font>

904
00:31:25,850 --> 00:31:29,120
databases basically on a<font color="#E5E5E5"> network level</font>

905
00:31:27,620 --> 00:31:31,459
<font color="#CCCCCC">well what's</font><font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> is if</font><font color="#E5E5E5"> you are</font>

906
00:31:29,120 --> 00:31:33,020
deeply<font color="#CCCCCC"> actually on to the</font><font color="#E5E5E5"> SQL server and</font>

907
00:31:31,460 --> 00:31:35,600
go through the manager here<font color="#E5E5E5"> none</font><font color="#CCCCCC"> of</font>

908
00:31:33,020 --> 00:31:36,860
that's logged that's a good way getting

909
00:31:35,600 --> 00:31:41,240
around when you're doing like<font color="#CCCCCC"> a red team</font>

910
00:31:36,860 --> 00:31:42,800
<font color="#CCCCCC">versus blue team type thing</font><font color="#E5E5E5"> so yeah I</font>

911
00:31:41,240 --> 00:31:44,390
guess that's<font color="#CCCCCC"> kind of my social</font>

912
00:31:42,800 --> 00:31:46,550
<font color="#E5E5E5">engineering</font><font color="#CCCCCC"> and sort of red team</font><font color="#E5E5E5"> in</font>

913
00:31:44,390 --> 00:31:48,230
background<font color="#E5E5E5"> so me and Dave party over</font>

914
00:31:46,550 --> 00:31:50,780
there<font color="#E5E5E5"> I created a tool called push c2 to</font>

915
00:31:48,230 --> 00:31:52,610
help alleviate all this or all this

916
00:31:50,780 --> 00:31:54,649
stuff and<font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> try and do a live</font>

917
00:31:52,610 --> 00:31:57,320
demo I'll do a<font color="#E5E5E5"> quick introduction first</font>

918
00:31:54,650 --> 00:31:59,030
<font color="#E5E5E5">so it's it's maintained free and open</font>

919
00:31:57,320 --> 00:32:01,450
source<font color="#E5E5E5"> it was inspired</font><font color="#CCCCCC"> by some of the</font>

920
00:31:59,030 --> 00:32:03,680
stuff<font color="#E5E5E5"> we did in Matt's group last year</font>

921
00:32:01,450 --> 00:32:05,720
and it kind of allows<font color="#E5E5E5"> you to learn</font>

922
00:32:03,680 --> 00:32:06,770
PowerShell<font color="#CCCCCC"> and a phase approach so most</font>

923
00:32:05,720 --> 00:32:08,510
<font color="#CCCCCC">people get scared</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> they open</font>

924
00:32:06,770 --> 00:32:09,680
PowerShell in<font color="#E5E5E5"> it for his</font><font color="#CCCCCC"> red arrows so</font>

925
00:32:08,510 --> 00:32:12,290
this is<font color="#E5E5E5"> quite a good way of</font><font color="#CCCCCC"> getting you</font>

926
00:32:09,680 --> 00:32:15,740
to use PowerShell it's all is encrypted

927
00:32:12,290 --> 00:32:17,510
<font color="#E5E5E5">with a 128-bit key</font><font color="#CCCCCC"> it's got an auto kill</font>

928
00:32:15,740 --> 00:32:18,830
switch<font color="#CCCCCC"> so if you you know got a really</font>

929
00:32:17,510 --> 00:32:20,419
risky<font color="#CCCCCC"> customer doesn't like</font><font color="#E5E5E5"> to just</font><font color="#CCCCCC"> hop</font>

930
00:32:18,830 --> 00:32:22,699
<font color="#CCCCCC">in gave them</font><font color="#E5E5E5"> because they were you know</font>

931
00:32:20,419 --> 00:32:24,320
if we<font color="#CCCCCC"> duel and we you know some reason</font>

932
00:32:22,700 --> 00:32:26,119
don't<font color="#E5E5E5"> manage to get the shelves gone in</font>

933
00:32:24,320 --> 00:32:27,200
two weeks<font color="#E5E5E5"> it will you know if it hits</font>

934
00:32:26,119 --> 00:32:28,759
<font color="#E5E5E5">that two week mark it'll just</font>

935
00:32:27,200 --> 00:32:31,299
automatically kill the shelves<font color="#CCCCCC"> so it's</font>

936
00:32:28,759 --> 00:32:33,580
<font color="#E5E5E5">kinda</font><font color="#CCCCCC"> just like</font><font color="#E5E5E5"> a risk mitigation thing</font>

937
00:32:31,299 --> 00:32:36,289
<font color="#E5E5E5">so it's not only a red teaming tool it's</font>

938
00:32:33,580 --> 00:32:38,720
<font color="#E5E5E5">also basically</font><font color="#CCCCCC"> a penetration</font><font color="#E5E5E5"> testing</font>

939
00:32:36,289 --> 00:32:39,230
<font color="#CCCCCC">toolkit simple and really easy to</font>

940
00:32:38,720 --> 00:32:40,340
<font color="#E5E5E5">install</font>

941
00:32:39,230 --> 00:32:42,109
<font color="#E5E5E5">basically we've written a little</font>

942
00:32:40,340 --> 00:32:43,820
installer<font color="#CCCCCC"> one-line it will do everything</font>

943
00:32:42,109 --> 00:32:46,009
<font color="#E5E5E5">for you</font><font color="#CCCCCC"> anything it doesn't</font><font color="#E5E5E5"> do is</font>

944
00:32:43,820 --> 00:32:48,220
install JDK<font color="#E5E5E5"> which you need</font><font color="#CCCCCC"> to create the</font>

945
00:32:46,009 --> 00:32:50,179
<font color="#E5E5E5">Java payloads</font><font color="#CCCCCC"> if you want to do that</font>

946
00:32:48,220 --> 00:32:53,350
works on<font color="#E5E5E5"> PowerShell version</font><font color="#CCCCCC"> two and</font>

947
00:32:50,179 --> 00:32:56,299
<font color="#CCCCCC">above</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the seven eight ten</font><font color="#CCCCCC"> Vista</font>

948
00:32:53,350 --> 00:32:58,428
<font color="#E5E5E5">it's based on customizable HTTP beacons</font>

949
00:32:56,299 --> 00:32:59,929
so you can set them to<font color="#CCCCCC"> you have a long</font>

950
00:32:58,429 --> 00:33:01,039
you want five seconds<font color="#E5E5E5"> ten seconds two</font>

951
00:32:59,929 --> 00:33:01,249
minutes<font color="#E5E5E5"> three minutes or things like</font>

952
00:33:01,039 --> 00:33:03,139
<font color="#CCCCCC">that</font>

953
00:33:01,249 --> 00:33:04,730
it's also got<font color="#CCCCCC"> a</font><font color="#E5E5E5"> ten percent jitter so if</font>

954
00:33:03,139 --> 00:33:06,408
you've<font color="#E5E5E5"> got sort</font><font color="#CCCCCC"> of a blue team that's</font>

955
00:33:04,730 --> 00:33:08,330
<font color="#E5E5E5">monitoring traffic like maybe every 60</font>

956
00:33:06,409 --> 00:33:10,429
seconds<font color="#E5E5E5"> you know it's a bit of jitter so</font>

957
00:33:08,330 --> 00:33:13,970
it sort of transfers it from like 55 to

958
00:33:10,429 --> 00:33:15,739
65<font color="#E5E5E5"> etc it's maintainable and modular has</font>

959
00:33:13,970 --> 00:33:17,029
been one of<font color="#E5E5E5"> the big things so we're not</font>

960
00:33:15,739 --> 00:33:18,739
saying<font color="#E5E5E5"> we're gurus</font><font color="#CCCCCC"> in PowerShell</font>

961
00:33:17,029 --> 00:33:21,139
but<font color="#E5E5E5"> basically we're</font><font color="#CCCCCC"> just giving you the</font>

962
00:33:18,739 --> 00:33:22,940
<font color="#CCCCCC">opportunity to use PowerShell modules in</font>

963
00:33:21,139 --> 00:33:24,168
<font color="#E5E5E5">in a resume engagement so all the</font>

964
00:33:22,940 --> 00:33:25,609
modules with<font color="#E5E5E5"> hardened</font><font color="#CCCCCC"> jory things that</font>

965
00:33:24,169 --> 00:33:27,649
<font color="#CCCCCC">he's written</font><font color="#E5E5E5"> some great modules you can</font>

966
00:33:25,609 --> 00:33:29,059
<font color="#E5E5E5">put these in them in the modules folder</font>

967
00:33:27,649 --> 00:33:31,039
and load them on the<font color="#CCCCCC"> em you know load</font>

968
00:33:29,059 --> 00:33:32,989
<font color="#CCCCCC">load one client</font><font color="#E5E5E5"> again I'll show you this</font>

969
00:33:31,039 --> 00:33:35,119
in a minute<font color="#CCCCCC"> and it's been tested against</font>

970
00:33:32,989 --> 00:33:36,799
sort of<font color="#E5E5E5"> fire</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> palo alto</font><font color="#CCCCCC"> we don't seem</font>

971
00:33:35,119 --> 00:33:38,299
quite<font color="#E5E5E5"> clever stuff with image heuristics</font>

972
00:33:36,799 --> 00:33:39,918
so if they<font color="#CCCCCC"> actually put all the traffic</font>

973
00:33:38,299 --> 00:33:41,480
back together<font color="#CCCCCC"> as all</font><font color="#E5E5E5"> you would see is a</font>

974
00:33:39,919 --> 00:33:43,129
<font color="#E5E5E5">little image of like facebook or twitter</font>

975
00:33:41,480 --> 00:33:45,919
or linkedin<font color="#CCCCCC"> so it's actually</font><font color="#E5E5E5"> really</font>

976
00:33:43,129 --> 00:33:47,959
<font color="#E5E5E5">quite cool and again one</font><font color="#CCCCCC"> of the main</font>

977
00:33:45,919 --> 00:33:49,669
things<font color="#CCCCCC"> about doing</font><font color="#E5E5E5"> this type of type</font><font color="#CCCCCC"> of</font>

978
00:33:47,960 --> 00:33:51,409
job<font color="#E5E5E5"> is that you need to give the blue</font>

979
00:33:49,669 --> 00:33:52,730
team<font color="#E5E5E5"> is something to work on obviously</font>

980
00:33:51,409 --> 00:33:54,139
yeah it's great<font color="#E5E5E5"> to say</font><font color="#CCCCCC"> i got in but you</font>

981
00:33:52,730 --> 00:33:55,429
need to say well<font color="#E5E5E5"> i access this I'd give</font>

982
00:33:54,139 --> 00:33:57,139
<font color="#E5E5E5">this and I did this and I</font><font color="#CCCCCC"> compromised</font>

983
00:33:55,429 --> 00:33:58,609
these machines<font color="#E5E5E5"> so</font><font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the most</font>

984
00:33:57,139 --> 00:34:00,889
important<font color="#E5E5E5"> things</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us is this output</font>

985
00:33:58,609 --> 00:34:02,539
to HTML function<font color="#CCCCCC"> so it basically</font><font color="#E5E5E5"> tells</font>

986
00:34:00,889 --> 00:34:04,939
<font color="#E5E5E5">you every implant</font><font color="#CCCCCC"> that you've got on on</font>

987
00:34:02,539 --> 00:34:07,158
the work on on the implant<font color="#E5E5E5"> so every</font>

988
00:34:04,940 --> 00:34:09,589
implant you've got on each<font color="#E5E5E5"> called a</font>

989
00:34:07,159 --> 00:34:12,770
workstation<font color="#CCCCCC"> and it also tells you every</font>

990
00:34:09,589 --> 00:34:14,389
command<font color="#E5E5E5"> you</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> every output so if you</font>

991
00:34:12,770 --> 00:34:17,239
could get<font color="#CCCCCC"> to get a</font><font color="#E5E5E5"> screenshot</font><font color="#CCCCCC"> awesome</font>

992
00:34:14,389 --> 00:34:19,270
it's always in there let's give this a

993
00:34:17,239 --> 00:34:19,270
go

994
00:34:34,750 --> 00:34:47,168
so make sure when<font color="#CCCCCC"> you open</font><font color="#E5E5E5"> it up it'll</font>

995
00:34:37,210 --> 00:34:50,760
<font color="#E5E5E5">say I haven't</font><font color="#CCCCCC"> gotten my</font><font color="#E5E5E5"> piece I hold on</font>

996
00:34:47,168 --> 00:34:50,759
<font color="#CCCCCC">to</font><font color="#E5E5E5"> need a demo with me</font>

997
00:35:04,130 --> 00:35:07,130
service

998
00:35:37,220 --> 00:35:40,430
<font color="#E5E5E5">okay well</font>

999
00:35:58,810 --> 00:36:05,240
yeah<font color="#CCCCCC"> no it's</font><font color="#E5E5E5"> not now come on</font>

1000
00:36:03,190 --> 00:36:08,200
I'm gonna<font color="#E5E5E5"> have to reboot this machine is</font>

1001
00:36:05,240 --> 00:36:10,459
very<font color="#CCCCCC"> two seconds sorry</font>

1002
00:36:08,200 --> 00:36:18,740
it's<font color="#CCCCCC"> windows it all work once you</font><font color="#E5E5E5"> switch</font>

1003
00:36:10,460 --> 00:36:23,420
it off<font color="#CCCCCC"> and</font><font color="#E5E5E5"> on again demo God should</font><font color="#CCCCCC"> have</font>

1004
00:36:18,740 --> 00:36:26,470
videoed it<font color="#E5E5E5"> knew</font><font color="#CCCCCC"> it I know</font><font color="#E5E5E5"> it was a</font>

1005
00:36:23,420 --> 00:36:26,470
ballsy move and it failed

1006
00:37:27,160 --> 00:37:30,879
that's all I managed to<font color="#CCCCCC"> smiie</font>

1007
00:38:25,490 --> 00:38:31,290
<font color="#CCCCCC">all right we're back so I</font><font color="#E5E5E5"> got that so</font>

1008
00:38:30,150 --> 00:38:33,060
this<font color="#E5E5E5"> is what it should</font><font color="#CCCCCC"> look like</font><font color="#E5E5E5"> when</font>

1009
00:38:31,290 --> 00:38:34,830
you<font color="#E5E5E5"> get an IP so basically I'll get the</font>

1010
00:38:33,060 --> 00:38:39,180
IP from the<font color="#E5E5E5"> network adapter which at the</font>

1011
00:38:34,830 --> 00:38:40,740
moment<font color="#E5E5E5"> is just</font><font color="#CCCCCC"> 172 16 180 128 so the</font>

1012
00:38:39,180 --> 00:38:42,359
first thing you'll ask you is what IP do

1013
00:38:40,740 --> 00:38:44,430
you want to use or what<font color="#E5E5E5"> seek what's the</font>

1014
00:38:42,360 --> 00:38:45,870
<font color="#E5E5E5">c2 sort of server in the</font><font color="#CCCCCC"> backend so</font>

1015
00:38:44,430 --> 00:38:48,299
usually this<font color="#E5E5E5"> should be like the URL that</font>

1016
00:38:45,870 --> 00:38:50,279
<font color="#CCCCCC">you</font><font color="#E5E5E5"> using in the</font><font color="#CCCCCC"> engagement so it might</font>

1017
00:38:48,300 --> 00:38:52,350
<font color="#E5E5E5">be</font><font color="#CCCCCC"> the domain you've bought or a bit</font>

1018
00:38:50,280 --> 00:38:55,320
just the external<font color="#E5E5E5"> facing IP so usually</font>

1019
00:38:52,350 --> 00:38:58,460
it's not<font color="#CCCCCC"> an internal IP so once you've</font>

1020
00:38:55,320 --> 00:38:58,460
done that it<font color="#CCCCCC"> lasts you</font><font color="#E5E5E5"> basically</font>

1021
00:38:59,150 --> 00:39:04,190
basically<font color="#CCCCCC"> what folder you want</font><font color="#E5E5E5"> to put it</font>

1022
00:39:01,260 --> 00:39:06,390
any I'll just give<font color="#CCCCCC"> you a temporary name</font>

1023
00:39:04,190 --> 00:39:07,770
default beacon time so if you<font color="#CCCCCC"> want to</font>

1024
00:39:06,390 --> 00:39:10,259
set that<font color="#CCCCCC"> to anything</font><font color="#E5E5E5"> less or more than</font>

1025
00:39:07,770 --> 00:39:11,820
<font color="#CCCCCC">five seconds and they've got the auto</font>

1026
00:39:10,260 --> 00:39:13,440
<font color="#E5E5E5">kill switch date so you can actually</font>

1027
00:39:11,820 --> 00:39:16,140
<font color="#E5E5E5">extend that or will make it less if you</font>

1028
00:39:13,440 --> 00:39:18,030
<font color="#E5E5E5">want to and then the default port again</font>

1029
00:39:16,140 --> 00:39:19,350
<font color="#E5E5E5">I'd always recommend</font><font color="#CCCCCC"> 80 or 4 for 3</font><font color="#E5E5E5"> just</font>

1030
00:39:18,030 --> 00:39:24,180
<font color="#E5E5E5">because when you're in</font><font color="#CCCCCC"> them proxy</font><font color="#E5E5E5"> wear</font>

1031
00:39:19,350 --> 00:39:25,920
environments 18<font color="#E5E5E5"> for free generally and</font>

1032
00:39:24,180 --> 00:39:27,359
then what it<font color="#E5E5E5"> will do is it'll</font><font color="#CCCCCC"> create you</font>

1033
00:39:25,920 --> 00:39:30,450
for<font color="#E5E5E5"> the red team in that section where</font>

1034
00:39:27,360 --> 00:39:32,490
you create<font color="#E5E5E5"> your Java payload again it's</font>

1035
00:39:30,450 --> 00:39:35,910
<font color="#E5E5E5">unsigned so</font><font color="#CCCCCC"> what if you get Kohanim so</font>

1036
00:39:32,490 --> 00:39:38,279
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can actually then</font><font color="#CCCCCC"> assign the</font>

1037
00:39:35,910 --> 00:39:40,859
<font color="#CCCCCC">Internet okay a batch file which is kind</font>

1038
00:39:38,280 --> 00:39:42,900
of just<font color="#E5E5E5"> more use for internals</font><font color="#CCCCCC"> it'll</font>

1039
00:39:40,860 --> 00:39:43,920
create a macro payload<font color="#CCCCCC"> but again you can</font>

1040
00:39:42,900 --> 00:39:45,660
just<font color="#E5E5E5"> put straight into a Word document</font>

1041
00:39:43,920 --> 00:39:47,820
to weaponize it and send<font color="#CCCCCC"> into the clone</font>

1042
00:39:45,660 --> 00:39:49,259
<font color="#E5E5E5">and they'll also create</font><font color="#CCCCCC"> you add a</font><font color="#E5E5E5"> link a</font>

1043
00:39:47,820 --> 00:39:52,680
file again if you want to<font color="#E5E5E5"> send</font><font color="#CCCCCC"> that into</font>

1044
00:39:49,260 --> 00:39:55,410
the<font color="#CCCCCC"> organisation it's also another</font><font color="#E5E5E5"> way</font>

1045
00:39:52,680 --> 00:39:57,450
you can run it<font color="#CCCCCC"> on internal is basically</font>

1046
00:39:55,410 --> 00:39:59,370
with like the top<font color="#E5E5E5"> one there which is</font>

1047
00:39:57,450 --> 00:40:00,629
PowerShell how can exec bypass that one

1048
00:39:59,370 --> 00:40:02,009
<font color="#E5E5E5">so that's just a quick</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> of doing</font><font color="#CCCCCC"> it</font>

1049
00:40:00,630 --> 00:40:03,780
but it's not<font color="#E5E5E5"> always proxy aware that way</font>

1050
00:40:02,010 --> 00:40:06,210
<font color="#E5E5E5">and because</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> using the download cradle</font>

1051
00:40:03,780 --> 00:40:06,750
so I would always use<font color="#CCCCCC"> that only on</font>

1052
00:40:06,210 --> 00:40:08,040
<font color="#CCCCCC">eternals</font>

1053
00:40:06,750 --> 00:40:10,680
<font color="#E5E5E5">I would use the other ways when you're</font>

1054
00:40:08,040 --> 00:40:12,840
ready<font color="#CCCCCC"> to engage also if you want to try</font>

1055
00:40:10,680 --> 00:40:14,549
and bypass app lock or a bit<font color="#E5E5E5"> 9</font><font color="#CCCCCC"> sub she's</font>

1056
00:40:12,840 --> 00:40:16,050
written<font color="#E5E5E5"> some cool stuff about it on how</font>

1057
00:40:14,550 --> 00:40:18,840
to use<font color="#CCCCCC"> install util</font><font color="#E5E5E5"> so I've actually</font>

1058
00:40:16,050 --> 00:40:21,270
embedded<font color="#E5E5E5"> that as well so that it will</font>

1059
00:40:18,840 --> 00:40:22,590
<font color="#E5E5E5">not even use any executables on the disk</font>

1060
00:40:21,270 --> 00:40:24,750
so if they've<font color="#E5E5E5"> got a bit</font><font color="#CCCCCC"> Niner it's not</font>

1061
00:40:22,590 --> 00:40:28,910
that<font color="#E5E5E5"> and I'll just work and all I get</font>

1062
00:40:24,750 --> 00:40:28,910
for<font color="#E5E5E5"> all so also another window will open</font>

1063
00:40:29,900 --> 00:40:35,160
so that's<font color="#E5E5E5"> give command</font><font color="#CCCCCC"> so this server is</font>

1064
00:40:33,690 --> 00:40:36,720
the<font color="#CCCCCC"> CTU server and</font><font color="#E5E5E5"> this is the implant</font>

1065
00:40:35,160 --> 00:40:38,040
<font color="#E5E5E5">handler so all</font>

1066
00:40:36,720 --> 00:40:39,839
so all the commands and<font color="#E5E5E5"> everything will</font>

1067
00:40:38,040 --> 00:40:41,369
actually output here<font color="#E5E5E5"> all on the</font><font color="#CCCCCC"> screen</font>

1068
00:40:39,839 --> 00:40:42,810
but<font color="#E5E5E5"> this is what you use to basically</font>

1069
00:40:41,369 --> 00:40:44,730
interact with the clients<font color="#E5E5E5"> and in the</font>

1070
00:40:42,810 --> 00:40:46,770
foot holes<font color="#E5E5E5"> once you've got them so I'll</font>

1071
00:40:44,730 --> 00:40:48,900
just go<font color="#CCCCCC"> ahead and run the payload on my</font>

1072
00:40:46,770 --> 00:40:53,880
machine<font color="#CCCCCC"> just to show you what it looks</font>

1073
00:40:48,900 --> 00:40:55,319
like<font color="#CCCCCC"> on the bat file and there you go as</font>

1074
00:40:53,880 --> 00:40:56,550
you can<font color="#E5E5E5"> see it gives you the encryption</font>

1075
00:40:55,319 --> 00:40:58,200
key that's using to encrypt all the

1076
00:40:56,550 --> 00:41:00,510
traffic back and forth<font color="#E5E5E5"> it tells you a</font>

1077
00:40:58,200 --> 00:41:02,578
bit<font color="#CCCCCC"> about the client so what domain it's</font>

1078
00:41:00,510 --> 00:41:04,829
on which is Windows<font color="#CCCCCC"> 10 spoon what user</font>

1079
00:41:02,579 --> 00:41:06,390
<font color="#E5E5E5">what the architecture</font><font color="#CCCCCC"> of the machine is</font>

1080
00:41:04,829 --> 00:41:09,329
and the<font color="#E5E5E5"> process that</font><font color="#CCCCCC"> actually it's</font>

1081
00:41:06,390 --> 00:41:12,359
injected<font color="#CCCCCC"> into which is</font><font color="#E5E5E5"> 4 6</font><font color="#CCCCCC"> 8</font><font color="#E5E5E5"> a and the</font>

1082
00:41:09,329 --> 00:41:14,609
default sleep time<font color="#E5E5E5"> then you can go ahead</font>

1083
00:41:12,359 --> 00:41:20,130
<font color="#E5E5E5">and use the implant basically on this</font>

1084
00:41:14,609 --> 00:41:21,299
window<font color="#CCCCCC"> it's basically just</font><font color="#E5E5E5"> a command</font>

1085
00:41:20,130 --> 00:41:22,710
line<font color="#CCCCCC"> that so you can run whatever</font><font color="#E5E5E5"> you</font>

1086
00:41:21,300 --> 00:41:24,089
want<font color="#CCCCCC"> so rewritten</font><font color="#E5E5E5"> some quite cool</font>

1087
00:41:22,710 --> 00:41:25,829
modules in it but you<font color="#E5E5E5"> can just</font><font color="#CCCCCC"> use it</font>

1088
00:41:24,089 --> 00:41:27,420
<font color="#CCCCCC">like you've</font><font color="#E5E5E5"> run normal PowerShell</font>

1089
00:41:25,829 --> 00:41:30,750
commands<font color="#E5E5E5"> so anything like Who am I</font>

1090
00:41:27,420 --> 00:41:32,250
<font color="#CCCCCC">everything</font><font color="#E5E5E5"> so when it first does it</font>

1091
00:41:30,750 --> 00:41:34,260
loads the implant core which has<font color="#E5E5E5"> got a</font>

1092
00:41:32,250 --> 00:41:37,829
few features and stuff and then again it

1093
00:41:34,260 --> 00:41:39,720
<font color="#E5E5E5">will run your command so some of the</font>

1094
00:41:37,829 --> 00:41:41,069
modules<font color="#E5E5E5"> we've written and some of the</font>

1095
00:41:39,720 --> 00:41:42,209
<font color="#E5E5E5">modules we haven't but again that's the</font>

1096
00:41:41,069 --> 00:41:43,740
great thing<font color="#CCCCCC"> about this</font><font color="#E5E5E5"> tool</font><font color="#CCCCCC"> is you can</font>

1097
00:41:42,210 --> 00:41:45,359
put any module in there and<font color="#E5E5E5"> just load</font>

1098
00:41:43,740 --> 00:41:46,618
the module<font color="#CCCCCC"> by just doing load module</font>

1099
00:41:45,359 --> 00:41:49,200
blah blah blah and<font color="#E5E5E5"> it will just load</font>

1100
00:41:46,619 --> 00:41:58,560
module inside inside<font color="#E5E5E5"> the organization</font>

1101
00:41:49,200 --> 00:42:00,450
<font color="#CCCCCC">basically on the client machine</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the</font>

1102
00:41:58,560 --> 00:42:02,250
traffic is obviously going<font color="#E5E5E5"> over HTTP but</font>

1103
00:42:00,450 --> 00:42:04,230
it's all encrypted<font color="#E5E5E5"> it's all looks like</font>

1104
00:42:02,250 --> 00:42:06,750
images which there's also a temporary

1105
00:42:04,230 --> 00:42:08,760
image<font color="#E5E5E5"> so if you go inside the folder</font>

1106
00:42:06,750 --> 00:42:10,260
that you<font color="#CCCCCC"> create</font><font color="#E5E5E5"> push et</font><font color="#CCCCCC"> blah blah w</font>

1107
00:42:08,760 --> 00:42:11,970
<font color="#CCCCCC">something called temp heuristic</font><font color="#E5E5E5"> image</font>

1108
00:42:10,260 --> 00:42:14,460
which will<font color="#CCCCCC"> just</font><font color="#E5E5E5"> be the image that gets</font>

1109
00:42:11,970 --> 00:42:17,359
that<font color="#E5E5E5"> gets sent back and forth with the</font>

1110
00:42:14,460 --> 00:42:17,359
binary encrypted data

1111
00:42:23,240 --> 00:42:28,339
some of the cool<font color="#CCCCCC"> things you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> do with</font>

1112
00:42:24,740 --> 00:42:30,560
it well you can use any of<font color="#E5E5E5"> the modules</font>

1113
00:42:28,340 --> 00:42:31,700
that<font color="#E5E5E5"> you want in PowerShell but I guess</font>

1114
00:42:30,560 --> 00:42:38,330
some of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> great things is</font><font color="#E5E5E5"> like get</font>

1115
00:42:31,700 --> 00:42:40,430
<font color="#E5E5E5">screenshots so again I have a play</font><font color="#CCCCCC"> with</font>

1116
00:42:38,330 --> 00:42:43,549
<font color="#E5E5E5">it's all on github get up /</font><font color="#CCCCCC"> meta choose</font>

1117
00:42:40,430 --> 00:42:44,899
<font color="#CCCCCC">/t - but it's really quite</font><font color="#E5E5E5"> cool but yeah</font>

1118
00:42:43,550 --> 00:42:46,070
<font color="#E5E5E5">I wouldn't go for it all but</font><font color="#CCCCCC"> that's</font>

1119
00:42:44,900 --> 00:42:47,690
basically essentially<font color="#E5E5E5"> what it</font><font color="#CCCCCC"> does and</font>

1120
00:42:46,070 --> 00:42:51,310
how<font color="#CCCCCC"> it works and loads of</font><font color="#E5E5E5"> things like</font>

1121
00:42:47,690 --> 00:42:53,810
<font color="#CCCCCC">Craig popper</font><font color="#E5E5E5"> again that's quite cool one</font>

1122
00:42:51,310 --> 00:42:56,240
but everything I do on<font color="#E5E5E5"> a regimen gaygent</font>

1123
00:42:53,810 --> 00:42:57,650
<font color="#E5E5E5">I kind of we kind of put into this so</font>

1124
00:42:56,240 --> 00:42:59,390
we've kind of done<font color="#CCCCCC"> all</font><font color="#E5E5E5"> the hard work for</font>

1125
00:42:57,650 --> 00:43:01,340
<font color="#E5E5E5">you because I've got a wiki which I've</font>

1126
00:42:59,390 --> 00:43:02,450
got<font color="#E5E5E5"> all my</font><font color="#CCCCCC"> notes for so when running a</font>

1127
00:43:01,340 --> 00:43:04,550
red team and<font color="#E5E5E5"> I'd like maybe wanted to</font>

1128
00:43:02,450 --> 00:43:05,960
latch<font color="#E5E5E5"> remove using</font><font color="#CCCCCC"> WMI or something</font><font color="#E5E5E5"> so</font>

1129
00:43:04,550 --> 00:43:07,790
instead of me<font color="#E5E5E5"> having a wiki now facially</font>

1130
00:43:05,960 --> 00:43:09,020
just pour it all<font color="#CCCCCC"> out</font><font color="#E5E5E5"> into here</font><font color="#CCCCCC"> so all</font>

1131
00:43:07,790 --> 00:43:10,220
the commands<font color="#E5E5E5"> and everything it's all</font>

1132
00:43:09,020 --> 00:43:11,750
there<font color="#E5E5E5"> you can see where it's actually</font>

1133
00:43:10,220 --> 00:43:13,100
<font color="#E5E5E5">running so that's</font><font color="#CCCCCC"> the great thing we're</font>

1134
00:43:11,750 --> 00:43:15,140
<font color="#E5E5E5">not trying to hide</font><font color="#CCCCCC"> anything and we want</font>

1135
00:43:13,100 --> 00:43:16,900
you<font color="#E5E5E5"> to learn when you use this tool so</font>

1136
00:43:15,140 --> 00:43:19,220
just for example<font color="#E5E5E5"> like the pop-up box</font>

1137
00:43:16,900 --> 00:43:20,750
<font color="#E5E5E5">basically that's what it's</font><font color="#CCCCCC"> running on</font>

1138
00:43:19,220 --> 00:43:23,000
the<font color="#E5E5E5"> client so you know we're not trying</font>

1139
00:43:20,750 --> 00:43:26,110
<font color="#CCCCCC">to</font><font color="#E5E5E5"> hide</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> you can see it you</font><font color="#CCCCCC"> can</font>

1140
00:43:23,000 --> 00:43:26,110
win<font color="#E5E5E5"> your own PowerShell commands</font>

1141
00:43:33,900 --> 00:43:37,750
<font color="#CCCCCC">root</font><font color="#E5E5E5"> using a master password</font><font color="#CCCCCC"> so that's a</font>

1142
00:43:36,880 --> 00:43:42,280
really<font color="#E5E5E5"> good way</font><font color="#CCCCCC"> of getting user</font>

1143
00:43:37,750 --> 00:43:44,290
passwords so yeah that's<font color="#CCCCCC"> just a bit</font><font color="#E5E5E5"> of a</font>

1144
00:43:42,280 --> 00:43:45,369
quick demo the output 'html<font color="#CCCCCC"> is quite</font>

1145
00:43:44,290 --> 00:43:46,930
cool<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> which I'll telling you</font>

1146
00:43:45,369 --> 00:43:50,339
about<font color="#E5E5E5"> again</font><font color="#CCCCCC"> I won't I've got anything</font>

1147
00:43:46,930 --> 00:43:50,339
<font color="#E5E5E5">here that's on my slides now</font>

1148
00:43:59,310 --> 00:44:03,870
yeah so a bit<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> road map</font><font color="#CCCCCC"> so we're</font>

1149
00:44:01,290 --> 00:44:05,400
<font color="#E5E5E5">trying to create more methods of the</font>

1150
00:44:03,870 --> 00:44:06,900
initial payloads<font color="#E5E5E5"> we really want to do a</font>

1151
00:44:05,400 --> 00:44:08,250
click<font color="#E5E5E5"> once so that</font><font color="#CCCCCC"> when you</font><font color="#E5E5E5"> open it</font>

1152
00:44:06,900 --> 00:44:10,470
it'll automatically have a<font color="#E5E5E5"> flick once</font>

1153
00:44:08,250 --> 00:44:12,750
application there when I create a<font color="#CCCCCC"> HTA</font>

1154
00:44:10,470 --> 00:44:14,370
which is like a hypertext<font color="#CCCCCC"> application in</font>

1155
00:44:12,750 --> 00:44:15,450
my lap location again which you<font color="#CCCCCC"> might</font>

1156
00:44:14,370 --> 00:44:17,759
<font color="#CCCCCC">want to use when you're sending</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> the</font>

1157
00:44:15,450 --> 00:44:19,710
<font color="#CCCCCC">organization what we also like to do is</font>

1158
00:44:17,760 --> 00:44:21,510
have a<font color="#CCCCCC"> daisy chain</font><font color="#E5E5E5"> method so once you</font>

1159
00:44:19,710 --> 00:44:23,490
target one machine in the organization

1160
00:44:21,510 --> 00:44:25,470
<font color="#E5E5E5">you might want to then laterally move</font>

1161
00:44:23,490 --> 00:44:27,479
but instead<font color="#CCCCCC"> of them all</font><font color="#E5E5E5"> going out of the</font>

1162
00:44:25,470 --> 00:44:29,520
proxy<font color="#E5E5E5"> maybe just use one host so</font><font color="#CCCCCC"> that'll</font>

1163
00:44:27,480 --> 00:44:31,920
<font color="#E5E5E5">be quite a cool little feature also</font><font color="#CCCCCC"> like</font>

1164
00:44:29,520 --> 00:44:33,060
to implement process migration so you're

1165
00:44:31,920 --> 00:44:35,490
always in<font color="#CCCCCC"> the moment</font><font color="#E5E5E5"> in like a</font>

1166
00:44:33,060 --> 00:44:36,870
PowerShell process<font color="#E5E5E5"> so I'd like to be</font>

1167
00:44:35,490 --> 00:44:45,450
able to inject into another procession

1168
00:44:36,870 --> 00:44:47,220
<font color="#E5E5E5">of the running process also complete</font>

1169
00:44:45,450 --> 00:44:48,359
yeah that we<font color="#E5E5E5"> really quite cool and so</font>

1170
00:44:47,220 --> 00:44:50,640
you don't<font color="#CCCCCC"> have to type</font><font color="#E5E5E5"> things</font>

1171
00:44:48,360 --> 00:44:55,800
everything<font color="#E5E5E5"> autocompletes that's Dave's</font>

1172
00:44:50,640 --> 00:44:56,970
job but feel free<font color="#E5E5E5"> to pull</font><font color="#CCCCCC"> request so</font>

1173
00:44:55,800 --> 00:44:59,280
that's how you access<font color="#E5E5E5"> it that's how you</font>

1174
00:44:56,970 --> 00:45:01,379
<font color="#CCCCCC">download it we're</font><font color="#E5E5E5"> actively doing things</font>

1175
00:44:59,280 --> 00:45:01,800
basic daily<font color="#E5E5E5"> probably too much to</font><font color="#CCCCCC"> be</font>

1176
00:45:01,380 --> 00:45:03,600
honest

1177
00:45:01,800 --> 00:45:05,070
but yeah have a look at<font color="#E5E5E5"> it download it</font>

1178
00:45:03,600 --> 00:45:06,900
mess with it it's all PowerShell it's

1179
00:45:05,070 --> 00:45:08,490
basically<font color="#CCCCCC"> two code two lines right two</font>

1180
00:45:06,900 --> 00:45:10,920
lines of code that'll be nice<font color="#E5E5E5"> two</font>

1181
00:45:08,490 --> 00:45:12,240
scripts itself so you've got the C to

1182
00:45:10,920 --> 00:45:13,830
serving you got the implant<font color="#E5E5E5"> handler</font><font color="#CCCCCC"> so</font>

1183
00:45:12,240 --> 00:45:16,979
it's really easy<font color="#CCCCCC"> to edit</font><font color="#E5E5E5"> even you don't</font>

1184
00:45:13,830 --> 00:45:18,360
have to know much<font color="#CCCCCC"> para shell so as I</font>

1185
00:45:16,980 --> 00:45:22,500
said the logging is really an important

1186
00:45:18,360 --> 00:45:24,600
<font color="#E5E5E5">part</font><font color="#CCCCCC"> for us so as you can see</font><font color="#E5E5E5"> here this</font>

1187
00:45:22,500 --> 00:45:26,010
like basically<font color="#E5E5E5"> shows you</font><font color="#CCCCCC"> that's the</font>

1188
00:45:24,600 --> 00:45:27,779
command one that's the implant so you

1189
00:45:26,010 --> 00:45:29,610
get<font color="#E5E5E5"> two HTML files that</font><font color="#CCCCCC"> will tell</font><font color="#E5E5E5"> you</font>

1190
00:45:27,780 --> 00:45:31,500
all<font color="#CCCCCC"> the</font><font color="#E5E5E5"> implants</font><font color="#CCCCCC"> you got when you</font><font color="#E5E5E5"> first</font>

1191
00:45:29,610 --> 00:45:32,880
saw<font color="#E5E5E5"> them when you last saw them the IP</font>

1192
00:45:31,500 --> 00:45:34,670
address<font color="#CCCCCC"> that should be the external IP</font>

1193
00:45:32,880 --> 00:45:36,810
address<font color="#E5E5E5"> because I'm doing</font><font color="#CCCCCC"> it internally</font>

1194
00:45:34,670 --> 00:45:38,340
and<font color="#CCCCCC"> they use</font><font color="#E5E5E5"> it and this is all the</font>

1195
00:45:36,810 --> 00:45:39,360
commands<font color="#CCCCCC"> and everything</font><font color="#E5E5E5"> so if you forget</font>

1196
00:45:38,340 --> 00:45:41,160
<font color="#CCCCCC">to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> something you</font><font color="#E5E5E5"> can just take a</font>

1197
00:45:39,360 --> 00:45:42,150
screenshot<font color="#CCCCCC"> of that and it tells you</font>

1198
00:45:41,160 --> 00:45:43,440
<font color="#CCCCCC">exactly what you've</font><font color="#E5E5E5"> done so you can</font>

1199
00:45:42,150 --> 00:45:53,790
<font color="#CCCCCC">literally go</font><font color="#E5E5E5"> here you go this is what we</font>

1200
00:45:43,440 --> 00:45:55,619
did inside the<font color="#CCCCCC"> organization</font><font color="#E5E5E5"> so anyway I</font>

1201
00:45:53,790 --> 00:45:57,808
believe<font color="#E5E5E5"> sponsored</font><font color="#CCCCCC"> a bar</font>

1202
00:45:55,619 --> 00:45:58,920
which is the most important thing and<font color="#CCCCCC"> I</font>

1203
00:45:57,809 --> 00:46:00,809
<font color="#CCCCCC">think</font><font color="#E5E5E5"> we went through and finished</font><font color="#CCCCCC"> by</font>

1204
00:45:58,920 --> 00:46:01,680
<font color="#CCCCCC">about</font><font color="#E5E5E5"> a half one last year so if we're</font>

1205
00:46:00,809 --> 00:46:03,599
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to try and</font><font color="#E5E5E5"> make it</font><font color="#CCCCCC"> twelve this</font>

1206
00:46:01,680 --> 00:46:19,078
<font color="#E5E5E5">year that we did and if you want to grab</font>

1207
00:46:03,599 --> 00:46:21,440
<font color="#E5E5E5">me for a beer after</font><font color="#CCCCCC"> catch up any</font>

1208
00:46:19,079 --> 00:46:21,440
<font color="#E5E5E5">questions</font>

1209
00:46:24,529 --> 00:46:31,069
define everything yeah

1210
00:46:32,530 --> 00:46:37,930
<font color="#E5E5E5">anymore cool all right let's go get beer</font>

