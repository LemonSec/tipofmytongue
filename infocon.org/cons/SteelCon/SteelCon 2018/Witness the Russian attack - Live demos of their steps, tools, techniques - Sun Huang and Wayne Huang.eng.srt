1
00:00:00,380 --> 00:00:07,950
thanks<font color="#E5E5E5"> very much for coming through our</font>

2
00:00:02,760 --> 00:00:11,250
talk today my name is Wayne and the

3
00:00:07,950 --> 00:00:14,160
<font color="#E5E5E5">research is shortly done by son Paul my</font>

4
00:00:11,250 --> 00:00:16,198
colleague we're from poo point on cell

5
00:00:14,160 --> 00:00:18,840
let him introduce himself first and i'll

6
00:00:16,199 --> 00:00:20,730
be doing most of the talking hey guys my

7
00:00:18,840 --> 00:00:22,980
name is Sam<font color="#E5E5E5"> Hong very happy to be here</font>

8
00:00:20,730 --> 00:00:25,289
<font color="#CCCCCC">I'm if they're researcher at pro point</font>

9
00:00:22,980 --> 00:00:28,050
<font color="#CCCCCC">I'm also pentester all the time years</font>

10
00:00:25,289 --> 00:00:34,260
<font color="#E5E5E5">experience I hope you guys enjoyed his</font>

11
00:00:28,050 --> 00:00:37,170
talk thank you<font color="#CCCCCC"> okay so my name is Wayne</font>

12
00:00:34,260 --> 00:00:41,129
<font color="#E5E5E5">I founded a security company called</font>

13
00:00:37,170 --> 00:00:43,469
almarai technologies in 205 and it was

14
00:00:41,129 --> 00:00:46,849
acquired by<font color="#CCCCCC"> Proofpoint into a 13 proof</font>

15
00:00:43,469 --> 00:00:50,309
point is a public company based

16
00:00:46,850 --> 00:00:52,949
headquartered in sunnyvale so now I run

17
00:00:50,309 --> 00:00:57,169
engineering team in Taiwan which is

18
00:00:52,949 --> 00:01:02,059
about 70-plus people and we do a lot of

19
00:00:57,170 --> 00:01:05,309
research on actors these criminal groups

20
00:01:02,059 --> 00:01:08,670
and I talk a lot at various security

21
00:01:05,309 --> 00:01:11,729
conferences today we're going to be

22
00:01:08,670 --> 00:01:15,840
talking<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> Norton goat campaign</font>

23
00:01:11,729 --> 00:01:19,408
and<font color="#CCCCCC"> the actor we named the Norton goat</font>

24
00:01:15,840 --> 00:01:23,880
because their primary server are that we

25
00:01:19,409 --> 00:01:26,610
found is is translates to Norton goat in

26
00:01:23,880 --> 00:01:30,179
in motion so we're going to be talking

27
00:01:26,610 --> 00:01:33,210
about the attaching phase one in<font color="#E5E5E5"> fake</font>

28
00:01:30,180 --> 00:01:35,549
legitimate websites phase<font color="#E5E5E5"> two target</font>

29
00:01:33,210 --> 00:01:39,600
filtering and skin scanner invasion

30
00:01:35,549 --> 00:01:42,350
their tds s so this group does not have

31
00:01:39,600 --> 00:01:45,179
this group distribute malware by

32
00:01:42,350 --> 00:01:48,059
injecting malicious JavaScript into

33
00:01:45,180 --> 00:01:50,070
legitimate websites and they do<font color="#E5E5E5"> so not</font>

34
00:01:48,060 --> 00:01:52,439
by hacking into these websites this

35
00:01:50,070 --> 00:01:54,270
group doesn't do any hacking I mean

36
00:01:52,439 --> 00:01:56,639
we'll explain how<font color="#E5E5E5"> you know without</font>

37
00:01:54,270 --> 00:01:59,060
hacking how they get into<font color="#E5E5E5"> these websites</font>

38
00:01:56,640 --> 00:02:03,180
to inject these malicious javascript and

39
00:01:59,060 --> 00:02:07,200
then there<font color="#CCCCCC"> is they run a they've always</font>

40
00:02:03,180 --> 00:02:10,739
ran a<font color="#E5E5E5"> tds layer which prevents security</font>

41
00:02:07,200 --> 00:02:14,100
risk researchers like us or automated

42
00:02:10,739 --> 00:02:17,030
scanners crawler robots from

43
00:02:14,100 --> 00:02:20,670
accessing their marriage issue

44
00:02:17,030 --> 00:02:23,610
distribution so<font color="#E5E5E5"> their tds layer make</font>

45
00:02:20,670 --> 00:02:27,059
sure that<font color="#E5E5E5"> they only served the malicious</font>

46
00:02:23,610 --> 00:02:30,090
attacks to the victims that they're

47
00:02:27,060 --> 00:02:33,750
targeting they they specifically would

48
00:02:30,090 --> 00:02:36,060
black list out a lot<font color="#E5E5E5"> of the region's a</font>

49
00:02:33,750 --> 00:02:38,940
lot of countries that<font color="#CCCCCC"> they specifically</font>

50
00:02:36,060 --> 00:02:40,860
<font color="#E5E5E5">would not serve to and of course on</font>

51
00:02:38,940 --> 00:02:44,100
security vendor ip's things like that

52
00:02:40,860 --> 00:02:46,410
that's what their tds is doing getting

53
00:02:44,100 --> 00:02:51,769
into<font color="#CCCCCC"> the user machines will talk about</font>

54
00:02:46,410 --> 00:02:54,990
the exploit kits that they're using<font color="#E5E5E5"> to</font>

55
00:02:51,770 --> 00:02:59,550
serve a piece of malicious JavaScript or

56
00:02:54,990 --> 00:03:02,670
some type of content within a web page

57
00:02:59,550 --> 00:03:06,990
that would exploit some vulnerability

58
00:03:02,670 --> 00:03:09,989
and ultimately cause a download of some

59
00:03:06,990 --> 00:03:12,810
malicious payload into the<font color="#E5E5E5"> endpoints</font>

60
00:03:09,990 --> 00:03:17,700
that's<font color="#E5E5E5"> visiting one of these infected</font>

61
00:03:12,810 --> 00:03:20,220
<font color="#CCCCCC">but legitimate websites and then when</font>

62
00:03:17,700 --> 00:03:24,030
the payload downloads<font color="#E5E5E5"> I will be talking</font>

63
00:03:20,220 --> 00:03:26,220
<font color="#CCCCCC">about the malware it's the base of the</font>

64
00:03:24,030 --> 00:03:28,530
malware is a banking<font color="#CCCCCC"> trojan that's what</font>

65
00:03:26,220 --> 00:03:31,320
they do most but this piece of malware

66
00:03:28,530 --> 00:03:34,380
also has a capability to further

67
00:03:31,320 --> 00:03:35,910
download a lot of malicious modules and

68
00:03:34,380 --> 00:03:43,799
we'll be<font color="#CCCCCC"> talking about these militias</font>

69
00:03:35,910 --> 00:03:45,690
modules as well and and finally after

70
00:03:43,800 --> 00:03:48,420
they've harnessed everything from

71
00:03:45,690 --> 00:03:51,390
infected endpoint after they have stolen

72
00:03:48,420 --> 00:03:54,140
all the credentials the banking<font color="#CCCCCC"> hgp</font>

73
00:03:51,390 --> 00:03:57,649
conversations or<font color="#E5E5E5"> HTTPS conversations</font>

74
00:03:54,140 --> 00:04:00,929
they would turn<font color="#E5E5E5"> that endpoint into a</font>

75
00:03:57,650 --> 00:04:04,110
tunneling a paid tunneling service that

76
00:04:00,930 --> 00:04:06,570
they offer commercially to fellow crime

77
00:04:04,110 --> 00:04:12,780
groups and they have<font color="#E5E5E5"> this very well done</font>

78
00:04:06,570 --> 00:04:16,019
interface where other attackers can

79
00:04:12,780 --> 00:04:18,329
search for a specific IP range for

80
00:04:16,019 --> 00:04:20,339
example on if you want<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> into NASA</font>

81
00:04:18,329 --> 00:04:23,340
and it's very hard to get in well you

82
00:04:20,339 --> 00:04:27,690
can search on their interface for<font color="#CCCCCC"> NASA's</font>

83
00:04:23,340 --> 00:04:29,909
IP range and if it<font color="#CCCCCC"> happens that nASA has</font>

84
00:04:27,690 --> 00:04:31,890
and in fact an<font color="#CCCCCC"> end point then this</font>

85
00:04:29,910 --> 00:04:34,350
service will allow you to<font color="#E5E5E5"> tunnel through</font>

86
00:04:31,890 --> 00:04:36,510
that<font color="#E5E5E5"> endpoint right into the IP range</font>

87
00:04:34,350 --> 00:04:39,930
that<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to get</font><font color="#CCCCCC"> into so you can</font>

88
00:04:36,510 --> 00:04:41,730
search by city state IP range things

89
00:04:39,930 --> 00:04:46,790
like that<font color="#E5E5E5"> so we'll show you that</font>

90
00:04:41,730 --> 00:04:49,170
interface and also the the<font color="#E5E5E5"> back end code</font>

91
00:04:46,790 --> 00:04:51,690
file will<font color="#CCCCCC"> be talking about the victims</font>

92
00:04:49,170 --> 00:04:56,220
which countries to the target<font color="#E5E5E5"> most which</font>

93
00:04:51,690 --> 00:04:59,270
countries they don't target from the

94
00:04:56,220 --> 00:05:04,140
stolen<font color="#CCCCCC"> hcps</font><font color="#E5E5E5"> banking credentials or</font>

95
00:04:59,270 --> 00:05:08,930
conversations which were the the larger

96
00:05:04,140 --> 00:05:12,810
banks that that<font color="#E5E5E5"> have their end users</font>

97
00:05:08,930 --> 00:05:18,390
<font color="#CCCCCC">HCPs conversation stolen and we'll make</font>

98
00:05:12,810 --> 00:05:20,910
a conclusion<font color="#CCCCCC"> okay sonoran go there</font>

99
00:05:18,390 --> 00:05:24,810
russian-speaking<font color="#CCCCCC"> cybercrime group we</font>

100
00:05:20,910 --> 00:05:27,510
don't from their IP range we kind of

101
00:05:24,810 --> 00:05:30,150
know where they are of course we haven't

102
00:05:27,510 --> 00:05:32,550
<font color="#E5E5E5">met the group but</font><font color="#CCCCCC"> from their internal</font>

103
00:05:30,150 --> 00:05:35,070
communication and<font color="#CCCCCC"> the way they comment</font>

104
00:05:32,550 --> 00:05:36,090
their code and the way they name their

105
00:05:35,070 --> 00:05:42,120
files they're definitely

106
00:05:36,090 --> 00:05:50,450
<font color="#E5E5E5">russian-speaking they're using a big</font>

107
00:05:42,120 --> 00:05:53,610
list so they buy these huge lists of

108
00:05:50,450 --> 00:05:55,380
<font color="#CCCCCC">WordPress cpanel and mint usernames and</font>

109
00:05:53,610 --> 00:05:58,940
<font color="#CCCCCC">passwords and that's why we say they</font>

110
00:05:55,380 --> 00:06:04,320
<font color="#CCCCCC">don't do any hacking is perched oh they</font>

111
00:05:58,940 --> 00:06:07,110
purchase from underground markets and

112
00:06:04,320 --> 00:06:12,750
they pay a lot for these these<font color="#E5E5E5"> text</font>

113
00:06:07,110 --> 00:06:17,810
files in there with very specified

114
00:06:12,750 --> 00:06:22,320
format of what are the<font color="#CCCCCC"> C piano URLs</font>

115
00:06:17,810 --> 00:06:27,330
admin ID and password<font color="#E5E5E5"> so they buy these</font>

116
00:06:22,320 --> 00:06:29,520
in mass volumes and then this allows

117
00:06:27,330 --> 00:06:32,099
them<font color="#E5E5E5"> to get into these WordPress sites</font>

118
00:06:29,520 --> 00:06:35,099
legitimate WordPress sites to inject

119
00:06:32,100 --> 00:06:37,960
their malicious JavaScript which

120
00:06:35,100 --> 00:06:43,090
ultimately leads to

121
00:06:37,960 --> 00:06:48,340
download an infection of<font color="#E5E5E5"> a cubot malware</font>

122
00:06:43,090 --> 00:06:51,280
that serve as their base of a botnet

123
00:06:48,340 --> 00:06:55,690
that they have been building so they

124
00:06:51,280 --> 00:06:58,989
built<font color="#E5E5E5"> a cubot bonnet of over 5,000</font>

125
00:06:55,690 --> 00:07:02,410
infected systems right now and they have

126
00:06:58,990 --> 00:07:04,810
sniffed about 800,000 online banking

127
00:07:02,410 --> 00:07:07,449
transactions and<font color="#E5E5E5"> we'll show you the</font>

128
00:07:04,810 --> 00:07:10,720
<font color="#CCCCCC">backend database of that of which about</font>

129
00:07:07,449 --> 00:07:14,800
almost sixty percent or with us online

130
00:07:10,720 --> 00:07:18,820
banks but not us banks online

131
00:07:14,800 --> 00:07:21,449
transactions they operate a

132
00:07:18,820 --> 00:07:25,300
sophisticated paid<font color="#E5E5E5"> processing service as</font>

133
00:07:21,449 --> 00:07:29,470
we've talked<font color="#CCCCCC"> about from all of these</font>

134
00:07:25,300 --> 00:07:33,120
infected endpoints okay so this is the

135
00:07:29,470 --> 00:07:35,770
kill chain at the very left we have the

136
00:07:33,120 --> 00:07:38,889
compromised the legitimate website and

137
00:07:35,770 --> 00:07:43,240
and they'll send their spam out emails

138
00:07:38,889 --> 00:07:46,690
with links to these websites they own a

139
00:07:43,240 --> 00:07:48,909
very<font color="#E5E5E5"> large number</font><font color="#CCCCCC"> of these websites but</font>

140
00:07:46,690 --> 00:07:52,240
they do not infect we've not seen them

141
00:07:48,909 --> 00:07:57,280
in fact<font color="#CCCCCC"> at any point</font><font color="#E5E5E5"> of time more</font><font color="#CCCCCC"> than</font>

142
00:07:52,240 --> 00:07:59,139
300 websites at a time so they own a lot

143
00:07:57,280 --> 00:08:02,349
<font color="#E5E5E5">of these websites but they do not use</font>

144
00:07:59,139 --> 00:08:04,750
them<font color="#E5E5E5"> all at the same time it's always</font><font color="#CCCCCC"> on</font>

145
00:08:02,349 --> 00:08:09,330
so the number is always between about

146
00:08:04,750 --> 00:08:11,949
100 to 300 and they write their own

147
00:08:09,330 --> 00:08:13,659
tools we<font color="#CCCCCC"> have not seen</font><font color="#E5E5E5"> these tools</font>

148
00:08:11,949 --> 00:08:17,080
disclosed elsewhere so we<font color="#E5E5E5"> believe that</font>

149
00:08:13,659 --> 00:08:19,870
<font color="#CCCCCC">they written most of these scripts</font>

150
00:08:17,080 --> 00:08:22,120
themselves to autumn to automatically

151
00:08:19,870 --> 00:08:24,729
implant a backdoor into these websites

152
00:08:22,120 --> 00:08:27,039
and these backdoors talk to their script

153
00:08:24,729 --> 00:08:29,349
so they can constantly upload malicious

154
00:08:27,039 --> 00:08:32,529
JavaScript or remove these malicious

155
00:08:29,349 --> 00:08:34,479
JavaScript from these websites and then

156
00:08:32,529 --> 00:08:37,179
they'll spam out emails improve point

157
00:08:34,479 --> 00:08:40,510
being a email security company that's

158
00:08:37,179 --> 00:08:44,469
one of the reasons why we can get a<font color="#E5E5E5"> lot</font>

159
00:08:40,510 --> 00:08:47,860
of Intel from such a crime group<font color="#E5E5E5"> spam</font>

160
00:08:44,470 --> 00:08:50,320
out these<font color="#E5E5E5"> are all of these links to</font>

161
00:08:47,860 --> 00:08:51,330
legitimate websites when victims click

162
00:08:50,320 --> 00:08:55,180
<font color="#CCCCCC">on these links</font>

163
00:08:51,330 --> 00:08:57,070
they would<font color="#E5E5E5"> be served from these websites</font>

164
00:08:55,180 --> 00:08:59,859
a piece of malicious<font color="#E5E5E5"> JavaScript which we</font>

165
00:08:57,070 --> 00:09:02,590
call a<font color="#CCCCCC"> only a redirector the redirector</font>

166
00:08:59,860 --> 00:09:06,730
would cause the browser to try to fetch

167
00:09:02,590 --> 00:09:09,610
content from the tds the tds then

168
00:09:06,730 --> 00:09:12,730
determines whether this<font color="#CCCCCC"> is somebody that</font>

169
00:09:09,610 --> 00:09:16,480
they want<font color="#E5E5E5"> to attack whether they're</font>

170
00:09:12,730 --> 00:09:20,260
coming<font color="#E5E5E5"> from an end point that their</font>

171
00:09:16,480 --> 00:09:24,190
exploits server there EK exploit kit is

172
00:09:20,260 --> 00:09:26,110
a capable of infecting this group<font color="#E5E5E5"> only</font>

173
00:09:24,190 --> 00:09:29,650
focuses on windows so if you're coming

174
00:09:26,110 --> 00:09:32,590
from a<font color="#CCCCCC"> mac you will be redirected to our</font>

175
00:09:29,650 --> 00:09:35,500
google or to some arbitrary site you

176
00:09:32,590 --> 00:09:38,290
will not be redirected<font color="#CCCCCC"> to their exploit</font>

177
00:09:35,500 --> 00:09:40,690
kit server if you're if you're coming

178
00:09:38,290 --> 00:09:43,689
<font color="#E5E5E5">from your bum to you want they will only</font>

179
00:09:40,690 --> 00:09:48,430
redirect an attack Windows users if

180
00:09:43,690 --> 00:09:49,630
you're coming from if you're situated in

181
00:09:48,430 --> 00:09:53,140
one of<font color="#E5E5E5"> the countries that they</font>

182
00:09:49,630 --> 00:09:55,510
specifically blacklist to not serve they

183
00:09:53,140 --> 00:09:59,680
won't serve to you they have a huge

184
00:09:55,510 --> 00:10:02,680
<font color="#CCCCCC">database of security vendor</font><font color="#E5E5E5"> IPS and</font>

185
00:09:59,680 --> 00:10:05,319
search engine IPS and of course we're on

186
00:10:02,680 --> 00:10:07,599
<font color="#CCCCCC">that list to some of our IPS and if</font>

187
00:10:05,320 --> 00:10:09,850
you're coming<font color="#E5E5E5"> from those IP ranges that</font>

188
00:10:07,600 --> 00:10:12,490
wouldn't serve to you they have<font color="#CCCCCC"> the</font>

189
00:10:09,850 --> 00:10:14,470
<font color="#E5E5E5">database also includes data center Eyed</font>

190
00:10:12,490 --> 00:10:17,560
Peas they wouldn't serve to most of

191
00:10:14,470 --> 00:10:19,060
<font color="#E5E5E5">Amazon AWS because they want home users</font>

192
00:10:17,560 --> 00:10:21,010
they don't you know if you're coming

193
00:10:19,060 --> 00:10:23,050
from<font color="#E5E5E5"> the data center there's some kind</font>

194
00:10:21,010 --> 00:10:25,540
of you<font color="#E5E5E5"> most likely to be a bot and then</font>

195
00:10:23,050 --> 00:10:29,920
want<font color="#E5E5E5"> to serve to you so that's what the</font>

196
00:10:25,540 --> 00:10:32,020
TDS does exploit kit server if the<font color="#E5E5E5"> TDS</font>

197
00:10:29,920 --> 00:10:36,010
determines all right<font color="#CCCCCC"> you're infectable</font>

198
00:10:32,020 --> 00:10:38,260
you're within the range of victims that

199
00:10:36,010 --> 00:10:40,990
they want to target then they redirect

200
00:10:38,260 --> 00:10:43,600
the redirect to an exploit kit which

201
00:10:40,990 --> 00:10:46,660
would then depending anthem the<font color="#E5E5E5"> tds</font>

202
00:10:43,600 --> 00:10:49,240
determines which exploit kids to

203
00:10:46,660 --> 00:10:51,939
redirect you to if you're on Windows

204
00:10:49,240 --> 00:10:55,330
with Internet Explorer your redirected

205
00:10:51,940 --> 00:10:57,820
to some exploit kit and if you're not

206
00:10:55,330 --> 00:11:00,610
using Internet Explorer if using<font color="#E5E5E5"> Chrome</font>

207
00:10:57,820 --> 00:11:02,450
or Fox your redirected to other expert

208
00:11:00,610 --> 00:11:04,400
kids

209
00:11:02,450 --> 00:11:06,950
and sometimes it's also based on<font color="#CCCCCC"> with</font>

210
00:11:04,400 --> 00:11:09,170
<font color="#CCCCCC">the Java installed for exam I'm just</font>

211
00:11:06,950 --> 00:11:12,950
depends<font color="#E5E5E5"> on which type of exploit kit</font>

212
00:11:09,170 --> 00:11:17,060
that they're<font color="#E5E5E5"> using for the different</font>

213
00:11:12,950 --> 00:11:19,760
browsing platforms on<font color="#E5E5E5"> Windows they used</font>

214
00:11:17,060 --> 00:11:23,780
to operate their own exploit kits so

215
00:11:19,760 --> 00:11:26,090
they would rent these shared hosting

216
00:11:23,780 --> 00:11:31,610
servers and they would install their own

217
00:11:26,090 --> 00:11:34,130
ich8 in London since<font color="#E5E5E5"> 2 20 14 they have</font>

218
00:11:31,610 --> 00:11:37,360
started to<font color="#E5E5E5"> not do that they have started</font>

219
00:11:34,130 --> 00:11:40,570
to rent commercially available eks

220
00:11:37,360 --> 00:11:47,000
explicate services from their fellow

221
00:11:40,570 --> 00:11:49,160
attackers their fellow criminals so<font color="#E5E5E5"> so</font>

222
00:11:47,000 --> 00:11:51,470
they don't<font color="#CCCCCC"> want their incase themselves</font>

223
00:11:49,160 --> 00:11:55,640
anymore they rent it as a service now

224
00:11:51,470 --> 00:11:58,610
and then and then here are the in the

225
00:11:55,640 --> 00:12:01,220
<font color="#E5E5E5">middle</font><font color="#CCCCCC"> here are the different exploits</font>

226
00:11:58,610 --> 00:12:05,500
that that would be served out by these e

227
00:12:01,220 --> 00:12:08,200
case on exploit kits to the victims if

228
00:12:05,500 --> 00:12:11,120
exploitation is successful meaning<font color="#CCCCCC"> that</font>

229
00:12:08,200 --> 00:12:13,700
it's either a<font color="#E5E5E5"> zero-day or that the</font>

230
00:12:11,120 --> 00:12:19,010
victim has an unpatched version of

231
00:12:13,700 --> 00:12:21,440
<font color="#E5E5E5">Windows or some browser or Java then</font>

232
00:12:19,010 --> 00:12:24,319
that would<font color="#E5E5E5"> cause a malware to drop</font>

233
00:12:21,440 --> 00:12:27,520
initially it would be the cubot which

234
00:12:24,320 --> 00:12:30,440
serves at the<font color="#E5E5E5"> base the kubaton links are</font>

235
00:12:27,520 --> 00:12:33,079
back to their c2 server command and

236
00:12:30,440 --> 00:12:35,780
control server and we'll talk about the

237
00:12:33,080 --> 00:12:38,540
communication protocol<font color="#CCCCCC"> arm and the</font>

238
00:12:35,780 --> 00:12:41,360
server can cause download<font color="#E5E5E5"> of many</font>

239
00:12:38,540 --> 00:12:45,349
additional malware modules on to that

240
00:12:41,360 --> 00:12:50,390
end system so this illustrates the

241
00:12:45,350 --> 00:12:53,420
entire kill chain so let's<font color="#CCCCCC"> focus first</font>

242
00:12:50,390 --> 00:12:59,540
on the legitimate but compromised

243
00:12:53,420 --> 00:13:02,420
<font color="#E5E5E5">WordPress websites purchase large</font>

244
00:12:59,540 --> 00:13:04,189
numbers of cpanel<font color="#CCCCCC"> admin user names and</font>

245
00:13:02,420 --> 00:13:06,319
passwords<font color="#E5E5E5"> and if you want to be the</font>

246
00:13:04,190 --> 00:13:08,750
seller you have to comply with their

247
00:13:06,320 --> 00:13:11,420
specified format so<font color="#CCCCCC"> you have to convert</font>

248
00:13:08,750 --> 00:13:13,529
your<font color="#CCCCCC"> text file to a format that they can</font>

249
00:13:11,420 --> 00:13:15,479
accept and

250
00:13:13,529 --> 00:13:17,999
they have their own custom-made tool

251
00:13:15,480 --> 00:13:19,860
which verifies one by one<font color="#CCCCCC"> the counts</font>

252
00:13:17,999 --> 00:13:23,399
from<font color="#E5E5E5"> these purchase see panels so the</font>

253
00:13:19,860 --> 00:13:27,240
tool the tool has two parameters on<font color="#CCCCCC"> it's</font>

254
00:13:23,399 --> 00:13:29,310
a script it takes and file an input file

255
00:13:27,240 --> 00:13:31,649
and it generates an output file input

256
00:13:29,310 --> 00:13:35,128
file is the text file that they purchase

257
00:13:31,649 --> 00:13:38,430
output file is all of those output file

258
00:13:35,129 --> 00:13:42,149
is a reduced list with those cpanel

259
00:13:38,430 --> 00:13:44,758
admin accounts that are working and

260
00:13:42,149 --> 00:13:48,269
valid and this what the script does is

261
00:13:44,759 --> 00:13:50,879
would go to the CP n to the C piano URLs

262
00:13:48,269 --> 00:13:54,600
and try to<font color="#CCCCCC"> log in</font><font color="#E5E5E5"> with the</font><font color="#CCCCCC"> user names</font>

263
00:13:50,879 --> 00:13:57,449
with a mean IDs and passwords one by one

264
00:13:54,600 --> 00:14:02,459
<font color="#CCCCCC">from these</font><font color="#E5E5E5"> text files and to validate</font>

265
00:13:57,449 --> 00:14:05,309
which ones are working so<font color="#CCCCCC"> that would be</font>

266
00:14:02,459 --> 00:14:07,079
the cPanel checker peel these are<font color="#E5E5E5"> Perl</font>

267
00:14:05,309 --> 00:14:09,660
scripts or sometimes they do it through

268
00:14:07,079 --> 00:14:15,989
ssh so they have an associate version of

269
00:14:09,660 --> 00:14:18,149
the tool arm and then and then so they

270
00:14:15,990 --> 00:14:22,949
end up with these huge<font color="#E5E5E5"> text files of</font>

271
00:14:18,149 --> 00:14:25,559
websites where<font color="#CCCCCC"> there they're having the</font>

272
00:14:22,949 --> 00:14:29,490
cPanel admins and they'll manually

273
00:14:25,559 --> 00:14:31,500
choose which websites to inject remember

274
00:14:29,490 --> 00:14:37,379
we're talking about<font color="#E5E5E5"> the tds one of the</font>

275
00:14:31,500 --> 00:14:40,350
smartest things about their tds it's

276
00:14:37,379 --> 00:14:43,439
also<font color="#E5E5E5"> that they actively every time they</font>

277
00:14:40,350 --> 00:14:45,899
inject the website manually using these

278
00:14:43,439 --> 00:14:48,120
tools they would configure that

279
00:14:45,899 --> 00:14:50,519
particular website that infected website

280
00:14:48,120 --> 00:14:53,339
into their tds so they're<font color="#CCCCCC"> on their tds</font>

281
00:14:50,519 --> 00:14:55,279
there is actually a very accurate list

282
00:14:53,339 --> 00:15:01,350
of all of the currently<font color="#E5E5E5"> infected</font>

283
00:14:55,279 --> 00:15:04,069
websites<font color="#E5E5E5"> are from them and so when tds</font>

284
00:15:01,350 --> 00:15:08,670
sees these visitors come in in the

285
00:15:04,069 --> 00:15:11,729
referee field in the HTP request has to

286
00:15:08,670 --> 00:15:14,219
include<font color="#CCCCCC"> has to be coming from one of</font>

287
00:15:11,730 --> 00:15:16,050
<font color="#E5E5E5">very infected websites so if you're</font>

288
00:15:14,220 --> 00:15:19,230
coming from<font color="#E5E5E5"> google if your reference</font>

289
00:15:16,050 --> 00:15:22,229
blank the tds wouldn't redirect you so

290
00:15:19,230 --> 00:15:25,589
you<font color="#E5E5E5"> really have to</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> and be coming</font>

291
00:15:22,230 --> 00:15:26,889
<font color="#E5E5E5">from one of theory infected websites to</font>

292
00:15:25,589 --> 00:15:35,199
get you to the

293
00:15:26,889 --> 00:15:40,089
next phase of their attack<font color="#E5E5E5"> okay so they</font>

294
00:15:35,199 --> 00:15:41,769
do the web shall upload by hand when<font color="#E5E5E5"> we</font>

295
00:15:40,089 --> 00:15:47,199
talk about web show it's a small piece

296
00:15:41,769 --> 00:15:50,799
of PHP that they manually upload through

297
00:15:47,199 --> 00:15:54,939
cpanel into one of their selective

298
00:15:50,799 --> 00:15:58,480
websites through the admin account once

299
00:15:54,939 --> 00:16:01,108
they get this PHP script<font color="#CCCCCC"> implanted into</font>

300
00:15:58,480 --> 00:16:07,589
<font color="#E5E5E5">the website somewhere and they usually</font>

301
00:16:01,109 --> 00:16:10,989
would put it in a seemingly legitimate

302
00:16:07,589 --> 00:16:13,089
directory mostly they would hit it<font color="#E5E5E5"> under</font>

303
00:16:10,989 --> 00:16:15,699
one of the directories in<font color="#E5E5E5"> WordPress and</font>

304
00:16:13,089 --> 00:16:17,290
it would you<font color="#CCCCCC"> know give a good final name</font>

305
00:16:15,699 --> 00:16:19,329
so that it wouldn't be that obvious that

306
00:16:17,290 --> 00:16:24,219
that piece<font color="#CCCCCC"> of PHP is in a part of</font>

307
00:16:19,329 --> 00:16:29,858
WordPress on and the directory of course

308
00:16:24,220 --> 00:16:31,869
has to be<font color="#E5E5E5"> accessible to the public and</font>

309
00:16:29,859 --> 00:16:36,639
sometimes they would go and configure

310
00:16:31,869 --> 00:16:38,860
that once this web show this PHP script

311
00:16:36,639 --> 00:16:40,839
has been<font color="#E5E5E5"> uploaded and has been</font>

312
00:16:38,860 --> 00:16:43,569
configured correctly they do not need

313
00:16:40,839 --> 00:16:46,149
ever be a min username<font color="#E5E5E5"> and password</font>

314
00:16:43,569 --> 00:16:48,189
<font color="#E5E5E5">anymore so at this point if the website</font>

315
00:16:46,149 --> 00:16:52,419
admin changes password doesn't<font color="#CCCCCC"> matter</font>

316
00:16:48,189 --> 00:16:55,419
because that piece of PHP script serves

317
00:16:52,419 --> 00:16:58,019
as a back door<font color="#E5E5E5"> um they have another</font>

318
00:16:55,419 --> 00:17:01,720
<font color="#E5E5E5">piece of script that talks to this</font>

319
00:16:58,019 --> 00:17:05,859
inject a PHP script so that they can

320
00:17:01,720 --> 00:17:13,480
create<font color="#CCCCCC"> WordPress and ins or users or</font>

321
00:17:05,859 --> 00:17:18,279
modify any files on the server so the

322
00:17:13,480 --> 00:17:21,010
iframe<font color="#CCCCCC"> er agent PHP is the original file</font>

323
00:17:18,279 --> 00:17:25,799
name of this web show when they manually

324
00:17:21,010 --> 00:17:30,549
upload it they'll give it some name and

325
00:17:25,799 --> 00:17:33,340
their the counterpart that talks to<font color="#E5E5E5"> this</font>

326
00:17:30,549 --> 00:17:36,549
<font color="#E5E5E5">backdoor that tells us back to what what</font>

327
00:17:33,340 --> 00:17:41,459
to do on the infected<font color="#E5E5E5"> website is a perl</font>

328
00:17:36,549 --> 00:17:41,460
script called us ma<font color="#CCCCCC"> iframe Adagio</font>

329
00:17:42,900 --> 00:17:52,960
<font color="#E5E5E5">okay so let's look at some code here the</font>

330
00:17:48,520 --> 00:17:55,389
first one is the<font color="#CCCCCC"> first one is called a</font>

331
00:17:52,960 --> 00:18:00,010
<font color="#CCCCCC">cPanel checkered appeal this is where</font>

332
00:17:55,390 --> 00:18:05,830
they're taking a text file and then

333
00:18:00,010 --> 00:18:07,360
comparing validating the user admin

334
00:18:05,830 --> 00:18:17,500
username and passwords that they have

335
00:18:07,360 --> 00:18:20,409
bought its multi-threaded so so you can

336
00:18:17,500 --> 00:18:22,720
see that<font color="#E5E5E5"> the number of threats by</font>

337
00:18:20,410 --> 00:18:27,250
default they've configured it to<font color="#E5E5E5"> 40 so</font>

338
00:18:22,720 --> 00:18:34,710
<font color="#CCCCCC">they're about 40 threads at a time takes</font>

339
00:18:27,250 --> 00:18:39,100
two input input file<font color="#CCCCCC"> an output</font><font color="#E5E5E5"> file and</font>

340
00:18:34,710 --> 00:18:42,070
then basically just where<font color="#CCCCCC"> you can see</font>

341
00:18:39,100 --> 00:18:43,959
here hose port login password that's it

342
00:18:42,070 --> 00:18:46,270
actually only four parameters but

343
00:18:43,960 --> 00:18:48,460
reading these four parameters at a time

344
00:18:46,270 --> 00:18:53,170
from the text file<font color="#E5E5E5"> and then they would</font>

345
00:18:48,460 --> 00:18:56,140
<font color="#CCCCCC">go</font><font color="#E5E5E5"> they know the cpanel on protocol HTTP</font>

346
00:18:53,170 --> 00:19:03,370
format and they were<font color="#CCCCCC"> just verify one by</font>

347
00:18:56,140 --> 00:19:06,730
one<font color="#E5E5E5"> okay the second one is I framer</font>

348
00:19:03,370 --> 00:19:19,120
agent dot PHP this is the web shell that

349
00:19:06,730 --> 00:19:22,240
we talked about let's see so pure is ok

350
00:19:19,120 --> 00:19:27,310
so for<font color="#E5E5E5"> example it has create wordpress</font>

351
00:19:22,240 --> 00:19:29,950
user<font color="#CCCCCC"> ok so on</font><font color="#E5E5E5"> the web once this PHP</font>

352
00:19:27,310 --> 00:19:32,230
script has been implanted then they can

353
00:19:29,950 --> 00:19:37,110
use their perl script to talk to it to

354
00:19:32,230 --> 00:19:37,110
create additional web wordpress users

355
00:19:37,860 --> 00:19:48,399
execute injection so you can see we<font color="#CCCCCC"> can</font>

356
00:19:43,180 --> 00:19:51,130
see<font color="#E5E5E5"> here that it returns</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> one if it's</font>

357
00:19:48,400 --> 00:19:53,149
successful and returns to if the file

358
00:19:51,130 --> 00:19:56,869
has already been injected previous

359
00:19:53,149 --> 00:20:00,369
how how do they know<font color="#E5E5E5"> that the files been</font>

360
00:19:56,869 --> 00:20:02,959
injected previously so and how do they

361
00:20:00,369 --> 00:20:06,879
support a feature to remove their

362
00:20:02,960 --> 00:20:09,830
injection<font color="#CCCCCC"> okay injecting a file this is</font>

363
00:20:06,879 --> 00:20:13,189
they they want to have a piece of

364
00:20:09,830 --> 00:20:16,639
malicious<font color="#E5E5E5"> JavaScript a redirector served</font>

365
00:20:13,190 --> 00:20:19,909
out on every page of this<font color="#CCCCCC"> WordPress</font>

366
00:20:16,639 --> 00:20:23,119
website so they<font color="#CCCCCC"> have this piece of</font>

367
00:20:19,909 --> 00:20:26,029
JavaScript<font color="#CCCCCC"> that would cause the browser</font>

368
00:20:23,119 --> 00:20:28,099
to start to fetch from their tds and so

369
00:20:26,029 --> 00:20:29,929
they want to inject this<font color="#E5E5E5"> JavaScript</font>

370
00:20:28,099 --> 00:20:32,899
somewhere in one of the files in

371
00:20:29,929 --> 00:20:35,839
<font color="#E5E5E5">WordPress that will cause an ultimate</font>

372
00:20:32,899 --> 00:20:37,789
result of every page of that WordPress

373
00:20:35,839 --> 00:20:40,190
website includes that piece of

374
00:20:37,789 --> 00:20:45,859
<font color="#E5E5E5">JavaScript so it can be multiple files</font>

375
00:20:40,190 --> 00:20:51,519
in<font color="#E5E5E5"> WordPress but the key is this block</font>

376
00:20:45,859 --> 00:20:57,889
of JavaScript that<font color="#CCCCCC"> they want to inject</font>

377
00:20:51,519 --> 00:20:59,690
they prepend and append so before<font color="#E5E5E5"> this</font>

378
00:20:57,889 --> 00:21:03,678
piece of JavaScript and right after this

379
00:20:59,690 --> 00:21:07,129
piece of JavaScript day they would add 2

380
00:21:03,679 --> 00:21:10,429
comments and these comments are in

381
00:21:07,129 --> 00:21:12,678
arbitrary strings so as to make

382
00:21:10,429 --> 00:21:16,839
signature in hard so they<font color="#CCCCCC"> are</font><font color="#E5E5E5"> not fixed</font>

383
00:21:12,679 --> 00:21:21,379
screens on but they're fixed lens<font color="#E5E5E5"> okay</font>

384
00:21:16,839 --> 00:21:23,570
and so so and when they when they're

385
00:21:21,379 --> 00:21:25,339
trying<font color="#CCCCCC"> to detect whether a file has been</font>

386
00:21:23,570 --> 00:21:28,309
injected previously with a block of

387
00:21:25,339 --> 00:21:31,339
<font color="#E5E5E5">JavaScript by their own people is if</font>

388
00:21:28,309 --> 00:21:33,589
they would this piece of PHP script will

389
00:21:31,339 --> 00:21:37,009
go and<font color="#CCCCCC"> look in that file and with it</font>

390
00:21:33,589 --> 00:21:42,109
would search whether in the file exists

391
00:21:37,009 --> 00:21:47,659
<font color="#CCCCCC">to</font><font color="#E5E5E5"> comments of fixed length I forgot how</font>

392
00:21:42,109 --> 00:21:51,070
many<font color="#E5E5E5"> bytes it is 0 16 bytes 16</font>

393
00:21:47,659 --> 00:21:57,769
characters so if this file sees within

394
00:21:51,070 --> 00:22:00,468
any PHP or HTML to HTML comments each of

395
00:21:57,769 --> 00:22:06,230
<font color="#E5E5E5">exactly 16 bytes then they would they</font>

396
00:22:00,469 --> 00:22:08,630
would then decide that ok so what

397
00:22:06,230 --> 00:22:11,990
these Commons is a piece of JavaScript

398
00:22:08,630 --> 00:22:15,080
out we injected in the past so so that

399
00:22:11,990 --> 00:22:18,140
they wouldn't<font color="#CCCCCC"> be injecting a wordpress</font>

400
00:22:15,080 --> 00:22:20,449
site twice and this<font color="#E5E5E5"> would allow that of</font>

401
00:22:18,140 --> 00:22:22,220
course it's<font color="#E5E5E5"> not very accurate they can</font>

402
00:22:20,450 --> 00:22:23,809
make mistakes<font color="#E5E5E5"> but it doesn't matter if</font>

403
00:22:22,220 --> 00:22:27,559
<font color="#E5E5E5">they blow up the website or</font><font color="#CCCCCC"> just go to</font>

404
00:22:23,809 --> 00:22:32,678
<font color="#E5E5E5">another next one on so this also allows</font>

405
00:22:27,559 --> 00:22:32,678
them to remove their previous injections

406
00:22:42,930 --> 00:22:48,270
smart iframe repeal this is the perl

407
00:22:45,840 --> 00:22:50,850
script that serves that<font color="#E5E5E5"> the counterpart</font>

408
00:22:48,270 --> 00:22:57,090
to that web show<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is what they</font>

409
00:22:50,850 --> 00:22:59,810
run manually to talk to<font color="#E5E5E5"> our multiple</font>

410
00:22:57,090 --> 00:23:02,250
websites with the same protocol and

411
00:22:59,810 --> 00:23:06,830
inject that piece of<font color="#E5E5E5"> JavaScript into</font>

412
00:23:02,250 --> 00:23:10,140
multiple websites it reads a

413
00:23:06,830 --> 00:23:18,260
configuration file so we<font color="#CCCCCC"> can see</font><font color="#E5E5E5"> here</font>

414
00:23:10,140 --> 00:23:18,260
that here is the web show path<font color="#CCCCCC"> okay and</font>

415
00:23:18,980 --> 00:23:32,640
and this like jquery this one is is the

416
00:23:27,380 --> 00:23:34,500
the file that they want to inject the

417
00:23:32,640 --> 00:23:36,240
file within which they want to inject

418
00:23:34,500 --> 00:23:39,410
their piece<font color="#CCCCCC"> of JavaScript so they offer</font>

419
00:23:36,240 --> 00:23:42,900
inject it into one of<font color="#CCCCCC"> the legitimate</font>

420
00:23:39,410 --> 00:23:45,120
WordPress files or legitimate files on

421
00:23:42,900 --> 00:23:47,040
the website Drake query is too<font color="#E5E5E5"> often use</font>

422
00:23:45,120 --> 00:23:51,179
one so they would inject that piece of

423
00:23:47,040 --> 00:23:54,090
militia<font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> with in jQuery data</font>

424
00:23:51,180 --> 00:23:56,430
<font color="#CCCCCC">tail their injection perimeter supports</font>

425
00:23:54,090 --> 00:23:59,520
on so this is<font color="#E5E5E5"> how how they do the</font>

426
00:23:56,430 --> 00:24:01,530
injection be on the perl script<font color="#E5E5E5"> talk to</font>

427
00:23:59,520 --> 00:24:05,400
the PHP script and tell us the PHP

428
00:24:01,530 --> 00:24:08,160
script I want to inject in<font color="#E5E5E5"> jQuery</font>

429
00:24:05,400 --> 00:24:11,460
thought<font color="#CCCCCC"> Jas right this is file that one</font>

430
00:24:08,160 --> 00:24:13,320
inject and i<font color="#CCCCCC"> want it i want you to find</font>

431
00:24:11,460 --> 00:24:14,670
that<font color="#CCCCCC"> i want you to find the first</font>

432
00:24:13,320 --> 00:24:17,429
<font color="#CCCCCC">occurrence of this regular expression</font>

433
00:24:14,670 --> 00:24:20,370
and that regular expression is actually

434
00:24:17,430 --> 00:24:23,190
just a marker right and<font color="#CCCCCC"> i want you to</font>

435
00:24:20,370 --> 00:24:26,689
inject after<font color="#CCCCCC"> you found the first match</font>

436
00:24:23,190 --> 00:24:29,160
of this<font color="#CCCCCC"> reg ex then please inject my</font>

437
00:24:26,690 --> 00:24:32,340
malicious<font color="#CCCCCC"> JavaScript either at the</font>

438
00:24:29,160 --> 00:24:34,050
<font color="#E5E5E5">beginning of that marker of that</font>

439
00:24:32,340 --> 00:24:38,760
occurrence or at the tail of that

440
00:24:34,050 --> 00:24:42,030
occurrence so<font color="#CCCCCC"> data tail here you can</font><font color="#E5E5E5"> see</font>

441
00:24:38,760 --> 00:24:44,730
<font color="#CCCCCC">they specified and this is an actual</font>

442
00:24:42,030 --> 00:24:48,210
configuration file we've retrieved on

443
00:24:44,730 --> 00:24:50,820
they they are they often use the<font color="#E5E5E5"> tail</font>

444
00:24:48,210 --> 00:24:53,280
parameter which means find this regex

445
00:24:50,820 --> 00:24:54,460
find the first<font color="#E5E5E5"> occurrence and inject</font>

446
00:24:53,280 --> 00:24:58,899
right afterwards

447
00:24:54,460 --> 00:25:04,570
and then<font color="#CCCCCC"> there j s code would be here it</font>

448
00:24:58,900 --> 00:25:08,290
would put their<font color="#E5E5E5"> JS code here</font><font color="#CCCCCC"> okay so as</font>

449
00:25:04,570 --> 00:25:13,090
you can see the the perl script with

450
00:25:08,290 --> 00:25:19,030
reads the configuration file<font color="#CCCCCC"> and then it</font>

451
00:25:13,090 --> 00:25:29,889
supports two parameters usage check or

452
00:25:19,030 --> 00:25:32,020
edit so it can either check or edit and

453
00:25:29,890 --> 00:25:35,860
<font color="#CCCCCC">they it would go and do its thing</font><font color="#E5E5E5"> we</font>

454
00:25:32,020 --> 00:25:40,740
would do the regular expression and it

455
00:25:35,860 --> 00:25:43,600
would decide whether to inject at the

456
00:25:40,740 --> 00:25:52,620
right before the occurrence or at the

457
00:25:43,600 --> 00:25:59,040
tail of an occurrence and would open the

458
00:25:52,620 --> 00:25:59,040
<font color="#CCCCCC">JavaScript prepare</font><font color="#E5E5E5"> it for injection</font>

459
00:26:03,290 --> 00:26:15,350
and here is where it's preparing the

460
00:26:11,000 --> 00:26:18,890
fixed comments that we've talked about

461
00:26:15,350 --> 00:26:22,419
<font color="#CCCCCC">ask markers for the beginning</font><font color="#E5E5E5"> end of the</font>

462
00:26:18,890 --> 00:26:22,420
affair injection

463
00:26:29,420 --> 00:26:41,680
ok

464
00:26:32,140 --> 00:26:47,410
how come so if you if we take a URL of

465
00:26:41,680 --> 00:26:50,560
one of their infected websites or if we

466
00:26:47,410 --> 00:26:52,630
take that<font color="#CCCCCC"> piece of JavaScript that they</font>

467
00:26:50,560 --> 00:26:56,050
have injected into these websites that

468
00:26:52,630 --> 00:27:00,100
redirects to tedia the<font color="#E5E5E5"> tds or if we take</font>

469
00:26:56,050 --> 00:27:02,980
the the malicious payload the cubot

470
00:27:00,100 --> 00:27:07,659
that's been downloaded to the end point

471
00:27:02,980 --> 00:27:10,540
once exploitation is successful usually

472
00:27:07,660 --> 00:27:12,850
<font color="#E5E5E5">thriller down to virustotal the anti</font>

473
00:27:10,540 --> 00:27:17,590
virus detection is usually between 0 to

474
00:27:12,850 --> 00:27:25,389
5 out of<font color="#CCCCCC"> the 55 our security vendors on</font>

475
00:27:17,590 --> 00:27:29,530
virustotal why is that<font color="#CCCCCC"> okay hold</font><font color="#E5E5E5"> on I'll</font>

476
00:27:25,390 --> 00:27:32,010
get through that ok so we've talked

477
00:27:29,530 --> 00:27:32,010
about<font color="#CCCCCC"> this</font>

478
00:27:36,690 --> 00:27:49,430
okay okay so i skipped too much talk

479
00:27:41,730 --> 00:27:51,770
<font color="#CCCCCC">about that later okay so back to the</font>

480
00:27:49,430 --> 00:27:55,680
script that<font color="#E5E5E5"> they're validating the</font>

481
00:27:51,770 --> 00:27:58,710
<font color="#CCCCCC">WordPress a means um it's also that it</font>

482
00:27:55,680 --> 00:28:01,650
also<font color="#E5E5E5"> is a feature to to collect</font>

483
00:27:58,710 --> 00:28:04,950
signatures<font color="#E5E5E5"> of the server right so it's</font>

484
00:28:01,650 --> 00:28:06,600
because what they have purchased this is

485
00:28:04,950 --> 00:28:08,550
not where press that means it's actually

486
00:28:06,600 --> 00:28:11,550
see pain alignments so they have to make

487
00:28:08,550 --> 00:28:12,960
sure that this website<font color="#CCCCCC"> is running</font>

488
00:28:11,550 --> 00:28:16,139
wordpress and the way they do that is

489
00:28:12,960 --> 00:28:20,700
they use the cpanel checker also to

490
00:28:16,140 --> 00:28:22,500
collect on some signatures from some

491
00:28:20,700 --> 00:28:24,240
characteristics from that server and

492
00:28:22,500 --> 00:28:26,430
that would include the<font color="#CCCCCC"> number of HTML</font>

493
00:28:24,240 --> 00:28:29,880
files number of PHP files asp files

494
00:28:26,430 --> 00:28:32,490
pearl files things like<font color="#CCCCCC"> that and just</font><font color="#E5E5E5"> by</font>

495
00:28:29,880 --> 00:28:34,800
the numbers on they would determine they

496
00:28:32,490 --> 00:28:38,070
would decide<font color="#CCCCCC"> okay whether whether this</font>

497
00:28:34,800 --> 00:28:41,010
website it definitely has a<font color="#E5E5E5"> cpanel but</font>

498
00:28:38,070 --> 00:28:43,740
is it wordpress or not so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

499
00:28:41,010 --> 00:28:49,020
way that they distinguish and they

500
00:28:43,740 --> 00:28:52,020
identify<font color="#CCCCCC"> wordpress sites okay so this is</font>

501
00:28:49,020 --> 00:28:53,700
an illustration they have that piece<font color="#CCCCCC"> of</font>

502
00:28:52,020 --> 00:28:55,800
JavaScript redirector that they want to

503
00:28:53,700 --> 00:28:57,630
put<font color="#E5E5E5"> into the compromise website so what</font>

504
00:28:55,800 --> 00:28:59,879
they do is they use the cpanel upload

505
00:28:57,630 --> 00:29:02,210
iframe agent dot PHP which we talked

506
00:28:59,880 --> 00:29:06,690
about<font color="#E5E5E5"> and they had the script called</font>

507
00:29:02,210 --> 00:29:10,290
smart iframe repeal that would take read

508
00:29:06,690 --> 00:29:13,170
in this<font color="#E5E5E5"> piece of JavaScript send it a go</font>

509
00:29:10,290 --> 00:29:17,000
talk<font color="#CCCCCC"> to the web show I frame agent</font><font color="#E5E5E5"> PHP</font>

510
00:29:13,170 --> 00:29:19,590
are in help that PHP inject their

511
00:29:17,000 --> 00:29:22,350
JavaScript redirector into one of the

512
00:29:19,590 --> 00:29:25,770
files are within these compromised

513
00:29:22,350 --> 00:29:28,709
websites with the with<font color="#CCCCCC"> the ending result</font>

514
00:29:25,770 --> 00:29:31,340
to be<font color="#E5E5E5"> that their</font><font color="#CCCCCC"> JavaScript would get</font>

515
00:29:28,710 --> 00:29:35,820
served on every page of these websites

516
00:29:31,340 --> 00:29:38,790
okay done with that and then<font color="#CCCCCC"> if you're</font>

517
00:29:35,820 --> 00:29:42,110
within their target range a victim would

518
00:29:38,790 --> 00:29:42,110
be redirected to<font color="#CCCCCC"> it</font><font color="#E5E5E5"> hideous</font>

519
00:29:44,030 --> 00:29:52,190
okay so um you<font color="#CCCCCC"> can see that this is how</font>

520
00:29:48,870 --> 00:29:52,189
injection would look like

521
00:30:01,510 --> 00:30:04,110
ok

522
00:30:06,230 --> 00:30:12,700
there we go

523
00:30:08,920 --> 00:30:15,630
ok this is the fixed comment followed by

524
00:30:12,700 --> 00:30:24,940
alert that's our JavaScript followed by

525
00:30:15,630 --> 00:30:27,820
16 characters of fixed comment smart

526
00:30:24,940 --> 00:30:30,430
iframe adopt feel remotely talks to I

527
00:30:27,820 --> 00:30:36,750
framer agent sends HTTP<font color="#CCCCCC"> requests then</font>

528
00:30:30,430 --> 00:30:44,020
Jake<font color="#CCCCCC"> draya's code JS code reader x 2 tds</font>

529
00:30:36,750 --> 00:30:45,220
<font color="#CCCCCC">review that ok so there are multiple</font>

530
00:30:44,020 --> 00:30:48,250
things that they're doing to evade

531
00:30:45,220 --> 00:30:50,740
antivirus election one is ah they've

532
00:30:48,250 --> 00:30:52,570
always been using java application and

533
00:30:50,740 --> 00:30:54,820
the tool that they have been using<font color="#E5E5E5"> for a</font>

534
00:30:52,570 --> 00:31:01,210
number of years is the J sub trial

535
00:30:54,820 --> 00:31:03,850
version on so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> how the office the</font>

536
00:31:01,210 --> 00:31:07,480
office<font color="#CCCCCC"> Katie coat looks like</font><font color="#E5E5E5"> the office</font>

537
00:31:03,850 --> 00:31:11,199
<font color="#E5E5E5">cated tds URL in 20 14 would look like</font>

538
00:31:07,480 --> 00:31:14,260
this and so<font color="#E5E5E5"> every time when we move we</font>

539
00:31:11,200 --> 00:31:18,820
kind of see this format with a with the

540
00:31:14,260 --> 00:31:21,310
<font color="#CCCCCC">K</font><font color="#E5E5E5"> Indian followed by perimeter TS we</font>

541
00:31:18,820 --> 00:31:25,389
kind of know it's you know<font color="#E5E5E5"> it's from</font>

542
00:31:21,310 --> 00:31:30,159
<font color="#E5E5E5">this group today into a 16 they're still</font>

543
00:31:25,390 --> 00:31:32,590
using the<font color="#E5E5E5"> J subversion uh the the script</font>

544
00:31:30,160 --> 00:31:35,410
looks a little bit different<font color="#CCCCCC"> um that's</font>

545
00:31:32,590 --> 00:31:38,439
<font color="#E5E5E5">how the obfuscation looks right now the</font>

546
00:31:35,410 --> 00:31:43,470
off you skated script on there is always

547
00:31:38,440 --> 00:31:46,780
a view forum armed with in the middle of

548
00:31:43,470 --> 00:31:48,370
the script so this is how it<font color="#E5E5E5"> within the</font>

549
00:31:46,780 --> 00:31:52,420
<font color="#E5E5E5">middle of the URL this is how it looks</font>

550
00:31:48,370 --> 00:31:55,679
<font color="#E5E5E5">today and so they have been using</font><font color="#CCCCCC"> this J</font>

551
00:31:52,420 --> 00:31:55,680
sub tool for about four years

552
00:31:58,720 --> 00:32:08,140
okay their tds prior to 20 13 they were

553
00:32:02,740 --> 00:32:10,299
running their<font color="#E5E5E5"> own on simple tds from 213</font>

554
00:32:08,140 --> 00:32:14,789
to march 20 14 they were running<font color="#E5E5E5"> their</font>

555
00:32:10,299 --> 00:32:19,870
catarrhal<font color="#E5E5E5"> tds and then all of a sudden</font>

556
00:32:14,789 --> 00:32:25,240
from<font color="#E5E5E5"> march four of 30 14 to present they</font>

557
00:32:19,870 --> 00:32:27,189
have been renting<font color="#E5E5E5"> sutra tedious common</font>

558
00:32:25,240 --> 00:32:32,710
tds features we've talked about this IP

559
00:32:27,190 --> 00:32:35,770
range language referers may the main

560
00:32:32,710 --> 00:32:38,980
objective<font color="#CCCCCC"> here is to avoid crawlers and</font>

561
00:32:35,770 --> 00:32:42,309
security scanners and offer traffic stat

562
00:32:38,980 --> 00:32:45,190
dashboards<font color="#E5E5E5"> okay so this is how</font><font color="#CCCCCC"> they're</font>

563
00:32:42,309 --> 00:32:52,658
today how<font color="#CCCCCC"> their sutra tds control panel</font>

564
00:32:45,190 --> 00:32:59,580
looks like um one example for example

565
00:32:52,659 --> 00:32:59,580
it's okay<font color="#CCCCCC"> i hear you so for</font><font color="#E5E5E5"> example</font>

566
00:32:59,970 --> 00:33:08,380
block right visitors with blank<font color="#CCCCCC"> refere</font>

567
00:33:04,210 --> 00:33:11,140
block and actually<font color="#E5E5E5"> um they've also</font>

568
00:33:08,380 --> 00:33:13,659
configure that as we said a detailed

569
00:33:11,140 --> 00:33:15,220
list of all of the<font color="#E5E5E5"> infected websites so</font>

570
00:33:13,659 --> 00:33:17,140
you it's not<font color="#CCCCCC"> only that you can't be</font>

571
00:33:15,220 --> 00:33:21,700
<font color="#CCCCCC">blank</font><font color="#E5E5E5"> you have to become</font><font color="#CCCCCC"> from one of</font>

572
00:33:17,140 --> 00:33:26,620
those and for example<font color="#CCCCCC"> block all of these</font>

573
00:33:21,700 --> 00:33:31,150
countries right so they specifically

574
00:33:26,620 --> 00:33:33,039
named all these countries as not one<font color="#CCCCCC"> of</font>

575
00:33:31,150 --> 00:33:34,780
the countries that they<font color="#E5E5E5"> want in fact so</font>

576
00:33:33,039 --> 00:33:37,620
if you're coming if your IPS within one

577
00:33:34,780 --> 00:33:40,780
of<font color="#E5E5E5"> these countries wouldn't get infected</font>

578
00:33:37,620 --> 00:33:43,539
because<font color="#E5E5E5"> they they know ultimately</font>

579
00:33:40,780 --> 00:33:45,668
they're trying<font color="#E5E5E5"> to steal our online</font>

580
00:33:43,539 --> 00:33:52,750
banking credentials and that requires to

581
00:33:45,669 --> 00:33:56,500
them to know<font color="#CCCCCC"> very precisely the the htp</font>

582
00:33:52,750 --> 00:33:58,600
format and hepes conversation format of

583
00:33:56,500 --> 00:34:00,940
these bangs that they're targeting so if

584
00:33:58,600 --> 00:34:04,469
you're<font color="#E5E5E5"> not going to be one of the</font><font color="#CCCCCC"> users</font>

585
00:34:00,940 --> 00:34:07,610
<font color="#CCCCCC">to these banks didn't want to infect you</font>

586
00:34:04,470 --> 00:34:10,429
and as you can see here is<font color="#CCCCCC"> the rule</font>

587
00:34:07,610 --> 00:34:12,799
or<font color="#E5E5E5"> ie and this is how</font><font color="#CCCCCC"> they identify ie</font>

588
00:34:10,429 --> 00:34:15,668
so it's basically this whole thing is

589
00:34:12,800 --> 00:34:21,010
basically saying if you're using<font color="#CCCCCC"> ie and</font>

590
00:34:15,668 --> 00:34:23,629
and if you're within the within the

591
00:34:21,010 --> 00:34:28,580
target range that they want to redirect

592
00:34:23,629 --> 00:34:33,379
you to the sweet orange exploit kit this

593
00:34:28,580 --> 00:34:35,569
one um if you're using Firefox still

594
00:34:33,379 --> 00:34:43,190
sweet orange and the way to recognize

595
00:34:35,570 --> 00:34:47,080
Firefox is very easy agent string and um

596
00:34:43,190 --> 00:34:52,550
so for the rest chrome safari opera

597
00:34:47,080 --> 00:34:57,710
wherever they're redirecting to some

598
00:34:52,550 --> 00:34:59,270
<font color="#E5E5E5">java exploit java applet some exploits</font>

599
00:34:57,710 --> 00:35:06,170
that they put<font color="#CCCCCC"> together that works again</font>

600
00:34:59,270 --> 00:35:08,720
shop<font color="#CCCCCC"> okay and this is their big referee</font>

601
00:35:06,170 --> 00:35:11,150
list of all<font color="#CCCCCC"> of they infect the website</font>

602
00:35:08,720 --> 00:35:19,129
so the refere also has to be coming<font color="#E5E5E5"> from</font>

603
00:35:11,150 --> 00:35:22,970
one of<font color="#CCCCCC"> these we can see the summary when</font>

604
00:35:19,130 --> 00:35:27,850
we captured this screenshot on they had

605
00:35:22,970 --> 00:35:35,990
a total of twenty-three million unique

606
00:35:27,850 --> 00:35:39,740
visitors of and 47 million wall hits 22

607
00:35:35,990 --> 00:35:44,359
this particular tds before the<font color="#CCCCCC"> PD</font>

608
00:35:39,740 --> 00:35:47,660
<font color="#CCCCCC">attributes' of course so we can look at</font>

609
00:35:44,359 --> 00:35:52,310
the accepted tds browser hit

610
00:35:47,660 --> 00:35:56,149
distribution so these are the accepted

611
00:35:52,310 --> 00:36:00,590
visitors that was subsequently served

612
00:35:56,150 --> 00:36:01,790
with exploits on as you can see no no

613
00:36:00,590 --> 00:36:05,390
<font color="#CCCCCC">Safari or whatever they're only</font>

614
00:36:01,790 --> 00:36:09,880
targeting windows firefox about forty

615
00:36:05,390 --> 00:36:14,109
three percent IE family about half that

616
00:36:09,880 --> 00:36:14,109
just for<font color="#E5E5E5"> this particular group</font>

617
00:36:15,850 --> 00:36:22,390
okay so let's talk<font color="#CCCCCC"> about so so we're</font>

618
00:36:20,410 --> 00:36:26,879
<font color="#E5E5E5">done</font><font color="#CCCCCC"> with the TDS let's talk about</font><font color="#E5E5E5"> their</font>

619
00:36:22,390 --> 00:36:26,879
eks and the exploits that they're using

620
00:36:29,940 --> 00:36:38,920
so again the refere has to be checked as

621
00:36:36,400 --> 00:36:45,640
to match and that's the obvious skated

622
00:36:38,920 --> 00:36:47,260
JavaScript that's been served and

623
00:36:45,640 --> 00:36:49,900
depending on the different browser

624
00:36:47,260 --> 00:36:52,330
environments you would get served on two

625
00:36:49,900 --> 00:36:57,060
different into a 16 that we're using

626
00:36:52,330 --> 00:37:00,310
rigging<font color="#CCCCCC"> cake they do not run their own</font>

627
00:36:57,060 --> 00:37:03,670
exploit servers all of these that you

628
00:37:00,310 --> 00:37:06,400
saw they rent as a paid service so they

629
00:37:03,670 --> 00:37:09,190
don't operate these exploits they<font color="#E5E5E5"> just</font>

630
00:37:06,400 --> 00:37:12,040
provide provide the exploits with the

631
00:37:09,190 --> 00:37:15,040
<font color="#CCCCCC">ultimate of these exploit kit providers</font>

632
00:37:12,040 --> 00:37:18,520
with<font color="#CCCCCC"> the ultimate</font><font color="#E5E5E5"> payload</font><font color="#CCCCCC"> that they want</font>

633
00:37:15,040 --> 00:37:21,040
to spread out and they redirect traffic

634
00:37:18,520 --> 00:37:27,610
to these e case but they don't want<font color="#CCCCCC"> the</font>

635
00:37:21,040 --> 00:37:32,710
easy case okay so this<font color="#CCCCCC"> was what we were</font>

636
00:37:27,610 --> 00:37:34,720
talking about<font color="#E5E5E5"> on they were they had this</font>

637
00:37:32,710 --> 00:37:37,080
tool that they they have written

638
00:37:34,720 --> 00:37:40,000
themselves to check against skin for you

639
00:37:37,080 --> 00:37:44,500
abusing skin for use API skin for you is

640
00:37:40,000 --> 00:37:46,930
kind<font color="#E5E5E5"> of like virustotal it has I believe</font>

641
00:37:44,500 --> 00:37:49,150
30 or 40 some security vendors that it

642
00:37:46,930 --> 00:37:54,930
works with and so what this group would

643
00:37:49,150 --> 00:37:59,860
do is it would constantly be submitting

644
00:37:54,930 --> 00:38:02,350
all of its infrastructure to skin for

645
00:37:59,860 --> 00:38:05,110
use API to make sure that for example

646
00:38:02,350 --> 00:38:08,049
<font color="#CCCCCC">they're less</font><font color="#E5E5E5"> than 300 infected websites</font>

647
00:38:05,110 --> 00:38:11,710
are not blacklisted by any security

648
00:38:08,050 --> 00:38:14,890
vendor ah their tds URLs or not

649
00:38:11,710 --> 00:38:17,050
blacklisted<font color="#CCCCCC"> the exploit server URLs are</font>

650
00:38:14,890 --> 00:38:19,450
not blacklisted<font color="#CCCCCC"> there are malicious</font>

651
00:38:17,050 --> 00:38:21,790
<font color="#E5E5E5">JavaScript</font><font color="#CCCCCC"> that they opted you skate</font>

652
00:38:19,450 --> 00:38:24,970
using JSON and upload to these web

653
00:38:21,790 --> 00:38:26,880
servers are not detected or flagged by

654
00:38:24,970 --> 00:38:30,629
any antivirus

655
00:38:26,880 --> 00:38:33,990
their ultimate payload their cubot<font color="#CCCCCC"> okay</font>

656
00:38:30,630 --> 00:38:36,809
they they manually keep on we are few

657
00:38:33,990 --> 00:38:38,430
skating a real few<font color="#CCCCCC"> skate this piece of</font>

658
00:38:36,809 --> 00:38:41,940
payload and so they want<font color="#E5E5E5"> to make sure</font>

659
00:38:38,430 --> 00:38:47,460
that<font color="#E5E5E5"> their current obfuscation also on</font>

660
00:38:41,940 --> 00:38:51,299
is not detected<font color="#CCCCCC"> by any antivirus they</font>

661
00:38:47,460 --> 00:38:55,529
had this<font color="#E5E5E5"> Oscar de piel that is that</font>

662
00:38:51,299 --> 00:38:59,430
primarily notifies is responsible for

663
00:38:55,529 --> 00:39:02,569
notify them so when one in<font color="#CCCCCC"> Traverse</font>

664
00:38:59,430 --> 00:39:05,910
<font color="#E5E5E5">vendor starts to detect any one of these</font>

665
00:39:02,569 --> 00:39:09,920
pieces<font color="#E5E5E5"> of their infrastructure they will</font>

666
00:39:05,910 --> 00:39:12,480
get notified<font color="#CCCCCC"> by icq using Oscar</font><font color="#E5E5E5"> de piel</font>

667
00:39:09,920 --> 00:39:15,930
<font color="#E5E5E5">oscar de piel is also responsible for</font>

668
00:39:12,480 --> 00:39:18,839
and is more complicated but it went on

669
00:39:15,930 --> 00:39:23,299
when they<font color="#E5E5E5"> sux they've successfully</font>

670
00:39:18,839 --> 00:39:26,759
sniffed<font color="#E5E5E5"> an H GPS conversation that's</font><font color="#CCCCCC"> lie</font>

671
00:39:23,299 --> 00:39:29,430
<font color="#CCCCCC">and they got this conversation then they</font>

672
00:39:26,759 --> 00:39:34,289
want to very quickly while the users

673
00:39:29,430 --> 00:39:36,240
still logged in on use the credentials

674
00:39:34,289 --> 00:39:39,259
that they have stolen to act on behalf

675
00:39:36,240 --> 00:39:43,258
of the user<font color="#CCCCCC"> and so they get notified by</font>

676
00:39:39,259 --> 00:39:46,140
icq when this happens also through<font color="#E5E5E5"> Oscar</font>

677
00:39:43,259 --> 00:39:49,140
peel and that's why their Intel virus

678
00:39:46,140 --> 00:39:51,720
detection rate is 0 a 0 to 5 out of 55

679
00:39:49,140 --> 00:39:54,990
when one of their they're infected

680
00:39:51,720 --> 00:39:59,038
<font color="#E5E5E5">websites is detected by antivirus that</font>

681
00:39:54,990 --> 00:40:00,689
would go manually go in clean<font color="#CCCCCC"> up ah and</font>

682
00:39:59,039 --> 00:40:03,089
then and then just stop throw that

683
00:40:00,690 --> 00:40:06,329
website away jump to another website go

684
00:40:03,089 --> 00:40:08,759
infect another website<font color="#CCCCCC"> um if they're</font>

685
00:40:06,329 --> 00:40:10,799
cubot their current obfuscation of their

686
00:40:08,759 --> 00:40:13,769
cue<font color="#CCCCCC"> BOTS detected it was just real few</font>

687
00:40:10,799 --> 00:40:18,920
skate generate a new version put it on

688
00:40:13,769 --> 00:40:22,709
there<font color="#E5E5E5"> see</font><font color="#CCCCCC"> to again on with the same URL</font>

689
00:40:18,920 --> 00:40:25,039
for the e case for the exploit show code

690
00:40:22,710 --> 00:40:25,039
to download

691
00:40:27,010 --> 00:40:34,010
malware they have adopted Cuba as their

692
00:40:30,800 --> 00:40:38,960
primary payload q buys me around since

693
00:40:34,010 --> 00:40:42,620
2007 it used to be a warm but now it's

694
00:40:38,960 --> 00:40:45,320
they turn it into R in three rootkit the

695
00:40:42,620 --> 00:40:48,380
communication is DJ domains plus rc4

696
00:40:45,320 --> 00:40:50,360
encryption with a shawl and random salt

697
00:40:48,380 --> 00:40:54,440
and<font color="#CCCCCC"> we'll show you if time permits how</font>

698
00:40:50,360 --> 00:40:57,470
to decrypt that protocol it x.x

699
00:40:54,440 --> 00:41:00,890
filtrates when it runs exfiltrate spot

700
00:40:57,470 --> 00:41:03,200
we ftp passwords keystrokes certificates

701
00:41:00,890 --> 00:41:06,080
things like that it has anti be in the

702
00:41:03,200 --> 00:41:08,930
sandbox features so it wouldn't run for

703
00:41:06,080 --> 00:41:13,759
example in in a lot<font color="#CCCCCC"> of the popular</font>

704
00:41:08,930 --> 00:41:16,940
sandboxes second stage it also installs

705
00:41:13,760 --> 00:41:18,620
<font color="#E5E5E5">session spy web inject and these are men</font>

706
00:41:16,940 --> 00:41:23,420
in the inmate what we call<font color="#E5E5E5"> man in the</font>

707
00:41:18,620 --> 00:41:26,240
browser so they are<font color="#CCCCCC"> their their browser</font>

708
00:41:23,420 --> 00:41:28,730
helper objects or their<font color="#CCCCCC"> deals</font><font color="#E5E5E5"> that hooks</font>

709
00:41:26,240 --> 00:41:32,959
into<font color="#E5E5E5"> the browser and this allows them to</font>

710
00:41:28,730 --> 00:41:34,880
sniff off<font color="#CCCCCC"> hcps conversations now because</font>

711
00:41:32,960 --> 00:41:36,290
they hooked into the browser at the

712
00:41:34,880 --> 00:41:39,800
point where the browser is already

713
00:41:36,290 --> 00:41:41,300
decrypted HTTP traffic and that's how

714
00:41:39,800 --> 00:41:47,920
they're able to<font color="#E5E5E5"> sniff out all of the</font>

715
00:41:41,300 --> 00:41:53,060
<font color="#CCCCCC">htps banking sessions on strategy change</font>

716
00:41:47,920 --> 00:41:55,430
so they in 20 15 the resilience with

717
00:41:53,060 --> 00:41:58,580
orange now they're using<font color="#CCCCCC"> big EK but it's</font>

718
00:41:55,430 --> 00:42:00,770
all just to spread their cubot this is

719
00:41:58,580 --> 00:42:03,860
the command and<font color="#E5E5E5"> control panel of their</font>

720
00:42:00,770 --> 00:42:07,820
cubot from the panel you can see every

721
00:42:03,860 --> 00:42:10,070
single infected endpoint and then here

722
00:42:07,820 --> 00:42:12,950
is a list<font color="#E5E5E5"> of commands that they want</font>

723
00:42:10,070 --> 00:42:15,880
these endpoints to further do and a lot

724
00:42:12,950 --> 00:42:23,529
of times is to install additional

725
00:42:15,880 --> 00:42:28,210
malicious modules and you can see every

726
00:42:23,530 --> 00:42:28,210
every endpoint has a<font color="#CCCCCC"> nick</font>

727
00:42:32,660 --> 00:42:41,029
<font color="#E5E5E5">okay in let's a very quickly do this</font>

728
00:42:36,849 --> 00:42:42,710
there is rc4 encryption basically the

729
00:42:41,030 --> 00:42:46,160
<font color="#CCCCCC">Cuba talks back to their see-through</font>

730
00:42:42,710 --> 00:42:49,339
server and the traffic is<font color="#E5E5E5"> rc4 encrypted</font>

731
00:42:46,160 --> 00:42:53,660
with a randomly generated assault of but

732
00:42:49,339 --> 00:42:57,770
it's<font color="#E5E5E5"> very easy to decrypt because they</font>

733
00:42:53,660 --> 00:43:00,078
put the hash the half 16 bytes of the

734
00:42:57,770 --> 00:43:01,880
salt at<font color="#CCCCCC"> the beginning of their message</font>

735
00:43:00,079 --> 00:43:05,150
so it's very simple just take the

736
00:43:01,880 --> 00:43:07,369
beginning<font color="#CCCCCC"> 16 16 bytes and then you can</font>

737
00:43:05,150 --> 00:43:12,500
decrypt there are sea floor protocol

738
00:43:07,369 --> 00:43:17,270
really a script to decrypt that and this

739
00:43:12,500 --> 00:43:21,410
is how the communication looks like when

740
00:43:17,270 --> 00:43:24,170
the Cuba talks back to<font color="#E5E5E5"> their see to</font><font color="#CCCCCC"> the</font>

741
00:43:21,410 --> 00:43:26,779
<font color="#E5E5E5">sea to then would give back usually a</font>

742
00:43:24,170 --> 00:43:29,410
command for the<font color="#E5E5E5"> bot to execute and this</font>

743
00:43:26,780 --> 00:43:29,410
how it looks<font color="#E5E5E5"> like</font>

744
00:43:36,640 --> 00:43:44,920
okay so here<font color="#CCCCCC"> is one of their back and</font>

745
00:43:40,779 --> 00:43:47,920
control panels where they have harvested

746
00:43:44,920 --> 00:43:50,769
all these live<font color="#CCCCCC"> hcps banking</font>

747
00:43:47,920 --> 00:43:57,269
conversations they know very precisely

748
00:43:50,769 --> 00:44:00,279
the format of all these banks online

749
00:43:57,269 --> 00:44:03,279
transactions so when you log into a when

750
00:44:00,279 --> 00:44:06,339
you go to like trivial w dot Bowles

751
00:44:03,279 --> 00:44:08,319
Fargo<font color="#CCCCCC"> calm which is my bank they</font>

752
00:44:06,339 --> 00:44:11,380
recognize these conversations right so

753
00:44:08,319 --> 00:44:14,079
when<font color="#E5E5E5"> you</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> and remember they do man</font>

754
00:44:11,380 --> 00:44:18,730
in the browser so they can decrypt HTTPS

755
00:44:14,079 --> 00:44:21,789
traffic so<font color="#CCCCCC"> uh so what happens is this is</font>

756
00:44:18,730 --> 00:44:24,609
what they will send back right here

757
00:44:21,789 --> 00:44:27,130
write text box password equals blah blah

758
00:44:24,609 --> 00:44:28,990
<font color="#CCCCCC">blah now this is life directly capture</font>

759
00:44:27,130 --> 00:44:31,420
from their control piano so once this

760
00:44:28,990 --> 00:44:35,589
happens it will<font color="#E5E5E5"> also get notified with</font>

761
00:44:31,420 --> 00:44:39,099
their armed with their icq perl script

762
00:44:35,589 --> 00:44:43,119
get<font color="#CCCCCC"> notified now</font><font color="#E5E5E5"> that the banks are very</font>

763
00:44:39,099 --> 00:44:44,650
well banking online banking security of

764
00:44:43,119 --> 00:44:47,339
all these banks that they target<font color="#CCCCCC"> are</font>

765
00:44:44,650 --> 00:44:50,950
done very well right so if the victim is

766
00:44:47,339 --> 00:44:53,470
from let's say is in San Francisco<font color="#CCCCCC"> then</font>

767
00:44:50,950 --> 00:44:56,500
if you want to impersonate the victim

768
00:44:53,470 --> 00:44:59,288
you also have to<font color="#E5E5E5"> be from almost on the</font>

769
00:44:56,500 --> 00:45:02,349
same IP range in San<font color="#CCCCCC"> Francisco that's</font>

770
00:44:59,289 --> 00:45:05,289
why they run that tunneling service so

771
00:45:02,349 --> 00:45:07,720
they would quickly try either to tunnel

772
00:45:05,289 --> 00:45:10,000
through the exact end point where they

773
00:45:07,720 --> 00:45:14,379
got this piece of<font color="#CCCCCC"> HTTPS composition from</font>

774
00:45:10,000 --> 00:45:16,750
or any other endpoint that's within that

775
00:45:14,380 --> 00:45:18,910
<font color="#CCCCCC">on that City that's why they had this</font>

776
00:45:16,750 --> 00:45:21,940
query interface that that I'll show you

777
00:45:18,910 --> 00:45:29,730
and they'll go<font color="#E5E5E5"> riding and the wood on</font>

778
00:45:21,940 --> 00:45:31,660
they would impersonate be the victim um

779
00:45:29,730 --> 00:45:35,890
initially it was very hard to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> that</font>

780
00:45:31,660 --> 00:45:38,890
research because um they they have

781
00:45:35,890 --> 00:45:41,140
reverse proxies in front of engine next

782
00:45:38,890 --> 00:45:44,410
<font color="#E5E5E5">reverse proxies in front of their</font><font color="#CCCCCC"> tdss</font>

783
00:45:41,140 --> 00:45:48,319
and<font color="#E5E5E5"> their SI toos and how we found out</font>

784
00:45:44,410 --> 00:45:52,759
the actual IPS of the tds<font color="#CCCCCC"> and c 2</font><font color="#E5E5E5"> s</font>

785
00:45:48,320 --> 00:45:54,530
is first they had a cookie set and

786
00:45:52,760 --> 00:45:55,940
within the cookie when we don't know

787
00:45:54,530 --> 00:45:59,150
what this is<font color="#CCCCCC"> for it but within the</font>

788
00:45:55,940 --> 00:46:02,230
cookie on they<font color="#E5E5E5"> have the real the actual</font>

789
00:45:59,150 --> 00:46:07,610
host and that<font color="#E5E5E5"> that's how we were able to</font>

790
00:46:02,230 --> 00:46:10,700
find out the other one is under older

791
00:46:07,610 --> 00:46:15,590
out there most of<font color="#CCCCCC"> the engine Nexus they</font>

792
00:46:10,700 --> 00:46:18,200
have psu info enabled so so it's<font color="#E5E5E5"> pretty</font>

793
00:46:15,590 --> 00:46:21,470
easy<font color="#E5E5E5"> I'm server name and server address</font>

794
00:46:18,200 --> 00:46:29,000
<font color="#CCCCCC">where they get their where their servers</font>

795
00:46:21,470 --> 00:46:33,379
are really are ok this is socks fabric

796
00:46:29,000 --> 00:46:35,950
it's an<font color="#CCCCCC"> SDK it's it's it's for any other</font>

797
00:46:33,380 --> 00:46:39,170
malware developers to tunnel through

798
00:46:35,950 --> 00:46:41,870
their paid tunneling service it's

799
00:46:39,170 --> 00:46:46,010
written in C and it's just very easy to

800
00:46:41,870 --> 00:46:47,900
use<font color="#E5E5E5"> um and then once so once you do that</font>

801
00:46:46,010 --> 00:46:51,590
they give it once you become their

802
00:46:47,900 --> 00:46:54,680
customer they give you this socks ap<font color="#E5E5E5"> SDK</font>

803
00:46:51,590 --> 00:46:57,380
that are just a few lines would allow

804
00:46:54,680 --> 00:47:01,399
you to your malware to tunnel through

805
00:46:57,380 --> 00:47:04,610
our their boxing service and then you

806
00:47:01,400 --> 00:47:11,570
can log in to this UI and then you can

807
00:47:04,610 --> 00:47:15,080
search by city state zip on or IP and so

808
00:47:11,570 --> 00:47:17,240
we are refer you like your search for

809
00:47:15,080 --> 00:47:20,210
something we get all these on endpoints

810
00:47:17,240 --> 00:47:22,220
that's<font color="#CCCCCC"> a that's within that range</font><font color="#E5E5E5"> and</font>

811
00:47:20,210 --> 00:47:24,020
you can select and<font color="#E5E5E5"> then point every</font>

812
00:47:22,220 --> 00:47:26,660
endpoint has a unique nick nick nick

813
00:47:24,020 --> 00:47:36,050
name as you saw and<font color="#E5E5E5"> then you can tunnel</font>

814
00:47:26,660 --> 00:47:40,430
through that endpoint single I API okay

815
00:47:36,050 --> 00:47:45,079
<font color="#CCCCCC">okay so show of code</font>

816
00:47:40,430 --> 00:47:53,578
<font color="#E5E5E5">okay so xolo the code here is there</font>

817
00:47:45,079 --> 00:47:57,270
there AV<font color="#CCCCCC"> Sutra check that checks against</font>

818
00:47:53,579 --> 00:47:59,280
antivirus and here you can<font color="#CCCCCC"> see they're</font>

819
00:47:57,270 --> 00:48:01,109
checking against 25 security vendors

820
00:47:59,280 --> 00:48:03,930
here some of<font color="#CCCCCC"> the vendors they do</font><font color="#E5E5E5"> not</font>

821
00:48:01,109 --> 00:48:07,500
check against so these are<font color="#CCCCCC"> probably the</font>

822
00:48:03,930 --> 00:48:10,710
ones that they feel are are the good

823
00:48:07,500 --> 00:48:14,070
ones so they don't<font color="#E5E5E5"> want to get detected</font>

824
00:48:10,710 --> 00:48:16,800
by these ones right here so within<font color="#CCCCCC"> this</font>

825
00:48:14,070 --> 00:48:22,619
there's actually their actual user name

826
00:48:16,800 --> 00:48:28,829
and password that<font color="#CCCCCC"> they use for sutra for</font>

827
00:48:22,619 --> 00:48:32,670
the for the trick here is the here is

828
00:48:28,829 --> 00:48:36,390
the Sox SDK and it's very simple just

829
00:48:32,670 --> 00:48:38,130
server IP port and then the nickname

830
00:48:36,390 --> 00:48:40,259
nickname is the<font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> that you want a</font>

831
00:48:38,130 --> 00:48:44,270
ton of food and then and then though

832
00:48:40,260 --> 00:48:44,270
establish the tunnel

833
00:48:49,090 --> 00:49:00,550
ok here is the pricing unlimited

834
00:48:55,560 --> 00:49:04,690
unlimited one day access<font color="#CCCCCC"> 10 bucks ok so</font>

835
00:49:00,550 --> 00:49:06,910
it's<font color="#E5E5E5"> not very expensive who are the</font>

836
00:49:04,690 --> 00:49:10,840
victims have a million<font color="#E5E5E5"> unique infections</font>

837
00:49:06,910 --> 00:49:16,529
are covering almost<font color="#CCCCCC"> two million unique</font>

838
00:49:10,840 --> 00:49:20,290
IPS this is another of their<font color="#CCCCCC"> back-end so</font>

839
00:49:16,530 --> 00:49:22,570
from the from these database tables are

840
00:49:20,290 --> 00:49:25,300
no time to show you guys<font color="#E5E5E5"> but our</font>

841
00:49:22,570 --> 00:49:28,060
conclusion was about half half a million

842
00:49:25,300 --> 00:49:31,830
unique infections covering about<font color="#CCCCCC"> two</font>

843
00:49:28,060 --> 00:49:31,830
million unique IP addresses right now

844
00:49:31,980 --> 00:49:42,010
0.8 banking related<font color="#CCCCCC"> HCPs conversation</font>

845
00:49:36,610 --> 00:49:44,650
stolen and we've got the data from so

846
00:49:42,010 --> 00:49:52,330
you can see you<font color="#E5E5E5"> can see for example</font>

847
00:49:44,650 --> 00:49:55,270
right sign on or change password warning

848
00:49:52,330 --> 00:50:00,450
blah blah<font color="#CCCCCC"> blah so and each of these they</font>

849
00:49:55,270 --> 00:50:06,820
<font color="#CCCCCC">recognize</font><font color="#E5E5E5"> the HTML form format or the</font>

850
00:50:00,450 --> 00:50:09,580
<font color="#CCCCCC">HCPs conversation format they have this</font>

851
00:50:06,820 --> 00:50:11,890
tool called mail checker sweet and what

852
00:50:09,580 --> 00:50:14,860
this tool does is because a lot of times

853
00:50:11,890 --> 00:50:16,629
when you<font color="#E5E5E5"> log in the banks will feel a</font>

854
00:50:14,860 --> 00:50:18,940
little bit strange right for example

855
00:50:16,630 --> 00:50:20,740
your IP just changed a little bit on so

856
00:50:18,940 --> 00:50:23,410
the bank will send you<font color="#CCCCCC"> an email saying</font>

857
00:50:20,740 --> 00:50:27,850
basically saying we still let you<font color="#E5E5E5"> log in</font>

858
00:50:23,410 --> 00:50:30,310
but you want<font color="#E5E5E5"> to check this and so what</font>

859
00:50:27,850 --> 00:50:32,740
they would do is they would and this is

860
00:50:30,310 --> 00:50:35,290
why<font color="#CCCCCC"> they're cubot steals pop3 passwords</font>

861
00:50:32,740 --> 00:50:39,009
they will<font color="#CCCCCC"> login to the</font><font color="#E5E5E5"> user they will</font>

862
00:50:35,290 --> 00:50:41,080
use this this tool that they broke don't

863
00:50:39,010 --> 00:50:44,590
have time to show called<font color="#E5E5E5"> uncheck male</font>

864
00:50:41,080 --> 00:50:47,110
doc pol and they<font color="#CCCCCC"> log into the users</font>

865
00:50:44,590 --> 00:50:50,350
mailbox and they will identify they know

866
00:50:47,110 --> 00:50:52,030
the they have these<font color="#CCCCCC"> rhetorics for the</font>

867
00:50:50,350 --> 00:50:54,730
emails coming from the banks and<font color="#E5E5E5"> will</font>

868
00:50:52,030 --> 00:50:56,770
identify those emails and kill it<font color="#CCCCCC"> okay</font>

869
00:50:54,730 --> 00:51:01,450
so your bank will<font color="#CCCCCC"> be sending you</font><font color="#E5E5E5"> an</font>

870
00:50:56,770 --> 00:51:02,470
email alert<font color="#E5E5E5"> when something is seemingly</font>

871
00:51:01,450 --> 00:51:04,359
wrong

872
00:51:02,470 --> 00:51:06,069
but they'll kill that email another way

873
00:51:04,359 --> 00:51:08,920
to do it is they'll just flood your

874
00:51:06,070 --> 00:51:12,180
mailbox<font color="#CCCCCC"> they</font><font color="#E5E5E5"> were just flooded so hoping</font>

875
00:51:08,920 --> 00:51:16,450
that you wouldn't see the<font color="#E5E5E5"> bank's alerts</font>

876
00:51:12,180 --> 00:51:20,910
so that is a check node appeal or mill

877
00:51:16,450 --> 00:51:25,000
Bombur p 0 victim distribution are

878
00:51:20,910 --> 00:51:29,770
<font color="#CCCCCC">seventy-five</font><font color="#E5E5E5"> percent from the US Val 383</font>

879
00:51:25,000 --> 00:51:33,490
percent from Britain Italy Canada

880
00:51:29,770 --> 00:51:36,970
Australia that's about<font color="#CCCCCC"> it and they</font>

881
00:51:33,490 --> 00:51:40,660
blacklist a lot of countries victim

882
00:51:36,970 --> 00:51:42,270
operating<font color="#CCCCCC"> system distribution XP still</font>

883
00:51:40,660 --> 00:51:47,609
fifty two percent the other<font color="#E5E5E5"> 50 to</font>

884
00:51:42,270 --> 00:51:52,420
windows seven<font color="#E5E5E5"> this or</font><font color="#CCCCCC"> Vista</font><font color="#E5E5E5"> the other 50</font>

885
00:51:47,609 --> 00:51:55,509
top online banking<font color="#CCCCCC"> transaction stolen so</font>

886
00:51:52,420 --> 00:52:02,890
we have a fidelity bank of America

887
00:51:55,510 --> 00:52:06,640
JPMorgan<font color="#E5E5E5"> PNC and Will's Fargo conclusion</font>

888
00:52:02,890 --> 00:52:10,450
this actor is currently still active the

889
00:52:06,640 --> 00:52:12,879
kill chain is as we described malicious

890
00:52:10,450 --> 00:52:16,689
tds redirect<font color="#E5E5E5"> to</font><font color="#CCCCCC"> TDS redirect to exploit</font>

891
00:52:12,880 --> 00:52:19,720
kit download malicious payload<font color="#E5E5E5"> develop</font>

892
00:52:16,690 --> 00:52:21,760
quite a few in-house tools and we have

893
00:52:19,720 --> 00:52:25,509
showed you<font color="#E5E5E5"> their tools and their entire</font>

894
00:52:21,760 --> 00:52:28,210
process Cuba to establish a foothold

895
00:52:25,510 --> 00:52:31,030
into the<font color="#E5E5E5"> endpoint download further</font>

896
00:52:28,210 --> 00:52:34,440
malware a lot of<font color="#CCCCCC"> time and they seem to</font>

897
00:52:31,030 --> 00:52:38,020
be installing V&C remote desktop a lot

898
00:52:34,440 --> 00:52:40,089
money rules<font color="#E5E5E5"> are from the data we've</font>

899
00:52:38,020 --> 00:52:46,140
collected we believe<font color="#CCCCCC"> that they're making</font>

900
00:52:40,089 --> 00:52:48,420
quite a lot<font color="#CCCCCC"> of money alright that's it</font>

901
00:52:46,140 --> 00:52:52,560
<font color="#CCCCCC">time's up do we have time for questions</font>

902
00:52:48,420 --> 00:52:52,560
okay all right all<font color="#E5E5E5"> right I'll be here</font>

903
00:52:57,060 --> 00:52:59,120
you

