1
00:00:02,700 --> 00:00:09,190
hi everyone<font color="#CCCCCC"> thanks for coming here if</font>

2
00:00:05,680 --> 00:00:09,940
you<font color="#CCCCCC"> are here for those 18-plus</font><font color="#E5E5E5"> talk it's</font>

3
00:00:09,190 --> 00:00:12,580
<font color="#E5E5E5">not that one</font>

4
00:00:09,940 --> 00:00:16,810
so I'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> something</font>

5
00:00:12,580 --> 00:00:19,419
else so my name<font color="#CCCCCC"> is sue rush and I work</font>

6
00:00:16,810 --> 00:00:22,598
at<font color="#E5E5E5"> MCC group another</font><font color="#CCCCCC"> application tester</font>

7
00:00:19,419 --> 00:00:25,349
<font color="#E5E5E5">and I'm good at breaking stuff</font><font color="#CCCCCC"> I have</font>

8
00:00:22,599 --> 00:00:29,470
created a<font color="#E5E5E5"> few tools but are broken more</font>

9
00:00:25,349 --> 00:00:33,370
<font color="#CCCCCC">I also love to bypass</font><font color="#E5E5E5"> lifeless</font>

10
00:00:29,470 --> 00:00:35,110
protections<font color="#E5E5E5"> and it is especially good</font>

11
00:00:33,370 --> 00:00:37,120
when I can mess<font color="#CCCCCC"> with an</font><font color="#E5E5E5"> application</font><font color="#CCCCCC"> on</font>

12
00:00:35,110 --> 00:00:40,030
<font color="#CCCCCC">bypass</font><font color="#E5E5E5"> the whole</font><font color="#CCCCCC"> blacklist</font><font color="#E5E5E5"> with one</font>

13
00:00:37,120 --> 00:00:43,349
<font color="#E5E5E5">single character</font><font color="#CCCCCC"> if you want to contact</font>

14
00:00:40,030 --> 00:00:46,930
me that's my<font color="#CCCCCC"> Twitter handle</font>

15
00:00:43,350 --> 00:00:51,790
so in today's<font color="#E5E5E5"> talk I'm going to talk</font>

16
00:00:46,930 --> 00:00:55,269
<font color="#CCCCCC">about HTTP especially HTTP version 0.91</font>

17
00:00:51,790 --> 00:00:56,950
<font color="#E5E5E5">and 1.1 and</font><font color="#CCCCCC"> i'm not going</font><font color="#E5E5E5"> to talk about</font>

18
00:00:55,270 --> 00:00:59,440
<font color="#E5E5E5">HD version 2</font>

19
00:00:56,950 --> 00:01:02,050
so today basically we<font color="#E5E5E5"> are going to do</font>

20
00:00:59,440 --> 00:01:05,619
into a smuggles on HTTP<font color="#E5E5E5"> request to the</font>

21
00:01:02,050 --> 00:01:08,710
<font color="#E5E5E5">server and the hope</font><font color="#CCCCCC"> you are going to do</font>

22
00:01:05,619 --> 00:01:11,770
that is via mutation<font color="#CCCCCC"> so we are going</font><font color="#E5E5E5"> to</font>

23
00:01:08,710 --> 00:01:13,929
mutate the HTTP<font color="#E5E5E5"> request to another HTTP</font>

24
00:01:11,770 --> 00:01:14,380
request<font color="#E5E5E5"> and we want to deliver it to the</font>

25
00:01:13,930 --> 00:01:16,750
server

26
00:01:14,380 --> 00:01:20,080
so this chunk is going to have a lot of

27
00:01:16,750 --> 00:01:22,270
HTTP requests<font color="#E5E5E5"> some boring</font><font color="#CCCCCC"> a few</font>

28
00:01:20,080 --> 00:01:24,550
interesting<font color="#CCCCCC"> and you will see some new</font>

29
00:01:22,270 --> 00:01:27,220
new things in it as well and I<font color="#E5E5E5"> think</font>

30
00:01:24,550 --> 00:01:31,390
<font color="#E5E5E5">they</font><font color="#CCCCCC"> are new so</font><font color="#E5E5E5"> I couldn't find them</font>

31
00:01:27,220 --> 00:01:34,060
<font color="#CCCCCC">anywhere</font><font color="#E5E5E5"> else</font><font color="#CCCCCC"> so in order to mutate</font>

32
00:01:31,390 --> 00:01:36,520
<font color="#CCCCCC">request</font><font color="#E5E5E5"> you need to know what you're</font>

33
00:01:34,060 --> 00:01:39,100
dealing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> from one web service to</font>

34
00:01:36,520 --> 00:01:41,740
<font color="#E5E5E5">another from one proxy to another from</font>

35
00:01:39,100 --> 00:01:43,809
<font color="#E5E5E5">one technology to another and also from</font>

36
00:01:41,740 --> 00:01:46,149
one version to another it can<font color="#E5E5E5"> be</font><font color="#CCCCCC"> search</font>

37
00:01:43,810 --> 00:01:48,880
so<font color="#E5E5E5"> you need to</font><font color="#CCCCCC"> really know</font><font color="#E5E5E5"> what you are</font>

38
00:01:46,150 --> 00:01:53,320
going<font color="#E5E5E5"> to deal</font><font color="#CCCCCC"> with also different last</font>

39
00:01:48,880 --> 00:01:55,899
act differently so<font color="#CCCCCC"> we have to have a</font>

40
00:01:53,320 --> 00:01:57,820
database<font color="#CCCCCC"> of all different mutations all</font>

41
00:01:55,900 --> 00:02:00,549
the characters or all the patterns<font color="#E5E5E5"> you</font>

42
00:01:57,820 --> 00:02:02,679
can use<font color="#E5E5E5"> then we</font><font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> create our</font>

43
00:02:00,549 --> 00:02:07,720
<font color="#E5E5E5">own request</font><font color="#CCCCCC"> we can go through the VATS</font>

44
00:02:02,680 --> 00:02:10,090
hopefully so in my<font color="#E5E5E5"> own lab I had 10 VMs</font>

45
00:02:07,720 --> 00:02:11,739
with different web<font color="#CCCCCC"> servers and different</font>

46
00:02:10,090 --> 00:02:14,620
<font color="#E5E5E5">technologies on them</font>

47
00:02:11,739 --> 00:02:17,290
and I started to just<font color="#E5E5E5"> have</font><font color="#CCCCCC"> webservers</font>

48
00:02:14,620 --> 00:02:20,709
first<font color="#E5E5E5"> before testing any</font><font color="#CCCCCC"> of us any</font>

49
00:02:17,290 --> 00:02:24,640
<font color="#E5E5E5">proxies or anything else so</font><font color="#CCCCCC"> I identified</font>

50
00:02:20,709 --> 00:02:26,459
a few number of<font color="#E5E5E5"> anomalies something that</font>

51
00:02:24,640 --> 00:02:29,078
shouldn't be<font color="#E5E5E5"> there</font><font color="#CCCCCC"> and then I started</font>

52
00:02:26,459 --> 00:02:31,269
<font color="#E5E5E5">pointing at different laughs and I</font>

53
00:02:29,079 --> 00:02:34,980
realized<font color="#E5E5E5"> that it can really go through</font>

54
00:02:31,269 --> 00:02:38,049
and I'm going to discuss that today<font color="#E5E5E5"> so</font>

55
00:02:34,980 --> 00:02:41,230
about the HTTP<font color="#E5E5E5"> so I'm going to talk</font>

56
00:02:38,049 --> 00:02:43,209
<font color="#CCCCCC">about HTTP version 1.1 one and zero</font>

57
00:02:41,230 --> 00:02:45,970
point not<font color="#E5E5E5"> just because</font><font color="#CCCCCC"> they're textual</font>

58
00:02:43,209 --> 00:02:47,489
HTTP version two<font color="#CCCCCC"> is in binary and I'm</font>

59
00:02:45,970 --> 00:02:50,319
not going to talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> it today</font>

60
00:02:47,489 --> 00:02:55,359
<font color="#E5E5E5">hopefully later but and talk about it on</font>

61
00:02:50,319 --> 00:02:58,599
any<font color="#E5E5E5"> future so HTTP version 1.1 has to</font>

62
00:02:55,359 --> 00:03:02,319
<font color="#E5E5E5">Europe sees the latest one I think came</font>

63
00:02:58,599 --> 00:03:07,000
in 2014 I think<font color="#E5E5E5"> around that time and it</font>

64
00:03:02,319 --> 00:03:08,768
is<font color="#E5E5E5"> actually multiple RFC thing so if you</font>

65
00:03:07,000 --> 00:03:11,049
want to<font color="#E5E5E5"> really read about it you have</font><font color="#CCCCCC"> to</font>

66
00:03:08,769 --> 00:03:14,469
read multiple RFC<font color="#E5E5E5"> but then the good</font>

67
00:03:11,049 --> 00:03:16,959
thing about HTTP 1.1 is because it has

68
00:03:14,469 --> 00:03:19,959
different RFC<font color="#E5E5E5"> if you start</font><font color="#CCCCCC"> reading from</font>

69
00:03:16,959 --> 00:03:22,000
<font color="#E5E5E5">the first one you would realize that the</font>

70
00:03:19,959 --> 00:03:23,709
changes are<font color="#E5E5E5"> not really applied on the</font>

71
00:03:22,000 --> 00:03:25,959
web servers<font color="#E5E5E5"> that some changes are</font>

72
00:03:23,709 --> 00:03:28,659
applied but not all<font color="#CCCCCC"> of them and that's</font>

73
00:03:25,959 --> 00:03:33,489
<font color="#E5E5E5">when you can actually find a bypass with</font>

74
00:03:28,659 --> 00:03:35,590
HTTP 0.8 1.0<font color="#E5E5E5"> it's basically very similar</font>

75
00:03:33,489 --> 00:03:38,169
<font color="#E5E5E5">to 1.1 there are a few differences and</font>

76
00:03:35,590 --> 00:03:40,090
the big<font color="#E5E5E5"> changes but I'm not going to</font>

77
00:03:38,169 --> 00:03:44,049
<font color="#E5E5E5">talk about all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> them today and with</font>

78
00:03:40,090 --> 00:03:51,759
<font color="#E5E5E5">0.1 basically it's very old</font><font color="#CCCCCC"> it is</font>

79
00:03:44,049 --> 00:03:53,530
<font color="#CCCCCC">ancient around 9:00 in 1990-1991</font><font color="#E5E5E5"> it came</font>

80
00:03:51,759 --> 00:03:56,319
out at that<font color="#CCCCCC"> time okay</font>

81
00:03:53,530 --> 00:03:59,169
it is<font color="#E5E5E5"> younger than me</font><font color="#CCCCCC"> but in like</font>

82
00:03:56,319 --> 00:04:03,790
technology<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> actually very old so</font>

83
00:03:59,169 --> 00:04:06,639
<font color="#E5E5E5">Windows the 3.1 is actually younger than</font>

84
00:04:03,790 --> 00:04:10,048
HTTP 0.9 and you will be surprised that

85
00:04:06,639 --> 00:04:14,759
it feels<font color="#E5E5E5"> today they should</font><font color="#CCCCCC"> be 0.9 is</font>

86
00:04:10,049 --> 00:04:17,858
being supported<font color="#E5E5E5"> by the</font><font color="#CCCCCC"> web</font><font color="#E5E5E5"> service and</font>

87
00:04:14,759 --> 00:04:21,320
you may have<font color="#E5E5E5"> not realized that you have</font>

88
00:04:17,858 --> 00:04:24,049
used HTTP 0.9 but you

89
00:04:21,320 --> 00:04:27,740
probably seen it<font color="#E5E5E5"> if you have tested web</font>

90
00:04:24,050 --> 00:04:30,140
applications<font color="#E5E5E5"> and you have seen it when</font>

91
00:04:27,740 --> 00:04:32,510
for example<font color="#E5E5E5"> your you have met with</font>

92
00:04:30,140 --> 00:04:34,130
content<font color="#CCCCCC"> lengths</font><font color="#E5E5E5"> and content</font><font color="#CCCCCC"> lengths of</font>

93
00:04:32,510 --> 00:04:36,710
the<font color="#CCCCCC"> request</font><font color="#E5E5E5"> you're sending to</font><font color="#CCCCCC"> the server</font>

94
00:04:34,130 --> 00:04:40,250
is<font color="#CCCCCC"> actually shorter than the body</font><font color="#E5E5E5"> of</font>

95
00:04:36,710 --> 00:04:42,650
<font color="#E5E5E5">that request or like in a post request</font>

96
00:04:40,250 --> 00:04:44,330
<font color="#CCCCCC">it's actually shorter you send it to the</font>

97
00:04:42,650 --> 00:04:47,239
<font color="#E5E5E5">server and then we will realize you have</font>

98
00:04:44,330 --> 00:04:49,219
two responses and the second response<font color="#E5E5E5"> is</font>

99
00:04:47,240 --> 00:04:51,980
something<font color="#CCCCCC"> like the verb is invalid in</font>

100
00:04:49,220 --> 00:04:52,760
that you have actually sent<font color="#E5E5E5"> two requests</font>

101
00:04:51,980 --> 00:04:55,310
<font color="#CCCCCC">and server</font>

102
00:04:52,760 --> 00:04:57,830
and one of<font color="#E5E5E5"> them what about HTTP 0.9</font>

103
00:04:55,310 --> 00:05:02,360
which<font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> just one line of</font>

104
00:04:57,830 --> 00:05:06,289
<font color="#CCCCCC">request</font><font color="#E5E5E5"> and it must be get requests so</font>

105
00:05:02,360 --> 00:05:09,020
here is a simple HTTP request<font color="#E5E5E5"> as you can</font>

106
00:05:06,290 --> 00:05:10,970
see we have a path<font color="#E5E5E5"> then we</font><font color="#CCCCCC"> have query</font>

107
00:05:09,020 --> 00:05:14,090
strings<font color="#CCCCCC"> then they are horse we have</font>

108
00:05:10,970 --> 00:05:17,120
<font color="#E5E5E5">cookies</font><font color="#CCCCCC"> and headers and</font><font color="#E5E5E5"> then the post</font>

109
00:05:14,090 --> 00:05:18,890
body value we can<font color="#CCCCCC"> have</font><font color="#E5E5E5"> many more so we</font>

110
00:05:17,120 --> 00:05:21,290
are going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> basically discuss this</font>

111
00:05:18,890 --> 00:05:25,340
<font color="#CCCCCC">today</font><font color="#E5E5E5"> we are going to talk about this</font>

112
00:05:21,290 --> 00:05:28,550
<font color="#E5E5E5">very later so about the request mutation</font>

113
00:05:25,340 --> 00:05:32,570
<font color="#E5E5E5">I'm going to show you that I can change</font>

114
00:05:28,550 --> 00:05:35,840
request a and make completely different

115
00:05:32,570 --> 00:05:37,969
<font color="#CCCCCC">request</font><font color="#E5E5E5"> which is request</font><font color="#CCCCCC"> D but from web</font>

116
00:05:35,840 --> 00:05:40,729
application point of view request<font color="#E5E5E5"> a and</font>

117
00:05:37,970 --> 00:05:43,280
B are the<font color="#E5E5E5"> same and are going</font><font color="#CCCCCC"> to give us</font>

118
00:05:40,730 --> 00:05:44,840
the<font color="#E5E5E5"> same response but from last point of</font>

119
00:05:43,280 --> 00:05:48,109
<font color="#E5E5E5">view or anything in the middle they are</font>

120
00:05:44,840 --> 00:05:50,299
completely<font color="#CCCCCC"> different</font><font color="#E5E5E5"> so how can how can</font>

121
00:05:48,110 --> 00:05:52,100
<font color="#CCCCCC">this mutation actually</font><font color="#E5E5E5"> solve any</font>

122
00:05:50,300 --> 00:05:52,430
<font color="#E5E5E5">problems</font><font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example you are</font><font color="#CCCCCC"> in your</font>

123
00:05:52,100 --> 00:05:54,910
office

124
00:05:52,430 --> 00:05:58,040
<font color="#CCCCCC">Facebook</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> filtered you</font><font color="#E5E5E5"> can use it and</font>

125
00:05:54,910 --> 00:05:59,690
see your<font color="#E5E5E5"> Facebook while working yeah</font>

126
00:05:58,040 --> 00:06:02,450
it's not a<font color="#E5E5E5"> good practice but you can do</font>

127
00:05:59,690 --> 00:06:05,840
it<font color="#E5E5E5"> you can browse</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> betting sites so</font>

128
00:06:02,450 --> 00:06:08,870
you<font color="#CCCCCC"> can basically</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> some predictions</font>

129
00:06:05,840 --> 00:06:11,630
<font color="#CCCCCC">a slash admin is filtered from</font><font color="#E5E5E5"> your</font>

130
00:06:08,870 --> 00:06:14,570
<font color="#E5E5E5">location for mutations may be able</font><font color="#CCCCCC"> to</font>

131
00:06:11,630 --> 00:06:16,960
<font color="#CCCCCC">bypass</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and C slash admin also</font>

132
00:06:14,570 --> 00:06:19,700
because web servers proxies<font color="#E5E5E5"> other</font>

133
00:06:16,960 --> 00:06:21,890
technologies are<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> responds</font>

134
00:06:19,700 --> 00:06:24,909
differently<font color="#E5E5E5"> or in</font><font color="#CCCCCC"> certain ease you can</font>

135
00:06:21,890 --> 00:06:28,280
fingerprint them using this mutation

136
00:06:24,910 --> 00:06:29,210
<font color="#E5E5E5">also there are cool research around</font>

137
00:06:28,280 --> 00:06:31,489
<font color="#E5E5E5">cache poisoning</font>

138
00:06:29,210 --> 00:06:34,359
<font color="#E5E5E5">responses splitting and socket buffer</font>

139
00:06:31,490 --> 00:06:37,780
poisoning which is actually new to<font color="#E5E5E5"> me</font>

140
00:06:34,360 --> 00:06:39,669
not very new but I've seen<font color="#CCCCCC"> Def Con 24 I</font>

141
00:06:37,780 --> 00:06:42,818
<font color="#E5E5E5">think there was a talk about</font><font color="#CCCCCC"> it and he's</font>

142
00:06:39,669 --> 00:06:46,000
actually<font color="#E5E5E5"> pretty much cooler than other</font>

143
00:06:42,819 --> 00:06:47,710
talks<font color="#E5E5E5"> that I've seen about HTTP what I'm</font>

144
00:06:46,000 --> 00:06:50,349
not going<font color="#E5E5E5"> to talk about that I'm going</font>

145
00:06:47,710 --> 00:06:53,109
to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that because they are very</font>

146
00:06:50,349 --> 00:06:55,150
<font color="#E5E5E5">popular</font><font color="#CCCCCC"> if you you have seen it during</font>

147
00:06:53,110 --> 00:06:58,030
<font color="#CCCCCC">ten tests so for example when you're</font>

148
00:06:55,150 --> 00:06:59,979
doing<font color="#CCCCCC"> blog</font><font color="#E5E5E5"> bounty program if if there is</font>

149
00:06:58,030 --> 00:07:01,929
a vacuum<font color="#CCCCCC"> parenthesis</font><font color="#E5E5E5"> it's actually very</font>

150
00:06:59,979 --> 00:07:05,080
bad<font color="#E5E5E5"> because you really don't know if</font>

151
00:07:01,930 --> 00:07:05,289
you're<font color="#E5E5E5"> hitting</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> webserver properly or</font>

152
00:07:05,080 --> 00:07:08,800
not

153
00:07:05,289 --> 00:07:14,650
<font color="#E5E5E5">so you send a</font><font color="#CCCCCC"> request to to your web</font>

154
00:07:08,800 --> 00:07:17,860
server<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> is like now so yeah so</font>

155
00:07:14,650 --> 00:07:20,289
<font color="#CCCCCC">we are going to to bypass that</font><font color="#E5E5E5"> we are</font>

156
00:07:17,860 --> 00:07:22,810
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> bypass this</font><font color="#E5E5E5"> restriction so for</font>

157
00:07:20,289 --> 00:07:24,580
<font color="#E5E5E5">example you you are testing a web server</font>

158
00:07:22,810 --> 00:07:27,039
<font color="#CCCCCC">you</font><font color="#E5E5E5"> have the last in front of you and</font>

159
00:07:24,580 --> 00:07:28,810
you<font color="#CCCCCC"> think</font><font color="#E5E5E5"> okay I have no time to ask for</font>

160
00:07:27,039 --> 00:07:31,389
<font color="#E5E5E5">permission to actually access</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I'm</font>

161
00:07:28,810 --> 00:07:33,039
saying this<font color="#E5E5E5"> however</font><font color="#CCCCCC"> after this book</font>

162
00:07:31,389 --> 00:07:35,590
probably<font color="#CCCCCC"> that companies are going</font><font color="#E5E5E5"> to</font>

163
00:07:33,039 --> 00:07:38,349
<font color="#E5E5E5">block many of these anomalies but there</font>

164
00:07:35,590 --> 00:07:41,979
are a<font color="#E5E5E5"> lot more than that and hopefully</font>

165
00:07:38,349 --> 00:07:44,529
<font color="#E5E5E5">we</font><font color="#CCCCCC"> will have a proper fool ass and by</font>

166
00:07:41,979 --> 00:07:47,409
saying that because over<font color="#CCCCCC"> top-10</font><font color="#E5E5E5"> not</font>

167
00:07:44,529 --> 00:07:49,839
supports like having that now the<font color="#E5E5E5"> last</font>

168
00:07:47,409 --> 00:07:51,940
<font color="#CCCCCC">company's not like</font><font color="#E5E5E5"> third very cheerful</font>

169
00:07:49,839 --> 00:07:53,529
about<font color="#CCCCCC"> it there they</font><font color="#E5E5E5"> are saying okay now</font>

170
00:07:51,940 --> 00:07:55,779
you need<font color="#E5E5E5"> love you need to buy our</font>

171
00:07:53,529 --> 00:08:00,039
product<font color="#E5E5E5"> but now they have to think about</font>

172
00:07:55,779 --> 00:08:02,969
it if I find a bypass in<font color="#CCCCCC"> your vows it is</font>

173
00:08:00,039 --> 00:08:06,159
not<font color="#E5E5E5"> basically a missed feature or</font>

174
00:08:02,969 --> 00:08:07,659
<font color="#E5E5E5">something like in something that you</font>

175
00:08:06,159 --> 00:08:10,389
need<font color="#E5E5E5"> to improve it is</font><font color="#CCCCCC"> now a</font>

176
00:08:07,659 --> 00:08:13,620
<font color="#E5E5E5">vulnerability of your</font><font color="#CCCCCC"> products they need</font>

177
00:08:10,389 --> 00:08:16,690
to be responsible<font color="#CCCCCC"> for these boy passes</font>

178
00:08:13,620 --> 00:08:20,669
<font color="#E5E5E5">she's pretty cool so</font><font color="#CCCCCC"> let's begin let's</font>

179
00:08:16,690 --> 00:08:24,400
<font color="#CCCCCC">start</font><font color="#E5E5E5"> by passing a vast boy imitating</font>

180
00:08:20,669 --> 00:08:26,830
HTTP requests so common mutations you

181
00:08:24,400 --> 00:08:30,520
have heard of them<font color="#E5E5E5"> probably you have</font>

182
00:08:26,830 --> 00:08:34,000
<font color="#E5E5E5">even used them so the HTTP request</font>

183
00:08:30,520 --> 00:08:36,968
<font color="#CCCCCC">headers values can be on the next</font><font color="#E5E5E5"> line</font>

184
00:08:34,000 --> 00:08:38,890
line holding as long as they start with

185
00:08:36,969 --> 00:08:40,779
the space character<font color="#E5E5E5"> or tab character</font>

186
00:08:38,890 --> 00:08:43,090
they<font color="#E5E5E5"> are basically the same so for</font>

187
00:08:40,779 --> 00:08:46,480
<font color="#E5E5E5">example you can have host :</font>

188
00:08:43,090 --> 00:08:49,810
the your example calm in the next line

189
00:08:46,480 --> 00:08:51,940
with a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> spaces</font><font color="#CCCCCC"> and tabs before</font><font color="#E5E5E5"> and</font>

190
00:08:49,810 --> 00:08:56,170
maybe the<font color="#E5E5E5"> blog has something but they're</font>

191
00:08:51,940 --> 00:08:58,540
well documented in RFC<font color="#E5E5E5"> so I don't think</font>

192
00:08:56,170 --> 00:09:00,699
you can<font color="#E5E5E5"> buy that powerful</font><font color="#CCCCCC"> last with them</font>

193
00:08:58,540 --> 00:09:03,880
<font color="#E5E5E5">also other common behaviors for example</font>

194
00:09:00,700 --> 00:09:05,770
you want<font color="#E5E5E5"> to access slash admin and a</font>

195
00:09:03,880 --> 00:09:09,970
slash admin is<font color="#CCCCCC"> blocked you put something</font>

196
00:09:05,770 --> 00:09:11,980
like<font color="#E5E5E5"> /foo slash dot dot slash admin now</font>

197
00:09:09,970 --> 00:09:15,580
you can access<font color="#E5E5E5"> it I don't think</font><font color="#CCCCCC"> you'd</font>

198
00:09:11,980 --> 00:09:17,770
see these<font color="#E5E5E5"> things anymore</font><font color="#CCCCCC"> because vast</font>

199
00:09:15,580 --> 00:09:19,630
companies are basically<font color="#CCCCCC"> blocking</font>

200
00:09:17,770 --> 00:09:21,880
anything<font color="#E5E5E5"> that they know can be dangerous</font>

201
00:09:19,630 --> 00:09:23,980
<font color="#E5E5E5">most of them are based on blacklist and</font>

202
00:09:21,880 --> 00:09:27,939
<font color="#E5E5E5">we are going</font><font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> blacks</font>

203
00:09:23,980 --> 00:09:30,490
<font color="#CCCCCC">s protections today we will I will show</font>

204
00:09:27,940 --> 00:09:36,220
you how we can<font color="#E5E5E5"> actually go through these</font>

205
00:09:30,490 --> 00:09:39,370
last so a strange mutation<font color="#CCCCCC"> so there</font><font color="#E5E5E5"> are</font>

206
00:09:36,220 --> 00:09:41,470
there<font color="#CCCCCC"> are behaviors of any of these vets</font>

207
00:09:39,370 --> 00:09:44,620
<font color="#E5E5E5">service that have surprised me</font><font color="#CCCCCC"> I've</font>

208
00:09:41,470 --> 00:09:46,210
<font color="#E5E5E5">tested a lot</font><font color="#CCCCCC"> of things on them</font><font color="#E5E5E5"> and these</font>

209
00:09:44,620 --> 00:09:47,950
<font color="#E5E5E5">are the things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I didn't</font><font color="#CCCCCC"> know there</font>

210
00:09:46,210 --> 00:09:50,500
are a<font color="#CCCCCC"> lot more</font><font color="#E5E5E5"> but I could only fit</font>

211
00:09:47,950 --> 00:09:53,500
<font color="#CCCCCC">these in this in this one slide for</font>

212
00:09:50,500 --> 00:09:57,070
<font color="#E5E5E5">example ampersand character could</font><font color="#CCCCCC"> be</font>

213
00:09:53,500 --> 00:09:59,590
replaced by<font color="#CCCCCC"> a semicolon</font><font color="#E5E5E5"> in a poisoned</font>

214
00:09:57,070 --> 00:10:01,810
<font color="#CCCCCC">Django</font><font color="#E5E5E5"> oval application so basically in</font>

215
00:09:59,590 --> 00:10:03,760
your<font color="#E5E5E5"> query string or in your post body</font>

216
00:10:01,810 --> 00:10:05,979
you have one person<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> just replace</font>

217
00:10:03,760 --> 00:10:07,660
that<font color="#CCCCCC"> this see Michalka semicolon so if</font>

218
00:10:05,980 --> 00:10:09,670
there is<font color="#CCCCCC"> a vast that is actually looking</font>

219
00:10:07,660 --> 00:10:12,069
for some parameters now from their point

220
00:10:09,670 --> 00:10:14,560
of view<font color="#CCCCCC"> probably that parameter</font><font color="#E5E5E5"> is not</font>

221
00:10:12,070 --> 00:10:19,330
there anymore<font color="#E5E5E5"> it's basically a lot of</font>

222
00:10:14,560 --> 00:10:21,729
things with semicolons and<font color="#E5E5E5"> for a PHP</font>

223
00:10:19,330 --> 00:10:24,340
application<font color="#CCCCCC"> of Apache they basically use</font>

224
00:10:21,730 --> 00:10:26,770
<font color="#CCCCCC">an you can send any</font><font color="#E5E5E5"> HTTP verb you want</font>

225
00:10:24,340 --> 00:10:28,900
to them<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> just send fubar you can</font>

226
00:10:26,770 --> 00:10:30,430
send<font color="#E5E5E5"> anything you want rather than</font>

227
00:10:28,900 --> 00:10:32,380
sending a post request you<font color="#CCCCCC"> can just</font>

228
00:10:30,430 --> 00:10:34,209
change<font color="#CCCCCC"> that close to fubar and it will</font>

229
00:10:32,380 --> 00:10:37,180
work normally<font color="#CCCCCC"> if they don't have</font><font color="#E5E5E5"> any</font>

230
00:10:34,210 --> 00:10:40,480
<font color="#E5E5E5">anymore protections HP classic is even</font>

231
00:10:37,180 --> 00:10:42,250
worse<font color="#E5E5E5"> you can basically put person</font>

232
00:10:40,480 --> 00:10:44,250
character<font color="#E5E5E5"> in the middle of it and it</font>

233
00:10:42,250 --> 00:10:47,350
doesn't<font color="#E5E5E5"> care as long</font><font color="#CCCCCC"> as there is no two</font>

234
00:10:44,250 --> 00:10:49,150
heading to her head characters

235
00:10:47,350 --> 00:10:51,730
immediately after person character<font color="#E5E5E5"> in</font>

236
00:10:49,150 --> 00:10:55,920
bill if you know that<font color="#CCCCCC"> percent a person</font>

237
00:10:51,730 --> 00:10:59,220
character<font color="#CCCCCC"> completing</font><font color="#E5E5E5"> also what</font><font color="#CCCCCC"> AC</font><font color="#E5E5E5"> class</font>

238
00:10:55,920 --> 00:11:02,639
Victor's<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a big convert some UTS</font>

239
00:10:59,220 --> 00:11:06,209
<font color="#CCCCCC">characters to ASCII characters it's</font>

240
00:11:02,639 --> 00:11:08,730
basically pretty much<font color="#CCCCCC"> random I found</font><font color="#E5E5E5"> a</font>

241
00:11:06,209 --> 00:11:12,810
bypass for<font color="#E5E5E5"> North's trip while ago</font>

242
00:11:08,730 --> 00:11:17,430
birthday and he basically the the author

243
00:11:12,810 --> 00:11:19,829
<font color="#CCCCCC">of North Korea</font><font color="#E5E5E5"> patched it and coded</font><font color="#CCCCCC"> xs/s</font>

244
00:11:17,430 --> 00:11:23,819
home<font color="#E5E5E5"> or molecule or something like</font><font color="#CCCCCC"> that</font>

245
00:11:19,829 --> 00:11:27,300
<font color="#E5E5E5">so basically it's SS who I can't say but</font>

246
00:11:23,820 --> 00:11:29,579
<font color="#E5E5E5">if you said</font><font color="#CCCCCC"> you'll find it it it was an</font>

247
00:11:27,300 --> 00:11:33,029
<font color="#E5E5E5">offensive</font><font color="#CCCCCC"> word but at the same time it</font>

248
00:11:29,579 --> 00:11:36,120
was it was basically<font color="#E5E5E5"> a good research on</font>

249
00:11:33,029 --> 00:11:39,000
that an<font color="#E5E5E5"> Apache Tomcat</font><font color="#CCCCCC"> anything after</font>

250
00:11:36,120 --> 00:11:41,880
semicolon in the<font color="#E5E5E5"> past will</font><font color="#CCCCCC"> be considered</font>

251
00:11:39,000 --> 00:11:45,600
as a comment<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example even you can</font>

252
00:11:41,880 --> 00:11:47,820
<font color="#E5E5E5">even start putting a semicolon before</font>

253
00:11:45,600 --> 00:11:51,269
the first is slashing<font color="#CCCCCC"> your HTTP request</font>

254
00:11:47,820 --> 00:11:54,600
<font color="#E5E5E5">and it will be ignored</font><font color="#CCCCCC"> so you can have</font>

255
00:11:51,269 --> 00:11:56,940
this<font color="#E5E5E5"> past one semicolon flew past past</font>

256
00:11:54,600 --> 00:11:58,980
<font color="#E5E5E5">two semicolon anything else</font>

257
00:11:56,940 --> 00:12:01,410
<font color="#CCCCCC">slash simple it's exactly the same</font><font color="#E5E5E5"> as</font>

258
00:11:58,980 --> 00:12:04,380
<font color="#CCCCCC">pass one past so if you have a RAF</font><font color="#E5E5E5"> that</font>

259
00:12:01,410 --> 00:12:06,810
actually cares<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the full the full</font>

260
00:12:04,380 --> 00:12:09,329
<font color="#E5E5E5">path and something like and then</font><font color="#CCCCCC"> a slash</font>

261
00:12:06,810 --> 00:12:12,029
<font color="#CCCCCC">then it's going</font><font color="#E5E5E5"> to be by fastening then</font>

262
00:12:09,329 --> 00:12:14,550
it sees this and<font color="#E5E5E5"> something very strange</font>

263
00:12:12,029 --> 00:12:17,220
<font color="#CCCCCC">Apache</font><font color="#E5E5E5"> Tomcat actually has done</font>

264
00:12:14,550 --> 00:12:22,109
<font color="#CCCCCC">something</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is not actually against</font>

265
00:12:17,220 --> 00:12:25,160
RFC<font color="#E5E5E5"> against HTTP RFC with HTTP 0.9 you</font>

266
00:12:22,110 --> 00:12:28,170
can only send a get request in Bangla

267
00:12:25,160 --> 00:12:31,410
but with<font color="#CCCCCC"> apache tomcat we can send a</font>

268
00:12:28,170 --> 00:12:34,769
post request<font color="#E5E5E5"> you just need to remove the</font>

269
00:12:31,410 --> 00:12:36,990
HTTP<font color="#CCCCCC"> version from it and then it will</font>

270
00:12:34,769 --> 00:12:38,699
<font color="#E5E5E5">work and it</font><font color="#CCCCCC"> will see all those</font><font color="#E5E5E5"> headers</font>

271
00:12:36,990 --> 00:12:41,190
it will see<font color="#CCCCCC"> your post requests</font><font color="#E5E5E5"> and</font>

272
00:12:38,699 --> 00:12:45,779
basically<font color="#E5E5E5"> from your last point of view</font>

273
00:12:41,190 --> 00:12:49,199
it's just a weird<font color="#E5E5E5"> request so let's start</font>

274
00:12:45,779 --> 00:12:52,680
with<font color="#E5E5E5"> that for for this talk today I have</font>

275
00:12:49,199 --> 00:12:56,130
<font color="#E5E5E5">chosen Ras</font><font color="#CCCCCC"> 10 s big and I'm going to</font>

276
00:12:52,680 --> 00:12:59,370
<font color="#E5E5E5">work with that so some of the mutations</font>

277
00:12:56,130 --> 00:13:03,990
<font color="#E5E5E5">here are going to work on other web</font>

278
00:12:59,370 --> 00:13:05,730
servers and<font color="#CCCCCC"> but some of them are not</font>

279
00:13:03,990 --> 00:13:07,150
<font color="#E5E5E5">going to work and they are especially</font>

280
00:13:05,730 --> 00:13:10,870
<font color="#E5E5E5">for</font><font color="#CCCCCC"> acid</font>

281
00:13:07,150 --> 00:13:13,840
<font color="#E5E5E5">that on is</font><font color="#CCCCCC"> 10</font><font color="#E5E5E5"> so even if you try some of</font>

282
00:13:10,870 --> 00:13:16,480
<font color="#E5E5E5">these on HP classic then it may not work</font>

283
00:13:13,840 --> 00:13:19,210
<font color="#CCCCCC">but we have</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> solutions for</font><font color="#E5E5E5"> them and</font>

284
00:13:16,480 --> 00:13:23,050
I'm going<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about those later</font><font color="#E5E5E5"> so</font>

285
00:13:19,210 --> 00:13:26,070
this is a<font color="#E5E5E5"> normal post request and it has</font>

286
00:13:23,050 --> 00:13:28,359
a sequel injection<font color="#E5E5E5"> payload</font><font color="#CCCCCC"> and input 1</font>

287
00:13:26,070 --> 00:13:31,180
normally if you send something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font>

288
00:13:28,360 --> 00:13:34,720
to any anything<font color="#E5E5E5"> that has</font><font color="#CCCCCC"> vas</font><font color="#E5E5E5"> inference</font>

289
00:13:31,180 --> 00:13:37,150
<font color="#E5E5E5">you would get an error that says 403 or</font>

290
00:13:34,720 --> 00:13:39,880
forbidden or something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it is</font>

291
00:13:37,150 --> 00:13:42,160
<font color="#CCCCCC">it the request</font><font color="#E5E5E5"> will not heat the web</font>

292
00:13:39,880 --> 00:13:44,950
server<font color="#E5E5E5"> we are going to mutate this to</font>

293
00:13:42,160 --> 00:13:47,650
<font color="#E5E5E5">this request now in the next slide I'm</font>

294
00:13:44,950 --> 00:13:51,940
going<font color="#CCCCCC"> to so these are slides are like</font>

295
00:13:47,650 --> 00:13:56,260
this<font color="#E5E5E5"> the red ones</font><font color="#CCCCCC"> are the ones</font><font color="#E5E5E5"> that I am</font>

296
00:13:51,940 --> 00:13:58,210
going<font color="#E5E5E5"> to kind of like</font><font color="#CCCCCC"> ok this one maybe</font>

297
00:13:56,260 --> 00:13:59,950
not<font color="#CCCCCC"> like that</font><font color="#E5E5E5"> but I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> post</font>

298
00:13:58,210 --> 00:14:03,070
there on top first

299
00:13:59,950 --> 00:14:06,240
<font color="#E5E5E5">so our check I have changed that to get</font>

300
00:14:03,070 --> 00:14:09,250
and I have added<font color="#E5E5E5"> content type header</font>

301
00:14:06,240 --> 00:14:13,800
from a<font color="#CCCCCC"> to.net point of view it's a still</font>

302
00:14:09,250 --> 00:14:16,750
<font color="#CCCCCC">a post request and you're going to and</font>

303
00:14:13,800 --> 00:14:18,400
<font color="#CCCCCC">and</font><font color="#E5E5E5"> now actually I haven't</font><font color="#CCCCCC"> added the</font>

304
00:14:16,750 --> 00:14:20,470
<font color="#CCCCCC">Content ID</font><font color="#E5E5E5"> so I'm going to change the</font>

305
00:14:18,400 --> 00:14:22,959
content that in the next<font color="#CCCCCC"> slide so I've</font>

306
00:14:20,470 --> 00:14:24,730
changed<font color="#CCCCCC"> posts</font><font color="#E5E5E5"> together</font><font color="#CCCCCC"> and in the next</font>

307
00:14:22,960 --> 00:14:26,770
<font color="#E5E5E5">slide</font><font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> change the content</font>

308
00:14:24,730 --> 00:14:29,680
<font color="#CCCCCC">type</font><font color="#E5E5E5"> so I'm going</font><font color="#CCCCCC"> to change the body</font>

309
00:14:26,770 --> 00:14:30,730
type<font color="#CCCCCC"> to a multi-part</font><font color="#E5E5E5"> form data which is</font>

310
00:14:29,680 --> 00:14:33,310
<font color="#E5E5E5">completely normal</font>

311
00:14:30,730 --> 00:14:35,530
<font color="#E5E5E5">this is standard you can</font><font color="#CCCCCC"> do that in</font>

312
00:14:33,310 --> 00:14:39,550
dotnet post<font color="#E5E5E5"> requests can be</font><font color="#CCCCCC"> converted to</font>

313
00:14:35,530 --> 00:14:43,930
a like the content type can<font color="#CCCCCC"> be converted</font>

314
00:14:39,550 --> 00:14:47,890
<font color="#E5E5E5">from basically URL encoded to multi-part</font>

315
00:14:43,930 --> 00:14:50,620
form data<font color="#E5E5E5"> so this is completely</font><font color="#CCCCCC"> ok but</font>

316
00:14:47,890 --> 00:14:54,819
the<font color="#E5E5E5"> next slide I want to</font><font color="#CCCCCC"> show you that</font>

317
00:14:50,620 --> 00:14:57,190
<font color="#E5E5E5">that red part form data semicolon also</font>

318
00:14:54,820 --> 00:14:59,950
those - characters after<font color="#CCCCCC"> the last one</font>

319
00:14:57,190 --> 00:15:02,110
the last<font color="#CCCCCC"> mandra you see can be</font><font color="#E5E5E5"> removed</font>

320
00:14:59,950 --> 00:15:04,330
as<font color="#CCCCCC"> well which</font><font color="#E5E5E5"> is basically against RFC</font>

321
00:15:02,110 --> 00:15:06,970
and<font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to make the HTTP</font><font color="#CCCCCC"> request</font>

322
00:15:04,330 --> 00:15:08,650
invalid but<font color="#CCCCCC"> they</font><font color="#E5E5E5"> still from a student</font>

323
00:15:06,970 --> 00:15:11,440
<font color="#CCCCCC">that point of view and</font><font color="#E5E5E5"> is completely</font>

324
00:15:08,650 --> 00:15:15,760
<font color="#E5E5E5">fine</font><font color="#CCCCCC"> you can do that</font><font color="#E5E5E5"> it doesn't matter</font>

325
00:15:11,440 --> 00:15:17,800
<font color="#E5E5E5">it will accept it so on the next slide</font>

326
00:15:15,760 --> 00:15:20,559
<font color="#CCCCCC">I'm going to</font><font color="#E5E5E5"> add useless</font>

327
00:15:17,800 --> 00:15:23,229
stuff<font color="#CCCCCC"> - this HTTP request - just make it</font>

328
00:15:20,559 --> 00:15:25,749
a little bit more<font color="#E5E5E5"> completing for the</font>

329
00:15:23,230 --> 00:15:29,110
weapon for the bus<font color="#E5E5E5"> so I have added</font>

330
00:15:25,749 --> 00:15:32,079
another boundary<font color="#E5E5E5"> on top and I have</font><font color="#CCCCCC"> added</font>

331
00:15:29,110 --> 00:15:35,049
semicolon file name<font color="#E5E5E5"> that a space between</font>

332
00:15:32,079 --> 00:15:38,049
<font color="#E5E5E5">file name and equal sign is intentional</font>

333
00:15:35,049 --> 00:15:41,290
if you don't put it there<font color="#CCCCCC"> from iOS point</font>

334
00:15:38,049 --> 00:15:43,689
of view dotnet on is it's a file request

335
00:15:41,290 --> 00:15:46,540
<font color="#CCCCCC">well now it's still a post request</font><font color="#E5E5E5"> so</font>

336
00:15:43,689 --> 00:15:49,209
you need<font color="#E5E5E5"> that and if you look</font><font color="#CCCCCC"> at this</font>

337
00:15:46,540 --> 00:15:51,730
request closely you can see that<font color="#CCCCCC"> the</font>

338
00:15:49,209 --> 00:15:53,559
double quotation hasn't<font color="#E5E5E5"> been closed</font>

339
00:15:51,730 --> 00:15:55,899
<font color="#E5E5E5">there is a reason for that</font>

340
00:15:53,559 --> 00:15:59,559
some blocks<font color="#CCCCCC"> can be boring</font><font color="#E5E5E5"> I simply just</font>

341
00:15:55,899 --> 00:16:01,869
<font color="#E5E5E5">begin</font><font color="#CCCCCC"> des and the boundary I put my name</font>

342
00:15:59,559 --> 00:16:03,999
<font color="#CCCCCC">there were again like my Twitter handle</font>

343
00:16:01,869 --> 00:16:06,160
<font color="#CCCCCC">but I could have put something else I</font>

344
00:16:03,999 --> 00:16:09,160
could<font color="#CCCCCC"> have</font><font color="#E5E5E5"> put</font><font color="#CCCCCC"> two and then I could have</font>

345
00:16:06,160 --> 00:16:11,889
<font color="#CCCCCC">added some rubbish later</font><font color="#E5E5E5"> with two to the</font>

346
00:16:09,160 --> 00:16:14,889
<font color="#CCCCCC">two this request</font><font color="#E5E5E5"> to confuse us</font><font color="#CCCCCC"> even</font>

347
00:16:11,889 --> 00:16:19,629
<font color="#E5E5E5">further so</font><font color="#CCCCCC"> in the next</font><font color="#E5E5E5"> slide what I'm</font>

348
00:16:14,889 --> 00:16:22,360
going to do this I have converted this

349
00:16:19,629 --> 00:16:24,939
request which is completely readable<font color="#E5E5E5"> as</font>

350
00:16:22,360 --> 00:16:27,249
you can see I still have<font color="#E5E5E5"> that sequel</font>

351
00:16:24,939 --> 00:16:28,779
injection<font color="#E5E5E5"> somewhere the still can be</font>

352
00:16:27,249 --> 00:16:31,689
worth<font color="#CCCCCC"> just like this you don't</font><font color="#E5E5E5"> need to</font>

353
00:16:28,779 --> 00:16:35,439
mutate it but we will mutate it and I

354
00:16:31,689 --> 00:16:38,319
have<font color="#E5E5E5"> I have basically encoded the the</font>

355
00:16:35,439 --> 00:16:41,949
request to the<font color="#E5E5E5"> server</font><font color="#CCCCCC"> I haven't seen</font>

356
00:16:38,319 --> 00:16:43,779
this anywhere<font color="#CCCCCC"> by searching in the</font>

357
00:16:41,949 --> 00:16:46,449
<font color="#CCCCCC">Internet</font><font color="#E5E5E5"> perhaps some other people have</font>

358
00:16:43,779 --> 00:16:51,670
found<font color="#E5E5E5"> it</font><font color="#CCCCCC"> but I</font><font color="#E5E5E5"> think that something new</font>

359
00:16:46,449 --> 00:16:54,639
<font color="#E5E5E5">so in here I have used IBM 0:37 encoding</font>

360
00:16:51,670 --> 00:16:56,860
<font color="#E5E5E5">from Ras point of view exactly the same</font>

361
00:16:54,639 --> 00:16:59,999
as the previous<font color="#E5E5E5"> request I have encoded</font>

362
00:16:56,860 --> 00:17:03,759
all this message as<font color="#E5E5E5"> you can see and as</font>

363
00:16:59,999 --> 00:17:08,289
you can<font color="#CCCCCC"> see also in the</font><font color="#E5E5E5"> query string the</font>

364
00:17:03,759 --> 00:17:08,589
message can<font color="#CCCCCC"> be encoded so how did I do</font>

365
00:17:08,289 --> 00:17:10,480
that

366
00:17:08,589 --> 00:17:13,418
how did are encoded<font color="#CCCCCC"> it's basically using</font>

367
00:17:10,480 --> 00:17:15,819
IBM 0:37<font color="#CCCCCC"> how can you do that yourself</font>

368
00:17:13,419 --> 00:17:18,639
it's very easy<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can just</font><font color="#E5E5E5"> use Python</font>

369
00:17:15,819 --> 00:17:21,459
you<font color="#E5E5E5"> can use anything else but</font><font color="#CCCCCC"> Python was</font>

370
00:17:18,638 --> 00:17:23,229
very easy so<font color="#E5E5E5"> as you can see I wanted to</font>

371
00:17:21,459 --> 00:17:27,100
encode content

372
00:17:23,230 --> 00:17:29,670
- disposition name<font color="#E5E5E5"> input 1 and then that</font>

373
00:17:27,099 --> 00:17:31,590
<font color="#CCCCCC">file name</font><font color="#E5E5E5"> this actually I had quite</font>

374
00:17:29,670 --> 00:17:34,950
<font color="#E5E5E5">have to remove</font><font color="#CCCCCC"> the double quote in the</font>

375
00:17:31,590 --> 00:17:37,980
end but<font color="#CCCCCC"> that was a</font><font color="#E5E5E5"> mistake but anyway</font>

376
00:17:34,950 --> 00:17:41,670
you you can get<font color="#E5E5E5"> the idea how how I have</font>

377
00:17:37,980 --> 00:17:45,270
actually encoded this and<font color="#E5E5E5"> after you URL</font>

378
00:17:41,670 --> 00:17:48,780
decoded it it will be lighter<font color="#E5E5E5"> you can</font>

379
00:17:45,270 --> 00:17:50,970
keep it encoded in the request other web

380
00:17:48,780 --> 00:17:53,490
servers are different

381
00:17:50,970 --> 00:17:58,410
the only web<font color="#E5E5E5"> server so I have tried this</font>

382
00:17:53,490 --> 00:18:01,760
on the<font color="#E5E5E5"> Python jangle it works in Python</font>

383
00:17:58,410 --> 00:18:05,550
<font color="#CCCCCC">- I think</font><font color="#E5E5E5"> you need</font><font color="#CCCCCC"> to send them decoded</font>

384
00:18:01,760 --> 00:18:08,340
URL decoded in<font color="#CCCCCC"> Python tree you have</font><font color="#E5E5E5"> to</font>

385
00:18:05,550 --> 00:18:10,139
encode them<font color="#E5E5E5"> URL encode them</font><font color="#CCCCCC"> so ask if</font>

386
00:18:08,340 --> 00:18:15,179
you can send them<font color="#CCCCCC"> in this format to the</font>

387
00:18:10,140 --> 00:18:17,280
server<font color="#CCCCCC"> a are actually Tomcat accepted</font>

388
00:18:15,180 --> 00:18:21,420
the encoded messages on the<font color="#E5E5E5"> in post body</font>

389
00:18:17,280 --> 00:18:25,020
not<font color="#CCCCCC"> in the query string I have a ESP</font>

390
00:18:21,420 --> 00:18:28,650
classic didn't even decode this so it

391
00:18:25,020 --> 00:18:32,340
doesn't<font color="#CCCCCC"> work on is SB classic and Apache</font>

392
00:18:28,650 --> 00:18:35,040
PHP<font color="#E5E5E5"> this one was not loyal because you</font>

393
00:18:32,340 --> 00:18:38,370
need to load some modules in<font color="#E5E5E5"> Apache to</font>

394
00:18:35,040 --> 00:18:41,850
decode messages<font color="#E5E5E5"> so effective on Apache</font>

395
00:18:38,370 --> 00:18:44,310
<font color="#E5E5E5">Tomcat</font><font color="#CCCCCC"> or ideas on dotnet and Python</font><font color="#E5E5E5"> and</font>

396
00:18:41,850 --> 00:18:48,840
Django<font color="#E5E5E5"> which is quite cool and for our</font>

397
00:18:44,310 --> 00:18:50,940
<font color="#CCCCCC">test</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> it's enough so no I</font><font color="#E5E5E5"> want to</font>

398
00:18:48,840 --> 00:18:55,050
<font color="#E5E5E5">convert</font><font color="#CCCCCC"> this message to a chunked</font>

399
00:18:50,940 --> 00:18:57,270
message basically chunk messages are the

400
00:18:55,050 --> 00:18:59,760
same request<font color="#E5E5E5"> as you can see your</font>

401
00:18:57,270 --> 00:19:02,670
silhouette<font color="#E5E5E5"> current it so that's good so</font>

402
00:18:59,760 --> 00:19:05,670
the chunk messages are basically the

403
00:19:02,670 --> 00:19:09,000
same<font color="#E5E5E5"> HTTP</font><font color="#CCCCCC"> requests as before I've only</font>

404
00:19:05,670 --> 00:19:12,090
added the size of that<font color="#CCCCCC"> course of the</font>

405
00:19:09,000 --> 00:19:14,400
<font color="#E5E5E5">message in hex to the top</font><font color="#CCCCCC"> of the request</font>

406
00:19:12,090 --> 00:19:17,879
<font color="#E5E5E5">as you can see so a for</font><font color="#CCCCCC"> example is like</font>

407
00:19:14,400 --> 00:19:20,490
<font color="#E5E5E5">10 characters that the space between and</font>

408
00:19:17,880 --> 00:19:23,610
before that<font color="#E5E5E5"> 63 which is lot length of</font>

409
00:19:20,490 --> 00:19:28,920
the<font color="#E5E5E5"> other bit of the body is necessary</font>

410
00:19:23,610 --> 00:19:31,199
<font color="#E5E5E5">for RA but on others it is a little bit</font>

411
00:19:28,920 --> 00:19:33,420
different<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> is also important to</font>

412
00:19:31,200 --> 00:19:36,660
<font color="#E5E5E5">think</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> basically</font>

413
00:19:33,420 --> 00:19:39,150
<font color="#CCCCCC">have one</font><font color="#E5E5E5"> character in one line even you</font>

414
00:19:36,660 --> 00:19:41,970
can have some sort<font color="#CCCCCC"> of like even if you</font>

415
00:19:39,150 --> 00:19:43,049
have URL encoding you can keep one

416
00:19:41,970 --> 00:19:44,970
person<font color="#E5E5E5"> in one</font>

417
00:19:43,049 --> 00:19:47,759
and then you can have the numbers on

418
00:19:44,970 --> 00:19:50,970
another line it is<font color="#E5E5E5"> a still going to let</font>

419
00:19:47,759 --> 00:19:53,369
so the web server is<font color="#CCCCCC"> going to convert</font>

420
00:19:50,970 --> 00:19:56,340
this message to a non<font color="#E5E5E5"> chunked message</font>

421
00:19:53,369 --> 00:20:00,738
and then decode this message based<font color="#E5E5E5"> on</font>

422
00:19:56,340 --> 00:20:07,709
<font color="#E5E5E5">the</font><font color="#CCCCCC"> encoding the</font><font color="#E5E5E5"> content type encoding</font>

423
00:20:00,739 --> 00:20:10,799
so if I had a URL encoded message rather

424
00:20:07,710 --> 00:20:15,239
<font color="#E5E5E5">than a multi-part message I could have</font>

425
00:20:10,799 --> 00:20:17,570
URL encoded the same request<font color="#E5E5E5"> but in here</font>

426
00:20:15,239 --> 00:20:20,399
I don't<font color="#E5E5E5"> need to do that</font><font color="#CCCCCC"> so I've changed</font>

427
00:20:17,570 --> 00:20:23,249
the body that<font color="#E5E5E5"> is completely nonsense</font>

428
00:20:20,399 --> 00:20:26,549
from last point of view<font color="#E5E5E5"> and tada</font><font color="#CCCCCC"> I have</font>

429
00:20:23,249 --> 00:20:29,249
<font color="#CCCCCC">ADD I have added more stupid stuff to it</font>

430
00:20:26,549 --> 00:20:32,249
so basically<font color="#E5E5E5"> comments after</font><font color="#CCCCCC"> they the</font>

431
00:20:29,249 --> 00:20:35,730
length of the<font color="#E5E5E5"> body as you</font><font color="#CCCCCC"> can see I have</font>

432
00:20:32,249 --> 00:20:38,639
even<font color="#CCCCCC"> added some sort of like boundary</font>

433
00:20:35,730 --> 00:20:40,980
two additional boundary to<font color="#E5E5E5"> the request</font>

434
00:20:38,639 --> 00:20:44,219
to confuse<font color="#CCCCCC"> rough you can you can do a</font>

435
00:20:40,980 --> 00:20:47,100
lot of<font color="#E5E5E5"> things here</font><font color="#CCCCCC"> you can even add more</font>

436
00:20:44,220 --> 00:20:49,169
stupider stuff right I couldn't<font color="#CCCCCC"> just</font>

437
00:20:47,100 --> 00:20:53,189
because I<font color="#E5E5E5"> couldn't fit it in this slide</font>

438
00:20:49,169 --> 00:20:55,919
<font color="#E5E5E5">for this purpose basically</font><font color="#CCCCCC"> it can bypass</font>

439
00:20:53,190 --> 00:20:59,639
a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> laughs and when I say a lot of</font>

440
00:20:55,919 --> 00:21:02,999
us<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> I have tried it in on some</font>

441
00:20:59,639 --> 00:21:07,590
<font color="#E5E5E5">of the cloud-based</font><font color="#CCCCCC"> laughs and it went</font>

442
00:21:02,999 --> 00:21:10,769
<font color="#CCCCCC">through basically</font><font color="#E5E5E5"> all of them it doesn't</font>

443
00:21:07,590 --> 00:21:13,649
work if the web server<font color="#CCCCCC"> or the bath I</font>

444
00:21:10,769 --> 00:21:15,600
should say has a<font color="#CCCCCC"> whiteness validation if</font>

445
00:21:13,649 --> 00:21:18,268
it basically says from my point of view

446
00:21:15,600 --> 00:21:21,209
this HTTP request is nonsense<font color="#E5E5E5"> I'm not</font>

447
00:21:18,269 --> 00:21:24,450
going<font color="#E5E5E5"> to let</font><font color="#CCCCCC"> it go</font><font color="#E5E5E5"> I'm going to deny</font>

448
00:21:21,210 --> 00:21:28,200
that they do that<font color="#E5E5E5"> yes that's going to be</font>

449
00:21:24,450 --> 00:21:30,389
fine<font color="#E5E5E5"> but there are only a</font><font color="#CCCCCC"> few</font><font color="#E5E5E5"> of us that</font>

450
00:21:28,200 --> 00:21:32,820
does that<font color="#E5E5E5"> and there anything laughs that</font>

451
00:21:30,389 --> 00:21:35,008
do<font color="#E5E5E5"> that if it's for</font><font color="#CCCCCC"> example of a store</font>

452
00:21:32,820 --> 00:21:37,439
<font color="#E5E5E5">that then the Chancellor is going</font><font color="#CCCCCC"> to</font>

453
00:21:35,009 --> 00:21:40,289
<font color="#E5E5E5">block the valid legitimate request is a</font>

454
00:21:37,440 --> 00:21:42,419
lot higher so it really depends what I

455
00:21:40,289 --> 00:21:46,080
will suggest<font color="#CCCCCC"> laughs from</font><font color="#E5E5E5"> class companies</font>

456
00:21:42,419 --> 00:21:49,320
basically reject all these<font color="#CCCCCC"> nonsense</font><font color="#E5E5E5"> is</font>

457
00:21:46,080 --> 00:21:55,408
rather<font color="#E5E5E5"> than using black lists so request</font>

458
00:21:49,320 --> 00:21:56,120
a<font color="#E5E5E5"> was this very simple straightforward</font>

459
00:21:55,409 --> 00:21:58,550
never

460
00:21:56,120 --> 00:22:00,620
we can understand it can read it you can

461
00:21:58,550 --> 00:22:05,440
<font color="#CCCCCC">basically convert it to</font><font color="#E5E5E5"> these nodes and</font>

462
00:22:00,620 --> 00:22:07,669
it will<font color="#E5E5E5"> boil</font><font color="#CCCCCC"> past your last protections</font>

463
00:22:05,440 --> 00:22:10,250
so what next

464
00:22:07,670 --> 00:22:13,460
it wasn't the<font color="#E5E5E5"> end of it you can steal</font>

465
00:22:10,250 --> 00:22:17,420
<font color="#E5E5E5">mutated further so now I'm going to talk</font>

466
00:22:13,460 --> 00:22:21,200
<font color="#CCCCCC">about HTTP pipelining so you you have</font>

467
00:22:17,420 --> 00:22:24,560
used<font color="#CCCCCC"> vs. so who have used</font><font color="#E5E5E5"> verbs it just</font>

468
00:22:21,200 --> 00:22:26,690
yes very good so most<font color="#E5E5E5"> of people here</font>

469
00:22:24,560 --> 00:22:30,200
have<font color="#CCCCCC"> used verb C</font><font color="#E5E5E5"> so when you're</font><font color="#CCCCCC"> using</font>

470
00:22:26,690 --> 00:22:32,380
<font color="#E5E5E5">their</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> /</font><font color="#CCCCCC"> Street has in for</font><font color="#E5E5E5"> example in</font>

471
00:22:30,200 --> 00:22:35,480
repeated in repeater or<font color="#E5E5E5"> other sections</font>

472
00:22:32,380 --> 00:22:37,670
an option to automatically update<font color="#CCCCCC"> the</font>

473
00:22:35,480 --> 00:22:40,400
content links so if<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to use</font>

474
00:22:37,670 --> 00:22:41,810
<font color="#CCCCCC">birdseed for this you can I'm not going</font>

475
00:22:40,400 --> 00:22:44,900
to promise<font color="#E5E5E5"> that you are going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> see</font>

476
00:22:41,810 --> 00:22:46,490
responses<font color="#E5E5E5"> from HTTP pipelining all of</font>

477
00:22:44,900 --> 00:22:48,890
the responses you<font color="#E5E5E5"> will</font><font color="#CCCCCC"> see the first</font><font color="#E5E5E5"> one</font>

478
00:22:46,490 --> 00:22:53,240
<font color="#E5E5E5">always</font><font color="#CCCCCC"> sometimes you can get all the</font>

479
00:22:48,890 --> 00:22:54,380
responses but your requests<font color="#E5E5E5"> are going to</font>

480
00:22:53,240 --> 00:22:57,620
<font color="#CCCCCC">heat the web search</font>

481
00:22:54,380 --> 00:23:03,050
so in HTTP pipelining<font color="#E5E5E5"> we will send</font>

482
00:22:57,620 --> 00:23:07,250
multiple<font color="#E5E5E5"> HTTP messages in one single</font>

483
00:23:03,050 --> 00:23:09,169
request<font color="#E5E5E5"> what it does is actually is when</font>

484
00:23:07,250 --> 00:23:13,250
we send<font color="#E5E5E5"> that request for example I have</font>

485
00:23:09,170 --> 00:23:16,700
content length<font color="#E5E5E5"> 21 21 is the length of</font>

486
00:23:13,250 --> 00:23:19,760
input 1 equal<font color="#CCCCCC"> to nothing</font><font color="#E5E5E5"> to see that's</font>

487
00:23:16,700 --> 00:23:23,630
21<font color="#CCCCCC"> characters after that in the</font><font color="#E5E5E5"> next</font>

488
00:23:19,760 --> 00:23:25,850
line<font color="#CCCCCC"> I have the second</font><font color="#E5E5E5"> request you can</font>

489
00:23:23,630 --> 00:23:28,370
<font color="#CCCCCC">basically continue doing that</font><font color="#E5E5E5"> and have</font>

490
00:23:25,850 --> 00:23:31,010
the third request and for<font color="#CCCCCC"> 3</font><font color="#E5E5E5"> question go</font>

491
00:23:28,370 --> 00:23:34,669
on however you<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> be careful about</font>

492
00:23:31,010 --> 00:23:37,940
<font color="#E5E5E5">it if you have connection</font><font color="#CCCCCC"> close that's</font>

493
00:23:34,670 --> 00:23:40,370
not going to<font color="#E5E5E5"> work HTTP pipelining only</font>

494
00:23:37,940 --> 00:23:42,770
will work with<font color="#CCCCCC"> keepalive</font><font color="#E5E5E5"> connection</font>

495
00:23:40,370 --> 00:23:49,040
<font color="#CCCCCC">table</font><font color="#E5E5E5"> eyes connection</font><font color="#CCCCCC"> keepalive</font><font color="#E5E5E5"> is</font>

496
00:23:42,770 --> 00:23:51,470
default for HTTP 1.1<font color="#E5E5E5"> but for HTTP 1.0 if</font>

497
00:23:49,040 --> 00:23:54,560
you don't mention connection<font color="#CCCCCC"> keep alive</font>

498
00:23:51,470 --> 00:23:57,170
<font color="#CCCCCC">web server think that is connection</font>

499
00:23:54,560 --> 00:24:00,320
<font color="#CCCCCC">close and if this request goes through a</font>

500
00:23:57,170 --> 00:24:01,910
proxy proxy may say okay<font color="#CCCCCC"> I need</font><font color="#E5E5E5"> to</font>

501
00:24:00,320 --> 00:24:04,220
<font color="#E5E5E5">rebuild this method this</font><font color="#CCCCCC"> is not one</font>

502
00:24:01,910 --> 00:24:06,590
message I have<font color="#E5E5E5"> to basically be chunk it</font>

503
00:24:04,220 --> 00:24:08,120
and not be chanted but then I have<font color="#E5E5E5"> to</font>

504
00:24:06,590 --> 00:24:11,179
break into<font color="#E5E5E5"> multiples</font>

505
00:24:08,120 --> 00:24:14,659
then it is between the proxy and<font color="#E5E5E5"> the</font>

506
00:24:11,180 --> 00:24:17,840
<font color="#CCCCCC">server to decide what they want to do</font>

507
00:24:14,660 --> 00:24:22,100
and proxy may say<font color="#E5E5E5"> I'm going to still</font>

508
00:24:17,840 --> 00:24:23,600
send it as<font color="#CCCCCC"> pipeline request but I'm not</font>

509
00:24:22,100 --> 00:24:24,050
going to<font color="#E5E5E5"> tell the client what I'm going</font>

510
00:24:23,600 --> 00:24:26,480
to do

511
00:24:24,050 --> 00:24:29,090
so basically<font color="#E5E5E5"> connection header is hot</font>

512
00:24:26,480 --> 00:24:31,630
<font color="#CCCCCC">quite</font><font color="#E5E5E5"> hot</font><font color="#CCCCCC"> if it goes</font><font color="#E5E5E5"> through a</font><font color="#CCCCCC"> proxy</font>

513
00:24:29,090 --> 00:24:34,820
then<font color="#CCCCCC"> you may not</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> send</font>

514
00:24:31,630 --> 00:24:37,940
multiple<font color="#E5E5E5"> requests but in a pen test you</font>

515
00:24:34,820 --> 00:24:40,189
can normally verify that by for example

516
00:24:37,940 --> 00:24:41,870
<font color="#E5E5E5">if you have something for</font><font color="#CCCCCC"> example</font>

517
00:24:40,190 --> 00:24:43,730
updating your name or something<font color="#E5E5E5"> like</font>

518
00:24:41,870 --> 00:24:46,250
that<font color="#CCCCCC"> a</font><font color="#E5E5E5"> request that updates something</font>

519
00:24:43,730 --> 00:24:49,940
<font color="#E5E5E5">you can put them in two different</font>

520
00:24:46,250 --> 00:24:52,640
requests<font color="#E5E5E5"> in HTTP pipelining</font><font color="#CCCCCC"> and heat the</font>

521
00:24:49,940 --> 00:24:55,610
server with it and see if the changes<font color="#E5E5E5"> in</font>

522
00:24:52,640 --> 00:24:59,030
the second<font color="#E5E5E5"> recess has an upload to the</font>

523
00:24:55,610 --> 00:25:01,729
website<font color="#E5E5E5"> and if it has then it means that</font>

524
00:24:59,030 --> 00:25:04,670
for<font color="#CCCCCC"> example you have probably sent a</font>

525
00:25:01,730 --> 00:25:06,440
request<font color="#E5E5E5"> as HTTP pipelining however be</font>

526
00:25:04,670 --> 00:25:08,080
careful<font color="#CCCCCC"> about them you may have the</font>

527
00:25:06,440 --> 00:25:11,480
<font color="#E5E5E5">Empress we may have sent those things</font>

528
00:25:08,080 --> 00:25:14,060
separately<font color="#CCCCCC"> so another way of</font><font color="#E5E5E5"> testing</font><font color="#CCCCCC"> for</font>

529
00:25:11,480 --> 00:25:16,370
that<font color="#E5E5E5"> is another header that we have max</font>

530
00:25:14,060 --> 00:25:19,520
<font color="#E5E5E5">forwards with that if you said max</font>

531
00:25:16,370 --> 00:25:22,159
<font color="#E5E5E5">forwards to</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> the whenever it hits</font>

532
00:25:19,520 --> 00:25:24,710
the proxy Percy is going to say okay I

533
00:25:22,160 --> 00:25:27,080
shouldn't forward it<font color="#CCCCCC"> any more because I</font>

534
00:25:24,710 --> 00:25:29,240
<font color="#E5E5E5">have to just respond that I've received</font>

535
00:25:27,080 --> 00:25:32,000
it there basically it's like it's time

536
00:25:29,240 --> 00:25:37,810
to<font color="#CCCCCC"> leave</font><font color="#E5E5E5"> things for HTTP requests we</font>

537
00:25:32,000 --> 00:25:40,820
reduce the number so what can I do<font color="#E5E5E5"> this</font>

538
00:25:37,810 --> 00:25:44,510
so with HTTP pipelining<font color="#CCCCCC"> I could</font>

539
00:25:40,820 --> 00:25:47,899
basically<font color="#E5E5E5"> send another HTTP 1.1 request</font>

540
00:25:44,510 --> 00:25:51,379
or 1.0<font color="#CCCCCC"> or anything anything like that</font>

541
00:25:47,900 --> 00:25:55,220
<font color="#E5E5E5">however it's basically</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> cruel to</font>

542
00:25:51,380 --> 00:25:58,700
<font color="#E5E5E5">send HTTP 0.9 here why because if you</font>

543
00:25:55,220 --> 00:26:01,580
just send<font color="#E5E5E5"> a HTTP 0.9 for example using</font>

544
00:25:58,700 --> 00:26:06,050
<font color="#E5E5E5">web suite itself in your first request</font>

545
00:26:01,580 --> 00:26:07,610
<font color="#E5E5E5">what would happen is that</font><font color="#CCCCCC"> the you</font><font color="#E5E5E5"> are</font>

546
00:26:06,050 --> 00:26:10,490
<font color="#CCCCCC">not going to see anything you're just</font>

547
00:26:07,610 --> 00:26:12,020
<font color="#CCCCCC">going to see empty response the best way</font>

548
00:26:10,490 --> 00:26:14,030
of<font color="#E5E5E5"> doing that if you are just going</font><font color="#CCCCCC"> to</font>

549
00:26:12,020 --> 00:26:16,280
send one<font color="#E5E5E5"> single vegetable 0.9 is</font>

550
00:26:14,030 --> 00:26:18,500
<font color="#E5E5E5">obviously using Python directly I have</font>

551
00:26:16,280 --> 00:26:21,980
created a tool for<font color="#E5E5E5"> that</font>

552
00:26:18,500 --> 00:26:25,070
to use socketing and to use<font color="#E5E5E5"> for HTTP</font>

553
00:26:21,980 --> 00:26:26,540
pipelining<font color="#E5E5E5"> 40.94 anything and I will</font>

554
00:26:25,070 --> 00:26:29,419
tell<font color="#E5E5E5"> you about that</font><font color="#CCCCCC"> later on</font><font color="#E5E5E5"> as well</font>

555
00:26:26,540 --> 00:26:32,870
<font color="#CCCCCC">that you can</font><font color="#E5E5E5"> use so with this one what</font>

556
00:26:29,420 --> 00:26:35,180
am I doing<font color="#E5E5E5"> here</font><font color="#CCCCCC"> so I'm sending</font><font color="#E5E5E5"> one post</font>

557
00:26:32,870 --> 00:26:38,330
request to<font color="#CCCCCC"> that</font><font color="#E5E5E5"> sample</font><font color="#CCCCCC"> delay</font><font color="#E5E5E5"> state state</font>

558
00:26:35,180 --> 00:26:40,820
and then I'm<font color="#E5E5E5"> sending the second 0.9</font>

559
00:26:38,330 --> 00:26:44,929
request to another page of<font color="#E5E5E5"> the same web</font>

560
00:26:40,820 --> 00:26:48,200
server with an<font color="#E5E5E5"> input value so if it is</font>

561
00:26:44,930 --> 00:26:50,000
<font color="#E5E5E5">Ras what it is going to do is even if</font>

562
00:26:48,200 --> 00:26:52,370
you put headers after that first line

563
00:26:50,000 --> 00:26:54,380
it's<font color="#E5E5E5"> going to ignore them but</font><font color="#CCCCCC"> if it was</font>

564
00:26:52,370 --> 00:26:57,080
Apache<font color="#CCCCCC"> Champa then it was</font><font color="#E5E5E5"> going through</font>

565
00:26:54,380 --> 00:27:00,260
<font color="#E5E5E5">so why is this interesting</font>

566
00:26:57,080 --> 00:27:03,740
page to be 0.9 basically is awful it is

567
00:27:00,260 --> 00:27:06,379
in the in the latest RFC it says we

568
00:27:03,740 --> 00:27:08,450
don't<font color="#E5E5E5"> expect web servers to support this</font>

569
00:27:06,380 --> 00:27:12,140
anymore<font color="#CCCCCC"> they</font><font color="#E5E5E5"> can completely report and</font>

570
00:27:08,450 --> 00:27:14,690
remove HD video for<font color="#CCCCCC"> non</font><font color="#E5E5E5"> support from the</font>

571
00:27:12,140 --> 00:27:18,140
their product to happen<font color="#E5E5E5"> so what would</font>

572
00:27:14,690 --> 00:27:21,170
happen<font color="#E5E5E5"> is</font><font color="#CCCCCC"> laugh</font><font color="#E5E5E5"> and so I had a vast in</font>

573
00:27:18,140 --> 00:27:24,490
my hand and<font color="#CCCCCC"> I was playing with</font><font color="#E5E5E5"> this that</font>

574
00:27:21,170 --> 00:27:28,880
was blocking something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> the slash</font>

575
00:27:24,490 --> 00:27:31,520
<font color="#CCCCCC">OWA that was for absolute exchange</font>

576
00:27:28,880 --> 00:27:34,370
<font color="#CCCCCC">servers so they were blocking their</font>

577
00:27:31,520 --> 00:27:37,430
emails externally so what they<font color="#E5E5E5"> didn't</font>

578
00:27:34,370 --> 00:27:40,729
think was what<font color="#E5E5E5"> would happen if I sent a</font>

579
00:27:37,430 --> 00:27:44,660
should be 0.9 so<font color="#E5E5E5"> if basically when I</font>

580
00:27:40,730 --> 00:27:46,730
<font color="#CCCCCC">sent it like this</font><font color="#E5E5E5"> it was like</font><font color="#CCCCCC"> oh I can't</font>

581
00:27:44,660 --> 00:27:48,920
even understand this let's<font color="#CCCCCC"> just hit the</font>

582
00:27:46,730 --> 00:27:51,200
<font color="#E5E5E5">server with that so I got two response</font>

583
00:27:48,920 --> 00:27:53,150
one of them was to their default page

584
00:27:51,200 --> 00:27:55,910
that I could access<font color="#E5E5E5"> the slash and then</font>

585
00:27:53,150 --> 00:27:58,640
<font color="#CCCCCC">the second one</font><font color="#E5E5E5"> was the slash OWA and the</font>

586
00:27:55,910 --> 00:28:01,340
<font color="#CCCCCC">file I wanted to</font><font color="#E5E5E5"> hit and actually hit</font>

587
00:27:58,640 --> 00:28:03,980
that<font color="#E5E5E5"> obviously it won't work for Outlook</font>

588
00:28:01,340 --> 00:28:06,350
<font color="#E5E5E5">because basically you need to send a</font>

589
00:28:03,980 --> 00:28:09,020
post request<font color="#E5E5E5"> but what if it was</font>

590
00:28:06,350 --> 00:28:10,879
<font color="#CCCCCC">something</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> slash admin a slice reset</font>

591
00:28:09,020 --> 00:28:13,370
the server or something<font color="#E5E5E5"> it would have</font>

592
00:28:10,880 --> 00:28:15,350
<font color="#CCCCCC">board I would have that my request</font><font color="#E5E5E5"> would</font>

593
00:28:13,370 --> 00:28:17,899
have gone<font color="#E5E5E5"> through and if it was apache</font>

594
00:28:15,350 --> 00:28:20,620
<font color="#E5E5E5">tomcat</font><font color="#CCCCCC"> or could basically post a</font><font color="#E5E5E5"> request</font>

595
00:28:17,900 --> 00:28:26,120
to the<font color="#CCCCCC"> server so it would have been crew</font>

596
00:28:20,620 --> 00:28:27,310
so tips for mutating the HTTP<font color="#CCCCCC"> request</font><font color="#E5E5E5"> so</font>

597
00:28:26,120 --> 00:28:29,540
be smart about it

598
00:28:27,310 --> 00:28:31,070
<font color="#CCCCCC">don't use</font><font color="#E5E5E5"> all these</font><font color="#CCCCCC"> things at the</font><font color="#E5E5E5"> same</font>

599
00:28:29,540 --> 00:28:31,770
<font color="#CCCCCC">time</font><font color="#E5E5E5"> use them one by one</font>

600
00:28:31,070 --> 00:28:34,889
see

601
00:28:31,770 --> 00:28:36,210
perhaps by changing the<font color="#CCCCCC"> request a</font><font color="#E5E5E5"> little</font>

602
00:28:34,890 --> 00:28:39,150
bit you can<font color="#CCCCCC"> buy</font><font color="#E5E5E5"> fast enough</font>

603
00:28:36,210 --> 00:28:40,740
don't burn all<font color="#CCCCCC"> of your exploits on a bus</font>

604
00:28:39,150 --> 00:28:42,510
at the<font color="#E5E5E5"> same time because</font><font color="#CCCCCC"> what is</font>

605
00:28:40,740 --> 00:28:46,350
happening<font color="#CCCCCC"> when you're mutating your</font>

606
00:28:42,510 --> 00:28:48,510
<font color="#E5E5E5">request the web server may say okay hang</font>

607
00:28:46,350 --> 00:28:51,120
on<font color="#CCCCCC"> I can see an old character here</font><font color="#E5E5E5"> I'm</font>

608
00:28:48,510 --> 00:28:53,850
going<font color="#CCCCCC"> to just</font><font color="#E5E5E5"> annoy everything</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> a vast</font>

609
00:28:51,120 --> 00:28:57,780
vast may say okay<font color="#E5E5E5"> oh this this request</font>

610
00:28:53,850 --> 00:28:59,309
looks<font color="#E5E5E5"> crazy now</font><font color="#CCCCCC"> I can let it go but</font><font color="#E5E5E5"> if</font>

611
00:28:57,780 --> 00:29:02,190
<font color="#E5E5E5">you were</font><font color="#CCCCCC"> just mutating it</font>

612
00:28:59,309 --> 00:29:05,610
I want a step we might have<font color="#CCCCCC"> bought past</font>

613
00:29:02,190 --> 00:29:07,559
it so use this one by<font color="#E5E5E5"> one and</font><font color="#CCCCCC"> see how</font><font color="#E5E5E5"> it</font>

614
00:29:05,610 --> 00:29:11,879
<font color="#CCCCCC">is</font><font color="#E5E5E5"> going to work there are a lot more</font>

615
00:29:07,559 --> 00:29:14,220
<font color="#CCCCCC">anomalous and what we need</font><font color="#E5E5E5"> to do is we</font>

616
00:29:11,880 --> 00:29:16,200
need<font color="#CCCCCC"> to just</font><font color="#E5E5E5"> document them all what I</font>

617
00:29:14,220 --> 00:29:18,990
have found is there are<font color="#CCCCCC"> a lot of</font>

618
00:29:16,200 --> 00:29:21,330
different places<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> have document</font>

619
00:29:18,990 --> 00:29:24,059
<font color="#E5E5E5">this</font><font color="#CCCCCC"> view</font><font color="#E5E5E5"> with some pieces but there is</font>

620
00:29:21,330 --> 00:29:26,309
no<font color="#E5E5E5"> one place to basically contain all</font>

621
00:29:24,059 --> 00:29:33,678
these different behaviors of<font color="#CCCCCC"> web servers</font>

622
00:29:26,309 --> 00:29:35,490
<font color="#CCCCCC">vats and proxies</font><font color="#E5E5E5"> so what else here</font><font color="#CCCCCC"> so</font>

623
00:29:33,679 --> 00:29:38,610
<font color="#CCCCCC">different technologies are different</font>

624
00:29:35,490 --> 00:29:41,520
<font color="#CCCCCC">obviously</font><font color="#E5E5E5"> so if you are trying something</font>

625
00:29:38,610 --> 00:29:44,490
on our air it may not<font color="#E5E5E5"> work</font><font color="#CCCCCC"> on our patchy</font>

626
00:29:41,520 --> 00:29:46,050
<font color="#E5E5E5">Tomcat or vice versa</font><font color="#CCCCCC"> so you need to</font>

627
00:29:44,490 --> 00:29:48,990
<font color="#CCCCCC">basically know what you're dealing with</font>

628
00:29:46,050 --> 00:29:50,970
<font color="#E5E5E5">first and then you can</font><font color="#CCCCCC"> hit</font><font color="#E5E5E5"> it and</font><font color="#CCCCCC"> you</font>

629
00:29:48,990 --> 00:29:55,080
may be able to<font color="#E5E5E5"> bypass the</font><font color="#CCCCCC"> bus in</font><font color="#E5E5E5"> front</font>

630
00:29:50,970 --> 00:29:57,929
of you also<font color="#E5E5E5"> I found this situation that</font>

631
00:29:55,080 --> 00:30:00,330
I<font color="#CCCCCC"> send for example a request to fiddler</font>

632
00:29:57,929 --> 00:30:01,559
and<font color="#E5E5E5"> fiddler completely change the</font>

633
00:30:00,330 --> 00:30:06,270
request is something else

634
00:30:01,559 --> 00:30:08,910
so basically perhaps using mutation<font color="#E5E5E5"> you</font>

635
00:30:06,270 --> 00:30:11,670
can send a<font color="#CCCCCC"> request that does something</font>

636
00:30:08,910 --> 00:30:14,040
<font color="#CCCCCC">if it doesn't go</font><font color="#E5E5E5"> through a</font><font color="#CCCCCC"> proxy and</font><font color="#E5E5E5"> it</font>

637
00:30:11,670 --> 00:30:17,220
does another if it<font color="#E5E5E5"> goes through a proxy</font>

638
00:30:14,040 --> 00:30:20,879
<font color="#CCCCCC">so basically you may be able to</font><font color="#E5E5E5"> build</font>

639
00:30:17,220 --> 00:30:23,820
<font color="#E5E5E5">some polymorphic requests that do</font>

640
00:30:20,880 --> 00:30:28,620
<font color="#E5E5E5">different</font><font color="#CCCCCC"> things based</font><font color="#E5E5E5"> on their location</font>

641
00:30:23,820 --> 00:30:31,379
<font color="#CCCCCC">so what I have done here</font><font color="#E5E5E5"> is I have</font>

642
00:30:28,620 --> 00:30:33,360
registered<font color="#E5E5E5"> this to my HTTP dot ninja</font><font color="#CCCCCC"> I</font>

643
00:30:31,380 --> 00:30:34,920
don't know why I could register<font color="#E5E5E5"> it but</font>

644
00:30:33,360 --> 00:30:38,760
it was available<font color="#E5E5E5"> and I got it</font>

645
00:30:34,920 --> 00:30:40,679
<font color="#CCCCCC">as I</font><font color="#E5E5E5"> think just three days ago</font><font color="#CCCCCC"> I have</font>

646
00:30:38,760 --> 00:30:43,950
uploaded everything<font color="#E5E5E5"> that I could in</font>

647
00:30:40,679 --> 00:30:44,780
github<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I'm currently I have linked</font>

648
00:30:43,950 --> 00:30:47,570
<font color="#E5E5E5">these steps</font>

649
00:30:44,780 --> 00:30:51,410
<font color="#E5E5E5">to that github</font><font color="#CCCCCC"> but what</font><font color="#E5E5E5"> I'm but the plan</font>

650
00:30:47,570 --> 00:30:53,330
<font color="#E5E5E5">is we are going to host host as</font><font color="#CCCCCC"> many</font>

651
00:30:51,410 --> 00:30:56,720
things as<font color="#E5E5E5"> we can all these anomalies</font><font color="#CCCCCC"> all</font>

652
00:30:53,330 --> 00:30:58,879
these different behaviors of the web

653
00:30:56,720 --> 00:31:01,730
servers<font color="#E5E5E5"> there so for example when you</font>

654
00:30:58,880 --> 00:31:04,190
are dealing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> Apache Tomcat you don't</font>

655
00:31:01,730 --> 00:31:06,620
need to do all<font color="#E5E5E5"> these tests yourself or</font>

656
00:31:04,190 --> 00:31:08,420
when for example<font color="#E5E5E5"> you have your own web</font>

657
00:31:06,620 --> 00:31:10,459
server like<font color="#E5E5E5"> Jackie website or something</font>

658
00:31:08,420 --> 00:31:13,460
like that<font color="#E5E5E5"> and I haven't tested it or</font>

659
00:31:10,460 --> 00:31:15,290
nobody<font color="#CCCCCC"> else has tested it you</font><font color="#E5E5E5"> run a tool</font>

660
00:31:13,460 --> 00:31:16,670
on it and you<font color="#E5E5E5"> get some results</font><font color="#CCCCCC"> and you</font>

661
00:31:15,290 --> 00:31:18,710
<font color="#E5E5E5">can upload the results here for</font>

662
00:31:16,670 --> 00:31:20,660
everybody<font color="#E5E5E5"> to have so they don't need to</font>

663
00:31:18,710 --> 00:31:22,550
<font color="#CCCCCC">go through</font><font color="#E5E5E5"> all these</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> we</font>

664
00:31:20,660 --> 00:31:26,330
can<font color="#E5E5E5"> share all</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> cool things at the</font>

665
00:31:22,550 --> 00:31:29,180
same<font color="#CCCCCC"> time that the target is</font><font color="#E5E5E5"> to have a</font>

666
00:31:26,330 --> 00:31:31,699
framework<font color="#E5E5E5"> so then we can test the</font>

667
00:31:29,180 --> 00:31:33,650
applications made so obviously what

668
00:31:31,700 --> 00:31:36,830
would happen is that<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

669
00:31:33,650 --> 00:31:40,130
bypass<font color="#E5E5E5"> these things gradually and sorry</font>

670
00:31:36,830 --> 00:31:45,199
<font color="#E5E5E5">block these things</font><font color="#CCCCCC"> gradually but that is</font>

671
00:31:40,130 --> 00:31:47,570
for good reason so if last can block<font color="#E5E5E5"> bad</font>

672
00:31:45,200 --> 00:31:50,450
<font color="#E5E5E5">requests if we are making</font><font color="#CCCCCC"> Maps</font><font color="#E5E5E5"> more</font>

673
00:31:47,570 --> 00:31:52,490
secure<font color="#E5E5E5"> then that means the</font><font color="#CCCCCC"> Internet is</font>

674
00:31:50,450 --> 00:31:54,530
going<font color="#E5E5E5"> to be safer place obviously it's</font>

675
00:31:52,490 --> 00:31:57,080
going to<font color="#CCCCCC"> be very more difficult for</font><font color="#E5E5E5"> us</font>

676
00:31:54,530 --> 00:32:00,530
<font color="#E5E5E5">as testers to test a web application</font>

677
00:31:57,080 --> 00:32:04,040
behind<font color="#CCCCCC"> us but hey we will</font><font color="#E5E5E5"> find new</font>

678
00:32:00,530 --> 00:32:06,620
bypasses video we will cover HTTP<font color="#CCCCCC"> 0 here</font>

679
00:32:04,040 --> 00:32:09,860
should be<font color="#CCCCCC"> 2 and we</font><font color="#E5E5E5"> will have a lot more</font>

680
00:32:06,620 --> 00:32:14,389
<font color="#E5E5E5">things to work</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> but then it's gonna</font>

681
00:32:09,860 --> 00:32:16,729
it's gonna keep<font color="#CCCCCC"> a</font><font color="#E5E5E5"> grow and we are going</font>

682
00:32:14,390 --> 00:32:19,400
<font color="#E5E5E5">to have a better tool to play with and</font>

683
00:32:16,730 --> 00:32:22,220
for<font color="#E5E5E5"> example if you get advanced in front</font>

684
00:32:19,400 --> 00:32:25,010
of you and<font color="#E5E5E5"> someone says</font><font color="#CCCCCC"> ok we have this</font>

685
00:32:22,220 --> 00:32:29,420
product<font color="#E5E5E5"> here that</font><font color="#CCCCCC"> does block for example</font>

686
00:32:25,010 --> 00:32:31,190
<font color="#CCCCCC">these things</font><font color="#E5E5E5"> test it for us and you want</font>

687
00:32:29,420 --> 00:32:33,860
to scratch your head and say<font color="#E5E5E5"> ok there</font>

688
00:32:31,190 --> 00:32:36,290
<font color="#CCCCCC">are millions of things you come to this</font>

689
00:32:33,860 --> 00:32:38,270
<font color="#CCCCCC">website to look at it and you will you</font>

690
00:32:36,290 --> 00:32:41,810
will use the tool<font color="#CCCCCC"> you</font><font color="#E5E5E5"> will run different</font>

691
00:32:38,270 --> 00:32:44,000
things on<font color="#CCCCCC"> the web servers and</font><font color="#E5E5E5"> to see</font>

692
00:32:41,810 --> 00:32:46,690
which ones are<font color="#E5E5E5"> going to be</font><font color="#CCCCCC"> blocked by</font>

693
00:32:44,000 --> 00:32:49,880
that<font color="#E5E5E5"> bus</font><font color="#CCCCCC"> you're going to report back</font><font color="#E5E5E5"> so</font>

694
00:32:46,690 --> 00:32:52,940
we hope it's<font color="#E5E5E5"> going to be good obviously</font>

695
00:32:49,880 --> 00:32:55,950
<font color="#CCCCCC">we need</font><font color="#E5E5E5"> the community to</font><font color="#CCCCCC"> help with</font><font color="#E5E5E5"> that</font>

696
00:32:52,940 --> 00:32:57,630
we need<font color="#CCCCCC"> different people to find</font>

697
00:32:55,950 --> 00:33:01,049
different to test<font color="#E5E5E5"> it on</font><font color="#CCCCCC"> different</font>

698
00:32:57,630 --> 00:33:03,710
applications to<font color="#CCCCCC"> work on this and and</font><font color="#E5E5E5"> if</font>

699
00:33:01,049 --> 00:33:07,440
people<font color="#E5E5E5"> are</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to for example upload</font>

700
00:33:03,710 --> 00:33:09,450
<font color="#E5E5E5">some data things that are going to be</font>

701
00:33:07,440 --> 00:33:11,549
false<font color="#CCCCCC"> for</font><font color="#E5E5E5"> example what would happen if I</font>

702
00:33:09,450 --> 00:33:14,100
say on<font color="#CCCCCC"> RS you can do this but</font><font color="#E5E5E5"> you</font>

703
00:33:11,549 --> 00:33:18,049
basically<font color="#CCCCCC"> can't so we need to work</font><font color="#E5E5E5"> that</font>

704
00:33:14,100 --> 00:33:21,870
out<font color="#E5E5E5"> something probably similar</font><font color="#CCCCCC"> to</font>

705
00:33:18,049 --> 00:33:25,168
guarantee a tool that works<font color="#E5E5E5"> on the</font>

706
00:33:21,870 --> 00:33:30,320
<font color="#CCCCCC">browser's so we thought browsers are</font>

707
00:33:25,169 --> 00:33:33,630
basically cool with relaxed with HTML

708
00:33:30,320 --> 00:33:36,240
<font color="#CCCCCC">that</font><font color="#E5E5E5"> servers also</font><font color="#CCCCCC"> relax with HTTP</font>

709
00:33:33,630 --> 00:33:39,360
requests<font color="#E5E5E5"> so perhaps if we find all these</font>

710
00:33:36,240 --> 00:33:43,970
<font color="#CCCCCC">things and document them</font><font color="#E5E5E5"> we can do a lot</font>

711
00:33:39,360 --> 00:33:46,229
more<font color="#E5E5E5"> than what</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> doing</font><font color="#CCCCCC"> currently and</font>

712
00:33:43,970 --> 00:33:48,659
thank you<font color="#E5E5E5"> very much for</font><font color="#CCCCCC"> coming here</font><font color="#E5E5E5"> and</font>

713
00:33:46,230 --> 00:33:57,210
<font color="#E5E5E5">listening</font><font color="#CCCCCC"> so if you have any questions I</font>

714
00:33:48,659 --> 00:33:58,500
<font color="#E5E5E5">can answer it now no questions okay</font>

715
00:33:57,210 --> 00:34:05,950
thank you<font color="#CCCCCC"> very much for coming here</font>

716
00:33:58,500 --> 00:34:05,950
[Applause]

