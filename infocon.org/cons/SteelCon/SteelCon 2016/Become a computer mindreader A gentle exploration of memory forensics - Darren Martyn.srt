1
00:00:00,000 --> 00:00:04,650
who talked to you about memory forensics

2
00:00:02,129 --> 00:00:06,089
today and what have spent the last<font color="#E5E5E5"> year</font>

3
00:00:04,650 --> 00:00:08,730
wasting my time with and being

4
00:00:06,089 --> 00:00:13,049
frustrated with when I<font color="#E5E5E5"> was working on my</font>

5
00:00:08,730 --> 00:00:16,079
<font color="#E5E5E5">thesis so well I well I'm a researcher</font>

6
00:00:13,049 --> 00:00:17,670
<font color="#CCCCCC">at zyphus I am Darren apparently a bad</font>

7
00:00:16,079 --> 00:00:20,099
influence and now apparently<font color="#E5E5E5"> a forensic</font>

8
00:00:17,670 --> 00:00:21,330
scientist or something<font color="#E5E5E5"> allegedly um they</font>

9
00:00:20,100 --> 00:00:25,350
thought<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was confident enough to pass</font>

10
00:00:21,330 --> 00:00:27,720
which I'm not so today we're going to

11
00:00:25,350 --> 00:00:31,740
talk about memory forensics and I've

12
00:00:27,720 --> 00:00:34,110
spent<font color="#E5E5E5"> the last year my life analyzing</font>

13
00:00:31,740 --> 00:00:36,000
linux user space rootkits<font color="#E5E5E5"> honeymoon news</font>

14
00:00:34,110 --> 00:00:39,149
here last year may have seen<font color="#E5E5E5"> excellent</font>

15
00:00:36,000 --> 00:00:41,040
talk by<font color="#E5E5E5"> Alastair about user space</font>

16
00:00:39,149 --> 00:00:42,660
rootkits and Linux and I've<font color="#E5E5E5"> spent time</font>

17
00:00:41,040 --> 00:00:45,750
examining what they do in memory and<font color="#E5E5E5"> how</font>

18
00:00:42,660 --> 00:00:47,309
to detect them and such and largely

19
00:00:45,750 --> 00:00:49,219
based around worked on when I was

20
00:00:47,309 --> 00:00:51,419
finished<font color="#E5E5E5"> Minh my undergrad thesis</font>

21
00:00:49,219 --> 00:00:53,100
there's some completely arbitrary and

22
00:00:51,420 --> 00:00:55,020
<font color="#E5E5E5">off-topic observations that</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> maiden is</font>

23
00:00:53,100 --> 00:00:56,370
doing this<font color="#E5E5E5"> and then there was some</font>

24
00:00:55,020 --> 00:00:58,260
pissing around<font color="#E5E5E5"> going kind of use</font>

25
00:00:56,370 --> 00:01:04,319
forensics in an offensive fashion to do

26
00:00:58,260 --> 00:01:06,240
fun<font color="#E5E5E5"> things might</font><font color="#CCCCCC"> be some of that so what</font>

27
00:01:04,319 --> 00:01:08,580
even is memory forensics well it's

28
00:01:06,240 --> 00:01:10,229
basically you've got the computer's

29
00:01:08,580 --> 00:01:12,630
memory which<font color="#CCCCCC"> is their current stage of</font>

30
00:01:10,229 --> 00:01:14,340
the<font color="#CCCCCC"> system at some point in time and if</font>

31
00:01:12,630 --> 00:01:16,380
you dump the RAM of a computer you've

32
00:01:14,340 --> 00:01:18,630
got like what's going<font color="#E5E5E5"> on on the box that</font>

33
00:01:16,380 --> 00:01:20,490
point in time and you can do signs with

34
00:01:18,630 --> 00:01:23,520
it to see what was being done and<font color="#CCCCCC"> also</font>

35
00:01:20,490 --> 00:01:24,570
it's off the<font color="#CCCCCC"> might'n live on disk all</font>

36
00:01:23,520 --> 00:01:26,369
sorts of interesting stuff like

37
00:01:24,570 --> 00:01:28,320
encryption keys at live in memory or

38
00:01:26,369 --> 00:01:29,970
memory resident malware and stuff and

39
00:01:28,320 --> 00:01:31,679
<font color="#E5E5E5">you can find all that you can do loads</font>

40
00:01:29,970 --> 00:01:34,140
of amazing stuff and you can have loads

41
00:01:31,680 --> 00:01:36,180
of<font color="#CCCCCC"> fun with it and you can</font><font color="#E5E5E5"> probably go</font>

42
00:01:34,140 --> 00:01:38,610
half mad trying<font color="#E5E5E5"> to make sense of a</font>

43
00:01:36,180 --> 00:01:41,159
<font color="#CCCCCC">16-gigabyte fucking Ram dump and you're</font>

44
00:01:38,610 --> 00:01:44,369
just like okay I've got 16 gigs of

45
00:01:41,159 --> 00:01:45,869
binary nonsense what the is this looking

46
00:01:44,369 --> 00:01:47,729
through<font color="#CCCCCC"> you're like oh there's</font><font color="#E5E5E5"> something</font>

47
00:01:45,869 --> 00:01:50,040
<font color="#CCCCCC">that vaguely makes sense and you know</font>

48
00:01:47,729 --> 00:01:52,140
you might have stuff happen that way and

49
00:01:50,040 --> 00:01:54,149
you might find<font color="#E5E5E5"> interesting things so you</font>

50
00:01:52,140 --> 00:01:56,400
<font color="#CCCCCC">can see literally</font><font color="#E5E5E5"> everything just like</font>

51
00:01:54,149 --> 00:01:59,320
<font color="#CCCCCC">carissa</font>

52
00:01:56,400 --> 00:02:03,460
and that is<font color="#CCCCCC"> the monetary cut tax for</font>

53
00:01:59,320 --> 00:02:06,960
that picture and this book here if you

54
00:02:03,460 --> 00:02:09,430
have an<font color="#E5E5E5"> interest in memory forensics and</font>

55
00:02:06,960 --> 00:02:11,200
forensic science in general and computer

56
00:02:09,430 --> 00:02:12,400
forensics I would advise getting a hold

57
00:02:11,200 --> 00:02:13,929
of a copy of that<font color="#E5E5E5"> book because it's</font>

58
00:02:12,400 --> 00:02:15,850
<font color="#CCCCCC">basically the Bible the</font><font color="#E5E5E5"> people who wrote</font>

59
00:02:13,930 --> 00:02:17,290
that<font color="#E5E5E5"> no may weigh more than I ever will</font>

60
00:02:15,850 --> 00:02:19,720
about stuff they've written half the

61
00:02:17,290 --> 00:02:21,549
tools you use do forensic analysis it's

62
00:02:19,720 --> 00:02:23,350
also a good pillow cuz about this thick

63
00:02:21,550 --> 00:02:25,750
and it's really<font color="#E5E5E5"> heavy and when you're</font>

64
00:02:23,350 --> 00:02:26,680
reading<font color="#E5E5E5"> it as light bedtime reading and</font>

65
00:02:25,750 --> 00:02:28,090
<font color="#E5E5E5">you fall asleep on a page about</font>

66
00:02:26,680 --> 00:02:31,600
structures and stuff and you're like

67
00:02:28,090 --> 00:02:35,140
this<font color="#E5E5E5"> actually isn't a bad pillow so</font>

68
00:02:31,600 --> 00:02:36,630
there<font color="#E5E5E5"> is that and yeah so but I'm mostly</font>

69
00:02:35,140 --> 00:02:39,910
going to<font color="#E5E5E5"> talk to you about today is</font>

70
00:02:36,630 --> 00:02:42,010
<font color="#CCCCCC">Linux user land rootkit and artist with</font>

71
00:02:39,910 --> 00:02:43,960
memory forensics so you've got<font color="#E5E5E5"> a box</font>

72
00:02:42,010 --> 00:02:45,429
<font color="#E5E5E5">that's infected with a linux user space</font>

73
00:02:43,960 --> 00:02:46,690
rootkit and you<font color="#E5E5E5"> won't find out if</font>

74
00:02:45,430 --> 00:02:48,070
there's<font color="#E5E5E5"> interesting stuff that leaves</font>

75
00:02:46,690 --> 00:02:49,180
behind a memory that doesn't write to

76
00:02:48,070 --> 00:02:51,190
disk or if you can detect<font color="#E5E5E5"> it</font>

77
00:02:49,180 --> 00:02:54,850
automagically or if you can spot it

78
00:02:51,190 --> 00:02:57,160
straight away spoiler yes you<font color="#CCCCCC"> can so</font>

79
00:02:54,850 --> 00:02:58,540
want to<font color="#E5E5E5"> find out stuff like what hooks</font>

80
00:02:57,160 --> 00:03:01,000
are in place you know what's it actually

81
00:02:58,540 --> 00:03:02,620
doing without much difficulty verse

82
00:03:01,000 --> 00:03:04,570
engineering and pain<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the arse work</font>

83
00:03:02,620 --> 00:03:06,130
like that because who wants to do<font color="#CCCCCC"> that</font>

84
00:03:04,570 --> 00:03:09,459
when you<font color="#E5E5E5"> can just go and find the</font>

85
00:03:06,130 --> 00:03:11,829
stuffed with minimal effort and you know

86
00:03:09,459 --> 00:03:13,600
also look for mistakes that were made by

87
00:03:11,830 --> 00:03:17,260
the rootkit developers<font color="#CCCCCC"> make a trivial to</font>

88
00:03:13,600 --> 00:03:18,910
detect can we carve the malware out of

89
00:03:17,260 --> 00:03:20,290
memory and then see if<font color="#CCCCCC"> we can reverse</font>

90
00:03:18,910 --> 00:03:23,380
engineer it afterwards or is it

91
00:03:20,290 --> 00:03:25,090
<font color="#E5E5E5">completely you know amass a little stuff</font>

92
00:03:23,380 --> 00:03:27,040
like thats basically dumped the<font color="#E5E5E5"> ram a</font>

93
00:03:25,090 --> 00:03:28,690
possibly infected system and see if we

94
00:03:27,040 --> 00:03:34,109
can<font color="#E5E5E5"> determine estly go that's infected</font>

95
00:03:28,690 --> 00:03:36,579
or that's not<font color="#CCCCCC"> infected and yeah so i</font>

96
00:03:34,110 --> 00:03:39,489
followed<font color="#CCCCCC"> this really simple method that</font>

97
00:03:36,580 --> 00:03:43,270
you know<font color="#CCCCCC"> mean basically i just</font><font color="#E5E5E5"> like</font>

98
00:03:39,489 --> 00:03:45,280
create a ton of the<font color="#E5E5E5"> MS get samples of</font>

99
00:03:43,270 --> 00:03:46,600
rootkits put malware in VMs I mean

100
00:03:45,280 --> 00:03:48,310
anyone who's done malware analysis

101
00:03:46,600 --> 00:03:50,140
probably is familiar<font color="#CCCCCC"> with this kind of</font>

102
00:03:48,310 --> 00:03:52,120
way of<font color="#E5E5E5"> going about doing things and then</font>

103
00:03:50,140 --> 00:03:53,738
<font color="#CCCCCC">dump the ramen them and then you just</font><font color="#E5E5E5"> go</font>

104
00:03:52,120 --> 00:03:56,260
have a look and see<font color="#CCCCCC"> what i can find and</font>

105
00:03:53,739 --> 00:03:58,090
it somewhat scientific<font color="#CCCCCC"> because you</font>

106
00:03:56,260 --> 00:04:01,620
control samples of you know not infected

107
00:03:58,090 --> 00:04:04,170
machines to compare against and stuff so

108
00:04:01,620 --> 00:04:06,579
basically like when I was<font color="#CCCCCC"> doing the</font>

109
00:04:04,170 --> 00:04:07,869
science bet to see if I could do this I

110
00:04:06,579 --> 00:04:09,040
just created a bunch of the<font color="#CCCCCC"> ends and</font>

111
00:04:07,870 --> 00:04:12,099
that's the list<font color="#E5E5E5"> of operating systems</font>

112
00:04:09,040 --> 00:04:13,900
there I only found out like at the last

113
00:04:12,099 --> 00:04:15,459
minute<font color="#E5E5E5"> that open sewers only support</font>

114
00:04:13,900 --> 00:04:19,000
<font color="#CCCCCC">64-bit</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> days which thought was a</font>

115
00:04:15,459 --> 00:04:21,009
bit odd so basically made VMs of all<font color="#E5E5E5"> of</font>

116
00:04:19,000 --> 00:04:23,949
those in fact the mall with<font color="#E5E5E5"> jynx to</font>

117
00:04:21,009 --> 00:04:25,599
<font color="#CCCCCC">Azazel an Umbreon because they got</font>

118
00:04:23,949 --> 00:04:27,130
publicly available source code and they

119
00:04:25,599 --> 00:04:31,270
did<font color="#E5E5E5"> not really upset any malware authors</font>

120
00:04:27,130 --> 00:04:32,800
by you know going<font color="#E5E5E5"> oh yes here is your</font>

121
00:04:31,270 --> 00:04:35,560
stuff you know leaking it and stuff like

122
00:04:32,800 --> 00:04:38,169
that and they all kind of work they're

123
00:04:35,560 --> 00:04:40,750
all a bit shit to be<font color="#E5E5E5"> honest I mean like</font>

124
00:04:38,169 --> 00:04:43,448
jinx<font color="#CCCCCC"> too has like a million problems</font>

125
00:04:40,750 --> 00:04:46,180
Azazel is a massive flaming pile of shit

126
00:04:43,449 --> 00:04:48,250
and<font color="#CCCCCC"> umbreon was written by somebody who</font>

127
00:04:46,180 --> 00:04:52,030
thinks the control<font color="#E5E5E5"> C control V is how</font>

128
00:04:48,250 --> 00:04:54,099
your program so if you're listening

129
00:04:52,030 --> 00:04:55,599
<font color="#CCCCCC">starfall you know you need to learn how</font>

130
00:04:54,099 --> 00:04:59,440
to actually code because your route gets

131
00:04:55,599 --> 00:05:01,030
terrible and it bricks boxes that it

132
00:04:59,440 --> 00:05:02,410
gets installed on it's real easy<font color="#E5E5E5"> to take</font>

133
00:05:01,030 --> 00:05:03,609
weeks<font color="#E5E5E5"> if your computer suddenly stops</font>

134
00:05:02,410 --> 00:05:07,570
working<font color="#CCCCCC"> you've probably</font><font color="#E5E5E5"> got one of these</font>

135
00:05:03,610 --> 00:05:09,190
<font color="#E5E5E5">on it soon as infecting the VMS i mean</font>

136
00:05:07,570 --> 00:05:10,990
they're all<font color="#E5E5E5"> like infecting the vm is a</font>

137
00:05:09,190 --> 00:05:13,000
really boring task because if L got

138
00:05:10,990 --> 00:05:14,320
these magic automated set up scripts

139
00:05:13,000 --> 00:05:16,180
that you run and that's<font color="#E5E5E5"> basically what</font>

140
00:05:14,320 --> 00:05:19,449
it looks like it goes installing rootkit

141
00:05:16,180 --> 00:05:20,919
hiding rootkit done dealt with<font color="#E5E5E5"> and look</font>

142
00:05:19,449 --> 00:05:23,919
you<font color="#E5E5E5"> know occasionally you'll see like</font>

143
00:05:20,919 --> 00:05:25,389
weird compilation<font color="#E5E5E5"> errors like that while</font>

144
00:05:23,919 --> 00:05:29,198
it does it because they're badly written

145
00:05:25,389 --> 00:05:30,820
and not good and then you<font color="#E5E5E5"> dump the ramen</font>

146
00:05:29,199 --> 00:05:33,940
so it's looking for an image for this

147
00:05:30,820 --> 00:05:36,190
and i typed in dumping ram into google

148
00:05:33,940 --> 00:05:39,520
images and<font color="#E5E5E5"> i got this and i don't think</font>

149
00:05:36,190 --> 00:05:41,770
<font color="#CCCCCC">that's what</font><font color="#E5E5E5"> it looks like so is using</font>

150
00:05:39,520 --> 00:05:43,719
<font color="#E5E5E5">VirtualBox as my vm software and turns</font>

151
00:05:41,770 --> 00:05:45,280
out VirtualBox it's awesome feature that

152
00:05:43,720 --> 00:05:47,259
you can just dump the<font color="#E5E5E5"> RAM of a vm with</font>

153
00:05:45,280 --> 00:05:49,780
<font color="#CCCCCC">the debug vm command and just</font><font color="#E5E5E5"> dump soda</font>

154
00:05:47,259 --> 00:05:51,969
<font color="#E5E5E5">dlf core file which volatility can read</font>

155
00:05:49,780 --> 00:05:54,388
and stuff so<font color="#E5E5E5"> that was really easy gets</font>

156
00:05:51,969 --> 00:05:56,590
hot it'll be more difficult than that so

157
00:05:54,389 --> 00:05:59,800
there are actually a lot more<font color="#E5E5E5"> ways to do</font>

158
00:05:56,590 --> 00:06:01,388
it so i use the hypervisors tools I used

159
00:05:59,800 --> 00:06:04,060
virtualbox as tools<font color="#E5E5E5"> dump durometer</font>

160
00:06:01,389 --> 00:06:05,710
running VMS so i can analyze them but

161
00:06:04,060 --> 00:06:08,199
you've also got other cool stuff like

162
00:06:05,710 --> 00:06:10,900
you've got DMA via firewire<font color="#CCCCCC"> or PCI</font>

163
00:06:08,199 --> 00:06:13,700
Express Thunderbolt apparently one of

164
00:06:10,900 --> 00:06:14,900
the USBC or something but

165
00:06:13,700 --> 00:06:16,700
I've<font color="#E5E5E5"> heard a lot of arguments in the</font>

166
00:06:14,900 --> 00:06:18,020
internet you know it has DMA oh it

167
00:06:16,700 --> 00:06:20,450
doesn't have DNA and I'm like I don't

168
00:06:18,020 --> 00:06:23,210
<font color="#E5E5E5">care just you know does it work yes or</font>

169
00:06:20,450 --> 00:06:25,610
no one can you plug the USB thing in

170
00:06:23,210 --> 00:06:26,780
<font color="#E5E5E5">neither way around finally but I mean</font>

171
00:06:25,610 --> 00:06:28,100
<font color="#E5E5E5">most people probably familiar with the</font>

172
00:06:26,780 --> 00:06:30,080
fact that firewire has direct memory

173
00:06:28,100 --> 00:06:31,520
access because you can don't<font color="#E5E5E5"> Brahmin you</font>

174
00:06:30,080 --> 00:06:33,770
can do fun things people's computers

175
00:06:31,520 --> 00:06:35,240
over firewire interfaces so you can

176
00:06:33,770 --> 00:06:37,580
don't Brown that way but there's<font color="#E5E5E5"> a</font>

177
00:06:35,240 --> 00:06:39,850
limitation you can only<font color="#E5E5E5"> get the first 4</font>

178
00:06:37,580 --> 00:06:41,990
gigabytes of RAM because reasons

179
00:06:39,850 --> 00:06:43,400
something I don't fully understand<font color="#E5E5E5"> that</font>

180
00:06:41,990 --> 00:06:46,190
somebody might be<font color="#CCCCCC"> able to explain</font><font color="#E5E5E5"> to me</font>

181
00:06:43,400 --> 00:06:49,310
<font color="#CCCCCC">later why you can only access the first</font>

182
00:06:46,190 --> 00:06:51,350
four gigs of physical memory or you can

183
00:06:49,310 --> 00:06:54,110
do it within the<font color="#E5E5E5"> host using lime CO or</font>

184
00:06:51,350 --> 00:06:56,540
<font color="#E5E5E5">wind pmm or depending what system you're</font>

185
00:06:54,110 --> 00:06:58,520
on you know you've got whole space tools

186
00:06:56,540 --> 00:07:00,830
if you've got this thing<font color="#CCCCCC"> called Magnus</font>

187
00:06:58,520 --> 00:07:02,810
memory forensics capture tool that run

188
00:07:00,830 --> 00:07:04,760
the windows box dumps the memory and you

189
00:07:02,810 --> 00:07:07,030
know they all involve installing drivers

190
00:07:04,760 --> 00:07:09,409
to create interface to grab the memory

191
00:07:07,030 --> 00:07:11,210
there's probably<font color="#E5E5E5"> other ways</font><font color="#CCCCCC"> that people</font>

192
00:07:09,410 --> 00:07:12,860
care about<font color="#E5E5E5"> that you know they</font><font color="#CCCCCC"> can go</font><font color="#E5E5E5"> no</font>

193
00:07:11,210 --> 00:07:14,359
you should do it this way and<font color="#E5E5E5"> people</font>

194
00:07:12,860 --> 00:07:15,980
should tell me other ways of dumping

195
00:07:14,360 --> 00:07:17,450
memory because it's always interesting

196
00:07:15,980 --> 00:07:21,200
to find<font color="#E5E5E5"> new ways then you can subvert</font>

197
00:07:17,450 --> 00:07:23,780
them and play with them so the first

198
00:07:21,200 --> 00:07:26,060
thing I looked at was<font color="#E5E5E5"> so that screenshot</font>

199
00:07:23,780 --> 00:07:28,359
oh wow that actually displays in and not

200
00:07:26,060 --> 00:07:30,920
crap manners on my screen it's terrible

201
00:07:28,360 --> 00:07:32,420
so the first thing we looked at is what

202
00:07:30,920 --> 00:07:34,250
process of load of<font color="#CCCCCC"> one libraries all</font>

203
00:07:32,420 --> 00:07:36,260
these<font color="#E5E5E5"> user space rootkits unloading all</font>

204
00:07:34,250 --> 00:07:37,880
work in the same way<font color="#E5E5E5"> involves</font><font color="#CCCCCC"> preloading</font>

205
00:07:36,260 --> 00:07:40,130
a library into a process so you've got

206
00:07:37,880 --> 00:07:44,000
this big wall of<font color="#E5E5E5"> text here and basically</font>

207
00:07:40,130 --> 00:07:45,440
it's<font color="#CCCCCC"> just a list of processes and what</font>

208
00:07:44,000 --> 00:07:47,800
libraries they've loaded and you see the

209
00:07:45,440 --> 00:07:51,350
really<font color="#E5E5E5"> dodgy lengthy looking one there</font>

210
00:07:47,800 --> 00:07:52,880
lipsy dot soda massive number blah blah

211
00:07:51,350 --> 00:07:54,980
blah that looks massively out of place

212
00:07:52,880 --> 00:07:57,409
and<font color="#E5E5E5"> is trying to look legitimate that's</font>

213
00:07:54,980 --> 00:07:58,520
<font color="#E5E5E5">probably not good and that's</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> one</font>

214
00:07:57,410 --> 00:08:00,950
that we're trying<font color="#E5E5E5"> to detect because</font>

215
00:07:58,520 --> 00:08:03,469
that's probably malware cuz it's got an

216
00:08:00,950 --> 00:08:09,320
absurdly long name good job on the

217
00:08:03,470 --> 00:08:11,780
stealth guys super good rootkits so then

218
00:08:09,320 --> 00:08:13,820
we can do stuff with volatility with

219
00:08:11,780 --> 00:08:17,450
<font color="#E5E5E5">random where we can look for PLT hooks</font>

220
00:08:13,820 --> 00:08:18,950
so hooks that are<font color="#E5E5E5"> hooking plte to hook</font>

221
00:08:17,450 --> 00:08:20,539
functions redirect them and you

222
00:08:18,950 --> 00:08:23,330
immediately see that something is

223
00:08:20,540 --> 00:08:25,370
hooking a shitload of stuff no look at

224
00:08:23,330 --> 00:08:27,260
<font color="#CCCCCC">sun library the massively long name is</font>

225
00:08:25,370 --> 00:08:30,710
hooking like every function on this

226
00:08:27,260 --> 00:08:33,289
system ever<font color="#E5E5E5"> like everything from</font><font color="#CCCCCC"> F open</font>

227
00:08:30,710 --> 00:08:35,659
to access to relink to chmod earnest and

228
00:08:33,289 --> 00:08:37,219
socket and stuff but not probably isn't

229
00:08:35,659 --> 00:08:39,049
legitimate<font color="#CCCCCC"> but the interesting thing</font>

230
00:08:37,220 --> 00:08:40,310
<font color="#CCCCCC">about this is</font><font color="#E5E5E5"> you get a partial list of</font>

231
00:08:39,049 --> 00:08:42,559
all the functions<font color="#E5E5E5"> that the rootkit</font>

232
00:08:40,309 --> 00:08:44,209
actually hooks so you don't have to do

233
00:08:42,559 --> 00:08:46,099
any hard reverse engineering work or

234
00:08:44,210 --> 00:08:48,140
open<font color="#CCCCCC"> Ida pro or do any science you just</font>

235
00:08:46,100 --> 00:08:51,110
kind of look at volatilities output and

236
00:08:48,140 --> 00:08:54,710
you go oh that's what<font color="#E5E5E5"> it does</font><font color="#CCCCCC"> okay so it</font>

237
00:08:51,110 --> 00:08:56,870
probably hides shit and does<font color="#CCCCCC"> root kitty</font>

238
00:08:54,710 --> 00:08:59,870
things yeah it's definitely malware cool

239
00:08:56,870 --> 00:09:01,910
and if you're<font color="#E5E5E5"> like some antivirus you</font>

240
00:08:59,870 --> 00:09:03,650
know or threat response or something you

241
00:09:01,910 --> 00:09:05,569
can probably write a massive blog post

242
00:09:03,650 --> 00:09:08,050
about it<font color="#E5E5E5"> and you can go we caught an apt</font>

243
00:09:05,570 --> 00:09:12,380
no you caught a 13 year old script kitty

244
00:09:08,050 --> 00:09:15,079
congratulations and then so like we've

245
00:09:12,380 --> 00:09:16,670
got like a list of what process of load

246
00:09:15,080 --> 00:09:18,470
at what libraries<font color="#CCCCCC"> and pro tip if there's</font>

247
00:09:16,670 --> 00:09:20,270
library loaded in every<font color="#E5E5E5"> fucking process</font>

248
00:09:18,470 --> 00:09:22,790
on the system and it's like blatantly

249
00:09:20,270 --> 00:09:25,819
hooking a ton of stuff it's probably bad

250
00:09:22,790 --> 00:09:28,400
news or a shitty discipline and either

251
00:09:25,820 --> 00:09:29,900
all you've got a problem so you know

252
00:09:28,400 --> 00:09:31,400
<font color="#E5E5E5">functions appear to be hoped and stuff</font>

253
00:09:29,900 --> 00:09:33,199
so if you actually decide to do any

254
00:09:31,400 --> 00:09:34,760
reverse engineering work you kind of

255
00:09:33,200 --> 00:09:36,860
already got like a massive cheat sheet

256
00:09:34,760 --> 00:09:39,830
going it does this stop maybe we<font color="#CCCCCC"> should</font>

257
00:09:36,860 --> 00:09:41,240
look at<font color="#E5E5E5"> this you know so</font><font color="#CCCCCC"> you know we</font>

258
00:09:39,830 --> 00:09:43,160
know where the hook lives so<font color="#CCCCCC"> we can go</font>

259
00:09:41,240 --> 00:09:45,110
care<font color="#E5E5E5"> of the file you can care if I lat a</font>

260
00:09:43,160 --> 00:09:47,089
memory and stuff or you<font color="#CCCCCC"> can find it on</font>

261
00:09:45,110 --> 00:09:52,490
disk you know what the things doing

262
00:09:47,090 --> 00:09:54,350
hooking functions you know so<font color="#E5E5E5"> you can</font>

263
00:09:52,490 --> 00:09:57,050
then like so if you<font color="#CCCCCC"> don't have a disk</font>

264
00:09:54,350 --> 00:09:58,340
image so if you don't<font color="#CCCCCC"> have a disk image</font>

265
00:09:57,050 --> 00:10:00,920
you<font color="#CCCCCC"> just have the memory capture because</font>

266
00:09:58,340 --> 00:10:03,170
these<font color="#CCCCCC"> days like one of the problems that</font>

267
00:10:00,920 --> 00:10:05,599
I've run into is like if you do forensic

268
00:10:03,170 --> 00:10:07,610
work on computers file systems these

269
00:10:05,600 --> 00:10:09,980
days are fucking enormous I mean like

270
00:10:07,610 --> 00:10:12,320
you've got multi terabyte things and

271
00:10:09,980 --> 00:10:14,420
nobody wants to sit there waiting for DD

272
00:10:12,320 --> 00:10:16,850
to finish imaging a bloody like five

273
00:10:14,420 --> 00:10:19,130
terabyte massive drive instead you just

274
00:10:16,850 --> 00:10:22,040
like capture the 64 gigs around my thing

275
00:10:19,130 --> 00:10:23,750
and analyze that instead because who

276
00:10:22,040 --> 00:10:25,459
wants to dig through a five gig disk

277
00:10:23,750 --> 00:10:28,010
image where do you put a<font color="#E5E5E5"> five gig disk</font>

278
00:10:25,460 --> 00:10:29,900
image will like sleuth kit or ft cave

279
00:10:28,010 --> 00:10:31,730
and open a<font color="#E5E5E5"> five-game file as a disk</font>

280
00:10:29,900 --> 00:10:32,810
image to do forensics on or you can<font color="#E5E5E5"> just</font>

281
00:10:31,730 --> 00:10:34,820
dump the round have a look at<font color="#E5E5E5"> that</font>

282
00:10:32,810 --> 00:10:35,900
instead so if you're looking<font color="#CCCCCC"> for the</font>

283
00:10:34,820 --> 00:10:37,820
rootkit and you've<font color="#E5E5E5"> only got a random</font>

284
00:10:35,900 --> 00:10:39,449
because<font color="#E5E5E5"> it's you</font><font color="#CCCCCC"> know not possible to</font>

285
00:10:37,820 --> 00:10:42,090
image the<font color="#E5E5E5"> disk or something or so</font>

286
00:10:39,450 --> 00:10:46,110
these or<font color="#CCCCCC"> em the box you can just care of</font>

287
00:10:42,090 --> 00:10:47,490
<font color="#E5E5E5">the</font><font color="#CCCCCC"> file 02</font><font color="#E5E5E5"> memory so there's a lengthy</font>

288
00:10:46,110 --> 00:10:48,930
commands there that does it and you

289
00:10:47,490 --> 00:10:51,630
basically just give it the process it

290
00:10:48,930 --> 00:10:53,130
lives in and the base address and you

291
00:10:51,630 --> 00:10:55,350
just care<font color="#E5E5E5"> of it out and it dumps out</font>

292
00:10:53,130 --> 00:10:59,730
this thing and you'll<font color="#E5E5E5"> notice that it</font>

293
00:10:55,350 --> 00:11:02,100
lived in system v that time so we have

294
00:10:59,730 --> 00:11:03,360
like a copy of the library and one thing

295
00:11:02,100 --> 00:11:04,830
<font color="#E5E5E5">that's important</font><font color="#CCCCCC"> to note for the reverse</font>

296
00:11:03,360 --> 00:11:07,980
engineers and stuff in the audience is

297
00:11:04,830 --> 00:11:11,210
<font color="#CCCCCC">that when you carve the library out of</font>

298
00:11:07,980 --> 00:11:13,500
memory as opposed to pulling it off disc

299
00:11:11,210 --> 00:11:15,810
it's not going to be the same<font color="#E5E5E5"> as</font><font color="#CCCCCC"> the one</font>

300
00:11:13,500 --> 00:11:17,670
on<font color="#CCCCCC"> disk so the md5 sum</font><font color="#E5E5E5"> or marching is</font>

301
00:11:15,810 --> 00:11:19,619
going to be slightly fucked and some of

302
00:11:17,670 --> 00:11:21,689
the alignment of the file is going to be

303
00:11:19,620 --> 00:11:25,170
slightly<font color="#E5E5E5"> banjaxed but it's still a</font>

304
00:11:21,690 --> 00:11:26,430
functioning shared object or library so

305
00:11:25,170 --> 00:11:28,170
when you care of it out<font color="#E5E5E5"> it'll work just</font>

306
00:11:26,430 --> 00:11:30,569
<font color="#E5E5E5">fine it's just not going to look like it</font>

307
00:11:28,170 --> 00:11:32,099
looks on disk for arbitrary reasons of

308
00:11:30,570 --> 00:11:33,980
it living in<font color="#E5E5E5"> RAM and you're carving it</font>

309
00:11:32,100 --> 00:11:36,300
out of a running process and stuff and

310
00:11:33,980 --> 00:11:37,950
like we already<font color="#E5E5E5"> know</font><font color="#CCCCCC"> from earlier that</font>

311
00:11:36,300 --> 00:11:39,209
it's hooking this massive list of

312
00:11:37,950 --> 00:11:40,980
functions which is basically the

313
00:11:39,210 --> 00:11:42,420
entirety of the<font color="#E5E5E5"> g livesey library like</font>

314
00:11:40,980 --> 00:11:44,490
just the shit load of like everything

315
00:11:42,420 --> 00:11:45,689
access<font color="#CCCCCC"> to open to whatever function the</font>

316
00:11:44,490 --> 00:11:48,750
script kiddie decide to write a hook for

317
00:11:45,690 --> 00:11:50,250
and we've got like most the reverse

318
00:11:48,750 --> 00:11:52,400
engineering work done for us at this

319
00:11:50,250 --> 00:11:54,990
point so we can be really lazy and not

320
00:11:52,400 --> 00:11:56,310
do much and here's the<font color="#E5E5E5"> arbitrary to pro</font>

321
00:11:54,990 --> 00:11:58,560
screenshot to show that i know what i'm

322
00:11:56,310 --> 00:12:00,180
<font color="#CCCCCC">talking about</font><font color="#E5E5E5"> because every single talk</font>

323
00:11:58,560 --> 00:12:02,250
<font color="#CCCCCC">in reverse engineering has one and</font><font color="#E5E5E5"> i</font>

324
00:12:00,180 --> 00:12:04,620
<font color="#E5E5E5">cannot be any different and that is the</font>

325
00:12:02,250 --> 00:12:07,410
strings page and you can see that like

326
00:12:04,620 --> 00:12:09,000
<font color="#CCCCCC">just by like stringing it in HIDA you</font>

327
00:12:07,410 --> 00:12:11,100
can see<font color="#CCCCCC"> that it does stuff that's</font>

328
00:12:09,000 --> 00:12:12,840
clearly not cool because<font color="#E5E5E5"> like why is it</font>

329
00:12:11,100 --> 00:12:15,560
spoofing maps and stuff and why is it

330
00:12:12,840 --> 00:12:18,600
doing is hide port that seems<font color="#E5E5E5"> legit cool</font>

331
00:12:15,560 --> 00:12:19,709
and here's<font color="#CCCCCC"> another I to pro screenshot</font>

332
00:12:18,600 --> 00:12:21,360
and that's actually<font color="#E5E5E5"> kind of an</font>

333
00:12:19,710 --> 00:12:22,890
interesting one because remember the

334
00:12:21,360 --> 00:12:25,530
massive string<font color="#E5E5E5"> lose in the process name</font>

335
00:12:22,890 --> 00:12:27,620
had coded in the thing it's like oh hi

336
00:12:25,530 --> 00:12:30,569
thing with arbitrary long number in it

337
00:12:27,620 --> 00:12:32,910
so<font color="#E5E5E5"> you know you can reverse-engineer it</font>

338
00:12:30,570 --> 00:12:34,980
and it's you know he can open<font color="#E5E5E5"> it up and</font>

339
00:12:32,910 --> 00:12:37,319
just because for balance rather<font color="#E5E5E5"> to is</font>

340
00:12:34,980 --> 00:12:39,030
actually way better because like there

341
00:12:37,320 --> 00:12:40,710
is source code<font color="#CCCCCC"> of pirated brew kit and</font>

342
00:12:39,030 --> 00:12:42,600
there is disassembly and it's super easy

343
00:12:40,710 --> 00:12:44,130
<font color="#E5E5E5">to read with the flow chart I mean it</font>

344
00:12:42,600 --> 00:12:46,410
doesn't crash your box when you try open

345
00:12:44,130 --> 00:12:47,730
and stuff so you can reverse the library

346
00:12:46,410 --> 00:12:48,250
you've carved out really easily and you

347
00:12:47,730 --> 00:12:50,890
<font color="#E5E5E5">know you can</font>

348
00:12:48,250 --> 00:12:54,400
do interest<font color="#E5E5E5"> in reverse engineering on it</font>

349
00:12:50,890 --> 00:12:55,420
you can find out<font color="#E5E5E5"> what it does and you</font>

350
00:12:54,400 --> 00:12:57,579
can have a lot of fun with<font color="#CCCCCC"> it because</font>

351
00:12:55,420 --> 00:12:59,770
<font color="#E5E5E5">you know once you've carbs out and you</font>

352
00:12:57,580 --> 00:13:01,930
decide to actually analyze and pretend

353
00:12:59,770 --> 00:13:04,060
<font color="#E5E5E5">to do science with it you</font><font color="#CCCCCC"> know you can</font>

354
00:13:01,930 --> 00:13:07,319
reverse-engineer it and we are standard

355
00:13:04,060 --> 00:13:10,239
disassembly tools<font color="#E5E5E5"> will deal with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so</font>

356
00:13:07,320 --> 00:13:11,200
like we we can carve them how we find

357
00:13:10,240 --> 00:13:13,120
out<font color="#E5E5E5"> what they do and this is a slight</font>

358
00:13:11,200 --> 00:13:14,410
dungeon that I discovered<font color="#E5E5E5"> if if somebody</font>

359
00:13:13,120 --> 00:13:16,960
knows a couple<font color="#E5E5E5"> of slides back I was</font>

360
00:13:14,410 --> 00:13:19,569
carving the rootkit out of PID one in

361
00:13:16,960 --> 00:13:22,060
the system<font color="#CCCCCC"> now I've been told by several</font>

362
00:13:19,570 --> 00:13:24,430
people that<font color="#E5E5E5"> know your user space rootkit</font>

363
00:13:22,060 --> 00:13:27,219
will never end up in PID one because in

364
00:13:24,430 --> 00:13:29,620
it is a magic<font color="#E5E5E5"> super special process that</font>

365
00:13:27,220 --> 00:13:31,450
isn't fuckable with from user space well

366
00:13:29,620 --> 00:13:34,150
it turns<font color="#CCCCCC"> out the pretty much every init</font>

367
00:13:31,450 --> 00:13:35,590
system system d open<font color="#E5E5E5"> or CSIS be in it</font>

368
00:13:34,150 --> 00:13:37,569
they're all kind of<font color="#E5E5E5"> terrible</font><font color="#CCCCCC"> they'll all</font>

369
00:13:35,590 --> 00:13:40,210
piracy GL do so to preload they'll all

370
00:13:37,570 --> 00:13:42,970
load your rootkit in and they'll all

371
00:13:40,210 --> 00:13:45,190
massively brick your box because if

372
00:13:42,970 --> 00:13:50,110
<font color="#E5E5E5">something goes wrong during an ish stop</font>

373
00:13:45,190 --> 00:13:51,550
brakes and I mean people you know told

374
00:13:50,110 --> 00:13:52,990
<font color="#E5E5E5">me that this doesn't</font><font color="#CCCCCC"> happen those</font>

375
00:13:51,550 --> 00:13:54,430
wondering why boxes kept being bricked

376
00:13:52,990 --> 00:13:55,870
when I was trying<font color="#CCCCCC"> to write rootkits and</font>

377
00:13:54,430 --> 00:13:57,489
they were like I was<font color="#E5E5E5"> like oh it</font><font color="#CCCCCC"> seemed</font>

378
00:13:55,870 --> 00:13:58,900
<font color="#CCCCCC">to be a problem they're like no no your</font>

379
00:13:57,490 --> 00:14:01,270
rootkit will never end up in<font color="#CCCCCC"> a net and</font>

380
00:13:58,900 --> 00:14:04,449
I'm<font color="#CCCCCC"> like well actually it does science</font>

381
00:14:01,270 --> 00:14:06,040
says it does I mean I've got proof now

382
00:14:04,450 --> 00:14:07,960
I've got forensic evidence that<font color="#E5E5E5"> this</font>

383
00:14:06,040 --> 00:14:11,230
shit goes into a net and it happens in

384
00:14:07,960 --> 00:14:13,030
all of them I mean I personally<font color="#CCCCCC"> find</font>

385
00:14:11,230 --> 00:14:17,860
systemd quite offensive but they're all

386
00:14:13,030 --> 00:14:20,079
equally shit so another slight tangent

387
00:14:17,860 --> 00:14:22,080
that<font color="#E5E5E5"> I discovered</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> doing is is so the</font>

388
00:14:20,080 --> 00:14:25,150
entire<font color="#E5E5E5"> jinx to family which is like the</font>

389
00:14:22,080 --> 00:14:27,160
<font color="#CCCCCC">most of the gene puddle as alice eric</font>

390
00:14:25,150 --> 00:14:28,600
holder of like linux rootkits well

391
00:14:27,160 --> 00:14:32,530
they're all completely broken a modern

392
00:14:28,600 --> 00:14:35,880
debian systems because so a lot of boxes

393
00:14:32,530 --> 00:14:38,319
<font color="#E5E5E5">seem to ship with sslv3 switched off and</font>

394
00:14:35,880 --> 00:14:39,850
for some reason something something

395
00:14:38,320 --> 00:14:41,230
poodles and things that<font color="#E5E5E5"> end up in pen</font>

396
00:14:39,850 --> 00:14:42,730
test reports so people<font color="#E5E5E5"> somebody</font>

397
00:14:41,230 --> 00:14:45,220
eventually just wrote a patch just

398
00:14:42,730 --> 00:14:47,020
switched off sslv3 and<font color="#CCCCCC"> open SSL you just</font>

399
00:14:45,220 --> 00:14:48,460
went it'll be fine we're going<font color="#E5E5E5"> to break</font>

400
00:14:47,020 --> 00:14:50,760
backwards compatibility for everyone

401
00:14:48,460 --> 00:14:53,050
including rootkit authors because

402
00:14:50,760 --> 00:14:55,150
they've all hard code at the<font color="#E5E5E5"> root kits</font>

403
00:14:53,050 --> 00:14:56,439
to use sslv3<font color="#E5E5E5"> because they don't have a</font>

404
00:14:55,150 --> 00:15:00,040
fucking clue what they're doing they're

405
00:14:56,440 --> 00:15:01,779
<font color="#E5E5E5">all idiots so none of the root kits will</font>

406
00:15:00,040 --> 00:15:03,998
work on modern boxes because

407
00:15:01,779 --> 00:15:07,120
is simply because sslv3 isn't available

408
00:15:03,999 --> 00:15:09,339
in we accept hook goes shit I wanted

409
00:15:07,120 --> 00:15:12,459
sslv3<font color="#CCCCCC"> what</font><font color="#E5E5E5"> silk shit gonna fall over</font>

410
00:15:09,339 --> 00:15:13,899
crash your box so when bad guy tries<font color="#CCCCCC"> to</font>

411
00:15:12,459 --> 00:15:15,518
you know<font color="#E5E5E5"> connect</font><font color="#CCCCCC"> your box suddenly</font>

412
00:15:13,899 --> 00:15:18,029
nothing works anymore and they're like

413
00:15:15,519 --> 00:15:21,040
oh what's<font color="#E5E5E5"> wrong well I'm afraid that</font>

414
00:15:18,029 --> 00:15:22,689
<font color="#CCCCCC">openssl</font><font color="#E5E5E5"> or somebody in apparently was</font>

415
00:15:21,040 --> 00:15:25,509
some<font color="#CCCCCC"> Debbie and developer that wrote the</font>

416
00:15:22,689 --> 00:15:27,099
patch they just killed sslv3<font color="#E5E5E5"> and it</font>

417
00:15:25,509 --> 00:15:29,470
breaks a load of stuff in Python as well

418
00:15:27,100 --> 00:15:32,199
as breaking rootkits and anyone who's

419
00:15:29,470 --> 00:15:33,550
seen the like requests or URL lib goat

420
00:15:32,199 --> 00:15:35,109
nope when you're trying<font color="#E5E5E5"> to connect</font>

421
00:15:33,550 --> 00:15:38,199
<font color="#E5E5E5">something is probably met this problem</font>

422
00:15:35,110 --> 00:15:39,579
yeah I thought there was a amusing thing

423
00:15:38,199 --> 00:15:41,649
that I<font color="#E5E5E5"> discovered it was there was a</font>

424
00:15:39,579 --> 00:15:43,569
bunch of fails i discovered that like

425
00:15:41,649 --> 00:15:46,329
that's one of the biggest ones that nope

426
00:15:43,569 --> 00:15:47,829
doesn't run you can<font color="#E5E5E5"> actually fix the</font>

427
00:15:46,329 --> 00:15:49,239
problem if you're interested<font color="#E5E5E5"> making</font>

428
00:15:47,829 --> 00:15:51,699
<font color="#CCCCCC">druke it's actually work by just</font>

429
00:15:49,240 --> 00:15:55,389
changing what ssl contacts is using to

430
00:15:51,699 --> 00:15:57,729
not sslv3 it's not hard but<font color="#CCCCCC"> i don't know</font>

431
00:15:55,389 --> 00:16:02,199
why mal worlders like to hard<font color="#E5E5E5"> code shit</font>

432
00:15:57,730 --> 00:16:07,720
isocell they should<font color="#CCCCCC"> just use so no rot</font>

433
00:16:02,199 --> 00:16:12,370
13 or something and yes<font color="#CCCCCC"> who a second</font>

434
00:16:07,720 --> 00:16:15,699
tangent is uh so last year marriage or

435
00:16:12,370 --> 00:16:18,339
else our show de Azazel has this zuhr

436
00:16:15,699 --> 00:16:21,550
method for hiding its secret magic

437
00:16:18,339 --> 00:16:25,269
rootkit login keys and it also uses this

438
00:16:21,550 --> 00:16:26,829
<font color="#CCCCCC">zuhr thing to encrypt like it's syscall</font>

439
00:16:25,269 --> 00:16:28,689
table of shattered hooks so if you run

440
00:16:26,829 --> 00:16:30,160
strings on the binary the badness won't

441
00:16:28,689 --> 00:16:32,019
show up and therefore it'll all be fine

442
00:16:30,160 --> 00:16:34,629
and<font color="#E5E5E5"> you'll really really really annoy</font>

443
00:16:32,019 --> 00:16:37,660
reverse engineers but i was looking<font color="#E5E5E5"> at</font>

444
00:16:34,629 --> 00:16:39,399
this and i was there like there has to

445
00:16:37,660 --> 00:16:41,079
be<font color="#CCCCCC"> like</font><font color="#E5E5E5"> a way that doesn't involve brute</font>

446
00:16:39,399 --> 00:16:43,120
forcing anything and that doesn't

447
00:16:41,079 --> 00:16:46,599
involve massive chores and then<font color="#E5E5E5"> i</font>

448
00:16:43,120 --> 00:16:48,639
attended this crypto class by luke and I

449
00:16:46,600 --> 00:16:50,110
was like hang on it<font color="#E5E5E5"> encrypts like it's</font>

450
00:16:48,639 --> 00:16:54,009
magic<font color="#CCCCCC"> siskel table which is known</font>

451
00:16:50,110 --> 00:16:56,079
plaintext with<font color="#E5E5E5"> zoar which isn't I mean</font>

452
00:16:54,009 --> 00:16:58,209
is Zoar encryption it's not really i

453
00:16:56,079 --> 00:17:00,370
mean like you've got a key things<font color="#E5E5E5"> that</font>

454
00:16:58,209 --> 00:17:01,689
need a key to go back on and i guess you

455
00:17:00,370 --> 00:17:03,370
<font color="#E5E5E5">can call it encryption if you want but</font>

456
00:17:01,689 --> 00:17:05,470
it's not really but we've got known

457
00:17:03,370 --> 00:17:08,079
plaintext and zora is reversible and it

458
00:17:05,470 --> 00:17:10,030
goes back<font color="#CCCCCC"> and forth and we just like</font>

459
00:17:08,079 --> 00:17:12,369
look for the<font color="#CCCCCC"> siskel table in the binary</font>

460
00:17:10,030 --> 00:17:13,329
<font color="#E5E5E5">and we go okay there's Cisco's able to</font>

461
00:17:12,369 --> 00:17:15,428
get the first<font color="#E5E5E5"> blob</font>

462
00:17:13,329 --> 00:17:18,639
nonsense and then use or with<font color="#CCCCCC"> except</font>

463
00:17:15,429 --> 00:17:22,809
<font color="#E5E5E5">because with yeah actually the next</font>

464
00:17:18,640 --> 00:17:24,539
slide shows it so that's<font color="#E5E5E5"> the</font><font color="#CCCCCC"> x encoded</font>

465
00:17:22,809 --> 00:17:29,110
of except that's<font color="#E5E5E5"> our known plaintext</font>

466
00:17:24,539 --> 00:17:32,019
that is the zorb or the magic ciphertext

467
00:17:29,110 --> 00:17:35,168
of except from the<font color="#E5E5E5"> rootkit which is that</font>

468
00:17:32,019 --> 00:17:37,299
blob of hex bytes there and if you just

469
00:17:35,169 --> 00:17:39,460
<font color="#E5E5E5">simply</font><font color="#CCCCCC"> zor the plain text with the</font>

470
00:17:37,299 --> 00:17:42,250
<font color="#E5E5E5">ciphertext you get the key because</font>

471
00:17:39,460 --> 00:17:44,320
that's house or works and stuff and this

472
00:17:42,250 --> 00:17:45,820
brew kit developer thought<font color="#CCCCCC"> ozar is</font>

473
00:17:44,320 --> 00:17:47,649
really fast<font color="#E5E5E5"> and i'll use</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> and it'll</font>

474
00:17:45,820 --> 00:17:49,299
hide everything except they encrypt all

475
00:17:47,649 --> 00:17:51,850
the variables in the rootkit with the

476
00:17:49,299 --> 00:17:53,350
same key and then they give you a

477
00:17:51,850 --> 00:17:55,029
massive like pile of known plaintext

478
00:17:53,350 --> 00:17:56,769
attack to play with and<font color="#E5E5E5"> it takes like</font>

479
00:17:55,029 --> 00:17:58,750
half a second and you don't need<font color="#E5E5E5"> to</font>

480
00:17:56,769 --> 00:18:01,799
brute force any keys to do science<font color="#E5E5E5"> with</font>

481
00:17:58,750 --> 00:18:04,240
them and have fun instead you just go oh

482
00:18:01,799 --> 00:18:06,190
thanks for<font color="#E5E5E5"> the keys guys what the fuck</font>

483
00:18:04,240 --> 00:18:08,440
was the point in doing that I mean like

484
00:18:06,190 --> 00:18:10,679
<font color="#E5E5E5">you've</font><font color="#CCCCCC"> already got like SLV</font><font color="#E5E5E5"> 3 in there</font>

485
00:18:08,440 --> 00:18:14,799
now you've got like more crypto fails so

486
00:18:10,679 --> 00:18:17,380
yes you know why not just you<font color="#CCCCCC"> know go</font>

487
00:18:14,799 --> 00:18:19,450
the whole hog and use stick like a blob

488
00:18:17,380 --> 00:18:21,639
of linux penguin in there and you know

489
00:18:19,450 --> 00:18:24,220
ECB mode or something just just to round

490
00:18:21,639 --> 00:18:26,889
it out I mean or just<font color="#E5E5E5"> fuck it just use</font>

491
00:18:24,220 --> 00:18:28,240
rot13 you<font color="#E5E5E5"> idiot because</font><font color="#CCCCCC"> it'd probably</font>

492
00:18:26,889 --> 00:18:31,928
make<font color="#CCCCCC"> more secure because</font><font color="#E5E5E5"> I probably</font>

493
00:18:28,240 --> 00:18:33,250
spent more time going well oh this seems

494
00:18:31,929 --> 00:18:38,500
like a lot of<font color="#E5E5E5"> work I'll just go do</font>

495
00:18:33,250 --> 00:18:40,269
something else so like we can yeah so

496
00:18:38,500 --> 00:18:41,710
like with like that's only like one

497
00:18:40,269 --> 00:18:43,330
thing the week a new memory forensics

498
00:18:41,710 --> 00:18:45,220
and<font color="#E5E5E5"> I spent about a year pissing about</font>

499
00:18:43,330 --> 00:18:46,510
with<font color="#E5E5E5"> this and just recovering rootkits</font>

500
00:18:45,220 --> 00:18:49,000
from memory and looking at them and it

501
00:18:46,510 --> 00:18:50,590
turns out that other fun stuff lives in

502
00:18:49,000 --> 00:18:52,539
memory as well that I should have spent

503
00:18:50,590 --> 00:18:53,740
more time playing with so if you<font color="#E5E5E5"> don't</font>

504
00:18:52,539 --> 00:18:55,149
somebody's round and they're using<font color="#E5E5E5"> full</font>

505
00:18:53,740 --> 00:18:57,130
disk encryption under most circumstances

506
00:18:55,149 --> 00:18:58,449
you've got their encryption key living

507
00:18:57,130 --> 00:19:01,779
in memory because that's how computers

508
00:18:58,450 --> 00:19:03,340
work and stuff and<font color="#E5E5E5"> stuff like volatility</font>

509
00:19:01,779 --> 00:19:05,230
is stuff you can just be like oh yes I

510
00:19:03,340 --> 00:19:07,240
quite<font color="#E5E5E5"> like your</font><font color="#CCCCCC"> truck your truecrypt</font>

511
00:19:05,230 --> 00:19:10,269
keys<font color="#E5E5E5"> thanks and you can just get them</font>

512
00:19:07,240 --> 00:19:12,519
and it's amazing because<font color="#CCCCCC"> yo stop lives</font>

513
00:19:10,269 --> 00:19:14,620
in<font color="#E5E5E5"> RAM and you can get it out so like</font>

514
00:19:12,519 --> 00:19:17,860
encryption keys passwords also it's a

515
00:19:14,620 --> 00:19:19,750
fun shit like that that isn't on<font color="#E5E5E5"> disk</font>

516
00:19:17,860 --> 00:19:21,340
for obvious reasons in plain text but in

517
00:19:19,750 --> 00:19:23,740
memory it's all in plain text and then

518
00:19:21,340 --> 00:19:25,090
<font color="#E5E5E5">you can go like it thanks guys your box</font>

519
00:19:23,740 --> 00:19:26,930
might be encrypted but if it's got a

520
00:19:25,090 --> 00:19:33,740
FireWire port inside your kindness

521
00:19:26,930 --> 00:19:35,830
rude yes pcma a slots as well you know

522
00:19:33,740 --> 00:19:38,690
the one on the side<font color="#E5E5E5"> of your laptop like</font>

523
00:19:35,830 --> 00:19:40,370
this slot here that you put in like old

524
00:19:38,690 --> 00:19:42,380
peripherals and stuff you've got one

525
00:19:40,370 --> 00:19:43,760
those are also completely d'enfer cuz

526
00:19:42,380 --> 00:19:45,260
you can just dump<font color="#CCCCCC"> around through those</font>

527
00:19:43,760 --> 00:19:46,820
as well there was a wonderful<font color="#CCCCCC"> tool</font>

528
00:19:45,260 --> 00:19:48,830
called the slot screamer<font color="#CCCCCC"> that does that</font>

529
00:19:46,820 --> 00:19:50,659
which is amazing<font color="#CCCCCC"> and really fun</font><font color="#E5E5E5"> and also</font>

530
00:19:48,830 --> 00:19:52,520
<font color="#E5E5E5">the hardware is only available from like</font>

531
00:19:50,660 --> 00:19:54,230
Taiwan or some shit takes like six weeks

532
00:19:52,520 --> 00:19:59,750
<font color="#E5E5E5">to arrive and it's broken half the time</font>

533
00:19:54,230 --> 00:20:01,430
but yeah so so like<font color="#E5E5E5"> if this password is</font>

534
00:19:59,750 --> 00:20:02,450
a function memory you know<font color="#E5E5E5"> maybe we</font>

535
00:20:01,430 --> 00:20:04,870
<font color="#CCCCCC">should do something</font><font color="#E5E5E5"> slightly more</font>

536
00:20:02,450 --> 00:20:07,760
offensive than looking for malware so

537
00:20:04,870 --> 00:20:08,989
you've got<font color="#E5E5E5"> like if you can dump the</font>

538
00:20:07,760 --> 00:20:10,490
round off marks like say if you're in a

539
00:20:08,990 --> 00:20:13,010
virtualized environment or something you

540
00:20:10,490 --> 00:20:14,810
can<font color="#E5E5E5"> then start carving out process</font>

541
00:20:13,010 --> 00:20:18,890
memory and feeding<font color="#E5E5E5"> into memory cats know</font>

542
00:20:14,810 --> 00:20:21,020
a word of warning here so sometimes this

543
00:20:18,890 --> 00:20:24,290
works and sometimes you'll crash mini

544
00:20:21,020 --> 00:20:26,570
cats because sometimes when you care

545
00:20:24,290 --> 00:20:28,340
about elsasser alexys process memory and

546
00:20:26,570 --> 00:20:30,350
try<font color="#E5E5E5"> make a mini dump over from ram</font>

547
00:20:28,340 --> 00:20:32,899
capture you'll end up with<font color="#E5E5E5"> this gigabyte</font>

548
00:20:30,350 --> 00:20:34,639
file of shite<font color="#E5E5E5"> that many cats just goes</font>

549
00:20:32,900 --> 00:20:37,430
nope not dealing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> that and I'm like</font>

550
00:20:34,640 --> 00:20:39,110
so looking those like why the<font color="#E5E5E5"> fuck is</font>

551
00:20:37,430 --> 00:20:41,150
<font color="#CCCCCC">else ass got like taking up the gig</font>

552
00:20:39,110 --> 00:20:42,379
around by itself and it's an office just

553
00:20:41,150 --> 00:20:44,300
that some of the tools for like

554
00:20:42,380 --> 00:20:47,270
extracting various bits from rom orbit

555
00:20:44,300 --> 00:20:48,710
slightly broken<font color="#CCCCCC"> i think and maybe</font><font color="#E5E5E5"> need</font>

556
00:20:47,270 --> 00:20:51,710
some fixing<font color="#E5E5E5"> and i still haven't found</font>

557
00:20:48,710 --> 00:20:54,890
where the problem lives<font color="#CCCCCC"> we can do other</font>

558
00:20:51,710 --> 00:20:57,290
<font color="#E5E5E5">stuff like</font><font color="#CCCCCC"> um like</font><font color="#E5E5E5"> memory forensic stuff</font>

559
00:20:54,890 --> 00:20:59,540
or just simply examining memory and

560
00:20:57,290 --> 00:21:02,210
analyzing memory<font color="#CCCCCC"> nick</font><font color="#E5E5E5"> theory stuff that</font>

561
00:20:59,540 --> 00:21:04,100
bad guys who steal credit cards and shit

562
00:21:02,210 --> 00:21:06,670
have been doing for<font color="#CCCCCC"> fuckin ages</font><font color="#E5E5E5"> like all</font>

563
00:21:04,100 --> 00:21:09,230
them points out<font color="#CCCCCC"> rom scrapers and stuff</font>

564
00:21:06,670 --> 00:21:11,300
there's like a<font color="#CCCCCC"> mini cats thingy</font>

565
00:21:09,230 --> 00:21:13,400
powershell thing that scrapes through

566
00:21:11,300 --> 00:21:15,680
your arm like process memory and starts

567
00:21:13,400 --> 00:21:18,050
looking<font color="#CCCCCC"> for stuff like logins and shit</font>

568
00:21:15,680 --> 00:21:19,400
and you can like just scrape through<font color="#E5E5E5"> ram</font>

569
00:21:18,050 --> 00:21:21,710
and look for credit<font color="#CCCCCC"> card numbers and</font>

570
00:21:19,400 --> 00:21:23,150
stuff<font color="#E5E5E5"> your unbox and you can apply the</font>

571
00:21:21,710 --> 00:21:25,040
techniques you use to<font color="#E5E5E5"> look for</font>

572
00:21:23,150 --> 00:21:26,930
interesting data and random offensively

573
00:21:25,040 --> 00:21:29,149
to looking through somebody else's

574
00:21:26,930 --> 00:21:31,460
<font color="#E5E5E5">random for fun stuff like their keys or</font>

575
00:21:29,150 --> 00:21:33,710
their credit cards or whatever else

576
00:21:31,460 --> 00:21:35,900
lives in memory<font color="#E5E5E5"> so you can do that and</font>

577
00:21:33,710 --> 00:21:37,640
then so<font color="#CCCCCC"> i decided to</font><font color="#E5E5E5"> play around with</font>

578
00:21:35,900 --> 00:21:38,780
this and<font color="#E5E5E5"> so</font><font color="#CCCCCC"> to a bit of science and play</font>

579
00:21:37,640 --> 00:21:40,559
around<font color="#E5E5E5"> with thing and this is what</font>

580
00:21:38,780 --> 00:21:43,139
dumping<font color="#CCCCCC"> ram looks like in windows box</font>

581
00:21:40,559 --> 00:21:45,990
it prints out loads of absolute rubbish

582
00:21:43,139 --> 00:21:47,939
and this actually was a misstep there

583
00:21:45,990 --> 00:21:50,700
was a<font color="#E5E5E5"> massive mistake made there so I</font>

584
00:21:47,940 --> 00:21:52,230
decided to dump ram on so have<font color="#E5E5E5"> to censor</font>

585
00:21:50,700 --> 00:21:55,889
a couple of the upcoming<font color="#E5E5E5"> slides actually</font>

586
00:21:52,230 --> 00:21:57,539
contain my password<font color="#E5E5E5"> and I forgot just</font>

587
00:21:55,889 --> 00:21:59,490
<font color="#CCCCCC">caught that guys cuz I mean I don't</font>

588
00:21:57,539 --> 00:22:01,259
<font color="#CCCCCC">reuse passwords much but you would have</font>

589
00:21:59,490 --> 00:22:03,090
gotten in somewhere yeah that's about

590
00:22:01,259 --> 00:22:04,559
dumping the RAM using wind p<font color="#CCCCCC"> man when</font>

591
00:22:03,090 --> 00:22:05,999
<font color="#E5E5E5">windows looks like and just prints out</font>

592
00:22:04,559 --> 00:22:09,720
loads of shite and<font color="#E5E5E5"> then makes a file</font>

593
00:22:05,999 --> 00:22:12,210
with all your a minute and then<font color="#CCCCCC"> we</font><font color="#E5E5E5"> could</font>

594
00:22:09,720 --> 00:22:14,820
also dumped by a firewire or we could

595
00:22:12,210 --> 00:22:17,610
dump via<font color="#CCCCCC"> PCI Express cards or we could</font>

596
00:22:14,820 --> 00:22:19,860
dump by a thunderbolt interfaces or pick

597
00:22:17,610 --> 00:22:21,869
your favorite technique here or whose if

598
00:22:19,860 --> 00:22:23,969
I done on a vm<font color="#CCCCCC"> I could have dumped it</font>

599
00:22:21,869 --> 00:22:26,399
from the hypervisor I mean you you know

600
00:22:23,970 --> 00:22:28,590
somebody somebody in here<font color="#E5E5E5"> probably knows</font>

601
00:22:26,399 --> 00:22:31,739
another arbitrary way of dumping<font color="#CCCCCC"> Rama</font>

602
00:22:28,590 --> 00:22:33,330
for box so you know just have a think

603
00:22:31,740 --> 00:22:34,850
about it<font color="#E5E5E5"> and use your imagination you'll</font>

604
00:22:33,330 --> 00:22:37,529
find some more ways to go about it<font color="#CCCCCC"> and</font>

605
00:22:34,850 --> 00:22:40,259
see it all<font color="#CCCCCC"> the blue doubt bits where my</font>

606
00:22:37,529 --> 00:22:42,749
password lived I'm my Alice a secret

607
00:22:40,259 --> 00:22:45,059
stuff that was my personal box that I

608
00:22:42,749 --> 00:22:46,889
was testing this on CA you get hashes

609
00:22:45,059 --> 00:22:49,350
like it turns out that volatile is an

610
00:22:46,889 --> 00:22:51,689
actual hash don't function so on a ram

611
00:22:49,350 --> 00:22:54,209
capture of windows box it's got a

612
00:22:51,690 --> 00:22:56,220
function to dump hashes from the ram you

613
00:22:54,210 --> 00:22:58,019
<font color="#CCCCCC">can also sometimes find plain text and</font>

614
00:22:56,220 --> 00:22:59,549
shit but literally he's got hash dump

615
00:22:58,019 --> 00:23:01,649
same as like interpreter or anything

616
00:22:59,549 --> 00:23:04,320
like that<font color="#E5E5E5"> and it I was kind of blown</font>

617
00:23:01,649 --> 00:23:06,979
<font color="#CCCCCC">away by this I was like cool I can get</font>

618
00:23:04,320 --> 00:23:10,139
hashes put the picture in then went on

619
00:23:06,980 --> 00:23:11,639
fuck the md for the windows hash of my

620
00:23:10,139 --> 00:23:15,508
<font color="#E5E5E5">actual passwords on these slides and you</font>

621
00:23:11,639 --> 00:23:18,689
fix that<font color="#E5E5E5"> so yeah you get like all of the</font>

622
00:23:15,509 --> 00:23:21,389
users and nonsense and you get like<font color="#E5E5E5"> the</font>

623
00:23:18,690 --> 00:23:23,009
GP<font color="#CCCCCC"> api in LSA and i centered those as</font>

624
00:23:21,389 --> 00:23:24,418
well weeks is probably somebody in here

625
00:23:23,009 --> 00:23:25,820
could do something<font color="#E5E5E5"> interesting with</font>

626
00:23:24,419 --> 00:23:27,720
those and completely screw me or

627
00:23:25,820 --> 00:23:30,408
somebody in<font color="#E5E5E5"> the internet who can do it</font>

628
00:23:27,720 --> 00:23:32,190
<font color="#CCCCCC">i'd</font><font color="#E5E5E5"> rather not have that happen</font><font color="#CCCCCC"> i</font>

629
00:23:30,409 --> 00:23:34,759
<font color="#CCCCCC">started thinking more and</font><font color="#E5E5E5"> i was like</font>

630
00:23:32,190 --> 00:23:37,860
well this<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> really powerful tool and</font>

631
00:23:34,759 --> 00:23:40,499
how can we actually use<font color="#CCCCCC"> it you know</font>

632
00:23:37,860 --> 00:23:42,059
because<font color="#E5E5E5"> you don't</font><font color="#CCCCCC"> want to like go about</font>

633
00:23:40,499 --> 00:23:44,820
you<font color="#CCCCCC"> know trying to dump the ram in every</font>

634
00:23:42,059 --> 00:23:46,980
box<font color="#E5E5E5"> you get rude on and then Google came</font>

635
00:23:44,820 --> 00:23:49,080
to the rescue and Google have this

636
00:23:46,980 --> 00:23:51,649
awesome thing called google rapid

637
00:23:49,080 --> 00:23:54,300
response and to remote forensics tool

638
00:23:51,649 --> 00:23:57,389
that they've<font color="#CCCCCC"> made</font><font color="#E5E5E5"> open source ins</font>

639
00:23:54,300 --> 00:23:59,520
really<font color="#CCCCCC"> amazing because</font><font color="#E5E5E5"> it's like design</font>

640
00:23:57,390 --> 00:24:01,320
you install it<font color="#CCCCCC"> in all of your endpoints</font>

641
00:23:59,520 --> 00:24:04,470
<font color="#E5E5E5">and you've got this centralized like</font>

642
00:24:01,320 --> 00:24:06,270
<font color="#E5E5E5">management interface and it runs in</font>

643
00:24:04,470 --> 00:24:08,010
docker for those of you who like darker

644
00:24:06,270 --> 00:24:11,010
and stuff by personally dunks I can't

645
00:24:08,010 --> 00:24:14,910
use it this is<font color="#E5E5E5"> complicated and modern</font>

646
00:24:11,010 --> 00:24:17,160
and not<font color="#E5E5E5"> virtualbox but yeah it like runs</font>

647
00:24:14,910 --> 00:24:20,940
in a docker instance you used to docker

648
00:24:17,160 --> 00:24:23,040
pull<font color="#E5E5E5"> your late something docker run</font>

649
00:24:20,940 --> 00:24:25,070
something or other<font color="#CCCCCC"> and then you get like</font>

650
00:24:23,040 --> 00:24:27,330
an instance of like your centralized

651
00:24:25,070 --> 00:24:28,860
forensic management tool that you

652
00:24:27,330 --> 00:24:31,379
install an agent in all your boxes it's

653
00:24:28,860 --> 00:24:33,750
cross-platform and stuff<font color="#E5E5E5"> and you can do</font>

654
00:24:31,380 --> 00:24:35,910
interesting things with it like so it's

655
00:24:33,750 --> 00:24:37,860
got this centralized<font color="#E5E5E5"> CNC server that</font>

656
00:24:35,910 --> 00:24:39,270
like all your boxes with this forensics

657
00:24:37,860 --> 00:24:41,010
tool and it will phone home<font color="#E5E5E5"> too</font><font color="#CCCCCC"> and</font>

658
00:24:39,270 --> 00:24:42,840
they'll call back just like a bot match

659
00:24:41,010 --> 00:24:46,620
it's got a nice web interface it's got

660
00:24:42,840 --> 00:24:49,199
statistics and all sorts of shiny and it

661
00:24:46,620 --> 00:24:51,570
looks<font color="#E5E5E5"> really pretty and Webbie and stuff</font>

662
00:24:49,200 --> 00:24:53,160
it's got a silent installer<font color="#E5E5E5"> Google</font>

663
00:24:51,570 --> 00:24:55,500
actually recommend for installing like

664
00:24:53,160 --> 00:24:57,810
upscale you just use PS exact to install

665
00:24:55,500 --> 00:25:00,960
<font color="#CCCCCC">it so</font><font color="#E5E5E5"> like it's the same as installing</font>

666
00:24:57,810 --> 00:25:03,270
any piece of like malware in a box it's

667
00:25:00,960 --> 00:25:04,800
actually effectively<font color="#E5E5E5"> really cool malware</font>

668
00:25:03,270 --> 00:25:06,690
because it's written by<font color="#E5E5E5"> Google's so</font>

669
00:25:04,800 --> 00:25:09,090
therefore virustotal never detected

670
00:25:06,690 --> 00:25:12,330
because<font color="#E5E5E5"> Google run virustotal</font><font color="#CCCCCC"> it's</font>

671
00:25:09,090 --> 00:25:14,399
cross-platform and it's got like

672
00:25:12,330 --> 00:25:16,110
functions like remote<font color="#E5E5E5"> Python code</font>

673
00:25:14,400 --> 00:25:18,840
execution like arbitrary remote

674
00:25:16,110 --> 00:25:21,750
scripting unboxes<font color="#CCCCCC"> fix it ships a pipe</font>

675
00:25:18,840 --> 00:25:24,179
interpreter and it also has like remote

676
00:25:21,750 --> 00:25:28,020
file system and memory forensics using

677
00:25:24,180 --> 00:25:29,580
rekal so thanks google for building like

678
00:25:28,020 --> 00:25:31,320
a really<font color="#E5E5E5"> awesome botnet with friends and</font>

679
00:25:29,580 --> 00:25:35,490
capabilities that's cross-platform and

680
00:25:31,320 --> 00:25:36,840
stuff really love you guys<font color="#CCCCCC"> for that it's</font>

681
00:25:35,490 --> 00:25:38,340
probably<font color="#E5E5E5"> really good for instant</font>

682
00:25:36,840 --> 00:25:39,959
response or some nonsense like that as

683
00:25:38,340 --> 00:25:44,340
<font color="#CCCCCC">well it's</font><font color="#E5E5E5"> more fun to use it</font><font color="#CCCCCC"> for like</font>

684
00:25:39,960 --> 00:25:48,420
slightly malicious reasons because<font color="#CCCCCC"> fun</font>

685
00:25:44,340 --> 00:25:50,970
<font color="#CCCCCC">and stuff so like yeah this kind of</font>

686
00:25:48,420 --> 00:25:53,880
something<font color="#CCCCCC"> that I'm so this</font><font color="#E5E5E5"> next bit kind</font>

687
00:25:50,970 --> 00:25:57,000
of the last part is something<font color="#CCCCCC"> that I've</font>

688
00:25:53,880 --> 00:25:58,830
only been really looking at recently how

689
00:25:57,000 --> 00:26:02,250
can we screw over memory forensics

690
00:25:58,830 --> 00:26:03,899
because once<font color="#E5E5E5"> people have kind of figured</font>

691
00:26:02,250 --> 00:26:05,040
out<font color="#CCCCCC"> like the awesome shit you can do</font>

692
00:26:03,900 --> 00:26:06,690
with memory forensics of pulling

693
00:26:05,040 --> 00:26:08,250
encryption keys at a memory or finding

694
00:26:06,690 --> 00:26:09,960
memory resident malware

695
00:26:08,250 --> 00:26:12,060
I say I<font color="#E5E5E5"> think to myself if I'm like a</font>

696
00:26:09,960 --> 00:26:14,220
malicious software developer and I'm

697
00:26:12,060 --> 00:26:16,290
putting malware in a box what if I don't

698
00:26:14,220 --> 00:26:18,990
want to<font color="#E5E5E5"> get caught by memory forensics</font>

699
00:26:16,290 --> 00:26:21,030
and initially I thought oh fuck no

700
00:26:18,990 --> 00:26:22,830
that's impossible because you know it's

701
00:26:21,030 --> 00:26:24,120
in RAM and once you<font color="#E5E5E5"> dump the RAM you've</font>

702
00:26:22,830 --> 00:26:25,439
got you know the exact state of the

703
00:26:24,120 --> 00:26:28,439
system at the time<font color="#E5E5E5"> and I started having</font>

704
00:26:25,440 --> 00:26:30,240
to think about how can<font color="#CCCCCC"> we subvert memory</font>

705
00:26:28,440 --> 00:26:33,420
forensics from working and how can we

706
00:26:30,240 --> 00:26:35,790
screw over<font color="#E5E5E5"> analysts using it so you can</font>

707
00:26:33,420 --> 00:26:38,220
either break the memory capture process

708
00:26:35,790 --> 00:26:40,560
or just not live in memory and these are

709
00:26:38,220 --> 00:26:42,300
somewhat untested ideas and somebody far

710
00:26:40,560 --> 00:26:44,850
smarter than me who actually likes

711
00:26:42,300 --> 00:26:47,730
writing C and pain can probably

712
00:26:44,850 --> 00:26:50,040
implement some of these I personally

713
00:26:47,730 --> 00:26:52,190
don't like C or pain much anymore

714
00:26:50,040 --> 00:26:56,070
<font color="#E5E5E5">because I like to go outside sometimes</font>

715
00:26:52,190 --> 00:26:57,570
you know once a week but you know so

716
00:26:56,070 --> 00:26:59,370
<font color="#E5E5E5">somebody else might want to test these I</font>

717
00:26:57,570 --> 00:27:00,960
might forget bored enough to actually do

718
00:26:59,370 --> 00:27:04,290
it and you know<font color="#E5E5E5"> decide to go slightly</font>

719
00:27:00,960 --> 00:27:07,260
mad so if you want to subvert the

720
00:27:04,290 --> 00:27:08,730
capture process so this is<font color="#CCCCCC"> something</font>

721
00:27:07,260 --> 00:27:10,530
<font color="#E5E5E5">that I've actually got a gripe with and</font>

722
00:27:08,730 --> 00:27:12,570
this<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do this could develop into a</font>

723
00:27:10,530 --> 00:27:14,610
slightly sweary rant but pretty much

724
00:27:12,570 --> 00:27:16,770
every<font color="#E5E5E5"> fucking tutorial the internet on</font>

725
00:27:14,610 --> 00:27:18,209
like every<font color="#E5E5E5"> fucking guide every training</font>

726
00:27:16,770 --> 00:27:20,400
course and doing memory forensics

727
00:27:18,210 --> 00:27:22,020
<font color="#E5E5E5">involves oh so you've got a host you</font>

728
00:27:20,400 --> 00:27:23,940
<font color="#CCCCCC">want to do forensics on here run this</font>

729
00:27:22,020 --> 00:27:25,440
software on the fucking host you're

730
00:27:23,940 --> 00:27:28,290
doing forensics on to get<font color="#CCCCCC"> a memory</font>

731
00:27:25,440 --> 00:27:30,570
capture I'm like no I spent four years

732
00:27:28,290 --> 00:27:32,460
doing fucking forensics of like you<font color="#CCCCCC"> know</font>

733
00:27:30,570 --> 00:27:34,379
not computer isn't shit and<font color="#E5E5E5"> that's the</font>

734
00:27:32,460 --> 00:27:35,640
what that seems like a fairly blatantly

735
00:27:34,380 --> 00:27:37,470
obvious thing you don't do you don't

736
00:27:35,640 --> 00:27:39,600
<font color="#E5E5E5">deck about with the</font><font color="#CCCCCC"> evidence to</font><font color="#E5E5E5"> get</font>

737
00:27:37,470 --> 00:27:41,640
<font color="#E5E5E5">evidence you don't go yet I'm going to</font>

738
00:27:39,600 --> 00:27:44,010
possibly fuck up all the evidence to

739
00:27:41,640 --> 00:27:45,630
capture evidence I mean<font color="#CCCCCC"> because what if</font>

740
00:27:44,010 --> 00:27:47,250
the malware goes oh shit that's around

741
00:27:45,630 --> 00:27:49,050
jumping to them maybe I should kill it

742
00:27:47,250 --> 00:27:51,150
or maybe just fuck with<font color="#CCCCCC"> it</font><font color="#E5E5E5"> because if</font>

743
00:27:49,050 --> 00:27:53,250
you've got a piece of malware on a box

744
00:27:51,150 --> 00:27:55,110
that you've got a box that's rooted and

745
00:27:53,250 --> 00:27:57,600
<font color="#E5E5E5">Scott malware on it and you decide to</font>

746
00:27:55,110 --> 00:27:59,550
run code on the box to try like capture

747
00:27:57,600 --> 00:28:01,050
evidence off the box the malware can

748
00:27:59,550 --> 00:28:04,020
fuck with your evidence collection and

749
00:28:01,050 --> 00:28:05,340
you're absolutely hosed and I'm<font color="#E5E5E5"> really</font>

750
00:28:04,020 --> 00:28:06,420
surprised<font color="#E5E5E5"> that nobody's done this I</font>

751
00:28:05,340 --> 00:28:09,360
haven't seen<font color="#E5E5E5"> a single proof-of-concept</font>

752
00:28:06,420 --> 00:28:11,460
<font color="#CCCCCC">linterna people doing this because you</font>

753
00:28:09,360 --> 00:28:16,139
just look for wind pmm running and<font color="#E5E5E5"> then</font>

754
00:28:11,460 --> 00:28:18,510
just kill it or even smarter lie to it

755
00:28:16,140 --> 00:28:20,010
because if you've got wind pmm trying to

756
00:28:18,510 --> 00:28:21,030
read your RAM and

757
00:28:20,010 --> 00:28:22,980
your memory and<font color="#E5E5E5"> you're a piece of</font>

758
00:28:21,030 --> 00:28:25,379
malware that's like running and you go

759
00:28:22,980 --> 00:28:29,010
oh fuck the<font color="#CCCCCC"> RAM</font><font color="#E5E5E5"> in this box is being</font>

760
00:28:25,380 --> 00:28:30,810
dumped hang on what<font color="#CCCCCC"> if I intercept its</font>

761
00:28:29,010 --> 00:28:32,640
<font color="#CCCCCC">rom dumping you just feed it rick astley</font>

762
00:28:30,810 --> 00:28:34,350
your<font color="#CCCCCC"> Knowles or goat Siri on cat or</font>

763
00:28:32,640 --> 00:28:36,720
something and you know fuck with the

764
00:28:34,350 --> 00:28:38,490
forensic analyst all day and I should

765
00:28:36,720 --> 00:28:40,740
probably<font color="#E5E5E5"> write a piece of code</font><font color="#CCCCCC"> that does</font>

766
00:28:38,490 --> 00:28:42,510
this because it's super trivial to do

767
00:28:40,740 --> 00:28:44,070
you just tell<font color="#CCCCCC"> it nope you're not reading</font>

768
00:28:42,510 --> 00:28:46,890
them bites<font color="#CCCCCC"> your even my bites now baby</font>

769
00:28:44,070 --> 00:28:48,899
and just keep feeding it shit and this

770
00:28:46,890 --> 00:28:51,510
is this gets to me because everyone

771
00:28:48,900 --> 00:28:53,520
seems to be like like even the like I

772
00:28:51,510 --> 00:28:55,379
love the guys who wrote the volatility

773
00:28:53,520 --> 00:28:57,090
framework wrote the book on memory

774
00:28:55,380 --> 00:29:00,570
forensics and they're super clever and

775
00:28:57,090 --> 00:29:02,220
way smarter than<font color="#E5E5E5"> me but they seem</font><font color="#CCCCCC"> to do</font>

776
00:29:00,570 --> 00:29:03,990
a lot<font color="#CCCCCC"> of there like a lot of their like</font>

777
00:29:02,220 --> 00:29:06,180
blog posts<font color="#E5E5E5"> and stuff showing how they do</font>

778
00:29:03,990 --> 00:29:08,220
stop it<font color="#E5E5E5"> seems to involve running code on</font>

779
00:29:06,180 --> 00:29:12,090
the<font color="#CCCCCC"> infected</font><font color="#E5E5E5"> host to capture the RAM and</font>

780
00:29:08,220 --> 00:29:14,310
I'm like nuts neither smart nor clever

781
00:29:12,090 --> 00:29:15,990
nor big nor funny<font color="#CCCCCC"> um you're you're going</font>

782
00:29:14,310 --> 00:29:17,220
to get<font color="#E5E5E5"> fucked someday somebody's going</font>

783
00:29:15,990 --> 00:29:20,820
<font color="#CCCCCC">to write a piece of malware designed</font>

784
00:29:17,220 --> 00:29:22,560
just to screw with you and anyone the

785
00:29:20,820 --> 00:29:25,350
audience wants<font color="#E5E5E5"> them do that feel free</font>

786
00:29:22,560 --> 00:29:28,590
<font color="#E5E5E5">and you know have loads of</font><font color="#CCCCCC"> fun of</font>

787
00:29:25,350 --> 00:29:30,149
winding people up<font color="#CCCCCC"> with it you know I</font>

788
00:29:28,590 --> 00:29:31,290
mean it's better<font color="#E5E5E5"> to lie to the process</font>

789
00:29:30,150 --> 00:29:33,540
than just kill it because if you start

790
00:29:31,290 --> 00:29:34,950
killing every random process<font color="#E5E5E5"> on the</font>

791
00:29:33,540 --> 00:29:36,570
forensic<font color="#E5E5E5"> analyst person or the</font>

792
00:29:34,950 --> 00:29:40,080
instrument sponsors versus go know why

793
00:29:36,570 --> 00:29:41,750
doesn't my tool work oh shit you know

794
00:29:40,080 --> 00:29:44,280
something weird must be<font color="#CCCCCC"> going on here</font>

795
00:29:41,750 --> 00:29:47,160
<font color="#E5E5E5">but if you just feed the nonsense</font>

796
00:29:44,280 --> 00:29:49,320
instead or instead<font color="#CCCCCC"> of just feeding it</font>

797
00:29:47,160 --> 00:29:51,420
garbage you just remove yourself from

798
00:29:49,320 --> 00:29:53,280
where it's what you're giving it so you

799
00:29:51,420 --> 00:29:55,050
just<font color="#E5E5E5"> filter yourself out of the</font><font color="#CCCCCC"> ram dump</font>

800
00:29:53,280 --> 00:29:56,490
that their tool is capturing and you

801
00:29:55,050 --> 00:29:59,730
could definitely mess with them that way

802
00:29:56,490 --> 00:30:00,960
and that'll be really fun or you<font color="#CCCCCC"> know</font>

803
00:29:59,730 --> 00:30:03,180
<font color="#E5E5E5">what if they're not running code and</font>

804
00:30:00,960 --> 00:30:05,850
<font color="#E5E5E5">host and they're doing stuff like DMA</font>

805
00:30:03,180 --> 00:30:07,470
with firewire and shit now I've read

806
00:30:05,850 --> 00:30:09,840
things that apparently you can prevent

807
00:30:07,470 --> 00:30:11,100
DMA over firewire with kernel modules

808
00:30:09,840 --> 00:30:14,570
and stuff and I've heard all this

809
00:30:11,100 --> 00:30:17,070
nonsense that<font color="#E5E5E5"> you can you know have</font>

810
00:30:14,570 --> 00:30:18,419
protections in place in software that

811
00:30:17,070 --> 00:30:19,530
will prevent hardware attacks and I

812
00:30:18,420 --> 00:30:23,090
think they're<font color="#E5E5E5"> all load of bollocks but</font>

813
00:30:19,530 --> 00:30:25,620
<font color="#E5E5E5">apparently they exist</font><font color="#CCCCCC"> but you can maybe</font>

814
00:30:23,090 --> 00:30:27,389
filter if you detect that something's

815
00:30:25,620 --> 00:30:29,070
reading if you like<font color="#CCCCCC"> just detect that</font>

816
00:30:27,390 --> 00:30:31,260
some shit has been plugged into your box

817
00:30:29,070 --> 00:30:33,090
<font color="#E5E5E5">and reading / DMA maybe you could just</font>

818
00:30:31,260 --> 00:30:36,810
start spamming shit at it<font color="#E5E5E5"> and</font>

819
00:30:33,090 --> 00:30:38,879
also filter that way somebody is an

820
00:30:36,810 --> 00:30:41,159
electrical engineer understands<font color="#E5E5E5"> very low</font>

821
00:30:38,880 --> 00:30:42,840
level stuff can probably hopefully maybe

822
00:30:41,160 --> 00:30:46,080
take me aside and explain to<font color="#E5E5E5"> me how this</font>

823
00:30:42,840 --> 00:30:48,959
shit works<font color="#CCCCCC"> I</font><font color="#E5E5E5"> have no fucking idea but</font>

824
00:30:46,080 --> 00:30:50,460
you can definitely screw with them you

825
00:30:48,960 --> 00:30:53,430
can<font color="#E5E5E5"> definitely find ways of subverting</font>

826
00:30:50,460 --> 00:30:55,530
them that way or<font color="#CCCCCC"> you can just not be a</font>

827
00:30:53,430 --> 00:30:56,820
memory and this is where<font color="#E5E5E5"> it got a bit</font>

828
00:30:55,530 --> 00:30:58,139
weird<font color="#E5E5E5"> because people said to me but</font>

829
00:30:56,820 --> 00:31:00,899
everything on your computer is in RAM

830
00:30:58,140 --> 00:31:04,050
and no it's not there's ways of not

831
00:31:00,900 --> 00:31:05,570
living in memory like treasure anyone

832
00:31:04,050 --> 00:31:07,770
<font color="#CCCCCC">here you use treasure by any chance for</font>

833
00:31:05,570 --> 00:31:10,679
hiding their encryption keys from their

834
00:31:07,770 --> 00:31:13,980
<font color="#E5E5E5">Ram nope nobody is massively paranoid</font>

835
00:31:10,680 --> 00:31:16,260
running<font color="#CCCCCC"> gentoo then I guess I've never</font>

836
00:31:13,980 --> 00:31:18,360
<font color="#E5E5E5">gotten treasure to work personally</font>

837
00:31:16,260 --> 00:31:20,010
because I didn't<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> spend weeks</font>

838
00:31:18,360 --> 00:31:22,139
recompiling my kernel and swearing

839
00:31:20,010 --> 00:31:23,700
because actually of things to do but

840
00:31:22,140 --> 00:31:25,320
some people got network<font color="#E5E5E5"> it's really</font>

841
00:31:23,700 --> 00:31:27,570
amazing because instead of having your

842
00:31:25,320 --> 00:31:29,070
disk encryption key living ram where r

843
00:31:27,570 --> 00:31:31,470
am dumping tools can get it in where

844
00:31:29,070 --> 00:31:33,689
forensics people can<font color="#E5E5E5"> get it it puts your</font>

845
00:31:31,470 --> 00:31:35,010
encryption keys in some cpu register and

846
00:31:33,690 --> 00:31:37,440
hides it there so it's not actually<font color="#CCCCCC"> in</font>

847
00:31:35,010 --> 00:31:40,050
<font color="#CCCCCC">RAM and it's like in some magic CPU land</font>

848
00:31:37,440 --> 00:31:41,730
over there and you could probably write

849
00:31:40,050 --> 00:31:43,830
malware that does the exact<font color="#CCCCCC"> same thing</font>

850
00:31:41,730 --> 00:31:46,560
<font color="#CCCCCC">that hides in a cpu registers somewhere</font>

851
00:31:43,830 --> 00:31:48,720
and you know<font color="#CCCCCC"> just goes nope not Ram over</font>

852
00:31:46,560 --> 00:31:51,450
here instead<font color="#E5E5E5"> actually and then</font><font color="#CCCCCC"> it'll</font>

853
00:31:48,720 --> 00:31:53,970
<font color="#CCCCCC">just there'll be no evidence there or</font>

854
00:31:51,450 --> 00:31:56,310
something but that's ridiculously

855
00:31:53,970 --> 00:31:57,840
complicated and I haven't figured<font color="#CCCCCC"> out</font>

856
00:31:56,310 --> 00:31:58,919
her treasure works for God's sakes I'm

857
00:31:57,840 --> 00:32:01,500
not gonna be<font color="#E5E5E5"> able to write Mallory to do</font>

858
00:31:58,920 --> 00:32:03,570
that yet but<font color="#E5E5E5"> yeah you could definitely</font>

859
00:32:01,500 --> 00:32:04,830
do that too just not live in memory and

860
00:32:03,570 --> 00:32:06,629
that would really mess with people's

861
00:32:04,830 --> 00:32:08,100
heads<font color="#E5E5E5"> because everyone just assumes that</font>

862
00:32:06,630 --> 00:32:09,960
all code running in the box is<font color="#E5E5E5"> going to</font>

863
00:32:08,100 --> 00:32:13,550
be in RAM somewhere but maybe it's not

864
00:32:09,960 --> 00:32:16,050
<font color="#E5E5E5">maybe it could do magic like that and</font>

865
00:32:13,550 --> 00:32:18,210
yeah just I guess because like it's<font color="#E5E5E5"> just</font>

866
00:32:16,050 --> 00:32:21,780
<font color="#CCCCCC">for lunch and stuff for mean if people</font>

867
00:32:18,210 --> 00:32:24,630
have questions comments abuse criticism

868
00:32:21,780 --> 00:32:26,760
more abuse or they want to<font color="#E5E5E5"> get in touch</font>

869
00:32:24,630 --> 00:32:29,160
then contact me on jabber email or

870
00:32:26,760 --> 00:32:30,690
Twitter I don't really<font color="#E5E5E5"> respond to emails</font>

871
00:32:29,160 --> 00:32:32,220
because like a thousand five hundred on

872
00:32:30,690 --> 00:32:34,650
red ones my inbox and I<font color="#E5E5E5"> just run away</font>

873
00:32:32,220 --> 00:32:36,000
from it mix emails are difficult but<font color="#E5E5E5"> ya</font>

874
00:32:34,650 --> 00:32:38,630
<font color="#E5E5E5">know you can reach me on those and stuff</font>

875
00:32:36,000 --> 00:32:42,240
from and if you want<font color="#E5E5E5"> to get in touch</font>

876
00:32:38,630 --> 00:32:43,740
yeah and also<font color="#E5E5E5"> like Thanks to everyone</font>

877
00:32:42,240 --> 00:32:47,540
who turned up to here slightly

878
00:32:43,740 --> 00:32:47,540
incoherent ranting about forensic stuff

879
00:32:55,000 --> 00:32:57,060
you

