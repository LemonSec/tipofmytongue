1
00:00:02,909 --> 00:00:09,428
hi guys well and this is dynamic effects

2
00:00:07,240 --> 00:00:11,799
for persistence they're going to show

3
00:00:09,429 --> 00:00:15,519
you something I'll start in researching

4
00:00:11,799 --> 00:00:18,130
or creating time ago a pulling different

5
00:00:15,519 --> 00:00:20,020
things from different techniques that

6
00:00:18,130 --> 00:00:24,419
people was used in or APD's they were

7
00:00:20,020 --> 00:00:27,160
using and the purpose of this is not for

8
00:00:24,420 --> 00:00:30,310
explaining how to do this it's more as a

9
00:00:27,160 --> 00:00:32,140
baseline that can be used for

10
00:00:30,310 --> 00:00:34,629
implemented on any ways that you want

11
00:00:32,140 --> 00:00:37,300
any code is called not stick so you can

12
00:00:34,629 --> 00:00:38,260
do this with anything I have a few demos

13
00:00:37,300 --> 00:00:39,730
that are going to be showing with

14
00:00:38,260 --> 00:00:41,739
PowerShell but it's just because it's

15
00:00:39,730 --> 00:00:45,718
easy to show with PowerShell but you can

16
00:00:41,739 --> 00:00:47,379
do it with anything um okay let's start

17
00:00:45,719 --> 00:00:49,420
I'm strange

18
00:00:47,379 --> 00:00:51,699
the key to consult an researcher a few

19
00:00:49,420 --> 00:00:54,399
projects a fruity Wi-Fi for this to do

20
00:00:51,699 --> 00:00:58,620
for the DNS for the proxy and one that

21
00:00:54,399 --> 00:01:04,110
is coming a related with this research

22
00:00:58,620 --> 00:01:06,670
the problem M for the retin perspective

23
00:01:04,110 --> 00:01:09,700
the blue teams are getting better on the

24
00:01:06,670 --> 00:01:12,040
tact in situ infrastructure so they are

25
00:01:09,700 --> 00:01:13,960
determined up quickly maintaining

26
00:01:12,040 --> 00:01:17,740
persistence for alum pre of science is

27
00:01:13,960 --> 00:01:20,850
getting harder distributing and managing

28
00:01:17,740 --> 00:01:22,990
multiple robots can be a challenge and

29
00:01:20,850 --> 00:01:24,850
keeping targets connected to a city to

30
00:01:22,990 --> 00:01:27,899
infrastructure trihard short video of

31
00:01:24,850 --> 00:01:30,189
stein think about that thinking about

32
00:01:27,899 --> 00:01:33,640
today they were talking about different

33
00:01:30,189 --> 00:01:35,949
red team scenarios and they were talking

34
00:01:33,640 --> 00:01:37,299
about different levels of maturity in

35
00:01:35,950 --> 00:01:40,420
their companies I am talking here a

36
00:01:37,299 --> 00:01:43,659
company that has a high maturity and

37
00:01:40,420 --> 00:01:45,549
it's not falling into a silly macro that

38
00:01:43,659 --> 00:01:48,820
is not being exactly one powerful spin

39
00:01:45,549 --> 00:01:51,609
up from there so why this we are talking

40
00:01:48,820 --> 00:01:53,139
about a stock or a company that has a

41
00:01:51,609 --> 00:01:56,890
good maturity in terms of detecting

42
00:01:53,140 --> 00:01:59,259
these am denied callbacks this is my

43
00:01:56,890 --> 00:02:00,880
proposal for this hey I mean used for

44
00:01:59,259 --> 00:02:02,950
restoring communication with the sea to

45
00:02:00,880 --> 00:02:06,520
restructure hey I brought you in

46
00:02:02,950 --> 00:02:08,199
persistence rettenmund the bad guys they

47
00:02:06,520 --> 00:02:11,829
can take advantage of these techniques

48
00:02:08,199 --> 00:02:15,040
of course the concepts that are going to

49
00:02:11,830 --> 00:02:16,040
explain em are agnostic so you can come

50
00:02:15,040 --> 00:02:18,469
in this week Python with

51
00:02:16,040 --> 00:02:21,980
our share with she shot with whatever is

52
00:02:18,469 --> 00:02:24,108
about the concept and the technique that

53
00:02:21,980 --> 00:02:28,730
I'm going to explain and not about how

54
00:02:24,109 --> 00:02:30,379
to do it okay go home you're going to

55
00:02:28,730 --> 00:02:32,450
notice when I started talking about this

56
00:02:30,379 --> 00:02:32,899
you're going to say ball but yeah we

57
00:02:32,450 --> 00:02:37,640
know that

58
00:02:32,900 --> 00:02:41,959
yes but what I did it was to give an

59
00:02:37,640 --> 00:02:44,689
extra step forward into how to use

60
00:02:41,959 --> 00:02:48,170
something that is already being used but

61
00:02:44,689 --> 00:02:49,849
how we can use it for getting a better

62
00:02:48,170 --> 00:02:52,819
position or better in communication with

63
00:02:49,849 --> 00:02:56,480
the c2 infrastructure so simple scenario

64
00:02:52,819 --> 00:02:58,939
we have a target like we have a target

65
00:02:56,480 --> 00:03:00,500
we have situ outside we have the proxy

66
00:02:58,939 --> 00:03:01,578
this is going to be everything over

67
00:03:00,500 --> 00:03:04,669
Internet so we're going to have the

68
00:03:01,579 --> 00:03:07,280
corporate proxy in the middle okay we

69
00:03:04,669 --> 00:03:10,280
send a phishing campaign we send tons of

70
00:03:07,280 --> 00:03:12,709
emails some reason they email open that

71
00:03:10,280 --> 00:03:15,200
whatever that is could be a link to be a

72
00:03:12,709 --> 00:03:16,970
macro to be anything that that that

73
00:03:15,200 --> 00:03:19,280
companies allow in to receive and to be

74
00:03:16,970 --> 00:03:21,109
executed and that is connecting with the

75
00:03:19,280 --> 00:03:23,419
way that were see to what I would have a

76
00:03:21,109 --> 00:03:28,340
connectivity but after a few minutes

77
00:03:23,419 --> 00:03:31,280
after an hour depends how fast is the

78
00:03:28,340 --> 00:03:34,729
detection on that if that is detected

79
00:03:31,280 --> 00:03:36,979
and our fishing contains the same Kodak

80
00:03:34,729 --> 00:03:38,750
sending to the same command control the

81
00:03:36,979 --> 00:03:40,340
rest of the faith defies that you

82
00:03:38,750 --> 00:03:42,949
already River they are not going to work

83
00:03:40,340 --> 00:03:45,040
if you dis work earlier the proxy forget

84
00:03:42,949 --> 00:03:47,540
it whatever work that you did whatever

85
00:03:45,040 --> 00:03:49,010
hundreds of teammates that you sent if

86
00:03:47,540 --> 00:03:51,319
you're sending the same IP you're the

87
00:03:49,010 --> 00:03:54,489
same domain for going back into the

88
00:03:51,319 --> 00:03:58,458
YouTube it's not going to work anymore

89
00:03:54,489 --> 00:04:00,949
similar scenario you have multiple IP so

90
00:03:58,459 --> 00:04:05,000
multiple domains and you're distributing

91
00:04:00,949 --> 00:04:06,530
that mail maybe between different emails

92
00:04:05,000 --> 00:04:08,989
you are sending multiple image but with

93
00:04:06,530 --> 00:04:12,019
different IPS or the same email with the

94
00:04:08,989 --> 00:04:13,909
same fellow that has four or five or ten

95
00:04:12,019 --> 00:04:15,979
eyepiece or domains that is going to

96
00:04:13,909 --> 00:04:17,389
point okay

97
00:04:15,979 --> 00:04:19,400
the first is connecting they're going to

98
00:04:17,389 --> 00:04:20,959
do they done this there is certain knows

99
00:04:19,399 --> 00:04:23,270
that what is happening so they find out

100
00:04:20,959 --> 00:04:25,279
they block that and maybe the other ones

101
00:04:23,270 --> 00:04:26,659
that you have already in your payload

102
00:04:25,279 --> 00:04:28,969
they're going to start connecting to

103
00:04:26,659 --> 00:04:29,380
other ones okay but if there's someone

104
00:04:28,969 --> 00:04:30,790
is doing

105
00:04:29,380 --> 00:04:33,040
into a pile or they are going to find

106
00:04:30,790 --> 00:04:35,260
all your callbacks you can call it como

107
00:04:33,040 --> 00:04:36,430
box or they piece where you are

108
00:04:35,260 --> 00:04:37,659
connecting or domains that you are

109
00:04:36,430 --> 00:04:41,140
connecting and they're going to start

110
00:04:37,660 --> 00:04:44,890
blocking all of them so also you're

111
00:04:41,140 --> 00:04:47,770
going to have a short life or where it's

112
00:04:44,890 --> 00:04:49,690
going to be connecting with se to I want

113
00:04:47,770 --> 00:04:51,669
to remove the proxy their shots for

114
00:04:49,690 --> 00:04:53,650
having a little bit more space on screen

115
00:04:51,670 --> 00:04:55,240
but it's going to always be there when I

116
00:04:53,650 --> 00:04:57,460
am talking that soon the communication

117
00:04:55,240 --> 00:05:00,040
out is going to be always through the

118
00:04:57,460 --> 00:05:06,250
proxy dynamic callbacks this is a story

119
00:05:00,040 --> 00:05:09,580
where Serbians okay say any situation we

120
00:05:06,250 --> 00:05:13,540
have a target we have our c2 we have

121
00:05:09,580 --> 00:05:15,370
something somewhere outside a internet

122
00:05:13,540 --> 00:05:17,100
so the rut is there but they're going to

123
00:05:15,370 --> 00:05:20,110
remove that from there what's in there

124
00:05:17,100 --> 00:05:23,620
so the idea is to do a request to that

125
00:05:20,110 --> 00:05:25,480
thing we are going to get content and

126
00:05:23,620 --> 00:05:26,980
from that content which can do different

127
00:05:25,480 --> 00:05:29,650
things depends of the level of the

128
00:05:26,980 --> 00:05:33,460
layers that we want to put there we can

129
00:05:29,650 --> 00:05:35,349
parse the call decrypt if we also added

130
00:05:33,460 --> 00:05:37,150
some kind of encryption to that content

131
00:05:35,350 --> 00:05:39,340
that we are getting so it's up to us how

132
00:05:37,150 --> 00:05:41,890
we want to run on that and then when we

133
00:05:39,340 --> 00:05:44,320
get what we need we can patch our

134
00:05:41,890 --> 00:05:46,599
payload and the payload is going to

135
00:05:44,320 --> 00:05:49,390
connect to our C to the render side body

136
00:05:46,600 --> 00:05:52,000
we already saw that way on forums or

137
00:05:49,390 --> 00:05:54,250
Twitter or getting content from another

138
00:05:52,000 --> 00:05:56,680
place yes it's something that having

139
00:05:54,250 --> 00:06:00,940
used for some time for a few weight PT

140
00:05:56,680 --> 00:06:03,610
groups but we have something else that

141
00:06:00,940 --> 00:06:06,610
we can do for not being studied for not

142
00:06:03,610 --> 00:06:08,650
going always to the same place I'm going

143
00:06:06,610 --> 00:06:10,270
to put a few reactors in the middle are

144
00:06:08,650 --> 00:06:13,120
going to have always that because I

145
00:06:10,270 --> 00:06:15,250
don't like to connect directly to my C 2

146
00:06:13,120 --> 00:06:17,650
I always put red vector for everything

147
00:06:15,250 --> 00:06:18,400
but in this case I'm going to have the

148
00:06:17,650 --> 00:06:21,039
directors there

149
00:06:18,400 --> 00:06:25,299
so my recommendation don't suppose your

150
00:06:21,040 --> 00:06:25,990
C to directly I mean ok so when that

151
00:06:25,300 --> 00:06:28,870
happened

152
00:06:25,990 --> 00:06:31,510
getting the content patchy extracting

153
00:06:28,870 --> 00:06:33,010
the IP or the main and then patch in

154
00:06:31,510 --> 00:06:34,360
your pile is going to connect one or

155
00:06:33,010 --> 00:06:37,120
ready rector's revelation is going to

156
00:06:34,360 --> 00:06:38,650
connect to the c2 if you see from the

157
00:06:37,120 --> 00:06:40,150
beginning not is going to happen a

158
00:06:38,650 --> 00:06:41,950
couple of times every time that the

159
00:06:40,150 --> 00:06:42,580
persistence we are talking here that we

160
00:06:41,950 --> 00:06:44,800
are ready

161
00:06:42,580 --> 00:06:46,090
get access into the machine so we can

162
00:06:44,800 --> 00:06:47,500
deploy the persistence if we want on

163
00:06:46,090 --> 00:06:49,270
every time that the persistence going to

164
00:06:47,500 --> 00:06:51,310
run it's going to do something different

165
00:06:49,270 --> 00:06:53,080
it's going to do the request is going to

166
00:06:51,310 --> 00:06:55,540
get something it's going to connect to

167
00:06:53,080 --> 00:06:57,669
other resurrector and every single time

168
00:06:55,540 --> 00:06:59,920
that the persistent trigger is going to

169
00:06:57,670 --> 00:07:03,580
be something new that is getting thrown

170
00:06:59,920 --> 00:07:06,130
aside and that's the trick what to do

171
00:07:03,580 --> 00:07:08,950
without how to get that information on

172
00:07:06,130 --> 00:07:11,050
how to change the information also the

173
00:07:08,950 --> 00:07:13,840
cool thing about this is if you're

174
00:07:11,050 --> 00:07:17,320
requesting content and you can change

175
00:07:13,840 --> 00:07:19,270
your IPS or in your domains because you

176
00:07:17,320 --> 00:07:21,849
have control of that if it is outside so

177
00:07:19,270 --> 00:07:25,599
the point of this is you don't need to

178
00:07:21,850 --> 00:07:27,850
heart or any IP or any domain into your

179
00:07:25,600 --> 00:07:29,920
payload dynamically you're going to get

180
00:07:27,850 --> 00:07:31,360
something from outside and that is what

181
00:07:29,920 --> 00:07:33,750
it's going to give you the content where

182
00:07:31,360 --> 00:07:36,610
the payload needs to connect that's area

183
00:07:33,750 --> 00:07:37,120
so but what's the thing that is blinged

184
00:07:36,610 --> 00:07:39,610
in there

185
00:07:37,120 --> 00:07:41,470
what that thing could be anything that

186
00:07:39,610 --> 00:07:43,720
you have controlled if you have

187
00:07:41,470 --> 00:07:46,900
something that you have control and it's

188
00:07:43,720 --> 00:07:48,580
not just a single page and put in there

189
00:07:46,900 --> 00:07:50,020
you can put whatever that you want but I

190
00:07:48,580 --> 00:07:52,330
am putting there things that they are

191
00:07:50,020 --> 00:07:54,219
commonly not belong or they are things

192
00:07:52,330 --> 00:07:56,289
that you can abuse in some way it's not

193
00:07:54,220 --> 00:07:58,900
going to be blocked so for example you

194
00:07:56,290 --> 00:08:02,110
have YouTube you have Google Google Apps

195
00:07:58,900 --> 00:08:03,609
Google search and alt of us you can

196
00:08:02,110 --> 00:08:05,950
submit oh my protein you can do the

197
00:08:03,610 --> 00:08:07,420
reference your move so you have

198
00:08:05,950 --> 00:08:11,140
different places where you can put

199
00:08:07,420 --> 00:08:13,720
content that you can a change on the fly

200
00:08:11,140 --> 00:08:15,310
any time that you want and every time

201
00:08:13,720 --> 00:08:17,910
that the persistent trigger is going to

202
00:08:15,310 --> 00:08:21,910
get the new content that you're changing

203
00:08:17,910 --> 00:08:23,610
so the story again request something to

204
00:08:21,910 --> 00:08:26,650
any of these places get the content

205
00:08:23,610 --> 00:08:28,690
extract the IP of the domain where it's

206
00:08:26,650 --> 00:08:30,700
going to connect patch in the Paleo that

207
00:08:28,690 --> 00:08:32,679
you have or also you can get in a

208
00:08:30,700 --> 00:08:35,110
metallic Velo and I'm getting the Paleo

209
00:08:32,679 --> 00:08:36,909
relic with the with the pivots again in

210
00:08:35,110 --> 00:08:38,409
this case imagine that you already have

211
00:08:36,909 --> 00:08:42,189
the file of your shaft changing where

212
00:08:38,409 --> 00:08:45,130
it's going to connect all right so an

213
00:08:42,190 --> 00:08:48,730
example request the data what you are

214
00:08:45,130 --> 00:08:52,030
requesting and in this case I am using a

215
00:08:48,730 --> 00:08:54,160
hash that is a sha-1 but you can use

216
00:08:52,030 --> 00:08:56,620
anything anything that is unique

217
00:08:54,160 --> 00:08:58,060
enough to be found so if you are doing a

218
00:08:56,620 --> 00:08:59,440
search on Google and you are searching

219
00:08:58,060 --> 00:09:03,790
for a string well a string that is

220
00:08:59,440 --> 00:09:05,500
unique enough for finding that and not

221
00:09:03,790 --> 00:09:11,019
being lost in a lot of content that you

222
00:09:05,500 --> 00:09:13,269
are getting okay so what you get in the

223
00:09:11,019 --> 00:09:15,850
return is this it's a long string nice

224
00:09:13,269 --> 00:09:17,889
in my implementation you can implement

225
00:09:15,850 --> 00:09:20,129
this in different ways of course that is

226
00:09:17,889 --> 00:09:24,399
why I was saying that it's more about

227
00:09:20,129 --> 00:09:25,870
the this as a baseline and how you

228
00:09:24,399 --> 00:09:27,550
implement that is up to you so in this

229
00:09:25,870 --> 00:09:30,699
case I have two different hashes and

230
00:09:27,550 --> 00:09:32,229
have a domain that is affect domain in

231
00:09:30,699 --> 00:09:34,569
this case in the middle so the first

232
00:09:32,230 --> 00:09:35,949
part you have a hash then you have

233
00:09:34,569 --> 00:09:37,029
something in the middle that this type

234
00:09:35,949 --> 00:09:38,829
here the domain where you're going to

235
00:09:37,029 --> 00:09:42,699
connect and then you have another hash

236
00:09:38,829 --> 00:09:45,579
why I have that well let me show you so

237
00:09:42,699 --> 00:09:47,649
they are extract the domain that is in

238
00:09:45,579 --> 00:09:51,160
the middle and I have the extra hash the

239
00:09:47,649 --> 00:09:52,569
first the part in the middle that is the

240
00:09:51,160 --> 00:09:55,779
domain is what I'm going to use for

241
00:09:52,569 --> 00:09:58,389
patching my payload so a patch of ello I

242
00:09:55,779 --> 00:10:01,600
connect cool but then I do something

243
00:09:58,389 --> 00:10:04,389
else because initially what I use it was

244
00:10:01,600 --> 00:10:06,130
the hash the first hash so what I am

245
00:10:04,389 --> 00:10:09,759
doing with this is searching for that

246
00:10:06,130 --> 00:10:11,319
somewhere matching with the first part

247
00:10:09,759 --> 00:10:13,300
that having the hash and then I I know

248
00:10:11,319 --> 00:10:16,180
what they're going to have after so what

249
00:10:13,300 --> 00:10:17,800
I am doing is ignoring that part I am

250
00:10:16,180 --> 00:10:20,500
NOT going to use that hash anymore and

251
00:10:17,800 --> 00:10:22,540
something once someone who asked me but

252
00:10:20,500 --> 00:10:24,100
you have that hash means that this they

253
00:10:22,540 --> 00:10:26,199
be know that patch is just a hash I

254
00:10:24,100 --> 00:10:28,000
grace a hash running a comma and I

255
00:10:26,199 --> 00:10:30,219
Quinta hack and that's a it is free

256
00:10:28,000 --> 00:10:31,779
creating a hash so agreat tons of caches

257
00:10:30,220 --> 00:10:34,240
and I was distributing hashes everywhere

258
00:10:31,779 --> 00:10:36,100
and so that hash I am NOT going to use a

259
00:10:34,240 --> 00:10:38,500
cash anymore and the next time that the

260
00:10:36,100 --> 00:10:40,750
persistent run is going to use the other

261
00:10:38,500 --> 00:10:43,180
hash so the further the next time that

262
00:10:40,750 --> 00:10:45,309
my persistent run it going to me to be a

263
00:10:43,180 --> 00:10:47,410
mean and new hash so if you imagine

264
00:10:45,309 --> 00:10:49,149
these every time that you are searching

265
00:10:47,410 --> 00:10:51,759
for something and you are getting the

266
00:10:49,149 --> 00:10:55,360
content you are going to get always a

267
00:10:51,759 --> 00:10:57,579
new hash and you can multiply that on

268
00:10:55,360 --> 00:10:59,889
different ways if you say that you have

269
00:10:57,579 --> 00:11:01,930
multiple places where you're going to be

270
00:10:59,889 --> 00:11:03,699
hiding this and you have multiple hashes

271
00:11:01,930 --> 00:11:05,829
much in other hashes that the hash is

272
00:11:03,699 --> 00:11:08,560
giving you another hash you can't see

273
00:11:05,830 --> 00:11:10,030
how this is difficult to follow if

274
00:11:08,560 --> 00:11:11,020
someone's eye rolling I found the first

275
00:11:10,030 --> 00:11:12,880
cash let's search

276
00:11:11,020 --> 00:11:14,530
yeah but you're searching there have the

277
00:11:12,880 --> 00:11:15,730
cash there there there there there so

278
00:11:14,530 --> 00:11:16,569
you're going to be getting different

279
00:11:15,730 --> 00:11:19,450
hashes every time

280
00:11:16,570 --> 00:11:21,880
so how do you get all it's going to be

281
00:11:19,450 --> 00:11:24,070
difficult so that is the that is the

282
00:11:21,880 --> 00:11:27,850
power of thing where you can find or

283
00:11:24,070 --> 00:11:29,680
when you can have this website any

284
00:11:27,850 --> 00:11:31,900
website it already is you can you've

285
00:11:29,680 --> 00:11:33,670
struck the data you parse you the code

286
00:11:31,900 --> 00:11:34,990
or the crib depends on the layer that

287
00:11:33,670 --> 00:11:37,540
you put there and you get the callback

288
00:11:34,990 --> 00:11:39,760
you can put that on Google Sites and u21

289
00:11:37,540 --> 00:11:42,579
Google Maps and Google Drive and I am

290
00:11:39,760 --> 00:11:44,050
NOT poking in Google people telling me

291
00:11:42,580 --> 00:11:45,550
you're using has Google for this no

292
00:11:44,050 --> 00:11:46,870
Google is giving you all these places

293
00:11:45,550 --> 00:11:49,000
for great I don't need to pay for

294
00:11:46,870 --> 00:11:51,280
everything I am just putting the data

295
00:11:49,000 --> 00:11:53,500
they are and that's it then I do the

296
00:11:51,280 --> 00:11:56,160
search on to the sides but you can use

297
00:11:53,500 --> 00:11:59,280
any site that you need you know that is

298
00:11:56,160 --> 00:12:02,140
allowed but the company that you are

299
00:11:59,280 --> 00:12:05,079
testing or doing the engagement or

300
00:12:02,140 --> 00:12:07,120
whatever you call it searches you can

301
00:12:05,080 --> 00:12:08,410
search from Google so you search on

302
00:12:07,120 --> 00:12:10,750
Google and Google is going to be the

303
00:12:08,410 --> 00:12:13,240
result I'm going to show you examples

304
00:12:10,750 --> 00:12:15,250
with all of this and github depends such

305
00:12:13,240 --> 00:12:16,710
things on github and you'd have result

306
00:12:15,250 --> 00:12:21,360
is going to give you what you want

307
00:12:16,710 --> 00:12:23,740
coming fronting Google Amazon Microsoft

308
00:12:21,360 --> 00:12:25,090
anything that is allowing you to do the

309
00:12:23,740 --> 00:12:26,860
right in front and you can combine this

310
00:12:25,090 --> 00:12:28,870
it's not just doing the one from the

311
00:12:26,860 --> 00:12:30,640
point that in this is doing domain front

312
00:12:28,870 --> 00:12:32,020
if ur going somewhere and then combining

313
00:12:30,640 --> 00:12:34,510
that with a different domain that is

314
00:12:32,020 --> 00:12:38,170
allowed are going to show you examples

315
00:12:34,510 --> 00:12:40,600
with that DNS you can have that in the

316
00:12:38,170 --> 00:12:43,120
txt record for example open your mind

317
00:12:40,600 --> 00:12:46,950
you can put this anywhere these are just

318
00:12:43,120 --> 00:12:50,500
examples but you can put there on any

319
00:12:46,950 --> 00:12:52,450
service or any site that you think okay

320
00:12:50,500 --> 00:12:56,050
I had control of that I can change that

321
00:12:52,450 --> 00:12:59,620
whenever I want and that's enough okay

322
00:12:56,050 --> 00:13:02,079
an example the first one let's see is

323
00:12:59,620 --> 00:13:05,020
here huh okay so if I do a search on

324
00:13:02,080 --> 00:13:07,270
medium are going to get a result and I

325
00:13:05,020 --> 00:13:10,390
going to extract the data and let's see

326
00:13:07,270 --> 00:13:13,020
how it looks like so if help without any

327
00:13:10,390 --> 00:13:15,310
credentials it's just normal user no

328
00:13:13,020 --> 00:13:17,319
authenticating we decide I'm going to

329
00:13:15,310 --> 00:13:19,660
search for my gosh that would be any

330
00:13:17,320 --> 00:13:23,170
string of course search for that

331
00:13:19,660 --> 00:13:24,790
and in issues in the case for be in

332
00:13:23,170 --> 00:13:28,209
other places it could be in the witness

333
00:13:24,790 --> 00:13:30,160
I got the content not they want so I get

334
00:13:28,209 --> 00:13:31,750
piece I extract remember that I

335
00:13:30,160 --> 00:13:33,219
mentioned it different parts the first

336
00:13:31,750 --> 00:13:36,100
part is a hash that they were searching

337
00:13:33,220 --> 00:13:38,350
the second part divided by pipes

338
00:13:36,100 --> 00:13:39,790
he's my domain we're going to connect

339
00:13:38,350 --> 00:13:41,399
and then I have the new trash that

340
00:13:39,790 --> 00:13:45,310
they're going to use the next time

341
00:13:41,399 --> 00:13:47,740
another example with Lowell it's

342
00:13:45,310 --> 00:13:51,250
interesting all of this for me

343
00:13:47,740 --> 00:13:54,149
interested and I sell for hash in Google

344
00:13:51,250 --> 00:13:56,230
and more is what is giving me the result

345
00:13:54,149 --> 00:13:58,209
because we will is going to be clouding

346
00:13:56,230 --> 00:14:00,220
pages and in the result that we will is

347
00:13:58,209 --> 00:14:04,060
giving you I going to have the content

348
00:14:00,220 --> 00:14:06,569
that they want so the same extract later

349
00:14:04,060 --> 00:14:10,300
twenty minutes to do let's the example

350
00:14:06,569 --> 00:14:14,740
so if you search on rule for hashes this

351
00:14:10,300 --> 00:14:17,019
is what happened it's giving me nothing

352
00:14:14,740 --> 00:14:18,819
and this is something that changed not

353
00:14:17,019 --> 00:14:20,410
long time ago few years because I'm

354
00:14:18,819 --> 00:14:21,790
certain we did few years ago and the

355
00:14:20,410 --> 00:14:23,319
first time that I was looking searching

356
00:14:21,790 --> 00:14:25,660
for sir hashes in was given in the

357
00:14:23,319 --> 00:14:27,250
result but now it's not even mayor sword

358
00:14:25,660 --> 00:14:31,060
anymore but just changing something

359
00:14:27,250 --> 00:14:33,430
let's say that it's not a hash is L so

360
00:14:31,060 --> 00:14:35,290
if I put an underscore is giving me

361
00:14:33,430 --> 00:14:38,109
something so you can see that the result

362
00:14:35,290 --> 00:14:39,969
is now there so in the description of

363
00:14:38,110 --> 00:14:42,430
the site I have the content that I want

364
00:14:39,970 --> 00:14:45,579
this one of course is not that easy to

365
00:14:42,430 --> 00:14:48,250
change you need five hours it's not very

366
00:14:45,579 --> 00:14:49,479
role but okay it's not that it's

367
00:14:48,250 --> 00:14:51,730
immediately it's not that you will

368
00:14:49,480 --> 00:14:52,990
change the side and then we will is

369
00:14:51,730 --> 00:14:54,579
going to update that in the description

370
00:14:52,990 --> 00:14:57,939
now different to take a few hours at

371
00:14:54,579 --> 00:14:59,680
least but depends what service you are

372
00:14:57,939 --> 00:15:02,199
using because also you can use whose

373
00:14:59,680 --> 00:15:05,050
stuff for searching and Google stuff so

374
00:15:02,199 --> 00:15:06,969
if I search another hash there that

375
00:15:05,050 --> 00:15:11,290
means I mean this is a rivet so you can

376
00:15:06,970 --> 00:15:13,720
see from the bank that is sites moon

377
00:15:11,290 --> 00:15:15,819
don't on and inside Google Doc Tom if

378
00:15:13,720 --> 00:15:17,769
you put content you don't need to do

379
00:15:15,819 --> 00:15:22,779
match for you to start searching into

380
00:15:17,769 --> 00:15:24,250
this you should enable inside tell you

381
00:15:22,779 --> 00:15:27,130
will just troll my page

382
00:15:24,250 --> 00:15:29,410
that's it and it takes I was when I was

383
00:15:27,130 --> 00:15:30,660
playing with this I notice that X takes

384
00:15:29,410 --> 00:15:32,520
less time

385
00:15:30,660 --> 00:15:35,459
Google to search into sites Google calm

386
00:15:32,520 --> 00:15:38,340
that to update what I have in one of my

387
00:15:35,460 --> 00:15:41,070
domains so using Google Sites combining

388
00:15:38,340 --> 00:15:43,620
we will the search is a bit faster and

389
00:15:41,070 --> 00:15:46,140
who is blocking Google right so if you

390
00:15:43,620 --> 00:15:47,970
put this for getting your dynamic

391
00:15:46,140 --> 00:15:50,130
callback that is where your payload is

392
00:15:47,970 --> 00:15:53,670
going to connect just using moon it's

393
00:15:50,130 --> 00:15:54,900
more than enough for implementing this

394
00:15:53,670 --> 00:15:58,910
functionality if you want to call it

395
00:15:54,900 --> 00:16:03,000
like that okay let's see another example

396
00:15:58,910 --> 00:16:05,430
YouTube you can put your content on

397
00:16:03,000 --> 00:16:07,320
YouTube comments or in YouTube videos

398
00:16:05,430 --> 00:16:08,699
descriptions or in different places but

399
00:16:07,320 --> 00:16:10,500
you can't use the comments at the school

400
00:16:08,700 --> 00:16:11,850
but in this case are going to use it on

401
00:16:10,500 --> 00:16:15,660
something else for showing you something

402
00:16:11,850 --> 00:16:19,230
else um I can do domain fronting with

403
00:16:15,660 --> 00:16:21,360
any Google not any almost any Google

404
00:16:19,230 --> 00:16:22,980
domain against any Google domain if I

405
00:16:21,360 --> 00:16:25,620
want to go to Google but I am saying

406
00:16:22,980 --> 00:16:26,670
that in the host header I am NOT going

407
00:16:25,620 --> 00:16:28,140
to explain the one frontier but it's

408
00:16:26,670 --> 00:16:29,880
very simple they use not request to a

409
00:16:28,140 --> 00:16:30,930
place and you say in the hospital that

410
00:16:29,880 --> 00:16:32,880
you are going to one a different place

411
00:16:30,930 --> 00:16:35,250
and if the infrastructure that you're

412
00:16:32,880 --> 00:16:37,320
hitting is allowing you to do that you

413
00:16:35,250 --> 00:16:38,730
are going to go to the site that you put

414
00:16:37,320 --> 00:16:41,430
in the cross together and know in the

415
00:16:38,730 --> 00:16:43,620
request so in this case I am using

416
00:16:41,430 --> 00:16:46,439
YouTube to go to rural sites because in

417
00:16:43,620 --> 00:16:48,600
my company Google site is blog so ok I

418
00:16:46,440 --> 00:16:51,930
can't go to rural sites but if I front

419
00:16:48,600 --> 00:16:52,980
with google.com or with youtube.com or

420
00:16:51,930 --> 00:16:55,650
with anything

421
00:16:52,980 --> 00:16:58,290
Google owns and it's allow Google Maps

422
00:16:55,650 --> 00:16:59,880
for example I can go to the site that

423
00:16:58,290 --> 00:17:01,500
they want to get the content so you can

424
00:16:59,880 --> 00:17:05,520
this is why I say that you can start

425
00:17:01,500 --> 00:17:07,349
combining things so I'm sorry you get

426
00:17:05,520 --> 00:17:10,560
the pilot you get the you know Nicole

427
00:17:07,349 --> 00:17:13,708
bag and you punch the thing an example

428
00:17:10,560 --> 00:17:15,419
we have in front in very quickly and I

429
00:17:13,709 --> 00:17:17,970
go into size we will look on what I am

430
00:17:15,420 --> 00:17:20,760
showing here that is not allowed I have

431
00:17:17,970 --> 00:17:22,439
a the venusaur pointing to my machine

432
00:17:20,760 --> 00:17:25,079
that is why it's not going out but

433
00:17:22,439 --> 00:17:27,030
simulating that this blog okay so that's

434
00:17:25,079 --> 00:17:29,010
doesn't work but let's start messing

435
00:17:27,030 --> 00:17:31,230
with this so if I go in to youtube.com

436
00:17:29,010 --> 00:17:32,010
to the same path that is my sites

437
00:17:31,230 --> 00:17:34,590
google.com

438
00:17:32,010 --> 00:17:37,350
hey it's not finding anything so I'm

439
00:17:34,590 --> 00:17:40,409
wrapping therefore searching for my

440
00:17:37,350 --> 00:17:43,230
bombing but is not finding anything ok

441
00:17:40,410 --> 00:17:44,020
hey but if I al the crossfader saying

442
00:17:43,230 --> 00:17:46,810
that I got

443
00:17:44,020 --> 00:17:49,389
to go to site google.com same as before

444
00:17:46,810 --> 00:17:51,159
but I just added the house together now

445
00:17:49,390 --> 00:17:52,870
I get the content so that is what I am

446
00:17:51,160 --> 00:17:54,610
doing with domain fronting with Google

447
00:17:52,870 --> 00:17:58,449
for example I want to go to sites of

448
00:17:54,610 --> 00:18:02,020
google.com but I am using youtube.com as

449
00:17:58,450 --> 00:18:04,030
the first special thing going to hit how

450
00:18:02,020 --> 00:18:06,670
it looks like a hint for the blue team

451
00:18:04,030 --> 00:18:11,590
and what you can do for the to detect

452
00:18:06,670 --> 00:18:14,350
domain fronting very quickly there you

453
00:18:11,590 --> 00:18:16,840
have a target it's going to do a proxy

454
00:18:14,350 --> 00:18:19,179
to a site that is allow domain data view

455
00:18:16,840 --> 00:18:21,220
its lush area so that is where I going

456
00:18:19,180 --> 00:18:22,840
to go but in the host header I have

457
00:18:21,220 --> 00:18:24,580
forbidden dot domain that is a domain up

458
00:18:22,840 --> 00:18:25,929
if I try to go directly it's not not

459
00:18:24,580 --> 00:18:27,429
going to be allowing the proxy because

460
00:18:25,930 --> 00:18:29,830
the domain is below it's not allowed

461
00:18:27,430 --> 00:18:32,230
but this combination is allowing me

462
00:18:29,830 --> 00:18:36,129
after hitting the domain fronting black

463
00:18:32,230 --> 00:18:38,320
magic it's not black magic simple then

464
00:18:36,130 --> 00:18:40,030
is hitting a forbidden but domain in the

465
00:18:38,320 --> 00:18:42,610
table that is getting the content right

466
00:18:40,030 --> 00:18:45,610
so what you can do for detecting this

467
00:18:42,610 --> 00:18:47,350
well if you have the visibility this is

468
00:18:45,610 --> 00:18:48,879
important and you check that the host

469
00:18:47,350 --> 00:18:51,070
header is different to a request well

470
00:18:48,880 --> 00:18:53,320
you can find potential domain fronting

471
00:18:51,070 --> 00:18:55,179
being used from evil why I'm saying that

472
00:18:53,320 --> 00:18:58,120
because domain fronting something is not

473
00:18:55,180 --> 00:19:01,030
evil per se it's just something that you

474
00:18:58,120 --> 00:19:04,000
can use hey but okay you can you need to

475
00:19:01,030 --> 00:19:07,330
start doing an analysis as some analysts

476
00:19:04,000 --> 00:19:11,260
sock sale and if you say okay well this

477
00:19:07,330 --> 00:19:12,820
is not normal you can detect how if it

478
00:19:11,260 --> 00:19:14,800
is being used for evil but of course

479
00:19:12,820 --> 00:19:16,870
I've mentioned about the visibility if

480
00:19:14,800 --> 00:19:18,760
you are not getting the headers if you

481
00:19:16,870 --> 00:19:21,459
are not getting the Hospitaller of this

482
00:19:18,760 --> 00:19:24,970
of that request for that it you're not

483
00:19:21,460 --> 00:19:26,800
going to know that that is happening if

484
00:19:24,970 --> 00:19:30,120
you know that and you detect that this

485
00:19:26,800 --> 00:19:34,750
evil domain fronting you can love it

486
00:19:30,120 --> 00:19:37,060
another example and DNS now some people

487
00:19:34,750 --> 00:19:39,160
always wanna mention this is still not

488
00:19:37,060 --> 00:19:42,520
home but in my company I can't we saw

489
00:19:39,160 --> 00:19:44,530
external drains okay I am NOT saying to

490
00:19:42,520 --> 00:19:46,570
resolve the domains internally what I am

491
00:19:44,530 --> 00:19:49,000
saying is well you can use a broker you

492
00:19:46,570 --> 00:19:53,530
can ask a page that is a patientís allow

493
00:19:49,000 --> 00:19:55,650
for getting the data from the dns so let

494
00:19:53,530 --> 00:19:57,430
me show you how it looks like

495
00:19:55,650 --> 00:19:58,960
and

496
00:19:57,430 --> 00:20:01,630
the common line and then I'm going to

497
00:19:58,960 --> 00:20:05,140
show you with the broker so in this case

498
00:20:01,630 --> 00:20:07,090
hey I am doing the seed up with the xwk

499
00:20:05,140 --> 00:20:10,900
that is what I get in the DXi record as

500
00:20:07,090 --> 00:20:14,860
a SPF record normal but if I change to

501
00:20:10,900 --> 00:20:17,560
the C dot one this e 1 dot deceive and

502
00:20:14,860 --> 00:20:19,330
the rest there is my content in my txt

503
00:20:17,560 --> 00:20:21,100
record and that is what I going to show

504
00:20:19,330 --> 00:20:22,629
you with the broker I cut this patient

505
00:20:21,100 --> 00:20:24,580
usually especially so open and never

506
00:20:22,630 --> 00:20:32,200
high name in programs on accessing this

507
00:20:24,580 --> 00:20:34,179
page so if I do the same searching that

508
00:20:32,200 --> 00:20:36,790
first are going to get of course the

509
00:20:34,180 --> 00:20:42,460
normal record but if I search for the

510
00:20:36,790 --> 00:20:44,320
other way so doing I get what I want and

511
00:20:42,460 --> 00:20:47,380
of course I can extract the content on

512
00:20:44,320 --> 00:20:49,300
the page and I can get the callback from

513
00:20:47,380 --> 00:20:52,180
there plus the hash that I going to use

514
00:20:49,300 --> 00:20:54,370
the next time a foe TV scene and so it

515
00:20:52,180 --> 00:20:57,550
passed part of this I thought would be

516
00:20:54,370 --> 00:20:59,800
cool to have a tool for instead of going

517
00:20:57,550 --> 00:21:01,120
to the site and put the data they are to

518
00:20:59,800 --> 00:21:03,159
have a tool that just pressing a button

519
00:21:01,120 --> 00:21:05,350
issue in understanding all the hashes to

520
00:21:03,160 --> 00:21:07,180
everywhere he did have Google and all

521
00:21:05,350 --> 00:21:08,649
the places that they have API scores for

522
00:21:07,180 --> 00:21:12,040
pushing the data so that is what I did

523
00:21:08,650 --> 00:21:13,270
and so the tool is called a fine red

524
00:21:12,040 --> 00:21:17,320
directory using internet through your

525
00:21:13,270 --> 00:21:18,940
dynamic callbacks so this is how few

526
00:21:17,320 --> 00:21:20,530
screenshots are going to release this

527
00:21:18,940 --> 00:21:22,720
soon yeah I know that I have been saying

528
00:21:20,530 --> 00:21:24,970
that for eight well amongst but I going

529
00:21:22,720 --> 00:21:27,040
to release it so so this is how it

530
00:21:24,970 --> 00:21:32,140
looked like I can't define hashes here

531
00:21:27,040 --> 00:21:34,060
is telling me and if it's in sync with

532
00:21:32,140 --> 00:21:36,010
the site because I am setting everything

533
00:21:34,060 --> 00:21:38,290
on the application and then I can press

534
00:21:36,010 --> 00:21:39,550
up about a site push underneath function

535
00:21:38,290 --> 00:21:42,129
that's who all the sites

536
00:21:39,550 --> 00:21:44,950
I mean another the screens you have a

537
00:21:42,130 --> 00:21:47,470
simulator also you can start checking if

538
00:21:44,950 --> 00:21:50,470
the logic of how the hashes are flowing

539
00:21:47,470 --> 00:21:52,270
are hitting the correct c2s that you

540
00:21:50,470 --> 00:21:55,150
have this is the dista simulation site

541
00:21:52,270 --> 00:21:58,990
not necessarily you need to have the SI

542
00:21:55,150 --> 00:22:01,450
toos responding to your fellows just our

543
00:21:58,990 --> 00:22:04,600
request is telling you if is set

544
00:22:01,450 --> 00:22:06,490
correctly and then you have a console

545
00:22:04,600 --> 00:22:08,290
that you can run a few comments from

546
00:22:06,490 --> 00:22:09,780
there also send a few emails i want to

547
00:22:08,290 --> 00:22:12,240
show you something with that

548
00:22:09,780 --> 00:22:13,649
also you can check just clicking on the

549
00:22:12,240 --> 00:22:16,290
links where it's taking you I going to

550
00:22:13,650 --> 00:22:20,600
show you a few examples so that you see

551
00:22:16,290 --> 00:22:20,600
Google I have the hatch there in Google

552
00:22:24,920 --> 00:22:36,030
these small sites this is Google Drive

553
00:22:32,610 --> 00:22:37,350
Google Drive is cool hey let me tell you

554
00:22:36,030 --> 00:22:45,030
about this one because I think is

555
00:22:37,350 --> 00:22:47,280
interesting my pulse is M Google Drive a

556
00:22:45,030 --> 00:22:50,910
people is tell me yeah and if you change

557
00:22:47,280 --> 00:22:53,100
the file in Google Drive when you change

558
00:22:50,910 --> 00:22:56,010
the file the link that you have for that

559
00:22:53,100 --> 00:22:57,780
fight is not going to be the same link

560
00:22:56,010 --> 00:22:59,820
anymore so if you access that you're not

561
00:22:57,780 --> 00:23:01,820
going to get the new content if you

562
00:22:59,820 --> 00:23:04,740
change just the description of the file

563
00:23:01,820 --> 00:23:06,720
yes you can change the description of

564
00:23:04,740 --> 00:23:09,270
the file and the link is going to be the

565
00:23:06,720 --> 00:23:12,060
same so you can keep using the same link

566
00:23:09,270 --> 00:23:15,389
but just changing the description that

567
00:23:12,060 --> 00:23:18,510
is what I am using here and using the

568
00:23:15,390 --> 00:23:20,670
description of the file you can continue

569
00:23:18,510 --> 00:23:23,070
using the same link that you create with

570
00:23:20,670 --> 00:23:25,830
a file a year ago and just you can keep

571
00:23:23,070 --> 00:23:27,540
updating the description on the file so

572
00:23:25,830 --> 00:23:37,439
you can keep modifying the data that's

573
00:23:27,540 --> 00:23:39,090
the point move maps you can create a map

574
00:23:37,440 --> 00:23:40,740
or you can put content somewhere and you

575
00:23:39,090 --> 00:23:45,000
can put the data there who's blocking

576
00:23:40,740 --> 00:23:46,620
Google Maps don't think so and then any

577
00:23:45,000 --> 00:23:49,650
side that you can use this site is cool

578
00:23:46,620 --> 00:23:52,110
right us it's a site that it's not you

579
00:23:49,650 --> 00:23:54,960
don't need to create a user you just go

580
00:23:52,110 --> 00:23:56,909
to the site and you create a content and

581
00:23:54,960 --> 00:23:58,860
you get a unique link when you can use

582
00:23:56,910 --> 00:24:00,840
that unique link and you can change the

583
00:23:58,860 --> 00:24:02,459
content and the link is the same you

584
00:24:00,840 --> 00:24:03,959
don't need to you don't need to

585
00:24:02,460 --> 00:24:06,360
distribute the new link because the link

586
00:24:03,960 --> 00:24:08,370
is the same so the path that you have is

587
00:24:06,360 --> 00:24:11,939
not going to change but you can change

588
00:24:08,370 --> 00:24:14,129
the content this is how it looks like

589
00:24:11,940 --> 00:24:16,470
the setup in fruity we see a little bit

590
00:24:14,130 --> 00:24:17,970
so you have a key could be a string I am

591
00:24:16,470 --> 00:24:18,480
using hashes but you can use whatever

592
00:24:17,970 --> 00:24:20,970
you want

593
00:24:18,480 --> 00:24:22,440
I have the decision let me call that

594
00:24:20,970 --> 00:24:24,630
where it's going to connect

595
00:24:22,440 --> 00:24:27,120
the new hash that is what is going to be

596
00:24:24,630 --> 00:24:29,460
replaced then not replace what yeah in

597
00:24:27,120 --> 00:24:31,409
the machine that is the target is the

598
00:24:29,460 --> 00:24:35,100
new hash that is going to be used on the

599
00:24:31,410 --> 00:24:37,800
next search then a wear is going to be

600
00:24:35,100 --> 00:24:39,419
for the testing purpose of trutv see but

601
00:24:37,800 --> 00:24:41,970
you can have the same hash from multiple

602
00:24:39,420 --> 00:24:44,100
places of course and you have an extra

603
00:24:41,970 --> 00:24:47,520
field because in some cases you're going

604
00:24:44,100 --> 00:24:52,169
to have a URL that instead of doing a

605
00:24:47,520 --> 00:24:53,940
search you should add an extra value in

606
00:24:52,170 --> 00:24:55,380
this case like on the ID if you are

607
00:24:53,940 --> 00:24:57,090
using Google Maps you can create a map

608
00:24:55,380 --> 00:25:00,210
that the map is going to have an IV and

609
00:24:57,090 --> 00:25:01,949
that is the URL + ID that you should

610
00:25:00,210 --> 00:25:04,710
distribute so this is a configuration

611
00:25:01,950 --> 00:25:07,830
for this is for showing you the idea

612
00:25:04,710 --> 00:25:09,810
okay so here's how I going to start

613
00:25:07,830 --> 00:25:11,189
showing you things how can be

614
00:25:09,810 --> 00:25:14,520
implemented we have this come

615
00:25:11,190 --> 00:25:16,950
implemented I have here five hushes so

616
00:25:14,520 --> 00:25:20,129
we're going to imagine that you have

617
00:25:16,950 --> 00:25:22,110
your dialog your macro your X Y or

618
00:25:20,130 --> 00:25:24,600
whatever that you have that you are

619
00:25:22,110 --> 00:25:26,639
going to distribute I put in five

620
00:25:24,600 --> 00:25:29,730
initial hashes because it's going to be

621
00:25:26,640 --> 00:25:31,650
just the first five hashes in the file

622
00:25:29,730 --> 00:25:33,240
after that all of this is going to start

623
00:25:31,650 --> 00:25:37,080
being dynamic you need to start

624
00:25:33,240 --> 00:25:39,870
somewhere so file in his initial hashes

625
00:25:37,080 --> 00:25:43,590
and as part of the parallel I also put

626
00:25:39,870 --> 00:25:45,840
different methods I call the methods the

627
00:25:43,590 --> 00:25:47,970
URLs where is the hash is going to be

628
00:25:45,840 --> 00:25:50,699
check could be a Google search could be

629
00:25:47,970 --> 00:25:53,250
the Google Sites extracting from there

630
00:25:50,700 --> 00:25:55,470
so the method is where you are going for

631
00:25:53,250 --> 00:25:58,370
checking for the hashes that's the idea

632
00:25:55,470 --> 00:26:00,780
so I'm going to show you a flow

633
00:25:58,370 --> 00:26:03,000
representation on how this payload will

634
00:26:00,780 --> 00:26:06,360
be working replacing the old hashes and

635
00:26:03,000 --> 00:26:08,460
getting the new hashes so random one

636
00:26:06,360 --> 00:26:12,270
hash random hits all the sides as soon

637
00:26:08,460 --> 00:26:13,770
as much one connects so that patch is

638
00:26:12,270 --> 00:26:15,720
not going to be anymore it's useful the

639
00:26:13,770 --> 00:26:17,700
next hash is searching for a different

640
00:26:15,720 --> 00:26:19,890
place is finding the other server and

641
00:26:17,700 --> 00:26:22,350
you understand earlier right every

642
00:26:19,890 --> 00:26:25,050
single time that you do a request that

643
00:26:22,350 --> 00:26:27,419
the persistent trigger I am proposing

644
00:26:25,050 --> 00:26:29,159
this as a persistence method and not a

645
00:26:27,420 --> 00:26:30,510
constant communication if you start

646
00:26:29,160 --> 00:26:32,220
using this at constant communication

647
00:26:30,510 --> 00:26:33,870
well not and someone is going to notice

648
00:26:32,220 --> 00:26:35,789
that something all this happening

649
00:26:33,870 --> 00:26:37,830
now the all T of this is

650
00:26:35,789 --> 00:26:41,729
use this for the persistence as soon as

651
00:26:37,830 --> 00:26:45,658
these triggers keep that channel slow on

652
00:26:41,729 --> 00:26:47,249
wired I start moving around or getting

653
00:26:45,659 --> 00:26:50,399
away from the persistent keep that

654
00:26:47,249 --> 00:26:52,139
running for example twice a day so you

655
00:26:50,399 --> 00:26:54,899
would know that you're going to keep

656
00:26:52,139 --> 00:26:57,149
communication in case that all the other

657
00:26:54,899 --> 00:26:59,369
channels that they are noisier I've been

658
00:26:57,149 --> 00:27:02,070
shut down by the Sun horizontal that's

659
00:26:59,369 --> 00:27:04,259
idea okay so are you going to show you

660
00:27:02,070 --> 00:27:07,470
something running now and I am using

661
00:27:04,259 --> 00:27:09,989
frooty frooty DC as part of the

662
00:27:07,470 --> 00:27:13,049
simulator piece just for counting the

663
00:27:09,989 --> 00:27:14,759
hits that they payload this is a real

664
00:27:13,049 --> 00:27:18,059
thing running in this place is going to

665
00:27:14,759 --> 00:27:20,849
be Python how it looks like in the

666
00:27:18,059 --> 00:27:23,428
background so the cache is the sci-fi

667
00:27:20,849 --> 00:27:25,710
caches and now randomly starts searching

668
00:27:23,429 --> 00:27:27,690
for the caches and getting a method

669
00:27:25,710 --> 00:27:29,460
checking all the methods so you're going

670
00:27:27,690 --> 00:27:31,649
to see that it's hitting different URLs

671
00:27:29,460 --> 00:27:33,389
until finds one that is matching with

672
00:27:31,649 --> 00:27:34,768
the cache so that is what it's doing and

673
00:27:33,389 --> 00:27:36,748
not this way I'm saying that if you

674
00:27:34,769 --> 00:27:39,059
start putting a lot of methods and a lot

675
00:27:36,749 --> 00:27:41,129
of crashes in your initial pile of well

676
00:27:39,059 --> 00:27:41,549
this gets crazy you don't know where

677
00:27:41,129 --> 00:27:44,789
it's going

678
00:27:41,549 --> 00:27:46,200
yeah could be if you have the cache the

679
00:27:44,789 --> 00:27:48,210
same hash distributed in different

680
00:27:46,200 --> 00:27:49,950
places depends where it's called the

681
00:27:48,210 --> 00:27:52,200
first time is going to get a different

682
00:27:49,950 --> 00:27:54,690
hash if you are using a different hash

683
00:27:52,200 --> 00:27:57,409
for the second hash on each of the

684
00:27:54,690 --> 00:28:02,269
methods if that makes sense

685
00:27:57,409 --> 00:28:07,369
that's cool right so that's the via and

686
00:28:02,269 --> 00:28:07,369
let's try the street light and words

687
00:28:08,840 --> 00:28:13,439
because also I want to show you in a

688
00:28:12,149 --> 00:28:16,349
video was a little bit difficult so

689
00:28:13,440 --> 00:28:19,080
we're going to try to do it live I'm

690
00:28:16,349 --> 00:28:21,330
going to also show you what I am how are

691
00:28:19,080 --> 00:28:23,009
you thinking that also the hash can be

692
00:28:21,330 --> 00:28:26,489
reused on the target so we're going to

693
00:28:23,009 --> 00:28:28,190
have a machine then go there I'm going

694
00:28:26,489 --> 00:28:30,809
to have a machine that is the target a

695
00:28:28,190 --> 00:28:33,749
and I'm going to have in a combination

696
00:28:30,809 --> 00:28:37,289
of fruit Elysium fruity c2 fruity c2 is

697
00:28:33,749 --> 00:28:40,169
a c2 tool that I create for it's not for

698
00:28:37,289 --> 00:28:43,590
using for enterprise to be honest is for

699
00:28:40,169 --> 00:28:46,049
researching so it's a simple you can

700
00:28:43,590 --> 00:28:47,369
modify that in any way that you want so

701
00:28:46,049 --> 00:28:49,408
it's good for research and for

702
00:28:47,369 --> 00:28:52,470
understanding how these tools work

703
00:28:49,409 --> 00:28:54,169
that is the problem was ROTC too and so

704
00:28:52,470 --> 00:28:57,929
I'm going to use free TC to of the AC to

705
00:28:54,169 --> 00:29:01,019
server and fruit PVC for showing you a

706
00:28:57,929 --> 00:29:02,639
couple of things okay I have this

707
00:29:01,019 --> 00:29:04,860
machine he machine that I sent

708
00:29:02,639 --> 00:29:06,719
he already an email someone click on the

709
00:29:04,860 --> 00:29:10,860
thing and some and now some kind of my

710
00:29:06,720 --> 00:29:12,389
work is running they are so now we're

711
00:29:10,860 --> 00:29:13,529
going to run the commands manually of

712
00:29:12,389 --> 00:29:16,168
course because I want to show you

713
00:29:13,529 --> 00:29:18,360
step-by-step what I am doing and how I

714
00:29:16,169 --> 00:29:26,129
am combining this with food we see first

715
00:29:18,360 --> 00:29:27,360
let me see if connect today and yeah

716
00:29:26,129 --> 00:29:38,389
that's okay

717
00:29:27,360 --> 00:29:41,340
let's try another one yep okay right so

718
00:29:38,389 --> 00:29:43,469
I'm going to start messing with registry

719
00:29:41,340 --> 00:29:45,840
keys because I going to show you how

720
00:29:43,470 --> 00:29:47,669
that the persistence can work there you

721
00:29:45,840 --> 00:29:49,350
can use this in different ways you can

722
00:29:47,669 --> 00:29:51,029
have a config file but you're going to

723
00:29:49,350 --> 00:29:51,870
be touching this so it's up to you how

724
00:29:51,029 --> 00:29:53,549
would you want to implement the

725
00:29:51,870 --> 00:29:55,199
persistence in this case are going to

726
00:29:53,549 --> 00:29:57,179
use pressure circuits that they are not

727
00:29:55,200 --> 00:29:58,500
common gracious turkeys the only thing

728
00:29:57,179 --> 00:30:02,429
that I want to do is to put the data

729
00:29:58,500 --> 00:30:04,470
somewhere and that's it hey I don't care

730
00:30:02,429 --> 00:30:06,330
what yes you care how you're going to

731
00:30:04,470 --> 00:30:08,610
trigger the persistence but in this case

732
00:30:06,330 --> 00:30:11,129
I going to show you how the persistent

733
00:30:08,610 --> 00:30:15,059
is getting the data or start doing this

734
00:30:11,129 --> 00:30:17,879
dynamic thing of the callbacks so let me

735
00:30:15,059 --> 00:30:20,970
show you I have a partial script here so

736
00:30:17,879 --> 00:30:23,100
I love the script that is the malware in

737
00:30:20,970 --> 00:30:25,950
this case so I have a few variables

738
00:30:23,100 --> 00:30:32,158
let's see the DC key then assuming this

739
00:30:25,950 --> 00:30:32,490
tab it you can see better that's put it

740
00:30:32,159 --> 00:30:35,429
there

741
00:30:32,490 --> 00:30:37,980
Hey okay so I have a key the the initial

742
00:30:35,429 --> 00:30:40,500
key is the you can't have multiples are

743
00:30:37,980 --> 00:30:43,789
going to do it simple for not do in amis

744
00:30:40,500 --> 00:30:47,159
and so I have a sha-1 file a show and

745
00:30:43,789 --> 00:30:48,750
hash there and also I have a method I'm

746
00:30:47,159 --> 00:30:51,090
going to use just one method but you can

747
00:30:48,750 --> 00:30:53,279
put multiple it's going to be github so

748
00:30:51,090 --> 00:30:55,980
we're going to do the searches on github

749
00:30:53,279 --> 00:30:57,419
so those are my things and now we're

750
00:30:55,980 --> 00:30:59,100
going to show you how this looks like

751
00:30:57,419 --> 00:31:01,440
without patching the pelo and then I'm

752
00:30:59,100 --> 00:31:03,570
going to patch the payload so I have

753
00:31:01,440 --> 00:31:05,309
function that is get DC that I need to

754
00:31:03,570 --> 00:31:07,370
pass two things I need to pass the

755
00:31:05,309 --> 00:31:10,049
method so the method is going to be

756
00:31:07,370 --> 00:31:12,330
called what I cut in the payroll that is

757
00:31:10,049 --> 00:31:14,158
the C method and then I'd need to pass

758
00:31:12,330 --> 00:31:16,678
the key that is the initial key that you

759
00:31:14,159 --> 00:31:17,970
want to do a search or the key that is

760
00:31:16,679 --> 00:31:20,000
getting from graciously given four

761
00:31:17,970 --> 00:31:22,620
different places for continuing this

762
00:31:20,000 --> 00:31:25,529
automatically without me doing it

763
00:31:22,620 --> 00:31:28,379
manually of course this is key so if I

764
00:31:25,529 --> 00:31:31,620
run this is doing a request and this is

765
00:31:28,379 --> 00:31:33,120
what I get I get well the request is

766
00:31:31,620 --> 00:31:36,899
this one and you can see that I added

767
00:31:33,120 --> 00:31:38,939
the hash as part of the search for the

768
00:31:36,899 --> 00:31:41,279
method but github and this is what I get

769
00:31:38,940 --> 00:31:42,330
I get the same fashion is searching

770
00:31:41,279 --> 00:31:43,620
because it's what I am using from

771
00:31:42,330 --> 00:31:45,629
imagine that I get the content that I

772
00:31:43,620 --> 00:31:49,080
want you can limit this differently of

773
00:31:45,629 --> 00:31:49,649
course I have they deceive all

774
00:31:49,080 --> 00:31:51,928
directions

775
00:31:49,649 --> 00:31:55,469
yeah in the domain and I have a new hash

776
00:31:51,929 --> 00:31:58,049
so here the three things okay cool so

777
00:31:55,470 --> 00:32:00,299
what can what can I do with this you

778
00:31:58,049 --> 00:32:01,950
need to have automatically you to put

779
00:32:00,299 --> 00:32:03,480
this somewhere right because the next

780
00:32:01,950 --> 00:32:05,610
time that the persistent is going to run

781
00:32:03,480 --> 00:32:07,080
you want to get their next hash that is

782
00:32:05,610 --> 00:32:08,610
the one that starting in four seven

783
00:32:07,080 --> 00:32:12,240
right so that is the one that we are

784
00:32:08,610 --> 00:32:14,549
going to use them next time every so

785
00:32:12,240 --> 00:32:18,169
what I am doing for that for that I own

786
00:32:14,549 --> 00:32:21,210
using a register game let me first

787
00:32:18,169 --> 00:32:24,690
initiate that I'm going to initiate the

788
00:32:21,210 --> 00:32:26,070
refugee I call a steal con so you can

789
00:32:24,690 --> 00:32:27,210
call it whatever I am putting that in

790
00:32:26,070 --> 00:32:30,809
the environment variables for the

791
00:32:27,210 --> 00:32:34,370
current user and so there we have the

792
00:32:30,809 --> 00:32:37,740
hash okay so are you going to run now

793
00:32:34,370 --> 00:32:39,678
the tale of manually not money I'm going

794
00:32:37,740 --> 00:32:42,659
to run the payload in the way that the

795
00:32:39,679 --> 00:32:44,100
macro or the XE or whatever is going to

796
00:32:42,659 --> 00:32:46,950
execute this so I have a function that

797
00:32:44,100 --> 00:32:49,830
is run me that run me what is doing is

798
00:32:46,950 --> 00:32:52,259
getting the hash from the registry key

799
00:32:49,830 --> 00:32:53,699
that I am defining somewhere and then

800
00:32:52,259 --> 00:32:56,429
doing the search and then it's going to

801
00:32:53,700 --> 00:32:58,200
update the register key with a new value

802
00:32:56,429 --> 00:33:02,309
so remember that we are starting with

803
00:32:58,200 --> 00:33:05,730
the 27 the harsh running here oh that

804
00:33:02,309 --> 00:33:08,220
one that's from this so if I run that so

805
00:33:05,730 --> 00:33:11,669
you can see here what is happening the

806
00:33:08,220 --> 00:33:14,639
initial search for the value that needs

807
00:33:11,669 --> 00:33:15,360
to use for the method is a 27 okay it's

808
00:33:14,639 --> 00:33:17,070
been a request

809
00:33:15,360 --> 00:33:19,639
is getting the content and now the

810
00:33:17,070 --> 00:33:21,240
registry key contains the second hash

811
00:33:19,640 --> 00:33:24,030
that makes sense

812
00:33:21,240 --> 00:33:26,220
let me show you what I have now in the

813
00:33:24,030 --> 00:33:28,320
register game so if I check the value in

814
00:33:26,220 --> 00:33:31,020
the register key you can see that yes

815
00:33:28,320 --> 00:33:33,389
now it's a 47 before was the 27 because

816
00:33:31,020 --> 00:33:35,160
I am using the next hash that I get from

817
00:33:33,390 --> 00:33:36,090
that request let's run it again and see

818
00:33:35,160 --> 00:33:38,190
what we get

819
00:33:36,090 --> 00:33:41,159
now it's going to start for the 47 hash

820
00:33:38,190 --> 00:33:43,320
and let's see what we get now we wait we

821
00:33:41,160 --> 00:33:47,730
get a sale of C so that is what I have

822
00:33:43,320 --> 00:33:49,409
now in the refugee so make sense I am

823
00:33:47,730 --> 00:33:52,700
doing a request I'm getting content I am

824
00:33:49,410 --> 00:33:54,929
using the part in the middle as the

825
00:33:52,700 --> 00:33:56,880
domain or IP that I going to use for

826
00:33:54,929 --> 00:33:59,309
patch to patch my pay low and then

827
00:33:56,880 --> 00:34:02,100
connect with my c2 and also the second

828
00:33:59,309 --> 00:34:04,320
hash is what I store somewhere for use

829
00:34:02,100 --> 00:34:07,049
the next time that the persistence run

830
00:34:04,320 --> 00:34:08,639
so let's now go and patch the payload

831
00:34:07,049 --> 00:34:10,530
and see if that is connecting with

832
00:34:08,639 --> 00:34:13,230
fruity c2 that they have here on top but

833
00:34:10,530 --> 00:34:15,840
also you can see it here on the side so

834
00:34:13,230 --> 00:34:17,820
we're going to change I want to run the

835
00:34:15,840 --> 00:34:21,330
same function of this run me are they

836
00:34:17,820 --> 00:34:23,639
going to a patch true it's just how we

837
00:34:21,330 --> 00:34:25,859
implement the function not much in there

838
00:34:23,639 --> 00:34:29,690
I'm just saying yeah patch the payload

839
00:34:25,859 --> 00:34:29,690
and connect that's it

840
00:34:30,440 --> 00:34:36,389
okay so what I love now is executing

841
00:34:34,350 --> 00:34:41,489
free TC to stay sure and you can see

842
00:34:36,389 --> 00:34:45,840
here now him on top so here I do unless

843
00:34:41,489 --> 00:34:47,549
for example I get content because now I

844
00:34:45,840 --> 00:34:49,889
connected to the machine without regret

845
00:34:47,550 --> 00:34:51,659
let's keep that machine there but let's

846
00:34:49,889 --> 00:34:55,619
run it again and see if we get another

847
00:34:51,659 --> 00:34:57,359
one but this time we'll see that we have

848
00:34:55,619 --> 00:35:04,200
there before so that is what needs to

849
00:34:57,359 --> 00:35:04,830
search next time let's run again boom we

850
00:35:04,200 --> 00:35:07,250
have another machine

851
00:35:04,830 --> 00:35:13,740
if I run again we have the seven eight

852
00:35:07,250 --> 00:35:14,670
supposin I know it is updating 27 boom

853
00:35:13,740 --> 00:35:16,859
we have another machine

854
00:35:14,670 --> 00:35:18,510
so that's davia right that the eyes you

855
00:35:16,859 --> 00:35:20,130
get content you patch your pile or

856
00:35:18,510 --> 00:35:22,740
dynamically for the persistence and that

857
00:35:20,130 --> 00:35:25,380
is connecting with whatever domain or IP

858
00:35:22,740 --> 00:35:26,339
that you are defining on the content

859
00:35:25,380 --> 00:35:27,960
that you have outside that you are

860
00:35:26,340 --> 00:35:32,550
getting dynamically for the

861
00:35:27,960 --> 00:35:42,560
nice I hope this makes sense um let me

862
00:35:32,550 --> 00:35:46,230
kill these machines well in stay shirts

863
00:35:42,560 --> 00:35:48,150
so we can keep this clean so we're going

864
00:35:46,230 --> 00:35:51,300
to show you the next demo but before to

865
00:35:48,150 --> 00:35:53,849
show you a next demo let me explain what

866
00:35:51,300 --> 00:36:01,020
I going to do let's go over to a

867
00:35:53,849 --> 00:36:04,260
presentation right time okay right so

868
00:36:01,020 --> 00:36:05,880
you got in male just thinking how you

869
00:36:04,260 --> 00:36:07,410
can implement this I thought okay you

870
00:36:05,880 --> 00:36:09,839
want stairs having something that is

871
00:36:07,410 --> 00:36:11,580
always running well yeah instead of

872
00:36:09,839 --> 00:36:15,480
something like the execute done doing

873
00:36:11,580 --> 00:36:17,190
the search I'm going to decide when the

874
00:36:15,480 --> 00:36:19,710
pelo is going to run instead of having

875
00:36:17,190 --> 00:36:22,910
the persistence trigger in a specific

876
00:36:19,710 --> 00:36:25,470
time are you going to send the

877
00:36:22,910 --> 00:36:27,660
information for the machine to know that

878
00:36:25,470 --> 00:36:29,368
needs to do the dynamic provides flow

879
00:36:27,660 --> 00:36:32,460
for patching the payload and then

880
00:36:29,369 --> 00:36:34,290
connecting back let's see how this is

881
00:36:32,460 --> 00:36:35,609
going to look like mappers are going to

882
00:36:34,290 --> 00:36:39,020
the road representation so I have two

883
00:36:35,609 --> 00:36:41,098
servers two directors point in 2002 I

884
00:36:39,020 --> 00:36:43,980
haven't sent me because I go in to send

885
00:36:41,099 --> 00:36:45,510
an email I send an email I already have

886
00:36:43,980 --> 00:36:47,160
come from my stuff machine right so I

887
00:36:45,510 --> 00:36:50,070
have already something on this machine

888
00:36:47,160 --> 00:36:54,750
is in an email ready is there waiting

889
00:36:50,070 --> 00:36:56,670
for my common to do the stuff so I send

890
00:36:54,750 --> 00:36:59,010
an email because I send the email the

891
00:36:56,670 --> 00:37:03,839
machine said okay cool yeah I know what

892
00:36:59,010 --> 00:37:05,490
I need to do imaginable systems sugar

893
00:37:03,839 --> 00:37:06,900
dynamic come back is getting good

894
00:37:05,490 --> 00:37:11,640
content in this guide from YouTube I

895
00:37:06,900 --> 00:37:16,099
could be anyplace touching and

896
00:37:11,640 --> 00:37:18,900
connecting let me show you the demo

897
00:37:16,099 --> 00:37:23,960
let's see that works in the same way

898
00:37:18,900 --> 00:37:23,960
then yeah that was cool okay

899
00:37:24,240 --> 00:37:29,700
I have outlook here I going to keep this

900
00:37:27,660 --> 00:37:32,640
shell open there because I going to run

901
00:37:29,700 --> 00:37:34,710
the thing that is running in the

902
00:37:32,640 --> 00:37:36,629
background manually that's the point of

903
00:37:34,710 --> 00:37:39,240
the show that's it and also to show you

904
00:37:36,630 --> 00:37:40,430
the flow of the communication and I'm

905
00:37:39,240 --> 00:37:41,490
going to use fruit to be seen

906
00:37:40,430 --> 00:37:45,330
let

907
00:37:41,490 --> 00:37:48,689
see which one of these we can send and

908
00:37:45,330 --> 00:37:53,040
increase okay here a little bit okay so

909
00:37:48,690 --> 00:37:56,700
we're going to send the key the 47 and

910
00:37:53,040 --> 00:37:58,710
that is the method to - okay so we're

911
00:37:56,700 --> 00:38:03,270
going to send this the 47 remember that

912
00:37:58,710 --> 00:38:07,440
number so if I go to the console up

913
00:38:03,270 --> 00:38:10,140
there so I show you first before doing

914
00:38:07,440 --> 00:38:12,390
that and almost forget about things

915
00:38:10,140 --> 00:38:15,660
first I'm going to run something because

916
00:38:12,390 --> 00:38:18,600
I'm going to set what I want to set for

917
00:38:15,660 --> 00:38:27,180
that persist until run so I have a

918
00:38:18,600 --> 00:38:29,130
function disco outlook rule create so

919
00:38:27,180 --> 00:38:31,770
this is going to do two things and the

920
00:38:29,130 --> 00:38:33,000
increase has a bit more days this is

921
00:38:31,770 --> 00:38:35,280
going to do two things it's going to

922
00:38:33,000 --> 00:38:37,080
create a rule in Outlook and also it's

923
00:38:35,280 --> 00:38:39,780
going to create a new folder in Outlook

924
00:38:37,080 --> 00:38:41,549
so here under deal it and you're going

925
00:38:39,780 --> 00:38:44,990
to see that a new folder is going to pop

926
00:38:41,550 --> 00:38:48,540
up create a new folder there is a folder

927
00:38:44,990 --> 00:38:51,180
and there is the rule let me show you a

928
00:38:48,540 --> 00:38:54,920
rule I don't need any privilege for this

929
00:38:51,180 --> 00:38:54,919
is the same context of the current user

930
00:38:55,790 --> 00:39:02,820
now their rule is saying a resist when

931
00:39:00,090 --> 00:39:04,950
the subject contains any of these happy

932
00:39:02,820 --> 00:39:07,980
faces the happy face on this cut head

933
00:39:04,950 --> 00:39:12,419
price it's going to move the email into

934
00:39:07,980 --> 00:39:14,970
move right so let's send an email

935
00:39:12,420 --> 00:39:17,220
I mean increase this here so you can see

936
00:39:14,970 --> 00:39:21,480
what I am sending also I going to put

937
00:39:17,220 --> 00:39:23,850
this I want to put the in the display of

938
00:39:21,480 --> 00:39:29,010
the on I look they move folder so you

939
00:39:23,850 --> 00:39:31,470
can see what the email arrives they are

940
00:39:29,010 --> 00:39:41,280
going to be fine so let's send I think

941
00:39:31,470 --> 00:39:44,339
we say to the 47 so is to send - okay so

942
00:39:41,280 --> 00:39:47,010
it's send a method hit github - starting

943
00:39:44,340 --> 00:39:48,720
with 47 key this is a subject how the

944
00:39:47,010 --> 00:39:50,700
subject looks like with the happy face

945
00:39:48,720 --> 00:39:53,250
at the beginning that then the hash the

946
00:39:50,700 --> 00:39:55,149
victim is this email this expecting

947
00:39:53,250 --> 00:39:58,150
outlook.com you can see

948
00:39:55,150 --> 00:40:02,200
the site that they mail arrived right so

949
00:39:58,150 --> 00:40:05,410
there you have the email so now let's

950
00:40:02,200 --> 00:40:07,359
run the thing that is going to execute

951
00:40:05,410 --> 00:40:08,980
the value that is they are so I really

952
00:40:07,360 --> 00:40:09,520
have something checking all the time in

953
00:40:08,980 --> 00:40:12,910
this folder

954
00:40:09,520 --> 00:40:16,110
um but let's put fruit ec2 here so you

955
00:40:12,910 --> 00:40:19,480
can see if I am connecting into that

956
00:40:16,110 --> 00:40:21,610
okay so let's put it there now you're

957
00:40:19,480 --> 00:40:24,490
going to have on this side if the

958
00:40:21,610 --> 00:40:26,410
machine is being connecting with the

959
00:40:24,490 --> 00:40:29,680
situ and you are going to see that this

960
00:40:26,410 --> 00:40:34,720
emails you want to disappear that's it

961
00:40:29,680 --> 00:40:41,109
nothing so a function of the house is

962
00:40:34,720 --> 00:40:43,470
log DC client we're going to run that he

963
00:40:41,110 --> 00:40:46,240
will be in process it removed from their

964
00:40:43,470 --> 00:40:47,890
matches check a few methods different

965
00:40:46,240 --> 00:40:50,709
methods let's see if it's one that

966
00:40:47,890 --> 00:40:51,549
matches cool yeah so is hitting the in

967
00:40:50,710 --> 00:40:53,860
good health

968
00:40:51,550 --> 00:40:56,830
dispatch in the pile out and now we have

969
00:40:53,860 --> 00:40:58,660
a machine they are connecting via situ

970
00:40:56,830 --> 00:41:01,509
with information that was extracted from

971
00:40:58,660 --> 00:41:06,569
here so if this e - n XC - that is the

972
00:41:01,510 --> 00:41:13,210
domain that is connecting right just for

973
00:41:06,570 --> 00:41:15,960
this coffee see if I get something but

974
00:41:13,210 --> 00:41:15,960
it's not the point

975
00:41:17,250 --> 00:41:24,910
yeah ok so I'm going to the machine

976
00:41:21,930 --> 00:41:27,009
right so I showed you different ways

977
00:41:24,910 --> 00:41:28,240
that you can figure this persistence I

978
00:41:27,010 --> 00:41:29,650
think the method I'm going to show you

979
00:41:28,240 --> 00:41:32,259
something else with Outlook because I

980
00:41:29,650 --> 00:41:34,540
think is fine and we have time - it's

981
00:41:32,260 --> 00:41:37,060
okay and so you can do something else

982
00:41:34,540 --> 00:41:39,130
for using that method without being that

983
00:41:37,060 --> 00:41:41,320
obvious because now you have a whole

984
00:41:39,130 --> 00:41:42,610
that that is called move and someone

985
00:41:41,320 --> 00:41:45,160
maybe is going to notice that they have

986
00:41:42,610 --> 00:41:48,280
a folder that is move on before was

987
00:41:45,160 --> 00:41:52,270
another so let's see what we can do with

988
00:41:48,280 --> 00:41:56,770
that let's keep that running I can kill

989
00:41:52,270 --> 00:42:00,450
it so you can see the difference when

990
00:41:56,770 --> 00:42:05,140
connects the new one till jobs

991
00:42:00,450 --> 00:42:07,480
right so today okay so I have another

992
00:42:05,140 --> 00:42:08,520
function before to send a new email

993
00:42:07,480 --> 00:42:12,540
because

994
00:42:08,520 --> 00:42:15,600
the persistence that is called a outlook

995
00:42:12,540 --> 00:42:17,340
hype older remembered the folder they

996
00:42:15,600 --> 00:42:25,170
are move let me zoom in this a little

997
00:42:17,340 --> 00:42:30,780
bit right move there I'm going to say

998
00:42:25,170 --> 00:42:33,060
folder hi true by folder the folder is

999
00:42:30,780 --> 00:42:35,520
not there anymore but still there I just

1000
00:42:33,060 --> 00:42:40,860
hide in the folder so if I send a new

1001
00:42:35,520 --> 00:42:46,430
email let's go back to producing so now

1002
00:42:40,860 --> 00:42:51,320
let's send I don't know for before ok

1003
00:42:46,430 --> 00:42:51,319
console and pull

1004
00:42:51,380 --> 00:42:57,090
so we sending the cache before with the

1005
00:42:55,410 --> 00:42:58,410
habit right at the beginning before so

1006
00:42:57,090 --> 00:43:01,800
that is what is going to be processing

1007
00:42:58,410 --> 00:43:03,210
bite my my were running there but you

1008
00:43:01,800 --> 00:43:06,390
don't see the hole that the core is not

1009
00:43:03,210 --> 00:43:08,490
there but still they are not is what I

1010
00:43:06,390 --> 00:43:12,629
want to show you so let's put footsie to

1011
00:43:08,490 --> 00:43:13,919
again here so that a machine is dead you

1012
00:43:12,630 --> 00:43:16,290
can see that it's not running anymore I

1013
00:43:13,920 --> 00:43:18,570
can't run anymore things there so we are

1014
00:43:16,290 --> 00:43:19,080
going to wait for a new one so let's run

1015
00:43:18,570 --> 00:43:21,720
again

1016
00:43:19,080 --> 00:43:28,410
the outlook visa client and see what

1017
00:43:21,720 --> 00:43:31,410
happened it because important part now

1018
00:43:28,410 --> 00:43:32,009
is what often you need to see fruit easy

1019
00:43:31,410 --> 00:43:36,330
to write

1020
00:43:32,010 --> 00:43:39,920
let's leave it there when that searching

1021
00:43:36,330 --> 00:43:42,540
finding the matching happy face blush

1022
00:43:39,920 --> 00:43:45,540
checking the methods it's finding github

1023
00:43:42,540 --> 00:43:50,460
it's connecting and now we have another

1024
00:43:45,540 --> 00:43:53,490
machine slowness other seed so what I

1025
00:43:50,460 --> 00:43:55,680
did it was to use the same of the folder

1026
00:43:53,490 --> 00:43:57,810
but this time I have a holder hidden so

1027
00:43:55,680 --> 00:44:01,319
it's going to be less difficult to

1028
00:43:57,810 --> 00:44:03,930
notice that using this for persistence I

1029
00:44:01,320 --> 00:44:05,790
for receiving the data instead of

1030
00:44:03,930 --> 00:44:07,710
putting nothing in registry keys that I

1031
00:44:05,790 --> 00:44:10,770
did before instead of knowing that I

1032
00:44:07,710 --> 00:44:12,210
just send emails with the data the only

1033
00:44:10,770 --> 00:44:13,680
thing that they can do for not in this

1034
00:44:12,210 --> 00:44:15,810
if they check the RULES and it's going

1035
00:44:13,680 --> 00:44:17,819
to they are going to find out that the

1036
00:44:15,810 --> 00:44:20,250
VN great but that's it if apart from

1037
00:44:17,820 --> 00:44:22,110
that the folder is not there it's not

1038
00:44:20,250 --> 00:44:24,630
this wrong

1039
00:44:22,110 --> 00:44:36,090
so that's the demo let's go back to the

1040
00:44:24,630 --> 00:44:37,530
presentation okay this is the same demo

1041
00:44:36,090 --> 00:44:39,600
as downloads so I'm not going to show

1042
00:44:37,530 --> 00:44:43,050
you a video it was just incredible work

1043
00:44:39,600 --> 00:44:44,490
a lateral movement and persistence okay

1044
00:44:43,050 --> 00:44:46,800
you're going to be six more about

1045
00:44:44,490 --> 00:44:49,709
recommendations and how to use this is

1046
00:44:46,800 --> 00:44:52,550
not for showing your demo but we can

1047
00:44:49,710 --> 00:44:55,260
talk we can mix a little bit here how

1048
00:44:52,550 --> 00:44:56,910
how we can use this as a lateral

1049
00:44:55,260 --> 00:45:01,040
movement and persistence are being quiet

1050
00:44:56,910 --> 00:45:03,420
on how to move into a more noisy Channel

1051
00:45:01,040 --> 00:45:04,980
so okay let's say that we have machine

1052
00:45:03,420 --> 00:45:08,130
that we compromised that this is machine

1053
00:45:04,980 --> 00:45:09,600
we have that we compromise or we move

1054
00:45:08,130 --> 00:45:11,220
laterally right because not necessarily

1055
00:45:09,600 --> 00:45:12,270
needs to be the first machine that you

1056
00:45:11,220 --> 00:45:13,859
are compromising maybe you are

1057
00:45:12,270 --> 00:45:15,360
compromising the network you are being

1058
00:45:13,860 --> 00:45:17,160
super noisy they are going to know that

1059
00:45:15,360 --> 00:45:18,900
you are there maybe you have 20 minutes

1060
00:45:17,160 --> 00:45:20,490
you already have credentials so you can

1061
00:45:18,900 --> 00:45:23,880
start moving around so if you are quiet

1062
00:45:20,490 --> 00:45:25,439
enough or moving around a I hope another

1063
00:45:23,880 --> 00:45:27,210
cop another cop you can put the

1064
00:45:25,440 --> 00:45:29,760
persistently with the air let's say okay

1065
00:45:27,210 --> 00:45:31,890
tomorrow is going to run every Monday is

1066
00:45:29,760 --> 00:45:33,750
every Monday could be every Monday could

1067
00:45:31,890 --> 00:45:36,359
be every day go believe and agree any

1068
00:45:33,750 --> 00:45:37,740
time a certain time the persistent

1069
00:45:36,360 --> 00:45:39,450
method is going to run it's going to

1070
00:45:37,740 --> 00:45:41,160
have the dynamic callbacks that's the

1071
00:45:39,450 --> 00:45:42,660
point of this it's going to search for

1072
00:45:41,160 --> 00:45:45,660
information Internet's you want to get

1073
00:45:42,660 --> 00:45:48,839
the new domain or IP and it's going to

1074
00:45:45,660 --> 00:45:51,270
connect to that persistency to but that

1075
00:45:48,840 --> 00:45:53,940
persistence is you let's keep it slow

1076
00:45:51,270 --> 00:45:57,120
super slow so that communication could

1077
00:45:53,940 --> 00:45:58,710
be low low or just wanna hit until you

1078
00:45:57,120 --> 00:46:00,359
do what you want maybe the only thing

1079
00:45:58,710 --> 00:46:01,590
that you want to do is to be sure that

1080
00:46:00,360 --> 00:46:03,540
you have a machine that is connecting

1081
00:46:01,590 --> 00:46:04,920
out and as soon as connecting as you

1082
00:46:03,540 --> 00:46:06,509
know that you have the persistence you

1083
00:46:04,920 --> 00:46:08,670
can kill the channel hit the channel

1084
00:46:06,510 --> 00:46:11,180
kill the channel so the machine is not

1085
00:46:08,670 --> 00:46:13,350
going to be doing request to your situ

1086
00:46:11,180 --> 00:46:15,120
and just wait for the persistent

1087
00:46:13,350 --> 00:46:16,770
tutorial again in case of your losing

1088
00:46:15,120 --> 00:46:18,299
communication on another channel so what

1089
00:46:16,770 --> 00:46:20,880
are the other channels well from that

1090
00:46:18,300 --> 00:46:23,400
persistence channel that it slow slow

1091
00:46:20,880 --> 00:46:25,110
slow you can start moving around you can

1092
00:46:23,400 --> 00:46:27,210
get into network and jump into other

1093
00:46:25,110 --> 00:46:29,160
machines and from a place that you are

1094
00:46:27,210 --> 00:46:31,020
far away from that initial machine that

1095
00:46:29,160 --> 00:46:32,940
helper persistence you can start

1096
00:46:31,020 --> 00:46:36,000
triggering other channels to other

1097
00:46:32,940 --> 00:46:38,760
reactors to other cities keeping

1098
00:46:36,000 --> 00:46:41,730
at sea too persistent very low in terms

1099
00:46:38,760 --> 00:46:43,230
of noise with the enemy Kovacs so keep

1100
00:46:41,730 --> 00:46:45,990
this channel like this just for

1101
00:46:43,230 --> 00:46:48,900
persistence and then do your noise in

1102
00:46:45,990 --> 00:46:51,000
other places so you can trigger multiple

1103
00:46:48,900 --> 00:46:53,190
machines against multiple radio actors

1104
00:46:51,000 --> 00:46:54,990
so you do all the mess there you do all

1105
00:46:53,190 --> 00:46:56,700
the noise they are if you lose channels

1106
00:46:54,990 --> 00:46:58,350
you can spin up in your channels you can

1107
00:46:56,700 --> 00:46:59,520
do that from the persistent channel you

1108
00:46:58,350 --> 00:47:01,650
can do that from the channels that you

1109
00:46:59,520 --> 00:47:04,140
have do the noise they are keep the

1110
00:47:01,650 --> 00:47:06,510
persistence honest I'll don't you start

1111
00:47:04,140 --> 00:47:09,270
my channel is that you needed so that is

1112
00:47:06,510 --> 00:47:11,010
the purpose of my proposal this is using

1113
00:47:09,270 --> 00:47:12,390
this for persistence and not for

1114
00:47:11,010 --> 00:47:16,200
constant communication you can use it

1115
00:47:12,390 --> 00:47:19,589
for constant communication but my idea

1116
00:47:16,200 --> 00:47:23,040
for this is for persistence and also you

1117
00:47:19,590 --> 00:47:24,870
can open other channels to the same you

1118
00:47:23,040 --> 00:47:27,180
can have multiple machines doing this

1119
00:47:24,870 --> 00:47:29,069
per system Network very slowly on

1120
00:47:27,180 --> 00:47:31,140
different times using different methods

1121
00:47:29,070 --> 00:47:32,840
maybe you can you are using on this

1122
00:47:31,140 --> 00:47:35,370
machine one method for power system

1123
00:47:32,840 --> 00:47:37,260
scheduled tasks and this one yours and

1124
00:47:35,370 --> 00:47:39,330
services on another one your reason the

1125
00:47:37,260 --> 00:47:42,630
outlook thing so you can distribute that

1126
00:47:39,330 --> 00:47:44,700
in different ways and you can do that

1127
00:47:42,630 --> 00:47:46,590
with different methods the one that you

1128
00:47:44,700 --> 00:47:48,960
are using one schedule tasks maybe one

1129
00:47:46,590 --> 00:47:50,550
to use Google staff and the one that you

1130
00:47:48,960 --> 00:47:53,040
are using with outlook is going to you

1131
00:47:50,550 --> 00:47:56,460
interviews domain fronting for example

1132
00:47:53,040 --> 00:47:59,490
so you can make this in any way that you

1133
00:47:56,460 --> 00:48:01,680
want okay so I have a few

1134
00:47:59,490 --> 00:48:03,569
recommendations they have general

1135
00:48:01,680 --> 00:48:07,319
recommendations is not mainly about

1136
00:48:03,570 --> 00:48:12,930
these is how you can detect these

1137
00:48:07,320 --> 00:48:15,660
detecting the dynamic callbacks I can

1138
00:48:12,930 --> 00:48:17,819
say that is difficult because if you are

1139
00:48:15,660 --> 00:48:21,569
saying that you are using only Google

1140
00:48:17,820 --> 00:48:24,290
searches for distributing your data it's

1141
00:48:21,570 --> 00:48:27,060
going to be very difficult to find in

1142
00:48:24,290 --> 00:48:28,200
the proxy level right so if you know

1143
00:48:27,060 --> 00:48:32,000
that something in front of the machine

1144
00:48:28,200 --> 00:48:35,220
because you have a something like well

1145
00:48:32,000 --> 00:48:37,710
any year that the school one is finding

1146
00:48:35,220 --> 00:48:40,560
that something is running wearily not

1147
00:48:37,710 --> 00:48:42,510
normally well name is going to detect

1148
00:48:40,560 --> 00:48:44,430
the execution but not what you are doing

1149
00:48:42,510 --> 00:48:45,580
intent communication because doing a

1150
00:48:44,430 --> 00:48:47,680
search on rule

1151
00:48:45,580 --> 00:48:49,900
it's not going to be strange at all and

1152
00:48:47,680 --> 00:48:54,180
so that's the idea of recommendations

1153
00:48:49,900 --> 00:48:54,180
and for the red team

1154
00:48:54,190 --> 00:48:58,630
prepared you're particularly an tactics

1155
00:48:56,410 --> 00:49:01,270
in advance for example don't buy that -

1156
00:48:58,630 --> 00:49:03,160
the week before or the day before that

1157
00:49:01,270 --> 00:49:06,310
going to use it because they are going

1158
00:49:03,160 --> 00:49:09,660
to notice that you have a - very young

1159
00:49:06,310 --> 00:49:11,650
or certificate that is very young and

1160
00:49:09,660 --> 00:49:13,810
circulate infrastructure and team

1161
00:49:11,650 --> 00:49:16,780
members based on functional roles so

1162
00:49:13,810 --> 00:49:18,880
it's cool to distribute that between

1163
00:49:16,780 --> 00:49:20,620
different spectator and people in being

1164
00:49:18,880 --> 00:49:22,330
in charge of something maybe someone is

1165
00:49:20,620 --> 00:49:23,799
going to be convened charge of the

1166
00:49:22,330 --> 00:49:26,740
persistence just being sure that the

1167
00:49:23,800 --> 00:49:28,780
persistence is running used to redirect

1168
00:49:26,740 --> 00:49:31,689
or between targets and your back-end or

1169
00:49:28,780 --> 00:49:34,170
anything or DNS for what servers for the

1170
00:49:31,690 --> 00:49:39,730
SMTP is for anything don't expose

1171
00:49:34,170 --> 00:49:41,620
directly your infrastructure keep

1172
00:49:39,730 --> 00:49:43,150
infrastructure on persistent and noisy

1173
00:49:41,620 --> 00:49:45,910
infrastructure away from each other

1174
00:49:43,150 --> 00:49:47,530
don't use the same server doesn't make

1175
00:49:45,910 --> 00:49:49,299
any sense because you simple system one

1176
00:49:47,530 --> 00:49:51,760
server or domain and you're using the

1177
00:49:49,300 --> 00:49:53,490
same for the noisy retractor whoa we are

1178
00:49:51,760 --> 00:49:55,960
not doing it right

1179
00:49:53,490 --> 00:49:57,549
don't reuse exposed infrastructure for

1180
00:49:55,960 --> 00:50:00,640
persistence so if you know that they are

1181
00:49:57,550 --> 00:50:01,930
they got your persistence burn

1182
00:50:00,640 --> 00:50:04,000
everything and start from scratch

1183
00:50:01,930 --> 00:50:06,250
because they can use the fingerprint up

1184
00:50:04,000 --> 00:50:07,960
top machine for finding the new servers

1185
00:50:06,250 --> 00:50:09,960
if you have an image then you are using

1186
00:50:07,960 --> 00:50:12,010
that image for creating the same server

1187
00:50:09,960 --> 00:50:14,020
it's going to look the same it's going

1188
00:50:12,010 --> 00:50:15,190
to be they're going to be able to find

1189
00:50:14,020 --> 00:50:17,080
out if we are using show them they are

1190
00:50:15,190 --> 00:50:21,280
searching for that they're going to see

1191
00:50:17,080 --> 00:50:22,990
that it's the same use domains that they

1192
00:50:21,280 --> 00:50:24,280
are relevant to your operation and check

1193
00:50:22,990 --> 00:50:28,930
the healthiness don't use of the main

1194
00:50:24,280 --> 00:50:30,850
that is highlighted of smiler if that is

1195
00:50:28,930 --> 00:50:33,549
her purpose is fine right if you want to

1196
00:50:30,850 --> 00:50:35,710
be starting it's not going to work do

1197
00:50:33,550 --> 00:50:38,050
not use code or default parameter that

1198
00:50:35,710 --> 00:50:40,300
can be exposed your operation it for

1199
00:50:38,050 --> 00:50:42,160
example the manual profile ish things

1200
00:50:40,300 --> 00:50:43,930
that all the different stitches have

1201
00:50:42,160 --> 00:50:45,759
their own implementation they're cool

1202
00:50:43,930 --> 00:50:47,169
but don't use the default because it

1203
00:50:45,760 --> 00:50:50,560
default probably they are being

1204
00:50:47,170 --> 00:50:51,820
monitored change methods of persistent

1205
00:50:50,560 --> 00:50:53,890
between targets that is what I was

1206
00:50:51,820 --> 00:50:57,200
saying about user services with one

1207
00:50:53,890 --> 00:51:01,150
method at with a few competitors you say

1208
00:50:57,200 --> 00:51:03,970
scheduled us with other methods and

1209
00:51:01,150 --> 00:51:06,619
don't use your enemy call that method

1210
00:51:03,970 --> 00:51:09,169
and change the patterns between the

1211
00:51:06,619 --> 00:51:11,030
Peloso for example not don't use the

1212
00:51:09,170 --> 00:51:13,460
same happy face accepting and using

1213
00:51:11,030 --> 00:51:15,740
change that and you can implement

1214
00:51:13,460 --> 00:51:19,460
different ways the dynamic callback

1215
00:51:15,740 --> 00:51:20,930
thing for different machines so instead

1216
00:51:19,460 --> 00:51:22,640
of using the pipes in the middle so you

1217
00:51:20,930 --> 00:51:24,348
can have more hashes maybe it's not just

1218
00:51:22,640 --> 00:51:25,759
a shot one hash at the end maybe there

1219
00:51:24,349 --> 00:51:29,240
are multiple caches at the end so that

1220
00:51:25,760 --> 00:51:30,470
could be more difficult or more dynamic

1221
00:51:29,240 --> 00:51:33,109
in the way that is taking different

1222
00:51:30,470 --> 00:51:36,109
routes a few recommendations for the

1223
00:51:33,109 --> 00:51:38,000
blue team don't allow internet some land

1224
00:51:36,109 --> 00:51:39,799
access without solution uh BBN to the

1225
00:51:38,000 --> 00:51:41,270
corporate network so in that way you can

1226
00:51:39,799 --> 00:51:42,859
see what is happening in the proxy if

1227
00:51:41,270 --> 00:51:45,710
you're allowing the machines to connect

1228
00:51:42,859 --> 00:51:47,990
to internet on the home network

1229
00:51:45,710 --> 00:51:49,220
well maybe the malware is checking that

1230
00:51:47,990 --> 00:51:50,990
it's not in the corporate net one it's

1231
00:51:49,220 --> 00:51:53,058
not going to do anything when it's there

1232
00:51:50,990 --> 00:51:55,308
and it's going to wait to be outside of

1233
00:51:53,059 --> 00:51:56,869
the network every single external

1234
00:51:55,309 --> 00:51:58,460
communication from the cooperate input

1235
00:51:56,869 --> 00:52:02,180
should pass through the corporate proxy

1236
00:51:58,460 --> 00:52:03,859
same a compare the web request with the

1237
00:52:02,180 --> 00:52:07,520
cross header so in that way you can find

1238
00:52:03,859 --> 00:52:09,348
a domain fronting you need to expect the

1239
00:52:07,520 --> 00:52:11,420
SSL traffic because if not yeah not

1240
00:52:09,349 --> 00:52:12,890
going to see the controller increase

1241
00:52:11,420 --> 00:52:15,470
logging disability or whatever that you

1242
00:52:12,890 --> 00:52:16,879
have connected into a network you need

1243
00:52:15,470 --> 00:52:17,930
to do review of those Lots if you are

1244
00:52:16,880 --> 00:52:20,809
collecting logs and you are not doing

1245
00:52:17,930 --> 00:52:24,078
anything with that why you're collecting

1246
00:52:20,809 --> 00:52:26,000
love implement exchange machine learning

1247
00:52:24,079 --> 00:52:30,290
SuperDuper endpoints on network

1248
00:52:26,000 --> 00:52:32,359
protection is not only be there for

1249
00:52:30,290 --> 00:52:36,440
whole project a red team and blue team

1250
00:52:32,359 --> 00:52:38,839
exercises this is cool for knowing how

1251
00:52:36,440 --> 00:52:41,359
strong is your security on your defense

1252
00:52:38,839 --> 00:52:43,670
and also school for training the people

1253
00:52:41,359 --> 00:52:46,250
that is in charge of that so doing

1254
00:52:43,670 --> 00:52:50,809
constant let the red team to get in and

1255
00:52:46,250 --> 00:52:52,460
do things don't stop them here is won't

1256
00:52:50,809 --> 00:52:57,140
stop them if you are finding them but

1257
00:52:52,460 --> 00:53:00,109
the data point cyber threat modeling

1258
00:52:57,140 --> 00:53:02,540
teams and Intel teams and they are cool

1259
00:53:00,109 --> 00:53:05,619
for increasing the knowledge of the

1260
00:53:02,540 --> 00:53:08,270
defense and how to increase the security

1261
00:53:05,619 --> 00:53:09,200
and they're hunting teams also they are

1262
00:53:08,270 --> 00:53:11,930
tool for finding

1263
00:53:09,200 --> 00:53:15,439
this kind of weird things that they are

1264
00:53:11,930 --> 00:53:20,990
not the normal type of my words that you

1265
00:53:15,440 --> 00:53:25,060
can be getting so that's it thanks

1266
00:53:20,990 --> 00:53:25,060
[Applause]

