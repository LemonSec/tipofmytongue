1
00:00:13,080 --> 00:00:17,070
so we have the last conference of this

2
00:00:15,240 --> 00:00:20,100
second day of the fourth edition of the

3
00:00:17,070 --> 00:00:22,860
european cybersecurity challenge with a

4
00:00:20,100 --> 00:00:24,240
very nice guy he's from Barcelona his

5
00:00:22,860 --> 00:00:30,439
name is Mark Rivero

6
00:00:24,240 --> 00:00:34,290
he is also an expert in security

7
00:00:30,439 --> 00:00:37,200
research and he's focused on malware and

8
00:00:34,290 --> 00:00:39,149
also in threat intelligence so please

9
00:00:37,200 --> 00:00:41,940
give a big applause for him the title of

10
00:00:39,149 --> 00:00:44,610
the conference's rapid response to

11
00:00:41,940 --> 00:00:47,218
incidents interesting he is the last one

12
00:00:44,610 --> 00:00:50,930
of this fourth edition so let's enjoy

13
00:00:47,219 --> 00:00:50,930
with Mark Rivero

14
00:00:52,250 --> 00:00:56,619
[Applause]

15
00:00:58,760 --> 00:01:10,200
all yours mark and we'll see you in 45

16
00:01:01,949 --> 00:01:12,690
minutes more or less ciao okay thank you

17
00:01:10,200 --> 00:01:15,330
to attend the conference I know it's a

18
00:01:12,690 --> 00:01:18,929
lot confidence in the afternoon so I

19
00:01:15,330 --> 00:01:20,009
know maybe the people is retarded so

20
00:01:18,930 --> 00:01:23,730
don't worry about that

21
00:01:20,010 --> 00:01:26,730
they D of the the competencies show some

22
00:01:23,730 --> 00:01:29,730
tips on methods to the incident response

23
00:01:26,730 --> 00:01:33,510
I don't know if many people in the room

24
00:01:29,730 --> 00:01:35,340
is aware about incident response and you

25
00:01:33,510 --> 00:01:38,940
know which methods and skill sets are

26
00:01:35,340 --> 00:01:41,100
necessary to perform investigations and

27
00:01:38,940 --> 00:01:46,259
the intern responds in big companies and

28
00:01:41,100 --> 00:01:48,570
struck so fast from you know data about

29
00:01:46,260 --> 00:01:51,660
which are the people behind names then

30
00:01:48,570 --> 00:01:54,899
on where which are the malicious pieces

31
00:01:51,660 --> 00:01:57,390
involved it and so on so the D is I will

32
00:01:54,900 --> 00:02:00,030
not talk about about investigations I

33
00:01:57,390 --> 00:02:03,180
window I will not talk about many tools

34
00:02:00,030 --> 00:02:05,670
the VA is give some tips and some

35
00:02:03,180 --> 00:02:10,229
methods on easy matters about how to how

36
00:02:05,670 --> 00:02:14,300
to get easily some data or tone or to

37
00:02:10,229 --> 00:02:18,780
arrive so fast to conclusions about

38
00:02:14,300 --> 00:02:20,790
which data is very important about a lot

39
00:02:18,780 --> 00:02:23,730
of data you can have in the insulin

40
00:02:20,790 --> 00:02:25,829
response so let me present myself a bit

41
00:02:23,730 --> 00:02:26,790
my name is Mari vero I'm coming from

42
00:02:25,830 --> 00:02:29,969
Barcelona

43
00:02:26,790 --> 00:02:32,400
and I'm focusing in my analysis on that

44
00:02:29,969 --> 00:02:35,670
intelligence I have some background as

45
00:02:32,400 --> 00:02:38,790
well in in the crime and also in instant

46
00:02:35,670 --> 00:02:41,640
response I was involved in in a big

47
00:02:38,790 --> 00:02:45,810
global incident response team in US

48
00:02:41,640 --> 00:02:48,238
company and and the idea is in this US

49
00:02:45,810 --> 00:02:51,090
company it was inside the global team

50
00:02:48,239 --> 00:02:53,400
with a lot of people working with me and

51
00:02:51,090 --> 00:02:58,590
it changed some data what investigations

52
00:02:53,400 --> 00:03:00,859
and this was a place and I I learned a

53
00:02:58,590 --> 00:03:04,439
lot about what is an incident response

54
00:03:00,859 --> 00:03:07,470
what what is a rarity important it's so

55
00:03:04,439 --> 00:03:09,900
different because I I come from from the

56
00:03:07,470 --> 00:03:11,609
forensics area before starting the

57
00:03:09,900 --> 00:03:14,849
company and it's so different

58
00:03:11,609 --> 00:03:16,109
half a frenzy profile and and B and the

59
00:03:14,849 --> 00:03:20,040
at the end and you see and response

60
00:03:16,109 --> 00:03:22,049
consultant well if we talk about

61
00:03:20,040 --> 00:03:25,260
Incident Response we need to talk about

62
00:03:22,049 --> 00:03:29,189
malware because at the end of the day

63
00:03:25,260 --> 00:03:31,280
all the investigations probably will we

64
00:03:29,189 --> 00:03:34,680
will find some model inside the network

65
00:03:31,280 --> 00:03:37,909
if we if we take some cases from from

66
00:03:34,680 --> 00:03:42,900
years ago we have some bad guys using

67
00:03:37,909 --> 00:03:46,019
hacking tools like hand map kinetics SQL

68
00:03:42,900 --> 00:03:48,090
map and other tools to to gain to gain

69
00:03:46,019 --> 00:03:50,489
the first access inside the inside the

70
00:03:48,090 --> 00:03:52,829
foreign Network and when the people is

71
00:03:50,489 --> 00:03:56,010
inside they probably will start to jump

72
00:03:52,829 --> 00:03:57,930
inside the inside the inside the company

73
00:03:56,010 --> 00:04:01,590
jumping over the different servers and

74
00:03:57,930 --> 00:04:04,979
infecting or using custom tools to gain

75
00:04:01,590 --> 00:04:07,109
some revelation to capture some username

76
00:04:04,979 --> 00:04:09,689
and passwords another another data

77
00:04:07,109 --> 00:04:13,019
inside the network and some of these

78
00:04:09,689 --> 00:04:14,668
pieces some of these pieces of of tools

79
00:04:13,019 --> 00:04:17,099
that they will use they are probably

80
00:04:14,669 --> 00:04:20,310
malware or they created custom custom

81
00:04:17,099 --> 00:04:21,719
malware for for the for the for the you

82
00:04:20,310 --> 00:04:25,530
know for the threat men and they are

83
00:04:21,720 --> 00:04:27,539
their cars into the to the company if we

84
00:04:25,530 --> 00:04:30,539
talk about incident response we have

85
00:04:27,539 --> 00:04:33,180
some all the people that started to

86
00:04:30,539 --> 00:04:35,370
study in C and responsibly

87
00:04:33,180 --> 00:04:38,580
are aware about this this graph this

88
00:04:35,370 --> 00:04:40,070
graph is from from a research and

89
00:04:38,580 --> 00:04:42,530
academic paper the

90
00:04:40,070 --> 00:04:45,920
talks about insulin response and inside

91
00:04:42,530 --> 00:04:48,260
this inside this diagram we can see all

92
00:04:45,920 --> 00:04:50,450
the different steps inside an insulin

93
00:04:48,260 --> 00:04:55,159
response investigation so let's talk

94
00:04:50,450 --> 00:05:00,229
about my my daily my daily day on the US

95
00:04:55,160 --> 00:05:03,350
company I was in home you know seeing my

96
00:05:00,230 --> 00:05:06,190
email seen you know which which are the

97
00:05:03,350 --> 00:05:10,070
the stuff that you need to do today and

98
00:05:06,190 --> 00:05:11,810
I got an email from from some people in

99
00:05:10,070 --> 00:05:15,290
another country and say hey we have an

100
00:05:11,810 --> 00:05:17,750
incident and we need you in 24 or 48

101
00:05:15,290 --> 00:05:20,690
hours here in place and this place could

102
00:05:17,750 --> 00:05:23,570
be any place inside a me and so it could

103
00:05:20,690 --> 00:05:25,969
be any stuff in Europe in South Africa

104
00:05:23,570 --> 00:05:28,520
and Saudi Arabia and don't matter where

105
00:05:25,970 --> 00:05:30,650
are you based from so you need to be so

106
00:05:28,520 --> 00:05:32,630
near in an airport and to take the plane

107
00:05:30,650 --> 00:05:35,030
and go to the go to the to the foreign

108
00:05:32,630 --> 00:05:38,000
country and analyze the incident so in

109
00:05:35,030 --> 00:05:40,489
that case I was in home and I started to

110
00:05:38,000 --> 00:05:43,430
speak with the customer and and asked

111
00:05:40,490 --> 00:05:45,500
him hey what happened it tell me tell me

112
00:05:43,430 --> 00:05:48,590
tell me a bit about the situation and

113
00:05:45,500 --> 00:05:50,900
the customer told me the stuff that he

114
00:05:48,590 --> 00:05:53,150
he thought is happening his company

115
00:05:50,900 --> 00:05:55,880
records he have any idea about what is

116
00:05:53,150 --> 00:05:57,500
happening normally because if they they

117
00:05:55,880 --> 00:05:59,900
know what is happening why they meet us

118
00:05:57,500 --> 00:06:03,970
so that does the question that I they

119
00:05:59,900 --> 00:06:06,380
always did myself and the idea is I

120
00:06:03,970 --> 00:06:08,630
changed some stuff with the with the

121
00:06:06,380 --> 00:06:10,159
customers in the past and they they are

122
00:06:08,630 --> 00:06:11,840
pretty aware about what is happening

123
00:06:10,160 --> 00:06:13,730
they know that they have an incident

124
00:06:11,840 --> 00:06:15,260
they don't know which machines can be

125
00:06:13,730 --> 00:06:20,150
infected they don't know if the people

126
00:06:15,260 --> 00:06:24,230
is inside already or the yard or the bad

127
00:06:20,150 --> 00:06:28,010
guys just Internet got information and

128
00:06:24,230 --> 00:06:31,370
they are outside so the idea is and my

129
00:06:28,010 --> 00:06:33,170
and one of the principal jobs of the of

130
00:06:31,370 --> 00:06:36,140
the incident response consultant is know

131
00:06:33,170 --> 00:06:39,110
what did we which is the situation know

132
00:06:36,140 --> 00:06:41,030
the people is inside and in the alien

133
00:06:39,110 --> 00:06:43,730
side try to be tried to try to

134
00:06:41,030 --> 00:06:45,770
investigate or to discover which were

135
00:06:43,730 --> 00:06:48,080
the back doors or or the different

136
00:06:45,770 --> 00:06:52,280
entrance are they they got and and try

137
00:06:48,080 --> 00:06:54,180
to stop them using security policies

138
00:06:52,280 --> 00:06:57,270
like apply

139
00:06:54,180 --> 00:07:00,840
net were rules or or other other type of

140
00:06:57,270 --> 00:07:05,310
of blocks inside the inside the company

141
00:07:00,840 --> 00:07:07,260
and and after that we can start to to to

142
00:07:05,310 --> 00:07:10,080
more or less see how many machines are

143
00:07:07,260 --> 00:07:13,590
uninfected so the idea is before before

144
00:07:10,080 --> 00:07:15,930
travel to the company is necessary to to

145
00:07:13,590 --> 00:07:19,200
get your around tools and your own tools

146
00:07:15,930 --> 00:07:22,100
could be different devices to to clone

147
00:07:19,200 --> 00:07:24,390
harddrive different hard is to copy

148
00:07:22,100 --> 00:07:27,240
different image that you can acquire

149
00:07:24,390 --> 00:07:28,890
inside inside the company your laptop of

150
00:07:27,240 --> 00:07:30,470
course don't forget your laptop some

151
00:07:28,890 --> 00:07:33,539
people arrived arrived it to the company

152
00:07:30,470 --> 00:07:35,940
to the foreign country and they forgot a

153
00:07:33,540 --> 00:07:37,770
laptop in his house so please don't

154
00:07:35,940 --> 00:07:41,070
forget the laptops we your main tool to

155
00:07:37,770 --> 00:07:43,320
to investigate the incident and and also

156
00:07:41,070 --> 00:07:46,800
a part of the hardware devices you need

157
00:07:43,320 --> 00:07:49,590
to to have your second backup in the

158
00:07:46,800 --> 00:07:52,590
team I mean you can you you can do or

159
00:07:49,590 --> 00:07:55,289
it's not a recommendation to investigate

160
00:07:52,590 --> 00:07:58,109
an incident alone because as many as

161
00:07:55,290 --> 00:08:00,830
many brains on the investigations more

162
00:07:58,110 --> 00:08:03,110
more you know more information or more

163
00:08:00,830 --> 00:08:05,010
advices they can give you the people

164
00:08:03,110 --> 00:08:07,350
normally in the incident response team

165
00:08:05,010 --> 00:08:10,500
have different skill set we can have

166
00:08:07,350 --> 00:08:12,480
inside the team one guy that is folk you

167
00:08:10,500 --> 00:08:15,360
sit on the worst engineer and other

168
00:08:12,480 --> 00:08:18,030
people is come from the police and he

169
00:08:15,360 --> 00:08:20,430
saw would you know investigating the

170
00:08:18,030 --> 00:08:22,979
case speaking with the people trying to

171
00:08:20,430 --> 00:08:27,300
right conclusions and other people could

172
00:08:22,980 --> 00:08:29,670
be so good in you in IT administration

173
00:08:27,300 --> 00:08:32,220
and they can you know get evidence so

174
00:08:29,670 --> 00:08:34,409
fast in the if the Nepalese Windows

175
00:08:32,220 --> 00:08:36,210
Network or the people could be so good

176
00:08:34,409 --> 00:08:37,110
in the UNIX area so depending on your

177
00:08:36,210 --> 00:08:41,340
skill set

178
00:08:37,110 --> 00:08:43,530
it's probably a good advice a change you

179
00:08:41,340 --> 00:08:45,150
know which data you found and it's same

180
00:08:43,530 --> 00:08:47,520
with your team and your team can help

181
00:08:45,150 --> 00:08:51,569
you okay so don't don't analyze any case

182
00:08:47,520 --> 00:08:54,120
alone the idea after the after you know

183
00:08:51,570 --> 00:08:55,890
get your toes and being caught up with

184
00:08:54,120 --> 00:08:58,140
the team its rightful account to take to

185
00:08:55,890 --> 00:08:59,490
the foreign country to the company and I

186
00:08:58,140 --> 00:09:02,220
start to speak with the different people

187
00:08:59,490 --> 00:09:04,140
involved in the company so let's go to a

188
00:09:02,220 --> 00:09:07,170
speak with the IT department let's go to

189
00:09:04,140 --> 00:09:08,310
to ask a what's happening tell me a bit

190
00:09:07,170 --> 00:09:11,400
about the situation

191
00:09:08,310 --> 00:09:13,949
because if we have a company that have a

192
00:09:11,400 --> 00:09:16,709
lot of teams inside and the company's so

193
00:09:13,950 --> 00:09:18,660
weak they probably have the ITA area

194
00:09:16,710 --> 00:09:21,270
divided in different in different teams

195
00:09:18,660 --> 00:09:23,819
so we have we can have the the people

196
00:09:21,270 --> 00:09:26,010
that is administered in administration

197
00:09:23,820 --> 00:09:27,990
on the operating systems and the people

198
00:09:26,010 --> 00:09:31,650
from the network could be other people

199
00:09:27,990 --> 00:09:33,570
and all the people these teams always

200
00:09:31,650 --> 00:09:36,060
hate the security area inside the

201
00:09:33,570 --> 00:09:37,830
company because they they you know they

202
00:09:36,060 --> 00:09:40,160
they don't want the security area and

203
00:09:37,830 --> 00:09:43,440
the company don't want to allow to have

204
00:09:40,160 --> 00:09:45,780
you know not a strong polity policy

205
00:09:43,440 --> 00:09:48,540
supplied inside the companies so into

206
00:09:45,780 --> 00:09:51,300
you need to do a bit you want to say the

207
00:09:48,540 --> 00:09:54,930
the what psychologist is inside the

208
00:09:51,300 --> 00:09:57,240
company and try to to be free and of all

209
00:09:54,930 --> 00:09:59,609
the people and and then don't them say

210
00:09:57,240 --> 00:10:00,960
anything bad any anything bad about what

211
00:09:59,610 --> 00:10:03,420
the other people inside inside the

212
00:10:00,960 --> 00:10:05,880
inside the same company so then you have

213
00:10:03,420 --> 00:10:08,459
to restrict with the people and try to

214
00:10:05,880 --> 00:10:10,950
arrive to some conclusions itself about

215
00:10:08,460 --> 00:10:12,150
what is what happened in the company you

216
00:10:10,950 --> 00:10:14,940
need to start to colleague to colleague

217
00:10:12,150 --> 00:10:17,640
date and for do that you need to apply

218
00:10:14,940 --> 00:10:20,640
some tools that we will cover during the

219
00:10:17,640 --> 00:10:25,020
talk during the talk and some fast fast

220
00:10:20,640 --> 00:10:29,790
ways to to get some fast conclusions to

221
00:10:25,020 --> 00:10:31,500
to get you know o to possibly have some

222
00:10:29,790 --> 00:10:34,079
you know some clue at the end of the way

223
00:10:31,500 --> 00:10:35,940
to arrive to a final conclusion that

224
00:10:34,080 --> 00:10:38,100
says hey you need to talk quite

225
00:10:35,940 --> 00:10:40,170
physically this this device so we need

226
00:10:38,100 --> 00:10:42,570
to to reverse engineer this malware or

227
00:10:40,170 --> 00:10:44,400
whatever unit you need to do after after

228
00:10:42,570 --> 00:10:46,680
make the investigation and analyze a

229
00:10:44,400 --> 00:10:49,949
date and so on we need to create the

230
00:10:46,680 --> 00:10:52,140
report and this probably the the the

231
00:10:49,950 --> 00:10:54,120
worst part in front of the other

232
00:10:52,140 --> 00:10:56,550
technical people what is so important to

233
00:10:54,120 --> 00:10:58,350
document properly not only the final

234
00:10:56,550 --> 00:11:00,449
report about the conclusions are about

235
00:10:58,350 --> 00:11:02,010
all the all the find is that you that

236
00:11:00,450 --> 00:11:04,710
you that your heart in your

237
00:11:02,010 --> 00:11:09,300
investigation but also you need to to

238
00:11:04,710 --> 00:11:10,890
write a daily report that you also will

239
00:11:09,300 --> 00:11:12,449
will change will it change that with

240
00:11:10,890 --> 00:11:15,660
with the custom and on the customer you

241
00:11:12,450 --> 00:11:18,060
can see which which steps you did every

242
00:11:15,660 --> 00:11:19,740
day in the in the company which

243
00:11:18,060 --> 00:11:21,569
investigation which conclusions you

244
00:11:19,740 --> 00:11:22,950
arrive at and the customer

245
00:11:21,570 --> 00:11:25,410
that knows perfectly the environment

246
00:11:22,950 --> 00:11:27,590
probably better than you because he's a

247
00:11:25,410 --> 00:11:31,949
madman it's not your home which his home

248
00:11:27,590 --> 00:11:34,350
they probably know much better which

249
00:11:31,950 --> 00:11:37,980
machines which have the machines at the

250
00:11:34,350 --> 00:11:41,220
company or who is the best main contact

251
00:11:37,980 --> 00:11:43,200
to get access to to at all or resources

252
00:11:41,220 --> 00:11:46,170
at the company so it's it's so important

253
00:11:43,200 --> 00:11:48,420
be in constant communication with the

254
00:11:46,170 --> 00:11:52,410
customer at changing which data you

255
00:11:48,420 --> 00:11:55,050
found in engine investigation if you

256
00:11:52,410 --> 00:11:57,959
know how to do an easy enterprise

257
00:11:55,050 --> 00:12:01,140
incident response you will love this

258
00:11:57,960 --> 00:12:03,960
this job it's it's a woody you what you

259
00:12:01,140 --> 00:12:06,840
love travel and you you love know people

260
00:12:03,960 --> 00:12:08,850
and you know being in other places all

261
00:12:06,840 --> 00:12:12,840
the all the with this probably is your

262
00:12:08,850 --> 00:12:16,410
you've decided you decided job okay so

263
00:12:12,840 --> 00:12:18,390
let's go to the situation on RAF I

264
00:12:16,410 --> 00:12:21,480
arrived to the company and the customers

265
00:12:18,390 --> 00:12:23,670
and I asked the customer a can you give

266
00:12:21,480 --> 00:12:27,180
me some locks about the last three

267
00:12:23,670 --> 00:12:29,040
months I want to see frame three months

268
00:12:27,180 --> 00:12:31,500
before the incident what happened in the

269
00:12:29,040 --> 00:12:34,709
company and the customer that they

270
00:12:31,500 --> 00:12:36,930
probably don't know which locks is the

271
00:12:34,710 --> 00:12:38,910
lock that contains the the useful

272
00:12:36,930 --> 00:12:42,300
information they probably will give you

273
00:12:38,910 --> 00:12:45,150
a folder with I don't know a few

274
00:12:42,300 --> 00:12:47,310
gigabytes or or also internal

275
00:12:45,150 --> 00:12:50,970
investigations I had one terabyte of

276
00:12:47,310 --> 00:12:53,520
route text of locks to analyze and you

277
00:12:50,970 --> 00:12:56,850
don't know the pain that is to to get

278
00:12:53,520 --> 00:12:59,880
some conclusion and you can't you know

279
00:12:56,850 --> 00:13:04,230
investigate that do doing simple grabs

280
00:12:59,880 --> 00:13:07,110
or or cut or a ABW car inside the lock

281
00:13:04,230 --> 00:13:08,910
so you need to use other other tools and

282
00:13:07,110 --> 00:13:13,860
the idea is that you are familiar with

283
00:13:08,910 --> 00:13:16,260
some of them so depending on the of the

284
00:13:13,860 --> 00:13:19,170
case you probably will have some

285
00:13:16,260 --> 00:13:24,960
multiple input locks and you can find

286
00:13:19,170 --> 00:13:26,729
lots about you know a kinetics scannings

287
00:13:24,960 --> 00:13:28,080
on the on the web servers you can have

288
00:13:26,730 --> 00:13:31,080
Metasploit

289
00:13:28,080 --> 00:13:34,590
even locks inside inside windows you can

290
00:13:31,080 --> 00:13:35,170
have any Maps fingerprinting inside the

291
00:13:34,590 --> 00:13:37,180
diff

292
00:13:35,170 --> 00:13:39,910
computers and firewalls he says the

293
00:13:37,180 --> 00:13:42,370
company you can see some PowerShell

294
00:13:39,910 --> 00:13:45,579
executions inside the network because

295
00:13:42,370 --> 00:13:48,160
all the people love use PowerShell every

296
00:13:45,579 --> 00:13:49,870
day and the idea is you need to to

297
00:13:48,160 --> 00:13:51,850
correlate this information because the

298
00:13:49,870 --> 00:13:55,269
attackers they probably will use some

299
00:13:51,850 --> 00:13:57,040
web hacking tools to to exploit the

300
00:13:55,269 --> 00:14:00,850
remote server they will use some

301
00:13:57,040 --> 00:14:03,069
PowerShell to do you know a lateral

302
00:14:00,850 --> 00:14:05,889
movement inside the company they

303
00:14:03,070 --> 00:14:08,410
probably use nmap inside and outside the

304
00:14:05,889 --> 00:14:11,860
company to know which ports are open it

305
00:14:08,410 --> 00:14:14,889
to outside they will use other other

306
00:14:11,860 --> 00:14:16,570
tools to to gain access so or two to get

307
00:14:14,889 --> 00:14:18,339
privileged like mini cards or other

308
00:14:16,570 --> 00:14:20,350
tools so the idea is you need to

309
00:14:18,339 --> 00:14:23,380
correlate this information and it'll

310
00:14:20,350 --> 00:14:27,250
make any sense to analyze all of these

311
00:14:23,380 --> 00:14:29,769
locks in a separate way so the idea is I

312
00:14:27,250 --> 00:14:32,440
I put this an example is probably not

313
00:14:29,769 --> 00:14:34,240
the the the tool that the tool that all

314
00:14:32,440 --> 00:14:36,670
the Incident Response consultants use

315
00:14:34,240 --> 00:14:39,490
but it's a tool that I use it in the

316
00:14:36,670 --> 00:14:41,529
past and it I think is useful you need

317
00:14:39,490 --> 00:14:43,949
to analyze a lot of locks and you can

318
00:14:41,529 --> 00:14:46,000
have you know correlations another

319
00:14:43,949 --> 00:14:49,329
enrichment data as well with with

320
00:14:46,000 --> 00:14:52,360
elasticsearch loss station and qivana

321
00:14:49,329 --> 00:14:54,910
for the visualization so let's take this

322
00:14:52,360 --> 00:14:58,690
example we have different input sources

323
00:14:54,910 --> 00:15:01,689
and in my case I have some lock stock

324
00:14:58,690 --> 00:15:04,060
configuration that are able to pass all

325
00:15:01,690 --> 00:15:05,890
of this information and the idea is you

326
00:15:04,060 --> 00:15:08,290
need to prepare this before

327
00:15:05,890 --> 00:15:10,240
go to the incidence of it neither even

328
00:15:08,290 --> 00:15:14,560
make any sense to start to create some

329
00:15:10,240 --> 00:15:16,390
Parcells as we know you find a custom

330
00:15:14,560 --> 00:15:19,390
block you need to get the person in the

331
00:15:16,390 --> 00:15:22,860
same moment but a parser for MySQL a

332
00:15:19,390 --> 00:15:26,500
parser for for a kinetics a parser for

333
00:15:22,860 --> 00:15:29,529
for any map a parser for information

334
00:15:26,500 --> 00:15:30,699
server as a parser for Apache you need

335
00:15:29,529 --> 00:15:33,279
to create all of these all of these

336
00:15:30,699 --> 00:15:34,779
passes before the mechanisms to spend

337
00:15:33,279 --> 00:15:37,540
the time in the investigation

338
00:15:34,779 --> 00:15:41,610
getting the parses so the idea is you

339
00:15:37,540 --> 00:15:44,589
have all multiple input sources you you

340
00:15:41,610 --> 00:15:46,690
you analyze or your parts this

341
00:15:44,589 --> 00:15:48,550
information will of touch the law state

342
00:15:46,690 --> 00:15:49,030
sends our need this information in

343
00:15:48,550 --> 00:15:51,609
elastics

344
00:15:49,030 --> 00:15:54,160
earth and you later you ski wanna to

345
00:15:51,610 --> 00:15:54,850
show the results the ID I wouldn't with

346
00:15:54,160 --> 00:15:57,490
elasticsearch

347
00:15:54,850 --> 00:15:59,950
you can integrate some third-party tools

348
00:15:57,490 --> 00:16:02,890
like bite of total or other other other

349
00:15:59,950 --> 00:16:04,870
vendors to to enrich the data we found

350
00:16:02,890 --> 00:16:07,270
on IP you can check with virustotal

351
00:16:04,870 --> 00:16:09,820
the relator hashes the malicious urls

352
00:16:07,270 --> 00:16:11,770
another another set information that

353
00:16:09,820 --> 00:16:13,570
could be useful for for your

354
00:16:11,770 --> 00:16:15,610
investigation imagine that your phone on

355
00:16:13,570 --> 00:16:18,490
IP that is related with a common hack

356
00:16:15,610 --> 00:16:20,050
into hacking group and because you

357
00:16:18,490 --> 00:16:24,040
studied this hacking groups you know

358
00:16:20,050 --> 00:16:26,530
that next steps will be compromised the

359
00:16:24,040 --> 00:16:29,189
different active directories or or I

360
00:16:26,530 --> 00:16:32,560
don't know maybe start to get

361
00:16:29,190 --> 00:16:35,110
confidential data from the from the high

362
00:16:32,560 --> 00:16:37,900
people like BP people inside the company

363
00:16:35,110 --> 00:16:39,970
so depending depending on the of the

364
00:16:37,900 --> 00:16:42,880
motivations and the under groups behind

365
00:16:39,970 --> 00:16:44,880
behind attack you can identify them

366
00:16:42,880 --> 00:16:47,710
based on the patterns that you found

367
00:16:44,880 --> 00:16:49,990
inside the locks you probably are are

368
00:16:47,710 --> 00:16:51,880
pretty pretty near to to get a

369
00:16:49,990 --> 00:16:54,430
conclusion and the next step that you

370
00:16:51,880 --> 00:16:54,850
need to do to stop these these these bad

371
00:16:54,430 --> 00:16:59,979
people

372
00:16:54,850 --> 00:17:02,890
so the idea after after paths all of

373
00:16:59,980 --> 00:17:05,890
this information and and and get the

374
00:17:02,890 --> 00:17:07,480
contestant information and and you have

375
00:17:05,890 --> 00:17:09,910
all the information in the same place

376
00:17:07,480 --> 00:17:12,880
correlated with different input sources

377
00:17:09,910 --> 00:17:15,400
and Cavanaugh's it's it's a good

378
00:17:12,880 --> 00:17:17,950
visualization tool that can help you to

379
00:17:15,400 --> 00:17:22,060
to have an eagle eye I love this word

380
00:17:17,950 --> 00:17:25,660
Eli you can easily you know with with a

381
00:17:22,060 --> 00:17:27,849
simple mouse I start to filter for four

382
00:17:25,660 --> 00:17:31,360
different time frames I remember a case

383
00:17:27,849 --> 00:17:33,280
when I when I when I have when I had a

384
00:17:31,360 --> 00:17:37,080
forensic investigation in the past and

385
00:17:33,280 --> 00:17:42,250
and one friend of mine we exported the

386
00:17:37,080 --> 00:17:44,409
ALS directory of hard drive and he index

387
00:17:42,250 --> 00:17:47,740
at on elasticsearch and with the time

388
00:17:44,410 --> 00:17:50,200
frame he ought to the around the date of

389
00:17:47,740 --> 00:17:53,170
the incident and he attracted the witch

390
00:17:50,200 --> 00:17:55,630
world you know the the the incident

391
00:17:53,170 --> 00:17:57,799
which will be the duration of all white

392
00:17:55,630 --> 00:18:00,440
the guys what the guys

393
00:17:57,799 --> 00:18:02,210
you know compromise at this this which

394
00:18:00,440 --> 00:18:05,239
servant and and I want to say with that

395
00:18:02,210 --> 00:18:07,820
that that with qivana you can easily

396
00:18:05,239 --> 00:18:09,889
filter and you don't need to work in the

397
00:18:07,820 --> 00:18:11,480
visualization part and you can correlate

398
00:18:09,889 --> 00:18:13,580
the information it is the most

399
00:18:11,480 --> 00:18:15,739
interesting interesting area and you can

400
00:18:13,580 --> 00:18:17,509
create that world for for your for your

401
00:18:15,739 --> 00:18:19,639
team and your team can collaborate and

402
00:18:17,509 --> 00:18:22,340
apply queries and you can extract some

403
00:18:19,639 --> 00:18:27,049
some intelligence from from this from

404
00:18:22,340 --> 00:18:29,689
this - Wars after you have the logs you

405
00:18:27,049 --> 00:18:31,850
probably you are in the in the forensics

406
00:18:29,690 --> 00:18:34,309
part and you need to acquire some data

407
00:18:31,850 --> 00:18:36,139
from the from the different servers you

408
00:18:34,309 --> 00:18:38,570
probably will need to analyze some

409
00:18:36,139 --> 00:18:40,609
memory dumps and the idea is you have a

410
00:18:38,570 --> 00:18:43,428
lot of memory dams that you need to to

411
00:18:40,609 --> 00:18:46,009
easily get the contestant information

412
00:18:43,429 --> 00:18:48,529
and you need to know if the machine is

413
00:18:46,009 --> 00:18:51,710
compromised it or not is instead of

414
00:18:48,529 --> 00:18:54,889
spending time doing some super hacking

415
00:18:51,710 --> 00:18:57,350
stuff and and be super cool try

416
00:18:54,889 --> 00:19:00,519
internalize the memory use volatility

417
00:18:57,350 --> 00:19:03,469
recall or other tools - - that I always

418
00:19:00,519 --> 00:19:05,840
in the training that I did in the past I

419
00:19:03,470 --> 00:19:07,669
show the people how to easily know if

420
00:19:05,840 --> 00:19:10,730
the machine is compromised it or not and

421
00:19:07,669 --> 00:19:12,679
you don't need to send any any sample to

422
00:19:10,730 --> 00:19:14,899
virustotal because at the end if it's a

423
00:19:12,679 --> 00:19:15,980
private investigation don't send the

424
00:19:14,899 --> 00:19:17,600
samples to virustotal

425
00:19:15,980 --> 00:19:19,879
or other third parties because if not

426
00:19:17,600 --> 00:19:22,730
the customer the customer will kill you

427
00:19:19,879 --> 00:19:24,859
so the idea the idea is you need to know

428
00:19:22,730 --> 00:19:27,080
if the machine is compromised or not you

429
00:19:24,859 --> 00:19:29,330
can easily do that just done a scanning

430
00:19:27,080 --> 00:19:31,100
on the process and in the in the in the

431
00:19:29,330 --> 00:19:34,158
memory dam dumping all the passes in the

432
00:19:31,100 --> 00:19:35,809
machine getting the file fingerprinting

433
00:19:34,159 --> 00:19:37,789
starting the highest value of these

434
00:19:35,809 --> 00:19:40,519
files and checking with third parties

435
00:19:37,789 --> 00:19:41,749
tools like - total but just as can you

436
00:19:40,519 --> 00:19:43,999
know it's checking the hash you don't

437
00:19:41,749 --> 00:19:45,559
need to send a sample - virus totally

438
00:19:43,999 --> 00:19:47,659
the sample isn't known to bite of total

439
00:19:45,559 --> 00:19:48,559
at the moment is good for you and the

440
00:19:47,659 --> 00:19:50,690
sample is malicious

441
00:19:48,559 --> 00:19:53,239
package by by the total or other tools

442
00:19:50,690 --> 00:19:55,070
is good for you as well because you have

443
00:19:53,239 --> 00:19:58,429
contextual information so the idea is

444
00:19:55,070 --> 00:19:59,779
try to get as much fast information that

445
00:19:58,429 --> 00:20:02,539
you need and you don't need to spend

446
00:19:59,779 --> 00:20:04,460
hours and hours using volatility and

447
00:20:02,539 --> 00:20:08,299
recall to extract information from

448
00:20:04,460 --> 00:20:10,100
memory Dom you can you need to go to the

449
00:20:08,299 --> 00:20:11,660
to the information that you need on this

450
00:20:10,100 --> 00:20:13,040
moment and you need to know in

451
00:20:11,660 --> 00:20:15,080
in my case and with this with this

452
00:20:13,040 --> 00:20:19,399
example if the machine is compromised it

453
00:20:15,080 --> 00:20:22,040
or not with our with a malware tool with

454
00:20:19,400 --> 00:20:25,160
with with this simple one-liner and you

455
00:20:22,040 --> 00:20:27,860
can see is so easy is simple for command

456
00:20:25,160 --> 00:20:30,770
that struck the md5 of the files in the

457
00:20:27,860 --> 00:20:31,429
in the in one folder and with with an

458
00:20:30,770 --> 00:20:34,520
edge grip

459
00:20:31,430 --> 00:20:37,430
check check the results on by omilos

460
00:20:34,520 --> 00:20:39,710
total and you can use the free api key

461
00:20:37,430 --> 00:20:42,080
you don't need to spend a lot of money

462
00:20:39,710 --> 00:20:44,180
in the in the premium if we I apply here

463
00:20:42,080 --> 00:20:47,270
you can come if your company don't not

464
00:20:44,180 --> 00:20:49,550
have that possibility so the idea is you

465
00:20:47,270 --> 00:20:51,650
need you need to know only if the sample

466
00:20:49,550 --> 00:20:54,020
is it's malicious or not you can set by

467
00:20:51,650 --> 00:20:56,000
the total heart analysis or other tools

468
00:20:54,020 --> 00:21:00,950
to know the in the sample was submitted

469
00:20:56,000 --> 00:21:03,740
by someone before after you speak this

470
00:21:00,950 --> 00:21:06,200
part I want to show some some example

471
00:21:03,740 --> 00:21:09,740
about some special methods you see by

472
00:21:06,200 --> 00:21:12,440
malware and this probably it's quite old

473
00:21:09,740 --> 00:21:16,160
but could be a good example if the

474
00:21:12,440 --> 00:21:19,100
people are not aware about that so these

475
00:21:16,160 --> 00:21:21,950
are some and I want to put in Vault

476
00:21:19,100 --> 00:21:24,409
these words some of the methods used by

477
00:21:21,950 --> 00:21:26,810
the malware to evade automatic analysis

478
00:21:24,410 --> 00:21:29,210
and and you know try to difficult the

479
00:21:26,810 --> 00:21:32,659
analyst to get to some contextual

480
00:21:29,210 --> 00:21:36,140
information so you can see how the huh

481
00:21:32,660 --> 00:21:40,370
for example we have a campaign that come

482
00:21:36,140 --> 00:21:43,220
from server and this server malware had

483
00:21:40,370 --> 00:21:46,280
a campaign in the past that uses an

484
00:21:43,220 --> 00:21:48,250
office file with a password and we know

485
00:21:46,280 --> 00:21:52,149
that some of the vendors in the market

486
00:21:48,250 --> 00:21:55,400
say that they can they can analyze

487
00:21:52,150 --> 00:21:58,280
malware files inside the emails and they

488
00:21:55,400 --> 00:22:01,910
can or you can automate send files to

489
00:21:58,280 --> 00:22:03,800
these systems and and they can analyze

490
00:22:01,910 --> 00:22:06,800
the file and and get a different

491
00:22:03,800 --> 00:22:08,980
indicator of a compromise and the VIS

492
00:22:06,800 --> 00:22:11,300
and the people behind behind server

493
00:22:08,980 --> 00:22:13,190
server ram somewhere i started to use

494
00:22:11,300 --> 00:22:15,230
this method because they know that these

495
00:22:13,190 --> 00:22:18,050
tools exist because they are they're not

496
00:22:15,230 --> 00:22:20,480
stupid people of course so they know

497
00:22:18,050 --> 00:22:23,210
that the you know the companies are

498
00:22:20,480 --> 00:22:25,380
applying this devices inside the network

499
00:22:23,210 --> 00:22:27,450
so they you know

500
00:22:25,380 --> 00:22:30,060
put us a simple method that is protect

501
00:22:27,450 --> 00:22:32,040
the office file with with a password and

502
00:22:30,060 --> 00:22:34,560
they also include the particle on the

503
00:22:32,040 --> 00:22:36,600
same email so the people that have the

504
00:22:34,560 --> 00:22:38,639
email can open the file extract the file

505
00:22:36,600 --> 00:22:41,550
and the image say is a you're gonna see

506
00:22:38,640 --> 00:22:43,140
the content copy and past it is this

507
00:22:41,550 --> 00:22:45,060
part word inside the inside the dialog

508
00:22:43,140 --> 00:22:47,550
box and open the document and the

509
00:22:45,060 --> 00:22:49,620
document contains a macro that start the

510
00:22:47,550 --> 00:22:51,570
second stage payload inside the machine

511
00:22:49,620 --> 00:22:54,060
so at the end we have the same but with

512
00:22:51,570 --> 00:22:56,010
a previous step we have the password

513
00:22:54,060 --> 00:22:58,649
protection to evade automatic analysis

514
00:22:56,010 --> 00:23:01,140
and also the people started to all the

515
00:22:58,650 --> 00:23:03,810
bad guys and started to use uncommon

516
00:23:01,140 --> 00:23:06,990
files for example dot ISO files dot

517
00:23:03,810 --> 00:23:10,080
Microsoft Publisher and also dot a is

518
00:23:06,990 --> 00:23:14,160
and also WinRAR the idea is to use and

519
00:23:10,080 --> 00:23:16,350
common and common file file types to try

520
00:23:14,160 --> 00:23:19,620
to evade automatic analysis system like

521
00:23:16,350 --> 00:23:22,260
mmm ta or other sandbox in the in the

522
00:23:19,620 --> 00:23:25,590
market and also some consume campaigns

523
00:23:22,260 --> 00:23:28,140
also they are only targeting one

524
00:23:25,590 --> 00:23:30,780
specific country inside the planet so

525
00:23:28,140 --> 00:23:32,610
you are not in Australia you can open

526
00:23:30,780 --> 00:23:34,170
the malicious file well will not be you

527
00:23:32,610 --> 00:23:36,179
know you will not be infected because

528
00:23:34,170 --> 00:23:38,490
the loader will check where are you

529
00:23:36,180 --> 00:23:41,130
located based on the public IP either

530
00:23:38,490 --> 00:23:42,900
you don't you don't be infected by Maya

531
00:23:41,130 --> 00:23:46,410
malware so that's that's a good method

532
00:23:42,900 --> 00:23:48,150
as well to only target the campaign to

533
00:23:46,410 --> 00:23:52,860
specific counties because maybe I

534
00:23:48,150 --> 00:23:55,830
remember the last year with in Spain in

535
00:23:52,860 --> 00:23:59,550
in Spain with when the people started a

536
00:23:55,830 --> 00:24:01,409
campaign targeting in this I think and

537
00:23:59,550 --> 00:24:04,020
and they was they were checking about

538
00:24:01,410 --> 00:24:06,450
some location as well so the people is

539
00:24:04,020 --> 00:24:08,879
the bad guys were folk use it as

540
00:24:06,450 --> 00:24:12,120
exclusively in Spain because they use it

541
00:24:08,880 --> 00:24:15,060
a Spanish run so the VIS will not will

542
00:24:12,120 --> 00:24:17,159
they wouldn't have people from from

543
00:24:15,060 --> 00:24:21,000
outside Spain because they have other

544
00:24:17,160 --> 00:24:23,460
campaigns targeting these people so this

545
00:24:21,000 --> 00:24:27,360
example of server and you have this

546
00:24:23,460 --> 00:24:29,250
dialogue box that ask the the purple for

547
00:24:27,360 --> 00:24:31,590
the user and this part word is on the

548
00:24:29,250 --> 00:24:34,410
same email on the user opening the

549
00:24:31,590 --> 00:24:37,080
attachment so they only need to to copy

550
00:24:34,410 --> 00:24:38,909
and past the to copy the password from

551
00:24:37,080 --> 00:24:42,478
the email and posture in a liar box

552
00:24:38,909 --> 00:24:44,820
to open the document after that the

553
00:24:42,479 --> 00:24:47,609
usual don't don't put the password

554
00:24:44,820 --> 00:24:50,399
inside the dialog box we check the

555
00:24:47,609 --> 00:24:52,830
process the process list inside inside

556
00:24:50,399 --> 00:24:55,228
the machine you will see how there is

557
00:24:52,830 --> 00:24:55,678
only a one windward process internet

558
00:24:55,229 --> 00:24:59,669
machine

559
00:24:55,679 --> 00:25:02,580
why because the the the document doesn't

560
00:24:59,669 --> 00:25:05,129
doesn't start the the second stage

561
00:25:02,580 --> 00:25:07,678
payload because the user didn't activate

562
00:25:05,129 --> 00:25:09,359
because they didn't put the password but

563
00:25:07,679 --> 00:25:12,239
if the user put the password inside the

564
00:25:09,359 --> 00:25:14,460
dialog box we will see how the Windward

565
00:25:12,239 --> 00:25:19,830
as a second as a child process we can

566
00:25:14,460 --> 00:25:23,220
see BBS execution and and this this VBS

567
00:25:19,830 --> 00:25:24,989
is executed by BB script and this level

568
00:25:23,220 --> 00:25:28,139
whisky will will download additional

569
00:25:24,989 --> 00:25:31,739
malware from outside and the idea is the

570
00:25:28,139 --> 00:25:33,570
bad guys tries to protect the the the

571
00:25:31,739 --> 00:25:37,109
final malware painted because they don't

572
00:25:33,570 --> 00:25:39,749
wanna you know that the people captured

573
00:25:37,109 --> 00:25:42,359
the final malware and send them our two

574
00:25:39,749 --> 00:25:44,039
to the AV vendors to create signatures

575
00:25:42,359 --> 00:25:47,908
all the different endpoint protections

576
00:25:44,039 --> 00:25:50,099
so the idea is they put like difficult

577
00:25:47,909 --> 00:25:52,559
particular steps like for example food

578
00:25:50,099 --> 00:25:55,320
put put a simple password inside inside

579
00:25:52,559 --> 00:25:57,479
the document so let's go to take also

580
00:25:55,320 --> 00:26:00,479
because I want to put this example

581
00:25:57,479 --> 00:26:02,519
because some people that that works in

582
00:26:00,479 --> 00:26:05,220
the insulin response area that come come

583
00:26:02,519 --> 00:26:07,649
from the police they always say to me

584
00:26:05,220 --> 00:26:09,599
hey I'm not malware analysis expert I

585
00:26:07,649 --> 00:26:12,869
don't know how to do reverse engineer

586
00:26:09,599 --> 00:26:15,928
and I only do these people I'll give all

587
00:26:12,869 --> 00:26:18,119
I gave the same advice you don't need to

588
00:26:15,929 --> 00:26:20,700
be a super expert we have people inside

589
00:26:18,119 --> 00:26:22,769
the team to do that but if you found a

590
00:26:20,700 --> 00:26:24,720
malware inside the company you need to

591
00:26:22,769 --> 00:26:26,970
do you need to know how to execute

592
00:26:24,720 --> 00:26:28,710
simple tools to extract information

593
00:26:26,970 --> 00:26:30,989
about the malware and you don't need to

594
00:26:28,710 --> 00:26:33,450
be a super expert and this is an example

595
00:26:30,989 --> 00:26:35,639
about ransomware that I found in the

596
00:26:33,450 --> 00:26:37,710
past and it's a good example because if

597
00:26:35,639 --> 00:26:39,629
the the sample is not protected by a

598
00:26:37,710 --> 00:26:42,029
Parker or other custom protection and

599
00:26:39,629 --> 00:26:44,728
have this things in clear and and you

600
00:26:42,029 --> 00:26:46,200
can use some tools to get contextual

601
00:26:44,729 --> 00:26:48,869
information about what is Emma were

602
00:26:46,200 --> 00:26:50,740
doing and you don't need to execute the

603
00:26:48,869 --> 00:26:53,439
malware but we will do

604
00:26:50,740 --> 00:26:56,080
dynamic execution so there's we have

605
00:26:53,440 --> 00:26:57,970
this example as you seen the screen is

606
00:26:56,080 --> 00:27:00,580
around somewhere that it's claiming to

607
00:26:57,970 --> 00:27:04,059
have the decryption key to recover the

608
00:27:00,580 --> 00:27:06,370
files in the in the system and we

609
00:27:04,059 --> 00:27:09,309
execute PS to do to get some of the

610
00:27:06,370 --> 00:27:13,299
strings inside inside the malware and

611
00:27:09,309 --> 00:27:15,389
you can see some references to some to

612
00:27:13,299 --> 00:27:19,629
an external website and it's an FTP

613
00:27:15,390 --> 00:27:22,090
location and some path locations as well

614
00:27:19,630 --> 00:27:24,149
inside inside the Brighton system and

615
00:27:22,090 --> 00:27:27,220
you can you know at the conclusion that

616
00:27:24,149 --> 00:27:30,039
this FTP is malicious and you need to

617
00:27:27,220 --> 00:27:33,340
block to block this FTP and we don't

618
00:27:30,039 --> 00:27:36,610
open it either Pro binary ninja rather

619
00:27:33,340 --> 00:27:39,340
or other tool to track that with it a

620
00:27:36,610 --> 00:27:42,100
simple strings and you said ps2 years of

621
00:27:39,340 --> 00:27:43,389
little - the incident response or to

622
00:27:42,100 --> 00:27:47,020
help you in an instant response

623
00:27:43,390 --> 00:27:49,179
investigation and we execute the tool we

624
00:27:47,020 --> 00:27:51,820
can see I don't know if you can see well

625
00:27:49,179 --> 00:27:55,570
the image but the image so connections

626
00:27:51,820 --> 00:27:58,840
to the remote host so you know when when

627
00:27:55,570 --> 00:28:01,299
the sample starts the sample will start

628
00:27:58,840 --> 00:28:03,389
to do some connection to to this

629
00:28:01,299 --> 00:28:07,590
malicious host so if you broke

630
00:28:03,390 --> 00:28:10,630
theoretically if you block this FTP URL

631
00:28:07,590 --> 00:28:12,309
remotely I mean in your company

632
00:28:10,630 --> 00:28:13,809
all the people infected inside the

633
00:28:12,309 --> 00:28:17,408
company with this malware will be

634
00:28:13,809 --> 00:28:20,830
protected so this is like a simple step

635
00:28:17,409 --> 00:28:22,690
that you can do to protect the users

636
00:28:20,830 --> 00:28:26,199
inside your network and you don't need

637
00:28:22,690 --> 00:28:28,450
to again I want to say that again you

638
00:28:26,200 --> 00:28:30,730
need to open either pro or rather to do

639
00:28:28,450 --> 00:28:34,600
that it's like a simplest things without

640
00:28:30,730 --> 00:28:37,649
with them our sample you can investigate

641
00:28:34,600 --> 00:28:41,158
a bit what is the what is a malicious

642
00:28:37,649 --> 00:28:44,949
host behind that and you can you know

643
00:28:41,159 --> 00:28:47,049
simple tools like Cole or certain

644
00:28:44,950 --> 00:28:49,059
reputation with with third parties and

645
00:28:47,049 --> 00:28:52,960
you can so you can do all the other

646
00:28:49,059 --> 00:28:55,570
stuff to know which is this host behind

647
00:28:52,960 --> 00:28:57,840
this URL you found inside the sample so

648
00:28:55,570 --> 00:29:01,418
you know you don't need to to know about

649
00:28:57,840 --> 00:29:05,049
you know custom custom stuff or or other

650
00:29:01,419 --> 00:29:08,139
things and you know you will

651
00:29:05,049 --> 00:29:11,980
to go a bit deeper inside in the manual

652
00:29:08,139 --> 00:29:14,678
behavior anyone in the room can can say

653
00:29:11,980 --> 00:29:17,080
which is username and password use it to

654
00:29:14,679 --> 00:29:23,679
change file between the malware and the

655
00:29:17,080 --> 00:29:26,649
FTP sample and a volunteer it's so clear

656
00:29:23,679 --> 00:29:28,659
guys it's in the screen so as you see in

657
00:29:26,649 --> 00:29:30,549
the image I know some people wants to

658
00:29:28,659 --> 00:29:35,080
read reply I will not lend them to do it

659
00:29:30,549 --> 00:29:37,869
but I you see the image you can see how

660
00:29:35,080 --> 00:29:40,330
it circle with with with a red line

661
00:29:37,869 --> 00:29:43,959
which is which are the the username and

662
00:29:40,330 --> 00:29:46,899
password used by the malware and in my

663
00:29:43,960 --> 00:29:51,369
investigation I promise I promise that I

664
00:29:46,899 --> 00:29:54,100
I didn't do any meat meat interception

665
00:29:51,369 --> 00:29:56,350
it cell decryption or other stuff like

666
00:29:54,100 --> 00:29:58,809
that a simple capture the traffic with

667
00:29:56,350 --> 00:30:01,178
white shark and I extract the the

668
00:29:58,809 --> 00:30:03,369
connection between between the sample

669
00:30:01,179 --> 00:30:05,409
and the and the FTP I know some people

670
00:30:03,369 --> 00:30:08,109
in the room can say okay mark this one

671
00:30:05,409 --> 00:30:09,850
is stupid sample you know you it's

672
00:30:08,109 --> 00:30:12,580
impossible to find that in a real

673
00:30:09,850 --> 00:30:16,029
investigation well guys it's better to

674
00:30:12,580 --> 00:30:19,149
analyze the data before and start to see

675
00:30:16,029 --> 00:30:21,039
some movies and stuff like that we go to

676
00:30:19,149 --> 00:30:23,049
analyze the data I found this this

677
00:30:21,039 --> 00:30:25,539
sample in an investigation ok so it's a

678
00:30:23,049 --> 00:30:29,200
very old investigation but this sample

679
00:30:25,539 --> 00:30:31,210
was in in a real case so I want to say

680
00:30:29,200 --> 00:30:33,609
with that that first analyze that

681
00:30:31,210 --> 00:30:36,970
because the people behind the attack

682
00:30:33,609 --> 00:30:39,939
could be super high people or skip kids

683
00:30:36,970 --> 00:30:42,850
at the end so with they bought the tool

684
00:30:39,940 --> 00:30:45,039
or they or they you know know the

685
00:30:42,850 --> 00:30:47,709
methods and they use they know how to

686
00:30:45,039 --> 00:30:49,809
use red team in operations but at the

687
00:30:47,710 --> 00:30:52,210
end they are not aware about malware or

688
00:30:49,809 --> 00:30:54,609
stuff and they only use it the ransom

689
00:30:52,210 --> 00:30:56,590
word to do a store ssin in from the

690
00:30:54,609 --> 00:30:58,840
company for example and and could be

691
00:30:56,590 --> 00:31:01,299
that the samples are ciphered with a

692
00:30:58,840 --> 00:31:03,879
short key studied key or other stuff

693
00:31:01,299 --> 00:31:05,710
like that can be and the people the

694
00:31:03,879 --> 00:31:07,629
serious people can the create these

695
00:31:05,710 --> 00:31:10,570
samples and can get the real data P

696
00:31:07,629 --> 00:31:12,519
without paid so I want to say with that

697
00:31:10,570 --> 00:31:14,950
that before I start to thinking about a

698
00:31:12,519 --> 00:31:17,259
this could be a super apt sample or

699
00:31:14,950 --> 00:31:18,370
whatever another sample do a simple

700
00:31:17,259 --> 00:31:20,260
triage

701
00:31:18,370 --> 00:31:22,750
and get some strings and some network

702
00:31:20,260 --> 00:31:25,210
traffic and see it righty what is what

703
00:31:22,750 --> 00:31:27,850
is behind the Marvel piece that you

704
00:31:25,210 --> 00:31:29,200
found and and with this example is good

705
00:31:27,850 --> 00:31:33,340
because you can see with a simple wire

706
00:31:29,200 --> 00:31:35,980
cap capture what is the data behind or

707
00:31:33,340 --> 00:31:39,270
which are the credential exchanges from

708
00:31:35,980 --> 00:31:42,490
the malware to the to the malicious host

709
00:31:39,270 --> 00:31:43,600
before before arrive to the questions

710
00:31:42,490 --> 00:31:46,300
area

711
00:31:43,600 --> 00:31:49,030
I will not reply if I finally enter it

712
00:31:46,300 --> 00:31:52,710
in the FTP in the remote FTP and capture

713
00:31:49,030 --> 00:31:55,870
the data okay that's that's private but

714
00:31:52,710 --> 00:31:58,240
someone in the room can think that it's

715
00:31:55,870 --> 00:32:00,520
so easy if you see the credentials to

716
00:31:58,240 --> 00:32:03,490
see a what did the people capture that

717
00:32:00,520 --> 00:32:06,309
how many people is infected by by this

718
00:32:03,490 --> 00:32:10,059
malware so if we continue with the

719
00:32:06,309 --> 00:32:12,970
analysis these are dn spy tool that I

720
00:32:10,059 --> 00:32:14,860
use to analyze net samples and you can

721
00:32:12,970 --> 00:32:18,429
just other tools you can so you can use

722
00:32:14,860 --> 00:32:21,669
you know this visual studio I don't know

723
00:32:18,429 --> 00:32:24,270
either Pro binary ninja or rather I

724
00:32:21,670 --> 00:32:27,160
don't care about the tools I care about

725
00:32:24,270 --> 00:32:30,309
which which information they can give me

726
00:32:27,160 --> 00:32:33,730
so I will use any any of them start

727
00:32:30,309 --> 00:32:35,800
start we need to stop about the to fight

728
00:32:33,730 --> 00:32:38,410
about which the vestal in the market

729
00:32:35,800 --> 00:32:42,129
okay just use it and contribute them so

730
00:32:38,410 --> 00:32:44,710
this an example about count easily with

731
00:32:42,130 --> 00:32:47,800
this sample I can get information about

732
00:32:44,710 --> 00:32:50,380
and this the other take if also to the

733
00:32:47,800 --> 00:32:52,990
people that are not prettier what about

734
00:32:50,380 --> 00:32:55,720
how to do Marvel analysis and the idea

735
00:32:52,990 --> 00:32:58,570
is you open the dotnet sample with these

736
00:32:55,720 --> 00:33:00,370
tools and you can easily get browse to

737
00:32:58,570 --> 00:33:02,470
the different sections inside the inside

738
00:33:00,370 --> 00:33:04,120
the binary and you can get important

739
00:33:02,470 --> 00:33:06,330
information you will see how the

740
00:33:04,120 --> 00:33:11,320
credentials are distorted in clear-text

741
00:33:06,330 --> 00:33:13,809
inside that these these binary analysis

742
00:33:11,320 --> 00:33:15,939
so let's go to jump inside the analysis

743
00:33:13,809 --> 00:33:18,370
and you can see that if you browse a bit

744
00:33:15,940 --> 00:33:20,860
inside the trash analysis you can

745
00:33:18,370 --> 00:33:23,770
extract for example the ransom note use

746
00:33:20,860 --> 00:33:27,040
it for the for the sample and you can

747
00:33:23,770 --> 00:33:29,860
for example create a yellow rule with

748
00:33:27,040 --> 00:33:32,260
the ransom note content and a scan all

749
00:33:29,860 --> 00:33:34,659
your network with this general

750
00:33:32,260 --> 00:33:37,390
and trying to find some other machines

751
00:33:34,660 --> 00:33:39,010
compromise it I didn't need to create a

752
00:33:37,390 --> 00:33:41,380
signature you can use for example a

753
00:33:39,010 --> 00:33:45,190
simple yellow rule and of course you

754
00:33:41,380 --> 00:33:49,120
need to use an endpoint solution and for

755
00:33:45,190 --> 00:33:52,090
example a guy from Malaga created a tool

756
00:33:49,120 --> 00:33:54,909
call it trusted at all and this rusted

757
00:33:52,090 --> 00:33:57,760
or can can be used to to scan our

758
00:33:54,910 --> 00:34:00,280
windows network is a toolkit in Python

759
00:33:57,760 --> 00:34:02,620
and is open source is in github and you

760
00:34:00,280 --> 00:34:05,200
can use it to scan the memory and the

761
00:34:02,620 --> 00:34:08,620
files with your own rules and it's a guy

762
00:34:05,200 --> 00:34:10,600
from Malaga so hello it's open and

763
00:34:08,620 --> 00:34:12,609
accessible to everyone

764
00:34:10,600 --> 00:34:14,770
in internet because it's open source so

765
00:34:12,610 --> 00:34:17,770
you want to country wood is it's an

766
00:34:14,770 --> 00:34:19,449
internet to do it and with this with the

767
00:34:17,770 --> 00:34:22,230
general as he said you can you can ask

768
00:34:19,449 --> 00:34:24,520
ID you can it can your your network and

769
00:34:22,230 --> 00:34:29,080
this is the content of the ramsar node

770
00:34:24,520 --> 00:34:32,889
and also you can you know spend hours

771
00:34:29,080 --> 00:34:35,139
and hours reading code and trying to

772
00:34:32,889 --> 00:34:37,149
understand what is Amara we're doing you

773
00:34:35,139 --> 00:34:39,429
are not to reverse engineer you don't

774
00:34:37,149 --> 00:34:42,399
have the internet to learn that don't do

775
00:34:39,429 --> 00:34:43,510
that try to find just interesting

776
00:34:42,399 --> 00:34:45,790
extremes that you need for the

777
00:34:43,510 --> 00:34:48,010
investigation like the the remote URL

778
00:34:45,790 --> 00:34:50,620
the credentials you said maybe the

779
00:34:48,010 --> 00:34:52,720
algorithm used to to cipher the files

780
00:34:50,620 --> 00:34:56,589
and all the stuff that you that you need

781
00:34:52,719 --> 00:34:58,480
to know to you know to to analyze the

782
00:34:56,590 --> 00:35:01,140
malware and give the sample to the to

783
00:34:58,480 --> 00:35:03,970
the correct to the correct people and

784
00:35:01,140 --> 00:35:06,609
this some of the faces that they that is

785
00:35:03,970 --> 00:35:08,620
so in the past when when when AI started

786
00:35:06,610 --> 00:35:11,500
to to teach the people how to analyze

787
00:35:08,620 --> 00:35:13,660
malware and I always did the same

788
00:35:11,500 --> 00:35:16,900
questions to all the people in the room

789
00:35:13,660 --> 00:35:19,839
you see a lot of code it's heart on the

790
00:35:16,900 --> 00:35:22,750
start and say no way you need to start

791
00:35:19,840 --> 00:35:24,760
to learn and you need to only read read

792
00:35:22,750 --> 00:35:27,220
the code and instruct and instruct only

793
00:35:24,760 --> 00:35:30,190
the necessary stuff that you need so

794
00:35:27,220 --> 00:35:32,189
let's take an example for a simple

795
00:35:30,190 --> 00:35:35,670
ransomware analysis you can extract

796
00:35:32,190 --> 00:35:40,120
which is the the IV vector and you can

797
00:35:35,670 --> 00:35:43,270
understand how is the DES key user to

798
00:35:40,120 --> 00:35:45,650
cipher the files you need to be a super

799
00:35:43,270 --> 00:35:47,600
guru expert it's only understand

800
00:35:45,650 --> 00:35:50,330
how is the codebase it you only need

801
00:35:47,600 --> 00:35:53,779
some you know basic programming skills

802
00:35:50,330 --> 00:35:56,569
you want to say that so we can we can

803
00:35:53,780 --> 00:35:59,450
stack some of this part and and also you

804
00:35:56,570 --> 00:36:02,000
can copy this portion code text and

805
00:35:59,450 --> 00:36:04,279
share these districts with with other

806
00:36:02,000 --> 00:36:06,740
people inside your team and and they can

807
00:36:04,280 --> 00:36:09,470
help you to understand if the algorithm

808
00:36:06,740 --> 00:36:11,479
you said to to cipher the files is an

809
00:36:09,470 --> 00:36:15,290
Esther own algorithm not we have the

810
00:36:11,480 --> 00:36:16,610
people behind our hundred team and I do

811
00:36:15,290 --> 00:36:19,040
understand where that is all the time

812
00:36:16,610 --> 00:36:20,990
breaking all the new runs and where's

813
00:36:19,040 --> 00:36:23,630
base it on hide and tear for example and

814
00:36:20,990 --> 00:36:25,910
that's because I didn't hear or other

815
00:36:23,630 --> 00:36:28,550
ransomware families they are using weak

816
00:36:25,910 --> 00:36:30,560
algorithms to to cipher their files and

817
00:36:28,550 --> 00:36:33,350
they know and they have and they created

818
00:36:30,560 --> 00:36:35,509
some tools to recover the files so I

819
00:36:33,350 --> 00:36:38,360
want to say with that that just read

820
00:36:35,510 --> 00:36:40,370
read the code try to understand what is

821
00:36:38,360 --> 00:36:44,510
important or not and Anna start this

822
00:36:40,370 --> 00:36:46,970
portion text and for example with this

823
00:36:44,510 --> 00:36:51,230
big screenshot you can see highlighted

824
00:36:46,970 --> 00:36:52,399
in yellow the the you ll use it that we

825
00:36:51,230 --> 00:36:54,290
saw before

826
00:36:52,400 --> 00:36:57,860
and we saw before did this URL with the

827
00:36:54,290 --> 00:37:00,620
simplest rings and imagine that the the

828
00:36:57,860 --> 00:37:03,530
guy doesn't know how to use PS to do and

829
00:37:00,620 --> 00:37:06,020
the other guys never use it strings the

830
00:37:03,530 --> 00:37:08,900
guy can open the file with the Athenian

831
00:37:06,020 --> 00:37:11,030
spy because the guy saw the tool in a

832
00:37:08,900 --> 00:37:14,840
Marc conference in the past and they

833
00:37:11,030 --> 00:37:17,810
know that if he starts to to within Dini

834
00:37:14,840 --> 00:37:20,120
ss5 that the tool have a search box and

835
00:37:17,810 --> 00:37:22,100
you can you know do stuff like give me

836
00:37:20,120 --> 00:37:25,339
the all the URLs that they start with

837
00:37:22,100 --> 00:37:28,850
HTTP or give me all the dot-com domains

838
00:37:25,340 --> 00:37:30,500
and I can you know browse the coton use

839
00:37:28,850 --> 00:37:33,200
some different searches inside the code

840
00:37:30,500 --> 00:37:36,140
undistracted evidence like that and on

841
00:37:33,200 --> 00:37:39,049
the tool on the screen we can see the

842
00:37:36,140 --> 00:37:42,049
exact location the extremal location on

843
00:37:39,050 --> 00:37:44,870
the on the malware will copy the files

844
00:37:42,050 --> 00:37:47,180
and also we can instruct as well the

845
00:37:44,870 --> 00:37:51,020
credentials use it and we don't need to

846
00:37:47,180 --> 00:37:53,359
to do any reverse-engineer in in front

847
00:37:51,020 --> 00:37:57,200
the malware so it's as much easier as

848
00:37:53,360 --> 00:37:59,030
are instructed that information and it's

849
00:37:57,200 --> 00:38:03,950
so easy to to do that

850
00:37:59,030 --> 00:38:06,830
so after after analyzing code we can see

851
00:38:03,950 --> 00:38:11,930
for example that the sample is doing

852
00:38:06,830 --> 00:38:13,730
some remote IP public IP checks and it

853
00:38:11,930 --> 00:38:17,200
is so important because some people

854
00:38:13,730 --> 00:38:19,640
forget that we can go to the different

855
00:38:17,200 --> 00:38:21,680
proxy service inside the company and say

856
00:38:19,640 --> 00:38:25,490
eh give me all the machines that

857
00:38:21,680 --> 00:38:28,879
contacted with this I URL IP or domain

858
00:38:25,490 --> 00:38:33,109
that I found on these manual analysis

859
00:38:28,880 --> 00:38:35,510
and with that we can see we can extract

860
00:38:33,110 --> 00:38:37,610
the conclusion that how many machines in

861
00:38:35,510 --> 00:38:40,280
how many machines was executed a sample

862
00:38:37,610 --> 00:38:42,620
so we don't need to spend the time doing

863
00:38:40,280 --> 00:38:46,670
a lot of hunting inside the network

864
00:38:42,620 --> 00:38:50,660
doing yarol hunting or or I don't know

865
00:38:46,670 --> 00:38:52,160
executing super power shell programs

866
00:38:50,660 --> 00:38:55,370
that you call it for the investigation

867
00:38:52,160 --> 00:38:57,680
is just check the logs and give me how

868
00:38:55,370 --> 00:39:02,000
many how many computers contacted with

869
00:38:57,680 --> 00:39:04,520
with this artifacts that they found we

870
00:39:02,000 --> 00:39:07,340
do that we can we can see we can

871
00:39:04,520 --> 00:39:09,470
understand that the run somebody is

872
00:39:07,340 --> 00:39:11,390
doing FTB connections to a demoed server

873
00:39:09,470 --> 00:39:13,189
and wrote this information with us I

874
00:39:11,390 --> 00:39:16,310
don't want to repeat myself all of this

875
00:39:13,190 --> 00:39:18,370
information can can be easily found just

876
00:39:16,310 --> 00:39:22,970
reading the code you don't need to be a

877
00:39:18,370 --> 00:39:25,970
super expert after after found different

878
00:39:22,970 --> 00:39:28,730
different artifacts related to network

879
00:39:25,970 --> 00:39:30,379
connections or or something that you

880
00:39:28,730 --> 00:39:33,650
have for example access to virustotal

881
00:39:30,380 --> 00:39:36,470
intelligence you can say hey give me

882
00:39:33,650 --> 00:39:40,130
give me how many samples contacted with

883
00:39:36,470 --> 00:39:42,529
this ap you know which information you

884
00:39:40,130 --> 00:39:44,810
have in your records related to samples

885
00:39:42,530 --> 00:39:46,910
that contacted with this ap and also

886
00:39:44,810 --> 00:39:49,130
because you can you can easily have that

887
00:39:46,910 --> 00:39:52,790
with the free version if you want to

888
00:39:49,130 --> 00:39:55,390
know from which countries well there was

889
00:39:52,790 --> 00:39:57,940
a sample submitted or you want to know

890
00:39:55,390 --> 00:40:01,670
how many times was submitted on the

891
00:39:57,940 --> 00:40:04,510
different malicious URLs that the virus

892
00:40:01,670 --> 00:40:07,430
total and so in the while you have a

893
00:40:04,510 --> 00:40:09,320
more privileged account so I want to say

894
00:40:07,430 --> 00:40:11,480
with that that asked for the company to

895
00:40:09,320 --> 00:40:14,230
have access to these tools if they they

896
00:40:11,480 --> 00:40:16,849
can give you because

897
00:40:14,230 --> 00:40:18,770
they can they can give you more contest

898
00:40:16,849 --> 00:40:22,250
on information and at the end is what

899
00:40:18,770 --> 00:40:25,310
you need to arrive to the conclusion

900
00:40:22,250 --> 00:40:28,130
about which people is behind it or if

901
00:40:25,310 --> 00:40:30,380
the campaign is something that is only

902
00:40:28,130 --> 00:40:33,590
targeting you or is a campaign that is

903
00:40:30,380 --> 00:40:35,450
massively affected to other countries

904
00:40:33,590 --> 00:40:38,060
imagine that I checked his IP and they

905
00:40:35,450 --> 00:40:38,720
found samples around the wall in the

906
00:40:38,060 --> 00:40:41,270
last week

907
00:40:38,720 --> 00:40:44,089
this means that attorney and I campaign

908
00:40:41,270 --> 00:40:47,540
all the targeting you know right it's a

909
00:40:44,090 --> 00:40:49,700
it's a it's a campaign that is targeting

910
00:40:47,540 --> 00:40:51,529
massively on the wall and you need to be

911
00:40:49,700 --> 00:40:52,779
as much worried you need to apply

912
00:40:51,530 --> 00:40:56,570
patches and you need to apply

913
00:40:52,780 --> 00:40:58,130
countermeasures in front the incident

914
00:40:56,570 --> 00:41:00,230
that you found but you don't you don't

915
00:40:58,130 --> 00:41:04,040
need to you don't need to be like super

916
00:41:00,230 --> 00:41:06,980
worried about if super apt group is

917
00:41:04,040 --> 00:41:09,590
behind your company so it's just get

918
00:41:06,980 --> 00:41:13,099
conditional information get motivations

919
00:41:09,590 --> 00:41:19,130
and just spend the time in what is

920
00:41:13,099 --> 00:41:23,050
needed or not and you finally get to the

921
00:41:19,130 --> 00:41:25,339
conclusion that your sample or your AP

922
00:41:23,050 --> 00:41:28,940
have relationship with Ana specific

923
00:41:25,339 --> 00:41:31,279
malware family you can you know prepare

924
00:41:28,940 --> 00:41:33,080
the necessary defenses inside your

925
00:41:31,280 --> 00:41:37,130
network to be protected imagine that the

926
00:41:33,080 --> 00:41:38,990
sample is for example we we had a

927
00:41:37,130 --> 00:41:42,920
conversation during the during the lunch

928
00:41:38,990 --> 00:41:44,930
about wanna cry and and and have wanna

929
00:41:42,920 --> 00:41:47,119
cry targeted different companies are on

930
00:41:44,930 --> 00:41:49,580
the wall and especially one company in

931
00:41:47,119 --> 00:41:53,300
Spain and wanna cry one of the method

932
00:41:49,580 --> 00:41:55,970
use it was a scan the network and you

933
00:41:53,300 --> 00:41:59,869
know apply some some exploits to

934
00:41:55,970 --> 00:42:02,149
decipher the machine and you know we

935
00:41:59,869 --> 00:42:03,859
found a tool like wanna cry inside

936
00:42:02,150 --> 00:42:06,820
inside the network we can you know

937
00:42:03,859 --> 00:42:09,470
prepare or try to study which

938
00:42:06,820 --> 00:42:11,900
vulnerabilities want to cry trying to to

939
00:42:09,470 --> 00:42:14,209
exploit and we can apply fast patches

940
00:42:11,900 --> 00:42:17,450
inside the network on or at the end

941
00:42:14,210 --> 00:42:19,010
apply some blockage blocks with

942
00:42:17,450 --> 00:42:21,200
firewalls and other tools it's like

943
00:42:19,010 --> 00:42:22,970
inside your you never we could at the

944
00:42:21,200 --> 00:42:25,910
end as a scientist in see response

945
00:42:22,970 --> 00:42:26,839
consultant you you will know probably

946
00:42:25,910 --> 00:42:30,170
not the first day

947
00:42:26,840 --> 00:42:32,210
but you are in the company to free for

948
00:42:30,170 --> 00:42:34,400
this you will know which security

949
00:42:32,210 --> 00:42:37,880
devices or productions have the company

950
00:42:34,400 --> 00:42:39,350
available to use so idea is you had

951
00:42:37,880 --> 00:42:41,390
contextual information about what is a

952
00:42:39,350 --> 00:42:44,180
sample doing you can apply content

953
00:42:41,390 --> 00:42:47,600
measures using those security devices or

954
00:42:44,180 --> 00:42:49,129
that is the idea to know you can you

955
00:42:47,600 --> 00:42:51,440
know discover which is the malware

956
00:42:49,130 --> 00:42:55,490
behind and a specific IP for the example

957
00:42:51,440 --> 00:42:59,770
and ready to yellow hunting because I'm

958
00:42:55,490 --> 00:43:04,729
so fun about Daraa and I think it's a

959
00:42:59,770 --> 00:43:07,100
you know binary cells to a pattern

960
00:43:04,730 --> 00:43:09,860
search tool that can be used to to a lot

961
00:43:07,100 --> 00:43:12,380
of his stuff and I saw people that use

962
00:43:09,860 --> 00:43:14,600
it yaara o yaara hunting not only to

963
00:43:12,380 --> 00:43:16,940
analyze malware the usage Allah to dona

964
00:43:14,600 --> 00:43:20,930
like speaker of memory damn

965
00:43:16,940 --> 00:43:24,200
drop it files and also as a product as

966
00:43:20,930 --> 00:43:27,140
implication tool in in a fine in a file

967
00:43:24,200 --> 00:43:29,270
system monitor for example so depending

968
00:43:27,140 --> 00:43:33,049
of the of your use case the other could

969
00:43:29,270 --> 00:43:35,600
be a good tool that could be a use case

970
00:43:33,050 --> 00:43:39,350
I would use kit for you the end you can

971
00:43:35,600 --> 00:43:42,740
define unique strings and conditions and

972
00:43:39,350 --> 00:43:46,190
the condition could be the the size of

973
00:43:42,740 --> 00:43:47,120
the file or witches things needs to be

974
00:43:46,190 --> 00:43:50,930
much at first

975
00:43:47,120 --> 00:43:53,359
so depending or as well they can work

976
00:43:50,930 --> 00:43:56,210
with for example if you are doing your

977
00:43:53,360 --> 00:43:59,120
rules for first Campeche files you can

978
00:43:56,210 --> 00:44:03,380
input the be library and you can use

979
00:43:59,120 --> 00:44:05,299
specific formats or conditions related

980
00:44:03,380 --> 00:44:08,300
to PE files so depending limit of your

981
00:44:05,300 --> 00:44:12,080
use case you can use Java for for one of

982
00:44:08,300 --> 00:44:16,010
these use cases and III love how

983
00:44:12,080 --> 00:44:17,509
profound in a private list and the the

984
00:44:16,010 --> 00:44:22,190
project is available on github as well

985
00:44:17,510 --> 00:44:26,270
and it's a pasta pasta mean hunter using

986
00:44:22,190 --> 00:44:28,970
your rules and I found I found some

987
00:44:26,270 --> 00:44:32,600
campaigns that the second Estes payload

988
00:44:28,970 --> 00:44:36,439
is it's a binary it's encoded based

989
00:44:32,600 --> 00:44:40,700
basis T for binary inside page beam and

990
00:44:36,440 --> 00:44:43,910
the malware grab this base64 by

991
00:44:40,700 --> 00:44:47,089
the goats locally and execute inside the

992
00:44:43,910 --> 00:44:48,348
system and it is so good because you are

993
00:44:47,089 --> 00:44:50,720
in an investigation and you see a

994
00:44:48,349 --> 00:44:53,599
pastebin URL you are not you are

995
00:44:50,720 --> 00:44:56,299
improperly much aware about what his

996
00:44:53,599 --> 00:44:58,670
replacement has been doing and in the in

997
00:44:56,299 --> 00:45:01,329
this case the bad guys stole it

998
00:44:58,670 --> 00:45:04,430
malicious binary encoded in base64

999
00:45:01,329 --> 00:45:08,240
inside the PES bean and the malware grab

1000
00:45:04,430 --> 00:45:10,848
these gravities base64 binary and

1001
00:45:08,240 --> 00:45:13,009
encoded binary and they call it locally

1002
00:45:10,849 --> 00:45:15,500
and executed compromised in the machine

1003
00:45:13,010 --> 00:45:19,549
and this a good example about how the

1004
00:45:15,500 --> 00:45:23,000
guy behind this project he created some

1005
00:45:19,549 --> 00:45:25,430
error rules to find malicious samples

1006
00:45:23,000 --> 00:45:30,130
started in face win and he get a used

1007
00:45:25,430 --> 00:45:32,690
case and with the tools you can Italy

1008
00:45:30,130 --> 00:45:35,210
you know launch all the information that

1009
00:45:32,690 --> 00:45:37,760
you found to add elastic search and with

1010
00:45:35,210 --> 00:45:40,760
Giovanna he is filtering and instructed

1011
00:45:37,760 --> 00:45:44,049
some valuable information about the

1012
00:45:40,760 --> 00:45:47,930
malicious data found in impatient and

1013
00:45:44,049 --> 00:45:50,809
well I finished the talk I don't know if

1014
00:45:47,930 --> 00:45:52,690
you guys have any question or or comment

1015
00:45:50,809 --> 00:45:58,510
you like it or not

1016
00:45:52,690 --> 00:46:06,740
here have some seconds any question

1017
00:45:58,510 --> 00:46:30,740
well one question we have an image for

1018
00:46:06,740 --> 00:46:34,490
for him hello hola hola hello should

1019
00:46:30,740 --> 00:46:37,720
have set for breakfast so that you were

1020
00:46:34,490 --> 00:46:40,430
able to speak within your time limit

1021
00:46:37,720 --> 00:46:41,299
go ahead what's your name what questions

1022
00:46:40,430 --> 00:46:44,720
do you have for mark

1023
00:46:41,300 --> 00:46:47,900
yeah my name is Adam you are talking

1024
00:46:44,720 --> 00:46:51,350
about the response the response for the

1025
00:46:47,900 --> 00:46:53,480
incident so to get better response well

1026
00:46:51,350 --> 00:46:57,740
always we are talking about the incident

1027
00:46:53,480 --> 00:47:01,730
reporting so what kind did you use any

1028
00:46:57,740 --> 00:47:04,879
framework or mechanism for incident

1029
00:47:01,730 --> 00:47:08,180
reporting so and after that what kind of

1030
00:47:04,880 --> 00:47:09,980
analysis you are doing with this that's

1031
00:47:08,180 --> 00:47:12,109
that's a good question because I think

1032
00:47:09,980 --> 00:47:14,600
the big vendors in the market I am

1033
00:47:12,110 --> 00:47:16,850
talking about companies like found Stone

1034
00:47:14,600 --> 00:47:19,130
mandiant the type of company that is

1035
00:47:16,850 --> 00:47:21,680
doing enterprise in see and respond and

1036
00:47:19,130 --> 00:47:24,260
they have big teams to initial response

1037
00:47:21,680 --> 00:47:27,020
I'm sure they have his own framework to

1038
00:47:24,260 --> 00:47:28,490
create report so they you know grab the

1039
00:47:27,020 --> 00:47:30,080
locks inside the framework and the

1040
00:47:28,490 --> 00:47:31,850
framework is doing some magic and

1041
00:47:30,080 --> 00:47:34,730
created a final report to the customer

1042
00:47:31,850 --> 00:47:37,460
so the idea is the we have some tools

1043
00:47:34,730 --> 00:47:40,820
available in the market and this this

1044
00:47:37,460 --> 00:47:43,660
one call it fi are I think it's on

1045
00:47:40,820 --> 00:47:46,340
github and it's an instant response

1046
00:47:43,660 --> 00:47:49,399
open-source tool created by some

1047
00:47:46,340 --> 00:47:51,080
European cert I think and it's a it's a

1048
00:47:49,400 --> 00:47:53,450
framework that you can you can define

1049
00:47:51,080 --> 00:47:56,120
different tlps for investigations you

1050
00:47:53,450 --> 00:47:59,419
can upload different artifacts you can

1051
00:47:56,120 --> 00:48:02,029
do some incident response tracking so

1052
00:47:59,420 --> 00:48:04,760
the idea is I don't know any tools I

1053
00:48:02,030 --> 00:48:05,960
know that for for pen testing I remember

1054
00:48:04,760 --> 00:48:08,240
at all in the past call it

1055
00:48:05,960 --> 00:48:10,470
Drago's or something that that can be

1056
00:48:08,240 --> 00:48:12,060
used to talk to to you

1057
00:48:10,470 --> 00:48:14,490
you can use different or upload

1058
00:48:12,060 --> 00:48:16,560
different tools reports and you

1059
00:48:14,490 --> 00:48:19,529
can greater like a word document with

1060
00:48:16,560 --> 00:48:21,840
the with the active scan it and so on

1061
00:48:19,530 --> 00:48:24,510
but for instant response I don't know

1062
00:48:21,840 --> 00:48:27,000
any any professional tool to create

1063
00:48:24,510 --> 00:48:28,830
reporting but I know some of them to do

1064
00:48:27,000 --> 00:48:31,290
for example in send respond tracking and

1065
00:48:28,830 --> 00:48:33,630
do your different consultants can upload

1066
00:48:31,290 --> 00:48:36,450
different artifacts and an informational

1067
00:48:33,630 --> 00:48:38,340
phone and alpha and if I are can

1068
00:48:36,450 --> 00:48:40,020
correlate this information and also for

1069
00:48:38,340 --> 00:48:42,000
example we have crits

1070
00:48:40,020 --> 00:48:45,540
in the market that can can be use it as

1071
00:48:42,000 --> 00:48:47,700
well to to upload artifacts and also

1072
00:48:45,540 --> 00:48:49,710
Clips calf connections with different

1073
00:48:47,700 --> 00:48:53,220
third-party tools like white of total

1074
00:48:49,710 --> 00:48:55,410
tract create Palo Alto and can give the

1075
00:48:53,220 --> 00:48:58,109
analyst more more information but to

1076
00:48:55,410 --> 00:48:59,549
create a specifically the report I don't

1077
00:48:58,109 --> 00:49:02,759
know I didn't know any told yet maybe

1078
00:48:59,550 --> 00:49:04,859
it's a good moment to you to create the

1079
00:49:02,760 --> 00:49:10,260
tool and exchange with the community

1080
00:49:04,859 --> 00:49:11,900
that's a challenge any more questions on

1081
00:49:10,260 --> 00:49:16,830
the floor

1082
00:49:11,900 --> 00:49:18,270
nope so have a good trip to Barcelona

1083
00:49:16,830 --> 00:49:20,759
back to Barcelona

1084
00:49:18,270 --> 00:49:23,130
thank you for your conference mark thank

1085
00:49:20,760 --> 00:49:25,770
you for being here and we will be back

1086
00:49:23,130 --> 00:49:27,869
at 5:30 I have to tell you that right

1087
00:49:25,770 --> 00:49:31,710
now Estonia is in the first place Spain

1088
00:49:27,869 --> 00:49:34,200
is second I know who is third I know a

1089
00:49:31,710 --> 00:49:37,770
Sonja in Spain yes yes our first and

1090
00:49:34,200 --> 00:49:40,020
second so at 5:30 we'll be here with the

1091
00:49:37,770 --> 00:49:41,820
captains of the teams we will discuss

1092
00:49:40,020 --> 00:49:44,820
with them has the competition going on

1093
00:49:41,820 --> 00:49:46,500
and there will give the prices to every

1094
00:49:44,820 --> 00:49:47,520
one of them as per celebrate as mr.

1095
00:49:46,500 --> 00:49:51,599
Kimura

1096
00:49:47,520 --> 00:49:53,550
have you seen them oh of course no this

1097
00:49:51,599 --> 00:49:56,220
is a private things of course you were

1098
00:49:53,550 --> 00:49:58,430
not able to go what they are doing at

1099
00:49:56,220 --> 00:49:58,430
the moment

1100
00:50:00,330 --> 00:50:05,460
now there concentrates points points the

1101
00:50:03,119 --> 00:50:07,530
final way no mark thank you thank you

1102
00:50:05,460 --> 00:50:08,580
see you at 5:30 okay big applause for

1103
00:50:07,530 --> 00:50:14,199
mark very wait Oh

1104
00:50:08,580 --> 00:50:14,199
[Applause]

1105
00:50:19,660 --> 00:50:21,720
you

