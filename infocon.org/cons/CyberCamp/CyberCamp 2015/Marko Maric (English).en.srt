1
00:00:02,840 --> 00:00:10,649
bienvenidos de novo a fever cam doors

2
00:00:05,160 --> 00:00:12,389
milk in say oh sanam and hacer este

3
00:00:10,650 --> 00:00:14,250
ultimo dia este gran event oh we're

4
00:00:12,389 --> 00:00:18,330
going to start the third and last day of

5
00:00:14,250 --> 00:00:20,939
these marvelous event this without

6
00:00:18,330 --> 00:00:24,589
finish so many activities workshops

7
00:00:20,939 --> 00:00:27,990
still to be conducted the first paper

8
00:00:24,590 --> 00:00:31,610
Marc Emery he is competing an engineer

9
00:00:27,990 --> 00:00:34,290
and he got a master and sciences of

10
00:00:31,610 --> 00:00:36,989
information and telecommunications doing

11
00:00:34,290 --> 00:00:40,800
to this last year of studies he focused

12
00:00:36,989 --> 00:00:42,750
on cybersecurity is working on the tools

13
00:00:40,800 --> 00:00:45,510
as to detecting and responding to

14
00:00:42,750 --> 00:00:49,170
incidents and over the past two years

15
00:00:45,510 --> 00:00:52,649
it's been part of the advanced European

16
00:00:49,170 --> 00:00:56,030
cybersecurity standard is really a

17
00:00:52,649 --> 00:00:56,030
pleasure to have you here abduction

18
00:00:56,210 --> 00:01:01,320
basically I don't speak Spanish silenced

19
00:00:58,440 --> 00:01:05,759
I don't know to say anything but hola

20
00:01:01,320 --> 00:01:11,640
como estas so I don't need to hell this

21
00:01:05,760 --> 00:01:17,549
presentation on English so yes how come

22
00:01:11,640 --> 00:01:21,479
that I am into into bitcoins well

23
00:01:17,549 --> 00:01:25,310
basically as as a member of creation

24
00:01:21,479 --> 00:01:31,880
national cert we had a lot of situations

25
00:01:25,310 --> 00:01:37,920
that lot of situations of blackmailing

26
00:01:31,880 --> 00:01:42,360
for example recently we had one hackers

27
00:01:37,920 --> 00:01:46,350
group in Croatia that that was doing d

28
00:01:42,360 --> 00:01:50,280
dos attack on on some firms in Croatia

29
00:01:46,350 --> 00:01:54,119
and they were asking for ransom in

30
00:01:50,280 --> 00:01:56,430
bitcoins and as well we we often know

31
00:01:54,119 --> 00:02:00,210
that there are many runs somewheres

32
00:01:56,430 --> 00:02:04,799
around the world and ransoms are always

33
00:02:00,210 --> 00:02:09,090
in bitcoins and of course as my my job

34
00:02:04,799 --> 00:02:13,000
is to to catch criminals I started to

35
00:02:09,090 --> 00:02:18,540
wonder myself would it be possible to

36
00:02:13,000 --> 00:02:23,860
the anonymize the Bitcoin addresses that

37
00:02:18,540 --> 00:02:27,489
those criminals are giving to to do to

38
00:02:23,860 --> 00:02:30,820
the firm's that the addresses they at

39
00:02:27,490 --> 00:02:35,170
which they want their payments to be to

40
00:02:30,820 --> 00:02:39,130
be made and yes basically I started to

41
00:02:35,170 --> 00:02:43,208
research what what are my chances to D

42
00:02:39,130 --> 00:02:51,220
anonymize to the anonymize some Bitcoin

43
00:02:43,209 --> 00:02:54,489
address so I suppose everybody here who

44
00:02:51,220 --> 00:02:58,510
is interested in this presentation know

45
00:02:54,489 --> 00:03:01,600
something about Bitcoin but for those of

46
00:02:58,510 --> 00:03:05,230
you who does not know anything I made

47
00:03:01,600 --> 00:03:09,340
just a brief introduction just for the

48
00:03:05,230 --> 00:03:13,030
sake to to introduce main elements that

49
00:03:09,340 --> 00:03:18,480
one needs to understand to to be able to

50
00:03:13,030 --> 00:03:20,980
to understand the an elimination methods

51
00:03:18,480 --> 00:03:24,840
basically there are two complementary

52
00:03:20,980 --> 00:03:28,480
dan a musician methods one is

53
00:03:24,840 --> 00:03:31,959
transaction graph analysis and another

54
00:03:28,480 --> 00:03:35,709
one is real-time network analysis and I

55
00:03:31,959 --> 00:03:39,519
will say something about how each of it

56
00:03:35,709 --> 00:03:44,290
works what are the chances to D

57
00:03:39,519 --> 00:03:46,420
anonymize anything and can i have some

58
00:03:44,290 --> 00:03:49,720
realistic expectations of of those

59
00:03:46,420 --> 00:03:54,429
methods ok so let's start with

60
00:03:49,720 --> 00:03:59,380
introduction so what do what is bitcoin

61
00:03:54,430 --> 00:04:05,430
bitcoin is a peer-to-peer network where

62
00:03:59,380 --> 00:04:13,109
users are transacting after sending

63
00:04:05,430 --> 00:04:16,478
digital money between each other and the

64
00:04:13,110 --> 00:04:19,780
appears that our actual users are

65
00:04:16,478 --> 00:04:22,450
generating transactions and broadcasting

66
00:04:19,779 --> 00:04:25,210
them on network and they are

67
00:04:22,450 --> 00:04:29,380
broadcasting those transactions to

68
00:04:25,210 --> 00:04:31,539
to each fear that is neighbor of the

69
00:04:29,380 --> 00:04:33,789
pier in question and as and then

70
00:04:31,539 --> 00:04:36,849
subsequent peers are transacting further

71
00:04:33,789 --> 00:04:40,659
so in the matter of few seconds the oil

72
00:04:36,849 --> 00:04:49,560
network is aware of of some transaction

73
00:04:40,660 --> 00:04:49,560
that took place thank you wrong

74
00:04:51,520 --> 00:04:58,900
so on the other side there are there is

75
00:04:54,970 --> 00:05:01,419
a subset of all those beers coal miners

76
00:04:58,900 --> 00:05:05,039
that are collecting those transactions

77
00:05:01,419 --> 00:05:07,900
and putting them on the pile and

78
00:05:05,039 --> 00:05:11,349
together together with with those

79
00:05:07,900 --> 00:05:18,280
transactions they are adding some random

80
00:05:11,349 --> 00:05:21,878
data that in such way that that the

81
00:05:18,280 --> 00:05:27,099
hedge of of of those collected

82
00:05:21,879 --> 00:05:29,889
transaction + + beta is generating is

83
00:05:27,099 --> 00:05:35,680
generating cash which meets some

84
00:05:29,889 --> 00:05:39,580
specific condition those that search is

85
00:05:35,680 --> 00:05:42,490
not easy to find and miners need needs

86
00:05:39,580 --> 00:05:45,190
to be fast and need to be lucky to be

87
00:05:42,490 --> 00:05:51,400
the first one who will who will generate

88
00:05:45,190 --> 00:05:54,190
who will generate the block minor that

89
00:05:51,400 --> 00:05:56,620
first generates the book is broadcasting

90
00:05:54,190 --> 00:05:59,680
that block to the network in same manner

91
00:05:56,620 --> 00:06:06,280
that our transactions are broadcasting

92
00:05:59,680 --> 00:06:10,150
and so basically basically block is

93
00:06:06,280 --> 00:06:15,359
containing transactions and all peers of

94
00:06:10,150 --> 00:06:19,000
our learning are learning blocks

95
00:06:15,360 --> 00:06:23,680
individually every pill for itself but

96
00:06:19,000 --> 00:06:25,870
at the end at the end there is consensus

97
00:06:23,680 --> 00:06:28,960
which I will not talk about it is

98
00:06:25,870 --> 00:06:35,080
outside of this of this talk there is

99
00:06:28,960 --> 00:06:40,508
consensus that that put state that every

100
00:06:35,080 --> 00:06:44,050
peer actually has a same same sequence

101
00:06:40,509 --> 00:06:46,199
of of blocks on their computers and that

102
00:06:44,050 --> 00:06:51,069
sequence of blocks is called blockchain

103
00:06:46,199 --> 00:06:53,650
the blockchain is basically a set of all

104
00:06:51,069 --> 00:06:56,000
transactions that ever took place in the

105
00:06:53,650 --> 00:07:00,109
Bitcoin network

106
00:06:56,000 --> 00:07:02,480
ok so now I start with the first method

107
00:07:00,110 --> 00:07:06,800
of the anonymization and that is

108
00:07:02,480 --> 00:07:09,820
transaction graph analysis so here I

109
00:07:06,800 --> 00:07:13,190
need to say something more about

110
00:07:09,820 --> 00:07:17,240
transaction itself so in the picture you

111
00:07:13,190 --> 00:07:20,090
can see that transactions are are split

112
00:07:17,240 --> 00:07:23,840
on two parts that is input part and

113
00:07:20,090 --> 00:07:27,520
output part on the input part are all

114
00:07:23,840 --> 00:07:30,409
Bitcoin addresses that are sending

115
00:07:27,520 --> 00:07:33,169
letters ending the bitcoins and the

116
00:07:30,410 --> 00:07:41,090
output part are all Bitcoin addresses

117
00:07:33,169 --> 00:07:43,190
that are receiving the bitcoins so wise

118
00:07:41,090 --> 00:07:45,200
transaction graph and I was possible

119
00:07:43,190 --> 00:07:49,490
because the blockchain is a public so

120
00:07:45,200 --> 00:07:53,659
everybody can see but though he is the

121
00:07:49,490 --> 00:07:56,870
public identity of those Bitcoin

122
00:07:53,660 --> 00:08:00,560
addresses is hiding so Bitcoin address

123
00:07:56,870 --> 00:08:06,410
is basically just hash of the public key

124
00:08:00,560 --> 00:08:13,570
of the user of the user that is that is

125
00:08:06,410 --> 00:08:19,970
owner of that of that key pair and and

126
00:08:13,570 --> 00:08:23,540
as picture suggests there is there is

127
00:08:19,970 --> 00:08:26,990
three main three main concepts that you

128
00:08:23,540 --> 00:08:30,860
need to be aware of to to be able to

129
00:08:26,990 --> 00:08:35,150
speak about the anonymization so the

130
00:08:30,860 --> 00:08:38,960
first first concept is that input is

131
00:08:35,150 --> 00:08:41,270
always equals output so if you have 10

132
00:08:38,960 --> 00:08:45,050
bitcoins and you want to pay some to

133
00:08:41,270 --> 00:08:47,689
somebody something worth of seven

134
00:08:45,050 --> 00:08:51,740
bitcoins you actually need to pay us to

135
00:08:47,690 --> 00:08:54,380
spend all ten but three bitcoins that

136
00:08:51,740 --> 00:09:00,290
are left over you need to to pay to

137
00:08:54,380 --> 00:09:03,580
yourself back so therefore therefore as

138
00:09:00,290 --> 00:09:06,520
if you look the second rejection

139
00:09:03,580 --> 00:09:10,270
you have always you he'll always one

140
00:09:06,520 --> 00:09:12,670
additional bitcoin address that is

141
00:09:10,270 --> 00:09:16,840
actually changed address and that is the

142
00:09:12,670 --> 00:09:22,630
address when you when you paint the

143
00:09:16,840 --> 00:09:25,390
coins back to yourself except except

144
00:09:22,630 --> 00:09:26,910
that their resolves or transaction fee

145
00:09:25,390 --> 00:09:29,410
as you can see on picture and

146
00:09:26,910 --> 00:09:33,610
transaction fee is the reward for the

147
00:09:29,410 --> 00:09:39,310
miner for his effort to to secure the

148
00:09:33,610 --> 00:09:41,740
network and if what if transaction if

149
00:09:39,310 --> 00:09:46,540
transaction fee is what is the section

150
00:09:41,740 --> 00:09:51,520
feel bigger the miner is is taking your

151
00:09:46,540 --> 00:09:57,490
transaction as as privileged transaction

152
00:09:51,520 --> 00:09:59,050
to to be included in block what is

153
00:09:57,490 --> 00:10:01,750
complimentary if you don't pay the

154
00:09:59,050 --> 00:10:05,020
transaction fee then you may wait quite

155
00:10:01,750 --> 00:10:11,740
a bit to to get confirmation that you

156
00:10:05,020 --> 00:10:14,110
really did you really paid something how

157
00:10:11,740 --> 00:10:16,240
to do anonymize using block chain so how

158
00:10:14,110 --> 00:10:21,340
is possible to the only anonymize

159
00:10:16,240 --> 00:10:24,220
something if you have only Bitcoin

160
00:10:21,340 --> 00:10:26,980
addresses that looks like random random

161
00:10:24,220 --> 00:10:30,070
data so basically to there are two

162
00:10:26,980 --> 00:10:33,660
concepts that allows the the

163
00:10:30,070 --> 00:10:41,110
anonymization first concept is wallets

164
00:10:33,660 --> 00:10:45,130
so basically every user is his owner or

165
00:10:41,110 --> 00:10:48,040
is very often order of multiple between

166
00:10:45,130 --> 00:10:52,530
addresses and when he is doing big

167
00:10:48,040 --> 00:10:58,390
payment to somebody some big payment and

168
00:10:52,530 --> 00:11:01,720
he have no enough enough coins on one

169
00:10:58,390 --> 00:11:04,390
address he need to use one input side he

170
00:11:01,720 --> 00:11:06,430
need to use many you need to use many

171
00:11:04,390 --> 00:11:09,490
addresses in order to execute

172
00:11:06,430 --> 00:11:11,680
transaction so basically when we see in

173
00:11:09,490 --> 00:11:15,100
block chains on transactions that have

174
00:11:11,680 --> 00:11:17,120
multiple they have multiple Bitcoin

175
00:11:15,100 --> 00:11:19,130
addresses on input side

176
00:11:17,120 --> 00:11:24,560
that means that all of those addresses

177
00:11:19,130 --> 00:11:27,620
are owned by same user so that is not

178
00:11:24,560 --> 00:11:30,410
the anonymizer user but it is something

179
00:11:27,620 --> 00:11:35,210
to know that they are all owned by by

180
00:11:30,410 --> 00:11:37,430
same user by same entity so in that way

181
00:11:35,210 --> 00:11:42,470
the wallets are actually proof or

182
00:11:37,430 --> 00:11:44,660
SharePoint drove so if you see that some

183
00:11:42,470 --> 00:11:47,089
transaction is assembled from multiple

184
00:11:44,660 --> 00:11:56,630
between addresses they all belong to the

185
00:11:47,089 --> 00:11:59,870
same user second thing that that enables

186
00:11:56,630 --> 00:12:04,839
the D anonymization using block chain is

187
00:11:59,870 --> 00:12:07,839
the fact that many many people are

188
00:12:04,839 --> 00:12:13,000
publishing their Bitcoin addresses

189
00:12:07,839 --> 00:12:17,600
publicly on the web so for example on

190
00:12:13,000 --> 00:12:21,290
many forums you can find people people

191
00:12:17,600 --> 00:12:25,820
making signature using their their

192
00:12:21,290 --> 00:12:27,380
address and on blockchain that info

193
00:12:25,820 --> 00:12:30,529
which is main block chain Explorer

194
00:12:27,380 --> 00:12:33,350
there's an option to tag itself so you

195
00:12:30,529 --> 00:12:38,270
can if you are running some service or

196
00:12:33,350 --> 00:12:43,730
some website you can you can and some

197
00:12:38,270 --> 00:12:45,980
service where you are somebody needs to

198
00:12:43,730 --> 00:12:50,720
pay you something you can add your

199
00:12:45,980 --> 00:12:54,230
Bitcoin address to to the text so people

200
00:12:50,720 --> 00:12:59,480
can can use this this registry to find

201
00:12:54,230 --> 00:13:02,240
you so basically what we can do is by

202
00:12:59,480 --> 00:13:04,880
crawling the web by crawling the forums

203
00:13:02,240 --> 00:13:08,870
by crawling the bleep block chaining dot

204
00:13:04,880 --> 00:13:13,010
info they are not have some specific AP

205
00:13:08,870 --> 00:13:17,510
so it is need to be done by crawling we

206
00:13:13,010 --> 00:13:20,779
can collect all tagged addresses other

207
00:13:17,510 --> 00:13:27,439
way of collecting of collecting tags

208
00:13:20,779 --> 00:13:29,480
ebah is by to say active pinging so for

209
00:13:27,440 --> 00:13:30,649
example if there are some merchants

210
00:13:29,480 --> 00:13:33,529
places on

211
00:13:30,649 --> 00:13:35,420
web and you want to know which which

212
00:13:33,529 --> 00:13:38,839
Bitcoin addresses they are using for

213
00:13:35,420 --> 00:13:41,809
payout you can on purpose buy things

214
00:13:38,839 --> 00:13:48,499
just to generate transactions to be to

215
00:13:41,809 --> 00:13:51,499
collect all those addresses okay so now

216
00:13:48,499 --> 00:13:55,309
when we when we are aware of concept of

217
00:13:51,499 --> 00:14:00,009
wallet and on concept of tagged users we

218
00:13:55,309 --> 00:14:03,110
can use method of clustering to actually

219
00:14:00,009 --> 00:14:07,040
produce even more even more Doug

220
00:14:03,110 --> 00:14:10,369
addresses so there are three there are

221
00:14:07,040 --> 00:14:13,490
three main three main things about

222
00:14:10,369 --> 00:14:17,179
clustering to remain methods that that

223
00:14:13,490 --> 00:14:21,110
are to be used first of it is leaking

224
00:14:17,179 --> 00:14:23,779
different inputs to the same user so if

225
00:14:21,110 --> 00:14:27,259
you have two transactions one with

226
00:14:23,779 --> 00:14:30,709
inputs a and B another one with inputs B

227
00:14:27,259 --> 00:14:33,769
and C it is obvious that and E and B and

228
00:14:30,709 --> 00:14:36,679
C are belonging to the same user so in

229
00:14:33,769 --> 00:14:40,639
this way if you have users with a lot of

230
00:14:36,679 --> 00:14:43,910
Bitcoin addresses on time by time you

231
00:14:40,639 --> 00:14:48,410
can achieve very quick expansion of that

232
00:14:43,910 --> 00:14:53,529
cluster another thing is tagging

233
00:14:48,410 --> 00:14:57,019
clusters so when you have a way with

234
00:14:53,529 --> 00:14:58,939
when you were doing the the first step

235
00:14:57,019 --> 00:15:01,579
of licking different dimple inputs the

236
00:14:58,939 --> 00:15:04,129
same user you achieved very big cluster

237
00:15:01,579 --> 00:15:06,679
and if you are able to find any of

238
00:15:04,129 --> 00:15:09,290
address from that cluster to be

239
00:15:06,679 --> 00:15:12,350
associated to any of doug's you can

240
00:15:09,290 --> 00:15:15,519
immediately you can immediately tag all

241
00:15:12,350 --> 00:15:18,470
cluster to belong to the same user and

242
00:15:15,519 --> 00:15:20,899
finally when you have clusters different

243
00:15:18,470 --> 00:15:23,299
clusters that are tagged with same user

244
00:15:20,899 --> 00:15:28,540
you can combine all these clusters two

245
00:15:23,299 --> 00:15:32,149
to one single user as I exactly such

246
00:15:28,540 --> 00:15:35,209
approach was done by the researchers of

247
00:15:32,149 --> 00:15:38,649
university of california in december of

248
00:15:35,209 --> 00:15:41,479
2013 so it was just in the time of

249
00:15:38,649 --> 00:15:44,810
bitcoin boom when price rise

250
00:15:41,480 --> 00:15:49,260
exponentially as well as hashing power

251
00:15:44,810 --> 00:15:52,199
they passed block chain and basic people

252
00:15:49,260 --> 00:15:57,470
now there is on github few different

253
00:15:52,200 --> 00:16:02,070
available projects that are that are

254
00:15:57,470 --> 00:16:06,300
doing data doing softwares for for

255
00:16:02,070 --> 00:16:09,360
efficient parsing of blockchain and in

256
00:16:06,300 --> 00:16:12,449
the analysis of December of 2013 they

257
00:16:09,360 --> 00:16:16,140
managed to extract 60 million resections

258
00:16:12,450 --> 00:16:19,380
and 12 millions public is that is 12

259
00:16:16,140 --> 00:16:21,569
millions of Bitcoin addresses and when

260
00:16:19,380 --> 00:16:25,410
they did clustering based on the method

261
00:16:21,570 --> 00:16:30,180
I set on previous slide they managed to

262
00:16:25,410 --> 00:16:36,329
produce 5.5 million of clusters and when

263
00:16:30,180 --> 00:16:42,089
they combine clusters using using the

264
00:16:36,330 --> 00:16:44,820
third method they end up with two

265
00:16:42,090 --> 00:16:50,580
thousand clusters less which is not

266
00:16:44,820 --> 00:16:53,130
something but but there there was for

267
00:16:50,580 --> 00:16:57,270
example a lot of clusters that were type

268
00:16:53,130 --> 00:17:00,960
2 then main crypto crypto currency

269
00:16:57,270 --> 00:17:04,470
exchange empty box and that they

270
00:17:00,960 --> 00:17:08,189
excluded so-called sync addresses for

271
00:17:04,470 --> 00:17:15,750
this from this clustering sync addresses

272
00:17:08,189 --> 00:17:20,069
are our addresses that that on some

273
00:17:15,750 --> 00:17:25,910
bitcoins and those bitcoins haven't been

274
00:17:20,069 --> 00:17:32,700
spent since 2011 so two years after

275
00:17:25,910 --> 00:17:35,430
Bitcoin was invented so though those

276
00:17:32,700 --> 00:17:39,170
addresses are belonging to users that

277
00:17:35,430 --> 00:17:43,140
was a part of Bitcoin experiment and

278
00:17:39,170 --> 00:17:45,330
actually they probably thought that it

279
00:17:43,140 --> 00:17:50,190
will it will never worth anything so

280
00:17:45,330 --> 00:17:54,570
they just lost their wallets and add at

281
00:17:50,190 --> 00:17:57,299
that point in December 2013 sixty-four

282
00:17:54,570 --> 00:17:59,489
percent of all bitcoins

283
00:17:57,299 --> 00:18:03,450
were actually in sync addresses so

284
00:17:59,489 --> 00:18:06,389
unable to use so in circulation was only

285
00:18:03,450 --> 00:18:12,559
like thirty six percent and now is in

286
00:18:06,389 --> 00:18:17,119
circulation about sixty percent okay so

287
00:18:12,559 --> 00:18:19,980
there are some privacy recommendations

288
00:18:17,119 --> 00:18:25,129
taking into account that everybody is

289
00:18:19,980 --> 00:18:28,019
aware that the animation is possible so

290
00:18:25,129 --> 00:18:31,408
use new addresses to receive payments

291
00:18:28,019 --> 00:18:37,489
this recommendation is there to enable

292
00:18:31,409 --> 00:18:41,779
somebody to see to see what types of

293
00:18:37,489 --> 00:18:45,269
what types of transacting you are doing

294
00:18:41,779 --> 00:18:48,480
other one is to use multiple bullets for

295
00:18:45,269 --> 00:18:50,999
different purposes so if if somebody

296
00:18:48,480 --> 00:18:54,299
enforces this privacy recommendations in

297
00:18:50,999 --> 00:19:00,169
that case i'm unable to i'm unable to

298
00:18:54,299 --> 00:19:03,119
expand the cluster quickly and third one

299
00:19:00,169 --> 00:19:07,109
which is the most important one bitcoin

300
00:19:03,119 --> 00:19:09,119
address should be only used once that

301
00:19:07,109 --> 00:19:12,749
means that whenever you are paying

302
00:19:09,119 --> 00:19:16,379
something and you have leftover that

303
00:19:12,749 --> 00:19:19,470
leftover you should you should pay to

304
00:19:16,379 --> 00:19:24,809
newly generated address and not to

305
00:19:19,470 --> 00:19:27,210
already existing one why is that why is

306
00:19:24,809 --> 00:19:30,749
that important so if you if you have

307
00:19:27,210 --> 00:19:33,210
change and you return you return change

308
00:19:30,749 --> 00:19:36,659
to your own address then it is obvious

309
00:19:33,210 --> 00:19:41,269
from the picture from the picture then

310
00:19:36,659 --> 00:19:44,100
it is obvious that a paid be and if you

311
00:19:41,269 --> 00:19:47,429
in the case if you if you if you paid

312
00:19:44,100 --> 00:19:51,149
something to to to party then it is

313
00:19:47,429 --> 00:19:56,100
obvious that you paid to B and C but if

314
00:19:51,149 --> 00:19:58,969
you use the newly generated address so

315
00:19:56,100 --> 00:20:02,668
in the in the second row first picture

316
00:19:58,970 --> 00:20:07,960
then it is not it is not obvious if you

317
00:20:02,669 --> 00:20:12,020
if you paid to to Bitcoin address B or C

318
00:20:07,960 --> 00:20:14,930
and even further if you if you use the

319
00:20:12,020 --> 00:20:18,560
same privacy recommendation and then

320
00:20:14,930 --> 00:20:21,350
from your change see you pay to to to

321
00:20:18,560 --> 00:20:23,750
party d and leftover is e from the

322
00:20:21,350 --> 00:20:28,100
perspective of somebody he doesn't have

323
00:20:23,750 --> 00:20:31,400
any clue who is who is the player who is

324
00:20:28,100 --> 00:20:37,040
to pay so that is the most important

325
00:20:31,400 --> 00:20:43,550
recommendation and it is possible to go

326
00:20:37,040 --> 00:20:45,620
again sir and this the same researchers

327
00:20:43,550 --> 00:20:48,980
from University of California managed to

328
00:20:45,620 --> 00:20:51,919
actually to add change address to the

329
00:20:48,980 --> 00:20:56,260
inputs no matter it is so much it is so

330
00:20:51,920 --> 00:20:59,750
much hard to recognize so basically

331
00:20:56,260 --> 00:21:03,650
there is there is multiple multiple

332
00:20:59,750 --> 00:21:07,730
types of change handling methods that

333
00:21:03,650 --> 00:21:10,960
wallet software are implementing and but

334
00:21:07,730 --> 00:21:14,260
but basically they are they're all

335
00:21:10,960 --> 00:21:17,300
they're all following same policy that

336
00:21:14,260 --> 00:21:21,650
change is always added to newly

337
00:21:17,300 --> 00:21:23,270
generated address and user can user can

338
00:21:21,650 --> 00:21:26,570
turn off that option which is not good

339
00:21:23,270 --> 00:21:28,780
for him because then is easy to to

340
00:21:26,570 --> 00:21:34,010
recognize the change address obviously

341
00:21:28,780 --> 00:21:36,620
so there is no any exact algorithm how

342
00:21:34,010 --> 00:21:39,740
to recognize change address but there

343
00:21:36,620 --> 00:21:42,830
were there were some efforts first

344
00:21:39,740 --> 00:21:45,830
efforts was to use the fact that user

345
00:21:42,830 --> 00:21:48,230
really issued transactions to two

346
00:21:45,830 --> 00:21:50,929
different users and this is completely

347
00:21:48,230 --> 00:21:55,040
obsolete now because for example on

348
00:21:50,930 --> 00:21:58,100
gambling sites where you have game that

349
00:21:55,040 --> 00:22:01,460
wins multiple people then they are

350
00:21:58,100 --> 00:22:06,169
making payouts to to multiple persons so

351
00:22:01,460 --> 00:22:09,020
you can't use that fact the second the

352
00:22:06,170 --> 00:22:13,160
second fact change address amount is not

353
00:22:09,020 --> 00:22:15,260
greater than lowest input amount now

354
00:22:13,160 --> 00:22:19,380
this is

355
00:22:15,260 --> 00:22:21,390
to see illogical because if change

356
00:22:19,380 --> 00:22:24,750
address amount is greater than lowest

357
00:22:21,390 --> 00:22:27,890
input amount then it means that you

358
00:22:24,750 --> 00:22:30,960
could execute that payment without that

359
00:22:27,890 --> 00:22:34,380
lowest input amount but well it's

360
00:22:30,960 --> 00:22:36,570
authors are aware of that and their

361
00:22:34,380 --> 00:22:42,140
office getting that in the way that they

362
00:22:36,570 --> 00:22:45,480
are always always using the shame of

363
00:22:42,140 --> 00:22:48,150
taking the set of input addresses in

364
00:22:45,480 --> 00:22:52,320
such a way that you can't use this dis

365
00:22:48,150 --> 00:22:55,080
approach and the third one heuristic

366
00:22:52,320 --> 00:22:59,780
approach is change address is used only

367
00:22:55,080 --> 00:23:04,290
in one output overall pass transactions

368
00:22:59,780 --> 00:23:10,370
this is the actual the best approach and

369
00:23:04,290 --> 00:23:14,850
only one that can be used nowadays so if

370
00:23:10,370 --> 00:23:21,120
if the change address is used only only

371
00:23:14,850 --> 00:23:23,399
once is use only if change if change

372
00:23:21,120 --> 00:23:25,879
addresses use only one output over all

373
00:23:23,400 --> 00:23:30,150
pass transaction that means that

374
00:23:25,880 --> 00:23:32,520
actually the you are you are tracing you

375
00:23:30,150 --> 00:23:36,690
are tracing this this third privacy

376
00:23:32,520 --> 00:23:40,410
recommendation but a question is is it

377
00:23:36,690 --> 00:23:44,850
safe because maybe somebody made payment

378
00:23:40,410 --> 00:23:47,580
to someone who still didn't do any drugs

379
00:23:44,850 --> 00:23:53,100
acting at all so that is the only

380
00:23:47,580 --> 00:23:56,820
problem in this approach so now we're

381
00:23:53,100 --> 00:24:00,870
going to see results of change address

382
00:23:56,820 --> 00:24:05,668
heuristic that that took the third the

383
00:24:00,870 --> 00:24:07,979
third approach so edge to input list all

384
00:24:05,669 --> 00:24:11,299
addresses that is used only once it

385
00:24:07,980 --> 00:24:14,790
output overall past transactions and

386
00:24:11,299 --> 00:24:17,970
this kind of experiment resulted in four

387
00:24:14,790 --> 00:24:21,690
million change addresses and it was

388
00:24:17,970 --> 00:24:23,909
thirteen percent of false positives they

389
00:24:21,690 --> 00:24:26,250
managed to recognize false positives

390
00:24:23,909 --> 00:24:28,220
based on the fact that when you are

391
00:24:26,250 --> 00:24:30,600
looking into blockchain

392
00:24:28,220 --> 00:24:33,680
when when you are looking into block

393
00:24:30,600 --> 00:24:37,500
chain in one point in the time all

394
00:24:33,680 --> 00:24:40,080
transactions that are up in the in the

395
00:24:37,500 --> 00:24:43,110
in the blocks are actually read sections

396
00:24:40,080 --> 00:24:46,290
that took place in the future so you can

397
00:24:43,110 --> 00:24:48,209
see if that output address was actually

398
00:24:46,290 --> 00:24:54,810
used again if yes that means you have

399
00:24:48,210 --> 00:24:59,580
false positive but when the when they

400
00:24:54,810 --> 00:25:02,790
started to to to take a better look of

401
00:24:59,580 --> 00:25:04,800
those false positives they under stay

402
00:25:02,790 --> 00:25:08,159
managed to understand that twelve

403
00:25:04,800 --> 00:25:12,120
percent of those addresses were actually

404
00:25:08,160 --> 00:25:15,530
paid back addresses so it was used by

405
00:25:12,120 --> 00:25:19,229
the service that is that is paying back

406
00:25:15,530 --> 00:25:23,010
the money on the on the same address get

407
00:25:19,230 --> 00:25:26,070
you use to two by two by whatever that

408
00:25:23,010 --> 00:25:28,440
service is offering so it turns out that

409
00:25:26,070 --> 00:25:32,100
actually it is only one percent of false

410
00:25:28,440 --> 00:25:34,880
positives and if they they try to

411
00:25:32,100 --> 00:25:38,280
further it with some improvements and

412
00:25:34,880 --> 00:25:40,020
they actually try to wait for one day so

413
00:25:38,280 --> 00:25:43,470
they can see if the address will be used

414
00:25:40,020 --> 00:25:45,330
again and in that way they reduce false

415
00:25:43,470 --> 00:25:48,300
positives to zero point twenty eight

416
00:25:45,330 --> 00:25:50,280
percent in one week if they wait for one

417
00:25:48,300 --> 00:25:54,629
week they reduced to zero point seventy

418
00:25:50,280 --> 00:25:57,030
percent but even with zero point seventy

419
00:25:54,630 --> 00:26:01,800
percent they end up with mega cluster

420
00:25:57,030 --> 00:26:06,030
retaining all these services so what

421
00:26:01,800 --> 00:26:09,000
happened is that there was a few of

422
00:26:06,030 --> 00:26:12,030
addresses that managed to link clusters

423
00:26:09,000 --> 00:26:14,520
together and they were actually not

424
00:26:12,030 --> 00:26:17,480
change addresses so you have complete

425
00:26:14,520 --> 00:26:23,300
disaster only because of few addresses

426
00:26:17,480 --> 00:26:26,430
but then they they actually took another

427
00:26:23,300 --> 00:26:28,440
another view on the on those specific

428
00:26:26,430 --> 00:26:31,590
addresses and what happened with them

429
00:26:28,440 --> 00:26:36,270
and they realized that some addresses

430
00:26:31,590 --> 00:26:39,899
were used twice as twice two times

431
00:26:36,270 --> 00:26:43,149
exchange which is completely

432
00:26:39,899 --> 00:26:48,070
not something what would you will not

433
00:26:43,149 --> 00:26:51,968
see every day and so they excluded those

434
00:26:48,070 --> 00:26:54,729
case and they end up with 3.5 million of

435
00:26:51,969 --> 00:27:00,239
change addresses there was no mega

436
00:26:54,729 --> 00:27:00,239
clusters again and they managed to tag

437
00:27:00,330 --> 00:27:10,049
to talk two thousand and 197 clusters

438
00:27:06,309 --> 00:27:13,330
which is eight point one point eight

439
00:27:10,049 --> 00:27:16,059
million addresses and they started with

440
00:27:13,330 --> 00:27:18,869
1000 of target addresses so with the

441
00:27:16,059 --> 00:27:25,749
approach of collecting addresses from

442
00:27:18,869 --> 00:27:29,408
from forums of active pinging of the

443
00:27:25,749 --> 00:27:32,889
collecting tags from blockchain fo you

444
00:27:29,409 --> 00:27:37,210
are able they collect 1,000 of Doug

445
00:27:32,889 --> 00:27:40,809
addresses they end up with one thousand

446
00:27:37,210 --> 00:27:44,619
eight hundred times more so it's really

447
00:27:40,809 --> 00:27:51,009
good result how this can help me in my

448
00:27:44,619 --> 00:27:54,070
work so basically I hardly doubt that I

449
00:27:51,009 --> 00:27:59,109
will we dis method directly the

450
00:27:54,070 --> 00:28:03,369
anonymize the the the adversary did the

451
00:27:59,109 --> 00:28:07,799
attacker the the criminal but what what

452
00:28:03,369 --> 00:28:12,580
is possible is to is to find rejections

453
00:28:07,799 --> 00:28:15,509
where for example crypto currency

454
00:28:12,580 --> 00:28:18,309
exchange made the direct payment to

455
00:28:15,509 --> 00:28:21,639
today to their criminal of all the

456
00:28:18,309 --> 00:28:28,029
criminal did direct payments to to

457
00:28:21,639 --> 00:28:30,488
exchange if there is investigation open

458
00:28:28,029 --> 00:28:33,369
about this case in Croatia then I can

459
00:28:30,489 --> 00:28:37,769
with the effort to flow for law

460
00:28:33,369 --> 00:28:40,830
enforcement agencies I can basically

461
00:28:37,769 --> 00:28:44,259
catch the attacker in in in that way but

462
00:28:40,830 --> 00:28:47,339
without investigation I am probably not

463
00:28:44,259 --> 00:28:47,339
able to do anything

464
00:28:48,260 --> 00:28:54,500
okay so that will be that will be it for

465
00:28:55,370 --> 00:28:59,610
transaction graph analysis now I'm going

466
00:28:58,590 --> 00:29:01,949
to tell you something more about

467
00:28:59,610 --> 00:29:06,949
real-time network analysis which is I

468
00:29:01,950 --> 00:29:06,950
think more more interesting excuse me

469
00:29:11,190 --> 00:29:18,030
so real-time network analysis it's

470
00:29:15,450 --> 00:29:21,510
basically methods to linking Bitcoin

471
00:29:18,030 --> 00:29:23,310
addresses to IP addresses so this is

472
00:29:21,510 --> 00:29:26,070
something different than leaking Bitcoin

473
00:29:23,310 --> 00:29:32,220
addresses to some tags find find on

474
00:29:26,070 --> 00:29:34,830
internet this method is possible to

475
00:29:32,220 --> 00:29:37,290
distinguish different users even if they

476
00:29:34,830 --> 00:29:40,439
are behind network address translators

477
00:29:37,290 --> 00:29:46,470
so if you have multiple Bitcoin clients

478
00:29:40,440 --> 00:29:50,070
behind behind not this method is able to

479
00:29:46,470 --> 00:29:53,730
to label to label different different

480
00:29:50,070 --> 00:29:58,290
clients even if they using same public

481
00:29:53,730 --> 00:30:04,020
IP address i will i will say later why's

482
00:29:58,290 --> 00:30:07,620
that possible and method is able to link

483
00:30:04,020 --> 00:30:10,020
different reactions to same user even if

484
00:30:07,620 --> 00:30:13,260
they look completely unrelated in

485
00:30:10,020 --> 00:30:17,400
transaction graph analysis so if i was

486
00:30:13,260 --> 00:30:21,360
unable to to link some addresses in the

487
00:30:17,400 --> 00:30:24,680
transaction graph analysis real-time

488
00:30:21,360 --> 00:30:29,149
network analysis can do it so basically

489
00:30:24,680 --> 00:30:33,120
real-time network analysis is can

490
00:30:29,150 --> 00:30:36,120
enhance the the transaction graph

491
00:30:33,120 --> 00:30:37,860
analysis ok so what is the problem

492
00:30:36,120 --> 00:30:41,520
problem is of course using a proxy

493
00:30:37,860 --> 00:30:45,209
because then you do not the undie

494
00:30:41,520 --> 00:30:47,550
anonymize the the actual IP address of

495
00:30:45,210 --> 00:30:53,760
user but you DNT anonymize the IP

496
00:30:47,550 --> 00:30:56,909
address of proxy and actually there is a

497
00:30:53,760 --> 00:31:00,780
solution for that and that is to simply

498
00:30:56,910 --> 00:31:04,080
shut down bitcoin overt or functionality

499
00:31:00,780 --> 00:31:06,410
so i know that it sounds amazing but

500
00:31:04,080 --> 00:31:11,460
actually it is possible to do you can

501
00:31:06,410 --> 00:31:14,190
shut down the whole Tor network and it

502
00:31:11,460 --> 00:31:16,950
is it is quite simple to to be used by

503
00:31:14,190 --> 00:31:22,200
any users and i will explain that in the

504
00:31:16,950 --> 00:31:26,520
moment so actually we need this we need

505
00:31:22,200 --> 00:31:28,590
is this shut down so we can observe the

506
00:31:26,520 --> 00:31:31,740
real-time network analysis on cleanit

507
00:31:28,590 --> 00:31:39,090
like there is there is no anonymization

508
00:31:31,740 --> 00:31:41,550
techniques used bitcoin is fear to be a

509
00:31:39,090 --> 00:31:48,720
network but actually we could use we

510
00:31:41,550 --> 00:31:53,430
could we could share the the the peers

511
00:31:48,720 --> 00:31:55,920
into different categories when is the

512
00:31:53,430 --> 00:31:58,080
peers that our clients and other the

513
00:31:55,920 --> 00:32:00,420
peers let our servers i put under the

514
00:31:58,080 --> 00:32:03,290
the codes because it is not really

515
00:32:00,420 --> 00:32:07,800
client-server architecture but rather

516
00:32:03,290 --> 00:32:11,040
the thing is that clients are the peers

517
00:32:07,800 --> 00:32:14,330
that are able only to initiate outgoing

518
00:32:11,040 --> 00:32:18,930
connections so those are home users and

519
00:32:14,330 --> 00:32:23,370
servers are peers that are able to

520
00:32:18,930 --> 00:32:26,640
receive incoming connections and each

521
00:32:23,370 --> 00:32:29,879
beer whether use whether server or

522
00:32:26,640 --> 00:32:34,260
client is trying to connect to eight

523
00:32:29,880 --> 00:32:38,610
entry nodes so bitcoin have network

524
00:32:34,260 --> 00:32:41,970
discovery mechanism that is used for

525
00:32:38,610 --> 00:32:46,500
each for each client to to be connected

526
00:32:41,970 --> 00:32:49,530
to eight entry nodes entry nodes are of

527
00:32:46,500 --> 00:32:52,890
course always servers because clients

528
00:32:49,530 --> 00:32:56,670
can't see each other so basically a

529
00:32:52,890 --> 00:32:59,940
bitcoin does not use any natural

530
00:32:56,670 --> 00:33:03,800
versatile technique but clients can

531
00:32:59,940 --> 00:33:06,930
reach each other across the servers and

532
00:33:03,800 --> 00:33:13,919
what is what is important to remark that

533
00:33:06,930 --> 00:33:16,140
is that servers can take at maximum 117

534
00:33:13,920 --> 00:33:21,420
incoming connect connections from from

535
00:33:16,140 --> 00:33:24,480
clients and and everybody is initiating

536
00:33:21,420 --> 00:33:28,620
eight outgoing connections so in total

537
00:33:24,480 --> 00:33:29,900
there is 125 connections possible for

538
00:33:28,620 --> 00:33:37,639
each beer

539
00:33:29,900 --> 00:33:40,400
in this case only four servers so how is

540
00:33:37,640 --> 00:33:43,370
possible to distinguish the clients with

541
00:33:40,400 --> 00:33:45,940
behind not it is possible because this

542
00:33:43,370 --> 00:33:55,250
approach of real-time network analysis

543
00:33:45,940 --> 00:33:58,340
is is actually labeling clients in the

544
00:33:55,250 --> 00:34:03,250
way that it is it associated it

545
00:33:58,340 --> 00:34:06,649
associates clients with each entry nodes

546
00:34:03,250 --> 00:34:11,270
so every every every client in this in

547
00:34:06,650 --> 00:34:21,490
this technique is presented as its entry

548
00:34:11,270 --> 00:34:26,168
nodes okay and just information that

549
00:34:21,489 --> 00:34:31,149
currently there is 8000 servers and the

550
00:34:26,168 --> 00:34:34,489
100,000 of clients in the network okay

551
00:34:31,149 --> 00:34:38,929
so how to disconnect tour and in that

552
00:34:34,489 --> 00:34:42,918
way actually have to say a clear

553
00:34:38,929 --> 00:34:47,389
situation of dealing with with real-time

554
00:34:42,918 --> 00:34:50,509
analysis on planet disconnecting tour is

555
00:34:47,389 --> 00:34:53,779
possible by exploiting bitcoins does

556
00:34:50,510 --> 00:34:57,160
protection building does protection so

557
00:34:53,780 --> 00:35:00,640
basically when one peer is delivering

558
00:34:57,160 --> 00:35:04,460
malformed messages to some other peer

559
00:35:00,640 --> 00:35:06,589
that other peer is banning him for 24

560
00:35:04,460 --> 00:35:08,720
hours so he is cutting connection for

561
00:35:06,590 --> 00:35:14,180
with him and he is not allowing him to

562
00:35:08,720 --> 00:35:16,430
establish another connection so now I'm

563
00:35:14,180 --> 00:35:18,649
talking from the perspective of attacker

564
00:35:16,430 --> 00:35:21,819
actually I will be attacker when I will

565
00:35:18,650 --> 00:35:24,710
be doing this and the anonymous a shin

566
00:35:21,820 --> 00:35:28,640
attacker needs to to establish

567
00:35:24,710 --> 00:35:31,520
connection so first to say in this in

568
00:35:28,640 --> 00:35:33,830
this scenario I'm observing that there

569
00:35:31,520 --> 00:35:38,259
is only two exit nodes into our network

570
00:35:33,830 --> 00:35:43,210
and only three Bitcoin servers so

571
00:35:38,260 --> 00:35:49,330
attacker is establishing connection with

572
00:35:43,210 --> 00:35:52,500
each server and sending a sanic

573
00:35:49,330 --> 00:36:00,670
malformed message and he is doing so

574
00:35:52,500 --> 00:36:04,270
going through each of exit nodes so in

575
00:36:00,670 --> 00:36:10,540
this way you have the situation that all

576
00:36:04,270 --> 00:36:14,140
servers banned all IP addresses of exit

577
00:36:10,540 --> 00:36:18,250
nodes and now when when when we are

578
00:36:14,140 --> 00:36:22,540
looking the plans of the the client part

579
00:36:18,250 --> 00:36:25,660
of Bitcoin network and if they are if

580
00:36:22,540 --> 00:36:27,640
they try to connect to to to network

581
00:36:25,660 --> 00:36:31,569
using tor that they will be unable to do

582
00:36:27,640 --> 00:36:34,598
it for the next 24 hours because all

583
00:36:31,570 --> 00:36:40,599
servers are banned through all possible

584
00:36:34,599 --> 00:36:43,420
exit nodes and I was watching recently

585
00:36:40,599 --> 00:36:47,650
at store metrics there is around 1000 of

586
00:36:43,420 --> 00:36:50,410
tor exit nodes and times a thousand

587
00:36:47,650 --> 00:36:53,530
Bitcoin servers you get that you need to

588
00:36:50,410 --> 00:36:56,379
upload one gigabyte of traffic of

589
00:36:53,530 --> 00:37:01,089
malformed messages actually to exclude

590
00:36:56,380 --> 00:37:10,440
all Tor network from usage for the

591
00:37:01,089 --> 00:37:14,470
Bitcoin okay so first first part of

592
00:37:10,440 --> 00:37:18,670
first part of real-time network the

593
00:37:14,470 --> 00:37:22,270
anonymization is to learn entry notes of

594
00:37:18,670 --> 00:37:25,140
clients to do so I need to explain

595
00:37:22,270 --> 00:37:28,180
something about Ed address propagation

596
00:37:25,140 --> 00:37:31,770
mechanism that is part of natural

597
00:37:28,180 --> 00:37:36,310
discovery protocol in the in the Bitcoin

598
00:37:31,770 --> 00:37:38,470
so what you say dress propagation it is

599
00:37:36,310 --> 00:37:42,160
basically the mechanism that that is

600
00:37:38,470 --> 00:37:48,250
making the network alive so nodes are

601
00:37:42,160 --> 00:37:50,230
all the time coming and going and coming

602
00:37:48,250 --> 00:37:54,010
to the network and go away from the

603
00:37:50,230 --> 00:37:55,670
network and basically the Pearce needs

604
00:37:54,010 --> 00:37:58,369
to learn

605
00:37:55,670 --> 00:38:00,920
all the time which which are nodes

606
00:37:58,369 --> 00:38:03,980
available so if their entry nodes are

607
00:38:00,920 --> 00:38:06,920
lived if their network nodes leave the

608
00:38:03,980 --> 00:38:15,079
network they are managing to find

609
00:38:06,920 --> 00:38:18,650
another entry nodes addr message is a

610
00:38:15,079 --> 00:38:24,109
message that every beer sends to each of

611
00:38:18,650 --> 00:38:27,619
its connections after after after the

612
00:38:24,109 --> 00:38:33,950
pier connected to the network so every

613
00:38:27,619 --> 00:38:37,400
of his entry node is aware of of of it

614
00:38:33,950 --> 00:38:41,868
address and those entry nodes are

615
00:38:37,400 --> 00:38:44,960
propagating further in the network addr

616
00:38:41,869 --> 00:38:47,869
messages so basically in the matter of

617
00:38:44,960 --> 00:38:51,770
few seconds you have plenty of nodes in

618
00:38:47,869 --> 00:38:55,369
the network that are aware of new of new

619
00:38:51,770 --> 00:38:57,680
clients that that approach to to the

620
00:38:55,369 --> 00:39:04,130
network that made connection to to the

621
00:38:57,680 --> 00:39:06,710
entry nodes there is there is one detail

622
00:39:04,130 --> 00:39:14,540
that is that is very very important and

623
00:39:06,710 --> 00:39:19,760
that is that others are propagated in

624
00:39:14,540 --> 00:39:23,410
the way that always is used to

625
00:39:19,760 --> 00:39:28,280
responsible nodes each each node is

626
00:39:23,410 --> 00:39:32,799
choosing to responsible nodes that will

627
00:39:28,280 --> 00:39:36,260
receive the addr message and that will

628
00:39:32,799 --> 00:39:43,030
forward the the addr message further in

629
00:39:36,260 --> 00:39:46,040
the network and basically when one node

630
00:39:43,030 --> 00:39:50,030
propagates some addr message with with

631
00:39:46,040 --> 00:39:52,579
with IP address included he will not

632
00:39:50,030 --> 00:39:55,730
propagate over that connection addr

633
00:39:52,579 --> 00:39:58,850
message ever again so it happens only

634
00:39:55,730 --> 00:40:01,760
once ok

635
00:39:58,850 --> 00:40:04,250
okay I promise I will not go deeper than

636
00:40:01,760 --> 00:40:06,500
this this is technically the deepest

637
00:40:04,250 --> 00:40:10,570
thing of the presentation but i need to

638
00:40:06,500 --> 00:40:13,670
say in order to explain the the attack

639
00:40:10,570 --> 00:40:17,720
so how to how to choose responsible

640
00:40:13,670 --> 00:40:22,340
nodes so when some peer receive addr

641
00:40:17,720 --> 00:40:26,200
message he calculated hash for each for

642
00:40:22,340 --> 00:40:30,770
each peer he is connected to and heshes

643
00:40:26,200 --> 00:40:34,060
hashes the function of four variables

644
00:40:30,770 --> 00:40:37,790
and that is the address X that is inside

645
00:40:34,060 --> 00:40:40,900
addr message some random salt current

646
00:40:37,790 --> 00:40:45,350
day and the address of peer structure of

647
00:40:40,900 --> 00:40:49,040
the old appear that is that is candidate

648
00:40:45,350 --> 00:40:53,299
to be choose as responsible notes after

649
00:40:49,040 --> 00:40:57,710
that all hashes are sorted and first two

650
00:40:53,300 --> 00:41:00,410
hash are chosen to be the responsible to

651
00:40:57,710 --> 00:41:03,380
the responsible knows that the peers

652
00:41:00,410 --> 00:41:11,690
that are associated with to first hash

653
00:41:03,380 --> 00:41:14,570
when when heads are sorted okay so now

654
00:41:11,690 --> 00:41:18,890
now I'm going to explain how to learn

655
00:41:14,570 --> 00:41:21,680
entry nodes of some client see how the

656
00:41:18,890 --> 00:41:24,140
tech are able to learn those entry nodes

657
00:41:21,680 --> 00:41:27,109
in this very simple configuration where

658
00:41:24,140 --> 00:41:34,730
you have only five servers and only

659
00:41:27,110 --> 00:41:39,260
dozen of of clients so what attacker

660
00:41:34,730 --> 00:41:42,440
needs to do is maintain a very big

661
00:41:39,260 --> 00:41:48,710
number of connection with each server in

662
00:41:42,440 --> 00:41:52,580
the network this way when the client

663
00:41:48,710 --> 00:41:54,860
connects to to the network he chooses

664
00:41:52,580 --> 00:41:57,830
some entry notes for example this case

665
00:41:54,860 --> 00:42:03,470
client chooses entry notes two three and

666
00:41:57,830 --> 00:42:06,890
four now when client start to propagate

667
00:42:03,470 --> 00:42:10,580
its addr message with his IP address for

668
00:42:06,890 --> 00:42:12,259
other nodes to know for his existence it

669
00:42:10,580 --> 00:42:18,319
is to expected

670
00:42:12,260 --> 00:42:22,910
that node number two will choose will

671
00:42:18,320 --> 00:42:25,940
choose the attacker as responsible note

672
00:42:22,910 --> 00:42:37,250
that because the fact that we have a lot

673
00:42:25,940 --> 00:42:40,700
of connection of course so this way the

674
00:42:37,250 --> 00:42:44,300
attacker will receive addr message over

675
00:42:40,700 --> 00:42:46,910
over the entry notes of client c and

676
00:42:44,300 --> 00:42:50,510
then the attacker notes that client with

677
00:42:46,910 --> 00:42:55,790
with the address CA has entry knows 3 4

678
00:42:50,510 --> 00:43:01,040
5 2 3 4 sorry but what is the problem

679
00:42:55,790 --> 00:43:05,840
with this approach yes chances are big

680
00:43:01,040 --> 00:43:08,060
for attacker to be chosen as the as the

681
00:43:05,840 --> 00:43:10,970
responsible note because very big amount

682
00:43:08,060 --> 00:43:15,380
of connection but also there is a

683
00:43:10,970 --> 00:43:20,390
possibility that server choose some

684
00:43:15,380 --> 00:43:24,920
other node as responsible and he sends

685
00:43:20,390 --> 00:43:27,710
addr message to node 1 in this example

686
00:43:24,920 --> 00:43:31,730
and let's say attacker was lucky with

687
00:43:27,710 --> 00:43:34,250
other two and he received and he

688
00:43:31,730 --> 00:43:37,940
received addr message over notes three

689
00:43:34,250 --> 00:43:41,590
and four so we now have the problematic

690
00:43:37,940 --> 00:43:47,570
situation where attacker learned that

691
00:43:41,590 --> 00:43:53,450
address of client with with the address

692
00:43:47,570 --> 00:43:57,040
see a has entry nodes 1 3 & 4 when that

693
00:43:53,450 --> 00:44:01,629
is not a true he have entry nose 2 3 & 4

694
00:43:57,040 --> 00:44:05,330
so we have a false entry inside the

695
00:44:01,630 --> 00:44:09,400
inside the Associated list of of that IP

696
00:44:05,330 --> 00:44:09,400
address we are trying to the anonymize

697
00:44:10,470 --> 00:44:16,379
a solution to this problem is based on

698
00:44:14,099 --> 00:44:20,640
the fact that same address is never

699
00:44:16,380 --> 00:44:23,910
recent / same connection so the next

700
00:44:20,640 --> 00:44:28,950
strategy is proposed it is proposed for

701
00:44:23,910 --> 00:44:33,509
attacker to broadcast addr addr message

702
00:44:28,950 --> 00:44:39,810
of the address he want to d anonymize so

703
00:44:33,510 --> 00:44:42,380
that so that the responsible nodes which

704
00:44:39,810 --> 00:44:48,090
are which are not a tackles one are

705
00:44:42,380 --> 00:44:50,910
excluded it's hard to understand it

706
00:44:48,090 --> 00:44:53,730
bye-bye words so I'm going to show it in

707
00:44:50,910 --> 00:44:58,410
picture so basically attacker connects

708
00:44:53,730 --> 00:45:04,320
to all servers and he sends addr message

709
00:44:58,410 --> 00:45:07,348
of client c and servers are choosing

710
00:45:04,320 --> 00:45:09,900
responsible nodes in this case servers

711
00:45:07,349 --> 00:45:14,700
are having only one or two connection

712
00:45:09,900 --> 00:45:18,420
and therefore they will they will choose

713
00:45:14,700 --> 00:45:21,710
as responsible connections all the

714
00:45:18,420 --> 00:45:24,839
connections on the on the picture now

715
00:45:21,710 --> 00:45:26,420
the attacker disconnect and he connects

716
00:45:24,839 --> 00:45:33,109
again with a very big amount of

717
00:45:26,420 --> 00:45:38,339
connections to each server and now if

718
00:45:33,109 --> 00:45:43,529
server decides to to have a responsible

719
00:45:38,339 --> 00:45:48,750
node node one he will not be able to he

720
00:45:43,530 --> 00:45:51,450
will not be able to to send the idd our

721
00:45:48,750 --> 00:45:53,790
message over that connection because he

722
00:45:51,450 --> 00:45:57,330
already did so and he's never doing it

723
00:45:53,790 --> 00:46:00,720
twice as I said before so what is going

724
00:45:57,330 --> 00:46:05,430
to happen is that attacker is going to

725
00:46:00,720 --> 00:46:08,069
learn is going to learn entry nodes of

726
00:46:05,430 --> 00:46:12,359
the client but only the subset of entry

727
00:46:08,070 --> 00:46:15,089
nodes so he learned that that client

728
00:46:12,359 --> 00:46:20,839
with address see a have a subset of

729
00:46:15,089 --> 00:46:20,839
entry nose three and four now

730
00:46:22,150 --> 00:46:30,890
some meth why is still the Animas ation

731
00:46:28,460 --> 00:46:33,110
possible if we have situation that we

732
00:46:30,890 --> 00:46:39,290
are unable to learn all entry nodes of

733
00:46:33,110 --> 00:46:43,010
of some client we're basically peer can

734
00:46:39,290 --> 00:46:47,450
be uniquely identified if we know only

735
00:46:43,010 --> 00:46:51,770
three entry nodes and that is because it

736
00:46:47,450 --> 00:46:56,960
is very unlikely that you have collision

737
00:46:51,770 --> 00:47:00,980
of of two different of two different

738
00:46:56,960 --> 00:47:04,910
client having the same seven the same

739
00:47:00,980 --> 00:47:07,400
treatable subset of entry nodes so it is

740
00:47:04,910 --> 00:47:09,560
very unlikely so the conclusion is that

741
00:47:07,400 --> 00:47:12,320
you need only three entry nodes you need

742
00:47:09,560 --> 00:47:18,020
to learn only three entry nodes in order

743
00:47:12,320 --> 00:47:21,050
to 2d anonymize the de client another

744
00:47:18,020 --> 00:47:26,360
thing is that if you if you are able to

745
00:47:21,050 --> 00:47:32,020
maintain 35 connection to each server in

746
00:47:26,360 --> 00:47:35,570
that case you stand fifty percent chance

747
00:47:32,020 --> 00:47:40,790
to become the response responsible note

748
00:47:35,570 --> 00:47:43,550
and that addr message is forward toward

749
00:47:40,790 --> 00:47:47,029
over the attacker so that means that on

750
00:47:43,550 --> 00:47:50,120
average of eight entry nodes you will

751
00:47:47,030 --> 00:47:56,060
receive four addr messages and as I said

752
00:47:50,120 --> 00:47:59,980
the three NT nodes are enough how often

753
00:47:56,060 --> 00:48:05,480
to broadcast address experiment done on

754
00:47:59,980 --> 00:48:08,240
University of Luxembourg show that 10

755
00:48:05,480 --> 00:48:11,240
minutes seems to be reasonable choice so

756
00:48:08,240 --> 00:48:14,240
the first part of strategy when you need

757
00:48:11,240 --> 00:48:16,879
to broadcast the I ddr message that you

758
00:48:14,240 --> 00:48:21,709
are trying to that contain the address

759
00:48:16,880 --> 00:48:24,410
you are trying to do anonymize it's so

760
00:48:21,710 --> 00:48:29,670
resending of of that address is needed

761
00:48:24,410 --> 00:48:31,828
to be done each 10 minutes if you do it

762
00:48:29,670 --> 00:48:35,160
if you do it more rarely than that if

763
00:48:31,829 --> 00:48:38,430
you do it each 20 minutes you are

764
00:48:35,160 --> 00:48:41,730
putting yourself in situation that that

765
00:48:38,430 --> 00:48:43,618
that server can can change the

766
00:48:41,730 --> 00:48:46,440
responsible nodes and then you can again

767
00:48:43,619 --> 00:48:50,579
have the full century inside the inside

768
00:48:46,440 --> 00:48:56,670
the set okay so what do we have at this

769
00:48:50,579 --> 00:49:01,920
point at this point we have example as

770
00:48:56,670 --> 00:49:06,059
example we have we learned we learned

771
00:49:01,920 --> 00:49:08,790
entry nodes of three different of three

772
00:49:06,059 --> 00:49:11,940
different clients CAC be and CeCe and

773
00:49:08,790 --> 00:49:15,569
now is the question how to the Animas

774
00:49:11,940 --> 00:49:19,049
transaction so how to know if some

775
00:49:15,569 --> 00:49:25,140
transaction is belonging to node CA c b

776
00:49:19,049 --> 00:49:29,849
or c c well this the animation is

777
00:49:25,140 --> 00:49:33,390
possible thanks to thanks to next

778
00:49:29,849 --> 00:49:36,329
propositions client and attacker are

779
00:49:33,390 --> 00:49:39,839
connected with one hope over entry node

780
00:49:36,329 --> 00:49:42,930
so entry node is only one hope and all

781
00:49:39,839 --> 00:49:49,470
other connections between them are two

782
00:49:42,930 --> 00:49:51,598
hopes or more so it is it is reasonable

783
00:49:49,470 --> 00:49:54,618
to conclude that attacker will see

784
00:49:51,599 --> 00:49:59,130
transactions coming from entry node

785
00:49:54,619 --> 00:50:01,760
before then from any other of course

786
00:49:59,130 --> 00:50:06,210
this is the reasonable to conclude but

787
00:50:01,760 --> 00:50:09,480
for example network latency on the on

788
00:50:06,210 --> 00:50:13,380
the links of between the entry node and

789
00:50:09,480 --> 00:50:15,780
that end the end the client can be much

790
00:50:13,380 --> 00:50:18,390
bigger than over some other parcel

791
00:50:15,780 --> 00:50:22,470
network and in that case you may receive

792
00:50:18,390 --> 00:50:25,650
transaction before from some non entry

793
00:50:22,470 --> 00:50:28,078
node then from entry node of the client

794
00:50:25,650 --> 00:50:30,290
randomize the anonymize so that is the

795
00:50:28,079 --> 00:50:30,290
problem

796
00:50:31,550 --> 00:50:41,900
but let's just see what what are used

797
00:50:36,650 --> 00:50:44,120
for such thing to happen if if we

798
00:50:41,900 --> 00:50:46,490
observe the situation when client is

799
00:50:44,120 --> 00:50:51,680
directly connected to attacker through

800
00:50:46,490 --> 00:50:56,390
entry node then we have a situation that

801
00:50:51,680 --> 00:50:59,000
five messages needs to be exchanged 16

802
00:50:56,390 --> 00:51:01,700
checks needs to be done by by the entry

803
00:50:59,000 --> 00:51:05,720
node before he sends transaction further

804
00:51:01,700 --> 00:51:08,419
because every node is first checking the

805
00:51:05,720 --> 00:51:10,100
well is making the validation of

806
00:51:08,420 --> 00:51:13,940
transaction before checking it further

807
00:51:10,100 --> 00:51:15,950
and we have some random time that needs

808
00:51:13,940 --> 00:51:19,310
to do pass before the transaction in

809
00:51:15,950 --> 00:51:21,799
sent and if we have two hopes then we

810
00:51:19,310 --> 00:51:25,549
have eight messages 32 checks and two

811
00:51:21,800 --> 00:51:32,780
random trickling delays so basically it

812
00:51:25,550 --> 00:51:37,340
is it is to expect that we will receive

813
00:51:32,780 --> 00:51:40,010
the transaction before from from the

814
00:51:37,340 --> 00:51:46,160
clients entry node then from some other

815
00:51:40,010 --> 00:51:50,500
node okay and some final things for the

816
00:51:46,160 --> 00:51:52,750
anonymous ation how is it possible to be

817
00:51:50,500 --> 00:51:55,690
so

818
00:51:52,750 --> 00:51:58,030
I'm going to demonstrate example where

819
00:51:55,690 --> 00:52:01,150
we successfully the anonymized

820
00:51:58,030 --> 00:52:04,660
transaction transaction 1 and just to

821
00:52:01,150 --> 00:52:11,730
remember the entry no sets of clients

822
00:52:04,660 --> 00:52:15,160
EAC be and CeCe were as follows okay so

823
00:52:11,730 --> 00:52:17,860
we take first 15 transactions because we

824
00:52:15,160 --> 00:52:21,089
are expecting that between first 15

825
00:52:17,860 --> 00:52:24,940
transactions should be the entry nodes

826
00:52:21,090 --> 00:52:28,000
of the of the client that sent that

827
00:52:24,940 --> 00:52:33,460
transaction and when we are when we do

828
00:52:28,000 --> 00:52:39,550
intersection with with entry notes that

829
00:52:33,460 --> 00:52:42,850
we D anonymized we get situation that in

830
00:52:39,550 --> 00:52:46,750
the intersection have so big personality

831
00:52:42,850 --> 00:52:52,150
it's so big sets that it is and because

832
00:52:46,750 --> 00:52:53,560
if CA or CB or CC generated transaction

833
00:52:52,150 --> 00:52:56,440
so basically you can't know who

834
00:52:53,560 --> 00:53:00,940
generated because you took too much big

835
00:52:56,440 --> 00:53:05,080
to big set to bring set of of entry

836
00:53:00,940 --> 00:53:12,490
nodes and on the other side you can take

837
00:53:05,080 --> 00:53:14,529
very few of the nodes that first sent

838
00:53:12,490 --> 00:53:18,069
the transaction and then you have

839
00:53:14,530 --> 00:53:21,070
situation that intersection is very

840
00:53:18,070 --> 00:53:26,950
small in this case cardinality of each

841
00:53:21,070 --> 00:53:28,840
set is too so there is no enough there

842
00:53:26,950 --> 00:53:31,569
is no enough cardinality to distinguish

843
00:53:28,840 --> 00:53:34,510
client and I remember you that I said it

844
00:53:31,570 --> 00:53:40,120
is needed to it is needed three entry

845
00:53:34,510 --> 00:53:44,830
nodes it's near three entry nodes to to

846
00:53:40,120 --> 00:53:46,630
distinguish some client the same

847
00:53:44,830 --> 00:53:50,560
research from University look simple

848
00:53:46,630 --> 00:53:55,420
show that best balance is actually first

849
00:53:50,560 --> 00:53:58,930
ten first n nodes so if we take first 10

850
00:53:55,420 --> 00:54:01,540
notes from frost and notes from the

851
00:53:58,930 --> 00:54:05,049
ordered list from ordered list all the

852
00:54:01,540 --> 00:54:06,259
all the transactions we received we have

853
00:54:05,050 --> 00:54:10,160
situation that

854
00:54:06,260 --> 00:54:13,550
only address CA have cardinality of

855
00:54:10,160 --> 00:54:17,720
trees so note ca ca generated the

856
00:54:13,550 --> 00:54:20,750
transaction in this way we actually we

857
00:54:17,720 --> 00:54:30,189
actually managed to associate IP address

858
00:54:20,750 --> 00:54:32,600
with way the transaction okay so

859
00:54:30,190 --> 00:54:35,990
basically what what the guys from the

860
00:54:32,600 --> 00:54:41,000
Luxembourg did they set up a test net

861
00:54:35,990 --> 00:54:46,399
with 250 Bitcoin servers they wrote

862
00:54:41,000 --> 00:54:50,350
custom attacker client using the model

863
00:54:46,400 --> 00:54:54,650
that is available online writing in

864
00:54:50,350 --> 00:54:58,640
Google language and they use the

865
00:54:54,650 --> 00:55:01,430
standard Bitcoin core clients and from

866
00:54:58,640 --> 00:55:03,680
such experiment they from from any

867
00:55:01,430 --> 00:55:06,799
experiment they run they came up with

868
00:55:03,680 --> 00:55:09,950
the numbers that I just talked about so

869
00:55:06,800 --> 00:55:13,790
propagation of addr message h 10 minutes

870
00:55:09,950 --> 00:55:16,399
is enough account for only first 10

871
00:55:13,790 --> 00:55:18,620
notes to for a transaction entry entry

872
00:55:16,400 --> 00:55:20,840
notes for a notification is seen from

873
00:55:18,620 --> 00:55:24,620
the pure math it is not important to run

874
00:55:20,840 --> 00:55:28,010
experiments as a result they manage to D

875
00:55:24,620 --> 00:55:35,420
anonymize sixty percent of all

876
00:55:28,010 --> 00:55:40,640
transactions okay and using statistics

877
00:55:35,420 --> 00:55:42,950
for from such experiment using

878
00:55:40,640 --> 00:55:46,040
statistics for such experiment they

879
00:55:42,950 --> 00:55:47,990
actually calculated that successful the

880
00:55:46,040 --> 00:55:51,220
anonymization in a real Bitcoin network

881
00:55:47,990 --> 00:55:55,879
would be eleven percent in other words

882
00:55:51,220 --> 00:55:58,790
you should you should wait for for a

883
00:55:55,880 --> 00:56:01,730
client to send one average nine

884
00:55:58,790 --> 00:56:09,500
transaction to be able to the anonymous

885
00:56:01,730 --> 00:56:12,530
him how this can help me in my work so

886
00:56:09,500 --> 00:56:18,380
direct the Animas ation which is highly

887
00:56:12,530 --> 00:56:23,720
unlikely because that user is probably

888
00:56:18,380 --> 00:56:25,670
using tor and of course I can exclude

889
00:56:23,720 --> 00:56:28,640
tour but then is the question if he is

890
00:56:25,670 --> 00:56:33,350
going to transact at all in directly on

891
00:56:28,640 --> 00:56:36,759
animation so basically is somebody paid

892
00:56:33,350 --> 00:56:40,640
if I manage to the anonymize somebody

893
00:56:36,760 --> 00:56:45,500
who paid money to to to the to the

894
00:56:40,640 --> 00:56:51,200
person that I am looking for or vice

895
00:56:45,500 --> 00:56:53,530
versa and again I need to I need to have

896
00:56:51,200 --> 00:56:58,730
the assistance of law enforcement

897
00:56:53,530 --> 00:57:01,130
agencies for to come to informations

898
00:56:58,730 --> 00:57:03,470
about about those persons just based on

899
00:57:01,130 --> 00:57:09,290
the IP address and time stamp otherwise

900
00:57:03,470 --> 00:57:10,939
I can do anything and also in

901
00:57:09,290 --> 00:57:15,800
combination with transaction graph

902
00:57:10,940 --> 00:57:23,380
analysis real-time analysis can be very

903
00:57:15,800 --> 00:57:26,090
useful ok in just some final words so

904
00:57:23,380 --> 00:57:28,700
network real-time analysis requires IP

905
00:57:26,090 --> 00:57:31,520
address beforehand so basically I can't

906
00:57:28,700 --> 00:57:34,910
be unwise anything if I don't have the

907
00:57:31,520 --> 00:57:36,590
IP address already available so only

908
00:57:34,910 --> 00:57:39,589
thing only thing basically what i have

909
00:57:36,590 --> 00:57:45,380
is Bitcoin address of the of the

910
00:57:39,590 --> 00:57:48,100
criminal even if i know in in in which

911
00:57:45,380 --> 00:57:51,460
network he is situated i would need to

912
00:57:48,100 --> 00:57:56,080
advertise all IP range of that network

913
00:57:51,460 --> 00:57:56,080
just to be able to do naanum eyes him

914
00:57:57,070 --> 00:58:03,110
estimate a success rate of eleven

915
00:57:59,690 --> 00:58:07,910
percent for the animation is very poor

916
00:58:03,110 --> 00:58:12,230
and I mean it's very hard to expect

917
00:58:07,910 --> 00:58:14,799
somebody to send 99 transactions during

918
00:58:12,230 --> 00:58:14,800
one session

919
00:58:15,200 --> 00:58:24,520
and the 33rd thing is that I'm not

920
00:58:19,430 --> 00:58:26,960
really comfortable with comfortable with

921
00:58:24,520 --> 00:58:31,460
with doing so much connections on

922
00:58:26,960 --> 00:58:35,089
servers doing 35 connection to each

923
00:58:31,460 --> 00:58:38,660
server in Bitcoin network means the

924
00:58:35,089 --> 00:58:42,890
group aggregating its quality of service

925
00:58:38,660 --> 00:58:46,609
and I'm not really the person who would

926
00:58:42,890 --> 00:58:49,940
do such thing and as I said success rate

927
00:58:46,609 --> 00:58:52,970
is very poor however but I needed to do

928
00:58:49,940 --> 00:58:54,829
this this research in order just to to

929
00:58:52,970 --> 00:58:56,779
know what what are my where am i

930
00:58:54,829 --> 00:59:01,510
standing with is and what are my chances

931
00:58:56,780 --> 00:59:05,329
to do it and I thought it is it is very

932
00:59:01,510 --> 00:59:08,810
interesting theme to talk about but I

933
00:59:05,329 --> 00:59:12,349
think that I will stay on transaction

934
00:59:08,810 --> 00:59:14,839
graph analysis for for for the purpose

935
00:59:12,349 --> 00:59:16,880
of the anonymous ation and for sure

936
00:59:14,839 --> 00:59:20,450
argonaut I will not use this network

937
00:59:16,880 --> 00:59:28,190
approach so basically that is all thank

938
00:59:20,450 --> 00:59:30,759
you thank you very much come on Rick

939
00:59:28,190 --> 00:59:30,760
thank you

