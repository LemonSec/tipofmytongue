1
00:00:00,920 --> 00:00:06,600
bueno buenas tardes a todos me menedoza

2
00:00:04,410 --> 00:00:10,290
esta presentación que mas de tu lado

3
00:00:06,600 --> 00:00:12,480
come to a presentation cause so Reuters

4
00:00:10,290 --> 00:00:14,370
swords and shields it's a pleasure to be

5
00:00:12,480 --> 00:00:16,350
here at cyber camp and we like to any

6
00:00:14,370 --> 00:00:19,560
organization program for choosing our

7
00:00:16,350 --> 00:00:21,990
speech first of all would like to

8
00:00:19,560 --> 00:00:25,650
introduce herself amy vansant and my

9
00:00:21,990 --> 00:00:29,519
colleagues our host Antonio Navarro and

10
00:00:25,650 --> 00:00:34,050
we are a group of friends who started

11
00:00:29,519 --> 00:00:36,480
researching about root or Soho Soho just

12
00:00:34,050 --> 00:00:38,879
rejected several vulnerabilities on some

13
00:00:36,480 --> 00:00:42,930
of the most popular Reuters in Spain and

14
00:00:38,879 --> 00:00:47,129
this is peach Lisa summer with a few

15
00:00:42,930 --> 00:00:50,070
tips about experience we got first of

16
00:00:47,129 --> 00:00:52,589
all would like to show you how we focus

17
00:00:50,070 --> 00:00:54,420
thinking is split in three parts salt

18
00:00:52,590 --> 00:00:56,030
you start with where we talk about

19
00:00:54,420 --> 00:00:58,170
different attacks and the

20
00:00:56,030 --> 00:01:02,870
vulnerabilities we found and how we can

21
00:00:58,170 --> 00:01:02,870
exploit them the second part

22
00:01:02,950 --> 00:01:06,850
he's a part regarding shields where

23
00:01:04,959 --> 00:01:09,130
we're going to talk about what a user

24
00:01:06,850 --> 00:01:11,199
can do to put at him or herself above

25
00:01:09,130 --> 00:01:13,000
your tops good mentioning as well as

26
00:01:11,200 --> 00:01:17,500
immunization regarding vulnerabilities

27
00:01:13,000 --> 00:01:22,660
and last a third part called kiss okies

28
00:01:17,500 --> 00:01:26,380
rather we wanted to do a few tips and

29
00:01:22,660 --> 00:01:31,690
sum up the key elements regarding these

30
00:01:26,380 --> 00:01:33,460
devices so first of all we'll give you

31
00:01:31,690 --> 00:01:36,399
three short examples about real attack

32
00:01:33,460 --> 00:01:40,839
since our Reuters is wrong happen in

33
00:01:36,400 --> 00:01:45,900
Brazil is a very simple tank based on a

34
00:01:40,840 --> 00:01:49,760
script we can see on the top picture

35
00:01:45,900 --> 00:01:53,460
what it does is it exploits a

36
00:01:49,760 --> 00:01:56,250
vulnerability anger replaces the

37
00:01:53,460 --> 00:01:59,610
original DNS of the router by malicious

38
00:01:56,250 --> 00:02:01,770
Reuters and it has a dictionary to do so

39
00:01:59,610 --> 00:02:04,530
I don't know that you can see the image

40
00:02:01,770 --> 00:02:06,539
below well well here it uses the default

41
00:02:04,530 --> 00:02:11,160
credentials of the most popular Reuters

42
00:02:06,540 --> 00:02:14,510
followed by the configuration nobuta go

43
00:02:11,160 --> 00:02:17,420
with a link to modify these parameters

44
00:02:14,510 --> 00:02:24,540
and these second attacks very similar

45
00:02:17,420 --> 00:02:28,440
the main difference is that it's an

46
00:02:24,540 --> 00:02:30,630
attack that was done also in Brazil it

47
00:02:28,440 --> 00:02:36,060
affects mostly one of the most popular

48
00:02:30,630 --> 00:02:38,940
Brazilian ISPs this guy is very similar

49
00:02:36,060 --> 00:02:44,480
talk he changes the original DNS is by

50
00:02:38,940 --> 00:02:48,150
malicious Genesis to elaborate efficient

51
00:02:44,480 --> 00:02:51,060
you by coincidence the passwords are not

52
00:02:48,150 --> 00:02:55,050
the default ones

53
00:02:51,060 --> 00:02:57,959
the script itself requests the user to

54
00:02:55,050 --> 00:03:00,989
food the passwords which is one of the

55
00:02:57,959 --> 00:03:04,950
problems here there's another level of

56
00:03:00,989 --> 00:03:10,110
many of the users of these devices the

57
00:03:04,950 --> 00:03:15,238
third one is a war called moose it

58
00:03:10,110 --> 00:03:17,010
affects mostly lineups devices creating

59
00:03:15,239 --> 00:03:18,870
this whole process is trying to spread

60
00:03:17,010 --> 00:03:20,250
themselves and infecting new network

61
00:03:18,870 --> 00:03:22,440
elements after the infection is

62
00:03:20,250 --> 00:03:24,569
completed he does among in the middle

63
00:03:22,440 --> 00:03:27,810
attack to attacked all the cultures and

64
00:03:24,569 --> 00:03:30,720
possible credentials cookies and salami

65
00:03:27,810 --> 00:03:34,950
so these are sent to the malware i miss

66
00:03:30,720 --> 00:03:37,400
writer and you can also connect to an

67
00:03:34,950 --> 00:03:42,209
internet proxy

68
00:03:37,400 --> 00:03:44,730
to social networks to light certain

69
00:03:42,210 --> 00:03:49,770
videos that report and an economic

70
00:03:44,730 --> 00:03:52,140
profit to the malware author and

71
00:03:49,770 --> 00:03:57,050
regarding Reuters we also found some

72
00:03:52,140 --> 00:03:59,670
problems are quite typical that effect

73
00:03:57,050 --> 00:04:03,780
pretty much all devices first one is

74
00:03:59,670 --> 00:04:05,489
that they have lots of services of it in

75
00:04:03,780 --> 00:04:07,770
most cases are totally useless for a

76
00:04:05,490 --> 00:04:11,970
user because they don't get used and

77
00:04:07,770 --> 00:04:16,350
they're also not very safe so having so

78
00:04:11,970 --> 00:04:18,570
many surfaces crates of the attack

79
00:04:16,350 --> 00:04:21,000
exposures surface is higher because you

80
00:04:18,570 --> 00:04:24,030
have more vectors where the device may

81
00:04:21,000 --> 00:04:27,750
be vulnerable and some of the services

82
00:04:24,030 --> 00:04:30,929
are these ones we have telnet FTP twonky

83
00:04:27,750 --> 00:04:34,890
as a visa tries to share online I use it

84
00:04:30,930 --> 00:04:37,530
USB with network different computers the

85
00:04:34,890 --> 00:04:40,229
net USB is very similar but it gets in

86
00:04:37,530 --> 00:04:43,760
solving high-end routers Reuters all the

87
00:04:40,230 --> 00:04:46,940
upnp which is quite unsafe

88
00:04:43,760 --> 00:04:49,820
I secured by default some of you may

89
00:04:46,940 --> 00:04:52,870
think about a simple way of palliate in

90
00:04:49,820 --> 00:04:56,690
these problems at least regarding the

91
00:04:52,870 --> 00:04:58,070
safe or answer insecure services which

92
00:04:56,690 --> 00:05:01,900
means getting these services and

93
00:04:58,070 --> 00:05:01,900
replacing them by their mouth secure

94
00:05:01,990 --> 00:05:08,300
equivalent for example changing the ftp

95
00:05:05,810 --> 00:05:12,080
by a half st p

96
00:05:08,300 --> 00:05:14,870
and others we also find find another

97
00:05:12,080 --> 00:05:19,849
problem with default credentials in this

98
00:05:14,870 --> 00:05:22,280
chart you can see some of the google

99
00:05:19,849 --> 00:05:27,280
password we assess we can see a lot of

100
00:05:22,280 --> 00:05:29,690
1234 1234 arming harming very simple

101
00:05:27,280 --> 00:05:32,419
passwords that are not generated

102
00:05:29,690 --> 00:05:35,930
randomly so one could go just to google

103
00:05:32,419 --> 00:05:38,870
and look for a specific route or model

104
00:05:35,930 --> 00:05:41,360
and find a default password the problem

105
00:05:38,870 --> 00:05:44,180
here is not just the passwords are easy

106
00:05:41,360 --> 00:05:46,759
but also the lease on to the Father the

107
00:05:44,180 --> 00:05:49,250
most of the users who don't have direct

108
00:05:46,759 --> 00:05:52,039
knowledge all knowledge do not usually

109
00:05:49,250 --> 00:05:54,259
change these passwords so eventually it

110
00:05:52,039 --> 00:05:56,960
becomes a lot more simple to create

111
00:05:54,259 --> 00:06:00,860
attacks now in the credentials of the

112
00:05:56,960 --> 00:06:02,690
rotor itself but if you thought this was

113
00:06:00,860 --> 00:06:05,449
bad it gets even worse because we're not

114
00:06:02,690 --> 00:06:07,400
just having an account usually we get

115
00:06:05,449 --> 00:06:11,419
multiple the user accounts and these

116
00:06:07,400 --> 00:06:14,090
accounts you tend to be hidden the ISP

117
00:06:11,419 --> 00:06:15,500
sent to use them to give support but

118
00:06:14,090 --> 00:06:17,090
eventually the same thing happens all

119
00:06:15,500 --> 00:06:19,250
over again someone finds them they

120
00:06:17,090 --> 00:06:21,948
publish them on the Internet we can look

121
00:06:19,250 --> 00:06:24,139
for them in google and we need to know

122
00:06:21,949 --> 00:06:25,819
the credentials of these accounts so

123
00:06:24,139 --> 00:06:29,990
here we can see some examples just one

124
00:06:25,819 --> 00:06:32,840
two three four adsl body there's a bit

125
00:06:29,990 --> 00:06:37,150
of everything and the same thing happens

126
00:06:32,840 --> 00:06:40,239
here the user just change them

127
00:06:37,150 --> 00:06:43,599
and sometimes ever hit him so the user

128
00:06:40,240 --> 00:06:47,110
doesn't even know they're thou sometimes

129
00:06:43,600 --> 00:06:49,330
they can't even be changed directly so

130
00:06:47,110 --> 00:06:53,920
eventually we say is that the usability

131
00:06:49,330 --> 00:06:56,650
of the Soho Reuters and these four

132
00:06:53,920 --> 00:07:00,820
security administration is very far from

133
00:06:56,650 --> 00:07:02,440
an optimum level so let's begin talking

134
00:07:00,820 --> 00:07:05,849
about the first part i mentioned the

135
00:07:02,440 --> 00:07:07,960
swords we're going to expose our

136
00:07:05,850 --> 00:07:11,260
vulnerabilities and attacks affecting

137
00:07:07,960 --> 00:07:14,289
these devices first I'd like to speak

138
00:07:11,260 --> 00:07:16,450
about the bypass authentication which is

139
00:07:14,290 --> 00:07:19,870
not a tag based mostly on the father

140
00:07:16,450 --> 00:07:21,969
Allah Tucker can carry out tasks or

141
00:07:19,870 --> 00:07:23,860
certain changes in the router the router

142
00:07:21,970 --> 00:07:27,040
without needing any authentication

143
00:07:23,860 --> 00:07:31,510
process this attack may be done locally

144
00:07:27,040 --> 00:07:33,760
and remote but also remotely the effects

145
00:07:31,510 --> 00:07:39,449
mainly the web interface of the road of

146
00:07:33,760 --> 00:07:42,748
the router and Lisa due mainly to

147
00:07:39,449 --> 00:07:45,830
but assignation more elevation on the

148
00:07:42,749 --> 00:07:50,129
web's pivots and then we have other

149
00:07:45,830 --> 00:07:51,508
services just SMB or 2020 this is due to

150
00:07:50,129 --> 00:07:54,599
the fact that these services are not

151
00:07:51,509 --> 00:07:59,339
well configured to start I'd like to

152
00:07:54,599 --> 00:08:01,259
show your video well we'll see how is it

153
00:07:59,339 --> 00:08:04,110
is to detect these vulnerabilities in

154
00:08:01,259 --> 00:08:05,849
the web interface and exploiting this to

155
00:08:04,110 --> 00:08:08,809
carry out certain attacks such as age

156
00:08:05,849 --> 00:08:08,808
miles of service

157
00:08:16,130 --> 00:08:21,659
and what do we get here is a machine

158
00:08:19,590 --> 00:08:25,260
with a browser connected a rocket to a

159
00:08:21,660 --> 00:08:29,400
South a Rooter so we have login screen

160
00:08:25,260 --> 00:08:33,330
we're gonna have the credentials and

161
00:08:29,400 --> 00:08:36,569
this is like a normal book route I like

162
00:08:33,330 --> 00:08:38,190
the one you feel have how so here we can

163
00:08:36,570 --> 00:08:40,050
have the typical configuration please

164
00:08:38,190 --> 00:08:42,240
look at this because right now the

165
00:08:40,049 --> 00:08:45,240
security here is open and the name of

166
00:08:42,240 --> 00:08:50,300
the network is ESR and we'll see why

167
00:08:45,240 --> 00:08:53,390
next on the other hand will open a

168
00:08:50,300 --> 00:08:56,910
machine or we're going to ping the

169
00:08:53,390 --> 00:09:03,360
router IP to check the leads actually

170
00:08:56,910 --> 00:09:07,110
alive and working and next with a bottom

171
00:09:03,360 --> 00:09:10,460
we have on the left in red the restart

172
00:09:07,110 --> 00:09:12,570
button as a button until we saw the ruta

173
00:09:10,460 --> 00:09:19,500
although you need to be logged in before

174
00:09:12,570 --> 00:09:22,350
hand to do the open burp suite and

175
00:09:19,500 --> 00:09:24,990
housing interception model if you press

176
00:09:22,350 --> 00:09:27,720
the button we can see the capture the

177
00:09:24,990 --> 00:09:31,080
exact capture and here we can see it's

178
00:09:27,720 --> 00:09:35,400
an HTTP GET request the gas to the

179
00:09:31,080 --> 00:09:37,380
reroute info dot CGI resource is what

180
00:09:35,400 --> 00:09:40,430
we're sending when we saw the rule the

181
00:09:37,380 --> 00:09:44,270
router so we're going to copy that

182
00:09:40,430 --> 00:09:46,969
I'm going to drop the package because we

183
00:09:44,270 --> 00:09:52,699
don't want to recite it wont to do it

184
00:09:46,970 --> 00:09:56,810
when we love you okay next we delete the

185
00:09:52,700 --> 00:10:00,170
cachet we close any open sessions that

186
00:09:56,810 --> 00:10:09,199
we not logged onto the road reuter and

187
00:10:00,170 --> 00:10:13,839
on the right hand side on the corner

188
00:10:09,200 --> 00:10:16,430
below we can see a screen and we can

189
00:10:13,839 --> 00:10:20,540
paste the culture we've done and here we

190
00:10:16,430 --> 00:10:26,329
see the login screen and if we have copy

191
00:10:20,540 --> 00:10:29,829
the request to start with this spring is

192
00:10:26,330 --> 00:10:29,830
going to changes we'll see next

193
00:10:29,840 --> 00:10:35,720
happening here it says the Rueter is

194
00:10:32,030 --> 00:10:38,949
being resulted and we gradually we saw

195
00:10:35,720 --> 00:10:42,710
the router by being in the same network

196
00:10:38,950 --> 00:10:44,410
the lights are off and the attack has

197
00:10:42,710 --> 00:10:46,940
been completed it's a very simple talk

198
00:10:44,410 --> 00:10:48,920
and just with the simplest creators

199
00:10:46,940 --> 00:10:51,620
palms ease and sends these kind of

200
00:10:48,920 --> 00:10:56,560
requests it's all the time you could

201
00:10:51,620 --> 00:11:00,410
leave any sort of router without service

202
00:10:56,560 --> 00:11:03,079
next you may think well what happens if

203
00:11:00,410 --> 00:11:04,939
I change this request you made by a

204
00:11:03,080 --> 00:11:07,340
different one that may not being a

205
00:11:04,940 --> 00:11:11,030
butter what happens if we try hard

206
00:11:07,340 --> 00:11:18,860
sometimes ease works and we can just try

207
00:11:11,030 --> 00:11:22,280
with restore info which results and

208
00:11:18,860 --> 00:11:25,970
gives but the rotor is default value so

209
00:11:22,280 --> 00:11:29,930
but writing we told our team photo GGC I

210
00:11:25,970 --> 00:11:31,750
we can do that he will result in it so

211
00:11:29,930 --> 00:11:34,790
you don't have to see the whole attack I

212
00:11:31,750 --> 00:11:36,230
think after we going you could see this

213
00:11:34,790 --> 00:11:39,649
as we go down and look at the

214
00:11:36,230 --> 00:11:42,649
configuration mentioned earlier

215
00:11:39,649 --> 00:11:46,189
we can see that the VPI security has

216
00:11:42,649 --> 00:11:49,100
changed the SSID is now Vodafone and we

217
00:11:46,189 --> 00:11:50,899
can actually breathe through the value

218
00:11:49,100 --> 00:11:53,119
and the factory values and default

219
00:11:50,899 --> 00:11:55,009
values as well as the default

220
00:11:53,119 --> 00:11:57,399
credentials or our public can very

221
00:11:55,009 --> 00:11:57,399
simple

222
00:11:59,690 --> 00:12:05,370
so next I'd like to show you another

223
00:12:01,950 --> 00:12:06,990
video affecting the trunk service that

224
00:12:05,370 --> 00:12:10,320
offers users the possibility of

225
00:12:06,990 --> 00:12:13,590
connecting a USB to the router so that

226
00:12:10,320 --> 00:12:17,250
any user can modify it upload images on

227
00:12:13,590 --> 00:12:22,710
all them but the problem here is is not

228
00:12:17,250 --> 00:12:25,500
totally secure to bypass the service is

229
00:12:22,710 --> 00:12:28,770
necessary to have the router IP plah

230
00:12:25,500 --> 00:12:32,130
support in this case 9000 so we can have

231
00:12:28,770 --> 00:12:35,220
the rug taxes with surface in this case

232
00:12:32,130 --> 00:12:38,930
is a typical Spanish family that we

233
00:12:35,220 --> 00:12:42,930
humped we can actually see the process

234
00:12:38,930 --> 00:12:46,199
these are the dots documents very

235
00:12:42,930 --> 00:12:51,109
interesting if we keep looking at this

236
00:12:46,200 --> 00:12:54,900
we can also see these sons and fouled up

237
00:12:51,110 --> 00:12:57,240
and this is rendering this kind of

238
00:12:54,900 --> 00:13:00,090
vulnerable systems you can also have

239
00:12:57,240 --> 00:13:03,190
videos uploaded

240
00:13:00,090 --> 00:13:08,880
he could show the content and we could

241
00:13:03,190 --> 00:13:12,220
find any file that will be down and last

242
00:13:08,880 --> 00:13:15,040
it's also easy to impossible to upload

243
00:13:12,220 --> 00:13:17,020
our own content which can be dangerous

244
00:13:15,040 --> 00:13:19,870
but in this case will go to upload will

245
00:13:17,020 --> 00:13:22,860
get one of the wrong images will upload

246
00:13:19,870 --> 00:13:22,860
it to the system

247
00:13:26,950 --> 00:13:32,620
as you can see it's pretty simple to

248
00:13:29,540 --> 00:13:32,620
carry out this kind of stock

249
00:13:38,420 --> 00:13:43,110
well let's keep dealing with your tops

250
00:13:40,770 --> 00:13:46,800
and gonna tell you about a cross-site

251
00:13:43,110 --> 00:13:49,260
request forgery or attack and configure

252
00:13:46,800 --> 00:13:51,050
any ruder configuration parameter by

253
00:13:49,260 --> 00:13:53,189
sending a malicious link to victims

254
00:13:51,050 --> 00:13:55,170
there are several approaches to this

255
00:13:53,190 --> 00:13:57,930
attack because you can modify any

256
00:13:55,170 --> 00:14:00,900
parameter so you can modify the Reuters

257
00:13:57,930 --> 00:14:03,449
password enables and services a bit of

258
00:14:00,900 --> 00:14:10,110
everything but our main aim and the

259
00:14:03,450 --> 00:14:11,880
manufacturer is it is DNS hijacking I

260
00:14:10,110 --> 00:14:13,260
know what happened there but we can't

261
00:14:11,880 --> 00:14:17,040
see the screen and what well here it is

262
00:14:13,260 --> 00:14:21,230
spark so we're more we're swapping the

263
00:14:17,040 --> 00:14:25,170
legitimate in a service by malicious dns

264
00:14:21,230 --> 00:14:26,490
server so that all the DNS queries will

265
00:14:25,170 --> 00:14:29,760
go to a target server in the

266
00:14:26,490 --> 00:14:32,970
confidentiality on the big thing will we

267
00:14:29,760 --> 00:14:36,120
got a stake here they can be redirected

268
00:14:32,970 --> 00:14:39,690
to malicious sites and we could have

269
00:14:36,120 --> 00:14:43,380
different attacks on this these kind of

270
00:14:39,690 --> 00:14:44,970
attacks requiring I'm betting the

271
00:14:43,380 --> 00:14:47,430
credentials of the root row by default

272
00:14:44,970 --> 00:14:48,930
otherwise you will not work so this

273
00:14:47,430 --> 00:14:50,910
attack is hopefully feasible you those

274
00:14:48,930 --> 00:14:53,400
corrections have not been changed which

275
00:14:50,910 --> 00:14:56,569
is the most common scenario and here you

276
00:14:53,400 --> 00:14:56,569
can actually see the color scheme

277
00:14:56,830 --> 00:15:03,500
you can see the credentials of rheumatic

278
00:14:59,960 --> 00:15:05,360
followed by the Reuters IP followed by

279
00:15:03,500 --> 00:15:08,390
the path to the resource we're trying to

280
00:15:05,360 --> 00:15:10,279
bone right and the parameters of the

281
00:15:08,390 --> 00:15:13,160
cross-site request forgery will

282
00:15:10,279 --> 00:15:15,320
volunteer so here's example of DNS

283
00:15:13,160 --> 00:15:18,110
hijacking we were swapping the DNS but

284
00:15:15,320 --> 00:15:21,710
once we want we need we need to take

285
00:15:18,110 --> 00:15:25,339
into account the most modern browsers

286
00:15:21,710 --> 00:15:29,630
when we embed potentials they'll give us

287
00:15:25,339 --> 00:15:31,880
pop pop or a warning message such as

288
00:15:29,630 --> 00:15:35,570
this one you about logging to this site

289
00:15:31,880 --> 00:15:39,560
with these user name oz people press ok

290
00:15:35,570 --> 00:15:40,960
but the most use navigate or browse or

291
00:15:39,560 --> 00:15:43,010
google chrome doesn't show these

292
00:15:40,960 --> 00:15:47,240
warnings or the attack is totally

293
00:15:43,010 --> 00:15:49,490
invisible to the user and the link is a

294
00:15:47,240 --> 00:15:52,580
bit suspicious I'm not not apply this

295
00:15:49,490 --> 00:15:56,720
whole thing and this why the shortening

296
00:15:52,580 --> 00:15:59,800
services URL so just bit ly tinyurl or

297
00:15:56,720 --> 00:16:03,830
otherwise rowley I'm very useful because

298
00:15:59,800 --> 00:16:06,680
they take this massive URL to this sunny

299
00:16:03,830 --> 00:16:09,770
one is there so much you so much people

300
00:16:06,680 --> 00:16:13,280
will not be suspicious we can also do

301
00:16:09,770 --> 00:16:15,949
this by creating a website such as this

302
00:16:13,280 --> 00:16:19,529
one that posts this parameter is very

303
00:16:15,950 --> 00:16:21,810
simple we also

304
00:16:19,529 --> 00:16:24,509
found vulnerabilities in cross-site

305
00:16:21,810 --> 00:16:27,180
scripting which is in 30 malicious

306
00:16:24,509 --> 00:16:29,370
script on the Reuters website we can do

307
00:16:27,180 --> 00:16:31,649
that even remotely in this case is

308
00:16:29,370 --> 00:16:33,360
analogous he's like the cross-site

309
00:16:31,649 --> 00:16:35,550
request forgery because we need to embed

310
00:16:33,360 --> 00:16:38,490
the great shots by default so which is

311
00:16:35,550 --> 00:16:40,199
objective of this attack the first one

312
00:16:38,490 --> 00:16:42,240
you see you a sense of hijacking

313
00:16:40,199 --> 00:16:48,258
sealingly cookie of a session to the

314
00:16:42,240 --> 00:16:51,120
administrator user to you fishing and

315
00:16:48,259 --> 00:16:55,189
change the configuration but in some

316
00:16:51,120 --> 00:16:58,559
reuters is not possible due to cookies

317
00:16:55,189 --> 00:17:00,420
class we'll see next a live demo we have

318
00:16:58,559 --> 00:17:03,209
in the browser induction well we can

319
00:17:00,420 --> 00:17:05,459
insert malicious payload and compromise

320
00:17:03,209 --> 00:17:08,639
the route choice and computer security

321
00:17:05,459 --> 00:17:11,579
here's a typical access as pop in that

322
00:17:08,640 --> 00:17:14,549
message I've not whether you heard of

323
00:17:11,579 --> 00:17:17,399
beef is a very good tool allowing us to

324
00:17:14,549 --> 00:17:20,520
palliate some of these attacks problems

325
00:17:17,400 --> 00:17:23,549
a wide part of the impure fills in debt

326
00:17:20,520 --> 00:17:27,240
Henry parameters have a character

327
00:17:23,549 --> 00:17:30,030
limitation so this allows us to link to

328
00:17:27,240 --> 00:17:34,320
more complex scripts there are hosted in

329
00:17:30,030 --> 00:17:37,670
the attackers machine and here with

330
00:17:34,320 --> 00:17:41,090
really racked into an IP tonight

331
00:17:37,670 --> 00:17:42,680
we also found unauthenticated cross-site

332
00:17:41,090 --> 00:17:44,929
scripting vulnerabilities which is

333
00:17:42,680 --> 00:17:47,780
anything but not locally without the

334
00:17:44,930 --> 00:17:51,820
need for any authentication or embedding

335
00:17:47,780 --> 00:17:56,240
process and this is done by signing and

336
00:17:51,820 --> 00:18:00,620
dhcp request net to the host name

337
00:17:56,240 --> 00:18:03,920
parameter here the Rooter answers ok

338
00:18:00,620 --> 00:18:06,800
acknowledged and then they will embed

339
00:18:03,920 --> 00:18:09,140
these malicious scream script on the

340
00:18:06,800 --> 00:18:11,840
website configuration payment plan we

341
00:18:09,140 --> 00:18:14,200
can do this attack in different ways we

342
00:18:11,840 --> 00:18:16,879
can use a custom script that we've done

343
00:18:14,200 --> 00:18:19,700
ourselves allowing us to inject this

344
00:18:16,880 --> 00:18:22,130
parameter we can also use the Parker

345
00:18:19,700 --> 00:18:24,950
manipulation tools such as a star p or

346
00:18:22,130 --> 00:18:29,870
even we can change the machine night and

347
00:18:24,950 --> 00:18:33,110
next time we send the HC dhcp requests

348
00:18:29,870 --> 00:18:34,820
we can notify it so here are the typical

349
00:18:33,110 --> 00:18:37,490
elements with the house name and their

350
00:18:34,820 --> 00:18:40,280
knowledge and below we can see the

351
00:18:37,490 --> 00:18:44,140
connected clients table when we will

352
00:18:40,280 --> 00:18:44,139
impair the malicious script

353
00:18:44,830 --> 00:18:51,770
sometimes this is not so simple things

354
00:18:47,780 --> 00:18:54,170
get complicated as we may see here the

355
00:18:51,770 --> 00:18:57,230
injection it's a bit more exotic and

356
00:18:54,170 --> 00:18:59,240
complex and to achieve these kind of

357
00:18:57,230 --> 00:19:02,660
things we need to study your source code

358
00:18:59,240 --> 00:19:05,990
the website is trivial but he can take

359
00:19:02,660 --> 00:19:10,190
some time if we don't do so we might be

360
00:19:05,990 --> 00:19:12,710
destroying things and the website might

361
00:19:10,190 --> 00:19:16,280
not work well but with a bit of patient

362
00:19:12,710 --> 00:19:19,030
we can achieve everything we also have

363
00:19:16,280 --> 00:19:22,730
privilege escalation vulnerabilities I

364
00:19:19,030 --> 00:19:26,690
use it with administrator privileges can

365
00:19:22,730 --> 00:19:29,600
make changes in configurations and this

366
00:19:26,690 --> 00:19:32,510
is why having multiple user accounts is

367
00:19:29,600 --> 00:19:34,909
a very bad secur security properties as

368
00:19:32,510 --> 00:19:38,090
we see on this Reuters we're going to

369
00:19:34,910 --> 00:19:39,940
vulnera telefonica rotor I will connect

370
00:19:38,090 --> 00:19:42,590
with our ftp

371
00:19:39,940 --> 00:19:45,380
by using the credentials of the use of

372
00:19:42,590 --> 00:19:49,040
the has no privileges the user user this

373
00:19:45,380 --> 00:19:52,190
user as even as I even mentioned earlier

374
00:19:49,040 --> 00:19:56,360
is a user is not hidden but now no one

375
00:19:52,190 --> 00:19:58,850
is going to change their credentials so

376
00:19:56,360 --> 00:20:05,229
you to the found that the service is

377
00:19:58,850 --> 00:20:08,090
misconfigured we can go to critical

378
00:20:05,230 --> 00:20:09,920
files there is a list of all the root

379
00:20:08,090 --> 00:20:12,620
root of your engine parameters including

380
00:20:09,920 --> 00:20:16,100
the credentials changed in black text

381
00:20:12,620 --> 00:20:19,520
and I can also download the dtc password

382
00:20:16,100 --> 00:20:21,260
as you'll see next he will open the file

383
00:20:19,520 --> 00:20:25,550
we just unloaded we have the password

384
00:20:21,260 --> 00:20:27,200
and even worse we're going to achieve

385
00:20:25,550 --> 00:20:33,080
the account while you're servicing flat

386
00:20:27,200 --> 00:20:37,400
text as you can see here user 1234 and

387
00:20:33,080 --> 00:20:39,980
the password uses acuity is a strong

388
00:20:37,400 --> 00:20:41,870
which is a big lie but from here on user

389
00:20:39,980 --> 00:20:44,630
can make changes on the rooters

390
00:20:41,870 --> 00:20:47,360
configuration we also found bad tours

391
00:20:44,630 --> 00:20:51,050
everyone knows them and these are hidden

392
00:20:47,360 --> 00:20:55,040
in a min straighter accounts completely

393
00:20:51,050 --> 00:20:57,590
invisible to end users thing if a hacker

394
00:20:55,040 --> 00:20:59,629
had access to them they could do

395
00:20:57,590 --> 00:21:03,110
anything in the router me and we have

396
00:20:59,630 --> 00:21:06,910
found this kind of bug but doors harming

397
00:21:03,110 --> 00:21:06,909
four digits now the

398
00:21:08,419 --> 00:21:15,559
for lousy is in the devices mark

399
00:21:11,580 --> 00:21:15,559
followed by iron ore comes

400
00:21:16,510 --> 00:21:23,080
and there are other password such as we

401
00:21:19,700 --> 00:21:26,510
fee whatever you long passwords

402
00:21:23,080 --> 00:21:29,030
different things and this were sure is a

403
00:21:26,510 --> 00:21:33,190
Rooter as is flooded internal network

404
00:21:29,030 --> 00:21:35,600
with requests to adjacent txt resource

405
00:21:33,190 --> 00:21:37,760
and it's actually the rotary cell the

406
00:21:35,600 --> 00:21:40,879
one that is flooding the sub network

407
00:21:37,760 --> 00:21:44,420
network and these puzzles have no

408
00:21:40,880 --> 00:21:46,850
production whatsoever sukar to obtain

409
00:21:44,420 --> 00:21:48,830
the values of the network configuration

410
00:21:46,850 --> 00:21:53,719
so as you may see here the security is

411
00:21:48,830 --> 00:21:56,090
very good as I mentioned they were

412
00:21:53,720 --> 00:22:01,780
choice quite tiny living in what gives

413
00:21:56,090 --> 00:22:06,860
us clues on the password default true

414
00:22:01,780 --> 00:22:10,910
but is my favorite gives us SSID the

415
00:22:06,860 --> 00:22:13,879
past reason we fee passwords there are

416
00:22:10,910 --> 00:22:17,690
ups pain but the Union funniest bit is

417
00:22:13,880 --> 00:22:21,530
the name hitting info dot HTML very

418
00:22:17,690 --> 00:22:22,610
hidden as you may see earlier I don't

419
00:22:21,530 --> 00:22:24,320
like the other protocol layers are

420
00:22:22,610 --> 00:22:26,449
proven play stop these are the

421
00:22:24,320 --> 00:22:29,149
vulnerabilities of the universal program

422
00:22:26,450 --> 00:22:32,260
play flat imply protocol mouse devices

423
00:22:29,150 --> 00:22:35,030
designed to allow certain applications

424
00:22:32,260 --> 00:22:39,050
such as your favorite torrent customer

425
00:22:35,030 --> 00:22:42,470
to changes individual modification in

426
00:22:39,050 --> 00:22:45,129
that will cause such as opening ports or

427
00:22:42,470 --> 00:22:45,130
other things

428
00:22:45,530 --> 00:22:49,370
to prove the stability of the

429
00:22:47,780 --> 00:22:52,340
performance is something that video

430
00:22:49,370 --> 00:22:55,040
games use a lot online the problem of

431
00:22:52,340 --> 00:22:56,959
these protozoa is very unsecured first

432
00:22:55,040 --> 00:22:58,760
because it doesn't have an

433
00:22:56,960 --> 00:23:01,670
authentication process as you'll see

434
00:22:58,760 --> 00:23:04,129
next so not just an the application will

435
00:23:01,670 --> 00:23:07,400
also any user with malicious purposes

436
00:23:04,130 --> 00:23:11,990
can make these changes and it's also

437
00:23:07,400 --> 00:23:13,820
implemented in a pretty bad way the

438
00:23:11,990 --> 00:23:18,320
objectives are to open the critical

439
00:23:13,820 --> 00:23:22,580
ports to remote houses and pretty much

440
00:23:18,320 --> 00:23:24,530
whatever you want and we can even use

441
00:23:22,580 --> 00:23:28,429
that tool such as mere and electric

442
00:23:24,530 --> 00:23:32,750
hammer very recommended in here we are

443
00:23:28,430 --> 00:23:34,640
doing up for mapping now she owns a port

444
00:23:32,750 --> 00:23:36,350
mapping action we're up in a port in

445
00:23:34,640 --> 00:23:40,520
here and the third parameter or opening

446
00:23:36,350 --> 00:23:43,939
a port for remote host house and is not

447
00:23:40,520 --> 00:23:46,550
supported by the protocol a problem he

448
00:23:43,940 --> 00:23:48,290
has a parameter is not proven rightly

449
00:23:46,550 --> 00:23:51,830
it's not suddenly ties so therefore we

450
00:23:48,290 --> 00:23:56,450
can open this but as you may see here we

451
00:23:51,830 --> 00:23:58,879
can inject plan commands the next plug

452
00:23:56,450 --> 00:24:00,620
exploit these remotely and there are

453
00:23:58,880 --> 00:24:03,320
different ways of doing it will just

454
00:24:00,620 --> 00:24:06,679
explain one which is using a malicious

455
00:24:03,320 --> 00:24:08,419
flash file every house on a web server

456
00:24:06,680 --> 00:24:10,970
so every time a victim connects with a

457
00:24:08,420 --> 00:24:13,850
web server will you use this flash

458
00:24:10,970 --> 00:24:14,990
server and since the applications may

459
00:24:13,850 --> 00:24:18,139
have

460
00:24:14,990 --> 00:24:22,070
soupy anymore p actions is one will have

461
00:24:18,140 --> 00:24:23,840
mapping options you may say why is this

462
00:24:22,070 --> 00:24:25,340
useful well this is extremely useful

463
00:24:23,840 --> 00:24:28,040
because it will it will allow us to

464
00:24:25,340 --> 00:24:29,899
exploit local vulnerabilities remotely

465
00:24:28,040 --> 00:24:33,490
because we're going to open vehicle

466
00:24:29,900 --> 00:24:35,900
ports towards the outside to as host

467
00:24:33,490 --> 00:24:37,960
that may be very useful for this kind of

468
00:24:35,900 --> 00:24:37,960
thing

469
00:24:39,130 --> 00:24:45,049
so after speaking after these devices

470
00:24:43,340 --> 00:24:46,909
vulnerabilities I'm gonna mention the

471
00:24:45,049 --> 00:24:49,160
attackers position when it comes to

472
00:24:46,910 --> 00:24:52,039
exploiting that we can actually spread

473
00:24:49,160 --> 00:24:54,440
them into the attack vectors first when

474
00:24:52,039 --> 00:24:56,720
the attacker connects directly the

475
00:24:54,440 --> 00:24:59,120
network where the root or is this is

476
00:24:56,720 --> 00:25:02,360
coming at a hotel's Wi-Fi starbucks or

477
00:24:59,120 --> 00:25:05,330
hotspot Wi-Fi dr. vector of attacks

478
00:25:02,360 --> 00:25:06,740
whenever the attacker is able to find

479
00:25:05,330 --> 00:25:08,870
the oneworld root earth with the

480
00:25:06,740 --> 00:25:11,960
internet in his project they can use

481
00:25:08,870 --> 00:25:14,110
search tools as I showed them to find

482
00:25:11,960 --> 00:25:16,549
that kind of device there was also

483
00:25:14,110 --> 00:25:21,459
vulnerability such as the excess has the

484
00:25:16,549 --> 00:25:23,418
csrf and the UPI ap we the need

485
00:25:21,460 --> 00:25:25,220
something else by attracted to be

486
00:25:23,419 --> 00:25:28,780
exported here I'm talking about Sarge

487
00:25:25,220 --> 00:25:32,179
engineering and basically the attacker

488
00:25:28,780 --> 00:25:35,600
will differentiate two objectives to get

489
00:25:32,179 --> 00:25:37,580
mouse clicks possible and to focus the

490
00:25:35,600 --> 00:25:39,469
attack on a particular victim on which

491
00:25:37,580 --> 00:25:41,600
they are compiling information the first

492
00:25:39,470 --> 00:25:44,150
guy is the attacker may use the social

493
00:25:41,600 --> 00:25:46,490
networks such as Twitter and create a

494
00:25:44,150 --> 00:25:48,470
malicious to it or very attractive to it

495
00:25:46,490 --> 00:25:54,190
with a Europe URL for people to click

496
00:25:48,470 --> 00:25:57,529
with a topic such as the

497
00:25:54,190 --> 00:26:00,169
the leaked pictures of famous new

498
00:25:57,529 --> 00:26:03,289
celebrities if we have the name of

499
00:26:00,169 --> 00:26:04,700
carmen de morena Spanish celebrity we

500
00:26:03,289 --> 00:26:06,549
wouldn't have any clique we were

501
00:26:04,700 --> 00:26:11,470
intelligent we know they're out there

502
00:26:06,549 --> 00:26:13,610
they could be evil so they decide to

503
00:26:11,470 --> 00:26:16,100
have them each of these favors come

504
00:26:13,610 --> 00:26:18,110
player thank you you will get at least

505
00:26:16,100 --> 00:26:23,600
one meeting users of course you can

506
00:26:18,110 --> 00:26:29,870
reinforce the power hobbies preferably

507
00:26:23,600 --> 00:26:33,408
by buying followers in pretty retweet so

508
00:26:29,870 --> 00:26:36,258
here we could look at me one person

509
00:26:33,409 --> 00:26:39,799
compile their information their email

510
00:26:36,259 --> 00:26:43,429
and create a strong vector to to get

511
00:26:39,799 --> 00:26:45,500
them next talking about CS our F and D

512
00:26:43,429 --> 00:26:48,559
social mean Iran attacks and I try to do

513
00:26:45,500 --> 00:26:49,669
a demo that is usually done remotely but

514
00:26:48,559 --> 00:26:52,519
in this case I'm gonna do it locally

515
00:26:49,669 --> 00:26:59,840
since they I think what we wrote her to

516
00:26:52,519 --> 00:27:01,700
the farmers my route of forgery is not

517
00:26:59,840 --> 00:27:06,080
on the internet but to do this attack

518
00:27:01,700 --> 00:27:08,450
with half crazy to virtual machines one

519
00:27:06,080 --> 00:27:12,189
of them representing a legitimate dns

520
00:27:08,450 --> 00:27:12,190
such as the google ones

521
00:27:12,330 --> 00:27:21,029
and also the legitimate website and this

522
00:27:15,450 --> 00:27:24,539
virtual machine has an IP 1920 1080 127

523
00:27:21,029 --> 00:27:26,789
color assuming he's domain names and

524
00:27:24,539 --> 00:27:31,260
load Jamie normal web site and we have

525
00:27:26,789 --> 00:27:34,140
another virtual machine the represents

526
00:27:31,260 --> 00:27:37,110
the malicious dns and the web's

527
00:27:34,140 --> 00:27:39,269
malicious dns server there will be on

528
00:27:37,110 --> 00:27:41,939
the internet and on the attacker who

529
00:27:39,269 --> 00:27:45,230
like to swap with dns of our computer

530
00:27:41,940 --> 00:27:49,200
for the AP of this malicious machine

531
00:27:45,230 --> 00:27:52,289
computer to fact the domains and point

532
00:27:49,200 --> 00:27:54,809
to other malicious website web sites in

533
00:27:52,289 --> 00:27:57,330
principle we have configure the dhcp of

534
00:27:54,809 --> 00:28:02,029
our router to give the IP corresponding

535
00:27:57,330 --> 00:28:04,889
to the dns legitimate web server from

536
00:28:02,029 --> 00:28:08,190
victim we're gonna have some hard on

537
00:28:04,889 --> 00:28:13,189
your talking obvious IP and I loading

538
00:28:08,190 --> 00:28:15,990
the browser this I bergkamp swept side

539
00:28:13,190 --> 00:28:18,620
you can see that there is no problem

540
00:28:15,990 --> 00:28:21,720
whatsoever another sub account page

541
00:28:18,620 --> 00:28:24,689
loads without any problem but what

542
00:28:21,720 --> 00:28:29,190
happens if the attacker now sorry my

543
00:28:24,690 --> 00:28:31,500
address and decides to create an email

544
00:28:29,190 --> 00:28:34,260
for us let's say we're looking for work

545
00:28:31,500 --> 00:28:38,070
and need advices to press on this money

546
00:28:34,260 --> 00:28:42,799
to codys malicious URL which is URL that

547
00:28:38,070 --> 00:28:47,520
it begins a dns change in the Rueter

548
00:28:42,799 --> 00:28:51,060
okay so the victim would click on that

549
00:28:47,520 --> 00:28:53,520
I next dns and dhcp valle reuter changes

550
00:28:51,060 --> 00:28:56,820
and everyone who connects to that local

551
00:28:53,520 --> 00:28:59,879
network will follow their dns for my dns

552
00:28:56,820 --> 00:29:02,010
we change I need to reconnect for the

553
00:28:59,880 --> 00:29:04,550
dr's of my computers to be have to be

554
00:29:02,010 --> 00:29:04,550
refreshed

555
00:29:07,830 --> 00:29:18,100
so here and we love this are you going

556
00:29:14,770 --> 00:29:21,280
to show you that even found our

557
00:29:18,100 --> 00:29:26,620
computers Els has changed and now they

558
00:29:21,280 --> 00:29:30,280
point to the IP 192 168 1 96 what

559
00:29:26,620 --> 00:29:32,800
happens if next my connect to this same

560
00:29:30,280 --> 00:29:35,470
domain ugly before the website of a

561
00:29:32,800 --> 00:29:45,220
cyber town here you see that the results

562
00:29:35,470 --> 00:29:46,660
of this attack are a real disaster I'm

563
00:29:45,220 --> 00:29:49,060
get dropped by them because something

564
00:29:46,660 --> 00:29:51,700
horrible like this could happen these

565
00:29:49,060 --> 00:29:53,970
are very bad attack because with the

566
00:29:51,700 --> 00:29:57,780
failure of just one person

567
00:29:53,970 --> 00:30:01,680
the local network right all other users

568
00:29:57,780 --> 00:30:06,149
connect into it get affected so here is

569
00:30:01,680 --> 00:30:08,330
a big problem because if we have a good

570
00:30:06,150 --> 00:30:12,180
security knowledgeable our son doesn't

571
00:30:08,330 --> 00:30:13,590
and they press a malicious link and i

572
00:30:12,180 --> 00:30:16,380
click on malicious link all devices

573
00:30:13,590 --> 00:30:21,840
pending on those dns to work will not

574
00:30:16,380 --> 00:30:23,280
work appropriately do not feel it we now

575
00:30:21,840 --> 00:30:24,689
i'm going to do a little bit of a

576
00:30:23,280 --> 00:30:28,590
different demo it's going to be a bit

577
00:30:24,690 --> 00:30:31,130
faster and this is going to do what we

578
00:30:28,590 --> 00:30:34,139
talked about with the authentication

579
00:30:31,130 --> 00:30:37,590
cross-eyed skipped scripting so as an

580
00:30:34,140 --> 00:30:40,770
attacker and changing our host name we

581
00:30:37,590 --> 00:30:43,290
are able to inject malicious code into

582
00:30:40,770 --> 00:30:45,740
the configuration page of the router how

583
00:30:43,290 --> 00:30:48,149
do we do this well Reuters normally have

584
00:30:45,740 --> 00:30:49,770
paid where they load all of the devices

585
00:30:48,150 --> 00:30:51,540
which have connected and asked

586
00:30:49,770 --> 00:30:54,780
informational to be able to use the IB

587
00:30:51,540 --> 00:30:57,659
the DNS and they accumulate them on a on

588
00:30:54,780 --> 00:31:00,990
a website as well as the host name so we

589
00:30:57,660 --> 00:31:04,400
would be able to introduce or enter a

590
00:31:00,990 --> 00:31:04,400
false hostname

591
00:31:05,100 --> 00:31:09,230
and I'm going to connect again because

592
00:31:07,260 --> 00:31:12,980
sometimes it doesn't quite get the

593
00:31:09,230 --> 00:31:17,970
doesn't I get it the first time around

594
00:31:12,980 --> 00:31:20,870
let's have a look yeah the host name is

595
00:31:17,970 --> 00:31:20,870
a rather unusual

596
00:31:26,010 --> 00:31:33,150
it was for me okay so here we've got an

597
00:31:29,400 --> 00:31:35,090
attacker and what about a victim what

598
00:31:33,150 --> 00:31:37,950
the victim would do would be to connect

599
00:31:35,090 --> 00:31:42,659
do the configuration page of the router

600
00:31:37,950 --> 00:31:47,940
which is what we have here let's see if

601
00:31:42,660 --> 00:31:51,030
it loads so as a victim innocently

602
00:31:47,940 --> 00:31:53,040
enough we would enter their web site or

603
00:31:51,030 --> 00:31:58,080
the page with her configuration of our

604
00:31:53,040 --> 00:32:02,159
router and we will go to the HTTP table

605
00:31:58,080 --> 00:32:06,540
and if everything is work we can see

606
00:32:02,160 --> 00:32:08,280
indeed the winter the the window with

607
00:32:06,540 --> 00:32:11,639
the script and this is one way of doing

608
00:32:08,280 --> 00:32:14,629
an attack and now a van is going to show

609
00:32:11,640 --> 00:32:14,630
you another one a different one

610
00:32:23,820 --> 00:32:29,950
lossy enter demos we have a very simple

611
00:32:28,269 --> 00:32:32,620
scenario which is interesting

612
00:32:29,950 --> 00:32:37,269
nonetheless hits through scripting and

613
00:32:32,620 --> 00:32:42,489
this is going to allow the attacker to

614
00:32:37,269 --> 00:32:44,169
obtain obtain a reverse series and we

615
00:32:42,490 --> 00:32:45,820
have this language I will explain for

616
00:32:44,169 --> 00:32:50,200
this and the scenario is basically a

617
00:32:45,820 --> 00:32:53,950
Rooter to which an attacking machine is

618
00:32:50,200 --> 00:32:56,320
a connected to its Carly with an exploit

619
00:32:53,950 --> 00:32:58,450
for windows for internet explorer in

620
00:32:56,320 --> 00:33:00,730
this case and then on the other hand we

621
00:32:58,450 --> 00:33:03,909
have the victim who is or which is

622
00:33:00,730 --> 00:33:06,460
windows 7 with internet explorer and so

623
00:33:03,909 --> 00:33:08,460
the attacker will send them malicious

624
00:33:06,460 --> 00:33:11,260
link which is one that we can see here

625
00:33:08,460 --> 00:33:15,299
we'll send that to the victim and what

626
00:33:11,260 --> 00:33:15,299
we can see is that this link

627
00:33:15,970 --> 00:33:21,950
well here we have an attack which is

628
00:33:19,850 --> 00:33:24,830
similar to the ones we've done before we

629
00:33:21,950 --> 00:33:28,549
can see the default credentials we have

630
00:33:24,830 --> 00:33:33,260
the defect Ruta IP then after that we

631
00:33:28,549 --> 00:33:34,910
have one of the resources where we can

632
00:33:33,260 --> 00:33:37,610
make changes in the Reuters

633
00:33:34,910 --> 00:33:41,690
configuration and begin to introduce or

634
00:33:37,610 --> 00:33:43,729
inject to using two parameters why to

635
00:33:41,690 --> 00:33:45,650
while these two fields have limited

636
00:33:43,730 --> 00:33:48,559
number of characters so we have needed

637
00:33:45,650 --> 00:33:51,409
to divide it between the two the page

638
00:33:48,559 --> 00:33:55,010
once it's loaded we'll begin it will

639
00:33:51,409 --> 00:33:57,049
first of all load this second parameter

640
00:33:55,010 --> 00:34:00,140
which is the hostname that we can see

641
00:33:57,049 --> 00:34:03,020
here so when it loads it will open

642
00:34:00,140 --> 00:34:06,049
javascript with a window location assign

643
00:34:03,020 --> 00:34:10,730
in order to relaunch to the attackers

644
00:34:06,049 --> 00:34:13,100
machine and the commentary or the

645
00:34:10,730 --> 00:34:14,570
comments the observation so there's a

646
00:34:13,100 --> 00:34:16,310
comment on everything in the page until

647
00:34:14,570 --> 00:34:18,379
we get to the second field of the

648
00:34:16,310 --> 00:34:20,779
injection which is this one here here

649
00:34:18,379 --> 00:34:22,699
simply we just would continue with this

650
00:34:20,780 --> 00:34:28,520
injection we can see that it would send

651
00:34:22,699 --> 00:34:31,219
us to the attackers IP 192 168 1 35 and

652
00:34:28,520 --> 00:34:33,859
with resource number one which is where

653
00:34:31,219 --> 00:34:35,839
the exploit is located we've called it

654
00:34:33,859 --> 00:34:37,279
number one because of the limiter of

655
00:34:35,840 --> 00:34:39,919
correct characters a limited number of

656
00:34:37,280 --> 00:34:42,169
characters and upon the exploit what I

657
00:34:39,918 --> 00:34:44,168
could or regarding the exploit its to do

658
00:34:42,168 --> 00:34:48,580
with this vulnerability it effects

659
00:34:44,168 --> 00:34:52,069
internet its specific internet versions

660
00:34:48,580 --> 00:34:54,489
including 8 and 10 and what we're going

661
00:34:52,070 --> 00:34:57,800
to achieve is that it's executed on the

662
00:34:54,489 --> 00:35:00,680
customer side and we get the reverse

663
00:34:57,800 --> 00:35:04,820
series and I'm going to do it on the

664
00:35:00,680 --> 00:35:06,830
other computer I'm going to change I'm

665
00:35:04,820 --> 00:35:09,070
going to change the hdmi and will

666
00:35:06,830 --> 00:35:09,069
continue

667
00:35:17,960 --> 00:35:24,420
buddy know each other Molly you're still

668
00:35:21,960 --> 00:35:27,150
here on me right so on the one hand we

669
00:35:24,420 --> 00:35:30,839
have the attackers machine and we can

670
00:35:27,150 --> 00:35:32,819
see it's just got the listening and as

671
00:35:30,839 --> 00:35:36,540
you can see on the other hand we have

672
00:35:32,819 --> 00:35:40,020
their email that's been sent to the

673
00:35:36,540 --> 00:35:44,460
victim this one here where we have as a

674
00:35:40,020 --> 00:35:45,690
short field an email for job offer and

675
00:35:44,460 --> 00:35:47,550
we've got a field where it says click

676
00:35:45,690 --> 00:35:49,650
here to see more detail so that link

677
00:35:47,550 --> 00:35:52,380
that we've seen in the past and when we

678
00:35:49,650 --> 00:35:55,349
click it will direct us to the root on

679
00:35:52,380 --> 00:35:57,240
the root with the vulnerability that it

680
00:35:55,349 --> 00:36:00,319
has it will direct us to the attackers

681
00:35:57,240 --> 00:36:00,319
machine so if we click on it

682
00:36:00,869 --> 00:36:08,470
we can see it loads and this corresponds

683
00:36:05,020 --> 00:36:13,720
to the exploit and when we come back to

684
00:36:08,470 --> 00:36:16,348
the attackers machine well it seems to

685
00:36:13,720 --> 00:36:16,348
be taking a little while

686
00:36:19,140 --> 00:36:23,879
pilots let's see we'll try opening it

687
00:36:21,760 --> 00:36:23,880
again

688
00:36:26,800 --> 00:36:33,099
okay let's see and now it's not working

689
00:36:36,720 --> 00:36:41,490
so is the problem with a live broadcast

690
00:36:44,359 --> 00:36:49,538
sometimes it doesn't quite work let's

691
00:36:47,299 --> 00:36:49,538
see

692
00:36:56,050 --> 00:36:59,840
this is a bit of the problem with

693
00:36:58,130 --> 00:37:01,700
client-side exploits we can have these

694
00:36:59,840 --> 00:37:04,010
kind of problems sometimes they don't

695
00:37:01,700 --> 00:37:06,169
work because it's an exploit which isn't

696
00:37:04,010 --> 00:37:07,700
really ours it's an exploit for internet

697
00:37:06,170 --> 00:37:08,930
explorer we could be using a different

698
00:37:07,700 --> 00:37:10,819
one for google chrome but we're using

699
00:37:08,930 --> 00:37:13,368
this one for internet explorer and our

700
00:37:10,820 --> 00:37:17,090
vulnerability is taking it but the

701
00:37:13,369 --> 00:37:19,790
redirection is working but sometimes it

702
00:37:17,090 --> 00:37:23,330
doesn't want to pop here with the

703
00:37:19,790 --> 00:37:28,759
reverse SL okay well it's taken us a

704
00:37:23,330 --> 00:37:31,310
while but we've got there so here we

705
00:37:28,760 --> 00:37:33,410
have absolutely full access to the

706
00:37:31,310 --> 00:37:39,710
victims machine so here for example we

707
00:37:33,410 --> 00:37:43,390
could see the dr or browse through the

708
00:37:39,710 --> 00:37:47,930
different directories see the user

709
00:37:43,390 --> 00:37:51,160
suchlike so i shall pass the floor now

710
00:37:47,930 --> 00:37:51,160
to my colleague

711
00:37:52,170 --> 00:37:55,809
okay well we'll go back to the other

712
00:37:54,339 --> 00:37:57,119
computer that we were on to start with

713
00:37:55,809 --> 00:38:00,479
if there were many problems with that

714
00:37:57,119 --> 00:38:00,479
let's see

715
00:38:01,480 --> 00:38:09,460
perfect well why do you know things

716
00:38:07,390 --> 00:38:11,080
sometimes go a bit wrong when it's live

717
00:38:09,460 --> 00:38:12,250
but that's what makes it fun and I'm

718
00:38:11,080 --> 00:38:15,000
going to do a demonstration which

719
00:38:12,250 --> 00:38:19,060
exploits a vulnerability of the sandbar

720
00:38:15,000 --> 00:38:23,830
system here we have a server as you can

721
00:38:19,060 --> 00:38:27,009
see and since it's Sam babe we're going

722
00:38:23,830 --> 00:38:31,060
to use a site Callie and first thing

723
00:38:27,010 --> 00:38:34,600
we're going to do is to list their

724
00:38:31,060 --> 00:38:38,290
services that this service sorry this

725
00:38:34,600 --> 00:38:42,190
router provides as we can see here we

726
00:38:38,290 --> 00:38:49,150
have a service called storage which

727
00:38:42,190 --> 00:38:52,510
serves for exchanging USB files so we're

728
00:38:49,150 --> 00:38:57,280
going to connect to the IP of the router

729
00:38:52,510 --> 00:38:58,960
and this same resource we're connected

730
00:38:57,280 --> 00:39:03,760
without the need for any kind of

731
00:38:58,960 --> 00:39:07,119
authentication and if well because

732
00:39:03,760 --> 00:39:09,190
there's a failing in the SMB we can

733
00:39:07,119 --> 00:39:11,109
create symbolic links to any part of the

734
00:39:09,190 --> 00:39:16,119
file system as you're going to see now

735
00:39:11,109 --> 00:39:19,230
so symlink / I'm going to call it / if

736
00:39:16,119 --> 00:39:21,240
we do an LS here we have the

737
00:39:19,230 --> 00:39:24,359
results and if we connect we have the

738
00:39:21,240 --> 00:39:26,609
router at our service you know we can do

739
00:39:24,359 --> 00:39:29,549
what we want we can get the password or

740
00:39:26,609 --> 00:39:31,980
we can get any kind of file for

741
00:39:29,550 --> 00:39:37,950
configuration of the router for example

742
00:39:31,980 --> 00:39:39,020
this one which is 4mm PDF d okay and I'm

743
00:39:37,950 --> 00:39:41,279
gonna have a look what we've downloaded

744
00:39:39,020 --> 00:39:45,960
as you can see we've got the password

745
00:39:41,280 --> 00:39:47,730
and this can be cracked very easily in

746
00:39:45,960 --> 00:39:50,670
just a few moments but we don't need a

747
00:39:47,730 --> 00:39:51,869
password to exchange files we have the

748
00:39:50,670 --> 00:39:54,480
configuration file got lots of

749
00:39:51,869 --> 00:39:55,830
parameters that we can change so we

750
00:39:54,480 --> 00:39:57,690
don't have time to it right now but we

751
00:39:55,830 --> 00:40:01,440
could change any parameter and we come

752
00:39:57,690 --> 00:40:05,190
back here and using the integrated put

753
00:40:01,440 --> 00:40:06,330
command we can do that and as you can

754
00:40:05,190 --> 00:40:08,560
see we've changed the behavior of the

755
00:40:06,330 --> 00:40:12,170
ruta

756
00:40:08,560 --> 00:40:18,140
since were a bit lazy we've created a

757
00:40:12,170 --> 00:40:19,760
big button command which is basically to

758
00:40:18,140 --> 00:40:24,470
download the whole system of files

759
00:40:19,760 --> 00:40:26,330
without any kind of interaction and you

760
00:40:24,470 --> 00:40:30,020
can see here that everything's coming

761
00:40:26,330 --> 00:40:32,810
down it's all starting to appear we're

762
00:40:30,020 --> 00:40:34,100
not going to leave that any longer

763
00:40:32,810 --> 00:40:37,180
because it would take quite a while so

764
00:40:34,100 --> 00:40:39,830
we'll stop it but this kind of attack

765
00:40:37,180 --> 00:40:41,930
yeah to be very careful because it's not

766
00:40:39,830 --> 00:40:45,040
just something that can be done locally

767
00:40:41,930 --> 00:40:48,950
but also remotely here we've got

768
00:40:45,040 --> 00:40:52,840
examples for that you can look at you

769
00:40:48,950 --> 00:40:54,770
can find thousands of vulnerable Reuters

770
00:40:52,840 --> 00:40:57,380
open to this and I'm not going to

771
00:40:54,770 --> 00:40:59,030
obviously do a remote demonstration

772
00:40:57,380 --> 00:41:01,550
because that would be a crime but I'm

773
00:40:59,030 --> 00:41:03,800
going to just show you a video about

774
00:41:01,550 --> 00:41:04,850
being done with a remote obviously we're

775
00:41:03,800 --> 00:41:07,340
not going to see the whole thing but

776
00:41:04,850 --> 00:41:10,460
it's the same basically but connecting

777
00:41:07,340 --> 00:41:14,890
to a remote Ruta we have the symbolic

778
00:41:10,460 --> 00:41:14,890
link and it works perfectly well

779
00:41:15,559 --> 00:41:20,599
okay so we'll continue with our

780
00:41:17,609 --> 00:41:20,598
presentation

781
00:41:22,709 --> 00:41:29,049
and so we're going to talk about shields

782
00:41:26,219 --> 00:41:31,389
we didn't only want to talk about

783
00:41:29,049 --> 00:41:36,309
attacks we also wanted to talk about how

784
00:41:31,389 --> 00:41:38,619
to mitigate them and nonetheless it's

785
00:41:36,309 --> 00:41:41,919
difficult as end-users you start off

786
00:41:38,619 --> 00:41:44,259
with a broken shield you have very few

787
00:41:41,919 --> 00:41:45,429
or limited figuration configuration

788
00:41:44,259 --> 00:41:46,749
settings several attacks cannot be

789
00:41:45,429 --> 00:41:48,189
stopped on the mitigations that we're

790
00:41:46,749 --> 00:41:50,788
going to talk about only work for

791
00:41:48,189 --> 00:41:53,529
specific models because each router is

792
00:41:50,789 --> 00:41:55,839
completely different so we're going to

793
00:41:53,529 --> 00:41:57,489
propose solutions it may work for one

794
00:41:55,839 --> 00:42:00,699
reader but not for another and we have

795
00:41:57,489 --> 00:42:03,039
to say it's also not as easy as buying a

796
00:42:00,699 --> 00:42:06,219
brand new router because these Reuters

797
00:42:03,039 --> 00:42:07,359
due to marketing aspects they include a

798
00:42:06,219 --> 00:42:09,929
lot of services the only thing they

799
00:42:07,359 --> 00:42:13,449
manage to achieve besides giving

800
00:42:09,929 --> 00:42:17,019
functionality is that they increase the

801
00:42:13,449 --> 00:42:21,819
amount of exposure the area which is

802
00:42:17,019 --> 00:42:23,529
exposed and also we have to say that no

803
00:42:21,819 --> 00:42:25,449
antivirus is going to protect you from

804
00:42:23,529 --> 00:42:29,499
this and we say that because there are

805
00:42:25,449 --> 00:42:31,659
some antivirus companies which when we

806
00:42:29,499 --> 00:42:34,259
talk about vulnerabilities they include

807
00:42:31,659 --> 00:42:37,359
posts on their official blocks

808
00:42:34,259 --> 00:42:40,089
reflecting these concerns and but at the

809
00:42:37,359 --> 00:42:43,869
bottom they always say by our protection

810
00:42:40,089 --> 00:42:45,369
protection you know product because they

811
00:42:43,869 --> 00:42:47,919
will protect you but we can tell you

812
00:42:45,369 --> 00:42:50,360
here and now that that's not the case so

813
00:42:47,919 --> 00:42:53,210
here we have some advice

814
00:42:50,360 --> 00:42:54,590
as usuals you may wonder where to start

815
00:42:53,210 --> 00:42:58,400
well first of all you have to identify

816
00:42:54,590 --> 00:43:02,410
your Rooter model and we must also look

817
00:42:58,400 --> 00:43:05,060
for the rich credentials and we must

818
00:43:02,410 --> 00:43:07,160
understand the most advanced

819
00:43:05,060 --> 00:43:08,720
configuration interface which allows the

820
00:43:07,160 --> 00:43:11,330
greatest number of changes because here

821
00:43:08,720 --> 00:43:13,819
we've got two skins from the same Rooter

822
00:43:11,330 --> 00:43:15,440
one which is the one that Vodafone wants

823
00:43:13,820 --> 00:43:17,350
us to use so it doesn't allow us to

824
00:43:15,440 --> 00:43:19,730
change it and the one on the right is

825
00:43:17,350 --> 00:43:21,830
the one that's hidden away which allows

826
00:43:19,730 --> 00:43:24,920
us to make real changes so you have to

827
00:43:21,830 --> 00:43:28,790
use Google to find these things out here

828
00:43:24,920 --> 00:43:31,550
we can see the label on the back of the

829
00:43:28,790 --> 00:43:34,759
root erm we've got the numbers the brand

830
00:43:31,550 --> 00:43:37,940
and they passwords for administration

831
00:43:34,760 --> 00:43:40,460
but as I said this is for a really

832
00:43:37,940 --> 00:43:42,680
limited administration and form of estar

833
00:43:40,460 --> 00:43:44,750
it's much more of the same their model

834
00:43:42,680 --> 00:43:47,779
we don't get the passwords but we can

835
00:43:44,750 --> 00:43:49,670
get them through google general

836
00:43:47,780 --> 00:43:53,090
recommendations only log into the web

837
00:43:49,670 --> 00:43:55,640
interface when needed why why do I say

838
00:43:53,090 --> 00:43:58,220
that well because if you remain logged

839
00:43:55,640 --> 00:44:02,359
on you could click or fall into some

840
00:43:58,220 --> 00:44:04,490
kind of trap and that link might commit

841
00:44:02,360 --> 00:44:06,830
some kind of scripting or forgery as you

842
00:44:04,490 --> 00:44:09,470
saw in these demonstrations so whenever

843
00:44:06,830 --> 00:44:10,940
you finish you with changes you have to

844
00:44:09,470 --> 00:44:13,370
log out on the router with that's

845
00:44:10,940 --> 00:44:15,470
possible because many of them don't

846
00:44:13,370 --> 00:44:21,020
implement that log out and so you have

847
00:44:15,470 --> 00:44:22,850
to rub out the cachet call the cash it's

848
00:44:21,020 --> 00:44:25,030
also very important as we have said

849
00:44:22,850 --> 00:44:27,380
since

850
00:44:25,030 --> 00:44:30,950
the hijacking attacks are the most

851
00:44:27,380 --> 00:44:32,930
common kind you have to check the dns

852
00:44:30,950 --> 00:44:34,430
service that you have it's very easy you

853
00:44:32,930 --> 00:44:38,120
can do this you just go into the web of

854
00:44:34,430 --> 00:44:40,160
the rooty you look at the day dns folder

855
00:44:38,120 --> 00:44:42,980
make sure it's in automatic or if it's

856
00:44:40,160 --> 00:44:45,980
local then it should be the ones which

857
00:44:42,980 --> 00:44:47,510
so that the trusted the illnesses these

858
00:44:45,980 --> 00:44:49,100
are the ones for telefonica and here you

859
00:44:47,510 --> 00:44:51,200
have it in auto Rooter and you should do

860
00:44:49,100 --> 00:44:53,779
that in your own in your own operating

861
00:44:51,200 --> 00:44:56,120
system and as you can see we've opened

862
00:44:53,780 --> 00:44:57,650
up resource com we could also we also

863
00:44:56,120 --> 00:45:01,060
have to do this with Windows you have

864
00:44:57,650 --> 00:45:03,440
just go to the control panel network and

865
00:45:01,060 --> 00:45:06,340
that's where you can do it but we have

866
00:45:03,440 --> 00:45:09,020
to say that you do not trust shortened

867
00:45:06,340 --> 00:45:11,030
links shortened links which are used in

868
00:45:09,020 --> 00:45:13,220
social networks because they might come

869
00:45:11,030 --> 00:45:17,300
with a bit of an unwanted gift and also

870
00:45:13,220 --> 00:45:19,189
when you browse through the Rooter

871
00:45:17,300 --> 00:45:20,960
navigation page because you might come

872
00:45:19,190 --> 00:45:22,600
across this you might come across this

873
00:45:20,960 --> 00:45:24,710
or an attack like the one we saw before

874
00:45:22,600 --> 00:45:26,930
and if we talk about multiple user

875
00:45:24,710 --> 00:45:29,990
accounts is very important to delete any

876
00:45:26,930 --> 00:45:31,700
other kind of account so just allow the

877
00:45:29,990 --> 00:45:32,930
one administrative account with

878
00:45:31,700 --> 00:45:34,430
privileges but this is very difficult

879
00:45:32,930 --> 00:45:35,720
because normally are there going to be

880
00:45:34,430 --> 00:45:39,440
lots of difficulties when it comes to

881
00:45:35,720 --> 00:45:41,240
deleting accounts but also try at least

882
00:45:39,440 --> 00:45:45,290
to change the passwords if possible

883
00:45:41,240 --> 00:45:46,759
although as I said this could be

884
00:45:45,290 --> 00:45:49,670
difficult and sometimes you can't

885
00:45:46,760 --> 00:45:55,720
mitigate this from as a user here we can

886
00:45:49,670 --> 00:45:55,720
see two users but at the bottom we have

887
00:45:56,509 --> 00:46:03,059
adsl user that's been established here

888
00:46:00,390 --> 00:46:05,729
this is vodafone it allows us to change

889
00:46:03,059 --> 00:46:11,579
the account let me have for under that

890
00:46:05,729 --> 00:46:13,529
and another movie star Rooter and we can

891
00:46:11,579 --> 00:46:15,449
see this is very good this would be the

892
00:46:13,529 --> 00:46:18,959
model to follow here we can see the

893
00:46:15,449 --> 00:46:21,390
privilege or you know you can have a

894
00:46:18,959 --> 00:46:23,430
list of the credentials but the thing is

895
00:46:21,390 --> 00:46:25,199
that what it will be very good if it

896
00:46:23,430 --> 00:46:30,509
didn't have a back door like this one

897
00:46:25,199 --> 00:46:32,099
which is hidden in the file and I'm

898
00:46:30,509 --> 00:46:33,749
going to show you a demo video of how to

899
00:46:32,099 --> 00:46:36,449
mitigate these kind of attacks we're

900
00:46:33,749 --> 00:46:40,520
going to mitigate the kind that I talked

901
00:46:36,449 --> 00:46:42,800
about which is the privilege escalation

902
00:46:40,520 --> 00:46:46,759
and the problem with multiple user

903
00:46:42,800 --> 00:46:48,590
accounts so we have the credentials of

904
00:46:46,760 --> 00:46:50,540
the user name administrator and we're

905
00:46:48,590 --> 00:46:52,250
going to download the password I'm

906
00:46:50,540 --> 00:46:56,330
running through this because very simple

907
00:46:52,250 --> 00:46:58,610
very easy so we do that then we open it

908
00:46:56,330 --> 00:47:00,080
and as you can see we have two user

909
00:46:58,610 --> 00:47:01,910
accounts and the back door that I

910
00:47:00,080 --> 00:47:04,700
mentioned and the user that we've used

911
00:47:01,910 --> 00:47:06,319
to do the privilege escalation and in

912
00:47:04,700 --> 00:47:08,870
this case it's very easy to mitigate

913
00:47:06,320 --> 00:47:11,030
what we're going to do is modify this

914
00:47:08,870 --> 00:47:13,940
file with the passwords we delete these

915
00:47:11,030 --> 00:47:18,620
two lines and what's more we change the

916
00:47:13,940 --> 00:47:20,690
console Bing coli for sh ping Sh so we

917
00:47:18,620 --> 00:47:22,490
can have greater control and the only

918
00:47:20,690 --> 00:47:26,300
thing we're going to do now is to have

919
00:47:22,490 --> 00:47:28,700
to carry out a put with the former

920
00:47:26,300 --> 00:47:31,460
password with our values and very

921
00:47:28,700 --> 00:47:34,460
quickly we would have uploaded that and

922
00:47:31,460 --> 00:47:36,830
we're going to check that these can't be

923
00:47:34,460 --> 00:47:38,810
logged that the user cannot log into ftp

924
00:47:36,830 --> 00:47:40,220
and we can see they have no way of

925
00:47:38,810 --> 00:47:43,640
connecting and they can't escalate

926
00:47:40,220 --> 00:47:46,339
privileges the same as with the ADSL

927
00:47:43,640 --> 00:47:48,740
user and if we look at the website it

928
00:47:46,340 --> 00:47:50,960
would be exactly the same

929
00:47:48,740 --> 00:47:53,330
and also I'd like to talk about services

930
00:47:50,960 --> 00:47:55,340
try to deactivate any service that you

931
00:47:53,330 --> 00:47:57,500
don't need that's not critical for the

932
00:47:55,340 --> 00:47:58,700
functionings of the rooters with they

933
00:47:57,500 --> 00:48:02,210
allow you because usually they will not

934
00:47:58,700 --> 00:48:05,689
allow you and this includes ftp ftp

935
00:48:02,210 --> 00:48:08,420
sorry and sm be media service such as

936
00:48:05,690 --> 00:48:11,450
twonky upnp because that's one of the

937
00:48:08,420 --> 00:48:14,630
services which is most vulnerable and if

938
00:48:11,450 --> 00:48:18,169
you have local risk of an extreme nature

939
00:48:14,630 --> 00:48:22,730
then you know deactivate or disable dhcp

940
00:48:18,170 --> 00:48:25,580
i don't remember if we deactivate these

941
00:48:22,730 --> 00:48:26,810
services well these services in fact are

942
00:48:25,580 --> 00:48:29,509
going to carry on running in the

943
00:48:26,810 --> 00:48:31,009
background without telling us so you PMP

944
00:48:29,510 --> 00:48:32,720
we deactivate it but it may still

945
00:48:31,010 --> 00:48:34,520
receive requests and so it will still

946
00:48:32,720 --> 00:48:37,899
continue to be vulnerable so it doesn't

947
00:48:34,520 --> 00:48:41,330
always work here we have some examples

948
00:48:37,900 --> 00:48:43,820
this would be for the ftp server as you

949
00:48:41,330 --> 00:48:46,520
can see it's very good because it allows

950
00:48:43,820 --> 00:48:49,610
us to modify different things this would

951
00:48:46,520 --> 00:48:52,640
be for twanky to be able or dis activate

952
00:48:49,610 --> 00:48:54,740
deactivate twonky and this one for you

953
00:48:52,640 --> 00:48:56,750
PMP but you mustn't trust them because

954
00:48:54,740 --> 00:48:59,660
you may still be vulnerable in the

955
00:48:56,750 --> 00:49:01,700
background I'm going to continue now

956
00:48:59,660 --> 00:49:05,600
with more mitigation that the end users

957
00:49:01,700 --> 00:49:08,330
can do if we talk about firmware if the

958
00:49:05,600 --> 00:49:10,130
manufacturer provides us with the latest

959
00:49:08,330 --> 00:49:12,230
version then we can always try to update

960
00:49:10,130 --> 00:49:15,190
it how well there are two ways the first

961
00:49:12,230 --> 00:49:18,590
one is very simple just by

962
00:49:15,190 --> 00:49:21,020
re-establishing the configuration of the

963
00:49:18,590 --> 00:49:22,609
route using alberta and this would kind

964
00:49:21,020 --> 00:49:25,570
of restore it and it would activate a

965
00:49:22,609 --> 00:49:28,100
service which is which accesses the

966
00:49:25,570 --> 00:49:29,869
systems that takes the most recent

967
00:49:28,100 --> 00:49:33,020
software and it loads it if that's not

968
00:49:29,869 --> 00:49:34,490
possible on the computer configuration

969
00:49:33,020 --> 00:49:37,250
web page there's always a part which

970
00:49:34,490 --> 00:49:39,979
allows us to examine firmware that we've

971
00:49:37,250 --> 00:49:41,990
downloaded on the internet and to load

972
00:49:39,980 --> 00:49:44,990
it where can we find that well with the

973
00:49:41,990 --> 00:49:47,209
operator we have four ur on the world

974
00:49:44,990 --> 00:49:48,799
where we can request them but whenever

975
00:49:47,210 --> 00:49:50,090
you're going to download firmware you

976
00:49:48,800 --> 00:49:51,109
have to be careful because it could be

977
00:49:50,090 --> 00:49:53,050
in malicious and that would give us a

978
00:49:51,109 --> 00:49:56,110
real problem

979
00:49:53,050 --> 00:50:00,400
one question that people many people ask

980
00:49:56,110 --> 00:50:02,770
us regarding firmware and open source if

981
00:50:00,400 --> 00:50:05,500
we're advancing our ruta is compatible

982
00:50:02,770 --> 00:50:06,550
we could always choose to use open

983
00:50:05,500 --> 00:50:10,470
source but you have to be careful

984
00:50:06,550 --> 00:50:13,870
because then you know that it's not the

985
00:50:10,470 --> 00:50:16,029
necessarily a panacea if we took my upnp

986
00:50:13,870 --> 00:50:18,480
or others they may correct more quickly

987
00:50:16,030 --> 00:50:20,680
but they cause problems so for example

988
00:50:18,480 --> 00:50:25,210
sense has had problems with remote

989
00:50:20,680 --> 00:50:29,379
coding and ddd sorry dd-wrt also puts

990
00:50:25,210 --> 00:50:31,660
the manufactures one ones can be patched

991
00:50:29,380 --> 00:50:33,460
more rapidly and if we talk about the

992
00:50:31,660 --> 00:50:38,819
manufacturers then coming on to that

993
00:50:33,460 --> 00:50:40,600
subject the most important thing about

994
00:50:38,820 --> 00:50:44,170
manufacturers is that they have to

995
00:50:40,600 --> 00:50:48,700
listen to what the security researchers

996
00:50:44,170 --> 00:50:50,350
or investigators tell them so there are

997
00:50:48,700 --> 00:50:51,910
lots of services which the end user is

998
00:50:50,350 --> 00:50:57,220
not going to need so they should be

999
00:50:51,910 --> 00:50:59,799
stopped but by default the and the idea

1000
00:50:57,220 --> 00:51:02,470
of having critical ports close to one by

1001
00:50:59,800 --> 00:51:03,820
default this would make it much more

1002
00:51:02,470 --> 00:51:05,140
difficult to exploit them although of

1003
00:51:03,820 --> 00:51:08,170
course if we have to wait for the

1004
00:51:05,140 --> 00:51:10,450
manufacturers solve these problems then

1005
00:51:08,170 --> 00:51:14,340
you know oh it's best not to hold your

1006
00:51:10,450 --> 00:51:16,180
breath let's say so if we have a good

1007
00:51:14,340 --> 00:51:17,620
administration administration that's

1008
00:51:16,180 --> 00:51:21,460
more than enough we don't need anything

1009
00:51:17,620 --> 00:51:24,009
else and if the password is generated

1010
00:51:21,460 --> 00:51:27,580
randomly in the same way as with the

1011
00:51:24,010 --> 00:51:29,830
Wi-Fi password and this the algorithms

1012
00:51:27,580 --> 00:51:31,240
for the generation of passwords it needs

1013
00:51:29,830 --> 00:51:34,509
to be quite strong because the

1014
00:51:31,240 --> 00:51:36,129
algorithms normally take at the mac to

1015
00:51:34,510 --> 00:51:38,920
generate the administration codes her

1016
00:51:36,130 --> 00:51:42,550
with reverse engineering they can

1017
00:51:38,920 --> 00:51:44,710
hackers can obtain the the password but

1018
00:51:42,550 --> 00:51:46,000
if the attacker cannot know the elements

1019
00:51:44,710 --> 00:51:48,220
for example the serial number of the

1020
00:51:46,000 --> 00:51:50,289
router or the date of manufacture then

1021
00:51:48,220 --> 00:51:52,779
it will be much safer

1022
00:51:50,289 --> 00:51:54,910
oh they could design a safe alternative

1023
00:51:52,779 --> 00:51:56,410
to you PMP because we've seen that the

1024
00:51:54,910 --> 00:51:58,598
current one is a bit of a disaster in

1025
00:51:56,410 --> 00:52:01,689
terms of security and of course always

1026
00:51:58,599 --> 00:52:06,130
avoid unsafe protocols changing HTTP for

1027
00:52:01,689 --> 00:52:07,479
HTTPS so by way of summary this is

1028
00:52:06,130 --> 00:52:10,569
really important this is something that

1029
00:52:07,479 --> 00:52:15,249
we need to do and if we talk about the

1030
00:52:10,569 --> 00:52:18,519
strengthening of devices we can try to

1031
00:52:15,249 --> 00:52:21,189
indicate the victim that they should not

1032
00:52:18,519 --> 00:52:22,359
load inappropriate things and filter

1033
00:52:21,189 --> 00:52:24,249
everything that enters into the router

1034
00:52:22,359 --> 00:52:26,319
and Here I am say everything because we

1035
00:52:24,249 --> 00:52:29,169
saw earlier with the hush nail that well

1036
00:52:26,319 --> 00:52:31,029
we can have them are malicious script so

1037
00:52:29,169 --> 00:52:33,069
what we always say with security output

1038
00:52:31,029 --> 00:52:37,150
is all input is evil until proven

1039
00:52:33,069 --> 00:52:40,359
otherwise and if we talk about csrf

1040
00:52:37,150 --> 00:52:43,599
there are tokens they work they are

1041
00:52:40,359 --> 00:52:45,069
hashes which are generated and there's a

1042
00:52:43,599 --> 00:52:47,829
transaction but when the transaction is

1043
00:52:45,069 --> 00:52:49,749
completed they die and step by step step

1044
00:52:47,829 --> 00:52:51,400
with Java code it's generated it

1045
00:52:49,749 --> 00:52:53,948
generates the hash then it's assigned to

1046
00:52:51,400 --> 00:52:55,329
the transaction it's checked on the

1047
00:52:53,949 --> 00:52:56,559
service and on the client side and once

1048
00:52:55,329 --> 00:52:59,589
the transaction has been finished we

1049
00:52:56,559 --> 00:53:04,140
have to invalidate that token so that

1050
00:52:59,589 --> 00:53:06,939
the attacker cannot deduce the URL and

1051
00:53:04,140 --> 00:53:08,078
causes problems if we talk about the

1052
00:53:06,939 --> 00:53:13,178
bypass authentication information

1053
00:53:08,079 --> 00:53:15,880
disclosure where we have to avoid you to

1054
00:53:13,179 --> 00:53:18,339
a user from acts an incorrectly logged

1055
00:53:15,880 --> 00:53:19,869
person from accessing critical elements

1056
00:53:18,339 --> 00:53:21,279
and service-related side of things you

1057
00:53:19,869 --> 00:53:25,239
have to check for possible wrong service

1058
00:53:21,279 --> 00:53:26,949
configuration such as the critical ones

1059
00:53:25,239 --> 00:53:29,519
that we've seen we have some

1060
00:53:26,949 --> 00:53:32,239
recommendations for parameters for the

1061
00:53:29,519 --> 00:53:37,098
file SMB

1062
00:53:32,239 --> 00:53:40,789
and file and we can see is it in this

1063
00:53:37,099 --> 00:53:43,939
way we can avoid any incorrectly user

1064
00:53:40,789 --> 00:53:47,109
from entering our cage and another

1065
00:53:43,939 --> 00:53:50,269
interesting one the wide links means

1066
00:53:47,109 --> 00:53:52,459
that it prevents links being created

1067
00:53:50,269 --> 00:53:55,249
going to outside the cage and

1068
00:53:52,459 --> 00:53:57,469
downloading the whole file system of the

1069
00:53:55,249 --> 00:54:00,859
router okay we're getting to the end

1070
00:53:57,469 --> 00:54:01,969
with Vicky's hand I would just like to

1071
00:54:00,859 --> 00:54:04,609
say very quickly that we've developed

1072
00:54:01,969 --> 00:54:06,769
some tools we've seen some already but

1073
00:54:04,609 --> 00:54:09,739
we've also created other tools that will

1074
00:54:06,769 --> 00:54:12,348
help us to carry out cross-site

1075
00:54:09,739 --> 00:54:15,529
scripting analysis and we've also worked

1076
00:54:12,349 --> 00:54:16,879
in pedal Joaquin's project and we've

1077
00:54:15,529 --> 00:54:19,809
included the vulnerabilities that we've

1078
00:54:16,879 --> 00:54:23,299
detected so now we're going to bit of a

1079
00:54:19,809 --> 00:54:25,519
tricky area the response of the

1080
00:54:23,299 --> 00:54:26,719
manufacturers suisse with an average of

1081
00:54:25,519 --> 00:54:28,129
two to three email sent each

1082
00:54:26,719 --> 00:54:30,649
manufacturer most of them and replied

1083
00:54:28,129 --> 00:54:33,469
and and most I'm just haven't replied

1084
00:54:30,649 --> 00:54:36,109
and the small minority that have replied

1085
00:54:33,469 --> 00:54:38,599
they just said is not my problem it's

1086
00:54:36,109 --> 00:54:42,129
the manufacturers problem is that they

1087
00:54:38,599 --> 00:54:45,049
say it's the operators problem and this

1088
00:54:42,129 --> 00:54:49,159
really tells us more this is the number

1089
00:54:45,049 --> 00:54:54,159
of given and it's 0 if we talk

1090
00:54:49,159 --> 00:54:57,049
about packet storm and these news items

1091
00:54:54,159 --> 00:54:59,389
that talk about this matter and the

1092
00:54:57,049 --> 00:55:00,259
results is that we've found over 60

1093
00:54:59,389 --> 00:55:02,449
vulnerabilities which have been

1094
00:55:00,259 --> 00:55:05,329
discovered 22 root of most affected and

1095
00:55:02,449 --> 00:55:08,179
11 manufacturers here we can see the

1096
00:55:05,329 --> 00:55:09,949
winners as we could call them the were

1097
00:55:08,179 --> 00:55:13,300
the most vulnerable ones we got observer

1098
00:55:09,949 --> 00:55:15,400
then comtron to our way and i'm perd

1099
00:55:13,300 --> 00:55:17,170
if we could talk about the different

1100
00:55:15,400 --> 00:55:18,610
kinds of vulnerabilities we've got the

1101
00:55:17,170 --> 00:55:21,090
web kind which are winning but we

1102
00:55:18,610 --> 00:55:22,840
mustn't forget about the ones which are

1103
00:55:21,090 --> 00:55:26,230
smaller because they can be very

1104
00:55:22,840 --> 00:55:28,690
dangerous and can be used remotely so

1105
00:55:26,230 --> 00:55:30,100
what's the conclusion has the so haruta

1106
00:55:28,690 --> 00:55:32,200
security being improved well it's

1107
00:55:30,100 --> 00:55:35,230
obviously not been improved because we

1108
00:55:32,200 --> 00:55:37,839
found a lot of vulnerabilities that can

1109
00:55:35,230 --> 00:55:39,610
be very easily exploited I'm gonna fact

1110
00:55:37,840 --> 00:55:42,730
a lot of users so please we would ask

1111
00:55:39,610 --> 00:55:46,270
the manufacturers please to patch them

1112
00:55:42,730 --> 00:55:48,340
and resolve this so for those who that

1113
00:55:46,270 --> 00:55:50,170
are still awake just two questions if I

1114
00:55:48,340 --> 00:55:52,990
have a Rooter that provided by an

1115
00:55:50,170 --> 00:55:56,500
operator I am sure clearly not well will

1116
00:55:52,990 --> 00:55:58,270
clearly be vulnerable but they might

1117
00:55:56,500 --> 00:55:59,770
think i bought a latest generation Ruta

1118
00:55:58,270 --> 00:56:01,780
that's got a whole load of services

1119
00:55:59,770 --> 00:56:02,860
running by default well there they've

1120
00:56:01,780 --> 00:56:06,370
got you because you've got lots of

1121
00:56:02,860 --> 00:56:07,630
default services you're more exposed and

1122
00:56:06,370 --> 00:56:08,920
they're going to get to you just like

1123
00:56:07,630 --> 00:56:10,330
they were to anybody else here thank you

1124
00:56:08,920 --> 00:56:12,780
very much and will be very pleased to

1125
00:56:10,330 --> 00:56:12,779
answer any questions

1126
00:56:25,540 --> 00:56:28,080
in

1127
00:56:43,000 --> 00:56:47,370
hola

1128
00:56:45,000 --> 00:56:48,570
well which out of heaven we thank you

1129
00:56:47,370 --> 00:56:52,220
very much that too it was really good

1130
00:56:48,570 --> 00:56:52,220
what route did you have at home

1131
00:56:52,890 --> 00:57:00,920
well you start I've got a contrary which

1132
00:56:58,350 --> 00:57:06,210
is very vulnerable as well I'm not sure

1133
00:57:00,920 --> 00:57:08,430
I'm not securing anyway you know if I

1134
00:57:06,210 --> 00:57:10,800
was you I would take a Rooter which was

1135
00:57:08,430 --> 00:57:13,140
configurable with one of these ones and

1136
00:57:10,800 --> 00:57:14,610
I configure it as far as possible but

1137
00:57:13,140 --> 00:57:16,710
really you're never going to be secured

1138
00:57:14,610 --> 00:57:19,040
not with anything to hide you familiar

1139
00:57:16,710 --> 00:57:22,680
with a nick or tick from route aboard

1140
00:57:19,040 --> 00:57:24,210
they have the Rooter dos ones yet they

1141
00:57:22,680 --> 00:57:26,220
were vulnerable to a few things as well

1142
00:57:24,210 --> 00:57:27,540
so I mean well the thing is like I said

1143
00:57:26,220 --> 00:57:31,500
there are some low as we've said there

1144
00:57:27,540 --> 00:57:33,330
are some manufacturers which tend to

1145
00:57:31,500 --> 00:57:34,830
bring out many more security part

1146
00:57:33,330 --> 00:57:36,330
patches and that's better because at

1147
00:57:34,830 --> 00:57:38,100
least they answer you and they patch

1148
00:57:36,330 --> 00:57:39,480
things so they take a bit more of an

1149
00:57:38,100 --> 00:57:43,049
interest but they're still vulnerable to

1150
00:57:39,480 --> 00:57:45,230
certain problems but it's better better

1151
00:57:43,050 --> 00:57:47,490
than the ones that the SS piece give you

1152
00:57:45,230 --> 00:57:48,930
you said that there's a little did you

1153
00:57:47,490 --> 00:57:50,430
say there's a list of vulnerabilities

1154
00:57:48,930 --> 00:57:56,580
for Reuters soon as their website you

1155
00:57:50,430 --> 00:57:59,850
mentioned yes it's Rueter pound-feet 8w

1156
00:57:56,580 --> 00:58:01,560
n I think he said you click on it and it

1157
00:57:59,850 --> 00:58:03,390
launches the exploit we don't have many

1158
00:58:01,560 --> 00:58:05,790
exploits there because for a circle

1159
00:58:03,390 --> 00:58:08,609
reasons but some of them are here or

1160
00:58:05,790 --> 00:58:10,880
there in full disclosure or and you can

1161
00:58:08,610 --> 00:58:10,880
check that

1162
00:58:16,829 --> 00:58:20,589
anything you need anything you're not

1163
00:58:18,819 --> 00:58:23,380
sure about you can contact us or we'll

1164
00:58:20,589 --> 00:58:24,729
be outside with you got our emails at

1165
00:58:23,380 --> 00:58:27,059
the end so we'll be really pleased to

1166
00:58:24,729 --> 00:58:27,058
help you

