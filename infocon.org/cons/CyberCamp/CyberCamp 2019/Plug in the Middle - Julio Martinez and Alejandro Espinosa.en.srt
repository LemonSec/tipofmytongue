1
00:00:01,910 --> 00:00:04,979
[Music]

2
00:00:11,269 --> 00:00:16,770
thank you very much good afternoon

3
00:00:13,950 --> 00:00:19,650
everyone and welcome to our presentation

4
00:00:16,770 --> 00:00:21,869
plug in the middle first of all I'm

5
00:00:19,650 --> 00:00:31,589
going to introduce myself I'm alejandro

6
00:00:21,869 --> 00:00:33,600
Espinoza I have a degree in computing

7
00:00:31,590 --> 00:00:36,030
engineering I have a master in

8
00:00:33,600 --> 00:00:39,390
cybersecurity I have experience in

9
00:00:36,030 --> 00:00:43,320
ethical hacking and I have also

10
00:00:39,390 --> 00:00:48,210
developed challenges for CTS I am Julio

11
00:00:43,320 --> 00:00:50,309
Martinez I am also computing engineer by

12
00:00:48,210 --> 00:00:52,280
the University of Granada I have a

13
00:00:50,309 --> 00:00:55,578
master in cybersecurity by the

14
00:00:52,280 --> 00:01:01,199
University of Carlos the third in Madrid

15
00:00:55,579 --> 00:01:03,750
and I also have experience in deployment

16
00:01:01,199 --> 00:01:06,539
of security infrastructure and ethical

17
00:01:03,750 --> 00:01:08,700
hacking and I am in charge of

18
00:01:06,540 --> 00:01:11,040
vulnerabilities management in Orange

19
00:01:08,700 --> 00:01:13,950
Spain we will start with a brief

20
00:01:11,040 --> 00:01:17,220
introduction we will tell a real case

21
00:01:13,950 --> 00:01:20,880
which happened to us and make and made

22
00:01:17,220 --> 00:01:24,298
us think about this topic we will see

23
00:01:20,880 --> 00:01:27,119
how the protocol of PLC's work

24
00:01:24,299 --> 00:01:30,360
what attacks can be carried out against

25
00:01:27,119 --> 00:01:33,509
this kind of protocol and devices then

26
00:01:30,360 --> 00:01:36,990
we will explain to you some laboratory

27
00:01:33,509 --> 00:01:39,930
testing and the results we obtained we

28
00:01:36,990 --> 00:01:43,048
will use a demo to see how these attacks

29
00:01:39,930 --> 00:01:47,610
work and we will finish with some brief

30
00:01:43,049 --> 00:01:51,540
conclusions I guess that most of you

31
00:01:47,610 --> 00:01:54,750
know what a PLC is for those who don't

32
00:01:51,540 --> 00:01:57,509
PLC means power line communications and

33
00:01:54,750 --> 00:02:00,780
those devices are frequently used at

34
00:01:57,509 --> 00:02:06,000
home because they transmit Internet

35
00:02:00,780 --> 00:02:09,239
through the electricity grid so that the

36
00:02:06,000 --> 00:02:10,598
Internet can be transmitted to remote

37
00:02:09,239 --> 00:02:17,249
parts of the

38
00:02:10,598 --> 00:02:22,319
households it uses the home plug a a V

39
00:02:17,249 --> 00:02:27,819
protocol a standard and a typical

40
00:02:22,319 --> 00:02:30,909
architecture of this kind of plc network

41
00:02:27,819 --> 00:02:33,399
is as the one that you see on the on the

42
00:02:30,909 --> 00:02:36,780
screen the internet the devices

43
00:02:33,400 --> 00:02:42,069
connected to the Internet network and

44
00:02:36,780 --> 00:02:47,200
then a PLC is used to transmit data for

45
00:02:42,069 --> 00:02:49,060
example Wi-Fi repeater or so on I'm

46
00:02:47,200 --> 00:02:51,548
gonna tell you about a real case that

47
00:02:49,060 --> 00:02:55,120
happened to me and which was what led us

48
00:02:51,549 --> 00:02:57,760
to research on this topic this happened

49
00:02:55,120 --> 00:03:03,489
to me this summer when I moved into my

50
00:02:57,760 --> 00:03:05,560
new house before moving in I needed

51
00:03:03,489 --> 00:03:09,010
internet which is the most important

52
00:03:05,560 --> 00:03:11,859
thing so I called the company for the

53
00:03:09,010 --> 00:03:16,448
router and everything I needed the thing

54
00:03:11,859 --> 00:03:19,569
is that I had hired TV deck decoder and

55
00:03:16,449 --> 00:03:25,810
I had a logistic problem I couldn't

56
00:03:19,569 --> 00:03:29,048
connect my Wi-Fi to the TV decoder so

57
00:03:25,810 --> 00:03:32,199
what did I think okay I could install a

58
00:03:29,049 --> 00:03:34,530
long wire on cable but that was not the

59
00:03:32,199 --> 00:03:37,959
most appropriate solution another

60
00:03:34,530 --> 00:03:41,409
alternative would have been to move to

61
00:03:37,959 --> 00:03:43,180
the to change the location of the TV but

62
00:03:41,409 --> 00:03:47,649
I didn't like the distribution in my

63
00:03:43,180 --> 00:03:52,269
flat so the most feasible solution was

64
00:03:47,650 --> 00:03:54,579
to use PLC's one of the devices is

65
00:03:52,269 --> 00:03:57,159
connected to the Wi-Fi the other to the

66
00:03:54,579 --> 00:04:01,239
TV decoder and the logic stick problem

67
00:03:57,159 --> 00:04:09,159
is solved I had at home which is a

68
00:04:01,239 --> 00:04:14,259
tp-link AV 500 but then I found some

69
00:04:09,159 --> 00:04:17,349
abnormal abnormalities I noticed the

70
00:04:14,259 --> 00:04:20,889
internet was a bit slow so I thought

71
00:04:17,349 --> 00:04:23,430
what the hell I had hi I had hired

72
00:04:20,889 --> 00:04:29,130
500 Mingus why isn't it working

73
00:04:23,430 --> 00:04:34,560
I accessed the setting panel of my

74
00:04:29,130 --> 00:04:37,169
Reuter where I found that the Reuter

75
00:04:34,560 --> 00:04:40,699
that I was using was not the one that I

76
00:04:37,169 --> 00:04:44,190
had installed I mean I I had one

77
00:04:40,699 --> 00:04:47,880
Internet company and the router belonged

78
00:04:44,190 --> 00:04:55,199
to another company so I started looking

79
00:04:47,880 --> 00:04:57,900
for this Rooter in all the rooms of my

80
00:04:55,199 --> 00:05:01,320
house because maybe the landlord they

81
00:04:57,900 --> 00:05:03,510
had installed a new router I didn't know

82
00:05:01,320 --> 00:05:08,880
what to do I was about to call a medium

83
00:05:03,510 --> 00:05:14,820
to resolve the problem but then I I did

84
00:05:08,880 --> 00:05:20,930
this I entered the code of my router and

85
00:05:14,820 --> 00:05:20,930
this was the results of the search I

86
00:05:20,960 --> 00:05:29,039
didn't understand how this was working

87
00:05:25,430 --> 00:05:35,940
and this was my face when I discovered

88
00:05:29,039 --> 00:05:38,539
it another to shed some light I mean

89
00:05:35,940 --> 00:05:45,780
this has to be a scientific explanation

90
00:05:38,539 --> 00:05:48,599
so I used the tool of net discover in

91
00:05:45,780 --> 00:05:51,780
order to scan all their devices all the

92
00:05:48,599 --> 00:05:54,000
local devices which were connected there

93
00:05:51,780 --> 00:05:57,559
were two devices that were used in the

94
00:05:54,000 --> 00:06:01,530
same IP address in this case one one the

95
00:05:57,560 --> 00:06:04,590
address of the router so there were two

96
00:06:01,530 --> 00:06:07,020
devices which were competing to be the

97
00:06:04,590 --> 00:06:09,570
default gateway and that that's the

98
00:06:07,020 --> 00:06:12,539
reason why sometimes I could find one

99
00:06:09,570 --> 00:06:16,860
router and sometimes the other one so I

100
00:06:12,539 --> 00:06:19,909
accessed the panel of setting the

101
00:06:16,860 --> 00:06:23,280
setting panel of the router

102
00:06:19,909 --> 00:06:27,780
fortunately nowadays we can access the

103
00:06:23,280 --> 00:06:31,619
device directly so what I did was to

104
00:06:27,780 --> 00:06:33,030
change the setting in order to give

105
00:06:31,620 --> 00:06:43,320
another

106
00:06:33,030 --> 00:06:48,359
to have another IP address so the test

107
00:06:43,320 --> 00:06:51,030
once I had set everything up I realized

108
00:06:48,360 --> 00:06:51,570
that the speed was good the Gateway was

109
00:06:51,030 --> 00:06:54,539
good

110
00:06:51,570 --> 00:06:57,870
so I dig in a little bit more in order

111
00:06:54,540 --> 00:07:05,660
to know why this was working so in the

112
00:06:57,870 --> 00:07:05,660
range one point one I did an static IP

113
00:07:08,090 --> 00:07:16,650
when I was in in in the point number one

114
00:07:12,570 --> 00:07:18,630
I was having a Movistar static IP and

115
00:07:16,650 --> 00:07:22,620
when I was using the second one I was

116
00:07:18,630 --> 00:07:25,159
using the orange router so in the first

117
00:07:22,620 --> 00:07:28,020
case we realized we were using

118
00:07:25,160 --> 00:07:32,010
telephonic as internet and on the second

119
00:07:28,020 --> 00:07:35,940
case was using orange internet so once

120
00:07:32,010 --> 00:07:38,580
at work I said look what happened in my

121
00:07:35,940 --> 00:07:41,310
house and I shared the story with my

122
00:07:38,580 --> 00:07:43,140
colleagues and one of them said yes this

123
00:07:41,310 --> 00:07:46,530
thing happened to me when I installed a

124
00:07:43,140 --> 00:07:48,419
PLC at my place the internet wasn't

125
00:07:46,530 --> 00:07:50,460
working I could see devices that were

126
00:07:48,419 --> 00:07:53,130
not mine and I thought okay this case is

127
00:07:50,460 --> 00:07:57,659
similar to earth to mine so I downloaded

128
00:07:53,130 --> 00:08:00,330
the manufacturers to wait in this case

129
00:07:57,660 --> 00:08:05,220
is tp-link and in the setting panel I

130
00:08:00,330 --> 00:08:11,130
found a parameter which you can see on

131
00:08:05,220 --> 00:08:16,340
the screen it was default there was a

132
00:08:11,130 --> 00:08:19,890
default check check box so you I thought

133
00:08:16,340 --> 00:08:23,880
everything which is default is drunk

134
00:08:19,890 --> 00:08:27,750
oh let's change it and let's assign it a

135
00:08:23,880 --> 00:08:31,640
different network link I change it and

136
00:08:27,750 --> 00:08:33,599
automatically the network 1.1

137
00:08:31,640 --> 00:08:36,750
disappeared completely

138
00:08:33,599 --> 00:08:39,330
I didn't see any weird devices the

139
00:08:36,750 --> 00:08:41,010
internet speed was good so the

140
00:08:39,330 --> 00:08:41,980
conclusion that I could extract from

141
00:08:41,010 --> 00:08:45,730
these that

142
00:08:41,980 --> 00:08:48,580
the default password comes in every

143
00:08:45,730 --> 00:08:53,970
device and users can have some travels

144
00:08:48,580 --> 00:08:57,130
so to sum it up our network was

145
00:08:53,970 --> 00:08:59,950
overlapped with the neighbors network

146
00:08:57,130 --> 00:09:02,050
and we could see every device that my

147
00:08:59,950 --> 00:09:06,700
neighbor's was using we could use his

148
00:09:02,050 --> 00:09:10,380
router only by having a cable installed

149
00:09:06,700 --> 00:09:12,340
into an into our electricity grid and

150
00:09:10,380 --> 00:09:14,470
the other way around

151
00:09:12,340 --> 00:09:17,980
it was the same he could see all my

152
00:09:14,470 --> 00:09:20,950
devices so the physical layer is not

153
00:09:17,980 --> 00:09:24,490
been segmented which means I can be in

154
00:09:20,950 --> 00:09:29,470
my neighbors flat without any physical

155
00:09:24,490 --> 00:09:33,150
barrier preventing this on the other

156
00:09:29,470 --> 00:09:36,250
hand if my neighbor has a PLC whose

157
00:09:33,150 --> 00:09:39,130
password has not been changed it is

158
00:09:36,250 --> 00:09:43,180
going to work properly but it is exposed

159
00:09:39,130 --> 00:09:48,310
to this kind of attack so in the end all

160
00:09:43,180 --> 00:09:50,380
the security lies on the final user and

161
00:09:48,310 --> 00:09:57,760
if you are not aware of this it can't

162
00:09:50,380 --> 00:10:05,080
happen to you there are ways to attack

163
00:09:57,760 --> 00:10:08,200
Wi-Fi it is not necessary to to do maths

164
00:10:05,080 --> 00:10:10,960
just using a cable connected to the

165
00:10:08,200 --> 00:10:16,780
electricity grid we could access my

166
00:10:10,960 --> 00:10:18,940
neighbor's Internet once this happened

167
00:10:16,780 --> 00:10:24,150
we started to do some research in order

168
00:10:18,940 --> 00:10:27,760
to understand properly how PLC's work

169
00:10:24,150 --> 00:10:30,850
because we wanted to go far beyond it

170
00:10:27,760 --> 00:10:33,880
seemed that these PLC's are not as

171
00:10:30,850 --> 00:10:37,770
secure as we thought they were so let's

172
00:10:33,880 --> 00:10:40,270
explain now how these protocol works and

173
00:10:37,770 --> 00:10:43,630
then we will see what kind of attacks

174
00:10:40,270 --> 00:10:47,050
can be carried out against this protocol

175
00:10:43,630 --> 00:10:50,400
the protocol you see is layers 1 & 2 of

176
00:10:47,050 --> 00:10:50,400
the OSI model

177
00:10:51,500 --> 00:11:01,670
/ laughs a wave the one that transmits

178
00:10:55,170 --> 00:11:04,349
signals over the lair of the traditional

179
00:11:01,670 --> 00:11:07,469
of the traditional signal and that's the

180
00:11:04,350 --> 00:11:10,350
way information is transmitted there

181
00:11:07,470 --> 00:11:12,960
should be something that could prevent

182
00:11:10,350 --> 00:11:17,460
the dissemination of that wave to all

183
00:11:12,960 --> 00:11:20,700
the flats in our in our building for

184
00:11:17,460 --> 00:11:24,570
example and these device should be

185
00:11:20,700 --> 00:11:32,150
installed in the buildings in the

186
00:11:24,570 --> 00:11:36,450
building facilities then there is

187
00:11:32,150 --> 00:11:39,650
something called chokes which could stop

188
00:11:36,450 --> 00:11:42,330
the wave from disseminating

189
00:11:39,650 --> 00:11:46,620
manufacturers do not usually incorporate

190
00:11:42,330 --> 00:11:52,350
this component or this component may not

191
00:11:46,620 --> 00:11:56,220
have all the necessary barriers so as

192
00:11:52,350 --> 00:12:00,300
for PLC's all the flats in a building

193
00:11:56,220 --> 00:12:03,570
could be interconnected and even between

194
00:12:00,300 --> 00:12:07,979
different buildings this could happen as

195
00:12:03,570 --> 00:12:15,450
well if they are close enough PLC's as

196
00:12:07,980 --> 00:12:19,800
manufacturers says use use different

197
00:12:15,450 --> 00:12:23,460
kind of encryption which is implemented

198
00:12:19,800 --> 00:12:29,550
between one PLC device and another PhD

199
00:12:23,460 --> 00:12:34,410
device between the PLC and host you

200
00:12:29,550 --> 00:12:37,620
don't need that encryption one of the

201
00:12:34,410 --> 00:12:42,860
most important concepts to understand is

202
00:12:37,620 --> 00:12:47,160
this a VL n it is a via logical network

203
00:12:42,860 --> 00:12:51,830
since PLC's are connected to a shared

204
00:12:47,160 --> 00:12:55,430
medium it'll be like type boost typology

205
00:12:51,830 --> 00:12:55,430
they generate

206
00:12:55,619 --> 00:13:06,009
real ends through cryptography all PLC's

207
00:13:01,860 --> 00:13:09,790
within the same VLAN shared the same

208
00:13:06,009 --> 00:13:12,879
keys and in this way they can be

209
00:13:09,790 --> 00:13:16,449
isolated from external PLC's that could

210
00:13:12,879 --> 00:13:20,379
access information from our network all

211
00:13:16,449 --> 00:13:22,779
the PLC's within a VLAN are called

212
00:13:20,379 --> 00:13:25,720
stations and one of them is the central

213
00:13:22,779 --> 00:13:28,360
coordinator or CCO the central

214
00:13:25,720 --> 00:13:32,439
coordination is responsible for the

215
00:13:28,360 --> 00:13:35,709
authentication of pls of new PLC's which

216
00:13:32,439 --> 00:13:39,219
want to be connected to the VLAN and it

217
00:13:35,709 --> 00:13:40,238
also sets up some parameters such as

218
00:13:39,220 --> 00:13:44,319
modulation

219
00:13:40,239 --> 00:13:48,220
it also renews the encryption keys that

220
00:13:44,319 --> 00:13:50,709
all the members of this network use in

221
00:13:48,220 --> 00:13:53,350
order to better understand all the

222
00:13:50,709 --> 00:13:56,738
encryption mechanisms they use let's

223
00:13:53,350 --> 00:13:59,799
explain the four keys that are used in

224
00:13:56,739 --> 00:14:03,160
the home plug AV protocol first one is

225
00:13:59,799 --> 00:14:07,299
the Network membership key which is the

226
00:14:03,160 --> 00:14:10,350
one used by stations to authentic a

227
00:14:07,299 --> 00:14:16,779
two-fold the authentication against an

228
00:14:10,350 --> 00:14:19,360
AVL n then we have the da key which is

229
00:14:16,779 --> 00:14:22,419
device access key which is a unique key

230
00:14:19,360 --> 00:14:26,230
for each device which is generated by

231
00:14:22,419 --> 00:14:30,639
the password printed on the back part of

232
00:14:26,230 --> 00:14:37,389
the PLC sits it is used to exchange the

233
00:14:30,639 --> 00:14:40,089
in MK in a safe way the following one is

234
00:14:37,389 --> 00:14:43,049
the neck network encryption key which is

235
00:14:40,089 --> 00:14:47,790
used by all the PLC's you know that you

236
00:14:43,049 --> 00:14:51,489
encrypt all the stations within an AV LM

237
00:14:47,790 --> 00:14:56,110
finally we have a Tek temporary

238
00:14:51,489 --> 00:14:59,290
encryption key which is used in the

239
00:14:56,110 --> 00:15:03,689
mechanism of key exchanges in order to

240
00:14:59,290 --> 00:15:07,469
do it in a secure way the two most

241
00:15:03,689 --> 00:15:09,930
important keys are they - first one

242
00:15:07,470 --> 00:15:12,000
Network membership key and device access

243
00:15:09,930 --> 00:15:16,589
key because we are going to be attacked

244
00:15:12,000 --> 00:15:20,160
in other two axes external networks both

245
00:15:16,590 --> 00:15:24,000
kids are derivation from all the

246
00:15:20,160 --> 00:15:32,969
passwords the a key is a derivation of

247
00:15:24,000 --> 00:15:36,660
the password printed on the device how

248
00:15:32,970 --> 00:15:42,210
can we generate how this derivation

249
00:15:36,660 --> 00:15:48,110
works it uses a function called p VK d

250
00:15:42,210 --> 00:15:48,110
f1 which is public and has five criteria

251
00:15:50,120 --> 00:16:02,700
then salt a hash function a number of

252
00:15:54,000 --> 00:16:05,310
iterations hash length therefore all the

253
00:16:02,700 --> 00:16:07,620
in m key and da key are going to have

254
00:16:05,310 --> 00:16:09,869
the same length out of these criteria

255
00:16:07,620 --> 00:16:15,480
and we know for because they are fixed

256
00:16:09,870 --> 00:16:18,630
and defined in the protocol salt is

257
00:16:15,480 --> 00:16:22,170
fixed a hash function is the same the

258
00:16:18,630 --> 00:16:27,240
number of iterations is 1000 and the

259
00:16:22,170 --> 00:16:32,069
length is 16 so all the da K and M K

260
00:16:27,240 --> 00:16:35,700
have a length of 16 bytes in order to go

261
00:16:32,070 --> 00:16:39,390
in depth of these key generation we

262
00:16:35,700 --> 00:16:43,230
carried out a test another to do so we

263
00:16:39,390 --> 00:16:45,060
took the PLC you can see the tab on the

264
00:16:43,230 --> 00:16:48,360
device where you can see the MAC address

265
00:16:45,060 --> 00:16:52,979
and the password and in order to do so

266
00:16:48,360 --> 00:16:56,430
we used the tool the manufacturers tool

267
00:16:52,980 --> 00:16:59,280
which also included the same information

268
00:16:56,430 --> 00:17:03,750
than the tag on the device in order to

269
00:16:59,280 --> 00:17:06,849
generate the the 80 nm key we used an

270
00:17:03,750 --> 00:17:11,079
existing script which uses

271
00:17:06,849 --> 00:17:13,480
the DEA key or in MK and generates the

272
00:17:11,079 --> 00:17:19,178
derivation which is the one that you see

273
00:17:13,480 --> 00:17:19,990
on screen to see that it is doing it

274
00:17:19,179 --> 00:17:25,500
correctly

275
00:17:19,990 --> 00:17:36,600
we used the manufacturers tool we set up

276
00:17:25,500 --> 00:17:44,019
PLC remotely and then things to these

277
00:17:36,600 --> 00:17:49,449
the tool will generate the MK and the

278
00:17:44,019 --> 00:17:53,940
DAK to the plc if we compare these to

279
00:17:49,450 --> 00:17:58,419
the we if we compare this we can see

280
00:17:53,940 --> 00:18:01,120
that there are two fields one is the n

281
00:17:58,419 --> 00:18:03,759
MK and the other one is da key we can

282
00:18:01,120 --> 00:18:05,860
see that the da key is the one that we

283
00:18:03,759 --> 00:18:10,450
generated through the script so we

284
00:18:05,860 --> 00:18:15,250
managed to do it once we have generated

285
00:18:10,450 --> 00:18:19,570
the da key and the n MK we can see how

286
00:18:15,250 --> 00:18:22,919
these keys can be exchanged in PLC's

287
00:18:19,570 --> 00:18:26,470
there are three mechanisms the first one

288
00:18:22,919 --> 00:18:29,350
is when there is a direct connectivity

289
00:18:26,470 --> 00:18:35,620
through an Ethernet cable or through a

290
00:18:29,350 --> 00:18:38,379
router or a switch the host gives the

291
00:18:35,620 --> 00:18:41,289
PLC the key without any kind of

292
00:18:38,379 --> 00:18:45,370
encryption or authentication process the

293
00:18:41,289 --> 00:18:48,190
two following ones are for remote PLC's

294
00:18:45,370 --> 00:18:52,268
or who can be connected through the

295
00:18:48,190 --> 00:18:55,809
electricity grid the first one is the da

296
00:18:52,269 --> 00:19:02,169
key based in MK distribution protocol

297
00:18:55,809 --> 00:19:06,908
which sends the n MK to the da key in an

298
00:19:02,169 --> 00:19:10,360
encrypted way you only need to establish

299
00:19:06,909 --> 00:19:13,659
this mechanism so that no other devices

300
00:19:10,360 --> 00:19:16,979
can detect it so this individual

301
00:19:13,659 --> 00:19:21,630
password from the plc is encrypted

302
00:19:16,980 --> 00:19:25,980
only the final user can de encrypted

303
00:19:21,630 --> 00:19:30,900
decoded the year following mechanism is

304
00:19:25,980 --> 00:19:34,440
the Yuki ke and it is for devices which

305
00:19:30,900 --> 00:19:39,840
have a matching button when they receive

306
00:19:34,440 --> 00:19:45,360
the the signal after pushing the button

307
00:19:39,840 --> 00:19:52,919
both PLC's will exchange some hash they

308
00:19:45,360 --> 00:19:59,010
will build temporary key and it will be

309
00:19:52,920 --> 00:20:02,010
sent to the other device once the an MK

310
00:19:59,010 --> 00:20:08,340
has been exchanged it needs to be

311
00:20:02,010 --> 00:20:11,370
authenticated they will send a packet to

312
00:20:08,340 --> 00:20:15,620
the CCO in order to ask for

313
00:20:11,370 --> 00:20:21,090
identification the CCO will receive the

314
00:20:15,620 --> 00:20:24,899
M key okay and then if it matches with

315
00:20:21,090 --> 00:20:33,540
the one it has it will enable the

316
00:20:24,900 --> 00:20:35,520
authentication more practical example we

317
00:20:33,540 --> 00:20:38,460
have a user that wants to set up two

318
00:20:35,520 --> 00:20:40,530
different PLC's one has direct

319
00:20:38,460 --> 00:20:44,390
connectivity through the electricity

320
00:20:40,530 --> 00:20:49,830
grid they one above and below box is

321
00:20:44,390 --> 00:20:55,650
through network for the local one with

322
00:20:49,830 --> 00:20:58,800
the manufacturer's tool just say the

323
00:20:55,650 --> 00:21:02,220
network name the name of the network you

324
00:20:58,800 --> 00:21:04,740
want to set up and then the PLC would

325
00:21:02,220 --> 00:21:11,610
receive this packet without any

326
00:21:04,740 --> 00:21:14,580
encryption through Ethernet platform as

327
00:21:11,610 --> 00:21:18,750
for the remote case the user would need

328
00:21:14,580 --> 00:21:25,949
to give the password and the network

329
00:21:18,750 --> 00:21:28,549
name then the program will derivate both

330
00:21:25,950 --> 00:21:34,359
keys and will

331
00:21:28,549 --> 00:21:38,059
send the remote divides the nmk

332
00:21:34,359 --> 00:21:40,939
encrypted through the da key once we

333
00:21:38,059 --> 00:21:43,099
have already understood how keys work

334
00:21:40,940 --> 00:21:45,169
let's move on to the interesting part

335
00:21:43,099 --> 00:21:49,189
attacks when we started to do some

336
00:21:45,169 --> 00:21:52,999
research we reviewed the state of the

337
00:21:49,190 --> 00:21:57,159
art what was in the market all the tools

338
00:21:52,999 --> 00:22:02,809
and so on and we realized the were very

339
00:21:57,159 --> 00:22:05,989
few very little research on it the most

340
00:22:02,809 --> 00:22:08,839
written recent one was published four

341
00:22:05,989 --> 00:22:10,549
years ago for example and we only found

342
00:22:08,839 --> 00:22:14,649
all these attacks

343
00:22:10,549 --> 00:22:18,408
the first one is quite easy through a

344
00:22:14,649 --> 00:22:21,728
LAN connection and the third and fourth

345
00:22:18,409 --> 00:22:25,190
for remote attacks which more

346
00:22:21,729 --> 00:22:28,039
interesting to us because with them you

347
00:22:25,190 --> 00:22:30,589
can steal Wi-Fi from your neighbours the

348
00:22:28,039 --> 00:22:37,129
first one is interception which would

349
00:22:30,589 --> 00:22:42,918
consist trying to set up the network

350
00:22:37,129 --> 00:22:47,208
name and in order to do so you will need

351
00:22:42,919 --> 00:22:51,859
to be in between the communication with

352
00:22:47,209 --> 00:22:55,399
the final user and the PLC itself this

353
00:22:51,859 --> 00:22:58,458
is very improbable because usually PLC's

354
00:22:55,399 --> 00:23:03,320
are only set up once when they are

355
00:22:58,459 --> 00:23:05,450
installed so it is quite unlikely but

356
00:23:03,320 --> 00:23:09,589
there is another way of doing it as I

357
00:23:05,450 --> 00:23:14,479
said any PLC is going to accept any D a

358
00:23:09,589 --> 00:23:18,259
key change through direct connectivity

359
00:23:14,479 --> 00:23:19,159
with a local connection without asking

360
00:23:18,259 --> 00:23:21,919
any questions

361
00:23:19,159 --> 00:23:25,609
so if you had this you could send it a

362
00:23:21,919 --> 00:23:28,669
packet a asking it to change the network

363
00:23:25,609 --> 00:23:31,519
name the advantage is that you don't

364
00:23:28,669 --> 00:23:34,800
need physical access but if you manage

365
00:23:31,519 --> 00:23:38,880
to do so you can change it

366
00:23:34,800 --> 00:23:43,290
you can change the network name plug in

367
00:23:38,880 --> 00:23:45,390
our PLC rename it with the same name

368
00:23:43,290 --> 00:23:48,030
that we sent to the other one and then

369
00:23:45,390 --> 00:23:53,280
we'll already be connected to the router

370
00:23:48,030 --> 00:23:57,629
the second attack is a remote one and it

371
00:23:53,280 --> 00:24:00,090
would be to exert brute force to the MK

372
00:23:57,630 --> 00:24:05,220
for example through a dictionary attack

373
00:24:00,090 --> 00:24:07,530
we try to search for this attack and it

374
00:24:05,220 --> 00:24:11,190
wasn't done so we implemented it how

375
00:24:07,530 --> 00:24:14,160
does it work we have a PLC which acts as

376
00:24:11,190 --> 00:24:18,360
an attacker and we change the network

377
00:24:14,160 --> 00:24:22,650
name of this PLC and we ask it if it had

378
00:24:18,360 --> 00:24:25,949
been connected to any network once we

379
00:24:22,650 --> 00:24:28,740
have found a network then we have found

380
00:24:25,950 --> 00:24:31,920
a network name which can be useful for

381
00:24:28,740 --> 00:24:35,640
us however we were quite disappointed

382
00:24:31,920 --> 00:24:40,460
because an attempt took us seven seconds

383
00:24:35,640 --> 00:24:43,290
which is the time used to for the

384
00:24:40,460 --> 00:24:46,790
authentication process of the attack

385
00:24:43,290 --> 00:24:50,190
seven seconds for a complex password

386
00:24:46,790 --> 00:24:52,290
will not enable us to obtain the

387
00:24:50,190 --> 00:24:55,440
password because we could spend years

388
00:24:52,290 --> 00:24:57,840
and years trying to find it then we

389
00:24:55,440 --> 00:25:02,210
found a much more interesting attack

390
00:24:57,840 --> 00:25:07,379
which was invented by Sebastian du Lac

391
00:25:02,210 --> 00:25:11,430
it's name is ko duck and instead of

392
00:25:07,380 --> 00:25:17,370
attacking D and M key it attacks the

393
00:25:11,430 --> 00:25:21,210
duck this person realized that there is

394
00:25:17,370 --> 00:25:24,209
a pattern in all passwords which give us

395
00:25:21,210 --> 00:25:28,050
a combination of as you can see on the

396
00:25:24,210 --> 00:25:32,760
screen I cannot even say the number it

397
00:25:28,050 --> 00:25:39,090
will be impossible to use brute force

398
00:25:32,760 --> 00:25:42,810
against the program by day manufacturer

399
00:25:39,090 --> 00:25:46,050
was able to recover the password and to

400
00:25:42,810 --> 00:25:48,929
show it to the user immediately

401
00:25:46,050 --> 00:25:54,230
and there was a question that arose from

402
00:25:48,930 --> 00:25:54,230
that how can it recover it immediately

403
00:25:56,990 --> 00:26:04,320
what did he do he did reverse

404
00:26:00,860 --> 00:26:08,699
engineering to the program and he

405
00:26:04,320 --> 00:26:11,399
realized that the password is not

406
00:26:08,700 --> 00:26:17,160
randomly generated it is generated

407
00:26:11,400 --> 00:26:20,220
through the MAC address obviously he

408
00:26:17,160 --> 00:26:23,270
realized it was a huge security problem

409
00:26:20,220 --> 00:26:26,790
so he reprogrammed the algorithm and

410
00:26:23,270 --> 00:26:30,210
could recover the password through the

411
00:26:26,790 --> 00:26:33,629
MAC address of the device so we do no

412
00:26:30,210 --> 00:26:36,600
longer need a password of the plc in

413
00:26:33,630 --> 00:26:41,960
order to control it you just need to

414
00:26:36,600 --> 00:26:46,379
need the MAC address we have two cases

415
00:26:41,960 --> 00:26:50,610
regarding these when the plc is the

416
00:26:46,380 --> 00:26:55,680
attacker decisio is going to emit some

417
00:26:50,610 --> 00:26:58,139
icons in order to get the MAC address

418
00:26:55,680 --> 00:27:02,430
for the rest of the stations it is more

419
00:26:58,140 --> 00:27:04,950
complicated because they cannot emit any

420
00:27:02,430 --> 00:27:08,060
becomes so we cannot know the MAC

421
00:27:04,950 --> 00:27:12,830
address instantly however we can exert

422
00:27:08,060 --> 00:27:18,540
brute force instead of exerting brute

423
00:27:12,830 --> 00:27:22,050
force to the plc we do it to the DAC so

424
00:27:18,540 --> 00:27:24,990
we have reduced the possibilities they

425
00:27:22,050 --> 00:27:29,850
quite a lot as you can see but we can do

426
00:27:24,990 --> 00:27:32,700
more usually a plc usually the rest of

427
00:27:29,850 --> 00:27:33,659
PLC's are going to belong to the same

428
00:27:32,700 --> 00:27:35,940
manufacturer

429
00:27:33,660 --> 00:27:41,670
so because usually they are sold in

430
00:27:35,940 --> 00:27:44,940
pairs so we can assume that they are

431
00:27:41,670 --> 00:27:49,520
going to have the same vendor bytes than

432
00:27:44,940 --> 00:27:52,429
they seized you so we have reduced it to

433
00:27:49,520 --> 00:27:59,710
256

434
00:27:52,429 --> 00:28:02,659
with an exponential three which is a

435
00:27:59,710 --> 00:28:06,320
significant reduction and it will be

436
00:28:02,659 --> 00:28:08,659
much more easier to do it and let's talk

437
00:28:06,320 --> 00:28:10,879
now about the testing we have carried

438
00:28:08,659 --> 00:28:13,789
out and the results I am going to talk

439
00:28:10,879 --> 00:28:16,158
about the laboratory testing this is

440
00:28:13,789 --> 00:28:20,450
much more practical than what Alejandro

441
00:28:16,159 --> 00:28:29,090
was telling us what we did was to start

442
00:28:20,450 --> 00:28:33,440
with Sebastian dudx research in 2015 it

443
00:28:29,090 --> 00:28:37,908
includes toolkit to carry out attacks to

444
00:28:33,440 --> 00:28:41,600
homeplug AV it implements the attack

445
00:28:37,909 --> 00:28:46,279
kodak it also included the script which

446
00:28:41,600 --> 00:28:51,019
as we saw was generating da key and an M

447
00:28:46,279 --> 00:28:53,179
key password generation and we have

448
00:28:51,019 --> 00:28:56,090
other interest interest in

449
00:28:53,179 --> 00:28:59,840
functionalities such as the discovery

450
00:28:56,090 --> 00:29:04,158
tool where you can see the MAC addresses

451
00:28:59,840 --> 00:29:07,369
of devices and then we have the daemon

452
00:29:04,159 --> 00:29:13,580
neutralization tool which doesn't take

453
00:29:07,369 --> 00:29:16,610
into account of the beacons we realized

454
00:29:13,580 --> 00:29:21,080
the was room for improvement in this

455
00:29:16,610 --> 00:29:25,719
repository so we carried out our fork we

456
00:29:21,080 --> 00:29:29,119
realized that we implemented the name

457
00:29:25,720 --> 00:29:33,110
change scenery attacked which is quite

458
00:29:29,119 --> 00:29:37,629
interesting we care we carried out

459
00:29:33,110 --> 00:29:40,580
another script they said local in MK

460
00:29:37,629 --> 00:29:43,340
which is quite interesting because if we

461
00:29:40,580 --> 00:29:45,740
have a PLC behind the router we wouldn't

462
00:29:43,340 --> 00:29:49,668
see it but if we do it with the said

463
00:29:45,740 --> 00:29:51,679
local and ma key it'll be much more much

464
00:29:49,669 --> 00:29:54,769
easier because we are connected to an

465
00:29:51,679 --> 00:29:57,559
Ethernet network then we also corrected

466
00:29:54,769 --> 00:30:01,359
bugs because there were some exceptions

467
00:29:57,559 --> 00:30:06,200
which were not properly controlled and

468
00:30:01,359 --> 00:30:10,970
the the information was not completed so

469
00:30:06,200 --> 00:30:13,159
we added some more information these are

470
00:30:10,970 --> 00:30:16,849
the battery of PVC devices that we've

471
00:30:13,159 --> 00:30:19,879
used most of them are tippity really

472
00:30:16,849 --> 00:30:22,158
some of them linked they use different

473
00:30:19,879 --> 00:30:24,978
type of protocols the most motor one a

474
00:30:22,159 --> 00:30:27,979
low for a 1000 megabytes per second

475
00:30:24,979 --> 00:30:31,729
speed and as they are using the home

476
00:30:27,979 --> 00:30:35,539
play new algorithm this allows for a

477
00:30:31,729 --> 00:30:38,779
more must speak to so we've seen that le

478
00:30:35,539 --> 00:30:40,729
and attack can be done to any of them

479
00:30:38,779 --> 00:30:44,269
because this is related to sniffing

480
00:30:40,729 --> 00:30:45,769
packages in the network and m'kay and

481
00:30:44,269 --> 00:30:48,649
the aka

482
00:30:45,769 --> 00:30:54,399
also can be attacked through brute force

483
00:30:48,649 --> 00:30:58,518
and KO dak is the most efficient one and

484
00:30:54,399 --> 00:31:01,488
we've seen that attacks can happen to

485
00:30:58,519 --> 00:31:03,139
most of them but for the most recent

486
00:31:01,489 --> 00:31:05,210
ones because probably the manufacturer

487
00:31:03,139 --> 00:31:07,029
has changed the algorithm so it's not

488
00:31:05,210 --> 00:31:12,440
possible to attack them that way anymore

489
00:31:07,029 --> 00:31:14,029
we've built demo this is the scenario

490
00:31:12,440 --> 00:31:16,519
that we are going to represent we have a

491
00:31:14,029 --> 00:31:17,720
little ADT made network with a laptop in

492
00:31:16,519 --> 00:31:20,179
this case we're going to use a little

493
00:31:17,720 --> 00:31:23,840
Alexander Alejandro laptop and then we

494
00:31:20,179 --> 00:31:30,259
have a raspberry VI that can be also you

495
00:31:23,840 --> 00:31:32,178
know home both use video devices and I'm

496
00:31:30,259 --> 00:31:37,759
going to be solely speaking a different

497
00:31:32,179 --> 00:31:41,629
floor you've seen a different PLC with

498
00:31:37,759 --> 00:31:44,659
the computer of the attacker and we

499
00:31:41,629 --> 00:31:46,309
would be completely isolated we've

500
00:31:44,659 --> 00:31:50,389
thought that he would be smart enough to

501
00:31:46,309 --> 00:31:53,629
change the default password is not home

502
00:31:50,389 --> 00:31:57,549
to black no more so this is why this

503
00:31:53,629 --> 00:31:57,549
test is more difficult

504
00:32:29,160 --> 00:32:34,300
so this is the smallest an area that we

505
00:32:31,750 --> 00:32:36,940
have these two PLC's are coupled and

506
00:32:34,300 --> 00:32:39,310
this is the PLC of the attacker I don't

507
00:32:36,940 --> 00:32:42,940
know if you can see it properly but they

508
00:32:39,310 --> 00:32:46,240
we have here some LEDs here we have the

509
00:32:42,940 --> 00:32:48,070
three LEDs on and the attacker one there

510
00:32:46,240 --> 00:32:52,960
is a lady in the middle which is off

511
00:32:48,070 --> 00:33:02,100
this show simply disconnected to VNL or

512
00:32:52,960 --> 00:33:04,630
not so this is the vision of a user home

513
00:33:02,100 --> 00:33:07,510
like a view would be that one you could

514
00:33:04,630 --> 00:33:08,980
be able to see both devices so now if

515
00:33:07,510 --> 00:33:10,480
you look at my tool this is the view

516
00:33:08,980 --> 00:33:12,790
that I have from the point of view of

517
00:33:10,480 --> 00:33:14,890
the attacker I'm not coupled with any

518
00:33:12,790 --> 00:33:17,639
device I'm using a completely isolated

519
00:33:14,890 --> 00:33:17,640
device

520
00:33:32,600 --> 00:33:40,620
are you able to see the screen properly

521
00:33:35,840 --> 00:33:42,000
what I'm writing so these are the

522
00:33:40,620 --> 00:33:45,659
scripts that we've mentioned before

523
00:33:42,000 --> 00:33:49,440
first of all we are going to check what

524
00:33:45,660 --> 00:33:52,140
devices we are visualizing this is why

525
00:33:49,440 --> 00:33:56,190
we are using this script script

526
00:33:52,140 --> 00:34:02,880
discovery we can see that there is one

527
00:33:56,190 --> 00:34:05,010
station so this is my PLC device I don't

528
00:34:02,880 --> 00:34:07,800
know why we cannot see the rest of them

529
00:34:05,010 --> 00:34:09,989
normally we usually can see more a

530
00:34:07,800 --> 00:34:13,230
different type of devices behind besides

531
00:34:09,989 --> 00:34:16,139
besides our interface but well this is

532
00:34:13,230 --> 00:34:20,699
the PLC that is connected to us attacker

533
00:34:16,139 --> 00:34:31,080
PLC I'm going to give this MAC address

534
00:34:20,699 --> 00:34:35,719
I'm going to type please and with this

535
00:34:31,080 --> 00:34:38,549
information I'm going to have my own MK

536
00:34:35,719 --> 00:34:41,299
password for my own device because I

537
00:34:38,550 --> 00:34:45,149
want out the other network the other two

538
00:34:41,300 --> 00:34:47,360
PLC's use the same password so I'm going

539
00:34:45,149 --> 00:34:50,699
to set our password that I already know

540
00:34:47,360 --> 00:34:53,010
with the - K parameter I could introduce

541
00:34:50,699 --> 00:34:55,199
one but as a parameter I'm going to

542
00:34:53,010 --> 00:35:00,150
leave it blank which would be like

543
00:34:55,199 --> 00:35:02,100
typing zeros then I have sent our

544
00:35:00,150 --> 00:35:06,560
success message with me which means they

545
00:35:02,100 --> 00:35:06,560
change has been done successfully the

546
00:35:07,760 --> 00:35:18,630
next step that we are going to do is to

547
00:35:12,090 --> 00:35:21,360
analyze with cc o which remote CCO

548
00:35:18,630 --> 00:35:26,010
exists in order to see to which we can

549
00:35:21,360 --> 00:35:28,860
connect we've seen that then the network

550
00:35:26,010 --> 00:35:33,240
is being analyzed and we found this

551
00:35:28,860 --> 00:35:36,450
station well this is the one that we

552
00:35:33,240 --> 00:35:40,890
want to check so this is the remote PLC

553
00:35:36,450 --> 00:35:42,910
that is being CC o of the network that's

554
00:35:40,890 --> 00:35:46,368
connecting

555
00:35:42,910 --> 00:35:50,839
so we're going to keep that address and

556
00:35:46,369 --> 00:35:54,410
we are going to execute the ko

557
00:35:50,839 --> 00:35:55,940
dak attack so before launching the

558
00:35:54,410 --> 00:35:59,118
attack we are going to analyze the

559
00:35:55,940 --> 00:36:05,599
script so that we understand what we are

560
00:35:59,119 --> 00:36:08,180
doing so this is it first part involves

561
00:36:05,599 --> 00:36:12,519
the parameter parameters introduced by

562
00:36:08,180 --> 00:36:15,109
the user so here we can see the password

563
00:36:12,519 --> 00:36:18,500
established by default which is zero

564
00:36:15,109 --> 00:36:21,680
zero zero and then we have another

565
00:36:18,500 --> 00:36:27,859
address that is being spoofed that could

566
00:36:21,680 --> 00:36:30,440
be changed to here we have a loop so in

567
00:36:27,859 --> 00:36:32,390
case we are adding a MAC address which

568
00:36:30,440 --> 00:36:39,440
is not complete this is going to be

569
00:36:32,390 --> 00:36:41,750
completed by using brute force and this

570
00:36:39,440 --> 00:36:43,549
would be the second phase of the attack

571
00:36:41,750 --> 00:36:46,339
that would involve attacking station

572
00:36:43,549 --> 00:36:49,460
that are not visible and then here we

573
00:36:46,339 --> 00:36:53,000
would have implemented automatically the

574
00:36:49,460 --> 00:36:59,839
fact of taking Mac direction and

575
00:36:53,000 --> 00:37:03,289
translating it into a day dak key here

576
00:36:59,839 --> 00:37:05,509
we would use that algorithm in order to

577
00:37:03,289 --> 00:37:08,539
put it in the right format and finally

578
00:37:05,509 --> 00:37:12,890
we would be sending it sending it by

579
00:37:08,539 --> 00:37:14,509
using the appropriate library now we are

580
00:37:12,890 --> 00:37:26,180
going to launch it we're going to launch

581
00:37:14,509 --> 00:37:28,130
the attack this would be the CCO and as

582
00:37:26,180 --> 00:37:30,769
you can see here we are having

583
00:37:28,130 --> 00:37:34,849
automatically the TAC once we have the

584
00:37:30,769 --> 00:37:38,209
MAC address the algorithm can act quite

585
00:37:34,849 --> 00:37:39,940
fast we are going to eliminate the dots

586
00:37:38,210 --> 00:37:43,610
here so that it works

587
00:37:39,940 --> 00:37:47,690
we've send the package

588
00:37:43,610 --> 00:37:49,610
I mean this is going to send the DAK

589
00:37:47,690 --> 00:37:55,220
that has been generated automatically

590
00:37:49,610 --> 00:37:58,610
and if we update our view now we should

591
00:37:55,220 --> 00:38:01,730
be able to see the device so here we are

592
00:37:58,610 --> 00:38:06,170
we have it so what we've done now is to

593
00:38:01,730 --> 00:38:08,510
configure eight the name and MK

594
00:38:06,170 --> 00:38:11,030
automatically to the central coordinator

595
00:38:08,510 --> 00:38:13,730
of the network because this was in

596
00:38:11,030 --> 00:38:17,440
charge of issuing the because of the

597
00:38:13,730 --> 00:38:20,750
network but now we have an isolated PLC

598
00:38:17,440 --> 00:38:23,810
begin these PLC is not emitting beacon

599
00:38:20,750 --> 00:38:26,150
because it wasn't in charge of that so

600
00:38:23,810 --> 00:38:27,799
we cannot figure out that I may see the

601
00:38:26,150 --> 00:38:30,050
MAC address and this is why we're going

602
00:38:27,800 --> 00:38:34,130
to use the brute force we are going to

603
00:38:30,050 --> 00:38:36,770
last vendor bytes the ones that belong

604
00:38:34,130 --> 00:38:39,920
to the device and now we would have to

605
00:38:36,770 --> 00:38:47,090
try with all the addresses until we find

606
00:38:39,920 --> 00:38:51,110
some one some until we find one of them

607
00:38:47,090 --> 00:38:52,520
that is useful for our objective I'm not

608
00:38:51,110 --> 00:38:56,630
going to the whole process because it

609
00:38:52,520 --> 00:39:01,250
can take a while but the result could be

610
00:38:56,630 --> 00:39:03,710
this one and here you can see the third

611
00:39:01,250 --> 00:39:06,380
device and we would have completed our

612
00:39:03,710 --> 00:39:08,480
attack a successful successfully from

613
00:39:06,380 --> 00:39:10,430
this tool for example we would be able

614
00:39:08,480 --> 00:39:12,980
to change their password to all devices

615
00:39:10,430 --> 00:39:21,830
at the same time for example I'm going

616
00:39:12,980 --> 00:39:23,810
to write down cyber camp 2019 and for

617
00:39:21,830 --> 00:39:26,950
example if we take a look with the

618
00:39:23,810 --> 00:39:36,310
camera we are going to see that the lips

619
00:39:26,950 --> 00:39:39,140
are like shining so it means that we are

620
00:39:36,310 --> 00:39:41,420
coupling with a network they are

621
00:39:39,140 --> 00:39:44,810
exchanging information so this one has

622
00:39:41,420 --> 00:39:52,010
already been toppled and okay now all of

623
00:39:44,810 --> 00:39:55,250
them have been coupled so let's see if

624
00:39:52,010 --> 00:39:58,050
this is synchronized okay so we've seen

625
00:39:55,250 --> 00:40:01,020
that this attack works quite well

626
00:39:58,050 --> 00:40:03,120
is quite fast the problem is that we are

627
00:40:01,020 --> 00:40:05,220
going to interrupt the service for a

628
00:40:03,120 --> 00:40:07,650
period of time so let's see the

629
00:40:05,220 --> 00:40:10,740
advantages and disadvantages of the

630
00:40:07,650 --> 00:40:12,900
other type of attack and MK dictionary

631
00:40:10,740 --> 00:40:16,259
attack in order to go back to our

632
00:40:12,900 --> 00:40:19,320
previous dictionary I'm going to put the

633
00:40:16,260 --> 00:40:21,690
local key here in my advice and

634
00:40:19,320 --> 00:40:32,640
therefore it is going to isolate me from

635
00:40:21,690 --> 00:40:34,680
the network so I'm already out the

636
00:40:32,640 --> 00:40:41,129
network and now we are going to do a

637
00:40:34,680 --> 00:40:43,440
brute-force attack one of the parameter

638
00:40:41,130 --> 00:40:47,720
is going to be the MAC address of my own

639
00:40:43,440 --> 00:40:50,760
device that because as we've said before

640
00:40:47,720 --> 00:40:53,790
this use is my own device in order to

641
00:40:50,760 --> 00:40:58,860
see if I can couple with a network by

642
00:40:53,790 --> 00:41:02,880
just testing passwords so we have to of

643
00:40:58,860 --> 00:41:09,980
course type a dictionary that we've had

644
00:41:02,880 --> 00:41:13,410
prepared with password so now this is

645
00:41:09,980 --> 00:41:16,230
configuring itself one of the words that

646
00:41:13,410 --> 00:41:23,609
we've written in the dictionary is being

647
00:41:16,230 --> 00:41:26,040
applied to their device we when we when

648
00:41:23,610 --> 00:41:27,780
the device is coupled we're going to ask

649
00:41:26,040 --> 00:41:30,000
if it has links to a network

650
00:41:27,780 --> 00:41:32,040
if the device says that it's already

651
00:41:30,000 --> 00:41:34,190
linked to a network it means that the

652
00:41:32,040 --> 00:41:36,960
attack has been executed successfully

653
00:41:34,190 --> 00:41:39,060
here we've managed to obtain a password

654
00:41:36,960 --> 00:41:41,700
in the last line which was in the

655
00:41:39,060 --> 00:41:44,070
dictionary and these has allowed for an

656
00:41:41,700 --> 00:41:46,680
automatic coupling now we are inside the

657
00:41:44,070 --> 00:41:48,240
network again so at 1 the advantages is

658
00:41:46,680 --> 00:41:51,930
that this is not disrupted this

659
00:41:48,240 --> 00:41:54,149
algorithm is able to put in the mirror

660
00:41:51,930 --> 00:41:57,899
without interrupting the service and it

661
00:41:54,150 --> 00:42:00,690
doesn't imply attacking the network of

662
00:41:57,900 --> 00:42:05,400
the neighborhood of the neighbor it is

663
00:42:00,690 --> 00:42:07,830
us who are changing the enemy ok but it

664
00:42:05,400 --> 00:42:10,470
lasts longer

665
00:42:07,830 --> 00:42:14,160
maybe sometimes it's not possible to

666
00:42:10,470 --> 00:42:18,419
work that way and finally start

667
00:42:14,160 --> 00:42:24,810
conclusion well as we've seen the PLC

668
00:42:18,420 --> 00:42:27,600
devices very much used you know in

669
00:42:24,810 --> 00:42:28,859
houses but there is not a lot of

670
00:42:27,600 --> 00:42:33,180
information about them and they are

671
00:42:28,859 --> 00:42:35,250
vulnerable to different attacks so well

672
00:42:33,180 --> 00:42:39,660
we've realized that research in this

673
00:42:35,250 --> 00:42:44,790
field could be good we further promote

674
00:42:39,660 --> 00:42:48,379
it and the newest protocols do not even

675
00:42:44,790 --> 00:42:52,290
have implemented protection layers that

676
00:42:48,380 --> 00:42:55,650
also regarding their reversing that

677
00:42:52,290 --> 00:42:58,430
would exceed welcome we could see that

678
00:42:55,650 --> 00:43:01,230
we it was done through this manufacturer

679
00:42:58,430 --> 00:43:04,169
and which is the most well known

680
00:43:01,230 --> 00:43:06,960
manufacturer and all PLC's use this

681
00:43:04,170 --> 00:43:09,570
manufacturer and this is why they ko the

682
00:43:06,960 --> 00:43:11,730
K attack is so useful but there are more

683
00:43:09,570 --> 00:43:14,070
manufacturers and if we do more

684
00:43:11,730 --> 00:43:16,410
reversing on other manufacturers we

685
00:43:14,070 --> 00:43:19,850
wouldn't really increase the scope of

686
00:43:16,410 --> 00:43:21,960
vulnerable devices that may be found and

687
00:43:19,850 --> 00:43:25,160
regarding with irrigations we've seen

688
00:43:21,960 --> 00:43:29,580
all the attacks but how can we avoid

689
00:43:25,160 --> 00:43:31,500
someone to attack us like that well

690
00:43:29,580 --> 00:43:34,170
first of all we have to change the

691
00:43:31,500 --> 00:43:36,450
password by default because and it's the

692
00:43:34,170 --> 00:43:40,230
worst thing that you can do also we have

693
00:43:36,450 --> 00:43:42,379
to check if PLC's are vulnerable to ko

694
00:43:40,230 --> 00:43:47,310
tak how can we do that well obviously

695
00:43:42,380 --> 00:43:50,880
when luke the reverse of their PLC we

696
00:43:47,310 --> 00:43:52,890
can see the password that we have so if

697
00:43:50,880 --> 00:43:55,590
by using the algorithm we can generate

698
00:43:52,890 --> 00:43:58,710
it by just using the MACC we're going to

699
00:43:55,590 --> 00:44:00,660
be able to suffer that attack regarding

700
00:43:58,710 --> 00:44:02,780
chokes it depends on the electrical

701
00:44:00,660 --> 00:44:05,700
installation of the building we can not

702
00:44:02,780 --> 00:44:08,220
do anything about this but we can for

703
00:44:05,700 --> 00:44:12,899
example try to use their discovery

704
00:44:08,220 --> 00:44:15,868
squeak in order to see which devices can

705
00:44:12,900 --> 00:44:19,430
be found in the building for example if

706
00:44:15,869 --> 00:44:21,709
there are four or five CCO stations

707
00:44:19,430 --> 00:44:25,678
probably you're not going

708
00:44:21,709 --> 00:44:28,618
five of our four PLC's in your house

709
00:44:25,679 --> 00:44:31,949
probably there will be someone emitting

710
00:44:28,619 --> 00:44:33,569
the sign regarding is in strong

711
00:44:31,949 --> 00:44:35,640
passwords this is very important in

712
00:44:33,569 --> 00:44:38,219
order to avoid the dictionary attack

713
00:44:35,640 --> 00:44:42,319
that we've seen even though we we've

714
00:44:38,219 --> 00:44:44,640
said that it is a very long attack but

715
00:44:42,319 --> 00:44:48,329
anyway would recommend not to write

716
00:44:44,640 --> 00:44:51,679
passwords as one two three four and if

717
00:44:48,329 --> 00:44:55,799
you want to avoid la and attacks issued

718
00:44:51,679 --> 00:44:58,650
the enable their ports in the switch so

719
00:44:55,799 --> 00:45:01,109
well this it is very complex for that

720
00:44:58,650 --> 00:45:03,209
this happens it is unlikely that this

721
00:45:01,109 --> 00:45:05,669
happens but the most important thing you

722
00:45:03,209 --> 00:45:07,469
know the turbo thinks is not to let

723
00:45:05,669 --> 00:45:10,859
hackers enter into your house that will

724
00:45:07,469 --> 00:45:12,539
be the easiest solution and well

725
00:45:10,859 --> 00:45:16,709
regarding their bibliography that we've

726
00:45:12,539 --> 00:45:18,630
used we can find the works done by

727
00:45:16,709 --> 00:45:20,339
Dudek which is the most recently a

728
00:45:18,630 --> 00:45:22,759
research in the market right now

729
00:45:20,339 --> 00:45:28,288
then we've used other papers regarding

730
00:45:22,759 --> 00:45:30,269
black AV security mechanisms and also an

731
00:45:28,289 --> 00:45:32,789
essay from 2010 with a lot of

732
00:45:30,269 --> 00:45:35,368
information on that too but well they

733
00:45:32,789 --> 00:45:38,489
see if you have any question please feel

734
00:45:35,369 --> 00:45:39,140
free to ask we'll be glad to answer your

735
00:45:38,489 --> 00:45:45,169
questions

736
00:45:39,140 --> 00:45:48,749
[Applause]

737
00:45:45,169 --> 00:45:53,038
would you recommend using PLC or

738
00:45:48,749 --> 00:45:55,919
Ethernet long cables what's the best

739
00:45:53,039 --> 00:45:59,279
solution you can just have PLC if it is

740
00:45:55,919 --> 00:46:02,158
well setup and the speed is it going to

741
00:45:59,279 --> 00:46:04,109
be the same or or am I going to have

742
00:46:02,159 --> 00:46:07,229
more well you're always going to have

743
00:46:04,109 --> 00:46:08,788
more speed with cable Ethernet cable a

744
00:46:07,229 --> 00:46:12,979
straight cable is going to work better

745
00:46:08,789 --> 00:46:17,729
always but let's imagine that you have

746
00:46:12,979 --> 00:46:21,779
two floors you cannot use the cable in

747
00:46:17,729 --> 00:46:26,129
two floors but well the most recent

748
00:46:21,779 --> 00:46:28,619
devices offer quite a quite good speeds

749
00:46:26,130 --> 00:46:31,130
for streaming and everything if you have

750
00:46:28,619 --> 00:46:33,870
a laptop on

751
00:46:31,130 --> 00:46:37,110
on the other corner of your house and

752
00:46:33,870 --> 00:46:38,970
you don't want to use you cannot use a

753
00:46:37,110 --> 00:46:44,370
cable a PLC is a good solution but it

754
00:46:38,970 --> 00:46:57,000
must be properly set up are there any

755
00:46:44,370 --> 00:47:01,230
more questions my name is Manuel and a

756
00:46:57,000 --> 00:47:04,470
half a question when you do the chaotic

757
00:47:01,230 --> 00:47:09,480
attack you are exposed right you are not

758
00:47:04,470 --> 00:47:11,100
protecting yourself that's right yes the

759
00:47:09,480 --> 00:47:13,560
neighbor is going into what she same

760
00:47:11,100 --> 00:47:16,620
thing you're watching him same thing

761
00:47:13,560 --> 00:47:21,180
happens when you are hacking Wi-Fi you

762
00:47:16,620 --> 00:47:23,520
end up being exposed and could we use

763
00:47:21,180 --> 00:47:27,049
different brands of PLC's in order to do

764
00:47:23,520 --> 00:47:27,050
this attack yes it's possible

765
00:47:27,410 --> 00:47:36,779
you hum flight V to paste

766
00:47:32,790 --> 00:47:40,320
compatible with other brands so these

767
00:47:36,780 --> 00:47:43,710
are tp-link but we've done we fan test

768
00:47:40,320 --> 00:47:46,320
with other PLC's we thought from other

769
00:47:43,710 --> 00:47:48,660
brands and they couple the same way and

770
00:47:46,320 --> 00:47:50,910
what I didn't understand at the end is

771
00:47:48,660 --> 00:47:53,730
when you are when you introduce yourself

772
00:47:50,910 --> 00:47:58,529
in the network you are a master or a

773
00:47:53,730 --> 00:48:01,080
user normal user no the master is the

774
00:47:58,530 --> 00:48:03,180
same one that is the master from the

775
00:48:01,080 --> 00:48:05,450
beginning the device that is meeting us

776
00:48:03,180 --> 00:48:05,450
I know

777
00:48:11,060 --> 00:48:14,180
well good afternoon thank you so much

778
00:48:12,950 --> 00:48:16,339
for the presentation it was very

779
00:48:14,180 --> 00:48:19,129
interesting I have a question two weeks

780
00:48:16,340 --> 00:48:22,010
ago it happened to me the same thing how

781
00:48:19,130 --> 00:48:27,560
it happened to your colleague I have a

782
00:48:22,010 --> 00:48:30,230
d-link the HP and when I try to see who

783
00:48:27,560 --> 00:48:33,500
was connected I could see iPads

784
00:48:30,230 --> 00:48:40,550
well thousands of devices from other

785
00:48:33,500 --> 00:48:43,610
neighbors so I tried to close it because

786
00:48:40,550 --> 00:48:46,730
I wanted to avoid anyone to enter into

787
00:48:43,610 --> 00:48:48,650
my devices with what you regarding what

788
00:48:46,730 --> 00:48:50,840
you have said I would I be able to solve

789
00:48:48,650 --> 00:48:52,340
the problem like that you have to change

790
00:48:50,840 --> 00:48:54,640
your network name just with that you're

791
00:48:52,340 --> 00:48:57,290
going to avoid that problem because

792
00:48:54,640 --> 00:49:06,080
quite graphically what you are doing by

793
00:48:57,290 --> 00:49:09,170
that is limiting your device if you

794
00:49:06,080 --> 00:49:10,759
change the networking to both PLC's that

795
00:49:09,170 --> 00:49:14,210
would solve your problem that would

796
00:49:10,760 --> 00:49:18,190
isolate you but we cannot ensure if your

797
00:49:14,210 --> 00:49:21,170
PL state could be could be attacked with

798
00:49:18,190 --> 00:49:27,130
okay oh da car okay

799
00:49:21,170 --> 00:49:27,130
well I think that mine wouldn't be

800
00:49:27,280 --> 00:49:36,830
attacked by that if you are using that

801
00:49:30,320 --> 00:49:39,320
one yes then Cayo they dak attack it

802
00:49:36,830 --> 00:49:42,730
doesn't work okay thank you no I don't

803
00:49:39,320 --> 00:49:42,730
have to run the test myself thank you

804
00:49:42,760 --> 00:49:55,040
are there any more questions we have few

805
00:49:52,070 --> 00:50:07,940
more minutes so please feel free to ask

806
00:49:55,040 --> 00:50:09,620
any question you want to so thank you

807
00:50:07,940 --> 00:50:12,140
for your presentation I wanted to ask

808
00:50:09,620 --> 00:50:20,870
you something if you have the same

809
00:50:12,140 --> 00:50:22,420
network name part of obtaining the MSE

810
00:50:20,870 --> 00:50:25,299
from the master

811
00:50:22,420 --> 00:50:26,559
so that you can cheat it and be accepted

812
00:50:25,299 --> 00:50:30,900
in the network house if done

813
00:50:26,559 --> 00:50:32,319
automatically when this happens in for

814
00:50:30,900 --> 00:50:36,720
my chance

815
00:50:32,319 --> 00:50:39,640
I mean why if this name is by default

816
00:50:36,720 --> 00:50:40,990
can I Inc or being operated into the

817
00:50:39,640 --> 00:50:43,990
neighbor Network

818
00:50:40,990 --> 00:50:46,930
well the key that we've said that is

819
00:50:43,990 --> 00:50:49,868
generated from the network name is going

820
00:50:46,930 --> 00:50:52,240
to be compared if it comes and if it

821
00:50:49,869 --> 00:50:55,510
matches it's going to couple you with

822
00:50:52,240 --> 00:50:58,089
that neck network if you connect a PLC

823
00:50:55,510 --> 00:51:00,339
within it where it is going to take the

824
00:50:58,089 --> 00:51:04,538
beacons that it's receiving so if it

825
00:51:00,339 --> 00:51:08,680
sees okay there is an VLAN it's going to

826
00:51:04,539 --> 00:51:10,839
try to interrogate with the VLA and with

827
00:51:08,680 --> 00:51:13,058
a network name that has a configuration

828
00:51:10,839 --> 00:51:17,200
so you always have to change passwords

829
00:51:13,059 --> 00:51:20,710
by default just because sometimes you're

830
00:51:17,200 --> 00:51:22,930
changing your key all the time until you

831
00:51:20,710 --> 00:51:25,349
are a couple this is one of the attacks

832
00:51:22,930 --> 00:51:28,180
that we've seen before

833
00:51:25,349 --> 00:51:31,900
yes in the end you just have to to test

834
00:51:28,180 --> 00:51:36,848
the different possibilities that you

835
00:51:31,900 --> 00:51:39,430
have until one matches hello good

836
00:51:36,849 --> 00:51:42,789
afternoon so well I'm kind of ashamed to

837
00:51:39,430 --> 00:51:44,859
ask that question because I missed the

838
00:51:42,789 --> 00:51:47,049
first minutes of the presentation I'm

839
00:51:44,859 --> 00:51:50,710
sure that you mentioned this I've been

840
00:51:47,049 --> 00:51:52,420
using PLC's for many years and I thought

841
00:51:50,710 --> 00:51:55,000
that they should work within the same

842
00:51:52,420 --> 00:51:57,279
electrical circuits right yes so the

843
00:51:55,000 --> 00:52:01,109
electrical sir

844
00:51:57,279 --> 00:52:06,099
installation has more secrets is it more

845
00:52:01,109 --> 00:52:07,779
safe I mean as far as I understand I'm

846
00:52:06,099 --> 00:52:10,150
isolated from the rest of the neighbors

847
00:52:07,779 --> 00:52:12,519
right well the electrical in electrical

848
00:52:10,150 --> 00:52:14,559
installations of a building there are

849
00:52:12,519 --> 00:52:17,769
circuits for different types of

850
00:52:14,559 --> 00:52:25,000
appliances Varia in the end they are all

851
00:52:17,769 --> 00:52:27,250
linked to the main PLC so as you can

852
00:52:25,000 --> 00:52:29,460
move forward from one floor to another

853
00:52:27,250 --> 00:52:33,299
you need to take into account that

854
00:52:29,460 --> 00:52:33,299
counters can be hard

855
00:52:37,790 --> 00:52:41,480
are there any more questions

856
00:52:42,080 --> 00:52:51,299
we have little we have more time for

857
00:52:45,950 --> 00:52:54,169
some more questions two or three well

858
00:52:51,300 --> 00:52:54,170
thank you very much

859
00:52:58,030 --> 00:53:02,880
[Applause]

860
00:53:00,820 --> 00:53:02,880
you

