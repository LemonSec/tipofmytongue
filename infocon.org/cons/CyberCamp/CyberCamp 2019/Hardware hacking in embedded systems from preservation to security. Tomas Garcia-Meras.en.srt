1
00:00:01,910 --> 00:00:04,979
[Music]

2
00:00:09,139 --> 00:00:18,660
good today we're going to see the way of

3
00:00:15,179 --> 00:00:22,800
hacking harward in embedded systems

4
00:00:18,660 --> 00:00:27,170
mainly based on hi world in order to

5
00:00:22,800 --> 00:00:31,380
place us into context we use helical

6
00:00:27,170 --> 00:00:34,500
embedded system to any device with a

7
00:00:31,380 --> 00:00:36,839
specific usage that has a hardware

8
00:00:34,500 --> 00:00:40,680
software integration which is not

9
00:00:36,840 --> 00:00:45,239
similar which is not normal for example

10
00:00:40,680 --> 00:00:48,300
a fridge is an embedded system 20 years

11
00:00:45,239 --> 00:00:53,099
ago they didn't have any microprocessor

12
00:00:48,300 --> 00:00:57,089
but nowadays fridges do have processors

13
00:00:53,100 --> 00:00:59,940
a TV can also be considered an embedded

14
00:00:57,090 --> 00:01:04,129
system with several microprocessors and

15
00:00:59,940 --> 00:01:07,679
so on currently every electronic device

16
00:01:04,129 --> 00:01:11,070
could be considered an embedded system

17
00:01:07,680 --> 00:01:15,530
because any embedded system has micro

18
00:01:11,070 --> 00:01:19,139
processors 20 years ago it was crazy to

19
00:01:15,530 --> 00:01:21,990
integrate micro processors for bridges

20
00:01:19,140 --> 00:01:25,920
because the price would have been much

21
00:01:21,990 --> 00:01:30,259
higher however nowadays the difference

22
00:01:25,920 --> 00:01:34,049
in price is not very significant

23
00:01:30,259 --> 00:01:36,479
probably these loudspeakers are also

24
00:01:34,049 --> 00:01:39,570
embedded systems because they have their

25
00:01:36,479 --> 00:01:44,369
own operating system Ram ROM and so on

26
00:01:39,570 --> 00:01:48,229
so most of the systems security is based

27
00:01:44,369 --> 00:01:50,759
on the concept of security by obscurity

28
00:01:48,229 --> 00:01:53,670
since you don't know what there is

29
00:01:50,759 --> 00:01:56,070
inside they are very difficult to attack

30
00:01:53,670 --> 00:01:59,729
this is a principle that has been

31
00:01:56,070 --> 00:02:02,398
applied for forever but regarding

32
00:01:59,729 --> 00:02:07,829
embedded system this is quite relevant

33
00:02:02,399 --> 00:02:11,310
because a closed open-source code is

34
00:02:07,829 --> 00:02:14,190
used in security by security in this

35
00:02:11,310 --> 00:02:17,130
let's think about our breach who is

36
00:02:14,190 --> 00:02:21,569
going to attack I will our fridge well

37
00:02:17,130 --> 00:02:25,920
maybe they want to attack an industrial

38
00:02:21,569 --> 00:02:32,130
freight with over 300 kilos of meat

39
00:02:25,920 --> 00:02:35,099
inside if I want the company to to go

40
00:02:32,130 --> 00:02:38,370
into bankruptcy to attract the clients

41
00:02:35,099 --> 00:02:40,649
to my company then I could attacked that

42
00:02:38,370 --> 00:02:44,069
embedded system but I do not have any

43
00:02:40,650 --> 00:02:47,670
kind of code any binary code I only have

44
00:02:44,069 --> 00:02:51,540
some chips that I can see there is some

45
00:02:47,670 --> 00:02:53,429
by Leonard Cohen that I like which says

46
00:02:51,540 --> 00:02:57,329
there is a crack a crack in everything

47
00:02:53,430 --> 00:02:58,769
that's how the light gets in so today

48
00:02:57,330 --> 00:03:01,580
we're going to see how to extract

49
00:02:58,769 --> 00:03:06,810
information from embedded systems

50
00:03:01,580 --> 00:03:11,370
embedded systems are not obscure by

51
00:03:06,810 --> 00:03:16,850
chance but by necessity the first need

52
00:03:11,370 --> 00:03:20,340
is plagiarism if Samsung for example has

53
00:03:16,850 --> 00:03:25,739
different functions with a display in

54
00:03:20,340 --> 00:03:31,620
their in their fridge probably they

55
00:03:25,739 --> 00:03:36,239
won't want LG or other companies to copy

56
00:03:31,620 --> 00:03:40,500
their functionality moreover most

57
00:03:36,239 --> 00:03:43,889
embedded systems had hadn't had any

58
00:03:40,500 --> 00:03:50,940
connection because they were not

59
00:03:43,889 --> 00:03:55,350
connected to any Wi-Fi before when when

60
00:03:50,940 --> 00:03:58,500
it rains a lot and the dam reaches a

61
00:03:55,350 --> 00:04:01,590
certain level the doors the gates are

62
00:03:58,500 --> 00:04:08,819
open without any human intervention if I

63
00:04:01,590 --> 00:04:14,989
open the gate without any advice without

64
00:04:08,819 --> 00:04:14,988
any warning I can flood a whole village

65
00:04:17,329 --> 00:04:24,580
when these can and and these could cut

66
00:04:22,140 --> 00:04:30,580
the electricity grid for

67
00:04:24,580 --> 00:04:33,849
region the same happens with the fire

68
00:04:30,580 --> 00:04:37,810
extinction devices if they do not work

69
00:04:33,849 --> 00:04:44,800
to be some buildings who can be burned

70
00:04:37,810 --> 00:04:47,080
and some human lives could be lost so we

71
00:04:44,800 --> 00:04:49,690
need to think about critical structures

72
00:04:47,080 --> 00:04:53,109
I like to talk about the electricity

73
00:04:49,690 --> 00:04:55,960
grid but also about the network of dams

74
00:04:53,110 --> 00:04:58,659
which are based on embedded systems

75
00:04:55,960 --> 00:05:00,780
which are not a very modern if you go to

76
00:04:58,659 --> 00:05:05,560
any company in Spain the automated

77
00:05:00,780 --> 00:05:09,698
systems to open the gate are 15 or 20

78
00:05:05,560 --> 00:05:15,490
years old because it is not a component

79
00:05:09,699 --> 00:05:17,770
which is replaced very frequently those

80
00:05:15,490 --> 00:05:20,340
devices are not connected and they do

81
00:05:17,770 --> 00:05:22,990
not require a complete modernization

82
00:05:20,340 --> 00:05:27,729
however it is difficult to think about a

83
00:05:22,990 --> 00:05:29,199
company which has Windows XP because it

84
00:05:27,729 --> 00:05:33,310
is 20 years old

85
00:05:29,199 --> 00:05:38,440
it is very insecure there are warnings

86
00:05:33,310 --> 00:05:43,719
from in TV that say with delete Windows

87
00:05:38,440 --> 00:05:46,840
XP but no one is telling the dam

88
00:05:43,719 --> 00:05:51,639
operator to change the system that

89
00:05:46,840 --> 00:05:53,979
controls the gates so let's try first to

90
00:05:51,639 --> 00:05:58,629
see how can how we can extract

91
00:05:53,979 --> 00:06:02,080
information from these embedded devices

92
00:05:58,629 --> 00:06:05,740
when we open it we find this secret

93
00:06:02,080 --> 00:06:09,219
board if I open the TV I will find a

94
00:06:05,740 --> 00:06:12,099
secret board with several chips which

95
00:06:09,219 --> 00:06:14,590
contain the programs of word operating

96
00:06:12,099 --> 00:06:18,449
system and so on but it is not easy to

97
00:06:14,590 --> 00:06:22,810
extract that information manufacturers

98
00:06:18,449 --> 00:06:24,380
use these in order to hide the

99
00:06:22,810 --> 00:06:26,240
information

100
00:06:24,380 --> 00:06:30,020
these techniques that I'm going to

101
00:06:26,240 --> 00:06:33,050
explain to you are usually used in the

102
00:06:30,020 --> 00:06:37,250
gaming company I do not know if you are

103
00:06:33,050 --> 00:06:43,240
familiar with the ma ma emulator when we

104
00:06:37,250 --> 00:06:46,880
extract the information from game the

105
00:06:43,240 --> 00:06:50,810
game is going to have a high protection

106
00:06:46,880 --> 00:06:54,350
against plagiarism all these techniques

107
00:06:50,810 --> 00:06:56,750
were developed to protect the

108
00:06:54,350 --> 00:07:01,220
information from games but can be

109
00:06:56,750 --> 00:07:04,270
applied to these cases the first thing

110
00:07:01,220 --> 00:07:06,830
which is difficult is to identify the

111
00:07:04,270 --> 00:07:13,070
security elements and to access them

112
00:07:06,830 --> 00:07:16,250
this is board from an arcade game but it

113
00:07:13,070 --> 00:07:20,719
is very common to open it and to see

114
00:07:16,250 --> 00:07:23,990
that it has epoxy resin on it once it is

115
00:07:20,720 --> 00:07:30,710
solidified these racine it is extremely

116
00:07:23,990 --> 00:07:33,800
solid so if I have this this racine I

117
00:07:30,710 --> 00:07:36,440
cannot access the chips so I cannot

118
00:07:33,800 --> 00:07:45,080
access the information there are several

119
00:07:36,440 --> 00:07:50,510
ways to delete these racine so what can

120
00:07:45,080 --> 00:07:52,300
we do usually I like to do it with hot

121
00:07:50,510 --> 00:08:00,789
air

122
00:07:52,300 --> 00:08:03,440
this kind of epoxy regime can be broken

123
00:08:00,790 --> 00:08:09,680
over 400 degrees

124
00:08:03,440 --> 00:08:14,360
so being patiently with hot air gun not

125
00:08:09,680 --> 00:08:18,640
one to strip paint with temperature

126
00:08:14,360 --> 00:08:22,040
regulator it can be broken and

127
00:08:18,640 --> 00:08:26,419
scratching it carefully you can release

128
00:08:22,040 --> 00:08:29,540
the surface of the chips obviously 400

129
00:08:26,420 --> 00:08:32,300
degrees is a very hot so you need to be

130
00:08:29,540 --> 00:08:37,400
careful but when you're working with

131
00:08:32,299 --> 00:08:44,098
systems that are covered with racine

132
00:08:37,400 --> 00:08:45,720
and you only have one extremely careful

133
00:08:44,099 --> 00:08:48,750
because sometimes when you have several

134
00:08:45,720 --> 00:08:51,210
devices one of them can be used as it

135
00:08:48,750 --> 00:08:54,360
just to test but if you just have only

136
00:08:51,210 --> 00:08:59,900
one be careful there are people who are

137
00:08:54,360 --> 00:09:05,850
more patient than I if you submerge the

138
00:08:59,900 --> 00:09:09,870
epoxy we seen in paint is stripper for a

139
00:09:05,850 --> 00:09:13,380
couple of days then the Racine can be

140
00:09:09,870 --> 00:09:17,160
extracted quite easily the same happens

141
00:09:13,380 --> 00:09:20,939
with butell glycol where you have to

142
00:09:17,160 --> 00:09:23,430
submerge the chip for only a day but I'm

143
00:09:20,940 --> 00:09:27,090
not that patient I do not have a whole

144
00:09:23,430 --> 00:09:31,040
day to wait another friend told me that

145
00:09:27,090 --> 00:09:35,220
he usually uses an ultrasound machine

146
00:09:31,040 --> 00:09:39,390
but it is not very i wouldn't recommend

147
00:09:35,220 --> 00:09:44,090
you to use this because the ultrasounds

148
00:09:39,390 --> 00:09:47,699
can harm the internal connections

149
00:09:44,090 --> 00:09:49,740
ultrasounds and it's vibration can break

150
00:09:47,700 --> 00:09:53,700
those connections and the chip will be

151
00:09:49,740 --> 00:09:58,230
useless another common practice is that

152
00:09:53,700 --> 00:10:02,970
once we have with Joan the epoxy resin

153
00:09:58,230 --> 00:10:07,310
we don't know what there is below

154
00:10:02,970 --> 00:10:13,350
because they usually scratch the surface

155
00:10:07,310 --> 00:10:17,790
we have seen these in devices with over

156
00:10:13,350 --> 00:10:23,330
1,000 or even 200 mm chips so there was

157
00:10:17,790 --> 00:10:23,329
a person scratching chips for many hours

158
00:10:26,360 --> 00:10:34,230
you can see where the chip is connected

159
00:10:31,080 --> 00:10:36,510
where is the data boo-boos where is the

160
00:10:34,230 --> 00:10:40,950
bills of addresses and so on most of

161
00:10:36,510 --> 00:10:43,680
chips have an electric identifier if you

162
00:10:40,950 --> 00:10:47,310
put it into a programmer it sends

163
00:10:43,680 --> 00:10:49,979
electrical signals to a high voltage and

164
00:10:47,310 --> 00:10:53,219
the chip responds with

165
00:10:49,980 --> 00:10:57,060
Electric identifier not every chip does

166
00:10:53,220 --> 00:11:00,330
this not every chip has unique

167
00:10:57,060 --> 00:11:04,160
identifiers some of them share family

168
00:11:00,330 --> 00:11:08,880
identifiers I mean some other cases

169
00:11:04,160 --> 00:11:10,920
there are some markings on the reverse

170
00:11:08,880 --> 00:11:15,530
of the chip or the scratching was

171
00:11:10,920 --> 00:11:15,530
wrongly made this is an example of

172
00:11:15,920 --> 00:11:26,969
jungle key those who view who were who

173
00:11:21,480 --> 00:11:29,790
are young my not know this but twenty

174
00:11:26,970 --> 00:11:33,930
years ago this was quite frequent in

175
00:11:29,790 --> 00:11:38,670
this case this is to protect against

176
00:11:33,930 --> 00:11:43,170
copies there was a layer of Racine once

177
00:11:38,670 --> 00:11:47,699
the Racine was with John we saw a clock

178
00:11:43,170 --> 00:11:49,709
and a chip with the surface full of

179
00:11:47,700 --> 00:11:53,670
scratches I don't know if you can see it

180
00:11:49,710 --> 00:11:59,750
here can you see there is a small symbol

181
00:11:53,670 --> 00:12:03,959
here a small triangle this symbol means

182
00:11:59,750 --> 00:12:05,990
manufacturer which is an amble chip so

183
00:12:03,960 --> 00:12:10,530
this was a mistake

184
00:12:05,990 --> 00:12:13,520
he had scratched the chip surface and he

185
00:12:10,530 --> 00:12:17,550
had added Racine but he had forgotten to

186
00:12:13,520 --> 00:12:20,400
scratch this symbol and here we have

187
00:12:17,550 --> 00:12:27,920
some markings that can be used to

188
00:12:20,400 --> 00:12:30,900
identify to have the identifier so we

189
00:12:27,920 --> 00:12:33,689
overcame the two protections by the

190
00:12:30,900 --> 00:12:37,220
manufacturer Racine and surface

191
00:12:33,690 --> 00:12:41,250
scratching as you can see these

192
00:12:37,220 --> 00:12:43,710
protection are very simple they are not

193
00:12:41,250 --> 00:12:48,660
very sophisticated but it really hinders

194
00:12:43,710 --> 00:12:51,870
the the fact of identifying a device

195
00:12:48,660 --> 00:12:58,469
some people ask why don't you use x-rays

196
00:12:51,870 --> 00:13:00,940
well x-rays are not very useful this is

197
00:12:58,470 --> 00:13:06,430
a device that is usually connected to

198
00:13:00,940 --> 00:13:07,030
TV this this is called glass in Spanish

199
00:13:06,430 --> 00:13:13,739
called

200
00:13:07,030 --> 00:13:22,449
patrol and you use it instead of Racine

201
00:13:13,740 --> 00:13:27,580
all over the chip here we knew here the

202
00:13:22,450 --> 00:13:29,710
the ROM was here because we were sure

203
00:13:27,580 --> 00:13:34,090
that it was a flash memory

204
00:13:29,710 --> 00:13:39,030
however we scanned it through x-ray if

205
00:13:34,090 --> 00:13:42,430
you see resistors here are these Andy's

206
00:13:39,030 --> 00:13:46,150
so it doesn't give us any information

207
00:13:42,430 --> 00:13:49,329
so x-rays are not very useful they are

208
00:13:46,150 --> 00:13:52,360
only useful when we have a trap device

209
00:13:49,330 --> 00:13:55,990
sometimes below every scene we have a

210
00:13:52,360 --> 00:13:58,780
suicidal device which deletes all the

211
00:13:55,990 --> 00:14:01,090
information when feels that is going to

212
00:13:58,780 --> 00:14:06,550
be attacked this is quite common

213
00:14:01,090 --> 00:14:10,180
actually in vram it is a is a volatile

214
00:14:06,550 --> 00:14:14,199
ram which is connected to a battery so

215
00:14:10,180 --> 00:14:18,130
the content of the RAM is gonna be there

216
00:14:14,200 --> 00:14:23,740
and while it is connected to the battery

217
00:14:18,130 --> 00:14:28,530
if the battery current is cut the memory

218
00:14:23,740 --> 00:14:32,290
content is going to be broken if you use

219
00:14:28,530 --> 00:14:35,709
400 degrees of hot air you're going to

220
00:14:32,290 --> 00:14:39,610
delete the content of the RAM so in this

221
00:14:35,710 --> 00:14:40,920
case it would it could be helpful to use

222
00:14:39,610 --> 00:14:46,089
x-rays

223
00:14:40,920 --> 00:14:50,459
besides in Spain the regulation on using

224
00:14:46,089 --> 00:14:56,760
x-rays is quite strict which is good

225
00:14:50,460 --> 00:15:00,670
another way of hiding what is going on

226
00:14:56,760 --> 00:15:05,819
in an embedded system is that chips do

227
00:15:00,670 --> 00:15:10,479
not respond to any standard in this case

228
00:15:05,820 --> 00:15:13,170
here we have read zero zero three four

229
00:15:10,480 --> 00:15:18,000
these triangle says it

230
00:15:13,170 --> 00:15:25,160
is optional a brand of brand and we have

231
00:15:18,000 --> 00:15:25,160
the same in Philips this cheap came from

232
00:15:26,600 --> 00:15:35,670
you know this dart machine at virus and

233
00:15:31,740 --> 00:15:36,990
pups we do not know its processors we do

234
00:15:35,670 --> 00:15:39,089
not know anything

235
00:15:36,990 --> 00:15:42,959
so how can we extract information from a

236
00:15:39,089 --> 00:15:48,529
chip with an L another case which is

237
00:15:42,959 --> 00:15:55,469
quite frequent is when a manufacturer

238
00:15:48,529 --> 00:16:00,930
produces a huge amount of chips for

239
00:15:55,470 --> 00:16:05,600
example Hasbro you know the owner of

240
00:16:00,930 --> 00:16:11,430
play school and the owner of toy stores

241
00:16:05,600 --> 00:16:13,410
produced video video players that you

242
00:16:11,430 --> 00:16:18,079
probably don't remember because you are

243
00:16:13,410 --> 00:16:23,189
too young in Spain it was lunched with

244
00:16:18,079 --> 00:16:27,180
wonderful advertisement and the

245
00:16:23,190 --> 00:16:31,110
advertising said let's spend a day with

246
00:16:27,180 --> 00:16:35,670
a famous singer in this case this was

247
00:16:31,110 --> 00:16:38,760
specially produced for husband so there

248
00:16:35,670 --> 00:16:44,219
is no documentation or information on it

249
00:16:38,760 --> 00:16:46,769
you may call the manufacturer saying you

250
00:16:44,220 --> 00:16:48,870
are hospital but probably you won't

251
00:16:46,769 --> 00:16:52,040
speak the language and you won't be able

252
00:16:48,870 --> 00:16:57,320
to have the same device because it is

253
00:16:52,040 --> 00:16:57,319
specifically produced only for husband

254
00:16:57,410 --> 00:17:04,409
we have no idea what disease but let's

255
00:17:01,560 --> 00:17:09,990
see later how to attack these difficult

256
00:17:04,410 --> 00:17:12,600
cases obviously the thing about using a

257
00:17:09,990 --> 00:17:15,390
programmer to receive electric

258
00:17:12,599 --> 00:17:18,359
identifiers is not going to work on this

259
00:17:15,390 --> 00:17:22,919
device because the manufacturer produced

260
00:17:18,359 --> 00:17:24,688
this product specifically for the for

261
00:17:22,919 --> 00:17:27,750
hasbro so

262
00:17:24,689 --> 00:17:32,510
they would have included any identifier

263
00:17:27,750 --> 00:17:36,570
so this makes it difficult for us to

264
00:17:32,510 --> 00:17:39,320
extract information I have a hour I want

265
00:17:36,570 --> 00:17:42,600
to struct information what can I do

266
00:17:39,320 --> 00:17:47,129
obviously there is a kind of realm of

267
00:17:42,600 --> 00:17:52,760
cheap that if I pass it through a ROM

268
00:17:47,130 --> 00:17:52,760
reader I can extract all the information

269
00:17:53,270 --> 00:18:02,460
the programmer rated it R is it but most

270
00:17:58,590 --> 00:18:07,408
of case most of chips do you have high

271
00:18:02,460 --> 00:18:11,870
protection systems and strategies depend

272
00:18:07,409 --> 00:18:18,659
on the kind of Howard I usually tend to

273
00:18:11,870 --> 00:18:22,020
speak about dumping data from a cheap

274
00:18:18,659 --> 00:18:28,440
with non intrusive techniques and the

275
00:18:22,020 --> 00:18:31,200
best way to extract the to extra

276
00:18:28,440 --> 00:18:34,470
information could be through trillions

277
00:18:31,200 --> 00:18:36,899
all the trillions are better used to

278
00:18:34,470 --> 00:18:39,419
extract information from appeasing

279
00:18:36,899 --> 00:18:42,090
glitching is another technique it is

280
00:18:39,419 --> 00:18:48,870
when there is a bad designed on her word

281
00:18:42,090 --> 00:18:51,860
and we can exploit this hardware in

282
00:18:48,870 --> 00:18:57,059
order to access information we can also

283
00:18:51,860 --> 00:19:00,799
use brute force but I think that only

284
00:18:57,059 --> 00:19:07,889
four five components are subject to

285
00:19:00,799 --> 00:19:12,620
brute force and Pro and also D cap the D

286
00:19:07,890 --> 00:19:18,049
cap of modern components is only made by

287
00:19:12,620 --> 00:19:22,529
governments but old components can be

288
00:19:18,049 --> 00:19:28,649
accessed through D cap techniques as for

289
00:19:22,529 --> 00:19:33,179
trillions it is not just about right

290
00:19:28,649 --> 00:19:35,120
through you it is about injecting it so

291
00:19:33,179 --> 00:19:40,130
germs are

292
00:19:35,120 --> 00:19:42,469
sorry in systems that are 100% embedded

293
00:19:40,130 --> 00:19:45,590
it doesn't mean that the whole system is

294
00:19:42,470 --> 00:19:48,410
in the same board the system is in a

295
00:19:45,590 --> 00:19:51,409
chip that has no external interaction

296
00:19:48,410 --> 00:19:52,370
ROM is internal Ram is internal

297
00:19:51,410 --> 00:19:54,440
peripherals

298
00:19:52,370 --> 00:19:56,989
are internal since it doesn't have any

299
00:19:54,440 --> 00:19:57,500
external interaction how can I mean

300
00:19:56,990 --> 00:20:01,850
jecht

301
00:19:57,500 --> 00:20:04,670
the trillion obviously it is protected

302
00:20:01,850 --> 00:20:08,959
against read and against writing and

303
00:20:04,670 --> 00:20:12,500
there is no external interaction so the

304
00:20:08,960 --> 00:20:15,590
way of injecting this trojan is to

305
00:20:12,500 --> 00:20:19,420
analyze it because it might have one

306
00:20:15,590 --> 00:20:28,189
interaction with the external reality

307
00:20:19,420 --> 00:20:33,080
here we have Itachi used in a game

308
00:20:28,190 --> 00:20:47,960
called master ball the cooler program I

309
00:20:33,080 --> 00:20:52,629
wanna stay was here MacDonald sorry the

310
00:20:47,960 --> 00:20:52,630
realm in this gate internal rom has

311
00:20:53,440 --> 00:21:01,880
printing routine and so if I change the

312
00:20:59,059 --> 00:21:04,879
external room which I can modify because

313
00:21:01,880 --> 00:21:06,440
it is external if I change the text the

314
00:21:04,880 --> 00:21:11,030
text on the screen is going to change

315
00:21:06,440 --> 00:21:15,260
the best thing is that the definition of

316
00:21:11,030 --> 00:21:20,080
characters is internal and outside there

317
00:21:15,260 --> 00:21:20,080
are some pointers some external pointers

318
00:21:25,240 --> 00:21:31,910
and these happens when printing some

319
00:21:28,760 --> 00:21:35,960
characters each character has map

320
00:21:31,910 --> 00:21:43,000
address and that address is going to be

321
00:21:35,960 --> 00:21:44,610
outside when you start there is small

322
00:21:43,000 --> 00:21:50,040
diagnosis we

323
00:21:44,610 --> 00:21:54,030
do that that self-diagnosis and it

324
00:21:50,040 --> 00:21:57,240
printed on the screen the whole set of

325
00:21:54,030 --> 00:22:00,600
characters what did we do we discovered

326
00:21:57,240 --> 00:22:04,470
that this small character printing

327
00:22:00,600 --> 00:22:09,540
routine didn't take any security

328
00:22:04,470 --> 00:22:13,830
analysis so instead of sending memory

329
00:22:09,540 --> 00:22:16,440
character I send memory address that

330
00:22:13,830 --> 00:22:20,280
corresponds to another area of the

331
00:22:16,440 --> 00:22:23,549
internal room it is going to copy that

332
00:22:20,280 --> 00:22:26,450
part of the room in the memory of the

333
00:22:23,549 --> 00:22:29,309
video in order to print it on the screen

334
00:22:26,450 --> 00:22:32,100
obviously on the screen you cannot find

335
00:22:29,309 --> 00:22:35,879
anything because it knows a map of bytes

336
00:22:32,100 --> 00:22:39,570
that corresponds to a character so what

337
00:22:35,880 --> 00:22:44,820
we did was to modify the external

338
00:22:39,570 --> 00:22:47,939
pointers we took the view RAM in order

339
00:22:44,820 --> 00:22:53,418
to make to transform it into an envy Ram

340
00:22:47,940 --> 00:22:58,679
I think the volatile Ram was for Cabot's

341
00:22:53,419 --> 00:23:03,120
cable from the internal room to the

342
00:22:58,679 --> 00:23:09,419
video today volatile video RAM and then

343
00:23:03,120 --> 00:23:12,629
we copied those bits every four bits we

344
00:23:09,419 --> 00:23:16,740
try to copy it and in the end we managed

345
00:23:12,630 --> 00:23:20,790
to extract all the internal room because

346
00:23:16,740 --> 00:23:25,610
the manufacturer forgot to check if the

347
00:23:20,790 --> 00:23:29,159
address in corresponding to a character

348
00:23:25,610 --> 00:23:34,409
and not to something that was outside

349
00:23:29,160 --> 00:23:35,850
the area of the memory we had some

350
00:23:34,410 --> 00:23:37,530
complications because some of the

351
00:23:35,850 --> 00:23:38,909
characters were control characters but

352
00:23:37,530 --> 00:23:45,059
in the end we could extract all the

353
00:23:38,910 --> 00:23:48,570
information and it was code so we have

354
00:23:45,059 --> 00:23:51,090
the game completely extracted from the

355
00:23:48,570 --> 00:23:53,850
device there is always a mistake by the

356
00:23:51,090 --> 00:23:55,070
manufacturer that can be exploited I am

357
00:23:53,850 --> 00:23:59,959
going to set another

358
00:23:55,070 --> 00:24:05,809
example this is one of the most secured

359
00:23:59,960 --> 00:24:18,769
chips I had the chance to collaborate

360
00:24:05,809 --> 00:24:22,809
with the Cree the manufacturers in this

361
00:24:18,769 --> 00:24:26,269
project I collaborated with mr. Kelkar

362
00:24:22,809 --> 00:24:28,340
who unfortunately passed away last week

363
00:24:26,269 --> 00:24:34,190
and he was very young

364
00:24:28,340 --> 00:24:37,850
okay so we have here this chip the whole

365
00:24:34,190 --> 00:24:40,129
content of Dallas is encrypted it only

366
00:24:37,850 --> 00:24:43,039
admits encrypted information and

367
00:24:40,129 --> 00:24:46,399
incredible encryption key is in a

368
00:24:43,039 --> 00:24:48,889
volatile memory connected to a battery

369
00:24:46,399 --> 00:24:51,949
so any interaction will delete that

370
00:24:48,889 --> 00:24:57,439
memory and in this case it doesn't have

371
00:24:51,950 --> 00:25:00,320
any interaction with the with the

372
00:24:57,440 --> 00:25:03,789
outside so two problems how can I inject

373
00:25:00,320 --> 00:25:06,439
a Trojan and how can I execute the

374
00:25:03,789 --> 00:25:09,350
encryption key I need the encryption key

375
00:25:06,440 --> 00:25:13,279
because my trojan needs to have the same

376
00:25:09,350 --> 00:25:15,678
encryption key the manufacturer was

377
00:25:13,279 --> 00:25:18,679
given a different encryption key to

378
00:25:15,679 --> 00:25:21,559
every device so that no one could know

379
00:25:18,679 --> 00:25:26,059
the encryption key here we have an

380
00:25:21,559 --> 00:25:30,649
adapter which is connected on the Dallas

381
00:25:26,059 --> 00:25:32,928
chip so that each of the wires are

382
00:25:30,649 --> 00:25:37,879
connected but be careful because you

383
00:25:32,929 --> 00:25:41,450
cannot exert pressure we also needed to

384
00:25:37,879 --> 00:25:48,259
modify for example to cut the reset line

385
00:25:41,450 --> 00:25:50,419
so that the main program controlled by

386
00:25:48,259 --> 00:25:54,559
Dallas so we didn't want the reset line

387
00:25:50,419 --> 00:25:59,149
to reset at the chip once we had these

388
00:25:54,559 --> 00:26:03,740
would read through brute force we could

389
00:25:59,149 --> 00:26:05,840
find enough number of value pairs with

390
00:26:03,740 --> 00:26:06,860
encryption and non-crystalline in order

391
00:26:05,840 --> 00:26:11,260
to know the encryption

392
00:26:06,860 --> 00:26:14,510
okay it is a bit difficult to explain

393
00:26:11,260 --> 00:26:19,510
because this is a very complex hug once

394
00:26:14,510 --> 00:26:21,679
we had extracted enough pairs of

395
00:26:19,510 --> 00:26:25,129
encrypted values and non-encrypted

396
00:26:21,679 --> 00:26:27,169
values we can figure out the encryption

397
00:26:25,130 --> 00:26:30,470
key and once we have the encryption key

398
00:26:27,169 --> 00:26:32,870
we can take our Trojan encrypted with

399
00:26:30,470 --> 00:26:35,840
the same encryption key and injected in

400
00:26:32,870 --> 00:26:39,070
the modified Harward in this case we

401
00:26:35,840 --> 00:26:43,039
also connected it to an interface USB a

402
00:26:39,070 --> 00:26:46,700
USB interface I can see right now and we

403
00:26:43,039 --> 00:26:49,580
managed to extract the program of

404
00:26:46,700 --> 00:26:54,039
dollars is five thousand and two this is

405
00:26:49,580 --> 00:26:58,460
a very sophisticated Trojan to write

406
00:26:54,039 --> 00:27:01,389
Trojans or embedded system is not an

407
00:26:58,460 --> 00:27:04,190
easy tag because it requires a lot of

408
00:27:01,389 --> 00:27:06,799
creativity imagination a lot of

409
00:27:04,190 --> 00:27:11,720
knowledge and it is always but however

410
00:27:06,799 --> 00:27:20,620
it is always better than intrusive or in

411
00:27:11,720 --> 00:27:25,460
more intrusive the next protection step

412
00:27:20,620 --> 00:27:28,580
is suicidal device this one is the same

413
00:27:25,460 --> 00:27:31,220
one as the one before the dollars five

414
00:27:28,580 --> 00:27:36,710
thousand and two which is connected to

415
00:27:31,220 --> 00:27:41,510
battery once the battery is lost the

416
00:27:36,710 --> 00:27:44,000
encryption keys are lost the idea is

417
00:27:41,510 --> 00:27:47,899
that chips control any physical

418
00:27:44,000 --> 00:27:52,669
intrusion and delete the whole content

419
00:27:47,899 --> 00:27:56,840
on many occasion chips are prepared not

420
00:27:52,669 --> 00:28:03,440
with a battery but with something more

421
00:27:56,840 --> 00:28:07,850
complex the electronic ID if you apply a

422
00:28:03,440 --> 00:28:12,649
high voltage over its threshold deletes

423
00:28:07,850 --> 00:28:17,059
all the keys you're going to use it

424
00:28:12,649 --> 00:28:19,678
it will say volatile memory deleted

425
00:28:17,059 --> 00:28:22,780
because it thing

426
00:28:19,679 --> 00:28:25,120
the attacker is carrying out a glitching

427
00:28:22,780 --> 00:28:26,170
which is one of the more frequent

428
00:28:25,120 --> 00:28:30,489
attacks

429
00:28:26,170 --> 00:28:34,360
okay let's talk them about glitching how

430
00:28:30,490 --> 00:28:38,140
can we use a malfunctioning of the

431
00:28:34,360 --> 00:28:45,969
hardware in order to invalidate anti

432
00:28:38,140 --> 00:28:51,280
copy systems these is a board by Super

433
00:28:45,970 --> 00:28:52,020
Nintendo whose information we could

434
00:28:51,280 --> 00:28:56,500
destruct

435
00:28:52,020 --> 00:29:06,668
thanks to these glitching technique many

436
00:28:56,500 --> 00:29:11,429
occasions a testing device you can play

437
00:29:06,669 --> 00:29:11,429
with voltages there are some people who

438
00:29:11,549 --> 00:29:22,110
the glitching technique it's not

439
00:29:16,260 --> 00:29:25,660
successful by chance you cannot try to

440
00:29:22,110 --> 00:29:27,490
apply higher or lower voltage you really

441
00:29:25,660 --> 00:29:31,150
need to understand the hardware in order

442
00:29:27,490 --> 00:29:34,540
to know how much voltage to use I really

443
00:29:31,150 --> 00:29:39,280
like talking about glitches a friend of

444
00:29:34,540 --> 00:29:44,860
mine recently broke the micro control in

445
00:29:39,280 --> 00:29:49,030
SM 590 by Nintendo which is used in some

446
00:29:44,860 --> 00:29:53,649
robots some absurd robots that were

447
00:29:49,030 --> 00:29:58,070
connected to NASA those robots had

448
00:29:53,650 --> 00:30:04,100
microprocessors how could we struck its

449
00:29:58,070 --> 00:30:08,210
information this is the sequence that my

450
00:30:04,100 --> 00:30:15,709
friend followed if we feed electrically

451
00:30:08,210 --> 00:30:19,130
the shape and apply some current through

452
00:30:15,710 --> 00:30:25,610
a CL are twenty one and eight and are

453
00:30:19,130 --> 00:30:30,500
twenty then through our thirteen from

454
00:30:25,610 --> 00:30:41,360
our thirteen to our ten they will start

455
00:30:30,500 --> 00:30:50,630
it will start to publish its ROM the

456
00:30:41,360 --> 00:30:54,260
Sheep started to publish how did this

457
00:30:50,630 --> 00:30:58,520
person know because my friend had an

458
00:30:54,260 --> 00:31:06,620
experience of twenty years and knew

459
00:30:58,520 --> 00:31:08,889
about this probably the manufacturer is

460
00:31:06,620 --> 00:31:11,899
only familiar with Nintendo

461
00:31:08,890 --> 00:31:14,240
architectures however my friend is

462
00:31:11,900 --> 00:31:17,150
familiar with several architectures and

463
00:31:14,240 --> 00:31:20,330
he is aware of the typical mistakes made

464
00:31:17,150 --> 00:31:24,740
by manufacturers and that's how he

465
00:31:20,330 --> 00:31:26,629
managed to break this information we're

466
00:31:24,740 --> 00:31:30,919
going to talk now about one of the most

467
00:31:26,630 --> 00:31:34,970
common protection systems most of tips

468
00:31:30,919 --> 00:31:38,020
have a protection bit when this bit is

469
00:31:34,970 --> 00:31:43,090
established the internal memory is

470
00:31:38,020 --> 00:31:49,210
cannot be read works like this because

471
00:31:43,090 --> 00:31:53,780
sometimes we we would like to reuse

472
00:31:49,210 --> 00:31:56,510
chips so this protection bit enables me

473
00:31:53,780 --> 00:31:59,809
to change that content and to read

474
00:31:56,510 --> 00:32:04,530
what's written inside on many occasions

475
00:31:59,809 --> 00:32:08,940
that chip can be restored so the chip

476
00:32:04,530 --> 00:32:13,950
we passed from zero to one I inject a

477
00:32:08,940 --> 00:32:16,799
program I activate the protection bit

478
00:32:13,950 --> 00:32:19,640
and then I cannot read it but I want to

479
00:32:16,799 --> 00:32:22,770
reuse it so that I can delete everything

480
00:32:19,640 --> 00:32:25,799
including the bit of protection and also

481
00:32:22,770 --> 00:32:29,580
the content of it on many occasion it is

482
00:32:25,799 --> 00:32:31,620
not a bit that you can withdraw it is

483
00:32:29,580 --> 00:32:34,379
like a fusible once the fusible is

484
00:32:31,620 --> 00:32:37,918
broken you cannot read in content so

485
00:32:34,380 --> 00:32:42,120
once I said I'm over and the fusible is

486
00:32:37,919 --> 00:32:47,159
broken the chip is not going to be used

487
00:32:42,120 --> 00:32:51,270
anymore so with this kind of chips which

488
00:32:47,159 --> 00:32:54,360
are more frequent are going to be our

489
00:32:51,270 --> 00:32:58,918
point of attack another example of

490
00:32:54,360 --> 00:33:04,820
glitching were on which we based to

491
00:32:58,919 --> 00:33:07,980
attack the bit of protection the Atmel

492
00:33:04,820 --> 00:33:11,280
1889 see 20:51

493
00:33:07,980 --> 00:33:16,110
is the one that you can see do you

494
00:33:11,280 --> 00:33:20,908
remember the one with a regime layer and

495
00:33:16,110 --> 00:33:24,620
this surface which was scratched it is

496
00:33:20,909 --> 00:33:27,870
this one we started to think what if

497
00:33:24,620 --> 00:33:32,449
this is a very classical weak by

498
00:33:27,870 --> 00:33:32,449
manufacturers when I send adulation

499
00:33:32,480 --> 00:33:38,610
order it first deletes the bit of

500
00:33:36,330 --> 00:33:41,699
protection and then the content because

501
00:33:38,610 --> 00:33:45,299
they might occur controlling didn't have

502
00:33:41,700 --> 00:33:52,280
access to its own content bit due to the

503
00:33:45,299 --> 00:33:57,080
chip of the bit of protection so if we

504
00:33:52,280 --> 00:34:01,440
stop the electricity current so we send

505
00:33:57,080 --> 00:34:04,470
halation order and in ten microseconds

506
00:34:01,440 --> 00:34:06,480
we stop the current in order for it not

507
00:34:04,470 --> 00:34:12,480
to have enough time to delete the

508
00:34:06,480 --> 00:34:16,980
content obviously ten microseconds have

509
00:34:12,480 --> 00:34:17,710
been determined because we bought 50 of

510
00:34:16,980 --> 00:34:21,580
these

511
00:34:17,710 --> 00:34:23,250
devices and we were doing some tests so

512
00:34:21,580 --> 00:34:27,069
with 10 microprocessors

513
00:34:23,250 --> 00:34:30,280
microseconds it was quite fair in if you

514
00:34:27,070 --> 00:34:40,089
give it 11 microseconds part of the

515
00:34:30,280 --> 00:34:42,460
content will be deleted the problem is

516
00:34:40,089 --> 00:34:45,399
that what we found out that meant the

517
00:34:42,460 --> 00:34:51,129
manufacturer sort of this vulnerability

518
00:34:45,399 --> 00:34:53,830
in 1998 so it works just in series

519
00:34:51,129 --> 00:34:55,929
before 1998 now we're looking for a

520
00:34:53,830 --> 00:34:58,598
vulnerability that work also in later

521
00:34:55,929 --> 00:35:07,930
series because we have to break the ones

522
00:34:58,599 --> 00:35:12,190
of 1999 I mean I hosted I've written

523
00:35:07,930 --> 00:35:14,049
here this spot from arcade hacker which

524
00:35:12,190 --> 00:35:17,109
is a great hacker from Barcelona so

525
00:35:14,050 --> 00:35:19,000
please take a look at it now I want to

526
00:35:17,109 --> 00:35:23,160
talk about the ID Capon which is like

527
00:35:19,000 --> 00:35:25,960
the main technique the Capon means

528
00:35:23,160 --> 00:35:28,690
removing the packet of the shape until

529
00:35:25,960 --> 00:35:31,240
we can see the surface of the of the

530
00:35:28,690 --> 00:35:33,310
cheap until we can see that the image on

531
00:35:31,240 --> 00:35:35,410
screen once we have that we can apply

532
00:35:33,310 --> 00:35:38,259
many different techniques we can take

533
00:35:35,410 --> 00:35:40,598
micro pictures microphotography we're

534
00:35:38,260 --> 00:35:42,760
going to see that later we can apply UV

535
00:35:40,599 --> 00:35:45,250
light select in a selective way we can

536
00:35:42,760 --> 00:35:47,950
apply laser we can do many wonderful

537
00:35:45,250 --> 00:35:53,200
things this is one of their techniques

538
00:35:47,950 --> 00:35:55,990
that is most useful for doing this

539
00:35:53,200 --> 00:35:58,830
hacking and it is very simple because it

540
00:35:55,990 --> 00:36:01,868
just requires practice it doesn't

541
00:35:58,830 --> 00:36:05,348
require free it doesn't require you to

542
00:36:01,869 --> 00:36:08,130
be a genius mainly here is how to remove

543
00:36:05,349 --> 00:36:12,490
the substrate some people do it with

544
00:36:08,130 --> 00:36:15,250
like apply indirect hot because this

545
00:36:12,490 --> 00:36:18,879
breaks the ceramics and the chip is

546
00:36:15,250 --> 00:36:22,180
preserved so there are people who do

547
00:36:18,880 --> 00:36:24,880
this and then apply and direct hot and

548
00:36:22,180 --> 00:36:27,009
then put this into water and this breaks

549
00:36:24,880 --> 00:36:30,010
the ceramics but but I don't know how

550
00:36:27,010 --> 00:36:31,160
they managed to make the work to make

551
00:36:30,010 --> 00:36:33,260
the chip working

552
00:36:31,160 --> 00:36:35,690
because when I've tried the chip is

553
00:36:33,260 --> 00:36:40,190
useless these are thermal decay the

554
00:36:35,690 --> 00:36:44,500
caffeine you can do some thermal tests

555
00:36:40,190 --> 00:36:48,590
these small lines are thermal test

556
00:36:44,500 --> 00:36:52,760
consequences that make the chip useless

557
00:36:48,590 --> 00:36:56,030
these pictures are from cups of Group

558
00:36:52,760 --> 00:36:58,820
which are great which is great but this

559
00:36:56,030 --> 00:37:00,440
thermal dekapan requires a lot of

560
00:36:58,820 --> 00:37:01,910
parties I don't usually recommend it

561
00:37:00,440 --> 00:37:04,310
because normally you are going to break

562
00:37:01,910 --> 00:37:05,930
cheap after cheap you may see the

563
00:37:04,310 --> 00:37:08,330
content but you are going to break the

564
00:37:05,930 --> 00:37:10,160
chip and many of the techniques are

565
00:37:08,330 --> 00:37:13,279
going to require the chip to be

566
00:37:10,160 --> 00:37:16,100
completely preserved so normally people

567
00:37:13,280 --> 00:37:18,470
use chemical tea caffeine there are some

568
00:37:16,100 --> 00:37:23,029
chemicals that attack ceramics and

569
00:37:18,470 --> 00:37:27,410
plastics but not metals normally and so

570
00:37:23,030 --> 00:37:30,350
for AC it is used with concentration

571
00:37:27,410 --> 00:37:33,020
over ninety percent so if you try this

572
00:37:30,350 --> 00:37:34,850
of course you have to use masks gloves

573
00:37:33,020 --> 00:37:37,400
and you cannot do this

574
00:37:34,850 --> 00:37:43,299
inside a closed room it seems obvious

575
00:37:37,400 --> 00:37:47,870
but I must warn you that the fumes of

576
00:37:43,300 --> 00:37:51,140
sulfuric acid sulfur gas are very

577
00:37:47,870 --> 00:37:52,910
harmful this is for example a laboratory

578
00:37:51,140 --> 00:37:55,700
and these are some chips that are

579
00:37:52,910 --> 00:37:59,180
already prepared you know that to do

580
00:37:55,700 --> 00:38:01,810
this technique AC is quite useful there

581
00:37:59,180 --> 00:38:04,310
are some debates regarding the type of

582
00:38:01,810 --> 00:38:08,810
assets that you can use depending on the

583
00:38:04,310 --> 00:38:12,830
cover of the cheap also there are people

584
00:38:08,810 --> 00:38:15,680
that are doing laser dekapan but these

585
00:38:12,830 --> 00:38:19,610
if you have enough money this is a great

586
00:38:15,680 --> 00:38:22,279
technique because the laser can erode

587
00:38:19,610 --> 00:38:24,830
the substrate but it doesn't harm the

588
00:38:22,280 --> 00:38:28,790
middle the middle is going to get worm

589
00:38:24,830 --> 00:38:31,069
but it is not going to be broken but of

590
00:38:28,790 --> 00:38:34,490
course having a laser in order to do

591
00:38:31,070 --> 00:38:37,310
this decoupling is expensive no not

592
00:38:34,490 --> 00:38:39,439
everybody can afford it well I don't

593
00:38:37,310 --> 00:38:42,770
have a lot of time but as you can

594
00:38:39,440 --> 00:38:44,059
imagine there at the end the tip will be

595
00:38:42,770 --> 00:38:46,819
completely preserved

596
00:38:44,059 --> 00:38:49,430
and I don't know exactly whose this

597
00:38:46,819 --> 00:38:51,410
video from in the groups in which I'm

598
00:38:49,430 --> 00:38:55,788
working we cannot do this laser the

599
00:38:51,410 --> 00:38:59,149
captain because it is very expensive one

600
00:38:55,789 --> 00:39:00,619
of the things that we are going to be

601
00:38:59,150 --> 00:39:03,939
able to do once we've done that the

602
00:39:00,619 --> 00:39:07,699
captain is identifying achieve this is

603
00:39:03,939 --> 00:39:10,459
console and a dashboard we wanted to

604
00:39:07,699 --> 00:39:15,130
learn the processor that it was using we

605
00:39:10,459 --> 00:39:17,779
couldn't do it it was very difficult and

606
00:39:15,130 --> 00:39:20,599
it was very hard to us to identify that

607
00:39:17,779 --> 00:39:21,949
and in order to get ready for an attack

608
00:39:20,599 --> 00:39:25,309
it's very important to have this

609
00:39:21,949 --> 00:39:27,109
information so this is what we did so

610
00:39:25,309 --> 00:39:29,119
all something is that we can do is

611
00:39:27,109 --> 00:39:34,089
visual decoupling this is for very all

612
00:39:29,119 --> 00:39:36,380
devices this is our OEM implant this is

613
00:39:34,089 --> 00:39:44,569
contacting this is not this is

614
00:39:36,380 --> 00:39:48,859
contacting so 1 1 0 0 0 1 1 0 1 this is

615
00:39:44,569 --> 00:39:51,079
what this contact and not non-contact

616
00:39:48,859 --> 00:39:54,140
means with a little bit of patience you

617
00:39:51,079 --> 00:39:56,689
can have this information there visual

618
00:39:54,140 --> 00:39:58,939
art division every artificial vision

619
00:39:56,689 --> 00:40:02,140
program that are useful for that you

620
00:39:58,939 --> 00:40:07,399
don't have to do this with a human hi I

621
00:40:02,140 --> 00:40:11,959
this is a giant j PG before we used to

622
00:40:07,400 --> 00:40:14,959
do it with the human eye and we pretty

623
00:40:11,959 --> 00:40:17,359
the work per squares but with artificial

624
00:40:14,959 --> 00:40:20,808
vision now this can be done very easily

625
00:40:17,359 --> 00:40:22,369
in in faster I don't know if you can

626
00:40:20,809 --> 00:40:28,099
distinguish this here but this is the

627
00:40:22,369 --> 00:40:30,589
memory area 0 1 1 1 0 0 0 these type of

628
00:40:28,099 --> 00:40:35,660
attacks are only going to work with very

629
00:40:30,589 --> 00:40:38,900
old chips unless you have a nuclear

630
00:40:35,660 --> 00:40:40,910
microscope or something like that this

631
00:40:38,900 --> 00:40:44,420
is not something that you can do out

632
00:40:40,910 --> 00:40:47,569
here house but with Anakin microscope is

633
00:40:44,420 --> 00:40:52,279
you can already do the capping from

634
00:40:47,569 --> 00:40:53,808
chips from the 80s or 90s a very good

635
00:40:52,279 --> 00:40:56,040
way of constructing information is

636
00:40:53,809 --> 00:40:58,890
something else that is working very well

637
00:40:56,040 --> 00:41:01,860
is the UV mask this is a chemical

638
00:40:58,890 --> 00:41:06,270
decapping there is we've used a drop of

639
00:41:01,860 --> 00:41:09,030
acid that has destroyed the cover of the

640
00:41:06,270 --> 00:41:12,570
cheap and but we have to be careful

641
00:41:09,030 --> 00:41:14,520
because UV light can delay delete or

642
00:41:12,570 --> 00:41:22,050
erase the content of the memory of the

643
00:41:14,520 --> 00:41:24,290
chips in fact there are some chips that

644
00:41:22,050 --> 00:41:30,030
you've probably seen that have a small

645
00:41:24,290 --> 00:41:33,360
mirror window and this is done like that

646
00:41:30,030 --> 00:41:37,740
because these chips are rewritable and

647
00:41:33,360 --> 00:41:40,170
in order to erase erase them

648
00:41:37,740 --> 00:41:42,689
you have to boost these chips under UV

649
00:41:40,170 --> 00:41:45,600
light for a period of time but here what

650
00:41:42,690 --> 00:41:51,570
we've done is covering with with nail

651
00:41:45,600 --> 00:41:54,810
polish all the content and in order to

652
00:41:51,570 --> 00:41:59,540
protect the memory content this requires

653
00:41:54,810 --> 00:42:01,290
a lot of practice you know the till

654
00:41:59,540 --> 00:42:05,000
especially when you are applying this

655
00:42:01,290 --> 00:42:11,310
nail polish this works with every chip

656
00:42:05,000 --> 00:42:17,820
that may have UV sensitive memory MC UPI

657
00:42:11,310 --> 00:42:23,340
see this is having this has a very

658
00:42:17,820 --> 00:42:25,620
common Architecture from Intel and here

659
00:42:23,340 --> 00:42:28,320
you can see for example that in this

660
00:42:25,620 --> 00:42:30,690
area that's not that's not covered with

661
00:42:28,320 --> 00:42:33,630
the nail polish we have their protection

662
00:42:30,690 --> 00:42:36,120
beat and here we have the memory that we

663
00:42:33,630 --> 00:42:39,390
want to read afterwards and after

664
00:42:36,120 --> 00:42:42,000
applying the nail polish I can apply

665
00:42:39,390 --> 00:42:44,640
later the UV light and this is not

666
00:42:42,000 --> 00:42:47,550
complicated at all something which is

667
00:42:44,640 --> 00:42:50,430
more difficult is the use of laser this

668
00:42:47,550 --> 00:42:53,310
is a laser of one of my one of my

669
00:42:50,430 --> 00:42:57,210
colleagues if you use a laser which is

670
00:42:53,310 --> 00:42:59,880
enough enough powerful the laser can

671
00:42:57,210 --> 00:43:01,290
change the sense of a bead there the

672
00:42:59,880 --> 00:43:03,840
content of a bit so this is the

673
00:43:01,290 --> 00:43:06,180
microscope but we are using to point the

674
00:43:03,840 --> 00:43:08,069
laser the laser is going to point their

675
00:43:06,180 --> 00:43:11,038
protection area

676
00:43:08,069 --> 00:43:13,440
but it may change the number of the beat

677
00:43:11,039 --> 00:43:15,719
it I can change the content on the beat

678
00:43:13,440 --> 00:43:18,390
from 0 to 1 right just using a laser so

679
00:43:15,719 --> 00:43:24,019
we have to be careful with that when we

680
00:43:18,390 --> 00:43:24,019
are talking about few cells we can even

681
00:43:24,499 --> 00:43:37,558
when we are talking about fuses we can

682
00:43:30,449 --> 00:43:39,390
do small welding and this is going to

683
00:43:37,559 --> 00:43:41,699
allow me to read the rest of the field

684
00:43:39,390 --> 00:43:43,799
but these lasers are very expensive and

685
00:43:41,699 --> 00:43:47,519
very difficult to configure 8 in fact

686
00:43:43,799 --> 00:43:52,559
this is the calibration system of one of

687
00:43:47,519 --> 00:43:57,180
these lasers they're people that try to

688
00:43:52,559 --> 00:43:59,849
do glitch in by applying lasers as the

689
00:43:57,180 --> 00:44:02,819
light has ions it can create some

690
00:43:59,849 --> 00:44:05,160
conductive Ness in areas of the chip in

691
00:44:02,819 --> 00:44:12,869
which there shouldn't be any conductive

692
00:44:05,160 --> 00:44:15,359
less conductive Ness so anyway it's very

693
00:44:12,869 --> 00:44:18,299
hard to find that area that specific

694
00:44:15,359 --> 00:44:23,430
area of it cheap this requires having a

695
00:44:18,299 --> 00:44:27,569
deep knowledge on the chip but I I've

696
00:44:23,430 --> 00:44:29,729
always said that light bleaching is not

697
00:44:27,569 --> 00:44:34,319
something that everybody can do because

698
00:44:29,729 --> 00:44:37,129
they're the the complexity of the

699
00:44:34,319 --> 00:44:41,369
process something else that we have

700
00:44:37,130 --> 00:44:44,549
another technique is micro probing but

701
00:44:41,369 --> 00:44:48,599
besides knowing the hardware you need to

702
00:44:44,549 --> 00:44:54,329
have very good manual skills these are

703
00:44:48,599 --> 00:44:56,839
some pictures from a cheap from a game I

704
00:44:54,329 --> 00:44:59,930
think which had a very strong protection

705
00:44:56,839 --> 00:45:03,239
I'm going to speed up a little bit but

706
00:44:59,930 --> 00:45:08,149
part of the chip was Cod here we have

707
00:45:03,239 --> 00:45:11,039
the processing part memories are etc and

708
00:45:08,150 --> 00:45:14,999
the memory was extracted you know the

709
00:45:11,039 --> 00:45:21,010
quarry to be read with with an external

710
00:45:14,999 --> 00:45:25,450
device and welding things too

711
00:45:21,010 --> 00:45:27,790
at this level is very complex I don't

712
00:45:25,450 --> 00:45:31,899
know how John and his team can do these

713
00:45:27,790 --> 00:45:34,480
things with practically a domestic love

714
00:45:31,900 --> 00:45:38,830
laboratory there are other other

715
00:45:34,480 --> 00:45:41,410
hardware components such as peer these

716
00:45:38,830 --> 00:45:45,460
that make this process even harder

717
00:45:41,410 --> 00:45:49,210
because they have an entry and Nexus

718
00:45:45,460 --> 00:45:56,980
there are different types of P LTS ppl

719
00:45:49,210 --> 00:46:00,550
DS F GPA probably FB T they are more

720
00:45:56,980 --> 00:46:01,510
popular right now there is some devices

721
00:46:00,550 --> 00:46:05,080
that are called

722
00:46:01,510 --> 00:46:08,560
tal crackers and because these it's

723
00:46:05,080 --> 00:46:12,130
containing a formula inside you can is

724
00:46:08,560 --> 00:46:19,900
brute force in order to try all types of

725
00:46:12,130 --> 00:46:22,060
axis and entries and different

726
00:46:19,900 --> 00:46:24,850
mathematical procedures for example if I

727
00:46:22,060 --> 00:46:27,250
have a lot of values for entries and

728
00:46:24,850 --> 00:46:29,140
exits through an interpolation I can

729
00:46:27,250 --> 00:46:31,420
obtain the formula of these entries and

730
00:46:29,140 --> 00:46:39,490
exits and this is the formula that the

731
00:46:31,420 --> 00:46:43,360
chip within these PDS is using but

732
00:46:39,490 --> 00:46:47,140
depending on the type of PLD it can take

733
00:46:43,360 --> 00:46:49,600
years to obtain that information I can

734
00:46:47,140 --> 00:46:54,640
use this type of techniques used with PL

735
00:46:49,600 --> 00:47:00,759
DS that have very simple algorithms

736
00:46:54,640 --> 00:47:02,170
inside and well finally I just want to

737
00:47:00,760 --> 00:47:05,170
talk to you about the groups that are

738
00:47:02,170 --> 00:47:10,750
dealing with these type of processes

739
00:47:05,170 --> 00:47:12,400
sound bridle cups of John McMaster which

740
00:47:10,750 --> 00:47:15,210
is working for cap shot

741
00:47:12,400 --> 00:47:19,810
Cole J which is in charge of

742
00:47:15,210 --> 00:47:22,380
interpreting the inside of the chip he

743
00:47:19,810 --> 00:47:25,120
knows exactly how its part of the chip

744
00:47:22,380 --> 00:47:26,860
interacts with other parts if we are

745
00:47:25,120 --> 00:47:29,650
talking about an illogical or digital

746
00:47:26,860 --> 00:47:33,740
parts team Europe is also doing great

747
00:47:29,650 --> 00:47:35,540
things regarding UV covers UV masks the

748
00:47:33,740 --> 00:47:40,399
the union is one of the groups with whom

749
00:47:35,540 --> 00:47:45,590
I'm working the most silicon prong is in

750
00:47:40,400 --> 00:47:50,150
charge of publishing content of inside

751
00:47:45,590 --> 00:47:52,550
of within chips an arcade hacker is a

752
00:47:50,150 --> 00:47:57,530
great fan of mine one of the best

753
00:47:52,550 --> 00:47:59,990
hackers of Barcelona and just to finish

754
00:47:57,530 --> 00:48:03,500
my presentation we've seen that we can

755
00:47:59,990 --> 00:48:05,299
obtain information from chips and well

756
00:48:03,500 --> 00:48:06,890
this is an advantage because this is

757
00:48:05,300 --> 00:48:10,210
going to give me all the information I

758
00:48:06,890 --> 00:48:13,640
need about a device this is an access if

759
00:48:10,210 --> 00:48:18,080
this is an access device that I obtained

760
00:48:13,640 --> 00:48:21,920
from a ministry here in Spain and it is

761
00:48:18,080 --> 00:48:27,080
it has a ECU of 25 it is a very simple

762
00:48:21,920 --> 00:48:31,220
hardware so I can transfer the our OEM

763
00:48:27,080 --> 00:48:32,960
in so what can I do and I may be using

764
00:48:31,220 --> 00:48:42,319
this or any other type of similar

765
00:48:32,960 --> 00:48:44,900
devices we can use ma m e ma a me well

766
00:48:42,320 --> 00:48:47,990
this is the device as with chicken as

767
00:48:44,900 --> 00:48:53,060
you can see you can do emulations of

768
00:48:47,990 --> 00:48:55,729
real programs and we can use it through

769
00:48:53,060 --> 00:48:59,259
coding I'm going to launch a small

770
00:48:55,730 --> 00:48:59,260
demonstration that I have here

771
00:49:08,060 --> 00:49:18,690
icky tangle paramah from Fernando

772
00:49:11,330 --> 00:49:20,880
so this is the the program and I can for

773
00:49:18,690 --> 00:49:23,970
example with peace I can check if

774
00:49:20,880 --> 00:49:26,340
they're backdoors I'm executing the code

775
00:49:23,970 --> 00:49:28,620
here I can launch automatic test thing I

776
00:49:26,340 --> 00:49:30,330
can do anything I want to in a hardware

777
00:49:28,620 --> 00:49:33,180
device before I can couldn't launch

778
00:49:30,330 --> 00:49:37,140
automatic testings I had to pay someone

779
00:49:33,180 --> 00:49:39,240
so that this person would be trying

780
00:49:37,140 --> 00:49:45,330
different numbers zero zero zero zero

781
00:49:39,240 --> 00:49:48,290
and different other combinations or

782
00:49:45,330 --> 00:49:51,720
different other combinations of of

783
00:49:48,290 --> 00:49:54,900
introducing several commands at the same

784
00:49:51,720 --> 00:49:57,029
time but this is a simulation of the

785
00:49:54,900 --> 00:50:13,680
execution of the program and in fact if

786
00:49:57,030 --> 00:50:15,930
I click here see well what I wanted to

787
00:50:13,680 --> 00:50:21,540
show you is that ma ma

788
00:50:15,930 --> 00:50:24,359
I mean well normally we try to register

789
00:50:21,540 --> 00:50:28,140
all the information in files because

790
00:50:24,360 --> 00:50:30,600
normally pictures are more easily maybe

791
00:50:28,140 --> 00:50:33,240
lost more easily but it will in the end

792
00:50:30,600 --> 00:50:36,690
here you have it is 20 lines of codes

793
00:50:33,240 --> 00:50:40,740
we've achieved to emulate quite complex

794
00:50:36,690 --> 00:50:44,070
access control system we can automate

795
00:50:40,740 --> 00:50:50,549
eyes entries exceeds we have everything

796
00:50:44,070 --> 00:50:54,300
there and we even have this controller

797
00:50:50,550 --> 00:51:02,610
of the LCD I could even launch attacks

798
00:50:54,300 --> 00:51:07,020
towards LCD for example here we have V

799
00:51:02,610 --> 00:51:10,070
25 5 at 16 measures so I can automate

800
00:51:07,020 --> 00:51:13,100
eyes all type of testings against our

801
00:51:10,070 --> 00:51:18,110
wonderful program

802
00:51:13,100 --> 00:51:21,610
so it's true that this system this

803
00:51:18,110 --> 00:51:25,130
access control system and may be

804
00:51:21,610 --> 00:51:30,020
interesting because this can be tested

805
00:51:25,130 --> 00:51:34,660
in different ministers here but I can

806
00:51:30,020 --> 00:51:39,280
try these in in different power stations

807
00:51:34,660 --> 00:51:59,089
and I can control the fire alarms of

808
00:51:39,280 --> 00:52:04,250
central or power plant and finally there

809
00:51:59,090 --> 00:52:07,040
are many people working in a ma ma ma

810
00:52:04,250 --> 00:52:10,010
and well this is an accurate data

811
00:52:07,040 --> 00:52:13,520
acquisition system that was used

812
00:52:10,010 --> 00:52:18,320
connected to a cryogenics agency system

813
00:52:13,520 --> 00:52:20,770
that we got from a garbage so I love the

814
00:52:18,320 --> 00:52:24,080
garbage of laboratories and that stuff

815
00:52:20,770 --> 00:52:28,040
and well this is used in remote data

816
00:52:24,080 --> 00:52:31,220
stations in which there is no final for

817
00:52:28,040 --> 00:52:35,090
example in facilities in the middle of

818
00:52:31,220 --> 00:52:39,609
the mountain they do not have a

819
00:52:35,090 --> 00:52:39,610
satellite connections one once a month

820
00:52:41,680 --> 00:52:50,390
once someone goes to extract the data

821
00:52:46,430 --> 00:52:52,960
from these devices and we were wondering

822
00:52:50,390 --> 00:52:55,900
if we could introduce a virus in

823
00:52:52,960 --> 00:52:58,610
meteorology emergency Central Station

824
00:52:55,900 --> 00:53:00,920
because in the meteorology station which

825
00:52:58,610 --> 00:53:02,540
is in the middle of the mountain

826
00:53:00,920 --> 00:53:07,120
nobody is going to see me I could go

827
00:53:02,540 --> 00:53:10,220
there and manipulate that device good

828
00:53:07,120 --> 00:53:11,569
try to infect the meteorology Central

829
00:53:10,220 --> 00:53:13,430
Station through their devices in the

830
00:53:11,570 --> 00:53:16,100
middle of the mountain I would need to

831
00:53:13,430 --> 00:53:19,700
get to know the that device that remote

832
00:53:16,100 --> 00:53:22,730
device perfectly but these are quite

833
00:53:19,700 --> 00:53:25,939
interesting attack fractures so in

834
00:53:22,730 --> 00:53:26,779
systems that are embedded here maybe

835
00:53:25,940 --> 00:53:29,539
very

836
00:53:26,779 --> 00:53:31,579
important I mean I've talked to you

837
00:53:29,539 --> 00:53:34,429
mainly about games because this is my

838
00:53:31,579 --> 00:53:35,779
field of work but these are points of

839
00:53:34,429 --> 00:53:40,400
attack that are going to allow us to

840
00:53:35,779 --> 00:53:44,539
extract data and to audit a more

841
00:53:40,400 --> 00:53:46,969
exhaustive level compared to what we

842
00:53:44,539 --> 00:53:48,769
could do without using these tools so

843
00:53:46,969 --> 00:53:53,150
before finishing I would like to thank

844
00:53:48,769 --> 00:53:57,288
in CV for having invited me to be here I

845
00:53:53,150 --> 00:53:59,809
feel like home in this event and thank

846
00:53:57,289 --> 00:54:07,880
you so much to all of you for attending

847
00:53:59,809 --> 00:54:23,900
my presentation thank you very much are

848
00:54:07,880 --> 00:54:26,599
there any questions in the system that

849
00:54:23,900 --> 00:54:32,779
you've explained the Etrian closed

850
00:54:26,599 --> 00:54:37,419
system you've said that the solution was

851
00:54:32,779 --> 00:54:42,049
connecting that was changing their

852
00:54:37,419 --> 00:54:44,839
memory to a non-volatile memory how is

853
00:54:42,049 --> 00:54:54,140
this how does this process work well

854
00:54:44,839 --> 00:54:56,558
it's the simple process are am connected

855
00:54:54,140 --> 00:55:01,339
to a battery it turns into a

856
00:54:56,559 --> 00:55:03,409
non-volatile are am so you need to look

857
00:55:01,339 --> 00:55:06,199
for a component that has the same

858
00:55:03,409 --> 00:55:09,349
characteristics for example if you can

859
00:55:06,199 --> 00:55:12,469
see the frequency at which it is working

860
00:55:09,349 --> 00:55:16,789
in in our case we used an old plate that

861
00:55:12,469 --> 00:55:19,099
we used to hire another machine and we

862
00:55:16,789 --> 00:55:22,609
could have used also these connected to

863
00:55:19,099 --> 00:55:26,409
a battery the thing is that if you

864
00:55:22,609 --> 00:55:29,808
should be able to cut the power and to

865
00:55:26,409 --> 00:55:31,969
still maintain preserve the content of

866
00:55:29,809 --> 00:55:36,039
the memory so it's always going to be on

867
00:55:31,969 --> 00:55:36,039
air am connected to a battery

868
00:55:40,869 --> 00:55:45,760
well thank you so much to all of you

869
00:55:43,420 --> 00:55:49,630
[Applause]

870
00:55:45,760 --> 00:55:52,760
[Music]

871
00:55:49,630 --> 00:55:52,760
[Applause]

