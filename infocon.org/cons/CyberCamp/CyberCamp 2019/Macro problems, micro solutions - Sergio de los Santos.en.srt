1
00:00:01,990 --> 00:00:05,060
[Music]

2
00:00:09,640 --> 00:00:12,919
[Music]

3
00:00:15,289 --> 00:00:21,740
okay so my presentation is about micro

4
00:00:18,029 --> 00:00:26,609
problems and micro solutions I mean

5
00:00:21,740 --> 00:00:28,740
solutions sometimes small solutions are

6
00:00:26,609 --> 00:00:30,240
efficient for big problems first I'm

7
00:00:28,740 --> 00:00:34,559
going to give you some context regarding

8
00:00:30,240 --> 00:00:37,579
macros how we got here also I'm going to

9
00:00:34,559 --> 00:00:41,750
talk about some attacks curiosities and

10
00:00:37,579 --> 00:00:46,110
statistics regarding how micros work and

11
00:00:41,750 --> 00:00:53,330
finally some small solutions but in the

12
00:00:46,110 --> 00:00:56,399
end are efficient Ellison toast

13
00:00:53,330 --> 00:00:58,050
[Music]

14
00:00:56,399 --> 00:01:02,719
starting with my presentation I would

15
00:00:58,050 --> 00:01:06,420
like to explain what an office macro is

16
00:01:02,719 --> 00:01:09,330
I'm sure that you've heard about my

17
00:01:06,420 --> 00:01:13,400
first before but to sum up micros

18
00:01:09,330 --> 00:01:22,500
involve introducing extract executable

19
00:01:13,400 --> 00:01:26,820
code in an office document execution

20
00:01:22,500 --> 00:01:32,130
driver with a BB a micro slang with and

21
00:01:26,820 --> 00:01:35,669
this is used in with legitimate purpose

22
00:01:32,130 --> 00:01:37,619
but also with tracking purposes there

23
00:01:35,670 --> 00:01:41,119
are more malicious markers than

24
00:01:37,619 --> 00:01:44,310
legitimate macros and they are used to

25
00:01:41,119 --> 00:01:46,560
automatic cell and world processes to

26
00:01:44,310 --> 00:01:48,240
access databases and they are very

27
00:01:46,560 --> 00:01:50,159
powerful you can do anything with them

28
00:01:48,240 --> 00:01:53,579
so also our trackers can do anything

29
00:01:50,159 --> 00:02:00,840
with the macros that are integrated in

30
00:01:53,579 --> 00:02:02,399
our embedded in the documents micros for

31
00:02:00,840 --> 00:02:06,840
what an excel which are the most popular

32
00:02:02,399 --> 00:02:08,580
ones are executable code that is used

33
00:02:06,840 --> 00:02:10,140
when you launch a document so this is

34
00:02:08,580 --> 00:02:11,760
why it is so dangerous to launch

35
00:02:10,139 --> 00:02:21,269
documents

36
00:02:11,760 --> 00:02:21,269
via email for example so dangerous that

37
00:02:22,530 --> 00:02:30,850
many years ago they published that 45%

38
00:02:26,140 --> 00:02:38,589
of attacks were done by office markers

39
00:02:30,850 --> 00:02:41,620
and 37% through CBE 2017 one one eight

40
00:02:38,590 --> 00:02:43,630
eighty this is a problem when processing

41
00:02:41,620 --> 00:02:47,410
equations in word the model in the

42
00:02:43,630 --> 00:02:50,170
engine that processes equations exceeds

43
00:02:47,410 --> 00:02:53,829
the power the power of the buffer and

44
00:02:50,170 --> 00:02:58,660
when you double-click it it starts

45
00:02:53,830 --> 00:03:04,510
executing code so about almost 80% of

46
00:02:58,660 --> 00:03:13,420
problems which malware can be introduced

47
00:03:04,510 --> 00:03:16,750
in systems is office these are other

48
00:03:13,420 --> 00:03:24,339
graphs explain how much things have

49
00:03:16,750 --> 00:03:27,880
changed in in 2016 the highest number of

50
00:03:24,340 --> 00:03:32,739
attacks came from Navigators up to 45

51
00:03:27,880 --> 00:03:36,040
percent while in 2018 about 70 percent

52
00:03:32,739 --> 00:03:42,310
of attacks we're coming through with

53
00:03:36,040 --> 00:03:44,260
office documents micros or vulnerability

54
00:03:42,310 --> 00:03:50,380
cells such as the equation vulnerability

55
00:03:44,260 --> 00:03:55,750
in 2016 this amount how did about 16

56
00:03:50,380 --> 00:04:02,070
percent and this has increased why in

57
00:03:55,750 --> 00:04:06,370
2013 Java for example accounted for

58
00:04:02,070 --> 00:04:11,890
almost the whole high but now it's not

59
00:04:06,370 --> 00:04:17,230
that important also browsers in 2016

60
00:04:11,890 --> 00:04:21,450
we're also the most popular attack adult

61
00:04:17,230 --> 00:04:26,550
large for example PDF

62
00:04:21,450 --> 00:04:30,300
we're causing more problems treetog ryu

63
00:04:26,550 --> 00:04:32,490
all these things arrived threw off its

64
00:04:30,300 --> 00:04:38,580
macros so one of the biggest problems

65
00:04:32,490 --> 00:04:41,330
that we have right now are caused by

66
00:04:38,580 --> 00:04:44,400
just opening and office documents and

67
00:04:41,330 --> 00:04:48,330
local governments have been attacked for

68
00:04:44,400 --> 00:04:52,229
example through these resources and well

69
00:04:48,330 --> 00:04:56,719
we why Mike Rosario they are easy to

70
00:04:52,230 --> 00:04:56,720
hide their lady teammate and the user

71
00:04:57,080 --> 00:05:03,030
enables these macros even though they

72
00:04:59,460 --> 00:05:04,650
are disabled by default and so we are

73
00:05:03,030 --> 00:05:07,559
going to see the tricks that they use in

74
00:05:04,650 --> 00:05:11,940
order for the user to to enable these

75
00:05:07,560 --> 00:05:17,610
macros they are more complex even though

76
00:05:11,940 --> 00:05:22,110
some Sun boxes can be used but it is

77
00:05:17,610 --> 00:05:26,850
more complex to emulate these are

78
00:05:22,110 --> 00:05:29,400
usually sent by eye and the server level

79
00:05:26,850 --> 00:05:33,270
this is analyzed statically and this

80
00:05:29,400 --> 00:05:36,960
type of analysis can avoid antivirus

81
00:05:33,270 --> 00:05:39,919
very easily also opening an excel or a

82
00:05:36,960 --> 00:05:43,590
document may be as dangerous are us

83
00:05:39,920 --> 00:05:46,350
clicking on an executable program and

84
00:05:43,590 --> 00:05:50,130
the attackers can only use this method

85
00:05:46,350 --> 00:05:52,950
in order to attack not a growth browsers

86
00:05:50,130 --> 00:05:56,340
at all Java are not a way of introducing

87
00:05:52,950 --> 00:05:58,500
these type of viruses so an email is the

88
00:05:56,340 --> 00:06:00,989
best option for them we don't know what

89
00:05:58,500 --> 00:06:03,920
they will use tomorrow but this is what

90
00:06:00,990 --> 00:06:03,920
they are doing right now

91
00:06:04,190 --> 00:06:11,660
I'm going to explain where the macros

92
00:06:06,540 --> 00:06:14,580
are if you open dot X document and

93
00:06:11,660 --> 00:06:18,600
typical 2013 documents you will see that

94
00:06:14,580 --> 00:06:21,210
this there is a seed with a lot of XML

95
00:06:18,600 --> 00:06:29,520
documents and if you have macros here

96
00:06:21,210 --> 00:06:35,080
you will see in point

97
00:06:29,520 --> 00:06:37,159
I mean pin and this is where

98
00:06:35,080 --> 00:06:42,590
everything that I'm a current needs to

99
00:06:37,160 --> 00:06:47,270
execute if we click on that pin which is

100
00:06:42,590 --> 00:06:49,099
C and can be open with the program you

101
00:06:47,270 --> 00:06:54,620
will see that inside there is a project

102
00:06:49,099 --> 00:06:57,110
and a folder VBA which is the code in

103
00:06:54,620 --> 00:07:00,440
which macros are writing have written

104
00:06:57,110 --> 00:07:05,020
and if weekly inside there will be a

105
00:07:00,440 --> 00:07:09,860
through all a browser we will see that

106
00:07:05,020 --> 00:07:12,650
there flows macros etc I mean this a

107
00:07:09,860 --> 00:07:15,080
project success dotnet you have to

108
00:07:12,650 --> 00:07:18,380
compile it execute it we will see this

109
00:07:15,080 --> 00:07:23,349
later so well as I was saying it has our

110
00:07:18,380 --> 00:07:25,969
configuration file project with empty

111
00:07:23,349 --> 00:07:30,409
office has the engine engine is going to

112
00:07:25,970 --> 00:07:32,150
interpret and execute the commands the

113
00:07:30,409 --> 00:07:34,310
layout of the project because it's a

114
00:07:32,150 --> 00:07:36,289
programming project then the streams of

115
00:07:34,310 --> 00:07:39,380
the Molly modules depending on the

116
00:07:36,289 --> 00:07:41,810
number of macros and then there is

117
00:07:39,380 --> 00:07:45,080
something called performance cachet we

118
00:07:41,810 --> 00:07:47,870
will see later in comprehends compressed

119
00:07:45,080 --> 00:07:49,849
source code this is very important I

120
00:07:47,870 --> 00:07:51,590
don't know if you've seen a macro I will

121
00:07:49,849 --> 00:07:54,080
I will show you a video later but if you

122
00:07:51,590 --> 00:07:56,500
open a macro with office you will I mean

123
00:07:54,080 --> 00:08:00,139
if you open office you will there is a

124
00:07:56,500 --> 00:08:02,810
top that writes macros and you can see

125
00:08:00,139 --> 00:08:06,169
the source code of the macros not just a

126
00:08:02,810 --> 00:08:10,130
compiling a item but also the source

127
00:08:06,169 --> 00:08:16,639
code and why because probably as

128
00:08:10,130 --> 00:08:19,120
Microsoft wants to compatibility with

129
00:08:16,639 --> 00:08:22,280
previous versions if you launch a macro

130
00:08:19,120 --> 00:08:24,759
compile for an engineer you open it

131
00:08:22,280 --> 00:08:27,979
without the different version engine

132
00:08:24,759 --> 00:08:31,070
this is going to compile the code for

133
00:08:27,979 --> 00:08:35,088
you so that and that helps the

134
00:08:31,070 --> 00:08:39,890
inspection spray and as there are

135
00:08:35,089 --> 00:08:43,699
different VBA engines if you open macro

136
00:08:39,890 --> 00:08:44,779
2016 in a 2013 13 office you are going

137
00:08:43,698 --> 00:08:45,969
to be able to read because of the

138
00:08:44,779 --> 00:08:48,130
compilation

139
00:08:45,970 --> 00:08:51,339
it is why the source code is already

140
00:08:48,130 --> 00:08:54,189
it's also embedded there are many

141
00:08:51,339 --> 00:08:57,149
different types of type of documents and

142
00:08:54,190 --> 00:08:59,649
also because of everlasting

143
00:08:57,149 --> 00:09:01,450
compatibility we're going to see that

144
00:08:59,649 --> 00:09:05,649
there are different type of documents

145
00:09:01,450 --> 00:09:08,740
that coexist for example open XML is the

146
00:09:05,649 --> 00:09:13,390
current type of document which is later

147
00:09:08,740 --> 00:09:17,680
than 2006 c7 and the extensions end up

148
00:09:13,390 --> 00:09:23,399
in X these are zipped documents that

149
00:09:17,680 --> 00:09:27,359
have an object an XML configuration

150
00:09:23,399 --> 00:09:31,750
before the classical dog was something

151
00:09:27,360 --> 00:09:40,329
was not easy to understand that was an

152
00:09:31,750 --> 00:09:46,810
object in itself with a binary when the

153
00:09:40,329 --> 00:09:54,130
document had inside the macro with

154
00:09:46,810 --> 00:09:55,869
another document in the embedded allow

155
00:09:54,130 --> 00:09:58,089
you to navigate through the document but

156
00:09:55,870 --> 00:10:00,820
if it was not so easy because it was not

157
00:09:58,089 --> 00:10:04,240
something in standard there are more

158
00:10:00,820 --> 00:10:08,079
formats even though they are not as

159
00:10:04,240 --> 00:10:10,120
famous and that have emerged again

160
00:10:08,079 --> 00:10:16,149
because attackers are using them in

161
00:10:10,120 --> 00:10:19,180
order to hide their intentions so these

162
00:10:16,149 --> 00:10:22,870
are weird format use the name is similar

163
00:10:19,180 --> 00:10:25,149
to office XML but it is not open XML the

164
00:10:22,870 --> 00:10:31,270
previous one that we've seen Microsoft

165
00:10:25,149 --> 00:10:33,040
invented a format called open XML which

166
00:10:31,270 --> 00:10:42,160
is not the same as the one that we've

167
00:10:33,040 --> 00:10:44,620
seen before Microsoft Office XML example

168
00:10:42,160 --> 00:10:49,480
in we keep a Wikipedia you can take

169
00:10:44,620 --> 00:10:52,769
these format XML this is just plain test

170
00:10:49,480 --> 00:10:52,769
you can paste it here

171
00:10:52,920 --> 00:11:11,709
in a document you can keep it and if you

172
00:11:00,190 --> 00:11:13,720
change the name to dot docx opens as if

173
00:11:11,710 --> 00:11:16,750
it was a document if you want to change

174
00:11:13,720 --> 00:11:20,320
the format you can do it here and it

175
00:11:16,750 --> 00:11:29,350
will keep on being a document but now I

176
00:11:20,320 --> 00:11:33,520
think I'm trying to open it so I

177
00:11:29,350 --> 00:11:39,520
converted it to a new document it it

178
00:11:33,520 --> 00:11:42,520
moved from the docx format to this is

179
00:11:39,520 --> 00:11:49,720
unknown format and in order to introduce

180
00:11:42,520 --> 00:11:54,840
macros you need to add base64 because it

181
00:11:49,720 --> 00:11:59,980
is binary and it is that beam point is

182
00:11:54,840 --> 00:12:02,140
encrypted in base64 I saved it in the

183
00:11:59,980 --> 00:12:04,660
older format and as you can see it is

184
00:12:02,140 --> 00:12:09,939
binary so you can understand anything

185
00:12:04,660 --> 00:12:14,800
there are other many formats where you

186
00:12:09,940 --> 00:12:19,750
can add macros in an attempt to alert

187
00:12:14,800 --> 00:12:24,270
the user when document had a macro

188
00:12:19,750 --> 00:12:28,060
several years ago office renamed it as

189
00:12:24,270 --> 00:12:31,090
doc M which means document with macros

190
00:12:28,060 --> 00:12:36,910
with a small alert the problem is that

191
00:12:31,090 --> 00:12:41,110
it also needs to recognize doc so you

192
00:12:36,910 --> 00:12:44,380
remove the M or you add an X and then

193
00:12:41,110 --> 00:12:47,830
you don't get that alert so it's useless

194
00:12:44,380 --> 00:12:50,920
there are other kinds of macros which

195
00:12:47,830 --> 00:12:56,830
can be included in templates and each of

196
00:12:50,920 --> 00:13:00,459
them has its own format like modern

197
00:12:56,830 --> 00:13:03,360
template older template there are many

198
00:13:00,460 --> 00:13:03,360
many macros

199
00:13:03,370 --> 00:13:12,820
: malware us before macros malware

200
00:13:08,340 --> 00:13:19,300
between 1997 and 2003 it was quite

201
00:13:12,820 --> 00:13:23,290
popular Melissa for the older ones was

202
00:13:19,300 --> 00:13:25,750
malware that affected 20% of people it

203
00:13:23,290 --> 00:13:29,770
would send you a document you would open

204
00:13:25,750 --> 00:13:34,600
it and the macro would take a look at

205
00:13:29,770 --> 00:13:37,810
your contacts and it was recent to

206
00:13:34,600 --> 00:13:41,170
itself at that moment there was no

207
00:13:37,810 --> 00:13:43,599
security macros were executed by default

208
00:13:41,170 --> 00:13:47,410
only by opening the document which is

209
00:13:43,600 --> 00:13:52,380
something crazy today so there was no

210
00:13:47,410 --> 00:13:58,689
awareness on security 20 years ago and

211
00:13:52,380 --> 00:14:06,970
it was they were using Windows XP and

212
00:13:58,690 --> 00:14:09,400
backwards from 2003 to 2013 no one was

213
00:14:06,970 --> 00:14:13,350
using the macro malware in order to

214
00:14:09,400 --> 00:14:20,590
perform attacks but at a certain point

215
00:14:13,350 --> 00:14:24,370
maybe in 2003 functionality was

216
00:14:20,590 --> 00:14:28,780
implemented macros were not executed by

217
00:14:24,370 --> 00:14:30,940
default you would get a warning you know

218
00:14:28,780 --> 00:14:38,890
that you know whether you wanted to do

219
00:14:30,940 --> 00:14:41,650
to execute it or not it was easier to do

220
00:14:38,890 --> 00:14:45,550
it in another way this way was forgotten

221
00:14:41,650 --> 00:14:53,410
however in 2014 this malware came into

222
00:14:45,550 --> 00:14:57,870
force again the fact that computers were

223
00:14:53,410 --> 00:15:02,790
awful in terms of security Java was

224
00:14:57,870 --> 00:15:06,690
awful and the others are well as well so

225
00:15:02,790 --> 00:15:09,790
attackers found in macros and in social

226
00:15:06,690 --> 00:15:13,900
engineering being used the most

227
00:15:09,790 --> 00:15:15,520
vulnerable one a formula that has been

228
00:15:13,900 --> 00:15:22,750
successful seems to

229
00:15:15,520 --> 00:15:30,130
1:14 here I'm going to show you the

230
00:15:22,750 --> 00:15:34,240
graph think PowerShell starts to be

231
00:15:30,130 --> 00:15:37,689
vicars they detect that from macros they

232
00:15:34,240 --> 00:15:40,390
can call PowerShell it is important for

233
00:15:37,690 --> 00:15:43,330
PowerShell to be obvious because it can

234
00:15:40,390 --> 00:15:46,150
execute many things without affecting

235
00:15:43,330 --> 00:15:48,700
the disk and if you do not affect the

236
00:15:46,150 --> 00:15:52,900
disk you're not going to be the tactic

237
00:15:48,700 --> 00:15:55,800
by detected by antivirus so the

238
00:15:52,900 --> 00:15:59,530
combination of macro and PowerShell

239
00:15:55,800 --> 00:16:04,060
became very powerful since 2014

240
00:15:59,530 --> 00:16:07,990
these Microsoft graphs show the moment

241
00:16:04,060 --> 00:16:12,390
when somebody detected the power of

242
00:16:07,990 --> 00:16:15,760
macros and they tell telemetrics sword

243
00:16:12,390 --> 00:16:19,210
there we have the link we're going to

244
00:16:15,760 --> 00:16:21,580
see some curious formulas or that show

245
00:16:19,210 --> 00:16:25,020
the evolution of attackers in order to

246
00:16:21,580 --> 00:16:28,840
hide macros first it's also engineering

247
00:16:25,020 --> 00:16:33,300
as it is activated by default the

248
00:16:28,840 --> 00:16:37,810
attacker is hope is hoping that the user

249
00:16:33,300 --> 00:16:40,089
activated in order to do so they use

250
00:16:37,810 --> 00:16:43,900
different techniques they send

251
00:16:40,090 --> 00:16:48,370
instructions to activate macros for that

252
00:16:43,900 --> 00:16:51,910
document all the times they say this

253
00:16:48,370 --> 00:16:55,980
document is protected so you have to

254
00:16:51,910 --> 00:16:59,980
enable macros in order to get affected

255
00:16:55,980 --> 00:17:04,300
others say that day of his version is

256
00:16:59,980 --> 00:17:08,050
not supported another one is that the

257
00:17:04,300 --> 00:17:14,560
file is encrypted and clicking on the

258
00:17:08,050 --> 00:17:17,319
link you will you will decode it so

259
00:17:14,560 --> 00:17:21,399
everything is done in order to enable

260
00:17:17,319 --> 00:17:23,889
macros also enable macros because your

261
00:17:21,400 --> 00:17:25,660
code your encryption is not good and you

262
00:17:23,890 --> 00:17:28,240
cannot see the important in May

263
00:17:25,660 --> 00:17:30,460
you know the document here the document

264
00:17:28,240 --> 00:17:33,580
is blurry so if you click on the button

265
00:17:30,460 --> 00:17:37,810
you will see it perfectly clear there

266
00:17:33,580 --> 00:17:42,929
are several techniques these are the

267
00:17:37,810 --> 00:17:48,220
most elegant ones which are infecting

268
00:17:42,930 --> 00:17:52,630
several victims simply they say I need

269
00:17:48,220 --> 00:17:57,040
admin admin privileges which should

270
00:17:52,630 --> 00:17:59,850
already tell you that this is species in

271
00:17:57,040 --> 00:18:05,080
order to enable the macros in the end

272
00:17:59,850 --> 00:18:12,209
here it says in order to activate office

273
00:18:05,080 --> 00:18:16,120
you need to enable macros there is

274
00:18:12,210 --> 00:18:23,440
Twitter by these famous Twitter account

275
00:18:16,120 --> 00:18:30,459
that say yes

276
00:18:23,440 --> 00:18:34,630
they infect me another curious point

277
00:18:30,460 --> 00:18:44,250
about this macro I think there was an

278
00:18:34,630 --> 00:18:48,250
Asian country where attackers the macros

279
00:18:44,250 --> 00:18:52,690
you can see it says enable content so to

280
00:18:48,250 --> 00:18:56,770
extract the macros from its typical

281
00:18:52,690 --> 00:18:59,730
location this document had some white

282
00:18:56,770 --> 00:19:07,180
pages and then something weird if you

283
00:18:59,730 --> 00:19:11,490
zoomed it because the font is tiny leads

284
00:19:07,180 --> 00:19:16,180
you to code in base64 which is a binary

285
00:19:11,490 --> 00:19:18,850
which in the end will infect him but it

286
00:19:16,180 --> 00:19:24,670
was written in the document not in the

287
00:19:18,850 --> 00:19:28,629
macro itself at least in today's they

288
00:19:24,670 --> 00:19:29,350
used another format called M HTML which

289
00:19:28,630 --> 00:19:33,850
is like

290
00:19:29,350 --> 00:19:41,189
eight tml and if you rename it as a dog

291
00:19:33,850 --> 00:19:45,879
it also works as one in this video I

292
00:19:41,190 --> 00:19:53,200
take the doc human and I left over there

293
00:19:45,880 --> 00:19:57,009
before I drag it here binary format I

294
00:19:53,200 --> 00:20:03,580
open it in Word and I'm going to save it

295
00:19:57,009 --> 00:20:07,590
as an HTML which is format I wasn't

296
00:20:03,580 --> 00:20:11,080
familiar with it's useful to create

297
00:20:07,590 --> 00:20:13,980
websites through worried as you can see

298
00:20:11,080 --> 00:20:13,980
the icon

299
00:20:15,009 --> 00:20:25,899
I will just say so it transforms into

300
00:20:21,009 --> 00:20:27,190
under my eyes I can add macros to that

301
00:20:25,899 --> 00:20:30,100
dock for Tonto

302
00:20:27,190 --> 00:20:33,159
therefore these people had created a

303
00:20:30,100 --> 00:20:38,678
macros which was taking the content of

304
00:20:33,159 --> 00:20:44,799
the document it executed you see that

305
00:20:38,679 --> 00:20:47,740
deal no four month at least HTML so and

306
00:20:44,799 --> 00:20:51,399
it opens it with Microsoft Explorer

307
00:20:47,740 --> 00:20:58,960
instead of Microsoft age due to backward

308
00:20:51,399 --> 00:21:03,209
compatibility I brought a video on I

309
00:20:58,960 --> 00:21:09,580
don't know if you will be able to see

310
00:21:03,210 --> 00:21:11,710
well it's a bit smoother it's DML you

311
00:21:09,580 --> 00:21:17,049
have a program that portal is the macro

312
00:21:11,710 --> 00:21:20,799
and was writing on the registry even if

313
00:21:17,049 --> 00:21:33,850
it was HTML in the end it was a document

314
00:21:20,799 --> 00:21:37,450
with the code in order to decode these

315
00:21:33,850 --> 00:21:39,919
was discovered you know that years

316
00:21:37,450 --> 00:21:46,040
malware

317
00:21:39,920 --> 00:21:47,720
teas velvet is the magical word in

318
00:21:46,040 --> 00:21:58,450
office I don't know if you're familiar

319
00:21:47,720 --> 00:22:03,200
with it I don't know if you know it was

320
00:21:58,450 --> 00:22:05,060
introduced by manufacturers of office so

321
00:22:03,200 --> 00:22:08,030
that if you created a document and

322
00:22:05,060 --> 00:22:11,000
protected it with that password it was

323
00:22:08,030 --> 00:22:16,160
like having no password it is embedded

324
00:22:11,000 --> 00:22:19,430
and it is like a joke password I don't

325
00:22:16,160 --> 00:22:23,570
know if you have ever protected with

326
00:22:19,430 --> 00:22:26,390
password an Excel you can do it here in

327
00:22:23,570 --> 00:22:29,330
your settings you click on options and

328
00:22:26,390 --> 00:22:35,000
you say I want the Reading Mode to be

329
00:22:29,330 --> 00:22:40,040
protected so I copy and paste the

330
00:22:35,000 --> 00:22:44,990
password velvet switch shop for the

331
00:22:40,040 --> 00:22:50,350
Reading Mode and I save the neck so when

332
00:22:44,990 --> 00:22:50,350
I open in the Excel document again

333
00:22:52,390 --> 00:23:01,960
without any problems

334
00:22:54,530 --> 00:23:01,960
if I save again with any other password

335
00:23:03,010 --> 00:23:12,710
maybe I can add a letter to this velvet

336
00:23:06,830 --> 00:23:18,080
shred shop okay so I'm opening the Excel

337
00:23:12,710 --> 00:23:21,050
again first you need to blow so now

338
00:23:18,080 --> 00:23:25,070
they're going to ask me Danny password

339
00:23:21,050 --> 00:23:34,250
so attackers have green have been using

340
00:23:25,070 --> 00:23:37,280
that password in order to hide usually

341
00:23:34,250 --> 00:23:43,070
use passwords but they are included in

342
00:23:37,280 --> 00:23:45,889
the email of the on the email so they

343
00:23:43,070 --> 00:23:48,860
send you a document and

344
00:23:45,890 --> 00:23:54,020
with the password on the email and

345
00:23:48,860 --> 00:23:56,540
that's the way they get to not to be

346
00:23:54,020 --> 00:23:58,940
detected by antivirals because the

347
00:23:56,540 --> 00:24:02,090
antivirus cannot open the document

348
00:23:58,940 --> 00:24:07,430
without that password this is another

349
00:24:02,090 --> 00:24:11,000
thing about Excel 4.0 which were XL m

350
00:24:07,430 --> 00:24:13,520
macros very old macros which are still

351
00:24:11,000 --> 00:24:17,300
compatible although I think they are

352
00:24:13,520 --> 00:24:24,050
only used by attackers it is easier to

353
00:24:17,300 --> 00:24:25,970
perform than it basically you need to

354
00:24:24,050 --> 00:24:33,430
type here whatever you want

355
00:24:25,970 --> 00:24:36,230
oh sorry JAMA and these calls the wait

356
00:24:33,430 --> 00:24:39,320
it's wonderful because you generally

357
00:24:36,230 --> 00:24:41,840
affect the date you create an object in

358
00:24:39,320 --> 00:24:45,320
memory you have the executable years and

359
00:24:41,840 --> 00:24:47,419
you type this part of the memory and you

360
00:24:45,320 --> 00:24:51,310
create the thread so it is already

361
00:24:47,420 --> 00:24:55,100
launched so when you open an executable

362
00:24:51,310 --> 00:24:59,540
when you're opening and Excel you are

363
00:24:55,100 --> 00:25:02,990
going this was quite simple so I was

364
00:24:59,540 --> 00:25:14,870
quite shocked shocked and I decided to

365
00:25:02,990 --> 00:25:24,020
try it with this format for the macro in

366
00:25:14,870 --> 00:25:27,340
this video I think you can see I was

367
00:25:24,020 --> 00:25:36,400
calling power shell which was calling

368
00:25:27,340 --> 00:25:36,399
URL and when I open simple Excel

369
00:25:37,510 --> 00:25:47,060
executed the power shell these was not

370
00:25:42,470 --> 00:25:49,320
detected by many antivirus it was

371
00:25:47,060 --> 00:26:00,418
executing code

372
00:25:49,320 --> 00:26:02,908
cuando you see the cold these these were

373
00:26:00,419 --> 00:26:05,789
techniques and now I'm going to talk

374
00:26:02,909 --> 00:26:20,009
about some curious attacks that caught

375
00:26:05,789 --> 00:26:24,179
my attention I had Micro Four for Open

376
00:26:20,009 --> 00:26:28,950
Office recently it was discovered that

377
00:26:24,179 --> 00:26:35,100
when you were disabling the mark

378
00:26:28,950 --> 00:26:38,340
it wasn't being disabled they cannot get

379
00:26:35,100 --> 00:26:41,959
rid of macros there is another curious

380
00:26:38,340 --> 00:26:45,809
technique that I discovered in my study

381
00:26:41,960 --> 00:26:53,370
which is to add many comments on the

382
00:26:45,809 --> 00:26:57,809
code such as this one make no sense

383
00:26:53,370 --> 00:27:01,918
others do make sense they are complete

384
00:26:57,809 --> 00:27:10,759
words which are there to get a victim's

385
00:27:01,919 --> 00:27:14,940
distracted they some of those codes had

386
00:27:10,759 --> 00:27:18,179
plenty of Microsoft URLs for example in

387
00:27:14,940 --> 00:27:26,490
order to get people distracted all the

388
00:27:18,179 --> 00:27:30,000
techniques is to use the the power

389
00:27:26,490 --> 00:27:32,129
creator in PowerShell through which you

390
00:27:30,000 --> 00:27:36,570
can create whatever you want and if you

391
00:27:32,129 --> 00:27:39,600
added to Metasploit in order to do an

392
00:27:36,570 --> 00:27:42,360
adequate payload it works quite fine if

393
00:27:39,600 --> 00:27:45,330
you just have to launch the exploit you

394
00:27:42,360 --> 00:27:49,379
invoke the macro and then you can do

395
00:27:45,330 --> 00:27:53,639
things like this without knowing of them

396
00:27:49,379 --> 00:27:56,250
you can do things like this for the

397
00:27:53,639 --> 00:27:58,918
kernel functions such as stealing

398
00:27:56,250 --> 00:28:04,590
passwords and so on

399
00:27:58,919 --> 00:28:10,240
everything is created in a simple way

400
00:28:04,590 --> 00:28:15,370
with many functionalities which one do

401
00:28:10,240 --> 00:28:18,480
evil for example occasions and all the

402
00:28:15,370 --> 00:28:22,090
formulas you have to launch code are

403
00:28:18,480 --> 00:28:25,809
considered in this attack because they

404
00:28:22,090 --> 00:28:30,100
distract antivirus and you can have

405
00:28:25,809 --> 00:28:33,190
macros where you add a huge piece of

406
00:28:30,100 --> 00:28:37,330
code which in the end is an executable

407
00:28:33,190 --> 00:28:40,140
but they need to be skated somehow and

408
00:28:37,330 --> 00:28:43,059
this was done through my framework

409
00:28:40,140 --> 00:28:49,240
another crazy thing that we discovered

410
00:28:43,059 --> 00:28:55,928
is that ribbons those deployable menus

411
00:28:49,240 --> 00:28:59,740
on a panel which have a square form they

412
00:28:55,929 --> 00:29:03,730
have hidden in those ribbons because you

413
00:28:59,740 --> 00:29:11,409
can create ribbons with macros and they

414
00:29:03,730 --> 00:29:16,120
have managed ribbon database enables you

415
00:29:11,409 --> 00:29:21,789
to update ribbon database thus creating

416
00:29:16,120 --> 00:29:25,809
a macro when you open it it the cool bug

417
00:29:21,789 --> 00:29:38,320
in the layout of the HTML of the macro

418
00:29:25,809 --> 00:29:44,070
and in the end if injected was not like

419
00:29:38,320 --> 00:29:44,070
a macro but like an update of the ribbon

420
00:29:45,539 --> 00:29:55,169
another thing is that they haven't tried

421
00:29:49,390 --> 00:29:59,440
to hide the code everywhere VBA has

422
00:29:55,169 --> 00:30:03,549
visual elements you can open a window

423
00:29:59,440 --> 00:30:07,510
with a point net you can create buttons

424
00:30:03,549 --> 00:30:10,120
you can create events one of the things

425
00:30:07,510 --> 00:30:11,600
they have done is to hide in the

426
00:30:10,120 --> 00:30:14,750
properties of

427
00:30:11,600 --> 00:30:21,730
the graphic elements not within the code

428
00:30:14,750 --> 00:30:21,730
itself they want to avoid in any way

429
00:30:23,230 --> 00:31:56,030
video I have because I was always I

430
00:31:02,179 --> 00:32:00,260
couldn't find it so it was hidden but it

431
00:31:56,030 --> 00:32:03,649
was obvious kated Mufasa you know and

432
00:32:00,260 --> 00:32:06,200
then this is another example in the

433
00:32:03,650 --> 00:32:12,919
video but I feel there is a similar

434
00:32:06,200 --> 00:32:16,720
example because I realized it was more

435
00:32:12,919 --> 00:32:16,720
common than it was thought

436
00:32:17,830 --> 00:32:33,879
go to the macros menu outer open which

437
00:32:23,529 --> 00:32:37,969
opens directly then I search I've turned

438
00:32:33,879 --> 00:32:50,299
here it is Jewish al an alternative

439
00:32:37,969 --> 00:32:57,049
replace replace of rocket for an A and I

440
00:32:50,299 --> 00:32:59,769
inserted for you know the to pass by all

441
00:32:57,049 --> 00:33:03,200
the alternatives and then I could see

442
00:32:59,769 --> 00:33:06,950
PowerShell but it was obfuscated because

443
00:33:03,200 --> 00:33:09,649
it is full of brackets and so on it is

444
00:33:06,950 --> 00:33:17,570
quite crazy but it is what attackers are

445
00:33:09,649 --> 00:33:20,268
using to in fact nowadays the examples

446
00:33:17,570 --> 00:33:26,178
caught my attention it was the only time

447
00:33:20,269 --> 00:33:30,349
I could see this kind of attack there

448
00:33:26,179 --> 00:33:34,159
was a macro hidden it was not a fiscal

449
00:33:30,349 --> 00:33:37,039
heed it was under camouflage as you

450
00:33:34,159 --> 00:33:42,070
understand you can as you can see you

451
00:33:37,039 --> 00:33:42,070
can barely understand what this code is

452
00:33:42,519 --> 00:33:56,029
did quite the opposite first of all some

453
00:33:48,950 --> 00:34:00,080
part of the property of graphic elements

454
00:33:56,029 --> 00:34:03,200
there was a code for an executable and

455
00:34:00,080 --> 00:34:07,399
then the code that process that

456
00:34:03,200 --> 00:34:12,500
executable was quite readable and it

457
00:34:07,399 --> 00:34:17,750
seemed real you have currency connected

458
00:34:12,500 --> 00:34:22,250
users constant problem it seemed

459
00:34:17,750 --> 00:34:25,418
completely real but when you debug it it

460
00:34:22,250 --> 00:34:29,449
was sending commands such as this one

461
00:34:25,418 --> 00:34:37,158
calling a shell in order to be executed

462
00:34:29,449 --> 00:34:46,520
so it was being hidden behind apparent

463
00:34:37,159 --> 00:34:52,119
real code from feet to centimeters but

464
00:34:46,520 --> 00:34:56,060
in the end behind that code the was a

465
00:34:52,119 --> 00:35:04,119
call for the execution in order to make

466
00:34:56,060 --> 00:35:07,310
the calls seem legitimate problems

467
00:35:04,119 --> 00:35:10,730
problems do it they were using the term

468
00:35:07,310 --> 00:35:13,130
dual on many occasions and this

469
00:35:10,730 --> 00:35:17,720
executable was going to be saved in the

470
00:35:13,130 --> 00:35:21,410
disk and was going to be there was even

471
00:35:17,720 --> 00:35:27,549
code written in Spanish and in the end

472
00:35:21,410 --> 00:35:31,310
that executable Wars executed I tried to

473
00:35:27,550 --> 00:35:36,650
find who the author of this has been

474
00:35:31,310 --> 00:35:41,029
this was my only my only clue to cover

475
00:35:36,650 --> 00:35:46,040
it and it is a Russian singer obviously

476
00:35:41,030 --> 00:35:48,680
I don't think this Russian singer was

477
00:35:46,040 --> 00:35:56,200
the author but it was included in the

478
00:35:48,680 --> 00:36:03,078
code I have several examples here I

479
00:35:56,200 --> 00:36:05,509
think I loaded it before okay it is not

480
00:36:03,079 --> 00:36:13,310
showing it can't I show it on the screen

481
00:36:05,510 --> 00:36:17,950
what I want okay I we had some macros in

482
00:36:13,310 --> 00:36:23,180
which the code can be in which the code

483
00:36:17,950 --> 00:36:27,859
tries to detect if it is in math then

484
00:36:23,180 --> 00:36:33,060
it's it launches Python but if it is in

485
00:36:27,859 --> 00:36:36,990
windows it launches pollution it is not

486
00:36:33,060 --> 00:36:48,810
common but it was also their objective

487
00:36:36,990 --> 00:36:57,270
their target so here it is what we did

488
00:36:48,810 --> 00:37:01,619
was to oh I can't see right now what we

489
00:36:57,270 --> 00:37:07,829
did was to create and macros oh sorry

490
00:37:01,619 --> 00:37:26,430
give me a second I lost the use I'm

491
00:37:07,829 --> 00:37:29,400
sorry we did some macros in order to see

492
00:37:26,430 --> 00:37:35,279
how easy it was for it not to be

493
00:37:29,400 --> 00:37:36,420
detected this macros is quite catches

494
00:37:35,280 --> 00:37:39,180
your attention

495
00:37:36,420 --> 00:37:41,880
Ede extracts all the information sent

496
00:37:39,180 --> 00:37:47,339
the money but this was not detected by

497
00:37:41,880 --> 00:37:50,490
antivirus is not a problem of anti

498
00:37:47,339 --> 00:38:02,339
viruses it is quite complex to be

499
00:37:50,490 --> 00:38:17,970
detected so we went far beyond and in

500
00:38:02,339 --> 00:38:22,109
one macro so I could send this through

501
00:38:17,970 --> 00:38:28,819
word and it said you are very wrong and

502
00:38:22,109 --> 00:38:31,650
this macro all these type database of

503
00:38:28,819 --> 00:38:34,589
conversation and the attacker could

504
00:38:31,650 --> 00:38:36,869
download that information and see all

505
00:38:34,589 --> 00:38:39,150
your conversations

506
00:38:36,869 --> 00:38:42,979
and the only thing that the victim did

507
00:38:39,150 --> 00:38:46,979
was to receive a document and open it

508
00:38:42,979 --> 00:38:50,629
that office document was created in just

509
00:38:46,979 --> 00:38:56,479
a few seconds and it was unnoticed by

510
00:38:50,630 --> 00:38:56,479
antiviruses because it seemed normal

511
00:38:57,390 --> 00:39:04,950
wasn't difficult at all one of the last

512
00:39:00,719 --> 00:39:08,390
ones is this macro it is not common but

513
00:39:04,950 --> 00:39:11,118
they have done it on several occasions

514
00:39:08,390 --> 00:39:15,479
this macro instead of downloading

515
00:39:11,119 --> 00:39:19,969
something malicious was to download a

516
00:39:15,479 --> 00:39:25,589
compiler in order to compile a program

517
00:39:19,969 --> 00:39:28,380
dot net in the system and this one was

518
00:39:25,589 --> 00:39:34,308
encrypted and the key to encrypt it was

519
00:39:28,380 --> 00:39:39,239
in a txt for a document in located in

520
00:39:34,309 --> 00:39:45,440
DNS it was the craziest things that I

521
00:39:39,239 --> 00:39:52,589
have seen and it was using words bug

522
00:39:45,440 --> 00:39:57,390
series so very common words in variables

523
00:39:52,589 --> 00:40:00,808
so that it had normal appearance one of

524
00:39:57,390 --> 00:40:04,680
the techniques which is quite used is

525
00:40:00,809 --> 00:40:06,749
the do as obfuscation it is quite

526
00:40:04,680 --> 00:40:09,359
fashionable right now it is something

527
00:40:06,749 --> 00:40:15,419
you could do in Windows you start

528
00:40:09,359 --> 00:40:21,420
injecting these little thing of the of

529
00:40:15,420 --> 00:40:24,690
the letter N and you are executing a

530
00:40:21,420 --> 00:40:29,700
PowerShell without writing coercion you

531
00:40:24,690 --> 00:40:32,309
take the PWD and then you're typing

532
00:40:29,700 --> 00:40:34,439
PowerShell without typing it because

533
00:40:32,309 --> 00:40:38,219
obviously that's going to be detected by

534
00:40:34,440 --> 00:40:43,430
antivirus so they write different words

535
00:40:38,219 --> 00:40:43,430
and which are cut into small pieces

536
00:40:43,440 --> 00:40:50,100
another interesting one also I have

537
00:40:46,990 --> 00:40:54,549
mentioned it earlier is that the

538
00:40:50,100 --> 00:40:58,150
compiled code is stored as the source

539
00:40:54,550 --> 00:41:01,630
code is installed as well this is quite

540
00:40:58,150 --> 00:41:06,640
good to analyze statically the macro by

541
00:41:01,630 --> 00:41:11,890
anti viruses so they do this in case you

542
00:41:06,640 --> 00:41:15,580
open this document in an office with non

543
00:41:11,890 --> 00:41:20,650
updated engine then they compile the

544
00:41:15,580 --> 00:41:26,830
source code and I execute macro but what

545
00:41:20,650 --> 00:41:29,440
happens if we just if we start typing

546
00:41:26,830 --> 00:41:32,620
anything in the source code like a lot

547
00:41:29,440 --> 00:41:37,500
of serials or once nothing happens if

548
00:41:32,620 --> 00:41:40,960
the version matches if the compiled code

549
00:41:37,500 --> 00:41:47,710
works in your office nothing will happen

550
00:41:40,960 --> 00:41:50,350
so attackers mmm invented W VP a

551
00:41:47,710 --> 00:41:55,510
stamping where they delete the source

552
00:41:50,350 --> 00:41:58,569
code embedded in the macro and they just

553
00:41:55,510 --> 00:42:02,350
used the Qin file code this is quite

554
00:41:58,570 --> 00:42:12,100
interesting and quite successful Here I

555
00:42:02,350 --> 00:42:13,870
am going to launch a document in these

556
00:42:12,100 --> 00:42:16,720
two we're going to see the macro of

557
00:42:13,870 --> 00:42:26,440
these documents you see there are five

558
00:42:16,720 --> 00:42:34,899
macros k with different keys if this

559
00:42:26,440 --> 00:42:37,450
same job human which is the macro source

560
00:42:34,900 --> 00:42:39,460
code has been deleted there will be

561
00:42:37,450 --> 00:42:42,850
another macro which is quite difficult

562
00:42:39,460 --> 00:42:46,150
to understand I stomped it with that if

563
00:42:42,850 --> 00:42:50,350
we look at the code in depth we will

564
00:42:46,150 --> 00:42:54,730
realize that will I have down is that

565
00:42:50,350 --> 00:42:56,240
where there were some key here you can

566
00:42:54,730 --> 00:42:59,210
read the

567
00:42:56,240 --> 00:43:04,848
source code and here it is destroyed

568
00:42:59,210 --> 00:43:08,569
with added so VBA stomping has become

569
00:43:04,849 --> 00:43:11,420
quite popular so much that my new tool

570
00:43:08,569 --> 00:43:14,329
every clipping has been developed I

571
00:43:11,420 --> 00:43:17,809
don't know if you remember creepy it

572
00:43:14,329 --> 00:43:21,230
looks like he is writing a letter and it

573
00:43:17,809 --> 00:43:25,160
says it looks like your man dog doesn't

574
00:43:21,230 --> 00:43:30,309
get bypassed AV do you want me to help

575
00:43:25,160 --> 00:43:34,940
you and this facilitates the V be a

576
00:43:30,309 --> 00:43:39,109
stomping action it destroys the source

577
00:43:34,940 --> 00:43:42,619
code and it uses the compiled code the

578
00:43:39,109 --> 00:43:45,558
template the makes a call so you can see

579
00:43:42,619 --> 00:43:49,880
the server so there is a whole story

580
00:43:45,559 --> 00:43:53,599
about it so that you can not you don't

581
00:43:49,880 --> 00:44:04,490
have to access the source code and the

582
00:43:53,599 --> 00:44:08,020
attacker in the end can execute like

583
00:44:04,490 --> 00:44:12,308
most of the markers are unique markers

584
00:44:08,020 --> 00:44:14,329
if you were wondering if they are reused

585
00:44:12,309 --> 00:44:18,670
and there are statistics regarding

586
00:44:14,329 --> 00:44:22,279
unicity most of them are unique only 20%

587
00:44:18,670 --> 00:44:25,400
25% are reduced why because there are

588
00:44:22,279 --> 00:44:29,500
many obfuscation so it is weird to find

589
00:44:25,400 --> 00:44:32,480
malicious macros which look the same

590
00:44:29,500 --> 00:44:37,250
also other common mark characteristics

591
00:44:32,480 --> 00:44:40,599
regarding malware is there the merging

592
00:44:37,250 --> 00:44:44,660
of 64 based change for example

593
00:44:40,599 --> 00:44:47,839
hexadecimal change and also this this is

594
00:44:44,660 --> 00:44:49,460
something interesting regarding the time

595
00:44:47,839 --> 00:44:51,529
between creation of the document and

596
00:44:49,460 --> 00:44:55,549
last modification which is less than one

597
00:44:51,529 --> 00:44:59,109
second as this is completely automatize

598
00:44:55,549 --> 00:44:59,109
these studies confirm

599
00:44:59,530 --> 00:45:12,350
what we already knew also regarding

600
00:45:04,910 --> 00:45:17,779
number of micro they're easily to but

601
00:45:12,350 --> 00:45:22,009
this is also related to two trends when

602
00:45:17,780 --> 00:45:24,860
this study was done only one micro was

603
00:45:22,010 --> 00:45:31,310
the most frequent valley and now

604
00:45:24,860 --> 00:45:34,490
regarding solutions how is it possible

605
00:45:31,310 --> 00:45:35,960
that we are facing the same problem that

606
00:45:34,490 --> 00:45:38,209
we've been facing the same problem for

607
00:45:35,960 --> 00:45:41,740
20 years and what can we do do to avoid

608
00:45:38,210 --> 00:45:43,790
it so here have five different

609
00:45:41,740 --> 00:45:45,500
mitigations or solutions I'm not going

610
00:45:43,790 --> 00:45:48,590
to explain this one because it is quite

611
00:45:45,500 --> 00:45:51,740
complex but there are different formulas

612
00:45:48,590 --> 00:45:53,930
and you know that to enable the

613
00:45:51,740 --> 00:45:57,049
PowerShell logs PowerShell and macros

614
00:45:53,930 --> 00:45:58,819
are very linked so having a good

615
00:45:57,050 --> 00:46:01,520
visibility of what's going on in the

616
00:45:58,820 --> 00:46:06,650
system PowerShell what's being executed

617
00:46:01,520 --> 00:46:09,860
allows you to to to learn about this

618
00:46:06,650 --> 00:46:13,240
regarding the extensions extension

619
00:46:09,860 --> 00:46:17,480
associations we have to pay attention

620
00:46:13,240 --> 00:46:20,600
sorry we don't have to trust the

621
00:46:17,480 --> 00:46:21,980
extension the part of being dok dok s

622
00:46:20,600 --> 00:46:26,210
there is a tool called

623
00:46:21,980 --> 00:46:31,490
make em easy that tells you if a

624
00:46:26,210 --> 00:46:32,840
document is HD ma that thinks is a dog

625
00:46:31,490 --> 00:46:35,839
that is faking

626
00:46:32,840 --> 00:46:38,390
or pretending to be a dog or if it is

627
00:46:35,840 --> 00:46:43,070
our dog am pretending to be a dog this

628
00:46:38,390 --> 00:46:47,870
can be analysed through this tool a two

629
00:46:43,070 --> 00:46:50,360
that are CH step program in regarding or

630
00:46:47,870 --> 00:46:54,500
using the magic number not the extension

631
00:46:50,360 --> 00:46:57,380
for example it's safer to open air RTF

632
00:46:54,500 --> 00:46:59,780
with word Python we with work because

633
00:46:57,380 --> 00:47:00,890
probably an RTF wants to exploit the

634
00:46:59,780 --> 00:47:03,400
vulnerabilities that we've mentioned

635
00:47:00,890 --> 00:47:03,400
before

636
00:47:04,989 --> 00:47:16,219
also we have to assess to check the use

637
00:47:09,140 --> 00:47:18,379
of IES are and trust in MCAS I if you

638
00:47:16,219 --> 00:47:20,089
are an ADIZ in micro speakers you won't

639
00:47:18,380 --> 00:47:23,150
probably use them you should enable

640
00:47:20,089 --> 00:47:24,859
disable them and how can we do that I

641
00:47:23,150 --> 00:47:27,439
mean if you have a network for example

642
00:47:24,859 --> 00:47:29,390
they seem the most simple thing to do is

643
00:47:27,439 --> 00:47:29,989
downloading these templates from this

644
00:47:29,390 --> 00:47:36,379
address

645
00:47:29,989 --> 00:47:38,390
hoping a DM X here and then you have the

646
00:47:36,380 --> 00:47:41,329
option that says blocking the execution

647
00:47:38,390 --> 00:47:44,959
of macros you click here you need all

648
00:47:41,329 --> 00:47:48,049
these and then the your system is not

649
00:47:44,959 --> 00:47:51,799
going to execute macros for example at

650
00:47:48,049 --> 00:47:57,380
the level of active directories it is

651
00:47:51,799 --> 00:47:59,509
quite useful how can we make our system

652
00:47:57,380 --> 00:48:04,759
not to open certain type of document

653
00:47:59,509 --> 00:48:07,309
such as 4.0 macros or similar extensions

654
00:48:04,759 --> 00:48:15,079
here in this configuration of Excel and

655
00:48:07,309 --> 00:48:21,920
Word file block in configuration you can

656
00:48:15,079 --> 00:48:23,179
see that you can lock all these prevent

657
00:48:21,920 --> 00:48:26,390
that these documents with these

658
00:48:23,179 --> 00:48:28,549
extensions are opened or it saved it is

659
00:48:26,390 --> 00:48:31,969
highly unlikely that someone tries to

660
00:48:28,549 --> 00:48:34,579
send you a dog that it is an XML or

661
00:48:31,969 --> 00:48:38,920
something like that all these documents

662
00:48:34,579 --> 00:48:42,049
that I've mentioned are formats that are

663
00:48:38,920 --> 00:48:45,339
not frequently sent so you can block

664
00:48:42,049 --> 00:48:52,249
them here and this is the same

665
00:48:45,339 --> 00:48:57,049
configuration Word document also 4.0

666
00:48:52,249 --> 00:49:00,578
documents I can be blocked here Windows

667
00:48:57,049 --> 00:49:05,390
10 to the rescue we understand is

668
00:49:00,579 --> 00:49:08,059
working on a SR these are like recipes

669
00:49:05,390 --> 00:49:10,879
for specific problems only Windows 10

670
00:49:08,059 --> 00:49:14,299
has these features and it is under

671
00:49:10,880 --> 00:49:17,250
development some recipes work better

672
00:49:14,299 --> 00:49:18,990
than others but there is several of them

673
00:49:17,250 --> 00:49:23,040
you're not going to be able to learn

674
00:49:18,990 --> 00:49:27,089
this by heart but you can try to get an

675
00:49:23,040 --> 00:49:30,120
over V so for macros they offer Windows

676
00:49:27,090 --> 00:49:33,570
10 offers to block all of its

677
00:49:30,120 --> 00:49:35,520
applications so that they don't create

678
00:49:33,570 --> 00:49:41,280
secondary processes you know that to

679
00:49:35,520 --> 00:49:43,230
block this type of malware I mean all my

680
00:49:41,280 --> 00:49:45,090
words create child processes but in

681
00:49:43,230 --> 00:49:49,200
order to avoid that you can do at least

682
00:49:45,090 --> 00:49:57,870
in PowerShell I mean this name is quite

683
00:49:49,200 --> 00:50:00,660
ugly right now but it is a rule attack

684
00:49:57,870 --> 00:50:03,240
reduction you click enable and office

685
00:50:00,660 --> 00:50:05,549
won't be able to open a child process

686
00:50:03,240 --> 00:50:09,569
simple after a start but it is not very

687
00:50:05,550 --> 00:50:16,400
well known it is not this is not similar

688
00:50:09,570 --> 00:50:19,680
to this one this is something different

689
00:50:16,400 --> 00:50:24,750
which is not allowing second hypothesis

690
00:50:19,680 --> 00:50:33,000
is this is going to block function such

691
00:50:24,750 --> 00:50:47,670
as shell CMD or calculator however this

692
00:50:33,000 --> 00:50:49,830
is not going to be able to rule with a

693
00:50:47,670 --> 00:50:55,260
different number which is called

694
00:50:49,830 --> 00:50:58,799
blocking API calls of win32 from off its

695
00:50:55,260 --> 00:51:01,290
macros we've seen the current authority

696
00:50:58,800 --> 00:51:04,860
thing that we cannot do that if we apply

697
00:51:01,290 --> 00:51:08,279
that you are going to be deleted many

698
00:51:04,860 --> 00:51:13,590
macros and these calls are not going to

699
00:51:08,280 --> 00:51:16,410
take place anymore if you do that if you

700
00:51:13,590 --> 00:51:18,960
enable these you are going to see that

701
00:51:16,410 --> 00:51:23,580
screen and you won't be able to open the

702
00:51:18,960 --> 00:51:26,960
file and the last one this is a rule

703
00:51:23,580 --> 00:51:32,210
which was recent recent

704
00:51:26,960 --> 00:51:35,359
if you you start you won't be able to

705
00:51:32,210 --> 00:51:39,050
call WMI rules so with these three rules

706
00:51:35,359 --> 00:51:42,348
you are going to delete all the basic

707
00:51:39,050 --> 00:51:46,010
functionalities of macros and they won't

708
00:51:42,349 --> 00:51:48,050
be able to execute to be executed this

709
00:51:46,010 --> 00:51:53,650
every sources won't be won't be

710
00:51:48,050 --> 00:51:58,130
available anymore this program is

711
00:51:53,650 --> 00:52:01,190
something that a little problem that

712
00:51:58,130 --> 00:52:05,089
someone did and that sometimes doesn't

713
00:52:01,190 --> 00:52:08,930
work but it is quite useful I'm

714
00:52:05,089 --> 00:52:11,990
launching the ASL a is our rules from

715
00:52:08,930 --> 00:52:16,430
here I can create an executive an

716
00:52:11,990 --> 00:52:20,990
executable program I'm going to learn

717
00:52:16,430 --> 00:52:24,589
that rule and with naval and here I will

718
00:52:20,990 --> 00:52:29,779
see that this is block I'm going to

719
00:52:24,589 --> 00:52:34,180
create another rule in order to see if I

720
00:52:29,780 --> 00:52:37,309
can have executable programs from office

721
00:52:34,180 --> 00:52:41,390
defender stop this okay so great this is

722
00:52:37,309 --> 00:52:46,220
working quite well you can test it if

723
00:52:41,390 --> 00:52:49,520
you want to also memory is being widely

724
00:52:46,220 --> 00:52:53,868
using attackers create memory with

725
00:52:49,520 --> 00:52:56,420
PowerShell and with binary so wouldn't

726
00:52:53,869 --> 00:52:59,299
it be wonderful to cut the malware in a

727
00:52:56,420 --> 00:53:04,190
memory antivirus cannot do that but it

728
00:52:59,299 --> 00:53:08,809
happens that Microsoft has created

729
00:53:04,190 --> 00:53:11,599
someone called MC which helps you scan

730
00:53:08,809 --> 00:53:13,220
the memory of PowerShell shell and it

731
00:53:11,599 --> 00:53:14,869
scan it through Windows Defender this is

732
00:53:13,220 --> 00:53:18,279
wonderful because it changes the whole

733
00:53:14,869 --> 00:53:23,960
antivirus paradigm that we already know

734
00:53:18,280 --> 00:53:26,420
and it is quite innovative only Windows

735
00:53:23,960 --> 00:53:30,220
10 offers that option it is called MC

736
00:53:26,420 --> 00:53:33,170
AMS I know it can only work for power

737
00:53:30,220 --> 00:53:37,430
powershell well recently it was also

738
00:53:33,170 --> 00:53:40,180
launched for office 365 everything done

739
00:53:37,430 --> 00:53:46,598
in the memory of office 365

740
00:53:40,180 --> 00:53:50,618
we'll also go through the memory both

741
00:53:46,599 --> 00:53:52,270
room Windows Defender sorry before

742
00:53:50,619 --> 00:53:55,270
touching the DS before reaching the disk

743
00:53:52,270 --> 00:54:01,059
and if you have this a.m. as I enabled

744
00:53:55,270 --> 00:54:03,849
you can also call me Mimi cuts with

745
00:54:01,059 --> 00:54:08,559
PowerShell before me cut it reaches the

746
00:54:03,849 --> 00:54:14,619
disk it's going to be cut only by doing

747
00:54:08,559 --> 00:54:17,859
the call here you can see that this

748
00:54:14,619 --> 00:54:21,069
happened before reaching the disk if you

749
00:54:17,859 --> 00:54:25,119
have the a mas I enabled and they are

750
00:54:21,069 --> 00:54:27,609
trying to extend it to other areas not

751
00:54:25,119 --> 00:54:30,910
just PowerShell so conclusions

752
00:54:27,609 --> 00:54:32,619
micros never left us we are back

753
00:54:30,910 --> 00:54:36,069
stronger than ever I don't know if they

754
00:54:32,619 --> 00:54:40,710
will stay because now office365 is going

755
00:54:36,069 --> 00:54:47,140
to be virtualized office is going to try

756
00:54:40,710 --> 00:54:49,420
to work on completely virtual process if

757
00:54:47,140 --> 00:54:54,000
they are able to do that with office

758
00:54:49,420 --> 00:54:54,000
then this problem won't exist anymore

759
00:54:54,599 --> 00:55:00,910
our compatibility is always a threat and

760
00:54:58,230 --> 00:55:02,680
we have more formulas to defend

761
00:55:00,910 --> 00:55:05,859
ourselves than the one that we think

762
00:55:02,680 --> 00:55:06,788
even though we don't know them so well

763
00:55:05,859 --> 00:55:08,920
thank you very much

764
00:55:06,789 --> 00:55:10,569
are there any questions well if you have

765
00:55:08,920 --> 00:55:15,430
any questions I would like to invite you

766
00:55:10,569 --> 00:55:17,319
to ask to talk to the speaker outside we

767
00:55:15,430 --> 00:55:19,629
are running a little bit short on time

768
00:55:17,319 --> 00:55:21,279
and we have to stick to the agenda today

769
00:55:19,630 --> 00:55:22,620
but thank you so much for your

770
00:55:21,279 --> 00:55:26,850
presentation

771
00:55:22,620 --> 00:55:29,980
[Music]

772
00:55:26,850 --> 00:55:29,980
[Applause]

