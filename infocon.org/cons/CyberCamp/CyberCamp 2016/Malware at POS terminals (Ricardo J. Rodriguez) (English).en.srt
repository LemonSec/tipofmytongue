1
00:00:00,110 --> 00:00:07,799
miyamura dias a todos good morning all

2
00:00:04,770 --> 00:00:11,428
of you those of you who don't know me my

3
00:00:07,799 --> 00:00:14,309
name is ricardo rodriguez i'm a PhD I

4
00:00:11,429 --> 00:00:19,320
have a PhD of the Theravada University

5
00:00:14,309 --> 00:00:21,810
and I do at research have many research

6
00:00:19,320 --> 00:00:27,210
lines amongst others and malware

7
00:00:21,810 --> 00:00:29,429
analysis today i will be sharing the

8
00:00:27,210 --> 00:00:32,308
following with you i will be telling you

9
00:00:29,429 --> 00:00:35,579
about a specific marwa the name of it is

10
00:00:32,308 --> 00:00:38,610
post run scrapping malwa it will steal

11
00:00:35,579 --> 00:00:41,550
credit cards from compromised computers

12
00:00:38,610 --> 00:00:44,519
this is quite related to rubens

13
00:00:41,550 --> 00:00:46,319
presentation I very much liked it like

14
00:00:44,520 --> 00:00:50,370
that when introduced a number of

15
00:00:46,320 --> 00:00:52,110
concepts so these would be the agenda

16
00:00:50,370 --> 00:00:54,870
for my presentation I will tell you

17
00:00:52,110 --> 00:00:57,559
about the problems what happens when we

18
00:00:54,870 --> 00:01:02,250
take our credit cards and we pay at a

19
00:00:57,559 --> 00:01:04,768
point of sale and also what I tell you

20
00:01:02,250 --> 00:01:07,409
how you can access a credit card

21
00:01:04,769 --> 00:01:16,020
information and what this mama is about

22
00:01:07,409 --> 00:01:19,200
I researched I analyzed these 22 of

23
00:01:16,020 --> 00:01:21,390
these malware families had tried to but

24
00:01:19,200 --> 00:01:23,430
I studied the characteristics of it the

25
00:01:21,390 --> 00:01:27,000
features of it and I classified them

26
00:01:23,430 --> 00:01:30,630
then we'll move on to a demo and said

27
00:01:27,000 --> 00:01:33,869
you about the tool demo of the tool we

28
00:01:30,630 --> 00:01:39,000
I'll show you a real example then bit of

29
00:01:33,869 --> 00:01:42,899
a related work and a few conclusions I'm

30
00:01:39,000 --> 00:01:45,140
sure that you know that there is an

31
00:01:42,899 --> 00:01:49,909
increasing number of data exfiltration

32
00:01:45,140 --> 00:01:53,520
so here we may be referring to email so

33
00:01:49,909 --> 00:01:59,700
accounts from different fora and then we

34
00:01:53,520 --> 00:02:04,439
also have data exfiltration with regards

35
00:01:59,700 --> 00:02:08,069
to payment and methods and means so this

36
00:02:04,439 --> 00:02:11,959
is a photograph or an overview of all

37
00:02:08,068 --> 00:02:15,290
these cases that are having on the FO

38
00:02:11,960 --> 00:02:18,410
some time now so I'm sure that you also

39
00:02:15,290 --> 00:02:21,350
know that nowadays credit cards that are

40
00:02:18,410 --> 00:02:23,960
widely used I don't know whether you

41
00:02:21,350 --> 00:02:28,790
know it or not but some countries are

42
00:02:23,960 --> 00:02:31,280
even considering eliminating cash so

43
00:02:28,790 --> 00:02:34,100
there is one country in the European

44
00:02:31,280 --> 00:02:39,340
Union demak more specifically who is

45
00:02:34,100 --> 00:02:42,740
trying to eliminate or not to use a cash

46
00:02:39,340 --> 00:02:48,160
Singapore is also thinking about that so

47
00:02:42,740 --> 00:02:51,640
we are at the time where it is more more

48
00:02:48,160 --> 00:02:55,310
common and frequent for instance to buy

49
00:02:51,640 --> 00:02:56,869
bread and pay with credit cards so

50
00:02:55,310 --> 00:02:59,750
therefore we also seeing an increasing

51
00:02:56,870 --> 00:03:02,780
number of attacks to financial entities

52
00:02:59,750 --> 00:03:04,910
banks in an attempt to steal this

53
00:03:02,780 --> 00:03:07,580
information which can be really juicy

54
00:03:04,910 --> 00:03:09,920
and why is that sell well in the black

55
00:03:07,580 --> 00:03:13,940
market information of a credit card it's

56
00:03:09,920 --> 00:03:18,640
an element which is when traded it is

57
00:03:13,940 --> 00:03:22,100
well paid so these are some data from

58
00:03:18,640 --> 00:03:25,730
report and here we can see the US credit

59
00:03:22,100 --> 00:03:29,140
card data the price of it may range

60
00:03:25,730 --> 00:03:32,470
between 1.5 dollars of five dollars

61
00:03:29,140 --> 00:03:35,510
fortunately if we buy a hundred cards

62
00:03:32,470 --> 00:03:40,520
give us a discount if we are talking

63
00:03:35,510 --> 00:03:43,489
about a you a credit card data these

64
00:03:40,520 --> 00:03:48,200
information he is more expensive in

65
00:03:43,490 --> 00:03:50,540
between five and eight dollars and if we

66
00:03:48,200 --> 00:03:52,820
have extra information about the user

67
00:03:50,540 --> 00:03:56,269
for instance I don't know social

68
00:03:52,820 --> 00:03:59,269
security number date of birth that is to

69
00:03:56,270 --> 00:04:03,110
say details that would help us complete

70
00:03:59,270 --> 00:04:05,390
the fake identity the price goes up so

71
00:04:03,110 --> 00:04:08,360
for instance if you have information I

72
00:04:05,390 --> 00:04:11,450
don't know one of those high range

73
00:04:08,360 --> 00:04:16,090
credit card such as platinum or gold d

74
00:04:11,450 --> 00:04:18,639
that credit card data also increases its

75
00:04:16,089 --> 00:04:21,248
price

76
00:04:18,639 --> 00:04:28,210
so minimum data needed to complete the

77
00:04:21,249 --> 00:04:31,120
payment cut her name expiry date and the

78
00:04:28,210 --> 00:04:39,549
PA n that is to say the credit card

79
00:04:31,120 --> 00:04:43,120
number some places on the internet these

80
00:04:39,550 --> 00:04:46,840
two those three elements have enough to

81
00:04:43,120 --> 00:04:49,389
pay soon for your passes well you may go

82
00:04:46,840 --> 00:04:52,960
and tell me that there is a fourth piece

83
00:04:49,389 --> 00:04:55,740
of information to use or to pay with

84
00:04:52,960 --> 00:04:58,599
your credit cards that is the cvv

85
00:04:55,740 --> 00:05:01,680
however there are other companies

86
00:04:58,599 --> 00:05:05,469
especially US company where those three

87
00:05:01,680 --> 00:05:07,779
pieces of information is enough to go

88
00:05:05,469 --> 00:05:09,939
ahead with your credit card payments so

89
00:05:07,779 --> 00:05:14,349
now we should wonder what are these data

90
00:05:09,939 --> 00:05:18,370
coming from these data are what these

91
00:05:14,349 --> 00:05:21,400
devices are more infected I'm sure that

92
00:05:18,370 --> 00:05:24,159
you've seen a computer computer with a

93
00:05:21,400 --> 00:05:27,508
card reader either embedded on the

94
00:05:24,159 --> 00:05:31,089
screen or just as an external device

95
00:05:27,509 --> 00:05:33,189
that is used to introduce the car and to

96
00:05:31,089 --> 00:05:36,460
enter your PIN number this is the

97
00:05:33,189 --> 00:05:40,930
information from 2014 report when it

98
00:05:36,460 --> 00:05:43,149
says that thirty-six percent of publicly

99
00:05:40,930 --> 00:05:44,919
known cyber attacks when they say

100
00:05:43,149 --> 00:05:47,490
publicly known it means that they are

101
00:05:44,919 --> 00:05:51,159
known thirty-six percent of them are

102
00:05:47,490 --> 00:05:53,889
based on or related to stolen credit

103
00:05:51,159 --> 00:05:57,149
cards customer data often most of them

104
00:05:53,889 --> 00:05:59,860
take place at retailers or in larger

105
00:05:57,149 --> 00:06:02,680
restaurants change and change of

106
00:05:59,860 --> 00:06:07,029
restaurants and there is a reason for

107
00:06:02,680 --> 00:06:13,529
all that that being that most of these

108
00:06:07,029 --> 00:06:13,529
systems are running our run on Windows

109
00:06:13,740 --> 00:06:17,939
any version of Windows

110
00:06:18,030 --> 00:06:24,580
but it's happening here we are seeing a

111
00:06:22,569 --> 00:06:26,860
change in the type of attacks that are

112
00:06:24,580 --> 00:06:31,389
coverage out against a system in the

113
00:06:26,860 --> 00:06:33,430
past we could see terminals and terminus

114
00:06:31,389 --> 00:06:36,969
critical seminoles that often were

115
00:06:33,430 --> 00:06:40,840
compromised I have a credit card reader

116
00:06:36,969 --> 00:06:42,639
and then you could modify some elements

117
00:06:40,840 --> 00:06:45,128
in set some elements so that by the time

118
00:06:42,639 --> 00:06:47,259
the user introduces the credit card you

119
00:06:45,129 --> 00:06:49,449
can read that credit card details and

120
00:06:47,259 --> 00:06:51,639
transfer that information somewhere else

121
00:06:49,449 --> 00:06:57,069
but let us say that that how were

122
00:06:51,639 --> 00:06:59,379
tampering and is shifted to doing

123
00:06:57,069 --> 00:07:01,810
something which is more common nowadays

124
00:06:59,379 --> 00:07:03,969
that is to say network is sniffing if

125
00:07:01,810 --> 00:07:05,710
you know that credit card information is

126
00:07:03,969 --> 00:07:09,340
going through that Network you just go

127
00:07:05,710 --> 00:07:12,729
there you sniff that just leave that

128
00:07:09,340 --> 00:07:15,669
Network and then you find values values

129
00:07:12,729 --> 00:07:18,818
associated with a credit card with the

130
00:07:15,669 --> 00:07:23,740
credit card the best well-known case

131
00:07:18,819 --> 00:07:28,479
took place in 2008 the company attacked

132
00:07:23,740 --> 00:07:33,300
was a US company and group of hacker has

133
00:07:28,479 --> 00:07:37,810
led by albert gonzalez living in miami

134
00:07:33,300 --> 00:07:39,789
well found well they could see that the

135
00:07:37,810 --> 00:07:42,520
restaurant was using a Wi-Fi network

136
00:07:39,789 --> 00:07:45,300
with a web protection i'm sure that you

137
00:07:42,520 --> 00:07:48,400
know the web Wi-Fi protection that

138
00:07:45,300 --> 00:07:51,310
protection is highly vulnerable so these

139
00:07:48,400 --> 00:07:53,409
group of people become compromised the

140
00:07:51,310 --> 00:07:55,750
network from the restaurant then they

141
00:07:53,409 --> 00:07:57,909
access to extended service of the

142
00:07:55,750 --> 00:07:59,800
company some what they found in the

143
00:07:57,909 --> 00:08:03,938
external service of the company the

144
00:07:59,800 --> 00:08:06,939
company was the long list of Gorilla

145
00:08:03,939 --> 00:08:09,520
Glass customer data what did they do

146
00:08:06,939 --> 00:08:12,900
once they found those data they

147
00:08:09,520 --> 00:08:16,589
exfiltrate data and then sold it

148
00:08:12,900 --> 00:08:20,679
therefore it is estimated that they sold

149
00:08:16,589 --> 00:08:24,400
40 million 14 million credit card

150
00:08:20,680 --> 00:08:26,620
customer data so if we were to multiply

151
00:08:24,400 --> 00:08:30,219
that by the one point five dollars that

152
00:08:26,620 --> 00:08:31,639
we mentioned before you figure how much

153
00:08:30,219 --> 00:08:35,019
money they made out

154
00:08:31,639 --> 00:08:37,849
it Albert Kahn solid was found guilty

155
00:08:35,019 --> 00:08:44,179
for these felonies and has been

156
00:08:37,849 --> 00:08:47,149
sentenced to 20 years in prison so we

157
00:08:44,179 --> 00:08:51,739
have shifted from having from doing

158
00:08:47,149 --> 00:08:55,640
scheming terminals to now having a

159
00:08:51,740 --> 00:08:58,640
specific malwa known as post lamp

160
00:08:55,640 --> 00:09:02,630
scrapping because the main objective is

161
00:08:58,640 --> 00:09:08,600
scrap strapping scrapping the memory

162
00:09:02,630 --> 00:09:13,010
scraping the memory which is a terminal

163
00:09:08,600 --> 00:09:15,649
or a device that is located in the point

164
00:09:13,010 --> 00:09:19,130
of sale the objective is to find

165
00:09:15,649 --> 00:09:22,160
patterns that much credit cards and once

166
00:09:19,130 --> 00:09:24,980
they those patterns are found data is

167
00:09:22,160 --> 00:09:28,490
expert rated as I said before this type

168
00:09:24,980 --> 00:09:32,120
of threat this type of malware is the

169
00:09:28,490 --> 00:09:35,300
greatest threat that these terminals are

170
00:09:32,120 --> 00:09:37,910
facing nowadays we shifted from network

171
00:09:35,300 --> 00:09:41,300
is nipping and now we are facing these

172
00:09:37,910 --> 00:09:44,230
specific scraping man well what is a

173
00:09:41,300 --> 00:09:48,560
little bit more about this in 2013

174
00:09:44,230 --> 00:09:51,470
target target in the u.s. is kind of a

175
00:09:48,560 --> 00:09:54,560
cover for large hypermarket a

176
00:09:51,470 --> 00:09:58,310
hypermarket it was compromised by this

177
00:09:54,560 --> 00:10:01,790
type of malware it was a belong to the

178
00:09:58,310 --> 00:10:05,779
family of the black paws it is said it

179
00:10:01,790 --> 00:10:08,630
is estimated that 14 million his records

180
00:10:05,779 --> 00:10:12,860
of customers were stolen in three weeks

181
00:10:08,630 --> 00:10:16,630
then in 2014 home depot's which is with

182
00:10:12,860 --> 00:10:20,540
similar company to dodge it was

183
00:10:16,630 --> 00:10:26,240
compromised by a variance of prior post

184
00:10:20,540 --> 00:10:28,610
assembles the framework pause so they

185
00:10:26,240 --> 00:10:31,040
said that the attack lasted for five

186
00:10:28,610 --> 00:10:33,820
months we just don't know as a result of

187
00:10:31,040 --> 00:10:39,050
the attack they installed 56 million

188
00:10:33,820 --> 00:10:41,540
records so this study will tell us how

189
00:10:39,050 --> 00:10:44,630
has been the evolution of this type of

190
00:10:41,540 --> 00:10:48,980
malwa what is functionality like

191
00:10:44,630 --> 00:10:52,310
how they persist and equipment so how do

192
00:10:48,980 --> 00:10:56,840
they manage to remain in the machine

193
00:10:52,310 --> 00:11:01,400
even if I restarted how do they process

194
00:10:56,840 --> 00:11:04,850
such data and how the data is

195
00:11:01,400 --> 00:11:07,069
exfiltrated first of all which is not

196
00:11:04,850 --> 00:11:10,490
forget we should know what happens with

197
00:11:07,070 --> 00:11:13,310
the our credit class information when I

198
00:11:10,490 --> 00:11:15,770
pay when I pay when I have my credit

199
00:11:13,310 --> 00:11:19,310
cards I pay at the point of sale and

200
00:11:15,770 --> 00:11:25,329
then the information the credit card

201
00:11:19,310 --> 00:11:31,459
data goes to the issuing bank of my card

202
00:11:25,330 --> 00:11:35,540
or the bank to which the POS terminal is

203
00:11:31,460 --> 00:11:39,410
connected to that van bank will

204
00:11:35,540 --> 00:11:43,880
communicate with the owner of my card

205
00:11:39,410 --> 00:11:47,569
but it is Amex Visa or MasterCard and

206
00:11:43,880 --> 00:11:51,860
these companies will check with check on

207
00:11:47,570 --> 00:11:55,550
the last bank that is to say my credit

208
00:11:51,860 --> 00:11:57,440
cards and my account my bank accounts

209
00:11:55,550 --> 00:12:02,479
they will check whether there is enough

210
00:11:57,440 --> 00:12:04,400
money on my bank account to go ahead

211
00:12:02,480 --> 00:12:06,860
with the payments especially if we are

212
00:12:04,400 --> 00:12:10,430
talking about a debit credit card and

213
00:12:06,860 --> 00:12:13,040
then that confirmation of okay or denied

214
00:12:10,430 --> 00:12:16,099
intersection comes through here so

215
00:12:13,040 --> 00:12:18,800
therefore well do we have the credit

216
00:12:16,100 --> 00:12:21,890
card data but the credit card data will

217
00:12:18,800 --> 00:12:25,160
be in four places in fornication first

218
00:12:21,890 --> 00:12:28,699
of all it will be in the memory of the

219
00:12:25,160 --> 00:12:31,459
equipment it may be temporarily stored

220
00:12:28,700 --> 00:12:35,920
in any device so for instance at

221
00:12:31,460 --> 00:12:35,920
motorways motorways

222
00:12:37,959 --> 00:12:45,199
didn't happen to you Prince is going to

223
00:12:41,660 --> 00:12:50,510
go somewhere then you had a motorway to

224
00:12:45,199 --> 00:12:53,959
swipe your credit card and then you you

225
00:12:50,510 --> 00:12:57,740
are not charged clear time the payment

226
00:12:53,959 --> 00:12:59,479
doesn't take place real time as Robin

227
00:12:57,740 --> 00:13:03,170
mentioned in the case of aircraft

228
00:12:59,480 --> 00:13:06,350
because there is lots of traffic they

229
00:13:03,170 --> 00:13:09,920
want to speed it up what they do is to

230
00:13:06,350 --> 00:13:13,570
its store the information of all the

231
00:13:09,920 --> 00:13:17,810
cars that I've gone through the tall and

232
00:13:13,570 --> 00:13:20,660
then they just get all those data on

233
00:13:17,810 --> 00:13:23,810
specific day and they transfer the data

234
00:13:20,660 --> 00:13:26,810
to the bank et all those data or

235
00:13:23,810 --> 00:13:30,199
together there are those who say that

236
00:13:26,810 --> 00:13:34,219
for instance if your car kritika is

237
00:13:30,199 --> 00:13:37,339
cancelled and nod hahas it's not expired

238
00:13:34,220 --> 00:13:42,920
they said that day you could travel you

239
00:13:37,339 --> 00:13:46,670
could travel on the motorways so I just

240
00:13:42,920 --> 00:13:49,160
want to believe that the information of

241
00:13:46,670 --> 00:13:53,660
my credit card when I go through that

242
00:13:49,160 --> 00:13:57,529
all is stores in an encrypted manner and

243
00:13:53,660 --> 00:14:00,199
in that place which is not easy to

244
00:13:57,529 --> 00:14:04,250
access so it's not accessible to attack

245
00:14:00,199 --> 00:14:07,849
us then my do my credit card data is

246
00:14:04,250 --> 00:14:12,459
also in transit but fortunately we have

247
00:14:07,850 --> 00:14:19,930
a payment standard payment card

248
00:14:12,459 --> 00:14:23,018
industrial and that standard forces each

249
00:14:19,930 --> 00:14:26,089
party's to use encrypted information

250
00:14:23,019 --> 00:14:31,389
therefore even if my credit card data is

251
00:14:26,089 --> 00:14:37,810
in transit it cannot be compromised and

252
00:14:31,389 --> 00:14:41,990
then also does credit card data will be

253
00:14:37,810 --> 00:14:44,800
present also in the actual application

254
00:14:41,990 --> 00:14:48,860
the application running into the

255
00:14:44,800 --> 00:14:50,810
point-of-sale systems so these are

256
00:14:48,860 --> 00:14:53,000
places so this

257
00:14:50,810 --> 00:14:56,989
different locations where my credit card

258
00:14:53,000 --> 00:14:59,180
data could be compromised just let me

259
00:14:56,990 --> 00:15:01,100
tell you that the man well that we will

260
00:14:59,180 --> 00:15:03,859
be seen today we try to access

261
00:15:01,100 --> 00:15:07,520
information right on these points you

262
00:15:03,860 --> 00:15:09,860
will not mind accessing or get into

263
00:15:07,520 --> 00:15:18,650
information in this other three place

264
00:15:09,860 --> 00:15:23,150
location other 33 other locations so we

265
00:15:18,650 --> 00:15:28,640
have to stand out as I say PC I payment

266
00:15:23,150 --> 00:15:33,670
card industry data standard well there

267
00:15:28,640 --> 00:15:36,830
are two sub standards the PCI DSS it

268
00:15:33,670 --> 00:15:39,349
defines or it tells us how to protect

269
00:15:36,830 --> 00:15:41,810
the information in transit data in

270
00:15:39,350 --> 00:15:46,010
transit then we also have an elevation

271
00:15:41,810 --> 00:15:48,260
they pa-dss that sells us these software

272
00:15:46,010 --> 00:15:51,410
requirements that your system should

273
00:15:48,260 --> 00:15:54,529
fulfill to comply with the prior

274
00:15:51,410 --> 00:15:57,319
standard however none of the system

275
00:15:54,529 --> 00:15:59,960
takes care how about what happens with

276
00:15:57,320 --> 00:16:04,540
data in memory that's one of the main

277
00:15:59,960 --> 00:16:08,570
problems of these standards and the

278
00:16:04,540 --> 00:16:12,349
credit card data is in memory it's a

279
00:16:08,570 --> 00:16:17,680
memory and that data is in clear so

280
00:16:12,350 --> 00:16:17,680
therefore how to access credit card data

281
00:16:18,010 --> 00:16:27,080
well you know that the first the way to

282
00:16:22,160 --> 00:16:33,550
do it is to have the physical credit

283
00:16:27,080 --> 00:16:38,120
card so physical data on the card name

284
00:16:33,550 --> 00:16:42,709
expiration date in American formats us

285
00:16:38,120 --> 00:16:46,160
format and then be a n primary account

286
00:16:42,709 --> 00:16:50,119
number which is a credit card number

287
00:16:46,160 --> 00:16:52,759
and then the cvv afternoon ranges from

288
00:16:50,120 --> 00:16:55,009
three to four digits the annuities on

289
00:16:52,759 --> 00:16:58,370
the back and he shows on the back of the

290
00:16:55,009 --> 00:17:05,329
card why do buddy sit on the back panel

291
00:16:58,370 --> 00:17:11,569
of the guard who has that answer but

292
00:17:05,329 --> 00:17:13,668
basically cvd is what sales that you

293
00:17:11,569 --> 00:17:16,369
have physical access to the credit card

294
00:17:13,669 --> 00:17:20,990
if you take the credit cards and unless

295
00:17:16,369 --> 00:17:22,879
you look at the back panel well this

296
00:17:20,990 --> 00:17:25,039
means that means that you are having

297
00:17:22,880 --> 00:17:28,610
physical access to the card because you

298
00:17:25,039 --> 00:17:31,400
can take a look at the back panel then

299
00:17:28,610 --> 00:17:36,289
other way to access to credit card data

300
00:17:31,400 --> 00:17:43,789
is through the magnetic strip stripe

301
00:17:36,289 --> 00:17:47,240
magnetic stripe there is an interesting

302
00:17:43,789 --> 00:17:49,400
video made by Sammy Sammy was in cyber

303
00:17:47,240 --> 00:17:51,740
camp last year he did they used to put

304
00:17:49,400 --> 00:17:54,470
some as they don't add a stripe and they

305
00:17:51,740 --> 00:17:57,140
could get access to that information to

306
00:17:54,470 --> 00:18:00,020
that data so I'd like you to know that

307
00:17:57,140 --> 00:18:01,880
there are three stripes okay or these

308
00:18:00,020 --> 00:18:05,150
magnetic stripe is divided in three

309
00:18:01,880 --> 00:18:07,850
bands each of these bands come with the

310
00:18:05,150 --> 00:18:10,450
different formats so out of those three

311
00:18:07,850 --> 00:18:14,780
bands only number one and two are just

312
00:18:10,450 --> 00:18:19,700
bent number three was intended to be

313
00:18:14,780 --> 00:18:21,918
used by some banks but in the end it's

314
00:18:19,700 --> 00:18:24,740
useless has not been made under standard

315
00:18:21,919 --> 00:18:28,730
only track band and track two are used

316
00:18:24,740 --> 00:18:32,600
for information for you to know princess

317
00:18:28,730 --> 00:18:35,990
if you have tragic bank account with

318
00:18:32,600 --> 00:18:39,949
either kaha in track three you will see

319
00:18:35,990 --> 00:18:46,280
that you have your bank account number

320
00:18:39,950 --> 00:18:50,450
so track one track to these are the ones

321
00:18:46,280 --> 00:18:53,418
we are interested in coming the specific

322
00:18:50,450 --> 00:18:55,460
formats i'm not going to explain each of

323
00:18:53,419 --> 00:18:58,080
them so not just so i can look at that

324
00:18:55,460 --> 00:19:00,899
here we see the credit card

325
00:18:58,080 --> 00:19:04,470
see but the bank account number and then

326
00:19:00,899 --> 00:19:08,039
in track 2 we have the username and then

327
00:19:04,470 --> 00:19:11,789
we also have the expiry date so there

328
00:19:08,039 --> 00:19:14,010
were four decide the three minimum

329
00:19:11,789 --> 00:19:18,860
elements that are needed to make a

330
00:19:14,010 --> 00:19:22,559
payment so when you swipe the stripe

331
00:19:18,860 --> 00:19:25,379
does well well they get but this minimum

332
00:19:22,559 --> 00:19:29,639
information is already given to the

333
00:19:25,380 --> 00:19:31,830
terminal not way to access to credit

334
00:19:29,640 --> 00:19:34,649
card data I'm sure that you're aware of

335
00:19:31,830 --> 00:19:38,250
these cars cheap cards they are also

336
00:19:34,649 --> 00:19:41,399
referred to as chip and pin or e MV cars

337
00:19:38,250 --> 00:19:44,010
they are widespread in Europe we use

338
00:19:41,399 --> 00:19:46,860
them very very frequently when you pay

339
00:19:44,010 --> 00:19:48,658
with your credit cards to introduce it

340
00:19:46,860 --> 00:19:51,860
in the terminal then you have to enter

341
00:19:48,659 --> 00:19:55,710
your PIN number and that pin number

342
00:19:51,860 --> 00:19:58,080
authorizes alpha resists uniquely each

343
00:19:55,710 --> 00:20:00,899
of these transactions uniquely

344
00:19:58,080 --> 00:20:02,189
authorizes each transaction some people

345
00:20:00,899 --> 00:20:04,799
are doing research on that and they have

346
00:20:02,190 --> 00:20:08,700
proven that this is not true well the

347
00:20:04,799 --> 00:20:12,059
latest fashions have a env has improved

348
00:20:08,700 --> 00:20:14,340
that vulnerability but it isn't it

349
00:20:12,059 --> 00:20:18,240
wasn't like that in the beginning so

350
00:20:14,340 --> 00:20:21,230
basically e MV tries its intended i

351
00:20:18,240 --> 00:20:25,649
authenticate the card as well as

352
00:20:21,230 --> 00:20:29,610
authenticated the folder but in the case

353
00:20:25,649 --> 00:20:33,059
of EMV no one authenticates the POS

354
00:20:29,610 --> 00:20:37,379
terminal so you may be certain your cart

355
00:20:33,059 --> 00:20:41,700
in terminal in a convenience store we

356
00:20:37,380 --> 00:20:43,529
don't know who who is behind that

357
00:20:41,700 --> 00:20:46,529
terminal we trust that there is a

358
00:20:43,529 --> 00:20:52,649
sticker with the name of the bank but

359
00:20:46,529 --> 00:20:56,190
there is no terminal authentication here

360
00:20:52,649 --> 00:21:04,070
I'm saying that e lv standard was

361
00:20:56,190 --> 00:21:04,070
created to fight counterfeiting

362
00:21:04,720 --> 00:21:14,120
and now contactless cards and physicals

363
00:21:09,860 --> 00:21:16,429
this is another way of getting credit

364
00:21:14,120 --> 00:21:19,699
card data we talked about this type of

365
00:21:16,430 --> 00:21:23,030
God at last year the previous year two

366
00:21:19,700 --> 00:21:26,090
years ago so and I've seen it it's just

367
00:21:23,030 --> 00:21:27,649
like one more door so I make a message

368
00:21:26,090 --> 00:21:31,010
to the credit card either through the

369
00:21:27,650 --> 00:21:35,020
cheap-o through the FEC but actually I

370
00:21:31,010 --> 00:21:38,629
data I just get it from the chip the and

371
00:21:35,020 --> 00:21:42,230
FC it's just one more door to access to

372
00:21:38,630 --> 00:21:46,580
credit card data do you know that there

373
00:21:42,230 --> 00:21:52,930
is a limit as to the number of students

374
00:21:46,580 --> 00:21:57,699
that you can pay with an MP NFC card and

375
00:21:52,930 --> 00:22:00,320
that amount in Spain is up to 20 euros

376
00:21:57,700 --> 00:22:05,840
but you already know everyone knows that

377
00:22:00,320 --> 00:22:08,689
have you see NFC cards I have a lot but

378
00:22:05,840 --> 00:22:11,810
a lot of problems so far I know they

379
00:22:08,690 --> 00:22:13,970
doesn't want to talk about malware well

380
00:22:11,810 --> 00:22:17,240
these are the typical faces of mother

381
00:22:13,970 --> 00:22:21,740
that having adapted to this type of a

382
00:22:17,240 --> 00:22:24,140
specific malware so this Marvel is first

383
00:22:21,740 --> 00:22:27,700
of all access to the system once it is

384
00:22:24,140 --> 00:22:31,670
in the system it becomes persistent and

385
00:22:27,700 --> 00:22:33,470
it will search both for processes it

386
00:22:31,670 --> 00:22:36,740
does that in the first instance funny

387
00:22:33,470 --> 00:22:39,890
the texts system or process that is

388
00:22:36,740 --> 00:22:42,350
interested in he will scan the memory it

389
00:22:39,890 --> 00:22:45,470
will gather information once it gather

390
00:22:42,350 --> 00:22:49,730
data card data what does it do it just

391
00:22:45,470 --> 00:22:53,540
exfiltrate those data very quickly I'll

392
00:22:49,730 --> 00:22:55,700
tell you each and every one of the

393
00:22:53,540 --> 00:23:00,080
features of this man well in the case of

394
00:22:55,700 --> 00:23:01,970
binary the malware executable can be

395
00:23:00,080 --> 00:23:04,790
protected or not if protect local have

396
00:23:01,970 --> 00:23:06,560
several levels of protection then in

397
00:23:04,790 --> 00:23:10,490
kinds of persistence in terms of

398
00:23:06,560 --> 00:23:13,580
persistence how it persists based on

399
00:23:10,490 --> 00:23:16,760
register based on the service or perhaps

400
00:23:13,580 --> 00:23:19,520
it is not persistent if a marble is not

401
00:23:16,760 --> 00:23:22,129
it means that it is the second phase of

402
00:23:19,520 --> 00:23:24,080
attack of the third man where that is to

403
00:23:22,130 --> 00:23:26,390
say someone will have to run it see if

404
00:23:24,080 --> 00:23:28,850
it is not persistent it with not Severn

405
00:23:26,390 --> 00:23:32,420
work I don't know perhaps the user will

406
00:23:28,850 --> 00:23:36,679
do that regarding functionality so we

407
00:23:32,420 --> 00:23:39,110
can perhaps it would only steal credit

408
00:23:36,680 --> 00:23:40,580
card data or perhaps it will do

409
00:23:39,110 --> 00:23:42,439
something else perhaps you would have

410
00:23:40,580 --> 00:23:46,370
engage in any other type of

411
00:23:42,440 --> 00:23:48,860
communication so regarding processes we

412
00:23:46,370 --> 00:23:51,830
can distinguish clear whether it does a

413
00:23:48,860 --> 00:23:54,530
selective search or not in the selective

414
00:23:51,830 --> 00:23:57,679
one we could see whether it does

415
00:23:54,530 --> 00:24:00,290
blacklisting or what listing so that is

416
00:23:57,680 --> 00:24:03,920
to say whether there is only one type of

417
00:24:00,290 --> 00:24:08,360
processes that is scanned by this man

418
00:24:03,920 --> 00:24:10,370
well if this were the case this would be

419
00:24:08,360 --> 00:24:12,110
kind of an apt that is to say because

420
00:24:10,370 --> 00:24:14,360
it's not the process that it wants to

421
00:24:12,110 --> 00:24:18,229
scan that is to say the systems that

422
00:24:14,360 --> 00:24:24,709
wants to attack in terms of process

423
00:24:18,230 --> 00:24:27,560
search here we could have two things

424
00:24:24,710 --> 00:24:29,690
here either own implementation or system

425
00:24:27,560 --> 00:24:32,149
implementation for a non implementation

426
00:24:29,690 --> 00:24:35,510
in Windows we will need to have a root

427
00:24:32,150 --> 00:24:37,610
kids but it disease yes it would be

428
00:24:35,510 --> 00:24:39,980
technically feasible if we had that

429
00:24:37,610 --> 00:24:42,439
rootkit so what information does it look

430
00:24:39,980 --> 00:24:46,460
for it looks for even from a data on

431
00:24:42,440 --> 00:24:48,590
track one track two or both how do they

432
00:24:46,460 --> 00:24:50,330
match that information we could have

433
00:24:48,590 --> 00:24:53,120
regular expression or specific

434
00:24:50,330 --> 00:24:55,270
algorithms house data sheet great seats

435
00:24:53,120 --> 00:25:00,889
well there are several methods for that

436
00:24:55,270 --> 00:25:03,980
some wait for up until a USB is

437
00:25:00,890 --> 00:25:07,450
connected to the machine once that

438
00:25:03,980 --> 00:25:13,100
happens he will take all the credit card

439
00:25:07,450 --> 00:25:17,930
data and then storage in that USB so

440
00:25:13,100 --> 00:25:20,959
that means that samples assume that

441
00:25:17,930 --> 00:25:24,179
there will be someone

442
00:25:20,960 --> 00:25:28,910
gaining eventually gaining physical

443
00:25:24,179 --> 00:25:33,050
access to that machine and then also

444
00:25:28,910 --> 00:25:39,440
internet-based X filtration through HTTP

445
00:25:33,050 --> 00:25:43,559
queries or through DNS queries regarding

446
00:25:39,440 --> 00:25:47,059
connection how data is accelerated here

447
00:25:43,559 --> 00:25:49,649
we could see whether the connection is

448
00:25:47,059 --> 00:25:53,100
ordinary an ordinary one whether love

449
00:25:49,650 --> 00:25:57,870
sound ordinarily or through tour through

450
00:25:53,100 --> 00:26:03,770
toll network obviously chasing criminals

451
00:25:57,870 --> 00:26:09,809
in tour it's more difficult than on

452
00:26:03,770 --> 00:26:14,010
surface web so i downloaded 144 samples

453
00:26:09,809 --> 00:26:15,899
from 22 non-families this is a table

454
00:26:14,010 --> 00:26:22,710
summarizing each and every one of those

455
00:26:15,900 --> 00:26:25,470
families each antivirus manufacturer

456
00:26:22,710 --> 00:26:29,880
changes the slightly the name of it and

457
00:26:25,470 --> 00:26:35,880
this is the discovery dates / years and

458
00:26:29,880 --> 00:26:38,790
cordials so well i did not analyze each

459
00:26:35,880 --> 00:26:44,150
of these 144 samples because i have a

460
00:26:38,790 --> 00:26:48,270
life and i selected in specific sample

461
00:26:44,150 --> 00:26:57,030
the one with the highest virustotal

462
00:26:48,270 --> 00:26:59,690
ratio so I analyzed the highest VT

463
00:26:57,030 --> 00:26:59,690
racial

464
00:27:00,290 --> 00:27:08,629
and this is the evolution in the

465
00:27:05,060 --> 00:27:11,350
beginning we had only one family twenty

466
00:27:08,630 --> 00:27:16,970
street-based persistence then in 2012

467
00:27:11,350 --> 00:27:19,520
two families showed up the next one

468
00:27:16,970 --> 00:27:23,000
registry base the other one another one

469
00:27:19,520 --> 00:27:25,280
service prevalence and you see the

470
00:27:23,000 --> 00:27:29,060
numbers here well you could go and say

471
00:27:25,280 --> 00:27:32,420
that the only few families for this type

472
00:27:29,060 --> 00:27:37,639
of malwa but I feel that there is an

473
00:27:32,420 --> 00:27:40,220
evolution in the years ahead of us I

474
00:27:37,640 --> 00:27:44,120
believe that these bars will become

475
00:27:40,220 --> 00:27:48,590
higher a higher well that would also be

476
00:27:44,120 --> 00:27:50,780
good fun and we will have work to do so

477
00:27:48,590 --> 00:27:52,879
regarding binaries you should note that

478
00:27:50,780 --> 00:27:57,800
most of the binaries have been developed

479
00:27:52,880 --> 00:28:00,680
with c++ or defi so only one of families

480
00:27:57,800 --> 00:28:02,899
have been developed with dotnet out of

481
00:28:00,680 --> 00:28:06,680
the 22 families only five of them

482
00:28:02,900 --> 00:28:09,920
implement any type of security based on

483
00:28:06,680 --> 00:28:13,070
Parker only three of them use any anti

484
00:28:09,920 --> 00:28:16,160
analysis technique as you can see here

485
00:28:13,070 --> 00:28:19,340
most of them are divided by future

486
00:28:16,160 --> 00:28:23,680
anti-growth persistence as you can see

487
00:28:19,340 --> 00:28:27,020
most of them despite EF features our

488
00:28:23,680 --> 00:28:30,730
registry based on the few of them do

489
00:28:27,020 --> 00:28:33,620
best persist and on a few of them are

490
00:28:30,730 --> 00:28:35,840
service-based persistence there is one

491
00:28:33,620 --> 00:28:40,429
which is very interesting the knit loved

492
00:28:35,840 --> 00:28:43,429
one it persists in the registry but it

493
00:28:40,430 --> 00:28:48,140
doesn't have a special manner instead of

494
00:28:43,430 --> 00:28:55,900
storing itself in a file in this sample

495
00:28:48,140 --> 00:29:01,850
or these family brother is a stored in

496
00:28:55,900 --> 00:29:07,550
NTFS files so that's the only way from

497
00:29:01,850 --> 00:29:10,129
the evil to hide data so that those that

498
00:29:07,550 --> 00:29:13,520
are not detected in forensics

499
00:29:10,130 --> 00:29:19,310
but information is still about data is

500
00:29:13,520 --> 00:29:22,430
it stolen well in most of the cases in

501
00:29:19,310 --> 00:29:26,030
data on track one and two are stolen

502
00:29:22,430 --> 00:29:31,750
most of them if any focus on track to

503
00:29:26,030 --> 00:29:31,750
only and most of them will do whitelist

504
00:29:31,900 --> 00:29:39,620
what type of processes are those that

505
00:29:35,420 --> 00:29:46,090
are excluded well often system processes

506
00:29:39,620 --> 00:29:49,489
explorer but dot x a l as us so these

507
00:29:46,090 --> 00:29:52,610
system processes as you know that will

508
00:29:49,490 --> 00:29:56,000
not have credit card data or should not

509
00:29:52,610 --> 00:29:58,399
have credit card data ah the process is

510
00:29:56,000 --> 00:30:01,520
excluded by this malware here we'll have

511
00:29:58,400 --> 00:30:05,920
some families such as these two here

512
00:30:01,520 --> 00:30:10,420
that do whitelisting they focus on

513
00:30:05,920 --> 00:30:16,700
specific processes as i say well this is

514
00:30:10,420 --> 00:30:22,160
problematic this is a summary of how all

515
00:30:16,700 --> 00:30:26,300
this is done and for to set processes

516
00:30:22,160 --> 00:30:27,860
windows functions are used and well this

517
00:30:26,300 --> 00:30:35,200
is typical otherwise we will need a

518
00:30:27,860 --> 00:30:39,919
rootkit so no family has been found

519
00:30:35,200 --> 00:30:42,790
using a rootkit however we cannot rule

520
00:30:39,920 --> 00:30:45,830
that out from happening in the future

521
00:30:42,790 --> 00:30:48,110
most of the families when they find the

522
00:30:45,830 --> 00:30:50,600
process we will read the memory of the

523
00:30:48,110 --> 00:30:53,990
process from themselves the process

524
00:30:50,600 --> 00:30:56,449
would ask windows the mud well we'll ask

525
00:30:53,990 --> 00:30:58,550
about the process that it is interested

526
00:30:56,450 --> 00:31:01,400
in then we will take it and then it will

527
00:30:58,550 --> 00:31:04,180
be asking the process for its memory

528
00:31:01,400 --> 00:31:06,710
areas of what memories have you have

529
00:31:04,180 --> 00:31:08,060
reserved and then it would answer what I

530
00:31:06,710 --> 00:31:09,620
have these ones and they said would you

531
00:31:08,060 --> 00:31:11,330
like to read them and the mother says no

532
00:31:09,620 --> 00:31:13,330
and then it would read that memory

533
00:31:11,330 --> 00:31:15,530
fragment that fragment piece by piece

534
00:31:13,330 --> 00:31:17,600
however there are two formulas very

535
00:31:15,530 --> 00:31:21,139
interesting families that will inject

536
00:31:17,600 --> 00:31:22,939
code they will inject the memory reading

537
00:31:21,140 --> 00:31:25,130
process indeed

538
00:31:22,940 --> 00:31:29,030
actual process that I want to read what

539
00:31:25,130 --> 00:31:33,050
do they get out they yes avoid jumping

540
00:31:29,030 --> 00:31:34,850
an anti virus signature checking whether

541
00:31:33,050 --> 00:31:38,120
there is a process that is accessing in

542
00:31:34,850 --> 00:31:41,149
the process memory accessing the process

543
00:31:38,120 --> 00:31:44,600
memory is not very typical it is not

544
00:31:41,150 --> 00:31:47,030
very common so if the AV is trying to

545
00:31:44,600 --> 00:31:50,300
detect that type of behavior I inject

546
00:31:47,030 --> 00:31:53,210
out there for you make the reading from

547
00:31:50,300 --> 00:31:55,639
your own memory space and this is not

548
00:31:53,210 --> 00:31:58,370
detectable by the antivirus because for

549
00:31:55,640 --> 00:32:00,710
the antivirus this is common so most of

550
00:31:58,370 --> 00:32:07,459
them would try to get information from

551
00:32:00,710 --> 00:32:10,940
both tracks or if any from track to and

552
00:32:07,460 --> 00:32:14,320
none of them looks for information on

553
00:32:10,940 --> 00:32:16,570
track one only so these are some

554
00:32:14,320 --> 00:32:19,040
instructions that we find in some

555
00:32:16,570 --> 00:32:24,649
regular expressions that we often find

556
00:32:19,040 --> 00:32:29,409
in the binaries so they match the memory

557
00:32:24,650 --> 00:32:32,690
with these regular expressions so these

558
00:32:29,410 --> 00:32:37,580
are the first ones that we find for this

559
00:32:32,690 --> 00:32:39,980
type of malware grass are W this was

560
00:32:37,580 --> 00:32:42,830
fastest couple in 2011 let us take off

561
00:32:39,980 --> 00:32:45,680
the top one here we can see that it is

562
00:32:42,830 --> 00:32:47,480
really in the credit card number then

563
00:32:45,680 --> 00:32:50,320
the name and the family name of the

564
00:32:47,480 --> 00:32:56,540
person then the year and the month

565
00:32:50,320 --> 00:33:03,580
notice from 0 to 9 or 10 11 and 12 but

566
00:32:56,540 --> 00:33:06,379
notice the year 2000 172 2009 from 2010

567
00:33:03,580 --> 00:33:09,860
2015 so that is to say in my work that

568
00:33:06,380 --> 00:33:14,770
was discovered in 20 of 11 that's

569
00:33:09,860 --> 00:33:22,990
matching with credit card that expire on

570
00:33:14,770 --> 00:33:22,990
2007 to get me you know what I mean

571
00:33:24,130 --> 00:33:31,660
so well if they did not discover that in

572
00:33:27,580 --> 00:33:35,830
four years well they must have made lots

573
00:33:31,660 --> 00:33:37,450
of profit out of it Iman unicamente then

574
00:33:35,830 --> 00:33:40,270
it was most will have non-anonymous

575
00:33:37,450 --> 00:33:41,470
connection and just a couple have this

576
00:33:40,270 --> 00:33:43,810
other connection and then there's this

577
00:33:41,470 --> 00:33:48,070
other one this other two that have no

578
00:33:43,810 --> 00:33:49,929
kind of exfiltration outside so those

579
00:33:48,070 --> 00:33:53,439
would be the ones that I said before

580
00:33:49,930 --> 00:33:58,420
keep them on a file or else as send it

581
00:33:53,440 --> 00:34:00,820
to and shared unit and a network some of

582
00:33:58,420 --> 00:34:05,620
them tried to send it to a shared and

583
00:34:00,820 --> 00:34:08,799
unit on a network and if we think of

584
00:34:05,620 --> 00:34:11,620
safe and secure systems we can think of

585
00:34:08,800 --> 00:34:13,090
the POS terminal system that it's

586
00:34:11,620 --> 00:34:15,069
isolated but connected to the system

587
00:34:13,090 --> 00:34:17,230
that is not isolated so I get it out to

588
00:34:15,070 --> 00:34:20,740
this system that's not isolated and from

589
00:34:17,230 --> 00:34:24,340
there it goes up outside most will half

590
00:34:20,739 --> 00:34:28,359
HTTP POST connections and some have a

591
00:34:24,340 --> 00:34:32,860
DNS queries as well or requests they

592
00:34:28,360 --> 00:34:36,429
send this DNS request to villain or evil

593
00:34:32,860 --> 00:34:37,870
systems and there they coat the credit

594
00:34:36,429 --> 00:34:42,820
card information that they are x

595
00:34:37,870 --> 00:34:47,080
filtering good let me discuss the tool

596
00:34:42,820 --> 00:34:49,990
that I've mentioned it's best on the DB

597
00:34:47,080 --> 00:34:52,179
our instrumentation principles a dynamic

598
00:34:49,989 --> 00:34:55,000
reiner instrumentation I can run the

599
00:34:52,179 --> 00:34:57,630
code when I want and when I say so so

600
00:34:55,000 --> 00:35:00,940
have my code that will be run and I say

601
00:34:57,630 --> 00:35:04,510
this is the code i want you to run and i

602
00:35:00,940 --> 00:35:10,510
want you to run it here and there that's

603
00:35:04,510 --> 00:35:13,420
it this is DB I'm we've just been finger

604
00:35:10,510 --> 00:35:15,280
which is int'l developed framework so

605
00:35:13,420 --> 00:35:18,070
you can have this kind of tool develop

606
00:35:15,280 --> 00:35:21,730
easily that's the architecture and now

607
00:35:18,070 --> 00:35:26,590
we're tools of far is called pink API

608
00:35:21,730 --> 00:35:29,110
hook and that hooks some system calls

609
00:35:26,590 --> 00:35:33,250
those that we are interested in such as

610
00:35:29,110 --> 00:35:35,280
files registry processes and networks so

611
00:35:33,250 --> 00:35:38,310
I'm monitoring

612
00:35:35,280 --> 00:35:41,250
the MAL work execution or implementation

613
00:35:38,310 --> 00:35:44,430
and what we do is intercepting the calls

614
00:35:41,250 --> 00:35:48,180
and when we intercept them I write it on

615
00:35:44,430 --> 00:35:53,190
a file all the parameters that it is

616
00:35:48,180 --> 00:35:59,250
calling what the cold returns let me

617
00:35:53,190 --> 00:36:08,070
show it to you on a demo I've prayed to

618
00:35:59,250 --> 00:36:14,340
the gods so let me show it to you I have

619
00:36:08,070 --> 00:36:17,550
this Debian machine with me running this

620
00:36:14,340 --> 00:36:21,000
server and I find there is a given

621
00:36:17,550 --> 00:36:26,880
website at a given directory this is a

622
00:36:21,000 --> 00:36:31,440
file PHP that is there on the screen and

623
00:36:26,880 --> 00:36:39,860
it runs everything and writes it from

624
00:36:31,440 --> 00:36:43,220
the past into a given file and here to

625
00:36:39,860 --> 00:36:47,160
comes also dashboards to control my PHP

626
00:36:43,220 --> 00:36:51,240
this is the apache lock option to check

627
00:36:47,160 --> 00:36:56,100
the options and on top you see the fun

628
00:36:51,240 --> 00:37:05,279
information where it is writing that is

629
00:36:56,100 --> 00:37:12,420
at a PP dot PHP sorry hot PHP and this

630
00:37:05,280 --> 00:37:15,080
is a sample from Lena family so let me

631
00:37:12,420 --> 00:37:17,850
show you the strings inside the binary

632
00:37:15,080 --> 00:37:22,140
these are regular expressions that I

633
00:37:17,850 --> 00:37:25,230
explained so far this sample here is

634
00:37:22,140 --> 00:37:29,490
looking for credit cards from twenty

635
00:37:25,230 --> 00:37:33,140
twelve to twenty nineteen both truck 1

636
00:37:29,490 --> 00:37:37,979
this is truck 1 and traction as well and

637
00:37:33,140 --> 00:37:42,779
I know it because of its format so this

638
00:37:37,980 --> 00:37:45,540
is truck 1 equal means its truck too so

639
00:37:42,780 --> 00:37:49,170
this sample has been modified as you see

640
00:37:45,540 --> 00:37:51,240
it's been hard coded and it says what

641
00:37:49,170 --> 00:37:53,220
act itself I don't know if you can see

642
00:37:51,240 --> 00:37:57,779
it from here from there because it's

643
00:37:53,220 --> 00:38:01,169
small print the IP is hard-coded that's

644
00:37:57,780 --> 00:38:04,589
what the sample connects in and this is

645
00:38:01,170 --> 00:38:11,609
what I request it from my system this is

646
00:38:04,589 --> 00:38:15,750
the folder and this is the happy HP so I

647
00:38:11,609 --> 00:38:20,819
get good a post with the information

648
00:38:15,750 --> 00:38:27,770
this web is not working now but it will

649
00:38:20,819 --> 00:38:27,770
be instructed to lock to my machine so I

650
00:38:30,049 --> 00:38:40,859
have my own pee a web server machine

651
00:38:35,970 --> 00:38:43,200
with card reader and a few people in the

652
00:38:40,859 --> 00:38:45,150
morning have been here so maybe my

653
00:38:43,200 --> 00:38:47,790
memory I've stored this kind of

654
00:38:45,150 --> 00:38:51,059
information meaning that i have my POS

655
00:38:47,790 --> 00:38:54,869
system running and there are some people

656
00:38:51,059 --> 00:38:57,089
who've paid using my POS terminal I know

657
00:38:54,869 --> 00:38:59,730
if there's a Roman sauna and other

658
00:38:57,089 --> 00:39:02,430
people they've used their card and this

659
00:38:59,730 --> 00:39:05,190
is stored in my memory so this window

660
00:39:02,430 --> 00:39:11,009
stays open and running and this is all

661
00:39:05,190 --> 00:39:13,380
on the process memory that's notepad and

662
00:39:11,010 --> 00:39:17,630
this is the other sample that has been

663
00:39:13,380 --> 00:39:21,180
modified Elena's family modified and

664
00:39:17,630 --> 00:39:24,089
when when I run you will see what

665
00:39:21,180 --> 00:39:28,160
happens this is what I think vogue I

666
00:39:24,089 --> 00:39:30,660
will not dwell on that press ENTER and

667
00:39:28,160 --> 00:39:34,049
there are some lock files with the

668
00:39:30,660 --> 00:39:36,720
traces and the samples gone right and

669
00:39:34,049 --> 00:39:39,150
this is quite typical of malware mal

670
00:39:36,720 --> 00:39:43,680
will once the machine is infected itself

671
00:39:39,150 --> 00:39:48,390
deletes so let's see what's going on

672
00:39:43,680 --> 00:39:51,419
here system as you see this window

673
00:39:48,390 --> 00:39:57,410
systems still running nothing's on there

674
00:39:51,420 --> 00:40:01,310
and eventually if gods are merciful

675
00:39:57,410 --> 00:40:04,980
we'll see what we get the ABS

676
00:40:01,310 --> 00:40:08,070
information that has kept the cards data

677
00:40:04,980 --> 00:40:10,920
on memory so this is a connection to the

678
00:40:08,070 --> 00:40:16,100
apache server and up here you see the

679
00:40:10,920 --> 00:40:16,100
files information there it is thank you

680
00:40:16,220 --> 00:40:23,040
so here it's a connection from the

681
00:40:19,560 --> 00:40:25,920
windows machine and HTTP pass request

682
00:40:23,040 --> 00:40:29,279
for a fine and this this the data sent

683
00:40:25,920 --> 00:40:31,920
back to me by the back you see this is

684
00:40:29,280 --> 00:40:34,620
the beginning of an El Nino string and

685
00:40:31,920 --> 00:40:37,230
all the information data that it

686
00:40:34,620 --> 00:40:40,970
scattered and you can see well that

687
00:40:37,230 --> 00:40:45,870
there's been previous tests from earlier

688
00:40:40,970 --> 00:40:53,100
so HW ID so heartwood ID and a number

689
00:40:45,870 --> 00:40:57,750
right if we knew about windows this is

690
00:40:53,100 --> 00:41:03,029
so much so this number is a match to the

691
00:40:57,750 --> 00:41:05,700
number expressing my heart dr volumes on

692
00:41:03,030 --> 00:41:08,400
the infected machine so what the samples

693
00:41:05,700 --> 00:41:11,069
is doing is a spot in where the data are

694
00:41:08,400 --> 00:41:14,610
coming from and this specific machine

695
00:41:11,070 --> 00:41:16,410
that is extracted information as you can

696
00:41:14,610 --> 00:41:20,580
see there is this little file that has

697
00:41:16,410 --> 00:41:21,960
been produced it is a fine and i guess

698
00:41:20,580 --> 00:41:26,310
there's another one i can say this oh

699
00:41:21,960 --> 00:41:42,099
here is so two files two files that have

700
00:41:26,310 --> 00:41:48,130
information for the execution this is

701
00:41:42,099 --> 00:41:51,819
all the requests to malwa so first mal

702
00:41:48,130 --> 00:41:55,619
would try to create mutex and mute and

703
00:41:51,819 --> 00:41:58,930
here you see open process calls as well

704
00:41:55,619 --> 00:42:01,210
to start processes that's what it's

705
00:41:58,930 --> 00:42:04,569
trying to do here sums are excited sums

706
00:42:01,210 --> 00:42:09,430
are not but in the end you see some

707
00:42:04,569 --> 00:42:13,690
readings from the memory are the

708
00:42:09,430 --> 00:42:16,899
processes memory I'm not sure whether it

709
00:42:13,690 --> 00:42:19,410
is here eventually all the way down it

710
00:42:16,900 --> 00:42:23,559
should be so yes you you see the request

711
00:42:19,410 --> 00:42:27,519
that it's been done this is the coral

712
00:42:23,559 --> 00:42:31,289
the connection here it is when there is

713
00:42:27,519 --> 00:42:35,589
a connection attempt this is the IP and

714
00:42:31,289 --> 00:42:38,499
here you see the type of request this is

715
00:42:35,589 --> 00:42:54,599
the send request you see and here is

716
00:42:38,499 --> 00:42:54,598
what the what it is sending so next good

717
00:42:54,710 --> 00:43:01,010
this is md5 of the sample left analyze

718
00:42:57,859 --> 00:43:03,650
its been slightly touched to connect to

719
00:43:01,010 --> 00:43:09,349
my server that's Warsaw then related

720
00:43:03,650 --> 00:43:12,020
work so many people have looked into

721
00:43:09,349 --> 00:43:14,839
different kinds of malware but no one

722
00:43:12,020 --> 00:43:17,030
had looked into this kind of box baby

723
00:43:14,839 --> 00:43:21,799
because it may be because it it was not

724
00:43:17,030 --> 00:43:24,890
mature this sector and when it comes to

725
00:43:21,800 --> 00:43:26,839
banking information or data you need to

726
00:43:24,890 --> 00:43:30,770
know that some people has developed some

727
00:43:26,839 --> 00:43:35,049
tools to sniff internet works to see if

728
00:43:30,770 --> 00:43:39,740
your system fulfills the pc is s

729
00:43:35,050 --> 00:43:45,500
standard PCD ISS and there is a scraping

730
00:43:39,740 --> 00:43:50,200
with network packages and others have

731
00:43:45,500 --> 00:43:53,510
looked into security are there different

732
00:43:50,200 --> 00:43:56,060
elements pay Paul and others offer you

733
00:43:53,510 --> 00:43:59,599
hard with that you can connect to the

734
00:43:56,060 --> 00:44:02,480
audio jack on your cell phone and the

735
00:43:59,599 --> 00:44:04,940
target is to read credit cards some

736
00:44:02,480 --> 00:44:07,820
people have analyzed what the security

737
00:44:04,940 --> 00:44:10,580
is for these kind of systems so

738
00:44:07,820 --> 00:44:12,980
conclusions there is kind of mole of

739
00:44:10,580 --> 00:44:15,740
malware that it's quite different that

740
00:44:12,980 --> 00:44:19,040
stills information from credit cards

741
00:44:15,740 --> 00:44:21,770
stored in the memory of processes within

742
00:44:19,040 --> 00:44:24,230
an operating system this time windows

743
00:44:21,770 --> 00:44:27,320
we've seen how they work first through

744
00:44:24,230 --> 00:44:30,200
persistence then they gather all the

745
00:44:27,320 --> 00:44:32,930
processes that are running and they go

746
00:44:30,200 --> 00:44:35,629
into the process memory and find the

747
00:44:32,930 --> 00:44:37,399
information the matches a credit card

748
00:44:35,630 --> 00:44:39,920
haven't mentioned it but there are a few

749
00:44:37,400 --> 00:44:42,500
samples where they implement the Luhn

750
00:44:39,920 --> 00:44:45,349
algorithm briefly mentioned by Ruben

751
00:44:42,500 --> 00:44:50,030
which is an algorithm that it's part of

752
00:44:45,349 --> 00:44:52,640
being track of standard and it states

753
00:44:50,030 --> 00:44:55,369
whether the number of credit card you've

754
00:44:52,640 --> 00:44:57,618
read is valid or not you need to

755
00:44:55,369 --> 00:45:00,140
consider that malware reads the whole

756
00:44:57,619 --> 00:45:02,780
memory and it might happen that what is

757
00:45:00,140 --> 00:45:06,290
being read doesn't match a credit card

758
00:45:02,780 --> 00:45:07,960
so the format would be a match but it

759
00:45:06,290 --> 00:45:10,359
would not be a credit card

760
00:45:07,960 --> 00:45:13,660
our beers and that's validating

761
00:45:10,359 --> 00:45:15,400
algorithm that is used to validate when

762
00:45:13,660 --> 00:45:21,210
the information is found they just

763
00:45:15,400 --> 00:45:25,359
exfiltrated in whatever way we've

764
00:45:21,210 --> 00:45:29,200
analyzed 22 families and they were

765
00:45:25,359 --> 00:45:34,330
classified based on their behavior or

766
00:45:29,200 --> 00:45:36,790
workflow okay home messages well luckily

767
00:45:34,330 --> 00:45:40,529
there are only a few families trying to

768
00:45:36,790 --> 00:45:43,720
use some kind of anti analysis mechanism

769
00:45:40,530 --> 00:45:46,599
luckily all persistent methods used can

770
00:45:43,720 --> 00:45:49,779
be easily detected they are

771
00:45:46,599 --> 00:45:53,080
registry-based and they are quite simple

772
00:45:49,780 --> 00:45:55,960
to detect there's only one that's a bit

773
00:45:53,080 --> 00:46:00,549
more complicated that would be neat love

774
00:45:55,960 --> 00:46:04,599
using ntfs so those are alternate flows

775
00:46:00,550 --> 00:46:06,609
for information and most go for process

776
00:46:04,599 --> 00:46:09,010
blacklisting it's only normal because

777
00:46:06,609 --> 00:46:11,560
system processes are not interested in

778
00:46:09,010 --> 00:46:13,839
looking into them and most of the time

779
00:46:11,560 --> 00:46:16,589
luckily as well they will use

780
00:46:13,839 --> 00:46:19,810
exfiltration flows that are none

781
00:46:16,589 --> 00:46:22,180
anonymous so it will be easy to track

782
00:46:19,810 --> 00:46:24,990
down where the information is sent who

783
00:46:22,180 --> 00:46:27,940
is receiving it and so we can crush the

784
00:46:24,990 --> 00:46:29,979
villains system we've seen some other

785
00:46:27,940 --> 00:46:35,010
two weird things such as a DNS

786
00:46:29,980 --> 00:46:39,240
exfiltration or when you like are you a

787
00:46:35,010 --> 00:46:42,310
USB to your machine I'm to more used to

788
00:46:39,240 --> 00:46:45,279
remember that that's me know for me if

789
00:46:42,310 --> 00:46:46,900
you have questions I'll be happy to take

790
00:46:45,280 --> 00:46:51,360
them

791
00:46:46,900 --> 00:46:51,360
[Applause]

792
00:47:09,010 --> 00:47:17,680
oh so good morning first of all thank

793
00:47:15,610 --> 00:47:24,100
you domen for your presentation very

794
00:47:17,680 --> 00:47:26,770
interesting and let me mention for POS

795
00:47:24,100 --> 00:47:29,080
or post terminal environments of those

796
00:47:26,770 --> 00:47:34,540
companies that set those terminals up as

797
00:47:29,080 --> 00:47:41,350
a restaurants and coffee shops are they

798
00:47:34,540 --> 00:47:45,580
aware of it or is the solution different

799
00:47:41,350 --> 00:47:49,180
I hope so this kind of companies were

800
00:47:45,580 --> 00:47:52,590
they trying or should try to make the

801
00:47:49,180 --> 00:47:56,200
standard otherwise you should get lost

802
00:47:52,590 --> 00:47:58,180
but as I said before when we discuss the

803
00:47:56,200 --> 00:48:01,419
standard would they ensure is that the

804
00:47:58,180 --> 00:48:03,819
information in transit is protected but

805
00:48:01,420 --> 00:48:06,730
as far as I know there is no solution

806
00:48:03,820 --> 00:48:09,810
the things of a memory protection

807
00:48:06,730 --> 00:48:13,060
because this is the local machine and

808
00:48:09,810 --> 00:48:15,610
there is a a drum attack on the machine

809
00:48:13,060 --> 00:48:18,730
that very machine so I guess that the

810
00:48:15,610 --> 00:48:22,420
POS terminal pretty manufacturers should

811
00:48:18,730 --> 00:48:25,660
have some run cleaning after each

812
00:48:22,420 --> 00:48:28,870
transaction well they should do

813
00:48:25,660 --> 00:48:32,770
something to make sure that if infected

814
00:48:28,870 --> 00:48:36,160
with this kind of malware the data from

815
00:48:32,770 --> 00:48:41,050
the credit card would not be on the

816
00:48:36,160 --> 00:48:43,390
memory so in plain tex i mean and that

817
00:48:41,050 --> 00:48:46,360
was that was a question about different

818
00:48:43,390 --> 00:48:48,100
manufacturers i have not talked to any

819
00:48:46,360 --> 00:48:52,570
of them so i cannot tell you for sure

820
00:48:48,100 --> 00:48:54,640
but i have to guess based on the market

821
00:48:52,570 --> 00:48:56,500
solutions that are out there and the

822
00:48:54,640 --> 00:48:58,690
fact that this is going on especially in

823
00:48:56,500 --> 00:49:03,940
the US where the credit card is widely

824
00:48:58,690 --> 00:49:06,940
used with the magnetic stripe i would

825
00:49:03,940 --> 00:49:09,280
guess that the memory date is not

826
00:49:06,940 --> 00:49:10,990
protected because if it's a cheap card

827
00:49:09,280 --> 00:49:17,410
this technique it would not be feasible

828
00:49:10,990 --> 00:49:20,470
right well see the chip cards this would

829
00:49:17,410 --> 00:49:22,520
be different kind of attack the thing is

830
00:49:20,470 --> 00:49:24,740
if the information

831
00:49:22,520 --> 00:49:27,470
out of the chief is a stored on the RAM

832
00:49:24,740 --> 00:49:30,259
memory which this should not be the case

833
00:49:27,470 --> 00:49:35,120
in Italy the problem would be the same

834
00:49:30,260 --> 00:49:37,880
but again it should not be there so you

835
00:49:35,120 --> 00:49:42,049
would recommend d stabling the magnetic

836
00:49:37,880 --> 00:49:43,520
stripe right I recommend you to be aware

837
00:49:42,050 --> 00:49:48,230
of what you do with your credit card

838
00:49:43,520 --> 00:49:53,290
that was it where you tap it what ATMs

839
00:49:48,230 --> 00:49:53,290
you use for sure thank you very much

840
00:50:11,620 --> 00:50:18,830
good morning morning what's the current

841
00:50:15,050 --> 00:50:21,620
the useful infection factor well as with

842
00:50:18,830 --> 00:50:26,540
any kind of malware if you have a POS

843
00:50:21,620 --> 00:50:29,270
terminal you work at somewhere and

844
00:50:26,540 --> 00:50:32,930
you've got plenty of time I don't know a

845
00:50:29,270 --> 00:50:35,030
tobacco shop you've got your your

846
00:50:32,930 --> 00:50:36,710
terminal some people come in the shops

847
00:50:35,030 --> 00:50:38,180
and other times you are alone and you've

848
00:50:36,710 --> 00:50:40,580
got a computer with an internet

849
00:50:38,180 --> 00:50:45,799
connection what do you do rip the

850
00:50:40,580 --> 00:50:50,049
newspapers yes or apps or probably some

851
00:50:45,800 --> 00:50:54,140
websites to watch some videos

852
00:50:50,050 --> 00:50:58,220
not-so-legal videos movies that are on

853
00:50:54,140 --> 00:51:01,270
websites weather's usually third-party

854
00:50:58,220 --> 00:51:03,830
exploit to compromise your computer

855
00:51:01,270 --> 00:51:05,600
basically what we see is that the attack

856
00:51:03,830 --> 00:51:08,270
vector would be the same that we would

857
00:51:05,600 --> 00:51:10,690
find with a commodity malware which is

858
00:51:08,270 --> 00:51:17,360
regular malware it could also be

859
00:51:10,690 --> 00:51:21,170
insiders the typical and happy employee

860
00:51:17,360 --> 00:51:24,010
down flexing the the USB yes the USB

861
00:51:21,170 --> 00:51:26,810
excitation is more less clear but if

862
00:51:24,010 --> 00:51:28,460
they attack it all as if it were fishing

863
00:51:26,810 --> 00:51:31,130
or maybe it's a bit more much more

864
00:51:28,460 --> 00:51:32,690
targeted or focus no you can have a much

865
00:51:31,130 --> 00:51:33,980
more focused or targeted attacks

866
00:51:32,690 --> 00:51:36,830
actually

867
00:51:33,980 --> 00:51:40,670
rule of the standard is to have highly

868
00:51:36,830 --> 00:51:43,609
specific attacks because this kind of

869
00:51:40,670 --> 00:51:46,310
websites we mentioned anyone could login

870
00:51:43,609 --> 00:51:49,009
and so the percentage of people who find

871
00:51:46,310 --> 00:51:52,279
themselves at a POS terminal would be

872
00:51:49,010 --> 00:51:56,180
smaller but we could refer to much more

873
00:51:52,280 --> 00:51:58,100
targeted attacks spearfishing but takes

874
00:51:56,180 --> 00:52:01,040
you to a given website and then last

875
00:51:58,100 --> 00:52:03,470
question any water Hollen attack that

876
00:52:01,040 --> 00:52:06,020
you've seen watering hole in attack

877
00:52:03,470 --> 00:52:09,230
where there might be a regular provider

878
00:52:06,020 --> 00:52:12,470
and there it is compromised and so there

879
00:52:09,230 --> 00:52:16,520
is like a skate effect no have not seen

880
00:52:12,470 --> 00:52:21,049
it perfect thank you very much yeah

881
00:52:16,520 --> 00:52:23,509
together Thank You Ricardo as always

882
00:52:21,050 --> 00:52:26,180
you're so great at explaining what do

883
00:52:23,510 --> 00:52:29,119
you need to explain easy to understand I

884
00:52:26,180 --> 00:52:34,359
have a question and you see the

885
00:52:29,119 --> 00:52:34,359
Etienne's that would speed out money

886
00:52:34,420 --> 00:52:39,740
does it have to do with this kind of

887
00:52:36,650 --> 00:52:44,150
attacks this is ATM malware and it's

888
00:52:39,740 --> 00:52:46,009
completely different okay good maybe a

889
00:52:44,150 --> 00:52:53,119
few years from now next to you maybe

890
00:52:46,010 --> 00:52:55,369
I'll discussed that nothing to do with

891
00:52:53,119 --> 00:53:02,810
Swift attacks either that are so trendy

892
00:52:55,369 --> 00:53:05,540
recently any more questions so thank you

893
00:53:02,810 --> 00:53:08,350
very much for being in this room in a

894
00:53:05,540 --> 00:53:08,350
Sunday morning

