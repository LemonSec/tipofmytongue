1
00:00:02,120 --> 00:00:07,160
good morning good morning everyone I

2
00:00:08,990 --> 00:00:13,379
will introduce myself on door being

3
00:00:11,580 --> 00:00:17,130
introduced my name is jose luis i come

4
00:00:13,380 --> 00:00:21,900
from Alicante I am an IT system

5
00:00:17,130 --> 00:00:24,330
technical engineer and hardworking voice

6
00:00:21,900 --> 00:00:26,880
over the internet I live my contact

7
00:00:24,330 --> 00:00:28,609
details for you just in case you have

8
00:00:26,880 --> 00:00:32,820
further questions after my presentation

9
00:00:28,609 --> 00:00:36,960
my presentation is about analyzing a

10
00:00:32,820 --> 00:00:41,129
hardware device this is true colour

11
00:00:36,960 --> 00:00:45,600
hacking embedded devices Sam this is a

12
00:00:41,129 --> 00:00:48,420
router for voice over the internet but

13
00:00:45,600 --> 00:00:50,760
this is not for voice over the internet

14
00:00:48,420 --> 00:00:56,660
but this could be applied to any device

15
00:00:50,760 --> 00:00:59,218
do you know what VoIP is well Philippe's

16
00:00:56,660 --> 00:01:02,459
telephony over the Internet it doesn't

17
00:00:59,219 --> 00:01:05,150
go through a physical cable wire but it

18
00:01:02,460 --> 00:01:07,650
goes through that I goes through a

19
00:01:05,150 --> 00:01:09,540
Donnybrook and same as any other service

20
00:01:07,650 --> 00:01:17,580
it needs to be protected in the same

21
00:01:09,540 --> 00:01:20,009
fashion I do VoIP and what are the

22
00:01:17,580 --> 00:01:24,150
problems that i often find the

23
00:01:20,009 --> 00:01:27,900
insecurity is it the same being attacked

24
00:01:24,150 --> 00:01:29,159
on your VoIP system or your database no

25
00:01:27,900 --> 00:01:32,250
we are not talking about the same

26
00:01:29,159 --> 00:01:36,810
consequences if someone attacks website

27
00:01:32,250 --> 00:01:39,299
it's often done for lift a eco or to

28
00:01:36,810 --> 00:01:42,600
have a good time or just to steal data

29
00:01:39,299 --> 00:01:45,320
but when these system is being hacked is

30
00:01:42,600 --> 00:01:51,179
being attack force over the Internet is

31
00:01:45,320 --> 00:01:53,220
done for to get to get them finance

32
00:01:51,180 --> 00:01:55,490
every word out of it so I don't know

33
00:01:53,220 --> 00:01:58,350
whether here there are some

34
00:01:55,490 --> 00:02:01,079
administrators I don't know whether you

35
00:01:58,350 --> 00:02:02,880
know about the file that you have in

36
00:02:01,079 --> 00:02:07,408
your sister and you will see that there

37
00:02:02,880 --> 00:02:10,440
are blocks every minute I set up a honey

38
00:02:07,409 --> 00:02:13,180
pots so that to find out about the type

39
00:02:10,440 --> 00:02:17,709
of messages and that I was getting

40
00:02:13,180 --> 00:02:19,750
it was a VoIP honey pots and in six

41
00:02:17,709 --> 00:02:22,870
months I've received more than three

42
00:02:19,750 --> 00:02:27,430
million queries and I didn't publish it

43
00:02:22,870 --> 00:02:31,090
anywhere and what is the solution that

44
00:02:27,430 --> 00:02:35,590
we have to protect our system is it

45
00:02:31,090 --> 00:02:37,659
enough to have good administration well

46
00:02:35,590 --> 00:02:40,569
if the administrators in the room you

47
00:02:37,659 --> 00:02:43,328
know that systems have to be updated as

48
00:02:40,569 --> 00:02:47,349
all the time but this is not always easy

49
00:02:43,329 --> 00:02:49,569
at the level of VoIP while I'm saying

50
00:02:47,349 --> 00:02:51,638
this for VoIP this could be applicable

51
00:02:49,569 --> 00:02:53,168
to any other system probably do don't

52
00:02:51,639 --> 00:02:55,299
have only one machine but you will have

53
00:02:53,169 --> 00:02:57,069
an infrastructure of several machines if

54
00:02:55,299 --> 00:02:59,230
you analyze one of them probably you

55
00:02:57,069 --> 00:03:01,089
will have to make changes in the

56
00:02:59,230 --> 00:03:02,560
configuration or perhaps you have

57
00:03:01,090 --> 00:03:06,579
machines with different services that

58
00:03:02,560 --> 00:03:09,310
also want to do you want to upgrade so

59
00:03:06,579 --> 00:03:11,919
probably this is not an easy task than

60
00:03:09,310 --> 00:03:14,560
well on a daily basis we get new

61
00:03:11,919 --> 00:03:18,519
failures and new attacks a good solution

62
00:03:14,560 --> 00:03:20,260
though would be to install a firewall by

63
00:03:18,519 --> 00:03:23,859
the fire world which is one aware of

64
00:03:20,260 --> 00:03:26,409
VoIP knowledgeable about VoIP going back

65
00:03:23,859 --> 00:03:28,629
to a website you either open or shadow

66
00:03:26,409 --> 00:03:30,519
service if you want everyone to access

67
00:03:28,629 --> 00:03:32,858
your website you cannot really introduce

68
00:03:30,519 --> 00:03:34,510
IP filters the same goes here if you

69
00:03:32,859 --> 00:03:36,669
want to be want to use your service you

70
00:03:34,510 --> 00:03:39,220
open it up you open it up to everyone

71
00:03:36,669 --> 00:03:43,299
how do you filter that though if you

72
00:03:39,220 --> 00:03:45,579
have a device able to analyze the entry

73
00:03:43,299 --> 00:03:48,669
whatever enters into your network that

74
00:03:45,579 --> 00:03:51,430
would be ideal and this is what my talk

75
00:03:48,669 --> 00:03:53,769
is about today we will be analyzing one

76
00:03:51,430 --> 00:03:57,729
of those devices it is a router that

77
00:03:53,769 --> 00:04:01,060
monitors VoIP traffic and in theory

78
00:03:57,729 --> 00:04:04,750
looks at whether it is a thread or

79
00:04:01,060 --> 00:04:06,790
whether it is a legit package and we

80
00:04:04,750 --> 00:04:10,509
will take a look at the functionality

81
00:04:06,790 --> 00:04:14,290
and then we will see whether it meets

82
00:04:10,509 --> 00:04:16,899
the manufacturer requirements and then

83
00:04:14,290 --> 00:04:19,000
let us also take a look at the response

84
00:04:16,899 --> 00:04:22,840
that we often get from the manufacturer

85
00:04:19,000 --> 00:04:25,539
every time we reports failures well if

86
00:04:22,840 --> 00:04:27,090
you notice this website located website

87
00:04:25,539 --> 00:04:30,130
for DC

88
00:04:27,090 --> 00:04:33,700
device it tells you that this device

89
00:04:30,130 --> 00:04:36,130
does all that it analysis is IP packet

90
00:04:33,700 --> 00:04:39,520
ease it also detects an animal

91
00:04:36,130 --> 00:04:43,350
abnormalities in the S IP protocol it

92
00:04:39,520 --> 00:04:47,889
also blocks denial of service attacks

93
00:04:43,350 --> 00:04:51,310
CSS buffer overflow known vulnerability

94
00:04:47,889 --> 00:04:54,280
it also has dynamic blacklist what at

95
00:04:51,310 --> 00:04:59,650
least the geolocation we detect fraud it

96
00:04:54,280 --> 00:05:02,830
does everything I didn't mentioned it

97
00:04:59,650 --> 00:05:06,460
but I chose these device because the

98
00:05:02,830 --> 00:05:10,479
manufacturer contacted me to offer it to

99
00:05:06,460 --> 00:05:12,760
me for me to sell it to distribute it or

100
00:05:10,480 --> 00:05:15,940
refer it to my clients and before I

101
00:05:12,760 --> 00:05:18,909
offer a product or service to my clients

102
00:05:15,940 --> 00:05:21,190
I want to analyze it to see if it is up

103
00:05:18,910 --> 00:05:24,190
to the standards and looking at this

104
00:05:21,190 --> 00:05:27,310
device well I can tell you that it is

105
00:05:24,190 --> 00:05:29,350
manufactured by a company located in

106
00:05:27,310 --> 00:05:31,510
India however it is distributed by a

107
00:05:29,350 --> 00:05:35,770
Canadian company actually this is the

108
00:05:31,510 --> 00:05:37,750
same company however let us say that the

109
00:05:35,770 --> 00:05:39,400
they have two brands so that the

110
00:05:37,750 --> 00:05:41,710
manufacturer can offer it to third

111
00:05:39,400 --> 00:05:43,539
parties who want that one to manufacture

112
00:05:41,710 --> 00:05:47,799
the product under a different brand name

113
00:05:43,539 --> 00:05:49,960
if we take a look at this take a look at

114
00:05:47,800 --> 00:05:54,070
the panel we find different panels

115
00:05:49,960 --> 00:05:57,760
different look and feel different colors

116
00:05:54,070 --> 00:06:00,789
the second device it is well-known used

117
00:05:57,760 --> 00:06:03,039
by millions of users I didn't use it

118
00:06:00,789 --> 00:06:07,140
myself I cannot really certify hundred

119
00:06:03,039 --> 00:06:07,140
percent that it has the same failures

120
00:06:07,560 --> 00:06:13,870
but I guess I guess it is similar in

121
00:06:11,169 --> 00:06:17,440
terms of failures if we take a look at

122
00:06:13,870 --> 00:06:19,450
the actual device this is the one that

123
00:06:17,440 --> 00:06:21,430
of the manufacturer the one that is

124
00:06:19,450 --> 00:06:23,380
manufactured distributed by this other

125
00:06:21,430 --> 00:06:27,490
company and then these other one the

126
00:06:23,380 --> 00:06:30,700
same type of device the same buttons the

127
00:06:27,490 --> 00:06:34,060
same configuration everything how do we

128
00:06:30,700 --> 00:06:35,979
analyze the security of physical device

129
00:06:34,060 --> 00:06:39,030
and as I say this can be applied to any

130
00:06:35,979 --> 00:06:43,590
device router telephones

131
00:06:39,030 --> 00:06:45,659
but camera cameras so what it is most

132
00:06:43,590 --> 00:06:47,969
convenient to do it will have access to

133
00:06:45,660 --> 00:06:50,280
the fam well we will unzip it and then

134
00:06:47,970 --> 00:06:52,680
we will analyze it however the problem

135
00:06:50,280 --> 00:06:57,119
that we find here is there only few

136
00:06:52,680 --> 00:06:59,010
manufacturers of you possibility to

137
00:06:57,120 --> 00:07:01,770
download the fam welcome when you do

138
00:06:59,010 --> 00:07:03,510
that often the fabric is encrypted so

139
00:07:01,770 --> 00:07:06,719
therefore that makes it difficult for us

140
00:07:03,510 --> 00:07:11,400
to go into it and then we can also

141
00:07:06,720 --> 00:07:15,180
analyze devices through administration

142
00:07:11,400 --> 00:07:18,239
panels whether it is web ssh telnet etc

143
00:07:15,180 --> 00:07:21,000
a problem is that we are just doing

144
00:07:18,240 --> 00:07:23,130
blind analysis here so if you do

145
00:07:21,000 --> 00:07:24,720
penetration test we may do that but we

146
00:07:23,130 --> 00:07:27,780
don't have the source code we don't have

147
00:07:24,720 --> 00:07:30,270
access to the system no nothing so

148
00:07:27,780 --> 00:07:33,869
another way to analyze this hardware

149
00:07:30,270 --> 00:07:37,500
devices is through a console ports if

150
00:07:33,870 --> 00:07:39,570
they are if they're available and if

151
00:07:37,500 --> 00:07:42,900
they are not available we go through you

152
00:07:39,570 --> 00:07:45,030
are to gtalk ports problems if there is

153
00:07:42,900 --> 00:07:47,190
no console port rest to plug in we will

154
00:07:45,030 --> 00:07:50,840
have to open up the device that means

155
00:07:47,190 --> 00:07:54,420
that we will be and not complying or we

156
00:07:50,840 --> 00:07:57,479
warranty we break the warranty and here

157
00:07:54,420 --> 00:08:01,500
you see a UART connection well we just

158
00:07:57,480 --> 00:08:04,020
that plug in 3 or 4 wires and we

159
00:08:01,500 --> 00:08:06,930
connected to the USB and then in case of

160
00:08:04,020 --> 00:08:09,090
this device that i will be talking about

161
00:08:06,930 --> 00:08:11,280
we don't have fully access to it in the

162
00:08:09,090 --> 00:08:15,479
manufacturer website we make my download

163
00:08:11,280 --> 00:08:17,460
up updates but often they are encrypted

164
00:08:15,480 --> 00:08:20,010
and we cannot do anything with them and

165
00:08:17,460 --> 00:08:24,390
then for that again we decided to pen

166
00:08:20,010 --> 00:08:26,760
test it and we I did a switch I just a

167
00:08:24,390 --> 00:08:33,449
switch to create a local network and

168
00:08:26,760 --> 00:08:35,939
then VoIP a switch board and then mobile

169
00:08:33,450 --> 00:08:38,520
phone just to launch the attacks and

170
00:08:35,940 --> 00:08:41,760
then the actual device how does it work

171
00:08:38,520 --> 00:08:45,060
well these device works in bridge mode

172
00:08:41,760 --> 00:08:49,140
so there are two interfaces there is a

173
00:08:45,060 --> 00:08:52,119
LAN there are two lands so we will

174
00:08:49,140 --> 00:08:56,560
connect the switchboard or the viewer I

175
00:08:52,120 --> 00:09:00,250
system so the LAN and then all the

176
00:08:56,560 --> 00:09:01,779
traffic on in and out of the corn in and

177
00:09:00,250 --> 00:09:03,820
out the switchboard will call through

178
00:09:01,779 --> 00:09:07,860
this device and then the device will

179
00:09:03,820 --> 00:09:12,160
detect decide whether the package is

180
00:09:07,860 --> 00:09:14,620
malicious or valid on legit so before

181
00:09:12,160 --> 00:09:18,300
that let us analyze the functionality

182
00:09:14,620 --> 00:09:21,550
and all everything that is being set by

183
00:09:18,300 --> 00:09:23,589
salta by the manufacturer so let us take

184
00:09:21,550 --> 00:09:26,319
a look at this panel wipe it is very

185
00:09:23,589 --> 00:09:28,839
easy to manage their a number of

186
00:09:26,320 --> 00:09:30,730
checkbox that you have to follow you

187
00:09:28,839 --> 00:09:36,520
don't need to know how to program or

188
00:09:30,730 --> 00:09:41,670
anything else and what I disliked was

189
00:09:36,520 --> 00:09:47,319
that by default it comes with two

190
00:09:41,670 --> 00:09:50,020
interfaces it so the W that land and one

191
00:09:47,320 --> 00:09:52,390
and actually only the land

192
00:09:50,020 --> 00:09:54,069
administrators are administration's are

193
00:09:52,390 --> 00:09:57,880
open so if we allow you to access

194
00:09:54,070 --> 00:10:00,550
through the land and if we connected to

195
00:09:57,880 --> 00:10:02,890
the Internet well this could be at a

196
00:10:00,550 --> 00:10:06,430
collector actually so this is not very

197
00:10:02,890 --> 00:10:09,100
inspiring in terms of trust here with

198
00:10:06,430 --> 00:10:12,400
the SQL injection this will allow us to

199
00:10:09,100 --> 00:10:16,750
change things in the database we also

200
00:10:12,400 --> 00:10:19,650
have hmm failures in terms of scripting

201
00:10:16,750 --> 00:10:25,060
we could use it to do a phishing attack

202
00:10:19,650 --> 00:10:28,390
and then if we access through the ssh we

203
00:10:25,060 --> 00:10:30,130
see a menu quite many of options which

204
00:10:28,390 --> 00:10:33,550
is quite reduced we don't have the

205
00:10:30,130 --> 00:10:35,350
possibility to execute command interface

206
00:10:33,550 --> 00:10:38,410
the only thing that we can do is what it

207
00:10:35,350 --> 00:10:40,779
says in the screen and if we do an exit

208
00:10:38,410 --> 00:10:44,199
then it does not allow us to do it so

209
00:10:40,779 --> 00:10:46,959
happens Lee if you access through ssh we

210
00:10:44,200 --> 00:10:50,110
go to this menu we do four three things

211
00:10:46,959 --> 00:10:51,969
and then when we do access we are no

212
00:10:50,110 --> 00:10:57,970
longer there so therefore this is not a

213
00:10:51,970 --> 00:11:01,440
good way to go in so to analyze

214
00:10:57,970 --> 00:11:04,339
functionality because this is a VoIP

215
00:11:01,440 --> 00:11:07,399
device have fun to use

216
00:11:04,339 --> 00:11:10,579
supervision servicios is one of the most

217
00:11:07,399 --> 00:11:13,339
well-known tools to hand test these

218
00:11:10,579 --> 00:11:17,209
systems it is a set of scripts that are

219
00:11:13,339 --> 00:11:21,410
programmed on Python they scan networks

220
00:11:17,209 --> 00:11:24,649
to look for VoIP systems once any

221
00:11:21,410 --> 00:11:27,889
systems are found then you can they

222
00:11:24,649 --> 00:11:31,879
number the telephony is tensions and

223
00:11:27,889 --> 00:11:37,459
passwords can also be tracked so I'm

224
00:11:31,879 --> 00:11:40,999
going to launch this up trying to locate

225
00:11:37,459 --> 00:11:43,790
switchboards and here we can see that it

226
00:11:40,999 --> 00:11:46,970
does not find anything if we go to the

227
00:11:43,790 --> 00:11:50,449
pan web control panel here we see to

228
00:11:46,970 --> 00:11:53,149
alert when alert telling us the non

229
00:11:50,449 --> 00:11:57,050
attacks has been detected and another

230
00:11:53,149 --> 00:12:00,019
one when our IP is blocked because it

231
00:11:57,050 --> 00:12:05,209
considers that we are a threat if we

232
00:12:00,019 --> 00:12:07,970
access to the white black list our IP is

233
00:12:05,209 --> 00:12:11,239
listed on that blacklist and here we

234
00:12:07,970 --> 00:12:13,129
cannot do anything in the device and

235
00:12:11,240 --> 00:12:21,410
this is what these devices thoughtful

236
00:12:13,129 --> 00:12:24,620
and why this why is this happening this

237
00:12:21,410 --> 00:12:27,139
protocol is very similar to http sit

238
00:12:24,620 --> 00:12:29,389
bitches sent out a message what is the

239
00:12:27,139 --> 00:12:32,870
difference between a message sent by SI

240
00:12:29,389 --> 00:12:34,790
p videos and phone well if we analyze

241
00:12:32,870 --> 00:12:38,629
the message and as I say it's very

242
00:12:34,790 --> 00:12:43,490
similar to http p so here we see a user

243
00:12:38,629 --> 00:12:46,399
agent and in this case is fidel scanner

244
00:12:43,490 --> 00:12:47,749
and this is by default in suspicious and

245
00:12:46,399 --> 00:12:52,160
this is the first center has to be

246
00:12:47,749 --> 00:12:54,110
blocked as i remember i remember remind

247
00:12:52,160 --> 00:12:56,240
you that submissions is programming

248
00:12:54,110 --> 00:12:58,459
python if it is problem i phoned you

249
00:12:56,240 --> 00:13:01,370
have access to the source code and then

250
00:12:58,459 --> 00:13:04,998
if you have access you can change the

251
00:13:01,370 --> 00:13:08,420
agent and what happens if we change the

252
00:13:04,999 --> 00:13:11,059
user agent and we repeat the agent well

253
00:13:08,420 --> 00:13:13,009
we do we launch the map again and this

254
00:13:11,059 --> 00:13:15,069
time we can see that the switchboard is

255
00:13:13,009 --> 00:13:18,190
detected

256
00:13:15,070 --> 00:13:20,140
and once we have the switchboard if we

257
00:13:18,190 --> 00:13:22,300
take a look at these tensions we can see

258
00:13:20,140 --> 00:13:23,890
that these texts are also found well

259
00:13:22,300 --> 00:13:28,150
this time there is only one extension

260
00:13:23,890 --> 00:13:33,010
extension 200 and here we can look later

261
00:13:28,150 --> 00:13:35,020
we can scanned servers and well just by

262
00:13:33,010 --> 00:13:39,280
using a juicer agent which is not known

263
00:13:35,020 --> 00:13:42,040
as you see the device is not aware has

264
00:13:39,280 --> 00:13:44,589
not found us and no alerts having

265
00:13:42,040 --> 00:13:48,099
created if we launch the cracking of

266
00:13:44,590 --> 00:13:51,280
passwords through brute force it will

267
00:13:48,100 --> 00:13:54,580
block us because we will interpret it as

268
00:13:51,280 --> 00:13:58,750
a denial of service attack however when

269
00:13:54,580 --> 00:14:01,960
it comes to VoIP attacks even if there

270
00:13:58,750 --> 00:14:05,290
is an attempt to crack passwords through

271
00:14:01,960 --> 00:14:07,740
brute force this is not that much used

272
00:14:05,290 --> 00:14:12,160
it is a remote attack leaves lots of

273
00:14:07,740 --> 00:14:13,990
logs and it is easily blocked but

274
00:14:12,160 --> 00:14:17,069
actually when it comes to telephony

275
00:14:13,990 --> 00:14:21,600
floor there is an attempt to do

276
00:14:17,070 --> 00:14:25,450
telephone is without authentication if

277
00:14:21,600 --> 00:14:28,810
when we get a query cold if we do not

278
00:14:25,450 --> 00:14:31,000
ask the user to authenticate itself the

279
00:14:28,810 --> 00:14:35,290
telephony will go through and therefore

280
00:14:31,000 --> 00:14:37,360
we will lose money if we try whether the

281
00:14:35,290 --> 00:14:41,890
device is looking that are not the

282
00:14:37,360 --> 00:14:43,810
revenue tools to do it many tools to for

283
00:14:41,890 --> 00:14:46,780
this type of fraud I programmed and

284
00:14:43,810 --> 00:14:49,660
script and through data script I will

285
00:14:46,780 --> 00:14:52,750
send out them call query to the

286
00:14:49,660 --> 00:14:56,680
switchboard and I would say if that I am

287
00:14:52,750 --> 00:14:58,600
juicer 200 and this is the IP of the

288
00:14:56,680 --> 00:15:01,150
switchboards and I will ask you to cool

289
00:14:58,600 --> 00:15:04,000
that telephone number and then when I

290
00:15:01,150 --> 00:15:07,750
sent out the package I can see that it

291
00:15:04,000 --> 00:15:10,180
gives a return said try so it means that

292
00:15:07,750 --> 00:15:12,910
is trying it the call has not been

293
00:15:10,180 --> 00:15:17,040
denied there has not been rejected

294
00:15:12,910 --> 00:15:17,040
because they have a local environment

295
00:15:17,570 --> 00:15:23,980
I London again the device is not aware

296
00:15:21,440 --> 00:15:27,890
of what I did didn't notice what I did

297
00:15:23,980 --> 00:15:30,520
so here fingerprinting and the numbering

298
00:15:27,890 --> 00:15:35,270
of users we skipped it we just use a

299
00:15:30,520 --> 00:15:38,150
username which is not known and then the

300
00:15:35,270 --> 00:15:40,010
DRS I will put a question mark i would

301
00:15:38,150 --> 00:15:42,470
sell you more about it and then

302
00:15:40,010 --> 00:15:45,710
scripting well there are some problems

303
00:15:42,470 --> 00:15:48,800
there and then in terms of fraud

304
00:15:45,710 --> 00:15:51,230
detection I just made a phone call and

305
00:15:48,800 --> 00:15:53,750
the word dialing I made a phone call and

306
00:15:51,230 --> 00:15:56,270
then the device distant was not aware of

307
00:15:53,750 --> 00:15:58,490
it did not detect it so now you can draw

308
00:15:56,270 --> 00:16:01,100
your own conclusions about it and non-it

309
00:15:58,490 --> 00:16:04,400
is analyzes the security of the actual

310
00:16:01,100 --> 00:16:08,390
device and starting off with ssh panel

311
00:16:04,400 --> 00:16:10,939
so we saw before that the menu was quite

312
00:16:08,390 --> 00:16:15,790
reduced and we couldn't really do very

313
00:16:10,940 --> 00:16:15,790
many things and out of all these options

314
00:16:16,300 --> 00:16:21,500
do you think that the manufacturer has

315
00:16:19,160 --> 00:16:23,689
implemented an application doing or that

316
00:16:21,500 --> 00:16:26,090
if he were to do that that will be

317
00:16:23,690 --> 00:16:31,070
reinventing the wheel the system does

318
00:16:26,090 --> 00:16:34,430
all that so we assumed that they execute

319
00:16:31,070 --> 00:16:37,130
the system command for downloading

320
00:16:34,430 --> 00:16:41,599
firmware or for changing a password to

321
00:16:37,130 --> 00:16:43,760
name it and now the doubt is out of all

322
00:16:41,600 --> 00:16:46,070
these commands those that ask you to

323
00:16:43,760 --> 00:16:48,770
introduce a parameter are those

324
00:16:46,070 --> 00:16:52,280
parameters were filtered well let us

325
00:16:48,770 --> 00:16:56,300
take a look at it so we access through

326
00:16:52,280 --> 00:16:58,939
ssh and we are going to try some of

327
00:16:56,300 --> 00:17:00,650
those parameters that asked for comments

328
00:16:58,940 --> 00:17:03,740
are espero parameter if you launch a

329
00:17:00,650 --> 00:17:07,930
pimp and instead of writing on FB

330
00:17:03,740 --> 00:17:11,420
address we just write down and /

331
00:17:07,930 --> 00:17:13,520
asterisk it is doing a directory of the

332
00:17:11,420 --> 00:17:17,670
root

333
00:17:13,520 --> 00:17:19,740
and here we can just get a list of all

334
00:17:17,670 --> 00:17:22,380
the files in the system it is a bit

335
00:17:19,740 --> 00:17:24,449
tedious but we can reconstruct all the

336
00:17:22,380 --> 00:17:26,430
files in this system by using a command

337
00:17:24,449 --> 00:17:29,040
which is not has not been properly

338
00:17:26,430 --> 00:17:32,880
filtered and what do you think that it

339
00:17:29,040 --> 00:17:37,260
is behind this command for downloading

340
00:17:32,880 --> 00:17:40,140
member if instead of writing a URL if we

341
00:17:37,260 --> 00:17:43,770
write down management help okay we see

342
00:17:40,140 --> 00:17:46,800
that this is w wet get w get it's an

343
00:17:43,770 --> 00:17:48,690
application which gives us lots of room

344
00:17:46,800 --> 00:17:51,720
so instead of saying that we want to

345
00:17:48,690 --> 00:17:54,450
disco download URL we say that we want

346
00:17:51,720 --> 00:17:56,910
to download a set of URLs that are

347
00:17:54,450 --> 00:18:00,750
included in a file we do that through

348
00:17:56,910 --> 00:18:03,510
minus input file it's XD file that we

349
00:18:00,750 --> 00:18:05,550
gave it it tries to read each of the

350
00:18:03,510 --> 00:18:09,990
lines and thinking that it is a valid

351
00:18:05,550 --> 00:18:13,649
URL and then with that April we get the

352
00:18:09,990 --> 00:18:16,740
full line it is a bit tedious but if we

353
00:18:13,650 --> 00:18:19,170
use the null parsing or the bad parsing

354
00:18:16,740 --> 00:18:22,220
of command we can reconstruct the file

355
00:18:19,170 --> 00:18:25,380
system and we can end up reading any

356
00:18:22,220 --> 00:18:28,670
file in the system well this is very

357
00:18:25,380 --> 00:18:37,410
interesting we can play around with it

358
00:18:28,670 --> 00:18:40,260
but actually as a tree is not being SCP

359
00:18:37,410 --> 00:18:43,350
is not being filtered so therefore we

360
00:18:40,260 --> 00:18:46,920
can downloaded it we can turn fully

361
00:18:43,350 --> 00:18:50,370
downloaded to our machine and to take

362
00:18:46,920 --> 00:18:54,600
our time to analyze it when it comes to

363
00:18:50,370 --> 00:18:56,689
Deep Web panel there are some comments

364
00:18:54,600 --> 00:18:59,340
here that I believe that are also

365
00:18:56,690 --> 00:19:02,070
interacting with the operating system

366
00:18:59,340 --> 00:19:05,550
which is the ping command around command

367
00:19:02,070 --> 00:19:08,610
and here Pink accepts to two parameter

368
00:19:05,550 --> 00:19:13,740
which is the husband con and other well

369
00:19:08,610 --> 00:19:16,800
filters if if these parameters are not

370
00:19:13,740 --> 00:19:20,280
being filtered we will have we will be

371
00:19:16,800 --> 00:19:26,870
able to filter system commands for that

372
00:19:20,280 --> 00:19:26,870
we will help use boot which is a proxy

373
00:19:27,440 --> 00:19:35,399
and we will try to inject it in the

374
00:19:30,149 --> 00:19:38,340
hospital we will not be seeing a

375
00:19:35,399 --> 00:19:42,360
response so what we are doing because

376
00:19:38,340 --> 00:19:45,720
these commands will be executed in the

377
00:19:42,360 --> 00:19:50,699
background the work will not display the

378
00:19:45,720 --> 00:19:54,000
result if you really want to do that you

379
00:19:50,700 --> 00:19:57,659
can do a reboot if you see that your

380
00:19:54,000 --> 00:20:02,850
machine oh the device reboots means that

381
00:19:57,659 --> 00:20:05,580
and has found a commanding jection sober

382
00:20:02,850 --> 00:20:07,559
see if it does not reboot it does not

383
00:20:05,580 --> 00:20:12,029
upload here we can see that we can

384
00:20:07,559 --> 00:20:16,500
execute commands by executing in the

385
00:20:12,029 --> 00:20:20,580
hospital a meter of pink and well what

386
00:20:16,500 --> 00:20:23,399
about reading the answer well if we

387
00:20:20,580 --> 00:20:25,678
enter anything you will run in the

388
00:20:23,399 --> 00:20:27,090
background and we don't know what is

389
00:20:25,679 --> 00:20:29,039
happening we cannot see what is

390
00:20:27,090 --> 00:20:30,840
happening to execute the response that

391
00:20:29,039 --> 00:20:33,600
are two things that we can do we can

392
00:20:30,840 --> 00:20:36,600
read files with wks and we can ask you

393
00:20:33,600 --> 00:20:38,789
to send it to a machine where we come

394
00:20:36,600 --> 00:20:41,879
from well we can listen that is to say

395
00:20:38,789 --> 00:20:44,789
we start the net cup in our computer in

396
00:20:41,880 --> 00:20:49,590
the port 80 like if you were a web

397
00:20:44,789 --> 00:20:52,950
server and then we will inject doublju

398
00:20:49,590 --> 00:20:55,610
gets through the parameter minus minus

399
00:20:52,950 --> 00:20:58,140
Potter file we would ask you to read

400
00:20:55,610 --> 00:21:09,570
file system and then we will ask you to

401
00:20:58,140 --> 00:21:14,570
send it out to our IP address in this

402
00:21:09,570 --> 00:21:14,570
case I get the DC password

403
00:21:14,860 --> 00:21:21,340
and then we asked you to send out the

404
00:21:17,500 --> 00:21:25,120
output to our IP address if we look at

405
00:21:21,340 --> 00:21:31,030
it later on our console here we will

406
00:21:25,120 --> 00:21:35,649
have the file output well it continues

407
00:21:31,030 --> 00:21:38,350
to be a bit tedious and to autumn I make

408
00:21:35,650 --> 00:21:42,910
it a bit more automatic we will repeat

409
00:21:38,350 --> 00:21:46,990
the process doing a recursive process so

410
00:21:42,910 --> 00:21:49,720
that we can find the root of the web we

411
00:21:46,990 --> 00:21:53,679
execute the commands we redirect the

412
00:21:49,720 --> 00:21:56,470
output to a file and then we will then

413
00:21:53,679 --> 00:22:00,669
load it with a double your cast and for

414
00:21:56,470 --> 00:22:02,530
that high creation script then I give

415
00:22:00,669 --> 00:22:04,480
two parameters to it first of all the

416
00:22:02,530 --> 00:22:07,389
comment that I want to execute and the

417
00:22:04,480 --> 00:22:09,510
second 10 or 1 depending on whether i am

418
00:22:07,390 --> 00:22:12,780
expecting I wanted to give me an

419
00:22:09,510 --> 00:22:15,850
response or not script is very simple

420
00:22:12,780 --> 00:22:21,820
what I do is log in to get the cookie

421
00:22:15,850 --> 00:22:24,879
then I execute her to injecting King

422
00:22:21,820 --> 00:22:28,240
which is the vulnerable file if I expect

423
00:22:24,880 --> 00:22:30,700
apple I do another one for the output

424
00:22:28,240 --> 00:22:34,059
and then I do a log out it will be as

425
00:22:30,700 --> 00:22:38,500
easy as this this is much faster much

426
00:22:34,059 --> 00:22:42,309
more convenient when we accessed through

427
00:22:38,500 --> 00:22:45,700
a tube SSH we got a menu but who start

428
00:22:42,309 --> 00:22:48,820
start menu so here we can see that the

429
00:22:45,700 --> 00:22:53,500
menu is stated here this is an app

430
00:22:48,820 --> 00:22:56,200
mainly and if we remove we rename the

431
00:22:53,500 --> 00:22:59,590
file by the time we will access through

432
00:22:56,200 --> 00:23:01,600
ssh the slinky will not be executed and

433
00:22:59,590 --> 00:23:03,580
therefore we will have access to the

434
00:23:01,600 --> 00:23:06,100
commands interface that's what we want

435
00:23:03,580 --> 00:23:12,520
to get at to play around with it we

436
00:23:06,100 --> 00:23:17,549
rename it then we access through ssh and

437
00:23:12,520 --> 00:23:17,549
then we gain access to the whole system

438
00:23:26,010 --> 00:23:41,140
good be that SSH is not enabled in this

439
00:23:33,160 --> 00:23:42,940
device if SSH is disabled we can enable

440
00:23:41,140 --> 00:23:44,980
it just by changing one of the values in

441
00:23:42,940 --> 00:23:47,260
the database and then by executing a

442
00:23:44,980 --> 00:23:48,850
command because we can execute a man

443
00:23:47,260 --> 00:23:51,220
through the web panel we can do that

444
00:23:48,850 --> 00:23:54,070
with no problem and if we do not know

445
00:23:51,220 --> 00:23:57,460
the access password to access through

446
00:23:54,070 --> 00:23:59,559
ssh the same thing if you have access to

447
00:23:57,460 --> 00:24:03,160
the command interface we can create our

448
00:23:59,559 --> 00:24:10,059
own personalized the user pass route and

449
00:24:03,160 --> 00:24:11,800
then to access through it and now is out

450
00:24:10,059 --> 00:24:16,240
of curiosity I'll tell you what it

451
00:24:11,800 --> 00:24:19,960
happens but if perhaps for other devices

452
00:24:16,240 --> 00:24:22,240
and what happens if you are in the

453
00:24:19,960 --> 00:24:24,490
device where you cannot access through

454
00:24:22,240 --> 00:24:26,440
ssh how did you gain access to the

455
00:24:24,490 --> 00:24:27,910
console so first of all it would be a

456
00:24:26,440 --> 00:24:30,370
question of taking a look at the

457
00:24:27,910 --> 00:24:32,470
architecture of your device and here we

458
00:24:30,370 --> 00:24:35,919
can compile a net cut for this

459
00:24:32,470 --> 00:24:38,080
architecture unless it is already

460
00:24:35,920 --> 00:24:41,230
available in the system but this is not

461
00:24:38,080 --> 00:24:43,480
the case so therefore I download the net

462
00:24:41,230 --> 00:24:48,190
cards for each i compile it in my

463
00:24:43,480 --> 00:24:51,040
machine and then I upload it so to try

464
00:24:48,190 --> 00:24:54,070
it on that device in this case there are

465
00:24:51,040 --> 00:24:56,920
very many firewall firewall rules that

466
00:24:54,070 --> 00:24:58,570
is blocking the connection then I will

467
00:24:56,920 --> 00:25:00,940
take advantage of the script that I have

468
00:24:58,570 --> 00:25:04,030
to run the commands through the web

469
00:25:00,940 --> 00:25:11,700
panel I'm going to delete all the

470
00:25:04,030 --> 00:25:16,928
firewall rules we delete the entry

471
00:25:11,700 --> 00:25:19,300
exceeds the rules we check that all the

472
00:25:16,929 --> 00:25:22,840
rules have been deleted that everything

473
00:25:19,300 --> 00:25:27,909
is clean and then we use W gets to

474
00:25:22,840 --> 00:25:31,030
download net cards so we connected with

475
00:25:27,910 --> 00:25:36,240
our machine the binary is

476
00:25:31,030 --> 00:25:43,270
download it then we will give it run

477
00:25:36,240 --> 00:25:46,300
permissions and then we run it I run it

478
00:25:43,270 --> 00:25:48,310
on port if I have someone and then from

479
00:25:46,300 --> 00:25:51,970
my machine I would do net cuts to that

480
00:25:48,310 --> 00:25:54,909
part therefore then we'll get into the

481
00:25:51,970 --> 00:25:57,370
system that's the way you do it when you

482
00:25:54,910 --> 00:25:59,020
do not have ssh access well here do you

483
00:25:57,370 --> 00:26:02,139
see that we have different ways to

484
00:25:59,020 --> 00:26:04,600
access to the device different ways to

485
00:26:02,140 --> 00:26:10,270
do it through the web through ssh once

486
00:26:04,600 --> 00:26:12,879
we are in if we analyze deep database oh

487
00:26:10,270 --> 00:26:15,550
sorry excuse me if we analyse the

488
00:26:12,880 --> 00:26:16,780
website we can see the failure of sequel

489
00:26:15,550 --> 00:26:19,750
injection that we saw in the beginning

490
00:26:16,780 --> 00:26:22,180
as you can see this is using the main

491
00:26:19,750 --> 00:26:25,390
parameter which is the user and it is

492
00:26:22,180 --> 00:26:27,630
introducing it right away in SQL without

493
00:26:25,390 --> 00:26:33,090
making any parsing with no parsing

494
00:26:27,630 --> 00:26:36,070
therefore well this that's what it is is

495
00:26:33,090 --> 00:26:38,980
explaining the manuals and then we're

496
00:26:36,070 --> 00:26:43,090
gonna take a look at the authentication

497
00:26:38,980 --> 00:26:46,240
file and then from there we end up in a

498
00:26:43,090 --> 00:26:50,500
database so you may notice that database

499
00:26:46,240 --> 00:26:54,700
can be accessed from the web well we can

500
00:26:50,500 --> 00:26:56,830
say there are some something there so

501
00:26:54,700 --> 00:26:59,680
that I just don't go there I just type

502
00:26:56,830 --> 00:27:02,439
in the URL and then then fully download

503
00:26:59,680 --> 00:27:04,630
the database no that's not the way it is

504
00:27:02,440 --> 00:27:07,560
I don't need to authenticate myself I

505
00:27:04,630 --> 00:27:11,430
just enter the URL and then I can load

506
00:27:07,560 --> 00:27:14,620
database and the database includes the

507
00:27:11,430 --> 00:27:17,740
user hash to access but this is not the

508
00:27:14,620 --> 00:27:25,989
worst I wouldn't even have to crack that

509
00:27:17,740 --> 00:27:27,910
password if we take a look at it we see

510
00:27:25,990 --> 00:27:31,150
that from the index to the logging in

511
00:27:27,910 --> 00:27:33,610
the authentication process it is center

512
00:27:31,150 --> 00:27:36,190
sends out the password the user in clear

513
00:27:33,610 --> 00:27:39,070
and then he also sending out a hash and

514
00:27:36,190 --> 00:27:41,760
the hash is the password that has been

515
00:27:39,070 --> 00:27:44,340
already been generated

516
00:27:41,760 --> 00:27:51,480
and if we noticed in the source code we

517
00:27:44,340 --> 00:27:54,720
see Dad it checks it tries to match the

518
00:27:51,480 --> 00:27:58,560
hash that I am sending us with a hash of

519
00:27:54,720 --> 00:28:00,840
the database so so the usual thing is

520
00:27:58,560 --> 00:28:04,940
that I said the username the password

521
00:28:00,840 --> 00:28:07,740
and that matches it with that of the

522
00:28:04,940 --> 00:28:10,140
database but this time it is matching it

523
00:28:07,740 --> 00:28:11,910
with the hashtag that i have read from

524
00:28:10,140 --> 00:28:13,980
the index imagine that i found this

525
00:28:11,910 --> 00:28:16,740
device out there I don't know what is

526
00:28:13,980 --> 00:28:19,680
the password I just enter whatever for

527
00:28:16,740 --> 00:28:21,930
instance an X letter and if I try to

528
00:28:19,680 --> 00:28:30,180
login they're gonna say well wrong

529
00:28:21,930 --> 00:28:32,670
credentials so far so good and because I

530
00:28:30,180 --> 00:28:35,460
know which is the route to get to the

531
00:28:32,670 --> 00:28:38,250
database I just uploaded and downloaded

532
00:28:35,460 --> 00:28:40,740
hi download the data base in my machine

533
00:28:38,250 --> 00:28:48,600
and it will not be asking me with not

534
00:28:40,740 --> 00:29:02,820
ask me for any authentication once I

535
00:28:48,600 --> 00:29:05,280
download the database we go to the web

536
00:29:02,820 --> 00:29:08,610
user table and then we find the admin

537
00:29:05,280 --> 00:29:12,540
user and then the password then five and

538
00:29:08,610 --> 00:29:15,689
then we copy that password we go back to

539
00:29:12,540 --> 00:29:23,190
the website and then we repeat the

540
00:29:15,690 --> 00:29:26,340
authentication process again to

541
00:29:23,190 --> 00:29:28,560
authenticate myself I enter any password

542
00:29:26,340 --> 00:29:32,220
because of Domino the right password

543
00:29:28,560 --> 00:29:37,770
that just enter X and then when we have

544
00:29:32,220 --> 00:29:41,130
this hash I cut I paste one that I

545
00:29:37,770 --> 00:29:43,710
hadn't one of the database and this

546
00:29:41,130 --> 00:29:48,120
takes me right into the panel I didn't

547
00:29:43,710 --> 00:29:52,050
even had to crack the password what I

548
00:29:48,120 --> 00:29:52,860
mean is just summarizing I find one of

549
00:29:52,050 --> 00:29:55,830
these things

550
00:29:52,860 --> 00:29:58,139
around I download the database i work

551
00:29:55,830 --> 00:30:01,830
with lead i have access to the dashboard

552
00:29:58,140 --> 00:30:04,320
with m5 no net to crack it and there

553
00:30:01,830 --> 00:30:08,100
you've got a command injection through I

554
00:30:04,320 --> 00:30:12,840
don't know the pins side once I have it

555
00:30:08,100 --> 00:30:16,290
I can build my own user and name with

556
00:30:12,840 --> 00:30:17,970
admin privileges i removed extension and

557
00:30:16,290 --> 00:30:22,110
i have the dashboard and can do anything

558
00:30:17,970 --> 00:30:25,740
I want well boys a note Rosa videos que

559
00:30:22,110 --> 00:30:27,840
en esta perdido million using a few more

560
00:30:25,740 --> 00:30:33,570
things well I found this very

561
00:30:27,840 --> 00:30:35,939
interesting it was an 88 UDP port oh I

562
00:30:33,570 --> 00:30:39,649
started looking around and see who was

563
00:30:35,940 --> 00:30:44,309
recognized dead and these are started by

564
00:30:39,650 --> 00:30:47,700
STM I info serve which is a appropriate

565
00:30:44,309 --> 00:30:50,700
proprietary by the manufacturer and I

566
00:30:47,700 --> 00:30:54,809
use I da to check out what it would do

567
00:30:50,700 --> 00:30:58,470
and and you can see it is waiting for

568
00:30:54,809 --> 00:31:00,870
some package to be there and depending

569
00:30:58,470 --> 00:31:03,510
on what you send it will do one thing or

570
00:31:00,870 --> 00:31:06,030
the next so this is so what it does it's

571
00:31:03,510 --> 00:31:10,169
a sniffing and the minute we send

572
00:31:06,030 --> 00:31:12,928
something to that UDP port it throws

573
00:31:10,169 --> 00:31:14,730
back the local interface date unknown it

574
00:31:12,929 --> 00:31:16,679
to your Thunder gate ourselves and just

575
00:31:14,730 --> 00:31:19,770
live and we can know what the network

576
00:31:16,679 --> 00:31:22,080
address can be but if we throw sad it

577
00:31:19,770 --> 00:31:26,549
keeps waiting for us to send another

578
00:31:22,080 --> 00:31:28,918
package and if we set IP / and retina

579
00:31:26,549 --> 00:31:31,620
and network mask and then address we

580
00:31:28,919 --> 00:31:33,360
will change the device address no need

581
00:31:31,620 --> 00:31:36,809
to authenticate ourselves or anything of

582
00:31:33,360 --> 00:31:39,418
the kind allegedly I say because it

583
00:31:36,809 --> 00:31:41,760
doesn't work I've tried it and this

584
00:31:39,419 --> 00:31:44,970
thing it would stop the network device

585
00:31:41,760 --> 00:31:48,150
it changes the address that I use but

586
00:31:44,970 --> 00:31:52,740
then it doesn't start it's dead dead and

587
00:31:48,150 --> 00:31:54,780
you know what that means and so as we

588
00:31:52,740 --> 00:31:56,730
said before with the features you see

589
00:31:54,780 --> 00:31:58,860
denial of service can be crossed out

590
00:31:56,730 --> 00:32:04,110
because just one package and it's

591
00:31:58,860 --> 00:32:06,129
offline so what else once we have access

592
00:32:04,110 --> 00:32:12,639
to it what else can we do

593
00:32:06,130 --> 00:32:15,280
so mine clean you remember these up the

594
00:32:12,640 --> 00:32:20,680
sir when we gain access through or via

595
00:32:15,280 --> 00:32:22,240
ssh so the start and script for this if

596
00:32:20,680 --> 00:32:25,150
you check it out through something quite

597
00:32:22,240 --> 00:32:28,750
funny and it would be this theme here so

598
00:32:25,150 --> 00:32:30,550
we sent help and that's not there and if

599
00:32:28,750 --> 00:32:32,620
we see that that's what it dance and

600
00:32:30,550 --> 00:32:35,980
it's not there you see there's a binary

601
00:32:32,620 --> 00:32:38,560
ran six login if it returns 0 it would

602
00:32:35,980 --> 00:32:41,350
be a comment interface otherwise it says

603
00:32:38,560 --> 00:32:44,620
credentials are wrong and as a matter of

604
00:32:41,350 --> 00:32:48,310
fact that we try it even if we see six

605
00:32:44,620 --> 00:32:51,699
login it's not in the helper text it is

606
00:32:48,310 --> 00:32:56,260
there so this would advise that cost us

607
00:32:51,700 --> 00:32:58,960
two hundred bucks 18 about again iida

608
00:32:56,260 --> 00:33:05,050
see what it does and we see it's quite

609
00:32:58,960 --> 00:33:07,510
simple add asking for password and then

610
00:33:05,050 --> 00:33:11,409
what it does is check out the password

611
00:33:07,510 --> 00:33:17,280
against a hash that it's hard court copy

612
00:33:11,410 --> 00:33:20,260
it into the binary this sh1 cinsault and

613
00:33:17,280 --> 00:33:27,460
with this table do you just whip crack

614
00:33:20,260 --> 00:33:30,730
the password it is all small letters

615
00:33:27,460 --> 00:33:33,880
it's nine small letters and so this is a

616
00:33:30,730 --> 00:33:35,590
device and you have a command interface

617
00:33:33,880 --> 00:33:37,840
like route that we cannot block we

618
00:33:35,590 --> 00:33:40,510
cannot change the password well at least

619
00:33:37,840 --> 00:33:42,730
they should go for it a buster the

620
00:33:40,510 --> 00:33:48,370
password shouldn t and if we run out we

621
00:33:42,730 --> 00:33:51,130
will see that it works it does work once

622
00:33:48,370 --> 00:33:52,959
we have access to the hold advanced we

623
00:33:51,130 --> 00:33:57,120
can also see how the firmware is

624
00:33:52,960 --> 00:34:00,730
encrypted so let me remind you since

625
00:33:57,120 --> 00:34:03,219
mainly from mine play we could have a

626
00:34:00,730 --> 00:34:06,400
firmware update and that is because

627
00:34:03,220 --> 00:34:08,320
there is the encryption software and so

628
00:34:06,400 --> 00:34:10,899
we go to the file and we check out

629
00:34:08,320 --> 00:34:14,050
everything that we need we just replace

630
00:34:10,899 --> 00:34:16,960
it and we can have our own

631
00:34:14,050 --> 00:34:22,240
uh pain and what's the kind of it all

632
00:34:16,960 --> 00:34:27,490
well this way we can update a firmware

633
00:34:22,239 --> 00:34:30,699
update we can have our own customized

634
00:34:27,489 --> 00:34:33,310
firmware with a president side so to say

635
00:34:30,699 --> 00:34:35,739
encrypted with the manufacturers keys

636
00:34:33,310 --> 00:34:39,429
and we can have a beautiful but net

637
00:34:35,739 --> 00:34:42,189
network for example after finding out

638
00:34:39,429 --> 00:34:44,639
about it all well it was quite

639
00:34:42,190 --> 00:34:47,200
entertaining and many things can be done

640
00:34:44,639 --> 00:34:50,830
because a matter of fact since I

641
00:34:47,199 --> 00:34:52,779
manufacturer had given me the device for

642
00:34:50,830 --> 00:34:54,190
free I think it would do it would be

643
00:34:52,780 --> 00:34:56,350
advisable to let them know what was

644
00:34:54,190 --> 00:34:58,180
going on so I contacted them to let them

645
00:34:56,350 --> 00:35:00,640
know if we were if they were interested

646
00:34:58,180 --> 00:35:03,669
in a summary they said yes and mid july

647
00:35:00,640 --> 00:35:06,700
this year i sent all the fails that i

648
00:35:03,670 --> 00:35:09,970
found on the bags and i suggested a

649
00:35:06,700 --> 00:35:13,060
security audit urgently the reply was

650
00:35:09,970 --> 00:35:15,520
thank you very much for thee now here's

651
00:35:13,060 --> 00:35:18,910
my notice they would look into it and

652
00:35:15,520 --> 00:35:21,700
who knows maybe they would do it animal

653
00:35:18,910 --> 00:35:24,129
later the manufacture Kentucky State me

654
00:35:21,700 --> 00:35:27,310
back and said that they've repaired it

655
00:35:24,130 --> 00:35:31,150
all that they would send me new devices

656
00:35:27,310 --> 00:35:35,230
that would be the version 2 on dot oh

657
00:35:31,150 --> 00:35:36,790
and I think it is an insult not for me

658
00:35:35,230 --> 00:35:40,960
but for the users who've spent their

659
00:35:36,790 --> 00:35:43,720
money such a large company cannot afford

660
00:35:40,960 --> 00:35:46,150
a security audit and they want me to

661
00:35:43,720 --> 00:35:47,799
look into it free of charge again since

662
00:35:46,150 --> 00:35:52,780
it is free of charge i said yes i send

663
00:35:47,800 --> 00:35:55,300
it to me and a month later I got the

664
00:35:52,780 --> 00:35:58,630
device all the way from India first

665
00:35:55,300 --> 00:36:02,230
slide just it's a new box or shell bit

666
00:35:58,630 --> 00:36:05,440
more compact it's moved to a RM I don't

667
00:36:02,230 --> 00:36:08,170
really understand why this has an

668
00:36:05,440 --> 00:36:12,190
unstable distribution taken another

669
00:36:08,170 --> 00:36:14,290
device it is and so I go online and 10

670
00:36:12,190 --> 00:36:16,450
minutes later I send this is not shot

671
00:36:14,290 --> 00:36:18,730
back to the manufacturer me only 10

672
00:36:16,450 --> 00:36:21,939
minutes to reroute it again

673
00:36:18,730 --> 00:36:24,850
again I say go for a security audit this

674
00:36:21,940 --> 00:36:27,700
is shameful but they do not feel like

675
00:36:24,850 --> 00:36:30,069
and using money and they only interested

676
00:36:27,700 --> 00:36:32,259
in knowing how I cracked in this time

677
00:36:30,070 --> 00:36:34,060
around they must be formed same place

678
00:36:32,260 --> 00:36:38,740
different parameters I say you've got a

679
00:36:34,060 --> 00:36:40,660
man injection on the host parameter so

680
00:36:38,740 --> 00:36:46,379
check home as well because if you've

681
00:36:40,660 --> 00:36:49,629
done just the same you know so this

682
00:36:46,380 --> 00:36:53,280
everything L had been solved it they

683
00:36:49,630 --> 00:36:58,810
were lying per line and patched it all

684
00:36:53,280 --> 00:37:01,000
problem is these well you see I found

685
00:36:58,810 --> 00:37:02,770
another command injection but I cannot

686
00:37:01,000 --> 00:37:05,800
have access to the dashboard with that a

687
00:37:02,770 --> 00:37:08,200
password and it cannot download and loud

688
00:37:05,800 --> 00:37:13,540
load the database either but I looked

689
00:37:08,200 --> 00:37:20,140
deeper into the device and does it

690
00:37:13,540 --> 00:37:21,759
happens on the website their part where

691
00:37:20,140 --> 00:37:23,500
the session variable is not checked so

692
00:37:21,760 --> 00:37:25,720
we can run part of the website without

693
00:37:23,500 --> 00:37:28,540
being authenticated and funny is that

694
00:37:25,720 --> 00:37:35,310
the backup file for the user database

695
00:37:28,540 --> 00:37:39,369
does not check the session variable so

696
00:37:35,310 --> 00:37:42,730
get it and I can download the encrypted

697
00:37:39,369 --> 00:37:45,250
database for users it is encrypted by

698
00:37:42,730 --> 00:37:48,040
the encryption codes are the same as

699
00:37:45,250 --> 00:37:50,410
with the previous device so you see I've

700
00:37:48,040 --> 00:37:52,600
done loaded and once again i have d

701
00:37:50,410 --> 00:37:55,660
database for the whole device this time

702
00:37:52,600 --> 00:37:58,000
around i will net to crack the password

703
00:37:55,660 --> 00:38:00,069
but it is all a matter of time and

704
00:37:58,000 --> 00:38:02,609
taking into account the kind of a

705
00:38:00,070 --> 00:38:06,400
passwords they use it won't take me long

706
00:38:02,609 --> 00:38:08,500
if we take a few more files on the

707
00:38:06,400 --> 00:38:10,180
wonders on the web side we see there are

708
00:38:08,500 --> 00:38:12,369
few more that do not check the session

709
00:38:10,180 --> 00:38:16,118
variables and for this kind of divine

710
00:38:12,369 --> 00:38:19,390
says they only take one admin rights

711
00:38:16,119 --> 00:38:21,160
they cannot be two people connected to

712
00:38:19,390 --> 00:38:23,259
the switchboard at the same time and

713
00:38:21,160 --> 00:38:25,930
this is a file for the user doesn't

714
00:38:23,260 --> 00:38:29,230
check the session variable either so if

715
00:38:25,930 --> 00:38:29,740
we run this we can kick out any user the

716
00:38:29,230 --> 00:38:32,260
list

717
00:38:29,740 --> 00:38:35,140
and if I put it into a loop you know

718
00:38:32,260 --> 00:38:39,220
what it happens more fires are do not

719
00:38:35,140 --> 00:38:43,618
check the session available this is the

720
00:38:39,220 --> 00:38:47,069
one download of the whole system

721
00:38:43,619 --> 00:38:51,700
configuration or set up all the alert

722
00:38:47,070 --> 00:38:55,150
warnings in the device and if we go

723
00:38:51,700 --> 00:38:56,890
deeper into the web switch board you see

724
00:38:55,150 --> 00:39:00,160
there are a few more places where there

725
00:38:56,890 --> 00:39:02,560
is an interaction with the system like

726
00:39:00,160 --> 00:39:04,029
this we can change the hostname I don't

727
00:39:02,560 --> 00:39:05,080
know what for because we are not

728
00:39:04,030 --> 00:39:06,700
supposed to have access to the

729
00:39:05,080 --> 00:39:09,640
switchboard on anything else dashboard

730
00:39:06,700 --> 00:39:13,450
sorry or anything else Vander blue there

731
00:39:09,640 --> 00:39:17,230
it is as it's all programmed the same

732
00:39:13,450 --> 00:39:21,669
word of since we had a command injection

733
00:39:17,230 --> 00:39:23,230
before we will still have it and the

734
00:39:21,670 --> 00:39:25,720
house name is something that changes

735
00:39:23,230 --> 00:39:28,420
when we reboot the Divine's what could

736
00:39:25,720 --> 00:39:30,879
happen if i were to inject a reboot into

737
00:39:28,420 --> 00:39:33,160
a command that is running when there is

738
00:39:30,880 --> 00:39:39,520
every bit of governor what do you think

739
00:39:33,160 --> 00:39:42,250
will happen the device moves into our

740
00:39:39,520 --> 00:39:45,630
way starting loop and I had to reset it

741
00:39:42,250 --> 00:39:48,490
on I had to reflash it I actually

742
00:39:45,630 --> 00:39:51,760
suspected it and I had a firmware backup

743
00:39:48,490 --> 00:39:53,529
otherwise you now would be using device

744
00:39:51,760 --> 00:39:55,150
us a paperweight because the

745
00:39:53,530 --> 00:39:56,950
manufacturer does not give you the whole

746
00:39:55,150 --> 00:40:01,570
framework but it well you know quite a

747
00:39:56,950 --> 00:40:05,319
disaster problem here is that there is a

748
00:40:01,570 --> 00:40:06,670
new version developed now we're what

749
00:40:05,320 --> 00:40:08,920
they've changed the architecture I don't

750
00:40:06,670 --> 00:40:12,130
really know why but what about those

751
00:40:08,920 --> 00:40:14,790
customers that have first version will

752
00:40:12,130 --> 00:40:18,100
this all be sorted out I don't think so

753
00:40:14,790 --> 00:40:19,990
because if in August everything was

754
00:40:18,100 --> 00:40:22,600
already sorted out according to what

755
00:40:19,990 --> 00:40:26,109
they said and we see that for the last

756
00:40:22,600 --> 00:40:27,490
update the date is done right that means

757
00:40:26,109 --> 00:40:30,100
I did didn't take the time to correct

758
00:40:27,490 --> 00:40:32,709
the problem i mentioned honestly what I

759
00:40:30,100 --> 00:40:34,810
think happened is that when I sent them

760
00:40:32,710 --> 00:40:38,050
my warning with everything that i have

761
00:40:34,810 --> 00:40:40,100
found they already had the second

762
00:40:38,050 --> 00:40:43,250
version ready it was invaded

763
00:40:40,100 --> 00:40:44,569
of stage so they had their own device

764
00:40:43,250 --> 00:40:47,480
with the New York attack sure everything

765
00:40:44,570 --> 00:40:51,590
was new all running so they were a bad

766
00:40:47,480 --> 00:40:53,510
team release it and with my warning

767
00:40:51,590 --> 00:40:55,820
email well that was perfect too great a

768
00:40:53,510 --> 00:40:58,520
few things that's all they did they went

769
00:40:55,820 --> 00:41:00,200
line by line prompt by trumped trying to

770
00:40:58,520 --> 00:41:04,759
sort out all those things that I

771
00:41:00,200 --> 00:41:07,160
suggested but it doesn't see that they

772
00:41:04,760 --> 00:41:13,700
will be patching the previous version

773
00:41:07,160 --> 00:41:17,899
the old one so completion sometimes

774
00:41:13,700 --> 00:41:21,799
they're very good ideas this one I find

775
00:41:17,900 --> 00:41:24,770
it great if I'm how I'm supposed to have

776
00:41:21,800 --> 00:41:27,410
a system that is open to everyone and it

777
00:41:24,770 --> 00:41:30,350
cannot filter IPS but if I can control

778
00:41:27,410 --> 00:41:33,649
the whole traffic and I can say this is

779
00:41:30,350 --> 00:41:35,600
good this is bad or then sick shield

780
00:41:33,650 --> 00:41:38,780
myself against attacks that Ruby ideal

781
00:41:35,600 --> 00:41:41,210
but we really need to analyze not just

782
00:41:38,780 --> 00:41:45,970
functionality and usability but also the

783
00:41:41,210 --> 00:41:48,320
security of this device itself this case

784
00:41:45,970 --> 00:41:50,509
this isn't a device that it's supposed

785
00:41:48,320 --> 00:41:52,820
to block out all the packages you might

786
00:41:50,510 --> 00:41:56,390
switch board and still it allows someone

787
00:41:52,820 --> 00:41:58,700
to have access to the whole device to

788
00:41:56,390 --> 00:42:01,310
the command dashboard as a route and

789
00:41:58,700 --> 00:42:03,080
once inside you have access to it all

790
00:42:01,310 --> 00:42:05,480
there is nothing in between you can

791
00:42:03,080 --> 00:42:09,430
monitor traffic you can steal passwords

792
00:42:05,480 --> 00:42:09,430
and do anything you want

793
00:42:10,200 --> 00:42:15,629
and I think I'm ahead of time and well

794
00:42:13,800 --> 00:42:18,680
soon that's been it thank you very much

795
00:42:15,630 --> 00:42:18,680
you better any questions

796
00:42:21,780 --> 00:42:34,239
[Applause]

797
00:42:35,850 --> 00:42:48,279
we're not burnt down are there any

798
00:42:41,920 --> 00:42:56,650
questions so lead on purpose what we

799
00:42:48,280 --> 00:42:59,440
mean on purpose yes the back door that's

800
00:42:56,650 --> 00:43:05,500
for sure but these many mistakes I don't

801
00:42:59,440 --> 00:43:07,750
think so actually the second defiance

802
00:43:05,500 --> 00:43:10,960
had brought here that the orange one I

803
00:43:07,750 --> 00:43:13,840
cannot certify whether it has any fails

804
00:43:10,960 --> 00:43:16,450
or backs they're already books for

805
00:43:13,840 --> 00:43:18,970
managing it and I can say their main

806
00:43:16,450 --> 00:43:21,730
users already and I've given this

807
00:43:18,970 --> 00:43:23,290
presentation on a voice IP presentation

808
00:43:21,730 --> 00:43:25,450
where the owner of the company was

809
00:43:23,290 --> 00:43:29,710
attending and he was from South America

810
00:43:25,450 --> 00:43:39,640
and just the same there is you know they

811
00:43:29,710 --> 00:43:44,170
are so passive it's impressive any more

812
00:43:39,640 --> 00:43:44,970
questions no more questions so thank you

813
00:43:44,170 --> 00:43:51,340
very much for being

814
00:43:44,970 --> 00:43:51,339
[Applause]

