1
00:00:17,080 --> 00:00:27,189
I'll surely introduce myself hi I'm

2
00:00:19,450 --> 00:00:31,479
Gemma Garcia I'm a member and co-founder

3
00:00:27,189 --> 00:00:33,540
of Siebert the spanish cybersecurity

4
00:00:31,480 --> 00:00:37,120
think-tank of the first one in Spain

5
00:00:33,540 --> 00:00:41,620
I've spent 10 15 years I got remotely

6
00:00:37,120 --> 00:00:46,089
how long on cybersecurity I started as a

7
00:00:41,620 --> 00:00:49,650
developer I've progressed and now I'm

8
00:00:46,089 --> 00:00:49,650
more on the defensive side of things

9
00:00:51,900 --> 00:01:10,750
something that needs to be taken account

10
00:00:54,489 --> 00:01:13,229
especially when we're attacked when you

11
00:01:10,750 --> 00:01:16,270
have an incident in your organization

12
00:01:13,229 --> 00:01:19,570
and different scenarios are possible

13
00:01:16,270 --> 00:01:24,390
let's imagine that somebody detects an

14
00:01:19,570 --> 00:01:27,520
anomaly on our network either because

15
00:01:24,390 --> 00:01:29,799
something is spreading around a hole of

16
00:01:27,520 --> 00:01:35,979
our infrastructure which may be a

17
00:01:29,799 --> 00:01:38,350
malware campaign or an insider script an

18
00:01:35,979 --> 00:01:46,170
insider that knows the architecture that

19
00:01:38,350 --> 00:01:48,818
we're using our network once you start

20
00:01:46,170 --> 00:01:50,979
seeing that as for that now we're

21
00:01:48,819 --> 00:01:54,009
spreading internally from then onwards

22
00:01:50,979 --> 00:01:56,859
you can have backdoors people stealing

23
00:01:54,009 --> 00:01:57,369
confidential information and people

24
00:01:56,859 --> 00:02:01,889
hacking

25
00:01:57,369 --> 00:02:01,889
user accounts and the problem with this

26
00:02:02,609 --> 00:02:08,619
and I'm going to use a very basic model

27
00:02:05,889 --> 00:02:10,690
here by the way let's imagine we get to

28
00:02:08,619 --> 00:02:17,500
work on Monday morning and it turns out

29
00:02:10,690 --> 00:02:19,540
that somebody has detected a problem not

30
00:02:17,500 --> 00:02:23,709
so much a security issue initially they

31
00:02:19,540 --> 00:02:26,739
think but some servers or some computers

32
00:02:23,709 --> 00:02:28,440
aren't actually working so that person

33
00:02:26,740 --> 00:02:32,349
tries to

34
00:02:28,440 --> 00:02:34,060
deal with it as best he can doesn't talk

35
00:02:32,349 --> 00:02:36,790
about the fact that there's this

36
00:02:34,060 --> 00:02:38,770
incidence so everything carries on the

37
00:02:36,790 --> 00:02:44,160
tack of the attack as well of course to

38
00:02:38,770 --> 00:02:48,340
Tuesday morning now the attack is now

39
00:02:44,160 --> 00:02:51,970
bigger it's infiltrated to the rest of

40
00:02:48,340 --> 00:02:55,510
the network and what's on Monday morning

41
00:02:51,970 --> 00:02:57,280
was just 5 10 or 15 computers that were

42
00:02:55,510 --> 00:03:01,299
affected there are now hundreds by

43
00:02:57,280 --> 00:03:05,620
Tuesday we're gonna work in environments

44
00:03:01,300 --> 00:03:07,930
in which in this case you know alerts

45
00:03:05,620 --> 00:03:10,569
are being made either because they

46
00:03:07,930 --> 00:03:12,610
haven't been set up correctly or the

47
00:03:10,569 --> 00:03:14,560
person that had to deal with the alerts

48
00:03:12,610 --> 00:03:16,989
was actually overburdened with work

49
00:03:14,560 --> 00:03:19,510
something that also happens and nobody

50
00:03:16,989 --> 00:03:21,430
knows exactly what their scope how far

51
00:03:19,510 --> 00:03:27,819
it's gone all we know is that some

52
00:03:21,430 --> 00:03:31,569
computers aren't working or obviously

53
00:03:27,819 --> 00:03:34,750
affected so because of the possibility

54
00:03:31,569 --> 00:03:39,690
that might be an attack and the incident

55
00:03:34,750 --> 00:03:39,690
response team gets involved the IR team

56
00:03:44,519 --> 00:03:51,190
so we have to try to find a response to

57
00:03:47,769 --> 00:03:52,870
this incident whenever you have these

58
00:03:51,190 --> 00:03:56,290
kind of scenarios in front of you you

59
00:03:52,870 --> 00:03:57,910
need to have some steps very very clear

60
00:03:56,290 --> 00:03:59,500
in your head first you have to detect to

61
00:03:57,910 --> 00:04:02,380
the incident that might sound obvious

62
00:03:59,500 --> 00:04:03,850
but if you don't have detection ability

63
00:04:02,380 --> 00:04:06,480
you're not allowed to do very much once

64
00:04:03,850 --> 00:04:09,670
you've detected it you need to identify

65
00:04:06,480 --> 00:04:12,988
what assets have been affected by the

66
00:04:09,670 --> 00:04:12,988
attack and

67
00:04:14,000 --> 00:04:20,279
and an initial triage stage to see

68
00:04:17,639 --> 00:04:25,050
whether we should try to isolate to

69
00:04:20,279 --> 00:04:28,049
those assets or maybe try allow the

70
00:04:25,050 --> 00:04:31,290
attack to spread but in a controlled

71
00:04:28,050 --> 00:04:33,270
fashion so you can perhaps isolate the

72
00:04:31,290 --> 00:04:37,500
affected assets and then analyze what's

73
00:04:33,270 --> 00:04:42,780
doing and that's when I'm going to

74
00:04:37,500 --> 00:04:46,139
concentrate most of my talk when

75
00:04:42,780 --> 00:04:49,679
analyzing this scenario what did we find

76
00:04:46,139 --> 00:04:54,030
well different malware samples so it's

77
00:04:49,680 --> 00:05:00,240
not a viable to take the signature or

78
00:04:54,030 --> 00:05:01,979
one of them to to use these deploys and

79
00:05:00,240 --> 00:05:08,460
deploy it in assets so they're different

80
00:05:01,979 --> 00:05:11,270
and they vary so you can try to contain

81
00:05:08,460 --> 00:05:14,370
the attack but it's a problem to do so

82
00:05:11,270 --> 00:05:18,710
another characteristic of this scenario

83
00:05:14,370 --> 00:05:21,390
may be the use of what we can call

84
00:05:18,710 --> 00:05:22,979
allowed tools permitted tools tools that

85
00:05:21,390 --> 00:05:25,770
have emitted by the organization if you

86
00:05:22,979 --> 00:05:28,020
can talk to any of your colleagues

87
00:05:25,770 --> 00:05:30,539
working in systems or any other serious

88
00:05:28,020 --> 00:05:35,580
era though you could you can say oh do

89
00:05:30,539 --> 00:05:37,260
you use PS x''k they use it malware uses

90
00:05:35,580 --> 00:05:44,190
it and so do the attackers

91
00:05:37,260 --> 00:05:47,780
so together signature of somebody that

92
00:05:44,190 --> 00:05:52,580
had been using this isn't viable either

93
00:05:47,780 --> 00:05:52,580
different ways that these can spread

94
00:05:53,450 --> 00:06:06,409
they all followed a similar pattern in

95
00:05:59,700 --> 00:06:10,770
this case at common points I believe wmi

96
00:06:06,410 --> 00:06:16,880
PowerShell and SMB with these three

97
00:06:10,770 --> 00:06:16,880
protocols or technologies you can

98
00:06:18,209 --> 00:06:22,339
you can do all sorts of things

99
00:06:25,039 --> 00:06:30,119
organizing an attack with these kind of

100
00:06:27,689 --> 00:06:35,909
restrictions also throws up some

101
00:06:30,119 --> 00:06:38,069
problems and every time what makes the

102
00:06:35,909 --> 00:06:40,349
commons every time a different asset is

103
00:06:38,069 --> 00:06:44,879
attacked that is every time a new

104
00:06:40,349 --> 00:06:52,589
machine gets affected there was a logon

105
00:06:44,879 --> 00:06:59,309
event so that's another problem further

106
00:06:52,589 --> 00:07:04,189
problems there were no CMS at all so we

107
00:06:59,309 --> 00:07:06,179
couldn't correlates the information

108
00:07:04,189 --> 00:07:10,649
recorded by the machines

109
00:07:06,179 --> 00:07:14,929
what's more default audit policy which

110
00:07:10,649 --> 00:07:19,099
is all very well to have a general idea

111
00:07:14,929 --> 00:07:21,119
but if an attack that we need to channel

112
00:07:19,099 --> 00:07:22,128
what's happened and how it's happened

113
00:07:21,119 --> 00:07:26,219
that's another problem

114
00:07:22,129 --> 00:07:29,159
add further additional problem the

115
00:07:26,219 --> 00:07:32,699
PowerShell version that's being used by

116
00:07:29,159 --> 00:07:39,269
the our equipment in the company is

117
00:07:32,699 --> 00:07:46,829
version 2 so there are no logs or very

118
00:07:39,269 --> 00:07:49,619
few logs so additional problems and if

119
00:07:46,829 --> 00:07:53,849
that weren't enough the ir team arrives

120
00:07:49,619 --> 00:07:57,629
and says you've got to define or you got

121
00:07:53,849 --> 00:08:01,919
over to the scope of the attacks with

122
00:07:57,629 --> 00:08:05,129
all these problems the preliminary

123
00:08:01,919 --> 00:08:07,649
analysis stage we've said that there was

124
00:08:05,129 --> 00:08:08,909
a logon event every time a new machine

125
00:08:07,649 --> 00:08:10,049
was attacked that was what we said

126
00:08:08,909 --> 00:08:16,319
that's how we know it's being attacked

127
00:08:10,049 --> 00:08:19,979
and this is a screenshot of the security

128
00:08:16,319 --> 00:08:22,079
events that you may have we may face

129
00:08:19,979 --> 00:08:25,378
when an organization is being attacked

130
00:08:22,079 --> 00:08:28,650
we're talking about a small organization

131
00:08:25,379 --> 00:08:30,770
with a virtually flat network Oh

132
00:08:28,650 --> 00:08:36,000
[Music]

133
00:08:30,770 --> 00:08:37,948
there are different attack focuses

134
00:08:36,000 --> 00:08:45,120
obvious if you want to process all by

135
00:08:37,948 --> 00:08:49,019
hand it would be a nightmare if we said

136
00:08:45,120 --> 00:08:51,380
that before each attack on an asset as

137
00:08:49,019 --> 00:08:54,720
there's a look-in logon event

138
00:08:51,380 --> 00:08:56,160
what are we gonna try to such we have to

139
00:08:54,720 --> 00:09:01,589
try to sit through all the information

140
00:08:56,160 --> 00:09:03,810
and try to find the event IDs generated

141
00:09:01,589 --> 00:09:06,540
by the operating system to try to

142
00:09:03,810 --> 00:09:09,050
pinpoint what

143
00:09:06,540 --> 00:09:13,920
log on events have occurred in each

144
00:09:09,050 --> 00:09:17,069
machine and this you actually cross and

145
00:09:13,920 --> 00:09:31,139
compare with the log off events or

146
00:09:17,069 --> 00:09:34,040
stating the obvious of course the user

147
00:09:31,139 --> 00:09:39,120
because obviously if the attacker

148
00:09:34,040 --> 00:09:42,329
attacks several machines and there the

149
00:09:39,120 --> 00:09:47,160
idea is going to be the same but except

150
00:09:42,329 --> 00:09:50,339
for the ID except for the session ID the

151
00:09:47,160 --> 00:09:52,740
problem if we use do this correlation

152
00:09:50,339 --> 00:09:56,519
based on say session ID well cuz it

153
00:09:52,740 --> 00:09:59,730
won't be 100% reliable for different

154
00:09:56,519 --> 00:10:06,240
computers or different servers may well

155
00:09:59,730 --> 00:10:07,500
be that they're big clashes may well be

156
00:10:06,240 --> 00:10:11,970
that we've closed a session that's still

157
00:10:07,500 --> 00:10:13,019
open and if we you looking at this with

158
00:10:11,970 --> 00:10:16,910
different domains within the

159
00:10:13,019 --> 00:10:22,220
organization then the same problem is to

160
00:10:16,910 --> 00:10:25,769
so would be valid for an isolated

161
00:10:22,220 --> 00:10:29,490
computers in the same domain and as long

162
00:10:25,769 --> 00:10:32,170
as they're on a very few machines to

163
00:10:29,490 --> 00:10:37,750
avoid rush risks

164
00:10:32,170 --> 00:10:41,949
if we want to track which users have

165
00:10:37,750 --> 00:10:50,350
logged on to the system and which have

166
00:10:41,950 --> 00:10:53,890
been attacked so you take a logon ID

167
00:10:50,350 --> 00:11:00,400
which we saw earlier the computer domain

168
00:10:53,890 --> 00:11:04,470
and user s ID which is unique for each

169
00:11:00,400 --> 00:11:07,600
domain so if we want to get

170
00:11:04,470 --> 00:11:19,060
identification you get an essay you do

171
00:11:07,600 --> 00:11:24,430
an sha-1 at the moment we don't advise

172
00:11:19,060 --> 00:11:27,630
using it because of the risk of

173
00:11:24,430 --> 00:11:27,630
collisions or clashes

174
00:11:33,160 --> 00:11:53,029
it's also possible identify low profile

175
00:11:42,199 --> 00:11:56,990
hijackers so you can see that and in

176
00:11:53,029 --> 00:12:00,199
this way if we follow the bullish

177
00:11:56,990 --> 00:12:05,149
correlation of log on log off you can

178
00:12:00,199 --> 00:12:12,378
find which user launches of tool and as

179
00:12:05,149 --> 00:12:14,930
trying to substitute another so what

180
00:12:12,379 --> 00:12:18,589
they're doing is using an SRC tracking

181
00:12:14,930 --> 00:12:23,899
ID with different attributes to the ones

182
00:12:18,589 --> 00:12:29,779
generated by Windows useful information

183
00:12:23,899 --> 00:12:34,839
will we draw a furnace from those user

184
00:12:29,779 --> 00:12:34,839
accounts that have been occupied

185
00:12:40,509 --> 00:12:47,050
targeted computers computer relations

186
00:12:43,399 --> 00:12:47,050
domains relations and session duration

187
00:12:48,429 --> 00:12:55,790
and what can we deduce from this well

188
00:12:52,850 --> 00:12:58,819
all the sessions that last between 6 & 8

189
00:12:55,790 --> 00:13:01,459
hours which is normally how long our

190
00:12:58,819 --> 00:13:04,610
working day will last we can leave them

191
00:13:01,459 --> 00:13:06,888
to one side but if you can see a session

192
00:13:04,610 --> 00:13:08,120
log on that lasts for one second or two

193
00:13:06,889 --> 00:13:15,079
seconds that's where we'll concentrate

194
00:13:08,120 --> 00:13:16,490
our efforts this graph one which is

195
00:13:15,079 --> 00:13:19,670
produced by the tool that we're going to

196
00:13:16,490 --> 00:13:21,290
look at now and all of this what it does

197
00:13:19,670 --> 00:13:26,719
is it takes all the information at

198
00:13:21,290 --> 00:13:33,639
process isn't it keeps it in a database

199
00:13:26,720 --> 00:13:36,769
and then very visually shows you which

200
00:13:33,639 --> 00:13:38,629
computers at the origin of the attack

201
00:13:36,769 --> 00:13:41,319
launch and watch which ones have been

202
00:13:38,629 --> 00:13:41,319
attacked

203
00:13:41,610 --> 00:13:48,209
here we can see a user and another one

204
00:13:45,180 --> 00:13:54,449
here these two users I've started a

205
00:13:48,209 --> 00:13:55,949
session I've logged on the computers up

206
00:13:54,450 --> 00:13:59,220
here at the top and those down below

207
00:13:55,950 --> 00:14:02,279
what's important is where they user

208
00:13:59,220 --> 00:14:05,250
logon come from it comes from this is

209
00:14:02,279 --> 00:14:07,260
the machine where the user was logged on

210
00:14:05,250 --> 00:14:08,730
out and where they launched their tax

211
00:14:07,260 --> 00:14:10,950
from so you've got a relationship

212
00:14:08,730 --> 00:14:13,740
between destination equipments and

213
00:14:10,950 --> 00:14:15,600
original equipments the place where they

214
00:14:13,740 --> 00:14:19,500
launch the attack from so now we know

215
00:14:15,600 --> 00:14:26,180
for sure with this information that all

216
00:14:19,500 --> 00:14:29,690
of these computers have been attacked

217
00:14:26,180 --> 00:14:33,930
and getting this kind of information

218
00:14:29,690 --> 00:14:40,170
manually and and analyzing manually one

219
00:14:33,930 --> 00:14:44,699
event or two or three it's a nightmare

220
00:14:40,170 --> 00:14:51,089
if you've got very little time trying to

221
00:14:44,700 --> 00:14:56,579
trace all this information with all five

222
00:14:51,089 --> 00:14:59,690
computers to channel and imagine if

223
00:14:56,579 --> 00:15:02,099
you've got 10 100 or 500 computers

224
00:14:59,690 --> 00:15:04,800
imagine the time you need to analyze all

225
00:15:02,100 --> 00:15:06,570
that data so when you've got an instant

226
00:15:04,800 --> 00:15:08,219
what you want to do is to be as quick as

227
00:15:06,570 --> 00:15:13,140
possible and deal with information as

228
00:15:08,220 --> 00:15:16,230
rapidly as possible I'm gonna show you

229
00:15:13,140 --> 00:15:21,329
now how this tool is used it's called

230
00:15:16,230 --> 00:15:22,740
user lined by this tool I'll put the

231
00:15:21,329 --> 00:15:35,069
link up for you later so you can

232
00:15:22,740 --> 00:15:40,019
download it it's got docker compose it's

233
00:15:35,070 --> 00:15:43,820
got docker file if you need it and how

234
00:15:40,019 --> 00:15:49,320
does it run well firstly who gets the

235
00:15:43,820 --> 00:15:53,120
Windows security records then you have

236
00:15:49,320 --> 00:15:53,120
to process them with a second

237
00:15:54,930 --> 00:16:07,829
once you've got the file run it then you

238
00:16:02,940 --> 00:16:12,110
launch this tool use align with the data

239
00:16:07,830 --> 00:16:15,290
of the Aarti search there you can see it

240
00:16:12,110 --> 00:16:21,480
being implemented through docker to

241
00:16:15,290 --> 00:16:28,500
index all the events and we launch the

242
00:16:21,480 --> 00:16:32,250
tool we say what these server is and

243
00:16:28,500 --> 00:16:41,430
which option we want to use you can run

244
00:16:32,250 --> 00:16:44,959
it by the way this is just a screenshot

245
00:16:41,430 --> 00:16:48,029
that shows you the statistics of all the

246
00:16:44,959 --> 00:16:50,489
events so you can index all the events

247
00:16:48,029 --> 00:16:58,079
and it gives you an idea of their reach

248
00:16:50,490 --> 00:16:59,910
as well and here you can see 5,000

249
00:16:58,079 --> 00:17:05,790
events that have been processed in 22

250
00:16:59,910 --> 00:17:11,129
seconds so it's pretty quick you can use

251
00:17:05,790 --> 00:17:12,599
distributed capture as well if it's for

252
00:17:11,130 --> 00:17:22,490
not very many Everts

253
00:17:12,599 --> 00:17:26,458
events it will also give you what good

254
00:17:22,490 --> 00:17:30,780
it can use internal memory cache but if

255
00:17:26,459 --> 00:17:34,140
you work with a large data quantity then

256
00:17:30,780 --> 00:17:37,350
it is necessary you have to take it

257
00:17:34,140 --> 00:17:38,880
right out to secondary server and use

258
00:17:37,350 --> 00:17:43,559
the tools together with this cache

259
00:17:38,880 --> 00:17:46,080
server as well so you decide which the

260
00:17:43,559 --> 00:17:47,879
cache a server is and you can do it with

261
00:17:46,080 --> 00:17:51,510
that program this is the output this is

262
00:17:47,880 --> 00:17:54,320
what the data looks like and I'm gonna

263
00:17:51,510 --> 00:17:54,320
just show you

264
00:17:56,530 --> 00:18:24,980
how it's used although the URL will be

265
00:18:18,260 --> 00:18:29,990
at the end of the presentation what you

266
00:18:24,980 --> 00:18:33,530
do is type it in and then index with the

267
00:18:29,990 --> 00:18:35,270
data that you need and with that that

268
00:18:33,530 --> 00:18:39,410
what's the next command

269
00:18:35,270 --> 00:18:47,200
what is process or the logger security

270
00:18:39,410 --> 00:18:52,670
law which are in /data /index it on this

271
00:18:47,200 --> 00:18:55,520
this part has been removed and here

272
00:18:52,670 --> 00:18:58,720
what's it doing is it's reading all the

273
00:18:55,520 --> 00:18:58,720
security events

274
00:19:27,700 --> 00:19:33,860
there you make a cat of the docker

275
00:19:31,610 --> 00:19:37,879
compose file so you can see what's

276
00:19:33,860 --> 00:19:40,179
necessary in this case it uses the image

277
00:19:37,880 --> 00:19:43,010
to visualize the data that have been

278
00:19:40,180 --> 00:19:47,000
stored and also if you want to see the

279
00:19:43,010 --> 00:19:53,330
visualizations it goes to graphics

280
00:19:47,000 --> 00:19:57,710
databases so we look at all the services

281
00:19:53,330 --> 00:19:59,540
and here you can see the informations

282
00:19:57,710 --> 00:20:01,820
been correctly indexed it's available

283
00:19:59,540 --> 00:20:04,700
you can see it and then you can launch

284
00:20:01,820 --> 00:20:09,470
your tool there you can see all the

285
00:20:04,700 --> 00:20:18,530
information being displayed 1920 2029

286
00:20:09,470 --> 00:20:20,770
events this is also in the repository as

287
00:20:18,530 --> 00:20:20,770
well

288
00:20:28,340 --> 00:20:36,720
and here what we see are all the events

289
00:20:33,929 --> 00:20:38,610
now they've been indexed when we've got

290
00:20:36,720 --> 00:20:42,029
all the informational processed and

291
00:20:38,610 --> 00:20:44,758
stored you can launch the tool and in

292
00:20:42,029 --> 00:20:47,249
this case we've asked it to show on the

293
00:20:44,759 --> 00:20:58,440
screen the most recent events on each

294
00:20:47,249 --> 00:21:01,379
computer what we do is draw all the

295
00:20:58,440 --> 00:21:07,619
information of log on and log off in in

296
00:21:01,379 --> 00:21:10,309
one archive in one file so it's easier

297
00:21:07,619 --> 00:21:10,309
to integrate

298
00:21:17,680 --> 00:21:28,330
there it is in Jason and you can see

299
00:21:21,410 --> 00:21:28,330
there's a log on a log on input and then

300
00:21:28,390 --> 00:21:36,410
and love of inputs so all that

301
00:21:33,710 --> 00:21:39,290
information that appears originally in

302
00:21:36,410 --> 00:21:41,840
the Windows security event records is

303
00:21:39,290 --> 00:21:49,340
also available and for those of you that

304
00:21:41,840 --> 00:21:53,600
are interested in excel if you visualize

305
00:21:49,340 --> 00:21:56,300
it in Excel you can do things a lot more

306
00:21:53,600 --> 00:21:58,939
quickly so you can get the same

307
00:21:56,300 --> 00:22:00,590
information is in Jason but with a

308
00:21:58,940 --> 00:22:02,450
different formatting and that way look

309
00:22:00,590 --> 00:22:08,990
at all the information and automatically

310
00:22:02,450 --> 00:22:11,240
the tool whether whatever kind of logon

311
00:22:08,990 --> 00:22:18,800
that you've done it'll describe the

312
00:22:11,240 --> 00:22:22,040
event to you I'm here we're going to do

313
00:22:18,800 --> 00:22:28,520
the same thing but instead of indexing

314
00:22:22,040 --> 00:22:32,360
all the data and elastic search we're

315
00:22:28,520 --> 00:22:35,900
gonna do it in neo4j which is the

316
00:22:32,360 --> 00:22:38,479
database of graph Oz here's an important

317
00:22:35,900 --> 00:22:41,630
parameter which is unique logon drills

318
00:22:38,480 --> 00:22:44,840
what's this parameter for if you've got

319
00:22:41,630 --> 00:22:47,470
for example a user who always logs in

320
00:22:44,840 --> 00:22:51,760
from the same machine at the same

321
00:22:47,470 --> 00:22:56,740
computer if they do 200 logs in when we

322
00:22:51,760 --> 00:22:59,240
display the the min graphics database

323
00:22:56,740 --> 00:23:01,100
you will be saturated by information be

324
00:22:59,240 --> 00:23:05,270
redundant information so if we only want

325
00:23:01,100 --> 00:23:08,480
to know the unique relations we use

326
00:23:05,270 --> 00:23:11,090
unique regular logon drills even though

327
00:23:08,480 --> 00:23:17,930
our 200 with the same data only that'll

328
00:23:11,090 --> 00:23:24,159
only shows one way of visualizing data

329
00:23:17,930 --> 00:23:26,670
that's valid for us and if we've then

330
00:23:24,160 --> 00:23:30,480
access

331
00:23:26,670 --> 00:23:33,900
naio 4.0 and we make we consult in

332
00:23:30,480 --> 00:23:37,530
fightin you can see all the different

333
00:23:33,900 --> 00:23:43,650
relations between the activity you can

334
00:23:37,530 --> 00:23:47,040
change the colors if you want to in this

335
00:23:43,650 --> 00:23:52,760
case the green represents a computer

336
00:23:47,040 --> 00:23:55,050
read a user and move de made and in each

337
00:23:52,760 --> 00:23:58,860
relation you can see what kind of

338
00:23:55,050 --> 00:24:01,669
relation if it's a user with a piece of

339
00:23:58,860 --> 00:24:05,909
equipment whether it's destination and

340
00:24:01,670 --> 00:24:10,350
you can see in each relation below the

341
00:24:05,910 --> 00:24:11,580
data relating to each node if you click

342
00:24:10,350 --> 00:24:14,760
on the node you can get the information

343
00:24:11,580 --> 00:24:16,860
about the use of the computer and if you

344
00:24:14,760 --> 00:24:20,900
click on a relation you'll get data

345
00:24:16,860 --> 00:24:23,520
about the relation here we've got a user

346
00:24:20,900 --> 00:24:26,250
what will you get at the very least and

347
00:24:23,520 --> 00:24:28,590
you can also set it up that way you can

348
00:24:26,250 --> 00:24:31,260
say oh okay dump all the information

349
00:24:28,590 --> 00:24:34,290
you've got about the event and you can

350
00:24:31,260 --> 00:24:37,080
see it in CSV or give me minimum

351
00:24:34,290 --> 00:24:40,409
information or just the are a tracking

352
00:24:37,080 --> 00:24:43,740
idea of the activity the h1 that we

353
00:24:40,410 --> 00:24:48,000
mentioned previously and then to make it

354
00:24:43,740 --> 00:24:53,340
more agile I I will go to the I'll go to

355
00:24:48,000 --> 00:24:56,970
F and I'll consult in this case over see

356
00:24:53,340 --> 00:24:59,810
you can organize it organize their

357
00:24:56,970 --> 00:24:59,810
relations as you want

358
00:25:06,200 --> 00:25:15,350
look at this computer here and this user

359
00:25:09,400 --> 00:25:17,270
here you can see that all the this user

360
00:25:15,350 --> 00:25:23,300
always looks on in the same way at this

361
00:25:17,270 --> 00:25:26,629
computer and accesses this area that

362
00:25:23,300 --> 00:25:32,750
means that at least it's a specific kind

363
00:25:26,630 --> 00:25:44,690
of computer please relations aren't very

364
00:25:32,750 --> 00:25:49,460
legitimate this machine will also

365
00:25:44,690 --> 00:25:51,500
indicate whether it's a malware kind of

366
00:25:49,460 --> 00:25:57,640
activity in this case we've taken the

367
00:25:51,500 --> 00:26:01,070
tracking ID of a session log on and

368
00:25:57,640 --> 00:26:03,860
there from all the data we can filter

369
00:26:01,070 --> 00:26:06,830
out whether we want to draw out all the

370
00:26:03,860 --> 00:26:09,770
information from the event in this case

371
00:26:06,830 --> 00:26:12,669
and in the incident we spoke about

372
00:26:09,770 --> 00:26:18,040
earlier we can see whether it's a

373
00:26:12,670 --> 00:26:21,140
session log on network it's not just an

374
00:26:18,040 --> 00:26:22,760
interactive one if it's a malware making

375
00:26:21,140 --> 00:26:26,179
lateral movements in my organizations

376
00:26:22,760 --> 00:26:30,890
just want to see if it's a network LAN

377
00:26:26,179 --> 00:26:34,220
logon and here if you put a fight and

378
00:26:30,890 --> 00:26:37,790
Fiat filter on neo4j you can also get

379
00:26:34,220 --> 00:26:40,150
what you want I'm gonna go back to the

380
00:26:37,790 --> 00:26:40,149
beginning

381
00:26:43,590 --> 00:26:46,220
buddy

382
00:26:52,530 --> 00:26:55,129
but

383
00:26:56,980 --> 00:27:03,350
as we said it turns out that you want to

384
00:27:01,340 --> 00:27:06,050
have all the information process and you

385
00:27:03,350 --> 00:27:11,469
want it in a different index or if you

386
00:27:06,050 --> 00:27:14,210
want to send it via rabbit to a tool in

387
00:27:11,470 --> 00:27:16,190
your organization or one of your tools

388
00:27:14,210 --> 00:27:19,720
to process the whole of the event you

389
00:27:16,190 --> 00:27:22,520
can do that it's all structured and

390
00:27:19,720 --> 00:27:26,120
personable in JSON format and that's the

391
00:27:22,520 --> 00:27:32,510
rest of it you've just seen this is the

392
00:27:26,120 --> 00:27:47,540
URL you can download it from there are

393
00:27:32,510 --> 00:27:50,980
those steps that I followed you can have

394
00:27:47,540 --> 00:27:50,980
it that way there's a little

395
00:27:51,450 --> 00:27:59,660
set of instructions so what we've done

396
00:27:53,700 --> 00:28:02,760
is we've reduced the time to consult

397
00:27:59,660 --> 00:28:06,660
122,000 events only we only needed two

398
00:28:02,760 --> 00:28:10,860
minutes and visually we've identified

399
00:28:06,660 --> 00:28:13,950
the origin of the computer used to pivot

400
00:28:10,860 --> 00:28:15,810
the rest of the network and we can see

401
00:28:13,950 --> 00:28:19,340
whether this is legitimate or non

402
00:28:15,810 --> 00:28:19,340
legitimate behavior

403
00:28:26,920 --> 00:28:36,980
and so that's what I wanted to say if

404
00:28:30,110 --> 00:28:39,620
you've got any queries or doubts either

405
00:28:36,980 --> 00:28:41,450
the silence means that I was very good

406
00:28:39,620 --> 00:28:42,649
explaining what I had to explain or I've

407
00:28:41,450 --> 00:28:45,260
done it really badly

408
00:28:42,650 --> 00:28:51,390
any doubts thank you very much

409
00:28:45,260 --> 00:28:51,390
[Applause]

410
00:28:57,299 --> 00:28:59,360
you

