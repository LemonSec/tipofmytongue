1
00:00:17,340 --> 00:00:24,310
the South American branches officers

2
00:00:22,210 --> 00:00:26,980
welcome Niko

3
00:00:24,310 --> 00:00:29,619
hi how difficult it is to give a

4
00:00:26,980 --> 00:00:33,040
presentation after the fiddle after the

5
00:00:29,620 --> 00:00:36,550
violin I'm gonna try and do my best in

6
00:00:33,040 --> 00:00:42,360
order not to bore you before I begin I

7
00:00:36,550 --> 00:00:46,930
like to see and ask how people are doing

8
00:00:42,360 --> 00:00:49,510
to know things about their experience

9
00:00:46,930 --> 00:00:52,720
especially in relation to what I'm going

10
00:00:49,510 --> 00:00:55,000
to be presenting here I'd like to know

11
00:00:52,720 --> 00:01:03,089
whether anybody have you ever used one

12
00:00:55,000 --> 00:01:08,440
of these remote systems or tools if

13
00:01:03,089 --> 00:01:11,710
before we begin and deal with technology

14
00:01:08,440 --> 00:01:14,229
and if you're sitting here I imagine

15
00:01:11,710 --> 00:01:17,080
it's because you're computer experts or

16
00:01:14,229 --> 00:01:19,840
you are interested in this and if you

17
00:01:17,080 --> 00:01:22,899
are somehow interested in computers I

18
00:01:19,840 --> 00:01:25,509
imagine this you'll be the computer guy

19
00:01:22,899 --> 00:01:28,149
in the house so there's always a

20
00:01:25,509 --> 00:01:32,080
relative somebody who goes and says my

21
00:01:28,149 --> 00:01:33,310
computer is not working so you go why

22
00:01:32,080 --> 00:01:35,380
what's wrong

23
00:01:33,310 --> 00:01:37,539
and they'll say it doesn't work I don't

24
00:01:35,380 --> 00:01:41,080
know it just doesn't work analyst and

25
00:01:37,539 --> 00:01:42,970
this silence happens between family

26
00:01:41,080 --> 00:01:45,820
members and

27
00:01:42,970 --> 00:01:51,100
there's always an answer so what do you

28
00:01:45,820 --> 00:01:54,309
guys what do we all answer 99% of family

29
00:01:51,100 --> 00:01:58,149
problems related to computers are solved

30
00:01:54,310 --> 00:02:03,940
by restarting the computer what happens

31
00:01:58,150 --> 00:02:08,009
when we take this to the world of true

32
00:02:03,940 --> 00:02:12,120
real hardware and cloud and servers and

33
00:02:08,009 --> 00:02:14,950
it's no longer the computer my

34
00:02:12,120 --> 00:02:18,490
grandfather's computer etc but it's a

35
00:02:14,950 --> 00:02:24,060
huge data center that has a huge amount

36
00:02:18,490 --> 00:02:24,060
of servers with similar problems than

37
00:02:26,490 --> 00:02:36,640
relatives have and this is the blue

38
00:02:29,790 --> 00:02:40,570
screen of death and so what we need to

39
00:02:36,640 --> 00:02:43,420
do these cases those of us who work in

40
00:02:40,570 --> 00:02:46,739
these areas is to go to the data center

41
00:02:43,420 --> 00:02:51,220
and going to the data center means

42
00:02:46,739 --> 00:02:54,489
jumping on a cab and this is like in the

43
00:02:51,220 --> 00:02:57,959
airport they always are far so you have

44
00:02:54,489 --> 00:03:02,160
to jump in a taxi go to that place and

45
00:02:57,959 --> 00:03:04,650
go to a computer and most of the times

46
00:03:02,160 --> 00:03:08,829
what you normally have to do is to

47
00:03:04,650 --> 00:03:11,200
restart as our computer and Bert data

48
00:03:08,830 --> 00:03:13,480
centers things are horrible because note

49
00:03:11,200 --> 00:03:18,549
that in these pictures that people are

50
00:03:13,480 --> 00:03:20,950
just there freezing cold and this is

51
00:03:18,550 --> 00:03:23,140
normally a human response to when

52
00:03:20,950 --> 00:03:26,738
somebody feels a miserable feels

53
00:03:23,140 --> 00:03:29,440
horrible when now somebody has spent a

54
00:03:26,739 --> 00:03:32,920
lot of time in a data center people

55
00:03:29,440 --> 00:03:34,959
laugh instead of crying and this is the

56
00:03:32,920 --> 00:03:38,649
problem data centers have no place to

57
00:03:34,959 --> 00:03:41,160
sit down look at the pictures this is

58
00:03:38,650 --> 00:03:41,160
just

59
00:03:43,160 --> 00:03:57,170
so nowhere to say it's cold colder than

60
00:03:50,180 --> 00:03:59,450
it's a real cold and so what companies

61
00:03:57,170 --> 00:04:02,929
developed was the following

62
00:03:59,450 --> 00:04:08,049
it's a remote system something that can

63
00:04:02,930 --> 00:04:11,330
be so that these servers can be remotely

64
00:04:08,050 --> 00:04:17,030
handled the ability to restart the

65
00:04:11,330 --> 00:04:21,470
computer remotely and we administrators

66
00:04:17,029 --> 00:04:25,059
managers lazy nobody wants to jump in

67
00:04:21,470 --> 00:04:27,860
and taxi in order to restart a server so

68
00:04:25,060 --> 00:04:31,790
these are systems that different

69
00:04:27,860 --> 00:04:34,700
hardware vendors are created this is

70
00:04:31,790 --> 00:04:37,570
what we're going to dress today

71
00:04:34,700 --> 00:04:44,870
okay from the point of view of cyber

72
00:04:37,570 --> 00:04:47,900
security well Who am I my name is Nico

73
00:04:44,870 --> 00:04:55,190
Walsman if you wanna get in touch with

74
00:04:47,900 --> 00:04:56,900
me that's my address over there they've

75
00:04:55,190 --> 00:04:59,360
always tried to standardize these

76
00:04:56,900 --> 00:05:03,440
systems but whenever they try they screw

77
00:04:59,360 --> 00:05:05,690
up the names of these systems change

78
00:05:03,440 --> 00:05:11,270
depending on who you are some people

79
00:05:05,690 --> 00:05:17,360
call them ipmi intelligence platform

80
00:05:11,270 --> 00:05:20,659
management interface whenever says

81
00:05:17,360 --> 00:05:22,070
intelligence means there's no

82
00:05:20,660 --> 00:05:25,100
intelligence or whatever they call

83
00:05:22,070 --> 00:05:31,540
intelligent is simply asian right now

84
00:05:25,100 --> 00:05:33,080
and we always cool some of these things

85
00:05:31,540 --> 00:05:35,870
lights out

86
00:05:33,080 --> 00:05:39,400
but anyway several names but in this

87
00:05:35,870 --> 00:05:42,770
case we're going to call this hip knee

88
00:05:39,400 --> 00:05:45,260
IPMI but in any case this is somehow

89
00:05:42,770 --> 00:05:47,180
complex so what are the characteristics

90
00:05:45,260 --> 00:05:48,020
of these systems that our presence in

91
00:05:47,180 --> 00:05:52,550
emerge

92
00:05:48,020 --> 00:05:56,000
large servers and even in some pcs there

93
00:05:52,550 --> 00:05:57,889
is something that's similar to this this

94
00:05:56,000 --> 00:06:00,470
is absolutely independent from the

95
00:05:57,889 --> 00:06:04,759
operating system one well if we have

96
00:06:00,470 --> 00:06:09,349
this blue screen affair we need to

97
00:06:04,759 --> 00:06:14,500
restart the computer so a micro that's

98
00:06:09,349 --> 00:06:18,740
in that's handled automatically and then

99
00:06:14,500 --> 00:06:21,639
this is also handled remotely this is

100
00:06:18,740 --> 00:06:25,340
something we need to do from our office

101
00:06:21,639 --> 00:06:28,699
obviously the whole issue of monitoring

102
00:06:25,340 --> 00:06:30,940
not just the shutdown and turn on the

103
00:06:28,699 --> 00:06:38,870
system but also to check the temperature

104
00:06:30,940 --> 00:06:43,300
voltage fans etc and here you can see a

105
00:06:38,870 --> 00:06:46,580
picture of the graphic bent interface

106
00:06:43,300 --> 00:06:49,780
seems that was done in the 80s where

107
00:06:46,580 --> 00:06:53,508
there's no and there was no graphic

108
00:06:49,780 --> 00:06:57,138
interface and we have a chart a table

109
00:06:53,509 --> 00:07:02,419
that says the temperature in the

110
00:06:57,139 --> 00:07:04,789
different places of the CPU etc and it

111
00:07:02,419 --> 00:07:08,000
tells you about the maximum temperature

112
00:07:04,789 --> 00:07:13,409
that can be reached before the whole

113
00:07:08,000 --> 00:07:15,660
thing goes on fire and so

114
00:07:13,410 --> 00:07:17,610
for instance after a given temperature

115
00:07:15,660 --> 00:07:22,350
please let me know because something's

116
00:07:17,610 --> 00:07:25,620
wrong what we realize is that basically

117
00:07:22,350 --> 00:07:28,760
inside a computer we have an additional

118
00:07:25,620 --> 00:07:31,350
computers more one inside of it and this

119
00:07:28,760 --> 00:07:33,840
additional computer has several

120
00:07:31,350 --> 00:07:37,740
characteristics first of all there's a

121
00:07:33,840 --> 00:07:44,880
complete there's a full network start IV

122
00:07:37,740 --> 00:07:47,370
v6 and different protocols HTTP okay so

123
00:07:44,880 --> 00:07:51,810
there are some alignments that will give

124
00:07:47,370 --> 00:07:58,260
us more capabilities and then KVM which

125
00:07:51,810 --> 00:08:04,680
allows us to share keyboard the mouse

126
00:07:58,260 --> 00:08:08,130
and a machine and then a serial console

127
00:08:04,680 --> 00:08:10,290
it's as if you were connecting a wire to

128
00:08:08,130 --> 00:08:13,020
the machine remotely and this is

129
00:08:10,290 --> 00:08:15,240
interesting because if we want to change

130
00:08:13,020 --> 00:08:17,940
something in Windows we could do it like

131
00:08:15,240 --> 00:08:21,570
this and finally power management to be

132
00:08:17,940 --> 00:08:24,120
able to turn off number one and turn the

133
00:08:21,570 --> 00:08:27,930
computer on and off so you may tell me

134
00:08:24,120 --> 00:08:30,270
well you know this is a back door you

135
00:08:27,930 --> 00:08:34,830
may say because it allows us to control

136
00:08:30,270 --> 00:08:39,240
the keyboard the mouse and there's no

137
00:08:34,830 --> 00:08:45,870
way for any antivirus system to detect

138
00:08:39,240 --> 00:08:47,760
things but perfect doctor doesn't exist

139
00:08:45,870 --> 00:08:52,920
because of the computer has turned off

140
00:08:47,760 --> 00:08:59,180
it doesn't work so the back perfect back

141
00:08:52,920 --> 00:09:04,800
to works when the computer is off one

142
00:08:59,180 --> 00:09:08,699
because the only thing you need is to be

143
00:09:04,800 --> 00:09:10,349
plugged in theories the system is

144
00:09:08,700 --> 00:09:13,210
working

145
00:09:10,350 --> 00:09:17,560
we're going to access the video you can

146
00:09:13,210 --> 00:09:23,620
turn on the machine remotely but this is

147
00:09:17,560 --> 00:09:26,469
not just run things obviously if you

148
00:09:23,620 --> 00:09:28,840
need to reset the computer a system

149
00:09:26,470 --> 00:09:32,920
needs to be connected especially if we

150
00:09:28,840 --> 00:09:37,360
need to access the BIOS and use a

151
00:09:32,920 --> 00:09:39,579
modification etc the idea that I can

152
00:09:37,360 --> 00:09:43,090
reinstall the operating system from

153
00:09:39,580 --> 00:09:45,970
these devices and I said no there's a

154
00:09:43,090 --> 00:09:49,390
Chinese Internet device that's working

155
00:09:45,970 --> 00:09:52,150
very well well now this is included in

156
00:09:49,390 --> 00:09:57,790
each a server you will find a ou have

157
00:09:52,150 --> 00:09:59,560
this but when I started studying this

158
00:09:57,790 --> 00:10:04,060
and later on I'll tell you why we

159
00:09:59,560 --> 00:10:09,369
started we when we you find these are

160
00:10:04,060 --> 00:10:11,920
charts you realized that they're big

161
00:10:09,370 --> 00:10:14,770
when we see all these charts others look

162
00:10:11,920 --> 00:10:20,680
ugly as if they had been done in the 90s

163
00:10:14,770 --> 00:10:23,800
you realize that this is trouble the

164
00:10:20,680 --> 00:10:25,989
first thing we see here is the central

165
00:10:23,800 --> 00:10:28,660
part this square that says base board

166
00:10:25,990 --> 00:10:32,370
management controller the MBC some

167
00:10:28,660 --> 00:10:37,000
people think that this is a synonym of

168
00:10:32,370 --> 00:10:40,270
IPMI and this is the micro each vendor

169
00:10:37,000 --> 00:10:42,850
has a different micro and it is

170
00:10:40,270 --> 00:10:46,360
connected to the different areas in the

171
00:10:42,850 --> 00:10:47,200
computer a users crawled a protocol

172
00:10:46,360 --> 00:10:54,150
called

173
00:10:47,200 --> 00:10:58,450
IP MB and it connects to the CPU and the

174
00:10:54,150 --> 00:11:01,390
electricity a mother and it's got a

175
00:10:58,450 --> 00:11:04,280
direct connection to

176
00:11:01,390 --> 00:11:07,750
Network port it doesn't use the normal

177
00:11:04,280 --> 00:11:12,770
network it uses a separate network

178
00:11:07,750 --> 00:11:17,060
separate from the normal one they would

179
00:11:12,770 --> 00:11:18,350
leave this for the end who has this they

180
00:11:17,060 --> 00:11:22,400
all have them

181
00:11:18,350 --> 00:11:28,400
there is no vendor that doesn't have

182
00:11:22,400 --> 00:11:32,720
this in HB HB is yellow because it's

183
00:11:28,400 --> 00:11:37,880
intelligent lights out and the case of

184
00:11:32,720 --> 00:11:44,360
Lenovo they never bought IBM I mean this

185
00:11:37,880 --> 00:11:49,900
is called IMM intelligence management

186
00:11:44,360 --> 00:11:53,860
something and then the Super Micro and

187
00:11:49,900 --> 00:11:59,569
let me tell you about how fun it is to

188
00:11:53,860 --> 00:12:08,450
go into these devices well it's not very

189
00:11:59,570 --> 00:12:13,000
pleasant this is and it's not fun at all

190
00:12:08,450 --> 00:12:13,000
and let me tell you I have this works

191
00:12:14,470 --> 00:12:19,030
then we can get some sound

192
00:12:25,130 --> 00:12:34,740
like I told you this has the ability to

193
00:12:29,420 --> 00:12:39,930
work even if it's not plugged in we need

194
00:12:34,740 --> 00:12:44,970
to switch on the device and office we've

195
00:12:39,930 --> 00:12:50,310
had Dell HP Lenovo and they all make

196
00:12:44,970 --> 00:12:52,950
that horrible noise because of all the

197
00:12:50,310 --> 00:12:56,400
fans instead of instance side of the

198
00:12:52,950 --> 00:13:00,630
case inside the box so what what we're

199
00:12:56,400 --> 00:13:03,150
looking for when we started studying

200
00:13:00,630 --> 00:13:07,770
this where we needed to look for

201
00:13:03,150 --> 00:13:11,670
something that was pre authentication so

202
00:13:07,770 --> 00:13:14,400
what I'm gonna tell you of about has to

203
00:13:11,670 --> 00:13:17,219
do with working without a pre

204
00:13:14,400 --> 00:13:19,590
authentication how can we do this

205
00:13:17,220 --> 00:13:22,590
without knowing anything about users

206
00:13:19,590 --> 00:13:25,080
passwords etc and you realize that it's

207
00:13:22,590 --> 00:13:28,290
not so difficult right now it's not

208
00:13:25,080 --> 00:13:31,530
difficult at all it's not difficult at

209
00:13:28,290 --> 00:13:34,380
all first of all let me tell you about

210
00:13:31,530 --> 00:13:47,600
each system this is something we're

211
00:13:34,380 --> 00:13:51,780
still doing and we've found work several

212
00:13:47,600 --> 00:13:54,630
clients and some clancer told us we have

213
00:13:51,780 --> 00:13:58,730
these devices but we don't trust them

214
00:13:54,630 --> 00:14:01,730
and we need you to give us a hand

215
00:13:58,730 --> 00:14:05,220
look into it and the first thing we

216
00:14:01,730 --> 00:14:10,470
investigated and this is where we did

217
00:14:05,220 --> 00:14:18,690
the most important thing was the HP ILO

218
00:14:10,470 --> 00:14:22,800
with a macro called and you see V 850

219
00:14:18,690 --> 00:14:25,650
it's not a Super Micro it's slow you

220
00:14:22,800 --> 00:14:30,290
need to be patient and it's a runtime

221
00:14:25,650 --> 00:14:35,459
operating system that's called thread X

222
00:14:30,290 --> 00:14:38,520
when you try to unpack this it's there's

223
00:14:35,460 --> 00:14:41,190
no file system it's a great binary that

224
00:14:38,520 --> 00:14:49,230
you need to study order it and it's not

225
00:14:41,190 --> 00:14:51,450
easy and this neck v8 50 assembler is

226
00:14:49,230 --> 00:14:54,839
very easy to read

227
00:14:51,450 --> 00:14:58,050
you don't have thousands of instructions

228
00:14:54,839 --> 00:15:01,470
that you need to follow up and this

229
00:14:58,050 --> 00:15:05,089
makes a things easier when you go into

230
00:15:01,470 --> 00:15:07,650
that assembler for the first time

231
00:15:05,089 --> 00:15:11,190
assembler is a machine that's not

232
00:15:07,650 --> 00:15:15,449
normally used in Spain's

233
00:15:11,190 --> 00:15:17,820
Spanish in any case so we said let's go

234
00:15:15,450 --> 00:15:20,790
to afford now we everything we know

235
00:15:17,820 --> 00:15:24,330
about I love to we're going to transfer

236
00:15:20,790 --> 00:15:26,430
it to ILO for but we cannot do it

237
00:15:24,330 --> 00:15:32,660
because the operating systems changed

238
00:15:26,430 --> 00:15:39,290
now we have a different thing called JH

239
00:15:32,660 --> 00:15:39,290
j GH has integrity

240
00:15:40,760 --> 00:15:45,920
there are many complications but in any

241
00:15:43,800 --> 00:15:45,920
case

242
00:15:46,440 --> 00:15:53,610
compiler these are things that he used

243
00:15:51,120 --> 00:15:59,070
very much for easy to emulate and then

244
00:15:53,610 --> 00:16:09,180
we have the other thing the IMM Lenovo

245
00:15:59,070 --> 00:16:13,290
and the Dell one the idha SC from Dell

246
00:16:09,180 --> 00:16:17,969
has anybody heard about super H this is

247
00:16:13,290 --> 00:16:20,010
used for some things and also for Sega

248
00:16:17,970 --> 00:16:23,850
Saturn I don't know if you remember this

249
00:16:20,010 --> 00:16:28,709
game console this is a very powerful

250
00:16:23,850 --> 00:16:30,930
Micro this is not a very powerful one by

251
00:16:28,709 --> 00:16:34,260
the way but the good thing is that a

252
00:16:30,930 --> 00:16:39,540
runs on Linux there's a whole file

253
00:16:34,260 --> 00:16:42,720
system configuration and it's got

254
00:16:39,540 --> 00:16:46,380
different tools and the true thing is

255
00:16:42,720 --> 00:16:48,839
that it's very comfortable to study to

256
00:16:46,380 --> 00:16:52,560
audit and the micro that I mention at

257
00:16:48,839 --> 00:16:56,010
the beginning that also runs on Linux so

258
00:16:52,560 --> 00:16:58,529
it makes it quite easy to study with our

259
00:16:56,010 --> 00:17:01,770
binary Borbon REO que poner sell with r1

260
00:16:58,529 --> 00:17:04,859
r2 he and una tienda uno Giza this is

261
00:17:01,770 --> 00:17:08,369
much easier to audit it's not like with

262
00:17:04,859 --> 00:17:11,639
a huge file here when you have a

263
00:17:08,369 --> 00:17:14,479
language you just set up your filesystem

264
00:17:11,640 --> 00:17:19,490
your own file system and you can go

265
00:17:14,480 --> 00:17:23,880
binary binary in order to handle

266
00:17:19,490 --> 00:17:27,980
different things so so here we need to

267
00:17:23,880 --> 00:17:30,929
know about the different macros etc and

268
00:17:27,980 --> 00:17:36,929
see what we need to do the main thing

269
00:17:30,929 --> 00:17:39,780
one we are auditing we need to be the

270
00:17:36,929 --> 00:17:44,210
machine needs to start to get going

271
00:17:39,780 --> 00:17:44,210
needs to start working it works

272
00:17:45,590 --> 00:17:50,280
alone

273
00:17:47,310 --> 00:17:54,360
even if that doesn't do anything even if

274
00:17:50,280 --> 00:17:59,010
whatever is doing is stupid so yeah so

275
00:17:54,360 --> 00:18:06,929
when you are trying to understand things

276
00:17:59,010 --> 00:18:08,520
the machine is working again guilin day

277
00:18:06,930 --> 00:18:15,210
i guess they were are at the city

278
00:18:08,520 --> 00:18:17,550
Malatesta forma well here we have things

279
00:18:15,210 --> 00:18:21,930
that we can use to attack and there's

280
00:18:17,550 --> 00:18:24,540
also the vertical documentation you'll

281
00:18:21,930 --> 00:18:28,260
read all the documentation and as we

282
00:18:24,540 --> 00:18:30,780
understand that this served as a

283
00:18:28,260 --> 00:18:32,940
feedback for everything you've seen it's

284
00:18:30,780 --> 00:18:42,960
a feature

285
00:18:32,940 --> 00:18:48,320
Faiza it also allows us to see things

286
00:18:42,960 --> 00:18:48,320
outside the normal protocol because

287
00:18:48,500 --> 00:18:56,870
because something vendors like and that

288
00:18:52,170 --> 00:18:59,640
is bypassing protocol they like

289
00:18:56,870 --> 00:19:03,419
standardizing things and then they just

290
00:18:59,640 --> 00:19:07,790
skip standardization well because some

291
00:19:03,420 --> 00:19:12,180
people do this in order to attract

292
00:19:07,790 --> 00:19:14,280
customers they'll say well these things

293
00:19:12,180 --> 00:19:18,360
only work with me so if you want to have

294
00:19:14,280 --> 00:19:34,350
them you must come with me and buy from

295
00:19:18,360 --> 00:19:39,020
me everything we learn documentation etc

296
00:19:34,350 --> 00:19:44,149
is used to analyze we do it and then

297
00:19:39,020 --> 00:19:47,200
we feed it back as we learn this is a

298
00:19:44,150 --> 00:19:51,250
feedback that is used in order to keep

299
00:19:47,200 --> 00:19:54,440
going deeper and find vulnerabilities

300
00:19:51,250 --> 00:19:55,340
let's look at the attack surface of

301
00:19:54,440 --> 00:19:59,809
these systems

302
00:19:55,340 --> 00:20:03,580
well these surfaces change with systems

303
00:19:59,809 --> 00:20:06,260
let's look at the common commonalities

304
00:20:03,580 --> 00:20:08,379
among them and these are some of them so

305
00:20:06,260 --> 00:20:11,559
look let's look at some of these and

306
00:20:08,380 --> 00:20:13,460
let's look at some of their problems and

307
00:20:11,559 --> 00:20:18,559
vulnerabilities of course the first

308
00:20:13,460 --> 00:20:22,580
thing was a smash smash is command line

309
00:20:18,559 --> 00:20:25,428
that was perhaps to standardize all this

310
00:20:22,580 --> 00:20:29,659
that's called DTMF it's got nothing to

311
00:20:25,429 --> 00:20:34,580
do with telephones terms is like an ISO

312
00:20:29,660 --> 00:20:38,830
like an ISO thing what it does is to

313
00:20:34,580 --> 00:20:44,419
standardize these remote services it

314
00:20:38,830 --> 00:20:47,330
runs on SSH and for instance if you

315
00:20:44,420 --> 00:20:49,460
connect to one brand and somebody to

316
00:20:47,330 --> 00:20:51,290
another the ideas are more or less the

317
00:20:49,460 --> 00:20:54,340
same so you can set up your own script

318
00:20:51,290 --> 00:20:59,120
your own SSH strip and to connect

319
00:20:54,340 --> 00:21:02,659
yourself and get information and that is

320
00:20:59,120 --> 00:21:04,790
the basics these are the basics of smash

321
00:21:02,660 --> 00:21:08,870
but obviously it doesn't work there's

322
00:21:04,790 --> 00:21:10,909
easy it's not that easy series of and

323
00:21:08,870 --> 00:21:13,939
they have their own commands they can

324
00:21:10,910 --> 00:21:15,230
not support the standard one sub in the

325
00:21:13,940 --> 00:21:17,840
end you have to learn a whole new

326
00:21:15,230 --> 00:21:23,900
language or your own language for this

327
00:21:17,840 --> 00:21:29,270
as regards a pre authentication we need

328
00:21:23,900 --> 00:21:37,280
to attack the SSH that been analyzed in

329
00:21:29,270 --> 00:21:40,960
that we said an interesting thing with

330
00:21:37,280 --> 00:21:45,590
this is that once we access through SSH

331
00:21:40,960 --> 00:21:48,410
we can obtain remote

332
00:21:45,590 --> 00:21:56,570
and we see what you see on this screen

333
00:21:48,410 --> 00:21:59,260
this is the machines BIOS like with

334
00:21:56,570 --> 00:22:03,500
everything else there are some default

335
00:21:59,260 --> 00:22:05,990
users user password you know may find

336
00:22:03,500 --> 00:22:09,050
many devices that are doing this if you

337
00:22:05,990 --> 00:22:12,290
are doing a bench test you have to use a

338
00:22:09,050 --> 00:22:15,379
default password how do you get this it

339
00:22:12,290 --> 00:22:19,100
comes with the documentation and then

340
00:22:15,380 --> 00:22:27,190
there is the SNMP protocol which is a

341
00:22:19,100 --> 00:22:32,590
protocol and as the community is freeing

342
00:22:27,190 --> 00:22:42,550
obviously like with all internet devices

343
00:22:32,590 --> 00:22:46,939
most of them have public default

344
00:22:42,550 --> 00:22:54,200
community string by default and this is

345
00:22:46,940 --> 00:22:56,420
a test we run the walk which is a tool

346
00:22:54,200 --> 00:23:01,280
that tries to list all the difficulty

347
00:22:56,420 --> 00:23:03,170
information provided by SNMP and these

348
00:23:01,280 --> 00:23:06,800
are the different protocols that help us

349
00:23:03,170 --> 00:23:10,540
monitor the system remotely and the

350
00:23:06,800 --> 00:23:17,360
interesting thing about this is the

351
00:23:10,540 --> 00:23:27,350
snmpwalk has information and we extract

352
00:23:17,360 --> 00:23:30,020
the maybe from each parameter of tener

353
00:23:27,350 --> 00:23:33,980
our is a process of tango in a bone this

354
00:23:30,020 --> 00:23:35,950
allows us to access these processes that

355
00:23:33,980 --> 00:23:38,409
are running

356
00:23:35,950 --> 00:23:43,320
is very helpful as attackers to know

357
00:23:38,409 --> 00:23:46,990
what is running what isn't yes an MP

358
00:23:43,320 --> 00:23:49,149
most of these are vulnerable the ones

359
00:23:46,990 --> 00:23:57,549
that you see in the market are

360
00:23:49,149 --> 00:24:02,350
vulnerable to dangle for the bug has

361
00:23:57,549 --> 00:24:09,490
been reported that's about it so we need

362
00:24:02,350 --> 00:24:16,029
to move systems with open as an MP this

363
00:24:09,490 --> 00:24:22,120
is open for free and then there's HTTPS

364
00:24:16,029 --> 00:24:24,929
and this is very interesting these this

365
00:24:22,120 --> 00:24:33,029
is one of the most interesting targets

366
00:24:24,929 --> 00:24:33,029
preferred by sassette men and firewalls

367
00:24:33,120 --> 00:24:40,529
you can connect to this system and we've

368
00:24:38,350 --> 00:24:45,850
had several companies with these devices

369
00:24:40,529 --> 00:24:49,179
something that was open was HTTPS the

370
00:24:45,850 --> 00:24:53,439
device doesn't know she going through

371
00:24:49,179 --> 00:24:56,620
HTTP is redirection some devices are so

372
00:24:53,440 --> 00:25:00,970
old and the certificates are so old that

373
00:24:56,620 --> 00:25:03,399
we had to go back to 1.0 Firefox version

374
00:25:00,970 --> 00:25:08,590
in order to access the graphics

375
00:25:03,399 --> 00:25:13,360
interface mr them use a web server

376
00:25:08,590 --> 00:25:17,889
called a PP web it is interesting it's

377
00:25:13,360 --> 00:25:21,340
very small supposedly safe and this web

378
00:25:17,889 --> 00:25:23,229
server is indeed safe and secure but the

379
00:25:21,340 --> 00:25:25,269
problem is the thing that the things

380
00:25:23,230 --> 00:25:28,179
that it has on top and that we will see

381
00:25:25,269 --> 00:25:31,389
in a minute people say I'm not going to

382
00:25:28,179 --> 00:25:34,570
use a PP web or light web or any other

383
00:25:31,389 --> 00:25:38,370
things and some people decide to

384
00:25:34,570 --> 00:25:40,570
implement their own server you may smile

385
00:25:38,370 --> 00:25:42,840
because you may think that this is the

386
00:25:40,570 --> 00:25:45,960
end of the problem and indeed these

387
00:25:42,840 --> 00:25:52,279
for example and the threat number four

388
00:25:45,960 --> 00:25:57,269
of these guys from friends they reported

389
00:25:52,279 --> 00:26:00,480
HTTP server in a way that was the one we

390
00:25:57,269 --> 00:26:06,110
were looking for there was this virus

391
00:26:00,480 --> 00:26:09,749
called SS can F it's a stack overflow

392
00:26:06,110 --> 00:26:14,490
very easy to trigger it was the perfect

393
00:26:09,749 --> 00:26:18,379
unit and they won very clearly Super

394
00:26:14,490 --> 00:26:22,559
Micro is another pre authentification

395
00:26:18,379 --> 00:26:27,240
exploit example one wouldn't be able to

396
00:26:22,559 --> 00:26:31,889
attack the web server as such but if you

397
00:26:27,240 --> 00:26:34,740
love ain't csi's which are created on c

398
00:26:31,889 --> 00:26:36,539
are sometimes compiled without any

399
00:26:34,740 --> 00:26:38,940
security whatsoever with that cookie

400
00:26:36,539 --> 00:26:46,499
protection and many other features they

401
00:26:38,940 --> 00:26:49,619
don't have this stack overflow this is a

402
00:26:46,499 --> 00:26:53,220
bag from the nineties and the peer about

403
00:26:49,619 --> 00:26:55,168
a year ago and what you can see here is

404
00:26:53,220 --> 00:26:58,139
that they get the name and the password

405
00:26:55,169 --> 00:27:02,610
to login and then this is string code

406
00:26:58,139 --> 00:27:05,639
they code they copy a varietal variable

407
00:27:02,610 --> 00:27:10,918
and then it can crash and it can be

408
00:27:05,639 --> 00:27:16,158
exploited in a very simple way when it

409
00:27:10,919 --> 00:27:19,889
comes to recognizing these systems HTTP

410
00:27:16,159 --> 00:27:23,249
HTTP allows you to recognize in Able's

411
00:27:19,889 --> 00:27:28,199
recognitions without identification with

412
00:27:23,249 --> 00:27:29,970
this - you are ours the first one gives

413
00:27:28,200 --> 00:27:37,049
you information about the firm where

414
00:27:29,970 --> 00:27:42,440
it's being used because otherwise you

415
00:27:37,049 --> 00:27:42,440
cannot target it specifically

416
00:27:43,870 --> 00:27:51,320
in the case of the itraq and they have a

417
00:27:48,169 --> 00:27:53,389
CGI called discover that may be hacked

418
00:27:51,320 --> 00:27:58,009
in the future but we haven't found

419
00:27:53,389 --> 00:28:00,620
anything yet it's not only about web

420
00:27:58,009 --> 00:28:03,320
Saba it's what is on top of the web

421
00:28:00,620 --> 00:28:05,629
server in this case we've seen three

422
00:28:03,320 --> 00:28:07,428
specific protocols that are used in

423
00:28:05,630 --> 00:28:11,870
different our web servers the first one

424
00:28:07,429 --> 00:28:14,480
is WS Men the second s redfish and well

425
00:28:11,870 --> 00:28:16,149
I will go one-by-one redfish is the

426
00:28:14,480 --> 00:28:20,330
newest one

427
00:28:16,149 --> 00:28:26,600
it is a communications technique very

428
00:28:20,330 --> 00:28:29,750
simple one the endpoint is redfish / 1 /

429
00:28:26,600 --> 00:28:32,600
and what's interesting about it is that

430
00:28:29,750 --> 00:28:35,690
it is very well armoured the

431
00:28:32,600 --> 00:28:39,110
authentification is done at the level of

432
00:28:35,690 --> 00:28:40,759
the HTTP server so if you authenticate

433
00:28:39,110 --> 00:28:42,139
yourself this way there is literally you

434
00:28:40,759 --> 00:28:46,460
can do unless you attack the server

435
00:28:42,139 --> 00:28:48,949
itself on the pre authentification level

436
00:28:46,460 --> 00:28:51,139
there's nothing else you can do so we

437
00:28:48,950 --> 00:28:54,379
looked at it understood it a little bit

438
00:28:51,139 --> 00:28:57,229
but we didn't delve into it because our

439
00:28:54,379 --> 00:29:00,080
time was limited and we had to somehow

440
00:28:57,230 --> 00:29:04,610
work on the economy of what we were

441
00:29:00,080 --> 00:29:07,759
doing like how we would invest our time

442
00:29:04,610 --> 00:29:11,059
and if things got too complicated we

443
00:29:07,759 --> 00:29:15,200
just moved on to the next thing so we

444
00:29:11,059 --> 00:29:18,710
moved on to rip CL this is a protocol an

445
00:29:15,200 --> 00:29:22,519
XML protocol where the authentication is

446
00:29:18,710 --> 00:29:25,220
in the XML itself now we know that the

447
00:29:22,519 --> 00:29:28,460
authentication doesn't go through HTTPS

448
00:29:25,220 --> 00:29:32,120
and that's an advantage web server is

449
00:29:28,460 --> 00:29:36,409
solid so let's try to attack XML so we

450
00:29:32,120 --> 00:29:40,120
started frozen first of all but before

451
00:29:36,409 --> 00:29:43,070
going to that what's interesting is that

452
00:29:40,120 --> 00:29:49,189
administrators don't write XML by hand

453
00:29:43,070 --> 00:29:50,470
they use these tools HP o + cg + c PQ l

454
00:29:49,190 --> 00:29:54,100
OC FG

455
00:29:50,470 --> 00:29:56,889
one in remote one local they use a

456
00:29:54,100 --> 00:29:59,918
series of commands and they create an

457
00:29:56,889 --> 00:30:01,750
automatic XML to remotely administer the

458
00:29:59,919 --> 00:30:03,610
machine what's interesting about these

459
00:30:01,750 --> 00:30:06,789
kind of tools is that the administrator

460
00:30:03,610 --> 00:30:10,479
isn't writing emails by hand and the

461
00:30:06,789 --> 00:30:13,059
advantage to this is that many of the

462
00:30:10,480 --> 00:30:15,429
units that are found here are done by

463
00:30:13,059 --> 00:30:18,549
administrators by accident and when they

464
00:30:15,429 --> 00:30:22,470
send it over they crash when they use an

465
00:30:18,549 --> 00:30:25,899
automatic command it's usually

466
00:30:22,470 --> 00:30:29,259
standardized stuff that leaves this room

467
00:30:25,899 --> 00:30:33,219
in order to test weird things you know

468
00:30:29,259 --> 00:30:34,149
the to find vulnerabilities so this is

469
00:30:33,220 --> 00:30:37,330
an example of how it works

470
00:30:34,149 --> 00:30:40,389
authentication it's and the XML itself

471
00:30:37,330 --> 00:30:43,928
began the first hitter that tells you

472
00:30:40,389 --> 00:30:48,870
about the version then we have entries

473
00:30:43,929 --> 00:30:51,009
for user password if it's in plain text

474
00:30:48,870 --> 00:30:55,209
it's not important

475
00:30:51,009 --> 00:30:58,570
and then if this varietal happens it

476
00:30:55,210 --> 00:31:01,779
says host powers and it powers of the

477
00:30:58,570 --> 00:31:06,820
device the problem is that when we

478
00:31:01,779 --> 00:31:08,799
started pausing it and analyzing it we

479
00:31:06,820 --> 00:31:13,899
found out they were using a solid

480
00:31:08,799 --> 00:31:22,080
lexical analyzer flags a scanner and a

481
00:31:13,899 --> 00:31:25,000
lot of very well verified things so we

482
00:31:22,080 --> 00:31:27,879
decided to use was read I'm sorry

483
00:31:25,000 --> 00:31:32,350
there's a great puzzle that allows you

484
00:31:27,879 --> 00:31:35,590
to work immediately with it in very

485
00:31:32,350 --> 00:31:38,439
simple steps in for a very simple step

486
00:31:35,590 --> 00:31:41,139
we use it for everything before starting

487
00:31:38,440 --> 00:31:43,720
analyzing or auditing we use red arms

488
00:31:41,139 --> 00:31:45,639
right away it's very simple we decide

489
00:31:43,720 --> 00:31:48,700
what to attack first of all second step

490
00:31:45,639 --> 00:31:51,729
is to look for valid cases in our case

491
00:31:48,700 --> 00:31:54,639
looking for XML we were looking on the

492
00:31:51,730 --> 00:31:56,679
internet things that act it on the

493
00:31:54,639 --> 00:31:57,250
machine for example the turned off the

494
00:31:56,679 --> 00:31:59,230
machine

495
00:31:57,250 --> 00:32:06,549
the next step

496
00:31:59,230 --> 00:32:10,960
was to make a balance if these are the

497
00:32:06,549 --> 00:32:14,980
valid cases we used read answer to

498
00:32:10,960 --> 00:32:16,900
turned those into bad cases and they

499
00:32:14,980 --> 00:32:19,570
have lots of buzzers

500
00:32:16,900 --> 00:32:21,700
they have many different algorithms you

501
00:32:19,570 --> 00:32:25,480
know the to change whatever we were

502
00:32:21,700 --> 00:32:28,179
sending to it we were sending XML but

503
00:32:25,480 --> 00:32:31,870
we've used a binary protocols things

504
00:32:28,179 --> 00:32:35,710
that weren't XML based and Radames got

505
00:32:31,870 --> 00:32:37,299
it read it and without having an idea of

506
00:32:35,710 --> 00:32:41,799
what it was about

507
00:32:37,299 --> 00:32:45,940
they it was given us things like these

508
00:32:41,799 --> 00:32:48,309
back they were doing it was doing crazy

509
00:32:45,940 --> 00:32:51,790
things for example closing the log in

510
00:32:48,309 --> 00:32:54,309
several times here you can see that the

511
00:32:51,790 --> 00:32:58,480
version appears several times and this

512
00:32:54,309 --> 00:33:02,470
is without knowing XML because probably

513
00:32:58,480 --> 00:33:04,809
the algorithms it has inside can

514
00:33:02,470 --> 00:33:07,900
understand that the brackets are able to

515
00:33:04,809 --> 00:33:10,600
limit things in a certain way so this is

516
00:33:07,900 --> 00:33:14,770
the first logical step in our any

517
00:33:10,600 --> 00:33:16,870
audience this is the next one ws men

518
00:33:14,770 --> 00:33:17,230
which is nothing to do with my name by

519
00:33:16,870 --> 00:33:20,979
the way

520
00:33:17,230 --> 00:33:22,660
it's what service manager it's a

521
00:33:20,980 --> 00:33:25,000
protocol that is widespread in

522
00:33:22,660 --> 00:33:26,710
microphone if Microsoft I don't know how

523
00:33:25,000 --> 00:33:30,130
they used it but they use it as a native

524
00:33:26,710 --> 00:33:34,390
support and they have a similar syntax

525
00:33:30,130 --> 00:33:37,380
to XML based on soap and since Microsoft

526
00:33:34,390 --> 00:33:40,840
uses it it has a lot of PowerShell

527
00:33:37,380 --> 00:33:44,230
PowerShell support and so Windows users

528
00:33:40,840 --> 00:33:47,740
use it a lot actually but there are

529
00:33:44,230 --> 00:33:49,900
several problems attached to it first of

530
00:33:47,740 --> 00:33:52,240
all because it's not linked to a

531
00:33:49,900 --> 00:33:58,240
transport layer however it's usually

532
00:33:52,240 --> 00:34:00,490
used through HTTP with /ws man but on

533
00:33:58,240 --> 00:34:03,010
the authentication level this is managed

534
00:34:00,490 --> 00:34:06,130
to the web server level that's why we

535
00:34:03,010 --> 00:34:09,880
thought this wasn't the best option but

536
00:34:06,130 --> 00:34:13,060
we under we found out that it could run

537
00:34:09,880 --> 00:34:21,820
and alone as well with the TCP / five

538
00:34:13,060 --> 00:34:25,330
nine eight five so in spite of using

539
00:34:21,820 --> 00:34:29,490
HTTP and some cases it wasn't working as

540
00:34:25,330 --> 00:34:33,690
it was supposed to for strange reasons

541
00:34:29,489 --> 00:34:35,560
they wouldn't let me

542
00:34:33,690 --> 00:34:39,820
administer it remotely without

543
00:34:35,560 --> 00:34:44,139
identification but it would let me speak

544
00:34:39,820 --> 00:34:47,740
a little bit and as long as I can speak

545
00:34:44,139 --> 00:34:52,359
this means that it is patching and we

546
00:34:47,739 --> 00:34:58,569
know that it's for vulnerability

547
00:34:52,360 --> 00:35:00,760
purposes parsing parsing is the worst

548
00:34:58,570 --> 00:35:05,350
not caching parsing is the worst thing

549
00:35:00,760 --> 00:35:08,830
you can do so I said this is good this

550
00:35:05,350 --> 00:35:10,770
is a parser it's letting us speak so

551
00:35:08,830 --> 00:35:14,400
let's see what else we've got

552
00:35:10,770 --> 00:35:17,470
super micro is using a very very old

553
00:35:14,400 --> 00:35:20,950
version with a lot of vulnerabilities as

554
00:35:17,470 --> 00:35:25,450
you can see here in the middle beyond

555
00:35:20,950 --> 00:35:28,990
the string compares you have a sprint F

556
00:35:25,450 --> 00:35:30,669
I can have used my laser pointed it's

557
00:35:28,990 --> 00:35:33,819
not working on the screen but anyway

558
00:35:30,670 --> 00:35:36,700
it's what you are watching on the screen

559
00:35:33,820 --> 00:35:40,090
sprint F this is similar one we're

560
00:35:36,700 --> 00:35:42,759
talking about sprint F bugs and now

561
00:35:40,090 --> 00:35:45,520
modern stuff can detect this kind of

562
00:35:42,760 --> 00:35:52,870
behavior but I don't know how they

563
00:35:45,520 --> 00:35:57,490
compiled it because it let it be as it

564
00:35:52,870 --> 00:36:00,190
was and unleash an overflow some others

565
00:35:57,490 --> 00:36:02,799
use newer versions and what is

566
00:36:00,190 --> 00:36:06,570
interesting about them well this is the

567
00:36:02,800 --> 00:36:11,620
version that is running a standalone

568
00:36:06,570 --> 00:36:14,170
what you're watching here this is an

569
00:36:11,620 --> 00:36:18,609
open-source version that was adapted for

570
00:36:14,170 --> 00:36:21,100
every single system so as we said before

571
00:36:18,610 --> 00:36:23,580
when we are implementing our

572
00:36:21,100 --> 00:36:26,020
own web service there is risk of

573
00:36:23,580 --> 00:36:28,299
vulnerabilities so since we knew that

574
00:36:26,020 --> 00:36:31,480
there were vulnerabilities such as s

575
00:36:28,300 --> 00:36:33,190
printf we decided to find out more here

576
00:36:31,480 --> 00:36:35,560
there is another vulnerability when the

577
00:36:33,190 --> 00:36:41,500
web server tries to authenticate you

578
00:36:35,560 --> 00:36:46,210
avaya digest or basic realm there is and

579
00:36:41,500 --> 00:36:51,370
there is a problem so that printf is

580
00:36:46,210 --> 00:36:56,820
okay or it looks like it is okay but as

581
00:36:51,370 --> 00:37:03,100
long as you advance and as the loop

582
00:36:56,820 --> 00:37:07,570
turns around this end value increases so

583
00:37:03,100 --> 00:37:10,660
when I do Sai self of Bob - and I am

584
00:37:07,570 --> 00:37:16,020
going to be allowed to write as much as

585
00:37:10,660 --> 00:37:18,759
I want this is a pre authentication

586
00:37:16,020 --> 00:37:22,330
vulnerability as long as the system is

587
00:37:18,760 --> 00:37:26,380
running standalone that's what most of

588
00:37:22,330 --> 00:37:28,960
this kind of systems adopted so as we

589
00:37:26,380 --> 00:37:34,780
discover more and more about this we

590
00:37:28,960 --> 00:37:37,930
actually couldn't believe it IP m has

591
00:37:34,780 --> 00:37:43,870
its own protocol with the same name IBM

592
00:37:37,930 --> 00:37:45,460
I which runs and UDP and 63 and it's

593
00:37:43,870 --> 00:37:50,529
quite interesting I encourage you to

594
00:37:45,460 --> 00:37:56,260
test it it learns or it enables you to

595
00:37:50,530 --> 00:37:59,940
do what the interface provides but only

596
00:37:56,260 --> 00:37:59,940
on UDP

597
00:38:01,430 --> 00:38:09,720
so we can turn on or off the computer

598
00:38:05,430 --> 00:38:13,109
find out information etc so we start to

599
00:38:09,720 --> 00:38:15,839
look for more information and I the

600
00:38:13,109 --> 00:38:17,750
world called it the most dangerous

601
00:38:15,839 --> 00:38:20,430
protocol in the world but you know what

602
00:38:17,750 --> 00:38:22,890
magazines and journals are like if they

603
00:38:20,430 --> 00:38:25,049
say it's the most dangerous protocol we

604
00:38:22,890 --> 00:38:27,058
just don't believe them because they are

605
00:38:25,050 --> 00:38:30,630
always talking about very dangerous

606
00:38:27,059 --> 00:38:33,480
things and sometimes and many times they

607
00:38:30,630 --> 00:38:37,680
are wrong so we started looking at how

608
00:38:33,480 --> 00:38:39,809
it worked basically only with UDP and

609
00:38:37,680 --> 00:38:42,990
they use a session ID and a sequence

610
00:38:39,809 --> 00:38:49,680
number in order to start the session and

611
00:38:42,990 --> 00:38:53,939
now we can see how it works there is a

612
00:38:49,680 --> 00:38:56,598
first package first basic package that

613
00:38:53,940 --> 00:38:59,700
tells you what is and what isn't

614
00:38:56,599 --> 00:39:03,920
supported and it's called gap channel

615
00:38:59,700 --> 00:39:06,890
authentication capabilities that

616
00:39:03,920 --> 00:39:09,990
responds immediately this is all pre

617
00:39:06,890 --> 00:39:12,359
authentication not post authentication

618
00:39:09,990 --> 00:39:19,200
this is how the protocol works the first

619
00:39:12,359 --> 00:39:23,420
layer is called our SCP and it's the

620
00:39:19,200 --> 00:39:28,379
remote management layer it works also

621
00:39:23,420 --> 00:39:32,520
internally by the way locally by a pipe

622
00:39:28,380 --> 00:39:37,260
within a machine or it can even work

623
00:39:32,520 --> 00:39:39,450
with the bosses even so in this case

624
00:39:37,260 --> 00:39:46,190
this layer tells you that the program is

625
00:39:39,450 --> 00:39:53,490
running remotely then we move on to the

626
00:39:46,190 --> 00:39:55,640
session layer beyond UDP when you want

627
00:39:53,490 --> 00:39:58,140
to know who you're talking to and avoid

628
00:39:55,640 --> 00:40:02,368
spoofing you need the first volley of

629
00:39:58,140 --> 00:40:06,650
the sequence valley and the ID we have a

630
00:40:02,369 --> 00:40:06,650
length that is going to give us the

631
00:40:10,130 --> 00:40:15,240
identification for the next layer of

632
00:40:12,930 --> 00:40:19,950
protocol we're going to know how long

633
00:40:15,240 --> 00:40:21,990
it's going to be a binary protocol needs

634
00:40:19,950 --> 00:40:25,379
to test whenever they see there is a

635
00:40:21,990 --> 00:40:28,459
length then we have the it may layer

636
00:40:25,380 --> 00:40:32,520
itself this is what we call the 38

637
00:40:28,460 --> 00:40:38,040
command we send that command and we

638
00:40:32,520 --> 00:40:40,770
would we get back is the same we also

639
00:40:38,040 --> 00:40:43,560
attach the privileges we want to have in

640
00:40:40,770 --> 00:40:45,990
the future when we are authenticated so

641
00:40:43,560 --> 00:40:48,570
we send this over and we say well this

642
00:40:45,990 --> 00:40:51,149
is the kind of thing I support tell me

643
00:40:48,570 --> 00:40:53,130
what are your authentication channels

644
00:40:51,150 --> 00:41:00,780
and tell me also what are the algorithms

645
00:40:53,130 --> 00:41:04,440
you support these algorithms have to

646
00:41:00,780 --> 00:41:13,070
find out the it may version that is

647
00:41:04,440 --> 00:41:13,070
running the oldest one I think is 1.5

648
00:41:13,730 --> 00:41:21,630
and then there have been other newer

649
00:41:17,070 --> 00:41:25,170
versions they all support 2.0 but we

650
00:41:21,630 --> 00:41:32,790
need to find out what things of 1.5 are

651
00:41:25,170 --> 00:41:36,240
being supported and here we find out if

652
00:41:32,790 --> 00:41:40,290
we if no authentification is accepted if

653
00:41:36,240 --> 00:41:42,859
md 2 or md 5 are accepted and so long

654
00:41:40,290 --> 00:41:45,270
and so forth if they accept an on

655
00:41:42,860 --> 00:41:48,060
authentication this means that i can use

656
00:41:45,270 --> 00:41:52,320
this tool to connect myself in Windows

657
00:41:48,060 --> 00:41:55,470
and Linux and I can type in many

658
00:41:52,320 --> 00:41:57,780
different ID names and passwords and it

659
00:41:55,470 --> 00:41:59,430
would make no difference I will be able

660
00:41:57,780 --> 00:42:05,430
to authenticate myself without any

661
00:41:59,430 --> 00:42:08,129
username or passwords the tool accepts

662
00:42:05,430 --> 00:42:10,440
these arguments by default this was the

663
00:42:08,130 --> 00:42:15,060
beginning of the protocol here we're

664
00:42:10,440 --> 00:42:17,780
talking about the 2.0 version and if you

665
00:42:15,060 --> 00:42:17,779
start

666
00:42:18,070 --> 00:42:23,630
researching there are no machines that

667
00:42:20,930 --> 00:42:27,649
can accept that remotely although they

668
00:42:23,630 --> 00:42:32,690
can tell you they do so what was the

669
00:42:27,650 --> 00:42:36,070
answer from one of the vendors Dell for

670
00:42:32,690 --> 00:42:38,990
example said that the equipment wasn't

671
00:42:36,070 --> 00:42:42,590
conceived to be on the internet it was

672
00:42:38,990 --> 00:42:45,500
conceived to be on an isolated Network

673
00:42:42,590 --> 00:42:47,780
that's why we let you authenticate

674
00:42:45,500 --> 00:42:49,700
yourself without a username or a

675
00:42:47,780 --> 00:42:53,530
password now let's move to the new

676
00:42:49,700 --> 00:42:57,290
protocol the version 2.0 how does

677
00:42:53,530 --> 00:42:59,330
authentication work here now it's your

678
00:42:57,290 --> 00:43:01,400
turn to find out what the problem is

679
00:42:59,330 --> 00:43:05,110
this is a vulnerability that you can

680
00:43:01,400 --> 00:43:08,720
find if you follow these specifications

681
00:43:05,110 --> 00:43:10,580
the first packet is open session request

682
00:43:08,720 --> 00:43:12,589
I tell them I want to open I went to

683
00:43:10,580 --> 00:43:13,850
start a session I know I'm running out

684
00:43:12,590 --> 00:43:17,630
of time that's why I'm speaking

685
00:43:13,850 --> 00:43:19,910
extraordinarily fast so we have the

686
00:43:17,630 --> 00:43:21,830
local session ID remember we used

687
00:43:19,910 --> 00:43:25,490
sessions in order to find out who the

688
00:43:21,830 --> 00:43:27,350
person was so I sent the request and the

689
00:43:25,490 --> 00:43:29,120
other party tells me that this is my

690
00:43:27,350 --> 00:43:31,339
remote session idea this is how we

691
00:43:29,120 --> 00:43:34,100
communicate then we launch the first

692
00:43:31,340 --> 00:43:37,130
package we authenticate our results

693
00:43:34,100 --> 00:43:39,950
seriously this is the user name i want

694
00:43:37,130 --> 00:43:43,040
to access so the route the admin

695
00:43:39,950 --> 00:43:45,319
whatever we want and then I said value a

696
00:43:43,040 --> 00:43:48,020
random value that is going to be used in

697
00:43:45,320 --> 00:43:51,350
order to encode that value and find out

698
00:43:48,020 --> 00:43:54,470
if it's been used or not' so the yellow

699
00:43:51,350 --> 00:43:59,210
is the client it's me and the other one

700
00:43:54,470 --> 00:44:03,560
is the server so it tells me this is my

701
00:43:59,210 --> 00:44:06,770
get this is my server name because every

702
00:44:03,560 --> 00:44:10,970
server has a unique name I get a random

703
00:44:06,770 --> 00:44:14,420
value as I sent mine and then I get my

704
00:44:10,970 --> 00:44:17,089
hashed password then we move to the

705
00:44:14,420 --> 00:44:19,130
second stage now I have all this

706
00:44:17,090 --> 00:44:22,760
information that allows me to hash a

707
00:44:19,130 --> 00:44:26,740
code and send it to the server that says

708
00:44:22,760 --> 00:44:26,740
ok it's you you can continue

709
00:44:27,840 --> 00:44:34,440
have you found what I was on when I

710
00:44:30,180 --> 00:44:39,259
asked you to look for exactly the server

711
00:44:34,440 --> 00:44:43,800
is sending as the hash of the password

712
00:44:39,260 --> 00:44:47,610
so we just sent a login name and the

713
00:44:43,800 --> 00:44:52,710
server senses the hashed power the

714
00:44:47,610 --> 00:44:56,430
hashed password of my own name and why

715
00:44:52,710 --> 00:44:59,070
this makes no sense at all not even in

716
00:44:56,430 --> 00:45:02,339
the protocol you can say ok this is ok

717
00:44:59,070 --> 00:45:08,040
it was patched now it's not patched the

718
00:45:02,340 --> 00:45:12,960
protocol is like that so in this case

719
00:45:08,040 --> 00:45:14,850
well you know that we've salted it how

720
00:45:12,960 --> 00:45:16,560
have we sorted it well with all the

721
00:45:14,850 --> 00:45:19,140
information I got from the local session

722
00:45:16,560 --> 00:45:22,560
ID remote session ID a local random

723
00:45:19,140 --> 00:45:24,990
bytes etc is used with the password in

724
00:45:22,560 --> 00:45:27,140
order to hash this value and give it

725
00:45:24,990 --> 00:45:32,160
back to me we're talking about a hashed

726
00:45:27,140 --> 00:45:35,339
password here so what I do in this case

727
00:45:32,160 --> 00:45:37,589
is crack it I have all the time in the

728
00:45:35,340 --> 00:45:38,880
world for cracking it's days weeks as

729
00:45:37,590 --> 00:45:42,350
long as the password doesn't change

730
00:45:38,880 --> 00:45:47,070
everything will be fine so this is the

731
00:45:42,350 --> 00:45:50,580
python dump I made in order to test with

732
00:45:47,070 --> 00:45:54,030
different users and with every user I

733
00:45:50,580 --> 00:45:57,360
try I get the same what you see in blue

734
00:45:54,030 --> 00:46:02,430
is this salt and what you see at the

735
00:45:57,360 --> 00:46:05,550
bottom is the hash the hash I got using

736
00:46:02,430 --> 00:46:13,980
the admin user if you see the difference

737
00:46:05,550 --> 00:46:18,840
one is here Sean John and hash Hackett

738
00:46:13,980 --> 00:46:23,840
have a support for this and the cost of

739
00:46:18,840 --> 00:46:27,740
this is 24 point $48 per hour which

740
00:46:23,840 --> 00:46:30,740
gives as many million attempts per

741
00:46:27,740 --> 00:46:30,740
second

742
00:46:34,270 --> 00:46:40,670
well you've talked about hashed

743
00:46:37,660 --> 00:46:44,980
passwords so this looks pretty easy to

744
00:46:40,670 --> 00:46:46,400
do my people at Dell made yet another

745
00:46:44,980 --> 00:46:49,610
mistake

746
00:46:46,400 --> 00:46:54,310
remember I said they used a session ID

747
00:46:49,610 --> 00:46:54,310
and a sequence Dahmer they decided that

748
00:46:54,340 --> 00:47:04,390
that the session ID would analyze the

749
00:46:59,840 --> 00:47:12,110
last four characters in the 32 bits as

750
00:47:04,390 --> 00:47:16,180
result if the connection active you

751
00:47:12,110 --> 00:47:20,870
might be able to predict the session and

752
00:47:16,180 --> 00:47:23,419
hatchets and hack it on the other hand

753
00:47:20,870 --> 00:47:26,060
there is a protocol that we haven't seen

754
00:47:23,420 --> 00:47:29,780
yet but sounds very interesting and it

755
00:47:26,060 --> 00:47:34,570
is the KVM it's very interesting and it

756
00:47:29,780 --> 00:47:38,750
allows you to remotely control mouse's

757
00:47:34,570 --> 00:47:43,040
keyboards etc as long as you go into the

758
00:47:38,750 --> 00:47:46,400
website and as long as you use Java

759
00:47:43,040 --> 00:47:47,960
applet it is a unique protocol we don't

760
00:47:46,400 --> 00:47:51,890
have time to see it about the

761
00:47:47,960 --> 00:47:53,780
authentication is almost immediate we

762
00:47:51,890 --> 00:47:56,960
decided to analyze this any more death

763
00:47:53,780 --> 00:48:00,470
in the future in order to find out if it

764
00:47:56,960 --> 00:48:03,020
was really worth it I'm not really

765
00:48:00,470 --> 00:48:06,560
interested in what is online I will tell

766
00:48:03,020 --> 00:48:09,110
you why in a minute and the things we

767
00:48:06,560 --> 00:48:10,880
were able to see in several websites and

768
00:48:09,110 --> 00:48:12,920
databases that are out there in the

769
00:48:10,880 --> 00:48:17,330
Internet is that most of them still

770
00:48:12,920 --> 00:48:24,290
accept md5 for the 1.5 version what is

771
00:48:17,330 --> 00:48:28,009
surprising about this is that the 1.5

772
00:48:24,290 --> 00:48:33,980
version isn't vulnerable to this but

773
00:48:28,010 --> 00:48:37,000
when they went to the version 2.0 when

774
00:48:33,980 --> 00:48:39,430
they decided nobody said or nobody

775
00:48:37,000 --> 00:48:42,280
mentioned the

776
00:48:39,430 --> 00:48:44,470
passwords so it seems nobody in this

777
00:48:42,280 --> 00:48:47,080
team was actually involved in security

778
00:48:44,470 --> 00:48:51,060
so this gives you an idea of the things

779
00:48:47,080 --> 00:48:55,140
we can find on the Internet

780
00:48:51,060 --> 00:48:58,480
there are very few devices running on

781
00:48:55,140 --> 00:49:03,600
1.5 protocols or at least I didn't see

782
00:48:58,480 --> 00:49:06,940
any there are very old devices then

783
00:49:03,600 --> 00:49:08,850
simple pass which isn't very interesting

784
00:49:06,940 --> 00:49:14,710
to us either

785
00:49:08,850 --> 00:49:17,830
well then I researched shodhan and and

786
00:49:14,710 --> 00:49:22,030
showed them there were 30,000 servers

787
00:49:17,830 --> 00:49:26,020
online with HCP and most of them were

788
00:49:22,030 --> 00:49:29,560
vulnerable to our bugs I gave you the

789
00:49:26,020 --> 00:49:32,500
example that the French found and it is

790
00:49:29,560 --> 00:49:36,130
in the last version of this thread and

791
00:49:32,500 --> 00:49:41,890
none of them was running on the last

792
00:49:36,130 --> 00:49:47,830
version here we are using the 1.3

793
00:49:41,890 --> 00:49:51,910
version then I looked for I track on the

794
00:49:47,830 --> 00:49:55,660
census database and the figure it gave

795
00:49:51,910 --> 00:49:59,620
me was 31,000 then I looked on the it me

796
00:49:55,660 --> 00:50:02,170
protocol it gave me the value of 128

797
00:49:59,620 --> 00:50:05,440
thousand I honestly don't believe that

798
00:50:02,170 --> 00:50:07,930
number is real and what I looked for

799
00:50:05,440 --> 00:50:12,070
with ILO and I dragged and they are

800
00:50:07,930 --> 00:50:17,950
really connected this is what I found

801
00:50:12,070 --> 00:50:22,570
about Spain only 750 were under I low if

802
00:50:17,950 --> 00:50:27,250
you look shodhan in if you look at

803
00:50:22,570 --> 00:50:30,040
children in Spain the number is quite

804
00:50:27,250 --> 00:50:33,390
important and they are exposed to the

805
00:50:30,040 --> 00:50:33,390
internet directly

806
00:50:33,950 --> 00:50:40,080
well now again I'm not interested if

807
00:50:37,950 --> 00:50:43,319
they are exposed to the internet or not

808
00:50:40,080 --> 00:50:45,779
but if I am an attacker these devices

809
00:50:43,320 --> 00:50:49,940
will allow me to do all the things that

810
00:50:45,780 --> 00:50:52,800
is the so-called cross movement

811
00:50:49,940 --> 00:50:55,530
sometimes we or many times we talk about

812
00:50:52,800 --> 00:50:58,410
the side movement I compromise a machine

813
00:50:55,530 --> 00:51:01,560
and then I can move to different other

814
00:50:58,410 --> 00:51:05,970
machines next to it but this takes one

815
00:51:01,560 --> 00:51:08,940
step beyond this allows me to use a

816
00:51:05,970 --> 00:51:15,149
different network and move else where's

817
00:51:08,940 --> 00:51:18,450
this is a nice ICP from Holland so this

818
00:51:15,150 --> 00:51:22,380
is how you get online and how you manage

819
00:51:18,450 --> 00:51:25,230
that remotely so this is the way it is

820
00:51:22,380 --> 00:51:28,170
sing in a not mole in a normal Network

821
00:51:25,230 --> 00:51:32,240
we have the administrator who's managing

822
00:51:28,170 --> 00:51:35,250
an out-of-band Network and this networks

823
00:51:32,240 --> 00:51:40,950
connects to the different servers these

824
00:51:35,250 --> 00:51:43,560
servers may be on a DMZ they may be

825
00:51:40,950 --> 00:51:45,600
connected to an internal network or they

826
00:51:43,560 --> 00:51:49,620
may be directly connected to the

827
00:51:45,600 --> 00:51:52,799
Internet what's interesting here is that

828
00:51:49,620 --> 00:52:00,330
they are in different networks or they

829
00:51:52,800 --> 00:52:03,330
may be in different networks and to a

830
00:52:00,330 --> 00:52:05,850
movement that goes beyond the side

831
00:52:03,330 --> 00:52:08,790
movement because we can either

832
00:52:05,850 --> 00:52:12,480
compromise the administrator who will

833
00:52:08,790 --> 00:52:16,470
open all doors or to compromise the I

834
00:52:12,480 --> 00:52:18,600
love and then see what we can do then we

835
00:52:16,470 --> 00:52:22,379
can compromise one of the servers and

836
00:52:18,600 --> 00:52:25,799
then move on to the ILO so the question

837
00:52:22,380 --> 00:52:28,230
is once the app may once the ILO is

838
00:52:25,800 --> 00:52:32,070
hacked do we have access to the server

839
00:52:28,230 --> 00:52:34,920
yes in many different ways first of all

840
00:52:32,070 --> 00:52:37,830
we have a serial console we can use a

841
00:52:34,920 --> 00:52:40,290
serial console and we have a login to

842
00:52:37,830 --> 00:52:42,420
connect ourselves directly then there is

843
00:52:40,290 --> 00:52:49,830
this beautiful protocol that allows us

844
00:52:42,420 --> 00:52:54,680
to set up a you are all remotely it

845
00:52:49,830 --> 00:52:54,680
actually sets it up on Windows or Linux

846
00:52:54,800 --> 00:53:02,400
and of course we also have KVM which is

847
00:52:58,950 --> 00:53:04,470
a VNC that goes straight to the machine

848
00:53:02,400 --> 00:53:07,830
I don't know if I have time to say

849
00:53:04,470 --> 00:53:09,779
everything I want to say I'm going to

850
00:53:07,830 --> 00:53:13,020
forward this clip a little bit what we

851
00:53:09,780 --> 00:53:17,640
did was to connect to the web we raced

852
00:53:13,020 --> 00:53:20,810
the Java applet and this screen that you

853
00:53:17,640 --> 00:53:25,770
are seeing is KVM it's displaying

854
00:53:20,810 --> 00:53:28,920
everything I tried with SSH as well you

855
00:53:25,770 --> 00:53:33,780
can do it but you cannot play the video

856
00:53:28,920 --> 00:53:38,280
in the frame buffer modes so it is all

857
00:53:33,780 --> 00:53:41,540
blind so to say in the case of the Java

858
00:53:38,280 --> 00:53:45,390
console you can watch the video

859
00:53:41,540 --> 00:53:48,930
perfectly so first of all we have power

860
00:53:45,390 --> 00:53:51,450
switch reboots the Machine reboots but

861
00:53:48,930 --> 00:53:53,700
still I continue I remain connected to

862
00:53:51,450 --> 00:53:58,290
the web server to the machine and it all

863
00:53:53,700 --> 00:54:01,020
moves on very seamlessly it takes quite

864
00:53:58,290 --> 00:54:03,779
a while before it reboots so I'm going

865
00:54:01,020 --> 00:54:07,590
to fast forward a little bit so the

866
00:54:03,780 --> 00:54:13,610
machine reboots I have a Linux installed

867
00:54:07,590 --> 00:54:13,610
hair it

868
00:54:14,300 --> 00:54:19,550
well this one's like a basa let's see

869
00:54:17,210 --> 00:54:24,490
what happens if we fast-forward it a

870
00:54:19,550 --> 00:54:26,930
little bit and while it rebooted and

871
00:54:24,490 --> 00:54:29,990
then I start hitting on ship ship ship

872
00:54:26,930 --> 00:54:38,089
ship shipped all the time and I go into

873
00:54:29,990 --> 00:54:44,120
the single session mode and we move to

874
00:54:38,090 --> 00:54:47,780
the advanced face recording and now

875
00:54:44,120 --> 00:54:50,029
we're going to recovery mode because we

876
00:54:47,780 --> 00:54:51,950
might have lost power or whatever and

877
00:54:50,030 --> 00:54:56,030
they're going to recovery and that go

878
00:54:51,950 --> 00:54:58,720
instead of fixing the computer do

879
00:54:56,030 --> 00:54:58,720
something else

880
00:55:03,240 --> 00:55:10,770
it's our general engine it's a building

881
00:55:07,190 --> 00:55:15,660
lineups but in recovery mode so it sets

882
00:55:10,770 --> 00:55:17,160
up an interface recovery interface so I

883
00:55:15,660 --> 00:55:20,430
think I mean take a it's enough for

884
00:55:17,160 --> 00:55:22,980
momoy simply this is a very easy once

885
00:55:20,430 --> 00:55:26,399
the aisle has been committed with all

886
00:55:22,980 --> 00:55:32,790
the thousands of problems as the famous

887
00:55:26,400 --> 00:55:34,619
hash that see I can go to the central

888
00:55:32,790 --> 00:55:40,759
server that has all the information

889
00:55:34,619 --> 00:55:47,579
because device you can connect remotely

890
00:55:40,760 --> 00:55:50,460
etc but only makes things difficult and

891
00:55:47,579 --> 00:55:59,819
here you see the remote recovery mode

892
00:55:50,460 --> 00:56:03,359
okay so now in opposite come on recovery

893
00:55:59,819 --> 00:56:08,069
we check the computer will reboot shift

894
00:56:03,359 --> 00:56:09,598
recovery if I've had a bios password I

895
00:56:08,069 --> 00:56:13,460
would have stopped me but there's still

896
00:56:09,599 --> 00:56:16,500
a lot to see here here we are and then

897
00:56:13,460 --> 00:56:18,569
same thing on the other side this is the

898
00:56:16,500 --> 00:56:25,500
operating system are going to computer

899
00:56:18,569 --> 00:56:33,079
the operating system lets me flash the

900
00:56:25,500 --> 00:56:38,240
firmware this also depends on the vendor

901
00:56:33,079 --> 00:56:40,589
as one of them have their own way for

902
00:56:38,240 --> 00:56:44,430
communication there's also a bootstrap

903
00:56:40,589 --> 00:56:48,990
and this allows you to do many more

904
00:56:44,430 --> 00:56:50,609
things but this commit the machine and I

905
00:56:48,990 --> 00:56:54,149
see whether there's an isle of that's

906
00:56:50,609 --> 00:56:58,369
connected to I see that this is the case

907
00:56:54,150 --> 00:57:01,500
I have my own hello signature and

908
00:56:58,369 --> 00:57:03,660
imagine that the machines committed to

909
00:57:01,500 --> 00:57:05,410
internet so let's imagine that I'm going

910
00:57:03,660 --> 00:57:08,950
to connect myself to

911
00:57:05,410 --> 00:57:14,170
that that's our side the rest of the

912
00:57:08,950 --> 00:57:16,270
networks something that the engineer

913
00:57:14,170 --> 00:57:19,210
didn't design because they're kissing

914
00:57:16,270 --> 00:57:21,130
about layoffs servers but he's not

915
00:57:19,210 --> 00:57:25,660
thinking of apparel that network that

916
00:57:21,130 --> 00:57:37,380
connects these servers and where normal

917
00:57:25,660 --> 00:57:40,899
network is connected to DM whether these

918
00:57:37,380 --> 00:57:43,170
devices are or not connected to the

919
00:57:40,900 --> 00:57:48,480
Internet

920
00:57:43,170 --> 00:57:48,480
IDs to be able to connect with different

921
00:57:56,790 --> 00:58:02,200
mobile local management

922
00:57:59,700 --> 00:58:05,980
Takeuchi Dobrynin Cerrito a mucho

923
00:58:02,200 --> 00:58:07,960
particular yeah many protocols that are

924
00:58:05,980 --> 00:58:12,570
pending and many things that we need to

925
00:58:07,960 --> 00:58:22,120
do when we can publish them many

926
00:58:12,570 --> 00:58:24,730
alternatives there are many lot of

927
00:58:22,120 --> 00:58:27,490
software the users of restricted

928
00:58:24,730 --> 00:58:30,220
accounts that can only let use this

929
00:58:27,490 --> 00:58:33,970
information so this is something we need

930
00:58:30,220 --> 00:58:36,790
to see if we commit one of these

931
00:58:33,970 --> 00:58:44,799
accounts that's our limitedness for now

932
00:58:36,790 --> 00:58:46,799
this is what we see is administrator we

933
00:58:44,800 --> 00:58:48,839
have to maintain these

934
00:58:46,799 --> 00:58:53,329
devices disconnected from everything

935
00:58:48,839 --> 00:58:53,328
these are devices that are useful

936
00:58:54,079 --> 00:58:59,849
restart these devices they have to be

937
00:58:57,209 --> 00:59:03,299
connected to me not let them communicate

938
00:58:59,849 --> 00:59:08,209
among themselves because this means that

939
00:59:03,299 --> 00:59:11,130
I'm going to be able to move sideways

940
00:59:08,209 --> 00:59:13,799
many of these devices use a very old

941
00:59:11,130 --> 00:59:19,949
software and nobody is paid enough

942
00:59:13,799 --> 00:59:33,029
attention questions we have one minute

943
00:59:19,949 --> 00:59:35,400
23 seconds any question thank you

944
00:59:33,029 --> 00:59:38,369
anything please connect it to the mail

945
00:59:35,400 --> 00:59:39,030
or whatever thank you very much for your

946
00:59:38,369 --> 00:59:46,339
attention

947
00:59:39,030 --> 00:59:46,339
[Applause]

