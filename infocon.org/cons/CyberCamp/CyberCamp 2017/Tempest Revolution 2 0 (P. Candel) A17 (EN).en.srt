1
00:00:17,170 --> 00:00:30,250
thank you very much hello good morning

2
00:00:26,779 --> 00:00:34,160
good afternoon to everybody and with

3
00:00:30,250 --> 00:00:37,129
everything you've said about me I don't

4
00:00:34,160 --> 00:00:40,699
need to introduce myself I guess so

5
00:00:37,129 --> 00:00:45,140
let's begin in order to have some time

6
00:00:40,699 --> 00:00:49,809
left for questions afterwards so I'd

7
00:00:45,140 --> 00:00:54,110
like to give you a short introduction on

8
00:00:49,809 --> 00:00:57,230
Tempest and we're going to be going to

9
00:00:54,110 --> 00:00:59,570
introduce everything that we have in

10
00:00:57,230 --> 00:01:02,449
this area first of all this is a

11
00:00:59,570 --> 00:01:04,910
technique that we know as covered

12
00:01:02,450 --> 00:01:07,610
channel technique it's a technique that

13
00:01:04,910 --> 00:01:10,280
we normally use the Sun evasion

14
00:01:07,610 --> 00:01:12,910
technique that we use in order to send

15
00:01:10,280 --> 00:01:21,080
information through legitimate channels

16
00:01:12,910 --> 00:01:26,060
that are not therefore being used where

17
00:01:21,080 --> 00:01:30,500
the certain users first as we may send

18
00:01:26,060 --> 00:01:32,630
information in the TCP IP headings and

19
00:01:30,500 --> 00:01:39,340
their front data fields that are not

20
00:01:32,630 --> 00:01:43,399
normally used nevertheless as regards a

21
00:01:39,340 --> 00:01:45,890
tempest what can we say about taking and

22
00:01:43,400 --> 00:01:47,869
filtering information in at eating and

23
00:01:45,890 --> 00:01:51,079
equipment without any sort of our

24
00:01:47,869 --> 00:01:53,750
connection to anything there's no Wi-Fi

25
00:01:51,079 --> 00:01:56,839
network there's no Ethernet there's no

26
00:01:53,750 --> 00:02:02,180
Bluetooth there's nothing whatsoever so

27
00:01:56,840 --> 00:02:05,240
can we actually take information we're

28
00:02:02,180 --> 00:02:09,619
interested in from it for those of you

29
00:02:05,240 --> 00:02:15,049
who don't know Tempest well this is a

30
00:02:09,619 --> 00:02:18,060
spec of NSA that is the bad guys but

31
00:02:15,049 --> 00:02:22,920
this is no NATO

32
00:02:18,060 --> 00:02:29,910
and Nate certification and through the

33
00:02:22,920 --> 00:02:34,679
leak of things that includes radio

34
00:02:29,910 --> 00:02:40,560
signals or the electro magnetic signals

35
00:02:34,680 --> 00:02:42,750
and is cover several methods spying and

36
00:02:40,560 --> 00:02:48,410
also equipment protection in order to

37
00:02:42,750 --> 00:02:59,720
avoid these information leaks this last

38
00:02:48,410 --> 00:03:04,140
part this is security of missions and

39
00:02:59,720 --> 00:03:08,519
these methods for instance these NSA

40
00:03:04,140 --> 00:03:11,190
methods here we may be good or bad guys

41
00:03:08,519 --> 00:03:13,260
all this is classified and here we have

42
00:03:11,190 --> 00:03:16,620
the protection standard so that

43
00:03:13,260 --> 00:03:19,500
sometimes are published by NSA or the

44
00:03:16,620 --> 00:03:22,440
Defense Department and they speak about

45
00:03:19,500 --> 00:03:25,110
the distance from equipment to the war

46
00:03:22,440 --> 00:03:26,970
equipment to the war for instance the

47
00:03:25,110 --> 00:03:29,880
things that we hadn't been paying

48
00:03:26,970 --> 00:03:33,000
attention to so far but it's something

49
00:03:29,880 --> 00:03:36,870
we can see in the industrial area in

50
00:03:33,000 --> 00:03:41,160
this case these things are contemplated

51
00:03:36,870 --> 00:03:46,560
here manufacturers strengthened chips

52
00:03:41,160 --> 00:03:51,480
they armour chips with filters armoring

53
00:03:46,560 --> 00:03:56,700
etc and what is happening here with all

54
00:03:51,480 --> 00:03:59,329
this most of us well here we have

55
00:03:56,700 --> 00:04:05,260
everything related to the

56
00:03:59,330 --> 00:04:05,260
League of electromagnetic emanations

57
00:04:06,370 --> 00:04:18,769
cell phones etc here we can discover

58
00:04:09,920 --> 00:04:26,169
certain patterns different sensors and

59
00:04:18,769 --> 00:04:29,630
all these leaks are analyzed and this is

60
00:04:26,170 --> 00:04:34,600
information that can be processed by any

61
00:04:29,630 --> 00:04:41,350
equipment so starting from this what we

62
00:04:34,600 --> 00:04:45,370
do is have a tempest attack on any

63
00:04:41,350 --> 00:04:49,730
electronic device that will emit

64
00:04:45,370 --> 00:04:53,900
electromagnetic radiations every time

65
00:04:49,730 --> 00:04:56,810
there's a small electrical current will

66
00:04:53,900 --> 00:05:01,520
generate electromagnetic pulses that

67
00:04:56,810 --> 00:05:04,520
will be radiated radiated as a visible

68
00:05:01,520 --> 00:05:11,289
radio waves they're invisible but they

69
00:05:04,520 --> 00:05:16,130
are there the CPU is emitting and we can

70
00:05:11,290 --> 00:05:19,760
amplify these signals we can send

71
00:05:16,130 --> 00:05:24,169
certain things to the CPU in order to

72
00:05:19,760 --> 00:05:26,960
try and modulate certain signals were

73
00:05:24,169 --> 00:05:31,219
interested in under these in these

74
00:05:26,960 --> 00:05:35,320
schemes we can see the normal boards and

75
00:05:31,220 --> 00:05:38,900
we see that everything is radiating and

76
00:05:35,320 --> 00:05:43,460
the idea is to send information in order

77
00:05:38,900 --> 00:05:45,770
to reach goals we must also say that

78
00:05:43,460 --> 00:05:50,409
this is a passive sort of attack as

79
00:05:45,770 --> 00:05:50,409
something that cannot be ducted because

80
00:05:50,830 --> 00:05:59,969
because we don't attach anything to the

81
00:05:53,990 --> 00:06:11,460
equipment it is our own equipment

82
00:05:59,970 --> 00:06:13,770
in danger here we wouldn't be able to

83
00:06:11,460 --> 00:06:18,390
detect somebody in the street with an

84
00:06:13,770 --> 00:06:24,870
equipment somebody looking for our CPU

85
00:06:18,390 --> 00:06:33,060
or the LED LEDs of a card or whatever

86
00:06:24,870 --> 00:06:35,730
and if we get too paranoid with arrived

87
00:06:33,060 --> 00:06:39,210
to this come to this situation

88
00:06:35,730 --> 00:06:45,500
so is this reality and we realized that

89
00:06:39,210 --> 00:06:48,299
this started many years ago also a

90
00:06:45,500 --> 00:06:51,870
message was sent with respect to the

91
00:06:48,300 --> 00:06:58,850
fact that signals will be taken and

92
00:06:51,870 --> 00:07:03,230
modulated simple codes etc with old

93
00:06:58,850 --> 00:07:06,810
using old monitors old screens we could

94
00:07:03,230 --> 00:07:15,710
take a song and it could be received in

95
00:07:06,810 --> 00:07:15,710
a normal radio projects in order to

96
00:07:19,880 --> 00:07:29,120
use this with FM and this is from 2016

97
00:07:24,500 --> 00:07:36,710
and here we can filter data through for

98
00:07:29,120 --> 00:07:42,560
instance certain systems right from a

99
00:07:36,710 --> 00:07:45,310
fans or ventilators or certain

100
00:07:42,560 --> 00:07:48,980
mechanical parts in the hard-disk

101
00:07:45,310 --> 00:07:51,970
with noises and Thurston's

102
00:07:48,980 --> 00:07:57,340
and we have this example here if you

103
00:07:51,970 --> 00:08:03,470
receive an SDR for instance this is a

104
00:07:57,340 --> 00:08:08,179
software-defined radio and here we can

105
00:08:03,470 --> 00:08:10,460
Speight screen where there's text and

106
00:08:08,180 --> 00:08:14,600
this is reproduced without any problem

107
00:08:10,460 --> 00:08:20,140
and this is a recent test with another

108
00:08:14,600 --> 00:08:25,010
sort of device and we can see that it is

109
00:08:20,140 --> 00:08:27,940
reproduced without any problem one needs

110
00:08:25,010 --> 00:08:32,150
to be very close to the screen but with

111
00:08:27,940 --> 00:08:33,710
some sort of aerial or antenna we see

112
00:08:32,150 --> 00:08:37,309
somebody in front of our house for

113
00:08:33,710 --> 00:08:45,670
instance who is doing this to us man

114
00:08:37,309 --> 00:08:48,380
here we come to the revolution here the

115
00:08:45,670 --> 00:08:55,810
target has to do with using something

116
00:08:48,380 --> 00:08:55,810
legitimate that cannot be canceled now

117
00:08:56,200 --> 00:09:02,050
sometimes there may be critical systems

118
00:08:58,700 --> 00:09:09,200
and somebody comes with a USB and

119
00:09:02,050 --> 00:09:11,420
updates it so this is a very specific

120
00:09:09,200 --> 00:09:15,440
operations and the idea is to provoke

121
00:09:11,420 --> 00:09:18,110
and intentioned leaked information

122
00:09:15,440 --> 00:09:21,880
leaked and then we have the system bus

123
00:09:18,110 --> 00:09:24,520
radio and here as you will see we have

124
00:09:21,880 --> 00:09:29,230
here we see

125
00:09:24,520 --> 00:09:32,949
where everything starts and the how well

126
00:09:29,230 --> 00:09:35,200
the idea was to run legitimate

127
00:09:32,950 --> 00:09:40,620
instructions in an equipment that will

128
00:09:35,200 --> 00:09:44,080
cause electromagnetic radiations by the

129
00:09:40,620 --> 00:09:46,840
noise that is generated here we have the

130
00:09:44,080 --> 00:09:50,710
development apart well we are given a

131
00:09:46,840 --> 00:09:53,800
series of instructions here manners and

132
00:09:50,710 --> 00:09:57,130
data from the CPU to memory from memory

133
00:09:53,800 --> 00:10:00,040
to CPU the rat the write or read or what

134
00:09:57,130 --> 00:10:07,200
happened what are we doing here

135
00:10:00,040 --> 00:10:07,199
well we simply send zeros and ones

136
00:10:07,860 --> 00:10:16,060
within a series of the series of timers

137
00:10:13,630 --> 00:10:22,210
and very quick things in order to try

138
00:10:16,060 --> 00:10:28,300
and get signals another target is to

139
00:10:22,210 --> 00:10:33,970
send information through radio carrying

140
00:10:28,300 --> 00:10:44,740
wave the modulated amplitude this wave

141
00:10:33,970 --> 00:10:48,150
that may vary here we have the bus the

142
00:10:44,740 --> 00:10:51,310
CPU or antenna everything's integrated

143
00:10:48,150 --> 00:10:53,530
and has come from the original project

144
00:10:51,310 --> 00:10:56,680
so here we have these signals we want to

145
00:10:53,530 --> 00:11:01,420
transmit the carriers and their time and

146
00:10:56,680 --> 00:11:05,060
here we can start doing things so

147
00:11:01,420 --> 00:11:06,529
I'm not going to go in details here

148
00:11:05,060 --> 00:11:11,900
because this is something that's already

149
00:11:06,529 --> 00:11:14,620
been presented old equipment that

150
00:11:11,900 --> 00:11:18,920
transmitted signals through Morse but

151
00:11:14,620 --> 00:11:23,420
the thing is that this takes a time and

152
00:11:18,920 --> 00:11:29,740
apart from this all this is based on

153
00:11:23,420 --> 00:11:33,290
very low frequency frequency frequency

154
00:11:29,740 --> 00:11:38,480
somebody has an FM receiver first ins

155
00:11:33,290 --> 00:11:43,099
the switch at a.m. and you leave out a

156
00:11:38,480 --> 00:11:46,160
whole set of frequencies and here you go

157
00:11:43,100 --> 00:12:02,080
up and play around a series of things

158
00:11:46,160 --> 00:12:06,740
and you can do this much modulate things

159
00:12:02,080 --> 00:12:09,370
more speed preserving the integrity of

160
00:12:06,740 --> 00:12:13,280
all the information that's received and

161
00:12:09,370 --> 00:12:21,250
here we see the different problems we

162
00:12:13,280 --> 00:12:21,250
have with Morse code difference between

163
00:12:23,080 --> 00:12:30,440
line new characters between the

164
00:12:27,140 --> 00:12:34,790
different things when we begin when we

165
00:12:30,440 --> 00:12:39,339
end message whatever server was a bit of

166
00:12:34,790 --> 00:12:47,689
a problem so what could we do based on

167
00:12:39,339 --> 00:12:51,970
theories of frequencies and Hertz many

168
00:12:47,690 --> 00:12:54,620
things we could say well I'm going to

169
00:12:51,970 --> 00:12:56,810
each of the characters that I'm going to

170
00:12:54,620 --> 00:12:59,750
transmit I'm going to sign something to

171
00:12:56,810 --> 00:13:03,529
them or I'm going to try and make sure

172
00:12:59,750 --> 00:13:06,060
that this will beep and then once it

173
00:13:03,529 --> 00:13:09,200
beeps we'll

174
00:13:06,060 --> 00:13:09,199
[Music]

175
00:13:11,590 --> 00:13:18,500
this is the main routine this doesn't

176
00:13:15,920 --> 00:13:20,660
change whereas in general respect the

177
00:13:18,500 --> 00:13:26,480
original project these are instructions

178
00:13:20,660 --> 00:13:29,449
with the stream and here we send one and

179
00:13:26,480 --> 00:13:34,310
two zeroes and we sent it quickly and we

180
00:13:29,450 --> 00:13:38,000
know when forth and here we have the

181
00:13:34,310 --> 00:13:41,869
zeros the ones that we are taking and

182
00:13:38,000 --> 00:13:51,350
sending and the formula is quite

183
00:13:41,870 --> 00:13:56,320
straightforward we want to be when we

184
00:13:51,350 --> 00:13:56,320
receive the signal we can you take it

185
00:13:59,650 --> 00:14:07,970
may be some things that maybe are

186
00:14:04,150 --> 00:14:13,340
necessary so now we go to the first demo

187
00:14:07,970 --> 00:14:20,360
and let's see if it works see Matthew on

188
00:14:13,340 --> 00:14:28,420
a second FAC teriyaki okay this I have

189
00:14:20,360 --> 00:14:49,400
in my hand is radio set bought from

190
00:14:28,420 --> 00:14:51,849
Chinese Chinese turn it on now you can

191
00:14:49,400 --> 00:14:51,850
hear it

192
00:14:55,780 --> 00:15:03,730
[Applause]

193
00:14:58,859 --> 00:15:06,999
well a ASAS incremental okay si papa

194
00:15:03,730 --> 00:15:12,519
I'll call it key and I'll show you the

195
00:15:06,999 --> 00:15:17,350
code and here's the routine and series

196
00:15:12,519 --> 00:15:22,859
of sounds here we just to see whether

197
00:15:17,350 --> 00:15:22,859
this R can reproduce these sounds

198
00:15:40,609 --> 00:15:48,480
bomba Ramos Eva mosaicism are we and

199
00:15:45,480 --> 00:15:57,959
let's see whether we can reproduce this

200
00:15:48,480 --> 00:16:01,890
let's see if we can take it out we can

201
00:15:57,959 --> 00:16:05,739
extract it you hear it yes

202
00:16:01,890 --> 00:16:05,740
[Music]

203
00:16:13,810 --> 00:16:15,810
ah

204
00:16:17,220 --> 00:16:20,330
[Music]

205
00:16:20,670 --> 00:16:30,599
yeah

206
00:16:21,790 --> 00:16:35,170
gareki daddy as you can see receive

207
00:16:30,600 --> 00:16:42,310
sounds no problem so we can just play

208
00:16:35,170 --> 00:16:44,949
around where the sound right so and this

209
00:16:42,310 --> 00:16:49,510
is where things start getting more

210
00:16:44,950 --> 00:16:52,540
complex where these beeps receive it

211
00:16:49,510 --> 00:16:57,760
remotely now we can start talking about

212
00:16:52,540 --> 00:17:01,780
symbols on modulations and the bit rate

213
00:16:57,760 --> 00:17:04,020
that we can achieve codes great codes

214
00:17:01,780 --> 00:17:08,770
everything else

215
00:17:04,020 --> 00:17:13,980
maybe we sound after another in order

216
00:17:08,770 --> 00:17:17,139
not to have any problems to receiving

217
00:17:13,980 --> 00:17:19,870
problem receiving these sensor we've

218
00:17:17,140 --> 00:17:24,339
done we've run several tests and the

219
00:17:19,869 --> 00:17:48,790
first thing we had to decide was to for

220
00:17:24,339 --> 00:17:53,530
instance simulate 16 QAM ta'kenya causes

221
00:17:48,790 --> 00:17:57,940
no permit the ideas for this letter send

222
00:17:53,530 --> 00:18:04,060
more informations we can assign a whole

223
00:17:57,940 --> 00:18:10,210
table and transmit 4 bits with 16 is 16

224
00:18:04,060 --> 00:18:16,200
notes so for instance with gray code

225
00:18:10,210 --> 00:18:22,120
in order not to repeat in order to have

226
00:18:16,200 --> 00:18:27,160
one bit variation so that we may be able

227
00:18:22,120 --> 00:18:35,830
to do so here we've chosen a series of

228
00:18:27,160 --> 00:18:39,160
notes with given duration I wanted to

229
00:18:35,830 --> 00:18:55,120
try this out and see if we could hear

230
00:18:39,160 --> 00:18:58,210
this more or less you will note 250

231
00:18:55,120 --> 00:19:02,010
milliseconds emotion last and then

232
00:18:58,210 --> 00:19:08,790
there's a gap of 50 milliseconds between

233
00:19:02,010 --> 00:19:14,730
notes in between notes I wanna see

234
00:19:08,790 --> 00:19:18,100
whether the receiver can decode this

235
00:19:14,730 --> 00:19:20,790
will be able to hear it and we won't be

236
00:19:18,100 --> 00:19:20,790
able to tell

237
00:19:26,720 --> 00:19:46,970
this is a talent a wardrobe exactly the

238
00:19:29,990 --> 00:19:49,340
same as the other one gonna skip this

239
00:19:46,970 --> 00:19:56,990
because we don't have enough time these

240
00:19:49,340 --> 00:20:00,199
are the results of different tests you

241
00:19:56,990 --> 00:20:02,720
know musical notes now there's a series

242
00:20:00,200 --> 00:20:06,620
of frequencies and of course depending

243
00:20:02,720 --> 00:20:09,410
on how well you can hear it some of

244
00:20:06,620 --> 00:20:10,000
these notes you can hear others you

245
00:20:09,410 --> 00:20:15,530
don't

246
00:20:10,000 --> 00:20:18,050
for instance we play a note for some

247
00:20:15,530 --> 00:20:25,460
time and you can hear these or you can

248
00:20:18,050 --> 00:20:34,970
tell there are some micro cuts micro

249
00:20:25,460 --> 00:20:41,360
interruptions here we 16 ones with a

250
00:20:34,970 --> 00:20:47,540
code have a character X character let's

251
00:20:41,360 --> 00:20:52,639
b-y-o-see on according to the bits the

252
00:20:47,540 --> 00:20:57,200
notes of corresponding to this in order

253
00:20:52,640 --> 00:21:01,420
to hear it oh that's a compile this and

254
00:20:57,200 --> 00:21:01,420
let's take a look at it

255
00:21:05,470 --> 00:21:17,190
[Music]

256
00:21:08,340 --> 00:21:17,189
it vamos al ittle put your nose in it

257
00:21:18,270 --> 00:21:24,470
a or a second SS Atari RF antenna

258
00:21:27,940 --> 00:21:43,080
[Music]

259
00:21:29,790 --> 00:21:52,530
I don't know if you can hear it and hear

260
00:21:43,080 --> 00:21:59,490
it just show you

261
00:21:52,530 --> 00:22:06,120
duration to see what we could do so we

262
00:21:59,490 --> 00:22:10,530
do see here that's just sound receiver

263
00:22:06,120 --> 00:22:15,899
for instance I can hear notes see

264
00:22:10,530 --> 00:22:18,750
whatever were the given duration no

265
00:22:15,900 --> 00:22:24,540
problems starting from this we have this

266
00:22:18,750 --> 00:22:28,950
I see a table and what we did what I

267
00:22:24,540 --> 00:22:33,120
told you the MSD the LSB we divided into

268
00:22:28,950 --> 00:22:37,550
hexadecimal and what we want to do is to

269
00:22:33,120 --> 00:22:43,949
be able to transmit this must be LSB

270
00:22:37,550 --> 00:22:46,050
cetera and we listen to the 50

271
00:22:43,950 --> 00:22:49,710
milliseconds in order to transmit the

272
00:22:46,050 --> 00:22:54,240
MSB and LSB what we did was to define 50

273
00:22:49,710 --> 00:23:00,590
millisecond gap so in order to transmit

274
00:22:54,240 --> 00:23:06,250
each bit we would need of course

275
00:23:00,590 --> 00:23:10,260
including gaps we would need 12 slots

276
00:23:06,250 --> 00:23:15,820
this is around 500 microseconds

277
00:23:10,260 --> 00:23:24,850
character so obviously would be speaking

278
00:23:15,820 --> 00:23:27,750
of rates around thousand bits per

279
00:23:24,850 --> 00:23:32,040
seconds I don't have you remember old

280
00:23:27,750 --> 00:23:42,160
routers or modems were speaking about

281
00:23:32,040 --> 00:23:44,379
ridiculous speeds of course never we

282
00:23:42,160 --> 00:23:51,670
could never imagine that in a normal

283
00:23:44,380 --> 00:24:02,740
house and we could achieve the sort of

284
00:23:51,670 --> 00:24:04,870
transmission we of course with

285
00:24:02,740 --> 00:24:06,690
compression and everything else even

286
00:24:04,870 --> 00:24:09,340
though I'm not speaking about

287
00:24:06,690 --> 00:24:13,270
compressing data

288
00:24:09,340 --> 00:24:19,899
I'm just speaking about the part the

289
00:24:13,270 --> 00:24:24,700
project things that can be seen just to

290
00:24:19,900 --> 00:24:26,610
show you what we can take and what we

291
00:24:24,700 --> 00:24:30,340
can do with it

292
00:24:26,610 --> 00:24:33,729
Mackie narrows my imaginary okay there

293
00:24:30,340 --> 00:24:38,770
Emma for instance if I wanna transmit

294
00:24:33,730 --> 00:24:46,560
this file it's a very small file take up

295
00:24:38,770 --> 00:24:49,560
too much time with this just create some

296
00:24:46,560 --> 00:24:49,560
routine

297
00:24:51,840 --> 00:25:04,689
I'll give it you know Tina Mott's my son

298
00:24:54,610 --> 00:25:08,769
seemed very simple 16 values we define

299
00:25:04,690 --> 00:25:13,269
the gap remain routine the logo of

300
00:25:08,769 --> 00:25:16,980
course just to show you what we're going

301
00:25:13,269 --> 00:25:16,980
to take what we're going to send

302
00:25:17,190 --> 00:25:24,960
corresponds to each character so

303
00:25:20,649 --> 00:25:24,959
obviously there's no problem with this

304
00:25:36,340 --> 00:26:10,699
Elmo's a compile this now I see let

305
00:26:04,820 --> 00:26:11,960
Elijah character character this is

306
00:26:10,700 --> 00:26:14,859
something you wouldn't see in a normal

307
00:26:11,960 --> 00:26:14,859
Tempest

308
00:26:37,520 --> 00:26:40,660
[Music]

309
00:26:42,860 --> 00:26:51,879
[Music]

310
00:26:47,190 --> 00:26:54,549
see La Veta is a super mocha breve esto

311
00:26:51,879 --> 00:26:56,109
la salle de Vaca latina note on you can

312
00:26:54,549 --> 00:26:59,229
see how the notes go up and down

313
00:26:56,109 --> 00:27:06,309
probably what can we say here maybe an

314
00:26:59,229 --> 00:27:11,499
AP starts transmitting we're about 250

315
00:27:06,309 --> 00:27:15,279
milliseconds of 414 notes then it goes

316
00:27:11,499 --> 00:27:19,479
to rap then it transmits the next one

317
00:27:15,279 --> 00:27:24,849
then the then the space or any of the

318
00:27:19,479 --> 00:27:28,779
characters and then logically at the

319
00:27:24,849 --> 00:27:31,989
reception phase we can take that audio

320
00:27:28,779 --> 00:27:34,960
that audio file we receive and we can

321
00:27:31,989 --> 00:27:38,649
fine tune a little bit more so that we

322
00:27:34,960 --> 00:27:41,859
can receive a perfect sound and with a

323
00:27:38,649 --> 00:27:46,018
Python we can do several things and all

324
00:27:41,859 --> 00:27:46,019
the to receive what we've just gotten

325
00:27:48,269 --> 00:27:57,330
solutions troubleshooting well the

326
00:27:52,479 --> 00:27:59,919
problem can be a broadcast transmission

327
00:27:57,330 --> 00:28:01,539
anyone who's in the same frequency is

328
00:27:59,919 --> 00:28:05,469
listening and there's nothing we can do

329
00:28:01,539 --> 00:28:13,599
about it well we can play something they

330
00:28:05,469 --> 00:28:15,759
like and hide the notes behind the song

331
00:28:13,599 --> 00:28:19,359
that this person likes we could occur up

332
00:28:15,759 --> 00:28:24,729
to analyze the frequency and we can also

333
00:28:19,359 --> 00:28:29,859
have problems with binary files if you

334
00:28:24,729 --> 00:28:33,249
have to transmit ask C or well that's ok

335
00:28:29,859 --> 00:28:36,668
from 0 to 127 but if we use all the

336
00:28:33,249 --> 00:28:39,700
things or if I want to introduce the end

337
00:28:36,669 --> 00:28:43,749
of a file for example that would be a

338
00:28:39,700 --> 00:28:46,440
problem and that is even a bigger

339
00:28:43,749 --> 00:28:50,529
problem if the number of characters is

340
00:28:46,440 --> 00:28:54,399
limited and this is how the real tempest

341
00:28:50,529 --> 00:28:57,140
works first of all there is an encoding

342
00:28:54,399 --> 00:29:04,939
we extract a public key

343
00:28:57,140 --> 00:29:08,270
in RSA and with that we generate an IV

344
00:29:04,940 --> 00:29:14,240
you know the to take the files away what

345
00:29:08,270 --> 00:29:20,389
we do next is to our code by files with

346
00:29:14,240 --> 00:29:22,700
an Aes to the five six CBC mode that's

347
00:29:20,390 --> 00:29:25,460
important and what we do is take him

348
00:29:22,700 --> 00:29:28,190
everything from that file and from that

349
00:29:25,460 --> 00:29:31,280
we generate a binary file that would

350
00:29:28,190 --> 00:29:33,740
lead us to the next step which is once

351
00:29:31,280 --> 00:29:38,059
everything else is done we encode the I

352
00:29:33,740 --> 00:29:41,330
view of the public key with an RS a 409

353
00:29:38,059 --> 00:29:46,730
six in order to store it because all the

354
00:29:41,330 --> 00:29:52,790
Y's when it's in the receiver I won't be

355
00:29:46,730 --> 00:29:55,070
able to revert that are symmetric so

356
00:29:52,790 --> 00:29:59,090
who's going to have the private key well

357
00:29:55,070 --> 00:30:07,610
the one who created the tempest so this

358
00:29:59,090 --> 00:30:11,149
person is the only one who can extract

359
00:30:07,610 --> 00:30:14,240
that public key and receive it and the

360
00:30:11,150 --> 00:30:16,960
same goes for the next files then there

361
00:30:14,240 --> 00:30:21,980
is another problem related to coding

362
00:30:16,960 --> 00:30:25,160
what about the coding as you can see

363
00:30:21,980 --> 00:30:29,090
here this is something that we've used

364
00:30:25,160 --> 00:30:34,100
on 64 base with transformed everything

365
00:30:29,090 --> 00:30:39,370
into 64 base we could have used the

366
00:30:34,100 --> 00:30:44,870
encode or something that allows us to

367
00:30:39,370 --> 00:30:47,418
transform a binary file into a set of

368
00:30:44,870 --> 00:30:53,629
characters that I'm going to be able to

369
00:30:47,419 --> 00:30:59,120
receive more problems well if we are on

370
00:30:53,630 --> 00:31:03,500
base 64 and if we encode that we may

371
00:30:59,120 --> 00:31:07,159
have difficulties in telling a capital a

372
00:31:03,500 --> 00:31:08,540
from a lowercase a because this is

373
00:31:07,160 --> 00:31:08,710
something that you're going to have and

374
00:31:08,540 --> 00:31:11,678
say

375
00:31:08,710 --> 00:31:14,350
two for bass so what do we do in this

376
00:31:11,679 --> 00:31:17,799
case well a replacement a

377
00:31:14,350 --> 00:31:19,809
standardization and this entails

378
00:31:17,799 --> 00:31:23,020
replacing the characters we don't like

379
00:31:19,809 --> 00:31:24,730
for all the characters for example if we

380
00:31:23,020 --> 00:31:28,299
have to change from uppercase to

381
00:31:24,730 --> 00:31:30,610
lowercase we insert two points and

382
00:31:28,299 --> 00:31:34,389
change the character for example a plus

383
00:31:30,610 --> 00:31:37,418
sign can be replaced by a minus sign or

384
00:31:34,390 --> 00:31:41,070
a space between files can be replaced by

385
00:31:37,419 --> 00:31:46,450
an apostrophe so this allows us to

386
00:31:41,070 --> 00:31:49,178
transmit to broadcast through all the

387
00:31:46,450 --> 00:31:51,700
frequencies these characters that were a

388
00:31:49,179 --> 00:31:55,120
little bit troublesome in the beginning

389
00:31:51,700 --> 00:31:58,929
when it comes to reception that's a

390
00:31:55,120 --> 00:32:03,090
question that a lot of people ask this

391
00:31:58,929 --> 00:32:05,559
is a very simple thing I think it is the

392
00:32:03,090 --> 00:32:09,939
transmission part that is the tricky one

393
00:32:05,559 --> 00:32:14,110
but still the one who wants to receive

394
00:32:09,940 --> 00:32:19,990
this just needs to have this w AP

395
00:32:14,110 --> 00:32:21,668
recorded and I'm talking about Python

396
00:32:19,990 --> 00:32:24,340
here but we would be talking we couldn't

397
00:32:21,669 --> 00:32:31,480
be talking about all the things so all

398
00:32:24,340 --> 00:32:36,399
we have to do this package get rid of

399
00:32:31,480 --> 00:32:39,940
everything that is unuseful determine

400
00:32:36,399 --> 00:32:42,879
what is useful and what it corresponds

401
00:32:39,940 --> 00:32:45,610
with and then the machine is going to do

402
00:32:42,880 --> 00:32:50,890
it itself and the transformation is

403
00:32:45,610 --> 00:32:53,350
going to take place here you here's when

404
00:32:50,890 --> 00:32:57,010
you find out that this kind of programs

405
00:32:53,350 --> 00:33:00,309
are really useful I'm going to go down

406
00:32:57,010 --> 00:33:02,470
to the next demo this is a big fail this

407
00:33:00,309 --> 00:33:05,320
is about a big fail that has been pretty

408
00:33:02,470 --> 00:33:11,500
recent I'm sure you've heard of it and

409
00:33:05,320 --> 00:33:14,000
it was the roots without password as an

410
00:33:11,500 --> 00:33:17,390
epic fail

411
00:33:14,000 --> 00:33:20,970
so what can we do about this

412
00:33:17,390 --> 00:33:23,460
what can how can we do whatever we want

413
00:33:20,970 --> 00:33:27,240
with the route without a password I'm

414
00:33:23,460 --> 00:33:32,250
showing this for OS X but this is the

415
00:33:27,240 --> 00:33:35,550
same for Windows or for Linux all of us

416
00:33:32,250 --> 00:33:37,980
using Intel or subject to this kind of

417
00:33:35,550 --> 00:33:40,970
thing all the ways we can put this

418
00:33:37,980 --> 00:33:44,610
inside the fridge or something like that

419
00:33:40,970 --> 00:33:47,150
so one thing we came up with was

420
00:33:44,610 --> 00:33:53,939
thinking well where are the cool things

421
00:33:47,150 --> 00:33:57,080
well it is usually in the keychain so

422
00:33:53,940 --> 00:34:00,840
what do we do we take the keychain and

423
00:33:57,080 --> 00:34:07,370
we store it somewhere else but there is

424
00:34:00,840 --> 00:34:10,610
a problem for all the cloud data etc

425
00:34:07,370 --> 00:34:13,679
that's impossible we cannot copy this

426
00:34:10,610 --> 00:34:25,490
however we can take some things away

427
00:34:13,679 --> 00:34:31,830
from other places for this demo I've

428
00:34:25,489 --> 00:34:41,189
worked a little bit harder I'm going to

429
00:34:31,830 --> 00:34:44,759
erase this what I'm going to do this way

430
00:34:41,190 --> 00:34:47,360
we can see a little bit what I'm about

431
00:34:44,760 --> 00:34:47,360
to do

432
00:34:48,199 --> 00:34:57,299
imagine I'm going to focus really to the

433
00:34:53,668 --> 00:35:00,569
important things I'm going to native

434
00:34:57,300 --> 00:35:01,860
commands and what I do is taking away

435
00:35:00,570 --> 00:35:10,920
the key

436
00:35:01,860 --> 00:35:23,670
I take away all the things not Edo files

437
00:35:10,920 --> 00:35:26,030
for example not not shadow files so if

438
00:35:23,670 --> 00:35:28,410
you look at the top here the

439
00:35:26,030 --> 00:35:31,470
authorization is denied the permission

440
00:35:28,410 --> 00:35:34,980
is denied if I try with my user it is

441
00:35:31,470 --> 00:35:36,480
denied imagine we've introduced this bug

442
00:35:34,980 --> 00:35:40,580
into an equipment

443
00:35:36,480 --> 00:35:40,580
well the permission is denied of course

444
00:35:44,960 --> 00:35:57,480
so with this script we just have to use

445
00:35:50,070 --> 00:36:03,270
what is on top and in this case we've

446
00:35:57,480 --> 00:36:07,560
taken notes ideas local default users

447
00:36:03,270 --> 00:36:12,840
and plist so it's been able to gain

448
00:36:07,560 --> 00:36:19,080
access and now for example I can think

449
00:36:12,840 --> 00:36:24,810
about creating in the T&P the file with

450
00:36:19,080 --> 00:36:29,490
hashes dog zip so with this whole I've

451
00:36:24,810 --> 00:36:33,170
added everything from the keychain so

452
00:36:29,490 --> 00:36:33,169
here I have this file

453
00:36:38,980 --> 00:36:45,970
Oh sake okay here you can see there's

454
00:36:43,720 --> 00:36:50,439
nothing so what I have in the end is

455
00:36:45,970 --> 00:37:00,009
this file in the TMP that is called

456
00:36:50,440 --> 00:37:04,420
hashes and now I say to tempest I want

457
00:37:00,010 --> 00:37:08,589
to transmit that file with that text

458
00:37:04,420 --> 00:37:12,310
inside and since this is something that

459
00:37:08,589 --> 00:37:16,540
we don't usually automatic eyes we

460
00:37:12,310 --> 00:37:20,290
create a new tempest and The Tempest by

461
00:37:16,540 --> 00:37:23,230
itself generates this and then I change

462
00:37:20,290 --> 00:37:25,839
it if I want if you know how Morrissey

463
00:37:23,230 --> 00:37:29,010
works you can see that this is pretty

464
00:37:25,839 --> 00:37:32,710
straight forward this description

465
00:37:29,010 --> 00:37:37,300
Cybercom 17 for example that'll do

466
00:37:32,710 --> 00:37:53,380
and here the file that I want to take

467
00:37:37,300 --> 00:37:56,950
away it's a file named hashes so this is

468
00:37:53,380 --> 00:37:59,950
a binary that is going to be run with

469
00:37:56,950 --> 00:38:03,509
the rights that the user has sometimes

470
00:37:59,950 --> 00:38:06,220
we tend to think that the user is the

471
00:38:03,510 --> 00:38:09,520
administrator and that it has a lot of

472
00:38:06,220 --> 00:38:12,310
rights in the machine but in many cases

473
00:38:09,520 --> 00:38:15,910
it isn't so and we need to elevate the

474
00:38:12,310 --> 00:38:18,970
rights so we can introduce a small

475
00:38:15,910 --> 00:38:21,160
exploit in order to elevate of the

476
00:38:18,970 --> 00:38:23,529
privileges I didn't have time in this

477
00:38:21,160 --> 00:38:29,470
case to elevate this part of the root so

478
00:38:23,530 --> 00:38:35,890
I did it by hand so with the OS a script

479
00:38:29,470 --> 00:38:44,020
I just get what I'm interested in that

480
00:38:35,890 --> 00:38:47,680
is the user so in this case I can turn

481
00:38:44,020 --> 00:38:50,310
it into polymorphic and generate this

482
00:38:47,680 --> 00:38:50,310
Tempest

483
00:38:54,329 --> 00:39:00,910
and now what I can see are the

484
00:38:58,060 --> 00:39:03,839
characteristics the binaries as much of

485
00:39:00,910 --> 00:39:07,569
fact I'm going to download the binary

486
00:39:03,839 --> 00:39:11,140
the decoder also because all the wise

487
00:39:07,569 --> 00:39:17,349
the demo wouldn't make a lot of sense

488
00:39:11,140 --> 00:39:18,940
and here have the source code and if we

489
00:39:17,349 --> 00:39:22,540
take a closer look we can see it's

490
00:39:18,940 --> 00:39:24,550
basically the same thing with a few more

491
00:39:22,540 --> 00:39:26,619
stuff included it's not really

492
00:39:24,550 --> 00:39:29,619
complicated the code is quite

493
00:39:26,619 --> 00:39:32,770
straightforward as I say and here we can

494
00:39:29,619 --> 00:39:37,300
see the key we have the opportunity to

495
00:39:32,770 --> 00:39:43,720
continue transmitted in Morsi and it's

496
00:39:37,300 --> 00:39:47,710
not excessively complex what do we need

497
00:39:43,720 --> 00:39:57,970
to do next that easy we need to run the

498
00:39:47,710 --> 00:40:08,950
tempest here and the demo so this file

499
00:39:57,970 --> 00:40:11,848
stands for The Tempest and this is the

500
00:40:08,950 --> 00:40:18,549
one it corresponds to I'm going to grant

501
00:40:11,849 --> 00:40:23,430
rights and what we're going to do next

502
00:40:18,550 --> 00:40:28,270
and the machine is this we would use the

503
00:40:23,430 --> 00:40:33,790
receiver to listen we would use our wire

504
00:40:28,270 --> 00:40:36,630
and we would generate the file I know

505
00:40:33,790 --> 00:40:36,630
you can hear it

506
00:40:40,010 --> 00:40:42,760
[Applause]

507
00:40:41,580 --> 00:40:42,960
[Music]

508
00:40:42,760 --> 00:40:47,900
[Applause]

509
00:40:42,960 --> 00:40:48,100
[Music]

510
00:40:47,900 --> 00:40:51,480
[Applause]

511
00:40:48,100 --> 00:40:51,480
[Music]

512
00:40:53,840 --> 00:41:01,260
so what does this tell you this goes at

513
00:40:57,300 --> 00:41:06,960
a programmed space that enables us to

514
00:41:01,260 --> 00:41:09,890
see the different leaps we can run it at

515
00:41:06,960 --> 00:41:16,890
a faster speed evil one to that's up to

516
00:41:09,890 --> 00:41:20,640
you that's up to you and your choice and

517
00:41:16,890 --> 00:41:28,440
here you can just make up anything you

518
00:41:20,640 --> 00:41:31,259
want now next step would be to process

519
00:41:28,440 --> 00:41:35,730
an audio file that we've gotten and

520
00:41:31,260 --> 00:41:45,470
received with everything so now once the

521
00:41:35,730 --> 00:41:49,290
file has been processed we have a file

522
00:41:45,470 --> 00:41:53,459
that we can see here and if you remember

523
00:41:49,290 --> 00:41:55,890
what I said about replacements and the

524
00:41:53,460 --> 00:42:05,640
coulomb for example here we can see an

525
00:41:55,890 --> 00:42:08,730
apostrophe seventh or tenth line that

526
00:42:05,640 --> 00:42:16,890
indicates where the lockers are that's

527
00:42:08,730 --> 00:42:21,780
the most part of the tempest this could

528
00:42:16,890 --> 00:42:24,029
be of course automatic and that's what

529
00:42:21,780 --> 00:42:27,060
we would like to do in the part of the

530
00:42:24,030 --> 00:42:34,710
receiver what do we have in the receiver

531
00:42:27,060 --> 00:42:38,670
part well if everything is ok now it can

532
00:42:34,710 --> 00:42:42,180
take and process it takes a while

533
00:42:38,670 --> 00:42:48,470
because the finals pretty long what we

534
00:42:42,180 --> 00:42:58,230
end up having is a file which has been

535
00:42:48,470 --> 00:43:00,848
able to have the attacker it's saying

536
00:42:58,230 --> 00:43:08,619
that this is a binary file I'm going to

537
00:43:00,849 --> 00:43:08,619
say that it's not the spoil for instance

538
00:43:12,039 --> 00:43:21,799
if we look at it when I compressed it it

539
00:43:17,690 --> 00:43:26,049
became a zip file so since the attacker

540
00:43:21,799 --> 00:43:32,779
is aware of that all I have to do is

541
00:43:26,049 --> 00:43:40,270
decompress and taking advantage of the

542
00:43:32,779 --> 00:43:45,109
bug we get a library we get a keychain

543
00:43:40,270 --> 00:43:51,470
and we get the system keychain without a

544
00:43:45,109 --> 00:43:57,380
lot of trouble well more interesting

545
00:43:51,470 --> 00:44:04,368
things inside the bar the default the

546
00:43:57,380 --> 00:44:07,279
users inside we have this this is binary

547
00:44:04,369 --> 00:44:10,579
but they include my hash because I stole

548
00:44:07,279 --> 00:44:16,460
it from myself so in the day we can see

549
00:44:10,579 --> 00:44:19,460
the roots dot piste and when we open and

550
00:44:16,460 --> 00:44:26,210
look we get all the passwords and

551
00:44:19,460 --> 00:44:29,660
everything we want so this could

552
00:44:26,210 --> 00:44:34,430
actually be useful in order to filter

553
00:44:29,660 --> 00:44:38,660
out the information we need inside that

554
00:44:34,430 --> 00:44:41,720
machine so this was all thank you very

555
00:44:38,660 --> 00:44:44,379
much for your attendance we have some

556
00:44:41,720 --> 00:44:44,379
time for Q&A

557
00:44:49,030 --> 00:44:54,570
is it employees

558
00:44:52,180 --> 00:44:57,759
well if I knew for all the questions

559
00:44:54,570 --> 00:44:59,940
next one is on you heavy thank you very

560
00:44:57,760 --> 00:44:59,940
much

561
00:45:06,319 --> 00:45:08,380
you

