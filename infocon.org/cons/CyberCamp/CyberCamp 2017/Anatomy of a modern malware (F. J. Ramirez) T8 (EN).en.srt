1
00:00:18,880 --> 00:00:27,439
when holla holla todos sorry Franklin me

2
00:00:22,279 --> 00:00:31,310
their name is friend Ramirez so how

3
00:00:27,439 --> 00:00:34,129
easily the bad guys can f the world what

4
00:00:31,310 --> 00:00:38,839
because we can't say F blast the rest of

5
00:00:34,129 --> 00:00:43,150
the word legal notice this is to

6
00:00:38,839 --> 00:00:47,980
practice so you can know don't be bad

7
00:00:43,150 --> 00:00:51,469
so we'll go little by little who am hi

8
00:00:47,980 --> 00:00:54,019
I'm Fran I work in telefónica and 11

9
00:00:51,469 --> 00:00:56,719
parts I have a blog called

10
00:00:54,020 --> 00:01:01,100
play typically with others and I speak

11
00:00:56,719 --> 00:01:05,229
about freak I team and have a book about

12
00:01:01,100 --> 00:01:09,610
micro stories and history of IT

13
00:01:05,229 --> 00:01:15,530
archaeology ninety and all these topics

14
00:01:09,610 --> 00:01:17,270
this talk I've given a presentation with

15
00:01:15,530 --> 00:01:21,560
Pablo Contreras better a colleague of

16
00:01:17,270 --> 00:01:25,009
mine he's a security and we've always

17
00:01:21,560 --> 00:01:29,539
modified this talk in order to adapt to

18
00:01:25,009 --> 00:01:32,869
the various events and now I didn't want

19
00:01:29,539 --> 00:01:34,910
to tell you about this but anyway this

20
00:01:32,869 --> 00:01:36,860
happened to a friend of a friend of a

21
00:01:34,910 --> 00:01:43,369
friend in a university that I won't

22
00:01:36,860 --> 00:01:46,670
mention at the time the operative system

23
00:01:43,369 --> 00:01:49,399
were practices were done on this type of

24
00:01:46,670 --> 00:01:52,310
computer with nothing in sight not even

25
00:01:49,399 --> 00:01:55,280
a hard drive and one day let's change it

26
00:01:52,310 --> 00:01:59,420
they said we'll give you a display and

27
00:01:55,280 --> 00:02:03,349
this is what we got now we're gonna

28
00:01:59,420 --> 00:02:08,080
change it again bigger biggest screen in

29
00:02:03,349 --> 00:02:14,300
green so we were just blind in the room

30
00:02:08,080 --> 00:02:20,270
it was full of PCs a friend of a friend

31
00:02:14,300 --> 00:02:22,310
of a friend of mine said yesterday this

32
00:02:20,270 --> 00:02:25,719
was the only machine that was there and

33
00:02:22,310 --> 00:02:30,319
there was a diskette driver the other

34
00:02:25,719 --> 00:02:34,519
terminals have had just a screen

35
00:02:30,319 --> 00:02:39,589
so this friend of a friend said ye we

36
00:02:34,519 --> 00:02:42,109
can put a cake a keylogger because we

37
00:02:39,590 --> 00:02:44,450
wanted to finish our practice and use

38
00:02:42,109 --> 00:02:47,180
this PC put our this sketch in it and

39
00:02:44,450 --> 00:02:49,700
then download whatever we put this

40
00:02:47,180 --> 00:02:50,209
friend of a friend start to think let's

41
00:02:49,700 --> 00:02:56,238
do it

42
00:02:50,209 --> 00:02:57,739
in 1997 to do a malware or do you make a

43
00:02:56,239 --> 00:03:00,889
sophisticated program it was very

44
00:02:57,739 --> 00:03:04,159
complex complex you need it to read know

45
00:03:00,889 --> 00:03:07,129
a lot of books you needed to read these

46
00:03:04,159 --> 00:03:11,000
four books at least and this book that

47
00:03:07,129 --> 00:03:14,569
you can see here this dose undocumented

48
00:03:11,000 --> 00:03:17,030
it was a real revolution at the time how

49
00:03:14,569 --> 00:03:20,569
do you have to read the books you had to

50
00:03:17,030 --> 00:03:22,370
study the books and you got into the BBS

51
00:03:20,569 --> 00:03:26,689
the old BBS you don't know what persist

52
00:03:22,370 --> 00:03:28,519
but the BBS is and you knew people there

53
00:03:26,689 --> 00:03:35,810
so this friend of a friend of a friend

54
00:03:28,519 --> 00:03:41,269
of a this friend said the PA speak it

55
00:03:35,810 --> 00:03:43,310
was the Menace to key logger for in

56
00:03:41,269 --> 00:03:46,729
Spain at the time let's insert a code

57
00:03:43,310 --> 00:03:49,819
and in order to do that he it took him

58
00:03:46,729 --> 00:03:50,720
like three months do that today you

59
00:03:49,819 --> 00:03:53,418
don't need that

60
00:03:50,720 --> 00:03:56,239
you just need what's in there Google

61
00:03:53,419 --> 00:03:59,659
which isn't you go to Google and you say

62
00:03:56,239 --> 00:04:02,299
malware I want to make a Trojan Trojan

63
00:03:59,659 --> 00:04:10,790
code and then you can have it

64
00:04:02,299 --> 00:04:14,000
immediately in 1997 this was the two

65
00:04:10,790 --> 00:04:16,728
types of hackers I said hacker brains

66
00:04:14,000 --> 00:04:20,599
not the right word these people were

67
00:04:16,728 --> 00:04:23,479
malware creators on my right that was a

68
00:04:20,599 --> 00:04:28,610
hacker the left I don't know but it's a

69
00:04:23,479 --> 00:04:35,840
good photo it's great looks you know the

70
00:04:28,610 --> 00:04:40,090
person on the right who's that Robert

71
00:04:35,840 --> 00:04:43,700
Tappan jr. Morris another person who

72
00:04:40,090 --> 00:04:45,739
destroyed the Internet he broke our

73
00:04:43,700 --> 00:04:49,070
our Pinet in 1997 that was the old

74
00:04:45,740 --> 00:04:52,250
internet in 88 he broke it because he

75
00:04:49,070 --> 00:04:57,200
created their motley warm he was it was

76
00:04:52,250 --> 00:04:59,920
a great impact and the the ice-t third

77
00:04:57,200 --> 00:05:03,890
Response Center was created after him

78
00:04:59,920 --> 00:05:06,650
the malware authors at the time well

79
00:05:03,890 --> 00:05:08,479
people thought the were this kind of

80
00:05:06,650 --> 00:05:12,080
guys on the left but this guy on the

81
00:05:08,480 --> 00:05:16,460
right how was a real profile for malware

82
00:05:12,080 --> 00:05:19,219
creators his dad was a big fish in

83
00:05:16,460 --> 00:05:22,190
Harper net so he knew what he was doing

84
00:05:19,220 --> 00:05:25,220
but this boom he didn't make it to break

85
00:05:22,190 --> 00:05:29,290
the internet but to show the S my

86
00:05:25,220 --> 00:05:32,750
protocol failure in fact it was a chain

87
00:05:29,290 --> 00:05:36,290
the warm was inside but he didn't check

88
00:05:32,750 --> 00:05:39,500
it previously it was already cockpit in

89
00:05:36,290 --> 00:05:42,530
the micro so created a dose it was the

90
00:05:39,500 --> 00:05:45,650
service denial attack the first in

91
00:05:42,530 --> 00:05:49,460
history and he broke down all the

92
00:05:45,650 --> 00:05:52,400
ARPANET and a surface so this guy had a

93
00:05:49,460 --> 00:05:56,000
very technical profile in knew he was

94
00:05:52,400 --> 00:05:58,479
doing and he created this malware but

95
00:05:56,000 --> 00:06:00,950
today this has changed

96
00:05:58,480 --> 00:06:03,860
creating a malware was like reading

97
00:06:00,950 --> 00:06:05,479
books but today anybody can create a

98
00:06:03,860 --> 00:06:08,840
malware we're going to demonstrate this

99
00:06:05,480 --> 00:06:10,460
new here just you have to look for

100
00:06:08,840 --> 00:06:12,349
correct information in the correct

101
00:06:10,460 --> 00:06:15,770
places because everything is in the

102
00:06:12,350 --> 00:06:19,480
internet you have websites like flu

103
00:06:15,770 --> 00:06:25,190
protects exploit the be exploit database

104
00:06:19,480 --> 00:06:28,070
jeep hub you'll find anything there you

105
00:06:25,190 --> 00:06:29,780
see that now because you need to do like

106
00:06:28,070 --> 00:06:34,370
for searches and you'll fight anything

107
00:06:29,780 --> 00:06:37,400
so my idea here was to demonstrate how

108
00:06:34,370 --> 00:06:41,180
easy it is to create a malware like if

109
00:06:37,400 --> 00:06:46,760
we were playing Lego it's like pieces of

110
00:06:41,180 --> 00:06:49,310
Legos and let's let's do a run somewhere

111
00:06:46,760 --> 00:06:51,099
we take a piece that when you need to

112
00:06:49,310 --> 00:06:55,040
have a code exploiting a vulnerability

113
00:06:51,100 --> 00:06:56,080
for instance for oversea well pick the

114
00:06:55,040 --> 00:07:01,800
pieces it's

115
00:06:56,080 --> 00:07:06,039
Oh easy play Lego just assembling pieces

116
00:07:01,800 --> 00:07:07,840
we think that there are four keys for

117
00:07:06,039 --> 00:07:10,349
any man what is for keep these four

118
00:07:07,840 --> 00:07:14,198
pieces propagation persistence

119
00:07:10,349 --> 00:07:16,120
privileges and spying propagation is

120
00:07:14,199 --> 00:07:18,159
vital it's the only way for this malware

121
00:07:16,120 --> 00:07:23,219
to survive in the environment where it

122
00:07:18,159 --> 00:07:28,509
was to propagate and expand persistence

123
00:07:23,219 --> 00:07:32,560
being there moving about the fireless

124
00:07:28,509 --> 00:07:35,229
technique trying not to be in the in the

125
00:07:32,560 --> 00:07:40,270
equipment I execute myself but I'm not

126
00:07:35,229 --> 00:07:43,750
there privileges the machine who's

127
00:07:40,270 --> 00:07:48,370
executing it a whisk or access what user

128
00:07:43,750 --> 00:07:51,669
has a ministry administrator access what

129
00:07:48,370 --> 00:07:55,270
about this process we need the higher

130
00:07:51,669 --> 00:07:58,628
privileges are possible and spying to

131
00:07:55,270 --> 00:08:02,590
take advantage of that information

132
00:07:58,629 --> 00:08:05,550
collection against that machine so need

133
00:08:02,590 --> 00:08:08,948
something in exchange I'll elaborate on

134
00:08:05,550 --> 00:08:13,719
propagation because many people have

135
00:08:08,949 --> 00:08:19,839
spoken about this already but I'll give

136
00:08:13,719 --> 00:08:25,719
you some background propagation first

137
00:08:19,839 --> 00:08:31,629
why this is about the background the

138
00:08:25,719 --> 00:08:33,309
first virus in history started appeared

139
00:08:31,629 --> 00:08:36,279
in the apple tube computer

140
00:08:33,309 --> 00:08:38,679
it was propagated via floppy disk you

141
00:08:36,279 --> 00:08:41,049
don't even know what the floppy is this

142
00:08:38,679 --> 00:08:43,269
is a fourteen it was the only method for

143
00:08:41,049 --> 00:08:50,680
propagation that existed at the time it

144
00:08:43,269 --> 00:08:54,490
was 1981 the first virus was was called

145
00:08:50,680 --> 00:08:56,859
cloner in the startup section people had

146
00:08:54,490 --> 00:08:58,810
needed the floppy to start the machine

147
00:08:56,860 --> 00:09:03,279
it was this was the propagation method

148
00:08:58,810 --> 00:09:05,529
today the expansion method is the

149
00:09:03,279 --> 00:09:06,610
internet in the past we needed this type

150
00:09:05,529 --> 00:09:11,129
of diskettes

151
00:09:06,610 --> 00:09:13,689
this evolved and Buster appeared

152
00:09:11,129 --> 00:09:17,499
exploiting a security failure from

153
00:09:13,689 --> 00:09:24,099
decomp RPC it's a vulnerability service

154
00:09:17,499 --> 00:09:27,790
then Sasser it was a very bad warm it

155
00:09:24,100 --> 00:09:33,939
was really bad the Alsace its buffer

156
00:09:27,790 --> 00:09:36,160
overflow this deals with the whole

157
00:09:33,939 --> 00:09:38,860
security policy in the machine so was

158
00:09:36,160 --> 00:09:43,949
crashed and then in the warm infected

159
00:09:38,860 --> 00:09:47,829
that was in 2004 and today eternal blue

160
00:09:43,949 --> 00:09:49,420
it was an sa full penetration it was an

161
00:09:47,829 --> 00:09:53,849
SME MD error

162
00:09:49,420 --> 00:09:57,579
it was categorized as CVE

163
00:09:53,850 --> 00:09:59,379
2017 Oh 144 it's been modified and it's

164
00:09:57,579 --> 00:10:05,799
been transformed into a different of

165
00:09:59,379 --> 00:10:09,449
virus cry etcetera so let's talk about

166
00:10:05,799 --> 00:10:13,239
the CVE it's so easy to do a propagation

167
00:10:09,449 --> 00:10:15,758
using the email will use the propagate

168
00:10:13,239 --> 00:10:20,199
which is the propagation method it which

169
00:10:15,759 --> 00:10:22,029
is the best for impacting machines but

170
00:10:20,199 --> 00:10:30,549
there's another another one which is

171
00:10:22,029 --> 00:10:33,129
better than email infection system was

172
00:10:30,549 --> 00:10:38,139
about sending a victim an email with a

173
00:10:33,129 --> 00:10:41,799
word file so you click on it and the

174
00:10:38,139 --> 00:10:44,649
payload executive immediately affect our

175
00:10:41,799 --> 00:10:49,869
machina como la fiere Mo's at repeated

176
00:10:44,649 --> 00:10:54,730
that we sent an email with very TDF word

177
00:10:49,869 --> 00:10:58,869
of fire which is satin and gold to a

178
00:10:54,730 --> 00:11:01,299
file embedded to do this we needed a

179
00:10:58,869 --> 00:11:03,869
small service motor that's here even if

180
00:11:01,299 --> 00:11:03,869
you can see it

181
00:11:11,100 --> 00:11:15,580
I'm calling it a server just to give it

182
00:11:13,540 --> 00:11:18,930
a name but it's the infection server you

183
00:11:15,580 --> 00:11:24,430
put it there and you start generating

184
00:11:18,930 --> 00:11:33,239
files to infect I created HT a file

185
00:11:24,430 --> 00:11:36,609
which is really just a just an HTML file

186
00:11:33,240 --> 00:11:39,940
but the a means application what that

187
00:11:36,610 --> 00:11:43,030
means is that the browser in this case

188
00:11:39,940 --> 00:11:46,420
Internet Explorer is going to run it as

189
00:11:43,030 --> 00:11:55,060
an application not as an HTML file this

190
00:11:46,420 --> 00:11:57,760
HTA of fire where you see it contains

191
00:11:55,060 --> 00:12:01,750
payloads where we include pain low

192
00:11:57,760 --> 00:12:07,050
payload with meta exploit animatics

193
00:12:01,750 --> 00:12:09,850
flora - there's an app called MSF venom

194
00:12:07,050 --> 00:12:11,620
and it just generates all kinds of

195
00:12:09,850 --> 00:12:16,720
payload any kind of payload that you

196
00:12:11,620 --> 00:12:19,480
want to add and it generates a code and

197
00:12:16,720 --> 00:12:22,720
that's what you insert into the HT a

198
00:12:19,480 --> 00:12:28,270
file what you can see below are the

199
00:12:22,720 --> 00:12:32,410
parameters the most important are the IP

200
00:12:28,270 --> 00:12:37,420
of our host that is our server that is

201
00:12:32,410 --> 00:12:40,540
awaiting the port and the pipe type of

202
00:12:37,420 --> 00:12:47,800
file format in this case it's P Windows

203
00:12:40,540 --> 00:12:51,579
64 we come back to the HT a file and we

204
00:12:47,800 --> 00:12:55,540
include it there if the whole code I've

205
00:12:51,580 --> 00:12:58,420
just put some of it we put it in the HTF

206
00:12:55,540 --> 00:13:01,300
file and we give it a name live in this

207
00:12:58,420 --> 00:13:06,040
case I've got it Fire HD a so we've got

208
00:13:01,300 --> 00:13:10,859
the payload in it and the next step is

209
00:13:06,040 --> 00:13:10,860
to create an RTF file

210
00:13:11,840 --> 00:13:24,260
a word file and inside it what we do is

211
00:13:18,140 --> 00:13:27,230
put the two files where where the users

212
00:13:24,260 --> 00:13:32,630
gonna run it but then we put the two

213
00:13:27,230 --> 00:13:37,850
files in the server before that the

214
00:13:32,630 --> 00:13:45,160
cache FTL actually it looks like a web

215
00:13:37,850 --> 00:13:51,410
ad dad so we have to run the a to n mod

216
00:13:45,160 --> 00:13:53,770
file which installs modules the Apache

217
00:13:51,410 --> 00:13:59,150
file is then by default when I modified

218
00:13:53,770 --> 00:14:03,920
so that it appears like a word or an RTF

219
00:13:59,150 --> 00:14:06,319
file then there's the final step which

220
00:14:03,920 --> 00:14:12,979
is to get the word a file that we

221
00:14:06,320 --> 00:14:15,700
generated at the beginning and inside we

222
00:14:12,980 --> 00:14:15,700
put our web address

223
00:14:17,530 --> 00:14:27,160
reading the payload in the word fault

224
00:14:21,860 --> 00:14:32,590
and for this to be run with double click

225
00:14:27,160 --> 00:14:32,589
we have to modify it in the notepad

226
00:14:43,620 --> 00:14:50,529
we look for the up-to-date variable and

227
00:14:47,470 --> 00:14:52,600
if it doesn't have it we add it so as

228
00:14:50,529 --> 00:14:58,930
soon as you double-click the malware

229
00:14:52,600 --> 00:15:04,510
will work and to finish what we did was

230
00:14:58,930 --> 00:15:08,170
he unify everything with the cache the

231
00:15:04,510 --> 00:15:13,300
HTTP file and then we add it to that

232
00:15:08,170 --> 00:15:18,040
file file no you've got to do is wait

233
00:15:13,300 --> 00:15:24,240
until the victim does a double-click on

234
00:15:18,040 --> 00:15:36,010
that file and as soon as he does its

235
00:15:24,240 --> 00:15:39,720
installs a reverse shell this has been

236
00:15:36,010 --> 00:15:42,970
used in a huge number of different

237
00:15:39,720 --> 00:15:47,770
malware for example dry Dex was a bank

238
00:15:42,970 --> 00:15:52,630
trader that used spam that was extended

239
00:15:47,770 --> 00:15:57,310
and it was included in a Russian spy

240
00:15:52,630 --> 00:15:59,530
manual all of this is this year the same

241
00:15:57,310 --> 00:16:02,140
goes for latent box there's all

242
00:15:59,530 --> 00:16:05,140
different kinds of a version and the

243
00:16:02,140 --> 00:16:06,280
most recent is a variant of what I just

244
00:16:05,140 --> 00:16:13,720
explained to you before but in this case

245
00:16:06,280 --> 00:16:17,050
in PowerPoint earlier I said that it was

246
00:16:13,720 --> 00:16:19,210
aimed to spread to email but we thought

247
00:16:17,050 --> 00:16:20,550
ok maybe there's a bigger vector than

248
00:16:19,210 --> 00:16:25,540
email which is Twitter

249
00:16:20,550 --> 00:16:31,449
twitter has a checking mechanisms it has

250
00:16:25,540 --> 00:16:38,349
a small black list if you put a URL in a

251
00:16:31,450 --> 00:16:40,900
tweet it can't check everything even

252
00:16:38,350 --> 00:16:45,520
though it's a black list let's just

253
00:16:40,900 --> 00:16:47,620
imagine I don't who you think has more

254
00:16:45,520 --> 00:16:49,790
tweets in the world it's not a Nobel

255
00:16:47,620 --> 00:16:51,650
Prize winner or anybody

256
00:16:49,790 --> 00:16:53,870
number buzz maneuvers to follow us in

257
00:16:51,650 --> 00:16:57,370
the world is Katy Perry she's got a

258
00:16:53,870 --> 00:17:01,040
hundred and six million followers

259
00:16:57,370 --> 00:17:04,250
followed by Justin Bieber Barrack Obama

260
00:17:01,040 --> 00:17:07,159
there's not many scientists there so a

261
00:17:04,250 --> 00:17:10,339
hundred million users imagine the impact

262
00:17:07,160 --> 00:17:13,310
if you can steal of Katy Perry's account

263
00:17:10,339 --> 00:17:17,119
her Twitter account and you can put a

264
00:17:13,310 --> 00:17:19,960
twit says I'm gonna leave the world of

265
00:17:17,119 --> 00:17:23,329
music and I'm gonna join Scientology

266
00:17:19,960 --> 00:17:24,590
here I've got a word fire where I

267
00:17:23,329 --> 00:17:27,859
explain everything

268
00:17:24,589 --> 00:17:33,350
imagine 106 million go click on that if

269
00:17:27,859 --> 00:17:36,229
they do that and if that leads to

270
00:17:33,350 --> 00:17:39,350
malware you can infect 106 million users

271
00:17:36,230 --> 00:17:42,110
not just in PCs but also in smartphones

272
00:17:39,350 --> 00:17:46,459
as well in Android and an iPhone or

273
00:17:42,110 --> 00:17:50,120
whatever what we wanted to do is try it

274
00:17:46,460 --> 00:17:53,030
with it oh this is true let's see if I

275
00:17:50,120 --> 00:18:00,110
can do this so we created a fictitious

276
00:17:53,030 --> 00:18:05,810
Twitter account we created all who gave

277
00:18:00,110 --> 00:18:12,080
it a general address we published a

278
00:18:05,810 --> 00:18:17,720
couple of three and here if you if you

279
00:18:12,080 --> 00:18:21,310
double-click and nobody says anything so

280
00:18:17,720 --> 00:18:21,310
you download it no proper tool

281
00:18:23,820 --> 00:18:34,540
you can see how it's going to run this

282
00:18:27,400 --> 00:18:37,210
makes it thing that's maybe Katy Perry

283
00:18:34,540 --> 00:18:39,820
should have somebody controlling her

284
00:18:37,210 --> 00:18:43,200
tweets Twitter accounts but it's a very

285
00:18:39,820 --> 00:18:46,960
dangerous issue and it makes you think

286
00:18:43,200 --> 00:18:48,220
so that's as far we're gonna go with

287
00:18:46,960 --> 00:18:53,980
spreading it let's now look at

288
00:18:48,220 --> 00:18:56,890
privileges during this event people have

289
00:18:53,980 --> 00:19:03,460
talking about UAC you all know what a

290
00:18:56,890 --> 00:19:06,700
new AC is it's like every time I mean

291
00:19:03,460 --> 00:19:12,390
you've run a program I think it actually

292
00:19:06,700 --> 00:19:12,390
came out with Windows Arista this UAC

293
00:19:15,420 --> 00:19:24,490
and to get a privilege what you have to

294
00:19:19,240 --> 00:19:28,330
do is you try because what at UAC does

295
00:19:24,490 --> 00:19:32,140
is it allows us to run programs with an

296
00:19:28,330 --> 00:19:37,510
account that isn't the computer's

297
00:19:32,140 --> 00:19:39,580
administrator usually it's always gonna

298
00:19:37,510 --> 00:19:42,370
ask you through this window so the UAC

299
00:19:39,580 --> 00:19:46,090
what it does is it goes round this

300
00:19:42,370 --> 00:19:48,580
operation but it only work if the user

301
00:19:46,090 --> 00:19:53,820
is within the administrator group and

302
00:19:48,580 --> 00:19:58,809
hasn't by default effectively the UAC

303
00:19:53,820 --> 00:20:01,570
policy so they're win elevate and drag

304
00:19:58,809 --> 00:20:08,470
me and others there are different

305
00:20:01,570 --> 00:20:10,270
plugins and if we mix UAC with a file

306
00:20:08,470 --> 00:20:14,650
less than we're doing things a little

307
00:20:10,270 --> 00:20:19,170
bit more technically that's where you

308
00:20:14,650 --> 00:20:19,170
have to be very careful about that

309
00:20:21,900 --> 00:20:31,870
and the final is total scale-up where

310
00:20:27,730 --> 00:20:35,260
you get three faults in a row this isn't

311
00:20:31,870 --> 00:20:38,889
really a USC but it's there so that you

312
00:20:35,260 --> 00:20:40,900
can see it so that you can get access to

313
00:20:38,890 --> 00:20:43,450
the machines privileges if you really

314
00:20:40,900 --> 00:20:46,300
want to know about UAC this year my

315
00:20:43,450 --> 00:20:49,090
colleague Santiago and Paulo are gonna

316
00:20:46,300 --> 00:20:52,590
be talking at the black hat and they're

317
00:20:49,090 --> 00:20:52,590
going to be talking about - guacamole

318
00:20:55,620 --> 00:21:00,370
and what it does is it trials all kinds

319
00:20:59,620 --> 00:21:04,750
of UAC s

320
00:21:00,370 --> 00:21:06,459
try that here I once again I'm using

321
00:21:04,750 --> 00:21:09,070
office because everybody uses office

322
00:21:06,460 --> 00:21:13,780
it's the best base for trying these

323
00:21:09,070 --> 00:21:21,399
kinds of malware key base is another

324
00:21:13,780 --> 00:21:23,730
malware which uses Excel documents but

325
00:21:21,400 --> 00:21:27,580
it asks you things you've got to

326
00:21:23,730 --> 00:21:31,030
activate macros if you want to run this

327
00:21:27,580 --> 00:21:33,730
phone of course everybody does gotta be

328
00:21:31,030 --> 00:21:35,440
able to see it it says please click

329
00:21:33,730 --> 00:21:37,510
enable content of you protective

330
00:21:35,440 --> 00:21:43,620
documents I said what they're going to

331
00:21:37,510 --> 00:21:48,520
do is install a malware when you do this

332
00:21:43,620 --> 00:21:56,560
a hit an instance of PowerShell starts

333
00:21:48,520 --> 00:22:00,760
up then it downloads a file called my

334
00:21:56,560 --> 00:22:07,210
dot exe from a remote server this case a

335
00:22:00,760 --> 00:22:08,710
Russian which keeps it in a temp system

336
00:22:07,210 --> 00:22:12,610
and changes the name and there you can

337
00:22:08,710 --> 00:22:14,530
see all these branches that I told you

338
00:22:12,610 --> 00:22:18,669
to get you around before there what you

339
00:22:14,530 --> 00:22:21,240
do is you write down these binary files

340
00:22:18,670 --> 00:22:21,240
and

341
00:22:22,990 --> 00:22:33,200
you've done that carry such a query and

342
00:22:29,559 --> 00:22:37,940
it runs the malicious file does the

343
00:22:33,200 --> 00:22:39,799
bypass the UAC here you could see it's

344
00:22:37,940 --> 00:22:44,809
in more detail it everybody can see it

345
00:22:39,799 --> 00:22:47,690
from the back of the room here I've used

346
00:22:44,809 --> 00:22:52,639
a bit analysis where you can see in

347
00:22:47,690 --> 00:22:57,320
detail how it gets how it puts

348
00:22:52,639 --> 00:23:04,490
everything in there the hidden power

349
00:22:57,320 --> 00:23:15,678
show the look in branches it explains

350
00:23:04,490 --> 00:23:17,600
how it's done right it's been OSH this

351
00:23:15,679 --> 00:23:19,970
was the final of the photo

352
00:23:17,600 --> 00:23:24,649
characteristics of malware what it does

353
00:23:19,970 --> 00:23:27,499
here is it makes the most of what a

354
00:23:24,649 --> 00:23:31,610
malware doing so you've got to ratchet

355
00:23:27,499 --> 00:23:39,350
remote administration tool which always

356
00:23:31,610 --> 00:23:44,600
have command and control it can activate

357
00:23:39,350 --> 00:23:46,549
all sorts of things the web camera what

358
00:23:44,600 --> 00:23:48,918
the malware does here you can see all

359
00:23:46,549 --> 00:23:51,799
the different options that it allows you

360
00:23:48,919 --> 00:23:58,159
to do which virtually all malware that

361
00:23:51,799 --> 00:24:01,820
have a C&C command and control the one

362
00:23:58,159 --> 00:24:05,649
that has the greatest control is

363
00:24:01,820 --> 00:24:11,990
Mariposa botnet Mariposa port net

364
00:24:05,649 --> 00:24:16,689
infected 12 million ip's unique IPS at

365
00:24:11,990 --> 00:24:16,690
12 million zombie computers

366
00:24:27,270 --> 00:24:32,650
said load I'm still using office so just

367
00:24:30,309 --> 00:24:36,490
as you can see how easy it is to use

368
00:24:32,650 --> 00:24:41,230
office to infect a computer said loader

369
00:24:36,490 --> 00:24:45,120
was another but not botnet which had its

370
00:24:41,230 --> 00:24:48,250
own C&C and it did the same thing

371
00:24:45,120 --> 00:24:54,299
activated the user so it encouraged the

372
00:24:48,250 --> 00:24:55,990
user to activate macros and this macro

373
00:24:54,299 --> 00:24:59,350
used to C&C

374
00:24:55,990 --> 00:25:02,320
to download the payload it looks similar

375
00:24:59,350 --> 00:25:05,189
to the previous diagram as you can see

376
00:25:02,320 --> 00:25:09,010
this with a said loader and the malware

377
00:25:05,190 --> 00:25:11,260
and when do you when run it's the act

378
00:25:09,010 --> 00:25:14,010
the user activates macros without

379
00:25:11,260 --> 00:25:19,240
realizing it it calls our rogue server

380
00:25:14,010 --> 00:25:25,260
and what it does injects into the user

381
00:25:19,240 --> 00:25:33,640
as soon as he opens a specific bank page

382
00:25:25,260 --> 00:25:35,610
to get and to false fake the the web

383
00:25:33,640 --> 00:25:39,520
connection of this Bank this is

384
00:25:35,610 --> 00:25:41,979
specifically for bank hacking for users

385
00:25:39,520 --> 00:25:52,299
that have got internet connection and

386
00:25:41,980 --> 00:25:58,030
access their bank using it I can't talk

387
00:25:52,299 --> 00:25:59,500
about malware without talking about rats

388
00:25:58,030 --> 00:26:02,280
and software ransom software is very

389
00:25:59,500 --> 00:26:05,049
very simple it's perhaps the easiest

390
00:26:02,280 --> 00:26:08,649
part of malware to make us it's just an

391
00:26:05,049 --> 00:26:10,900
algorithm which just encrypts a file

392
00:26:08,650 --> 00:26:19,210
with the key that can then can be used

393
00:26:10,900 --> 00:26:21,130
to decipher there lots of methods fix

394
00:26:19,210 --> 00:26:23,799
off a hidden tip then you've got the

395
00:26:21,130 --> 00:26:27,250
link which explains step by step how

396
00:26:23,799 --> 00:26:29,049
hidden link works so what do we do with

397
00:26:27,250 --> 00:26:31,750
all of this let's go back and just have

398
00:26:29,049 --> 00:26:32,779
a refresher look we've got spreading

399
00:26:31,750 --> 00:26:36,559
persistence

400
00:26:32,779 --> 00:26:40,289
espionage and ransomware if we want

401
00:26:36,559 --> 00:26:46,070
let's concentrate in the first four how

402
00:26:40,289 --> 00:26:49,500
can we make how can we bring all these

403
00:26:46,070 --> 00:26:52,620
together to create our own monster and

404
00:26:49,500 --> 00:26:54,480
Frankenstein monster so how can we take

405
00:26:52,620 --> 00:26:56,969
codes from different areas to make your

406
00:26:54,480 --> 00:27:00,740
own Frankenstein monster we started

407
00:26:56,970 --> 00:27:05,389
looking at it and we started thinking

408
00:27:00,740 --> 00:27:07,919
about github we were thinking get ups

409
00:27:05,389 --> 00:27:09,418
and github so you can find all sorts of

410
00:27:07,919 --> 00:27:13,409
things explore it's ransom wait

411
00:27:09,419 --> 00:27:17,970
keylogger spyware trojans and we thought

412
00:27:13,409 --> 00:27:22,200
ok if we connect github we download code

413
00:27:17,970 --> 00:27:26,330
we compile we've done our code directly

414
00:27:22,200 --> 00:27:28,889
to some kind of service which we'll

415
00:27:26,330 --> 00:27:31,260
analyze if we've got malware not it's

416
00:27:28,889 --> 00:27:34,010
perhaps a virus total and if you look at

417
00:27:31,260 --> 00:27:38,210
the bottom there I hope you can see it

418
00:27:34,010 --> 00:27:40,500
it's just a simple query from the

419
00:27:38,210 --> 00:27:44,549
website of virustotal

420
00:27:40,500 --> 00:27:48,510
I think I'm gonna zoom in so you can see

421
00:27:44,549 --> 00:27:52,769
it and here what I'm doing is searching

422
00:27:48,510 --> 00:27:56,100
for Trojans find that trojan for me and

423
00:27:52,769 --> 00:27:58,049
if you look for such a reddit ocean it's

424
00:27:56,100 --> 00:28:01,350
in a hundred and fifty nine codes in

425
00:27:58,049 --> 00:28:04,889
Python that means there are 115 nine

426
00:28:01,350 --> 00:28:08,070
repositories in github that talk about a

427
00:28:04,889 --> 00:28:11,428
github and then about trojans and

428
00:28:08,070 --> 00:28:15,629
they're not anti trojans their chosen

429
00:28:11,429 --> 00:28:19,380
codes in Java and C++ in c-sharp and

430
00:28:15,630 --> 00:28:23,760
virtually all of them except for some

431
00:28:19,380 --> 00:28:26,549
odd language like an assembler it's full

432
00:28:23,760 --> 00:28:27,899
full or you just got to seek trojan

433
00:28:26,549 --> 00:28:31,100
imagine if you're seeking for a

434
00:28:27,899 --> 00:28:31,100
different kind of parameter

435
00:28:33,090 --> 00:28:40,169
so we decided let's to automate this

436
00:28:36,300 --> 00:28:43,379
malware construction process but it's

437
00:28:40,170 --> 00:28:47,610
there lots of malicious code yes and

438
00:28:43,380 --> 00:28:53,880
anybody can access it so how do we wait

439
00:28:47,610 --> 00:28:55,530
make a POC how can we get older this

440
00:28:53,880 --> 00:28:58,380
first thing have to do is to find a key

441
00:28:55,530 --> 00:29:00,750
word and the language that we want to

442
00:28:58,380 --> 00:29:06,750
implement for example you tried to find

443
00:29:00,750 --> 00:29:09,630
different code bits but then you need to

444
00:29:06,750 --> 00:29:11,730
get a function to call the bits of these

445
00:29:09,630 --> 00:29:16,850
codes and that they make the call from

446
00:29:11,730 --> 00:29:22,500
there you take it to the repository

447
00:29:16,850 --> 00:29:23,669
convert it into X Y X e we compile it or

448
00:29:22,500 --> 00:29:26,420
you can leave it as a ritual and the

449
00:29:23,670 --> 00:29:31,020
next thing to do is to check whether

450
00:29:26,420 --> 00:29:33,270
some antivirus or any kind of antivirus

451
00:29:31,020 --> 00:29:41,250
mode 2 engine kind of Detectives so we

452
00:29:33,270 --> 00:29:45,360
did that the conclusions so we took code

453
00:29:41,250 --> 00:29:51,170
Python code ok let's first make a

454
00:29:45,360 --> 00:29:55,740
program that make that makes

455
00:29:51,170 --> 00:29:57,450
consultations with just a keyword and we

456
00:29:55,740 --> 00:30:03,900
look at the language that you want to

457
00:29:57,450 --> 00:30:08,790
look at look for it has to spend its

458
00:30:03,900 --> 00:30:12,360
time doing it and the next step is to go

459
00:30:08,790 --> 00:30:16,080
to this repository and compile it so you

460
00:30:12,360 --> 00:30:17,909
can compile the Python code here we had

461
00:30:16,080 --> 00:30:20,370
a slight problem and it's an interesting

462
00:30:17,910 --> 00:30:24,930
problem because if you compile with P

463
00:30:20,370 --> 00:30:27,919
installer any kind of thing you'll find

464
00:30:24,930 --> 00:30:27,920
5

465
00:30:30,700 --> 00:30:40,640
five possible virus the impression the

466
00:30:38,540 --> 00:30:41,990
pie installer calls something and

467
00:30:40,640 --> 00:30:45,800
detects this is something strange but if

468
00:30:41,990 --> 00:30:52,460
you order to try this hello word and the

469
00:30:45,800 --> 00:30:55,550
next step is to check whether there's

470
00:30:52,460 --> 00:30:59,410
some kind of malware this these three

471
00:30:55,550 --> 00:31:09,919
stages you can start finding your code

472
00:30:59,410 --> 00:31:16,010
so we trialed it exp this is the hello

473
00:31:09,920 --> 00:31:20,540
word actually it's called there you can

474
00:31:16,010 --> 00:31:24,470
see who found it Sentinel one and then

475
00:31:20,540 --> 00:31:29,720
we've found ransomware as well we

476
00:31:24,470 --> 00:31:31,760
thought why don't we automate it copying

477
00:31:29,720 --> 00:31:34,460
and sticking we decided to automated

478
00:31:31,760 --> 00:31:37,400
instead of copying pasting so we decided

479
00:31:34,460 --> 00:31:39,950
to make this frankontour it's very

480
00:31:37,400 --> 00:31:42,890
simple and what it does at the botton

481
00:31:39,950 --> 00:31:45,310
top it has a keyword that it has to

482
00:31:42,890 --> 00:31:48,260
search and you say you want to find

483
00:31:45,310 --> 00:31:50,210
ransomware so you find all those that

484
00:31:48,260 --> 00:31:53,210
include the word ransomware

485
00:31:50,210 --> 00:31:57,080
and you can download it compile it and

486
00:31:53,210 --> 00:31:58,850
then upload it to virustotal that'll

487
00:31:57,080 --> 00:32:02,120
give you a report and you can see yes

488
00:31:58,850 --> 00:32:04,939
here there is here there isn't so in

489
00:32:02,120 --> 00:32:06,739
that way we've got our parts of malware

490
00:32:04,940 --> 00:32:15,400
and we can check that they're going to

491
00:32:06,740 --> 00:32:15,400
work so imagine the potential of this

492
00:32:15,490 --> 00:32:20,770
below you've got an example we uploaded

493
00:32:18,820 --> 00:32:23,230
this one here you can find it in github

494
00:32:20,770 --> 00:32:25,870
if you look and it gave us seven

495
00:32:23,230 --> 00:32:30,880
positives but the ones at the bottom

496
00:32:25,870 --> 00:32:33,879
none zero positives so this is just an

497
00:32:30,880 --> 00:32:38,230
example of the reports that broke it

498
00:32:33,880 --> 00:32:40,929
Franken will produce and there you've

499
00:32:38,230 --> 00:32:45,630
got one posit depict one positive and

500
00:32:40,929 --> 00:32:45,630
now I want to show you how this works

501
00:33:03,430 --> 00:33:06,430
Rocky

502
00:33:11,760 --> 00:33:17,850
Marketing one colleague oh dal-soo say

503
00:33:15,510 --> 00:33:19,019
when he talked via Nicosia Valley we

504
00:33:17,850 --> 00:33:22,580
think AHA like a debate about whether

505
00:33:19,019 --> 00:33:22,580
he's like a katana for my money

506
00:33:32,830 --> 00:33:39,639
my intern Emma bien ma pinaki Meza keep

507
00:33:37,870 --> 00:33:44,350
on lqr me an entire car keylogger

508
00:33:39,640 --> 00:33:48,660
tampoco Sally for keylogger takes a

509
00:33:44,350 --> 00:33:48,659
while and there it is in Python

510
00:33:48,690 --> 00:34:07,620
we've got bear Ruby Java and while it's

511
00:33:55,690 --> 00:34:11,650
carrying out the search here this is a

512
00:34:07,620 --> 00:34:14,319
connection today at DU github looking

513
00:34:11,650 --> 00:34:16,420
for the word key loader in any source

514
00:34:14,320 --> 00:34:21,400
code and look at everything that you get

515
00:34:16,420 --> 00:34:24,370
I can't tell you how many there are up

516
00:34:21,400 --> 00:34:28,060
and look hundreds that's already there

517
00:34:24,370 --> 00:34:29,380
all of that so if I say okay I'm

518
00:34:28,060 --> 00:34:34,810
interested in this I want to check this

519
00:34:29,380 --> 00:34:40,810
one here this one yes does pass the

520
00:34:34,810 --> 00:34:46,870
antivirus engine filters when I finished

521
00:34:40,810 --> 00:34:48,299
I can compile it and here you can check

522
00:34:46,870 --> 00:34:56,230
everything

523
00:34:48,300 --> 00:35:01,380
you check the repository and you can see

524
00:34:56,230 --> 00:35:07,330
there's zero positives and in this way

525
00:35:01,380 --> 00:35:09,400
I've checked the code to see whether it

526
00:35:07,330 --> 00:35:13,480
gets through the antivirus filter this

527
00:35:09,400 --> 00:35:15,520
filter has a collection of antivirus

528
00:35:13,480 --> 00:35:17,710
which are updated to the most recent

529
00:35:15,520 --> 00:35:18,910
second so if it passes this control

530
00:35:17,710 --> 00:35:21,300
it'll pass the control of any anti

531
00:35:18,910 --> 00:35:24,430
viruses and any machine in the world

532
00:35:21,300 --> 00:35:27,700
this is going to generate a report here

533
00:35:24,430 --> 00:35:30,759
you can see it now this is one that we

534
00:35:27,700 --> 00:35:33,549
did with the mirai test there was

535
00:35:30,760 --> 00:35:37,090
several look at all the ones that are

536
00:35:33,550 --> 00:35:40,770
searching from midday and here's one

537
00:35:37,090 --> 00:35:40,770
that was positive with my cafe

538
00:35:43,590 --> 00:35:49,360
so you can see how easy it is with

539
00:35:46,270 --> 00:35:54,750
automated tools to deal with this

540
00:35:49,360 --> 00:36:00,310
process and this is the key of a talk

541
00:35:54,750 --> 00:36:02,530
what I wanted to show to his help how

542
00:36:00,310 --> 00:36:04,270
easy it is to bring everything together

543
00:36:02,530 --> 00:36:06,280
to create a virus using everything that

544
00:36:04,270 --> 00:36:10,480
already exists here's the summary of all

545
00:36:06,280 --> 00:36:12,730
the tests that we did what we did all

546
00:36:10,480 --> 00:36:15,670
these different searches for ransomware

547
00:36:12,730 --> 00:36:19,420
key log external eternal blues by where

548
00:36:15,670 --> 00:36:22,680
all kinds of a malware that you believe

549
00:36:19,420 --> 00:36:31,030
in is gonna be there there are 22

550
00:36:22,680 --> 00:36:34,240
spywares in python how easy it is to to

551
00:36:31,030 --> 00:36:37,420
find that and you can create your own

552
00:36:34,240 --> 00:36:41,200
malware out of that so that's what's out

553
00:36:37,420 --> 00:36:43,450
there now as I said anybody can create

554
00:36:41,200 --> 00:36:45,819
my way you just need to know a little

555
00:36:43,450 --> 00:36:48,910
bit about Python programming you've got

556
00:36:45,820 --> 00:36:54,090
a got to github and just create your own

557
00:36:48,910 --> 00:36:56,950
malware that means that anybody can make

558
00:36:54,090 --> 00:37:01,360
malware anybody can attack you in a

559
00:36:56,950 --> 00:37:04,270
thousand different formats for example a

560
00:37:01,360 --> 00:37:12,730
new infection vectors the Internet of

561
00:37:04,270 --> 00:37:16,570
Things in which the Mirai botnet infects

562
00:37:12,730 --> 00:37:21,160
IP cameras and attacks a DD and makes a

563
00:37:16,570 --> 00:37:23,110
DD dos a DDoS attack but there was a sum

564
00:37:21,160 --> 00:37:25,750
that didn't attack for example it didn't

565
00:37:23,110 --> 00:37:30,100
attack General Electric or the North

566
00:37:25,750 --> 00:37:33,640
American mail service it's interesting

567
00:37:30,100 --> 00:37:36,759
that it didn't attack those two so you

568
00:37:33,640 --> 00:37:41,020
can see the threats don't come from

569
00:37:36,760 --> 00:37:44,050
anybody that comes from a malware could

570
00:37:41,020 --> 00:37:46,300
be from the CIA which just loses a bit

571
00:37:44,050 --> 00:37:49,240
of code and all sorts of things happen

572
00:37:46,300 --> 00:37:50,850
because this code appears and get to

573
00:37:49,240 --> 00:37:51,959
have that second it's published this is

574
00:37:50,850 --> 00:37:57,598
this

575
00:37:51,960 --> 00:38:02,369
effect is created by leaks such as

576
00:37:57,599 --> 00:38:06,750
eternal blue which can expand over

577
00:38:02,369 --> 00:38:09,619
Internet there was another case where

578
00:38:06,750 --> 00:38:15,150
the shadow brokers did the same thing

579
00:38:09,619 --> 00:38:17,010
they accessed and the NSA and what can

580
00:38:15,150 --> 00:38:20,820
we do with all of this not a lot

581
00:38:17,010 --> 00:38:23,310
actually you could we can study make

582
00:38:20,820 --> 00:38:25,859
sure we're aware and see how they

583
00:38:23,310 --> 00:38:32,190
different attackers change and evolve

584
00:38:25,859 --> 00:38:36,869
and what's more there's a new kind of

585
00:38:32,190 --> 00:38:38,550
attack a new technique which makes the

586
00:38:36,869 --> 00:38:41,810
situation even more complicated and of

587
00:38:38,550 --> 00:38:47,790
course what did we talk about here

588
00:38:41,810 --> 00:38:50,580
machine learning is a mighty machine

589
00:38:47,790 --> 00:38:52,170
learning appears everywhere until you

590
00:38:50,580 --> 00:38:55,410
see the first form anything oh my

591
00:38:52,170 --> 00:38:58,200
goodness not easy I'll explain to you

592
00:38:55,410 --> 00:39:00,210
now how you can do things with a machine

593
00:38:58,200 --> 00:39:02,069
learning and how you can do things

594
00:39:00,210 --> 00:39:08,070
related to security with a fantastic

595
00:39:02,070 --> 00:39:10,470
tool now my colleague gave a talk about

596
00:39:08,070 --> 00:39:13,530
machine learning this morning and if you

597
00:39:10,470 --> 00:39:17,720
see it you'll be able to understand

598
00:39:13,530 --> 00:39:21,619
better how we can defend ourselves by

599
00:39:17,720 --> 00:39:26,359
looking for anomalies in traffic's in a

600
00:39:21,619 --> 00:39:30,839
local network we just use techniques

601
00:39:26,359 --> 00:39:33,480
machine learning techniques and we use

602
00:39:30,839 --> 00:39:35,580
the netfloor flow protocol to analyze

603
00:39:33,480 --> 00:39:38,160
the traffic any sort of anomaly there

604
00:39:35,580 --> 00:39:41,339
you can see the peaks something strange

605
00:39:38,160 --> 00:39:47,940
is going on and the machine thinks hey

606
00:39:41,339 --> 00:39:52,710
something is going on here it's like

607
00:39:47,940 --> 00:39:56,109
using tagged samples so you have to know

608
00:39:52,710 --> 00:39:59,420
what you're analyzing in this case

609
00:39:56,109 --> 00:40:00,740
talking about non supervised traffic we

610
00:39:59,420 --> 00:40:05,000
don't know what kind of packets they are

611
00:40:00,740 --> 00:40:06,529
but at the bottom so you can see that

612
00:40:05,000 --> 00:40:11,030
it's being merged for example Windows

613
00:40:06,530 --> 00:40:13,520
Defender ATP which is already in the

614
00:40:11,030 --> 00:40:17,869
market uses a advanced machine learning

615
00:40:13,520 --> 00:40:23,480
techniques using a process functioning

616
00:40:17,869 --> 00:40:29,510
tree because it can make you realize

617
00:40:23,480 --> 00:40:32,210
that there's there's something there and

618
00:40:29,510 --> 00:40:34,670
that's now all kinds of machine learning

619
00:40:32,210 --> 00:40:39,260
techniques are being used to struggle

620
00:40:34,670 --> 00:40:45,589
what happens we instead of using it to

621
00:40:39,260 --> 00:40:49,579
defend imagine we use it to attack I too

622
00:40:45,589 --> 00:40:54,130
spent all its life trying to attack and

623
00:40:49,579 --> 00:40:55,910
it's got more time and isn't

624
00:40:54,130 --> 00:40:58,040
enthusiastic about doing it then than

625
00:40:55,910 --> 00:41:00,348
any of us now I want to talk to you

626
00:40:58,040 --> 00:41:03,920
about about an open ai but first of all

627
00:41:00,349 --> 00:41:08,680
I want you to know what reinforcement

628
00:41:03,920 --> 00:41:08,680
learning is here you can see a little

629
00:41:10,030 --> 00:41:18,920
action which you attack an environment

630
00:41:16,130 --> 00:41:25,190
and then it comes back to you it's like

631
00:41:18,920 --> 00:41:29,210
a circle the proof of what's going on I

632
00:41:25,190 --> 00:41:33,470
just love open I open I was a nonprofit

633
00:41:29,210 --> 00:41:36,170
organization an eland mask

634
00:41:33,470 --> 00:41:38,569
of course bosses poison ivy bosses

635
00:41:36,170 --> 00:41:39,109
really then we created an organism

636
00:41:38,569 --> 00:41:44,839
called

637
00:41:39,109 --> 00:41:48,470
open eye and this shows all the problems

638
00:41:44,839 --> 00:41:51,250
that make might appear with AI open eye

639
00:41:48,470 --> 00:41:55,520
has a framework called

640
00:41:51,250 --> 00:41:59,839
jim-jim framework is to Train AI what's

641
00:41:55,520 --> 00:42:02,990
really exciting about this is that open

642
00:41:59,839 --> 00:42:07,220
eye has a Terry James framework classic

643
00:42:02,990 --> 00:42:09,259
Atari games so you can train an AI to

644
00:42:07,220 --> 00:42:12,470
play breakout

645
00:42:09,260 --> 00:42:14,930
break out the bricks look for in the

646
00:42:12,470 --> 00:42:19,459
indignant to see the evolution because

647
00:42:14,930 --> 00:42:23,529
the I the I a is starts to to be trained

648
00:42:19,460 --> 00:42:27,920
and it learns how to play

649
00:42:23,530 --> 00:42:30,290
it's a DF it's simulating I am a real

650
00:42:27,920 --> 00:42:34,810
person playing this game could be a

651
00:42:30,290 --> 00:42:38,480
video game but in open I with Jim that

652
00:42:34,810 --> 00:42:43,220
simulates the purchase of a person in

653
00:42:38,480 --> 00:42:44,540
Amazon so you see snapshots and what you

654
00:42:43,220 --> 00:42:51,770
do is to analyze what you see on the

655
00:42:44,540 --> 00:42:54,170
screen it's fine fantastic open eye you

656
00:42:51,770 --> 00:42:56,750
can play break break out it's a neural

657
00:42:54,170 --> 00:42:59,840
network and it looks for the previous

658
00:42:56,750 --> 00:43:01,610
States the ball is one position then in

659
00:42:59,840 --> 00:43:04,360
another position and it calculates that

660
00:43:01,610 --> 00:43:07,640
our best direction to return the ball

661
00:43:04,360 --> 00:43:11,150
how do I explain this because now I'm

662
00:43:07,640 --> 00:43:13,160
going to show you talks given in the

663
00:43:11,150 --> 00:43:16,520
Deaf competition of this year they used

664
00:43:13,160 --> 00:43:21,410
open I do you set up a malware

665
00:43:16,520 --> 00:43:24,080
environment this is the same charge I

666
00:43:21,410 --> 00:43:28,129
explained before with this cycle of

667
00:43:24,080 --> 00:43:30,080
actions it's very simple agent takes a

668
00:43:28,130 --> 00:43:32,270
decision makes does an action is a

669
00:43:30,080 --> 00:43:34,670
process there's a score because it's

670
00:43:32,270 --> 00:43:37,759
freakout game and there's a ward and

671
00:43:34,670 --> 00:43:41,110
observation it's the same loop until you

672
00:43:37,760 --> 00:43:44,000
get a maximum reward that's the goal

673
00:43:41,110 --> 00:43:47,170
what we're going to do now is to remove

674
00:43:44,000 --> 00:43:50,390
this video game environment and to

675
00:43:47,170 --> 00:43:54,170
insert an environment that is for

676
00:43:50,390 --> 00:43:57,020
malware analysis in DEFCON attack

677
00:43:54,170 --> 00:44:00,170
spectacularly with open a in the put an

678
00:43:57,020 --> 00:44:04,460
anti-virus in general a total virus but

679
00:44:00,170 --> 00:44:06,590
in local this antivirus moon engine had

680
00:44:04,460 --> 00:44:10,670
a lot of engines it was composed of

681
00:44:06,590 --> 00:44:13,390
various engines they created an a I was

682
00:44:10,670 --> 00:44:13,390
just a malware

683
00:44:13,430 --> 00:44:21,470
and m'as used to detective to potential

684
00:44:18,260 --> 00:44:24,740
the infection there were awards more or

685
00:44:21,470 --> 00:44:29,330
less award if some of these antivirus

686
00:44:24,740 --> 00:44:32,629
detected or not the malware the good

687
00:44:29,330 --> 00:44:35,810
thing is that to do the loop and look

688
00:44:32,630 --> 00:44:37,730
for the best way to alter code so

689
00:44:35,810 --> 00:44:40,940
they'll know in antivirus could detect

690
00:44:37,730 --> 00:44:46,810
it the idea was to modify the mutable

691
00:44:40,940 --> 00:44:48,920
code there's a tool yes library for the

692
00:44:46,810 --> 00:44:52,400
instrumentation of executive old files

693
00:44:48,920 --> 00:44:55,640
and what it does is to create and modify

694
00:44:52,400 --> 00:45:02,150
the internal code it's a mutation of it

695
00:44:55,640 --> 00:45:05,839
code at each step it's changed the

696
00:45:02,150 --> 00:45:09,890
second memory segments are modified it's

697
00:45:05,840 --> 00:45:14,480
randomly changing the code could can be

698
00:45:09,890 --> 00:45:17,600
modified it it changes signatures modify

699
00:45:14,480 --> 00:45:22,820
the checksum and modifies code sections

700
00:45:17,600 --> 00:45:24,589
it I add random bytes in injects code I

701
00:45:22,820 --> 00:45:31,390
invite you to see it

702
00:45:24,590 --> 00:45:36,110
I I was impressed it works fine they

703
00:45:31,390 --> 00:45:41,109
started the loop and this worked fine it

704
00:45:36,110 --> 00:45:46,160
was tested for 15 hours we have a code

705
00:45:41,110 --> 00:45:49,310
that is mutating and starting to enter

706
00:45:46,160 --> 00:45:51,770
the machine learning loop and this AI is

707
00:45:49,310 --> 00:45:54,680
learning if I do this modification this

708
00:45:51,770 --> 00:45:59,440
segment it's going to detect this so I'm

709
00:45:54,680 --> 00:46:02,540
not going to do it this creates the

710
00:45:59,440 --> 00:46:07,660
database according to the experience

711
00:46:02,540 --> 00:46:07,660
that it is having for 15 hours it works

712
00:46:07,750 --> 00:46:17,030
in 16 at the end 16 percent of the

713
00:46:12,110 --> 00:46:19,170
attacks were successful in 15 hours 20

714
00:46:17,030 --> 00:46:21,700
percent

715
00:46:19,170 --> 00:46:24,300
we're successful for the malware it

716
00:46:21,700 --> 00:46:29,850
starts with a very small code that is

717
00:46:24,300 --> 00:46:34,330
mutating and the the current antivirus

718
00:46:29,850 --> 00:46:37,810
engines were working trying to find this

719
00:46:34,330 --> 00:46:39,940
malware so for 15 hours it worked in

720
00:46:37,810 --> 00:46:43,930
this virtual machine if you implement

721
00:46:39,940 --> 00:46:46,900
this in iam in an Amazon server with 50

722
00:46:43,930 --> 00:46:51,430
servers imagine what you can do in just

723
00:46:46,900 --> 00:46:54,850
seconds well this malware has learned

724
00:46:51,430 --> 00:46:58,600
during the attack it remembers it it's

725
00:46:54,850 --> 00:46:59,410
it's kept in a file so this is stored

726
00:46:58,600 --> 00:47:01,630
somewhere

727
00:46:59,410 --> 00:47:04,089
imagine that this virus connects with

728
00:47:01,630 --> 00:47:06,940
another virus and tells it here you have

729
00:47:04,090 --> 00:47:09,730
here you are I learned this use it

730
00:47:06,940 --> 00:47:12,970
I saw the problem is of deficient

731
00:47:09,730 --> 00:47:15,510
intelligence all the information that

732
00:47:12,970 --> 00:47:18,609
it's learnt it scan immediately

733
00:47:15,510 --> 00:47:22,740
transferred between the others and it's

734
00:47:18,610 --> 00:47:25,530
quite freaky and it's spooky because

735
00:47:22,740 --> 00:47:28,330
it's kind of a tamer Terminator or

736
00:47:25,530 --> 00:47:34,600
global network that it attacks and

737
00:47:28,330 --> 00:47:38,770
informs the others so it's kind of an

738
00:47:34,600 --> 00:47:41,230
epic ellipsis but be calm be quiet we

739
00:47:38,770 --> 00:47:43,660
need to breathe and start to think about

740
00:47:41,230 --> 00:47:46,720
this but you have to be ready because

741
00:47:43,660 --> 00:47:49,990
every day this is getting closer and

742
00:47:46,720 --> 00:47:52,149
closer and now I advise you because this

743
00:47:49,990 --> 00:47:55,299
happened to me I advise you to learn

744
00:47:52,150 --> 00:47:59,260
mathematics again I know it's boring but

745
00:47:55,300 --> 00:48:02,440
I wanted to know how machine learning

746
00:47:59,260 --> 00:48:09,790
works and I assure you that it's all

747
00:48:02,440 --> 00:48:13,860
mathematics this is the a I it's I I you

748
00:48:09,790 --> 00:48:13,860
have to study mathematics every day

749
00:48:14,130 --> 00:48:23,460
that's all thank you very much I'm sorry

750
00:48:18,580 --> 00:48:23,460
if it was too too much

751
00:48:25,170 --> 00:48:31,960
okay then good thing all the free all I

752
00:48:28,359 --> 00:48:34,810
have a cold and it's it's been quite

753
00:48:31,960 --> 00:48:35,590
painful to stand up here but if you have

754
00:48:34,810 --> 00:48:38,049
any question

755
00:48:35,590 --> 00:48:56,980
I'll be here for you but I'll be around

756
00:48:38,050 --> 00:49:00,100
so you can come and see me but the room

757
00:48:56,980 --> 00:49:04,150
today I will ask you a question again

758
00:49:00,100 --> 00:49:10,960
afterwards I'd like to ask you how how

759
00:49:04,150 --> 00:49:16,320
do we open the office document to edit

760
00:49:10,960 --> 00:49:19,890
it without habilitated the macros option

761
00:49:16,320 --> 00:49:26,350
when we open a Word document or an Excel

762
00:49:19,890 --> 00:49:29,799
page from the internet it asks us to to

763
00:49:26,350 --> 00:49:31,740
activate the protected pieces or data

764
00:49:29,800 --> 00:49:34,750
can we use this document without

765
00:49:31,740 --> 00:49:38,979
habilitative the macro so that no macros

766
00:49:34,750 --> 00:49:41,770
can execute no because this office file

767
00:49:38,980 --> 00:49:43,720
in theory the part that is interesting

768
00:49:41,770 --> 00:49:46,750
to you is the one that's behind the

769
00:49:43,720 --> 00:49:49,569
macro execution so we you will have to

770
00:49:46,750 --> 00:49:51,940
activate the macros so to show you what

771
00:49:49,570 --> 00:49:54,910
you want to see because it's behind that

772
00:49:51,940 --> 00:49:57,280
layer if you don't activate macros you

773
00:49:54,910 --> 00:50:01,839
will never be able to see the next level

774
00:49:57,280 --> 00:50:06,000
I don't know if that's the response well

775
00:50:01,840 --> 00:50:11,619
more or less how do we protect ourselves

776
00:50:06,000 --> 00:50:13,900
against this about Stealth of this code

777
00:50:11,619 --> 00:50:17,650
in office documents for the only

778
00:50:13,900 --> 00:50:22,300
solution is typical solutions to have

779
00:50:17,650 --> 00:50:25,510
the updated program state CDE has a

780
00:50:22,300 --> 00:50:27,970
patch Microsoft Center patch in April

781
00:50:25,510 --> 00:50:31,630
but until recently there's been cases

782
00:50:27,970 --> 00:50:33,759
people to update the programs we always

783
00:50:31,630 --> 00:50:35,770
say it in cybersecurity please update

784
00:50:33,760 --> 00:50:41,110
your system

785
00:50:35,770 --> 00:50:43,800
it's just a updating a patch so this

786
00:50:41,110 --> 00:50:49,450
patch is the solution so please update

787
00:50:43,800 --> 00:50:54,180
your system so you need to update but

788
00:50:49,450 --> 00:50:54,180
not everybody does it and it's a pity

789
00:50:58,050 --> 00:51:11,110
hello a question here I'd like to ask

790
00:51:04,270 --> 00:51:15,520
you about machine learning when we spoke

791
00:51:11,110 --> 00:51:17,560
about feedback where the the code was

792
00:51:15,520 --> 00:51:21,400
modified because it was learning the

793
00:51:17,560 --> 00:51:24,520
conclusions after these 15 hours what

794
00:51:21,400 --> 00:51:30,240
about the size of the code was it bigger

795
00:51:24,520 --> 00:51:32,950
the file was bigger or the modification

796
00:51:30,240 --> 00:51:34,990
in machine learning comes from the code

797
00:51:32,950 --> 00:51:38,980
itself that modifies it so that it can

798
00:51:34,990 --> 00:51:41,589
be recognized at the end the file was

799
00:51:38,980 --> 00:51:46,560
the same volume was the same size

800
00:51:41,590 --> 00:51:49,720
yes it can be trash but the code had a

801
00:51:46,560 --> 00:51:53,470
function and it did some operations what

802
00:51:49,720 --> 00:51:56,259
are you interested by the file size you

803
00:51:53,470 --> 00:51:59,939
spoke about this trash code and I'd want

804
00:51:56,260 --> 00:52:02,500
to know if the result was a normal file

805
00:51:59,940 --> 00:52:10,060
jumping over all security barriers but a

806
00:52:02,500 --> 00:52:13,109
big file with bigger size or can it

807
00:52:10,060 --> 00:52:16,480
could it modify the authentic code

808
00:52:13,109 --> 00:52:20,350
well they especially talked about that

809
00:52:16,480 --> 00:52:23,890
in their presentation the coder is not

810
00:52:20,350 --> 00:52:25,900
bigger it's mutating leave a function

811
00:52:23,890 --> 00:52:28,779
calls for a memory segment in a specific

812
00:52:25,900 --> 00:52:33,400
way it's changed and it calls it in a

813
00:52:28,780 --> 00:52:35,700
different way the Liev library analyzes

814
00:52:33,400 --> 00:52:39,850
this part of the code and it modifies it

815
00:52:35,700 --> 00:52:43,868
they don't add new code it's useless

816
00:52:39,850 --> 00:52:47,020
it's mutating the keyword is code

817
00:52:43,869 --> 00:52:48,540
mutation the size mahtim is modified in

818
00:52:47,020 --> 00:52:52,860
the variation

819
00:52:48,540 --> 00:52:55,470
isn't one more factor of detection if it

820
00:52:52,860 --> 00:52:57,570
was X number of case it's now a bigger

821
00:52:55,470 --> 00:53:00,029
something has happened in the code but

822
00:52:57,570 --> 00:53:01,890
Li F has techniques to modify them to

823
00:53:00,030 --> 00:53:06,080
adjust those modifications without

824
00:53:01,890 --> 00:53:06,080
altering the final size of the file

825
00:53:07,550 --> 00:53:17,460
it'll be tough early if you have a look

826
00:53:10,320 --> 00:53:21,150
at the Li F they will topple ah nobody

827
00:53:17,460 --> 00:53:23,340
is asking about what happened in my

828
00:53:21,150 --> 00:53:23,990
anecdote my a friend of a friend of a

829
00:53:23,340 --> 00:53:33,930
friend

830
00:53:23,990 --> 00:53:35,339
no but please don't ask yes

831
00:53:33,930 --> 00:53:38,779
thank you then

832
00:53:35,340 --> 00:53:38,780
[Applause]

833
00:53:42,730 --> 00:53:44,790
you

