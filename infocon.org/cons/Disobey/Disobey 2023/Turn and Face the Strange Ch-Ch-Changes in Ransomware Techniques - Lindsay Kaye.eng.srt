1
00:00:00,240 --> 00:00:02,940
hello all right hey everyone thank you

2
00:00:02,940 --> 00:00:04,380
so much for coming to my talk today and

3
00:00:04,380 --> 00:00:05,400
tell you a little bit about some of the

4
00:00:05,400 --> 00:00:06,420
changes that we've observed in

5
00:00:06,420 --> 00:00:08,519
ransomware over the past couple years

6
00:00:08,519 --> 00:00:10,620
so to start off I'm Lindsey K senior

7
00:00:10,620 --> 00:00:12,059
director of the advanced reversing

8
00:00:12,059 --> 00:00:13,740
malware operations reconnaissance group

9
00:00:13,740 --> 00:00:15,839
at quarter future so I run the technical

10
00:00:15,839 --> 00:00:17,340
arm of our threat intelligence team and

11
00:00:17,340 --> 00:00:18,720
by trade I'm a malware analyst in

12
00:00:18,720 --> 00:00:20,580
reverse engineer

13
00:00:20,580 --> 00:00:22,320
so let's start off on the premise that

14
00:00:22,320 --> 00:00:23,880
just like the rest of us ransomware

15
00:00:23,880 --> 00:00:25,380
groups are also subject to the realities

16
00:00:25,380 --> 00:00:27,660
of the economy so sometimes we see them

17
00:00:27,660 --> 00:00:29,160
innovate their tools or behavior in

18
00:00:29,160 --> 00:00:31,080
order to remain successful in a very

19
00:00:31,080 --> 00:00:32,880
competitive market they can't simply

20
00:00:32,880 --> 00:00:34,200
just build it and the Affiliates will

21
00:00:34,200 --> 00:00:36,660
come to them but like some other less

22
00:00:36,660 --> 00:00:38,040
successful Innovations of the past

23
00:00:38,040 --> 00:00:39,719
sometimes these changes don't really

24
00:00:39,719 --> 00:00:41,219
work the way that the threat actors

25
00:00:41,219 --> 00:00:43,379
intend and sometimes we see them

26
00:00:43,379 --> 00:00:45,540
backfire so today I'm going to tell you

27
00:00:45,540 --> 00:00:46,680
a couple about a couple of these

28
00:00:46,680 --> 00:00:47,940
innovations that we've observed in

29
00:00:47,940 --> 00:00:49,800
ransomware and talk about what made them

30
00:00:49,800 --> 00:00:53,640
particularly successful or much less so

31
00:00:53,640 --> 00:00:55,379
so we observed several different types

32
00:00:55,379 --> 00:00:57,600
of changes in lockers that and

33
00:00:57,600 --> 00:00:59,940
ransomware threat actor ttps over the

34
00:00:59,940 --> 00:01:01,379
past couple years so things like new

35
00:01:01,379 --> 00:01:03,120
lockers will start to come out people

36
00:01:03,120 --> 00:01:05,400
add additional features to existing ones

37
00:01:05,400 --> 00:01:07,200
we see new ways of deploying and

38
00:01:07,200 --> 00:01:08,340
spreading them

39
00:01:08,340 --> 00:01:09,900
um different languages start being used

40
00:01:09,900 --> 00:01:11,939
so it's not just CNC plus plus anymore

41
00:01:11,939 --> 00:01:13,200
so we'll start seeing things like

42
00:01:13,200 --> 00:01:16,140
cooling rust and python name a couple we

43
00:01:16,140 --> 00:01:17,939
see new and creative extortion methods

44
00:01:17,939 --> 00:01:20,220
to really make people want to pay and

45
00:01:20,220 --> 00:01:22,860
the targeting of additional Hardware

46
00:01:22,860 --> 00:01:24,540
so some of these worked particularly

47
00:01:24,540 --> 00:01:26,400
well so first some of the deployment

48
00:01:26,400 --> 00:01:28,439
improvements so by and large we've seen

49
00:01:28,439 --> 00:01:30,780
threat actors move towards using things

50
00:01:30,780 --> 00:01:32,340
like benign tools and kind of the

51
00:01:32,340 --> 00:01:33,780
artifacts of how the operating system

52
00:01:33,780 --> 00:01:36,720
works to spread their ransomware

53
00:01:36,720 --> 00:01:38,880
so previously you would see a lot of

54
00:01:38,880 --> 00:01:40,500
kind of like custom tooling which is a

55
00:01:40,500 --> 00:01:42,060
lot easier to detect if you're looking

56
00:01:42,060 --> 00:01:44,939
for something that's bad whereas it's a

57
00:01:44,939 --> 00:01:47,280
lot harder to detect anomalies in you

58
00:01:47,280 --> 00:01:48,479
know these tools that you expect to be

59
00:01:48,479 --> 00:01:50,640
there so for example msps and because

60
00:01:50,640 --> 00:01:52,740
say incident comes to mind as well

61
00:01:52,740 --> 00:01:55,399
using SMB shares to move laterally

62
00:01:55,399 --> 00:01:57,720
cifs and NFS are also another couple

63
00:01:57,720 --> 00:01:59,759
examples and one of the other things

64
00:01:59,759 --> 00:02:01,619
that we see ransomware thread actors do

65
00:02:01,619 --> 00:02:02,700
is they'll start to build an

66
00:02:02,700 --> 00:02:04,320
impersonation tokens into the actual

67
00:02:04,320 --> 00:02:06,840
Locker so it can spread itself

68
00:02:06,840 --> 00:02:09,000
next threat actors have had some

69
00:02:09,000 --> 00:02:10,739
particularly good success optimizing

70
00:02:10,739 --> 00:02:12,000
what they already have out there in the

71
00:02:12,000 --> 00:02:13,920
market so things like intermittent

72
00:02:13,920 --> 00:02:15,300
encryption which I'm sure all familiar

73
00:02:15,300 --> 00:02:17,160
with and adding additional functionality

74
00:02:17,160 --> 00:02:19,020
to lockers based on affiliate demands to

75
00:02:19,020 --> 00:02:20,700
try and attract Affiliates to their

76
00:02:20,700 --> 00:02:21,540
program

77
00:02:21,540 --> 00:02:24,060
next it's always helpful to fill gaps in

78
00:02:24,060 --> 00:02:26,640
the ecosystem so after Regal and dark

79
00:02:26,640 --> 00:02:28,140
side disbanded due to a couple kind of

80
00:02:28,140 --> 00:02:30,840
high profile attacks on JBS foods and

81
00:02:30,840 --> 00:02:32,099
Colonial pipeline if you remember those

82
00:02:32,099 --> 00:02:34,739
we saw black matter and Conte also put

83
00:02:34,739 --> 00:02:36,660
out Linux and esxi lockers to kind of

84
00:02:36,660 --> 00:02:37,980
fill that Gap

85
00:02:37,980 --> 00:02:40,440
then we saw Alpha add in something

86
00:02:40,440 --> 00:02:41,819
called a chat access code which I'll

87
00:02:41,819 --> 00:02:44,459
talk about later to minimize the threat

88
00:02:44,459 --> 00:02:47,160
of chat hijacking uh things like making

89
00:02:47,160 --> 00:02:49,319
their victim their exfiltrated victim

90
00:02:49,319 --> 00:02:51,120
files searchable so much easier to start

91
00:02:51,120 --> 00:02:52,440
going through you know what threat

92
00:02:52,440 --> 00:02:53,940
actors have access to rather than just

93
00:02:53,940 --> 00:02:56,340
trying to click file by file and finally

94
00:02:56,340 --> 00:02:57,840
that they made their panels more user

95
00:02:57,840 --> 00:02:59,879
friendly so adding features like a

96
00:02:59,879 --> 00:03:02,220
built-in Bitcoin mixers allowing

97
00:03:02,220 --> 00:03:03,900
Affiliates to put in support tickets and

98
00:03:03,900 --> 00:03:05,819
then helping them moderate victims after

99
00:03:05,819 --> 00:03:07,620
a successful attack

100
00:03:07,620 --> 00:03:09,480
additionally really trying to make them

101
00:03:09,480 --> 00:03:12,360
pay is a great tactic so some of the

102
00:03:12,360 --> 00:03:13,739
additional extortion techniques that we

103
00:03:13,739 --> 00:03:16,500
saw were things like geosing people who

104
00:03:16,500 --> 00:03:18,599
wouldn't pay calling their board members

105
00:03:18,599 --> 00:03:19,739
their clients to let them know

106
00:03:19,739 --> 00:03:21,840
something's happened and contacting the

107
00:03:21,840 --> 00:03:24,300
media to make it more widely publicized

108
00:03:24,300 --> 00:03:26,640
and additionally we all kind of find

109
00:03:26,640 --> 00:03:28,440
some amusement in the idea of printing a

110
00:03:28,440 --> 00:03:30,420
ransomware note on the local printers

111
00:03:30,420 --> 00:03:31,920
but really kind of the functionality of

112
00:03:31,920 --> 00:03:33,480
that is if the organization is trying to

113
00:03:33,480 --> 00:03:34,800
hide from their employees and those

114
00:03:34,800 --> 00:03:36,060
around that something bad has happened

115
00:03:36,060 --> 00:03:38,159
it's a lot harder to do so in the rants

116
00:03:38,159 --> 00:03:40,140
notice spewing out of the local printers

117
00:03:40,140 --> 00:03:41,879
rather than just kind of like a file on

118
00:03:41,879 --> 00:03:44,220
somebody's desktop

119
00:03:44,220 --> 00:03:46,080
however some of the Innovations we saw

120
00:03:46,080 --> 00:03:48,239
really never took off and left something

121
00:03:48,239 --> 00:03:50,459
to be desired so we always say like as

122
00:03:50,459 --> 00:03:52,080
developers don't roll your own crypto

123
00:03:52,080 --> 00:03:54,420
dark side and black matter both learned

124
00:03:54,420 --> 00:03:55,620
that the hard way when they had

125
00:03:55,620 --> 00:03:57,959
encryption flaws a lot of red actors

126
00:03:57,959 --> 00:03:59,340
seem to want to do some sort of false

127
00:03:59,340 --> 00:04:01,200
flag attribution which we'll talk about

128
00:04:01,200 --> 00:04:03,120
and they don't always succeed in doing

129
00:04:03,120 --> 00:04:04,080
so

130
00:04:04,080 --> 00:04:06,180
sometimes you'll see threat actors add

131
00:04:06,180 --> 00:04:08,700
things like to make the reverse the tool

132
00:04:08,700 --> 00:04:10,739
harder to reverse engineer or you know

133
00:04:10,739 --> 00:04:12,599
adopt other threat actors tools but

134
00:04:12,599 --> 00:04:14,220
ultimately they just end up making them

135
00:04:14,220 --> 00:04:16,620
more signature by doing so

136
00:04:16,620 --> 00:04:19,620
making it so secure no one can use it so

137
00:04:19,620 --> 00:04:21,478
one example is black matter if you

138
00:04:21,478 --> 00:04:24,120
remember them had required a tour

139
00:04:24,120 --> 00:04:26,699
private key to access their affiliate

140
00:04:26,699 --> 00:04:28,860
panel so this was above the kind of

141
00:04:28,860 --> 00:04:30,419
technical expertise of a lot of their

142
00:04:30,419 --> 00:04:32,759
Affiliates so obviously if you make it

143
00:04:32,759 --> 00:04:34,440
harder to access your offering you're

144
00:04:34,440 --> 00:04:36,240
not going to get as many customers

145
00:04:36,240 --> 00:04:37,979
and then finally letting politics get

146
00:04:37,979 --> 00:04:39,780
involved as you remember with the Russia

147
00:04:39,780 --> 00:04:41,360
Ukraine Invasion

148
00:04:41,360 --> 00:04:44,580
Conte sided with Russia which displeased

149
00:04:44,580 --> 00:04:46,380
some of their members and led to

150
00:04:46,380 --> 00:04:48,660
ultimately kind of the final destruction

151
00:04:48,660 --> 00:04:50,759
of the group

152
00:04:50,759 --> 00:04:53,100
so in the spirit of duoliba we're going

153
00:04:53,100 --> 00:04:54,780
to talk about some of the new rules of

154
00:04:54,780 --> 00:04:56,220
being a successful ransomware threat

155
00:04:56,220 --> 00:04:58,740
actor in this day and age

156
00:04:58,740 --> 00:05:01,259
so play ransomware might be familiar

157
00:05:01,259 --> 00:05:03,360
with it it's relatively new but it's

158
00:05:03,360 --> 00:05:06,120
fairly active and we first saw it used

159
00:05:06,120 --> 00:05:09,000
in or we first observed it in June 2022

160
00:05:09,000 --> 00:05:10,919
like much ransomware of the past it's

161
00:05:10,919 --> 00:05:12,960
written in C plus plus and it was first

162
00:05:12,960 --> 00:05:14,520
used in a Cyber attack against the

163
00:05:14,520 --> 00:05:16,440
Argentina Court of Cordoba in August

164
00:05:16,440 --> 00:05:18,840
2022. so some of the notable features

165
00:05:18,840 --> 00:05:21,660
here so this very minimal Ransom note so

166
00:05:21,660 --> 00:05:22,979
if you've ever looked at other Ransom

167
00:05:22,979 --> 00:05:24,840
notes uh in the past this should kind of

168
00:05:24,840 --> 00:05:26,820
stick out to you usually you'll have a

169
00:05:26,820 --> 00:05:28,620
lot of text about what happened how do

170
00:05:28,620 --> 00:05:30,000
you pay what are the repercussions of

171
00:05:30,000 --> 00:05:32,759
not paying but this is it so fairly

172
00:05:32,759 --> 00:05:34,979
unusual here I'm going to talk about the

173
00:05:34,979 --> 00:05:36,720
addition of return oriented programming

174
00:05:36,720 --> 00:05:38,820
Rob and other added obfuscations and

175
00:05:38,820 --> 00:05:40,259
their impact and then how they did

176
00:05:40,259 --> 00:05:42,960
intermittent encryption

177
00:05:42,960 --> 00:05:45,000
so Rob and ransomware yeah I was

178
00:05:45,000 --> 00:05:46,919
surprised too so this is not something

179
00:05:46,919 --> 00:05:48,419
that I had ever really seen before but

180
00:05:48,419 --> 00:05:49,919
it was particularly interesting so in

181
00:05:49,919 --> 00:05:51,300
case you're not super familiar with what

182
00:05:51,300 --> 00:05:52,860
Rob is

183
00:05:52,860 --> 00:05:54,600
um ultimately in this case it functions

184
00:05:54,600 --> 00:05:55,800
to make reverse engineering a little

185
00:05:55,800 --> 00:05:57,720
more challenging and to some degree

186
00:05:57,720 --> 00:05:59,460
access the control flow obfuscation

187
00:05:59,460 --> 00:06:04,020
technique so basically what happens is

188
00:06:04,020 --> 00:06:05,699
it takes advantage of kind of the

189
00:06:05,699 --> 00:06:07,320
artifact of how the return instruction

190
00:06:07,320 --> 00:06:10,380
works so you can see on the right an

191
00:06:10,380 --> 00:06:13,620
example here so increment ESP by 32 and

192
00:06:13,620 --> 00:06:15,600
the do a return so what this causes is

193
00:06:15,600 --> 00:06:18,060
that you'll do Zen a jump to the next

194
00:06:18,060 --> 00:06:19,080
piece of code that you're going to

195
00:06:19,080 --> 00:06:20,280
execute

196
00:06:20,280 --> 00:06:22,500
so between the return instruction and

197
00:06:22,500 --> 00:06:24,060
that new code there's a bunch of just

198
00:06:24,060 --> 00:06:25,440
kind of garbage code

199
00:06:25,440 --> 00:06:27,660
um Gator doesn't really like that

200
00:06:27,660 --> 00:06:28,860
um so it just kind of gets a little

201
00:06:28,860 --> 00:06:30,960
confused so you can kind of fix it up

202
00:06:30,960 --> 00:06:33,180
there but ultimately slightly more

203
00:06:33,180 --> 00:06:34,139
challenging

204
00:06:34,139 --> 00:06:37,319
so you can see on the left an example of

205
00:06:37,319 --> 00:06:39,360
the play code without ROM

206
00:06:39,360 --> 00:06:42,120
just to kind of set that stage

207
00:06:42,120 --> 00:06:43,979
so if you're a threat actor adding

208
00:06:43,979 --> 00:06:45,840
obfuscation is totally great but really

209
00:06:45,840 --> 00:06:47,880
consider doing it from the start so the

210
00:06:47,880 --> 00:06:49,380
first place samples that I looked at

211
00:06:49,380 --> 00:06:52,139
from mid-june 2022 had some obfuscations

212
00:06:52,139 --> 00:06:54,419
to them so pretty simple string

213
00:06:54,419 --> 00:06:55,819
obfuscation you can see on the top right

214
00:06:55,819 --> 00:06:58,740
they used API hashing again make it

215
00:06:58,740 --> 00:07:00,539
harder to statically reverse engineer

216
00:07:00,539 --> 00:07:02,759
look which apis you bring called one

217
00:07:02,759 --> 00:07:04,380
But ultimately the code itself was not

218
00:07:04,380 --> 00:07:06,660
wildly challenging to reverse engineer

219
00:07:06,660 --> 00:07:08,460
the additional obfuscations really only

220
00:07:08,460 --> 00:07:11,280
came in in August 2022 so first the

221
00:07:11,280 --> 00:07:12,539
return oriented programming like I

222
00:07:12,539 --> 00:07:14,039
mentioned and then they had some garbage

223
00:07:14,039 --> 00:07:15,660
code insertion which you can see on the

224
00:07:15,660 --> 00:07:17,280
bottom right

225
00:07:17,280 --> 00:07:19,560
so wallrop was definitely a positive

226
00:07:19,560 --> 00:07:21,240
addition to make

227
00:07:21,240 --> 00:07:23,400
um to make the code harder to reverse

228
00:07:23,400 --> 00:07:25,680
engineer ultimately the code was still

229
00:07:25,680 --> 00:07:27,539
the same underneath so if you're

230
00:07:27,539 --> 00:07:29,160
struggling to reverse engineer the

231
00:07:29,160 --> 00:07:31,020
obfuscated one just kind of look at the

232
00:07:31,020 --> 00:07:32,340
unofficated one you're kind of Off to

233
00:07:32,340 --> 00:07:34,199
the Races so it makes it really easy to

234
00:07:34,199 --> 00:07:35,460
start picking out the artifacts that

235
00:07:35,460 --> 00:07:37,020
you're looking for and of interest in

236
00:07:37,020 --> 00:07:38,400
the new code

237
00:07:38,400 --> 00:07:40,919
additionally I was able to write a rule

238
00:07:40,919 --> 00:07:43,380
to look for artifacts that we are

239
00:07:43,380 --> 00:07:45,539
automated garbage code Edition that were

240
00:07:45,539 --> 00:07:46,979
pretty signature to be able to find new

241
00:07:46,979 --> 00:07:49,319
versions it's probably an automated

242
00:07:49,319 --> 00:07:51,240
technique which made it easy enough to

243
00:07:51,240 --> 00:07:52,380
start looking for other samples that

244
00:07:52,380 --> 00:07:54,740
used it

245
00:07:55,319 --> 00:07:57,360
also if you're a threat actor make sure

246
00:07:57,360 --> 00:07:58,620
you're giving the people what they want

247
00:07:58,620 --> 00:08:00,060
to make your offering the best on the

248
00:08:00,060 --> 00:08:02,099
market so play around somewhere like

249
00:08:02,099 --> 00:08:03,660
many other groups uses the intermittent

250
00:08:03,660 --> 00:08:06,240
encryption so what this is is that every

251
00:08:06,240 --> 00:08:08,940
other one megabyte of data still encrypt

252
00:08:08,940 --> 00:08:10,740
so this is something they include from

253
00:08:10,740 --> 00:08:13,620
the start in June 2022 but what it

254
00:08:13,620 --> 00:08:14,880
functions to do is make encryption

255
00:08:14,880 --> 00:08:17,639
faster over large files so the idea of

256
00:08:17,639 --> 00:08:19,259
making your encryption faster is that

257
00:08:19,259 --> 00:08:20,520
you could probably inflect a

258
00:08:20,520 --> 00:08:21,960
substantially more damage before

259
00:08:21,960 --> 00:08:23,220
somebody figures out what you're doing

260
00:08:23,220 --> 00:08:26,220
and tries to stop you so ultimately more

261
00:08:26,220 --> 00:08:27,660
profit

262
00:08:27,660 --> 00:08:29,759
um and doing it in this way that every

263
00:08:29,759 --> 00:08:32,159
other byte every other megabyte rather

264
00:08:32,159 --> 00:08:34,200
is makes it substantially less

265
00:08:34,200 --> 00:08:35,820
recoverable than some groups that just

266
00:08:35,820 --> 00:08:37,620
encrypt the first you know couple of

267
00:08:37,620 --> 00:08:39,299
megabytes and then leave the rest

268
00:08:39,299 --> 00:08:41,520
unencrypted which were extremely large

269
00:08:41,520 --> 00:08:43,380
files you can imagine how that leaves a

270
00:08:43,380 --> 00:08:45,180
lot of the file recoverable

271
00:08:45,180 --> 00:08:47,100
other groups do it too

272
00:08:47,100 --> 00:08:48,899
um maybe in slightly different ways but

273
00:08:48,899 --> 00:08:50,820
people like agenda Alpha and black

274
00:08:50,820 --> 00:08:51,899
massive so this is a fairly common

275
00:08:51,899 --> 00:08:53,899
technique

276
00:08:53,899 --> 00:08:57,000
speaking of alpha alpha is a reblend of

277
00:08:57,000 --> 00:08:59,399
black matter so their code is written in

278
00:08:59,399 --> 00:09:02,100
Rust which is fairly unusual and they

279
00:09:02,100 --> 00:09:04,320
were first discovered in December 2021.

280
00:09:04,320 --> 00:09:07,140
so they're known for multiple texts on

281
00:09:07,140 --> 00:09:09,120
infrastructure so back when the group

282
00:09:09,120 --> 00:09:10,980
was originally Dark Side before they

283
00:09:10,980 --> 00:09:13,080
became black matter and then Alpha they

284
00:09:13,080 --> 00:09:15,720
attacked Colonial pipeline which was a

285
00:09:15,720 --> 00:09:17,640
huge issue in the U.S people all freaked

286
00:09:17,640 --> 00:09:19,920
out but they're also known for a lot of

287
00:09:19,920 --> 00:09:21,420
other attacks as well

288
00:09:21,420 --> 00:09:23,580
and some of the notable features here so

289
00:09:23,580 --> 00:09:24,959
they were the first big ransomware

290
00:09:24,959 --> 00:09:27,060
written in Rust first big ransomware

291
00:09:27,060 --> 00:09:29,459
with an arm Locker they have an

292
00:09:29,459 --> 00:09:31,440
interesting build obfuscation toolkit

293
00:09:31,440 --> 00:09:33,899
called morph which I'll talk about they

294
00:09:33,899 --> 00:09:35,640
use chat access tokens to mitigate the

295
00:09:35,640 --> 00:09:38,459
threat of chat hijacking and then they

296
00:09:38,459 --> 00:09:41,519
have their searchable victim files index

297
00:09:41,519 --> 00:09:44,339
called Alpha collections so you can

298
00:09:44,339 --> 00:09:46,800
search by content filing different

299
00:09:46,800 --> 00:09:48,720
things like that it makes it easier for

300
00:09:48,720 --> 00:09:50,640
them to share the results of their

301
00:09:50,640 --> 00:09:54,300
ransomware attacks with the community

302
00:09:54,300 --> 00:09:57,720
so the idea behind the chat uh the alpha

303
00:09:57,720 --> 00:10:00,240
access tokens so when the group was

304
00:10:00,240 --> 00:10:01,740
black matter there was a pretty

305
00:10:01,740 --> 00:10:04,080
well-known chat hijacking incident and

306
00:10:04,080 --> 00:10:05,760
what happened there was threat actor

307
00:10:05,760 --> 00:10:08,940
obviously was trying to negotiate with

308
00:10:08,940 --> 00:10:10,800
the victim of the attack and what

309
00:10:10,800 --> 00:10:13,140
happened was that some researchers found

310
00:10:13,140 --> 00:10:15,779
a sample in virus total detonated it and

311
00:10:15,779 --> 00:10:18,000
then found the link to the chat so they

312
00:10:18,000 --> 00:10:19,140
and

313
00:10:19,140 --> 00:10:21,360
a wide variety of other people went in

314
00:10:21,360 --> 00:10:22,980
pandemonium ensued because the threat

315
00:10:22,980 --> 00:10:23,940
actor couldn't tell who they were

316
00:10:23,940 --> 00:10:25,560
negotiating with and had to ultimately

317
00:10:25,560 --> 00:10:28,320
end the chat so in order to spin up the

318
00:10:28,320 --> 00:10:29,880
proper victim chat they had to require

319
00:10:29,880 --> 00:10:31,860
domain controllers and domain admin

320
00:10:31,860 --> 00:10:33,540
information to find out who the real

321
00:10:33,540 --> 00:10:34,920
victim was

322
00:10:34,920 --> 00:10:37,140
so after that group disbanded and they

323
00:10:37,140 --> 00:10:39,360
became Alpha they built a logger to

324
00:10:39,360 --> 00:10:40,440
require something called the access

325
00:10:40,440 --> 00:10:43,019
token so this is generated at build time

326
00:10:43,019 --> 00:10:46,260
and ultimately what it does is it is

327
00:10:46,260 --> 00:10:49,560
used to generate the proper of the

328
00:10:49,560 --> 00:10:52,140
proper chat link so that only the victim

329
00:10:52,140 --> 00:10:55,440
who is intended to be in it has it so if

330
00:10:55,440 --> 00:10:57,360
you find a right this random sample on

331
00:10:57,360 --> 00:11:00,480
virus total and you try to run it with

332
00:11:00,480 --> 00:11:01,920
another access token you'll generate

333
00:11:01,920 --> 00:11:04,019
something but it won't be the right link

334
00:11:04,019 --> 00:11:06,720
so ultimately being able to create a

335
00:11:06,720 --> 00:11:08,220
more secure line of communication with

336
00:11:08,220 --> 00:11:09,899
their victims in order to prevent an

337
00:11:09,899 --> 00:11:12,420
incident like that happening again

338
00:11:12,420 --> 00:11:15,060
so why rust so this is the first big

339
00:11:15,060 --> 00:11:16,800
ransomware written in Rust so usually

340
00:11:16,800 --> 00:11:19,860
you'll see like C C plus plus Delphi um

341
00:11:19,860 --> 00:11:21,660
goaling more recently which are all

342
00:11:21,660 --> 00:11:22,800
familiar with

343
00:11:22,800 --> 00:11:24,180
um thicker Steeler is a really popular

344
00:11:24,180 --> 00:11:26,279
stealer written it also written in Rust

345
00:11:26,279 --> 00:11:28,920
but really no other ransomware at that

346
00:11:28,920 --> 00:11:30,120
time was

347
00:11:30,120 --> 00:11:32,040
so the nice thing about it is it's cross

348
00:11:32,040 --> 00:11:34,500
compilable so you can build one set of

349
00:11:34,500 --> 00:11:37,079
code and get a Windows Linux and arm

350
00:11:37,079 --> 00:11:39,120
Locker out of that code

351
00:11:39,120 --> 00:11:41,279
and as a bonus one run in person who's

352
00:11:41,279 --> 00:11:42,660
personally familiar right that reverse

353
00:11:42,660 --> 00:11:44,160
engineering is a little bit harder well

354
00:11:44,160 --> 00:11:46,500
at least for now so some of the

355
00:11:46,500 --> 00:11:47,700
complications here are that Library

356
00:11:47,700 --> 00:11:49,860
functions aren't always identified so

357
00:11:49,860 --> 00:11:51,120
when you're doing reverse engineering

358
00:11:51,120 --> 00:11:52,140
and you're trying to find the

359
00:11:52,140 --> 00:11:55,140
interesting code to look at it's a lot

360
00:11:55,140 --> 00:11:57,000
harder because there's just a bunch of

361
00:11:57,000 --> 00:11:58,800
Library functions and you don't want to

362
00:11:58,800 --> 00:12:00,540
be like caught reverse engineering you

363
00:12:00,540 --> 00:12:02,160
know some sort of string allocation for

364
00:12:02,160 --> 00:12:04,079
20 minutes so you have to kind of figure

365
00:12:04,079 --> 00:12:06,300
out what's the interesting stuff here

366
00:12:06,300 --> 00:12:08,279
there's also a lot of runtime code in

367
00:12:08,279 --> 00:12:09,959
the binary so things like error handling

368
00:12:09,959 --> 00:12:12,660
so you can see on the top right there it

369
00:12:12,660 --> 00:12:14,040
doesn't make it necessarily

370
00:12:14,040 --> 00:12:15,899
insurmountable but it's just a lot more

371
00:12:15,899 --> 00:12:18,480
stuff to look at kind of at the time

372
00:12:18,480 --> 00:12:19,740
you're doing reverse engineering and

373
00:12:19,740 --> 00:12:21,899
it's a little bit more kind of cluttered

374
00:12:21,899 --> 00:12:24,060
additionally like going strings are not

375
00:12:24,060 --> 00:12:25,920
null terminated so

376
00:12:25,920 --> 00:12:27,839
what this ends up doing until you do

377
00:12:27,839 --> 00:12:29,940
some sort of post-processing type fix up

378
00:12:29,940 --> 00:12:31,620
you'll start to see all the streams sort

379
00:12:31,620 --> 00:12:33,000
of run together as you can see on the

380
00:12:33,000 --> 00:12:34,860
bottom right so some of your references

381
00:12:34,860 --> 00:12:35,940
get a little screwed up until you

382
00:12:35,940 --> 00:12:38,760
post-process them and at this time fix

383
00:12:38,760 --> 00:12:40,680
up tools are substantially more nascent

384
00:12:40,680 --> 00:12:43,380
than they were for like golang so if you

385
00:12:43,380 --> 00:12:44,700
remember in the first kind of goaling

386
00:12:44,700 --> 00:12:46,320
malware is coming out

387
00:12:46,320 --> 00:12:48,000
we were kind of in that same situation

388
00:12:48,000 --> 00:12:49,920
but now many researchers have put out

389
00:12:49,920 --> 00:12:53,120
nice utilities for other people

390
00:12:53,519 --> 00:12:55,800
I did mention it

391
00:12:55,800 --> 00:12:57,779
and the way that they advertised it was

392
00:12:57,779 --> 00:12:59,220
that it was designed to Target Nas

393
00:12:59,220 --> 00:13:01,019
devices so if you've heard of qnap

394
00:13:01,019 --> 00:13:03,180
Synology and other things like that so

395
00:13:03,180 --> 00:13:04,620
this would not necessarily be something

396
00:13:04,620 --> 00:13:07,260
you use kind of in a vacuum you would

397
00:13:07,260 --> 00:13:08,639
generally want to use it in parallel to

398
00:13:08,639 --> 00:13:11,459
your windows and linux's es6i lockers so

399
00:13:11,459 --> 00:13:12,600
now instead of just kind of getting

400
00:13:12,600 --> 00:13:14,639
people's esxi servers and their Windows

401
00:13:14,639 --> 00:13:16,800
machines you'll also be able to be able

402
00:13:16,800 --> 00:13:18,959
to Target the backups and uncommon file

403
00:13:18,959 --> 00:13:20,820
shares that they have so ultimately

404
00:13:20,820 --> 00:13:22,440
you're increasing the effectiveness of

405
00:13:22,440 --> 00:13:24,240
the ransomware attack because things

406
00:13:24,240 --> 00:13:25,200
that a company might have thought

407
00:13:25,200 --> 00:13:27,660
wouldn't be encrypted now run the risk

408
00:13:27,660 --> 00:13:29,040
of being so

409
00:13:29,040 --> 00:13:31,740
and today haven't observed it used in

410
00:13:31,740 --> 00:13:33,959
the wild as yet not to say they won't be

411
00:13:33,959 --> 00:13:36,120
but that's just where we are now and

412
00:13:36,120 --> 00:13:37,680
generally arm lockers aren't really

413
00:13:37,680 --> 00:13:40,079
super common to see so chaos ransomware

414
00:13:40,079 --> 00:13:41,579
has one but if you look at the other

415
00:13:41,579 --> 00:13:43,680
kind of like mainstream groups there

416
00:13:43,680 --> 00:13:46,219
really aren't any

417
00:13:46,980 --> 00:13:49,019
so the morph obfuscation toolkit I

418
00:13:49,019 --> 00:13:50,940
thought was pretty cool so the way that

419
00:13:50,940 --> 00:13:53,160
they advertised it was this is something

420
00:13:53,160 --> 00:13:56,279
that will help evade AV so what they

421
00:13:56,279 --> 00:13:58,560
promised was garbage code insertion and

422
00:13:58,560 --> 00:14:01,800
string obfuscation to make it harder

423
00:14:01,800 --> 00:14:04,019
cool so this is what their string

424
00:14:04,019 --> 00:14:05,880
obvious question looks like

425
00:14:05,880 --> 00:14:07,200
um they have a one byte X or key

426
00:14:07,200 --> 00:14:09,360
randomly generated and you can see an

427
00:14:09,360 --> 00:14:10,680
example of some of that garbage code

428
00:14:10,680 --> 00:14:13,980
insertion there largely I guess global

429
00:14:13,980 --> 00:14:15,839
address some like mathematical

430
00:14:15,839 --> 00:14:17,459
operations that have no Salient effect

431
00:14:17,459 --> 00:14:19,019
on the actual code

432
00:14:19,019 --> 00:14:21,060
um so the only kind of like real piece

433
00:14:21,060 --> 00:14:23,100
of code in there is the xoring with

434
00:14:23,100 --> 00:14:24,180
eight

435
00:14:24,180 --> 00:14:26,100
so one of the interesting things is like

436
00:14:26,100 --> 00:14:28,860
okay it was as promised but the binaries

437
00:14:28,860 --> 00:14:30,839
were substantially bigger so while the

438
00:14:30,839 --> 00:14:32,160
original going binaries they're about

439
00:14:32,160 --> 00:14:34,200
three Megs a piece these obvious gated

440
00:14:34,200 --> 00:14:37,860
ones were close to 14. so largely a lot

441
00:14:37,860 --> 00:14:39,660
of the increases were in the text data

442
00:14:39,660 --> 00:14:41,220
and relocation sections because of kind

443
00:14:41,220 --> 00:14:43,800
of the artifact of what they were doing

444
00:14:43,800 --> 00:14:45,600
however if you're being a threat actor

445
00:14:45,600 --> 00:14:47,160
make sure you check your work so they

446
00:14:47,160 --> 00:14:49,680
also had more obfuscation for their

447
00:14:49,680 --> 00:14:52,199
Linux binaries fantastic didn't observe

448
00:14:52,199 --> 00:14:53,940
any string obfuscation but kind of the

449
00:14:53,940 --> 00:14:55,500
other really interesting thing is

450
00:14:55,500 --> 00:14:57,300
generally if you're doing reverse

451
00:14:57,300 --> 00:14:58,560
engineering of this kind of stuff like

452
00:14:58,560 --> 00:15:00,540
there are no function names because as

453
00:15:00,540 --> 00:15:01,740
you know if that makes it substantially

454
00:15:01,740 --> 00:15:03,839
easier to figure out what's going on so

455
00:15:03,839 --> 00:15:07,079
you can see on the left an example of

456
00:15:07,079 --> 00:15:08,940
the unobficated binaries no function

457
00:15:08,940 --> 00:15:10,380
names no export names containing the

458
00:15:10,380 --> 00:15:13,440
word Locker cool so after the morph

459
00:15:13,440 --> 00:15:16,079
obfuscation was applied to one of the

460
00:15:16,079 --> 00:15:17,519
Linux binaries what I noticed is

461
00:15:17,519 --> 00:15:18,959
something that looked like

462
00:15:18,959 --> 00:15:21,360
name mangled function names to some

463
00:15:21,360 --> 00:15:22,680
degree that actually had the words

464
00:15:22,680 --> 00:15:24,540
blocker core like kind of started to

465
00:15:24,540 --> 00:15:25,740
give you some of the idea of what the

466
00:15:25,740 --> 00:15:27,959
original function names were

467
00:15:27,959 --> 00:15:30,000
um makes it a little easier to reverse

468
00:15:30,000 --> 00:15:31,500
engineer not entirely sure Fabs was

469
00:15:31,500 --> 00:15:34,380
intentional probably not but um to date

470
00:15:34,380 --> 00:15:36,060
this is no longer an offering not

471
00:15:36,060 --> 00:15:38,399
entirely sure why

472
00:15:38,399 --> 00:15:40,440
but no really check your work so it's

473
00:15:40,440 --> 00:15:42,180
not just in kind of the obfuscations

474
00:15:42,180 --> 00:15:44,820
that people are doing but we've seen

475
00:15:44,820 --> 00:15:46,680
several threat actors actually screw up

476
00:15:46,680 --> 00:15:48,360
the encryption of decryption which is

477
00:15:48,360 --> 00:15:50,100
where they make the money and probably

478
00:15:50,100 --> 00:15:52,800
where they should not be screwing up so

479
00:15:52,800 --> 00:15:54,240
everybody's probably familiar with the

480
00:15:54,240 --> 00:15:57,180
esxi args kind of attacks I believe two

481
00:15:57,180 --> 00:15:59,519
weeks ago now so version one was

482
00:15:59,519 --> 00:16:01,800
interesting so the way that they tried

483
00:16:01,800 --> 00:16:03,060
to do their

484
00:16:03,060 --> 00:16:04,500
for lack of a better word intermittent

485
00:16:04,500 --> 00:16:05,880
encryption was they would have encrypt

486
00:16:05,880 --> 00:16:08,699
one megabyte and Skip X megabytes based

487
00:16:08,699 --> 00:16:10,560
on calculation that's X was

488
00:16:10,560 --> 00:16:12,120
approximately one percent of the file

489
00:16:12,120 --> 00:16:15,300
size so fine if it's a small file but if

490
00:16:15,300 --> 00:16:17,940
you're looking at a file that's 450 gigs

491
00:16:17,940 --> 00:16:20,459
then you're skipping about 4.5 gigabytes

492
00:16:20,459 --> 00:16:23,760
at a time so this made recovery possible

493
00:16:23,760 --> 00:16:25,980
for these very large files which is kind

494
00:16:25,980 --> 00:16:27,600
of not what you want if you're trying to

495
00:16:27,600 --> 00:16:29,459
extort somebody into paying

496
00:16:29,459 --> 00:16:31,500
but they were the only one so Luna

497
00:16:31,500 --> 00:16:34,320
ransomware also has an es6i Locker Circa

498
00:16:34,320 --> 00:16:36,959
about 2022 and one of the things that

499
00:16:36,959 --> 00:16:39,180
most people with esxi lockers do is they

500
00:16:39,180 --> 00:16:41,040
will shut down the VM and then encrypt

501
00:16:41,040 --> 00:16:43,139
it however they just encrypted them

502
00:16:43,139 --> 00:16:45,120
without shutting them down so while this

503
00:16:45,120 --> 00:16:48,060
won't always lead to corruption it's

504
00:16:48,060 --> 00:16:50,040
pretty plausible that after trying to

505
00:16:50,040 --> 00:16:52,199
decrypt it lead to corruption and then

506
00:16:52,199 --> 00:16:54,060
the victims now page you to decrypt

507
00:16:54,060 --> 00:16:56,579
their stuff and you kind of broke it not

508
00:16:56,579 --> 00:16:57,959
good for business

509
00:16:57,959 --> 00:17:00,000
next back to kind of black matter and

510
00:17:00,000 --> 00:17:02,940
dark side in 2022 in 2020 they decided

511
00:17:02,940 --> 00:17:05,939
let's roll our own crypto and ultimately

512
00:17:05,939 --> 00:17:07,859
there was a flaw in it that allowed

513
00:17:07,859 --> 00:17:09,959
researchers to be able to help decrypt

514
00:17:09,959 --> 00:17:12,559
the victims without requiring payment so

515
00:17:12,559 --> 00:17:14,939
succeeded in the attack victims

516
00:17:14,939 --> 00:17:17,339
decrypted without the payment not great

517
00:17:17,339 --> 00:17:19,079
and then finally ryuk ransomware from

518
00:17:19,079 --> 00:17:21,480
2019 so they had a buggy decrypter that

519
00:17:21,480 --> 00:17:23,760
didn't work on large files so as you can

520
00:17:23,760 --> 00:17:25,319
see this is definitely something that

521
00:17:25,319 --> 00:17:26,939
kind of keeps cropping up and will

522
00:17:26,939 --> 00:17:30,120
probably crop up again in the future

523
00:17:30,120 --> 00:17:32,160
so lock bit so everybody's probably

524
00:17:32,160 --> 00:17:33,419
familiar with lockbit they're one of the

525
00:17:33,419 --> 00:17:35,340
most active ransomware groups right now

526
00:17:35,340 --> 00:17:36,600
um and their original code is written in

527
00:17:36,600 --> 00:17:38,880
origin C we first observed them in

528
00:17:38,880 --> 00:17:41,460
September 2019 so a while now

529
00:17:41,460 --> 00:17:42,840
um and there's a couple of attacks that

530
00:17:42,840 --> 00:17:46,320
they've uh conducted that you may heard

531
00:17:46,320 --> 00:17:48,539
I've heard of so some of the most

532
00:17:48,539 --> 00:17:51,059
interesting things about them is they

533
00:17:51,059 --> 00:17:53,280
have the steel bit victim file

534
00:17:53,280 --> 00:17:55,799
exfiltrator which I'll talk about that

535
00:17:55,799 --> 00:17:58,260
they have tried to recruit insiders from

536
00:17:58,260 --> 00:17:59,940
companies that they were attacking so

537
00:17:59,940 --> 00:18:01,559
pretty much what they do is they say hey

538
00:18:01,559 --> 00:18:04,140
we'll give you some money if you provide

539
00:18:04,140 --> 00:18:06,179
us initial access to this company which

540
00:18:06,179 --> 00:18:07,440
is not something I really have seen

541
00:18:07,440 --> 00:18:10,679
actors do and kind of some interesting

542
00:18:10,679 --> 00:18:12,240
thing that that happened when their

543
00:18:12,240 --> 00:18:15,120
Builder was leaked

544
00:18:15,120 --> 00:18:16,260
so

545
00:18:16,260 --> 00:18:18,240
after black matter fired all of their

546
00:18:18,240 --> 00:18:19,799
developers based on their encryption

547
00:18:19,799 --> 00:18:22,620
flaws it looks like lockbit acquired so

548
00:18:22,620 --> 00:18:25,080
Rumor Has It acquired their code and

549
00:18:25,080 --> 00:18:26,700
then put out an offering called lockbit

550
00:18:26,700 --> 00:18:27,780
Black

551
00:18:27,780 --> 00:18:31,320
so after that another rumor has it that

552
00:18:31,320 --> 00:18:33,780
the disgruntled developer actually got

553
00:18:33,780 --> 00:18:36,480
mad and leaked the lock bit black code

554
00:18:36,480 --> 00:18:39,360
so the good thing about the code is that

555
00:18:39,360 --> 00:18:41,280
it has a customizable configuration so

556
00:18:41,280 --> 00:18:43,559
anybody can modify and build code from

557
00:18:43,559 --> 00:18:45,840
it however this also started to enable

558
00:18:45,840 --> 00:18:47,940
some ransomware group spin-offs so tape

559
00:18:47,940 --> 00:18:49,559
Builder build code make your own

560
00:18:49,559 --> 00:18:51,840
offering so bloody ransomware is kind of

561
00:18:51,840 --> 00:18:53,100
one of the ones that kind of recently

562
00:18:53,100 --> 00:18:54,320
cropped up

563
00:18:54,320 --> 00:18:57,240
in addition it seems like lockbit kind

564
00:18:57,240 --> 00:18:59,460
of has a trend going here so something

565
00:18:59,460 --> 00:19:01,260
called lock big green recently came out

566
00:19:01,260 --> 00:19:03,900
based on the leaked Source Code by the

567
00:19:03,900 --> 00:19:05,640
Ukrainian researcher for Conti's

568
00:19:05,640 --> 00:19:07,140
offering

569
00:19:07,140 --> 00:19:10,260
so from this code we saw a new a6i

570
00:19:10,260 --> 00:19:12,780
variant and we also saw some of the

571
00:19:12,780 --> 00:19:15,240
tour-based URLs that belong to lockbit

572
00:19:15,240 --> 00:19:17,220
in the samples so this is not just

573
00:19:17,220 --> 00:19:19,380
another group kind of building with this

574
00:19:19,380 --> 00:19:21,660
Builder or kind of Conti re-emerging

575
00:19:21,660 --> 00:19:23,520
it's like this is something that lockbit

576
00:19:23,520 --> 00:19:26,900
has now taken and used

577
00:19:27,120 --> 00:19:29,580
so I looked at lock bit black and one

578
00:19:29,580 --> 00:19:31,440
thing that stuck out is yes it does look

579
00:19:31,440 --> 00:19:33,179
very much like black matters ransomware

580
00:19:33,179 --> 00:19:35,340
so you can see the entry function so

581
00:19:35,340 --> 00:19:37,020
just as kind of an example of what

582
00:19:37,020 --> 00:19:38,880
similar looks like so the one kind of

583
00:19:38,880 --> 00:19:40,440
salient difference of the lock bit black

584
00:19:40,440 --> 00:19:42,299
code was the due to correct function

585
00:19:42,299 --> 00:19:43,860
that you can see all the way at the top

586
00:19:43,860 --> 00:19:46,039
on the right

587
00:19:46,039 --> 00:19:48,360
so you're a threat actor you could

588
00:19:48,360 --> 00:19:49,799
totally borrow other people's stuff but

589
00:19:49,799 --> 00:19:51,539
you know really try to improve it to

590
00:19:51,539 --> 00:19:54,299
your own for your own needs so some of

591
00:19:54,299 --> 00:19:55,740
the similarities here were the high

592
00:19:55,740 --> 00:19:57,840
level structure of the code so just kind

593
00:19:57,840 --> 00:19:59,160
of looking at it about the same control

594
00:19:59,160 --> 00:20:01,500
flow kind of same functionality in the

595
00:20:01,500 --> 00:20:03,720
same places what you would expect if

596
00:20:03,720 --> 00:20:05,580
code was pretty similar

597
00:20:05,580 --> 00:20:08,520
the API hashing technique they used the

598
00:20:08,520 --> 00:20:11,039
string hashing so one of the things that

599
00:20:11,039 --> 00:20:12,780
black matter did and now August black

600
00:20:12,780 --> 00:20:14,940
was instead of doing like string

601
00:20:14,940 --> 00:20:16,620
comparisons for the incoming function

602
00:20:16,620 --> 00:20:19,140
for the incoming arguments or like if

603
00:20:19,140 --> 00:20:20,280
they were looking for particular

604
00:20:20,280 --> 00:20:22,980
printers or other kinds of strings is

605
00:20:22,980 --> 00:20:25,080
they would take a numeric hash and then

606
00:20:25,080 --> 00:20:26,760
compare it to like a list of no

607
00:20:26,760 --> 00:20:28,860
numericaches so that was something that

608
00:20:28,860 --> 00:20:30,120
they both did

609
00:20:30,120 --> 00:20:32,100
the way the configuration file was

610
00:20:32,100 --> 00:20:33,660
decrypted and then some of the

611
00:20:33,660 --> 00:20:35,100
anti-debugging techniques that they used

612
00:20:35,100 --> 00:20:37,740
so not just this one but crash if

613
00:20:37,740 --> 00:20:39,419
breakpoints placed on its thread as well

614
00:20:39,419 --> 00:20:41,460
as kind of that combination thereof

615
00:20:41,460 --> 00:20:42,960
but there were also some difference with

616
00:20:42,960 --> 00:20:44,700
differences which you could largely

617
00:20:44,700 --> 00:20:47,160
count as improvements so some of the

618
00:20:47,160 --> 00:20:48,600
locket black versions actually do

619
00:20:48,600 --> 00:20:51,120
require a password to decrypt so can't

620
00:20:51,120 --> 00:20:53,520
really run them unless you have

621
00:20:53,520 --> 00:20:55,200
we can't run them properly unless you

622
00:20:55,200 --> 00:20:57,660
have the right password and they started

623
00:20:57,660 --> 00:20:59,160
implementing additional command line

624
00:20:59,160 --> 00:21:01,380
parameters so in addition to the kind of

625
00:21:01,380 --> 00:21:02,760
the known ones the black matter head

626
00:21:02,760 --> 00:21:04,080
they also have now Group Policy

627
00:21:04,080 --> 00:21:06,240
modification and self-deletion and a

628
00:21:06,240 --> 00:21:08,100
couple others as well and additionally

629
00:21:08,100 --> 00:21:09,900
they have some different configuration

630
00:21:09,900 --> 00:21:11,820
data Flags to support some of this

631
00:21:11,820 --> 00:21:13,679
additional functionality as well

632
00:21:13,679 --> 00:21:14,820
yeah

633
00:21:14,820 --> 00:21:16,919
but are they going to keep improving on

634
00:21:16,919 --> 00:21:19,200
their lockers so after the release of

635
00:21:19,200 --> 00:21:21,179
lock bit black we really haven't seen

636
00:21:21,179 --> 00:21:22,140
any

637
00:21:22,140 --> 00:21:24,179
Salient changes to their original Locker

638
00:21:24,179 --> 00:21:26,280
we did see kind of the Advent of lock

639
00:21:26,280 --> 00:21:28,620
bit green particularly interesting but

640
00:21:28,620 --> 00:21:30,539
it seems like maybe their business model

641
00:21:30,539 --> 00:21:31,980
is slightly different from some of the

642
00:21:31,980 --> 00:21:33,480
other threat actors who you largely see

643
00:21:33,480 --> 00:21:34,860
kind of iterating on the same set of

644
00:21:34,860 --> 00:21:37,080
code until they disband

645
00:21:37,080 --> 00:21:39,360
it's just kind of interesting there

646
00:21:39,360 --> 00:21:41,460
so kind of one point is that some of the

647
00:21:41,460 --> 00:21:43,860
samples of lock bit black don't have

648
00:21:43,860 --> 00:21:46,380
that decrypt function in there and they

649
00:21:46,380 --> 00:21:48,480
don't require the password to run seems

650
00:21:48,480 --> 00:21:49,740
like that's an option that the Builder

651
00:21:49,740 --> 00:21:51,419
just provides you could see an example

652
00:21:51,419 --> 00:21:52,860
of what this Decor function looks like

653
00:21:52,860 --> 00:21:54,179
on the right it's pretty much the same

654
00:21:54,179 --> 00:21:55,980
in all of them so definitely believe

655
00:21:55,980 --> 00:21:58,980
that for what it's worth another threat

656
00:21:58,980 --> 00:22:01,620
actor group a Gregor from almost three

657
00:22:01,620 --> 00:22:03,240
years ago now used some of the

658
00:22:03,240 --> 00:22:04,440
password-based decryption of their

659
00:22:04,440 --> 00:22:06,840
malware pretty successfully so made it a

660
00:22:06,840 --> 00:22:08,760
lot harder to find a sample to reverse

661
00:22:08,760 --> 00:22:10,020
engineer if you just couldn't get the

662
00:22:10,020 --> 00:22:11,400
code out

663
00:22:11,400 --> 00:22:13,260
and kind of one of the bonuses is that

664
00:22:13,260 --> 00:22:16,679
steel bit is their automated data

665
00:22:16,679 --> 00:22:19,320
exfiltration for victim files so

666
00:22:19,320 --> 00:22:20,400
ultimately

667
00:22:20,400 --> 00:22:22,860
many many ransomware threat actors will

668
00:22:22,860 --> 00:22:24,720
steal victim data posted on a league

669
00:22:24,720 --> 00:22:26,340
site and then use that to extort victims

670
00:22:26,340 --> 00:22:28,200
so this is just kind of a nice automated

671
00:22:28,200 --> 00:22:29,659
tool that they have

672
00:22:29,659 --> 00:22:32,580
to asilate the files and automatically

673
00:22:32,580 --> 00:22:35,760
upload them to their leak site

674
00:22:35,760 --> 00:22:37,919
so another kind of interesting Trend

675
00:22:37,919 --> 00:22:39,840
that lockbut is certainly a part of is

676
00:22:39,840 --> 00:22:42,059
the idea of trying to false flag instead

677
00:22:42,059 --> 00:22:43,860
of as a Russia Associated group as a

678
00:22:43,860 --> 00:22:46,020
China associate group interesting so

679
00:22:46,020 --> 00:22:47,159
when recorded feature actually

680
00:22:47,159 --> 00:22:49,320
interviewed lockbit and raised some

681
00:22:49,320 --> 00:22:50,820
concerns about you know what happens to

682
00:22:50,820 --> 00:22:53,220
people who live in Russia the US in the

683
00:22:53,220 --> 00:22:54,780
interview they advise that they

684
00:22:54,780 --> 00:22:56,400
certainly live in China and that none of

685
00:22:56,400 --> 00:22:57,539
their Affiliates live in the United

686
00:22:57,539 --> 00:22:59,340
States or Russia so these aren't

687
00:22:59,340 --> 00:23:02,400
concerns of theirs interesting so this

688
00:23:02,400 --> 00:23:04,620
is not kind of just them so sometimes

689
00:23:04,620 --> 00:23:06,059
you'll see threat actors post machine

690
00:23:06,059 --> 00:23:08,100
translated Chinese asking about

691
00:23:08,100 --> 00:23:10,020
ransomware on some forums so you can see

692
00:23:10,020 --> 00:23:12,000
on the bottom right an example of one of

693
00:23:12,000 --> 00:23:13,559
these things so talk to one of my

694
00:23:13,559 --> 00:23:15,780
co-workers who speaks Chinese and he was

695
00:23:15,780 --> 00:23:17,880
like this is not right so in case you're

696
00:23:17,880 --> 00:23:19,620
super familiar that's kind of

697
00:23:19,620 --> 00:23:21,720
uh not great and kind of the tone is

698
00:23:21,720 --> 00:23:25,020
super incorrect for what you'd expect

699
00:23:25,020 --> 00:23:27,120
other forums like ramp pretty popular

700
00:23:27,120 --> 00:23:29,340
Forum really also tries to welcome

701
00:23:29,340 --> 00:23:31,440
Chinese speakers so they're really

702
00:23:31,440 --> 00:23:33,299
trying to attract Chinese threat actors

703
00:23:33,299 --> 00:23:35,220
and ransomware gangs not entirely sure

704
00:23:35,220 --> 00:23:37,200
why but that's kind of what that looks

705
00:23:37,200 --> 00:23:39,140
like

706
00:23:39,140 --> 00:23:41,700
so sometimes this doesn't always kind of

707
00:23:41,700 --> 00:23:43,679
work out and they don't really do a

708
00:23:43,679 --> 00:23:45,840
great job of kind of like executing on

709
00:23:45,840 --> 00:23:49,260
the false flagging so Jana Wong was a

710
00:23:49,260 --> 00:23:51,539
ransomware group that purported to be

711
00:23:51,539 --> 00:23:53,760
China Associated but what happened was

712
00:23:53,760 --> 00:23:55,200
that a lot of their chats were leaked

713
00:23:55,200 --> 00:23:57,480
and it was discovered that conversations

714
00:23:57,480 --> 00:24:00,419
were in Russian not Chinese so probably

715
00:24:00,419 --> 00:24:03,600
not Chinese associated

716
00:24:03,600 --> 00:24:06,240
so if you're trying to fall slag and you

717
00:24:06,240 --> 00:24:07,860
want to be successful at it make sure

718
00:24:07,860 --> 00:24:11,100
you don't cut Corners so here is some

719
00:24:11,100 --> 00:24:13,080
ransomware that purported to be shower

720
00:24:13,080 --> 00:24:15,360
and somewhere cool detonated it saw what

721
00:24:15,360 --> 00:24:18,299
happened you can see the top the note

722
00:24:18,299 --> 00:24:20,340
kind of has some like sort of references

723
00:24:20,340 --> 00:24:22,080
to you know maybe things that aren't

724
00:24:22,080 --> 00:24:24,659
Russia Associated interesting then I

725
00:24:24,659 --> 00:24:26,520
looked at uh some of the terminal output

726
00:24:26,520 --> 00:24:28,020
and um

727
00:24:28,020 --> 00:24:30,059
what you notice is that Reva it says

728
00:24:30,059 --> 00:24:32,640
revix 1.1 C so if you're not familiar

729
00:24:32,640 --> 00:24:35,520
with revix um back in the day reevil had

730
00:24:35,520 --> 00:24:38,340
a Linux offering called revex looked at

731
00:24:38,340 --> 00:24:39,900
that code substantially this looks

732
00:24:39,900 --> 00:24:41,880
exactly like it and it looks like they

733
00:24:41,880 --> 00:24:44,159
just kind of reskinned that so probably

734
00:24:44,159 --> 00:24:45,659
not China Associated because I don't

735
00:24:45,659 --> 00:24:48,179
believe revix was ever leaked so there

736
00:24:48,179 --> 00:24:49,919
you go

737
00:24:49,919 --> 00:24:51,360
so

738
00:24:51,360 --> 00:24:53,039
now we want to kind of hunt for these

739
00:24:53,039 --> 00:24:54,360
things and

740
00:24:54,360 --> 00:24:56,520
it's kind of what our goal is here so

741
00:24:56,520 --> 00:24:58,200
one of the things if you're trying to

742
00:24:58,200 --> 00:25:00,900
look for additional Badness is start to

743
00:25:00,900 --> 00:25:03,539
face the strange so a lot of the obvious

744
00:25:03,539 --> 00:25:05,700
automated obfuscation techniques do

745
00:25:05,700 --> 00:25:08,159
leave some artifacts so for example with

746
00:25:08,159 --> 00:25:09,600
plays um

747
00:25:09,600 --> 00:25:12,419
additional garbage code insertion some

748
00:25:12,419 --> 00:25:15,120
of the ways that generally they work to

749
00:25:15,120 --> 00:25:17,340
do that you'll start to see in like some

750
00:25:17,340 --> 00:25:19,260
of the Rob stuff like there's a pattern

751
00:25:19,260 --> 00:25:21,179
to it some of the morph Alpha Morph

752
00:25:21,179 --> 00:25:22,679
stuff as well

753
00:25:22,679 --> 00:25:24,299
um ideally it's better if these

754
00:25:24,299 --> 00:25:25,980
techniques are custom so they've written

755
00:25:25,980 --> 00:25:27,840
them themselves rather than kind of

756
00:25:27,840 --> 00:25:29,700
downloading a toolkit I guess depending

757
00:25:29,700 --> 00:25:30,960
what you're sort of looking for do you

758
00:25:30,960 --> 00:25:31,919
want to find more people using the

759
00:25:31,919 --> 00:25:34,320
toolkit or more of these things

760
00:25:34,320 --> 00:25:36,299
um also looking for inconsistencies in

761
00:25:36,299 --> 00:25:38,820
like language that they use especially

762
00:25:38,820 --> 00:25:41,880
for Strings so like blog messages any

763
00:25:41,880 --> 00:25:43,919
sort of mutex names

764
00:25:43,919 --> 00:25:45,539
um anything interesting there that kind

765
00:25:45,539 --> 00:25:47,779
of sticks out it's pretty successful

766
00:25:47,779 --> 00:25:50,100
a lot of the times you can also look for

767
00:25:50,100 --> 00:25:51,720
the text of the ransom notes so

768
00:25:51,720 --> 00:25:53,039
sometimes you'll see kind of interesting

769
00:25:53,039 --> 00:25:56,220
turns of phrase for example if you know

770
00:25:56,220 --> 00:25:57,659
that there's a

771
00:25:57,659 --> 00:26:00,120
a Windows Locker you can find look The

772
00:26:00,120 --> 00:26:01,799
Ransom note and potentially find

773
00:26:01,799 --> 00:26:03,539
something like a Linux Locker an esxi

774
00:26:03,539 --> 00:26:05,640
Locker if they have one sometimes based

775
00:26:05,640 --> 00:26:08,159
on just kind of those language artifacts

776
00:26:08,159 --> 00:26:09,659
additionally another kind of fun

777
00:26:09,659 --> 00:26:11,220
technique to use is looking at their

778
00:26:11,220 --> 00:26:12,960
anti-reverse engineering anti-debugging

779
00:26:12,960 --> 00:26:15,659
or anti-analysis techniques so not all

780
00:26:15,659 --> 00:26:17,159
the time are they unique but sometimes

781
00:26:17,159 --> 00:26:18,539
what you'll see is kind of it's unique

782
00:26:18,539 --> 00:26:20,460
and interesting combinations thereof so

783
00:26:20,460 --> 00:26:22,200
that's a good place to start as well

784
00:26:22,200 --> 00:26:24,120
implementation of crypto algorithms

785
00:26:24,120 --> 00:26:25,919
especially if it's wrong or kind of a

786
00:26:25,919 --> 00:26:28,200
weird combination of them so for example

787
00:26:28,200 --> 00:26:30,299
dark side and black matter both had the

788
00:26:30,299 --> 00:26:32,039
encryption flaw but another thing that

789
00:26:32,039 --> 00:26:33,299
they did was they kind of had a weird

790
00:26:33,299 --> 00:26:35,760
combination of which algorithms they

791
00:26:35,760 --> 00:26:37,260
were using that researchers ultimately

792
00:26:37,260 --> 00:26:40,200
were able to kind of link them based on

793
00:26:40,200 --> 00:26:42,419
additionally buggy anomalies so anything

794
00:26:42,419 --> 00:26:44,220
that doesn't work the way that it should

795
00:26:44,220 --> 00:26:46,919
or code that's just kind of not working

796
00:26:46,919 --> 00:26:49,320
so generally my understanding is that

797
00:26:49,320 --> 00:26:50,880
you know if you're trying to have

798
00:26:50,880 --> 00:26:52,799
successful ransomware you want it to

799
00:26:52,799 --> 00:26:55,080
work and function as expected so if it's

800
00:26:55,080 --> 00:26:57,240
not probably not their intention so

801
00:26:57,240 --> 00:26:58,799
something else to kind of pivot on and

802
00:26:58,799 --> 00:27:00,840
look for and staying up on the latest

803
00:27:00,840 --> 00:27:02,880
affiliate news so you can see on the

804
00:27:02,880 --> 00:27:06,360
right Alpha's announcement of the morph

805
00:27:06,360 --> 00:27:09,240
toolkit so this is something that you

806
00:27:09,240 --> 00:27:11,760
can see and you say Okay interesting let

807
00:27:11,760 --> 00:27:13,440
me try and find something like that or

808
00:27:13,440 --> 00:27:14,760
try and figure out a different way to

809
00:27:14,760 --> 00:27:16,740
find it or you know figure out some way

810
00:27:16,740 --> 00:27:18,840
to get access to it myself

811
00:27:18,840 --> 00:27:20,940
but kind of with all these like leaked

812
00:27:20,940 --> 00:27:23,039
Builders and things coming out now

813
00:27:23,039 --> 00:27:25,080
um another interesting technique is to

814
00:27:25,080 --> 00:27:27,240
look for code reuse between families so

815
00:27:27,240 --> 00:27:29,400
like we saw with um

816
00:27:29,400 --> 00:27:31,559
the lock the green and lock bit black

817
00:27:31,559 --> 00:27:33,179
and then other people kind of using

818
00:27:33,179 --> 00:27:34,559
those you start to see a lot of kind of

819
00:27:34,559 --> 00:27:36,779
code overlap might be useful if you want

820
00:27:36,779 --> 00:27:38,580
to say okay who else is using Conti's

821
00:27:38,580 --> 00:27:39,779
build or whatever what other offerings

822
00:27:39,779 --> 00:27:41,520
are kind of out there right now

823
00:27:41,520 --> 00:27:43,200
and then looking for other kind of

824
00:27:43,200 --> 00:27:45,059
overlaps and Ransom note language so

825
00:27:45,059 --> 00:27:46,320
sometimes that's kind of like fun to

826
00:27:46,320 --> 00:27:48,000
look for generally you'll see things

827
00:27:48,000 --> 00:27:50,520
except for like play right what happened

828
00:27:50,520 --> 00:27:52,860
your network tour project other verbiage

829
00:27:52,860 --> 00:27:54,600
like that so if you're trying to look

830
00:27:54,600 --> 00:27:55,440
for

831
00:27:55,440 --> 00:27:57,720
additional ransomware out there

832
00:27:57,720 --> 00:27:59,340
and with that

833
00:27:59,340 --> 00:28:02,059
are any questions

834
00:28:04,140 --> 00:28:07,039
thank you

